message-processing-model v1;
security-model v1;
security-level none;
security-name john;
}
}
usm {
local-engine { # Defines authentication and encryption for SNMPv3 users
user john { # security-name john is defined here
authentication-md5 {
authentication-password authentication-password;
}
privacy-des {
privacy-password privacy-password;
}
}
user bob { # security-name bob is defined here
authentication-sha {
authentication-password authentication-password;
}
privacy-none;
}
user julia { # security-name julia is defined here
authentication-none;
privacy-none;
}
539
user lauren { # security-name lauren is defined here
authentication-sha {
authentication-password authentication-password;
}
privacy-aes128 {
privacy-password privacy-password;
}
}
user richard { # security-name richard is defined here
authentication-sha {
authentication-password authentication-password;
}
privacy-none;
}
}
}
vacm {
access {
group san-francisco { #Defines the access privileges for the group
default-context-prefix { # called san-francisco
security-model v1 {
security-level none {
notify-view ping-mib;
read-view interfaces;
write-view jnxAlarms;
}
}
}
}
}
security-to-group {
security-model v1 {
security-name john { # Assigns john to security group san-fancisco
group san-francisco;
}
security-name bob { # Assigns bob to security group new-york
group new-york;
}
security-name julia {# Assigns julia to security group chicago
group chicago;
}
security-name lauren {# Assigns lauren to security group paris
group paris;
540
}
security-name richard {# Assigns richard to security group geneva
group geneva;
}
}
}
}
Configure SNMPv3 Authentication Type and
Encryption Type
IN THIS SECTION
Configure SNMPv3 Authentication Type | 540
Configure SNMPv3 Encryption Type | 542
Configure SNMPv3 Authentication Type
IN THIS SECTION
Configur MD5 Authentication | 541
Configure SHA Authentication | 541
Configure No Authentication | 541
By default, in a Junos OS configuration the SNMPv3 authentication type is set to none.
This topic includes the following sections:
541
Configur MD5 Authentication
To configure the message digest algorithm (MD5) as the authentication type for an SNMPv3 user,
include the authentication-md5 statement at the [edit snmp v3 usm local-engine user username] hierarchy level.
For more information about this statement, see authentication-md5.
Configure SHA Authentication
You can configure the following secure hash algorithm (SHA) as the authentication type for an SNMPv3
user:
• authentication-sha
• authentication-sha224
• authentication-sha256
To configure the secure hash algorithm (SHA) as the authentication type for an SNMPv3 user, include
the authentication-sha, statement at the [edit snmp v3 usm local-engine user username] hierarchy level. For
more information about this statement, see authentication-sha.
To configure the secure hash algorithm (SHA) as the authentication type for an SNMPv3 user, include
the authentication-sha224 at the [edit snmp v3 usm local-engine user username] hierarchy level. For more
information about this statement, see authentication-sha224.
To configure the secure hash algorithm (SHA) as the authentication type for an SNMPv3 user, include
the authentication-sha256 statement at the [edit snmp v3 usm local-engine user username] hierarchy level. For
more information about this statement, see authentication-sha256.
Configure No Authentication
To configure no authentication for an SNMPv3 user, include the authentication-none statement at the [edit
snmp v3 usm local-engine user username] hierarchy level. For more information about this statement, see
authentication-none.
SEE ALSO
v3
542
Configure SNMPv3 Encryption Type
IN THIS SECTION
Configure Advanced Encryption Standard Algorithm | 542
Configure Data Encryption Algorithm | 542
Configure Triple DES | 542
Configure No Encryption | 542
By default, encryption is set to none.
Before you configure encryption, you must configure MD5 or SHA authentication.
This topic includes the following sections:
Configure Advanced Encryption Standard Algorithm
To configure the Advanced Encryption Standard (AES) algorithm for an SNMPv3 user, include the
privacy-aes128 statement at the [edit snmp v3 usm local-engine user username] hierarchy level. For more
information about this statement, see privacy-aes128.
Configure Data Encryption Algorithm
To configure the data encryption algorithm (DES) for an SNMPv3 user, include the privacy-des statement
at the [edit snmp v3 usm local-engine user username] hierarchy level. For more information about this
statement, see privacy-des.
Configure Triple DES
To configure triple DES for an SNMPv3 user, include the privacy-3des statement at the [edit snmp v3 usm
local-engine user username] hierarchy level. For more information about this statement, see privacy-3des.
Configure No Encryption
To configure no encryption for an SNMPv3 user, include the privacy-none statement at the [edit snmp v3
usm local-engine user username] hierarchy level. For more information about this statement, see privacy-
none.
543
SNMPv3 Traps
IN THIS SECTION
Configure SNMPv3 Traps on a Device Running Junos OS | 543
Configure SNMPv3 Trap Notification | 544
Example: Configure SNMPv3 Trap Notification | 544
Configure the Trap Notification Filter | 545
Configure the Trap Target Address | 545
Example: Configure the Tag List | 547
Define and Configure the Trap Target Parameters | 548
In SNMPv3, you create traps and informs by configuring the notify, target-address, and target-parameters
parameters. Traps are unconfirmed notifications, whereas informs are confirmed notifications. This
section describes how to configure SNMP traps.
Configure SNMPv3 Traps on a Device Running Junos OS
The target address defines a management application’s address and parameters used in sending
notifications. Target parameters define the message processing and security parameters used in sending
notifications to a particular management target. SNMPv3 also lets you define SNMPv1 and SNMPv2c
traps.
NOTE: When you configure SNMP traps, ensure your configured access privileges allow the
traps to be sent. You can configure access privileges at the [edit snmp v3 vacm access] and [edit snmp
v3 vacm security-to-group] hierarchy levels.
For details on SNMP v1 or v2 trap to OID translation and trap details that are sent by each category, see
MIB Explorer.
544
Configure SNMPv3 Trap Notification
The notify statement specifies the type of notification (trap) and contains a single tag. The tag defines a
set of target addresses to receive a trap. The tag list contains one or more tags and is configured at the
[edit snmp v3 target-address target-address-name] hierarchy level. If the tag list contains this tag, Junos OS
sends a notification to all the target addresses associated with this tag.
To configure the trap notifications, include the notify statement at the [edit snmp v3] hierarchy level.
Each notify entry name must be unique.
Junos OS supports two types of notification: trap and inform.
SEE ALSO
v3
Example: Configure SNMPv3 Trap Notification
Specify three sets of destinations to send traps:
[edit snmp v3]
notify n1 {
tag router1;
type trap;
}
notify n2 {
tag router2;
type trap
}
notify n3 {
tag router3;
type trap;
}
545
Configure the Trap Notification Filter
SNMPv3 uses the notify filter to define which traps (or which objects from which traps) are sent to the
network management system (NMS). The trap notification filter limits the type of traps that are sent to
the NMS.
Each object identifier represents a subtree of the MIB object hierarchy. You can represent the subtree
either by a sequence of dotted integers (such as 1.3.6.1.2.1.2) or by its subtree name (such as interfaces).
You can also use the wildcard character asterisk (*) in the object identifier (OID) to specify object
identifiers that match a particular pattern.
To configure the trap notifications filter, include the notify-filter statement at the [edit snmp v3] hierarchy
level.
By default, the OID is set to include. To define access to traps (or objects from traps), include the oid
statement at the [edit snmp v3 notify-filter profile-name] hierarchy level. For more information about this
statement, see notify-filter (Configuring the Profile Name).
Configure the Trap Target Address
IN THIS SECTION
Configure the Address | 546
Configure the Address Mask | 546
Configure the Port | 546
Configure the Routing Instance | 547
Configure the Trap Target Address | 547
Apply Target Parameters | 547
The target address defines a management application’s address and parameters that are used in sending
notifications. It can also identify management stations that are allowed to use specific community
strings. When you receive a packet with a recognized community string and a tag is associated with it,
Junos OS looks up all the target addresses with this tag and verifies that the source address of this
packet matches one of the configured target addresses.
You must configure the address mask when you configure the SNMP community.
546
To specify where you want the traps to be sent and define what SNMPv1 and SNMPv2cc packets are
allowed, include the target-address statement at the [edit snmp v3] hierarchy level.
To configure the target address properties, include the following statements at the [edit snmp v3 target-
address target-address-name] hierarchy level:
Unlike with SNMP v2, In SNMPv3, there is no configuration option to limit inbound polling. But you can
configure a lo0 filter to limit inbound polling by creating a rule to allow SNMP from your monitoring
system IPs. For example:
set policy-options prefix-list SNMP 10.1.1.1/32
set policy-options prefix-list SNMP 192.168.1.0/24
set firewall family inet filter CoPP term SNMP from source-prefix-list SNMP
set firewall family inet filter CoPP term SNMP from protocol udp
set firewall family inet filter CoPP term SNMP from destination-port snmp
set firewall family inet filter CoPP term SNMP then accept
set firewall family inet filter CoPP term SNMP then count SNMP
Configure the Address
To configure the address, include the address statement at the [edit snmp v3 target-address target-address-
name] hierarchy level. For more information about this statement, see address.
address is the SNMP target address.
Configure the Address Mask
The address mask specifies a set of addresses that are allowed to use a community string and verifies
the source addresses for a group of target addresses.
To configure the address mask, include the address-mask statement at the [edit snmp v3 target-address
target-address-name] hierarchy level. address-mask.
address-mask combined with the address defines a range of addresses.
Configure the Port
By default, the UDP port is set to 162. To configure a different port number, include the port statement
at the [edit snmp v3 target-address target-address-name] hierarchy level. For more information about this
statement, see port.
547
Configure the Routing Instance
Traps are sent over the default routing instance. To configure the routing instance for sending traps,
include the routing-instance statement at the [edit snmp v3 target-address target-address-name] hierarchy level.
For more information about this statement, see routing-instance.
Configure the Trap Target Address
Each target-address statement can have one or more tags configured in its tag list. Each tag can appear in
more than one tag list. When a significant event occurs on the network device, the tag list identifies the
targets to which a notification is sent.
To configure the tag list, include the tag-list statement at the [edit snmp v3 target-address target-address-
name] hierarchy level. For more information about this statement, see tag-list.
tag-list specifies one or more tags as a space-separated list enclosed within double quotes.
When you configure SNMP traps, make sure your configured access privileges allow the traps to be sent.
Configure access privileges at the [edit snmp v3 vacm access] hierarchy level.
Apply Target Parameters
The target-parameters statement at the [edit snmp v3] hierarchy level applies the target parameters
configured at the [edit snmp v3 target-parameters target-parameters-name] hierarchy level.
To reference configured target parameters, include the target-parameters statement at the [edit snmp v3
target-address target-address-name] hierarchy level:
Example: Configure the Tag List
In the following example, two tag entries (router1 and router2) are defined at the [edit snmp v3 notify
notify-name] hierarchy level. When an event triggers a notification, Junos OS sends a trap to all target
addresses that have router1 or router2 configured in their target-address tag list. This results in the first
two targets getting one trap each, and the third target getting two traps.
[edit snmp v3]
notify n1 {
tag router1; # Identifies a set of target addresses
type trap; # Defines the type of notification
}
notify n2 {
tag router2;
548
type trap;
}
target-address ta1 {
address 10.1.1.1;
address-mask 255.255.255.0;
port 162;
tag-list router1;
target-parameters tp1;
}
target-address ta2 {
address 10.1.1.2;
address-mask 255.255.255.0;
port 162;
tag-list router2;
target-parameters tp2;
}
target-address ta3 {
address 10.1.1.3;
address-mask 255.255.255.0;
port 162;
tag-list “router1 router2”; #Define multiple tags in the target address tag list
target-parameters tp3;
}
Define and Configure the Trap Target Parameters
IN THIS SECTION
Apply the Trap Notification Filter | 549
Configure the Target Parameters | 549
Target parameters define the message processing and security parameters that are used in sending
notifications to a particular management target.
To define a set of target parameters, include the target-parameters statement at the [edit snmp v3] hierarchy
level:
549
For more information about configuring subscriber secure policies, see Subscriber Secure Policy
Overview.
This topic includes the following sections:
Apply the Trap Notification Filter
To apply the trap notification filter, include the notify-filter statement at the [edit snmp v3 target-
parameters target-parameter-name] hierarchy level. For more information about this statement, see notify-
filter (Applying to the Management Target).
Configure the Target Parameters
IN THIS SECTION
Configure the Message Processing Model | 549
Configure the Security Model | 549
Configure the Security Level | 550
Configure the Security Name | 550
To configure target parameter properties, include the following statements at the [edit snmp v3 target-
parameters target-parameter-name parameters] hierarchy level.
This section includes the following topics:
Configure the Message Processing Model
The message processing model defines which version of SNMP to use when generating SNMP
notifications. To configure the message processing model, include the message-processing-model statement
at the [edit snmp v3 target-parameters target-parameter-name parameters] hierarchy level. For more information
about this statement, see message-processing-model.
The subscriber secure policy on MX Series routers requires the v3 message-processing model. See
Subscriber Secure Policy Overview.
Configure the Security Model
To define the security model to use when generating SNMP notifications, include the security-model
statement at the [edit snmp v3 target-parameters target-parameter-name parameters] hierarchy level. For more
information about this statement, see security-model (SNMP Notifications).
550
The subscriber secure policy on MX Series routers requires the usm security model. See Subscriber
Secure Policy Overview.
Configure the Security Level
The security-level statement specifies whether the trap is authenticated and encrypted before it is sent.
To configure the security level to use when generating SNMP notifications, include the security-level
statement at the [edit snmp v3 target-parameters target-parameter-name parameters] hierarchy level. For more
information about this statement, see security-level (Generating SNMP Notifications).
If you are configuring the SNMPv1 or SNMPV2c security model, use none as your security level. If you
are configuring the SNMPv3 (USM) security model, use the authentication or privacy security level.
The subscriber secure policy on MX Series routers requires the privacy security level . See Subscriber
Secure Policy Overview for more information.
Configure the Security Name
To configure the security name to use when generating SNMP notifications, include the security-name
statement at the [edit snmp v3 target-parameters target-parameter-name parameters] hierarchy level. For more
information about this statement, see security-name (SNMP Notifications).
If you use USM as security model, the security-name identifies the user that is used when the notification
is generated. If you use v1 or v2c as security models, security-name identifies the SNMP community used
when the notification is generated.
The access privileges for the group associated with a security name must allow this notification to be
sent.
If you are using the v1 or v2 security models, the security name at the [edit snmp v3 vacm security-to-group]
hierarchy level must match the security name at the [edit snmp v3 snmp-community community-index] hierarchy
level.
SNMPv3 Informs
IN THIS SECTION
Example: Configure the Inform Notification Type and Target Address | 552
551
Example: Configure the Remote Engine ID and Remote User | 553
Junos OS supports two types of notifications: traps and informs.