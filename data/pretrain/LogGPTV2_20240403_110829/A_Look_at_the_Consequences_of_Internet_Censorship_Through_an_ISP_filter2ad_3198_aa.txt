title:A Look at the Consequences of Internet Censorship Through an ISP
Lens
author:Sheharbano Khattak and
Mobin Javed and
Syed Ali Khayam and
Zartash Afzal Uzmi and
Vern Paxson
A Look at the Consequences of Internet Censorship
Through an ISP Lens
Sheharbano Khattak1, Mobin Javed2, Syed Ali Khayam3, Zartash Afzal Uzmi4, Vern Paxson2,5
1University of Cambridge, 2UC Berkeley, 3PLUMgrid, 4LUMS SBASSE, 5ICSI
ABSTRACT
Internet censorship artiﬁcially changes the dynamics of resource
production and consumption, affecting a range of stakeholders that
include end users, service providers, and content providers. We
analyze two large-scale censorship events in Pakistan: blocking of
pornographic content in 2011 and of YouTube in 2012. Using traf-
ﬁc datasets collected at home and SOHO networks before and af-
ter the censorship events, we: a) quantify the demand for blocked
content, b) illuminate challenges encountered by service providers
in implementing the censorship policies, c) investigate changes in
user behavior (e.g., with respect to circumvention) after censorship,
and d) assess beneﬁts extracted by competing content providers of
blocked content.
Categories and Subject Descriptors
C.2.3 [Network Operations]: Network monitoring; C.2.0
[General]: Security and protection; C.2.2 [Network Protocols]:
Applications
General Terms
Measurement
Keywords
Censorship; ISP trafﬁc; Content blocking; Video streaming; Porn;
1.
INTRODUCTION
Nation-level censorship affects the activities of hundreds of mil-
lions of Internet users, with many countries implementing it at dif-
ferent levels and for a variety of reasons [35]. While censorship
deployment and technology have seen considerable analysis in pre-
vious studies [9, 32], we lack a clear understanding of the conse-
quences of censorship: just how does its employment affect differ-
ent stakeholders? What steps do users, content providers, and ISPs
take in response to censorship? How effectively does a given act
of censorship achieve the censor’s goals, and with what collateral
damage?
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full citation
on the ﬁrst page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from permissions@acm.org.
IMC’14, November 5–7, 2014, Vancouver, BC, Canada.
Copyright is held by the owner/author(s). Publication rights licensed to ACM.
ACM 978-1-4503-3213-2/14/11 ...$15.00.
http://dx.doi.org/10.1145/2663716.2663750.
While quantiﬁable answers to these sorts of questions have im-
portant socio-economic and policy implications, obtaining ﬁne-
grained illumination of these issues has remained largely unex-
plored due to the lack of datasets collected at appropriate vantage
points and at appropriate times (i.e., before and after censorship
events). Prior studies instead rely on datasets collected either via
active probing [32] or using proxy servers [7]. These datasets can-
not characterize individual behavior around censorship events; con-
sequently, prior studies have focused mainly on understanding the
mechanics of censorship technology and associated circumvention
possibilities, rather than the consequences.
In this work, we seek to provide quantiﬁed insights into the im-
pact of censorship on users, content providers, and ISPs, as seen
through the lens of trafﬁc datasets captured at a medium-size ISP1
in a major city in Pakistan. Pakistan provides a useful vantage point
for such a study as it recently instituted two large instances of cen-
sorship: blocking pornographic content2 in 2011 [5], and blocking
YouTube in 2012 [10].
The datasets we draw upon for this study comprise six residen-
tial and SOHO (Small Ofﬁce / Home Ofﬁce) trafﬁc traces collected
before and after the porn and YouTube censorship events, including
one dataset collected on the day when Pakistan blocked YouTube.
Trace durations range between 6–16 hours and capture sizes be-
tween 200–500GB, comprising trafﬁc from 100–1,000 local IP ad-
dresses.3 We supplement this perspective with a survey we con-
ducted of about 700 Pakistani Internet users.
While analyzing the captured trafﬁc traces, we developed
methodologies to establish the ground truth (what was censored
and how it was censored). Thus, unlike previous studies, our focus
is on the ofﬂine analysis of captured data to ascertain the conse-
quences of censorship. Our study develops the following insights:
• We observe a sudden increase in SSL trafﬁc on the day of
YouTube blocking, of sufﬁcient volume that we attribute this
change to users switching to VPN connections to circumvent
the censors. This change persists a year later.
• SOHO users very quickly identiﬁed effective circumvention
techniques, most of them switching to SSL within hours of
the content blocking.
• Competing alternatives to YouTube received considerable
beneﬁt from censorship. We observe a sharp increase (≈ 40–
80%) in trafﬁc volume towards these websites. Blocked sites
1Anonymized at the ISP’s request.
2Shortened to “porn” henceforth.
3Due to NAT usage, one address can potentially correspond to mul-
tiple users.
271also drop considerably in search-engine page rankings for lo-
cal content. This change represents a marked regional shift
in the economics of video content distributors, who mainly
rely upon ad revenue.
• Before to censorship, porn content made up an average of
10% of home and SOHO trafﬁc volume. Post-censorship,
this fraction reduces considerably for both types of users.
Even after factoring in trafﬁc volume shifted to alternative
(unblocked) porn websites, and the contemporaneous in-
crease in SSL (potentially VPN) trafﬁc, porn trafﬁc volume
did not return to the same level as before. The apparent re-
duction of active demand appears to indicate that the censors
met their nominal goals.
• The YouTube block has two unintentional, yet signiﬁ-
cant, consequences: (i) ﬁnancial impact on ISP: as users
move to encryption-based circumvention mechanisms, the
ISP’s bandwidth requirement from the upstream provider in-
creases, since ISPs cannot in general cache encrypted con-
tent; and (ii) ﬁnancial impact on YouTube: user demand for
YouTube (in terms of video requests observed in unencrypted
trafﬁc) eventually becomes half of its pre-censorship magni-
tude, and shifts to other video content providers.
2. BACKGROUND AND RELATED WORK
This section provides context on the censorship events that we in-
vestigate, the issue of determining how censorship is implemented,
and the relationship between our work and prior research.
Internet infrastructure and censorship in Pakistan. Our study
spans traces collected at a Pakistani ISP between 2011 and 2013—
a timeline during which the country’s censorship policy evolved
considerably. There are ≈ 50 local and regional Internet service
providers (ISPs) in Pakistan [25]. Only two of these, Pakistan
Telecommunication Company Limited (PTCL) and Transworld
Associates (TWA), have direct international connectivity, which
they sell to the rest of the providers as well as directly to consumers;
note that the majority of CDN servers are located outside of Pak-
istan. Internet censorship in Pakistan has mostly targeted content
hosted outside the country, which Pakistani users access through
PTCL or TWA.
The directives to block a particular website originate from the
government or the judiciary. The ISPs are directed by the regu-
lator, Pakistan Telecom Authority (PTA), to implement a content-
blocking policy. While Pakistan has been intermittently blocking
content since 2006 [32], a more persistent blocking policy was im-
plemented in 2011 with the censorship of porn content [5], and
then in 2012 with the blocking of YouTube [10]. The porn block
in Pakistan was instituted in response to a media report that high-
lighted Pakistan as the top country in terms of searches for porn
content [33], while the YouTube ban arose when a video, deemed
blasphemous, appeared on the website. Presently, the country con-
tinues to block access to YouTube4 as well as to sites deemed
pornographic, anti-religious, or a general threat to national values
and security [34]. A more recent study reports censorship of con-
tent related to human rights, independent media, proxy and circum-
vention tools, and bittorrent ﬁle-sharing sites [9].
Determining the implementation of censorship. Prior studies
have focussed on inferring technologies for implementing censor-
ship. Most of these studies use active probing to trigger censorship
4In early 2014, a US court cited copyright issues in forcing
YouTube to remove the offending video [36, 18]. As of this writing,
Google continues to ﬁght this order.
responses and comparing these responses to baseline responses in
uncensored regions. These studies seek to detect the manipulation
of trafﬁc by intermediate devices [26, 19, 39, 23] and to illumi-
nate the nature of censored content [11, 20] and the corresponding
technology and/or mechanisms [14, 4, 43, 13]. Some recent stud-
ies apply probe-based approaches to study censorship particularly
in Pakistan [32, 9], highlighting ISP-level DNS redirection, along
with HTTP-redirection and fake-response injection at the national
backbone. While previous work serves to help validate our ﬁnd-
ings, we cannot directly map it to our three-year dataset because
censorship mechanisms can vary (i) over time, and (ii) across dif-
ferent vantage points. We thus employ passive analysis of each
data trace to identify the censorship mechanism(s) in effect at a
given time. We are not aware of any prior work that reconstructs
censorship mechanisms by passive analysis of network traces, other
than within the broader context of detecting forged TCP RST pack-
ets [44].
Consequences of Internet censorship. Previous literature has
tackled the problem of how different network-level events, partic-
ularly in the context of anti-piracy laws, can affect the behavior of
users [1] and content providers [22]. In the context of Internet cen-
sorship, studies have assessed the (sometimes unintended) impact
of Internet censorship on global Internet services. China’s injec-
tion of forged DNS responses has been reported to cause large scale
collateral damage by blocking outside trafﬁc that traverses Chinese
links [3]. Upstream ﬁltering can block trafﬁc from outside a cen-
sored region due to ISP routing arrangements (for example, users
of an ISP in Oman could not access certain content due to ﬁltering
regulations in India [27]). Chaabane et al. [7] analyze logs from
Syrian censorship proxies to understand censorship methodology
and user behaviour. In the latter context, they ﬁnd that Syrian users
employ web/socks proxies, Tor, VPNs, and BitTorrent to circum-
vent censorship. Labovitz uses a combination of large scale crawl-
ing and third-party data sources to investigate how the takedown
of MegaUpload servers in North America impacts ﬁle-sharing traf-
ﬁc [28]. He ﬁnds that the incident caused a very small decrease
in MegaUpload’s previous trafﬁc share, but makes content deliv-
ery inefﬁcient, as ﬁles are now fetched from European servers over
more expensive transatlantic links. For our purposes, a limitation of
these latter studies is that from their own vantage points, they can-
not assess the full exchange of trafﬁc between users and providers,
and thus cannot analyze the possibility of intermediate censorship
(occurring closer to the user). Our study leverages an ISP view-
point to address this issue and investigates the consequences of In-
ternet censorship on users, content providers and operators. To our
knowledge, this last perspective has not seen previous study.
3. DATA SOURCES FOR THE STUDY
Our primary data consists of six network traces captured at a
Pakistani ISP5 between 2011 and 2013. As discussed in Section 2,
the government of Pakistan implemented two of the most signif-
icant and persistent policies in its censorship history during this
period. Figure 1 illustrates the temporal relationship of the cap-
ture dates to the censorship events. The traces provide both pre-
censorship and post-censorship snapshots of activity seen at an ISP
for two major censorship events. We note that our data is not nec-
essarily broadly representative, as it corresponds to just one ISP.
5The ISP requested to treat its name, location and other identifying
information as conﬁdential. The ISP originally acquired the data
for unspeciﬁed purposes, and provided a degree of access out of
good will.
272Block
Key
–
–
P
P
PY
PY
Trace
Day
03Oct11
Tue
22Oct11
Sat
21Dec11 Wed
Tue
28Feb12
Tue
18Sep12
02Aug13
Fri
Capture Hour (PKT)
+ Duration
17:48 + 15h14m
18:49 + 20h42m
22:17 + 16h54m
18:48 + 11h08m
08:54 + 07h19m
09:40 + 06h00m
Size
(GB)
222
460
286
200
500
207
Active
Local IPs
1,075
1,046
868
974
310
136
Table 1: Summary of packet captures. P=Porn, Y=YouTube
IPv6 communication taking place over tunnels, its overall volume
is negligible.
Ethical Standards. The authors of this work with direct ac-
cess to the data signed a contract highlighting the obligations to (i)
respect user privacy, (ii) not share data with third parties (which
includes the other co-authors), (iii) not move data outside Pakistan,
(iv) not move data within Pakistan without prior consent, and (v)
undertake an objective study and refrain from maligning any party
involved in the censorship landscape (user, ISP, or government).
These restrictions did not affect our study in any respect.
3.2 Data Description
Table 1 characterizes the traces. Capture durations range be-
tween 6–16 hours and capture sizes between 200–500GB, com-
prising trafﬁc from 100–1,000 IP addresses. Some of these IP ad-
dresses likely reﬂect NATs, and thus the effective user population
could potentially range larger. Due to a number of variables in the
traces, a limitation of our work is that we cannot exclusively at-
tribute cross-trace trends to the consequences of censorship; these
might instead arise due to factors introduced by disparate cap-
ture days and/or timings. However, some of our results are sharp
enough that it appears very likely that they correspond to responses
to censorship. Finally, trace characteristics might differ between
traces despite similar trace durations and time frames because the
IP address preﬁxes allocated to a BRAS do not necessarily remain
consistent across traces.
Protocol Logs. Our analysis relies on protocol logs generated
using Bro [6]. In particular, we deal with connection, HTTP and
DNS logs. The connection log contains one entry per ﬂow, while
the protocol logs contain separate entries for each request-response
pair. We use number of connections to refer to distinct transport-
layer ﬂows and number of requests for individual request-response
pairs as observed in the protocol logs.
3.3 Data Sanitization and Characterization
For soundness of analysis, we ﬁrst identify measurement ambi-
guities/inaccuracies (sanitization) and then label the data (charac-
terization) so as to extract the portion relevant to a given analysis.
Data can include inaccuracies due to various reasons, where a
particularly common is the limitation of the capturing device or
analysis tool. A large portion of our data reﬂects connections that
did not fully establish (e.g., scanning activity). We remove such
connections from the bulk of our analysis (though we include them
when assessing evidence of user attempts to access blocked con-
tent). We identify unestablished connections based on Bro’s con-
nection state ﬁeld, which captures the sequence of control and data
packets seen for a given connection. We only include connec-
tions whose state reﬂects a completed three-way TCP establish-
ment handshake, which reduces our six data sets down to roughly
half the original number of connections, as reﬂected in Table 2.
To characterize our data, we label ﬂows based on the connection
direction and the type of local addresses involved, subsequently us-
ing only those subsets apt for a particular type of analysis. For
Figure 1: Temporal relationship of data to censorship events.
Figure 2: Capture location
Furthermore, it is difﬁcult for us to estimate the actual user popula-
tion of that ISP due to wide usage of NAT devices.
We supplement this data with a user survey we conducted in
the region to explore user behavior post-YouTube censorship [45].
The survey results help shape the scope of our YouTube censorship
analysis, and provide additional perspective for our ﬁndings from
the primary data.
3.1 Capture Location and ISP Overview
Our tier-2 Pakistani ISP peers with a tier-1 provider through the
Transworld Associates TWA-1 submarine telecommunications ca-
ble in Karachi. The ISP caters to both residential and SOHO cus-
tomers. Due to our conﬁdentiality agreement, we cannot provide
details regarding the scale at which the ISP operates, the magni-
tude of its customer base, or the address space it uses.
Figure 2 shows the data capture location within the ISP premises.
All customer lines terminate at one of several Broadband Remote
Access Servers (BRASes) in the ISP’s network. Each BRAS con-
nects to the ISP’s core Internet-facing router through a switch. The
ISP gathered the traces at the BRAS-facing side of this switch. This
vantage point captures all of the local ISP-generated trafﬁc (such as
redirected DNS trafﬁc) in addition to bi-directional trafﬁc going in