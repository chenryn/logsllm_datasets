mechanisms to detect drilling from the rear (the designers
even provide easily accessible circuit board pads to short the
tamper detection mechanism). However, the main process-
ing unit and the keypad are potted together, which makes it
harder to capture PIN keystrokes between the keypad and
the processor.
In both designs the secure storage for cryptographic keys
is fairly well protected. However, in each case it is possible
to tap the data line of the PED-smartcard interface. The data
exchanged on this line is not encrypted [12]; it yields both
the information we need to create a fake magnetic-strip card
and the PIN to use with it.
2.2 Signal eavesdropping attack
We defeated the Ingenico PED with a simple ‘tapping at-
tack’ thanks to a succession of design ﬂaws. Its rear has a
user-accessible compartment, shown in Figure 2(a), for the
insertion of optional SIM-sized cards to expand its func-
tionality. This space is not intended to be tamper-proof, and
when covered it cannot be inspected by the cardholder even
if she handles the PED. This compartment gives access to
the circuit board and many signals that are routed on its bot-
tom layer, though the sensor mesh layer mentioned earlier
prevents the attacker from drilling the PCB to access more
sensitive routes, such as the smartcard’s data line. Curi-
ously, however, the PED’s designers opted to provide the
attacker 1 mm diameter holes and other vias through the
PCB. The holes are used for positioning optional surface-
mount sockets; none of the PEDs we examined had these
sockets populated. Other exploitable vias do not seem to
serve any obvious electrical purpose. Through one of these
holes, a simple metal hook can tap the serial data line. This
tap is easy to place between the microprocessor and the card
interface chip. We preferred, however, to tap the signal be-
fore the interface chip, and found that a 1 mm diameter via,
carrying the data signal, is easily accessed using a bent pa-
283
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 03:13:41 UTC from IEEE Xplore.  Restrictions apply. 
(a) Circuit diagram; areas around pad and switch are connected to a battery to
prevent injection of a conductive liquid.
(b) Actual circuits; tamper response switch with a surrounding protective mesh wall; the whole printed
circuit layer is covered with a sensor mesh.
Figure 1. Tamper detection mechanisms of the Ingenico PED.
perclip. This can be inserted through a hole in the plastic
surrounding the internal compartment, and does not leave
any external marks.
Having tested this attack in the laboratory, we repeated it
in the ﬁeld for the BBC ‘Newsnight’ programme; we tapped
a terminal from a London shop and, during a transaction,
extracted the card and PIN details for a journalist’s card
without triggering the tamper detection system.
The Dione PED does not provide a concealed compart-
ment to hide the wiretap, but is still vulnerable. By drilling a
0.8 mm hole from the rear, we can insert a 4 cm needle into
a ﬂat ribbon connector socket shown in Figure 2(b). Fig-
ure 3 shows the full Dione attack, with the PED mounted,
as it would be in a shop, with a thin wire connected to an
FPGA board that translates the data and sends it to a lap-
top; the scope and laptop screen show an ‘answer to reset’
(ATR) initial exchange intercepted using the tap.
What should have required $25,000 needed just a bent
paperclip, a needle, a short length of wire and some cre-
ative thinking; attaching them to the data line takes minutes
with some practice. A small FPGA or microcontroller board
with some non-volatile memory can easily ﬁt inside the In-
genico PED’s compartment and record transaction details
without the cardholder’s knowledge, while a wire routed
from the back of a mounted Dione PED to a recorder un-
der the counter will not be detected unless the cardholder
conducts a very close inspection – and knows what to look
for. The recording circuit can be very small and either bat-
tery operated or attached to the PED’s power supply; with
a full transaction requiring about 1 kB of storage, even a
small memory can record thousands of transactions. Detect-
ing such a tap from within the PED is extremely difﬁcult,
since high input-impedance probes do not signiﬁcantly dis-
tort signals, and proper termination suppresses reﬂections;
Bond [12] has shown that even without these measures a tap
outside the terminal is not detected, while Drimer and Mur-
doch [20] showed that PEDs can drive 1.5 m cables placed
between the card slot and a card.
284
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 03:13:41 UTC from IEEE Xplore.  Restrictions apply. 
(a) A paperclip is shown inserted through a hole
in the Ingenico’s concealed compartment wall to
intercept the smartcard’s data. The front of the
PED is shown on the top right.
(b) A needle is shown inserted through the rear of
the Dione PED for data interception, attaching to a
ribbon cable connector shown on the bottom left; a
mounted PED is in the top right.
Figure 2. Tapping attacks on working Ingenico and Dione PEDs.
Figure 3. An implemented attack on a Dione PED. The white wire is connected to the FPGA board,
which sends the signals to the laptop via RS232; the ATR message can be seen on the scope and
laptop displays. The yellow wire is ground from the power supply.
285
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 03:13:41 UTC from IEEE Xplore.  Restrictions apply. 
Figure 4. A ﬂexible circuit board placed between the card and card-reader contacts transmits trans-
action details to a nearby receiver; low proﬁle components in the reader are used to create a simple
transmitter.
2.3 Shim-in-the-middle attack
We postulate, but have yet to implement, an attack of
inserting a thin, ﬂexible circuit board into the card slot, so
that it lodges between the reader and the card’s contacts.
This ‘shim-in-the-middle’ attack is illustrated in Figure 4;
a very basic circuit that can transmit the signal on the data
line to a nearby receiver would not be easily detected by a
cursory inspection, because it is within the PED itself. The
fraudster can create an ‘inserter card’ with the shim attached
to it so that, when inserted into a particular device, the shim
locks into place as the carrier card is removed. A receiver
is then placed nearby to record card details and PINs; this
receiver could easily include a mobile phone to SMS the
proceeds back to the fraudster.
This attack completely bypasses all tamper protections
and does not even require the participation of anyone in the
store. None of the PEDs we examined appeared to con-
tain any countermeasures to the shim attack, and it’s rather
hard to imagine what they might be.
If the PED vendor
included a LED and a photocell, for example, the shim de-
signer would just use a transparent material. One option is
to make the card slot transparent – though this means dump-
ing liability on unsuspecting cardholders. (A better, but not
infallible, option is PIN encryption, as we’ll discuss later.)
Note that a corrupt merchant may also prefer this type of
attack, as he can indignantly deny all knowledge of it in the
unlikely event that the police ﬁnd the shim.
2.4 Further attacks and observations
The Visa PED certiﬁcation criteria [41] insist that an at-
tacker not be able to hijack the display so as to prompt the
user to enter a PIN at any other time than intended, or to
tap the keypad interface to capture PIN keystrokes. We
have not seen any special protection given to those inter-
faces though the need to access multiple wires would make
an attack harder (unless more tamper prooﬁng mechanisms
are defeated). The keypad interface on the Dione PED is
better protected than Ingenico’s because it is potted, though
the display interface goes through the same connector we
tap for the smartcard’s data line. Furthermore, the Dione
PED is also a magnetic-strip card reader and a similar tap
attack can be made on that interface (though that would not
reveal the PIN).
Even if the PED were tamper-proof, pressure sensors in
a mat under it may be able to triangulate key-presses [29,
p132]. Another risk is that some PEDs don’t encrypt the
data they send to the bank, so a crooked store employee can
get the card data in clear from the local network and observe
the PIN using the Mark 1 human eyeball (this attack appears
to have been widely used in fuel stations, where CCTV has
also been used to capture PINs).
A further possible attack is terminal replacement. Some
terminals are handheld devices that communicate via wire-
less to a base station; yet the shopkeeper has to trust the
terminal display as to whether payment has been made. A
villain could walk into a jeweler’s shop, do a transaction
at which he swaps the terminal for an identical one that
he’s programmed to accept bogus cards too, then send in
accomplices with bogus cards to buy expensive goods [30].
(Banks even advise merchants not to look at a PED while
the customer is using it.) Other PEDs are connected to
stores or even bank counters using a detachable cable,
which raises the question of whether a recording device
placed between the PED’s connector and the cable could
do anything creative with the communications.
The primary goal of this research is to protect the card-
holder, and our secondary goal is to help merchants make
informed purchasing decisions. The publication of this
286
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 03:13:41 UTC from IEEE Xplore.  Restrictions apply. 
paper by itself should make it harder for banks to blame
customers for fraud by claiming systems are secure when
they’re not. We have successfully performed a live demon-
stration of the tapping attack and, given our experience, we
see no reason why the shim attack would fail or be detected.
We also do not think that we are revealing concepts not al-
ready known to the bad guys; there have already been at-
tacks using Trojanned terminals [9], and with a price tag of
$20 for each PED, all a crook needs is a sense of curiosity
and some imagination.
3 Defenses and attack extensions
We analyzed the main products from the market-leading
vendors. It may be that newer models are less vulnerable,
though the Ingenico PED we examined is still currently of-
fered as standard by Barclaycard. The prompt replacement
of insecure devices with more secure models could be pru-
dent; we don’t believe that ‘patching’ these devices is likely
to solve the problem.
In fact, we just do not believe the
interface between smartcard and PED can be protected ad-
equately, so changes in EMV system conﬁguration will be
needed. Essentially, the vulnerabilities we exploit are not
just a matter of hardware design, but also of the options
many banks chose as they implemented EMV.
In our view, EMV is ﬂawed in that it permits unen-
crypted PIN transfer over the hard-to-defend smartcard in-
terface. Even if cardholders ‘take matters into their own
hands’ by examining PEDs before PIN entry, ‘bugs’ may
be completely concealed in compartments, as with the In-
genico PED, or hidden as shims inside the card slot. Nev-
ertheless, there are some mitigation techniques – although
not all are as effective as they might at ﬁrst appear.
3.1 Encrypted PIN
Our attack reads data as it passes between PED and card
‘in the clear’. If both the card and PED support it, EMV
permits the PIN to be encrypted under the card’s public key.
Cards currently issued in the UK do not support this, as
banks chose a low-cost EMV option (SDA) where cards
do not possess the capability to do asymmetric cryptogra-
phy. Upgraded cards will prevent a passive eavesdropper
from observing the PIN (though card details are still unen-
crypted). This requires the card be capable of public key op-
erations, so only applies to appropriately conﬁgured DDA
and CDA cards [23].
However, due to a quirk in the EMV implementation,
PIN encryption can sometimes be bypassed. A card adver-
tises its support of encrypted PIN veriﬁcation by placing
an appropriate entry in the cardholder veriﬁcation method
(CVM) list, which is sent at the start of the transaction. In
eight out of the 15 cards we examined, the CVM list is not
signed, and so may be modiﬁed – causing the PIN to be
sent unencrypted. This attack can be done by an active tap
that selectively alters the communication, forcing a HIGH
bit to LOW so that the PED thinks that the card cannot pro-
cess encrypted PINs, and sends the cardholder’s PIN in the
clear. Conveniently for the attacker, CVM entries are nor-
mally qualiﬁed with 0x03, indicating that this applies to all
types of transactions, but by ﬂipping a single bit so it be-
comes 0x01, this entry will be ignored for purchases.
If a full middleman scenario can be implemented, a more
sophisticated attack may defeat even signed CVM lists.
Here, the attack device impersonates an entirely different
card to the PED at the start of the transaction, and presents
a CVM list that allows clear PIN entry. Once the customer
has entered their PIN and it has been intercepted, the attack
device causes the PED to restart the normal transaction. At
worst this looks like an intermittent error; in some PED im-
plementations it may be possible to avoid alerting the cus-
tomer at all.
This attack illustrates that evaluators should consider ac-
tive attacks too. All of the speciﬁcations we have examined
appear to consider only passive taps. But there may be some
mileage in anti-tampering measures that prevent the com-
munication path from being broken, and where the card or
PED checks if the data sent has been corrupted – a more
feasible task than detecting passive taps. Protocol defenses
are also possible: displaying the cardholder name from the
card’s certiﬁcate on the PIN entry prompt would allow some
middleman attacks to be detected.
3.2 iCVV
We mentioned above that all of the information needed
to clone a working magnetic-strip card from a chip card
is transmitted in clear during a normal EMV transaction.
This backward-compatibility feature is known to be a seri-
ous factor in the fallback vulnerability. Visa has therefore
proposed that the card veriﬁcation value (CVV), a crypto-
graphic checksum stored on the magnetic strip, be replaced
with a different one – the ‘iCVV’ (CVV for Integrated Cir-
cuit Cards) – in the card’s certiﬁcate [39].
Some systems don’t check CVVs, but many appear to,
and once iCVV is universal a fraudster wanting to make a
correct magnetic-strip card would have to recover the true
CVV from the mag strip using a ‘swipe and dock’ reader,
or by swiping the card in a separate reader. We strongly