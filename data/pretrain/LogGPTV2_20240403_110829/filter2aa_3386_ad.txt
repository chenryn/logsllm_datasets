Page 33 
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Google	
  Chrome:	
  passwords	
What	
  Google	
  knows	
  about	
  you	
Page 34 
message	
  PasswordSpeciﬁcsData	
  {	
  opRonal	
  int32	
  scheme	
  =	
  1;	
  opRonal	
  string	
  signon_realm	
  =	
  2;	
  opRonal	
  string	
  origin	
  =	
  3;	
  opRonal	
  string	
  acRon	
  =	
  4;	
  opRonal	
  string	
  username_element	
  =	
  5;	
  opRonal	
  string	
  username_value	
  =	
  6;	
  opRonal	
  string	
  password_element	
  =	
  7;	
  opRonal	
  string	
  password_value	
  =	
  8;	
  opRonal	
  bool	
  ssl_valid	
  =	
  9;	
  opRonal	
  bool	
  preferred	
  =	
  10;	
  opRonal	
  int64	
  date_created	
  =	
  11;	
  opRonal	
  bool	
  blacklisted	
  =	
  12;	
  opRonal	
  int32	
  type	
  =	
  13;	
  opRonal	
  int32	
  Rmes_used	
  =	
  14;	
}	
message	
  PasswordSpeciﬁcs	
  {	
  opRonal	
  EncryptedData	
  encrypted	
  =	
  1;	
  opRonal	
  PasswordSpeciﬁcsData	
  client_only_encrypted_data	
  =	
  2;	
}	
Obtaining	
  master	
  encryp;on	
  keys	
Chrome	
  sync	
hbps://clients4.google.com/chrome-­‐sync/command/?client=Chromium&client_id=[...]	
(body:protobuf	
  with	
  GetUpdatesMessage(need_encrypRon_key=true)	
response:	
  GetUpdatesResponse	
  with	
  entries	
  &	
  encrypRon	
  key	
Get	
  master	
  encryp,on	
  keys	
Key=pbkdf2_sha1(base64(encrypRon_key)+"saltsalt",1003)	
MacKey=pbkdf2_sha1(base64(encrypRon_key)+"saltsalt",1004)	
The	
  keys	
  can	
  be	
  addi;onally	
  encrypted	
  using	
  the	
  passphrase	
  (on	
  the	
  client	
  side)	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Google	
  Dashboard:	
  stats	
  we	
  can	
  get	
What	
  Google	
  knows	
  about	
  you	
Page 35 
Account	
•  email	
•  number	
  of	
  Google	
  API	
  clients	
  (sites	
  and	
  apps)	
•  account	
  Rme:	
  personal,	
  work,	
  both	
•  AcRviRes	
  in	
  last	
  28	
  days	
•  browsers	
  and	
  OSs	
  that	
  had	
  access	
•  locaRons	
•  new	
  apps	
  and	
  sites	
Android	
•  manufacturer,	
  model	
•  ﬁrst	
  authorizaRon	
  date/Rme	
•  last	
  acRvity	
  date/Rme	
•  apps	
  that	
  backups	
  their	
  data	
  (name,	
  date,	
  size)	
YouTube	
•  number	
  of	
  videos	
  and	
  playlists	
  loaded	
•  user	
  name	
•  sex	
•  last	
  video	
  raRng	
  (+video	
  name	
  and	
  date)	
•  acRviRes	
  for	
  last	
  28	
  days	
•  number	
  of	
  views,	
  by	
  day	
•  total	
  views	
•  searches	
•  likes	
  and	
  dislikes	
Proﬁle	
  info	
•  Google+	
  name	
•  proﬁle	
  URL	
•  number	
  of	
  phone	
  numbers	
•  number	
  of	
  "+1"	
Search	
  history	
  (query+date)	
•  last	
  Web	
  search	
•  last	
  image	
  search	
•  last	
  news	
  search	
•  last	
  video	
  search	
•  last	
  maps	
  search	
•  last	
  books	
  search	
•  acRviRes	
  for	
  last	
  28	
  days	
•  top	
  10	
  searches	
•  percentage	
  of	
  searches	
  by	
  category	
  (web,	
  image	
  etc)	
•  acRvity	
  (by	
  day)	
Google	
  Sync.	
  (non-­‐Android	
  devices)	
•  number	
  of	
  bookmarks	
•  last	
  sync	
  date	
•  number	
  of	
  passwords	
•  number	
  of	
  Chrome	
  extensions	
•  other	
Gmail	
•  number	
  of	
  mail	
  threads	
•  last	
  thread	
  subject	
•  number	
  of	
  messages	
  in	
  inbox	
•  last	
  incoming	
  message	
  subject	
•  number	
  of	
  sent	
  mails	
•  last	
  sent	
  mail	
  subject	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Google	
  Authen;ca;on	
  –	
  the	
  easy	
  way	
  (Oauth	
  2.0)	
What	
  Google	
  knows	
  about	
  you	
Page 36 
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Authen;ca;on:	
  w/o	
  browser	
What	
  Google	
  knows	
  about	
  you	
Page 37 
get	
  loginCookies	
hbps://accounts.google.com/ServiceLogin?hl=en-­‐US&Email=	
Set-­‐Cookie:	
  GAPS=1:Y5AaGrgj-­‐_VQrcWkpM6f75T6H8A:B2wnWWUI2DKLUWCd	
Set-­‐Cookie:	
  GALX=EmxneFPdphD;Path=/;Secure	
get	
  client_id	
POST	
  hbps://accounts.google.com/ServiceLoginAuth	
Cookie:	
  GALX=[…]	
Set-­‐Cookie:	
  NID=[...]	
Set-­‐Cookie:	
  SID=[...]	
…	
get	
  refresh_token	
  (by	
  client_id,	
  then	
  by	
  client_secret	
  и	
  oauth_code)	
hbps://accounts.google.com/o/oauth2/programmaRc_auth?authuser=0	
Set-­‐Cookie:	
  oauth_code=4/5xOmk7KEXG70-­‐3cYAju66pp8sx1U4FyCIRWI_J1zQ	
hbps://accounts.google.com/o/oauth2/token	
{	
  "access_token"	
  :	
  "ya29.yAHuL5lPQW63Yn90hVETqe95ueyM8SpoqhyqPmy-­‐hTywd4chkANfQTt0VNeTBMQhrkw",	
  "refresh_token"	
  :	
  "1/slXyWGQPs1IVI7t-­‐VC3_VKWSWUYJONt1Ue8tRG-­‐pc"	
}	
get	
  access_token	
hbps://accounts.google.com/o/oauth2/token	
  HTTP/1.1	
client_id=[...]&client_secret=[...]&grant_type=refresh_token&refresh_token=[...]&scope=[…]	
Calendar	
hbps://www.googleapis.com/auth/calendar.readonly	
Contacts	
hbps://www.googleapis.com/auth/contacts.readonly	
User	
  info	
hbps://www.googleapis.com/auth/userinfo.proﬁle	
Chrome	
  data	
hbps://www.googleapis.com/auth/chromesync	
Photos	
hbps://picasaweb.google.com/data/	
Google	
  drive	
hbps://www.googleapis.com/auth/drive	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
•  Phishing	
•  Brute-­‐force	
  abacks	
•  “Reverse”	
  brute-­‐force	
  abacks	
•  Password	
  reset/recovery	
•  Key	
  loggers	
•  Fake	
  AP	
•  Network	
  sniﬃng	
•  Social	
  engineering	
•  Passwords	
  re-­‐use	
How	
  Hackers	
  Get	
  Passwords	
What	
  Google	
  knows	
  about	
  you	
Page 38 
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
•  Same	
  way	
  as	
  hackers	
•  Surveillance	
•  From	
  suspect’s	
  PC	
  or	
  Mac	
•  Direct	
  access	
  to	
  cloud	
  storage	
•  Just	
  ask	
  J	
How	
  LE	
  Get	
  Passwords	
What	
  Google	
  knows	
  about	
  you	
Page 39 
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
•  Do	
  not	
  use	
  clouds*	
•  Do	
  not	
  keep	
  sensiRve	
  informaRon	
  on	
smartphone*	
•  Use	
  3rd	
  party	
  encrypRon	
  apps**	
•  Avoid	
  phishing	
•  Think	
  of	
  physical	
  security	
•  Use	
  a	
  strong	
  password	
•  Change	
  the	
  password	
  regularly	
•  Pay	
  abenRon	
  to	
  noRﬁcaRon	
  emails	
•  Enable	
  two-­‐step	
  veriﬁcaRon	
How	
  to	
  protect	
  yourself?	
What	
  Google	
  knows	
  about	
  you	
Page 40 
(*)	
  Not	
  actually	
  possible	
(**)	
  Bad	
  advise	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Vladimir	
  Katalov,	
  ElcomSo0	
  Co.	
  Ltd.	
hbp://www.elcomso0.com	
hbp://blog.crackpassword.com	
Facebook:	
  ElcomSo0	
Twiber:	
  @elcomso0	
What	
  Google	
  knows	
  about	
  you	
Page 41 
What	
  Google	
  knows	
  about	
  you	
  and	
  your	
  devices	
(and	
  how	
  to	
  get	
  it)