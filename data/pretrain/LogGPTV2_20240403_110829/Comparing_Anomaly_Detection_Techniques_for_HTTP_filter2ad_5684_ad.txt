# 优化后的文本

## 图7. 接收者操作特征（ROC）曲线展示6-gram算法的准确性

n-grams通过将标记序列编码为有向图，以类似于DFA和马尔可夫模型的方式有效地建模请求的结构或语法。n-grams允许少量不匹配，从而最小化误报，并能够更好地区分正常请求和无意义请求。

### 4.7 误报
系统管理员需要检查误报以确定它们是正常的流量还是攻击。在比较算法时，一个有用的指标是该算法对管理员的工作负荷。表1展示了假设真正例率为80%时每天的误报率。此表使用cs.unm.edu数据集的数据，显示只有6-grams和DFA具有可能适用于像UNM CS部门这样的网站的误报率。

大多数先前的研究将误报报告为非攻击测试数据中被错误识别的比例，这在前面部分呈现的ROC图中有所体现。对于网站来说，如果一个人必须评估异常请求以确定它们是否代表攻击，这个结果可能会产生误导。一个访问量较小的网站可以容忍1%的误报率；而像Amazon.com或Google.com这样的大型网站则需要大量的全职人员来处理同样的误报率。0.01的误报率对应于cs.unm.edu、aya.org、i-pi.com和explorenm.com分别每天917、50、8和43个误报。在1999年DARPA/MIT林肯实验室IDS测试中，他们表示每天超过10个误报被认为是高误报率[15]。

### 表1. 使用cs.unm.edu数据训练和测试的算法每天的误报率
| 算法 | 每天误报数 |
| --- | --- |
| 马氏距离 | 91,524 |
| ICD的χ² | ∞ |
| 长度 | ∞ |
| 6-grams | 13 |
| DFA | 37 |
| 马尔可夫模型（对数变换） | 39,824 |
| 线性组合 | ∞ |

### 5 讨论
第4节的结果表明，基于字符的算法（马氏距离、ICD的χ²和长度）明显不如两种基于标记的算法（DFA、n-grams）准确。标记代表了更高的词汇单位，并用于表示含义；攻击通常表现为无意义的请求。由于“昨天就要发货”和其他截止日期的压力，程序员往往专注于使系统在常见情况下工作，并较少关注异常情况。此外，考虑所有可能表示异常状态的方式需要许多程序员未受过的思维方式。在我们的攻击数据库中，几乎所有攻击都是无意义的。更好地表示HTTP请求的意义可以提高算法区分正常和异常的能力。据推测，正常的请求不会表示无意义的内容。应用于我们测试的算法，DFA和n-grams学习有效HTTP请求的高级结构，因此可以利用这些结构更好地判断请求是否正常。

基于标记的两种算法在相似性度量方面都有弱点，无法区分带有少数新标记的新颖请求和带有少量标记的攻击。这是导致一些攻击被遗漏的原因之一。另一个被DFA遗漏的攻击可以追溯到用户的输入错误。在训练数据中出现了//标记对，导致从路径分隔符/节点返回自身的边。不幸的是，beck攻击[7]利用了大量的/来在旧版本的Apache中造成内存不足的情况。

表示请求意义的想法使我们能够做出预测：将统计方法应用于标记而不是字符可能比应用于组成请求的字符更准确。然而，标记之间的关系对于语义很重要。除非度量能够表示这些关系，否则标记上的统计方法可能不够准确。实际上，忽略标记之间的关系，如应用于标记的字符分布算法将继续过度泛化，因此更容易受到模仿攻击。例如，考虑特定单词分布的所有英语句子与那些结构良好且不是无意义的句子。

### 6 结论
本文在现实条件下评估和比较了七种不同的HTTP入侵检测算法。这项测试比迄今为止报告的任何HTTP IDS测试都更为严格。为了进行比较，我们实现了一个开源IDS测试框架，并开发了最全面的HTTP攻击开放数据库，专为IDS测试设计。

大多数先前的HTTP IDS方法都将请求表示为字符字符串。我们报告的工作是最早使用解析请求中的标记的方法之一，也是首次将这些标记与DFA归纳和n-grams结合使用。这些算法比早期的方法检测到更多的攻击。其中一个原因是，我们使用完整的HTTP请求，而不仅仅是其中的一部分——大多数以前的IDS忽略了请求的一部分，显然无法检测到被忽略部分中的攻击。

我们的测试结果可以通过两个因素来解释。首先是HTTP请求的数据表示。我们已经证明，基于标记的方法使得算法能够更好地辨别有意义和无意义的内容，从而更好地辨别合法请求和攻击。第二个因素是泛化。我们在使用标记的算法中包含了几种泛化启发式方法。关于泛化效果的详细讨论不在本文范围内，但可以在Ingham[20]中找到。

本研究表明，所有算法的误报率都不可接受。我们需要额外的算法和启发式方法来改进性能。此外，我们的工作表明，新的方法应该基于标记，因为它们比当前算法更好地表示HTTP请求。我们希望本文描述的IDS测试框架能鼓励进一步的研究。

### 致谢
感谢匿名审稿人的评论和建议。第一作者部分由美国国家科学基金会资助（ANIR-9986555）。第二作者由加拿大政府通过MITACS资助。

### 参考文献
... （参考文献部分保持不变）

这样优化后的文本更加清晰、连贯和专业。希望对你有所帮助！