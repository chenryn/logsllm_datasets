图3-23Proxy的界面
2.Spider
Spider的蜘蛛爬行功能可以帮助我们了解系统的结构，其中Spider爬取到的内容
将在Target中展示，如图3-24所示，界面左侧为一个主机和目录树，选择具体某一个
分支即可查看对应的请求与响应。
22233
图3-24Spider界面
---
## Page 74
第3章常用的渗透测试工具
55
3.Decoder
Decoder的功能比较简单，它是Burp中自带的编码解码及散列转换的工具，能对
原始数据进行各种编码格式和散列的转换。
Decoder的界面如图3-25所示。输入域显示的是需要编码/解码的原始数据，此处
可以直接填写或粘贴，也可以通过其他Burp工具上下文菜单中的“Send toDecoder”
选项发送过来：输出域显示的是对输入域中原始数据进行编码/解码的结果，无论是
输入域还是输出域都支持文本和Hex这两种格式，编码解码选项由解码选项（Decode
as）、编码选项（Encodeas）、散列（Hash）构成。在实际使用时，可以根据场景的需
要进行设置。
loAats
输入
输出
图3-25Decoder的界面
对编码解码选项而言，目前支持URL、HTML、Base64、ASCII、十六进制、八
进制、二进制和GZIP共八种形式的格式转换，Hash散列支持SHA、SHA-224、
SHA-256、SHA-384、SHA-512、MD2、MD5格式的转换。更重要的是，对同一个数
据，我们可以在Decoder界面进行多次编码、解码的转换。
3.2.3BurpSuite进阶
3.2.3.1Scanner
Burp Scamner主要用于自动检测Web系统的各种漏洞。本小节介绍Burp Scanner
的基本使用方法，在实际使用中可能会有所改变，但大体环节如下。
---
## Page 75
56
Web安全政防：渗透测试实战指南
首先，确认Burp Suite正常启动并完成浏览器代理的配置。然后进入BurpProxy，
关闭代理拦截功能，快速测览需要扫描的域或URL模块，此时在默认情况下，Burp
Scanner会扫描通过代理服务的请求，并对请求的消息进行分析来辨别是否存在系统
漏洞。而且当我们打开BurpTarget时，也会在站点地图中显示请求的URL树。
我们随便找一个网站进行测试，选择BurpTarget的站点地图选项下的链接，在其
链接URL上右击选择“Actively scan this host”，此时会弹出过滤设置，保持默认选项
即可扫描整个域，如图3-26所示。
bup
v7.11-7
图3-26选择扫描
也可以在Proxy下的HTTPhistory中，选择某个节点上的链接URL并右击选择Do
an active scan进行扫描，如图3-27所示。
这时，Burp Scanner开始扫描，在Scanner界面下双击即可看到扫描结果，如图3-28
所示。
---
## Page 76
第3章常用的渗造测试工具
主动扫描
图3-28查看扫描结果
---
## Page 77
58
Web安全政防：渗透测试实践指南
我们也可以在扫描结果中选中需要进行分析的部分，将其发送到repeater模块中
进行模拟提交分析和验证，如图3-29所示。
图3-29发送到repeater模块
当scanner扫描完成后，可以右击Burp Target站点地图选项下的链接，依次选择
“issues”→“Report issues”选项，然后导出漏洞报告，如图3-30所示。
图3-30导出漏洞报告
---
## Page 78
第3章常用的渗造测试工具
59
然后将漏洞报告以html文件格式保存，结果如图3-31所示。
Burp Scanner Report
Summary
图3-31扫描结果
通过以上操作步骤我们可以学习到：BurpScamner主要有主动扫描和被动扫描两
种扫描方式。
1.主动扫描（ActiveScanning）
当使用主动扫描模式时，Burp会向应用发送新的请求并通过Payload验证漏洞。
这种模式下的操作会产生大量的请求和应答数据，直接影响服务端的性能，通常用
于非生产环境。主动扫描适用于以下这两类漏洞。
·客户端的漏洞，如XSS、HTTP头注入、操作重定向。
·服务端的漏洞，如SQL注入、命令行注入、文件遍历。
对第一类漏洞，Burp在检测时会提交input域，然后根据应答的数据进行解析。
在检测过程中，Burp会对基础的请求信息进行修改，即根据漏洞的特征对参数进行
修改，模拟人的行为，以达到检测漏洞的目的：对第二类漏洞，以SQL注入为例，服
务端有可能返回数据库错误提示信息，也有可能什么都不反馈。Burp在检测过程中
会采用各个技术验证漏洞是否存在，例如诱导时间延迟、强制修改Boolean值、与模
糊测试的结果进行比较，以提高漏洞扫描报告的准确性。
---
## Page 79
60Web安全攻防：渗遗测试实战指南
2.被动扫描（PassiveScanning）
当使用被动扫描模式时，Burp不会重新发送新的请求，只是对已经存在的请求
和应答进行分析，对服务端的检测来说，这比较安全，通常适用于生产环境的检测。
一般来说，下列漏洞在被动模式中容易被检测出来。
·提交的密码为未加密的明文。
不安全的cookie的属性，例如缺少HttpOnly和安全标志。
。cookie的范围缺失。
·跨域脚本包含和站点引用泄露。
表单值自动填充，尤其是密码。
·SSL保护的内容缓存。
。目录列表。
·提交密码后应答延迟。
·session令牌的不安全传输。
敏感信息泄露，例如内部IP地址、电子邮件地址、堆栈跟踪等信息泄露。
。不安全的ViewState的配置。
错误或不规范的Content-Type指令。
虽然被动扫描模式相比主动模式有很多不足，但同时也具有主动模式不具备的
优点。除了对服务端的检测比较安全，当某种业务场景的测试每次都会破坏业务场
景的某方面功能时，可以使用被动扫描模式验证是否存在漏洞，以减少测试的风险。
3.2.3.2Intruder
Intruder是一个定制的高度可配置的工具，可以对Web应用程序进行自动化攻击，
如通过标识符枚举用户名、ID和账户号码，模糊测试，SQL注入，跨站，目录遍历等。
它的工作原理是lntruder在原始请求数据的基础上，通过修改各种请求参数获取
不同的请求应答。在每一次请求中，Intruder通常会携带一个或多个有效攻击载荷
（Payload），在不同的位置进行攻击重放，通过应答数据的比对分析获得需要的特征
数据。BurpIntruder通常被应用于以下场景。
。标识符枚举。Web应用程序经常使用标识符引用用户、账户、资产等数据
---
## Page 80
第3章常用的渗造测试工具
信息。例如，用户名、文件ID和账户号码。
提取有用的数据。在某些场景下，不是简单地识别有效标识符，而是通过
简单标识符提取其他数据。例如，通过用户的个人空间ID获取所有用户在
其个人空间的名字和年龄。
模期测试。很多输入型的漏润（如SQL注入、跨站点脚本和文件路径遍历）
可以通过请求参数提交各种测试字符串，并分析错误消息和其他异常情况，
来对应用程序进行检测。受限于应用程序的大小和复杂性，手动执行这个
测试是一个耗时且烦琐的过程，因此可以设置Payload，通过BurpIntruder
自动化地对Web应用程序进行模糊测试。
下面将演示利用Intruder模块爆破无验证码和次数限制的网站的方法，如图3-32
所示，这里使用方法只是为了实验，读者不要将其用于其他非法用途。前提是你得
有比较好的字典，我们准备好的字典如图3-33所示。需要注意的是，BurpSuite的文
件不要放在中文的路径下。
用户登录
图3-32爆破网站
---
## Page 81
Z9
Web安全攻防：渗透测试实战指南
其本正（Ctoh
新建文件夹
名称
修次日期
大小
li onder1.3.2,ull
2017/2/20 下年2
Ei emap
9$94 s///102
文件夹
文件典
ai rolan2
909±L 5/9/c1o2
文件夹
2017/6/4 下年12
文件典
Ji Tor Br
2017/6/11 下平3
文特央
@] Lhtml
2017/6/26 下年1
2012/6/20上年1
HTML 文指
2012/6/20上午1文本交班
文本定
L1
1
Mac' (Z
图3-33字典
首先将数据包发送到intruder模块，如图3-34所示。
图3-34抓包发送到intruder模块
Burp会自动对某些参数进行标记，这里先清除所有标记，如图3-35所示。
---
## Page 82
第3章常用的渗遗测试工具
63
图3-35清除标记
然后选择要进行暴力破解的参数值，将pass参数选中，单击“AddS”按钮，这里
只对一个参数进行暴力破解，所以攻击类型使用sniper即可，如图3-36所示。这里要
注意的是，如果要同时对用户名和密码进行破解，可以同时选中user和pass参数，并
且选择交叉式clusterbomb模式进行暴力破解。
Sniper模式使用单一的Payload组。它会针对每个位置设置Payload。这种攻
击类型适用于对常见漏洞中的请求参数单独进行Fuzzing测试的情景。攻击
中的请求总数应该是position数量和Payload数量的乘积。
Batteringram模式使用单一的Payload组。它会重复Payload并一次性把所有
相同的Payload放入指定的位置中。这种攻击适用于需要在请求中把相同的
输入放到多个位置的情景。请求的总数是Payload组中Payload的总数。
Pitchfork模式使用多个Payload组。攻击会同步选代所有的Payload组，把
Payload放入每个定义的位置中。这种攻击类型非常适合在不同位置中需要
插入不同但相似输入的情况。请求的数量应该是最小的Payload组中的
Payload数量。
Clusterbomb模式会使用多个Payload组。每个定义的位置中有不同的
Payload组。攻击会选代每个Payload组，每种Payload组合都会被测试一遍。
这种攻击适用于在位置中需要不同且不相关或者未知输入攻击的情景。攻
击请求的总数是各Payload组中Payload数量的乘积。
---
## Page 83
84
Web安全政防：渗透测试实战指南
图3-36选中pass参数
下面选择要添加的字典，如图3-37所示。
Burp Sute Pruofensional L7.11-Temp
ary Project-
Peyiead set
正
Phetat tpe Rrte
Sle
C
图3-37选中字典
然后开始爆破并等待爆破结束，如图3-38所示。
---
## Page 84
第3章常用的渗造测试工具
65
I Paylo
图3-38开始爆破
这里对Status或Length的返回值进行排序，查看是否有不同之处。如果有，查看
返回包是否显示为登录成功，如果返回的数据包中有明显的登录成功的信息，则说
明已经破解成功，如图3-39所示。
TagPos
302
W
2121
717
04%
302
302
口
2121
2121
2121
2121
SsecureS
2121
1
AMUI
302
1212
"mpn
302
V*
2121
2121
212
图3-39查看length的返回值
3.2.3.3
8Repeater
BurpRepeater是一个手动修改、补发个别HTTP请求，并分析它们的响应的工具。
它最大的用途就是能和其他BurpSuite工具结合起来使用。可以将目标站点地图、Burp
---
## Page 85
Web安全攻防：渗造测试实战指南
Proxy测览记录、BurpIntruder的攻击结果，发送到Repeater上，并手动调整这个请求
来对漏洞的探测或攻击进行微调。
Repcater分析选项有4种：Raw、Params、Headers和Hex
Raw：显示纯文本格式的消息。在文本面板的底部有一个搜索和加亮的功
能，可以用来快速定位需要寻找的字符串，如出错消息。利用搜索栏左边
的弹出项，能控制状况的灵敏度，以及是否使用简单文本或十六进制进行
搜索。
Params：对于包含参数（URL查询字符串、cookie头或者消息体）的请求，
Params选项会把这些参数显示为名字/值的格式，这样就可以简单地对它们
进行查看和修改了。
Headers：将以名字/值的格式显示HTTP的消息头，并且以原始格式显示消
息体。
Hex：允许直接编辑由原始二进制数据组成的消息。
在渗透测试过程中，我们经常使用Repeater进行请求与响应的消息验证分析，例如
修改请求参数、验证输入的漏洞：修改请求参数、验证逻辑越权：从拦截历史记录中，
捕获特征性的请求消息进行请求重放。本节将抓包发送到Repeater，如图3-40所示。
图3-40发送到Repeater
---
## Page 86
第3章常用的渗造测试工具67
在Repeater的操作界面中，左边的Request为请求消息区，右边的Response为应答
消息区，请求消息区是示的是客户端发送的请求消息的详细信息。当我们编辑完请
求消息后，单击“Go”按钮即可发送请求给服务端，如图3-41所示。
06 (85 0)
图3-41发送请求
应答消息区显示的是对对应的请求消息单击“GO”按钮后，服务端的反馈消息。
通过修改请求消息的参数来比对分析每次应答消息之间的差异，能更好地帮助我们
分析系统可能存在的漏洞，如图3-42所示。
图3-42应答消息区显示服务端的反馈消息
---
## Page 87
89
Web安全政防：渗透测试实践指南
3.2.3.4Comparer
BurpComparer在Burp Suite中主要提供一个可视化的差异比对功能，来对比分析