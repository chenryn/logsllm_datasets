·如果系统瘫痰或重要数据丢失，恢复的难度有多大？费用有多高？
对于大型网络，许多服务器需要制定专门的防护解决方案，一般需要购买专门的网络版防
病毒软件。网络版具有管理和信息搜集功能，所有客户端情况在控制台可以一目了然：管理区
域较广，还可提供详细的图形化病毒报告：一旦在局城网中任何一台计算机上发现病毒，都能
够自动地将病毒信息传递给网络管理员。此外，还可以全网统一配置防毒策略、全网统一升级
版本。下面是一个典型的案例。
某金业网络由一个一级网和多个二级网组成，各个二级网在管理上相对独立，网络层次多、
结构复杂、应用繁多。通过利用瑞星网络版的多中心产品创建了分级管理安全体系模式，它将
信息安全的管理权限分为多个级别，在企业内部设立超级管理员和普通管理员，这种分级管理
的模式使信息安全管理员的工作变得更加明确和轻松，从根本上解决了网络管理难度大，操作
困难这一难题，实现了对网络信息安全高效、简易的管理要求。不仅如此，管理员还可以通过
管理员控制台直接对Outlook、LotusNotes、Foxmail、Netscape等邮件客户端产品进行监控设
置和对邮件数据库进行病毒扫描，染毒邮件信息将直接在控制台中显示，最大程度地防止了病
毒通过邮件方式的扩散。具体结构如图4.11所示。
房毒管理服务
图4.11分级管理安全体系模式的结构
此外，文件服务器是企业网络中最常见的服务器，它可能会道受大量的引导型病毒、DOS
病毒、32位Windows病毒以及宏病毒等的攻击，更为常见的是，由于文件服务器为网络中所
有工作站提供文件资源共享，因而也成为病毒理想的隐身寄居场所，进面会将病毒轻易地扩散
到网络中的所有工作站上。不少厂商对此推出了专门针对类似服务器的解决方案，如趋势科技
的ServerProtectforNT文件/应用服务器级解决方案。
179
---
## Page 189
网络安全进阶笔记
3.网络防护层
如今，利用网络协议以及应用漏洞进行攻击和入侵也会造成巨大的破坏。可能有人会间，
客户网络上的PC和服务器一般也有防病毒软件，为什么还会遭受如此大的损失呢？答案很简
单，因为这些方案并不完善，因为内网PC和服务器安全策略更新不是一件轻松的事，此外PC
防病毒软件也不能防掉所有的病毒，尤其是传播迅速快的蟠虫类病毒，同时防病毒软件对黑客
入侵无能为力。在已记录的恶意软件事件中，通过网络发动的攻击是最多的，通常，发动慈意
软件攻击是为了利用网络漏洞访问主机设备，这些设备可以是客户端、服务器、路由器，甚至
是防火墙。顺应市场需求，统一威胁管理（UTM）应运而生，UTM是将企业防火墙、入侵检测
和防御以及防病毒结合于一体的设备，通过它，可以做到执行应用层数据扫描，以检测病毒和
入侵。具体内容分析如下。
（1）安装入侵检测系统。在以往的方法中，都是如何通过建立、改善以及分析服务器日记
文件的种种方式监测病毒攻击，但这些都是过去式，都是在入侵发生后你才知道存在这种行为
而加以防范。最好的方法是能够当场就监测出病毒攻击行为，并且马上采取防范反击措施加以
纠正。因此即时监测入侵行为并以程序自动产生响应的网络入侵监测系统（文称IDS）产生了。
入侵检测，顾名思义，便是对入侵行为的发觉。它通过对计算机网络或计算机系统中的若
干关键点收集信息并对其进行分析，从中发现网络或系统中是否有违反安全策略的行为和被攻
击的迹象。与其他安全产品不同的是，入侵检测系统需要更多的智能，它必须可以对得到的数
据进行分析，并得出有用的结果。一个合格的入侵检测系统能大大地简化管理员的工作，保证
网络安全地运行。
(2）企业防大墙设置。长期以术，防火墙在网络安全解决方案中一直扮演着举足轻重的角
色，不过，它在病毒防护中的作用被忽略了。看看冲击波病毒的解决方案，我们就可以了解防
火墙在反病毒中的作用了：“在防火墙上过滤掉TCP端口135，用于防止DCOMexploit攻击：
在防火墙上过滤掉TCP端口4444，用于防范受到DCOM攻击后的主机系统通过shell复制病
毒：在防火墙上过滤掉UDP端口69，用于防范tftp连接的建立”。从上面的解决方案可以看
出，过滤TCP/UDP端口是其中的重要一环，在网关防火墙上过滤这些端口将有效避免此类病
毒的传播。
区域之间安装防火墙后，将极大地降低Blaster之类的端虫病毒在内网中的危害。这种解
决方案的特点是具备预防能力，即在防火墙上过滤掉不必要的端口，例如在WWW服务器上
只开80等个别端口，在不提供Web服务的办公主机上过滤1~1023端口访向，就能较好地预
防针对系统漏洞而爆发的端虫病毒。
（3）内容扫描。电子邮件和Intemet已成为第一并且增长最快的病毒散布源，因此，防止
这些病毒的侵害势在必行。内容扫描是在更高级防火墙解决方案中作为一项功能提供，或者作
为单独服务（如电子邮件）的组件提供，限制不适合的Web内容和邮件垃圾的侵害。例如，趋势
科技的IMSS是一款基于网关防毒和内容安全策略的产品，是专为阻止通过电子邮件进行传播
的病毒以及保护企业安全整体性而设计的，它特有的发作预防功能充分利用内容扫描功能来封
堵通过电子邮件进行传播的病毒，以增强病毒防御能力。
（4）URL过滤。通过URL过滤，可以阻止有问题的网站。例如，可阻止已知的黑客网站、
下载服务器和垃圾邮件服务器，避免遭受进一步的攻击。
.1.80
---
## Page 190
三
第4章拒绝恶意代码与神秘的黑客
因此，一个完整的网络安全解决方案应涵盖从网络边界到内部某个区域，再到主机系统及
其上应用的每个环节，将防火墙、IDS、防病毒、安全管理、集中审计与分析等多个安全产品
有机结合，并在实践中不断修补和提升。
4.1.5手机病毒的发展与防范
最近有很多资料和消息显示，手机病毒将会是病毒发展的下一个目标。手机病毒的原理和
计算机病毒一样，是以手机为感染对象，以手机网络和计算机网络为平台，通过病毒短信等形
式，对手机进行攻击，从面造成手机异常的一种新型病毒。
手机病毒其实也和计算机病毒一样，可以通过电脑执行从面向手机乱发短信息。严格地讲，
手机病毒应该是一种电脑病毒，这种病毒只能在计算机网络上进行传播而不能通过手机进行传
播，因此所调的手机病毒其实是电脑病毒程序启动了电信公司的一项服务，例如电子邮件到手
机短信息的功能，面且它发给手机的是文档，根本就无破坏力可言。当然也有的手机病毒破坏
力还是比较大的，一且发作可能比个人电脑病毒更厉害，其传播速度，甚至会比“我爱你”病
毒更快。
侵袭上网手机的病毒，会自动启动电话录音功能，并将录音四处传送，病毒也会自动打出
电话、删除手机上的档案内容，以及制造出金额庞大的电话账单。由于部分手机病毒是从自动
打出电话时散播，又因为手机网络联系得太完善，因面它比电脑病毒影响更广，面且将来随手
机设计更复杂及功能更多元化，病毒带来的灾害亦会更广。
另外由于手机还有其他的数据通讯方式，例如短信息，WAP服务，一方面这些确实能给
我们带来方便，只需按几个键就可以换个LOGO，下载你喜爱的铃声。但正是这些功能也拥有
可以写入系统或记忆体的指令，破坏者只要找出缺口，传出一个带毒的短信息，以Assembly
Programming改变系统的机内码（MachineCode），将指令藏在记忆体中，然后就可以开启其他
手机的电话本，大肆传播病毒，在一定时间内发作，破坏手机的开机系统。
1.手机病毒的攻击方式
现在有不少手机用户担心WAP手机将会成为黑客攻击的重要对象。因为通过网络直接对
WAP手机进行攻击比对GSM手机进行攻击更加简便易行。对此，一些专家曾指出，由于此类
技术难度很大，加之手机网络运营商大多已在WAP服务器和网关部位设置了安全系统，所以
一般用户基本不用担心。
手机病毒一般会从两个方面进行攻击，一种是攻击移动网络，通过对网络服务器和网关的
被坏与控制，使用户无法正常收发短信息，享受正常的移动数据服务，并且还会向手机用户发
送大量的垃圾信息，使用户不胜其烦：另一种攻击方式是直接对手机进行攻击，利用手机操作
系统的漏洞，破坏手机操作系统，删除手机中存储的数据，使手机系统不能正常工作甚至期溃，
并且也有可能损坏手机芯片，使手机硬件也受损。
目前有些手机厂商已经开始探索手机防毒的方法，比如在手机中安装反病毒软件，建立专
为用户提供下载服务的网站等。不过，普通手机病毒影响力目前还比较小，主要是各种手机的
功能虽然基本相同，但是内核芯片的构造和技术大不一样，各种不同型号手机之间的病毒传播
可能并不一定能成功。
181
---
## Page 191
网络安全进阶笔记
2.手机病毒的主要类型
目前市面上已经出现不少手机病毒，比较典型的如下，
·EPOC_ALARM：总是持续发出警告声音，虽无大害，却也颜为烦人。
·EPOC_BANDINFO.A：发作时会将用户信息变更为“Somefoolownthis”
EPOC_FAKE.A：会在手机的屏幕上显示格式化内置硬盘时画面，无需惊慌，因为实
际上手机并不会执行格式化操作的。
EPOC_GHOST.A：会在画面上显示“Everyonehatesyou”。
EPOC_LIGHTS.A：会使背景灯BackLight持续闪烁。
·EPOC_ALONE.A：可以使键盘操作失效。
前5种的危害并不很大，并且还有种恶作刷的味道，但第6种“EPOC_ALONEA”却是
一种恶性病毒。当电脑执行有毒的程序时，会显示红外线通信接收文件时所显示的画面，并在
此时将病毒悄悄地藏入内存之中。当病毒在内存中安营扎寨之后，会在电脑画面上显示
“Waming-Vinus”的信息，此后手机便不接受任何键盘操作。当您发现以后，可以输入
“leavemealone”来解除病毒常驻。
最近，有些手机出现“卡比尔（cabir）”病毒，这种病毒在手机上运行时，就会在开机时显
示"Caribe"字样。这种病毒利用蓝牙在运行Symbian
系统的手机之间互相传染。中毒后手机会启动蓝牙
检序管理
功能对临近其他已打开蓝牙功能的手机进行搜索，
发现后将病毒打包成为安全文件传到那部已开蓝牙
功能的机器上，感染后，当于机开启时就会在屏幕
上显示“Caribe”字样，这种病毒可以修改Symbian
系统。如图4.12所示。
8
图4.12卡比尔（cabir）手机病毒
3.对手机病毒采取的措施
对付病毒应当注意以下介绍的方法：
关闭乱码电话。当对方的电话打过来时，本来屏幕上显示的应该是来电电话号码，但
却显示别的字样或奇异的符号。如果遇到上述场合，接电话者应不回答或立即把电话
关闭。如接听来电，则会感染上这种病毒，同时机内所有新名词及设定将被破坏。
。
尽量少从网上下载信息。病毒要想侵入，要先攻破手机短信息的保护系统，过复杂的
编码程序的关，再在流动的网络上传送，所以并不是那么容易，但随着3G的来临，
手机趋向于成为一部小型电脑，而有电脑病毒，就会有手机病毒。
防止短信息中可能存在的病毒。短信息的收发越来越成为移动通信的一个重要方式，
然而短信息也是感染手机病毒的一个重要途径。在近期的亚洲反病毒大会上透露出的
消息表明，手机病毒的发展已经从潜伏期过渡到了破坏期，已经引起各界的注意，手
机用户一旦接到带有病毒的短信息，阅读后就会出现手机键盘被锁，甚至破坏手机IC
卡等恶性问题
。
对手机进行病毒查杀。目前应对手机病毒的主要技术措施有两种，其一是通过无线网
站对手机进行杀毒：其二是通过手机的IC接入口或红外传输口进行杀毒。
当然手机病毒在目前还没有达到那种可怕的地步，因为以手机目前的数字处理能力（容量
---
## Page 192
第4章拒绝恶意代码与神秘的黑客
和运算），还不至于强大到可以独立处理、传播病毒。所以病毒只能通过电脑、WAP服务器、
WAP网关来骚扰手机，而对手机本身实质性的破坏（破坏智能卡、乱拨号等）从技术上讲是非常
困难的。
4.2木马攻击与反木马攻击全程演练
特洛伊木马英文叫做“TrojanHorse”，其名称取自希腊神话的特洛伊木马记，它是一种
基于远程控制的黑客工具，具有隐蔽性和非授权性的特点。所请隐蔽性，是指木马的设计者为
了防止木马被发现，会采用多种手段隐藏木马，这样服务端即使发现感染了木马，由于不能确
定其具体位置，往往只能望“马”兴叹：所请非授权性，是指一旦控制端与服务端连接后，控
制端将享有服务端的大部分操作权限，包括修改文件、修改注册表、控制鼠标/键盘等，这些
权力并不是服务端赋予的，而是通过木马程序窃取的。
4.2.1危险木马的潜伏方法与分类
从木马的发展来看，基本上可以分为两个阶段，最初网络还处于以Unix平台为主的时期，
本马就产生了，当时的木马程序的功能相对简单，往往是将一段程序嵌入到系统文件中，用跳
转指令来执行一些木马的功能，在这个时期本马的设计者和使用者大都是些技术人员，必须具
备相当的网络和编程知识，而后随着Windows平台的日益普及，一些基于图形操作的本马程
序出现了，用户界面的改善，让使用者不用懂太多的专业知识就可以熟练地操作木马，相应的
本马入侵事件也频繁出现，而且由于这个时期木马的功能已日趋完善，因此对服务端的破坏也
更大了。
说到木马，人们就想到病毒，需要强调一下的是，本马确实被杀毒软件认为是病毒，但是，
本马本身不是病毒！反之，病毒也不是木马！木马和病毒最大的区别在于本身有无复制能力，
众所周知，病毒是会通过各种途径和方法复制自身的，能够广泛传播是病毒之所以可怕的一个
主要原因，可以这样认为，传播能力越强的病毒越可怕！木马可以说是一种后门程序，而且是
用户“心甘情愿”地把它请进去的，混进去的希腊士兵打开了特洛伊的城门，木马程序也是同
样的道理，它也会在用户的系统中打开一个“后门”，黑客们就会从这个被打开的特定的“后
门”进入电脑，然后就可以随心所欲地摆布用户的电脑了，如果要问黑客们通过木马进到你的
电脑里以后能够做什么？可以这样说，用户能够在自己的电脑上做什么，木马也同样可以办到：
用户能够写文件，他也可以写，用户能够看图片，他也可以看，他还可以得到你的隐私、密码，
甚至用户在电脑上鼠标的每一下移动，他都可以尽收眼底！而且还能够控制你的鼠标和键盘去