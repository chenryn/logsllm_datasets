### 优化后的文本

---

**实验结果与分析**

#### 水平进度
- **0.5 ± 0.2 / 2.3 ± 1.2**
- **0.5 ± 0.1 / 5.7 ± 2.4**
- **0.7 ± 0.3 / 3.4 ± 2.3**
- **5.3 ± 0.1 / 11.3 ± 0.6**
- **7.5 ± 0.2 / 15.9 ± 3.8**

#### 实验设计
马里奥在停止移动时会被杀死。这一决策旨在产生类似速通的结果，以缩短执行时间。我们使用AFL及其与IJON注释结合的方法来玩游戏，并观察游戏中的进展。

#### AFL和IJON的比较
- **AFL无注释运行**：我们让AFL运行了12小时，并观察马里奥能够到达的不同关卡的位置。随后，我们添加了一个简单的注释，使用`ijon_max`原语。为每个可能的高度（以瓦片为单位）创建一个槽位，并在每个槽位中最大化玩家的X坐标。修改后的代码如Listing 9所示，结果见Table III，示例见Figure 1。
- **IJON注释**：通过这个简单的单行注释，模糊器在几分钟内解决了几乎所有关卡。实际上，使用IJON，AFL能够解决除3个关卡外的所有关卡。需要注意的是，其中一个关卡（第6-2关）是可以解决的。未能解决的原因是模糊测试的固有随机性。在另一个离线实验中，IJON有时能在不到6小时内解决该关卡。第4-4关由于模拟中的一个错误而无法解决。最后一个关卡由于我们对游戏进行的修改而变得极难解决。

相比之下，纯AFL的表现较为挣扎：它需要更长的时间才能解决较少的关卡，并且在未解决的关卡中取得的进展也较少。尽管如此，AFL仍然表现出色，能够通过诸如“生成管道、云、敌人或灌木”等事件的边缘计数来解决大约三分之一的关卡。

#### 游戏中的漏洞利用
《超级马里奥兄弟》包含许多著名的漏洞和秘密通道，通常被速通者利用。我们的模糊器至少找到了并利用了其中两个：
1. 在第4-2关中，我们成功地从关卡顶部离开，进入了著名的传送区域。
2. 在多个时刻，马里奥使用了“墙壁跳跃”技巧，避免了一些死亡。要执行墙壁跳跃，马里奥必须跳入墙壁，在一帧时间内脚进入墙壁，然后物理引擎将其推回。在这帧时间内，马里奥可以再次跳跃。这个技巧需要完美的时机和精确地击中墙壁的角落（马里奥的位置以亚像素精度跟踪）。

#### 结构化输入格式的探索
为了展示状态变化日志在探索结构化输入格式方面的能力，我们在三个示例上评估了AFL与IJON的组合。前两个示例来自AFLSMART的评估。Pham等人在其论文中讨论了libpng和WavPack两个例子。我们选择了这两个示例，并添加了简单的`state_change_log`注释。我们运行了24小时，使用Intel Core i7-6700 CPU（3.40 GHz）和16 GB RAM，并提供了随机wav/png文件的前1024字节作为种子，并使用源代码中的字符串字典。通过这个简单的注释，我们能够在两个目标中发现漏洞，而纯AFL没有发现任何漏洞。此外，我们在libpng中发现了一个仍然存在的越界读取漏洞。这表明对于这些结构化输入格式，不需要语法就能发现安全问题。在解析器代码中添加一个小注释有时可以提供相同的好处，但成本更低。

为了进一步验证这一点，我们选择了另一个示例LIBTPMS，这是一个用于可信平台模块（TPM）安全协处理器的软件模拟器。TPM指定了一个协议，用于与协处理器交互。该协议包括多种可能的消息，每种消息都有特定的解析器。我们展示了AFL只探索了所有可能消息序列的一小部分。通过引入一个IJON注释（两行），我们观察到探索的消息组合数量显著增加。我们使用AFL的持久模式来提高模糊测试性能，并在分配的时间内获得更可靠的结果。

#### 初始运行与IJON对比
- **初始运行**：我们运行了AFL 24小时，并绘制了找到的路径子集。结果见Table IV中的“plain”列。为了可视化，我们还包含了在一个运行中找到的所有消息的图。每个节点是一个成功解析和处理的消息。如果成功处理了消息A和B，则在节点A和B之间添加一条边。
- **IJON**：我们添加了一个基于状态变化日志的注释，存储最后4个成功解析和处理的消息ID。然后使用这些ID创建额外的反馈。注释后的代码见Listing 7。使用此注释，我们进行了另一次24小时运行。找到的路径数量见Table IV中的“IJON”列。我们观察到，IJON导致了更复杂的交互。

从AFLSMART示例和TPM的实验中可以看出，使用状态变化日志注释大大提高了探索不同消息链（因此是状态）的能力，这是现有技术所不能覆盖的。特别是，我们的实验显示IJON显著增加了探索的消息序列的数量。

| 序列长度 | 纯AFL | AFL + IJON | 改进倍数 |
| --- | --- | --- | --- |
| 1 | 14 | 14 | 1x |
| 2 | 53 | 156 | 2x |
| 3 | 85 | 1636 | 18x |
| 4 | 79 | 2532 | 32x |

---

希望这些改进使你的文档更加清晰、连贯和专业。如果有其他需求，请告诉我！