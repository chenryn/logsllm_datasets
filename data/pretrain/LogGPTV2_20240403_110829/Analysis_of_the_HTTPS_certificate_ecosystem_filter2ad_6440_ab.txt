root store. This allows us to validate any certiﬁcate signed by
a previously encountered intermediate CA regardless of the
presented certiﬁcate chain.
3. Following each scan, we check certiﬁcates without a known
issuer against the set of known authorities and revalidate any
children for which there is a newly found issuer. This resolves
the case where an intermediate is later found in a subsequent
scan.
We parse collected TLS certiﬁcates using OpenSSL and maintain
a PostgreSQL database of parsed data and historical host state.
4.3 Reducing Scan Impact
We recognize that our scans can inadvertently trigger intrusion
detection systems and may upset some organizations. Many net-
work administrators perceive port scans as the preliminary step in a
targeted attack and in most cases are unable to recognize that their
systems are not being uniquely targeted or that our research scans
are not malicious in nature.
In order to minimize the impact of our scans and to avoid trigger-
ing intrusion detection systems, we scanned addresses according to
a random permutation over a twelve hour period from a block of 64
sequential source IP addresses. When we perform a host discovery
scan, an individual destination address receives at most one probe
packet. At this scan rate, a /24-sized network receives a probe packet
every 195 s, a /16 block every 0.76 s, and a /8 network block every
3 ms on average. In the certiﬁcate retrieval phase, we perform only
one TLS handshake with each host that responded positively during
host discovery.
In order to help users identify our intentions, we serve a simple
webpage on all of the IP addresses we use for scanning that explains
the purpose of our scanning and how to request that hosts be ex-
cluded from future scans. We also registered reverse DNS records
that identify scanning hosts as being part of an academic research
study. Throughout this study, we have coordinated with our local
network administrators to promptly handle inquiries and complaints.
Over the course of 14 months, we received e-mail correspondence
from 145 individuals and organizations. In most cases, notiﬁcations
were informative in nature—primarily notifying us that we may
have had infected machines—or were civil requests to be excluded
from future scans. The vast majority of these requests were received
at our institution’s WHOIS abuse address or at the e-mail address
published on the scanner IPs. In these cases, we responded with
the purpose of our scans and excluded the sender’s network from
future scans upon request. Ultimately, we excluded networks be-
longing to 91 organizations or individuals and totaling 3,753,899
addresses (0.11% of the public IPv4 address space). Two requests
originating from Internet service providers accounted for 49% of
the excluded addresses. During our scans, we received 12 actively
hostile responses that threatened to retaliate against our institution
legally or via denial-of-service (DoS) attacks on network. In 2 cases
we received retaliatory DoS trafﬁc, which was automatically ﬁltered
by our upstream provider.
We discuss the ethical implications of performing active scanning
and provide more details about the steps we take to reduce scan
impact in our previous work [13].
4.4 Data Collection Results
1. If the presented chain is invalid, we attempt to reorder the
certiﬁcate chain. This resolves the situation when the correct
We completed 110 successful scans of the IPv4 address space,
completing 2.55 billion TLS handshakes, between June 6, 2012 and
Scan
Date Completed
Hosts with port 443 Open
Hosts serving HTTPS
Unique Certiﬁcates
Unique Trusted Certiﬁcates
Alexa Top 1 Mil. Certiﬁcates
Extd. Validation Certiﬁcates
EFF [14]
2010-8
16,200,000
7,704,837
4,021,766
1,455,391
(unknown)
33,916
Ps & Qs [16]
2011-10
28,923,800
12,828,613
5,758,254
1,956,267
89,953
71,066
First Representative
2013-3-22
33,078,971
21,427,059
8,387,200
3,230,359
141,231
103,170
2012-6-10
31,847,635
18,978,040
7,770,385
2,948,397
116,061
89,190
Latest
2013-8-4
36,033,088
24,442,824
9,031,798
3,341,637
143,149
104,167
Total
Unique
(unknown)
108,801,503
42,382,241
6,931,223
261,250
186,159
Table 1: Internet-wide Scan Results — Between June 6, 2012 and August 4, 2013, we completed 110 scans of the IPv4 address space on
port 443 and collected HTTPS certiﬁcates from responsive hosts.
August 4, 2013. Like to Holz et al. [17], we note that a large number
of hosts on port 443 do not complete a TLS handshake. In our
case we ﬁnd that only 67% of hosts with port 443 open successfully
complete a TLS handshake.
We retrieved an average of 8.1 million unique certiﬁcates during
each scan, of which 3.2 million were browser trusted. The remaining
4.9 million untrusted certiﬁcates were a combination of self-signed
certiﬁcates (48%), certiﬁcates signed by an unknown issuer (33%),
and certiﬁcates signed by a known but untrusted issuer (19%). In to-
tal, we retrieved 42.4 million distinct certiﬁcates from 108.8 million
unique IP addresses over the past eleven months. Of the hosts that
performed complete TLS handshakes, an average of 48% presented
browser-trusted X.509 certiﬁcates.
In our largest and most recent scan on August 4, 2013, we re-
trieved 9.0 million certiﬁcates from 24.4 million IP addresses of
which 3.3 million were browser trusted. We show a comparison
with previous work in Table 1. We also note that over 95% of trusted
certiﬁcates and over 98% of hosts serving trusted certiﬁcates are
located in only ten countries, shown in Table 2.
Authorities Certiﬁcates
Country
United States
United Kingdom
Belgium
Israel
Netherlands
Japan
Germany
France
Australia
Korea
30.34%
3.27%
2.67%
1.63%
2.18%
3.38%
21.28%
3.98%
0.81%
1.41%
Hosts
77.55% 75.63%
10.88% 18.15%
1.51%
3.29%
0.87%
2.56%
0.49%
1.32%
1.06%
1.19%
0.35%
0.88%
0.14%
0.38%
0.11%
0.34%
0.24%
0.09%
Table 2: Top 10 Countries Serving Trusted Certiﬁcates
In this study, we choose to perform non-temporal analysis on
the results from a representative scan, which took place on March
22, 2013 (highlighted column in Table 1). We choose to focus
on the results from a single point-in-time instead of considering all
certiﬁcates found over the past year due to varying lifespans. We ﬁnd
that organizations utilize certiﬁcates of differing validity periods
and that in some cases, some devices have presented a different
certiﬁcate in all of our scans. If we considered all certiﬁcates from
the past year instead instead of what was hosted at a single point in
time, these short lived certiﬁcates would impact the breakdown of
several of our statistics.
4.5
Is Frequent Scanning Necessary?
Frequent repeated scans allow us to ﬁnd additional certiﬁcates
that would not otherwise be visible. We can illustrate this effect
by considering the 36 scans we performed between January 1 and
March 31, 2013 and analyzing the number of scans in which each
certiﬁcate was seen. We ﬁnd that 54% of browser-trusted certiﬁcates
appeared in all 36 scans and that 70% of trusted certiﬁcates appear
in more than 30 of our 36 scans. However, surprisingly, we ﬁnd that
33% of self-signed certiﬁcates appeared in only one scan during the
three month period. Many of these self-signed certiﬁcates appear to
be served by embedded devices that generate new certiﬁcates on a
regular basis. We found an average of 260,000 new certiﬁcates per
scan during this period. The distribution is shown in Figure 1. Ulti-
mately, we ﬁnd that there are considerable advantages to scanning
more frequently in obtaining a global perspective on the certiﬁcates
valid at any single point in time, as well as the changing dynamics
of the ecosystem over extended periods.
4.6 Server Name Indication Deployment
Both Holz [17] and Akhawe [4] cite Server Name Indication (SNI)
as one of the reasons they choose to scan the Alexa Top 1 Million
Domains and perform passive measurement instead of performing
full IPv4 scans. Server Name Indication is a TLS extension that
allows a client to specify the hostname it is attempting to connect
to from the start of the TLS negotiation [9]. This allows a server to
present multiple certiﬁcates on a single IP address and to ultimately
host multiple HTTPS sites off of the same IP address that do not
share a single certiﬁcate. Because we connect to hosts based on
IP address in our scans and not by hostname, we would potentially
miss any certiﬁcates that require a speciﬁc hostname.
In order to better understand the deployment of SNI and its impact
on our results, we scanned the Alexa 1 Million Domains [1] using the
same methodology we used for scanning the IPv4 address space. Of
the Alexa Top 1 Million Domains, 323,502 successfully performed
TLS handshakes and 129,695 of the domains presented browser-
trusted certiﬁcates. Of the domains that completed a TLS handshake,
only 0.7% presented certiﬁcates we had not previously seen in the
most recent scan of the IPv4 address space. We cannot bound the
number of hosts missed due to the deployment of SNI and it is clear
that a small number of websites are adopting SNI, but we believe
that our results are representative of certiﬁcate usage patterns. One
reason SNI has not seen widespread deployment is because Internet
Explorer on Windows XP does not support SNI. Although Windows
XP market share is on the decline, it still represents more than a
third of all operating system installations [26].
5. CERTIFICATE AUTHORITIES
The security of the HTTPS ecosystem is ultimately dependent on
the set of CAs that are entrusted to sign browser-trusted certiﬁcates.
Except in a small handful of cases, any organization with control of
a signing certiﬁcate that chains to a browser-trusted root can sign
a leaf certiﬁcate for any domain. As such, the entire ecosystem is
as fragile as the weakest CA. However, because there is no central,
public registry of browser-trusted intermediate authorities, the or-
ganizations that control these signing certiﬁcates may be unknown
until certiﬁcates they have signed are spotted in the wild. In this
section, we describe the CAs we found during our scans and some
of the practices they employ.
5.1
Identifying Trusted Authorities
We observed 3,788 browser-trusted signing certiﬁcates between
April 2012 and August 2013 of which 1,832 were valid on March
22, 2013. All but seven of these signing certiﬁcates can sign a
valid browser-trusted certiﬁcate for any domain. This is 25% more
than were found by the EFF in 2010 and more than 327% more
than were found by Ristic [31]. Holz et al. ﬁnd 2,300 intermediate
certiﬁcates in their active scanning [17]. However, this count appears
to represent both browser-trusted and untrusted intermediates, of
which we ﬁnd 121,580 in our March 22 scan and 417,970 over the
past year. While the raw number of signing certiﬁcates and HTTPS
ecosystem as a whole have grown signiﬁcantly over the past three
years, we were encouraged to ﬁnd that the number of identiﬁed
organizations has not grown signiﬁcantly.
These 1,832 signing certiﬁcates belong to 683 organizations and
are located in 57 countries. While a large number of countries have
jurisdiction over at least one trusted browser authority, 99% of the
authorities are located in only 10 countries. We show the breakdown
in Table 2. We classiﬁed the types of the organizations that control
a CA certiﬁcate, which we show in Table 3. We were surprised
to ﬁnd that religious institutions, museums, libraries, and more
than 130 corporations and ﬁnancial institutions currently control an
unrestricted CA certiﬁcate. Only 20% of organizations that control
signing certiﬁcates are commercial CAs. We were unable to identify
15 signing certiﬁcates due to a lack of identiﬁcation information
or ambiguous naming. We also note that while there has been a
2% increase in the raw number of valid signing certiﬁcates over
the past year, we have found negligible change in the number of
organizations with control of a signing certiﬁcate.
5.2 Sources of Intermediates
Organizations other than commercial CAs control 1,350 of the
1,832 (74%) browser-trusted signing certiﬁcates, which raises the
question of who is providing intermediate certiﬁcates to these orga-
nizations. We ﬁnd that 276 of the 293 academic institutions along
with all of the libraries, museums, healthcare providers, and reli-
gious institutions were signed by the German National Research and
Education Network (DFN), which offers intermediate certiﬁcates to
all members of the German network. DFN provided CA certiﬁcates
to 311 organizations in total, close to half of the organizations we