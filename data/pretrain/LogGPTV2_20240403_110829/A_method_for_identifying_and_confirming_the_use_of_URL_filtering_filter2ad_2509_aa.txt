title:A method for identifying and confirming the use of URL filtering
products for censorship
author:Jakub Dalek and
Bennett Haselton and
Helmi Noman and
Adam Senft and
Masashi Crete-Nishihata and
Phillipa Gill and
Ronald J. Deibert
A Method for Identifying and Conﬁrming the Use of URL
Filtering Products for Censorship∗
Jakub Dalek⋆, Bennett Haselton⋆, Helmi Noman⋆, Adam Senft⋆, Masashi Crete-Nishihata⋆,
Phillipa Gill†⋆, Ronald J. Deibert⋆
⋆ The Citizen Lab, University of Toronto
† Dept. of Computer Science, Stony Brook University
Abstract
Products used for managing network traﬃc and restrict-
ing access to Web content represent a dual-use technology.
While they were designed to improve performance and pro-
tect users from inappropriate content, these products are
also used to censor the Web by authoritarian regimes around
the globe. This dual use has not gone unnoticed, with West-
ern governments placing restrictions on their export.
Our contribution is to present methods for identifying in-
stallations of URL ﬁltering products and conﬁrming their
use for censorship. We ﬁrst present a methodology for iden-
tifying externally visible installations of URL ﬁltering prod-
ucts in ISPs around the globe. Further, we leverage the fact
that many of these products accept user-submitted sites for
blocking to conﬁrm that a speciﬁc URL ﬁltering product is
being used for censorship. Using this method, we are able to
conﬁrm the use of McAfee SmartFilter in Saudi Arabia and
the United Arab Emirates (UAE) and Netsweeper in Qatar,
the UAE, and Yemen. Our results show that these products
are being used to block a range of content, including op-
positional political speech, religious discussion and gay and
lesbian material, speech generally protected by international
human rights norms.
Categories and Subject Descriptors: C.2.2 [Computer-
Communication Networks]: Network Protocols
General Terms: Measurement Keywords: Censorship;
Network Measurement; URL ﬁltering
1.
INTRODUCTION
URL ﬁltering products, used for managing Web traﬃc
and restricting access to content, are extremely common in
corporate, educational and ISP networks around the globe.
However, these technologies, which were designed to improve
performance and ﬁlter inappropriate content in the enter-
prise setting, represent a dual-use technology. Indeed, there
have been numerous reports of URL ﬁltering products pro-
∗Data available at: http://goo.gl/Cc1v0
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full cita-
tion on the ﬁrst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from permissions@acm.org.
IMC’13, October 23–25, 2013, Barcelona, Spain.
Copyright 2013 ACM 978-1-4503-1953-9/13/10 ...$15.00.
http://dx.doi.org/10.1145/2504730.2504763 .
duced by Western companies being sold in countries with
poor human rights records, where they are used for censor-
ship and surveillance [2–5, 28, 30]. The use of technology
developed in North America and Europe against citizens
by authoritarian regimes presents many legal and ethical
issues.
In the past two years, the United States [26], Eu-
rope [29], and Israel [7] have all taken steps to limit the ex-
port of these technologies to countries under sanctions such
as Syria and Iran. Further, as part of the OpenNet Initia-
tive (ONI), we have documented numerous cases of products
developed by Western companies being used to limit free-
dom of speech online via censorship and potentially surveil-
lance [11, 13, 14, 21, 32] over the past ten years.
With the stakes so high, it is important that we have
techniques for monitoring the use of speciﬁc technologies for
censorship. These tools can help inform policymakers and
even vendors, who may be unaware that their technology is
being used for censorship. In 2009, Websense actually with-
drew software update support once the ONI informed them
that their technology was being used for censorship by the
government of Yemen [35]. While our methodologies have
suﬃced thus far, recent legal implications of our observa-
tions beg for repeatable methodologies that produce high
conﬁdence results.
Challenges of measuring URL ﬁltering deployments.
Measuring URL ﬁltering products is complicated by the fact
that censorship is diﬃcult to observe without vantage points
located within the country of interest. Through our involve-
ment in ONI, we have managed to gain access to measure-
ments from within many countries with restrictive ﬁltering
regimes. However, performing client-based measurements in
some countries is considered too risky (e.g., Cuba, North Ko-
rea), thus we cannot claim global coverage. Further, identi-
fying installations of speciﬁc URL ﬁltering products requires
an understanding of distinct properties of the product un-
der consideration (e.g., relevant HTTP headers) and careful
validation to avoid false positives. Finally, even if a given
product is installed in a country, it does not necessarily mean
it is being used for censorship/surveillance purposes.
Our contribution. With these challenges in mind, we
sought to design a simple, repeatable, methodology for iden-
tifying installations of URL ﬁltering products and conﬁrm-
ing their use for censorship. Our method for identifying
URL ﬁlter installations (§3) serves to identify installations
of ﬁltering products where we can apply our conﬁrmation
methodology (§4); however, the conﬁrmation methodology
alone is enough to verify that a speciﬁc product is used for
censorship in a given network. Our identiﬁcation method-
23Table 1: Summary of products we consider.
Company
Blue Coat [1]
Headquarters
Sunnyvale, CA, USA
Product description
Web proxy (ProxySG) and URL Filter
(Web Filter)
Previously observed
Burma,
Kuwait,
Qatar, Saudi Arabia, Syria,
UAE [14, 32]
Egypt,
McAfee SmartFilter [16]
Santa Clara, CA, USA
Filtering of Web content for enterprises Bahrain,
Netsweeper [18]
Websense [34]
Guelph, ON, Canada
San Diego, CA, USA
Netsweeper Content Filtering
Web proxy gateways including features
to monitor for corporate data leakage.
Iran,
Saudi
Kuwait,
Arabia,
Oman,
Tunisia, UAE [11, 21, 22]
Qatar, UAE, Yemen [21]
Yemen (prior to 2009) [21]
ology hinges on the observation that some URL ﬁlter in-
stallations are visible on the global Internet (likely due to
inexperienced network administrators). We came to this ob-
servation during initial study of Syria where external facing
IP addresses were used to host Blue Coat products [32]. We
develop methodologies to locate a set of these externally vis-
ible IPs and verify that (1) they are hosting the suspected
product and (2) conﬁrm the product is indeed used for cen-
sorship (when we have access to in-country measurements).
Our study highlights the human rights implications of these
products and can provide ground truth for Web proxy ﬁn-
gerprinting (as is done by Netalyzr [12, 17]).
Our study highlights many properties
Key insights.
of URL ﬁlters that underscore the importance of studying
their use. Speciﬁcally, we observe the use of these prod-
ucts in multiple North American ISPs which raises issues
about monitoring how these products are being used on a
global scale, and not just in jurisdictions commonly con-
sidered in censorship studies (§3). We further highlight
complications in terms of how URL ﬁlters are implemented
(e.g., inconsistent blocking and use of multiple products)
that make characterizing their use challenging (§4). Finally,
we demonstrate our proposed method by conﬁrming the use
of Netsweeper and McAfee SmartFilter for censorship of con-
tent protected by human rights norms in Qatar, Saudi Ara-
bia, the UAE and Yemen (§5).
Limitations. We note that our methodology for identi-
fying installations of URL ﬁltering products requires that
these installations be visible on the global Internet, thus
the identiﬁcation method is likely identifying installations
that are not maintained by a technically sophisticated ad-
ministrator. Further, we are not robust to products that
attempt to evade our proﬁling. Thus, our results should be
viewed as presenting a high conﬁdence subset of URL ﬁlter
deployments. We discuss these limitations in more detail in
Section 6.
2. BACKGROUND
2.1 URL ﬁltering products
There are multiple methods that may be used for imple-
menting URL ﬁltering systems. These products usually in-
clude a database of pre-categorized URLs, that allow the
network operator to conﬁgure which categories to block within
their network, and the ability to create custom categories
for blocking. The products may also include a subscrip-
tion/update component to push newly categorized URLs to
the product’s database. Depending on the functionality pro-
vided by the product (e.g., whether it proxies all Web traf-
ﬁc), the product may be sold as software to be installed by
the administrator or as a stand-alone middlebox in the case
of proxies. Table 1 summarizes the products we consider.
2.2 Prior work by the OpenNet Initiative
The OpenNet Initiative has studied Internet censorship
for the past decade [11, 13, 14, 21, 32]. Over the course of the
project, we began to observe products developed by Western
companies used for censorship by repressive regimes, start-
ing with SmartFilter products in Tunisia in 2005. By 2010,
we had documented extensive use of Western technologies
for censorship in the Middle East and North Africa (MENA)
region [21]. Table 1 highlights the products we have dis-
covered, as well as the countries where we have located
them.
Initially, our methods for identifying these prod-
ucts consisted of manual analysis of block pages for com-
pany logos/branding and product names in HTTP headers.
Over time, however, we observed Western vendors obscure
the use of their products (e.g., by omitting logos on block
pages [21]). In response, we have been developing novel tech-
niques to conﬁrm use of URL ﬁltering products. This paper
expands upon these eﬀorts by describing how we identify
networks containing URL ﬁlter installations (§3) and how
we conﬁrm that these installations are in fact being used for
censorship (§4).
The policy impacts of our eﬀorts thus far, have been mixed.
In 2009, our identiﬁcation of Websense in Yemen led to the
vendor discontinuing support of their product for the Yemen
government [35]. In contrast, Netsweeper stated that is not
against their company policies to aid foreign governments
in implementing Internet censorship. Finally, we have ob-
served Blue Coat withdraw update support from Syria [32],
as a result of legal sanctions against the country [26]. How-
ever, the company still plays a role in Internet censorship
in many countries around the world, and has even been
named an “enemy of the Internet” by Reporters Without
Borders [6]. Part of our goal in this study is to present a re-
peatable methodology for identifying and conﬁrming the use
of these products for censorship to inform future discussions
with vendors and policy makers.
3.
IDENTIFYING URL FILTERS
We begin by presenting our methodology to identify in-
stallations of URL ﬁltering products. As described in Sec-
tion 2.2, we previously leveraged user reports to identify
URL ﬁltering products. However, as vendors remove brand-
ing from block pages,
it becomes more diﬃcult for non-
technical users to identify these products. Further, the in-
dividuals we engage with tend to be biased towards certain
regions of interest (e.g., the MENA region). In this section,
we present an identiﬁcation method that does not depend
24Table 2: Summary of our methodology for identifying URL ﬁltering products.
Product
Blue Coat
Shodan keywords
“proxysg”,“cfru=”
McAfee SmartFilter
“mcafee web gateway”, “url blocked”
Netsweeper
Websense
“netsweeper”,
min/”,“webadmin/deny”, ”8080/webadmin/”
“blockpage.cgi”, “gateway websense”
“webadmin”,
“webad-
WhatWeb signature
Built in detection or Location header contains
hostname “www.cfauth.com”
Via-Proxy header or HTML title
“McAfee Web Gateway”
Built in detection
contains
Location header redirects to a host on port 15871
with parameter “ws-session”
on user reports and is more scalable than manual inspection,
by examining HTTP headers and Web directory structure
for evidence of ﬁltering installations.
3.1 Methodology
Our methodology leverages the observation that URL ﬁl-
tering products are sometimes conﬁgured such that they are
visible on the global Internet. Since they are visible on the
global Internet, these products can be located via external
scans of IP address space. Indeed, our group has previously
leveraged network scans to identify Blue Coat installations
in Syria [14, 32]. As a proof of concept, we demonstrate our
techniques using the Shodan search engine [27] to locate IP
addresses, but are working towards applying it on a larger
scale with the Internet Census [10] data in ongoing work.
Locating potential installations. The Shodan search
engine [27] indexes the IP addresses of externally visible de-
vices on the Internet. Entries in Shodan consist of an IP
address, along with meta-data and HTTP headers observed
when the IP address was accessed by the search engine. By
manually analyzing results from the ONI tests, we were able
to identify commonly appearing keywords and headers for
the products we consider (summarized in Table 2). These
keywords include HTTP headers (e.g., “ProxySG” for Blue
Coat) and paths known to be associated with the manage-
ment console (e.g., “8080/webadmin” for Netsweeper). We
search for these keywords, in combination with each of the
two letter country-code top-level domains, to maximize the
set of results we obtain from Shodan.
Validating URL ﬁlter installations. When locating IP
addresses of the URL ﬁlters, we are not conservative, and
rely on the following step to conﬁrm that a given product is
indeed installed on the identiﬁed host. We use the WhatWeb