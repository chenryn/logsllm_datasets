title:blackhat:asia-22 AMSI Unchained: Review of Known AMSI Bypass Techniques and Introducing a New One
AMSI (Antimalware Scan Interface) is a built-in API in Windows that allows security products to scan and therefore allow or restrict several types of content sent by applications and services (AMSI consumers) which implement the API. AMSI has seen increased adoption in recent years as it was integrated into many applications and OS components, and leveraged by end-point solutions to gain additional access and visibility to critical and widely exploited attack surfaces, notably script engines, Office macros, WMI, .Net, and UAC. Despite, and some would say because of, its popularity, AMSI itself poses security risks. AMSI has several security gaps that make its bypass possible in multiple ways. In this Briefing, we will review several types of known AMSI-bypass techniques and mechanisms. We will discuss existing and potential approaches of detecting those bypasses or eliminating the attack-surface which makes them possible. In addition, we will suggest a new approach for research on abusing AMSI design and introduce a new, undocumented and undetected, bypass technique based on patching the AMSI providersâ€™ code rather than the amsi.dll.