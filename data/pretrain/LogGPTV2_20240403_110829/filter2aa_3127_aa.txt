Bug Bounty 奖金猎人甘苦谈
那些年我回报过的漏洞
PI:EMAIL
#Orange  Tsai
#CHROOT  #DEVCORE
#电竞选手 #CTFer
#Web
#汪
My RCE Checklists
√ Facebook
√ Apple
√ Yahoo
√ Uber
? Google
什么是 Bug Bounty Program ?
• 在官方所提供的规则及范围下, 让独立的研究人员可自由寻找系
统漏洞, 并提供对等的奖励
小礼物
奖金
名誉（Hall of Fame）
Bug Bounty 好处?
防止漏洞流入地下市场
架构大难顾及网路边界
企业对外形象宣传
改善社会不良风气
How do you turn 
this on ?
Bug Bounty 好处?
防止漏洞流入地下市场
架构大难顾及网路边界
企业对外形象宣传
改善社会不良风气
更多的骇客！
更多的思路！
更多的漏洞！
Bug Bounty 好处?
防止漏洞流入地下市场
架构大难顾及网路边界
企业对外形象宣传
改善社会不良风气
公司对于安全的重视！
吸引优秀的资安高手！
Bug Bounty 好处?
防止漏洞流入地下市场
架构大难顾及网路边界
企业对外形象宣传
改善社会不良风气
告诉骇客们有简单的
方法可以做好事！
有哪些企业已经有了 Bug Bounty ?
1995
2010
2011
2013
2013
2016
2014
2015
The Internet Bug Bounty
为了维护网路世界的和平
奖励那些找出可影响整个网路世界弱点的英雄们!
Bug Bounty 成效
$6 Million
•
750+ bugs in 2015
•
300+ hackers in 2015
$4.2 Million
•
526 bugs in 2015
•
210 hackers in 2015
$1.6 Million
•
2500+ bugs since 2013
•
1800+ hackers since 2013
参加 Bug Bounty 前的准备
为了甚么参加
对于寻找漏洞的心理准备
常见弱点的理解
资讯的搜集方法
奖金？
名誉？
练功？
参加 Bug Bounty 前的准备
为了甚么参加
对于寻找漏洞的心理准备
常见弱点的理解
资讯的搜集方法
虽然今非昔比
告诉自己一定会有洞
参加 Bug Bounty 前的准备
为了甚么参加
对于寻找漏洞的心理准备
常见弱点的理解
资讯的搜集方法
常见弱点的理解
SQL Injection
Cross-Site Scripting
Cross-site Request Forgery
XML External Entity
Local File Inclusion
CSV Macro Injection
XSLT Injection
SVG/XML XSS
RPO Gadget (NOT ROP)
Subdomain Takeover
参加 Bug Bounty 前的准备
为了甚么参加
对于寻找漏洞的心理准备
常见弱点的理解
资讯的搜集方法
资讯的搜集方法
• DNS 与 网路边界
子域名? 相邻域名? 内部域名?
Whois? R-Whois?
并购服务
Google 的六个月规则
• Port Scanning
Facebook Jenkins RCE by Dewhurst Security
Pornhub Memcached Unauthenticated Access by @ZephrFish
uberinternal.com ?
twttr.com ?
etonreve.com ?
资讯的搜集方法 - 小案例
• Yahoo! Yapache
修改版本的 Apache Web Server
在当时也是创举
资讯的搜集方法 - 小案例
参加 Bug Bounty 注意事项
•
注意规则及允许范围
•
不符合规定的漏洞
•
撰写报告的礼节
注意规则及允许范围
• 规则所允许范围
范围外就无法尝试吗?
• 规则所允许限度
Instagram's Million Dollar Bug by Wesley (Awesome :P)
参加 Bug Bounty 注意事项
•
注意规则及允许范围
•
不符合规定的漏洞
•
撰写报告的礼节
不符合规定的漏洞
• 别踏入荣誉感的误区
• 常见不符合规定例子:
SELF XSS (需要过多使用者互动)
Information Leakage
Cookie without Secure Flag or HttpOnly
Logout CSRF
Content Injection
2014 Google VRP 回报状况
参加 Bug Bounty 注意事项
•
注意规则及允许范围
•
不符合规定的漏洞
•
撰写报告的礼节
撰写报告的礼节
• 明确的标题及描述
• 附上验证代码及截图
• 礼貌及尊重最后决定
寻找漏洞的思路
寻找漏洞的思路
• 有做功课的 Bonus
• 天下武功唯快不破
• 认命做苦工活QQ
• 平行权限与逻辑问题
• 少见姿势与神思路
有做功课的 Bonus
Facebook Onavo Dom-Based XSS
• Mar 16, 2014 Onavo Reflected XSS by Mazin Ahmed 
• May 01, 2014 Facebook fixed it
• One day, Facebook revised it... Buggy again!
http://cf.onavo.com/iphone/mc/deactivate.html
?url=javascript:alert(document.domain)
&seed=1394953248
有做功课的 Bonus
Facebook Onavo Dom-Based XSS
function mc() {
if ((UACheck == "0") || 
(navigator.userAgent.match(/iPhone/i)) ||
(navigator.userAgent.match(/iPad/i)) || 
(navigator.userAgent.match(/iPod/i))) {
document.location.href = MC;
setTimeout(postmc, 3000);
} else {
alert('Not an iPhone/iPad...');
...
var seed = getQueryVariable("seed");
var url = getQueryVariable("url");
var UACheck = getQueryVariable("uacheck");
var MC = getQueryVariable("mc");
有做功课的 Bonus
Facebook Onavo Dom-Based XSS
http://cf.onavo.com/iphone/mc/deactivate.html
?url=http://example/
&uacheck=0
&mc=javascript:alert(document.domain)
有做功课的 Bonus
Facebook Onavo Dom-Based XSS
http://cf.onavo.com/iphone/mc/deactivate.html
?url=http://example/
&uacheck=0
&mc=javascript:alert(document.domain)
有做功课的 Bonus 
eBay SQL Injection 
• 列举 eBay.com 时某台主机反查到
eBayc3.com
• 根据 WHOIS 确认为 eBay Inc. 所拥有无误
• 列举 eBayc3.com
images.ebayc3.com
有做功课的 Bonus 
eBay SQL Injection 
有做功课的 Bonus 
eBay SQL Injection 
有做功课的 Bonus 
eBay SQL Injection 
• 连猫都会的 SQL Injection
尝试是否可以 RCE?
• 尝试读档?
CREATE TABLE test (src TEXT);
LOAD DATA LOCAL INFILE '/etc/passwd' INTO TABLE `test`;
有做功课的 Bonus 
eBay SQL Injection 
• 连猫都会的 SQL Injection
尝试是否可以 RCE?
• 尝试读档?
CREATE TABLE test (src TEXT);
LOAD DATA LOCAL INFILE '/etc/passwd' INTO TABLE `test`;
寻找漏洞的思路
• 有做功课的 Bonus
• 天下武功唯快不破
• 认命做苦工活QQ
• 平行权限与逻辑问题
• 少见姿势与神思路
天下武功唯快不破
• 指纹辨识, 收集整理
Web Application?
Framework?
• 平时做好笔记 1-Day 出来抢首杀
WordPress CVE-2016-4567 flashmediaelement.swf XSS
ImageTragick Remote Code Execution
天下武功唯快不破
Uber Reflected XSS
天下武功唯快不破
Uber Reflected XSS
iOS Developer - "We'll be back soon"
2013
07/18 
天下武功唯快不破
developer.apple.com 被骇案例
iOS Developer - "We'll be back soon"
Apple confirms its developer website was hacked
2013
07/18 
2013
07/22 
天下武功唯快不破
developer.apple.com 被骇案例
iOS Developer - "We'll be back soon"
Apple confirms its developer website was hacked
Ibrahim Balic: I hacked Apple's developer website and have over 100K 
developers' user details
2013
07/18 
2013
07/22 
2013
07/22 
天下武功唯快不破
developer.apple.com 被骇案例
iOS Developer - "We'll be back soon"
Apple confirms its developer website was hacked
Ibrahim Balic: I hacked Apple's developer website and have over 100K 
developers' user details
Apple Hall of Fame - "We would like to acknowledge 7dscan.com, and SCANV 
of knownsec.com for reporting this issue"
2013
07/18 
2013
07/22 
2013
07/22 
2013
07/??
天下武功唯快不破
developer.apple.com 被骇案例
天下武功唯快不破
developer.apple.com 被骇案例
天下武功唯快不破