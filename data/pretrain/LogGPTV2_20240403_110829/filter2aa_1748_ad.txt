2. From the Table Name pop-up menu in the ContactInfoEJB window, choose 
PS_ContactInfo.
3. Map the CMP fields to the appropriate column names by selecting the field in 
the Cmp Fields list, clicking Edit, choosing the corresponding column name 
from the Column Name list, and clicking Update.
4. Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, 
choose mysql-get-generated-keys.
5. Click Update to finish configuring the ContactInfo enterprise bean, and close the 
window.
Configure the LineItem Enterprise Bean
1. Under Enterprise Beans under SupplierPurchaseOrderJAR (EJB), click 
LineItemEJB.
2. From the Table Name pop-up menu in the LineItemEJB window, choose 
SUPP_LineItem.
3. Map the CMP fields to the appropriate column names by selecting the field in 
the Cmp Fields list, clicking Edit, choosing the corresponding column name 
from the Column Name list, and clicking Update.
4. Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, 
choose mysql-get-generated-keys.
44
Conﬁgure the Supplier Enterprise Application
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
4
Conﬁguring and Deploying Sun’s Pet Store
5. Click Update to finish configuring the LineItem enterprise bean, and close the 
window.
Configure the SupplierOrder Enterprise Bean
1. Under Enterprise Beans under SupplierPurchaseOrderJAR (EJB), click 
SupplierOrderEJB.
2. From the Table Name pop-up menu in the SupplierOrderEJB window, choose 
SUPP_SupplierOrder.
3. Map the CMP fields to the appropriate column names by selecting the field in 
the Cmp Fields list, clicking Edit, choosing the corresponding column name 
from the Column Name list, and clicking Update.
4. Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, 
choose mysql-get-generated-keys.
5. Click Update to finish configuring the SupplierOrder enterprise bean, and close 
the window.
Configure the Supplier Web Application Module
1. Under SupplierWAR (WebApp), click Module Settings.
2. In the JBoss Resource Env Refs list, select jms/opc/InvoiceTopic, and click Edit.
3. From the Jndi Name pop-up menu, choose /topic/opc/InvoiceTopic, and click 
Update.
4. In the JBoss Resource Refs list, select jms/TopicConnectionFactory, and click 
Edit.
5. From the Jndi Name pop-up menu, choose /ConnectionFactory, and click 
Update.
6. Click Update to finish configuring the Supplier web-application module, and 
close the window.
Save the Application
1. In the navigation window, click Save.
C H A P
T
E
R
4
Conﬁguring and Deploying Sun’s Pet Store
Deploy and Test the Application
45
  Apple Computer, Inc. January 22, 2004
2. In the text field in the Save Application window, enter /Library/
Configured_Apps/supplier.ear, and click Save Application.
3. Close the window.
Deploy and Test the Application
To deploy Pet Store in Mac OS X Server, copy the configured files to /Library/
JBoss/3.2/deploy. (You can also use the management tool to deploy the application. 
See “Deploying Applications” (page 59) for details.) After about a minute, open 
http://localhost:8080/petstore in your web browser. You could also have saved 
the EAR files directly to the JBoss deploy directory. However, it’s generally safer to 
configure application files of undeployed archives.
Follow these steps to test Pet Store:
1. Open http://localhost:8080/petstore in a web-browser window.
2. Click the link that takes you to the store.
3. In the Welcome to the BluePrints Petstore webpage, click Birds.
4. In the Items webpage, click Amazon Parrot.
5. In the Product webpage, click Add to Cart.
6. In the Cart webpage, click Check Out.
7. In the Sign On webpage, click Sign In.
8. In the Enter Order Information webpage, click Submit.
If you get an error page during the test, make sure JBoss is running and recheck the 
configuration settings described in “Configure the Pet Store Enterprise 
Application” (page 29) and “Configure the Supplier Enterprise Application” 
(page 39).
46
Deploy and Test the Application
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
4
Conﬁguring and Deploying Sun’s Pet Store
Logging In to the Management Tool
47
  Apple Computer, Inc. January 22, 2004
C H A P
T
E
R
5
5
Administering Application 
Servers
Application-server management involves configuring the services available in an 
application server, turning services on and off, deploying applications, and 
monitoring application-server resources. This chapter teaches how to manage 
application servers, which are JBoss instances running on one or more computers.
Logging In to the Management Tool
Before you can log in to the management tool, the tool must be running. You can 
launch the management tool by executing the following command:
$ /Library/JBoss/Applications/JBossManagement.woa/JBossManagement
You log in to the management tool through your web browser. To connect to the 
management tool, enter the following URL into the Address text field in your web 
browser: https://localhost:40000.
48
Logging In to the Management Tool
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
5
Administering Application Servers
Alternatively, you can click Manage JBoss in the Settings pane in the Server Admin 
window.
To log in to the management tool you must enter the user name and password of an 
administrator of your computer or a user who is a member of the appserveradm 
group or the appserverusr group.
There are two types of users with the authority to use the management tool: 
administrator users (which are members of the appserveradm group) and monitor 
users (which are members of the appserverusr group). The user defined while 
configuring Mac OS X Server for the first time is added to the appserveradm group. 
To authorize another user to manage application servers with the management tool, 
execute the following command in the command line, and restart your computer:
$ sudo /usr/bin/dscl . -create Groups/appserveradm GroupMembership 
If you need to authorize a user to only monitor application servers with the 
management tool, execute the following command, and restart the computer:
Note: The management tool allows only registered users to manage, configure, 
or monitor application servers. If you enter the name of a registered user in the 
Username text field but enter an incorrect password in the Password text field, 
you can only monitor the application server. Also, only members of appserveradm 
and appserverusr can launch the management tool.
C H A P
T
E
R
5
Administering Application Servers
Logging In to the Management Tool
49
  Apple Computer, Inc. January 22, 2004
$ sudo /usr/bin/dscl . -create Groups/appserverusr GroupMembership 
You can also use NetInfo Manager to add users to the appserveradm and 
appserverusr groups:
1. Launch NetInfo Manager, located in /Applications/Utilities.
2. If the lock in the bottom-left corner of the window is locked, click it and 
authenticate yourself and the server’s administrator.
3. In the “/” column, select “groups.” Then select the appropriate group in the 
“groups” column.
4. In the Properties list, select “users” and choose Directory > New Value.
5. Replace new_value with the appropriate user name.
50
Logging In to the Management Tool
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
5
Administering Application Servers
6. Save the changes and restart your computer.
C H A P
T
E
R
5
Administering Application Servers
Choosing a Task
51
  Apple Computer, Inc. January 22, 2004
Choosing a Task
After logging in to the management tool, the Configuration window appears. This 
window lets you choose the kind of activity you want to perform with the 
management tool. There are three activities to choose from:
I
Managing: Allows you to start and stop services, configure services, observe 
resource statistics, create data sources, create topics or queues, and deploy 
applications.
I
Configuring: Lets you start and stop services, create data sources, create topics 
or queues, and deploy applications.
I
Monitoring: Allows you to observe resource statistics of application servers.
Managing Application Servers
To manage an application server, enter the JNDI port of the application server you 
want to manage (by default, 1099) in the Configuration window (shown in Figure 
5-1), and click “Manage localhost”.
52
Managing Application Servers
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
5
Administering Application Servers
Figure 5-1
The Configuration window of the management tool
The left side of the JBoss Management Console window (shown in Figure 5-2) lists 
the application servers available and the resources they provide. You specify the 
resource you want to manage by clicking the triangle next to the appropriate 
resource type and selecting a resource from the list that appears.
Figure 5-2
The JBoss Management Console window
C H A P
T
E
R
5
Administering Application Servers
Managing Application Servers
53
  Apple Computer, Inc. January 22, 2004
For example, to change an application server’s security configuration, click the 
triangle next to the Services resource group and select login-config.xml. After that, 
the Security Configuration pane (shown in Figure 5-3) appears on the right side of 
the window, showing the application policy list, which you can modify by clicking 
the appropriate buttons. However, any changes you make take effect only after you 
restart the application server.
Figure 5-3
The JBoss Management Console window showing the Security 
Configuration pane of the log-in configuration service
When you’re managing the services deployed on the application server, you can 
also monitor the statistics of deployed applications and resources. For example, if 
you deploy Sun’s Pet Store in your application server, log in to the management 
54
Managing Application Servers
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
5
Administering Application Servers
tool, choose to manage the application server from the Configuration window, and 
click local/ShoppingCartEJB under cart-ejb.jar under petstore.ear under the 
Applications group in the application-server list, the JBoss Management Console 
window displays the Statistics pane with information on the performance of the 
ShoppingCart enterprise bean, as shown in Figure 5-4.
Figure 5-4
The JBoss Management Console window showing the Statistics pane of the 
Pet Store ShoppingCart enterprise bean
C H A P
T
E
R
5
Administering Application Servers
Conﬁguring Application Servers
55
  Apple Computer, Inc. January 22, 2004
When you’re done managing, click JBoss in the server list, and click Logout or 
Change Configuration.
Configuring Application Servers
To configure local application servers, choose the configuration you want to modify 
from the “Modify configuration” pop-up menu, and click “Modify configuration” 
in the Configuration page.
The JBoss Management Console window appears. This window allows you to select 
a service and change its configuration.
For example, to configure the transaction-connection factory service, select jms-
ds.xml under services in the application-server list.
You can also configure the provider and the session pool of the transaction-
connection factory service by clicking the triangle next to jms-ds.xml in the 
application-server list and selecting the appropriate item, as shown in Figure 5-5.
56
Monitoring Application Servers
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
5
Administering Application Servers
Figure 5-5
The JBoss Management Console window showing one of the configuration 
panes for the JMS Directory Service
Monitoring Application Servers
To monitor application servers, enter the name of the computer on which the 
application server is running (by default, localhost) and the JNDI port of the 
application server (by default, 1099) in the Configuration page, and click “Monitor 
host”.
To view the statistics provided by particular applications, resources, or services, 
select the appropriate item in the application-server list. The statistics appear in the 
Statistics pane, shown in Figure 5-6.
Note: After you’re done making changes, you have to restart the application 
server for the changes to take effect.
C H A P
T
E
R
5
Administering Application Servers
Starting and Stopping Services
57
  Apple Computer, Inc. January 22, 2004
Figure 5-6
The JBoss Management Console window showing the statistics of the 
Deploy Service
Starting and Stopping Services
You can start and stop services while managing or configuring application servers. 
To do so, in the application server list, select the application server you want to 
configure, and click Start/Stop Services in the Host Information pane. The Start or 
Stop Services pane is displayed in the right side of the JBoss Management Console 
window, as shown in Figure 5-7.
58
Creating a Data Source
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
5
Administering Application Servers
Figure 5-7
The JBoss Management Console window showing the Start or Stop Services 
pane
Creating a Data Source
You can create a data source while managing or configuring application servers. To 
do so, select the application server you want to add the data source to in the server 
list. Next, enter the name of the data source in the Datasource Name text field in the 
Create a Datasource group in the Host Information pane, choose a data-source type 
from the Datasource Type pop-up menu, and click Create Datasource.
C H A P
T
E
R
5
Administering Application Servers
Creating a Topic or a Queue
59
  Apple Computer, Inc. January 22, 2004
Enter the appropriate information in the Local TX Datasource pane, and click 
Update.
The newly added data source appears under the Resources group in the 
application-server list.
Creating a Topic or a Queue
You can create a topic or a queue while managing or configuring an application 
server. Follow these steps to create a topic or a queue:
1. In the application server list, select the application server you want to add the 
topic or queue to.
2. From the Topic or Queue pop-up menu in the Create a Topic or Queue group in 
the Host Information pane, choose Topic or Queue.
3. In the Topic or Queue Name text field, enter the name of the topic or queue.
4. Enter the name of the file in which the topic or queue configuration is to be saved 
in the Filename text field.
Deploying Applications
You can deploy applications while managing or configuring application servers. 
Follow these steps to deploy an application:
1. Select the application server you want to deploy the application or service on in 
the application server list.
2. In the “Select an application to deploy” group in the Host Information pane, 
click Choose File, and choose the file to deploy.
Note: Make sure to enter a unique JNDI name in the Jndi Name text field of the 
Local TX Datasource pane.
60
Deploying Applications
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
5
Administering Application Servers
3. Click Deploy Application.
Distributable Applications
61
  Apple Computer, Inc. January 22, 2004
C H A P
T
E
R
6
6
Balancing User Load and 
Replicating Sessions
HTTP load balancing provides a way to distribute user load among a group of 
application servers. The application servers can be standalone or configured as a 
cluster, in which case they are know as nodes. Load balancing is better used with 
sticky sessions. This means that once the load balancer (a web server) forwards a 
client request to a particular application server, it sends all further requests from the 
client to the same application server.
Using load balancing across standalone application servers allows you to scale your 
deployment with little increase in request-processing overhead. However, when an 
application server fails, other application servers cannot pick up the failed-server’s 
load, which may provide an undesirable user experience: Users may have to log in 
to the application again or may lose the contents of their “shopping carts.”
Load balancing across clustered application servers (or nodes) provides session 
replication among the nodes, so that when a node fails, another node can take over 
its duties with little or no user impact. However, as you add nodes to the cluster, 
each request may take longer to process.
This chapter explains how to enable an application to be distributable among 
cluster nodes and walks you through configuring HTTP load balancing for Sun’s 
Pet Store using three computers: One serving only as the web server and load 
balancer, and the other two serving as application-server nodes.
Distributable Applications
Before deploying an application in a cluster of nodes using the deploy-cluster 
configuration, make sure that the application is distributable.
62
Distributable Applications
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
6
Balancing User Load and Replicating Sessions
To make an application distributable set Distributable to yes in the Web-App pane 