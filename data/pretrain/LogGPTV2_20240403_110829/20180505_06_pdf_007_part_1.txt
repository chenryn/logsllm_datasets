Workshop
Oracle to Postgres Migration
Part 1 - migrating the database
2016-05-30 @IDM
Chris Mair
http://www.pgtraining.com
The Workshop
1
trap
part 1
•
-
noitargiM
Oracle Database ™
•
sergtsoP
how an application interacts with an RDBMS • ot
elcarO
03-50-6102
the ora2pg tool
•
part 2
•
PostgreSQL features for DBAs and developers
•
Important Note
1
trap
Postgres is an advanced Open Source RDBMS with
•
-
noitargiM
roots in the '80s at UC Berkeley. It has been developed
as a comunity project since 1996
sergtsoP
the project's goal is to develop the most advanced
•
ot
Open Source enterprise-class RDBMS. Notably, its SQL
elcarO
implementation strongly conforms to the ANSI-SQL:2008
03-50-6102
standard
Postgres has never been, is not, and never will be some
•
sort of drop-in replacement for Oracle Database ™ - if
you need such a thing, you need to look elsewhere
1
trap
-
noitargiM
Getting to know
sergtsoP
Oracle Database ™
ot
elcarO
03-50-6102
Get your own Instance
1
trap
the two quickest ways I know to get your own
•
-
noitargiM
instance running are:
sergtsoP
Oracle Database Express Edition ™ (running on
•
your own Linux server → "Oracle XE"
ot
elcarO
Oracle Database Standard Edition One ™ as a 03-50-6102
•
service on AWS → "Oracle SE"
other approaches need more investment in time (the
•
installation takes some care) or money (licensing)
Oracle XE on own Server
1
trap
Oracle XE is gratis-ware (read the exact license
•
-
noitargiM
terms, though)
sergtsoP
product is limited to using 1 core, 1 GB RAM and
•
up to 11 GB user data - the machine can (and
ot
elcarO
should) be larger, however
03-50-6102
you need a (free) OTN account to download it
•
I recommend running it on CentOS
•
download version 11.2 (~ 300 MB .rpm) here
•
Oracle SE One on AWS
1
trap
many RDBMS can be run as a managed service on Amazon
•
-
Web Services (AWS) - among others also Postgres and Oracle noitargiM
Database ™
sergtsoP
Oracle SE One 11.2 or 12.1 can be run in a very interesting
•
"license included model": the license cost is included in the AWS
ot
cost and charged by the hour used (depending on machine elcarO
size, the extra cost starts at ~ 2 cent / h more than for a free
03-50-6102
RDBMS)
this product is still limited by the SE One license in socket count,
•
so AWS can offer it only with at most 16 logical cores per
instance, but there is no other (low) limit in RAM or disk size
see the AWS website for details
•
Manuals
1
trap
Oracle offers two "easy" manuals here for Oracle XE that can
•
-
be a starting point: noitargiM
2 Day DBA • sergtsoP
2 Day Developer's Guide ot
•
elcarO
depending on you background be prepared to do some • 03-50-6102
reading...
generally speaking, being a DBA in the Oracle world can be
•
challenging - fortunately you don't need the full DBA-foo if
you're just interested in supporting migrations and/or are
using XE or SE as a service
Tools
1
trap
Oracles traditional command line tool is called
•
-
noitargiM
SQL*Plus, it comes bundled with Oracle XE or
can be downloaded with the so called "instant
sergtsoP
client" package (more later)
ot
elcarO
the "official" GUI tool is Oracle SQL Developer:
•
03-50-6102
this is a JAVA application that can be
downloaded here (~ 300 MB)
both are gratis-ware and are available for Linux
•
(and other OSes too)
1
trap
-
noitargiM
Getting to know
sergtsoP
Postgres
ot
elcarO
03-50-6102
Get your own Instance 1/2
1
trap
Postgres is in the standard repo of all major Linux
•
-
noitargiM
distribution, so that's just one of the usual
commands away:
sergtsoP
yum install postgresql postgresql-server
ot
elcarO
apt-get install postgresql-client postgresql
03-50-6102
however, the major Linux distributions often carry
•
pretty outdated versions (I'm looking at you, Centos
7, carrying version 9.2, that is three major versions
behind the current 9.5) or package the product in
unusual ways (I'm looking at you, Debian)
Get your own Instance 2/2
1
trap
I recommend getting more recent releases from the official
•
-
download page noitargiM
the project maintains its own repositories for all major Linux • sergtsoP
distributions, so you can still use yum, apt, etc. to install and
update everything - note that Postgres issues a major version ot
elcarO
about once a year and supports it for 5 years
03-50-6102
it is pretty much possible to compile from source too (I even
•
prefer to do so, although I'm not recommending this to new
users)
as mentioned, Postgres is also available as a service on AWS
•
Manuals
1
trap
the official (huge) manual is available here for
•
-
noitargiM
reading online or downloading as PDF
sergtsoP
many good books are available - please pay
•
attention to the publication date, you probably ot
elcarO
should pick something from 2012 or newer
03-50-6102
(covering version 9.1 or newer)
the second part of this workshop will deal with
•
Postgres, attending it is a very good way to
getting started :)
Tools
1
trap
Postgres' traditional command line tool is called
•
-
noitargiM
psql - again, this can be installed from your Linux
distribution's repo or from the Postgres repo
sergtsoP
there is no "official" GUI tool, though! ot
•
elcarO
03-50-6102
some people use pgAdmin (Open Source), some
•
people use propretiary multi-product tools, some
people just use psql
I recommend sticking with psql
•
Hands-on Setup
1
trap
-
noitargiM
sergtsoP
ot
elcarO
03-50-6102
Talking with a RDBMS 1/3
1
trap
when using a RDBMS you don't deal with files, but rather use a
•
-
client or client application that comunicates with the RDBMS noitargiM
over a network socket
sergtsoP
each product has its own native networking protocol
•
ot
Oracle uses the proprietary "TNS" protocol with the default TCP elcarO
•
port 1521 and the OCI library as native call interface
03-50-6102
Postgres uses its own "frontend/backend" protocol with the
•
default TCP port 5432 and the libpq library as native call
interface
these two sets of protocols / libraries have nothing whatsoever in
•
common
Talking with a RDBMS 2/3
1
trap
the structured query language (SQL) is used to "instruct"
•
-
noitargiM
a RDBMS
sergtsoP
it is used to define the database schema (DDL
•
statements), to manipulate the data (DML statements)
ot
and to query the data
elcarO
03-50-6102
information about the database schema is stored as
•
data in the "catalog", so SQL can be used to query the
catalog too
there is an ANSI SQL standard that covers many, but not
•
all aspects
Talking with a RDBMS 3/3
1
trap
fortunately most applications written for Oracle
•
-
noitargiM
Database ™ don't use TNS/OCI natively but send
SQL statements over a higher level API such as
sergtsoP
ODBC (Win/C++), JDBC (Java), the .NET data
provider API (C#), etc.
ot
elcarO
03-50-6102
drivers for these APIs are (of course) available for
•
Postgres too
hence, ideally, migrating an application that talks
•
SQL over - say - JDBC is not too hard ... ideally...
Example App
1
trap
a super simple web app written in Java: it
•
-
noitargiM
displays the countries from the "hr"-sample
database
sergtsoP
ot
elcarO
03-50-6102
Example App - Code
1
trap
-
noitargiM
sergtsoP ofni
noitcennoc
ot
elcarO
03-50-6102 sllac
dna
IPA-CBDJ