Other distribution models such as Software-as-a-Service could
potentially mitigate this risk, but would also limit the use-
fulness for the research community. We believe determined
attackers will still ﬁnd a way to attack sites even without Basta-
COSI. Thus, we favor the beneﬁt for defenders and the research
community.
VI. EXPERIMENTS
This section presents the evaluation of Basta-COSI on
four open source web applications (HotCRP, GitLab, GitHub
Enterprise, OpenCart) and the 58 web sites in the Alexa
Top 150 [15] where we could create user accounts. These
targets are popular, allow us to test on white-box (open source)
and black-box (deployed) scenarios, and cover services with
multiple user states. Section VI-A describes the results on
Web applications, Section VI-B on Alexa web sites, and
Section VI-C details some attacks found.
A. Evaluation on Web Applications
Table V summarizes the results of applying Basta-COSI
on the four web applications we installed locally. It details the
results for each tool module, as well as the COSI attacks found.
The data collection part shows the number of input state scripts
provided to Basta-COSI, the number of URLs crawled, and the
number of SD-URLs identiﬁed. The attack vector identiﬁcation
part shows the total number of attack vectors identiﬁed, the
number of state pairs they cover, and the number of XS-Leaks
they use. The attack page generation part shows the number
of states uniquely distinguished (UD) from other states, the
number of states partially distinguished (PD) excluding UD
states, and the minimum/average/maximum attack vectors in
the attack pages. Finally, the attacks found part shows the type
and browsers affected for the identiﬁed attacks.
Depending on the target, we created 3–6 state scripts to
use Basta-COSI. One script always corresponds to the logged
out (LO) state and the others are target-speciﬁc. For example,
for GitLab the other 5 states are for maintainer, developer,
reporter, guest (read-only access), and a user with no read
access to the repository. Like a fuzzing tool, Basta-COSI will
try to ﬁnd attacks until the allocated time budget runs out.
We let Basta-COSI run for a maximum of 24 hours on each
target, although after a few hours the crawling typically does
not ﬁnd any new URLs. The data collection results show that
SD-URLs are very common, on average 68% of the discovered
URLs are SD-URLs (and up to 99% in GitHub).
Basta-COSI ﬁnds between 58 and 992 attack vectors in
each target using up to 3 XS-Leaks. The results show that on
average the generated attack pages use more than one attack
vector. Account
type and deanonymization attacks always
require multiple vectors, while login detection is oftentimes
possible with a single vector. This highlights the importance
of our approach to combine attack vectors in order to handle
more than two states and multiple browsers. Some states can
be uniquely identiﬁed, i.e., distinguished from any other state,
and the rest can be partially distinguished. We found no state
that could not be distinguished at all. It is important to note
that partially distinguishable states can also be used in attacks.
For example, not being able to differentiate the administrator
from a normal user does not matter if the administrator is
not targeted by the attack, i.e., not sent the attack page URL.
Overall, Basta-COSI ﬁnds attacks on all four applications:
login detection attacks on all four, deanonymization attacks
on three, and account type identiﬁcation on two.
B. Evaluation on Web Sites
We test sites from the Alexa Top 150 that are not duplicates
(e.g., amazon.com vs. amazon.de) and where we could create
10
Target
HotCRP
GitLab
GitHub
OpenCart
Data Collection
Attack Vector Identiﬁcation
States
5
6
4
5
URLs
68
52
91
51
SD
URLs
65
19
90
32
Vectors
116
236
992
72
State
Pairs
7
14
6
7
XS-Leaks
3
1
1
1
UD
States
1
2
4
2
PD
States Min
1
1
1
1
4
4
0
3
Attack Page Generation
Vectors
Attacks Found
Login
Detection
C,E,F
C,E,F
C,E,F
C,E,F
Account
Type
-
C,E,F
C,E,F
-
Deanon.
C,E,F
C,E,F
C,E,F
-
Access
Detection
-
-
-
-
Avg Max
3
1.6
2
1.9
2
1.8
1.1
2
TABLE V: Basta-COSI evaluation results. For every target application and site, it shows the data for each tool module, as well
as the type and browsers affected for the attacks found. Browsers are abbreviated as Chrome (C), Firefox (F), and Edge (E).
Attack Type
Tested
Vulnerable
Login Detection
Deanonymization
SSO Status
Access Detection
Account Type
Total Sites
58
58
12
11
3
58
58
36
12
5
3
58
TABLE VI: Web sites vulnerable to each attack type
Attack
Login
Detect.
Account
Type
Deanon.
Access
Detect.
SSO
Status
Br
C
F
E
C
F
E
C
F
E
C
F
E
C
F
E
EF
2457
1587
676
OP
2532
1511
1286
PM CSS
0
0
0
9
9
9
JSE
2
2
2
JOR
0
0
0
175
173
39
644
447
201
98
1
3
0
0
0
82
85
36
546
420
288
12
10
10
0
0
0
0
0
0
2
2
2
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
72
0
0
0
0
0
CSP
885
424
434
126
2
12
31
79
81
0
0
0
12
12
12
ACE
63
0
0
3
0
0
17
0
0
0
0
0
0
0
0
(Legend: EF=EventFire; OP=ObjectProperties; PM=PostMessage; CSS= CSSPropRead;
JSE=JSError; JOR=JSObjectRead; CSP=CSPViolation; ACE=AppCacheError)
TABLE VII: Attack vectors found per XS-Leak and browser.
free accounts. This excludes sites without user accounts, that
required a phone number in a speciﬁc area, or that demanded
credit card information. This leaves us with 58 sites, of which
only 12 support SSO, and only 3 have multiple types of free
accounts (excluding the administrator account that we cannot
obviously create). For access detection, we focus on privacy
sensitive sites, more speciﬁcally adult sites, on the Alexa Top
150, regardless if they have user accounts.
Table VI summarizes the number of tested and vulnerable
sites for each attack type. For login detection, SSO status, and
account type identiﬁcation, Basta-COSI discovers XS-Leaks
against all tested sites. In addition, it ﬁnds deanonymization
attacks in 57% of the sites and access detection attacks in
45%. The results show that login detection attacks are easiest
to ﬁnd, but that by combining multiple attack vectors it is
possible to ﬁnd more powerful attacks targeting more than
two states in 72% of the sites. Regarding false positives, we
rarely observed them in two situations. One was due to Basta-
COSI waiting 6 seconds to collect events and some pages being
slower to load. The other one was when Basta-COSI sent too
many queries and a site started replying with CAPTCHAs. We
expect that increasing the timeout and distributing the queries
over multiple IPs would eliminate those false positives. We
do not evaluate false negatives, as we lack ground truth of the
COSI attacks present in the targets. However, we acknowledge
that, like any testing tool, false negatives are possible, e.g.,
Basta-COSI can only ﬁnd COSI attacks that are instances of
the 40 attack classes it supports.
i.e.,
The support in Basta-COSI for multiple XS-Leaks and
multiple browsers allows to compare the prevalence of the
XS-Leaks, as well as the attack surface of the browsers,
on the same set of SD-URLs,