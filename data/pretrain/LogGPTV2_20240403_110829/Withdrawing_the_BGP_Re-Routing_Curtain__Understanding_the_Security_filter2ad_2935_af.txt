### Network Activity and Filtering Policy

Current network activity and filtering policies, rather than organizational-level alignment with MANRS, are the focus of this discussion.

### Security Implications and Key Takeaways

Our findings on poison filtering impact all security systems mentioned in Section II-C, including Nyx, LIFEGUARD, RAD, Waterfall of Liberty, and Feasible Nyx [52], [23], [50], [36], [60]. While the results in Section V demonstrate that BGP poisoning generally functions, our experiments reveal that AS-level filtering in certain parts of the Internet creates specific topological locations where poisoning is ineffective. Consequently, systems like Waterfall, which rely on BGP poisoning not functioning, should target these regions for deployment. By identifying topological areas where poisoning is less effective, censorship circumvention systems can avoid adversaries using RAD to route around decoys.

From a DDoS perspective, Nyx cannot easily bypass DDoS attacks in filtered regions of the Internet. This filtering contributes to the reduced effectiveness of Nyx, as observed in the previous section. The filtering of long paths also limits Nyx's ability to poison neighbors along alternate paths, preventing the unintended traffic from being dragged along and thus hampering the relief of attack congestion. Notably, these experiments also establish a hard real-world limit on Internet path length. At 255 ASes, Internet paths fail to propagate; however, up to 255 ASes, paths propagate to 99% of ASes, unlike what was found in prior passive measurements [60]. ASes aiming to propagate long paths should limit the number of poisons used to 245, accounting for up to 10 ASes for the actual path. Given that the average path length is between 3 and 4 ASes [2], this allowance is suitable for real-world deployment of poisoning.

### Reassessing Reachability

As part of our study, we set up our infrastructure to reproduce Internet measurements from nearly a decade ago by Bush et al. in Internet Optometry at IMC 2009 [8]. These 2009 measurements have a significant impact on the feasibility of BGP poisoning for security. This section presents our findings for an Internet in 2018 with over 60,000 ASes and an estimated 3.8 billion unique users, compared to nearly 25,000 ASes and 1.7 billion users in 2009 [56], [2]. Once again, we found cases where common assumptions from the operator community did not align with actively measured Internet behavior.

#### A. Declining Presence of Default Routes

1. **Experimental Design**: Default routes exist when an AS has two or more providers and refuses to choose a second provider when the first provider is "removed" from the topology via BGP poisoning. A poisoning AS can theoretically remove the first provider from the steered AS’s topology by causing the first provider to drop (and not propagate) its route to the poisoning AS. However, in 2009 [8], this did not always occur during poisoning. Default routes were evaluated as part of the earlier return path steering experiments.

2. **Results and Discussion**: We found that 330 out of 1,460 successful poisoning cases exhibited default routes at the steering AS’s next hop. Thus, steering traffic onto a second, third, or other provider bordering the remote AS was impossible for these ASes. As shown in Table IV, we examined the properties of these ASes by their transit or fringe status. Default routes existed for 26.8% of the transit ASes we sampled, those being ASes with 5 or more customers. We also found that 36.7% of the fringe ASes, or those with fewer than 5 customers, had default routes. In 2009, 77% of stub ASes had default routes (out of 24,224 ASes measured from the poisoner with the ping utility). In 2018, we found that 36.7% of stubs had default routes (out of 845 ASes measured from the steered AS with RIPE Atlas probes using traceroute).

Based on the prevalence of default routes, decoy routing systems [36], [35], [7] could optimize the placement of decoy systems on the immediate next-hop of remote ASes that a RAD [50] adversary wishes to steer. This approach may yield stronger security guarantees against poisoning-equipped adversaries when the middle of the path exhibits strong compatibility with poisoning. For systems such as Nyx [52], a steered AS with a default route may not be able to provide QoS to its customers under a direct DDoS due to the inability to steer return paths around its next-hop AS, which will always be used for return traffic.

#### B. Growth of /25 Reachability

When executing return path steering, an originating AS utilizing poisoning on a set of its own prefixes can cause the poisoned ASes and their traffic to lose connectivity to the poisoning AS’s prefixes. Without a less specific covering prefix, the poisoned AS will have no path to the poisoning AS. Fortunately, a poisoning AS can still maintain reachability given a sufficient allocation of prefixes. However, not all ASes benefit from an ample supply of controlled prefixes. To maintain reachability while poisoning, an AS must have both a more specific prefix and a less specific prefix. Current best practice documents recommend ASes filter advertisements longer than /24 [12]. Therefore, any AS that only has /24 prefixes available will lose reachability to poisoned ASes unless it can advertise a /25 as the poisoned prefix and use the /24 as the covering prefix. We searched the BGP RIB for an AS’s shortest advertised prefix length and found that 48% of them only have /24 prefixes advertised, except for ASes that may already have /25’s in the default-free zone. For an in-depth examination of BGP prefix delegation and who gets the privilege of many prefixes, see recent work by Krenc et al. [24].

With this necessary primitive for poisoning in mind, we set out to examine the amount of reachability a /24-only poisoning AS could retain to the poisoned ASes.

1. **Experimental Design**: For the control-plane measurement, we started by announcing a unique /24 across all 8 prefixes. Over the following 96 hours, we collected aggregated BGP updates from BGPStream [42]. This provides a baseline number of ASes propagating the path. We then withdrew each /24 prefix. Next, we announced a /25 prefix from the same set of locations across PEERING and the university AS, collecting the number of updates in the same manner again over 96 hours. With these two sets of ASes, we compute the normalized percent of ASes propagating the /24 versus the /25.

Next, we measured data-plane reachability. We announced a /25 from our 8 prefixes. Then we scheduled 5,000 traceroutes, randomly sampled from all Atlas probes, directed to the advertising /25 prefixes every hour for 7 hours. We recorded the number of traceroutes that reached the /25, noting this as the approximate reachability of the /25. We opted not to do the traceroutes for the /24 both due to PEERING being used for other experiments and because we expect a /24 to be reachable except in the case of faulty Atlas probes.

2. **Results and Discussion**: Our results from these experiments are shown in Table V. We found that the current data-plane reachability of a /25 is roughly 30%, while the number of ASes propagating a /25 BGP announcement is over 50%, or 50x higher than 2009 results in Bush et al. [8]. Notably, our analysis shows that the 48% of ASes without sufficient recommended prefixes to steer traffic can actually maintain reachability. We note that our results may not be directly comparable with Bush’s work due to the use of traceroutes here over ping, but the comparison at least serves as a measuring stick for the growing Internet.

Our findings have crucial implications for both existing and future security systems. Censors that do not have a less specific prefix than a /24 will be unreachable by ASes affected by path steering for a non-negligible amount of steered ASes. This may dampen a RAD [50] adversary’s success in terms of economic means by lost traffic, while strengthening the case for circumvention tools [36], [7], [35]. Though loss of reachability may not be an issue for censorship entities in general, smaller censoring nations may sustain significant economic costs. Smaller nations may have few egress BGP paths to the broader Internet. Any additional sacrificed reachability may have substantial impacts on the businesses and users behind the border. However, the cases where BGP routers propagate a /25 may be enough in some attack scenarios for a RAD adversary, though this is topology-dependent given a poisoning AS. We recommend that future iterations of the decoy routing attack and defense schemes factor in our findings by evaluating their success for classes of ASes with only a /24 prefix. As a defensive mechanism, operators of Nyx or LIFEGUARD [52] must be willing to sustain losses of reachability. Defensive measures must account for these new AS reachability metrics for ASes with few prefixes.

### Security Implications and Key Takeaways

Our findings on reachability and default routes impact all security systems mentioned in Section II-C, including Nyx, LIFEGUARD, RAD, Waterfall of Liberty, and Feasible Nyx [52], [23], [50], [36], [60]. Like filtering, default routes and losses of reachability limit what can be claimed by poisoning-enabled systems such as Nyx, RAD, and LIFEGUARD. From the perspective of DDoS, Nyx functions even with default routes, as attacks are often more than several hops away from the target in the case of Link Flooding Attacks (LFAs) [52]. Furthermore, our finding that 48% of ASes with only a /24 can, in fact, use a /25 is significant for Nyx and LIFEGUARD deployers with few IP prefixes. Thus, smaller ISPs can still execute BGP poisoning feasibly and maintain their connectivity via a less and more specific prefix.

However, our findings again limit these systems in specific cases. For example, decoy routers benefit from RAD [50] being unable to steer return paths due to default routes near the poisoning AS or AS deploying RAD. Poisoning also impacts the reachability of censoring ASes’ prefixes when a less specific prefix is not available. This presents a difficult decision to censors unwilling to shut off partial Internet access to customer traffic. While censors are inhibited by poisoning in some cases, a censor willing to lose reachability to some parts of the Internet and aware of decoys not impacted by default routes can still benefit from BGP poisoning. Finally, our discovery that the Internet has significantly changed from 2009 to 2018 with respect to reachability should come as no surprise. Therefore, systems designed in an era of a vastly different Internet topology may need to be re-evaluated on the live Internet to see whether their claims are still valid.

### Discussion

#### A. Reproducibility and Continuous Measurements

All experiments conducted for this paper can be replicated using the same public infrastructure we utilized. Distributed traceroutes can be run using RIPE Atlas [45], other sources such as NLNOG Ring [48], [18], and PlanetLab [10], [54] can also be used. BGP measurements can be conducted by partnering with the PEERING testbed [49], which is available for use by operators and academic researchers via an application process. The experiments in this work were conducted in the first half of 2018, but the measurement infrastructure and framework are open-source [4] and can be deployed to conduct continuous measurements from the same or similar vantage points. We hope to work with PEERING and others at UT to carry out these measurements continuously, providing a live, ever-changing look at BGP poisoning behavior on the Internet.

#### B. Experimental Limitations

Our experiments have several limitations. First, some ASes will filter poisoned advertisements, and it can be difficult to fully understand what is driving the behavior without insider information from the ISP’s policies. Second, when we see poisoned advertisements not pass through certain ASes, we are inherently unable to know whether the lack of propagation is due to filtering or if the router is invisible from our perspective on the control plane. We cannot distinguish a case where both our provider and their provider are filtering poisoned routes versus our provider filtering and then our infrastructure not seeing the new route. This results in our measurements of filtering being an upper bound on the amount of filtering occurring. Fortunately, continuous measurements would help address several of these limitations.

From a geographic perspective, we did not attempt to measure the differences in our re-routing feasibility experiments geographically. Recent work has found geolocation of routers and AS paths from public and commercial databases to be unreliable [13]; therefore, we focus on the topological differences in poisoning feasibility. Finally, the instability of RIPE Atlas as our distributed traceroute source can be limiting. Traceroute probes from RIPE Atlas suffer from infrequent instability due to the small profile of the probes and the load on the entire measurement network. To adjust for this behavior, we only use Atlas probes that remain stable for the entire experiment. We define stability here as Atlas probes that continue to respond to API requests and return successful responses when requesting AS-level network paths.

#### C. Recommendations for Re-Examining Other Security Work

There are many examples of other security systems from recent literature, while not focused on poisoning specifically, that make assumptions about BGP behavior and for the same policies as the inferred topology of the Internet to hold in practice. Notably, NetHide, which obfuscates traceroutes across the Internet [32], tests across less than 1% of Internet ASes of a total 60,000+, but instead only ~150. Recent studies of defeating BGP hijacking of Bitcoin, including SABRE by Apostolaki et al. [4], [3], only test with the inferred CAIDA topology, which we show in this paper does not match reality when it comes to poisoning. Less recent work such as RAPTOR [58], a look at routing attacks on Tor, claims that /24 prefixes are the only prefixes that cannot be defeated by a Tor adversary using RAPTOR, yet we showed earlier that large swaths of the Internet will respect a /25, allowing Tor to be de-anonymized in some cases. Finally, a study recently published at IEEE S&P 2020 by Tran et al. [59] focuses on advanced Bitcoin re-routing attacks. However, Tran makes direct claims that actively measuring the BGP policies they require for their attack is difficult and do not do so, though we find in this work that it is, in fact, possible to actively measure BGP policies.

We recommend all of these systems, like our re-evaluation of Nyx, to be reproduced on the live Internet before being deployed to protect actual users. Offensive tools should also be tested ethically before being integrated into the threat models of network practitioners. Much like a modern military would.