to-day network activity and ﬁltering policy, rather than aligning
with MANRS only at an organizational level.
E. Security Ramiﬁcations and Takeaways
Our ﬁndings on poison ﬁltering impact all security systems
mentioned in Section II-C,
including Nyx, LIFEGUARD,
RAD, Waterfall of Liberty, and Feasible Nyx [52], [23], [50],
[36], [60]. While the results of Section V show that BGP
poisoning broadly functions, these experiments reveal that AS-
level ﬁltering in portions of the Internet results in speciﬁc
topological locations where poisoning does not function. As a
result, systems like Waterfall, which depend on BGP poisoning
not to function should seek out those locations for deployment.
By seeking out topological regions of the Internet where poi-
soning is not effective, some of which were described earlier,
censorship circumvention systems can avoid RAD adversaries
wishing to route around decoys.
From the perspective of DDoS, Nyx cannot easily route
around DDoS in the ﬁltered regions of the Internet. This
ﬁltering contributes to the weakened effectiveness of Nyx in
TABLE IV: Default Route Findings
Measurement
Number of Instances
Fraction of Total Samples with Only 1
Provider (not multi-homed)
Fraction of Total Multi-Homed
Samples with Default Routes
Fraction of Transit ASes with Default
Routes
Fraction of Stub/Edge/Fringe ASes
with Default Routes
28.7% (419 / 1,460 total samples)
48.6% (506 / 1,041 multi-homed
samples)
26.8% (196 / 731 total Transit ASes)
36.7% (310 / 845 total Fringe ASes)
practice that we saw in the prior section. The ﬁltering of
long paths also affects Nyx by limiting its ability to poison
the neighbors of the alternate paths, which prevents dragging
along unintended trafﬁc, thus hampering the relief of attack
congestion. Notably, these experiments also put a hard real-
world limit on Internet path length. At 255 ASes, Internet paths
fail to propagate; however, up to 255, paths propagate to 99%
of ASes, unlike what was found with passive measurement in
prior studies [60]. ASes seeking to propagate long paths should
limit the number of poisons used to 245, which accounts for
up to 10 ASes for the actual path. Given that the average path
length is between 3 and 4 ASes [2], this amount of room is
suitable for real-world deployment of poisoning.
VII. REASSESSING REACHABILITY
As part of our study, we setup our infrastructure to attempt
to reproduce Internet measurements from nearly a decade
ago by Bush et al. in Internet Optometry at IMC 2009 [8].
These measurements from 2009 have a distinct impact on the
feasibility of BGP poisoning for security. This section presents
our ﬁndings for an Internet in 2018 with over 60,000 ASes and
estimated 3.8 billion unique users, compared to nearly 25,000
ASes and 1.7 billion users in 2009 [56], [2]. Once again, we
found cases in this evaluation where common assumptions
from the operator community did not coincide with actively
measured Internet behavior.
A. Declining Presence of Default Routes
1) Experimental Design: Default routes exist when an AS
has two or more providers and refuses to choose a second
provider when the ﬁrst provider is "removed" from the topol-
ogy via BGP poisoning. A poisoning AS can theoretically
remove the ﬁrst provider from the steered AS’s topology by
causing the ﬁrst provider to drop (and not propagate) its route
to the poisoning AS. However, when measured in 2009 [8],
14
TABLE V: /25 Reachability Findings
Preﬁx
Length
/25
/25
/24
Measurement
Findings
BGP Observability
Traceroute
Reachability
BGP Observability
Seen at 21/37 (56.7%)
collectors
31% reached /25
preﬁx on average
Seen at 34/37 (91.8%)
collectors
Timespan of
Measurement
96 hours of collection
7 hours; 5,000 distinct
traceroutes every 1 hour
96 hours of collection
this did not always occur when poisoning. Default routes were
evaluated as part of the earlier return path steering experiments.
2) Results and Discussion: We found 330/1,460 successful
poisoning cases exhibited default routes at the steering AS’s
next hop. Thus, steering trafﬁc onto a second, third, or other
provider bordering the remote AS was impossible for these
ASes. As shown by Table IV, we examined the properties
of these ASes by their transit or fringe status. Default routes
existed for 26.8% of the transit ASes we sampled, those being
ASes with 5 or more customers. We also found that 36.7%
of the fringe ASes, or those with less than 5 customers, had
default routes. In 2009, 77% of stub ASes had default routes
(out of 24,224 ASes measured from the poisoner with the ping
utility). In 2018, we found 36.7% of stubs had default routes
(out of 845 ASes measured from the steered AS with RIPE
Atlas probes using traceroute).
Based on the prevalence of default routes, decoy routing
systems [36], [35], [7] could optimize placement of decoy
systems on the immediate next-hop of remote ASes which a
RAD [50] adversary wishes to steer. This approach may yield
stronger security guarantees against poisoning-equipped adver-
saries when the middle of the path exhibits strong compatibility
with poisoning. For systems such as Nyx [52], a steered AS
which has a default route may not be able to provide QoS to
its customers when under a direct DDoS due to the inability
to steer return paths around its next-hop AS that will always
be used for return trafﬁc.
B. Growth of /25 Reachability
When executing return path steering, an originating AS
utilizing poisoning on a set of their own preﬁxes can cause
the poisoned ASes and their trafﬁc to lose connectivity to
the poisoning AS’s preﬁxes, because without a less speciﬁc
covering preﬁx, the poisoned AS will have no path to the
poisoning AS. Fortunately, a poisoning AS can still maintain
reachability given a sufﬁcient allocation of preﬁxes. However,
not all ASes beneﬁt from an ample supply of controlled
preﬁxes. To maintain reachability while poisoning, an AS must
have both a more speciﬁc preﬁx and a less speciﬁc preﬁx.
Current best practice documents recommend ASes ﬁlter adver-
tisements longer than /24 [12]. Therefore, any AS which only
has /24 preﬁxes available will lose reachability to poisoned
ASes unless it can advertise a /25 as the poisoned preﬁx and
use the /24 as the covering preﬁx. We searched the BGP RIB
for an AS’s shortest advertised preﬁx length and found that
48% of them only have /24 preﬁxes advertised, except for
ASes that may have had /25’s already in the default free zone.
For an in-depth examination of BGP preﬁx delegation and who
gets the privilege of many preﬁxes, see recent work by Krenc
et al. [24]. With this necessary primitive for poisoning in mind,
15
we set out to examine the amount of reachability a /24-only
poisoning AS could retain to the poisoned ASes.
1) Experimental Design: For the control-plane measure-
ment, we started by announcing a unique /24 across all 8
preﬁxes. Over the following 96 hours, we collected aggregated
BGP updates from BGPStream [42]. This provides a baseline
number of ASes propagating the path. We then withdrew each
/24 preﬁx. Next, we announced a /25 preﬁx from the same set
of locations across PEERING and the university AS, collecting
the number of updates in the same manner again over 96
hours. With these two sets of ASes, we compute the normalized
percent of ASes propagating the /24 versus the /25.
Next we measure data-plane reachability. We announced a
/25 from our 8 preﬁxes. Then we scheduled 5,000 traceroutes,
randomly sampled from all Atlas probes, directed to the
advertising /25 preﬁxes every hour for 7 hours. We recorded
the number of traceroutes that reached the /25, noting this as
the approximate reachability of the /25. We opted not to do the
traceroutes for the /24 both due to PEERING being used for
other experiments and because we expect a /24 to be reachable
except in the case of faulty Atlas probes.
2) Results and Discussion: Our results from these experi-
ments are shown in Table V. We found that the current data-
plane reachability of a /25 is roughly 30%, while the number
of ASes propagating a /25 BGP announcement is over 50%,
or 50x higher than 2009 results in Bush et al. [8]. Notably,
our analysis shows that the 48% of ASes without sufﬁcient
recommended preﬁxes to steer trafﬁc actually can maintain
reachability. We note that our results may not be able to
be directly compared with Bush’s work due to the use of
traceroutes here over ping, but the comparison at least serves
as a measuring stick for the growing Internet.
Our ﬁndings also have crucial implications for both existing
and future security systems. Censors that do not have a less
speciﬁc preﬁx than a /24 will be unreachable by ASes affected
by path steering for a non-negligible amount of steered ASes.
This may dampen a RAD [50] adversary’s success in terms of
economic means by lost trafﬁc, while strengthening the case
for circumvention tools [36], [7], [35]. Though loss of reach-
ability may not be an issue for censorship entities in general,
smaller censoring nations may sustain signiﬁcant economic
costs. Smaller nations may have few egress BGP paths to the
broader Internet. Any additional sacriﬁced reachability may
have substantial impacts on the businesses and users behind
the border. However, the cases where BGP routers propagate
a /25 may be enough in some attack scenarios for a RAD
adversary, though this is topology-dependent given a poisoning
AS. We recommend that future iterations of the decoy routing
attack and defense schemes factor in our ﬁndings by evaluating
their success for classes of ASes with only a /24 preﬁx. As a
defensive mechanism, operators of Nyx or LIFEGUARD [52]
must be willing to sustain losses of reachability. Defensive
measures must account for these new AS reachability metrics
for ASes with few preﬁxes.
C. Security Ramiﬁcations and Takeaways
Our ﬁndings on reachability and default routes impact
all security systems mentioned in Section II-C,
including
Nyx, LIFEGUARD, RAD, Waterfall of Liberty, and Feasible
Nyx [52], [23], [50], [36], [60]. Like ﬁltering, default routes
and losses of reachability limit what can be claimed by
poisoning-enabled systems such as Nyx, RAD, and LIFE-
GUARD. From the perspective of DDoS, Nyx functions even
with default routes, since attacks are often more than several
hops away from the target in the case of Link Flooding Attacks
(LFAs) [52]. Furthermore, our ﬁnding that 48% of ASes with
only a /24 can in fact use a /25 is signiﬁcant for Nyx and
LIFEGUARD deployers with few IP preﬁxes. Thus, smaller
ISPs can still execute BGP poisoning feasibly and maintain
their connectivity via a less and more speciﬁc preﬁx.
However, our ﬁndings again limit these systems in speciﬁc
cases. For example, decoy routers beneﬁt from RAD [50]
being unable to steer return paths due to default routes near
the poisoning AS, or AS deploying RAD. Poisoning also
impacts the reachability of censoring ASes’ preﬁxes when a
less speciﬁc preﬁx is not available. This presents a difﬁcult
decision to censors unwilling to shut off partial Internet access
to customer trafﬁc. While censors are inhibited by poisoning
in some cases, a censor willing to lose reachability to some
parts of the Internet and aware of decoys not impacted by
default routes can still beneﬁt from BGP poisoning. Finally,
our discovery that the Internet has signiﬁcantly changed from
2009 to 2018 with respect to reachability should come with
no surprises. Therefore, systems designed in an era of a vastly
different Internet topology may need to be re-evaluated again
on the live Internet to see whether their claims are still valid.
VIII. DISCUSSION
A. Reproducibility and Continuous Measurements
All experiments conducted for this paper can be replicated
using the same public infrastructure we utilized. Distributed
traceroutes can be ran using RIPE Atlas [45], other sources
such as NLNOG Ring [48], [18] and PlanetLab [10], [54]
can also be used. BGP measurements can be conducted by
partnering with the PEERING testbed [49], which is available
for use by operators and academic researchers via an applica-
tion process. The experiments in this work were conducted in
the ﬁrst half of 2018, but the measurement infrastructure and
framework is open source 4 and can be deployed to conducted
continuous measurements from the same or similar vantage
points. We hope to work with PEERING and others at UT to
carry these measurements out continuously, providing a live,
ever-changing look at BGP poisoning behavior on the Internet.
B. Experimental Limitations
Our experiments have several limitations. First, some ASes
will ﬁlter poisoned advertisements, and it can be difﬁcult to
fully understand what is driving the behavior without having
insider information from the ISP’s policies. Second, when we
see poisoned advertisements not pass through certain ASes, we
are inherently unable to know whether the lack of propagation
is due to ﬁltering or if the router is invisible from our
perspective on the control plane. We cannot distinguish a case
where both our provider and their provider is ﬁltering poisoned
routes vs. our provider ﬁltering and then our infrastructure
not seeing the new route. This results in our measurements
of ﬁltering being an upper bound on the amount of ﬁltering
4https://github.com/VolSec/active-bgp-measurement
occurring. Fortunately, continuous measurements would help
address several of these limitations.
From a geographic perspective, we did not attempt to mea-
sure the differences in our re-routing feasibility experiments
from Section V geographically. Recent work has found geolo-
cation of routers and AS paths from public and commercial
databases to be unreliable [13]; therefore, we focus on the
topological differences in poisoning feasibility. Finally, the
instability of RIPE Atlas as our distributed traceroute source
can be limiting. Traceroute probes from RIPE Atlas suffer from
infrequent instability due to the small proﬁle of the probes and
the load on the entire measurement network. To adjust for this
behavior, we only use Atlas probes that remain stable for the
entire experiment. We deﬁne stability here as Atlas probes
that continue to respond to API requests and return successful
responses when requesting AS-level network paths.
C. Recommendations for Re-Examining Other Security Work
There are many examples of other security systems from
recent literature, while not focused on poisoning speciﬁcally,
do make assumptions about BGP behavior and for the same
policies as the inferred topology of the Internet
to hold
in practice. Notably, NetHide, which obfuscates traceroutes
across the Internet [32], tests across less than 1% of Internet
ASes of a total 60,000+, but instead only ˜150. Recent studies
of defeating BGP hijacking of Bitcoin,
including SABRE
by Apostolaki et al. [4], [3], only test with the inferred
CAIDA topology, which we show in this paper does not match
reality when it comes to poisoning. Less recent work such as
RAPTOR [58], a look at routing attacks on Tor, claims that 24
preﬁxes are the only preﬁxes that cannot be defeated by a Tor
adversary using RAPTOR, yet we showed earlier that large
swaths of the Internet will respect a 25, allowing Tor to be de-
anonymized in some cases. Finally, a study recently published
at IEEE S&P 2020 by Tran et al. [59] focuses on advanced
Bitcoin re-routing attacks. However, Tran makes direct claims
that actively measuring the BGP policies they require for their
attack is difﬁcult and do not do so, though we ﬁnd in this work
that it is in fact possible to actively measure BGP policies.
We recommend all of these systems, like our re-evaluation
of Nyx, to be reproduced on the live Internet before being
deployed to protect actual users. Offensive tools should also be
tested ethically before being integrated into the threat models
of network practitioners. Much like a modern military would