i f
/ / We ' ve a r r i v e d a t a l e a f node
i n t h e
s e a r c h
tempFixedPeaks = ap ply So lu tio nT oT ra ce ( s o l u t i o n )
/ / A p p l y i n g s o l u t i o n makes a l i s t
/ / We p r o c e s s
same
r e v e r s e d = c o u n t R e v e r s a l s ( tempFixedPeaks )
o f p e a k s
l o o p i n F i g . 1 6
t h e s e w i t h t h e
i f
/ / The
r e v e r s e d % 2 == mustReverse
s o l u t i o n i s a c c e p t a b l e ;
r e t u r n i t s
c o s t
return s o l u t i o n ,
else :
/ / The
/ / R e t u r n i n f i n i t e
return s o l u t i o n ,
c o s t
c o s t
c o s t = I n f
s o l u t i o n d o e s n ' t match r e v e r s a l b e h a v i o r
for peakPair
in s o l u t i o n s :
i f peakPair . errorType == " missing " :
FWCost = i n s e r t C o s t ( peakPair ,
tempSolution = takeBranch ( s o l u t i o n s ,
FWSolution , FWCost =
forward )
s e a r c h S o l u t i o n s ( tempSolution ,
c o s t + FWCost )
i n s e r t F o r w a r d )
RVCost = i n s e r t C o s t ( peakPair ,
tempSolution = takeBranch ( s o l u t i o n s ,
RVSolution , RVCost =
r e v e r s e )
s e a r c h S o l u t i o n s ( tempSolution ,
c o s t + RVCost )
i n s e r t R e v e r s e )
DCCost = d e l e t e C o s t ( peakPair ,
tempSolution = takeBranch ( s o l u t i o n s , d e l e t e C u r r e n t )
DCSolution , DCCost =
c u r r e n t )
s e a r c h S o l u t i o n s ( tempSolution ,
c o s t + DCCost )
DNCost = d e l e t e C o s t ( peakPair , next )
tempSolution = takeBranch ( s o l u t i o n s , d e l e t e N e x t )
DNSolution , DNCost =
s e a r c h S o l u t i o n s ( tempSolution ,
c o s t + DNCost )
b e s t C o s t = minCost ( FWCost , RVCost , DCCost , DNCost )
i f b e s t C o s t == FWCost
b e s t S o l u t i o n = FWSolution
e l i f b e s t C o s t == RVCost
b e s t S o l u t i o n = RVSolution
e l i f b e s t C o s t == DCCost
b e s t S o l u t i o n = DCSolution
e l i f b e s t C o s t == DNCost
b e s t S o l u t i o n = DNSolution
return b e s t S o l u t i o n , b e s t C o s t
e l i f peakPair . errorType == " d u p l i c a t e "
/ / D u p l i c a t e p e a k s a r e h a n d l e d a s above
Figure 13: Heuristic Recursive Solver.
4.6 Point Cloud Generation
Upon completion of the heuristic search and correction process,
the trace contains valid timestamped peaks on the X-, Y-, Z-, and
E-axes, all properly tagged wherever a reversal occurs. Although
the firing order is now fully correct, there may still be discrepancies
between the listed peaks and the real behavior of the printer. In the
final stage, we implemented a state machine to track the position
and behavior of the print head and translate its motions into a point
cloud, with each entry an (X, Y, Z) tuple.
The state machine is initialized with a starting position of (0,
0, 0), then begins to iterate through the peaks in timestamp order.
Processing a peak updates the position of the printhead based on
the axis and movement direction of the peak. The E-axis is tracked
to determine whether a new position is a part of an extruding or
non-extruding move. Dwell annotations on the E-axis peaks mark
the beginning and end for periods of extrusion. If the E-axis is
inactive, the position is updated but not saved to the point cloud.
142Encryption is Futile
RAID ’21, October 6–8, 2021, San Sebastian, Spain
After every peak is consumed, the output from the state machine
is the full point cloud representation of the print. By default, it
is in units of discrete motor steps; we convert to millimeters to
compare the reconstructions to the original models more easily. We
used per-axis steps to millimeter ratios of: 6 : 1 for X, 6 : 1 for Y,
and 95.2 : 1 for Z. The E-axis is used only to track extrusion and
non-extrusion, and does not need to be converted. The point cloud
can be exported as a .XYZ file, a common format for point clouds
and meshes, and manipulated by external modeling programs.
5 EXPERIMENTAL EVALUATION
For our experiment, we selected a range of models that vary in
size and geometric complexity. The simplest is a cube, 10mm on
a side, which prints entirely in linear movements (G0 or G1 G-
code commands). The remaining figures contain both linear and
non-linear movements such as arcs and splines (G2, G3, and G5
G-code commands) and complex surfaces. The models are rendered
in Figure 14.
These models are sliced5 in Cura Lulzbot Edition 3.6.20 for print-
ing on our Lulzbot Taz 6. The slicer settings are consistent across all
models. We use an infill parameter of 20 % with 45 degree rotation
and the default behavior of thicker base layers and full infill for
top and bottom layers. We are therefore reconstructing realistic
sliced and printed models, rather than handmade or simplified print
patterns.
The reconstruction process runtime varied between 15 minutes
to 2 hours, depending on model size. Given the threat model, we
do not consider this restrictive.
The results of our process are given in Table 2. Simpler and
shorter models such as the Cube and Ninja Star are reconstructed
perfectly, while some of the more complex models such as the
Stanford Bunny exhibit visible misalignments across layers. Most
models are only moderately distorted and remain recognizable. A
human engineer could correct the errors and achieve the quality of
the simple objects.
Quantifying these errors and determining their meaningfulness
has presented a novel challenge not appropriately addressed in the
literature. Chhetri et al. [11], who first demonstrated an acoustic
side-channel attack on AM systems, quantified their reconstruction
using average percentage of axis recognition and average move-
ment distance error. They achieved 78.35 % accurate axis recognition
and 17.82 % movement distance error for their test prints, which
were zero-infill perimeter polygons.
Using these distance-oriented metrics, we achieved 100 % axis
recognition (because all individual motors were instrumented).
Across our tested models, we can calculate total distance error
as bad_section_steps/total_steps. This produces a maximum error
of 1.7 % for the Rook model, and a minimum of 0.07 % for the
Wrench. On average, the error was 0.79 %. This figure represents an
upper bound of error, because not every step within a bad section
is incorrect.
Gao et al. [17] evaluated their reconstruction of the infill path
using a metric derived from the Hausdorff Distance. Their approach
5Slicer is. a common term for the software used to generate a printer-executable
toolpath from a model file and printer configuration parameters, controlling elements
such as infill patterns and support structures.
(a) Cube
(b) Ninja Star
(c) Wrench
(d) Rook
(e) Gear
(f) Bucky Ball
(g) Octopus
(h) Turbine Blade
(i) Stanford Bunny
(j) Stanford Lucy
Figure 14: Original STL models used in the experiment.
locates the point in the reconstructed path that is most distant from
any point in the original path, and reports that distance as an upper
bound on error.
However, we believe all approaches to date for measuring accu-
racy have limited use in the context of AM reconstruction. This
topic is explored further in Section 7.1.
143RAID ’21, October 6–8, 2021, San Sebastian, Spain
Gatlin et al.
Table 2: Point cloud renderings and metrics of the reconstructed models. Any support structure is included in the rendering.
6 FUNDAMENTAL LIMITATIONS
While our approach achieved significantly higher accuracy on
more complex models than prior reconstruction attempts it still
contains uncorrected errors. We suspect that some can be corrected,
while others are fundamental to the approach. The most fundamen-
tal limitations are discussed below.
The most interesting limitation arises from the disconnect be-
tween the toolpath motions and the true shape of the printed part.
When the printhead is positioned, the nozzle is placed slightly above
the extrusion position to leave room for filament to extrude and
attach without collisions. The extruded filament also has a diameter,
which changes shape while it solidifies. During printing motions,
the elasticity of the molten filament means that it will continue to
extrude after the extruder motor stops moving. When planning a
toolpath, the slicer attempts to account for these and other physical
characteristics of the material and printing system. Many of these
compensation techniques are adjusted by the user, vary according
to printer and settings, and are largely opaque to our side-channel
analysis. Producing a mesh directly from the reconstructed point
cloud will produce a smaller mesh than the original because of these
offsets, and it will contain small gaps due to flow-rate manipulation.
RAID’21,October6–8,2021,SanSebastian,SpainGatlinetal.Table2:Pointcloudrenderingsandmetricsofthereconstructedmodels.Anysupportstructureisincludedintherendering.MetricsRenderName:CubePrintDuration:13.63minStepsTraveled:98,098PointsinCloud:80,196Sections:2,344BadSections:351B.S.Max.Length:2B.S.Avg.Length:1.00Name:WrenchPrintDuration:44.33minStepsTraveled:774,063PointsinCloud:563,305Sections:21,445BadSections:5,334B.S.Max.Length:7B.S.Avg.Length:1.05Name:GearPrintDuration:50minStepsTraveled:728,078PointsinCloud:611,807Sections:25,893BadSections:5,572B.S.Max.Length:6B.S.Avg.Length:1.15Name:OctopusPrintDuration:66.58minStepsTraveled:959,332PointsinCloud:715,662Sections:19,375BadSections:5,684B.S.Max.Length:7B.S.Avg.Length:1.08Name:Stan.BunnyPrintDuration:302minStepsTraveled:5,629,158PointsinCloud:4,490,563Sections:82,030BadSections:23,167B.S.Max.Length:11B.S.Avg.Length:1.10MetricsRenderName:NinjaStarPrintDuration:4.48minStepsTraveled:65,534PointsinCloud:49,297Sections:1,384BadSections:349B.S.Max.Length:4B.S.Avg.Length:1.1Name:RookPrintDuration:49.98minStepsTraveled:429,117PointsinCloud:340,909Sections:23,735BadSections:6,497B.S.Max.Length:9B.S.Avg.Length:1.15Name:BuckyBallPrintDuration:154minStepsTraveled:1,731,428PointsinCloud:1,126,327Sections:68,796BadSections:21,269B.S.Max.Length:7B.S.Avg.Length:1.09Name:TurbineBladePrintDuration:84.98minStepsTraveled:879,667PointsinCloud:629,200Sections:25,192BadSections:8,386B.S.Max.Length:5B.S.Avg.Length:1.07Name:Stan.LucyPrintDuration:242minStepsTraveled:3,827,019PointsinCloud:2,578,250Sections:98,730BadSections:29,193B.S.Max.Length:7B.S.Avg.Length:1.136FUNDAMENTALLIMITATIONSWhileourapproachachievedsignificantlyhigheraccuracyonmorecomplexmodelsthanpriorreconstructionattemptsitstillcontainsuncorrectederrors.Wesuspectthatsomecanbecorrected,whileothersarefundamentaltotheapproach.Themostfundamen-tallimitationsarediscussedbelow.Themostinterestinglimitationarisesfromthedisconnectbe-tweenthetoolpathmotionsandthetrueshapeoftheprintedpart.Whentheprintheadispositioned,thenozzleisplacedslightlyabovetheextrusionpositiontoleaveroomforfilamenttoextrudeandattachwithoutcollisions.Theextrudedfilamentalsohasadiameter,whichchangesshapewhileitsolidifies.Duringprintingmotions,theelasticityofthemoltenfilamentmeansthatitwillcontinuetoextrudeaftertheextrudermotorstopsmoving.Whenplanningatoolpath,theslicerattemptstoaccountfortheseandotherphysicalcharacteristicsofthematerialandprintingsystem.Manyofthesecompensationtechniquesareadjustedbytheuser,varyaccordingtoprinterandsettings,andarelargelyopaquetoourside-channelanalysis.Producingameshdirectlyfromthereconstructedpointcloudwillproduceasmallermeshthantheoriginalbecauseoftheseoffsets,anditwillcontainsmallgapsduetoflow-ratemanipulation.144Encryption is Futile
RAID ’21, October 6–8, 2021, San Sebastian, Spain
Another key limitation is that the approach cannot distinguish
between body and supporting printed material. Many objects must
be printed with support material to allow for large overhangs and
prevent print defects such as sagging or non-adhesion. Given vari-
ation in support structure design and use, recognizing it automat-
ically based on geometric characteristics would appear to be a
difficult proposition.
These key limitations are based on the characteristics of the 3D
printer, filament, and options available in the slicer. Undoubtedly,
further study will uncover more limitations but also the means to
overcome them. The techniques necessary to evaluate and compen-
sate for these are beyond the scope of the present work.
7 FURTHER DISCUSSION
7.1 Measuring Error in Reconstruction
From a security perspective, the key benefit of disclosing this attack
is to enable realistic risk analysis. For infringement, an attacker
needs an accurate enough reconstruction method. As defenders, we
must therefore assess the quality of the attack from this perspec-
tive. However, there are several fundamental issues in assessing
reconstructions of printed models.
The point cloud generated by our method not only describes the
exterior surface of the object, but also describes the interior points
corresponding to infill, internal voids, support structures, and other
features. Established methods for comparing similar paths, such
as the Hausdorff Distance [21], can be adapted by restricting their
application to individual layers (as in Gao et al. [17]), but even then
questions remain.
Most importantly, it is difficult to ascertain if any existing met-
rics correspond meaningfully to the printability of an object. For
example, one step of drift in our system corresponds to 0.16mm.
This may seem like an inconsequential amount of drift, but it could
be enough to completely collapse a support structure, which is
often only one step wide. Drift on a support structure, even in this
smallest possible increment, could lead to a failed print. If it occurs
elsewhere, it may not even be visible to the naked eye. Figure 16
demonstrates this difference: the degree of drift in the Octopus print
is consistently 1-4 steps, which is barely noticeable in the main body
but would cause a print failure in the fine details. The impact of
error on printability, therefore, is not necessarily proportional to
simple measures like distance.
New metrics must be developed for assessing the quality of re-
constructions in AM. The preceding discussion implies that these
metrics may only be meaningful for specific AM technologies. Solv-
ing these and eventually further to-be-identified challenges requires
dedicated investigations that are outside the scope of this paper.
7.2 Implications for Risk Management
The presented reconstruction attack poses a threat to outsourced
FDM printing processes that circumvents encryption-based DRM
technology. But what risk does this pose for a business relying on
an AM service provider using FDM printing? A business facing
such a risk must decide on a response: in-house their printing
operations, deploy technical and policy strategies, or accept the
risk and proceed without a mitigation strategy.
Figure 15: Cybersecurity Framework Core subcategories [1].
To support this decision process, organizations might turn to
NIST’s guidance in the Cybersecurity Framework [1]. While this
framework is voluntary in U.S. industry, its use is mandated within
the U.S. government itself [23]. The Framework is hierarchical with
five high-level risk management functions at the top, categories
of security outcomes in the middle, and over 100 distinct outcome
subcategories at the bottom. Each subcategory includes informative
references to existing standards and best practices. Figure 15 pro-
vides a top-level view of the Framework’s structure, with relevant
categories and subcategories. Below, we provide specific exam-
ples where the threat of attack developed in this paper could be
accounted for from within the cyber-security Framework.
A straightforward subcategory to apply is Data Security (PR.DS-
5), stating that protections against data leaks should be imple-
mented. Side-channel theft of design data would represent a substan-