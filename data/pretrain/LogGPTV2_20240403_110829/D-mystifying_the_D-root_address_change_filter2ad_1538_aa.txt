title:D-mystifying the D-root address change
author:Matthew Lentz and
Dave Levin and
Jason Castonguay and
Neil Spring and
Bobby Bhattacharjee
D-mystifying the D-root Address Change
Matthew Lentz
PI:EMAIL PI:EMAIL PI:EMAIL PI:EMAIL
Jason Castonguay
Dave Levin
Neil Spring
Bobby Bhattacharjee
PI:EMAIL
University of Maryland
ABSTRACT
On January 3, 2013, the D-root DNS server hosted at the Univer-
sity of Maryland changed IP address. To avoid service disruption,
the old address continues to answer queries. In this paper, we per-
form an initial investigation of the trafﬁc at both the new and old
addresses before, during, and since the ﬂag day. The data we col-
lected show non-obvious behavior: the overall query volume to the
D-roots increases by roughly 50%, the old address continues to re-
ceive a high volume of queries months after the changeover, and
far more queries to the old address succeed than those to the new
one. Our analysis provides a window into how compliant resolvers
change over and how non-standard and seemingly malicious re-
solvers react (or not) to the IP address change. We provide evidence
that a relatively small number of implementation errors account for
nearly all discrepancies that are not misconﬁgurations or attacks.
Categories and Subject Descriptors
C.2.3 [Computer-Communication Networks]: Network Opera-
tions; C.2.5 [Computer-Communication Networks]: Local and
Wide-Area Networks—Internet
Keywords
Domain Name Service; Measurement; Root Server
1.
INTRODUCTION
DNS is a foundational protocol of the Internet, and fundamen-
tal to DNS are its 13 root name servers, responsible for last-resort
queries for top level domains (TLDs). To bootstrap DNS, root
servers’ IP addresses are widely disseminated, both out-of-band
(via hints ﬁles) and in-band (via so-called priming queries, where
one root server provides the others’ IP addresses).
The University of Maryland hosts the D-root name server, origi-
nally referred to as terp.umd.edu (TERP). TERP has always been a
root nameserver. 128.8.10.90 was an early IP address for TERP (D)
appearing in BIND 4.2.1 in 1989. In order to support a robust any-
casted service for “critical infrastructure,” ICANN and ARIN have
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full cita-
tion on the ﬁrst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from permissions@acm.org.
IMC’13, October 23–25, 2013, Barcelona, Spain.
Copyright 2013 ACM 978-1-4503-1953-9/13/10 ...$15.00.
http://dx.doi.org/10.1145/2504730.2504772.
allocated several /24 IPv4 (and /30 IPv6) address blocks to differ-
ent organizations. Root name server operators receive a new /24
IPv4 micro-allocation that is used to host anycasted root servers [8,
11]. Under this policy, the 199.7.91/24 block was allocated to the
University of Maryland, and the D-root server address was changed
from 128.8.10.90 to 199.7.91.13. The new /24 IPv4 block will be
anycasted globally.
Though root servers very rarely change their IP addresses (his-
torically, at most once each, to permit anycast addressing), there
are some generally well-known phenomena that occur when they
do. In particular, overall query volume increases, and queries per-
sist at the old IP address, seemingly indeﬁnitely (we review these
prior observations in §2). Yet, surprisingly, there remains no expla-
nation as to why these occur. This is almost our last chance to ﬁnd
out; D-root is the penultimate root server to change its IP address.
This paper presents and analyzes data we collected before, dur-
ing, and for several months after D-root’s address change. With
these data, we observe the same phenomena of prior measurements
at other root servers, and we identify a new one: widely differing
query success rates between the old and new addresses (§3). We
identify potential root causes to increases in query volume: we be-
lieve it to be largely due to a particular resolver, PowerDNS (§4).
To explain persistent queries to the old address, we present a clas-
siﬁcation of name servers—those that only visit the new address
after an extended period of time, those that only visit the old, and,
surprisingly, those that rapidly swap between the two. We show
that these different classes exhibit very different behavior, and can
be used to help identify root causes (§5). We conclude that, while
it can have wide-reaching effects on hosts throughout the Internet,
changing a root name server’s IP address can be helpful in identify-
ing bugs, misconﬁgurations, and attacks, and that perhaps changing
root servers’ IP addresses should not be a historical event but rather
a periodic, crude means of garbage collection (§6).
2. BACKGROUND AND RELATED WORK
In DNS, root name servers serve the “root zone,” which lies at
the top of the namespace hierarchy. Each root name server pro-
vides authoritative answers to queries regarding root zone records.
For all other queries, they provide pointers to the authoritative name
servers for the top level domain (TLD) (e.g., com or edu) as speci-
ﬁed in the query.
As per its original design constraint that limited UDP responses
to 512 bytes, the DNS protocol supports a maximum of 13 root
name server addresses. Due to the expansive growth of the Internet,
these servers quickly became under-provisioned to handle the large
number of queries. In order to ﬁx this limitation without patching
the existing protocol, anycasting [8, 11] was suggested as a means
Queries (×103)
Total
Invalid TLD
Malformed
Underscore
RFC1918 PTR
Non-Print Char
A-for-A
Invalid Class
01/02 00:00 -
01/03 09:53
Old New
897
199
0.6
1.0
0.2
0
0
0
1,690,311
655,732
3,934
2,529
272
117
6
4
01/03 09:53 -
01/09 17:11
Old
5,229,920
1,613,107
6,802
9,107
985
94
39
19
New
6,547,199
4,918,226
9,104
1,755
168
28
143
29
Table 1: Scaled overall query volume (in thousands) broken down
into reasons for invalidity for both the old and new server. The
time interval is divided according to before and after the old server
started advertising the new IP address (on Jan 3rd at 09:53).
to distribute the root name server instances across a large number
of global replicas.
DNS Root Server Trafﬁc Analysis.
Prior analyses of trafﬁc at DNS root name servers identiﬁed sig-
niﬁcant levels of malformed or invalid queries [3, 4, 7, 13]. A 2008
study by Castro et al. [4] found that only 1.8% of the trafﬁc that ar-
rives at 8 of the 13 root name servers was valid. Based on the trafﬁc
breakdown, the following four categories comprise 94.9% of the to-
tal: identical and repeated queries, failure to cache referrals, and in-
valid TLDs (e.g., local). These results validate and expand upon a
2003 study by Wessels and Fomenkov [13], which discovered only
2.15% legitimate trafﬁc at F-root. These prior studies focus on be-
havior at steady state, whereas we study a rare event; however, if
DNS resolvers transition to the new address as intended, we expect
the steady state behavior at the new address to mimic the old.
D-root is not the ﬁrst root server to be measured during an IP ad-
dress change. Barber et al. measured the J-root address change [2],
and Manning presented an overview of B-root’s [10].
Both initiatives reported signiﬁcant, prolonged levels of trafﬁc
at the old IP address—even two years after the change, despite the
fact that root name server records have limited TTLs (currently 41
days for A records and 6 days for NS records). To determine the var-
ious software versions for the resolvers that appeared to be acting
incorrectly, both the B- and J-root studies used the fpdns [1] ﬁnger-
printing tool. Newer resolver software versions (e.g., BIND9 [9])
appeared incorrect despite having implemented the mechanisms to
(ostensibly) handle these IP address changes.
Nonetheless, the root cause behind this behavior has remained
undetermined. While generally well-known that an increase of vol-
ume is imminent, there is surprisingly little insight into why. In this
paper, we initiate a thorough analysis of D-root’s address change
and identify what we believe to be the major root causes behind
this and other anomalies.
3. DATA COLLECTION AND OVERVIEW
In this section, we describe the data we collected, and identify
three anomalies that drive our initial measurement analysis.
3.1 Data collection
The new address is hosted on a new interface on the same phys-
ical host as the old address. We port mirrored both interfaces, and
collected two datasets. The ﬁrst consists of full-payload packet
captures using tcpdump on the aggregate trafﬁc to both the new
and old IP addresses. Unfortunately, the trafﬁc volume (∼20,000
queries per second on average) is too high to allow us to capture all