respect to source and destination mapping. We discuss other
related efforts here.
Automotive attacks: There have been a number of efforts
at demonstrating vulnerabilities of automotive networks, in-
cluding work on injecting messages [20], attacking keyless
entry systems [8, 16, 28], and speciﬁc components such as
TPMS [17, 18]. Our work can better inform such attack ef-
forts and defenses by proactively identifying possible attack
channels.
Intrusion detection for automotive: Given the growing
security concerns, related work has also developed intrusion
detection and ﬁrewall capabilities akin to traditional networks
(e.g., [11, 19, 22, 29, 31]). Some of these may interfere with
mapping efforts. More generally, however, these may have
blind spots that a network mapper can highlight.
Alternative source identiﬁcation: We acknowledge previ-
ous efforts that aim to identify message sources [12, 27].
While these efforts may prove valid, they either require many
hours of data or require physical access to the bus for just
source mapping. CANvas permits source mapping using a
passively-recorded timestamped trafﬁc log.
Authentication in CAN: We acknowledge that authentica-
tion for CAN devices may implicitly solve the source map-
ping problem. However, proposed authentication methods are
rarely employed in real vehicles due to either the permanent
addition of new devices or changes to the existing CAN pro-
tocol. Prior work, such as the TCAN system [5], requires the
addition of a new device, access to two locations on the bus
and a static authentication table. CANvas, however, acknowl-
edges that timing characteristics can and will change due to
clock drift. By comparing clock offsets, CANvas does not
rely on static timing characteristics. CANvas does not even
need physical access to the bus for source mapping as we only
require a hardware-timestamped trafﬁc log, and we operate
solely from the OBD-II port without an additional permanent
device.
Other work on ECU ﬁngerprinting: Following initial ef-
forts on ﬁngerprinting [14, 27], other work has improved on
their basic approach by identifying potential pitfalls [11, 12,
29]. As we show in our work, all of these still suffer from
the same limitations in our context as they still assume either
active access to the bus or very long trafﬁc dumps.
10 Conclusions
In this work, we develop CANvas, a fast and inexpensive auto-
motive network mapper. We have released our code and data
under open-source licenses to enable further work in this area.
A natural direction of future work is to add richer functionality,
e.g. identifying the function of an ECU (transmission ECU,
engine ECU, etc.), identifying gateway ECUs that potentially
bridge multiple CAN buses and identifying vendor-speciﬁc
message acceptance ﬁlters. Future work should also inves-
tigate network mapping on other automotive protocols, e.g.
automotive Ethernet.
Acknowledgements
This work was funded in part by the PITAXVIII PITA award
and the CNS-1564009 NSF IoT award. We gratefully ac-
knowledge support from Technologies for Safe and Efﬁcient
Transportation (T-SET) University Transportation Center.
This work was also supported in part by the CONIX Re-
search Center, one of six centers in JUMP, a Semiconductor
Research Corporation (SRC) program sponsored by DARPA.
We thank the anonymous reviewers and our shepherd Konrad
Rieck for their helpful suggestions.
Availability
This work is made available [1] to encourage the community
to add richer functionality and use CANvas to further the
creation of automotive security tools.
References
[1] Canvas. https://github.com/sekarkulandaivel/
canvas.
[2] Introduction to can. http://www.ti.com/lit/an/
sloa101b/sloa101b.pdf.
[3] Motorcraft
service.
motorcraftservice.com/.
info
https://www.
[4] Obd-ii background information. http://www.obdii.
com/background.html.
[5] Tcan: Authentication without cryptography on
a can bus based on nodes location on the bus.
https://autosec.se/wp-content/uploads/2019/
03/3.-ESCAR-EU-2018.pdf.
USENIX Association
28th USENIX Security Symposium    403
[6] Toyota techinfo service. https://techinfo.toyota.
com.
[7] What
limp mode
use
https://repairpal.com/symptoms/
is, and why
cars
it.
what-is-limp-mode-why-cars-use-it.
[8] Ansaf Ibrahem Alrabady and Syed Masud Mahmud.
Analysis of attacks against the security of keyless-entry
systems for vehicles and suggestions for improved de-
IEEE transactions on vehicular technology,
signs.
54(1):41–50, 2005. https://ieeexplore.ieee.org/
iel5/25/30186/01386610.pdf.
[9] Stephen Checkoway, Damon McCoy, Brian Kantor,
Danny Anderson, Hovav Shacham, Stefan Savage, Karl
Koscher, Alexei Czeskis, Franziska Roesner, Tadayoshi
Kohno, et al. Comprehensive experimental analyses of
automotive attack surfaces. In USENIX Security Sympo-
sium, pages 77–92. San Francisco, 2011. http://www.
autosec.org/pubs/cars-usenixsec2011.pdf.
[10] Kyong-Tak Cho and Kang G Shin. Error handling of
In Pro-
in-vehicle networks makes them vulnerable.
ceedings of the 2016 ACM SIGSAC Conference on Com-
puter and Communications Security, pages 1044–1055.
ACM, 2016. https://dl.acm.org/citation.cfm?
id=2978302.
[11] Kyong-Tak Cho and Kang G Shin.
electronic
detection.
printing
intrusion
Symposium, pages
//www.usenix.org/system/files/conference/
usenixsecurity16/sec16_paper_cho.pdf.
Finger-
for vehicle
In USENIX Security
https:
911–927, 2016.
control
units
[12] Wonsuk Choi, Hyo Jin Jo, Samuel Woo, Ji Young Chun,
Jooyoung Park, and Dong Hoon Lee. Identifying ecus
using inimitable characteristics of signals in controller
area networks. IEEE Transactions on Vehicular Technol-
ogy, 67(6):4757–4770, 2018. https://ieeexplore.
ieee.org/iel7/25/4356907/08303766.pdf.
[13] Robert I Davis, Alan Burns, Reinder J Bril, and Johan J
Lukkien. Controller area network (can) schedulability
analysis: Refuted, revisited and revised. Real-Time Sys-
tems, 35(3):239–272, 2007. https://link.springer.
com/article/10.1007/s11241-007-9012-7.
the
controller area
[14] Marco Di Natale, Haibo Zeng, Paolo Giusto,
Understanding and us-
communica-
Springer
http:
and Arkadeb Ghosal.
ing
network
tion protocol:
theory and practice.
Science & Business Media, 2012.
//citeseerx.ist.psu.edu/viewdoc/download?
doi=10.1.1.512.5543&rep=rep1&type=pdf.
[15] Mohammad Farsi, Karl Ratcliff, and Manuel Barbosa.
An overview of controller area network. Comput-
ing & Control Engineering Journal, 10(3):113–120,
1999. https://ieeexplore.ieee.org/iel5/2218/
17068/00788104.pdf.
[16] Aurélien Francillon, Boris Danev, and Srdjan Capkun.
Relay attacks on passive keyless entry and start
In Proceedings of the
systems in modern cars.
Network and Distributed System Security Symposium
(NDSS). Eidgenössische Technische Hochschule Zürich,
Department of Computer Science, 2011. https://
www.research-collection.ethz.ch/bitstream/
handle/20.500.11850/42365/eth-4572-01.pdf.
[17] Abdulmalik Humayed and Bo Luo. Cyber-physical secu-
rity for smart cars: taxonomy of vulnerabilities, threats,
In Proceedings of the ACM/IEEE Sixth
and attacks.
International Conference on Cyber-Physical Systems,
pages 252–253. ACM, 2015. https://dl.acm.org/
citation.cfm?id=2735992.
[18] Rob Millerb Ishtiaq Roufa, Hossen Mustafaa,
Sangho Ohb Travis Taylora, Wenyuan Xua, Marco
Gruteserb, Wade Trappeb, and Ivan Seskarb. Security
and privacy vulnerabilities of in-car wireless networks:
A tire pressure monitoring system case study. In 19th
USENIX Security Symposium, Washington DC, pages
11–13, 2010.
https://www.usenix.org/legacy/
event/sec10/tech/full_papers/Rouf.pdf.
[19] Min-Joo Kang and Je-Won Kang.
Intrusion de-
tection system using deep neural network for in-
vehicle network security. PloS one, 11(6):e0155781,
2016.
https://journals.plos.org/plosone/
article?id=10.1371/journal.pone.0155781.
[20] Karl Koscher, Alexei Czeskis, Franziska Roesner, Shwe-
tak Patel, Tadayoshi Kohno, Stephen Checkoway, Da-
mon McCoy, Brian Kantor, Danny Anderson, Ho-
Experimental security analy-
vav Shacham, et al.
In Security and Pri-
sis of a modern automobile.
vacy (SP), 2010 IEEE Symposium on, pages 447–
462. IEEE, 2010. http://www.autosec.org/pubs/
cars-oakland2010.pdf.
[21] Gordon Fyodor Lyon. Nmap network scanning: The
ofﬁcial Nmap project guide to network discovery and
security scanning. Insecure, 2009. https://dl.acm.
org/citation.cfm?id=1538595.
[22] Tsutomu Matsumoto, Masato Hata, Masato Tanabe,
Katsunari Yoshioka, and Kazuomi Oishi. A method
of preventing unauthorized data transmission in con-
In 2012 IEEE 75th Vehicu-
troller area network.
lar Technology Conference (VTC Spring), pages 1–5.
404    28th USENIX Security Symposium
USENIX Association
IEEE, 2012. https://ieeexplore.ieee.org/iel5/
6238551/6239848/06240294.pdf.
[23] Jérôme Maye and Mario Krucker. Communication with
a toyota prius. https://attachments.priuschat.
com/attachment-files/2017/04/122809_
Communication_with_a_Toyota_Prius.pdf.
[24] Charlie Miller and Chris Valasek. Adventures in automo-
tive networks and control units. Def Con, 21:260–264,
2013. http://illmatics.com/car_hacking.pdf.
[25] Charlie Miller and Chris Valasek. A survey of remote
automotive attack surfaces. black hat USA, 2014:94,
2014. http://illmatics.com/remote%20attack%
20surfaces.pdf.
[26] Charlie Miller and Chris Valasek. Remote exploita-
tion of an unaltered passenger vehicle. Black Hat USA,
2015:91, 2015.
http://illmatics.com/Remote%
20Car%20Hacking.pdf.
[27] Pal-Stefan Murvay and Bogdan Groza. Source identi-
ﬁcation using signal characteristics in controller area
networks. IEEE Signal Processing Letters, 21(4):395–
399, 2014. https://ieeexplore.ieee.org/iel7/
97/4358004/06730667.pdf.
[28] Irving S Reed, Xiaowei Yin, and Xuemin Chen. Keyless
entry system using a rolling code, February 4 1997.
https://patentimages.storage.googleapis.
com/c3/02/da/89f0cef9c2a9ea/US5600324.pdf.
[29] Sang Uk Sagong, Xuhang Ying, Andrew Clark, Linda
Bushnell, and Radha Poovendran. Cloaking the clock:
emulating clock skew in controller area networks. In
Proceedings of the 9th ACM/IEEE International Con-
ference on Cyber-Physical Systems, pages 32–42. IEEE
Press, 2018. https://dl.acm.org/citation.cfm?
id=3207896.3207901.
[30] Craig Smith. The Car Hacker’s Handbook: A Guide for
the Penetration Tester. No Starch Press, 2016. http:
//opengarages.org/handbook/.
[31] Hyun Min Song, Ha Rang Kim, and Huy Kang
Kim.
Intrusion detection system based on the anal-
ysis of time intervals of can messages for in-vehicle
In 2016 international conference on in-
network.
formation networking (ICOIN), pages 63–68. IEEE,
2016. https://ieeexplore.ieee.org/abstract/
document/7427089/.
[32] CAN Speciﬁcation. Bosch. 1991. http://esd.cs.
ucr.edu/webres/can20.pdf.
[33] Ken Tindell, H Hanssmon, and Andy J Wellings.
Analysing real-time communications: Controller area
In RTSS, pages 259–263. Citeseer,
network (can).
1994. http://citeseerx.ist.psu.edu/viewdoc/
download?doi=10.1.1.57.5047&rep=rep1&type=
pdf.
USENIX Association
28th USENIX Security Symposium    405