title:Practical Detection of Entropy Loss in Pseudo-Random Number Generators
author:Felix D&quot;orre and
Vladimir Klebanov
Security analysis for pseudo-random number generators
Sylvain Ruhault
To cite this version:
Sylvain Ruhault. Security analysis for pseudo-random number generators. Cryptography and Se-
curity [cs.CR]. Ecole normale supérieure - ENS PARIS, 2015. English.
NNT : 2015ENSU0014.
tel-01236602v2
HAL Id: tel-01236602
https://tel.archives-ouvertes.fr/tel-01236602v2
Submitted on 18 Apr 2018
HAL is a multi-disciplinary open access
archive for the deposit and dissemination of sci-
entific research documents, whether they are pub-
lished or not. The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.
L’archive ouverte pluridisciplinaire HAL, est
destinée au dépôt et à la diffusion de documents
scientifiques de niveau recherche, publiés ou non,
émanant des établissements d’enseignement et de
recherche français ou étrangers, des laboratoires
publics ou privés.
École Doctorale de Sciences Mathématiques de Paris Centre
Security Analysis for
Pseudo-Random Number Generators
THÈSE
présentée pour l’obtention du
Doctorat de l’École normale supérieure
(Spécialité Informatique)
par
Sylvain Ruhault
Soutenue publiquement le 30 Juin 2015 devant le jury composé de
Pierre-Alain Fouque . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Examinateur
Marc Girault . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Examinateur
David Pointcheval
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Directeur de thèse
Bart Preneel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Rapporteur
Emmanuel Prouﬀ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Rapporteur
Phillip Rogaway . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Examinateur
Nicolas Sendrier . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Examinateur
Damien Vergnaud . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Directeur de thèse
Travaux eﬀectués au sein de l’Équipe de Cryptographie
du Département d’Informatique de l’École normale supérieure
Remerciements
Je voudrais en premier lieu remercier David Pointcheval et Damien Vergnaud pour m’avoir
accueilli au laboratoire de cryptographie du Département d’Informatique de l’ENS et pour avoir
si bien dirigé mes travaux de thèse. Leur disponibilité, leur rigueur scientiﬁque et leur implication
ont grandement contribué à l’aboutissement de ce projet. Je les remercie sincèrement pour tout
le temps passé à répondre patiemment à toutes mes questions, scientiﬁques ou autres, pour avoir
lu et relu les diﬀérentes versions de ce manuscrit et de mes articles et pour m’avoir aidé dans
les répétitions de présentations.
Je voudrais également remercier Eric Dehais pour m’avoir toujours soutenu dans ce projet et
pour voir autant engagé Oppida pour son aboutissement dans les meilleures conditions. Je
voudrais aussi rendre ici hommage à sa volonté d’investir dans la connaissance et la recherche.
Je remercie vivement l’ensemble des membres du jury qui m’ont fait l’honneur d’évaluer mon
travail. Je suis très reconnaissant à Emmanuel Prouﬀ et à Bart Preneel pour l’intérêt qu’ils
ont porté à ma thèse en acceptant d’en être rapporteurs. Je remercie également Pierre-Alain
Fouque, Marc Girault, Phillip Rogaway et Nicolas Sendrier d’avoir accepté de faire partie du
jury en tant qu’examinateurs.
Je remercie tous mes co-auteurs avec qui j’ai eu des collaborations enrichissantes gràce à leurs
qualités scientiﬁques et humaines. En plus de Damien et David, j’ai eu l’opportunité de travailler
avec Yevgeniy Dodis lors de son séjour au laboratoire en juin 2012 et de co-écrire avec lui et
Daniel Wichs un premier article scientiﬁque. Par la suite j’ai eu l’opportunité de co-écrire un
second article avec Mario Cornejo et un troisième avec Sonia Belaïd et Michel Abdalla. J’espère
sincèrement que nous aurons l’occasion de travailler ensemble sur de nouveaux projets.
Ces années de thèse ont été l’occasion de rencontres très enrichissantes, que ce soit au laboratoire,
à Oppida ou ailleurs. Je voudrais remercier les chercheurs et les étudiants que j’ai pu rencontrer
au laboratoire: Adrian, Alain, Angelo, Aurélie, Aurore, Cécile, Céline, Duong-Hieu, Dario,
Elisabeth, Fabrice, Geoﬀroy, Guiseppe, Hoeteck, Houda, Louiza, Itai, Joana, Kenneth, Léo,
Mario, Miriam, Pierre-Alain, Pierrick, Rafael, Roch, Sorina, Tancrède, Thomas, Thomas et
Vadim; Louiza, la future étudiante d’Oppida; Marion et Patrick, qui m’ont invité à présenter
mes travaux au LORIA au GREYC; et toute la communauté C2 rencontrée à Dinard et aux
Sept Laux.
Je remercie également l’ENS pour fournir le cadre de travail aussi favorable à la recherche
et de m’avoir permis de participer à de nombreuses conférences. J’en proﬁte pour remercier
l’ensemble du personnel du Département d’Informatique, en particulier Joëlle Isnard, Valérie
Mongiat, Michele Angely et Jacques Beigbeder pour l’eﬃcacité avec laquelle ils ont géré toutes
les questions administratives et techniques au cours de ma thèse.
Je pense aussi à tous mes amis et à ma famille qui de près ou de loin m’ont suivi et m’ont
encouragé dans ce projet. Merci beaucoup à Christophe, Jean-François, Jan et Aziz pour leurs
encouragements précieux.
Je voudrais terminer ces remerciements par les personnes qui comptent le plus pour moi, ma
femme Raja et mes deux ﬁlles Mona et Nada. Ce projet n’aurait pas été possible sans leur
soutien constant et leur joie de vivre communicative.
— iii —
Figure 1 – Extract from the Proceedings of the plenary session of the Pontiﬁcal Academy of
Sciences, Vatican City, Italy, October 27-31 1992 [Pul]
.
— iv —
Contents
1 Introduction
1.1 Pseudo-Random Number Generators . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Randomness Extractors
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.3 Security Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4 Potential Weaknesses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.5 Contributions of this Thesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2 Preliminaries
2.1 Probabilities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2
Indistinguishability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.3 Hash Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.4 Game Playing Framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.5 Shannon Entropy, Min-Entropy . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.6 Randomness Extractors
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.7 Leftover Hash Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.8 Pseudo-Random Number Generators . . . . . . . . . . . . . . . . . . . . . . . . .
2.8.1
Standard Pseudo-Random Number Generator . . . . . . . . . . . . . . . .
2.8.2
Stateful Pseudo-Random Number Generator
. . . . . . . . . . . . . . . .
2.8.3 Pseudo-Random Number Generator with Input . . . . . . . . . . . . . . .
2.9 Pseudo-Random Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.10 Pseudo-random Permutations . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3 Security Models for Pseudo-random Number Generators
3.3 Security Model From [BY03]
3.1
3.2 Guidelines from [Gut98,KSWH98]
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . .
3.2.1 Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.2.2 Proposed Formalization . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.3.1 Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.3.2 A Secure Construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.4 Security Model from [DHY02] . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.4.1 Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.4.2
Secure Constructions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.5 Security Model From [BST03] . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.5.1 Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.5.2 A Secure Construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.6.1 Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.6.2 A Secure Construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.6 Security Model From [BH05]
— v —
1
1
2
3
4
5
9
9
9
10
10
11
13
19
20
20
21
22
23
24
27
27
28
28
29
31
31
32
34
34
36
37
37
39
40
40
43
3.7 Leakage Resilient Stateful Pseudo-Random Number Generators . . . . . . . . . .
3.7.1
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.7.2 Constructions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.8 Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Security Models
4 Robustness of Pseudo-random Number Generators with Inputs
4.1 Model Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.2 Recovering and Preserving Security . . . . . . . . . . . . . . . . . . . . . . . . . .
4.3 A Secure Construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.4
Impossibility Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.5
Instantiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.6 Benchmarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.6.1 Benchmarks on the Accumulation Process . . . . . . . . . . . . . . . . . .
4.6.2 Benchmarks on the Generation Process
. . . . . . . . . . . . . . . . . . .
5 Robustness Against Memory Attacks
5.1 Model Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.2 Limitation of the Initial Security Property . . . . . . . . . . . . . . . . . . . . . .
5.3 Preserving and Recovering Security Against Memory Attacks . . . . . . . . . . .
5.4 A Secure Construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.5
Instantiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44
44
45
47
51
51
57
63
67
71
73
73
74
77
77
79
80
86
88
6 Robustness Against Side-Channel Attacks
91
91
6.1 Model Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
93
6.2 Analysis and Limitation of the Original Construction . . . . . . . . . . . . . . . .
94
6.3 Recovering and Preserving Security With Leakage
. . . . . . . . . . . . . . . . .
99
6.4 A Secure Construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.5
Instantiations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
6.6 Benchmarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
7 Security Analysis
113
7.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113
7.2 Security of Linux Generators
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
7.3 Analysis of OpenSSL Generator . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
7.4 Analysis of Android SHA1PRNG . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
7.5 Analysis of OpenJDK SHA1PRNG . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
7.6 Analysis of Bouncycastle SHA1PRNG . . . . . . . . . . . . . . . . . . . . . . . . . . 131
7.7 Analysis of IBM SHA1PRNG . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133
8 Conclusion and Perspectives
Bibliography
135
142
— vi —
Chapter 1
Introduction
1.1 Pseudo-Random Number Generators
Standard Pseudo-Random Number Generators
In cryptography, randomness plays an important role in multiple applications. It is required in
fundamental tasks such as key generation, masking and hiding values, nonces and initialization
vectors generation. The security of these cryptographic algorithms and protocols relies on a
source of unbiased and uniform distributed random bits and cryptography practitioners usually