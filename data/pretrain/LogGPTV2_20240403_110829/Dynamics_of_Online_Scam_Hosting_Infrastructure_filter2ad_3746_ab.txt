Watch−A
Watch−B
Pharmacy−B
106
104
seconds
(a) A records
Fig. 3. Cumulative distributions of the average time between changes of A, NS, and IP of NS
records for Pharmacy-A, Watch-A, Watch-B, and Pharmacy-B
small number of times, so the TTL value is less important than the rate at which the
mapping itself is changing (i.e., for new clients that attempt to resolve the domain).
We grouped the responses according to the authoritative server that provided them to
account for possible load balancing. We then performed pairwise comparisons across
each group of records. In the case of A and NS-record responses, we considered a
response to be a change if at least one new record appears or if the number of records
returned has otherwise changed since the last response; we did not consider reordering
the records as a change. In the case of IP addresses of NS records, we considered the
response to be a change if either NS names appear with different IPs or a new NS
name appears. We discovered the following two characteristics, both of which might
ultimately help automatically detect scams:
– Scam domains change on shorter time intervals than their TTL values. Figure 2
shows the cumulative distribution of average time between changes for each do-
main across all 21 scam campaigns; each point on the line represents the average
time between changes for a particular domain that we monitored. The distribution
shows that scam domains change hosting servers (A records) and name servers (IP
addresses of NS records) more frequently than popular Web servers do, and also
much more frequent than TTL values of the records.
– Domains in the same campaign exhibit similar rates of change. We also analyzed
the rate of change of DNS records after clustering the scam domains according
to campaign. Figure 3 shows these results for the top 4 campaigns (ranked by the
number of distinct IPs returned in A records for domains hosting the campaigns).
The results are striking: different scam campaigns rotate DNS record mappings at
distinct rates, and the rates at which DNS records for a particular campaign are
remapped are similar across all domains for a particular scam.
Rate of Accumulation. We measure the rate at which the network grows over time.
In practice, our measurement is limited by the rate at which a domain updates its DNS
records and what we present in this section is the rate at which a previously unseen
host becomes an active hosting server (A records of a domain) or a name server (IP
addresses of names returned by NS records).
Using a method similar to the one used by Holz et al. [4], we determined the rate of
growth by repeatedly resolving each domain and assigning an increasing sequential ID
to each previously unseen IP address. Holz et al. performed this analysis for A records
Dynamics of Online Scam Hosting Infrastructure
225
r
e
b
m
u
N
e
v
i
t
a
u
m
u
C
l
10000
8000
6000
4000
2000
0
Pharmacy−A
Watch−A
Pharmacy−B
Watch−B
Pharmacy−A Start of DNS queries
Pharmacy−B, Watch−B Start of DNS queries
Watch−A Start of DNS queries
Week 1 Week 2 Week 3 Week 4
Weeks
r
e
b
m
u
N
e
v
i
t
a
u
m
u
C
l
2500
2000
1500
1000
500
0
Pharmacy−A
Watch−A
Pharmacy−B
Watch−B
Pharmacy−A Start of DNS queries
Pharmacy−B, Watch−B Start of DNS queries
Watch−A Start of DNS queries
Week 1 Week 2 Week 3 Week 4
Weeks
(a) A records - Top 4
(b) IP of NS records - Top 4
Fig. 4. Cumulative number of distinct IPs for the A records and IP addresses of NS records for
the top 4 campaigns across the four weeks of data collection
Table 4. Location of change for the top ﬁve campaigns, sorted by the total number of distinct IPs
of A records
Campaign Domains
Location of change
Pharmacy-A 149
30
Watch-A
19
Watch-B
Pharmacy-B 52
6
Casino-A
384
Total
Alexa
500
A [NS IP]
-
-
4 1
- 18
5 13
- 1
18 52
37 5
-
NS A+[NS IP]
- 77
- 24
-
- 19
- 5
3 219
15 4
A+NS NS+[NS IP]
-
-
-
-
-
1
1
-
-
-
-
-
-
1
A+NS+[NS IP]
72
1
1
15
-
91
-
of domains without regard to campaign; we performed this analysis for A records and
IP addresses of NS records, both at the level of individual domains and at the level of
campaigns:
– Rates of accumulation differ across campaigns. Figures 4(a) and 4(b) show the
total number of distinct IPs for each scam domain (the y-value of the end of each
line) over the four weeks of data collection (all iterations, 300 seconds apart from
each other) and how fast each campaign accumulated new hosts (slope), for the IP
addresses of A records and NS records, respectively. A steeper slope indicates more
rapid accumulation of new IP addresses for that campaign.
– Some domains only begin accumulating IP addresses after some period of dor-
mancy. Some domains appear to exhaust available hosts for a while (days to weeks)
before accumulating new IP addresses. We examined two campaigns that exhibited
rapid accumulation of IP addresses after some dormancy. Interestingly, only one
domain from each campaign begins accumulating IP addresses. These two cam-
paigns shared exactly the same set of NS names. In addition to accumulation, we
also saw attrition: 10% of scam domains became unreachable in the while we were
monitoring them. These domains may have been blacklisted and removed by regis-
trars or the scammers.
Location of Change in DNS Hierarchy. We observed many scam domains with NS
records or IP addresses of NS records that change rapidly, often in conjunction with
other records: Campaigns change DNS record mappings at different levels of the DNS
hierarchy. Table 4 shows the type of change for the top ﬁve campaign. In contrast to
226
M. Konte, N. Feamster, and J. Jung
Spamvertizing IPs
Fluxing domains − IPs of A rec
Alexa − IPs of A rec
1
0.8
0.6
0.4
0.2
F
D
C
1
0.8
0.6
0.4
0.2
F
D
C
Spamvertizing IPs
Fluxing domains − IPs of NS rec
Alexa − IPs of NS rec
0
3
0 . 0 . 0 . 0
6
0 . 0 . 0 . 0
0 . 0 . 0 . 0
2
8
5
2
9
0 . 0 . 0 . 0
1
0 . 0 . 0 . 0
1
0 . 0 . 0 . 0
1
IPs binned by /24
(a) A records
0 . 0 . 0 . 0
2
4
1
0 . 0 . 0 . 0
0
3
0 . 0 . 0 . 0
6
0 . 0 . 0 . 0
9
0 . 0 . 0 . 0
1
0 . 0 . 0 . 0
1
IPs binned by /24
0 . 0 . 0 . 0
1
0 . 0 . 0 . 0
2
2
5
8
0 . 0 . 0 . 0
2
4
1
0 . 0 . 0 . 0
(b) IP of NS records
Fig. 5. Distribution of the IPs of A rec of authoritative servers spam senders
1
0.8
0.6
0.4
0.2
F
D
C
0
100
1
0.8
0.6
0.4
0.2
F
D
C
0
100
Alexa
Fluxing domains
102
Number of distinct /24s
(b) IP of NS records
104
Alexa
Fluxing domains
102
Number of distinct /24s
(a) A records
104
Fig. 6. Distribution of unique /24s that appeared for all records in a reply
previous studies [13, 5], we observed many different types of changes in addition to
single ﬂux (A records) and double ﬂux (A, and IP address of NS). Another notable point
is that each campaign tends to combine techniques: For Pharmacy-A, 52% of domains
are double ﬂux and 48% change all three types of records. This result indicates that a
single campaign can operate using multiple infrastructures.
4 Location
In this section, we examine the network and geographic locations of hosts that are host-
ing scam Web sites or serving as name servers; we also compare these locations to those
of both spamming hosts and legitimate Web sites hosts.
Topological Location. To examine whether scam sites use different portions of the IP
space than the top 500 domains, we studied the distribution of the IPs across the whole
IP range. Figure 5 shows that scam networks use a different portion of the IP space
than sites that host popular legitimate content. The IPs that host legitimate sites are
considerably more distributed. More than 30% of these sites are hosted in the 30/8-60/8
IP address range, which hosted almost none of the scam sites observed in our study:
– The predominant networks that host scam sites differ from those that host spammers
for the corresponding scam campaigns (Figure 5). Our technical report lists for the
top ten ASes by the number of IP addresses for A records (i.e., hosting sites), NS
records (i.e., nameservers), and spammers (as observed in the spam trap) [7]. Inter-
estingly, there is almost no overlap between the ASes hosting the scam sites and the
Dynamics of Online Scam Hosting Infrastructure
227
nameservers (mostly Asia) and the ASes hosting the spamming IP addresses (mostly
Latin America, Turkey, and US). The fact that signiﬁcant differences exist between
networks of scam infrastructure and those of spammers suggest that hosts in different
regions of the IP address space do in fact play different “roles” in spam campaigns.
– DNS lookups for scam domains often return much more widely distributed IP
addresses than lookups for legitimate Web sites. Our intuition was that fast-ﬂux
networks that hosted scam sites would be more distributed across the network than
legitimate Web hosting sites, particularly from the perspective of DNS queries from
a single client (even in the case of a distributed content distribution network, DNS
queries typically map a single client to a nearby Web cache). Figure 6 shows the
distribution of distinct /24s that appear at the answer section of the DNS replies) for
all records in the reply. Roughly 40% of all A records returned for scam domains
were distributed across at least 300 distinct /24s, and many were distributed across
thousands of /24s. An overly widespread distribution of query replies may indicate
that a domain is indeed suspicious (e.g., a fast-ﬂux network).
Geographic Location. Hosting servers and name servers are widely distributed. In
total, we observed IP addresses for A records in 283 ASes across 50 countries, IP ad-
dresses for NS records in 191 ASes across 40 countries, and IP addresses for spammers
across 2,976 IP addresses across 157 countries. Although many scam nodes appear to
be in Russia, Germany, and the US, the long list of ASes and countries shows that
scam networks are truly distributed; this geographical distribution may be necessary to
accommodate the diurnal pattern of compromised hosts’ uptime [3]. Interestingly, the
countries that are referred to by the most A records are not the same set of countries that
host authoritative nameservers for those domains (as indicated by IP addresses of NS
records). In particular, Slovakia, Israel, and Romania appear to host more nameservers
than sites, and China appears to host relatively more nameservers. This difference in
distribution deserves further study; one possible explanation is that nameserver infras-
tructure for fast-ﬂux networks must be more robust than the sites that host scams (which
might be relatively transient).
5 Summary
This paper studied dynamics and roles of fast-ﬂux networks in mounting scam cam-
paigns. We actively monitored the DNS records for URLs for scam campaigns received
at a large spam sinkhole over a one-month period to study dynamics features of fast-
ﬂux service networks as they are used to host online scam and contrast to the dynamics
used for load balancing for popular Web sites. Our ﬁndings suggest that monitoring
the infrastructure for unusual, invariant changes in DNS mappings may be helpful for
automating detection. We plan to explore this possibility in future work.
References
1. Alexa. Alexa the Web Information Company (2008), http://www.alexa.com/
2. Anderson, D.S., Fleizach, C., Savage, S., Voelker, G.M.: Spamscatter: Characterizing Inter-
net Scam Hosting Infrastructure. In: USENIX Security Symposium (August 2007)
228
M. Konte, N. Feamster, and J. Jung
3. Dagon, D., Zou, C., Lee, W.: Modeling Botnet Propagation Using Time Zones. In: The 13th
Annual Network and Distributed System Security Symposium (NDSS 2006), San Diego, CA
(February 2006)
4. Holz, T., Corecki, C., Rieck, K., Freiling, F.C.: Measuring and Detecting Fast-Flux Service
Networks. In: NDSS (February 2008)
5. ICANN Security and Stability Advisory Committee. SSAC Advisory on Fast Flux Hosting
and DNS (March 2008), http://www.icann.org/committees/security/sac025.pdf
6. Jung, J., Sit, E.: An Empirical Study of Spam Trafﬁc and the Use of DNS Black Lists. In:
Internet Measurement Conference, Taormina, Italy (October 2004)
7. Konte, M., Feamster, N., Jung, J.: Fast Flux Service Networks: Dynamics and Roles in
Online Scam Hosting Infrastructure. Technical Report GT-CS-08-07 (September 2008),
http://www.cc.gatech.edu/˜feamster/papers/fastflux-tr08.pdf
8. Passerini, E., Paleari, R., Martignoni, L., Bruschi, D.: FluXOR: detecting and monitoring
fast-ﬂux service networks. In: Zamboni, D. (ed.) DIMVA 2008. LNCS, vol. 5137, pp. 186–
206. Springer, Heidelberg (2008)
9. Pathak, A., Hu, Y.C., Mao, Z.M.: Peeking into Spammer Behavior from a Unique Vantage
Point. In: First USENIX Workshop on Large-Scale Exploits and Emergent Threats (LEET),
San Francisco, CA (April 2008)
10. Rajab, M., Zarfoss, J., Monrose, F., Terzis, A.: A Multifaceted Approach to Understanding
the Botnet Phenomenon. In: ACM SIGCOMM/USENIX Internet Measurement Conference,
Brazil (October 2006)
11. Ramachandran, A., Feamster, N.: Understanding the Network-Level Behavior of Spammers.
In: SIGCOMM (September 2006)
12. Spam Trackers, http://spamtrackers.eu/wiki/index.php?title=Main_Page
13. The Honeynet Project. Know Your Enemy: Fast-Flux Service Networks (July 2007),
http://www.honeynet.org/papers/ff/
14. Xie, Y., Yu, F., Achan, K., Gillum, E., Goldszmidt, M., Wobber, T.: How dynamic are IP
addresses? In: ACM SIGCOMM, Kyoto, Japan (August 2007)
15. Zdrnja, B., Brownlee, N., Wessels, D.: Passive monitoring of DNS anomalies. In: H¨ammerli,
B.M., Sommer, R. (eds.) DIMVA 2007. LNCS, vol. 4579, pp. 129–139. Springer, Heidelberg
(2007)