### 优化后的文本

#### FTP会话捕获与分析

**1. 捕获的数据包**

- **源IP:** 192.168.6.118
- **目标IP:** 192.168.6.112
- **协议:** FTP
- **请求:** USER anonymous
- **时间戳:** 29 9.802000

- **源IP:** 192.168.6.112
- **目标IP:** 192.168.6.110
- **协议:** FTP
- **响应:** 331 Please specify the password
- **时间戳:** 78 21.88e888

- **源IP:** 192.168.6.118
- **目标IP:** 192.168.6.112
- **协议:** FTP
- **请求:** PASS nozilLagexanple.com
- **时间戳:** 79 21.082088

- **源IP:** 192.168.6.112
- **目标IP:** 192.168.6.118
- **协议:** FTP
- **响应:** 230 Login successful.
- **时间戳:** 95 24.020098

- **源IP:** 192.168.6.118
- **目标IP:** 192.168.6.112
- **协议:** FTP
- **请求:** PORT 192,168,6,110,11,54
- **时间戳:** 95 24.820088

- **源IP:** 192.168.6.112
- **目标IP:** 192.168.6.118
- **协议:** FTP
- **响应:** 200 PORT command successful. Consider using PASV.
- **时间戳:** 97 24.88088

- **源IP:** 192.168.6.110
- **目标IP:** 192.168.6.112
- **协议:** FTP
- **响应:** 150 Here comes the directory listing.
- **请求:** LIST
- **时间戳:** 101 24.080088

- **源IP:** 192.168.6.112
- **目标IP:** 192.168.6.110
- **协议:** FTP
- **响应:** 226 Directory send OK.
- **时间戳:** 111 26.8eee88

- **源IP:** 192.168.6.118
- **目标IP:** 192.168.6.112
- **协议:** FTP
- **请求:** CWD pub
- **时间戳:** 112 26.080088

- **源IP:** 192.168.6.112
- **目标IP:** 192.168.6.118
- **协议:** FTP
- **响应:** 250 Directory successfully changed.
- **时间戳:** 118 28.880#88

- **源IP:** 192.168.6.118
- **目标IP:** 192.168.6.112
- **协议:** FTP
- **请求:** PORT 192,168,6,110,11,55
- **时间戳:** 11928.8800#8

- **源IP:** 192.168.6.112
- **目标IP:** 192.168.6.110
- **协议:** FTP
- **响应:** 200 PORT command successful. Consider using PASV.
- **时间戳:** 120 28.880688

- **源IP:** 192.168.6.110
- **目标IP:** 192.168.6.112
- **协议:** FTP
- **响应:** 150 Here comes the directory listing.
- **请求:** LIST
- **时间戳:** 124 28.880088

- **源IP:** 192.168.6.112
- **目标IP:** 192.168.6.110
- **协议:** FTP
- **响应:** 226 Directory send OK.
- **时间戳:** 128 28.080088

**2. Wireshark中的数据包分析**

- **图 6.18: 捕获的数据包**
  - 从该界面可以看到捕获的所有数据包。在Wireshark中，可以通过使用各种显示过滤器来过滤特定类型的数据包。
  - 如果想查看一个完整的会话，右键单击任何一行并选择“Follow TCP Stream”命令，如图6.19所示。

- **图 6.19: FTP会话**
  - 该界面显示了一个完整的FTP会话，包括登录FTP服务器的用户名、密码、端口及访问的目录等信息。

**3. 使用Xplico工具分析数据包**

- **安装Xplico工具**
  - 执行以下命令以安装Xplico：
    ```bash
    root@kali:~# apt-get install xplico
    ```
  - 启动Apache服务：
    ```bash
    root@kali:~# service apache2 start
    [OK] Start web server: apache2.
    ```
  - 启动Xplico服务：
    ```bash
    root@kali:~# service xplico start
    [..] Starting : Xplico
    Modifying priority to -1
    .Ok
    ```

- **使用Xplico解析pcap文件**
  - 在浏览器中输入`http://localhost:9876`，将打开Xplico登录界面（默认用户名和密码都是`xplico`）。
  - 登录后，创建一个新的案例和会话，并上传需要解析的pcap文件。
  - 通过左侧栏中的选项，可以查看不同类型的会话数据，如HTTP、MMS、Emails等。

- **图 6.20至图 6.29: Xplico界面截图**
  - 这些截图展示了Xplico的登录界面、案例列表、会话创建、会话详细信息以及上传和解析pcap文件的过程。

通过上述步骤，可以有效地捕获和分析FTP会话，并使用Xplico工具进一步解析和展示捕获的数据包。