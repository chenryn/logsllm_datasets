192.168.6.118 192.168.6.112
FTP
Te Request: USER anonymous
29 9.802000
192.168.6.112 192.168.6.110
FTP
88 Response: 331 Please specify the passvord,
78 21.88e888
192.168.6.118 192.168.6.112
FTP
B8 Request: PASS nozilLagexanple.com
79 21.082088
192.168.6-112 192.168.6.118
FTP
77 Response: 230 Login successful.
95 24.020098
192.168.6.118 192.168.6.112
FTP
8# Request: P0RT 192,168,6, 110,11,54
95 24.820088
192.168.6.112 192.168.6.118
FTP
185 Response: 200 PORT command successful. Consider usis
97 24.88088
192.168.6.110 192.168.6.112
192.168.6.112 192.168.6.118
FTp
93 Response: 150 Here comes the directory listing.
6# Request: LIST
101 24.080088
FTP
185 24.080088
192,168.6.112 192.168.6,110
FTP
T8 Response: 226 Directory send OK.
111 26.8eee88
192.168.6.118 192.168.6.112
FTP
63 Request: OxO pub
112 26.080088
192.168.6.112 192.168.6.118
FTP
91 Response: 250 Directory successfully changed.
118 28.880#88
192.168.6.118 192.168.6,112 FTP
8# Request: P0FT 192, 168, 6, 110, 11,55
11928.8800#8
192,168.6.112 192.168,6,110FTP
120 28.880688
192.168.6.110 192.168.6.112
1e5 Response: 2oo PoRT command successful, Consider uss
192.168.6.112 192.168.,6.118
FTP
93 Response: 150 Here comes the directory listing.
68 Request: LIST
124 28.880088
FTP
12828.080088
192.168.6.112 192.168,6.110
FTP
78 Response: 226 Directory send CK.
 File: /root/Desktop/logs/packetre. ; Packets: 131 Displayed: 17 (13.0%)
 Profile: Default
图 6.18
捕获的数据包
（4）从该界面可以看到捕获的所有数据包。在Wireshark中，还可以通过使用各种显
示过滤器过滤一类型的数据包。如果想查看
一个完整的会话，右键单击任何一行并选择
FollowTCPStream命令查看，如图6.19所示。
· 182 ·
---
## Page 195
第6章漏洞利用
Follow TCP Stream
-□x
Stream Content
220 (vsFTPd 2.2.2)
SER
PASSmozilla(exarple.com
PORT192,160,6,110,11,54
CWD pub
226
ectory successfutly changed,
200P
PORT192,168,6,110,11,55
PORT connand succesful. Consider using PASV.
Entire conversation (457 bytes)
查找(F)另存为(A)打印(P)○ ASCII ○ EBCDIC ○ Hex Dump  CArrays @ Raw
帮助(H)
Filter Out This Strear
关团（C）
图6.19FTP会话
（5）该界面显示了一个完整的FTP会话。如登录FTP服务器的用户名、密码、端口及
访问的目录等。
在Kali中，可以使用Xplico工具分析Wireshark捕获的文件。但是，该文件的格式必
须是.pcap。该工具默认在Kali中没有安装，需要先安装才可以使用。下面将介绍安装并使
用Xplico工具分析数据包。
安装Xplico工具。执行命令如下所示：
root@kali:~# apt-get install xplico
执行以上命令后，运行过程中没有报错的话，则Xplico工具就安装成功了。接下来还
需要将Xplico服务启动，才可以使用。由于Xplico基于Web界面，所以还需要启动Apache
2服务。
启动Apache服务。执行命令如下所示：
root@kali:~# service apache2 start
[OK]Start web server:apache2.
从输出的信息中，可以看到Apache2服务已启动。
注意：在某个系统中启动Apache2服务时，可能会出现[.]Startingwebserver
apache2apachc2: Could not reliably determine the scrver's fully qualified domain
name,using127.0.1.1for ServerName信息。这是因为Apache 2服务器的配置文件
中没有配置ServerName选项，该信息不会影响Web服务器的访问。
启动Xplico服务。执行命令如下所示：
root@kali:~# service xplico start
[..] Starting : XplicoModifying priority to -1
.Ok
从以上输出信息，可以看到Xplico服务已成功启动。现在就可以使用Xplico服务了。
【实例6-4】使用Xplico工具解析捕获的pcap文件。具体操作步骤如下所示。
· 183 •
---
## Page 196
第2篇信息的收集及利用
（1）在浏览器中输入http://localhost:9876，将打开如图6.20所示的界面。
Ele Edt Yyiew Higtery Bockmris Iels Heg
 Iαt
e
Please login
图6.20Xplico登录界面
（2）该界面用来登录Xplico服务。Xplico默认的用户名和密码都是xplico，输入用户
名和密码成功登录Xplico后，将显示如图6.21所示的界面。
5le [dt yoew Higtery Beoimaris Ioois Help
 Xplico .:Pols:.
◆loc
@
Mest Visited loffe
+ Security , Kaki Lnux , Kali Docs BExploit-DB I@,Arcrack-ng
Xpllico Interface
Ceses List
Name
图6.21案例列表
（3）从该界面可以看到没有任何内容。默认Xplico服务中，没有任何案例及会话。需
要创建案例及会话后，才可以解析pcap文件。首先创建案例，在该界面单击左侧栏中的
NewCase命令，将显示如图6.22所示的界面。
Kplice -:Pols:
-0x
Ee [dt yiew Hgtory Bookmaris Ioois He#
CXplicePols.
◆1oc
iew Case
DATA ACQUISITION
Upleading PCAP capture file/s
图6.22新建案例
· 184 *
---
## Page 197
第6章漏洞利用
（4）在该界面选择UploadingPCAPcapturefile/s，并指定案例名。本例中设置为Test，
然后单击Create按钮，将显示如图6.23所示的界面。
Xplico .:Pols:. - lceweasel
-口x
EleEdt yiewHigtory BookmarksIoolselp
C Xxlic...Pols...
+
Google
Most VisitedIlOffensive Security , Kali Linux  Kali Docs Exploit-DB Aircrack-ng
Xplico Interface
Forum
WIkI
Chango pas
The Case has been created
Logout
Cases List
Case
Name
Rinhance
Type
Aetions
Test
Fles
Delete
图6.23新建的案例
（5）在该界面的案例列表中显示了新建的案例。此时单击Test，查看案例中的会话，
如图6.24所示。
Xplico :Sots:. - lceweasel
-ox
Eile EdityiewHigtory BookmarksIooisHelp
 Xplico .:Sols.
+
B Most VisitedIilOffensive Security , Kali Linux , Kali DocsBExploit-Db Aircrack-ng
Xplico Interface
List of listening sessions of case: Test
Name
Start Time
End Time
Status
图6.24监听的会话
（6）从该界面可以看到没有任何会话信息，接下来创建会话。单击左侧栏中的New
Session命令，将显示如图6.25所示的界面。
 Xplice..:Sols..
+
@ localhost:9876/sols/add
[]v Googl
 Most VisitedIloffensive Security , Kali Linux , Kali Docs Exploit-DB  Aircrack·ng
Xplico Interface
New listening session
Session name
Windows XP target
Create
图6.25新建会话
· 185 ·
---
## Page 198
第2篇信息的收集及利用
（7）在该界面Sessionname对应的文本框中输入想创建的会话名，然后单击Create按
钮，将显示如图6.26所示的界面。
Xplico .:Sots:. - Iceweasel
EileEdit yiew History Bookmarks Lools Help
 Xplico ..:Sols.
+
 localhost 9876/s
Google
a↓
Most VisitedIlOffensive Security , Kali Linux , Kali Docs BExploit-DB  Aircrack-ng
Xplico Interface
Forum
WikiChenge pass
The Session has been created
Logout
List of listening sesslons of case: Test
Name
Start Time
End Time
Status
WindowsXParget
0000-00-00 00:00:00 0000-00-00 00:00:00
AIdW3
图6.26新建的会话
（8）从该界面可以看到新建了一个名为WindowsXPTarget的会话。此时进入该会话
中，就可以加载pcap文件解析分析了。单击会话名WindowsXPtarget，将显示如图6.27所
示的界面。
Xplico .:Sols: - lceweasel
-口X
Ele Edit yiew Higtory Bookmarks Iools Help
 Xplico ..:Sols:
+
Google
Most Visited
lOffensive Security  Kali Linux , Kali Docs Exploit-DB Aircrack-ng
Xplico Interface
slen Data
Pcap set
Case and Session
PCAP-over-IP TCP port:30002.
Cap. Start Time
name
Test -> WindowsXPtarget
0000-00-00 00:00:00
Add_eaw_ncan_file
Cap. End Time
00:00:000-00-00000
Browse.AA-8860KJM26FSW_20140717.5608.cap
Status
EMPTY
Upioad
'89 de2d 118 j0 1817
HTTP
HMS
Emuils
FTP-TFTP-HTTP
Web Mal
Post
Get
Contents0
Number 0
Sent
Reoeived O
Connectians0
Received0
Tetal
Video
Unreadedo/0
Uploadedy - (
Sent
图6.27上传 pcap 文件
（9）该界面是用来显示pcap文件详细信息的。目前还没有上传任何pcap文件，所以
单击Browse按钮选择要解析的捕获文件。然后单击Upload按钮，将显示如图6.28所示的
界面。
（10）从该界面可以看到pcap文件分为几个部分。关于pcap文件的每类型数据包，可
以对应的查看。该界面显示了10种类型，如HTTP、MMS、Emails、FTP-TFTP-HTTPfile
和WebMail等。在该界面单击左侧栏中的Web并选择Site命令，将显示如图6.29所示的
界面。
· 186 *
---
## Page 199
第6章
漏洞利用
Xplico :Sols:. - lceweasel
EleEdt yiew HistoryBooko
arks Iools Help
 Conn
+
→
@local
X
Most Visited
Bloffensive Security , Kali Linux
Kali Docs BExploit-DBAircrack-ng
Xplico Interface
OCase
on Data
Pcap set
Case and Session neme Test -> Windows7Target
Cap. Start Time
2014-07-03 14:11:43
Add neu poap fle.
PCAP-over-IP TCP port: 30002
Ses
Cep. End Time
status
2014-07-03 14:12:08
DECODING COMPLETED
Browse
No fle selected.
Hosts
Upload
Fiter
List of all pcep files.
HTTP
MIM
Emals
Web Mall
Connectiorts 0
Total
Unreaded 0/0
Sent
Downloadegs-0
Received 0
fideo
fideo
Uploaded 0 · 0
Sent
images
HTTP
IRCFaudk Exp/Msn
Dns --Arp -Ikmpv
RTFVOP
DNS res2
Vide9
HNTP
Users
Channels 0/0/0
ARP/ICMPe8/0
Audio
图6.28成功上传了捕获文件
Xplico ..:Webs.. - Iceweasel
Ele Edt yiew Higtory Bookmarks Iools Help
 Xplico .Webs.
+
Q
Bg Most Visited
BlOffensive Security , Kali Linux
 Kali Docs MlExloit-D6
Aircragk
-ng
WIki
Change password Licenses Logout
For a complete view of html page set your browser to use Proxy, and point it to
Web server.
Web URLs:
 Htm1