## Page 37
下一步设置。接下来会要求用户确认是否启用Kdump，如图2.31所示。
所示。
CentOS7的首次配置和本地登录等内容。
2.3.1
主要介绍Linux的常见登录方式，
Kdump 主要用来调试系统内核和相关软件，对用户和生产环境几乎没有任何帮助，启用
首次进入系统会要求用户确认许可信息，单击“许可信息”，接受CentOS的许可证进入
在前面的章节中，主要介绍了如何使用不同的方法安装CentOS7，本小节将简要介绍
（1)CentOS7安装完成后重启即可使用，首次进入时还需要做一些简单的配置，如图2.30
首次配置与本地登录
Kdump
Barctcommari
用
如本地登录或通过相关软件远程连接等。
门
图2.31设置Kdump
图2.30初始设置
自动（A
羊动
第2章跟我学CentOS的安装
2
---
## Page 38
CentOS7系统管理与运维实战
26
源（即输入法）、云账号等内容，这些内容可按实际情况设置，此处不做赘述。
2.33所示。
通过则可顺利登录Linux系统。
幕中间的用户名后在弹出的窗口中输入密码，然后单击“登录”按钮，如果用户名、密码校验
所示。
与否均无太大影响。设置完Kdump单击“前进”按钮，即可完成设置进入登录界面，如图2.32
从图中可以看到，系统会首先要求用户设置系统默认语言，接下来还会提示用户设置输入
（2）首次进入桌面环境，CentOS会弹出窗口要求用户进行一些使用习惯上的配置，如图
在登录界面的右上角可以做一些辅助设置，例如语言设置、声音和开关机等。此时单击屏
（3）如想切换到命令模式，可进入系统后在桌面单击右键选择“在终端中打开”，然后在
图2.33首次设置
pyecwi(PoccnickaaDenepatuns)
图2.32登录窗口
English(UnitedStates)
Engish United Kngdom)
Deutsch(Oeutschlanc
francais(France)
Espanol (Espana)
p(r)
日本语
欢迎
前进（N）
---
## Page 39
现如图2.34所示的界面。
VMnet8”并右击，在弹出的菜单中选择“状态”，然后在状态对话框中单击“详细信息”，出
面的左侧单击“更改适配器设置”，此时将进入“网络连接”界面。找到“VMwareNetworkAdapter
地址段。以Windows7为例，在开始菜单中单击“控制面板”，然后在控制面板中找到并单击
Host-Only模式（仅主机模式）或桥接模式，则可以直接在宿主机登录。
何远程登录。
系统通常没有图形界面，且 ssh 使用的加密方案比较安全。本小节以 ssh 登录为例简要介绍如
用VNC图形界面、ssh等方法。其中以使用ssh登录为多，其原因是运维工程师管理和维护的
2.3.2
其中输入“init 3”，即可完成运行级别的转变。Linux运行级别如表2.1所示。
3
0
参数
9
本例中将采用仅主机模式演示登录过程，首先我们需要先查看Host-Only模式使用的IP
（1）如果需要在虚拟机中使用远程登录，首先网络必须互通，如果虚拟机已使用了
远程登录是Linux系统中最常见的一种登录方式，多为运维工程师所用，远程登录可以使
如图2.34所示查看其IP地址，只有虚拟机Host-Only网卡的IP地址与此IP地址在同一
远程登录
重新启动
X11模式，
完全多用户模式，服务器一般运行在此级别
多用户
单用户模式
停机
说明
一般不用，在一些特殊情况下使用
一般发行版默认的运行级别，可以启动图形桌面系统
图2.34网络连接的详细信息
表2.1Linux运行级别
特定的DNS后辑
接详细信息）
hreter
关团
第2草跟我学CentOS的安装
---
## Page 40
2
新版本与老版本差异都较大)，不一定能百分之百成功。本节将简要介绍如何从CentOS6.5升
7，因为这样能够避免数据迁移的问题。由于CentOS7与之前的版本差异较大（事实上每一个
码即可远程登录到Linux系统中。
进行配置。
使用远程连接。如果使用以上命令没有查看到此IP 地址，就需要重启网络连接或对网络连接
网段方可进行远程登录。
CentOS7系统管理与运维实战
对于一些已安装CentOS旧版本的计算机来说，通常更希望能从旧版本直接升级到CentOS
在PuTTY中填入CentOS 7的IP地址，并选择“SSH"，单击“Open”，输入用户名和密
（3）由于CentOS7默认开启ssh，因此可直接通过PuTTY等工具连接，如图2.36所示。
可以看到网卡eno16777736的IP地址与Windows中的IP地址属于同一网段，因此可以
（2）在虚拟机中查看IP地址可以使用“ifconfig”命令，如图2.35所示。
从CentOS6.5升级到Centos7
errors0
11251
dropped0
oppe
oytes
图2.35查看IP地址
over
图2.36PuTTY
user@localhost：~/桌面
Default Settings
6342
Basic
icofionafaryourPT eon
eastored session
arrierOcollisions0
0001
Only oncleanext
MiB)
Load
---
## Page 41
preupgrade-assistant
使用。使用vim在目录/etc/yum.repos.d中建立一个名为upgrade.repo的文件，内容如下：
将CentOS6.5升级到7。但这个工具并没有得到非常严格的测试，因此生产环境中不建议使用
2.4.2
Bug 被发现、修复，且性能趋于稳定时再更新。
系统也尚未得到时间的考验，因此生产环境更新可稍作等待。待更新两三次，系统中大部分
常会采用较低版本的原因。
可用性。
前版本的数据、配置文件等产生冲突，导致不可用或部分功能丧失。
以下几点：
有宝贵数据的生产环境则不同。此处仅讨论生产环境中升级可能带来的影响，其主要可归结为
2.4.1-
级到CentOS 7。
本小节中介绍的升级工具。
从之前红帽子的更新习惯来看，新版本通常有非常巨大的改动，也必然存在较多Bug 且
（2）由于CentOS7属于较新的系统，其稳定性、性能尚不稳定，可能会危及业务系统的
·（1）系统升级后，系统中的软件也会同时升级。这些软件可能会因为兼容性等原因与之
完成上述设置后，请确保计算机能正常连接网络，然后执行以下命令安装更新工具：
gpgcheck=0
baseur1=http://dev.centos.org/centos/6/upg/x86_64/
name=upgrade
[root@localhost ]#cat/etc/yum.repos.d/upgrade.repo
（1）由于升级工具并没有包含在CentOS6.5的软件源中，因此需要添加新的软件源才能
与之前的版本不同，新版本的CentOS 提供了一个升级工具 preupg，用户可以使用此工具
（3）新系统使用时间尚短，可能会有许多没有被发现的Bug，这也是为何运维工程师通
在个人使用的计算机或虚拟机中升级CentOS即使失败，可能也未必会有多大损失，但拥
[root@localhost~]#preupg
（2）在正式开始升级之前，建议使用测试工具进行测试：
上面这条命令将安装包括测试工具在内的升级工具。
enable=1
[upgrade]
使用升级工具
升级风险
第2章跟我学CentOS的安装
---
## Page 42
[root@localhost]#rpm--import
CentOS7系统管理与运维实战
包。从以上执行结果可以看出共计下载了1468个软件包（视系统中安装的软件不同，需要的
于导入centos7的key
http://centos.exce11media.net/7.0.1406/os/x86_64/RPM-GPG-KEY-CentOs-7#此命令用
upgrade
-instrepo=http://mirror.centos.org/centos/7/os/x86_64
Preupg tool doesn't do the actual upgrade.
先使用rpm 导入Key，然后使用redhat-upgrade-tool-cli工具下载更新中需要使用的软件
Finished. Reboot to start upgrade.
getting boot images...
rpm transaction 100%
(1468/1468):zzip1ib-0.13.62-5.el7.x86_64.rpm
(1467/1468):zl1b-deve1-1.2.7-13.e17.x86_64.rpm
initramfs-redhat-upgrade-tool.img
vmlinuz-redhat-upgrade-tool
getting boot images.
rpm install 100%
.treeinfo
[root@localhost
（3）接下来就可以导入CentOS7的key并开始更新了：
需要注意的是，preupg工具仅作一些常规测试，其结果仅能做参考。
Service statuses
All users
Changed config files:03/11.finished (time 00:00s)
All installed packages:01/11
cesting
setting up repos...
that would reguire a full re-install of the system from
 to continue? y/n
~]#
redhat-upgrade-tool-cli
04/11
05/11
06/11
.finished (time 0o:01s)
.finished (time 0o:00s)
#此处需要输入y并按Enter键
Finished (time 00:00s)
.finished (time 00:01s)
--force
11.1KB
14.7MB
-network
32MB
149kB
installation media
81KB
00:00
01:38
10.28
00:00
00:00
---
## Page 43
并不会覆盖已安装的Windows系统。
Windows分区，安装后的Linux和Windows分别使用了硬盘中不同分区，安装的Linux系统
后，需要在硬盘上预留一定的空间安装Linux，安装过程中Linux的安装程序会检测已有的
2.5.1Linux分区会覆盖原有Windows系统吗
Linux系统并存，如何安装多个Linux发行版等。
动处理这些情况，以保证升级过程顺利完成。
10~20分钟。在升级过程中可能还会出现一些错误及部分软件升级失败的情况，通常系统会自
软件包也不同)，由于此步需要从国外服务器中下载软件包，因此可能需要花费大量时间。
如在已安装Window系统的计算机中安装Linux和Windows双系统引导，安装完Windows
本节主要介绍初学者在安装Linux过程中的一些常见问题，如Windows系统是否能够和
从图中可以看到，系统已经开始更新系统中的软件，视计算机配置不同这个过程将持续
（4）完成上述步骤之后，重新启动系统时系统就会自动更新至CentOS7，如图2.37所示。
小白安装过程中的问题
图2.37升级到CentOS7
  m 8  88
-1mfo-1.28128614-4.c17
it4164c23.e12
第2章跟我学CentOS的安装
---
## Page 44
2.5.2
CentOS7系统管理与运维实战
23
窗口，执行“fdisk/mbr”清除分区信息。
全部删除。也可以利用Windows的引导光盘进入纯DOS或WinPE模式，然后进入命令提示
2.5.3
分区创建完毕即可进行Linux的安装。
建其他挂载点，分区设置如图2.39所示，图中剩余的空间可以预留给其他要安装的操作系统，
击“创建自定义布局”，然后依次创建Linux所需的根分区和Swap分区，如有需要，可以创
空间，并且在每个Linux的安装过程中采用手动分区模式做好分区设置。如图 2.38所示，单
建完毕后采用2.2.2节介绍的安装方法安装Linux系统。
如果系统中只安装有Linux，可以采用分区管理工具（如PartitionMagic）把Linux的分区
．（1）采用虚拟机安装的方式可以安装多个Linux系统。可以创建多个虚拟机，虚拟机创
（2）在同一PC上安装多个Linux操作系统，首先要为安装的每个Linux系统预留硬盘
如何删除双系统中的Linux
如何安装多个Linux发行版
您要进行哪种
创自文有
快用所有密
快用制定间
高示 1 这个选项料相除所选设备中的所有数高。 确定总进行了备分。
和分区月只使用所遇
所选
设备中创建自定义布局。
硬盘驱动器
图2.38Linux分区选择方式
图2.39Linux分区参考值
设备
中的来分区空间，
人des
返回（B）
(比如
→下一步(N)
---
## Page 45
下几个方面排查。
2.5.4
步染02
步骤01
坐崇02
步迪01
[root@Centos]#telnet 192.168.19.101
1.#检查sshd服务是否启动
使用虚拟机安装完Linux系统后，如果采用 SecureCRT不能登录安装的Linux，可以从以
root
以上两步完成后虚拟机中安装的Linux即删除完毕。
如果是使用虚拟机安装的Linux，删除步骤如下：
如果计算机中Windows和Linux并存，可直接进入Windows系统操作，删除步骤如下：
（1）检查安装的Linux服务器sshd服务是否启动，如下所示：
#检查端口是否正常
主机连不上虚拟机安装的Linux系统
在桌面上右击【我的电脑】图标，在弹出的菜单中选择“管理”命令，进入计算机
启动VMware，单击安装的虚拟机。
所示。
单击【磁盘管理】菜单，如图2.40所示，如有Linux分区，选择分区后删除即可。
管理界面。
IabrHe
Settings,
1010:58？
owe
文件#作者的口助
图2.40
图2.41
trI+D
中淘包
磁盘碎片整理程序
用程序
Windows磁盘管理
使用VM菜单
00:00:00 /usr/sbin/ss
22
Message Log
OFFICE12
第2章跟我学CentOS的安装
3
---
## Page 46
CentOs7系统管理与运维实战
单，结果如图2.42所示。
不能连接，可检查虚拟机网络配置，单击桌面上的虚拟机图标，单击【VM】→【Setting】菜
Trying 192.168.19.101...
经过上面代码中的3步，确认服务器 sshd服务正常，服务器防火墙没有开启，如果还是
Protocol mismatch.
test
SSH-2.0-OpenSSH_5.3
（2）选择合适的虚拟机网络连接方式
[root@Centos~]#iptables-F
Connected to 192.168.19.101
虚拟机与宿主主机通信有3种方式，分别为：
Bridged模式：在桥接模式下，VMware虚拟出来的操作系统就类似局域网中的一独
清除防火墙
Host-only主机模式：在Host-only模式中，所有的虚拟系统可以相互通信，但虚拟系
所在的网络来访问互联网。此时Linux的IP地址和VMnet8虚拟网络处于同一网段。
NAT网络地址转换模式：使用NAT模式使虚拟系统借助NAT功能，通过宿主机器
进行通信。此时需要设置Linux和宿主主机同网段IP即可。
IP地址、子网掩码，并且和宿主机器处于同一网段，这样虚拟系统才能和宿主机器
立主机，可以访问网络内任何一台机器。如选择此种模式，需要手工为虚拟系统配置
HardwareOptons
Card