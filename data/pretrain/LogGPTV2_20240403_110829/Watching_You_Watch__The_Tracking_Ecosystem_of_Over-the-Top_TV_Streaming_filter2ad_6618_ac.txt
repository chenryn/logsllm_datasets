and ad impression verification.
5 FINDINGS
This section covers our findings from smart crawls. We present
an overview of the data we collected, followed by an analysis of
tracking on channels and effectiveness of tracking countermeasures.
Finally, we discuss some of the security properties and practices on
the two OTT platforms we studied.
7
5.1 Data and Crawl Overview
As summarized in Table 1, we used a few different metrics to quan-
tify the success of each crawl. First, we counted the number of
“completed” channels in a crawl. We define “completed” channels
as those that were successfully installed, interacted with, and then
uninstalled by our crawler. Some channels may fail during install
or launch for different reasons (e.g., network issues). Second, we
counted the number of channels for which our smart crawler was
able to reach video playback by using the remote control API in
a crawl. Some channels may not have resulted in video playback
because of complex interfaces (e.g., logging into an account, as ex-
plained in Section 3.3.2). Third, and finally, we counted the number
of unique domains contacted by all channels in the crawl. This
number indicates the range of endpoints the device contacted dur-
ing the crawl. Together, these metrics provide a basis for sanity
check of the different crawls—each with different parameters—on
the same channel list.
We note two important observations about the overall results
of our crawls (Table 1). First, on both Roku and the Amazon Fire
TV, the crawls with and without TLS interception have similar
success rates based on the metrics we define above. Thus, we can
conclude that our TLS interception does not break channels’ func-
tionality. Second, our video playback rates are similar to our initial
experiments and trials detailed in Section 3.2.2.
5.2 Tracker prevalence
We first present an overview of the trackers the Roku and Amazon
Fire TV channels contact using data from the Roku-Top1K-MITM
and FireTV-Top1K-MITM crawls. We refer to tracking domains,
which we described in Section 4, as “trackers” hereafter for the sake
of brevity.
5.2.1 Trackers that are present on most channels. Table 2 lists the
top 10 trackers in order of prevalence across all the channels in the
Roku-Top1K-MITM and FireTV-Top1K-MITM crawls. Across the
Roku channels, doubleclick.net—owned by Google—was by far
the most prevalent tracker, appearing on 975 of the 1,000 channels.
Across the Amazon Fire TV channels, Amazon’s own advertising
tracking domain, amazon-adsystem.com was most prevalent, ap-
pearing in 687 of the 1,000 channels.
Tracker Domain
doubleclick.net
google-analytics.com
scorecardresearch.com
spotxchange.com
googlesyndication.com
imrworldwide.com
tremorhub.com
innovid.com
2mdn.net
vimeo.com
Channel
Count
975
360
212
212
178
113
109
102
88
86
Tracker Domain
amazon-adsystem.com
crashlytics.com
doubleclick.net
google-analytics.com
facebook.com
d3a510xmpll7o6.cloudfront.net
app-measurement.com
googlesyndication.com
imasdk.googleapis.com
gstatic.com
Channel
Count
687
346
307
277
196
180
179
145
129
127
Channel Name
StarGazer
Rock Paper Scissors Free
Falling Down Free
Marble Blast Free
Ping Pong Free
Basketball Shots Free
Swing Hero Free Game
Pop Lock Free
Pulse Free
Soccer Shots Free
Special Interest
Rank Category
1012
437 Games
421 Games
738 Games
447 Games
211 Games
504 Games
489 Games
844 Games
509 Games
Tracker
Count
50
42
42
41
41
41
40
40
37
37
Table 2: Most prevalent trackers from the Roku-Top1K-
MITM (left) and the FireTV-Top1K-MITM (right) crawls.
Table 3: Top 10 channels from the Roku-Top1K-MITM based
on the number of trackers they contact.
Three Google domains associated with advertising and ana-
lytics (doubleclick.net, google-analytics.com, and google-
syndication.com) are present in the top ten trackers list of both
platforms. While facebook.com appeared in traffic from 196 Ama-
zon Fire TV channels, it was only present in one Roku channel.
This finding is in line with the results from tracking studies on
web [23, 42, 63] and mobile [59] platforms that indicate that Face-
book and Google advertising and tracking services are prevalent in
web and mobile ecosystems as well as the OTT platforms, allowing
them to create a more complete profile of users.
5.2.2 Channels that contact the most trackers. To further examine
the distribution of trackers beyond prevalence, we examined their
distribution across channel categories and channel ranks for both
the Roku and Amazon Fire TV channels. The faceted plots in Fig-
ure 5a and Figure 5b illustrate this distribution for the Roku and
Amazon Fire TV channels respectively. To complement the plots,
Table 3 and Table 4 order channels by the number of trackers they
contact. As expected, overall across the Roku and Amazon Fire TV
channels we observe that channels that played video (orange dots)
contain more trackers than those that failed to play video (blue
dots).
Examining the distribution of trackers across channel categories,
we notice several interesting patterns. For example, the “Games”
category of Roku channels contact the most trackers, with 9 of
the top 10 channels ordered by the number of trackers (Tables 3)
being all from this category. On further inspecting these game
channels, we discovered that these channels contained a similar
number of trackers (37–42) and were published by the same de-
veloper (StuffWeLike). Also, five of the ten Fire TV channels with
the most trackers are “News” channels (Table 4), where the top
three channels contact close to 60 tracker domains each. This result
implies that tracking behavior of channels differs depending on the
category of the channel and that the users of certain categories are
more susceptible to tracking.
5.3 Identifier and Information Leakage
Next, we investigate what pieces of information each domain that
the channels in our dataset contact collect about users. This infor-
mation reveals behaviors of existing trackers, as well as potentially
new and previously unknown trackers.
8
Channel Name
WNEP - Proud to Se...
ABC7 News San Fran...
WTTV CBS4 Indy
Midnight Pulp
Xtreme Vegas - Cla...
Xtreme Slots - FRE...
WVTM 13 -Birmingha...
IP Tools: Network ...
ABC11 Raleigh-Durh...
FreeCell Solitaire
Rank Category
739 News
503 News
1157 News
933 Movies & TV
341 Games
406 Games
1022 News
1029 Utilities
595 News
894 Games
Tracker
Count
64
61
58
32
30
28
25
22
20
19
Table 4: Top 10 channels from the FireTV-Top1K-MITM
based on the number of trackers they contact.
For this analysis, we compiled a list of possible identifiers and
information that trackers could possibly collect about users. We
based this list on pieces of device and user identifiers already avail-
able on the device interfaces (e.g., account information) and also
on our preliminary analysis of the PCAP files. Table 5 lists these
identifiers. We searched for these identifiers and pieces of informa-
tion in the HTTP traffic resulting from the Roku-Top1K-MITM and
FireTV-Top1K-MITM crawls.
Since these identifiers may be transmitted as encoded or hashed,
we searched for various encoding and hashing combinations using
the method described by Englehardt et al. [22]. This allowed us to
detect URL and Base64 encoded identifiers, as well as hashed IDs.
We performed the search on the path section of the URL, referrer
and cookie headers, and post body of the HTTP requests. The
detection results are shown in Table 6.
On Roku, we discovered that 4,452 of the 6,142 (nearly 73%) re-
quests containing one of the two unique IDs (AD ID, Serial Number)
are flagged as trackers. On Amazon 3,427 of the 8,433 (41%) unique
identifiers are sent in cleartext.
In order to further understand the implication of subscription
services, we manually crawled 30 channels on both Roku and Ama-
zon platforms (as mentioned in Section 3.3.2). We collected network
traffic of the OTT device and the website used to register and sign-
in to the service. We used our tool to observe cross-device tracking
and sharing of identifier with third-party trackers during these
steps. We found four channels, two on each platform, that share the
(a) Roku-Top1K-MITM
(b) FireTV-Top1K-MITM
Figure 5: Distribution of trackers in the Roku-Top1K-MITM and FireTV-Top1K-MITM across channel ranks and channel cat-
egories.
Identifier Name
Persistence
Source
Roku,Amazon
Roku,Amazon
Roku,Amazon
Roku,Amazon
Serial No.
AD ID
MAC Addr
Device Name
Software Version
FireTV Home Version
Android ID
Bluetooth MAC Addr
Device ID
Device Account Email Until reset by user
Device Account Pwd
Until reset by user
Until device is moved
Zip Code
Until device is moved
City
Until device is moved
State
WiFi SSID
Until reset by user
Table 5: The various device and user identifiers we checked
for leaks in our study.
Lifetime of the device
Until reset by user
Lifetime of the device
Until reset by user
Lifetime of S/W update Amazon
Lifetime of S/W update Amazon
Lifetime of the device
Amazon
Amazon
Lifetime of the device
Roku
Lifetime of the device
User
User
—
—
—
Network
email address of the profile used for account creation with third-
party trackers on the web. We also found one Amazon channel
sharing the zip code with a third-party on the web. Finally, for each
channel, the tracking domains that are contacted both on the web
(during registration or sign-in) and by the device, are potentially
able to track users across web and OTT. We measured the presence
of such domains in the 30 channels we manually crawled on each
platform. On Roku, 4 channels had overlapping tracking domains
on their device and web traffic, while on Amazon we found 7 such
channels.
5.3.1 Detecting New Tracking Domains. Our analysis of trackers so
far is based on existing adblocking lists. In this subsection, we use
domains’ behavior to detect previously unknown trackers. To this
end, we used a combination of automated processing and manual
false positive removal on the Roku-Top1K-MITM. We first built
a list of domains that received unique identifiers, namely AD ID
Leak
Count
2650
2331
996
64
33
61
Channel
Count
320
197
110
11
6
10
Identifier
AD ID
Channel name
Serial No
City
State
Zip
Channel
Count
394
52
105
40
221
28
26
21
223
12
Table 6: Overview of identifier and information leakage
detected in the Roku-Top1K-MITM (left) and the FireTV-
Top1K-MITM (right) crawls. We excluded leaks to platform
domains roku.com and amazon.com from this table.
Identifier
Android ID