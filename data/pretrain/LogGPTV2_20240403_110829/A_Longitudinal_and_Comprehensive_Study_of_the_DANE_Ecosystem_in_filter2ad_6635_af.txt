we ﬁnd that only Exim and Postﬁx support DANE.
Third, focusing on the DNS software, we ﬁnd that seven of
the tested DNS programs support DNSSEC. Thus, receiving
MTAs (i.e., SMTP servers) that wish to assure the authenticity
of their identities and guarantee the conﬁdentiality of email
transport, can easily deploy DANE by serving signed TLSA
records. However, we ﬁnd three DNS programs cannot fetch
TLSA records yet. Thus the receiving MTAs outsourcing their
DNS lookups to those resolvers cannot authenticate sending
MTAs even if they use the DANE-supporting MTA software.
13This is not open source, but commercial software running on Microsoft
Windows Server.
14However, we learned that some commercial SMTP programs look
up DNS records by themselves such as Cisco’s Async OS Email Security
Appliance [1]
626    29th USENIX Security Symposium
USENIX Association
6.3 Summary
References
In summary, DANE support in practice is poor among 29
popular email service providers: only ﬁve of them support
DANE for incoming emails and four of them support DANE
for outgoing emails. Among the four email service providers
supporting DANE for both incoming and outgoing emails,
one relies on external DNSSEC-aware resolvers, which might
be vulnerable to MITM attacks. On the bright side, DANE
support in the popular MTA and DNS programs is pervasive;
all MTAs support STARTTLS for incoming emails, and two
of them validate the presented certiﬁcates with their TLSA
records for outgoing emails. Also, seven DNS programs sup-
port both DNSSEC and TLSA records; as to the others not sup-
porting DNSSEC and DANE, the latest versions of djbdns
and posadis were released more than 15 years ago [12, 64],
and MaraDNS does not support DANE yet despite being up-
dated recently. Thus, we believe that the administrators of
those email service providers that do not support DANE yet
can easily support DANE by updating and conﬁguring MTA
and DNS software.
7 Conclusion
This paper presents a longitudinal and comprehensive study
of the DANE ecosystem in SMTP—encompassing 178M
second-level domains and 29 popular email service providers
to understand the security implications of how DANE is
(mis)managed. We found that (1) DANE deployment is scarce
but increasing, (2) more than one third of all the TLSA records
cannot be validated due to missing or incorrect DNSSEC
records, and (3) 14% of the certiﬁcates are inconsistent with
their TLSA records. On the SMTP client side, we measured
29 popular email service providers to understand how they
support DANE; we found only four of them support DANE
for both outgoing and incoming emails, and one email service
provider does so only for incoming emails. We also tested four
MTA and ten DNS software programs, and found that two of
the MTA and seven of the DNS programs support DANE cor-
rectly, which implies that the administrators willing to deploy
DANE would not ﬁnd any operational challenges.
Acknowledgments
We thank the anonymous reviewers and our shepherd, Paul
Pearce, for their helpful comments. This research was sup-
ported in part by NSF grants CNS-1850465 and CNS-
1901090, an Institute of Information & communications Tech-
nology Planning & Evaluation (IITP) grant funded by the
Korea government(MSIT) (No.2016-0-00160,Versatile Net-
work System Architecture for Multi-dimensional Diversity),
SURFnet Research on Networks and EU H2020 CONCOR-
DIA (#830927).
[1] AsyncOSEmailSecurityAppliance.
https://www.
cisco.com/c/ko_kr/products/security/email-
security-appliance/index.html.
[2] BIND9. https://www.isc.org/bind/.
[3] ExchangeServer.
https://docs.microsoft.
com/ko-kr/Exchange/exchange-server?view=
exchserver-2019.
[4] Exim. https://www.exim.org/.
[5] KnotDNS. https://www.knot-dns.cz/.
[6] MaraDNS. https://maradns.samiam.org/.
[7] MicrosoftDNS. https://docs.microsoft.com/ko-
kr/windows-server/networking/dns/dns-top.
[8] NSD. https://www.nlnetlabs.nl/projects/nsd/
about/.
[9] PowerDNS.
downloads.html.
https://www.powerdns.com/
[10] SimpleDNSPlus. https://simpledns.com/.
[11] YADIFA. https://www.yadifa.eu/.
[12] djbdns 1.05 Release.
https://github.com/abh/
djbdns/blob/master/CHANGES.
[13] STARTTLS en DANE.
https://www.
forumstandaardisatie.nl/standaard/starttls-
en-dane.
2016.
[14] D. E. 3rd. Transport Layer Security (TLS) Extensions:
Extension Deﬁnitions. RFC 6066, IETF, 2011.
[15] C. Arthur.
DigiNotar SSL certiﬁcate hack
The Guardian.
amounts to cyberwar, says expert.
http://www.theguardian.com/technology/2011/
sep/05/diginotar-certificate-hack-cyberwar.
[16] R. Arends, R. Austein, M. Larson, D. Massey, and S.
Rose. DNS Security Introduction and Requirements.
RFC 4033, IETF, 2005. http://www.ietf.org/rfc/
rfc4033.txt.
[17] R. Arends, R. Austein, M. Larson, D. Massey, and S.
Rose. Protocol Modiﬁcations for the DNS Security
Extensions. RFC 4035, IETF, 2005. http://www.ietf.
org/rfc/rfc4035.txt.
[18] R. Arends, R. Austein, M. Larson, D. Massey, and S.
Rose. Resource Records for the DNS Security Exten-
sions. RFC 4034, IETF, 2005. http://www.ietf.org/
rfc/rfc4034.txt.
USENIX Association
29th USENIX Security Symposium    627
2016.
Secure
TR-03108-1:
[19] BSI
port.
SharedDocs/Downloads/DE/BSI/Publikationen/
TechnischeRichtlinien/TR03108/TR03108-
1.pdf.
Trans-
https://www.bsi.bund.de/
E-Mail
[20] D. Crocker, T. Hansen, and M. Kucherawy. Do-
mainKeys Identiﬁed Mail (DKIM) Signatures. RFC
6376, IETF, 2011.
http://www.ietf.org/rfc/
rfc6376.txt.
[21] T. Chung, D. Choffnes, and A. Mislove. Tunneling for
Transparency: A Large-Scale Analysis of End-to-End
Violations in the Internet. IMC, 2016.
[22] T. Chung, R. van Rijswijk-Deij, B. Chandrasekaran,
D. Choffnes, D. Levin, B. M. Maggs, A. Mislove, and
C. Wilson. A Longitudinal, End-to-End View of the
DNSSEC Ecosystem. USENIX Security, 2017.
[23] T. Chung, R. van Rijswijk-Deij, D. Choffnes, A. Mis-
love, C. Wilson, D. Levin, and B. M. Maggs. Under-
standing the Role of Registrars in DNSSEC Deployment.
IMC, 2017.
[24] Certmgr - Mono Certiﬁcate Manager.
http:
//manpages.ubuntu.com/manpages/bionic/man1/
certmgr.1.html.
[25] Check a DANE TLS Service. https://www.huque.
com/bin/danecheck.
[26] Comcast supporting outbound DANE. https://www.
internetsociety.org/blog/2017/08/comcast-
supporting-outbound-dane/.
[27] V. Dukhovni and W. Hardaker. SMTP Security via
Opportunistic DNS-Based Authentication of Named En-
tities (DANE) Transport Layer Security (TLS). RFC
7672, IETF, 2015.
[28] V. Dukhovni and W. Hardaker. The DNS-Based Authen-
tication of Named Entities (DANE) Protocol: Updates
and Operational Guidance. RFC 7671, IETF, 2015.
[29] V. Dukhovni.
NEWSFLASH: DANE TLSA
https:
records published for web.de.
//mailarchive.ietf.org/arch/msg/dane/
KWMzQLebCeOSgDXhtFAat5NMD60.
2016.
[30] Z. Durumeric, D. Adrian, A. Mirian, J. Kasten, E.
Bursztein, N. Lidzborski, K. Thomas, V. Eranti, M. Bai-
ley, and J. A. Halderman. Neither Snow Nor Rain Nor
MITM ... An Empirical Analysis of Email Delivery Se-
curity. IMC, 2015.
[31] W. B. De Vries, R. van Rijswijk-Deij, P.-T. de Boer,
and A. Pras. Passive Observations of a Large DNS
Service: 2.5 Years in the Life of Google. Network Trafﬁc
Measurement and Analysis Conference (TMA), 2018.
[32] DANE SMTP Validator. https://dane.sys4.de/.
[33] DNSSEC Deployment Report. https://rick.eng.
br/dnssecstat/.
[34] DNSSECDeploymentStatistics.
dnssec-tools.org/.
https://stats.
[35] I. Foster, J. Larson, M. Masich, A. C. Snoeren, S. Savage,
and K. Levchenko. Security by Any Other Name: On the
Effectiveness of Provider Based Email Security. CCS,
2015.
[36] H. Hu and G. Wang. End-to-End Measurements of
Email Spooﬁng Attacks. USENIX Security, 2018.
[37] P. Hoffman. SMTP Service Extension for Secure SMTP
over Transport Layer Security. IETF RFC 3207, IEFT,
2002.
[38] P. Hoffman and J. Schlyter. The DNS-Based Authen-
tication of Named Entities (DANE) Transport Layer
Security (TLS) Protocol: TLSA. RFC 6698, IETF, 2012.
[39] S. Huque. Whither DANE? 2019. https://indico.
dns-oarc.net/event/31/contributions/707/
attachments/682/1125/whither-dane.pdf.
[40] HSTS Preload List. https://opensource.google.
com/projects/hstspreload.
[41] J. H. C. Jackson and A. Barth. HTTP Strict Transport
Security (HSTS). RFC 6797, IETF, 2012.
[42] D. Kaminsky.
It’s
the End of
Black Hat, 2008.
as We Know It.
//www.blackhat.com/presentations/bh-jp-
08/bh-jp-08-Kaminsky/BlackHat-Japan-08-
Kaminsky-DNS08-BlackOps.pdf.
the Cache
https:
[43] D. Kocieniewski. Adobe Announces Security Breach.
The New York Times, 2013. https://www.nytimes.
com/2013/10/04/technology/adobe-announces-
security-breach.html.
[44] M. Kucherawy and E. Zwicky.
Domain-based
Message Authentication, Reporting, and Conformance
(DMARC). RFC 7489, IETF, 2015. https://tools.
ietf.org/html/rfc7489.
[45] S. Kitterman. Sender Policy Framework (SPF) for Au-
thorizing Use of Domains in Email. RFC 7208, IETF,
2014. https://tools.ietf.org/html/rfc7208.
[46] W. Kumari, O. Gudmundsson, and G. Barwood. Au-
tomating DNSSEC Delegation Trust Maintenance. RFC
7344, IETF, 2014.
628    29th USENIX Security Symposium
USENIX Association
[47] A. Langley.
Why not DANE in browsers.
https://www.imperialviolet.org/2015/
2015.
01/17/notdane.html.
[48] B. Laurie, A. Langley, and E. Kasper. Certiﬁcate Trans-
parency. RFC 6962, IETF, 2013. http://www.ietf.
org/rfc/rfc6962.txt.
[49] T. Le, R. V. Rijswijk-Deij, L. Allodi, and N. Zannone.
Economic Incentives on DNSSEC Deployment: Time
to Move from Quantity to Quality. NOMS, 2018.
[50] W. Lian, E. Rescorla, H. Shacham, and Stefan. Mea-
suring the Practical Impact of DNSSEC Deployment.
USENIX Security, 2013.
[51] A.-M. E. Löwinder.
DNSSEC Deployment
in
Sweden: How Do We Do It?
ICANN50, 2014.
https://london50.icann.org/en/schedule/wed-
dnssec/presentation-dnssec-deployment-
sweden-25jun14-en.pdf.
[52] Let’s Encrypt. https://letsencrypt.org.
[53] D. Margolis, M. Risher, G. Inc., B. Ramakrishnan, O.
Inc., A. Brotman, C. Inc., J. Jones, and M. Inc. SMTP
MTA Strict Transport Security (MTA-STS). IETF, 2018.
[54] D. Moore. DNS server survey. http://mydns.bboy.
net/survey/.
[55] P. Mockapetris. Domain Names - Concepts and Facili-
ties. RFC 1034, IETF, 1987.
[56] M.Shore, R. Barnes, S. Huque, and W. Toorop. A DANE
Record and DNSSEC Authentication Chain Extension
for TLS draft-ietf-tls-dnssec-chain-extension-07. IETF,
2018.
[57] Massive growth in SMTP STARTTLS deployment.
https://www.facebook.com/notes/protect-
the-graph/massive-growth-in-smtp-starttls-
deployment/1491049534468526.
[58] Mozilla piles on China’s SSL cert overlord: We don’t
trust you either. http://bit.ly/1GBPwfG.
[59] New incentives for security standards DNSSEC and
https://www.sidn.nl/en/news-
DANE.
and-blogs/new-incentives-for-security-
standards-dnssec-and-dane.
2019.
[60] OpenINTEL. https://www.openintel.nl/.
[61] OpenSSL. https://www.openssl.org/.
[62] I. Petrov, D. Peskov, G. Coard, T. Chung, D. Choffnes,
D. Levin, B. M. Maggs, A. Mislove, and C. Wil-
son. Measuring the Rapid Growth of HSTS and
HPKP Deployments. University of Maryland, 2017.
http://www.cs.umd.edu/content/measuring-
rapid-growth-hsts-and-hpkp-deployments.
[63] Posadis. http://posadis.sourceforge.net/.
[64] Posadis
0.60.6 Release.
http://posadis.
sourceforge.net/release/041225.
[65] Postﬁx. http://www.postfix.org/.
[66] Z. Ramzan and C. Wuest. Email Spooﬁng Attack statis-
tics. CEAS, 2007.
[67] Registrar Scorecard yields great results.
2019.
https://www.sidn.nl/en/news-and-blogs/
registrar-scorecard-yields-great-results.
[68] Q. Scheitle, T. Chung, J. Hiller, O. Gasser, J. Naab, R.
van Rijswijk-Deij, O. Hohlfeld, R. Holz, D. Choffnes,
A. Mislove, and G. Carle. A First Look at Certiﬁcation
Authority Authorization (CAA). CCR, 48(2), 2018.
[69] R. Sean and M. van der Meer. The state of Start-
TLS. 2014. https://caldav.os3.nl/_media/2013-
2014/courses/ot/magiel_sean2.pdf.
[70] S. Son and V. Shmatikov. The hitchhiker’s guide to
DNS cache poisoning. Security and Privacy in Commu-
nication Networks, Springer, 2010.
[71] Sendmail. https://www.proofpoint.com/us/open-
source-email-solution.
[72] Support
for DNSSEC/DANE/TLSA validation.
https://bugzilla.mozilla.org/show_bug.cgi?
id=1479423.
[73] The Spamhaus Project.
org/.
https://www.spamhaus.
[74] The current state of SMTP STARTTLS deployment.
https://www.facebook.com/notes/protect-the-
graph/the-current-state-of-smtp-starttls-
deployment/1453015901605223/.
[75] Trustwave to escape ‘death penalty’ for SSL skeleton
key. 2012. http://bit.ly/1RbPlNe.
[76] Unbound.
https://nlnetlabs.nl/projects/
unbound/about/.
[77] Update on stats 2019-10.
2019.
https:
//mail.sys4.de/pipermail/dane-users/2019-
November/000534.html.
[78] A. Veenman.
SIDN extends DNSSEC discount
https://www.ispam.
until July 1, 2018.
nl/archives/38957/sidn-verlengt-dnssec-
kortingsregeling-tot-1-juli-2018/.
2014.
USENIX Association
29th USENIX Security Symposium    629
[79] N. L. M. van Adrichem, N. Blenn, A. R. Lúa, X. Wang,
M. Wasif, F. Fatturrahman, and F. A. Kuipers. A mea-
surement study of DNSSEC misconﬁgurations. Sec.
Info., 4(8), 2015.
[80] R. van Rijswijk-Deij, M. Jonker, A. Sperotto, and A.
Pras. A High-Performance, Scalable Infrastructure for
Large-Scale Active DNS Measurements. IEEE Journal
on Selected Areas in Communications, 34(6), 2016.
[81] R. van Rijswijk-Deij, A. Sperotto, and A. Pras.
DNSSEC and Its Potential for DDoS Attacks (A Com-
prehensive Measurement Study). IMC, 2014.
[82] P. Wouters and O. Gudmundsson. Managing DS
Records from the Parent via CDS/CDNSKEY. RFC
8078, IETF, 2017.
[83] L. Zhu, D. Wessels, A. Mankin, and J. Heidemann. Mea-
suring DANE TLSA Deployment. TMA, 2015.
[84] djbdns. http://cr.yp.to/djbdns.html.
A Terminology
In this section, we provide a glossary of terms and their deﬁ-
nitions.
Simple Mail Transfer Protocol (SMTP)
is a protocol for
internet electronic mail transmission. Mail servers (or Mail
Transfer Agent) use SMTP to send and receive emails.
MX record is a DNS record to specify which mail servers are
willing to act as a mail exchange for the associated domain.
Mail Transfer Agent (MTA)
is a software that transfers
email messages; it receives incoming emails from sources
and delivers outgoing emails to their destinations.
Domain Name System (DNS)
is a hierarchical and de-
centralized naming system for computers or other resources
connected to the Internet. It associates various resources (e.g.,
IP addresses) with domain names.
Top-Level Domains (TLDs)
are domains under the root
zone in DNS. A second-level domain name comes after the
dot such as .com and .se.
Country Code Top-Level Domain (ccTLD)
is one of the
categories of TLD, which is reserved for a country or territory
identiﬁed with a country code such as .se, .nl.
Generic Top-Level Domain (gTLD)
is one of the cate-
gories of TLD, which is not country-speciﬁc but paired with
different classes or organizations such as .com, .net.
630    29th USENIX Security Symposium
USENIX Association