Hacking	
  Embedded	
  Devices	
(Doing	
  Bad	
  Things	
  to	
  Good	
Hardware)	
About	
  your	
  hosts…	
•  Phorkus	
  has	
  been	
  breaking	
  things	
  since	
  he	
was	
  5	
  years	
  old.	
– SomeDmes	
  with	
  a	
  hammer,	
  someDmes	
  a	
  soldering	
iron.	
•  EvilRob	
  has	
  been	
  causing	
  mayhem	
  and	
devastaDng	
  electronics	
  since	
  before	
  he	
  met	
beer.	
– Beer	
  good.	
  Fire	
  bad.	
Before	
  We	
  Get	
  Started	
•  We’d	
  like	
  to	
  thank	
  some	
  of	
  the	
  people	
  who’s	
work	
  helped	
  us	
  make	
  this	
  possible	
–  Joe	
  Grand	
  (You	
  should	
  all	
  know	
  him	
  from	
  TV)	
–  Emerson	
  Tan	
  (The	
  wonders	
  of	
  methylene	
  chloride)	
–  Flylogic’s	
  silicon	
  device	
  aOacks	
  (
hOp://www.ﬂylogic.net/blog/)	
–  Everyone	
  who’s	
  ever	
  screwed	
  with	
  an	
  Arduino,	
  AVR,	
ARM,	
  MIPS,	
  etc.	
–  Finally	
  to	
  our	
  families	
  who	
  gave	
  us	
  support	
  as	
  we	
liOered	
  our	
  houses	
  with	
  archaic	
  electronics	
Why	
  We’re	
  Here.	
•  We’ll	
  present	
  a	
  series	
  of	
  steps	
  to	
  help	
  you	
evaluate	
  a	
  device	
  for	
  possible	
  security	
  holes.	
•  We’re	
  trying	
  to	
  get	
  a	
  series	
  of	
  repeatable	
  tasks	
that	
  will	
  allow	
  you	
  to	
  begin	
  the	
  hardware	
  and	
soUware	
  evaluaDon	
•  We’ll	
  be	
  standing	
  up	
  a	
  site	
  open	
  to	
  the	
community	
  to	
  be	
  used	
  to	
  share	
  informaDon	
on	
  devices	
  that	
  people	
  are	
  working	
  on	
cracking	
GeVng	
  Down	
  To	
  Business	
• 
You’ll	
  need	
  a	
  few	
  key	
  pieces	
  of	
  physical	
  equipment	
  and	
  soUware	
  tools	
• 
Most	
  of	
  these	
  items	
  are	
  not	
  expensive	
  and	
  can	
  be	
  acquired	
  for	
  $500-­‐
$1000	
• 
A	
  few	
  of	
  the	
  big	
  items	
  (we’ll	
  cover	
  these	
  in	
  detail)	
–  Your	
  Brain	
–  A	
  Voltmeter	
–  Surface	
  Mount	
  Soldering/Hot	
  Air	
  Rework	
  StaDon	
–  Soldering	
  Stuﬀs	
–  Magnifying	
  Glass	
–  Microscope	
–  Bus	
  Pirate	
–  Spare	
  Parts	
–  Debugging	
  Interfaces	
–  IDA	
  Pro	
Your	
  Brain	
•  Remember	
  SAFETY	
  SAFETY	
  SAFETY	
•  Electricity	
  can	
  kill	
  and	
  maim	
  and	
  kill	
•  Always	
  be	
  aware	
  of	
  your	
  surroundings	
  when	
soldering	
•  Wear	
  safety	
  glasses	
•  Don’t	
  die	
A	
  Voltmeter	
•  Absolutely	
  needed	
  to	
  do	
  circuit	
  probing	
•  Used	
  to	
  test	
  various	
  parts	
  for	
  electrical	
  resistance	
•  Needed	
  to	
  test	
  the	
  circuit	
  voltage	
  so	
  you	
  don’t	
  destroy	
your	
  Bus	
  Pirate	
•  Check	
  diode	
  conducDvity	
•  USB	
  Volt	
  Meters	
  are	
  great	
  for	
  recording	
  directly	
  to	
your	
  computer	
•  Volt	
  Meters	
  can	
  go	
  from	
  very	
  cheap	
  all	
  the	
  way	
  into	
the	
  high	
  hundreds	
  (Fluke)	
•  We’ll	
  be	
  using	
  a	
  $60	
  USB	
  model	
  from	
  SparkFun	
Electronics	
Surface	
  Mount	
  Soldering/Hot	
  Air	
Rework	
•  Can	
  be	
  bought	
  on	
  Amazon	
  for	
  ~$160	
  for	
  a	
decent	
  model	
•  Extremely	
  good	
  for	
  removing	
  surface	
  mount	
components	
  without	
  destroying	
  your	
  board	
Soldering	
  Elements	
•  We’ll	
  need	
  some	
  of	
  these	
  items	
  to	
  add	
and	
  remove	
  components	
  to	
  the	
  board	
•  Solder	
  wick	
  (used	
  to	
  remove	
  solder)	
•  Insulated	
  tweezers	
  or	
  micro-­‐forceps	
•  Solder	
•  Flux	
•  Chip	
  puller	
Magnifying	
  Glass	
•  Go	
  to	
  amazon,	
  they	
  can	
  be	
  found	
  cheaply	
there	
•  We’re	
  using	
  a	
  rather	
  expensive	
  one	
  (~$180),	
but	
  they	
  can	
  be	
  super	
  cheap	
  and	
  eﬀecDve	
•  The	
  higher	
  power,	
  the	
  beOer	
•  Make	
  sure	
  it’s	
  got	
  a	
  light	
•  Pro-­‐Dp:	
  Get	
  some	
  Rain-­‐x	
  or	
  anD-­‐fog	
  spray	
  so	
you	
  won’t	
  fog	
  up	
  your	
  glass	
  when	
  you	
  end	
  up	
breathing	
  on	
  it	
USB	
  Microscope	
•  Used	
  for	
  all	
  kinds	
  of	
  micro	
  examinaDon	
•  Some	
  things	
  we’ll	
  use	
  it	
  for	
– Examining	
  contacts	
  for	
  broken	
  solder	
– Chip	
  numbers	
  (very	
  important)	
– Board	
  traces	
– Anything	
  else	
  we	
  ﬁnd	
  on	
  our	
  desk	
  when	
  we	
  get	
board	
A	
  Bus	
  Pirate	
•  No,	
  not	
  that	
  kind	
  of	
  pirate	
•  Used	
  to	
  read	
  and	
  wire	
  to	
  almost	
  every	
  raw	
  “bus	
protocol”	
  (almost)	
•  Very	
  gentle	
  learning	
  curve	
•  Not	
  the	
  best	
  for	
  scripDng	
  for	
  things	
  we	
  like	
  to	
  do	
such	
  as	
  dumping	
  SPI	
  ﬂash	
  or	
  I2C	
  in	
  an	
  automated	
way.	
•  Very	
  acDve	
  community	
•  Go	
  get	
  one	
  (
hOps://www.sparkfun.com/products/9544)	
Spare	
  Parts	
•  eBay	
  is	
  great	
  for	
  spare	
  parts.	
  Search	
  for	
“sample	
  packs”	
  that	
  contain	
  resistors,	
capacitors,	
  inductors,	
  diodes,	
  LEDs,	
  etc.	
•  Spare	
  parts	
  are	
  needed	
  to	
  replace	
  blown	
  one.	
You	
  will	
  at	
  some	
  point	
  wreck	
  one	
  (or	
  more)	
  of	
these	
  on	
  a	
  board	
•  An	
  example	
  of	
  the	
  way	
  we’ll	
  use	
  these	
– Using	
  a	
  resistor	
  to	
  De	
  a	
  pin	
  to	
  ground	
  or	
  VCC	
  to	
change	
  signals	
  on	
  chips	
PARTS!	
Debugging	
  Interfaces	
•  If	
  the	
  device	
  you’re	
  tesDng	
  does	
  not	
  have	
  a	
JTAG	
  (Joint	
  Test	
  AcDon	
  Group)	
  interface,	
  we	
can	
  put	
  one	
  on	
•  A	
  good	
  debugging	
  set	
  will	
  contain	
– JTAGs	
– A	
  BDM	
  (Background	
  Debugger	
  Mode	
  Interface)	
– ISP	
  (In-­‐System	
  Programming)	
  Device	
•  We	
  will	
  use	
  all	
  these	
  in	
  various	
  ways	
  to	
  access	
the	
  device	
  soUware/ﬁrmware	
IDA	
  Pro	
•  Totally	
  worth	
  it,	
  single	
  best	
  way	
  to	
  disassemble	
and	
  analyze	
  soUware	
•  Turns	
  the	
  compiled	
  code	
  into	
  “C	
  like”	
  code	
  for	
analysis	
•  Downside,	
  bit	
  on	
  the	
  expensive	
  side	
•  Hex-­‐Rays	
  also	
  have	
  x86	
  32bit	
  and	
  ARM	
decompilers.	
•  IDA	
  (
hOps://www.hex-­‐rays.com/products/ida/
index.shtml)	
IDA	
  Easy	
  /	
  Hex	
  Editor	
  Hard	
Deﬁne	
  The	
  Device	
•  What	
  is	
  its	
  markeDng	
  name?	
•  Is	
  it	
  a	
  third	
  party	
  device	
  (i.e.	
  cable	
  modem)?	
•  Does	
  it	
  have	
  a	
  non-­‐obvious	
  name?	
•  Does	
  it	
  have	
  a	
  part	
  number	
  from	
  the	
manufacture?	
•  Does	
  it	
  have	
  an	
  FCC	
  ID?	
MarkeDng	
  Name	
•  The	
  OEM	
  Process	
  introduces	
  a	
  lot	
  of	
  hardware	
out	
  there	
  that’s	
  actually	
  commodity.	
– A	
  large	
  number	
  of	
  PC	
  based	
  “secure	
  appliances”	
are	
  rebranded	
  Intel	
  servers.	
•  EMC	
  devices	
•  Sun’s	
  V20	
  and	
  V40	
  lines	
•  RSA	
  Appliances	
Third-­‐Party	
  Devices	
•  Did	
  someone	
  give	
  it	
  to	
  you	
  or	
  your	