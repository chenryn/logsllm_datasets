title:Reconstructing with Less: Leakage Abuse Attacks in Two Dimensions
author:Evangelia Anna Markatou and
Francesca Falzon and
Roberto Tamassia and
William Schor
Reconstructing with Less:
Evangelia Anna Markatou∗
Leakage Abuse Attacks in Two Dimensions
Francesca Falzon∗
University of Chicago
PI:EMAIL
Brown University
William Schor
Brown University
PI:EMAIL
(a)
(b)
Figure 1: Our reconstruction of a spatial dataset with 1,000
points. (a) Order reconstruction from only the access pat-
tern. (b) Approximate geometric reconstruction given the
order of the points and partial search pattern of 1M queries
drawn from a uniform distribution. We achieve an almost
exact reconstruction while prior work [13] needed 455M
queries on average for exact reconstruction.
1 Introduction
The growing adoption of cloud computing and storage in the past
two decades has been accompanied by a corresponding increase
in data breaches. Encrypted cloud storage reduces the risk of such
breaches. In particular, searchable encryption provides a practical
solution for processing queries over encrypted data without the
need for decrypting the data or the queries.
For the sake of efficiency, searchable encryption schemes sacri-
fice full security by leaking some information about the queries and
their responses. As a consequence, the underlying data is vulnera-
ble to inference attacks from this leakage. To defend against such
attacks, a variety of mitigation techniques have been developed.
Works on encryption schemes and mitigation techniques include
[4, 9, 10, 12, 13, 17–20, 23, 25–29, 32–34, 36, 38]. Systems implement-
ing these types of schemes have been developed in both academia
(e.g., [37, 39]) and in industry (e.g., [35]). Regarding reconstruction
attacks, see, e.g., [4, 13, 18–20, 23, 25–29, 32, 34, 38].
The following standard types of leakage occur in searchable
encryption schemes. A scheme leaks the access pattern if the ad-
versary observes the encrypted records returned in response to
queries. A scheme leaks the search pattern if the adversary can
distinguish if a query has been previously issued, i.e., can assign a
unique query identifier to each distinct query.
This work considers an encrypted database with two attributes,
referred to as a two-dimensional (2D) database to which range
∗EAM and FF are co-first authors who contributed equally and are listed in reverse
alphabetical order.
PI:EMAIL
Roberto Tamassia
Brown University
PI:EMAIL
Abstract
Access and search pattern leakage from range queries are detri-
mental to the security of encrypted databases, as evidenced by a
large body of work on attacks that reconstruct one-dimensional
databases. Recently, the first attack from 2D range queries showed
that higher-dimensional databases are also in danger (Falzon et al.
CCS 2020). Their attack requires the access and search pattern of
all possible queries. We present an order reconstruction attack that
only depends on access pattern leakage, and empirically show that
the order allows the attacker to infer the geometry of the underlying
data. Notably, this attack also achieves full database reconstruc-
tion when the 1D horizontal and vertical projections of the points
are dense. We also give an approximate database reconstruction
attack that is distribution-agnostic and works with any sample of
queries, given the search pattern and access pattern leakage of those
queries, and the order of the database records. Finally, we show
how to improve the reconstruction given knowledge of auxiliary
information (e.g., the centroid of a related dataset). We support
our results with formal analysis and experiments on real-world
databases with queries drawn from various distributions.
CCS Concepts
• Security and privacy → Cryptanalysis and other attacks.
Keywords
Encrypted Database; Database Reconstruction; Attack
ACM Reference Format:
Evangelia Anna Markatou, Francesca Falzon, Roberto Tamassia, & William
Schor. 2021. Reconstructing with Less: Leakage Abuse Attacks in Two Di-
mensions. In Proceedings of the 2021 ACM SIGSAC Conf. on Computer and
Communications Security (CCS ’21), Nov. 15–19, 2021, Virtual Event, Republic
of Korea. ACM, NY, NY, USA, 19 pages. https://doi.org/10.1145/3460120.3484552
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea
© 2021 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 978-1-4503-8454-4/21/11...$15.00
https://doi.org/10.1145/3460120.3484552
Session 7C: Database and Privacy CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea2243queries are issued. We assume a passive persistent adversary who
observes the entire access pattern leakage, i.e., all possible responses
of queries, and a subset of the search pattern leakage. Our adversary
aims to reconstruct the order of the database records in the two
dimensions (attributes) using solely the access pattern, a problem
called order reconstruction (OR). The adversary then performs an
approximate reconstruction of the (attribute) values of the database
records by using the partial search pattern observed, a problem
called approximate database reconstruction (ADR). A more am-
bitious goal is full database reconstruction (FDR), which aims at
computing the exact record values, up to unavoidable symmetries
and other information theoretic limitations.
1.1 Contributions
Previous work on reconstruction attacks from range queries on 2D
databases [13] assumes that the adversary has knowledge of the
entire access and search pattern leakage (i.e., has seen all possible
queries and their responses) and uses both forms of leakage to
perform an attack that reconstructs the record values in polynomial
time, up to inherent information theoretic limitations. In contrast
to [13], we investigate what information is recoverable from 2D
range queries when given only a fraction of the possible responses.
We make progress in this direction with the following contributions:
(1) We show that order reconstruction faces additional information
theoretic limitations when given only access pattern leakage.
We describe and prove a complete characterization of the
family of databases that have the same access pattern leakage.
(2) We present an order reconstruction attack that allows an
adversary with the entire access pattern to build a linear-space
representation of the family of databases in poly-time.
(3) We design a distribution-agnostic approximate database
reconstruction attack that reconstructs record values given
the order of the records, and the search and access pattern
leakage from any number of queries drawn from an unknown
distribution.
(4) We empirically evaluate the effectiveness of our attacks on
real-world datasets using a variety of range query distributions.
(5) We develop new combinatorial and geometric concepts and
algorithms related to point reconstruction from range queries
that may be of independent interest.
Our work provides the first order reconstruction attack in
2D from access pattern leakage and the first approximate re-
construction attack in 2D from partial search pattern leakage
and an unknown query distribution. Our order reconstruction
attack does not require knowledge of the domain size and, instead,
gives us a lower bound of the domain size. This attack is also a full
database reconstruction attack for the case when the 1D horizontal
and vertical projections of the points are dense, i.e., have a record
for every domain value.
Our work improves over the full database reconstruction at-
tack of [13], where the adversary observes both access pattern and
search pattern from all possible queries on the database. This previ-
ous attack fails when even a single query is missing. In contrast,
we demonstrate that an adversary can still infer much about the
original data with significantly less information. In particular,we
achieve order reconstruction given only the access pattern (Fig-
ure 1a) and an effective approximate database reconstruction given
the search pattern from a small fraction of queries (Figure 1b).
Our approximate database reconstruction (ADR) attack can be
viewed as the 2D analogue of the work on attacks on 1D databases
reported in [27]. To apply previous approximation approaches that
assume knowledge of the order to 2D databases, we must com-
pletely characterize order reconstruction in 2D. However, much
like FDR does not trivially extend from the 1D to 2D setting, our
order reconstruction method demonstrates an exponential increase
in the number of indistinguishable point configurations in the 2D
setting. Thus, we cannot simply generalize 1D techniques to 2D. We
re-examine a number of support-size estimators to better suit our
problem. We emphasize that while our techniques are distribution
agnostic (i.e., they do not require knowledge of the query distri-
bution), certain distributions prevent the observation of a large
fraction of responses and records (i.e., a distribution where only a
few queries have nonzero probability) and thus place severe infor-
mation theoretic limits on the accuracy of any approximate recon-
struction method. In Section 6 we examine different non-parametric
estimators and their efficacy under different query distributions.
In Section 7 we build a complex nonlinear system of equations to
model the problem instead of the linear system of [27].
1.2 Encrypted Databases and 2D Range Queries
There are a number of schemes that support two-dimensional range
queries over encrypted data. All existing schemes leak access and
search pattern, and many leak strictly more information. Our work
is motivated by the need to understand what can be learned from
information leakage that seems unavoidable without employing
the use of oblivious RAMs (ORAMs) [16] or fully homomorphic
encryption [15], both of which incur significant overhead.
Shi et al. [41] designed a scheme called Multidimensional Range
Query over Encrypted Data (MRQED) that leverages public key
encryption. Although their model is different, their scheme leaks
strictly more than access and search pattern. MRQED achieves
“match-revealing” security which reveals the attributes of the range
query when the query is successfully decrypted. The scheme builds
a binary tree on the values of each dimension, and releases public
keys corresponding to the nodes that “cover” the range of interest.
The server learns both search and access of the query, the plaintexts
of the matching records, and structural information about range
query issued. Maple is a tree-based public-key multi-dimensional
range searchable encryption scheme [48]. Its goal is to provide
single-dimensional privacy which mitigates one-dimensional data-
base reconstruction attacks. In addition to leaking access and search
pattern, they also leak the nodes accessed when traversing the
range tree and the values of each queried range. Recently, Kamara
et al. gave constructions for schemes that support conjunctive SQL
queries with a reduced leakage profile [6, 24, 49].
One may also consider an index-based construction described
in [13] that is built on top of a multi-keyword searchable symmetric
encryption (SSE) scheme, like Cash et al. [5]. To mitigate 1D attacks
and avoid leaking information about individual columns, one can
precompute a joint index of all possible 2D queries and encrypt the
resulting index. When a 2D query is issued, only records matching
Session 7C: Database and Privacy CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea2244Table 1: Comparison of our attack with related ones that
assume access pattern leakage.
Queries
1D
2D
range range
Attack
Leakage
Assumptions
Query
Data- Search OR FDR ADR
distrib.
base pattern
Uniform
Any
Unknown
Dense
Any
Uniform
Unknown
Any
Unknown
Any
Unknown
Any
✓ Unknown