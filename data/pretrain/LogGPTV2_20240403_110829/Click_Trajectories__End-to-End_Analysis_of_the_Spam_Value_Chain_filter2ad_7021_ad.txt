10Almost 50% of these failed orders were from ZedCash, where we
suspect that our large order volume raised fraud concerns. In general, any
such biases in the order completion rate do not impact upon our analysis,
since our goal in purchasing is simply to establish the binding between
individual programs and realization infrastructure; we obtained data from
multiple transactions for each major program under study.
and one sent a follow-up email stating that our money had
been refunded (this refund, however, had not been processed
three months after the fact).
Operational protocol: We placed our purchases via VPN
connections to IP addresses located in the geographic vicin-
ity to the mailing addresses used. This constraint is necessary
to avoid failing common fraud checks that evaluate con-
sistency between IP-based geolocation, mailing address and
the Address Veriﬁcation Service (AVS) information provided
through the payment card association. During each purchase,
we logged the full contents of any checkout pages as well as
their domain names and IP addresses (frequently different
from the sites themselves). We provided contact email
addresses hosted on domain names purchased expressly for
this project, as several merchants did not allow popular
Web-based email accounts during the purchase process. We
recorded all email sent to these accounts, as well as the
domain names and IP addresses of any customer service
sites provided. We also periodically logged into such sites
to record the current status of our purchases. For physical
goods, we always selected the quickest form of delivery,
while software was provided via the Internet (here too
we recorded the full information about the sites used for
software fulﬁllment).
All of our purchases were conducted using prepaid Visa
payment cards contracted through a specialty issuer. As
part of our relationship with the issuer, we maintained the
ability to create new cards on demand and to obtain the
authorization and settlement records for each transaction.
We used a unique card for each transaction.
We had goods shipped to a combination of individual
residences and a suite address provided by a local com-
mercial mailbox provider. We regularly picked up, tagged,
and photographed shipments and then stored them in a cen-
tralized secure facility on our premises. We stored software
purchases on a secure hard drive, checked for viruses using
Microsoft Security Essentials and Kaspersky Free Trial,
and compared against other copies of the same software
(including a reference version that we owned).
Legal and ethical concerns: This purchasing portion
of our study involved the most careful consideration of
legal and ethical concerns, particularly because this level of
active involvement has not been common in the academic
community to date. We worked with both our own project
legal advisors and with general counsel to design a protocol
for purchasing, handling, analyzing and disposing of these
products within a legal framework that minimizes any risk
of harm to others. While the full accounting of the legal
considerations are outside the scope of this paper, most
of our effort revolved around item selection and controls.
For example, we restricted our pharmaceutical purchasing
to non-prescription goods such as herbal and over-the-
counter products, and we restricted our software purchases
to items for which we already possessed a site license (also
communicating our intent with the publisher). We did not
use any received products (physical or electronic) and, aside
from a few demonstration lots, they are scheduled to be
destroyed upon the completion of our analyses.
Finally, while these controls are designed to prevent any
explicit harm from resulting through the study, a remaining
issue concerns the ethics of any implicit harm caused by
supporting merchants (through our purchasing) who are
themselves potentially criminal or unethical. Since our study
does not deal with human subjects our institutional re-
view board did not deem it appropriate for their review.
Thus, our decision to move forward is based on our own
subjective evaluation (along with the implicit oversight we
received from university counsel and administration). In this,
we believe that, since any such implicit support of these
merchants is small (no individual afﬁliate program received
more than $277 dollars from us), the potential value from
better understanding their ecosystem vastly outweighs the
potential harm.11
IV. ANALYSIS
A major goal of our work is to identify any “bottlenecks”
in the spam value chain: opportunities for disrupting mone-
tization at a stage where the fewest alternatives are available
to spammers (and ideally for which switching cost is high
as well). Thus, in this section we focus directly on analyzing
the degree to which afﬁliate programs share infrastructure,
considering both the click support (i.e., domain registration,
name service and Web hosting service) and realization (i.e.,
payment and fulﬁllment) phases of the spam value chain.
We explore each of these in turn and then return to consider
the potential effectiveness of interventions at each stage.
A. Click Support
As described in Section III we crawl a broad range
of domains—covering the domains found in over 98% of
our spam feed URLs—and use clustering and tagging to
associate the resulting Web sites with particular afﬁliate
programs. This data, in combination with our DNS crawler
and domain WHOIS data, allows us to associate each such
domain with an afﬁliate program and its various click
support resources (registrar, set of name server IP addresses
and set of Web hosting IP addresses). However, before we
proceed with our analysis, we ﬁrst highlight the subtleties
that result from the use of Web site redirection.
Redirection: As we mentioned, some Web sites will
redirect the visitor from the initial domain found in a spam
message to one or more additional sites, ultimately resolving
the ﬁnal Web page (we call the domain for this page the
“ﬁnal domain”). Thus, for such cases one could choose to
measure the infrastructure around the “initial domains” or
the “ﬁnal domains”.
11This is similar to the analysis made in our previous study of the
CAPTCHA-solving ecosystem [37].
439
●
●
256
●
●
●
●
●
●
●
●
●
●
s
e
S
A
#
/
s
r
a
r
t
s
g
e
R
#
i
64
16
4
1
●
●
●
●
●
●
●
●
●
●
●
● ●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
● ●● ●●●●●
●
●
●
●●
●
●
Entity
●●● Web server
●●● DNS server
●●● Registrar
100
80
60
40
20
0
s
m
a
r
g
o
r
p
e
t
a
i
l
i
f
f
A
%
Entity
Web server
DNS server
Registrar
80
100
0
2
4
6
8 10 12 14 16 18 20 22 24 26 28 30 32 34 36
# Affiliate programs
0
20
40
60
% Registrars / % ASes
Figure 3: Sharing of network infrastructure among afﬁliate pro-
grams. Only a small number of registrars host domains for many
afﬁliate programs, and similarly only a small number of ASes host
name and Web servers for many programs. (Note y-axis is log
scale.)
Figure 4: Distribution of infrastructure among afﬁliate programs.
Only a small percentage of programs distribute their registered
domain, name server, and Web server infrastructure among many
registrars and ASes, respectively.
To explain further, 32% of crawled URLs in our data
redirected at least once and of such URLs, roughly 6% did so
through public URL shorteners (e.g., bit.ly), 9% through
well-known “free hosting” services (e.g., angelfire.com),
and 40% were to a URL ending in .html (typically in-
dicating a redirect page installed on a compromised Web
server).12 Of the remainder, the other common pattern is
the use of low-quality “throw away” domains,
the idea
being to advertise a new set of domains, typically registered
using random letters or combinations of words, whenever
the previous set’s trafﬁc-drawing potential is reduced due to
blacklisting [24].
Given this, we choose to focus entirely on the ﬁnal
domains precisely because these represent the more valuable
infrastructure most clearly operated by an afﬁliate.
Returning to our key question, we next examine the set
of resources used by sites for each afﬁliate program. In
particular, we consider this data in terms of the service
organization who is responsible for the resource and how
many afﬁliate programs make use of their service.
Network infrastructure sharing: A spam-advertised site
typically has a domain name that must be resolved to access
the site.13 This name must in turn be allocated via a registrar,
who has the authority to shutdown or even take back a
domain in the event of abuse [30]. In addition, to resolve
and access each site, spammers must also provision servers
to provide DNS and Web services. These servers receive
network access from individual ISPs who have the authority
to disconnect clients who violate terms of service policies
or in response to complaints.
12In our data, we identiﬁed over 130 shortener services in use, over 160
free hosting services and over 8,000 likely-compromised Web servers.
13Fewer than half a percent use raw IP addresses in our study.
Figure 3 shows that network infrastructure sharing among
afﬁliate programs—when it occurs—is concentrated in
a small number of registrars and Autonomous Systems
(ASes).14 Many registrars and ASes host infrastructure for
just one or two afﬁliate programs, only a small number
host infrastructure for many afﬁliate programs, and no single
registrar or AS hosts infrastructure for a substantial fraction
of the programs overall. (As we will see in Section IV-C
however,
this situation can change drastically when we
weight by the volume of spam advertising each domain.)
Speciﬁcally, Figure 3 shows the number of registrars (y-
axis) that serve registered domains for a given number of
afﬁliate programs (x-axis). Over 80 registrars, for instance,
serve domains for a single afﬁliate program, while just two
registrars (NauNet and China Springboard) serve domains
for over 20 programs. For name servers and Web servers,
it shows the number of ASes hosting servers for a given
number of afﬁliate programs. Over 350 and 450 ASes host
DNS and Web servers, respectively, for a single afﬁliate
program; yet, just two and nine ASes host DNS and Web
servers, respectively, for over 20 programs (including Ha-
naro Telecom, China Communication, and ChinaNet).
that programs do not
Although most registrars and ASes host infrastructure for
just one afﬁliate program, each program could still engage
many such registrars to serve their domains and many such
ASes to host their DNS and Web servers. Figure 4 shows,
though,
in general distribute their
infrastructure across a large set of registrars or ASes: for
most programs, each of them uses only a small fraction
of registrars and ASes found in our data set. Speciﬁcally,
Figure 4 shows the cumulative distribution of the fraction
of registrars and ASes in our data set used by afﬁliate
14We use the AS number as a proxy for ISP.
440
Bank Name
Azerigazbank
B&N
B&S Card Service
Borgun Hf
Canadian Imperial Bank of Commerce
Cartu Bank
DnB Nord (Pirma)
Latvia Savings
Latvijas Pasta Banka
St. Kitts & Nevis Anguilla National Bank
State Bank of Mauritius
Visa Iceland
Wells Fargo
Wirecard AG
Russia
Country
BIN
404610 Azerbaijan
425175
490763 Germany
423262
Iceland
452551
Canada
478765 Georgia
492175
490849
489431
427852
474140 Mauritius
450744
449215 USA
424500 Germany
Iceland
Afﬁliate Programs
GlvMd, RxPrm, PhEx, Stmul, RxPnr, WldPh
ASR
MaxGm
Trust
WldPh
DrgRev
Eva, OLPh, USHC
EuSft, OEM, WchSh, Royal, SftSl
SftSl
Latvia
Latvia
Latvia
St. Kitts & Nevis DmdRp, VgREX, Dstn, Luxry, SwsRp, OneRp
DrgRev
Staln
Green
ClFr
Table V: Merchant banks authorizing or settling transactions for spam-advertised purchases, their Visa-assigned Bank Identiﬁcation Number
(BIN), their location, and the abbreviation used in Table IV for afﬁliate program and/or store brand.
programs. For 50% of the afﬁliate programs, their domains,
name servers, and Web servers are distributed over just 8%
or fewer of the registrars and ASes, respectively; and 80%
of the afﬁliate programs have their infrastructure distributed
over 20% or fewer of the registrars and ASes. Only a handful