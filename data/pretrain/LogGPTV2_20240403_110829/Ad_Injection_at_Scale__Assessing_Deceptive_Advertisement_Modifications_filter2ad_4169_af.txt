n
e
c
r
e
P
100%
75%
50%
25%
0%
101
103
Number of installs
105
107
active install base
organic installs
Figure 10: CDF of maximum active install base and organic installs
for all ad injection extensions. Only 1.8% of ad injection extensions
ever acquire organic installs.
Ad Injection Library
superﬁsh.com
api.jollywallet.com
visadd.com
intext.nav-links.com
{crdrdpjs, rvzrjs, ...}.info
ads.tfxiq.com
clkmon.com
datafastguru.info
Extension
Afﬁliates
149
127
1
18
149
17
0
16
Extension
Coverage
88%
30%
0%
65%
36%
13%
0%
3%
Binary
Afﬂiates
21
3
0
6
17
1
1
0
Binary
Coverage
64%
11%
0%
19%
0%
7%
5%
0%
Table VI: Unique afﬁliates we detect in dynamic traces of extensions
and binaries, along with the volume of client DOMs that contain
the same afﬁliate IDs. We obtain more comprehensive coverage of
afﬁliates in client trafﬁc than via our synthetic execution environment.
E. Estimating Coverage of Ad Injection Software
While we cast a wide net for ad injection software, we
bias our understanding of the ecosystem to the input sources
used by WebEval, Hulk, and Safe Browsing. We estimate our
overall coverage by comparing the afﬁliate parameters that
appear in extensions and binaries against those appearing in
client DOMs analyzed in Section IV. We show our results in
Table VI. Our coverage of different injectors varies heavily
per afﬁliate program. Of superﬁsh.com afﬁliates, we identify
149 IDs in our dynamic extension traces which correlate with
the same IDs in 88% of client DOMs. The same analysis
for binaries yields 21 afﬁliates accounting for 64% of client
DOMs. The limited afﬁliates found for visadd.com and clk-
mon.com may result from insufﬁcient browser interaction to
elicit network traces with afﬁliate IDs. Our results indicate that
we have a substantial sample of ad injection software, though
we do not have complete coverage of all afﬁliate distribution
techniques in the wild. Between extensions and binaries, our
extensions dataset provides the best coverage of afﬁliates and
ad injection programs.
VI. IDENTIFYING ADVERTISERS AND INTERMEDIARIES
Money enters the ad injection ecosystem through a tangled
web of advertisers and intermediaries. We explore ads injected
162162
Impacted
Property
amazon.com
google.com
walmart.com
Tampered
Trigger Pages
90
96
71
Click
Chains
62,237
37,718
15,044
Ad Injection
Libraries
Extension
Coverage
27
13
25
86%
80%
91%
Table VII: Breakdown of the revenue chains we collect from ads
injected into Amazon, Google, and Walmart and the distinct queries
ads were sourced from.
on Google, Amazon, and Walmart and identify over 3,000
websites that unwittingly purchase trafﬁc from injectors. As
we show, advertisers rarely have insight into the provenance
of trafﬁc; they only observe parameters tied to the last hop
(e.g., HTTP redirect with a referrer) of the full clickchain.
Accordingly, we illuminate the full chain of ad relationships
that underpin the injection ecosystem and in the process
highlight the intermediaries who can have the greatest impact
on blocking deceptively sourced trafﬁc.
A. Ads Injected on Amazon, Google, & Walmart
We aggregate a total of 114,999 revenue chains from ads
injected by a sample of 398 extensions into Google, Amazon,
and Walmart. These extensions provide overlapping coverage
of all of the top injection libraries. A detailed breakdown of
our dataset appears in Table VII. Of the 300 trigger pages
we visit, 86% successfully induce an injected ad. We observe
an average of 5 iframe ads, 110 divs, 0.4 ﬂash ads, and 15
ad URLs per page. We randomly click one of these elements
and collect the resulting revenue chains to enable studying the
ad ecosystem. These revenue chains consist of every hand-off
that occurs between Amazon, Google, or Walmart until the
advertiser’s landing page.
We provide a sample of a real revenue chain in Figure 11.
When we visit google.com and query for Android, the injec-
tion library for Superﬁsh triggers () and fetches a list of
advertisements to embed (). We randomly click the BestBuy
offer for $39.99, kicking off a redirect chain through multiple
intermediaries (). We ﬁnally arrive at the advertiser, BestBuy
(). Worth noting, ad injectors cheekily view this as yet
another opportunity for proﬁt. In our example, the injection
libraries in turn laden bestbuy.com with a multitude of rogue
advertisements despite just having been paid by BestBuy to
deliver trafﬁc. We rely on this example as a reference for
terminology used throughout the remainder of this section.
Table VIII shows a breakdown of the top 10 injected ad
domains that start ad revenue chains. These parties are the
primary source of the deceptively sourced trafﬁc that pollutes
the ad ecosystem. As we discussed in Section V, a single
extension will generally maximize its proﬁt by contacting two
to four injection libraries. Our current infrastructure cannot
determine the exact injection library responsible for inserting
a speciﬁc ad. As such, we refer to injected ads by the
domain of the ﬁrst hop in the revenue chain, rather than
the name of the injection library previously used throughout
the paper. In some cases such as superﬁsh.com these are
the same. Conversely, dealply.com represents the amalgam
of all the {crdrpjs,
...}.info injectors. Noticeably absent is
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:21 UTC from IEEE Xplore.  Restrictions apply. 
Figure 11: Real example of a clickchain produced from an ad injected on Google that ends at BestBuy (which is then laden with injected
ads).
Injected
Ad Domain
superﬁsh.com
dealply.com
datafastguru.info
display-trk.com
tfxiq.com
pangora.com
xingcloud.com
shoppingate.info
linkfeed.org
bestyoutubedownloader.com
Other
Click
Samples
63,891
20,209
3,899
3,353
3,091
1,814
1,116
994
822
688
15,122
Avg
Hops
3.6
9.2
4.9
12.7
1.8
2.9
1.0
4.9
6.3
1.0
7.48
Advertising
Domains
891
526
407
196
58
204
4
232
267
1
1,497
Extension
Coverage
60%
29%
25%
27%
12%
5%
<1%
2%
12%
3%
100%
Table VIII: Top 10 injected ad domains we observe as the ﬁrst hop
in click revenue chains and the number of associated advertisers
receiving trafﬁc.
jolleywallet.com; this is because the program relies on afﬁliate
referrals that do not exist on our trigger websites.
The top 10 injected ad domains contribute 87% of revenue
chains followed by a long tail of over 15,112 distinct ad
domains. We ﬁnd superﬁsh.com is the most popular source
of trafﬁc in our revenue chains, in part because 60% of the
extensions we execute belong to its afﬁliate program. It is
followed in popularity by dealply.com and datafastguru.com,
which are contacted by 29% and 25% of extensions in our
synthetic environment. We caution that our dataset is biased
towards these top injected ad domains due their popularity
among the extensions we dynamically execute. As such, we
examine each injector on an individual basis rather than in
aggregate.
takes only 3.9 hops (e.g.,
Two striking results emerge from our results. First, hundreds
of advertisers (i.e., landing pages) receive trafﬁc from injection
libraries, even for our limited set of 300 product search queries.
We cannot illuminate what volume of ad trafﬁc this repre-
sents in the wild. Secondly, the owners of injection libraries
are closely connected to the ad ecosystem and advertisers.
It
intermediaries) before trafﬁc
sourced by superﬁsh.com reaches advertisers and 4.9 hops
for datafastguru.com. Only display-trk.com is far removed at
12.7 hops away, indicating injected trafﬁc requires a more
complicated path before it reaches advertisers. We also observe
landing pages receiving search trafﬁc (xingcloud.com) and
installs (bestyoutubedownloader.com) directly from injectors,
indicating some immediate relationship exists as well.
B. Advertisers and Intermediates For Top Injectors
Given the sheer diversity of revenue paths available to injec-
tion libraries, we narrow our analysis towards the advertisers
and intermediaries impacted by the top 3 injected ad domains
in our revenue chains (and popular in user trafﬁc). These
contribute 77% of all injected ads from 81% of extensions.
Trafﬁc Entry Points into the Ad Ecosystem: Ad injection trafﬁc
enters the ad ecosystem through a small number of paths,
detailed in Table IX. The intermediaries involved in sourcing
ad injection trafﬁc are remarkably similar irrespective of the
injector involved. We ﬁnd that superﬁsh.com funnels all of
its trafﬁc through three shopping programs: DealTime, Price-
Grabber, and BizRate (also known as ShopZilla). BizRate is
also used by dealply.com (67%) and datafastguru.com (43%).
Each of these e-commerce sites aggregate online product
advertisements. Combined, they represent the single largest
bottleneck in our dataset and are involved in 58% of all revenue
chains from all ad injectors in our synthetic environment.
These shopping programs source creatives from multi-
ple other intermediaries. The most popular is channelintel-
ligence.com—a Google owned property that allows brands to
market products to other e-commerce aggregators—followed
by pronto.com. We note that when ad trafﬁc is provided to
Google from DealTime or other programs, no provenance
information is shared. This prevents Google (and as we discuss
shortly, many intermediaries) from identifying trafﬁc that
originates from injectors with rudimentary ﬁlters alone.
Another notable intermediary in sourcing injected ads,
though not sharing any immediate relationships with ad in-
jectors, is adnxs.com. This network is run by AppNexus and
is involved in 15% of revenue chains. Similarly, we see 5%
of all revenue chains go through DoubleClick, a Google ad
exchange. We ﬁnd that 11% of the trafﬁc going through
DoubleClick originates via AppNexus, the single largest con-
tributor. These relationships highlight the tangled relationships
that underpin injection monetization. Once deceptively sourced
trafﬁc enters the ad ecosystem,
it becomes intractable to
distinguish from legitimate trafﬁc.
Advertisers Negatively Impacted by Ad Injector Trafﬁc: We
ﬁnd a handful of advertisers that are the primary landing
page for trafﬁc from ad injectors, a breakdown of which we
provide in Table X. We assert no culpability on behalf of these
163163
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:21 UTC from IEEE Xplore.  Restrictions apply. 
Injected
Intermediary
dealply.com
Ad Domain
superﬁsh.com dealtime.com
% of
Ads
40%
pricegrabber.com
34%
channelintelligence.com 27%
23%
bizrate.com
searchmarketing.com
11%
18%
Other
67%
bizrate.com
superﬁsh.com
43%
channelintelligence.com 21%
19%
amung.com
17%
clk-analytics.com
78%
Other
43%
datafast.com bizrate.com
28%
frontdb.com
pronto.com
21%
channelintelligence.com 19%
16%
adnxs.com
Other
67%
Hop After
Injector
26%
22%
0%
23%
0%
30%
57%
0%
0%
4%
0%
39%
41%
0%
15%
0%
0%
44%
Hop Before
Advertiser
0%
9%
27%
1%
9%
54%
2%
9%
18%
1%
0%
70%
1%
10%
0%
17%
6%
66%
Table IX: Top 5 intermediaries involved in sourcing injected trafﬁc,
broken down per injected ad domain.
Injected
Ad Domain
superﬁsh.com
dealply.com
datafast.com
Advertiser
sears.com
walmart.com
kobobooks.com
target.com
wayfair.com
Other
target.com
wayfair.com
walmart.com
overstock.com
sears.com
Other
ebay.com
target.com
bizrate.com
wayfair.com
sears.com
Other
% of
Ads
18%
11%
6%
4%
2%
59%
12%
5%
5%
4%
3%
71%