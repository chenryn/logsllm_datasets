Figure 54: Result Dashboard
The initial view displays the Hosts page, which lists all scanned hosts and provides a visual
representation of the vulnerability data. This allows us to identify important findings in one glance
and gives us an overview of the security status of each system. On the bottom right, Nessus
displays a visual representation of the distribution of all targets’ vulnerability information. Above it,
we can find general information about the vulnerability scan.
Nessus plugins are frequently updated. Therefore, the findings and information
presented in this Learning Unit may differ slightly from the results of your
vulnerability scans.
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 180
Made in Morocco
Penetration Testing with Kali Linux
To get the list of findings from a specific host, we can click on a list entry. This shows us the list
of vulnerabilities from the selected host. Let’s click on the entry for 192.168.50.124.
y
k
s
Figure 55: Vulnerability Result Dashboard of 192.168.50.124
The Severity column gives us a quick indicator if this is a critical finding or not. Figure 55 also
o
shows us that there are three findings with the MIXED severity. Nessus uses this severity when it
groups findings. The Count column shows us how many findings the corresponding group
contains. We can click on a grouped findingn to display a list of all findings in this group. Let’s click
on Apache Httpd (Multiple Issues), which is listed as Web Servers under the Family column.
i
z
D
Figure 56: List of Grouped Findings
Figure 56 shows us information on the findings, which were previously grouped. We can get more
information by clicking on a finding. Let’s click on Apache 2.4.49 < 2.4.51 Path Traversal
Vulnerability.
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 181
Made in Morocco
Penetration Testing with Kali Linux
y
Figure 57: Detailed Information of a Finding
Each finding contains a huge amount of information about the vulnerability itself, as well as the
k
plugin that detected it. Furthermore, we get a lot of information about the associated risk, status
of exploits, and other references.
s
Next, let’s navigate back to the results dashboard shown in Figure 54 to explore our scan further.
o
Analyzing the findings of a single target provides us with a lot of detailed information. However,
we often want to get an overview of the most important vulnerabilities of all targets. To achieve
this, Nessus provides a handy feature to gnet a prioritized overview of vulnerabilities named VPR
Top Threats, which utilizes the Vulnerability Priority Rating (VPR).318 The findings in the VPR list
consist of the top ten vulnerabilities of the scan.
i
z
D
Figure 58: VPR List of Vulnerabilities
In our example, the list only contains six vulnerabilities as Nessus didn’t find more with our
configuration.
318 (Tenable, 2020),https://www.tenable.com/blog/what-is-vpr-and-how-is-it-different-from-cvss
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 182
Made in Morocco
Penetration Testing with Kali Linux
Depending on the version of Nessus, the tab VPR Top Threats may be missing
while following along. However, each vulnerability finding still contains the
Vulnerability Priority Rating.
The next page we’ll examine is Remediations. If Nessus detects a vulnerability, the plugins often
contain a remediation strategy, or information on how to mitigate the vulnerability. In the case of
the Apache vulnerabilities from Figure 55, we get the following information.
y
k
s
Figure 59: Remediation of Vulnerabilities
o
The last report page is History. This page lists all vulnerability scans with this configuration. We
can use it to review or compare results of previous scans.
n
We now have an understanding of how to view the results of a Nessus scan. Next, let’s create a
PDF report of our vulnerability scan. We can do this by using the functions in the Report
i
dashboard. Apart from the creation of a report, the functions also cover the change of the scan
z
configuration, launch of another scan, or exporting data. We can also configure an Audit Trail,319
which allows us to analyze why a specific plugin behaved in a certain way. It can be used to
D
reduce the number of false negatives.
Let’s create a PDF report for our first vulnerability scan by clicking Report.
Figure 60: Create a Report
Once we click on the button, a new window allows us to use different report templates. Each
template generates the report with a different structure, focus, and content.
319 (Tenable Community, 2020), https://community.tenable.com/s/article/Analyzing-the-Audit-Trail
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 183
Made in Morocco
Penetration Testing with Kali Linux
For this example, we’ll use the Detailed Vulnerabilities By Host template, which presents detailed
findings grouped by each host. We’ll then select PDF as format and click Generate Report.
y
k
s
Figure 61: Select the Report Format and Template
After this, we can download or open the PDF report.
o
We could also use the Complete List of Vulnerabilities by Host template to create a summary of
the vulnerabilities instead of including detainled information.
i
For more information on how to customize the reports, consult the scan exports
z
and reports section on the Tenable Documentation page.320
D
In the last two sections we performed a vulnerability scan, reviewed the results, and generated a
PDF report with detailed information for all hosts. We can get more familiar with Nessus by
customizing the scan configurations and analyzing how the scanning behavior and results differ.
7.2.5 Performing an Authenticated Vulnerability Scan
In this section we will perform an authenticated vulnerability scan by providing credentials to
Nessus. As we discussed previously, authenticated scans produce more detailed information and
reduce the number of false positives. To demonstrate this, we will use an authenticated
vulnerability scan against the target DESKTOP.
We need to consider that an authenticated scan not only creates a lot of traffic
on the network, but also a huge amount of noise on the system itself, such as log
entries and AV notifications.
320 (Tenable Docs, 2022), https://docs.tenable.com/nessus/Content/ScanReportFormats.htm
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 184
Made in Morocco
Penetration Testing with Kali Linux
To begin, we’ll click New Scan on the Nessus dashboard.
Figure 62: Creating a new Scan
Even though all Nessus templates accept user credentials, we’ll use the Credentialed Patch Audit
scan template, which comes preconfigured to execute local security checks against the target.
The difference between this and the Basic Network Scan template with provided credentials, is
that the Credentialed Patch Audit scan only uses local security checks and will not do a regular
vulnerability check from an external perspective. The Credentialed Pyatch Audit template will not
only scan for missing operating system patches, but also for outdated applications, which may be
vulnerable to privilege escalation attacks.321 k
s
o
n
i
z
D
Figure 63: Select Credentialed Patch Audit
Once again, we will provide a name for the scan and set the target to DESKTOP.
321 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Privilege_escalation
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 185
Made in Morocco
Penetration Testing with Kali Linux
y
k
Figure 64: Basic Settings for the Austhenticated Scan
Next, let’s click on the Credentials tab and select SSH322 in the Host category. On the
o
Authentication method dropdown, we’ll select password, and enter “offsec” as the username and
“lab” for the password. We’ll select sudo for the Elevate privileges with option and enter “root” as
the sudo user and “lab” as the password.
n
i
z
D
Figure 65: SSH and Sudo Credentials for the Authenticated Scan
While we will use the SSH configuration for this example, there are several other authentication
mechanisms available. To get a list of all available mechanisms, we can click the Categories
322 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Secure_Shell
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 186
Made in Morocco
Penetration Testing with Kali Linux
dropdown menu and select All. We can consult the Tenable Documentation323 for a complete list
of supported authentication mechanisms.
For Linux and macOS targets, SSH is used. While we can also use SSH on Windows, in most
cases, we will use Server Message Block (SMB)324 and Windows Management Instrumentation
(WMI)325 to perform authenticated vulnerability scans against Windows targets. Both methods
allow us to use local or domain accounts and different authentication options.
To get meaningful results in an authenticated vulnerability scan, we need to ensure that our target
system is configured correctly. Depending on the authentication method we want to use, we need
to make sure that there is no firewall blocking connections from our scanner. Furthermore, we
often find antivirus (AV) programs installed on both Linux and Windows targets. AV may flag the
vulnerability scan as malicious and therefore, terminate our connection or render the results
useless. Depending on the AV program, we can add an exception326 for the authenticated scan or
temporarily disable it. y
Another Windows security technology we need to consider is User Account Control (UAC).327 UAC
k
is a security feature for Windows that allows users to use standard privileges instead of
administrator privileges. An administrative user will run most applications and commands in
standard privileges and receive administrator privilegess only when needed. Due to the nature of
UAC, it can also interfere with our scan. We can configure UAC to allow Nessus or temporarily
disable it.328 We should consult the Tenable Docoumentation,329 especially for Windows targets,
before we start our first authenticated scan.
Our scan target is a Linux system without AnV. Therefore, we can click the arrow next to Save and
launch the scan. After the scan has finished, we can review the results. In the Vulnerabilities page,
we get a list of the findings for the authenticated scan. In the last section, we had already grouped
i
findings with the MIXED severity. For our authenticated scan, let’s disable the grouping of findings
z
by clicking on the wheel and selecting Disable Groups.
D
Figure 66: Disable Grouped Results
After we disable groups, each finding is listed separately.
323 (Tenable Documentation, 2022), https://docs.tenable.com/nessus/Content/Credentials.htm
324 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Server_Message_Block
325 (Wikipedia, 2021), https://en.wikipedia.org/wiki/Windows_Management_Instrumentation
326 (Tenable Community, 2021), https://community.tenable.com/s/article/Symantec-Endpoint-Protection-interfering-with-Nessus-
authenticated-scans
327 (Microsoft Docs, 2021), https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-
account-control-overview
328 (Tenable Docs, 2022), https://docs.tenable.com/nessus/Content/EnableWindowsLoginsForLocalAndRemoteAudits.htm
329 (Tenable Docs, 2022), https://docs.tenable.com/nessus/Content/CredentialedChecksOnWindows.htm
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 187
Made in Morocco
Penetration Testing with Kali Linux
y
Figure 67: Authenticated Scan Results
k
We get a list of vulnerabilities from the Ubuntu Local Security Checks330 plugin family.331 Plugins
grouped into plugin families check for vulnerabilities in sthe same context. For example, there are
separate plugin families for checking vulnerabilities in databases, firewalls, or web servers. The
Ubuntu Local Security Checks plugin family contains a multitude of plugins that check for local
o
vulnerabilities and missing patches for Ubuntu.
The Name column provides us with the vulnerable Ubuntu versions and a brief description as well
n
as the patch number for the vulnerabilities.
i
z
D
330 (Tenable, 2022), https://www.tenable.com/plugins/nessus/families/Ubuntu%20Local%20Security%20Checks
331 (Tenable, 2022), https://www.tenable.com/plugins/nessus/families
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 188
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
Figure 68: Vulnerability data of Firefox and curl
n
The list also contains vulnerability data of locally exposed applications such as Firefox332 or
cURL.333
i
z
7.2.6 Working with Nessus Plugins
By default, Nessus will enaDble a number of plugins behind-the-scenes, when running a default
template. While this is certainly useful in many scenarios, we can also fine-tune our options to
quickly run a single plugin. We can use this feature to validate a previous finding or to quickly
discover all the targets in an environment that are at risk to a specific vulnerability.
For this example, we will set a plugin filter to identify if the DESKTOP machine is vulnerable to
CVE-2021-3156.334 This is a locally exploitable vulnerability that allows an unprivileged user to
elevate privileges to root.
To leverage the dynamic plugin filter, we will once again begin with a New Scan.
332 (Mozilla, 2022), https://www.mozilla.org/en-US/firefox/new/
333 (Wikipedia, 2022), https://en.wikipedia.org/wiki/CURL
334 (Tenable, 2021), https://www.tenable.com/cve/CVE-2021-3156
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 189
Made in Morocco
Penetration Testing with Kali Linux
Figure 69: Creating a new Scan
This time, we will use the Advanced Dynamic Scan template. This template allows us to use a
dynamic plugin filter instead of manually enabling or disabling plugins.
To use this template, we click on Advanced Dynamic Scan.
y
k
s
Figure 70: Select Advaonced Dynamic Scan
Once again, we’ll configure the name and target.
n
i
z
D
Figure 71: Enter Name and Target
Next, we’ll provide the same SSH and sudo credentials we used in the last example, meaning we’ll
also be conducting an authenticated scan.
Now we can select the plugins we want to use in our vulnerability scan. As stated before, the
Advanced Dynamic Scan allows us to use a filter instead of enabling or disabling groups or
individual plugins.
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 190
Made in Morocco
Penetration Testing with Kali Linux
To do so, let’s click on the Dynamic Plugins tab. In the left dropdown menu, we’ll select CVE to
filter for a specific CVE. In the middle dropdown menu, we can choose from different filter
arguments to specify the matching behavior. On the right dropdown menu, we can specify a CVE
number. After entering “CVE-2021-3156”, we can click on Preview Plugins. This may take a few
minutes to complete.
y
k
s
Figure 72: Filter for specific Plugins
Once Preview Plugins is finished running, we geto a list of found plugin families that cover this
particular CVE.
n
i
z
D
Figure 73: Select Family of Plugins covering CVE-2021-3156
One very handy feature of the dynamic plugin filter is the ability to combine multiple filters. In this
example, we know that the target is an Ubuntu Linux system and we can therefore use a second
filter to specify the related plugin family. Let’s add a new filter by clicking on the plus button next
to the first filter.
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 191
Made in Morocco
Penetration Testing with Kali Linux
Figure 74: Add Filter
A new plugin filter appears. To restrict the plugin family to specific checks for Ubuntu, let’s select