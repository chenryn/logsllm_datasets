# G0086: Stolen Pencil

## Description
[Stolen Pencil](https://attack.mitre.org/groups/G0086) is a threat group, likely originating from North Korea (DPRK), that has been active since at least May 2018. The group has primarily targeted academic institutions, although its specific motives remain unclear. (Citation: Netscout Stolen Pencil Dec 2018)

## Tactics, Techniques, and Procedures (TTPs)
| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Linux, macOS, Windows | [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Credentials from Web Browsers](https://attack.mitre.org/techniques/T1503/) | Stolen Pencil uses tools capable of extracting credentials from web browsers. | Process monitoring, PowerShell logs, File monitoring, API monitoring |
| Linux, macOS, Windows, AWS, GCP, Azure, Office 365, SaaS, Azure AD | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Persistence](https://attack.mitre.org/tactics/persistence/) | [Redundant Access](https://attack.mitre.org/techniques/T1108/) | Stolen Pencil employs a tool to add a Windows admin account, ensuring continued access via RDP. | Office 365 account logs, Azure activity logs, AWS CloudTrail logs, Stackdriver logs, Process monitoring, Process use of network, Packet capture, Network protocol analysis, File monitoring, Authentication logs, Binary file metadata |
| Linux, macOS, Windows, AWS, GCP, Azure | [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Credentials in Files](https://attack.mitre.org/techniques/T1081/) | Stolen Pencil uses tools to extract credentials from saved mail. | File monitoring, Process command-line parameters |
| Windows, macOS, Linux, Office 365, SaaS | [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Spearphishing Link](https://attack.mitre.org/techniques/T1192/) | Stolen Pencil sends spearphishing emails containing links to domains controlled by the threat actor. | Packet capture, Web proxy, Email gateway, Detonation chamber, SSL/TLS inspection, DNS records, Mail server |
| Linux, macOS, Windows | [Persistence](https://attack.mitre.org/tactics/persistence/) | [Browser Extensions](https://attack.mitre.org/techniques/T1176/) | Stolen Pencil prompts victims to install malicious Google Chrome extensions, allowing the threat actor to read data from any accessed website. | Network protocol analysis, Packet capture, System calls, Process use of network, Process monitoring, Browser extensions |
| Windows | [Lateral Movement](https://attack.mitre.org/tactics/lateral-movement/) | [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076/) | Stolen Pencil uses RDP for direct remote point-and-click access. | Authentication logs, Netflow/Enclave netflow, Process monitoring |
| Linux, macOS, Windows | [Collection](https://attack.mitre.org/tactics/collection/), [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Input Capture](https://attack.mitre.org/techniques/T1056/) | Stolen Pencil uses a tool to log keystrokes to `%userprofile%\appdata\roaming\apach.{txt,log}`. | Windows Registry, Kernel drivers, Process monitoring, API monitoring |
| Linux, macOS, Windows, AWS, GCP, Azure, SaaS, Office 365 | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Persistence](https://attack.mitre.org/tactics/persistence/), [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/), [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Valid Accounts](https://attack.mitre.org/techniques/T1078/) | Stolen Pencil adds a Windows admin account to ensure continued access via RDP. | AWS CloudTrail logs, Stackdriver logs, Authentication logs, Process monitoring |
| Linux, macOS, Windows | [Credential Access](https://attack.mitre.org/tactics/credential-access/), [Discovery](https://attack.mitre.org/tactics/discovery/) | [Network Sniffing](https://attack.mitre.org/techniques/T1040/) | Stolen Pencil uses a tool to sniff the network for passwords. | Network device logs, Host network interface, Netflow/Enclave netflow, Process monitoring |
| Windows, Linux, macOS | [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Credential Dumping](https://attack.mitre.org/techniques/T1003/) | Stolen Pencil gathers credentials using Moafee and Procdump. | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |

This table provides a detailed overview of the tactics, techniques, and procedures (TTPs) used by the Stolen Pencil threat group, along with the relevant data sources for detection and monitoring.