Analysis Experience of the suspended
EID Card 
对“被暂停”的晶片身分证之分析经验分享
Speaker : Shi-Cho Cha 
主讲人：查士朝
Dept. of Information Management, NTUST, Chairman and Professor
国立台湾科技大学资讯管理系 教授兼系主任
Taiwan Information Security Center, Director 
国立台湾科技大学资通安全研究与教学中心主任
Background
背景
2
https://www.ris.gov.tw/apply-
idCard/app/idcard/IDCardReissue/main
https://www.ris.gov.tw/app/portal/789
Current Status: Suspended 
现况： 暂停中
https://www.ithome.com.tw/news/142375
Outline 
大纲
4
Information 
Collection
资讯收集
Learning How 
it Works?
确认运作方式
Identifying 
Potential 
Vulnerabilities
识别可能弱点
Key Findings
主要发现
Recommendation 
建议
Information Collection
资讯收集
5
Information 
Collection
资讯收集
Learning How 
it Works?
确认运作方式
Identifying 
Potential 
Vulnerabilities
识别可能弱点
Key Findings
主要发现
Recommendation 
建议
6
https://www.ris.gov.tw/app/portal/789
7
8
Hardware 
Architecture
硬体架构
Crypto. 
Library
密码学
函式库
Card OS     
作业系统
Applet
应用程式
EAC+SAC
EAL6+
EAL6+
EAL6+
EAL5+
Card OS
卡片作业系统
Library
函式库
Applet
应用程式
Common Criteria
共通准则认证
ISO/IEC 7816
ISO/IEC 14443
ISO 7816-4
ICAO 9303
Household Registration Address Zone
户籍地址区
Public Data Zone
公开区
Encrypted Data Zone
加密区
Citizen Digital Certificate Zone
自然人凭证区
9
Household Registration Address Zone
户籍地区
Household Registration Address (Village and 
Neighborhood)
户籍地址 (到村里邻)
Public Data Zone
公开区
Name 姓名
National ID No. 统一编号
Birthday 出生日期
Household Registration Address 户籍地址
Compulsory Military Service Status役别
Marriage Status 结婚状态
Card ID No. 证件号码
Date of Replacement 应换领日期
Date of Issue 制证日期
Photo 相片 (300dpi)
No Access Control
无存取控制
Contact
接触式
Contactless
非接触式
○
○
ICAO SAC 
(Supplemental 
Access Control)
with MRZ or CAN
Contact
接触式
Contactless
非接触式
○
○
10
Encrypted Data Zone
加密区
Spouse Name 配偶姓名
Father 父姓名
Mother 母姓名
Place of Birth 出生地
Gender 性别
Citizen Digital Certificate Zone
自然人凭证区
姓名
统一编号后 4 码
凭证序号
凭证有效日期
ICAO EAC 
(Extended Access 
Control) + TA
+PIN1
Contact
接触式
Contactless
非接触式
○
PIN2
Contact
接触式
Contactless
非接触式
○
ICAO Doc 9303
• Machine Readable Travel Documents Eighth Edition, 2021
• Part 1: Introduction
• Part 2: Specifications for the Security of the Design, Manufacture and Issuance of MRTDs
• Part 3: Specifications Common to all MRTDs
• Part 4: Specifications for Machine Readable Passports (MRPs) and other TD3 Size MRTDs
• Part 5: Specifications for TD1 Size Machine Readable Official Travel Documents (MROTDs)
• Part 6: Specifications for TD2 Size Machine Readable Official Travel Documents (MROTDs)
• Part 7: Machine Readable Visas
• Part 8: Emergency Travel Documents
• Part 9: Deployment of Biometric Identification and Electronic Storage of Data in eMRTDs
• Part 10: Logical Data Structure (LDS) for Storage of Biometrics and Other Data in the 
Contactless Integrated Circuit (IC)
• Part 11: Security Mechanisms for MRTDs
• Part 12: Public Key Infrastructure for MRTDs
• Part 13: Visible Digital Seals
https://www.icao.int/Meetings/TAG-MRTD/Documents/Tag-
Mrtd-20/TagMrtd-20_Pres_TD-1_Broekhaar-wp20.pdf
TD1
TD2
TD3
13
By Bundesrepublik Deutschland, Bundesministerium des Innern. - PRADO, Public 
Domain, https://commons.wikimedia.org/w/index.php?curid=80366059
https://www.icao.int/Security/FAL/TRIP/PublishingImages/Pages/Public
ations/Guidelines%20-%20VDS%20for%20Travel-
Related%20Public%20Health%20Proofs.pdf
Visa
Visa with Digital Seal
Learning How it Works?
确认运作方式
14
Information 
Collection
资讯收集
Learning How 
it Works?
确认运作方式
Identifying 
Potential 
Vulnerabilities
识别可能弱点
Key Findings
主要发现
Recommendation 
建议
15
Additional HiCOS Aplication
is Required
这边需要另外装一个
HiCOS 套件
16
You can read the 
Household Registration 
Address Zone Directly
可以直接读户籍地址区
18
You need MRZ or CAN to 
Read the Public Data Zone 
需要使用 MRZ 或 CAN 以
读取公开区
19
It is Very Complicated to Read 
the Encrypted Data Zone 
要读取加密区就复杂了 ……
Capture the USB Packets with Wireshark and USBPCap
可以使用 Wireshark 与 USBPCap 去抓取 USB 封包
Test Standard is Good Resource
测试标准是可以让我们了解正常运作方式的最佳资源
I Usually Start with Select (00:A4) Command 
我通常会从选取 (00:A4) 指令开始
Select MF Root
LDS1 eMRTD Application
MF
(Master File)
ICAO 9303-10
LDS1 eMRTD Application
AID = ‘A0 00 00 02 47 10 01’
EF.CardAccess
(Short File 
Identifier ‘1C’)
EF.DIR
(Short File 
Identifier ‘1E’)
EF.ATR/INFO
(Short File 
Identifier ‘01’)
EF.CardSecurity
(Short File 
Identifier ‘1D’)
EF.COM
(Short File 
Identifier ‘1E’)
EF.DG1
(Short File 
Identifier ‘01’)
EF.DG3
(Short File 
Identifier ‘03’)
EF.DG2
(Short File 
Identifier ‘02’)
EF.SOD
(Short File 
Identifier ‘1D’)
EF.DG16
(Short File 
Identifier ‘10’)
……
Data Group
EF Name
Short EF Identifier
EF Identifier
Tag
Common
EF.COM
1E
01 1E
60
DG1
EF.DG1
01
01 01
61
DG2
EF.DG2
02
01 02
75
DG3
EF.DG3
03
01 03
63
DG4
EF.DG4
04
01 04
76
DG5
EF.DG5
05
01 05
65
DG6
EF.DG6
06
01 06
66
DG7
EF.DG7
07
01 07
67
DG8
EF.DG8
08
01 08
68
DG9
EF.DG9
09
01 09
69
DG10
EF.DG10
0A
01 0A
6A
DG11
EF.DG11
0B
01 0B
6B
DG12
EF.DG12
0C
01 0C
6C
DG13
EF.DG13