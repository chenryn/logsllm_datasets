baseband for, e.g., phone calls. To overcome this limitations,
the baseband-assisted enrollment scheme uses an enhanced
baseband OS to achieve secure enrollment.
Enrollment Using Initialization Secrets
Figure 11 illustrates the user enrollment problem when
using initialization secrets. Any channel to the secure world
can be intercepted by the mobile OS in the normal world, be it
the baseband OS, the user-interface, or any other interface such
as NFC or Bluetooth. For example, the baseband OS cannot
pass the initialization secret received over SMS messages to
the application processor because it does not know which
processor state (normal world or secure world) is active.
C. Alternative Trusted Execution Environments
In addition to ARM TrustZone, SIM cards are TEEs
widely available on smartphones. A SIM card can store secrets
and execute small pieces of code (often referred to as SIM
applications) in isolation from the mobile OS. Therefore,
one could argue that the location veriﬁcation mechanism can
be implemented as a SIM application within the SIM card
processing environment. This approach has two drawbacks.
First, provisioning of SIM applications to a SIM card requires
the service provider to negotiate with the network operator that
issued that SIM card. Providers who target global applications
must negotiate with a large number of network operators
separately. Second, in current architectures, SIM cards cannot
directly access the device peripherals, such as the GPS unit.
When the SIM card needs location information, the application
processor must read the coordinates from the GPS unit and
provide them to the SIM card. The SIM application has
no means of knowing whether these coordinates have been
tampered with. Some recent device conﬁgurations support a
dedicated connection between the SIM card and the device
NFC unit [47]. Similar dedicated lines could be added for
secure access to the GPS unit. However, targeted hardware
changes to allow for speciﬁc security services based on SIM
applications are costly and hard to justify for widespread
adoption.
Some mobile devices are equipped with a slot for SD cards.
The latter may be used as a TEE to run code in isolation
from the mobile OS or to securely store credentials [48],
[49]. However, just like SIM cards, SD cards do not have
direct access to the device peripherals, such as the GPS unit,
and remote provisioning of applications by third-parties to SD
cards is not currently available.
XI. RELATED WORK
Secure payments with location data. Similar to our approach,
the authors of [3] propose to mitigate fraud in payments
at points of sale, using the phone location as an additional
evidence to distinguish between legitimate and fraudulent
transactions. In [3], the bank sends a message to the user phone
with the details of the transactions (including the location of
the merchant and the one of the phone, as provided by the
network operator) and asks the user to conﬁrm the payment.
This solution requires changes to (i) the GSM infrastructure
to provide the user with the current location of his phone,
(ii) the points of sale to handle extra messages and additional
cryptographic operations, and ultimately (iii) the overall user
experience. Furthermore, the protocols in [3] do not account
for a compromised mobile OS, nor they address enrollment.
The authors do assume an adversary who can intercept any
communication channel and require that the bank shares pair-
wise keys with the phone, the mobile network operator, and
the point of sale.
Recently, MasterCard has proposed to use the location
of the card-holder’s smartphone to improve fraud detection
in payments at points of sale [2]. However, the proposal,
neither addresses mobile OS compromise, nor enrollment, nor
migration.
Secure payments with other approaches. Securing online pay-
ments with multi-factor authentication is the focus of a number
of work that leverage hardware and software tokens to generate
one-time passwords [4], [50], [51], biometric scanners [52],
[53], or simply user-remembered passwords [54]. Financial
institutions are deploying systems that leverage modern smart-
phones to replace traditional payment cards and using NFC-
enabled point of sale terminals [38], [55]. Such solutions can
only be used at selected stores or face large investments for
hardware upgrades at merchants. Other systems that enhance
the security of payment card transactions, require the user
to conﬁrm the payment
through SMS messages or phone
calls [37].
Secure Enrollment. Secure enrollment
trusted plat-
forms [56] and TEEs on mobile devices [11] is a challenging
research problem. Both deployed systems [4], [5] and aca-
demic work [3], [10], [57] have overlooked it or assume a
non-compromised OS at enrollment time [14], [46].
Trusted Sensors. Saroiu and Wolman [9] put forward the
problem of trustworthy sensor readings on mobile phones.
for
13
They propose to leverage virtualization to handle sensors
readings and provide signed measurements to applications that
run in guest VMs. A similar approach is considered in [58]
where the authors consider participatory sensing scenarios and
study how to protect user privacy and how to allow for local
data processing while providing (TPM) signed sensor read-
ings. Trustworthy participatory sensing applications are also
considered in [59], where the authors design and implement a
trusted sensing platform. The latter is a board equipped with
sensors and a TPM that communicates with the mobile device
over Bluetooth and provides signed sensor measurements.
Liu et al. [10] build on top of Credo [60] and TrustZone
to propose software abstractions that expose trusted sensor
services to mobile applications. In particular, [10] focuses on
scenarios where trustworthy reading must be processed locally
by applications (e.g., blurring people’s faces from a photo
taken by the phone’s camera) before being sent. Therefore
the framework in [10] aims at protecting the integrity of a
sensor reading as well as the local code that must process
it. The authors provide a sample application scenario where
sensor readings account for GPS traces, while data processing
applies noise to the aggregated outcome in order to achieve
differential privacy [61].
Plug-n-Trust [62] focuses on mHealth scenarios and pro-
vides a system to protect integrity and conﬁdentiality of data
collected by body-area network of sensors. Their approach
leverages a smart card that plugs into a phone’s microSD slot
and creates a trusted computing environment for collecting and
processing data provided by surrounding sensors. Security rests
upon tamper resistance of both the smart card and the sensor
nodes where encryption/authentication keys are stored.
YouProve [57] addresses scenarios where sensor readings
must be modiﬁed by local applications for, e.g., privacy issues.
The authors of [57] propose a framework to verify that a
modiﬁed data item preserves the meaning of the original
sensor reading. YouProve uses TaintDroid [63] to track the
measurement from the moment it is produced by the sensor,
until the moment it is uploaded to a service provider. Each
modiﬁcation is tracked, and a summary of all changes is signed
using the secret key of the phone’s TPM.
To the best of our knowledge, all previous work on
trusted sensors focuses on designing or developing a trusted
computing environment on a mobile device, to sign sensor
readings. However,
it does not address secure deployment
aspects, including secure enrollment and device migration.
To the best of our knowledge, we are the ﬁrst to propose
a complete and deployable solution that allows a number of
application scenarios to leverage on-smartphone trusted sensor
measurements.
XII. CONCLUSION
In this paper we proposed a practical solution that adds the
required security to recently proposed location-based second-
factor authentication mechanisms for payments at points of
sale. We have identiﬁed the necessary requirements for a de-
ployable solution, including no changes to the user experience
and to the deployed infrastructure. We have further proposed
two novel enrollment schemes that enable secure enrollment
and convenient device migration despite a compromised OS.
Through prototype implementations we have shown deploy-
ment feasibility of our solution; a location veriﬁcation opera-
tion causes an acceptable delay during a payment transaction
and requires only minimal software changes to mobile devices.
As future work we plan to integrate the changes we proposed
to TrustZone and the baseband OS in a smartphone device, in
order to better assess the performance of our solution.
ACKNOWLEDGMENTS
The authors would like to thank Ramya Jayaram Masti
and Mario Strasser for the useful discussions while writing
this paper. This work was partially supported by the Zurich
Information Security Center (ZISC). It represents the views of
the authors.
REFERENCES
[1] European Central Bank, “Report on card fraud,” July 2012, http://www.
ecb.int/pub/pdf/other/cardfraudreport201207en.pdf.
[2] P. Fourez and Mastercard International
Inc., “Location controls
on payment card transactions,” http://patentscope.wipo.int/search/en/
WO2011022062, 2011, Patent No. WO/2011/022062.
[3] F. S. Park, C. Gangakhedkar, and P. Traynor, “Leveraging cellular
infrastructure to improve fraud prevention,” in Proceedings of the 25th
Annual Computer Security Applications Conference, ser. ACSAC ’09,
2009, pp. 350–359.
[4] Barclays, “Mobile PINsentry,” http://goo.gl/pcuGo, last access 2013.
[5] Google Inc., “Google 2-Step Veriﬁcation,” http://www.google.com/
landing/2step/, last access 2013.
[6] A. P. Felt, M. Finifter, E. Chin, S. Hanna, and D. Wagner, “A survey
of mobile malware in the wild,” in ACM workshop on Security and
privacy in smartphones and mobile devices, ser. SPSM’11, 2011.
[7] Y. Zhou and X. Jiang, “Dissecting android malware: Characterization
and evolution,” in IEEE Symposium on Security and Privacy, ser. SP’12,
2012.
[8] ARM, “Building a Secure System using TrustZone Technology,” http:
//www.arm.com, 2009.
[9] S. Saroiu and A. Wolman, “I am a sensor, and i approve this message,”
in Proceedings of ACM International Workshop on Mobile Computing
Systems and Applications (HotMobile), 2010.
[10] H. Liu, S. Saroiu, A. Wolman, and H. Raj, “Software abstractions
for trusted sensors,” in The 10th International Conference on Mobile
Systems, Applications, and Services (MobiSys), 2012.
[11] C. Marforio, N. Karapanos, C. Soriente, K. Kostiainen, and S. Capkun,
“Secure enrollment and practical migration for mobile trusted execution
environments,” in Proceedings of the third ACM workshop on Security
and privacy in smartphones and mobile devices, ser. SPSM’13, 2013.
J. Bonneau, C. Herley, P. C. van Oorschot, and F. Stajano, “The Quest
to Replace Passwords: A Framework for Comparative Evaluation of
Web Authentication Schemes,” in 2012 IEEE Symposium on Security
and Privacy, May 2012. [Online]. Available: http://www.cl.cam.ac.uk/
⇠jcb82/doc/BHOS12-IEEESP-quest to replace passwords.pdf
[12]
[13] R. Guida, R. Stahl, T. Bunt, G. Secrest, and J. Moorcones, “Deploying
and using public key technology: lessons learned in real life,” IEEE
Security Privacy, vol. 2, no. 4, 2004.
[14] A. Czeskis, M. Dietz, T. Kohno, D. S. Wallach, and D. Balfanz,
“Strengthening user authentication through opportunistic cryptographic
identity assertions,” in Proceedings of the 19th ACM Conference on
Computer and Communications Security, ser. CCS’12, 2012, pp. 404–
414.
[15] M. Mannan, B. H. Kim, A. Ganjali, and D. Lie, “Unicorn: two-factor
attestation for data security,” in Proceedings of the 18th ACM conference
on Computer and communications security, ser. CCS ’11, 2011, pp. 17–
28.
[16] K. Kostiainen, E. Reshetova, J.-E. Ekberg, and N. Asokan, “Old, new,
borrowed, blue – a perspective on the evolution of mobile platform
security architectures,” in ACM conference on Data and application
security and privacy, ser. CODASPY’11, 2011.
14
[42] ARM, “Securing the system with trustzone ready program,” http://
www.arm.com/ﬁles/pdf/Tech seminar TrustZone v7 PUBLIC.pdf, last
access 2013.
[43] S. E. Schechter, R. Dhamija, A. Ozment, and I. Fischer, “The emperor’s
new security indicators,” in IEEE Symposium on Security and Privacy,
ser. SP’07, 2007.
[44] S. Egelman, L. F. Cranor, and J. Hong, “You’ve been warned: an
empirical study of the effectiveness of web browser phishing warnings,”
in SIGCHI Conference on Human Factors in Computing Systems, ser.
CHI’08, 2008, pp. 1065–1074.
[45] C. Jackson, D. R. Simon, D. S. Tan, and A. Barth, “An evaluation
of extended validation and picture-in-picture phishing attacks,” in
International Conference on Financial cryptography and International
conference on Usable Security, ser. FC’07/USEC’07, 2007, pp. 281–
293.
[46] K. Kostiainen and N. Asokan, “Credential life cycle management in
open credential platforms (short paper),” in ACM workshop on Scalable
trusted computing, ser. STC’11, 2011, pp. 65–70.
[47] GSM Association, “Requirements for Single Wire Protocol NFC Hand-
sets,” http://www.gsma.com/mobilenfc/, 2011.
[48] Giesecke & Devrient GmbH, “G&D Makes Mobile Terminal Devices
Even More Secure with New Version of Smart Card in MicroSD
Format,” http://www.gi-de.com/en/about g d/press/press releases/G%
26D-Makes-Mobile-Terminal-Devices-Secure-with-New-MicroSD%
E2%84%A2-Card-g3592.jsp, last access 2013.
[49] SD Association, “smartSD Memory Cards,” hhttps://www.sdcard.org/
developers/overview/ASSD/smartsd/, last access 2013.
[50] PayPal, “PayPal Security Key,” https://www.paypal.com/securitykey/.
[51] RSA, “RSA SecurID,” http://www.emc.com/security/rsa-securid.htm/.
“United Bankers’ Bank Authenticates Customers Online,” Biometric
[52]
Technology Today, vol. 12, no. 6, p. 4, 2004.
“Bank of Utah Adopts Keystroke Dynamics,” Biometric Technology
Today, vol. 15, no. 5, p. 5, 2007.
[53]
[54] VISA, “Veriﬁed by VISA,” http://www.visaeurope.com/en/cardholders/
veriﬁed by visa.aspx.
JVL Ventures, LLC, “ISIS,” https://www.paywithisis.com/.
[55]
[56] B. Parno, “Bootstrapping trust in a “trusted” platform,” in Proceedings
of the third Conference on Hot Topics in Security, ser. HOTSEC’08,
2008, pp. 9:1–9:6.
[57] P. Gilbert, J. Jung, K. Lee, H. Qin, D. Sharkey, A. Sheth, and L. P.
Cox, “Youprove: authenticity and ﬁdelity in mobile sensing,” in SenSys,
J. Liu, P. Levis, and K. R¨omer, Eds. ACM, 2011, pp. 176–189.
[58] P. Gilbert, L. P. Cox, J. Jung, and D. Wetherall, “Toward trustworthy
mobile sensing,” in Proceedings of ACM International Workshop on
Mobile Computing Systems and Applications (HotMobile), 2010.
[59] A. Dua, N. Bulusu, and W. chang Feng, “Towards trustworthy partic-
ipatory sensing,” in 4th USENIX Workshop on Hot Topics in Security
(HotSec), 2009, pp. 1–6.
[60] H. Raj, D. Robinson, T. Tariq, P. England, S. Saroiu, and A. Wolman,
“Credo: Trusted computing for guest vms with a commodity hypervi-
sor,” Microsoft Research, Tech. Rep. MSR-TR-2011-130, 2011.
[61] C. Dwork, “Differential privacy,” in ICALP (2), ser. Lecture Notes in
Computer Science, M. Bugliesi, B. Preneel, V. Sassone, and I. Wegener,
Eds., vol. 4052. Springer, 2006, pp. 1–12.
J. Sorber, M. Shin, R. A. Peterson, and D. Kotz, “Plug-n-trust: practical
trusted sensing for mhealth,” in International Conference on Mobile
Systems, Applications, and Services, ser. MobiSys’12, 2012.
[62]
[63] W. Enck, P. Gilbert, B. gon Chun, L. P. Cox, J. Jung, P. McDaniel, and
A. Sheth, “Taintdroid: An information-ﬂow tracking system for realtime
privacy monitoring on smartphones,” in OSDI, 2010, pp. 393–407.
[17] K. Kostiainen, J.-E. Ekberg, N. Asokan, and A. Rantala, “On-board
credentials with open provisioning,” in International Symposium on In-
formation, Computer, and Communications Security, ser. ASIACCS’09,
2009.
[18] GlobalPlatform, “Device speciﬁcations,” available at: http://www.
[19]
[20]
globalplatform.org/speciﬁcationsdevice.asp.
osmocomBB, http://bb.osmocom.org, last access 2013.
3GPP, “3GPP TS 23.040 - Technical realization of the Short Mes-
sage Service (SMS),” http://www.3gpp.org/ftp/Specs/html-info/23040.
htm, last access 2013.
[21] Offspark B.V., “PolarSSL,” https://polarssl.org/, last access 2013.
[22] ARM, “ARM Motherboard Express,” http://www.arm.com/products/
tools/development-boards/versatile-express/motherboard-express.php.
[23] ——, “ARM Coretile Express,” http://www.arm.com/products/tools/
development-boards/versatile-express/coretile-express.php.
[24] Sierraware, “Open Virtualization - ARM TrustZone and ARM Hyper-
visor Open Source Software,” http://www.openvirtualization.org/.
[25] GlobalPlatform, “GlobalPlatform Device Speciﬁcations,” http://www.
globalplatform.org/speciﬁcationsdevice.asp, last access 2013.
[26] Android Development Team, “Android 4.1 APIs - Jelly Bean,” http:
//developer.android.com/about/versions/jelly-bean.html, 2013.
[27] Bouncy Castle Crypto APIs, http://www.bouncycastle.org, last access
2013.
[28] G. Inc., “Google Cloud Messaging for Android,” http://developer.
android.com/google/gcm/index.html, last access 2013.
[29] CherryPy Team, “CherryPy - A Minimalistic Python Web Framework,”
http://www.cherrypy.org/, 2013.
[30] SQLite Development Team, “SQLite,” http://www.sqlite.org, last access
2013.
[31] Comcetera
Ltd.,
“Number
Portability
Lookup,”
http://www.
numberportabilitylookup.com/, 2013.
[32] EMV, “Integrated Circuit Card Speciﬁcations for Payment Systems,
Book 1-4, Version 4.3,” 2011. [Online]. Available: http://www.emvco.
com/
[33] Mastercard, “Mastercard Developer Zone,” 2013. [Online]. Available:
https://developer.mastercard.com/
[34] VISA, “Visa Developer Program,” 2013. [Online]. Available: https:
//developer.visa.com/
[35] Telegraph,
“EU to
June
year,”
newsbysector/mediatechnologyandtelecoms/telecoms/10119159/
EU-to-end-mobile-roaming-charges-next-year.html.
2013,
end mobile
next
http://www.telegraph.co.uk/ﬁnance/
roaming
charges
[36] R. Pries, T. Hobfeld, and P. Tran-Gia, “On the suitability of the short
message service for emergency warning systems,” in Proceedings of the
63rd Vehicular Technology Conference, ser. VTC 2006-Spring, vol. 2,
2006, pp. 991–995.
[37] ValidSoft, “ValidPOS,” 2013. [Online]. Available: http://www.validsoft.
com/
[38] Google Inc., “Google wallet,” http://www.google.com/wallet/, last ac-
cess 2013.
[39] K.-P. Yee, “User interaction design for secure systems,” in International
Conference on Information and Communications Security, ser. ICICS
’02, 2002.
[40] Z. Ye, S. W. Smith, and D. Anthony, “Trusted paths for browsers,” ACM
Trans. Inf. Syst. Secur., vol. 8, no. 2, pp. 153–186, 2005.
[41] M. Selhorst, C. St¨uble, F. Feldmann, and U. Gnaida, “Towards a trusted
mobile desktop,” in International conference on Trust and trustworthy
computing, ser. TRUST’10, 2010.
15