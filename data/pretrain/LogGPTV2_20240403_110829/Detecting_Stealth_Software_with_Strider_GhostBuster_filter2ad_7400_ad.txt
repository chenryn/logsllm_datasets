Windows  NT  Symposium,  pp.  135-143, 
July  1999 
and  Aaron  Johnson,  “Gatekeeper:  Monitoring  Auto-Start 
Extensibility  Points  (ASEPs)  for  Spyware  Management,”  in 
(http://research.microsoft.com/sn/detours/).  
Proc. Usenix LISA, Nov. 2004. 
[IFS] IFS Kit - Installable File System Kit, 
http://www.microsoft.com/whdc/devtools/ifskit/default.mspx.
[WVD+03]  Yi-Min  Wang,  et  al.,  “STRIDER:  A  Black-box, 
State-based  Approach 
to  Change 
and  Configuration 
[J01] K. Jones, “Loadable kernel modules,” ;login: The Magazine 
Management  and  Support,”  Proc.  Usenix  Large  Installation 
of 
USENIX 
and 
SAGE, 
Systems  Administration  (LISA)  Conference,  pp.  159-171, 
http://www.usenix.org/publications/login/2001-
October 2003. 
11/pdfs/jones2.pdf, Nov. 2001. 
[WVS03] Yi-Min Wang, Chad Verbowski, and Daniel R. Simon, 
[KJ03]  Rick  Kennell  and  Leah  H.  Jamieson,  “Establishing  the 
"Persistent-state  Checkpoint  Comparison  for  Troubleshooting 
Genuinity  of  Remote  Computer  Systems,”  In  Proc.  USENIX 
Configuration Failures", in Proc. IEEE DSN, June 2003.  
Security Symposium, August 2003. 
[WVR+04]  Yi-Min  Wang,  Binh  Vo,  Roussi  Roussev,  Chad 
[KS94]  G.  H.  Kim  and  E.  H.  Spafford,  “The  Design  and 
Verbowski,  and  Aaron  Johnson,  “Strider  GhostBuster:  Why 
Implementation  of  Tripwire:  A  File  System 
Integrity 
It’s A Bad Idea For Stealth Software To Hide Files,” Microsoft 
Research Technical Report MSR-TR-2004-71, July 2004. 
Proceedings of the 2005 International Conference on Dependable Systems and Networks (DSN’05) 
0-7695-2282-3/05 $20.00 © 2005 IEEE
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:09:20 UTC from IEEE Xplore.  Restrictions apply. 
[XA04] “Alarm growing over bot software,” (DOS attacks), 
[YK04] Tan Chew Keong, “Win2K Kernel Hidden 
CNET News.com, http://news.zdnet.com/2100-1009_22-
Process/Module Checker 0.1 (Proof-Of-Concept),” 
5202236.html, April 2004. 
http://www.security.org.sg/code/kproccheck.html, May 23, 
[XG03]  “Guilty  Plea  in  Kinko's  Keystroke  Caper,”  (stealing 
2004.  
online banking passwords), Security Focus, July 18, 2003. 
[YKS] KSTAT - Kernel Security Therapy Anti-Trolls, 
[XG04]  “Gone  Phishing:  Web  Scam  Takes  Dangerous  Turn,” 
http://s0ftpj.org/en/tools.html.
(stealing  online  banking  passwords), Wall Street  Journal, May 
[YL01] “Linux on-the-fly kernel patching without LKM”, 
27, 2004. 
http://www.phrack.org/phrack/58/p58-0x07, Phrack Magazine, 
[XP03] Kevin Poulsen, “Windows Root Kits a Stealthy Threat,” 
Dec. 2001. 
SecurityFocus, http://www.securityfocus.com/news/2879, Mar 
[YN04]  “NTIllusion  --  A  portable  Win32  userland  rootkit.txt,” 
5 2003. 
Phrack Magazine, July 13, 2004. 
[XP04] “Phishers tapping botnets to automate attacks”, 
[YO03] OpioN, “Kernel Rootkits Explained”, 
(phishing), The Register, 
http://www.ebcvg.com/articles.php?id=124, March 2003. 
http://www.theregister.co.uk/2004/11/26/anti-phishing_report/,
[YT04] C. K. Tan, “Defeating Kernel Native API Hookers by 
Nov. 26, 2004.  
Direct Service Dispatch Table Restoration,” 
[XS04]  “Spreading  Web  Virus  Aims  to  Steal  Financial  Data,” 
http://www.security.org.sg/code/SIG2_DefeatingNativeAPIHo
Reuters, June 25, 2004. 
okers.pdf, July 2004. 
[XW04] “White collar virus writers make cash from chaos,” 
[YV04] VICE – Catch the hookers! 
(dialers, spamming), The Register, 
http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-
http://www.theregister.co.uk/2004/12/07/sophos_av_review_2
butler/bh-us-04-butler.pdf.
004/, Dec. 2004. 
[YW98] “Weakening the Linux Kernel,” Phrack Magazine, 
[XZ04] “Zombie PCs: Silent, Growing Threat,” PC World, 
http://www.phrack.org/phrack/52/P52-18, Jan. 1998.   
http://www.pcworld.com/news/article/0,aid,116841,00.asp,
[ZA] API Hook SDK 2.12, 
July 2004.  
http://www.devarchive.com/f1709.html.
[YA03] A. Chuvakin, “An Overview of Unix Rootkits,” iALERT 
[ZAF] Aphex – AFX Windows Rootkit 2003, 
White Paper, iDefense Labs, 
http://www.iamaphex.cjb.net.
http://www.megasecurity.org/papers/Rootkits.pdf, February 
2003. 
[YB] BIOS and Flash Utilities, 
[ZAH] Advanced Hide Folders, http://www.hide-folders.biz/.
[ZB] Berbew, 
http://securityresponse.symantec.com/avcenter/venc/data/back
http://h20000.www2.hp.com/bizsupport/TechSupport/DriverD
ownload.jsp?pnameOID=100870&locale=en_US&taskId=135
door.berbew.j.html.
&refresh=true&prodTypeId=12454&prodSeriesId=96495&sw
[ZD] Darkside rootkit, http://www.antiserver.it/backdoor-rootkit/.
EnvOID=1093#2663.   
[ZF] File & Folder Protector, http://www.softheap.com/ffp.html.
[YB04] C. Boyd, “Xpire/Splitinfinity.info Server Hack and 
[ZFU] The FU Rootkit, 
Malware injection using IFRAMES Vulnerability – Condensed 
http://www.rootkit.com/vault/fuzen_op/FU_Rootkit.zip.
Version,” http://www.spywarewarrior.com/xpire-splitinfinity-
[ZH] Hacker Defender, http://rootkit.host.sk/.
serverhack_malwareinstall-condensed.pdf.
[ZHF] Hide Files 3.3, 
[YC] The chkrootkit tool, http://www.chkrootkit.org/.
http://www.tomdownload.com/new_add/new20031128/hide_fi
[YC04] “Nasty New Parasite,” (stealth spyware), Spyware 
les_folders.htm.
Weekly Newsletter, 
[ZHO] Hide Folders XP, http://www.fspro.net/downloads.html.
http://www.spywareinfo.com/newsletter/archives/0604/8.php,
June 8, 2004. 
[YC98] Silvio Cesare, “Runtime kernel kmem patching,” 
http://vx.netlux.org/lib/vsc07.html, Nov. 1998. 
[YH] Hidden Registry Keys, 
[ZK] Knark LKM-rootkit, 
http://www.sans.org/resources/idfaq/knark.php.
[ZP] ProBot SE Monitoring Software, 
http://www.nethunter.cc/index.php?id=14.
[ZR] RootKits,  http://www.rootkit.com/.
http://www.sysinternals.com/ntw2k/info/tips.shtml#registryhid
den.
[ZS] Superkit rootkit, 
[YH03] “How to become unseen on Windows NT,” 
http://www.remoteassessment.com/darchive/191006794.html.
http://rootkit.host.sk/knowhow/hidingen.txt, May 8, 2003. 
[ZT] The T0rnkit rootkit, http://www.europe.f-secure.com/v-
[YI] Ivo Ivanov, “API hooking revealed”, 
http://www.codeproject.com/system/hooksys.asp.
[YJ] A. R. Jones, “A Review of Loadable Kernel Modules,” 
descs/torn.shtml.
[ZU] The Urbin Trojan, 
http://vil.nai.com/vil/content/v_125663.htm.
http://www.giac.org/practical/gsec/Andrew_Jones_GSEC.pdf.
[ZV] Vanquish, https://www.rootkit.com/project.php?id=9.
[YK] Tan Chew Keong, “ApiHookCheck Version 1.01,” 
[ZVI] Vice, http://www.rootkit.com/project.php?id=20.
http://www.security.org.sg/code/apihookcheck.html, April 15, 
2004. 
Proceedings of the 2005 International Conference on Dependable Systems and Networks (DSN’05) 
0-7695-2282-3/05 $20.00 © 2005 IEEE
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:09:20 UTC from IEEE Xplore.  Restrictions apply. 
Outside-the-box Solution 
Inside-the-box Solution 
(i. e., boot i nto a cl ean OS not infected 
(i. e., boot i nto the OS potentiall y infected with ghostware) 
with ghostware) 
Diff 
Hi gh-l evel Scan 
Wi n32 APIs 
Outside-the-b ox Scan
Ghostware Hi di ng Mechanism 
Diff
Low-l evel Scan
Truth Approximation 
Master F il e Table 
Raw Hive F iles 
Kernel Process List 
Truth Approximati on 
The Truth 
Figure 1. Strider GhostBuster: Combining Inside-the-box and Outside-the-box Scans and Diffs. 
Urbin &  
Mersting 
Vanquish 
User mode 
Kernel mode 
ProBot SE 
Driver 
Cmd!Dir
Kernel32!FindFirst(Next)File 
Import Address Table (IAT) 
Kernel32!FindFirst(Next)File 
Aphex 
NtDll!NtQueryDirectoryFile 
Hacker 
Defender 
Nt!NtQueryDirectoryFile 
Servi ce Di spatch Tabl e Entry 
Nt!NtQueryDirectoryFile 
I/O Manager
F ile System Components
Filter Driver  
For the Four  
File Hiders 
Figure 2. How Ghostware Programs Hide Files 
Ghostware
Urbin [ZU]
Mersting
Hidden Files Detected
1 (C:\windows\system32\msvsres.dll)
1 (C:\windows\system32\kbddfl.dll)
Vanquish [ZV] 
3+ (C:\windows\vanquish.exe, C:\windows\vanquish.dll, 
Aphex [ZAF]
Any files with names matching a configurable prefix
C:\vanquish.log, and any other “*vanquish*” files) 
Hacker Defender 1.0 [ZH]
3+ (hxdef100.exe, hxdefdrv.sys, hxdef100.ini, and any other files with 
ProBot SE [ZP]
4 (C:\windows\system32\.exe, 
names matching the patterns specified in hxdef100.ini) 
File hiders [ZHF,ZHO,ZAH,ZF] 
Any user-selected folders and files
C:\windows\system32\.dll, and two 
C:\windows\system32\drivers\.sys files)
Figure 3. Experimental Results for GhostBuster Hidden-File Detection 
Proceedings of the 2005 International Conference on Dependable Systems and Networks (DSN’05) 
0-7695-2282-3/05 $20.00 © 2005 IEEE
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:09:20 UTC from IEEE Xplore.  Restrictions apply. 
Ghostware 
Hidden ASEP Hooks Detected 
Urbin
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs 
 msvsres.dll
Mersting
HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs 
 kbddfl.dll
Hacker
HKLM\SYSTEM\CurrentControlSet\Services\HackerDefender100  hxdef100.exe 
Defender 1.0
HKLM\SYSTEM\CurrentControlSet\Services\HackerDefenderDrv100  hxdefdrv.sys
Vanquish
HKLM\SYSTEM\CurrentControlSet\Services\Vanquish  vanquish.exe
ProBot SE
HKLM\SYSTEM\CurrentControlSet\Services\
 System32\drivers\.sys 
HKLM\SYSTEM\CurrentControlSet\Services\ 
 .sys keyboard driver 
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run  .exe
Aphex
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run  .exe
Figure 4. Experimental Results for GhostBuster Hidden ASEP Hook Detection. 
Aphex 
User mode 
Kernel mode 
TaskMgr
NtDll!NtQuerySystemInformation 
Import Address Table (IAT)
NtDll!NtQuerySystemInformation 
Nt!NtQuerySystemInformation
Service Dispatch Table Entry
Nt!NtQuerySystemInformation
Active Process List
Hacker 
Defender 
& Berbew 
FU Driver 
Figure 5. How Ghostware Programs Hide Processes. 
Ghostware
Hidden Processes/Modules Detected
Aphex
By default, any process with a “~~”-prefixed name (which is configurable)
Hacker Defender 1.0
hxdef100.exe, and any other processes with names matching the patterns specified 
Berbew [ZB]
.exe
in hxdef100.ini
FU [ZFU]
Any process hidden by the “fu –ph ” command
Vanquish
vanquish.dll (hidden inside many processes)
Figure 6. Experimental Results for GhostBuster Hidden Processes/Modules Detection.
Proceedings of the 2005 International Conference on Dependable Systems and Networks (DSN’05) 
0-7695-2282-3/05 $20.00 © 2005 IEEE
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:09:20 UTC from IEEE Xplore.  Restrictions apply.