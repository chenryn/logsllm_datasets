title:DNS Noise: Measuring the Pervasiveness of Disposable Domains in
Modern DNS Traffic
author:Yizheng Chen and
Manos Antonakakis and
Roberto Perdisci and
Yacin Nadji and
David Dagon and
Wenke Lee
2014 44th Annual IEEE/IFIP International Conference on Dependable Systems and Networks
DNS Noise: Measuring the Pervasiveness of
Disposable Domains in Modern DNS Trafﬁc
∗College of Computing, Georgia Institute of Technology, {yizheng.chen,yacin.nadji,wenke}@cc.gatech.edu, PI:EMAIL
Yizheng Chen∗, Manos Antonakakis†, Roberto Perdisci‡, Yacin Nadji∗, David Dagon∗, Wenke Lee∗
†School of Electrical and Computer Engineering, Georgia Institute of Technology, PI:EMAIL
‡Department of Computer Science, University of Georgia, PI:EMAIL
Abstract—In this paper, we present an analysis of a new
class of domain names: disposable domains. We observe that
popular web applications, along with other Internet services,
systematically use this new class of domain names. Disposable
domains are likely generated automatically, characterized by a
“one-time use” pattern, and appear to be used as a way of “sig-
naling” via DNS queries. To shed light on the pervasiveness of
disposable domains, we study 24 days of live DNS trafﬁc span-
ning a year observed at a large Internet Service Provider. We
ﬁnd that disposable domains increased from 23.1% to 27.6% of
all queried domains, and from 27.6% to 37.2% of all resolved
domains observed daily. While this creative use of DNS may
enable new applications, it may also have unanticipated nega-
tive consequences on the DNS caching infrastructure, DNSSEC
validating resolvers, and passive DNS data collection systems.
Keywords-Disposable Domain Name; Internet Measurement.
I. INTRODUCTION
The domain name system (DNS) is a critical component
of the Internet that maps human-readable names to machine-
level IP addresses. Over the years as the Internet evolved,
more and more service providers use the DNS in ways
for which it was not originally intended. Their primary
objective is to make their network operations more agile
and scalable. Such use cases are often found in content
delivery networks (CDNs) [1], NXDOMAIN rewriting [2],
and URL auto-completion and prefetching [3].
In this paper, we describe a new class of DNS misuse
called disposable domains. Recently, a number of service
providers, such as popular search engines [4], social
networks, and security companies [5], began to heavily use
automatically generated domain names to convey “one-time
signals” to their servers. These disposable domains are often
created on demand in large volumes and belong to common
parent DNS zones (i.e., same name sufﬁx). Moreover,
disposable zones have unique cache hit rate distributions
that distinguish them from non-disposable zones.
While these creative ways of using the DNS enable
new useful applications and performance improvements
for certain types of Internet services, the increasing use
of disposable domains may have unanticipated and even
negative impacts on day-to-day DNS operations for large
Internet Service Providers. Firstly, disposable domain
names are only queried a few times by a handful of clients.
However, when a large number of disposable domains come
into existence, their queries may ﬁll up the cache of local
DNS resolvers. Such an event may cause premature cache
evictions of non-disposable domains, and in turn cause DNS
service degradation within the ISP network. Secondly, these
premature evictions may inﬂate the trafﬁc between the DNS
resolvers and authoritative name servers. The increased
trafﬁc can cause DNSSEC-enabled resolvers to perform
extra cryptographic operations. Lastly,
the pervasiveness
of disposable domains in modern DNS trafﬁc can cause
a signiﬁcant increase in the storage cost for passive DNS
databases, which are vital for domain reputation systems [6],
[7], [8], and represent an irreplaceable tool for the forensic
analysis of network security incidents [9], [10], [11], [12].
It is therefore important for the research and operational
communities to carefully monitor and analyze the evolution
of the DNS usage in today’s Internet. It is also necessary
to understand under what conditions the current DNS
practices employed by various service providers may result
in unexpected operational problems in the near future. In
this paper, we design a system to automatically discover
DNS zones that use disposable domains and present detailed
measurements on how disposable domains are being used
by large service providers. Speciﬁcally, we make the
following contributions:
• We present a study from large scale DNS trafﬁc traces
collected at a large north American ISP (namely Com-
cast) serving millions of end users. Our measurements
show, among other interesting facts, that a very sig-
niﬁcant percentage, 25% of all queried domain names,
33% of all resolved domain names, and 60% of all
distinct resource records observed daily are disposable.
• In order to properly monitor and measure the network
presence of the disposable domains we propose a novel
algorithm that automatically ﬁnds DNS zones that
contain disposable domains. Our algorithm accurately
discovers disposable domains by passively monitoring
DNS trafﬁc, with 97% true positive and 1% false
positive rates. Using our system, over the period of 11
978-1-4799-2233-8/14 $31.00 © 2014 IEEE
DOI 10.1109/DSN.2014.61
598
Authorized licensed use limited to: Tsinghua University. Downloaded on March 22,2021 at 06:04:42 UTC from IEEE Xplore.  Restrictions apply. 
(47+(
(4(4.7:(4


:(7.(4
   (!1.(1

:(4(4
1
(!1.(1
   (!1.(1

Figure 1: DNS query resolution process.
months, we discovered 14, 488 new disposable zones.
• We discuss the possible negative implications that the
growth of disposable domains may have on the DNS
caching infrastructure, DNSSEC-validating resolvers,
and passive DNS data collection systems.
The rest of the paper is organized as follows. In Section II,
we provide background on DNS and discuss related work.
In Section III, we describe our data collection process and
provide an overview of the characteristics of modern DNS
trafﬁc observed in our dataset. In Section IV, we deﬁne
disposable domains and examine their key properties. In
Section V, we provide details of our disposable domain
miner. In Section VI, we discuss the negative impacts dis-
posable domains have on DNS cache, DNSSEC, and passive
DNS database. We conclude the paper in Section VII.
II. RELATED WORK
A. DNS Concepts and Terminology
In most cases, establishing an Internet connection from a
client to a server begins with a DNS resolution that maps a
domain name (e.g., www.example.com) to an IP address
(e.g., 192.0.12.0). As shown in Figure 1, the client (stub
resolver) ﬁrst issues a query to the Recursive DNS server
(RDNS). If the resolution request from the client is not in
the cache, the RDNS will perform an iterative query. This
process begins at the root server and works its way down
through the top level domain name (TLD) server and name
server of example.com until the RDNS server receives
the current DNS answer for the original client’s request.
Finally,
the RDNS server replies to the client with the
answer received from the name server of example.com.
B. Related Work
1) Passive DNS and DNS Trafﬁc Aggregation:
Weimer [13] was the ﬁrst to propose passive DNS replication
for
forensic analysis and network measurement. The
implementation dnstop passively collects DNS data from
a production network to keep historic DNS information.
Plonka et al. [14] built treetop to collect and analyze passive
DNS traces. They separate trafﬁc into three categories:
canonical, overloaded and unwanted. They showed that
spikes of DNS trafﬁc are typically unwanted or overloaded
trafﬁc. In their taxonomy, unwanted DNS trafﬁc comprises
all unsuccessful DNS resolutions (i.e., NXDOMAINs).
DNS trafﬁc with purposes beyond mapping domains to IPs
are considered overloaded, while the rest are canonical.
At that time, the primary application of overloaded DNS
trafﬁc was for blacklisting purposes. Disposable domains
are more general than the overloaded class. We study DNS
zones used for various services in addition to blacklisting.
2) DNS Trafﬁc Analysis: CDNs are traditionally used
for dynamic request routing via resolution management [1].
Similarly, many Internet services use “domain sharding” to
allow parallel client queries to web content [15]. Vixie [16]
pointed out numerous problems with DNS-based load
balancing. While his work notes the potential decrease
in the effectiveness of caching, Vixie’s analysis focused
on DNS policy, such as “NXDOMAIN Remapping” for
commercial gains, rather than the cache consumption caused
by disposable domains. Our work expands on these issues by
providing experimental results for the caching performance
of disposable domains in general and revealing yet another
misuse of the DNS. Work done by Yadav et al. [17]
detects algorithmically-generated malicious domain names.
Disposable domains are not only generated by an algorithm,
but also have low cache hit rate and are not necessarily
malicious. Berger et al.
[18] studied the dynamics of
DNS and proposed stability metrics to classify dynamic
and stable domain names. In contrast, our deﬁnition of
disposable domains is a distinct category. Paxson et al. [19]
built a practical system for detecting DNS covert channels,
enforcing a 4kB/day information bound after
lossless
compression for enterprise environment, per user, per des-
tination. However, disposable domains can be stealthy and
stay under this threshold. Nevertheless, we can identify them
collectively from the view of the entire disposable zone.
3) DNS Cache Modeling: Jung et al. [20] presented a
trace-driven simulation to measure cache hit rates. Later,
they [21] proposed a cache hit rate model based on the
renewal model of inter-query arrival times and the Time
To Live (TTL) values in DNS cache records. They assume
(1) every data item has the same TTL value, and (2) a
group of clients share a common cache, without
local
in the client machines such that DNS
caches present
requests can be inferred from TCP connections. Since their
assumptions are not true in our ISP Recursive DNS Server
monitoring scenario, we take a black-box analysis approach
by evaluating the performance of a server cluster with
multiple independent caches.
III. DATA COLLECTION
In this section, we ﬁrst describe the methodology used
to collect the DNS datasets for our study and explain our
network visibility within a large North American ISP. Then,
599
Authorized licensed use limited to: Tsinghua University. Downloaded on March 22,2021 at 06:04:42 UTC from IEEE Xplore.  Restrictions apply. 
we analyze the collected datasets, and elaborate on the
characteristics of modern DNS trafﬁc. This panoramic view
of real-world DNS messages is instrumental to the analysis
of “disposable” domains that we present in Section IV.
A. Trafﬁc Collection and Datasets
We have visibility of all DNS trafﬁc to and from the recur-
sive DNS (RDNS) servers of a large ISP in the Midwestern
US. For quality of service reasons (e.g., load balancing and
fault tolerance), the DNS queries from the ISP customers are
served by a cluster of RDNS servers. This is a fairly typical
conﬁguration for recursive DNS servers in large ISPs.
We can monitor trafﬁc “above” and “below” the RDNS
servers. For example, considering the DNS resolution
scenario in Figure 1, from our network monitoring point,
we were able to observe events indicated by solid arrows:
(1) DNS responses from the RDNS servers to the client (the
stub resolver) (“below” the RDNS servers), and (2) DNS
responses from the authoritative name servers to the RDNS
servers (“above” the RDNS servers). We only record the
answer section of the DNS response packets, which reﬂect
answered queries from client and from RDNS server cluster.
To perform our measurements, we use two types of DNS
datasets: a full passive DNS (fpDNS) dataset, and a reduced
passive DNS (rpDNS) dataset. The fpDNS dataset includes
all DNS trafﬁc observed at the monitoring point. Each entry
in the fpDNS dataset is a resource record (RR), a tuple
containing the timestamp of the DNS resolution event (in
the granularity of seconds), an anonymized client ID of the
host that issued the DNS request, the queried domain name,
the DNS query type, the time-to-live value (TTL), and the
resolution data (RDATA) contained in the response. The
query types in our dataset are A, CNAME, AAAA types.
The rpDNS dataset
includes the distinct (no duplicates)
resource records (RRs) from all successful DNS resolutions
observed from the same monitoring point in the ISP. DNS
requests with no valid response, such as NXDOMAIN, are
excluded. We represent the rpDNS dataset in a given day,
as tuples containing the queried domain name, the DNS
query type, RDATA, and the ﬁrst date the tuple was seen.
Since we are dealing with real-world ISP-level DNS
traces, the size of the compressed fpDNS dataset is around
60GB per day in February, and around 145GB per day
in December, 2011. Therefore, we have limits on the
amount of data we can obtain over a certain period and
the overall monitoring period for our experiment. To that
extent, we built
the fpDNS dataset using data collected
over 24 days: from 02/01/2011 to 02/07/2011, 09/02/2011,
09/13/2011, 11/14/2011, from 11/28/2011 to 12/10/2011,
and 12/30/2011. The total size of our fpDNS dataset is
2.67TB. On the contrary, the rpDNS dataset has smaller
storage size, as it only contains distinct RRs, with a size
of seven to nine GBs per day. Overall, the rpDNS dataset
includes the deduplicated resource record data derived from
the fpDNS dataset, for 11/28/2011 to 12/10/2011.
B. Notation
Next, we describe some notation that we will use
throughout the rest of the paper. A domain name d consists
of a set of labels (or substrings) separated by a period. We
refer to the effective rightmost label as the top-level domain
(TLD). This segment captures the delegation aspects of
the zone, and not merely a lexical splitting of the domain
name. For example, we treat com.cn and co.uk as
effective TLDs, since all further child labels under those
zones represent name server delegations, usually to separate
organizations and entities, who in turn control what resides
in the child zone. This approach is similar to the “public
sufﬁx list” from Mozilla [22]. Our deﬁnition is a superset of
this effort, and corrects the omission of dynamic DNS zones.
The second-level domain (2LD) represents the two right-
most child labels separated by a period. Similarly, the third-
level domain (3LD) consists of the three rightmost labels,
and so on. In general, the N th-level domain (NLD) refers
to the N rightmost labels. For instance, given domain name
d = a.example.com, T LD(d) = com, 2LD(d) =
example.com, and 3LD(d) = a.example.com.
Throughout the text, we use the notion of “zone” loosely.
It can be 2LD, 3LD, or any N th-level domain. We provide
further clariﬁcations on the notion of a zone as necessary.
C. Full Passive DNS Database
Before we introduce the notion of “disposable” domain
names, we provide some insights from analyzing the
fpDNS dataset. From a high-level view, the most interesting
properties are the trafﬁc volumes above and below the
RDNS servers, the caching properties, and the deduplicated
resource record volumes. These analyses will provide some
tell-tale signs for disposable domain names, which the DNS
community has not thoroughly deﬁned nor studied.
In February there were 4.2 billion RRs observed below
the RDNS servers, and 500 million RRs above them.
In December the volume increased to 10 to 11 billion
RRs observed below the RDNS servers, and 800 million
RRs above them. Moreover,
in December, we observe
approximately 30 million unique domain names every day,
where 20 million of them were successfully resolved.
1) DNS Trafﬁc Volume: First, we examine the DNS
resource record (RR) volumes above and below the recursive
DNS servers. As Figure 2 shows,
there is an order of
magnitude less trafﬁc above the recursive servers than below,
as a result of caching. Moreover, we can clearly observe the
human-driven diurnal effect on DNS trafﬁc (e.g., the trafﬁc
volume dropped after midnight and rose at 10am local time).
In order to put these observations about the DNS resource
record volumes into perspective, we selected two of the most
600
Authorized licensed use limited to: Tsinghua University. Downloaded on March 22,2021 at 06:04:42 UTC from IEEE Xplore.  Restrictions apply. 