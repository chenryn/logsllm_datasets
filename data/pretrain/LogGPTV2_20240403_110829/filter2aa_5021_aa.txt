פתרון - OWASP IL 2018 AppSec CTF
מאת
Dvd848
&nbsp;
הקדמה
בתחילת ספטמבר 2018
התקיים CTF של OWASP IL. הוא היה פתוח למשך
קצת יותר מיממה וכלל 15 אתגרים ברמות קושי שונות.
&nbsp;
אתגר 1 – devDucks (רמת קושי קלה, 200 נקודות)
&nbsp;
הוראות האתגר:
URL: http://challenges.owaspil.ctf.today:8089/
פתרון:
לחיצה על הקישור
מובילה לדף שמציג שגיאת זמן ריצה של פייתון:
אפשר לעבור על ה-Traceback ולראות את ה-state של כל פונקציה בזמן
השגיאה.
למשל, אם מחפשים קוד
שנכלל באפליקציה עצמה (בניגוד לקוד של ספריות עזר), מגיעים לקטע הבא:
&nbsp;
אפשר לראות פה מספר
שורות קוד מתוך האפליקציה, אך לא משהו מועיל במיוחד. מה שנראה הרבה יותר מועיל הוא
הסמל של ה-Console שמופיע
מימין.
לחיצה עליו ויש לנו Console אינטראקטיבי!
מפה הדרך אל הדגל
קצרה:
הדגל: OWASP-IL{D3bug_p1ns_ar3_important}
אתגר 2 - OWASP University (רמת קושי
קלה, 250 נקודות)
&nbsp;
הוראות האתגר:
We got anonymous tip about a terrorist in OWASP University,
We're afraid she will try to attack in few days.
Please help us catch her!
We have her old student card and we know you will have the information you need
there, the problem is that she somehow changed her security code...
Image size must be: 1597 x 1033
URL: http://challenges.owaspil.ctf.today:8099/
פתרון:
כניסה לאתר מובילה אל
הדף הבא:
לחיצה על Enter מקפיצה חלון של
העלאת קובץ. אם מנסים להעלות את כרטיס הסטודנט, מקבלים את ההודעה הבאה:
האתגר טען ש&quot;כל
המידע שאנחנו צריכים נמצא בכרטיס&quot;, לכן הדבר הראשון שעשיתי היה לנסות לנתח את
התמונה כדי למצוא מידע נסתר.
ראשית השתמשתי ב-exiftool כדי לסרוק את ה-metadata של התמונה. במקרים
רבים אפשר למצוא שם רמזים חשובים. הפעם, הדבר היחיד שבלט לעין היה ה-Thumbnail:
פורמט JPEG כולל אפשרות לכלול Thumbnail (גרסה זעירה של
התמונה עצמה) בתוך ה-header של התמונה
הגדולה, מה שאמור לסייע בניהול מספר רב של תמונות (למשל, תוכנה להצגת תמונות יכולה
להציג את ה-thumbnail כאשר צופים
בכל התמונות יחדיו, במקום לבצע פעולה יקרה של הקטנת כל תמונה ותמונה לגודל הרצוי
עבור תצוגה זו). בתיאוריה, התמונה הקטנה לא חייבת להיות דומה לתמונה הגדולה, מדובר
במידע בינארי עצמאי שכמובן אפשר לקבוע שרירותית בעזרת הכלים המתאימים. כלומר, אם
התוקפת שינתה את התמונה הגדולה אבל שכחה לשנות את ה-thumbnail, אולי ניתן יהיה לזהות את הקוד המקורי
שלה לפני השינוי.
בפועל, הכיוון הזה
לא הצליח כי הגרסה המוקטנת הייתה דומה לגרסה המקורית.
משם, עברתי לחפש קבצים
נסתרים בתוך התמונה (ניתן למשל לכלול קובץ ארכיון מיד אחרי המידע הבינארי של
התמונה עצמה), אך גם שם לא מצאתי משהו מיוחד:
זה השלב שבו נזכרתי
באגדה על מישהו שביצע SQL Injection כנגד מצלמת מהירות: