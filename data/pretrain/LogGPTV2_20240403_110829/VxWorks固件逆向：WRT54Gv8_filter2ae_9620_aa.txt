# VxWorks固件逆向：WRT54Gv8
##### 译文声明
本文是翻译文章，文章原作者 devttys0，文章来源：devttys0.com
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
最近我一直致力于解压一些[VxWorks](https://en.wikipedia.org/wiki/VxWorks)固件镜像，不幸的是，几乎找不到相关的信息。所以这篇文章的主题主要是从WRT54Gv8[固件镜像](http://homedownloads.cisco.com/downloads/firmware/FW_WRT54Gv8_8.00.8.001_US_20091005.bin)提取VxWorks的内核、应用代码以及在IDA
pro中分析它们。
随着WRT54Gv5的发布，WRT54G系列从Linux转向VxWorks系统。
由于VxWorks是一种实时操作系统（RTOS），相较于Linux的系统，我对该系统不太了解。
该系统即使确定了镜像的各个节，但是也不存在一个节包含标准的ELF可执行文件（可以被反汇编器自动分析）。
但是逆向该固件的整个过程是比较简单的：
  1. 从固件中识别以及提取可执行代码。
  2. 从可执行代码中识别加载地址。
  3. 在ida中使用正确的加载地址加载可执行文件。
  4. 通过手动/脚本辅助IDA完成自动分析。
使用JTAG或者是通过串口观察调试信息也许可以代替步骤1和2，但是由于我没有VxWorks WRT54G路由器，因此完全是基于固件的分析。
第一步是在固件映像中找到任何可识别的数据节：
    embedded@ubuntu:~/WRT54Gv8$ binwalk -v FW_WRT54Gv8_8.00.8.001_US_20091005.bin
    Scan Time:    Jul 05, 2011 @ 09:24:20
    Magic File:   /usr/local/etc/binwalk/magic.binwalk
    Signatures:   64
    Target File:  FW_WRT54Gv8_8.00.8.001_US_20091005.bin
    MD5 Checksum: 74317a70160f80fa5df01de0e479a39c
    DECIMAL       HEX           DESCRIPTION
    -------------------------------------------------------------------------------------------------------    512           0x200         ELF 32-bit LSB executable, MIPS, MIPS-II version 1 (SYSV)
    101658        0x18D1A       Linux Journalled Flash filesystem, little endian
    103664        0x194F0       LZMA compressed data, properties: 0x6C, dictionary size: 8388608 bytes, uncompressed size: 3680864 bytes
    1146276       0x117DA4      LZMA compressed data, properties: 0xA0, dictionary size: 486539264 bytes, uncompressed size: 520093696 bytes
    1185153       0x121581      gzip compressed data, was "apply.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1185892       0x121864      gzip compressed data, was "apply1.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1186870       0x121C36      gzip compressed data, was "apply2.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1187499       0x121EAB      gzip compressed data, was "apply2sec.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1188483       0x122283      gzip compressed data, was "apply3.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1189464       0x122658      gzip compressed data, was "applyW.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1190202       0x12293A      gzip compressed data, was "bad.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1190724       0x122B44      gzip compressed data, was "basic.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1202618       0x1259BA      gzip compressed data, was "bkconfig.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
    1205617       0x126571      gzip compressed data, was "chghttps.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
    1206740       0x1269D4      gzip compressed data, was "ChgLan.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
    1207440       0x126C90      gzip compressed data, was "common.js", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
    1210112       0x127700      gzip compressed data, was "Cysaja.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
    1210324       0x1277D4      gzip compressed data, was "DDNS.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
    1214620       0x12889C      gzip compressed data, was "default.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1215253       0x128B15      gzip compressed data, was "DEVICE.HTM", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1216309       0x128F35      gzip compressed data, was "DHCPTable.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1217539       0x129403      gzip compressed data, was "Diag.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1220485       0x129F85      gzip compressed data, was "DMZ.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1223383       0x12AAD7      gzip compressed data, was "ERRSCRN.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1224077       0x12AD8D      gzip compressed data, was "FacDef.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1226898       0x12B892      gzip compressed data, was "FilterMac.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1228632       0x12BF58      gzip compressed data, was "Filters.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1233858       0x12D3C2      gzip compressed data, was "Firewall.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1236986       0x12DFFA      gzip compressed data, was "Forward.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1241779       0x12F2B3      gzip compressed data, was "getstatus.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
    1242777       0x12F699      gzip compressed data, was "HDDNS.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
    1244149       0x12FBF5      gzip compressed data, was "HDefault.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1245052       0x12FF7C      gzip compressed data, was "HDMZ.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1246049       0x130361      gzip compressed data, was "HExile.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1247163       0x1307BB      gzip compressed data, was "HFilters.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1248531       0x130D13      gzip compressed data, was "HFirewall.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1249494       0x1310D6      gzip compressed data, was "HForward.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1250527       0x1314DF      gzip compressed data, was "HLog.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1251393       0x131841      gzip compressed data, was "HMAC.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1252433       0x131C51      gzip compressed data, was "HManage.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1253438       0x13203E      gzip compressed data, was "HOBA.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1254564       0x1324A4      gzip compressed data, was "HRouting.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1255864       0x1329B8      gzip compressed data, was "HSetup.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1257408       0x132FC0      gzip compressed data, was "HStatus.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1258783       0x13351F      gzip compressed data, was "HUpgrade.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1259855       0x13394F      gzip compressed data, was "HVPN.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1260808       0x133D08      gzip compressed data, was "HWEP.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
    1262621       0x13441D      gzip compressed data, was "HWireless.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
    1264097       0x1349E1      gzip compressed data, was "HWPA.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
    1265245       0x134E5D      gzip compressed data, was "InLog.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
    1266075       0x13519B      gzip compressed data, was "language.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1269311       0x135E3F      gzip compressed data, was "lastpassword.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1269507       0x135F03      gzip compressed data, was "Log.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1272546       0x136AE2      gzip compressed data, was "Manage.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1277123       0x137CC3      gzip compressed data, was "md5.js", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1278995       0x138413      gzip compressed data, was "Outbreak_Alert.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1282781       0x1392DD      gzip compressed data, was "OutLog.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1283619       0x139623      gzip compressed data, was "ping.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1287957       0x13A715      gzip compressed data, was "ptrigger.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1292450       0x13B8A2      gzip compressed data, was "qos.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1298667       0x13D0EB      gzip compressed data, was "Quarantined.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
    1300366       0x13D78E      gzip compressed data, was "reset.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009