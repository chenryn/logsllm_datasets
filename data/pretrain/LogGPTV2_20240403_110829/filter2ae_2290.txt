## **前沿**
前不久在整理以前的测试报告的时候，看到一个报告挺有意思的,单个技术点拿出来都很简单，但是凑在一起就getshell。看下测试时间过去了得有两年多了,至于修没修后来也没有关注了，下面的截图都厚码了，主要学习下思路吧，站点什么的都是次要的，大家就当个靶机站看吧
## **测试过程**
首先经过乱点,在burp的历史记录中找和后台交互的地方，很幸运的是遇到了一个可以SQL注入的地方，按照划水几年的经验判断这个站点已经凉了(打开sqlmap,获取后台用户名密码，再来个任意文件上传getshell交工下班)，然后第一步就卡住了，有WAF,果然事情没那么简单，经过简单的测试发现这个WAF并不是那么难绕,别的图没有了，附上个当时的tamper脚本吧  
成功的注入出了数据获取到了用户名和密码  
很遗憾的是高权限的管理员并不能解密出来，只解密出一个权限较低的账号的密码,有总比没有强，先登录进去看看吧  
登录进去之后呢尝试news的上传和图片缩略图更名功能，上传均以失败告终。  
看一下后台的url,发现url路由简洁明了,目前想到的思路是我们是否可以越权进行操作，越权获取用户名列表，然后将低权限用户提升到管理员权限  
经过简单的FUZZ,感觉都不用FUZZ，直接试试就可以了  
然后可以对用户名进行赋权  
接下来再次寻找可以上传的地方,发现编辑器处存在插入图片的功能,尝试上传下,任意文件上传，也许事情到这就结束了  
访问一下，报500错误，是限制了目录执行还马有问题呢  
看一下报文吧，发现报文存在很多参数，其中有疑似路径定义  
尝试更改此路径为admin目录，该目录肯定能执行php，不然这个站就是个假站，将报文重放  
上传成功，然后访问发现报错,应该是前面的WAF起作用了，  
接着上传一个免杀的一句话成功getshell,当时测试的时候还没有出现冰蝎 哥斯拉等加密流量的工具，估计当时如果有冰蝎的话可以直接秒了吧，时代在进步呀  
## **总结**
其实拿下这个站在仔细看用到的技术并没有什么骚操作，都是很常规的操作，简单的WAF绕过,越权,目录穿越，免杀绕过等等，只要细心都能发现，遇事多想想，也许就柳暗花明。