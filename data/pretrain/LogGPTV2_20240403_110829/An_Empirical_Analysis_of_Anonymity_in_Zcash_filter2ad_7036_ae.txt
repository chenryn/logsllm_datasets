1
0
2
1
2
0
200
0
0
0
0
0
0
0
0
1
1
2
0
0
0
0
3
1
400
0
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
500
0
0
0
0
0
0
0
0
0
0
0
1
0
0
0
1
0
Table 6: Number of clusters that put the required amounts
(±1 ZEC) into the shielded pool.
8.2 Results
Our results,
in terms of the number of transactions
matching our requirements above up until 17 January
2018, are summarized in Table 6. Before the ﬁrst TSB
blog post in May, we found only a single matching trans-
action. This is very likely a false positive, but demon-
strates that the types of transactions we were seeking
were not common before TSB went live with Zcash. Af-
ter the blog post, we ﬂagged ﬁve clusters in May and
June for the requested amount of 100 ZEC. There were
only two clusters that was ﬂagged for 500 ZEC, one of
which was from August. No transactions of any of the
required quantities were ﬂagged in September, despite
the fact that TSB switched to accepting only Zcash in
September. This is possible for a number of reasons:
our criteria may have caused us to miss transactions, or
maybe there were no takers. From October onwards we
ﬂagged between 1-6 transactions per month. It is hard to
know if these represent users paying for old data dumps
or are simply false positives.
Four out of the 24 transactions in Table 6 are highly
likely to be false positives. First, there is the deposit
of 100 ZEC into the pool in January, before TSB an-
nounced their ﬁrst blog post. This cluster put an addi-
tional 252 ZEC into the pool in March, so is likely just
some user of the pool. Second and third, there are two
deposits of 200 ZEC into the pool in June, before TSB
announced that one of the July dump prices would cost
200 ZEC. Finally, there is a deposit of 400 ZEC into the
pool in June before TSB announced that one of the July
dump prices would cost 400 ZEC.
Of the remaining clusters, there is one whose activ-
ity is worth discussing. From this cluster, there was one
deposit into the pool in June for 100 ZEC, one in July
for 200 ZEC, and one in August for 500 ZEC, matching
TSB prices exactly. The cluster belonged to a new user,
and most of the money in this user’s cluster came directly
from Bitﬁnex (Cluster 3).
9 Conclusions
This paper has provided the ﬁrst in-depth exploration of
Zcash, with a particular focus on its anonymity guaran-
tees. To achieve this, we applied both well-known clus-
tering heuristics that have been developed for Bitcoin and
attribution heuristics we developed ourselves that take
into account Zcash’s shielded pool and its unique cast
of characters. As with previous empirical analyses of
other cryptocurrencies, our study has shown that most
users are not taking advantage of the main privacy fea-
ture of Zcash at all. Furthermore, the participants who
do engage with the shielded pool do so in a way that is
identiﬁable, which has the effect of signiﬁcantly erod-
ing the anonymity of other users by shrinking the overall
anonymity set.
Future work
Our study was an initial exploration, and thus left many
avenues open for further exploration. For example, it
may be possible to classify more z-to-z transactions by
analyzing the time intervals between the transactions in
more detail, or by examining other metadata such as the
miner’s fee or even the size (in bytes) of the transac-
tion. Additionally, the behavior of mining pools could
be further identiﬁed by a study that actively interacts with
them.
Suggestions for improvement
Our heuristics would have been signiﬁcantly less effec-
tive if the founders interacting with the pool behaved in
a less regular fashion. In particular, by always withdraw-
ing the same amount in the same time intervals, it became
possible to distinguish founders withdrawing funds from
other users. Given that the founders are both highly in-
vested in the currency and knowledgeable about how to
use it in a secure fashion, they are in the best place to
ensure the anonymity set is large.
Ultimately, the only way for Zcash to truly ensure the
size of its anonymity set is to require all transactions to
take place within the shielded pool, or otherwise signiﬁ-
cantly expand the usage of it. This may soon be compu-
tationally feasible given emerging advances in the under-
lying cryptographic techniques [6], or even if more main-
stream wallet providers like Jaxx roll out support for z-
USENIX Association
27th USENIX Security Symposium    475
addresses. More broadly, we view it as an interesting reg-
ulatory question whether or not mainstream exchanges
would continue to transact with Zcash if it switched to
supporting only z-addresses.
Acknowledgments
We would like to thank Lustro, the maintainer of the
Zchain explorer, for answering speciﬁc questions we
asked about the service. The authors are supported in
part by EPSRC Grant EP/N028104/1, and in part by the
EU H2020 TITANIUM project under grant agreement
number 740558. Mary Maller is also supported by a
scholarship from Microsoft Research.
References
[1] Cryptocurrency
market
//coinmarketcap.com/.
capitalizations.
https:
[2] Dash. https://www.dash.org.
[3] Monero. https://getmonero.org.
[4] Shapeshift. https://shapeshift.io.
[5] The
Brokers.
Shadow
@theshadowbrokers.
https://steemit.com/
[6] What is Jubjub?
html.
https://z.cash/technology/jubjub.
[7] Zcash. https://z.cash.
[8] Zcash chain parameters.
zcash/blob/v1.0.0/src/chainparams.cpp#L135-L192.
https://github.com/zcash/
[9] Zcash faqs. https://z.cash/support/faq.html.
[10] Zchain explorer. http://explorer.zcha.in/.
[11] Alphabay will accept Zcash starting July 1st, 2017. Dark-
NetMarkets Reddit post, 2017. https://www.reddit.com/
r/DarkNetMarkets/comments/6d7q81/alphabay_will_
accept_zcash_starting_july_1st_2017/.
[12] E. Androulaki, G. Karame, M. Roeschlin, T. Scherer, and S. Cap-
kun. Evaluating user privacy in Bitcoin. In A.-R. Sadeghi, editor,
FC 2013, volume 7859 of LNCS, pages 34–51, Okinawa, Japan,
Apr. 1–5, 2013. Springer, Heidelberg, Germany.
[13] E. Ben-Sasson, A. Chiesa, C. Garman, M. Green, I. Miers,
E. Tromer, and M. Virza. Zerocash: Decentralized anonymous
In 2014 IEEE Symposium on Security
payments from Bitcoin.
and Privacy, pages 459–474, Berkeley, CA, USA, May 18–21,
2014. IEEE Computer Society Press.
[14] G. Bissias, A. P. Ozisik, B. N. Levine, and M. Liberatore. Sybil-
In Proceedings of the 13th Work-
resistant mixing for Bitcoin.
shop on Privacy in the Electronic Society (WEIS), pages 149–158,
2014.
[15] J. Bonneau, A. Narayanan, A. Miller, J. Clark, J. A. Kroll, and
E. W. Felten. Mixcoin: Anonymity for Bitcoin with accountable
In N. Christin and R. Safavi-Naini, editors, FC 2014,
mixes.
volume 8437 of LNCS, pages 486–504, Christ Church, Barbados,
Mar. 3–7, 2014. Springer, Heidelberg, Germany.
[16] J. Buntinx.
The Shadow Brokers only accept ZCash pay-
https:
ments for their monthly dump service, May 2017.
//themerkle.com/the-shadow-brokers-only-accept-
zcash-payments-for-their-monthly-dump-service/.
[17] J. Dunietz.
The Imperfect Crime:
naCry Hackers Could Get Nabbed, Aug. 2017.
//www.scientificamerican.com/article/the-
imperfect-crime-how-the-wannacry-hackers-could-
get-nabbed/.
How the Wan-
https:
[18] I. Eyal. The miner’s dilemma. In 2015 IEEE Symposium on Secu-
rity and Privacy, pages 89–103, San Jose, CA, USA, May 17–21,
2015. IEEE Computer Society Press.
[20] C. Farivar and J. Mullin.
[19] Y. J. Fanusie and T. Robinson. Bitcoin laundering: An analysis of
illicit ﬂows into digital currency services, Jan. 2018. A memoran-
dum by the Center on Sanctions and Illicit Finance and Elliptic.
Stealing bitcoins with badges:
How Silk Road’s dirty cops got caught, Aug. 2016. https:
//arstechnica.com/tech-policy/2016/08/stealing-
bitcoins-with-badges-how-silk-roads-dirty-cops-
got-caught/.
[21] E. Heilman, L. Alshenibr, F. Baldimtsi, A. Scafuro, and S. Gold-
berg. TumbleBit: an untrusted Bitcoin-compatible anonymous
payment hub. In Proceedings of NDSS 2017, 2017.
[22] A. E. Kosba, A. Miller, E. Shi, Z. Wen, and C. Papaman-
thou. Hawk: The blockchain model of cryptography and privacy-
preserving smart contracts. In 2016 IEEE Symposium on Security
and Privacy, pages 839–858, San Jose, CA, USA, May 22–26,
2016. IEEE Computer Society Press.
[23] A. Kumar, C. Fischer, S. Tople, and P. Saxena. A traceability
In Proceedings of ESORICS
analysis of Monero’s blockchain.
2017, pages 153–173, 2017.
[24] G. Maxwell. CoinJoin: Bitcoin privacy for the real world.
bitcointalk.org/index.php?topic=279249, Aug. 2013.
[25] S. Meiklejohn and R. Mercer. M¨obius: Trustless tumbling for
transaction privacy. Proceedings on Privacy Enhancing Tech-
nologies, 2018.
[26] S. Meiklejohn and C. Orlandi. Privacy-enhancing overlays in Bit-
coin.
In M. Brenner, N. Christin, B. Johnson, and K. Rohloff,
editors, FC 2015 Workshops, volume 8976 of LNCS, pages 127–
141, San Juan, Puerto Rico, Jan. 30, 2015. Springer, Heidelberg,
Germany.
[27] S. Meiklejohn, M. Pomarole, G. Jordan, K. Levchenko, D. Mc-
Coy, G. M. Voelker, and S. Savage. A ﬁstful of bitcoins: char-
acterizing payments among men with no names. In Proceedings
of the 2013 Internet Measurement Conference (IMC), pages 127–
140, 2013.
[28] I. Miers, C. Garman, M. Green, and A. D. Rubin. Zerocoin:
Anonymous distributed E-cash from Bitcoin. In 2013 IEEE Sym-
posium on Security and Privacy, pages 397–411, Berkeley, CA,
USA, May 19–22, 2013. IEEE Computer Society Press.
[29] A. Miller, M. M¨oser, K. Lee, and A. Narayanan.
An
empirical analysis of linkability in the Monero blockchain.
arXiv:1704.04299, 2017.
https://arxiv.org/pdf/1704.
04299.pdf.
[30] P. Moreno-Sanchez, M. B. Zafar, and A. Kate. Listening to whis-
pers of Ripple: Linking wallets and deanonymizing transactions
in the Ripple network. Proceedings on Privacy Enhancing Tech-
nologies, 2016(4):436–453, 2016.
[31] M. M¨oser and R. B¨ohme. Join me on a market for anonymity. In
Proceedings of the 15th Workshop on the Economics of Informa-
tion Security (WEIS), 2016.
[32] M. M¨oser and R. B¨ohme. Anonymous alone? measuring Bit-
coin’s second-generation anonymization techniques. In Proceed-
ings of IEEE Security & Privacy on the Blockchain, 2017.
[33] M. M¨oser, R. B¨ohme, and D. Breuker. An inquiry into money
laundering tools in the Bitcoin ecosystem. In Proceedings of the
APWG E-Crime Researchers Summit, 2013.
476    27th USENIX Security Symposium
USENIX Association
[34] S. Nakamoto. Bitcoin: A Peer-to-Peer Electronic Cash System,
2008. bitcoin.org/bitcoin.pdf.
[35] S. Noether, A. Mackenzie, and the Monero Research Lab. Ring
conﬁdential transactions. Ledger, 1:1–18, 2016.
[36] J. Quesnelle.
arXiv:1712.01210, 2017.
01210.pdf.
On the linkability of Zcash transactions.
https://arxiv.org/pdf/1712.
[37] F. Reid and M. Harrigan. An analysis of anonymity in the Bitcoin
system. In Security and privacy in social networks, pages 197–
223. Springer, 2013.
[38] D. Ron and A. Shamir. Quantitative analysis of the full Bitcoin
In A.-R. Sadeghi, editor, FC 2013, volume
transaction graph.
7859 of LNCS, pages 6–24, Okinawa, Japan, Apr. 1–5, 2013.
Springer, Heidelberg, Germany.
[39] T. Rufﬁng, P. Moreno-Sanchez, and A. Kate. CoinShufﬂe: Prac-
tical decentralized coin mixing for Bitcoin. In M. Kutylowski and
J. Vaidya, editors, ESORICS 2014, Part II, volume 8713 of LNCS,
pages 345–364, Wroclaw, Poland, Sept. 7–11, 2014. Springer,
Heidelberg, Germany.
[40] M. Spagnuolo, F. Maggi, and S. Zanero. BitIodine: Extracting in-
telligence from the Bitcoin network. In N. Christin and R. Safavi-
Naini, editors, FC 2014, volume 8437 of LNCS, pages 457–468,
Christ Church, Barbados, Mar. 3–7, 2014. Springer, Heidelberg,
Germany.
[41] L. Valenta and B. Rowan. Blindcoin: Blinded, accountable
mixes for Bitcoin. In M. Brenner, N. Christin, B. Johnson, and
K. Rohloff, editors, FC 2015 Workshops, volume 8976 of LNCS,
pages 112–126, San Juan, Puerto Rico, Jan. 30, 2015. Springer,
Heidelberg, Germany.
USENIX Association
27th USENIX Security Symposium    477