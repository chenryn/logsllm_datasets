10.2..·志析..
10.2...n.r.探针部署..
10.2.2典型攻击日志举例
10.2.1基于文本的格式
Snor.·志分析
10.1...n.or.的.不.….
10.1.4维护Sno.or.…….
10.1.3
10.1.2
10.1.1作.
疑难解答
知道是什么系统漏洞导致攻击者成功提升了用户权限？
服务器的日志到 Snort 的日志开始分析，逐步掌握了攻击者的入侵方式和手段。你
技术员小孙面对入侵系统的不速之客，开展了一系列的日志取证工作，从IIS
敌，有时在高明的入侵者眼里，一个Snort系统如同马其诺防线一样形同虚设。
企业网部署了IDS系统，并不代表万事大吉了。IP碎片攻击依然是IDS的大
深入了解Snort.
目录XVII
.............
....
..........
270
120
1.
267
---
## Page 20
第11章
XVIIUNIX/Linux网络日志分析与流量监控
085
品
1...例.·..受的.....
12.1..加密和解密
11....中.BY.D.的.隐..
11.2.2用开源NAC阻止非法网络访问
11.2..I.I..·的.收..
寻找非法接点
11.1.1WLAN主要安全漏洞
使用监控软件获取一手日志信息，终于找到了问题所在。
会议进行没多久，WLAN就出现了意外，网络时断时续，会场里到处是抱怨声。他通过
会采取什么措施快速定位非法接入点？
地址。你知道攻击者是如何突破公司无线网的访问控制的？又是如何入侵VPN的？你
来。经过各类日志筛查对比，最后，他顺藤摸瓜找到了那个来自公司外部无线VPN的
安全工程师林峰为保证会议的无线网络顺畅，架设了Radius无线认证系统，可是
马超根据IDS报警发现公司内网财务网段的服务器端口被人扫描，顿时警觉起
中间人攻击使得SSH连接不再安全。杨芳在参加一个国际安全会议期间，发送
.......
---
## Page 21
第13章..络流量监控
2
13.5网络噢探器的检测及预防
13.2用NetFlow分析网络异常流量
13.网络监听关键技术..
13..用.层数据包解码.
13...MwareES.i服务监控.
13...噢探.的.测.
13.4..深入分析Xic.
13.4.5
13.4.4
13.4.3
13.2.5NetFlow在蠕虫病毒监测中的应用..
13.2..NetFlow.的性能影·.....
13.2..Net.Flow.的抽样.......
13.2.NetFlow的输出格.
13.2.1Net.low.的.C.ache管...
13.1..P.N.的.局限.
13.1.6网络数据流采集技术
13.1.5
13.1.4
13.1.3
13.1.2
预防措施
一种RP·.欺骗的预防措施
MITM.通常用.的.
公钥出错有联系吗？她的网络到底遭到了什么攻击？
志中发现任何可疑之处。她用抓包工具分析发现网络中存在大量广播包，这和交换
邮件时发现交换公钥出现导入错误。但是杨芳并没有在 HIDS 系统和 SSH 的连接日
应.ico..
3Xplico的数据获取方法.
协议和应用识别
监听关键技.·
SNMP.的不.足.
NetFlow.与.low.的别.
第三篇
网络流量与日志监控
MIP20
I目录XIX
.330
---
## Page 22
第14章·.SSIM综合应用
XXUNIX/Linux 网络日志分析与流量监控
14.8.SSIM·志管理平·
14.使用OSSIM系统
14.OSSIM.构与原理
14.·..SSIM..
14..SSM.的..
14.7.SSIM关联分析技术.
14...评估方法·
14.4
13..网络噢探的预防.
14.7.2OSSIM的通用关联检测规则
14.6.2OSSIM系统风险度量
14...风险评三要素
14.5.2SIEM事件控制台·
14..无.悉主界….
14.2..OSSIM工作流程分析
14.1.3安全信息和事件管理（SIEM）
14.8...SSM..
14.8.3通过WMI收集Windows日志…
14.......................
14.8..OSSIM志处理流程
14.·联….
14.4.8安装X-Window..
14.4.7安装远程管理工具
14.4.6同步OpenVAS插件
14.4.防火墙设置.
14.4..统升..
14.4..间·步.题
14.3.4OSSIM系统安装步骤
14.3.2OSSIM服务器的选择….
14.3.1.作.
14.2..RRD.图..
14.2..Agent.件.
14.2...SM....
14.1..从.IM到·..SIM..
14.4.5
14.4.4
OSSIM安装后续工作
14.3.3分布式OSSIM系统探针布署·
OSSIM数据库分析工具
访问数据库
.350
..
......
......
......
.......
......
.......
.....
.....
...*.
.....
.....
380
13
360
3
352
38
30
3
S
---
## Page 23
14.15常见OSSIM应用.问.
14.14OSSIM在漏洞扫描中的应用.
14.13
14.12OSSIM在蠕虫预防中的应用..
14.11OSSIM应用资产管理.
14.10OSSIM流量监控工具应用..
14.9OSSIM系统中的IDS应用.
14.10.....
14.9.4OSSEC代理监控的局限.
14.14.6在Metasploit 中加载Nessus.
14.14..Met.soit的渗透测.
14..14..布式漏洞扫
14.14..采用Op.enV..扫描.
14.14..漏洞库.
14.14..漏洞评估方法
14.11....安装与使用.
14.11.1OCS InventoryNG架构...
14.10.8与第三方监控软件集成
14.10..N.ios.监，....
14.10...络气图
14.10.4N.op故障排除.
14.10.·.·..
14.10...op.监控.
14.9.3在ESXi中安装OSSEC..
14.9.2OSSEC HIDS Agent 安装.
14.9..HIDSNID....
14.8.5Snare与WMI的区别.
监测..ode.........
目录XXI
........4
....
.............
.....
.....
......
419
418
---
## Page 24
每个级别对应不同的核心程序所产生的日志。
名、IP 地址和优先级等。syslog 优先级可以分为 0、1、2、3、4、5、6 和 7 级共 8 个级别,
日志文件的内容通常以ASCII文本形式存在，一般由以下几部分组成：日期、时间、主机
（第3章将详细讲解这部分内容）。
自动利用syslog向/var/log/messages 文件中进行记录添加，用来向用户报告不同级别的事件
务）实现操作。它由各个应用系统（例如Http、Ftp、Samba等）的守护进程、系统内核来
计情况。
够记录系统中各个基本的服务，可以有效地记录与提供相应命令在某一系统中使用的详细统
止，系统就能够自动记录该进程，并在进程统计的日志文件中添加相应的记录。该类日志能
书中很多网络取证案例都会涉及这两个登录文件。
在何时登录过系统，一旦触发login等程序，就会对wtmp和utmp文件进行相应的更新。本
下，将对应的记录写到/var/log/wtm和/var/run/utmp中。为了使系统管理员能够有效地跟踪谁
1.1.1UNIX/Linux系统日志
本节仅对各种系统日志做一个分类，其细节在1.2节～1.14节中讲解。
等）、网络设备日志（路由交换设备、安全设备）、应用系统日志（Web等各种网络应用）。
日志。学习好本章内容，将为后续章节的案例分析打下良好的基础。
查找如此海量的数据，对管理员来说如同一场噩梦。本章将介绍如何获取并分析各类系统的
SQL 数据库等。各种复杂的应用系统和网络设备每天都产生大量的日志，如果不加以处理，
（2）进程统计日志子系统：主要由系统的内核来实现完成记录操作。如果一个进程终
1.1
（1）基于 syslogd 的日志文件。该类型主要采用 Syslog 协议和 POSIX 标准进行定义，其
本书把网络环境中各种复杂的日志分为三类：操作系统日志（UNIX/Linux，Windows
UNIX/Linux系统的主要日志文件格式表述如下：
（1）登录时间日志子系统：登录时间日志通常会与多个程序的执行产生关联，一般情况
企业信息系统中会包含多种设备，如路由器、防火墙、IDS/IPS、交换机、服务器和
UNIX/Linux的系统日志能细分为三个日志子系统：
网络环境日志分类
第1章网络日志获取与分析
第一篇日志分析基础
---
## Page 25
件。构成该日志的内容主要包括：各种对系统进行登录与退出的成功或者不成功信息；对系统
比较复杂，但内容主要是ASCII 文本，涉及进程名、邮件代号、日期、时间、操作过程的各
大时，通过过滤等方法就可以找出感兴趣的关键字。但如果服务日志需要归档处理就不可行
志文件；再比如/var/log/samba是由Samba服务产生的日志文件；这种存储方式在日志量不
录下，我们会看到很多熟悉的名字，比如/var/log/httpd/access_log 是由 Apache 服务产生的日
理。大部分应用层的日志默认会存储在/var/log/messages 目录下，如图 1-1 所示。在这个目
行统一发送，并由 syslogd 最终进行统一的处理。该类型的日志文件能够参考 syslogd 进行处
到目前为止，大多数UNIX/Linux系统中，运行的程序会自动将对应的日志文件向 syslogd 进
2UNIX/Linux 网络日志分析与流量监控
题
行中产生的各种事件。这些事件一般可以分为：系统中各种驱动程序在运行中出现的重大问
管理员来说这三类日志要熟练掌握。
1.1.2
种相关信息。
使用时间等。
存储（无法使用vi等编辑器直接打开），记录内容主要有：用户名、终端号、登入IP、登入
了。下面几节中将给出解决方法。
、操作系统的多种组件在运行中出现的重大问题以及应用软件在运行中出现的重大问题
（1）系统日志。主要是指Windows2003/Windows7等各种操作系统中的各个组件在运
2）系统中的邮件服务器在运行的时候需要进行记录的日志mailog，它的文件格式通常
在Windows 操作系统中，日志文件包括：系统日志、安全日志及应用程序日志，对于
1）对各个终端的登录人员进行记录的日志信息lastlog。
（2）应用程序产生的日志文件。这种类型的日志文件通常是ASCII码的文本文件格式。