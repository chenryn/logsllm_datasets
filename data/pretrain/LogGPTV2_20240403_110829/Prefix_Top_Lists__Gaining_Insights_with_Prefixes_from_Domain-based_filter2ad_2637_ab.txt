20
140.205.130.0/24
99.84.88.0/21
99.84.92.0/24
23.227.38.0/23
23.227.38.0/24
AS15169 – GOOGLE
AS16509 – AMAZON-02
AS13335 – CLOUDFLARE
AS BGP Norm Object
AS37963 – CNNIC-ALIBABA
140.205.64.0/18
140.205.94.0/24
140.205.128.0/18
172.217.23.0/24
216.58.208.0/24
216.58.204.0/23
172.217.18.0/24
172.217.16.0/24
172.217.22.0/24
216.58.206.0/23
Weight Domains
103264
0.1454
1039
0.0178
1000
0.0175
0.0173
1041
973
0.0165
726
0.0151
775
0.0164
443
0.0154
547
0.0098
0.0097
547
310574
0.1049
42809
0.0045
42809
0.0045
88373
0.0651
0.0057
11988
11951
0.0054
7266
0.0478
6
0.0160
3
0.0159
12
0.0116
0.0113
1
16752
0.0284
4566
0.0063
0.0032
2895
46028
0.0248
434
0.0008
0.0006
2
866
0.0238
9
0.0092
7
0.0092
457
0.0150
3
0.0134
0.0134
1
21685
0.0141
3941
0.0034
10
0.0016
81
0.0138
7
0.0096
0.0092
6
IPs
15278
35
33
42
35
21
23
14
15
15
91869
13
13
70888
168
132
6733
4
2
12
1
887
192
76
33443
295
2
821
5
3
451
4
2
10035
1992
1
77
3
1
Table 2: IPv4 Object Ranking for August 1, 2019 based on
Alexa List. If both BGP- and Norm-Rank are provided the
weight is given for the BGP prefix. The weight for the normal-
ized prefix can differ due to varying splitting of the domain
weights if multiple objects are reached.
220.181.38.0/24
AS4837 – CHINA169
AS14618 – AMAZON-AES
AS23724 – CHINANET
AS8075 – MICROSOFT
AS9808 – CMNET-GD
151.101.0.0/22
151.101.1.0/24
AS54113 – FASTLY
220.181.32.0/19
54.235.145.0/24
111.161.64.0/24
2
3
4
5
6
7
8
9
39.156.0.0/17
39.156.69.0/24
13.64.0.0/11
13.82.28.0/24
13
8
59
14
14
8
38
12
111.160.0.0/13
54.234.0.0/15
10
multiple prefixes), the input weight is split between the targeted
prefixes. This serves to keep the sum of weights at one (100%). An
alternative would be to copy the weight to all prefixes. This variant
is susceptible to manipulation: a domain can point to a multitude
of prefixes and each gets the full zone weight. High ranking zones
with fewer addresses would have less influence on the prefix top
list. To remediate these problems, we decided to split the weight.
We generate our prefix top list by aggregating IP addresses to
prefixes with the Zipf weights of a domain top list.
The rankings for the top 10 ASes, BGP prefixes, and normalized
prefixes are shown in Table 2. For each object, we include the top
ranked children, if applicable. The /24 norm-prefixes are weighted
and ranked by summing up the weight of all domains pointing to
them. Norm-prefixes are assigned to their AS by mapping them to
announced BGP prefixes. The AS weight (and therefore its rank)
is the sum of the BGP prefix weights. For example, the domain
tmall.com transfers its weight of 0.0226 from Table 1 to its A-records
which are in the prefixes 140.205.94.0/24 and 140.205.130.0/24.
Figure 1: Coverage runup of discovered prefixes by prefix top
list (PTL) per IP version over time.
The resulting rankings are our Prefix Top Lists, which present a
novel view on the importance of IP prefixes in the Internet.
The ranking does not only export the weight, but also exports
how many domains point into the respective object, as well as how
many distinct IP addresses of those objects are referenced. Notably,
some ASes have many domains pointing to them (e.g., Cloudflare).
Other ASes also have a high rank but host only few comparatively
high-ranked domains (e.g., CNNIC-ALIBABA).
3 ANALYZING PREFIX TOP LISTS
In this section we analyze prefix top lists based on BGP announced
prefixes (1) by evaluating the increase caused by daily new prefixes
added to prefix top lists and (2) by comparing their stability over
time to regular domain-based top lists.
3.1 Daily New Prefixes
We first evaluate prefixes which have not yet been seen before for
each prefix top list. This analysis shows how much data needs to
be collected over time to achieve good prefix coverage.
In Figure 1 we depict the incremental coverage of generated pre-
fix top lists for each day. We find that all prefix top lists contribute
multiple ten-thousands of IPv4 prefixes and multiple thousands of
IPv6 prefixes on the first day. The share of prefixes seen on the first
day compared to all prefixes seen over the measurement period,
differs by source. We find that Alexa provides the best coverage of
IPv4 prefixes, whereas Umbrella covers most IPv6 prefixes. Inter-
estingly, Majestic has the lowest coverage in IPv4 as well as IPv6
and sees almost no increase over time. New prefixes are still added
even after five month of measurements (e.g., ≈ 200 for Alexa IPv4
and Umbrella IPv4). These new trends are side-effects of the highly
volatile nature of domain-based top lists [21], the initial source of
prefix top lists.
When looking at Figure 2 we see that the new prefixes added
after the first day stem with few exceptions, such as wikipedia.org
on June 27, 2019, from low-ranked domains. The figure shows the
2019-04-012019-04-152019-05-012019-05-152019-06-012019-06-152019-07-012019-07-152019-08-012019-08-152019-09-010.00.20.40.60.81.0RunupofcoveredpreﬁxesovertimePTL(IPv4)basedonAlexaPTL(IPv4)basedonMajesticPTL(IPv4)basedonUmbrellaPTL(IPv6)basedonAlexaPTL(IPv6)basedonMajesticPTL(IPv6)basedonUmbrellaIMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Naab, Sattler, Jelten, Gasser, and Carle
Figure 2: Cumulative Zipf weight of new prefixes per prefix
top list (PTL) over time. The jump on June 27, 2019 is caused
by previously unseen prefixes for Wikipedia.
Figure 3: Daily Zipf weight changes for domain and prefix
top lists (PTLs) over time.
empirical CDF of the sum of Zipf weights added by new prefixes
over time, i.e., it displays how important the newly added prefixes
are. Newly added prefixes generally host low-ranked domains as is
evident by the Zipf weight increase of less than 0.014 over more
than one month of measurements and 0.045 in five months. We
also find that new prefixes in the Umbrella-based prefix top lists are
about four times less important in terms of aggregated Zipf weight
over time compared to Alexa and Majestic.
We conclude that prefix top lists see hundreds to thousands of
new prefixes being added even after multiple weeks. These pre-
fixes, however, stem from low-ranked domains, while high-ranked
prefixes are added on day one.
3.2 Temporal Stability
Next, we assess the stability of different domain and prefix top lists
over time. To account for weekly patterns, which have been shown
to be present in top lists [21], we aggregate domain and prefix top
lists in a seven-day rolling window. We then calculate the daily Zipf
weight change for each domain and prefix, respectively.
Figure 3 shows the daily Zipf weight change during our four-
month measurement period. To better illustrate the magnitude of
changes, we lay out the following example: Assume, on Monday
the complete Zipf weight of 1.0 is given to prefix A, whereas on
Tuesday the complete Zipf weight of 1.0 is given to prefix B. This
constitutes a change of -1 for prefix A and a change on +1 for prefix
B. In this example the daily Zipf weight change between Monday
and Tuesday is 2, which is the maximum possible Zipf change per
day.
As seen in Figure 3, Zipf weight changes are much more subtle in
reality. None of the domain and prefix top lists sees consistent Zipf
weight changes above 0.1. The least stable top list is the domain-
based Alexa top list, which confirms findings in related work [21].
The most stable top list is the IPv6 prefix top list based on Umbrella.
We find that IPv6 prefix top lists are especially stable. The Alexa and
Majestic-based prefix top lists are comparatively volatile. This is
likely due to high-weight domains performing DNS load balancing,
which leads to Zipf weights being shifted to different prefixes.
To summarize, Zipf weight changes in all top lists are much
smoother compared to raw domain-based top lists, with less than
0.1 of weight changes. The Alexa domain top list is the least stable,
whereas IPv6 prefix top lists exhibit the greatest stability. The Alexa
domain top list became even more unstable over time, especially
since it often includes less than 1M domains. Starting from July
14, 2019, the list contains only about 600k to 950k domains. We
assume, that this is likely due to Alexa updating its generation
method and dropping the tail of domains with unreliable ranks.
The lower number of domains is automatically accounted for in
our Zipf weighting. The sum of all weights remains 1, therefore
the importance of domains is dynamically adjusted to the number
of provided domains. Nevertheless, adding or deleting up to 300k