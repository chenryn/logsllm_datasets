状态信息是指被采集设备所处的状况，可由一组变量来表征。状态信息直接表达设备系统的运行状况，因此，该类信息无论设备负载高低，都应进行实时采集、实时上传，不能发生断点。
状态信息范围包括以下内容：
  -----------------------------------------------------------------------------
  序号   数据名称           设备类型      操作系统                    备注
  ------ ------------------ ------------- --------------------------- ---------
         网络端口管理状态   服务器        全部                        
         进程ID             服务器        全部                        
         进程名称           服务器        全部                        
         执行路径           服务器        全部                        
         执行参数           服务器        全部                        
         进程类型           服务器        全部                        
         目标网络           服务器        全部                        
         端口状态           服务器        全部                        
         进程状态           服务器        全部                        
         主机状态           服务器        全部                        
         风扇状态           服务器        全部                        
         温度               服务器        全部                        
         电源状态           服务器        全部                        
         电源电压           服务器        全部                        
         物理磁盘状态       服务器        全部                        
         物理内存状态       服务器        全部                        
  -----------------------------------------------------------------------------
## 性能信息
性能信息是指被采集设备在运行期间的负载情况。实时性要求不高，因此，应视业务系统压力进行采集频度和上传频度的动态调整。
性能信息范围包括以下内容：
+--------+--------------------+-------+--------------------+---------+
| 序号   | 数据名称           | 设备  | 操作系统           | 备注    |
|        |                    | 类型  |                    |         |
+========+====================+=======+====================+=========+
| 1.     | 健康运行时长       | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 2.     | 主机CPU平均使用率  | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 3.     | 内存使用率         | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 4.     | 磁盘分区使用率     | 服    | window             |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 5.     | 当前进程数         | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 6.     | 单个CPU的利用率    | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 7.     | 虚拟内存使用率     | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 8.     | idleCPU使用率      | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 9.     | sysCPU使用率       | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 10.    | userCPU使用率      | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 11.    | niceCPU使用率      | 服    | 全部               |         |
|        |                    | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 12.    | 单                 | 服    | 全部               |         |
|        | 个进程的CPU使用率  | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 13.    | 单个               | 服    | 全部               |         |
|        | 进程的内存占用大小 | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 14.    | 文件系统使用率     | 服    | Aix/HpU            |         |
|        |                    | 务器  | nix/Linux/其他UNIX |         |
+--------+--------------------+-------+--------------------+---------+
| 15.    | Swap分区使用率     | 服    | Aix/HpU            |         |
|        |                    | 务器  | nix/Linux/其他UNIX |         |
+--------+--------------------+-------+--------------------+---------+
| 16.    |                    |       |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 17.    | 端口流量           | 服    | 全部               |         |
|        | （接收、发送、总） | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 18.    | 端口丢包率         | 服    | 全部               |         |
|        | （接收、发送、总） | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
| 19.    | 端口错包率         | 服    | 全部               |         |
|        | （接收、发送、总） | 务器  |                    |         |
+--------+--------------------+-------+--------------------+---------+
## 安全信息
从数据表现形式上看，基本信息、状态信息和性能信息主要是数值形式或具有明确含义的简单字符，而安全信息包括了日志、事件、策略等信息，多为成段的文本信息，含义比较复杂，且在不同操作系统下，具有不同的组成。因此，在采集和传输时，应根据需要，对信息文本进行提取和加工，使之形成具有较为明确意义的结构化数据。
安全信息范围包括以下内容：
  -----------------------------------------------------------------------------
  序号   数据名称               设备类型               操作系统    备注
  ------ ---------------------- ---------------------- ----------- ------------
  1      账号／密码策略         终端/服务器/网络设备   全部        
  2      登录／操作事件         终端/服务器/网络设备   全部        
  3      权限策略               终端/服务器/网络设备   全部        
  4      系统日志／事件信息     终端/服务器/网络设备   全部        
  5      业务与数据库访问日志   终端/服务器/网络设备   全部        
  6      防病毒／木马信息       终端/服务器/网络设备   全部        
  7      合规信息               终端/服务器/网络设备   全部        
  -----------------------------------------------------------------------------
## 采集信息扩展策略
安全Agent应具备随业务需要进行采集项目扩展的能力，扩展通过动态链接库（在Linux系统下为SO文件，在Windows系统下为DLL文件）实现数据的采集功能函数，由Agent主程序通过脚本对采集函数进行调用。采集内容为：在操作系统中，可通过命令、程序能够获取的，与设备、应用运行相关的，可用UTF8进行编码的数据信息。
在脚本中应至少包括如下声明：
-   脚本防篡改签名：通过代码评审认证机构颁发的哈希校验码。
-   采集频度定义：定义该任务的采集频度，最小为1秒，最大为1月。
-   优先度定义：定义该数据在采集、上传时的优先等级，视具体扩展采集内容确定，分为3级。
```{=html}
```
-   1级－数据非常重要，需要在第一时间采集、上传，不可有断点；
-   2级－数据比较重要，在系统资源紧张、网络繁忙时，可延迟采集、上传，但不可有断点。对秒、分钟级采集频度来说，采集延迟不超过2/3个周期，上传延迟不超过2个周期，其它以小时、日、周、月级采集频度的，均应在本周期内进行采集、上传。
-   3级－数据重要程度一般，在系统繁忙时，可不进行采集，允许有断点。
```{=html}
```
-   采集任务入口：声明Agent主程序的调用入口。
# 控制规范
安全Agent可以接受来自管理节点的对受控设备进行操作的控制指令，控制指令应通过Agent插件进行封装，以保证其安全性，避免高危指令的执行。控制指令应实现以下功能：
## 服务器控制
  -------------------------------------------------------------------------
  序号   指令类别   设备类型    操作系统    备注
  ------ ---------- ----------- ----------- -------------------------------
  1      进程管理   服务器      全部        指定进程（组）启动、停止
  2      文件管理   服务器      全部        指定文件（组）拷贝、删除
  3      配置管理   服务器      全部        指定配置文件的修改
  -------------------------------------------------------------------------
## 桌面终端控制
  -------------------------------------------------------------------------
  序号   指令名称   设备类型   操作系统   备注
  ------ ---------- ---------- ---------- ---------------------------------
  1      进程管理   PC         Windows    指定进程（组）启动、停止
  2      文件管理   PC         Windows    指定文件（组）拷贝、删除
  3      配置管理   PC         Windows    指定配置文件的修改
  4      网络管理   PC         Windows    网卡配置管理、阻断
  -------------------------------------------------------------------------
## 控制指令扩展策略
安全Agent应具备随业务需要进行采集项目扩展的能力，扩展通过动态链接库（在Linux系统下为SO文件，在Windows系统下为DLL文件）封装指令功能函数，由Agent主程序通过脚本对指令函数进行调用。指令内容为在操作系统中，可通过命令、程序能够执行的，与设备、应用运行相关的命令或API。
在脚本中应至少包括如下信息：
-   脚本防篡改签名：通过代码评审认证机构颁发的哈希校验码。
-   指令入口：声明Agent主程序的调用入口。
# 非功能性规范