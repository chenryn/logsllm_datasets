### 云环境自动化入侵溯源实战

**演讲者：徐越，阿里云安全工程师**

#### 个人简介
- **昵称**: @cdxy_
- **职位**: 安全工程师，阿里云
- **专业领域**: 企业安全、入侵检测与响应
- **兴趣爱好**: 数据分析、机器学习

#### 演讲概要
在现代网络安全环境中，快速响应是衡量企业安全能力的关键指标。面对潜在威胁时，我们需要迅速判断是否为误报，并进一步探究以下问题：
- 是否存在漏洞？
- 攻击路径是什么？
- 黑客的背景和目的为何？
- 哪些资产和账户受到影响？
- 泄露了哪些数据？
- 是否涉及内部违规操作？

#### 当前挑战
1. **告警处理**
   - 大量日志（例如200GB）需要审查。
   - 高比例（约99%）的误报增加了工作负担。

2. **安全运营现状**
   - 数据缺失
   - 系统间缺乏集成
   - 依赖人工搜索和分析

#### 自动化入侵回溯解决方案
我们的目标是通过自动化技术解决上述问题，具体包括以下几个方面：
- **多源异构数据的知识表达**
  - 采集：采用云原生的数据采集方案，覆盖超过90%的事件调查需求。
  - 计算：支持千万级RPS实时流计算，自动识别相关入侵信息。
  - 交互：使用图结构可视化方法展示入侵路径，去除冗余信息，仅呈现关键内容。

- **行为抽象与关系构建**
  - 将具体攻击行为转化为实体，详细描述入侵过程。
  - 例如，黑客IP (x.x.x.x) 对服务器IP (x.x.x.x) 发起攻击，利用漏洞执行恶意代码并写入文件。
  - 不仅基于现有日志被动建立联系，还通过主动推理修复断链，增强关联性。

- **案例分析**
  - Watchbog蠕虫回溯
  - JIRA模板注入(CVE-2019-11581)
  - Solr RCE(CVE-2017-12629)
  - SSH暴力破解
  - CouchDB RCE(CVE-2018-8007)

- **常见植入手段**
  - 挖矿程序：SSH/RDP登录后写入、WebLogic RCE等
  - WebShell：表单文件上传、老马上传新马、WordPress插件写入等

- **宏观统计**
  - 自动捕捉零日漏洞，如Jenkins RCE (CVE-2019-1003000)，首次发现于2019年1月30日；WebLogic RCE (CVE-2019-2725)，首次记录于同年4月17日。

#### 存在的问题及未来方向
- **数据层面**：复杂网络拓扑和内网环境下的数据获取难题。
- **计算层面**：长时间窗口内的数据分析及复杂模型训练。
- **对抗层面**：防止Agent被破坏或绕过。

#### 问答环节
欢迎提问！
- 微信/微博账号: cdxy000, cdxy_