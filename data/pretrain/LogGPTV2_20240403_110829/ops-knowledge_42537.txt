User: 请回答以下安全问题TLS服务器是否已完成服务器签名？我正在探索TLS的一些非正交用途进行研究。我想知道TLS服务器Finished由服务器签名是否正确。

Assistant: 我认为最好概括为：
“完成”消息使用会话密钥加密。
或
Finish消息包含握手记录上的HMAC，使用会话密钥进行加密。
正如@dave_thompson在评论中指出的那样，这基本上相当于对成绩单进行签名（尽管Finish消息本身没有签名）。
以下是我对TLS完成消息的理解（@Steffen，@forest，@dave_thompson，请随时更正我的理解）。
TLS 1.2（RFC 5246）
第7.4.9节“完成”给出了以下内容：
此消息的含义：
Finished消息是第一个使用
协商的算法、密钥和秘密。已完成的收件人
消息必须验证内容是否正确。每侧一次
已发送完成消息，并接收并验证
完成了来自对等方的消息，它可以开始发送和接收
连接上的应用数据。
此消息的结构：
结构{
不透明的verify_data[verify_data_length]；
}已完成；
验证数据
PRF（master_secret、finished_label、Hash（握手消息））
[0..verify_data_length-1]；
已完成标签
对于客户端发送的已完成消息，字符串
“客户端已完成”。对于服务器发送的Finished消息，
字符串“服务器已完成”。
Hash表示握手消息的Hash。
。。。
握手消息
此握手中所有消息的所有数据（不是
包括任何HelloRequest消息），
这条消息。这只是在握手层可见的数据
并且不包括记录层报头。这是
中定义的所有握手结构的级联
第7.4节，迄今为止已交换。
我的理解是，所有先前握手消息的散列被用作伪随机函数（PRF）的种子（部分），该函数用于生成12个或更多（取决于密码套件）伪随机八位字节，然后使用握手中刚刚同意的AES会话密钥对其进行加密。
因此，我会说“服务器看到的整个握手的哈希是在第一个加密消息中发送的，另一方必须验证它是否与客户端看到的整个握握手的哈希匹配”。（我知道这比“服务器签署完成消息”更令人费解，但你能做什么呢）。
TLS 1.3（RFC 8446）
第4.4.4节类似于上面RFC 5246的第7.4.9节，但它考虑了0-RTT模式，并且他们使用协商的密钥将PRF更改为HMAC。核心思想是相同的：Finish消息包括整个握手的散列，并使用协商的会话密钥对其进行加密。