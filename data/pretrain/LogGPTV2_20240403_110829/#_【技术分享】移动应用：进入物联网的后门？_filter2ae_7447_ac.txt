    }
注意类型666和魔法值，可能与前面讲过的'costanza'消息相匹配。
Fota请求（id = 6）。这可能意味着空中下载更新固件。
传感器数据（请求或响应）（id = 127或128）。
滑动指示（id = 116）。
版本请求和响应（id = 4和5）。
振动请求（id = 129），其中包括振动的持续时间等。
这些消息的用法和标识符将很难通过其他方式找到（特别是在正常情况下不出现的Force
Crash消息）。同样，这也证明了通过考察移动应用来分析物联网硬件是多么的有价值。
**安全报警器**
Meian公司是一家家用安全报警器的制造商。该公司的一些报警器可通过SMS进行远程控制：您可以远程启动/停止报警器、获取其当前状态、启用/禁用某些监控区域等。当然，这些命令必须符合特定的格式，同时，还必须提供正确的密码。为了控制报警器，最终用户必须按照特定格式把相应的命令写入SMS，并将其发送到报警器。当报警器接收SMS后，会对传入的消息进行处理，并回复执行结果。由于Meian对于SMS消息的格式的要求非常严格，所以Meian专门实现了一个Android应用程序来自动格式化短信。在配置期间，最终用户需要提供报警器的具体配置：报警器的电话号码、管理密码、输入密码时可接受的延迟、紧急电话号码（如果检测到入侵，则拨打该号码）。然后，该应用程序就会提供用于启动/停止/获取警报的状态（等等）的各种按钮（参见图6），这给用户的操作带来了极大的便利。
图6：用于远程控制家用安全报警器的Android应用程序的主屏幕。
同样的，这里我们还是通过分析设备的移动应用程序来考察该设备的安全问题。这里存在两个安全问题：
短信未删除。发送的短信会继续保留在智能手机上，除非手动删除。因此，如果攻击者能够读取它的话，就能得到报警器的密码。注意，无论最终用户是否使用该应用程序（手动写入SMS），都会出现此问题。
报警器配置的弱保护。该应用程序使用了一个弱加密算法来保护配置数据（电话号码、密码、紧急电话号码和延迟。请注意，配置数据是非常敏感的，因为任何人都可以用它来控制报警器。攻击者可以轻松逆向该加密算法，从而解密所有的设置（参见图7中的概念证明）。该漏洞在2015年就报告给Meian
[23]公司了，但是一直没有回应。在Play商店中的这个应用程序仍未修复该漏洞，截至目前已被下载了1,000到5,000次。
图7：解密安全报警器的所有主要机密设置的概念证明。
这个家用安全报警器的安全状态总结在表4中。遗憾的是，它的相关移动应用实际上给该设备的安全性带来了很大的麻烦，这也正是其他物联网设备正面临的问题之一。
情形：攻击者可以获得报警器的密码或电话号码… 从发件箱的命令SMS中…？ 一旦SMS消息被删除…？
    手动SMS是否
    使用Meian的Android应用程序是是
表4：使用Android应用程序前后报警器的安全状况比较
**结束语**
物联网设备的安全分析具有很大的挑战性，主要是因为它们的多样性所导致的，有时研究人员根本就不知道如何开始或从哪里开始。本文表明，在这种情况下，我们不妨从相关的移动应用程序开始下手，因为它们通常会与物联网设备进行通信，这是一个不错的起点。此外，这些移动应用在物联网设备中是非常常见的。
在本文中，我们通过相关移动应用程序分析了三种不同的设备：智能牙刷，智能手表和家用安全报警器。在所有三个案例中下，我们所用的策略都能够快速揭示其安全设计、协议详细信息和相关漏洞。当然，这些信息也可以通过其他方式发现，例如蓝牙扫描和模糊测试，但这样会需要消耗更多的时间，因为我们不得不猜测多种可能，而移动应用程序逆向工程则能够直接给出结果。
事实上，物联网和移动应用程序的结合会带来多个问题。为此，供应商应该设法完善设备的安全设计和实现，以及提高相关的移动应用的安全性。注意，对代码进行模糊处理的快速修复方案将很难奏效，而应该下大力气改进安全设计和实现。另外，防病毒行业需要为IoT恶意软件做好准备，无论来自设备本身还是来自移动应用程序。这可能是安全行业的下一个主战场。
**参考文献**
[1] BI Intelligence. The internet of everything: 2015.
[http://uk.businessinsider.com/internetof-everything-2015-bi-2014-12?r=US&IR=T#like-this-decksubscribe-to-bi-intelligencebelow-6](http://uk.businessinsider.com/internetof-everything-2015-bi-2014-12?r=US&IR=T#like-this-decksubscribe-to-bi-intelligencebelow-6)
[2] StrategyAnalytics. Global Smartwatch Shipments Overtake Swiss Watch
Shipments in Q4 2015. #.Vs8cw0J59hH, February 2016
[3] Hewlett Packard. Internet of things research study.
[http://h20195.www2.hp.com/V2/GetDocument.aspx?docname=4AA5-4759ENW&cc=us&lc=en](http://h20195.www2.hp.com/V2/GetDocument.aspx?docname=4AA5-4759ENW&cc=us&lc=en),
2015.
[4] IDC. IDC Reveals Worldwide Internet of Things Predictions for 2015,
December 2014. .
[5] Accenture Consulting. Igniting growth in consumer technology.
.
[6] Baccelli, E.; Hahm, O.; Wählisch, M.; Guìnes, M.; Schmidt, T. RIOT: One OS
to Rule Them All in the IoT. Research Report RR-8176, INRIA, December 2012.
[7] Contiki: The Open Source OS for the Internet of Things.
.
[8] Brillo. .
[9] Hernandez, G.; Arias, O.; Buentello, D.; Jin, Y. Smart Nest Thermostat: A
Smart Spy in Your Home, 2014. BlackHat US.
[10] Buentello, D. Weaponizing your coffee pot. DerbyCon, 2013.
[11] Hospira Lifecare PCA Infusion Pump 412 Telnet Service weak
authentication. CVE-2015-3459. .
[12] Apvrille, A. Geek usages for your Fitbit Flex tracker. Hack.lu, October
2015. .
[13] Wueest, C. Quantified Self – A Path to Self-Enlightenment or Just a
Security Nightmare?, 2014. BlackHat Europe.
[14] Wineberg, W. Internet of Things: Hacking 14 Devices, August 2015. DEFCON
23.
[15] Miessler, D. IoT Attack Surfaces, August 2015. DEFCON 23.
[16] Costin, A.; Zaddach, J.; Francillon, A.; Balzarotti, D. A large scale
analysis of the security of embedded firmwares, 2014. BlackHat Europe.
[17] Zaddach, J.; Bruno, L.; Francillon, A.; Balzarotti, D. Avatar: A
framework to support dynamic security analysis of embedded systems' firmwares.
Network and Distributed System Security (NDSS) Symposium, NDSS 14, February
2014.
[18] Higginbotham, S. Meet a startup building an insurance business around a
connected toothbrush. Fortune. .
[19] Apvrille, A. Insurance Fraud via Internet of Things, July 2015.
[http://blog.fortinet.com/post/insurance-fraud-via-internetof-things](http://blog.fortinet.com/post/insurance-fraud-via-internetof-things.)
[20] Beam Technologies. .
[21] gattlib. .
[22] Nordic nRF Master Control Panel.
.
[23] Fortinet Discovers Meian Safety Alarm Android Application Weak Credential
Encryption Vulnerability. .