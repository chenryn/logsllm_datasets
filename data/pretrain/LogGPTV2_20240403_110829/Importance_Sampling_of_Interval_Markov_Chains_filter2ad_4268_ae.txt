is a failure state of the system that is repaired in about 5 step
units. We want to estimate probability γ that the water level
Figure 2: Repair model. Superposition of independent
IS (red, thick) and IMCIS (blue, thin) 95%-conﬁdence
intervals. The black line indicates γ = 1.179 × 10
−7.
Figure 4: Water treatment model. Independent IS (red,
thick) and IMCIS (blue, thin) 99%-CIs.
Figure 3: Repair model. Evolution of the IMCIS conﬁd-
ence interval bounds during the optimisation step. x-axis
in log scale to show the fast changes in the ﬁrst iterations.
−3; 2.5×10
indicator (LIT301) exceeds a threshold (> 800) within the
next 30 step units. γ is unknown but supposedly small. The
experiments suggest that γ( ˆA) ∈ [5×10
−2]. Resuts
are reported in Table II (SWaT model). Figure 4 shows that IS
is hardly reliable since the (red) IS conﬁdence intervals do not
even intersect (see the two ﬁrst red CI). On the other hand,
IMCIS (in blue) provides more consistent results. It is also
worth noticing that the union of these IS conﬁdence intervals
is a subinterval of most of the IMCIS conﬁdence intervals.
Since the larger width of the IMCIS conﬁdence intervals offer
more chance to catch exact probability γ, we recommend the
recourse to IMCIS for the estimation of CPS critical events.
VII. CONCLUSION
The focus of
this paper was to introduce importance
sampling in an IMC settings in order to take into account
margin of errors inherent to approximated models. The goal of
Figure 5: Ridder model probabilities
[0.09852; 0.10048]. Values calculated by PRISM.
for α
∈
this approach is to provide more reliable conﬁdence intervals
of dependable properties in the rare event context, deﬁned with
respect to the original system. We proposed an algorithm based
on random search optimisation using Dirichlet distributions to
achieve this problem. The full validity of the approach is not
achieved but our results are very promising and show great
improvements over the similar importance sampling approach
deﬁned in the DTMC settings. As far as we know, the frame-
work is novel and raises challenging questions. In particular,
it would be interesting to compare the current algorithm with
other optimisation schemes proper to our problem. An other
challenge is to deﬁne a ’best’ importance sampling distribution
in the IMC settings. Finally, the uncertainties of the model may
lead to large conﬁdence intervals. In a future work, we plan
to use it for improving the learning of a probabilistic system
and to apply our approach to larger cyber physical systems.
311
ACKNOWLEDGMENT
This work was supported in part by the National Re-
search Foundation (NRF), Prime Minister’s Ofﬁce, Singapore,
under its National Cybersecurity R&D Programme (Award
No. NRF2014NCR-NCR001-040) and administered by the
National Cybersecurity R&D Directorate.
REFERENCES
[1] https://itrust.sutd.edu.sg/research/testbeds/secure-water-treatment-swat/.
[2] Benoˆıt Barbot, Serge Haddad, and Claudine Picaronny. Coupling
and Importance Sampling for Statistical Model Checking.
In Tools
and Algorithms for the Construction and Analysis of Systems - 18th
International Conference, TACAS, pages 331–346, 2012.
[3] Anicet Bart, Benoˆıt Delahaye, Didier Lime, Eric Monfroy, and Charlotte
Truchet. Reachability in parametric interval markov chains using
constraints. In Quantitative Evaluation of Systems - 14th International
Conference, QEST 2017, Berlin, Germany, September 5-7, 2017, Pro-
ceedings, pages 173–189, 2017.
[4] Michael Benedikt, Rastislav Lenhardt, and James Worrell. LTL model
checking of interval markov chains.
In Tools and Algorithms for the
Construction and Analysis of Systems - 19th International Conference,
TACAS 2013, Held as Part of the European Joint Conferences on Theory
and Practice of Software, ETAPS 2013, Rome, Italy, March 16-24, 2013.
Proceedings, pages 32–46, 2013.
[5] Peter Carbonetto, Mark W. Schmidt, and Nando de Freitas. An
interior-point stochastic approximation method and an l1-regularized
delta rule.
In Advances in Neural Information Processing Systems
21, Proceedings of the Twenty-Second Annual Conference on Neural
Information Processing Systems, Vancouver, British Columbia, Canada,
December 8-11, 2008, pages 233–240, 2008.
[6] Herman Chernoff. A measure of asymptotic efﬁciency for tests of
a hypothesis based on the sum of observations. Ann. Math. Statist.,
23(4):493–507, 1952.
[7] Edmund M. Clarke and Paolo Zuliani. Statistical Model Checking
for Cyber-Physical Systems. In Automated Technology for Veriﬁcation
and Analysis, 9th International Symposium, ATVA 2011, Taipei, Taiwan,
October 11-14, 2011. Proceedings, pages 1–12, 2011.
[8] G. Cochran. Laplace’s ratio estimator.
In Contributions to survey
sampling and applied statistics, pages 3–10. Academic Press, 1978.
[9] Costas Courcoubetis and Mihalis Yannakakis. Verifying temporal prop-
erties of ﬁnite-state probabilistic programs. In 29th Annual Symposium
on Foundations of Computer Science, White Plains, New York, USA,
24-26 October 1988, pages 338–345, 1988.
[10] Benoˆıt Delahaye, Kim G. Larsen, Axel Legay, Mikkel L. Pedersen, and
Andrzej Wasowski. Consistency and reﬁnement for interval markov
chains. J. Log. Algebr. Program., 81(3):209–226, 2012.
[11] William A Gale and Geoffrey Sampson. Good-Turing frequency
estimation without tears. Journal of Quantitative Linguistics, 2(3):217–
237, 1995.
[12] Thomas H´erault, Richard Lassaigne, Fr´ed´eric Magniette, and Sylvain
Peyronnet. Approximate probabilistic model checking.
In Bernhard
Steffen and Giorgio Levi, editors, Veriﬁcation, Model Checking, and
Abstract Interpretation, volume 2937 of LNCS, pages 307–329. Springer,
2004.
[13] Cyrille Jegourel, Axel Legay, and Sean Sedwards. Importance splitting
In Natasha Sharygina
for statistical model checking rare properties.
and Helmut Veith, editors, Computer Aided Veriﬁcation, volume 8044
of LNCS, pages 576–591. Springer, 2013.
[14] Cyrille Jegourel, Axel Legay, and Sean Sedwards. Command-based
importance sampling for statistical model checking. Theor. Comput.
Sci., 649:1–24, 2016.
[15] Sumit Kumar Jha, Edmund M. Clarke, Christopher James Langmead,
Axel Legay, Andr´e Platzer, and Paolo Zuliani. A bayesian approach
to model checking biological systems.
In Computational Methods in
Systems Biology, 7th International Conference, CMSB 2009, Bologna,
Italy, August 31-September 1, 2009. Proceedings, pages 218–234, 2009.
[16] Bengt Jonsson and Kim Guldstrand Larsen. Speciﬁcation and reﬁne-
ment of probabilistic processes.
In Proceedings of the Sixth Annual
Symposium on Logic in Computer Science (LICS ’91), Amsterdam, The
Netherlands, July 15-18, 1991, pages 266–277, 1991.
[17] Marta Z. Kwiatkowska, Gethin Norman, and David Parker. PRISM 2.0:
In QEST, pages 322–323.
A Tool for Probabilistic Model Checking.
IEEE, 2004.
[18] Tze Leung Lai. Stochastic Approximation. The Annals of Statistics,
31(2):391–406, April 2003.
[19] Arkadi S. Nemirovski and Michael J. Todd. Interior-point methods for
optimization. Acta Numerica, 17:191–234, May 2008.
[20] G. Norman, D. Parker, M. Kwiatkowska, and S. Shukla. Evaluating
the reliability of NAND multiplexing with PRISM.
IEEE Transac-
tions on Computer-Aided Design of Integrated Circuits and Systems,
24(10):1629–1637, 2005.
[21] Masashi Okamoto. Some Inequalities Relating to the Partial Sum of
Binomial Probabilities. Annals of the Institute of Statistical Mathematics,
10:29–35, 1958.
[22] Martin L. Puterman. Markov Decision Processes. Wiley, 1994.
[23] Dani¨el Reijsbergen, Pieter-Tjerk de Boer, Werner R. W. Scheinhardt, and
Boudewijn R. Haverkort. Rare Event Simulation for Highly Dependable
Systems with Fast Repairs.
In QEST 2010, Seventh International
Conference on the Quantitative Evaluation of Systems, Williamsburg,
Virginia, USA, 15-18 September 2010, pages 251–260, 2010.
[24] Ad Ridder.
Importance sampling simulations of markovian reliability
systems using cross-entropy. Annals of Operations Research, 134:119–
136, 2005.
[25] Gerardo Rubino and Bruno Tufﬁn, editors. Rare Event Simulation using
Monte Carlo Methods. Wiley, 2009.
[26] J. Spall.
2003.
Introduction to Stochastic Search and Optimisation. Wiley,
[27] Moshe Y. Vardi. Automatic veriﬁcation of probabilistic concurrent ﬁnite-
state programs. In 26th Annual Symposium on Foundations of Computer
Science, Portland, Oregon, USA, 21-23 October 1985, pages 327–338,
1985.
[28] Abraham Wald. Sequential tests of statistical hypotheses. The Annals
of Mathematical Statistics, 16(2):117–186, 1945.
[29] H. Younes. Veriﬁcation and Planning for Stochastic Processes with
Asynchronous Events. PhD thesis, Carnegie Mellon University, 2004.
[30] Lijun Zhang, Holger Hermanns, and David N. Jansen. Logic and
model checking for hidden markov models.
In Formal Techniques
for Networked and Distributed Systems - FORTE 2005, 25th IFIP
WG 6.1 International Conference, Taipei, Taiwan, October 2-5, 2005,
Proceedings, pages 98–112, 2005.
APPENDIX
Various optimisation algorithms could be used in our
context. Their efﬁciency is measured in terms of speed of
convergence. Since the objective function is unlikely to be
linear or at most quadratic, we can only consider non-linear
algorithms. However, since the constraints are linear, statistical
convex optimisation methods are relevant
to our problem.
General stochastic techniques,
like genetic or Metropolis-
Hastings algorithms may also be considered but they are not
limited to convex problems and are usually less efﬁcient in
terms of speed of convergence than the convex algorithms
discussed below.
1) Stochastic Gradient Descent [18]: is a stochastic ap-
proximation of the gradient descent optimization method for
minimising an objective function that is written as a sum of
k=1 L(ωk; A) where
differentiable functions, i.e. f (A) =
ωk is the k-th successful path, A ∈ [ ˆA] and L(ω; A) denotes
the likelihood of path ω given original probabilistic measure A.
In the standard gradient descent, A(0) = ˆA and the parameter
A(j) is updated at iteration j + 1 by:
(cid:2)M
(j) − η∇f (A
(j)
= A
)
(13)
(j+1)
A
312
module type1
state1 : [0..n] init 0;
[] state1  (n-state1)*alpha2 :
(state1’=state1+1);
[] state1 >=2 -> mu : (state1’=0);
endmodule
module type2
state2 : [0..n] init 0;
[] state2  (n-state2)*alpha :
(state2’=state2+1);
[] state2 >=2 & state1  mu :
(state2’=0);
endmodule
module type3
state3 : [0..n] init 0;
[] state3  (n-state3)*alpha :
(state3’=state3+1);
[] state3 > 0 & state2  mu : (state3’=state3-1);
endmodule
label "failure" = state1 = n & state2 = n
& state3 = n;
The property code is:
P=?["init" & (X !"init" U "failure")]
where η is a parameter called the learning rate in machine
learning. In the stochastic gradient descent,
the gradient
∇f (A(j)) is approximated by the gradient of only one sample:
(14)
(j) − η∇L(ωk; A
= A
(j+1)
A
(j)
)
where ωk is chosen randomly in the set of the sampled suc-
cessful paths. The convergence of the numerical and stochastic
gradient descents has been analysed. The main advantage of
the stochastic gradient descent is that, in our context, the gradi-
ent of a sample is easy to calculate since L(ωk; A(j)) has a
polynomial form. However, A(j+1) in Equation (14) obviously
(cid:12)= 1).
does not satisfy the equality constraints (
After re-normalisation, the equality constraints are satisﬁed but
not necessarily the inequality constraints. A projection into [ ˆA]
is thus necessary after solving Equation (14). Unfortunately,
the projection step must be performed after each iteration by
minimisation of the distance between A(j+1) and [ ˆA], that
implies signiﬁcant time over-cost.
(cid:2)m
(j+1)
ij
j=1 a
2) Stochastic Interior Point Method [5]:
is more suited
for dealing inequality constraints since, at each iteration,
an update is directly found into [ ˆA] by the means of the
logarithmic barrier method. To apply this method, we rewrite
the constrained optimisation problem as an unconstrained
optimisation problem of the form:
f (A) − m(cid:5)
λici− m(cid:5)
m(cid:5)
−
ij log(c
−
(μ
(aij))
i=0
i=0
j=0
+
ij log(c
+ μ
+
(aij)))
minimize
A
(cid:2)
−
ij, μ
j aij = 1 and μ
where each λi
is a Lagrange multiplier assigned to the
+
ij > 0 are the barrier
constraint
parameters of aij. In [5], the authors propose an approximation
of the minimum using a stochastic version of the interior point
method. However, in our context, the number of constraints
may be huge and slow down the solving of the resulting system
of equations. Indeed, we must take into account m equality
constraints and a maximum of 2m2 inequality constraints.
Solving the system of polynomial equations enriched with
one Lagrangian multiplier per constraint quickly becomes
intractable with respect to the number of states. Moreover, a
proof of convergence is still missing according to the authors2.
A. Prism code for the repair benchmark
We give below the code of the Prism model and the property
under investigation. α must be set by the user.
ctmc
const int n=4;
const double alpha = 0.1;
const double alpha2 = alpha*alpha;
const double mu = 1.0;
2The convergence was initially established in the appendix of [5] but the
authors admitted on their webpage on https://pcarbo.github.io a “major ﬂaw”
in the convergence proof. So far, the convergence is still an open question
313