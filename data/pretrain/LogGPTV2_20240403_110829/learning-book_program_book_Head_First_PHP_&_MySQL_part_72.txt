配的整个文本事。摘句话说，事不
能包含不属于电话号码的任何其他
/[2-9]\d{2}-\d{3}-\d{4}/
字符。
字符类拖出第一个字符必须是从2
.接下来
两个取值为0到9的数
又是3位数
还有一个连字符和最后4
字....….
位数字。
thereareno
DumbQuestions
符范围。
如一个或多个连续的元音字母？
定字符集中的任何字符都可以匹配文本事，而不只是一个
[aeiouAEIOU]+/就可以匹配一行中的一个或多个元音字母。
宇符。
例如，字符类[aeiou]可以匹配任何小写的元音字母，字
符类[m-zM-Z]将匹配字母表后半部分中的任何字母，包
括大写和小写。
宇符类[0-9]等价于元字符\d，\d实际上只是表示同一含
类后面，它就会应用到整个字符类。
义的一种简写形式。
如果你希望一个量词应用到连续的一组字符（但这些字符
不在一个字符类中），可以用小括号包围这些字符，指示
它们应当归为一组。举例来说，正则表达式/（hello）+/
或逗号吗？
将解释为匹配文本串的字符集的一部分。
说“ketchup”或“catsup”？
例如，以下字符类
[m-z, M2]
选项，可以从中选择。
不仅匹配m到z的大写和小写字母，还会匹配逗号或空格，
所以，正则表达式/（ketchup|catsup|catchup)/将匹
这可能并不是你想要的。
配这个单词3种最常见拼法中的任意一个。
你现在的位置
579
---
## Page 616
转义保留字符
如果在正则表达式中加入点号或问号之类的字符会怎么样？如
累我键入这些字符，PHP会不会认为它们是元字符或量词而试
围处理我的正则表达式？
如果希望在正则表达式中使用保留字符，需要对它们转义。
在正则表达式语法中，有为数不多的一组指定了特殊含义的字符，因为它们
用来指示元字符、量词和字符类。这包括点号（.）、问号（？）、加号（+）、
开始中括号（L），开始和结束小括号、补字号（^）、美元符（S）、竖线字
符（1）、反斜线（）、前斜线（/）和星号（*）。
如果希望在正则表达式中使用这些字符来表示它们的原义，而不是作为它们
例如，如果希望匹配一个电话号码中的括号，不能用如下的表达式：
这些会处理为一个组。
(555)636-4652
X
/（\d{3)）\d{3}-\d(4}$/
实际上，开始和结束括号前面都需要加反斜线，来指示它们应当
解释为真正的括号：
现在PHP知送这些是真正的括号。
(555)636-4652
K
/s{}P\-(∈}P\(\(∈}P\）\
PDG
580
第10章
---
## Page 617
正则表达式
写出与以下各个模式匹配的串。
xeRciSe
/~[3-6]{4}/
/~（[A-Z]\d){2}$/
假设我们希望扩展RiskyJobs的电话号码验证机制，允许用户采用更多格式提交号码。写出一
个与以下所有文本串都匹配的正则表达式，而且不允许0或1作为第一个数字。你的模式应当只
允许包含数字、括号、空格和连字符。
555-636-4652
555636-4652
(555)-636-4652
(555)636-4652
你现在的位置
581
---
## Page 618
练习答案
写出与以下各个模式匹配的串。
SoLutiON
串必须以……开头
一个大写字
两次..·
串必须以.…开头
3到6.·
并重复该字
和一个数
符类4次。
然后结束。
/~[3-6]{4}/
/（[A-z]\d){2}$/
任何以3、4、5或6范围内的4个数字开头的串都将匹配。
以一个大写字母开头，然后是一个数字，然
下面的事都能匹配
后是另一个大写字母和一个数字，然后结
“5533”“3546is4numbet.““6533xyx
束：
B5C9"
“R2D2”
假设我们希望扩展RiskyJobs的电话号码验证机制，允许用户采用更多格式提交号码。写出一
个与以下所有文本串都匹配的正则表达式，而且不允许0或1作为第一个数字。你的模式应当只
允许包含数字、括号、空格和连字符。
555-636-4652
555636-4652
(555)-636-4652
(555)636-4652
串必须以.
两次.
个连字符或空
和一个数
开头
2到9·.·.
格....·.
另一个连字符
字.4次
d32Y（）
d{41S
个
一个可选的开始小括号，
个数
一个可送的结束小括
然后结束
可以出现0或次…
号..
和一个数
字，3次…….
582
第10章
---
## Page 619
正则表达式
RiskyJobs筒历库中达些不真实的数据
已经让我受够了。如累不采用某种方式
使用达些表达式，它们将毫无意义。
RiskyJobs需要真正使用正则表达
式来验证表单数据！
PDG
你现在的位置》
583
---
## Page 620
php preg_match()函数
用preg_match()检查模式
我们并不是为了好玩来建立模式。可以结合PHP函数preg_match（）
使用这些模式。这个函数取一个正则表达式模式（如前面构造的正则
表达式）和一个文本串。如果没有匹配，函数会返回false，如果匹
配，则返回true。
preg_match($regex，
Smy_string)
这里是要检壹的串（堂看是否存在
正则表达式放在这里。西数币望收到一个
匹配）。
串，这说明正则表达式应当用单引号包围。
以下是实际使用preg_match（)函数的一个例子，这里使用一个正则
表达式在一个文本串中搜索SSN（社会保险号）模式：
将正则表达式传入pres_match(）时，应当
包围在单引号中。
可以像这样把具体模式放在面数中
返回一个整数：如果串与模
这个串与正则表达式匹配，函
式匹配则返回！，否则返回0。
不过通常最好把模式存储在一个变
数将返回。
量中。
可以利用preg_match（）函数在PHP脚本中支持更复杂的验证功能，可以
ptes_match(）西数丧套在条
针对返回值建立一个if语句。
件中，所以它的结果将决定
运行哪一个代码。
if（preg_match(/^\d(3)-\d(2)-\d(4)$/','555-02-9983'）)
echo'Valid socialsecurity number.';
如果医配成功，pres_match(）返
回tue.这金指示PHP条件为tue。
}else{
所以运行这个代码。
7
如果匹配不成功，ptes_match）返图
salse，这使得条件计算为balse，所
以运行这个代码。
584
第10章
---
## Page 621
正则表达式
重写RiskyJobsPHP脚本中相关的部分，使用preg_match（）而不是empty（）检查
xeRciSe
Registration表单数据来验证电话域中输人的文本。preg_match（）函数中使用之前创
建的正则表达式。
if(empty($phone)）{
//$phoneisblank
$output_form='yes';
你现在的位置
585
---
## Page 622
练习答案
重写RiskyJobsPHP脚本中相关的部分，使用pregmatch（）而不是empty（）检查
xeRciSe
Registration表单数据来验证电话域中输人的文本。preg_match（）函数中使用之前创
SoLUtiON
建的正则表达式。
if (empty($phone)）{
//$phoneis blank
echo'Your phonenumberisinvalid.'；
$output_form='yes';
没有使用empty(）.我们使用了ptes_match来验
证电话号码。在前面加了一个非摄作符（：）
因为我们最望当输入的数据与模式不匹配时抛
出一个错误。
前面建立的电话号码正则
表达式。
is（1pres_matchC/\（[2-9]\d(21\）[-\s]\a{3)-\d(4)S/.Sphone)）
echo语句需要稍做修改，因为我
./Sphoneis.mot valid
们不仅要检查以确保已经输入了
数据，还要确保它与一个标准电
ps!ag auoydmoso=sso d>oya
话号码模式匹配。
Soutput_form'yes
与前面一样，将Soutput_orm设置
我收到一个错误，然
为‘yes’。
后输入了完整的电话号
码。后来就得到了一个
武师的职位！
First Name: Jimmy
Last Name: Swift
Email:PI:EMAIL
Phone:(555) 636 4652
Desired Job:Ninja
586
第10章
---
## Page 623
正则表达式
运行测试
不只是电话号码
是否为空！
RiskyJobsRegistration脚本中检查电话号码是否合法。
从Head FirstLabs网站（www.headfirstlabs.com/books/hfphp）下载registration.
php，另外还要下载RiskyJobs样式表（style.css）和图像（riskyjobs_title.gif和
riskyjobs_fireman.png）。然后修改registration.php脚本，使用preg_match（)
函数根据电话号码正则表达式验证电话号码。需要调整错误消息，使用户知道电话号码不合法，
而不只是为空。
将修改后的脚本上传到你的Web服务器，在一个Web浏览器中打开脚本。尝试输人一些不同格式
的电话号码，注意脚本如何捕获错误。
000
Risky
Jubs
现在不会不小心输入有问
Risky Jobs - Registration
题的电话号码了。这会避
免我们错失工作机会！
Register with Risky Jobs,
Fist Name: Sw
Last Name:
现在如果电话号码输入
Email:
不正确，脚本会显示一
Phone:
个错误消息，这里的问
C
555.903.6386
题是使用了点号而不是
Desired Job:Tence
连字符。
RiskyJobs应用完整的源代码可以从HeadFirst
Labs网站下载：
www.headfirstlabs.com/books/hfphp
你现在的位置
587
---
## Page 624
php preg_replace()函数
唱，如累我们的正则表达式会匹配电话号码的多个
模式，是不是说数据库中会出现所有这些不同格式
的文本？这可不好。我想我们需要对这些内容标准
化。
允许以不同格式输入数据并不一定意味着希望按这些格式存储数据。
幸运的是，还有一个正则表达式函数允许我们取得RiskyJobs用户提交的合法
电话号码数据，并让它们都遵循一致的模式，而不是4种不同模式。
preg_replace（）函数在使用正则表达式完成模式匹配方面比preg_
match（）函数更进一步。除了确定一个给定模式是否与一个给定文本串匹配
外，它还允许提供一个替换模式取代串中的匹配文本。这非常类似于前面使
用的str_replace（）函数，只不过这里使用正则表达式而不是串来完成匹配。
preg_replace($pattern，$replacement，$my_string)
需要叠找这些不想要的
找到一个不想要的字符时
要完成垂找一替换的串。
字符。
希望把它替换为这个模式。
以下是实际使用preg_replace（）函数的一个例子：
$new_year=preg_replace('/200[0-9]/'，'2010'，'Theyearis 2009.');
71
pres_seplace(）函数的结果
这个正则表达式告诉
找到匹配时，金替摘
存储在Snew_year中.即究
pres_replace金找2000到
为2010。
每次在串中找到一个
成查找一替换修改后的
2009的匹配。
2000~2009的年份时，
文本事。
会替换为2010。
588
第10章
---
## Page 625
正则表达式
通过将以下各个数字写人下面数据库表的phone列，对RiskyJobs表单中输入的电话号
ExeRciSe
码完成标准化。确保使用一种适当的格式，从而存储尽可能少的数据来表示用户的电
话号码。
(555)935-2659
Risky
Jubs
(555)672-0953
Risky Jobs-Registration
555-343-8263
N S
555-441-9005
Last Name
Email:
Phone:
555.903.6386
Desired Job
555-612-8527-8724
cbmt
phone
......
你现在的位置》
589
---
## Page 626
练习答案
通过将以下各个数字写人下面数据库表的phone列，对RiskyJobs表单中输人的电话号
xeRciSe
码完成标准化。确保使用一种适当的格式，从而存储尽可能少的数据来表示用户的电
SoLUtiON
话号码。
(555)935-2659
Risky
JUDS
(555)672-0953
RiskyJobs-Registration
555-343-8263
Regis
555-441-9005
Last Name
Email:
Phone:
555.903.6386
Desired Job
555-612-8527-8724
phone
存储电话号码最简洁
的方法就是除数字以
......
外去掉所有其他部分。
5559352659
5556720953
5553438263
5554419005