参数说明：设置列存所使用的共享缓冲区的大小。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，16384～1073741823，单位为KB。
南大通用数据技术股份有限公司
1204
GBase 8s V8.8开发者手册
默认值：1GB
设置建议：
列存表使用cstore_buffers设置的共享缓冲区，几乎不用shared_buffers。因此在列存表
为主的场景中，应减少shared_buffers，增加cstore_buffers。
25.4.1.21 bulk_read_ring_size
参数说明：大批量数据查询时（例如大表扫描），该操作使用的环形缓冲区大小。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，256~2147483647，单位为KB。
默认值：16MB
25.4.1.22 enable_early_free
参数说明：控制是否可以实现算子内存的提前释放。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：布尔型
 on表示支持算子内存提前释放。
 off表示不支持算子内存提前释放。
默认值：on
25.4.1.23 local_syscache_threshold
参数说明：系统表cache在单个session缓存的大小。
该参数属于PG_SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
如果enable_global_plancache已打开，为保证GPC生效，local_syscache_threshold设置
值小于16MB时不会生效，最小为16MB。
如果enable_global_plancache和enable_thread_pool打开，该参数描述的是当前线程和绑
定到当前线程上的session缓存的总大小。
南大通用数据技术股份有限公司
1205
GBase 8s V8.8开发者手册
取值范围：整型，1*1024~512*1024，单位KB。
默认值：on
25.4.2 磁盘空间
介绍与磁盘空间相关的参数，用于限制临时文件所占用的磁盘空间。
25.4.2.1 sql_use_spacelimit
参数说明：限制单个SQL在单个数据库节点上、触发落盘操作时、落盘文件的空间大
小、管控的空间包括普通表、临时表以及中间结果集落盘占用的空间。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，-1~2147483647，单位为KB。其中-1表示没有限制。
默认值：-1
25.4.2.2 temp_file_limit
参数说明：限制一个会话中，触发下盘操作时，单个下盘文件的空间大小。例如一次会
话中，排序和哈希表使用的临时文件，或者游标占用的临时文件。
此设置为会话级别的下盘文件控制。
该参数属于SUSET类型参数，请参考表15-1中对应设置方法进行设置。
须知：
SQL查询执行时使用的临时表空间不在此限制。
取值范围：整型，-1~2147483647，单位为KB。其中-1表示没有限制。
默认值：-1
南大通用数据技术股份有限公司
1206
GBase 8s V8.8开发者手册
25.4.3 内核资源使用
介绍与操作系统内核相关的参数，这些参数是否生效依赖于操作系统的设置。
25.4.3.1 max_files_per_process
参数说明：设置每个服务器进程允许同时打开的最大文件数目。如果操作系统内核强制
一个合理的数目，则不需要设置。
但是在一些平台上（特别是大多数BSD系统），内核允许独立进程打开比系统真正可
以支持的数目大得多的文件数。如果用户发现有的“Toomanyopenfiles”这样的失败现象，
请尝试缩小这个设置。通常情况下需要满足，系统FD（filedescriptor）数量>=最大并发数*
数据库节点个数*max_files_per_process*3。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，25~2147483647。
默认值：1000
25.4.3.2 shared_preload_libraries
参数说明：此参数用于声明一个或者多个在服务器启动的时候预先装载的共享库，多个
库名称之间用逗号分隔。比如 '$libdir/mylib' 会在加载标准库目录中的库文件之前预先加载
mylib.so（某些平台上可能是mylib.sl）库文件。
可以用这个方法预先装载GBase8s的存储过程库，通常是使用 '$libdir/plXXX' 语法。
XXX只能是pgsql、perl、tcl、python之一。
通过预先装载一个共享库并在需要的时候初始化它，可以避免第一次使用这个库的加载
时间。但是启动每个服务器进程的时间可能会增加，即使进程从来没有使用过这些库。因此
建议对那些将被大多数会话使用的库才使用这个选项。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
须知：
- 如果被声明的库不存在，GBase8s服务将会启动失败。
南大通用数据技术股份有限公司
1207
GBase 8s V8.8开发者手册
- 每一个支持GBase8s的库都有一个特殊的标记用于保证兼容性。因此，不支持GBase
8s的库不能用这种方法加载。
取值范围：字符串
默认值：空
25.4.4 基于开销的清理延迟
这个特性的目的是允许管理员减少VACUUM和ANALYZE语句在并发活动的数据库上
的I/O影响。比如，像VACUUM和ANALYZE这样的维护语句并不需要迅速完成，并且不
希望他们严重干扰系统执行其他的数据库操作。基于开销的清理延迟为管理员提供了一个实
现这个目的手段。
须知：
有些清理操作会持有关键的锁，这些操作应该尽快结束并释放锁。所以GBase8s的机
制是，在这类操作过程中，基于开销的清理延迟不会发生作用。为了避免在这种情况下的长
延时，实际的开销限制取下面两者之间的较大值：
 vacuum_cost_delay*accumulated_balance/vacuum_cost_limit
 vacuum_cost_delay*4
25.4.4.1 背景信息
在ANALYZE|ANALYSE和VACUUM语句执行过程中，系统维护一个内部的记数器，
跟踪所执行的各种I/O操作的近似开销。如果积累的开销达到了vacuum_cost_limit声明的限
制，则执行这个操作的进程将睡眠vacuum_cost_delay指定的时间。然后它会重置记数器然
后继续执行。
这个特性是缺省关闭的。如需开启，需要把vacuum_cost_delay变量设置为一个非零值。
南大通用数据技术股份有限公司
1208
GBase 8s V8.8开发者手册
25.4.4.2 vacuum_cost_delay
参数说明：指定开销超过vacuum_cost_limit的值时，进程睡眠的时间。
要注意在许多系统上，睡眠的有效分辨率是10毫秒。因此把vacuum_cost_delay设置为
一个不是10的整数倍的数值与将它设置为下一个10的整数倍作用相同。
此参数一般设置较小，常见的设置是10或20毫秒。调整此特性资源占用率时，最好是
调整其他参数，而不是此参数。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，0~100，正数值表示打开基于开销的清理延迟特性；0表示关闭基于
开销的清理延迟特性。
默认值：0
25.4.4.3 vacuum_cost_page_hit
参数说明：清理一个在共享缓存里找到的缓冲区的预计开销。它代表锁住缓冲池、查找
共享的Hash表、扫描页面内容的开销。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，0~10000。
默认值：1
25.4.4.4 vacuum_cost_page_miss
参数说明：清理一个要从磁盘上读取的缓冲区的预计开销。它代表锁住缓冲池、查找共
享Hash表、从磁盘读取需要的数据块、扫描它的内容的开销。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，0~10000。
默认值：10
25.4.4.5 vacuum_cost_page_dirty
参数说明：清理修改一个原先是干净的块的预计开销。它代表把一个脏的磁盘块再次刷
南大通用数据技术股份有限公司
1209
GBase 8s V8.8开发者手册
新到磁盘上的额外开销。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，0~10000
默认值：20
25.4.4.6 vacuum_cost_limit
参数说明：设置清理进程休眠的开销限制。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，1~10000。
默认值：200
25.4.5 后端写进程
介绍后端写（backgroundwriter）进程的参数配置。后端写进程的功能就是把共享缓冲
区中的脏数据（指共享缓冲区中新增或者修改的内容）写入到磁盘。目的是让数据库进程在
进行用户查询时可以很少或者几乎不等待写动作的发生（写动作由后端写进程完成）。
此机制同样也减少了检查点造成的性能下降。后端写进程将持续的把脏页面刷新到磁盘
上，所以在检查点到来的时候，只有几个页面需要刷新到磁盘上。但是这样还是增加了I/O
的总净负荷，因为以前的检查点间隔里，一个重复弄脏的页面可能只会冲刷一次，而同一个
间隔里，后端写进程可能会写好几次。在大多数情况下，连续的低负荷要比周期性的尖峰负
荷好，但是在本节讨论的参数可以用于按实际需要调节其行为。
25.4.5.1 bgwriter_thread_num
参数说明：设置用于增量检查点打开后后台刷页的线程数，将可以淘汰的脏页刷盘，不
脏的页面放入到候选buffer链，设置此选项有助于加快buffer淘汰速度，提升性能。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，0～8
南大通用数据技术股份有限公司
1210
GBase 8s V8.8开发者手册
开发期间为测试关闭该特性的效果，可以设置为0，但是当前如果设置为0，会在代码
中修正为1，不再支持关闭该特性。
当参数设置为1~8时，表示会启动相对应数量的background线程，用于维护候选buffer
链，将满足条件的脏页刷盘，不脏的页放入到候选list中。
默认值：2
25.4.5.2 bgwriter_delay
参数说明：设置后端写进程写“脏”共享缓冲区之间的时间间隔。每一次，后端写进程都
会为一些脏的缓冲区发出写操作（用bgwriter_lru_maxpages参数控制每次写的量），然后休
眠bgwriter_delay毫秒后才再次启动。
在许多系统上，休眠延时的有效分辨率是10毫秒。因此，设置一个不是10的倍数的数
值与把它设置为下一个10的倍数是一样的效果。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，10~10000，单位为毫秒。
默认值：2s
设置建议：在数据写压力比较大的场景中可以尝试减小该值以降低checkpoint的压力。
25.4.5.3 candidate_buf_percent_target
参数说明：设置用于增量检查点打开时，候选 buffer 链中可用 buffer 数目占据
shared_buffer内存缓冲区百分比的期望值，当前候选链中的数目少于目标值时，bgwriter线
程会启动将满足条件的脏页刷盘。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：双精度浮点类型，0.1～0.85
默认值：0.3
25.4.5.4 bgwriter_lru_maxpages
参数说明：设置后端写进程每次可写入磁盘的“脏”缓存区的个数。
南大通用数据技术股份有限公司
1211
GBase 8s V8.8开发者手册
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，0～1000
说明： 此参数设置为0表示禁用后端写功能，禁用后端写功能不会对checkpoints
产生影响。
默认值：100
25.4.5.5 bgwriter_lru_multiplier
参数说明：通过与已使用缓存区数目的乘积评估下次服务器需要的缓存区数目。
写“脏”缓存区到磁盘的数目取决于服务器最近几次使用的缓存区数目。最近的buffers
数目的平均值乘以bgwriter_lru_multiplier是为了评估下次服务器进程需要的buffers数目。
在有足够多的干净的、可用的缓存区之前，后端写进程会一直写“脏”缓存区的（每次写的缓
存区数目不会超过bgwriter_lru_maxpages的值）。
设置bgwriter_lru_multiplier的值为1.0表示一种“实时”策略，其作用是精准预测下次写
“脏”缓冲区的数目。设置为较大的值可以应对突然的需求高峰，而较小的值则可以让服务器
进程执行更多的写操作。
设置较小的bgwriter_lru_maxpages和bgwriter_lru_multiplier会减小后端写进程导致的额
外I/O开销，但是服务器进程必须自己发出写操作，增加了对查询的响应时间。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：浮点型，0~10。
默认值：2
25.4.5.6 pagewriter_thread_num
参数说明：设置用于增量检查点打开后后台刷页的线程数，主要是按照脏页置脏的顺序
刷盘，用于推进recovery点。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，1～16
南大通用数据技术股份有限公司
1212
GBase 8s V8.8开发者手册
默认值：4
25.4.5.7 dirty_page_percent_max
参数说明：设置用于增量检查点打开后脏页数量占shared_buffers的百分比。达到这个
设定值时，后台刷页线程将以设置的max_io_capacity计算出的最大值刷脏页。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：浮点型，0.1～1
默认值：0.9
25.4.5.8 pagewriter_sleep
参数说明：设置用于增量检查点打开后，pagewrite线程每隔pagewriter_sleep的时间刷
一批脏页下盘。当脏页占据shared_buffers的比例达到dirty_page_percent_max时，每批页面
数量以设定的max_io_capacity计算出的值刷页，其余情况每批页面数量按比例相对减少。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，0～3600000（毫秒）
默认值：2000ms
25.4.5.9 max_io_capacity
参数说明：设置后端写进程批量刷页每秒的IO上限，需要根据具体业务场景和机器磁
盘IO能力进行设置。要求RTO很短时间或者数据量比共享内存大多倍的情况，业务访问数
据量又是随机访问时，该值不宜过小。该参数设置较小会减小后端写进程刷页个数，如果业
务触发页面淘汰多时，该值设置小会影响业务。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，30720~10485760。单位是KB。
默认值：512000KB（500MB）
25.4.5.10 enable_consider_usecount
参数说明：设置backend线程在页面置换时是否考虑页面热度，建议大容量场景下开启
南大通用数据技术股份有限公司
1213
GBase 8s V8.8开发者手册
此参数。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：布尔型
 on/true表示考虑页面热度。
 off/false表示不考虑页面热度。
默认值：off
25.4.5.11 dw_file_num
参数说明：设置批量双写文件的数量，该值与pagewriter_thread_num有关，不会大于
pagwriter_thread_num，如果设置过大，内部会纠正为pagewriter_thread_num。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，1～16
默认值：1
25.4.5.12 dw_file_size
参数说明：设置每个批量双写文件的大小。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，32～256
默认值：256
25.4.6 异步 IO
25.4.6.1 enable_adio_debug
参数说明：允许维护人员输出一些与ADIO相关的日志，便于定位ADIO相关问题。开
发人员专用，不建议普通用户使用。
该参数属于SUSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：布尔型
南大通用数据技术股份有限公司
1214
GBase 8s V8.8开发者手册
 on/true表示开启此日志开关。
 off/false表示关闭此日志开关。
默认值：off