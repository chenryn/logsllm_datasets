13
13
0
0
0
5
10
63
4
*.js
138
1163
240
935
330
227
159
217
71
414
271
0
64
0
11
2
0
0
6
0
0
0
TABLE I: Ground truth dataset. ‚ÄúNo. of PCAPs‚Äù is the number of PCAP Ô¨Åles which represent a single infection episode. The minimum for
‚ÄúNo. of Hosts‚Äù is always 2 since the smallest conversation involves a client and one remote host. Columns ‚Äú*.pdf‚Äù, ‚Äú*.exe‚Äù, ‚Äú*.jar‚Äù, ‚Äú*.swf‚Äù,
‚Äú*.crypt‚Äù, and ‚Äú*.js‚Äù refer to the count (per family) of payloads of the indicated Ô¨Åle extensions. Since ransomware payloads come in more
than 45 different Ô¨Åle extensions, we used ‚Äú*.crypt‚Äù to collectively refer to crypto-locker Ô¨Åle types in our ground truth dataset. Note also that
‚Äú*.js‚Äù shows the count of distinct JavaScript Ô¨Åles (local and remote) all of which may not necessarily be malicious.

 -( %&!,(0
 )) 
+!)%0
 %'$ 
%+!+*0
 & 
$!&+0
 %,$ 
&(!)-0
 
&+% '+!$&0
 "
 !
#
"
!
#
"
!











Fig. 1: Overall distribution of enticement strategies (Legend
shows category, count, and percentage respectively).
via social networking sites, ad banners with links to other URLs,
and legitimate sites with links to other (possibly)malicious sites.
A common aspect of all these enticement strategies is that the
victim is tricked to visit a certain URL.
Knowing how the victim ended up visiting a malware site
is crucial in establishing a case as to whether a malware
infection is about to unfold. In this regard, we examine our
ground truth dataset for clues about enticement strategies used
in each infection. In particular, we infer from the infection
trafÔ¨Åc whether the victim was (i) visiting a search engine site
(ii) visiting a social networking site and (iii) checking out a
seemingly legitimate site.
Search engines drive infection exposure. Figure 1 shows
the overall distribution of enticement strategies used in exploit
kits. Search engines take the lion‚Äôs share (62%) of the
enticement strategies ‚ÄîGoogle with (37%) followed by Bing
(with 25%). Given the market share of these two search
engines, the distribution in Figure 1 is not surprising. A
noteworthy observation, however, is that despite the popularity
of social networking sites such as Facebook, less than 1% of
the enticements originated from such sites. Interestingly, our
Ô¨Åndings are inline with a recent study [16] that found out search
engines as the predominant origins of malware downloads. The
same study also conÔ¨Årms our observation on the infrequent
Fig. 2: Infection origin distributions for 9 exploit kits.
use of social networking sites to initiate malware infection.
In about 17.76% of the traces, we found the referrer Ô¨Åelds
to be empty ‚Äî which we believe is due to intentional removal
of referrer header values to conceal origin. The 7.51% traces
for which the referrers have been redacted are sites that could
have otherwise violated user privacy on victim hosts.
Weaponization of compromised sites. In 12.84% of the
infection traces, enticements happened via compromised sites.
This evidence shows the steady rise in the use of vulnerable
sites for infection by cybercriminals. Recent studies (e.g.,
[6]) have also conÔ¨Årmed the rise of exploit kit infection via
compromised sites. As can be seen from Figure 1, about 94
of the infections are initiated by visiting compromised sites.
In quest for speciÔ¨Åcs, we matched the URI patterns of the 94
sites with URI patterns of default installations for commonly
used CMSs (in particular, WordPress, Joomla, and Drupal).
We found out that 56/94 infections have enticement URIs
that match typical installations of WordPress sites. We also
examined the longitudinal distribution of these sites in our
infection ground truth dataset. To this end, we conÔ¨Årmed that
while 15 of the 56 WordPress sites are scattered over a 2.5
years period (06/2013 - 01/2016), 41 out of the 56 appeared
465
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:20:37 UTC from IEEE Xplore.  Restrictions apply. 
.--
6-
5-
4-
3-
2-
1-
0-
/-
.-
-
).-
!


!


!




(


*


!

'
#

"



$



!



*

*

%



!



*
#
$
*

%

"




*


#


!




'
#


!
#


*


!



*

%


#


!



*

%

'
#


!
#


*


*

%

'

#

%

#



*


*

%




*


!

#
"
$

*

%



!



*
!




*

%


'
#

%

#


#

*


!



*

%


"
!




*
#
"

!


*
*

%

'
#


!
#


*
"
"



&
#


*

%

'
#

