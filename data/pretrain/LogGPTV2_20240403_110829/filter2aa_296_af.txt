sudo root
cp -R /Library/NetBoot/NetBootSP0/image.nbi /Volumes/Drive2/Library/
NetBoot/NetBootSP1/image.nbi
Balancing Boot Image Access
If you add a second NetBoot server to a network, have your clients reselect their boot 
image in the Startup Disk control panel or preferences pane. This causes the NetBoot 
load to be redistributed among the servers. You can also force redistribution of the load 
by deleting the file /var/db/bsdpd_clients from the existing NetBoot server. Similarly, if 
you’re recovering from a server or infrastructure failure, and your clients have been 
booting from a reduced number of NetBoot servers, you’ll need to delete the 
bsdpd_clients file from the running servers so that clients can once again spread out 
across the entire set of servers. 
The bsdpd_clients file on any given server holds the Ethernet Media Access Control 
(MAC) addresses of the computers that have selected this server as their NetBoot 
server. As long as a client has an entry in an available server’s bsdpd_clients file, it will 
always boot from that server. If that server should become unavailable to those clients, 
they will locate and associate themselves with an available server until such time as 
you remove their entries (or the entire files) from their servers. (If a client is registered 
on more than one server because an unavailable server comes back on line, the client 
boots from the server with the fewest number of clients booted off of it.)
LL2348.Book  Page 46  Thursday, August 21, 2003  10:58 AM
Chapter 5    Managing NetBoot Service
47
Distributing Shadow Files
Clients booting from Mac OS 9 images and clients booting from Mac OS X diskless 
images store temporary “shadow” files on the server. The way the server distributes 
these shadow files depends on whether the client is booting diskless Mac OS X or 
Mac OS 9.
Mac OS X Diskless Booting
By default, NetBoot for Mac OS X clients creates a share point for client shadow files on 
the server boot volume. (You can change this behavior; see “Changing How Mac OS X 
NetBoot Clients Allocate Shadow Files” on page 24.) You can use Server Admin to see 
this share point and to add others. The share points are named NetBootClientsn where 
n is the share point number. Share points are numbered starting with zero.
For example, if your server has two disk volumes, the default shadow-file directory is 
NetBootClients0 on the boot volume. If you use Server Admin to specify that client data 
should also be stored on the second volume, the directory is named NetBootClients1. 
NetBoot stores the first client’s shadow files on NetBootClients0, the second client’s 
shadow files on NetBootClients1, the third client’s shadow files on NetBootSP0, and so 
on. Likewise, with three volumes selected and eight clients, the first, fourth, and 
seventh clients will use the first volume; the second, fifth, and eighth clients will use 
the second volume; and the third and sixth clients will use the third volume.This load 
balancing is automatic and usually ensures optimal performance. 
To prevent shadow files from being placed on a particular volume, use the General 
pane in the NetBoot service settings in Server Admin.
Mac OS 9 Booting
By default, NetBoot for Mac OS 9 creates share points for client shadow files on the 
server boot volume. For example, if your server has two volumes installed, it has two 
share points (NetBootSP0 and NetBootSP1), and NetBoot stores the first client’s shadow 
image on NetBootSP0, the second client’s shadow image on NetBootSP1, the third 
client’s shadow image on NetBootSP0, and so on.
Suppose, for example, that you partition a 60 GB drive into a 10 GB boot partition and a 
50 GB data partition with the intention of keeping just your operating system and 
associated configuration files on the boot partition and all user data (such as client 
shadow images) on the data partition. After installation of the NetBoot For 9 software, 
there will be a NetBootClients0 on the boot partition and a NetBootClients1 on the 
data partition. 
To prevent Mac OS 9 shadow files from being placed on a particular volume or 
partition, delete the hidden file /Library/NetBoot/.clients from the volume, then stop 
and restart NetBoot service.
LL2348.Book  Page 47  Thursday, August 21, 2003  10:58 AM
48
Chapter 5    Managing NetBoot Service
Advanced NetBoot Tuning
You can adjust a wide range of NetBoot options by running the bootpd program 
directly and by modifying configuration parameters in specific NetInfo directories. 
For more information, read the bootpd man page. To view the man page, open 
Terminal and type man bootpd.
LL2348.Book  Page 48  Thursday, August 21, 2003  10:58 AM
6
49
6 Solving Problems
This chapter provides solutions for common problems 
you may encounter while working with NetBoot and 
Network Install.
General Tips
• Make sure a DHCP service is available on your network. It can be provided by the 
Mac OS X Server DHCP service or another server.
• Make sure required services are started on the server. See “Network Service 
Requirements” on page 15. Open Server Admin and make sure:
• AFP is started if you’re booting Mac OS 9 clients or Mac OS X diskless clients
• Web service is started if you’re using HTTP instead of NFS to deliver images
A NetBoot Client Computer Won’t Start Up
• Sometimes a computer may not start up immediately because other computers are 
putting a heavy demand on the network. Wait a few minutes and try starting up 
again.
• Make sure that all the cables are properly connected and that the computer and 
server are getting power. 
• If you installed memory or an expansion card in the client computer, make sure it is 
installed properly.
• If the server has more than one Ethernet card, or you’re using more than one port on 
a multiport Ethernet card, check to see if other computers using the same card or 
port can start up. If they can’t, check to be sure the Ethernet port you set up on the 
server is the same port to which the client computer is connected. It’s easy to 
mistake Ethernet port 1 for Ethernet port 4 on a multiport card. On the cards that 
come preinstalled in Macintosh servers, the ports are numbered 4, 3, 2, 1 (from left to 
right), if you’re looking at the back of the computer. 
• If the computer has a local hard disk with a System Folder on it, disconnect the 
Ethernet cable and try to start up the computer from the local hard disk. Then 
reconnect the Ethernet cable and try to start up the computer from the network. 
LL2348.Book  Page 49  Thursday, August 21, 2003  10:58 AM
50
Chapter 6    Solving Problems
• Boot the client computer from a local drive and check that it is getting an IP address 
from DHCP.
• On a diskless or systemless client, start up from a system CD and use the Startup Disk 
preferences to select a boot image.
You’re Using Macintosh Manager and a User Can’t Log In to a 
NetBoot Client
• Check to see if the user can log in to other computers. If the user can log in to other 
computers, then the computer the user can’t log in to may be connected to a 
Macintosh Manager server on which the user does not have an account. If there is 
more than one Macintosh Manager server, make sure the user has selected a server 
on which he or she has an account. 
• Open Macintosh Manager and make sure the user is a member of at least one 
workgroup.
• Open Macintosh Manager and reset the user’s password.
The Create Button in Network Image Utility Is Not Enabled
• Make sure you have entered an image name and ID in the General pane.
• Make sure you have chosen an image source in the Contents pane.
• For an image based on a CD or DVD source, make sure you have entered a default 
user name with a password that is at least four characters long in the Default User 
pane.
Controls and Fields in Network Image Utility are Disabled
• Click New Boot or New Install at the top of the window, or close and reopen the 
Network Image Utility.
I Can’t Set an Image to Use Static Booting (NetBoot version 1.0)
• Static network booting, as provided by NetBoot version 1.0, is not supported in 
Mac OS X Server version 10.3.
LL2348.Book  Page 50  Thursday, August 21, 2003  10:58 AM
51
Glossary
Glossary
DHCP (Dynamic Host Configuration Protocol)  A protocol used to distribute IP 
addresses to client computers. Each time a client computer starts up, the protocol looks 
for a DHCP server and then requests an IP address from the DHCP server it finds. The 
DHCP server checks for an available IP address and sends it to the client computer 
along with a lease period—the length of time the client computer may use the address.
disk image  A file that when opened creates an icon on a Mac OS desktop that looks 
and acts like an actual disk or volume. Using NetBoot, client computers can start up 
over the network from a server-based disk image that contains system software.
HTTP (Hypertext Transfer Protocol)  An application protocol that defines the set of 
rules for linking and exchanging files on the World Wide Web.
NetBoot server  A Mac OS X server on which you have installed NetBoot software and 
have configured to allow clients to start up from disk images on the server.
LL2348.Book  Page 51  Thursday, August 21, 2003  10:58 AM
LL2348.Book  Page 52  Thursday, August 21, 2003  10:58 AM
53
Index
Index
A
automating Network Install  31
B
booter file  10
BootFile property  12
specifying for NetBoot image  12
BootFile
NetBoot image property  12
Boot Server Discovery Protocol
See BSDP
BSDP (Boot Server Discovery Protocol)  13
role in NetBoot  13
bsdpd_clients file
determining client NetBoot server  46
role and location  9
C
capacity planning
NetBoot  16
Classic
installing in NetBoot image  21
client computers
start up using N key  42
client computers, Mac OS 9
selecting NetBoot install image  41
selecting NetBoot startup image  40
client computers, Mac OS X
selecting NetBoot install image  41
selecting NetBoot startup image  40
D
Description
NetBoot image property  12
directory access
configuring in boot images  21
disk images, NetBoot  7, 8
creating  17, 19
creating from existing clients  22
installing Classic in  21
on an NFS server  13
unlocking  27, 35, 36, 37, 38
updating Mac OS X  22, 23
disk images, Network Install
unlocking  27, 35, 36, 37, 38
updating  32
diskless booting
and default boot image  37
required services  15
E
empty install images
See custom package install images
Ethernet
disabling NetBoot on ports  43
requirements for NetBoot  16
G
G4. See Power Mac G4
G5. See Power Mac G5
I
image folder, NetBoot  10–11
images
separate for G5  14
Index
NetBoot image property  12
install image, selecting  41
IsDefault
NetBoot image property  12
IsEnabled
NetBoot image property  12
IsInstall
NetBoot image property  12
L
Language
NetBoot image property  12
load balancing
NetBoot and  45–47
N
Name
NetBoot image property  12
LL2348.Book  Page 53  Thursday, August 21, 2003  10:58 AM
54
Index    
NBImageInfo.plist
NetBoot property file  10, 11, 12
NetBoot  13, 39
administrator requirements  14
administrator tools for  8
AirPort and  16
Boot Server Discovery Protocol (BSDP)  13
capacity planning  16
client computers  39, 40, 41
configuring  33
creating images from existing clients  22
creating Mac OS X disk images  19
default image  37
disabling images  44
disabling on Ethernet ports  43
disk images  8
enabling  34
filtering clients  38
image folder  10–11
installing Classic in image  21
key features  7
load balancing  45–47
monitoring Mac OS X clients  44
property lists  11
security  13
server requirements  15
setting up Mac OS 9 disk image  25
setup overview  17
shadow files  9
solving problems  49
supported clients  14
Trivial File Transfer Protocol (TFTP)  13
updating Mac OS X images  22, 23
updating Startup Disk control panel  39
NETBOOT_SHADOW variable
table of values  24
NetBootClientsn share points
allocating shadow files  10
NetBoot Desktop Admin  11
NetBootSPn share points
adding or removing  35
don’t rename volume  35
location  9
overview  8
Network Image Utility  10
creating disk image  28
creating Mac OS X disk image  19
where to find  28
Network Install
about packages  29
automating installation  31
creating an image  28
creating custom packages  30
P
PackageMaker
help for  30
where to find  30
packages
about  29
adding to an image  30
creating  30
viewing contents of  32
Power Mac G4
images not for G5  14
Power Mac G5
images not for earlier CPUs  14
R
RootPath
NetBoot image property  12
S
security
NetBoot  13
Server Status
monitoring Mac OS X NetBoot clients  44
shadow files
about  9
allocation options  24
distributing  47
overview  9
share points for  8
share points
for images  8
for shadow files  8
starting up using N key  42
Startup Disk control panel, updating  39
startup image, selecting  40
SupportsDiskless
NetBoot image property  12
synchronizing
image with source  23
T
TFTP (Trivial File Transfer Protocol)
role in NetBoot  13
Trivial File Transfer Protocol
See TFTP
troubleshooting
NetBoot  49
Type
NetBoot image property  12
U
unlocking disk images  27, 35, 36, 37, 38
updating NetBoot images  22, 23
LL2348.Book  Page 54  Thursday, August 21, 2003  10:58 AM