title:DISCO: Sidestepping RPKI's Deployment Barriers
author:Tomas Hlavacek and
&apos;Italo Cunha and
Yossi Gilad and
Amir Herzberg and
Ethan Katz-Bassett and
Michael Schapira and
Haya Shulman
DISCO: Sidestepping RPKI’s Deployment Barriers
Tomas Hlavacek†
Italo Cunha‡(cid:92)
Yossi Gilad(cid:93)
Ethan Katz-Bassett(cid:92)
Michael Schapira(cid:93)
Amir Herzberg(cid:63)
Haya Shulman†
† Fraunhofer SIT
‡ Universidade Federal de Minas Gerais
(cid:63) University of Connecticut
(cid:92) Columbia University
(cid:93) Hebrew University of Jerusalem
Abstract—BGP is a gaping security hole in today’s Internet, as
evidenced by numerous Internet outages and blackouts, repeated
trafﬁc hijacking, and surveillance incidents. To protect against
preﬁx hijacking, the Resource Public Key Infrastructure (RPKI)
has been standardized. Yet, despite Herculean efforts, ubiquitous
deployment of the RPKI remains distant, due to RPKI’s manual
and error-prone certiﬁcation process. We argue that deploying
origin authentication at scale requires substituting the standard
requirement of certifying legal ownership of IP address blocks
with the goal of certifying de facto ownership. We show that
settling for de facto ownership is sufﬁcient for protecting against
hazardous preﬁx hijacking and can be accomplished without
requiring any changes to today’s routing infrastructure. We
present DISCO, a readily deployable system that automatically
certiﬁes de facto ownership and generates the appropriate BGP-
path-ﬁltering rules at routers. We evaluate DISCO’s security
and deployability via live experiments on the Internet using a
prototype implementation of DISCO and through simulations
on empirically-derived datasets. To facilitate the reproducibility
of our results, we open source our prototype, simulator, and
measurement analysis code [30].
I.
INTRODUCTION
The Border Gateway Protocol (BGP) glues together the or-
ganizational networks, called “Autonomous Systems” (ASes),
that make up the Internet. It is thus, arguably, the most crucial
component of the Internet’s infrastructure. Unfortunately, BGP
was designed decades ago, when security was not the foremost
consideration, and, consequently, BGP is disastrously vulner-
able to conﬁguration errors and attacks [47]. Indeed, BGP’s
insecurity is the cause for repeated major Internet outages [51],
[60], [61] and trafﬁc hijacking incidents [1], [5], [63].
The most common and devastating attack on BGP is preﬁx
hijacking, where an attacker advertises in BGP IP addresses
that belong to another AS and thereby attracts trafﬁc destined
for that AS (for the purpose of monitoring, eavesdropping on,
or manipulating trafﬁc; blackholing trafﬁc; masquerading as
the legitimate destination; etc.). In fact, today’s BGP routing
infrastructure is so fragile that misconﬁgurations of BGP
routers often result in inadvertent preﬁx hijacks.
To protect against preﬁx hijacks, the Internet Engineer-
ing Task Force (IETF) is promoting the deployment of the
Resource Public Key Infrastructure (RPKI), which binds IP
address blocks to “owner” ASes via cryptographic signa-
tures [35]. RPKI enables ASes to validate that an AS adver-
tising IP addresses in BGP is authorized to do so and thus to
Network and Distributed Systems Security (NDSS) Symposium 2020
23-26 February 2020, San Diego, CA, USA
ISBN 1-891562-61-4
https://dx.doi.org/10.14722/ndss.2020.24355
www.ndss-symposium.org
detect and discard preﬁx hijacks. This form of RPKI-based
ﬁltering is termed Route-Origin Validation (ROV). Beyond
its signiﬁcance for thwarting preﬁx hijackers, RPKI is also
the ﬁrst step towards combating more sophisticated attacks on
BGP, namely, path manipulation attacks [40].
Unfortunately, despite its critical role, RPKI suffers from
signiﬁcant drawbacks, both in terms of security and in terms
of deployability.
Security concerns. RPKI violates the fundamental principle of
“do no harm”. Due to human error, over 5% of the records in
RPKI repositories conﬂict with legitimate long-lived BGP an-
nouncements and would cause ROV-enforcing ASes to discard
legitimate BGP route-advertisements, thus disconnecting from
thousands of legitimate destinations [21], [31]. In addition,
almost a third of the records are misconﬁgured in a way that
leaves the issuer unprotected from preﬁx hijacks [24].
Deployability concerns. RPKI adoption has been frustratingly
slow [21], [29], [45], [49]. With few notable exceptions (e.g.,
AT&T [44]), almost no AS uses ROV [21], [29], [49], and
the very few that do may enforce ROV only partially [44].
In addition, RPKI certiﬁcation of IP-preﬁx ownership is quite
limited [45]. One reason for this dismal state of affairs is the
classic chicken and egg problem: both certifying ownership
of IP addresses and using ROV require nontrivial effort, yet
each is largely ineffective without
the other being widely
deployed. Certifying ownership of IP address blocks in RPKI
is a manual, bureaucratic process that requires coordination
between ASes, yet certiﬁcation is effective only when many
ASes use ROV to discard bogus BGP route-advertisements.
Indeed, as shown in [21], even high ROV adoption rates
amongst
the largest ISPs which comprise the core of the
Internet still leave the issuers of RPKI certiﬁcates vulnerable
to preﬁx (and especially subpreﬁx) hijacks. Moreover, using
ROV requires carefully analyzing the expected effect on actual
trafﬁc of different ROV strategies (to avoid disconnecting from
legitimate destinations) [44].
Certifying de facto ownership with DISCO. We argue
that (1) today’s limited adoption of RPKI/ROV leads to a
less secure Internet than a hypothetical one with widespread
adoption of a scheme that provides some but not all of the
protections of today’s RPKI, and (2) this tradeoff is realizable
by moving away from today’s manual and error-prone RPKI
certiﬁcation process. To this end, we propose revisiting the
conventional requirement of binding IP address blocks to their
legal owners and consider the more modest goal of certifying
de facto possession of IP addresses. De facto ownership, in
this context, means that the AS being certiﬁed as the owner
of a block of IP addresses controls those addresses in BGP.
We present Decentralized Infrastructure for Securing and
Certifying Origins. DISCO automatically certiﬁes de facto
ownership of IP addresses, populates public repositories, and
generates ﬁltering rules for ROV. DISCO is designed to pro-
vide reliable security guarantees while being easier and safer to
deploy than today’s RPKI. First, by automating the certiﬁcation
process, DISCO avoids the costs and risks associated with the
traditional manual and error-prone RPKI certiﬁcation. Second,
to deploy DISCO, an AS need not coordinate with any other
AS (as opposed to today’s hierarchical dependencies [21]).
Finally, DISCO maintains consistency between certiﬁcates and
the BGP control plane to avoid incidents resulting from human
neglect in synchronizing the two.
We designed DISCO to be compatible with today’s Inter-
net architecture. An AS deploying DISCO need only conﬁgure
iBGP sessions between its BGP routers and a local machine
running a DISCO agent (DISCO requires no changes to
the routing hardware or software). We present a prototype
implementation of DISCO and show that DISCO is readily
deployable on today’s Internet and can provide signiﬁcant
security beneﬁts through live (control-plane and data-plane)
experiments on the PEERING platform [52], [53], as well
as extensive simulations on empirically-derived datasets. We
make all the code and artifacts from our study available [30].
We regard de facto ownership certiﬁcation with DISCO as
a practical way to circumvent the obstacles facing the adoption
of today’s RPKI, leading to a more secure Internet. We also
regard DISCO as a means for enhancing RPKI’s security
and driving its deployment forward. By comparing DISCO’s
automatically-generated certiﬁcates with operator-issued RPKI
certiﬁcates and ﬂagging inconsistencies, operators can iden-
tify and ﬁx misconﬁgured RPKI records, thus mitigating the
adverse effects of human error in issuing RPKI records on
RPKI’s security and deployability.
II. RPKI AND ITS ADOPTION CHALLENGES
RPKI associates public keys with network resources such
as IP preﬁxes [38]. After certifying their IP preﬁxes, owners
can use their private keys to authorize speciﬁc AS numbers
to advertise these preﬁxes in BGP. Authorizations are crypto-
graphically signed and published in public repositories, which
enables other ASes to verify the authorization and ﬁlter routes
with invalid origins so as to protect against preﬁx hijacks. The
RPKI certiﬁcation and validation system consists of:
•
•
•
Resource Certiﬁcates (RC): certiﬁcates for owner-
ship of IP preﬁxes (and AS numbers) mapping owner
public keys to IP preﬁxes (and AS numbers).
Route Origin Authorizations (ROAs): signed state-
ments using the certiﬁed private key of the owner
of an IP preﬁx to specify an AS number authorized
to originate this preﬁx in BGP. The ROA might
also permit the AS to advertise subpreﬁxes, up to a
speciﬁed maximum preﬁx length.
Route Origin Validation (ROV): ﬁltering rules to be
applied by BGP routers to discard or depreference a
BGP advertisement whose origin AS does not match
the information in the preﬁx’s ROA.1
1Depreferring invalid routes reduces some of the risks from errors, but
leaves the AS completely vulnerable to subpreﬁx hijacking [16], [28].
Despite the importance of RPKI for Internet security
and extensive efforts to push its deployment forward, RPKI
adoption is sluggish. The vast majority of preﬁxes advertised
in BGP are still not in the system [45] (including most IP
addresses for popular web-services [65]), and very few ASes
ﬁlter BGP advertisements based on the information recorded
in RPKI [21], [29], [49], although there is some progress on
both these fronts [13]. We next discuss obstacles to RPKI’s
ubiquitous adoption [31], [24], [21].
Certiﬁcation can be challenging. RPKI certiﬁcation is manual
and hierarchical. Network operators need to request whoever
allocated the IP addresses to them to issue them a resource
certiﬁcate. Since many organizations do not yet have resource
certiﬁcates for their IP address blocks, in many cases certiﬁca-
tion requires other organizations (higher up in the hierarchy)
to ﬁrst be certiﬁed themselves [21].
Consider the following example. Level 3 owns preﬁx
8.0.0.0/9 and allocated subpreﬁxes to hundreds of organiza-
tions. However, suppose that Level 3 did not yet obtain a
resource certiﬁcate. With today’s RPKI, all these organizations
must wait for Level 3 to certify ownership over 8.0.0.0/9 before
they can ask Level 3 to sign a certiﬁcate for them.
Worse yet, if Level 3 had a certiﬁcate and issued a ROA
for 8.0.0.0/9, then any organization holding a subpreﬁx of
8.0.0.0/9 without a ROA for this subpreﬁx would appear
as an attacker to ROV-enforcing ASes. This constitutes a
real problem for some of the world’s largest Internet service
providers [21].
Human error. Issuing ROAs requires network operators to
manually authorize origin ASes and to specify the maximum
permissible length for advertised subpreﬁxes. However, an
operator might inadvertently not authorize all origins, or re-
strict the maximum length to be too short, and so advertise
BGP preﬁxes that violate their ROAs. About 6% of the BGP
announcements that are covered by ROAs are invalid [45],
with the vast majority of these attributed to human error [21],
[31], [64]. ASes that perform ROV would unwittingly discard
legitimate BGP advertisements for those preﬁxes, and thus
disconnect from legitimate destinations.
Another common type of human error is issuing ROAs
with an unnecessarily long maximum preﬁx length [24]. Such
ROAs void RPKI’s beneﬁts and leave the issuer completely
vulnerable to devastating subpreﬁx hijacks [24]. Recent mea-
surements reveal that almost 30% of the preﬁxes covered by
RPKI are, in fact, not protected [21], [20], [24].
Human error impacts ROV enforcement. Only a few ASes
actually use ROV [21], [29], [49]. According to a recent
survey of network operators [21], the most common reason
for not ﬁltering invalid routes is fear of “being disconnected
from legitimate destinations” due to erroneous RPKI records.
Even some of the few that perform ROV (e.g., AT&T [44])
do so only partially, and must have sufﬁcient expertise and
measurement capabilities to ﬁrst carefully analyze the expected
implications of doing ROV for their trafﬁc and to periodically
re-evaluate this over time [44].
2
BLOCKS
IPv4
IPv6
Total
778894
66751
Nov. 1st, 2018
De facto Multi-origin
0.78%
0.47%
97.5%
98.8%
Total
825063
79454
Aug. 1st, 2019
De facto Multi-origin
0.98%
0.57%
97.0%
98.6%
TABLE I.
NUMBER AND FRACTION OF MULTI-ORIGIN PREFIXES
2018 and August 2019. We deﬁne the origin prevalence of a
speciﬁc AS A with respect to a speciﬁc IP block B to be the
fraction of collected routing tables in which A is the origin AS
(receives trafﬁc) for B. We call the origin AS with the highest
prevalence with respect to an IP block B its prevalent origin.
Figure 1 plots the distribution of the prevalence values for
the prevalent origins across all IP blocks, with a logarithmic
scale on the y-axis.2 Results are consistent across both months,
with most blocks announced by a single origin AS (prevalence
= 1), a clear case of de facto ownership. Table I summarizes
the results. Additionally, the fraction of individual IP addresses
with a de facto owner is higher than for blocks (e.g., 98.1% for
IPv4 addresses vs. 97.0% for blocks in Aug. 2019), possibly
because large blocks are often older allocations with stable
owners and/or because trafﬁc engineering or delegations are
more common at ﬁner granularities (e.g., /24s).