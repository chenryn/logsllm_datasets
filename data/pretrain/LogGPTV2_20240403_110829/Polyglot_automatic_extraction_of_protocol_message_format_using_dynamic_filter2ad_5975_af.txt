### 参考文献

[8] Wireshark, 网络协议分析器.  
<http://www.wireshark.org>

[9] M. A. Beddoe. 使用生物信息学算法进行网络协议分析.  
<http://www.baselineresearch.net/PI/>

[10] N. Borisov, D. J. Brumley, H. J. Wang, 和 C. Guo. 通用应用层协议分析器及其语言.  
*网络与分布式系统安全研讨会*, 圣地亚哥, 加利福尼亚, 2007年2月.

[11] D. Brumley, J. Caballero, Z. Liang, J. Newsome, 和 D. Song. 面向二进制实现中自动发现偏差及其在错误检测和指纹生成中的应用.  
*USENIX 安全研讨会*, 波士顿, 马萨诸塞州, 2007年8月.

[12] J. Caballero, S. Venkataraman, P. Poosankam, M. G. Kang, D. Song, 和 A. Blum. FiG: 自动指纹生成.  
*网络与分布式系统安全研讨会*, 圣地亚哥, 加利福尼亚, 2007年2月.

[13] J. Chow, B. Pfaff, T. Garfinkel, K. Christopher, 和 M. Rosenblum. 通过全系统模拟理解数据生命周期.  
*USENIX 安全研讨会*, 圣地亚哥, 加利福尼亚, 2004年8月.

[14] M. Costa, J. Crowcroft, M. Castro, A. Rowstron, L. Zhou, L. Zhang, 和 P. Barham. Vigilante: 端到端的互联网蠕虫遏制.  
*操作系统原理研讨会*, 布赖顿, 英国, 2005年10月.

[15] J. R. Crandall, S. F. Wu, 和 F. T. Chong. Minos: 保护控制数据的架构支持.  
*ACM 体系结构与代码优化事务*, 2006年12月.

[16] D. Crocker 和 P. Overell. 用于语法规范的增强BNF: ABNF.  
*RFC 4234 (草案标准)*, 2005年10月.

[17] W. Cui, J. Kannan, 和 H. J. Wang. Discoverer: 从网络跟踪自动生成协议描述.  
*USENIX 安全研讨会*, 波士顿, 马萨诸塞州, 2007年8月.

[18] W. Cui, V. Paxson, N. C. Weaver, 和 R. H. Katz. 与协议无关的应用对话自适应重放.  
*网络与分布式系统安全研讨会*, 圣地亚哥, 加利福尼亚, 2006年2月.

[19] H. Dreger, A. Feldmann, M. Mai, V. Paxson, 和 R. Sommer. 动态应用层协议分析在网络入侵检测中的应用.  
*USENIX 安全研讨会*, 温哥华, 加拿大, 2006年7月.

[20] C. D. Grosso, G. Antoniol, M. D. Penta, P. Galinier, 和 E. Merlo. 提高网络应用程序安全性: 一种新的启发式方法来生成压力测试数据.  
*遗传和进化计算会议*, 2005年6月.

[21] P. Haffner, S. Sen, O. Spatscheck, 和 D. Wang. ACAS: 应用签名的自动化构建.  
*ACM SIGCOMM, 网络数据挖掘研讨会*, 费城, 宾夕法尼亚州, 2005年10月.

[22] J. Kannan, J. Jung, V. Paxson, 和 C. E. Koksal. 半自动发现应用会话结构.  
*互联网测量会议*, 里约热内卢, 巴西, 2006年10月.

[23] C. Leita, K. Mermoud, 和 M. Dacier. ScriptGen: 一个为Honeyd自动生成脚本的工具.  
*年度计算机安全应用会议*, 图森, 亚利桑那州, 2005年12月.

[24] J. Lim, T. Reps, 和 B. Liblit. 从可执行文件中提取输出格式.  
*反向工程工作研讨会*, 贝内文托, 意大利, 2006年10月.

[25] J. Ma, K. Levchenko, C. Kreibich, S. Savage, 和 G. M. Voelker. 协议推理的意外方法.  
*互联网测量会议*, 里约热内卢, 巴西, 2006年10月.

[26] P. McMinn, M. Harman, D. Binkley, 和 P. Tonella. 基于搜索的测试数据生成的物种路径方法.  
*软件测试与分析国际研讨会*, 2006年7月.

[27] P. V. Mockapetris. 域名 - 实现和规范.  
*RFC 1035 (标准)*, IETF 请求评论 1035, 1987年11月.

[28] J. Newsome 和 D. Song. 针对商品软件上自动检测、分析和生成漏洞利用签名的动态污点分析.  
*网络与分布式系统安全研讨会*, 圣地亚哥, 加利福尼亚, 2005年2月.

[29] J. Newsome, D. Brumley, 和 D. Song. 针对商品软件上的漏洞利用预防的特定漏洞执行过滤.  
*网络与分布式系统安全研讨会*, 圣地亚哥, 加利福尼亚, 2006年2月.

[30] J. Newsome, D. Brumley, J. Franklin, 和 D. Song. Replayer: 通过二进制分析自动协议重放.  
*ACM 计算机与通信安全会议*, 亚历山德里亚, 弗吉尼亚州, 2006年10月.

[31] P. Oehlert. 通过模糊测试违反假设.  
*IEEE 安全与隐私*, 第3卷第2期, 2005年3月.

[32] R. Pang, M. Allman, M. Bennett, J. Lee, V. Paxson, 和 B. Tierney. 现代企业流量初探.  
*互联网测量会议*, 伯克利, 加利福尼亚州, 2005年10月.

[33] R. Pang, V. Paxson, R. Sommer, 和 L. Peterson. Binpac: 用于编写应用协议解析器的Yacc.  
*互联网测量会议*, 里约热内卢, 巴西, 2006年10月.

[34] G. Portokalidis, A. Slowinska, 和 H. Bos. Argos: 用于广告蜜罐自动签名生成的零日攻击仿真器.  
*ACM SIGOPS 操作系统评论*, 第40卷第4期, 2006年10月.

[35] G. E. Suh, J. W. Lee, D. Zhang, 和 S. Devadas. 通过动态信息流跟踪实现安全程序执行.  
*编程语言和操作系统支持的体系结构国际会议*, 波士顿, 马萨诸塞州, 2004年10月.

[36] P. Vogt, F. Nentwich, N. Jovanovic, E. Kirda, C. Kruegel, 和 G. Vigna. 结合动态数据污染和静态分析的跨站脚本预防.  
*网络与分布式系统安全研讨会*, 圣地亚哥, 加利福尼亚, 2007年2月.

[37] H. Yin, D. Song, E. Manuel, C. Kruegel, 和 E. Kirda. Panorama: 用于恶意软件检测和分析的系统级信息流捕获.  
*ACM 计算机与通信安全会议*, 亚历山德里亚, 弗吉尼亚州, 2007年10月.

### 附录

#### A. 执行监控

我们使用仿真器 [5] 实现了执行监控。在仿真器中执行程序允许我们监控程序的内部执行以及其输入/输出操作。该仿真器已增强以支持动态污点分析 [13, 14, 15, 28, 34, 35]。在动态污点分析中，当重要输入数据被接收时会被标记（即染色），任何操作这些染色数据的指令（例如，将其移动到另一个位置或执行算术或逻辑运算）都会将染色信息传播到目标操作数。

对于我们来说，我们将程序从网络接收到的所有信息都进行染色。具体而言，每个输入字节都被分配一个染色记录，其中包含一个标志以指示它来自网络、一些连接标识符以及该字节在应用数据中的位置。每个位置（包括内存、寄存器和磁盘）都被分配了一个影子内存，用于存储生成该位置数据的输入字节的染色记录。随着程序将染色的输入数据移动到新位置并对其进行操作，目标位置的影子内存将更新为其生成的数据所涉及的输入字节的染色记录。这种染色传播包括程序执行的所有指令，以及程序使用的任何库，包括系统库和动态加载的库（如dll）。

除了染色数据外，仿真器还收集有关每条指令的信息，包括指令执行时操作数的内容。这些数据被写入执行跟踪中，其中包含程序执行的所有指令、它们操作的数据以及相关的染色信息。

#### B. 附加结果

##### B.1 ICQ 登录

| 字段 | Wireshark 0.99.5 | Tiny ICQ 1.2 |
| --- | --- | --- |
| 命令开始 | 固定 | 固定 |
| 通道ID | 固定 | 固定 |
| 序列号 | 固定 | 固定 |
| 数据字段长度 | 长度 | 长度 |
| 协议版本 | 变量 [4] | —— |
| 值ID | —— | 固定 |
| 字段长度 | —— | 长度 |
| 字段数据 | —— | 变量 [6] |

图7：从ICQ登录会话中提取的消息格式与Wireshark中的消息格式对比。

##### B.2 DNS 查询带指针

| 字段 | Wireshark 0.99.5 | SimpleDNS 4.00.06 |
| --- | --- | --- |
| 标识 | 固定 | 固定 |
| 标志 | 固定 | 固定 |
| 总问题数 | 固定 | 固定 |
| 总答案数 | 固定 | 固定 |
| 总权威数 | 固定 | 固定 |
| 总附加数 | 固定 | 固定 |
| 标签长度 | 固定 | 固定 |
| 标签 | 变量 [3] | “www” |
| 标签指针 | —— | 固定 |
| 类型 | 固定 | 固定 |
| 类 | 固定 | 固定 |

图8：从带有指针字段的DNS查询中提取的消息格式。这种类型的查询仅由SimpleDNS服务器支持。

##### B.3 IRC 关键词

表6显示了IRC登录请求中关键词提取模块的结果。注意，PONG关键词没有出现在JoinMe跟踪中，因为它是对基于服务器配置发送的PING请求的响应。

| 关键词 | Beware | JoinMe | Unreal |
| --- | --- | --- | --- |
| NICK | 是 | 是 | 是 |
| USER | 是 | 是 | 是 |
| PONG | 是 | 无 | 是 |

表6：IRC登录请求中存在的关键词及其是否被我们的系统正确提取。

表7显示了在IRC登录请求中找到的其他关键词。

| 服务器 | 其他关键词 |
| --- | --- |
| Beware | ’:’ (1); ’:1301071548’ (1) |
| JoinMe | ’ ’ (2); ’ :’ (1) |
| Unreal | ’e’ (1); ’:’ (1); ’:A’ (1); ’PROTOCTL’ (1); ’NAMESX’ (1) |

表7：在IRC登录请求中找到的其他关键词。