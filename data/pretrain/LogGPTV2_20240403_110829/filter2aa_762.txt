HIGH-DEF FUZZING
EXPLORING VULNERABILITIES IN
HDMI-CEC
              name = "Joshua Smith"
              job  = "Senior Security Researcher"
              job += "HP Zero Day Initiative"
              irc  = "kernelsmith"
              twit = "@kernelsmith"
Which of the following is false?
1. Have had 10 knee surgeries... and 5 others
2. Worked at JHUAPL... did mostly weapon sys assessments
3. Was voted "most athletic" in high school... don't judge a
book by its cover ;)
4. Previously ran assessments at the 92d Info. Warfare
Aggressor Sq. (USAF)... now 92d Info. Ops. Sq - vuln
assessments/pentests/red teams
5. Have a B.S. in Computer Engineering from RPI...
Aeronautical. Also, an MIS & some CS from JHU
6. Am an external Metasploit dev... since Feb 2013
7. Had C2 of 50 nuclear ICBMs on 9/11... interesting story 
Overview
What is CEC
Specs & Implementations
Design Details
Protocol
Attack Vectors & Surface
Fuzzing CEC
Some Results
Future Work
Why?
Wanted to research an area that was relatively untouched
For me: assembly > C/C++ and RISC > CISC
Another attack vector for mobile devices via:
Mobile High-Definition Link (MHL)
Slimport
Many car stereos as well
My son is completely obsessed with cords/wires, esp
HDMI
Previous Research
HDMI â€“ Hacking Displays Made Interesting
Andy Davis
BlackHat EU 2012
GUI Python CEC fuzzer
Somewhat simplistic
No exception monitoring
No crash data gathering
What is HDMI?
High Def Multimedia Interface
HDMI is an interface specification
Implemented as cables & connectors
Successor to DVI
What is CEC?
Consumer Electronics Control
Feature defined in the HDMI spec
Allows user to command & control up to 15 devices
Can relay commands from remotes
It's what automatically changes your TV input
Vendor-extendable
Adopted by some other technologies
That Don't Look
Like HDMI!
Still has CEC however
Slimport
Think ~ Amazon, Google, Blackberry, LG G+
Mobile High-Definition Link (MHL)
Think ~ HTC, LG Optimus+, Samsung (not G6)
Remote Control Protocol
Specs & Features
History
Ver
Published
Features
1.0
Dec 2002
Boring stuff
1.1
May 2004
Boring stuff
1.2
Aug 2005
Boring stuff
1.2a*
Dec 2005
Fully spec'd CEC
* This is the good stuff, for vulnerabilities anyway
Specs & Features
History Continued
Ver
Published
Features
1.3-3c
'06-'08
Whizz-bang A/V & new conns
1.4*
May 2009
Features++: 4k, HEC, ARC, 3D, micro
2.0
Sep 2013
4k @60fps, Dual View, 3D++, CEC++
* Most widely deployed & available, more in a sec
Interesting 1.4 Features
ARC (Audio Return Channel)
HEC (HDMI Ethernet Connection)
100Mb/s
Enables traditional networking w/HDMI
CEC Details
1-wire bidirectional serial bus
Slow: 500 bit/s
Uses AV.link protocol to perform remote control
functions
For HDMI:
CEC wiring is mandatory
CEC functionality (software support) is optional
Notable
Implementations
Commercial industry uses various trade names
Anynet+ (Samsung), Aquos Link (Sharp), BRAVIA
Link/Sync (Sony)
SimpLink (LG), VIERA Link (Panasonic), EasyLink
(Philips), etc
Open Source
libCEC (dual commercial license)
Android HDMI-CEC
Android HDMI CEC
CEC Addressing
PHYSICAL
N.N.N.N where 0x0 333
jalr $t9; strncpy => 409
jalr $t9; memcpy => 310
jalr $t9; [.*]printf => 11685
/me wrings hands
However, most are not called by CEC code :(
3 memcpy's, 2 of which I had already found manually
73 printf's, but aren't (so far) exploitable conditions
app_player
Post exploitation
Enable HEC
Enable LAN
Attack LAN services if nec
Enable higher speed exfil etc
Control an MHL device
Beachhead for attacking other devices
Hiding
Future Work
Unuglify my Python
Integrate into bigger/better fuzz framework
Exploit CEC & bind shell to network interface
Exploit CEC, enable HEC, bind shell to HEC interface
Exploit CEC & "bind" shell to HDMI interface
Explore attack surface of:
HDMI: 3D, Audio Return Channel, more w/HEC
Feature adds to CEC (HDMI 2.0)
Moar devices
Emulation
Conclusion
Becoming more and more pervasive and invasive
Old vuln types may be new again
May be benefitting simply because code is newer
Hard, sometimes impossible, to upgrade, maintain,
configure
Risk = Vulnerabilty x Exposure x Impact
Exposure is growing
Impact is probably highest for your privacy
Links
 not yet tho
P8 USB-HDMI Adapter 
Simplified Wrapper & Interface Generator 
Reveal.js 
github.com/ZDI/hdfuzzing
blackhat.com/bh-eu-12-Davis-HDMI
github.com/Pulse-Eight/libcec
hdmi.org
www.pulse-eight.com
swig.org
github.com/hakimel/reveal.js
cec-o-matic.com