chipset [31,40]. Other applications replicated similar client side detection without
the need for a rooted phone [15,37].
Van den Broek et al. proposed a pseudo-random IMSI that will not allow
others than the home operator to distinguish particular users [13]. However, this
will introduce a higher overhead in the roaming case and needs to be extended
to cover cases where IMSI Catchers use additional identiﬁcation numbers (such
as IMEI).
Van Do et al. are so far the only ones to look at the provider side [16].
Their solution is based on encryption elimination detection and anomalies such
as disappearance of a large group of phones in a geographical area, fed into a
machine learning system. However, their approach has limited applicability, for
real world networks: Disabling encryption is only found in older capturing IMSI
catchers and disappearance detection has a latency up to 24 h – the time scale
298
A. Dabrowski et al.
of periodic location updates (i.e. the mobile phone’s periodic reassurance to the
network). This will only detect IMSI Catchers operating for an extended amount
of time.
8.2 Working Principle of IMSI Catchers
Osipov and Zaitsev reverse-engineered a Huawei Femtocell and were able to
create a 3G IMSI Catcher and test phone implementations for messages where
integrity is ignored [35]. Shaik et al. researched 4G IMSI Catchers and their
possibilities [38]. Dunkelman et al. did research on the KATSUMI algorithm on
which A5/3 is based, but the attack is not practical in real-world networks [17].
8.3 Related Attacks on Cellular Devices
There are many attacks that are relevant as they are performed directly or in
conjunction with an IMSI Catcher.
SS7 MSISDN Lookup. IMSI Catching does not reveal the telephone number
(known as Mobile Station International Subscriber Directory Number, MSISDN)
of the subscriber. If not blocked by a ﬁrewall, an attacker with access to the
international interconnect network using Signaling System 7 (SS7) can request
subscriber information based on the IMSI (or the TMSI), just as any roaming
network would do [19].
SS7 Session Keys. An attacker with access to the international intercon-
nect network based on SS7 is able to retrieve RAN session keys [19,34]. The key
retrieval is a legitimate function required for roaming support: The roaming net-
work needs to authenticate on behalf of the home network. SS7 stateful ﬁrewalls
(e.g., keep track if and where a user is roaming) can block such requests.
SIM Card Rooting. Several SIM card attacks described by Nohl et al. [33]
have been blocked by the network operators worldwide. However, an IMSI
Catcher is directly communicating with the UE/MS. This gives the attacker
the ability to perform attacks such as the retrieval of SIM card application keys,
eventually giving him/her the control over the installation of new SIM card
applications on the victims device.
SIM Card Cloning. In 1998, Briceno, Goldberg, and Wagner reverse engineered
and broke the COMP128 [11] key derivation algorithm which enabled cloning of
GSM SIM cards of many network operators [12]. In 2015, Liu et al. [30] found that
AES-based MILENAGE algorithm on some USIM implementations is prone to
power-based side-channel analysis and thus giving way to clone these cards as well.
Unfortunately, they never named the manufacturers of the USIMs.
The Messenger Shoots Back: Network Operator
299
Unauthenticated SMS. 2G as well as some 3G devices [35] allow the reception
of SMS messages while captured by the rouge base station. The results for 3G
are somewhat surprising, since this is actually prohibited by current standards.
However, many phones do accept these messages nonetheless. SMS in 4G works
entirely diﬀerently and is therefore not aﬀected by this vulnerability, although
recent results [41] show that vulnerabilities exist in other constellations.
Presidential Alert Cell Broadcast. A feature dubbed presidential alert mes-
sages [6] is a special form of short messages that cannot be suppressed and
interrupt the phone in whichever state it is to be shown to the user. A fake base
station can send out this kind of messages.
GPS Lookup Initialized by Network. The Radio Resource Location Services
(LCS) protocol (RRLP) is an extension [4] to GSM and UMTS that allows the
network (real or fake) to trigger a GPS localization on the phone and submitting
the location back to the network. Harald Welte [42] demonstrated that this
happens without any authentication.
Measurement Triangulation. The network has the ability to request mea-
surement reports to other cells in the vicinity. A fake base station can use these
reports to estimate the position of the phone based on signal levels and known
positions of the cells. This is also possible on 4G [38].
Disable GPS. Because of (former) Egyptian regulations prohibiting the usage
of GPS, some older phones (iPhone [21], Nokia [5]) are known to disable the
GPS receiver when either associated or just in the vicinity of a network using
the Egyptian Mobile Country Code. An attacker can use this to disable the GPS
receiver on certain phones.
9 Conclusion
IMSI Catchers are still a major problem for todays networks: (i) Tracking
IMSI Catchers work directly on GSM, UMTS, and LTE networks as Loca-
tion/Tracking Update Rejects are excluded from cryptographic message integrity
checks. Mutual authentication only prevent plain capturing IMSI Catchers.
(ii) These reject messages can be used to downgrade a phone until the next
reboot to a lower access technology (e.g. GSM) without mutual authentication.
Therefore, the weakest-link principle applies.
In this paper we analyzed the diﬀerent types of IMSI Catchers and their
working principles as well as if and how they can be detected from the network
operator’s side. Due to our cooperation with an European carrier we have been
able to systematically perform real-world experiments and test our detection
methods on real world-data.
300
A. Dabrowski et al.
Strong indicators we identiﬁed are for example the usage of invalid LACs
(which are transmitted by the phones when they fall back to the genuine network
after an attack), or the usage of weak ciphers to detect downgrade attacks for
devices that were previously able to use strong ones. Additionally we showed that
a number of weak indicators can be correlated geographically, temporally, and
on subscriber basis e.g., for detecting targeted attacks, similar to current fraud
detection schemes used by credit card companies. This includes ﬁngerprinting
devices based on proﬁles, unusual movements, and implausible location update
trails. We also addressed corner cases and how to deal with them.
As mobile networks where initially designed with the reduction of signal-
ing traﬃc in mind, not all of the necessary information is readily available for
analysis, or even not collected centrally and in a scalable fashion. Some of the
indicators we identiﬁed therefore demand changes in the monitoring systems
currently used in such networks. However, based on already available data from
a real-world mobile network, we were able to show the practical applicability for
multiple of our methods.
Acknowledgments. We want to thank the whole crew of the core network security
team and radio access network team at T-Mobile. They have been a great help. We are
very grateful for the reviewers’ comments and help to improve the quality of the paper and
point to new interesting future work opportunities. This research was partially funded by
the COMET K1 program through the Austrian Research Promotion Agency (FFG).
References
1. Digital cellular telecommunications system (Phase 2+); Interworking between
Phase 1 infrastructure and Phase 2 Mobile Stations (MS). http://www.etsi.org/
deliver/etsi ts/101600 101699/101644/05.01.00 60/ts 101644v050100p.pdf
2. GSM security map. http://gsmmap.org/
3. How the NSA pinpoints a mobile device. http://apps.washingtonpost.com/g/page/
world/how-the-nsa-pinpoints-a-mobile-device/645/. Accessed 30 Oct 2015
4. Digital cellular telecommunications system (Phase 2+); Location Services (LCS);
Mobile Station (MS) - Serving Mobile Location Centre (SMLC) Radio Resource
LCS Protocol (RRLP), 3GPP TS 04.31 version 8.18.0 (2007). http://www.etsi.
org/deliver/etsi ts/101500 101599/101527/08.18.00 60/ts 101527v081800p.pdf
5. Egypt tries to control the use of GPS by banning except with individ-
ual licences (2008). http://www.balancingact-africa.com/news/en/issue-no-429/
top-story/egypt-tries-to-contr/en
6. Emergency Communications (EMTEL); European Public Warning System (EU-
ALERT) using the Cell Broadcast Service (2012). http://www.etsi.org/deliver/
etsi ts/102900 102999/102900/01.01.01 60/ts 102900v010101p.pdf
7. Digital cellular
telecommunications
system (Phase 2+); Universal Mobile
Telecommunications System (UMTS); Numbering, addressing and identiﬁca-
tion (2014). http://www.etsi.org/deliver/etsi ts/123000 123099/123003/12.04.01
60/ts 123003v120401p.pdf
8. 3rd Generation Partnership Project: Non-Access-Stratum (NAS) Functions related
to Mobile Station (MS) in Idle Mode, 3GPP TS 23.122 v8.2.0
The Messenger Shoots Back: Network Operator
301
9. 3rd Generation Partnership Project: Technical Speciﬁcation Group Core Network
and Terminals; Non-Access-Stratum (NAS) protocol for Evolved Packet System
(EPS), 3GPP TS 24.301
10. Barkan, E., Biham, E., Keller, N.: Instant ciphertext-only cryptanalysis of GSM
encrypted communication. J. Cryptol. 21(3), 392–429 (2008)
11. Briceno, M., Goldberg, I., Wagner, D.: An implementation of the GSM A3A8 algo-
rithm. (Speciﬁcally, COMP128.). http://www.scard.org/gsm/a3a8.txt. Accessed
24 Jun 2016
12. Briceno, M., Goldberg, I., Wagner, D.: GSM Cloning. http://www.isaac.cs.
berkeley.edu/isaac/gsm.html. Accessed 24 Jun 2016
13. van den Broek, F., Verdult, R., de Ruiter, J.: Defeating IMSI catchers. In: 22nd
ACM Conference on Computer and Communications Security (CCS 2015), pp.
340–351. ACM (2015)
14. Paget, C. (Kristin Paget): Practical Cellphone Spying. In: DEFCON 19 (2010)
15. Dabrowski, A., Pianta, N., Klepp, T., Mulazzani, M., Weippl, E.: IMSI-Catch me if
you can: IMSI-catcher-catchers. In: Proceedings of the Annual Computer Security
Applications Conference (ACSAC 2014). ACM, December 2014
16. van Do, T., Nguyen, H.T., Momchil, N., et al.: Detecting IMSI-catcher using soft
computing. In: Berry, M.W., Mohamed, A.H., Yap, B.W. (eds.) Soft Computing
in Data Science. CCIS, vol. 545, pp. 129–140. Springer, Heidelberg (2015)
17. Dunkelman, O., Keller, N., Shamir, A.: A practical-time attack on the A5/3
cryptosystem used in third generation GSM telephony. IACR Cryptology ePrint
Archive 2010, 13 (2010)
18. Ekdahl, P., Johansson, T.: Another attack on A5/1. IEEE Trans. Inf. Theor. 49(1),
284–289 (2003)
19. Engel, T.: SS7: Locate. Track. Manipulate, at 31C3 (2014). https://events.ccc.de/
congress/2014/Fahrplan/events/6249.html. Accessed 30 Oct 2015
20. Ettus Research: Universal Software Radio Peripheral. https://www.ettus.com/
product
21. Farivar, C.: Apple removes GPS functionality from Egyptian iPhones (2008).
http://www.macworld.com/article/1137410/Apple removes GPS func.html
22. Gamma Group: 3G-GSM Interctiopn and Target Location. Sales brochure. https://
info.publicintelligence.net/Gamma-GSM.pdf. Accessed 2 Nov 2015
23. Goldberg, I., Wagner, D., Green, L.: The (Real-Time) Cryptanalysis of A5/2. In:
Rump Session of Crypto 1999 (1999)
24. GSM Association: IR.50 2G 2.5G 3G Roaming v4.0 (2008). http://www.gsma.
com/newsroom/all-documents/ir-50-2g2-5g3g-roaming/. Accessed 25 Sep 2015
25. Prohibiting A5/2 in mobile stations and other clariﬁcations regarding A5
algorithm support. http://www.3gpp.org/ftp/tsg sa/TSG SA/TSGS 37/Docs/
SP-070671.zip
26. G¨uneysu, T., Kasper, T., Novotny, M., Paar, C., Rupp, A.: Cryptanalysis with
COPACOBANA. IEEE Trans. Comput. 57(11), 1498–1513 (2008)
27. Steve, H.D.: Cracking GSM. In: Black Hat DC, March 2008 (2008)
28. Joachim, F., Rainer, B.: Method for identifying a mobile phone user or for eaves-
dropping on outgoing calls, patent, Rohde & Schwarz, EP1051053 (2000)
29. SR Labs: Kraken: A5/1 Decryption Rainbow Tables. via Bittorent (2010). https://
opensource.srlabs.de/projects/a51-decrypt. Accessed 12 Nov 2015
30. Liu, J., Yu, Y., Standaert, F.X., Guo, Z., Gu, D., Sun, W., Ge, Y., Xie, X.: Small
tweaks do not help: diﬀerential power analysis of MILENAGE implementations
in 3G/4G USIM cards. In: Pernul, G., Ryan, P.Y.A., Weippl, E. (eds.) ESORICS
2015. LNCS, vol. 9326, pp. 468–480. Springer, Heidelberg (2015)
302
A. Dabrowski et al.
31. Malette, L.: Catcher Catcher. https://opensource.srlabs.de/projects/mobile-
network-assessment-tools/wiki/CatcherCatcher. Accessed 12 Nov 2015
32. Muncaster, P.: Chinese cops cuﬀ 1,500 in fake base station spam raid. The Reg-
ister, 26 March 2014. http://www.theregister.co.uk/2014/03/26/spam text china
clampdown police/
33. Nohl, K.: Rooting SIM cards. In: Blackhat (2013)
34. Nohl, K.: Mobile self-defense, 31C3 (2014). https://events.ccc.de/congress/2014/
Fahrplan/events/6122.html. Accessed 30 Oct 2015
35. Osipov, A., Zaitsev, A.: Adventures in Femtoland: 350 Yuan for invaluable fun. In:
Black Hat USA 2015, August 2015
36. Pell, S.K., Soghoian, C.: Your secret stingray’s no secret anymore: the vanish-
ing government monopoly over cell phone surveillance and its impact on national
security and consumer privacy. Harvard J. Law Technol. 28(1) (2014)
37. SecUpwN (Pseudonym, Maintainer): Android IMSI-Catcher Detector. https://
secupwn.github.io/Android-IMSI-Catcher-Detector/. Accessed 12 Nov 2015
38. Shaik, A., Borgaonkar, R., Asokan, N., Niemi, V., Seifert, J.: Practical attacks
against privacy and availability in 4G/LTE mobile communication systems (2015).
http://arxiv.org/abs/1510.07563
39. Solnik, M., Blanchou, M.: Cellular exploitation on a global scale: the rise and fall
of the control protocol. In: Blackhat 2014, Las Vegas (2014)
40. SR Labs: Snoopsnitch, December 2014. https://opensource.srlabs.de/projects/
snoopsnitch. Accessed 12 Nov 2015
41. Tu, G., Li, Y., Peng, C., Li, C., Raza, M.T., Tseng, H., Lu, S.: New threats to
sms-assisted mobile internet services from 4G LTE networks (2015). http://arxiv.
org/abs/1510.08531
42. Welte, H.: OpenBSC - running your own GSM network, talk at Hacking at
Random, August 2009. https://openbsc.osmocom.org/trac/raw-attachment/wiki/
FieldTests/HAR2009/har2009-gsm-report.pdf