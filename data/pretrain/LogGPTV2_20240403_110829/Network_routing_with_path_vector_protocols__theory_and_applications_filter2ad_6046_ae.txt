4 3 0
4 6 5 2 0
3
3 0
3 2 0
3 6 5 2 0
1
1 4 6 3 0
1 0
1 4 3 0
1 4 6 5 2 0
0
0
1 4 6 5 2 0
3 6 5 2 0
4 6 5 2 0
2 5 6 3 0
1 4 6 3 0
6 5 2 0
5 6 3 0
4 6 3 0
1 4 3 0
5 2 0
3 2 0
2 3 0
6 3 0 
4 3 0
2 0
3 0
0
1 0
Figure 7: Example paths digraph for the customer-
provider and peer-peer algebra of Section 7.4, and
network of Figure 4.
+n denotes addition modulus n. If i >>>>:
0
:
a(j − 1) + 1 :
a(j − 1) + 2 :
if j = 0
if 1  j and, therefore, the function
F decreases.
3. R (cid:11)= Q and R = none: The coordinate fj may decrease
by one, the coordinate fk decreases by one, and the
coordinate fM +1 may increase. Because R (cid:11)= Q and
R = none, we have k < M + 1, and the function F
decreases.
4. R (cid:11)= Q and R (cid:11)= none and R (cid:11)= uv◦ P : The coordinate
fj decreases by one, the coordinate fk decreases by
one, and the coordinate fl increases. Because R (cid:11)= uv◦
P , path R was available for selection at node u before
the signaling routing message was received. Since, in
addition, R (cid:11)= Q and path Q was the path chosen by u
before the signaling routing message was received, Q
weighs less than R or has the same weight as R but
is preferred to it at node u. Hence, k < l and the
function F decreases.
9. ALGEBRA AND BGP
We now discuss the use of the algebraic framework in the
design and implementation of policy guidelines for BGP. The
ideas expressed in this section are preliminary and their mer-
its need to be assessed by actual implementations. We view
the algebraic framework as a mathematical template for set-
ting up policy guidelines, expecting its semantic value to
help in their translation to and from some router conﬁgura-
tion language [5]. The set of labels corresponds to the class
of possible types of relationships between pairs of nodes to-
gether with the relevant properties of the links joining them.
The set of signatures reﬂects properties of paths that nodes
are willing to keep and share with their neighbors. The
mapping of signatures into weights and the translation of
a signature to another via a label are such as to make the
path vector protocol converge and satisfy any additional re-
quirements that may be desired from the policy guidelines.
Once a set of policy guidelines is represented by an alge-
bra, mapping its elements into BGP mechanisms comprises
two main aspects. First, there must be some way to asso-
ciate a signature with a BGP route. This can be achieved
with the Community attribute. Second, we must be able
to assign a weight to each Community value representing
a signature. The set of weights can be created with the
LOCAL-PREF attribute. However, if a weight corresponds
to exactly one value of LOCAL-PREF, no margin is left for
the ASes to individually apply routing policies that they do
not wish to disclose to their neighboring ASes. A better
solution is to let each weight correspond to a range of con-
tiguous LOCAL-PREF values, with diﬀerent weights hav-
ing non-overlapping ranges. A router holding a route with a
given Community value can choose any one of the LOCAL-
PREF values associated with that Community value, the
exact choice being outside the scope of the guidelines.
Routers need to be conﬁgured to respect the correspon-
dence between Community values and ranges of LOCAL-
PREF values and to convert among Community values rep-
resenting signatures. External to the algebra is the decision
of which router performs which conversions. For example,
suppose that u and v are two routers in diﬀerent ASes with
Table 2: Ranking of usable paths for the paths digraph of Figure 7.
rank 1
rank 2
rank 8
rank 7
1 4 3 0
1 4 6 5 2 0
0
2 0
3 0
rank 3
3 2 0
5 2 0
6 3 0
rank 4
4 6 3 0
5 6 3 0
6 5 2 0
rank 5
4 3 0
1 4 6 3 0
2 5 6 3 0
3 6 5 2 0
rank 6
1 0
2 3 0
4 6 5 2 0
a relationship described by label l, and that α is the Com-
munity value (signature) of a route hold by v. After the
route is advertised to u its Community value becomes l ⊕ α.
The algebra is the same whether the new Community value
is computed at v before the route is advertised to u, or is
computed at u after the route is received at u, or the com-
putation is shared between u and v.
10. CONCLUSIONS
We have brought modern algebraic concepts to the design
and study of routing strategies supported on path vector
protocols. The convergence properties of path vector proto-
cols are related with the monotonicity and isotonicity of the
underlying algebra. Monotonicity is necessary and suﬃcient
to make a path vector protocol converge, and monotonicity
together with isotonicity are necessary and suﬃcient for con-
vergence to optimal paths. We have also identiﬁed freeness
as the property that a network must have for guaranteed
convergence of path vector protocols independently of the
relative preference given by the nodes to paths with the
same weight.
The algebraic approach unites in a common framework
previous results on optimal path routing and various guide-
lines for policy-based routing, and makes it easy to check
the validity of new routing strategies. As examples of new
applications, we have given guidelines for policy-based rout-
ing that contemplate backup relationships while rendering
paths with valleys unusable, and we have derived a suﬃcient
condition for convergence of iBGP in Internet domains that
use route reﬂection. Last, we have used the framework to
gain insight into the provision of QoS extensions to BGP.
As a ﬁnal note, we remark that most of the theory devel-
oped here can be adapted to distance vector protocols, pro-
vided that we supplement these protocols with a mechanism
to deal with the count-to-inﬁnity problem. This is readily
accomplished by endowing signaling routing messages with
a counter that is incremented every time it its passed from
one node to another. Limiting the value of this counter stops
the counting to inﬁnity.
11. ACKNOWLEDGEMENTS
I am grateful to Tim Griﬃn for the incitement to submit
this work to SIGCOMM. I am also thankful to Jos´e Br´azio,
to Ramesh Govindan, my shepherd, and to the anonymous
reviewers for the many comments that helped improve the
paper.
12. REFERENCES
[1] M. Blanchet, F. Parent, and B. St-Arnaud. Optical
BGP (OBGP): InterAS lightpath provisioning.
Internet draft draft-parent-obgp-01.txt, January 2001.
[2] J. Doyle. Routing TCP/IP. Cisco Press, Indianapolis,
IN, 1998. ISBN 1-57870-041-8.
[3] L. Gao, T. Griﬃn, and J. Rexford. Inherently safe
backup routing with BGP. In Proc. INFOCOM 2001,
pages 547–556, Anchorage, AK, April 2001.
[4] L. Gao and J. Rexford. Stable Internet routing
without global coordination. IEEE/ACM Transactions
on Networking, 9(6):681–692, December 2001.
[5] R. Govindan, C. Alaettinoglu, G. Eddy, D. Kessens,
S. Kumar, and W. S. Lee. An architecture for stable,
analyzable Internet routing. IEEE Network, 13:29–35,
January/February 1999.
[6] T. Griﬃn, F. Shepherd, and G. Wilfong. Policy
disputes in path-vector protocols. In Proc. 7th
International Conference on Network Protocols,
Toronto, Canada, November 1999.
[7] T. Griﬃn, F. Shepherd, and G. Wilfong. The stable
paths problem and interdomain routing. IEEE/ACM
Transactions on Networking, 10(2):232–243, April
2002.
[8] T. Griﬃn and G. Wilfong. On the correctness of
IBGP conﬁguration. In Proc. SIGCOMM 2002, pages
17–29, Pittsburgh, PA, August 2002.
[9] B. Halabi. Internet Routing Architectures. Cisco Press,
Indianapolis, IN, 1997. ISBN 1-56205-652-2.
[10] G. Huston. Interconnections, peering and ﬁnancial
settlements. In Proc. INET’99, San Jose, CA, June
1999.
[11] L. Lamport. An assertional correctness proof of a
distributed algorithm. Science of Computer
Programming, 2(3):175–206, December 1982.
[12] L. Lamport. The temporal logic of actions. ACM
Trans. on Programming Languages and Systems,
16(3):872–923, April 1994.
[13] Y. Rekhter and T. Li. A Border Gateway Protocol 4
(BGP-4). RFC 1771, March 1995.
[14] J. Rosenberg, H. Salma, and M. Squire. Telephony
routing over IP (TRIP). RFC 3219, January 2002.
[15] J. L. Sobrinho. Algebra and algorithms for QoS path
computation and hop-by-hop routing in the internet.
IEEE/ACM Transactions on Networking,
10(4):541–550, August 2002.
[16] J. W. Stewart III. BGP4: Inter-Domain Routing in
the Internet. Addison Wesley, Reading, MA, 1999.
ISBN 0201379511.
[17] L. Xiao, K. S. Lui, J. Wang, and K. Nahrstedt. QoS
extension to BGP. In Proc. 10th International
Conference on Network Protocols, Paris, France,
November 2002.