collecting each snapshot.
Figure 4(c) plots the similarity score between A and the
other instances. While at ﬁrst glance it might appear that
browsing behavior, recent searches, and recent product clicks
all result in diﬀerent sets of ads, the problem is that even for
the control pair similarity is very low — indicative of high
levels of noise. We compared the fraction of ads shown to A
and D that contained one or more of the search query terms
and found no diﬀerence. The same held for ads containing
the interests associated with instance C, and product names
or categories used for instance E. We therefore believe that
Google does not currently use recent browsing, search, or
click behavior in picking website ads, but due to the high
noise cannot deﬁnitively make the case for it.
That said, the measurement methodology developed here
will allow us to monitor the evolution of these systems. As to
the origin of the noise, we speculate this is because contex-
tual ad systems have not yet been optimized for relevancy to
the same extent as search ad systems, especially considering
Google started collecting this data only since 2009 [9]. As
contextual ad targeting improves over time, we expect the
similarity score of the control pair to increase, and depend-
ing on whether the score for various user behaviors stay the
same or increase in the future, we hope to conclude with
certainty whether or not they are used.
3.3 Online Social Network Ads
We next turn our attention to ads on online social net-
working sites, speciﬁcally Facebook. We seek to understand
which pieces of proﬁle information (gender, age, education,
sexual-preference, etc.) Facebook uses today.
Experiment 7: We set up three (or more) Facebook
proﬁles: proﬁle A and B are set up identically (control),
while proﬁle C onwards diﬀer from A in the value of the
proﬁle parameter of interest; the number of unique proﬁles
depends on the number of values that parameter can take
(e.g. 2 for gender, 5 for education, etc.) When not being
varied, the gender was set to female, the age was set to 30,
the location was set to New York, and the remaining ﬁelds
were left empty.
Figure 5 plots the time-series of similarity scores for six
diﬀerent proﬁle parameters. In short, Facebook uses all pro-
ﬁle elements we checked. All the plots show some sort of
diurnal behavior where around midnight US east-coast time
the similarity score changes abruptly. Similar diurnal arti-
facts were observed in [5], and as in that paper, we believe
the cause is the daily reactivation of ads that exhausted their
daily budget the previous day. On the issue of proﬁle ele-
ments, it appears that the two primary factors aﬀecting ads
are the user’s age and their gender. While there exist values
for education and relationship status that aﬀect ads shown,
not all values aﬀect ads equally. For instance, there is little
diﬀerence between ads targeted to users without any listed
education and users in high-school. Similarly, if the gender
is male, or the relationship-status is married, relationship-
status has only a small impact on ads; the greatest impact
of relationship-status on ads is seen for women who are en-
gaged.
Experiment 8: Lastly, we set up six Facebook proﬁles
to check the impact of sexual-preference: a highly-sensitive
personal attribute. Two proﬁles (male control) are for males
interested in females, two (female control) for females inter-
85Control
Different age
Control
Different gender
Control
Different education
 1
 0.8
 0.6
 0.4
 0.2
 1
 0.8
 0.6
 0.4
 0.2
e
r
o
c
s
y
t
i
r
a
l
i
m
S
i
 1
 0.8
 0.6
 0.4
 0.2
e
r
o
c
s
y
t
i
r
a
l
i
m
S
i
 0
04/22 04/23 04/24 04/25 04/26 04/27 04/28 04/29
 0
04/22 04/23 04/24 04/25 04/26 04/27 04/28 04/29
 0
04/22 04/23 04/24 04/25 04/26 04/27 04/28 04/29
Time (UTC)
(a) Age group
Control
Different interests
Time (UTC)
(b) Gender
Control
Different location
Time (UTC)
(c) Education
Control
Different relationship status
 1
 0.8
 0.6
 0.4
 0.2
 1
 0.8
 0.6
 0.4
 0.2
e
r
o
c
s
y
t
i
r
a
l
i
m
S
i
 1
 0.8
 0.6
 0.4
 0.2
e
r
o
c
s
y
t
i
r
a
l
i
m
S
i
 0
04/22 04/23 04/24 04/25 04/26 04/27 04/28 04/29
 0
04/22 04/23 04/24 04/25 04/26 04/27 04/28 04/29
 0
04/22 04/23 04/24 04/25 04/26 04/27 04/28 04/29
Time (UTC)
(d) Interests
Time (UTC)
(e) Location
Time (UTC)
(f) Relationship Status
Figure 5: Age group, gender, education, interests, location and relationship-status all appear to aﬀect ads on Facebook
e
r
o
c
s
y
t
i
r
a
l
i
m
S
i
e
r
o
c
s
y
t
i
r
a
l
i
m
S
i
e
r
o
c
s
y
t
i
r
a
l
i
m
S
i
 1
 0.8
 0.6
 0.4
 0.2
 0
e
r
o
c
s
y
t
i
r
a
l
i
m
S
i
 1
 0.8
 0.6
 0.4
 0.2
 0
Control (female)
Different sexual-preference
Control (male)
Different sexual-preference
 0  20  40  60  80  100 120 140 160 180
 0  20  40  60  80  100 120 140 160 180
Snapshot (sorted)
(a) Male
Snapshot (sorted)
(b) Female
Figure 6: Sexual-preference aﬀects ads on Facebook, but more
so for males than females.
ested in males, and one test proﬁle of a male interested in
males and one of a female interested in females. The age and
location were set to 25 and Washington D.C. respectively.
Figure 6 plots the similarity scores for 1 week of data.
While there is more noise in general, unlike in 4(c) there is
a measurable diﬀerence between the control and test pairs;
we further manually veriﬁed based on ad content that this
diﬀerence is qualitative in nature (e.g. ads for gay bars were
never shown for the control proﬁles, but shown often for the
test proﬁles). The median similarity score for gay women
was 0.15 higher than for gay men, indicating that advertisers
target more strongly to the latter demographic.
Alarmingly, we found ads where the ad text was com-
pletely neutral to sexual-preference (e.g.
for a nursing de-
gree in a medical college in Florida) that was targeted ex-
clusively to gay men. The danger with such ads, unlike the
gay bar ad where the target demographic is blatantly obvi-
ous, is that the user reading the ad text would have no idea
that by clicking it he would reveal to the advertiser both
his sexual-preference and a unique identiﬁer (cookie, IP ad-
dress, or email address if he signs up on the advertiser’s
site). Furthermore, such deceptive ads are not uncommon;
indeed exactly half of the 66 ads shown exclusively to gay
men (more than 50 times) during our experiment did not
mention “gay” anywhere in the ad text.
Overall we ﬁnd that while location aﬀects Google ads,
behavioral targeting does not today appear to signiﬁcantly
aﬀect either search or website ads on Google. Location, user
demographics and interests, and sexual-preference all aﬀect
Facebook ads. As these systems evolve, our methodology
can track changes in their use of user data. We thus inform,
and hope to keep informed, the ongoing public debate about
user privacy.
4. RELATED WORK
There is little past work in studying ad networks through
measurement. In [5] we presented an ad hoc measurement
result for Google ads, however, based on our experience pre-
sented here, we now believe that result signiﬁcantly under-
estimated the number of ads and didn’t properly account for
noise.
5. SUMMARY
We have presented the ﬁrst principled and robust method-
ology for measurement-based studies of online ad networks.
We also inform the ongoing privacy debate regarding what
user data is used today for targeting search ads, contextual
ads, and ads on online social networks. Like most measure-
ment studies, however, this analysis is a snapshot in time.
Moving forwards, we hope that the methodology we have
developed can continue to be used to broaden our knowl-
edge of online advertising as well as to track trends in the
future.
866. REFERENCES
[1] CoDeeN: A Content Distribution Network for
PlanetLab. http://codeen.cs.princeton.edu/.
[2] M. Bolin, M. Webber, P. Rha, T. Wilson, and R. C.
Miller. Automation and Customization of Rendered
Web Pages. In Proceedings of The Eighteenth Annual
ACM Symposium on User Interface Software and
Technology (UIST ’05), Seattle, WA, Oct. 2005.
[3] DoubleClick. DART for Advertisers. http:
//www.doubleclick.com/products/dfa/index.aspx,
2009.
[4] J. Feng, H. K. Bhargava, and D. M. Pennock.
Implementing Sponsored Search in Web Search
Engines: Computational Evaluation of Alternative
Mechanisms. INFORMS Journal on Computing,
19(1):137–148, Jan. 2007.
[5] S. Guha, A. Reznichenko, K. Tang, H. Haddadi, and
P. Francis. Serving Ads from localhost for
Performance, Privacy, and Proﬁt. In Proceedings of the
8th Workshop on Hot Topics in Networks (HotNets
’09), New York, NY, Oct. 2009.
[6] B. Krishnamurthy and C. Wills. On the Leakage of
Personally Identiﬁable Information Via Online Social
Networks. In Proceedings of The Seconds ACM
SIGCOMM Workshop on Online Social Networks
(WOSN ’09), Barcelona, Spain, Aug. 2009.
[7] B. Krishnamurthy and C. Wills. Privacy Leakage in
Mobile Online Social Networks. In Proceedings of The
Third Workshop on Online Social Networks (WOSN
’10), Boston, MA, June 2010.
[8] B. Krishnamurthy and C. E. Wills. Cat and Mouse:
Content Delivery Tradeoﬀs in Web Access. In
Proceedings of the 15th international conference on
World Wide Web (WWW ’06), Edinburgh, Scotland,
2006.
[9] Kurt Opsahl. Google Begins Behavioral Targeting Ad
Program.
http://www.eff.org/deeplinks/2009/03/google-
begins-behavioral-targeting-ad-program, Mar.
2009.
87