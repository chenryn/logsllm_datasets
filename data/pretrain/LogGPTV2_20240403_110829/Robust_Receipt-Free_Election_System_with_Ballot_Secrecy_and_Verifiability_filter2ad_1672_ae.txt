RobustReceipt-FreeElectionSystemwithBallotSecrecyandVeriﬁabilityShermanS.M.Chow∗PI:EMAIL†PI:EMAIL‡duncan@cityu.edu.hkAbstractFormostelections,receipt-freenessisimportant–votersareunabletoprovetoothersonhowtheyvoted,inordertopreventvote-buying.Manyexistingreceipt-freeelectronicvotingsystemsarenotpracticalenoughastheyrequirevot-erstoparticipateinthetallyingphase(i.e.donotsatisfythevote-and-gorequirement),orhavenomechanismforthevoterstoverifywhethertheirvoteshavebeencounted(i.e.donotsatisfyuniversalveriﬁability).Weproposeanewwayofconstructingvote-and-goelec-tionsystemwithouttamper-resistanthardware,oranony-mouschannel.Receipt-freenessisguaranteedevenifthereisonlyonevotingauthority(inadistributedsetting)be-inghonest.Regardingthecorrectness,voteralonehasnochancetotamperwiththevalidityoftheﬁnaltally,whileanymisbehavingauthoritycanbedetected(andproventothepublic)bythetallyingcenter.Robustnesscanbeachievedbyﬁxingthecorruptedvoteinaveriﬁableman-ner.Ballotsecrecycannotbecompromisedevenifalltally-ingauthoritiescollude.Keywords:electronicvoting,receipt-freeness,universalveriﬁability,robustness,ballotsecrecy,homomorphicen-cryption,escrowedlinkableringsignatures1.IntroductionElectronicvoting(e-voting)generallymeansthecol-lectionanddisseminationofpeople’sopinionswiththehelpofsomeelectronicmeans(e.g.ballotsprocessingandautomatedveriﬁcation,etc).Thispaperstudiesthecryptographicdesignofe-votingsystem.Cryptographershavebeenproposingconstructionsfore-votingsincethe1980s[12,18].Afteralltheseyearsofresearcheffort,we∗DepartmentofComputerScience,CourantInstituteofMathematicalSciences,NewYorkUniversity,NY10012,USA.†InstituteforInfocommResearch(I2R),Singapore.‡DepartmentofComputerScience,CityUniversityofHongKong,HongKong,China.seesomerealsystemsbeingusedovertheworld;examplescanbefoundinthecryptographicliteraturesuchas[4,37].Numerousfunctionalandsecurityrequirementsfore-votingsystemhavebeenformalized.Forexample,in[26],sevenrequirementsarelisted:completeness,soundness(orrobustness),privacy(orballotsecrecy),non-reusability(ordoublevotingdetection),eligibility,fairnessandveriﬁa-bility.Recentresearchhasproposedsomemoredesirableproperties.Oneisreceipt-freeness[10,33],whichpreventsavoterfromprovingtoothersthats/hehasvotedforapar-ticularcandidate.Suchafeatureisessentialinordertopre-ventvotersfromsellingtheirvotes.1.1.MajorApproachesOveryears,manydifferentapproacheshavebeenpro-posedforconstructinge-votingsystems.Wereviewsomeofthemajorones.1.Blindsignatures[13,26,50,49]:Schemesbasedonblindsignaturesaresimpleandefﬁcient,whichmaybesuitableforlargescalevoting.However,votersarere-quiredtoobtainsometokensbeforeeachvotingevent,whichmeansthataregistrationphaseisnecessary.Atthesametime,universalveriﬁabilitymaynotbepossi-blesincetheregistrarcanjustaddmoreballotstobiasthetally.Ananonymouschannel[12,31,51]betweenthevoterandthetallyingofﬁcialisalsorequiredtokeeptheidentityofthevoterconﬁdentialatballotcast-ing.Thisrequirementmaybeinhibitingandmix-net[12]maybeusedtorealizeit.2.Mix-nets[51,57,2,34,35,3,33,27,47,28,30,40,4,54]:Mix-netisanetworkofservers(mix-center)whichtakesasetofciphertextsasinput,andoutputsthecorrespondingplaintextsaccordingtoasecretper-mutation.Schemesbasedonmix-netsrequirethebal-lotstobepermutedatsomepointbetweenleavingthevotersandarrivingatthetallyingofﬁcials.Theyaregenerallynotefﬁcientsincecomputationaleffortisre-quiredformultiplemixerstoprovethecorrectness.Inaddition,theanonymityprotectioncomesfromthemix-net,thefunctionofwhichmaypossiblybeper-formedbythetallyingcenterinarealworldscenario.Thus,thetallyingcentermustbetrusted.Thisproblemcanbepartiallysolvedbydistributingitovermanymachinessothattrustisplacedonlyonathresholdnumberofthem.3.Homomorphicencryption[9,56,20,21,33,32,42,22,41,53,39,4]:Votingschemesusinghomomorphicencryptionareefﬁcientingeneral.Extensiveresearchusingthisapproachhadbeendone,butonlyafewofthem(suchas[33,32])canachievereceipt-freeness.4.Ringsignatures[44]:Roughlyspeaking,aringsig-natureisasigner-ambiguoussignature.Eachvotersignsonher/hisvotebyaringsignaturetoconﬁrmher/hisvoting.Theambiguityintherealidentityofthesignerprotectsthevoter-voterelationshipfrombe-ingknown.However,somespecialmechanismisre-quiredtodetectdoublevoting.Thisalsomotivatestheintroductionofthelinkabilityintheringsignatureparadigm[44],sotworingsignaturesproducedbythesamesignercanbelinked.Thesuitabilityofeachofthesefourtypesvarieswiththeconditionsunderwhichitistobeapplied.1.2.Receipt-FreenessGenerallyspeaking,receipt-freenessmeansavotercan-notprovetoathirdpartythathehasvotedforaparticu-larcandidate.Inotherwords,vote-buyingisnotpossible.Inanordinarymix-netorhomomorphicencryptionbasedscheme,anadversarycansimplyfurnishthevoterwithaciphertextonaparticularcandidate,andthenverifythatthevoterhaspostedaballotcontainingthatciphertext.Theblindsignaturebasedschemessufferfromsimilarvulner-abilities.Forringsignaturebasedschemes,avotercansimplyrevealtherandomnessoftheringsignaturehehaspostedtoshowthatheistheactualsigner.Sincetheran-domnessisthesourceofsigner-anonymity,doingsocanclaimtheauthorshipofaparticularballot.Theﬁrstschemeclaimedtobereceipt-freewasproposedbyBenalohandTuinstra[10],althoughitwaslatershowntobenot[33].Okamoto[50]proposedaschemewithreceipt-freenessthatmakesuseofblindsignatures.Itassumestheexistenceofananonymousuntappablechannelandrequiresthreetimesofvoterandsysteminteractioninthecourseofanelection.Thatis,theyrequireeveryvotertoparticipateeveninthetallyingphase.SakoandKilian[57]proposedane-votingschemewithmulti-authorityusingmix-netandhomomorphicencryption,whichispostulatedtobereceipt-free.Eventhoughitsreceipt-freenesscannotbeguaranteedunderthecommonlyusedassumptionthatonlyonemix-centerishonest,itservedasabasisforthelaterworkofHirtandSako[33]andamoreefﬁcientapproachin[8].Receipt-freenesscomeswithsomeassumptions.Alloftheabovebut[50]havethereceiptavailableifthead-versarycancorruptevenoneofthetallyingauthoritiesinadistributedsetting.Asnotedin[37],systemsin[33]and[8]stillretainreceipt-freenesswhensuchacorrup-tiontakesplace,butonlyunderastrongerassumptionthatthevoterknowswhichtallyingauthoritieshavebeencor-rupted.Juels,CatalanoandJakobsson[37]proposedareceipt-freevotingscheme,whichisoneofthemostefﬁ-cientandpracticalschemestodate.Itonlyrequiresoneofthetallyingauthoritiestobehonestforprovidingreceipt-freenesswhiletheballotsecrecydependsontheanony-mouschannelandthehonestyofatleastoneamongthegroupoftheregistrars(entitiesresponsibleforregistra-tion)andtallyingauthorities.Inaddition,itcanevenpro-videastrongerformofreceipt-freeness,calledascoercion-resistance,whichdefendsagainstrandomization,forced-abstentionandsimulationattacks(detailscanbefoundin[37]).However,coercion-resistancedoesnotallowthevot-erstoverifywhethertheirvoteshavebeencounted(i.e.,nouniversalveriﬁability).Besidestheaboveschemes,mostoftheotherschemessuchas[42,38,41,31,40,45]requireeithertamper-resistanthardwareorarandomizertoprovidereceipt-freeness.1.3.OurContributionInthispaper,wemakeuseoftheescrowedlinkableringsignature[17]togettherobustnessandthereceipt-freenesssimultaneously.Theunforgeability(inanappropriatesenseinthecontextofescrowedlinkableringsignature)givestherobustness,sothemisbehaviorinpreparinganinvalidballotcanlaterbeattributedtosomeone(eitheravotingcenteroravoter)inanon-repudiablemanner.Receipt-freenesscomesfromthesigner-ambiguityandtheprivatelinkabilityoftheringsignature.Eventhoughithasbeenpreviouslysuggestedthatlink-ableringsignaturecanbeusedtoconstructe-votingsystem[44],webelievethatourstudyprovidesabetterandmorecomprehensivesolution.Weadvocateusingidentity-basedlinkableringsignaturestoaddresstheproblemofrequir-ingallpotentialvoterstogettheirpublickeys.Weprovidemorethanthedoublevotingdetectionmechanismbroughtbyplainlinkableringsignatures.Indeed,ourapplicationofescrowedlinkableringsignaturesisfundamentallydif-ferentfromtheuseoflinkableringsignaturesorlinkablecredentialsinprevioussimplee-votingsystems[44,45].Ourproposalenjoysthefollowingmajorproperties:•RECEIPT-FREENESS:Ourschemeprovidesreceipt-freenesswithoutusinganyrandomizerortamper-resistantdevice.Weonlymakethebasicassumptionthatatleastoneofarbitraryvotingauthoritiesremainshonest.Inourscheme,thehonestauthoritycanbeun-knowntothevoters.Alltheyneedtobelieveisatleastoneofthem(nomatterwhich)ishonest,incontrastwiththeschemesin[33,8].•UNIVERSALVERIFIABILITYANDCORRECTNESS:OurschemeprovidesuniversalveriﬁabilityincontrastwithJuelsetal.’sscheme[37]whichisnotuniversalveriﬁable.Moreover,theirschemereliesontheassumptionthattheadversarycanonlycorruptaminorityoftallyingauthorities.Weobservethatcorruptingallofthemmeanstheencryptedcredentialpostedbyvotersinthebulletinboardcanbedecrypted.Withsuchacredential,anadversarycanpretendtobeavotertocastavoteandaffecttheresult.(Thisobservationdoesnotcontradicttothesecurityresultclaimedin[37].)Regardingthecorrectnessofourscheme,voteralonehasnochancetotamperwiththevalidityoftheﬁ-naltally.Anymisbehavingpartywhointroducescor-ruptedvotescanbedetectedbytallyingauthorities.Atthesametime,tallyingauthoritiescanprovetothepublicaboutthis.Ourschemeisalsorobustinthesensethatthecorruptedvotescanbeﬁxed,againinapubliclyveriﬁablemanner.•BALLOTSECRECY:Inourscheme,votercontributestotherandomnessintroducedintheencryptionofchoice,whichmeanseventhecollusionofallvotingauthoritiescannotrevealaparticularballot.Sinceathresholdnumberoftallyingauthoritiescancometo-getherandopenanyencryptedballot,thevoter-voterelationshipisunderprotectionifthemajorityoftally-ingauthoritiesorallvotingauthoritiesarehonest.•NOREGISTRATION/AUTHORIZATIONSTAGE:Un-likemanyotherschemes,especiallythoseusinganonymouschannel(suchas[50,37]),ourschemedoesnotrequireanyregistrationstage.Intheseschemes,thevoterisassumedtohaveaprivate/publickeypair(moregenerally,acredentialanditspublicrepresentation[37])forprovingeligibilitytothereg-istrarintheregistrationstage.Inotherwords,bysay-ingregistration-freewedonotmeanthevotersarefreefromgettingapublickeycertiﬁcatefromapublickeyinfrastructure(PKI).Ourschemeemployslinkableringsignaturestore-movetheregistrationstage.Nevertheless,thegener-ationofsuchsignaturesinvolvesthepublickeysofalllegitimatevoters.Thisrequirementcanberemovedifidentity-based(ID-based)infrastructure(inparticu-lar,ID-basedlinkableringsignaturescheme[6,17])isusedinstead,suchthatthosewhowanttovotewillnotbeaffectedbythosewhodonotbothertogettheprivatekeyoftheiridentities.Ofcourse,justlikethecommonlyusedtrustassumptionthatthecertiﬁcateauthorityofPKIwouldnotlaunchanactiveimperson-ateattack,wemakeasimilarassumptionforourID-basedcase.AdvantagesofID-basedringsignaturesovertraditionalPKIbasedonearediscussedin[16].•VOTE-AND-GO:Oncethevoterhascasther/hisvote,oursystemrequiresnofurtheractionfromthevotertogettheﬁnalvotingresult,whichisanicefeaturesincevotersmayﬁndadditionaldutiestedious.Forexample,thevoterisrequiredtoopenthetrapdoorcommitmentin[50],orthe“encrypted”ballotcannotbeopened.Ontheotherhand,ourschemeispubliclyveriﬁable,soavoterwhowantstoverifythecorrectnessoftheresultcanparticipateinapublicauditaftertheﬁnaltallyingphase,whichmaymakethevotersfeelthattheirparticipationisimportantordutiful.Inaddition,ourschemesupportsdoublevotingdetec-tion,andmorethantwocandidates(i.e.notrestrictedtoayes/novote).Table1summarizesthecomparisonofdifferentreceipt-freevotingschemeswithoutusinganytamper-resistancedeviceorrandomizer.Organization.InSection2,wedescribetheframeworkofane-votingsystem.InSection3,wedescribetheprimitivesfromwhichourschemeisbuilt,beforethedescriptionofoure-votingschemeinSection4.Finally,someconcludingremarksaremadeattheendofthepaper.2.VotingModel2.1.EntitiesTherearethreetypesofentitiesinthesystem.Voters:Votersarethepeoplewhoareauthorizedtovote.Intherestofthepaper,weuseUtodenoteapartic-ularvoterwhoisabouttovote.Let(xU,yU)betheprivate/publickeypairofU.VotingCenter/VotingAuthorities:Weusethetermvot-ingcentertorefertothelogicalentityresponsiblefororganizingthevoting.ItstaskmaybeseparatedintoNV>1votingauthoritiesV1,...,VNV.TallyingCenter/TallyingAuthorities:Tallyingcenterisresponsiblefortallyingandpublishingvotingresults.Let(xT,yT)betheprivate/publickeypairofthecen-ter.Again,thetaskofatallyingcentercanbedis-tributedtoNTauthorities,denotedbyT1,...,TNT.Receipt-freeUniversalWithoutBallotsecrecyWithoutVote-Schemes(onlyonetallyingVeriﬁableAnonymous(alltallyingRegistrationand-Goauthorityishonest)Channelauthoritiescollude)StageOkamoto[50]✓✓✘✓✘✘Sako-Kilian[57]✘✓✘✓✓✓Hirt-Sako[33]✓✓✓✘✓✓Baudronetal.[8]✓✓✓✘✓✓Juelsetal.[37]✓✘✘✓✘✓Ourscheme✓✓✓✓✓✓Table1.Propertiesofdifferentreceipt-freevotingschemesBesidestheentitiesabove,wealsoassumetheexistenceofthefollowingobject.BulletinBoard:Itcanbeconsideredasabroadcastchan-nelwithmemory,suchthat(1)allentitiescanreadthecontentoftheboard;(2)anyentitycanappendinfor-mationontotheboard;and(3)noonecanremoveanyinformationthathasalreadybeenwrittentotheboard.Itiscommonlyusedforachievinguniversalveriﬁabil-ity,e.g.[21].Thebulletinboardcanbemodeledformallybyastate-fuloraclewithtwoqueriespostandget.Thequeryposttakesamessagem∈{0,1}∗andstoresminitsstateBB,withoutgivinganyreturnvalue.ThequerygettakesnoinputandreturnsBB.2.2.FunctionsSupposetherearenelectioncandidates(choices)andtheyareindexedfrom1ton.LetLbethelistofpublickeysofallthevoters.Ourvotingprotocolproposedinthesubsequentsectioniscomposedofthefollowingfunctions.Setup:param←Setup(1k)isarandomizedalgorithmthattakesasecurityparameterkandoutputsthesys-temparameterthatwillbeusedbyalltheotheralgo-rithms.Inparticular,paramincludesauniqueeventidentiﬁereID,thecryptographicsecurityparameterkandthedescriptionofallcryptographicalgorithmstobeused.Forbrevity,wewillomittheinclusionofsys-temparameteraspartoftheinput.KeyGeneration:(x,y)←Gen()isarandomizedalgo-rithmthatoutputsaprivatekeyxandthecorrespond-ingpublickeyy.Forsimplicityofthediscussion,weomitthedetailsofmasterkeygenerationandtheusersecretkeygenerationintheID-basedcase.Voting:ballotU(β)←Vote(xU,yT,L,β)isarandom-izedalgorithmthattakesU’sprivatekeyxU,thepub-lickeyofthetallyingcenteryT,thelistofpublickeysofalllegitimatevotersLandacandidatese-lectionβ∈{1,···,n};outputssomebinarystringballotU(β)tobepostedonthebulletboardBB.Theabovedescriptioncapturestheessentialcharacter-isticsofthevotingphaseofanyelectionsystem.Inourscheme,votingisdoneviaaninteractiveprotocolbetweenthevoterandthevotingcenter,wherethevot-ingcenterusesitsprivatekeyasitssecretinput,andthevoteralsotakesthepublickeyofthevotingcenterasthepublicinput.Tallying:(X,P)←Tallying(xT,L,BB)isadeterminis-ticalgorithm,whichtakestheprivatekeyofthetal-lyingcenterxT,alistofpublickeysofalllegitimatevotersLandthefullcontentsofthebulletinboardBB;outputsavotetallyX,alongwithanon-interactiveproofPthatthetallywascorrectlycomputed.Veriﬁcation:0/1←TallyVerify(yT,L,BB,X,P)isade-terministicalgorithmwhichtakesthepublickeyofthetallyingcenteryT,alistofpublickeysofalllegitimatevotersL,thefullcontentsofthebulletinboardBB,thevotetallyXandtheassociatednon-interactiveproofPforcorrecttallying.Itsoutputiseither0or1,mean-inginvalidorvalidrespectively.Inourscheme,thepublickeyofthevotingcenterisalsoinvolved.2.3.RealWorldDeploymentAssumptionsWeassumethat,oncethecommunicationbetweenthevoterandthevotingcenterstarts,avote-buyer(oranythirdparty)isnotallowedtocommunicatewiththevoter.Thatis,weassumethatthevotingcenterisreallycommunicatingwiththepurportedvoter,notavote-buyerorotheradver-sary.Wealsoassumethatthevote-buyerisnotallowedtovieworvideorecordthewholeprocessofthevotingphase(forexample,hestandsbehindthevoterandwatcheswhathehastypedinthecomputer).Similarto[33],weassumeuntappablechannelsbetweenthevotersandthevotingau-thorities,whichisalsorelatedtoarecentresult[14]thatonecannotgetuniversalveriﬁabilityandreceipt-freenesssimultaneouslyunlessthevotingprocessinvolvesinterac-tionsbetweenvotersandpossiblythevotingauthority.3.CryptographicPrimitivesOurschemeusesthefollowingcryptographicprimitives.3.1.ProofofKnowledgeAΣ-protocolforanNP-relationRisatwo-partythree-roundprotocol,suchthatforeveryinput(x,y)∈RtoaproverPandytoaveriﬁerV,Pﬁrstlysendsacommit-mentmessagea,VreplieswitharandomchallengecandPconcludeswitharesponsemessagez.AttheendVoutputsa0/1valuelocally,dependingonyandthecommunicationtranscript(a,c,z)only;atranscriptisvalidiftheoutputofVis1.Inaddition,aΣ-protocolmustsatisfythefollowingtwoproperties.(SpecialSoundness.)Thereexistsaprobabilisticpolyno-mialtime(PPT)extractortakesaninputyandtwovalidtranscriptswiththesamecommitment(a,c,z)and(a,c,z"),outputsxsuchthat(x,y)∈R.(SpecialHonest-VeriﬁerZero-Knowledge.)ThereexistsaPPTsimulatorwhichtakesinputyandanychallengec,outputapair(a,z)suchthat(a,c,z)isavalidtran-scriptandisdistributedaccordingtotheprobabilitydistributionofonereturnedbytheinteractionofPandVviaP(x,y)↔V(y),foranyywhere(x,y)∈R.AΣ-protocolcanbegeneralizedtoan1-out-of-nwitnessindistinguishableproof[19]asillustratedintheAppendixA.Moreover,itcanbemadenon-interactive.BytheFiat-Shamirheuristics[25],everythreeroundsproofofknowl-edgeprotocolsthatishonest-veriﬁerzero-knowledgecanbeturnedintoanon-interactiveproof-of-knowledgeproto-colbysettingthechallengetothehashvalueofthecom-mitmentatogetherwithotherauxiliarydatainvolved.3.2.DesignatedVeriﬁerProofofKnowledgeUsingtheFiat-Shamirtechniquetomaketheproof-of-knowledgenon-interactivemakestheresulting“transcript”initselfatransferableproof,thecorrectnessofwhichcanbeveriﬁedbyanyone.Thisuniversalveriﬁabilitymaynotbedesirableinsomeoccasions.Jakobssonetal.[36]constructedanon-interactivedes-ignatedveriﬁerproof.Thedesignatedveriﬁercanalwaysusehistrapdoortosimulateatranscriptforanystatement.Anyotherpartycannotdistinguishavalidproofofatruestatementfromasimulatedproof.Designatedveriﬁerproofisalsousedinsomeexistinge-votingsystem(e.g.[33]).3.3.(Escrowed)LinkableRingSignaturesTheideaofringsignatureswasformalizedbyRivestetal.[55].Ringsignatureschemesenableonetosignonamessageinawaythatanyonecanensurethesignatureisgeneratedbysomeonefromagroupofsignerswhichin-cludestherealsigner,butdonotknowexactlywho.Thediversiongroupofsignersisformedspontaneously,whichmeansonesmaybetotallyunawarethattheyareinvolvedinaringsignature.Severalringsignatureschemeshavebeenproposed[23,11,15].Manyofthemenjoyunconditionalanonymity–noonecanlaterrevealtheactualsigner,otherthantheactualsignerherself/himself.Notethatatwo-partyringsignaturecanbeusedasades-ignatedveriﬁersignature,i.e.onlythedesignatedveriﬁergetsconvincedthatthesignatureisvalid,butcannotprovetoanyoneelse.Traditionalringsignatureschemessupportunlinkability:itisnotpossibletodecidewhethertwosignatureshavebeenproducedbythesamegroupmember.Thenotionoflinka-bilityinringsignatureschemeswasﬁrstintroducedbyLiu,WeiandWong[44].Inadditiontothe1-out-of-nsigner-anonymity,italsoallowsanyonetodeterminewhethertwosignatureshavebeenproducedbythesamesigner.Thelink-abilityisdeterminedbyalinkabilitytagthatmustpresentinavalidringsignature.Givenaneventidentiﬁerandtheuser’sprivatesigningkey,thelinkabilitytagisuniquelyde-termined.Inthisway,ringsignaturesforthesameeventfromthesameusercanbelinked.Theﬁrstschemein[44]usesasingletypeofpublickeywhiletheschemein[60]allowsdifferenttypestobeusedtogether.SchemesinID-based[17,6]andcertiﬁcate-based[7]settingsareproposedlateron.Schemesin[44,60]havesignaturesizelinearinthesizeofthediversiongroup.Examplesofconstant-sizelinkableschemeincludetheID-basedschemein[17,6]andthePKI-basedschemein[5].Chow,SusiloandYuenmadeafurtherreﬁnementoftheanonymityofringsignatures[17]suchthatthelinkabilitycanbeescrowed,i.e.thelinkingcanonlybedonebyalinkingauthority.Whilethelinkabilitytagisstilladeter-ministiconeasin[17],itisencryptedbyaprobabilisticencryptionalgorithm,anditiscomputationallyimpossibletoprovethenon-authorshipofsomeoneelse’ssignature.Ourconstructionusestheescrowedlinkableringsigna-turestorealizethedesignatedveriﬁersignatures,soonlythevotercanverifyandonlythelinkingauthority(inwhichthefunctioncanbeperformedbythetallyingcenterinoursystem)canlaterrevealwhoistheactualsigner,whichhelpprovidingthereceipt-freenessandtheveriﬁability.Lookingahead,linkableringsignatureswillhelpindou-blevotingdetection,andescrowedlinkableringsignaturesensurethedetectionofmisbehavingvotingauthorityandtherobustness(bysigningthere-randomizationintroducedinan“untransferable”manner,i.e.thesignatureisonlycon-vincingtothedesignatedveriﬁerbutnooneelse).3.4.FunctionsNotationforSignaturesWedeﬁneasetofsignatureprimitivefunctionshere.•σ←SignV(m)takesaninputofamessagemandtheprivatekeyofthevotingcenterV,returnsanormalsignatureσsignedbyV.•0/1←SigVerifyV(m,σ)takesaninputofmes-sage/signaturepair(m,σ),andthepublickeyofV,returns1ifthemessage/signaturepairisvalidand0otherwise.•σ∗←LRingSignL,eID(m)takesaninputofames-sagem,thepublickeysofallmembersinagroupL,auniqueeventidentiﬁereID,andaprivatekeyofoneofthemembersinthegroupL,returnsalinkableringsignatureσ∗.•0/1←LRingVerifyL,eID(m,σ∗)takesaninputofmessage/signaturepair(m,σ∗),thepublickeysofallmembersinthegroupL,auniqueeventidentiﬁereID,returns1ifσ∗isasignatureonmsignedbysomeoneinthegroupLfortheeventeID,and0otherwise.•σ∗←ELRingSignL,eID(m,pk!a)takesaninputofamessagem,thepublickeysofallmembersinagroupL,auniqueeventidentiﬁereID,aprivatekeyofoneofthemembersinthegroupL,andthepublickeyofthelinkingauthoritypk!a,returnsanescrowedlink-ableringsignatureσ∗.•0/1←ELRingVerifyL,eID(m,σ∗,pk!a)takesanin-putofmessage/signaturepair(m,σ∗),thepublickeyofthelinkingauthoritypk!a,thepublickeysofallmembersinthegroupL,andauniqueeventidenti-ﬁereID,returns1ifσ∗isasignatureonmsignedbysomeoneinthegroupLandthelinkabilitytagisveriﬁablyencryptedto#a,0otherwise.•0/1←LinkeID(σ0,σ1[,sk!a])takesaninputoftwovalidsignatures(σ0,σ1),auniqueeventidentiﬁereID,andpossiblythesecretkeyofthelinkingauthor-itysk!a,returns1ifbothsignaturesareissuedbythesamesignerforthesameeventeID,0otherwise.3.5.HomomorphicEncryptionFortheeaseofunderstanding,weuseElGamalencryp-tioninourscheme,whichisreviewedinAppendixB.WeremarkthereareotherhomomorphicencryptionschemeslikePaillierencryption[22].3.6.EncodingofCandidatesRecall|L|isthenumberoflegitimatevoters,supposecandidateigetscivotesfromthese|L|voters,letγ∈Gbeageneratorchosenrandomlyand#beanotherintegersuchthat∀i∈{1,···,n}:ci1,Vireceives(Ai−1=gr!j1),Vicomputes(Ai=ai·Ai−1,Bi=bi·Bi−1)andsendstoU.9.Ifi<NV,VigeneratesasignatureσVi=SignVi((Ai,Bi,PU)),andsends(Ai,Bi)withthesignatures{σVj,j≤i}toVi+1viaasecurechannel.Ifi=NV,VNVgivesasignatureσVNV=SignVNV((ANV,BNV,PU))toU.Thisstepisforthe“transitionoftrust”.Forefﬁciencyofthenextauthority’sveriﬁcation,thissignaturecanbereplacedbyamessageauthenticationcode(MAC)withsecretkeysharedbetweenallauthorities.10.UveriﬁesthatAi=ai·Ai−1andBi=bi·Bi−1.EndofForLoop11.UpostsmU=(ANV,BNV)||σVNV||PUtogetherwiththelinkableringsignatureσ∗U=LRingSignL(mU)tothebulletinboard.Notethateventhenumberofvotingauthoritieshasin-creased,thevoteronlyneedstoinvolveintheproof-of-knowledgeprotocol(asaprover)once(withV1).Onlyamildcomputationalburdenisincurred.ThisalsomeansthatiftheﬁrstvotingauthorityV1col-ludeswiththevoter,noproofhasbeenmadeaboutthewell-formnessoftheencryptedvote.However,notethatV1hassignedontheencryptedvote,thecorruptedpartis“marked”andwecanalwayscancelitandframeV1later.4.4.2VoteTallyingPhaseVotetallyingproceedsasinthebasicversion.4.5.SecurityAnalysisReceipt-freeness.Sincetheprotocolstartsbyrequiringthevoterto“commit”ﬁrstlytotherandomfactortobeusedintheciphertext,thisrandomfactorcannotbechoseninawaydependingontheotherrandomfac-torstobeintroducedbythevotingauthorities.Theﬁnalciphertextpostedonthebulletinboardis(A=gr+Pjsj,B=yTr+Pjsjmk)wheremkisthechoiceofthecandidate.Whenanarbitraryvotingauthority(e.g.V!)ishonest,UdoesnotknowtherandomnessR=r+"jsjsinces!isunknown.Thebests/hecandoistoshowtheknowledger"=R−s!suchthatlogyT(B/B"/mk)=r",whereB"issupposedtobeyTr"that“cancel”allthecomponentsthats/hedoesnotknowthecorrespondingexponent.However,thevalidityofB"cannotbeshownwithde-cisionalDifﬁe-Hellmanassumption.Foranymk,onecanjustrandomlyselectsr"∈ZpandcomputesB"satisfyingtheequation(B/B"/mk)=yr".Suchapropertymakes“extraction”ofreceiptisimpossible.Asdiscussedbefore,iftheauthorityVisigns(ai=gsi,bi=yTsi)receiptcanbemade.Thisiswhereescrowedlinkableringsignaturecomestoplay.Bygeneratingaringsignaturewiththesignergroupbeingthevoterandtheauthority,boththevoterandtheau-thoritycangeneratesuchasignature.Thevotercannotconvinceanyotheraboutthe“validity”ofB".Withtherealworlddeploymentassumptionswehavemade,physicalrecordingandmasqueradearenotpossible.Thedesignated-veriﬁerproof-of-knowledgeprotocolsareexecutedinaninteractivemanner,whichconvincesnooneelseaboutthevalidityofthestate-mentstobeproven.Twomorepointstonote.Thesignatureonthepseudonymprovidesnoclueaboutthecandidatechoice.Knowledgeofanyrandomnessinvolvedinthelinkableringsignaturecannotproveavoteonapartic-ularcandidateiscast.CompletenessandUniversalVeriﬁability.Inthevotingphase,thevoterprovestoeachauthoritythattheen-cryptions/heproduces,aftercancelingthefactorscon-tributedbytheauthorities,isindeedtheencryptionofavalidencodingofoneofthecandidates.Forthepartcontributedbytheauthorities,notethateachauthorityViusesescrowedlinkableringsignaturetosign(ai,bi,PUk)foreachvoterUk.ThetallyingcentercaneasilycheckwhetherVihascheatedinanyre-randomizationprocessbycheckingif!{ai}xT=!{bi}.Eitherthevotingauthorityorthevoterhasgeneratedthissignature.Incaseofthedispute,theconcernedvoterissuesanescrowedlinkableringsignatureaswell.Thetallyingcentercanconﬁrmwhothecheaterisbythelinkability.Anycheatingbehaviorcanbeshowntothepublicbyanon-interactiveproof.Giventhedataonthebulletinboard,itispossibleforanyonetoverifywhichencryptedvotesarevalid:thosethataresignedbythevotingauthorities(asshownbyavalidsignaturebythelastvotingauthority)whichmeansthere-randomizationprocesseshavebeentakenplace,andwithalinkableringsignatureproducedbyavoterwhohasnotsignedanyothervotes.Notethevotershouldpostthediversionsignergroupofthesignatureifthevoterdecidednottoincludeallthelegitimatevotersinthesignersgroupbyanyrea-son.Thisisnecessarysincetheveriﬁcationalgorithmalsotakesthesignersgroupasaninput.Givenalltheencryptedvotes,anyonecanaggregatethemandcomputetheﬁnalencryptedtally.Usingthetallycenter’sprivatekey,thetallycenterisabletoproduceanon-interactiveproofthattheresultitpublishesisthecorrectdecryptionoftheencryptedtally.Robustness.Locatinginvalidre-randomizationcanbedonebyabinarysearch[46].Forthecorrectionofthetally,thecorruptedvoteisﬁrstlylocatedbyusingthepseudonymastheindexofthevote.Then,theproblematicaiandbicanberemovedfromAandBrespectively.Ifitistheuserwhocontributedacorruptedvote(possiblybyacollusionwithsomevotingauthority),thatvoteissimplydiscard.BallotSecrecy.Withtheuseoflinkableringsignature,noonecanrevealtheactualidentityofthesigner.Votercontributestotherandomnessintroducedintheen-cryptionofchoice,whichmeanseventhecollusionofallvotingauthoritiescannotrevealaparticularballot.However,weremarkthatunderastrongattackwhichcompromisesboththetallyingcenterandavotingauthoritycanrevealthevoter-choicerelationship.Fairness.Everyvoteandanypartialtally,isencryptedusingthepublickeyofthetallyingcenter.Novoterisabletolearnabouttheoutcomeoftheelectionbeforetheﬁnalresultispublished.DoubleVotingDetection.Anydoublevotingcanbedetectedusingthelinkabilitytagsofthelinkableringsignatures.Anonymitywouldnotbeaffectedifthesamekeyisusedinmultipleelectionssincethelinkingcanonlybedonewithrespecttothesamevotingevent.Thesignaturesfromthesamesignerfordifferenteventsremainunlinkable.Finally,evenifthevoterfailstoincludesomeofthelegitimatevotersinthesignersgroupofthesignatureforwhateverreason,doublevotingdetectionisstillpossiblesincelinkingisbasedontheeventidentiﬁerbutnotthesignersgroup.4.6.EfﬁciencyAnalysisEachvoteonthebulletinboardcontainsthefollowingsignaturesandthecorrespondingmessages:onenormalsig-naturesigningaconstant-sizeciphertext,andoneconstant-sizelinkableringsignaturesigningaconstant-sizecipher-text,Thesizeofthewholebulletinboardisthuslinearinthenumberofvoters|L|.NotethattheO(|L|×NV)num-bersofescrowedlinkableringsignaturesarenotnecessarytobeposted.Theyarejustusedtolocatecorruptedvotes.5.ConcludingRemarksWeapplyescrowedlinkableringsignature[17]ine-votingsystemtogettherobustnessandthereceipt-freenesssimultaneously.Ourapplicationisfundamentallydifferentfromthepreviouslysuggesteduseoflinkableringsignatureinsimplee-votingsystems,andbringsanewtooltothesetofcryptographictechniquesenablinge-votingsystems.Weuseanidentity-basedsolution[17]suchthatthepub-lickeysforthosewhoarenotinterestedinvotingareim-plicitlydeﬁned,andthusothervotersarefreetovoteevenifthereexistsomelegitimatevoterswhodonotbothertogetakeyatall.Itmaybeinterestingtoseeifotheridentity-basedprimitiveswithprivacyconcernscanhelpbettere-votingsystems.Forexamples,onemaystudyiftheblindkeyextractionprotocolin[29]canbeusedtoissueananony-mouscredentialfore-voting,andtherelationshipbetweenthereceiver-anonymityofsomeidentity-basedencryptionschemes[1]andtherealizationofanonymouschannels.Ourworkaimstoachievereceipt-freenessbutnotastrongernotionofcoercion-resistance[37].Inparticular,itmaybeinterestingtodevisesome“fake-key”generationalgorithmcorrespondingtosomeidentity-basedschemestoﬁghtagainstsimulationattacks,inwhichanattackerco-ercesavotertodivulgetheprivatekey.Itisalsointerestingtostudyifthetechniqueshereandthosefrom[37]canbecombinedtoachieveanicesetofsecuritypropertiessimul-taneously.Finally,weacknowledgethatmanyissuesstillneedtobeaddressed;forexamples,developmentissuessuchassecureimplementationandtesting;andevenmoredeploymentis-sueslikelegislationpolicy,educationandtraining,voter-eligibilitychecks,physicalsecurity,networkandcomputersecurityissueslikemaintainingbackupandavailability.Wehopetoofferacomprehensivesolutionofusingringsigna-turesine-voting,andalternativeschoicesofcryptosystemsthatmaybeusefulforareal-worldfull-blownsystem.References[1]M.Abdalla,M.Bellare,D.Catalano,E.Kiltz,T.Kohno,T.Lange,J.Malone-Lee,G.Neven,P.Paillier,andH.Shi.SearchableEncryptionRevisited:ConsistencyProperties,RelationtoAnonymousIBE,andExtensions.JournalofCryptology,2008.Toappear.[2]M.Abe.Universallyveriﬁablemix-netwithveriﬁcationworkindependentofthenumberofmix-servers.InEURO-CRYPT98,pages437–447.Springer-Verlag,1998.LNCS1403.[3]M.Abe.Mix-networksinpermutationnetworks.InASI-ACRYPT99,pages258–273.Springer-Verlag,1999.LNCS1716.[4]R.Aditya.SecureElectronicVotingwithFlexibleBal-lotStructure.PhDthesis,InformationSecurityInstitute,QueenslandUniversityofTechnology,Nov.2005.[5]M.Au,S.S.M.Chow,W.Susilo,andP.Tsang.Shortlink-ableringsignaturesrevisited.InEuroPKI2006,pages101–115.Springer-Verlag,2006.LNCS4043.[6]M.Au,J.K.Liu,W.Susilo,andT.H.Yuen.Constant-sizeID-basedlinkableandrevocable-iff-linkedringsignature.InINDOCRYPT2006,volume4329ofLNCS,pages364–378.Springer-Verlag,2006.[7]M.Au,J.K.Liu,W.Susilo,andT.H.Yuen.Certiﬁcatebased(linkable)ringsignature.InISPEC2007,volume4464ofLNCS,pages79–92.Springer-Verlag,2007.[8]O.Baudron,P.A.Fouque,D.Pointcheval,G.Poupard,andJ.Stern.Practicalmulti-candidateelectionsystem.InPODC2001,pages274–283.ACMPress,2001.[9]J.Benaloh.Veriﬁablesecret-ballotelections.PhDthesis,DepartmentofComputerScience,NewHaven,YaleUni-versity,Sept.1987.[10]J.BenalohandD.Tuinstra.Receipt-freesecret-ballotelec-tions.In26thACMSymp.onTheoryofComputing(STOC),pages544–553.ACM,1994.[11]A.Bender,J.Katz,andR.Morselli.Ringsignatures:Strongerdeﬁnitions,andconstructionswithoutrandomor-acles.InTCC’06,volume3876ofLNCS,pages60–79.Springer,2006.[12]D.Chaum.Untraceableelectronicmail,returnaddresses,anddigitalpseudonyms.CommunicationsoftheACM,24(2):84–88,Feb.1981.[13]D.Chaum.ElectionswithunconditionallysecretballotsanddisruptionequivalenttobreakingRSA.InEUROCRYPT88,pages177–182.Springer-Verlag,1988.LNCS330.[14]B.Chevallier-Mames,P.Fouque,D.Pointcheval,J.Stern,andJ.Traore.OnSomeIncompatiblePropertiesofVotingSchemes.InIAVoSSWorkshopOnTrustworthyElections,WOTE’06,2006.[15]S.S.M.Chow,J.K.Liu,V.K.Wei,andT.H.Yuen.Ringsignatureswithoutrandomoracles.InASIACCS’06,pages297–302.ACMPress,2006.[16]S.S.M.Chow,R.W.C.Lui,L.C.K.Hui,andS.M.Yiu.Identitybasedringsignature:Why,howandwhatnext.InEuroPKI2005,pages144–161,2005.[17]S.S.M.Chow,W.Susilo,andT.Yuen.Escrowedlinkabilityofringsignaturesanditsapplications.InVietCrypt2006,pages175–192.Springer-Verlag,2006.LNCS4341.[18]J.CohenandM.Fischer.Arobustandveriﬁablecrypto-graphicallysecureelectionscheme.In26thAnnualSympo-siumonFoundationsofComputerScience,pages372–382.IEEEComputerSciencePress,85.[19]R.Cramer,I.Damg˚ard,andB.Schoenmakers.Proofsofpartialknowledgeandsimpliﬁeddesignofwitnesshidingprotocols.InCRYPTO94,pages174–187.Springer-Verlag,1994.LNCS839.[20]R.Cramer,M.Franklin,B.Schoenmakers,andM.Yung.Multi-authoritysecretballotelectionswithlinearwork.InEUROCRYPT96,pages72–83.Springer-Verlag,1996.LNCS1070.[21]R.Cramer,R.Gennaro,andB.Schoenmakers.Asecureandoptimallyefﬁcientmulti-authorityelectionschemes.InEUROCRYPT97,pages103–118.Springer-Verlag,1997.LNCS1233.[22]I.D˚amgardandM.Jurik.Ageneralisation,asimpliﬁcationandsomeapplicationsofPaillier’sprobabilisticpublic-keysystem.InPublicKeyCryptography2001,pages119–136.Springer-Verlag,2001.LNCS1992.[23]Y.Dodis,A.Kiayias,A.Nicolosi,andV.Shoup.Anony-mousidentiﬁcationinad-hocgroups.InEUROCRYPT2004.Springer-Verlag,2004.LNCS3027.[24]T.ElGamal.Apublickeycryptosystemandasignatureschemebasedondiscretelogarithms.IEEETransactionsonInformationTheory,IT-31(4):496–472,July1985.[25]A.FiatandA.Shamir.Howtoproveyourself:Practicalso-lutiontoidentiﬁcationandsignatureproblems.InCRYPTO86,pages186–194.Springer-Verlag,1987.LNCS263.[26]A.Fujioka,T.Okamoto,andK.Ohta.Apracticalsecretvotingschemeforlargescaleelection.InAUSCRYPT92,pages244–251.Springer-Verlag,1992.LNCS718.[27]J.FurukawaandK.Sako.Anefﬁcientschemeforprovingashufﬂe.InCRYPTO2001,pages368–387.Springer-Verlag,2001.LNCS2139.[28]P.Golle,S.Zhong,D.Boneh,andM.Jakobsson.Optimisticmixingforexit-polls.InASIACRYPT2002,pages451–465.Springer-Verlag,2002.LNCS2501.[29]M.GreenandS.Hohenberger.BlindIdentity-BasedEncryp-tionandSimulatableObliviousTransfer.InASIACRYPT2007,pages265–282,2007.[30]J.Groth.Averiﬁablesecretshufﬂeofhomomorphicencryp-tions.InPKC2003,pages145–160.Springer-Verlag,2003.LNCS2567.[31]J.Groth.Efﬁcientmaximalprivacyinboardroomvotingandanonymousbroadcast.InFinancialCryptography2004,pages90–104.Springer-Verlag,2004.LNCS3110.[32]M.Hirt.Multi-partycomputation:Efﬁcientprotocols,gen-eraladversaries,andvoting.PhDthesis,ETHZurich,2001.[33]M.HirtandK.Sako.Efﬁcientreceipt-freevotingbasedonhomomorphicencryption.InEUROCRYPT2000,pages539–556.Springer-Verlag,2000.LNCS1807.[34]M.Jakobsson.Flashmixing.InPODC98,pages83–89.ACM,1998.[35]M.Jakobsson.Apracticalmix.InEUROCRYPT98,pages449–461.Springer-Verlag,1998.LNCS1403.[36]M.Jakobsson,K.Sako,andR.Impagliazzo.Designated-veriﬁerproofsandtheirapplications.InEUROCRYPT96,pages143–154.Springer-Verlag,1996.LNCS1070.[37]A.Juels,D.Catalano,andM.Jakobsson.Coercion-resistantelectronicelections.InWPES2005,pages61–70.ACMPress,2005.[38]A.KiayiasandM.Yung.Self-tallyingelectionsandperfectballotsecrecy.InPKC02,pages141–158.Springer-Verlag,2002.LNCS2274.[39]A.KiayiasandM.Yung.Thevector-ballote-votingap-proach.InFinancialCryptography04,pages72–89.Springer-Verlag,2004.LNCS3110.[40]B.Lee,C.Boyd,E.Dawson,andK.Kim.Providingreceipt-freenessinmixnet-basedvotingprotocols.InProc.ICISC2003,pages245–258.Springer-Verlag,2004.LNCS2971.[41]B.LeeandK.Kim.Receipt-freeelectronicvotingschemewithatamper-resistantrandomizer.InProc.ICISC2002,pages389–406.Springer-Verlag,2003.LNCS2587.[42]P.LeeandC.Kim.Receipt-freeelectronicvotingthroughcollaborationofvoterandhonestveriﬁer.InJWISC2000,pages101–108,2000.[43]H.Lipmaa,G.Wang,andF.Bao.Designatedveriﬁersigna-tureschemes:Attack,newsecuritynotionsandanewcon-struction.InICALP2005,pages459–471.Springer-Verlag,2005.LNCS3580.[44]J.Liu,V.Wei,andD.Wong.Linkablespontaneousanony-mousgroupsignatureforadhocgroups.InACISP2004,pages325–335.Springer-Verlag,2004.LectureNotesinComputerScienceNo.3108.[45]J.LiuandD.Wong.Arestrictedmulti-showcredentialsys-temanditsapplicationone-voting.InISPEC2005,pages268–279.Springer-Verlag,2005.LNCS3439.[46]S.Micali,K.Ohta,andL.Reyzin.Accountable-subgroupmultisignatures:extendedabstract.InCCS2001,pages245–254,NewYork,NY,USA,2001.ACMPress.[47]A.Neff.Averiﬁablesecretshufﬂeanditsapplicationtoe-voting.InCCS2001,pages116–125.ACM,2001.[48]L.Nguyen.Accumulatorsfrombilinearpairingsandappli-cations.InCT-RSA2005,volume3376ofLectureNotesinComputerScience,pages275–292,2005.[49]M.Ohkubo,F.Miura,M.Abe,A.Fujioka,andT.Okamoto.Animprovementonapracticalsecretvotingscheme.InInformationSecurity99,pages225–234.Springer-Verlag,1999.LNCS1729.[50]T.Okamoto.Receipt-freeelectronicvotingschemesforlargescaleelections.InWorkshoponSecurityProtocols97,pages25–35.Springer-Verlag,1997.LNCS1361.[51]C.Park,K.Itoh,andK.Kurosawa.Efﬁcientanonymouschannelandall/nothingelectionscheme.InEUROCRYPT93,pages248–259.Springer-Verlag,1994.LNCS765.[52]T.Pedersen.Athresholdcryptosystemwithoutatrustedparty.InEUROCRYPT91,pages522–526.Springer-Verlag,1991.LNCS547.[53]K.Peng,R.Aditya,C.Boyd,E.Dawson,andB.Lee.Multi-plicativehomomorphice-voting.InIndoCrypt2004,pages61–72.Springer-Verlag,2004.LNCS3348.[54]K.Peng,C.Boyd,andE.Dawson.SimpleandEfﬁcientShufﬂingwithProvableCorrectnessandZKPrivacy.InCRYPTO2005,pages188–204,2005.[55]R.Rivest,A.Shamir,andY.Tauman.Howtoleakase-cret.InASIACRYPT2001,pages552–565.Springer-Verlag,2001.LNCS2248.[56]K.SakoandJ.Kilian.Securevotingusingpartialcom-patiblehomomorphisms.InCRYPTO94,pages411–424.Springer-Verlag,1994.LNCS839.[57]K.SakoandJ.Kilian.Receipt-freemix-typevotingscheme-apracticalsolutiontotheimplementationofavotingbooth.InEUROCRYPT95,pages393–403.Springer-Verlag,1995.LNCS921.[58]A.Shamir.Howtoshareasecret.InCommunicationsoftheACM,volume22(2),pages612–613.ACMPress,1979.[59]V.Shoup.AComputationalIntroductiontoNumberTheoryandAlgebra.CambridgeUniversityPress,2005.[60]P.Tsang,V.Wei,T.Chan,M.Au,J.Liu,andD.Wong.Separablelinkablethresholdringsignatures.InIndoCrypt2004,pages384–398.Springer-Verlag,2004.LNCS3384.A.Proof-of-KnowledgeProtocolsA.1.(Witness-Indistinguishable)ProofLetGbeacyclicgroupofprimeorderp,g1andg2betwogeneratorsofG.Belowgivesaprotocolforprovingtheequalityofthediscretelogarithmoftwopairsofnumber,whichreferstotherelationRsuchthat(x,(g1,g2,u1,u2))∈R⇐⇒x=logg1u1=logg2u2.1.Pchoosesr∈Zpatrandomandsendsa=(t1=gr11,t2=gr22)toV.2.Vselectsc∈ZpandreturnsittoPasarandomchal-lenge.3.PresponsestoVwithz=r+cxwithprivateinputx=logg1u1=logg2u2.4.Vacceptstheproofiffgz1=t1uc1andgz2=t2uc2.NowPwantstoprovethatheknowsthewitnessoftwopurportedrelations,butdoesnotwanttorevealwhich.Sup-poseΣ1istheprotocolforprovingtheﬁrstrelationandΣ2isthesecondone,andlet(ai,ci,zi)bethetranscriptofΣifori∈{1,2}.Withoutlossofgenerality,assumePknowsthewitnessforΣ1.Theprotocolproceedsasfollows.1.PusesthesimulatorSforΣ2togenerateatranscript(a2,c2,s2).2.Psends(a1=gr11,a2)toV.3.Vselectsc∈ZpandreturnsittoPasarandomchal-lenge.4.Pcomputesc1=c⊕c2.5.Pgenerates(c1,z1)withprivateinputx,andsends(c1,c2,z1,z2)toV.6.Vacceptstheproofiffboth(a1,c⊕c2,z1)and(a2,c2,z2)arevalidtranscripts.Byusing1-out-of-nsecretsharing(e.g.[58])insteadofXORoperator,theaboveprotocolcanbegeneralizedtoan1-out-of-nwitnessindistinguishableproof[19].A.2.(Non-Interactive)Designated-VeriﬁerProofWeusethemodiﬁcationfromLipmaaetal.[43],whichﬁxedtheoriginalschemebyJakobssonetal.[36].SupposetheproverwantstoprovetheaboverelationRtoonlytheveriﬁerbutnooneelse,whohasaprivatekeyxB∈ZpandpublickeyyB=gxB1.LetH:{0,1}→Zpbeahashfunction.Anon-interactivedesignedveriﬁerproofisasfollow:Proving:Randomlyselectsw,r,t∈Zp,calculatesc=gw1yrB,G=gt1,M=gt2h=H(c,G,M,u1,u2,yB)d=t+xA(h+w)modpandsends(w,r,G,M,d)totheveriﬁer.Veriﬁcation:Adesignedveriﬁercanverifyaproofbycal-culatingc=gw1yrB,h=H(c,G,M,u1,u2,yB)andveri-fyingthatGuh+w1=gd1andMuh+w2=gd2.Transcriptsimulation:Adesignatedveriﬁersimulatesbyrandomlypickingd,α,β∈Zpandcomputingc=gα1,G=gd1u−β1,M=gd2uβ2h=H(c,G,M,u1,u2,yB)w=β−hmodp,r=(α−w)x−1BmodpB.HomomorphicEncryptionB.1.ElGamalEncryption[24]LetGbeamultiplicativegroupofprimeorderqwithgeneratorg.TheprivatekeyxTischosenatrandomfromZqandthecorrespondingpublickeyisyT=gxT.Givenamessagem∈G,theencryptionofmisgivenby(a,b)=(gr,m·yTr)forarandomlychosenr∈Zq.Todecrypttheciphertext(a,b),computetheplaintextm=b·a−xTusingprivatekeyxT.HomomorphicProperties:Forciphertexts(a1,b1)=(gr1,yTr1m1)and(a2,b2)=(gr2,yTr2m2),anyonecaneasilyobtainanencryptionofm1·m2by(a1·a2=gr1+r2,b1·b2=yTr1+r2(m1·m2)).ThresholdVersion:Supposethekeygenerationproto-colofPedersen[52]isusedtosharexTamongthoseNTservers.Aftertheprotocoliscarriedoutsuccessfully,eachtallyingauthorityTi(1≤i≤NT)willgetasharexi∈ZqofthesecretxT,andhasacommitmentofitssharecom-putedashi=gxiwhichisbroadcasttootherservers.The(group)publickeyisyT=gxT.ThesecretxTcanbecom-putedfromanysetΛofsizetasbelow:xT=#j∈Λxjλj,λj=$l∈Λ\{j}ll−j(1)ThisisaShamir(t,NT)-thresholdsecretsharing[58],anysetoflessthantserverscannotrecoverthesecretxT.Todecryptaciphertext(a,b)=(gr,yTrm),theydonotneedtoremovetheprivatekeyxTﬁrst.Instead,thefollowingstepsarecarriedoutbyanytservers:1.EachserverTibroadcastswi=axitoothert−1serversandprovesitscorrectnessthroughaproofofknowledgeofequalityofdiscretelogs:(logghi=logawi)[21].2.Fromequation(1),themessagemcanberecoveredbym=b/!j∈Λwλjj.B.2.Baby/GiantStepAlgorithm[59,page271]LetvandγbetwoelementsofG.Wewanttocom-putethediscretelogarithmofvtothebaseofγinG,i.e.thesmallestpositiveintegerRsuchthatγR=v.ThiscanbedonebyShank’sbabystep/giantstepalgo-rithm.Letu=.√#n/.Compute1,γ,...,γu−1,andsetγ1=γ−u.WriteRintheformR=au+rwith0≤r<u,bythechoiceofuwemustalsohavea≤u.Fora=1,...,u,wecomputev·γa1andcheckwhetheritisinthelistof(1,γ,...,γu−1).Ifitis,wehaveγau+r=vandR=au+r.ThistakesO(√#n)groupoperationsandisbetterthanbrute-forceattacks.C.EscrowedLinkableRingSignatureNowwereviewtheconstructionofanID-basedlinkableringsignatureschemebyChowetal.[17].Theirschemeusesthepairingaccumulatorin[48]toaccumulatethepublickeysintotheringandproducesawitnessprovingthatthesigner’spublickeyisincludedintheaccumulator.Signaturesarelinkedbasedon“eventidentity”,e.g.“BestSingeron09/12/2007”;sothatthesignaturesbythesamesignerforvotinginadifferentdayorothereventsheldinthesamedaycannotbelinked.Setup:Thisalgorithmisexecutedbythetrustedkeygener-ationcenter(KGC).Let(G1,G2)bebilineargroupsofthesameprimeorderp.Selectapairingˆe:G1×G2→GT.Letg1beageneratorofG1,g2beageneratorofG2andψ(g2)=g1.Randomlypicks,u∈Z∗pandcomputegs2,gs22,...,gsq2,whereqisthemaximumnumberofmem-bersinaringsignature.Theauxiliaryinformationscanbesafelydeleted.Randomlypickg3,g4∈G1.SethashfunctionH:G31×G2×GT×G21×G3T×{0,1}∗→ZpandH0:({0,1}∗)2→G2.IdentitiesofusersareinthegroupZp.Thepublicparametersparamare(ˆe,ψ,g1,g2,gs2,...,gsq2,g3,g4,u,H,H0).Forefﬁciencyreason,ρ=ˆe(g1,g2)andρ"=ˆe(g1,gs2)canbeincludedinthepublicparameters.KGCGen:TheKGCrandomlypicksx,x"∈Z∗pasthemasterkey,thecorrespondingpublickeyis(y=gx2,y"=gx"2).Forefﬁciencyreason,ω=ˆe(g1,y)canbepre-computed.UGen:Oninputanidentityid,theKGCcomputestheprivatekeySid=g1/(id+x)1.Theusercanverifytheprivatekeybycheckingifˆe(Sid,gid2y)=ˆe(g1,g2).LAGen:Oninputoftheidentityofthelinkingau-thority(LA)#a,theKGCcomputestheprivatekeyS!a=H1(#a)x"∈G1.ELRingSign:Theuserwithidentityid1withprivatekeySid1whowantstosignaringsignatureformes-sageMwithusersid2,...,idNﬁrstlycomputesW=gu(id2+s)···(idN+s)1,V=gu(id1+s)(id2+s)···(idN+s)1(WandVcanbecomputedefﬁcientlylikethewaydescribedinthepairingaccumulator[48]).Leth=H0(param,eID)whereeIDistheeventidentity.s/hethencomputesthesignatureasaproofofknowledgeof:{(ID1,SID1,W,d):(ˆe(V,g2)=ˆe(W,gID1+s2)∧ˆe(SID1,gID12y)=ˆe(g1,g2)∧˜y=ˆe(SID1,h)ˆe(H1(#a),y")d∧U=gd2}Wenowexplaintheabovenotation.(ID1,SID1,W,d)arethesecretwitness.Theﬁrstequalityˆe(V,g2)=ˆe(W,gID1+s2)refersthatthesigningkeyofID1isaccu-mulatedinthelistofidentitiesV.Thevalidityofthepri-vatekeyofID1isensuredbyˆe(SID1,gID12y)=ˆe(g1,g2);whilethelasttwoequalitiesensurethatthelinkabilitytagˆe(SID1,h)isencryptedsuchthatthelinkingauthority#acandecryptandperformthelinkabilitychecklaterfortheeventidentiﬁedbyh.Detailedstepsareasfollows:1.Randomlypickt1,t2,t3,d∈Z∗pandcompute:T1=Sid1gt11,T2=Wgt21,T3=gt13gt24gt31,˜y=ˆe(Sid1,h)ˆe(H1(#a),y")d,U=gd22.Randomlypickr1,r2,...,r8∈Z∗pandcompute:R1=gr23gr44gr61,R2=gr33gr54gr71T−r13,R3=ˆe(T1,g2)r1ˆe(g1,g2)−r3ω−r2,R4=ˆe(T2,g2)r1ˆe(g1,g2)−r5ˆe(g1,gs2)−r4,R5=ˆe(H1(#a),y")r8ˆe(g1,h)−r2,R6=gr823.Computec=H(T1,T2,T3,h,˜y,U,R1,...,R6,M)4.Computes1=r1+cid1,s2=r2+ct1,s3=r3+ct1id1,s4=r4+ct2,s5=r5+ct2id1,s6=r6+ct3,s7=r7+ct3id1,s8=r8+cd.5.Outputσ=(T1,T2,T3,e,˜y,c,s1,...,s8,U)asthesignature,withthegrouppublickeyVorthesetofidentity{id1,id2,...,idN}.ELRingVerify:Givenasignatureσ,thegrouppublickeyVandamessageM,parseσas(T1,T2,T3,e,˜y,c,s1,...,s8,U),theveriﬁcationchecks:1.Computeh=H0(param,e)and:R1=gs23gs44gs61T−c3,R2=gs33gs54gs71T−s13,R3=ˆe(T1,g2)s1ρ−s3ω−s2%ˆe(T1,y)/ˆe(g1,g2)&cR4=ˆe(T2,g2)s1ρ−s5ρ"−s4(ˆe(T2,gs2)/ˆe(V,g2))c,R5=ˆe(H1(#a),y")s8ˆe(g1,h)−s2(ˆe(T1,h)/˜y)c,R6=gs82U−c2.Acceptifc=H(T1,T2,T3,h,˜y,U,R1,...,R6,M).Link:Oninputsignaturesσbforb∈{0,1},output⊥iftheydonotpassELRingVerify.Elsecomputeyb=˜y/ˆe(S!a,Ub).Output1ify0=y1andtheycorrespondtothesameeventidentiﬁer,0otherwise.Notethatthecor-rectnessofˆe(S!a,Ub)canbeeasilyproven,thelinkingau-thoritycanthusconvinceanyotherpartiesaboutthelinkagebetweenthesignatures.