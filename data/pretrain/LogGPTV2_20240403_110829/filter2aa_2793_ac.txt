# 目录

1. DynELF 模块 ............................................................................................................... 401
2. DynELF 原理 ............................................................................................................... 402
3. XDCTF 2015：pwn200 ............................................................................................... 403
4. 其他泄露函数 .............................................................................................................. 406
5. SSP Leak ......................................................................................................................... 409
   1. SSP ............................................................................................................................... 409
   2. __stack_chk_fail()........................................................................................................ 411
   3. 32C3 CTF 2015：readme............................................................................................ 412
   4. 34C3 CTF 2017：readme_revenge.............................................................................. 416
6. 利用 environ 泄露栈地址 ................................................................................................ 422
7. 利用 _IO_FILE 结构 ......................................................................................................... 429
   1. FILE 结构体 ................................................................................................................. 429
   2. FSOP ............................................................................................................................ 431
   3. FSOP（libc-2.24 版本）............................................................................................. 433
   4. HITCON CTF 2016：House of Orange....................................................................... 438
   5. HCTF 2017：babyprintf.............................................................................................. 445
8. 利用 vsyscall .................................................................................................................... 449
   1. vsyscall 和 vDSO......................................................................................................... 449
   2. HITB CTF 2017：1000levels...................................................................................... 451
9. 参考资料 ............................................................................................................................. 456

---

## 第 1 章 CTF 简介

### 1.1 赛事介绍

#### 1.1.1 赛事起源

CTF（Capture The Flag，夺旗赛）是一种源自西方传统运动的比赛形式。在网络安全领域，它象征着黑客之间的技术竞技，体现了浓厚的黑客精神和文化。CTF 最早出现在 1996 年的 DEFCON 全球黑客大会上，旨在替代之前通过互相攻击进行技术比拼的方式。如今，CTF 已成为全球范围内流行的网络安全竞赛形式。DEFCON CTF 更是被誉为 CTF 中的“世界杯”。

#### 1.1.2 竞赛模式

- **解题模式（Jeopardy）**：类似于 ACM 编程竞赛或信息学奥赛，参赛队伍通过解决各种网络安全挑战题目来获得分数。题目涵盖 RE 逆向工程、Pwn 漏洞挖掘与利用、Web 渗透、Crypto 密码学、Mobile 移动安全和 Misc 安全杂项等六个类别。
  
- **攻防模式（Attack-Defense）**：参赛队伍在网络环境中相互攻击和防御。通过发现并利用对手服务中的漏洞得分，同时修补自身服务以防止丢分。这种模式通常为线下比赛，强调团队合作和技术实力。

- **混合模式（Mix）**：结合了解题模式和攻防模式的特点，根据比赛进度释放不同难度的题目，参赛队伍通过解题获取初始分数，并通过攻防对抗调整最终得分。

#### 1.1.3 竞赛内容

- **Reverse**：逆向工程类题目要求对软件进行结构、流程及算法分析，考察反汇编、反编译能力。
- **Pwn**：涉及溢出类漏洞的利用，如整数溢出、栈溢出、堆溢出等。
- **Web**：涵盖常见的 Web 漏洞，如 XSS、文件包含、代码执行、上传漏洞、SQL 注入等。
- **Crypto**：考察加/解密技术，包括古典加密技术、现代加密技术和自创加密技术。
- **Mobile**：主要针对 Android 和 iOS 平台，涉及 APK 破解等。
- **Misc**：涉及隐写术、流量分析、电子取证、数据分析等综合知识。

### 1.2 知名赛事及会议

#### 1.2.1 网络安全竞赛

- **DEFCON CTF**：全球最知名、影响力最广的 CTF 赛事，分为线上预选赛和线下决赛。
- **Pwn2Own**：奖金丰厚的著名赛事，专注于浏览器和移动操作系统的漏洞挖掘。
- **CGC（Cyber Grand Challenge）**：由 DARPA 发起，旨在推进自动化网络攻防技术的发展。
- **XCTF 联赛**：面向高校及科研院所学生、企业技术人员、网络安全爱好者，旨在发现和培养网络安全人才。
- **全国大学生信息安全竞赛**：教育部主办，旨在宣传信息安全知识，培养创新能力和信息安全意识。
- **“强网杯”全国网络安全挑战赛**：国家级网络安全赛事，分为线上赛、线下赛和精英赛。

#### 1.2.2 网络安全会议

- **RSA**：信息安全界最有影响力的盛会之一，每年选定一个主题贯穿整个会议。
- **Black Hat**：国际黑帽大会，由 Jeff Moss 创办，现已发展为全球性系列会议。
- **DEFCON**：世界性的安全会议，弘扬黑客文化。
- **中国互联网安全大会（ISC）**：亚太地区规格最高、规模最大的安全会议之一。

#### 1.2.3 网络安全学术会议

- **CCS (ACM Conference on Computer and Communications Security)**
- **NDSS (Network and Distributed System Security Symposium)**
- **Oakland S&P (IEEE Symposium on Security & Privacy)**
- **USENIX (USENIX Security Symposium)**

### 1.3 学习经验

#### 1.3.1 二进制安全入门

- **基础要求**：学习者需要具备扎实的计算机基础知识，如 C/C++/Python 编程、汇编语言、计算机组成原理、操作系统和编译原理等。
- **推荐课程**：
  - **中文课程**：网易云课堂的大学计算机专业课程体系。
  - **英文课程**：
    - Harvard CS50 Introduction to Computer Science
    - CMU 18-447 Introduction to Computer Architecture
    - MIT 6.828 Operating System Engineering
    - Stanford CS143 Compilers
- **工具与实践**：掌握静态反汇编（IDA、Radare2）和动态调试（GDB、x64dbg）工具，能够熟练阅读反汇编代码，理解 x86、ARM 和 MIPS 二进制程序。大量动手实践是达到熟练的关键。
- **推荐资料**：
  - Secure Coding in C and C++, 2nd Edition
  - The Intel 64 and IA-32 Architectures Software Developer’s Manual
  - ARM Cortex-A Series Programmer’s Guide