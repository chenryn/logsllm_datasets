• Twitter: @Kevin2600
• Github: https://github.com/kevin2600
• 狗汪汪系列: 玩转无线电-不安全的蓝牙锁;  玩转嵌入式-I2C 协议分析;  玩转嵌入式-WINKHUB 边信道;
玩转无线电-GPS Hacking;  玩转无线电-温哥华天车 RFID 票务系统 ... 
议程:
• 无人机攻防那点事
• 无人机攻防案例篇
• 无人机攻防实战篇
• 无人机攻防科幻篇
无人机攻防那点事
无人机世界百家齐放
• 无人机厂商众多 (DJI; Parrot; Xiaomi; DIYer...)
• 无人机运用场景广泛 (航拍; 运输; 求婚; 应急反应...)
• 无人机遥控种类繁多 (RF; WIFI; XBEE; 开源 & 私有协议...)
无人机侵犯隐私 ?
无人机走私犯罪 ?
无人机攻防现状 ?
• DARPA 举行无人机攻防比赛 (禁止使用GPS-欺骗）
• 花样百出的防御方式: 视频; 音频; WIFI; 红外; 无线电 ...
• 千奇百怪的攻击方式: 老鹰; WI-FI 攻击; 超声波干扰; 电磁波干扰 ...
无人机攻防现状 !
• GPS 欺骗攻击效果各异 (DJI 精灵3S 禁飞区 & 启始返航）
• 防御设备价格高昂, 不适合普通民众 (每只老鹰 1年开销 6922 $)
• 电磁波枪覆盖范围有限, 切断遥控信号后反应各异 (降落; 悬停; 返航）
无人机攻防案例篇
无人机安全漏洞？
• 无人机安全漏洞 (捕食者; AR-Drone 2.0; 大疆精灵3S ...)
• 无人机攻击点 (WIFI; GPS 信号; 固件; 遥控器; 手机APP; 飞控协议; 摄像视频 ...)
• 无人机安全漏洞类型 (WIFI 空密码; GOT ROOT; 飞控指令无认证; 航拍视频无加密 ...)
案例: Parrot AR Drone 2.0
• AR Drone 2.0 提供WIFI 热点 (无口令保护)
• 研究无人机安全必备 Linux on ARM (SkyJack 劫持; Maldrone 病毒..）
• 默认提供 Telnet Root 访问权限. 通过 Pairing 模式来保证安全 (MAC 地址)
• kill –KILL “pidof program.elf”
DEMO
案例: DBPOWER U818A-WIFI 
• U818A 提供WIFI 热点 (无口令保护)
• U818A 基于 BusyBox 1.20.2 (潜在其它 BusyBox 隐患?）
• CVE-2017-3209 (未知 FTP server 允许匿名账号任意文件访问, 照片视频等）
• “curl -T shadow ftp://192.168.0.1:21/etc/jffs2/shadow”
案例: Parrot Bebop2
• Bebop2 基于 Android 系统. 提供TELNET, FTP, UART  Root 访问
• 当Bebop2 接收到大量WIFI连接请求,  将无法处理请求包并坠机
• 当Bebop2 接收到超大数据包,  Buffer将无法处理超额数据包并坠机
案例: Mavlink 开源协议
• 适用于接受遥控; GPS; 飞行时速等信息 (AR.Drone; ArduPilot ..)
• 各地面站(GCS) 可同时操控 255 架无人机 (Intel 的 500 架无人机 Show, 劫持攻击? ）
• Fuzzing 环境配置: SCAPY or KITTY + Test cases (ERROR : Floating point exception）
• Fuzzing 环境配置: 架设虚拟无人机及虚拟地面站环境 (SITL Simulator; MAVProxy; Wireshark)
案例: DJI 大疆无人机系列
• 大疆精灵3 无人机易被 GPS 欺骗 (flyforbid.json)
• 大疆精灵3 遥控器 & 无人机 WIFI Probing (MAC: 60:60:1F)
• 大疆精灵3 Sniffer: github.com/a232319779/PHANTOM-3-STANDARD
• 大疆精灵3 RF 劫持 Geekpwn 2015 (315晚会报道的无人机是怎么被劫持的?)
案例: DJI 大疆无人机系列
DEMO
无人机攻防实战篇
目标: CX-10WD
• 适宜无人机逆向入门 CX-10 系列 (WIFI; RF; 视频图传）
• 遥控操作分为 4 个频道, 工作在频率 2.4Ghz 范围
• 遥控最远距离为 WIFI 可达 40 米, RF 可达 15 米 (室内飞行）
CX-10WD 情报收集
• 无人机工作频率 (900mhz ? 2.4ghz ? 5.8ghz ?)
• 无人机采用何种无线模块 (芯片? GFSK ? 数率 ?)
• 无人机工作模式 (有无跳频 ? 有无加密 ? 数据包结构 ?)
CX-10WD 工作频率
• FCCID 数据查询
• 芯片类型文档阅读
• SDR 软件无线电侦测
CX-10WD 工作频率
绑定信号
遥控信号
CX-10WD – 干扰攻击
• 最暴力的攻击方式: WIFI Deauth 攻击 (AirCrack-ng 依旧王道）
• 最暴力的攻击方式: 高功率信号放大器 + 2.4ghz 高斯噪音 (SDR 无线 Hacking 必备）
CX-10WD – 协议逆向
CX-10WD – 协议逆向
CX-10WD – 协议逆向
CX-10WD 攻击模式
正常模式
攻击模式
CX-10WD 攻击设备
NRF 24L01 无线模块
Arduino UNO 支持 SPI 传输
更快的发包率 + 以知的跳频算法
DEMO
CX-10WD – 刷新固件
• 比 Arduino + NRF24 模块更好的劫持方案？
• 无人机世界的瑞士军刀 DeviationTX 固件项目
• 改造加载多款无线硬件模块, 同时支持多款无线协议 (遥控器 DEVO 7E）
CX-10WD – 刷新固件
DEMO
其它玩法
• 玩法众多: MicroBIT; Devo7E; 树莓派; 软件无线电 ...
• 还有更高大上的么?
无人机攻防科幻篇
无人机 VS 无人机
• 无人机攻防, 最佳的防守是否就是攻击 ?
• 东京警方采用无人机&渔网的方式对违规无人机进行围捕
• Skyjack 项目 (AR.Drone + 树莓派)  &&  Hack5 项目 (DJI3S + WIFI大菠萝)
无人机 VS 人工智能
• 微软研究通过机器学习与无人机自动驾驶结合 (无人机安保系统)
• 澳洲采用无人机与图像识别技术监控鲨鱼攻击事件 (海岸救生员）
• 卡耐基大学AI 实验室通过机器学习研究无人机自动规避技术 (空中巴士)
无人机 Skynet 雏形 ?
• AR.Drone 物体追踪 (ardronelabviewtoolkit.wordpress.com)
• NVIDIA Jetson TX 系列: 无人机自动分类识别的大脑
• 未来人工智能无人机攻防系统: 自动巡逻 + 敌我识别 + 主动攻击
DEMO
总结:
• Kein System Ist Sicher:  100% 安全的系统并不存在
• 无人机安全研究与其他嵌入式无线产品大同小异
• 无人设备与人工智能相结合是未来趋势 (安全性能如何?)