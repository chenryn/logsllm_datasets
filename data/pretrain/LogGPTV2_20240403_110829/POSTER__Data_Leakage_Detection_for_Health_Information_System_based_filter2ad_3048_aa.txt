title:POSTER: Data Leakage Detection for Health Information System based
on Memory Introspection
author:Sanoop Mallissery and
Min-Chieh Wu and
Chun-An Bau and
Guan-Zhang Huang and
Chen-Yu Yang and
Wei-Chun Lin and
Yu-Sung Wu
POSTER: Data Leakage Detection for Health Information System
based on Memory Introspection
Sanoop Mallissery, Min-Chieh Wu, Chun-An Bau, Guan-Zhang Huang, Chen-Yu Yang,
Wei-Chun Lin, Yu-Sung Wuâˆ—
Department of Computer Science
National Chiao Tung University, Hsinchu, Taiwan
{sanoopmallissery,min.chieh.wu,j851021,johnhuang30834,tl445047925}@gmail.com,PI:EMAIL,PI:EMAIL
ABSTRACT
The abundance of highly sensitive personal information in the
Health Information System (HIS) has made it a prime target of
data breach attacks. However, securing the system with existing
Data Leakage Prevention (DLP) solutions is difficult due to a lack of
security perimeter and diverse composition of software components.
We propose the use of hypervisor-based memory introspection for
implementing data leakage detection in such an environment. The
approach looks for the presence of sensitive raw data in the memory
of both the client machines and the server machines, transcending
the dependence of pre-existing security perimeters. It is inherently
compatible with different types of application software and robust
against transport or at-rest data encryption. A prototype has been
built on the Bareflank hypervisor [3] and the OpenEMR [5] platform.
The evaluation results confirmed the effectiveness of the approach.
CCS CONCEPTS
â€¢ Applied computing â†’ System forensics; Data recovery; â€¢
Security and privacy â†’ Pseudonymity, anonymity and un-
traceability; Digital rights management; Virtualization and
security; Trusted computing; Information flow control; â€¢ Comput-
ing methodologies â†’ Neural networks.
KEYWORDS
Data Privacy; Memory Inspection; Electronic Health Record; Health
Information System; Virtualization; Convolutional Neural Networks
ACM Reference Format:
Sanoop Mallissery, Min-Chieh Wu, Chun-An Bau, Guan-Zhang Huang,
Chen-Yu Yang, and Wei-Chun Lin, Yu-Sung Wu. 2020. POSTER: Data Leak-
age Detection for Health Information System based on Memory Introspec-
tion. In Proceedings of the 15th ACM Asia Conference on Computer and
Communications Security (ASIA CCS â€™20), October 5â€“9, 2020, Taipei, Taiwan.
ACM, New York, NY, USA, 3 pages. https://doi.org/10.1145/3320269.3405437
1 INTRODUCTION
The healthcare industry involves a massive amount of data. Doc-
tors rely on the data from laboratory tests, medical imaging, and
âˆ—corresponding author.
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the owner/author(s).
ASIA CCS â€™20, October 5â€“9, 2020, Taipei, Taiwan
Â© 2020 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-6750-9/20/10.
https://doi.org/10.1145/3320269.3405437
various kinds of measurement devices for diagnosis. The hospitals
keep medical records to track the medical histories of patients and
exchange prescription data with the pharmacies. The insurance
companies also need access to medical records as part of the claim
procedure. Most of the data are private in nature, making it lucra-
tive for both external attacks [14][1][12] and insider attacks [6].
On the other hand, deploying data loss prevention systems in such
a kind of environment can be quite challenging due to a lack of
well-defined security perimeters and diverse composition of cus-
tom software. In light of the rising need for more effective data
loss prevention, we propose a novel data leakage detection system
based on memory introspection and pattern recognition. Distinct
from existing Data Leakage Prevention (DLP) systems that act on
system-level access events and network traffic monitoring logs, the
proposed system is robust against transport layer encryption such
as Transport Layer Security (TLS) and at-rest data encryption such
as disk encryption. By examining the raw contents in the memory
directly, the system is largely message format-agnostic, thereby
is compatible with different types of custom software. In the fol-
lowing subsections, we introduce the design of the system and the
implementation of the prototype. We also present the preliminary
evaluation results of the prototype system.
2 DATA LEAKAGE DETECTION FOR HEALTH
INFORMATION SYSTEM
The architecture of the proposed data leakage prevention system is
given in Figure 1(a). The system can be deployed on HIS client ma-
chines and HIS servers as well. The data leakage detection daemon
instructs the lightweight hypervisor to map the physical memory
of the machine to the detection daemon. The daemon extracts struc-
tures in the memory and then applies pattern recognition on the
memory region of target applications (e.g., OpenEMR on the server
and web browsers on the clients) to look for sensitive information.
Figure 1: System Architecture and EPT Mapping
Poster Session ASIA CCS '20, October 5â€“9, 2020, Taipei, Taiwan8982.1 Hypervisor-based Memory Introspection
We use the Bareflank lightweight hypervisor to map the physical
memory space to the data leakage detection daemon for memory
introspection. The use of hypervisor ensures the integrity of the
detection mechanism would not be compromised by user-level or
kernel-level malware. Also, the use of memory introspection can
reveal sensitive information that is encrypted at-rest or during
transport. We map the target memory content to the address space
of the data leakage detection daemon by modifying the Extended
Page Tables (EPT) entries, as shown in Figure 1(b).
2.2 Structured Data Extraction
After mapping the physical memory space to the address space of
the data leakage detection daemon, the daemon reconstructs the
process memory structure from the memory frames using volatil-
ity1linux_pslist. It then looks for the process of interests (e.g., Open-
EMR or web browsers) and acquires access to the virtual address
space of the process via linux_proc_maps and mm_struct. The data
leakage detection daemon then looks for images and texts in the
applicationâ€™s memory space using heuristics. Algorithm 1 shows
the heuristics for finding .jpg images.
Algorithm 1 Heuristics for Finding .jpg Images
function heuristics(image)
ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦ â†ğ‘ğ‘Ÿğ‘œğ‘ğ‘’ğ‘ ğ‘  ğ‘šğ‘’ğ‘šğ‘œğ‘Ÿğ‘¦
for 0 â†’ ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[]_ğ‘ ğ‘–ğ‘§ğ‘’ do
âŠ² check the header format
if ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ == ğ‘—ğ‘ğ‘”_ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ_ğ‘“ ğ‘œğ‘Ÿğ‘šğ‘ğ‘¡ then
ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ[4] â†ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘–] ğ‘¡ğ‘œ ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘– + 3]
ğ‘™ğ‘’ğ‘› â† ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘– + 4] âˆ— 256 + ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘– + 5]
ğ‘›ğ‘’ğ‘¥ğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ[4] â† ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘–+ğ‘™ğ‘’ğ‘›+4] ğ‘¡ğ‘œ ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘–+ğ‘™ğ‘’ğ‘›+5]
if ğ‘›ğ‘’ğ‘¥ğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ == ğ‘—ğ‘ğ‘”_ğ‘›ğ‘’ğ‘¥ğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ then
ğ‘™ğ‘’ğ‘›2 â† ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘– + ğ‘™ğ‘’ğ‘› + 6] âˆ— 256 + ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘– + ğ‘™ğ‘’ğ‘› + 7]
ğ‘›ğ‘’ğ‘¥ğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ2[1]Â¸ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘– + ğ‘™ğ‘’ğ‘› + ğ‘™ğ‘’ğ‘›2 + 6]
if ğ‘›ğ‘’ğ‘¥ğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ2 == ğ‘—ğ‘ğ‘”_ğ‘›ğ‘’ğ‘¥ğ‘¡_ğ‘šğ‘ğ‘Ÿğ‘˜ğ‘’ğ‘Ÿ2 then
ğ‘ğ‘œğ‘ ğ‘ ğ‘–ğ‘ğ‘™ğ‘’_ğ‘—ğ‘ğ‘”[] â† ğ‘ğ‘Ÿğ‘Ÿğ‘ğ‘¦[ğ‘–]
else continue end if
else continue end if
else continue end if
for ğ‘– = (0 â†’ ğ‘ğ‘œğ‘ ğ‘ ğ‘–ğ‘ğ‘™ğ‘’_ğ‘—ğ‘ğ‘”[]_ğ‘ ğ‘–ğ‘§ğ‘’) do
ğµğ‘¢ğ‘–ğ‘™ğ‘‘ ğ‘ğ‘œğ‘ ğ‘ ğ‘–ğ‘ğ‘™ğ‘’ ğ‘—ğ‘ğ‘”
âŠ² reach end marker 0xFFD9
ğ‘‚ğ‘¢ğ‘¡ğ‘ğ‘¢ğ‘¡ ğ‘¡â„ğ‘’ ğ‘ğ‘œğ‘ ğ‘ ğ‘–ğ‘ğ‘™ğ‘’ .ğ‘—ğ‘ğ‘” ğ‘“ ğ‘–ğ‘™ğ‘’ğ‘ 
3 SENSITIVE DATA IDENTIFICATION
The images which are obtained from Structured Data Extraction
are fed to the proposed model as shown in Figure 2 and the model
uses Mask Regional-Convolutional Neural Network (Mask R-CNN)
to perform sensitive data detection on medical images [8]. Mask
R-CNN scans the medical image and generates the proposals, which
have a higher probability of an object being present. It uses Region
Proposal Network (RPN) to generate those proposals [13]. Then,
Mask R-CNN identifies the proposals that are being generated and