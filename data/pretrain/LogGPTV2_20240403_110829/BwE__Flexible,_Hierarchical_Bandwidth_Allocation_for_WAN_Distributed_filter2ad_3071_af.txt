ßt of BwE to applications for WAN distributed computing
and believe that it is also applicable to a number of emerg-
ing application classes in the broader Internet. For example,
video streaming services for collaboration or entertainment
increasingly dominate WAN communication. hese appli-
cations have well-understood bandwidth requirements with
step functions in additional utility from incremental band-
width allocation. Consider that a (cid:16)˚«P video stream may
receive no incremental beneßt from an additional ˇ««Kbps
of bandwidth; only suıcient additional bandwidth to enable
;(cid:134)«P streaming is useful. Finally, homes and businesses are
trending toward multiple simultaneous video streams with
known relative priority and incremental bandwidth utility, all
sharing a single bottleneck with known capacity.
Next, consider the move toward an Internet of hings [(cid:134)(cid:149)]
where hundreds of devices in a home or business may have
varying wide-area communication requirements. hese ap-
plications may range from home automation, to security,
health monitoring, to backup. For instance, home security
may have moderate bandwidth requirements but be of the
highest priority. Remote backup may have substantial, sus-
tained bandwidth requirements. However, the backup does
not have a hard deadline and is largely insensitive to packet
loss. Investigating BwE-based mechanisms for fair allocation
based on an understanding of relative application utility in
response to additional bandwidth is an interesting area of fu-
ture work.
9. RELATED WORK
his paper focuses on allocating bandwidth among users
in emerging multi-datacenter WAN environments. Given the
generality of the problem, we necessarily build on a rich body
12of related e(cid:242)orts, including utility functions [˚], weighted fair
sharing [(cid:134), ˇˇ, ˇ(cid:134), ˚] and host-based admission control [(cid:149)].
We extend existing Utility max-min approaches [˚] for multi-
path routing and hierarchical fairness.
Weighted queuing is one common bandwidth allocation
paradigm. While a good starting point, we ßnd weights
are insuıcient for delivering user guarantees. Relative to
weighted queuing, we focus on rate limiting based on de-
mand estimation. BwE control is centralized and protocol
agnostic, i.e., general to TCP and UDP. his is in contrast to
DRL [(cid:134)(cid:1)], which solves the problem via distributed rate con-
trol for TCP while not accounting for network capacity ex-
plicitly.
Netshare [(cid:134)«] and Seawall [t«] also use weighted band-
width allocation mechanisms. Seawall in particular achieves
per-link proportional fairness. We have found max-min fair-
ness to be more practical because it provides better isolation.
Gatekeeper [(cid:134)E] also employs host-based hierarchical to-
ken buckets to share bandwidth among data center ten-
ants, emphasizing work-conserving allocation. Gatekeeper
however assumes a simplißed topology for every tenant.
BwE considers complex topologies, multi-path forwarding,
centralized bandwidth allocation, and a range of (cid:6)exible
bandwidth allocation mechanisms. Secondnet [ˇ(cid:1)] provides
pair-wise bandwidth guarantees but requires accurate user-
provided demands and is not work conserving.
Oktopus [(cid:16)] proposes a datacenter tree topology with spec-
ißed edge capacity. While suitable for datacenters, it is not a
natural ßt for the WAN where user demands vary based on
source-destination pairs. he BwE abstraction is more ßne-
grained, with associated implementation and conßguration
challenges. Oktopus also ties the problem of bandwidth al-
location with VM placement. Our work however does not
a(cid:242)ect computation placement but rather takes the source of
demand as ßxed. We believe there are opportunities to ap-
ply such joint optimization to BwE. Datacenter bandwidth
sharing e(cid:242)orts such as ElasticSwitch [(cid:134)(cid:16)], FairCloud [(cid:134)t] and
EyeQ [ˇ˚] focus on a hose model for tenants. EyeQ uses ECN
to detect congestion at the edge and assumes a congestion free
core. In contrast, our (cid:6)ow-wise bandwidth sharing model al-
lows aggregation across users and is explicitly focused on a
congested core.
Recent e(cid:242)orts such as SWAN [ˇE], and B(cid:16) [ˇ;] are closely
related but focus on the network and routing infrastructure
to e(cid:242)ectively scale and utilize emerging WAN environments.
In particular, they focus on employing So(cid:22)ware Deßned Net-
working constructs for controlling and eıciently scaling the
network. Our work is complementary and focuses on en-
forcing policies given an existing multipath routing con-
ßguration. Jointly optimizing network routing, and band-
width allocation is an area for future investigation. TEM-
PUS [ˇ(cid:149)] focuses on optimizing network utilization by ac-
counting for deadlines for long-lived (cid:6)ows . Our bandwidth
sharing model applies to non-long-lived (cid:6)ows as well and
does not require deadlines to be known ahead of time. Flow
deadlines open up possibility of further optimization (for ex-
ample, by smoothing bandwidth allocation over a longer pe-
riod of time) and that remains an area for future work for us.
Work in RSVP, Di(cid:242)erentiated Services and Traıc Engi-
neering [ˇ(cid:16), (cid:134);, ;, (cid:134)(cid:134), (cid:134)ˇ, ˇ, (cid:1)] overlaps in terms of goals. How-
ever, these approaches are network centric, assuming that
host control is not possible. In some sense, we take the oppo-
site approach, considering an orthogonal hierarchical con-
trol infrastructure that leverages host-based demand mea-
surement and enforcement.
Congestion Manager [t] is an inspiration for our work on
BwE, enabling a range of (cid:6)exible bandwidth allocation poli-
cies to individual (cid:6)ows based on an understanding of ap-
plication requirements. However, Congestion Manager still
manages bandwidth at the granularity of individual hosts,
whereas we focus on the infrastructure and algorithms for
bandwidth allocation in a large-scale distributed computing
WAN environment.
10. CONCLUSIONS
In this paper, we present Bandwidth Enforcer (BwE), our
mechanism for WAN bandwidth allocation. BwE allocates
bandwidth to competing applications based on (cid:6)exible pol-
icy conßgured by bandwidth functions. BwE supports hierar-
chical bandwidth allocation and delegation among services
while simultaneously accounting for multi-path WAN com-
munication.
Based on multiple years of production experience, we
summarize a number of important beneßts to our WAN.
First, BwE provides isolation among competing services, de-
livering plentiful capacity in the common case while main-
taining required capacity under failure and maintenance sce-
narios. Second, we provide a single point for specifying allo-
cation policy to administrators. While pathing, RTT, and ca-
pacity can shi(cid:22) substantially, BwE continues to allocate band-
width according to policy. Finally, BwE enables the WAN to
run at higher levels of utilization than before. By tightly in-
tegrating new loss-insensitive ßle transfer protocols running
at low priority with BwE, we run many of our WAN links at
(cid:149)«(cid:236) utilization.
Acknowledgements
Many teams within Google collaborated towards the success
of the BwE project. We would like to acknowledge the BwE
development, test and operations groups including Aaron
Racine, Alex Docauer, Alex Perry, Anand Kanagala, Andrew
McGregor, Angus Lees, Deepak Nulu, Dmitri Nikulin, Eric
Yan, Jon Zolla, Kai Song, Kirill Mendelev, Mahesh Kalla-
halla, Matthew Class, Michael Frumkin, Michael O’Reilly,
Ming Xu, Mukta Gupta, Nan Hua, Nikhil Panpalia, Phong
Chuong, Rajiv Ranjan, Richard Alimi, Sankalp Singh, Subba-
iah Venkata, Vijay Chandramohan, Xijie Zeng, Yuanbo Zhu,
Aamer Mahmood, Ben Treynor, Bikash Koley and Urs Hölzle
for their signißcant contributions to the project. We would
also like to thank our shepherd, Srikanth Kandula, and the
anonymous SIGCOMM reviewers for their useful feedback.
11. REFERENCES
[ˇ] Wikipedia: Di(cid:242)erentiated services.
http://en.wikipedia.org/wiki/Di(cid:242)erentiated_services.
13[(cid:134)] Avv*v(cid:213)o(cid:20), M., *(cid:152)› S-*xT~~, Y. Centralized and
Distributed Algorithms for Routing and Weighted
Max-Min Fair Bandwidth Allocation. IEEE/ACM
Trans. Networking ˇE, (cid:1) ((cid:134)««˚), ˇ«ˇ(cid:1)–ˇ«(cid:134)(cid:16).
[t] B*v*b!TO-(cid:152)*(cid:152), H., R*-ov, H. S., *(cid:152)› S(cid:220)O-*(cid:152), S. An
integrated congestion management architecture for
internet hosts. In In Proc. ACM SIGCOMM (ˇ(cid:149)(cid:149)(cid:149)),
pp. ˇ;(cid:1)–ˇ˚;.
[(cid:16)] B*vv*(cid:152)T, H., C(cid:213)O~*, P., K*!*$T*(cid:152)(cid:152)TO, T., *(cid:152)›
R(cid:213)|O~!(cid:213)(cid:152), A. Towards predictable datacenter
networks. In SIGCOMM ((cid:134)«ˇˇ).
[(cid:1)] Bv*b(cid:220), S., Bv*(cid:138)b, D., C*!vO(cid:213)(cid:152), M., D*xT(cid:220)O, E., W*(cid:152)$,
Z., *(cid:152)› W(cid:220)TOO, W. An Architecture for Di(cid:242)erentiated
Service. RFC (cid:134)(cid:16);(cid:1) (Informational), December ˇ(cid:149)(cid:149)˚.
Updated by RFC t(cid:134)E«.
[E] B(cid:213)o›(cid:220)(cid:138), J.-Y. Rate adaptation, congestion control and
fairness: A tutorial, (cid:134)«««.
[;] B!*›(cid:220)(cid:152), R., Z-*(cid:152)$, L., B(cid:220)!O(cid:213)(cid:152), S., H(cid:220)!–(cid:213)$, S., *(cid:152)›
J*(cid:129)T(cid:152), S. Resource ReSerVation Protocol (RSVP) –
Version ˇ Functional Specißcation. RFC (cid:134)(cid:134)«(cid:1)
(Proposed Standard), September ˇ(cid:149)(cid:149);. Updated by
RFCs (cid:134);(cid:1)«, t(cid:149)tE, (cid:16)(cid:16)(cid:149)(cid:1).
[˚] C*(cid:213), Z., *(cid:152)› Z(cid:220)$o!*, E. W. Utility max-min: An
application-oriented bandwidth allocation scheme. In
INFOCOM (ˇ(cid:149)(cid:149)(cid:149)).
[(cid:149)] C-(cid:213)T, B.-K., *(cid:152)› B(cid:220)~~*~T, R. Endpoint admission
control: network based approach. In Distributed
Computing Systems, (cid:134)««ˇ. (cid:134)ˇst International Conference
on. (Apr (cid:134)««ˇ), pp. (cid:134)(cid:134);–(cid:134)t(cid:1).
[ˇ«] Cv*!b, D. D., L*(cid:129)C(cid:220)!~, M. L., *(cid:152)› Z-*(cid:152)$, L. Netblt:
A high throughput transport protocol. In Proceedings
of the ACM Workshop on Frontiers in Computer
Communications Technology (New York, NY, USA,
ˇ(cid:149)˚˚), SIGCOMM ’˚;, ACM, pp. t(cid:1)t–t(cid:1)(cid:149).
[ˇˇ] D*(cid:152)(cid:152)*, E., H*OOT›T(cid:129), A., K*(cid:252)v*(cid:152), H., Ko(cid:129)*!, A.,
M*(cid:152)O(cid:213)o!, Y., R*–, D., *(cid:152)› S(cid:220)$*v(cid:213)x, M. Upward Max
Min Fairness. In INFOCOM ((cid:134)«ˇ(cid:134)), pp. ˚t;–˚(cid:16)(cid:1).
[ˇ(cid:134)] D*(cid:152)(cid:152)*, E., M*(cid:152)›*v, S., *(cid:152)› ST(cid:152)$-, A. A Practical
Algorithm for Balancing the Max-min Fairness and
hroughput Objectives in Traıc Engineering. In Proc.
INFOCOM (March (cid:134)«ˇ(cid:134)), pp. ˚(cid:16)E–˚(cid:1)(cid:16).
[ˇt] D(cid:220)*(cid:152), J., *(cid:152)› G-(cid:220)(cid:129)*|*~, S. Mapreduce: Simplißed
data processing on large clusters. Commun. ACM (cid:1)ˇ, ˇ
(January (cid:134)««˚), ˇ«;–ˇˇt.
[ˇ(cid:16)] F(cid:213)!~–, B., R(cid:220)(cid:130)(cid:20)(cid:213)!›, J., *(cid:152)› T-(cid:213)!o(cid:252), M. Traıc
Engineering with Traditional IP Routing Protocols.
IEEE Communications Magazine (cid:16)« ((cid:134)««(cid:134)), ˇˇ˚–ˇ(cid:134)(cid:16).
[ˇ(cid:1)] Go(cid:213), C., Lo, G., W*(cid:152)$, H. J., Y*(cid:152)$, S., K(cid:213)(cid:152)$, C., So(cid:152),
P., Wo, W., *(cid:152)› Z-*(cid:152)$, Y. SecondNet: A data center
network virtualization architecture with bandwidth
guarantees. In CoNEXT ((cid:134)«ˇ«).
[ˇE] H(cid:213)(cid:152)$, C.-Y., K*(cid:152)›ov*, S., M*-*\*(cid:152), R., Z-*(cid:152)$, M.,
GTvv, V., N*(cid:152)›o!T, M., *(cid:152)› W*~~(cid:220)(cid:152)-(cid:213)(cid:20)(cid:220)!, R. Have
Your Network and Use It Fully Too: Achieving High
Utilization in Inter-Datacenter WANs. In Proc.
SIGCOMM (August (cid:134)«ˇt).
[ˇ;] J*T(cid:152), S., Ko(cid:129)*!, A., M*(cid:152)›*v, S., O(cid:152)$, J., P(cid:213)o~T(cid:220)xObT,
L., ST(cid:152)$-, A., V(cid:220)(cid:152)b*~*, S., W*(cid:152)›(cid:220)!(cid:220)!, J., Z-(cid:213)o, J.,
Z-o, M., Z(cid:213)vv*, J., H(cid:176)v–v(cid:220), U., S~o*!~, S., *(cid:152)›
V*-›*~, A. B(cid:16): Experience with a Globally-Deployed
So(cid:22)ware Deßned WAN. In Proceedings of the ACM
SIGCOMM (cid:134)«ˇt ((cid:134)«ˇt), ACM, pp. t–ˇ(cid:16).
[ˇ˚] J(cid:220)(cid:150)*bo(cid:129)*!, V., AvT–*›(cid:220)-, M., M*–T(cid:220)!(cid:220)O, D.,
P!*C-*b*!, B., KT(cid:129), C., *(cid:152)› G!(cid:220)(cid:220)(cid:152)C(cid:220)!$, A. Eyeq:
Practical network performance isolation at the edge. In
Proc. of NSDI ((cid:134)«ˇt), USENIX Association, pp. (cid:134)(cid:149);–tˇ(cid:134).
[ˇ(cid:149)] K*(cid:152)›ov*, S., M(cid:220)(cid:152)*(cid:138)-(cid:220), I., S(cid:138)-|*!~–, R., *(cid:152)›
B*CCov*, S. R. Calendaring for wide area networks. In
Proc. SIGCOMM (August (cid:134)«ˇ(cid:16)).
[(cid:134)«] L*(cid:129), T., R*›-*b!TO-(cid:152)*(cid:152), S., V*-›*~, A., *(cid:152)›
V*!$-(cid:220)O(cid:220), G. NetShare: Virtualizing data center
networks across services. Tech. rep., (cid:134)«ˇ«.
[(cid:134)ˇ] MT(cid:152)(cid:220)T, I., *(cid:152)› Lo(cid:138)(cid:220)b, J. MPLS-Enabled Applications:
Emerging Developments and New Technologies. Wiley
Series on Communications Networking & Distributed
Systems. Wiley, (cid:134)««˚.
[(cid:134)(cid:134)] OOC(cid:213)!(cid:152)(cid:220), E., *(cid:152)› ST(cid:129)-*, A. Traıc Engineering with
Mpls (Paperback). Networking Technology Series.
Cisco Press, (cid:134)««(cid:134).
[(cid:134)t] P(cid:213)(cid:252)*, L., K!TO-(cid:152)*(cid:129)o!~-(cid:150), A., R*~(cid:152)*O*(cid:129)(cid:150), S., *(cid:152)›
S~(cid:213)T(cid:138)*, I. Faircloud: Sharing the network in cloud
computing. In Proceedings of the ˇ«th ACM Workshop
on Hot Topics in Networks (New York, NY, USA, (cid:134)«ˇˇ),
HotNets-X, ACM, pp. (cid:134)(cid:134):ˇ–(cid:134)(cid:134):E.
[(cid:134)(cid:16)] P(cid:213)(cid:252)*, L., Y*v*$*(cid:152)›ov*, P., B*(cid:152)(cid:220)!\(cid:220)(cid:220), S., M(cid:213)$ov,
J. C., To!(cid:152)(cid:220)!, Y., *(cid:152)› S*(cid:152)~(cid:213)O, J. R. Elasticswitch:
Practical work-conserving bandwidth guarantees for
cloud computing. In Proceedings of the ACM
SIGCOMM (cid:134)«ˇt Conference on SIGCOMM (New York,
NY, USA, (cid:134)«ˇt), SIGCOMM ’ˇt, ACM, pp. t(cid:1)ˇ–tE(cid:134).
[(cid:134)(cid:1)] R*$-*x*(cid:152), B., VTO-|*(cid:152)*~-, K., R*(cid:129)*C-*›!*(cid:152), S.,
Y(cid:213)(cid:138)o(cid:129), K., *(cid:152)› S(cid:152)(cid:213)(cid:220)!(cid:220)(cid:152), A. C. Cloud control with
distributed rate limiting. In In SIGCOMM ((cid:134)««;).
[(cid:134)E] R(cid:213)›!T$o(cid:220)O, H., S*(cid:152)~(cid:213)O, J., To!(cid:152)(cid:220)!, Y., S(cid:213)*!(cid:220)O, P.,
*(cid:152)› Go(cid:220)›(cid:220)O, D. Gatekeeper: Supporting bandwidth
guarantees for multi-tenant datacenter networks. In
Workshop on I/O Virtualization ((cid:134)«ˇˇ).
[(cid:134);] R(cid:213)o$-*(cid:152), M., T-(cid:213)!o(cid:252), M., *(cid:152)› Z-*(cid:152)$, Y. Traıc
Engineering with Estimated Traıc Matrices. In Proc.
IMC ((cid:134)««t), pp. (cid:134)(cid:16)˚–(cid:134)(cid:1)˚.
[(cid:134)˚] S*v~–(cid:220)!, J. H., R(cid:220)(cid:220)›, D. P., *(cid:152)› Cv*!b, D. D.
End-to-end arguments in system design. ACM Trans.
Comput. Syst. (cid:134), (cid:16) (November ˇ(cid:149)˚(cid:16)), (cid:134);;–(cid:134)˚˚.
[(cid:134)(cid:149)] S*!(cid:129)*, S., B!(cid:213)(cid:138)b, D. L., *(cid:152)› AO-~(cid:213)(cid:152), K. he
networked physical world–proposals for engineering
the next generation of computing, commerce &
automatic identißcation. White Paper, Auto-ID Center,
MIT. Designed b y Foxner. www. foxner. com ((cid:134)«««).
[t«] S-T(cid:220)-, A., K*(cid:152)›ov*, S., G!(cid:220)(cid:220)(cid:152)C(cid:220)!$, A., KT(cid:129), C., *(cid:152)›
S*-*, B. Sharing the data center network. In NSDI
((cid:134)«ˇˇ).
14