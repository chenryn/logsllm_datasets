which we call DIV, for â€œdouble IVâ€. DIV takes an IV-based
MAC ivM = (ğ’¦, Mac, Vrfy) and an IV-based encryption
scheme ivE = (ğ’¦, Enc, Dec), and produces a scheme AEDIV =
(ğ’¦2, DIV.Enc, DIV.Dec), defined as follows:
âˆ™ DIV.Encğ‘˜ğ‘€ ,ğ‘˜ğ¸ (ğ¼ğ‘‰, ğ‘š) returns ğœ â† Macğ‘˜ğ‘€(ğ¼ğ‘‰, ğ‘š) and
ğ‘ â† Encğ‘˜ğ¸(ğœ, (ğ¼ğ‘‰, ğ‘š)).
âˆ™ DIV.Decğ‘˜ğ‘€ ,ğ‘˜ğ¸(ğœ, ğ‘) computes (ğ¼ğ‘‰, ğ‘š) â† Decğ‘˜ğ¸(ğœ, ğ‘) and
returns ğ‘š if Vrfyğ‘˜ğ‘€
(ğ¼ğ‘‰, ğ‘š, ğœ ) succeeds. The error sym-
bol âŠ¥ is returned otherwise.
The differences with SIV are:
âˆ™ the use of an IV-based MAC, which offers the possibility
to perform re-keying already in the MAC part of the
computation (as in PSV-MAC for instance), and
âˆ™ the encryption of the IV used in the MAC, which
mitigates the leakage matching attacks described for
SIV.
In terms of efficiency, and compared to SIV, DIV requires
to encrypt one more block (the IV), but does not increase
the size of the ciphertext. We show, in the full version of this
paper, that AEDIV is a MR AE as long as (1) ivM is chosen-IV
pseudorandom (2) ivE is IV-sec-secure [10].
When considering the relative costs of F and F*, the differ-
ence of efficiency becomes considerably more important. If
we assume that F has a cost ğ‘ and F* a cost ğ‘, then the DIV
composition applied to PSV-MAC and PSV-ENC comes at
a cost of (3â„“ + 2)ğ‘ + 2ğ‘ for a message of â„“ blocks, and the
SIV mode requires (2â„“ + 1)ğ‘ with each block protected. If
we assume that ğ‘ = 100ğ‘ (which is consistent with the table
given in [37]), then the DIV composition is already cheaper
for a single message block and, for long messages, the DIV
composition will be â‰ˆ 67 times cheaper.
Given that PSV-MAC and PSV-ENC satisfy these security
notions and are LR taken individually, one may hope that
PSV-AE = DIV(PSV-MAC, PSV-ENC) = (ğ’¦2, PSVAEnc, PSVADec)
would offer CIML security. This is unfortunately not the case.
A CIML attacker can proceed as follows. First, select a
random ğ¼ğ‘‰ , and query PSVAEncğ‘˜ğ‘€ ,ğ‘˜ğ¸ (ğ¼ğ‘‰, ğ‘š) with various
messages of â„“ > 1 blocks. Keeping ğ¼ğ‘‰ constant ensures
that the same ğ‘˜0 â† F*
ğ‘˜ğ‘€ (ğ¼ğ‘‰ ) is computed every time, and
to mount a DPA attack that recovers ğ‘˜0 when Fğ‘˜0 (ğ‘š1) is
computed with the first block of each message.
The rest of the attack is similar to the one against SIV. Let
(ğœ, ğ¶) â† PSVAEncğ‘˜ğ‘€ ,ğ‘˜ğ¸ (ğ¼ğ‘‰, ğ‘š) for the same ğ¼ğ‘‰ as above
and a chosen â„“ block message ğ‘š. The adversary can (i) select
â„“ âˆ’ 1 blocks ğ‘š*
â„“âˆ’1 that were not part of a previous
encryption query, (ii) define ğ‘˜*
ğ‘– =
ğ‘– ) for ğ‘– âˆˆ [1, ğ‘™âˆ’1], (iii) compute ğ‘š*
ğ¹ğ‘˜*
(ğœ ). This
guarantees that (ğ¼ğ‘‰, ğ‘š) and (ğ¼ğ‘‰, ğ‘š* = ğ‘š*
â„“ ) have
the same MAC ğœ . Now, the adversary can define ğ¶* = ğ¶ âŠ•
(ğ¼ğ‘‰ â€–ğ‘š) âŠ• (ğ¼ğ‘‰ â€–ğ‘š*) and return (ğœ, ğ¶*) as a fresh ciphertext
that decrypts to ğ‘š*, hence violating the CIML security.
0 = ğ‘˜0, and compute ğ‘˜*
â„“ = ğ¹
1â€– . . .â€–ğ‘š*
1,Â·Â·Â· , ğ‘š*
âˆ’1
ğ‘˜â€²
â„“âˆ’1
(ğ‘š*
ğ‘–âˆ’1
In the full version of this paper, we additionally show that
the alternative LR MAC proposed in [37] could be broken
by similar (though slightly more elaborate) attacks [10].
These negative results for CIML security lead us to the
design of new schemes, which we present and analyze in the
following sections.
5 DIGEST, TAG AND ENCRYPT
In this section, we build a MR AE scheme that provably
achieves CIML security in a very permissive leakage model,
which we call the unbounded leakage model. As previously
mentioned, the confidentiality analysis with leakage is de-
ferred to Section 7 (and will have to rely on a less permissive
leakage assumption).
Conferenceâ€™17, July 2017, Washington, DC, USA
5.1 Specification of DTE
The attacks against the CIML property in the previous sec-
tion essentially result from the fact that revealing a (long-term
or ephemeral) key is sufficient to break the collision resis-
tance of the tags. Hence, a natural way to address them is to
combine PSV-ENC with a modified IV-based MAC that first
hashes the IV with the plaintext and then runs a leak-free
PRF on the hash value to compute the tag ğœ (see Figure 2,
where long-term secrets are in red, ephemeral ones in orange
and public values in green).
Figure 2: DTE leakage-resilient AE: Authentication
part.
Then, PSV-ENC encrypts both the IV and the plaintext using
the tag as its own IV (see Figure 3). As a result our scheme
produces a digest from its input, generates the tag from it,
and encrypts, hence the name DTE.
Note that our presentation explicitly uses a hash function
here, because we need collision resistance and preimage re-
sistance. However, from an implementation point of view, it
is not necessary to use a different functionality, and a hash
function based on the block cipher F could be used.
Figure 3: DTE leakage-resilient AE: Encryption part
(PSV-ENC).
The full description of DTE is given in Figure 4. As before,
the values ğ‘ğ´ and ğ‘ğµ are two public distinct constants in
â„¬ = {0, 1}ğ‘›. The key ğ‘˜ is drawn at random over ğ’¦ as usual.
In order to stress that the IV used in the MAC part of the
scheme is not public, we refer to it with the letter ğ‘Ÿ.
We point that DTE is the result of the DIV composition
(see Section 4.2) applied to the IV-based MAC of Figure 2
and PSV-ENC, with the important difference that the same
Francesco Berti, FranÂ¸cois Koeune, Olivier Pereira,
Thomas Peters, FranÂ¸cois-Xavier Standaert.
DTE
Encğ‘˜(ğ‘Ÿ, ğ‘š), where ğ‘š = (ğ‘š1, ğ‘š2, . . . , ğ‘šâ„“):
ğ‘˜(â„)
ğ‘˜(ğœ )
âˆ™ â„ â† H(ğ‘Ÿ||ğ‘š)
âˆ™ ğœ â† F*
âˆ™ ğ‘˜0 â† F*
âˆ™ ğ‘0 â† Fğ‘˜0 (ğ‘ğµ) âŠ• ğ‘Ÿ
âˆ™ ğ‘˜ğ‘– â† Fğ‘˜ğ‘–âˆ’1 (ğ‘ğ´), ğ‘ğ‘– â† Fğ‘˜ğ‘– (ğ‘ğµ) âŠ• ğ‘šğ‘– âˆ€ğ‘– âˆˆ [1, â„“]
âˆ™ return ğ¶ â† (ğœ, ğ‘0, ğ‘1, ğ‘2, . . . , ğ‘â„“)
// digest
// tag
// ...and encrypt
// ğ‘¦ğ‘– := Fğ‘˜ğ‘– (ğ‘ğµ)
Decğ‘˜(ğ¶), where ğ¶ = (ğœ, ğ‘0, ğ‘1, ğ‘2, . . . , ğ‘â„“):
ğ‘˜(ğœ )
âˆ™ ğ‘˜0 â† F*
âˆ™ ğ‘Ÿ â† Fğ‘˜0 (ğ‘ğµ) âŠ• ğ‘0
âˆ™ ğ‘˜ğ‘– â† Fğ‘˜ğ‘–âˆ’1 (ğ‘ğ´), ğ‘šğ‘– â† Fğ‘˜ğ‘– (ğ‘ğµ) âŠ• ğ‘ğ‘– âˆ€ğ‘– âˆˆ [1, â„“]
âˆ™ â„ â† H(ğ‘Ÿ||ğ‘š)
âˆ™ if ğœ = F*
ğ‘˜(â„) return (ğ‘š1, ..., ğ‘šâ„“), else return âŠ¥.
Figure 4: DTE - Full description.
key ğ‘˜ is used in the authentication part as well as in the
encryption part (which either reduces the length of the key,
or avoids a key expansion step).
5.2 Efficiency of DTE
Ignoring the cost of the protection against leakages, the com-
putational costs of DTE are increased by 50% compared to
the original MR AE SIV scheme of Rogaway and Schrimpton:
both perform two passes on the message, but DTEâ€™s itera-
tions are slightly more expensive due to the leakage-resilient
encryption, which requires two block cipher executions per
message block instead of one. However, as soon as leakage
is included in the game, protecting the SIV MR AE scheme
would require to have all block cipher executions equally well
protected (i.e., as F*), since they all compute with the same
long-term key. Denoting the overhead factor of F* compared
to F by ğ›¼ and the number of blocks to be encrypted by â„“,
this roughly implies an approximate cost of 2ğ›¼ + 3â„“ for DTE
and 2ğ›¼â„“ for SIV. This means that the encryption cost of
DTE is favorable against the one of SIV as soon as we need
to encrypt â„“ â‰¥ 2 message blocks and ğ›¼ â‰¥ 3, and that the
gain will tend to 2ğ›¼/3 when â„“ increases. So, given that ğ›¼
typically ranges from hundreds to thousands (as discussed in
the introduction), the performance of an implementation of
DTE is expected to gradually outperform SIV by two or three
orders of magnitude when the size of the messages increases,
if security against side-channel attacks has to be guaranteed.
Similar improvement factors can be obtained when compar-
ing with recent improvements/refinements on the original
SIV scheme, and similar gains will also be obtained for the
DCE scheme that will be discussed in the next section.
5.3 Misuse resistance without leakage
As a first security analysis we show that DTE is a MR AE,
in the sense of Definition 2.9.
Theorem 5.1. Let H : {0, 1}ğ‘› Ã— {0, 1}â‹† â†’ {0, 1}ğ‘› be
a (0, ğ‘¡1, ğœ€ğ‘ğ‘Ÿ)-collision resistant and (0, ğ‘¡1, ğœ€ğ‘ğ‘Ÿ)-range-oriented
preimage resistant hash function. Let Fâ‹† : {0, 1}ğ‘›Ã—{0, 1}ğ‘› â†’
Ciphertext Integrity with Misuse and Leakage
Conferenceâ€™17, July 2017, Washington, DC, USA
{0, 1}ğ‘› be a (2ğ‘, ğ‘¡1, ğœ€Fâ‹† )-pseudorandom function and F : {0, 1}ğ‘›Ã—
{0, 1}ğ‘› â†’ {0, 1}ğ‘› be a (2, ğ‘¡2, ğœ€F)-pseudorandom function.
Then the DTE authenticated encryption scheme which en-
crypts â„“-block messages is (ğ‘, ğ‘¡, ğœ€)-MR as long as ğ‘¡ â‰¤ min{ğ‘¡1âˆ’
ğ‘(ğ‘¡H +(2â„“+1)ğ‘¡F), ğ‘¡2âˆ’ğ‘ğ‘’(ğ‘¡H +(2â„“+1)ğ‘¡F)} with 0 â‰¤ ğ‘ğ‘’ +ğ‘ğ‘‘ â‰¤ ğ‘,
where ğ‘ğ‘’ (resp. ğ‘ğ‘‘) is the number of encryption (resp. decryp-
tion) queries, where ğ‘¡H and ğ‘¡F are the time needed to evaluate
H and F, and we have
ğœ€ â‰¤ ğœ€Fâ‹† + ğœ€ğ‘ğ‘Ÿ + 2ğ‘ Â· ğœ€ğ‘ğ‘Ÿ + ğ‘(â„“ + 1) Â· ğœ€F
ğ‘’ + ğ‘2
+(ï¸€ğ‘ğ‘‘ + ğ‘2
ğ‘’ (â„“ + 1)2)ï¸€ Â· 2
âˆ’ğ‘›.
(1)
The guideline of the proof is as follows: first, we start by
arguing that all decryption queries can be answered by âŠ¥.
Then, proceeding block by block, we gradually show that the
answers to encryption queries can be replaced by random
outputs.
The easiest transition relies on the pseudorandomness of
F*, which is replaced by a truly random function f. There-
from, we can move to show the invalidity of the first fresh
decryption query ğ¶ = (ğœ, ğ‘), where ğ‘ = (ğ‘0, ğ‘1, . . . , ğ‘â„“). Since
(ğœ, ğ‘) is fresh, we will see that the decrypted tuple (ğ‘Ÿ, ğ‘š =
(ğ‘š1, . . . , ğ‘šâ„“)) is fresh. Thereby, the collision resistance en-
sures that â„ = H(ğ‘Ÿâ€–ğ‘š) is not the output of any previous
evaluation of H during the encryption queries. If â„ never
appeared until the first decryption query, then f(â„) Ì¸= ğœ ex-
cept by chance. However, we must also consider the event
by which â„ = ğœâ€², where ğœâ€² is the returned tag associated
to a previous fresh encryption query. Hence the need of the
range-oriented preimage resistance of H since ğœâ€² = ğ‘“ (â„â€²) is
random over {0, 1}ğ‘›, for some â„â€² Ì¸= â„. As a side note on the
proof, the unlikelihood of â„ = ğœâ€² also plays an important
role to ensure the random-looking of the ciphertexts. Indeed,
if the adversary managed to query an encryption on the a
pair (ğ‘Ÿ, ğ‘š) such that ğœâ€² = H(ğ‘Ÿâ€–ğ‘š), the answer (ğœ, ğ‘) of the
(modified) encryption oracle would reveal the ephemeral key
ğ‘˜â€²
0 = ğœ = ğ‘“ (â„â€²) of the ciphertext containing the tag ğœâ€².
The proof of Theorem 5.1 is available in the full version of
the paper [10].
5.4 The Unbounded Leakage Model
Before turning to our proof of the CIML security of DTE,
we need to introduce a leakage model. For this proof, we can
adopt a very permissive leakage model, which we call the
unbounded leakage model.
Definition 5.2. An implementation of a scheme with leak-
age function L is said to offer a security property in the
unbounded leakage model if that property is satisfied even if L
yields all the internal states produced during each execution
of the scheme, including all keys and random coins, at the
exclusion of the internal state of leak-free components if there
are any.
In the case of DTE, this means that, on each encryption
query, everything is leaked except for the long-term key ğ‘˜
used by the leak-free component. Or, in an equivalent way,
and in the context of CIML security, we can just assume
that ğ‘˜0 is leaked, since ğ‘Ÿ and ğ‘š are known to the adversary
anyway, and all the internal variables can be recomputed
from ğ‘˜0. Indeed, given ğ‘˜0 the adversary is able to derive all
the ephemeral keys (ğ‘˜1, . . . , ğ‘˜â„“) used during each encryption
query, which in turns gives him all the (ğ‘¦0, ğ‘¦1, . . . , ğ‘¦â„“) values
from Fig. 3.
5.5 CIML Security of DTE
We now prove that DTE satisfies the CIML notion in the
unbounded leagage model.
Theorem 5.3. Let H : {0, 1}ğ‘› Ã— {0, 1}â‹† â†’ {0, 1}ğ‘› be
a (0, ğ‘¡â€², ğœ€ğ‘ğ‘Ÿ)-collision resistant and (0, ğ‘¡â€², ğœ€ğ‘ğ‘Ÿ)-range-oriented
preimage resistant hash function. Let F* : {0, 1}ğ‘›Ã—{0, 1}ğ‘› â†’
{0, 1}ğ‘› be a (2ğ‘ + 2, ğ‘¡â€², ğœ€F* )-pseudorandom function. Then