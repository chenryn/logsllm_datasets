figurable parameter for correctness of the construction. Hence, by
the property of ğœ“, ğ‘ƒ1 gets the required comparison bit comp. We
formally describe the protocol in Figure 8.
ğœ
ğœ“(ğ‘¥) =
Parameters: There are ğ‘› parties ğ‘ƒ1, Â· Â· Â· , ğ‘ƒğ‘› with (ğ‘›, ğ‘¡)âˆ’
shares [ğ‘], of ğ‘ âˆˆ Fğ‘ and ğ‘  ğ‘› > ğ‘˜, ğ‘› > 2ğ‘¡, ğœ is a configurable
parameter for correctness of construction and ğ½ = âŒˆ
log |Fğ‘ |âŒ‰.
Additions and multiplications are over the field Fğ‘.
Define the polynomial ğœ“ (publicly known to all parties):
if ğ‘˜ â‰¥ ğ‘›
2
if ğ‘˜ < ğ‘›
2
(ğ‘¥ âˆ’ ğ‘˜) Â· (ğ‘¥ âˆ’ (ğ‘˜ + 1)) Â· Â· Â· (ğ‘¥ âˆ’ ğ‘›) ,
ğ‘¥ Â· (ğ‘¥ âˆ’ 1) Â· (ğ‘¥ âˆ’ 2) Â· Â· Â· (ğ‘¥ âˆ’ (ğ‘˜ âˆ’ 1)) ,
Input: For each ğ‘– âˆˆ [ğ‘›], ğ‘ƒğ‘– inputs its (ğ‘›, ğ‘¡)âˆ’ share [ğ‘]ğ‘–.
Protocol:
(1) Pre-processing: ğ‘ƒ1, Â· Â· Â· , ğ‘ƒğ‘› run:
[ğ‘ 1], Â· Â· Â· , [ğ‘ ğ½ ] â† RandomFğ‘›,ğ‘¡ (ğ½).
(2) Evaluating the polynomial: ğ‘ƒ1, Â· Â· Â· , ğ‘ƒğ‘› do:
â€¢ On input [ğ‘], invoke MultFğ‘›,ğ‘¡ to compute all the re-
quired [ğ‘ğ‘–], followed by scalar multiplications and ad-
ditions to compute [ğœ“(ğ‘)].
- [ğ‘£ ğ‘—] â† MultFğ‘›,ğ‘¡ ([ğœ“(ğ‘)], [ğ‘  ğ‘—]).
- ğ‘£ ğ‘— â† Revealğ‘›,ğ‘¡ ([ğ‘£ ğ‘—]).
â€¢ For each ğ‘— âˆˆ [ğ½], do:
Output: If ğ‘˜ â‰¥ ğ‘›/2, if ğ‘£ ğ‘— = 0,âˆ€ğ‘— âˆˆ [ğ½], ğ‘ƒ1 sets comp = 1,
else sets comp = 0. If ğ‘˜ < ğ‘›/2, if ğ‘£ ğ‘— = 0,âˆ€ğ‘— âˆˆ [ğ½], ğ‘ƒ1 sets
comp = 0 else sets comp = 1. Other parties get no output.
Figure 8: WEAK COMPARISON PROTOCOL I
Theorem 5.2. The protocol in Figure 8 securely realizes F ğ‘,ğ‘˜,ğ‘›,ğ‘¡
w-CMP in
the F -hybrid model, where F = (RandomFğ‘›,ğ‘¡ , MultFğ‘›,ğ‘¡ , Revealğ‘›,ğ‘¡ ),
against a semi-honest adversary corrupting ğ‘¡ < ğ‘›/2 parties. The total
amortized communication cost of the protocol is at most 14ğ‘˜â€²(ğ‘› âˆ’
1)(âŒˆlog ğ‘›âŒ‰+1)+17ğœ(ğ‘›âˆ’1) and the round complexity is 6+2ğ‘˜â€², where
ğ‘˜â€² = min{ğ‘˜ âˆ’ 1, ğ‘› âˆ’ ğ‘˜}.
We give a complete proof of Theorem 5.2 in Appendix E.1 and
discuss the complexities in Appendix F.2.1.
5.2.2 Weak Comparison Protocol w-CMP2. This protocol is a slight
modification of the comparison protocol from [12]. The main idea
of their comparison protocol is as follows: For 0 â‰¤ ğ‘, ğ‘˜ < ğ‘›,
(cid:107)
ğ‘ â‰¥ ğ‘˜ iff(cid:106) (ğ‘âˆ’ğ‘˜)
of(cid:106) (ğ‘âˆ’ğ‘˜)
2ğ›¾
2ğ›¾
= 0 (where ğ›¾ = âŒˆlog ğ‘›âŒ‰ + 1). Hence, the pro-
tocol takes the (ğ‘›, ğ‘¡)âˆ’ shares of ğ‘ and evaluates the (ğ‘›, ğ‘¡)âˆ’ shares
(cid:107). This protocol invokes the multiparty functionalities
MultFğ‘›,ğ‘¡, RandomFğ‘›,ğ‘¡ and Revealğ‘›,ğ‘¡ . Corresponding to the instan-
tiations of these functionalities used in [12], their protocol has an
ğ‘›2 factor in the communication complexity. Instead, we use the
instantiations from [21] for these functionalities, which reduces
the communication complexity of their protocol. For complete-
ness, we give the full protocol, which is modified (and simplified)
appropriately to instantiate F ğ‘,ğ‘˜,ğ‘›,ğ‘¡
w-CMP
, in Appendix E.2.
6 IMPLEMENTATION AND EVALUATION
In this section, we discuss the performance of our mPSI (multiparty
PSI) protocols8. Let Protocol A, Protocol B and Protocol C denote
our mPSI protocols when instantiated with polynomial-based batch
OPPRF [65], table-based OPPRF [51] and relaxed batch OPPRF [13]
respectively. We compare the performance of our mPSI protocols
with the state-of-the-art mPSI protocol in literature [51].
Protocol Parameters. We set statistical security parameter ğœ…=40
and computational security parameter ğœ†=128. Correctness of The-
orem 3.1 requires Cuckoo hashing failure in Step 2 (Figure 4) to
be at most 2âˆ’41. Similar to [13, 51, 65, 67], we use the empirical
analysis to instantiate the parameters of Cuckoo hashing scheme
in the stash-less setting as ğ›½ = 1.28ğ‘š for ğ¾ = 3 (see Section 2.2).
Based on Theorem 3.1, we set size of elements ğœ = ğœ… + âŒˆlog ğ‘šâŒ‰ +3 to
achieve statistical security of ğœ… bits. Hence, the minimum element
size ğœ required in mPSI protocol to ensure that the failure probabil-
ity is at most 2âˆ’40 is 55, 59 and 63 for input set sizes 212, 216 and
220 respectively. In the implementation of Step 4 (see Figure 4) of
mPSI protocol for input set size 212 and 216, we perform arithmetic
over prime field where the prime is the Mersenne prime 261 âˆ’ 1.
For input set size 220, we choose the prime field with Mersenne
prime 2127 âˆ’ 1 for the LAN setting; for WAN setting we choose the
Galois Field over an irreducible polynomial where each element is
represented in 64 bits. This is due to compute vs communication
trade-offs between the two fields.
Based on correctness analysis, we set ğœ = ğœ…+âŒˆlog ğ‘šâŒ‰+âŒˆlog ğ‘›âŒ‰+2
for our Circuit PSI and qPSI protocols, i.e., larger of the element
size required by these two protocols.
Implementation Details. We make use of the implementation
of polynomial-based batch OPPRF [65] and table-based OPPRF
[51] available at [25] and [60] respectively. For implementation
of relaxed batch OPPRF [13] and equality test functionality F â„“
EQ
[13, 23, 32, 68], we use the code available at [58]. For Boolean to
Arithmetic share conversion functionality F F
[68], we use the
B2A
implementation of correlated OTs available at [57]. Finally, we use
the code available at [20] for multiparty functionalities [21, 52] (see
Section 2.5).
Experimental Setup. Similar to [51], we ran our experiments on a
single machine with 64-core Intel Xeon 2.6GHz CPU and 256GB
RAM, and simulated the network environment using the Linux
ğ‘¡ğ‘ command. We configure a LAN connection with bandwidth 10
8Code available at https://aka.ms/PQC-mPSI
Session 4C: Private Set Intersection CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1192ğ‘›, ğ‘¡
ğ‘š
KMPRT
Protocol A
4, 1
216
114.1
49.4
212
7.2
3.2
220
2057.7
790.2
212
13.4
4.6
5, 2
216
211.2
72.7
220
3805.4
1162.8
212
44.7
12.3
10, 4
216
706.2
192.4
220
12730.4
3077.2
212
103.4
22.5
15, 7
216
1635.4
353.4
220
29487.9
5652.9
Table 2: Total communication in MB of mPSI protocols: KMPRT [51] and Protocol A.
ğ‘›, ğ‘¡
ğ‘š
KMPRT
Protocol A
4, 1
216
51.9
19.9
212
3.3
1.3
220
935.2
318.0
212
4.9
1.5
5, 2
216
77.8
23.3
220
1402.0
372.6
212
8.3
2.0
10, 4
216
131.7
30.8
220
2373.5
492.1
212
13.1
2.4
15, 7
216
207.5
38.8
220
3741.0
620.1
Table 3: Client communication in MB of mPSI protocols: KMPRT [51] and Protocol A.
ğ‘›, ğ‘¡
ğ‘š
KMPRT
Ours
ğ‘›, ğ‘¡
ğ‘š