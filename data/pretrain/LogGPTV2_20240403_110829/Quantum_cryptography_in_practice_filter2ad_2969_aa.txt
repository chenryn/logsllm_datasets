title:Quantum cryptography in practice
author:Chip Elliott and
David Pearson and
Gregory D. Troxel
Quantum Cryptography in Practice 
Chip Elliott 
BBN Technologies 
10 Moulton Street 
Cambridge, MA  02138 
PI:EMAIL 
Dr. David Pearson 
BBN Technologies 
10 Moulton Street 
Cambridge, MA  02138 
PI:EMAIL 
Dr. Gregory Troxel 
BBN Technologies 
10 Moulton Street 
Cambridge, MA  02138 
PI:EMAIL 
testing 
ABSTRACT 
BBN,  Harvard,  and  Boston  University  are  building  the 
DARPA  Quantum  Network,  the  world’s  first  network  that 
delivers end-to-end network security via high-speed Quantum 
Key  Distribution,  and 
that  Network  against 
sophisticated  eavesdropping  attacks.  The  first  network  link 
has been up and steadily operational in our laboratory since 
December  2002.  It  provides  a  Virtual  Private  Network 
between  private  enclaves,  with  user  traffic  protected  by  a 
weak-coherent  implementation  of  quantum  cryptography. 
This prototype is suitable for deployment in metro-size areas 
via standard telecom (dark) fiber. In this paper, we introduce 
quantum cryptography, discuss its relation to modern secure 
networks,  and  describe  its  unusual  physical  layer,  its 
specialized  quantum  cryptographic  protocol  suite  (quite 
interesting  in  its  own  right),  and  our  extensions  to  IPsec  to 
integrate it with quantum cryptography. 
Categories and Subject Descriptors 
C.2.1 
cryptography. 
General  Terms:  Algorithms,  Measurement,  Design, 
Experimentation, Security. 
Keywords:  Quantum 
cryptography,  quantum  key 
distribution,  secure  networks,  cryptographic  protocols,  key 
agreement  protocols,  error  correction,  privacy  amplification, 
IPsec. 
[Network  Architecture  and  Design]:  quantum 
1.  QUANTUM KEY DISTRIBUTION 
Modern  networks  generally  rely  on  one  of  two  basic 
cryptographic  techniques  to  ensure  the  confidentiality  and 
integrity  of  traffic  carried  across  the  network:  symmetric 
(secret) key and asymmetric (public) key. Indeed today’s best 
systems generally employ both, using public key systems for 
authentication and establishment of secret “session” keys, and 
then protecting all or part of a traffic flow with these session 
This  work  is  supported  by  the  Defense  Advanced  Research  Projects
Agency  (DARPA).  The  views  and  conclusions  contained  in  this
document  are  those  of  the  authors  and  should  not  be  interpreted  as 
representing the official policy of DARPA or the U. S. Government. 
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies
are not made or distributed for profit or commercial advantage and that
copies bear this notice and the full citation on the first page. To copy
otherwise,  or  republish,  to  post  on  servers  or  to  redistribute  to  lists,
requires prior specific permission and/or a fee. 
SIGCOMM ‘03, August 25-29, 2003, Karlsruhe, Germany 
Copyright 2003 ACM 1-58113-735-4/03/0008…$5.00. 
Alice
(the sender)
plaintext
Eve
(the eavesdropper)
Bob
(the receiver)
plaintext
encryption
algorithm
public channel
(i.e. telephone or internet)
decryption
algorithm
key
key
quantum state
generator
quantum channel
(i.e. optical fiber or free space)
quantum state
detector
Figure 1. Quantum Key Distribution. 
that 
the 
theoretical  models  continue 
keys.  Certain  other  systems  transport  secret  keys  “out  of 
channel,” e.g. via courier, as in classical cryptography. 
Fundamental  aspects  of  quantum  physics  –  unitarity,  the 
uncertainty  principle,  and 
the  Einstein-Podolsky-Rosen 
violation of Bell’s inequalities – now suggest a third paradigm 
for  key  distribution:  quantum  cryptography. 
Initial 
experiments  seem  to  confirm  the  utility  of  this  paradigm. 
Assuming 
to  be 
confirmed in the use of actual devices, the fundamental laws 
of  nature  can  be  invoked  to  assure  the  confidentiality  of 
transmitted data. 
As shown in Fig. 1, quantum cryptography – more properly 
termed  Quantum  Key  Distribution,  QKD  –  employs  two 
distinct  channels.  One  is  used  for  transmission  of  quantum 
key  material  by  very  dim  (single  photon)  light  pulses.  The 
other, public channel carries all message traffic, including the 
cryptographic protocols, encrypted user traffic, etc. 
QKD consists of the transmission of raw key material, e.g., as 
dim  pulses  of  light  from  Alice  to  Bob,  via  the  quantum 
channel,  plus  processing  of  this  raw  material  to  derive  the 
actual keys.  This processing involves public communication 
(key agreement protocols) between Alice and Bob, conducted 
in the public channel, along with specialized QKD algorithms. 
The  resulting  keys  can  then  be  used  for  cryptographic 
purposes, e.g., to protect user traffic. By the laws of quantum 
physics, any eavesdropper (Eve) that snoops on the quantum 
channel  will  cause  a  measurable  disturbance  to  the  flow  of 
single photons. Alice and Bob can detect this, take appropriate 
steps 
in  response,  and  hence  foil  Eve’s  attempt  at 
eavesdropping. 
Quantum  cryptography  was  proposed  by  Bennett  and 
Brassard  in  1984,  who  also  defined  the  first  QKD  protocol, 
called BB84 [1,2]. At time of writing, a handful of research 
teams  around  the  world  have  succeeded  in  building  and 
operating quantum cryptographic devices. Teams at Geneva, 
Los  Alamos,  IBM,  and  elsewhere  are  performing  QKD 
through telecom fibers [3,4,5]. The best current systems can 
support distances up to about 70 km through fiber, though at 
very  low  bit-rates  (e.g.  a  few  bits/second).  Teams  at  Los 
Alamos and Qinetiq [6,7] are performing free-space quantum 
cryptography, both through daytime sky and through the night 
at distances up to 23 km. 
In addition to these efforts, whose systems all employ weak-
coherent  quantum  cryptography,  there  is  also  interest  in 
cryptography based on a very different physical phenomenon, 
namely entanglement between pairs of photons produced by 
Spontaneous  Parametric  Down-Conversion  (SPDC).  This 
form of cryptography has been demonstrated by Geneva [8,9] 
and discussed in a number of interesting papers [10-16]. 
The Geneva team has provided a superb overview of current 
state  of  the  art  in  QKD  [17].  We  heartily  recommend  it  to 
anyone interested in learning more about this fascinating field. 
that  decryption 
2.  DESIRABLE QKD ATTRIBUTES 
Broadly  stated,  QKD  offers  a  technique  for  coming  to 
agreement upon a shared random sequence of bits within two 
distinct devices, with a very low probability that other devices 
(eavesdroppers) will be able to make successful inferences as 
to those bits’ values. In specific practice, such sequences are 
then used as secret keys for encoding and decoding messages 
between the two devices. Viewed in this light, QKD is quite 
clearly a key distribution technique, and one can rate QKD’s 
strengths  against  a  number  of  important  goals  for  key 
distribution, as summarized in the following paragraphs. 
Confidentiality  of  Keys.  Confidentiality  is  the  main  reason 
for  interest  in  QKD.  Public  key  systems  suffer  from  an 
ongoing  uncertainty 
is  mathematically 
intractable.  Thus  key  agreement  primitives  widely  used  in 
today’s  Internet  security  architecture,  e.g.,  Diffie-Hellman, 
may  perhaps  be  broken  at  some  point  in  the  future.  This 
would not only hinder future ability to communicate but could 
reveal  past  traffic.  Classic  secret  key  systems  have  suffered 
from  different  problems,  namely,  insider  threats  and  the 
logistical  burden  of  distributing  keying  material.  Assuming 
that QKD techniques are properly  embedded into an overall 
secure system, they can provide automatic distribution of keys 
that may offer security superior to that of its competitors. 
Authentication.  QKD  does  not 
itself  provide 
authentication.  Current  strategies  for  authentication  in  QKD 
systems  include  prepositioning  of  secret  keys  at  pairs  of 
devices, to be used in hash-based authentication schemes, or 
hybrid  QKD-public  key  techniques.  Neither  approach  is 
entirely  appealing.  Prepositioned  secret  keys  require  some 
means  of  distributing  these  keys  before  QKD  itself  begins, 
e.g., by human courier, which may be costly and logistically 
challenging.  Furthermore,  this  approach  appears  open  to 
denial of service attacks in which an adversary forces a QKD 
system to exhaust its stockpile of key material, at which point 
it  can  no  longer  perform  authentication.  On  the  other  hand, 
hybrid  QKD-public  key  schemes 
the  possible 
vulnerabilities of public key systems to cracking via quantum 
computers or unexpected advances in mathematics. 
in 
inherit 
it 
is  essential  for  secure  communications, 
Sufficiently  Rapid  Key  Delivery.  Key  distribution  systems 
must deliver keys fast enough so that encryption devices do 
not exhaust their supply of key bits. This is a race between the 
rate at which keying material is put into place and the rate at 
which it is consumed for encryption or decryption activities. 
Today’s  QKD  systems  achieve  on  the  order  of  1,000 
bits/second  throughput  for  keying  material,  in  realistic 
settings,  and  often  run  at  much  lower  rates.  This  is 
unacceptably low if one uses these keys in certain ways, e.g., 
as one-time pads for high-speed traffic flows. However it may 
well be acceptable if the keying material is used as input for 
less secure (but often secure enough) algorithms such as the 
Advanced  Encryption  Standard.  Nonetheless,  it  is  both 
desirable  and  possible  to  greatly  improve  upon  the  rates 
provided by today’s QKD technology. 
Robustness.  This  has  not  traditionally  been  taken  into 
account  by  the  QKD  community.  However,  since  keying 
material 
is 
extremely important that the  flow of  keying  material not be 
disrupted, whether by accident or by the deliberate acts of an 
adversary (i.e. by denial of service). Here QKD has provided 
a  highly  fragile  service  to  date  since  QKD  techniques  have 
implicitly been employed along a single point-to-point link. If 
that link were disrupted, whether by active eavesdropping or 
indeed by fiber cut, all flow of keying material would cease. 
In  our  view  a  meshed  QKD  network  is  inherently  far  more 
robust  than  any  single  point-to-point  link  since  it  offers 
multiple paths for key distribution. 
Distance-  and  Location-Independence.  In  the  ideal  world, 
any  entity  can  agree  upon  keying  material  with  any  other 
(authorized)  entity  in  the  world.  Rather  remarkably,  the 
Internet’s  security  architecture  does  offer  this  feature  –  any 
computer on the Internet can form a security association with 
any  other,  agreeing  upon  keys  through  the  Internet  IPsec 
protocols.  This  feature  is  notably  lacking  in  QKD,  which 
requires the two entities to have  a direct and unencumbered 
path for photons between them, and which can only operate 
for a few tens of kilometers through fiber. 
Resistance to Traffic Analysis. Adversaries may be able to 
perform  useful  traffic  analysis  on  a  key  distribution  system, 
e.g.,  a  heavy  flow  of  keying  material  between  two  points 
might reveal that a large volume of confidential information 
flows, or will flow, between them. It may thus be desirable to 
impede such analysis. Here QKD in general has had a rather 
weak  approach  since  most  setups  have  assumed  dedicated, 
point-to-point  QKD  links  between  communicating  entities 
which  thus  clearly  lays  out  the  underlying  key  distribution 
relationships. 
3.  THE DARPA QUANTUM 
NETWORK 
The  DARPA  Quantum  Network  aims  to  strengthen  QKD’s 
performance  in  these  weaker  areas.  In  some  instances,  this 
involves  the  introduction  of  newer  QKD  technologies;  for 
example,  we  hope  to  achieve  rapid  delivery  of  keys  by 
introducing a new, high-speed source of entangled photons. In 
other instances, we rely on an improved system architecture to 
achieve  these  goals;  thus,  we  tackle  distance-  and  location-
independence by introducing a network of trusted relays. 
Virtual
Private
Network
(VPN)
Internet Protocol (IP)
Internet Protocol (IP)
Virtual
Private
Network
(VPN)
IPsec
Red
802.2
Red
Enet
Black
802.2
Black
Enet
IPsec
Red
802.2
Red
Enet
Black
802.2
Black
Enet
Crypto
Internet
QKD
Protocols
Raw Key
Symbols
QKD
Physical
Optical
Process
Control
(OPC)
QKD
Protocols
Raw Key
Symbols
Optical
Process
Control
(OPC)
QKD
Physical