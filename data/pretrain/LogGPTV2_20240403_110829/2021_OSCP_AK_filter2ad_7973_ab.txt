# 实验室环境与考试流程

## 实验室环境
实验室（Lab）分为Public段、IT段、Development段、Admin段和Sandbox组。其中，IT段、Development段和Admin段均为内网段，需要在特定的Public机器上获取密钥才能解锁，并且必须在这台机器上建立隧道连接。特别是Admin段，需要建立两个隧道，操作较为复杂。Sandbox组对应PDF文档的最后一章中的域渗透机器组，这些机器组合得非常巧妙，强烈建议尝试。每天有12次重置机器的机会，如果不够，可以联系技术人员刷新。

每位学生将被分配一台Windows 10系统、一台Windows Server系统和一台Debian系统，可以通过远程连接进行访问。部分练习和实验都需要使用这些机器，尤其是缓冲区溢出（BOF）部分。个人推荐使用Xfreerdp作为远程连接工具。

## 考试流程

### 考试前
考试需提前预约，总共可修改三次时间。本人在完成PDF学习后（约8月初），预约了10月3日的考试。但实际在9月10日前就已经完成了所有Lab练习，包括Public网段刷了三遍。考虑到今年中秋与国庆并不相连，加上冷静期的要求，我将考试日期改到了9月20日。但由于多数时间段已被预订，最终只能选择上午11点开始考试。

#### 考前注意事项
- 仔细阅读[考前须知](https://help.offensive-security.com/hc/en-us/articles/360040165632)，避免违规行为。
- 提前熟悉[录屏方法](https://help.offensive-security.com/hc/en-us/articles/360050299352-Proctoring-Tool-Student-Manual)。考试过程中将通过浏览器应用进行屏幕录制，请确保弹窗功能已开启。
- 如遇问题，请通过[Live Chat](https://chat.offensive-security.com/)或邮件寻求帮助。工作人员态度友好，在他们能力范围内会尽力协助解决问题。

### 考试中
考试前一天回家休息并复习了PDF资料及笔记。确保网络连接顺畅，并准备好多种科学上网方案。理论上，此时可以申请一次模拟考试来确认网络状态，但由于未仔细阅读相关邮件，错过了这一环节。鉴于考试将持续24小时，晚上11点便上床睡觉以保持良好精神状态。

第二天早上9点起床用餐后进入监考室等待考官到来。监考过程无需安装额外软件，全部操作均在浏览器内完成。按照指示出示身份证件并通过摄像头展示房间内部情况以证明无作弊行为后，于11点收到包含用户名、密码以及六个IP地址（五台目标机加一台调试机）的邮件。随后与考官确认网络状况良好后正式开始答题。

**题目分值分布如下：**
- BOF: 25分
- 常规机器: 分别为25分、20分、20分、10分

总分为100分，达到70分即可通过。最佳策略是先完成BOF题（25分），然后选择两道20分的题目之一，最后挑战另一道25分题。至于仅值10分的小题则相对次要，不必过分关注。

我的解题顺序计划如下：
1. 完成BOF题，争取快速获得基础分数。
2. 挑选其中一个20分题尝试突破。
3. 接着解决剩余的25分大题。
4. 最后再处理剩下的小题。

然而，在进行BOF调试时突然遭遇两次短暂断网（总计约十分钟）。尽管感到紧张，但在重启路由器后恢复正常通信。整个BOF过程中最耗时的部分在于查找坏字符，这一步骤务必谨慎执行。此外，每台设备都应重新初始化！虽然官方声称会在考试开始前自动重置所有机器，但实际上并未如此操作。若非借助调试软件恢复界面布局，我可能无法顺利完成此题。

接下来利用nmap对两台20分机器进行了初步扫描，并采用Autorecon进一步详查。期间向考官告知暂时离线就餐。返回后继续解题。起初遇到困难的一台20分机器让我颇感棘手，于是决定转向另一台。幸运的是后者相对简单些，除了提权步骤稍显复杂外并无太大障碍。至此，我已经积累了45分。

考虑到还有足够的时间冲刺更高分数，我选择了挑战25分的大题。该题涉及多个网页漏洞组合利用，要求耐心地逐一尝试各种可能性。最终，在Google的帮助下成功定位并利用了关键弱点，顺利拿下满分。

此时总分为70分，已经达到了合格标准。但由于担心报告撰写过程中可能出现扣分情况，因此决定继续努力直至完成所有项目。晚餐过后再次投入战斗，先是尝试攻破那道价值较低的10分题但未能成功，转而回到之前放弃的20分题。经过一番探索后意外发现了有效攻击路径，并迅速实施了渗透行动。至此，所有靶标均已攻克。

完成全部任务后询问是否可以立即编写报告，得到肯定答复后即刻着手整理素材并撰写文档。虽然官方提供的模板不尽如人意，但我根据自身习惯对其进行了调整。重要的是要确保评审人员能够依据你的描述复现整个过程。最终提交了一份长达108页的报告，并于午夜前结束考试。

### 考试后
三天后收到了结果通知邮件，得知自己顺利通过考核。随即填写了证书邮寄地址信息，并获得了在线OSCP徽章用于社交媒体展示。大约一个月之后实物证书也送达到了家中。

## 工具清单
- **端口扫描**: nmap, Autorecon
- **目录枚举**: gobuster, dirsearch (仅当gobuster无效时使用)
- **数据包捕获**: Burp Suite
- **哈希识别**: hashid, hash-identifier
- **密码破解**: john, hashcat
- **凭证暴力破解**: hydra, crackmapexec
- **payload生成**: msfvenom
- **SQL注入测试**: 手动注入（禁止使用自动化工具）
- **漏洞利用辅助**: Google搜索, Metasploit Framework (限用一次)
- **端口转发**: chisel
- **文件传输**: curl, wget
- **Linux提权脚本**: LinEnum.sh, linpeas.sh, linuxprivchecker.py, linux-exploit-suggester.sh
- **Windows提权工具**: Windows-Exploit-Suggester, PowerTools, winPEAS, Sherlock
- **漏洞数据库**: [Exploit-DB](https://www.exploit-db.com/), GitHub

特别提醒：linpeas.sh脚本中的sudo令牌模块需要适当修改，以防止自动提升权限。详情请参阅[官方指南](https://www.offensive-security.com/offsec/understanding-pentest-tools-scripts/?utm_content=163426837&utm_medium=social&utm_source=twitter&hss_channel=tw-134994790)

## 结语
OSCP考试的核心在于细致入微的枚举工作、准确识别潜在漏洞以及手动执行攻击策略。它带来的成就感与其他经历截然不同，有点类似于高考或者驾照考试，但又因其属于个人兴趣领域而显得更加特别。如果你也有志于此，欢迎随时联系我咨询更多信息。

电子邮件: [PI:EMAIL](mailto:PI:EMAIL)

最后，永不放弃，**Try Harder!**