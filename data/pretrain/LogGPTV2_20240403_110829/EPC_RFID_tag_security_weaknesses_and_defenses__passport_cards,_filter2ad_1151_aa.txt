title:EPC RFID tag security weaknesses and defenses: passport cards,
enhanced drivers licenses, and beyond
author:Karl Koscher and
Ari Juels and
Vjekoslav Brajkovic and
Tadayoshi Kohno
EPC RFID Tag Security Weaknesses and Defenses:
Passport Cards, Enhanced Drivers Licenses, and Beyond
Karl Koscher
University of Washington
Seattle, Washington, USA
PI:EMAIL
Vjekoslav Brajkovic
University of Washington
Seattle, Washington, USA
PI:EMAIL
ABSTRACT
EPC (Electronic Product Code) tags are industry-standard
RFID devices poised to supplant optical barcodes in many
applications. We explore the systemic risks and challenges
created by the increasingly common use of EPC for secu-
rity applications. As a central case study, we examine the
recently issued United States Passport Card and Washing-
ton State “enhanced drivers license” (WA EDL), both of
which incorporate Gen-2 EPC tags. We measure multi-
ple weaknesses, including susceptibility to cloning, extended
read ranges, and the ability to remotely kill a WA EDL.
We study the implications of these vulnerabilities to overall
system security, and oﬀer suggestions for improvement. We
demonstrate anti-cloning techniques for oﬀ-the-shelf EPC
tags, overcoming practical challenges in a previous proposal
to co-opt the EPC “kill” command to achieve tag authenti-
cation. Our paper ﬁlls a vacuum of experimentally grounded
evaluation of and guidance for security applications for EPC
tags not just in identity documents, but more broadly in the
authentication of objects and people.
Categories and Subject Descriptors
K.6.5 [Management of Computing and Information
Systems]: Security and Protection—Authentication; K.4.1
[Computers and Society]: Public Policy Issues—Privacy,
Abuse and crime involving computers
General Terms
Security, Measurement
Keywords
Authentication, Cloning, EPC, Passport Card, RFID, WHTI
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
CCS’09, November 9–13, 2009, Chicago, Illinois, USA.
Copyright 2009 ACM 978-1-60558-352-5/09/11 ...$10.00.
Ari Juels
RSA Labs
Cambridge, Mass., USA
PI:EMAIL
Tadayoshi Kohno
University of Washington
Seattle, Washington, USA
PI:EMAIL
1.
INTRODUCTION
EPC (Electronic Product Code) tags [17] are RFID de-
vices poised to supplant optical barcodes in a wide variety
of applications. Today EPC tags ﬁgure most prominently
in the tracking of cases and pallets in supply chains. Propo-
nents of the technology envision a future in which tagging
of individual items facilitates a full life-cycle of automation
from shop ﬂoors to retail points of sale, in home appliances,
and through to recycling facilities.
As one example of this application, EPC tags are now see-
ing a landmark deployment in the U.S. in identity documents
used at national border crossings. The United States Pass-
port Card (also known as the PASS Card), a land-border and
seaport entry document ﬁrst issued in the summer of 2008,
incorporates an EPC tag. This identity document was is-
sued in response to the Western Hemisphere Travel Initiative
(WHTI) [40], which, among others, phases out exemptions
in document requirements for border crossing (previously,
United States and Canadian citizens only had to present
photo ID and a birth certiﬁcate). Certain states have issued
or plan to issue Enhanced Drivers Licenses (EDLs), which
are WHTI-compliant documents that will also make use of
EPC. Washington State started issuing EDLs in early 2008
[29], with New York State following in September 2008 [1].
To date, the only form of EPC ratiﬁed as a technical stan-
dard by EPCglobal, the body that oversees EPC develop-
ment, is the Class-1 Gen-2 tag.
(For brevity, we refer to
this tag simply as a “Gen-2” or “EPC” tag in this paper.)
Passport Cards and other WHTI documents will incorpo-
rate this type of EPC tag, and it is likely to see the greatest
use in barcode-type RFID applications as well for some time
to come. EPC tags are attractive for their low cost (below
ten U.S. cents each). Also, thanks to their operation in
the Ultra-High Frequency (UHF) spectrum (860–960 MHz),
they have a relatively long read range—tens of feet under
benign conditions [34].
1.1 Our contribution: vulnerability analysis
The deployment of EDLs and Passport Cards at interna-
tional borders is among the ﬁrst and most prominent exam-
ples of the use of EPC RFID tags in security applications—of
which many more examples may follow. We therefore use
this opportunity to evaluate the use of EPC tags in the con-
text of a real security application, with lessons, challenges,
and results broadly applicable to other potential uses. We
emphasize a systemic approach, examining low-level secu-
rity features and evaluating their signiﬁcance in potential
real-world deployment scenarios. Through the course of this
research we have uncovered a number of attacks. We realize
that not all of these attacks will be applicable all the time
in the U.S. border crossing scenarios, but we feel that they
may be applicable at some times if appropriate procedures
are not in place, or may be applicable to other countries
wishing to deploy similar technologies. The lessons learned
from these attacks apply broadly to other potential uses of
EDL tags in security applications.
Context. In its ﬁnal rule on the Passport Card [2], the
Department of State acknowledged objections expressed in
response to its proposed rule of 2006 [3]; four Members of
Congress expressed concerns about the security and privacy
of the Passport Card. The Department indicated that many
commenters did not understand “the business model that
WHTI is designed to meet,” and cited a need for simulta-
neous reading of multiple EPC tags as a motivation for its
choice of EPC (“vicinity read RFID”) as well as the tech-
nology’s amenability to passenger pre-processing,
its
relatively long read range.
(Some “proximity-read” RFID
devices, i.e., contactless smartcards, do not have these ben-
eﬁts, and some other classes of RFIDs only have the former
beneﬁt but not the latter.) The Department additionally
noted that on May 1, 2007, the National Institute for Stan-
dards and Technology (NIST) certiﬁed the Passport Card
as, “meeting or exceeding ISO security standards. . . and the
best available practices for protection of personal identiﬁ-
cation documents.” Finally, the Department observed that
Passport Cards will not carry personally identiﬁable infor-
mation, and will be issued with protective, radio-opaque
sleeves that help prevent unwanted scanning.
i.e.,
Our experiments: Cloning. In mid- to late-2008, we ob-
tained a Passport Card and two Washington State EDLs for
our experiments. We show ﬁrst that the publicly readable
data in both types of identity document can be straight-
forwardly cloned after a single read, despite the implication
of protection mechanisms in [28]. Speciﬁcally, our analysis
shows that Passport Cards and Washington State EDLs do
not carry tag-unique, or even system-unique TIDs, but in-
stead bear generic manufacturer codes. The Tag Identiﬁer
(TID) of an EPC, a tag-speciﬁc serial number that may be
factory programmed, is often held forth as an anti-cloning
mechanism for EPC tags. In its Privacy Impact Assessment
of the Passport Card, the U.S. Department of Homeland Se-
curity (DHS) in fact highlights tag-speciﬁc TIDs as a “pow-
erful tool” for anti-counterfeiting [28]. As Passport Cards
and Washington State EDLs do not carry specially formu-
lated TIDs, however, their readable contents are subject to
direct copying into another oﬀ-the-shelf EPC tag.
Our observations about cloning only apply to a tag’s pub-
licly readable data. Tags contain some private data in the
form of PINs, which may be tag unique. Hence it is pos-
sible in principle (although improbable in our view) that
a weak form of access-based authentication—an unortho-
dox security protocol we describe below—is in use at border
crossings.
In this case, reliable tag cloning would require
either eavesdropping on a tag interrogation at the border or
physically invasive attacks on a target identity document.
Without ourselves eavesdropping on a tag interrogation at
a border crossing, we are unable to determine whether or
not this technique is being deployed. We note, though, that
access-based authentication is not an explicitly supported
feature for EPC tags. The only reference to the technique
of which we are aware is a research paper [19]. Other tech-
niques, such as detection of unique radio ﬁngerprints [13,
11] are also a possibility in principle, but have not yet been
shown to work with EPC tags.
Our experiments: Readability. Given the ostensible vul-
nerability of identity documents and other Gen-2 EPC-tagged
items to cloning, a key security issue is the range at which an
EPC tag is subject to clandestine reading. As owners may
be expected to carry their tags in any of a variety of dif-
ferent circumstances, we explore read ranges within several
diﬀerent physical environments.
We ﬁnd that both Passport Cards and EDLs are subject to
reading at a distance of at least 50 meters under optimal scan
conditions (down a long hallway, but still operating within
FCC limits). Surprisingly, although the human body—its
constituent water, in particular—is known to interfere with
EPC tag reading, we ﬁnd that an EDL in a wallet near the
body is still subject to scanning at a distance of at least
two meters. We ﬁnd that the Passport Card is not readable
in a well maintained protective sleeve—although it is read-
able under certain circumstances in a crumpled sleeve. Most
surprisingly, perhaps, we ﬁnd that an EDL in a protective
sleeve is readable at a distance of some tens of centimeters.
To the best of our knowledge, our work here oﬀers the ﬁrst
multifaceted characterization of EPC read ranges from the
vantage point of privacy.
Our scanning experiments have a bearing not just on cloning,
but also on owner privacy: While the tags do not contain
personally identiﬁable information, they do contain unique
serial numbers that can support clandestine tracking [20].
Of course, other wireless devices, like Bluetooth peripher-
als [18], 802.11 [14], and ANT [32], are similar in this regard,
though the exposure for Passport Cards and EDLs may be
greater due to their usage models, e.g., with U.S. citizens
traveling abroad.
Other attacks. We also ﬁnd evidence that EDLs are vul-
nerable to denial-of-service and covert-channel attacks. These
vulnerabilities stem from issuance of cards without protec-
tion of the PIN for their tag-disablement feature, the “kill”
command. Passport Cards do not have similar weaknesses.
These ﬂaws, along with EDLs’ heightened susceptibility to
in-sleeve scanning, would seem to point to either a form of
design drift in which technical protections implemented at
the federal level did not beneﬁt Washington State in the ex-
tension to EDLs, or the risks associated with implementing
a technology before the precise security requirements have
been ﬁnalized.
Ultimately, all of our experimental results, such as our
observations of the failure to use card-speciﬁc TIDs or set
the KILL PINs on tags, speak to the challenge of deploying
even simple technologies—like EPC tags—in security appli-
cations.
1.2 Our contribution: countermeasures and
recommendations
We emphasize that the security impact of tag vulnerabil-
ities depends upon the operational environment. Copying
of a Passport Card or EDL does not automatically ensure
successful use at a border crossing. The card is linked via a
back-end system to a photo of its bearer which border agents
use for conﬁrmation of traveler identities. Hence, we discuss
the systemic signiﬁcance of the vulnerabilities we have iden-
tiﬁed.
We argue that Passport Cards and EDLs will play a role in
the border-crossing process that may give impactful promi-
nence to the data contained in the EPC tags. Like many
security processes, the passenger screening process beneﬁts
from multiple layers of security, including physical inspec-
tion of passengers and documents. But as the EPC code
can trigger a watchlist lookup, it serves as a frontline mech-
anism for passenger screening. The literature on cognitive
biases suggests a risk that the EPC-layer of the security sys-
tem will exercise undue inﬂuence over passenger screening
[35, 33, 24, 10].
We argue that even if EPC-enabled identity documents
provide adequate security at border crossings, they create
a system with delicate dependence on well conceived and
tightly executed border crossing procedures and card is-
suance. Our observations on the relative weakness of EDL
in comparison with Passport Cards, for example, support
the idea that states may not be as well equipped to enforce
good security practices around document issuance as DHS,
or that there was or is not suﬃcient guidance from the DHS.
Given these concerns, we study methods for improving the
cloning resistance of EPC tags. We show that the elemen-
tary security features in EPC tags can be co-opted to help
deter cloning. EPC tags include PIN-based protections both
on tag disablement (“killing”) and modiﬁcation of tag data
contents. Previous research [19] proposed techniques for co-
opting these features in the service of tag authentication, i.e.,
anti-counterfeiting, but oﬀered no experimental evaluation.
Given a few peculiarities of RFIDs, such as radio propa-
gation dynamics, experimental evaluation is critical toward
determining whether the approach in [19] is even feasible.
We ﬁll this gap here. We demonstrate that implementation
of “kill” co-opting techniques is indeed feasible in deployed
tags, but presents some delicate technical challenges. We ex-
plore some promising initial approaches to overcoming these
challenges.
We believe that the lessons drawn from our case study in
this paper will provide valuable guidance for the deployment
of EPC tags in many security applications beyond border-
crossing, such as anti-counterfeiting and secure item pedi-
grees for pharmaceutical supply chains [39].
1.3 Organization
In section 2, we brieﬂy review related work on RFID secu-
rity. We present our observations on the data format of the
Washington State EDL and Passport Cards in section 3. We
explore defensive techniques against cloning in section 4. We
conclude in section 5 with a brief discussion of the broader
implications of our ﬁndings.
2. RELATED WORK
There have been a number of radio-layer cloning attacks
against RFID tags. Westhues developed a device called the
Proxmark that he successfully used to clone both proxim-
ity cards [42] as well as the VeriChipT M [15], a human-
implantable RFID tag. The devices targeted by Westhues
emit static identiﬁers, i.e., they are essentially wireless bar-
codes. Class-1 Gen-2 EPC tags are similar in ﬂavor to these
devices, but operate in a much higher frequency band for
which signal-processing is more complicated.
Bono et al. [7] reverse engineered and mounted brute-force
key-cracking attacks against the Texas Instruments DST,
a cryptographically enabled RFID device with short (40-
bit) keys. Similarly, Nohl et al. [25] have recently reverse-
engineered the Philips Mifare Classic RFID tag and revealed
structural weaknesses in its cipher and random-number gen-
erator. Garcia et al. [12] demonstrated several additional,
highly practical attacks against the MIFARE Classic card.
Heydt-Benjamin et al. [16] demonstrated cloning attacks
against ﬁrst-generation RFID-enabled credit cards.
RFID tags saw their ﬁrst prominent appearance in iden-
tity documents as additions to e-passports. Grunwald [27]
cloned the chip in an RFID-enabled passport in the fullest
sense, transferring the data from one chip to another. Juels,
Molnar, and Wagner [21] evaluate the security implications
of e-passport cloning. E-passports diﬀer from Passport Cards
in that they perform cryptographic authentication. The
Smart Card Alliance, among others, noted the risks of EPC
cloning in response to the initial DHS WHTI proposal [4].
Some commercial RFID tags include strong cryptography
for challenge-response authentication. These tend to be rel-
atively expensive and have constrained range. The literature
is replete with techniques for implementing lower-cost cryp-
tography in RFID tags. See, e.g., [20] for a survey and [6]
for an up-to-date bibliography.
In view of the prevalence of Gen-2 EPC tags, Juels [19]
proposed techniques for authenticating these tags using two
existing commands, KILL and ACCESS. In section 4, we
report on our implementation of these techniques and the
practical challenges they pose.
For a more detailed discussion of how our results inter-
act with the operational environment of Passport Cards and
EDLs, please see the technical report corresponding to this
paper [23].
3. EXPERIMENTAL EVALUATION OF PASS-
PORT CARD AND EDLS
3.1 Weakness in the TID-based anti-cloning
mechanism
As mentioned above, EPC tags contain a data ﬁeld known
as the Tag Identiﬁer (TID). At the discretion of the EPC
manufacturer, this value may be factory programmed and
locked, thereby ensuring that tags have permanent unique
identities and (theoretically) cannot be cross-copied.
In its Privacy Impact Assessment (PIA) on the Passport
Card [28], the United States Department of Homeland Se-
curity posits that:
...the risk of cloning RFID enabled cards and
an impostor with similar physical features gain-
ing illegal entry into the U.S., while unlikely, is
real. Fortunately, there is a powerful tool that
can be used to remove the risk of cloning. This
tool is the Tag Identiﬁer, or TID. The TID is
available on all Gen 2 RFID tags.
However, the Gen-2 standard only requires that the TID
identify the manufacturer and give enough additional infor-
mation to determine the tag’s capabilities. In particular, two
classes of TIDs are deﬁned: the E0h class, where the TID
consists of a manufacturer ID and a 48-bit serial number,
and the E2h class, which merely deﬁnes the manufacturer
and model. The TID reported by our Passport Card is E2
00 34 11 FF B8 00 00 00 02, which corresponds to an
E2h-class Alien Higgs tag.
[26] states that the bytes af-
ter the manufacturer and model IDs (starting with FF) are
Alien-speciﬁc conﬁguration values. Using a new Higgs tag,
we experimentally veriﬁed that the ﬁrst three nibbles corre-
spond to the tag’s lock conﬁguration. The TID reported by
our Washington State EDLs is E2 00 10 50, which corre-
sponds to an E2h-class Impinj Monza chip.
To conﬁrm that these TIDs do not confer anti-counter-