5.4%
3.2%
0.0%
3.4%
20.1%
9.2%
0.0%
8.8%
total
11.9%
38.1%
total
47.9%
27.8%
22.4%
15.4%
< 0.1%
< 0.1%
12.1%
49.8%
24.2%
100%
45 h in winter 15/16. We implemented a custom tool built on top of the lib-
trace library [9] to produce two streams of data from raw network data. The
ﬁrst stream consists of packet summaries, including packet size, SRC and DST
IP addresses, and port numbers. For TCP packets, we also save TCP ﬂags, SEQ,
and ACK numbers. The second stream consists of full-sized packets of DNS traﬃc
(UDP port 53). We then process our packet summaries to obtain ﬂow-level sta-
tistics. Namely, we aggregate the packet summaries into the 5 tuple and expire
inactive ﬂows after 3600s. For TCP ﬂows we also compute the time diﬀerence
between the SYN packet and the SYN ACK packet to estimate TCP handshake
times.2 Given the location of our monitor within the aggregation network, these
“handshakes” only capture the wide-area delays (backbone RTTs) and do not
include delays introduced by the access- and home network (see [33] for details
on the technique). Finally, we remark that the dataset was collected, processed,
and analyzed at an isolated and secured segment infrastructure of the ISP. The
toolset operates in an automated fashion and anonymizes line ids and addresses
before writing the annotated ﬂows to the disk. Table 1 summarizes the dataset
collected for this study.
DNS transactions. We processed 141.9M DNS transactions, where we denote
a transaction as an A or a AAAA request with a valid response. 69.6% of these
entries are of type A and 30.4% of type AAAA. Out of these DNS transactions,
0.6% and 36.0% of the A and -respectively- AAAA requests could not be resolved
(empty response). The high ratio of unresolved AAAA requests is the result of
content that is indeed requested for IPv6, but still not accessible over IPv6
(see Sect. 2). 39% of the A requests were sent over IPv6, and 28% of the AAAA
requests over IPv4.
Flow-level statistics. Table 1 shows a breakdown of the contribution of
TCP and UDP traﬃc, dissected by IP version. Unsurprisingly, TCPv4 dom-
inates in terms of traﬃc volume. However, the share of IPv6 is substantial
(11.9%) especially when compared to older measurement studies at other van-
tage points [19,46]. Web traﬃc sums up to 86.6% of the trace volume (13.5%
2 We exclude ﬂows with retransmissions of packets with the SYN ﬂag set.
Understanding the Share of IPv6 Traﬃc in a Dual-Stack ISP
9
over IPv6).3 We ﬁnd that QUIC contributes 2.8% of the overall trace volume
(39.5% over IPv6). Considering the relative UDP contributions over IPv4 and
IPv6, we see that the share of UDPv6 ﬂows is well above the UDPv4 share. A
closer look reveals that this bias is introduced by DNS traﬃc: DNS accounts for
71.0% of all UDP ﬂows and 75.3% of DNS ﬂows are sent over IPv6.
Classiﬁcation coverage. We are able to associate up to 76.1% of the traﬃc
to services using the ﬂow-classiﬁcation approach described in Sect. 3.2. While
our coverage statistics are consistent with the base results reported in [35], we
remark that ours are lower than related methods because our method (i) does
not use a warm-up period to account for already cached DNS RRs, (ii) relies on
each subscriber’s own DNS traﬃc, and (iii) adheres to the TTL values included
in DNS responses.
5 A Dual-Stack ISP Perspective on IPv6 Traﬃc
5.1 The Subscribers’ Side
We ﬁnd three classes of DSLs among the 12.9 K subscriber lines of this van-
tage point: (i) IPv4-only: lines that do not get IPv6 connectivity from the ISP
(17.3%), (ii) IPv6-inactive: lines provisioned with IPv6 connectivity but no IPv6
traﬃc (29.9%), and (iii) IPv6-active: lines with IPv6 connectivity as well as IPv6
traﬃc (52.9%).
IPv4-only subscribers. This set of lines corresponds to subscribers for which
the ISP has still not activated IPv6 connectivity (e.g., old contracts). They con-
tribute 12.0% to the overall trace volume. 26.6% of their traﬃc is exchanged
with services that are available over IPv6. We notice that some devices issue
AAAA DNS requests, most likely because some CPEs create a link-local IPv6
network. In fact, for 11.6% of the traﬃc related to IPv6 services we observe a
AAAA request. This ﬁrst observation is relevant for IPv6-adoption studies, as it
indicates that in some cases DNS traﬃc may not well reﬂect the actual connectiv-
ity. This shows that many devices are already prepared to use IPv6 connectivity,
waiting for the ISP to take proper action.
IPv6-inactive subscribers. For 36.1% of the DSLs we do not observe any IPv6
traﬃc, even though the ISP assigned IPv6 preﬁxes to the CPEs. One explanation
is that the CPE has not been conﬁgured to enable IPv6 on the home network
(see e.g., [22,24,50]). Thus, the ISP provides IPv6 connectivity, but the end-
devices only have internal IPv4 addresses (e.g., RFC1918), assigned from the
CPE. Consequently, we ﬁnd that only 1.7% of the traﬃc from these subscribers
can be associated with a AAAA request, likely because most devices suppress
AAAA requests in the absence of a link-local IPv6 address. Other, less likely,
explanations are that none of the devices present at premises during the trace
collection support IPv6 (e.g., Windows XP), or the subscribers do not contact
3 TCP traﬃc on ports 80 and 8080 (HTTP), 443 (HTTPS), and UDP traﬃc on port
443 (QUIC).
10
E. Pujol et al.
services available over IPv6. The latter is unlikely, as 24.1% of the traﬃc in this
subscriber class is exchanged with IPv6-ready services.
IPv6-active subscribers. Subscribers in this category actively use the pro-
vided IPv6 connectivity. The share of IPv6 traﬃc for these subscribers is almost
twice as high (21.5%) when compared to the overall trace (11.9%). When only
considering traﬃc exchanged between IPv6-active subscribers and services that
are indeed available over IPv6, the ratio is even higher (69.6%). Yet, that leaves
us with 30% of the traﬃc exchanged between two IPv6-enabled hosts being car-
ried over IPv4. This can be caused either by end-user devices not requesting
content over IPv6 (no AAAA RR) or end-user devices choosing IPv4 over IPv6
because of their happy eyeball implementation. Indeed, when only considering
traﬃc for which the client requested both IPv4 and IPv6 (A and AAAA), the
share of IPv6 in this category raises up to 85.1%. This is an important obser-
vation for service providers and operators, as it implies that enabling IPv6 can
increase the share of IPv6 traﬃc from/in dual-stack networks rapidly.
5.2 The Service Providers’ Side
We next shift our focus from subscribers to services (FQDNs). Similar to the
previous section, we deﬁne three categories. We say that a service is IPv4-only
if it only has a valid non-empty A RR. IPv6-only services are those which only
have a valid non-empty AAAA RR. A service that is IPv6-ready has valid and
non-empty A and AAAA RRs. We report in Table 2 how these three categories
of services contribute to the total traﬃc and intersect them with the three sub-
scriber categories.
IPv4-only services (only A RR). As expected, this set of services dominates
the share of traﬃc (47.9%). However, for 36.2% of this traﬃc we observe a pre-
ceding AAAA request from the subscriber requesting the content, which implies
that this traﬃc has the potential to be served over IPv6 if the corresponding
service providers enable IPv6.
IPv6-only services (only AAAA RR). We ﬁnd around 500 services that appear
to be available only over IPv6, accounting for less than 0.1% of the traﬃc. Manual
inspection reveals that most of them are mere connectivity checkers. Some service
providers add strings to host names, which may appear as an IPv6-only service
(e.g., both host.domain.org and hostv6.domain.org have a AAAA RR, but only the
former has an A RR).
IPv6-ready services (A and AAAA RRs). These services generate a signiﬁcant
amount of traﬃc (27.8%). However, as many subscribers from this dual-stack
network cannot use IPv6, the actual share of IPv6 traﬃc within this class of
services is only 38.6%.
IP Traﬃc: Barriers and Intent for IPv6
5.3
As shown in Table 2, the upper bounds for IPv6 traﬃc share when looking at
services and subscribers independently is roughly 2 and respectively 4 times
Understanding the Share of IPv6 Traﬃc in a Dual-Stack ISP
11
service availability
service availability
Unknown
0
24
IPv4 only
IPv6 ready
Unknown
IPv4 only
IPv6 ready
73
100
0
24
73
100
actual tra c share of IPv6-ready services
 tra c of IPv4-only services by subscriber class
IPv4
IPv6
90
100
IPv4
only
24
29
IPv6 inactive
IPv6 active
49
IPv6-ready tra c carried over IPv4
No
IPv6 inactive
IPv6-active: intent for IPv4-only services
Fallb.
A requested
AAAA requested
76
% of total traffic
90
49
58
% of total traffic
AAAA
85
88
73
73
IPv4
only
73
73
(a) IPv6 barriers. Top: service availability.
Center: IP version that carries IPv6-ready con-
tent. Bottom: Reason why trafﬁc is carried over
IPv4 instead of IPv6.
(b) IPv6 intent. Top: service availability. Cen-
ter: Breakdown of IPv4-only trafﬁc by sub-
scribers’ type. Bottom: trafﬁc from IPv6-active
subscribers to IPv4-only services.
Fig. 2. Barriers and intent for IPv6 traﬃc in a dual-stack ISP.
the actual IPv6 traﬃc share. At the same time, not all traﬃc in the cross-
product of IPv6-active subscribers and IPv6-ready services is carried over IPv6.
We next proceed to study the root causes that lead to this lower-than-possible
IPv6 share. To this end, we use the term IPv6 barriers to reason about traﬃc
to and from IPv6-ready services, which is carried over IPv4 instead of IPv6.
Correspondingly, we use the term IPv6 intent to reason about traﬃc to and
from IPv4-only services, of which some portion could be carried over IPv6, as
requested by the subscribers.
IPv6 barriers. Figure 2(a) illustrates why traﬃc related to IPv6-ready services
is exchanged over IPv4. On the top of the ﬁgure we show a bar summarizing
all traﬃc in the trace according to the service availability. As previously stated,
27.8% of the traﬃc relates to services available over IPv6. Nevertheless, the
majority of it (61.4%) is actually exchanged over IPv4 (see middle bar). In the
bottom bar we illustrate why data is exchanged over IPv4 instead of IPv6. Most
of this traﬃc (70.5%) is carried over IPv4 because the subscribers do not use IPv6
connectivity at all (IPv4-only and IPv6-inactive). We make two observations for
the remainder of this traﬃc (which is generated by IPv6-active subscribers).
The majority of it has no associated AAAA request, which can primarily be
attributed to end-devices that do not support IPv6: they do not issue AAAA
requests. For another 40% of the IPv4 traﬃc from IPv6-active subscribers to
IPv6-ready services we observe a AAAA request. These are likely ﬂows generated
by devices that fall back to IPv4 as a result of the happy-eyeballs algorithm.
IPv6 intent. Figure 2(b) illustrates what fraction of the traﬃc of IPv4-only
services (top bar) could be carried over IPv6. While the bar in the middle depicts
how much of this traﬃc they exchange with each subscriber category, the bottom
bar shows the traﬃc characteristics for the IPv6-active subscribers. In particular,
we observe that end-user devices in the IPv6-active group issue AAAA requests
12
E. Pujol et al.
)
x
(
n
F
1.0
0.8
0.6
0.4
0.2
0.0
DNS (A vs. AAAA)
TCP (IPv4 vs. IPv6)
15
10