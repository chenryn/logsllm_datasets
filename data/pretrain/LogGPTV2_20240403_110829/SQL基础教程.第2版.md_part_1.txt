图灵社区的电子书没有采用专有客
户端，您可以在任意设备上，用自
己喜欢的浏览器和PDF阅读器进行
阅读。
但您购买的电子书仅供您个人使用，
未经授权，不得进行传播。
我们愿意相信读者具有这样的良知
和觉悟，与我们共同保护知识产权。
如果购买者有侵权行为，我们可能
对该用户实施包括但不限于关闭该
帐号等维权措施，并可能追究法律
责任。
图书在版编目（CIP）数据
SQL基础教程 /（ 日）MICK著；孙淼，罗勇译. -- 2
版. -- 北京：人民邮电出版社，2017.6
（图灵程序设计丛书）
ISBN 978-7-115-45502-4
Ⅰ. ①S… Ⅱ. ①M… ②孙… ③罗… Ⅲ. ①关系数据
库系统－教材 Ⅳ. ①TP311.138
中国版本图书馆CIP数据核字（2017）第087921号
SQL 第2版 ゼロからはじめるデータベース操作
(SQL dai2han Zero kara Hajimeru Database Sousa : 4445-0)
Copyright © 2016 by Mick.
Original Japanese edition published by SHOEISHA Co., Ltd.
Simplified Chinese Character translation rights arranged with SHOEISHA Co., Ltd.
through CREEK & RIVER Co., Ltd. and CREEK & RIVER SHANGHAI Co., Ltd.
Simplified Chinese Character translation copyright © 2017 by Posts & Telecom Press.
本书中文简体字版由SHOEISHA Co., Ltd.授权人民邮电出版社独家出版。未经出版者书面许可，
不得以任何方式复制或抄袭本书内容。
版权所有，侵权必究。
内 容 提 要
本书是畅销书《SQL基础教程》的第2版，介绍了关系数据库以及用来操作关系数据库的SQL语
言的使用方法。书中通过丰富的图示、大量示例程序和详实的操作步骤说明，让读者循序渐进地掌握
SQL的基础知识和使用技巧，切实提高编程能力。每章结尾设置有练习题，帮助读者检验对各章内容
的理解程度。另外，本书还将重要知识点总结为“法则”，方便读者随时查阅。第2版除了将示例程序更
新为对应最新的DB的SQL之外，还新增了一章，介绍如何从应用程序执行SQL。
本书适合数据库和SQL语言的初学者阅读，也可作为大中专院校的教材及企业新人培训用书。
◆ 著 ［ 日］ MICK
译 孙 淼 罗 勇
责任编辑 杜晓静
执行编辑 刘香娣
责任印制 彭志环
◆ 人民邮电出版社出版发行 北京市丰台区成寿寺路11号
邮编 100164 电子邮件 PI:EMAIL
网址 http://www.ptpress.com.cn
北京 印刷
◆ 开本：800×1000 1/16
印张：21
字数：455千字 2017年6月第2 版
印数：16 901- 20 900册 2017年6月北京第1次印刷
著作权合同登记号 图字： 01-2016-6685号
定价：79.00元
读者服务热线：(010)51095186转600 印装质量热线：(010)81055316
反盗版热线：(010)81055315
广告经营许可证：京东工商广登字20170147号
前 言
本书面向完全没有编程和系统开发经验的初学者，介绍了关系数据库以及用来操作关
系数据库的SQL语言的使用方法。各个章节结合具体示例进行解说，并在每章的结尾安排
了习题，用来检验读者对该章内容的理解程度。大家可以从第1章开始，亲自验证示例程序，
循序渐进地掌握SQL的基础知识和技巧。另外，本书还将重要知识点总结为法则，方便读
者在学习完本书之后随时查阅。
近年来，和其他系统领域一样，数据库领域也实现了飞速发展，应用范围不断扩大，
不但出现了具有新功能的数据库，而且操作的数据量也大幅增长。
本书将要介绍的关系数据库是时下最流行的数据库，也是理解其他数据库的基础。在
系统领域，通常所讲的数据库指的就是关系数据库，其重要性可见一斑。
估计很多读者今后都会慢慢积累各个领域、各种规模的系统开发经验（或者可能已经
开始从事开发方面的工作了），到那时，所有的系统必定都需要使用数据库。它们使用的数
据库，即便不是关系数据库，也一定是以关系数据库为基础的数据库。从这个意义上看，
如果掌握了关系数据库和SQL，就能成为任何系统开发都需要的数据库专家了。
现在距离本书初版问世已经6年了，在这6年间，数据库发挥了越来越重要的作用。
以前就有专家使用数据库进行统计分析，后来数据库也开始逐渐被应用到大规模数据的处
理上，并引发了商业领域的变革。象征着这一变化的“大数据”“数据科学”等用语，已经
突破了系统的领域，蔓延到了整个社会之中。甚至有观点认为，统计分析将和人工智能并
列成为决定社会未来走向的重要因素。
一方面，数据库的世界中也进行着技术的革新。如今，以KVS为代表的非关系数据库
的使用已经不再稀奇。同时，为了追求更高的大规模数据处理的性能，内存数据库和面向
列数据库的技术也取得了长足的进步，并逐渐投入到实际应用当中。
另一方面，关系数据库依然是当今的主流数据库，这一点没有变。从这个意义上来说，
学习关系数据库和操作关系数据库的语言SQL语句，仍然是探究数据库世界的第一步，这
一点也没有变，但这并不是说关系数据库和SQL语句一直在止步不前。大多数DBMS都
支持窗口函数和GROUPING运算符（详见第8章），高效处理大规模数据的功能也更加
完善。掌握了SQL语句，就可以自由自在地操作数据，构筑高效的系统。
本书与时俱进地进行了版本升级。不但根据具有代表性的DBMS的新版本对SQL语
法的支持情况更新了描述，还新增了第9章，介绍了通过应用程序来使用数据库的方法。
本书旨在把数据库领域的精彩展示给大家，衷心希望本书能为大家的进步提供一些帮助。
MICK
● IV 前言
关于本书
本书是编程学习系列的SQL和关系数据库篇。该系列注重对初学者编程能力的培养，
本书秉承了这一宗旨。本书不仅可以用于自学，也可以作为大学、专科学校和企业新人的培
训用书。书中提供了大量的示例程序和详实的操作步骤说明，大家可以亲自动手解决具体的
问题，切实提高自身的编程能力。
另外，在各章的结尾处还安排了习题来帮助大家复习该章的知识要点，习题的答案和
讲解收录在附录中。
读者对象
● 不了解数据库和SQL知识的人
● 虽然自学了一些SQL知识，但仍希望进行系统学习的人
● 需要使用数据库，但不知道从何入手的人
● 在大学、专科学校和企业的教育部门等从事数据库和SQL教学的人
● 希望了解信息处理考试中SQL部分应试策略的人
学习本书前的预备知识
● 了解Windows的基本操作方法
● 能够使用Windows的资源管理器创建文件夹并复制文件
● 能够使用Windows的记事本（或者其他文本编辑器）创建文本文件
前言 V ●
本书涉及的关系数据库
本书中使用的SQL语句全部都在下列关系数据库管理系统（RDBMS）中进行了验证。
● Oracle Database 12cR1
● SQL Server 2014
● DB2 10.5
● PostgreSQL 9.5.3
● MySQL 5.7
在这5种RDBMS之间存在差异的SQL语句，或者只能在某种特定的RDBMS中使用
的SQL语句，本书都用下列图标进行标识，来提示执行SQL语句所使用的RDBMS。
Oracle SQL Server DB2 PostgreSQL MySQL
反之，在所有RDBMS中都能正常执行的SQL语句则不用图标标识。
本书的学习安排
首先，在第1章前半部分学习关系数据库和SQL的基础知识，然后结合具体的SQL示
例程序进行循序渐进的学习。
在SQL的学习中，最重要的就是以下两点：
● 亲自编写SQL语句
● 通过执行SQL语句来学习和理解数据库操作
要提高学习效率，需尽量亲自执行并验证本书中的示例程序，逐步深入学习。
为了便于初学者操作，本书使用PostgreSQL作为SQL语句的学习环境。在开始学习之
前，读者需要先在自己的电脑上安装PostgreSQL，准备好SQL语句的执行环境。关于
● VI 前言
PostgreSQL的安装方法、SQL语句的执行方法等详细内容，我们会在第0章介绍。
如果你已经安装了上述“本书涉及的关系数据库”中的数据库，也可以直接使用。
另外，如无特殊说明，本书中出现的SQL语句的执行结果，都是在PostgreSQL 9.5中
执行的结果。
关于程序下载
本书中的示例程序都可以从下面的网站下载。
http://www.ituring.com.cn/book/1880
示例程序为压缩的Zip文件形式，解压后的文件结构如下所示。
ReadMe.txt ………………注意事项
Sample ……………………第1章到第9章的示例程序
Answer ……………………习题答案（ 示例程序）
ReadMe.txt文件
介绍了示例程序的内容和注意事项，使用前请务必阅读该文件。
Sample文件夹
本书中所使用的示例程序分别保存在以章节为单位的文件夹中。在Sample\
CreateTable文件夹中，按照RDBMS的不同，分别保存了用来创建示例用表的SQL
语句。
前言 VII ●
Sample
Ch01 …………………… 第1章的示例程序
1_4………………… 1-4节的示例程序
1_5………………… 1-5节的示例程序
…
…
Ch09 …………………… 第9章的示例程序
9_2………………… 9-2节的示例程序
9_3………………… 9-3节的示例程序
CreateTable …………… 创建示例用表的SQL语句
DB2
MySQL
Oracle
PostgreSQL
SQLServer
Answer文件夹
各章末习题的答案（示例程序），分别保存在以章为单位的目录中。
关于示例程序
示例程序的文件名与书中的代码清单编号相对应。例如，1-5节的代码清单1-3的示例
程序，保存的位置和文件名如下所示。
Sample
Ch01
1_5
List1_3.sql
另外，像如下代码清单这样，在不同的RDBMS中存在差异的SQL语句，会在其文件
名的末尾加上RDBMS的名称。
代码清单1-4 添加一列可以存储100位可变长度字符串的 列
product_name_pinyin
DB2 PostgreSQL MySQL
ALTER TABLE Product ADD COLUMN product_name_pinyin VARCHAR(100);
● VIII 前言
Oracle
ALTER TABLE Product ADD (product_name_pinyin VARCHAR(100));
SQL Server
ALTER TABLE Product ADD product_name_pinyin VARCHAR(100);
这种情况下，示例程序的文件名如下所示。
● List1_4_DB2_PostgreSQL_MySQL.sql
● List1_4_Oracle.sql
● List1_4_SQL Server.sql
创建示例用表的SQL语句
用于创建示例用表的SQL文件保存在Sample\CreateTable文件夹中，文件名为
“CreateTable表名.sql”。例如，PostgreSQL用到的表Product保存在下述目录中。
Sample
CreateTable
PostgreSQL
CreateTableProduct.sql
保存在Sample文件夹中的示例程序文件，可以使用Windows的记事本（或者其他
文本编辑器）打开。
声明 翔泳社
本书中的示例程序已经经过编辑部确认，在正常使用时不会出现任何问题。对于执行
程序所造成的任何损失，本书作者、软件开发人员和翔泳社概不承担相关责任。
Sample文件夹中所收录的文件的著作权归本书作者所有。读者可以出于个人目的，
根据需要自行使用和修改其中的程序。
对于个别环境相关的问题，以及在超出本书内容范围的环境中进行设置时的问题，本社
概不负责解答。
目 录
第0章 绪论——搭建SQL的学习环境 1
0-1 PostgreSQL的安装和连接设置 3
安装步骤 3
修改设置文件 7
0-2 通过PostgreSQL执行SQL语句 9
连接PostgreSQL（登录） 9
执行SQL语句 10
创建学习用的数据库 11
连接学习用的数据库（登录） 12
第1章 数据库和SQL 13
1-1 数据库是什么 15
我们身边的数据库 15
为什么DBMS那么重要 16
DBMS的种类 18
1-2 数据库的结构 20
RDBMS的常见系统结构 20
表的结构 22
1-3 SQL概要 25
标准SQL 25
SQL语句及其种类 26
SQL的基本书写规则 27
1-4 表的创建 30
表的内容的创建 30
数据库的创建（CREATE DATABASE语句） 31
● X 目录
表的创建（CREATE TABLE语句） 31
命名规则 33
数据类型的指定 34
约束的设置 35
1-5 表的删除和更新 37
表的删除（DROP TABLE语句） 37
表定义的更新（ALTER TABLE语句） 38
向Product表中插入数据 39
练习题 42
第２章 查询基础 43
2-1 SELECT语句基础 45
列的查询 45
查询出表中所有的列 47
为列设定别名 48
常数的查询 50
从结果中删除重复行 50
根据WHERE语句来选择记录 53
注释的书写方法 55
2-2 算术运算符和比较运算符 57
算术运算符 57
需要注意NULL 58
比较运算符 60
对字符串使用不等号时的注意事项 62
不能对NULL使用比较运算符 65
2-3 逻辑运算符 68
NOT运算符 68