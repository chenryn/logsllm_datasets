    "test","enable","already enabled","already disabled","end","[%d]",
    "actions","urlExp","js","start","turnOffWifi","userAgent"]
**七、控制命令**
Ewind的控制命令包含我们前面提到过的一些功能，也包含我们尚未观察到的一些功能，如下所示：
showFullscreen – 展示广告
showDialog – 弹出一个对话框，点击后会展示广告
showNotification – 在通知栏展示一个通知
createShortcut – 下载一个APK并创建快捷方式
openUrl – 使用webview打开URL
changeTimerInterval – 修改保活间隔
sleep – sleep一段时间
getInstalledApps – 获取已安装应用列表
changeMonitoringApps – 定义目标应用程序
wifiToMobile – 启用或断开连接，虽然看起来啥事都没干
openUrlInBackground – 后台打开一个URL
webClick – 在某个web页面的webview中执行指定的javascript脚本
receiveSms – 启用或禁用短信监控功能
smsFilters – 定义电话号码和短信文本的匹配规则
adminActivate – 显示激活设备管理器的界面
adminDeactivate – 停用设备管理器
**八、其他样本**
我们经过进一步研究，发现其他一千多个Ewind样本同样与相同的C2服务器“mobincome[.]org”进行通信，但所使用的APK服务名为“com.maxapp”。其他使用“com.maxapp”服务的样本所用的C2服务器有所不同，但这些样本应该都属于相同作者开发的不同恶意软件族群。
**九、基础设施及追踪溯源**
最开始我们认为木马作者以及承载木马应用的Android应用网站之间没有任何联系，因为攻击者通常会将木马应用上传到分享破解应用的网站上，然而对于本文分析的样本而言，这两者看上去有比较紧密的联系。
我们分析的样本下载自“88.99.112[.]169”，该样本与C2服务器“mobincome[.]org”通信。我们注意到该服务器的地址为“88.99.71[.]89”，属于同一个B类网。一个B类网范围相当大，因此这种联系相对较弱，但还是引起了我们的注意。
我们随后注意到“mobincome[.]org”的WHOIS记录目前处于隐私保护状态，然而该域名历史上曾被伏尔加格勒的“Maksim
Mikhailovskii”所拥有，我们发现攻击者在某些APK样本的服务名使用过“Max”字符串。
“Mobincome[.]org”网页中的某个资源链接（img
src）指向了“apkis[.]net”域名。“Apkis[.]net”域名的所有者同样为“Maksim
Mikhailovskii”。“Apkis[.]net”地址为“88.99.112[.]168”，这与样本的下载地址相邻。我们还在“88.99.112[.]168”上找到了Ewind样本的下载链接。这表明C2服务器“mobincome[.]org”、下载地址“88.99.112[.]169”以及攻击者三者之间存在紧密的联系。
“88.99.112[.]169”地址托管了几个网站，全部都是Android应用商店网站：
    mob-corp[.]com
    appdecor[.]org
    playlook[.]ru
    android-corp[.]ru
    androiddecor[.]ru
这些域名的WHOIS记录都已经被隐去，但基于上述联系以及后续的基础设施分析工作（如图8所示），我们确定该木马应用背后的攻击者控制了这些应用商店。另一个应用商店“apptoup[.]com”与“88.99.99[.]25”属于同一个B类网，之前的WHOIS记录显示其持有者也为“Maksim
Mikhailovskii”，但该域名最近也更换为匿名的WHOIS记录。
图8. 基础设施分析
我们对图8中的下载地址和C2服务器做了高亮处理，同时也重点标出了域名持有者“Maksim”与其他Android应用商店域名之间的联系。
攻击者目前主要使用的C2服务器地址是“mobincome[.]org”，我们还观察到少数样本使用“androwr[.]ru”作为C2服务器（地址为88.99.99[.]25，与“apptoup[.]com”地址相同）。在[
**AutoFocus**](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/autofocus)中搜索后，我们发现上千个Android恶意软件和木马连接到这些域名。
通过基础设施、APK签名密钥哈希值以及APK服务名分析，我们可以将几年前的非Ewind样本与该攻击者关联起来。这些样本都是通过广告谋利的Android应用。
WHOIS电子邮箱地址指向了其他几个域名，如下所示：
    Appwarm[.]com
    mobcoin[.]org
    android-corp[.]su
    z-android[.]com
    apkis[.]net
对这些域名的IP进行调查后，我们找到了更多域名使用相同的基础设施，如下所示：
    appdisk[.]ru
    vipsmart[.]org
    vipandroid[.]ru
    vipandroid[.]org
    1lom[.]com
    mobcompany[.]com
    greenrobot-apps[.]net
    9apps.ru[.]com
    ontabs[.]com
    ontabfile[.]com
    andromobi[.]ru
    bammob[.]com
    apkforward[.]ru
    mobrudiment[.]ru
    mob0esd[.]ru
    mob1leprof[.]ru
    mob4ad[.]ru
    mob2ads[.]ru
    mob1lihelp[.]ru
    mob1help[.]ru
这些域名并没有广泛共享IP地址，这表明控制这些域名的某个攻击者会根据特定用途使用某些域名，而不是单纯将这些域名指向相同IP。
**十、总结**
Ewind不仅仅是一个简单的广告软件，它至少是一个真正的木马，可以篡改合法的Android应用。Ewind可以将短信内容转发给C2服务器，表明它的目的不仅仅是展示广告。真正值得注意的是，尽管我们现在观察到这些木马仅仅用来向被害者推送广告，但就如我们文章中所分析的，Ewind背后的攻击者可以通过访问设备管理器，在用户设备上执行任意文件，从而完全控制受害者设备。
恶意软件背后的黑手是俄罗斯人并不奇怪，奇怪的是这个样本明显针对的是俄罗斯人，这是有些不同寻常的。
我们发现Ewind的开发者不仅可以通过开发恶意软件谋取利益，也会经营Android应用商店网站，经过几年的经营，提供了成千上万次Android下载，以支持其广告谋利行为。
**十一、攻击指示器**
Ewind的C2服务器域名：
    mobincome[.]org
    androwr[.]ru
APK服务特征字符串：
    b93478b8cdba429894e2a63b70766f91