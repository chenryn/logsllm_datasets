# 运维大数据平台日志数据治理标准及管理制度 {#运维大数据平台日志数据治理标准及管理制度 .list-paragraph}
## 数据治理背景概述
运维数据特别是信息系统在运行过程中产生的日志，无论从系统运行展示、故障诊断、业务分析、安全审计、监管要求等都有很重要的意义，结合目前城商行数据现状，我们对日志的种类、系统等级、生命周期及接入日志的数据质量进行规范化治理，制定相应的数据治理标准，提升数据质量，更好地服务于运维工作。**日志数据治理**的最终目标是提升数据的价值，是城商行实现数字战略的基础之一，它是一个管理体系，包括组织、制度、流程、工具。
## 数据治理需求
结合城商行大数据平台数据实际，从数据源类别角度包括:(1)
基础设施日志(环境范畴)数据源治理，即包含了主机、网络/安全设备、存储及中间件等基础平台的日志数据；(2)
应用日志数据(业务范畴)数据治理，即包含各业务系统应用日志数据及多业务系统全局跟踪日志数据治理需求。结合数据治理本身定义范畴，**元数据管理**(包含日志数据接入配置、字典配置等)、**数据标准管理**(包含日志类型配置、字段提取规则配置等)、**数据质量管理**(包含日志输出信息规范及管理治理等)、**数据集成管理**(包含日志多维度、多视角分析及运用等)组成了数据治理的基础功能，通过这些功能模块得到的数据才能更好得进行管理和应用。
通过对基础设施日志和应用日志的梳理、分析及治理优化，提升运维数字化能力，同时作为运维大数据有力的支撑平台，不断优化、完善数据治理标准，以达到数据规范治理实施落地、迭代与创新。
## 数据治理目标
根据城商行大数据平台数据治理需求，数据治理最终目标即要实现：(1)数据完整性，即包含数据采集完整性，数据加工完整性，存储完整性；(2)数据一致性，即从数据源接入到数据加工、数据聚合/展示整个数据流程一致性；(3)数据关联性，即实现数据多维度的关联性分析；(4)数据易用性，即通过大数据治理后的高质量数据便于运维内部及对外提供支持。
## 数据现状分析
通过对现有城商行大数据日志平台的巡查，从数据接入、数据预处理、数据加工、数据应用等方面整理如下问题：
  -----------------------------------------------------------------------------------------------------------
  **数据阶段**   **类别**      **现状分析**
  -------------- ------------- ------------------------------------------------------------------------------
  数据接入       名称类        主机名命名规则不完全规范
                               接入文件名存在接入路径不统一、文件名称在大小写、分隔符、全拼与简写风格不一致
                               接入配置的标签appname、tag风格不统一
                 内容类        技术数据输出格式类型较多，不统一集中
                               业务数据输出格式类型较多，不统一集中
                 管理类        存在过期与已停止Agent
                               数据接入正式配置和临时测试配置命名不规范
  数据预处理     名称类        解析规则运行关闭状态无明晰原因备注
                 管理类        解析规则运行但无运行统计结果是否为变更(业务调整或下线)所致
                               字段提取正式配置和临时测试配置命名不规范
  数据加工       定时任务      定时任务加工新增字段命名不规范
                 监控告警      告警正式配置和临时测试配置命名风格不统一
                               告警的准确性及告警风暴
                 报表          暂无
  数据应用       仪表盘展示    部分仪表盘数据未正常展示图表
                               部分图表加载展示时间略长
                               数据图表命名风格不统一
                               数据展示小数位未有效保留或不统一
                 交易链路      部分链路未能正常展示出
                               链路节点加工方式待优化升级
                               交易链路正式配置和临时测试配置命名风格不统一
                 事件管理      历史垃圾事件堆积过多未处理
                               展示出需优化
  -----------------------------------------------------------------------------------------------------------
综上，目前城商行大数据日志平台实现了数据集中管理，但在配置、命名及加工处理等方面未一致，方案复用灵活度不够，降低了平台的易用性，增加了用户使用成本。同时，城商行日志数据资产丰富，但业务和技术关联分析场景较少，数据价值未有效挖掘利用。
## 数据治理规范
本节主要针对运维数据必须接入，可选择接入，禁止接入进行规定，目的是为了在首先满足监管要求的同时不遗漏数据，也不至于接入大量的无价值数据被动提升平台的建设、维护、使用成本。另外对数据的接入方式、命名规范要求进行介绍，明确数据的生命周期管理，避免占用过多的系统资源。
### 数据接入范围要求
  --------------------------------------------------------------------------------
  **序号**   **数据分类**                                   **是否接入**
  ---------- ---------------------------------------------- ----------------------
  1          网络、安全设备日志                             是
  2          操作系统运行日志主要为messages                 是
  3          中间件运行日志（was、tomcat、cics、httpd等）   是
  4          数据库运行日志（db2、mysql、oracle等）         是
  5          应用日志\--一类系统                            是
  6          应用日志\--二类系统                            选择接入
  7          应用日志\--三类系统                            可不接入
  8          应用日志\--行方系统                            否
  9          业务日志\--一类系统                            是
  10         业务日志\--二/三类系统                         选择接入
  11         业务日志\--行方系统                            否
  12         全局跟踪日志                                   是
  13         性能数据\--联盟                                是
  14         性能数据\--行方系统                            否
  15         运维过程数据（4a、itsm、集中监控等）           是
  16         加工计算后数据                                 是
  --------------------------------------------------------------------------------
### 数据接入方式
  --------------------------------------------------------------------------------------------
  **序号**   **接入类型**   **备注**
  ---------- -------------- ------------------------------------------------------------------
  1          syslog         标准网络协议，一般网络、安全、操作系统日志接入
  2          snmp trap      存储、虚拟化等
  3          files          实时跟踪文件内容变化并进行读取，一般中间件、应用、业务等日志采集
  4          jdbc           关系性数据库获取
  5          kafka          消息队列，一般进行数据密集型接入，要求对端有kafka集群
  6          scripts        主要进行性能数据获取
  7          beat           开源组件，一般进行网络包抓取
  --------------------------------------------------------------------------------------------
### 数据类型
  ------------------------------------------------------------------------------------
  **序号**   **数据分类**                                   **备注**
  ---------- ---------------------------------------------- --------------------------
  1          网络、安全设备日志                             
  2          操作系统运行日志主要为messages                 
  3          中间件运行日志（was、tomcat、cics、httpd等）   
  4          数据库运行日志（db2、mysql、oracle等）         
  5          应用日志                                       
  6          业务日志                                       如：核心柜员日志
  7          全局跟踪日志                                   
  8          性能数据                                       
  9          运维过程数据（4a、itsm、集中监控等）           
  10         运维数据数字化后数据                           如：交易量、耗时基线数据
  ------------------------------------------------------------------------------------
### appname/tag命名规则
#### 服务器类型
  --------------------------------------------------------------------------
  **系统小类**    **日志类型**   **appanme**       **tag**
  --------------- -------------- ----------------- -------------------------
  Linux服务器     原始日志       linux             syslog
                  性能日志       top_info          linux_top_info
  Windows服务器   应用事件       windows           application
                  系统事件       windows           system
                  安全事件       windows           secure
                  性能日志       top_info          windows_top_info
  Aix服务器       原始日志       Aix               syslog
                  性能日志       Aix               nmon
  --------------------------------------------------------------------------
#### 网络设备&安全设备
  -------------------------------------------------------------------------
  **系统小类**   **日志类型**   **appname**       **tag**
  -------------- -------------- ----------------- -------------------------
  网络设备       原始日志       net_设备类型      厂商名
  安全设备       原始日志       sec_设备类型      厂商名
  存储/SAN设备   原始日志       stg_设备类型      厂商名
  -------------------------------------------------------------------------
示例：
思科交换机appname:net_switch，tag:cisco
深信服WAF appname:sec_waf，tag:sangfor
若对具体资源下的服务监控(例如:设备端口探活)，按照如下标准命名:
  --------------------------------------------------------------------------------
  **系统小类**    **resid规则**                **resid示例**
  --------------- ---------------------------- -----------------------------------
  网络设备        \\_\\_\   SWITCH_192.168.1.1_23
  安全设备        \\_\\_\   FIREWALL_192.168.1.1_23
  存储/SAN设备    \\_\\_\   STG_192.168.1.1_162
  --------------------------------------------------------------------------------
注：网络及安全设备端口号为固定的。
#### 中间件
  ----------------------------------------------------------------------------
  **系统小类**    **日志类型**   **appname**          **tag**
  --------------- -------------- -------------------- ------------------------
  tomcat          catalina日志   tomcat\_\     catalina
                  access日志     tomcat\_\     access
                  jmx性能日志    tomcat               jmx
  weblogic        原始日志       weblogic\_\   access
                                 weblogic\_\   日志文件名_后缀
                  jmx性能日志    weblogic             Jmx
  nginx           原始日志       nginx\_\      Access
                  state数据      nginx\_\      State
  websphereMQ     原始日志       ibmmq\_\      Error
  rabbitMQ        原始日志       rabbitmq\_\   Sasl
                                 rabbitmq\_\   Log
  oracle          指标数据       Ogg                  Ogg
  GoldenGate                                          
  ----------------------------------------------------------------------------
注：端口为服务实际运行使用的端口号。