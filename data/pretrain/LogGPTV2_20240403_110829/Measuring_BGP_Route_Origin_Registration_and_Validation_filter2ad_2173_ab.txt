189,833,472
10.05 %
119,534,080
872,194,816
3,712,841,976
2.35 %
0.08 %
4.79 %
Fig. 1. Accepted (valid) ROA ﬁles below the six trust anchors. The discontinuous
increases in number of ROAs observed for RIPE NCC occur during key rollovers.
LACNIC and APNIC face a loss of valid ROAs for roughly seven months, likely due to
an expiration of their X.509 certiﬁcate. There is a hole in our data, for all trust anchors
between July and August 2013.
RIPE NCC is currently the leader in terms of both absolute and relative amount
of allocated address space covered by ROAs, and LACNIC is quite active.
In Fig. 1 we can see, for each RIR, the number of ROAs authenticated by
rcynic between March 2012 and September 2014. There is a one-month hole
between July and August 2013 due to a problem in our data collection. We only
started collecting ARIN’s data in August 2014, due to ARIN’s legal barriers
placed on RPKI use. We see LACNIC data being interrupted from the end
of December 2012 to mid August 2013; we believe the reason for this is X.509
expiration of their trust anchor. That this went undetected is operationally quite
disturbing. Also the APNIC repository had a similar event for seven months
between January and August 2013. Between November 2012 and February 2013
Measuring BGP Route Origin Registration and Validation
33
we can see the eﬀects of key roll-over on the RIPE data. We started to collect
CA0 data on August 2013. We observe regular drops in the number of ROAs
for CA0 because this data is hosted on a machine that is regularly disconnected
from the Internet for extended periods of time giving time for objects to expire
without being renewed on time.
3.2 Validity Status of Preﬁx Announcements Over Time
For this analysis we use a BGP RIB dump taken every 30 days on the LINX
monitor of Route-Views. In a RIB dump we usually ﬁnd several announcements
for the same preﬁx received from diﬀerent BGP peers. For origin-validation pur-
poses, each announcement is identiﬁed by: its time-stamp, the preﬁx announced,
and the origin AS (the right-most AS on the AS PATH). Note that in the case
of a RIB dump ﬁle, the time-stamp is always equal to the global time-stamp of
the RIB dump. We validate each announcement as described in Sect. 2.1. In a
given RIB dump, we might have several announcements with diﬀerent origin AS
for the same preﬁx. Consequently, we classify every preﬁx in one of the following
groups:
– Valid only: All announcements observed for this preﬁx are valid.
– Invalid only: All announcements observed this preﬁx are invalid.
Fig. 2. Validity status of routes seen by route-views LINX monitor between June 2012
and September 2014. The ﬁrst (green, pink and yellow) bar shows the status of preﬁxes
independently from the existence of covering preﬁxes. The second bar (blue, red and
grey) illustrates the reachability of a preﬁx considering that an invalid preﬁx might be
covered by another valid or “ROA not found” preﬁx (Color ﬁgure online).
34
D. Iamartino et al.
Table 2. A few data points to compare valid and invalid preﬁxes to the reachability
of these preﬁxes should the LINX monitor drop invalid preﬁxes. Most invalid preﬁxes
are still reachable because of the existence of a covering preﬁx that is either marked as
“valid” or “ROA not found”.
Date
Total
Valid
Invalid Valid and Percentage of Reachable Unreachable Percentage of
preﬁxes preﬁxes preﬁxes invalid
RPKI-covered preﬁxes
preﬁxes
invalid covered
seen
preﬁxes
preﬁxes
2012/06/01 432,516
7,253
1,621
2012/11/28 454,601
9,258
2,123
2012/12/28 458,955
5,097
1,368
2013/09/24 504,733 17,567
3,400
2014/05/22 525,241 23,531
2,693
2014/07/21 534,519 24,511
2,916
2014/08/20 538,926 25,973
3,168
0
13
16
8
31
18
17
2.05 %
2.50 %
1.41 %
4.15 %
4.99 %
5.13 %
5.41 %
8,648
11,149
6,276
20,537
25,731
26,904
28,565
226
245
205
438
525
541
593
86.05 %
88.45 %
85.01 %
87.11 %
80.50 %
81.44 %
81.28 %
– Valid and invalid: We found both valid and invalid announcements for the
preﬁx. That is, some announcements have a diﬀerent origin ASs.
– ROA not found: There is no ROA covering this preﬁx.
As seen in Sect. 3.1, only 4.79 % of IP addresses are covered by ROAs. This
means that a lot of preﬁx advertisements will fall in the “ROA not found”
category. For readability, we do not show this case in the following ﬁgures. When
we look at the validity of the advertisements using the above taxonomy (left-
side bars of Fig. 2) we can ﬁrst see a very signiﬁcant decrease of preﬁxes being
validated between December 2012 and August 2013. This is due to the problem
in the LACNIC repository mentioned in Sect. 3.1. Almost all ROA ﬁles of the
LACNIC repository disappeared. Thus, all the preﬁxes which were previously
covered by these ROAs are labelled “ROA not found”.
To validate the last RIB dump (August 2014), we added ARIN ROAs. This
is not the case for the other months, as we had not captured those data (see
Sect. 3.1). For this reason, some preﬁxes which were “ROA not found” become
covered by an ARIN ROA, leading to a slight increase of the total coverage of
preﬁxes to a ﬁnal value of 5.41 % on August 2014 (see last line, 6th column of
Table 2).
Preﬁxes tagged both “valid and invalid” are very rare. In some dumps they
are not present at all. We observed a peak of 31 on 2014/05/22. We believe that
these could be due to either an anycast preﬁx with ROAs missing for some of
the potential origin AS, a misconﬁguration (some origins are private AS numbers
that in theory should not be leaked to the route-views monitor), or an attack.
We saw that, for several of these, the failing AS and the valid AS have very
similar AS names, hinting that these are likely not attacks.
Table 2 shows some of the data points of Fig. 2. Column 3–5 correspond to the
elements of the ﬁrst bar for some times on the x-axis in the ﬁgure. We can further
deduce the amount of’ROA not found’ preﬁxes by looking at column 6. In June
2012, 97.95 % of the preﬁxes were not covered by any ROAs. This decreases to
94.59 % in August 2014.
Measuring BGP Route Origin Registration and Validation
35
Table 3. Reachable and unreachable preﬁxes from diﬀerent route-views monitors on
20 August 2014
Monitor
All preﬁxes RPKI-covered
RPKI-covered un- Percentage of Percentage of
name
seen
reachable preﬁxes
reachable preﬁxes unreachable
RPKI-covered
ISC
LINX
540,197
538,926
Sao Paulo 547,554
Sydney
538,378
WIDE
528,883
seen
27,587
28,565
28,521
28,741
27,457
seen
591
593
580
596
588
2.14 %
2.07 %
2.03 %
2.07 %
2.14 %
preﬁxes
5.21 %
5.41 %
5.31 %
5.44 %
5.30 %
3.3 Taking Coverage into Account
It is often assumed that operators who validate advertisements will drop invalids.
In order to better understand the eﬀect of that policy on reachability, we cannot
simply look at preﬁxes separately. We need to consider the coverage of invalids
by other preﬁxes. Let’s assume that a BGP border router receives the same
routes as our LINX monitor. It drops all “invalid only” preﬁxes. In addition, in
the deployment phase, we expect operators to also accept announcements for
preﬁxes with no ROA. If a preﬁx is “valid” or “valid and invalid”, we consider
it as reachable, because it means that at least one valid announcement for that
preﬁx was present. When a preﬁx is marked “invalid only”, there are some cases
when it could be reached:
– The invalid preﬁx is up-covered by another valid preﬁx (Example:
announcement of 10.1.2.0/24 is invalid, but 10.1.0.0/16 is also announced and