 200
 100
)
c
e
s
(
e
g
a
r
e
v
o
c
%
0
5
r
o
f
e
m
i
t
n
o
i
t
a
g
a
p
o
r
P
)
c
e
s
(
e
g
a
r
e
v
o
c
%
5
9
r
o
f
e
m
i
t
n
o
i
t
a
g
a
p
o
r
P
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
150m x 150m, 1m/s
150m x 150m, 3m/s
75m x 75m, 1m/s
75m x 75m, 3m/s
 0.25
 0.5
 0.75
 1
Fraction of susceptible devices
(1) 50% infection coverage
 2200
 2000
 1800
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
150m x 150m, 1m/s
150m x 150m, 3m/s
75m x 75m, 1m/s
75m x 75m, 3m/s
 0.25
 0.5
 0.75
 1
Fraction of susceptible devices
)
c
e
s
(
e
g
a
r
e
v
o
c
%
0
5
r
o
f
e
m
i
t
n
o
i
t
a
g
a
p
o
r
P
)
c
e
s
(
e
g
a
r
e
v
o
c
%
5
9
r
o
f
e
m
i
t
n
o
i
t
a
g
a
p
o
r
P
 600
 500
 400
 300
 200
 100
 0
Speed 1, dense
Speed 3, dense
Speed 1, sparse
Speed 3, sparse
 0
 25
 50
 75
 100  125  150  175  200  225
Number of devices
(1) 50% infection coverage
 900
 800
 700
 600
 500
 400
 300
 200
 100
 0
Speed 1, dense
Speed 3, dense
Speed 1, sparse
Speed 3, sparse
 0
 25
 50
 75
 100  125  150  175  200  225
Number of devices
(2) 95% infection coverage
(2) 95% infection coverage
(2) 95% infection coverage
Figure 2. Propagation times
under different device den-
sities
and mean device
speeds
Figure 3. Propagation times
under different fractions of
susceptible devices (95%
conﬁdence interval)
Figure 4. Propagation times
different
under
network
sizes
(95% conﬁdence
interval)
4.3 Eﬀects of Network Size
5 Dynamics Analysis
The total number of devices in the network considered
is a key parameter. We simulated our worm on several
network sizes with the aim to see how the propagation
speed changes with growing network size, while keeping
the device density constant. We vary device densities in
the network between 0.0356 device/m2 (dense) and 0.0089
device/m2 (sparse). We also vary the mean speed in the
random waypoint model between 1 and 3 meters per sec-
ond. The results, including 95% conﬁdence intervals, are
presented in Figure 4. The ﬁgure shows average propaga-
tion times for 50% and 95% infection coverage as a func-
tion of network size under four scenarios. It seems that in
all cases both times grow linearly with the network size, ex-
cept that the ones corresponding to mean speed 3m/s and
low density grow slightly sub-linearly. We use least squares
linear regression technique to ﬁt the simulation results and
the derived linear curves are also depicted in Figure 4. The
observed linearity allows us to extrapolate worm propaga-
tion times in Bluetooth networks at scales beyond simula-
tion capabilities as of today. Consider a network that has
one million Bluetooth devices in a 108 m2 area. This net-
work has almost the same device density as the aforemen-
tioned sparse scenarios. If we assume that all devices are
vulnerable to worm infection and move according to the
random waypoint model at mean speed 1m/s, then using
the slopes derived from Figure 4, we can infer that it would
take approximately 10 days for the worm to infect half of
the population and 17 days to infect 95% of all the devices.
In the previous section, we have presented how Blue-
tooth worms propagates under varied scenarios.
In this
section, we give a more detailed analysis on the dynam-
ics unique to the Bluetooth worm propagation. We perform
two new sets of experiments, both simulating a network
with 200 Bluetooth devices in a 75m × 75m area. In the
ﬁrst set, devices remain stationary throughout the simula-
tion, and in the second one, devices move according to the
random waypoint mobility model. In each experiment, we
randomly choose a Bluetooth device and let it be infected at
the beginning of the simulation.
5.1 Results for Static Devices
We simulate the static network for 300 seconds. Every
device in the network is susceptible to the worm infection.
We perform 10 sample runs, in each of which devices are
randomly distributed in the area (we throw away those that
do not yield a fully connected network).
Propagation curve.
For ease of explanation, we de-
ﬁne notation Tp% to be the time in seconds needed to infect
p percent of the devices in the network. Figure 5 presents
the cumulative numbers of infected devices as a function of
simulation time in three sample runs. These sample runs are
selected in the following way: We rank the 10 sample runs
based on their T50% and choose the one with the smallest
value, the one with the largest value, and the one with the
median value. We also plot the curve that averages all the
sample runs. From the graph, we observe that there exists
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006i
s
e
c
v
e
d
d
e
t
c
e
f
n
i
f
o
r
e
b
m
u
n
e
v
i
t
l
a
u
m
u
C
 200
 180
 160
 140
 120
 100
 80
 60
 40
 20
 0
 0
min
max
median
average
 50
 100
 150
 200
 250
 300
Simulation time (sec)
e
c
n
e
r
e
f
r
e
n
t
i
l
e
n
n
a
h
c
-
o
c
o
t
e
u
d
e
t
a
r
s
s
o
l
t
e
k
c
a
P
 0.35
 0.3
 0.25
 0.2
 0.15
 0.1
 0.05
 0
 0
 50
 100
 150
 200
 250
 300
 350
 400
Simulation time (second)
s
e
s
n
o
p
s
e
r
y
r
i
u
q
n
i
f
o
r
e
b
m
u
n
.
g
v
A
 7
 6
 5
 4
 3
 2
 1
 0
#inquiry responses (collision enabled)
#inquiry responses (collision disabled)
inquiry duration (collision enabled)
inquiry duration (collision disabled)
 0
 50
 150
 100
 200
Simulation time (sec)
 250
 12
 11
 10
 9
 8
 7
 6
 5
 4
 3
 2
 1
 0
 300
)
c
e
s
(
n
o
i
t
a
r
u
d
y
r
i
u
q
n