Virus Impossible
Virus Impossible
CIH
CIH
ＥＭＡＩＬ：
ＥＭＡＩＬ：IamCIH
IamCIH（ＡＴ）
（ＡＴ）gmail
gmail（ＤＯＴ）
（ＤＯＴ）com
com
GIGA
GIGA--BYTE TECHNOLOGY CO., LTD.
BYTE TECHNOLOGY CO., LTD.
2009/07/18
2009/07/18
PDF created with pdfFactory Pro trial version www.pdffactory.com
这一天
这一天
‘
‘怎会这样？我的电脑被骇客入侵了！什么？萤幕
怎会这样？我的电脑被骇客入侵了！什么？萤幕
出现倒数
出现倒数10
10秒，就要把我电脑整个资料破坏！
秒，就要把我电脑整个资料破坏！’
’
萤幕出现倒数：
萤幕出现倒数：10~9~...1~0
10~9~...1~0秒
秒
最后出现一串字：
最后出现一串字：Just Kidding
Just Kidding
‘
‘本台记者报导：今天下午，在同一瞬间，全世
本台记者报导：今天下午，在同一瞬间，全世
界电脑都出现这个讯息，
界电脑都出现这个讯息，""You've been 
You've been 
hacked
hacked""。幸好，骇客最后没有真正破坏电脑资
。幸好，骇客最后没有真正破坏电脑资
料。但是已经引起全世界极度惶恐，从未有这样
料。但是已经引起全世界极度惶恐，从未有这样
事情发生过。各国政府机关、资安单位全面关切
事情发生过。各国政府机关、资安单位全面关切
中。骇客的下一步是什么？
中。骇客的下一步是什么？’
’
PDF created with pdfFactory Pro trial version www.pdffactory.com
前言
前言
这篇文章的想法，只是一个很初步的简单雏
这篇文章的想法，只是一个很初步的简单雏
形，并没有实际验证过。也或许藏著一些
形，并没有实际验证过。也或许藏著一些
不可能实现的技术，或是错误的想法。就
不可能实现的技术，或是错误的想法。就
以技术讨论的话，一定会有更大的改善空
以技术讨论的话，一定会有更大的改善空
间。里面的论点，都基于
间。里面的论点，都基于理想
理想状态，没有
状态，没有
细节分析所有可能性。若是要完整实现整
细节分析所有可能性。若是要完整实现整
个系统，将是非常复杂的事情。因此，此
个系统，将是非常复杂的事情。因此，此
篇内容，只是提供大家，另一种病毒可能
篇内容，只是提供大家，另一种病毒可能
行为的思考。
行为的思考。
PDF created with pdfFactory Pro trial version www.pdffactory.com
行为模式
行为模式
u
u 病毒
病毒
u
u 蠕虫
蠕虫
u
u 感染行为
感染行为
•• 钻网路漏洞
钻网路漏洞
•• 感染执行档
感染执行档
u
u 僵尸网路
僵尸网路((BotNet
BotNet) 
) 
u
u P2P 
P2P 
u
u 动态执行
动态执行Function 
Function 
PDF created with pdfFactory Pro trial version www.pdffactory.com
基本背景
基本背景
u
u Super Node
Super Node：中毒电脑，具有
：中毒电脑，具有Public IP
Public IP。
。
•• 建立
建立Node
Node彼此间的连线
彼此间的连线((协助穿越
协助穿越NAT)
NAT)。
。
•• 除此之外，就跟一般
除此之外，就跟一般Node
Node完全相同。
完全相同。
u
u Node
Node：所有全部的中毒电脑
：所有全部的中毒电脑((包括
包括Super 
Super 
Node)
Node)。
。
u
u 一般
一般Node
Node：不包括
：不包括Super Node
Super Node的
的Node
Node。
。
u
u 这些
这些Node
Node，彼此会有
，彼此会有2~5
2~5个连线，交集成一个病
个连线，交集成一个病
毒网路系统。
毒网路系统。
PDF created with pdfFactory Pro trial version www.pdffactory.com
PDF created with pdfFactory Pro trial version www.pdffactory.com
病毒的架构
病毒的架构
u
u Function Layer 
Function Layer 
•• 接收
接收Command
Command，若没有这个
，若没有这个Command
Command所需要的
所需要的
Function
Function，就会去病毒网路系统寻找。
，就会去病毒网路系统寻找。
u
u Network Packet Layer 
Network Packet Layer 
•• 接收来自
接收来自Function Layer
Function Layer，所有病毒封包的处理、加
，所有病毒封包的处理、加
密、传递工作。
密、传递工作。
此病毒，一开始是
此病毒，一开始是完全没有任何感染能力
完全没有任何感染能力，也就是
，也就是
没有
没有""感染
感染""的
的Function
Function。
。
u
u 最原始的病毒，只有
最原始的病毒，只有11个
个Function
Function：病毒网路连
：病毒网路连
线
线
PDF created with pdfFactory Pro trial version www.pdffactory.com
病毒运作的过程
病毒运作的过程
PDF created with pdfFactory Pro trial version www.pdffactory.com
PDF created with pdfFactory Pro trial version www.pdffactory.com
PDF created with pdfFactory Pro trial version www.pdffactory.com
PDF created with pdfFactory Pro trial version www.pdffactory.com
PDF created with pdfFactory Pro trial version www.pdffactory.com
PDF created with pdfFactory Pro trial version www.pdffactory.com
中毒档案的内容
中毒档案的内容