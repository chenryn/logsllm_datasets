title:PharmaLeaks: Understanding the Business of Online Pharmaceutical Affiliate
Programs
author:Damon McCoy and
Andreas Pitsillidis and
Grant Jordan and
Nicholas Weaver and
Christian Kreibich and
Brian Krebs and
Geoffrey M. Voelker and
Stefan Savage and
Kirill Levchenko
PharmaLeaks: Understanding the Business of
Online Pharmaceutical Afﬁliate Programs
Damon McCoy(cid:5) Andreas Pitsillidis∗ Grant Jordan∗ Nicholas Weaver∗† Christian Kreibich∗†
Brian Krebs‡ Geoffrey M. Voelker∗ Stefan Savage∗ Kirill Levchenko∗
(cid:5)Department of Computer Science
George Mason University
†International Computer Science Institute
Berkeley, CA
∗Department of Computer Science and Engineering
University of California, San Diego
‡KrebsOnSecurity.com
Abstract
Online sales of counterfeit or unauthorized products
drive a robust underground advertising industry that in-
cludes email spam, “black hat” search engine optimiza-
tion, forum abuse and so on. Virtually everyone has en-
countered enticements to purchase drugs, prescription-
free, from an online “Canadian Pharmacy.” However,
even though such sites are clearly economically moti-
vated, the shape of the underlying business enterprise
is not well understood precisely because it is “under-
ground.” In this paper we exploit a rare opportunity to
view three such organizations—the GlavMed, SpamIt
and RX-Promotion pharmaceutical afﬁliate programs—
from the inside. Using “ground truth” data sets includ-
ing four years of raw transaction logs covering over $170
million in sales, we provide an in-depth empirical anal-
ysis of worldwide consumer demand, the key role of in-
dependent third-party advertisers, and a detailed cost ac-
counting of the overall business model.
Introduction
1
Much like the legitimate Internet economy, advertising
is a major driver for the “underground” criminal econ-
omy as well. For all their variety, spam, search-engine
abuse, forum spam and social spam—as well as the bot-
nets, fast-ﬂux networks and other technical infrastruc-
ture that enable these activities—are all simply low-cost
advertising platforms that monetize latent consumer de-
mand. Consequently, an emerging research agenda has
developed around understanding the economic structure
of these businesses, both to understand the scope and
drivers for the problem [8, 9, 13], as well as to help pri-
oritize interventions [14, 15]. Unfortunately, while clever
inference and estimation techniques can illuminate a few
of the key questions, much remains unclear. This is be-
cause, as a rule, there is little “ground truth” data in the
ﬁeld for either validating such results or to provide ﬁner-
grained analytics that can be obtained via inference.
This paper provides a rare counter-point to this rule.
Under a variety of serendipitous circumstances (largely
1
driven by competition between criminal organizations),
a broad corpus of ground truth data has become avail-
able. In particular, in this paper we analyze the content
and implications of low-level databases and transactional
metadata describing years of activity at the GlavMed,
SpamIt and RX-Promotion pharmaceutical afﬁliate pro-
grams. By examining hundreds of thousands of orders,
comprising a settled revenue totaling over US$170M,
we are able to provide comprehensive documentation on
three key aspects of underground advertising activity:
Customers. We provide detailed analysis on the con-
sumer demand for Internet-advertised counterfeit phar-
maceuticals, covering customer demographics, product
selection (including an examination of drug abuse as a
driver), reorder rates and market saturation.
Advertisers. We quantitatively detail the role of third-
party afﬁliate advertisers (both email/forum spammers
and SEO-based advertisers), the dynamics of their labor
market, their ability to drive revenue and the distribution
of their commission income. This analysis includes the
operators of many of the best-known botnets including
MegaD, Grum, Rustock and Storm, and we document in-
dividual advertisers generating over $10M in sales.
Sponsors. We derive an empirical revenue and cost
model, including both direct costs (sales commissions,
supply, payment processing) and indirect costs (hosting,
domain registration, program advertisements). We also
provide insight and validation about the most signiﬁcant
overheads for the operators of such programs.
This is an unusual research paper. We introduce no
new artifact, we develop no new inference technique,
we deploy no new measurement infrastructure. We do
none of these things because we don’t need to; we
have the actual data sets that we would otherwise try
to measure, infer or estimate. Thus, while there are sig-
niﬁcant methodological challenges that we must over-
come (mainly around the forensic reverse engineering
of database schemas and their semantics), ultimately the
contribution of this paper is in its results. However, we
believe these are both unique and signiﬁcant, with impli-
cations for best addressing this variety of Internet abuse.
2 Background
Abusive Internet advertising has existed virtually as long
as the Internet itself. In addition to well-deﬁned adver-
tising channels such as sponsored search [11, 12], rogue
advertisers make use of a broad range of vectors to at-
tract customer trafﬁc including email spam [1, 6, 14, 17],
search engine manipulation [7, 13, 23], forums and blog
spam [19, 24] as well as online social networks [4, 22].
Due to pressure against these tactics, few legitimate mer-
chants will engage such advertisers and thus rogue adver-
tising and rogue products tend to go hand in hand. For
example, in one recent report on email spam, Syman-
tec estimated that 80% of all such messages shilled for
“prescription-free” pharmaceuticals [21].
However, the structure of this activity has changed sig-
niﬁcantly over the last decade. In particular, market spe-
cialization has largely eliminated the independent “soup-
to-nuts” advertiser who previously handled the entirety
of the sale process [16]. Instead the rise of the afﬁl-
iate program, or “partnerka”, model has separated the
role of the advertiser, paid on commission to attract cus-
tomer trafﬁc, from the sponsor who in turn handles Web
site design, payment processing, customer service and
fulﬁllment [18]. This evolution is not unique to abu-
sive advertising; indeed, large legitimate merchants such
as Amazon also sponsor afﬁliate programs as a means
of advertising. However, it has been deeply internalized
within the underground ecosystem including the pay-per-
install [3], FakeAV [20], pornography [25], pharmaceuti-
cals [2], herbal supplements [14], replica [14] and coun-
terfeit software markets [9], among others.
Counterfeit pharmaceuticals represent a typical ex-
ample. Here a range of sponsoring afﬁliate programs
provide drugstore storefronts, drug fulﬁllment (typically
via drop shipping from India), payment processing, cus-
tomer service and so on. Independent advertisers, or af-
ﬁliates, in turn promote the program (e.g., by using bot-
nets to send spam email or manipulating search engine
results) and are paid a commission on each sale that re-
sults from a click on one of their ads. Commissions range
from 30%–40% of gross revenue, typically paid via a
quasi-anonymous online money transfer service such as
WebMoney or Liberty Reserve.
This business model has two key advantages for the
advertiser: focus and mobility. Without needing to at-
tend to issues such as Web site design, payment pro-
cessing, customer service, fulﬁllment and so on, the ad-
vertiser is free to focus single-mindedly on the task of
attracting customer trafﬁc to these sites. Indeed, this
functional specialization has supported the creation of
ever more sophisticated botnets for email delivery or
“black hat” search engine optimization, and many of the
largest botnets are directly involved in advertising the
programs in this paper (Rustock, MegaD, Grum, Cut-
2
wail, Storm, Waledac and others). The second advantage
of this model, mobility, is that the loosely coupled nature
of their relationship with afﬁliate programs allows an ad-
vertiser to switch programs at will (or even support mul-
tiple programs at once). This low “switching cost” pro-
vides bargaining power for the effective advertiser (in-
deed, we witness high-sales advertisers able to use this
threat to drive higher commissions). More importantly,
it reduces an advertiser’s exposure to business continuity
risk. If a particular afﬁliate program should shut down,
advertisers can still monetize their investments (e.g., in a
botnet) by advertising for a different sponsor.
However, the beneﬁts of this separation are strong for
the sponsoring afﬁliate program as well. By outsourcing
advertising they free themselves from direct exposure to
the criminal risks associated with large-scale advertising
enterprises (e.g., mass compromise of computers and on-
line accounts). Second, because advertisers are paid on a
commission basis, they also outsource “innovation risk”.
Program sponsors need not predict the best way to at-
tract customer trafﬁc at a given point in time. Instead
hundreds of advertisers innovate independently; if many
of them fail, so be it. Since advertisers are only paid com-
missions on successful sales, a sponsor will only end up
paying for effective advertising strategies and need not
distinguish among strategies a priori.
Against this background, online pharmaceutical sales
is one of the oldest and largest afﬁliate program markets.
This market supports tens of afﬁliate programs and, as
we will see, thousands of independent advertisers (afﬁli-
ates) and hundreds of thousands of customers. However,
while the mechanics of this business model are well-
described in recent work [2, 14, 18], the dynamics of
the actors and the underlying constants that deﬁne the
cost structure (and hence the vulnerabilities in the busi-
ness) are not well understood at all. Indeed, even simple
questions such as “How big is sales turnover?” are imper-
fectly understood. For example, Kanich et al. used one
method to estimate that the combined turnover across
seven leading pharmacy programs (constituting two-
thirds of afﬁliate brands advertised in spam) is roughly
86,000 orders per month [9]. However, Leontiadis et al.
use a different technique to arrive at a much larger esti-
mate suggesting over 640,000 orders per month [13].
In this paper, we answer this and many other such
questions precisely by focusing in depth on three phar-
maceutical afﬁliate programs: GlavMed, SpamIt and
RX-Promotion. These organizations have been in busi-
ness for ﬁve years or more. Together, they represent
many tens of storefront “brands” (including the ubiqui-
tous “Canadian Pharmacy”) and, according to the data
from our prior measurement studies, these programs
have been advertised in over a third of all spam email
messages [14].
3 Authenticity and Ethics
Our use of “found data” creates two new concerns that
we address here: authenticity and ethics.
First, it is useful to provide some rough context con-
cerning the circumstances leading to the release of these
data sets. As explained in the previous section, GlavMed
and RX-Promotion are both long-operating pharmaceu-
tical afﬁliate programs based in Russia. However, for a
variety of reasons, enmity developed between owners in
each program, revealed anecdotally through “sniping” on
underground forums, claims of denial-of-service attacks
and ultimately to the hacking of each other’s infrastruc-
ture sites. Perhaps inspired by the “online leak” meme,
popularized recently by Wikileaks and others, elements
of these two organizations (or parties sympathetic to
their positions) gained access to information about each
other’s operations and then made portions of this data
available: sometimes publishing very broadly on under-
ground forums and ﬁle-sharing sites, and other times dis-
tributing to a variety of journalists, e-crime researchers,
law enforcement agencies as well as a broad range of un-
derground actors.
Through these channels we obtained access to three
transactional data sets: the complete dump, covering four
years, of the GlavMed and SpamIt back-end database
(comprising transactions, payments and so on) and
a year of more restricted transactional data for the
RX-Promotion program. We also received two metadata
corpuses: detailed archived chat logs from the program
operator for sites operated by GlavMed and SpamIt, as
well as ﬁnancial data concerning the revenue and cost
structure for the RX-Promotion program. For further
context and back-story about this data, we refer readers
to the “Pharma Wars” series by Brian Krebs [10].
3.1 Authenticity
Given that we did not gather the information ourselves
and the adversarial nature by which the data became
available, an obvious question is how to evaluate its accu-
racy and authenticity: how do we know that our sources
did not fake the data?
While we cannot establish clear provenance beyond
all possible doubt, we observe a range of strong sup-
porting evidence. First, we observe that the data sets are
large and detailed (over 2M sales records, with over 140
linked tables, coupled with several GB of related meta-
data). These attributes do not entirely discount the pos-
sibility that they could be grossly fraudulent, but it sug-
gests that the costs of creating such a forgery would be
signiﬁcant.
Second, we consider questions of internal and cross-
consistency. The transactional data sets have complex
schemas (covering orders, potentially many payment
transactions per order, commissions to advertisers, sub-
sequent payouts, and so on) and we ﬁnd direct concor-
dances between the different elements (e.g., if we sum
the settled sales for a particular afﬁliate it typically re-
lates directly to the size of the payout to that afﬁliate).
We also ﬁnd concordances between the transactional data
and the metadata. For example, we found multiple chat
logs directing a GlavMed/SpamIt employee to make a
payment to a particular afﬁliate that is then matched by
an identical payout record in the associated transactional
database. Similarly, the monthly revenue for shipped
products for RX-Promotion is consistent with the set-
tled revenue from its payment processor in the same pe-
riod. Finally, during the period covered by all three trans-
actional data sets we had placed multiple product or-
ders from each of the associated programs [9, 14]. We
ﬁnd each and every one of our orders in the appropriate
database with the correct data.
While this evidence cannot comprehensively prove the
absence of fraud,1 given the strong concordances and the
absence of any evidence supporting the forgery hypoth-
esis, we believe the greater likelihood is that these data
sets are authentic and accurate. We proceed with this as-
sumption going forward.
3.2 Ethics
The other fundamental issue concerns the ethics of us-
ing data that was, in all likelihood, gathered via illegal
means. Here there are two kinds of questions. The ﬁrst
is a high-level question concerning whether the nature of
how the data was originally gathered should prima facie
proscribe all subsequent uses of it. This question is not
new and it manifests in a range of ﬁelds. For example,
should a political scientist be proscribed from analyzing
the contents of the Pentagon papers (or the more contem-
porary Wikileaks data) in reasoning about U.S. foreign
policy? Similarly, should researchers avoid using widely
publicized stolen password data (e.g., from the Anony-
mous/Lulzsec leaks) when studying the strength of user-
selected passwords? We justify our own choice to take
such steps by reasoning about harm.
We observe that this data is already broadly available
and the knowledge of its existence, its association with
the GlavMed, SpamIt and RX-Promotion organizations,
and some of the over-arching contents (e.g., total rev-
enue, etc.) have already been widely and publicly docu-
mented. Consequently, we cannot create any new harm
simply through association with these entities or repeat-
ing these ﬁndings.
To manage any remaining harms we institute a number
1For example, while we believe comprehensive forgery would have
been cost prohibitive given the size and richness of these data sets, a
forger might have selectively altered only certain records and updated
dependent schemas to be consistent.
3
Period
Program
Jan 2007 – Apr 2010
GlavMed
SpamIt
Jun 2007 – Apr 2010
RX-Promotion Oct 2009 – Dec 2010
Afﬁliates
1,759