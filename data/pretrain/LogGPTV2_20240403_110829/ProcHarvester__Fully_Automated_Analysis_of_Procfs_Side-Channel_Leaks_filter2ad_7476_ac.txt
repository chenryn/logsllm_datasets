www.instagram.com
www.jd.com
www.linkedin.com
www.live.com
www.netflix.com
www.qq.com
www.reddit.com
www.sina.com.cn
www.sohu.com
www.taobao.com
www.tmall.com
www.vk.com
www.wikipedia.org
www.yahoo.com
Average
Precision Recall
88%
100%
100%
100%
100%
100%
88%
88%
88%
88%
88%
88%
100%
75%
88%
88%
100%
100%
100%
100%
93%
78%
100%
100%
100%
100%
100%
88%
88%
100%
100%
100%
78%
100%
100%
78%
88%
89%
89%
100%
100%
94%
01,0002,0003,0004,00001020304050Time[ms]IpExt:InNoECTPktsfacebook.comTimeseries1Timeseries2Timeseries301,0002,0003,0004,000010,00020,00030,000Time[ms]IPExt:InOctetsfacebook.comTimeseries1Timeseries2Timeseries301,0002,0003,0004,00001,0002,0003,0004,0005,000Time[ms]IPExt:OutOctetsfacebook.comTimeseries1Timeseries2Timeseries301,0002,0003,0004,0000102030Time[ms]IpExt:InNoECTPktswikipedia.orgTimeseries1Timeseries2Timeseries301,0002,0003,0004,00005,00010,00015,000Time[ms]IPExt:InOctetswikipedia.orgTimeseries1Timeseries2Timeseries301,0002,0003,0004,00001,0002,0003,0004,000Time[ms]IPExt:OutOctetswikipedia.orgTimeseries1Timeseries2Timeseries3ProcHarvester
ASIA CCS ’18, June 4–8, 2018, Incheon, Republic of Korea
Table 8: Excerpt of identified information leaks for website
fingerprinting on Android 8. Accuracy based on 20 websites.
Table 9: Classification rates for website fingerprinting by
combining the identified information leaks on Android 8.
Accuracy based on 8 samples per website.
procfs file
/proc/net/dev
/proc/net/xt_qtaguid/
iface_stat_all
/proc/net/netstat
/proc/net/sockstat
/proc/net/snmp
/proc/net/dev
/proc/net/dev
/proc/net/protocols
/proc/net/netstat
/proc/net/protocols
/proc/net/snmp
/proc/net/xt_qtaguid/
iface_stat_all
/proc/net/dev
/proc/net/snmp
/proc/net/xt_qtaguid/
iface_stat_all
/proc/net/snmp
/proc/net/netstat
/proc/net/snmp
/proc/meminfo
/proc/net/sockstat
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/net/protocols
/proc/meminfo
Property
eth0: Receive packets
eth0: rx_bytes (column 6)
IpExt: InOctets
TCP: mem
Tcp: InSegs
eth0: Transmit errs
eth0: Receive errs
TCP: memory
IpExt: InNoECTPkts
TCPv6: memory
Ip: InReceives
eth0: tx_bytes (column 8)
eth0: Transmit packets
Tcp: OutSegs
eth0: rx_packets (column 7)
Ip: InDelivers
IpExt: OutOctets
Ip: OutRequests
Mapped
sockets: used
Shmem
MemFree
Active(anon)
AnonPages
UNIX: sockets
Committed_AS
Accuracy
80.6%
80.0%
79.4%
78.8%
78.8%
77.5%
77.5%
75.6%
75.6%
75.6%
75.6%
75.0%
75.0%
75.0%
75.0%
74.4%
73.8%
72.5%
55.6%
55.0%
45.0%
42.5%
36.3%
35.6%
26.9%
13.1%
5.3 Analysis and Evaluation on Android 8
Similar to the evaluation on Android 7, ProcHarvester automati-
cally identified information leaks that allow to fingerprint websites
on Android 8. The profiling and evaluation are performed exactly
as on Android 7. Table 8 provides an excerpt of the information
leaks and the corresponding accuracies evaluated for 20 websites
on Android 8. By combining the identified information leaks from
Table 8 we achieve an average classification rate of 87% based on
k-fold cross validation. Table 9 depicts the detailed results for all 20
websites.
6 KEYBOARD GESTURE INFERENCE
We now demonstrate the applicability of ProcHarvester to auto-
matically profile events such as tap, touch, long press, as well as
short and long swipe actions on the soft keyboard.
Problem Description. Information about user input gestures (e.g.,
the length of swipe actions, whether it was a short touch action or a
long touch action, etc.) enable powerful follow-up attacks (cf. [24]).
Therefore, the Android system prevents applications from directly
learning such sensitive information.
6.1 Profiling
In order to profile the procfs for information leaks that reveal sen-
sitive user input activity, we simulate touch actions and touch
gestures through ADB commands (input swipe and input tap).
Website
www.360.cn
www.amazon.com
www.baidu.com
www.facebook.com
www.google.com
www.imgur.com
www.instagram.com
www.jd.com
www.linkedin.com
www.live.com
www.netflix.com
www.qq.com
www.reddit.com
www.sina.com.cn
www.sohu.com
www.taobao.com
www.tmall.com
www.vk.com
www.wikipedia.org
www.yahoo.com
Average
Precision Recall
100%
100%
75%
100%
100%
88%
100%
62%
100%
100%
88%
25%
100%
75%
62%
100%
88%
50%
100%
100%
86%
89%
80%
86%
100%
89%
70%
80%
71%
80%
89%
88%
100%
100%
100%
62%
100%
100%
100%
80%
80%
87%
Note that specific interrupts such as the screen interrupt are only
triggered for real touchscreen interactions, which will lead to ad-
ditional information leaks. However, a complete investigation of
information leaks would require the events to be triggered by phys-
ically touching the screen, e.g., by a human being, and a fully-
fledged attack evaluation is out of scope for this paper. We consider
the following events in order to demonstrate the applicability of
ProcHarvester:
(1) Short swipe over three soft keys (75 ms)
(2) Long swipe over nine soft keys (300 ms)
(3) Tap character, i.e., keystroke on “a”
(4) Long press character, i.e., long press on “a”
(5) Tap shift key
6.2 Information Leaks on Android 7
6.2.1
Information Leaks. Similar to the experiments in the pre-
vious sections, the ProcHarvester Desktop Suite automatically
identified several procfs resources that allow to detect the profiled
user input events. The evaluation is based on results obtained on
the One Plus 3T and the AOSP keyboard.
Figure 6 illustrates plots of the MDSS resource for three user input
events. Although the traces for “tap character” and “tap shift” look
quite similar at first glance, the y-axes have a different scale, which
means that these events can be automatically distinguished based
on the identified information leak. Table 10 provides an excerpt
of the identified information leaks that allow to infer user input
actions.
ASIA CCS ’18, June 4–8, 2018, Incheon, Republic of Korea
R. Spreitzer, F. Kirchengast, D. Gruss, and S. Mangard
Figure 6: Information leak (MDSS) for “tap character”, “tap shift”, and “long swipe”.
Table 10: Excerpt of identified information leaks for key-
board gestures on Android 7. Accuracy based on 5 gestures.
Table 12: Excerpt of identified information leaks for key-
board gestures on Android 8. Accuracy based on 5 gestures.
procfs file
/proc/interrupts
/proc/interrupts
/proc/vmstat
/proc/interrupts
Property
MDSS
kgsl-3do
nr_mapped
Rescheduling interrupts
Accuracy
95.0%
86.3%
85.0%
77.5%
Table 11: Classification rates for screen gestures by combin-
ing the identified information leaks on Android 7. Accuracy
based on 10 samples per gesture.
Keyboard gesture
Short swipe
Long swipe
Tap character
Long press character
Tap shift
Average
Precision Recall
100%
100%
100%
100%
90%
98%
100%
100%
91%
100%
100%
98%
procfs file
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
/proc/meminfo
Property
Active
Active(anon)
AnonPages
Committed_AS
HighFree
MemFree
MemAvailable
LowFree
VmallocUsed
Mapped
PageTables
KernelStack
Active(file)
Cached
Dirty
Accuracy
77.5%
76.3%
73.8%
72.5%
72.5%
72.5%
70.0%
63.8%
62.5%
60.0%
57.5%
50.0%
45.0%
42.5%
38.8%
6.2.2 Adversary Model and Evaluation. Similar to the previous
adversary models, we assume that the attacker tries to fingerprint
user input events. Hence, the malicious application monitors the
identified information leaks in order to infer user input events by
means of a template attack.
Evaluation. We established a database of screen gesture finger-
prints for the above described gestures by collecting 10 samples per
gesture. By combining the identified information leaks presented
in Table 10, we achieve an average accuracy of 98% based on k-fold
cross validation. The detailed results for each of the five gestures
can be found in Table 11.
keyboard gestures on Android 8. Although interrupt information
(/proc/interrupts) and especially the MDSS interrupt information
is not available anymore on Android 8, ProcHarvester identified
many information leaks within /proc/meminfo that allow to infer
keyboard gestures. Our evaluation shows that the overall accuracy
for inferring keyboard gestures decreases, but there are still many
information leaks left on Android 8.
By combining the identified information leaks from Table 12 we
achieve an average classification rate of 73% based on k-fold cross
validation. Table 13 depicts the detailed results for all keyboard
gestures. The side channels automatically identified by ProcHar-
vester are the only known side channels on Android 8.
6.3 Analysis and Evaluation on Android 8
Similar to the evaluation on Android 7, ProcHarvester automat-
ically identified information leaks that allow to infer keyboard
gestures on Android 8. The profiling and evaluation are performed
exactly as on Android 7. Table 12 provides an excerpt of the informa-
tion leaks and the corresponding accuracies evaluated for different
7 DISCUSSION
We now discuss countermeasures against procfs side-channel at-
tacks and how ProcHarvester can be used to automatically iden-
tify procfs leaks before Android updates are shipped to the user.
Furthermore, we discuss current limitations as well as the perfor-
mance of ProcHarvester.
05001,0001,5002,0002,50001020304050Time[ms]MDSSTapcharacterTimeseries1Timeseries2Timeseries305001,0001,5002,0002,5000102030Time[ms]MDSSTapshiftTimeseries1Timeseries2Timeseries305001,0001,5002,0002,500050100Time[ms]MDSSLongswipeTimeseries1Timeseries2Timeseries3ProcHarvester
ASIA CCS ’18, June 4–8, 2018, Incheon, Republic of Korea
Table 13: Classification rates for screen gestures by combin-
ing the identified information leaks on Android 8. Accuracy
based on 10 samples per gesture.
Keyboard gesture
Short swipe
Long swipe
Tap character
Long press character
Tap shift
Average
Precision Recall
90%
100%
10%
100%
80%
76%
100%
91%
33%
91%
50%
73%
7.1 Countermeasures
App Guardian. Zhang et al. [36] proposed a countermeasure to
prevent procfs-based side-channel attacks. The main observation is
that the attack app needs to run side-by-side with the victim app
on the targeted device in order to collect the required side-channel
information. Therefore, they developed a third-party application
(App Guardian) that should prevent such side-channel attacks. The