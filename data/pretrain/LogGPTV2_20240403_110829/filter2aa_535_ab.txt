1. Become a lottery RNG 
developer
2. Write code to make the 
numbers predictable
3. Have your friends buy 
tickets with the winning 
numbers
© SeNet International Corp. 2017
27
July 2017
SeNet
How he Rigged the Lottery
© SeNet International Corp. 2017
28
July 2017
SeNet
How he Rigged the Lottery (really)
•
In 2003 Eddie got a job as an RNG developer at MUSL
•
While working there he wrote code which made the numbers predictable on 
three dates
•
The source code and RNG binaries were certified by one of the major testing 
labs
© SeNet International Corp. 2017
29
July 2017
SeNet
How he rigged the lottery (cont.)
•
In 2016 SeNet was contracted to perform imaging of one of the rigged 
lottery RNGs
•
In 2016 after Eddie was convicted SeNet was given permission to 
review the RNG images
•
Eddie didn’t seem smart enough to write a rootkit which could change 
lottery numbers in memory
•
So despite the official explanation (which he was convicted off of) for 
how he rigged the lottery I assumed he simply slipped some code into 
the RNG which rigged it…
•
At this point we only had the binaries (no source code)
© SeNet International Corp. 2017
30
July 2017
SeNet
Reverse Engineering
•
The RNG consisted of an executable (QV.EXE) which contained the 
front-end material
•
A DLL (QVRNG.DLL) which contained the PRNG
•
And a DLL (AWRAND.DLL) which interfaced with the hardware RNG
•
QVRNG.DLL was an obvious first choice for an RNG rigger
•
So I looked at QVRNG.DLL first
•
I briefly skimmed through all of the functions. One of them caught my 
eye…
© SeNet International Corp. 2017
31
July 2017
SeNet
Logic Bomb
© SeNet International Corp. 2017
32
July 2017
SeNet
Logic Bomb (Cont.)
•
At this point we also knew that all of the alleged illicit lottery wins related 
to the case were on two different days: November 23rd and December 
29th (November 22nd and December 28th on leap years)
•
So this function full of references to date checks and the PRNG
internals was pretty suspicious
•
Also the function was at the end of the binary (as if it had been tacked
on to the end of a source file) which was suspicious
•
At this point we were able to obtain the source code for the RNG
•
Sure enough there were 25 functions in the source code and 26
functions in the binary
© SeNet International Corp. 2017
33
July 2017
SeNet
Logic Bomb (Cont.)
© SeNet International Corp. 2017
34
July 2017
SeNet
Logic Bomb (Cont.)
© SeNet International Corp. 2017
35
July 2017
SeNet
Logic Bomb (Cont.)
•
The date calls corresponded to the two known dates of lottery rigging
•
Plus one additional date: May 27th (May 26th on leap years)
•
Additional conditions for the RNG rigging were identified and correlated 
with known illicit winnings
•
For example, the RNG was only rigged on Wednesdays and Saturdays
© SeNet International Corp. 2017
36
July 2017
SeNet
Logic Bomb (Cont.)
© SeNet International Corp. 2017
37
July 2017
SeNet
Logic Bomb (Cont.)
•
The method by which the function reseeded the RNG with predictable 
numbers was identified
•
Basically he just took various game parameters including the number of 
numbers per draw and the maximum and minimum numbers in the 
game and multiplied them together along with the number 39 and the 
summed ASCII values of the letters in the computer name. Then he took 
that and added it to the day of the year and added in the product of the 
number of times the RNG had run since the last reboot and the year.
•
This number is then used to seed the PRNG.
•
Then he drew a quantity of numbers from the RNG corresponding the 
quantity of numbers which had been drawn since the RNG last 
restarted. The last number drawn was then used to seed the PRNG a 
second time.
© SeNet International Corp. 2017
38
July 2017
SeNet
Why didn’t certification work?
•
The RNG was certified by one of the 
major testing labs
•
The certification ran the output of the 
RNG through statistical tests to 
ensure unbiased results…
•
But the output of the rigged RNG was 
statistically unbiased
•
The lab performed an audit of the 
source code…
© SeNet International Corp. 2017
39
July 2017
SeNet
How he could have done it better
•
Rigging the lottery on only three dates made it easier to identify illegal 
winnings
•
Making numbers dependent on variables like the computer name and 
time of day meant he had to buy multiple tickets for each drawing
•
The method of rigging the RNG could have been more discrete
© SeNet International Corp. 2017
40
July 2017
SeNet
How can this be prevented in the 
future?
•
RNG source code should undergo in-depth third-party reviews
•
The binaries (including updates) should be compiled and checked 
(e.g. via Bindiff) against the binaries provided by the RNG vendor
•
The machine itself should be imaged and configured either by a 
third party or in a supervised manner
© SeNet International Corp. 2017
41
July 2017
SeNet
Russian slot machine hacking
https://www.wired.com/2017/
02/russians-engineer-brilliant-
slot-machine-cheat-casinos-
no-fix/
https://www.youtube.com/wat
ch?v=W_vdoaKsP5Y (Willy 
Allison World Game 
Protection Conference)
© SeNet International Corp. 2017
42
July 2017
SeNet
Russian slot machine hacking (cont.)
•
In  2009 Russia made majority of gambling illegal, this led to a number of 
slot machines being sold to whomever they could find
•
By 2011 casinos in Europe were noticing suspicious payouts
•
In June of 2014 in a casino in Missouri noticed unusual activity with some 
slot payouts, Missouri Gaming Commission was notified
•
December of 2014 the same individuals were arrested back in Missouri 
•
2016 some more were arrested and prosecuted in Singapore 
© SeNet International Corp. 2017
43
July 2017
SeNet
Russian slot machine hacking (cont.)
•
Slot machine software was reversed engineered and a weakness 
discovered in the PRNG
•
Phones were used to record about 24 spins
•
Data uploaded and using video footage they were able calculate the pattern 
based on the slots PRNG
•
Information is transmitted to a custom app with a listing of timing marks that 
cause the mobile to vibrate 0.25 seconds before the spin button should be 
pressed
•
Not always successful, but the result is higher payout than expected 
How did they do this?
© SeNet International Corp. 2017
44
July 2017
SeNet
Russian slot machine hacking (cont.)
Video Demonstration 
© SeNet International Corp. 2017
45
July 2017
SeNet
What casinos and operators can do to 
protect themselves
•
Understand that compliance != security
•
Similar to other verticals more budget needs to be spent on information 
security
•
Operators need to question game manufacturers on their security 
controls 
© SeNet International Corp. 2017
46
July 2017
SeNet
Current gaming regulations with 
security components
•
Maryland Gaming Commission requires an annual IT Security Assessment 
be performed by an independent and approved 3rd party on an annual 
basis.
•
New Jersey Division of Gaming Enforcement has written in their iGaming 
standard that a security assessment be performed once a year on the 
iGaming platforms.  Also includes other requirements such as auditing, 
password complexity, etc…
•
Various tribal Minimum Internal Controls (MICs), however, these are 
typically very high-level.
•
Also your typical regulatory compliance standards (i.e. PCI)
•
Often left up to the operator to determine what level of security is 
implemented.
© SeNet International Corp. 2017
47
July 2017
SeNet
Conclusion
While regulated iGaming has added additional controls there is still room from 
improvement (both from operators and regulators).
In our opinion a major risk exists in the code and SDLC process (this is an 
area that is not really examined by regulators).
With gaming (all formats) becoming more widely accepted across the United 
States it is important the operators and regulators works together to protect 
the integrity of the games.
© SeNet International Corp. 2017
48
July 2017
SeNet
Questions