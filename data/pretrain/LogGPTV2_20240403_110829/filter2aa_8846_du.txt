*TCP 三次握手确保通信会话的建立的可靠性，其描述如下：
1.客户端（源）向服务器发送 SYN (同步)数据包。
2.服务器（目的）使用 SYN/ACK (同步和确认)数据包响应客户端。
—108—
3.客户端使用 ACK(确认)数据包响应服务器。
*如果要结束会话，有两种方法断开：
1.最常用的方法是使用 FIN (finish) 数据包来代替 SYN 数据包；收发双方都要发一个
FIN 包，对方通过 ACK 确认，完成中断要产生 4 个包。
2.使用 RST (reset) 数据包够使会话立即和突然终止。
*TCP 的数据包完整性和顺序的确认：
通过 TCP 报头中的序列值（sequence number）来确认收到数据包的顺序。接收方不一定
每收一个包都要回复一个确认信息，如果信道质量好，可能一次多了好多包以后再回复确认；
回复确认之前传输的数据包数称为传输窗口（transmission window），只有一个窗口里的数
据都确认了，再发下一组的数据。这就是所谓的滑动窗口机制，窗口越大速度越快，但如果丢
包率高，那速度就大打折扣了。当然，这个窗口值是可以动态变化的。
下面介绍 TCP 报头。前面讲了很多“包”，其实传输层应该叫段（TCP）和报文（UDP），
这里混用了。与 UDP 协议相比，TCP 报头相对复杂，长度为 20 到 60 字节，有这么些内容要了
解（数字是占多少比特位），还有些字段是不会考的，没列出来。报头字段分配：
源端口-16，目的端口-16；序列号-32，窗口大小-16；预留-4，可变量-（32 的位数）；
标志-8（flag）。
这个“标志”flag 指示了 TCP 数据包的功能，并且请求接收方采用特定的方式进行响应。
标志字段的长度为八个比特，代表了 8 个标志符，其中某个比特位数值为 1 时，它代表的标志
符就生效，为 0 则不生效。所以最多可以同时 8 个标志都生效，当然这种情况没有。
1.CWR：拥塞窗口减少 Congestion Window Reduced
2.ECE：拥塞回复 ECN-Echo (Explicit Congestion Notification)
3.URG：紧急数据 Indicates urgent data
4.ACK：确认 Acknowledgement
5.PSH：立即推送数据 Indicates need to push dataimmediately to application
6.RST：重置 Reset，立即中断 TCP 会话 Causes immediate disconnect of TCP session
7.SYN：同步，Synchronization，要求与序列号同步
8.FIN：结束，协商正常结束会话，Finish Requests graceful shutdown ofTCP session
当 TCP 字段封装成 IP 包时，包头会加上协议字段。IP 包里用数值 6 来代表这个包里的数
据是 TCP 协议发来的。相应的，1 表示 ICMP 协议；2 表示 IGMP；6 表示 TCP；用数值 17 表示
数据是 UDP 协议；51 表示 AH（IPSec 的认证头部）。
③当一个通信连接在两个系统之间建立起来时，它通过端口（port）的使用完成操作。TCP
和 UDP 都有 65536（2
16）个端口（16 位）。端口，也被称为套接字（socket）就是通信链接两
端传输数据同意使用的地址号。
*保留端口/知名端口/服务端口 well-known ports or the serviceports：0~1023。如：
FTP/TCP20、21，SSH 22，Telnet/TCP23，SMTP/TCP25，DNS/UDP53，
终端访问控制器访问控制系统(TACACS+)/TCP49,
终端访问控制器访问控制系统 TACACS 和 XTACACS/UDP49，
引导协议(BootP)和 DHCP/UDP67、68，
—109—
普通文件传输协议 TFTP/UDP69，
HTTP/TCP80，POP3/TCP110，网络时间协议 NTP/123，
NetBIOS 服务/137-139，
互联网邮件身份验证协议 IMAP/TCP143，
SNMP/UDP161（162 用于跟踪信息），轻量级目录访问协议 LDAP/TCP389、SSL636，
HTTPS+SSL 或 TLS/TCP443，活动目录 AD/445，日志服务/UDP514
打印后台程序 LPR、LPD/TCP515、9100，
下面是已注册端口：
Microsoft SQL Server 1433，Oracle 1521，H.323 1720，PPTP 1723
网络文件系统 NFS/TCP2049，RDP 3389，
Diameter 访问控制协议/TCP3868，
X 视窗(XWindow)/TCP6000-6063，
*注册端口/己注册软件端口 registered software ports：1024~49151。这些端口具有注
册到 IANA(www.iana.org)的一个或多个互联软件产品，目的是为客户端连接提供一个标准的
端口编号系统。
*动态端口/私用端口/随机端口 random ports：49152~65535。这些端口是随机的、动态
的、私用的、临时的使用，没有规定标准的用途。
4.重点看看 IP 协议
IP 是无连接的、不可靠的数据报服务，不保以正确顺序传送数据包，因此，你必须在 IP
上使用 TCP，从而获取可靠的和受控的通信会话。
①IPv4 与 IPv6
IPv4 使用 32 比特的地址，而 IPv6 则使用 128 比特地址。IPv6 提供了作用域地址、自
动配置和 QoS 优先值等新功能。作用域地址使管理员能够进行分组以及随后阻止或允许对网络
服务(例如文件服务器或打印)的访问。自动配置排除了对 DHCP 和 NAT 的需求。QoS 优先值允
许基于优先顺序内容来管理通信。
IP 地址等级与分类已经不知道说了多少遍了：
A 类： 0， 1–126， 255.0.0.0/8；1 个 A 共 16777214 个主机
B 类： 10， 128–191, 255.255.0.0/16；1 个 B 共 65534 个主机
C 类： 110， 192–223, 255.255.255.0/24；1 个 C 共 254 个主机
D 类： 1110， 224–239, D 用于多播；
E 类： 1111， 240–255, E 预留待用；
127：留给环路地址，用于自检排障，尽管实际中只使用了一个 127.0.0.1。
私网/专有地址（RFC1918 定义），A、B、C 各一段，在讲 NAT 的时候会用到：
10.0.0.0/8， 即：10.0.0.0~10.255.255.255，1 整个 A
172.16.0.0/12， 即：172.16.0.0~172.31.255.255，16 个 B
192.168.0.0/16，即：192.168.0.0~192.168.255.255，255 个 C
32 位的 IP 地址可以用 4 个数字（小于 255）来表示，末位的 0 和 2 不能用于主机，255
用于广播地址。每个地址分为两个部分：网络地址和主机地址。网络地址，由相关组织分配，
—110—
代表了网段。A 类网络地址是使用最左边的一位字节作为网络地址编号，B 类网络地址是使用
最左边的两位字节作为网络地址编号，等等。
为了简化网络管理，网络通常被划分为多个子网，用子网掩码来定义和识别子网的网段。
在如果左边的三字节(24 位)用于区分不同的子网（网络地址），子网掩码是 11111111 11111111
11111111 00000000，用十进制表示为 255.255.255.0，使用无类域间路由选择(CIDR,classless
interdomain routing)可表示为/24（使用掩码位）。使用掩码位的一个重要优点是能够将多
个不相邻的地址集组合在单个子网内。例如，我们可以将若干 C 类子网组合为一个更大的子网
分组。
IPv6 是一个 v4 的下一代协议，包括：
*更多的地址空间：IPv6 的地址是 128 位，支持 2 台主机。*增强的安全性（自带 IPsec）。
*增强的质量服务（QOS）。
IPv6 的表示方法：
①冒分十六进制表示法
格式为 X：X：X：X：X：X：X：X，其中每个 X 表示地址中的 16b，以十六进制表示，例如：
ABCD：EF01：2345：6789：ABCD：EF01：2345：6789
这种表示法中，每个 X 的前导 0 是可以省略的，例如：
2001：0DB8：0000：0023：0008：0800：200C：417A→ 2001：DB8：0：23：8：800：200C：
417A
②0 位压缩表示法（用：：表示 0）
在某些情况下，一个 IPv6 地址中问可能包含很长的一段 0，可以把连续的一段 0 压缩为
“：：”。但为保证地址解析的唯一性，地址中”：：”只能出现一次，例如：
FF01：0：0：0：0：0：0：1101 → FF01：：1101；
0：0：0：0：0：0：0：1 → ：：1
0：0：0：0：0：0：0：0 → ：：
③内嵌 IPv4 地址表示法
为了实现 IPv4-IPv6 互通，IPv4 地址会嵌入 IPv6 地址中，此时地址常表示为：
X：X：X：X：X：X：d.d.d.d，前 96b 采用冒分十六进制表示，而最后 32b 地址则使用 IPv4
的点分十进制表示，例如：
：：192.168.0.1 与
：：FFFF：192.168.0.1 就是两个典型的例子。在前 96b 中，压缩 0 位的方法依旧适用。
考题中有出现 Teredo，即面向 IPv6 的 IPv4 NAT 网络地址转换穿越：在 IPv6/IPv4 主机
位于一个或多个 IPv4 NAT 之后时，用来为单播 IPv6 连接提供地址分配和主机间自动隧道。
为能够通过 IPv4 NAT，IPv6 数据包作为基于 IPv4 的用户数据包协议(UDP)消息发送出去。
Teredo encapsulates IPv6 packets within UDP datagrams with IPv4 addressing.
IPv6-aware systems behind the NAT device can be used as Teredo tunnel endpoints even
if they do not have a dedicated public IPv4 address.
5.域名解析与寻址
网络上的地址有三个层次：底层的 MAC，中层的 IP，高层的域名；用到了 DNS、LDAP 什么
—111—
的。通过这些名字可以在网上定位和识别一个终端或客户端。它们都不安全，都可能被篡改。
6.远程过程调用 RPC-Remote Procedure Call
RPC 是指跨主机执行对象的能力。工作在第五层，会话层。
7. Internet/lntranet/Extranet
• 互联网 Internet =外部不可信网络
• 内联网 lntranet =内部网络
• 外网 Extranet =外部不完全可信(例如，业务合作伙伴)
A.2 IP 网络连接
这里重点讲局域网 LAN。
LAN(局域网)技术存在三种主要类型：以太网、令牌环和 FDDI。CISSP 考试仅涉及这三种
主要类型。LAN 技术之间的差别存在于数据链路层及其以下层（二层）。
1.以太网 Ethernet
以太网基于 IEEE 802.3 标准，单独的以太网数据单元称为帧。以太网是一种共享介质的
LAN 技术，也称为广播技术。这意味着它准许很多设备在相同的介质上进行通信，但是要求每
—112—
台设备轮流通信并且执行冲突检测和避免操作。以太网采用广播域和冲突域。当两条被传输的
消息企图同时使用网络介质时，就会出现数据冲突，这会导致其中一条或者两条消息出现。以
太网可以支持全双工的通信，最常在星型或总线型拓扑上部署。以太网能够支持 100M 到 10Gbps
的速率（吞吐量）。
2.令牌环网 Token Ring
令牌环采用令牌传递机制来控制哪些系统可以在网络介质上传输数据。令牌在 LAN 所有
成员形成的逻辑环上进行传递。令牌环可以采用环型或星型网络拓扑。由于令牌环的性能有限，
比起以太网来成本又高，而且会增加部署和管理的难度，今天己极少使用。
令牌环可通过使用多站访问部件（MAU）配置为物理星形结构。
3.光纤分布式数据接口(FDDI) Fiber Distributed Data Interface
光纤分布式数据接口(FDDI)是一种使用两个环的高速令牌传递技术，其中信息流在两个环
上沿相反的方向传输。FDDI 常用作大型企业网络的主干，它的双环设计允许实现自愈，即从
环中去除故障网段，并且利用剩下的部分内部环和外部环建立单个环。虽然 FDDI 价格昂贵，但
是在快速以太网和千兆以太网出现之前常常被用在校园环境中。价格稍便宜、距离有限且速度
更慢的版本称为铜线分布式数据接口(CDDI)。CDDI 也更容易遭到干扰和偷听。
4.基础数据通信技术
①模拟通信与数字通信 Analog and Digital
使用频率、幅度、相位、电压等发生变化的连续信号时，就会进行模拟通信。连续信号的
差异会产生一个波形(与数字信号的方被形成对照)。连续信号的差异实现实际通信。
通过使用非连续的电子信号以及状态改变或开关脉冲，就会出现数字通信。在长距离传输
或存在干扰时，数字信号比模拟信号更可靠。
模拟和数字的区别很容易，如果以前没搞过通信，自己补补课。
②同步和异步 Synchronous and Asynchronous
同步通信依赖于定时或时钟机制，这种机制基于独立的时钟或数据流内嵌的时间标记。同
步通信通常能够支持非常高速的数据传送。
异步通信依赖于停止和开始定界位来管理数据的传输。因为使用了定界位以及传输的停止
和开始特征，所以异步通信最适用于较少量的数据。公用电话交换网(PSTN)调制器就是异步通
信的一个绝佳示例。
同步速度快，异步速度慢。
③基带和宽带 Baseband and Broadband
在一个线缆段上能够同时发生的通信数取决于使用的是基带技术还是宽带技术。基带技术
只能支持单个通信信道，它使用直流电应用于线缆，其中有电流表示二进制信号 1，无电流表
示二进制信号 0。基带是一种数字信号形式。以太网线就是基带技术。
宽带技术能够支持多个同时发生的信号。宽带使用频率调制来支持许多信道，每个信道都
支持一个截然不同的通信会话。宽带适用于高吞吐率，尤其适用于若干信道复用的情况。宽带
是一种模拟信号形式。有线电视、线缆调制器、ISDN、DSL、Tl 以及 T3 都是宽带技术的示例。
④介质访问 LAN Media Access
有五种局域网传输介质共享与冲突避免技术是比较重要的，即 LAN 介质访问技术，用来避
—113—