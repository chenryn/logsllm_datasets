To configure Fabric to connect to remote hosts, such as Amazon EC2 instances, using SSH keyfiles, you can follow these steps. While Fabric does support the use of `.ssh/config` file settings to some extent, it may not work seamlessly with key files (e.g., PEM files) for EC2 instances. You might find that a correctly set up `.ssh/config` file works fine from the command line (e.g., `ssh servername`), but fails when used with `fab sometask` and `env.hosts=['servername']`.

To overcome this issue, you should explicitly specify the path to your key file in the `fabfile.py` by setting `env.key_filename='path/to/your/keyfile.pem'`. This step essentially duplicates the `IdentityFile` entry from your `.ssh/config` within the Fabric configuration. The problem could stem from either Fabric or its underlying library, Paramiko. In the scenario described, the versions in use were Fabric 1.5.3 and Paramiko 1.9.0.

By directly specifying the key file in your Fabric script, you ensure that the connection is established successfully, bypassing any potential issues with how Fabric or Paramiko handle the `.ssh/config` file.