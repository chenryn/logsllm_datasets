l
a
V
Attack
s
R
R
I
s
r
a
r
t
s
i
g
e
R
S
a
a
I
s
A
C
Outcome /
Attacker use
Disabling Email alerts
RIRs Account transfer/delegation     permanent control
No
Changing the account details     permanent control
RIRs Close the account permanently    
 ∗  ∗
remain stealthy
No
    permanent control
   
   
    ﬁnancial Damage
    anonymous usage
Whois DB     facilitates hijacking
Resource return / deletion
Purchase new resources
Resource transfer
sell resources
RIRs
No
CAs
DoS
DoS
No Control / Modify
Resources
VMs
   
NS records    
various
trafﬁc hijacking
No
No
No
Create new ROAs/certiﬁcates     facilitates hijacking
Create invalid ROAs
Revoke certiﬁcates
   
   
DoS
DoS
Table 5: Actions an attacker can carry out after hijacking a customer’s account.
∗The Email address where the alert is sent can be changed. Additional
validation requires either that additional documents are sent, or in case of
issuing a new TLS certiﬁcate, that a domain validation must be passed.
domain registrars. Hence, we in details explain our demon-
stration of the exploits by taking over a victim LIR account,
and then brieﬂy describe the exploits we evaluated by taking
over our victim accounts with the other providers. For our
demonstration we select RIPE NCC RIR, GoDaddy domain
registrar, Microsoft Azure IaaS provider and DigiCert CA. In
order to evaluate the exploits using an account of a network
operator, we cooperate with a large customer under RIPE
NCC. We cooperate with that LIR and use a real account that
has an operator/administrator role4. For domain registrars,
IaaS and CAs, we used our own accounts which were used to
buy test resources to test the possibilities of the account. We
summarise the exploits for different providers in Table 5.
For our evaluation of the exploits, we ﬁrst carry out our
attacks in Section 4 to take over the victim accounts, and then
carry out the exploits. We do this in order to understand what
notiﬁcations are sent to the genuine account owners during
such attacks, what actions can be performed, and which are
prevented.
6.1 Regional Internet Registries
We show that adversary, controlling an SSO account of a vic-
tim LIR, can manipulate all the Internet resources associated
with that LIR, e.g., the IPv4 and IPv6 addresses, ASNs, re-
verse DNS names to IP addresses mappings. The amount of
resources managed by LIRs can vary enormously. There are
small LIRs that manage just own AS, one IPv6 preﬁx and one
4RIPE NCC Single Sign-On (SSO) accounts are general authentication
mechanism for all web-based services provided by RIPE NCC that include
customer portal and other harmless services - for example RIPE Meeting
facilitation.
or a very few IPv4 preﬁxes of minimal allocation size. There
are also large LIRs managing vast PA address pools (Provider
Aggregatable Addresses) for multiple clients. For instance,
RIPE NCC has cumulative allocation of 587 202 560 IPv4
addresses.
The adversary impersonating an administrator with the
RIPE NCC SSO account holder can initiate different actions
that lead to disruption or degradation of the services that are
tied to the IP resources managed by the victim LIR. The
adversary can even initiate transfer of IPv4 addresses that
belong to the victim LIR to obtain direct ﬁnancial beneﬁt
from that process. Our experimental evaluation with an SSO
account under RIPE NCC RIR shows that the actions of the
attacker do not trigger alerts and can be detected when the
LIRs realises that its digital resources are gone. The access to
RIPE NCC SSO account with operator or administrator roles
for the victim’s LIR opens to a range of possible exploits. We
explain selected exploits with an example victim LIR under
RIPE NCC below (also summarised in Table 5); the attacks
similarly apply to the other RIRs.
RPKI administration. Attacker creates/deletes/modiﬁes
Route Origin Authorizations (ROAs) in hosted RPKI sys-
tem. This has two purposes: (1) to disrupt the propagation
of the legitimate BGP updates of the resources managed by
the victim LIR and (2) to facilitate BGP hijacking by autho-
rising attacker’s ASN to originate any subset of IP preﬁxes
that are managed by the victim LIR. Networks which have
deployed RPKI and perform ﬁltering of BGP announcements
with ROV will not trigger any alerts when the attacker issues
a BGP announcement for a sub-preﬁx with a valid (yet fraud-
ulent) ROA. We consider creation of ROA with origin set to
ASN0 ("always drop" as per [RFC7607]) for a speciﬁc preﬁx
within the resource pool managed by the victim LIR to be a
special case of the malicious ROA intended to disrupt routing
and cause DoS for the services tied to the IP addresses in ques-
tion. Our measurements found that currently the Route-Origin
Validation (ROV) is far from being universally deployed, with
only 2190 ASes ﬁltering invalid BGP announcements. Never-
theless, this is an increase in contrast to measurements from a
few years ago, which found 71 ASes to validate ROV [20,36].
Even with 2000 validating ASes, this type of attack is likely
to cause only minor disruption in service availability and will
remain unnoticed for extended period of time.
RIPE DB modiﬁcations. Attacker manipulates records in
RIPE DB - the Internet addressing resource registry of the
region and Internet Routing Registry (IRR) in one converged
database. Modiﬁcation of records in resource registry allows
impersonation of the victim LIR’s representatives in order
to transfer resources from the victim LIR to unsuspecting
recipient.
IRR records are prerequisite for BGP hijacking attacks,
because without proper records in IRR the attacker would not
be able to persuade any well-managed upstream provider that
is consistent with AS operation best practices to accept the
USENIX Association
30th USENIX Security Symposium    3159
fraudulent BGP announcements in the input ﬁlters on the BGP
sessions. Attackers without the ability to modify IRR have
to use less vigilant and generally poorly managed networks
as upstream providers or have to utilise path manipulation
attacks - both restrict success rate and stealthiness of the
attack.
Creating the IRR records contradictory to the state in BGP
is a way to partially disrupt route propagation and thus trafﬁc.
It can also de-stabilise network and signiﬁcantly complicate
network operation for the legitimate administrators. Route
servers in majority of Internet Exchanges and major networks
use IRR data in automatically generated ﬁlters that are applied
on incoming BGP announcements. As a result of the contra-
dicting IRR records these networks will drop or de-prefer the
announcements from the legitimate resource holder. More-
over, well-managed networks keep manually generated import
ﬁlters on small-scale BGP sessions for both peering and down-
stream customers. When a new session is set up or when a
new preﬁx is about to be propagated from the neighbouring
AS that is subject to ﬁltering, the administrators manually
check the IRR and resource registry to verify that the an-
nouncement is legitimate. Failing to have the proper records
in IRR and in resource registry leads to refused BGP peerings,
excessively strict BGP ﬁlters and therefore to dropped routes
and overall degradation of the Internet connectivity for the
victim network.
Initiating IPv4 addressing resource transfer. Attacker
sells the resources managed by the victim LIR. The poten-
tial gain from successfully completed attacks of this type is
determined by the amount of the addresses managed by the
LIR and the expected monetary value of IPv4 addressing re-
sources. After the IPv4 regular pool depletion on 4 September
2012 each LIR is eligible for allocation of a single /22 (1024
IPv4 addresses) preﬁx as per current IPv4 Address Allocation
and Assignment Policies for the RIPE NCC Service Region
(ripe-720) [1]. We performed IPv4 /22 preﬁx transfer of an
LIR under RIPE NCC which has not triggered alerts. This is
not surprising since the IPv4 addresses’ transfer is performed
regularly by the RIRs, e.g., RIPE NCC and ARIN perform
thousands of transfers per year, see statistics on IP transfer
(PI and PA) we collected from the RIRs in Figure 7.
Figure 7: IPv4 resource transfers per year (PI & PA).
To sell the IPv4 addresses belonging to the victim LIR, we
needed to perform the following:
(1) modify the relevant LIR contacts (Emails, phone num-
bers) in the RIR database and the IRR to receive the commu-
nication from the RIR intended to the genuine LIR, the buyer
as well as the other parties relevant to the IP resource transfer
and prevent the victim to learn about the resource transfer
process. This is performed via the victim SSO account which
the attacker took over.
(2) ﬁnd the buyer for the resources and to impersonate the
victim representatives to successfully close an IPv4 resource
transfer contract; we used the compromised SSO account to
sell and transfer the resources to an LIR that we set up for
that purpose. In practice, the attacker can also collude with a
malicious adversary, which will perform the transaction and
afterwards will legally own the resources. The victim will
need to prove to not have authorised the payment. In fact the
resolution outcome of such a case is not clear since the RIRs
have not faced this attack before.
(3) release the IPv4 preﬁx from the BGP routing table.
This needs to be done so that the buyer believes that the
resources are free and are being legitimately sold. This is
done by sending an Email (via the Email address that the
attacker modiﬁed in IRR and registry DB) to the upstream
provider of the victim. The list of the upstream providers is
available and can be obtained from the IRR. In the Email the
attacker instructs the upstream provider to update the input
ﬁlters and drop the network (that the attacker wishes to sell).
Such requests are common, and do not require authentication
or veriﬁcation of requester’s identity (e.g., with PGP/PKI)
and the sole source of truth that is checked prior applying the
ﬁlters is RIPE DB which, as we mentioned, the attacker can
update via the SSO account.
Notice that if the buyer is colluding with the attacker - this
step is not needed.
(4) Email a scanned IPv4 resource transfer contract to RIPE
NCC. The contract has to match the company details of the
victim and contain all formalities and certiﬁcations appropri-
ate to the legal system in which the contract has been made.
Moreover the contract has to be supplemented by extract from
chamber of commerce or appropriate commercial registry that
makes it possible to establish that the contract is signed by the
eligible persons on both sides. This is simple to forge - the
attacker can ﬁnd and copy the signatures of the owner LIR
online and paste them into the scanned contract document
that the attacker prepares.
Extract from chamber of commerce is also simple to forge
- for instance, in Czech Republic (CZE) the attacker has to
go to any post ofﬁce, pay 1 EUR and get either paper version
with a stamp or PDF with PKI signature of state-operated CA.
In any case, since the attacker only needs to send a scanned
version of the document to RIPE, the attacker can get the
document for any company and adjust it using Photoshop and
it is accepted.
Finally, notice that the RIRs have limited personnel which,
depending on the RIR, may need to deal with tens of transfers
per day, see Figure 7. As a result, the adversary may often
manage to sell the resources without raising alarms even
3160    30th USENIX Security Symposium
USENIX Association
 0 1000 2000 3000 4000 5000 6000 2012 2014 2016 2018 2020# TransfersARINRIPEAPNICwhen not satisfying these simple four steps. For instance,
RIPE NCC has just 24 employees responsible for IP address
distribution5 and there are more than 20 transfers per day, see
Figure 7.
User and role management. Attacker that controls an ac-
count with administrator role assigns other newly created
users either operator or administrator roles for the victim
LIR. This effectively hides the activities of the attacker for
long periods of time even though the legitimate holder is
actively operating the LIR.
Modiﬁcation of the LIR contacts and details. There are
two sets of Email and postal addresses and phone numbers
related to the LIR - the ﬁrst set is published in IRR and RIPE
DB and it is tied to the resources and published to facilitate
operation of the network and solving technical problems and
those contacts are also used by the RIPE DB software itself
for generating notiﬁcations about changes in RIPE DB. The
second set contains the designated LIR contact information,
namely the primary point of contact for the LIR and a contact
for billing-related matters. Moreover, there is a postal address,
that may differ from legal address of the LIR company and
it can be modiﬁed in LIR portal. The attacker can redirect or
change the LIR contact information to avoid detection by the
victim LIR staff when activities that result in notiﬁcations or
follow-up Emails are to be executed. Modifying LIR contacts
will also make any attempt to rectify damages caused by the
attack, when detected, harder.
Termination of LIR membership. Attacker initiates ter-
mination of LIR membership with the RIPE NCC by submit-
ting a forged termination request via a written notice sent by
Email. Forgery cases are not new and have already been seen
in the past6.
Modiﬁcation of LIR organisation name, legal address
and VAT number. The attacker steals the LIR and all its IP
addressing resources by pretending a transfer of ownership to
other company. A scan of (the forged) contract of company
acquisition has to be attached to the request in electronic
form.
Requesting new or voluntarily returning IP addressing
resources. The attacker requests or returns IP addressing
resources from or to RIPE NCC. If the LIR is eligible for
allocation of any scarce resources, the attacker obtains a new
IP preﬁx that is not used in default-free zone (DFZ) and thus
fulﬁls the prerequisite for transfer of not being announced.
However, according to the current policy the newly obtained
allocation of scarce resources (IPv4 addresses, 16-bit ASN)
can not be transferred within 24 months from the allocation.
The attacker can nonetheless hijack the resources for own
purposes immediately and attempt to sell the resources after
the grace period.
6.2 Domain Registrars
Domain registrars handle the ownership of domains in name
of the customer. We map the 100K-top Alexa domains to
registrars with whom these domains are registered in Table 1.
We demonstrate exploits that the attacker can perform when
taking over an account with GoDaddy7. The adversary can
change the nameservers’ IP addresses, which allows it to
hijack the victim customer domain. This can be exploited
to redirect clients to phishing websites. The adversary can
delegate account access to itself or perform intra-and inter-
registrar8 domain transfer. The adversary can change the
Email forwarding settings of the account which would al-
low it to hijack the Emails forwarded to the owner of the
Email address. The adversary can also delete the domains
associated with the compromised account and even close the
account. The account owners can enable two-factor authen-
tication for manipulation of resources associated with their
account. However, this is not enabled by default, and is up to
each customer to enable it.
6.3
Infrastructure as a Service
We evaluated the exploits that the adversary can carry out on
resources associated with accounts at cloud providers. The
adversary can manipulate virtual resources associated with
the account, such as virtual machines, network interfaces, disk.
The adversary can also exploit these resources to carry out
attacks against victims in the Internet or victims located on the
same cloud platform, e.g., via side channels [39]. In addition
the adversary can create new accounts with owner privileges
or transfer subscription to another Azure account.
6.4 Certiﬁcate Authorities
When controlling an account of a customer with a CA the ad-
versary can revoke certiﬁcates and reissue existing certiﬁcates
that were issued under that account. This allows to change
the key-pair associated with a certiﬁcate. Nevertheless, some
CAs, do not enforce any validation on reissuing certiﬁcates, in
contrast to validation (domain validation, organisation valida-
tion or extended validation) that is enforced when requesting
to issue a certiﬁcate for the ﬁrst time. Therefore, instead of
attacking domain validation procedure of the CAs it is more
proﬁtable to hijack a victim customer account and change
the keys associated with the certiﬁcates for domains that the
adversary targets. DigiCert and GoDaddy do not perform ad-
ditional validation on requests to reissue certiﬁcates. Sectigo,
GlobalSign, IdenTrust validate all requests to reissue certiﬁ-
cates.
5https://www.ripe.net/about-us/staff/structure/registration-services
6https://mailman.nanog.org/pipermail/nanog/2011-August/039379.html
7The other domain registrars allow similar actions.
8It takes 60 days for an inter-registrar transfer to ﬁnalise.
USENIX Association
30th USENIX Security Symposium    3161
7 Vulnerable Digital Resources
The large fraction of the accounts under different providers
that can be hijacked is alarming. Even more disturbing are
the exploits that the adversaries can do with the resources
assigned to the accounts. What is the extent of the Internet
resources that are at immediate risk due to the vulnerable
providers and vulnerable customers?
To answer this question we perform a correlation between
the accounts that our study found to be vulnerable to hijacks
via any of the attack methodologies in Section 4 and the digital
resources (domain names, IP addresses and ASNs) that the
attacker can take over as a result of hijacking that account. In
our analysis we consider only the domain registrars and the
RIRs and their customers. Since there is no public database
of customers of cloud providers and certiﬁcate authorities
we exclude them from this analysis9. We list the correlation
between the vulnerable resources and the vulnerable accounts
in Table 6.
IP resources. We compute the fraction of the assigned
AS Numbers (ASNs) as well as assigned IPv4 address space
which could be taken over by hijacking the vulnerable ac-
counts of customers of RIRs. For this purpose, we combine
IP-to-ASN and ASN-to-LIR mappings with our customer vul-
nerability data, which allows us to evaluate vulnerabilities in
73% of the assigned IPv4 address space (for 27% we could
not extract LIR account information). Our results show that us-
ing any of the attack methodology in Section 4 the adversary
could take over 68% of the IPv4 address space. This consti-