1.3K
29
Eyeson Toxicity(%)
4.1%
8.2%
9.1%
2%
3.4%
7.4%
6.4%
EvilSeed [35] Toxicity
1.34%
1.12%
-
-
-
-
Table 10: Eyeson results; proﬁling alerts, validated alerts and their corresponding toxicity metric. Eyeson Toxicity levels are compared with EvilSeed [35]
where applicable.
Original URL
http://www.linuxforums.org/forum/red-hat-fedora-linux/8945-redhat-8-updates-cd-post48470.html
http://www.linuxforums.org:80/forum/servers/198002-postﬁx-relayhost-transport-maps-cuestion.html/
http://iie.com/events/event_ detail.cfm?eventid=132
http://bookstore.iie.com/merchant.mvc?screen=prod& product_ code=35
Generalized URL
http://linuxforums.org/forum/red-hat-fedora-linux/
http://iie.com/events/
http://bookstore.iie.com/merchant.mvc
Table 11: URL generalization examples. The above examples show that URL parameters are dropped when found. Also, ﬁle names are dropped when a path
exists, otherwise ﬁle name is kept.
HTTP URLs of the rendered archived visit. Since the rendering
of the archived snapshot is through a browser, some dynamic re-
quests might be generated at the time of the snapshot rendering
in real time (e.g. The GoogleAnalytics URL shown in the table).
These real time URLs can be clearly distinguished from archived
URL through the use of the domain archive.org in the URL.
Additionally, the example shown in Table 12 is actually a snapshot
captured during a watering hole attack, evident from the request
to the malicious IP 74.207.254.87. At the time the archive.org at-
tempted to crawl the malicious request, it was taken down already
and thus the subsequent malicious requests described in the report
[53] were not observed here in the archived visit. Still, the begin-
ning of the compromise chain (i.e. request to http://74.207.254.87)
was captured since the Forbes home page was still compromised at
the time of archive crawling and thus this request would be detected
by Eyeson as a signiﬁcant change.
Archive Data Collection. We searched the archive.org for the tar-
get list of 121,651 FQDNs and collected over 1 million archive
URLs. Unfortunately, many of the URLs had only one snapshot
but most of them differ only in the URL arguments or ﬁle names.
For example forum websites such as linuxforums.org have a unique
URL for each post where the postID is passed as part of the ﬁle
name. But all the posts (with different URLs) cause similar HTTP
trafﬁc once being visited as they use the same content manage-
ment system and styling templates (e.g. vbulletin). In order
to correlate the visits to those URLs (so the changes on them can
be observed from multiple snapshots), we generalized URLs by re-
moving their parameters and ﬁle names when the URLs all contain
the same paths as illustrated in Table 11. In our study, we collected
such generalized archive URLs for 61K FQDNs from the identiﬁed
potential targets. The remaining domains either never showed up
in the archives or had less than 10 snapshots and as such could not
be proﬁled or monitored.
We further implemented a dynamic crawler as a Firefox exten-
sion and deployed it to a number of Virtual Machines (VMs). We
instrumented our crawlers to crawl the collected list of archive URLs
and capture all rendered HTTP requests generated from the visits.
In addition to such archive HTTP trafﬁc, we conducted our own
real time monitoring of a small number of domains, speciﬁcally
those in the manually selected list of FQDNs. A summary of the
collected archive HTTP trafﬁc is provided in Table 2.
7. REFERENCES
[1] Ad blocking with ad server hostnames and ip addresses. pgl.yoyo.org/as.
[2] Cve cve2008-2463 details.
http://www.cvedetails.com/cve-details.php?t=1&cve_id=CVE2008-2463.
[3] Dns bh, malware domain blocklist. www.malwaredomains.com/.
[4] Farsight security information exchange. https://api.dnsdb.info/.
[5] hphosts. www.hosts-ﬁle.net/.
[6] Malc0de database. http://malc0de.com/database/.
[7] Malware domains list. http://www.malwaredomainlist.com/.
[8] Most valuable professional. http://www.mvps.org/.
[9] Project honey pot. https://www.projecthoneypot.org/.
[10] Rockland trust. https://www.rocklandtrust.com/.
[11] Sucuri. https://sitecheck.sucuri.net.
[12] Tor project: Anonymity online. https://www.torproject.org/.
[13] Viruswatch – viruswatch watching adress changes of malware URL’s.
http://lists.clean-mx.com/cgi-bin/mailman/listinfo/viruswatch/.
[14] Js hijacking. http://jzking121.blog.51cto.com/5436671/1306505, Oct 2013.
[15] 2014 hong kong protests.
http://en.wikipedia.org/wiki/2014_Hong_Kong_protests, 2014.
[16] Javascript keylogger - pastebin.com. http://pastebin.com/XYGMqEsp, 2014.
[17] Scanbox javascript code – exploit packs. https://hiddencodes.wordpress.com/
2014/10/23/scanbox-javascript-code-exploit-packs/, 2014.
[18] Vulnerability summary for cve-2014-6332.
https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6332, 2014.
[19] Scanbox javascript code. http://weisuo.org/?post=131, 2015.
[20] AGGARWAL, C. Outlier analysis. Springer, 2013.
[21] ALEXA. Alexa top global sites. http://www.alexa.com/topsites, May 2015.
[22] BLASCO, J. Scanbox: A reconnaissance framework used with watering hole
attacks. https://www.alienvault.com/open-threat-exchange/blog/scanbox-a-
reconnaissance-framework-used-on-watering-hole-attacks/, 2014.
[23] BLASCOL, J. Watering holes exploiting jsonp hijacking to track users in china.
https://www.alienvault.com/blogs/labs-research/watering-holes-exploiting-
jsonp-hijacking-to-track-users-in-china, 2015.
[24] BORGOLTE, K., KRUEGEL, C., AND VIGNA, G. Delta: Automatic
Identiﬁcation of Unknown Web-based Infection Campaigns. In Proceedings of
the ACM Conference on Computer and Communications Security (2013), CCS
’13, ACM.
[25] BREUNIG, M. M., KRIEGEL, H.-P., NG, R. T., AND SANDER, J. LOF:
Identifying density-based local outliers. In Proceedings of the 20OO ACM
SIGMOD (2000), ACM.
[26] CANALI, D., AND BALZAROTTI, D. Behind the scenes of online attacks: an
analysis of exploitation behaviors on the web. In In Proceeding of the Network
and Distributed System Security Symposium (NDSS’13) (2013).
[27] CANALI, D., BALZAROTTI, D., AND FRANCILLON, A. The role of web
hosting providers in detecting compromised websites. In Proceedings of the
22nd international conference on World Wide Web (Republic and Canton of
Geneva, Switzerland, 2013), WWW ’13, International World Wide Web
Conferences Steering Committee, pp. 177–188.
[28] CANALI, D., COVA, M., VIGNA, G., AND KRUEGEL, C. Prophiler: a fast
ﬁlter for the large-scale detection of malicious web pages. In Proceedings of the
20th international conference on World wide web (New York, NY, USA, 2011),
WWW ’11, ACM, pp. 197–206.
[29] COX, A., ELISAN, C., GRAGIDO, W., HARRINGTON, C., AND MCNEILL,
JON MCNEILL, J. The voho campaign: an in depth analysis.
https://blogs.rsa.com/wp-content/uploads/2014/10/
VOHO_WP_FINAL_READY-FOR-Publication-09242012_AC.pdf, Sept 2012.
[30] DOMAN, C., AND LANCASTER, T. Scanbox framework – who’s affected, and
#
1
2
78
139
163
URL
http://web.archive.org/web/20141128132335/http://www.forbes.com/
http://web.archive.org/web/20141128132335js_/http://images.forbes.com/scripts/js_options.js
type
Start URL
Embeded request
http://web.archive.org/web/20141128132335im_/http://i.forbesimg.com/media/lists/people/
charles-koch_50x50.jpg
...
...
http://web.archive.org/web/20141129083743/http://74.207.254.87
http://www.google-analytics.com/analytics.js
...
Embeded request
Embeded request
Embeded request
Comment
Archive visit starts
Archive URL
Other embeded requests
Archive URL
Other embeded requests
Malicious Archive URL.
Server responded with 403
None archive URL.
Dynamic URL not captured by the Archive
Other embeded requests
Table 12: Archived snapshot of forbes.com during a water hole attack on it [53]
[48] MIMOSO, M. ios developer site at core of facebook, apple watering hole attack.
https://threatpost.com/ios-developer-site-core-facebook-apple-watering-hole-
attack-022013/77546/, 2013.
[49] MOORE, T., AND CLAYTON, R. Financial cryptography and data security.
Springer-Verlag, Berlin, Heidelberg, 2009, ch. Evil Searching: Compromise
and Recompromise of Internet Hosts for Phishing, pp. 256–272.
[50] PAPADIMITRIOU, S., KITAGAWA, H., GIBBONS, P., AND FALOUTSOS, C.
LOCI: fast outlier detection using the local correlation integral. In Proceedings
of the IEEE International Conference on Data Engineering (ICDE) (2003),
IEEE.
[51] PERLROTH, N. Chinese hackers circumvent popular web privacy tools.
http://www.nytimes.com/2015/06/13/technology/chinese-hackers-circumvent-
popular-web-privacy-tools.html, 2015.
[52] PETNEL, R. Easylist. https://easylist-downloads.adblockplus.org/easylist.txt.
[53] RESEARCH, I. Chinese espionage campaign compromises forbes.com to target
us defense, ﬁnancial services companies in watering hole style attack.
http://www.invincea.com/2015/02/chinese-espionage-campaign-compromises-
forbes/, 2015.
[54] RESPONSE, S. S. The elderwood project.
http://www.symantec.com/connect/blogs/elderwood-project/, 2012.
[55] SALMI, D. “watering hole” attacks targeting political sites. https:
//blog.avast.com/2013/01/07/watering-hole-attacks-targeting-political-sites/,
2013.
[56] SEGURA, J. Domain shadowing with a twist. https://blog.malwarebytes.org/
malvertising-2/2015/04/domain-shadowing-with-a-twist/, 2015.
[57] SPOHN, M. Know your digital enemy. http://www.mcafee.com/us/resources/
white-papers/foundstone/wp-know-your-digital-enemy.pdf, March 2012.
[58] STEVENSON, A. Chinese spooks hit tor and vpn users with watering hole cyber
attacks. http://www.v3.co.uk/v3-uk/news/2413082/chinese-spooks-hit-tor-and-
vpn-users-with-watering-hole-cyber-attacks, 2015.
[59] TEODORESCU, M. Hackers used a chinese restaurant menu to breach a big oil
company intranet. http://www.electronicproducts.com/Computer_Systems/
Servers/Hackers_used_a_Chinese_restaurant_menu_to-
_breach_a_big_oil_company_s_intranet.aspx, 2014.
[60] THONNARD, O., BILGE, L., O’GORMAN, G., KIERNAN, S., AND LEE, M.
Industrial espionage and targeted attacks: Understanding the characteristics of
an escalating threat. In Proceedings of the 15th International Conference on
Research in Attacks, Intrusions, and Defenses (Berlin, Heidelberg, 2012),
RAID’12, Springer-Verlag, pp. 64–85.
[61] VASEK, M., AND MOORE, T. Identifying risk factors for webserver
compromise. In Financial Cryptography and Data Security (March 2014),
vol. 8437 of Lecture Notes in Computer Science, Springer, pp. 326–345.
[62] VIRUSTOTAL. Virustotal - free online virus, malware and URL scanner.
https://www.virustotal.com/, 2013.
[63] VIRUSTOTAL. Virustotal - free online virus, malware and URL scanner.
https://www.virustotal.com/en/ﬁle/
110bf923b8617045fafa7a35a9a9e0878d87b1a3b9fb3c8bd1fdab7907259c8d/
analysis//, 2015.
[64] YUN, C. Baidu, ali, tencent use jsonp to hijack user tracking.
http://www.freebuf.com/articles/web/70025.html, 2015.
who’s using it? http://pwc.blogs.com/cyber_security_updates/2014/10/
scanbox-framework-whos-affected-and-whos-using-it-1.html/, 2014.
[31] DOMAN, C., AND LANCASTER, T. A deeper look into scanbox. http://pwc.
blogs.com/cyber_security_updates/2015/02/a-deeper-look-into-scanbox.html/,
2015.
[32] GROSSMAN, J. Advanced web attack techniques using gmail.
http://jeremiahgrossman.blogspot.de/2006/01/advanced-web-attack-
techniques-using.html, Jan 2006.
[33] HARDY, S., CRETE-NISHIHATA, M., KLEEMOLA, K., SENFT, A., SONNE,
B., WISEMAN, G., GILL, P., AND DEIBERT, R. J. Targeted threat index:
Characterizing and quantifying politically-motivated targeted malware. In
Proceedings of the 23rd USENIX Conference on Security Symposium (Berkeley,
CA, USA, 2014), SEC’14, USENIX Association, pp. 527–541.
[34] HUTCHINS, E., CLOPPERTY, M., AND AMIN, R. Intelligence-driven computer
network defense informed by analysis of adversary campaigns and intrusion kill
chains. In Proc. 6th Annual International Conference on Information Warfare
and Security (2011).
INVERNIZZI, L., BENVENUTI, S., COVA, M., COMPARETTI, P. M.,
KRUEGEL, C., AND VIGNA, G. Evilseed: A guided approach to ﬁnding
malicious web pages. In Proceedings of the 2012 IEEE Symposium on Security
and Privacy (Washington, DC, USA, 2012), SP ’12, IEEE Computer Society,
pp. 428–442.
[35]
[36] JOHN, J. P., YU, F., XIE, Y., KRISHNAMURTHY, A., AND ABADI, M. deseo:
combating search-result poisoning. In Proceedings of the 20th USENIX
conference on Security (Berkeley, CA, USA, 2011), SEC’11, USENIX
Association, pp. 20–20.
[37] KINDLUND, D. Cfr watering hole attack details.
https://www.ﬁreeye.com/blog/threat-research/2012/12/council-foreign-
relations-water-hole-attack-details.html, 2012.
[38] KREBS, B. Anthem breach may have started in april 2014. http://
krebsonsecurity.com/2015/02/anthem-breach-may-have-started-in-april-2014/,
2014.
[39] LE BLOND, S., URITESC, A., GILBERT, C., CHUA, Z. L., SAXENA, P., AND
KIRDA, E. A look at targeted attacks through the lense of an ngo. In
Proceedings of the 23rd USENIX Conference on Security Symposium (Berkeley,
CA, USA, 2014), SEC’14, USENIX Association, pp. 543–558.
[40] LEE, M., AND LEWIS, D. Clustering disparate attacks: Mapping the activities
of the advanced persistent threat. In Virus Bulletin Conference (2011), VB’11.
[41] LEONTIADIS, N., MOORE, T., AND CHRISTIN, N. Measuring and analyzing
search-redirection attacks in the illicit online prescription drug trade. In
Proceedings of the 20th USENIX conference on Security (Berkeley, CA, USA,
2011), SEC’11, USENIX Association, pp. 19–19.
[42] LI, F., LAI, A., AND DDL, D. Evidence of advanced persistent threat: A case
study of malware for political espionage. In Proceedings of the 2011 6th
International Conference on Malicious and Unwanted Software (Washington,
DC, USA, 2011), MALWARE ’11, IEEE Computer Society, pp. 102–109.
[43] LI, Z., ALRWAIS, S., WANG, X., AND ALOWAISHEQ, E. Hunting the red fox
online: Understanding and detection of mass redirect-script injections. In
Proceedings of the 2014 IEEE Symposium on Security and Privacy
(Washington, DC, USA, 2014), SP ’14, IEEE Computer Society, pp. 3–18.
[44] LI, Z., ALRWAIS, S., XIE, Y., YU, F., AND WANG, X. Finding the linchpins
of the dark web: a study on topologically dedicated hosts on malicious web
infrastructures. In Proceedings of the 2013 IEEE Symposium on Security and
Privacy (Washington, DC, USA, 2013), SP ’13, IEEE Computer Society,
pp. 112–126.
[45] MANDIANT. APT1: Exposing one of China’s cyber espionage units. Report
available from www.mandiant.com, 2013.
[46] MARCZAK, W. R., SCOTT-RAILTON, J., MARQUIS-BOIRE, M., AND
PAXSON, V. When governments hack opponents: A look at actors and
technology. In Proceedings of the 23rd USENIX Conference on Security
Symposium (Berkeley, CA, USA, 2014), SEC’14, USENIX Association,
pp. 511–525.
[47] MICROSOFT. Microsoft security essentials. http://http:
//windows.microsoft.com/en-us/windows/security-essentials-download/, 2013.