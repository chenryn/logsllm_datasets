### 初学者的困惑与可行性
对于初学者而言，上述提到的各种方法可能显得相当复杂。或许有人会质疑这些操作是否切实可行。实际上，它们是完全可行的。Virgil是一位极其优秀的程序员，并且拥有大量的空闲时间来完成这些任务。读者可以通过查阅本地报纸了解更多信息。

### 病毒传播机制
病毒的传播依赖于多种条件。让我们从最传统的方式开始讨论。假设Virgil编写了一个病毒，并将其嵌入到他自己的程序（或盗取来的程序）中，随后将该程序上传至共享软件站点。最终，用户下载并运行了这个程序。此时，有几种可能性会出现：病毒可能会感染硬盘上的大多数文件，其中一些文件可能被用户分享给朋友；或者病毒也可能试图感染硬盘的引导扇区。一旦引导扇区被感染，病毒便可以在核心态下植入内存驻留病毒。

如今，Virgil可以利用更多途径进行病毒传播。例如，他可以通过病毒程序检查受感染计算机是否连接到了局域网（如公司或大学网络）。接着，病毒可以通过该局域网感染所有未受保护的服务器文件。这种感染不会波及已被保护的文件，但会导致被感染文件运行异常。当用户向系统管理员求助时，如果管理员使用超级用户权限登录，病毒则有机会感染系统代码、设备驱动程序、操作系统乃至引导扇区。如此一来，整个局域网的安全都将受到威胁。

此外，局域网中的计算机通常具备通过互联网或私有网络远程登录其他计算机的能力，甚至无需登录即可执行远程命令。这为病毒提供了更多的传播机会。因此，一个小小的错误就可能导致整个公司的计算机系统被感染。为了防止这种情况发生，所有组织都应制定统一策略以避免系统管理员犯错。

另一种常见的病毒传播方式是在经常发布程序的USENET新闻组或网站上散布已感染病毒的程序。也可以创建需要特定浏览器插件才能访问的网页，并确保该插件已被病毒感染。

还有一种攻击手段是通过电子邮件或USENET新闻组发送携带病毒的文档附件。人们往往不会怀疑来自朋友或同事的邮件，而一旦打开附件，病毒就会释放并在计算机上激活。更糟糕的是，病毒能够搜索用户的联系人列表，并将自己转发给所有联系人，通常采用看似合法或有趣的邮件主题。例如：
- 更改计划
- 回复：上一封邮件
- 昨晚狗狗去世了
- 我病得很重
- 我爱你

2000年6月，“我爱你”病毒正是利用这种方法在全球范围内迅速传播，造成了数十亿美元的损失。

### 病毒技术传播与逃避检测
病毒技术的传播也值得关注。互联网上有多个病毒制造小组积极交流，互相帮助开发新技术、工具和病毒。虽然这些人大多是对病毒感兴趣的个人而非职业罪犯，但他们造成的后果却可能是灾难性的。另一类病毒制造者是军人，他们将病毒视为潜在的战争武器，用于破坏敌方的计算机系统。

逃避检测同样是病毒传播的一个重要方面。为了避免被捕，Virgil可能选择在偏远城市的网吧上网，或者通过远程FTP站点放置病毒。他还可能携带笔记本电脑连接到网吧的以太网或USB端口，从而利用网吧的服务设施每天查看电子邮件。关于病毒如何隐藏自身以及杀毒软件如何发现病毒，我们将在本章后续部分进一步探讨。

### 蠕虫的历史与影响
1988年11月2日，Cornell大学毕业生Robert Tappan Morris在互联网上发布了一种蠕虫程序，导致全球数千台大学、企业和政府实验室的计算机瘫痪。这一事件引发了广泛的争议。具体的技术细节可参考Spafford的论文（1989版），而警方对此事件的描述则收录在Hafner和Markoff的书中（1991版）。

Morris发现了Berkeley大学UNIX系统中的两个漏洞，使他能够未经授权访问互联网上的所有计算机。经过数月的努力，他编写了一个能够自我复制的程序——蠕虫。蠕虫利用UNIX系统的漏洞，在几秒钟内自我复制并迅速传播。尽管目前尚不清楚这次事件是实验还是真正的攻击，但蠕虫确实让大多数Sun和VAX系统在数小时内崩溃。Morris的动机至今仍是个谜，也许这只是他开的一个高科技玩笑，但由于编程错误导致局势失控。

从技术角度来看，蠕虫由两部分组成：引导程序和蠕虫本身。引导程序是一个名为l1.c的99行程序，它在目标计算机上编译并运行。一旦启动，它会在源计算机与宿主机之间建立连接，上传蠕虫主体并运行。隐藏自身后，蠕虫会检查新宿主机的路由表，以确定其是否连接到其他机器，并通过这种方式将引导程序传播到所有相连的机器。

蠕虫在感染新机器时有三种方法：
1. **rsh命令**：尝试使用rsh命令运行远程shell程序。如果成功，远程shell会上传蠕虫主体并继续感染新的计算机。
2. **finger程序**：利用finger守护进程的缓冲区溢出漏洞，通过精心构造的536字节字符串覆盖守护进程的缓冲区和栈，从而控制被攻击计算机上的shell。
3. **sendmail程序**：利用sendmail程序的漏洞，允许蠕虫发送引导程序的副本并运行。

蠕虫还会尝试破解用户密码。Morris并没有在这方面做大量研究，而是参考了其父亲（美国国家安全局的安全专家）十年前的一篇经典论文。每个被破解的密码都允许蠕虫登录到任何具有该密码的账户的计算机上。

每次蠕虫访问新机器时，它都会检查是否有其他版本的蠕虫已经存在。如果有，新蠕虫通常会退出，但在七次中有一次不会退出，即使系统管理员启动了旧蠕虫来欺骗新蠕虫也是如此。结果，七次访问中的一次产生了过多的蠕虫，导致所有被感染机器停机。

Morris的朋友试图向《纽约时报》记者John Markoff解释整个事件是个意外，但Morris最终还是被捕了。他被联邦法院判处罚款10,000美元，三年监外察看和400小时社区服务。这一判决引发了广泛争议。许多人认为他只是一个聪明的研究生，恶作剧超出了控制。而其他人则认为Morris是一个严重的罪犯，应该坐牢。Morris后来在哈佛大学获得了博士学位，并成为麻省理工学院的教授。

这一事件导致了计算机应急响应团队（CERT）的成立，这是一个发布病毒入侵报告的中心机构，拥有多名专家分析安全问题并设计补丁程序。然而，某些别有用心的人也可能获取这些信息，并在漏洞修复之前寻找入侵途径。

自Morris蠕虫出现以来，越来越多的蠕虫病毒出现在网络上。这些蠕虫利用不同软件的不同漏洞进行传播，由于它们能够自我复制，扩散速度比传统病毒更快。因此，越来越多的反蠕虫技术被开发出来，旨在尽早发现并阻止蠕虫的传播。

### 间谍软件的定义与分类
间谍软件是一种快速扩散的恶意软件，它在用户不知情的情况下加载到PC上，并在后台执行超出用户意愿的操作。然而，要准确定义间谍软件却相当微妙。例如，Windows自动更新程序和许多反病毒软件也会在后台自动更新，但这些情况并不被认为是间谍软件。

Barwinski等人提出了间谍软件的四个特征：
1. **隐藏性**：难以被用户轻易找到。
2. **数据收集**：收集用户的数据（如访问过的网址、密码或信用卡号）。
3. **数据传输**：将收集到的信息发送给远程监控者。
4. **卸载防御**：在卸载过程中进行防御。

Barwinski等人将间谍软件分为三大类：
1. **营销用途**：简单地收集信息并发送给控制者，以更好地定向广告。
2. **监视用途**：某些公司故意在员工的电脑上安装间谍软件，以监视他们的活动。
3. **恶意用途**：被感染的电脑成为僵尸网络的一部分，等待控制者的指令。

一项实验通过访问5,000个网站来检测哪些网站含有间谍软件，结果显示这些网站主要涉及成人娱乐、盗版软件和在线旅行。华盛顿大学的一项更广泛的调查显示，约有18,000,000个URL被感染，其中6%含有间谍软件。AOL/NCSA的调查也显示，接受调查的家庭计算机中有80%受到间谍软件的影响，平均每台计算机有93个此类软件。华盛顿大学的调查发现，成人、明星和桌面壁纸相关的网站感染率最高，但没有调查旅行相关网站的情况。