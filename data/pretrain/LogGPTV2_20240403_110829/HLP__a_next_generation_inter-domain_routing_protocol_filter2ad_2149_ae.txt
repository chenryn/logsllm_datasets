should be of one kind: LSAs or FPVs; (b) All LSAs for the
same link should have the same cost.
One simple way to implement these consistency checks
would be to ﬂood HLP messages to all routers within the
AS. Alternatively, one could use a centralized routing control
platform (RCP) as envisioned by Caesar et al. [4].
6.2 HLP software router implementation
HLP has been implemented as a module that ﬁts in the
eXtensible Open Router Platform (XORP) software router [2].
Our current implementation supports all the features in the
basic HLP design including many of the policy extensions
such as exceptions and backup links.
Hierarchy Size
LSA proc. time
100
0.0052
300
0.0153
500
0.0252
700
0.037
1000
0.052
Table 4: AS hierarchy size vs LSA processing time
(sec).
# of AS’s
FPV proc. rate
1000
5270
5000
3154
10000
1989
15000
1452
20000
1132
Table 5: # of AS’s vs FPV processing rate (up-
dates/sec)
6.2.1 Overhead characteristics
Two of the most common operations in a HLP router are
the processing of LSA updates and FPV updates. Tables 4
and 5 illustrate the LSA processing time and FPV through-
put that can be obtained from our implementation. These
measurements were performed on a 2.4 GhZ Intel processor
with 1 GB memory. Though our implementation has not
been optimized for performance, these measurements indi-
cate that a naive implementation can handle today’s BGP
workload. First, the complexity of LSA processing due to
the recomputation of shortest paths to destinations and our
numbers match with those reported in prior OSPF stud-
ies [26, 4]. However, in reality, we anticipate the number
of LSAs within a given second to be very small since each
event (e.g., link failure) is captured within a single LSA mes-
sage (unlike BGP which generates many updates due to a
single event). Also, we anticipate the frequency of link-cost
changes to be small e.g., as a comparison, a stub network
that continuously deaggregates preﬁxes propagates at most
one update every 30 seconds [5]. Second, the FPV process-
ing rate that we can support for a hierarchy of size 20000
is at least 10 times greater than the maximum update rate
observed in a BGP router today [1].
6.2.2
Implementation lessons
The experience of building a full-ﬂedged prototype of HLP
made us carefully think through the router level behavior
of HLP and determine how it diﬀers from BGP and what
additional mechanisms a HLP router requires. Three im-
plementation aspects are noteworthy. First, the base code
of HLP has many similarities to BGP and reuses more than
90% of the XORP BGP implementation. This illustrates the
ease of implementing HLP using existing BGP code. Sec-
ond, to make HLP work at the router level, we had to revisit
the HLP design and deﬁne the necessary set of consistency
checks required in iHLP. Third, one had to be careful in han-
dling exceptions at the router level especially to avoid excep-
tion inconsistencies between routers e.g., one router chooses
a customer route while another does not. This requires a
router to keep track of the exceptions in other routers and
declare an exception only in the presence of consensus.
Transition from BGP to HLP: One of the important lessons
that arose from the implementation is a simple transition
plan from BGP to a simpliﬁed version of HLP which merely
changes the current operational practices of BGP. The idea
is to setup a two level hierarchy separating transit networks
and stub networks into diﬀerent levels and using only the
transit-stub links as the set of published provider-customer
links. Using BGP routing information, every AS can in-
dependently infer this two-level hierarchy with high accu-
racy [27, 9, 19]. In this hierarchy, links between transit net-
works execute BGP (this models the FPV aspect of HLP)
and all transit networks are required to install ﬁlters to al-
low a stub network only to originate route announcements
and not act as transit networks. Stub networks can signal
link costs using AS path prepending.
This simple deployment provides several beneﬁts. First,
since stub networks account for a majority of AS’s and their
growth rate is higher than that of transit networks, this
separation does provide improved scalability and isolation
properties than BGP. Second, we minimize the possibility
of misconﬁgurations since many stub networks are largely
unmanaged and we minimize the knobs at the disposal of
these networks. Third, routes between transit networks are
relatively stable [5] and this stability cannot be aﬀected by
stub AS’s.
7. RELATED WORK
We classify related work into two categories:
New Internet architectures: Several new Internet architec-
tures have been proposed to address pressing problems in
Internet routing. The Newarch project proposed NIRA [31]
which advocates better end-host control over routing.
In
NIRA, an end-host has the ability to choose the sequence of
providers its packets traverse. Feedback based routing [32]
is an alternate design for replacing Internet routing where
edge network compute an approximate topology map of the
Internet at an AS-level based on measurement-based feed-
back from the network. It then uses this state to compute
the shortest path and source routes the packets by encap-
sulating the route in the packet. While many such routing
architectures exist outside the realm of BGP, the primary
motivation for our work is the search of a protocol that com-
pletely retains the operational and economic model of BGP
but only alters the route propagation model to address the
pressing deﬁciencies of BGP. In this regard, the proposed
set of guidelines for next-generation routing protocols from
IRTF [15] provided a good starting point in our design.
Changes to the BGP protocol: HLP aims to provide im-
proved scalability/isolation, diagnosis support, convergence
and security. There have been several works that have pro-
posed incremental changes to BGP to achieve these ends.
Afek et al. [3] propose grouping preﬁxes with similar behav-
ior into policy atoms, which can be dealt with as an aggre-
gate in an attempt to reduce overhead. BGP-RCN [23] is a
proposed modiﬁcation that embeds BGP updates with the
location where updates are triggered; this information can
be used to greatly improve both the convergence and diagno-
sis properties of the protocol. BGP’s poor convergence prop-
erties come from a variety of causes [21]. Worse still, certain
combinations of BGP policies lead to divergence [12]. The
authors of [10] propose a set of policy guidelines that guar-
antees routing convergence. Secure-BGP [16] and Secure-
origin BGP [25] are two well known proposals to improve
the security of BGP. Subramanian et al. [29] and Chu et
al. [14] have recently proposed two alternative mechanisms
to improve the security of BGP while alleviating some of the
deployment hurdles of a PKI.
8. CONCLUSIONS
Designing an inter-domain routing protocol is a very chal-
lenging task, in part because it is diﬃcult to design routing
systems that scale globally, and in part because the range
of policies that needs to be supported is ill-deﬁned. BGP,
a speciﬁc point in the design space supports a wide range
of policies at the expense of poor scalability, fault isolation
and convergence properties. In designing HLP, we started
from the observation that to do better than BGP, we needed
to make use of information that BGP does not have. The
only policy information that inherently does not suﬀer from
serious privacy issues is that of provider-customer relation-
ships, and this is simply because this information cannot
be a secret for routing to function. Having this information
available in the protocol itself led directly to the observation
that in sizable parts of the AS hierarchy we could use link-
state style algorithms, which solve many of the problems
exhibited by BGP. But between these regions, link-state is
not viable due to policy-privacy issues, which forces us to-
wards a hybrid link-state/path-vector solution. Separation
of preﬁx-binding from topology discovery is a further step
towards reducing routing protocol overhead, and also to-
wards using appropriate security solutions for the diﬀerent
parts of the problem. The resulting protocol has many very
desirable properties, including fast convergence, good fault
isolation, lower routing table churn, and inherently better
security and robustness.
However, just because a protocol has good routing prop-
erties does not mean that it solves the problem in a way
that is economically viable for ISPs. Unfortunately no sin-
gle person knows the big picture of what an inter-domain
policy routing protocol needs to do in reality. This makes
evaluation especially hard. In this paper we have tried to
examine not only the basic properties of convergence, fault
isolation and scalability, but also examine many of the ways
BGP is used with the aim of understanding how well HLP
solves the same tasks. Our present level of understanding is
that HLP measures up rather well against BGP in a large
range of deployment scenarios, but only by exposing the de-
sign to a wide range of ISPs and router vendors will we learn
the full story.
We are under no illusion that HLP is poised to replace
BGP any time soon, but only by putting a stake in the
ground can we hope to stimulate informed debate about
both the requirements for and the design of future inter-
domain routing.
9. REFERENCES
[1] http://ipmon.sprint.com.
[2] The eXtensible Open Router Platform (xorp).
http://www.xorp.org.
[3] Afek, Y., Ben-Shalom, O., and Bremler-Barr, A. On the
structure and application of BGP policy Atoms. In IMW
(2002).
[4] Caesar, M., Caldwell, D., Feamster, N., Rexford, J., Shaikh,
A., and van der Merwe, J. Design and implementation of a
routing control platform. ACM/USENIX NSDI (2005).
[5] Caesar, M., Subramanian, L., and Katz, R. H. Root cause
analysis of Internet routing dynamics. Tech. rep., U.C. Berkeley
UCB/CSD-04-1302, 2003.
[6] Chang, D.-F., Govindan, R., and Heidemann, J. The temporal
and toplogical characteristics of BGP path changes. In Proc.
International Conference on Network Protocols (2003).
[7] Feamster, N., Borkenhagen, J., and Rexford, J. Guidelines for
interdomain traﬃc engineering. ACM Computer
Communication Review (2003).
[8] F.Wang, and Gao, L. Inferring and Characterizing Internet
Routing Policies. In Proceedings of ACM IMC 2003 (2003).
[9] Gao, L. On inferring automonous system relationships in the
internet. IEEE/ACM Trans. Networking (to appear 2004).
[10] Gao, L., and Rexford, J. Stable Internet routing without
global coordination. In Proc. ACM SIGMETRICS (2001).
[11] Griffin, T. What is the Sound of One Route Flapping?, 2002.
IPAM talk.
[12] Griffin, T. G., Shepherd, F. B., and Wilfong, G. Policy
disputes in path vector protocols. In Proc. International
Conference on Network Protocols (1999).
[13] Griffin, T. G., and Wilfong, G. An analysis of BGP
convergence properties. In Proc. ACM SIGCOMM (1999).
[14] Hu, Y. C., Sirbu, M., and Perrig, A. Spv: Secure path vector
routing for securing BGP. In Proc. ACM SIGCOMM (2004).
[15] IRTF Routing Research Group. http://www.irtf.org/rrg/.
[16] Kent, S., Lynn, C., and Seo, K. Secure Border Gateway
Protocol (Secure-BGP). IEEE Journal on Selected Areas of
Communications 18, 4 (April 2000), 582–592.
[17] Labovitz, C., Ahuja, A., Bose, A., and Jahanian, F. Delayed
Internet Routing Convergence. In Proc. ACM SIGCOMM
(2000).
[18] Labovitz, C., Malan, R., and Jahanian, F. Origins of Internet
routing instability. In Proc. IEEE INFOCOM (1999).
[19] Mahajan, R., Wetherall, D., and Anderson, T. Understanding
BGP Misconﬁgurations. In Proceedings of ACM SIGCOMM
(2002).
[20] Mahajan, R., Wetherall, D., and Anderson, T.
Negotiation-based routing between neighboring domains. In
Proceedings of ACM/USENIX NSDI (2005).
[21] Mao, Z. M., Bush, R., Griffin, T. G., and Roughan, M. BGP
beacons. In Proc. ACM Internet Measurement Conference
(2003).
[22] Mao, Z. M., Govindan, R., Varghese, G., and Katz, R. Route
ﬂap damping exacerbates Internet routing convergence. In
Proc. ACM SIGCOMM (2002).
[23] Pei, D., Azuma, M., Nguyen, N., Massey, J. C. D., and Zhang,
L. Bgp-rcn: Improving bgp convergence through root cause
notiﬁcation. Technical Report, UCLA CSD TR-030047 (2003).
[24] RIPE’s Routing Information Service Raw Data Page.
http://data.ris.ripe.net/.
[25] Secure Origin BGP (soBGP). ftp://ftp-eng.cisco.com/sobgp.
[26] Shaikh, A., and Greenberg, A. OSPF Monitoring:
Architecture, Design and Deployment Experience. In
Proceedings of ACM/USENIX NSDI (2004).
[27] Subramanian, L., Agarwal, S., Rexford, J., and Katz, R. H.
Characterizing the Internet Hierarchy from Multiple Vantage
Points. In Proceedings of IEEE INFOCOM (2002).
[28] Subramanian, L., Caesar, M. C., Ee, C., Handley, M., Mao, Z.,
Shenker, S., and Stoica, I. HLP: A Next Generation
Inter-domain Routing Protocol, November 2004. UC Berkeley
Technical Report No. CSD-04-1357.
[29] Subramanian, L., Roth, V., Stoica, I., Shenker, S., and Katz,
R. Listen and Whisper: Security Mechanisms in BGP. In
Proceedings of ACM/ USENIX NSDI (2004).
[30] University of Oregon RouteViews project.
http://www.routeviews.org/.
[31] Yang, X. Nira: a new internet routing architecture. ACM
SIGCOMM FDNA workshop (2003).
[32] Zhu, D., Gritter, M., and Cheriton, D. Feedback based
routing. ACM Hotnets Workshop (2002).