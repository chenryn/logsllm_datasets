title:Under the Shadow of Sunshine: Understanding and Detecting Bulletproof
Hosting on Legitimate Service Provider Networks
author:Sumayah A. Alrwais and
Xiaojing Liao and
Xianghang Mi and
Peng Wang and
Xiaofeng Wang and
Feng Qian and
Raheem A. Beyah and
Damon McCoy
2017 IEEE Symposium on Security and Privacy
Under the Shadow of Sunshine: Understanding and
Detecting Bulletproof Hosting on Legitimate Service
Provider Networks
Sumayah Alrwais1,2, Xiaojing Liao3, Xianghang Mi1, Peng Wang1, XiaoFeng Wang1, Feng Qian1,
Raheem Beyah3 and Damon McCoy4
1Indiana University, Bloomington.{salrwais, xmi, pw7, xw7}@indiana.edu
2King Saud University, Riyadh, Saudi Arabia. PI:EMAIL
3Georgia Institute of Technology.{xliao, rbeyah}@gatech.edu
4New York University. PI:EMAIL
is resilient
infrastructure that
Abstract—BulletProof Hosting (BPH) services provide crim-
inal actors with technical
to
complaints of illicit activities, which serves as a basic building
block for streamlining numerous types of attacks. Anecdotal
reports have highlighted an emerging trend of these BPH services
reselling infrastructure from lower end service providers (hosting
ISPs, cloud hosting, and CDNs) instead of from monolithic BPH
providers. This has rendered many of the prior methods of
detecting BPH less effective, since instead of the infrastructure
being highly concentrated within a few malicious Autonomous
Systems (ASes) it is now agile and dispersed across a larger set
of providers that have a mixture of benign and malicious clients.
In this paper, we present the ﬁrst systematic study on this
new trend of BPH services. By collecting and analyzing a large
amount of data (25 Whois snapshots of the entire IPv4 address
space, 1.5 TB of passive DNS data, and longitudinal data from
several blacklist feeds), we are able to identify a set of new
features that uniquely characterizes BPH on sub-allocations and
are costly to evade. Based upon these features, we train a classiﬁer
for detecting malicious sub-allocated network blocks, achieving
a 98% recall and 1.5% false discovery rates according to our
evaluation. Using a conservatively trained version of our classiﬁer,
we scan the whole IPv4 address space and detect 39K malicious
network blocks. This allows us to perform a large-scale study of
the BPH service ecosystem, which sheds light on this underground
business strategy,
including patterns of network blocks being
recycled and malicious clients migrating to different network
blocks, in an effort to evade IP address based blacklisting. Our
study highlights the trend of agile BPH services and points
to potential methods of detecting and mitigating this emerging
threat.
I.
INTRODUCTION
BulletProof Hosting (BPH) services rent out servers and
networking infrastructure that will persist in the face of take-
down attempts and complaints of illicit activities. This BPH
infrastructure is a basic building block of the cyber-crime
ecosystem. BPH is used by attackers as a stable base of
operations from which to conduct their illicit operations that
can run the whole gamut ranging from more risky activities,
such as hosting botnet command and controls, launching DDoS
attacks, and phishing pages to those less so, such as hosting
pirated media. Originally, BPH infrastructure was solely pro-
© 2017, Sumayah Alrwais. Under license to IEEE.
DOI 10.1109/SP.2017.32
805
vided by service providers1 who catered to criminal clients and
explicitly turned a blind eye to abuses emanating from their
networks. However, the static nature, high concentrations of
maliciousness, and reputation for not responding to abuse com-
plaints often cause these BulletProof (BP) service providers’
entire network allocations to become unilaterally blacklisted.
In addition to blacklisting, these BP service providers often
have difﬁculty ﬁnding peering points to provide stable network
connectivity and in extreme cases they have been completely
de-peered [1].
This increasing pressure on the monolithic BP service
providers has driven many of them to transform the way
they operate in order to evade these service provider (Au-
tonomous System or AS) reputation based defenses, such as
BGP Ranking [6] and ASwatch [7]. An anecdotally reported
emerging trend is that the BPH services are now establishing
reseller relationships with primarily lower-end hosting service
providers [2]. These hosting service providers are often not
complicit in supporting illicit activity, but rather either more
lenient on illicit behavior or simply not investing much effort
in proactively detecting or re-mediating malicious activities
on their networks [2]. These lower-end service providers offer
good cover for the BPH services, allowing them to leverage
the better reputation of the parent providers, and as a result
have a mix of both legitimate and BPH resellers, Figure 1
depicts this BPH ecosystem, which largely prevents unilateral
actions against the whole service provider. This type of BPH
infrastructure is not truly BP, since eventually the BPH service
will likely have to move their clients to new IP addresses
and network blocks. However, because the BPH service rents
instead of owns the infrastructure, this strategy enables them
to become more nimble and quickly move their clients when
they are detected.
Quickly and accurately detecting these nimble BPH ser-
vices that operate within lower-end service providers presents
new technical challenges. Unilaterally blacklisting these lower-
end service providers is not feasible in most cases due to
1We use the term “service provider” to refer to an entity that provides
hosting services. Examples could be a cloud hosting provider, Content
Delivery Network (CDN), Data Center (DC), Hosting Provider (HP) or an
Internet Service Provider (ISP).
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:21:58 UTC from IEEE Xplore.  Restrictions apply. 
in an effort to evade IP blacklisting. Additionally, we found
service providers attempting to re-brand their businesses by
creating many subsidiaries and ASes that delegate network
blocks between them (e.g. “ColoCrossing”).
• BPH Services. BPH services were registering as resellers
with service providers and crossing Whois registries, countries
and service providers by creating an abundance of Whois
registrations (and objects). This enabled them to represent
themselves as different entities with the service providers
and registries. Additionally, we tracked the BPH services’
movements from one service provider to another enabling the
restoration of their services as a result of take-down efforts by
parent service providers. Furthermore, we found these BPH
services registering and dropping network blocks frequently
allowing them to avoid IP blacklisting and delay take-down
attempts by parent service providers.
• BPH Clients. We tracked the clients of the BPH services
by analyzing the domains hosted on the network blocks and
found them to host a number of malicious activities rang-
ing from Command and Control systems to hosting pirated
content. Additionally, we tracked the movement of the clients
themselves through their domains and found many domains
moving between at least two network blocks allowing some
domains to survive for as long as 12 months before take-down.
Contributions. The contributions of the paper are organized
as follows:
• New features for detecting malicious sub-allocations. We
designed and implemented the ﬁrst technique to detect sub-
allocated malicious network blocks, achieving a 98% recall
and 1.5% false discovery rate. Our approach is based upon a
set of new features summarized over our analysis of a massive
amount of data (e.g., Whois, Passive DNS, blacklists, etc.)
as well as the ground truth collected through purchases. Of
particular interest is the observation that some DNS features,
such as churn, cannot be easily evaded by the BPH, due to the
reliance of their services on DNS.
• New methods for validating our detection results. We per-
formed a systematic validation of the detected sub-allocations,
which is well-known to be difﬁcult. Our validation included
conventional cross-validation on the labeled set, utilization of
multiple labeled sets with different qualities, identiﬁcation of
signals of malicious behaviors, and random sampling. This
effort ensures that the ﬁndings made by our system are of the
highest possible quality.
• The ﬁrst large-scale study on the modern BPH ecosystem.
Based upon our discoveries of malicious sub-allocations, we
performed a measurement study on the BPH ecosystem, at
an unprecedented scale. Our study reported 39K malicious
sub-allocations, distributed across 3,200 ASes and new ob-
servations of how these services operate and evade detection,
e.g., rotation of network blocks. These observations help us
better understand this new BPH trend, which is critical for the
ultimate elimination of this threat.
Roadmap. The rest of our paper is structured as follows. We
start by presenting a background on modern BPH and how
Whois IP address information is structured in Section II. Next,
we describe our approach detecting malicious sub-allocated
network blocks in Section III and our validation techniques
Fig. 1: BPH Ecosystem2.
the amount of collateral damage that blocking them would
cause. This forces Internet monitoring organizations to de-
tect and point-wise blacklist IP addresses. Such protection,
however, leads to a game of whack-a-mole, where blacklisted
IP addresses are made ephemeral by the ability of the BPH
services to move clients to new IP addresses when they are
blacklisted. What is required is the ability to peer into a service
provider and identify larger sets of IP addresses that have been
allocated to a reseller and quickly determine the reputation of
this address set. This will enable a middle ground between
the overly coarse-grain AS-level blacklisting and ﬁne-grain IP
address reputation approaches, which will improve our ability
to mitigate these emerging BPH service strategies.
Detecting malicious sub-allocations. To this end, we have
created a set of methods to accurately detect malicious IP
address network blocks. The ﬁrst of these methods enabled us
to identify sub-allocations of network blocks and their owners
using IP Whois information provided by all ﬁve Regional
Internet Registries (RIRs). Once we identiﬁed these sub-
allocated network blocks, we then created a small set of labeled
benign and malicious network blocks based on the manually
complied blacklists of network blocks from Spamhaus [3] and
lists of mostly benign network blocks based on a vetted subset
of network blocks from Alexa [4] and top hosting provider
lists [5]. Utilizing these labeled data-sets we were able to
discover 14 key features that can assist in detecting malicious
network blocks, based on three data sources: Whois, Passive
DNS (PDNS), and AS reputation lists. Using these features we
trained two classiﬁers, Support Vector Machines (SVM) and
Random Forest (RF), achieving a 98% recall and 1.5% false
discovery rates with a 5-fold cross-validation.
Findings. We ran a conservatively trained version of our
classiﬁer over all of the sub-allocations we found over a nine
month period and detected 39K malicious network blocks.
Based on these detected network blocks we were able to
conduct a large-scale analysis of the BPH service ecosystem.
From our analysis, we discovered previously-unknown patterns
characterizing the ecosystem of this BPH infrastructure as
follows:
• Parent Service Providers. Many legitimate service providers
were not responsive to complaints of abuse emanating from
their networks (e.g. “PEG TECH INC”). Others were con-
ducting their business in a manner highly indicative of com-
plicitness, such as aggressively recycling (rotating) network
blocks and moving clients to new network blocks possibly
2The image of the two faced man is obtained from clipartfest.com
806
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:21:58 UTC from IEEE Xplore.  Restrictions apply. 
in Section IV. We then conduct a large-scale analysis of the
BPH ecosystem based on the results of our classiﬁer in Section
V. In Section VI, we discuss the limitations of our detection
method and potential future research directions. Finally, we
present related prior research in Section VII and conclude in
Section VIII.
II. BACKGROUND
A. BulletProof Hosting
BulletProof Hosting services are a basic building block in
the cyber-crime ecosystem that offer a safe haven for miscre-
ants seeking to host all types of abusive content. Such services
are resilient (aka, bulletproof) in the face of take-down efforts.
This provides various protection mechanisms to their ill-willed
clients, contingent upon the BPH services, money invested by
their clients and the authoritative party involved. For example,
abuse complaints generated by network administrators and
ISPs can be simply ignored, while blacklisting by a highly
inﬂuential party such as SpamHaus [3] could cause the BPH
service to move the reported client(s) to a different network.
BPH services have many different structures. At one end
of the spectrum are more traditional centralized BPH services
with their hardware physically placed in bunkers and protected
by armed guards, e.g. cyberbunker.com. These BPH services
operate BulletProof Autonomous Systems (BP ASes) geared
towards hosting malicious content and are highly stable. On
the other end, are more fragile hosting services selling ac-
cess to compromised machines for a small one-time charge.
The duration of the access to these machines depends on a
combination of factors, including how many complaints the
illicit activity generates, when the service provider blocks
access, or the maintainers of the machine detect and evict the
malicious intruders. More recently, BPH services are evolving
and moving away from dedicated BP ASes to legitimate ASes
in an effort to blend-in and hide their clients’ trafﬁc among
legitimate network trafﬁc. This renders ASes blacklists, such
as BGP Ranking [6] and ASwatch [7], impractical as blocking
the whole AS would disrupt the operation of legitimate ser-
vices. This type of BPH often takes advantage of the reseller
programs offered by legitimate providers, as explained below.
Hosting options and price plans. BPH services offer a variety
of hosting plans with stratiﬁed tiers of permitted abuse and
computing resources. Computing resources can be (ordered by
cost) dedicated servers, virtual private server (VPS) or shared
hosting. The allowed abuse depends on the BPH service and
the degree of risk they are willing to take. Generally, abuse falls
into three tiers (high, medium and low). Child pornography,
terrorism and anti-government content are the highest and
rarely allowed by the BPH services, as observed in our study.
DMCA (Digital Millennium Copyright Act) infringement and
HYIPs (High Yield Investment Programs) are the lowest tier
of abuse and are allowed by numerous BPH services mostly
operating offshore in countries with lax laws regarding such
content. Such services cost the renter an average of $10 a
month for a typical VPS.
On the other hand, malware, phishing and botnet content
are considered medium risk and are offered by a number of
BPH services mostly found through advertising in underground
forums. Their prices range from $30-$800, based upon the
malicious content, computing resources and type of resilience
a client needs. For example, during our research, one BPH
service quoted us a dedicated server with SpamHaus protection
at $650. However, VPSs for botnets would cost $250 a month
on average. Figures 2 (& 14 in Appendix) show multiple
hosting plans offered by the BPH services that we collected
from underground forums. Some of these BPH services have
operational online websites and others need to be contacted via
instant messaging programs, such as ICQ. Additionally, some
BPH services operate a multi-layer structure to better protect
their resources, making use of proxies and fast ﬂuxing (FF) to
hide their back-end servers.
Reseller programs. Service providers such as ISPs,
large
hosting providers and cloud platforms offer a certain niche
of clients the ability to join their Reseller Programs, which
enables them to lease out computational resources in bulk
at a discounted rate. Prominent examples of such providers
include “ColoCrossing” [8], “LeaseWeb” [9], “OVH” [10],
and “Voxility” [11]. These reseller programs give rise to a
number of small-scale hosting providers (aka., virtual hosters)
mostly run by one or a few people. Managing and operating
these small hosting services is made even simpler by web
hosting billing and automation platforms readily available at
a small monthly charge. For instance, WHMCS [12], which
costs $15/month, is a popular platform. According to their
website they handle “everything from customer sign-up, to
provisioning, management and support, WHMCS provides a
single centralized platform for managing your web hosting
business so that everyday tasks become quicker, easier, and
more efﬁcient” [12]. Figure 3 shows an example of a BPH
service using WHMCS.
• Becoming a Reseller. To investigate the level of authenti-
cation and veriﬁcation conducted by service providers at po-
tential resellers, we registered for a reseller package with two
service providers, “ColoCrossing” [8] and “Voxility” [11]. To
this end, we purchased a domain, servicehosting.org (anony-
mously registered) and subscribed to WHMCS to run our
hosting service. We set up one fake persona with a fake
name, address and a working phone number (routed through
Google). Armed with our setup, we contacted the reseller
programs of “ColoCrossing” [8] and “Voxility” [11] and within
days we obtained access to our leased servers. We found
that becoming a reseller has been streamlined on lower-end
service providers with minimal veriﬁcation: in our case, one
service provider authenticated the validity of the phone number
via a text message while another required a phone call with
a representative that was mostly a sales pitch rather than
authentication. Ultimately, we paid $79/month for one server
with a /29 network block in the US with “ColoCrossing” while
“Voxility” charged us $215/month for one server with a /28
network block in Europe (EU).
BPH services have started to take advantage of these
lax policies to create virtual BPH services spanning multiple
service providers and countries. Additionally, many of these
lower end providers have largely ofﬂoaded the handling of
abuse complaints to their resellers.
B. IP Address Allocation
Whois. The Internet Assigned Numbers Authority (IANA)
allocates IP addresses in large chunks to one of ﬁve Regional
807
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:21:58 UTC from IEEE Xplore.  Restrictions apply. 
(a) 66host
(b) bpservers
(c) outlawservers
Fig. 2: Examples of online BPH services with varying degrees of allowed abuse. a) Chinese BPH service offering shared hosing plans for anti
DMCA and HYIP content. b) BPH service offering dedicated servers for phishing and botnet hosting. c) BPH service offering shared hosting
for different types of scams. Incidentally, outlawservers and bpservers are owned and operated by the same party.
Fig. 3: BPH service using WHMCS platform [12]
Internet Registries (RIRs). RIRs are nonproﬁt organizations
that manage the registration of IP addresses in their regions
by operating a directory service, Whois, to log and record all
network block registrations. The Whois directory is operated in
an object-oriented fashion. Figure 4 depicts the most relevant
objects to a network block allocation. A network block is
represented by an inetnum object which contains optional
attributes identifying it, such as IP address range and/or CIDR,
network name, description, allocation type (direct vs sub-
allocation), organization, person(s), email and modiﬁcation
date. Organization and person objects also contain attributes
that identify them and pointers to each other. Unfortunately,