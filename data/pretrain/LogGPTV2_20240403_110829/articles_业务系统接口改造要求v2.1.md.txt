国家电网公司
智能一体化调度运行支撑平台
业务系统采集指标接入规范
  -----------------------------------------------------------------------
  2021年3月
  -----------------------------------------------------------------------
目录
1 综述 [3](#综述)
2 监控指标 [4](#监控指标)
2.1 通用监控指标 [4](#通用监控指标)
2.2 专业应用指标 [7](#专业应用指标)
2.2.1 专业指标说明 [7](#专业指标说明)
2.2.2 已监控专业指标 [8](#_Toc82096854)
3 接口方式 [61](#接口方式)
3.1 WebService接口方式 [61](#webservice接口方式)
3.1.1 接口地址 [61](#接口地址)
3.1.2 方法名 [61](#方法名)
3.1.3 参数信息 [61](#参数信息)
3.1.4 返回值 [62](#返回值)
# 综述
为实现对电力业务应用系统的有效监控、满足同业对标的相关要求、实现信息系统运行和应用状态的实时监测，提高信息系统的可靠性和运行效率，业务应用系统本身需要将其自身的运行指标数据和业务指标数据，通过规范的方式，发送到I6000系统。
应用系统监控指标数据将通过I6000系统实时传送到国网并进行全景可视化展示。因此对I6000监控应用指标的准确性和稳定性提出了更高的要求，本文档针对国网建设中的应用系统，提出了为满足其应用运行监控而需提供的基础配置数据、运行数据指标（即指标规范）以及提供数据的方式方法（即接口规范）。
# 监控指标
业务系统监控指标主要反映业务系统的运行及应用状况。运行状况指标主要包括系统运行的健康性、稳定性、可靠性等方面。应用状况指标主要反应业务系统的实际使用状况，如其功能范围、使用频度等，以反应业务系统在信息化建设中为生产所提供信息化手段的强度以及公司在系统上线后信息化程度的不断提高。同时，作为同业对标的依据，客观、准确地量化对标单位的信息化水平，引导和推动各对标单位信息化建设工作，提高信息化管理实效。
为满足不同层次的业务系统监管需求，业务应用所需要提供的监测数据分为两个层次：通用监控指标、业务系统专业应用指标。
## 通用监控指标
通用监控指标主要反应各类业务系统的运行及应用状况，具有普遍适用性。要求各类被监管业务系统按照以下指标要求提供通用监控指标数据。
+----+------+----------------+----+----------------------+----+----+
| ** | **指 | **KPIName**    | ** | **说明**             | ** | ** |
| 序 | 标** |                | 是 |                      | 接 | 采 |
| 号 |      |                | 否 |                      | 口 | 集 |
| ** |      |                | 分 |                      | 方 | 频 |
|    |      |                | 地 |                      | 式 | 率 |
|    |      |                | 市 |                      | ** | ** |
|    |      |                | ** |                      |    |    |
+----+------+----------------+----+----------------------+----+----+
| 1  | 系统 | BusinessSyst   | 否 | 当前时刻，模         | 参 | 5  |
|    | 服务 | emResponseTime |    | 拟应用系统核心服务， | 见 | 分 |
|    | 平均 |                |    | 从页面请求服务开始,  | 章 | 钟 |
|    | 响应 |                |    | 到后台处理完成并响应 | 节 |    |
|    | 时长 |                |    | 页面为止,所消耗的时  | 3  |    |
|    |      |                |    | 间的总和。(单位:ms)  | .1 |    |
+----+------+----------------+----+----------------------+----+----+
| 2  | 系统 | BusinessSys    | 否 | 业务系统从           | 参 | 5  |
|    | 健康 | temRunningTime |    | 最近一次可以正常提供 | 见 | 分 |
|    | 运行 |                |    | 业务服务时刻起到当前 | 章 | 钟 |
|    | 时长 |                |    | 时刻的差值，任何原因 | 节 |    |
|    |      |                |    | 导致业务服务终止后该 | 3  |    |
|    |      |                |    | 值清零。（单位：s）  | .1 |    |
+----+------+----------------+----+----------------------+----+----+
| 3  | 页   | BusinessSy     | 是 | 当前时刻业           | 参 | 5  |
|    | 面会 | stemSessionNum |    | 务系统应用的页面连接 | 见 | 分 |
|    | 话连 |                |    | 会话个数（单位：个） | 章 | 钟 |
|    | 接数 |                |    |                      | 节 |    |
|    |      |                |    |                      | 3  |    |
|    |      |                |    |                      | .1 |    |
+----+------+----------------+----+----------------------+----+----+
| 4  | 在   | BusinessS      | 是 | 当                   | 参 | 5  |
|    | 线用 | ystemOnlineNum |    | 前时刻在线使用系统的 | 见 | 分 |
|    | 户数 |                |    | 用户人数（单位：人） | 章 | 钟 |
|    |      |                |    |                      | 节 |    |
|    |      |                |    |                      | 3  |    |
|    |      |                |    |                      | .1 |    |
+----+------+----------------+----+----------------------+----+----+
| 5  | 注   | Busi           | 是 | 当前                 | 参 | 日 |
|    | 册用 | nessUserRegNum |    | 时刻业务系统中注册的 | 见 |    |
|    | 户数 |                |    | 用户总数（单位：人） | 章 |    |
|    |      |                |    |                      | 节 |    |
|    |      |                |    |                      | 3  |    |
|    |      |                |    |                      | .1 |    |
+----+------+----------------+----+----------------------+----+----+
| 6  | 累计 | Busi           | 否 | 从系统正式上线到当前 | 参 | 5  |
|    | 访问 | nessVisitCount |    | 时刻的累计访问系统的 | 见 | 分 |
|    | 人次 |                |    | 人次数（单位：人次） | 章 | 钟 |
|    |      |                |    |                      | 节 |    |
|    |      |                |    |                      | 3  |    |
|    |      |                |    |                      | .1 |    |
+----+------+----------------+----+----------------------+----+----+
| 7  | 业   | Business       | 否 | 所有业务             | 参 | 日 |
|    | 务数 | DataTableSpace |    | 数据已占用的表空间大 | 见 |    |
|    | 据占 |                |    | 小的总和（单位：MB） | 章 |    |
|    | 用表 |                |    |                      | 节 |    |
|    | 空间 |                |    |                      | 3  |    |
|    | 大小 |                |    |                      | .1 |    |
+----+------+----------------+----+----------------------+----+----+
| 8  | 日   | Busin          | 是 | 从零点到当前时刻为止 | 参 | 5  |
|    | 登录 | essDayLoginNum |    | 已经登录过系统的人数 | 见 | 分 |
|    | 人数 |                |    | ，相同账号只能作为一 | 章 | 钟 |
|    |      |                |    | 人计算。（单位：人） | 节 |    |
|    |      |                |    |                      | 3  |    |
|    |      |                |    |                      | .1 |    |
+----+------+----------------+----+----------------------+----+----+
| 9  | 数   | Busine         | 否 | 5分钟内的            | 参 | 5  |
|    | 据库 | ssSystemDBTime |    | 系统数据库访问时间的 | 见 | 分 |
|    | 平均 |                |    | 平均值。（单位：ms） | 章 | 钟 |
|    | 响应 |                |    |                      | 节 |    |
|    | 时长 |                |    | **参                 | 3  |    |
|    |      |                |    | 考sql语句如下备注1** | .1 |    |
+----+------+----------------+----+----------------------+----+----+
**备注1：**数据库平均响应时长的建议搜索SQL语句（注意：Oracle
10g及以上版本，Oracle9i无SYS.V\_\$SYSMETRIC_SUMMARY表）
select
CASE METRIC_NAME
WHEN \'SQL Service Response Time\' then
ROUND((AVERAGE \* 10), 2)
WHEN \'Response Time Per Txn\' then
ROUND((AVERAGE \* 10), 2)
ELSE
AVERAGE
END AVERAGE
from SYS.V\_\$SYSMETRIC_SUMMARY
where METRIC_NAME = \'Response Time Per Txn\'
## 专业应用指标
### 专业指标说明
专业应用指标应根据业务应用专业领域的不同，选取能够准确反映业务应用状况的指标。专业指标应由系统开发厂商、业务应用部门共同提出，并制定相应的指标说明文档，并审核。指标说明文档应包含指标名称、KpiName、指标说明、单位、发送频率，发送时间等信息，各项的内容应符合下面的要求：
**指标名称：**在I6000系统页面展示的指标中文名称。
**指标单位：**在I6000系统页面展示的指标的单位。
**KpiName：**作为该指标的唯一性标识，为防止与其他指标重名，命名应采用应用系统缩写+指标描述缩写的方式。例如：生产管理系统的指标'变电工作任务单完成率'命名为：'PMSTransFinishRate'。
**指标说明：**简要描述指标的含义，应通俗易懂。例如，生产系统指标'变电工作任务单完成率'：完成状态的数据数量除以变电工作任务单记录总数，得到变电工作任务单完成率。
**指标频率：**专业指标频率可以为每5分钟、每日、每月。指标发送频率以每日为宜，不建议使用月指标。
**发送时间：**在I6000系统内，日指标展示为前一天数据，月指标展示为上一月数据。因此，日指标发送时间应在当日23:00到次日凌晨5:00之间，月指标发送时间应在当月底\~次月1日凌晨5:00之间。
# 接口方式
## WebService接口方式
新接入业务系统原则上均要求采取webservice接口方式。下面对webservice接口方式分别进行说明和示例。
### 接口地址
由业务系统提供接口访问地址，示例：
http://IP:Port/businessSystem/services/ims?wsdl (仅供参考)
### 方法名
与业务系统约定获取数据的方法名为getKPIValue，不能更改。
### 参数信息
以xml作为参数
  ------------------ ------------------ ----------------------------------
  **参数名**         **参数格式**       **备注**
  param              String             xml格式的字符串
  ------------------ ------------------ ----------------------------------
参数XML格式(示例)：
+-----------------------------------------------------------------------+
| \                         |
|                                                                       |
| \                                                              |
|                                                                       |
| \地域代码\                       |
|                                                                       |
| \                             |
|                                                                       |
| \\                                    |
|                                                                       |
| \\                                    |
|                                                                       |
| \\                                    |
|                                                                       |
| \                                                             |
+-----------------------------------------------------------------------+
+-----------------------------------------------------------------------+
| **调用代码(示例)**                                                    |
+-----------------------------------------------------------------------+
| String endPoint=\"\";////提供接口的地址\                              |
| String nameSpace = \"\";//命名空间                                    |
|                                                                       |
| Service service = new Service();\                                     |
| Call call = (Call)service.createCall();\                              |
| call.setTargetEndpointAddress(new java.net.URL(endPoint));\           |
| call.setOperationName(new                                             |
| QName(nameSpace,\"getKPIValue\"));//设置要调用哪个方法                |
|                                                                       |
| call.addPar                                                           |
| ameter(\"param\",XMLType.XSD_STRING,ParameterMode.IN);//设置参数名称\ |
| call.setReturnType(org.apache.axis.encoding.XMLType.XSD_STRING);      |
| //要返回的数据类型\                                                   |
| String result=(String)call.invoke( new Object\[\]{\"xml\"}); //       |
| 调用服务，并传参                                                      |
+-----------------------------------------------------------------------+
### 返回值
+-----------------------------------------------------------------------+
| **返回信息 (示例)**                                                   |
+-----------------------------------------------------------------------+
| 返回信息的格式(result的值)见：                                        |
|                                                                       |
| \                         |
|                                                                       |
| \                                                            |
|                                                                       |
| \success/failure\                                  |
|                                                                       |
| \执行的结果提示\                                 |
|                                                                       |
| \                  |
|                                                                       |
| \出错的原因\                                       |
|                                                                       |
| \                                            |
|                                                                       |
| \xx\                                                 |
|                                                                       |
| \                                                              |
|                                                                       |
| \                                            |
|                                                                       |
| \xx\                                                 |
|                                                                       |
| \                                                              |
|                                                                       |
| \                                            |
|                                                                       |
| \xx\                                                 |
|                                                                       |
| \                                                              |
|                                                                       |
| \                                                           |
+-----------------------------------------------------------------------+