Central bank digital currency
Threats and vulnerabilities
Defcon 29
Ian Vitek
CBDC Security
Central bank of Sweden, Sveriges Riksbank
Central bank digital currency
Threats and vulnerabilities
Presentation
Background
Detailed system description of the prototype
Vulnerabilities in the retail central bank digital currency prototype
Everything else
Solutions and summary
2
So where do we start?
Ian Vitek
• Started with pentests 1996.
• Interested in web application security, network layer 2 
(the writer of macof), DMA attacks and local pin bypass 
attacks (found some on iPhone).
Sveriges Riksbank (Central bank of Sweden)
Disclaimer: The views and opinions expressed in this presentation are those of the 
presenter and do not necessarily represent the views and opinions of the 
Riksbank.
3
The e-krona project
• Why central bank digital currency?
• Procurement
• Requirements
• Winning bid
• Work on the prototype phase 1 (year one)
The goal of this presentation is to share insights of the 
security challenges of building a prototype of a two tier 
retail central bank digital currency.
4
Detailed system description of the prototype
5
Detailed system description of the prototype
User
6
Detailed system description of the prototype
App
User
Security and logic, e.g.
•
PIN
•
Signing transactions
•
Encryption
7
Detailed system description of the prototype
App
Disk
User
Security and logic, e.g.
•
PIN
•
Signing transactions
•
Encryption
Storage of
•
PIN
•
Private key for tokens
•
Authentication keys
•
Message keys, e.g. Firebase
8
Detailed system description of the prototype
App
Disk
Security and logic, e.g.
•
PIN
•
Signing transactions
•
Encryption
Storage of
•
PIN
•
Private key for tokens
•
Authentication keys
•
Message keys, e.g. Firebase
9
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
Security and logic, e.g.
•
Authentication
•
Push messages, e.g. Firebase
•
Limits
•
Back office functions
10
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
Security and logic, e.g.
•
Authentication
•
Push messages, e.g. Firebase
•
Limits
•
Back office functions
Storage of
•
Authentication keys
•
Payment history
•
Customer data
•
Message keys, e.g. Firebase
11
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
PSP1
Corda 
node
Security and logic, e.g.
•
Token transactions
•
Token verification
•
Wallet management
12
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
PSP1
Corda 
node
Security and logic, e.g.
•
Token transactions
•
Token verification
•
Wallet management
Storage of
•
Public keys (and PSP1 private keys)
•
Wallets
•
Tokens
•
Backchain
•
Certificates
13
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Security and logic, e.g.
•
Issue and redeem
•
Token verification
•
Corda network management
14
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
DB
Security and logic, e.g.
•
Issue and redeem
•
Token verification
•
Corda network management
Storage of
•
Public keys (and Riksbank private keys)
•
Backchain
•
Certificates
15
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Riksbank
Corda 
notary
DB
Security and logic, e.g.
•
Prevent double-spends
•
Sign the transaction
16
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Riksbank
Corda 
notary
DB
DB
Security and logic, e.g.
•
Prevent double-spends
•
Sign the transaction
Storage of
•
Notary private key
•
Hashes of tokens
•
Certificates
17
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Riksbank
Corda 
notary
Riksbank
business 
logic
DB
DB
Security and logic, e.g.
•
Interest
•
Back office functions
18
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Riksbank
Corda 
notary
Riksbank
business 
logic
DB
DB
DB
Security and logic, e.g.
•
Interest
•
Back office functions
Storage of
•
Outstanding CBDC
19
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Riksbank
Corda 
notary
Riksbank
business 
logic
Riksbank
RTGS
DB
DB
DB
DB
20
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Riksbank
Corda 
notary
Riksbank
business 
logic
Riksbank
RTGS
DB
DB
DB
DB
User alias
Logic
Security and logic, e.g.
•
Add and remove alias
•
Map alias to PSP and wallet
21
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Riksbank
Corda 
notary
Riksbank
business 
logic
Riksbank
RTGS
DB
DB
DB
DB
User alias
Logic
DB
Security and logic, e.g.
•
Add and remove alias
•
Map alias to PSP and wallet
Storage of
•
Alias  PSP and wallet
22
Detailed system description of the prototype
App
Disk
PSP1
business 
logic
DB
DB
Riksbank
Corda 
node
PSP1
Corda 
node
Riksbank
Corda 
notary
Riksbank
business 
logic
Riksbank
RTGS
DB
PSPn
Corda 
node
PSP3
Corda 
node
DB
PSP2
Corda 
node
DB
DB
DB
DB
DB
User alias
Logic
DB
23
What is backchain?
And how to exploit bad implementation...
24
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
25
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
26
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
27
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
28
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Tx: 1
29
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
30
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
31
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
32
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Tx: 2
33
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
34
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node