simulation 
path-identifiers 
bandwidth. 
-the ratio of request 
Even 
under this extreme attack scenario, 
ratio of legit­
imate paths is close to the theoretical 
packet ser­
vice probability, 
guarantees, 
rate to an allocated 
SI:-, under specified 
as illustrated 
stationary 
bandwidth 
in the figure. 
the service 
which is much higher than the probabilistic 
utilizations 
and the 
Next, we show that link-access 
guarantees 
of attack location. 
we use a 40-path unbalanced 
provided 
by 
For this sim­
tree shown in Fig. 3. 
to each leaf node, and 200 
sources 
d b  P(ISI k S)  p(l-ps.) 
i =  1 - , k+ 1 '  . This is derived 
the stationary packet service 
probability 
" 
I-PSi 
of a M!MII/k  queueing 
system. 
978-1-4244-7501-8/10/$26.00 
©2010 IEEE 
308 
DSN 2010: Lee et al. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:01:11 UTC from IEEE Xplore.  Restrictions apply. 
2010 IEEE/IFIP 
International 
Conference 
on Dependable 
Systems & Networks (DSN) 
No defense .............. 
o 
. 
TVA -------
& 0.8  o U5 0.6 !Ii cr '" a: 0.4  ......... 
Our Scheme --
"" ..................... ,"" ...... """" ............... . 
... " ............ " 
 .  0.8 
.....-............ 
15 ,., 
 0.6 
.... '" 
...... 
 0.4 
! :g, 0.2 i __ 'I'--.f--'i'--t --i-.-!---I---I---I---'--'I'--'I'--" 
2 <L 
  /r-"IIIIIIIIIIII 
O---L----- 
o 
o 
o  500  1000  1500  2000  2500  3000 
/ .... 
0.2 
# of attackers 
.
. 
. r .
'.  -+  ". 
pr(64,1'f) = 
P 54,k,Si --.. ---
..... i:  ;;,t::sL; 
'
.. 
' .. .. ........ 
'. 
'. "
 .......  . 
• .• I'i: .•. 
. 
_;:'"""  r-:. . 
"r:o" .. 
r- -
-
rate I assinged 
p = request 
capacity 
2.5 
0.5 
1.5 
3 
.:.:::=::: ::,:::
.:.:::::::::.:.::,:,:
.::::::.:,::=::.:.::::
.. :.:::,:=::
:::::, 
3 
5 
6 
8 
10 
Attack Location 
(Node 10) 
Figure 4: Request drop ratio of legitimate 
Error bars represent 
95% confidence 
intervals. 
paths. 
Figure 5: Request service 
mate paths with respect 
(p). The solid horizontal 
probability 
of legiti-Figure 6: Request drop ratio of legitimate 
paths 
utilization 
to attack location 
in the unbalanced 
to bandwidth 
lines inside bars repre-tree, TVA(k) represents 
(9(151, k, Sill, queue-length 
with respect 
k, 
the result of TVA with 
sent the probabilistic 
guarantees 
for each simulation 
we simulate 
lo­
locations 
for 9(34,8, Si), 9(64,4, Si) and 
four nodes are placed at the farthest 
to each of eight attack nodes; four of these 
attack sources 
nodes are placed at different 
and the remaining 
cation from the flooded link. In this scenario, 
the queue implementation 
9(64,8, Si), and those for the corresponding 
queues in a TVA router (i.e., 
slots respectively). 
legitimate 
dex of attack location 
our scheme, the request 
ent attack 
locations, 
same protection 
against 
tackers' 
location. 
dependent 
buffer space to nearby domains (viz" Section 
2). 
4000 and 8000 total buffer­
drop ratios 
axis represents 
tree in Fig, 3). With 
are uniform over differ­
This means our scheme provides 
of the at­
regardless 
TVA's performance 
is highly 
since TVA assigns 
more 
paths, where the horizontal 
unbalanced 
Fig, 6 shows the request 
upon attackers' 
flooding attacks 
In contrast, 
of 
the in­
drop ratios 
location 
(viz., 
almost 
4 and 8-slot 
7.2. Aggregation Effect 
o  0.1 0.2 0.3 0.4 0.5 0.6  0.7 0.8 0.9 1  1.1 
% Anack Sources in Contaminated 
Domains 
Figure 7: Aggregation 
of legitimate 
paths increases 
by protocol 
conformance: 
The request 
service 
ratio 
as the fraction 
of bots becomes higher. 
conformance 
whose capability 
the fraction 
increase 
of attack sources 
quests are denied at the destination 
half of the leaf nodes. Note that the bandwidth 
measure alone cannot distinguish 
mate ones when the same request 
re­
host, from 10 to 100% in 
attack paths from legiti­
rates occur in all paths. 
is more precisely 
of attack sources 
paths) as the fraction 
the fraction of attack sources 
As Fig. 7 shows, aggregation 
per­
formed on attack paths (which leads to higher service 
in con­
of legitimate 
domains grows. When domains are lightly 
taminated 
con­
taminated 
is less than 
(i.e., 
40% in this simulation), 
This is because 
get (i,e" multi-level 
duces a higher aggregation 
paths near their origins. 
aggregation 
imate paths, as a result 
gitimate 
attack paths near the attack tar­
of those attack paths) pro­
cost than aggregating 
variation 
distinction 
between le­
also causes high service-ratio 
and attack paths. 
aggregation 
aggregating 
of imprecise 
Relatively 
legitimate 
to legit­
ratios 
legitimate 
high cost of multi-level 
paths can be aggregated. 
 1 ,-,--,-,-,--,--,--.-.--,--.-. 
15 <L $ 0.8 
 OLLLL-L-L 
i 0.6  rfl 
  0.4  a: . 0.2 
aggregation, 
which optimizes 
domain 
than the number of access­
of the queue 
are widely dis­
the number of ac­
Path-identifier 
allocation 
occurs whenever 
In Fig, 6, the result 
when attack sources 
becomes greater 
paths (ISlmax), 
for 9(34,8, Si) illustrates 
As aggregation 
bandwidth 
persed across domains, 
tive paths (lSI) 
guaranteed 
implementation 
of aggregation. 
cation to legitimate 
6/34   17.6% in that simulation), 
tio of those paths decreases 
when compared 
9(64,4, Si) (under which no path aggregation 
is far below the stationary 
drop probability 
paths (i.e., 
when physically 
1 -P(ISI, 
the request 
separate 
76.8% (from 6.43% to 1.49%) 
with that of the queue implementation 
paths by a factor of ISIISII::ax 
the effectiveness 
allo­
bandwidth 
(i.e., 
increases 
drop ra­
for 
occurs), 
This 
of legitimate 
7.3. Rolling Attacks 
We also evaluate 
8, Si)   5.32%) which would result 
to those paths. 
queues are assigned 
the effectiveness 
con­
of the protocol 
attack paths, For this, we 
measure in aggregating 
a 64-path 
formance 
configure 
of nodes are attached 
of all paths identical. 
its the number of attack path-identifiers 
to leaf nodes to make the request 
Then, we set ISlmax to 34 (which lim­
by at most two) and 
tree such that the same number 
rates 
balanced 
Another simulation 
we performed 
is that of the "rolling 
time of any defense 
change their location 
whereby attack sources 
attacks", 
ploit delays in the response 
For this simulation, 
ent locations 
10) of Fig. 3 and place 200 attack sources 
node. We configure 
attached 
in each attack 
attack such that attack sources 
to node 1 and 10 flood the target for 10 seconds 
we attach 16 attack nodes at 4 differ­
tree (i.e" at node 1,2,9 and 
in the unbalanced 
a rolling 
mechanism. 
to ex­
978-1-4244-7501-8/10/$26,00 
©2010 IEEE 
309 
DSN 2010: Lee et al. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:01:11 UTC from IEEE Xplore.  Restrictions apply. 
2010 IEEE/IFIP 
International 
Conference 
on Dependable 
Systems & Networks (DSN) 
0.8 
.2 0;  0.6 
a: "5 0-g 0.4 
8 
0.2 
0 
0 
10  1 5   20  25  30  35  40 
Time (sec) 
Figure 8: Time variation 
of goodput ratio at the congested 
link. 
as representing 
the official poli­
should not be interpreted 
cies, either 
Laboratory, 
ment, the UK Ministry 
expressed 
or implied, 
US Army Research 
of Defense, 
of the US Army Research 
Office, the U.S. Govern­
or the UK Government. 
References 
Legend: Error bars represent 
the minimum and maximum of goodput ratio. 
and the other attack sources 
20-second 
period. 
for the next 10 seconds with a 
In Fig. 8, we illustrate 
the time variation 
of goodput ra­
Section 
go through 
link averaged 
by legitimate 
6) at the congested 
since attack requests 
starts 
Changing 
as 
occurs (as soon as the buffer is filled) and 
(around t =  2), the goodput ratio rises 
attack location 
decreases 
tio (viz., 
over 10 
runs. The goodput ratio is very low at the beginning 
of the 
the target link 
simulation, 
before being preempted 
ones. However, 
buffer-preemption 
aggregation 
sharply. 
goodput ratio as the number of attack path-identifiers 
congested 
router increases 
gated path-identifiers 
effects disappear 
made on the switched 
20·RTT R:: 2 seconds 
8. Concluding Remark 
the 
at the 
from 2 aggre­
to 8 path-identifiers). 
these 
However, 
is 
decision 
attack paths in D.agg (which is set to 
in this simulation). 
a new aggregation 
significantly 
four times (i.e., 
whenever 
[ I ]  http://www.computerwor
[2] http://www.potaroo.netlto
[3] T. Anderson, T. Roscoe, 
net denial-of-service 
ld.com/s/article
ols/asn32/. 
and D. Wetherall. 
with capabiliti
[4] K. Argyraki 
es. In Hotnets-II, 2003. 
and D.  R. Cheriton. Network Capabilit
ies: The 
/9076278/. 
Preventing 
Inter­
Good, the B ad and the Ugly. HotNets IV, 2005. 
and W. Lee. Modeling B otnet Propagation 
[5] D. Dagon, C.  Zou, 
Using Time Zone. Network and Distributed 
Symposium, 2006. 
[6] L. Fan, P. Cao, J. Almeida, and A. Z. Broder. Summary 
System Security 
cache:  A scalable wide-area web cache shar
IEEElACM Transactions 
on Networking, 1 998. 
[7] w. C. Feng, D.  D. Kandlur, 
Stochastic 
Enforcing 
D.  Saha, and K. G. Shin. 
Fair Blue: A Queue Management 
for 
Algorithm 
Fairness. In INFO COM, pages 1 520- 1529,200 1 .  
Denial of 
[8] P. Ferguson. Network Ingress Filtering : Defeating 
ing protocol. In 
Attacks 
Service 
RFC 2827, 2000. 
which employ IP Source Address Spoofing. 
[9] S .  B. Lee. Localizing the 
the internet. 
[ 1 0] R. Mahajan, S.  Floyd, 
In Ph.D Thesis, University 
effects of link flooding attacks 
of Maryland, 2009. 
high­
In ICNP '01, 200 1 .  
Controlling 
and D. Wetherall. 
flows at the congested router. 
in 
bandwidth 
[ II ]  P. E .  McKenney. Stochastic 
fairness queueing. 
I n  INFO­
COM, 1 990. 
[ 1 2] B. Parno, D. Wendlandt, 
E. Shi, A. Perrig, 
Connection 
B. Maggs, and Y­
Setup from Denial­
: Protecting 
A.  R. Karlin, and T. Anderson. 
for IP traceback. 
In SIGCOMM, 
In this paper, we present 
a defense scheme against 
connection 
C. Hu. Portcullis
of-Capability 
Attacks. In SIGCOMM, 2007. 
systems. 
targeting 
individual 
at remote routers. 
Practical 
2000. 
to which link-access 
defined as the probabilistic 
Our design of a new authenticated 
[ 1 3]  S. Savage, D. Wetherall, 
network support 
mechanism 
provides 
domain identifiers 
setups in capa­
path­
packets 
with 
guar­
of link 
Guarantees 
lower bounds of link ac­
link flooding attacks 
bility 
identification 
unforgeable 
antees are provided 
access, 
cess, are provided 
differentially 
results 
guarantees 
their location, 
September 
differential guarantees.  Differential link-access 
M .  Blum,  N. 
would provide 
that employ strong security 
tamination. 
of our design: link-access 
of global attack sources 
and 
via 
show the effectiveness 
that are independent 
based on domain contaminations. 
in a domain basis and they are provided 
incentives 
measures 
Internet 
USENIX Security 
to administrative 
domains 
attack dispersion 
and resilience 
in Your Spare  Time. 
Symposium, 2002. 
Simulation 
guarantees 
Marking Schemes for 
[ 1 6] S .  Staniford, 
[ 1 8] L. von  Ahn, 
Saint Malo, France, 
positive 
mal ware con­
against 
against 
CAPTCHA: Using hard AI problems 
ceedings of Eurocrypl, 2003. 
[ 1 7] A. Studer and A. Perrigo The coremelt 
2009. 
[ 1 4] M. Shreedhar 
and G. Varghese. Efficient 
round robin. In SIGCOMM '95, pages 231 -242,1 995. 
fair queueing 
[ 1 5] D. X. Song and A. Perrigo Advanced and Authenticated 
deficit 
using 
IP Traceback. 
V. Paxson, and N .  Weaver. How to  Own the 
In INFOCOM, 200 I .  
In Proceedings 
of the 1 1 th 
attack. 
In ESORICS, 
Hopper, and J. Langford. 
for security. 
In Pro­
Acknowledgment 
This research 
was supported 
in part by US Army Re­
search Laboratory 
der Agreement 
Army Research 
at the University 
contained 
and the UK Ministry 
of Defence un­
and by the US 
Number W911NF-06-3-0001 
Office under Contract 
of Maryland. 
W911 NF-07 -1-0287 
The views and conclusions 
[21 ]  
in this document are those of the authors 
and 
[ 1 9] A. Yaar, A. Perrig, and D. Song. Pi:  A Path Identification 
DDoS Attacks. I n  In IEEE 
[20] 
and D. Song. SIFF: A Stateless Internet 
and Privacy, 2003. 
Mechanism t o  Defend against 
Symposium on Security 
A. Yaar, A. Perrig, 
Flow Filter 
ings of the IEEE Security 
X. Yang, D. Wetherall, 
to Mitigate DDoS Flooding 
Attacks. In Proceed­
and Privacy Symposium, 2004. 
and T. Anderson. A DoS-limiting 
network architecture. 
NETWORKING, 2008. 
In IEEEIACM TRANSACTIONS ON 
978-1-4244-7501-8/101$26.00 
©2010 IEEE 
310 
DSN 2010: Lee et al. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:01:11 UTC from IEEE Xplore.  Restrictions apply.