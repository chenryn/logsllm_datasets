show, publicly-available routing tables have biases, errors and bogus
route advertisements. In order to address such issues, in future, we
may cross-validate our map with different sources of data (and
mapping algorithms).
Router level topology estimation: Router-level mapping of AS
structure, uses traceroute probes from various planetlab hosts
to IP addresses inside the ASes. We are limited by the fraction
of routers discoverable through traceroute probes, and routers
and middleboxes are sometimes set up to not respond to ping and
traceroute. To limit this concern as far as possible, we use Paris
Traceroute, with TCP probes. Secondly, we used planetlab nodes
to launch traceroute probes, as the looking-glass servers (as
used originally [18]) were unavailable at the time of our tests. There
is always a chance some routes are simply not covered; increasing
the number of probing hosts may improve our topology estimation,
 AS3356 AS7015 AS6363 AS2818 Bbc.com  AS9002 AS29226 AS51971 AS X AS Y AS Z c2p p2p as new paths may be discovered by probing an IP address from
different vantage points.
7 CONCLUDING REMARKS
In this paper, we have made two contributions towards answering
the question of how to best place DRs in the Internet.
(1) As our first contribution, we demonstrate that a small set
of candidate ASes (≈ 30) intercepts a very large fraction of
paths (greater than 90%) to sites of interest, i.e. potential
overt destinations, irrespective of the adversary country. In
other words, placing DRs in our ASes is sufficient to build
a global DR framework. (As opposed to current approaches
[1, 12], which need the collaboration of over 800 ASes for
a single adversary such as Venezuela or China.). We also
observe that, if censorious regimes (like China) attempt to
filter traffic along the paths transiting our 30 ASes, they will
not only censor their own citizens, but many other residing
outside their network boundaries (collateral damage).
(2) Our second contribution is to explore the question of DR
placement, not only at the AS-level, but at the router level.
In practice, an AS is not a simple entity; it may have thou-
sands of routers, and it is not obvious which of these should
be replaced with DR. We find that, to intercept a large frac-
tion of paths through an AS, we need a large number of
both edge and core routers - typically several hundred (and
in cases such as Quest Communications and Verizon, well
over 1500 routers).
Thus, setting up a worldwide DR framework may require the
collaboration of a small set of ASes (≈ 30). But even a single key AS,
on an average, will need several hundred routers to intercept all the
paths. We conclude that building a worldwide DR infrastructure is
practically feasible, but ASes need sufficiently strong incentives to
deploy a total of over 11, 700 DRs. We will explore such issues, in
our future work.
ACKNOWLEDGEMENTS
We would like to express thanks to Mr. Rahul Singh, M.Tech IIITD,
who helped us develop our first prototype of Gao et al.’s AS mapping
algorithm. We are also grateful to Persistent Systems Ltd., India,
who very kindly agreed to fund our travel to the conference to
present the paper.
REFERENCES
[1] A. Houmansadr, E. L. Wong, and V. Shmatikov, “No direction home: The true
cost of routing around decoys.” in NDSS, 2014.
[2] L. Subramanian, S. Agarwal, J. Rexford, and R. H. Katz, “Characterizing the
internet hierarchy from multiple vantage points,” in INFOCOM 2002. Twenty-First
Annual Joint Conference of the IEEE Computer and Communications Societies.
Proceedings. IEEE, vol. 2.
IEEE, 2002, pp. 618–627.
[3] R. Dingledine, N. Mathewson, and P. Syverson, “Tor: The second-generation
onion router,” DTIC Document, Tech. Rep., 2004.
[5]
[4] P. Winter and S. Lindskog, “How the great firewall of china is blocking tor.” in
FOCI, 2012.
J. Karlin, D. Ellard, A. W. Jackson, C. E. Jones, G. Lauer, D. Mankins, and W. T.
Strayer, “Decoy routing: Toward unblockable internet communication.” in FOCI,
2011.
[6] A. Houmansadr, G. T. Nguyen, M. Caesar, and N. Borisov, “Cirripede: Circum-
vention infrastructure using router redirection with plausible deniability,” in
Proceedings of the 18th ACM Conference on Computer and Communications Secu-
rity, ser. CCS ’11. New York, NY, USA: ACM, 2011, pp. 187–200.
[7] E. Wustrow, S. Wolchok, I. Goldberg, and J. A. Halderman, “Telex: Anticensorship
in the network infrastructure.” in USENIX Security Symposium, 2011.
[8] E. Wustrow, C. M. Swanson, and J. A. Halderman, “Tapdance: End-to-middle
anticensorship without flow blocking,” in 23rd USENIX Security Symposium
(USENIX Security 14), 2014, pp. 159–174.
[9] D. Ellard, C. Jones, V. Manfredi, W. T. Strayer, B. Thapa, M. V. Welie, and A. Jack-
son, “Rebound: Decoy routing on asymmetric routes via error messages,” in Local
Computer Networks (LCN), 2015 IEEE 40th Conference on, Oct 2015, pp. 91–99.
[10] C. Bocovich and I. Goldberg, “Slitheen: Perfectly imitated decoy routing through
traffic replacement,” in Proceedings of the 2016 ACM SIGSAC Conference on Com-
puter and Communications Security. ACM, 2016, pp. 1702–1714.
[11] M. Schuchard, J. Geddes, C. Thompson, and N. Hopper, “Routing around decoys,”
in Proceedings of the 2012 ACM conference on Computer and communications
security. ACM, 2012, pp. 85–96.
[12] M. Nasr and A. Houmansadr, “Game of decoys: Optimal decoy routing through
game theory,” in Proceedings of the 2016 ACM SIGSAC Conference on Computer
and Communications Security, ser. CCS ’16. New York, NY, USA: ACM, 2016,
pp. 1727–1738.
J. Qiu and L. Gao, “As path inference by exploiting known as paths,” in Global
IEEE, 2006, pp. 1–5.
Telecommunications Conference, 2006. GLOBECOM’06. IEEE.
[14] “As relationships,” http://www.caida.org/data/as-relationships/.
[15] N. Hu and P. Steenkiste, “Exploiting internet route sharing for large scale avail-
able bandwidth estimation,” in Proceedings of the 5th ACM SIGCOMM conference
on Internet Measurement. USENIX Association, 2005, pp. 16–16.
[16] D. Magoni and M. Hoerdt, “Internet core topology mapping and analysis,” Com-
[13]
puter Communications, vol. 28, no. 5, pp. 494–506, 2005.
[17] C. Orsini, E. Gregori, L. Lenzini, and D. Krioukov, “Evolution of the internet
k-dense structure,” IEEE/ACM Transactions on Networking (TON), vol. 22, no. 6,
pp. 1769–1780, 2014.
[18] N. Spring, R. Mahajan, D. Wetherall, and T. Anderson, “Measuring isp topologies
with rocketfuel,” IEEE/ACM Trans. Netw., vol. 12, no. 1, pp. 2–16, Feb. 2004.
[19] H. J. Chao and B. Liu, High performance switches and routers.
John Wiley &
Sons, 2007.
[20] S. Das, G. Parulkar, and N. McKeown, “Rethinking ip core networks,” Journal of
Optical Communications and Networking, vol. 5, no. 12, pp. 1431–1442, 2013.
[21] A. Chaabane, P. Manils, and M. A. Kaafar, “Digging into anonymous traffic: A
deep analysis of the tor anonymizing network,” in Network and System Security
(NSS), 2010 4th International Conference on.
IEEE, 2010, pp. 167–174.
[22] S. Dharmapurikar, P. Krishnamurthy, T. Sproull, and J. Lockwood, “Deep packet
inspection using parallel bloom filters,” in High performance interconnects, 2003.
proceedings. 11th symposium on.
IEEE, 2003, pp. 44–51.
[23] H. M. Moghaddam, B. Li, M. Derakhshani, and I. Goldberg, “Skypemorph: Proto-
col obfuscation for Tor bridges,” in Proceedings of the 19th ACM conference on
Computer and Communications Security (CCS 2012), October 2012.
[24] Z. Weinberg, J. Wang, V. Yegneswaran, L. Briesemeister, S. Cheung, F. Wang,
and D. Boneh, “StegoTorus: A camouflage proxy for the Tor anonymity system,”
in Proceedings of the 19th ACM conference on Computer and Communications
Security (CCS 2012), October 2012.
[25] A. Houmansadr, C. Brubaker, and V. Shmatikov, “The parrot is dead: Observ-
ing unobservable network communications,” in Proceedings of the 2013 IEEE
Symposium on Security and Privacy, May 2013.
[26] L. Gao, “On inferring autonomous system relationships in the internet,”
IEEE/ACM Transactions on Networking (ToN), vol. 9, no. 6, pp. 733–745, 2001.
[27] “Route views project,” http://archive.routeviews.org/.
[28]
J. Cesareo, J. Karlin, J. Rexford, and M. Schapira, “Optimizing the placement of
implicit proxies,” https://www.cs.princeton.edu/~jrex/papers/decoy-routing.pdf,
2012.
[29] H. B. Acharya, S. Chakravarty, and D. Gosain, “Few throats to choke: On the
current structure of the internet,” in Local Computer Networks, 2017.
[30] “Archipelago (ark) measurement infrastructure,” http://www.caida.org/projects/
[31] H. V. Madhyastha, T. Isdal, M. Piatek, C. Dixon, T. Anderson, A. Krishnamurthy,
and A. Venkataramani, “iplane: An information plane for distributed services,” in
Proceedings of the 7th symposium on Operating systems design and implementation.
USENIX Association, 2006, pp. 367–380.
[32] A. Barton and M. Wright, “Denasa: Destination-naive as-awareness in anony-
mous communications,” in Proceedings of the 16th Privacy Enhancing Technologies
Symposium (PETS 2016), July 2016.
[33] M. Edman and P. F. Syverson, “AS-awareness in Tor path selection,” in Proceedings
of the 2009 ACM Conference on Computer and Communications Security, CCS 2009,
E. Al-Shaer, S. Jha, and A. D. Keromytis, Eds. ACM, November 2009, pp. 380–389.
[34] S. Pandey, M.-J. Choi, S.-J. Lee, and J. W. Hong, “Ip network topology discovery
using snmp,” in Proceedings of the 23rd International Conference on Information
Networking, ser. ICOIN’09. Piscataway, NJ, USA: IEEE Press, 2009, pp. 33–37.
[35] “Traceroute Looking Glass,” http://traceroute.org/.
[36] “Midar,” http://www.caida.org/tools/measurement/midar/.
[37] “Ip to asn mapping,” http://www.team-cymru.org/IP-ASN-mapping.html.
ark/.
[38] H. Haddadi, M. Rio, G. Iannaccone, A. Moore, and R. Mortier, “Network topologies:
inference, modeling, and generation,” IEEE Communications Surveys Tutorials,
vol. 10, no. 2, pp. 48–69, Second 2008.
[39] “Freedom house - freedom of press,” https://freedomhouse.org/.
[40] “Open net initiative,” https://opennet.net/.
[41] “Alexa - actionable analytics for the web,” http://www.alexa.com/topsites.
[42] “Inferring mechanics of web censorship around the world,” in Presented as part
of the 2nd USENIX Workshop on Free and Open Communications on the Internet,
Berkeley, CA, 2012.
[43] Anonymous, “The collateral damage of internet censorship by dns injection,”
SIGCOMM Comput. Commun. Rev., vol. 42, no. 3, pp. 21–27, Jun. 2012.
[44] T. D. Gautheir, “Detecting trends using spearman’s rank correlation coefficient,”
Environmental forensics, vol. 2, no. 4, pp. 359–362, 2001.
[45] E. Gregori, A. Improta, and L. Sani, “Isolario: a do-ut-des approach to improve
the appeal of bgp route collecting,” arXiv preprint arXiv:1611.06904, 2016.
[46] E. Gregori, A. Improta, L. Lenzini, L. Rossi, and L. Sani, “A novel methodology to
address the internet as-level data incompleteness,” IEEE/ACM Transactions on
Networking (TON), vol. 23, no. 4, pp. 1314–1327, 2015.
A GAO AS-LEVEL MAPPING:
Our end-to-end AS-level path inference algorithm follows Gao [13]. The key
idea of this approach is to construct paths based on the routing information
in existing BGP routing tables. More precisely, the process estimates paths
from an IP-prefix to every other AS of the Internet.
The inputs to the algorithm are existing BGP RIBs, collected by the
RouteViews project [27] from Internet Exchange Points (IXes), where several
ASes peer.
Paths directly obtained from RIBs are termed sure paths. ASes on sure
paths are called Base ASes. For example, in the (hypothetical) path 2869 −
3586 − 49561 − 58556 − 10348 192.168.1.12/24, each number represents an
AS. The path originates at AS2869 and terminates at AS10348, the home
AS of the advertised prefix 192.168.1.12/24. Note that the suffixes of sure
paths are themselves also sure paths.
In addition to sure paths, the algorithm computes new ones. This is done
by extending sure paths to other ASes to which there are no explicitly-
known paths (from the prefix concerned). The extended path must be loop-
free, and must satisfy the Valley-Free Property [26]. The process is as follows.
• For each prefix, all sure paths (containing all the base ASes) are
selected. (These are simply the RIB entries corresponding to the
input prefix).
Next, these sure paths are to be inspected for possible extension
to new ASes, provided they they satisfy the Valley Free property
and have no loops.
• The algorithm searches for ASes in existing RIBs that share valid
business relations with the end ASes of paths. [We used the rela-
tionships presented by CAIDA [14].]
• An edge is assumed, to extend a sure path by one hop.
Note that we are trying to find a path from an AS to the target
prefix, and that extensions of several sure paths might connect
the chosen AS to the prefix. Hence there is a need for tie breaking.
– The algorithm sorts the possible paths, and selects the short-
est path to the prefix.
– In case of a tie, the path with minimum uncertainty (length
of the inferred path extensions) is chosen.
– If there is still a tie, the path with the higher frequency index
(the number of times a sure path actually appears in the RIBs)
is selected.
• Appropriate data structures, i.e. the frequency with which an edge
appears in the RIBs, the uncertainty of the extended path, and the
new path length, are updated.
Figure 11: Schematic AS graph with multiple valid valley-
free paths: D−B−E, D−B−C − F, D−B−C −G, D−B−A−C − F,
D − B − A − C − G, E − B − A − C − F and E − B − A − C − G.
Note how some do not traverse A, the AS with the highest
customer-cone size.
B PATH FREQUENCY VS CUSTOMER-CONE
SIZE
We provide some detail for our claim in Section 6.4, that customer-cone size
is not a reliable metric to identify the ASes that transport a large fraction
of traffic. We explain our reasoning with the example of the AS graph in
Figure 11.
The figure represents a hypothetical AS graph where node A represents
an AS with the highest customer-cone size of 6, the total number of ASes
that A can reach via its customers and their customers (D, B, E, F, C, G).
ASes B and C have customer cones of size 2 (for each of the individual
nodes).
There are several valid valley free paths in this hypothetical AS graph:
D−B−E, D−B−C −F , D−B−C −G, D−B−A−C −F , D−B−A−C −G,
E − B − A − C − F and E − B − A − C − G. However, as evident from the
example, not all of them pass through the root AS, i.e. the node with the
highest customer-cone size. This is also evident from Table 5: for several
large ASes, a considerable fraction of paths do not traverse the core ASes
themselves, but do traverse their immediate (1-hop) customers 14.
14Interestingly, smaller customer-cones have fewer such paths, i.e. paths not traversing
the root AS. Perhaps smaller cones have fewer neighbor ASes to route through? We
may study this in future work
ASN % of path
not reaching
the AS
34.16
29.05
28.16
36.50
21.00
7.46
5.13
26.00
7.40
0.07
3356
174
2914
1299
3257
6939
6461
6453
7018
10310
% of path
reaching
the AS
33.17
13.13
12.90
8.05
5.23
4.40
4.03
3.76
3.70
3.52
Table 5: Prefix-to-AS paths in cone of core ASes: %age travers-
ing core ASes themselves, vs. %age traversing their immedi-
ate (1-hop) customers.
In fact, customer cone size is not even well correlated with path frequency.
The Spearman’s Rank Correlation Coefficient is only ≈ 0.2 (see Figure 12).
Figure 12: AS Rank variation: path frequency vs cone size
for transit ASes.
C ADDITIONAL GRAPHS
Traffic to specific destinations:
Figure 13: CDF of ASes according to fraction of paths to pop-
ular websites that they intercept
For completeness, we present the results of our experiment for a few of
the most important single websites in isolation, in Figure 13.
Clearly, while single websites are far more variable, the general trend is
similar to Figure 3. About 15 ASes (out of the 50 heavy-hitter ASes identified)
cover over 80% of the AS-paths to these destinations.
Figure 14: CDF of ASes by fraction of paths that they inter-
cept (for Alexa top-200 sites)
Only 5 ASes collectively transport all the paths to the prefix correspond-
ing to twitter.com, while about 18 ASes intercept all paths carrying traffic
from bing.com. Finally, about 30 ASes cumulatively transport about 98% of
the paths corresponding to google.com and facebook.com.
For comparison, here is the cumulative frequency of the paths intercepted
by ASes, this time for paths to the Alexa top-200 sites.
We also provide the graph of the cumulative path coverage inside an AS,
by its heavy hitter routers. As is quite clear, the graph varies a good deal;
some ASes are almost completely covered by a few routers, while others
(AS 3257) need very many heavy-hitters, and can more easily be covered by
choosing their edge routers (Figure 15).
Figure 15: Traceroute paths in the top five (out of 30) key
ASes. The number of routers needed to cover 90% of the paths
varies between 288 (AS174) and 1483 (AS3257)