m
s
s
e
r
d
d
a
P
I
Missed DNS lookup
Changed hosts every 20 minutes
6.65
0
200
400
600
800
1000
1200
Probing Round
0
0
200
400
800
Round of measurement
600
1000
1200
0
10.0.0.0
10.64.0.0
10.128.0.0
10.192.0.0 10.255.255.255
Private IP /16 prefix
Figure 19: Number of live instances in EC2
US east region.
Figure 20: Number of changed instances be-
tween each round of measurement and number
of missed DNS lookups in each round.
Figure 21: The private IP addresses whose
mappings to public IP have changed.
[6] BARHAM, P., DRAGOVIC, B., FRASER, K., HAND, S.,
HARRIS, T., HO, A., NEUGEBAUER, R., PRATT, I., AND
WARFIELD, A. Xen and the art of virtualization.
In Proceed-
ings of ACM SOSP’03.
[7] BATES, A., MOOD, B., PLETCHER, J., PRUSE, H., VALAFAR,
M., AND BUTLER, K. Detecting co-residency with active trafﬁc
analysis techniques. In Proceedings of ACM CCSW’12.
[8] BERMUDEZ, I., TRAVERSO, S., MELLIA, M., AND MUNAFO,
M. Exploring the cloud from passive measurements: the amazon
aws case. In Proceedings of IEEE INFOCOM’13, pp. 230–234.
[9] BIRKE, R., PODZIMEK, A., CHEN, L. Y., AND SMIRNI, E.
State-of-the-practice in data center virtualization: Toward a bet-
ter understanding of vm usage.
In Proceedings of IEEE/IFIP
DSN’13.
[10] DURUMERIC, Z., WUSTROW, E., AND HALDERMAN, J. A.
Zmap: Fast internet-wide scanning and its security applications.
In Proceedings of USENIX Security’13, pp. 605–620.
[11] HE, K., FISHER, A., WANG, L., GEMBER, A., AKELLA, A.,
AND RISTENPART, T. Next stop, the cloud: understanding mod-
ern web service deployment in ec2 and azure. In Proceedings of
ACM IMC’13, pp. 177–190.
[12] KIM, T., PEINADO, M., AND MAINAR-RUIZ, G. System-level
protection against cache-based side channel attacks in the cloud.
In Proceedings of USENIX Security’12.
[13] LACURTS, K., DENG, S., GOYAL, A., AND BALAKRISHNAN,
H. Choreo: network-aware task placement for cloud applications.
In Proceedings of ACM IMC’13.
[14] RISTENPART, T., TROMER, E., SHACHAM, H., AND SAVAGE,
S. Hey, you, get off of my cloud: exploring information leakage
in third-party compute clouds. In Proceedings of ACM CCS’09,
pp. 199–212.
[15] VARADARAJAN, V., RISTENPART, T., AND SWIFT, M.
Scheduler-based defenses against cross-vm side-channels. In Pro-
ceedings of USENIX Security’14.
[16] VARADARAJAN, V., ZHANG, Y., RISTENPART, T., AND SWIFT,
M. A placement vulnerability study in multi-tenant public clouds.
In Proceedings of USENIX Security’15.
[17] WANG, G., AND NG, T. E. The impact of virtualization on net-
work performance of amazon ec2 data center. In Proceedings of
IEEE INFOCOM’10.
[18] WANG, L., NAPPA, A., CABALLERO, J., RISTENPART, T., AND
AKELLA, A. Whowas: A platform for measuring web deploy-
ments on iaas clouds. In Proceedings of ACM IMC’14.
[19] WU, Z., XU, Z., AND WANG, H. Whispers in the hyper-space:
High-speed covert channel attacks in the cloud. In Proceedings
of USENIX Security’12, pp. 159–173.
[20] XU, Y., BAILEY, M., JAHANIAN, F., JOSHI, K., HILTUNEN,
M., AND SCHLICHTING, R. An exploration of L2 cache covert
channels in virtualized environments.
In Proceedings of ACM
CCSW’11, pp. 29–40.
[21] XU, Y., MUSGRAVE, Z., NOBLE, B., AND BAILEY, M. Bob-
tail: avoiding long tails in the cloud. In Proceedings of USENIX
NSDI’13, pp. 329–342.
[22] XU, Z., WANG, H., AND WU, Z. Technical Report: WM-CS-
2015-03. http://www.wm.edu/as/computerscience/
documents/cstechreports/WM-CS-2015-03.pdf.
[23] XU, Z., WANG, H., XU, Z., AND WANG, X. Power attack: An
increasing threat to data centers. In Proceedings of NDSS’14.
[24] ZHANG, Y., JUELS, A., OPREA, A., AND REITER, M. K.
Homealone: Co-residency detection in the cloud via side-channel
analysis. In Proceedings of IEEE S&P’11, pp. 313–328.
[25] ZHANG, Y., JUELS, A., REITER, M. K., AND RISTENPART, T.
Cross-tenant side-channel attacks in paas clouds. In Proceedings
of ACM CCS’14, pp. 990–1003.
[26] ZHANG, Y., AND REITER, M. K. D¨uppel: Retroﬁtting commod-
ity operating systems to mitigate cache side channels in the cloud.
In Proceedings of ACM CCS’13, pp. 827–838.
A Business scale of EC2
Figure 19 illustrates the number of all the detected live
instances in EC2 US east region during the measurement
period. We can see that the business scale in EC2 US east
region is very impressive. Our scanning can always de-
tect more than 650,000 live instances in the cloud. Dur-
ing the peak time, we can detect almost 700,000 live
instances.
It is noteworthy that our system only scans
some common ports. Besides the instances we detected,
there are some instances with no common ports opened
or within the VPC that do not have public IP addresses.
Thus, the real number of live instances in the cloud could
be even larger.
Table 4 lists the break-down statistics, showing the
number of instances hosting a certain service on average.
It is obvious that web service still dominates the usage
in IaaS. Most customers rent the instances to host their
web services. Among these web services (i.e., HTTP),
more than half of them deploy HTTPS at the same time.
Since the default way of accessing an instance in EC2 is
through SSH, the number of instances listening on port
22 is the second largest. There are also considerable in-
stances hosting FTP service, DNS service, and database
service (MYSQL+SQL). For the rest of services, the
number of instances hosting them are less signiﬁcant.
USENIX Association  
24th USENIX Security Symposium  943
15
Table 4: Number of instances hosting a certain service
FTP
SSH
Telnet
SMTP WHOIS DNS
DHCP
Finger
HTTP
SQL
HTTPS MYSQL
24,962
327,294
350
18,376
305
3,392
15
68
441,499
48
261,446
25,872
t1.micro
m1.small
m1.medium
m3.medium
m3.large
10.64.0.0
10.128.0.0
10.192.0.0
10.255.0.0
Internal IP address
6
5
2
d
o
m
s
s
e
r
d
d
a
P
I
255
200
150
100
50
0
10.0.0.0
us−east−1a
us−east−1b
us−east−1d
10.64.0.0
10.128.0.0
10.192.0.0
10.255.0.0
Internal IP address
Live in-
stances
6
5
2
d
o
m
s
s
e
r
d
d
a
P
I
255
200
150
100
50
0
10.0.0.0
Figure 22: The distribution of internal IP addresses of instances with dif-
ferent types in availability zone us-east-1a.
Figure 23: The distribution of internal IP addresses of instances in differ-
ent availability zones.
B Dynamic environment of EC2
Our measurement can also reﬂect the dynamic environ-
ment of EC2 to some extent. First, as shown in Figure 19,
the number of live instances varies over time within a day.
We observed a similar pattern each day: the peak time is
around 5 p.m. (EST) while the service reaches a valley
around 4 a.m.
(EST). Despite this diurnal pattern, the
difference in the number of live instances between peak
and valley is not as signiﬁcant as we expected. There are
only 1,000 more live instances at peak than valley, which
is relatively small considering the overall 650,000 live in-
stances. The diurnal pattern is reasonable, as 4 a.m. EST
is very early morning for the US east coast and it is also
midnight for the US west coast. It is intuitive that at this
time period fewer users are using EC2. The small differ-
ence between peak and valley can be explained from two
aspects. First, most instances run stable services such as
web and database services. These instances remain active
all the time. Second, although the data center is located
in the US, the customers are distributed all around the
world. For instance, Bermudez et al. [8] demonstrated
that the Virginia data center is responsible for more than
85% of EC2 trafﬁc in Italy. The time of 4 a.m. on the
US east coast is 10 a.m. in Italy when customers are very
active there.
We are also interested in how dynamic the cloud en-
vironment is. Figure 20 illustrates how many instances
are shutdown, newly booted, or re-located between each
round of measurement. We can see there are more than
15,000 hosts that are changed every 20 minutes, indicat-
ing that EC2 is a very dynamic environment with tens of
VMs booted and shut down every second.
Besides the dynamics of live instances, we are also in-
terested in the networking dynamics. During our mea-
surement, we observed overall 975,032 distinct private
IP addresses and 1,024,589 distinct public IP addresses.
We recorded all the mappings from public IP to private IP
and the mappings from private IP to public IP during our
measurement. We also recorded the mappings that are
changed during the measurement period. Over the course
of our 15-day measurement, 103,242 mappings changed.
This implies that EC2 has likely recruited dynamic NAT
for address translation.
Figure 21 shows the private IP addresses that are in-
cluded in the changed mappings. It is clear that the IP
address pool in the cloud is dynamic as well. The den-
sity of the IPs in a certain range is signiﬁcantly higher
than other areas. This range of private IPs are mostly
assigned to micro and small instances. Since micro and
small instances are usually used for temporary purposes,
ON/OFF operations on them are more frequent, leading
to more frequent changes in private-public IP mappings.
C VM placement locality in EC2
To investigate the VM placement locality in EC2, we
launched numerous instances with different types and in
different availability zones to study whether the type or
zone will impact the physical location of an instance.
Figure 22 illustrates the private IP distribution of some
sample instances with different types in zone us-east-1a.
The IP distribution exhibits a certain type locality. We
can see from the ﬁgure that the instances of the same
type tend to have closer internal IPs, i.e., they are more
likely to be placed physically close to one another. How-
ever, compared with corresponding results in 2008 [14],
we can see that such type locality has been signiﬁcantly
weakened.
We also study how availability zone could affect VM
placement. Figure 23 illustrates the internal IP distribu-
tion of instances in different availability zones. As we
can see, VM placement still has availability zone local-
ity, i.e., instances in the same zone are more likely to
have their internal IP addresses located within a certain
range. However, such locality is also much weaker than
in 2008 [14].
944  24th USENIX Security Symposium 
USENIX Association
16