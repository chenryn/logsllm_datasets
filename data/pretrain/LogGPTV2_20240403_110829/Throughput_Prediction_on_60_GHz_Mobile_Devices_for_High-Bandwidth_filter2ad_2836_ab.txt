### Input Features and Feature Pruning

To achieve high prediction accuracy, we employ a feature pruning algorithm that ranks the importance of input features. This process helps in identifying and retaining the most useful features for our models.

### 3. Results and Analysis

In this section, we present the results obtained using our neural network models. We consider three scenarios:

1. **Static Scenarios**: The phone is fixed at a given azimuth and pitch, placed 4 meters in front of the Access Point (AP).
2. **Random Mobility Scenarios**: The phone moves simultaneously along all three dimensions (azimuth, pitch, and slide) at different speeds.
3. **Real Application Scenarios**: We use real application traces, such as VR and ABR video streaming, instead of backlogged TCP traffic generated by nuttcp, under random mobility conditions.

### 3.1 Impact of the Phased Array Field of View

Commercial off-the-shelf (COTS) devices typically have a limited angular coverage area on the receiving end, known as the field-of-view (FoV). Previous studies with 802.11ad APs and laptops [35, 44] indicated that the FoV is around 170°. Our study begins by measuring throughput when the AP is within or outside the phone's FoV.

We placed the phone 4 meters away from the AP and rotated it to change its azimuth relative to the AP. Our results, shown in Fig. 2, indicate that when the azimuth is within (-60°, 60°), the average throughput is approximately 1.5 Gbps. Outside this range, the throughput drops below 1 Gbps and becomes zero for angles greater than ±90°. This suggests that the FoV for first-generation 802.11ad smartphones is smaller than previously reported. For the rest of the paper, we focus on predicting throughput when the AP is within the phone's FoV.

Fig. 3 shows that throughput can vary significantly over time even within the FoV, especially at fine timescales. At a 10 ms timescale, the throughput fluctuates between 1 Gbps and 1.8 Gbps, sometimes dropping below 500 Mbps. These variations are caused by 802.11ad MAC layer mechanisms, including periodic beaconing by the AP every 100 ms, beamforming between the phone and the AP (triggered every 3 seconds and in case of missing ACKs), and the interplay between beamforming and rate adaptation [35]. These factors make throughput prediction challenging at fine timescales. At coarser timescales (100 ms and 2000 ms), the variations are averaged out, resulting in smoother throughput.

### 3.2 Static Scenarios

We first explore the predictability of throughput when the phone is stationary. In this section, we aim to understand how well we can predict throughput changes caused by channel variations and MAC layer mechanisms alone.

We collected five static traces, listed in Table 1, by placing the phone at various azimuth and pitch angles relative to the AP. We trained and evaluated a separate model for each trace. Since the phone remains static during each trace, we do not use the azimuth, pitch, and link status data in training and testing, as these features remain constant. The results shown in Figs. 4a–4c are averaged over the five traces.

**Table 1: Static Traces Collected**

| Trace # | Azimuth (°) | Pitch (°) | Length | Average Throughput |
|---------|-------------|-----------|--------|--------------------|
| Static 1 | 0           | 0         | 10 hr  | 1588 Mbps          |
| Static 2 | 30          | 0         | 10 hr  | 1575 Mbps          |
| Static 3 | 60          | 0         | 10 hr  | 1568 Mbps          |
| Static 4 | 0           | 40        | 10 hr  | 1566 Mbps          |
| Static 5 | 0           | -40       | 10 hr  | 1585 Mbps          |

Figs. 4a, 4b, and 4c show that the accuracy of all three models and for all three metrics generally improves as we move from finer to coarser timescales. At timescales coarser than 40 ms, where there are no significant throughput variations, the accuracy is very high. The RMSE remains below 100 Mbps, the ARE95 metric remains below 12%, and the PARE10 metric is above 92% at these timescales. For finer timescales (10–20 ms) required for VR applications, the 95th percentile of the error is higher, ranging from 14–16% at 20 ms to 23–27% at 10 ms, due to large throughput variations at such short timescales. Nonetheless, the RMSE remains at satisfactory levels (122–175 Mbps), and 78–88% of the prediction errors are still lower than 10%. Overall, DNN models can make accurate throughput predictions at all timescales in static conditions.

When comparing the three DNN models, we observe no significant differences among them. RNN models perform slightly better in terms of RMSE and ARE95 metrics at 10 ms, but the BP model becomes slightly more accurate at coarser timescales. All three models perform similarly in terms of the PARE10 metric. Between the two RNN models, RNN8 outperforms RNN20 at all timescales except for 10 ms.

To study the impact of different angles within the FoV, we picked the best model for each angle at each timescale and plotted the RMSE in Fig. 4d. For timescales up to 100 ms, the prediction is most accurate when the phone is facing exactly towards the AP (0° azimuth, 0° pitch). At coarser timescales, there is no clear trend. In most cases, the 60° azimuth trace has the worst RMSE, likely because at 60° azimuth, the AP is very close to the edge of the phone's FoV (Section 3.1), leading to higher throughput variations. In terms of pitch, +40° has lower RMSE for some timescales, while -40° has lower RMSE for other timescales. Overall, in static conditions, the model performance is not significantly affected by the azimuth or pitch angles.

**Feature Selection**

To determine the most useful features for prediction, we performed an iterative feature removal exercise. We started with all N features, temporarily removed one feature, and trained a model using the remaining N-1 features. We then compared the resulting models and identified the least useful feature as the one whose removal resulted in the least reduction in prediction accuracy. We permanently removed this feature and iteratively repeated the process until only one feature remained. This algorithm ranks the features by their importance to the model's accuracy. We ran this algorithm for all timescales, and the results, averaged over all five datasets in Table 1, are shown in Table 2 for the BP8 model and three representative timescales (10 ms, 100 ms, and 2000 ms).

**Table 2: Feature Selection for Static Traces**

| Removal Step | 10 ms RMSE | 100 ms RMSE | 2000 ms RMSE |
|--------------|------------|-------------|---------------|
| 1            | 173.79     | 71.75       | 175.01        |
| 2            | 178.17     | 57.38       | 174.33        |
| 3            | 175.01     | 51.56       | 174.34        |
| 4            | 174.34     | 51.85       | 52.80         |
| Last Feature | 174.33     | 52.28       | 70.17         |

At the 10 ms timescale, removing SQI, MCS, and Tx Sector marginally improves the RMSE. However, removing RSSI (and thus using only past throughput) increases the RMSE by ~5 Mbps. Thus, at the 10 ms timescale, past throughput is the most important feature, followed by RSSI.

Surprisingly, at coarser timescales (100 ms and 2000 ms), throughput is the least important feature. Excluding throughput from the input features improves the RMSE by 6 Mbps at 2000 ms. On the other hand, MCS, which was not very important at the 10 ms timescale, becomes the most important feature at coarser timescales.

### 3.3 Mobile Scenarios

In this section, we explore the impact of realistic smartphone motion patterns (typical in applications like VR and 360° video streaming) on throughput prediction. We collected a 10-hour long trace, where the phone moved simultaneously in the azimuth, pitch, and slide dimensions at different speeds. In the azimuth dimension, the phone moved in the [-60°, 60°] range at speeds between 10°/s and 40°/s. In the pitch dimension, the phone moved in the [-40°, 40°] range at speeds between 6°/s and 20°/s. These speeds represent typical VR motion speeds [26, 48]. In the slide dimension, the phone moved at a speed of 0.05 m/s (the maximum speed supported by the Cinetics slider). We found that, at such low speeds, translational motion along the 1 m slider has no impact on throughput. Hence, we do not include the y-coordinate or the acceleration along the y-axis in our feature set.

As expected, the prediction accuracy under mobility worsens (Fig. 5) with all three models and for all three metrics compared to the static scenarios (Figs. 4a, 4b, 4c). The RMSE ranges from 92–258 Mbps (vs. 50–175 Mbps in Fig. 4a), the ARE95 metric ranges from 12–40% (vs. 5–27% in Fig. 4b), and the PARE10 metric from 59–94% (vs. 78–98% in Fig. 4c). Nonetheless, prediction at timescales of 100 ms or higher retains high accuracy. Interestingly, we observe a "sweet spot" at 400 ms with respect to all three metrics, which was not present in the static scenarios. This suggests that motion introduces an interesting trade-off between the length of history as input and the prediction window in the future.

At timescales of 1 and 2 s, corresponding to video streaming applications, the accuracy remains at satisfactory levels; the 95th percentile of the error is below 20%, and about 89% of the errors are lower than 10%. On the other hand, the accuracy drops significantly at VR timescales (10 and 20 ms). Specifically, the ARE95 metric ranges between 38–40% and 26–29%, and the PARE10 metric is below 60% and 70%, respectively.

Finally, when comparing the accuracy of the three models, we observe that the RNN models perform slightly better for up to 40 ms, and the BP model performs better at coarser timescales. However, the difference in performance among the three models is even smaller compared to the results in Fig. 4.

**Feature Selection**

Table 3 shows the feature selection results in random mobility scenarios. Similar to the results in Table 2, we observe that throughput is the most important feature for only the 10 ms and 20 ms timescales, while for all coarser timescales, MCS becomes the most important feature. At 10 ms, RSSI remains the second most important feature, same as in Table 2, while the phone’s pitch and azimuth do not contribute much to the accuracy. In contrast, at 2000 ms, azimuth and pitch are the most important features after MCS. At 100 ms, the contribution of all features other than throughput and MCS is marginal.

**Table 3: Feature Selection for Random Motion Traces**

| Removal Step | 10 ms RMSE | 100 ms RMSE | 2000 ms RMSE |
|--------------|------------|-------------|---------------|
| 1            | 117.30     | 250.98      | 258.18        |
| 2            | 110.34     | 252.39      | 254.36        |
| 3            | 110.39     | 255.01      | 256.10        |
| 4            | 98.56      | 109.12      | 109.95        |
| Last Feature | 97.57      | 108.01      | 112.67        |

This comprehensive analysis provides insights into the predictability of throughput in both static and mobile scenarios, highlighting the importance of different features at various timescales.