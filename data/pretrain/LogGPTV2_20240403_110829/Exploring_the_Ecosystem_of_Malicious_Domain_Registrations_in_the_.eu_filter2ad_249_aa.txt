title:Exploring the Ecosystem of Malicious Domain Registrations in the .eu
TLD
author:Thomas Vissers and
Jan Spooren and
Pieter Agten and
Dirk Jumpertz and
Peter Janssen and
Marc Van Wesemael and
Frank Piessens and
Wouter Joosen and
Lieven Desmet
Exploring the Ecosystem of Malicious Domain
Registrations in the .eu TLD
Thomas Vissers1(B), Jan Spooren1, Pieter Agten1, Dirk Jumpertz2,
Peter Janssen2, Marc Van Wesemael2, Frank Piessens1, Wouter Joosen1,
and Lieven Desmet1
{thomas.vissers,jan.spooren,pieter.agten,frank.piessens,wouter.joosen,
1 Imec-DistriNet, KU Leuven, Leuven, Belgium
lieven.desmet}@cs.kuleuven.be
2 EURid VZW, Brussels, Belgium
{dirk.jumpertz,peter.janssen,marc.wesemael}@eurid.eu
Abstract. This study extensively scrutinizes 14 months of registration
data to identify large-scale malicious campaigns present in the .eu TLD.
We explore the ecosystem and modus operandi of elaborate cybercrim-
inal entities that recurrently register large amounts of domains for one-
shot, malicious use. Although these malicious domains are short-lived, by
incorporating registrant information, we establish that at least 80.04%
of them can be framed in to 20 larger campaigns with varying duration
and intensity. We further report on insights in the operational aspects of
this business and observe, amongst other ﬁndings, that their processes
are only partially automated. Finally, we apply a post-factum clustering
process to validate the campaign identiﬁcation process and to automate
the ecosystem analysis of malicious registrations in a TLD zone.
Keywords: Malicious domain names · Campaigns · DNS security
1 Introduction
The Domain Name System (DNS) is one of the key technologies that has allowed
the web to expand to its current dimensions. Virtually all communication on the
web requires the resolution of domain names to IP addresses. Malicious activi-
ties are no exception, and attackers constantly depend upon functioning domain
names to execute their abusive operations. For instance, phishing attacks, dis-
tributing spam emails, botnet command and control (C&C) connections and
malware distribution: these activities all require domain names to operate.
Widely-used domain blacklists are curated and used to stop malicious domain
names1 shortly after abusive activities have been observed and reported. As a
1 We use the term malicious domain name whenever we refer to a domain name that
is registered to be bound to a malicious service or activity.
Electronic supplementary material The online version of this chapter (doi:10.
1007/978-3-319-66332-6 21) contains supplementary material, which is available to
authorized users.
c(cid:2) Springer International Publishing AG 2017
M. Dacier et al. (Eds.): RAID 2017, LNCS 10453, pp. 472–493, 2017.
DOI: 10.1007/978-3-319-66332-6_21
Exploring the Ecosystem of Malicious Domain Registrations in the .eu TLD
473
consequence, attackers changed to a hit-and-run strategy, in which malicious
domain names are operational for only a very small time window after the initial
registration, just for a single day in 60% of the cases [11]. Once domain names
have fulﬁlled their purpose, attackers can simply abandon them and register a
new set of domain names to ensure continuity of their criminal activities [24].
This strategy is economically viable to the attackers when the cost of reg-
istering a domain name is minimal. However, this approach requires repetitive
and often automated domain name registrations. We refer to these series of mali-
cious domain names registered by a single entity as campaigns. To obscure their
actions, attackers often use fake registration details and need to switch between
identities, registrars and resellers to avoid detection.
Moreover, we have observed that certain underground services pop up to
facilitate the bulk domain registration process for abusive activities. For instance,
on the darknet forum “AlphaBay”, we found several instances of “Domain and
Email Registration as a Service”. In one example2, cyber criminals register new
domain names and create fresh, private email accounts that are sold to be used
for illegal activities, such as carding.
The sheer volume of malicious domain names, as well as the fact that the
registration process is being automated and monetized, illustrates the need for
strong insights into the modus operandi of cybercriminals to produce eﬀective
countermeasures.
In this paper, we focus on the malicious campaign ecosystem by extensively
leveraging the registrant and registration details, with the goal to better under-
stand how miscreants operate to acquire a constant stream of domain names. We
rigorously investigate 14 months of .eu domain registrations, a top 10 ccTLD [15]
for the European Economic Area. Overall, the dataset of this study contains
824,121 new domain registrations; 2.53% of which have been ﬂagged as mali-
cious by blacklisting services.
Among others, the following conclusions can be drawn from this in-depth
assessment:
1. While most malicious domains are short-lived, a large fraction of them can
be attributed to a small set of malicious actors: 80.04% of the malicious regis-
trations are part of just 20 long-running campaigns. We identiﬁed campaigns
that were active for over a year, and campaigns that registered more than
2,000 blacklisted domains (Sect. 3).
2. The campaign identiﬁcation process suggests that 18.23% of malicious
domains does not end up on a blacklist (Sect. 3.3).
3. The malicious domain registration process is only partially automated: under-
ground syndicates work along oﬃce hours, take holiday breaks and make
human errors while registering domains (Sect. 4).
4. Ecosystem analysis can be automated and reproduced by leveraging clustering
algorithms. In our experiment, the 30 largest clusters formed by agglomera-
2 http://pwoah7foa6au2pul.onion/forum/index.php?threads/%E2%96%84-
%E2%96%88-%E2%98%85-paperghost-%E2%98%85-%E2%96%88-%E2%96%84-
fresh-non-hacked-private-email-logins-lower-your-fraud-detection-score-2.71566.
474
T. Vissers et al.
tive clustering encompass 91.48% of blacklisted campaign registrations. These
clusters exhibit a clear mapping with manually identiﬁed campaigns (Sect. 5).
The remainder of this paper is structured as follows. First, in Sect. 2, we
introduce the data set used in this research, along with initial insights. Next,
we perform a large scale experiment to manually identify malicious campaigns
(Sect. 3), followed by several analyses to gather more insights (Sect. 4). In Sect. 5,
we follow up with a method to automate campaign identiﬁcation. We discuss
applications and limitations in Sect. 6, followed by a summary of related work
in Sect. 7. Lastly, we conclude this study in Sect. 8.
2 Datasets and Initial Findings
In this section, we present the data used in this research and give initial insights
based on a ﬁrst, high-level analysis.
2.1 Registration Data
We analyzed 824,121 .eu domain registrations between April 1, 2015 and May 31,
2016. We inspected the following ﬁelds:
Basic registration information contains the domain name, the date and
time of registration, and the registrar via which the registration happened.
Contact information of the registrant contains the company name, name,
the language, email address, phone, fax, as well as postal address information.
We decomposed two additional attributes from the email address: the email
account and the email provider.
Nameservers or glue records that are responsible for resolving entries within
the domain. We enriched the nameserver data with their geographical location
by resolving the NS records and adding IP geolocation data.
2.2 Blacklists
To capture whether or not a domain was used in malicious activity, a set of
public blacklists was queried on a daily basis. Each new domain is monitored
daily during 1 month after registration. Afterwards, all domains were checked
once more 4 months after the last registration in our dataset. The following
blacklist services have been used:
dbl.spamhaus.org blacklist [21]. This Spamhaus blacklist is queried using
their DNS API, and provides indicators for botnet C&C domains, malware
domains, phishing domains, and spam domains.
multi.surbl.org blacklist [20]. SURBL features a combination of diﬀerent
lists, such as abuse, phishing, malware, etc. The combined SURBL list is queried
over DNS.
Google’s Safe Browsing list [7]. Google’s Safe Browsing list is queried
via a Web API, and provides indicators for malware domains, phishing domains,
and domains hosting unwanted software, as described in [8].
Exploring the Ecosystem of Malicious Domain Registrations in the .eu TLD
475
2.3 Preliminary Insights
Given the data described above, we present a preliminary analysis to provide
insights in the general trends and patterns of malicious registrations.
Malicious registrations
All registrations   
f
o
e
r
a
h
s
y
k
e
e
W
l
s
n
o
i
t
a
r
t
s
g
e
r
i
4%
3%
2%
1%
Apr 2015
Jul 2015
Oct 2015
Jan 2016
Apr 2016
Fig. 1. Weekly share of malicious and all registrations over time.
Observing the 824,121 registrations that occurred between April 1, 2015 and
May 31, 2016, we ﬁnd that 2.53% end up on a blacklist. This corresponds to a
total of 20,870 registrations used by cyber criminals in the given 14 month time
span. Figure 1 shows the weekly share of both malicious and all registrations over
this period. The diﬀerences in intensity of malicious registrations are moderately
correlated with those of all registrations (ρ = 0.54). However, the variance of
malicious registrations is clearly much larger. Most of the increased malicious
activity, for instance at the start of February 2016, can be attributed to a single
malicious campaign. These cases are discussed in depth in Sect. 3.
The selected blacklists return metadata that encode the reason(s) why a
particular domain name was ﬂagged. In our records, 93.68% of the blacklisted
domains in the dataset is labelled for spam, 2.09% for malware infrastructure,
0.57% for unwanted software, and 3.22% for phishing activities.
Most domains appear on blacklists very shortly after their registration. More
speciﬁcally, 72.93% of malicious domains were ﬂagged within 5 days of delegation.
98.57% of malicious registrations are listed on a blacklist in their ﬁrst month.
3 Campaign Identiﬁcation Experiment
Typically, illegal online activities do not occur in an isolated or dispersed fash-
ion [5,11]. Instead, malicious actors commonly set up campaigns that involve
multiple, tightly related abusive strategies, techniques and targets. Through an
in-depth, a posteriori analysis of the .eu dataset, we assessed whether such pat-
terns can be identiﬁed between domain registrations and to what extent these
registrations happen in bulk.
Ultimately, we manually identiﬁed 20 distinct campaigns responsible for
the vast majority of malicious registrations. A campaign represents a series of
476
T. Vissers et al.
registrations over time, with strong similarities in terms of registration data
(e.g. the registrar, the registrant’s address information, phone number or email
address, and the set of nameservers). Moreover, a campaign can most probably
be attributed to a single individual or organization. In this section, we ﬁrst give
a more thorough description on how these campaigns were identiﬁed, followed
by some general insights into their characteristics.
Malicious registrations outside campaigns
Malicious registrations   
s
n
o
i
t
i
a
r
t
s
g
e
r
f
o
e
g
a
t
n
e
c
r
e
P
10%
5%
0%
Apr 2015
Jul 2015
Oct 2015
Jan 2016
Apr 2016
Fig. 2. Daily percentage of malicious registrations, including and excluding campaign
registrations. The dotted lines represent the highest daily concentration of both sets.
3.1 Campaign Identiﬁcation Process
As malicious registrations often occur in batches [10,11], high temporal concen-
trations can serve as a preliminary indicator of campaign activity. Figure 2 plots
the relative amount of malicious registrations on each day. That graph can be
used to identify the time periods in which the amount of malicious registrations
was surging. If a campaign was responsible for a high concentration of malicious
registrations, a substantial subset of registrations within that timeframe should
be related to each other. Hence, all malicious registrations that occurred in that
time span are examined to ﬁnd common characteristics in the registration data.
These can be recurring values or distinct patterns in the email address, the
address info, the registrar, the registrant name, etc. To detect useful outliers,
we visualized correlations between registration ﬁelds. For example, by plotting
the email providers of the registrants versus the country listed in their street
address (as shown in Fig. 3), multiple hotspots of malicious registrations can be
found that contribute to one or more campaigns. These unique combinations
and patterns form the basis of the manually assigned campaign selection crite-
ria. To evaluate these, we apply them to the full dataset, i.e. on both benign
and blacklisted registrations, over all 14 months. If the criteria match multiple
Exploring the Ecosystem of Malicious Domain Registrations in the .eu TLD
477
active days and contain a substantial number of blacklisted domains, they are
withheld as a new campaign. This process was repeated iteratively, reducing the
number of malicious concentrations each time.
Number of Registrations ●
1000
●
2000
●
3000
Malicious registrations
not in campaigns
Malicious registrations
inside campaigns
y
r
t
n
u
o
C
SI
SE
RO
PL
NO
NL
LU
IT
IE
GR
GB
FR
ES
DE
BE
AX
AT
AOL.CO M
H...T.CC
G MX.CO M
I...I.CO M
I...V.CO M
E...R.CO M
C...K.CO M
J...N.CO M
G MAIL.CO M
G...A.CO M
L...L.LU
IDSHIELD.TK
M...L.CO M
L...T.FR
MAIL.RU
N...X.CO M
W...E.CO M
OUTLOOK.CO M
S...T.CO M
S...R.WF
P...P.NET
MSN.CO M
U...K.CO M
S...T.NET
YANDEX.CO M
YAHOO.CO M
YANDEX.RU
Email provider
Fig. 3. Malicious registrations, grouped by email provider and country of the registrant.
For visibility, combinations with less that 50 registrations are left out of the ﬁgure.
Moreover, email providers with less than 50 distinct email addresses in the dataset
have been obfuscated for privacy reasons.
Over the complete dataset, we identify 20 distinct campaigns. A variety of
attributes of the registration details have been used to characterize a campaign,
the speciﬁcs for each campaign are listed in Table 1.
3.2 General Campaign Observations
The activity of the 20 identiﬁed campaigns is depicted in Fig. 4. A ﬁrst observa-
tion is that most of the campaigns are long-living: only one campaign runs for
less than a month, while some campaigns run up to a year and more3.
Secondly, campaigns strongly vary in their activity patterns. Some campaigns
are active on almost a daily basis (e.g. campaign c 19), whereas others only
have a few distinct active days throughout their lifetime (e.g. campaign c 07).
Similarly, campaigns vary in concentration. An intense, six week campaign was
for instance responsible for almost 2,000 new registrations (c 20), whereas one
3 Note that some campaigns might be running even longer than 372 days, as they
might have been active before the starting date of our dataset (campaigns c 01 -
c 05) or they may still be active past the time span that is covered in our dataset.
478
T. Vissers et al.
Table 1. Attributes used to express the selection criteria of a campaign. ● represents
a string match, and ✩ a regular expression pattern.
i
s
n
g
a
p
m
a
C
c_01
c_02
c_03
c_04
c_05
c_06
c_07
c_08
c_09
c_10
c_11
c_12
c_13
c_14
c_15
c_16
c_17
c_18
c_19
c_20
Registrations per day
100
200
300
400
TOTAL MALICIOUS REGISTRATIONS:
 879
1333
1715
1672
 177
 194
  93
 324
1624
 125
1275
 490
 154
 989
 514
 842
 283
1291
 752
1978
Apr
2015
May
2015
Jun
2015
Jul
2015
Aug
2015
Sep
2015
Oct
2015
Nov
2015
Dec
2015
Jan
2016
Feb
2016
Mar
2016
Apr
2016
May
2016
Jun
2016
Fig. 4. Campaign duration and activity over time. The black lines represent the over-
all duration of the campaign, while the black dots indicate the number of malicious
registrations on that day.
steady campaign ran over 10 months and produced only 154 malicious registra-
tions (c 13).
A third observation is that campaigns contribute to a large fraction of mali-
cious registrations found in the .eu registration data. Together, the 20 campaigns
cover 16,704 domain registrations, that appeared on blacklists. This represents
80.04% of the 20,780 blacklisted registrations in our dataset.
Lastly, not all registrations identiﬁed as part of a campaign are ﬂagged as
malicious. In total, 19.30% of the campaign registrations we identiﬁed are not
known as abusive domains by blacklisting services. A more in-depth analysis
of these potential false positives is discussed in Sect. 3.3. Note that to avoid
any bias, Fig. 4 only include registrations that appeared on blacklists, and thus
represent a lower bound of campaign activity.
Exploring the Ecosystem of Malicious Domain Registrations in the .eu TLD
479
3.3 Validation of Campaign Selection Criteria
As brieﬂy mentioned in the previous section, 19.30% of the registrations asso-
ciated with malicious campaigns do not appear on blacklists. We expect that