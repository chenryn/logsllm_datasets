respect [for] your time and value.
Don’t Shout Hello Before Crossing the Pond
On March 17, 2016, Mathias Karlsson wrote an awesome blog post about potentially
findingaSameOriginPolicy(SOP)bypass(asameoriginpolicyisasecurityfeaturewhich
define how web browsers allow scripts to access content from websites) and was nice
enough to let me include some of the content here. As an aside, Mathias has a great
record on HackerOne - as of March 28, 2016, he’s 97th percentile in Signal and 95th for
Impact with 109 bugs found, companies including HackerOne, Uber, Yahoo, CloudFlare,
etc.
So, “Don’t shout hello before you cross the pond” is a Swedish saying meaning you
shouldn’t celebrate until you are absolutely certain. You can probably guess why I’m
including this - hacking ain’t all sunshine and rainbows.
AccordingtoMathias,hewasplayingwithFirefoxandnoticedthatthebrowserwouldac-
ceptmalformedhostnames(onOSX),sotheURLhttp://example.com..wouldloadexam-
ple.combutsendexample.com..inthehostheader.Hethentriedhttp://example.comevil.com
and got the same result.
He instantly knew that this mean SOP could be bypassed because Flash would treat
http://example.com..evil.com as being under the *.evil.com domain. He checked the
Alexa top 10000 and found that 7% of sites would be exploitable including Yahoo.com.
1https://www.quora.com/How-do-I-become-a-successful-Bug-bounty-hunter
VulnerabilityReports 168
He created a writeup but decided to do some more confirming. He checked with a co-
worker,yup,theirVirtualMachinealsoconfirmedthebug.HeupdatedFirefox,yup,bug
was still there. He then hinted on Twitter about the finding. According to him, Bug =
Verified, right?
Nope.Themistakehemadewasthathedidn’tupdatehisoperatingsystemtothenewest
version.Afterdoingso,thebugwasdead.Apparentlythiswasreportedsixmonthsprior
and updating to OSX Yosemite 10.10.5 fixed the issue.
I include this to show that even great hackers can get it wrong and it’s important to
confirm the exploitation of a bug before reporting it.
HugethankstoMathiasforlettingmeincludethis-IrecommendcheckingouthisTwitter
feed @avlidienbrunn and labs.detectify.com where Mathias wrote about this.
Parting Words
HopefullythisChapterhashelpedyouandyou’rebetterpreparedtowriteakillerreport.
Before you hit send, take a moment and really think about the report - if it were to be
disclosed and read publicly, would you be proud?
Everything you submit, you should be prepared to stand behind and justify it to the
company, other hackers and yourself. I don’t say this to scare you off but as words
of advice I wish I had starting out. When I began, I definitely submitted questionable
reports because I just wanted to be on the board and be helpful. However, companies
get bombarded. It’s more helpful to find a fully reproducible security bug and report it
clearly.
Youmaybewonderingwhoreallycares-letthecompaniesmakethatcallandwhocares
whatotherhackersthink. Fairenough.But atleastonHackerOne, yourreportsmatter-
your stats are tracked and each time you have a valid report, it is recorded against your
Signal, a stat ranging from -10 to 7 which averages out the value of your reports:
• Submit spam, you get -10
• Submit a non-applicable, you get -5
• Submit an informative, you get 0
• Submit a report that is resolved, you get 7
Again, who cares? Well, Signal is now used to determine who gets invited to Private
programsandwhocansubmitreportstopublicprograms.Privateprogramsaretypically
fresh meat for hackers - these are sites that are just getting into the bug bounty
programandareopeningtheirsitetoalimitednumberofhackers.Thismeans,potential
vulnerabilities with less competition.
As for reporting to other companies - use my experience as a warning story.
VulnerabilityReports 169
I was invited to a private program and within a single day, found eight vulnerabilities.
However, that night, I submitted a report to another program and was given an N/A.
This bumped my Signal to 0.96. The next day, I went to report to the private company
againandgotanotification-mySignalwastoolowandI’dhavetowait30daystoreport
to them and any other company that had a Signal requirement of 1.0.
That sucked! While nobody else found the vulnerabilities I found during that time, they
couldhavewhichwouldhavecostmemoney.EverydayIcheckedtoseeifIcouldreport
again. Since then, I’ve vowed to improve my Signal and you should too!
Good luck hunting!
23. Tools
Belowisalaundrylistoftoolswhichareusefulforvulnerabilityhunting,innoparticular
order. While some automate the process of searching for vulnerabilities, these should
not replace manual work, keen observation and intuitive thinking.
MichielPrins,Co-FounderofHackerone,deservesahugethanksforhelpingtocontribute
to the list and providing advice on how to effectively use the tools.
Burp Suite
https://portswigger.net/burp
Burp Suite is an integrated platform for security testing and pretty much a must when
you are starting out. It has a variety of tools which are helpful, including:
• An intercepting proxy which lets you inspect and modify traffic to a site
• AnapplicationawareSpiderforcrawlingcontentandfunctionality(eitherpassively
or actively)
• A web scanner for automating the detection of vulnerabilities
• A repeater for manipulating and resending individual requests
• A sequencer tool for testing the randomness of tokens
• A comparer tool to compare requests and responses
Bucky Roberts, from the New Boston, has a tutorial series on Burp Suite available at
https://vimeo.com/album/3510171 which provides an introduction to Burp Suite.
ZAP Proxy
https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project
The OWASP Zed Attack Proxy (ZAP) is a free, community based, open source platform
similar to Burp for security testing. It also has a variety of tools, including a Proxy,
Repeater, Scanner, Directory/File Bruteforcer, etc. It also supports add-ons so if you’re
a developer, you can create additional functionality. Their website has a lot of useful
information to help you get started.
Tools 171
Knockpy
https://github.com/guelfoweb/knock
Knockpy is a python tool designed to iterate over a huge word list to identify sub
domains of a company. Identifying sub domains helps to increase the testable surface
of a company and increase the chances of finding a successful vulnerability.
This is a GitHub repository which means you’ll need to download the repo (the GitHub
pagehasinstructionsastohow)andneedPythoninstalled(theyhavetestedwithversion
2.7.6 and recommend you use Google DNS (8.8.8.8 | 8.8.4.4).
HostileSubBruteforcer
https://github.com/nahamsec/HostileSubBruteforcer
This app, written by @nahamsec (Ben Sadeghipour - great guy!), will bruteforce for
existingsubdomainsandprovidetheIPaddress,Hostandwhetherithasbeenproperly
setup,checkingAWS,Github,Heroku,Shopify,TumblrandSquarespace.Thisisgreatfor
finding sub domain takeovers.
Sublist3r
https://github.com/aboul3la/Sublist3r
Accordingtoit’sREADME.md,Sublist3rispythontoolthatisdesignedtoenumeratesub
domains of websites using search engines. It helps penetration testers and bug hunters
collect and gather sub domains for the domain they are targeting. Sublist3r currently
supportsthefollowingsearchengines:Google,Yahoo,Bing,Baidu,andAsk.Moresearch
engines may be added in the future. Sublist3r also gathers sub domains using Netcraft,
Virustotal, ThreatCrowd, DNSdumpster and PassiveDNS.
The tool, subbrute, was integrated with Sublist3r to increase the possibility of finding
more sub domains using bruteforce with an improved wordlist. The credit goes to
TheRook who is the author of subbrute.
crt.sh
https://crt.sh
AsearchsiteforbrowsingCertificateTransactionlogs,revealingsubdomainsassociated
with certificates.
Tools 172
IPV4info.com
http://ipv4info.com
This is a great site that I just learned about thanks to Philippe Harewood (again!). Using
this site, you can find domains hosted on a given server. So, for example, entering
yahoo.com will give you Yahoo’s IPs range and all the domains served from the same
servers.
SecLists
https://github.com/danielmiessler/SecLists
While technically not a tool in and of itself, SecLists is a collection of multiple types of
lists used during hacking. This includes usernames, passwords, URLs, fuzzing strings,
commondirectories/files/subdomains,etc.TheprojectismaintainedbyDanielMiessler
and Jason Haddix (Hacking ProTips #5 guest)
XSSHunter
https://xsshunter.com
XSSHunter is a tool developed by Matt Bryant1 (formerly of the Uber security team)
whichhelpsyoufindblindXSSvulnerabilities,orXSSthatyoudon’tseefireforwhatever
reason. After signing up for XSSHunter, you get a special xss.ht short domain which
identifies your XSS and hosts your payload. When the XSS fires, it will automatically
collects information about where it occurred and will send you an email notification.
sqlmap
http://sqlmap.org
sqlmap is an open source penetration tool that automates the process of detecting and
exploitingSQLinjectionvulnerabilities.Thewebsitehasahugelistoffeatures,including
support for:
• A wide range of database types (e.g., MySQL, Oracle, PostgreSQL, MS SQL Server,
etc.)
• Six SQL injection techniques (e.g., boolean-based blind, time-based blind, error-
based, UNION query-based, etc)
1https://twitter.com/iammandatory
Tools 173
• Enumeratingusers,passwordhashes,privileges,roles,databases,tablesandcolumns
• And much more
According to Michiel Prins, sqlmap is helpful for automating the exploitation of SQL
injection vulnerabilities to prove something is vulnerable, saving a lot of manual work.
Similar to Knockpy, sqlmap relies on Python and can be run on Windows or Unix based
systems.
Nmap
https://nmap.org
Nmap is a free and open source utility for network discover and security auditing.
According to their site, Nmap uses raw IP packets in novel ways to determine: - Which
hosts are available on a network - What services (application name and version) those
hosts are offering - What operating systems (and versions) they are running - What type
of packet filters/firewalls are in use - And much more
TheNmapsitehasarobustlistofinstallationinstructionssupportingWindows,Macand
Linux.
Eyewitness
https://github.com/ChrisTruncer/EyeWitness
EyeWitnessisdesignedtotakescreenshotsofwebsites,providesomeserverheaderinfo
and identify default credentials if possible. It’s a great tool for detecting what services
are running on common HTTP and HTTPS ports and can be used with other tools like
Nmap to quickly enumerate hacking targets.
Shodan
https://www.shodan.io
Shodan is the internet search engine of “Things”. According to the site, you can, “Use
Shodan to discover which of your devices are connected to the internet, where they are
located and who is using them”. This is particularly helpful when you are exploring a
potentialtargetandtryingtolearnasmuchaboutthetargetsinfrastructureaspossible.
Combined with this is a handy Firefox plugin for Shodan which allows you to quickly
accessinformationforaparticulardomain.Sometimesthisrevealsavailableportswhich
you can pass to Nmap.
Tools 174
Censys
https://censys.io
Censysisasearchenginethatenablesresearcherstoaskquestionsaboutthehostsand
networksthatcomposetheInternet.Censyscollectsdataonhostsandwebsitesthrough
daily ZMap and ZGrab scans of the IPV4 address space, in turn maintaining a database
of how hosts and websites are configured.
What CMS
http://www.whatcms.org
What CMS is a simple application which allows you to enter a site url and it’ll return the
likely Content Management System the site is using. This is helpful for a couple reason:
• Knowing what CMS a site is using gives you insight into how the site code is
structured
• IftheCMSisopensource,youcanbrowsethecodeforvulnerabilitiesandtestthem
on the site
• If you can determine the version code of the CMS, it’s possible the site may be
outdated and vulnerable to disclosed security vulnerabilities
BuiltWith
http://builtwith.com
BuiltWith is an interesting tool that will help you fingerprint different technologies used
on a particular target. According to its site, it covers over 18,000 types of internet
technologies, including analytics, hosting, which CMS, etc.
Nikto
https://cirt.net/nikto2
Nikto is an Open Source web server scanner which tests against servers for multiple
items, including:
• Potentially dangerous files/programs
• Outdated versions of servers
• Version specific problems
Tools 175
• Checking for server configuration items
According to Michiel, Nikto is helpful for finding files or directories that should not be
available (e.g., an old SQL backup file, or the inside of a git repo)
Recon-ng
https://bitbucket.org/LaNMaSteR53/recon-ng
According to its page, Recon-ng is a full featured Web Reconnaissance framework
written in Python. It provides a powerful environment in which open source web-based
reconnaissance can be conducted quickly and thoroughly.
Unfortunately,orfortunatelydependingonhowyouwanttolookatit,Recon-ngprovides
so much functionality that I can’t adequately describe it here. It can be used for sub
domaindiscovery,sensitivefilediscovery,usernameenumeration,scrapingsocialmedia
sites, etc.
GitRob
https://github.com/michenriksen/gitrob
Gitrob is a command line tool which can help organizations and security professionals
find sensitive information lingering in publicly available files on GitHub. The tool will it-
erateoverallpublicorganizationandmemberrepositoriesandmatchfilenamesagainst
a range of patterns for files that typically contain sensitive or dangerous information.
CyberChef
https://gchq.github.io/CyberChef/
CyberChef is a swiss army knife providing all kinds of encoding/decoding tools. It also
provides functionality to save a list of favorites, download results, among many other
things.
OnlineHashCrack.com
www.onlinehashcrack.com
OnlineHash Crackis anonline servicethat attemptsto recoveryour passwords(hashes
like MD5, NTLM, Wordpress, etc), your WPA dumps (handshakes) and your MS Office
encryptedfiles(obtainedlegally).Itisusefultohelpidentifywhattypeofhashisusedif
you don’t know, supporting the identification of over 250 hash types.
Tools 176
idb
http://www.idbtool.com
idb is a tool to help simplify some common tasks for iOS app security assessments and
research. It’s hosted on GitHub.
Wireshark
https://www.wireshark.org
Wireshark is a network protocol analyzer which lets you see what is happening on your
network in fine detail. This is more useful when a site isn’t just communicating over
HTTP/HTTPS. If you are starting out, it may be more beneficial to stick with Burp Suite if
the site is just communicating over HTTP/HTTPS.
Bucket Finder
https://digi.ninja/files/bucket_finder_1.1.tar.bz2
A cool tool that will search for readable buckets and list all the files in them. It can
also be used to quickly find buckets that exist but deny access to listing files - on these