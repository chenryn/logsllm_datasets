Connection: keep-alive
Server: Apache/1.3.37 (Unix)
Cache-Control: no-cache
9f65
No data!
In this example from Symantec, several indicators can be identified.
The POST request shows several indicators that may be incorporated into an emulated threat:
●
A target PHP file (dtcla.php)
●
Interesting URL parameters (id, v1, v2, q)
●
A potentially interesting User-Agent
●
A target host
Like the request, the response has several indicators:
●
A server header
●
A potentially unique ID (9f65)
●
Base64-encoded data stored between text (havex  havex)
Note: MALWAREMUSTDIE2 posted a great write-up on the HAVEX malware. This provides
additional examples of C2 source code and HTTP request/response pairs. Reference:
http://pastebin.com/qCdMwtZ6
Create a threat profile
1) Use the research you conducted and this information to create a threat profile. There is no right or
wrong answer. The important components of a threat profile are technical feasibility, ability to meet
engagement goals, and ability to implement using your Red Team’s tools and ability.
Tips
● Profiles must be technically feasible. If your profile calls for the use of zero-days, make
sure you can deliver. (white carding and assumed breach models may help)
● Threat profiles are implemented as part of the C2 plan. They directly influence the
selection and configuration of C2. Always consider the technical capabilities and
limitations of your C2 platforms when designing a profile
2) Develop your profile using the following template then compare to the possible solution.
Possible Solution
Think about the following questions:
How does your solution compare?
Do you have the technical ability to execute this profile?
Did you copy the exact techniques from the reference example, or did you fill in the gaps with other
techniques?
Are you prepared to explore unfamiliar techniques to better mimic the reference example?
Glossary of Terms
Assumed Breach
The Assumed Breach Model assumes a threat has some level of access to a target at the initiation of
the engagement.
This model is arguably the most beneficial of all the models. The threat is assumed to have some
level of access to a target before beginning. This starts a scenario much further into the attack
timeline. Assuming someone can breach a network is often argued by less mature organizations.
Those who say "prove it" will often not like this scenario. Less mature organizations assume that
threats must prove they can get in before beginning. When is the proof important? It is important only
if measuring the ability a threat has to "get in" is important. If this is not a key goal, using the Assumed
Breach Model will save time and money. It will free the Red Team to explore higher impact goals.
Blue Cell
The blue cell is the opposite side of red. Is it all the components defending a target network. The blue
cell is typically comprised of blue team members, defenders, internal staff, and an organization’s
management.
Blue Team
A security team that defends against threats.
Command and Control (C2)
Command and Control (C2) is the influence an attacker has over a compromised computer system that
they control.
C2 Tiers
Designing a robust C2 infrastructure involves creating multiple layers of Command and Control.
These can be described as tiers. Each tier offers a level of capability and covertness. The idea of
using multiple tiers is the same as not putting all your eggs in one basket. If C2 is detected and
blocked, having a backup will allow operations to continue.
C2 tiers generally fall into three categories: Interactive, Short Haul, and Long Haul. These are
sometimes labeled as Tier 1, 2, or 3. There is nothing unique to each tier other than how they are to be
used.
Interactive tier
● Used for general commands, enumeration, scanning, data exfiltration, etc.
● This tier has the most interaction and is at the greatest risk of exposure.
● Plan to lose access from communication failure, agent failure, or Blue Team actions.
● Run enough interactive sessions to maintain access. Although interactive, this doesn’t
mean blasting the client with packets. Use good judgment to minimize interaction just
enough to perform an action.
Short haul tier
● Used as a backup to reestablish interactive sessions.
● Use covert communications that blend in with the target.
● Slow callback times. Callback times in the 1–24 hr. range are common.
Long haul tier
- The same as Short Haul but even lower and slower.
- Slow callback times. Callback times of 24+ hours are common.
Deconfliction
Deconfliction is the ability to identify which activity is generated by a Red Team and which is not. In
general, the deconfliction provide a way to separate Red Team activity from real-world activity
through a controlled process.
Engagement / Exercise Control Group (ECG)
The Engagement (or Exercise) Control Group is ultimately responsible for all activities conducted
during the engagement. Most often, the Engagement Control Group is composed of one or two senior
managers from the target environment (for example a Chief Information Officer or Chief Operating
Officer), one member from the Information Technology department of the environment, a White Cell
liaison, and a Red Team liaison. More may be added as required. All must be Trusted Agents.
Exfiltration
Exfiltration is the extraction of information from a target. This is typically through a covert channel.
Get In, Stay In, Act
The three main phases of a Red Team engagement.
Get In
Gain access to a network. The Red Team must have access to their target. Access can be
through a legitimate compromise or access is directly granted as part of an assumed breach
scenario, such as an insider threat scenario
Stay In
Establish persistence or a permanent presence. Red Team engagements are typically longer
than other types of tests. A Red Team usually establishes persistence or a permanent
presence in order to survive the duration of the engagement.
Act
Phase where a Red Team performs operational impacts against a target.
IOC (Indicator of Compromise)
Indicators of Compromise (IOCs) are artifacts that identify or describe threat actions.
OPFOR
An Opposing Force, or enemy force, that is typically used by the military in war-gaming scenarios.
Red Teams are commonly associated with or support an OPFOR in war-gaming scenarios.
OPLOG (Operator Log)
Operator logs are the records generated by Red Team operators during an engagement. These logs
have specific and required fields that must be captured.
Operational Impact
An operational impact is the effect of a goal-driven action within a target environment.
OPSEC
OPSEC or Operational Security is a process that identifies critical information to determine if
friendly actions can be observed by enemy intelligence, determines if information obtained by
adversaries could be interpreted to be useful to them, and then executes selected measures that
eliminate or reduce adversary exploitation of friendly critical information. In terms of Red Teaming,
it is understanding what actions Blue can observe and minimizes exposure.
Outbrief, Executive
The first post-engagement meeting is usually the executive outbrief. An executive brief is typically
performed soon after execution completes (within one or two days following execution). This meeting
is tailored toward management and should include key personnel from the target organization. The
outcome of a Red Team engagement may impact how an organization operates in the future,
potentially requiring funding to pursue mitigations or staffing modifications. Management awareness
and buy-in are critical if Red Team results will be used to improve an organization's security stance
to defend and respond to a threat.
Outbrief, Technical
The technical outbrief (aka a tech-on-tech) is a bi-directional technical exchange of information
between the Red Team, the Blue Team, and the organization. During this exchange, both the Red and
the defensive elements provide a highly detailed, step-by-step technical review of the actions and
results (including all associated details) of the engagement. This is where training and education meet
and is one of the most valuable opportunities for all parties to learn.
Persistence
Persistence is the ability or techniques used to establish a permanent presence in order to survive the
duration of the engagement.
Prepositioning
Prepositioning is the process of using the access and capabilities gained during an engagement to best
position an operator for the execution of an impact.
Red Cell
The term red cell is borrowed from the military. It is commonly associated with a group that plays
OPFOR (opposing force) during red vs. blue exercises. A red cell is the components that make up the
offensive portion of a red team engagement that simulates the strategic and tactical responses of a
given target. The red cell is typically comprised of red team leads and operators and is commonly
referred to as Red Team instead of Red Cell.
Red Team
A Red Team is an independent group that, from the perspective of a threat or adversary, explores
alternative plans and operations to challenge an organizatioøn to improve its effectiveness.
Red Team Lead
Serves as the operational and administrative lead for the Red Team. Conducts engagement, budget,
and resource management for the Red
Team, Provides oversight and guidance for engagements, capabilities, and technologies. Ensures
adherence to all laws, regulations, policies, and Rules of Engagement.
Red Team Operator
Complies with all Red Team requirements under the direction of the Red Team Lead. Operational
executor of the engagement. Applies Red Team TTPs to the engagement. Provides technical research
and capability to the Red Team. Keeps detailed logs during each phase of the engagement. Provides
log and information support for creation of the final report
Rules of Engagement (ROE)
The Rules of Engagement establish the responsibilities, relationships, and guidelines among the Red
Team, the customer, the system owner, and any stakeholders required for engagement execution.
Situational Awareness
Situational awareness is a step in a Red Team engagement used gather as much information as needed
on the targets and target environment. The information gathered is used to determine the next actions
towards privilege escalation, lateral movement, or other steps. It is is a key component to Red
Teaming and should be performed to some level on all access targets.
Threat
A threat is an expression of intention to inflict evil, injury, or damage.
Threat Emulation
Threat Emulation Threat Emulation is the process of mimicking the TTPs of a specific threat.
Threat Intelligence
Threat intelligence is information that has been aggregated, transformed, analyzed, interpreted, or
enriched to provide the context for decision-making processes regarding threats.
Threat Model
A threat model is the process by which potential threats or the absence of appropriate safeguards, can
be identified, enumerated, and mitigations can be prioritized.
Threat Perspective
a Threat's Perspective is the threat's initial point of view. This perspective is used to build and shape
a threat profile or scenario. A threat's perspective may be that of an outsider, nearsider, or insider.
Threat Profile
A threat profile is used to establish the rules as to how a Red Team will act and operate. These rules
serve as a roadmap for a Red Team by guiding how and what type of actions should be performed.
Threat profiles are a key part of developing and designing C2 early in Red Team planning.
Threat Scenario
Scenarios provide insight into how a defensive solution will perform and conform to the processes,
procedures, policies, activities, personnel, organizations, environment, threats, constraints,
assumptions, and support involved in the security mission. Scenarios generally describe the role of
the threat, how it will interact with the systems and networks within the target environment, and
elicits real-world truth of how essential internal practices are employed. In short, it answers how the
target's security operations would dynamically perform an action to deliver results, outputs, or prove
capability.
Tradecraft
Tradecraft is the techniques and procedures of espionage. Tradecraft is typically associated with the
intelligence community. TTPs and Tradecraft are used interchangeably in this course.
Trusted Agent (TA)
The Trusted Agent’s primary role is to limit irreversible damage and risk to life, limb, eyesight, and
equipment; however, they are more often used to prevent the defenders from causing unexpected self-
inflicted damage.
A Trusted Agent (TA) has privileged and detailed knowledge of engagement activities, milestones,
conditions, and the engagement status that would unduly bias or influence the actions of the
environment staff and defenders. A Trusted Agent must protect all information from being provided to
any party without the express approval of the Engagement Control Group.
TTPs
TTPs are Tactics, Techniques and Procedures (sometimes called Tools, Techniques, and Procedures).
Two Person Integrity (TPI)
Two-person integrity is used to verify activities performed during the engagement and should be
maintained at all times. A team member should review, understand, and provide a “sanity check” for
each action/command performed. TPI reduce personal and engagement risks.
Web Shell
A web shell is a piece of web code that is placed on an Web server to allow an adversary to use the
Web server as a gateway into a network. Web shells are commonly deployed as part of an application
security attack.
White Cell
Serves as referee between Red Team activities and defender responses during an engagement.
Controls the engagement environment/network. Monitors adherence to the ROE. Coordinates
activities required to achieve engagement goals. Correlates Red Team activities with defensive
actions. Ensures the engagement is conducted without bias to either side.
[1]
"Office Space (1999) - IMDb." https://www.imdb.com/title/tt0151804/.
[2]
"Threat | Definition of Threat at Dictionary.com." https://www.dictionary.com/browse/threat.
[3]
"ISO IEC 27000 2014 Information Security Definitions - Praxiom." https://www.praxiom.com/iso-27000-definitions.htm.
[4]
"threat - Glossary | CSRC - NIST Computer Security Resource ...." https://csrc.nist.gov/glossary/term/threat.
[5]
"Reviving DDE: Using OneNote and Excel for Code Execution ...." 29 Jan. 2018, https://enigma0x3.net/2018/01/29/reviving-dde-
using-onenote-and-excel-for-code-execution/.
[6]
"Hashdump without the DC using DCSync (because we all ...." 2 Oct. 2015, https://silentbreaksecurity.com/invoke-dcsync-because-
we-all-wanted-it/.
[7]
"CVE-2017-0144 - The MITRE Corporation." https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144
[8]
"NIST SP 800-53 - NIST Page." 4 Apr. 2013, https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf.
[9]
"PCI Security Standards Council." https://www.pcisecuritystandards.org/.
[10]
"Health Information Privacy | HHS.gov." https://www.hhs.gov/hipaa/index.html.
[11]
"Cybersecurity Framework | NIST." https://www.nist.gov/cyberframework.
[12]
"How Hacking Team got hacked | Ars Technica." 19 Apr. 2016, https://arstechnica.com/information-technology/2016/04/how-
hacking-team-got-hacked-phineas-phisher/.
[13]
"PsExec - Windows Sysinternals | Microsoft Docs." 28 Jun. 2016, https://docs.microsoft.com/en-us/sysinternals/downloads/psexec
[14]
"Nmap: the Network Mapper - Free Security ...." https://nmap.org/
[15]
"Nmap Network Scanning—The Official Nmap Project Guide to ...." https://nmap.org/book/.
[16]
"Metasploit | Penetration Testing Software, Pen Testing ...." https://www.metasploit.com/.
[17]
"Jeff Dimmock (@bluscreenofjeff) | Twitter." https://twitter.com/bluscreenofjeff.
[18]
"Cobalt Strike." https://www.cobaltstrike.com/..
[19]
"PowerShell Empire | Building an Empire with PowerShell." https://www.powershellempire.com/.
[20]
"Domain Fronting - Enterprise | MITRE ATT&CK™." 16 Jan. 2018, https://attack.mitre.org/techniques/T1172/.
[21]
"Risk Management - Army Publishing Directorate - Army.mil." 14 Apr. 2014,
https://armypubs.army.mil/epubs/DR_pubs/DR_a/pdf/web/atp5_19.pdf.
[22]
"NIST Special Publication 800-30 Revision 1, Guide for ...." https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-
30r1.pdf.
[23]
"Chris Crowley (@CCrowMontance) | author of SANS MGT535, MGT517, and SOC-Class." https://twitter.com/ccrowmontance?
lang=en.
[24]
"Enterprise Detection & Response: The ...." http://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html.
[25]
"Threat Mitigation Strategies - Threatexpress." https://threatexpress.com/blogs/2018/threat-mitigation-strategies-observations-
recommendations/..
[26]
"Threat Mitigation Strategies Part 2 - Threatexpress." 15 May. 2018, https://threatexpress.com/blogs/2018/threat-mitigation-
strategies-technical-recommendations-and-info-part-2/.
[27]
"Wald, Abraham. (1943). A Method of Estimating Plane Vulnerability Based on Damage of Survivors. Statistical Research Group,
Columbia University. CRC 432” — reprint from July 1980, http://www.dtic.mil/get-tr-doc/pdf?
AD=ADA091073&Location=U2&doc=GetTRDoc.pdf.