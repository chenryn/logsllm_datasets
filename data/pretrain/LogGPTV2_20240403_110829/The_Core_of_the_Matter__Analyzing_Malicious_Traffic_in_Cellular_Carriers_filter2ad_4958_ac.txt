 1
 10
 100
 1000
 10000
Volume of Qnames
 10
 100
 1000
 10000
Volume of Qnames
Figure 4: Per host (in HOST Sall) qname distribution of DNS evidence. These experiments demonstrates that the
hosts in HOST Sall have a signiﬁcant historic presence in pDNS data collected from non-cellular networks.
s
t
s
e
u
q
e
R
f
o
e
m
u
o
V
l
1T
100G
10G
1G
100M
10M
1M
100k
10k
MBL
PBL
URL
MAL
Total
100G
10G
1G
100M
10M
1M
100k
10k
1k
100 
DDNS
MBL
PBL
URL
MAL
TOTAL
4/15-4/21
5/13-5/19
6/17-6/23
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14 15 16 17 18 19 20 21 22 23
Figure 5: Volume of requests to domains with malicious
evidence visited by mobile devices in cellular network.
Figure 6: Hourly analysis of request volume for various
types of domains observed from mobile devices.
non-mobile evidence database, we also used a mobile black-
list (MBL) containing 2,914 domains known to be asso-
ciated with mobile malware or mobile malware operators.
Figure 5 shows the volume of DNS lookup requests from
mobile devices in our cellular dataset that could be directly
linked with different classes of non-mobile and mobile evi-
dence.
Additionally, a diurnal analysis of the volume of requests
that can be directly associated with different types of mali-
cious evidence can be seen in Figure 6. It is important note
that our cellular DNS trafﬁc sensor aggregates data from
several different locations in different time zones. There-
fore, patterns may be less pronounced than if all data was
collected from a single location. Looking at the total vol-
ume of requests for each hour, Figure 6 shows that the
volume of trafﬁc starts to increase between hours ﬁve and
six and begins to gradually decrease between hours seven-
teen and eighteen. These hours approximately correspond
to people waking up in the morning and traditional dinner
hours in the evening. With the exception of DDNS trafﬁc
and a spike at hour ﬁve for MBL requests, the other classes
of domains appear to follow the total hourly volume pattern.
5 Results
We now present the results of our experimental evalua-
tion. We begin by analyzing the trafﬁc observed in the cellu-
lar carrier, ﬁrst characterizing the data from the cellular car-
rier in isolation, and then comparing the request patterns to
those observed historically in our non-cellular ISP dataset.
We then examine the extent to which the hosts observed in
mobile resolution requests are directly or indirectly tainted
by reputation information collected in non-cellular ISPs.
We continue in Section 5.2 and further focus on evidence
of mobile-speciﬁc malware. We continue our analysis of
directly tainted hosts in mobile resolutions by determining
from which mobile platforms those queries originate. Then,
we examine all of the cellular network queries for mobile-
malware speciﬁc domains to determine the extent of the
presence of mobile malware in the cellular network.
We conclude our results with long term analysis of two
known mobile threats in Section 5.3. In particular, we study
those two threats from their rise until they become almost
completely inactive. Furthermore, we provide the global
infection perspective of those two mobile threats. Finally,
we examine their hosting infrastructure and how it changes
over time.
5.1 Analysis of the Reputation Datasets
We analyze the DNS trafﬁc generated from approxi-
mately 380 million mobile IDs over the course of our ob-
servation period (Table 2). Note that while we can iden-
tify devices consistently within an epoch (i.e., a single day),
we can not link devices across days, meaning that this to-
tal does not represent the number of unique devices ser-
viced by the carrier. We are speciﬁcally interested in unique
Internet-based hosts requested by mobile devices. The ﬁl-
tering process results in the set HOST Sall consisting of
2,902,071 unique hosts having the following characteristics:
(i) at least one resolution request for each host was observed
by the cellular carrier, (ii) the observed DNS requests came
strictly from devices classiﬁed as mobile, (iii) the hosts are
not associated with any known benign infrastructure, and
(iv) the host is a routable IP address. We obtain passive
DNS information on each of these hosts from our historical
non-cellular ISP dataset (via the function fpdns() deﬁned in
Section 3.3).
5.1.1 Observations from the Cellular Carrier Trafﬁc
We use the hosts in HOST Sall to perform an in depth ex-
amination of their DNS properties in our pDNS data. We do
this for both the cellular ISP trafﬁc (Figure 4(a)) and, using
a projection into our passive DNS data collection, for the
non-cellular ISP trafﬁc (Figure 4(b)).
The hosts in HOST Sall reﬂect a portion of the host-
ing infrastructure that support unknown or malicious types
of DNS resolutions in the mobile carrier. We project this
set into the non-cellular data collection and obtain non-
cellular passive DNS data for the hosts in HOST Sall. Only
36,338 (or 1.3%) of hosts in HOST Sall are outside the
non-cellular passive DNS evidence we have.
Looking a bit closer, Figure 4(a) shows the distribution
of unique hosts in the set HOST Sall. We see that more
than 18% of the hosts requested by mobile devices are asso-
ciated with only a single domain. Furthermore, Figure 4(b)
shows that 98.7% of hosts in the set HOST Sall have at
least one historically associated domain name (according to
the passive DNS data collection from the non-cellular ISP).
This simply means a sufﬁciently large non-cellular pDNS
data collection can be used to amplify the DNS information
for hosts observed in DNS resolutions from non-cellular
networks.
If we assign Notos [7] reputation scores to the RRs that
have IPs in the HOST Sall set, and use reputation thresh-
old of 0.8 (or above 80% probability of the RR being mali-
cious), we obtain 51,503 domain names (3,636 distinct IPs)
as likely suspicious. Only 18 domain names (13 unique
hosts) of them have been listed in mobile black lists until the
day of the submission. While 0.8 is a conservative thresh-
old, these results could be used as an indicator that the mali-
cious hosting infrastructure observed in cellular networks is
already present in reputation and passive DNS observations
from non-cellular networks.
These ﬁndings are already valuable. Given the signiﬁ-
cant overlap between the domains requested by devices in
cellular and non-cellular providers, and the historical infor-
mation regarding the reputation of the hosts in HOST Sall
(as discussed in this Section and Section 4.3), we can con-
clude that the DNS infrastructure (malicious or not) is being
reused in cellular networks. Moreover, the scores assigned
to hosts by DNS reputation systems can potentially serve as
ﬁltering functions for applications when they are submitted
to mobile markets.
5.1.2 Observations from Mobile Markets and Mal-
ware Datasets
We now characterize application markets and datasets
of known mobile malicious applications.
Speciﬁcally,
we examine all of the applications in Proandroid, So-
fandroid, Anzhi, Ndoo and the top 500 free applica-
Market/Dataset Name Market Country
Google Play*
SoftAndroid
ProAndroid
Anzhi
Ndoo
Contagio
Zhou et al.
M1
US
RU
CN
CN
CN
—
—
—
Date of Snapshots
9/20/11 and 1/20/12
2/7/12
2/2/12, 3/11/12
1/31/12
10/25/12, 2/3/12, 3/6/12
3/27/12
2/2012
3/26/2012
#Unique Apps
#Unique domains
#Unique IPs
26,332
3,626
2,407
28,760
7,914
338
596
1,485
27,581
3,028
2,712
11,719
5,939
246
281
839
47,144
8,868
8,458
24,032
14,174
2,324
2,413
5,540
*Top 500 free applications per category only
Table 3: M&A Datasets
Figure 7: Qname distribution per passive DNS (from
non-Cellular networks) evidence gathered from the
m&a dataset. In spite of their geographic diversity, the
requested qnames in all of these subsets follow a similar
distribution.
tions from each category in Google Play. We also an-
alyze three datasets containing known mobile malware,
including all of the malware samples from the Conta-
gio blog, 596 apps from the malware dataset described
in Zhou et al. [47] and a third dataset which we re-
fer to as M 1 that was provided conﬁdentially by an in-
dependent security company. M 1 contains both highly
suspicious and conﬁrmed malicious applications. We re-
fer to this collection of datasets as the malware and ap-
plications (m&a) datasets ({Android500, P roandroid,
Sof tandroid, Anzhi, Zhou, Contagio, M 1}). We stat-
ically extract domain names from application code in the
m&a dataset to create a set of domain names we call
DNm&a. Using the fpdns() function, we record the unique
hosts historically associated with each entry in DNm&a
from our non-cellular pDNS dataset. Table 3 shows the
breakdown of each of these datasets.
Figure 8: Volume of malicious MD5 evidence associated
with unique qnames seen in the m&a dataset.
Figures 7(a) and (b) show the distribution of qnames for
each of the subsets of the m&a dataset. We observe that
at least 90% of the hosts in HOST Sm&a are present in
our non-cellular pDNS dataset, and in some cases (see Fig-
ure 7(b)) all of them are present. Despite the geographical
diversity of the markets we examine, in Figures 7(a) and
(b) we see that all m&a datasets have very similar distri-
butions of qnames per host in HOST Sm&a. Furthermore,
more than 50% of these hosts have at least seven domain
names historically associated with the (non-cellular) pDNS
dataset.
Figure 8 shows the direct relationship to hosts histori-
cally associated with malware for each of the subsets of the
M&A datasets. We observe that the 38% of the hosts re-
trieved from the HOST SZhoudataset, which corresponds
to applications from Zhou et al. [47] dataset, have been his-
torically associated with more than one malware samples
(or MD5). Additionally, approximately 23% of hosts in
HOST Ssof tandroid dataset, can also be linked with more
that one malware samples.
% Total
% Population
% Total
requests by
mobile
device
31.6%
68.4%
requesting
tainted hosts
tainted host
requests
8.8%
8.2%
33.2%
66.8%
Device
Platform
iOS
All other
mobile
(Android,
etc.)
Table 4: Tainted Hosts and Platforms
5.2.1 Tainted hosts requested by mobile platforms
Table 4 presents a breakdown of which platforms corre-
spond to what proportion of total mobile device population,
what proportion of the device population requested tainted
hosts, and which platforms are responsible for tainted host
requests. This data is presented for iOS devices and other
mobile devices such as Android and other indistinguishable
platforms (e.g., potentially Symbian, Windows Mobile, un-
veriﬁable iOS devices). We separate iOS devices from the
rest because they are easy to reliably identify by searching
for push notiﬁcation domains.
The ﬁrst column in Table 4 shows the contribution of
each platform to the total population of mobile devices. The
majority of devices were unidentiﬁable, but roughly one
third of the devices could be identiﬁed as iOS. The second
column shows the percentage of devices for each platform
that requested domains that point to tainted hosts. We ob-
served roughly 8% of iOS and 8% of other mobile devices
issued at least one request that pointed to a tainted host.
Finally, the third column shows how platforms contribute
to the overall number of tainted host requests. It is interest-
ing that each class of devices contributed proportionally to
the number of total tainted host requests. This data shows
that, from the network perspective, iOS devices reach out to
similar numbers of tainted hosts as other devices.
Figure 5 provides an overview of different threat classes
that are present in our PBL evidence set. Each of the dif-
ferent classes shown in this table were seen in our cellular