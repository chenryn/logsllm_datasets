title:Rewriting History: Changing the Archived Web from the Present
author:Ada Lerner and
Tadayoshi Kohno and
Franziska Roesner
Rewriting History: Changing the Archived Web from the Present
Ada Lerner∗
Wellesley College
PI:EMAIL
Tadayoshi Kohno
Paul G. Allen School
Franziska Roesner
Paul G. Allen School
of Computer Science & Engineering
of Computer Science & Engineering
University of Washington
PI:EMAIL
University of Washington
PI:EMAIL
ABSTRACT
The Internet Archive’s Wayback Machine is the largest modern web
archive, preserving web content since 1996. We discover and ana-
lyze several vulnerabilities in how the Wayback Machine archives
data, and then leverage these vulnerabilities to create what are to
our knowledge the first attacks against a user’s view of the archived
web. Our vulnerabilities are enabled by the unique interaction be-
tween the Wayback Machine’s archives, other websites, and a user’s
browser, and attackers do not need to compromise the archives in
order to compromise users’ views of a stored page. We demonstrate
the effectiveness of our attacks through proof-of-concept imple-
mentations. Then, we conduct a measurement study to quantify
the prevalence of vulnerabilities in the archive. Finally, we explore
defenses which might be deployed by archives, website publishers,
and the users of archives, and present the prototype of a defense
for clients of the Wayback Machine, ArchiveWatcher.
CCS CONCEPTS
• Information systems → Digital libraries and archives; • Se-
curity and privacy → Web application security;
KEYWORDS
web archives; web security
1 INTRODUCTION
The Wayback Machine is a publicly browsable web archive which
has cataloged and preserved a collection of over 286 billion web
pages over the period from 1996 to 2017 [26]. Like other web
archives, which use similar techniques and technologies, the Way-
back Machine allows clients using ordinary web browsers to access
snapshots of past websites through a web interface1, enabling or-
dinary citizens as well as technical experts to see how the web
has changed and what it once contained. These archival snapshots
of websites are rendered in HTML, Javascript, and CSS just like
∗This work was performed while Dr. Lerner was a PhD Candidate at the Paul G. Allen
School of Computer Science at the University of Washington.
1https://web.archive.org/
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
CCS ’17, October 30-November 3, 2017, Dallas, TX, USA
© 2017 Copyright held by the owner/author(s). Publication rights licensed to Associa-
tion for Computing Machinery.
ACM ISBN 978-1-4503-4946-8/17/10...$15.00
https://doi.org/10.1145/3133956.3134042
the modern web, preserving not only their content but also their
client-side dynamic behaviors, making them a rich cultural and
technical preserve.
The Wayback Machine is frequently used in a variety of contexts
critical to our free society, including scholarly articles, journal-
ism, and legal proceedings. Scientists may cite archived snapshots
in their scientific papers to increase the durability of their refer-
ences [19, 41], while journalists have used archives to understand
how websites such as official government pages have changed [38],
and lawyers often use archival snapshots as evidence in legal cases,
including civil and criminal cases, administrative proceedings, and
patent litigation (e.g., [1, 2, 4, 40]). While other researchers have
studied inaccuracies in the Wayback Machine which arise acciden-
tally, we observe that these socially and financially important uses
suggest incentives to intentionally manipulate archives after the
fact. For example, governments might want to suppress or change
historical information, companies might want to manipulate ev-
idence of prior art in a patent case, organizations might want to
hide evidence of past wrongdoing, and news sources might want
to manipulate source material for their reporting.
To our knowledge, this paper is the first to investigate the tech-
nical vulnerabilities and attacks that might be used to perform such
intentional manipulation. That is: how might attackers attempt to
rewrite history? How might they intentionally cause clients who
view the archive to see archived websites with content, appearance,
and behavior that are different from the actual website at archival
time? We analyze the way that the Wayback Machine functions,
finding that in fact, there are several types of vulnerabilities which
would allow an attacker today to take full control of clients’ views
of snapshots. For example, snapshots sometimes cause clients to
accidentally mix content from the live web into an archived page, al-
lowing servers on the live web to inject content or code into clients’
views of the archive. Our attacks are global — they affect the ap-
pearance and behavior of snapshots for all visitors, and they do not
involve the direct compromise of archival or publisher servers or
databases.
We demonstrate the viability of our attacks with proofs-of-concept.
For example, we demonstrate the ability to inject arbitrary Javascript
code into client views of archival snapshots, allowing us to modify
text, images, styling, and behavior, subtly or completely rewriting
the web of the past. Figure 1 shows such an attack, in which we
took complete control of a snapshot of reuters.com from 2011.2
We then quantify the prevalence of the types of vulnerabilities we
discovered, seeking them in the wild through a measurement study
of archived websites. We find that vulnerabilities to our attacks are
very common: over snapshots of the Top 500 most popular websites
2For ethical reasons, we disabled our attacks after showing that they worked.
Session H3:  Web SecurityCCS’17, October 30-November 3, 2017, Dallas, TX, USA1741(a) Above, the snapshot URL for our demonstration attack, a capture of
the Reuters homepage from the timestamp 20110901233330 (1 Septem-
ber 2011, at 23:33:00).
(b) Above, the original news story from the page, as preserved in the
snapshot URL above: a political opinion piece, illustrated with a picture
of President Barack Obama. Accessed 15 May 2017.
control to some attacker over the way clients view the snapshot.
We note that we are unaware of any attackers who have used
these vulnerabilities for malicious purposes in practice — rather,
our measurements show that a large fraction of sites are or were
vulnerable to such attacks, suggesting that the consumer of web
archives should exercise caution.
While an instance of our attacks may be evident upon detailed
technical inspection of the way a client renders a snapshot, they are
likely to be completely invisible to less technical users of the archive.
Even when investigated by technical experts, attackers may have
plausible deniability, since modern content can and does become
intermingled with archival content in many benign cases [16, 30].
We explore a variety of defenses that could help clients see correct
views of snapshots, and we design and build ArchiveWatcher, an
end-user defense which demonstrates a subset of our defensive
techniques. Our defense focuses on highly motivated users of the
archive, aiming to demonstrate techniques which may aid indi-
viduals, such as expert witnesses and fact checkers in legal and
journalism contexts, in determining when an archived view of a
website can be reliably cited.
This paper makes the following contributions:
• We analyze the Wayback Machine in order to identify vul-
nerabilities which enable adversaries to manipulate clients’
view of archival snapshots (Section 4).
• We develop attacks which exploit these vulnerabilities, ex-
ploring how an adversary can change the appearance and
behavior of snapshots seen by all visitors to the archive, even
years after the snapshot was captured. We execute proofs-of-
concept of our attacks against real snapshots in the Wayback
Machine (Section 5).
• We measure the prevalence in the wild of vulnerabilities
which enable our attacks, finding that they are quite common,
including a number of vulnerabilities which affect snapshots
cited in legal cases and decisions (Section 6).
• We explore the space of possible defenses which might be
deployed by archives, website publishers, and end-users, and
we build an end-user defense, ArchiveWatcher, that detects
and blocks vulnerabilities to our attacks (Section 7).
(c) Above, we used an Archive-Escape Abuse attack (Section 5.1) to re-
place the above article with incorrect content, so that clients would see
CCS 2017’s cover image and a 6-year-early prediction of CCS 2017’s host
city rather than the correct election opinion piece.
Figure 1: We enabled this attack only or the purposes of ob-
taining this demonstration screenshot, and disabled the at-
tack after determining that it worked.
of the past 20 years, 74% contain some vulnerability which exposes
the snapshot to complete control by an attacker (65% for URLs
sampled from the Top Million). Additionally, we perform these
same measurements over a set of website snapshots which have
been cited in legal contexts such as court decisions, administrative
decisions, and documents filed as trial court and appellate briefs,
finding that 37 domains referenced in the 991 legal documents we
examined are vulnerable to an attack which would provide complete
Before the publication of this paper, we have disclosed these
vulnerabilities to the Wayback Machine, and made our defense,
ArchiveWatcher, publicly available. Links to the code for Archive-
Watcher, along with links to other artifacts from the paper, including
the TrackingExcavator tool used to make our measurements, can
be found at https://rewritinghistory.cs.washington.edu.
2 BACKGROUND AND RELATED WORK
2.1 How Web Archives Work
Overview: Archival Protocol and Systems. We focus our anal-
ysis of web archives on the Internet Archive’s Wayback Machine,
since it is the largest publicly available web archive, with a goal
of archiving as much of the public available web as possible. We
note that while we developed our attacks against the Wayback Ma-
chine and did not test them against other archives, our techniques
form an intellectual basis for understanding how other archives and
systems which similarly rehost content could be manipulated. For
Session H3:  Web SecurityCCS’17, October 30-November 3, 2017, Dallas, TX, USA1742example, other archives follow the same pattern as the Wayback
Machine of hosting mutually distrustful content from the same
domain, and this pattern results directly in vulnerabilities that our
attacks exploit. We discuss the generality of our results in more
detail in Section 4.4. In this section, we explain the design of the
Wayback Machine in order to form a background for how the de-
sign of web archives has led to the vulnerabilities we describe later
in the paper.
The Wayback Machine consists of two major components rele-
vant to this paper. The first is the archive crawler, which visits,
retrieves, loads, and archives pages on the web into the archive’s
database. The second is the archive front-end, which is the sys-
tem of web servers, accessible via https://web.archive.org, which
allow anyone to use their browser to view the web of the past.
In this paper, we refer to the archival preservation of a top
level page as an archival snapshot, or simply snapshot, and the
archival copies of a page’s subresources (e.g., images, scripts, CSS,
etc.) as archival captures. Each snapshot or capture was saved
at a moment in time, called its timestamp, which appears in its
URL. For example, https://web.archive.org/web/20001110101700/
http://www.ccs2000.org:80/ refers to a capture of the homepage
page for the 7th CCS which was saved by the archival crawler at
10:17:00 UTC on 11 November 2000. When a web browser visits
this snapshot, it does the same thing as when it accesses a normal
site on the live web: it recursively downloads, parses, executes, and
renders the HTML, Javascript, and CSS of the page. The only differ-
ence is that the archive plays the role of the first- and third-party
web servers which originally published the the site, serving the
resources that make up the snapshot.
The archive crawler performs regular crawls of a large set of
pages, providing significant coverage of the web. Internet Archive’s
Frequently Asked Questions page does not offer details about how
they find sites to crawl, but states that “crawls tend to find sites
that are well linked from other sites”, and that they collect pages
that are “publicly available” [27]. Additionally, any person can
use a form on the Wayback Machine’s website “Save Page Now”,
which “Capture[s] a web page as it appears now for use as a trusted
citation in the future.” This feature causes the archival crawler
to immediately capture the given page or resource, including its
subresources [28]. We discuss additional technical details about the
Wayback Machine inline as appropriate.
2.2 How are Web Archives Used?
Web archives are used in variety of important social contexts, in-
cluding legal proceedings, news articles, academic publications. We
take particular interest in their use in legal proceedings for two rea-
sons: because the integrity of the legal process is important to our
free society, and because legal proceedings may motivate involved
parties to launch attacks that modify evidence in their favor, such
as by using the attacks described in this paper. Lawyers use web
archives in a wide variety of legal contexts, such as civil lawsuits
(e.g., [4]), criminal cases (e.g., [2]), administrative proceedings (e.g.,
[3]), federal claims court (e.g., [1]), and patent litigation (e.g., [40]),
anc they may use archival evidence for various purposes, such as to
demonstrate “prior art” in patent litigation 3 or to recover evidence
of wrongdoing that has since been deleted from the live web.
Because of these socially important uses, users of archives should
take appropriate steps to ensure that archival data they use is trust-
worthy and not manipulated. We emphasize that we are unaware
of any attacks like the ones in this paper being used in practice.
However, this work demonstrates that not only are attacks are pos-
sible (Sections 4 & 5), but also that the vulnerabilities which enable
them are very common in the wild (Section 6).
2.3 Legal Guidance on Web Archives
Legal scholars have written on the evidence standards that do
and should govern the admissibility of archival material. Eltgroth
encouraged the use of existing evidence standards to allow “reliable
evidence from the Wayback Machine [to be] admitted as any other
Internet-derived proof” [21], while Gazaryan argued in 2013 argued