• 
Peripheral!ASNs!that!are!siblings,!i.e.!they!have!common!
parents!in!the!AS!graph!(share!same!upstream!AS)!
• 
Cluster!peripheral!ASNs!by!country!
• 
Find!interesJng!paQerns:!certain!siblings!in!certain!
countries!are!delivering!similar!suspicious!campaigns!
)
Use)Case)1:)
Suspicious)Sibling)Peripheral)ASNs)
)
Peripheral!ASNs!and!their!upstreams!
• 
January!8th!topology!snapshot,!Ukraine,!Russia!
!
• 
10!sibling!peripheral!ASNs!with!2!upstream!ASNs!
• 
/23!or!/24!serving!TrojWare.Win32.KrypJk.AXJX!
• 
!TrojanYDownloader.Win32.Ldmon.AY08!
Peripheral!ASNs!and!their!upstreams!
• 
February!21st!topology!snapshot,!Ukraine,!Russia!
!
• 
AS31500!detached!itself!from!the!peripheral!ASNs!(stopped!
announcing!their!preﬁxes)!
• 
More!peripherals!started!hosJng!suspicious!payload!domains!
• 
3100+!malware!domains!on!1020+!IPs!hosJng!malware!
Peripheral!ASNs!and!their!upstreams!
• 
Taking!a!sample!of!160!live!IPs!
• 
Server!setup!is!similar:!
50!IPs!with:!
22/tcp!!!open!!ssh!!!!!!!!OpenSSH!6.2_hpn13v11!(FreeBSD!
20130515;!protocol!2.0)!
8080/tcp!open!!hQpYproxy!3Proxy!hQp!proxy!
Service!Info:!OS:!FreeBSD!
108!IPs!with:!
22/tcp!open!!ssh!!!!!OpenSSH!5.3!(protocol!1.99)!
80/tcp!open!!hQp?!
Peripheral!ASNs!and!their!upstreams!
• 
The!payload!url!were!live!on!the!enJre!range!of!IPs!before!
any!domains!were!hosted!on!them!
• 
Seems!the!IP!infrastructure!is!set!up!in!bulk!and!in!advance!
• 
hQp://pastebin.com/X83gkPY4!
)
Peripheral!ASNs!and!their!upstreams!
)
Use)Case)2:)
DetecQng)Sibling)ASNs)through)BGP)outages)
)
BGP!messages!
Two!important!BGP!message!types:!
!
1.  Update!messages!to!announce!a!new!path!for!a!one!or!more!preﬁxes!
!
2.  Withdrawal!messages!to!inform!!BGP!speakers!that!a!certain!preﬁx!can!
no!longer!be!reached.!
By!correlaJng!these!messages!we!can!!detect!outages!globally!and!in!real!
Jme!
Sibling!ASNs!
All!hosJng!same!malware!!
Overlapping!BGP!outages!
! 
57604 
8287 
50896 49236 29004 45020 44093 48949 49720 50818 48361 
57604 x 
20 
17 
12 
22 
16 
11 
24 
20 
13 
5 
8287 
20 x 
41 
15 
17 
17 
15 
18 
18 
15 
5 
50896 
17 
41 x 
17 
16 
17 
18 
19 
16 
18 
7 
49236 
12 
15 
17 x 
8 
15 
13 
8 
12 
17 
3 
29004 
22 
17 
16 
8 x 
12 
22 
28 
18 
9 
6 
45020 
16 
17 
17 
15 
12 x 
12 
12 
12 
15 
4 
44093 
11 
15 
18 
13 
22 
12 x 
16 
10 
13 
6 
48949 
24 
18 
19 
8 
28 
12 
16 x 
20 
9 
8 
49720 
20 
18 
16 
12 
18 
12 
10 
20 x 
10 
4 
50818 
13 
15 
18 
17 
9 
15 
13 
9 
10 x 
4 
48361 
5 
5 
7 
3 
6 
4 
6 
8 
4 
4 x 
Overlapping!BGP!outages!
57604 
29004 
48361 
57604 
22 
5 
29004 
22 
6 
48361 
5 
6 
Overlapping!outages!
ISP!48361 
AS57604!91.233.89.0/24 
AS29004!195.39.252.0/23 
no!outage 
down!for!35!minutes!!!!!!!!!
!2013Y07Y12!18:53!Y!2013Y07Y12!19:28 
down!for!36!minutes!!!!!!!!!
!2013Y07Y12!18:53!Y!2013Y07Y12!19:29 
no!outage 
down!for!497!minutes!!!!!!!!
!!2013Y07Y12!21:33!Y!2013Y07Y13!05:50 
down!for!497!minutes!!!!
!!2013Y07Y12!21:33!Y!2013Y07Y13!05:50 
no!outage 
down!for!479!minutes!!!!!!!!!!
2013Y07Y22!21:57!Y!2013Y07Y23!05:56 
down!for!479!minutes!!!!!!!!!!
2013Y07Y22!21:57!Y!2013Y07Y23!05:56 
no!outage 
down!for!33!minutes!!!!!!!!!
!2013Y07Y23!18:51!Y!2013Y07Y23!19:24 
down!for!33!minutes!!!!!!!!!!
2013Y07Y23!18:51!Y!2013Y07Y23!19:24 
no!outage 
down!for!63!minutes!!!!!!!!!
!2013Y07Y29!04:54!Y!2013Y07Y29!05:57 
down!for!63!minutes!!!!!!!!!
!2013Y07Y29!04:54!Y!2013Y07Y29!05:57 
•  Unique!approach!for!ﬁnding!related!ASNs!
•  Overlapping!outages!could!mean!
•  Most!likely!relying!on!same!infrastructure!
•  Same!Data!center!
•  Same!RouJng!/!Switching!infrastructure!
•  Same!organizaJon!hiding!behind!diﬀerent!ASns!
)
Use)case)3:)
Malicious)subSallocated)ranges)
)
Malicious!subYallocated!ranges!
• 
Case!of!OVH!
!
!
• 
SubYallocated!ranges!reserved!by!same!suspicious!customers,!serving!
Nuclear!Exploit!kit!domains!
• 
Users!are!lead!to!the!Exploit!landing!sites!through!malverJsing!
campaigns,!then!malware!is!dropped!on!vicJms’!machines!(e.g.!zbot)!
• 
Monitoring!paQerns!for!5!months!(Oct!2013YFeb!2014)!
Malicious!subYallocated!ranges!
• 
For!several!months,!OVH!ranges!have!been!abused!
• 
Notable!fact:!IPs!were!exclusively!used!for!hosJng!Nuclear!Exploit!
subdomains,!no!other!sites!hosted!
!
!
!
Malicious!subYallocated!ranges!
Malicious!subYallocated!ranges!
• 
Some!OVH!subYallocated!ranges!used!in!JanYFeb!2014!(now!reYassigned)!
192.95.50.208!Y!192.95.50.215!
198.50.183.68!Y!198.50.183.71!
192.95.42.112!Y!192.95.42.127!
192.95.6.112!Y!192.95.6.127!
192.95.10.208!Y!192.95.10.223!
192.95.7.224!Y!192.95.7.239!
192.95.43.160!Y!192.95.43.175!
192.95.43.176!Y!192.95.43.191!
198.50.131.0!Y!198.50.131.15!
Malicious!subYallocated!ranges!
• 
Feb!7th,!bad!actors!moved!to!a!Ukrainian!hosJng!provider!hQp://www.besthosJng.ua/!
• 
31.41.221.143!2014Y02Y14!2014Y02Y14!0!
• 
31.41.221.142!2014Y02Y12!2014Y02Y14!2!
• 
31.41.221.130!2014Y02Y12!2014Y02Y14!2!
• 
31.41.221.140!2014Y02Y12!2014Y02Y12!0!
• 
31.41.221.139!2014Y02Y12!2014Y02Y12!0!
• 
31.41.221.138!2014Y02Y11!2014Y02Y12!1!
• 
31.41.221.137!2014Y02Y10!2014Y02Y11!1!
• 
31.41.221.136!2014Y02Y10!2014Y02Y11!1!
• 
31.41.221.135!2014Y02Y10!2014Y02Y10!0!
• 
31.41.221.134!2014Y02Y09!2014Y02Y19!10!
• 
31.41.221.132!2014Y02Y08!2014Y02Y09!1!
• 
31.41.221.131!2014Y02Y07!2014Y02Y08!1!