前期准备：制度、人员和技术保障 
前期准备包括三部分，制度、人员和技术，细分后可简称为 5P 模型，见下表：前期准备包括三部分，制度、人员和技术，细分后可简称为 5P 模型，见下表：
制度方面：制定漏洞管理办法和相关操作指引类文件，包括漏洞管
过合同或服务协议等方式界定好职责义务，规范服务流程，并 强化人员审核和管理，防范安全风险；
②…要对提供网络产品的服务商，在合同中约定其对所提供产品的 安全风险、应急响应和安全事件处置的处置责任、响应时间要 求和应急处置要求等。
技术层面：主要包括漏洞管理平台、扫描验证工具、资产管理支撑 系统等。漏洞管理平台要慎重选型，建设投入和对接工作量较大，做得不好非常影响漏洞日常运营。基本目标是使用便捷，有利于漏 洞跟踪和提升修复效率，具体产品选型或自研时，可着重考察以下
理目标、范围、策略、角色职责、漏洞闭环管理流程和要求、考核 	能力：理目标、范围、策略、角色职责、漏洞闭环管理流程和要求、考核 	能力：
和奖惩机制、漏洞处置相关的应急预案。漏洞管理的目标是减少漏 洞发生，提高漏洞发现、防范和处置能力，有效控制漏洞带来的风 险。整体漏洞管理流程由漏洞发现、研判、修复、复测验证和复盘 优化五大环节组成，如下面的简图所示，后文会细讲每个环节的注
①…符合内部闭环管理需求的流程能力，流程引擎最好能灵活便捷 支持自定义，漏洞流程看似研判、修复和复测几步，各单位实 际落地后会比较复杂，比如不同类型不同级别的研判处置逻辑、多人研判和处置、反复确认等。另外，流程能力也可以借助企
意事项。	业其他流程平台实现；
②…多样化的通知能力和强大的报表分析能力，有利于推进漏洞处
置和漏洞整体工作的提升；
③…高效的漏洞自动化验证能力，提升验证效率；
52 … ④…完善的漏洞修复知识库； 53
浅谈甲方单位的漏洞管理浅谈甲方单位的漏洞管理
⑤…及时且丰富的漏洞情报能力和精细化的情报资产关联能力；
⑥…具有自动化的漏洞风险辅助分级能力，并符合单位内部漏洞定 	级标准。
（一）漏洞发现：广撒网，深挖洞 
一是从纳管资产的角度，完善资产信息，扩大扫描测试范围。持续 性做好如下安全资产管理基础工作：
①…提高资产发现的广度和深度，保证完整性和准确性，如容易忽 略的哑终端、公共终端、移动终端、小程序、公众号、APP、云服务、API 等；
②…尽可能深入丰富内部细节，如基于HIDS代理方式完善端口服务、应用软件和框架组件信息，与资产管理系统 CMDB 等同步关联关 系、重要性、属主等信息，并定期与主动扫描或流量检测的结果进 行比对，查缺补漏。
二是从发现渠道的角度，丰富漏洞来源和提高发现漏洞的及时性。漏洞发现方式主要有：（见右上表）
（二）漏洞研判：快速定位，有序处置（二）漏洞研判：快速定位，有序处置 
漏洞研判是漏洞管理工作的核心，发现漏洞时需快速识别并评估危 害程度和紧迫程度，决定修复顺序、修复方式和修复时限等后续动 作。
| 方式  | 频率  | 实践要点 |
|---|---|---|
| … … …	上线检测… |按需… |避免带病上线，建立上线检测规范，明确职责分工，根据重要 级别、暴露面、变更类型等明确检测要求和通过标准。 ●… 上线前测试：如代码审计、配置检查、S/D/IAST 测试、	SCA 组件分析等。 ●…上线后测试：如主动扫描、人工渗透、配置检查、互联网众 	测等。 |
| …	上线后日常… … 定期主动扫描 |周或月度 |定期对全网资产开展主机和应用漏洞的分布式扫描。 ●…扫描前应以自动或手动的方式更新最新 POC 规则库。 ●…为提高效率，仅检测存活资产，资产发现在定期资产稽核中 	完成。 ●…考虑非登陆式和登陆式、无代理和有代理（如 HIDS）相结合。●…扫描时间要跟业务和运维部门商议好。 ●…若采取异构交叉扫描，要注意漏洞去重。 ||   |小时级 |侧重于互联网侧，对面向互联网的资产进行端口和应用服务进 行细粒度扫描。 ●…对 Github、暗网等数据泄露情况进行监测。 |
|  … |每年多次… |侧重于发现逻辑漏洞、业务漏洞和其他深层次漏洞和风险盲点，主要有： ●…安全众测，每年多次。可通过自建 SRC 替代。 ●…渗透测试，每年 1-2 次，测试人员为内部时以白盒测试为主，	为外部时以黑盒和灰盒为主。 ●…红蓝对抗，每年 1-2 次，攻方人员可为内部人员和外购攻击 	服务相结合。 ●…其他专项测试，如每年等保测评、监管单位检查、对小程序 	和 APP 的专项测试。 |
| …	漏洞情报… …	和安全事件… |日常 |侧重于及时性，第一时间获取漏洞情报信息，主要为标准化产 品或组件的漏洞。 ●…来源有国家信息安全漏洞库（CNNVD）、安全服务厂商、	行业监管机构和公安机关等。 |于漏洞情报预警，可通过资产管理系统借助 HIDS 抓取的资产组件
漏洞研判主要有以下注意点：	详情快速匹配。
一是快速定位受影响资产。对于日常自动化扫描，通过调用扫描器
API 或自定义检测插件，快速定位受影响资产和关联业务系统。对
二是完善漏洞信息。主要有：
54 	55
浅谈甲方单位的漏洞管理
1）漏洞的可利用程度，如攻击路径、触发要求、权限要求、用户 	交互程度、利用代码成熟度；
2）被攻击后的影响程度，如对机密性、完整性、可用性方面的影响；3）补丁情况和漏洞来源可信度等，必要时要做漏洞验证；
4）建议的漏洞修复方案和缓解措施；
5）关联的漏洞知识库条目。
三是明确漏洞研判人。根据单位漏洞管理办法，从漏洞类型、受影
平台，参照国标 GB/T…30279-2020 分成四级。
（2）最终定级，根据实际情况调整漏洞风险级别，需要考虑的因（2）最终定级，根据实际情况调整漏洞风险级别，需要考虑的因
响资产情况确认研判小组人员，如主机漏洞涉及操作系统负责人、	素有：
外购系统漏洞涉及应用系统负责人和外部厂商、自研系统漏洞涉及 	①…漏洞防范情况。如若某漏洞从互联网侧利用时，安全设备
开发负责人。	可以 100% 检测并阻止，则可将该漏洞的风险分值降低 75%
或降低 1-2 个风险级别。
四是漏洞风险定级。漏洞风险定级方法应在单位级的漏洞管理办法
中明确定义，结合漏洞本身和资产情况对漏洞风险进行综合评价，	②…外部环境因素。如监管部门通报或重点关注的漏洞，重保
包括两个步骤：	敏感时期出现的漏洞，其他可能造成单位较大影响的漏洞，
（1）首次定级，确定漏洞原始风险等级，有定性和定量两种方式。①…定量方式，目前使用最广泛的漏洞风险计算模型为通用 漏洞评分系统 CVSS，应急响应和安全团队论坛 FIRST 维
这些情况下风险级别可适当提升。这些情况下风险级别可适当提升。
确定风险等级后，根据各自的管理规程，明确该漏洞修复的优先级，
护，最新版为 V3.1。其他的还有微软提出的威胁评级模型 	下表供参考：DREAD、卡耐基梅隆大学提出的特定相关者漏洞分类法 
SSVC、OWASP 风险评级方法等。
②…定性方式：可参考各大 SRC 的漏洞评级标准。
各单位需要根据各自的管理要求、漏洞系统信息化能力等实际情况
制定各自的评分规则。下面的示例以 CVSS 为参考做了适当裁剪，选取系统暴露程度、漏洞技术等级和资产重要性（暂视为相同）等 指标来确定原始风险分值，其中，漏洞技术等级来自国家 CNNVD
五是制定风险控制方案。漏洞风险整体控制方案除了修复方案外，还应包括漏洞防范措施。金融行业对安全运行要求高，彻底修复漏 洞往往需要影响评估、方案制定、测试、上线（部分到全量）和验
56 	57
浅谈甲方单位的漏洞管理56 	57
浅谈甲方单位的漏洞管理
证等步骤，整体修复周期往往较长，因此在漏洞完全修复前，应评 估并采取有效的风险防范措施，尤其是高危风险以上漏洞。
风险防范措施可包括如下类型，注意实施后要验证措施有效性。
一步协商适合的修复方案或缓解方案 ( 如虚拟补丁等 )。对于超期 未修复漏洞，系统应自动提醒修复人，对高危以上漏洞安全团队要 跟进了解情况。系统定期生成修复进度报表发送相关方，对于超期 未修复的漏洞，必要时抄送上级领导。
1）排查、监控和阻断漏洞利用：针对漏洞利用特征，从网络流量、
主机、应用乃至 SOC 等层面排查漏洞是否已被利用，同时完善防 护规则，如通过前置防护设备（WAF 或 RASP 等）配置应用虚拟 补丁，检测和阻断可能存在的漏洞利用情况；如发现攻击后采取微 隔离或网络旁路阻断等自动阻断方式。2）限制漏洞利用：如临时停用部分功能组件或整个站点、限制访 问时间、限制应用权限、通过网络或主机防火墙限制访问来源。
（三）漏洞修复：高效流转，持续跟进 
研判后的漏洞需通报修复责任人，并持续跟进。实践要点如下：一是以工单形式高效流转。在工单系统中创建工单时自动关联修复
四是建立延期修复机制。修复人因特殊情况可申请延期修复漏洞。对不同风险等级的漏洞可设置不同的审批程序和延期期限要求，比 如超危以上漏洞延期，由修复责任部门发起，并需经业务部门负责 人和安全部门负责人共同审批。对于搁置的漏洞，设置到期前提醒，并列入每月报表中定期跟踪。