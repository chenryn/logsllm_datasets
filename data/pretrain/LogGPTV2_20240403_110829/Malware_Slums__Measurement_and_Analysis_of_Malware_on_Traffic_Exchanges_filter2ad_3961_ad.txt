# 恶意软件传播的流量交换测量研究

## 摘要
本文介绍了首次对流量交换作为恶意软件传播媒介的测量研究。我们爬取了大量的手动和自动流量交换网站，并收集了超过一百万个URL样本。通过不同恶意软件分析工具对这些URL进行分析，发现大量URL具有恶意性质。我们还识别了流量交换中主要的恶意软件类别，并深入分析了几种有趣的恶意软件类型，包括iframe注入、欺骗性下载、外部接口调用以及重定向到恶意软件托管网站。

## 1. 引言
流量交换网络已成为攻击者快速针对大量受害者的理想目标。本文旨在揭示这一威胁，并提供相关防御建议。

## 2. 恶意软件类型及示例
### A. 欺骗性可执行文件下载
在dm顶部栏中的`<a>`标签包含了一个嵌入式JavaScript代码（`window.location`），指向一个名为`flashplayer.exe`的下载链接。dm顶部栏块`<div>`元素创建了一个虚假的下载按钮。

```html
<a href="javascript:window.location='http://example.com/flashplayer.exe'">下载</a>
```

### B. 可疑重定向
另一个观察到的恶意活动是URL重定向。恶意软件检测引擎将其报告为Trojan:JS/Redirector [15] 和 Trojan.Script.Generic。以下是一个看似无害但实则恶意的JavaScript代码片段示例。

```javascript
<script src="http://malicious-domain.com/script.js"></script>
```

该脚本会将任何请求重定向到不同的URL，具体目标由服务器端决定，因此难以完全揭露其逻辑。

### C. 外部接口调用
一些恶意软件利用外部接口调用来利用客户端功能，如Flash和JavaScript。例如，被标记为BehavesLike.JS.ExploitBlacole.nv 的恶意软件通过引用多个隐藏的iframe元素来实现其目的。我们成功地反混淆了部分代码并找到了对以下Flash对象的引用：

```actionscript
package {
    import flash.events.*;
    import flash.display.*;
    import flash.external.*;
    import flash.system.*;

    public class AdFlash46 extends MovieClip {
        public function AdFlash46() {
            super();
            Security.allowDomain("*");
            stage.scaleMode = StageScaleMode.EXACT_FIT;
            stage.addEventListener(MouseEvent.MOUSE_UP, function(_arg1:MouseEvent):void {
                ExternalInterface.call("AdFlash.onClick");
                stage.displayState = StageDisplayState.FULL_SCREEN;
                ExternalInterface.call("window.NqPnfu");
                stage.displayState = StageDisplayState.NORMAL;
            });
        }
    }
}
```

### D. 误报
在我们的研究中，也遇到了一些良性网页被错误地标记为恶意的情况。例如，Google账户认证脚本通常被放置在一个宽度和高度都设为1的隐藏iframe中。尽管这看起来可疑，但进一步分析表明它实际上是良性的Google认证行为。

```html
<iframe src="https://accounts.google.com/o/oauth2/auth" width="1" height="1" style="top:-100px;"></iframe>
```

另一个误报是由Google Analytics引用引起的。扫描引擎将其错误地识别为TrojanClicker:JS/Faceliker.D。以下是相关的代码片段：

```javascript
(function(i,s,o,g,r,a,m) { i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments); }, i[r].l = 1 * new Date(); a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-54970982-1', 'auto'); ga('send', 'pageview');
```

## 3. 结论
我们展示了流量交换作为恶意软件传播媒介的首次大规模测量研究。通过分析发现，流量交换网络已成为大规模恶意软件传播的理想渠道。除了流量交换平台外，广告网络和用户也是生态系统中的关键利益相关者。广告网络应警惕潜在的欺诈行为，而用户需要了解参与此类活动的风险。我们建议通过浏览器插件或扩展程序向用户提供访问流量交换网站前的警告信息。

## 致谢
感谢VirusTotal提供的API支持，以及美国国家科学基金会的部分资助。

## 参考文献
[此处列出参考文献]

---

以上是对原文的优化整理，使其更加清晰、连贯和专业。希望对你有所帮助！