Backdooring the 
Front Door
About me
●
Software Engineer by trade
●
Hacker by passion
●
Lock picker for fun
●
The best puzzles are not meant to be solved
●
All opinions are my own, and may not reflect those of my past, present, or 
future employers
●
Twitter: @jmaxxz
Internet of things
August smart lock
August's marketing 
team
"Unlike physical keys which can 
be duplicated and distributed 
without your knowledge"
Source: august.com (August 17th, 2015)
"Safer than … codes that can be 
copied."
Source: august.com (September 14th, 2015)
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
●
Track who enters and exits your home
Mapping out the
API
WiFi | HTTPS
BLE
MitM proxy
Certificate pinning
…crap...
Solution:
iOS Kill Switch 2
(https://github.com/nabla-c0d3/ssl-kill-switch2)
Disabling SSL/TLS 
system wide at Defcon?
Better solution
No Jailbreak
Certificate Pinned!!!
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
●
Track who enters and exits your home
After mapping out api
Postman collection created (see github repo)
Not anonymized
Creepy
Let's fix this
MiTM can modify traffic
Fix
Don't forward log data to August, and tell app logs were received
What else can we do?
Guest to admin?
Guests can not use Auto-Unlock
Guests can not control lock settings
Replace "user"
with "superuser"
Guests can change lock settings!
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
●
Track who enters and exits your home
Mapping out the
BLE API
WiFi | HTTPS
BLE
Enumerate BLE services
Intercepting BLE
Solution: Ubertooth
Better solution
Tap
Replace
Plaintext BLE traffic in log 
files!
No Jailbreak
How August's 
authentication works
Requesting firmware as a 
guest
This is weird
"Safer than … codes that can 
be copied."
"Unlike physical keys which can 
be duplicated and distributed 
without your knowledge, an 
August lock..."
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
Key material in logs
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
●
Track who enters and exits your home
Don't give guest access to 
someone you would not 
give a key to.
Code on 
github
github.com/jmaxxz/keymaker
Demo
Mistakes made
●
Mobile app logs include sensitive information
●
Lock does not differentiate between guest and owner
●
Firmware not signed
●
No apparent way for average users to discover backdoor keys
●
Guest users can download key material
●
System relies on guests self reporting unlock/lock events
●
Vendor claims two factor auth when really two step auth
●
No rate limiting of password reset attempts (fixed)
●
Mobile app includes bypass for certificate pinning
●
Secure random not used for nonce or session key generation (fixed)
●
Key material not stored on iOS keychain
What was done correctly
●
August has been very responsive
●
Mobile apps attempt to use certificate pinning
●
Protocol makes use of nonces CBC
●
Not reliant solely on BLE's just works security model
Hackers needed
Consumers are not able to evaluate security claims made by companies
●
We need more researchers investigating security claims made by companies 
on behalf of consumers.
●
What can be asserted without proof can be dismissed without proof.