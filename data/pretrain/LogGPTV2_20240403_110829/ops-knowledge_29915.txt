User: 请解答这个和日志有关的问题Autodiscover in new Outlook 2016 setup not working I am setting up a new emailserver, and I want to use autodiscover on it to let Outlook autoconfigure itself. In my current situation I have multiple virtual domains and only one certificate, so I use mail.example.com as STMP, POP and IMAP server.

This is my autodiscover.xml:

&lt;Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/responseschema/2006"&gt;
  &lt;Response xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"&gt;
    &lt;User&gt;
      &lt;DisplayName&gt;email@example.com&lt;/DisplayName&gt;
    &lt;/User&gt;
    &lt;Account&gt;
      &lt;AccountType&gt;email&lt;/AccountType&gt;
      &lt;Action&gt;settings&lt;/Action&gt;
      &lt;Protocol&gt;
        &lt;Type&gt;IMAP&lt;/Type&gt;
        &lt;Server&gt;mail.example.com&lt;/Server&gt;
        &lt;Port&gt;993&lt;/Port&gt;
        &lt;DomainRequired&gt;off&lt;/DomainRequired&gt;
         &lt;LoginName&gt;email@example.com&lt;/LoginName&gt;
        &lt;SPA&gt;off&lt;/SPA&gt;
        &lt;SSL&gt;on&lt;/SSL&gt;
        &lt;AuthRequired&gt;on&lt;/AuthRequired&gt;
      &lt;/Protocol&gt;
      &lt;Protocol&gt;
        &lt;Type&gt;POP3&lt;/Type&gt;
        &lt;Server&gt;mail.example.com&lt;/Server&gt;
        &lt;Port&gt;995&lt;/Port&gt;
        &lt;DomainRequired&gt;off&lt;/DomainRequired&gt;
        &lt;LoginName&gt;email@example.com&lt;/LoginName&gt;
        &lt;SPA&gt;off&lt;/SPA&gt;
        &lt;SSL&gt;on&lt;/SSL&gt;
        &lt;AuthRequired&gt;on&lt;/AuthRequired&gt;
      &lt;/Protocol&gt;
      &lt;Protocol&gt;
        &lt;Type&gt;SMTP&lt;/Type&gt;
        &lt;Server&gt;mail.example.com&lt;/Server&gt;
        &lt;Port&gt;587&lt;/Port&gt;
        &lt;DomainRequired&gt;off&lt;/DomainRequired&gt;
          &lt;LoginName&gt;email@example.com&lt;/LoginName&gt;
        &lt;SPA&gt;off&lt;/SPA&gt;
        &lt;SSL&gt;on&lt;/SSL&gt;
        &lt;AuthRequired&gt;on&lt;/AuthRequired&gt;
      &lt;/Protocol&gt;
    &lt;/Account&gt;
  &lt;/Response&gt;
&lt;/Autodiscover&gt;


My email address passes the AutoDiscovery test at  https://testconnectivity.microsoft.com


I can see Outlook requesting the file in the NGINX log:

[28/Feb/2018:22:04:31 +0100] "POST /autodiscover/autodiscover.xml HTTP/1.1" 200 1658 "-" "Microsoft Office/16.0 (Windows NT 10.0; MAPI 16.0.8431; Pro)"


The configuration works with the old autoconfiguration dialog:



The configuration doesn't work with the new "Welcome to Outlook" dialog (ZeroConfig I believe it's called) 



When I click "Change account type" and then "IMAP", it has the correct settings listed. But when I check my mail.log, I see Outlook hasn't tried any of those settings while auto-configuring. 

I have the problem on both my desktop and laptop, both running Office build 1708. 



Has anybody got the same problems or can anybody help me in the right direction? I've wasted way too much time on this problem now. 

EDIT:

To clarify, I'm not running an Exchange server. I only want to let Outlook know the correct IMAP and POP. 
I've tested the autodiscover with the tool in the contextmenu, and it lists the correct settings, but the "Simpified Account Creation" dialog still fails and doesn't connect to IMAP, POP, or SMTP. It does however connect to https://mail.example.com/autodiscover/autodiscover.xml.

Assistant: Is this "emailserver" an Exchange server?

As far as I know, the Simplified Account Creation feature will help end user to setup Outlook profile with some well-known account, for example: Office 365, Gmail, Outlook.com. However, it not works for particular account. 

I suppose that your email domain is a new created domain in Internet, thus we need to manually configure your account by selecting IMAP account type.