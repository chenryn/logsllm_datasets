每个莱单项旁边的心型符号可以由
的用户）显示的
这个HTML编码得到，这在大多数
莱单
浏览器上都支持。
你现在的位置
383
---
## Page 420
删除cookie来注销用户
喂，还记得我吗？
我真的、真地想要
注锁。
口
我们确实需要允许用户注销。
cookie使得登录Mismatch和在网站中导航更为简洁，不过之所以从
HTTP认证转向cookie，最关键的是为了允许用户注销。我们需要一个
新的Log-Out脚本，它要删除这两个cookie（用户ID和用户名），使用
户无法再访问应用。这样就能避免以后有人在这台计算机上访问用户
的私人情况简表数据。
由于具体注销用户并不涉及任何用户界面组件，所以注销后只需将其
重定向回到主页就可以了。
Sidney还在等
待注销.….
logout.php
Los-Out脚本别除
用户的登录cookie
并将其重定向回到
主页。
1
PDG
384
第7章
---
## Page 421
构建个性化Web应用
注销意味着删除cookie
注销用户需要删除跟踪用户的两个cookie。这要通过调用setcookie（）
函数并传入一个导致cookie此时删除的到期日期来做到。
分
当前时间
小时
setcookie('username'，'sidneyk'
60
8)）：
合在一起，这个表达式设
置了到期日期为当前时间
8.小时以后的那个时刻。
这个代码设置到期日期为将来的8小时以后，这说明cookie会在8小时
后自动删除。不过我们希望立即删除一个cookie，这需要将到期日期
设置为过去的一个时间。具体过去多长时间并不重要，只需选择一个任
要删除一个
意的时间量，如1小时，并用当前时间减去这个时间量。
cookie，只需将
到期日期设置
setcookie（'username'，'sidneyk'，time（)-3600);
个
为过去的一个
60秒*60分二3600秒.这就是
过去1小时的时间。
时间。
Mismatch的Log-Out脚本还缺少一些代码。请写出缺少的代码，确保在Log-Out页面重定
ExeRciSe
向到主页之前会删除登录cookie。
你现在的位置
385
---
## Page 422
完整的logout.php脚本
Mismatch的Log-Out脚本还缺少一些代码。请写出缺少的代码，确保在Log-Out页面重定
eRciSe
向到主页之前会删除登录cookie。
SOLutiON
.[.ueuxsn,NoIssas.se u pabbo axe nox.）ouo
不同于cookie，会话变量不需要任何特殊的函数来完成设置，只需为
要访问金话变量，只需使用
S_SESSION超级全局变量赋一个值，要确保使用会话变量名作为数组
S_SESSION超级全局变量和
索引。
会活变量名。
那么删除会话变量呢？通过session_destroy（）销毁一个会话时，
实际上并不会销毁会话变量，所以如果希望用户关闭浏览器（注销！）
会话变量在会话
之前清空会话变量，必须手动地删除你的会话变量。销毁一个会话的
销毁时不会自动
所有会话变量有一种快速有效的方法，即把S_SESSION超级全局变量
设置为一个空数组。
删除。
E
这个代码金清除当前金话中的所
$_SESSION = array();
有会话查量。
但是还没有完全结束。会话在后台实际上会使用cookie。如果浏览器
支持cookie，会话可能会设置一个cookie临时存储会话ID。所以要通
过PHP代码完全关闭一个会话，还必须删除可能在浏览器上自动创建
如果会话使用cookie来帮助记住
来存储会话ID的所有cookie。与任何其他cookie类似，可以将其到期
金话0，这个10会存储在以金
时间设置为过去的一个时间来销毁这个cookie。只需知道cookie的名，
话命名的一个cookie中。
这可以使用session_name（）函数得到。
K
if （isset（S_cookIE[session_name()])）(
71setcookie(session_name(),
，time（）-3600）;
首先壹看金话cookie
逐过将其到期时间设置为过去的
是否确实存在。
一个时间来销毁金话cookie。
你现在的位置
391
---
## Page 428
mismatch如何使用会话
从这里开始！
利用会话改造Mismatch
重新构造Mismatch应用，使用会话来存储登录数据，这听上去很难但
SA Llp
实际上并没有那么难。实际上，应用的流程基本上是一样的，只是必
须注意开始会话、撤销会话以及会话之后完成清理时需要
额外做一些维护工作。
atch - Log ln
这里创建两个会
话变量来存储誉
录的用户30和用
户名。
session_start();
刀
session_stant(）函数开始一个
金活，一切由此开始。
如果启用cookie，服务器全创建
一个cookie来存储金话30.
金逐过每个页面的URL传递0。
否则
session_destroy();
7
session_destroy函数
如果使用了cookie来存储会
结束会话，防止它在
话0，则将其销设。
另一个页面中使用。
记住警录数据现在使用的是
金话而不是cookie。
通过清空S_SESSJON
.View Profl
数组来搬销金活
变量。
PDI
392
第7章
---
## Page 429
构建个性化Web应用