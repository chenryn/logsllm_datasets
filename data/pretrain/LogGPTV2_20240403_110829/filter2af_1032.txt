# 【漏洞预警】Ticketbleed：F5 BIG-IP设备TLS/SSL堆栈漏洞（CVE-2016-9244）

### 译文声明
本文为翻译文章，原文来源：安全客。具体内容及含义以原文为准。
[原文地址](<请提供原文链接>)

---

**漏洞概述**

Ticketbleed是一个存在于F5 BIG-IP设备的TLS/SSL堆栈中的软件漏洞（CVE-2016-9244），允许远程攻击者一次提取多达31字节的未初始化内存。这部分内存可能包含来自其他连接的密钥或敏感数据。该漏洞在性质和影响上与Heartbleed相似，但有以下几点不同：
- 每次仅暴露31字节而非64k的数据；
- 需要多次轮询才能执行完整的攻击；
- 影响的是专有的F5 TLS堆栈，而不是OpenSSL。

**测试方法**

您可以使用以下网址来检测您的服务器是否受到Ticketbleed的影响（例如: example.com:443）:
[测试链接](<请提供测试链接>)
或者，您也可以自行编写脚本进行测试。

**技术细节**

该漏洞的核心在于Session Tickets的处理机制，这是一种用于加速重复连接的技术。当客户端同时提供了Session ID和Session Ticket时，服务器应回显Session ID以表明接受了Session Ticket。根据规范，Session ID长度应在1至31字节之间变化。然而，在实际操作中，即使客户端提供的Session ID很短，F5堆栈仍会回显固定长度为32字节的内存内容。这意味着如果攻击者提供了一个1字节长的Session ID，则将接收到额外31字节未经初始化的内存数据作为响应。

**修复措施**

受此漏洞影响的具体版本列表可在[F5官方网站](https://support.f5.com/csp/article/K05121675)查询到。虽然并非所有受影响版本都能立即通过升级得到修复，但禁用Session Tickets功能可以完全缓解这一风险，尽管这样做可能会导致重新建立连接时性能略有下降。以下是F5推荐的操作步骤：

1. 登录到配置实用程序。
2. 导航至“本地流量 > 配置文件 > SSL > 客户端”菜单。
3. 将当前配置选项从“基本”切换到“高级”模式。
4. 取消勾选“Session Ticket”选项以禁用该项功能。
5. 点击“更新”按钮保存更改。

**互联网扫描结果概览**

我们使用了改进版zgrab工具对互联网进行了广泛扫描，并根据结果将目标分为四类：
- **Vulnerable**: 表示存在上述描述的安全漏洞。
- **Accepted**: 主机正常接受并处理Session Tickets请求。
- **Rejected**: 虽然主机生成了Session Ticket，但在客户端尝试使用它时会被拒绝。
- 其他情况则意味着主机根本不支持Session Tickets特性。

**发现历程及时间线**

该问题最初由Filippo Valsorda及其CloudFlare团队成员在为客户解决问题过程中发现。以下是关键事件的时间节点：
- 10月20日 - 发现问题
- 10月20日 - 第一次尝试联系F5公司
- 10月25日 - 与F5安全工程师取得联系
- 10月26日 - 正式提交漏洞报告
- 10月28日 - F5确认收到报告
- 11月13日 - F5确认存在问题但尚未评估其安全性影响
- 11月14日 - 对Alexa排名前1000网站进行扫描，发现两个易受攻击的目标；设定90天披露期限
- 11月16日 - 向F5提供涉及的具体版本及配置信息
- 11月16日 - F5成功复现并确认了安全问题的存在
- 1月17日 - F5分享相关CVE编号
- 1月26日 - 因故推迟至2月8日公开
- 2月7日 - 开始大规模互联网扫描
- 2月8日 - 达成最终披露日期
- 2月9日 01:25 UTC - 协调一致对外公布

希望以上信息能帮助您更好地理解和应对Ticketbleed漏洞带来的潜在威胁。