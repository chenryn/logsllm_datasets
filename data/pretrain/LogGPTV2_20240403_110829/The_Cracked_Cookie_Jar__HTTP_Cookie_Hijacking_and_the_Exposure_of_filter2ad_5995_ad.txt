### 4. 其他方式下的HTTP Cookie暴露

在本节中，我们将探讨用户HTTP Cookie可能通过其他途径被暴露的方式。

#### A. 浏览器组件

根据对超过30,000个Chrome扩展程序的清单文件分析 [47]，发现更多扩展程序请求通过HTTP而不是HTTPS连接到Google。对于通配符（http://*/*）权限请求也是如此。这表明相当数量的扩展程序可能通过未加密的连接访问支持加密连接的网站，从而削弱了安全性。因此，我们探索浏览器组件是否使用户面临Cookie劫持攻击的风险。

我们分析了一些由主要供应商发布的、最流行的Chrome和Firefox浏览器组件。我们的目标不是进行详尽的评估，而是了解这些组件的实现实践，并确定它们是否也存在加密使用不足的问题。尽管我们测试的组件数量有限，但我们认为任何发现的暴露问题都反映了普遍的做法，因为主要供应商的官方扩展程序通常会遵循一定的质量标准。由于Google已经停止了Firefox扩展程序的开发，我们无法对大多数组件进行跨浏览器比较。

表IV列出了我们评估的Web组件，包括其下载次数（如果可用），以及它们是否泄露了我们用于劫持攻击所需的Cookie。我们的实验得出了几个令人惊讶的结果。测试的三个由Google发布的Chrome应用程序均暴露了HTTP Cookie，而其扩展程序则结果不一，9个中有4个泄露了Cookie。其中一个泄露Cookie的是Google Dictionary，其下载量超过270万次，这意味着大量Chrome用户面临重大风险。我们测试的所有Firefox扩展程序以及两个默认搜索栏实际上都在未加密连接上暴露了所需的HTTP Cookie。有趣的是，Google的“以图搜图”扩展程序在Chrome上是安全的，但在Firefox上并不安全。由于没有官方的Bing Firefox扩展程序，我们测试了最受欢迎的一个，并审计了一个拥有超过794,000用户的非官方Google翻译扩展程序，两者都被发现存在漏洞。总体而言，这些发现突显了数百万用户因浏览器组件而面临的隐私威胁。

#### B. 移动设备

移动设备已经变得无处不在，占据了用户在线时间的很大一部分。由于移动数据计划的流量限制，用户经常连接到公共WiFi接入点。据Cisco [48]估计，大约45%的移动流量被“卸载”到WiFi连接。虽然这不仅限于公共WiFi网络，但它反映了用户行为，最近的一项调查显示，72%的参与者连接到公共WiFi [49]。为了探讨针对移动设备用户的HTTP Cookie劫持攻击的可行性，我们审核了我们发现暴露私人信息和账户功能的最流行服务的官方iOS和Android应用程序。

我们的结果概述如表V所示。值得注意的是，Bing区分了移动Cookie，因此劫持的移动Cookie只暴露了在移动设备上进行的搜索和点击历史；第三节B部分提到的其余个人信息仍然可以获取。Spotlight是iOS系统的全局搜索功能，它通过HTTPS连接到Apple服务器。然而，搜索结果包含一个“在Bing中显示更多”的按钮，如果点击该按钮，浏览器将显示搜索结果并泄露用户的HTTP Bing Cookie。对于语音助手Siri，Bing结果通过HTTPS在浏览器中打开，防止了Cookie劫持。再一次，Yahoo的安全实践较差，四个iOS应用中有三个泄露了用户的Cookie。不出所料，两个版本的Gmail都保护了Cookie，而iOS版Amazon应用在5.3.2版本之前泄露了Cookie。此外，两个Amazon iOS应用中的Cookie还揭示了用户的设备和移动运营商信息（详细信息见附录A）。对于两个平台，Ebay应用在某些条件下会暴露Cookie。首先，Ebay卖家可以自定义他们的商品页面，并经常添加他们销售的其他商品的链接；如果卖家在这些链接中添加了HTTP Ebay链接，则用户点击这些链接时Cookie将被暴露。经实验证明，这种HTTP链接非常常见。另一种情况是用户点击“客户支持”菜单。

#### C. 主动攻击

远程劫持。我们深入分析了每个服务的Cookie，并确定攻击者可以通过XSS攻击等手段远程获取哪些信息。虽然HttpOnly属性可以防止攻击者通过浏览器脚本远程获取Cookie，但我们的发现表明采用率有限，说明近年来这种情况并未改善 [19]。

从表VI可以看出，具有多个Cookie的网站从未为所有Cookie设置该属性。大多数网站仅为部分Cookie设置了该属性，但允许其他Cookie被脚本访问。此外，Amazon和Target的所有Cookie都没有设置HttpOnly属性。令人惊讶的是，66.6%易受我们Cookie劫持攻击的网站也使用户面临远程Cookie劫持的风险。对于Yahoo，虽然我们无法访问所有之前描述的信息和账户功能，但仍有几种情况是可能的（例如，搜索历史、用户名等）。尽管Huffington Post的huffpost_s Cookie设置了该标志，但其他Cookie仍然暴露了用户的用户名和电子邮件地址。

### 5. 对Tor用户去匿名化的风险

在本节中，我们将探讨更加注重隐私的Tor用户是否面临类似的去匿名化风险。