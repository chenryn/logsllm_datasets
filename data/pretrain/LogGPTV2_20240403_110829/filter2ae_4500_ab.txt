#### 3.1 发现受影响设备
通过分析近50TB的IBR发现，有856625台设备在扫描互联网空间，如图1所示。在伊朗断网的第一天，全球受影响设备（819392个地址）减少了4.35%，而第四天发现的记录设备数量最低，减少了18.46%（698532个地址）。虽然如此显著的下降不仅仅是由于伊朗互联网的关闭，在对伊朗特定设备的分析中发现了相关的趋势。在使用MaxMind
GeoLite数据库之后，对被使用的设备进行了地理定位，并发现了伊朗地址以供进一步处理。
对伊朗IP地址的调查显示，11月15日，182个受影响的伊朗地址扫描网络空间，如图2a所示。在断网的第一天，活跃生产IBR的主机数量急剧下降，下降了78.24%（3739个唯一地址）。到11月20日，伊朗的连通性达到了最低点，只有1237正在扫描的设备（下降92.80%）。11月起，伊朗政府在其首都德黑兰重启网络，与之相应，使用设备增长了26.67%。我们的研究还表明了伊朗网络的逐步恢复，其于11月24日大致回归常态。（14727台受影响设备，85.71%回归正常）为了证实我们针对伊朗的测量结果，我们提供了网络空间搜索引擎ZoomEye发布的公开数据，如图2b所示。网络空间搜索引擎不断地扫描互联网空间，努力识别具有开放端口和服务的面向互联网的设备。ZoomEye发表的统计数据显示与我们的研究结果有直接的相关性。11月14日识别到15502台伊朗受影响设备，11月20日降至1084（下降93.01%），达到最低点。伊朗断网几乎立竿见影，导致出站网络流量急剧下降。
#### 3.2 识别被使用的物联网设备
在识别出全球和伊朗特定的受影响的主机之后，我们通过上述浅层机器学习分类器识别出被使用的物联网设备。11月14日检测到的伊朗受影响设备数为17182台，其中16296被鉴定为物联网设备。将近94.8%的伊朗IP地址是物联网，因此需要对伊朗物联网设备与非物联网的传统机器进行纵向分析。这些研究结果并不完全出乎意料，机器学习分类器的研发人普尔等人称伊朗有全世界受影响的设备的10.17%。我们的研究发现11月14日伊朗有16296台物联网设备，占全世界总数2544408台的7.32%。
 图2:分别从IBR和ZoomEye发现的伊朗设备总数
![
](https://images.seebug.org/content/images/2021/06/e932fc83-67a7-4eca-83f9-1c4b2b849da4.png-w331s)
表1：按发现的IP地址计数排名靠前的伊朗网关
伊朗物联网设备受伊朗断网影响最大，截至11月17日，78.23%的设备不再接入互联网（2776台物联网设备，减少82.97%）。伊朗物联网专用连接在11月20日达到最低点，仅发现624个扫描设备（减少96.17%）。物联网设备下降96.17%（624台）。
对伊朗物联网设备和非物联网设备之间差异的进一步调查显示，受断网影响的物联网设备数量高于传统计算机。11月15日，受断网影响的设备组成比例分别为18.39物联网和1.00非物联网（16296物联网和886非物联网设备）。然而，到11月20日，这一比率分别降至1.02物联网和1.00非物联网（624物联网和613非物联网设备）。探测到的伊朗物联网设备的数量下降了96.17%，而非物联网设备中只有56.12%受到影响，如图3所示：
![
](https://images.seebug.org/content/images/2021/06/1f6151cd-b14d-4247-9a06-026cde97e0a5.png-w331s)
图3: 受影响的伊朗物联网设备与非物联网设备的比率
造成如此差异的一个原因可能是物联网和非物联网设备的实际扫描技术。由于物联网设备以较低的吞吐量进行扫描，一旦这些速率因互联网关闭而降低，它们就不再被目前所有的技术识别。因此，由于非物联网设备通常以更高的频率扫描互联网空间，断网对其可识别性的影响较小。
#### 3.3 网关可达性研究
在确认来自伊朗互联网空间的受影响的扫描仪设备后，我们将已知设备归为他们的互联网服务提供商和相关的网关。11月15日，检测到145个伊朗的网关的网络流量。11月20日为93（下降35.86%），为所发现的伊朗网关最低数。伊朗的网关通信没有看到与主动通信设备下降相当的大幅下降；但是，通信受阻的网关覆盖了最多的受影响设备。我们的研究结果对此提供了证据，证明伊朗政府专门针对更大的网关，将其网络断开，埃及政府在2011年的审查中也使用了这一策略。
表1显示了伊朗受影响设备的数量最大的网关，以及被伊朗政府切断连接的日期。最大的网关连接了48159台设备，在11月15日托管了3518个被使用的地址。到11月17日，只有298个地址在使用，到11月18日，只有1个地址在使用。同样地，表中总结的大多数网关在这方面也出现了大幅下降。11月17日，大多数设备完全断网。
到11月18日（17565808525124台设备与主机断连），这些网关直到11月22日才开始恢复，到11月24日达到接近峰值的数量。有趣的是，许多特定的网关没有受到相同程度的影响。例如，网关16322遭受90.05%的下降（网关48159下降99.99%），但从未跌破160个活动地址。网关43754和42337也有类似的趋势，表明这些网关可能承载了关键的或重要的网络，因此免于完全断开连接。
与我们的IBR结果相比，本文使用了6个BGPStream节点来检索全局BGP可达性数据。这些节点位于北美、南美、非洲和澳大利亚。图4a显示了北美、南美和澳大利亚节点发现的可到达伊朗网关的总数。这些结果彼此相当一致，说明在整个伊朗互联网关闭期间，可访问的网关从大约1000个大幅下降到200个。然而，比较每个节点的结果发现BGP扫描数据普遍不一致，如图4b所示。位于智利的节点接收到的伊朗网关可到达响应数最高（11月15日的峰值为5114，紧随其后的是位于非洲的节点（11月15日峰值为3390）。
![
](https://images.seebug.org/content/images/2021/06/8ad578f9-960e-416e-aa3c-e3b4ee2b9a65.png-w331s)
(a) 通过BGP扫描发现的可访问的伊朗网关总数 （b）BGP扫描数据不一致  
图4: 网关可达性 来自BGPStream实用程序[5]
而位于加州的节点收到的结果却少得多，从未收到超过550条响应。节点之间的其他比较显示了伊拉克、巴基斯坦、阿富汗、沙特阿拉伯和土耳其的大致相同的接收数据。事实上，如果发送到阿富汗IP地址空间的所有BGP数据包不是来自位于非洲的节点，那么这些数据包都会被丢弃，而南美节点会在特定的日子收到响应。这些发现暗示了伊朗政府在全国范围内根据特定地址来源国对其进行过滤。
#### 3.4 比特币加密货币交易所的检查
评估Blockchain.com提供的比特币加密货币交换数据，我们研究了伊朗断网与全球比特币挖矿趋势之间的相关性。虽然这些相关性可能不仅仅是由伊朗断网造成的，但研究“纯在线”的流量测量比特币加密货币等市场为全球互联网连接提供了另一种视角。而且成功的比特币交易揭示了与伊朗断网的线性关系。11月15日，325145笔比特币交易成功进行；然而，11月16日仅完成283468笔交易（下降12.82%）。截至11月17日，只有264370笔比特币交易最终成交（下降18.69%）。虽然加密货币市场相对不稳定，但这并不一定意味着开采或出售的比特币数量减少。更有可能是市场上出现了瓶颈，或报价未完成，或等待内存处理和出售。为了给这种符号性减少提供相关性检验，我们研究了聚合内存池中等待处理的总数量（当前节点帮助等待处理的事务的位数）。
先前成功交易量的典型下跌，例如从10月5日开始（32683笔交易）至10月6日（277613笔交易），但并没有未决交易的大幅增加（分别为4403至4057）。然而，从11月14日开始的交易量下降达到了峰值，达到了15088笔待处理交易。此外，总的内存池规模急剧膨胀。大小达到89770655位，比特币内存池总量周增长85.91%，与前一周的高点1264599位形成对比。因此我们可以确定，2019年11月全球比特币加密货币交易量的下降是一个特殊事件，而比特币市场最近出现了瓶颈。在2020年2月的头几周，针对伊朗互联网基础设施的大规模分布式拒绝服务攻击使伊朗的连接能力下降了近25%。比特币加密货币市场也受到了类似的影响，内存池的最大值为27351731位，高于前一周的峰值13559610位（增长101.71%）。这突出了伊朗断网与全球比特币市场之间的关系。这种相关性可能是由许多因素造成的，主要是伊朗大量开采加密货币的设备[12]。
### 4.相关工作
在本节中，我们将研究有助于大规模网络流量测量的相关工作。具体来说，我们讨论了断网特征和基于预测的方法，并列举了大规模断网的分析度量。
#### 4.1 大规模断网的预测和分类
尽管社会依赖于可靠的互联网连接，但断网仍然频繁发生。Aceto[13]等人对互联网普遍断网进行了全面调查，提出了断网分类的准则，同时系统分析了调查大规模断网事件的相关方法。此外，Quan[14]等人构建了一个基于ICMP的模型来识别全球断网，通过定期探测互联网空间，本文研究了整个互联网的稳定性。此外，改进了他们的断网检测系统。Quan等人后来开发了三目[15]，使用ICMP探测来扫描网络空间并检测断网事件，用一个高效、低交互的模型来确定兴趣点。这些研究说明了断网的多样性。尽管一些事件可能只持续几分钟或影响到少数人，但全国范围内的断网可能会削弱关键基础设施。对于国家主导的断网而言，一些重要的国家网络将会得以保持。我们的研究发现，在此次伊朗断网期间，一部分应用于政府和基础设施的网络得以保持。
#### 4.2 国家主导的断网的实证测量
以前研究大规模断网的研究通常可分为两类：通过主动探测（如BGP或ICMP扫描）进行断网识别，以及通过分析互联网背景辐射（IBR）进行断网识别。Shavitt[16]等人对2011年阿拉伯之春进行了有效的调查。使用了363万个路由跟踪测量，说明了阿拉伯之春期间埃及、利比亚和叙利亚互联网的状况。Dainotti[17]等人使用有源BGP域间探测和分析IBR对2011年埃及和利比亚的断网进行了类似的调查。最近，Guillot等人开发了断网检测分类器Chocolatine[18]。使用网络运动传感器对互联网规模的IBR进行了调查，发现其趋势是一致的；来自每个地理网关的扫描IP地址数保持不变。使用这些观测，sea-sonal ARIMA被用于时间序列预测，预测和评估从单个网关生成IBR的唯一IP地址的数量，将偏差或下降归因于断网。
原先提及的文献介绍了通过主动探测和IBR分析来识别和测量断网的方法。同样，本研究也使用BGP域间路由表和互联网规模的网络运动传感器，对伊朗互联网关闭事件进行了独特的调查和分析。此外，收集的IBR分类揭示了有关伊朗物联网的特定见解，并发现了关键运营网关的系统性关闭。
### 5.结束语
本研究实证性衡量了一个国家级的审查事件。通过处理近50TB的未经请求的互联网背景辐射，发现超过17000台受影响设备从伊朗IP空间扫描全球互联网，其中16296台属于物联网。此外，我们的研究结果表明伊朗网关可达性急剧下降（145个活跃网关下降到93个）。此外，我们还发现由于对特定IP地址空间进行全国范围的过滤而导致的全局BGP不一致性。最后，我们分析了比特币加密货币市场，揭示了成功交易相对于存储未决交易的内存池内存量的减少。未来的工作可以提供对网络分组的深入分析，特别是物联网设备分组。此外，未来使用加密节点或相关基础设施[19]来描述断网的研究将会提出与互联网路由和连接相关的更有效的结论。
### 6.参考文献
[1] Karyn Benson el al. Gaining insight into as-level outages through analysis
of internet background radiation. In 2013 IEEE Conference on Computer
Communications Workshops (INFOCOM WKSHPS), pages 447–452. IEEE, 2013.  
[2] Ryan Bogutz, Yuri Pradkin, and John Heidemann. Identifying important
internet outages (extended). Technical report, TR ISI-TR-735, USC/ISI, 2019.  
[3] Farooq Shaikh, Elias Bou-Harb, Nataliia Neshenko, Andrea P Wright, and
Nasir Ghani. Internet of malicious things: Correlating active and passive
measurements for inferring and characterizing internet-scale unsolicited iot