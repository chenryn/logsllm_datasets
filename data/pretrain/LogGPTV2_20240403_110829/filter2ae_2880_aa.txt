### 0×01 引言
在渗透测试过程中，我们通常只能获得目标系统的Guest或User权限。这种低级别的权限会限制我们的操作，因此我们需要逐步提升权限，从Guest到User，再到Administrator，最终达到SYSTEM级别。渗透测试的最终目标是获取服务器的最高权限，即Windows系统中的管理员权限或Linux系统中的root权限。

权限提升主要分为两种类型：
- **纵向提权**：低权限角色获得高权限角色的权限。例如，一个webshell通过提权获得了管理员权限。
- **横向提权**：获取同级别角色的权限。例如，通过已经攻破的系统A获取系统B的权限。

在成功获取目标机的Meterpreter shell后，我们需要确定当前拥有的权限。具体步骤如下：
1. 在Meterpreter shell中输入`shell`命令进入目标机的CMD命令行。
2. 输入`whoami /groups`命令查看当前用户的组信息。

如果结果显示为`Mandatory Label\Medium Mandatory Level`，说明我们是一个标准用户，需要将权限提升到`Mandatory Label\High Mandatory Level`（管理员权限）。

常见的提权方法包括：
- 使用`getsystem`命令提升权限
- 利用本地漏洞
- 假冒令牌
- 绕过Windows账户控制（UAC）
- 使用HASH

### 0×02 使用`getsystem`提升权限
`getsystem`是Meterpreter中的一个命令，它会自动尝试多种技术来提升用户权限。输入`getsystem -h`可以查看该命令使用的三种技术。默认情况下，`getsystem`会尝试所有列出的技术，直到成功为止。

具体操作步骤如下：
1. 输入`getsystem`命令，系统会自动尝试提权。
2. 如果提权成功，当前用户权限将提升到管理员级别。

该命令使用方便且高效，在渗透测试中经常被使用，建议在提权过程中优先尝试此方法。

### 0×03 利用本地漏洞提权
本地漏洞提权是指利用已知的本地漏洞来提升权限。通过运行一些现成的exploit程序，可以将用户从users组或其他系统用户组提升到administrators组（或root）。

缓冲区溢出漏洞是常见的本地漏洞之一。当用户输入的数据超过程序预设的缓冲区长度时，程序就会发生溢出，从而导致安全问题。

具体操作步骤如下：
1. 使用`getuid`命令查看当前权限，确认当前是user权限。
2. 尝试使用`getsystem`提权，如果失败，则进入下一步。
3. 输入`shell`命令进入目标机的CMD命令行。
4. 使用`systeminfo`命令或查看`c:\windows\`目录下的补丁日志文件，了解目标机已安装的补丁情况。

如果目标机未安装关键补丁，可以尝试利用已知漏洞进行提权。常见的漏洞包括ms13_053、ms14_058、ms16_016、ms16_032等。

相关漏洞信息和exploit程序可以从以下网站获取：
- **SecurityFocus BugTraq**：提供丰富的漏洞和exploit数据源，支持通过CVE编号或产品信息搜索。网址：[http://www.securityfocus.com/bid](http://www.securityfocus.com/bid)
- **Exploit-DB**：不断更新大量的exploit程序和报告，具有强大的搜索功能。网址：[http://www.exploit-db.com](http://www.exploit-db.com)

以下是一些常见系统的补丁号及其对应的漏洞编号：

| 补丁号   | 漏洞编号 |
|----------|----------|
| KB2360937 | MS10-084  |
| KB2478960 | MS11-014  |
| KB2507938 | MS11-056  |
| KB2566454 | MS11-062  |
| KB2646524 | MS12-003  |
| KB2645640 | MS12-009  |
| KB2641653 | MS12-018  |
| KB944653  | MS07-067  |
| KB952004  | MS09-012  |
| KB971657  | MS09-041  |
| KB2620712 | MS11-097  |
| KB2393802 | MS11-011  |
| KB942831  | MS08-005  |
| KB2503665 | MS11-046  |
| KB2592799 | MS11-080  |
| KB956572  | MS09-012  |
| KB2621440 | MS12-020  |
| KB977165  | MS10-015  |
| KB3139914 | MS16-032  |
| KB3124280 | MS16-016  |
| KB3134228 | MS16-014  |
| KB3079904 | MS15-097  |
| KB3077657 | MS15-077  |
| KB3045171 | MS15-051  |
| KB3000061 | MS14-058  |
| KB2829361 | MS13-046  |
| KB2850851 | MS13-053  |
| KB2707511 | MS12-042  |
| KB2124261 | MS10-065  |
| KB970483  | MS09-020  |

通过这些步骤和资源，您可以有效地进行权限提升，并实现渗透测试的目标。