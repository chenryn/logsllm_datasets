# 007黑客组织及其地下黑产活动分析报告
|
##### 译文声明
本文是翻译文章，文章来源：360追日团队
译文仅供参考，具体内容表达以及含义原文为准。
摘 要
²最早可以追溯到2007年开始进行制作并传播恶意代码等互联网地下产业链活动,一直活跃至今。
²制作并传播的Hook007类样本HASH数量达到17万个,相关恶意代码云查询拦截次数达到1.3亿次,相关恶意代码主要以后门和盗号程序为主。
²主要针对中国用户,累计受影响用户超过千万,单就Hook007家族统计近一年被感染用户达到50万。
²相关初始攻击主要依托即时通讯工具(QQYY等)采用社会工程学方法进行对特定对象进行攻击;相关攻击对象主要为网络游戏玩家等普通网民,另外对教育、金融领域有几次针对性攻击。
²进一步攻击方式主要是将恶意代码伪装为图片、文档等发送给特定对象,另外是制作虚假游戏平台网站,网站提供伪装游戏平台(game456等)安装包的恶意代码。
²该组织持续与安全厂商进行对抗,至少针对包括360在内的3款国内安全软件,以及卡巴斯基、比特梵德等国外相关安全产品采取过针对性技术措施,对抗行为最早可以追溯到2008年。对抗手段从实体文件到通信协议进行相关对抗,主要针对本地静态扫描、云查杀、主动防御策略和网络层等环节的检测。另外值得注意的是该组织成员会主动将恶意代码上报给安全厂商,目的是申请将恶意程序添加白名单或者探测安全厂商检测机制。单就Hook007这个家族,我们对相关产品进行了多次升级或检测策略调整。
²该组织主要以窃取用户数据、互联网资源与服务滥用进行牟利。经过推算作者单就Hook007这一种远控,每年至少获利超过百万。另外通过窃取用户数据和虚拟财产,造成每年普通网民财产损失逾千万元。Hook007这条地下产业链获利总额已经过亿。
²该组织相关成员分工明确,从制作恶意代码到最终获利组成了一条完整的地下产业链。主要包含制作恶意代码、传播、更新、获利等环节。
目 录
第一章存在若干年的地下产业链活动… 1
一、关于007组织的产业链…. 1
二、影响范围最大的地下产业链…. 2
三、攻击目标…. 2
四、攻击时间(变化趋势)…. 3
五、牟利…. 3
六、用户反馈…. 5
第二章攻击手法分析… 8
一、典型攻击流程…. 8
二、恶意代码传播…. 9
三、持续对抗…. 12
四、制作和更新…. 16
第三章该组织使用的C&C. 22
一、C&C分类…. 22
二、依托第三方平台中转…. 22
第四章幕后始作俑者… 24
附录1 Hook007家族样本分析报告… 25
附录2 007组织涉案金额估算… 25
附录3 C&C. 26
附录4 MD5值… 27
第一章存在若干年的地下产业链活动
一、关于007组织的产业链
我们从2011年开始发现Hook007家族恶意代码,通过我们的持续监控和分析,幕后庞大的黑客组织逐渐浮出水面,我们将该组织命名007组织。该组织最早从2007年开始进行制作并传播恶意代码,窃取用户数据、虚拟财产等互联网地下产业链活动,一直活跃至今。这是我们目前捕获到的影响范围最大,持续时间最长的地下产业链活动。
以007组织为主的地下产业链主要涉及商品是技术服务和恶意代码,该组织的核心商品是Hook007远程控制恶意代码,进一步主要包含制作恶意代码、传播、更新、获利等环节。Hook007远程控制是该组织独立开发并进行持续的更新维护。007组织具备严密完整的组织结构,其中核心成员主要为开发和一级代理销售,目前我们能明确掌握的是通过恶意代码这种商品的交易是该组织牟利的主要手段之一。相关恶意代码传播到最终通过窃取用户数据进行牟利这一环节我们可以确定是该地下产业链的一部分。
图 1消费者与生产者基本关系
007组织涉及的地下产业链中主要还是充当卖家(生产者)的角色。从下图商品分类中,可以看出007组织涉及的商品主要为恶意代码(远控、免杀等工具)和提供相关技术服务。另外该地下产业链中其他环节会包括数据信息、权限、漏洞等商品,但不是007组织主要涉及的商品类型。
图 2地下产业经济链体系中商品分类
二、影响范围最大的地下产业链
007组织相关攻击活动最早可以追溯到2007年,从2011年开始非常活跃。制作并传播的Hook007类样本HASH数量达到17万个,变种数量达到66种,相关恶意代码传播达到1.3亿次。另外我们近三个月捕获到该家族的免杀器版本已超过上百个,购买用户超过600个。该组织的相关攻击活动主要针对中国用户,累计受感染用户超过千万,单就Hook007家族统计近一年被感染用户达到50万。
该组织在攻击成功后会通过远程控制强行阻止用户操作游戏,并直接将用户的虚假财产、游戏装备进行交易转给盗号者帐号。另外该组织一直与安全厂商进行持续的对抗,从静态查杀、动态检测到网络不同层面进行躲避和对抗。
这是我们历年来捕获到的影响范围最大,持续时间最长的地下产业链活动。
三、攻击目标
通过我们的研究分析可以得出,007组织主要针对中国地区的用户,其中主要关注网络游戏玩家等普通网民。
另外对教育、金融领域有几次针对性攻击:
相关恶意代码原始文件名  
---  
2015证券数据-验证.exe
2015年注册化工工程师-验证.exe
2015年重庆市社会工作员职业水平考试.exe
2015年执业医师(临床).exe
2015年山东地区第三季度会计从业.exe
2015江苏第四季会计从业-部分验证.exe
2015cpa注册会计师数据-验证.exe
15年造价工程师-验证.exe
15贵州会计从业数据.exe
15高级职称考生报名.exe  
表1相关恶意代码原始文件名
相关统计项
|
具体内容  
---|---  
开始时间
|
2014年10月10日  
结束时间
|
2015年10月10日  
被感染用户数量
|
500559个  
恶意代码数量
|
161581个  
表2 Hook007家族感染情况统计
图 3近一年受Hook007家族影响的用户数量
四、攻击时间(变化趋势)
图 4恶意代码更新记录
上图是我们就Hook007家族变化趋势的记录,每个时间点都是Hook007家族新增变种或者相关攻击方式或资源有重大变化的记录。
007组织相关攻击活动最早可以追溯到2007年,而从2011年开始Hook007家族开始影响比较广泛,可以看出在2014年到2015年期间Hook007版本更新迭代非常频繁。
五、牟利
(一)恶意代码
恶意代码的制作和更新维护是007组织的核心业务。进一步相关类型主要是木马生成器、免杀和一些定制木马。作者每年单就Hook007这一种远程控制恶意程序获利就已超过百万。下图是我们截获的该组织相关恶意程序的报价单。
图 5 007组织相关恶意代码报价单(更新时间为2010年7月)
我们近三个月捕获到该家族的免杀器版本已超过上百个,购买用户超过600个。下图是购买相关恶意程序的地下产业链成员的分布情况,可以看出以广东省最多,其次是河南和山东省。
图 6购买Hook007远控的地下产业链成员分布(最近三个月数据)
(二)窃取用户数据
Hook007远程控制主要功能就是攻击者可以完全控制受害者的机器,攻击者可以下发任意控制指令。从我们收到的大量被感染Hook007木马的用户反馈中可以得知,该组织在攻击成功后通常会通过远程控制强行阻止用户操作游戏,并直接将用户的虚假财产、游戏装备进行交易转给盗号者帐号。也就是主要以窃取用户虚拟货币、网游装备来进行牟利。通过窃取用户数据和虚拟财产,造成每年普通网民财产损失逾千万元。
(三)其他
DDOS:该组织成员有开发如“毁灭者DDOS”等DDOS工具,由此我们怀疑除了工具的开发,相应地下产业链可能有涉及相关DDOS攻击业务。
恶意推广:通过我们监控发现,该组织在控制受害者主机之后,可能会远程控制下载执行推广包,通过安装量来达到牟利的目的。
六、用户反馈
我们从第三方平台和360论坛等平台收到大量用户反馈,相关反馈主要集中在已经造成用户财产损失的用户求助信息。
以下是一些典型用户反馈的截图和链接:
图 7用户反馈截图1
参考链接:[http://china.findlaw.cn/ask/question_1720116.html](http://china.findlaw.cn/ask/question_1720116.html)
图 8用户反馈截图2
参考链接:[http://bbs.open.qq.com/thread-7593006-1-1.html](http://bbs.open.qq.com/thread-7593006-1-1.html)
图 9用户反馈截图3
参考链接:[http://bbs.360safe.com/thread-3943057-1-1.html](http://bbs.360safe.com/thread-3943057-1-1.html)
图 10用户反馈截图4
参考链接:
第二章攻击手法分析
一、典型攻击流程
(一)基于即时通讯工具
图 11典型攻击流程(基于即时聊天工具)
具体攻击步骤:
a、攻击者首先依托游戏平台进行“喊话”或发站内信,以出售、收购或交换游戏装备的名义发送虚假消息,并留下QQ号。
b、受害者通过游戏平台了解到攻击者发送的消息,如果受害者不知情则有可能添加攻击者联系方式,主动联系攻击者。
c、进一步攻击者通过QQ等即时聊天工具进一步获取受害者信任。
d、当攻击者取得受害者一定程度信任后,攻击者会将木马文件伪装成“装备图片”等发送给受害者,受害者接收执行后则被植入相关后门木马,被攻击者控制。
e、远程控制玩家电脑,锁定计算机的键盘、鼠标,或设置屏幕黑屏。并短时间内将玩家的游戏装备,金币交易给盗号者的帐号。
(二)基于假冒网站
图 12典型攻击流程(基于假冒网站)
具体攻击步骤:
a、攻击者首先制作假冒网站,这里主要是假冒如game456类游戏平台网站,同时会制作相应虚假的恶意安装包程序。最终假冒网站上的下载链接会指向这个虚假安装包程序。
b、进一步攻击者需要让相应用户访问假冒网站,主要途径是通过搜索引擎和基于即时聊天工具等平台。攻击者会使用付费推广等方法,使得相关假冒网站在搜索某些关键字的时候,可以优先呈现在搜索结果中。
c、受害者从搜索引擎搜索出或者从聊天工具中收到相关假冒网站链接,并点击打开假冒网站,则有可能下载相应虚假安装程序。假冒网站制作的与正常官方网站从外观看基本一致,用户很难辨别真伪。另外相关游戏平台官方网站或者安装包的来源是否为官方源本来就没有清晰明确的提示,所以用户从搜索结果中很难识别哪些是可信,那些是恶意的。
d、当受害者下载并执行了虚假安装包,则操作系统会被攻击者控制。
e、远程控制玩家电脑,锁定计算机的键盘、鼠标,或设置屏幕黑屏。并短时间内将玩家的游戏装备,金币交易给盗号者的帐号。
注:
以上是主流的攻击流程,一些非主流攻击流程没有具体展开。如利用邮件附件传播、挂马传播等传播方式,DDOS攻击,在受害主机上下载执行推广包等获利模式等。
二、恶意代码传播
恶意代码的传播方法主要集中在依托即时通讯工具和网站。其中以依托即时通讯工具这种方式占主流。
(一)即时通讯工具