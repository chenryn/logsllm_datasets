User: How to set up a firewall in a Linux system to protect server resources and applications? Please explain in detail how to configure and use iptables.
Assistant: 1. Confirm the status of iptables Use the following command to view the status of the current iptables firewall: ``` iptables -L ``` 2. Close the iptables firewall If there is no rule, you can directly close the iptables firewall: ``` iptables -P INPUT ACCEPT iptables -P OUTPUT ACCEPT iptables -P FORWARD ACCEPT iptables -F ``` 3. Allow specified IP or port - allow specified IP access If only specified IP access is allowed, you can use the following command: ``` iptables -A INPUT -s 192.168 .1.1 -j ACCEPT iptables -A INPUT -s 192.168.1.2 -j ACCEPT ``` - Allow specified port access If only specified port access is allowed, you can use the following command: ``` iptables -A INPUT -p tcp -- dport 80 -j ACCEPT iptables -A INPUT -p tcp --dport 443 -j ACCEPT ``` 4. Block specified IP or port - Block specified IP If you want to block a specific IP, you can use the following command: ``` iptables - A INPUT -s 192.168.1.1 -j DROP iptables -A INPUT -s 192.168.1.2 -j DROP ``` - Block specific ports If you want to block specific ports, you can use the following command: ``` iptables -A INPUT -p tcp --dport 25 -j DROP iptables -A INPUT -p tcp --dport 110 -j DROP ``` 5. Prohibit all traffic For urgent server maintenance, you can directly prohibit all inbound and outbound traffic. In this case, the server operates only locally. ``` iptables -P INPUT DROP iptables -P FORWARD DROP iptables -P OUTPUT DROP ``` 6. Save iptables settings After restarting the server, iptables rules will be lost. In order to save these settings, you can use the following command: ``` sudo iptables-save > /etc/iptables.up.rules ``` 7. Using iptables restore rules You can use the following command to restore your previously stored iptables settings: ``` sudo iptables-restore < /etc/iptables.up.rules ``` The above is how to use the basic functions of iptables, and the firewall can be configured according to the situation.