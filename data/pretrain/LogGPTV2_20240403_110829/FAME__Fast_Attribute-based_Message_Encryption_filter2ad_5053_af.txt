per matrix row, and requires 9 pairings per attribute to decrypt,
whereas our KP-ABE scheme (Figure B.1) does much better.
REFERENCES
[1] Zeutro LLC - Encryption and Data Security. http://www.zeutro.com/.
[2] Attribute-based Encryption. https://github.com/sagrawal87/ABE, 2017.
[3] M. Abe, J. Groth, M. Ohkubo, and T. Tango. Converting cryptographic schemes
from symmetric to asymmetric bilinear groups. In J. A. Garay and R. Gennaro,
editors, CRYPTO 2014, Part I, volume 8616 of LNCS, pages 241–260. Springer,
Heidelberg, Aug. 2014.
[4] S. Agrawal and M. Chase. A study of pair encodings: Predicate encryption in
prime order groups. In E. Kushilevitz and T. Malkin, editors, TCC 2016-A, Part II,
volume 9563 of LNCS, pages 259–288. Springer, Heidelberg, Jan. 2016.
[5] S. Agrawal and M. Chase. Simplifying design and analysis of complex predicate
encryption schemes. In J. Coron and J. B. Nielsen, editors, EUROCRYPT 2017,
Part I, volume 10210 of LNCS, pages 627–656. Springer, Heidelberg, May 2017.
[6] J. A. Akinyele, C. Garman, and S. Hohenberger. Automating fast and secure trans-
lations from type-I to type-III pairing schemes. In I. Ray, N. Li, and C. Kruegel:,
editors, ACM CCS 15, pages 1370–1381. ACM Press, Oct. 2015.
[7] J. A. Akinyele, C. Garman, I. Miers, M. W. Pagano, M. Rushanan, M. Green, and
A. D. Rubin. Charm: a framework for rapidly prototyping cryptosystems. Journal
of Cryptographic Engineering, pages 111–128, 2013.
[8] J. A. Akinyele, M. Green, and S. Hohenberger. Using SMT solvers to automate
design tasks for encryption and signature schemes. In A.-R. Sadeghi, V. D. Gligor,
and M. Yung, editors, ACM CCS 13, pages 399–410. ACM Press, Nov. 2013.
[9] J. A. Akinyele, M. W. Pagano, M. D. Green, C. U. Lehmann, Z. N. J. Peterson, and
A. D. Rubin. Securing electronic medical records using attribute-based encryption
on mobile devices. In SPSM ’11, pages 75–86, 2011.
[10] N. Attrapadung. Dual system encryption via doubly selective security: Frame-
work, fully secure functional encryption for regular languages, and more. In P. Q.
Nguyen and E. Oswald, editors, EUROCRYPT 2014, volume 8441 of LNCS, pages
557–577. Springer, Heidelberg, May 2014.
[11] N. Attrapadung. Dual system encryption framework in prime-order groups
via computational pair encodings. In J. H. Cheon and T. Takagi, editors, ASI-
ACRYPT 2016, Part II, volume 10032 of LNCS, pages 591–623. Springer, Heidelberg,
Dec. 2016.
[12] R. Baden, A. Bender, N. Spring, B. Bhattacharjee, and D. Starin. Persona: an
online social network with user-defined privacy. In ACM SIGCOMM 2009, pages
135–146, 2009.
[13] A. Beimel. Secret-sharing schemes: A survey. In Coding and Cryptology, pages
11–46. 2011.
[14] M. Bellare and P. Rogaway. Random oracles are practical: A paradigm for de-
signing efficient protocols. In V. Ashby, editor, ACM CCS 93, pages 62–73. ACM
Press, Nov. 1993.
[15] M. Bellare and P. Rogaway. Optimal asymmetric encryption. In A. D. Santis,
editor, EUROCRYPT’94, volume 950 of LNCS, pages 92–111. Springer, Heidelberg,
May 1995.
[16] J. Bethencourt, A. Sahai, and B. Waters. Ciphertext-policy attribute-based en-
cryption. In 2007 IEEE Symposium on Security and Privacy, pages 321–334. IEEE
Computer Society Press, May 2007.
[17] D. Boneh, X. Boyen, and H. Shacham. Short group signatures. In M. Franklin,
editor, CRYPTO 2004, volume 3152 of LNCS, pages 41–55. Springer, Heidelberg,
Aug. 2004.
[18] J. Camenisch, M. Dubovitskaya, R. R. Enderlein, and G. Neven. Oblivious transfer
with hidden access control from attribute-based encryption. In I. Visconti and
R. D. Prisco, editors, SCN 12, volume 7485 of LNCS, pages 559–579. Springer,
Heidelberg, Sept. 2012.
[19] J. Chen, R. Gay, and H. Wee. Improved dual system ABE in prime-order groups
via predicate encodings. In E. Oswald and M. Fischlin, editors, EUROCRYPT 2015,
Part II, volume 9057 of LNCS, pages 595–624. Springer, Heidelberg, Apr. 2015.
[20] J. Chen, R. Gay, and H. Wee. Improved dual system ABE in prime-order groups
via predicate encodings. Cryptology ePrint Archive, Report 2015/409, 2015.
http://eprint.iacr.org/2015/409.
[21] J. Chen and H. Wee. Fully, (almost) tightly secure IBE and dual system groups.
In R. Canetti and J. A. Garay, editors, CRYPTO 2013, Part II, volume 8043 of LNCS,
pages 435–460. Springer, Heidelberg, Aug. 2013.
[22] A. Escala, G. Herold, E. Kiltz, C. Ràfols, and J. Villar. An algebraic framework for
Diffie-Hellman assumptions. In R. Canetti and J. A. Garay, editors, CRYPTO 2013,
Part II, volume 8043 of LNCS, pages 129–147. Springer, Heidelberg, Aug. 2013.
[23] D. M. Freeman. Converting pairing-based cryptosystems from composite-order
groups to prime-order groups. In H. Gilbert, editor, EUROCRYPT 2010, volume
6110 of LNCS, pages 44–61. Springer, Heidelberg, May 2010.
[24] S. Galbraith.
type
new-discrete-logarithm-records-and-the-death-of-type-1-pairings/, 2014.
New discrete logarithm records, and the death of
https://ellipticnews.wordpress.com/2014/02/01/
pairings.
1
[25] S. D. Galbraith, K. G. Paterson, and N. P. Smart. Pairings for cryptographers.
Discrete Applied Mathematics, pages 3113 – 3121, 2008.
[26] E. Ghadafi, N. P. Smart, and B. Warinschi. Groth-Sahai proofs revisited.
In
P. Q. Nguyen and D. Pointcheval, editors, PKC 2010, volume 6056 of LNCS, pages
177–192. Springer, Heidelberg, May 2010.
[27] V. Goyal, A. Jain, O. Pandey, and A. Sahai. Bounded ciphertext policy attribute
based encryption. In L. Aceto, I. Damgård, L. A. Goldberg, M. M. Halldórsson,
A. Ingólfsdóttir, and I. Walukiewicz, editors, ICALP 2008, Part II, volume 5126 of
LNCS, pages 579–591. Springer, Heidelberg, July 2008.
[28] V. Goyal, O. Pandey, A. Sahai, and B. Waters. Attribute-based encryption for
fine-grained access control of encrypted data. In A. Juels, R. N. Wright, and
S. Vimercati, editors, ACM CCS 06, pages 89–98. ACM Press, Oct. / Nov. 2006.
Available as Cryptology ePrint Archive Report 2006/309.
[29] V. Goyal, O. Pandey, A. Sahai, and B. Waters. Attribute-based encryption for
fine-grained access control of encrypted data. Cryptology ePrint Archive, Report
2006/309, 2006. http://eprint.iacr.org/2006/309.
[30] M. Green and S. Hohenberger. Universally composable adaptive oblivious transfer.
In J. Pieprzyk, editor, ASIACRYPT 2008, volume 5350 of LNCS, pages 179–197.
Springer, Heidelberg, Dec. 2008.
[31] M. Green, S. Hohenberger, and B. Waters. Outsourcing the decryption of abe
ciphertexts. In USENIX Security Symposium 2011, pages 34–34, 2011.
[32] M. D. Green and I. Miers. Forward secure asynchronous messaging from punc-
In 2015 IEEE Symposium on Security and Privacy, pages
turable encryption.
305–320. IEEE Computer Society Press, May 2015.
[33] A. Guillevic. Comparing the pairing efficiency over composite-order and prime-
order elliptic curves.
In M. J. Jacobson Jr., M. E. Locasto, P. Mohassel, and
R. Safavi-Naini, editors, ACNS 13, volume 7954 of LNCS, pages 357–372. Springer,
Heidelberg, June 2013.
[34] A. Guillevic, F. Morain, and E. Thomé. Solving discrete logarithms on a 170-bit
MNT curve by pairing reduction. Cryptology ePrint Archive, Report 2016/507,
2016. http://eprint.iacr.org/2016/507.
[35] G. Herold, J. Hesse, D. Hofheinz, C. Ràfols, and A. Rupp. Polynomial spaces: A
new framework for composite-to-prime-order transformations. In J. A. Garay and
R. Gennaro, editors, CRYPTO 2014, Part I, volume 8616 of LNCS, pages 261–279.
Springer, Heidelberg, Aug. 2014.
[36] S. Hohenberger and B. Waters. Attribute-based encryption with fast decryption.
In K. Kurosawa and G. Hanaoka, editors, PKC 2013, volume 7778 of LNCS, pages
162–179. Springer, Heidelberg, Feb. / Mar. 2013.
[37] A. Joux. SAC 2013, chapter A New Index Calculus Algorithm with Complexity
$$L(1/4+o(1))$$ in Small Characteristic, pages 355–379. 2014.
[38] J. Katz, A. Sahai, and B. Waters. Predicate encryption supporting disjunc-
tions, polynomial equations, and inner products.
In N. P. Smart, editor, EU-
ROCRYPT 2008, volume 4965 of LNCS, pages 146–162. Springer, Heidelberg, Apr.
2008.
[39] T. Kim and R. Barbulescu. Extended tower number field sieve: A new complexity
for the medium prime case. In M. Robshaw and J. Katz, editors, CRYPTO 2016,
Part I, volume 9814 of LNCS, pages 543–571. Springer, Heidelberg, Aug. 2016.
[40] L. Kowalczyk and A. B. Lewko. Bilinear entropy expansion from the decisional
linear assumption. In R. Gennaro and M. J. B. Robshaw, editors, CRYPTO 2015,
Part II, volume 9216 of LNCS, pages 524–541. Springer, Heidelberg, Aug. 2015.
[41] A. B. Lewko. Tools for simulating features of composite order bilinear groups
in the prime order setting. In D. Pointcheval and T. Johansson, editors, EURO-
CRYPT 2012, volume 7237 of LNCS, pages 318–335. Springer, Heidelberg, Apr.
2012.
[42] A. B. Lewko, T. Okamoto, A. Sahai, K. Takashima, and B. Waters. Fully secure
functional encryption: Attribute-based encryption and (hierarchical) inner prod-
uct encryption. In H. Gilbert, editor, EUROCRYPT 2010, volume 6110 of LNCS,
pages 62–91. Springer, Heidelberg, May 2010.
[43] A. B. Lewko, A. Sahai, and B. Waters. Revocation systems with very small private
In 2010 IEEE Symposium on Security and Privacy, pages 273–285. IEEE
keys.
Computer Society Press, May 2010.
[44] A. B. Lewko and B. Waters. Unbounded HIBE and attribute-based encryption. In
K. G. Paterson, editor, EUROCRYPT 2011, volume 6632 of LNCS, pages 547–567.
Springer, Heidelberg, May 2011.
[45] B. Libert, T. Peters, M. Joye, and M. Yung. Compactly hiding linear spans - tightly
secure constant-size simulation-sound QA-NIZK proofs and applications. In
T. Iwata and J. H. Cheon, editors, ASIACRYPT 2015, Part I, volume 9452 of LNCS,
pages 681–707. Springer, Heidelberg, Nov. / Dec. 2015.
[46] T. Okamoto and K. Takashima. Fully secure functional encryption with general
relations from the decisional linear assumption. In T. Rabin, editor, CRYPTO 2010,
volume 6223 of LNCS, pages 191–208. Springer, Heidelberg, Aug. 2010.
[47] T. Okamoto and K. Takashima. Fully secure unbounded inner-product and
attribute-based encryption. In X. Wang and K. Sako, editors, ASIACRYPT 2012,
volume 7658 of LNCS, pages 349–366. Springer, Heidelberg, Dec. 2012.
[48] R. Ostrovsky, A. Sahai, and B. Waters. Attribute-based encryption with non-
monotonic access structures. In P. Ning, S. D. C. di Vimercati, and P. F. Syverson,
editors, ACM CCS 07, pages 195–203. ACM Press, Oct. 2007.
[49] B. Parno, M. Raykova, and V. Vaikuntanathan. How to delegate and verify in
public: Verifiable computation from attribute-based encryption. In R. Cramer,
editor, TCC 2012, volume 7194 of LNCS, pages 422–439. Springer, Heidelberg, Mar.
2012.
[50] Y. Rouselakis and B. Waters. Practical constructions and new proof methods for
large universe attribute-based encryption. In A.-R. Sadeghi, V. D. Gligor, and
M. Yung, editors, ACM CCS 13, pages 463–474. ACM Press, Nov. 2013.
[51] Y. Rouselakis and B. Waters. Efficient statically-secure large-universe multi-
authority attribute-based encryption. In R. Böhme and T. Okamoto, editors, FC
2015, volume 8975 of LNCS, pages 315–332. Springer, Heidelberg, Jan. 2015.
[52] A. Sahai and B. R. Waters. Fuzzy identity-based encryption. In R. Cramer, editor,
EUROCRYPT 2005, volume 3494 of LNCS, pages 457–473. Springer, Heidelberg,
May 2005.
[53] N. Santos, R. Rodrigues, K. P. Gummadi, and S. Saroiu. Policy-sealed data: A new
abstraction for building trusted cloud services. In USENIX Security Symposium
2012, pages 175–188, 2012.
[54] H. Shacham. A cramer-shoup encryption scheme from the linear assumption and
from progressively weaker linear variants. Cryptology ePrint Archive, Report
2007/074, 2007. http://eprint.iacr.org/2007/074.
[55] P. Traynor, K. R. B. Butler, W. Enck, and P. McDaniel. Realizing massive-scale
conditional access systems through attribute-based cryptosystems. In NDSS 2008.
The Internet Society, Feb. 2008.
[56] B. Waters. Dual system encryption: Realizing fully secure IBE and HIBE under
simple assumptions. In S. Halevi, editor, CRYPTO 2009, volume 5677 of LNCS,
pages 619–636. Springer, Heidelberg, Aug. 2009.
[57] B. Waters. Ciphertext-policy attribute-based encryption: An expressive, efficient,
and provably secure realization.
In D. Catalano, N. Fazio, R. Gennaro, and
A. Nicolosi, editors, PKC 2011, volume 6571 of LNCS, pages 53–70. Springer,
Heidelberg, Mar. 2011.
[58] H. Wee. Dual system encryption via predicate encodings. In Y. Lindell, editor,
TCC 2014, volume 8349 of LNCS, pages 616–637. Springer, Heidelberg, Feb. 2014.
[59] B. Yang, K. Yang, Y. Qin, Z. Zhang, and D. Feng. DAA-TZ: An Efficient DAA Scheme
for Mobile Devices Using ARM TrustZone, pages 209–227. Springer International
Publishing, Cham, 2015.
A CP-ABE CORRECTNESS
We show that when S satisfies (M, π), decryption recovers the
correct message with probability 1. For ℓ = 1, 2, 3,

i∈I
ctγi
i, ℓ
i∈I
(cid:18)
= 
= (cid:169)(cid:173)(cid:171) n2
j=1
j=1
H(π(i)ℓ1)γi s1 · H(π(i)ℓ2)γi s2·
(cid:19)
n2
(cid:2)H(0jℓ1)s1 · H(0jℓ2)s2(cid:3)γi(M)i, j
(cid:2)H(0jℓ1)s1 · H(0jℓ2)s2(cid:3)
i∈I γi(M)i, j(cid:170)(cid:174)(cid:172)·
(cid:32)
(cid:33)

H(π(i)ℓ1)γi s1 · H(π(i)ℓ2)γi s2
H(π(i)ℓ1)γi s1 · H(π(i)ℓ2)γi s2 ,
i∈I
i∈I
= H(01ℓ1)s1 · H(01ℓ2)s2·
where the third equality follows from (2.1).
Now, the product of all but the first term in num is given by
(cid:20)

· e(H(013t), h)(r1+r2)st ·
t ∈{1,2}
(cid:18)
i∈I
e(H(011t), h)b1r1st · e(H(012t), h)b2r2st
e(H(π(i)1t)γi , h)b1r1st
(cid:19)(cid:21)
· e(H(π(i)2t)γi , h)b2r2st · e(H(π(i)3t)γi , h)(r1+r2)st
13
When the above product is divided by dem, it is easy to see that we
are only left with the inverse of (rest of the terms cancel out)
(cid:32)

t ∈{1,2}
(cid:169)(cid:173)(cid:171)
дdt · д
e
σ′
at
γi σπ(i)
at
·
i∈I
д
(cid:32)
дd3 · д
e
(cid:33)(cid:170)(cid:174)(cid:172)·
−σ′ ·
, hat st
д
i∈I
(cid:33)
,
−γi σπ(i) , hs1+s2
which is just equal to e(д, h)d1a1s1+d2a2s2+d3(s1+s2). Hence, msg is
successfully recovered.
B KP-ABE SCHEME
The scheme is formally described in Figure B.1. Correctness and
security of this scheme can be proved in a manner very similar
to that of Fame. Note that unlike CGW’s KP-ABE scheme [20,
Appendix B.1], our scheme does not put an a-priori bound on the
number of columns in the MSP.
C PROOF OF MAIN THEOREM
C.1 Description of hybrids
Hyb1 has already been discussed at length in §4.1. We now provide
a formal description of the rest of the hybrids, and then prove the
security of Fame. Before that, it would be useful to give names to
the various forms of ciphertext and keys that will be used. A key
can be in one of the following forms:
• Normal: Generated in Hyb1.
• P-normal: Br replaced by Br + ˆra⊥ in a Normal key, where
ˆr ←R Zp.
• P-normal⋆: σya⊥ for all y ∈ S and σ ′a⊥ removed from a
P-normal key.
• Normal⋆: Br + ˆra⊥ replaced by Br in a P-normal⋆ key.
• P-SF⋆: αa⊥ added to the last component (sk′) of a P-normal⋆
key, where α ←R Zp.
• SF⋆: Br + ˆra⊥ replaced by Br in a P-SF⋆ key.
A ciphertext can be either:
• Normal⋆: Generated in Hyb1.
• SF⋆: As replaced by As+ˆsb⊥ in a Normal⋆ ciphertext, where
ˆs ←R Zp.
• Rnd⋆: msgb replaced by msg⋆, where msg⋆ ←R GT .
P and SF stand for pseudo and semi-functional, respectively, fol-
lowing the terminology in previous work [19, 21, 42, 56].
The first objective of our proof is to remove the extra σya⊥ and
σ ′a⊥ components from all the keys. To do this, we change the
form of the very first key from Normal to P-normal in Hyb2,1,1,
then change it to P-normal⋆ in Hyb2,2,1, and finally to Normal⋆