The goal of the exploitation phase is to gather sensitive and security-
critical information and to gain access to accounts of a potential
victim, e.g., access to sensitive data of the victim. As in other use-
after-free attacks, an attacker waits for an identifier holder to use the
outdated resource identifier (i.e., the free-mail address) or triggers
a potential identifier holder to do so.
Emails addressed to the original owner of the free-mail address
now reach the attacker, e.g., personal emails sent by someone re-
membering the email address. This highlights a fundamental prob-
lem that Use-After-FreeMail uncovered: There is no automated
way to alter people’s memory upon the deletion or expiration of
a free-mail address, rendering some of the defenses against tradi-
tional use-after-free attacks inapplicable (cf. Section 2.2). Besides
personal emails, also account information and emails for password
reset requests will reach the attacker. Using the password-reset
functionality from third-party websites allows an attacker to gain
access to these account, e.g., social media accounts, bank accounts,
online shops, online discussion boards, video streaming services,
and many other. The attacker can again automate these checks for
popular websites. When implementing these automated checks, we
found them to be easier than the free-mail check we described in
the previous sections. While this may not cover all accounts that
the user has, the attacker can focus on all websites of interest.
For most websites, the password-reset functionality forms a
single-factor authentication through the email address used for
registration. As this email address now points to the email account
of the attacker, the attacker can authenticate with any other website
the victim used.
As this phase violates a user’s privacy and can also lead to tem-
porary or permanent loss of access to services, we also performed
this step only for users volunteering in our user case studies. The
results of the case studies are summarized in Section 7.
5 USE-AFTER-FREEMAIL THROUGH
EXPIRED DOMAIN NAMES
Similar to the usage of email addresses registered with free-mail
providers, it is possible to extend the described attacks to a larger
scope. While the attack vector described in Section 4 aims at the
user part of an email address, it is further possible to attack the
domain part of it. An attacker that is able to re-register a formerly
used domain is also able to re-activate all the email addresses of
this domain. Previous work hinted at the possibility of using emails
of re-registered domains for spam [29, 34] and authentication [38].
However, they focused on taking over other domains, similar as
Schlamp et al. [59], whereas our work focuses on authentication
with third-party services.
Even though the term domain owner is well established, a domain
is not really owned by a person or legal entity. As described by
the ICANN [32], the domain owner registers the rights to freely
dispose of such, but this right is subject to expiry after 1 to 10 years.
When a domain expires, the domain owner may renew the domain
registration. If the domain is not registered within a time frame
of 45 days, i.e., the Auto Renew Grace Period, the Redemption Grace
Period begins. After another 30 days, the domain will be deleted
6
within the next 5 days. If the domain owner did not intervene up to
this point, the domain will be publicly available for (re-)registration.
This scenario complies with the three use-after-free require-
ments as stated in Section 3.1 for the following reasons: The server
the domain references is the resource in question that might be
silently exchanged after domain expiration. The domain itself is the
resource identifier. As outlined above, re-registration of a domain
is available by design, leading to the same resource identifier ref-
erencing a different resource, i.e., a different server. Subsequently,
the re-registered domain can be used to receive emails destined to
addresses with the corresponding domain part.
5.1 Collection Phase
In contrast to free-mail accounts, the domain registration status is
comparably easy to determine. Based on email addresses in online
database leaks, we extract unique domain names. Registered and
active domains, i.e., domains that are not expired or still in the
auto renew grace period, are located in the zone files of the Domain
Name System (DNS) top level domains (TLD). Each Internet registry
maintains TLD zone files for the TLDs it is responsible for. Thus,
DNS can be utilized to filter active domains as a first step. Available
domains and domains in the redemption grace period do not exist
in the TLD zone file and remain in the attacker’s candidates list.
DNS queries for these domains result in NXDOMAIN errors. Hence,
after this filtering step, only the domains that are most likely to be
available for registration remain in the candidates list.
Besides directly available domains, another set of domains is
available for registration by an attacker. In the last decade, a market
for expired domains emerged. Special online businesses register
recently expired domains in order to sell them back to either the
former owner, who might just have missed the expiration date, or
other interested parties. Strictly speaking, domains that are reg-
istered by such a service are registered, but available for transfer.
Unlike directly available domains, an attacker has to pay a fee to
the current domain owner to get the domain transferred. As there
are many separate domain marketplaces, it is rather difficult to get
an automated list of these domains. Therefore, we technically limit
our experiments to domains that are directly available.
5.2 Impersonation Phase
As the redemption grace period lasts 30 days, expired domains
might not be available for registration even though indicated by
DNS responses. In this case, the attacker waits for the redemption
grace period to pass. The impersonation phase consists of regis-
tering the domain and providing resource information, i.e., an IP
address as mail exchange (MX) record. The attacker’s system is con-
figured to accept all email delivered to it. Thus, emails directed to
any mailbox on this domain are delivered to the attacker’s mailbox.
Depending on the former domain owner, it might also be possible
to impersonate a whole company and scam users of the former
website and customers of the former company. An attacker can
craft a counterfeit website (impersonation phase) such that visitors
believe it is still the original business. This is especially dangerous
for small businesses and startups that may go out of business, which
in many cases inevitably leads to domain expiration. However, in
this paper, we focus on Use-After-FreeMail attacks.
Table 2: Top 10 providers over 607 mio. leaked addresses and
their deletion/expiration policies.
Table 3: Collection Phase: Number of addresses free to reg-
ister and computation time.
Provider
Yahoo
Hotmail/Live/Outlook
mail.ru
Gmail
Yandex
AOL
rambler.ru
GMX
web.de
Lycos
Addresses % of 607M Deletion Period
146 507 865
24.1% 40–180 days [69]
20.5% 0 days [46]
124 309 619
14.9% 3 months [41]
90 313 533
9.9% 2–3 weeks [24]
60 221 972
3.9% 1 month [71]
23 588 886
3.5% 90 days [53]
21 228 548
2.7% 6 months [58]
16 080 401
1.5% 6 months [22]
9 321 442
8 296 692
1.4% 1 year [65]
1.0% 2 days [40]
5 870 302
Expiration Period Re-reg.
1 year [70]
1 year [45]
≥ 3 months [42]
—
2 years [71]
90 days [53]
6 months [58]
6 months [23]
1 year [66]
30 days [40]
✓
✓
✓
✗ [25]
✓
✓
✗ [57]
✓
✓
✓
Provider
Yahoo
Hotmail/Live/Outlook
mail.ru
Gmail
Yandex
AOL
rambler.ru
Free Time/Check Expected Free
81 590 230
44 241 793
7 703 744
6 594 306
582 645
9 383 018
9 654 673
3 292 333
1 653 531
4 535 982
0.27 s
1.16 s
1.74 s
2.59 s
0.11 s
8.60 s
6.85 s
0.92 s
0.61 s
3.96 s
55.69%
35.59%
8.53%
10.95%
2.47%
44.20%
60.04%
GMX 35.32%
19.93%
web.de
Lycos
77.27%
Standard Error
1.28%
1.23%
0.72%
0.80%
0.40%
0.80%
1.26%
1.23%
1.03%
1.08%
5.3 Exploitation Phase
The exploitation phase follows the same procedure as for free-mail
accounts. However, here an attacker can also facilitate imperson-
ation techniques well-known from domain squatting attacks. The
attacker again tries to gather sensitive and security-critical infor-
mation, for any user that formerly existed on the impersonated
domain. Again, personal emails, but also account information and
emails to reset the password, for any user will reach the attacker in-
stead. With password-reset functionality from third-party websites,
the attacker can then take over control of these accounts.
As this phase would violate the privacy of many users and could
lead to loss of access to services, we only performed a quantitative
(cf. Section 6) and non-intrusive qualitative analysis (cf. Section 7.3).
6 QUANTITATIVE ANALYSIS
In this section, we provide a quantitative analysis of the potential
of Use-After-FreeMail. We will use this quantitative analysis to
provide estimates of how many people are potentially affected by
these attacks.
6.1 Analysis of Use-After-FreeMail
Analyzing 607 million unique email addresses from different leaks1
we found that the top 10 providers had a combined share of 83.3%
of the addresses leaked. The top 3 providers already amount for
51.1% of addresses in the analyzed leaks. Table 2 shows the number
of leaked addresses we found for the most common providers.
As a first step, we investigated the policies of the top providers,
as shown in Table 2. We found that most of the top providers allow
either deletion of email addresses, typically with a deletion period,
or have an expiration period for unused email addresses. Both the
deletion period and the expiration period vary widely between
different providers. The deletion period is 2 days in the lowest
case (Lycos) and at most 6 months (rambler.ru). The expiration
period is 30 days in the lowest case (Lycos) and at most 2 years
(Yandex). Naturally, this has an impact on the probability that an
email address expired. Furthermore, most of the top providers allow
re-registration, enabling Use-After-FreeMail attacks.
An exception here are Gmail and rambler.ru, which both do not
allow re-registration of deleted email addresses. While this provides
better protection for their users, we find that this still does not fully
prevent the problem of dangling references, i.e., dangling references
on addresses that were never valid in the first place. In fact, we
1Exploit.in, MySpace, Last.fm, AdultFriendFinder, Yahoo; all obtained from public
websites via Google searches
7
Figure 2: Probability that an email address is free to register
as a function of the account registration date found in the
last.fm leak.
found a small number of Gmail addresses and a larger number of
Rambler addresses that were free to register. We suspect that these
email addresses were leaked from services that did not validate
email addresses. However, these dangling references are just as
exploitable as dangling references from account expiration.
To investigate how widespread the issue is among different
providers, we randomly selected 10 000 email addresses for each of
the top 10 providers (cf. Table 2) from public database leaks. We
ran the fully automated collection phase on these 100 000 addresses.
Our implementation was able to test 7 to 546 addresses per minute,
depending on the provider.
Table 3 shows how many free email addresses we found per
provider. We computed the number of expected free addresses with
the shown standard error values (between 0.40% and 1.29%) and