n 如果相邻设备端口上STP功能未关闭，则请执行步骤3。
b. 请在接口视图下执行命令stp enable，使能STP功能。
c. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
l 原因2：与对端相连的网络链路拥塞。
a. 请检查本设备与相邻设备间的链路是否有链路拥塞。
n 如果拥塞，则请执行步骤2。
n 如果未拥塞，则请执行步骤3。
b. 请正确修复设备间的链路。
c. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
文档版本 09 (2017-09-04) 华为专有和保密信息 304
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
36.15 MSTP/4/PROPORT_ROLE_CHANGE
日志信息
MSTP/4/PROPORT_ROLE_CHANGE:The role of the port is changed.
(ProcessID=[ProcessID], InstanceID=[InstanceID], PortID1=[PortID1], PortID2=[PortID2],
PortID3=[PortID3], PortID4=[PortID4], PortIDFlag=[PortIDFlag], IfIndex=[IfIndex],
PreviousRole=[PreviousRole], NewRole=[NewRole], PortName=[PortName])
日志含义
端口在生成树协议中的角色发生变化。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
PortID2 端口ID2。
PortID3 端口ID3。
PortID4 端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PreviousRole 端口原来的角色。
NewRole 端口新的角色。
PortName 端口名称。
可能原因
原因1：生成树协议重新进行计算，端口角色发生变化。
处理步骤
l 正常运行信息，无需处理。
----结束
36.16 MSTP/4/PROPORT_ROOT_GUARDED
日志信息
MSTP/4/PROPORT_ROOT_GUARDED:The MSTP process's instance's ROOT-Protection
port received superior message. (ProcessID=[ProcessID], InstanceID=[InstanceID],
文档版本 09 (2017-09-04) 华为专有和保密信息 305
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
PortID1=[PortID1], PortID2=[PortID2], PortID3=[PortID3], PortID4=[PortID4],
PortIDFlag=[PortIDFlag], IfIndex=[IfIndex], PortState=[PortState], PortName=[PortName])
日志含义
MSTP进程实例中启用了根保护功能的端口上收到了较优的消息。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
PortID2 端口ID2。
PortID3 端口ID3。
PortID4 端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
可能原因
原因1：配置了根保护的指定端口收到了比本桥优先级高的BPDU报文。
原因2：网络拓扑有节点优先级发生变化。
处理步骤
l 原因1：配置了根保护的指定端口收到了比本桥优先级高的BPDU报文。
a. 请检查新加入的物理链路是否是需要的物理链路。
n 如果新加入的物理链路是需要的物理链路，则请执行步骤2。
n 如果新加入的物理链路不是需要的物理链路，则请执行步骤3。
b. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看各个端口是否符合协议计算结
果。
n 如果各个端口符合协议计算结果，则无需处理。
n 如果各个端口不符合协议计算结果，则请执行步骤4。
c. 请正确部署网络拓扑，查看问题是否消除。如果未消除，则请执行步骤4。
d. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看网络中是否有端口被规划为根保
护端口。
n 如果有端口被规划为根保护端口，则请执行步骤5。
n 如果没有端口被规划为根保护端口，则请执行步骤6。
文档版本 09 (2017-09-04) 华为专有和保密信息 306
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
e. 在接口视图下，执行命令undo stp root-protection去除根保护配置，查看告警
是否消除。如果未消除，则请执行步骤6。
f. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
l 原因2：网络拓扑有节点优先级发生变化。
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看网络拓扑中优先级的更改操作是
否是正常操作。
n 如果是正常操作，则请执行步骤3。
n 如果不是正常操作，则请执行步骤2。
b. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实
际需要重新配置本桥的优先级。或者执行命令undo stp [ instance instance-id ]
priority、undo stp [ instance instance-id ] root将桥优先级还原成缺省值。查看
告警是否消除。如果告警未消除，则请执行步骤3。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看网络中是否有端口被规划为根保
护端口。
n 如果有端口被规划为根保护端口，则请执行步骤4。
n 如果没有端口被规划为根保护端口，则请执行步骤5。
d. 在接口视图下，执行命令undo stp root-protection去除根保护配置，查看问题
是否消除。如果未消除，则请执行步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.17 MSTP/4/PROPORT_STATE_DISCARDING
日志信息
MSTP/4/PROPORT_STATE_DISCARDING:The MSTP Process's Port has been set to
discarding state. (ProcessID=[ProcessID], InstanceID=[InstanceID], PortID1=[PortID1],
PortID2=[PortID2], PortID3=[PortID3], PortID4=[PortID4], PortIDFlag=[PortIDFlag],
IfIndex=[IfIndex], PortState=[PortState], PortName=[PortName])
日志含义
MSTP进程的端口状态变为Discarding状态。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
PortID2 端口ID2。
PortID3 端口ID3。
文档版本 09 (2017-09-04) 华为专有和保密信息 307
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
参数名称 参数含义
PortID4 端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
可能原因
原因1：网络拓扑发生变化。
处理步骤
l 原因1：网络拓扑发生变化。
a. 请查看网络拓扑中的物理设备，是否有启用生成树协议的新的物理链路加
入。
n 如果有启用生成树协议的新的物理链路加入，则请执行步骤2。
n 如果没有启用生成树协议的新的物理链路加入，则请执行步骤3。
b. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤3。
n 如果不是需要的物理链路，则请执行步骤4。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看各个端口是否符合协议计算结
果。
n 如果各个端口符合协议计算结果，则无需处理。
n 如果各个端口不符合协议计算结果，则请执行步骤5。
d. 请正确部署网络拓扑，查看问题是否消除。如果未消除，请执行步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.18 MSTP/4/PROPORT_STATE_FORWARDING
日志信息
MSTP/4/PROPORT_STATE_FORWARDING:The MSTP Process's Port has been set to
forwarding state. (ProcessID=[ProcessID], InstanceID=[InstanceID], PortID1=[PortID1],
PortID2=[PortID2], PortID3=[PortID3], PortID4=[PortID4], PortIDFlag=[PortIDFlag],
IfIndex=[IfIndex], PortState=[PortState], PortName=[PortName])
日志含义
端口状态变为Forwarding状态。
文档版本 09 (2017-09-04) 华为专有和保密信息 308
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
PortID2 端口ID2。
PortID3 端口ID3。
PortID4 端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
可能原因
原因1：网络拓扑发生变化。
处理步骤
l 原因1：网络拓扑发生变化。
a. 请查看网络拓扑中的物理设备，是否有启用生成树协议的新的物理链路加
入。
n 如果有启用生成树协议的新的物理链路加入，则请执行步骤2。
n 如果没有启用生成树协议的新的物理链路加入，则请执行步骤3。
b. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤3。
n 如果不是需要的物理链路，则请执行步骤4。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看各个端口是否符合协议计算结
果。
n 如果各个端口符合协议计算结果，则无需处理。
n 如果各个端口不符合协议计算结果，则请执行步骤5。
d. 请正确部署网络拓扑，查看问题是否消除。如果未消除，请执行步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.19 MSTP/4/PROPORT_STATE_LEARNING
日志信息
MSTP/4/PROPORT_STATE_LEARNING:The MSTP Process's Port has been set to learning
state. (ProcessID=[ProcessID], InstanceID=[InstanceID], PortID1=[PortID1],
文档版本 09 (2017-09-04) 华为专有和保密信息 309
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
PortID2=[PortID2], PortID3=[PortID3], PortID4=[PortID4], PortIDFlag=[PortIDFlag],
IfIndex=[IfIndex], PortState=[PortState], PortName=[PortName])
日志含义
端口状态变为Learning状态。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
PortID2 端口ID2。
PortID3 端口ID3。
PortID4 端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
可能原因
原因1：Forward Delay Timer定时器超时。
处理步骤
步骤1 正常运行信息，无需处理。
----结束
36.20 MSTP/4/PROROOT_CHANGED
日志信息
MSTP/4/PROROOT_CHANGED:The root bridge of MSTP process has changed.
(ProcessID=[ProcessID], InstanceID=[InstanceID], PortID=[PortID],
PreviousRootBridgeID=[PreviousRootBridgeID], NewRootBridgeID=[NewRootBridgeID])
日志含义
MSTP进程的根桥发生变化。
文档版本 09 (2017-09-04) 华为专有和保密信息 310
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID 端口ID。
PreviousRootBridgeID 原来根桥的ID。
NewRootBridgeID 新根桥的ID。
可能原因
原因1：新加入了设备，该设备的桥ID最优。
原因2：修改了原有网络中设备的优先级或域配置。
处理步骤
l 原因1：新加入了设备，该设备的桥ID最优。
a. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤2。
n 如果不是需要的物理链路，则请执行步骤3。
b. 在新加入的设备上，执行命令display stp [ process process-id ] [ instance
instance-id ] [ interface interface-type interface-number ] [ brief ]查看桥ID是否为
整个网络最优。
n 如果是整个网络最优，则请执行步骤3。
n 如果不是整个网络最优，则请执行步骤5。
c. 请确认新加入设备的桥ID是否应该规划为整网中最优ID。
n 如果应该规划为整网中最优ID，则无需处理。
n 如果不应该规划为整网中最优ID，则请执行步骤4。
d. 请按照网络拓扑正确配置。查看问题是否消除。如果未消除，则请执行步骤
5。
e. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
l 原因2：修改了原有网络中设备的优先级或域配置。
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看该实例的优先级向量或者域配置
的更改是否是正常操作。如果不是正常操作，则请执行步骤2。
b. 请按照网络拓扑正确配置，查看问题是否消除。如果未消除，则请执行步骤
3。
c. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
文档版本 09 (2017-09-04) 华为专有和保密信息 311
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
36.21 MSTP/4/PROTC_GUARDED
日志信息
MSTP/4/PROTC_GUARDED:MSTP process received TC message exceeded the threshold
will be defered to deal with at the end of TC protection time.(ProcessID=[ProcessID])
日志含义
MSTP进程上收到的超过阈值的TC消息将被延迟到TC保护时间超时后处理。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
可能原因
原因1：MSTP进程单位时间内收到的TC消息超过了TC保护的阈值。
处理步骤
l 原因1：MSTP进程单位时间内收到的TC消息超过了TC保护的阈值。
a. 请检查是否有网络拓扑振荡。
n 如果有网络拓扑振荡，则请执行步骤3。
n 如果没有网络拓扑振荡，则请执行步骤2。
b. 请执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看端口上TC报文计数是否超过设置
的阈值。
n 如果端口上TC报文计数超过设置的阈值，则请执行步骤4。
n 如果端口上TC报文计数没有超过设置的阈值，则请执行步骤7。
c. 请检查网络拓扑振荡的原因并修复。查看问题是否消除。如果未消除，则请
执行步骤2。
d. 在MSTP进程视图下执行命令stp tc-protection threshold threshold，重新设置
MSTP进程处理TC类型BPDU报文的数量。查看问题是否消除。如果未消除，
则请执行步骤5。
e. 请确认是否存在恶意攻击。
n 如果存在恶意攻击，则请执行步骤6。
n 如果不存在恶意攻击，则请执行步骤7。
f. 请找出攻击源并进行排除，查看问题是否消除。如果未消除，则请执行步骤
7。
g. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
文档版本 09 (2017-09-04) 华为专有和保密信息 312
版权所有 © 华为技术有限公司