title:Large-scale DNS data analysis
author:David Dagon
Large-scale DNS Data Analysis
[Extended Abstract]
David Dagon
Georgia Institute of Technology
266 Ferst Drive
Atlanta, GA 30332-0765
PI:EMAIL
ABSTRACT
This paper describes a tutorial on large-scale DNS data analysis.
The tutorial is a pragmatic course on data collection, analysis and
techniques. Designed for academics pursuing DNS security re-
search topics, the tutorial demonstrates and extends numerous tools
and techniques used by security researchers to collect, process and
analyze tera-scale DNS archives.
Categories and Subject Descriptors
C.2 [COMPUTER-COMMUNICATION NETWORKS ]: Net-
work Protocols
General Terms
Experimentation, Measurement, Performance, Security
Keywords
DNS Security, Large-scale data analysis
1.
INTRODUCTION
DNS [18, 19] data is increasingly used in security analysis, in-
trusion detection, and research [9, 24, 5, 24, 3, 21, 22]. Even small
DNS collection systems can generate enormous volumes of DNS
trafﬁc, requiring tera-scale storage. As a result, researchers look-
ing at DNS trafﬁc must often develop real-time, in-line analysis
tools.
This tutorial will offer pragmatic examples, demonstration and
advice on large-scale DNS data in enterprise-level network mea-
surement, security analysis, and threat identiﬁcation. The focus
will be on tool creation and modiﬁcation (e.g., creating re-usable
frameworks for real-time analysis), rather than any individual re-
search topic (e.g., machine learning, measurement, botnet remedi-
ation, etc.)
2. OVERVIEW
Participants are assumed to have strong skills in C and Python
programming, familiarity with large-scale ’NoSQL’ [6] storage sys-
Copyright is held by the author/owner(s).
CCS’12, October 16–18, 2012, Raleigh, North Carolina, USA.
ACM 978-1-4503-1651-4/12/10.
tems, and some familiarity with DNS resolver conﬁguration (e.g.,
BIND [11], Unbound [20]). For portions of the tutorial, partici-
pants will interact with local systems deployed on a LAN, and so
should bring a suitable notebook or system. Depending on exter-
nal network conditions, experiments will be run on existing DNS
information sharing systems such as SIE [13]. To simplify net-
work access and to speed up development exercises, participants
will be given a virtual machine image. The tutorial is designed for
FreeBSD and Debian systems, but participants are free to work in
their own development environment.
Components of this tutorial include:
• Fundamentals. This tutorial presumes some familiarity with
DNS, but will include a brief overview of the Domain Name
System, key RFCs, and existing research-oriented informa-
tion exchanges. Discussion will cover stub-layer DNS prop-
erties (e.g., NRPT [17]), application-based DNS stub behav-
ior (e.g., DNS prefetching [15]), recursive ﬁngerprinting and
cache poisoning, forgery resistance techniques [8, 2], DNSSEC,
and authority-level zone analysis. The summary will cover
both the academic and operational literature, and note cur-
rent open topics in academic research.
• Policy. Consideration will be given to human subjects re-
quirements for academic research, user privacy, and license
agreements for access to individual zones, IANA and RIR
databases, PII in DNS [14], and the like. Discussion will also
focus on RFC 1262 [7] and notiﬁcation/opt-out requirements
for Internet-scale DNS measurement projects.
• Passive DNS. Participants will extend existing tools [16, 12]
that build and utilize passive DNS [23] databases [13, 25].
Simple motivating examples will include building graphs of
malicious domain networks, time series analysis, zone enu-
meration and walking, and ﬂux network [1, 10] detection.
• Authority DNS Analysis. Participants will use and extend
existing DNS analysis tools (pcaputils, dnscap, dnspython,
scapy, and nmsg-based tools [12]) to analyze authority DNS
logs from botnet C&C servers. The exercise will identify
recursive farms, closed recursive networks, conﬁguration er-
rors and security problems [4], as well as the general ’DNS
radiation’ found on the Internet. Participants will also ana-
lyze TLD zones to identify spam networks.
• Large-scale DNS Measurement. Participants will build and
execute a Internet-scale DNS measurement system to iden-
tify recursives, authorities and secondaries, ﬁngerprint re-
solvers, and ﬁnd DNS path options. Using the completed
passive DNS exercise, participants will identify zone cuts,
and map policy hierarchies within networks.
1054library/ee649207%28v=ws.10%29.aspx, October
2009.
[18] P. Mockapetris. Domain names - concepts and facilities.
http://www.ietf.org/rfc/rfc1034.txt,
November 1987.
[19] P. Mockapetris. Domain names - implementation and
speciﬁcation.
http://www.ietf.org/rfc/rfc1035.txt,
November 1987.
[20] NLnet Labs. Unbound. http://unbound.net/, 2012.
[21] L. Poole and V. S. Pai. Leveraging scale and history to
improve DNS security. In 3d USENIX Workshop on Real,
Large Distributed Systems, 2006.
[22] B. Stone-Gross, M. Cova, L. Cavallaro, B. Gilbert,
M. Szydlowski, R. Kemmerer, C. Kruegel, and G. Vigna.
Your botnet is my botnet: analysis of a botnet takeover. In
Proceedings of the 16th ACM Conference on Computer and
Communications Security, CCS ’09, pages 635–647, New
York, NY, USA, 2009. ACM.
[23] F. Weimer. Passive DNS replication.
http://www.enyo.de/fw/software/
dnslogger/first2005-paper.pdf, 2005.
[24] S. Yandav and A. N. Reddy. Winning with DNS failures:
Strategies for faster bontet detection. In 7th International
ICST Conference on Security and Privacy in Communication
Networks (SecureComm), 2011.
[25] B. Zdrnja, N. Brownlee, and D. Wessels. Passive monitoring
of dns anomalies. In Proceedings of the 4th international
conference on Detection of Intrusions and Malware, and
Vulnerability Assessment, DIMVA ’07, pages 129–139,
Berlin, Heidelberg, 2007. Springer-Verlag.
In summary, this is a pragmatic, tools-oriented tutorial. It is de-
signed for researchers interested in working with large-scale DNS
data. While motivating examples focus on DNS abuse, security and
botnets, the tools are of general use for those performing surveys,
measurement, or other tasks involving tera-scale DNS data.
3. REFERENCES
[1] R. P. A, I. C. C, D. D. A, and W. L. A. Detecting malicious
ﬂux service networks through passive analysis of recursive
dns traces.
[2] A. Hubert and R. van Mook. Measures for making dns more
resilient against forged answers.
http://tools.ietf.org/html/rfc5452, January
2009.
[3] M. Antonakakis, R. Perdisci, D. Dagon, W. Lee, and
N. Feamster. Building a dynamic reputation system for dns.
In Proceedings of the 19th USENIX Security Symposium
(USENIX Security ’10), 2010.
[4] M. Antonakakis, R. Perdisci, W. Lee, N. Vasiloglou, and
D. Dagon. Detecting malware domains in the upper DNS
hierarchy. In the Proceedings of 20th USENIX Security
Symposium (USENIX Security ’11), 2011.
[5] L. Bilge, E. Kirda, C. Kruegel, and M. Balduzzi.
EXPOSURE: ﬁnding malicious domains using passive DNS
analysis. In Proceedings of Network and Distributed Security
Symposium (NDSS ’11), 2011.
[6] G. Burd. NoSQL sysadmin. ;Login, 36(5), October 2011.
[7] V. G. Cerf. Guidelines for internet measurement activities.
http://www.ietf.org/rfc/rfc1262.txt,
October 1991.
[8] D. Dagon, M. Antonakakis, P. Vixie, T. Jinmei, and W. Lee.
Increased DNS Forgery Resistance Through 0x20-Bit
Encoding. In Proceedings of the 15th ACM CCS, Alexandria,
VA, 2008.
[9] D. Dagon, N. Provos, C. P. Lee, and W. Lee. Corrupted dns
resolution paths: The rise of a malicious resolution authority.
In Proceedings of Network and Distributed Security
Symposium (NDSS ’08), 2008.
[10] T. Holz, C. Gorecki, F. Freiling, and K. Rieck. Measuring
and detecting fast-ﬂux service networks. In Proceedings of
15th Network and Distributed System Security Conference
(NDSS 2008), 2008-02-11, 2008.
[11] Internet Systems Consortium. BIND.
https://www.isc.org/software/bind, 2012.
[12] Internet Systems Consortium. Rsf software repository.
http://rsfcode.isc.org, 2012.
[13] Internet Systems Consortium. Security information exchange
SIE. https://sie.isc.org/, 2012.
[14] C. L. H. Jonathan M. Spring. The impact of passive dns
collection on end-user privacy. In Securing and Trusting
Internet Names: SATIN 2012, 2012.
[15] S. Krishnan and F. Monrose. Dns prefetching and its privacy
implications: when good things go bad. In Proceedings of
the 3rd USENIX conference on Large-scale exploits and
emergent threats: botnets, spyware, worms, and more,
LEET’10, pages 10–10, Berkeley, CA, USA, 2010. USENIX
Association.
[16] C. Lee. passive-dns-query-tool.
http://code.google.com/p/passive-dns-query-tool/, 2012.
[17] I. Microsoft. Introduction to the NRPT.
http://technet.microsoft.com/en-us/
1055