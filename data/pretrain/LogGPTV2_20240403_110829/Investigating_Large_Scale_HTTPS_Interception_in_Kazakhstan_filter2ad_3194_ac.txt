structed users to install the Kazakhstan root certificate, they claimed
that its purpose was to protect against fraud, hacking, and illegal
IMC ’20, October 27–29, 2020, Virtual Event, USA
Sundara Raman et al.
how many users were affected, but none were able to share their
data.
Informed by our findings, two major browser vendors, Mozilla
Firefox and Google Chrome, responded on August 21, 2019, ship-
ping changes that completely blocked use of the Qaznet root, even
if manually installed [33]. Although this step was taken after the
interception system was shut down, it prevents the system from be-
ing used again without users having to install a different certificate.
We advocate an even quicker response if there are similar incidents
in the future. Because of the prevalence of network security prod-
ucts that require users to install custom certificates, the option to
add trusted certificates is necessary. However, we recommend that
browsers add non-intrusive visual indicators to alert users about
possible security risks each time a custom root is being used.
Additionally, we recommend further research into and higher
adoption of defense mechanisms against large-scale MitM attacks
in the HTTPS ecosystem [28]. We also encourage content providers
to employ techniques to detect and share information regarding
large-scale HTTPS interception attacks from particular countries
or networks. As described in §4.2.4, interception systems may have
unique TLS fingerprints, which would allow content providers
to alert users whose connections are intercepted or take other
protective actions.
Kazakhstan’s interception system has not been active since being
shut down on August 7, 2019, but, having showcased its capabilities,
the government has stated its intention to turn the system on again
“when required.” The international community should prepare for
that possibility—and for the event that another government con-
ducts the same style of attack. Future measurement research can
help by continuously monitoring for large-scale interception events
such as Kazakhstan’s.
6 CONCLUSION
With countries such as China and Russia practicing extensive cen-
sorship and moving closer to a controlled and balkanized Internet,
end-to-end encryption is more important than ever for keeping
users safe. In this paper, we explored Kazakhstan’s government-
sanctioned HTTPS interception attack in detail using direct and
remote measurements. Such attacks threaten the protection offered
by HTTPS and weaken security and privacy for the country’s In-
ternet users. It appears that the Kazakh government is willing to
conduct further interception in the future, and other governments
may adopt similar techniques. We urge the Internet security com-
munity to prepare for such events, by performing closer monitoring
and by instituting policies for how to respond. If such interception
attacks become normalized, decades of progress towards an end-
to-end encrypted web will be lost for many of the Internet’s most
vulnerable users.
7 ACKNOWLEDGMENTS
The authors thank the shepherd Alan Mislove and the anonymous
reviewers for their helpful feedback. We are also grateful to Wayne
Thayer, Dana Keeler, and J.C. Jones from Mozilla for their help and
prompt response in blocking the use of the MitM certificate. This
work was supported in part by the U.S. National Science Foundation
Award CNS-1518888 and a Google Faculty Research Award.
130
Figure 3: Longitudinal counts of TLS hosts (out of 6,736 hosts
measured) exhibiting interception show daily patterns (likely due
to routing changes) and an extended outage, during which the
system was tuned. ⋄
content. However, the set of targets suggests that the actual in-
tention may have been to surveil users’ online interactions and
communications.
Longitudinal Analysis. The results from our longitudinal mea-
4.2.6
surements are shown in Figure 3. Interception was paused the
evening of Friday, July 26, and resumed four days later, on the
morning of July 30, with some changes to the logic for setting cer-
tificate validity periods. This suggests that the system was under
active testing and development. Overall, we saw a median of 340
TLS hosts observing the interception when it was active. We no-
ticed some periodic trends, such as a daily increase from 9 P.M. to
midnight. Further investigation revealed that TLS hosts from four
subnets belonging to mobile providers observed the interception
only during this period, indicating a possible routing change.
5 DISCUSSION
Kazakhstan’s HTTPS interception attacks represent an escalation
in efforts by certain governments to gain access to encrypted com-
munications. Unlike previous state-sponsored interception attacks,
which were limited in scope and sophistication [19, 24], it covered
a wide range of popular sites and lasted several weeks, potentially
allowing the government to capture data and credentials for many
thousands of users.
Significantly, Kazakhstan was able to intercept HTTPS without
compromising a browser-trusted CA, as in some previous inci-
dents [5]. Instead, users were forced to trust the government’s
custom root CA (and allow interception), or access to many of the
targeted sites would be effectively blocked. Because of mislead-
ing communication from ISPs that suggested the certificate was
intended to protect users’ security, many users may have installed
it without knowing its adverse effects. Browser security indicators
would then give them a false sense of security, since the lock icon
would be displayed even when the custom certificate was in use.
We tried contacting some targeted services for information about
Investigating Large Scale HTTPS Interception in Kazakhstan
IMC ’20, October 27–29, 2020, Virtual Event, USA
REFERENCES
[1] J. Aas, R. Barnes, B. Case, Z. Durumeric, P. Eckersley, A. Flores-López, J. A.
Halderman, J. Hoffman-Andrews, J. Kasten, E. Rescorla, S. Schoen, and B. Warren.
Let’s Encrypt: An automated certificate authority to encrypt the entire web. In
ACM Conference on Computer and Communications Security (CCS), 2019.
[2] D. Adrian, K. Bhargavan, Z. Durumeric, P. Gaudry, M. Green, J. A. Halderman,
N. Heninger, D. Springall, E. Thomé, L. Valenta, B. VanderSloot, E. Wustrow,
S. Zanella-Béguelin, and P. Zimmermann. Imperfect forward secrecy: How Diffie-
Hellman fails in practice. In ACM Conference on Computer and Communications
Security (CCS), 2015.
[3] K. Afifi-Sabet. Kazakh government will intercept the nation’s HTTPS traffic.
ITPro, July 19, 2019. https://www.itpro.co.uk/network-internet/34051/kazakh-
government-will-intercept-the-nation-s-https-traffic.
[4] Alexa. Top 1,000,000 sites, July 2019. http://s3.amazonaws.com/alexa-static/
top-1m.csv.zip.
[5] S. Bhat. Gmail users in Iran hit by MITM attacks. Techie Buzz, August 30, 2011.
http://techie-buzz.com/tech-news/gmail-iran-hit-mitm.html.
[6] D. Bleichenbacher. Forging some RSA signatures with pencil and paper. Presen-
tation in the rump session, CRYPTO, 2006.
[7] bne IntelliNews. Kazakhstan blocks Tumblr for promoting terrorism, porn,
April 12, 2016. https://www.intellinews.com/kazakhstan-blocks-tumblr-for-
promoting-terrorism-porn-94928/.
[8] Bugzilla. MITM on all HTTPS traffic in Kazakhstan, 2019. https://bugzilla.mozilla.
org/show_bug.cgi?id=1567114.
[9] F. Callegati, W. Cerroni, and M. Ramilli. Man-in-the-middle attack to the HTTPS
protocol. IEEE Security & Privacy, 2009.
[10] Z. Chai, A. Ghafari, and A. Houmansadr. On the importance of encrypted-SNI
In USENIX Workshop on Free and Open
(ESNI) to censorship circumvention.
Communications on the Internet (FOCI), 2019.
[11] C. Cimpanu. Kazakhstan government is now intercepting all HTTPS traffic.
ZDNet, July 18, 2019. https://www.zdnet.com/article/kazakhstan-government-
is-now-intercepting-all-https-traffic/.
[12] Citizen Lab. Block test list. https://github.com/citizenlab/test-lists.
[13] J. R. Crandall, M. Crete-Nishihata, and J. Knockel. Forgive us our SYNs: Technical
and ethical considerations for measuring internet filtering. In ACM SIGCOMM
Workshop on Ethics in Networked Systems Research, 2015.
[14] I. Dacosta, M. Ahamad, and P. Traynor. Trust no one else: Detecting MITM attacks
against SSL/TLS without third-parties. In European Symposium on Research in
Computer Security. Springer, 2012.
[15] D. Dittrich, E. Kenneally, et al. The Menlo Report: Ethical principles guiding
information and communication technology research. Technical report, U.S.
Department of Homeland Security, 2012.
[16] Z. Durumeric, D. Adrian, A. Mirian, M. Bailey, and J. A. Halderman. Censys: A
search engine backed by Internet-wide scanning. In ACM Conference on Computer
and Communications Security (CCS), 2015.
[17] Z. Durumeric, Z. Ma, D. Springall, R. Barnes, N. Sullivan, E. Bursztein, M. Bailey,
J. A. Halderman, and V. Paxson. The security impact of HTTPS interception. In
Network and Distributed Systems Symposium (NDSS), 2017.
[18] Z. Durumeric, E. Wustrow, and J. A. Halderman. ZMap: Fast internet-wide
scanning and its security applications. In USENIX Security Symposium, 2013.
[19] P. Eckersley. A Syrian man-in-the-middle attack against Facebook. EFF Deeplinks
Blog, May 5, 2011. https://www.eff.org/deeplinks/2011/05/syrian-man-middle-
against-facebook.
[20] Freedom House. Freedom on the net report, 2019. https://freedomhouse.org/
countries/freedom-world/scores.
[21] S. Frolov and E. Wustrow. The use of TLS in censorship circumvention.
In
Network and Distributed Systems Symposium (NDSS), 2019.
[22] S. Gatlan. South Korea is censoring the Internet by snooping on SNI traffic. Bleep-
ing Computer, February 13, 2019. https://www.bleepingcomputer.com/news/
security/south-korea-is-censoring-the-internet-by-snooping-on-sni-traffic/.
[23] Google. Transparency report: HTTPS encryption on the web, 2020. https://
transparencyreport.google.com/https/overview.
[24] M. Johnson. China, GitHub and the man-in-the-middle. GreatFire.org, January
30, 2013. https://en.greatfire.org/blog/2013/jan/china-github-and-man-middle.
[25] B. Jones, R. Ensafi, N. Feamster, V. Paxson, and N. Weaver. Ethical concerns for
censorship measurement. In NS Ethics ’15: Proceedings of the 2015 ACM SIGCOMM
Workshop on Ethics in Networked Systems Research, 2015.
[26] J. Kasten, E. Wustrow, and J. A. Halderman. Cage: Taming certificate authorities
by inferring restricted scopes. In Intl. Conference on Financial Cryptography and
Data Security (FC), 2013.
[27] Kazakhtelecom JSC. Kazakhtelecom JSC notifies on introduction of national
security certificate from 1 January 2016, 2015. Archived at https://web.archive.org/
web/20151202203337/http://telecom.kz/en/news/view/18729.
[28] B. Laurie, A. Langley, and E. Kasper. Certificate transparency. ACM Queue, 2014.
[29] H. Lee, Z. Smith, J. Lim, G. Choi, S. Chun, T. Chung, and T. T. Kwon. maTLS:
How to make TLS middlebox-aware? In 26th Network and Distributed Systems
[30] M. Marlinspike. Convergence, 2011. Archived at https://web.archive.org/web/
Symposium (NDSS), 2019.
20160803195327/http://convergence.io/.
[31] MaxMind. https://www.maxmind.com/.
[32] Mozilla. Phasing out certificates with 1024-bit RSA keys. The Mozilla Blog,
September 08, 2014. https://blog.mozilla.org/security/2014/09/08/phasing-out-
certificates-with-1024-bit-rsa-keys/.
[33] Mozilla. Mozilla takes action to protect users in Kazakhstan. The Mozilla Blog,
August 21, 2019. https://blog.mozilla.org/blog/2019/08/21/mozilla-takes-action-
to-protect-users-in-kazakhstan/.
[34] Mozilla. HTTP Public Key Pinning (HPKP), 2020. https://developer.mozilla.org/
en-US/docs/Web/HTTP/Public_Key_Pinning.
[35] Multiple authors. Nation state MITM CAs? (thread). mozilla.dev.security.policy
mailing list, 2016. https://groups.google.com/forum/#!msg/mozilla.dev.security.
policy/wnuKAhACo3E/cpsvHgcuDwAJ.
[36] A. Narayanan and B. Zevenbergen. No encore for Encore? Ethical questions for
web-based censorship measurement, 2015. Available at SSRN: https://ssrn.com/
abstract=2665148 or http://dx.doi.org/10.2139/ssrn.2665148.
[37] National Commission for the Protection of Human Subjects of Biomedical and
Behavioral Research. The Belmont Report: Ethical principles and guidelines for
the protection of human subjects of research, 1978.
[38] National Security Committee of the Republic of Kazakhstan. В отношении
сертификата безопасности, 2019. http://knb.gov.kz/ru/news/v-otnoshenii-
sertifikata-bezopasnosti.
[39] S. Nichols.
Is Kazakhstan about to man-in-the-middle diddle all of its
Internet traffic with dodgy root certs?
The Register, December 3, 2015.
https://www.theregister.co.uk/2015/12/03/kazakhstan_to_maninthemiddle_all_
internet_traffic/.
[40] M. O’Neill, S. Ruoti, K. Seamons, and D. Zappala. TLS proxies: Friend or foe? In
ACM Internet Measurement Conference (IMC), 2016.
[41] OpenNet Initiative. Country profile: Kazakhstan, 2010. https://opennet.net/
research/profiles/kazakhstan.
[42] C. Partridge and M. Allman. Addressing ethical considerations in network
measurement papers. In NS Ethics ’15: Proceedings of the 2015 ACM SIGCOMM
Workshop on Ethics in Networked Systems Research, 2015.
[43] P. Pearce, B. Jones, F. Li, R. Ensafi, N. Feamster, N. Weaver, and V. Paxson. Global
measurement of DNS censorship. In USENIX Security Symposium, 2017.
[44] R. Ramesh, R. Sundara Raman, M. Bernhard, V. Ongkowijaya, L. Evdokimov,
A. Edmundson, S. Sprecher, M. Ikram, and R. Ensafi. Decentralized control: A
case study of russia. In Network and Distributed Systems Security Symposium
(NDSS), 2020.
[45] N. Shapovalova. Security certificate of the Republic of Kazakhstan: the state
will be able to control the encrypted Internet traffic of users. Dentons, Dec.
2015. https://www.dentons.com/en/insights/alerts/2015/december/30/security-
certificate-of-the-republic-of-kazakhstan.
[46] J. Sherry, C. Lan, R. A. Popa, and S. Ratnasamy. Blindbox: Deep packet inspection
over encrypted traffic. In ACM SIGCOMM, 2015.
[47] C. Soghoian and S. Stamm. Certified lies: Detecting and defeating government
interception attacks against SSL. In 21st ACM Symposium on Operating Systems
Principles (SOSP), 2010.
[48] R. Sundara Raman, L. Evdokimov, E. Wustrow, A. Halderman, and R. Ensafi.
Kazakhstan’s HTTPS Interception, 2019. https://censoredplanet.org/kazakhstan.
[49] R. Sundara Raman, P. Shenoy, K. Kohls, and R. Ensafi. Censored Planet: An
Internet-wide, Longitudinal Censorship Observatory. In ACM Conference on
Computer and Communications Security (CCS), 2020.
[50] R. Sundara Raman, A. Stoll, J. Dalek, A. Sarabi, R. Ramesh, W. Scott, and R. Ensafi.
In
Measuring the deployment of network censorship filters at global scale.
Network and Distributed System Security Symposium (NDSS), 2020.
[51] TLSFingerprint.io. The Kazakhstan interception system’s TLS fingerprint
(f09427b5aaf9304b), 2019. https://tlsfingerprint.io/id/f09427b5aaf9304b.
[52] B. VanderSloot, A. McDonald, W. Scott, J. A. Halderman, and R. Ensafi. Quack:
Scalable remote measurement of application-layer censorship. In USENIX Security
Symposium, 2018.
[53] L. Waked, M. Mannan, and A. Youssef. The sorry state of TLS security in enter-
prise interception appliances. Digit. Threat. Res. Pract., 1(1), 2019.
[54] D. Warburton. Kazakhstan attempts to MITM its citizens. F5 Labs Blog, August 1,
2019. https://www.f5.com/labs/articles/threat-intelligence/kazakhstan-attempts-
to-mitm-itscitizens.
[55] D. Wendlandt, D. G. Andersen, and A. Perrig. Perspectives: Improving SSH-
style host authentication with multi-path probing. In USENIX Annual Technical
Conference (ATC), 2008.
[56] B. Zevenbergen et al. NS Ethics ’15: Proceedings of the 2015 ACM SIGCOMM
Workshop on Ethics in Networked Systems Research. ACM, 2015.
[57] B. Zevenbergen, B. Mittelstadt, C. Véliz, C. Detweiler, C. Cath, J. Savulescu,
and M. Whittaker. Philosophy meets Internet engineering: Ethics in networked
systems research. GTC Workshop Outcomes Paper, 2015. https://papers.ssrn.com/
sol3/papers.cfm?abstract_id=2666934.
131
IMC ’20, October 27–29, 2020, Virtual Event, USA
Sundara Raman et al.
Figure 4: The certificate chain of Kazakhstan’s custom root. ⋄
A APPENDIX
Certificate Chain. Figure 4 shows the parsed certificate chain
from our measurements. The root certificate (top left) with subject
Qaznet Trust Network has a validity period of 30 years. The
intermediate Security Certificate (bottom left) has a three year
validity period and the leaf certificate (right) has the same validity
period as the original certificate (but shifted by six hours).
132