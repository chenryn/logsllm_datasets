(cid:35)
(cid:32)
(cid:71)(cid:35)
(cid:32)
(cid:32)
(cid:71)(cid:35)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:71)(cid:35)
(cid:71)(cid:35)
WIDS
7.2 Trade-off Between Security and
Deployment
Changing any standardized protocol generally involves high cost
(propagating changes throughout the mobile communication ecosys-
tem and inducing all users to update each device on the network).
As we mentioned in Sections 6.1.1 and 6.2.1, to protect IMSI pri-
vacy attack and DoS attacks, carriers may introduce a public key
digital signature mechanism and physically install WIDS in the
area, shielding UEs from malicious attacks. However, it is always
necessary for MNOs to weigh budget and costs against the need to
achieve maximum security objectives.
Table 4 summarizes the trade-offs for security, usability, effi-
ciency, and cost for each countermeasure. We evaluate each coun-
termeasure using the criteria mentioned in Sections 7.1 and 7.2.
Each countermeasure is evaluated as either the best to the criteria
(denoted as(cid:32)), may the medium to the criteria (denoted as(cid:71)(cid:35)), or
the worst to the criteria (denoted as(cid:35)). The deployment of "Pub-
lic Key Infrastructure" and "WIDS" leads to more complexity and
the high-cost burden in the MNOs network. Especially in case of
public key infrastructure, the additional processing and increased
messages can impact the latency of the connections. Regrading
usability, "Auto connection disabling" and "Hand-off policy" mod-
ification enables to cause the interruption in seamless service of
Wi-Fi Calling. As a result, we recommend that "Shard secret" de-
scribed in Section 6.1.1 is the best countermeasure to address the
vulnerabilities by considering trade-offs.
In summary, as shown in Table 5, we summarized all attacks
and vulnerabilities we discovered in the Wi-Fi Calling that lead
to security threats that violate the security properties of mobile
subscribers. We also classified each vulnerability by its type of
reason and arranged the countermeasures with the trade-offs to
consider.
8 RELATED WORK
Regarding mobile network’s security issues, users’ privacy and
availability problems of mobile networks have been researched.
Shaik et al. [29] discovered an LTE device could leak its location us-
ing cell-tower signal strength information, which can be requested
by a base station without authentication. They also designed attacks
to deny LTE services to a target device by preventing its access
to LTE networks and limiting the connection to 2G/3G networks
using commercial devices. Kune et al. [21] demonstrated possible
location test attacks that include circumventing the temporary iden-
tifier designed to protect the identity of the end user. Arapinis et
al. [8] discovered the vulnerabilities to trace and identify mobile
telephony subscribers in 3G telephony systems using formal meth-
ods. Mjolsnes et al. [23] introduced a simple way to catch IMSI
and perform DoS attack using a rogue base station. In summary,
most research has focused on privacy and DoS attacks by insecure
implementations of the network component or signaling denial-
of-service attacks. Also note that those works are only concerned
with mobile networks, not Wi-Fi Calling.
With respect to Wi-Fi Calling, the first vulnerabilities introduced
by Beekman et al. [9] in 2013. They discovered several vulnerabil-
ities regarding TLS certificate validation against T-Mobile; these
vulnerabilities allow eavesdropping on voice communications and
modification of text by MitM attacks. To discover the vulnerabilities
they leveraged the open source code of Android IMS (IP Multimedia
Subsystem) stack provided by T-Mobile for developers to access
various IMS-services, such as sessions and messaging [32]. How-
ever, the current edition of the WiFi-Calling specification no longer
utilizes that mechanism, and it is virtually impossible to analyze
server-side IMS stack source code (which is no longer open source).
Therefore, we cannot directly adopt this approach to analyze in the
same way.
There are two research articles regarding vulnerabilities in the
current Wi-Fi Calling specification. O’Hanlon et al. [24] showed
that a malicious user could obtain a user’s IMSI and track over
Wi-Fi due to the lack of sufficient privacy protection measures
by pre-configured device profiles. Although they mentioned they
could acquire an IMSI through the Wi-Fi Calling’s IKE handshaking
process, they did not provide any specific methods and results. In
contrast, our study demonstrates in detail the procedure of attacks
and countermeasures not only on IMSI privacy issues but also on
DoS attack issues in the Wi-Fi Calling services.
Chalakkal el al. [10] described that sniffing VoLTE (voice over
LTE) and Wi-Fi Calling interfaces can obtain the IMSI and pri-
vate IPs of IMS by extracting IPSec keys from IP Multimedia Ser-
vices Identity Module [2]. They also introduced injection attacks
in Session Initiation Protocol (SIP) headers that enable location
manipulation and side channel attacks. They obtained the keys
by directly sniffing the mobile phone’s network interface using
SIMtrack [25]. Accordingly, this approach forces the attackers to
tap the device physically, so that it is not feasible to be executed in
the real environment. Differentiating from these work, our work
focuses on analyzing network packets in transit and extracting the
key material using a fake IPSec server.
9 CONCLUSION
In Wi-Fi Calling, the weak requirements in the standard specifi-
cation regarding certifications allows the lack of mutual authen-
tication during the handshake phases of the security association.
By exploiting the vulnerabilities, we can set up a rogue AP that
emulates a legitimate server and obtain target UE’s IMSI and APN
successfully. Those information can be abused to track user loca-
tions by malicious stakeholders. We also demonstrated the feasi-
bility of DoS attacks for Wi-Fi Calling by spoofing the packets
286ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
J. Baek et al.
Table 5: Wi-Fi Calling Attacks, Vulnerability and Countermeasures.
Attack
Security Property
Privacy
IMSI privacy
Confidentiality, Integrity
Type
Incomplete specification
Security architecture
ePDG discovery Availability, Confidentiality
Specification flaw
DoS
IKE_SA_INIT
Availability, Integrity
Specification flaw
Deauthentication
Availability
Specification flaw
Vulnerability
Countermeasure
Public key,
Shared secret,
Hand-offs policy
Shared secret,
WIDS
Public key,
WIDS
WIDS
Trade-offs
Security vs. Deployment
Security vs. Usability
Security vs. Deployment
Security vs. Deployment
Security vs. Deployment,
Security vs. Usability
exchanged in Wi-Fi Calling and modifying the payload. Some of
the payloads are considered as critical parts of services, such as
an address of the ePDG server and cipher suites. Notably, the call
could be dropped suddenly without any alerts even if the UE has
the voice call continuity function for seamless hand-offs.
To protect user privacy and availability against these attacks, we
present practical countermeasures with the trade-off among secu-
rity, deployment, and usability. As a result, the subsequent changes
based on our works can be introduced in future specifications to
reinforce the security. Regarding practicality, our attacks can be
implemented and executed through readily available hardware at
low cost.
ACKNOWLEDGMENT
Many thanks to the anonymous referees for their valuable and
helpful comments. We would also like to give special thanks to
Gerard Pinto who inspired us to make this work successful.
This material is based upon work supported in part by Sam-
sung Research, Samsung Electronics, the Center for Cybersecurity
and Digital Forensics at Arizona State University, the National Sci-
ence Foundation (NSF 1651661), the Defense Advanced Research
Projects Agency (DARPA HR001118C0060), and the Global Research
Laboratory Program through the National Research Foundation
of Korea funded by the Ministry of Science and ICT under Grant
NRF-2014K1A1A2043029.
Any opinions, findings, conclusions or recommendations ex-
pressed in this material are those of the author(s) and do not neces-
sarily reflect the views of United States Government or any agency
thereof.
REFERENCES
[1] 3GPP. 2002. 3G Security; Wireless Local Area Network (WLAN) Interworking
Security. TS33.234 (2002). Latest release: 14.0.0 (2017-03-27). [Online]. Available:
http://www.3gpp.org/DynaReport/33234.htm.
[2] 3GPP. 2002. Characteristics of the IP Multimedia Services Identity Module
(ISIM) application. TS31.103 (2002). Latest release: 15.2.0 (2018-04-03). [Online].
Available: http://www.3gpp.org/DynaReport/311034.htm.
[3] 3GPP. 2015. 3GPP. Network Architecture ; Specification 3GPP TS 23.002 version
12.7.0 Release 12. TS33.002 (2015). Latest release: 15.0.0 (2018-03-27). [Online].
Available: http://www.3gpp.org/DynaReport/23002.htm.
[4] 3GPP. 2015. 3GPP System Architecture Evolution (SAE); Security architec-
ture. TS33.401 (2015). Latest release: 15.3.0 (2018-03-27). [Online]. Available:
http://www.3gpp.org/DynaReport/33401.htm.
[5] 3GPP. 2015. Access to the 3GPP Evolved Packet Core (EPC) via non-3GPP access
networks; Stage 3. TS24.302 (2015). Latest release: 15.1.0 (2017-12-28). [Online].
Available: http://www.3gpp.org/DynaReport/24302.htm.
[6] 3GPP. 2015. Characteristics of the Universal Subscriber Identity Module (USIM)
application. TS31.102 (2015). Latest release: 15.0.0 (2018-04-03). [Online]. Avail-
able: http://www.3gpp.org/DynaReport/31102.htm.
[7] 3GPP. 2015.
P Multimedia Subsystem (IMS) Service Continuity; Stage 2.
Latest release: 15.1.0 (2017-12-22). [Online]. Available:
TS23.237 (2015).
http://www.3gpp.org/DynaReport/23237.htm.
[8] Myrto Arapinis, Loretta Mancini, Eike Ritter, Mark Ryan, Nico Golde, Kevin Re-
don, and Ravishankar Borgaonkar. 2012. New privacy issues in mobile telephony:
fix and verification. In Proceedings of the 19th ACM Conference on Computer and
Communications Security (CCS). ACM, 205–216.
[9] Jethro Beekman and Christopher Thompson. 2013. Man-in-the-middle attack on
T-Mobile Wi-Fi Calling. Electrical Engineering and Computer Sciences University
of California at Berkeley, http://www. eecs. berkeley. edu/Pubs/TechRpts/2013/EECS-
2013-18.html (2013).
[10] Sreepriya Chalakkal, H Schmidt, and S Park. 2017. Practical Attacks on VoLTE
and VoWIFI. ERNW Enno Rey Netzwerke, Tech. Rep (2017).
[11] CNET. 2017. Everything you need to know about Wi-Fi Calling. https://www.
cnet.com/news/what-you-need-to-know-about-Wi-FiCalling/ [Online; accessed
13-September-2018].
[12] The Economist. 2016. The StingRay’s tale.
https://www.economist.com/
united-states/2016/01/30/the-stingrays-tale [Online; accessed 13-September-
2018].
[13] Caroline Gabriel. 2016. Wi-Fi Calling and the ePDG: The continuing importance
of voice in the carrier model. Rethink Technology Research (January 2016).
[14] HLR Lookup, Enterprise HLR Lookup Portal and API. 2018.
hlr-lookups.com/ [Online; accessed 13-September-2018].
[15] Syed Rafiul Hussain, Omar Chowdhury, Shagufta Mehnaz, and Elisa Bertino.
2018. LTEInspector: A Systematic Approach for Adversarial Testing of 4G LTE.
Network and Distributed Systems Security (NDSS) Symposium (2018).
[16] Hotspot ID. 2018. https://www.hotspotid.com/ [Online; accessed 13-September-
https://www.
2018].
[17] COX Inc. 2018. https://www.cox.com/aboutus/wifi-hotspot-map.html [Online;
accessed 13-September-2018].
[18] Internet Engineering Task Force (IETF). 2014. Internet Key Exchange Protocol
Version 2 (IKEv2). RFC7296 (October 2014). [Online; accessed 13-September-2018].
Available: https://tools.ietf.org/html/rfc7296.
[19] Roger Piqueras Jover. 2013. Security attacks against the availability of LTE mobil-
ity networks: Overview and research directions. In Wireless Personal Multimedia
287Wi Not Calling: Practical Privacy and Availability Attacks in Wi-Fi Calling
ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
Communications (WPMC), 2013 16th International Symposium on. IEEE, 1–9.
[20] Roger Piqueras Jover. 2016. LTE security, protocol exploits and location tracking
experimentation with low-cost software radio. arXiv preprint arXiv:1607.05171
(2016).
[21] Denis Foo Kune, John Koelndorfer, Nicholas Hopper, and Yongdae Kim. 2012.
Location leaks on the GSM air interface. ISOC NDSS (Feb 2012) (2012).
[22] Market Insights Reports. 2017. The VoLTE Ecosystem: 2016-2030 Opportunities,
Challenges, Strategies Forecasts. (2017). Latest release: 15.1.0 (2017-12-28). [On-
line]. Available: https://www.marketinsightsreports.com/reports/091915323/the-
volte-voice-over-lte-ecosystem-2016-2030-opportunities-challenges-strategies-
forecasts/.
[23] Stig F Mjølsnes and Ruxandra F Olimid. 2017. Easy 4G/LTE IMSI Catchers for
Non-Programmers. In International Conference on Mathematical Methods, Models,
and Architectures for Computer Network Security. Springer, 235–246.
[24] O’Hanlon, Piers and Borgaonkar, Ravishankar and Hirschi, Lucca. 2017. Mobile
subscriber WiFi privacy. In IEEE Security and Privacy Workshops (SPW).
[25] OSMOCOM. 2018. Osmocom SIMtrack. https://osmocom.org/projects/simtrack/
wiki/SIMtrack/ [Online; accessed 13-September-2018].
[26] PiunikaWeb. 2018. iOS 11.3 nasty surprise. http://piunikaweb.com/2018/04/03/
ios-11-3-nasty-surprise-t-mobile-prioritises-cellular-over-wifi-calling/ [Online;
accessed 13-September-2018].
[27] Rethink Technology Research. 2016. - Mobile network ownership, MVNOs and
NWaaS Wholesale, sharing and NWaaS 2015-2020. (2016).
[28] SECDEV. 2018. Scapy. https://scapy.net/ [Online; accessed 13-September-2018].
[29] Altaf Shaik, Ravishankar Borgaonkar, N Asokan, Valtteri Niemi, and Jean-Pierre
Seifert. 2015. Practical attacks against privacy and availability in 4G/LTE mobile
communication systems. arXiv preprint arXiv:1510.07563 (2015).
[30] Altaf Shaik, Ravishankar Borgaonkar, Jean-Pierre Seifert, N. Asokan, and Valtteri
Niemi. 2016. Practical Attacks Against Privacy and Availability in 4G/LTE. In
Proceedings of the 23rd Annual Network and Distributed System Security Symposium
(NDSS). http://www.internetsociety.org/events/ndss-symposium-2016
[31] Daehyun Strobel. 2007. IMSI catcher. Chair for Communication Security, Ruhr-
Universität Bochum 14 (2007).
[32] T-Mobile and Movial. 2016. The IMS Open Source Project For Android. https:
//www.openhub.net/p/ims-android [Online; accessed 13-September-2018].
[33] Fabian van den Broek, Roel Verdult, and Joeri de Ruiter. 2015. Defeating IMSI
catchers. In Proceedings of the 22nd ACM Conference on Computer and Communi-
cations Security (CCS). ACM, 340–351.
[34] VREM. 2018. VREM Software Development. https://vremsoftwaredevelopment.
github.io/WiFiAnalyzer/ [Online; accessed 13-September-2018].
288