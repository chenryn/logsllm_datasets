### Time Analysis and Performance Improvement

Time is a critical factor in content delivery. Figure 20 illustrates the cumulative distribution function (CDF) of content download times for high and low expectation countries before and after the rollout. The data shows significant improvements across all percentiles. For example, the 75th percentile of the download time decreased from 272 ms to 157 ms for the high expectation group and from 192 ms to 102 ms for the low expectation group.

### Why Download Performance Matters

From our results, it is evident that end-user mapping provides substantial performance benefits to clients using public resolvers, particularly in countries with high client-LDNS distances. Faster download times, such as those achieved through end-user mapping, are crucial for enhancing the Internet experience. This includes web pages that load more quickly and videos that start playing sooner. Improved download performance not only enhances the user experience but also positively impacts the business of content providers. Satisfied users can lead to increased revenue and conversion rates, creating a "virtuous cycle" [25].

For instance, a study by Walmart Labs [12] found that a 100 ms decrease in web page download time can result in a 1% increase in revenue, and a 1-second decrease can lead to up to a 2% increase in conversion rates. Other studies have shown that even a few hundred milliseconds of additional page load time can reduce revenues, page views, and searches per user [9]. In the industry, it is widely accepted that a website that is 250 ms faster than its competitors has a significant business advantage [18]. Additionally, search engines rank faster websites higher, and users often associate faster sites with better brand reputation. Therefore, the "need for speed" is a primary focus for content providers and CDNs, and even small reductions in download times are considered valuable.

### Additional Benefits of End-User Mapping

Besides faster download times, end-user mapping reduces the distance and round-trip time (RTT) between clients and servers. This often means that the client-server path crosses fewer AS boundaries, peering points, and transnational cable links, reducing the likelihood of congestion and failure. Consequently, end-user mapping can result in more stable and reliable client-server paths.

### The Benefits of EDNS0 Adoption

To extend end-user mapping to a broader set of clients, ISPs need to adopt the EDNS0 extension for their DNS services. Our results highlight the performance benefits of such adoption and provide a strong incentive for it. For example, excluding public resolvers, 6.2% of client demand originates from clients whose LDNSes are at least 1000 miles away. Based on our findings, these clients could see a 50% reduction in RTT and content download time. Similarly, 5.3% of client demand comes from clients with LDNSes between 500 to 1000 miles, and they could experience a 24% decrease in RTTs and content download times. Although 54% of the remaining client demand will not benefit from end-user mapping due to local LDNSes, the fact that 11.5% of the remaining demand will see significant performance improvements is a compelling reason for EDNS0 adoption.

### Scaling Challenges

End-user mapping is challenging because it makes decisions at a finer granularity than traditional NS-based mapping. There are orders of magnitude more clients than name servers on the global Internet. An end-user mapping system must perform more fine-grained network measurements and provide resolutions at a finer scale, leading to scaling considerations.

#### Tradeoffs in Choosing Mapping Units

A mapping unit is the finest-grain set of client IPs for which server assignment decisions are made. Traditional NS-based mapping systems use an LDNS as the mapping unit, where all clients in a cluster using the same LDNS are mapped together. An end-user mapping system could use /x client IP blocks, where x â‰¥ 24. A natural first choice is /24 client IP blocks, as LDNSes that support the EDNS0 extension currently use /24 IP blocks in their queries.

To understand the scaling issues, we compared the number of relevant /24 client IP blocks to the number of relevant LDNSes using NetSession data. We computed the demand generated by each /24 client IP block and each LDNS. Sorting the /24 client IP blocks and LDNSes by demand, we plotted a CDF of the demand (Figure 21). The total number of /24 client IP blocks with non-zero demand is 3.76 million, while 584,000 LDNSes have non-zero demand. To cover 95% of the total client demand, an NS-based mapping system needs to measure and analyze the top 25,000 LDNSes, whereas an end-user mapping system must measure and analyze the top 2.2 million /24 client IP blocks. To cover 50% of the total client demand, the top 1,800 LDNSes suffice, while nearly 430,000 /24 client IP blocks are needed.

### Heuristic Approach to Reducing the Number of Mapping Units

One heuristic approach to reducing the number of mapping units is to use larger IP blocks. Figure 21 shows the number of /24 client IP blocks or LDNSes that produce a given percentage of total global demand. By using larger IP blocks, the number of mapping units can be reduced, but this may come at the cost of coarser resolution and potentially less optimal mappings.

This comprehensive analysis highlights the importance of end-user mapping and the challenges and benefits associated with its implementation.