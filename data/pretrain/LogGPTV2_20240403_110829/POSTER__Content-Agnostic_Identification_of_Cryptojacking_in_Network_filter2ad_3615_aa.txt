title:POSTER: Content-Agnostic Identification of Cryptojacking in Network
Traffic
author:Yebo Feng and
Devkishen Sisodia and
Jun Li
POSTER: Content-Agnostic Identification of Cryptojacking in
Network Traffic
Yebo Feng
University of Oregon
PI:EMAIL
Devkishen Sisodia
University of Oregon
PI:EMAIL
Jun Li
University of Oregon
PI:EMAIL
ABSTRACT
In this paper, we propose a method that detects cryptojacking ac-
tivities by analyzing content-agnostic network traffic flows. Our
method first distinguishes crypto-mining activities by profiling the
traffic with fast Fourier transform at each time window. It then
generates the variation vectors between adjacent time windows
and leverages a recurrent neural network to identify the cryptojack-
ing patterns. Compared with the existing approaches, this method
is privacy-preserving and can identify both browser-based and
malware-based cryptojacking activities. Additionally, this method
is easy to deploy. It can monitor all the devices within a network
by accessing packet headers from the gateway router.
CCS CONCEPTS
• Networks → Network monitoring; • Security and privacy
→ Intrusion/anomaly detection and malware mitigation.
KEYWORDS
cryptojacking, anomaly detection, network traffic classification
ACM Reference Format:
Yebo Feng, Devkishen Sisodia, and Jun Li. 2020. POSTER: Content-Agnostic
Identification of Cryptojacking in Network Traffic. In Proceedings of the 15th
ACM Asia Conference on Computer and Communications Security (ASIA CCS
’20), October 5–9, 2020, Taipei, Taiwan. ACM, New York, NY, USA, 3 pages.
https://doi.org/10.1145/3320269.3405440
1 INTRODUCTION
Cryptocurrencies have become popular, in large part due to their
tremendous value gains and innovative concepts. One such concept
is cryptocurrency mining (crypto-mining), which not only provides
a means to verify cryptocurrency transactions and generate new
cryptocurrency, but more importantly, helps establish consensus,
which is critical in any blockchain-based system. In fact, with com-
puting resources and electricity, plus an Internet connection, people
can easily transform their computers, or any Internet-connected
devices, into cryptocurrency-making machines by having them
conduct cryptocurrency mining.
Unfortunately, the lucrative potential of crypto-mining has caught
the attention of hackers. Hackers have been compromising personal
computers, servers, or even Internet-of-Things (IoT) devices, such
as smart TVs, to mine cryptocurrencies (e.g., Bitcoin, Monero) [9].
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the owner/author(s).
ASIA CCS ’20, October 5–9, 2020, Taipei, Taiwan
© 2020 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-6750-9/20/10.
https://doi.org/10.1145/3320269.3405440
Such activity is called cryptojacking, which is the unauthorized
use of someone else’s computing resources to mine cryptocurrency.
Hackers usually conduct cryptojacking by getting the victim to click
on a malicious link in an email that downloads crypto-mining code
onto their computer, infecting a website with JavaScript code that
automatically runs itself once downloaded into a victim’s browser,
or compromising the servers to stealthily run the mining programs
in the background. Although Coinhive, an in-browser mining ser-
vice provider, shutdown on March 2019, cryptojacking is still alive
and evolving [8]. Recently, The Next Web reported that unsuspect-
ing victims were cryptojacked 52.7 million times in the first half of
2019 [5]. CoinDesk also asserted that hackers infected 50,000 servers
with sophisticated crypto-mining malware [1], causing enormous
economic loss to the virtual server providers.
To detect those malicious activities and protect users’ comput-
ing resources, researchers have proposed various cryptojacking
detection approaches. Hong et al. proposed CMTracker [4], a cryp-
tojacking detection tool that monitors the browser behaviors and
discovers cryptojacking scripts based on hash-based and stack-
based profiling. Tahir et al. proposed a machine learning solution
based on hardware-assisted profiling of browser code to detect cryp-
tojacking [7]. Darabian et al. studied the potential of using deep
learning techniques to detect crypto-mining malware by utilizing
both static and dynamic analysis approaches [2]. However, all these
approaches require access to the end-users’ private data such as
browser behaviors, system metrics, or binary code of the software.
Additionally, they cannot tackle malware obfuscations.
In this paper, we seek to detect the traffic generated by cryp-
tojacking software in a network by analyzing only the network
traffic flows. The traffic flow is metadata of network operations
and contains no content information from the sender. Recently, de-
tecting application-layer anomalies with network traffic flows has
become a trend [3], because such approaches are content-agnostic,
which can protect user privacy while simultaneously detecting
potential malicious activities in a network. With this feature, our
approach is privacy preserving compared with the aforementioned
cryptojacking detection solutions. Moreover, our approach is easy
to deploy and use because users can install the detection system
at their network’s gateway, such as the border router of a network
or a main networking switch, to monitor all the devices in their
network.
To achieve the goal, we propose a two-phase detection procedure,
which identifies crypto-mining traffic first, then detects cryptojack-
ing activities. In the first phase, our approach captures the packet
headers and converts them to a representation in the frequency
domain with fast Fourier transform. We preset the profiles of crypto-
mining traffic in the frequency domain and select the incoming
traffic that matches these profiles as crypto-mining traffic. In the
Poster Session ASIA CCS '20, October 5–9, 2020, Taipei, Taiwan907ASIA CCS ’20, October 5–9, 2020, Taipei, Taiwan
Yebo Feng, Devkishen Sisodia, and Jun Li
Figure 1: Operational model of the proposed approach.
second phase, our approach infers the hash-rate variations by ana-
lyzing the results from the first phase, then leverages a recurrent
neural network to detect the cryptojacking activities.
2 METHODOLOGY
Both the network administrators and users can deploy our cryp-
tojacking detection approach at any router or switch between the
devices and the mining pools. Figure 1 shows the operational model
of the proposed approach. The user needs to input certain fields in
the IP packet headers to the detection system, which are the source
and destination IP addresses, the source and destination ports, the
packet size, and the timestamp. These data are information in the
network for packet forwarding and contain no private content data
of the senders. To obtain these content-agnostic data, we install
sFlow in the router or switch, other packet capturing engines like
NetFlow and Bro are also compatible with our detection system.
Additionally, we design and evaluate the detection approach on the
top of Monero-related (XMR) cryptojacking activities, since XMR is
the dominated cryptocurrency that widely mined by cryptojacking
attackers [4].
As stated in Section 1, the proposed method detects cryptojack-
ing activities in two phases. The first phase inputs sFlow data and
outputs identified crypto-mining traffic. The second phase inputs
crypto-mining traffic and outputs detected cryptojacking traffic.
2.1 Phase One: detection of crypto-mining
In Phase One, the detection of crypto-mining traffic relies on the
identification of the traffic between miners and the mining pool.
A mining pool is the pooling of resources by miners. As the
mining difficulty keeps increasing, miners can hardly mine cryp-
tocurrencies only by themselves. Hence, miners throughout the
Internet form massive mining pools to conduct the mining tasks
together and split the rewards according to their contribution. The
communication between the miners and the mining pool should
follow particular protocols or regulations so that miners from dif-
ferent locations can join the mining pool easily. Stratum is the most
widely used communication protocol for mining [6], which has ob-