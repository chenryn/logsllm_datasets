title:Hey, My Malware Knows Physics! Attacking PLCs with Physical Model
Aware Rootkit
author:Luis Garcia and
Ferdinand Brasser and
Mehmet Hazar Cintuglu and
Ahmad-Reza Sadeghi and
Osama A. Mohammed and
Saman A. Zonouz
Hey, My Malware Knows Physics!
Attacking PLCs with Physical Model Aware Rootkit
Luis A. Garcia
Rutgers University
PI:EMAIL
Ahmad-Reza Sadeghi
Technische Universit¨at Darmstadt
PI:EMAIL
Ferdinand Brasser
Technische Universit¨at Darmstadt
PI:EMAIL
Mehmet H. Cintuglu
Florida International University
mcint015@ﬁu.edu
Osama Mohammed
Florida International University
mohammed@ﬁu.edu
Saman A. Zonouz
Rutgers University
PI:EMAIL
Abstract—Trustworthy operation of industrial control systems
(ICS) depends on secure code execution on the embedded pro-
grammable logic controllers (PLCs). The controllers monitor and
control the underlying physical plants such as electric power
grids and continuously report back the system status to human
operators.
We present HARVEY, 1 a PLC rootkit that implements a
physics-aware stealthy attack against cyberphysical power grid
control systems. HARVEY sits within the PLC’s ﬁrmware below
the control logic and modiﬁes control commands before they are
sent out by the PLC’s output modules to the physical plant’s
actuators. HARVEY replaces legitimate control commands with
malicious, adversary-optimal commands to maximize the damage
to the physical power equipment and cause large-scale failures. To
ensure system safety, the operators observe the status of the power
system by fetching system parameter values from PLC devices.
To conceal the maliciously caused anomalous behavior from
operators, HARVEY intercepts the sensor measurement inputs to
the PLC device. HARVEY simulates the power system with the le-
gitimate control commands (which were intercepted/replaced with
malicious ones), and calculates/injects the sensor measurements
that operators would expect to see. We implemented HARVEY
on the widely spread Allen Bradley PLC and evaluated it on a
real-world electric power grid test-bed. The results empirically
prove HARVEY’s deployment feasibility in practice nowadays.
I.
INTRODUCTION
Industrial control systems (ICS) interconnect, control and
monitor industrial environments such as electrical power gen-
eration, transmission and distribution, chemical production,
oil and gas reﬁning and transport, and water treatment and
distribution. In recent years, ICS have received considerable
attention due to security concerns originated by the trend to
connect ICS to the Internet [22]. In particular, critical infras-
tructures connected to and controlled by ICS substantiate these
security concerns. Nevertheless, the ICS market is expected to
grow to $10.33 billion by 2018 [47].
1Harvey Dent (Two-Face) is a ﬁctional super-villain adversary of the
superhero Batman. The right half of his face looks normal/benign, unlike
the hideously scary left side of his face.
Permission  to  freely  reproduce  all  or  part  of  this  paper  for  noncommercial 
purposes is granted provided that copies bear this notice and the full citation 
on the ﬁrst page. Reproduction for commercial purposes is strictly prohibited 
without the prior written consent of the Internet Society, the ﬁrst-named author 
(for  reproduction  of  an  entire  paper  only),  and  the  author’s  employer  if  the 
paper  was  prepared  within  the  scope  of  employment.
NDSS  ’17,  26  February  -  1  March  2017,  San  Diego,  CA,  USA
Copyright  2017  Internet  Society,  ISBN  1-891562-46-0
http://dx.doi.org/10.14722/ndss.2017.23313
Nation-state ICS malware such as the Stuxnet worm [24]
against Iranian nuclear uranium enrichment facilities and
BlackEnergy crimeware [23] against the Ukranian train railway
and electricity power industries show that targeted attacks on
critical infrastructures can evade traditional cybersecurity de-
tection and cause catastrophic failures with substantive impact.
The discovery of Duqu [14] and Havex [43] show that such
attacks are not isolated cases as they infected ICS in more than
eight countries.
ICS security has been traditionally handled using network
security and information technology (IT) practices [52]. ICS
security goals, however, differ from traditional IT security
goals due to additional requirements and conditions of op-
eration. The interconnection of the physical world and virtual
world, bridged by cyberphysical systems (CPS), is a unique
feature of ICS compared to traditional IT infrastructures.
And unlike most traditional IT systems, high availability is
critical for ICS. A process failure can have fatal consequences
threatening human lives and resulting in immense ﬁnancial
loss.2
ICS are monitored and operated in a centralized fashion:
embedded CPS, known as programmable logic controllers
(PLC), are connected to a central control terminal (human-
machine interface HMI) through which a human operator can
supervise the system. PLCs are digital computing devices used
for automating industrial electromechanical processes. They
control the state of the output ports based on signals received
from the input ports and stored programs, and operate typi-
cally under hard environmental conditions, such as excessive
vibration and high noise [9], [20]. PLCs control standalone
equipment and discrete manufacturing processes. Their logical
behavior with regard to inputs and outputs can be programmed
by the operator.
The main goal of sophisticated attackers is to remain
stealthy from ICS operators. In particular, the HMI’s view of
the system should not indicate any effect caused by attacks.
For this, the adversary can either compromise and manipulate
the HMI itself, or launch a more sophisticated attack on
PLCs. A prominent example of HMI related attacks is the
infamous Stuxnet [24]. However, HMIs are often based on
commodity computer systems for which a wide variety of
security solutions exist, including anti-virus software, security
enhanced operating systems, run-time attack protections, and
many more. This makes the HMI an unattractive attack target.
On the other hand, although many PLC related attacks have
2ICS are also not what is usually considered Internet of Things (IoT) as
there are substantial differences (cf. Section VIII-A).
been published in recent years [8], [12], [32], [44], they have
limitations with regard to stealthiness and result in obvious
effects, such as disrupting the operation of PLCs [44]. Other
attacks operate on the PLC’s application level (called control
logic), which allows the operator to detect
their presence
through the PLC’s remote management capabilities [12], [32].
Goals and Contributions. In this paper we present a novel
class of stealthy PLC attacks that we refer to as Man-in-
the-PLC. Our exploit intercepts the PLC’s input and output
values, provides an arbitrary view of the system to the control
logic (i.e., the program running on the PLC), and simulates a
semantically correct system state towards the central control
unit while changing the actual system state. We provide the
following main contributions:
• We present a novel attack class on industrial control
systems: a cyber-physical attack which is completely
invisible to the control center of an ICS.
• We reverse engineered the central control loop mechanism
of a widely deployed Allen Bradley 1769-L18ER-BB1B
CompactLogix 5370 L1 Rev. B PLC.
• We developed a prototype implementation of HARVEY,
and tested and evaluated it on an Allen Bradley PLC.
Allen Bradley is one of the most used ICS suppliers in
the United States.
• We evaluate our attack in a real power grid test environ-
ment.
We would like to stress that our main contribution and
novelty of our rootkit lies in its physics-awareness. This makes
our solution more general than all solutions published before,
including real world attacks like Stuxnet [24]. To be able
to implement and evaluate our prototype, we had to reverse
engineer the PLC to gain the required insight into its inner
working, in particular, the PLC’s control of input and output
lines, and the connection between the ﬁrmware and control
logic programs.
Following the standard responsible disclosure policies, we
have taken necessary steps and have contacted the vendor,
Allen Bradley, informing them about the possibility of such
malicious exploits against their controllers. Allen Bradley gave
us clearance to publish our ﬁndings.
The remainder of the paper is structured as follows. First,
we provide the reader with a background on industrial control
systems in general and programmable logic controllers in
particular, and present our system model and adversary model
in Section II. In Section III, we explain the general concept of
HARVEY before providing details on the physics-aware data
manipulations of our attack in Section IV. In Section V, we
describe how we reverse engineered the ﬁrmware of an Allen
Bradley PLC and implemented our rootkit. In Section VI, we
provide an extensive evaluation for our physics-aware PLC
rootkit against a real power grid test-bed. Section VII provides
a review of related work in the area of ICS security. We discuss
our ﬁndings and possible mitigation strategies in Section VIII,
and conclude in Section IX.
II. BACKGROUND AND SYSTEM MODEL
In this section, we provide basic knowledge for the rest of
the paper. We provide detailed information about industrial
control systems (ICS) and programmable logic controllers
(PLC), and we deﬁne the system model and adversary model
we will consider throughout the paper.
Fig. 1: PLC Architecture
A. Background
An ICS is a distributed system which is composed of
physical components, like sensors and actuators, which interact
with the physical system (e.g., power grid) and cyber com-
ponents (e.g., cyber-networks and servers). Although ICS are
largely self-contained, interfaces exist through which external
components can interact with the systems. For instance, a
human operator can monitor the systems state and inﬂuence
it through a human-machine interface (HMI). Most PLCs are
connected to the ICS via an Ethernet network, and hence, often
indirectly connected to the Internet. It is also quite common
that PLCs are directly connected to the Internet [32].
Centralized operation and maintenance is an essential fea-
ture of ICS. An operator can program and monitor PLCs and
the applications running on them remotely, i.e., retrieve the
status of a PLC and re-program it over the network. The
information which can be retrieved from the PLC contains,
among others, the control logic applications on the PLC. All
applications,
including their source code and further meta
information, can be loaded from a PLC.3
Programmable Logic Controllers (PLC). Programmable
logic controllers (PLC) are cyber-physical systems that are
used to control industrial appliances. PLCs have input and
output modules to interact with the physical world. They can
translate physical inputs, mostly current on a wire, into digital
values and vice versa. Connected to physical appliances such
as sensors and actuators, PLCs can convert sensor readings into
digital values, process the readings with the built-in computing
unit, and forward the outputs to the physical world. The logical
behavior of PLCs, i.e., the processing of the input data, is
programmable.
Such control loops can be either local, i.e., the inputs and
outputs are handled by a single PLC, or distributed, i.e., the
inputs are read by one PLC and forwarded over the network
to another PLC.
The two main software components of a PLC, control logic
and ﬁrmware, are shown in Figure 1. The ﬁrmware is acting
as a kind of operating system (OS). The ﬁrmware contains,
among other functionality, modules to read and write the inputs
and outputs of the PLC from/to the physical world. These
modules can be seen as drivers for the I/O hardware. Control
logic programs can be considered the PLC’s application layer.
The ﬁrmware provides services to read from input lines and
write to output lines of the PLC. They are used by the control
3This enables the operator to detect malicious modiﬁcation of the PLC on
the control logic layer.
2
FirmwareCPUOutputInputHardwareControl LogicO1O2I1I2I3I4HMIICS NetworkSensorActuatorVirtual WorldPhysical WorldOutputModuleInputModuleScan CycleC. Adversary Model and Assumptions
Stealthiness. The main goal of the adversary is to launch a
stealthy attack on an industrial control system (ICS).5 Stealthy
means that the attack does not cause unintentionally observable
effects. For instance, sensor readings analyzed by a system
operator or automated tools should align with what they are
expected to be. Real world examples like Stuxnet [24] have
shown that stealthy attacks have a more enduring impact on
a system than a short attack which will rapidly break down a
system.
The attack exploits the circumstance that in real world
systems the operator’s view of the entire system is limited to
the information provided by the HMI, i.e., he cannot directly
observe the physical system and detect attack effects through
an out-of-band channel like visual contact. This limitation
can be due to different reasons, e.g., in large and distributed
systems the operator is physically not capable of observing
the entire system, or the system operates in a hazardous
environment and for safety reasons the operator only has
remote access to the system.
PLC-only Attack. We assume that the adversary compro-
mises only PLCs and no other components of the ICS, hence
the name Man-in-the-PLC. In particular, we do not assume that
the adversary has manipulated the human-machine interface
(HMI), e.g., to hide suspicious activities from the operator.6
Besides an operator observing the HMI, the ICS might include
security mechanisms like SCADA-speciﬁc7 intrusion detection
systems (IDS) that monitor the system [52]. We assume the
adversary cannot compromise (all) monitoring entities (i.e.,
IDS systems) in an ICS in order to hide an attack.
Furthermore, ICS components like HMI’s are usually based
on commodity hardware and software, e.g., a workstation
PC running Windows operating system. Security solutions
for those systems already exist, e.g., anti-virus software and
automated software update solutions, increasing the probability
for detection of an attack.
Physical Model Extraction. We assume the adversary has
knowledge about the inner workings of his target and uses
this information to build a model of the correct behavior of
the target to be able to hide suspicious effects of the attack.
The adversary can get the required information, for instance,
through an insider, or through preceding information gathering
attacks [32]. Although physical model extraction is outside of
the scope of this paper, it is worth noting that monitoring
and management systems of the ICS can be leveraged to
extract information about the physical model. For instance, in
power systems, energy management systems (EMS) are used to
control the power grid infrastructure. An EMS is a collection of
computer-aided tools used by operators of electric utility grids
to monitor, control and optimize the performance of generation
and transmission systems. A typical suite of EMS applications