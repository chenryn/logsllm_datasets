# 回顾恶名昭著的Mirai僵尸网络（下）
|
##### 译文声明
本文是翻译文章，文章原作者 Elie Bursztein，文章来源：elie.net
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
## 传送门
[回顾恶名昭著的Mirai僵尸网络（上）](https://www.anquanke.com/post/id/89119)
## 前言
本文是回顾恶名昭著的Mirai僵尸网络下半部分，包括以下内容：
1、模仿者的兴起：这一部分介绍了Mirai源代码公布事件及众多黑客组织对这个代码的重用过程。源代码发布后，涌现了许多Mirai变种，这一部分也介绍了我们用来追踪这些变种的具体技术。最后，我们也讨论了每个主流变种背后的目标及动机。
2、Mirai致瘫互联网：介绍Dyn攻击事件的内幕，表明主流站点（如Amazon）无法提供服务其实只是此次攻击的附带牺牲品而已。
3、Mirai封闭整个国家？：分析针对Lonestar（利比里亚最大运营商）的多次攻击活动。
4、德国电信陷入黑暗：讨论Mirai某个变种如何借助路由器使德国互联网提供商下跪求饶。
5、Mirai原作者身份澄清？：详细介绍Brian Krebs关于Mirai作者的调查情况，以及FBI相关案件的审讯结果。
6、德国电信攻击始作俑者被捕：介绍攻击德国电信始作俑者被捕过程，以及从案件审理中我们可以获取的信息。
## 一、模仿者的兴起：9月30日
事件的发展有点出众人所料，在2017年9月30日，作为Mirai的作者，Anna-senpai通过某个臭名昭著的黑客论坛公布了[Mirai源代码](https://krebsonsecurity.com/2016/10/source-code-for-iot-botnet-mirai-released/)。他还在论坛上发表了一个帖子，宣布就此退出舞台，如上图所示。
源代码的公布是一个导火索，使山寨黑客不断涌现，开始运行自己的Mirai僵尸网络。从那一刻起，Mirai攻击已不局限于单一的攻击者或者单一的基础设施，而是与多个团体关联起来，这使得研究人员更加难以追踪溯源这类攻击，无法看清这些团体背后的动机。
###  聚类Mirai基础设施
为了跟上Mirai变种的扩散速度，跟踪隐藏在这些变种背后的黑客组织，我们开始聚类分析攻击者所使用的基础设施。逆向分析所有的Mirai版本后，我们可以提取出各种黑客组织所使用的C&C服务器的IP地址及域名。我们总共提取出2个IP地址以及66个不同的域名。
从提取出的域名来拓展DNS信息，将这些信息聚类在一起后，我们可以识别出33个不同的C&C集群（cluster），这些集群所使用的基础设施没有交集。这些集群中，最小的集群使用一个单独的IP地址作为C&C地址。最大的集群拥有112个域名以及92个IP地址。我们发现的集群中，最大的6个集群如上图所示。
这些大型集群所使用的域名格式差别很大。比如，“cluster 23”喜欢与动物有关的域名，如“33kitensspecial.pw”，而“cluster
1”拥有许多与电子货币有关的域名，比如“walletzone.ru”。从结果中，我们发现了许多不同的基础设施以及不同的特征，这也进一步确认在源代码泄露后，有多个组织在独立传播Mirai变种。
###  变种集群时间线
通过查看集群C&C基础设施的DNS请求次数，我们可以重构每个集群的演进时间线，估计集群的相对规模。之所以能够通过这种方法进行统计，原因在于每个僵尸节点必须定期执行DNS查询任务，以获取C&C域名所对应的IP地址。
某几个大型集群的DNS请求次数如上图所示。从上图可知，同一时间有许多集群处于活跃状态。我们从中可以推测许多攻击者的动机有所不同，因此他们在争相夺取存在漏洞的IoT设备的控制权，根据自己需求发起DDoS攻击。
将所有变种绘制在一张图上后，我们可以清楚地发现不同变种所使用的IoT设备的范围差别很大。如上图所示，虽然全世界有许多Mirai变种，但只有非常少数的几个变种能够拓展自身规模，具备攻陷主流网站的能力。
###  背后的动机
集群 | 备注  
---|---  
6 | 攻击Dyn以及游戏相关目标  
1 | 原始僵尸网络，攻击Krebs以及OVH  
2 | 攻击Lonestar Cell运营商  
观察大型集群所攻击的目标，我们可以分析这些集群背后的真正动机。比如，如上表所示，原始的Mirai变种（cluster
1）攻击的是OVH以及Krebs，而Mirai的最大变种（cluster
6）攻击的是DYN以及与游戏相关的其他网站。相比之下，Mirai的第三大变种（cluster 2）攻击的是非洲电信运营商，稍后我们会介绍这一点。
目标 | 被攻击次数 | 集群 | 备注  
---|---|---|---  
Lonestar Cell | 616 | 2 | 利比里亚电信运营商被反射式攻击102次  
Sky Network | 318 | 15, 26, 6 | 巴西Minecraft服务器，托管在Psychz Networks数据中心  
104.85.165.1 | 192 | 1, 2, 6, 8, 11, 15 … | Akamai网络中的未知路由器  
feseli.com | 157 | 7 | 俄罗斯烹饪博客  
Minomortaruolo.it | 157 | 7 | 意大利政客网站  
Voxility hosted C2 | 106 | 1, 2, 6, 7, 15 … | 从DNS扩展信息中发现的C2域名  
Tuidang websites | 100 | — | 通过HTTP方式攻击中国的两个网站  
execrypt.com | 96 | -0- | 二进制混淆服务网站  
Auktionshilfe.info | 85 | 2, 13 | 俄罗斯拍卖网站  
houtai.longqikeji.com | 85 | 25 | 通过SYN方式攻击原游戏商务网站  
Runescape | 73 | — | 世界排名26的在线游戏  