证券信息技术发展研究中心（上海）2018 年联合研究
课题报告
基于大数据与机器学习的证券行业
智能运维体系建设
课题主办单位：上海证券交易所
课题承接单位：光大证券股份有限公司
清华大学 NetMan 实验室
合胜科技
日志易
课题组成员： 晏强、周雄伟、杨超、吴浩、孙伟、裴丹、
鲍捷、王振宇
目录
摘要 ................................................................................................................................................... 4
第1章绪论 ....................................................................................................................................... 5
1.1 课题背景 ...................................................................................................................................... 5
1.2 课题研究目标 ............................................................................................................................... 5
1.3 研究方法 ...................................................................................................................................... 6
第2章智能运维体系可行性分析 ..................................................................................................... 8
2.1 可行性分析................................................................................................................................... 8
2.1.1 AIOps智能运维技术分析 .................................................................................................. 8
2.1.2 金融行业案例分析 ........................................................................................................... 10
2.2 可实现性分析 ............................................................................................................................. 12
2.2.1 AIOps业务实现分析 ........................................................................................................ 12
2.2.2 AIOps系统部署分析 ........................................................................................................ 13
2.3专家团队支持 ............................................................................................................................. 13
2.3.1 清华NetMan实验室 ......................................................................................................... 13
2.3.2 日志易团队 ........................................................................................................................ 14
第3章运维数据的采集 .................................................................................................................. 15
3.1 运维数据种类 ............................................................................................................................. 15
3.1.1 静态数据 ............................................................................................................................ 15
3.1.2 动态数据 ............................................................................................................................ 15
3.1.3 模型数据 ............................................................................................................................ 16
3.1.4 脱敏数据 ............................................................................................................................ 16
3.2 运维数据的采集 ......................................................................................................................... 16
3.2.1 数据采集架构 .................................................................................................................... 17
3.2.2 数据采集模式 .................................................................................................................... 18
3.3 数据处理 .................................................................................................................................... 19
3.3.1 数据缓存........................................................................................................................... 19
3.3.3 数据处理........................................................................................................................... 20
3.3.4 数据存储 ............................................................................................................................ 22
第4章智能算法与AI场景 ............................................................................................................. 24
4.1 智能算法种类 ............................................................................................................................. 24
4.1.1 无监督异常检测 ................................................................................................................ 24
4.1.2 异常根因定位 .................................................................................................................... 29
4.1.3 自然语言处理 .................................................................................................................... 30
4.2 AI场景介绍 ................................................................................................................................. 33
4.2.1 单指标异常检测 ................................................................................................................ 33
4.2.2 趋势预测分析 .................................................................................................................... 35
4.2.3 多维指标异常定位 ............................................................................................................ 35
4.2.4 日志异常分析与定位 ........................................................................................................ 36
第5章智能运维体系架构............................................................................................................... 38
5.1 体系架构 .................................................................................................................................... 38
5.2 数据架构 .................................................................................................................................... 39
5.3 基于微服务架构的服务总线 ..................................................................................................... 40
5.3.1 服务网关建设 .................................................................................................................... 42
5.3.2 认证和权限管理 ................................................................................................................ 42
5.3.3 服务的治理和监控 ............................................................................................................ 43
5.4 物理架构 .................................................................................................................................... 44
5.5 数据安全设计 ............................................................................................................................. 45
5.5.1 数据安全 ............................................................................................................................ 45
5.5.2 主机安全 ............................................................................................................................ 45
5.5.3 应用安全 ............................................................................................................................ 45
5.5.4 数据传输安全 .................................................................................................................... 46
5.5.5 数据存储安全 .................................................................................................................... 46
5.5.6 数据访问控制 .................................................................................................................... 47
5.6 平台自监控................................................................................................................................. 49
第6章智能运维场景展示............................................................................................................... 51
6.1 运维数据的展示 ......................................................................................................................... 51
6.2 智能场景的展示 ......................................................................................................................... 53
6.2.1 场景介绍 ............................................................................................................................ 53
6.2.2 发现问题 - 单指标异常检测 ........................................................................................... 54
6.2.3 发现问题 – 日志异常检测 .............................................................................................. 56
6.2.4 定位问题 – 多指标异常定位 .......................................................................................... 58
6.2.5 分析问题 - 业务/机器指标的关联分析 .......................................................................... 60
第7章收益及展望 .......................................................................................................................... 62
7.1 预期收益 .................................................................................................................................... 62
7.2 经验分享 .................................................................................................................................... 62
7.3 未来展望 .................................................................................................................................... 64
参考文献 ......................................................................................................................................... 65
附录 ................................................................................................................................................. 66
摘要
证券业运维管理通过较严格的制度和规范的流程，把复杂系统纳入可预期的
管理操作之下。这种稳态运维的模式，绩效主要取决于内部的管理制度建设和落
实。然而，随着金融科技在证券业的不断深入发展，大量新技术的引入，迫使证
券业的运维模型向稳态和敏态结合的双态模式发展，简化的流程、快速的迭代、
复杂的技术都对传统的运维管理方法提出挑战。在高速变化的环境下，系统如何
保持可用性要求，这需要有更先进的IT管理思路和更高级的科技手段。
利用成熟的人工智能技术，可以帮助运维人员在事后快速定位问题、在事中
的运行指标中发现故障并实时响应、甚至在事前洞察到可能的风险并提前调整优
化，基于人工智能的新一代运维方法称为AIOps，它能极大降低IT运维的工作
强度，同时显著提升反应速度，使得运维效率大幅提升。随着，人工智能技术的
发展，相关技术也已经日趋成熟。目前，智能运维在证券行业受到越来越多的关
注，纷纷着手进行探索实践。
本项目以光大证券信息技术总部主导，整合了清华大学NetMan团队、日志
易数据技术团队、合胜技术团队的设计和实践经验。通过对智能运维体系在光大
证券实际落地建设进行刨析，系统性地介绍了AIOps 原则、智能运维体系参考
架构、运维数据的采集处理、相关机器学习算法、AI场景的选择应用、体系平
台的整体设计等在证券行业的落地方法。该体系在光大证券某应用系统上实现了
异常检测和异常定位等AI场景，为运维工作带来了实际收益，给证券行业AIOps
落地的实践方法具有极强的指导意义。
关键词：证券行业 AIOps 大数据平台机器学习智能运维异常检测异常定位
第 章绪论
1
1.1 课题背景
AIOps即智能运维，即通过系统运行过程中所产生的数据，运用AI和算法、
运筹理论等相关技术，对运维数据进行分析，进而提升运维效率的新一代运维手
段和方法。根据Gartner在2016年提出的分析报告，IT运维人员的工作在未来
几年内将发生重大的变化，到2020年AIOps的采用率将会达到50%。目前，AIOps
在国内外的领先互联网企业开始被逐渐应用，是近年来国内外被普遍看好的新技
术。
券商作为最先实现电子化的金融机构，通过 30 多年的发展，已经积累了大量
稳态运维积累的软硬件基础架构运维的数据及经验。同时，市场竞争加剧要求券
商响应业务快速迭代发展的需要，IT 运维越来越受到敏态业务带来的交付效率
和运维质量的压力。在双态 IT 运维环境中，如何保证业务系统的稳定性，具备
故障的快速定位、根因调查，极大的挑战券商的 IT 运维团队的水平和运维工作
的有效性。AIops 技术对大量运维中产生的数据，运用 AI 和算法等相关技术进
行分析，提升传统运维方式的运维效率。
1.2 课题研究目标
随着金融科技在券商行业高速发展，给传统IT运维带来了压力，主要表现
在金融科技带来的IT建设规模越来越大，IT运维的复杂度也越来越高；来自监
管的IT运维的要求也越来越高，99.99%可用性要求，对连续性管理提出了更高
的要求；两地三中心的部署架构，管理的硬件设备数以千计，TB级的运维数据
分散在各个复杂的系统中。
面对困难，券商近年都进行了运维方面投入了大量的资源，运维水平得以较
大提升。比较具有代表性的内容包括：通过ITIL和CMDB的建设实现运维标准化；
通过自动化运维工具的引入提高了运维效率；通过大数据平台建设实现数据处理
能力的大幅度提升；通过集中监控和数据采集的建设逐步实现监控和运维数据的
统一处理。
经过与多家券商以及智能运维厂商进行调研和交流，目前券商在智能运维领
域处于探索阶段，建设的进度参差不齐，部分券商已经建设了大数据平台，并实
现了运维数据的集中采集分析；部分券商开始将运维数据结合算法的运维场景在
大数据平台进行落地，但均处于以实现应用场景落地为目标的方式进行建设，整
体架构尚不清晰，无法将运维数据的价值进一步整合和利用。
本次旨在通过光大证券基于大数据与机器学习的证券行业智能运维体系的
建设和研究，构建证券行业智能运维AIOps的实施路径及落地方法。
1.3 研究方法
通过研究智能运维体系的建设，将日常运维活动产生的运维数据进行采集、
整合，引入成熟的算法和机器学习技术，对数据进行全面智能分析的实现过程，
探索可行的方法和路径。
针对运维系统数据来源广泛、多样性复杂的特征，数据采集和持久化建立了
以 kafka 数据管道为核心的数据队列系统，以 ElasticSearch 等开源数据仓库为持
久化平台的数据存储系统。做到实时对多套系统采集的指标和日志等多种数据进
行采集汇总，并进行进一步的预处理。
以运维的业务系统为整体监控单位，对核心业务数据、应用日志数据、机器
指标数据进行数据采集、异常发现和异常分析，通过大数据平台的计算能力和算