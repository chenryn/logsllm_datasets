of which belong to T orhttp. Only a small fraction (1.38%) of
the requests are censored and 16.2% of them generate TCP errors.
Figure 8(a) shows the number of requests for August 1-6. The trafﬁc
has several peaks, in particular on August 3, when several protests
were taking place. We observe that 99.9% of censored Tor trafﬁc is
blocked by a single proxy (SG-44), even though the overall trafﬁc
11See https://gitweb.torproject.org/torspec.git?a=blob_plain;hb=
HEAD;f=dir-spec-v2.txt for a full description.
Figure 9: Ratio of (re)censored IPs SG-44.
is uniformly distributed across all the 7 proxies. The other 0.01%
of the trafﬁc is censored by SG-48. This ﬁnding echoes our earlier
discussion on the specialization of some proxies.
We also analyze the temporal pattern of Tor censored trafﬁc and
compare it to the overall censored requests of SG-44. As shown
in Figure 8(b), Tor censoring exhibits a higher variance. While
censoring T orhttp is technically simple, as it only requires matching
of regular expressions against the HTTP requests, identifying and
censoring T oronion is more challenging, as it involves encrypted
trafﬁc. However, only T oronion trafﬁc is censored according to the
logs, while T orhttp is always allowed.
Next, we verify whether the Tor censorship is consistent (i.e.,
whether the blocked Tor relay is re-allowed later). To do so, we
proceed as follows: First, we create a set of all censored Tor relay
addresses denoted Censored-IPs. Then, for each one hour time
window considered as a time bin k, we create the set of all Tor relays
IP addresses that were allowed, we denote Allowed-IPs (k).
For each time bin k, we calculate the relative overlap between the
censored Tor relay nodes and the Tor relays allowed at bin k as:
Rf ilter(k) = 1 − |Censored-IPs ∩ Allowed-IPs(k)|
|Censored-IPs|
where | · | denotes the set size. Figure 9 depicts the variation of
Rf ilter as a function of time. Note that Rf ilter(k) equals 0 if,
at a speciﬁc time bin k, all connections to Censored-IPs are
allowed (line curve) or none of the IPs in Allowed are in Censored
(circle curve). Rf ilter(k) equals 1 if none of the connections to
Censored-IPs have been allowed at a speciﬁc time bin k.
The high variance of Rf ilter shows that the censorship is in-
consistent. In fact, the beginning of this plot is either dominated
by red circles (all trafﬁc is allowed) or few small peaks showing
a very mild censorship. Then few successive peaks with a high
variance of blockage appear for several hours, followed by a lull at
the night of 03 of August. The same scenario is repeated several
times, alternating between aggressive censorship and more mild
period. This behavior is hard to explain as some IPs are alternating
between blocked and allowed status. One explanation might be a
testing phase that is carried in a single router and for a short period
of time to test a new censorship approach (in this scenario the newly
deployed Tor censorship). Or, this censorship is based on ﬁelds that
are not logged by the appliance and hence inaccessible to us.
7.2 Web Proxies and VPNs
As already mentioned, access to web/socks proxies is censored,
as demonstrated by an aggressive ﬁltering of requests including the
keyword proxy. In the following, we use “proxies” to refer to the
Blue Coat appliances whose logs we study in this paper, and “web
proxies” to refer to services used to circumvent censorship.
295To use web proxies, end-users need to conﬁgure their browsers
or their network interfaces, or rely on tools (e.g., Ultrasurf) that
automatically redirect all HTTP trafﬁc to the web proxy. Some
web proxies support encryption, and create a SSL-based encrypted
HTTP tunnel between the user and the web proxy. Similarly, VPN
tools (e.g., Hotspot Shield) are often used to circumvent censorship,
again, by relaying trafﬁc through a VPN server.
We analyze the usage of VPN and web proxy tools and ﬁnd
that a few of them are very popular among Internet users in Syria.
However, as discussed in Section 5.4, keywords like ultrasurf and
hotspotshield are heavily monitored and censored. Nonetheless,
some web proxies and VPN software (such as Freegate, GTunnel
and GPass) do not include the keyword proxy in request URLs
and are therefore not censored. Similarly, we do not observe any
censorship activity triggered by the keyword VPN.
Next, we focus on the domains that are categorized as “Anonymiz-
ers” by McAfee’s TrustedSource tool, including both web prox-
ies and VPN-related hosts. In the Dsample dataset, there are 821
“Anonymizer” domains, which are the target of 122K requests (repre-
senting 0.4% of the total number of requests). 92.7% of these hosts
(accounting for 25% of the requests) are never ﬁltered. Figure 10(a)
shows the CDF of the number of requests sent to each of those
allowed hosts. Less than 10% of these hosts receive more than 100
requests, suggesting that only a few popular services attract a high
number of the requests.
Finally, we look at the 7.3% of the identiﬁed “Anonymizer” hosts,
for which some of the requests are censored. We calculate the ratio
between the number of allowed requests in Df ull and the number of
censored requests in Ddenied. Figure 10(b) shows the CDF of this
censorship ratio. We observe a non-consistent policy for whether a
request is allowed or censored, with more than 50% of the proxies
showing a higher number of allowed requests than censored requests.
This suggests that these requests are not censored based on their
IP or hostname, but rather on other criteria, e.g., the inclusion of a
blacklisted keyword in the request.
In conclusion, while some services (such as Hotspot Shield) are
heavily censored, other, less known, services are not, unless related
requests contain blacklisted keywords. This somehow introduces a
trade-off between the ability to bypass censorship and promoting
censorship- and surveillance-evading tools (e.g., in web searches)
by including keywords such as proxy in the URL.
7.3 Peer-to-Peer networks
The distributed architecture of peer-to-peer networks makes them,
by nature, more resilient to censorship: users obtain content from
peers and not from a server, which makes it harder to locate and
block content. Shared data is usually identiﬁed by a unique identiﬁer
(e.g., info hash in BitTorrent), and these identiﬁers are useless to
censors unless mapped back to, e.g., the description of the corre-
sponding ﬁles. However, resolving these identiﬁers is not trivial:
content can be created by anyone at any time, and the real description
can be distributed in many different ways, publicly and privately.
To investigate the use of peer-to-peer networks as a way to access
censored content, we look for signs of BitTorrent trafﬁc. We ﬁnd
a total of 338,168 BitTorrent announce requests from 38,575 users
(BitTorrent uses a 20-byte peer_id ﬁeld to identify peers, which we
use to count unique users) for 35,331 unique contents in the Df ull
dataset.12 Most of these requests (99.97%) are allowed. Censored
requests can be explained with the occurrence of blacklisted key-
12BitTorrent clients send announce requests to BitTorrent servers
(aka trackers) to retrieve a list of IP addresses from which the
requested content can be downloaded.
(a)
(b)
Figure 10:
(a) CDF of the number of requests for identiﬁed
“anonymizer” hosts; (b) Ratio of Allowed versus Censored num-
ber of requests for identiﬁed “anonymizer” hosts.
words, e.g., proxy, in the request URL. For instance, all announce
requests sent to the tracker on tracker-proxy.furk.net are censored.
Using the hashes of torrent ﬁles provided in the announce mes-
sages, we crawl torrentz.eu and torrentproject.com to extract the
titles of these torrent ﬁles, achieving a success rate of 77.4%. The
ﬁve blacklisted keywords, reported in Table 9, are actually present in
the titles of some of the BitTorrent ﬁles, yet the associated announce
requests are allowed. We do not ﬁnd any content that can be directly
associated with sensitive topics like “Syrian revolution” or “Arab
spring” (these ﬁles may still be shared via BitTorrent without pub-
licly announcing the content), however, we identify content relating
to anti-censorship software, such as UltraSurf (2,703 requests for all
versions), HideMyAss (176 requests), Auto Hide IP (532 requests)
and anonymous browsers (393 requests). Our ﬁndings suggest that
peer-to-peer networks are indeed used by users inside Syria to cir-
cumvent censorship to a certain extent. Also note that BitTorrent is
used to download Instant Messaging software, such as Skype, MSN
messenger, and Yahoo! Messenger, which cannot be downloaded
directly from the ofﬁcial download pages due to censorship.
7.4 Google Cache
When searching for terms in Google’s search engine, the result
pages allow access to cached versions of suggested pages. While
Google Cache is not intended as an anti-censorship tool, a simple
analysis of the logs shows that it provides a way to access content
that is otherwise censored.
We identify a total of 4,860 requests accessing Google’s cache
on webcache.googleusercontent.com in the Df ull dataset. Only
12 of them are censored due to an occurrence of a blacklisted key-
296word in the URL, and a single request to retrieve a cached version
of http://ar-ar.facebook.com/SYRIANREVOLUTION.K.N.N has
policy_denied, although it is not categorized as a “Blocked Site.”
However, the rest of the requests are allowed. Interestingly, some
of the allowed requests, although small in number, relate to cached
versions of webpages that are otherwise censored, such as www.
panet.co.il, aawsat.com, www.facebook.com/Syrian.Revolution, and
www.free-syria.com. While the use of Google cache to access cen-
sored content is obviously limited in scope, the logs actually suggest
that it is very effective. Thus, when properly secured with HTTPS,
Google cache could actually serve as a way to access censored
content.
7.5 Summary
The logs highlighted that Syrian users do resort to censorship
circumvention tools, with a relatively high effectiveness. While
some tools and websites are monitored and blocked (e.g., Hotspot
Shield), many others are successful in bypassing censorship. Our
study also shows that some tools that were not necessarily designed
as circumvention tools, such as BitTorrent and Google cache, could
provide additional ways to access censored content if proper precau-
tions are taken, especially considering that Syrian ISPs started to
block Tor relays and bridges in December 2012.
8. DISCUSSION
Economics of Censorship. Our analysis shows that Syrian authori-
ties deploy several techniques to ﬁlter Internet trafﬁc, ranging from
blocking entire subnets to ﬁltering based on speciﬁc keywords. This
range of techniques can be explained by the cost/beneﬁt tradeoff
of censorship, as described, e.g., by Danezis and Anderson [11].
While censoring the vast majority of the Israeli network – regardless
of the actual content – can be explained on geo-political grounds,
completely denying the access to social networks, such as Facebook,
could generate unrest. For instance, facing the “Arab spring” up-
risings, the Syrian authorities decided to allow access to Facebook,
Twitter, and Youtube in February 2011. Nonetheless, these websites
are monitored and selectively censored. Censors might aim at a
more subtle control of the Internet, by only denying access to a
predeﬁned set of websites, as well as a set of keywords. This shift is
achievable as the proxy appliances seamlessly support Deep Packet
Inspection (DPI), thus allowing ﬁne-grained censorship in real-time.
Censorship’s target. Censored trafﬁc encompasses a large va-
riety of content, mostly aiming to prevent users from using In-
stant Messaging software (e.g., Skype), video sharing websites
(e.g., metacafe.com, upload.youtube.com), Wikipedia, as well as
sites related to news and opposition parties (e.g., islammemo.cc,
alquds.co.uk). Censors also deliberately block any requests related
to a set of predeﬁned anti-censorship tools (e.g., ‘proxy’). This
mechanism, however, has several side effects as it denies the access
to any page containing these keywords, including those that have
nothing to do with censorship circumvention.
Censorship Circumvention. We also highlighted that users at-
tempt to circumvent censorship. One interesting way is using Bit-
Torrent to download anti-censorship tools such as UltraSurf as well
as Instant Messaging software. Users also rely on known censorship-
evading technologies, such as web/socks proxies and Tor.
9. CONCLUSION
This paper presented a measurement analysis of Internet ﬁltering
in Syria. We analyzed 600GB worth of logs produced by 7 Blue Coat
SG-9000 proxies in Summer 2011 and, by extracting information
about processed requests for both censored and allowed trafﬁc,
we provided a detailed, ﬁrst-of-a-kind snapshot of a real-world
censorship ecosystem. We uncovered the presence of a relatively
stealthy yet quite targeted ﬁltering, which relies on IP addresses
to block access to entire subnets, on domains to block speciﬁc
websites, and on keywords to target speciﬁc content. Keyword-
based censorship (e.g., denying all requests containing the word
‘proxy’) also produces collateral damage, as many requests are
blocked even if they do not relate to sensitive content. Finally, we
showed that Instant Messaging software is heavily censored, that
ﬁltering of social media appears to be limited to speciﬁc pages,
and that Syrian users try to circumvent censorship using web/socks
proxies, Tor, VPNs, and BitTorrent.
10. REFERENCES
[1] Blue Coat ProxySG – Conﬁguration and Management Guide.
http://wikileaks.org/spyﬁles/ﬁles/0/226_BLUECOAT-
SGOS_CMG_4.1.4.pdf.
[2] C. Anderson. The Hidden Internet of Iran: Private Address
Allocations on a National Network. ArXiv 1209.6398, 2012.
[3] Arabic Network for Human Rights Information. Online Syria,
Ofﬂine Syrians. http://old.openarab.net/en/node/1625, 2013.
[4] S. Aryan, H. Aryan, and J. A. Halderman. Internet Censorship
in Iran: A First Look. In FOCI, 2013.
[5] BBC News. Syrian jailed for Internet usage.
http://news.bbc.co.uk/1/hi/world/middle_east/3824595.stm.
[6] Blue Coat. https://www.bluecoat.com/company/news/update-
blue-coat-devices-syria, 2011.
[7] A. Chaabane, T. Chen, M. Cunche, E. De Cristofaro,
A. Friedman, and M. A. Kafaar. Censorship in the Wild:
Analyzing Internet Filtering in Syria (Full Version).
http://arxiv.org/pdf/1402.3401.
[8] J. R. Crandall, D. Zinn, M. Byrd, E. T. Barr, and R. East.
ConceptDoppler: A Weather Tracker for Internet Censorship.
In CCS, 2007.
[9] A. Dainotti, C. Squarcella, E. Aben, K. C. Claffy, M. Chiesa,
M. Russo, and A. Pescapé. Analysis of country-wide internet
outages caused by censorship. In IMC, 2011.
[10] J. Dalek, B. Haselton, H. Noman, A. Senft,
M. Crete-Nishihata, P. Gill, and R. J. Deibert. A Method for
Identifying and Conﬁrming the Use of URL Filtering
Products for Censorship. In IMC, 2013.
[11] G. Danezis and R. Anderson. The Economics of Censorship
Resistance. In WEIS, 2004.
[12] S. Egelman, J. Bonneau, S. Chiasson, D. Dittrich, and S. E.
Schechter. It’s Not Stealing If You Need It: A Panel on the
Ethics of Performing Research Using Public Data of Illicit
Origin. In Financial Cryptography, 2012.
[13] R. Jain. The art of computer systems performance analysis:
Techniques for experimental design, measurements,
simulation, and modeling. Wiley, April 1991.
[14] G. King, J. Pan, and M. Roberts. How censorship in China
allows government criticism but silences collective expression.
In APSA Annual Meeting, 2012.
[15] J. Knockel, J. R. Crandall, and J. Saia. Three Researchers,
Five Conjectures: An Empirical Analysis of TOM-Skype
Censorship and Surveillance. In FOCI, 2011.
[16] C. S. Leberknight, M. Chiang, H. V. Poor, and F. Wong. A
Taxonomy of Internet Censorship and Anti-Censorship.
Princeton Tech Report,
http://www.princeton.edu/~chiangm/anticensorship.pdf, 2012.
297[17] M. Marquis-Boire et al. Planet Blue Coat: Mapping Global
Censorship and Surveillance Tools. https://citizenlab.org/wp-
content/uploads/2013/01/Planet-Blue-Coat.pdf, 2013.
[18] Z. Nabi. The Anatomy of Web Censorship in Pakistan. In
FOCI, 2013.
[19] Open Net Initiative. Internet Filtering in Syria.
https://opennet.net/research/proﬁles/syria, 2009.
[20] J. C. Park and J. R. Crandall. Empirical Study of a
National-Scale Distributed Intrusion Detection System:
Backbone-level Filtering of HTML Responses in China. In
ICDCS, 2010.
[21] Reporters Without Borders. Syria.
http://en.rsf.org/syria-syria-12-03-2012,42053.html, 2012.
[22] V. Silver. H-P Computers Underpin Syria Surveillance.
http://www.bloomberg.com/news/2011-11-18/hewlett-
packard-computers-underpin-syria-electonic-surveillance-
project.html, 2011.
[23] Telecomix. #OpSyria: Syrian Censorship Logs (Season 3).
http://reﬂets.info/opsyria-syrian-censoship-log/, 2011.
[24] The Tor Project. Tor’s Censorship Wiki – Syria.
https://trac.torproject.org/projects/tor/wiki/doc/OONI/
censorshipwiki/CensorshipByCountry/Syria, 2013.
[25] J. Valentino-Devries, P. Sonne, and N. Malas. U.S. Firm
Acknowledges Syria Uses Its Gear to Block Web.
http://preview.tinyurl.com/kvpkeos, 2011.
[26] J.-P. Verkamp and M. Gupta. Inferring Mechanics of Web
Censorship Around the World. In FOCI, 2012.
[27] VFM Systems & Services Ltd. Blue Coat ProxySG Solution
with Web Filter and Reporter.
http://www.slideshare.net/vfmindia/vfm-bluecoat-proxy-sg-
solution-with-web-ﬁlter-and-reporter, 2013.
[28] Whittaker, Z. Surveillance and censorship: Inside Syria’s
Internet. http://www.cbsnews.com/news/surveillance-and-
censorship-inside-syrias-internet/, 2013.
[29] P. Winter and S. Lindskog. How the Great Firewall of China is
Blocking Tor. In FOCI, 2012.
[30] X. Xu, Z. M. Mao, and J. A. Halderman. Internet censorship
in China: Where does the ﬁltering occur? In PAM, 2011.
[31] T.-F. Yen, Y. Xie, F. Yu, R. Yu, and M. Abadi. Host
Fingerprinting and Tracking on the Web: Privacy and Security
Implications. NDSS, 2012.
298