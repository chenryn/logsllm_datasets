**新变种与既有mirai僵尸网络在bot列表上也有一定覆盖交叉**
整体四个端口 23/2323/5555/7547 的botIP列表也有一定交叉覆盖。
可以看出：
1.主要的bot还是仅仅扫描23端口上，占了79%；加上顺带扫描2323端口的11%、以及仅仅扫描2323端口的6.4%，共计96.4%，这占据了当前mirai僵尸网络的绝对大头；
2.仅仅扫描 7547 端口的bot有 3.1%，考虑到当前这个端口上仅工作了3天，mirai的在这个端口上感染速度仍然是惊人的；
3.其他交叉扫描的所有bot合并攻击占据0.5%，目前仍然不是主体。
**  
**
**新变种的设备特性**
我们汇总了手头所有7547相关的botIP列表，共计46653个。我们尝试读取这些IP的设备型号，共计获得了5976个回应。这里的样本耗损比较大，我们反复尝试了多次，相信可以排除网络抖动情况，剩下的损耗我们归因为mirai；也许是因为设备上的开放端口被mirai关闭，也许是因为设备当时网络忙。
我们筛选了返回的5976个回应中个数超过10个的细分类，列出他们的生产厂商（打码）、型号列表如下。
我们的确建议这些厂商联合他们的客户一起对上述情况做出适当响应以减轻mirai的危害程度，但同时仍然必须强调这些只是我们能够看到的冰山一角，也许还需要更多其他设备厂商一起来做更多的网络安全工作。
**  
**
**相关安全公告**
2016-11-07，kenzo/kenzo2017在devicereversing.wordpress.com上发布了一个TR-064相关的安全公告。原文见：
[https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/)
理解该公告的技术细节有助于理解mirai新变种的行为。 公告中公开了Eir D1000
Modem的一个配置错误和一个命令注入问题。该配置错误使得原本仅应该暴露在LAN一侧的TR-064协议栈暴露在了WAN一侧；而对命令注入手段的充分利用可以使得攻击者完全接管设备。
Eir D1000
Moden向互联网暴露了端口7547。该端口上运行了两组协议，TR-069和TR-064，前者设计为在WAN上运行，而后者仅设计为在LAN侧运行。正常情况下在互联网上无法与TR-064协议栈交互，但是由于该设备的错误配置，该协议栈被暴露在WAN上，形成一个攻击面。
公告中提及，在该设备上可以执行TR-064中的多个命令，包括获取设备信息、获取设备WiFi密码、获取设备SSID/MAC、设定时间服务器等等。特殊的，在设定时间服务器的时候存在一个命令注入漏洞，利用该漏洞可以执行该设备上busybox的诸多命令，比如可以设定iptables来关掉设备上80端口管理员界面的防火墙。而要命的是，管理员界面的登录密码，就是前面提到可以获取的设备WiFi密码。
组合使用上述配置错误/漏洞，可以使得攻击者在WAN侧获得设备的完全控制权。Kenzo在公告中给出了一个利用的概念验证。
该公告中还有其他若干槽点可看。不过我们的注意力集中在网络侧的技术特征，包括：
1.开放端口为7547，这意味着新变种的bot需要发起针对该端口的扫描。
2.体系架构为MIPS。概念验证中提到的两个Targets分别是MIPS的大端和小端。
另外在安全社区的其他信息源中，我们了解到端口5555上也同样运行了TR-069/TR-064协议，并且有其他mirai变种开始扫描了上述端口。我们的数据中，映证了以上关于端口5555/7547的说法。
**  
**
**新mirai变种的感染和植入过程**
新变种的感染和植入过程已经被安全社区广泛讨论，例如下面的这篇文章，这里不再赘述，读者可以自行扩展阅读。 
值得一提的有这么一些地方：
新变种的样本覆盖了多个平台，如下列表:在诸多解释中，我们选择相信这可能反映了攻击者的工程环境比较成熟，攻击者已经拥有较为成熟的交叉编译工程环境，新的扫描方式出现后顺手就编译了多种平台样本。
精简所使用的弱口令集合 这一变种里，针对23/2323 端口弱口令字典已经精简到了3条。
root xc3511
root vizxv
root admin
对照下表中已经公开的弱口令可知，前述第一对弱口令是针对雄迈设备的；第二对是针对大华设备的。第三条适用范围较广，没有明确的指向性。
我们相信从攻击者的角度看来，对比之前的约60对弱口令，当前的三对弱口令在覆盖率上不会有多少损失，但是扫描速度方面会有很大提高。
**  
**
**附录**
IOC, MD5
    dc2464aefa7ba00eeccbd18baceeb9e9  
    a4487a7b2040de43ba3e0d7468f070c7  
    238a67e6f9b129680b618a3c579a8c6c  
    a490bb1c9a005bcf8cfe4bdffe7b991f  
    0dd3e7899183e93e5967e87ac6ea48a9  
    83bb43a36c49496a96f41926d80ec97d  
    99f9e7c6d7786555a7d067220b3c0d7d  
    a00a630b5f2c5e142f35c9df7df9f919  
    b6e0b8327fa3ab5abe761fb627a9cba1
域名
    kernelorg[.]download  
    update[.]kernelorg[.]download  
    securityupdates[.]us  
    check[.]securityupdates[.]us  
    rep[.]securityupdates[.]us  
    timeserver[.]host  
    ntp[.]timeserver[.]host  
    ocalhost[.]host  
    l[.]ocalhost[.]host