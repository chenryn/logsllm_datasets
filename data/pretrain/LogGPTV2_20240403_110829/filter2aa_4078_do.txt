SYN 同步 请求使用新的序列号进行同 步
FlN 结束 请求对 TCP 会话的正常关闭
另一个重要的细节是， 在 E 报头协议字段中 ， 表示 TCP 的值为 6(Ox06)。 协议宇段值是在每个
IP 数据包中都能找到的标签或标志， 它告知接收系统所接收数据包的类型。 E 报头的协议字段指示
下一个封装协议的标识， 也就是来自 当前协议层的载荷包含的协议(例如， ICMP 或 IGMP)或上一层
的协议(例如， TCP 或 UDP )。 想象一下从深冻冰箱取出用 肉店包装纸包装的未知肉数据包上的标签。
如果没有标签， 那么不得不打开肉数据包来查看包裹的是什么肉。 但是， 如果有标签， 那么就可以
快速查找或过滤自 己感兴趣的 肉制品 。 要想了解其他协议宇段值， 访问 www.iana.orglassignments/
protocol_ numbers。
不熟练的攻击者纠缠真正的安全人员
这是记住 8个TCP 报头 中至少最后 6 个标志仕的好方法。 第 一和第二个标志位(CWR 和 ECE)
现在很少使用 ， 因此通常被忽咯/忽视。 然而， 最后的 6 个标志位(URG、 ACK、 PHS、 邸T、 SYN
和 FIN)在今天仍很常见并被广泛使用 。
请记住， 这 8 个标志位是 8 个二进制位直(即一个字节)， 可以用任何十六进制或二进制格式显
示。 例如， Ox12是字节 0001001 0 的十 六进制表示。 这个特定字节 的排列表明 第 4 个和第 7 个标志
位被启用 。 通过标志位的设计(制每个标志住一个字母， 留 下 CWR 和 ECE 并用 双 取代它们)，
XXUAPRSF 是 OOOAOOSO， 或设直 SYN/ACK 标志位。 注意: 在 TCP报头标志位字节的十六进制表
示通常在数据包捕获工具的原始数据显示栏显示， 如 Wireshark， 在偏移位直 Ox2F。 这是一个基于
标准的 以 太网 II 型 的报头 ， 是一个标准的 20 字 节 的 E 头 ， 也是一个标准的 TCP 报头。
可以通过使用 短语 "不熟练的攻击者纠缠真正的安全人员" 来记住这个标志的顺序 ， 其中每个
单词 的 第 一个字母对应标志位 3到8 的 第 一个字母。
@ 真实场景
协议发现
在任何时候， 典型 的 TCPIIP 网 络都会使用数百种协议。 可以使用嗅探器来发现当前网络中所应
用 的协议。 但是， 在使用 嗅探器之前， 必须确保具有适 当 的特权或投权。 如果没有获得批准， 那 么
使用 嗅探器就会被视为像窃听未受保护的 网络通信一样的安全违规行为 。 如果在工作中 不能获得特
权， 那 么可以在家庭网络上进行尝试。 首先， 下载和安装嗅探器， 例如 Wireshark. 随后 ， 使用 嗅探
器监拉网络上的活动， 看看在家庭网络上能够发现多 少被应用 的协议(也就是 TCPIIP 的子协议)。
309
310
CISSP 官方学习指南(第 7 版)
使用嗅探器的 另 一个步骤是分析被捕获数据 包的内容。 选择一些不同的协议数据包， 并且查看
它们的报头。 找到 TCP、 ICMP、 ARP 和 UDP 数据包， 比较各自报头 的 内 容。 尝试定住这些协议使
用 的特殊标记或字段编码。 你可能会发现在协议中 存在许多 自 己 以 前不知道的信息。
用户数据报协议归DP)也在 OSI 模型的第 4 层(传输层)上运作 ， 它是一种无连接的、 "尽力而为
的 " 通信协议。 UDP 不提供错误检测或纠正， 不使用序列， 不使用流量控制机制 ， 不使用预先建立
的会话， 并且被认为是不可靠的。 UDP 具有极低的系统开销， 因此能够快速传输数据。 不过， 只 有
在数据传输并非绝对必要时， 我们才会使用 山P。 用于音频和/或视频的实时或流式通信经常会使
用 UDP。 在 IP 报头协议宇段中 ， 表示 UDP 的值为 1 7(Ox l l) 。
前面曾 经提到过， 与 TCP 报头相 比， UDP 报头相对简单 。 UDP 报头的长度为 8 个字节(64 位)。
UDP 头被分为 4 个部分或字段(每个 1 6 位长):
· 源端 口
• 目 的端 口
• 报文长度
• 校验和
2. 网络层协议和 I P 网络基础
TCP/IP 协 议族中的另一个重要协议在 OSI 模型的网络层上运作， 这种协议就是网际层协议(IP)o
E 为数据包提供了路由寻址。 路由寻址是全球性互联网通信的基础， 这是因为它提供了 身份标识手
段并规定了传输路径。 与 UDP 类似， IP 是无连接的、 不可靠的数据报服务。 E 不保证传送数据包
或 以正确顺序传送数据包， 并且不保证只进行一次传送。 因此， 必须在 E 上使用 TCP ， 从而获取可
靠 的和受控的通信 会话 。
IPv4 与 IPv6
IPv4 是全世界范 围 内 最广泛应用 的 网络协议版本。 不过， 新版本 IPv6 主要替代和改善了 网络
寻址和各由。 IPv4 使用 32 位的寻址模式， 而 IPv6 则何有 128 住进行寻址。 IPv6 提供了 许多 在 IPv4
中 不可用 的新功能。 IPv6 的一些新功能包括作用 域地址、 自 动配直和 QoS 优先值。 作用 域地址使管
理员 能够进行分组以及随后阻止或九许对网络服务(例如， 文件服务器或打印)的访问 。 自 动配直排
除了对 DHCP 和 NAT 的 需求。 QoS 优先值九许基于优先顺序 内 容来管理通信 。
2000 年以后发布的大多数操作 系统既可以 直接支持也可以通过插件支持 IPv6. 但是， 人们接受
IPv6 的 速度缓慢。 大多数 IPv6 网络目 前都部署在大公 司 、 研究 实验室或大学 内 。
IP 等级
任何安全专业人员都必须了 解 E 寻址和 E 等级的基础知识。 如果对 E 寻址、 子网划分、 等级
以及其他相关主题还比较陌生， 那么就需要花费一定的时间进行相应的学习 。 表 1 1 .3 和表 1 1 .4 概述
了 E 等级与默认子网的关键细节。 完整的 A 类子网可以支持 16777 214 台主机， 完整的 B 类子网
可 以支持 65 534 台主机， 而完整的 C 类子网则可以支持 254 台主机。 D 类子网被用于多擂， E 类子
网被保留给将来使用 。
第 11 章 网络安全架构与保护网络组件
表 1 1 .3 IP 等级
等级 开头的二进制数字 第一个字节的十进制范围
A 。 1-126
B 10 1 28-191
C 1 1 0 1 92-223
D 111 0 224-239
E 1111 240-255
表 1 1 .4 IP 等级默认的子网掩码
等级 默认的子网掩码 相当的 CIDR
A 255 .0.0.0 /8
B 255.255.0.0 /16
C 255.255.255.0 /24
注意， 全部的 A 类地址中 ， 整个 1 27 段被用来留给环路地址 ， 尽管实际中 只 使用 了一个环路
地址。
子网划分的另一个选项是使用无类域间路由选择(Classless Inter-Domain Routing， CIDR)o CIDR
没有使用采用完整点分十进制表示法的子网掩码， 而是使用掩码位。 因此， CIDR 通过斜线被添加
在 IP 地址之后， 例如， 使用 1 72. 16. 1.1/16 代替 255.255.0.0。 与传统的子网掩码技术相比 ， CIDR 的
一个重要优点是能够将多个不相邻的地址集组合在单个子网 内 。 例如， 我们可以将若干 C 类子网组
合为一个更大的子网分组。 如果对 CIDR 感兴趣， 那么可以在维基百科站点上通过查看 CIDR 文章
来获得详细信息 ， 或者访 问 IETF 关于 CIDR 的 盯C 文档(http://tools.ietf.org/html/rfc4632)。
ICMP 和 IGMP 是运行于 OSI 模型网络层上的其他协议。
ICMP 网络控制报文协议(IC趴在P)用于确定某个网络或特定链接的健康状况。 pmg、 trac巳route、
pathping 以及其他网络管理工具都利用 了 ICMPo ping 实用程序利用 了 ICMP 的 回应(echo)命令数据
包， 并且使用它们对远程系统进行试探。 因此， 可 以使用 pmg 来确定远程系统是否联机、 远程系统
是否正常响应、 中间系统是否支持通信以及支持通信的中间系统的性能效率级别。 ping 实用程序包
括重定向功能， 这个功能 允许将回 应响应发送至与原始系统不 同 的 目 的地。
遗憾的是， IC岛。 的功能往往被各种基于带宽的拒绝服务攻击所利用 ， 例如， ping ofd白白 攻击、
smurf攻击和 pmg洪泛攻击。这个事实已经形成今天的网络如何处理 I巳阳流量， 导致许多使用 IC陋
的网络限制或至少限制， 其吞吐率。ping of death 攻击发送一个畸形的大于 65 535 字节(大于最大 IPv4
数据包大小)的数据包给一台计算机并试图让其崩溃。 smurf攻击通过欺骗广播 ping 对 目 标网络产生
巨大的流量， pmg 数据包泛洪攻击是一个基本的拒绝服务。)oS)攻击， 它消耗 目标可用的所有带宽。
你应当认识到与 ICMP 相关的一些重要细节 。 首先， IP 报头协议宇段中表示 ICMP 的值为
I (OxOl )。 其次， IC1v1P 报头中的类型宇段定义了 IC1v1P 载荷 内所包含报文的类型或 目 的。 可定义的
类型超过 40 种， 但是只 有 7 种是常用的类型(参看表 1 1.5)。 可 以在WWW.lanaαg/assignments/icmpP缸ameters 站点上查看 IC1v1P 类型宇段值的完整列表。 值得注意的是， 列出的许多类型可能也支持
编码。 编码只是额外的数据参数， 这种参数能够提供与 ICMP 报文载荷的功能或目 的相关的更多细
节 。 一个事件会导致一个 IC1v1P 响应的一个例子是， 当尝试连接到 UDP 服务端 口 时， 服务和端 口不
311
CISSP 官方学习指南(第 7 版)
在 目 标服务器上实际使用 ; 这会导致一个 ICMP 类型 3 响应被发送回 原点 。 由于 UDP 没有手段发送
错误， 协议枝将切换使用 ICMP 完成该任务。
312
表 1 1 .5 常用 的 ICMP 类型字段值
类型 功能
。 回 声应答
3 目 的地不可到达
5 重定向
8 回声请求
9 路由器通告
10 路由器请求
11 超时
IGMP 网络组管理协议(IGMP)允许系统支持多播。 多播是将数据传输给多个特定的接收者
(盯C 1112 讨论了执行 IGMP 多播操作的要求)0 IP 主机使用 IGMP注册其动态的多播组成员 。 己连
接的路由器也使用 IGMP 来发现这些组。 通过使用 IGMP 多播操作， 服务器在一开始就可以只传输
单个数据信号 ， 从而不必为每个预定的接收者分别传输数据信号 。 借助于 IGMP， 如果数据到达预
定接收者的路径有分叉， 那么最初的单个信号就会在路由器处被复用 。 IP j:1i头协议宇段中表示 IGMP
的值为 2(Ox02)。
ARP 与反向 ARP 对于逻辑和物理寻址模式的互操作性来说， 地址解析协议僻的与反向地址
解析协议(RARP)是必不可少的 。 ARP 用于将 E 地址(用于逻辑寻址的 32 位二进制数)解析为介质访
问控制φ1AC)地址(用于物理寻址的 48 位二进制数)一一或者 EUI-48一→甚至 EUI-64。 通过使用 MAC
地址， 某个网段上(例如， 通过一个集线器的线缆)的通信从源系统定向至 目 的系统。 RARP 用 于将
MAC 地址解析为 IP 地址。
ARP 和 RARP 的运作都需要使用缓存和广播 。 将 E 地址解析为 MAC 地址(或者将 MAC 地址