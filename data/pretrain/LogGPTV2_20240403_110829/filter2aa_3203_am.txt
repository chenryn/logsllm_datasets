For IPv6-based dial-up connections, the user is assigned a 64-bit prefix after the connection is made 
through router discovery and stateless address autoconfiguration. If the interface identifier is always 
based on the EUI-64 address (as derived from the static IEEE 802 address), an attacker can identify 
the traffic of a specific node regardless of the prefix, making it easy to track specific users and how they 
Chapter 3 – IP Addressing 
TCP/IP Fundamentals for Microsoft Windows  
Page: 80 
use the Internet. To address this concern and provide a level of anonymity, RFC 4941 describes an 
alternative IPv6 interface identifier that is randomly generated and changes over time. 
The initial interface identifier is generated by using random numbers. For IPv6 systems that cannot 
store any historical information for generating future interface identifier values, a new random interface 
identifier is generated each time the IPv6 protocol is initialized. For IPv6 systems that have storage 
capabilities, a history value is stored and, when the IPv6 protocol is initialized, a different interface 
identifier is created through the following process: 
1. Retrieve the history value from storage, and append the interface identifier based on the EUI-64 
address of the adapter.  
2. Compute the Message Digest-5 (MD5) hash algorithm over the quantity in step 1. A hash produces a 
fixed size mathematical result from an input. Hashes are easy to compute, but it is computationally 
difficult to determine the input from the hash result. 
3. Save the last 64 bits of the MD5 hash computed in step 2 as the history value for the next interface 
identifier computation.  
4. Take the first 64 bits of the MD5 hash computed in Step 2, and set the seventh bit to 0. The seventh 
bit corresponds to the U/L bit, which, when set to 0, indicates a locally administered IPv6 interface 
identifier. The result is the IPv6 interface identifier.  
The resulting IPv6 address, based on this random interface identifier, is known as a temporary address. 
Temporary addresses are generated for public address prefixes that use stateless address 
autoconfiguration.  
IPv6 Multicast Addresses 
IPv6 multicast addresses have the first eight bits fixed at 1111 1111. Therefore the address prefix for all 
IPv6 multicast addresses is FF00::/8. Beyond the first eight bits, multicast addresses include additional 
structure to identify flags, their scope, and the multicast group. Figure 3-18 shows the structure of the 
IPv6 multicast address. 
Figure 3-18  The structure of the IPv6 multicast address 
The fields in the multicast address are: 
Flags 
Indicates flags set on the multicast address. The size of this field is 4 bits. RFC 4291defines the 
Transient (T) flag, which uses the low-order bit of the Flags field. When set to 0, the T flag indicates 
that the multicast address is a permanently assigned (well-known) multicast address allocated by 
the IANA. When set to 1, the T flag indicates that the multicast address is a transient (non-
permanently-assigned) multicast address.  
Scope 
Chapter 3 – IP Addressing 
TCP/IP Fundamentals for Microsoft Windows  
Page: 81 
Indicates the scope of the IPv6 network for which the multicast traffic must be delivered. The size of 
this field is 4 bits. Routers use the multicast scope and information provided by multicast routing 
protocols to determine whether multicast traffic can be forwarded. 
RFC 4291 defines the values for the Scope field. The most prevalent values for the Scope field are 
1 (interface-local scope), 2 (link-local scope), and 5 (site-local scope). 
Group ID 
Identifies the multicast group and is unique within the scope. The size of this field is 112 bits. 
Permanently assigned group IDs are independent of the scope. Transient group IDs are relevant 
only to a specific scope. 
To identify all nodes for the interface-local and link-local scopes, the following addresses are defined: 
FF01::1 (interface-local scope, all-nodes multicast address) 
FF02::1 (link-local scope, all-nodes multicast address) 
To identify all routers for the interface-local, link-local, and site-local scopes, the following addresses 
are defined: 
FF01::2 (interface-local scope, all-routers multicast address) 
FF02::2 (link-local scope, all-routers multicast address) 
FF05::2 (site-local scope, all-routers multicast address) 
For the current list of permanently assigned IPv6 multicast addresses, see 
http://www.iana.org/assignments/ipv6-multicast-addresses. 
IPv6 multicast addresses replace all forms of IPv4 broadcast addresses. The link-local scope, all-nodes 
multicast address (FF02::1) in IPv6 replaces the IPv4 network broadcast address (in which all host bits 
are set to 1 in a classful environment), the subnet broadcast address (in which all host bits are set to 1 
in a classless environment), and the limited broadcast address (255.255.255.255). 
For more information about IPv6 multicast addresses and processes, see Appendix A, "IP Multicast." 
Solicited-Node Multicast Address 
The solicited-node multicast address facilitates the efficient querying of network nodes to resolve a link-
layer address from a known IPv6 address, known as link-layer address resolution. In IPv4, the ARP 
Request frame on Ethernet and 802.11 wireless network segments is sent to the broadcast address 
0xFF-FF-FF-FF-FF-FF. This frame disturbs all nodes on the network segment, including those that are 
not running IPv4. IPv6 uses the Neighbor Solicitation message to perform link-layer address resolution. 
However, using the local-link scope, all-nodes multicast address as the Neighbor Solicitation message 
destination would disturb all IPv6 nodes on the local link, so the solicited-node multicast address is 
used. The solicited-node multicast address is constructed from the prefix FF02::1:FF00:0/104 and the 
last 24 bits of a unicast IPv6 address. Figure 3-19 shows the mapping of a unicast IPv6 address to its 
corresponding solicited-node multicast address. 
Chapter 3 – IP Addressing 
TCP/IP Fundamentals for Microsoft Windows  
Page: 82 
Figure 3-19  Creating the solicited-node multicast address 
For example, Node A is assigned the link-local address of FE80::2AA:FF:FE28:9C5A and is also 
listening on the corresponding solicited-node multicast address of FF02::1:FF28:9C5A. (The underlines 
highlight the correspondence of the last six hexadecimal digits.) Node B on the local link must resolve 
Node A’s link-local address FE80::2AA:FF:FE28:9C5A to its corresponding link-layer address. Node B 
sends a Neighbor Solicitation message to the solicited-node multicast address of FF02::1:FF28:9C5A. 
Because Node A is listening on this multicast address, it processes the Neighbor Solicitation message 
and replies with a unicast Neighbor Advertisement message, completing the address resolution 
process. 
By using the solicited-node multicast address, link-layer address resolution, a common occurrence on a 
link, does not disturb all network nodes. As a result, very few nodes are disturbed during address 
resolution. In practice, the relationship between the link-layer address, the IPv6 interface ID, and the 
solicited-node address allows the solicited-node address to act as a pseudo-unicast address for very 
efficient address resolution. 
IPv6 Anycast Addresses 
An anycast address is assigned to multiple interfaces. The routing structure forwards packets 
addressed to an anycast address so that they reach the nearest interface to which the anycast address 
is assigned. To facilitate delivery, the routing infrastructure must be aware of the interfaces assigned 
anycast addresses and their “distance” in terms of routing metrics. At present, anycast addresses are 
used as destination addresses only. Anycast addresses are assigned out of the unicast address space, 
and their scope matches that of the type of unicast address from which the anycast address is 
assigned. 
The Subnet-Router anycast address is created from the subnet prefix for a given interface. To construct 
the Subnet-Router anycast address, you fix the bits in the 64-bit subnet prefix at their appropriate 
values, and you set to 0 the bits in the Interface ID portion of the address. All router interfaces attached 
to a subnet are assigned the Subnet-Router anycast address for that subnet. The Subnet-Router 
anycast address can be used to communicate with one of multiple routers attached to a remote subnet, 
for example, to obtain network management statistics for traffic on the subnet. 
IPv6 Addresses for a Host 
An IPv4 host with a single network adapter typically has a single IPv4 address assigned to that adapter. 
An IPv6 host, however, usually has multiple IPv6 addresses—even with a single interface. An IPv6 host 
is assigned the following unicast addresses: 
A link-local address for each interface. 
Chapter 3 – IP Addressing 
TCP/IP Fundamentals for Microsoft Windows  
Page: 83 
Unicast addresses for each interface (which could be a site-local address and one or multiple global 
unicast addresses). 
The loopback address (::1) for the loopback interface. 
IPv6 hosts typically have at least two addresses with which they can receive packets—a link-local 
address for local link traffic and a routable site-local or global address. 
Additionally, each host listens for traffic on the following multicast addresses: 
The interface-local scope, all-nodes multicast address (FF01::1). 
The link-local scope, all-nodes multicast address (FF02::1). 
The solicited-node address for each unicast address on each interface. 
The multicast addresses of joined groups on each interface. 
IPv6 Addresses for a Router 
An IPv6 router is assigned the following unicast and anycast addresses: 
A link-local address for each interface. 
Unicast addresses for each interface (which could be a site-local address and one or multiple global 
unicast addresses). 
A Subnet-Router anycast address. 
Additional anycast addresses (optional). 
The loopback address (::1) for the loopback interface. 
Additionally, each router listens for traffic on the following multicast addresses: 
The interface-local scope, all-nodes multicast address (FF01::1). 
The interface-local scope, all-routers multicast address (FF01::2). 
The link-local scope, all-nodes multicast address (FF02::1). 
The link-local scope, all-routers multicast address (FF02::2). 
The site-local scope, all-routers multicast address (FF05::2). 
The solicited-node address for each unicast address on each interface. 
The multicast addresses of joined groups on each interface. 
Chapter 3 – IP Addressing 
TCP/IP Fundamentals for Microsoft Windows  
Page: 84 
Comparing IPv4 and IPv6 Addressing 
Table 3-5 lists IPv4 addresses and addressing concepts and their IPv6 equivalents. 
IPv4 Address 
IPv6 Address 
Internet address classes 
Not applicable in IPv6 
IPv4 multicast addresses (224.0.0.0/4) 
IPv6 multicast addresses (FF00::/8) 
Broadcast addresses: network broadcast, subnet 
broadcast, all-subnets directed broadcast, limited 
broadcast 
Not applicable in IPv6 
Unspecified address is 0.0.0.0 
Unspecified address is :: 
Loopback address is 127.0.0.1 
Loopback address is ::1 
Public IPv4 addresses 
Global unicast addresses 
Private IPv4 addresses (10.0.0.0/8, 172.16.0.0/12, and 
192.168.0.0/16) 
Site-local addresses (FEC0::/10) 
APIPA addresses (169.254.0.0/16) 
Link-local addresses (FE80::/64) 
Address syntax: dotted decimal notation 
Address syntax: colon hexadecimal format with 
suppression of leading zeros and zero compression. 
Embedded IPv4 addresses are expressed in dotted 
decimal notation. 
Address prefix syntax: prefix length or dotted decimal 
(subnet mask) notation 
Address prefix syntax: prefix length notation only 
Table 3-5  Comparing IPv4 and IPv6 Addressing 
Chapter 3 – IP Addressing 
TCP/IP Fundamentals for Microsoft Windows  
Page: 85 
Chapter Summary 
The key information in this chapter is the following: 
You express IPv4 addresses in dotted decimal format. You express IPv4 address prefixes as a dotted 
decimal form of the starting address with the prefix length indicated by either an integer number or a 
dotted decimal number, also known as a subnet mask. 
IPv4 uses unicast addresses to deliver a packet from one source to one destination, multicast 
addresses to deliver a packet from one source to many destinations, and broadcast addresses to 
deliver a packet from one source to every destination on the subnet. 
For IPv4, you can use public unicast addresses (if assigned by ICANN or an ISP) or private addresses 
(10.0.0.0/8, 172.16.0.0/12, or 192.168.0.0/16). The TCP/IP components of Windows use APIPA 
addresses to automatically configure hosts with addresses from the 169.254.0.0/16 address prefix on a 
single subnet. 
You express IPv6 addresses in colon hexadecimal format, suppressing leading zeros and compressing 
a single set of contiguous blocks of zeros using double colon notation. You express IPv6 address 
prefixes as a colon hexadecimal form of the starting address with a prefix length. 
IPv6 uses unicast addresses, multicast addresses, and anycast addresses to deliver a packet from one 
source to one of many destinations. 
For unicast IPv6 addresses, you can use global addresses (if they are assigned by IANA or an ISP), 
site-local addresses (FEC0::/10), or link-local addresses (FE80::/64). Link-local addresses require you 
to specify a zone ID to identify the link for a destination. Site-local addresses require you to specify a 
zone ID to identify the site for a destination if you are using multiple sites. 
You typically derive IPv6 interface identifiers from IEEE 802 addresses or IEEE EUI-64 addresses. 
The solicited-node multicast address is a special multicast address used for efficient link-layer address 
resolution on a subnet. 
Chapter 3 – IP Addressing 
TCP/IP Fundamentals for Microsoft Windows  
Page: 86 
Chapter Glossary 
address – An identifier that is assigned at the Internet layer to an interface or a set of interfaces and 
that identifies the source or destination of IP packets. 
address class – A predefined grouping of IPv4 addresses used on the Internet. Addresses classes 
defined networks of specific sizes and determined the range of numbers that can be assigned for the 
first octet in the IPv4 address. Classless Inter-Domain Routing (CIDR) has made classful IPv4 
addressing obsolete. 
address prefix – An address range that is defined by setting high-order fixed bits to defined values and 
low-order variable bits to 0. Address prefixes are routinely used to express a range of allowable 
addresses, subnet prefixes assigned to subnets, and routes. In IPv4, you express address prefixes in 
prefix length or dotted decimal (subnet mask) notation. In IPv6, you express address prefixes in prefix 
length notation. 
anycast address – An address that is assigned from the unicast address space, identifies multiple 
interfaces, and is used to deliver packets from one source to one of many destinations. With the 
appropriate routing topology, packets addressed to an anycast address are delivered to the nearest 
interface that has the address assigned.  
APIPA – See Automatic Private IP Addressing (APIPA). 
Automatic Private IP Addressing (APIPA) – A feature of the TCP/IP component in Windows 
Server 2003 and Windows XP. APIPA enables a computer to autoconfigure an IPv4 address and 
subnet mask from the range 169.254.0.0/16 when the TCP/IP component is configured for automatic 
configuration and no DHCP server is available. 
CIDR – See Classless Inter-Domain Routing (CIDR). 
Class A IPv4 address – A unicast IPv4 address that ranges from 1.0.0.1 through 127.255.255.254. The 
first octet indicates the address prefix, and the last three octets indicate the host ID. Classless Inter-
Domain Routing (CIDR) made classful IPv4 addressing obsolete. 
Class B IPv4 address – A unicast IPv4 address that ranges from 128.0.0.1 through 191.255.255.254. 
The first two octets indicate the address prefix, and the last two octets indicate the host ID. Classless 
Inter-Domain Routing (CIDR) made classful IPv4 addressing obsolete. 
Class C IPv4 address – A unicast IPv4 address that ranges from 192.0.0.1 to 223.255.255.254. The 
first three octets indicate the address prefix, and the last octet indicates the host ID. Classless Inter-
Domain Routing (CIDR) made classful IPv4 addressing obsolete. 
Classless Inter-Domain Routing (CIDR) – A technique for aggregating routes and assigning IPv4 
addresses on the modern-day Internet. CIDR expresses address prefixes in the form of an address 
prefix and a prefix length, rather than in terms of the address classes that CIDR replaces. 
colon hexadecimal notation – The notation used to express IPv6 addresses. The 128-bit IPv6 address 
is divided into eight 16-bit blocks. Each block is expressed as a hexadecimal number, and adjacent 
blocks are separated by colons. Within each block, leading zeros are suppressed. An example of an 
IPv6 unicast address in colon hexadecimal notation is 2001:DB8:2A1D:48C:2AA:3CFF:FE21:81F9. 
Chapter 3 – IP Addressing 
TCP/IP Fundamentals for Microsoft Windows  
Page: 87 
dotted decimal notation – The notation most commonly used to express IPv4 addresses. The 32-bit 
IPv4 address is divided into four 8-bit blocks. Each block is expressed as a decimal number, and 
adjacent blocks are separated by periods. An example of an IPv4 unicast address in dotted decimal 
notation is 131.107.199.45. 
double colon – The practice of compressing a single contiguous series of zero blocks of an IPv6 
address to “::”. For example, the multicast address FF02:0:0:0:0:0:0:2 is expressed as FF02::2. 
EUI – See Extended Unique Identifier. 