频繁，流动数据量大。一方面企业应通过系统日志准确记录和保存
接口数据共享的情况，定期审计，及时发现数据交换中存在的风险。
另一方面企业应部署自动化审计和溯源工具，对安全事件快速溯源、
精准定位，防止数据泄露，保护企业数据安全。
应用程序接口（API）数据安全蓝皮报告（2020 年）
31
3.内部 API 安全实践
（1）场景简介
除了开放到公网、面向合作方的 API 之外，企业内部的应用系
统通常也会通过内部 API 进行数据访问。此类 API 主要有 3 大特点。
一是众多应用系统衍生大量接口。企业内部存在众多应用系统，根
据业务功能的划分和用户群体的不同可能会衍生出诸多内部 API 接
口。二是接口调用群体庞杂。企业内部员工因所处的部门和层级不
同，存在不同业务需求和权限，造成 API 调用群体庞杂，为安全管
理带来一定挑战。三是接口参数由企业根据自身需求进行定义。企
业内部可能存在多种 API，需要根据内部人员对于业务功能的需求分
别进行定义。
（2）安全方案
与开放 API 接口一样，企业应梳理内部 API 现状，围绕内部 API
生命周期建立有效管理机制。内部 API 接口可能随内部业务频繁迭
代，企业也会引入新的系统或设备到内部网络，此时需额外关注内
部 API 的安全要求。此外，企业还应部署或强化相应技术手段对内
部 API 接口进行保护。一是 API 生命周期实时监控，二是加强身份
验证机制，三是建立敏感信息展示监测预警机制，四是建立账号风
险监测机制，五是数据行为威胁实时监控，六是敏感数据大量暴露
监测，七是特权账号行为实时监测和审计机制，八是自动化数据泄
露溯源追责。
应用程序接口（API）数据安全蓝皮报告（2020 年）
32
来源：全知科技（杭州）有限责任公司
API 生命周期实时监控：企业应在掌握内部接口现状的基础上，
在新 API 上线前进行安全评估，严格内部 API 接口变更管理，对失
活接口及时处理。接口现状发生改变应及时发布预警，并及时响应
和处理。
身份验证机制：身份认证是企业数据安全的第一道防线，企业
应从安全需求、成本和系统兼容性等方面进行综合考虑，选择如双
因素认证、强密码口令、生物识别信息等认证措施，完善内部 API
身份验证机制。
敏感信息展示监测预警机制：企业应在确保脱敏策略一致的基
础上，建立敏感信息明文展示监测预警机制，对内部 API 调用流量
进行实时监控，一旦监测到明文传输敏感信息、或者明文展示敏感
应用程序接口（API）数据安全蓝皮报告（2020 年）
33
信息的时候，及时进行预警。
账号风险监测机制：企业应建立账号风险监测机制。一方面，
监测是否存在单因素认证、弱密码、密码明文传输等脆弱性；另一
方面，建立账号登陆行为画像，总结用户常规登陆模式，发现账号
共享、借用、兼任等情况及时预警，并进一步排查。此外，账号风
险监测机制还可侦测境外 IP 访问内部 API 接口的情况，减少企业数
据出境的安全风险。
数据行为威胁实时监控：内部 API 可能存在水平越权、垂直越
权、账号滥用等风险，因此，企业应根据自身情况建立正常行为基
线，对短时间内大量获取敏感数据、访问频次异常、非工作时间访
问、敏感数据外发等异常行为进行监测，并防范网络爬虫等大量机
器拉取内部数据。
敏感数据大量暴露监测：企业应监测 API 接口单次返回敏感数
据量、敏感数据类型等情况，发现异常及时对接口进行改进。
特权账号行为监测和审计：企业应建立并严格执行特权账号行
为监测和审计机制，精确、细化特权账号行为基线。
自动化数据泄露溯源追责：通过线索溯源或者主体溯源模式进
行溯源追责，明确数据泄露途径、数据泄露类型、数据泄露规模和
数据泄露原因，并对源头责任人和可疑犯罪人进行锁定，及时缩小
犯罪嫌疑人范围，减少因数据泄露给企业、个人和社会造成的负面
影响。
应用程序接口（API）数据安全蓝皮报告（2020 年）
34
（二）观安 API 安全实践
1.安全方案
观安 API 数据安全检测方案通过对数据接口、虚拟网络边界接
口进行实时监控和分析，实现应用系统之间数据访问、传输、流转
及敏感数据检测，利用大数据分析技术构建数据接口活动轨迹、访
问操作画像，智能化判断业务系统、企业内外部数据接口之间的数
据流量异常、数据访问操作异常、数据接口调用异常等安全风险，
及时对数据接口异常事件进行预警，为应用系统业务数据安全流转、
调用、传输等操作访问行为提供数据安全保障。
来源：上海观安信息技术股份有限公司
一是梳理接口敏感级别，制定分级策略。梳理并发现应用系统
中涉及敏感数据流转的接口以及敏感数据暴露面，根据敏感数据类
型对应用系统接口进行敏感等级划分，针对不同敏感级别的接口制
定差异化访问控制策略。
二是建立深度分析系统，实现多维度风险评估。建立深度分析
系统，对数据接口异常流量、用户异常操作行为、异常调用等进行
实时监控、异常预警和集中的风险展示。对敏感数据访问接口进行
应用程序接口（API）数据安全蓝皮报告（2020 年）
35
多维度的脆弱性评估及风险识别，包括但不限于数据账号风险、数
据权限风险、数据操作风险、数据流向风险、数据暴露面风险、数
据脱敏风险等。
三是描绘行为轨迹，实现流动监控。基于流量数据识别应用系
统中的接口和用户账号信息，还原并记录用户的数据访问行为；对
业务系统账号信息的数据访问行为进行审计，从用户账户、接口、
数据访问和返回情况，完整描绘数据在应用系统中流转的地图，实
现对数据流动细节的监控。
2.技术手段
协议解析：通过获取网络中系统的数据包，并将其进行协议解
析，生成基础数据，识别的协议包括但不限于当前主流的系统访问
及接口协议。通过抓取的流量数据可对数据流动使用过程进行审计
操作，保证 API 内的数据流转安全性。
来源：上海观安信息技术股份有限公司
数据分类分级：分类分级定位到的数据标签信息、位置信息可
应用程序接口（API）数据安全蓝皮报告（2020 年）
36
以赋能到安全风险识别，结合流量数据准确实时的输出安全风险告
警，保障数据生命周期内的流动安全。同时分类分级可为 API 敏感
级别划分提供支撑，依据分类分级清单实现数据价值划分，为数据
差异化管控提供依据。
敏感数据识别：根据敏感级别划分，动态制定敏感数据识别规
则，通过规则分析自动识别未脱敏数据。
API 全盘发现：识别并建立 API 清单，对 API 进行可视化展现，
发现 API 漏洞。
 通过手动定义或 API 文件，建立 API 清单；
 通过日志或流量分析，发现 API 清单未覆盖的请求；
 对 API 活动做可视化展现；
 结合威胁情报库，发现有漏洞的 API 应用服务器。
来源：上海观安信息技术股份有限公司
API 可视化管控：登记汇总各系统中注册，添加、登记的接口服
务，实现对系统接口的汇总管理和可视化展示。
API 安全检测：API 安全检测是系统交互的屏障和保护伞，在接
应用程序接口（API）数据安全蓝皮报告（2020 年）
37
口具体的使用过程中，通过提前预设告警规则、防御规则，记录非
法操作、异常攻击等行为，匹配规则，实现防御阻断、告警，提高
单个系统接口服务的有效性及保证整个生态系统的安全性、稳定性，
为企业提供多重保障。
流量数据：通过协议解析，获取多系统接口行为记录，包括访
问的接口、访问的 URL、源/目的 IP、源/目的端口、访问时间及流
量等数据，为访问行为的安全审计、数据挖掘提供数据源。
审计告警：根据业务系统特点，对通过接口交互的敏感信息或
关键字进行识别、告警设置，生成审计规则，对匹配规则的敏感信
息进行相应操作，如区分日志类型（原始日志、重要日志、告警日
志）、进行有效报警（邮件、短信）等，为系统接口交互行为审计
提供及时预警及处理时间。
来源：上海观安信息技术股份有限公司
异常数据流动行为检测：从应用系统流量中提取用户访问行为
的原始数据，计算相关的基础指标,构建数据模型进行机器学习和大
数据分析，对数据访问建立行为基线，利用异常检测技术，从多个
维度来识别异常数据访问行为，从而实现异常数据访问行为和数据
泄露行为的感知和预警。
应用程序接口（API）数据安全蓝皮报告（2020 年）
38
回溯取证：对接口业务行为进行完整的记录，并支持接口访问
行为和事件回放取证。记录包括访问时间、访问者、访问凭据、访
问请求参数、返回数据等。
API 数据安全态势分析：通过海量接口行为数据，运用 Hadoop
大数据支撑平台，快速大批量接口行为分析，辅助安全管理员提前
预警阻断。
来源：上海观安信息技术股份有限公司
数据挖掘：对接口生命周期及接口的商业行为进行高效的梳理
和分析，通过采用分类模型、预测模型、关联模型、聚类模型、异
常值分析、协同过滤、文本挖掘等算法模型，为企业提供更优质的
商业价值。
3.实践应用
（1）背景
应用程序接口（API）数据安全蓝皮报告（2020 年）
39
某运营商安全行为管控主要依赖传统的业务系统日志、4A 访问
日志，数据来源单一，分析手段相互独立缺乏联动，缺少多维度分
析；对接口调用异常、业务行为中敏感数据自识别监控、数据操作
异常事件等新型事件，依赖现有传统审计方法无法有效识别和监测。
（2）应用
分析模块：分析业务流程包括数据采集、数据预处理、数据存
储、分析引擎、结果输出等步骤。
风险场景模型：分析平台和业务场景的深度耦合，对系统业务
风险点进行监测、控制，业务分析平台采用 2 套分析模型（机器行
为模型、风险评分卡模型）对 4 大业务场景（接口风险告警、主机
绕行告警、前台未授权查询信息、敏感数据操作监测）进行业务分
析。
接口异常行为监测：基于流量探针对流量数据进行采集，根据
接口小时段内容的接口类型、调用对象、访问时间间隔等数据维度
构建特征工程，通过机器学习分类算法如随机森林，建立异常识别