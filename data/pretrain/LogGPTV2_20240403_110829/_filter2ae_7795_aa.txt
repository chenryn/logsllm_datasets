# 一道无线流量题目引发的思考
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
学习一番IEEE 802.11后，从原理性角度分析一道无线流量的CTF题目。
在文章的开头处，先贴个[wireshark分析802.11协议的pdf链接](http://10.254.1.201:9999/www.willhackforsushi.com/papers/80211_Pocket_Reference_Guide.pdf)，可根据该文档所描述的内容快速过滤相应的数据包，这也是本文讲述如何使用wireshark学习分析IEEE802.11的帮助文档。不懂就翻翻咯~。本篇以一道ciscn2018的题目为引，从原理性分析学习IEEE802.11。
## 帧的基本类型
关于帧的基本类型，基本上大家也都知道三种类型（贴个[基础知识链接](http://drops.xmd5.com/static/drops/wireless-15128.html)，不大理解的先看其中无线网络基础知识部分），这里重点讲述下管理帧。
###  Management frame（管理帧）
该帧的所显示的数据包一般用于各个设备之间建立第二层的连接，提供认证和连接服务。
该帧又细分为下面14种类型，每种类型所对应的中文注释以及过滤语句均已呈现。
而在管理帧中，值得重要一提的是Beacon，俗称信标，Beacon就像广播一般，向周边的其他设备声明某AP的类型及配置信息。下面会详细分析该帧。
###  Control frames（控制帧）
协助数据帧的传递，控制数据帧和管理帧的发送。
###  Data frame (数据帧)
包含真正的传输数据，最重要的是它可以将数据从无线网络转发到有线网络。在wireshark中，如果AP是使用的是WEP或者WAP加密,Data
frame类型包，经过wireshark自带的解密功能wep、wpa-pwd、wpa-psk任意一种方法解密后，该类型数据包就会解析为更高层次的数据包，比如http数据包，在等会讲述的例题中，便与此相关。
## 管理帧中Beacon的具体分析
关于管理帧的具体分析，这里直接挑选Beacon来讲解。
为什么需要重点讲述Beacon呢？Beacon作为一个广播数据包，是一个AP向所有无线设备通知存在一个可用的AP，涵盖了一个AP大量的配置参数信息。另外，在IEEE802.11下，不同管理帧的具体内容和用途虽然不一样，但其他都与Beacon相似。下面即是一个Beacon的例子：
    Frame 1: 279 bytes on wire (2232 bits), 279 bytes captured (2232 bits) on interface 0
    Radiotap Header v0, Length 24
    802.11 radio information
    IEEE 802.11 Beacon frame, Flags: ........  -beacon广播包
        Type/Subtype: Beacon frame (0x0008)    -可使用wlan.fc.type_subtype == 0x0008过滤
        Frame Control Field: 0x8000            
            .... ..00 = Version: 0              
            .... 00.. = Type: Management frame (0) -帧类型为管理帧
            1000 .... = Subtype: 8                 
            Flags: 0x00
        .000 0000 0000 0000 = Duration: 0 microseconds
        Receiver address: Broadcast (ff:ff:ff:ff:ff:ff)
        Destination address: Broadcast (ff:ff:ff:ff:ff:ff)
        Transmitter address: Tp-LinkT_ca:13:df (30:fc:68:ca:13:df)         -传输mac地址
        Source address: Tp-LinkT_ca:13:df (30:fc:68:ca:13:df)          -源地址
        BSS Id: Tp-LinkT_ca:13:df (30:fc:68:ca:13:df)           -bssid
        .... .... .... 0000 = Fragment number: 0
        0110 1110 1011 .... = Sequence number: 11
    IEEE 802.11 wireless LAN           -IEEE 802.11帧信息
        Fixed parameters (12 bytes)            -固定参数
            Timestamp: 0x000000017752d876          -发送数据包的时间戳
            Beacon Interval: 0.102400 [Seconds]    -beacon数据包的重传间隔
            Capabilities Information: 0x0431       -Wap的硬件容量信息
        Tagged parameters (219 bytes)          -标记参数
            Tag: SSID parameter set: T35t          -ssid（网络名称） 
            Tag: Supported Rates 1(B), 2(B), 5.5(B), 11(B), 6, 9, 12, 18, [Mbit/sec]
            Tag: DS Parameter set: Current Channel: 1            -Wap广播信道
            Tag: Traffic Indication Map (TIM): DTIM 0 of 0 bitmap        -传输指示映射
            Tag: ERP Information                                 
            Tag: Extended Supported Rates 24, 36, 48, 54, [Mbit/sec]     -扩展支持速率
            Tag: HT Capabilities (802.11n D1.10)                 -超线程性能
            Tag: HT Information (802.11n D1.10)               -超线程信息
            Tag: RSN Information                      -安全网络信息
            Tag: Vendor Specific: Microsoft Corp.: WPA Information Element     -供应商及WPA信息
                Tag Number: Vendor Specific (221)                 -供应商编号
                Tag length: 22                     -长度
                OUI: 00:50:f2 (Microsoft Corp.)               -安装程序
                Vendor Specific OUI Type: 1  
                Type: WPA Information Element (0x01)              -类型
                WPA Version: 1                     -WPA版本为1