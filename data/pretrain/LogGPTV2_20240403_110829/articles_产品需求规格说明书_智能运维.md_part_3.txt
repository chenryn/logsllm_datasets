|         | 2.  在树状结构中点击展开，找到miui.system.hadoop.qps指标； |
|         |                                                            |
|         | 3.                                                         |
|         | 点击选中，指标名称自动保存为监控项名称，并展示指标曲线图； |
|         |                                                            |
|         | 4.  点击执行训练后，关闭页面。                             |
|         |                                                            |
|         | 5.  重新打开监控项页面，显示：训练中；                     |
|         |                                                            |
|         | 6.                                                         |
|         | 等待训练完成后，选择时间范围到另一时段，点击进入设置页面； |
|         |                                                            |
|         | 7.  页面展示新时段数据，点击验证。                         |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点3 | 从指标数据创建一个分组监控项（下期再做）                   |
+=========+============================================================+
| 说明    | 按主机分组的检测后续算法部分未定------初期可               |
|         | 能就是分成不同检测模型；后续可能训练一个模型针对多个指标？ |
|         |                                                            |
|         | 按主机分组未来可以扩展到其他分组方式------SPL提供对m       |
|         | etric数据的读取指令，则界面选择可以切换成SPL输入，更灵活。 |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 监控项列表页点击新建按钮。                                 |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 创建成功。                                                 |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 主流程  | 1.  打开指标数据列表；                                     |
|         |                                                            |
|         | 2.  在树状结构中点击展开，找到miui.system.hadoop.qps指标   |
|         |                                                            |
|         | 3.  勾选“按主机分组”，点击执行检测；                     |
|         |                                                            |
|         | 4.  其余同上条。                                           |
+---------+------------------------------------------------------------+
  -----------------------------------------------------------------------
  功能点4    删除一个监控项
  ---------- ------------------------------------------------------------
  说明       删除监控项不影响指标数据本身的存在。
  规则       
  原型       
  执行者     admin
  前置条件   监控项列表页点击miui.system.hadoop.qps行的删除按钮。
  后置条件   删除成功
  主流程     
  -----------------------------------------------------------------------
+---------+------------------------------------------------------------+
| 功能点5 | 监控项运行历史操作                                         |
+=========+============================================================+
| 说明    | 异常检测算法允许对检测结果进行修正反馈操作。               |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 监控项列表页点击miui.system.hadoop.qps行的查看按钮。       |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 曲线图上对应位置变为异常值。                               |
| 置条件  |                                                            |
|         | 标记异常需要重新训练，所以又进入训练中状态。               |
|         |                                                            |
|         | 训练未完成之前，新数据继续用老模型检测。                   |
+---------+------------------------------------------------------------+
| 主流程  | 1.  在曲线图上划选一段曲线，标记为“异常”。               |
+---------+------------------------------------------------------------+
  ---------------------------------------------------------------------------------------------------------------------------------------
  功能点6    监控项异常等级结果
  ---------- ----------------------------------------------------------------------------------------------------------------------------
  说明       异常检测算法本身只判断单点是否异常。但是可以根据这个点过去一段窗口的异常点的多少、频率等情况给定这个点的异常等级：低中高。
  规则       
  原型       
  执行者     admin
  前置条件   
  后置条件   
  主流程     
  ---------------------------------------------------------------------------------------------------------------------------------------
### 管理服务
+---------+------------------------------------------------------------+
| 功能点1 | 创建一个Database服务                                       |
+=========+============================================================+
| 说明    | 将监控项和设备分别归属到服务里。                           |
|         |                                                            |
|         | 服务的属性定义包括：                                       |
|         |                                                            |
|         | 名称。                                                     |
|         |                                                            |
|         | 设备列表。代表了该服务的实体数据范围。                     |
|         |                                                            |
|         | 监控项列表。除了选择已创建的监控项                         |
|         | ，还可以定义监控项对整个服务的贡献度。系统最终通过贡献度， |
|         | 将各个监控项的触发状态或异常分值，换算成服务的健康度分值。 |
|         |                                                            |
|         | 拓扑依赖关系。定义该服务依赖于其他哪些服                   |
|         | 务。依赖的这些服务的健康度分值对本服务有最高等级的贡献度。 |
|         |                                                            |
|         | 监控项加                                                   |
|         | 入服务时，将自动加上该服务的设备列表的索引值作为过滤条件。 |
|         |                                                            |
|         | 这也意味着：服务的设备列表变化时，需要同步到所有监控项里！ |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 准备好My                                                   |
| 置条件  | SQL日志数据，其中hostname包含且不止：mysql-1.example.com。 |
|         |                                                            |
|         | 创建对应该主机的设备。                                     |
|         |                                                            |
|         | 创建好如下监控项：                                         |
|         |                                                            |
|         | 1.  MySQL Query Time                                       |
|         |                                                            |
|         | 2.  Disk IOPS                                              |
|         |                                                            |
|         | 3.  MySQL Transaction                                      |
|         |                                                            |
|         | 4.  MySQL Connection                                       |
+---------+------------------------------------------------------------+
| 后      | 1.  成功创建服务。                                         |
| 置条件  |                                                            |
|         | 2.  服务监控项实际                                         |
|         | 运行的统计指标值仅包含hostname:mysql-1.example.com的部分。 |
+---------+------------------------------------------------------------+
| 主流程  | 1.  服务列表页点击新建。                                   |
|         |                                                            |
|         | 2.  填写名称为Database；                                   |
|         |                                                            |
|         | 3.  监控项属性，点击从列表中选择MySQL Query Time、MySQL    |
|         |     Transaction、MySQL Connection、Disk IOPS。             |
|         |                                                            |
|         | 4.  设备属性，点击从列表中选择mysql-1.example.com。        |
|         |                                                            |
|         | 5.  点击确定。                                             |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点2 | 创建一个依赖Database的WebServer单元                        |
+=========+============================================================+
| 说明    |                                                            |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 准                                                         |
| 置条件  | 备好WebServer日志数据，其中hostname为：web-1.example.com。 |
|         |                                                            |
|         | 创建对应该host的设备。                                     |
|         |                                                            |
|         | 创建好如下监控项：                                         |
|         |                                                            |
|         | 1.  AccessLogStatus                                        |
|         |                                                            |
|         | 2.  ResponseTime                                           |
|         |                                                            |
|         | 3.  NetIOPS                                                |
|         |                                                            |
|         | 4.  ErrorLogStatus                                         |
+---------+------------------------------------------------------------+
| 后      | 1.  成功创建。                                             |
| 置条件  |                                                            |
|         | 2.  服务详情和服务概览的链式模式均可正确展示结构。         |
+---------+------------------------------------------------------------+
| 主流程  | 1.  Service列表页点击新建。                                |
|         |                                                            |
|         | 2.  填写名称为WebServer；                                  |
|         |                                                            |
|         | ```{=html}                                                 |
|         |                                                    |
|         | ```                                                        |
|         | 5.  监控项，点击浏览，从列表中选                           |
|         | 择AccessLogStatus、ResponseTime、NetIOPS、ErrorLogStatus。 |
|         |                                                            |
|         | ```{=html}                                                 |
|         |                                                    |
|         | ```                                                        |
|         | 3.  设备项为web-1.example.com。                            |
|         |                                                            |
|         | 4.  添加依赖Service，选择Database。                        |
|         |                                                            |
|         | 5.  点击确定                                               |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点3 | 调整WebServer服务里的监控项贡献度                          |
+=========+============================================================+
| 说明    | 假设一个分组里有四个告警，每个                             |
|         | 告警有【正常、低、中、高】四个等级，各自的影响度默认为5。  |
|         |                                                            |
|         | 大家都是正常的时候，分组健康度为100。                      |
|         |                                                            |
|         | 大家都是高的时候，分组健康度为0。                          |
|         |                                                            |
|         | 可                                                         |
|         | 以算出来这个分组里，一个等级的影响因子为1的健康分值为：100 |
|         | / (5+5+5+5) / 3 = 1.67。                                   |
|         |                                                            |
|         | 则仅有告警1触发低等级的时候，分组健康度为：100 - (1 \* 5   |
|         | \* 1.67) = 91.65。\                                        |
|         | 告警1触发高等级的时候，分组健康度为：100 - (2 \* 5 \*      |
|         | 1.67) = 83.3。\                                            |
|         | 告                                                         |
|         | 警1触发高等级且告警2触发低等级的时候，分组健康度为：100 -  |
|         | (3 \* 5 + 1 \* 5 ) \* 1.67 = 66.6。                        |
|         |                                                            |
|         | 分组的健康度，也有正常、                                   |
|         | 低、中、高等级，分别为综合分值范围：100-75，75-50，50-25， |
|         | 25-0的情况。这个分值和等级，可以在卡片式的概览页面上展示。 |
|         |                                                            |
|         | 注1：默认                                                  |
|         | 的，依赖的服务的健康度分值，对本服务拥有最高10级的贡献度。 |
|         |                                                            |
|         | 注                                                         |
|         | 2：服务的健康度分值应该作为一个内置KPI计算和存储。(方式？) |
|         |                                                            |
|         | 注3：智能监控项目前暂定只有                                |
|         | 正常、低、高三级，分别对应其异常分值的0.4和0.51259765625。 |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 上两步创建的服务                                           |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 整体服务的仿真健康度从74.95变为：65.2。                    |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 主流程  | 1.  服务列表中WebServer行点击编辑。                        |
|         |                                                            |
|         | 2                                                          |
|         | .  监控项列表区域，调整AccessLogStatus的仿真告警级别为高。 |
|         |                                                            |
|         | 3.  然后拖动AccessLogStatus的影响度，从默认的5改成8。      |
+---------+------------------------------------------------------------+
### 查询和使用服务
+---------+------------------------------------------------------------+
| 功能点1 | 查看全局服务健康度                                         |
+=========+============================================================+
| 说明    | 全局看板包括：                                             |
|         |                                                            |
|         | 服务的健康度分值展示                                       |
|         |                                                            |
|         | 监控项的最新数据展示                                       |
|         |                                                            |
|         | 二者都默                                                   |
|         | 认以监控状态排序，由于KPI会比较多，所以只取排序后的topN。  |
|         |                                                            |
|         | “最新”的意思，是在所选时间范围内的最新。                 |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |