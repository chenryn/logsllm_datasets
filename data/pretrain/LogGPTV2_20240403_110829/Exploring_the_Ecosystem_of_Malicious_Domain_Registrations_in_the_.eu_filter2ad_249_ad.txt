r
t
s
g
e
r
f
o
b
N
80
60
40
20
0
Jul 2015
Oct 2015
Jan 2016
Fig. 8. Registrations per day and per registrar of campaign c 11.
Related Campaigns. By searching for overlaps between campaigns in their
registrants’ details, as well as temporal characteristics (simultaneous or chained
activity), we have identiﬁed that several campaigns are likely related to each
other:
– c 02 and c 03 have registrants with the same phone number
– c 08 and c 12 have registrants with the same phone number, email and address
– c 16 and c 18 have registrants with the same address
Similarly, the abrupt ending of campaigns c 01, c 02 and c 03 suggest that
these campaigns might be of the same actor, or depend on the same reseller or
registrar that ended their service.
486
T. Vissers et al.
Most Active Malicious Actors. Table 5 gives the highest represented mali-
cious registrars, registrants and email providers in our dataset. Most surpris-
ingly, 49.6% of all the malicious domain names are registered with one single
registrar. Furthermore, it used by half of all the campaigns we identiﬁed. We
argue that this registrar is either very ﬂexible in accepting registrations, or has
the most interesting price setting for bulk registrants. Note that this registrar
only accounts for 2.27% of all benign registrations. This observation conﬁrms
earlier ﬁndings in [11,13] that a handful of registrars accounts for the majority
of spammer domains.
The most used malicious email providers are all popular public webmail
providers. The situation is diﬀerent compared to the registrars as gmail.com has
the largest share of malicious registrations but also well-represented in benign
registrations. In contrast, aol.com and yahoo.com do have a large fraction of
malicious registrations.
Over 3,000 malicious registrations can be attributed to just 3 registrants who
are predominantly malicious. Related to the reasoning in Sect. 3.3, we suspect
that non-blacklisted registrations of these registrants are likely malicious as well.
Table 5. Top 3 most malicious registrars, email providers and registrants. For each
entry, we list their contribution to all malicious and benign registrations, their toxicity
and the campaigns that are associated with them. The toxicity expresses the percentage
of malicious registrations within that entity.
Nb of
Contribution
malicious Malicious Benign Toxicity
Associated campaigns
1. registrar 5
2. registrar 3
3. registrar 7
1. gmail.com
2. yahoo.com
3. aol.com
10,353
49.61% 2.27% 36.25% 1 2 3 4
9 10
12 13 14
17
3,004
14.39% 2.64% 12.41%
3
7 8
12
16
18
2,327
11.15% 0.46% 38.67%
4,221
20.23% 24.79% 2.08%
4
14
19
3,348
16.04% 1.49% 21.85% 2 3 4
8
2,134
10.23% 0.31% 46.28%
8 9
20
20
1. PI:EMAIL
2. PI:EMAIL
1,265
1,240
6.06% 0.00% 99.37%
5.94% 0.12% 54.89%
3. PI:EMAIL
989
4.74% 0.01% 95.37%
18
11
14
5 Automating Campaign Identiﬁcation
In the previous section, we discussed a large-scale experiment in which we man-
ually identiﬁed large campaigns from a corpus of malicious registrations. The
criteria that deﬁned these campaigns were mainly recurring registrant and name-
server details. In this section, we use that knowledge to automate the campaign
identiﬁcation process by using a clustering algorithm. The results serve to both
validate the manual experiment, as well as to demonstrate the capabilities of
automatic campaign identiﬁcation to aid ecosystem analyses in TLDs.
Exploring the Ecosystem of Malicious Domain Registrations in the .eu TLD
487
5.1 Clustering Process
Algorithm. Agglomerative clustering is chosen as the basis to perform auto-
matic campaign identiﬁcation. It is a hierarchical clustering algorithm that works
by iteratively merging the two clusters that are closest to each other [12]. We
adopt the complete linkage criterion to determine the distance between clusters.
Using this criterion, the distance is equal to that of the most dissimilar instances
of both clusters, promoting a high density. There are two main reasons for opting
for agglomerative clustering.
1. The algorithm does not require a predetermined number of clusters, allowing
us to statistically evaluate the optimal number of clusters afterwards.
2. Given the results from Sect. 3, we presume that about 80% of malicious
domains can be grouped into clusters. Agglomerative clustering allows the
remaining independent domains to have their own singleton cluster, without
necessarily polluting the large clusters.
Feature Set. For each of the 20,870 blacklisted registrations, we extract 13 fea-
tures. There are two general registration features, domain length and regis-
trar. Next, we have ten registrant features: name, street, city, region, country,
zip code, phone number, email account and email provider. Lastly, two name-
server features were included, the nameserver domain names and their geo-
graphical location.
Agglomerative clustering uses the Euclidean distance measure to calculate
the distance between two instances. However, except for domain length and
address score, all features in our set are categorical, not numeric. In order to
accommodate these features, we apply one-hot encoding [18]: for each possible
category in our set, a new binary feature is created. Each instance that carried
that value will receive a value of 1 in the new binary encoded feature, all others
are set to 0. Naturally, one-hot encoding dramatically increases the number of
features, more speciﬁcally from 13 to 30,843.
Cutoﬀ Selection. Agglomerative clustering has no predeﬁned stopping criteria
and merges clusters until only one remains. Using the campaign labels from
the manual analysis in Sect. 3, we calculate the V-measure after each merging
step to statistically express the mapping between clusters and campaigns. The
V-measure is the harmonic mean of the homogeneity and completeness score [19].
The former is a metric that represents how homogeneous each cluster is in terms
of campaign labels, the latter measures whether the instances of a certain label
are all assigned to the same cluster4. The highest V-measure is observed at
a cutoﬀ of 432 clusters, where the homogeneity is 0.90 and the completeness
score 0.86.
4 For instances without campaign labels, the registrant’s phone numbers are set as
their label.
488
T. Vissers et al.
5.2 Results
In the selected model, very large clusters have formed. Namely, 80% of domains
reside in the 39 largest clusters, while a long tail of 227 clusters consisting out
of only 5 registrations or less. In other words, the clustering algorithm forms
a Pareto distribution similar to the manual campaign identiﬁcation in Sect. 4.
Furthermore, the top 30 clusters represent 91.48% of blacklisted registrations
that reside within the 20 manually identiﬁed campaigns.
Using Fig. 9, we analyze the top 30 largest clusters and their correlation to
the campaign labels from the manual analysis. The clustering algorithm largely
aligns with the manual campaign identiﬁcation, with most clusters mapping to
a single campaign. The notable exceptions being the two largest clusters. The
ﬁrst cluster encompasses 2,052 domains of both c 02 and c 03. This is in line
with our previous speculation (Sect. 4) that c 02 and c 03 are related given their
synchronized ending and the fact that they share registrants with the same phone
number. The same is true for the second cluster, as both c 16 and c 18 clearly
share registrants with the same address.
Cluster 16 is the only automatically identiﬁed cluster that solely exists out
of domains without campaign labels. When inspecting those domains, we ﬁnd
that this cluster is likely related to or part of c 20. More speciﬁcally, their active
days align and the same registrar is used for all registrations in both sets, as
shown in the bottom part of Fig. 10.
Several clusters also contain a small amount of instances without a campaign
label. We distinguish two cases: instances that closely align to a campaign, but
were not selected because of too narrow selection criteria; and instances that
have no campaign aﬃnity, but are most probably merged because the clustering
algorithm has executed too many merges. The former are labeled as (Related)
in Fig. 9, the latter as (Unrelated).
18 of the 20 manually identiﬁed campaigns are represented in the top
30 clusters. The smallest identiﬁed campaign, c 07, is not found in this sub-
set of clusters because it is simply too small. Cluster 30 contains 110 domains,
more than c 07 encompasses as a whole. However, we ﬁnd that c 07 is completely
and homogeneously represented by the 35th cluster. The second campaign that
is missing is c 15. As mentioned in Sect. 3.3, this campaign was selected by a
unique and complex address formatting pattern. Since the clustering algorithm
only performs binary matches on these ﬁelds, it is less eﬀective at detecting these
more advanced similarities. As shown in the top part of Fig. 10, c 15 is spread
out over 18 clusters, that essentially represent 18 diﬀerent registrants that are
reused throughout the campaign. The aﬃnity between those clusters is clear
when considering their active days.
In conclusion, the manual and automatic campaign identiﬁcation results align
to a large extent. We ﬁnd that, when performing automatic detection using clus-
tering, we achieve a more exhaustive identiﬁcation of clear similarities as opposed
to manual identiﬁcation (e.g. cluster 16). However, the automatic approach has
diﬃculties to detect more advanced similarity patterns (e.g. c 15). In future
Exploring the Ecosystem of Malicious Domain Registrations in the .eu TLD
489
work, more sophisticated techniques, such as n-grams, can be integrated into
the clustering algorithm to detect more advanced similarity patterns.
In general, the outcome of the clustering algorithm both validates the app-
roach of the manual analysis, as well as demonstrates the capabilities of auto-
matic and reproducible campaign identiﬁcation using registrant and nameserver
details.
Number of Registrations:  ●
400
●
800
●
1200
●
1600
i
n
g
a
p
m
a
C
c_20
c_19
c_18
c_17
c_16
c_14
c_13
c_12
c_11
c_10
c_09
c_08
c_06
c_05
c_04
c_03
c_02
c_01
(Related)
 (Unrelated)
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
Cluster
Fig. 9. Mapping of the top 30 clusters to campaign instances. The bottom two rows
represent domains without a campaign label: the (Related) row groups the registra-
tions that closely align with campaigns, the (Unrelated) groups registrations without
campaign aﬃnity. The clusters are ranked from large to small.
6 Discussion and Limitations
In this section, we want to discuss the relevance and applications, as well as the
limitations of our study.
Applications. Given the exploratory nature of this research, we anticipate
several applications and next steps.
The relevance of this work is not limited to .eu domains. Presumably, mali-
cious actors do not restrict their potential to a single TLD. Furthermore, bulk
registrations can be made across multiple TLDs using the same registrar. There-
fore, the ﬁndings and methods described in this paper can most likely be applied
to other or across TLDs. To reproduce this study, access to registrant and name-
server details of registrations is required. This data can generally be obtained
by downloading zone ﬁles and WHOIS data.
490
T. Vissers et al.
Registrations per day:  ●
●50
100
Clusters with c_15 domains
s
r
e
t
s
u
C
l
[c_15]
217
197
179
173
171
122
113
108
 89
 85
 67
 65
 61
 56
 54
 53
 47
 40
[c_20]
28
20
16
 3
Oct 2015
Nov 2015 Dec 2015
Jan 2016
Feb 2016 Mar 2016
Apr 2016 May 2016
Jun 2016
Clusters with c_20 domains (red) and Cluster 16 (blue)
Jan 2016
Feb 2016
Fig. 10. Related temporal activity, highlighted in gray. Top: Domains of campaign c 15
are spread over many clusters. Bottom: Cluster 16 maps to clusters of c 20 domains.
Additionally, we demonstrate that automatic campaign identiﬁcation using
clustering is a feasible strategy. Moreover, 18.38% of registrations in the identiﬁed
campaigns are not present on blacklists. This entices interesting opportunities
to extend the coverage of blacklists. Although the proposed system relies on a
post-factum analysis, it could create opportunities to stop ongoing campaigns.
Limitations. We note four limitations and potential validity threats.
Firstly, the main subjects of this research are domain names that are reg-
istered with malicious intent. However, backlists also contain legitimate regis-
trations that have been compromised later on. We argue that the prevalence
of these cases is minimal, since 98.57% of blacklisted registrations were already
ﬂagged within the ﬁrst 30 days of registration. Furthermore, compromised benign
domains would appear as outliers in our data and could thus hardly pollute cam-
paign analyses.
Secondly, both the manual and automatic identiﬁcation rely on patterns in
the registration data. Malicious actors can leverage this dependency by con-
stantly using diﬀerent registration data and patterns. However, the cost for
attackers would increase to achieve this higher level of circumvention. Further-
more, it is hard not to exhibit any pattern when performing bulk registrations
(same registrars, time patterns, fake identity generating tools,...).
Additionally, several registrars oﬀer anonymization services to their cus-
tomers, obscuring the registrant contact information to the registry. Evidently,
this diminishes the ability to diﬀerentiate between registrations and conceals
Exploring the Ecosystem of Malicious Domain Registrations in the .eu TLD
491
information that can be used to identify domains registered by the same entity.
In the case of .eu, the use of such obfuscation services is not allowed by the
registry’s terms and conditions. During our analysis, we ﬁnd that such services
were only deployed by c 05 which could have impacted this campaign.
Finally, our research is based on a set of publicly available blacklists that are,
at least to some extent, incomplete. A more complete ground truth would likely
improve the performance of our approach.
7 Related Work
Prior to our research, Hao et al. [11] studied the domain registration behavior
of spammers. They reported that most spam domains are very short-lived. More
speciﬁcally, 60% of these domains were active for only a single day. Spammers are
registering many “single-shot” domains to minimize interference by blacklists.
To counter this strategy, the authors explore various features on which spam
domains exhibit distinctive behavior. For instance, in contrast with benign reg-
istrations, they ﬁnd that malicious domains are more often registered in batches.
Recently, Hao et al. implemented many features discussed in that prior work to
create a machine learning-based predictor capable of detecting malicious domains
at time-of-registration [10]. The three most dominant features of their classiﬁer
are authoritative nameservers, trigrams in domain names and the IP addresses
of nameservers.
While both papers approach malicious domains as a two-class problem
(benign vs. malicious registrations), many of their features essentially depend
on returning characteristics of diﬀerent underlying malicious campaigns. In this
work, we are the ﬁrst to shift the focus to the campaigns itself, exploring their
modus operandi and diﬀerent identifying characteristics.
A method related to ours was proposed by Felegyhzi et al. [5], who investi-
gated the feasibility of proactive domain blacklisting, by inferring other malicious
registrations from known-bad domains through shared nameservers and identical
registration times. The proposed system shortens the time required to blacklist
malicious domains, while providing important insights regarding the similarities
of registrations within campaigns. Additionally, Cova et al. [4] identiﬁed dif-
ferent rogue antivirus campaigns by looking at the hosting infrastructure and
registration details (including the registrant’s email) of diﬀerent domains.
Related studies concentrate on DNS traﬃc of newly registered domains to
characterize malicious behaviour [1–3,9,14]. These systems mainly focus on the
initial operational DNS patterns of domain names.
Other important eﬀorts regarding malicious domains come from the study
of domain generation algorithms (DGAs). Recent work by Plohmann et al. [17]
demonstrates the increasing importance of understanding DGAs to thwart C&C
communication. Using reimplementations of these algorithms, the authors exe-
cute forward generation of domain lists, which enables proactive identiﬁcation
of C&C domains.
492
T. Vissers et al.
8 Conclusion
In this study, we analyzed the maliciously-ﬂagged .eu registrations over a
14-month period. This paper is the ﬁrst to extensively dissect the underbelly
of malicious registrations using registrant details to identify its operational com-
ponents, namely campaigns. We explored the ecosystem and modus operandi of
elaborate malicious actors that register massive amounts of domains for short-
lived, malicious use.
By searching for shared characteristics, we established that at least 80.04%
of all malicious registrations can be attributed to 20 campaigns with varying
duration and intensity. Moreover, the coverage of blacklists can be extended by
19.30%, using the information from the campaign identiﬁcation. After a rig-
orous evaluation, we are able to conﬁrm that the vast majority of these pre-
viously undetected registrations are genuinely related to malicious activity; at
most 0.92% are false positive registrations.
Our study demonstrates the potential to leverage the registrant details and
other registration characteristics to identify large campaigns. Aided by an auto-
matic identiﬁcation process, this insight can be used to easily track and interfere
with massive, long-running campaigns and to preemptively extend blacklists
with malicious domains that have yet to be actively used by a cybercriminal.
Acknowledgements. We thank the reviewers for their valuable feedback. We would
also like to express our gratitude to the PC chairs and in particular our shepherd, for
supporting us in improving the paper.
References
1. Antonakakis, M., Perdisci, R., Dagon, D., Lee, W., Feamster, N.: Building a
dynamic reputation system for DNS. In: Proceedings of the 19th USENIX Confer-
ence on Security, p. 18 (2010)
2. Antonakakis, M., Perdisci, R., Lee, W., Vasiloglou II., N., Dagon, D.: Detecting
malware domains at the upper DNS hierarchy. In: Proceedings of the 20th USENIX
Conference on Security, p. 27
3. Bilge, L., Sen, S., Balzarotti, D., Kirda, E., Kruegel, C.: Exposure: a passive DNS
analysis service to detect and report malicious domains. ACM Trans. Inf. Syst.
Secur. (TISSEC) 16(4), 14 (2014)
4. Cova, M., Leita, C., Thonnard, O., Keromytis, A.D., Dacier, M.: An analy-
sis of rogue AV campaigns. In: Jha, S., Sommer, R., Kreibich, C. (eds.) RAID
2010. LNCS, vol. 6307, pp. 442–463. Springer, Heidelberg (2010). doi:10.1007/
978-3-642-15512-3 23
5. Felegyhazi, M., Kreibich, C., Paxson, V.: On the potential of proactive domain
blacklisting. In: Proceedings of the 3rd USENIX Conference on Large-Scale
Exploits and Emergent Threats: Botnets, Spyware, Worms, and More, p. 6 (2010)
6. FortiGuard Center: Antispam - IP & Signature Lookup (2017). https://www.
fortiguard.com/more/antispam
7. Google: Google
Safe Browsing
(2016).
https://developers.google.com/
safe-browsing/
Exploring the Ecosystem of Malicious Domain Registrations in the .eu TLD
493
8. Google: Unwanted Software Policy (2016). https://www.google.com/about/
company/unwanted-software-policy.html
9. Hao, S., Feamster, N., Pandrangi, R.: Monitoring the initial DNS behavior of mali-
cious domains. In: Proceedings of the 2011 ACM SIGCOMM Conference on Inter-
net Measurement Conference, pp. 269–278. ACM (2011)
10. Hao, S., Kantchelian, A., Miller, B., Paxson, V., Feamster, N.: Predator: Proactive
recognition and elimination of domain abuse at time-of-registration
11. Hao, S., Thomas, M., Paxson, V., Feamster, N., Kreibich, C., Grier, C., Hollenbeck,
S.: Understanding the domain registration behavior of spammers. In: Proceedings
of the 2013 Conference on Internet Measurement Conference, pp. 63–76 (2013)
12. Hastie, T., Tibshirani, R., Friedman, J.: The Elements of Statistical Learning.
Springer Series in Statistics. Springer, New York (2001)
13. Levchenko, K., Pitsillidis, A., Chachra, N., Enright, B., F´elegyh´azi, M., Grier, C.,
Halvorson, T., Kanich, C., Kreibich, C., Liu, H., McCoy, D., Weaver, N., Paxson,
V., Voelker, G.M., Savage, S.: Click trajectories: end-to-end analysis of the spam
value chain. In: Proceedings of the 2011 IEEE Symposium on Security and Privacy,
SP 2011, pp. 431–446. IEEE Computer Society, Washington, DC (2011). http://
dx.doi.org/10.1109/SP.2011.24
14. Moura, G.C., M¨uller, M., Wullink, M., Hesselman, C.: nDEWS: a new domains
early warning system for TLDs. In: NOMS 2016–2016 IEEE/IFIP Network Oper-
ations and Management Symposium, pp. 1061–1066. IEEE (2016)
15. Myles, P.: DomainWire Global TLD Report 2016/2. https://www.centr.org/
library/statistics-report/domainwire-global-tld-report-2016-2.html
16. Pattanai: Faker is a PHP library that generates fake data for you. https://github.
com/teepluss/laravel-faker
17. Plohmann, D., Yakdan, K., Klatt, M., Bader, J., Gerhards-Padilla, E.: A com-
prehensive measurement study of domain generating malware. In: 25th USENIX
Security Symposium, pp. 263–278 (2016)
18. Scikit-learn developers: Encoding categorical features (2017). http://scikit-learn.
org/stable/modules/preprocessing.html
19. Scikit-learn developers: Homogeneity, completeness and V-measure (2017). http://
scikit-learn.org/stable/modules/clustering.html
20. SURBL: SURBL - URI Reputation Data (2016). http://www.surbl.org
21. The Spamhaus Project Ltd: The Domain Block List (2016). https://www.
spamhaus.org/dbl/
22. Twilio: Lookup (2017). https://www.twilio.com/lookup
23. URL Void: Website Reputation Checker Tool (2016). http://www.urlvoid.com/
24. Vixie, P.: Domain name abuse: how cheap new domain names fuel the eCrime
economy. Presentation at RSA Conference 2015 (2015)