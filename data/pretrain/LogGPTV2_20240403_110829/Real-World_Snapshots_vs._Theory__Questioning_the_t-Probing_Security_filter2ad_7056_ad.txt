available online as open-access research data6.
D. Key Extraction with Unknown Register Locations
In the second scenario, we selected a d + 1 = 2-share
implementation of AES-DOM as the target. We adjusted the
size of logic blocks so that nearly all 16 registers in each
LAB are used, occupying in total 45 LABs. Note that these
LABs cover the entire registers of the AES-DOM design,
including the shared key registers, shared state registers, the
intermediate masked Sbox registers, and those of ﬁnite-state
machines. However, we do not have any knowledge about
the exact location of each register cell and enforce no other
placement rule rather than what is explained above. Using the
scheme explained in Section IV-B1, we localized the physical
area on the chip where the register cells are placed, see Fig. 6.
investigated the design
architecture of the AES-DOM, being serialized with the state
and key registers shifted byte-wise, as stated before. Table I
represents the content of 32 registers (consisting of 8 bits each)
stored in consecutive clock cycles for the ﬁrst 36 clock cycles,
whereas the order of rows in the table is not of our interest.
the attack, we ﬁrst
To conduct
6 http://dx.doi.org/10.14279/depositonce-10440
LLSIimageSnapshotsCorrelationb10.39−0.07b2−0.130.40b3−0.140.48b40.65−0.18b50.49−0.05b6−0.240.51b70.52−0.2b8−0.170.49r(bi,t0)r(bi,t1)TemplatesBit=0t0Bit=1t1STATE OF THE REGISTERS OF THE AES-DOM DESIGN IN THE FIRST 36 CLOCK CYCLES, EACH ROW REPRESENTS A REGISTER BYTE,
K: KEY BYTES, S: SUBBYTES OUTPUT, M: MIXCOLUMNS OUTPUT, K’: 2ND ROUND KEY BYTES, S’: 2ND-ROUND SUBBYTE OUTPUT.
TABLE I
8
9
14
6
7
4
5
2
3
13
12
10 11
1
15
− − − − − − − − − − − − − − −
− − − − − − − − − − − − − − K0
− − − − − − − − − − − − − K0 K1
− − − − − − − − − − − − K0 K1 K2
− − − − − − − − − − − K0 K1 K2 K3
− − − − − − − − − − K0 K1 K2 K3
S0
− − − − − − − − − K0 K1 K2 K3
S1
S0
− − − − − − − − K0 K1 K2 K3
S2
S1
S0
− − − − − − − K0 K1 K2 K3
S3
S2
S1
S0
− − − − − − K0 K1 K2 K3 S0
S4
S3
S2
S1
− − − − − K0 K1 K2 K3 S0 S1
S5
S4
S3
S2
− − − − K0 K1 K2 K3 S0 S1 S2
S6
S5
S4
S3
− − − K0 K1 K2 K3 S0 S1 S2 S3
S4
S5
S6
S7
− − K0 K1 K2 K3 S0 S1 S2 S3 S4
S8
S7
S6
S5
− K0 K1 K2 K3 S0 S1 S2 S3 S4 S5
S9
S8
S7
S6
K0 K1 K2 K3 S0 S1 S2 S3 S4 S5 S6
S7
S8
S9
S10
− − − − − − − − − − − − − − −
− − − − − − − − − − − − − − K0
− − − − − − − − − − − − − K0 K1
− − − − − − − − − − − − K0 K1 K2
− − − − − − − − − − − K4 K5 K6 K7
− − − − − − − − − − K4 K5 K6 K7 K4
− − − − − − − − − K4 K5 K6 K7 K4 K5
− − − − − − − − K4 K5 K6 K7 K4 K5 K6
− − − − − − − K4 K5 K6 K7 K8 K9 K10 K11
− − − − − − K4 K5 K6 K7 K8 K9 K10 K11 K8
− − − − − K4 K5 K6 K7 K8 K9 K10 K11 K8 K9
− − − − K4 K5 K6 K7 K8 K9 K10 K11 K8 K9 K10
− − − − − − − − − − − − − − −
− − − − − − − − − − − − − − K12
− − − − − − − − − − − − − K12 K13
− − − − − − − − − − − − K12 K13 K14
26
25
22
21
18
17
24
27
20
23
16
19
S4 M5 M6 M7
S0 M1 M2 M3
K0 K1 K2 K3
S8
S9 M6 M7
S4
S5 M2 M3
S0
K1 K2 K3
S8
S14 M7
S13
S9
S4
S10 M3
S1
S0
K2 K3
S13 S2
S8
S14 S3
S9
S15 S4
S2
S1
S0
K3
S13 S2
S7
S8
S14 S3
S9
S4
S3
S2
S1
S0
S7
S12
S9
S14 S3
S8
S13 S2
S1
S2
S3
S4
S12 S1
S7
S13 S2
S8
S14 S3
S5
S4
S3
S2
S6
S12 S1
S7
S13 S2
S8
S3
S6
S5
S4
S3
S6
S12 S1
S7
S13 S2
S8
S11
S7
S6
S5
S4
S6
S12 S1
S7
S13 S2
S11 K’ 0
S8
S7
S6
S5
S6
S12 S1
S7
S9
S8
S7
S6
S2
S11 K’ 0 K’ 1
S6
S12 S1
S9
S8
S7
S10 S7
S11 K’ 0 K’ 1 K’ 2
S8
S9
S10 S11 S12 S1
S6
S11 K’ 0 K’ 1 K’ 2 K’ 3
S6
S9
S11 K’ 0 K’ 1 K’ 2 K’ 3 S ’ 0
S10 S11 S12 S1
S10 S11 S12 S13 S6
S11 K’ 0 K’ 1 K’ 2 K’ 3 S ’ 0 S ’ 1
S11 S12 S13 S14 S11 K’ 0 K’ 1 K’ 2 K’ 3 S ’ 0 S ’ 1 S ’ 2
31
30
35
34
33
29
32
36
28
S12 M13 M14 M15 K’ 0
S8 M9 M10 M11
M14 M15 K’ 0 K’ 1
S1
S13 M10 M11 S12
S6
M15 K’ 0 K’ 1 K’ 2
S2 M11 S12 S1
S11 K’ 0 K’ 1 K’ 2 K’ 3
S6
S7
S ’ 0
S11 K’ 0 K’ 1 K’ 2 K’ 3
S12 S1
S ’ 1
S1
S6
S ’ 0
S ’ 2
S ’ 1
S11 K’ 0 K’ 1 K’ 2 K’ 3
S6
S ’ 3
S ’ 2
S ’ 0
S11 K’ 0 K’ 1 K’ 2 K’ 3
S ’ 4
S ’ 3
S ’ 1
S ’ 0
K’ 0 K’ 1 K’ 2 K’ 3
S ’ 5
S ’ 4
S ’ 2
S ’ 1
K’ 1 K’ 2 K’ 3 S ’ 0
S ’ 6
S ’ 5
S ’ 3
S ’ 2
K’ 2 K’ 3 S ’ 0 S ’ 1
S ’ 7
S ’ 6
S ’ 4
S ’ 3
K’ 3 S ’ 0 S ’ 1 S ’ 2
S ’ 8
S ’ 0 S ’ 1 S ’ 2 S ’ 3
S ’ 4
S ’ 5
S ’ 7
S ’ 9
S ’ 8
S ’ 6
S ’ 5
S ’ 1 S ’ 2 S ’ 3 S ’ 4
S ’ 9
S ’ 7
S ’ 6
S ’ 2 S ’ 3 S ’ 4 S ’ 5
S ’10
S ’10 S ’11
S ’ 3 S ’ 4 S ’ 5 S ’ 6
S ’ 7
S ’ 8
S12 S1
S6
S11 K’ 0 K’ 1 K’ 2 K’ 3
S ’ 0
S ’ 1
S ’ 2
S ’ 3
S ’ 4
S ’ 5
S ’ 6
S ’ 7
S ’ 8
S ’ 9
K0 K1 K2 K3 K0 K1 K2 K3 K4 K5 K6 K7
K1 K2 K3 K0 K1 K2 K3 K4 K5 K6 K7 K8
K2 K3 K0 K1 K2 K3 K4 K5 K6 K7 K8 K9
K3 K0 K1 K2 K3 K4 K5 K6 K7 K8 K9 K10
K4 K5 K6 K7 K4 K5 K6 K7 K8 K9 K10 K11