How to get good seats in the 
security theater?
Hacking boarding passes for fun and profit
Przemek Jaroszewski
przemj+PI:EMAIL
$ whoami
• head of the Polish national CSIRT (CERT Polska)
• 10+ years of education in programming
• Master’s degree in social psychology
• 15 years of experience in IT security
• aviation enthusiast, unrealized air traffic controller
Up in the Air
• FF miles are nice, but status in nicer
Except when improvements don’t work…
IATA Resolution 792 (2005)
• Paper
• PDF417
• Mobile
• QR Code
• Aztec
• DataMatrix
Bar-Coded Boarding Pass
M1JAROSZEWSKI/PRZEMYSLE56XXXX 
WAWCPHSK 2762 666M009C0007 666>10B0 
K6161BSK 2511799999153830 SK A3 
199999999
*3000500A3G
M1JAROSZEWSKI/PRZEMYSLE56XXXX 
WAWCPHSK 2762 666M009C0007 666>10B0 
K6161BSK 2511799999153830 SK A3 
199999999
*3000500A3G
M1JAROSZEWSKI/PRZEMYSLE56XXXX 
WAWCPHSK 2762 666C009C0007 666>10B0 
K6161BSK 2511799999153830 SK A3 
199999999
*3000500A3G
Where did we get?
• Free Fast Track for all travellers
M1COLUMBUS/CHRISTOPHERE56XXXX 
WAWCPHSK 2762 666M009C0007 666>10B0 
K6161BSK 2511799999153830 SK A3 
199999999
*3000500A3G
M1COLUMBUS/CHRISTOPHERE56YYYY
WAWCPHSK 2762 666M009C0007 666>10B0 
K6161BSK 2511799999153830 SK A3 
199999999
*3000500A3G
Where did we get?
• Free Fast Track for all travelers => Sterile area access for all
Wait, this is not news!
• Bruce Schneier (2003): Flying On Someone Else’s Airplaine Ticket
• shows how to work around no fly lists with print-at-home BPs
• Andy Bowers (2005): Dangerous Loophole in Airport Security
• Bruce Schneier (2006): The Boarding Pass Brouhaha
• Christopher Soghoian (2007): Insecure Flight: Broken Boarding Passes
and Ineffective Terrorist Watch Lists
• Jeffrey Goldberg (2008): The Things He Carried
• Charles C. Mann (2011): Smoke Screening
• John Butler (2012): Security Flaws in the TSA Pre-Check System and 
the Boarding Pass Check System
No Fly List Bypass (in 2003)
• Buy tickets under false name
• Print your boarding pass at home
• Create a copy of the boarding pass with your real name
• Present the fake boarding pass and the real ID to TSA officers
• Present the real boarding pass to gate agents
• Fly
No Fly List Bypass (in 2016 Europe)
• Buy tickets under false name
• Print your boarding pass at home
• Fly
Impacting factors:
• Particular airline’s business consciousness
• Temporary security checks
Source: r/MapPorn
Source: IATA
• NO integrity checks
• NO authentication
Source: IATA
So… Where is passenger data stored?
• Computer Reservation Systems (CRS) allow for storage and processing of 
Passenger Name Records (PNR) containing:
• personal data (names, contact details)
• reservations (airlines, hotels, cars, …)
• issued tickets
• special requests
• loyalty programs data
• Dozens of CRSs exist
• GDS (eg. Sabre, Amadeus, Galileo, Worldspan, …)
• proprietary ones
• One reservation may result with multiple PNRs in different CRSs
• Data access is limited not only across CRSs, but across different parties
Notice of advice
• BCBP often contains more information than the printed version
• PNR locator (aka: reservation/confirmation number, booking reference)
• Ticket number
• Full frequent flyer number
• This information can be used to retrieve most and modify some data 
in your PNR, including ticket cancellation!
• Sometimes with additional knowledge like e-mail address
• Don’t post or share non-anonymized boarding passes!
… and then on to other systems
• Departure Control System (DCS) – check-in info
• Advance Passenger Information (API) – to border agencies
• PNRGOV – to government agencies
• Secure Flight
Paper is just a bit less fun…
• MS Word is a great PDF-editing tool 
• Most likely barcode will be scanned
anyway, so it needs to reflect the printed
information
Lounge access
• Contract lounges
• no way to verify eligibility
• may require an invitation issued from the airline
at check-in
• Airline-operated lounges
• may have access to passenger records …
• … but only for own passengers!
• automatic gates increasingly popular (eg. SAS 
lounges in CPH, OSL; Turkish lounge in IST)
Duty Free Goods
• In many countries goods
are sold directly to the 
passenger (liquors sealed in 
a plastic bag)
• Eligibility is determined
based on destination
(eg. EU/Non-EU)
Where did we get?
• Airport access (meet&greet, sightseeing, …)
• Fast Track
• Free lunch and booze
• Duty free shopping
Source: IATA
Digital Signature
• In 2009 IATA extended BCBP standard (ver. 3) with support for digital
signatures based on PKI
• Yet many airlines still use BCBP v.1
• The field is "optional and to be used only when required by the local 
security administration"
• The field has variable length, with specific algorithm etc. determined
by the authority
• Private keys owned by airlines, public keys distributed to third parties
• TSA enforced for US carriers (well, almost)
BCBP XML
• In 2008 IATA proposed Passenger and Airport Data Interchange
Standards (PADIS) XML to be used for exchange of BCBP data 
between airlines and third parties, such as lounges or security
checkpoints
• The terminal would send a message consisting of a header and full
BCBP content
• The airline would reply with a Yes/No, along with a reason and 
optional free text
Source: BCBP Working Group
Secure Flight
• Program implemented by TSA in 2009 takeover watchlists monitoring from 
airlines
• Pre-Check and Secondary Screening introduced in 2011
• Selectee indicator in BCBP field 18; 0=normal; 1=SSSS; 3=LLLL
• In 2013 TSA started networking CAT/BPSS devices to pull passenger data 
from Secure Flight, including:
• Passenger’s full name
• Gender
• Date of birth
• Screening status
• Reservation number
• Flight itinerary (in order to determine which airports receive data)
Why is
awesome?
• Just when I thought I got my slides ready… I get this message
from @supersat
I noticed you are giving a talk on boarding passes at DEF CON. I 
managed to acquire [this] off of eBay, and was wondering if you'd 
like to play around with it at DEF CON or use it for a demo at your 
talk. 
Where did we get?
• Airport access (meet&greet, sightseeing, …)
• Fast Track
• Free lunch and booze
• Duty free shopping
• Pre-check??
Is it a vulnerability?
• LOT Polish Airlines:
- Please contact Warsaw Airport about this issue as they’re responsible for 
boarding pass scanning systems.
• Warsaw Airport:
- It’s a known issue, but not a problem. We’re compliant with all CAA 
guidelines.
• Civil Aviation Authority for Poland:
- Boarding pass forgery is a crime since they are documents.
• Me:
- Can you have a legally binding document without any form of 
authentication?
• Civil Aviation Authority for Poland:
- Oh, go f*** yourself!
Is it a vulnerability?
• Turkish Airlines:
- Please be inform that, we have already shared your contact details 
with our related unit, to get in touch with you as soon as possible.
• SAS:
- We appreciate that you have taken the time to send us your 
feedback, as this is crucial for us to improve our services.
• TSA:
awkward silence
Will it fly?
•NO.
•Seriously. Don’t try!
But you can have a nice souvenir 
+
=
Wrap up
• Privacy and complexity of reservation systems prevent effective data 
exchange between airlines and BP scanning checkpoints
• Several countermeasures have been introduced by IATA, but they’re
expensive and complicated to implement
• While US did a reasonably good job, other places have actually
lowered the bar
• Because of privacy restrictions access to PNR will likely by limited to 
governments making cross-dependencies between private entities
inherently broken
Sources/Further reading
•
IATA: BCBP Implementation Guide
http://www.iata.org/whatwedo/stb/bcbp/Documents/BCBP-Implementation-Guide.pdf
•
IATA: Bar-Coded Boarding Passes FAQ
https://www.iata.org/whatwedo/stb/bcbp/Documents/bcbp-faqs.pdf
•
IATA: Passenger and Airport Data Interchange Standards (PADIS) Board
http://www.iata.org/whatwedo/workgroups/Pages/padis.aspx
•
TSA: Privacy Impact Assessment for the Boarding Pass Scanning System
https://www.dhs.gov/xlibrary/assets/privacy/privacy_pia_tsa_bpss.pdf
•
TSA: Secure Flight
http://www.dhs.gov/xlibrary/assets/privacy/privacy_pia_tsa_secureflight_update018(e).pdf
https://www.tsa.gov/news/testimony/2014/09/18/tsa-secure-flight-program
•
BCBP Working Group: Business Requirements: BCBP Data Exchange
http://www.aci.aero/media/aci/file/aci_priorities/it/doc0803_brd_bcbp_xmlfinal.pdf
•
Bruce Schneier: Flying On Someone Else’s Airplane Ticket
https://www.schneier.com/crypto-gram/archives/2003/0815.html#6
•
Bruce Schneier: The Boarding Pass Brouhaha
https://www.schneier.com/essays/archives/2006/11/the_boarding_pass_br.html
•
Andy Bowers: A Dangerous Loophole in Airport Security
http://www.slate.com/articles/news_and_politics/hey_wait_a_minute/2005/02/a_dangerous_loophole_in_airport_security.html
•
Christopher Sokhoian: Insecure Flight: Broken Boarding Passes and Ineffective Terrorist Watch Lists
http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1001675
•
Jeffrey Goldberg: The Things He Carried (The Atlantic)
http://www.theatlantic.com/magazine/archive/2008/11/the-things-he-carried/307057/
•
Charles C. Mann: Smoke Screening (Vanity Fair)
http://www.vanityfair.com/culture/2011/12/tsa-insanity-201112
•
Brian Krebs: What’s in the Boarding Pass? A lot
http://krebsonsecurity.com/2015/10/whats-in-a-boarding-pass-barcode-a-lot/
•
John Butler: Security Flaws in the TSA Pre-Check System and the Boarding Pass Check System
https://puckinflight.wordpress.com/2012/10/19/security-flaws-in-the-tsa-pre-check-system-and-the-boarding-pass-check-system/
Thank you!
Questions/Comments:
przemj+PI:EMAIL
Slides: https://www.slideshare.net/secret/5ohSBnJcbYhIMd