12 Hr
12 Hr
24 Hr
24 Hr
1
1
2
2
3
3
5
5
7
7
10
10
14
14
21
21
30
30
Stale Cache Size (days)
Stale Cache Size (days)
Figure 4: Fraction of Accurate Records in responses based on
a stale cache of varying size during an attack wherein none of
the nameservers are operational.
3.1 Is history useful?
We wanted to determine if there is any value to maintaining his-
torical information in the form of DNS records beyond their TTL-
values. To this effect, we consider an attack wherein none of the
DNS nameservers are operational and hence, all queries that cannot
be answered based on the information cached at the resolvers rely
on the simulated stale cache. Note that this is does not represent
a realistic ï¬‚ooding attack; instead, the objective here is to use an
extreme scenario to test the limits of the value of keeping around
stale DNS information.
We simulated the attack scenario described above for varying
attack durations and varying stale cache sizes. Here we focus on
those queries that cannot be answered based on the resolver cache.
Figure 3 plots the fraction of such queries that can be answered
based on the stale cache. The figure shows that a 1-day stale cache
can be used to answer 68% of such queries over the course of a
3-hour attack. The fraction of queries answered increases with the
stale cache size; for instance, a 3-day stale cache can answer 73.7%
and a 14-day stale cache can answer 79.6% of the queries. How-
ever, increasing the stale cache size beyond 14 days yields dimin-
ishing returns; for instance, a 21-day stale cache can answer 80.7%
and a 30-day stale cache can answer 81.5% of the queries.3 Past
studies have found that the popularity of DNS names follows a zipf
distribution [11] and the diminishing returns from increasing the
stale cache size appear to be a consequence of this.
The variation of the fraction of queries answered with the at-
3For clarity, the X-axis in figure 3 and the figures in the rest of this
section is limited to some chosen stale cache sizes.
d
d
e
e
r
r
e
e
w
w
s
s
n
n
A
A
s
s
e
e
i
i
r
r
e
e
u
u
Q
Q
S
S
N
N
-
-
f
f
o
o
n
n
o
o
i
i
t
t
c
c
a
a
r
r
F
F
d
d
e
e
r
r
e
e
w
w
s
s
n
n
A
A
s
s
e
e
i
i
r
r
e
e
u
u
Q
Q
A
A
-
-
f
f
o
o
n
n
o
o
i
i
t
t
c
c
a
a
r
r
F
F
 1
 1
 0.9
 0.9
 0.8
 0.8
 0.7
 0.7
 0.6
 0.6
 0.5
 0.5
 0.4
 0.4
 1
 1
 0.9
 0.9
 0.8
 0.8
 0.7
 0.7
 0.6
 0.6
 0.5
 0.5
 0.4
 0.4
Queries Answered
Queries Answered
Accurate Records
Accurate Records
1
1
2
2
5
5
3
3
Stale Cache Size (days)
Stale Cache Size (days)
10
10
7
7
14
14
(a) NS-queries
Queries Answered
Queries Answered
Accurate Records
Accurate Records
1
1
2
2
5
5
3
3
Stale Cache Size (days)
Stale Cache Size (days)
10
10
7
7
14
14
 1
 1
 0.998
 0.998
 0.996
 0.996
 0.994
 0.994
 0.992
 0.992
 0.99
 0.99
 0.988
 0.988
 0.986
 0.986
 0.984
 0.984
 1
 1
 0.998
 0.998
 0.996
 0.996
 0.994
 0.994
 0.992
 0.992
 0.99
 0.99
 0.988
 0.988
 0.986
 0.986
 0.984
 0.984
s
s
d
d
r
r
o
o
c
c
e
e
R
R
e
e
t
t
a
a
r
r
u
u
c
c
c
c
A
A
f
f
o
o
n
n
o
o
i
i
t
t
c
c
a
a
r
r
F
F
s
s
d
d
r
r
o
o
c
c
e
e
R
R
e
e
t
t
a
a
r
r
u
u
c
c
c
c
A
A
f
f
o
o
n
n
o
o
i
i
t
t
c
c
a
a
r
r
F
F
21
21
30
30
21
21
30
30
(b) A-queries
Figure 5: For (a) NS-queries and (b) A-queries, Fraction of
Queries Answered and Accurate Records when using a stale
cache during an 3-hour attack.
tack duration for a given stale cache size is a little more compli-
cated. For a small stale cache (99.5% with a stale cache of more than 10
days.
Overall, these results show that even in the extreme attack sce-
nario considered here, the stale cache can answer a significant frac-
tion of the client queries in a surprisingly accurate fashion.
3.2  Performance  under  different  attack
scenarios
We now evaluate the performance of the stale cache under three
different attacks scenarios. The first attack involves the root-servers
not being accessible to the clients. Today, such an attack would
cause any queries for NS records corresponding to the top-level
domains (TLDs) to fail.5 However, in case of the trace-based simu-
lation of a stale cache, all such queries succeeded. This is because,
for the query and response pattern captured in our trace, the NS
records for all the TLDs were present either in the cache or the stale
cache at all times. Thus, the stale cache would have ensured that all
4We explain the increase in the fraction of NS-queries answered
later in the section.
5This assumes that the NS records are not present in the cache of
the network resolvers or have expired since the attack started.
Queries Answered
Queries Answered
Accurate Records
Accurate Records
 1
 1
 0.9
 0.9
 0.8
 0.8
 0.7
 0.7
 0.6
 0.6
 0.5
 0.5
 0.4
 0.4
d
d