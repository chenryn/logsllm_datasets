in Hyb2,3,1. We then carry out the same steps for the second key,
third key, and so on, until all the keys are of type Normal⋆. Thus,
we define the following hybrids for q = 1, . . . , Q, where Q is the
total number of key queries A makes.
• Hyb2,1,q: Same as Hyb1 except first i − 1 keys are Normal⋆,
ith key is P-normal, and rest are Normal.
• Hyb2,2,q: Same as Hyb2,1,q except ith key is P-normal⋆.
• Hyb2,3,q: Same as Hyb2,2,q except ith key is Normal⋆.
The next objective is to show that the challenge ciphertext is
able to hide the message encrypted if none of the keys issued can
decrypt it individually. Here we first change the form of ciphertext
from Normal⋆ to SF⋆ in Hyb3. Then one by one we change all the
keys from Normal⋆ to P-normal⋆, then to P-SF⋆, and finally to
SF⋆. The extra component αa⊥ now present in all the keys helps
us to then make the ciphertext Rnd⋆. Thus, the hybrids are
• Hyb3: Same as Hyb2,3,Q except ciphertext is SF⋆.
• Hyb4,1,q: Same as Hyb3 except first i − 1 keys are SF⋆, ith
key is P-normal⋆, and rest are Normal⋆.
• Hyb4,2,q: Same as Hyb4,1,q except ith key is P-SF⋆.
• Hyb4,3,q: Same as Hyb4,2,q except ith key is SF⋆.
• Hyb5: Same as Hyb4,3,Q except ciphertext is Rnd⋆.
Note that in all the hybrids, the random oracle is simulated in
the same way as in Hyb1. Also, two additional hybrids Hyb2,3,0 and
Hyb4,3,0 are defined to be same as Hyb1 and Hyb3, respectively.
C.2 Sampling algorithm
On input a prime p, recall that Samp outputs
u1
0
1
 ,
0
u2
1
Z :=
u1−1
u2−1
−1
 ,
z⊥ :=
(C.1)
where u1, u2 ←R Z∗
p. If [X||Y] is used to denote the column-wise
join of two matrices X and Y, then note that [Z||z⊥] is a full-rank
matrix. Also, observe that the matrix Z here has exactly the same
distribution as A from the DLIN assumption, and that ZTz⊥ = 0.
We will need the following basis lemma from [19].
2 ⟩ (cid:44) 0.
1 ) and (Z2, z⊥
2 ] and [Z2||z⊥
Lemma C.1 (Basis lemma). Let (Z1, z⊥
2 ) be two inde-
pendent samples drawn from Samp(p). Then with probability 1− 1/p,
it holds that [Z1||z⊥
1 ] are full-rank matrices as well as
⟨z⊥
1 , z⊥
C.3 Indistinguishability of hybrids
In the following, AdvA
i, j(λ) denotes the advantage of an adversary A
in distinguishing Hybi from Hybj when the security parameter is
λ. Although the indistinguishability of every pair of hybrids below
holds irrespective of the value of bit b given to the challenger, we
do not put this explicitly into the theorem statements.
0,1(λ) = 0.
Lemma C.2. For any adversary A, AdvA
Proof. First of all, it is easy to see that the master public and
secret keys are generated identically in both the hybrids because
the first output of Samp has exactly the same distribution as A
from the DLIN assumption (§2.5). Further, the response of Chal
on an oracle query of the form xℓt in Hyb1 is [(WT
x A)ℓ,t]1, whose
exponent is at(Wx)t, ℓ + (Wx)3, ℓ, for randomly chosen (Wx)t, ℓ
and (Wx)3, ℓ. Hence, [(WT
x A)ℓ,t]1 is independently and uniformly
distributed for every x, ℓ, t. In the same way, we can argue that
the response to queries of the form 0jℓt are also independent and
uniform over G. Thus, Chal perfectly simulates a random oracle.
If we implicitly set the responses of random oracle in Hyb0 to
be the ones generated by Chal in Hyb1, then the cti, ℓ component
14
• Setup(1λ) Same Setup as that of Fame.
• KeyGen(msk,(M, π)) Pick r1, r2 ←R Zp and compute
using h, b1, b2 from msk. Pick σ ′
· H(π(i)2t) b2r2
ski,t := H(π(i)1t) b1r1
at
at
· H(π(i)3t) r1 +r2
at
2, . . . , σ ′
n2 ←R Zp. For all i = 1, . . . , n1 and t = 1, 2, compute
H(0j1t) b1r1
at
· H(0j2t) b2r2
at
· H(0j3t) r1 +r2
at
· д
(cid:21)(M)i, j
,
σ′
j
at
sk0 := (hb1r1 , hb2r2 , hr1+r2)
σi
at
· д
·(cid:16)
дdt(cid:17)(M)i,1 ·
n2
(cid:16)
−σi ·(cid:16)
дd3(cid:17)(M)i,1 · n2
j=2
д
(cid:20)
−σ′
j
j=2
(cid:17)(M)i, j
,
ski,3 := д
where σi ←R Zp. Set ski := (ski,1, ski,2, ski,3). Output (sk0, sk1, . . . , skn1) as the key.
• Encrypt(pk, S, msg) Pick s1, s2 ←R Zp and compute
using pk. For all y ∈ S and ℓ = 1, 2, 3, compute
Set cty := (cty,1, cty,2, cty,3). Also, compute
ct0 := (H
s1
1 , H
s2
2 , hs1+s2).
cty, ℓ := H(yℓ1)s1 · H(yℓ2)s2 .
ct′ := T
s1
1 · T
s2
2 · msg.
Output (ct0, {cty}y∈S , ct′) as the ciphertext.
• Decrypt(pk, ct, sk) Same as the decryption algorithm of Fame except that for any i ∈ I, ctπ(i) is used to compute num and ski to
compute dec. Also, note that there is no sk′ component in the key.
Figure B.1: Key-policy attribute-based encryption.
of the challenge ciphertext in Hyb0 is set to
(cid:20)
(WT

π(i)A)ℓ,1s1 + (WT
π(i)A)ℓ,2s2+
(cid:8)(UT
j A)ℓ,1s1 + (UT
j A)ℓ,2s2(cid:9)(M)i, j
(cid:21)
1
j
for ℓ ∈ {1, 2, 3}. Therefore, cti is equal to
[WT
π(i)As + (M)i,1UT1As + . . . + (M)i,n2UT
n2As]1,
if s is defined to be (s1, s2)T. We can also rewrite ct0 and ct′ as [As]2
and [dTAs]T · msgb, respectively. Thus, we obtain a ciphertext
identical to the one in Hyb1.
Let us now turn to the key component sky,t , which is implicitly
set to(cid:20)
(WT
yA)1,t
b1r1
at
+ (WT
yA)2,t
b2r2
at
+
(WT
yA)3,t
r1 + r2
at
+
σy
at
(cid:21)
1
15
+
+
1
at
σy
at
for t ∈ {1, 2}. If we denote the (i, j)th element of Wy by wi, j, then
the exponent of д in sky,t can be expanded as:
+ (at wt,2 + w3,2)b2r2
at
(at wt,3 + w3,3)r1 + r2
at
= (wt,1b1 + wt,3)r1 + (wt,2b2 + wt,3)r2+
(at wt,1 + w3,1)b1r1
at
= (WyBr)t + a
(cid:2)(w3,1b1 + w3,3)r1 + (w3,2b2 + w3,3)r2+
(cid:3)
(cid:2)(WyBr)3 + σy
(cid:3),
(cid:3). Now note that if
can be written as (WyBr)3 −(cid:2)(WyBr)3 + σy
where r := (r1, r2)T. The third part of sky is д−σy , whose exponent
σy is uniformly random, then so is (WyBr)3 + σy. Hence, sky is
identically distributed to [WyBr + σya⊥]1.
In the same way, we can show that sk′ is identically distributed
to [d + U1Br + σ ′a⊥]1 for a randomly chosen σ ′. Finally, sk0 can
be described succinctly as [Br]2. Thus, we obtain a key identical to
the one output in Hyb1.
□
Lemma C.3. For all q = 1, . . . , Q and PPT adversaries A, there
−1
t
σy
exists a PPT adversary B such that
AdvA
(2,3,q−1),(2,1,q)(λ) ≤ AdvB
DLIN(λ) + 1/p.
Proof. The only difference between Hyb2,3,q−1 and Hyb2,1,q is
in the form of the ith key issued by the challenger. In the former case,
this key is Normal while in the latter, it is P-normal. We design an
adversary B that converts any advantage A has in distinguishing
the two hybrids into an (almost) equal advantage in breaking the
DLIN assumption.
B gets ([B]1,[B]2,[Br∗]1,[Br∗]2) or ([B]1,[B]2,[r′]1,[r′]2) as
the DLIN challenge, and simulates the challenger in the IND-CPA
security game that it plays with A. It draws (A, a⊥) from Samp and
d ←R Z3
p, and gives ([A]2,[dTA]T ) to A as the public key. Further,
it simulates the random oracle in the same way as the challenger
does in Hyb2,3,q−1 or Hyb2,1,q.
Since [B||a⊥] is a full-rank matrix (except with probability 1/p,
see Lem C.1), we can say that B receives ([B]1,[B]2,[Br∗ + ˆra⊥]1,
[Br∗ +ˆra⊥]2) as the DLIN tuple, where ˆr is either zero or a randomly
chosen value from Zp.
It is straightforward for B to generate the challenge ciphertext.
To generate any of the first i−1 keys, B picks r ←R Z2
p and outputs
([Br]2, {[WyBr]1}y∈S ,[d + U1Br]1) 14; only [B]1, [B]2 are required
for this. The other keys, except the ith, are also easily generated
since B knows a⊥.
Now, in order to generate the ith key, B picks σy ←R Zp for
y ∈ S and σ ′ ←R Zp, and outputs
([Br∗ + ˆra⊥]2, {[Wy(Br∗ + ˆra⊥) + σya⊥]1}y∈S ,
[d + U1(Br∗ + ˆra⊥) + σ
′a⊥]1).
It is easy to see that if ˆr = 0, the view of A is identical to that in
Hyb2,3,q−1; otherwise, the view is identical to Hyb2,1,q.
□
Lemma C.4. For all q = 1, . . . , Q and adversaries A,
AdvA
(2,1,q),(2,2,q)(λ) ≤ 2/p.
Proof. We want to prove that the view of any adversary (even
unbounded) in Hyb2,1,q is identically distributed to its view in
Hyb2,2,q (except with negligible probability). Towards this, let V
be a matrix defined by the product of a⊥ with the transpose of b⊥.
Note that VTA = VB = 0 and Va⊥ = (a⊥b⊥T)a⊥ = a⊥(b⊥Ta⊥) =
(a⊥Tb⊥)a⊥ since b⊥Ta⊥ is nothing but the inner product of a⊥ and
b⊥. Let β denote this inner product, which is non-zero except with
probability 1/p (see Lem C.1).
Consider the hybrid Hyb2,1,q. Suppose Wx is implicitly set to
:= Uj − σ ′(β ˆr)−1V, where
x := Wx − σx(β ˆr)−1V and Uj to U∗
W∗
σx , σ ′, ˆr ←R Zp (ˆr (cid:44) 0 with probability 1 − 1/p). This does not
affect the distribution of these matrices because they are chosen
at random. The ciphertext is not affected either since (W∗
π(i))TA =
π(i)A and, similarly, (U∗
j A. Analogously, the form of all
WT
the keys except the ith one remains unchanged. In the case of ith
key, we have
W∗
y(Br + ˆra⊥) + σya⊥
j)TA = UT
j
= (Wy − σy(β ˆr)−1V)(Br + ˆra⊥) + σya⊥
= WyBr − σy(β ˆr)−1ˆrVa⊥ + Wy ˆra⊥ + σya⊥
= Wy(Br + ˆra⊥) − σy β
= Wy(Br + ˆra⊥)
βa⊥ + σya⊥
−1
14A separate r is used for each key.
16
n2
ct0 := [As + ˆsb⊥]2
cti := [WT
j=1
ct′ := [dT(As + ˆsb⊥)]T · msgb ,
π(i)(As + ˆsb⊥) +
(M)i, j UT
j (As + ˆsb⊥)]1
and, similarly, d +U∗
1(Br + ˆra⊥) +σ ′a⊥ = d +U1(Br + ˆra⊥), which is