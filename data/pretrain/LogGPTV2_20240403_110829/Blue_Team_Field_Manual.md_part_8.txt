C:\r>e qgu ery
HKCU\Software\Microsoft\Windows\CurrentVersion\Explo
rer\ComD1g32\0/pse n5avePidlMRU
C:\r>e qgu ery
HKCU\Software\Microsoft\Windows\CurrentVersion\Explo
rer\RunMRU
C:\r>e qgu ery
«HKCU\Software\Microsoft\Windows\CurrentVersion\Expl
orer\SFhoelldle rs"
72
C:\r>e qgu ery
uHKCU\Software\Microsoft\Windows\CurrentVersion\Expl
orer\SUhseeFlrol l ders"
C:\r>e qgu ery
HKCU\Software\Microsoft\Windows\CurrentVersion\Apple
ts\Reg/EvLd aistt Key
C:\r>e qgu e"rHyK CU\Software\Microsoft\Internet
Exlpro re T\ y pedURLs"
C:\r>e qgu ery
uHKCU\Software\Policies\Microsoft\Windows\Control
Pan\eDle sktop"
HKEY_LOCAL_MACHINE:
C\:> r eqgu eurHyK LM\SOFTWARiEv\eM ic rosoft\Act
Setup\InCsotmaploln/eesdn ts"
C:\r>e qgu ery
"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\expl
orer\SUhseeFlrol l ders"
C:\r>e qgu ery
"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\expl
orer\SFhoelldle rs"
C:\r>e qgu ery
HKLM\Software\Microsoft\Windows\CurrentVersion\explo
rer\ShellExecuteHooks
C:\r>e qgu ery
"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Expl
orer\BHroewlspOeebrrj ec/tss "
C:\r>e qgu ery
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Polic
ies\Explorer\Run
C:\r>e qgu ery
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
C:\r>e qgu ery
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Runon
ce
73
C:\r>e qgu ery
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOn
ceEx
C:\r>e qgu ery
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunSe
rvices
C:\r>e qgu ery
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunSe
rvicesOnce
C:\r>e qgu ery
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Winlo
gon\Userinit
C:\r>e qgu ery
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\shell
ServiceObjectDelayLoad
C:\r>e qgu ery "HKLM\SOFTWARE\Microsoft\Windows
NT\CurrentVersion\Sch/esd ule\TaskCache\Tasks"
C:\r>e qgu e"rHyK LM\SOFTWARE\Microsoft\Windows
NT\CurrentVersion\Windows"
C:\r>e qgu e"rHyK LM\SOFTWARE\Microsoft\Windows
NT\CurrentVer/sfAi popni\nWiitn_dDoLwLss"
C:\r>e qgu e"rHyK LM\SOFTWARE\Microsoft\Windows
NT\CurrentVer/sfiS ohne\lWli nlogon"
C\:> r eqgu e"rHyK LM\SOFrToWsAoRfEt\\MWiicn dows
NT\CurrentVer/sfiU osne\rWiinnilto gon"
C:\r>e qgu ery
HKLM\SOFTWARE\Policies\Microsoft\Windows\Systern\Scri
pts
C:\r>e qgu ery
HKLM\SOFTW\AbRaEt\fCillaes\ssehsell\open\cornrnand
C:\r>e qgu ery
HKLM\SOFTWARE\Classes\cornfile\shell\open\cornrnand
74
C:\r>e qgu ery
HKLM\SOFTWARE\Classes\exefile\shell\open\command
C:\r>e qgu ery
HKLM\SOFTWARE\Classes\htafile\Shell\Open\Command
C:\r>e qgu ery
HKLM\SOFTWARE\Classes\piffile\shell\open\command
C:\r>e qgu ery
11HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\Current
Version\ExplHoerlepOreb\rjB erc/otsws s"e r
C:\r>e qgu ery
"HKLM\SYSTEM\CurrentControlSet\Control\Session
Manager"
C:\r>e qgu ery
"HKLM\SYSTEM\CurrentControlSet\Control\Session
Manager\KnownDLLs"
C:\r>e qgu ery
"HKLM\SYSTEM\ControlSet001\Control\Session
Manager\KnownDLLs"
LOGS
Copeyv enlto gs:
C:\w>e vtuetpiSlle curCi:t\y\mylogs.evtx
C:\w>e vtuetpSilyl stCe:m\ \mylogs.evtx
C:\w>e vtuetpill ApplCi:c\a\mylogs.evtx
Gelti sotfl ogrse motely:
Refh.t tps://technet.microsoft.com/en­
us/sysinternals/psloglist.aspx
C:\p>s log\l\ie p-th1e 2u la
-x
75
Cleaalrll ogasn sdt ara tb aselliongte om onitor:
PSC :\w>e vtuetlIi F lo reach{-wOebvjtecucltt i l
"$"_}
Lislto gf ilenaanmpdea st lho cation:
C:\w>m inct evengtepltao tgh ,filename,writeable
Takper eb realcoheg x port:
PSC :\w>e vtuetlIi F lo rEach-Objec-t{Get-Eventlog
Lo"g$_" EIx port--PCa(st:vh\ I,NcEs v -
App}e nd
Takpeo sbtr ealcohge xport:
PSC :\w>e vtuetlIi F lo rEach-Objec-t{Get-EventLog
Lo"g$"_ EIx port--PCaCst:vh\ ,-CASpVp} e nd
Comptawrofe i lbeass elainnpdeo sbtr ealcohg s:
PSC :\C>o mpare--ROebfjeercetn $c(eGOebtj­ect
Cont"eCn:t\ \.-tDxitf"f)e ren$c(eGOebtj-eCcotn tent
"C:\\B.>t>x t")
C.EtSx t
Thidse leatlellso gs:
PSC :\w>e vtuetlIi F lo reach{-wOebvjtecucltt i l
"_$"}
FILEDSR,I VAENSSDH ARIENSF ORMATION
C:\n>e uts \e\ 
C:\n>e sth are
C:\n>e ste ssion
C:\w>m ivco lulmiesb tr ief
C:\w>m ilco gicagledti sk
description,filesystem,name,size
C:\w>m isch agreent a me,path
76
Finmdu ltifpillteey poersa file:
C:\d>i /rA / 5/ T:*A, e*x,ed *l,lb *a·tP *S,1z ip
C:\d>i /rA / 5/ T:,exe
Finedx ecut(a.belxfeei )l neesw tehra Jna 1n, 2 017:
C:\f>o rfi/lpCe :s/\ M * ,e/x5e/ 0+ 1/1//2C0 17
"cm/dce ch@of date @@pfattihm"e
Finmdu ltifpillete ysp uessi lnogo p:
C:\f>o %rG in( .ex.ed,l. lb,a .tp,s d)of orfi-les
p" C:-"m* %-Gs - d+ 1/1/-2c0" 1c7m/d ce ch@of date
@fti@mpea th"
Searfcohfr i lneesw tehra dna te:
C:\f>o rfi/lPCe:s/\ 5 / 0+ 1/01//2C"0 c1m/7dc
ech@op a@tfhd ate"
Finlda rfgiel e(se:x amo rfi/l5/e M*s / C" cm/dci f@ fsiGzEeO
2097e1c5h2@o p a@tfhs ize"
Finfdi lweist Ahl terDnaattSaet reams:
Refh.t tps://technet.microsoft.com/en­
us/sysinternals/streams.aspx
C:\s>t re-asm
Finfdi lweist bha sdi gnaitnutrcoes v:
Refh.t tps://technet.microsoft.com/en­
us/sysinternals/bb897441.aspx
C:\s>i gch-ec-c h-k s - u-n obanOTFPIULTE NAME>,csv
Finadn sdh oown luyn sigfnieldwe ist bha sdi gnature
inC :
C:\s>i gch-ee-c u-k v -rs C :\
77
Lislto aduends igDnlelds :
Refh.t tps://technet.microsoft.com/en­
us/sysinternals/bb896656.aspx
C:\l>i stdl-lus .exe
C:\l>i stdl-lus
RuMna lwsacrae(n W indows oDfeffleinndee:r )
Refh.t tp://windows.microsoft.com/en­
us/windows/what-is-windows-defender-offline
C:\M>p CmdRu-nS.iegxnea tureUpdate
C:\M>p CmdRu-nS.ceaxne
78
LIVTER IA-GLEI NUX
SYSTIENMF ORMATION
# uanme- a
# utpime
# itm edtalt ec
# mount
USEIRN FORMATION
Vielwo ggienud s ers:
# w
Shoiwfa usehra se velro ggiendr emotely:
# lasotgl
# last
Viefwa illeodg ins:
#f aliol-ga
Vielwo cauls earc counts:
# ca/te tc/passwd
#cat/etco/ws had
Vielwo caglr oups:
#cat/etc/group
Vieswu daoc cess:
# ca/te tc/sudoers
Vieawc couwnittsUh I D0 :
#a wk- F':( $=3=" 0"{)rp in/te}t'c /passwd
# egr'e:p0 /+e't c/passwd
79
Vierwo oatu thorSiSzkHee day u thentications:
# ca/tr oot/.ssh/authorized_keys
Lisotff iloepse nbeyud s er:
# lso-fu
Vietwh reo outs ebra shhi story:
#c a/tr oot/,bash_history
NETWIONRFKO RMATION
Vienwe twionrtke rfaces:
#i fconfig
Vienwe twcoornkn ections:
#n ets-taantt up
# nets-tpalta ntux
Vielwi stepnoirntgs :
# nets-tnaatp
Vierwo utes:
#r oute
Vieawr tpa ble:
#a r-pa
Lisotfp rocelsissetse onnip nogr ts:
# lso-fi
SERVIINCFEO RMATION
Viepwr ocesses:
# ps- aux
Lisotfl oamdo dules:
# lsmod
80
Lisotfo pefni les:
# lsof
Lisotfo pefni leuss,i tnhgne e twork:
#l so-fn PIic u-tf 1 - d"" Iu niIqt ai-ln+ 2
Lisotfo pefni loenss pecipfriocc ess:
#l so-fc
Geatl olp efni loefsa s pecipfriocc IeDs:s
#l so-fp
Lisotfu nlinpkreodc ersusnensi ng:
#l so+fL l
Gepta tohfs uspicpirooucsPe IsDs:
#ls-a/lp roc//exe
Savfei lfeo fru rtmhaelrw bairnea arnya lysis:
#c p/ proc/I/D<>S/UeSxPFeII CLNIEAO MUTESO
SAVE>,elf
Moniltoogris nr eal-time:
#l es+sF/ var/log/messages
Lisste rvices:
#c hkco-n-fliigs t
POLIPCAYT,AC NHSD E TTIINNGFSO RMATION
Viepwa mf.idl es:
#c a/te tc/pam.d/common*
81
AUTOARNUADNU TOLIONAFDO RMATION:
Lisctr ojno bs:
# cron-tla b
Lisctr ojno bbsyr ooatn do theUrI D0 accounts:
#c ron-tuar bo o-tl
Revifeowur n uscuarloj no bs:
#c a/te tc/crontab
#l s/ etc/cron,*
LOGS
Vierwo outs ecro mmhainsdt ory:
# c/arto ot/,*history
Vielwa slto gins:
#l ast
FILEDSR,I VAENSSDH ARIENSF ORMATION