结合攻击类型及流量情况等，可采取不同的临时处置方法。
当流量较小，且在服务器硬件与应用接受范围内，并不影响业务时，可利用
IPTable实现软件层防护。
当流量较大，自身有抗DDoS设备，且在设备处理范围内，小于出口带宽时，
可根据攻击类型，利用IPTable，通过调整防护策略、限速等方法实现软件层防护。
272
第8章
DDoS攻击网络安全应急响应
若攻击持续存在，则可在出口设备配置黑洞等防护策略，或接入CDN防护。
当遇到超大流量，超出出口带宽及防护设备能力时，则建议申请运营商清洗。
8.3.4 研判溯源
将排查过程中整理出的IP地址进行梳理、归类，方便日后溯源。由于在DDoS
攻击中，攻击者多使用僵尸网络，因此为溯源带来很大难度。建议在遭受DDoS 攻
击时及时报案，并保留相关日志、攻击记录等。
8.3.5 清除加固
（1）尽量避免将非业务必需的服务端口暴露在公网上，从而避免与业务无关
的请求和访问。
（2）对服务器进行安全加固，包括操作系统及服务软件，以减少可被攻击的点。
（3）在允许投入的范围内，优化网络架构，保证系统的弹性和冗余，防止单
点故障发生。
（4）对服务器性能进行测试，评估正常业务环境下其所能承受的带宽。在允
许投入的范围内，保证带宽有一定的余量。
（5）对现有架构进行压力测试，以评估当前业务吞吐处理能力，为DDoS攻
击防御提供详细的技术参数指导信息。
（6）使用全流量监控设备（如天眼）对全网中存在的威胁进行监控分析，关
注相关告警，并在第一时间反馈负责人员。
（7）根据当前的技术业务架构、人员、历史攻击情况等，完善应急响应技术
预案。
8.4 典型处置案例
某单位遭受DDoS攻击事件如下。
1．事件背景
2019年2月17日，某机构门户网站无法访问，网络运维人员称疑似遭受DDoS
攻击，请求应急响应工程师协助。
2．事件处置
应急响应工程师在到达现场后，通过查看流量设备，发现攻击者使用僵尸网
273
网络安全应急响应技术实战指南
络在该时间段对网站发起了DDoS攻击，类型为混合攻击，如图8.4.1所示。
图8.4.1 设备告警信息
进一步对网络数据包进行抓取分析，发现攻击者使用HTTP Range分段请求
功能向服务端发起多次请求，服务端返回多个响应文件，造成网络负载过高，如
图8.4.2所示。
图8.4.2 网络数据包抓取分析
对服务器的访问日志进行排查，发现在2019年2月17日04时28分，某一
js文件出现大量503响应。最终经排查确认，攻击者主要使用HTTP Get攻击，导
致服务端返回多个响应文件，造成网络负载过高，产生拒绝服务。
3．根除及恢复
（1）配置防火墙策略，屏蔽异常读取的网站IP地址。
（2）调整防护设备策略，在不影响正常业务的情况下限制HTTP Range形式
访问。
274
第 9 章
数据泄露网络安全应急响应
9.1 数据泄露概述
9.1.1 数据泄露简介
数据泄露指对存储、传输或以其他形式处理的个人或机构数据造成意外或非
法破坏、遗失、变更、未授权披露和访问的一类安全事件。
确认是否为数据泄露安全事件主要依据以下三条基本原则。
（1）违反机密性：未授权或意外披露机密数据。
（2）违反可用性：意外丢失数据访问权或对机密数据造成不可逆转的破坏。
（3）违反完整性：机密数据未授权或意外变更。
9.1.2 数据泄露途径
1．外部泄露
外部泄露是指数据通过非企业自身系统进行泄露，如攻击者通过入侵企业内
部系统、广泛收集网络信息等方法获取敏感信息。
1）供应链泄露
（1）自身供应链泄露。自身供应链是指企业自身产品生产和流通过程中的采
购部门、生产部门、仓储部门、销售部门等组成的供需网络。如电商体系中的物
流系统、仓储管理系统、支付系统等，往往包含企业大量敏感信息，该类系统被
恶意攻击者入侵，可造成数据泄露。
（2）第三方供应商泄露。企业由于业务需要，使用或者购买了第三方服务，
如供应商代码仓库、供应商外包人员服务、供应商提供的SaaS服务等。恶意攻击
者通过入侵相关系统，造成数据泄露，或是第三方供应商为了牟取利益泄露数据。
网络安全应急响应技术实战指南
2）互联网敏感信息泄露
（1）搜索引擎。企业违规将敏感数据上传至公开的互联网网站，随后搜索引
擎收录企业相关网站，导致数据通过搜索引擎泄露。
（2）公开的代码仓库。企业相关研发运维人员违规将代码主动上传至公开的
代码仓库，如GitHub、Gitee等，导致数据泄露。
（3）网盘。企业相关人员违规将未加密的敏感数据主动上传至公开网盘，并
进行分享，导致数据泄露。
（4）社交网络。企业相关人员通过社交网络违规或无意识地披露敏感数据，
导致数据泄露。
3）互联网应用系统泄露
企业相关的互联网系统存在缺陷，如商城系统、VPN系统、邮件系统等，恶
意攻击者利用未授权访问、数据遍历、管理弱密码、SQL注入等漏洞，造成数据
被动泄露。
2．内部泄露
内部泄露是指数据通过企业自身系统进行泄露。
1）内部人员窃密（主动泄密）
企业内部人员非法窃密，并将数据售卖给他人牟利。如客服人员、内部研发
运维人员、数据运营人员等，通过自身权限获取企业数据以转售。
2）终端木马窃取
企业内部人员的办公终端被植入木马，造成数据被窃取。如员工在办公终端
上插入来历不明的U盘，使用非正规渠道下载的盗版软件，单击钓鱼邮件的诱导
内容等，导致终端被控制，造成数据泄露。
3）基础支撑平台泄露
部署在企业内部的基础支撑平台，如包含企业敏感数据的ES平台、Redis缓
存数据库、数据仓库等基础平台，因被攻击，而导致数据泄露。
4）内部应用系统泄露
攻击者利用未授权访问、数据遍历、管理弱密码、SQL注入等漏洞，攻击企
业内部的业务应用系统，获取相关数据。
276
第9章
数据泄露网络安全应急响应
9.1.3 数据泄露防范
1．数据外部泄露防范
应对数据外部泄露，需要做好如下防范工作：
（1）做好自身供应链（如物流、仓储、支付系统）和第三方供应商（如海外
购、第三方商店）的数据访问控制，尤其需要完善审计措施。
（2）做好互联网应用服务的安全配置并定期巡检，避免违规共享内容被搜索
引擎收录。针对内部员工进行全面的网络安全意识培训，规范数据存储和共享，
杜绝内部机密数据通过互联网存储和传输。建立邮件和社交网络使用规范，建立
红线机制并设定奖惩措施，防微杜渐。
（3）互联网应用系统正式上线前应进行全面的渗透测试，尽可能避免存在未
授权访问、管理弱密码、SQL注入等漏洞，导致数据泄露。
2．数据内部泄露防范
应对数据内部泄露，需要做好如下防范工作：
（1）业务系统运营人员和运维研发人员等的访问权限应做好访问控制，建立
相应角色并根据需求最小化原则分配访问权限，指派专员对业务系统的访问进行
审计。
（2）建立终端准入机制，统一部署杀毒和终端管控软件。
（3）通过安全意识培训，培养员工良好的终端使用习惯，避免数据通过终端
被窃取。
（4）内部应用系统正式交付前应做好全面的软件测试，避免存在隐藏的数据
调用接口。并在正式上线前做好渗透测试，避免攻击者通过数据遍历、未授权访
问和SQL注入等漏洞批量获取数据。
9.2 常规处置方法
9.2.1 发现数据泄露
1．外部反馈
外部反馈主要是指通过互联网披露、客户投诉、第三方机构通告等形式获知
机密或隐私数据已遭泄露，数据在小范围已经流传，造成了一定程度的负面影响，
277
网络安全应急响应技术实战指南
对所在单位可能造成经济损失和声誉影响。
2．监管通报
监管通报主要是指具有执法权的监管机构发现影响民生和公共安全的数据泄
露事件，对数据泄露的主体进行通报处罚，泄露的数据一般为大量个人隐私数据。
3．自行发现
自行发现主要是指单位、个人或自身供应链发现内部敏感、秘密信息被非法
披露至互联网，存在流传的迹象，可能会被竞争对手恶意利用且对单位造成声誉
影响。
9.2.2 梳理基本情况
与相关人员深入交流，明确数据泄露的类型，以及泄露数据的表现形式、存
储位置、关联系统等，根据现状判断数据是如何泄露的，并缩小排查范围。
9.2.3 判断泄露途径
通过目前已确定泄露的数据，逐一排查和确认可能的数据流转路径，判断数
据是由外部人员非法入侵或未授权访问窃取的，还是由内部人员恶意披露或违规
操作导致的。可通过数据的存储位置、可访问数据的人员属性和内部网络安全态
势情况进行初步确认。
若泄露数据存储于互联网可访问的服务器，业务系统未经过专业的上线安全
评估，则数据很可能是通过外部人员非法入侵泄露的。
若泄露数据存储于内部网络，且仅有少部分管理人员才能访问，内部网络安
全良好，则数据很可能是由内部人员恶意披露或是通过未授权访问窃取的。
除上述两种比较典型的数据泄露形式外，还有很多数据泄露事件需要安全人
员通过服务器的Web访问日志和系统日志进一步分析，结合内网安全态势进一步
判断，才能梳理出相对准确的数据泄露途径。
9.2.4 数据泄露处置
以下通过“互联网商城系统订单信息泄露事件”案例介绍数据泄露的处置过程。
梳理涉及本次事件的相关主要人员有公司领导、网络运维人员、服务器管理
员、业务运营管理员、系统开发商等。
278
第9章
数据泄露网络安全应急响应
以下是事件的处置过程：
（1）负责人员首先与公司领导进行面对面沟通，明确本次应急响应需要达成
的关键目标和注意事项，公司应尽可能地安排专门接口人进行协助。
（2）负责人员与网络运维人员进行沟通，梳理内部网络安全防护情况及对应
服务器区域的防护级别，最好能获取整个内部网络的拓扑或能绘制并提供简单的
拓扑，梳理可能的入侵路径，初步评估其难度。
（3）负责人员与服务器管理员沟通，确认服务器开放的服务和端口（特别是
已映射至互联网的），商城系统上线是否做过安全测试，是否开启了系统日志、
Web访问日志和其他审计日志等，导出相关日志，以便后续分析使用。
（4）负责人员与业务运营管理员进行沟通，梳理拥有访问订单数据权限的人
员，确认系统是否有设置单独的审计人员，是否存在关联的业务系统或引用商城
系统数据的情况。
（5）负责人员与系统开发商沟通，确认商城系统是否有做过专业的软件测试
和安全测试，相关服务是否使用了硬编码和弱密码。
（6）通过汇总现场沟通素材，结合以往事件处置经验，可以得出一个数据泄