OK
OK
OK
OK
d
e
s
i
g
n
i
d
n
u
m
o
B
o
r
e
p
c
m
n
o
a
t
c
s
n
i
U
D
Attack
OK
OK
OK
OK
OK
Attack
OK
OK
OK
OK
OK
OK
d
u
a
r
F
e
c
n
a
t
s
i
D
Attack
OK
Attack
OK
Attack
Attack
Attack
Attack
Attack
OK
OK
OK
OK
d
u
a
r
F
t
s
i
r
o
r
r
e
T
Attack
OK
Attack
Attack
Attack
Attack
Attack
Attack
Attack
Attack
Attack
Attack
OK
Example 1 (Section 2)
Example 2 (Section 2)
PaySafe
PaySafe with changes [28]
MasterCard’s RRP
NXP’s protocol (unique keys)
NXP’s protocol (global key)
NXP’s variant 1 (unique keys)
NXP’s variant 2 (unique keys)
Meadows et al. [30]
MAD (One-Way) [36]
CRCS [32]
Hancke and Kuhn [24]
Poulidor [35]
Tree-based [5]
Uniform [29]
n
o
i
t
a
m
r
o
f
n
i
y
t
i
c
i
t
n
e
h
t
u
a
i
g
n
i
m
T
N/A
N/A
N/A
N/A
OK
OK
OK
N/A
N/A
N/A
N/A
N/A
N/A
Table 1: Results of our veriﬁcation. The last four proto-
cols use the same underlying distance bounding method.
can conclude that all of the payment protocols meet their
security goals with regard to relay attacks.
NXP’s protocols with a unique key for every device
provide the same security against relay attacks as Master-
Card’s RRP and PaySafe. Here we again consider both
distance and terrorist fraud attacks not applicable due to
the underlying ISO/IEC 14443 protocol. However, if we
assume that a global key is shared across a range of de-
vices then security against relay attacks holds, but un-
compromised distance bounding security does not. This
is due to the fact that the compromise of one device is
equal to the compromise of the complete system. This
would represent a major security risk with, for example,
a single compromised key fob putting all cars at risk.
The only property that can distinguish the case where
one compromised device leads either to an attack only
on this one device or to the compromise of the complete
system, is our proposed uncompromised distance bound-
ing property. None of the properties suggested in previ-
ous papers can detect the difference between a global and
unique key used in the NXP protocol, so highlighting the
need for our work.
Regarding the authentication of timing information,
our analysis shows that MasterCard’s RRP, PaySafe and
NXP’s protocols with unique keys correctly bind the
identity to the timing information. As NXP’s protocol
with a global key does not authenticate the identity, we
check the timing information against the session nonces,
and ﬁnd that it correctly binds these. Therefore, for these
protocols, attacks aimed at the timing information will
not work.
8 Conclusion
We have presented an applied pi-calculus based mod-
elling framework for distance bounding protocols and at-
tacks. We built a hierarchy of distance bounding attack
1578    27th USENIX Security Symposium
USENIX Association
scenarios, and we have identiﬁed a new scenario for pro-
tocols that do not aim to protect against a compromised
prover. We have deﬁned a compiler from our calculus to
the applied pi-calculus and use this compiler to analyse
several distance bounding protocols, including protocols
by MasterCard and NXP. We have also shown how the
timing proﬁles used in these protocols can be veriﬁed.
Acknowledgements This work has been supported by
the Netherlands Organisation for Scientiﬁc Research
(NWO) through Veni project 639.021.750. We would
like to thank Ioana Boureanu and Sjouke Mauw for use-
ful comments on a draft of this paper.
References
[1] ABADI, M., BLANCHET, B., AND FOURNET, C. The Applied
Pi Calculus: Mobile Values, New Names, and Secure Communi-
cation. JACM 65, 1 (2017).
[2] ABADI, M., AND FOURNET, C. Mobile values, new names, and
secure communication. In POPL’01 (2001).
[3] AVOINE, G., BINGOL, M., BOUREANU, I., CAPKUN, S.,
HANCKE, G., KARDAS, S., KIM, C., LAURADOUX, C., MAR-
TIN, B., MUNILLA, J., AND ET AL. Security of distance-
bounding: A survey. CSUR 4 (2017).
[4] AVOINE, G., BING ¨OL, M. A., KARDAS¸, S., LAURADOUX, C.,
AND MARTIN, B. A framework for analyzing RFID distance
bounding protocols. JCS 19, 2 (2011).
[5] AVOINE, G., AND TCHAMKERTEN, A. An efﬁcient dis-
tance bounding RFID authentication protocol: Balancing false-
acceptance rate and memory requirement. In ISC’09 (2009).
[6] BBC. Car theft ’relay’ devices seized in Birmingham. http://
www.bbc.com/news/uk-england-birmingham-42370086.
[7] BLANCHET, B., ABADI, M., AND FOURNET, C. Automated
veriﬁcation of selected equivalences for security protocols. JLAP
(2008).
[8] BLANCHET, B., SMYTH, B., CHEVAL, V., AND SYLVESTRE,
M. ProVerif 2.00: Automatic cryptographic protocol veriﬁer,
user manual and tutorial, 2018.
[9] BOUREANU, I., MITROKOTSA, A., AND VAUDENAY, S. Practi-
cal and provably secure distance-bounding. JCS 23, 2 (2015).
[10] BOUREANU, I., AND VAUDENAY, S. Optimal proximity proofs.
vol. 8957 of LNCS.
[11] BRANDS, S., AND CHAUM, D. Distance-bounding protocols. In
EUROCRYPT’93 (1994).
[12] CHOTHIA, T., GARCIA, F. D., DE RUITER, J., VAN DEN
BREEKEL, J., AND THOMPSON, M. Relay cost bounding for
contactless EMV payments. In FC’15, vol. 8975 of LNCS. 2015.
[13] CREMERS, C. J. F., RASMUSSEN, K. B., SCHMIDT, B., AND
CAPKUN, S. Distance hijacking attacks on distance bounding
protocols. In S&P’12 (2012), IEEE.
[14] DE, J., HUBMER, P., MURRAY, B., NEUMANN, H., STERN, S.,
AND THUERINGER, P. Decoupling of measuring the response
time of a transponder and its authentication, 2011. EP Patent
App. EP20,080,874,469.
[15] DEBANT, A., DELAUNE, S., AND WIEDLING, C. Proving phys-
ical proximity using symbolic models. Research report, Univ
Rennes, CNRS, IRISA, France, 2018.
[16] DESMEDT, Y. Major security problems with the ’unforge-
able’ (Feige)-Fiat-Shamir proofs of identity and how to overcome
them. In SECURICOM (1988).
[17] DESMEDT, Y., GOUTIER, C., AND BENGIO, S. Special uses and
abuses of the Fiat-Shamir passport protocol. In CRYPTO (1987),
vol. 293 of LNCS.
[18] D ¨URHOLZ, U., FISCHLIN, M., KASPER, M., AND ONETE, C.
In
A formal approach to distance-bounding RFID protocols.
ISC’11 (2011).
[19] EMVCO. EMV – Integrated Circuit Card Speciﬁcations for Pay-
ment Systems, version 4.3, 2011.
[20] EMVCO. EMV Contactless Speciﬁcations for Payment Systems,
version 2.6, 2016.
[21] FRANCILLON, A., DANEV, B., AND CAPKUN, S. Relay attacks
In
on passive keyless entry and start systems in modern cars.
NDSS’11 (2011).
[22] GARCIA, F. D., OSWALD, D., KASPER, T., AND PAVLID `ES, P.
Lock it and still lose it —on the (in)security of automotive remote
keyless entry systems. In USENIX Security’16 (2016), USENIX.
[23] HABRAKEN, R., DOLRON, P., POLL, E., AND DE RUITER,
J. An RFID skimming gate using higher harmonics. In RFID-
Sec’15, vol. 9440 of LNCS. 2015.
[24] HANCKE, G., AND KUHN, M. An RFID distance bounding pro-
tocol. In SecureComm’05 (2005), IEEE, pp. 67–73.
[25] JANSSENS, P.
Proximity check for communication devices,
2017. US Patent 9,805,228.
[26] KANOVICH, M., KIRIGIN, T. B., NIGAM, V., SCEDROV, A.,
AND TALCOTT, C. Towards timed models for cyber-physical
security protocols. In FCS-FCC’14 (2014).
[27] MALLADI, S., BRUHADESHWAR, B., AND KOTHAPALLI, K.
CoRR
Automatic analysis of distance bounding protocols.
abs/1003.5383 (2010).
[28] MAUW, S., SMITH, Z., TORO-POZO, J., AND TRUJILLO-
RASUA, R. Distance-bounding protocols: Veriﬁcation without
time and location. In S&P’14 (2018).
[29] MAUW, S., TORO-POZO, J., AND TRUJILLO-RASUA, R. A
In
class of precomputation-based distance-bounding protocols.
EuroS&P’16 (2016).
[30] MEADOWS, C. A., POOVENDRAN, R., PAVLOVIC, D., CHANG,
L., AND SYVERSON, P. F. Distance bounding protocols: Au-
thentication logic analysis and collusion attacks. In Secure Lo-
calization and Time Synchronization for Wireless Sensor and Ad
Hoc Networks (2007).
[31] NIGAM, V., TALCOTT, C., AND URQUIZA, A. A. Towards
the automated veriﬁcation of cyber-physical security protocols:
Bounding the number of timed intruders. In ESORICS’16 (2016).
[32] RASMUSSEN, K. B., AND ˇCAPKUN, S. Realization of RF dis-
tance bounding. In USENIX Security’10 (2010).
[33] RYAN, M. D., AND SMYTH, B. Applied pi calculus. In Formal
Models and Techniques for Analyzing Security Protocols. IOS,
2011, ch. 6.
[34] SCHALLER, P., SCHMIDT, B., BASIN, D., AND CAPKUN, S.
Modeling and verifying physical properties of security protocols
for wireless networks. In CSF’09 (2009).
[35] TRUJILLO-RASUA, R., MARTIN, B., AND AVOINE, G. The
[36]
poulidor distance-bounding protocol. In RFIDSec’10 (2010).
ˇCAPKUN, S., BUTTY ´AN, L., AND HUBAUX, J.-P. Sector: Se-
cure tracking of node encounters in multi-hop wireless networks.
In SASN’03 (2003).
USENIX Association
27th USENIX Security Symposium    1579
Figure 6 Ordering of all distance bounding attack scenarios that follows from lemmas 1, 2 and 3
1580    27th USENIX Security Symposium
USENIX Association
Distance	Fraud	[V(id)]	|	[DP(id)]		[V(id)|DP(id’)]	|	[P(id)]	Maﬁa	fraud/Relay	[V(id)|A]	|	[P(id)|A]		[V(id)]	|	[P(id)|A]		[V(id)|P(id’)]	|	[P(id)|A	]	[V(id)|P(id’)]	|	[P(id)|DP(id’)]	[V(id)|A|P(id’)]	|	[P(id)]	Terrorist	Fraud	[V(id)|A]	|	[DP(id)]	[V(id)|P(id’)|A]	|	[DP(id)]	Distance	Hijacking	[V(id)|P(id’)]	|	[DP(id)]	[V(id)]	|	[	DP(id)]						[V(id)|TP(id’)]	|	[TP(id)]	[V(id)|DP(id’)]	|	[P(id)]	[V(id)|DP(id’)]	|	[TP(id)]	[V(id)|A	]	|	[P(id)]	[V(id)|DP(id’)]	|	[P(id)|A]	[V(id)|P(id’)|A]	|	[P(id)|A]	[V(id)|DP(id’)]	|	[P(id)|DP(id’)]	[V(id)]	|	[P(id)|DP(id')]	[V(id)]	|	[P(id)|DP(id')]	[V(id)]	|	[DP(id)|DP(id')]		[V(id)|A]	|	[DP(id’)|P(id)]		[V(id)|P(id’)]	|	[DP(id)|DP(id’)]	[V(id)|P(id’)]	|	[DP(id)]	[V(id)|P(id’)]	|	[P(id)|DP(id’)]	[V(id)|DP(id’)]	|	[P(id)|DP(id’)]	[V(id)|A|P(id’)]	|	[P(id)|DP(id’)]	Assisted	Distance	Fraud		Key:				P(id):					honest	provers	with	iden=ty	“id”							V(id):					veriﬁer	wishing	to	veriﬁer	“id”				A:											aCacker	process				TP(id):		terrorist	provers,	ac=ng	as	“id”				DP(id):		dishonest	provers,	ac=ng	as	“id”