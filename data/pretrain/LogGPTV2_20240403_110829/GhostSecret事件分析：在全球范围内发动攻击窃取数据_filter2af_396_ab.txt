121.240.155.78  
223.30.98.169  
223.30.98.170  
14.140.116.172
## 六、对SSL监听器的分析
植入物从C&C服务器接收基于HTTP协议的命令，并会从HTTP头解析HTTP Content-Type和Content-Length。如果HTTP
Content-Type值为8U7y3Ju387mVp49A，则会执行由C&C服务器指定的命令：  
该植入物具有如下功能：  
1、将从C&C服务器接收到的可执行文件写入到临时文件并执行。  
2、收集系统信息并将其发送到C&C服务器。  
从终端收集的系统信息包括：  
（1）终端的MAC地址；  
（2）计算机名称；  
（3）产品名称（来源于HKLMSoftwareMicrosoftWindows NTCurrentVersion ProductName）；  
这些信息被组合成一个格式为“MAC地址|计算机名称|产品名称”的字符串，并发送到C&C服务器。  
3、使用当前的系统时间戳，将来自C&C服务器的HTTP请求记录到植入物安装目录下的临时文件prx中。
## 七、对主要植入物的分析
2018年2月发现的植入物样本具有多种功能，包括信息泄露和被感染系统的任意命令执行。考虑到植入物可以从C&C服务器收到各种类型的指令，因此该植入物也具有非常强大的数据侦查功能框架，并且可以被有效利用。例如，该植入物可以擦除或删除文件、执行另外的植入物、从文件中读取数据。  
通过动态加载API来执行恶意事件，主要植入物开始执行。用于加载API的库包括：  
Kernel32.dll  
Apvapi32.dll  
Oleaut32.dll  
Iphlpapi.dll  
Ws2_32.dll  
Wtsapi32.dll  
Userenv.dll  
Ntdll.dll  
主要植入物动态加载API：  
在初始化过程中，植入物会收集系统基本信息，并使用443端口上的SSL将其发送到硬编码写入的C&C服务器203[.]131.222[.]83：  
1、系统区域中设置的国家、地区名称；  
2、操作系统版本；  
3、处理器描述，来源于  
HKLMHARDWAREDESCRIPTIONSystemCentralProcessor ProcessorNameString位置；  
4、计算机名称和网络适配器信息；  
5、本地磁盘C:到Z:的磁盘空间信息，包括总物理空间大小、总可用空间大小，以字节为单位；  
6、当前内存状态，包括总物理内存大小、总可用内存大小，以字节为单位；  
7、基于当前远程会话的域名和用户名。  
使用Win32 WTS API提取域名和用户名：  
## 八、数据侦查过程
植入物通过SSL接收编码后的数据，该数据会被解码，从而确定有效的命令ID。有效的命令ID位于0和0x1D之间。  
根据不同的命令ID，植入物可以执行以下功能：  
1、收集系统信息并将其发送到C&C服务器（与前文中介绍的基本数据收集功能相同）。  
2、获取系统中所有驱动器的卷信息（从A：到Z:）并发送到C&C服务器。  
3、列出目录中包含的文件，该目录路径由C&C服务器指定。  
4、读取文件的内容，并将其发送到C&C服务器。  
5、将C&C服务器发送的数据写入指定的文件路径。  
打开文件的句柄，以执行写入，但不具有共享权限：  
将从C&C服务器接收到的数据写入到文件：  
6、根据C&C服务器指定的文件路径，创建新进程：  
7、擦除和删除C&C服务器指定的文件。  
8、使用cmd.exe在系统上执行二进制文件，并将结果记录到临时文件中，然后读取并将记录结果发送到C&C服务器。  
命令行：cmd.exe /c “ > %temp%PM*.tmp 2>&1”  
9、获取所有当前运行进程的信息。  
获取系统中所有进程的进程时间：  
从与正在运行进程相关联的账户获取用户名和域名：  
10、使用批处理文件从磁盘删除其自身。  
11、将从C&C服务器收到的编码后数据，作为注册表值，存储在  
HKLMSoftwareMicrosoftWindowsCurrentVersionTowConfigs的Description中。  
12、设置并获取植入物的当前工作目录。  
在植入物中的命令处理程序索引表如下所示：  
## 九、总结
根据McAfee高级威胁研究团队的分析，我们认定该组件源于Hidden
Cobra团体，同时继续针对全球各地的组织发动攻击。自2015年以来，这些用于数据收集的植入物不断发生变化，这也侧面证明了该攻击者团队具有较强的开发能力。在我们的调查中，发现了一个未知的恶意软件工具，与近期源于印度服务器发动的一些攻击相关，这些位于印度的服务器使用了先进的植入物，建立一个隐蔽的网络，用于收集数据和发起进一步的攻击。  
我们将持续进行相关调查和研究，并根据进展实时发布更新。  
打击网络犯罪需要全球范围内国家组织和私营组织的一同努力，McAfee也正在与泰国政府当局合作，取缔GhostSecret控制的C&C服务器，同时保留相应系统中的证据以供执法机关进行进一步分析。
## 十、IoC
###  10.1 MITRE ATT&CK
通过C&C服务器通道进行渗透：使用自定义协议在C&C服务器通道上泄漏数据。  
常用端口：攻击者使用公共端口（443端口）进行C&C服务器通信。  
服务执行：将植入物注册为被感染主机上的服务。  
自动收集：植入物自动收集有关被感染用户的数据，并将其发送到C&C服务器。  
来自本地系统的数据：搜寻本地系统，并收集数据。  
发现进程：植入物可以列出在系统上运行的进程。  
发现系统时间：在部分数据侦察活动中采用的方法，将系统时间发送到C&C服务器。  
删除文件：恶意软件可以删除攻击者指定的文件。
###  10.2 IP地址
203.131.222.83  
14.140.116.172  
203.131.222.109
###  10.3 Hash
fe887fcab66d7d7f79f05e0266c0649f0114ba7c  
8f2918c721511536d8c72144eabaf685ddc21a35  
33ffbc8d6850794fa3b7bccb7b1aa1289e6eaa45