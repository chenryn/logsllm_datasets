Let’s Get Physical
Network Attacks Against Physical Security Systems
Ricky “HeadlessZeke” Lawshae – Defcon24 – 2016
Intro
Let's Get Physical
3
Intro
Who am I?
• Security Researcher at TippingPoint
• IoT (drink!) hacking enthusiast
• Occasional conference presenter
• Used to install physical security systems for a living
Who am I?
• Security Researcher at TippingPoint
• IoT (drink!) hacking enthusiast
• Occasional conference presenter
• Used to install physical security systems for a living
Let's Get Physical
4
Intro
Physical Security
• Electronic or mechanical devices used for
• Access control
• Surveillance
• Alarms
• Card readers, door controls, video cameras, DVRs, motion 
sensors, fire alarms, tamper switches, etc etc etc
Physical Security
• Electronic or mechanical devices used for
• Access control
• Surveillance
• Alarms
• Card readers, door controls, video cameras, DVRs, motion 
sensors, fire alarms, tamper switches, etc etc etc
Let's Get Physical
5
Intro
Deployment
• Used by basically every organization of any size
• Piece by piece getting put on the network
• Acknowledge alarms and watch cameras
• Push schedule and access changes
• Pull logs and reports
• Physical is becoming digital...IoT (drink!)
Deployment
• Used by basically every organization of any size
• Piece by piece getting put on the network
• Acknowledge alarms and watch cameras
• Push schedule and access changes
• Pull logs and reports
• Physical is becoming digital...IoT (drink!)
Let's Get Physical
6
Intro
Embedded devices…
accessible via the network…
protecting valuable assets…
in every organization…
...Should be fine! 
Embedded devices…
accessible via the network…
protecting valuable assets…
in every organization…
...Should be fine! 
Access Control
Let's Get Physical
8
Access Control
Overview
• Locking mechanism
• ID mechanism
• Sensors
• Management software
• Monitoring
• Access and schedule changes
• Override lock states
Overview
• Locking mechanism
• ID mechanism
• Sensors
• Management software
• Monitoring
• Access and schedule changes
• Override lock states
Let's Get Physical
9
Access Control
Door Components
• ID reader
• Magstripe, RFID, biometric, pin pad
• Request to Exit (REX)
• Signal that unlocks door and prevents force alarm
• Door contact
• Magnet or switch that shows door state
• Lock or strike
• Releases to allow door to open
• Door controller
• Contains schedules and access rules
Door Components
• ID reader
• Magstripe, RFID, biometric, pin pad
• Request to Exit (REX)
• Signal that unlocks door and prevents force alarm
• Door contact
• Magnet or switch that shows door state
• Lock or strike
• Releases to allow door to open
• Door controller
• Contains schedules and access rules
Let's Get Physical
10
Access Control
Let's Get Physical
11
Access Control
Attack Vectors
• ID reader
• RFID spoofing, brute force, biometric forgery
• REX
• Trigger PIR sensor, pull inside handle
• Management software
• Vulnerable host, unsecured database
• Door controller
• Network-connected embedded device
• Has complete control over all door functionality
Attack Vectors
• ID reader
• RFID spoofing, brute force, biometric forgery
• REX
• Trigger PIR sensor, pull inside handle
• Management software
• Vulnerable host, unsecured database
• Door controller
• Network-connected embedded device
• Has complete control over all door functionality
Let's Get Physical
12
Access Control
Door Controller Attacks
• API exposure
• Forge or replay remote unlock commands
• Encryption? Authentication?
• Physical Security Interoperability Alliance (PSIA)
• Standard used by several manufacturers
• Send HTTP PUT req to accessOverride URI with 
accessOverrideState set to ‘Unlatched’
• Should be authenticated...individual 
implementations may vary
Door Controller Attacks
• API exposure
• Forge or replay remote unlock commands
• Encryption? Authentication?
• Physical Security Interoperability Alliance (PSIA)
• Standard used by several manufacturers
• Send HTTP PUT req to accessOverride URI with 
accessOverrideState set to ‘Unlatched’
• Should be authenticated...individual 
implementations may vary
Let's Get Physical
13
Access Control
Door Controller Attacks
• Vulnerabilities in running services
• Onboard mgmt portal
• Default creds or auth bypass
• Cmd injection
• Old, unpatched services
• Proprietary services
• Great targets for fuzzing
• Not as often or thoroughly audited
Door Controller Attacks
• Vulnerabilities in running services
• Onboard mgmt portal
• Default creds or auth bypass
• Cmd injection
• Old, unpatched services
• Proprietary services
• Great targets for fuzzing
• Not as often or thoroughly audited
Surveillance
Let's Get Physical
15
Surveillance
Overview
• Video camera
• Hard-wired or IP-based
• DVR
• Management/viewing software
Overview
• Video camera
• Hard-wired or IP-based
• DVR
• Management/viewing software
Let's Get Physical
16
Surveillance
Attack Vectors
• Management/viewing software
• Same deal as before
• DVR
• Modify or delete recordings, DoS to prevent recording
• Video camera
• Disable or DoS camera
• MitM video stream?
Attack Vectors
• Management/viewing software
• Same deal as before
• DVR
• Modify or delete recordings, DoS to prevent recording
• Video camera
• Disable or DoS camera
• MitM video stream?
Let's Get Physical
17
Surveillance
MitM Video Stream
• RTP or MJPG
• Usually UDP with no encryption
• Intercept frame, modify, then send it on
• Loop playback by capturing frames and reinjecting with 
modified timestamp/sequence number
• Replace stream with fuzzy static or a single image
• Use opencv to find and replace faces
MitM Video Stream
• RTP or MJPG
• Usually UDP with no encryption
• Intercept frame, modify, then send it on
• Loop playback by capturing frames and reinjecting with 
modified timestamp/sequence number
• Replace stream with fuzzy static or a single image
• Use opencv to find and replace faces
Alarms
Let's Get Physical
19
Alarms
Overview
• Fire
• Smoke/fire detectors
• Alarm panel
• Suppression system
• Tamper sensors
• Mainly simple switches and resistance measurement
• Motion sensors
• Lots of variety, but mostly PIR and some MW
Overview
• Fire
• Smoke/fire detectors
• Alarm panel
• Suppression system
• Tamper sensors
• Mainly simple switches and resistance measurement
• Motion sensors
• Lots of variety, but mostly PIR and some MW
Let's Get Physical
20
Alarms
Attack Vectors
• Fire
• Use vuln panel as pivot point
• Cause false positive as a distraction
• Motion sensors
• DoS the sensor to prevent reporting
• Spoof any heartbeats
Attack Vectors
• Fire
• Use vuln panel as pivot point
• Cause false positive as a distraction
• Motion sensors
• DoS the sensor to prevent reporting
• Spoof any heartbeats
The Heist
Let's Get Physical
22
The Heist
video camera
motion sensor
reader
and
door
controller
Hope
diamond
CEO’s
cc info
What Can Be Done?
Let's Get Physical
24
What Can Be Done?
Defense
• Network segmentation
• VLANs and firewalls
• Monitor networks for anomalous activity 
• Firmware updates
• Clearly define who owns what
• Manufacturers need to be more open
• Think before you link
• Do you really need an IoT (drink!) motion sensor?
Defense
• Network segmentation
• VLANs and firewalls
• Monitor networks for anomalous activity 
• Firmware updates
• Clearly define who owns what
• Manufacturers need to be more open
• Think before you link
• Do you really need an IoT (drink!) motion sensor?
Let's Get Physical
25
What Can Be Done?
Offense
• Hack yourself
• Audit devices before deploying
• 3rd party resellers are a good resource for devices and 
firmware
• Think before you link (yes, again)
• If you can think like an attacker, they’ll be less likely 
to surprise you later
Offense
• Hack yourself
• Audit devices before deploying
• 3rd party resellers are a good resource for devices and 
firmware
• Think before you link (yes, again)
• If you can think like an attacker, they’ll be less likely 
to surprise you later
Questions?
PI:EMAIL – twitter.com/HeadlessZeke