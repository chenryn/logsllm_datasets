6
4
1
S
N
D
x
a
M
p
s
R
P
D
U
r
o
i
v
a
h
e
B
y
t
i
r
e
v
e
S
e
c
r
u
o
s
d
e
t
c
e
p
x
e
n
u
m
o
r
f
e
s
n
o
p
e
r
s
n
r
u
e
R
t
)
P
C
T
r
e
v
o
S
N
D
y
x
o
r
p
t
o
n
s
e
o
d
(
/
A
N
i
)
e
z
s
f
u
B
=
T
X
T
(
d
e
t
c
e
p
x
e
n
e
h
w
1
=
C
T
h
t
i
w
s
d
n
o
p
s
e
R
R
R
E
M
R
O
F
h
t
i
w
0
S
N
D
E
s
t
c
e
e
R
j
i
)
e
z
s
f
u
B
=
 +retry=0 +qr +tcp s.txt TXT 
dig @ +retry=0 +qr +notcp s.txt TXT 
dig @ +retry=0 +qr +notcp version.bind CH TXT 
EDNS0 Compatibility 
dig @ +retry=0 +qr +bufsize=512  +edns=0 +ignore s.txt TXT 
dig @ +retry=0 +qr +bufsize=512  +edns=0 +ignore m.txt. TXT 
dig @ +retry=0 +qr +bufsize=512  +edns=0 +ignore l.txt TXT 
dig @ +retry=0 +qr +bufsize=512  +edns=0 +ignore xl.txt TXT 
dig @ +retry=0 +qr +bufsize=512  +edns=0 +ignore xxl.txt TXT 
dig @ +retry=0 +qr +bufsize=1024 +edns=0 +ignore s.txt TXT 
dig @ +retry=0 +qr +bufsize=1024 +edns=0 +ignore m.txt TXT 
dig @ +retry=0 +qr +bufsize=1024 +edns=0 +ignore l.txt TXT 
dig @ +retry=0 +qr +bufsize=1024 +edns=0 +ignore xl.txt TXT 
Appendix B. Test Commands 
Actual test queries are described below using BIND dig syntax, along with expected 
"success" results. However, implementing these tests with dig is not required â€“ it is only 
necessary to send the same DNS queries and look for the same DNS responses. 
All test queries are explicitly sent to three IP addresses: 
@UPSTREAM 
@PROXY 
@WAN 
Test Num 
T.TCP 
T.UDP 
T.VER 
A.512.S  
A.512.M 
A.512.L 
A.512.XL 
A.512.XXL 
A.1024.S 
A.1024.M 
A.1024.L 
A.1024.XL 
A.1024.XXL  dig @ +retry=0 +qr +bufsize=1024 +edns=0 +ignore xxl.txt TXT 
A.1536.S 
A.1536.M 
A.1536.L 
A.1536.XL 
A.1536.XXL  dig @ +retry=0 +qr +bufsize=1536 +edns=0 +ignore xxl.txt TXT 
A.2048.S 
A.2048.M 
A.2048.L 
A.2048.XL 
A.2048.XXL  dig @ +retry=0 +qr +bufsize=2048 +edns=0 +ignore xxl.txt TXT 
A.4096.S 
A.4096.M 
A.4096.L 
A.4096.XL 
A.4096.XXL  Dig @ +retry=0 +qr +bufsize=4096 +edns=0 +ignore xxl.txt TXT 
B.NF.X 
B.NF.U 
E.A1C0.X 
E.A0C1.X 
E.A1C1.X 
E.A1C0.U 
E.A0C1.U 
E.A1C1.U 
D.CD.X 
D.CD.U 
C.DO.X 
C.DO.U 
F.OPEN 
*   In B.NF.U, mixed-case name used to check whether resolver copies 0x20 bit 
**  In E.A1C0.X, BIND 9.5.0-P1 returns AD=1, while BIND 9.4.2 returns AD=0 
*** In A.x.x, +ignore used to avoid fail-over to TCP after expected truncations 
DNSSEC-Signed Domain Compatibility 
Dig @ +retry=0 +qr                  signed.   SOA 
Dig @ +retry=0 +qr                  UnSiGNED. SOA 
DNSSEC Request Flag Compatibility 
Dig @ +retry=0 +qr +adflag          signed.   SOA 
Dig @ +retry=0 +qr +cdflag          signed.   SOA 
Dig @ +retry=0 +qr +adflag +cdflag  signed.   SOA 
Dig @ +retry=0 +qr +adflag          unsigned. SOA 
Dig @ +retry=0 +qr +cdflag          unsigned. SOA 
Dig @ +retry=0 +qr +adflag +cdflag  unsigned. SOA 
Checking Disabled (CD) Compatibility 
Dig @ +retry=0 +qr +dnssec +cdflag  signed.   SOA 
Dig @ +retry=0 +qr +dnssec +cdflag  unsigned. SOA 
DNSSEC OK (DO) Compatibility 
Dig @ +retry=0 +qr +dnssec          signed.   SOA 
Dig @ +retry=0 +qr +dnssec          unsigned. SOA 
No Open Resolver 
Dig @ +retry=0 +qr                  .         SOA 
Success 
Rsp:TXT 
Rsp:TXT 
Rsp:Version 
Rsp:400 bytes 
Err:TC=1 *** 
Err:TC=1 
Err:TC=1 
Err:TC=1 
Rsp:400 bytes 
Rsp:800 bytes 
Err:TC=1 
Err:TC=1 
Err:TC=1 
Rsp:400 bytes 
Rsp:800 bytes 
Err:TC=1 
Err:TC=1 
Err:TC=1 
Rsp:400 bytes 
Rsp:800 bytes 
Rsp:1600 bytes 
Err:TC=1 
Err:TC=1 
Rsp:400 bytes 
Rsp:800 bytes 
Rsp:1600 bytes 
Rsp:2400 bytes 
Rsp:3200 bytes 
Rsp:AD=0,CD=0 
Rsp:AD=0,CD=0 * 
Rsp:AD=1,CD=0 ** 
Rsp:AD=0,CD=1 
Rsp:AD=0,CD=1 
Rsp:AD=0,CD=0 
Rsp:AD=0,CD=1 
Rsp:AD=0,CD=1 
Rsp:AD=0,CD=1 
Rsp:AD=0,CD=1 
Rsp:AD=1,CD=0 
Rsp:AD=0,CD=0 
Timeout or Deny 
dig @ +retry=0 +qr +bufsize=1536 +edns=0 +ignore s.txt TXT 
dig @ +retry=0 +qr +bufsize=1536 +edns=0 +ignore m.txt TXT 
dig @ +retry=0 +qr +bufsize=1536 +edns=0 +ignore l.txt TXT 
dig @ +retry=0 +qr +bufsize=1536 +edns=0 +ignore xl.txt TXT 
dig @ +retry=0 +qr +bufsize=2048 +edns=0 +ignore s.txt TXT 
dig @ +retry=0 +qr +bufsize=2048 +edns=0 +ignore m.txt TXT 
dig @ +retry=0 +qr +bufsize=2048 +edns=0 +ignore l.txt TXT 
dig @ +retry=0 +qr +bufsize=2048 +edns=0 +ignore xl.txt TXT 
dig @ +retry=0 +qr +bufsize=4096 +edns=0 +ignore s.txt TXT 
dig @ +retry=0 +qr +bufsize=4096 +edns=0 +ignore m.txt TXT 
Dig @ +retry=0 +qr +bufsize=4096 +edns=0 +ignore l.txt TXT 
Dig @ +retry=0 +qr +bufsize=4096 +edns=0 +ignore xl.txt TXT 
September, 2008 
Version 1.0 
Page 22 
Test Report: DNSSEC Impact on Broadband Routers and Firewalls 
In Test Series T, responses are simply used to document the unit's support for TCP and 
UDP. Resolver version is also retrieved from units that permit that query. 
In Test Series A, units are expected to return the specified small (S), medium (M), large 
(L), extra large (XL), and XXL response lengths for UDP/EDNS0 queries.  Where lengths 
exceed the specified buffer size, successful responses must indicate that expected error 
by setting the truncation flag.  Failure conditions include silently dropping the request, 
rejecting the request with FORMERR, returning TC=1 when response length is less than 
bufsize, returning malformed truncated responses without setting TC, or persistent 
timeouts. 
In Test Series B, C, D, and E, units are expected to return valid responses of correct 
length and content for both signed and unsigned test domains.  Flags are checked as 
specified in the Success column above; units are generally expected to pass the 
response flags returned by the resolver without modifying them.  Failure conditions 
include silently dropping the request, rejecting OPT RR requests with FORMERR, failing 
to pass the client's request flags to the resolver, and failing to return the resolver's entire 
answer (including DNSSEC flags, RRSIGs, and Authorities) to the client. 
Test F.OPEN is the only test that is considered a Success if the query times out or is 
explicitly denied (e.g., "WARNING: recursion requested but not available").  Returning 
an actual TXT response record for the requested domain is considered Failure. 
To assess source port randomization, we ran tests available at http://www.doxpara.com 
and https://www.dns-oarc.net/oarc/services/porttest and recorded the OARC score 
(standard deviation  3980 is rated "Great"). 
Note: Dig command defaults that can be assumed when not specified above: 
-4 
IPv4 transport only 
+recurse        Recursion desired 
+time=5 
+nodnssec  DO flag disabled (non-DNSSEC query) 
+nocdflag 
+noadflag 
CD flag disabled (server-side checking disabled) 
AD flag disabled (non-authenticated data returned) 
Don't wait longer than 5 seconds for response 
September, 2008 
Version 1.0 
Page 23