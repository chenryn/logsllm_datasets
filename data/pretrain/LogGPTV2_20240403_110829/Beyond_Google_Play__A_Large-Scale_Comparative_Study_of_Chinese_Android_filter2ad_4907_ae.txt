ket by AV-rank.
AV-rank (% apps)
Google Play
Tencent Myapp
Baidu Market
360 Market
OPPO Market
Xiaomi Market
MeiZu Market
Huawei Market
Market >= 1 >= 10
2.09
11.16
12.24
12.35
16.43
9.12
10.70
4.71
7.53
8.26
7.98
11.12
11.37
13.00
24.01
16.53
14.13
12.30
17.03
34.15
42.77
41.40
42.97
55.11
51.40
57.48
Lenovo MM 54.20
32.36
31.99
41.89
55.32
LIQU 45.91
55.93
52.41
48.55
36.49
>= 20
0.32
3.45
3.30
3.10
6.00
1.82
3.14
0.57
1.52
2.06
2.19
2.72
2.41
4.27
8.37
4.59
4.27
3.69
25PP
Wandoujia
HiApk
AnZhi Market
PC Online
Sougou
App China
Average
Figure 11: Distribution of over-privileged apps in Google
Play and Chinese markets. The triangle symbol represents
the value for Google Play, while the box-plots represent the
values across the 16 Chinese alternative stores.
(listed in the AndroidManifest.xml) than those actually used in their
functionalities. Previous work [97] has suggested that more than
85% of Android apps published in vendor-customized phones suffer
from this issue. Since permissions constitute an explicit declaration
of what sensitive resources an app will use [91, 93], over-privileging
an app is undesirable because: (i) it is a violation of the principle of
least privilege [2]; (ii) it exposes users to unnecessary permission
warnings; and (iii) it increases the attack surface [44] and the impact
of the presence of a bug or vulnerability [54].
Intuitively, this gap can be identified first by building a permis-
sion map that identifies what sensitive permissions are needed for
each API call/Intent/Content Provider, and using static analysis
to determine what permission-related invocations an app makes.
Then, we can compare the actually used permissions by the app
with the requested permissions listed in AndroidManifest.xml. To
do this, we leveraged data provided by PScout [26, 41], specifically a
list of 32,445 permission-related APIs, 97 permission-related Intents,
78 Content Providers URI Strings, and 996 Content Provider URI
fields16.
In general terms, apps published in Chinese markets tend to
request more sensitive permissions, i.e., those labeled as dangerous
by Google [10], than Google Play apps. Figure 11 shows the dis-
tribution of over-privileged apps across markets grouped by how
many permissions in excess each app has. Note that, in general,
Chinese markets contain more over-privileged apps than Google
Play. Approximately 65% of the apps in Google Play are over-
privileged, while the percentage in Chinese markets is roughly 82%.
In two particular cases (25PP and App China), more than 95% of
apps requested at least one unused permission. Apps often request
no more than 10 unused permissions, 3 being the most common
value. The most common over-privileged sensitive permissions are
16Note that we use the API-Permission mapping for Android 5.1.1, which may not
reflect the new sensitive APIs introduced in subsequent system versions. However,
more than 90% of apps in our dataset target API levels less than 5.1. In addition, a
well-known limitation of static over-privilege app analysis is its inability to handle
Java reflection and dynamic code loading [90].
READ_PHONE_STATE (52.38%), ACCESS_COARSE_LOCATION
(36.28%), ACCESS_FINE_LOCATION (33.83%), and CAMERA (19.98%).
6.4 Malware Prevalence
In order to investigate the presence of malicious and undesirable
apps in our dataset, we uploaded all the apps to VirusTotal [31], an
online analysis service that aggregates more than 60 anti-virus en-
gines, which is widely adopted by the research community. Previous
studies [40, 96] have suggested that some anti-virus engines may
not always report reliable results. In order to deal with such poten-
tial false positives, we analyzed the results grouped by how many
engines (AV-rank) flag a sample as malware. Previous work have
argued that a threshold of 10 engines is a robust choice [40, 61, 100].
Overall Result. Table 4 shows the overall detection results.
Remarkably, roughly 50% of the apps in Chinese markets are flagged
at least by one anti-virus engine, while the percentage for Google
Play is considerably lower (17.03%). According to the threshold of
“AV−rank ≥ 10”, around 2% of the apps in Google Play are labeled as
malware, while the percentage in Chinese markets is much higher.
In fact, for 11 out of the 16 Chinese markets the percentage of
malware exceeds 10%. A particularly remarkable case is the PC
Online market, with more than 24% of its apps labeled as potentially
malicious. In absolute terms, Tencent and 25PP markets host the
largest number of malicious apps (70,988 and 83,655, respectively).
On the opposite side, we find Huawei’s market, with a figure (4.71%)
comparable in magnitude to that of Google Play (2.09%).
Top Malware. Table 5 lists the top 10 malicious apps accord-
ing to their AV-Rank. Note that two of them (com.trustport.
mobilesecurity_eicar_test_file and com.zoner.android.eicar)
correspond to the AV benchmarking apps developed by the Eu-
ropean Institute for Computer Antivirus Research (EICAR). The
remaining apps–and others that were manually inspected by us–
clearly show potentially malicious behaviors. For example, com.
ypt.merchant, published in 5 markets, poses itself as a legitimate
mobile point-of-sale (mPOS) for merchants and individuals.
Number of Over-privileged PermissionsPercentage of Apps      0           1           2            3           4           5           6            7           8           9           >90.300.250.200.150.100.050.00IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Haoyu Wang et al.
Table 5: Top 10 malicious apps by their AV-rank.
Package Name
(malware family) AV-Rank
48
47
47
46
46
45
45
44
44
44
com.trustport.mobilesecurity
_eicar_test_file (eicar)
games.hexalab.home (mofin)
com.wb.gc.ljfk.baidu (ramnit)
com.ypt.merchant (ramnit)
com.wsljtwinmobi (ramnit)
com.wb.gc.ljfk.tx (ramnit)
com.wgljd (ramnit)
com.zoner.android.eicar (eicar)
com.zhiyun.cnhyb.activity (ramnit)
com.fai.shuiligongcheng (ramnit)
Markets
Wandoujia, 25PP
LIQU
Baidu, HiAPK
Tencent, Wandoujia,
OPPO, 25PP, LIQU
Tencent, 25PP
Tencent
Tencent, 360
Google Play,
Wandoujia, 25PP
Baidu
25PP
Repackaged Malware. The Android Genome Project [103] sug-
gested that app repackaging is the main way for malware distribu-
tion, and 86% of the 1,260 samples are repackaged malware. How-
ever, this dataset is outdated (collected in 2011) and the number
of samples is relatively small so it may no longer provide a repre-
sentative picture of the current Android malware landscape. Thus,
we further analyzed how many malware samples in our dataset
are repackaged apps. To this end, we merged the malware results
with the app clone detection results as shown in Section 6.2, and
observed that only 38.3% of these malware samples are repackaged
apps. This result suggests that app repackaging is no longer the
main way for malware spreading. We believe this is an interest-
ing observation for our community, and we leave to future work
analyzing the newest trends in malware spreading strategies.
Malware Family. We further analyzed the distribution of mal-
ware families across Google Play and Chinese markets. To do this,
we used AVClass [83] to obtain the family name (label) of each iden-
tified malware. Figure 12 shows the distribution top 20 malware
families. An interesting finding is that the distribution of malware
families differs greatly between Google Play and Chinese markets.
The most popular malware family in Chinese markets is kuguo
(12.69%), while it only corresponds to 0.6% of malware in Google
Play. Roughly, 45% of the malware present in Google Play belong
to the family airpush (29.04%) and revmob (15.09%). We further
enlarged our threshold to “AV −rank ≥ 20” and found that it shows
generally similar malware family distribution.
7 POST-ANALYSIS
All markets have strict policies to conduct copyright and security
checks (Section 2). Yet our results reveal that they still host a signif-
icant amount of fake and cloned apps, as well as malware samples.
As introduced in Section 3, we performed a second crawl for each
app store about 8 months after the first one in order to quantify
whether the stores made any effort to remove those samples from
their catalogs17. As shown in the first column of Table 6, over 84%
of the potential malicious apps found in Google Play have been
removed. However, the percentages of malware removal in Chi-
nese alternative markets vary from 0.01% (PC Online) to 34.51%
17We exclude HiAPk from this analysis as it has discontinued its services by the end
of 2017. In addition, OPPO can only be accessed now using their market app.
Figure 12: Distribution of top 15 malware families in Google
Play and Chinese markets.
Table 6: Percentage of removed malware across markets.
The third column indicates the number of apps also pub-
lished and removed in Google Play (GPRM).
Market %Malware
Removed
84%
8.75%
23.99%
43%
32.50%
29.18%
26.92%
22.75%
19.63%
34.51%
27.61%
14.08%
0.01%
24.24%
20.51%
Google Play
Tencent Myapp
Baidu Market
360
Xiaomi
Meizu
Huawei
Lenovo MM
25PP
Wandoujia
AnZhi
LIQU
PC Online
Sougou
App China
#Overlapped
with GPRM %Removed
-
3.1%
34.53%
34.22%
31.13%
26.20%
23.08%
16.35%
17.31%
44.74%
25.78%
11.18%
0.00%
22.00%
30.24%
-
7,157
1,422
1,198
636
668
169
263
7,804
5,289
632
1,878
1,117
1,082
546
(Wandoujia). We extracted and inspected in detail those apps with
an AV-rank ≥ 10 removed from Google Play (GPRM) between our
crawls. 11,623 of them were also found in at least one Chinese app
store, and over 70% of them are still hosted by at least one Chinese
market by the end of April 2018, as shown in the fourth column of
Table 6. Tencent and PC Online are clearly the Chinese stores in
which those potentially malicious apps still survive.
8 DISCUSSION
Our results reveal that potentially malicious and deceptive activ-
ities are more common in Chinese markets than in Google Play.
Figure 13 presents a multi-dimensional comparison of four repre-
sentative Chinese app markets and Google Play. Tencent Myapp,
one of the largest Chinese app stores by their aggregate number
of downloads, hosts a significant amount of mobile malware. This
store seems to be more indulgent with malicious developers, in-
cluding those publishing malware as well as fake and cloned apps.
Although Tencent Store claims to perform manual inspection for all
the submitted apps, our empirical observations seem to contradict
it. We find a similar behavior for PC Online. However, in this case
kuguoairpushsmsregrevmobdowgingappusinsecapkyoumileadboltadwodomobcommplatadendsmspayTop 15 Malware Families0.000.050.100.150.200.250.30CDF of MalwareChinese Markets Google PlayjiaguA Large-Scale Comparative Study of Chinese Android App Markets
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Measurement of Google Play. Many research efforts have
been focused on Google Play. PlayDrone [87] also performed a
large-scale characterization of 1.1 million apps published in Google
Play. They explored various issues such as app evolution and authen-
tication schemes. Bogdan et al. [49] analyzed 160,000 Google Play
apps daily for a period of 6 months, aiming to summarize the tem-
poral patterns. Ali et al. [36] quantitatively compared app market
attributes (e.g., ratings and prices) of Apple store and Google Play
based on 80,000 app pairs. Wang et al. [92] presented a large-scale
study of 791,138 removed Google Play apps to identify potential
reasons for app removal. Wang et al. [94] analyzed the mobile app
ecosystem from the perspective of app developers based on over
1.2 million apps and 320,000 developers.
Measurement of Alternative Markets. For third-party mar-
kets, Petsas et al. [77] analyzed 4 alternative markets to understand
the downloading patterns and popularity trends. Ng et al. [76] as-
sessed the trustworthy level of 20 Chinese app markets, but they
only studied roughly 500 apks. Wang et al. [95] have studied gam-
ing apps across 4 Chinese markets to understand their scale and
evolution. WuKong [89] was proposed to identify repackaged apps
in five Chinese app markets.
10 CONCLUSION
In this work, we have conducted a large-scale mobile app analysis to
understand various features of several Chinese Android app stores
and how they compare to Google Play. Specifically, our analysis
covers over 6 million Android apps obtained from 16 Chinese app
markets and Google Play. Overall, our results suggest that there
are substantial differences between the Chinese app ecosystem and
Google Play, though some minor commonalities are also found. We
have identified a significant number of developers and third-party
services specialized in the Chinese market. We have also found a
higher prevalence of fake, cloned, and malicious apps in Chinese
stores than in Google Play, possibly due to market operators indul-