presented 
tionship 
The cardinality 
name connected 
based features, 
dependent 
as 98.8%, 97.7%, and 97.1%, respectively. 
accuracy 
be detailed 
sets, the accuracy 
insensitive 
this may not be the case for other classifiers. 
change e.g., by assuming 
independent 
the class conditional 
of IP addresses 
to the distribution 
i. e., in general 
all feature 
belong to that subset is 
that there is a linear rela­
given the class of origin and learning a model for 
to the timing and domain feature 
in approximately 
between spatial, 
that the features 
When we jointly 
distribution 
probability 
of both spatial 
in the sequel. 
classifying 
by correctly 
is observed 
and results 
becomes 98.9%, and the predictions 
become 
of each feature 
for a given domain 
resolved 
The increase 
CDNs that will 
use all feature 
sets. However, 
Accuracy 
may 
and network 
or 
DNS answer and network features. 
pairs are statistically 
same accuracy 
in 
results 
are conditionally 
978-1-4799-3755-4/13/$31.00 ©2013 
IEEE 
000871 
100 
80 
20 
D  Accuracy 
TP Rate 
FP Rate 
0.8 
c .; "' 
g 0.6 
l .e .5 0.4 
t 
0.2 
,----, 
,----, 
,----, 
3 
Feature Sets 
r=:::J 
q;5 
(h 
3 
Feature 
Sets 
5 
Fig. 1: Percentage 
of accuracy, 
true positive, 
and false positive 
rates 
Fig. 2: Average information 
gain value for each 
feature 
type 
0.8 
0.6 
l: ·iii c 
.!: 
0.4 
0.2 
0.2 
_  benign 
_  fast-flux 
0.8 
_  benign 
_  fast-flux 
0.6 
l: ·iii 
5i Q 
0.4 
0.2 
0.4 
0.6 
0.8 
Spatial 
Distribution 
of A records 
1.2 
""
o r  ,.. .• 
w 
Distribution 
w 
of Minimal 
m 
Service Distance 
(std) 
60 
"",,,,, lbi 
Fig. 3: Distribution 
of the two highest 
information 
gain ranked spatial 
features 
using ensemble 
of classifiers 
with a voting procedure. 
well maintained 
for each query without 
any missing 
values. 
• 
• 
• 
of the spatial-based 
feature 
histograms 
a.O! 
•  benign 
+  fastflux 
•  Botnets 
In order to investigate 
the performance 
have a 
networks. 
Nearly all 
we extracted 
with four or fewer A and NS 
of discriminating 
fast-flux 
gain ranked features 
deviation 
and standard 
were associated 
while most of the fast-flux 
the class-conditional 
in­
of A 
datasets 
(i.e., 
of minimum service 
for the two highest 
0.0< 
distribution 
spatial 
f 
! e 0.0, 
distance) 
that distributions 
E 
.2' "" 'a 0.0; 
range and form, and such differences do provide 
J 
O.OJ 
features, 
from benign and fast-flux 
formation 
records 
as shown in Figure 3. We observe 
different 
a foundation 
benign instances 
records, 
with more A and NS records 
packet. 
networks 
by CDNs have closer service 
the use of service 
distance 
false positive 
with the use of only number of IP addresses 
NS records. 
general 
noted that in our implementations, 
in A and 
obtained 
are in 
by [8] and [14]. It should be 
IP-coordinate 
is 
locations, 
distance. 
leverages 
the IP addresses 
As a result, 
the CDN detection 
in one single DNS response 
over multiple 
Even ifFFSNs and CDNs are distributed 
from 3.2% to 1.1 % compared 
and geographical 
experimental 
results 
to those obtained 
rates decreases 
as expected, 
Our spatial 
database 
instances 
were associated 
similar 
returned 
and 
• 
.­
• 
. . 
20 
40 
Domain name index 
60 
80 
100 
Fig. 4: Scatter 
plot of Jaccard 
distance 
for bigrams using 90 domain names 
The resulting 
accuracy, 
TP and FP rates of domain-name 
are 88.48%, 95.1 %, and 30.1 % respectively. 
In 
based features 
general, 
outperforms 
distance. 
our experiments 
reveal that overall 
the KL Divergence 
others, 
followed 
by Jaccard 
The scatter 
plot presented 
index and then Edit 
in Figure 4 shows the 
978-1-4799-3755-4/13/$31.00 
©2013 IEEE 
000872 
Note that fast-flux 
are all easy-to-remember, 
Index over bigram distributions 
of 90 test domains 
domain names, as well as domain 
botnets. 
and consist 
Jaccard 
between benign and fast-flux 
names extracted 
from traditional 
domains used in our experiments 
human readable 
sportinghookup.com 
extra layer for textual 
domain names do not closely 
unigrams 
we  believe 
adapted to evaluate 
for estimating  association 
results compared 
to metrics 
the likelihood 
detection. 
and bigrams compared to benign domain names, 
that more sophisticated 
models can be 
probability 
of a given domain  name 
with FFSNs, and may give better 
used in our experiments. 
and jindpartnertoday.com, 
of at least 11 characters 
such as 
which adds an 
that FFSN 
for 
Even we observe 
match the true distribution 
It is observed 
along with network and DNS answer features 
lead to 
name and DNS packet characteristics. 
spatial 
the best classification 
are the promising 
ones for the datasets 
future work, we plan to investigate 
the features 
advanced 
we recorded. 
dependencies 
classifiers, 
and more 
using more sophisticated 
probability 
results, 
models for the domain name features. 
and the domain name features 
between 
that 
As a 
ACKNOWLEDGMENT 
The authors 
would like to thank Dr. 
George Kesidis 
for his 
guidance, 
constructive 
comments. 
and Dr. David J. Miller and Fatih Kocak for their 
REFERENCES 
[I] "The Honeynet Project. 
Know your enemy: Fast-Flux 
Service 
Net­
works," 
http://www.honeynet.orglpapers/fJ, 
2007. 
[2] R. Perdisci, 
fl ux networks 
Dependable 
via large-scale 
passive 
and Secure Computing, 
"Early detection 
dns traffic analysis," 
2012. 
of malicious 
in Proc. IEEE 
l. Corona, and G. Giacinto, 
[3] L. Bilge, E. Kirda, C. Kruegel, 
and M. Balduzzi, 
domains using passive 
DNS analysis," 
"EXPOSURE: Finding 
in Proc. Network and 
[4] T. Holz, C. Gorecki, 
service 
System Security Symposium (NDSS), 2011. 
K. Rieck, and F. Freiling, 
networks," 
in Proc. Symposium on Network and 
"Measuring 
and detect­
malicious 
Distributed 
ing fast-flux 
Distributed 
[5] E. Passerini, 
System Security, 2008. 
R. Paleari, 
L. Martignoni, 
ing and monitoring 
Intrusions 
fast-flux 
service 
and Malware, and Vulnerability 
[6] C. Su, C. Huang, and K. Chen, "Fast-flux 
Assessment, 
2008. 
bot detection 
in real time," 
and D. Bruschi,  "Fluxor: 
networks," 
in Proc. Detection 
detect­
of 
in Proc. Recent Advances in Intrusion 
Detection, 
20 II. 
[7] S. Yadav, A. Reddy, A. Reddy, 
and S. Ranjan,  "Detecting 
algorithmically 
generated 
Internet 
20 I O. 
measurement, 
malicious 
domain names," 
in Proc. iOth annual conference 
on 
[8] S. Huang, C. Mao, and H. Lee,  "Fast-flux service 
for delay-free 
network detection 
detection," 
in Proc. 
Computer and Communications 
snapshot 
based on spatial 
5th ACM Symposium on  Information, 
Security, 2010. 
[9] R. Bellis, 
mechanism 
Current Practice)," 
www.ieiforg. 
2009. 
"RFC 5625, DNS Proxy Implementation 
Guidelines 
(Best 
[10] M. Knysz, X. Hu, and K. Shin, "Good guys vs. bot guise: Mimicry 
fast-flux 
detection 
systems," 
in Proc. INFOCOM, 2011. 
attacks 
against 
[II] D. Miller, 
F. Kocak, and G. Kesidis, 
a batch with growing number of tests: 
detection," 
for Signal Processing 
[12] B. Stone-Gross, 
(MLSP),  2012. 
M. Cova, L. Cavallaro, 
in Proc. IEEE International  Workshop 
"Sequential 
Application 
anomaly detection 
to network intrusion 
on Machine Learning 
in 
B. Gilbert, 
M. Szydlowski, 
C. Kruegel, 
R. Kemmerer, 
A nalysis of a botnet takeover," 
Security, 2009. 
and G. Vigna, "Your botnet is my botnet: 
in Proc. iEEE Workshop on Network 
distance 
[13] B. Bigi, "Using kullback-Ieibler 
Retrieval, 
2003. 
vances in information 
for text categorization," 
Ad­
[14] H. Wang, C. Mao, K. WU, and H. Lee, "Real-time 
fast-flux 
identification 
via localized 
spatial 
and Applications 
Conference 
(COMPSAC), 2012. 
geolocation 
detection," 
in Proc. Computer Sofiware 
[IS] G. Combs, "Tshark, dump and analyze network traffic," 
http://www.wireshark. 
org. 
[16] R. Kohavi and R. Quinlan, 
"Decision 
tree discovery," 
in Handbook of 
Data Mining and Knowledge DiscovelY, 
1999. 
le+04 
1,000 
100 
10 
en ...   
c 
8 .. III 
0.1 
0.01 
0.001 
0.0001 
DFD fast-flu, DFD benign PD fast-flu, PD benign 
Timing features 
Fig. 5: Comparison 
of standard 
deviation 
of document fetch delay (DFD) 
and processing 
delay (PD) 
We observe that there is no significant 
difference 
Figure 5 shows the logarithmic 
scale box plot 
of document fetch delay (DFD) and 
deviation 
delay (PD) distribution 
Finally, 
of standard 
processing 
classes. 
between mean values of the classes. 
limitations 
time, and the size of the congestion 
features, 
based on the way the timing-based 
of slow servers, 
it is observed 
powerful bots, application 
window may affect the 
process 
that the C4.5 algorithm 
is invariant 
features 
are handled. 
for benign and fast-flux 
Since network conditions, 
V. CONCLUSION 
In this paper, we developed 
and evaluated 
and lightweight 
features 
for 
in 
five 
space of size 19, and 
cost. We extracted 
to evaluate 
out of feature 
sets of features 
and computational 
by using the C4.5 algorithm 
of FFSNs that are delay-free, 
detection 
terms of storage 
different 
studied 
power of each set. A primary motivation 
that these features 
however, 
the FFSN detection. 
demonstrated 
the information 
of accuracy, 
importantly, 
false and true positive 
we addressed 
they are not jointly 
the reliability 
gain for each class, 
In order to address 
are often used by research 
investigated 
of each feature 
exploiting 
for our study was 
community; 
or compared for 
these problems, 
we 
by measuring 
and evaluated 
rates. 
the joint use of domain 
in terms 
and most 
Finally 
discrimination 
978-1-4799-3755-4/13/$31.00 
©2013 IEEE 
000873