安全日志采集分析平台
UseCase详细设计方案
文档日期:  2015/10/27
概述
为了常熟农商行实现针对合规、高可靠的数据中心基础设施日志集中收集、存储、分析、处理的需求，通过前期详细调研、测试及分析整理、并结合实施经验和其他客户的成功案例，进行详细Use Case设计，以满足当前常熟农商行的相关安全监控分析需求。
该平台基于重点业务需求，制定安全监控规则，实现对安全事件的监控、发现、调查，积累各类审计数据，提高员工网络行为合规率。
以下是我们做过的Use Case，请常熟农商行针对自身情况和需求，进行选择。
安全审计
主机高危命令监控安全审计
主机高危命令监控
| Use Case需求描述 | Use Case需求描述 | 生产系统主机高危命令的使用造成的后果严重，同时对此类行为难以及时发现，通过SPLUNK系统能及时告警发现主机系统的高危命令告警监控：su、rm的使用监控 | 生产系统主机高危命令的使用造成的后果严重，同时对此类行为难以及时发现，通过SPLUNK系统能及时告警发现主机系统的高危命令告警监控：su、rm的使用监控 | 生产系统主机高危命令的使用造成的后果严重，同时对此类行为难以及时发现，通过SPLUNK系统能及时告警发现主机系统的高危命令告警监控：su、rm的使用监控 | 生产系统主机高危命令的使用造成的后果严重，同时对此类行为难以及时发现，通过SPLUNK系统能及时告警发现主机系统的高危命令告警监控：su、rm的使用监控 |
|---|---|---|---|---|---||---|---|---|---|---|---|
| 需求内容定义与 安全监控目标 |需求内容定义与 安全监控目标 |当主机发生高危命令（例如：su、rm等操作时进行告警） |当主机发生高危命令（例如：su、rm等操作时进行告警） |当主机发生高危命令（例如：su、rm等操作时进行告警） |当主机发生高危命令（例如：su、rm等操作时进行告警） |
| 覆盖范围 |覆盖范围 |重要的Linux类主机 |重要的Linux类主机 |重要的Linux类主机 |重要的Linux类主机 |
| 所需事件和数据输入 |所需事件和数据输入 |堡垒机命令告警日志 |堡垒机命令告警日志 |堡垒机命令告警日志 |堡垒机命令告警日志 |
| 处理方法 |监控方式 |关联规则 |关联规则 |关联规则 |关联规则 |
| 处理方法 |告警方式 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 || 处理方法 |响应人员 |一级响应 （Security Team） |主机管理员 |邮件地址 | |
| 处理方法 |响应人员 |一级响应 （Security Team） | |邮件地址 | |
| 处理方法 |响应人员 |一级响应 （Security Team） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | || 展现内容设计 |展现内容设计 |展现设计-1：主机高危命令监控     1.展现形式：Report（Weekly）     2.展现内容： 1）用户名,操作IP，违规命令，操作次数； |展现设计-1：主机高危命令监控     1.展现形式：Report（Weekly）     2.展现内容： 1）用户名,操作IP，违规命令，操作次数； |展现设计-1：主机高危命令监控     1.展现形式：Report（Weekly）     2.展现内容： 1）用户名,操作IP，违规命令，操作次数； |展现设计-1：主机高危命令监控     1.展现形式：Report（Weekly）     2.展现内容： 1）用户名,操作IP，违规命令，操作次数； |
核心防火墙DENY统计排名核心防火墙DENY统计排名
| Use Case需求描述 | Use Case需求描述 | 通过SPLUNK系统实现核心防火墙安全审计(deny的源地址，deny多的就会有问题，做个TOP 10排名。 | 通过SPLUNK系统实现核心防火墙安全审计(deny的源地址，deny多的就会有问题，做个TOP 10排名。 | 通过SPLUNK系统实现核心防火墙安全审计(deny的源地址，deny多的就会有问题，做个TOP 10排名。 | 通过SPLUNK系统实现核心防火墙安全审计(deny的源地址，deny多的就会有问题，做个TOP 10排名。 |
|---|---|---|---|---|---|
| 需求内容定义与 安全监控目标 |需求内容定义与 安全监控目标 |监控核心防火墙Deny信息，并进行统计 |监控核心防火墙Deny信息，并进行统计 |监控核心防火墙Deny信息，并进行统计 |监控核心防火墙Deny信息，并进行统计 || 覆盖范围 |覆盖范围 |核心防火墙 |核心防火墙 |核心防火墙 |核心防火墙 |
| 所需事件和数据输入 |所需事件和数据输入 |防火墙Deny日志 |防火墙Deny日志 |防火墙Deny日志 |防火墙Deny日志 |
| 处理方法 |监控方式 |关联规则 |关联规则 |关联规则 |关联规则 |
| 处理方法 |告警方式 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 |
| 处理方法 |响应人员 |一级响应 （Security Team） |安全管理员 |邮件地址 | |
| 处理方法 |响应人员 |一级响应 （Security Team） | |邮件地址 | |
| 处理方法 |响应人员 |一级响应 （Security Team） | |邮件地址 | || 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | || 展现内容设计 |展现内容设计 |展现设计-1：核心防火墙DENY访问监控     1.展现形式：Report（Weekly）     2.展现内容： 按Deny的源地址统计：Deny源IP，传输协议，操作次数； 按Deny的目的地址统计：Deny目的IP，传输协议，操作次数； |展现设计-1：核心防火墙DENY访问监控     1.展现形式：Report（Weekly）     2.展现内容： 按Deny的源地址统计：Deny源IP，传输协议，操作次数； 按Deny的目的地址统计：Deny目的IP，传输协议，操作次数； |展现设计-1：核心防火墙DENY访问监控     1.展现形式：Report（Weekly）     2.展现内容： 按Deny的源地址统计：Deny源IP，传输协议，操作次数； 按Deny的目的地址统计：Deny目的IP，传输协议，操作次数； |展现设计-1：核心防火墙DENY访问监控     1.展现形式：Report（Weekly）     2.展现内容： 按Deny的源地址统计：Deny源IP，传输协议，操作次数； 按Deny的目的地址统计：Deny目的IP，传输协议，操作次数； |按正常地址通讯发现Deny告警
| Use Case需求描述 | Use Case需求描述 | 发现核心防火墙正常通讯期间发生。 | 发现核心防火墙正常通讯期间发生。 | 发现核心防火墙正常通讯期间发生。 | 发现核心防火墙正常通讯期间发生。 |
|---|---|---|---|---|---|
| 需求内容定义与 安全监控目标 |需求内容定义与 安全监控目标 |监控核心防火墙正常的通讯，突然变为Deny的情况 |监控核心防火墙正常的通讯，突然变为Deny的情况 |监控核心防火墙正常的通讯，突然变为Deny的情况 |监控核心防火墙正常的通讯，突然变为Deny的情况 |
| 覆盖范围 |覆盖范围 |核心防火墙 |核心防火墙 |核心防火墙 |核心防火墙 |
| 所需事件和数据输入 |所需事件和数据输入 |防火墙Deny日志 |防火墙Deny日志 |防火墙Deny日志 |防火墙Deny日志 || 处理方法 |监控方式 |关联规则 |关联规则 |关联规则 |关联规则 |
| 处理方法 |告警方式 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 |邮件通知和SNMP Trap输出 |
| 处理方法 |响应人员 |一级响应 （Security Team） |安全管理员 |邮件地址 | |
| 处理方法 |响应人员 |一级响应 （Security Team） | |邮件地址 | |
| 处理方法 |响应人员 |一级响应 （Security Team） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | || 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |
| 处理方法 |响应人员 |二级响应 （Server/UDS/VNP） | |邮件地址 | |