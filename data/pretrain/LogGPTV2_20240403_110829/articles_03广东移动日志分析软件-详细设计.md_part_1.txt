**广东移动日志管理平台**
**详细设计**
**甲方：中国移动通信集团广东有限公司**
**乙方：亚信科技（中国）有限公司**
**2018年8月**

### 1. 大数据支持

该平台支持大数据相关接口的定制开发，旨在打造一个功能强大、灵活且易于使用的日志分析软件。其主要功能包括集中管理日志、实时搜索、关联分析、监控告警、多维统计及数据可视化等，适用于运维监控、安全合规审计和业务数据挖掘等领域。

#### 1.1 日志分析软件RESTful API
- **SplSearch**：通过使用日志分析软件的Search Process Language (SPL) 进行日志搜索。除了基本的搜索功能外，还支持下载、LogTail、DrillDown以及上下文查询等功能。SPL是核心功能之一，具有丰富的语法，可用于文本搜索、业务串联、各类统计和机器学习等。
- **Agent**：配置数据接入代理。API提供了对文件和syslog两种来源的基本增删查改操作。
- **ParserRule**：配置日志解析规则。数十种提取规则可通过API进行配置。
- **Alert**：配置告警功能，包括发送方式（即告警插件）、扩展搜索及告警抑制等。
- **SourceGroup**：管理日志来源。
- **Account**：用户管理，支持简单的增删查改操作。
- **AccountGroup**：用户分组管理，包括设置成员与角色关系。
- **ResourceGroup**：资源权限管理，通过资源分组实现。

### 2. 接口鉴权
- 使用HTTP BasicAuth进行鉴权，鉴权信息需在HTTP头中以`Authorization: Basic <Base64编码的用户名:密码>`形式提供。
- 默认服务IP为集群Frontend模块的IP地址，默认端口为8080。
- 支持版本号：v1。
- Token获取：可在Web页面/tokens/菜单下获得。

### 3. 流式数据接入
- 数据采集层支持多种数据源接入，包括：
  - 增量读取文件日志
  - Syslog/rsyslog接口
  - 数据库信息（如MySQL, Oracle, SQL Server）
  - Flume/ws/api接口
  - Agent获取EventLog
  - 对接流量抓包系统

### 4. 分布式消息队列系统
为了提高数据处理的健壮性，需要开发一套分布式消息队列系统，用于消息持久化和缓存。系统特性包括高吞吐率、分区副本支持、无数据丢失保证等。

### 5. 正则表达式处理
正则是处理非结构化数据的有效工具。例如，对于一条特定格式的日志，可以使用正则表达式提取出时间戳、进程ID、日志级别和消息内容等字段。

### 6. 海量数据流处理
- **Transaction设计**：通过将一组相关的日志组合成一个事务，实现对分散业务日志的聚合。
- **业务数据聚合设计**：允许根据具体的业务需求灵活配置聚合方式，从开始到结束的一系列步骤来构建完整的业务流程。

以上是对广东移动日志管理平台详细设计的概述，涵盖了从大数据支持到流式数据接入、分布式消息队列、正则表达式处理及海量数据流处理等多个方面，旨在为企业提供高效、可靠的日志管理和数据分析解决方案。