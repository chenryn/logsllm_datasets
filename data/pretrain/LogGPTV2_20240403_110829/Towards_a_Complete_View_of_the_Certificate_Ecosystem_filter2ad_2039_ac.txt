15% GoDaddy
9% GeoTrust
7% GlobalSign
5% Let’s Encrypt
23% Other (567)
17% Let’s Encrypt
16% Comodo
15% GeoTrust
7% GoDaddy
7% cPanel
62% Other (377)
28%
24%
12%
12%
7%
18%
Table 8: Top Certiﬁcate Issuers—The most common issuers differ depending on the perspective studied. Let’s Encrypt has its
highest popularity in CT Logs, cPanel only appears in the top ﬁve for zone ﬁle scanning, and IPv4 scanning yields a longer tail.
There were 68,700 certiﬁcates seen by our passive mea-
surement that were not present in Censys. They have a sim-
ilar composition to the certiﬁcates in CT logs that Censys
missed. 39% are issued by Let’s Encrypt, which requires
sites to frequently re-issue certiﬁcates. 20% are attributable
to Wordpress-hosted blogs and 13% to CloudFlare, services
that heavily depend on SNI and would therefore not be seen
by IPv4 scans.
3.5 Combining CT and Censys
IPv4 Scan
Common Crawl
Zones
Alexa
CT Scan
IPv4 Addresses
1.88%
4.54%
3.91%
2.71%
3.73%
FQDNs
Sites
4.14% 5.18%
1.42% 1.51%
0.90% 0.96%
0.90% 0.96%
1.12% 1.18%
Table 9: Rate of Vulnerability to FREAK—Vulnerability
rates measured by each methodology vary signiﬁcantly.
As Table 6 shows, combining data from CT logs and Cen-
sys yields 99.4% coverage of all certiﬁcates observed by any
of our perspectives and 99.7% of all FQDNs and all sites.
However, since these perspectives are also our two largest
data sources, this statistic may be artiﬁcially inﬂated.
Fortunately, scanning all domains in the .com, .net, and
.org zone ﬁle provides us with ground truth for all sites
being served on the root and www subdomain in those zones.
We can use this to understand what coverage each perspective
gives in these zones. While the zones do not contain all
subdomains or even all domain names on the Internet, they
are a large subset: 153 million unique domains. We compare
Censys data and CT logs over the certiﬁcates obtained from
the zone scans in Table 7.
Of these certiﬁcates, we ﬁnd 98.5% are obtained through
either Censys or CT logs. Since this is smaller than the corre-
sponding percentage for all certiﬁcates we observe, there are
likely certiﬁcates being hosted in other zones and in other sub-
domains not observed by any method we use. Therefore, the
coverage of IPv4 scans and CT logs on the entire population
of certiﬁcates on the Internet is overestimated by Table 6.
Conversely, the coverage of Censys scanning on the zone
dataset is increased to 54%, from 38% over all certiﬁcates
observed. This is potentially due to certiﬁcates in CT logs
that are not actively hosted on the Internet (e.g., intranet sites).
As a result, the Censys coverage of the entire population of
certiﬁcates on the Internet is underestimated by Table 6.
4.
IMPACT ON HTTPS RESEARCH
A number of recent studies have used IPv4 and Alexa Top
Million scanning to measure how HTTPS is deployed in the
wild [4, 7, 8, 10, 11, 14, 22, 28, 31, 32]. Our ﬁnding that IPv4
scans miss nearly two-thirds of certiﬁcates suggests that, if
these studies were performed today, they might not accurately
reﬂect the state of the Internet.
To provide a concrete example of the differences caused by
different perspectives, we present a survey of sites vulnerable
to the FREAK attack [28] in Table 9. The data comes from
scanning each of: the IPv4 address space, CT log FQDNs,
Alexa Top Million domains, our zone ﬁles, and domains
extracted from Common Crawl. For each set, we measure
how many responsive hosts are vulnerable.
The number of vulnerable hosts changes with each perspec-
tive we measure. The vulnerability rates range from 1.88% of
IPs vulnerable when measured by IPv4 scanning, to 4.54% of
IPs vulnerable when measured by our Common Crawl scan.
This variation demonstrates the necessity of considering the
perspective used when performing measurements.
We also observe differences when comparing the most
common certiﬁcate issuers seen in each perspective, as shown
in Table 8. We measure this by grouping certiﬁcates by their
issuer organization ﬁeld and manually deduplicating similar
issuer names. Different perspectives display differing views
on which CA is most popular. For example, Let’s Encrypt is
the most popular CA in CT, Common Crawl, and zone scans,
but it is ranked ﬁfth in IPv4 scans.
5. RELATED WORK
This work was inspired by a large body of research focus-
ing on the HTTPS ecosystem and supporting PKI [4, 7, 8,
10, 11, 14, 28, 31, 32]. These works have run the gamut of
HTTPS measurement, ranging from the certiﬁcate authority
ecosystem [11, 14] to cryptographic keys generated without
entropy [16], and how operators react to vulnerabilities [10].
In 2010, the EFF launched the SSL Observatory [14], in
which they performed a scan of the IPv4 address space over
a three month period in order to identify trusted certiﬁcate
authorities. Later, in 2011, Vratonjic et al. [31] crawled
the Alexa Top Million ﬁnding that only 5.7% of websites
correctly deploy HTTPS. The same year, Holz et al. [18]
547carried out a similar study, combining active measurements
of the Top Million from from several vantage points, with
data from passive measurement at a large research institution.
They brieﬂy compared the differences of their vantage points,
concentrating on differences caused by scan origins.
In 2013, Durumeric et al. [11] analyzed the state of the
HTTPS PKI by repeatedly scanning the IPv4 address space.
They brieﬂy considered how much of the Alexa Top Mil-
lion was only accessible using SNI, ﬁnding that, at that time,
SNI was not widely required. Other studies use data based
on websites on the Top Million [19], and scans of the IPv4
ecosystem [10, 15, 16]. Studies have also been based on com-
binations of Alexa sites, random domains, known phishing do-
mains data from passive network monitoring [1, 2, 10, 24, 29]
Most recently, studies have also investigated TLS deployment
outside of HTTPS [9, 17].
Our work does not focus on the questions asked by these
individual studies, but instead focuses on how these types
of studies should be measuring the HTTPS ecosystem. We
hope that by better validating different methodologies for
studying the HTTPS PKI, we can help future papers obtain
more accurate measurements.
6. CONCLUSION
Over the past ﬁve years, dozens of studies have measured
the HTTPS ecosystem and supporting PKI. Unfortunately,
without a clear ground truth, these studies pieced together
a view built on a series of fractured and imperfect method-
ologies. In this work, we investigated these methodologies,
ﬁnding that IPv4 enumeration no longer provides a represen-
tative view of how TLS servers are conﬁgured, due to SNI
deployment. IPv4 scans miss more than two-thirds of valid
certiﬁcates and associated measurements can differ dramati-
cally from site-based approaches. Certiﬁcate Transparency
provides a new perspective, which ﬁnds 90.5% of certiﬁcates
observed in this study, but is skewed towards a few author-
ities that submit the certiﬁcates they issue. We ﬁnd that a
more comprehensive yet readily accessible methodology is
to use a combination of CT and Censys data, which together
account for 99.4% of our observed certiﬁcates. To this end,
we are working with the Censys team to implement continu-
ous certiﬁcate synchronization between Censys and Google’s
CT logs, which will soon make either data source a nearly
comprehensive view of trusted HTTPS certiﬁcates.
Acknowledgements
The authors thank David Adrian, Ryan Hurst, and Ben Laurie
for insightful discussions and feedback. We thank the ex-
ceptional sysadmins at the University of Michigan for their
ongoing help and assistance, and Charlie Mattison for repeat-
edly going above and beyond in support of our research. We
also thank the anonymous reviewers and our shepherd, Dave
Levin. This material is based upon work supported by the Na-
tional Science Foundation under grants CNS-1345254, CNS-
1409505, CNS-1505790, CNS-1518741, CNS-1518888, CNS-
1530915, CNS-1528156, and ACI-1348077, by the Google
Ph.D. Fellowship in Computer Security, and by an Alfred P.
Sloan Foundation Research Fellowship.
7. REFERENCES
[1] D. Akhawe, J. Amann, M. Vallentin, and R. Sommer.
Here’s my cert, so trust me, maybe? Understanding
TLS errors on the web. In 22nd International World
Wide Web Conference, May 2013.
[2] J. Amann, R. Sommer, M. Vallentin, and S. Hall. No
attack necessary: The surprising dynamics of SSL trust
relationships. In 29th Annual Computer Security
Applications Conference, Dec. 2013.
[3] J. Amann, M. Vallentin, S. Hall, and R. Sommer.
Extracting certiﬁcates from live trafﬁc: A near
real-time SSL notary service. Technical Report
TR-12-014, ICSI, Nov. 2012.
[4] B. Beurdouche, K. Bhargavan, A. Delignat-Lavaud,
C. Fournet, M. Kohlweiss, A. Pironti, P.-Y. Strub, and
J. K. Zinzindohoue. A messy state of the union:
Taming the composite state machines of TLS. In 36th
IEEE Symposium on Security and Privacy, May 2015.
[5] Certiﬁcate Transparency: Extended validation in
Chrome.
https://www.certiﬁcate-transparency.org/ev-ct-plan.
[6] Common Crawl. https://commoncrawl.org/.
[7] The DROWN attack. https://drownattack.com/.
[8] Z. Durumeric, D. Adrian, A. Mirian, M. Bailey, and
J. A. Halderman. Censys: A search engine backed by
Internet-wide scanning. In 22nd ACM Conference on
Computer and Communications Security, Oct. 2015.
[9] Z. Durumeric, D. Adrian, A. Mirian, J. Kasten,
E. Bursztein, N. Lidzborski, K. Thomas, V. Eranti,
M. Bailey, and J. A. Halderman. Neither snow nor rain
nor MITM... an empirical analysis of email delivery
security. In 15th ACM Internet Measurement
Conference, Oct. 2015.
[10] Z. Durumeric, J. Kasten, D. Adrian, J. A. Halderman,
M. Bailey, F. Li, N. Weaver, J. Amann, J. Beekman,
M. Payer, and V. Paxson. The matter of Heartbleed. In
14th ACM Internet Measurement Conference, Nov.
2014.
[11] Z. Durumeric, J. Kasten, M. Bailey, and J. A.
Halderman. Analysis of the HTTPS certiﬁcate
ecosystem. In 13th ACM Internet Measurement
Conference, Oct. 2013.
[12] Z. Durumeric, E. Wustrow, and J. A. Halderman.
ZMap: Fast Internet-wide scanning and its security
applications. In 22nd USENIX Security Symposium,
Aug. 2013.
[13] D. Eastlake. Transport Layer Security (TLS)
Extensions: Extension Deﬁnitions. RFC 6066, 2011.
[14] Electronic Frontier Foundation. The EFF SSL
observatory. https://www.eff.org/observatory.
[15] X. Gu and X. Gu. On the detection of fake certiﬁcates
via attribute correlation. In Entropy, Nov. 2014.
[16] N. Heninger, Z. Durumeric, E. Wustrow, and J. A.
Halderman. Mining your Ps and Qs: Detection of
548widespread weak keys in network devices. In 21st
USENIX Security Symposium, Aug. 2012.
[17] R. Holz, J. Amann, O. Mehani, M. Wachs, and M. A.
Kaafar. TLS in the wild: An Internet-wide analysis of
TLS-based protocols for electronic communication. In
S. Capkun, editor, Network and Distributed System
Security Symposium, Feb. 2016.
[18] R. Holz, L. Braun, N. Kammenhuber, and G. Carle.
The SSL landscape: A thorough analysis of the x.509
PKI using active and passive measurements. In 11th
ACM Internet Measurement Conference, Nov. 2011.
[19] L.-S. Huang, S. Adhikarla, D. Boneh, and C. Jackson.
An experimental study of TLS forward secrecy
deployments. IEEE Internet Computing, 18(6), 2014.
[20] J. C. Jones. 124 days of Let’s Encrypt, Apr. 2016.
https://tacticalsecret.com/124-days-of-lets-encrypt/.
[21] B. Laurie, A. Langley, and E. Kasper. Certiﬁcate
Transparency, 2013.
http://www.certiﬁcate-transparency.org/.
[22] A. K. Lenstra, J. P. Hughes, M. Augier, J. W. Bos,
T. Kleinjung, and C. Wachter. Public keys. In 32nd
International Cryptology Conference, Aug. 2012.
[23] Let’s Encrypt: Certiﬁcates.
https://letsencrypt.org/certiﬁcates/.
[24] M. A. Mishari, E. D. Cristofaro, K. M. E. Defrawy, and
G. Tsudik. Harvesting SSL certiﬁcate data to mitigate
web-fraud. CoRR, abs/0909.3688, 2009.
[25] Mozilla Foundation. Public sufﬁx list.
https://publicsufﬁx.org/.
[26] R. Sleevi. Sustaining digital certiﬁcate security, Oct.
2015. https://security.googleblog.com/2015/10/
sustaining-digital-certiﬁcate-security.html.
[27] StartCom log all issued SSL certiﬁcates to public CT
log servers, Mar. 2016. https://www.startssl.com/
NewsDetails?date=20160323.
[28] Tracking the FREAK attack. http://freakattack.com/.
[29] N. Vallina-Rodriguez, J. Amann, C. Kreibich,
N. Weaver, and V. Paxson. A tangled mass: The
Android root certiﬁcate stores. In 10th ACM
Conference on Emerging Networking Experiments and
Technologies, 2014.
[30] VeriSign: Zone ﬁle information.
https://www.verisign.com/en_US/channel-resources/
domain-registry-products/zone-ﬁle/index.xhtml.
[31] N. Vratonjic, J. Freudiger, V. Bindschaedler, and J.-P.
Hubaux. The inconvenient truth about web certiﬁcates.
In 10th Workshop on Economics in Information
Security, 2011.
[32] L. Zhang, D. Choffnes, D. Levin, T. Dumitras,
A. Mislove, A. Schulman, and C. Wilson. Analysis of
SSL certiﬁcate reissues and revocations in the wake of
Heartbleed. In 14th ACM Internet Measurement
Conference, Nov. 2014.
549