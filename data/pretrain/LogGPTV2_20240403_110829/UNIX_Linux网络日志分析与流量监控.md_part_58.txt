00:40:96:44:17:DFFF:FF:FF:FF:FF:FFFF:FF:FF:FF:FF:FF1147
96:44
:96
1:17
:17
DH
品
品
品
福
6
00:0d:29:57:96:bf 00:0d:29:57:96:bf 11 535 802.11 WEP Data
00
00
0
00
00
一些人偶尔也能连接成功。这种时断时续的现象，
40:
40
10T
100
50:57:E4:7B
802
:44:17:DR
44:17:DF
:FF:FF:FF
：57:E4:7B
7:E4:7B
B
800:0d:29:57:96:bf113
800:0d:29:57:96:bf 11 30 802.11 Disass0c
B 00:0d:29:57:96:bf 11 30 802.11 Disassoc
300:0d:29:57:96:bf113
800:0d:29:57:96:bf113
800:0d:29:57:96:bf 113
第11章WLAN案例分析311
WTEE
11
518
535
30 802.11 Disassoc
30 802.11 Disassoc
30 802.11 Disassoc
30 80211 Ds 
3
308
802.11 Disassoo
802.11WEPData
802.11 Disassoc
Rsp
---
## Page 335
RTS/CTS协议，开始发送数据：
的笔记本电脑到入口点）。从这一点看，姜华确信网络正在遭受攻击。
击者无序地去等待相应的时间段，于是在网络中造成了很多冲突。
止隐藏节点问题，即物理距离远的工作站可以看到入口点但是却看不到其他工作站。由于攻
作站同时要发送数据，就会发生冲突，这时就会看到RTS/CTS协议，这一协议还有助于防
RTS/CTS协议是用来在无线网络中的工作站之间保证有序的通信。如果一个网络中有几台工
发，因此系统尝试着重新连接入口点。系统开始发送一个广播请求：
312UNIX/Linux网络日志分析与流量监控
从第66 帧开始，马力的笔记本再一次试图连接到无线网络中，随后一个CTS 帧结束了
接着取消连接帧越来越多，而且两个方向都有（从入口点到马力的笔记本电脑和从马力
以上数据显示，在入口点多次出现重复请求发送/清除发送协议并尝试发送数据
另一个取消连接帧又出现了，并正在断开所有连接记录：
接着，马力的笔记本重新连上了入口点并发送数据；
DisassocRsp
DisassocReg
随后，入口点对马力的请求作出了响应：
ProbeRsp
4310:14:48.264047
3610:14:48.26171100:40:96:44:17:DF00:0d:29:57:96:bf00:0d:29:57:96:bf1161802.11WEPData
3310:14:48.259968
1910:14:48.12659600:0d:29:57:96:DF00:40:96:44:17:DF00:0d:29:57:96:bf 1162802.11
5610:14:48.32180300:0d:29:57:96:DF00:40:96:44:17:DF00:0d:29:57:96:bf11300802.11DisasS0c
51 10:14:48.281016 0040:96:44:17:DF 00:0d:29:57:96:DF 00:0d:29:57:96:bf11 300 802.11 Disassoc
50 10:14:48.278244 00:0d:29:57:96:DF 00:40:96:44:17:DF 00:0d:29:57:96:bf 11 300 802.11Disass0c
4810:14:48.27403300:40:96:44:17:DF00:0d:29:57:96:DF00:0d:29:57:96:bf11300 802.11DisaSSOc
3110:14:48.256144
5410:14:48.30905400:0d:29:57:96:DF00:40:96:44:17:DF1120802.11RTS
5210:14:48.29044300:0d:29:57:96:DF00:40:96:44:17:DF1120802.11RTS
4710:14:48.270811
4610:14:48.269482
4510:14:48.267347
4410:14:48.266852
4310:14:48.265868
00:0d:29:57:96:bf
00:0d:29:57:96:bf
00:0d:29:57:96:bf
00:0d:29:57:96:bf
00:0d:29:57:96:bf
00:0d:29:57:96:DF00:40:96:44:17:DF
00:40:96:44:17:DF00:0d:29:57:96:DF
00:40:96:54:56:33
00:40:96:44:17:DF1120 802.11RTS
00:40:96:44:17:DF1120802.11RTS
00:40:96:44:17:DF11 20 802.11 RTS
00:40:96:44:17:DF1120802.11RTS
00:40:96:44:17:DF1120802.11RTS
00:40:96:44:17:DF
00:0d:29:57:96:bf11841802.11
00:0d:29:57:96:bf 11570 802.11
00:40:96:54:56:3311
300
---
## Page 336
并提高管理员登录密码强度。
警。最后要注意，在保证无线AP或路由器软件版本为最新的前提下，关闭远程Web管理，
议（又叫802.11i)，有条件的一定要使用WID和NAC系统以便监视攻击行为并及时得到报
过滤。另外WEP安全对攻击者早已无效，所以你应升级到具有802.1X身份识别的WPA2
方法却不起作用，使用无线分析器依然能发现隐藏的SSID，通过改变MAC也能跳过MAC
信号泄漏，关闭 SSID广播，设置MAC 地址过滤机制。然而对于高明的攻击者来说，这些
百米内的无线网络信号（比如卡皇等设备，但其辐射对人体有危害），因此我们应限制无线
影响，而距离较远（比攻击者更接近入口点）的用户可能影响不大。
Sequence Spread Spectrum，DSSS）技术的工作站来说，越接近攻击者的用户就越容易受到
对于在一个开放的环境中（例如一个大的会议室）使用802.11b直接序列扩频（Direc
时，无线信号强度会随之衰减，信号衰减的程度取决于传输技术、初始强度和传输的介质。
取消连接帧。因为管理流量没有加密或者认证，因此攻击者可以伪造这些帧的地址。
理帧，告诉对方要断开连接。任何一端一旦发送数据就有可能收到自称来自另一端的伪造的
击者只是简单地等待一个通过无线传输的数据帧，随后立即从相反的方向伪造一个802.11
以前对于设计上有缺陷的802.11协议来说，几乎不可能防御我们所讨论的取消连接攻击。
于，它发生在无线网络中。传统上第二层协议（它是点对点的）只具有有限的安全特性。
接建立过程，
一帧的数据，攻击者随后便伪造一个取消连接帧破坏连接，并强迫它们一遍又一遍地重复连
如何防止无线攻击造成的掉线呢？首先，如果攻击者使用高增益网卡，它能接受附近
由于无线通信的特性，这种攻击表面上只是影响随机的系统。
可以进一步判断林峰的网络正遭受拒绝服务攻击。这次事件和以往案例的不同之处
攻击者发送了更多的恶意取消连接帧，这个过程反复出现。马力的笔记本偶尔成功发送
65789701723415767
18:14:48
网络中任何正常的业务都无法进行。
10:14:4
品
品
8
8
6858
40
1888
0d:2
品
品易
44
第11章WLAN案例分析313
当无线信号从工作站传
在
在
---
## Page 337
快速帮助。图12-1为GPG 加密文本文件演示。
丢，因为凭它就可以去银行取你的钱。更多用法请参考 man gpg，也可通过 gpg --help 获取
道，这样可以让别人向你汇钱。而存折这个私钥呢，是要小心地藏好的，绝对不能满世界乱
账号，私钥相当于你的银行存折和银行卡。
人，以便其他人与用户通信。
拥有一对密钥：公钥和私钥。其中，密钥由用户保存，公钥则由用户尽可能地散发给其他
的长度，DSA为1024。
1024位之间，ElGamal可以为任意值。如果选择高于1024的长度，则只有ElGamal为指定
加密算法，所以使用更自由。
许多专利算法，属于美国加密出口限制之列。而GPG是GPL 软件，并且没有使用任何专利
开源的PGP，就是用来加密数据与制作证书的一套工具，其作用与 PGP 类似。PGP 使用了
术标准设计，用于加密、数字签名及产生非对称密钥对。
十
GPG可生成各种各样的密钥对，
12.1
公钥和密钥是现在密码学的重要发明。以我们生活中的例子来说，公钥相当于你的银行
GPG使用非对称加密算法，安全程度比较高。所谓非对称加密算法，就是每个用户都
简单地说，PGP是一款利用公钥和密钥技术的加密和身份验证软件。而GPG呢，就是
GnuPG（简称 GPG）是开放源代码的PGP 加密软件，依照由IETF制定的OpenPGP技
第12章数据加密与解密案例
GPG概述
ith
tm
$
etal /tmp s cat myfile.txt.gpg
at /tmps vat myfiletxt
Y0）001180
例如：
密钥对保存在～/.gnupg目录下，用以下命令查看：
在root的根目录下会产生一对新的密钥（私有密钥和公用密钥）。
用以下命令创建新的密钥：
如果是首次使用GPG软件，
：表示创建ASCII字符的输出（以.asc为扩展名是为了方便用电子邮件传输）。
表示加密（encrypting）。
表示签订（signing）。
#gpg--importredhat.asc
#gpg --import 
导人和签订密钥
创建密钥
#gpg-searRedHat
#gpg --sign-key 
$ gpg --list-keys
#gpg--gen-key
sub-- secret key or privatekey,ID:84F6D7B9]
sub1024g/84F6D7B92012-06-21
/home/xxxxx/.gnupg/pubring.gpg
gpg:Warning:using insecure memory!
，必须先给自己创建一对新的密钥，即公钥和私钥。
第12章数据加密与解密案例315
11D2A
自联客讯公
IDEA
业
---
## Page 339
事件背景
网络到底遭到了什么攻击？
疑之处。她用抓包工具分析发现网络中存在大量广播包，这和交换公钥出错有联系吗？她的
发现交换公钥出现导入错误。但是杨芳并没有在HIDS系统和SSH的连接日志中发现任何可
案例讲解GPG密钥安全问题。
题，但在网络安全收到威胁的情况下，这种双方的信任将变得不可靠。下面通过一个真实的
渠道把自己的公钥传递给别人，或发布到公共密钥服务器让大家下载。正常情况下这没有问
12.1.4签订和验证
多的人知道你的公用密钥。
316UNIX/Linux 网络日志分析与流量监控
12.2案例二十一：
中间人攻击使得SSH连接不再安全。杨芳在参加一个国际安全会议期间，发送邮件时
杨芳在一个国内知名的IT外包公司做安全顾问，每天会接触各种各样的人，但她更喜
难度系数：★★★
故事人物：
GPG体系没有核心授权机构，所有信息传递都是分散的、社会化的。你可以通过任何
用下面的命令验证加密数据的签名：
每个知道你公用密钥的人都可以用下面的命令检查你签订的文件的真伪：
--armor表示创建ASCII形式的密钥，这样就能把它放在邮件或主页上。
用以下命令可以导出ASCII编码的公用密钥：
--armor表示的意思和上面介绍一样，表示文件或二进制文件，如 tar文件。
--detach-sign表示签名放在别的文件里。最好是这样做，特别是签订二进制文件的时候。
--export表示从公用密钥库中取出你的公用密钥。
GPG有一些选项有助于发布公用密钥，称为导出密钥，通过导出公用密钥，可以让更
-d 表示加密，表示想要加密的文件名。
例如：