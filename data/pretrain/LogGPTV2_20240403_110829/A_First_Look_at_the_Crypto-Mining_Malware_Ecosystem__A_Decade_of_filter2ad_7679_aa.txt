title:A First Look at the Crypto-Mining Malware Ecosystem: A Decade of
Unrestricted Wealth
author:Sergio Pastrana and
Guillermo Suarez-Tangil
A First Look at the Crypto-Mining Malware
Ecosystem: A Decade of Unrestricted Wealth*
Sergio Pastrana
Universidad Carlos III de Madrid
PI:EMAIL
Guillermo Suarez-Tangil
King’s College London
PI:EMAIL
9
1
0
2
p
e
S
5
2
]
R
C
.
s
c
[
2
v
6
4
8
0
0
.
1
0
9
1
:
v
i
X
r
a
Abstract—Illicit crypto-mining leverages resources stolen from
victims to mine cryptocurrencies on behalf of criminals. While
recent works have analyzed one side of this threat, i.e.: web-
browser cryptojacking, only commercial reports have partially
covered binary-based crypto-mining malware.
In this paper, we conduct the largest measurement of crypto-
mining malware to date, analyzing approximately 4.5 million
malware samples (1.2 million malicious miners), over a period
of twelve years from 2007 to 2019. Our analysis pipeline applies
both static and dynamic analysis to extract information from the
samples, such as wallet identiﬁers and mining pools. Together
with OSINT data, this information is used to group samples into
campaigns. We then analyze publicly-available payments sent
to the wallets from mining-pools as a reward for mining, and
estimate proﬁts for the different campaigns. All this together is
is done in a fully automated fashion, which enables us to leverage
measurement-based ﬁndings of illicit crypto-mining at scale.
Our proﬁt analysis reveals campaigns with multi-million earn-
ings, associating over 4.4% of Monero with illicit mining. We
analyze the infrastructure related with the different campaigns,
showing that a high proportion of this ecosystem is supported by
underground economies such as Pay-Per-Install services. We also
uncover novel techniques that allow criminals to run successful
campaigns.
Keywords: Malware, Mining, Monero, Cryptocurrency
I. INTRODUCTION
Mining is a key component responsible for the wealth of
Blockchain-based cryptocurrencies. This process requires a
network of interconnected miners to solve a complex math-
ematical problem in order to link blocks and maintain the
integrity of the transactions. In exchange, miners receive an
amount of the mined cryptocurrency as a reward.
The high value of cryptocurrencies has attracted a large
number of malicious actors that use hijacked resources to mine
these currencies. The illicit crypto-mining threat has grown
considerably over the recent years
[1], and it is considered
one of the top-most cybersecurity threats, even surpassing
ransomware according to recent reports [2].
Illicit crypto-mining is typically conducted using either one
of these two modes: (i) by using browser-based crypto-
mining programs (dubbed cryptojacking [3]), where the min-
ing process is run in scripts (typically JavaScript) embed-
ded in web content; or (ii) by using binary-based crypto-
mining malware, where the mining process is embedded in the
payload of a malware running in infected machines that are
*A shorter version of this paper appears in the 2019 ACM Internet
Measurement Conference (IMC). This is the full version.
connected to the Internet. In both cases, by using hundreds of
hijacked machines, perpetrators can obtain a hash-rate similar
to medium-sized mining farms. Each mode has different char-
acterizing features and unique challenges, specially when it
comes to devising effective countermeasures. For example, in
browser-based cryptojacking the damage ceases when the vic-
tim stops browsing the site. Also, users can reduce the threat
by restricting the use of JavaScript. Meanwhile, crypto-mining
malware entails classical malware-related challenges, such as
persistence and obfuscation. Also, since mining increases the
CPU load, thus reducing the computer’s performance, it might
be noticed by end-users. Thus, we observe a new paradigm
aimed at evading user- rather than AntiVirus-detection using
techniques such as idle mining (mining only when the CPU
is idle) or reducing CPU consumption when monitoring tools
(e.g., Task Manager) are running. For readers unfamiliar with
the topic, we refer to the Background section in §II for an
introduction to cryptocurrency mining and its threats.
Motivation. While illicit crypto-mining has been less notori-
ous than other threats such as ransomware, it poses nonetheless
an important threat to users and organizations; and its presence
is an indicator of weaknesses in security practices that must
be addressed [4]. First, the proﬁts generated by their miners
introduce massive incomes to cyber-criminals. These incomes
fuel the underground economy and gear other cyber-criminal
activities [5]. Second, this threat causes important economical
loses to their victims. By draining the CPU-usage, corpora-
tions see how their electricity bills increase and how their
hardware rapidly deteriorates [2], [6]. Finally, this indirectly
causes a non-negligible environmental footprint [7]. Due to
these concerns, browser-based crypto-mining has been widely
studied recently, both analyzing it as a crime [8], [9], [10],
[11] and as an alternative business model to monetize web
content [12], [13], [14]. However, the literature lacks of a
systematic approach to measure the binary-based mining threat
at scale.
The ﬁrst and only seminal work putting this threat
in
perspective is from 2014 [15]. Authors analyzed 2K malware
samples mining Bitcoin and their methodology relied on the
analysis of public transactions. However, there has been a sig-
niﬁcant increase in the number of malware samples monetizing
this threat since 2014 [1], [16]. Also, criminals’ attention has
shifted to other cryptocurrencies, mainly motivated by: i) the
proliferation of ASIC mining, which uses dedicated hardware
and renders the use of desktop computers no longer proﬁtable
for mining bitcoins, and ii) the development of protocols that
provide transaction anonymity (such as those used in Zcash
or Monero). Anonymous currencies are used by criminals to
thwart traceability and they are on demand in underground
markets. Commercial reports, in the form of blog posts [16],
[3] or white papers [4] provide a further, but limited, view
of the magnitude of the problem and the landscape. Security
ﬁrms have analyzed isolated cases of decontextualized mining
operations [17], [18]. However, these studies are limited by
the simplicity of the analysis.
In this paper, we aim to bridge these gaps by addressing
the following research questions: (1) What are the preferred
cryptocurrencies mined by criminals? (2) How many actors are
involved in this ecosystem and what are their proﬁts? (3) What
is the level of sophistication used in different campaigns and
how does this affect the earnings? (4) What is the role of
underground markets and what are the tools and techniques
adopted from them? (5) How can we improve current coun-
termeasures and intervention approaches? Due to potential
ethical concerns arisen from this work (see Appendix), we
obtained approval from our REB ofﬁce.
Novelty. Our work focuses on crypto-mining malware. By
looking at a wide-range of underground communities, where
knowledge and tools are shared, we have observed increased
interest in this malware. This suggests that cybercrime com-
moditization plays a key role in the wealth of illicit crypto-
mining. We design a measurement pipeline to automatically
analyze malware samples observed in the wild and to extract
information required to identify the miners and pools, using
both dynamic and static analysis. Then, we build a graph-based
system that aggregates related samples into campaigns based
on a series of heuristics. The system is designed to distinguish
campaigns using third-party infrastructure such as Pay-Per-
Install (PPI) services or binary obfuscators. This allows to
analyze to what extent this threat is sustained by different
underground markets [5]. Our analysis system enables the
research community to leverage crypto-mining measurements
at scale.
Findings. Among others, our main ﬁndings include:
1) Monero (XMR) is by far the most popular crypto-
currency among cyber-criminals in underground economies
(§IV-B). Considering only crypto-mining malware, our proﬁt
analysis shows that criminals have mined over 4.37% of the
circulating XMR. Although this depends on when criminals
cash-out their earnings, we estimate that the total revenue
accounts for nearly 58M USD. These criminal earnings should
be added to estimations from parallel work focused on
browser-based cryptojacking (§VII).
2) Campaigns that use third-party infrastructure (typically
rented in underground marketplaces) are more successful.
However, this is not always the case. Some of
the most
proﬁtable campaigns rely on complex infrastructure that also
uses general-purpose botnets to run mining operations with-
out using third-party infrastructure. Here, we discover novel
malware campaigns that are previously unknown to the com-
munity (e.g., the code-named Freebuf or the USA-138
campaign presented as case studies in §V). Moreover, only
some criminals keep their infrastructure updated, for example
when they are banned in mining pools or when the mining
software needs to be updated due to changes in the mining
algorithm.
3) Campaigns use simple mechanisms to evade detection,
like using domain aliases to contact mining pools (which
prevents simple blacklisting approaches), or idle mining.
4) There are other criminals running successful campaigns
with minimal
infrastructure. A common yet effective ap-
proach is to use legitimate infrastructure such as Dropbox
or GitHub to host
the droppers, and stock mining tools
such as claymore and xmrig to do the actual mining.
We also show what are the most popular Monero mining
pools (crypto-pool, dwarfpool and minexmr) among
criminals and discuss the role of these and other pools when
devising countermeasures.
Contributions. To the best of our knowledge,
this paper
presents the largest systematic study of malicious binary-based
crypto-mining. Our main contributions are:
1) We analyze and describe the role of underground com-
munities for the proliferation of the illicit crypto-mining
business (§II).
2) We present a system that uses both static and dynamic
analysis to extract relevant mining-related information
from crypto-mining malware, such as wallet addresses
and pool domains (§III). Our system uses different tech-
niques to aggregate related samples into larger campaigns
represented as a graph that is then mined for further
analysis. Additionally, we feed the system with infor-
mation gathered from various Open-Source Intelligence
(OSINT) repositories to further classify and analyze the
campaigns.
3) We present a longitudinal study of the crypto-mining
malware threat using data spanning over more than a
decade (§IV and §V). Then, by focusing on Monero,
we rely on information gathered from mining pools to
measure the earnings gained by each campaign. We also
analyze the infrastructure used by criminals and extract
the attribution to stock mining software.
4) We propose a number of countermeasures, and discuss
the efﬁcacy of existing ones together with the open chal-
lenges (§VI). Then, we contextualize the most important
ﬁndings of our study with respect to relevant works in
the area (§VII).
Finally, to foster research in the area, we release our dataset
in our online repository.1 We encourage readers to visit this
repository as it provides a wider presentation of the measure-
ments left out of this paper due to space constraints.
1https://github.com/gsuareztangil/cryptomining-malware
2
II. BACKGROUND
In this section, we ﬁrst provide an overview of the crypto-
currency mining process. Then we describe the underground
economy supporting the illicit crypto-mining threat.
Cryptocurrency Mining. Cryptocurrencies are a type of
digital assets that can be exchanged in online transactions.
These transactions are grouped into blocks and added to a
distributed database known as the blockchain. Each block is
linked to its previous block. Addition of new blocks to the
blockchain is done by voluntary miners. These must compute
a cryptographic hash of the block, which includes complex
mathematical puzzle known as ‘Proof-of-Work’ (PoW). As a
reward, miners receive a certain amount of the currency. The
mining process maintains the integrity of the blockchain and
it is at the core of all cryptocurrencies.
The increased value of cryptocurrencies such as Bitcoin
or Ethereum leads to the growth of mining farms using
specialized hardware known as ASICS. Thus, mining these
cryptocurrencies using end-user machines such as laptops or
desktop computers was useless. However,
in 2014 a new
PoW known as Cryptonote required not only CPU power
but also memory, turning ASIC-based mining inefﬁcient and
thus gaining again the attention of individuals willing to mine
with their home machines. Additionally, the mining algorithm
changes periodically,
thus discouraging ASIC development
(which is optimized for speciﬁc algorithms) [19]. Examples
of cryptocurrencies using Cryptonote as PoW are: Monero
(XMR) and Bytecoin (BCN).
When a new block is added to the blockchain, only the ﬁrst
miner being able to mine the block will get the reward. This
turns the mining process into a race where speed is the hashrate
of a miner. The higher the hashrate, the higher the probability
of mining a block and thus getting the reward. Accordingly,
mining is typically done using public mining pools, which can
be viewed as partnership services between various workers
where the complexity of the mining challenge is distributed
among the partners. Each partner contributes with a given
hashrate aimed at solving the puzzle, and when the pool
successfully mines a block, the reward is divided among the
partners proportionally to their hashrate. In order to get this
reward, workers must provide some form of identiﬁcation.
This can be proprietary site-keys, like in the case of CoinHive
(the major provider of browser-based mining services), emails
or wallet addresses. The communication between each miner
and the pool is done by using Stratum, which is a de-facto
TCP based protocol evolved from the getwork protocol [20].
Crypto-mining malware and cryptojacking. Crypto-curren-
cy mining is a rather easy monetization technique using
hardware resources. However, it requires an investment in
equipment and also entails a cost in terms of energy. In illicit
cryptomining, criminals make use of their victims’ computing
resources to mine cryptocurrencies on their behalf. This threat
exists since the creation of Bitcoin in 2009, but it has increased
since 2014 due to the inception of Cryptonote and other PoW
algorithms resistant to ASIC-based mining.
Illicit crypto-mining is performed by using two techniques:
browser-based or binary-based mining. In the former,
the
mining payload is embedded in web resources which are
executed by client browsers without the explicit consent of
the users [9], [8]. In the latter, the payload is distributed in
the form of malware.
The Underground Economy. Underground markets play a
key role in the business of malicious crypto-mining. Users
with few technical skills can easily acquire services and
tools to set up their own mining campaign. Forums are also
used for sharing knowledge. To put our study in context,
we have analyzed a dataset of posts collected from various
underground forums [21], looking for conversations related to
crypto-mining. We observe that crypto-mining malware can be
easily purchased online, for a few dollars (e.g., the average cost
for an encrypted miner for Monero is 35$). In particular, we
have seen an online service which allow to create customized
binaries (e.g., for a particular cryptocurrency and/or a given
pool) to mine cryptonote based currencies, for $13.2 It pro-
vides several stealthy-related techniques such as idle mining
or the use of execution-stalling code [22] targeted to certain
conditions (e.g., when the Task Manager is running). Other
providers opt to share their miners for free, in exchange for a
donation: “Miner is free, we charge a fee of 2% to cover the
time coding.” Figure 1 shows a longitudinal analysis of posts
related to crypto-mining in these forums. Here, we show that
Monero is the most prevalent currency nowadays.
Fig. 1: Evolution of the number of threads from underground
forums related to mining of different cryptocurrencies.
We also observed that a common topic of conversation
concerns (i) “friendly” pools, i.e.: pools that do not generally
ban users displaying botnet-like behaviors, or (ii) how to
remain undetected otherwise. For instance, users claim that a
good trade-off between proﬁtable hash-rates and a long-lasting
mining strategy is using botnets with less than 2K bots. For
2For ethical reasons we do not disclose the URL of this service
3
20122013201420152016201720180.00.10.20.30.4Number of threadsBitcoinMoneroZCashEthereumLitecoinDogecoinbigger botnets, many discussions and tutorials explain how to
conﬁgure proxies and provide advice on how to reduce the risk
of being exposed: “The best option is to use a proxy and you
can use any pool. Contact me for PM, I am willing to help”.
Also, we found various conversations with users looking for
partners and offering custom (private) mining pools: “In my
pool there is no ban by multiple connections.”
Finally, we note that it is also possible to purchase all-you-
need packages, including tools and services, with a guarantee
period and maintenance (e.g., re-obfuscation when the miner is
detected, or updates to new versions). For the curious reader,
Figure 2 shows a ﬂyer posted in one of the underground
markets, which offers a full Monero botnet.
Fig. 2: Crypto-mining package offered in an underground fo-
rum, including botnet setup, XMR miner and proxy. Permanent
link: https://perma.cc/4FN8-B98M.
Take-Away: The support offered by underground communities
to criminals explains the sharp growth on the amount of
malware monetizing their victims. This motivates the need
for a longitudinal measurement of this threat. We show that
Monero is currently the most discussed crypto-mining coin by
underground forum users.
III. MEASUREMENT METHODOLOGY
A general overview of the measurement methodology is