1 3.3.3 LDAP 和 PKI
在整合数字证书以便传输时， 公钥基础设施σ阻)使用 LDAP。 第7章对 P阻 做了 深入介绍， 但
第 1 3 章 管理身份与认证
简而言之， PKI 是一组技术， 在证书的整个生命周期 中实现对数字证书的管理。 很多时候， 客户需
要 向证书授权组织(CA)进行有关证书信息的咨询活动 ， 此时 LDAP 就是用到的协议之一 。
LDAP 和集中式访问控制系统可用 于支持单点登录功能。
1 3.3.4 Kerberos
票证身份认证这种机制采用第三方实体证实身份并提供身份认证。 最常用的， 也是最知名 的票
证系统是 Kerberos。
注意 :
Kerberos 的名 字源 于希腊神话。 一只长有三个头的狗名 为 Kerberos， 它 守护着通往 阴 间 的大门。
这只 长有三个头 的狗脸朝内， 目 的是防止逃跑而非 防止进入。
Kerberos 给用户 的提供是单点登录解决方案以及能够保护登录信息。 现在的 Kerboros 5 版本依
赖的是对称密钥加密(又称密钥式密码)， 使用的是对称加密的高级加密标准(AES)协议。 Kerberos 使
用端对端安全机制保障认证通信的机密性和完整性， 有助于预防窃听和重放攻击。 理解 Kerberos 所
用 的几个不 同 元素很重要:
密钥分发中心 密钥分发中心(Key Distribution Center， KDC)是提供身份认证服务的可信第三
方。 Kerberos 使用对称密钥加密认证需要登录服务器的客户 。 所有客户和服务器都用 KDC 做了注
册 ， 所有网络成员 的密钥都由 KDC 维持 。
Kerberos 身份认证服务器 身份认证服务器托管 KDC 的功能: 票据授予服务σicket-Granting
Service， TGS)和身份认证服务(Authentication Service， AS)。 然而， 可能在另一台服务器上托管票据
授予服务。 身 份认证服务认证或拒绝票据的真实性和及时'性 。 这台服务器通常被称为 KDC。
授予票证 授予票证(Ticket-GrantingTicket， TGT)通过 KDC 提供主体己认证的证明， 并授权请
求访问其他客体的票据。 TGT 己进行加密， 并且包括对称密钥、 过期时 间和用户 的 IP 地址。 主体
在请求访 问 客体的票据时， 会出 示 TGT。
票据 票据是加密的信息， 证明主体己被授权访问某个对象。 票据有时被称为服务票据(Servi臼
Ticket， ST)。 主体请求访问客体的票据， 如果他们已经进行认证， 并被授权访问对象， Kerberos 会
向他们发放一张票据。 Kerberos 票据有特定的寿命和使用参数。 一旦票据到期， 就必须要求客户续
期或申请新票据 以继续与 任何服务器通信 。
Kerberos 需要账户数据库， 这通常包含在 目 录服务中 。 它使用客户 、 网络服务器和 KDC 之间
的票据交换来证明身份并提供身份认证。 这允许客户端从服务器请求资源， 但客户端和服务器都应
该能够确保双方的身份。 这些加密的票据也确保登录凭证、 会话密钥和认证消息不会以明文传输。
Kerberos 登录过程如下 :
(1 ) 用 户 将用户名和密码键入客户端。
(2) 客户端使用 AES 加密用户 名 ， 然后传输至 KDC。
(3) KDC 使用 己有证书 的数据库来认证用户名。
(4) KDC 产生一个同步密钥 ， 用 于客户端和 Kerberos 服务器间的通信。 它加密用户 密码的散列
值 。 KDC 也 生成一个有加密时间戳的授 予票证(TGT)。
(5) KDC 然后传输加密过的 同步密钥和加密过的带有时间戳的 TGT 给客户端 。
(6) 客户端 安装 TGT， 一直使用直至期满。 客户端也使用用户 的散列 解密对称密钥 。
403
404
CISSP 官方学 习指南(第 7 版)
注意 :
请注意客户 的 密码从来没有在网络上进行传播， 但它 已经过认证。 服务器使用 散列 的用户密码
加密对称密钥 ， 且只 能用散列 的用 户 密码未解密。 只要用 户 输入正确的 密码， 这一步就发挥作用 。
然而， 如果用户输入不正确 的 密码 ， 就失败 了 。
当客户端要访问一个对象时， 如托管在网络上的资源， 它必须通过 Kerberos 服务器请求票据。
下面是这个过程涉及的步骤:
(1) 客户端将其 TGT 发送回 KDC， 同 时请求访 问某个服务器或服务。
(2) KDC 认证 TGT 的有效性并查看其访问控制矩阵， 从而认证用户 是否拥有能够访问所请求
资源的足够权限 。
(3) KDC 生成一个服务票据 ， 然后将它发送至客户端。
(4) 客户端发送票据至服务器或服务主机 。
(5) 服务器或服务主机通过 KDC 认证服务票据的有效性 。
(6) 一旦认证了用户身份与授权， Kerberos 活动就完成了 。 服务器或服务主机随后建立与客户
端的会话 ， 从而开始进行通信或数据传输。
作为一种多用途的身份认证机制， Kerberos 可 以用在本地 L刷、 本地登录、 远程访问 以及客户
端·服务器资源请求中 。 然而， Kerberos 存在单点故障， 也就是 KDC 会出现单点故障。 如果 KDC
被破解， 那么 网络中所有系统的秘密密钥也都会被破解。 此外， 如果 KDC 离线， 那么就无法对主
体进行身 份认证。
它也有严格的时间要求和默认的配置要求， 即所有的系统彼此要在 5 分钟 内 同步时间。 如果一
个系统不同步或时间被改变了 ， 以前发出的TGT 将不再是有效的， 系统将无法接收任何新的票据。
实际上， 客户端将被拒绝访问 任何受保护的网络资源。
1 3.3.5 联合身份管理和 sso
在相当长一段时间 内 ， ss。 在 内部网络上是常见的， 但在互联网上不常见。 然而， 随着基于云
的应用程序的爆发式增长， 用户访问互联网资源渐渐开始需要 sso 解决方案 。 联合身份管理是一种
能够满足这一需求 的 sso 形式。
身份管理是对用户 身份和凭证的管理。 联合身份管理超越了单一的组织。 多个组织可以加入一
个联盟或一个组， 他们同 意通过一个方法共享彼此的身份。 每个组织的用户在各 自 的组织登录一次
且在他们的凭证和联合身份相匹配后， 他们就可以使用这个联合身份来访问这一组中任何其他组织
的资源。
联盟可以由一个大学校园、 多个大学校园、 多个共享资源的组织或者其他可以达成共同联合身
份管理系统的组织内 的多个不相关的网络构成。联盟的成员将组织中的用户身份与联合身份相匹配。
例如， 许多企业在线培训网站使用联合 sso 系统。 当组织与在线培训公司协调员工访问事直时，
他们还需要协调联合访问所需的细节。 一个常见的方法是将用户的内部登录 D 和联合身份进行匹
配。 组织内 的用户使用正常的登录 E 进行登录。 当用户用 Web 浏览器访问培训网站时， 联合身份
管理系统使用他们的登录 D 来检索匹配的联合身份。 如果找到匹配， 用 户就会被授予联合身份被
授予的网页访问权。
管理员在后台管理这些细节， 过耳呈对用户来说通常都是透明的。 用户不需要再次输入他们的凭证。
第 1 3 章 管理身份与认证
如果有多家企业联盟 ， 那么 当他们互相交流时就需要找到一种共同语言 ， 这是一种挑战。 他们
通常会有不同 的操作系统， 但他们仍需拥有共同语言。 为满足这一需要， 这些联合身份系统常常使
用 安全声明标记语言(SM在L)或服务配置标记语言(SPML)。 作为背景， 此处对一些标记语言进行了
简短描述。
超文本标记语言 超文本标记语言阳h皿)普遍用于展示静态网页。 盯ML 源 自标准通用标记
语言(SGt-.在L)和通用标记语言(GML)o HTML 使用标签描述数据的显示方式， 以操控文本的大小和颜
色 。 例如， Hl 后 的标签将文本作为一级标题显示， 可表示为 : I Passed The CISSP Exam。
可扩展标记语言 可扩展标记语言。αt1L)超越了对数据显示方式的描述， 而实现了对数据本身
的描述。 XML 所包含的标签可以将数据描述为任何所需的样子。 例如， 以下标签识别了作为测验
结果的数据: Passed。
多家供应商的数据库可以将数据输入为 XML 格式， 或从 刘1L 格式输出数据， 从而使孙也 成
为用于信息交流的共同语言。 现己创建许多特定模式， 因此这些企业清楚地知道为实现特定 目 的该
用 何种标签。
安全声明标记语言 安全声明标记语言(SM在L)是一种基于泊在L 的语言， 普遍用于联合组织之
间 交换认证和授权(AA)信息， 常为浏览器访问 提供单点登录(SSO)功能 。
服务配置标记语言 服务配置标记语言(SPML)是基于 刘伍 的新框架， 但是出于联合身份单点
登录 目 的 ， 专门设计用于用户信息交换。 SPML 基于 目 录服务标记语言(DSML)， 而 DSt-.在L 能够以
XML 格式显示基于轻量级 目 录访 问 协议(LDAP)的 目 录服务信息 。
访问控制标记语言 访问控制标记语言仅ACt-.在L)用 于在邓伍 格式内定义访问控制策略， 并且
通常实现基于角色的访问控制。 兀气CML 有助于给联盟中的所有成员提供保证， 保证他们向不同角
色授权相 同级别的访问。
提示 :
SMt1L是王联网上流行的 SSO 语言。 XACML 已经成为 流行的软件定义网络应 用 。
1 3.3.6 其他单点登录的例子
美国麻省 理工学院开发的安全认证系统(Kerberos)也许是组织内单点登录最为广泛认可和部署
的形式， 但并不是同类中 的唯一。 在本节中， 我们总结了你也许会遇到的其他单点登录系统。
在登录会话开始时， 脚本访问或登录脚本通过自动化处理发送登录凭证， 从而建立通信连接装
置。 即使环境仍需要单独的身份认证过程来连接每个服务器或资源， 脚本访问 通常也可以模拟单点
登录访问。 单点登录技术不可用时， 脚本在环境中可实现单点登录。 脚本和批处理文件通常包含明
文形式的访 问 凭证 ， 所 以应被存储在受保护的区域内 。
欧洲安全多环境应用 系统(SESAME)是一个基于邀请的认证系统， 它被开发出来是为了解决
Kerberos 的缺点 。 然而， SESM1E并没有解决 Kerberos 的所有问题。 新一代的 Kerberos 和多家供应
商 的实施都绕过了 SESM伍， 最终解决了 Kerberos 最初版本的所有问题。 在安全行业， SESM扭
己不再被认为是一款可行的产品。
KryptoKnight 是 IBM 开发的一个基于邀请的认证系统。 它与 Kerberos 相似， 但是使用对等认证
而非第三方认证。 KryptoKnight 被纳入 NetSP 产品。 SESM伍、 KryptoKnight 和 NetSP 从未盛行，
并且再也不会被广泛使用 。
405
406
CISSP 官方学习 指南(第 7 版)
OAuth(意为公开认证)和 OpenID 是应用于网络单点登录的较新的例子。OAuth 是一个开放标准，
它与 H盯P 协作 ， 允许用户 以单一账户登录。 例如， 用 户可登录他们的谷歌账户 ， 并用 同一账户登
录 Facebook 和 Twitter。 谷歌支持 OAuth 2.0， 而 OAuth 2.0 不 向后兼容 OAuth 1 .00 OAuth 2.0 被编
号为 RFC 67490 OpenID 也是一个开放标准， 但是它由 电脑软件公司 OpenID Foundation 维护， 而非
作 为 IETF 盯C 标准。 OpenID 可与 OAuth 连 同使用 ， 也可单独使用 。
1 3.3.7 证书管理系统
当单点登录不可用时， 证书管理系统为用户 的凭证保存提供存储空间 。 用户可为需要一套不同