150.197.0.0 - 150.197.255.255
152.149.0.0 - 152.149.255.255
152.99.0.0 - 152.99.255.255
154.10.0.0 - 154.10.255.255
155.230.0.0 - 155.230.255.255
156.147.0.0 - 156.147.255.255 
157.197.0.0 - 157.197.255.255
158.44.0.0 - 158.44.255.255
161.122.0.0 - 161.122.255.255 
163.152.0.0 - 163.152.255.255 
163.180.0.0 - 163.180.255.255
163.239.0.0 - 163.239.255.255 
164.124.0.0 - 164.125.255.255 
165.132.0.0 - 165.133.255.255 
165.141.0.0 - 165.141.255.255
165.186.0.0 - 165.186.255.255
165.194.0.0 - 165.194.255.255
165.213.0.0 - 165.213.255.255
165.229.0.0 - 165.229.255.255
165.243.0.0 - 165.244.255.255 
165.246.0.0 - 165.246.255.255
166.103.0.0 - 166.104.255.255 
166.125.0.0 - 166.125.255.255
166.79.0.0 - 166.79.255.255
168.115.0.0 - 168.115.255.255
168.126.0.0 - 168.126.255.255
168.131.0.0 - 168.131.255.255
168.154.0.0 - 168.154.255.255
168.188.0.0 - 168.188.255.255 
168.219.0.0 - 168.219.255.255 
168.248.0.0 - 168.249.255.255
168.78.0.0 - 168.78.255.255
169.140.0.0 - 169.140.255.255 
192.100.2.0 - 192.100.2.255 
192.104.15.0 - 192.104.15.255 
192.132.15.0 - 192.132.15.255 
192.132.247.0 - 192.132.251.255 
192.195.39.0 - 192.195.40.255
192.203.138.0 - 192.203.146.255
192.245.249.0 - 192.245.251.255 
192.249.16.0 - 192.249.31.255 
192.5.90.0 - 192.5.90.255
198.178.187.0 - 198.178.187.255
202.14.103.0 - 202.14.103.255
Riseaux
Riseaux IP 
IP Europeens
Europeens (RIPE)
(RIPE)
 Covers Europe, the Middle East and Central 
Asia
 Not as effective to block country by country 
as many blocks cover multiple countries 
(Multinational ISPs, companies, etc)
 Also hard to block wholesale as a lot of 
global companies based in Europe
 There are a few troublesome countries worth 
blocking (Russia, Bulgaria, Romania)
RIPE 
RIPE IPs
IPs to block*
to block*
89.0.0.0/8
90.0.0.0/8
91.0.0.0/8
193.0.0.0/8
194.0.0.0/8
195.0.0.0/8
212.0.0.0/8
213.0.0.0/8
217.0.0.0/8
80.0.0.0/8
81.0.0.0/8
82.0.0.0/8
83.0.0.0/8
84.0.0.0/8
85.0.0.0/8
86.0.0.0/8
87.0.0.0/8
88.0.0.0/8
*List not guaranteed to be complete or accurate, caveat emptor
LACNIC
LACNIC
 Latin America and Caribbean
 Many organizations / entities may still 
use ARIN addresses
 Brazil and Argentina are worst offenders
 Border companies may want to leave in 
Mexico
LACNIC 
LACNIC IPs
IPs to block*
to block*
189.0.0.0/8
190.0.0.0/8
200.0.0.0/8
201.0.0.0/8
*List not guaranteed to be complete or accurate, caveat emptor
Complete Brazilian List with 
Complete Brazilian List with 
ARIN assignments
ARIN assignments
139.82.0.0/16
143.54.0.0/16
143.106.0.0/15
143.108.0.0/16
144.23.0.0/16
146.134.0.0/16
146.164.0.0/16
147.65.0.0/16
150.161.0.0/16
150.162.0.0/15
150.164.0.0/15
152.84.0.0/16
152.92.0.0/16
155.211.0.0/16
157.86.0.0/16
161.24.0.0/16
161.79.0.0/16
161.148.0.0/16
164.41.0.0/16
164.85.0.0/16
170.66.0.0/16
192.80.209.0/24
192.111.229.0/24
192.111.230.0/24
192.132.35.0/24
192.146.157.0/24
192.146.229.0/24
192.147.210.0/24
192.147.218.0/24
192.153.88.0/24
192.153.120.0/24
192.153.155.0/24
192.159.116.0/23
192.160.45.0/24
192.160.50.0/24
192.160.111.0/24
192.160.128.0/24
192.160.188.0/24
192.188.11.0/24
192.190.30.0/23
192.195.237.0/24
192.198.8.0/21
192.207.194.0/23
192.207.200.0/22
192.207.204.0/23
192.207.206.0/24
192.223.64.0/18
192.231.114.0/23
192.231.116.0/22
192.231.120.0/23
192.231.175.0/24
192.231.176.0/24
198.17.120.0/23
198.17.231.0/24
198.17.232.0/24
198.49.128.0/22
198.49.132.0/23
198.50.16.0/21
198.58.8.0/22
198.58.12.0/24
198.184.161.0/24
200.0.8.0/21
200.0.0.0/16
200.3.0.0/16
200.5.0.0/16
200.6.0.0/16
200.7.0.0/16
200.9.0.0/16
200.10.0.0/16
200.11.0.0/16
200.12.0.0/16
200.12.0.0/16
200.13.0.0/16
200.14.0.0/16
200.17.0.0/16
201.0.0.0/11
201.32.0.0/12
206.221.80.0/20
AfriNIC
AfriNIC
 A lot of fraud and phishing based here
 Not much legitimate commerce (except 
for energy companies)
 Since this is new, many assignments 
still come from RIPE address space
AfriNIC
AfriNIC IPs
IPs to Block
to Block
 41.0.0.0/8
Geo
Geo--IP Blocking Strategies
IP Blocking Strategies
 The Shotgun Approach
 Block Entire RIR address space
 Pros:  Easy and Quick
 Cons:  Might block some countries or areas 
you want.
 Example:  Australian and New Zealand sites 
use APNIC address space
Geo
Geo--IP Blocking Strategies
IP Blocking Strategies
 The Rifle Approach
 Block by specific country assignments
 Pros:  Less likely to block wanted traffic
 Cons:  Time consuming, have to keep configs
up to date, some assignments not country 
specific
Limited Geo
Limited Geo--IP Blocking 
IP Blocking 
Strategies
Strategies
 Block all protocols but mail (no spam benefit)
 Block all except web server and mail
 Block on all private LAN segments but not 
DMZ (no spam or public server exploits 
benefits)
More Limited Geo
More Limited Geo--IP Blocking
IP Blocking
 Block only interactive services (Telnet, SSH, 
VNC, Terminal services)
 Block only on specialized servers (VPN, 
database)
 Block RIR but allow certain ISP and hotel 
webspace (to allow for VPN access)
IP Chains Geo IP Blocking
IP Chains Geo IP Blocking
Example
Example
ipchains -I input -s 58.0.0.0/8 -j DENY
Cisco Geo IP Blocking
Cisco Geo IP Blocking
Example
Example
access-list 101 deny ip 58.0.0.0 0.0.0.255 any
SonicWall
SonicWall Geo IP Blocking
Geo IP Blocking
Example
Example
Geo
Geo--IP Blocking Automation
IP Blocking Automation
 Ip.ludost.net has a script that will generate 
country specific lists for importing into a IP 
Tables format
 There are companies now that will do this 
work for you, producing a file for importing 
into your configs
 Used by large websites, search engines, 
some ISPs
Resources
Resources
Bobâ€™s IP blocking list 
(http://www.unixhub.com/block)
IP to Country Database at Ludost.net
(http://ip.ludost.net)
Questions / Comments / Abuse?
Questions / Comments / Abuse?
 Email me at PI:EMAIL
 The presentation will be posted to :
www.netsecuritysvcs.com/defcon13/