C
H
D
f
o
#
1.6e+05
1.2e+05
8e+04
4e+04
s
t
e
k
c
a
p
P
R
A
f
o
#
0
0
50
100
150
200
Time (hours)
250
300
350
400
s
t
n
e
v
e
P
C
T
f
o
#
s
t
n
e
v
e
S
N
D
f
o
#
800
600
400
200
0
500
400
300
200
100
0
s
t
n
e
v
e
P
C
H
D
f
o
#
1200
1000
800
600
400
200
0
s
t
n
e
v
e
P
R
A
f
o
#
80
60
40
20
0
0
50
100
150
200
Time (hours)
250
300
350
400
Fig. 5. The scale of the raw data
Fig. 6. The scale of the events
event-generated trafﬁc that would be observed by the detection of fewer and fewer
unique MAC addresses.
7 Risk Mitigation and Analysis
In this section, we examine our efforts in minimizing the harm to users, services, hosts,
and network infrastructure while performing our experiments. We understand that ac-
tive probing involves the use of network resources and interaction with product services.
In consultation with the Computer Science and Engineering Departmental Computing
Ofﬁce, the College of Engineering Computer Added Engineering Network, and the Uni-
versity of Michigan ofﬁce of Information and Infrastructure Assurance, we developed
the following research plan to mitigate the impact on hosts, services, and network in-
frastructure: (i) to minimize the effect of network scanning, we limited the bandwidth
available to our scanning devices, (ii) We implemented a whitelisting feature to our
scanning, and the engineering computer organization broadcasted an opt-out message
to all departmental organizations prior to our experiment (along with the complete re-
search plan), (iii) We applied only those polices consistent with the Nessus “Safe Check
Only” label.
Acknowledging that a network’s security context is considered sensitive informa-
tion and data such as MAC addresses and IP addresses have been viewed as personally
154
Y. Xu et al.
s
C
A
M
f
o
r
e
b
m
u
n
d
e
t
a
l
u
m
u
c
c
A
4000
3500
3000
2500
2000
1500
1000
500
0
0
50
100
150
200
Time (hours)
250
300
350
400
Fig. 7. The accumulated number of unique MAC addresses in the departmental network
identiﬁable information in several contexts, we took steps to assure that the “research
records, data and/or specimens be protected against inappropriate use or disclosure, or
malicious or accidental loss or destruction” according to our IRB guidelines. This in-
cludes, but is not limited to the following ofﬁcial categories: Locked ofﬁce, Restricted
access, Restrictions on copying study-related materials, Access rights terminated when
authorized users leave the project or unit, Individual ID plus password protection, En-
cryption of digital data, Network restrictions, No non-UM devices are used to access
project data, Security software (ﬁrewall, anti-virus, anti-intrusion) is installed and regu-
larly updated on all servers, workstations, laptops, and other devices used in the project.
Due to the technical nature of the work, we did not seek IRB approval for the project
as we did not feel they were prepared to understand the risks of this work. The pro-
posed research plan was instead approved through the College of Engineering Dean of
Research, and additionally approved by the departmental, college, and university com-
puting organizations speciﬁed above.
8 Limitations and Future Work
While our initial evaluation demonstrates the promise of a context-aware approach to
vulnerability scanning, it does highlight several limitations which form the foundation
for future work in this area. First, the accuracy of our evaluation is hampered by the
use of network vulnerability scanning results as the sole ground truth for measuring
host conﬁguration changes. In addition to the previously discussed limitation that a
network-based scanner provides only an approximate view of a host changes, this ap-
proach also limited the granularity of our measurements to the polling frequency of the
network scanner. To overcome this issue, we plan on developing a host agent that is
capable of collecting ﬁne-grained information on local changes and deploying it on a
network with a large number of different hosts (e.g., end hosts vs. application servers).
A second rich area for future work is the exploration of new triggers (either new events
or combinations of these events) for host conﬁguration changes. Currently, the most ef-
fective events were generated by the DHCP monitor and corresponded to host reboots.
CANVuS: Context-Aware Network Vulnerability Scanning
155
In the future, we plan to increase the diversity of trigger events and explore other types
of network evidence for host changes.
9 Conclusion
In this paper, we proposed a context-aware architecture that provides information about
the network states and their changes for enterprise security applications. We described
how this architecture converts network data from infrastructure devices, network ser-
vices, and passive probes to a uniform representation stored in the network state database.
Then we introduced CANVuS, a context-aware vulnerability scanning system built
upon this architecture that triggers scanning operations based on changes indicated by
network activities. We experimentally evaluated the system by deploying it in a college-
level academic network and comparing CANVuS against an existing system. We found
that this approach outperforms existing models in low detection latency, while consum-
ing fewer network resources.
Acknowledgments
The authors wish to gratefully acknowledge the following colleagues at the University
of Michigan for their assistance in performing this work: Paul Howell, Kirk Soluk,
Dawn Isabel, Dan Maletta, Kevin Cheek, and Donald Winsor. This work was sup-
ported in part by the Department of Homeland Security (DHS) under contract numbers
NBCHC080037, NBCHC060090, and FA8750-08-2-0147, the National Science Foun-
dation (NSF) under contract numbers CNS 091639, CNS 08311174, CNS 0627445, and
CNS 0751116, and the Department of the Navy under contract N000.14-09-1-1042.
References
1. Abedin, M., Nessa, S., Al-Shaer, E., Khan, L.: Vulnerability analysis for evaluating quality
of protection of security policies. In: Proceedings of the 2nd ACM Workshop on Quality of
Protection (QoP 2006), Alexandria VA (October 2006)
2. Ahmed, M.S., Al-Shaer, E., Khan, L.: Towards autonomic risk-aware security conﬁguration.
In: Proceedings of the 11th IEEE/IFIP Network Operations and Management Symposium
(NOMS 2008), Salvador, Bahia, Brazil (April 2008)
3. Allman, M., Kreibich, C., Paxson, V., Sommer, R., Weaver, N.: Principles for developing
comprehensive network visibility. In: Provos, N. (ed.) Proceedings of 3rd USENIX Work-
shop on Hot Topics in Security, San Jose, CA, USA, July 29, USENIX Association (2008)
4. Allman, M., Paxson, V.: A reactive measurement framework. In: Claypool, M., Uhlig, S.
(eds.) PAM 2008. LNCS, vol. 4979, pp. 92–101. Springer, Heidelberg (2008)
5. Ammann, P., Wijesekera, D., Kaushik, S.: Scalable, graph-based network vulnerability analy-
sis. In: Proceedings of the 9th ACM Conference on Computer and Communications Security
(CCS 2002), Washington DC (November 2002)
6. Bau, J., Bursztein, E., Gupta, D., Mitchell, J.: State of the art: Automated black-box web
application vulnerability testing. In: Proceedings of the 31st IEEE Symposium on Security
& Privacy (S&P 2010), Oakland, CA (May 2010)
156
Y. Xu et al.
7. Beattie, S., Arnold, S., Cowan, C., Wagle, P., Wright, C., Shostack, A.: Timing the application
of security patches for optimal uptime. In: Proceedings of the 16th Annual LISA System
Administration Conference, Philadelphia, PA, USA (November 2002)
8. Edward Bjarte. Prads - passive real-time asset detection system,
http://gamelinux.github.com/prads
9. Cheswick, W.R., Bellovin, S.M.: Firewalls and Internet Security; Repelling the Wily Hacker.
Addison Wesley, Reading (1994)
10. Cooke, E., Bailey, M., Jahanian, F., Mortier, R.: The dark oracle: Perspective-aware unused
and unreachable address discovery. In: Proceedings of the 3rd USENIX Symposium on Net-
worked Systems Design and Implementation (NSDI 2006) (May 2006)
11. eEye Digital Security. Retina - network security scanner,
http://www.eeye.com/Products/Retina.aspx
12. Ilya Etingof. Pysnmp, http://pysnmp.sourceforge.net/
13. Ingols, K., Lippmann, R., Piwowarski, K.: Practical attack graph generation for network
defense. In: Proceedings of the 22nd Annual Computer Security Applications Conference,
ACSAC 2006 (December 2006)
14. Kreibich, C., Sommer, R.: Policy-controlled event management for distributed intrusion de-
tection. In: ICDCS Workshops, pp. 385–391. IEEE Computer Society, Los Alamitos (2005)
15. McAllister, S., Kirda, E., Kruegel, C.: Leveraging user interactions for in-depth testing of
web applications. In: Lippmann, R., Kirda, E., Trachtenberg, A. (eds.) RAID 2008. LNCS,
vol. 5230, pp. 191–210. Springer, Heidelberg (2008)
16. Mehta, V., Bartzis, C., Zhu, H., Clarke, E., Wing, J.: Ranking attack graphs. In: Zamboni, D.,
Kr¨ugel, C. (eds.) RAID 2006. LNCS, vol. 4219, pp. 127–144. Springer, Heidelberg (2006)
17. Microsoft. Watcher - web security testing tool and passive,
http://websecuritytool.codeplex.com
18. Oberheide, J., Cooke, E., Jahanian, F.: Cloudav: N-version antivirus in the network cloud. In:
Proceedings of the 17th USENIX Security Symposium (Security 2008), San Jose, CA (July
2008)
19. Oberheide, J., Cooke, E., Jahanian, F.: If It Ain’t Broke, Don’t Fix It: Challenges and New
Directions for Inferring the Impact of Software Patches. In: 12th Workshop on Hot Topics in
Operating Systems (HotOS XII), Monte Verita, Switzerland (May 2009)
20. Ou, X., Boyer, W.F., McQueen, M.A.: A scalable approach to attack graph generation. In:
Proceedings of the 13th ACM Conference on Computer and Communications Security (CCS
2006), Alexandria, VA (October 2006)
21. Ou, X., Govindavajhala, S., Appel, A.W.: Mulval: A logic-based network security analyzer.
In: Proceedings of the 14th USENIX Security Symposium (USENIX Security 2005), Balti-
more, MD (August 2005)
22. Paxson, V.: Bro: A System for Detecting Network Intruders in Real-Time. Computer Net-
works 31(23-24), 2435–2463 (1999)
23. Roesch, M.: Snort: Lightweight intrusion detection for networksx. In: Proceedings of the
13th Systems Administration Conference (LISA), pp. 229–238 (1999)
24. Sawilla, R.E., Ou, X.: Identifying critical attack assets in dependency attack graphs. In: Jajo-
dia, S., Lopez, J. (eds.) ESORICS 2008. LNCS, vol. 5283, pp. 18–34. Springer, Heidelberg
(2008)
25. Tenable Network Security. Nessus - vulnerability scanner, http://www.nessus.org
26. Tenable Network Security. Nessus passive vulnerability scanner,
http://www.nessus.org/products/pvs/
27. Sheyner, O., Haines, J., Jha, S., Lippmann, R., Wing, J.M.: Automated generation and anal-
ysis of attack graphs. In: Proceedings of 2002 IEEE Symposium on Security and Privacy
(S&P 2002), Oakland, CA (May 2002)
CANVuS: Context-Aware Network Vulnerability Scanning
157
28. Sinha, S., Bailey, M., Jahanian, F.: Shedding light on the conﬁguration of dark addresses. In:
Proceedings of Network and Distributed System Security Symposium (NDSS 2007) (Febru-
ary 2007)
29. Sinha, S., Bailey, M.D., Jahanian, F.: One Size Does Not Fit All: 10 Years of Applying Con-
text Aware Security. In: Proceedings of the 2009 IEEE International Conference on Tech-
nologies for Homeland Security (HST 2009), Waltham, Massachusetts, USA (May 2009)
30. Sinha, S., Jahanian, F., Patel, J.M.: Wind: Workload-aware intrusion detection. In: Zam-
boni, D., Kr¨ugel, C. (eds.) RAID 2006. LNCS, vol. 4219, pp. 290–310. Springer, Heidelberg
(2006)
31. Sourceﬁre. Sourceﬁre rna - real-time network awareness,
http://www.sourcefire.com/products/3D/rna
32. Sourceﬁre, Inc. Clamav antivirus (2008), http://www.clamav.net/
33. University of Michigan. University of Michigan — ITS — Safe Computing — IT Security
Services Ofﬁce (April 2010), http://safecomputing.umich.edu/about/
34. Vallentin, M.: VAST: Network Visibility Across Space and Time. Master’s thesis, Technische
Universitat Munchen (January 2009)