# OCR Output
## Page 1
Broadview
安全技术
大系
Metasploit
渗透测试指南
DavidKennedy,Jim O'Gorman
美
著
Devon Kearns, Mati Aharoni
HDMoore作序
葛建伟王珩孙松柏等译
电子工业出版社
ThePenetrationTester'sGuide
STRY
---
## Page 2
Broadview
博文视点·IT出版旗舰品牌
com.cn
技术凝聚实力·专业创新出版
"The best guide to the Metasploit Framework”
HD Moore，Metasploit项目创始人
Metasploit框架软件使得安全漏洞的挖
8绕过反病毒技术，挫败安全控制措施
掘、利用和共享变得非常快速和便捷。尽管
在Metasploit中集成Nmap、NeXpose
Metasploit目前已经被安全技术人员们广泛
和Nessus进行自动漏洞发现：
普遍使用，但该工具对初学者而言还难以很
使用MeterpreterShell从网络内部发起
快上手掌握。《Metasploit渗透测试指南》
进一步攻击
填补了这一鸿沟，能够教你如何使用
Metasploit实施渗透测试的各个环节，并让
利用Metasploit独立功能程序、第三方
你能够和庞大的Metasploit贡献者社区进行
工具和插件
更好地交互。当你建立起渗透测试的基础之
编写你自己的Meterpreter后渗透攻击
后，你可以学到在Metasploit框架中对应的
模块和脚本。
组件、接口与模块，并进行模拟的渗透攻击。
你将进一步了解到高级的渗透测试技术，包
你还会进一步了解到如何对0day安全漏
括网络侦察与探测、客户端攻击、无线攻击、
洞进行渗透代码开发，编写模糊测试器，将
和针对性的社会工程学攻击。
已有渗透代码移植到Metasploit中，以及如
何来掩踪灭迹。
本书将教你如何进行：
8发现和攻击缺乏维护、错误配置和未打
无论你的目标是加固你自己网络的
补丁的系统
安全性，还是对别人的网络进行渗透测
试，《Metasploit渗透测试指南》都将能够
8进行网络侦察，搜索关于目标系统有价
带领你达到并超越你的目标。
值的情报信息
上架建议：网络安全
ISBN978-7-121-15487-
策划编辑：毕
宁
责任编辑：许
艳
封面设计：侯士卿
本书贴有激光防伪标志，凡没有防伪标志者，属盗版图书
定价：59.00元
---
## Page 3
安全技术
大系
Metasploit:The Penetration Tester's Guide
Metasploit
渗透测试指南
DavidKennedy，JimO'Gorman
[美]
Devon Kearns, Mati Aharoni
著
HD Moore作序
诸葛建伟王珩孙松柏等译
PDG
电子工业出版社
北京·BEIJING
---
## Page 4
内容简介
本书介绍Metasploit-近年来最强大、最流行和最有发展前途的开源渗透测试平台软件，以及基于
Metasploit进行网络渗透测试与安全漏洞研究分析的技术、流程和方法。
本书共有17章，覆盖了渗透测试的情报搜集、威胁建模、漏洞分析、渗透攻击和后渗透攻击各个环节，
并包含了免杀技术、客户端渗透攻击、社会工程学、自动化渗透测试、无线网络攻击等高级技术专题，以及
如何扩展Metasploit情报搜集、渗透攻击与后渗透攻击功能的实践方法，本书一步一个台阶地帮助初学者从
零开始建立起作为渗透测试者的基本技能，也为职业的渗透测试工程师提供一本参考用书。本书获得了
Metasploit开发团队的一致好评，Metasploit项目创始人HDMoore评价本书为：“现今最好的Metasploit框架
软件参考指南”。
本书适合网络与系统安全领域的技术爱好者与学生，以及渗透测试与漏洞分析研究方面的安全从业人员
阅读。
Copyright @ 2011 by David Kennedy, Jim O'Gorman, Devon Kearns, Mati Aharoni. Title of English-language original:
 e          
本书中文简体版专有出版权由NoStarchPress,Inc.授予电子工业出版社，专有出版权受法律保护。
版权所有，侵权必究。
版权贸易合同登记号图字：01-2011-7695
图书在版编目（CIP）数据
（安全技术大系）
书名原文：Metasploit:APenetrationTester'sGuide
ISBN 978-7-121-15487-4
I.①M…ⅡI.①肯.…·②诸……Ⅲl.①计算机网络一安全技术一应用软件，Metasploit一指南
IV.①TP393.08-62
中国版本图书馆CIP数据核字（2011）第259163号
策划编辑：毕宁
PI:EMAIL
责任编辑：许艳
特约编辑：顾慧芳
印刷：北京东光印刷厂
装订：三河市鹏成印业有限公司
出版发行：电子工业出版社
北京市海淀区万寿路173信箱邮编100036
开本：787×9801/16印张：19.5字数：445千字
印次：2012年1月第1次印刷
定价：59.00元
凡所购买电子工业出版社图书有缺损问题，请向购买书店调换。若书店售缺，请与本社发行部联系，联
系及邮购电话：（010）88254888。
质量投诉请发邮件至PI:EMAIL，盗版侵权举报请发邮件至PI:EMAIL。
服务热线：（010）88258888。
---
## Page 5
·译者序·
本书介绍Metasploit—近年来最强大、最流行和最有发展前途的开源渗透测试平台软件，
以及基于Metasploit进行网络渗透测试与安全漏洞研究分析的技术、流程和方法。Metasploit从
区流行软件的五强之列。Metasploit不仅为渗透测试的初学者提供了一款简单易用、功能强大
的软件，对于职业的渗透测试工程师而言更是在他们的“兵器库”中增加了一件神器，此外
社区中的漏洞利用程序往往以Metasploit模块方式进行发布，大量的书籍（如著名的《黑客大
曝光》系列，国内的《Oday安全：软件漏洞分析技术（第2版）》等）也都采用Metasploit作
为案例讲解分析的基本工具。毋庸置疑，Metasploit已经是安全社区一个灿烂的“明星”，成为
一款安全社区各个层次的技术人员都爱不释手的软件。
本书虽不是第一本介绍 Metasploit 软件的书籍（第一本是由 Syngress 在 2007 年出版的
IⅢI
---
## Page 6
Metasploit Toolkit forPenetrationTesting,Exploit Development,and VulnerabilityResearch，但内容
组织很差，大部分内容直接照搬一些公开的Metasploit文档，Amazon上都是一星和二星的负面
评价)，却是第一本真正能够全面且深入地展示Metasploit在网络渗透测试和漏洞研究方面强大
能力的指南书籍。一方面Metasploit在2007年之后的v3.0中重新设计并用Ruby语言完全重写，
进一步提升了它作为网络渗透测试和漏洞研究框架平台性软件的功能与号召力；另一方面，来
自著名黑客团队OffensiveSecurity的本书作者们拥有丰富的网络渗透测试、安全漏洞研究与渗
透软件开发的实践经验，他们对网络渗透攻击的基本理论、实施流程，以及Metasploit 软件和
相关工具的使用与开发都非常熟悉和了解，在这本书中，他们不仅仅对利用Metasploit来实施
网络渗透测试的各个流程环节进行了细致流畅的描述和案例讲解，还结合他们的实际经验展示
了如何在Metasploit平台基础上扩展开发模块，以解决一些实际情况中遇到的渗透测试需求。
因此，本书不仅能够逐步引导网络渗透测试的入门读者了解Metasploit的基本框架，并且结合
Metasploit软件的功能进行案例讲解，从而使读者能够理解和掌握渗透攻击的基本原理、流程方
一步扩展Metasploit完成实际需求的方法指引。正因为如此，本书也获得了Metasploit项目发起
人、著名黑客H.D.Moore的好评，并专门为本书撰写了序言。
在本书正式出版之前，译者团队一清华大学信息与网络安全实验室狩猎女神科研小组就
一直在渗透测试与漏洞分析技术的学习、探索和研究中使用Metasploit框架软件，并于今年5
月份开始规划撰写一本向国内读者全面介绍Metasploit的原创书。然而到6月份我们就关注到
OffensiveSecurity黑客团队创作的Metasploit书籍马上要于7月份出版，而且和我们之前所规划
的原创书目标基本一致，同时我们对OffensiveSecurity黑客团队之前维护的“Metasploit揭秘”
在线教程质量非常认可，因此对他们出版Metasploit书籍的质量与市场销售前景非常看好，所
以选择将此书推荐给电子工业出版社进行引进翻译，电子工业出版社也很顺利地与外方出版社
们的预期，在7月份本书出版后的相当长一段时间内，都占据了Amazon“安全与加密”类技
术书籍的销量冠军宝座，直到让位于8月份出版的凯文·米特尼克自传。（
成的一章刚刚经过了试读，可能它里面的内容就已经过时了”。为了尽快让国内读者阅读到这本
“新鲜出炉”极具影响力的Metasploit参考指南，译者团队在接受出版社的翻译任务之后，就“马
不停蹄”地开始了翻译工作，由于我们对Metasploit有较多的了解与实践经验，书籍专业内容
IV
---
## Page 7
方面并没有给我们带来太多障碍，并且正值学校暑假，因此译者团队投入了充分的时间来保障
翻译质量，在书籍翻译所要达到的“信、达、雅”目标中，我们自信能够基本达到前两个目标：
对于“信”，我们在分配翻译任务时考虑了每位译者的技术优势和关注点，来保证对翻译内容的
技术掌控，从而能够忠实地描述出原书作者期望传递给读者的技术知识。在翻译过程中，对于
不太确认的一些疑问点，我们对Metasploit软件进行了实验验证，并将发现的儿个原作者由于
疏忽而引入的错误通过出版社提交给原作者进行勘误；对于“达”，我们在翻译之前对全书出现
的技术词汇进行了整理与翻译对照，统一全书对关键技术词汇的翻译，并在初译结束之后，由
诸葛建伟对全书内容进行语句修改、润色与审校，完成修改之后的初稿又由各自负责的译者进
行试读、修改与格式调整，最后由诸葛建伟与电子社编辑进行全书通读、审校与文字修改，通
过认真负责的翻译与审校，应能保证最终译稿的达意。而对于翻译的最高境界“雅”，作为具有
很强时效性需求的技术类书籍，译者团队在权衡之后，还是选择更加注重在确保前两项翻译质
有所欠缺，敬请读者谅解。
本书的读者群主要是网络与系统安全领域的技术爱好者与学生，渗透测试与漏洞分析研究
方面的安全从业人员，由于Metasploit在国外安全社区中已经成为事实上的渗透测试与漏洞分
析平台，相信国内也会有很多对此书感兴趣的读者。在本书翻译过程中，译者发现国内安全社
区对本书非常关注，并对中文版的尽早问世给予了很高的期望，也有两位热心人士计划自愿进
行翻译，并分享给社区。然而由于本书是具有版权的发行作品，因此译者善意提醒了他们可能
校阶段，所以他们非常配合地放弃了重复翻译的想法。而这次小风波也反映了国内安全社区对
本书的期待，也促使译者团队尽快完成书稿的翻译与审校，为国内读者献上一本具有良好翻译
质量的Metasploit经典作品。
客观而言，本书也还存在着一些不足之处，比如没有包含目前非常热门的Web应用渗透攻
击测试与漏洞分析内容，渗透技术方面没有紧跟发展潮流（如VoIP、SCADA、移动平台等热
点攻击技术），没有引入真实的渗透测试案例，以说明Metasploit在实际网络渗透测试中的实用
性等。当然，“瑕不掩瑜”，这并不妨碍本书能够成为一本优秀的网络渗透测试专业书籍，这也
之后，仍有计划推出基于最新发布的Metasploitv4.0，分别面向渗透测试技术人员、漏洞研究与
利用技术人员的Metasploit宝典姊妹篇，敬请国内感兴趣的读者们给予关注。
V
---
## Page 8
本书翻译工作的具体分工是：诸葛建伟译序、前言和第1、2、13、14、15、17章，王珩译
第3、4、5、7、9章，孙松柏译第10、11、16章和附录B，李聪译第6章，陈力波译第8章，
田繁译第12章与附录A。全书内容由诸葛建伟进行全面、仔细的统稿与审校。
持，编辑许艳、顾慧芳在编辑工作方面付出了辛勤的劳动。在此，一并表示深切的谢意。
诸葛建伟
2011年8月于北京清华园
PDC
VI
---
## Page 9
推荐序·
IT是一个非常复杂和混沌的领域，充斥着各种已经半死不活的过时技术和数量更多的新系
需要周期性地对网络中的安全防御机制进行真实环境下的验证与评估，以确定哪些是有效的哪
些是缺失的，而这就是渗透测试所要完成的目标。
渗透测试是一项非常具有挑战性的工作。你拿着客户付的钱，却像犯罪者那样去思考，使
用你所掌握的各种“游击”战术，在一个高度复杂的防御网络中找出最为薄弱的环节，来实施
致命一击。在渗透测试中，你能够发现的事情可能是既让你的雇主惊奇，又让他烦恼：从他的
服务器可以被攻陷并架设色情网站，到公司业务可以被实施大规模的欺诈与犯罪行为。
渗透测试过程需要绕过目标组织的安全防御阵线，探测出系统中存在的弱点。一次成功的
渗透测试可能获取到一些敏感数据，而这通常是安全体系结构审查或漏洞评估所无法找出的，
典型的发现包括共享口令、非法外联的网络，以及一些被发掘曝光的隐私信息。由马虎草率的
XV
---
## Page 10
系统管理员和匆匆赶工完成的系统部署会造成各种各样的安全问题，经常会对一个组织造成严
重的安全威胁，然而对应的解决方案与计划措施可能还积压在系统管理员冗长的TO-DO列表
中。渗透测试可以将这些被忽略的问题及时揭示出来，让目标组织更加清晰地了解到在防御一
次真正的入侵时哪些问题更需要被立即解决。
渗透测试者会接触到一个公司中最敏感的资源，他们也会访问到公司中最关键的区域，而
如果有人针对这些资源和区域进行一些邪恶的攻击行为，那将给这个公司带来极其严重的负面
后果。仅仅一个神秘出现的数据包就可能导致整个工厂停工，从而造成每小时数百万美元的损
失；被作为攻击跳板时没有察觉并向有关部门进行通报，也可能导致最后遭遇到警方令人不自
在且难堪的问询。医疗系统是一个甚至连非常有经验的渗透测试师都不太乐意进行测试的领域，
扫描。最为关键的系统经常也是最为脆弱的，没有儿个系统管理员愿意关闭一台核心数据库服
务器来安装安全补丁从而承担业务中断的风险。
在利用潜在攻击路径和造成损害的风险中进行权衡是所有渗透测试师都必须掌握的技能，
这个过程不仅仅依赖于对渗透工具和技术的了解，也取决于对目标组织业务流程的深入理解，
以及对其中最脆弱环节的定位能力。
在本书中，你将从四位安全专家的视角来认识渗透测试，而他们拥有不同的背景与技术专
长，其中有在企业安全架构方面拥有丰富经验的安全专家，也有熟知安全漏洞挖掘和渗透代码
开发地下经济链的资深黑客。在市面上已经有一些关于渗透测试与安全评估技术的书籍，也有
一些完全聚焦于某种工具的实践参考书。而这本书尝试在这两者之间取得平衡，既覆盖了一些
基础的工具和技术，同时又展示了如何实施一次渗透测试的方法与经验。有经验的渗透测试者
不仅仅能够看到关于如何入门的参考指南，也可以了解到哪些技术步骤是关键的、为什么重要，
以及在整个渗透测试流程中的位置。
本书是专注于Metasploit渗透测试框架软件的专题指南。Metasploit开源平台提供了一个包
含大量通用可靠并且经常更新的渗透攻击代码库，同时也为编写新的渗透工具及自动化渗透测
试过程提供了一个完整的研究与开发环境。本书还介绍了MetasploitExpress和MetasploitPro
-一Metasploit框架中商业化的两个同胞姐妹，她们为如何进行一次自动化的大规模渗透测试提