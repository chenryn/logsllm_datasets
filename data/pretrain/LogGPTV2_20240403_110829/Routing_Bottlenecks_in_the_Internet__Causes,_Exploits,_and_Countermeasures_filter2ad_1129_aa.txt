title:Routing Bottlenecks in the Internet: Causes, Exploits, and Countermeasures
author:Min Suk Kang and
Virgil D. Gligor
Routing Bottlenecks in the Internet – Causes,  
Exploits, and Countermeasures 
Min Suk Kang and Virgil D. Gligor 
May 15, 2014 
CMU-CyLab-14-010 
CyLab 
Carnegie Mellon University 
Pittsburgh, PA 15213 
Routing Bottlenecks in the Internet – Causes, Exploits, and
Countermeasures
Min Suk Kang
ECE and CyLab
Carnegie Mellon University
Pittsburgh, PA USA
PI:EMAIL
Virgil D. Gligor
ECE and CyLab
Carnegie Mellon University
Pittsburgh, PA USA
PI:EMAIL
ABSTRACT
How pervasive is the vulnerability to link-(cid:13)ooding attacks
that degrade connectivity of thousands of Internet hosts?
Are some network topologies and geographic regions more
vulnerable than others? Do practical countermeasures ex-
ist? To answer these questions, we introduce the notion
of the routing bottlenecks and show that it is a fundamen-
tal property of Internet design; i.e., it is a consequence of
route-cost minimizations. We illustrate the pervasiveness of
routing bottlenecks in an experiment comprising 15 coun-
tries and 15 cities distributed around the world, and mea-
sure their susceptibility to link-(cid:13)ooding attacks. We present
the key characteristics of routing bottlenecks, including size,
link type, and distance from host destinations, and suggest
speci(cid:12)c structural and operational countermeasures to link-
(cid:13)ooding attacks. These countermeasures can be deployed
by network operators without major Internet redesign.
1.
INTRODUCTION
Recent experiments [24] and real-life attacks [7] have of-
fered concrete evidence that link-(cid:13)ooding attacks can severely
degrade, and even cut o(cid:11), connectivity of large sets of ad-
versary selected hosts in the Internet for uncomfortably long
periods of time; e.g., hours. However, neither the root cause
nor pervasiveness of this vulnerablity has been analyzed to
date. Furthermore, it is unknown whether certain network
structures and geographic regions are more vulnerable to
these attacks than others.
In this paper we address this
gap in our knowledge about these attacks by (1) de(cid:12)ning
the notion of the routing bottlenecks and its role in enabling
link-(cid:13)ooding attacks at scale; (2) (cid:12)nding bottlenecks in 15
countries and 15 cities distributed around the world to il-
lustrate their pervasiveness; and (3) measuring bottleneck
parameters (e.g., size, link types, and distance to adversary-
selected hosts) to understand the magnitude of attack vul-
nerability. We also present both structural and operational
countermeasures that mitigate link-(cid:13)ooding attacks.
In principle, route diversity could enhance Internet re-
silience to link-(cid:13)ooding attacks against large sets of hosts
(e.g., 1,000 hosts) since it could force an adversary to scale
attack tra(cid:14)c to unattainable levels to (cid:13)ood all possible routes.
In practice, however, the mere existence of many routes be-
tween tra(cid:14)c sources and selected sets of destination hosts
cannot guarantee resilience whenever the vast majority of
these routes are distributed across very few links, which
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
Copyright 20XX ACM X-XXXXX-XX-X/XX/XX ...$15.00.
1
Figure 1: Normalized link-occurrence distribution
in routes from S = 250 PlanetLab nodes to D =
1,000 randomly selected servers in Country15.
could e(cid:11)ectively become a routing bottleneck. To de(cid:12)ne
routing bottlenecks more precisely, let S denote a set of
(source) IP addresses of hosts that originate tra(cid:14)c to a set
of IP destination addresses, denoted by D. S represents any
set of hosts distributed across the Internet. In contrast, D
represents a set of hosts of a speci(cid:12)ed Internet region (e.g., a
country or a city), which are chosen at random and indepen-
dently of S. A routing bottleneck on the routes from S to D
is a small set B of IP (layer-3) links such that B’s links are
found in a majority of routes whereas the remaining links
jBj is often over an order of
are found in very few routes.
magnitude smaller than both jSj and jDj.
If all links are
ranked by their frequency of occurrence in the routes be-
tween S and D, the bottleneck links, B, have a very high
rank whereas the vast majority of the remaining links have
very low rank. The sharper the skew in the frequency of
link occurrence in these routes, the narrower the bottleneck.
Routes may have more than one bottleneck of size jBj.
An Example. To illustrate a real routing bottleneck, we
represent route sources S by 250 PlanetLab nodes [39] dis-
tributed across 164 cities in 39 countries. For the route desti-
nations, D, we select 1,000 web servers at random from a list
of publicly-accessible servers obtained using the ‘computer
search engine’ called Shodan (http://www.shodanhq.com) in
each of the selected Internet region; i.e., in Country15 of the
(cid:12)fteen-country list fCountry1, (cid:1)(cid:1)(cid:1) , Country15g. This list is
a permutation of the alphabetically ordered list of countries
fBrazil, Egypt, France, Germany, India, Iran, Israel, Italy,
Japan, Romania, Russia, South Korea, Taiwan, Turkey, and
United Kingdomg.1 We trace the routes between S and
D for Country15, collect over 1:9 (cid:2) 106 link samples from
those routes, and plot their link-occurrence distribution,2 as
1The permutation is a country ordering by link-occurrence
skew. Finding it and de-anonymizing the country list would
require repeating the measurements illustrated in Fig. 2.
2When analyzing the occurrence of the links, we remove
50500100000.020.040.060.080.10.12Rank of Links← high rank                                              low rank →135000.020.040.060.080.10.12shown in Fig. 1. This (cid:12)gure clearly shows a very skewed
link-occurrence distribution, which implies the existence of
a narrow routing bottleneck; i.e., jBj = 13 links are found
in over 72% of the routes; viz., Fig. 11.
In this paper we argue that the pervasive occurrence of
routing bottlenecks is a fundamental property of the Inter-
net design. That is, power-law distributions that charac-
terize the frequency of link occurrence in routes are a con-
sequence of employing route-cost minimization, which is a
very desirable feature of Internet routing3; viz., discussion
of BGP and OSPF routing in Sections 2 and 5. Fortunately,
routing bottlenecks do not lead to tra(cid:14)c degradation dur-
ing ordinary Internet use, because the capacity of bottleneck
links is usually provisioned adequately for normal mode of
operation.
Problem. Unfortunately, however, bottleneck links pro-
vide a very attractive target to an adversary whose goal is
to (cid:13)ood few links and severely degrade or cut o(cid:11) connec-
tivity of targeted servers, D, in various cities or countries
around the world. For example, an adversary could eas-
ily launch a tra(cid:14)c ampli(cid:12)cation attack using NTP monlists
(400 Gbps) [35] and DNS recursors (120 Gbps) [7] to dis-
tribute an aggregate of 520 Gbps tra(cid:14)c across the 13-link
bottleneck of Fig. 1. Such an attack would easily (cid:13)ood these
links, even if each of them is provisioned with a maximum
of 40 Gbps capacity, severely degrading the connectivity of
the 1,000 servers of Country15 from the Internet; viz., Fig.
11. More insidious attacks, such as Cross(cid:12)re [24], can (cid:13)ood
bottleneck links with tra(cid:14)c that is indistinguishable from
legitimate; viz., Section 6 - Related Work.
To counter link-(cid:13)ooding attacks that exploit routing bot-
tlenecks, we (cid:12)rst de(cid:12)ne the parameters that characterize
these bottlenecks; e.g., size, link types, and average distance
of bottleneck links from the targeted servers, D: Then we
de(cid:12)ne a connectivity-degradation metric to provide a quanti-
tative view of the risk exposure faced by these servers. The
bottleneck parameters and metric are particularly impor-
tant for applications in the targeted country or city where
Internet-facing servers need stable connectivity; e.g., indus-
trial control systems [9], (cid:12)nancial [45], defense and other
government services. For these applications, routing bot-
tlenecks pose unexpected vulnerabilities, since diversity of
IP-layer connections, which is often incorrectly believed to
be su(cid:14)cient for route diversity, only assures necessary condi-
tions for route diversity but does not guarantee it. We illus-
trate the usefulness of our connectivity-degradation metric
in assessing the vulnerabilities posed by real life routing bot-
tlenecks found in (cid:12)fteen countries and (cid:12)fteen di(cid:11)erent cities
around the world; viz., Section 2 and Appendix A.
Analysis of routing bottleneck exploits explains why in-
tuitive but naive countermeasures will not work in prac-
tice; e.g., reactive re-routing to disperse the tra(cid:14)c (cid:13)ood-
ing bottleneck links across multiple local links; (cid:13)ow (cid:12)lter-
ing at routers based on tra(cid:14)c intensity; reliance on backup
links on exposed routes. More importantly, our analysis
any redundant links each of whose congestion causes severe
disconnection of others (e.g., links used in series).
3Power-law distributions arise naturally from di(cid:11)erent types
of cost minimizations in many other (cid:12)elds. For example,
research in linguistics clearly shows that power laws de(cid:12)ning
the frequency of word occurrences in random English text
arise from the minimization of human-communication cost
[30, 51].
provides a precise route-diversity metric, which is based on
autonomous-system (AS) path diversity, and illustrates the
utility of this metric as a proxy for the bottleneck avoid-
ance in the Internet. Finally, our analysis suggests opera-
tional countermeasures against link-(cid:13)ooding attacks, includ-
ing inter- and intra-domain load balancing, and automatic
intra-domain tra(cid:14)c engineering.
Contributions. In summary, we make the following con-
tributions:
(cid:15) We explain the root causes and the characteristics of
routing bottlenecks in the Internet, and illustrate their
pervasiveness with examples found in 15 countries and
15 cities around the world.
(cid:15) We present a precise quantitative measure of connectiv-
ity degradation to illustrate how routing bottlenecks en-
able an adversary to scale link-(cid:13)ooding attacks without
much additional attack tra(cid:14)c.
(cid:15) We present several classes of countermeasures against
attacks that exploit routing bottlenecks, including both
structural and operational countermeasures.
2. ROUTING BOTTLENECKS
2.1 Link-occurrence measurements
To determine the existence of routing bottlenecks, we mea-
sure the link-occurrence distribution in a large number of the
routes towards a selected destination region. This requires
that we perform traceroute to obtain a series of link samples
(i.e., IP addresses of layer-3 links) on a particular route from
a source host to a destination host in a selected Internet re-
gion. From the collected link samples, we construct the link
occurrence distribution by counting the number of samples
for each link. In the calculation of link occurrence, we re-
move the redundant links, which share majority of serving
routes in common, from the dataset (viz., Section 4.1 for spe-
ci(cid:12)c algorithms). In these measurements, for each country
or city, we traced 250,000 routes by using traceroute from
250 source hosts (i.e., 250 PlanetLab nodes [39]) to 1,000
randomly selected web servers in each of 15 countries.
Traceroute is a commonly used but frequently misused
network monitoring tool [43]. We avoid common potential
pitfalls (e.g., alias resolution, load-balanced routes, accuracy
of returned IP, hidden links in MPLS tunnels and etc.) when
we analyze the output of traceroute. For detailed discussion,
viz., Section 3.3. We perform multiple traceroutes for the
same source-destination host pair to determine the persis-
tent links; i.e., links that always show up in the multiple
traceroutes. We collect only the samples of persistent links
because non-persistent links do not lead to reliable exploita-
tion of routing bottleneck. We have found extremely skewed
link-occurrence distribution for the 1,000 randomly selected
hosts in each of the 15 countries and this strongly indicates
the existence of routing bottlenecks in all the countries in
which we performed our measurements. We found similarly
skewed distributions when we chose 1,000 random hosts in
each of the 15 geographically-distributed cities around the
world; viz., Appendix A.
2.2 Power-law in link occurrence distributions
The analysis of link-occurrence distributions helps us un-
derstand both the cause of routing bottlenecks and their
physical characteristics (e.g., size, type, distance from desti-
2
Figure 2: Normalized link occurrence/rank in traced routes to 1,000 randomly selected hosts in 15 countries.
nation hosts) as well as countermeasures against (cid:13)ooding at-
tacks that attempt to exploit them. To illustrate the skew of
link-occurrence distributions, we present our measurements
for 15 countries and cities around the world in Fig. 2 and
Fig. 14 (Appendix A), respectively.
In these (cid:12)gures, we
illustrate the relation between the link occurrence normal-
ized by the total number of measured routes and the rank
of links in log-log scale, for 1,000 servers in each country
and city. The normalized occurrence of a link is the por-
tion of routes between S and D carried by the link; e.g.,