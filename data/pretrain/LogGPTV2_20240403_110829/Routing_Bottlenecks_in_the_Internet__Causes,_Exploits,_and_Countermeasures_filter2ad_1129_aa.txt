# Routing Bottlenecks in the Internet: Causes, Exploits, and Countermeasures

**Authors:** Min Suk Kang and Virgil D. Gligor

**Date:** May 15, 2014

**Report Number:** CMU-CyLab-14-010

**Institution:** CyLab, Carnegie Mellon University, Pittsburgh, PA 15213, USA

## Abstract

This paper investigates the vulnerability of the Internet to link-flooding attacks that can degrade or sever connectivity for thousands of hosts. We introduce the concept of routing bottlenecks, a fundamental property of Internet design resulting from route-cost minimization. Our experiments, conducted across 15 countries and 15 cities worldwide, demonstrate the pervasiveness of these bottlenecks and their susceptibility to link-flooding attacks. We identify key characteristics of routing bottlenecks, such as size, link type, and distance from destination hosts, and propose specific structural and operational countermeasures. These countermeasures can be implemented by network operators without requiring major changes to the Internet's architecture.

## 1. Introduction

Recent studies [24] and real-world incidents [7] have shown that link-flooding attacks can severely disrupt connectivity for large sets of targeted hosts for extended periods, sometimes lasting hours. However, the root causes and the extent of this vulnerability remain unexplored. It is also unclear whether certain network topologies or geographic regions are more vulnerable than others.

In this paper, we address these gaps by:
1. Defining the concept of routing bottlenecks and their role in enabling large-scale link-flooding attacks.
2. Identifying and analyzing bottlenecks in 15 countries and 15 cities to illustrate their prevalence.
3. Measuring bottleneck parameters (e.g., size, link types, and distance to targeted hosts) to assess the magnitude of attack vulnerability.
4. Proposing both structural and operational countermeasures to mitigate link-flooding attacks.

Route diversity could theoretically enhance the Internet's resilience against link-flooding attacks on large sets of hosts (e.g., 1,000 hosts) by forcing an attacker to scale up attack traffic to unattainable levels. In practice, however, the mere existence of multiple routes does not guarantee resilience if most of these routes are concentrated on a few links, creating a routing bottleneck.

### Definition of Routing Bottlenecks

Let \( S \) denote a set of source IP addresses originating traffic to a set of destination IP addresses \( D \). \( S \) represents any set of hosts distributed across the Internet, while \( D \) represents a set of hosts in a specified region (e.g., a country or city), chosen independently of \( S \). A routing bottleneck on the routes from \( S \) to \( D \) is a small set \( B \) of IP (layer-3) links such that the majority of routes pass through these links, while the remaining links are used infrequently. The size of \( B \) is typically much smaller than the sizes of \( S \) and \( D \).

If all links are ranked by their frequency of occurrence in the routes between \( S \) and \( D \), the bottleneck links \( B \) have a very high rank, while the vast majority of other links have a very low rank. The sharper the skew in the frequency of link occurrence, the narrower the bottleneck. Routes may have more than one bottleneck of size \( |B| \).

### Example

To illustrate a real routing bottleneck, we use 250 PlanetLab nodes [39] distributed across 164 cities in 39 countries as the route sources \( S \). For the destinations \( D \), we select 1,000 web servers at random from a list of publicly accessible servers in each of 15 countries. We trace the routes between \( S \) and \( D \), collect over 1.9 million link samples, and plot their link-occurrence distribution, as shown in Figure 1. This figure clearly shows a highly skewed link-occurrence distribution, indicating a narrow routing bottleneck where 13 links are found in over 72% of the routes.

## 2. Routing Bottlenecks

### 2.1 Link-Occurrence Measurements

To determine the existence of routing bottlenecks, we measure the link-occurrence distribution in a large number of routes towards a selected destination region. This involves performing traceroute to obtain a series of link samples (i.e., IP addresses of layer-3 links) on a particular route from a source host to a destination host. From the collected link samples, we construct the link-occurrence distribution by counting the number of samples for each link. Redundant links, which share the majority of serving routes in common, are removed from the dataset (see Section 4.1 for specific algorithms).

For each country or city, we traced 250,000 routes using 250 source hosts (PlanetLab nodes [39]) to 1,000 randomly selected web servers. We avoid common pitfalls in traceroute analysis (e.g., alias resolution, load-balanced routes, accuracy of returned IP, hidden links in MPLS tunnels) and perform multiple traceroutes for the same source-destination pair to determine persistent links. We found extremely skewed link-occurrence distributions for the 1,000 randomly selected hosts in each of the 15 countries, strongly indicating the presence of routing bottlenecks. Similar results were observed for 15 geographically distributed cities (see Appendix A).

### 2.2 Power-Law in Link Occurrence Distributions

The analysis of link-occurrence distributions helps us understand the causes and physical characteristics of routing bottlenecks (e.g., size, type, distance from destination hosts) and suggests countermeasures against flooding attacks. To illustrate the skew of link-occurrence distributions, we present our measurements for 15 countries and cities in Figures 2 and 14 (Appendix A). These figures show the normalized link occurrence (the portion of routes between \( S \) and \( D \) carried by the link) and the rank of links in log-log scale.

## 3. Contributions

In summary, our contributions include:
- Explaining the root causes and characteristics of routing bottlenecks in the Internet, illustrated with examples from 15 countries and 15 cities.
- Presenting a precise quantitative measure of connectivity degradation to show how routing bottlenecks enable adversaries to scale link-flooding attacks without much additional attack traffic.
- Proposing several classes of countermeasures against attacks that exploit routing bottlenecks, including both structural and operational measures.

## 4. Conclusion

Routing bottlenecks are a fundamental property of the Internet, arising from route-cost minimization. While they do not cause issues during normal operation, they provide a target for link-flooding attacks. By understanding and measuring these bottlenecks, we can develop effective countermeasures to enhance the Internet's resilience against such attacks.