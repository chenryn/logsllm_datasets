-
Range
[228, 2309]
[193, 1 927]
[9, 238]
[26, 181]
[25, 129]
Smallest connected component
Number of nodes
2-node components
2 nodes
30.0
5.7 (combined)
35.9
[2, 2]
[9, 56]
Largest connected component
Size of largest connected component
Redirecting results
Trafﬁc brokers
Pharmacies
390 nodes
379.6 (URLs)
5.8 (FQDNs)
4.6 (FQDNs)
39.1
38.1
0.6
0.4
[72, 1 091]
[66, 1067]
[0, 16]
[1, 31]
Table 6: Connected components in the graph describing daily
observed redirection chains.
ﬁculties search-redirection attacks experienced in 2013, and evi-
denced in Figure 2.
Network characteristics. Table 6 provides an overview of the
graphs consisting of all redirection chains on any given day. We
observe a very strong network heterogeneity, with large connected
components that appear to dominate the graph. In other words, the
illicit advertising business is dominated by a few large players. The
same observation was reported in earlier work [15, 21].
It is worth examining whether this concentration in advertisers
changes over time. Figure 10 provides some elements of answer.
We plot, as a function of time the maximum (top) and average (bot-
tom) degree of trafﬁc brokers and destinations. The degree is de-
ﬁned here as the sum of the number of links going in (in-degree)
and out (out-degree) of a given “node” (trafﬁc broker or destina-
tion). Each datapoint represents a 7-day moving average. The verti-
cal lines correspond to the events introduced in Section 5. The size
of the largest trafﬁc brokers varies drastically over time—the spikes
observed in late 2012 seem to have been caused by particularly vir-
ulent campaigns (where a few brokers received a large amount of
trafﬁc from many infected sites) that took time to be fended off by
search engines. Since early 2013, the size of the largest brokers
has decreased a fair bit, reﬂecting the trend that search-redirection
might be less popular than it was in 2012.
Shared infrastructure. We complete our analysis of the redirec-
tion network by looking at the trafﬁc brokers used for different
(non-pharmaceutical) types of trades, and the extent to which they
overlap with the pharmaceutical trade. Table 7 gives an overview of
these results over the time interval 10/31/2011–09/16/2013. Over a
long enough time interval, there is modest overlap between the vari-
ous types of products. Source infections are rarely used for multiple
campaigns; trafﬁc broker domains tend to show a bit more over-
lap, presumably due to the fact that miscreants take advantage of
lax veriﬁcation policies at certain hosting providers. At the FQDN
level, though, both destinations (i.e., shops) and brokers show little
evidence of overlap, which is surprising given the known fact that
certain botnets operate over multiple markets. Even in such cases,
the different business domains appear to be kept separate.
promised websites that initiate the redirections have improved: the
persistence of source infections has steadily fallen from one month
to two weeks. But here too, the attackers have adapted, notably
by simply compromising more websites. Third, we continue to ob-
serve extensive concentration in the funneling of trafﬁc from source
infections to destinations via a small number of central brokers.
A key takeaway from this investigation is that uncoordinated in-
terventions by individual stakeholders – a search engine ranking
algorithm tweak here, a push by some hosting providers to clean
up infected servers there – is not sufﬁcient to disrupt persistent poi-
soning attempts. Examining this problem using Crime Script Anal-
ysis [5], Leontiadis has shown that focusing instead on key points
of concentration and in cooperation across stakeholders is required
to have measurable impact [14]. For instance, coordinated trafﬁc
broker take-downs at the AS level, in conjunction with the demo-
tion or removal of poisoned search results at the search engine level
(e.g., using proactive identiﬁcation techniques [25]), could impact
the economics of search engine poisoning signiﬁcantly, and, hope-
fully, durably.
10. ACKNOWLEDGMENTS
We thank our anonymous reviewers and (the non-anonymous)
Stuart Schechter for feedback on earlier revisions of this manuscript.
This research was partially supported by the National Science Foun-
dation under ITR award CCF-0424422 (TRUST) and SaTC award
CNS-1223762; and by the Department of Homeland Security Sci-
ence and Technology Directorate, Cyber Security Division (DHS
S&T/CSD), the Government of Australia and SPAWAR Systems
Center Paciﬁc via contract number N66001-13-C-0131. This paper
represents the position of the authors and not that of the aforemen-
tioned agencies.
11. REFERENCES
[1] R. Anderson, C. Barton, R. Böhme, R. Clayton, M. van
Eeten, M. Levi, T. Moore, and S. Savage. Measuring the cost
of cybercrime. In Proc. (online) WEIS 2012. Berlin,
Germany, June 2012.
[2] K. Borgolte, C. Kruegel, and G. Vigna. Delta: automatic
identiﬁcation of unknown web-based infection campaigns. In
Proc. ACM CCS 2013, pages 109–120, Berlin, Germany,
November 2013.
[3] T. Catan. Google forks over settlement on Rx ads. The Wall
Street Journal, August 2011. Available online at
http://online.wsj.com/news/articles/
SB10001424053111904787404576528332418595052.
[4] comScore. February 2014 US search engine rankings.
https://www.comscore.com/Insights/Press_
Releases/2014/3/comScore_Releases_
February_2014_U.S._Search_Engine_
Rankings, 2014. Last accessed August 26, 2014.
[5] D. Cornish. The procedural analysis of offending and its
relevance for situational prevention. Crime prevention
studies, 3:151–196, 1994.
[6] R. Dingledine, N. Mathewson, and P. Syverson. Tor: The
second-generation onion router. In Proc. USENIX Security
2004. San Diego, CA, August 2004.
[7] Z. Gyöngyi and H. Garcia-Molina. Link spam alliances. In
Proc. ACM VLDB 2005, pages 517–528, Trondheim,
Norway, August 2005.
[8] AOL Inc. Open Directory project.
http://www.dmoz.org/.
Figure 10: Maximum and average degree of trafﬁc brokers and
destinations over time.
Type and granularity of node Drugs Other mkts. combined
Source infection FQDNs
Trafﬁc broker Domains
Trafﬁc broker FQDNs
Destination domains
Destination FQDNs
14 770
382
735
2 232
2 249
3 975
202
297
1 388
1 388
Shared #
Jaccard index (%)
167
34
33
120
119
0.9
6.2
3.3
3.4
3.4
Table 7: Overlap in the criminal infrastructures. The fourth
column is computed as the Jaccard index between the two sets.
8. LIMITATIONS
In addition to the numerous difﬁculties one faces when dealing
with such long-range datasets, this study presents two major limita-
tions. First, we have only looked at Google results. We justify this
by the market share dominance of Google, at least in the US [4],
but point out that other studies [2, 22] have shown other search en-
gines are not immune to search-poisoning. Second, we have mostly
looked at search results based on their presence or not in the result
corpora. What is more important, however, is their position in the
results. While top links are frequently clicked on, it has been shown
that links past the tenth result have close to zero probability of be-
ing used [9]. Weighing the results we obtained by click probabil-
ity would probably yield a better insight into which operations are
proﬁtable. We do note, however, that in our previous work we show
that the type of results (e.g., search-redirection attacks vs. health re-
sources) remained fairly consistent regardless of position [15]. Our
brief examination of top-10 results in periods T2 and T3 conﬁrms
that active redirects and direct links to unlicensed pharmacies ap-
pear frequently among top results, and are thus expected to drive
signiﬁcant amounts of trafﬁc.
9. CONCLUSIONS
Search engines are invaluable tools that deliver enormous value
to consumers by referring them to the most relevant resources quickly
and effortlessly. Search-engine poisoning threatens to undermine
this value proposition, and could conceivably lead users to reduce
their online activities [1].
We have presented the results of a longitudinal, large-scale em-
pirical investigation into search-engine poisoning. Our long-term
view has enabled us to draw several new and important insights.
First, despite the best efforts of search engines to demote low-
quality content and browsers to protect the privacy of search queries,
miscreants have readily adapted. In fact, the share of results taken
over by search-redirection attacks doubled from late 2010 to late
2012, before falling slightly. Second, efforts to clean up the com-
201220130200400600800Maximum degree of traffic brokers and destinations over timeMaximum (in+out) degreeG2G3C2B1B2B3traffic brokersdestinations201220130510152025Average degree of traffic brokers and destinations over timeAverage (in+out) degreeG2G3C2B1B2B3[9] T. Joachims, L. Granka, B. Pan, H. Hembrooke, and G. Gay.
Accurately interpreting clickthrough data as implicit
feedback. In Proc. ACM SIGIR ’05, pages 154–161,
Salvador, Brazil, 2005.
[10] J. John, F. Yu, Y. Xie, M. Abadi, and A. Krishnamurthy.
deSEO: Combating search-result poisoning. In Proc.
USENIX Security 2011, San Francisco, CA, August 2011.
[11] C. Kanich, C. Kreibich, K. Levchenko, B. Enright,
G. Voelker, V. Paxson, and S. Savage. Spamalytics: An
empirical analysis of spam marketing conversion. In Proc.
ACM CCS 2008, Alexandria, VA, October 2008.
[12] E. Kao. Making search more secure, October 2011.
http://googleblog.blogspot.com/2011/10/
making-search-more-secure.html.
[13] E. Kaplan and P. Meier. Nonparametric estimation from
incomplete observations. Journal of the American Statistical
Association, 53:457–481, 1958.
[14] N. Leontiadis. Structuring disincentives for online criminals.
PhD thesis, Carnegie Mellon University, 2014.
[15] N. Leontiadis, T. Moore, and N. Christin. Measuring and
analyzing search-redirection attacks in the illicit online
prescription drug trade. In Proc. USENIX Security 2011, San
Francisco, CA, August 2011.
[16] N. Leontiadis, T. Moore, and N. Christin. Pick your poison:
Pricing and inventories at unlicensed online pharmacies. In
Proc. ACM EC, pages 621–638, Philadelphia, PA, June 2013.
[17] K. Levchenko, N. Chachra, B. Enright, M. Felegyhazi,
C. Grier, T. Halvorson, C. Kanich, C. Kreibich, H. Liu,
D. McCoy, A. Pitsillidis, N. Weaver, V. Paxson, G. Voelker,
and S. Savage. Click trajectories: End-to-end analysis of the
spam value chain. In Proc. 2011 IEEE Symposium on
Security and Privacy, Oakland, CA, May 2011.
[18] Z. Li, S. Alrwais, X. Wang, and E. Alowaisheq. Hunting the
red fox online: Understanding and detection of mass
redirect-script injections. In Proc. 2014 IEEE Symposium on
Security and Privacy, San Jose, CA, May 2014.
[19] Legitscript LLC. Legitscript pharmacy validation.
http://www.legitscript.com/pharmacies/.
[20] L. Lu, R. Perdisci, and W. Lee. SURF: Detecting and
measuring search poisoning. In Proc. ACM CCS 2011,
Chicago, IL, October 2011.
[21] D. McCoy, A. Pitsillidis, G. Jordan, N. Weaver, C. Kreibich,
B. Krebs, G. Voelker, S. Savage, and K. Levchenko.
Pharmaleaks: Understanding the business of online
pharmaceutical afﬁliate programs. In Proc. USENIX Security
2012, Bellevue, WA, August 2012.
[22] T. Moore, N. Leontiadis, and N. Christin. Fashion crimes:
Trending-term exploitation on the web. In Proc. ACM CCS
2011, Chicago, IL, October 2011.
[23] J. Mueller. Upcoming changes in Google’s HTTP referrer,
March 2012. http://googlewebmastercentral.
blogspot.com/2012/03/
upcoming-changes-in-googles-http.html.
[24] A. Singhal and M. Cutts. Finding more high-quality sites in
search, February 2011.
http://googleblog.blogspot.com/2011/02/
finding-more-high-quality-sites-in.html.
[25] K. Soska and N. Christin. Automatically detecting
vulnerable websites before they turn malicious. In Proc.
USENIX Security 2014, San Diego, CA, August 2014.
[26] The Internet Archive. Wayback machine.
https://archive.org/web/.
[27] VirusTotal. Free Online Virus, Malware and URL Scanner.
https://www.virustotal.com/.
[28] D. Wang, M. Der, M. Karami, L. Saul, D. McCoy, S. Savage,
and G. Voelker. Search + seizure: The effectiveness of
interventions on seo campaigns. In Proc. ACM IMC’14,
Vancouver, BC, Canada, November 2014.
[29] D. Wang, G. Voelker, and S. Savage. Juice: A longitudinal
study of an SEO botnet. In Proc. NDSS’13, San Diego, CA,
February 2013.