如何保证对矩阵式监控的结果持续跟踪、及时整改？
每天生成一份矩阵式监控报表，对存在的问题划分优先级，优先级高的纳入督办整改。在矩阵式监
控实施之前，我们只零星发现一些监控缺失情况，对监控覆盖率还是很有信心的。生成报表后发现问题
隐患还是比较多的，整改任务比较艰巨，花了很多精力和时间把监控这项基础工作做好做全面。通过矩
阵式监控结果也发现资产清单的很多错误情况。
我们将矩阵式监控的日报与日常值班检查的监控界面进行集成，将不合规的项在监控界面上图形化
展示，如图22-2所示。值班人员每天进行检查，并在值班记录中登记详细情况。第二天安全事件晨会回顾
值班记录，团队负责人督导不合规项的整改，如果没有及时整改，以后每天都会在值班可视化监控平台
中亮红。通过持续回顾和跟踪，确保整改到位。
图22-2 矩阵式监控结果可视化展现
图22-2中，绿色表示该管理员负责的系统或设备矩阵式监控检查全部合格，红色表示不合格，数字表
示不合格项数量。
22.2.3 收益和体会
通过矩阵式监控的实施和长期运营，目前除了一些PC终端偶尔出现服务停止等不稳定因素外，监控
覆盖率接近100%，监控出现缺失或监控服务出现异常，一个工作日之内便可以发现，并迅速修复。资产
清单准确性也大大提升，不再单纯依靠人员的责任心和运气，而是通过资产缺失的自动发现机制，来督
促大家及时更新资产。目前这套矩阵式监控机制运转良好，提升了安全监控的覆盖率和有效性。
矩阵式监控的方法具有普遍适用性，可用性监控等都可以参考借鉴，技术实现上来说没有任何问
题。发现问题可视化和后续持续改进跟踪的机制，不仅确保了安全运营有效性和可持续性，也适用于绝
大多数运营领域。
矩阵式监控解决的问题，本质上属于人因误操作领域，有关如何更专业地避免人为因素导致的生产
故障，请了解“核电厂人因管理”，国内该领域研究走在前列的是某大学的人因研究所，某些金融机构已
经在向该领域最专业行业跨界学习。
有两点体会如下：
·再优秀的安全技术也要尽可能做到“傻瓜化”，要像电视机一样，80岁老人会开，2岁小朋友也会开。
安全产品或安全措施，如果动不动有强前置条件，比如需要能看懂告警的安全人员才能维护，那这个安
全产品或安全措施没法持续安全运营，还不如不要。企业安全建设中，技术往往不是最头疼或首要考虑
的问题（往往也不是问题），首要考虑的是能否有效发挥功能。再有效的监测技术，如果没有坚持安全
运营，就像是马奇诺防线，好看不顶用。接地气的“笨办法”往往最有效。安全负责人对安全产品和厂商
少一些抱怨，多一些坚持。
·矩阵式监控思路实现中，最终展现在一线人员前的只有几个小人图标（红色或绿色），这是复杂设
计后的简单展现，让不具备太强安全能力的人员也能成为对抗攻击者的力量，这是安全工程化的能力，
安全工作应尽可能地展现简单之美。
22.3 小结
本章介绍了安全资产管理面临的问题及管理方案，安全资产管理对于缩小攻击面，防范事前威胁以
及事中处置，都是投入产出效益较高的安全工作之一，值得精耕细作。
第23章 应急响应
Gartner提出了面向下一代的安全体系框架—自适应安全框架（Adaptive Security Architecture，
ASA），如图23-1所示。该框架从预测、防御、检测、响应四个维度，强调安全防护是一个持续处理的、
循环的过程，细粒度、多角度、持续化地对安全威胁进行实时动态分析，自动适应不断变化的网络和威
胁环境，并不断优化自身的安全防御机制。
图23-1 Gartner自适应安全框架
换而言之，Gartner认为企业的安全问题或漏洞一定会不可避免地被外部发现并被人利用，那我们该
如何更有效地进行应急响应呢？应急响应其实有不少学问。
23.1 概述
关于应急响应，有针对性的国家标准可供参考：
·GB/T 24363-2009《信息安全应急响应计划规范》。
·GB/Z 20985-2007《信息安全事件管理指南》。
·GB/Z 20986-2007《信息安全事件分类分级指南》。
针对金融行业，银监会印发过《银行业重要信息系统突发事件应急管理规范（试行）》《银行、证
券跨行业信息系统突发事件应急处置工作指引》等。
此外，PDCERF模型将应急响应分为准备（Preparation）、检测（Detection）、抑制（Con-
tainment）、根除（Eradication）、恢复（Recovery）、跟踪（Follow-up）六个阶段：
1）准备。在事件未发生时的准备工作，包括策略、计划、规范文档及具体的技术工具和平台。
2）检测。初步判断是什么类型的问题，受影响的系统及严重程度。
3）抑制。限制攻击、破坏所波及的范围，通俗地讲叫“止血”。
4）根除。对事件发生的原因进行分析，彻底解决问题，避免在同一个问题上再次犯错。
5）恢复。把业务恢复至正常水平。
6）跟踪。落实整改措施并监控是否有异常，即安全运营中的持续改进。
有了这些标准、模型或指引，企业需要结合自身实际情况制订自己的应急响应规范，包括事件的分
类分级、组织与职责、处理流程，甚至安全事件分析处理结果模板等。
23.2 事件分类
GB/Z 20986-2007《信息安全事件分类分级指南》根据将信息安全事件的起因、表现、结果等，将信
息安全事件分为恶意程序事件、网络攻击事件、信息破坏事件、信息内容安全事件、设备设施故障、灾
害性事件和其他信息安全事件等7个基本分类，每个基本分类包括若干个子类。
1）恶意程序事件，包括计算机病毒事件、蠕虫事件、特洛伊木马事件、僵尸网络事件、混合攻击程
序事件、网页内嵌恶意代码事件、其他有害程序事件。
2）网络攻击事件，包括拒绝服务器攻击事件、后门攻击事件、漏洞攻击事件、网络扫描窃听事件、
网络钓鱼事件、干扰事件、其他网络攻击事件。
3）信息破坏事件，包括信息篡改事件、信息假冒事件、信息泄露事件、信息窃取事件、信息丢失事
件、其他信息破坏事件。
4）信息内容安全事件，包括违反宪法和法律、行政法规的信息安全事件，针对社会事项进行讨论评
论形成网上敏感的舆论热点，出现一定规模炒作的信息安全事件，组织串联、煽动集会游行的信息安全
事件，其他信息内容安全事件。
5）设备设施故障，包括软硬件自身故障、外围保障设施故障、人为破坏事故、其他设备设施故障。
6）灾害性事件。
7）其他信息安全事件。
在企业内部，我们往往更多接触的是前几类，我们按实际情况结合自己的理解对信息安全事件进行
梳理，将其分为三个大类，下面分别阐述。
1.针对互联网应用的攻击事件
互联网应用由于对外网开放，也最容易被黑客盯上，加上各种自动化的扫描工具的出现，每天系统
会监测到各种各样的扫描请求，扫描器会尝试各种Web漏洞请求，如SQL注入、XSS攻击、上传漏洞、目
录遍历、特定文件请求等。针对一些登录接口，黑客会进行暴力破解、撞库攻击；针对一些URL或API接
口，黑客会遍历请求以获取更多信息。若进一步深入到系统中，提权、安装后门、清理日志等也时有发
生。若这些都没成，黑客还有可能为了获利采取DDoS攻击。
2.针对企业内网的攻击事件
企业员工一般都会通过邮件、上网、U盘拷贝等渠道和外界保持联系，而这三个点也容易被外部攻击
者利用。邮件里包含恶意文件，用户点击就被会被控制；用户访问的网页可能会包括漏洞挂马页面，用
户不小心就会中招；外部人员U盘插到内部电脑上也可能会使机器感染恶意程序，恶意程序进入到企业内
网之后，会进一步探测网络结构，寻找最有价值的攻击目标和系统，达成目标后可能会将需要的信息通
过各种手段外传出去。近年流行的勒索软件则更简单粗暴，直接加密用户文档数据，并要求受害者支付
一定数量的比特币获取解密密钥。
3.来自内部的信息泄露事件
除了来自外部的攻击，还有可能存在内部员工无意或有意的信息泄露事件。
曾有一个被处理事件是，内部员工把一份文件遗忘在复印机上，被其他员工拍照发到朋友圈。更多
来自内部的有意泄露可能隐藏在背后。
23.3 事件分级
事件分级的依据是受影响的系统重要程度及问题严重程度，很明显，核心业务系统、边缘业务系统
和非业务系统要区别开来，直接获取到系统权限、仅获取Webshell权限、只是类似phpinfo信息泄露，也
是完全不同的。
23.4 PDCERF模型
1.准备
PDCERF模型第一阶段即是准备工作，包括应急响应的规范制度、具体技术工具和平台的搭建运营
等。制度规范制定后需要真正能落实执行，并依靠模拟演练来提升处理效率。技术工具和平台有所区
别，工具是类似于静态编译的ls、lsof、ps、netstat以及一些快速分析日志、扫描文件特征的脚本等，这些
到了目标机器上就会发挥作用；而平台则是在企业部署了FW、NIDS、HIDS、WAF等系统后，将各种安
全系统在终端、网络、应用上采集的日志集中送到平台进行关联分析（如SOC系统）。
2.检测
发生事件后，需要判断受影响的系统是什么，事件的性质是什么，这就是检测阶段。基于初步的分
析结论，再采取不同的处理流程进行应急处置。
如互联网某边缘系统被攻击，在SOC系统上报警有扫描行为，可能只需要运营人员简单拒绝就可以
了，安全自动化做得好的企业可能就自动拦截了，不需要介入应急响应流程。
进一步，这个边缘系统报警有执行敏感指令而且父进程属于Web应用，这可能就需要应急人员开始
处置了，但是否上报，上报到哪个层级，估计只是汇报给安全主管就可以了。
再进一步，如果网银系统有大量撞库攻击事件，同时有客户报障其账户因错误多次被锁，那只汇报
给安全主管肯定不合适了。
检测工作除了要对业务了解，还有包括一些技术工作在内，比如流量大报警，是正常业务或发布导
致还是有攻击，攻击是常规的DDoS、还是CC、还是机器被控制向外发包；再比如一封恶意邮件投递进来
后，利用的是什么漏洞，回连地址是什么，以上这些，要利用一些技术手段去检测。