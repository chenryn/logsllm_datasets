# SoK: Towards Grounding Censorship Circumvention in Empiricism

## Authors
- Michael Carl Tschantz
- Sadia Afroz
- Anonymous
- Vern Paxson

## Affiliations
- International Computer Science Institute
- University of California, Berkeley

## Abstract
Effective evaluations of approaches to circumventing government Internet censorship require a deep understanding of how censors operate in practice. This paper undertakes an extensive examination of real-world censors by surveying prior measurement studies and analyzing field reports and bug tickets from practitioners. We assess both deployed circumvention approaches and research proposals, considering the criteria employed in their evaluations and comparing these to the observed behaviors of real censors. This comparison identifies areas where evaluations could more faithfully and effectively incorporate the practices of modern censors. These observations lead to a research agenda that aligns with the predominant problems of today.

## 1. Introduction
Censorship circumvention research aims to develop methods for accessing banned Internet resources, a domain characterized by an adversarial nature due to the ongoing interactions between circumventors and censors. Both parties are engaged in an arms race, managing trade-offs between efficacy and cost. As new technologies emerge, these trade-offs continually evolve, making sound evaluation of potential circumvention approaches both crucial and challenging.

Sound evaluation is essential because developers cannot implement and deploy every prospective approach; they need criteria to select the most promising ones. However, worst-case analyses that assume censors will exploit all vulnerabilities often overlook the realities of censors who aim to avoid blocking profitable traffic while staying within budget constraints. Grounding evaluations in empirical observations of real censors is therefore necessary.

While the evaluation sections of research papers provide some insight into the promise of a given circumvention approach, each paper typically employs its own methodology, often not balanced against realistic models of censors. This makes it difficult to compare different approaches or determine how well an evaluation predicts real-world performance. Approaches that meet their own evaluation criteria can still be vulnerable to unconsidered weaknesses.

## 2. Approach
To address the disconnect between evaluation and the actual operating conditions of censorship circumvention approaches, we seek to ground the evaluation in empirical observations of real censors. We systematically compare the behaviors of real censors to the evaluation criteria used by circumvention-approach designers. Our work systematizes the evaluation of approaches for censorship circumvention in four ways:

1. **Data Collection on Real-World Attacks**: We gather data on current censorship practices (Sections II and IV).
2. **Survey of Circumvention Approaches and Their Evaluations**: We illuminate the current state of evaluation (Sections V and VI).
3. **Comparison of Evaluation Criteria and Censor Actions**: We compare the designed evaluations to the actual actions of real censors (Section VII).
4. **Identification of Open Research Problems**: We point to open research problems whose resolution will improve evaluation (Section VIII).

## 3. Scope
We focus on government-imposed censorship aimed at preventing subjects from accessing particular web resources outside the government’s jurisdiction. The censor seeks to detect and disrupt banned traffic by placing monitors at the edges of their network, similar to customs inspectors at international borders. We consider channel-based approaches that:
- Bypass country-level censors monitoring network traffic between two endpoints,
- Communicate with resources outside the censors’ borders, and
- Enable low-latency connections suitable for web browsing.

Our scope excludes internal censorship of newspapers or disruption of entirely domestic communication. Even so, the remaining space of censor activity and circumvention approaches is large, with 55 approaches or evaluations falling within our scope. Figure 1 illustrates a generic model of censorship and circumvention under our scope.

## 4. Overview
We begin with a detailed look at the arms race between Tor and China, illustrating the cat-and-mouse nature of censorship and circumvention (Section II). After covering related work (Section III), we broaden our view by examining censorship incidents involving other channel-based circumvention approaches (Section IV).

Next, we provide a survey of channel-based censorship circumvention (Section V) and its evaluation (Section VI). Unlike other surveys, we do not focus on comparing the approaches themselves but rather on comparing their evaluations. We find little commonality in the evaluation methods employed, with no globally organizing principles guiding the selection of evaluation criteria.

We then focus on the criteria related to detecting circumventing traffic and compare them to the actions of real censors (Section VII). We observe that system designers often emphasize future censor capabilities, with little assessment of actual detection techniques used by current censors. We identify three key disconnects between practice and research:
1. Real censors attack how users discover and set up channels, whereas research often centers on channel usage.
2. Real censors prefer cheap passive monitoring or more involved active probing, whereas research often looks at complex passive monitoring and traffic manipulations at line speed.
3. Censors favor attacks that do not risk falsely blocking allowed connections due to packet loss, whereas research considers many less robust attacks.

We conclude with a research agenda to realign the evaluation of circumvention approaches with the actions of real censors (Section VIII). We propose augmenting prior approach-specific methods of evaluation with a new methodology for creating evaluation criteria and interpreting results, and with tools for aiding evaluators.

Throughout, we provide recommendations on how to improve evaluations. However, we do not end with a list of “correct” evaluation criteria or actually evaluate any approaches. Instead, we aim to provide a systematic method of thinking about evaluation that will guide evaluators of circumvention approaches in their selection of appropriate criteria on a case-by-case basis.

We also do not intend to discount the utility of forward-looking studies that anticipate more advanced censors. Rather, we aim to make the trade-offs clear: some approaches considered by research are likely years ahead of the point where their overhead is justified by actual censors effectively blocking less advanced methods, while censors block deployed approaches using simple attacks. We hope this observation inspires the research community to also provide tools for preventing simpler attacks, which would yield immediate benefits for many real users.

## 5. Illustrating the Problem Space: Tor and the Great Firewall
The problem space we consider has disparate aspects and a complicated, arms-race-driven evolution. In this section, we frame the space through the lens of the Tor anonymity system and the "Great Firewall" (GFW), the primary national censorship apparatus of China. The conflict between these two actors is representative of the larger world of censorship and circumvention, offering a way to introduce different notions and associated terminology.

Tor provides a convenient focus due to the relatively extensive documentation of its censorship and circumvention counter-responses. We mined blog posts, bug reports, and the Tor Project’s public documentation to identify the censorship events that underlie our narrative. A progression emerges: Tor, initially not designed for circumvention, is used to evade the GFW. The censor blocks the Tor website and the servers that make up the anonymity network; Tor responds with mirrors and secret entry servers. The censor begins to identify Tor by protocol features; Tor deploys protocol encapsulation to hide those features. The censor starts actively scanning for Tor servers; Tor introduces protocols immune to scanning.

In this recounting, the GFW plays the role of a censor: a government entity that disrupts access to certain Internet resources outside its jurisdiction (in this case, China). The censor employs monitors, traffic filtering devices at the edge of the network. Tor and its users are circumventors who seek to evade the censor’s controls. We divide circumventors into users, those within the censor’s jurisdiction who try to access blocked content, and advocates, those who develop, deploy, and maintain systems that enable circumvention. Any means of evading the censor’s blocking is termed a censorship circumvention approach, or "approach" for short. Tor offers multiple "pluggable" approaches, each with advantages and disadvantages. A user’s connection to the Tor network (however accomplished) is an example of what we call a channel. The Tor network itself is an example of a forwarder. A channel disguises user traffic so that it may reach a forwarder that then passes the traffic on to its ultimate destination. Refer to Figure 1 for the relative positioning of user, monitor, and forwarder.

The Tor network began operating in 2003, designed for anonymity. Early Tor had major deficiencies as a circumvention approach. Unsurprisingly, the first action the GFW took against Tor was simple: in 2008, it blocked the www.torproject.org website. In response, advocates deployed website mirrors and email-based software distribution mechanisms. The raw Tor protocol—today often called "vanilla" Tor—has many distinguishing features that make it easy to detect. We call any such distinguishing feature a vulnerability, by analogy to software security. Similarly, we refer to the effective leveraging of a vulnerability by the censor for detection and taking action against circumvention as an exploit. We call a chain of exploits aimed at disrupting a channel an attack. One of vanilla Tor’s biggest vulnerabilities is its hardcoded list of public directory authorities, from which users download the similarly public list of relay IP addresses. In late 2009, the GFW exploited this vulnerability by blocking the IP addresses of directory authorities and relays. The steps of the attack in this case are (1) downloading the list of relays and adding their addresses to a blacklist, and (2) dynamically blocking any access to those addresses when observed in a traffic stream.

In response to the blocking of its directory requests and relays, Tor introduced "bridges," secret relays without publicly listed addresses. Users must first learn the IP address of a bridge in some out-of-band fashion, for example by email, an instance of what we term an identifier distribution mechanism (IDM), the means by which a user learns the information required to establish a connection to a forwarder. After blocking the public relays, the GFW went after bridges by attacking the IDM, enumerating bridges from the centralized bridge database one by one. Private bridges—those distributed by word of mouth rather than through a centralized database—remained unblocked for a time. Even with secret bridge addresses, though, Tor remains vulnerable to deep packet inspection (DPI), protocol-aware filtering that considers application-layer semantics. Tor uses TLS in fairly distinctive ways that make it relatively easy to detect. For example, the firewall began to identify the use of Tor by looking for Tor’s distinctive list of TLS client cipher suites in 2011. For a time, Tor developers responded with incremental refinements to make Tor’s use of TLS less distinctive. A more lasting solution came in the form of "pluggable transports," modular circumvention approaches that form an additional layer around Tor TLS to protect it from protocol fingerprinting. Pluggable transports use a variety of techniques to hide the fact that Tor is in use.

This brings us to the state-of-the-art for Tor-related circumvention: censors that employ website and IP address blocking, IDM disruption, deep packet inspection, and active probing; and circumvention approaches that use secret IP addresses, encrypt their payloads, and resist active probing.

## 6. Related Work
To our knowledge, the literature lacks published surveys analyzing censorship attacks on circumvention approaches. The closest is Dingledine and Appelbaum’s slide deck listing attacks on Tor. Elahi et al. offer a report decomposing circumvention approaches into various phases and components to compare how they mitigate attacks on each. More narrowly focused, a report by Khattak et al. covers pluggable transports, a subset of channel-based approaches designed to plug into a larger system, such as Tor. Their work decomposes the channel of such transports into layers similar to a network stack to consider attacks and mitigations at each layer. Each of these two technical reports provides a survey of which tools offer which properties, similar to our Table IV. However, our survey differs in goal and scope: rather than attempting to compare approaches, our study’s primary goal is to compare evaluations in terms of how they relate to real-world concerns, grounding our discussion in empirical data regarding the behavior of actual censors.

Köpsell and Hillig proposed a taxonomy of circumvention approaches, modeling censors as either blocking on circumstances or content, similar to our breakdown of channel setup and usage. However, they do not empirically study how their model compares to real attacks.

Prior works have also empirically evaluated approaches. Roberts et al. assessed deployed circumvention approaches by testing whether they work in various countries. Callanan et al. used a combination of in-laboratory tests and user surveys to determine the usability, performance, and security characteristics of a variety of deployed approaches. Robinson et al. performed a study of 1,175 Chinese Internet users and found GoAgent to be the most widely used tool. They concluded that collateral damage caused by an evasion tool should be the ultimate criterion for evasion, arguing that a censor will not block a technology viewed as economically or politically indispensable to the regime.

Leberknight et al. classify evasion tools and examine the relationship between a tool’s classification and its lifespan. Their study grouped 15 tools into general types: HTTP proxy, CGI proxy, rerouting, IP tunneling, and distributed hosting. Examining the lifespan of these tools and when new censorship technologies arose, they conclude that users gravitate toward the fastest unblocked approach. Their work does not, however, develop corresponding measurements or delve into the technical issues of blocking and evasion.

By applying common methods to assessing circumvention technologies in their environment, these empirical works (i.e., [53, 55, 72–74]) assessed the success of deployed approaches. However, researchers and developers need criteria applicable to undeployed approaches. They must carefully select which proposals to develop and deploy due to the costs associated with such efforts. For this reason, we aim to understand how censors operate in order to predict which approaches will perform well if deployed.

Others have provided definitions of success or lists of criteria for circumvention approaches to fulfill. For example, Dingledine enumerates general properties that make for good evasion approaches. While he presents anecdotal evidence, his work does not systematically explore the capabilities of censors to justify his criteria. Pfitzmann and Hansen provide definitions of security properties, such as undetectability, unobservability, and unblockability, but they do not ground these using empirical observations.

Houmansadr et al. and Geddes et al. empirically evaluate the vulnerability to blocking of a selection of mimicry-based approaches. We compare these evaluation methods to real-world attacks in Section VII.

## 7. Censorship As Practiced
In this section, we examine censorship as practiced today more broadly than our previous sketch of Tor and China. We seek to illuminate the capabilities and limitations of current censors, with important implications for designing and evaluating effective approaches to circumvention.

We develop our knowledge of today’s censors from two sources: measurement studies of censors, and reports from the field about actual blocking events. We find little empirical analysis in the literature regarding how real censors block circumvention. Thus, we focus on collecting and organizing field reports, first for Tor, followed by those about other deployed approaches.

### A. Measurement Studies
We examined 31 measurement studies. Table I provides an overview of what they show about such censorship. The majority of the papers assessed censorship of non-circumventing traffic. At the end of this subsection, we consider those that did look at the censorship of circumventing traffic.

Studies documented censors disrupting traffic by injecting fake DNS replies, sending forged TCP Resets, actively probing a suspicious protocol, and using URL filtering systems, such as Blue Coat, Netsweeper, and SmartFilter. While some have conjectured that the GFW uses machine learning based upon their interactions with it, we know of no rigorous studies suggesting such. A few papers also examined reverse-engineering the internal structure of censors.

**In-path vs. On-path**: Censorship systems can operate in-path or on-path. An in-path monitor is a forwarding element between two networks through which all traffic must flow, such as Syria’s and Qatar’s employment of Blue Coat. An on-path monitor passively examines passing traffic and can inject, but not remove, packets, such as China’s GFW.

Each type of censorship system has advantages and limitations. On-path censors cannot conduct exploits requiring dropping packets. On the other hand, in-path censors face exacerbated processing challenges due to the need to process all traffic at line rate. Accordingly, attacks that rely on analyzing distributions of features could prove difficult to perform for an in-path monitor.

**Stateless vs. Stateful**: Stateless censors process packets individually, or at most perform limited packet reassembly. As such, circumventors can evade them by splitting sensitive strings into multiple packets. Stateful censors track transport-layer signaling and perform packet reassembly, with a corresponding processing and memory burden. The GFW operated in a stateless fashion before 2007 but became stateful as of 2007, indicating a system upgrade.

**Whitelist vs. Blacklist**: The majority of censors use a blacklist to filter disallowed contents. We noted only two incidents of whitelisting-based censors: Iran in 2013 and Tunisia in 2009. Aryan et al. studied censorship in Iran in 2013 when non-whitelisted protocols were throttled. They found SSH file transfers got throttled to around 15% of its standard bandwidth and an obfuscated protocol, similar to the Tor’s Obfsproxy protocol, got throttled to near zero at about 60 seconds into the connection.

**Blocking Timeline**: Censors have particular motivations for censorship, which the onset of censorship can illuminate. For example, China and Iran increase censorship activity to reduce political chaos, leading to blocking of circumvention systems before or during political events. Such patterns suggest that circumvention approaches that can distribute sets of new identifiers or new protocols only during critical times might succeed by denying the censors sufficient time to detect and block all of them.

**Censorship of Circumvention**: Winters and Lindskog studied the active probing by China that sends requests to suspected nodes to identify and block Tor when using its "Obfs2" circumvention extensions ("pluggable transports"), and Ensaﬁ et al. studied the extension of active probing to Tor’s Obfs3 transport. Distinguishing the censor’s probes from real users can be challenging, as at least for China, the censor draws upon a large number of IP addresses to originate the probes.

Ensaﬁ et al. studied the reachability of Tor relays and directory authorities from China. Using "SYN backlog" scanning, they confirmed the GFW blocks access to Tor relays and directory authorities by dropping their SYN/ACK replies to clients.

From the leaked logs of Blue Coat deployed in Syria in 2011, Chaabane et al. found censorship of less than 2% of requests to the Tor network, but heavy censorship of other circumvention services such as Hotspot Shield.

We find it striking that just four papers have examined the censorship of circumvention approaches:
- **Research Gap 1**: Little research has examined how real censors exploit vulnerabilities in circumvention approaches, leading to a dearth of realistic censor models.

### B. Tor
To partly address Gap 1, we conducted and analyzed a survey of prior field reports on the blocking of deployed approaches. The story of Tor and the GFW in Section II forms a part of this larger analysis. Table II summarizes the censorship incidents we found and what we know about them. The table is based upon field reports primarily coming from Tor advocates, developers, and users in the form of bug reports, blog posts, presentations, and comments. We undertook a comprehensive study of Tor’s blog and bug tracker to find as many censorship-related reports as possible. We collected 747 blog posts and 13,337 bug-tracker reports from 12/2007 to 3/2015. We seeded a list of known censorship events with 9 blog posts and 11 bug reports. Finding that grep-style searches yielded too many false positives, we used these manually labeled instances as a training set for a supervised machine-learning classifier, which found an additional 5 bug reports and 11 blog posts about specific censorship events.

We associate each event with its target (Tor, in most cases), as well as with the steps that make up the censor’s attack. Some steps are vague due to a lack of documentation; for instance, some are simply "Block" because we do not know exactly how the block was effected. Each step of an attack corresponds to some sort of detection, or an action taken based on a previous detection. Attacks can span multiple phases in the use of a circumvention approach. We observe a common pattern of the dynamic detection of traffic destined for a forwarder, followed by blacklisting of the forwarder’s address to prevent any future communication.

In general, we see a progression from simple to more complex on the part of both censor and circumventor. Thailand blocked the www.torproject.org website in 2006. In 2007, Saudi Arabia and Iran began blocking HTTP requests with the string "/tor/" in the URL, intending to block communication with the Tor directory authorities.

DPI against the Tor protocol itself came only later, but took a variety of forms. Examples include checking for Tor’s characteristic TLS renegotiation (Syria in 2011); checking for a specific Diffie-Hellman parameter during key negotiation (Iran in January 2011); measuring the TLS certificate lifetime (Iran in September 2011); and checking for specific TLS cipher suites (Ethiopia, Kazakhstan, the UAE, and the Philippines in 2012).

Tor is occasionally caught up in more general censorship. In 2009, Tunisia blocked all but a few TCP ports. Only relays running on those ports remained accessible. Throttling—deliberate slowing—of encrypted traffic took place in separate incidents in Iran in 2009, 2011–2012, and 2013. Even more extreme, Egypt and Libya in 2011 and Syria in 2012 completely disabled Internet access for a period of days or weeks. (We elide such total-censorship events from Table II.)

That instances of complete network blocking are rare and short-lived highlights an important general principle. Censors could prevent all circumvention by permanently disabling the network, but they do not, because Internet access brings general benefits that outweigh the harm of circumvention. The censor would prefer, ideally, to block forbidden sites and circumvention traffic, and nothing else. The purpose of circumvention is to make it difficult for the censor to distinguish these cases, thereby forcing the censor to allow some circumvention traffic (underblocking), or else block some non-circumvention traffic (overblocking), resulting in collateral damage. The higher the costs of overblocking, the more likely the censor will tend towards underblocking.

### C. Approaches Other Than Tor
We also collected reports of censorship events against other deployed approaches. We find these harder to come by since most approaches do not offer as much public documentation as Tor does. Thus, here we offer not a comprehensive overview but illustrations of real censorship incidents that highlight additional facets regarding the operation of real censors.

**Popularity-Driven Blocking**: VPN Gate launched in March 2013 and quickly accrued over 5,000 unique clients from China. Only three days after launch, and presumably as a result of this sudden popularity, the Great Firewall blocked the VPN Gate website and its central database of relay servers. Soon after, Chinese censors began crawling the database of servers more than once a day to maintain an up-to-date blacklist.