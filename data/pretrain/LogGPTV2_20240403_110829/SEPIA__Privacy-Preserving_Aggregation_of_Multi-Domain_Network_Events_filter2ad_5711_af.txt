anomaly taking place but they were not affected. Most
of the organizations conclude that they were indeed af-
fected, but less than average. Organizations 3 and 4,
however, have to spend thoughts on why the anomaly
was so disproportionately strong in their networks.
An investigation of the full port distribution and its
entropy (plots omitted due to space limitations) shows
that affected organizations see a sudden increase in scan-
ning activity on speciﬁc high port numbers. Connections
originate mainly from ports 80 and 443, i.e., the fall-
back ports of Skype, and a series of high port numbers
indicating an anomaly related to Skype. For organiza-
tions 3 and 4, some of the scanned high ports are ex-
tremely prevalent, i.e., a single destination port accounts
for 93% of all ﬂows at the peak rate. Moreover, most of
the anomalous ﬂows within organizations 3 and 4 are tar-
geted at a single IP address and originate from thousands
of distinct source addresses connecting repeatedly up to
13 times per minute. These patterns indicate that the two
organizations host popular supernodes, attracting a lot of
trafﬁc to speciﬁc ports. Other organizations mainly host
client nodes and see uniform scanning, while organiza-
Org #
lag [hours]
3
1.2
5
2.7
6
7
23.4
15.5
13
4.8
17
3.6
Table 3: Organizations proﬁting from an early anomaly
warning by aggregation.
tion 2 has banned Skype completely. Based on this anal-
ysis, organizations can take appropriate measures to mit-
igate the impact of the 2-day outage, like notifying users
or blocking speciﬁc port numbers.
Early-warning Finally, we investigate whether the ag-
gregate view can be useful for building an early-warning
system for global or large-scale anomalies. The Skype
anomaly did not start concurrently in all locations, since
the Windows update policy and reboot times were differ-
ent across organizations. We measured the lag between
the time the Skype anomaly was ﬁrst observed in the ag-
gregate and local view of each organization. In Table 3
we list the organizations that had considerable lag, i.e.,
above an hour. Notably, one of the most affected orga-
nizations (6) could have learned the anomaly almost one
day ahead. However, as shown in Fig. 11, for organiza-
tion 2 this would have been a false positive alarm. To
proﬁt most from such an early warning system in prac-
tice, the aggregate view should be annotated with addi-
tional information, such as the number of organizations
or the type of services affected from the same anomaly.
In this context, our event correlation protocol is useful to
decide whether similar anomaly signatures are observed
in the participating networks. Anomaly signatures can be
extracted automatically using actively researched tech-
niques [8, 33].
8 Related Work
Most related to our work, Roughan and Zhan [37] ﬁrst
proposed the use of MPC techniques for a number of
applications relating to trafﬁc measurements, including
the estimation of global trafﬁc volume and performance
measurements [36].
In addition, the authors identiﬁed
that MPC techniques can be combined with commonly-
used trafﬁc analysis methods and tools, such as time-
series algorithms and sketch data structures. Our work is
similar in spirit, yet it extends their work by introducing
new MPC protocols for event correlation, entropy, and
distinct count computation and by implementing these
protocols in a ready-to-use library.
Data correlation systems that provide strong privacy
guarantees for the participants achieve data privacy by
means of (partial) data sanitization based on bloom ﬁl-
ters [44] or cryptographic functions [26, 24]. However,
data sanitization is in general not a lossless process and
therefore imposes an unavoidable tradeoff between data
privacy and data utility.
The work presented by Chow et al. [12] and Apple-
baum et al. [1] avoid this tradeoff by means of cryp-
tographic data obfuscation. Chow et al. proposed a
two-party query computation model to perform privacy-
preserving querying of distributed databases.
In addi-
tion to the databases, their solution comprises three en-
tities:
the randomizer, the computing engine, and the
query frontend. Local answers to queries are random-
ized by each database and the aggregate results are de-
randomized at the frontend. Applebaum et al. present
a semi-centralized solution for the collaboration among
a large number of participants in which responsibility is
divided between a proxy and a central database.
In a
ﬁrst step the proxy obliviously blinds the clients’ input,
consisting of a set of keyword/value pairs, and stores the
blinded keywords along with the non-blinded values in
the central database. On request, the database identiﬁes
the (blinded) keywords that have values satisfying some
evaluation function and forwards the matching rows to
the proxy, which then unblinds the respective keywords.
Finally, the database publishes its non-blinded data for
these keywords. As opposed to these approaches, SEPIA
does not depend on two central entities but in general
supports an arbitrary number of distributed privacy peers,
is provably secure, and more ﬂexible with respect to the
functions that can be executed on the input data. The
similarities and differences between our work and exist-
ing general-purpose MPC frameworks are discussed in
Sec. 5.4.
9 Conclusion
The aggregation of network security and monitoring
data is crucial for a wide variety of tasks, including col-
laborative network defense and cross-sectional Internet
monitoring. Unfortunately, concerns regarding privacy
prevent such collaboration from materializing.
In this
paper, we investigated the practical usefulness of solu-
tions based on secure multiparty computation (MPC).
For this purpose, we designed optimized MPC operations
that run efﬁciently on voluminous input data. We im-
plemented these operations in the SEPIA library along
with a set of novel protocols for event correlation and
for computing multi-domain network statistics, i.e., en-
tropy and distinct count. Our evaluation results clearly
demonstrate the efﬁciency and scalability of SEPIA in
realistic settings. With COTS hardware, near real-time
operation is practical even with 140 input providers and
9 computation nodes. Furthermore, the basic operations
of the SEPIA library are signiﬁcantly faster than those
of existing MPC frameworks and can be used as build-
ing blocks for arbitrary protocols. We believe that our
work provides useful insights into the practical utility of
MPC and paves the way for new collaboration initiatives.
Our future work includes improving SEPIA’s robustness
against host failures, dealing with malicious adversaries,
and further improving performance, using, for example,
polynomial set representations. Furthermore, in collab-
oration with a major systems management vendor, we
have started a project that aims at incorporating MPC
primitives into a mainstream trafﬁc proﬁling product.
Acknowledgments
We are grateful to SWITCH for providing their trafﬁc
traces and to the anonymous reviewers for their helpful
comments. Also, we want to thank Lisa Barisic and Do-
minik Schatzmann for their contributions. Special thanks
go to Vassilis Zikas for assisting with MPC matters and
for the idea of using Fermat’s little theorem.
References
[1] APPLEBAUM, B., RINGBERG, H., FREEDMAN, M. J., CAE-
SAR, M., AND REXFORD, J. Collaborative, privacy-preserving
data aggregation at scale.
In Privacy Enhancing Technologies
Symposium (PETS) (2010).
[2] ATLAS. Active Threat Level Analysis System. http://
atlas.arbor.net.
[3] BEN-DAVID, A., NISAN, N., AND PINKAS, B. FairplayMP:
a system for secure multi-party computation. In Conference on
Computer and communications security (CCS) (2008).
[4] BEN-OR, M., GOLDWASSER, S., AND WIGDERSON, A.
Completeness theorems for non-cryptographic fault-tolerant dis-
tributed computation. In ACM symposium on Theory of comput-
ing (STOC) (1988).
[5] BETHENCOURT, J., FRANKLIN, J., AND VERNON, M. Mapping
In 14th USENIX
internet sensors with probe response attacks.
Security Symposium (2005).
[6] BOGDANOV, D., LAUR, S., AND WILLEMSON, J. Sharemind:
A Framework for Fast Privacy-Preserving Computations.
In
European Symposium on Research in Computer Security (ES-
ORICS) (2008).
[7] BOGETOFT, P., CHRISTENSEN, D., DAMG ˚ARD, I., GEISLER,
M., JAKOBSEN, T., KRØIGAARD, M., NIELSEN, J., NIELSEN,
J., NIELSEN, K., PAGTER, J., ET AL. Secure multiparty compu-
tation goes live. In Financial Cryptography (2009).
[8] BRAUCKHOFF, D., DIMITROPOULOS, X., WAGNER, A., AND
SALAMATIAN, K. Anomaly extraction in backbone networks
using association rules.
In ACM SIGCOMM/USENIX Internet
Measurement Conference (IMC) (2009).
[9] BRAUCKHOFF, D., SALAMATIAN, K., AND MAY, M. Applying
PCA for Trafﬁc Anomaly Detection: Problems and Solutions. In
INFOCOM (2009).
[10] BURKHART, M., AND DIMITROPOULOS, X.
Fast privacy-
preserving top-k queries using secret sharing.
In International
Conference on Computer Communication Networks (ICCCN)
(2010).
[11] CANETTI, R. Universally composable security: A new paradigm
for cryptographic protocols. In IEEE Symposium on Foundations
of Computer Science (FOCS) (2001).
[12] CHOW, S. S. M., LEE, J.-H., AND SUBRAMANIAN, L. Two-
party computation model for privacy-preserving queries over dis-
tributed databases. In NDSS (2009), The Internet Society.
[13] CLAFFY, K., CROVELLA, M., FRIEDMAN, T., SHANNON, C.,
AND SPRING, N. Community-Oriented Network Measurement
Infrastructure (CONMI) Workshop Report. Computer Communi-
cation Review (CCR) 36, 2 (2006), 41.
[14] DAMG ˚ARD, I., FITZI, M., KILTZ, E., NIELSEN, J., AND TOFT,
T. Unconditionally secure constant-rounds multi-party computa-
tion for equality, comparison, bits and exponentiation. In Theory
of Cryptography Conference (TCC) (2006).
[15] DAMG ˚ARD,
I., GEISLER, M., KRØIGAARD, M., AND
NIELSEN, J. Asynchronous multiparty computation: Theory and
implementation. In Conference on Practice and Theory in Public
Key Cryptography (PKC) (2009).
tection. PhD thesis, Princeton University, 2009.
[35] ROSSI, D., MELLIA, M., AND MEO, M. Understanding Skype
Signaling. Computer Networks 53, 2 (2009), 130–140.
[36] ROUGHAN, M., AND ZHANG, Y. Privacy-preserving perfor-
mance measurements. In SIGCOMM workshop on Mining net-
work data (MineNet) (2006).
[37] ROUGHAN, M., AND ZHANG, Y. Secure distributed data-mining
and its application to large-scale network measurements. Com-
puter Communication Review (CCR) 36, 1 (2006), 7–14.
[38] SEKAR, V., XIE, Y., MALTZ, D., REITER, M., AND ZHANG,
H. Toward a framework for internet forensic analysis. In ACM
HotNets-III (2004).
[16] DSHIELD. The Internet Storm Center. www.dshield.org.
[17] DWORK, C. Differential privacy: A survey of results. Theory
[39] SEPIA web page. http://www.sepia.ee.ethz.ch.
[40] SHAMIR, A. How to share a secret. Communications of the ACM
and Applications of Models of Computation (TAMC) (2008).
22, 11 (1979), 612–613.
[18] FREEDMAN, M. J., NISSIM, K., AND PINKAS, B. Efﬁcient Pri-
vate Matching and Set Intersection. In EUROCRYPT ’04 (2004).
[19] GENNARO, R., RABIN, M., AND RABIN, T. Simpliﬁed VSS and
fast-track multiparty computations with applications to threshold
cryptography. In 7th annual ACM symposium on Principles of
distributed computing (PODC) (1998).
[20] GOLDREICH, O., MICALI, S., AND WIGDERSON, A. How to
play any mental game. In ACM symposium on Theory of comput-
ing (STOC) (1987).
[21] KATTI, S., KRISHNAMURTHY, B., AND KATABI, D. Collab-
orating against common enemies. In ACM SIGCOMM/USENIX
Internet Measurement Conference (IMC) (2005).
[41] SHMATIKOV, V., AND WANG, M.
response attacks in collaborative intrusion detection.
Workshop on Large-scale Attack Defense (LSAD) (2007).
Security against probe-
In ACM
[42] SIMPSON, C. R., JR., AND RILEY, G. F. Neti@home: A dis-
tributed approach to collecting end-to-end network performance
measurements. In Passive and Active Measurement Conference
(PAM) (2004).
[43] SLAGELL, A., AND YURCIK, W. Sharing Computer Network
Logs for Security and Privacy: A Motivation for New Method-
ologies of Anonymization. In Workshop on the Value of Security
through Collaboration (SECOVAL) (September 2005).
[44] STOLFO, S. J. Worm and attack early warning. IEEE Security
[22] KISSNER, L., AND SONG, D. Privacy-Preserving Set Opera-
and Privacy 2, 3 (2004), 73–75.
tions. In Proceedings of CRYPTO ’05 (2005).
[23] LAKHINA, A., CROVELLA, M., AND DIOT, C. Mining anoma-
In ACM SIGCOMM
lies using trafﬁc feature distributions.
(2005).
[24] LEE, A. J., TABRIZ, P., AND BORISOV, N. A privacy-preserving
interdomain audit framework. In Workshop on privacy in elec-
tronic society (WPES) (2006).
[25] LI, X., BIAN, F., CROVELLA, M., DIOT, C., GOVINDAN, R.,
IANNACCONE, G., AND LAKHINA, A. Detection and identiﬁ-
cation of network anomalies using sketch subspaces.
In ACM
SIGCOMM/USENIX Internet Measurement Conference (IMC)
(2006).
[26] LINCOLN, P., PORRAS, P., AND SHMATIKOV, V. Privacy-
In 13th
preserving sharing and correlation of security alerts.
USENIX Security Symposium (2004).
[27] MACHIRAJU, S., AND KATZ, R. H. Verifying global invariants
in multi-provider distributed systems. In SIGCOMM Workshop
on Hot Topics in Networking (HotNets) (2004), ACM.
[28] NISHIDE, T., AND OHTA, K. Multiparty computation for inter-
val, equality, and comparison without bit-decomposition proto-
col. In Conference on Theory and Practice of Public Key Cryp-
tography (PKC) (2007).
[29] OHM, P. Broken promises of privacy: Responding to the sur-
prising failure of anonymization. 57 UCLA Law Review (2010).
Available at http://ssrn.com/abstract=1450006.
[30] PAREKH, J. J., WANG, K., AND STOLFO, S. J.
Privacy-
preserving payload-based correlation for accurate malicious traf-
ﬁc detection. In ACM Workshop on Large-scale Attack Defense
(LSAD) (2006).
[31] PLANETLAB.
An open platform for developing, deploy-
ing, and accessing planetary-scale services. http://www.
planet-lab.org.
[32] PORRAS, P., AND SHMATIKOV, V. Large-scale collection and
In
sanitization of network security data: risks and challenges.
Workshop on New security paradigms (NSPW) (2006).
[33] RANJAN, S., SHAH, S., NUCCI, A., MUNAF `O, M. M., CRUZ,
R. L., AND MUTHUKRISHNAN, S. M. Dowitcher: Effective
worm detection and containment in the internet core. In INFO-
COM (2007).
[34] RINGBERG, H. Privacy-Preserving Collaborative Anomaly De-
[45] TARIQ, M. B., MOTIWALA, M., FEAMSTER, N., AND AM-
MAR, M. Detecting network neutrality violations with causal
inference. In Conference on Emerging networking experiments
and technologies (CoNEXT) (2009).
[46] TELLENBACH, B., BURKHART, M., SORNETTE, D., AND
MAILLART, T. Beyond Shannon: Characterizing Internet Trafﬁc
with Generalized Entropy Metrics. In Passive and Active Mea-
surement Conference (PAM) (April 2009).
[47] Nonextensive statistical mechanics and thermodynamics. http:
//tsallis.cat.cbpf.br/biblio.htm.
[48] YAO, A. Protocols for secure computations. In IEEE Symposium
on Foundations of Computer Science (1982).
[49] YEGNESWARAN, V., BARFORD, P., AND JHA, S. Global Intru-
sion Detection in the DOMINO Overlay System. In Network and
Distributed System Security Symposium (NDSS) (2004).
[50] ZIVIANI, A., GOMES, A., MONSORES, M., AND RODRIGUES,
P. Network anomaly detection using nonextensive entropy. Com-
munications Letters, IEEE 11, 12 (2007), 1034–1036.
Notes
1We deﬁne near real-time as the requirement of fully processing
an x-minute interval of trafﬁc data in no longer than x minutes, where
x is typically a small constant. For our evaluation, we use 5-minute
windows.
2For instance, if n = 10 and Tc = 7, each event that needs to be
reconstructed according to (4) must be reported by at least one of the
ﬁrst 4 input peers. Hence, it is sufﬁcient to compute the Cij and Wij
for the ﬁrst n − Tc + 1 = 4 input peers.
3When run on a 32-bit platform, up to twice the CPU load was ob-
served, with similar overall running time. This difference is due to
shares being stored in long variables, which are more efﬁciently pro-
cessed on 64-bit CPUs.