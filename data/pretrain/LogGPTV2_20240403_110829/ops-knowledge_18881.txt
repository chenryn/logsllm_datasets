User: 请解答这个和日志有关的问题Windows Update not working on Windows Server 2008 R2 The Windows Update screen comes up and I click on Download Updates. I then get the bar scrolling across the screen and it says Downloading Updates but the counts never increase (0 KB total, 0% complete). I've tried several things found via Google to resolve this but so far nothing has worked. 


Quoted from https://serverfault.com/questions/166318/windows-update-not-working-on-windows-2008-r2-standard-x64, except I don't have an unlicensed SQL Server 2008 running. I have also tried several things from Google, including WUInstall and setting up a separate WSUS server and nothing has worked so far.

I've re-registered and sfc'd about every DLL I can think of that might be at all related (a little over 150), I'm not using any proxy servers.

I've downloaded the updates manually, but Windows stalls with a "Searching for updates" that never finishes searching.

Only errors I can find in my log are as follows:

2012-01-30 05:00:10:014  980    f40 AU  WARNING: Failed to change download properties of call, error = 0x80070057
2012-01-30 07:43:06:441  980    fc0 AU  WARNING: Returning due to error from GetDownloadProgressUx, error = 0x8024000C
2012-01-30 07:43:06:443  980    fc0 AU  WARNING: GetInteractiveInstallProgress failed, error = 0x8024000C

Upon googling the first error, I came across some resolution steps:


  
  Click on Start and type services.msc into the search box, then click on services as it appears above. Scroll down the list to Windows Update, right click on it and select stop.
  Type this into the search box %windir%\SoftwareDistribution click on "Software Distribution" in the box above and delete the entire contents of the "Download" folder.
  Go back and turn the Windows Update service back on.
  


Which, I've already tried, and no luck.

Later on, it says to download Microsoft's MicrosoftFixit.wu.Run.exe and try that, which I have and no luck. I've also tried Microsoft patch Windows6.1-KB947821-v14-x64.msu which stalls with the ever so annoying "Searching for updates on this computer" forever.

I've tried downloading the third-party FixWU and nothing.

I've tried forcing a reinstall of the Windows Update agent using WindowsUpdateAgent30-x64.exe /wuforce

I've checked the PC for anti-viruses, rootkits, mal-ware, nothing of that sort. I reset all the VPN connections, and turned off the firewall temporarily, still nothing.

I've checked access permissions on C: and it's sub-folders, both built-in Users and Administrators have read/write privileges.   

Also tried everything in http://support.microsoft.com/kb/949358, and manually rebuilding/reinstalling the Windows Update agent.

I'm at my wit's end here, not sure what else to do/try, any suggestions???

Assistant: Follow the instructions at the bottom of this KB article to enable extended logging.

Also verify if Background Intelligent Transfer Service (BITS) is running correctly at the machine in question.

Check if BITS download jobs are being created by Windows Update Service running, as administrator:

bitsadmin /list /allusers


Could you post your windowsupdate.log to a place like http://pastebin.com/?



You may also try to stop Windows Update Service (wuauserv) using 

sc stop wuauserv


and delete the following folder and registry keys (and sub folders / sub keys):

%windir%\softwaredistribution\datastore

HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate


Delete all BITS jobs related to Windows Update like in the example below

bitsadmin /cancel {4706732F-9E3A-456B-9696-F0D18B8EA327}


Having done that, start wuauserv again:

sc start wuauserv