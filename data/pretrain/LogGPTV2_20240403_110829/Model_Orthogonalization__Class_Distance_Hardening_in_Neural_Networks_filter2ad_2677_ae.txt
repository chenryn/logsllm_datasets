### 优化后的文本

#### 3.13%
0.98%  
0.58%  
0.45%  
0.62%  
-  
1.06%  
1.24%  
1.99%  
0.55%  
0.40%  
0.66%  
-  
1.16%  
2.00%  
1.49%  
0.80%  
1.52%  
0.91%

**MOTH**。然而，由于其成本效益较差，Pairwise 方法在训练模型时可能需要长达 1683.52 分钟，这比 MOTH 慢了 22.75 倍（见附录 X-C 中表 V 的 GTSRB 上的 NiN 模型结果）。两种后门消除技术在类间距离上的改进有限，NC 平均提高了 7.60%，而 NAD 则降低了 4.59%。这是合理的，因为这些后门消除方法最初是为移除模型中注入的潜在后门设计的。它们对良性模型的影响很小，因此不会增加正常类对之间的距离。总体而言，MOTH 在类间距离硬化方面优于 NC、NAD、UAP 和 Universal，并且在效率上优于 Pairwise，同时保持相似的距离改进。

授权使用仅限于：清华大学。下载时间：2022年8月7日13:03:02 UTC，来源：IEEE Xplore。使用受限。

#### 图 10：平均类间距离比较
我们在对抗训练模型上的观察与表 II 中的结果类似。对抗训练模型通常比自然训练模型有更大的准确率下降，但它们的类间距离更大。然而，这些类间距离仍然不是最优的。MOTH 可以进一步提高类间距离，平均提升 53.18%，并且仅导致 0.58% 的准确率下降和无鲁棒性下降。对于 CIFAR-10 上的 NiN 模型，我们观察到轻微的鲁棒性下降（0.30%），这是因为仍可能存在靠近决策边界的点，从而使得模型容易受到对抗攻击，如第 III 节所述。Universal 在对抗训练模型上的表现与自然训练模型类似，它可以将类间距离从 19.02% 提高到 57.85%，但平均低于 MOTH 16.73%。如前所述，Pairwise 效率较低。对于对抗训练模型，它的时间成本更高，最大训练时间为 2122.95 分钟，大约相当于一天半（见附录 X-C 中的表 VI）。它的类间距离改进与 MOTH 类似。NC 和 NAD 在对抗训练模型上的表现略优于自然训练模型，分别为 10.91% 和 4.84%，但仍劣于其他基线和 MOTH。由于 Pairwise 在自然训练和对抗训练模型上的表现与 MOTH 相似，我们进一步研究了它们生成硬化模型的效率。详情请参见附录 X-D。

我们还比较了自然训练模型、对抗训练模型及其由 MOTH 硬化的版本的类间距离。图 10 展示了不同模型的平均类间距离。对于 CIFAR-10，我们观察到 MOTH 可以提高自然训练和对抗训练模型的类间距离，但基于自然模型硬化的模型的类间距离较小。这是因为这些对抗模型的准确率较低，从 73.94% 到 78.45%（见表 II），而硬化模型的准确率为 86.81% 到 91.48%（见表 I）。对于 SVHN 和 GTSRB 数据集，观察到基于自然模型硬化的模型的类间距离大于对抗训练模型。硬化模型的准确率也高于对抗模型，例如，SVHN 上的 NiN 模型的准确率为 94.99% 对 91.63%（见表 I 和表 II）。这与我们在第 III 节中的讨论一致，即对抗训练可以改变决策边界以获得更大的类间距离。然而，它可能无法达到最大值，如图 4(b) 所示。另一方面，正交化可以从鲁棒模型开始实现更大的距离，但可能会牺牲一些准确性。

#### 表 II：不同方法在对抗训练模型上的类间距离硬化比较
第五列（Rob.）表示模型在验证集上的鲁棒性。最后两列（ADeg. 和 RDeg.）分别显示测试准确率和模型鲁棒性的下降。

| 方法 | 时间 (min) | 距离增加 (%) | 准确率下降 (%) | 鲁棒性下降 (%) |
| --- | --- | --- | --- | --- |
| Adversarial | 462.50 | 209.59 | 2.99 | 0.00 | 0.30 |
| NC | 2.61 | 212.16 | 2.39 | 0.58 | 0.30 |
| NAD | 74.29 | 42.50 | - | - | - |
| Universal | 73.00 | 259.93 | 25.62 | 0.95 | 0.00 |
| Pairwise | 128.46 | 288.12 | 39.90 | 1.53 | 0.00 |
| MOTH | - | - | - | - | - |

#### C. TrojAI 模型评估
TrojAI 竞赛中的模型由 NIST [42] 训练，具有各种模型结构和分类任务。这些模型已经通过对抗训练进行了硬化，如实验设置所述。我们从官方网站 [42] 下载了一组随机的 30 个模型（详见附录 X-E 中的选择方法），并研究是否可以进一步提高类间距离。详细结果见补充材料 [44]。我们的观察与表 II 中的结果相同。Universal 可以在一定程度上提高类间距离，平均提高了 154.70%，但不如 MOTH 的 232.39%。TrojAI 模型比前一节中使用的模型更大、更复杂。Universal 的效率较低，平均训练时间为 167.92 分钟，比 MOTH 慢 42%（118.10 分钟）。Pairwise 在类间距离硬化方面的表现与 MOTH 类似，但效率低下（平均 1121.97 分钟），比 MOTH 慢 10.81 倍。结果表明了 MOTH 在预训练模型类间距离硬化方面的有效性和高效性。

授权使用仅限于：清华大学。下载时间：2022年8月7日13:03:02 UTC，来源：IEEE Xplore。使用受限。

#### 表 III：设计选择的消融研究
| 方法 | 时间 (分钟) | 距离增加 (%) | 准确率下降 (%) |
| --- | --- | --- | --- |
| Natural | 56.77 | 91.52 | - |
| MOTH | 29.68 | 90.34 | - |
| w/o symmetric | 35.40 (+19%) | 90.69 | - |
| w/o dynamic adjustment | 44.72 (+51%) | 90.65 | - |
| w/o approx. warm-up | 52.00 (+75%) | 88.78 | 120.47 (+306%) |
| w/o scheduler | 53.49 | 109.70 | 108.62 | 1.18 |
| - | - | - | - |
| 78.90 | 0.83 | - | - |
| 94.16 | 95.59 | 0.87 | - |
| 103.45 | 105.28 | 99.53 | 1.08 |
| 111.09 | 112.84 | 2.74 | - |

#### D. 消融研究
MOTH 具有一些设计选择，以有效地提高类间距离。我们单独研究每个组件，以了解这些设计的效果。具体来说，我们考虑 MOTH 中的四个主要部分：(1) 对称硬化；(2) 后门重用和权重调整；(3) 通过损失变化近似的热身；(4) K 臂调度器。我们使用 CIFAR-10 上的 ResNet20 模型进行消融研究。表 III 显示了这些设计选择的效果。Natural 行表示原始模型。MOTH 是我们技术的最终结果。接下来的四行分别对应上述四个在训练过程中被排除的组件。观察到没有对称训练时，整体改进下降了 30%，显示出其重要性。这与我们在第 IV-B 节中的讨论一致。没有对称硬化的训练时间也增加了，因为训练需要分别考虑一对中的两个方向。排除动态调整后，训练成本从 29.68 分钟增加到 44.72 分钟，增加了 51%。类间距离改进也下降了 10%，表明后门重用确实提升了性能。表 III 第六行的结果显示，没有近似热身的情况下，训练成本大幅增加 75%。对于更多类别的任务，情况会更加恶化。我们还研究了不同热身策略下的最终成对类间距离，结果几乎相同（详见附录 X-F）。最后一行的结果明显展示了调度器在减少训练成本方面的有效性。配备调度器后，MOTH 的速度是未配备调度器的 4 倍，而距离改进相似。

#### VI. 应用
在本节中，我们评估 MOTH 在两个应用中的表现，包括减少后门扫描的误报和消除现有模型中的注入后门。

**A. 减少误报**
在 TrojAI 多轮竞赛中，参赛者被要求从大量包含干净和中毒模型的集合中识别出中毒模型。如第 II 节所述，由于干净模型中存在小的自然后门，参赛者在减少误报（即将干净模型报告为中毒模型）方面遇到了困难，尤其是在第二轮。TrojAI 组织者在随后的几轮中利用对抗训练来缓解这个问题，例如第四轮。然而，顶级参赛者在第四轮中仍报告了 32 个干净模型为中毒模型。我们将 MOTH 应用于这 32 个干净模型。准确率下降不明显（平均 0.13%）。详情见补充材料 [44]。距离改进与第 V-C 节所示相似。经过正交化后，我们再次使用从顶级参赛者网站 [54] 下载的扫描器对第四轮数据集进行扫描（其中 32 个模型已硬化）。误报数量从 32 减少到 6，而没有丢失任何真正阳性。对于剩余的 6 个误报模型，我们观察到某些类别非常相似。图 11 显示了模型 ID 905 的一个示例。第一张和第二张图片分别来自类别 1 和类别 20。前景中的两个标志看起来非常相似，只有中心的一个箭头不同。最后一张图片显示了顶级参赛者生成的后门，其中心只有几个小黑点。该对类别的类间距离在原始模型中为 1842，在硬化模型中为 3964。尽管 MOTH 已经将距离提高了 115%，但它仍然太小，因为这相当于约 3964/3 ≈ 36 × 36 像素的变化（输入图像为 224 × 224），无法与注入的后门大小 4215 区分开来。类间距离受两类之间自然相似性的限制。这进一步强调了发布正交化类间距离作为模型规范的一部分的重要性，使用户能够意识到这些类之间自然后门带来的不可避免的安全风险。

**B. 消除注入后门**
为了实现隐蔽性，注入的后门通常是小的。这种数据投毒的本质是将受害类和目标类拉近，使其仅通过小后门分离。因此，MOTH 可以用于消除此类后门，因为它增大了类间距离。