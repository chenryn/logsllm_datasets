### 2020年中国互联网网络安全报告

#### 无文件攻击技术分析

**1. Sodinokibi勒索病毒的无文件攻击方式**

Sodinokibi勒索病毒采用了一种复杂的无文件攻击方法，通过内存执行和PowerShell脚本实现。攻击者将恶意DLL文件（勒索病毒）反射式加载到PowerShell进程中，而不是从磁盘加载，从而绕过防病毒软件的检测。

- **攻击流程：**
  - 攻击者创建一个包含恶意DLL文件的字节数组。
  - 该字节数组被硬编码到PowerShell脚本中，并在内存中解密和执行。
  - 恶意DLL文件在PowerShell进程内存中自行执行，对受感染计算机的文件进行加密。
  - 攻击者删除指令文件，并要求用户支付赎金以解密文件。

- **技术细节：**
  - 内存执行：恶意代码直接在内存中运行，不依赖于磁盘上的文件。
  - PowerShell脚本执行：利用PowerShell的强大功能来执行恶意操作。
  - 多层脚本混淆加密：增加检测难度，提高攻击成功率。

- **示例：**
  - 图2-62展示了Sodinokibi勒索病毒反射式注入PowerShell的方法。
  - 图2-63展示了Sodinokibi勒索病毒的勒索界面。

- **攻击流：**
  - 构建执行PowerShell命令时的进程树上下文，存在多个PowerShell进程。
  - 禁用多项本地安全组件以协助加密本地文件。
  - 使用`vssadmin.exe`禁用Windows恢复和修复功能，删除卷影副本：
    ```shell
    "C:\Windows\System32\cmd.exe" /c vssadmin.exe Delete Shadows /All /Quiet
    bcdedit /set {default} recoveryenabled No
    bcdedit /set {default} bootstatuspolicy ignoreallfailures
    ```

- **总结：**
  - 内存执行
  - PowerShell脚本执行
  - 多层脚本混淆加密

**2. Phobos家族勒索病毒的无文件攻击方式**

Phobos勒索病毒同样使用无文件攻击技术，通过系统激活工具等诱使用户下载并安装恶意软件，进而实施比特币勒索。

- **攻击方式：**
  - 利用系统激活工具作为载体，诱使用户下载和安装。
  - 窃取用户机器信息，并通过特洛伊木马控制端服务器下载与勒索软件相关的加密程序。

- **无文件攻击特点：**
  - 多个且多层的PowerShell脚本。
  - 结合本地白名单工具，如WMI、DLL等。

- **样本分析：**
  - 第一层病毒代码伪装成“sheepskin”的PowerShell脚本。
  - 下载另一个PowerShell脚本`pps.ps1`，解密并释放Base64混淆的exe文件数据到`%userprofile%`目录。
  - 加载后，该exe文件开始实施对受害者计算机信息的盗窃，并进一步通过特洛伊木马下载加密的勒索相关文件。

- **示例：**
  - 文件加密后，Phobos勒索病毒添加特定后缀，如`id[XXXXXXXX-2275].[PI:EMAIL].help`，其中`XXXXXXXX`是磁盘序列号。
  - 在受害计算机的桌面目录和磁盘根目录中释放名为`info.hta`和`info.txt`的文件，显示勒索信息。
  - 图2-65展示了Phobos勒索病毒执行的脚本解析情况。
  - 图2-66展示了Phobos勒索病毒多层释放病毒主体的过程。
  - 图2-67展示了Phobos勒索病毒的勒索信示例。

- **总结：**
  - PowerShell脚本执行
  - 多层脚本混淆加密

#### 新冠肺炎疫情相关网络攻击事件专题分析

2020年，新冠肺炎疫情成为全球最热门的话题之一，黑客和攻击组织利用这一持续性的热点事件，对国家、企业和个人进行了持续的网络攻击。攻击类型包括勒索病毒、黑色产业链活动以及具有国家背景或组织背景的APT攻击。

- **整体攻击态势：**
  - 从2020年2月开始，恶意程序攻击事件迅速增加，在疫情较为严重的3月和4月达到高峰。
  - 从6月开始，随着我国疫情缓解，恶意程序攻击呈现下降趋势，并在下半年保持相对平稳。

- **攻击类型：**
  - 钓鱼攻击：利用新冠肺炎疫情相关官方通知、新闻资讯、政府文件、防疫建议等吸引目标下载并执行恶意代码。
  - APT攻击：多个APT组织以新冠肺炎疫情为主题开展攻击窃密活动。

- **具体案例：**
  - **钓鱼攻击事件：**
    - 2020年2月至3月，针对全球范围的钓鱼攻击激增，主要以“Covid19”“Covid”“mask”“CORONA VIRUS”“Coronavirus”“COVID-19”等为诱饵信息。
    - 谷歌公司每天拦截并处理1,800万封与新冠肺炎疫情相关的恶意电子邮件。
    - 相关钓鱼短信、钓鱼邮件以及钓鱼攻击关键词热度图如图2-70、图2-71、图2-72所示。

  - **APT攻击事件：**
    - **摩诃草组织（APT-C-09）：**
      - 主要针对中国、巴基斯坦等亚洲地区国家进行网络间谍活动。
      - 2020年1月，利用新冠肺炎疫情相关题材，冒充中国国家医疗主管部门、疾病预防部门对中国重要行业单位发起鱼叉攻击。
      - 通过钓鱼邮件投放国家卫生健康委员会仿冒页面链接，诱导用户打开附件，植入远控木马，实现远程控制和信息窃取。
      - 该攻击涉及我国近百个目标，涵盖政府、军工、医疗、科研院校等数十个重要行业单位。
      - 图2-73至图2-76展示了摩诃草组织的攻击示例。

通过以上分析，我们可以看到无文件攻击技术和新冠肺炎疫情相关的网络攻击已成为当前网络安全的主要威胁之一。加强防护措施和技术手段，提高用户的安全意识，是应对这些威胁的重要手段。