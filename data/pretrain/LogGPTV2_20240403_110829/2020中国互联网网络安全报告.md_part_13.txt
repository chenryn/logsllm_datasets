2020年中国互联网网络安全报告
链的整合。
攻击者使用上述模块将DLL文件（勒索病毒）反射式加载到PowerShell进程中，
该DLL是从内存而不是从磁盘加载的，这种绕过防病毒软件的规避技术是一种无文
件攻击方式。
攻击者创建了一个包含恶意DLL文件的字节数组，该文件反射式地将字节数组
加载并硬编码到脚本中，可以加密字节数组，并在内存中解密它，从而绕过反病毒
引擎。Sodinokibi勒索病毒反射式注入PowerShell的方法如图2-62所示。
图2-62 Sodinokibi勒索病毒反射式注入PowerShell的方法
（来源：亚信科技（成都）有限公司）
一旦此模块与PowerShell一起运行，恶意DLL文件将在PowerShell进程内存中自
行执行，并对受感染计算机的文件进行加密，然后删除一个指令文件，以要求用户
为解密加密文件支付赎金。
此勒索软件将勒索消息放在包含加密文件的文件夹中，文本文件的名称取决于
添加到加密文件的扩展名，并且是随机生成的。例如，如果扩展名为“.qv05z”，
赎金消息文件名将被命名为“qv05z-readme.txt”。
最终勒索软件对文件进行加密并更改桌面墙纸，还在被害者计算机上转储了一
个txt文件，向被害者提供如何为解密文件支付勒索费用的说明，如图2-63所示。
90
02 网络安全专题分析
图2-63 Sodinokibi勒索病毒勒索界面（来源：亚信科技（成都）有限公司）
③攻击流
首先，构建执行PowerShell命令时的进程树上下文，该勒索病毒将病毒代码反射
到PowerShell进程中，所以该进程树上下文中，存在多个PowerShell的进程，并且该
PowerShell还尝试禁用多项本地安全组件以协助加密本地文件，如图2-64所示。
图2-64 Sodinokibi勒索病毒进程树上下文（来源：亚信科技（成都）有限公司）
vssadmin.exe 在引导阶段使用以下命令禁用Windows恢复和修复功能文件生成的
进程命令行要删除文件的卷影副本，达到删除备份的目的：
“C: \ Windows \ System32 \ cmd.exe ”/ c vssadmin.exe Delete Shadows / All /
Quiet bcdedit / set {default} recoveryenabled No & bcdedit / set {default} bootstatuspolicy
ignoreallfailures
91
2020年中国互联网网络安全报告
④Sodinokibi勒索病毒无文件攻击技术总结
● 内存执行；
● PowerShell脚本执行；
● 多层的脚本混淆加密。
（3）Phobos家族勒索无文件攻击技术
该病毒使用诸如系统激活工具之类的软件作为载体，诱使用户下载和安装，窃
取用户的机器信息，并进一步通过Trojan控制端服务器下载与勒索软件相关的加密
程序并实施比特币勒索软件。
①无文件攻击方式分析
Phobos勒索病毒变体使用典型的无文件攻击方式：
● 多个且多层的PowerShell脚本；
● 结合本地白名单工具，例如WMI、DLL等。
②Phobos勒索病毒样本分析
该病毒使用诸如系统激活工具之类的软件作为突破，诱使用户下载运行，一旦
用户中招，则其伪装成“sheepskin”的PowerShell脚本的第一层病毒代码被运行。
该PowerShell下载另一个PowerShell脚本pps.ps1，pps.ps1将解密并释放病毒载体的
Base64混淆的exe文件数据到％userprofile％目录；加载后，该exe文件即开始实施对
受害者计算机信息的盗窃，并进一步通过特洛伊木马下载加密的勒索相关文件。这
类典型的无文件攻击方式不但降低被反病毒软件检测的风险，同时也大大降低样本
被截获后分析的风险，样本要么被删除，要么只有孤岛式的部分样本被截获，没有
分析的价值。
Phobos勒索病毒执行的脚本解析情况如图2-65所示。
92
02 网络安全专题分析
图2-65 Phobos勒索病毒执行的脚本解析情况（来源：亚信科技（成都）有限公司）
文件加密后，Phobos勒索病毒添加一个名为id[XXXXXXXX-2275].
[PI:EMAIL] .help的特定后缀，其中“ XXXXXXXX”是磁盘序列
号。同时，它将在受害计算机的桌面目录和磁盘根目录中以勒索信件的形式释放名
为info.hta和info.txt的文件。通过调用具有与info.txt相同的文本内容的info.hta程序，
发送标题为“您的所有文件已被加密”的对话框，其中包含病毒作者的联系信息和
比特币赎金付款方式。
Phobos勒索病毒主体文件在特定目录释放并运行勒索病毒，如图2-66所示。
93
2020年中国互联网网络安全报告
图2-66 Phobos勒索病毒多层释放病毒主体（来源：亚信科技（成都）有限公司）
Phobos勒索病毒运行释放到机器后，接下来开始遍历磁盘感染正常的exe文件，
将自身代码写入正常exe文件中。如果是白名单应该将不会被阻断。但是如果感染的
是脚本文件，大多数防病毒引擎目前的检测方式都不是非常有效。然后该病毒程序
结束运行，创建互斥量，以保证同一时间只有一个勒索进程在运行。
Phobos勒索病毒的勒索信示例如图2-67所示。
图2-67 Phobos勒索病毒的勒索信示例（来源：亚信科技（成都）有限公司）
③Phobos勒索病毒无文件攻击技术总结
● PowerShell脚本执行；
● 多层的脚本混淆加密。
94
02 网络安全专题分析
2.7
新冠肺炎疫情相关网络攻击事件专题分析
2020年，新冠肺炎疫情成为全球最热门的事件和话题，而黑客和攻击组织利用这
次持续性的热点事件，对国家、企业和个人持续进行网络攻击。攻击类型既包括逐利
的勒索病毒、黑色产业链活动，也包括具有国家背景或者组织背景的APT攻击。
本专题将结合CNCERT/CC监测数据、安全厂商提供的数据以及互联网公开
的威胁情报，对利用新冠肺炎疫情以及疫苗相关信息的网络攻击活动进行分析和
总结。
2.7.1 整体攻击态势
新冠肺炎疫情爆发后，黑客和攻击组织趁火打劫，持续发起网络窃密攻击，攻
击形势严峻，整体攻击态势在2020年4月达到全年高点。
CNCERT/CC监测2020年恶意程序传播次数按月度统计情况如图2-68所示，可以看
到从2020年2月开始，恶意程序攻击事件呈现出快速上涨趋势，在新冠肺炎疫情较为
严重的3月和4月，恶意程序攻击规模较大。从6月开始，随着我国新冠肺炎疫情的缓
解，恶意程序攻击呈现整体下降趋势，并在下半年保持相对平稳的态势。
单位/亿次
3.0
2.6
2.0
1.7
1.5
1.3
1.5 1.0
0.8
0.7 0.7 0.7
1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月
图2-68 2020年恶意程序传播次数按月度统计（来源：CNCERT/CC）
2020年木马或僵尸程序受控主机IP地址数量按月度统计如图2-69所示。木马或
95
2020年中国互联网网络安全报告
僵尸程序受控主机数量全年呈现稳定并且整体下降的趋势，在新冠肺炎疫情较为严
峻的3月和4月，木马或僵尸程序受控主机呈现出较高的规模，新冠肺炎疫情对现实
社会产生严峻影响的同时，也对网络空间秩序带来了较大的影响。
单位/万个
196.25
189.46
181.70
145.04
171.30 139.50
131.97 130.83 126.83 122.30 125.69
102.14
1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月
图2-69 2020年木马或僵尸程序受控主机IP地址数量按月度统计（来源：CNCERT/CC）
2.7.2 新冠肺炎疫情相关的网络攻击
2020年1月疫情爆发以来，围绕新冠肺炎疫情展开的网络攻击持续肆虐。这些
围绕新冠肺炎疫情展开的网络攻击来自APT组织、勒索团队以及其他黑色产业链组
织，它们利用前所未有的新冠肺炎疫情关注度，向各国的政府部门、卫生部门、研
究机构、医疗公司和教育机构等开展攻击。这些攻击集中在邮件钓鱼、网站钓鱼、
短信钓鱼、程序伪装、漏洞利用、僵尸网络等方面。
（1）钓鱼攻击事件
钓鱼（包括钓鱼邮件、钓鱼网站、诱饵文档或程序伪装等）作为低成本的攻击
方式一直被大量使用。黑客将恶意文件、钓鱼链接、诱饵文档等攻击载体伪装成为
新冠肺炎疫情相关官方通知、新闻资讯、政府文件、防疫建议等吸引目标下载并执
行恶意代码。
2020年2月至3月，随着全球新冠肺炎疫情进入爆发期，针对全球范围的钓鱼攻
击开始激增，钓鱼诱饵信息开始转变为多种语言，以“Covid19”“Covid”“mask”
“CORONA VIRUS”“Coronavirus”“COVID-19”等诱饵信息为主。谷歌公司在2020年
4月称，每天能拦截并处理1,800万封与新冠肺炎疫情相关的恶意电子邮件。相关钓鱼短
96
02 网络安全专题分析
信、钓鱼邮件以及钓鱼攻击关键词热度图如图2-70、图2-71、图2-72所示。
图2-70 相关钓鱼短信（来源：北京启明星辰信息安全技术有限公司）
图2-71 相关钓鱼邮件（来源：北京启明星辰信息安全技术有限公司）
97
2020年中国互联网网络安全报告
冠状病毒
新冠
coronavirus 健康
肺炎
大流行
预防
nCov 疫情 COVID
corona
COVID-19
武汉
图2-72 钓鱼攻击关键词热度图（来源：北京启明星辰信息安全技术有限公司）
（2）APT攻击事件
随着新冠肺炎疫情在全球蔓延，APT组织的活动似乎并未受到影响，反而频繁
借用新冠肺炎疫情热点事件为诱饵开展攻击活动。新冠肺炎疫情发生后，多个APT
组织以新冠肺炎疫情为主题针对我国展开攻击窃密活动。
①摩诃草
摩诃草组织（APT-C-09）主要针对中国、巴基斯坦等亚洲地区国家进行网络间
谍活动，其中以窃取敏感信息为主。
2020年1月，新冠肺炎疫情发生初期，该组织利用新冠肺炎疫情相关题材，冒
充中国国家医疗主管部门、疾病预防部门对中国重要行业单位发起鱼叉攻击，示
例如图2-73～图2-76所示。攻击者使用伪造的邮箱PI:EMAIL和
PI:EMAIL，以“国家卫生委员会发布了关于冠状病毒的指令”“关于
《国家卫生系统应急准备计划》的公告”等新冠肺炎疫情相关内容为主题，通过钓
鱼邮件投放国家卫生健康委员会仿冒页面链接，诱导用户打开仿冒页面，收集用户
姓名等信息，并投放名为“卫生部指令.docx”“申请表格.xlsm” “武汉旅行信息
收集申请表.xlsm”等包含恶意代码的电子表格和Word文档附件，诱导用户打开附
件，执行附件中的宏，植入后续远控木马，实现对受害用户的远程控制和信息窃
取。该攻击涉及我国近百个目标，涉及政府、军工、医疗、科研院校等数十个重要
行业单位。
98
02 网络安全专题分析
图2-73 攻击者模仿中国卫生健康主管部门国家卫生健康委员会的钓鱼邮件
（来源：CNCERT/CC）
图2-74 钓鱼邮件恶意附件“申请表格.xlsm” （来源：CNCERT/CC）
99