8 Related Work
Bitcoin was originally presented in [49] and since then was
thoroughly analyzed with regards to security, privacy and
beyond. A technical survey on decentralized digital curren-
cies, including Bitcoin, is available in [54], and systematiza-
tion if knowledge in this domain is provided by [22].
Hashrate-based double-spending attacks initially discussed
in [49] were analyzed in more detail in [52]. The ﬁrst com-
prehensive study on Bitcoin was presented in [20], which
considered such aspects as deﬂation due to capped amount
of bitcoins, forking the chain, malware attacks and scalabil-
ity. Further, the Bitcoin protocol was modeled in [48], and it
was shown that it reaches a Byzantine consensus. The core
10For comparison, Gura et al. [40] reported 0.81 sec for a
single 160-bit ECC multiplication on 8-bit CPU.
11Withdrawal transactions should reference corresponding
deposit transactions to prevent illegitimate withdrawals.
529of the Bitcoin protocol was analyzed in [36] and was proven
secure if the network is tightly synchronized and the adver-
sary’s hashing power is strictly less than 50%, but shown
that the adversarial bound decreases as the synchronization
gets looser.
Essential aspects of network synchronization and informa-
tion propagation were studied in [31, 33]. Eclipse attacks on
Bitcoin network were shown [41], which allow attackers to
perform n-conﬁrmation double spending attacks, selﬁsh min-
ing, and facilitate adversarial forks in the blockchain [41].
Closest to our interest are works [42, 17] which analyzed
double-spending attacks in the context of fast payments and
suggested countermeasures. However, they rely on online
detection of double-spending transactions appearing in the
Bitcoin network, and, hence, not applicable in oﬄine pay-
ment scenarios. Further, OtherCoin [34], TREZOR [50] and
BlueWallet [18] similar to us use secure hardware to pro-
tect Bitcion signing keys. However, their main purpose is
to protect private keys from malware or other attempts to
extract them, while we aim to limit access of bitcoin owners
to corresponding signing keys to prevent double-spending.
CoinBlesk [11] is a mobile Bitcoin payment solution suit-
able for fast payments. Similarly to our solution, transac-
tions in CoinBlesk are performed directly from the payer
to the payee (over NFC). However, diﬀerently from us, at
least one party requires online connection during transac-
tion, and, hence, the solution does not solve the problem
which we aim to address. Moreover, an idea of duplex mi-
cropayment channels initially introduced in the context of
Bitcoin contracts [4] was adapted in [32] for oﬀ-blockchain
payments with a goal to minimize amount of transactions
to be conﬁrmed by the network. The resulting solution can
be used for oﬄine payments, however, only for cases when
the payer and payee know each other a priory the payment.
Finally, Green Addresses solution [8] solves ”conﬁrmation
delay” problem by introducing a trusted third party, which
facilitates assured, zero-conﬁrmation transactions. Gener-
ally, Green Addresses provide an evidence that trusted third
parties can be accepted in Bitcoin ecosystem, but does not
solve a problem of oﬄine payments.
9 Conclusion
In this work we aimed to tackle a problem of secure pay-
ments with Bitcoins in scenarios where parties have no on-
line connection during the payment, or the connection is
available, but purchased items are released immediately af-
ter the payment, and before the transaction has been con-
ﬁrmed by the Bitcoin network. Our solution relies on an
oﬄine wallet residing on the platform of the payer. Such a
wallet can be instantiated diﬀerently, e.g., using secure hard-
ware or by means of utilizing deposit system. In this paper,
we investigated in details the ﬁrst approach. In particular,
we proposed new security mechanisms as building blocks,
provided their rigorous analysis and showed how they can
be integrated into payment processes. As a proof of con-
cept, we prototyped our solution for Android clients and
used a JavaCard to host an oﬄine wallet. Our implemen-
tation shows that smooth integration over a very prevalent
platform (Android) is possible, and that oﬄine and online
payments can practically co-exist. We further discussed sec-
ond deployment approach and outlined how the oﬄine wallet
could be instantiated using a wallet deposit system, which
is managed by the Bitcoin network itself and does not rely
on any external third parties.
10 References
[1] Android Bitcoin wallet. https://play.google.com/stor
e/apps/details?id=de.schildbach.wallet.
[2] Apple Pay payment solution.
http://www.apple.com/apple-pay/.
[3] Average electricity prices around the world:
USD/kWh. https://www.ovoenergy.com/guides/energ
y-guides/average-electricity-prices-kwh.html.
[4] Bitcoin contracts. https://en.bitcoin.it/.
[5] Blockchain taking years to download?
http://www.reddit.com/r/Bitcoin/comments/1pssvp
/blockchain taking years to download/.
[6] DOGE. http://dogecoin.com.
[7] Google Wallet: Shop. Save. Pay. With your phone.
[8] Greenaddress. https://greenaddress.it/en/.
[9] LTC. http://litecoin.org.
[10] The NIST authenticated NTP service. http:
//www.nist.gov/pml/div688/grp40/auth-ntp.cfm.
[11] Coinblesk, a mobile bitcoin payment solution, 2014.
https://github.com/coinblesk.
[12] Edgar Dunn & Company. Advanced payments report,
2014. http://www.paymentscardsandmobile.com/wp-c
ontent/uploads/2014/02/PCM EDC Advanced Pay
ments Report 2014 MWC.pdf.
[13] 10 best payment processors for Bitcoin for merchants,
2016.
https://toughnickel.com/personal-finance/Best-Pay
ment-Processors-for-Bitcoin-Bitcoin-for-Merchants.
[14] T. Alves and D. Felton. TrustZone: Integrated
hardware and software security. Information Quaterly,
3(4), 2004.
[15] E. Androulaki, G. Karame, M. Roeschlin, T. Scherer,
and S. Capkun. Evaluating user privacy in Bitcoin. In
Financial Cryptography and Data Security, 2013.
[16] M. Babaioﬀ, S. Dobzinski, S. Oren, and A. Zohar. On
Bitcoin and red balloons. In ACM Conference on
Electronic Commerce, 2012.
[17] T. Bamert, C.Decker, L. Elsen, R. Wattenhofer, and
S. Welten. Have a snack, pay with Bitcoins. In 13-th
IEEE International Conference on Peer-to-Peer
Computing, 2013.
[18] T. Bamert, C. Decker, R. Wattenhofer, and S. Welten.
BlueWallet: the secure Bitcoin wallet. In International
Workshop on Security and Trust Management, 2014.
[19] L. B˚angens and B. S¨oderberg. Mobile banking –
ﬁnancial services for the unbanked? 2008. http:
//spidercenter.org/polopoly fs/1.146036.1378747792!
/menu/standard/file/Mobile%20banking%20-%20fin
ancial%20services%20for%20the%20unbanked.pdf.
[20] S. Barber, X. Boyen, E. Shi, and E. Uzun. Bitter to
better – how to make Bitcoin a better currency. In
Financial Cryptography and Data Security, 2012.
[21] E. Ben-Sasson, A. Chiesa, C. Garman, M. Green,
I. Miers, E. Tromer, and M. Virza. Zerocash: Practical
decentralized anonymous e-cash from Bitcoin. In
IEEE Symposium on Security and Privacy, May 2014.
[22] J. Bonneau, A. Miller, J. Clark, A. Narayanan, J. A.
530Kroll, and E. W. Felten. Research perspectives and
challenges for Bitcoin and cryptocurrencies. In IEEE
Symposium on Security and Privacy, 2015.
[23] J.-P. Buntinx. 27 million more merchants can now
accept Bitcoin, 2016.
https://news.bitcoin.com/bitpay-enables-27-million-i
ngenico-retailers-accept-bitcoin/.
[24] V. Buterin. A next-generation smart contract and
decentralized application platform, 2014. https:
//github.com/ethereum/wiki/wiki/White-Paper.
[25] Certgate. Certgate products. cgCard. Texas
Instruments White Paper, 2012.
http://www.certgate.com/wp-content/uploads/2012/
09/20131113 cgCard Datasheet EN.pdf.
[26] D. Chaum. Blind signatures for untraceable payments.
In Advances in cryptology, 1983.
[27] D. Chaum, A. Fiat, and M. Naor. Untraceable
Workshop on Cryptographic Hardware and Embedded
Systems (CHESS), 2004.
[41] E. Heilman, A. Kendler, A. Zohar, and S. Goldberg.
Eclipse attacks on Bitcoin’s peer-to-peer network. In
USENIX Security Symposium, 2015.
[42] G. O. Karame, E. Androulaki, and S. Capkun.
Double-spending attacks on fast payments in Bitcoin.
ACM Conference on Computer and Communications
Security, 2012.
[43] S. King. Primecoin: Cryptocurrency with prime
number proof-of-work, 2013.
http://academictorrents.com/details/d0f9accaec8ac9d
538fdf9d675105ae1392ea32b.
[44] J. A. Kroll, I. C. Davey, and E. W. Felten. The
economics of Bitcoin mining or, Bitcoin in the
presence of adversaries. Workshop on the Economics
of Information Security, 2013.
electronic cash. In Advances in Cryptology, 1990.
[45] F. McKeen, I. Alexandrovich, A. Berenzon, C. V.
[28] K. Croman, C. Decker, I. Eyal, A. E. Gencer, A. Juels,
A. Kosba, A. Miller, P. Saxena, E. Shi, E. G. Sirer,
D. Song, and R. Wattenhofer. On scaling decentralized
blockchains (a position paper). In Bitcoin Workshop,
2016.
Rozas, H. Shaﬁ, V. Shanbhogue, and U. R.
Savagaonkar. Innovative instructions and software
model for isolated execution. In International
Workshop on Hardware and Architectural Support for
Security and Privacy, 2013.
[29] A. Cuthbertson. Bitcoin now accepted by 100,000
[46] S. Meiklejohn, M. Pomarole, G. Jordan, K. Levchenko,
merchants worldwide.
http://www.ibtimes.co.uk/bitcoin-now-accepted-b
y-100000-merchants-worldwide-1486613.
[30] G. Danezis, C. Fournet, M. Kohlweiss, and B. Parno.
PinocchioCoin: building Zerocoin from a succinct
pairing-based proof system. In PETShop, 2013.
[31] C. Decker and R. Wattenhofer. Information
propagation in the Bitcoin network. In IEEE
International Conference on Peer-to-Peer Computing,
2013.
[32] C. Decker and R. Wattenhofer. A fast and scalable
payment network with Bitcoin duplex micropayment
channels. In Stabilization, Safety, and Security of
Distributed Systems, 2015.
[33] J. A. D. Donet, C. Perez-Sola, and
J. Herrera-Joancomart. The Bitcoin P2P network. In
Financial Cryptography and Data Security, 2014.
[34] R. Dragomirescu. OtherCoin. 2013.
http://www.othercoin.com/OtherCoin.pdf.
[35] I. Eyal and E. G. Sirer. Majority is not enough:
Bitcoin mining is vulnerable. In Financial
Cryptography and Data Security, 2014.
D. McCoy, G. M. Voelker, and S. Savage. A ﬁstful of
Bitcoins: characterizing payments among men with no
names. In Conference on Internet Measurement
Conference, 2013.
[47] I. Miers, C. Garman, M. Green, and A. D. Rubin.
Zerocoin: Anonymous distributed e-cash from Bitcoin.
In IEEE Symposium on Security and Privacy, 2013.
[48] A. Miller and J. LaViola. Anonymous Byzantine
consensus from moderately-hard puzzles: A model for
Bitcoin. Technical Report CS-TR-14-01, University of
Central Florida, April 2014.
[49] S. Nakamoto. Bitcoin: A peer-to-peer electronic cash
system. Technical Report, 2008. http://www.vsewiki.
cz/images/archive/8/89/20110124151146!Bitcoin.pdf.
[50] M. Palatinus and P. Rusnak. Trezor, 2013.
www.bitcointrezor.com.
[51] D. Ron and A. Shamir. Quantitative analysis of the
full Bitcoin transaction graph. Financial Cryptography
and Data Security, 2012.
[52] M. Rosenfel. Analysis of hashrate-based
double-spending. In ArXiv Preprint: 1402.2009v1,
2012. http://arxiv.org/abs/1402.2009.
[36] J. Garay, A. Kiayias, and N. Leonardos. The Bitcoin
[53] S. Skorobogatov. Chapter 7: Physical attacks and
backbone protocol: Analysis and applications. In
Advances in Cryptology - EUROCRYPT, 2015.
[37] C. Garman, M. Green, and I. Miers. Decentralized
anonymous credentials. In Network and Distributed
System Security Symposium, 2014.
[38] A. Gervais, G. Karame, S. Capkun, and V. Capkun. Is
bitcoin a decentralized currency? In IEEE Security
and Privacy, 2014.
[39] Giesecke & Devrient Secure Flash Solutions. The
Mobile Security Card SE 1.0 oﬀers increased security.
http://www.gd-sfs.com/the-mobile-security-card/mo
bile-security-card-se-1-0/.
[40] N. Gura, A. Patel, and A. Wander. Comparing elliptic
curve cryptography and RSA on 8-bit CPUs. In
tamper resistance. In Introduction to Hardware
Security and Trust. Springer New York, 2012.
[54] F. Tschorsch and B. Scheuermann. Bitcoin and
beyond: A technical survey on decentralized digital
currencies. In Cryptology
ePrintArchive,Report2015/464, 2015.
[55] N. van Saberhagen. Cryptonote v 2.0, 2013.
https://cryptonote.org/whitepaper.pdf.
531