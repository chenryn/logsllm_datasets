55%
72%
85%
83%
5%
83%
82%
88%
<1%
51%
1%
2%
9%
6%
1%
11% <1% <1%
2%
22%
20%
8%
<1% <1% <1%
9%
16%
7%
5%
20%
8%
33% 10%
11%
<1% <1% <1%
10%
2% 12%
Table 2: Positive and negative indicators of feed pu-
rity. See Section 4.1 for discussion.
Most often with timing we care about how quickly a domain
appears in the feed after it appears in spam in the wild.
Unfortunately, all of the measures above presuppose the
existence of an ultimate “ground truth,” a platonic absolute
against which all feeds can be compared. Sadly, we have no
such feed: barring the challenges of even deﬁning what such
a feed would contain, the practical diﬃculty of capturing
all spam (however deﬁned) is immense. We can still gain
useful insight, however, by comparing feeds to each other. In
particular, for coverage and timing, we combine all of our
feeds into one aggregate super-feed, taking it as our ideal. For
proportionality, we measure the relative frequency of spam
domains in incoming mail seen by a large Web mail provider,
allowing us to compare the relative frequencies of domains
in a spam feed to their frequencies in a representative e-mail
feed.
In the remainder of this section, we evaluate the spam
domain feeds available to us (summarized in Table 1) with
respect to the qualities described above.
4.1 Purity
The purity of a feed is a measure of how much of the feed
is actually spam, rather than benign or non-existent domains.
Very simply, purity is the fraction of the feed that are spam
domains. We refer to these spam domains appearing in the
feed as true positives, and non-spam domains appearing in
the feed as false positives. Purity is thus akin to precision in
Information Retrieval or positive predictive value in Statistics.
The importance of purity varies from application to appli-
cation. If the feed is used to directly ﬁlter spam (by marking
any message containing a domain appearing in the feed as
spam), then purity is of paramount importance. On the
other hand, for a measurement study, where spam domains
are visited and further analyzed, low purity may tax the
measurement system, but generally has little impact on the
results once ﬁltered.
Operationally, the nature of the false positives matters
as well. While non-existent domains appearing in the feed
are merely a nuisance, benign domains can lead to highly
undesirable false positives in the ﬁltering context.
Table 2 shows several purity indicators for each feed. The
ﬁrst three (DNS, HTTP, and Tagged ) are positive indicators—
larger numbers mean higher purity. The last two (Alexa and
ODP) are negative indicators, with larger numbers meaning
lower purity.
4.1.1 Non-existent Domains
The DNS column shows the proportion of domains in the
feed that were registered, based on several major TLDs.
Speciﬁcally, we checked the DNS zone ﬁles for the com, net,
org, biz, us, aero, and info top-level domains between
April 2009 and March 2012, which bracket the measurement
period by 16 months before and 16 months after. Together
these TLDs covered between 63% and 100% of each feed. We
report the number of domains in these TLDs that appeared
in the zone ﬁle.
Blacklists, seeded honey accounts, and two of the three MX
honeypot feeds consisted largely of real domains (over 95%).
Human-identiﬁed spam and the hybrid feed were lower, at
88% and 64%, levels at which non-registered domains pose
little harm operationally or experimentally.
Two feeds—Bot and mx2—exhibit unusually low regis-
tration levels, however. Most of these relate to a single
phenomenon, a period of several weeks during which the Ru-
stock botnet was sending randomly-generated domains [19,
38]. Such bogus domains cost spammers nearly nothing to
generate, while costing spam ﬁlter maintainers and spam
researchers considerably more in dealing with them.
The HTTP column shows the fraction of domains in the
feed that responded to an HTTP request (with a code 200
reply) made to any of the URLs received from the feed during
the measurement period. Like the DNS registration measure,
HTTP responses indicate that a feed contains live URLs
(whether spam or not). Some amount of HTTP failures
are inevitable, and we see success rates in the 51% to 88%
range for most feeds, with the exception of the same two
feeds—Bot and mx2—discussed above.
4.1.2 Known Spam
An HTTP response still does not mean that a domain is not
a benign domain accidentally included in the list. To get at
the true spam domains, we turn to the Web content tagging
carried out in the context of the Click Trajectories project [18].
Recall from Section 3.4 that these are domains that lead to
storefronts associated with known online pharmacies, replica
stores, or software stores.
Such domains constituted 11–33% of domains in high-
purity feeds. Note that while these domains are less than
a third of all domains in a feed, they cover the bulk of the
spam by volume [18].
4.1.3 Benign Domains
Finally, the ODP and Alexa columns indicate the number
of domains in the feed that appeared in Open Directory
Project [27] listings and the Alexa top 1 million Web sites [1]
list. We expect that nearly all of these domains are benign,
and their appearance in a feed is erroneous.5
There are at least three reasons why a benign domain might
appear in spam. Benign domains may be included in a mes-
sage by the spammer. A phishing e-mail, for example, may
contain some legitimate links to the service being phished. In
some cases, a legitimate e-mail may be inadvertently sent to
a honeypot or honey account. For example, if an MX honey-
5While nothing prohibits a spam domain from appearing on the
Alexa list or in the Open Directory listings, these domains are
usually short-lived because their utility, and therefore use, is
reduced with domain blacklisting. We expect both lists to be
overwhelmingly composed of domains incompatible with spam
advertising.
431pot uses an abandoned, previously-used domain, it may still
receive legitimate traﬃc from its former life. A third cause
of benign domains appearing in spam are legitimate services
being used by the spammer as a redirection mechanism. By
using a URL shortening service, for example, the spammer
can evade domain blacklists by hiding behind an established
domain.
Using spam domain feeds to drive a production spam
ﬁltering system thus runs the risk of false positives. Because
blacklists are intended speciﬁcally for this task, they have
the fewest false positives: only 2% of domains in the uribl
feed, and less than 1% of dbl domains, intersected the ODP
and Alexa lists.
4.1.4 Removing Impurities
In the analysis ahead of us, these impurities skew the
results and thus obscure the picture. To better understand
the useful contributions of each feed, we remove all non-
responsive domains and all domains we believe are likely
benign. Speciﬁcally, for each feed, we take only the set of
domains for which we receive at least one successful HTTP
response and from this set remove all domains appearing on
the Open Directory and Alexa list. (These are the domains
listed in the HTTP column of Table 2 less those counted in
the ODP and Alexa columns.) We call these live domains.
In several instances, data collected by the Click Trajectories
project [18] allows us to see deeper into the nature of domain,
namely into the aﬃliate programs and aﬃliates behind each
domain. For this analysis, however, we are limited to the
set of tagged domains. We remove Alexa and ODP domains
from this set as well. Table 3 shows the number of distinct
domains of each type in the feed. In the remainder of the
paper, we state explicitly whether a measurement uses live
or tagged domains.
We have chosen to explicitly remove Alexa-listed and ODP-
listed domains from the set of live and tagged domains used
in the remainder of the paper. As discussed in Section 4.1.3,
live and even tagged domains may contain domains in the
Alexa and ODP listings. An otherwise benign domain may
be tagged if it is abused by a spammer as a redirection
mechanism, as noted above. Unfortunately, the stakes are
high when it comes to such false positives. These same Alexa
and ODP domains—comprising less than 2% of the domains
in a blacklist—are disproportionately more popular than
spam domains. Figure 3 shows the fraction of spam messages
containing such domains. In many feeds, these handful of
benign domains comprise as much as 90% of live domain
volume. Working at the granularity of registered domains,
even a single URL redirecting to a spam site can aﬀect the
standing of an entire domain.
Practitioners must take great care in choosing which do-
mains to blacklist and whether to blacklist each instance at
the registered name or ﬁner granularity. It is not the pur-
pose of this paper, however, to design the perfect blacklist
or blacklisting mechanism, and so we leave the question of
how best to deal with potential false positives without a full
and satisfactory resolution. For our analysis, we take the
conservative approach and remove such suspect domains.
4.2 Coverage
Roughly speaking, coverage is a measure of how many
spam domains a feed contains. In an operational context,
greater coverage—more spam domains—means more spam
ﬁltered. For a measurement study or system evaluation, more
spam domains means more comprehensive results. In this
section, we consider how coverage varies across our ten spam
domain feeds. But domains do not exist in a vacuum: they
are a projection of external entities into the domain name
system, and it is often these entities that are the object of
our interest. In the world of spam, these take the form of
aﬃliate programs and aﬃliates. In Section 4.2.3 we compare
feeds on the visibility they provide into that world.
4.2.1 Domains
Table 3 shows the number of live and tagged domains in
each feed in the Total column. Recall that live domains
are those that resulted in at least one successful Web visit
to a URL containing the domain, while tagged domains are
those for which the ﬁnal Web site is a known storefront
(Section 3.4).
In absolute terms, whether one considers live domains or
tagged domains, the largest contributor of unique instances
is the human-identiﬁed spam domain feed Hu, despite also
being the smallest feed in terms of absolute volume (see
Table 1). The reason for this coverage is undoubtedly that
this particular provider has hundreds of millions of accounts
and thus their customers are likely to be targets of virtually
any spam campaign. In turn, we believe that the reason
this feed has low volume is that as users identify e-mails as
“spammy” the included domains are used to ﬁlter subsequent
inbound messages. Thus, high-volume campaigns are unlikely
to have high representation in such a feed.
Clearly, if one had to choose only one feed to provide
maximum coverage, it would be that feed. Unfortunately,
outside large mail providers, such data is not widely available
to the research community. Instead, the readily-available
blacklists—dbl and uribl—are an excellent alternative, pro-
viding more tagged domains than any other feed besides
Hu.
So far, we have been comparing
Exclusive domains.
feeds in terms of their absolute coverage: the total number of
spam domains contributed. Given a choice of one feed, one
may well pick the largest one by this measure. A feed’s value,
however, may be in its diﬀerential contribution, that is, in
the domains it provides that are in no other feed. We term
domains that occur in exactly one feed exclusive domains.
Across our feeds, 60% of all live domains and 19% of all
tagged domains were exclusive to a single feed.
Table 3 shows number of exclusive domains provided by
each feed in the Excl. column. The relationship between the
numbers of distinct domains in a feed and the number of
exclusive domains is also shown graphically in Figure 1; the
left plot shows this relationship for live domains, and the right
plot shows it for tagged domains. In both plots, the x axis
denotes to the number of distinct domains on a logarithmic
scale, while the y axis denotes number of exclusive domains
in each feed on a logarithmic scale. Dotted lines denote ﬁxed
exclusive domain proportions. For example, the Hyb feed
lies just under the 100% line, indicating that most of its live
domains—just over 65%—are exclusive.
Figure 1 makes apparent that the Hu and Hyb feeds make
the greatest contribution in terms of the distinct number of
domains they contribute as well as the number of domains
exclusive to each feed. The number of tagged domains is
about an order of magnitude less in each feed than the
number of live domains, suggesting that spam belonging to
432All Domains
Live Domains
Tagged Domains