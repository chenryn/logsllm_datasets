其中，PFR有Intel的下游厂商支持和配合，Cerberus借助OCP社区的影响力，也获得了很多厂商的响应与认可；在我国等级保护2.0的合规性要求下，TPCM也有一定的部署激励与实践场景。
而Google
Titan，一直以谷歌云私有化部署的形态存在，缺乏对于社区和厂商的影响力，这对硬件安全方案的应用和迭代优化都会造成一定的阻力。出于竞争压力与社区博弈等因素，Google在近期将大部分Titan芯片源码进行了开源，也就是现在浮出水面的OpenTitan项目[5]。
OpenTitan公开了Titan芯片的大部分实现环节，在打造社区影响力和促进厂商合作的方面，较Intel和Microsoft可谓扳回一城。需要说明的是，OpenTitan当前开源部分的代码还不成熟[6,7]，某些环节涉及芯片加工商的专有制造工艺（如可信根部分的逻辑），在短期内也很难完全公开[8]，如图5所示。
图5 Titan方案的开源情况（绿色为完全开源）
如果后续OpenTitan可以促使这一实践的更多细节公开，使得企业用户可以更好地缩小其信任范围，那么OpenTitan的竞争优势将会进一步凸显——就目前来看，大厂的下一代解决方案都默认设置由大厂控制的可信根，与企业用户需要更灵活、开放的可信根配置能力的需求相矛盾，这一点会很大程度上影响使用者对于硬件安全方案的选择。
总的来看，下一代硬件安全防护方案仍待打磨，银弹并未出现。对于企业来说，目前还无法直接应用Cerberus、PFR、TPCM这些技术方案。Titan方案虽已开源，但仍处于相对初期的建设阶段，前文提及的挑战与局限，也不会因为Titan的开源而在短时间内得到解决。
## 5.防护体系的建设思路
那么问题来了，现阶段企业服务器硬件安全防护应该如何展开呢？换句话讲，对于大部分企业来说，是否可以暂时不付出主板重构的昂贵代价，实现x86服务器硬件安全防护的目标呢？
答案是肯定的。在笔者来看，这一目标的达成，可以与下述三个方面的工作紧密结合起来：
### 1、组合出击，化整为零。
即便是Titan和PFR方案，也没有清楚的解释如何校验Boot
Loader的合法性。由此我们不难发现，仅仅依靠单一方案，很难有效的兼顾所有硬件安全防护需求。
因此通过化整为零，合理地进行防护点的拆分，并在此基础上整合现有技术方案，其防护效果甚至优于单纯使用某一个“先进的”防护机制。
那么这里让我们盘点一些现阶段已成熟的硬件防护的技术：
BIOS WP：即基于寄存器实现的BIOS写保护，在Intel平台可以使能，AMD平台待确认。  
Secure Flash：保证BIOS、BMC固件更新进行时，新的固件镜像满足签名的合法性。  
Intel Boot Guard：通过签名校验的方式，保障BIOS启动最初阶段代码的完整性与合法性，类似技术还包括AMD平台下的PSB方案。  
UEFI Secure Boot：新固件标准UEFI下，通过校验签名，验证Boot Loader和Option
Rom合法性的检测方案，在Intel和AMD平台通用。  
TPM 2.0/TCM：使用兼容国密密码算法的可信计算芯片进行开机启动过程的静态度量，实现对于启动阶段固件的完整性校验，在Intel和AMD平台通用。
我们发现，这些方案可以满足对BMC、BIOS、Boot Loader实现局部的防护效果：或进行主动校验（Boot Guard），或采取被动度量（TPM
2.0/TCM）；或实施事前防护（BIOS WP、Secure Flash），或借助事后检测（UEFI Secure
Boot）。那么面对潜在的底层安全威胁，我们可以部署多个单点方案，从而形成一记组合拳式的纵深防护效果，最终建立起服务器平台端到端可信链条。
### 2.实时监控，运筹帷幄。
在Google和Intel的解决方案中，都涉及到OS启动之后，在硬件层面对与BIOS固件闪存（Boot FW
Flash）进行交互的指令流的持续性监控，这一点是Titan和PFR作为下一代平台解决方案的关键优势之一。
而Boot Guard、UEFI Secure
Boot这些方案，都是系统启动过程中进行防护，存在延迟性检测的弊端，也就是说，方案检测的实际效果很大程度上要取决于机器重启的频率。那么，在机器长期不重启的情况下，BIOS是否已经被篡改便不得而知，对于攻击者入侵行为的取证能力较弱，会让防御的一方在攻防对抗中变得被动。
实际上，可以将对于Boot FW
Flash的硬件层实时监控，调整为Runtime下的对于BIOS固件内容的（接近实时）周期性检测，一方面避免了硬件改板，以及总线监控不当引起的通信延迟；另一方面，由于OS层的计算资源更为丰富，数据分析方式更为多样，也可以获得更准确的分析效果。当然Runtime态的BIOS监控可能会存在一定的被绕过风险，但对于应对中低烈度的安全攻击，提升对于底层威胁的取证能力，有着重要的意义。目前我们团队也在服务器安全系统（洋葱）实践准实时的BIOS安全监控，也取得一定进展。
### 3.关注运营，见微者著。
企业服务器的规模数以万计，在部署硬件防护方案的时候，方案设计必须与部署运营紧密结合。见微者著，只有妥善处理好方案实施过程中的各项细节问题，硬件方案才能发挥真正的防护效果。
运营相关的具体实例太多，这里简述一二：
UEFI Secure Boot、Intel PFR、Google
Titan方案都是基于签名机制进行合法性校验的，在实际运营中，应该如何设计并导入证书？如何解决证书的过期与更新问题？如何保障相关运维工具的兼容性？如何确保上游厂商提供固件签名的正确性？如何评估启用方案之后对于正常业务的影响？这往往需要联动厂商、运维团队、业务团队各方进行适配改造与兼容性验证。
此外，TPM 2.0等方案借助哈希算法进行度量，如何保证运营过程出现异常的可解释性？使用哈希度量进行校验，也意味着需要Golden
Key作为基线进行对比参照，那么如何建立这样的基线，并在BIOS合法更新时进行基线的同步更新，也是安全运营过程中需要关注的重点。
又比如，在进行实时BIOS监控的过程中，如何利用离群分析和威胁情报进行数据关联，来识别高级入侵？如何消除由于厂商BIOS研发差异性而引起的监控误报？监控策略的普适性需要结合运营收敛，并得以不断优化。
## 6.写在最后
硬件安全防护的核心任务是实现安全启动，从而建设可信的服务器系统。腾讯安全平台部在服务器硬件安全体系建设方面，也在积极地开展方案研究、设计与部署应用。
目前，安平正协同公司服务器与供应链管理部、云产品部、云鼎实验室等多部门，并与上游多家供应链厂商的密切合作，力图打造国内首个服务器安全启动成规模部署用例，并借助服务器硬件安全规范，把控厂商供应链安全水平，提升公司研发环境与云上业务对于UEFI
Bootkit、供应链攻击等底层安全威胁的免疫能力。
此外，腾讯云推出的“星星海”自研服务器由安全平台部主导进行安全能力评估建设，目前已具备可信启动的硬件防护能力。
未来，安全平台部将会持续在这个领域进行相关研发和部署。
现阶段，在不进行硬件结构改造的前提下，有效整合现有防护技术，对于企业硬件安全水平的提升，不失为一种可行的解决思路。Google
Titan是下一代硬件安全厂商方案的标杆之一，虽然存在物理制造透明性、厂商驱动等局限，但在防护架构、实时监控、侧信道攻击防御等设计层面都有着重要的参考价值。
此外，硬件安全防护与传统的OS层防护一样，依赖运营质量的加持。只有充分落实对上游厂商的管控、自动化安全基线的建设、数据分析下的误报优化等关键环节，才能在这场关乎信任的攻防对抗中，立于不败之地。
参考文献：
[1] [Titan Silicon Root of Trust for Google Cloud. ](https://keystone-enclave.org/workshop-website-2018/slides/Scott_Google_Titan.pdf)  
[2] [Intel® Platform Firmware Resilience (Intel®
PFR).](https://edk2-docs.gitbooks.io/understanding-the-uefi-secure-boot-chain/looking_forward__platform_firmware_resiliency/intel_platform_firmware_resilience_intel_pfr.html)  
[3] [Project Cerberus Architecture Overview.
](https://github.com/opencomputeproject/Project_Olympus/blob/master/Project_Cerberus/Project%20Cerberus%20Architecture%20Overview.pdf)  
[4] 沈昌祥, 公备. 基于国产密码体系的可信计算体系框架. 密码学报. 2015 Jan 19;2(5):381-9.  
[5] [OpenTitan: Open Source Silicon Root of Trust.
](https://github.com/lowRISC/opentitan)  
[6] [OpenTitan Hardware Development Stages.
](https://docs.opentitan.org/doc/project/hw_stages/#indicating-stages-and-making-transitions)  
[7][ Hardware Designs Dashboard.
](https://docs.opentitan.org/doc/project/hw_dashboard/)  
[8] [Google Is Helping Design an Open Source, Ultra-Secure Chip.
](http://gerente.com/en-us/new-rss/google-is-helping-design-an-open-source-ultra-secure-chip/)