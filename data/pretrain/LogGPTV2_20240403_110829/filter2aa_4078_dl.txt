### 伙伴系统

#### 图 1-1.1 OSI 模型

OSI 模型为网络产品供应商提供了一个开放式的网络架构指南。这一标准或指南为开发新的协议、网络服务甚至硬件设备提供了通用的基础。根据 OSI 模型，供应商可以确保他们的产品能够与其他公司的产品集成，并得到广泛的操作系统支持。如果所有供应商都各自开发不同的网络架构，那么不同供应商的产品之间将几乎无法实现互通性。

#### 11.1.3 封装/解封装

基于 OSI 模型的协议采用了一种称为封装的机制。每一层从上一层接收到数据后，会添加一个报头（有时还会添加一个报尾），然后将数据传递到下一层。随着数据在每一层的封装，数据包的大小逐渐增加。当数据从应用层向下移动至物理层时，每层都会进行封装。相反，当数据从物理层向上移动至应用层时，每层都会进行解封装。

封装/解封装过程如下所示：
1. 应用层创建报文。
2. 应用层将报文传递至表示层。
3. 表示层通过向报文添加信息对其进行封装。通常只在报文的开始部分添加信息（称为报头），但某些层也会在报文结尾添加内容（称为报尾）。
4. 报文继续向下传递并被每层添加指定信息，直到到达物理层。
5. 在物理层，报文被转换为电子脉冲并通过物理连接传输。
6. 接收计算机从物理连接中截获这些比特，并在物理层重新创建报文。
7. 物理层将报文从比特转换为数据链路帧，并将其发送至数据链路层。
8. 数据链路层剥离信息，并将报文向上发送至网络层。
9. 解封装的过程一直持续，直到报文到达应用层。
10. 当报文到达应用层时，报文中的数据被发送至预期的软件接收者。

#### 11.1.4 OSI 分层

理解 OSI 模型每一层的功能和职责有助于理解网络通信的工作原理、攻击对网络通信的影响以及如何实施保护网络通信的安全措施。接下来的部分将从最底层开始逐一讨论每一层。

**记忆技巧：**
尽管有人认为 OSI 模型在实际中很少应用，且大多数技术人员并不经常使用它，但在 CISSP 考试中，OSI 模型及其相关概念仍然占据重要地位。为了掌握 OSI 模型，必须记住其七层结构。一种常见的记忆方法是通过每一层名字的首字母生成助记语，例如：“Please Do Not Teach Surly People Acronyms” 或 “All Presidents Since Truman Never Did Pot”。

### 1. 物理层
物理层（第 1 层）负责从数据链路层接收帧，并将其转换为可以通过物理连接介质传送的比特。同时，物理层还负责接收来自物理连接介质的比特，并将其转换为数据链路层使用的帧。

物理层包含多种设备驱动程序，告诉协议如何应用硬件来发送和接收比特。此外，物理层涉及电气规范、协议和接口标准，如 EIA/TIA-232 和 EIA/TIA-449、X.21、高速串行接口 (HSSI)、同步光网络 (SONET) 和 V.24 等。通过设备驱动程序和这些标准，物理层控制吞吐率、处理同步、管理线路噪音和介质访问，并决定使用数字、模拟或光脉冲信号在物理硬件接口上传输和接收数据。

工作在物理层上的网络硬件设备包括网络接口卡 (NIC)、集线器、中继器、集中器和放大器。这些设备执行基于硬件的信号操作，如从一个连接端口向其他所有端口发送信号（集线器的功能）或为了支持更长的传输距离而对信号进行放大（中继器的功能）。

### 2. 数据链路层
数据链路层（第 2 层）负责将来自网络层的数据包格式化为适合传输的格式。这种格式由网络硬件和网络技术决定，可能的形式包括以太网 (IEEE 802.3)、令牌环 (IEEE 802.5)、异步传输模式 (ATM)、光纤分布式数据接口 (FDDI) 和铜线分布式数据接口 (CDDI)。数据链路层内保留了一些技术特有的协议，这些协议将数据包转换为适当格式的数据帧。一旦数据帧完成格式化，就会被发送至物理层进行传输。

数据链路层内的协议包括：
- 串行线路网络协议 (SLIP)
- 点对点协议 (PPP)
- 地址解析协议 (ARP)
- 反向地址解析协议 (RARP)
- 二层转发协议 (L2F)
- 二层隧道协议 (L2TP)
- 点对点隧道协议 (PPTP)
- 综合服务数字网络 (ISDN)

在数据链路层上，数据帧会被添加源地址和目的地址。这些地址被称为介质访问控制 (MAC) 地址，是一种用十六进制表示法表示的 6 字节（48 比特）二进制地址（例如，00-13-02-1F-58-F5）。地址的前三个字节（24 比特）指示了物理网络接口的供应商或制造商，这被称为组织唯一标识符 (OUI)。OUI 由 IEEE 注册并控制发行。后三个字节（24 位）代表一个独特的数字，并分配给该接口的制造商。在一个本地以太网广播域中，没有两个设备可以具有相同的 MAC 地址，否则会发生地址冲突。因此，在私有企业网络中确保所有 MAC 地址都是唯一的是一种良好的实践。

**EUI-48 到 EUI-64**

MAC 地址是 48 位的，并已使用了数十年。类似的一种地址方案是 EUI-48，EUI 代表扩展的唯一标识符。对于 IEEE 802 标准，原始的 48 位 MAC 地址方案采纳了 Xerox 以太网地址方案。MAC 地址通常用于识别网络硬件，而 EUI 用于识别其他类型的硬件和软件。

IEEE 认为 MAC-48 已经过时，并倾向于弃用 EUI-48。目前，也有从 EUI-48 向 EUI-64 转换的趋势，这是为未来的全球 IPv6 普及做准备。