术。在今年双11中我们在稳定性、高性能网关、去堆叠以及25G、骨干网流量调度
平台、流量的精准评估、QOS优化和成本优化方面都取得了突破性的进展。
助力双11的重要网络技术
在稳定性的强化方面，在过去一年，阿里巴巴借助智能化手段，在故障的快速发
现、自动修复、自动变更、快速诊断的能力上都有很大的强化，使之轻松应对双11
流量高峰时的突发稳定性问题；在优化高性能网关方面，ANAT吞吐量性能16倍的
提升和LVS性能8倍的提升使阿里巴巴轻松应对ANAT转发网关的压力；4.2架构
支持去堆叠能力，提高了架构可靠性；25G技术在5.0网络架构开始规模化使用，在
存储计算分离和在线混布场景中也开始落地；骨干网流量调度平台做到了保底带宽、
延迟的优化等方面都有好的用户体验。
在过去一段时间内，阿里云水立方做到了基于应用维度、按时间维度、任意角度
的灵活运营流量精准评估能力。利用水立方预测双11业务流量和容量的分配，在端
136 > 9年双11：互联网技术超级工程
到端QOS优化方面，阿里巴巴在存储计算分离，在线离线存储混布场景，及交易、
支付等对用户体验要求较高场景中获得了更好的用户体验，保证相关的请求能得到优
先的传输。在成本优化方面，AGN2.0骨干网升级取得了很大的进展，自研光模块和
AOC的全面落地都使得整体成本得到很好的优化。
阿里巴巴是一个拥有百万级物理和虚拟网络设备、承载多样业务的遍布全球的统
一的物理网络。不同的供应商在不同时期、不同版本、不同架构的管理都是不同的，
我们需要付出更多的精力驾驭一个复杂的网络结构。面对大量级的物理和虚拟网络设
备时，如何用一套优化的工程方法去进行分析数据；如何基于这些数据在后期做快速
故障发现和定位；不同形态的业务对网络有不一样的需求，如何在兼顾资源利用率同
时达到用户体验很好的平衡；在面临业务波动频繁的情况下，如何自证清白；在这些
过程中如何快速完成综合处理……这些都是阿里巴巴需要解决的客观的工程难题。
上图呈现的是我们在2015年之后在网络稳定性提升方面的具体数据。从这张
图中可以看出，我们在15年到17年期间，稳定性得到了很好的优化。2017年P1
P2故障数对比2015年全年收敛了83%；P1 P2的故障数在十分钟内的恢复率对
比2016年也得到了很好的改善。2016年在10分钟内的故障恢复率为38%，而在
2017年则达到了72%。需要强调的一点是，阿里巴巴网络设备大幅度增长，而网络
新基础  9年双11：互联网技术超级工程
的大量的变更需求。这些就是我们在解决网络稳定性方面的整体思路。
当我们已经可以发现故障、定性故障时，通过监控系统和修复系统的快速联动完
成自修复，从而达成闭环，这就是阿里巴巴网络故障的自恢复。下图展示了网络自恢
复过程及其自动完成信息的对接和中间逻辑的判断。
网络自恢复相当于快速发现和修复两个模块的自联动的过程。当故障已经发生
时，如何做到“发现即被修复”？
网络自恢复主要有以下五部分构成：
端口/链路类异常自动隔离。
●
板卡类异常自动隔离。
●
运营商流量智能调度容灾切换。
●
堆叠分裂类异常自动恢复。
●
防火墙异常的自动切换。
●
后续会逐步加入更多的场景。随着场景的增多，到目前我们已经有60%以上的
风险隐患实现了自动化的处理，大大降低了故障问题处理的时长，实现了真正的故障
快速恢复，这也证明我们全面进入了自动化调度的时代。网络故障处理全面进入自动
新基础  9年双11：互联网技术超级工程
在自动隔离场景中，由于网络设备在运行过程中经常会出现故障，在快速修复之
前前，隔离是在网络工程师解决问题的首要工作。从图中可以看出，自动隔离功能上
线后，90%以上的隔离操作能自动完成，而且成功率高达95%，这样不仅省去了很
多的人工还规避了很多潜在故障。
基于北斗系统的“快速发现”
北斗故障识别智能引擎有在线日志实时分析、异常流量实时探测、告警收敛三大
模块帮助精准定位和发现。在线上我们每天要处理万亿级的数据信息，通过算法识别
出大概1亿条的基础事件，进一步识别后我们形成23万左右的复杂事件，对复杂事
件收敛形成300条左右的事件，其中有进30条左右被转化为工单。工单一般是通过
人工干预或无人值守自动化方式消化工单。
北斗故障识别智能引擎的工作流程主要分为四步：
利用庞大的数据采集系统，将N多维度数据实时从设备服务器中采集汇总；
●
在实时计算平台中利用各种机器学习算法和领域规则来完成基于场景的综合分析；
●
通过各种告警规则生成复杂事件；
●
新基础  9年双11：互联网技术超级工程
告警收敛
当收敛出几十万条异常事件后，如何进一步确定异常的来源？我们将网络的拓扑
加入在图计算引擎中。在对应一个时间窗口内，点亮所有产生告警信息的事件对应的
拓扑图结构上。当连续一段拓扑被点亮后，把它当做一个故障联通子图，利用智能化
算法对对应节点打分。通过rank值来确定出现故障设备源头。
新基础  9年双11：互联网技术超级工程
从图中可以看出，在2017年自动化变更上线后，变更引起的故障率有很大的降
低，50%以上的变更实现了自动化，人员的误操作概率降为0。可想而知，变更的优
化效率得到了很大的提升。
网络端到端智能快速诊断系统“庖丁”
在实际中我们经常会面临这样一个问题，某个地方丢包比较高或者两个点之间应
用出现了严重的超时，究竟是怎么引起的？如果用人工的方式进行定位，首先要解决
如何了解两个点之间端到端网络拓扑是怎样一种结构。拓扑上现在有故障在发生吗？
如果有，这些故障设备究竟产生了哪些日志、过程中是否有变更在进行？如果已经知
道是哪些设备为可疑对象，可能接下来对设备进一步下发命令、对数据做深入诊断，
整个过程大概需要1-2小时。
而庖丁可以同时进行网络拓扑发现、告警信息自动聚合分析、日志信息自动获
取、命令工具自动下发这四项工作，把整个复杂问题的定位时长从1-2个小时缩减