d
c
c
(
s
e
S
A
%
0.01
0.001
Backbone 2 2003-05-07, northbound
dst, exp(-(x/1e8)^0.25)
src, exp(-(x/1.5e6)^0.2)
0.0001
100
10000
1e+06
1e+08
1e+10
1e+12
0.0001
100
Traffic Volume of each AS (bytes)
10000
1e+06
1e+08
1e+10
1e+12
Traffic Volume of each AS (bytes)
Fig. 4. Ccdf for source and destination bytes per AS. D04N (left), D09N (right).
dir.0’s destinations and 2/3 of dir.1’s destinations favor these packet size modes.
Neither source IP cdf’s (Fig. 5 left, dotted lines) nor AS distributions (upper
right) have this property. Scans also impact packet counts per IP addresses,
resulting in large (20-40% for D04 and D09) fractions of destination IPs with
only one packet; the corresponding source counts are at most 20%. The impact
of scans on traﬃc volumes per preﬁx (Figure 5, middle panels) and AS (Figure
5, right panels) is negligible since they aﬀect only one preﬁx at a time.
The measures of Fig.3(b) (top: ﬂow density; middle: packets; bottom: bytes)
reveal the presence of scans in D08 diﬀerently. While demonstrating disparity
in ﬂow duration (by 7 orders of magnitudes) and the prevalence of mules [15],
they also have several strong spikes. Many scans send 2 or 3 SYN packets to the
same address, retransmitting after standard timeouts of 3 and 6 seconds. As a
consequence, many ﬂows (almost 12.4%) have duration around 9 sec (8.9-10.0)
and about 2.6% at 3 sec (2.81-3.16). Packet density has a spike at 9 sec, while
for byte density it is a barely visible bump.
Long tails. As shown in Section 3, the dominance of the contribution of the
largest sizes is a consequence of the heavy tail. Internet loads cover many orders
of magnitude, and the number of objects decays slowly.
We ﬁnd that traﬃc distribution per AS in traces D04 and D09 is closer to
Weibull (0.2-0.3) than to Pareto distribution (Figure 4), and even when its tail
is close to Pareto, α can be as small as 0.5 (Fig.4, left panel, source ASes))
which results in stronger bias towards elephants a Zipf distribution with the
same range would predict. In future work we plan to compare this result to the
Pareto approximation with α ∼ 1 for 5-minute preﬁx byte volumes in [5].
Diversity at ﬁxed percentiles. 95% of bytes in our data are sourced by fewer
than 8% and destined to fewer than 20% of IPs, preﬁxes, and ASes. We ﬁnd that
the fraction of IP addresses comprising any traﬃc percentile is always smaller
than the fraction of networks (preﬁxes, atoms, ASes); the fractions of networks
are usually close to each other. More details of the analysis are at [21].
Crossovers. Table 3 quantiﬁes the diversity/disparity of our data in terms
of crossovers. We ﬁnd that crossover splits are far more extreme than 80/20;
122
A. Broido et al.
100
80
60
40
20
100
80
60
40
20
dir0, src
dir0, dst
dir1, src
dir1, dst
100
80
60
40
20
dir0, src
dir0, dst
dir1, src
dir1, dst
dir0, src
dir0, dst
dir1, src
dir1, dst
0
10
1000
1e+05
1e+07
1e+09
1e+11
0
10
1000
1e+05
1e+07
1e+09
1e+11
0
10
1000
1e+05
1e+07
1e+09
1e+11
100
80
60
40
20
100
80
60
40
20
dir0, src
dir0, dst
dir1, src
dir1, dst
100
80
60
40
20
dir0, src
dir0, dst
dir1, src
dir1, dst
dir0, src
dir0, dst
dir1, src
dir1, dst
0
10
1000
1e+05
1e+07
1e+09
1e+11
0
10
1000
1e+05
1e+07
1e+09
1e+11
0
10
1000
1e+05
1e+07
1e+09
1e+11
Fig. 5. IP addresses (left), preﬁxes (center) and ASes (right) as traﬃc sources (dotted
lines) and sinks (solid and dashed lines). Object count cdfs over traﬃc volume (bytes
per object). D04 (ﬁrst row) and D09 (second).
in fact, almost all of them are in 90/10 range, and many exceed 95/5. This is
in particular true for IP addresses, for which the disparity is highest. Packets
disparity is usually higher than bytes’ for IP addresses, but it is comparable
for preﬁxes, atoms and ASes. Another property that also holds true for ﬁxed
percentiles is the position of atoms close to (often between) preﬁxes and ASes.
The analysis in [21] also shows small numbers of atoms and ASes responsible
for 50% of all traﬃc. In particular, the number of ASes responsible for half the
traﬃc is always under 20 for backbone traces D04, D08, D09. These properties
make atoms and ASes good candidates for use in traﬃc engineering [14].
5 Discussion
The phenomenon of size diversity/disparity has multiple causes. One cause
strongly suggested by our data is the variable amount of aggregation present
in the objects of the same taxonomic level. For example, traﬃc from an IP ad-
dress may be generated by a single person, but it can also come from a network
behind a NAT, potentially with thousands of addresses. Traﬃc toward an IP
address may be destined to one user or to a popular news server; in the latter
case the IP ﬂow incorporates millions of individual contributions transferred as
a single network news feed. A large AS with a large set of connected customer
ASes may have inherited many of them via mergers and acquisitions. The same
applies to other measures of wealth. The nature of the process shaping size dis-
tributions is a matter of debate dating back to Yule’s 1924 paper [23] (cf. [24].)
Indeed, no single model is likely to ﬁt all cases of size disparity, even if limited
Their Share: Diversity and Disparity in IP Traﬃc
123
Table 3. Crossover for D04 (left) and D09 (right). Bytes (top), packets (bottom).
N,src N,dst S,src
S,dst
IP 97.5/2.5 96.2/3.8 97.4/2.6 96.4/3.6
Pf 97.2/2.8 89.9/10 96.6/3.4 93.7/6.3
At 97.1/2.9 92.1/7.8 97.0/3.0 94.5/5.5
AS 97.4/2.6 92.3/7.7 97.1/2.9 95.1/4.9
S,dst
IP 93.8/6.2 95.7/4.3 94.7/5.3 95.8/4.2
Pf 94.7/5.3 90.2/9.8 94.9/5.1 93.7/6.3
At 95.3/4.7 92.0/8.0 95.6/4.4 94.3/5.7
AS 96.0/4.0 92.2/7.8 95.8/4.2 94.9/5.1
N,src N,dst S,src
S,src
S,dst N,src N,dst
IP 97.0/3.0 93.1/6.9 95.6/4.4 97.9/2.1
Pf 93.5/6.4 89.5/10.5 93.6/6.4 87.6/12.5
At 93.4/6.6 89.0/11.0 93.2/6.8 89.4/10.5
AS 94.1/5.7 91.1/8.9 93.9/6.1 90.8/8.9
S,src
S,dst N,src N,dst
IP 94.4/5.6 92.6/7.4 91.1/8.9 97.2/2.8
Pf 90.8/9.2 89.7/10.3 90.1/9.9 87.0/13.0
At 91.3/8.7 89.2/10.8 90.6/9.4 88.9/11.3
AS 92.8/7.2 91.3/8.7 91.9/8.0 90.6/9.4
to long-tailed size distributions. However, our prior work [25] presents evidence
that some long-tailed distributions can arise from multiplicative coalescence, a
process in which the probability of joining two objects is proportional to a power
of their sizes’ product.
6 Concluding Remarks
The rich hierarchy of categories used in IP traﬃc analysis yields many aggre-
gated measures that can serve as foundations for diﬀerentiating typical from rare
and extreme. Many of these measures are mutually exclusive, which can aﬀect
research conclusions unless the disjointness, in particular diversity/disparity and
similar phenomena, are explicitly considered.
In this paper we suggested size disparity as a unifying paradigm shared by
seemingly unrelated phenomena: burstiness, scans, ﬂoods, ﬂow lifetimes and vol-
ume elephants. We pointed out that in general an aggregated measure has a
meaning of node degree in some graph. We then discussed concentration proper-
ties of byte and packet measures aggregated by IP address, preﬁx, policy atom
and AS. We found that an attempt to faithfully quantify diversity/disparity in
Tier 1 backbone data leads to combinatorial explosion of the parametric space.
To reduce the description complexity, we introduced a mice-elephant boundary
called crossover. We showed that many IP traﬃc aggregation categories have
crossovers above the proverbial 80/20 split, mostly around 95/5. We also found
that the Pareto models, previously used for ﬁle/connection/transfer sizes [18]
and short-term preﬁx traﬃc volumes [5], require a signiﬁcant bent (α ∼ 0.5) to
account for the size disparity of aggregated and accumulated backbone traﬃc.
On the other hand, a Weibull distribution with shape parameter 0.2-0.3 can
serve as an alternative model for the tails of AS volume data.
Due to space limitations we could not include all analyses done for this study.
Our results, including geotraﬃc volumes, diversity of objects that contribute
over 1% of traﬃc, consumers of ﬁxed (50, 90, 95, 99) traﬃc percentile volumes,
124
A. Broido et al.
crossover fractions and cutoﬀs, volume of mice and distribution plots (all for
bytes and packets) are available at [21].
We intend to extend this study of ‘volume elephants’ to the ‘elephants of
stability’, i.e. ﬂows with low variation that are important for traﬃc engineering
[14] [5]. We plan to investigate disparity measures based on Shannon’s entropy
notion, and to ﬁnd which natural category of traﬃc aggregates can ﬁll the (two
orders of magnitude by packet or byte volume) gap between IP addresses and
preﬁxes. Finally we hope that crossovers, introduced here for the ﬁrst time,
will serve as a bridge between academic and operational parts of networking
community, combining a mathematically precise value on one side with a familiar
concept on the other.
Acknowledgements. Thanks to Dan Andersen and Ken Keys for keeping the
Backbone Trace Data Kit and analysis software in excellent shape, to Patrick
Verkaik for MPLS data, and to Khushboo Shah for dicussions of scans.
References
1. A.Shaikh, J.Rexford, Shin, K.G.: Load-sensitive routing of long-lived IP ﬂows. In:
SIGCOMM. (1999)
2. kc claﬀy: Internet traﬃc characterization (1994) Ph.D. thesis, UCSD.
3. N.Brownlee, kc claﬀy: Understanding Internet traﬃc streams: Dragonﬂies and
Tortoises. In: IEEE Communications. (2002)
4. K.Lan, J.Heidemann: On the correlation of Internet ﬂow characteristics (2003)
Report ISI-TR-574, www.isi.edu/trpublic/pubs/au-kclan.html.
5. Papagiannaki, K., Taft, N., Diot, C.: Impact of ﬂow dynamics of traﬃc engineering
principles. In: INFOCOM. (2004)
6. I.Graham, M.Pearson, J.Martens, S.Donnelly: Dag - a cell capture board for ATM
measurement systems (1997) wand.cs.waikato.ac.nz.
7. Endace: Measurement Systems (2004) www.endace.com.
8. C.Estan, S.Savage, G.Varghese: Automatically inferring patterns of resource con-
sumption in network traﬃc. In: SIGCOMM. (2003)
9. Odlyzko, A.M.: Privacy, economics, and price discrimination on the Internet. In:
ICEC ACM. (2003)
10. R.Mahajan, S.M.Bellovin, Floyd, S., J.Ioannidis, V.Paxson, S.Shenker: Controlling
High Bandwidth Aggregates in the Network. In: CCR. (2002)
11. Claﬀy, K., Braun, H.W., Polyzos, G.: A Parametrizable methodology for Internet
traﬃc ﬂow proﬁling. In: IEEE JSAC. (1995)
12. Broido, A., k claﬀy: Analysis of Route Views BGP data: policy atoms (2001)
Proceedings of NRDM, Santa Barbara.
13. Moore, D., Keys, K., Koga, R., Lagache, E., kc claﬀy: CoralReef software suite as
a tool for system and network administrators. In: Usenix LISA. (2001)
14. N.Feamster, J.Borkenhagen, J.Rexford: Guidelines for interdomain traﬃc engi-
neering. In: CCR. (2003)
15. Broido, A., E.Nemeth, kc claﬀy: Spectroscopy of private DNS update sources. In:
WIAPP03. (2003)
16. Korn, G.A., Korn, T.M.: Mathematical handbook for scientists (1968)
Their Share: Diversity and Disparity in IP Traﬃc
125
17. R.Knott: Fibonacci numbers and the golden section (2003)
www.mcs.surrey.ac.uk/Personal/R.Knott/Fibonacci/ﬁb.html.
18. Crovella, M.E., Bestavros, A.: Self-similarity in World Wide Web traﬃc. Evidence
and possible causes. In: IEEE/ACM Transactions on Networking. (1997)
19. W.Simpson: PPP in HDLC-like Framing. In: RFC1662. (1994)
20. D.Moore, Voelker, G., S.Savage: Inferring Internet Denial-of-Service Activity. In:
USENIX Security Symposium. (2001)
21. Supplement: (2004) www.caida.org/analysis/workload/diversity.
22. Broido, A., E.Nemeth, kc claﬀy: Internet expansion, reﬁnement and churn (2002)
ETT 13.
23. G.U.Yule: A mathematical theory of evolution. In: Phil. Trans. Roy. Soc. London
Ser. B, 213:21–87. (1924)
24. Mitzenmacher, M.: A brief history of generative models for power law and lognor-
mal distributions. In: Internet Mathematics. (2003)
25. A.Broido, kc claﬀy: Analysis of routing and topology data (2001)
www.caida.org/outreach/presentations/routingtopology2001/.