5.远程漏洞或intent schema url
6....
通常我们更关心木马、后门、间\*谍软件类的窃取人人的行为和信息的恶意代码。  
社交网络的渗透可以进行用户侧写，使话术更加完美。  
#### 案例：乌克兰
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115141615.png)
### 分析攻击思路与流程
1. 公开情报
2. 主动发现
国内未经授权的反制都是违法的
---
#### Android 高价值样本发现
溯源
复盘
场景
意图
#### Android证书分析
1.签名证书
2.时间
判断时间纬度，开发者在哪个时区，但不可信，可以被篡改、伪造
### 同源性检测
#### 家族同源性检测
1.恶意行为
2.攻击方式
3.攻击目标
- 地域
- 目标人群
- 特定行业
#### 资源同源性检测
1.控制域
- Whois信息
- 注册者
- 有效期
2.服务提供商及手机号
- 归属地
- 背景信息
3.邮箱
4.载荷
- 运行方式
- 关键行为
#### 文件
1.衍生物
- 可执行文件
2.程序资源文件
- 关键性界面布局
- 图片、音频和视频
- 核心文件
3.关键配置文件
4.文件大小
- 文件大小可以做参考，但不一定准确（但注意，威胁情报这快的一个原则就是，所有的信息都是不可信的，都需要进行交叉验证）
#### 代码同源性检测
1.程序名
2.签名证书
- 注意签名证书的时间，时区，判断其来源，但可伪造并不一定可信
3.核心流程
4.程序模块
5.编译信息
- 编译时间
- 编译器信息
6.作者信息
7.版权信息
8.文件大小
在分析代码流程时，最好移除第三方库，排除其他的关联。
#### 传播同源性检测
1.传播源
- 同域名
- 同手机
2.传播方式
- 短信
- 邮箱
- 网络推送
不要把第三方的二级域名等加入，这样溯源的关联会无限放大。
### 威胁情报平台
#### VirusTotal
国际最大的恶意代码库
https://www.virustotal.com/gui/home/upload
#### 安天insight （安天内部）
#### 微步在线
#### 360威胁情报平台
### 画像分析
#### 装机列表
// 安全行业的人，不要带着工作机去美国
- 身份、职业、性别、语言、偏好
- 设备类型：测试机、备用机、常用机
- **匿名通信、安全通信、VPN**
- **开发测试的木马**
#### IP轨迹
- 活动区域
- **V\*P\&N记录**
### CC信息分析
- 什么是CC服务器？
[链接](https://www.secpod.com/blog/command-and-control-servers-things-you-should-know/)
- 命令：nslookup, dig, whois
- 查询网站**（谨慎：线索泄漏）**：
	- http://domainbigdata.com
	- http://ipinfo.io
	- http://www.virustotal.com
- 搜索引擎查询
### 社交网络等
社交网络是一个比较方便的挖掘攻击者或组织身份的一个手段
#### 社交网络：
- Linkdin
- Facebook/Twitter
- Weibo
#### 搜索引擎
- Google cache
#### 网站历史记录
- archive.org
### 回溯分析
- 攻击的时间跨度
- 通过遗留的信息回溯可能的攻击者
  通过CC信息（Command&Control）回溯可能的攻击组织
- 通过语言、命名特点、时区
- 攻击技术和手法的演变、复杂度和拥有的资源
#### 难点
- IDC服务器，更换IP太过频繁
  - 域名历史记录&样本制作时间
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115152552.png)
### 国际网络军火库
在各个国家，对各个公司、组织进行侧写，方便以后快速进行定位和分析，需要依靠大量的数据
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115153302.png)
### [1]美国
分工明确、产业化做得比较好
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115153450.png)
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115153539.png)
### [2]俄国
### 综合
高度武器化
其中Xagent系列
### 知识库
#### 从威胁情报看移动威胁分析
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115154005.png)
### 主动发现
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115154201.png)
## 6. 机器学习应用
误差往往不能接受，所以不能直接应用，需要配合人工
### 文件相似性检测
将文件抽象成树、图，从而通过比较树的相似性（这快比较成熟）来判断文件相似性
有结点、有权值的树来判断，避免了特征库的膨胀。
[QS]如何抽象？
### 聚类分析
凡是可以量化，就可以聚类分析。
如何量化？如何提取特征？
每个APK对应成一个向量，从而简易地进行聚类分析。
前置条件：样本有限；过滤有效（白名单，去掉不参与计算的），不能全部样本参与；28原则，头部准确，尾部无效且占比大
### 随机性识别
信息熵：对我们司空见惯的“不确定现象”的数学化度量
转移概率，由于人类的特定习惯，导致一些惯用的现象产生
算出正常文本的两个符号之间的平均转移概率。
利用文件的平均转移概率 —— 判断机器产生的情况 —— 判断机器产生恶意签名
### 色情应用识别
内容风控
包名随机、程序随机，通过对图片等的识别 —— 来识别应用
D Hash 
Not suit for work Yahoo的一个色情内容识别库
https://github.com/yahoo/open_nsfw
### 扩展
扩： [IMP]目标侧写、与预计之间的偏差，情报工作需要进行大量的交叉验证，任何信息都是不可信的！
## 7. 基于样本运营的互联网风控（风控方面）
### 黑灰产现状
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115153822.png)
是个非常庞大的产业链，超过150W人
全控，QQ搜
### 领域
1.电商
2.视频
3.其他
### 工具
代理
隐藏真实IP
改机工具
更改串号
群控工具
根据指令执行对应操作设备农场
#### 黑化/行话
接码平台
猫池
卡商
养号
死粉/活粉/出粉
协议破解
设备农场/手机墙
### AVL的识别思路
![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200115154800.png)
- 应用 —— 装机列表 —— 设备指纹 —— IP
- 高 —————可信程度————— 低
风控部门，风险控制，置信区间
通过应用识别撞库、薅羊毛、代刷、网赚等，是一套乙方的风控体系
### 未来工作
1.设备指纹不可信/逐渐不可取
2.日志上传不及时
3.情报能力存疑
4.基础设置能力欠缺
---
1.SDK改造
网络状态识别
唯一标识符设计
特殊规则检出
2.扫描器研发
代理识别
VPN识别
生命周期验证（需要探活）
3.资源补充
接码接口（根据后台日志做碰撞，二次校验，交叉认证）
代理IP
黑卡获取
4.场景验证
## 8. 现状
### 海量设备应对
万分之三的误报率已经很低，但是基数很大
### 云与本地查杀
云适合消费场景，本地适合对安全要求高的场景
### 个体的价值
如何从个体的价值放大到高价值的云上
### 评价体系不一致
《移动互联网恶意代码描述规范》
中国互联网协会反网络病毒联盟
国外暂时没有统一的标准
### 木桶效应
互联网3G原则：girl， game，gamble
用户对提醒不在乎，中过病毒的人，反倒更可能再次中（使用习惯等原因）
信息泄漏（和社工结合危害更大
### 攻击过程专业化
国家力量的加入
### 攻受不对称
只能看见子弹打中了人，但不知道弹道、武器等
## Reference
### 学习资源
\[1][链接1](https://www.k0rz3n.com/2019/03/19/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E6%A6%82%E5%BF%B5%E4%B8%8EAPT%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%BF%B0/)
\[2][链接2](https://www.google.com/search?sxsrf=ACYBGNTwLAVG06NvPj2R_4wMdv81k5y6-Q%3A1579058601026&source=hp&ei=qIUeXoy0PKuymAW0rr_wCg&q=%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E7%9A%84%E5%9B%B0%E9%9A%BE%E9%87%91%E5%AD%97%E5%A1%94&oq=%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E7%9A%84%E5%9B%B0%E9%9A%BE%E9%87%91%E5%AD%97%E5%A1%94&gs_l=psy-ab.3..35i362i39l10.2042.2042..2197...2.0..0.0.0.......0....2j1..gws-wiz.....10.P-7-oX7kiGY&ved=0ahUKEwiMqPfX04TnAhUrGaYKHTTXD64Q4dUDCAY&uact=5)