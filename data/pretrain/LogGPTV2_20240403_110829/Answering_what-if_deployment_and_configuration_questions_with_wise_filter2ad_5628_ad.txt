Time between the instance that BE receives the request forwarded by the FE and when the BE sends the response to the FE.
The response time for the request as seen by the FE (see Section 7.1). Response time is also our target variable.
Table 1: Features in the dataset from Google’s CDN.
F
D
C
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
F
D
C
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
Germany Original
Germany Predicted
0.0
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
0.0
0.0
Response Time (Normalized)
(a) Germany
South-Africa Original
South-Africa Predicted
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Response Time (Normalized)
(b) South Africa
F
D
C
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0.0
0.0
Japan Original
Japan Predicted
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Response Time (Normalized)
(c) FE in Japan
Figure 8: Prediction accuracy: comparison of normalized response-time distributions for the scenarios in Section 7.4.
F
D
C
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0.0
0.0
0.1
Country == Germany
Country == South Africa
FE == JP
0.2
0.3
0.4
Relative Error
0.5
0.6
Figure 9: Relative prediction error for the scenarios in Fig-
ure 8.
(c) USE WHERE fe==jp
The ﬁrst two scenarios specify estimating the response-time distri-
bution for the users in Germany, and South Africa, respectively
(deu and zaf are the country codes for these countries in our
dataset), and the third scenario speciﬁes estimating the response-
time distribution for users that are served from FE in Japan (jp is
the code for the FE data center in Japan); this data center primarily
serves users in South and East Asia. We used the dataset from the
week of June 17-23, 2007 as our training dataset and predicted the
response time ﬁeld for dataset for the week of June 24-30, 2007.
Figures 8(a), (b), and (c), show the results for the three scenar-
ios, respectively. The ground-truth distribution for response time is
based on the response-time values observed by the monitoring in-
frastructure for June 24-30 period, and is shown in solid line. The
response time for the same period that WISE predicts is shown in a
dotted line. Further, in Figure 9 we present the relative prediction
Dataset
deu
zaf
jp
WISE
18%
12%
15%
AKM
55%
35%
38%
CSA
45%
120%
50%
Table 2: Comparison of median relative error for response-
time estimation for scenarios in Section 7.4.
error for these experiments. The error is deﬁned as |rt − brt|/rt,
where rt is the ground-truth value and brt is the value that WISE
predicts. The median error lies between 8-11%.
Comparison with TCP Transfer Latency Estimation: It is rea-
sonable to ask how well we could do using a simpler parametric
model. To answer this question, we relate the problem of response-
time estimation to that of estimating TCP-transfer latency, because
Google uses TCP to transfer the data to clients. Many parametric
models for TCP transfer latency are known; we have implemented
two recent models by Arlitt [2] and Cardwell [5] for comparison.
We refer to these methods as AKM and CSA, respectively. We
modiﬁed the two methods to account for the additional latency that
occurs due to the round-trip from the FE to the BE, and the time
that the backend servers take (be_time). AKM uses a compensa-
tion multiplier called ‘CompWeight’ to minimize the error for each
trace. We computed the value of this weight that yielded minimum
error. For the CSA scheme, we estimated the loss rate as the ratio
of number of retransmitted packets and the total number of pack-
ets sent by the server in each of the three scenarios. We used the
values of other model parameters that are correct to the best of our
knowledge for each trace.
Table 2 presents the median error for requests that had at least
one retransmitted packet in the response (srP > 1). The three
datasets had 3.0%, 57.0%, and 9.1%, sessions with at least one
retransmit, and the loss rates (calculated as described above) are
0.9
0.8
0.7
0.6
F
D
C
0.5
0.4
0.3
0.2
0.1
0.0
0.0
Ground Truth on July 16th
Ground Truth on July 17th
Predicted with WISE for July 17th
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Round Trip Time to FE (Normalized)
0.98
0.96
0.94
0.92
F
D
C
0.90
0.88
0.86
0.84
0.82
0.80
Ground Truth on July 16th
Ground Truth on July 17th
Predicted with WISE for July 17th
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14
Server Side Retransmissions Per Session (srP)
(a) Client-FE RTT
(b) Server Side Retransmits
0.9
0.8
0.7
0.6
F
D
C
0.5
0.4
0.3
0.2
0.1
0.0
0.0
Ground Truth on July 16th
Ground Truth on July 17th
Predicted with WISE for July 17th
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Response Time (Normalized)
(c) Response Time Distribution
Figure 10: Predicted distribution for response time and intermediary variables for the India data center drain scenario.
0.9%, 1.2%, 22.5%, and 3.2%, respectively. While the AKM
method does not account for retransmits and losses, the compen-
sation factor improves its accuracy. The CSA method models TCP
more faithfully, but it is not accurate for short TCP transfers. The
estimation error with WISE is at least 2.5-2.9 times better than the
other scheme across different traces without using any trace spe-
ciﬁc compensation.
7.5 Evaluating a Live What-if Scenario
We evaluate how WISE predicts the response-time distribution
for the affected set of customers during the scenario that we pre-
sented in Section 2 as a motivating example. In particular, we will
focus on the effect of this event on customers of AS 9498, which is
a large consumer ISP in India.
To appreciate the complexity of this scenario, consider what hap-
pens on the ground during this reconﬁguration. First, because the
FE in Taiwan is co-located with the BE, f ebe_rtt reduces to a typ-
ical intra-data center round-trip latency of 3ms. Also we observed
that the average latency to the FE for the customers of AS 9498
increased by about 135ms as they were served from FE in Taiwan
(tw) instead of the FE in India (im).
If the training dataset already contains the rtt estimates for cus-
tomers in AS 9498 to the f e in Taiwan then we can write the sce-
nario in two lines as following:
USE WHERE as_num==9498 AND fe==im AND be==tw
INTERVENE SET fe=tw
WISE uses the CBN to automatically update the scenario distribu-
tion. Because, f e variable is changed, WISE updates the distribu-
tion of children of f e variable, which in this case include f ebe_rtt
and rtt variables. This in-turn causes a change in children of rtt
variable, and similarly, the change cascades down to the rt variable
in the DAG. In the case when such rtt is not included in the training
dataset, the value can be explicitly provided as following:
USE WHERE as_num==9498 AND fe==im AND be==tw
INTERVENE SET febe_rtt=3
INTERVENE SET rtt+=135
We evaluated the scenario using the former speciﬁcation. Figure
10 shows ground truth response-time distribution as well as distri-
butions for intermediary variables (Figure 7) for users in AS 9498
between hours of 12 a.m. and 8 p.m. on July 16th and the same
hours on July 17th, as well as the distribution estimated with WISE
for July 17th for these variables. We observe only slight under-
estimation of the distributions with WISE—this underestimation
primarily arises due to insufﬁcient training data to evaluate the vari-
able distribution for the peripheries of the input distribution; WISE
was not able to predict the response time for roughly 2% of the
requests in the input distribution. Overall, maximum cumulative
distribution differences3 for the distributions of the three variables
were between 7-9%.
8. CONTROLLED EXPERIMENTS
Because evaluating WISE on a live production network is lim-
ited by the nature of available datasets and variety of events with
which we can corroborate, we have created a small-scale Web ser-