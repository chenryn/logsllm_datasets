MB的内存，而不受攻击的手机仅接收了16
MB的内存。这表明攻击者可以向受害者连续产生比特币垃圾信息流量。如果受害者正在使用蜂窝网络数据服务访问比特币网络，则他们必须为垃圾信息流量支付费用。第三，在实验结束时，攻击放大系数增加到3666左右。请注意，垃圾信息不必要的流量来自攻击期间所有全球比特币用户产生的新比特币交易。因此，当更多的用户使用比特币服务时，该系数可能会增加。
**2）功耗：** 处于和未处于10小时垃圾信息攻击之下的电话的功耗结果如上图d所示。结果表明，受到攻击的手机比没有受到攻击的手机消耗的功率多96％。
此攻击的主要特点是为攻击者提供新的攻击媒介，以向移动用户发起持续的垃圾信息流量，攻击成本低（每小时4.5
KB比特币消息），但是攻击破坏比成本要大（每小时14-20 MB）。受害人遭受了增加的移动服务费用和更短的智能手机电池寿命的困扰。
###  C.手机比特币钱包欺诈攻击
根据V3，在移动设备上开发了一个非P2P比特币钱包，以发起比特币欺诈攻击，该攻击会在未经用户同意的情况下将BTC秘密地从一个地址转移到另一个地址。使用非P2P钱包打破了比特币的分布式设计原则，该原则可以保护用户钱包。借助集中式服务模型，钱包服务提供商无需他们的批准即可轻松操纵其用户的比特币帐户。特别是，开发了非P2P比特币钱包智能手机应用程序MyBitcoin，其中包括客户端和服务器。客户端是一个简单的Android应用程序，为用户发送和接收BTC提供了简单的用户界面。该服务器支持比特币钱包和网络路由功能。
MyBitcoin客户端首先通过HTTPS与服务器连接，然后服务器又通过比特币协议与比特币网络连接。评估表明，MyBitcoin用户可以成功地将BTC转移到其他比特币地址，而不会出现任何问题。这证实了比特币网络没有采用其他安全机制来在实践中防止违反比特币去中心化。
由于用户通常会选择下载次数很多或评分较高的应用程序，因此可以积极地将这种恶意钱包应用程序推广给用户。分析了流行的比特币钱包应用程序Mycelium的下载后发现，一旦下载量大于1,000，下载量的增长率就会大大提高。在其他比特币应用程序上也有类似的观察。换句话说，如果攻击者可以将下载数量增加到一千以上，则预计会有更多的受害者下载应用程序。实际上，对于实现这一目标的攻击者而言，这在技术上并不具有挑战性。许多公司（例如MobiRink）提供促销服务，从而增加了应用程序下载量和对特定应用程序的正面评价。根据与这些促销公司的讨论，为特定应用程序增加500次下载和100条正面评论仅花费不到100美元。一旦受害者安装了恶意应用程序，他们将遭受各种比特币钱包欺诈攻击。但是，不幸的是，由于IRB的限制，无法开发真正的恶意比特币钱包应用程序并评估其对现实世界的负面影响。因此本文提供了对该比特币钱包欺诈攻击的详细分析，并将其与其他类型的欺诈攻击进行了比较，如下所示。
**与其他欺诈攻击的比较：**
这种攻击不需要复杂的攻击技术，但是与其他类型的金融欺诈攻击（1）手机移动银行欺诈攻击和（2）手机移动支付欺诈攻击相比，此攻击的负面影响是深远的。前一种攻击旨在获取受害者的用户名和密码，并通过部署伪造的移动银行应用程序（例如，Chsae是Chase应用程序的伪造版本）进一步窃取受害者的存款。后一种攻击旨在通过部署类似于Paypal，Venmo，CashApp的恶意在线支付应用程序，从受害者的银行帐户中窃取受害者的存款或未经受害者批准使用信用卡。从四个方面将设计的比特币欺诈攻击与这两种攻击进行了比较：（1）部署难度，（2）信用交易，（3）借记交易和（4）欺诈保护。
比较结果总结在上表中，有四个观察结果。首先，比特币钱包手机App欺诈攻击的部署难度低于其他攻击。对于手机移动银行欺诈攻击，伪造的移动银行应用程序（例如Chsae）需要通过由移动应用程序商店（例如Google
Play和Apple
Store）进行的检查。对于手机移动支付欺诈攻击，由于转账通常仅限于使用相同移动支付应用程序的用户，因此新的移动支付应用程序在短时间内拥有大量客户并不容易。其次，移动银行/支付欺诈应用程序的用户资金存入用户的银行帐户，而移动比特币钱包欺诈应用程序的用户资金存入攻击者的比特币地址。第三，所有这些攻击都能够在无需用户批准的情况下将受害者的资金转移到其他帐户。但是，移动银行和移动支付攻击对可转移金额有限制，而比特币钱包欺诈攻击则没有。此外，比特币钱包欺诈攻击可以阻止受害者接收有关欺诈交易的任何警报，但是，由于警报是由受害者的金融机构（例如，Chase，Citi）提供的，因此其他两种攻击无法实现攻击者的控制。第四，移动比特币钱包欺诈攻击的受害者不太可能将攻击者窃取的钱（即BTC），因为在许多国家，比特币不是受政府保护的资产，而其他两种攻击的受害者可能仍然拥有通过向银行提起争议来弥补损失的机会。例如，对于美国的信用卡用户，他们通常不需要通过提起争议来为异常交易付费。
## 0x05 Solution: Bitcoin Security Rectifier
本研究开发了基于电话的Bitcoin Security
Rectifier（一种App）来解决/缓解已发现的漏洞；这种方法不需要对现有的比特币协议标准，比特币钱包应用程序，库和钱包服务操作进行任何修改。此方法受两个因素设计。首先，修订比特币协议标准非常耗时，不太可能在短时间内将其存档并更新到整个比特币生态系统。其次，由于商业原因，比特币钱包应用服务提供商可能不愿意改变其当前的运营/设计。
**设计：** Bitcoin Security
Rectifier将检查所有传入和传出的比特币消息，并采取以下措施。对于V1，如果正在检查的比特币消息是外发的flliterload消息，它将首先将该消息保存到内存中，称为orig-filterload，然后创建一个副本并添加10*N不属于该用户的比特币地址到Bloom过滤器，其中N是用户已添加到orig-filterload的Bloom过滤器的比特币地址数。修改的flliterload消息称为modified-filterload。最后，modified-filterload将发送到比特币网络。使用这种方法，攻击者无法从受害者那里获得low-false positive-rate的Bloom过滤器（针对隐私泄漏攻击）。对于V2，Rectifier通过利用缓存的modified-filterload来检查带有Inv消息的比特币交易是否符合SPV客户的利益，并计算和监控实际的误报率。如果与FNC相关联的实际误报率高于先前配置的误报率，则Rectifier将强制SPV客户端与FNC断开连接，因为FNC可能已被攻击者滥用以发起垃圾信息攻击。对于V3，如果已启动比特币钱包应用程序，并且在预定义的时间段（例如5分钟）内未观察到比特币消息，则会向用户发送警告消息。
**执行：** 提出的Bitcoin Security
Rectifier是用Java编写的，并且是在Android智能手机上开发的。Rectifier由两个组件组成，即比特币消息抓取器和比特币安全整改器。比特币消息抓取器是一种轻量级的特定于比特币的抓取服务，该服务在智能手机的NetWorkPacktCapture
VPN
上实现，仅拦截比特币消息。对于其他类型的数据包集，它们将直接路由到目的地。比特币安全纠正会检查截获的比特币消息，并在需要时修改比特币消息。请注意，开发的Rectifier不需要root特权，但需要BIND_VPN_SERVICE的许可。
**评估：** 评估实验的设置如上图所示。首先，将Bitcoin Security
Rectifier安装在经过测试的智能手机上。其次，部署了一个服务器，以在为经过测试的智能手机提供服务的Wi-Fi网络上发起比特币去匿名攻击。第三，在经过测试的智能手机和与之连接的比特币全节点客户端之间部署了服务器，以发起比特币垃圾信息攻击。第四，在经过测试的手机上，安装了应用程序MyBitcoin来模拟比特币欺诈攻击。
评估结果如上图所示。对于比特币去匿名攻击，Rectifier可以拦截具有低默认误报率的Bloom过滤器，并通过添加不属于受害者的比特币地址来保护它（请参见图a
）。因此，攻击者无法准确推断受害者拥有的所有比特币地址。对于比特币垃圾信息攻击，图b显示Rectifier可以拦截收到的恶意比特币库存消息，对其进行检查，并与恶意比特币FNC断开连接。对于比特币欺诈攻击，图c确认Rectifier已成功检测到用户是否使用非P2P比特币钱包应用程序，并为用户提供了安全警告。
## 0x06 Conclusion
如今，Coinbase，Luno，Bitcoin
Wallet等比特币钱包App越来越受欢迎。在这项工作中，研究了10种最受欢迎的比特币钱包App的安全隐患。在这些研究的应用程序中发现了三个安全漏洞。通过利用它们，设计了三种概念验证攻击，攻击者可以利用这些攻击（1）对用户的真实身份，比特币地址和交易进行匿名处理；（2）向受害者引入持续的有害比特币垃圾信息流量；（3）启动比特币欺诈攻击以利用比特币钱包用户。分析表明，这些安全漏洞的根本原因是由于比特币钱包应用程序的不正确实施以及钱包服务提供商的运营失误。进一步开发了手机端的Bitcoin
Security Rectifier，以帮助用户防御已识别的安全威胁，而无需修改当前的比特币协议，基础设施以及钱包应用程序和服务。