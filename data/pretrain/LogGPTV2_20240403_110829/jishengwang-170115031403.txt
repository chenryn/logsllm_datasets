Deep Learning In Security: 
An Empirical Example in User & Entity Behavior Analytics (UEBA)
Jisheng Wang, Min-Yi Shen
 Jisheng Wang, Chief Scientist in Niara
• Over 12-year experiences of applying machine learning and big data technology to security
• Ph.D from Penn State – ML in security with 100GB data
• Technical Leader in Cisco – Security Intelligence Operations (SIO) with 10B/day• Lead the overall big data analytics innovation and development in Niara
 Niara
• Recognized leader by Gartner in user and entity behavior analytics (UEBA)
• Re-invent enterprise security analytics for attack detection and incident response
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 2
USER & ENTITY BEHAVIOR ANALYTICS
YOU 
ARE 
HERE
UEBA SECURITY why this matters 	UEBA SOLUTIONhow to detect attacks before damage is done BEYOND DEEP LEARNING how to build a comprehensive solution
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 	3
|  |  |
|---|---|
| SECURITY SPEND PREVENTION & DETECTION (US $B) |DATA BREACHES # BREACHES |
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 4
|  |  |
|---|---||  |  |
|---|---|
| ATTACKERS  ARE QUICKLY INNOVATING &  ADAPTING |BATTLEFIELD  WITH IOT AND CLOUD, SECURITY IS BORDERLESS |
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 5
|  |  |
|---|---|
| ATTACKERS  ARE QUICKLY INNOVATING &  ADAPTING |DEEP LEARNING SOLUTIONS MUST BE  RESPONSIVE TO CHANGES |
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 6|  |  |
|---|---|
| BATTLEFIELD  WITH IOT AND CLOUD, SECURITY  IS BORDERLESS |INSIDER BEHAVIOR LOOK AT BEHAVIOR CHANGE OF INSIDE USERS AND MACHINES |
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 7
USER & ENTITY BEHAVIOR ANALYTICS (UEBA) 
	MACHINE LEARNING DRIVEN 	BEHAVIOR ANALYTICS IS 
	A NEW WAY TO COMBAT ATTACKERS 	1 	Machine driven, not only human driven2 	Detect compromised users, not only attackers 	3 	Post-infection detection, not only prevention
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 	8
| REAL WORLD NEWS WORTHY EXAMPLES | REAL WORLD NEWS WORTHY EXAMPLES |  |
|---|---|---|
| 	COMPROMISED  40 million credit cards were stolen  from Target’s severs |	MALICIOUS  Edward Snowden stole more than 1.7 million 	classified documents |NEGLIGENT  DDoS attack from 10M+ hacked home devices took down major websites ||  |  |  |  |
|---|---|---|---|
| STOLEN CREDENTIALS |INTENDED TO LEAK INFORMATION |ALL USED THE SAME PASSWORD |9 |
| © 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |INTENDED TO LEAK INFORMATION |ALL USED THE SAME PASSWORD |9 |
USER & ENTITY BEHAVIOR ANALYTICS
YOU 
ARE 
HERE
UEBA SECURITY why this matters 	UEBA SOLUTIONhow to detect attacks before damage is done BEYOND DEEP LEARNING how to build a comprehensive solution
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 	10
| REAL WORLD ATTACKS CAUGHT BY NIARA | REAL WORLD ATTACKS CAUGHT BY NIARA |  |
|---|---|---||---|---|---|
| 	SCANNING ATTACK scan servers in the data center to find 	out vulnerable targets |	DATA DOWNLOAD  	download data from internal document repository which is not typical for the host |EXFILTRATION OF DATA upload a large file to cloud server hosted in 	new country never accessed before |
|  |  |  |  |
|---|---|---|---|
| DETECTED WITH AD LOGS |DETECTED WITH NETWORK TRAFFIC |DETECTED WITH WEB PROXY LOGS |11 || © 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |DETECTED WITH NETWORK TRAFFIC |DETECTED WITH WEB PROXY LOGS |11 |
|  |  |  |
|---|---|---|
| User 1 |User 2 |12 |
| © 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |User 2 |12 |
|  |  |  |
|---|---|---|
| User |Machine |13 |
| © 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |Machine |13 ||  |  |  |
|---|---|---|
| User – Before Compromise |User – Post Compromise |14 |
| © 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |14 |
|  |  |  |
|---|---|---|
| Dropcam – Before Compromise |Dropcam – Post Compromise |15 |
| © 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |15 |BEHAVIOR DETECTION ARCHITECTURE
| Apache Spark | Apache Spark | Labeled 
User 
Behavior 
Repository | Tensorflow | 16 |
|---|---|---|---|---|
| Input  Data |Stream Data Pre-processing |Labeled  User  Behavior  Repository |Behavior Anomaly 	Detection |16 |
| User  Activities |User  Activities |Labeled  User  Behavior  Repository |Behavior  Classifier |16 || Behavior  Encoding |Behavior  Encoding |Labeled  User  Behavior  Repository |CNN Training |16 |
| © 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential |Labeled  User  Behavior  Repository |CNN Training |16 |
CNN – COMPUTATION GRAPH
Behavior 
Image 
(24x60x9 
) Feature 
Maps 
(24x60x40) Feature 
MapsMaps 
(24x60x40) Feature 
Maps 
(12x30x40) Feature 
Maps 
(12x30x80) Feature 
Maps 
(6x15x80) 1024 
Nodes Output 
Layer
User 
Labels
8x20 
Convolution 2x2 
Pooling 4x10 
Convolution 2x2 
Pooling Fully 
Connected Fully 
Connected 
with Dropout
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential Feature Extraction Classification 17
|  |
|---|
| Training Error ||  |
|---|
| Training Error |
# of minibatches (100 profiles/batch)
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 18
USER & ENTITY BEHAVIOR ANALYTICS
YOU 
ARE 
HERE
UEBA SECURITY what is UEBA UEBA SOLUTION 
infrastructure needed to deep learning BEYOND DEEP LEARNING how to build a comprehensive solution
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 	19BEYOND DEEP LEARNING ENSEMBLE LEARNING
| Authentication 
AD logins | Internal Resource Access Finance servers | Remote Access VPN logins | 	Ensemble 
	approach using a 	mix of different 
	models over 
	various types of behaviors from the 	same entity |
|---|---|---|---|
| External Activity  C&C, personal email |Behavioral  Analytics |SaaS Activity Office 365, Box |	Ensemble  	approach using a 	mix of different  	models over  	various types of behaviors from the 	same entity || Cloud IaaS  AWS, Azure |Behavioral  Analytics |Physical Access badge logs |	Ensemble  	approach using a 	mix of different  	models over  	various types of behaviors from the 	same entity |
Exfiltration
DLP, Email
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 	20
BEYOND DEEP LEARNING REINFORCEMENT LEARNING 	Initial Parameters
| Input 
Data | Models | User 
Feedback |Data | Models | User 
Feedback |
|---|---|---|
| Self Learning |Models |Interactive Learning |
Context
Local 	Alerts
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 	21
|  |  |  |
|---|---|---|
| UEBA SECURITY what is UEBA |UEBA SOLUTION  infrastructure needed to deep learning |BEYOND DEEP LEARNING how to build a comprehensive solution |
© 2016 Niara Inc. All Rights reserved. Proprietary and Confidential 22Thank You