==== 序列
作为序列类图，自动配置的三个参数及默认的字段取值规则：
1. x轴：取第一个分组字段
2. y轴：取第一个统计数值
3. 分组（可添加多组）：取第二个分组字段
===== 曲线图[[line]]
曲线图主要用来展示数据相随着时间推移的趋势或变化。曲线图非常适合用于展示一个连续的二维数据，如网站访问量或平均负载的波动。在日志易中，用户可以选择数据集中相应的字段作为X轴、Y轴。
曲线图除了展示某个事件发展的趋势，还可以用来比较多个不同的数据序列。在日志易中，用户还可以选择数据集中代表序列标记的文本字段作为分组字段。例如，搜索语句如下：
[source,bash]
logtype:apache AND (apache.clientip:171.221.120.144 OR apache.clientip:121.236.143.48) | stats count() by apache.clientip, apache.request_path
针对以上搜索结果，点选曲线图，X轴字段自动配置为第一个分组字段，也就是“apache.clientip”，Y轴字段默认用第一个统计数值“count()”，分组字段默认用第二个分组字段“apache.request_path”：
image::images/line-default.png[]
可见以上图案不能很好的体现关于apache.clientip的数据特征，因此需要用户在输入搜索语句时注意输入字段的先后顺序，序列类图的字段在语句中的位置将直接影响x轴与分组字段。以上情况需要用户将分组与x轴参数对调，搜索语句改为：
[source,bash]
logtype:apache AND (apache.clientip:171.221.120.144 OR apache.clientip:121.236.143.48) | stats count() by apache.request_path, apache.clientip
从而更方便从请求路径和数量两个维度来观察两个IP的数据变化趋势，如下图，我们可以看出对网站路径，不同IP地址访客的访问偏好：
image::images/line-custom.png[]
即使不调整SPL语句，也可以通过手动调整X轴字段设置和分组字段设置来达到相同的效果。此外，X轴还有更细节的展示效果控制：
image::images/line-x-setting.png[]
* 旋转：可以选择对标签采用横排、竖排、斜 45°排等方式展示
* 数量：可以选择强制展示全部X 轴字段值，或者自定义展示间隔。
* 格式：可以自定义时间戳 X 轴标签的展示格式，可用定义为：`%Y/%m/%d %H:%M:%S.%L`。
+
上例截图中，我们就是针对一周数据按每十五分钟统计的结果，采用固定间隔半天的方式显示格式为"月/日 时:分"的 X 轴标签。
* 排序：对于可能出现乱序的统计数据，可以在X轴设置里，强制要求绘图之前再次排序
曲线图是两个数据点之间用线连接起来，为了追求美观或特殊的效果，还可以如上图将两点之间用曲线连接，这种图又叫平滑曲线图。平滑曲线图与折线图用法相同，只是每个数据点之间的绘制是曲线的。
在日志易中，点击设置，开启Y轴平滑选项即可：
image::images/line-y-setting.png[]
在日志易中，会尽力自动换算折线图Y轴的刻度范围，但用户依然可以自行指定自己所期望的Y轴刻度范围。上图中，就强制指定了Y轴最大值设置为500。
此外，用户还可以自行指定 Y 轴标记值的单位，比如"°C", "bps"等。字符最多不超过 4 个字节。
用户还可以定义 Y 轴序列值的数值精度，比如保留小数点后 2 位等。事实上，除了少数可视化效果如攻击地图，绝大多数可视化效果，都支持对展示的数值配置数值精度。
除了Y轴设置，图例的展示位置也可以按需调整。日志易支持三种方式：
* 不展示
* 底部展示
* 右侧展示
当图例在底部展示时，默认可以横向滚动选择。如果一行不足以展示全部图例，可以点击图例左侧出现的小按钮，展开更高的图例空间，方便一眼看完全部图例，再次点击重新收起。图例空间最高可以占用整个图形 50% 的高度。
在曲线图上标记提示信息是时间序列数据可视化的常用手段。日志易中，支持额外定义提示信息的查询语句，并配置提示时间和提示消息字段。当提示信息查询语句返回结果中，有具体时间和曲线图 X 轴时间对应时，曲线图上将出现相应的提示竖线。鼠标悬停时展示对应的信息内容。效果如下：
image::images/line-label.png[]
[TIP]
====
* 虽然可以展开查看，我们强烈建议不要绘制4条以上的折线，如下图错误的示例，线都折叠在一起并且又没有明显的对比，整张图表就会混乱并难以阅读。
image::images/line-toomany.png[]
* 展示曲线图的数据时，要避免刻意的歪曲趋势。如下图，左图过于扁平化掩盖了想传达的信息，右图过于夸大趋势。要根据展示数据波动的参考单位，做有意义的波动分析。正确的数据高度是线约占Y轴高度的2/3。
image::images/line-suggest.png[]
====
===== 面积图
面积图与曲线图很相近，都可以用来展示随着连续时间的推移数据的变化趋势。区别在于，面积图在折线与类别数据的水平轴（即X轴）之间填充颜色，形成一个区域面积，来表示数据体积。相对于折线而言，被填充的区域可以更好的引起人们对总值趋势的注意，所以面积图主要用于传达趋势的大小，而不是确切的单个数据值。日志易中，区域图的配置方式与折线图配置方式相同，您可以按需无缝切换成区域图模式：
image::images/area.png[]
[TIP]
====
1. 面积图要用填充区域来展示数据，当图表上有多个图层时，要尽量确保数据不要重叠。
2. 面积图适合用来展示二到三组数据，建议最多不要展示超过四组数据系列。数据系列过多导致无法数据辨识，因此要避免在需要比较多个类别和确切的数据值的情况下使用面积图。超过三个系列的非堆叠面积图表是很难阅读的。
3. 当数据值相距很远时，区域是模糊不清的，此时不太适合使用面积图展示。
====
====== 堆叠面积图
堆积面积图是一种特殊的面积图，可以用来比较在一个区间内的多个变量。堆叠面积图和面积图的区别在于，其每个数据系列的起点都是基于前一个数据系列绘制的的，也就是每度量一行就要填满行与行之间的区域。
如果有多个数据序列，并想分析每个类别的部分到整体的关系，展示部分量对于总量的贡献时，使用堆积面积图是非常合适的。例如显示某个设备对集群流量负载的分时贡献。
日志易中，您只需要在普通面积图的分组设置中，开启堆叠效果即可：
image::images/area-stack.png[]
[TIP]
====
1. 图表有重叠的数据时，类别数量越多，重叠越多，因此可见度越低。使用面积图时会因为相互重叠而无法阅读。这类数据，换成使用堆叠面积图展示，则相对更容易阅读。
2. 虽然多数据系列时堆叠面积图比面积图有更好的展示效果，但依然不建议堆叠面积图中包含过多数据系列，最好不要多于7个，以免数据难以辨识。
3. 堆积面积图要展示部分和整体之间的关系，所以不能用于包含负值的数据的展示。
====
===== 散点图[[scatter]]
散点图在直角坐标系显示数据的两个变量（X和Y轴）之间的关系，数据显示为点的集合，适合用于在不考虑时间的情况下比较大量的数据点。散点图通常用来识别两个变量之间的相关性或用来观察他们的关系，从而发现某种趋势，对于查找异常值或理解数据分布也很有效。
散点图会显示不同类型的相关性，相关性即变量之间的关系。通常有正相关、负相关、不相关三种相关性。
* 正相关：数据点从低x、y值的点到高x、y值，一个变量增加，另一个变量增加。
* 负相关：数据点从高x、y值的点到低x、y值，一个变量增加，另一个变量减少。
* 不相关：数据没有明显的方向性，一个变量变化对另一个没有影响。
image::images/point-suggest.png[]
需要注意的是，散点图能够有效的说明两个变量之间的相关性，但是并不能有力地证明其中存在因果关系。例如广告投放量和点击率是正相关的，但是不能说点击率高一定是因为广告投放量多造成的。但是，如果有明显的正相关性，就有足够的理由去增加投放量，然后再去观察数据。
在日志易中，散点图的配置方式与折线图配置方式相同，您可以按需无缝切换成散点图模式：
image::images/point.png[]
散点图可以设置气泡大小，选择字段，从而不同的字段值展示的气泡大小不同。
image::images/scatter-bubble.png[]
[TIP]
====
1. 如果一个散点图没有显示变量之间的任何关系，那么或许该图表类型不是此数据的最佳选择。
2. 散点图只有当你有足够多的数据点，并且数据之间有相关性时才能呈现很好的结果。如果你只有极少的信息或者数据间没有相关性，那么绘制一个很空的散点图和不相关的散点图都是没有意义的。
====
===== 柱状图
柱状图是最常见的图表类型，使用水平或垂直的柱子来显示不同类别之间的数值。柱状图的一个轴显示正在比较的类别，而另一个轴代表对应的刻度值。
日志易中，柱状图的配置方式与折线图配置方式类似，您可以按需无缝切换成柱状图模式。
image::images/bar.png[]
柱状图标签可以配置展示内容和位置，目前支持的位置包括：
* 柱状外上方
* 柱状内上方
* 柱状外左侧
* 柱状外右侧
* 柱状内中央
* 柱状内左侧
* 柱状内右侧
* 柱状内底部
[TIP]
====
Y轴数据应该从0基线开始，以恰当地反映数值。如果展示的是被截断的数据，那可能会误导观众做出错误的判断。
====
====== 分组柱状图
分组柱状图也被称为聚集柱状图。当两个或多个数据序列并排显示并在同一轴上的类别下分组时，将使用分组柱状图。相当于包含带有两个或更多图表的简单的柱状图。
分组柱状图通常是用于将分组变量或类别与具有相同变量或类别类型的其他组进行比较。像柱状图一样，每个柱的长度用于显示类别之间的数值比较。每个数据系列被分配一个单独的颜色或相同色系的不同饱和度，以区分它们，每组数据间相互间隔。
在日志易中，选择单个分组字段后的效果，将自动采用分组柱状图方式。比如：
image::images/bar-cluster.png[]
[TIP]
====
如果每个分组中拥有的系列过多，数据的阅读难度就会越增加，因此不建议在分组柱状图中包含过多的系列组。在系列较多时，可考虑使用堆叠柱状图。
====
====== 堆叠柱状图
堆叠柱状图是柱状图的扩展，不同的是，柱状图的数据值为并行排列，堆叠柱图则是一个个叠加起来的。它可以展示每一个分类的总量，以及该分类包含的每个小分类的大小及占比，因此非常适合处理部分与整体的关系。
与饼图显示单个部分到整体的关系不同的是，堆叠柱状图可以显示多个部分到整体的关系。例如一个班级体育课选课的各项目人数统计，你可以用柱状图或饼图展示，但是当需要进一步区分男生和女生参与到不同项目中的人数分别是多少，那就需要把每个项目中包含的男生数和女生数都展示出来。如图用堆叠柱状图，不仅能显示每个项目的总人数，还能分析每个项目中的一部分与整体的关系。
日志易中，可以点开柱状图分组设置，切换分组效果为堆叠效果(如果是 timechart 指令返回的数据，由于分组已经固定不可修改，堆叠开关在"展示"标签下设置)：
image::images/bar-stack.png[]
[TIP]
====
1. 堆叠柱状图不适合用于对比不同分组内同个分类数据的大小。
2. 最好的做法是每个组只使用两到三个类别，因为太多会使数据中的模式变得非常困难。
3. 由于要分析部分数据在整体中的占比，因此要避免用堆叠柱状图展示包含负数的数据。
====