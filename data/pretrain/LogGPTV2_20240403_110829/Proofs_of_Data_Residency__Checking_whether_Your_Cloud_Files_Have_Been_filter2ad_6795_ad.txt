15
20
25
Response Latency (ms)
(h) 512-byte blocks
(g) 256-byte blocks
(i) 1024-byte blocks
Figure 2: CDFs of response latencies incurred by P and A
in E-ResCheck with respect to diﬀerent block sizes.
taneously in an attempt to speed up the fetching time, evad-
ing the latency threshold. On the other hand, unnecessarily
small block size implies more blocks to be handled, resulting
in more involved housekeeping operations and extra storage
overhead incurred by the authentication tags. In this ﬁrst
set of experiments, we would like to conﬁrm the eﬀect of
block size on security of our constructions, and investigate
the optimal block size for eﬃciency.
We vary the block size from one to 1024 bytes and measure
the response latencies incurred by an honest prover P and
an adversary A. We report the results in Figures 1, 2 for
E-ResCheck and 3, 4 for N-ResCheck.
Figure 1 shows histograms of 1000 response latencies in-
curred by P and A in E-ResCheck, with respect to diﬀerent
block sizes. As can be seen, the block size has great implica-
tion on fetching time. To be more speciﬁc, when the block
size ranges from one to 32 bytes, the fetching times of P fol-
low a normal distribution with mean 12.93ms and standard
deviation of 0.73. As the block size increases, blocks are
more likely to span across physical sectors, increasing the
variance in fetching time. Figure 1f, 1g and 1h suggest that
the fetching times for blocks of sizes 128 to 512 bytes can be
classiﬁed into two groups, each follows a normal distribution
with diﬀerent mean (12.93ms and 19.03ms where block size
varies from 64 to 256 bytes, and 12.93ms and 21.52ms with
512-byte blocks). This is even worse when the block size is
increased to 1024-bytes. The fetching times for 1024-byte
blocks are divided into three diﬀerent groups (Figure 1i).
Recall that the fetching times are desired to be uniform, so
as to have a reliable latency assessment. Given such require-
ment, large block sizes (e.g. larger than 64 bytes) are clearly
not suitable for security in our protocol.
The response latencies of A follow a normal distribution,
with mean 19.58ms and standard deviation 2.71ms. For
blocks that are larger than 64 bytes, A splits them to 64 byte
9
150
100
50
0
P
A
20 25 30 35 40 45
Response Latency (ms)
150
100
50
0
P
A
20 25 30 35 40 45
Response Latency (ms)
150
100
50
0
P
A
20 25 30 35 40 45
Response Latency (ms)
(a) 1-byte blocks
P
A
150
(b) 8-byte blocks
P
A
150
(c) 16-byte blocks
P
A
150
100
50
0
20 25 30 35 40 45
Response Latency (ms)
100
50
0
20 25 30 35 40 45
Response Latency (ms)
100
50
0
20 25 30 35 40 45
Response Latency (ms)
(d) 32-byte blocks
P
A
150
(e) 64-byte blocks
P
A
150
(f) 128-byte blocks
P
A
150
100
50
0
20 25 30 35 40 45
Response Latency (ms)
100
50
0
20 25 30 35 40 45
Response Latency (ms)
100
50
0
20 25 30 35 40 45
Response Latency (ms)
(g) 256-byte blocks
(h) 512-byte blocks
(i) 1024-byte blocks
Figure 3: Histograms of response latencies incurred by hon-
est prover P and dishonest prover A in N-ResCheck with
respect to diﬀerent block size. P stores the blocks as-is in
its local drives, while A splits large blocks into 64-byte seg-
ments and stores all the data at remote storages.
segments and retrieves them in parallel in order to speed up
the fetching time. This explains why A’s fetching times for
large blocks are not divided into diﬀerent groups as those
of P. Comparing across ﬁgures, one can see that as the
block size increases, diﬀerentiating latencies incurred by P
and A becomes more problematic, potentially resulting in
higher false acceptance and rejection rates. It even seems
impossible when 1024-byte blocks are used.
To get a better intuition on the eﬀect of the block size
on the ability to distinguish P and A based on response
latencies, we show in Figure 2 CDFs of their response la-
tencies in E-ResCheck, also with respect to diﬀerent block
sizes. As the block size approaches 512 bytes, CDFs of P(cid:48)s
response latencies stop dominating those of A, suggesting
complications in distinguishing the latencies of the honest
prover from those of the adversary.
The eﬀect of the block size on the response latency in
N-ResCheck (depicted in Figure 3) is noticeable, but not
as evident as in E-ResCheck, for the response latency ob-
served by V is the accumulation of the fetching time and the
challenge-response transmitting time. The latter component
is almost similar for all the block sizes considered in our ex-
periments. The response latencies of P follow normal distri-
butions, with means ranging from 24.32ms to 30.34ms and
standard deviations varying from 1.81ms to 2.52ms. The re-
sponse latencies of A follow normal distribution with mean
approximately 31.22ms and standard deviations oscillating
around 3.18ms. Similar to E-ResCheck implementation,
distinguishing response latencies incurred by honest and dis-
honest provers in N-ResCheck becomes more diﬃcult as
the block size increases, and even impossible when the block
size reaches 512 bytes.
1
0.8
0.6
0.4
0.2
0
1
0.8
0.6
0.4
0.2
0
P
A
1
0.8
0.6
0.4
0.2
0
P
A
P
A
20 25 30 35 40
Response Latency (ms)
20 25 30 35 40
Response Latency (ms)
20 25 30 35 40
Response Latency (ms)
(a) 1-byte blocks
1
0.8
0.6
0.4
0.2
0
P
A
20 25 30 35 40
Response Latency (ms)
(b) 8-byte blocks
1
0.8
0.6
0.4
0.2
0
15 20 25 30 35 40
Response Latency (ms)
P
A
(c) 16-byte blocks
1
0.8
0.6
0.4
0.2
0
P
A
20 25 30 35 40
Response Latency (ms)
(d) 32-byte blocks
1
0.8
0.6
0.4
0.2
0
P
A
(e) 64-byte blocks
1
0.8
0.6
0.4
0.2
0
P
A
(f) 128-byte blocks
1
0.8
0.6
0.4
0.2
0
P
A
20 25 30 35 40
Response Latency (ms)
20 25 30 35 40 45
Response Latency (ms)
20 25 30 35 40 45
Response Latency (ms)
(h) 512-byte blocks
(g) 256-byte blocks
(i) 1024-byte blocks
Figure 4: CDFs of response latencies incurred by P and A
in N-ResCheck with respect to diﬀerent block sizes.
10−7
Enclave
Network
Enclave
Network
10−17
10−18
1
2
16
32
10−8
1
2
4
8
b (bits)
Enclave
Network
10−34
10−35
10−36
4
8
16
32
1
2
b (bits)
4
8
16
32
b (bits)
(a) c = 10%
(b) c = 20%
(c) c = 40%
Figure 5: Eﬀect of MAC length on false acceptance rate.
The audit size is set to v = 300 challenges, and late delivery
threshold (l) set to eight.
We demonstrate in Figure 4 CDFs of P and A’s response
latencies. Figures 4h and 4i especially show that CDFs of the
adversary’s response latencies dominate those of the honest
prover, implying it has signiﬁcant advantage in disguising
its response latencies and thus its behaviours as honest one.
From the results of this experiment set, it is apparent
that the block size has strong impact on the security of our
protocols. A too large block size would lead to failure in
detecting adversarial behaviours. We recommend the block
size of 64 bytes for both E-ResCheck and N-ResCheck,
and use this block size in all subsequent experiments.
7.3 Effect of MAC length (b)
In the second set of experiments, we vary c from 10%
to 40% and examine the eﬀect of MAC length on the false
acceptance rate ψ. The late delivery threshold is set to ﬁve,
and the audit size is 300 challenges.
Figure 5 shows the experiment results. ψ drops exponen-
tially – by at least an order of magnitude – when b increases
from one to four bits. To be more speciﬁc, ψ reduces from
10−7 to 10−8 when c = 10% in N-ResCheck or 3.8× 10−35
10
10−10
10−25
10−40
10−55
2
ψ γ
4
8
l
16
32
101
10−13
10−27
10−41
10−55
2
101
10−13
10−27
10−41
10−55
2
ψ γ
4
8
l
16
32
ψ γ
4
8
l
16
32
(a) c = 10%
(b) c = 20%
(c) c = 40%
Figure 6: Eﬀect of the late delivery threshold l on the se-
curity in E-ResCheck. MAC length is set to 16 bits, and
audit size is v = 300 challenges.
101
10−5
10−11
10−17
10−23
2
101
10−5
10−11
10−17
10−23
2
100
10−11
10−22
10−33
10−44
2
ψ γ
4
8
l
16
32
ψ γ
4
8
l
16
32
ψ γ
4
8
l
16