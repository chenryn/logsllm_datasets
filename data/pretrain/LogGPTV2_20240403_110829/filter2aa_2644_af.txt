data regardless of the tool used. There is always an inherent danger in network 
scans, particularly while a unit is running, but safe scans are feasible.  Usually it 
only takes controlling the speed of the scanning process to ensure an unintentional 
denial of service attack doesn’t occur. 
Device Targets 
Cyber devices that may be targeted for any industrial hardening project include 
but are not limited to clients, servers, PLCs, DCSs, HMIs and network switches.  
These are definitely not the only devices that need to be hardened, but they are 
devices that must not be missed.  Whatever targets are chosen, it is important to 
realize that each class of targets presents unique challenges and implementation 
dangers. Classifications combined with vulnerability data can play a key role in 
determining the order in which devices should be hardened.  These projects are not 
short lived or uncomplicated by any means. Speaking only in terms of orders of 
magnitude, a large power plant can have: 
• Upwards of 150 computers and servers associated with plant systems alone 
• Around 50 PLCs 
• Anywhere from 1 to 5 discrete DCS loops 
• Upwards of 100 HMIs 
• The total number of network switches varies greatly from plant to plant, 
usually only correlating with design effectiveness and management rather 
than plant size. 
It is a big project to harden the devices in an entire plant, and this is with the 
assumption the network is designed effectively.  This combined with the fact that 
due to the length of the project, some devices will have to be hardened while a unit 
is running.  Of course, the least critical devices should be chosen for this whenever 
possible, but a well analyzed risk to generation may be necessary from time to time. 
Discussion of how to address common device types is given in section  4.4.2.3 A. 
Industrial Cyber Security: From the Perspective of the Power Sector                                Page 37 of 65 
July 28th 2010 
Presented at DEFCON 18, July 29th through August 1st 2010, Riviera Hotel, Las Vegas NV 
Subject Matters of Hardening Efforts 
Subject matters of both baseline and device specific hardening projects may 
include, but are not limited to: 
• Surface area reduction (ports, programs, and services) 
• Configuration and security settings (GPOs, firewall rules, user and password 
policies, patch management, etc.) 
• Protection software (intrusion detection and prevention, virus protection, 
patch management, firewalls) 
• Communications (protocol use, encryption, authentication) and data 
hardening (encryption, compression, backup and restorations and data 
redundancy) 
• Maintenance (scheduled defrag, registry cleanup, etc.), hardware (locks, 
enclosures, redundancies, etc.) and physical security hardening. 
• Network architecture and segmentation 
• Replacing antiquated, non-vendor supported or high risk legacy systems 
Each subject matter presents unique challenges and implementation dangers 
and will be discussed in the following paragraphs, excluding the last the two which 
are discussed elsewhere. 
Surface area reduction (ports, programs and services) 
Reducing the amount of software and number virtual ports on devices makes 
them inherently harder to compromise. To give a physical analogy, a house is far 
harder for a burglar to compromise if it has no windows or perhaps bars on the first 
floor windows. The order of reduction needs to be first programs, then services and 
last ports. This is because programs make use of services and services and 
programs make use of ports. Going in any other order will negate work or make 
hardening profiles invalid or ineffective. Surface area reduction needs to be done 
systematically. Ideally, multiple iterations of (1) identify required ports, programs or 
services (2) determine which are not being used and remove (programs and 
services), deactivate (services or ports) or block (ports) (3) Provide a justification for 
all that remain.  
Identifying required ports, programs and services is fairly straight forward at first, 
if performed by someone familiar with the system, but may become more difficult as 
one progresses. This is where the use of simulators and drive images and 
virtualization can play a key role. Virtualization or simulation allows for removal, 
deactivation or blocking of one port, program or service to see what effects it has on 
the system.  If the effects are adverse, re-enable it and explain the adverse effects 
in the justification.  If no normal or emergency functionality is lost, it is probably safe 
to disable. All ports, programs and services that cannot be justified will need to be 
Industrial Cyber Security: From the Perspective of the Power Sector                                Page 38 of 65 
July 28th 2010 
Presented at DEFCON 18, July 29th through August 1st 2010, Riviera Hotel, Las Vegas NV 
removed. If an entire network is accurately virtualized, the results of this process 
may be reapplied directly to the device. 
Programs and services to remove will vary from device to device, but the 
following should be removed from all devices at a minimum (it is not an uncommon 
occurrence to find these in the field): games, messaging services (MSN, AOL IM, 
etc.), sample or demo software, unused document processing utilities, unused 
and/or insecure remote access software, unnecessary logic and software compilers, 
and any other programs or services identified as unneeded. Remember, everything 
that isn’t removed needs to be justified.  Justification is the only way to maintain 
compliance and knowledge concerning why a particular device has a particular 
configuration, especially as sites gain and lose employees over the life of the plant. 
Service removal often takes particular care and expertise. If it is unclear whether 
a service is needed or not, it must be fully tested in a lab environment. Once it is 
determined that a certain service is not needed, it should be fully uninstalled (not 
just deactivated) whenever possible. There are thousands of services running 
across many operating systems, refer to http://www.blackviper.com for a good 
explanation of typical services and a starting point for hardening profiles. 
All ports, regardless of the state (listening, established, etc) need to be disabled if 
they cannot be justified. Ports used for testing purposes only need to be disabled 
when not in use. Port closing is usually accomplished with a typical firewall, but 
there are other more specialized methods. 
Tools recommended to assist in surface area reduction without the consideration 
of vulnerability remediation include: Windows Task Manager, GPOs in an active 
directory, Windows control panel programs like add/remove programs and windows 
firewall, the Microsoft management console which can provide customized views of 
the devices configurations including services, programs and security settings, and 
third party tools like WinAudit or ConfigureSoft’s ECM. Introduction to these tools is 
outside the scope of this paper, but there are plenty of resources on the internet. It 
is recommended that an organization standardize on what tools are allowed to be 
used for this purpose, preferably limiting the total number of tools and maximizing 
the automation and scheduling capabilities. 
Security and Configuration Settings 
Security and configuration settings will always be operating system dependent. 
Even between versions of the same OS such as Windows XP and Windows 7 or 
between various patch levels or service packs, variations exist.  As a result, a 
baseline settings policy must be defined for each operating system.  This assumes 
all the operating systems on all the devices in a facility are patched to the same 
level (if not, update all patches prior to developing security and configuration policies 
to ensure work is not negated). 
Industrial Cyber Security: From the Perspective of the Power Sector                                Page 39 of 65 
July 28th 2010 
Presented at DEFCON 18, July 29th through August 1st 2010, Riviera Hotel, Las Vegas NV 
Settings can be viewed and changed locally, both manually using management 
consoles and semi-automatically using security templates or local group policy 
objects (LGPOs), but even though this may appear to be cost effective for an 
organization without an effective infrastructure, it turns out to be far more expensive 
in the near and long terms than simply implementing the appropriate infrastructure 
first. 
Precise definition and risk assessment of every security setting on every OS of 
every patch level is far outside the scope of this paper due to the massive data 
requirements. However, each OS manufacturer usually provides sufficient 
documentation to at least glean the purpose of most settings. Additional third party 
guides may prove to be highly useful; a recommended site to begin with Windows 
security settings which, in previous experience, has proven very useful is 
http://www.ultimatewindowssecurity.com/.  
The remainder of this section is dedicated to stating a few examples of important 
user management policies (to give the reader a feel for how to think about each 
policy) that can only be applied via these settings. It is not a comprehensive 
discussion; all settings should be analyzed, not just the most important ones.  
Use two factor authentication for local and remote login, particularly if the user is 
connecting through multiple zones or ESPs. Two factor authentication is based on 
selecting two out of three of the following for authentication: something you know 
(e.g. password), something you have (e.g. RFID card) or something you are (e.g. 
biometrics). 
When defining levels of access (i.e. user accounts) DO NOT use generic account 
names like admin or user and try to avoid shared accounts.  This leaves the system 
vulnerable, often only requiring an attacker to guess a password to obtain user or 
even admin rights. Do not use the same username as is used on the organizations 
enterprise networks or any username associated with an email account.  These tend 
to provide an easy method for an attacker to obtain a list of valid usernames. Ensure 
passwords are changed at most every 90 days and that no password is reused for a 
minimum of two years. No more than three unsuccessful login attempts should be 
allowed before the user is kicked and required to wait an appropriate period of time. 
Tools for applying settings where discussed above. 
Protection Software 
Protection software such as virus protection, intrusion detection and prevention, 
malware prevention and firewalls should always be included in a device’s profile if 
the device can take the software without adversely affecting the device’s 
functionality. This can be a challenge since a large number of process computers 
currently in use are old unsupported systems with obsolete hardware. There are a 
Industrial Cyber Security: From the Perspective of the Power Sector                                Page 40 of 65 
July 28th 2010 
Presented at DEFCON 18, July 29th through August 1st 2010, Riviera Hotel, Las Vegas NV 
few computers running plants that were built in the 1980’s. Devices such as these 
cannot handle modern protection software and using 20 year old virus software is 
pointless, so eventual system replacement is needed. Of course, it is not always as 
clear cut as this, and performance reports will probably be required to determine 
which devices can handle the added load of protection software.  Performance 
reports should take place over the course of a day to get an accurate report due to 
load variations, and this should be repeated over a few days. Variables to track may 
include CPU and memory usage, hard drive utilization, and network bandwidth 
usage. 
Virus protection software typically scans and continuously monitors activity on a 
computer, though continuous monitoring capabilities have proven thus far to be 
resource intensive. In most situations, it is usually recommended that process 
control computers only be fitted with the ability to scan for viruses at night or during 
similar low load times. Certain areas and access points should be continuously 
monitored by virus software, but this functionality should only be included on non-
process related devices whose sole purpose is security, such as devices used for 
the monitoring and control of ESPs. It is also worth noting that, even if all virus 
definitions are kept up to date the effectiveness of the software will change, but not 
necessarily degrade, with time. This is because the manufacturers tend to go 
through cycles in how effectively and comprehensive they roll out virus definitions. 
Some companies may miss a virus definition on occasion or funding may restrict 
their development. This is why it is key for an effective defense-in depth approach to 
layer security using mechanisms from more than one manufacturer. 
The difference between malware and a computer virus is not so clear to the 
laymen; often a virus can also be malware or malware can be a virus. To clarify this 
often over discussed distinction, malware is software designed for a malicious intent 
and a virus is designed to replicate itself, whether or not maliciously.  A virus 
typically has the ability to spread to other devices. There are other types of threats 
including adware (code written for the purposes of advertisement, often with little 
consideration for the users systems) and spyware (code written to secretly obtain 
information without authorization from the user). Malicious software prevention is 
used to detect, prevent, and mitigate introduction, exposure, and proliferation of 
malware on cyber devices.  Adware prevention is used to detect, prevent and 
mitigate the results of advertising code on computers (e.g. “popups”). Spyware 
prevention monitors continuously for eavesdropping attempts. Each type of 
protection software has its purposes; all should be used at some level of the 
process control network hierarchy, particularly at access points to ESPs. 
Recommended manufacturers for each type of protection software discussed above 
are as follows: 
• Virus prevention and protection: Recommended manufactures include 
Symantec, Trend micro, AVG, Avast, BitDefender and certain hardware 
Industrial Cyber Security: From the Perspective of the Power Sector                                Page 41 of 65 
July 28th 2010 
Presented at DEFCON 18, July 29th through August 1st 2010, Riviera Hotel, Las Vegas NV 
based virus protection devices such as the devices sold by Barracuda 
Networks. 
• Malware prevention and protection: MalwareBytes is highly recommended for 
this purpose. Most other manufactures discussed throughout this section 
include similar capabilities in their software, but they have not proven to be 
quite as effective, probably because MalwareBytes is solely focused on 
malicious software and not things like adware. 
• Adware prevention and protection: Ad-aware (highly recommended), 
MacAfee, Trend micro, windows defender and popup blockers. 
• Spyware prevention and protection: Ad-aware running in continuous 
monitoring mode, Windows system monitoring controls inherent in recent 
versions, and other software which continuously monitors for unauthorized 
information disclosure. 
Of course, the line between protecting against these classical types of threats is 
getting blurred with time because manufacturers are trying to account for all at once, 
though often unsuccessfully since each requires a unique approach.  Protection 
software needs to be analyzed to determine which classical threat definitions (as 
described above) the software can effectively mitigate. Caution is advised when 
selecting protection software, the internet is full of software posing as protection 
software but which is often highly malicious software (often called scareware). 
Intrusion detection and prevention software (IDPS) is focused on preventing, 
detecting, alerting and responding to potential unauthorized intrusion incidences or 
attempt at intrusion. Until recently, IDPS has been fairly experimental, however, it 
has now become an effective defense tool that should be included in any cyber 
defense arsenal, even though it is still somewhat experimental and requires a 
knowledgeable person to effectively operate and understand. Common detection 
methodologies include signature based, anomaly based, and stateful protocol 
analysis. For additional information on IDPS systems, refer to recommended NIST 
Special Publication 800-94, “Guide to Intrusion Detect and Prevention Systems 
(IDPS)”. Top five tools include Snort, OSSEC HIDS, Fragrouter, BASE and Sguil 
according to sectools.org. 
Firewalls are extremely useful for controlling communications, able to close 
virtual ports on demand. A firewall is only as good as its rules.  Firewall rules should 
be as specific as possible. Always consider source, destination, protocol use, ports, 
and services and programs. All ports should be disabled with the exception of the 
ports needed for normal and emergency operations.  All ports that remain open 
should be provided with a short justification for reasons already stated in previous 
sections. Effective firewall software is easy to come by, so vary the manufacture to 
help ensure a vulnerability in one firewall is not perpetuated throughout the network. 
Industrial Cyber Security: From the Perspective of the Power Sector                                Page 42 of 65 
July 28th 2010 
Presented at DEFCON 18, July 29th through August 1st 2010, Riviera Hotel, Las Vegas NV 
Communication and Data Hardening 
Communication hardening typically involves limiting protocol use, limiting open 
ports, authentication, encryption and data integrity. Authentication is critical to 
ensuring communications are going to and coming from an authorized source. Data 
hardening usually involves encryption, redundancy, off site redundancy, image 
comparators, automatic data restoration, corrupt data detection, RAID technologies, 
etc. Communication and data redundancy via redundant physical communication 
channels can also be effective strategies. Data redundancy of large generating 
facilities needs to be automated to be cost effective. 
Data redundancy requires a formal backup and recovery program to store and 
roll back configuration changes in case of failure, attack or compromise. Only one 
approach to backup and recovery should govern a single class of devices (e.g. PCs, 
DCSs) to minimize cost and confusion, though application across manufactures is 
also common (i.e. only one backup system using one type of backup media on a 
single device class or by manufacturer). Whatever system is chosen for a given 
device grouping, each will need a step-by-step backup generation, data validation, 
data restoration and data redundancy plan.  Safety needs to be a key part of the 
data restoration plan. Any time a backup is generated, validated or restored, an 
audit trail should be maintained and kept indefinitely. Data security is critical, and 
backup and backup storage systems should be treated as level one critical cyber 
devices. This is inherent against the classifications previously developed since a 
good backup system is robust, covers large areas of the network (breaking ESP 
boundaries) and often communicates off site for redundancy. 
Backup systems should be centralized, secured and at least partially automated 
to reduce cost and increase reliability. Manual backup processes are high cost, high 
risk and are not recommended. Any backup process, whether automated or manual, 
can easily overburden a control network and cause denial of services if not 
controlled properly, so incremental rollout and slow or incremental backup 
operations will be required. Transportation of backup media off site needs to be well 
controlled, protected and documented. All backups associated with a process 
control network should be categorized as:  SC process backup = (confidentiality, 
high), (integrity, high), (availability, high). 
Selecting the right backup media for a given backup system should be a formal 
process, considering current and future capacity, automation abilities, time to 
generate, time to restore, time to compare or validate, storage requirements, as well 
as reliability and security. Optical disks, secure EEPROMs such as Ironkey, 
magnetic tapes and disks, swappable drives, RAID drives and logical media like 
hard drive images all serve a purpose and present unique advantages and 
disadvantages. Ideally, a primary backup should remain on site and a secondary 
backup should be placed off site at a secure location.  On each device, separate 
data and the OS root drive on two physical drives; this is just best practice, helps 
Industrial Cyber Security: From the Perspective of the Power Sector                                Page 43 of 65 
July 28th 2010 
Presented at DEFCON 18, July 29th through August 1st 2010, Riviera Hotel, Las Vegas NV 
with system restoration and segmenting any damage caused by an attack. The 
majority of attacks focus on the root drive, so this tactic will save your data in most 
cases. 
Backup generation needs create backups that can suitably restore a system in 
worse case scenarios (i.e. total data loss). Logic, graphics screens, custom 
programs, device configurations. All level 1, 2 and 3 devices should have scheduled 
backup operations. If a valid backup is not on file, backups should be made before a 
new device arrives on site, before a change occurs and after a change occurs. 
Device backup files should be titled with the name or identifier of the device followed 
by the date and time for auditing purposes. 
Backup validation is the process of verifying a backup operation was successful 
and valid, verifying that a stored backup did not degrade with time, verifying that the 
backup represents the working configuration of the device. Backups need to be 