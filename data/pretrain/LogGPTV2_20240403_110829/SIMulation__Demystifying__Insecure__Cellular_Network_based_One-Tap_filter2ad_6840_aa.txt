title:SIMulation: Demystifying (Insecure) Cellular Network based One-Tap
Authentication Services
author:Ziyi Zhou and
Xing Han and
Zeyuan Chen and
Yuhong Nan and
Juanru Li and
Dawu Gu
9
5
0
0
0
.
2
2
0
2
.
5
0
4
3
5
N
S
D
/
9
0
1
1
.
0
1
:
I
O
D
|
E
E
E
I
2
2
0
2
©
0
0
.
1
3
$
/
2
2
/
1
-
3
9
6
1
-
4
5
6
6
-
1
-
8
7
9
|
)
N
S
D
(
s
k
r
o
w
t
e
N
d
n
a
s
m
e
t
s
y
S
e
l
b
a
d
n
e
p
e
D
n
o
e
c
n
e
r
e
f
n
o
C
l
a
n
o
i
t
a
n
r
e
t
n
I
P
I
F
I
/
E
E
E
I
l
a
u
n
n
A
d
n
2
5
2
2
0
2
2022 52nd Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN)
SIMulation: Demystifying (Insecure) Cellular
Network based One-Tap Authentication Services
Ziyi Zhou
Xing Han
Zeyuan Chen
Shanghai Jiao Tong University
University of Electronic Science
Shanghai Jiao Tong University
Shanghai, China
PI:EMAIL
and Technology of China
Chengdu, China
PI:EMAIL
Shanghai, China
PI:EMAIL
Yuhong Nan
Sun Yat-sen University
Guangzhou, China
PI:EMAIL
Juanru Li
Dawu Gu
Shanghai Jiao Tong University
Shanghai Jiao Tong University
Shanghai, China
PI:EMAIL
Shanghai, China
PI:EMAIL
Abstract—A recently emerged cellular network based One-Tap
Authentication (OTAuth) scheme allows app users to quickly sign
up or log in to their accounts conveniently: Mobile Network
Operator (MNO) provided tokens instead of user passwords are
used as identity credentials. After conducting a first in-depth
security analysis, however, we have revealed several fundamental
design flaws among popular OTAuth services, which allow an
adversary to easily (1) perform unauthorized login and register
new accounts as the victim, (2) illegally obtain identities of
victims, and (3) interfere OTAuth services of legitimate apps. To
further evaluate the impact of our identified issues, we propose
a pipeline that integrates both static and dynamic analysis. We
examined 1,025/894 Android/iOS apps, each app holding more
than 100 million installations. We confirmed 396/398 Android/iOS
apps are affected. Our research systematically reveals the threats
against OTAuth services. Finally, we provide suggestions on how
to mitigate these threats accordingly.
Index Terms—mobile security, mobile network operator, cel-
lular network, malware, SIM card based authentication
I. INTRODUCTION
Password-less authentication facilitates users especially
those smartphone users disturbed by remembering and in-
putting different passwords for various mobile apps. Recently,
a new type of authentication scheme, cellular network based
One-Tap Authentication (OTAuth in short), has rapidly
emerged. The OTAuth scheme allows smartphone users to log
in an account with just one tap on the screen. In particular,
when a user would like to log in an app with OTAuth
enabled, she simply launches the app and let it automatically
communicate with the Mobile Network Operator (MNO) that
manages the cellular network and distributes the SIM card.
During this process,
the phone must use cellular network
instead of a Wi-Fi network. Then the app prompts information
as Figure 1 shows, and the user just needs to click the “Login”
button (marked by the red box in Figure 1) to finish the
authentication and log in to her account.
As a representative instance of Mobile Connect [1], a univer-
sal digital identity service proposed by the Global System for
Mobile Communications Association (GSMA) [2], OTAuth is
(a) China Mobile OTAuth
(b) China Unicom OTAuth
(c) China Telecom OTAuth
Fig. 1: Examples of OTAuth interfaces in popular apps sup-
ported by different MNOs.
being adopted around the world [3]. Compared with traditional
schemes (e.g., password based or SMS based authentication),
OTAuth significantly simplifies the login process by reducing
more than 15 screen touches and 20 seconds of operation [4],
[5] each time.
login process,
More importantly, the use of OTAuth liberates the users
from creating and remembering a large number of login
credentials for multiple apps. While the use of OTAuth eases
the traditional
it also gives attackers more
convenience to circumvent user authentication. Intuitively,
the OTAuth process automates many steps of authentication
(e.g., password input) that are originally executed by the user
herself, and it is highly possible that malicious code could
abuse this feature to execute unauthorized behaviors. Unfor-
tunately, we seldom find a corresponding research against
OTAuth despite many recent studies focusing on other login
security issues in mobile apps such as vulnerable Auto-Login
functions [6], weak Push-2FA authentication schemes [7],
insecurely use of Android SMS One-Time Password APIs [8],
2158-3927/22/$31.00 ©2022 IEEE
DOI 10.1109/DSN53405.2022.00059
534
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:28:34 UTC from IEEE Xplore.  Restrictions apply. 
and flawed MNO SIM swap services [9]. Therefore, an in-
depth security analysis of the underlying mechanisms in
current OTAuth schemes are expected.
Our work.
In this paper, we conducted the first compre-
hensive investigation against OTAuth schemes that are widely
used by mobile apps. Particularly, as instances of this type
of scheme, we focused on world’s top 30 MNOs [10] and
investigated three OTAuth schemes supported by MNOs in
mainland China, namely China Mobile, China Unicom, and
China Telecom. These three MNOs have a total subscription
of more than 1.6 billion [10]. We recovered the design and
implementation details of them by reverse engineering apps
with OTAuth functionality and inspecting the corresponding
SDKs.
We abstracted the OTAuth schemes as a three-phase process
and analyzed its design flaws. We proposed a new attack,
called SIMULATION attack, which exploits a fundamental
design flaw of OTAuth we identified: During the authenti-
cation process, the remote (both MNO and app) servers could
not identify which app starts the authentication if the apps
are on the same smartphone. In SIMULATION attack, an
adversary could easily exploit this design flaw and bypass
the authentication scheme. Our attack only requires a local
malicious app without any privileged permission, or a ma-
licious device that shares the cellular network of the victim
smartphone (e.g., by connecting the Wi-Fi hotspot established
by the victim smartphone). A successful SIMULATION attack
directly leads to unauthorized login of various app accounts of
the victim user, and in many cases could be abused to query
user identities, register new accounts without user consent, and
interfere OTAuth services of legitimate apps.
To fully understand the impact of SIMULATION attack, we
conducted a large-scale measurement against 1,025 Android
apps and 894 iOS apps, all of which are highly popular in the
mobile app market. As of July 2021, each app holds more than
100 million installations. Among these top popular mobile
apps, we identified 396 Android apps and 398 iOS apps were
affected by SIMULATION attack. 17 of these affected apps
have more than 100 million Monthly Active Users (MAU)
and 230 of them have more than 1 million MAU in September
20211.
In addition, our research identified a total number of 23
SDKs (including SDKs provided by MNOs, as well as third-
party agents) that are affected by the SIMULATION attack.
Combining the analysis results of SDKs and apps, we have
also identified several additional implementation weaknesses
that can bring security risks to the OTAuth scheme, such as
insecure token usage, authorization without user consent, and
plain-text storage of sensitive information (see Section IV-D).
Lastly, we provide suggestions on how to mitigate such threats.
In a nutshell, this paper makes the following contributions:
• We uncovered several design and implementation flaws
of a new mobile login scheme, OTAuth, which has a large
usage and high popularity among real-world apps.
1 According to the statistical results of IiMedia Polaris [11].
• Exploiting the flaws of OTAuth scheme, we designed
several attacks in which an adversary can fully bypass
the authentication and perform malicious actions to the
target app.
• We performed a large-scale measurement to evaluate the
impact of these threats. To achieve this, we proposed
a pipeline that integrates both static and dynamic ap-
proaches for effectively detecting potential affected apps.
Our results showed that a large portion of highly popular
apps are vulnerable to the attacks (38.6% for Android
and 44.5% for iOS, respectively).
• We discussed feasible modifications to enhance the secu-
rity of the OTAuth scheme.
Ethical Considerations. The SIMULATION attack related
experiments were conducted using phone numbers and app
accounts of the authors, hence did not affect other users. We
have informed three affected MNOs through CNCERT/CC2 ,
the authority for vulnerability coordination in mainland China.
In the meantime, we provided solutions to help them fix related
issues. CNCERT/CC has verified our findings and related
vulnerabilities were documented under CNVD-2022-04497,
CNVD-2022-04499, and CNVD-2022-05690. All of them are
rated as high severity (scoring 8.3 out of 10 in CVSS 2.0).
II. BACKGROUND
In this section, we introduce the background knowledge
about One-Tap Authentication scheme, including its overview,
the protocol design, as well as the ecosystem of its usage in
mobile apps.
A. One-Tap Authentication (OTAuth) Scheme
One-Tap Authentication is essentially a third-party-based
authentication scheme supported by Mobile Network Oper-
ators, similar to other login options such as Single-Sign-
On [13]. For an app that integrates this service, the user can
log in to her app account with the local phone number of
the device with just one click. Here, the local phone number
specifically refers to the phone number that is bound to the
SIM card on this mobile device. More specifically, as one of
the login options, the app displays the masked local phone
number of the device (e.g., “195******21” in Figure 1(a)).
The user can opt to log in in this way, without typing any
credentials (e.g., username and password), or manually choose
to log in in other ways, such as by interacting with other apps
marked by green boxes in Figure 1 (similar to performing
Single-Sign-On with Google or Facebook). If the local phone
number is not associated with any account, in most cases, the
app will automatically create a new account and bind it to
this local phone number. Compared with other authentication
schemes on mobile platform, such as Single-Sign-On [13],
or SMS One-Time-Password (OTP) [14], OTAuth provides a