PIU103
PIU104
PIU105
COU1
PIU201
PIU202
PIU203
PIU204
PIU205
COU2
PIU303
PIU304
PIC202
PIC502
PIR601
PIR120CW
PIU105
PIU205
PIC201
PIC401
PIC501
PIR502
PIR1102
PIR120CCW
PIU102
PIU202
PIC301
PIR701
PITP201
PIU203
PIC302
PIR40CW
PIR40W
PIU101
PIC402
PIR602
PIR702
PIR802
PIR1101
PIR120W
PITP401
PIU304
PITP101
PIU103
PIR40CCW
PIR501
PIU104
PIR801
PIR100CCW
PIU204
PIR100CW
PIR100W
PITP301
PIU201
PIU303
Comparator
! Maxim MAX985 Micropower, Low Voltage, Rail-to-
Rail Comparator 
! Determine what portion of signal treated as logic 
level '0' or '1' 
! Adjustable threshold voltage w/ potentiometer R12
10k
R9
1k
R3
3V3
TP5
Normal
Inverted
2
3
4
5
1
U3
MAX985EUK
MAX4124EUK
0.1uF
3V3
0.1uF
C7
3V3
0.1uF
C6
Threshold Detector
Non-Inverting Amplifier
TP3
 R10/R8
R12
20k
TP4
0.1uF
C11
DATA_RX
Q1
MMBT3904
2
1
3
5
4
6
SW1
JS202011CQN
(Comparator)
PIC601
PIC602
COC6
PIC701
PIC702
COC7
PIC1101
PIC1102
COC11
PIQ101
PIQ102
PIQ103
COQ1
PIR301
PIR302
COR3
PIR901
PIR902
COR9
PIR120CCW
PIR120CW
PIR120W
COR12
PISW101
PISW102
PISW103
PISW104
PISW105
PISW106
COSW1
PITP301
COTP3
PITP401
COTP4
PITP501
COTP5
PIU301
PIU302
PIU303
PIU304
PIU305
COU3
PIC702
PIR301
PIR120CW
PIU302
PISW102
PISW105
PITP501
NLDATA0RX
PIC601
PIC701
PIC1101
PIQ101
PIR120CCW
PIU305
PIC602
PIR120W
PITP401
PIU304
PIC1102
PIQ102
PIR902
PIQ103
PIR302
PISW103
PISW106
PIR901
PISW101
PISW104
PIU301
PITP301
PIU303
USB Interface
! Powers OpticSpy from bus (5V) 
! FTDI FT231X USB-to-Serial UART 
! Entire USB protocol handled on-chip 
! Host will recognize as a virtual serial port 
(Windows, OS X, Linux) 
! Decode asynchronous data streams and pass to 
host PC
0.1uF
3V3
Threshold Detector
To Host
1
2
3
4
5
P1
UX60-MB-5S8
0.1uF
C11
USB Mini B
0.01uF
C8
220R@100MHz
L1
5V0
4.7k
R15
D2
LED
RTS
2
DCD
8
RI
5
VCC
15
TXD
20
CTS
9
CBUS0
18
3V3OUT
13
DTR
1
RXD
4
CBUS1
17
DSR
7
USBDM
12
USBDP
11
VCCIO
3
RESET
14
GND
16
GND
6
CBUS2
10
CBUS3
19
U4
FT231XS
27
R14
27
R13
47pF
C9
47pF
C10
TXLEDa
5V0
Receive Data Indicator
VUSB
D_N
D_P
(Comparator)
PIC801
PIC802
COC8
PIC901
PIC902
COC9
PIC1001
PIC1002
COC10
PIC1101
PIC1102
COC11
PID201
PID202
COD2
PIL101
PIL102
COL1
PIP101
PIP102
PIP103
PIP104
PIP105
COP1
PIR1301
PIR1302
COR13
PIR1401
PIR1402
COR14
PIR1501
PIR1502
COR15
PIU401
PIU402
PIU403
PIU404
PIU405
PIU406
PIU407
PIU408
PIU409
PIU4010
PIU4011
PIU4012
PIU4013
PIU4014
PIU4015
PIU4016
PIU4017
PIU4018
PIU4019
PIU4020
COU4
PID201
PIL102
PIU4015
PIC902
PIP102
PIR1301
NLD0N
PIC1002
PIP103
PIR1401
NLD0P
PIU404
PIC801
PIC901
PIC1001
PIC1101
PIP105
PIU406
PIU4016
PIC1102
PIU403
PIU4013
PIU4014
PID202
PIR1501
PIP104
PIR1302
PIU4012
PIR1402
PIU4011
PIU401
PIU402
PIU405
PIU407
PIU408
PIU409
PIU4017
PIU4018
PIU4019
PIU4020
PIR1502
PIU4010
NLTXLED#
PIC802
PIL101
PIP101 NLVUSB
PCB
Bill-of-Materials
OpticSpy Analog: Crowd Supply Edition
Bill-of-Materials
HW A, Document 1.0, January 18, 2018
Item
Quantity
Reference
Manufacturer
Manuf. Part #
Distributor
Distrib. Part #
Description
1
9
C1, C2, C3, C4, C5, C6, 
C7, C11, C14
Kemet
C0805C104K5RACTU
Digi-Key
399-1170-1-ND
Capacitor, 0.1uF, 50V, Ceramic, 10%, X7R, 0805
2
1
C8
Kemet
C0805C103K5RACTU
Digi-Key
399-1158-1-ND
Capacitor, 0.01uF, 50V, Ceramic, 10%, X7R, 0805
3
2
C9, C10
Samsung
CL21C470JBANNNC
Digi-Key
1276-1156-1-ND
Capacitor, 47pF, 50V, Ceramic, 5%, C0G, 0805
4
2
C12, C13
Vishay Sprague
293D106X0016A2TE3
Digi-Key
718-1956-1-ND
Capacitor, 10uF, 16V, Tantalum, 20%, Size A
5
1
C15
Yageo
CC0805KRX7R9BB471
Digi-Key
311-1124-1-ND
Capacitor, 470pF, 50V, Ceramic, 10%, X7R, 0805
6
1
D1
Vishay Semiconductor
BPW21R
Digi-Key
751-1013-ND
Photodiode, Silicon PN, 420-675nm, TO-5
7
2
D2, D3
Kingbright
APT2012SYCK
Digi-Key
754-1134-1-ND
LED, Yellow clear, 150mcd, 2.0Vf, 590nm, 0805
8
1
L1
TDK
MPZ2012S221AT000
Digi-Key
445-1568-1-ND
Inductor, Ferrite Bead, 220R @ 100MHz, 3A, 0805
9
1
P1
Hirose Electric
UX60-MB-5S8
Digi-Key
H2960CT-ND
Connector, Mini-USB, 5-pin, SMT w/ PCB mount
10
1
Q1
ON Semiconductor
MMBT3904
Digi-Key
MMBT3904FSCT-ND
Transistor, NPN, 40V, 200mA, SOT23-3
11
1
R1
Any
Any
Digi-Key
P100KACT-ND
Resistor, 100k, 5%, 1/8W, 0805
12
2
R2, R12
Bourns
PVG5A203C03R00
Digi-Key
490-2667-1-ND
Resistor, Variable Trimmer, 20k, 1/8W, SMD
13
3
R3, R6, R11
Any
Any
Digi-Key
P1.0KACT-ND
Resistor, 1k, 5%, 1/8W, 0805
14
1
R4
Bourns
PVG5A504C03R00
Digi-Key
490-2674-1-ND
Resistor, Variable Trimmer, 500k, 1/8W, SMD
15
3
R5, R15, R16
Any
Any
Digi-Key
P4.7KACT-ND
Resistor, 4.7k, 5%, 1/8W, 0805
16
3
R7, R8, R9
Any
Any
Digi-Key
P10KACT-ND
Resistor, 10k, 5%, 1/8W, 0805
17
1
R10
Bourns
PVG5A105C03R00
Digi-Key
490-2663-1-ND
Resistor, Variable Trimmer, 1.0M, 1/8W, SMD
18
2
R13, R14
Any
Any
Digi-Key
P27ACT-ND
Resistor, 27 ohm, 5%, 1/8W, 0805
19
1
SW1
C&K Components
JS202011CQN
Digi-Key
401-2001-ND
Switch, DPDT slide, 300mA @ 6VDC, PCB mount
20
2
U1, U2
Maxim Integrated
MAX4124EUK+T
Digi-Key
MAX4124EUK+TCT-ND
IC, Operational Amplifier, Rail-to-Rail, SOT23-5
21
1
U3
Maxim Integrated
MAX985EUK+T
Digi-Key
MAX985EUK+TCT-ND
IC, Comparator, Push-Pull, Rail-to-Rail, SOT23-5
22
1
U4
FTDI
FT231XS-R
Digi-Key
768-1129-1-ND
IC, USB-to-UART Bridge, SSOP20
23
1
U5
Microchip
MIC5205-3.3YM5
Digi-Key
576-1259-1-ND
Linear Regulator, LDO, 3.3V, 150mA, SOT23-5
! All components available from Digi-Key, Mouser 
! Total cost per unit @ 100 quantity = ~$40.77 
! High ticket items: Photodiode, op amp, comparator, 
potentiometers, PCB fab/assembly/test
Target Data Transmission
! Standard LED driver circuit
! Asynchronous serial (UART) 
! No external clock needed 
! NRZ (Non-Return-To-Zero) coding 
! Transfer speed (baud rate) selectable 
! Data bits sent LSB first (D0)
*** Start bit + Data bits + Parity (optional) + Stop bit(s)
Target Data Transmission
Bit width = ~8.7uS
Mark (Idle)
Space
Target Data Transmission
! Printable ASCII data via standard UART 
! printf(message) or equivalent
Target Data Transmission
TP1: Photocurrent-to-Voltage
TP2: 1st Stage Amp Output
TP3: 2nd Stage Amp Output
TP5: Comparator Output
TP5: Comparator Output
Calibration
! Adjust settings for a particular target system 
! Reduce ambient noise 
! Increase receive distance 
! Change frequency response/bandwidth 
! Dependent on brightness and wavelength of 
transmitting signal 
! Potentiometers 
! Gain adjustment (three stages) 
! Default setting @ mid-range -> 27.6MΩ 
! Threshold voltage adjustment (for comparator) 
! Set to 2.5V during production
Demonstrations
Parallax Electronic Badge
Tomu
! Silicon Labs Happy Gecko EFM32HG309 
! Total 12 components (incl. plastic case) 
! 100% Open Source (w/ KiCad) 
! http://tomu.im 
! https://github.com/im-tomu/tomu-quickstart/tree/
master/opticspy
Arduino + Laz0r!@
! Long-range data transmission w/ laser diode module 
! Data sent to LDO Enable (EN) pin 
! Distance limited by laser diffusion + output power 
! oshpark.com/shared_projects/WV8fBzyW
VIN
5
VO
4
EN
1
NC
2
GND
3
U1
MIC5213a3.0YC5
1uF
C3
VCC
10uF
C1
VCC
1
NC
3
GND
2
D1
APC Laser Diode Module
LEN
3V0
Input voltage
Arima APCD-635-02-C3-A or equivilent
80mA maximum operating current
0.1uF
C2
VCC
2.5V to 16V
DNP
R1
1
2
3
JP1
Header 3
PIC101
PIC102
COC1
PIC201
PIC202
COC2
PIC301
PIC302
COC3
PID101
PID102
PID103
COD1
PIJP101
PIJP102
PIJP103
COJP1
PIR101
PIR102
COR1
PIU101
PIU102
PIU103
PIU104
PIU105
COU1
PIC302
PID101
PIU104
PIC102
PIC201
PIC301
PID102
PIJP101
PIR101
PIU103
PIJP102
PIR102
PIU101
NLLEN
PID103
PIU102
PIC101
PIC202
PIJP103
PIU105
Arduino + Laz0r!@
Hayes Smartmodem Optima 
! Data leakage through SD (Send Data) LED 
! Discovered by Loughry and Umphress 2002 
! Indicator LEDs tied to serial port data lines
Hayes Smartmodem Optima 
! uSD to Serial Interface 
! Read text file from card, send contents via serial 
! DB25 connection for direct connection to modem 
! Good for demonstrations, trolling, etc. 
! oshpark.com/shared_projects/laP2t8DO
TP-Link TL-WR841N
! Physically unmodified router w/ DD-WRT 
! Cross compiled w/ toolchain-mips_24kc_ 
gcc-7.2.0_musl 
! Loaded onto the device with known administrator 
credentials (as proof of concept)
TP-Link TL-WR841N
MacBook Pro Keyboard
! Based on https://github.com/pirate/mac-keyboard-
brightness 
! Backlight LEDs @ 100Hz, 75% PWM :( 
! Can decode manually or w/ MCU via TP5
Samsung TV Remote
! 38kHz carrier 
! Start: 4.5ms pulse burst, 4.5ms space 
! Logic '1': ~544μs pulse, 1.706ms space 
! Logic '0': ~544μs pulse, 580μs space 
! Measure via TP5
iPhone 6 Proximity Sensor
! ~313uS width @ 100kHz carrier 
! 30Hz refresh rate 
! Measure via TP5
Application Ideas
! Search for optical covert channels in existing devices 
! Discover optical networking/communications systems 
! Add data transfer functionality to a project 
! Receive/demodulate IR signals 
! Measure the world around you
Limitations
! Data must be NRZ encoded in order to pass 
through USB-to-Serial interface 
! Short receive range (up to ~4 inches) w/o 
additional optics 
! Difficult to determine potentiometer settings
Future Work?
! More intelligence to handle non-NRZ data streams 
(on-board v. off-board) 
! Automatic gain control (AGC) to replace 
potentiometers 
! Compromise/communicate with a target device 
using an LED as an input
Other Things
! Photodiode Amplifiers: Op Amp Solutions, Jerald 
Graeme, McGraw-Hill, 1995 
! Sound Camera: NYC Night Drive, Eric Archer, 2010 
! The Photophone, Hack-a-Week, 2011 
! PWM Laser Audio Transmitter, Tymkrs, 2011
Other Things
! IBM/Lenovo ThinkPad LED Control 
! www.reddit.com/r/thinkpad/comments/7n8eyu/
thinkpad_led_control_under_gnulinux/ 
! Asus ROG Strix Z370 Gaming Mini-ITX Motherboard 
! Addressable AURA sync RGB LED lighting 
! www.asus.com/us/ROG-Republic-Of-Gamers/ROG-
STRIX-Z370-I-GAMING/
Come Into the Light
! grandideastudio.com/portfolio/opticspy 
*** Schematic, BOM, Gerber plots, test procedure, 
user manual, demonstration code 
! oshpark.com/profiles/joegrand 
*** Bare boards 
! crowdsupply.com/grand-idea-studio/opticspy 
*** Assembled units
The End.