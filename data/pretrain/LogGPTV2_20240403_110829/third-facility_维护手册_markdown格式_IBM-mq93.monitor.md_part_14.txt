group:
Returned: Always.
QName
Description: The name of the queue that was opened.
Identifier: MQCA_Q_NAME.
Data type: MQCFST.
Maximum length: MQ_Q_NAME_LENGTH
Included in PCF Operation.
group:
Returned: If the message was discarded because it was unsuccessfully put to a queue.
RemoteQMgrName
Description: The name of the queue manager to which the message was destined.
Identifier: MQCA_REMOTE_Q_MGR_NAME.
Data type: MQCFST.
Maximum length: MQ_Q_MGR_NAME_LENGTH
Included in PCF Operation.
group:
Returned: If the value of Feedback is MQFB_NOT_FORWARDED.
IBM MQ Monitoring and performance 119
Publish/Discarded Publish/Excluded Publish (MQOPER_PUBLISH/MQOPER_DISCARDED_PUBLISH/
MQOPER_EXCLUDED_PUBLISH)
The additional activity report message data parameters that are returned in the PCF group Operation for
the Publish/Discarded Publish/Excluded Publish (MQOPER_PUBLISH/MQOPER_DISCARDED_PUBLISH/
MQOPER_EXCLUDED_PUBLISH) operation type (a publish/subscribe message was delivered, discarded,
or excluded).
SubId
Description: The subscription identifier.
Identifier: MQBACF_SUB_ID.
Data type: MQCFBS.
Included in PCF Operation.
group:
Returned: Always.
SubLevel
Description: The subscription level.
Identifier: MQIACF_SUB_LEVEL.
Data type: MQCFIN.
Included in PCF Operation.
group:
Returned: Always.
Feedback
Description: The reason for discarding the message.
Identifier: MQIACF_FEEDBACK.
Data type: MQCFIN.
Included in PCF Operation.
group:
Returned: If the message was discarded because it was not delivered to a subscriber, or
the message was not delivered because the subscriber was excluded.
The Publish operation MQOPER_PUBLISH provides information about a message delivered to a particular
subscriber. This operation describes the elements of the onward message that might have changed from
the message described in the associated Put operation. Similarly to a Put operation, it contains a message
group MQGACF_MESSAGE and, inside that, an MQMD group MQGACF_MQMD. However, this MQMD group
contains only the following fields, which can be overridden by a subscriber: Format, Priority, Persistence,
MsgId, CorrelId, UserIdentifier, AccountingToken, ApplIdentityData.
The SubId and SubLevel of the subscriber are included in the operation information. You can use the
SubID with the MQCMD_INQUIRE_SUBSCRIBER PCF command to retrieve all other attributes for a
subscriber.
The Discarded Publish operation MQOPER_DISCARDED_PUBLISH is analogous to the Discard operation
that is used when a message is not delivered in point-to-point messaging. A message is not delivered to
a subscriber if the message was explicitly requested not to be delivered to a local destination and this
subscriber specifies a local destination. A message is also considered not delivered if there is a problem
getting the message to the destination queue, for example, because the queue is full.
120 Monitoring and Performance for IBM MQ
The information in a Discarded Publish operation is the same as for a Publish operation, with the addition
of a Feedback field that gives the reasons why the message was not delivered. This feedback field
contains MQFB_* or MQRC_* values that are common with the MQOPER_DISCARD operation. The reason
for discarding a publish, as opposed to excluding it, are the same as the reasons for discarding a put.
The Excluded Publish operation MQOPER_EXCLUDED_PUBLISH provides information about a subscriber
that was considered for delivery of the message, because the topic on which the subscriber is subscribing
matches that of the associated Put operation, but the message was not delivered to the subscriber
because other selection criteria do not match with the message that is being put to the topic. As
with a Discarded Publish operation, the Feedback field provides information about the reason why
this subscription was excluded. However, unlike the Discarded Publish operation, no message-related
information is provided because no message was generated for this subscriber.
Put/Put Reply/Put Report (MQOPER_PUT/MQOPER_PUT_REPLY/MQOPER_PUT_REPORT)
The additional activity report message data parameters that are returned in the PCF group Operation for
the Put/Put Reply/Put Report (MQOPER_PUT/MQOPER_PUT_REPLY/MQOPER_PUT_REPORT) operation
type (a message, reply message, or report message was put to a queue).
QName
Description: The name of the queue that was opened.
Identifier: MQCA_Q_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_Q_NAME_LENGTH
Returned: Always, apart from one exception: not returned if the Put operation is to a topic,
contained within a publish activity.
ResolvedQName
Description: The name that the opened queue resolves to.
Identifier: MQCACF_RESOLVED_Q_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_Q_NAME_LENGTH
Returned: When the opened queue could be resolved. Not returned if the Put operation is
to a topic, contained within a publish activity.
RemoteQName
Description: The name of the opened queue, as it is known on the remote queue manager.
Identifier: MQCA_REMOTE_Q_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_Q_NAME_LENGTH
Returned: If the opened queue is a remote queue. Not returned if the Put operation is to a
topic, contained within a publish activity.
IBM MQ Monitoring and performance 121
RemoteQMgrName
Description: The name of the remote queue manager on which the remote queue is defined.
Identifier: MQCA_REMOTE_Q_MGR_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_Q_MGR_NAME_LENGTH
Returned: If the opened queue is a remote queue. Not returned if the Put operation is to a
topic, contained within a publish activity.
TopicString
Description: The full topic string to which the message is being put.
Identifier: MQCA_TOPIC_STRING.
Data type: MQCFST.
Included in PCF Operation.
group:
Returned: If the Put operation is to a topic, contained within a publish activity.
Feedback
Description: The reason for the message being put on the dead-letter queue.
Identifier: MQIACF_FEEDBACK.
Data type: MQCFIN.
Included in PCF Operation.
group:
Returned: If the message was put on the dead-letter queue.
Receive (MQOPER_RECEIVE)
The additional activity report message data parameters that are returned in the PCF group Operation for
the Receive (MQOPER_RECEIVE) operation type (a message was received on a channel).
ChannelName
Description: The name of the channel on which the message was received.
Identifier: MQCACH_CHANNEL_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_CHANNEL_NAME_LENGTH
Returned: Always.
ChannelType
Description: The type of channel on which the message was received.
Identifier: MQIACH_CHANNEL_TYPE.
Data type: MQCFIN.
122 Monitoring and Performance for IBM MQ
Included in PCF Operation.
group:
Returned: Always.
RemoteQMgrName
Description: The name of the queue manager from which the message was received.
Identifier: MQCA_REMOTE_Q_MGR_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_Q_MGR_NAME_LENGTH
Returned: Always.
Send (MQOPER_SEND)
The additional activity report message data parameters that are returned in the PCF group Operation for
the Send (MQOPER_SEND) operation type (a message was sent on a channel).
ChannelName
Description: The name of the channel where the message was sent.
Identifier: MQCACH_CHANNEL_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_CHANNEL_NAME_LENGTH.
Returned: Always.
ChannelType
Description: The type of channel where the message was sent.
Identifier: MQIACH_CHANNEL_TYPE.
Data type: MQCFIN.
Included in PCF Operation.
group:
Returned: Always.
XmitQName
Description: The transmission queue from which the message was retrieved.
Identifier: MQCACH_XMIT_Q_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_Q_NAME_LENGTH.
Returned: Always.
IBM MQ Monitoring and performance 123
RemoteQMgrName
Description: The name of the remote queue manager to which the message was sent.
Identifier: MQCA_REMOTE_Q_MGR_NAME.
Data type: MQCFST.
Included in PCF Operation.
group:
Maximum length: MQ_Q_MGR_NAME_LENGTH
Returned: Always.
Trace-route message reference
Use this page to obtain an overview of the trace-route message format. The trace-route message data
includes parameters that describe the activities that the trace-route message has caused
Trace-route message format
Trace-route messages are standard IBM MQ messages containing a message descriptor and message
data. The message data contains information about the activities performed on a trace-route message as
it has been routed through a queue manager network.
Trace-route messages contain the following information:
A message descriptor
An MQMD structure, with the Format field set to MQFMT_ADMIN or MQFMT_EMBEDDED_PCF.
Message data
Consists of either:
• A PCF header (MQCFH) and trace-route message data, if Format is set to MQFMT_ADMIN, or
• An embedded PCF header (MQEPH), trace-route message data, and additional user-specified
message data, if Format is set to MQFMT_EMBEDDED_PCF.
When using the IBM MQ display route application to generate a trace-route message, Format is set to
MQFMT_ADMIN.
The content of the trace-route message data is determined by the Accumulate parameter from the
TraceRoute PCF group, as follows:
• If Accumulate is set to MQROUTE_ACCUMULATE_NONE, the trace-route message data contains the
TraceRoute PCF group.
• If Accumulate is set to either MQROUTE_ACCUMULATE_IN_MSG or
MQROUTE_ACCUMULATE_AND_REPLY, the trace-route message data contains the TraceRoute PCF
group and zero or more Activity PCF groups.
Table 20 on page 125 shows the structure of a trace-route message.
124 Monitoring and Performance for IBM MQ
Table 20. Trace-route message format
MQMD structure Embedded PCF header MQEPH Trace-route message data
structure
Structure identifier Structure identifier TraceRoute
Structure version Structure version Detail
Report options Structure length Recorded activities
Message type Encoding Unrecorded activities
Expiration time Coded character set ID Discontinuity count
Feedback Message format Max activities
Encoding Flags Accumulate
Coded character set ID PCF header (MQCFH) Deliver
Message format Structure type
Priority Structure length
Persistence Structure version
Message identifier Command identifier
Correlation identifier Message sequence number
Backout count Control options
Reply-to queue Completion code
Reply-to queue manager Reason code
User identifier Parameter count
Accounting token
Application identity data
Application type
Application name
Put date
Put time
Application origin data
Group identifier
Message sequence number
Offset
Message flags
Original length
Trace-route message MQMD (message descriptor)
Use this page to view the values contained by the MQMD structure for a trace-route message
StrucId
Description: Structure identifier.
Data type: MQCHAR4.
Value: MQMD_STRUC_ID.
Version
Description: Structure version number.
Data type: MQLONG.
Values: MQMD_VERSION_1.
Report
Description: Options for report messages.
Data type: MQLONG.
IBM MQ Monitoring and performance 125
Value: Set according to requirements. Common report options follow:
MQRO_DISCARD_MSG
The message is discarded on arrival to a local queue.
MQRO_PASS_DISCARD_AND_EXPIRY
Every response (activity reports or trace-route reply message) will have the
report option MQRO_DISCARD_MSG set, and the remaining expiry passed
on. This ensures that responses do not remain in the queue manager
network indefinitely.
MsgType
Description: Type of message.
Data type: MQLONG.
Value: If the Accumulate parameter in the TraceRoute group is specified as
MQROUTE_ACCUMULATE_AND_REPLY, then message type is MQMT_REQUEST
Otherwise:
MQMT_DATAGRAM.
Expiry
Description: Message lifetime.
Data type: MQLONG.
Value: Set according to requirements. This parameter can be used to ensure trace-
route messages are not left in a queue manager network indefinitely.
Feedback
Description: Feedback or reason code.
Data type: MQLONG.
Value: MQFB_NONE.
Encoding
Description: Numeric encoding of message data.
Data type: MQLONG.
Value: Set as appropriate.
CodedCharSetId
Description: Character set identifier of message data.
Data type: MQLONG.
Value: Set as appropriate.
Format
Description: Format name of message data
Data type: MQCHAR8.
126 Monitoring and Performance for IBM MQ
Value: MQFMT_ADMIN
Admin message. No user data follows the TraceRoute PCF group.
MQFMT_EMBEDDED_PCF
Embedded PCF message. User data follows the TraceRoute PCF group.
Priority
Description: Message priority.
Data type: MQLONG.
Value: Set according to requirements.
Persistence
Description: Message persistence.
Data type: MQLONG.
Value: Set according to requirements.
MsgId
Description: Message identifier.
Data type: MQBYTE24.
Value: Set according to requirements.
CorrelId
Description: Correlation identifier.
Data type: MQBYTE24.
Value: Set according to requirements.
BackoutCount
Description: Backout counter.
Data type: MQLONG.
Value: 0.
ReplyToQ
Description: Name of reply queue.
Data type: MQCHAR48.
Values: Set according to requirements.
If MsgType is set to MQMT_REQUEST or if Report has any report generating
options set, then this parameter must be non-blank.
ReplyToQMgr
Description: Name of reply queue manager.
Data type: MQCHAR48.
Value: Set according to requirements.
IBM MQ Monitoring and performance 127
UserIdentifier
Description: The user identifier of the application that originated the message.
Data type: MQCHAR12.
Value: Set as normal.
AccountingToken
Description: Accounting token that allows an application to charge for work done as a result
of the message.
Data type: MQBYTE32.
Value: Set as normal.
ApplIdentityData
Description: Application data relating to identity.
Data type: MQCHAR32.
Values: Set as normal.
PutApplType
Description: Type of application that put the message.
Data type: MQLONG.
Value: Set as normal.
PutApplName
Description: Name of application that put the message.
Data type: MQCHAR28.
Value: Set as normal.
PutDate
Description: Date when message was put.
Data type: MQCHAR8.
Value: Set as normal.