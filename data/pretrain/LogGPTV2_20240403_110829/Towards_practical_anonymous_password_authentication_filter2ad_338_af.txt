### References

1. LNCS, pages 1–9. Springer, 2014.
2. M. Bellare, D. Micciancio, and B. Warinschi. Foundations of group signatures: Formal definitions, simplified requirements, and a construction based on general assumptions. In *EUROCRYPT 2003*, pages 614–629. Springer.
3. M. Bellare, D. Pointcheval, and P. Rogaway. Authenticated key exchange secure against dictionary attacks. In *EUROCRYPT 2000*, pages 139–155. Springer.
4. M. Bellare and P. Rogaway. The AuthA protocol for password-based authenticated key exchange. Contribution to IEEE P1363.
5. M. Bellare and P. Rogaway. Random oracles are practical: A paradigm for designing efficient protocols. In *ACM CCS'93*, pages 62–73. ACM Press, 1993.
6. S. M. Bellovin and M. Merritt. Encrypted key exchange: Password-based protocols secure against dictionary attacks. In *IEEE Computer Society Symposium on Research in Security and Privacy*, pages 72–84, 1992.
7. F. Benhamouda, O. Blazy, C. Chevalier, D. Pointcheval, and D. Vergnaud. New techniques for SPHFs and efficient one-round PAKE protocols. In *CRYPTO 2013*, volume 8042 of LNCS, pages 449–475. Springer, 2013.
8. D. Bernhard, M. Fischlin, and B. Warinschi. Adaptive proofs of knowledge in the random oracle model. In *Public-Key Cryptography - PKC 2015*, pages 629–649.
9. D. Boneh and X. Boyen. Efficient selective-ID secure identity-based encryption without random oracles. In *EUROCRYPT 2004*, pages 223–238. Springer-Verlag.
10. D. Boneh and X. Boyen. Short signatures without random oracles. In *EUROCRYPT 2004*, pages 56–73.
11. D. Boneh, X. Boyen, and H. Shacham. Short group signatures. In *CRYPTO 2004*, volume 3152 of LNCS, pages 41–55. Springer-Verlag, 2004.
12. J. W. Bos, C. Costello, M. Naehrig, and D. Stebila. Post-quantum key exchange for the TLS protocol from the ring learning with errors problem. In *2015 IEEE Symposium on Security and Privacy*.
13. V. Boyko, P. MacKenzie, and S. Patel. Provably secure password-authenticated key exchange using Diffie-Hellman. In *EUROCRYPT 2000*, pages 156–171.
14. E. Brickell, J. Camenisch, and L. Chen. Direct anonymous attestation. In *ACM CCS 2004*, pages 132–145. ACM Press.
15. J. Camenisch, M. Dubovitskaya, K. Haralambiev, and M. Kohlweiss. Composable and modular anonymous credentials: Definitions and practical constructions. In *ASIACRYPT 2015*, pages 262–288. Springer.
16. J. Camenisch and A. Lysyanskaya. A signature scheme with efficient protocols. In *SCN 2002*, pages 268–289. Springer.
17. J. Camenisch and A. Lysyanskaya. Signature schemes and anonymous credentials from bilinear maps. In *CRYPTO 2004*, volume 3152 of LNCS, pages 56–72. Springer-Verlag.
18. J. Camenisch and A. Lysyanskaya. An efficient system for non-transferable anonymous credentials with optional anonymity revocation. In *EUROCRYPT 2001*, volume 2045 of LNCS, pages 93–118. Springer-Verlag, 2001.
19. J. Camenisch and M. Stadler. Efficient group signature schemes for large groups. In *CRYPTO 1997*, pages 410–424.
20. A. Cassola, E.-O. Blass, and G. Noubir. Authenticating privately over public Wi-Fi hotspots. In *ACM CCS*, pages 1346–1357. ACM, 2015.
21. E. Cesena, H. Löhr, G. Ramunno, A.-R. Sadeghi, and D. Vernizzi. Anonymous authentication with TLS and DAA. In *TRUST 2010*, pages 47–62. Springer.
22. M. Chase and A. Lysyanskaya. On signatures of knowledge. In *CRYPTO 2006*, pages 78–96. Springer-Verlag.
23. M. Chase, S. Meiklejohn, and G. Zaverucha. Algebraic MACs and keyed-verification anonymous credentials. In *ACM CCS 2014*, pages 1205–1216. ACM Press. Full version available at http://eprint.iacr.org/2013/516.
24. D. Chaum. Blind signatures for untraceable payments. In *CRYPTO 1982*, pages 199–203, 1982.
25. D. Chaum. Security without identification: Transaction systems to make big brother obsolete. *Communications of the ACM*, pages 1030–1044, 1985.
26. D. Chaum and E. van Heyst. Group signatures. In *EUROCRYPT 1991*, pages 257–265. Springer-Verlag.
27. T. Dierks and E. Rescorla. The transport layer security (TLS) protocol version 1.2. RFC 5246 (Proposed Standard), August 2008.
28. Y. Dodis, E. Kiltz, K. Pietrzak, and D. Wichs. Message authentication, revisited. In *EUROCRYPT’12*, volume 7237 of LNCS, pages 355–374. Springer-Verlag, 2012.
29. Y. Dodis and A. Yampolskiy. A verifiable random function with short proofs and keys. In *Public Key Cryptography – PKC 2005*, pages 416–431. Springer-Verlag, 2005.
30. European Parliament and Council of the European Union. Directive 2009/136/EC. Official Journal of the European Union, 2009.
31. D. Fett, R. Küsters, and G. Schmitz. SPRESSO: A secure, privacy-respecting single sign-on system for the web. In *ACM CCS 2015*, pages 1358–1369.
32. A. Fiat and A. Shamir. How to prove yourself: Practical solutions to identification and signature problems. In *CRYPTO 1986*, pages 186–194. Springer-Verlag.
33. M. Fischlin. Communication-efficient non-interactive proofs of knowledge with online extractors. In *CRYPTO 2005*, volume 3621 of LNCS, pages 152–168. Springer-Verlag.
34. S. Goldwasser, S. Micali, and R. L. Rivest. A digital signature scheme secure against adaptive chosen-message attacks. *SIAM Journal on Computing*, pages 281–308, 1988.
35. J. Groth. Simulation-sound NIZK proofs for a practical language and constant size group signatures. In *ASIACRYPT 2006*, pages 444–459. Springer-Verlag.
36. V. Gupta, D. Stebila, S. Fung, S. C. Shantz, N. Gura, and H. Eberle. Speeding up secure web transactions using elliptic curve cryptography. In *NDSS*, 2004.
37. IBM. Specification of the Identity Mixer Cryptographic Library. IBM Research Report RZ 3730, 2010.
38. IEEE 1363.2. IEEE standard specifications for password-based public-key cryptographic techniques. IEEE Std 1363.2-2008, pages 1–127, 2009.
39. ISO/IEC 11770-4. Information technology – Security techniques – Key management – Part 4: Mechanisms based on weak secrets, 2006.
40. ISO/IEC 11889:2015. Information technology - Trusted Platform Module Library, 2015.
41. ISO/IEC 20008. Information technology - Security techniques - Anonymous digital signatures, 2013.
42. ISO/IEC DIS 20009-4. Information technology – Security techniques – Anonymous entity authentication – Part 4: Mechanisms based on weak secrets, 2015.
43. J. Katz, R. Ostrovsky, and M. Yung. Efficient password-authenticated key exchange using human-memorable passwords. In *EUROCRYPT 2001*, volume 2045 of LNCS, pages 475–494. Springer-Verlag.
44. Y. Lindell. Anonymous authentication. *Journal of Privacy and Confidentiality*, 2(2):4, 2007.
45. M. Naor and O. Reingold. Synthesizers and their application to the parallel construction of pseudo-random functions. *Computer and Systems Sciences*, 58(2):336–375, April 1999.
46. NISTIR 8062. Privacy risk management for federal information systems, May 2015.
47. C. Paquin and G. Zaverucha. U-Prove Cryptographic Specification V1.1 (Revision 3). Microsoft, 2013.
48. D. Pointcheval. Password-based authenticated key exchange. In *PKC 2012*, pages 390–397. Springer.
49. D. Pointcheval and J. Stern. Security arguments for digital signatures and blind signatures. *Journal of Cryptology*, 13(3):361–396, 2000.
50. K. Rannenberg, J. Camenisch, and A. Sabouri. Attribute-based Credentials for Trust - Identity in the Information Society. Springer, 2015.
51. H. A. Schmidt. National strategy for trusted identities in cyberspace. Cyberwar Resources Guide, Item 163, 2010.
52. C. Schnorr. Security of blind discrete log signatures against interactive attacks. In *Information and Communications Security*, volume 2229 of LNCS, pages 1–12, 2001.
53. S. Shin and K. Kobara. Anonymous password authenticated key exchange: New construction and its extensions. *IEICE*, 93(1):102–115, 2010.
54. V. Shoup. Lower bounds for discrete logarithms and related problems. In *EUROCRYPT 1997*, pages 256–266.
55. N. P. Smart. The exact security of ECIES in the generic group model. In *Cryptography and Coding*, pages 73–84. Springer, 2001.
56. D. Taylor, T. Wu, N. Mavrogiannopoulos, and T. Perrin. Using the secure remote password (SRP) protocol for TLS authentication. RFC 5054, 2007.
57. D. Q. Viet, A. Yamamura, and H. Tanaka. Anonymous password-based authenticated key exchange. In *INDOCRYPT 2005*, volume 3797 of LNCS, pages 244–257.
58. J. Walker and J. Li. Key exchange with anonymous authentication using DAA-SIGMA protocol. In *Trusted Systems*, volume 6802 of LNCS, pages 108–127, 2011.
59. J. Yang and Z. Zhang. A new anonymous password-based authenticated key exchange protocol. In *INDOCRYPT 2008*, volume 5365 of LNCS, pages 200–212. Springer.
60. Y. Yang, J. Zhou, J. Weng, and F. Bao. A new approach for anonymous password authentication. In *ACSAC 2009*, pages 199–208. IEEE.
61. Y. Yang, J. Zhou, J. W. Wong, and F. Bao. Towards practical anonymous password authentication. In *ACSAC 2010*, pages 59–68. ACM.

### Appendix

#### A. Security Proofs of MACSDH

In this section, we prove that MACSDH is suf-rmva secure in Theorem 4 and weak pseudorandom in Theorem 5.

**Theorem 4.** If the q-SDH assumption holds in \( G \), then the MACSDH scheme is suf-rmva secure.

**Proof.** Suppose there exists an adversary \( A \) that makes \( q_m \) queries to the `mac` oracle and \( q_v \) queries to the `verify` oracle, and breaks the suf-rmva security of MACSDH with probability \( \epsilon \). We can construct an algorithm \( B \) that breaks the q-SDH assumption with probability \( \epsilon / (q_v + 1) \) by interacting with \( A \), where \( q = q_m + 1 \).

Given a q-SDH instance \( (g, g^\gamma, \ldots, g^{\gamma^q}) \) for some unknown \( \gamma \in \mathbb{Z}_p^* \), \( B \) aims to output a solution \( (c, g^{1/(\gamma+c)}) \) for some \( c \in \mathbb{Z}_p \setminus \{-\gamma\} \). \( B \) picks \( i^* \xleftarrow{\$} [q_v + 1] \) as the guess that the first fresh and valid forgery appears in the \( i^* \)-th verification query if \( 1 \leq i^* \leq q_v \) or in the final output of \( A \) if \( i^* = q_v + 1 \). Then \( B \) chooses \( m_1, m_2, \ldots, m_{q-1} \xleftarrow{\$} \mathbb{Z}_p \). Let
\[ f(x) = \prod_{j=0}^{q-1} (x + m_j) \]
and
\[ f_i(x) = f(x) / (x + m_i) \]
for each \( i \in [q-1] \). Using the technique of Boneh and Boyen [11, Lemma 3.2], \( B \) can compute \( g' = g^{f(\gamma)} \), \( w = (g')^\gamma \), and \( A_i = (g')^{1/(\gamma+m_i)} \) for each \( i \in [q-1] \). Next, \( B \) returns \( \text{par}_{\text{mac}} = (G, p, g', w) \) to \( A \) and responds to the queries made by \( A \) as follows:

- For the \( i \)-th `mac` query, \( B \) returns \( (m_i, A_i) \) to \( A \).
- For the \( i \)-th `verify` query \( (m', A') \):
  - If \( i = i^* \), \( B \) sets \( (m, A) = (m', A') \) and aborts.
  - Otherwise (i.e., \( i < i^* \)), \( B \) returns 1 if \( (m', A') = (m_j, A_j) \) for some \( 1 \leq j \leq q-1 \) and 0 otherwise.

Finally, if \( B \) does not abort, \( A \) outputs a forgery \( (m^*, A^*) \). In this case (\( i^* = q_v + 1 \)), \( B \) sets \( (m, A) = (m^*, A^*) \).

If \( B \) guesses correctly with probability \( 1/(q_v + 1) \), \( B \)'s simulation is perfect, and \( (m, A) \) is a fresh and valid forgery, i.e., \( (m, A) \notin \{(m_i, A_i)\}_{i=1}^{q-1} \) and \( A^{\gamma+m} = g' \). Thus, we have \( m \notin \{m_1, \ldots, m_{q-1}\} \), since for any valid message-tag pair \( (\tilde{m}, \tilde{A}) \) under \( g' \) and \( \gamma \), \( \tilde{A} \) is uniquely determined by \( \tilde{m} \). Let
\[ f(x) = f'(x)(x + m) + \eta \]
for some \( \eta \in \mathbb{Z}_p^* \), and write \( f'(x) = \sum_{j=0}^{q-2} \delta_j x^j \). Note that
\[ A = (g')^{1/(\gamma+m)} = g^{f(\gamma)/(\gamma+m)} = g^{f'(\gamma) + \eta/(\gamma+m)}. \]
\( B \) computes
\[ g^{1/(\gamma+m)} = \left( \frac{A}{g^{f'(\gamma)}} \right)^{1/\eta} \]
and outputs \( (m, g^{1/(\gamma+m)}) \) as a solution to the q-SDH problem.

**Theorem 5.** If the q-DDHI assumption holds in group \( G \), then MACSDH is weak pseudorandom.

**Proof.** Suppose there exists an adversary \( A \) that makes \( q_m \) queries to the `mac` oracle and breaks the weak pseudorandomness of MACSDH with probability \( \epsilon \). We can construct an algorithm \( B \) that breaks the q-DDHI assumption with probability at least \( \epsilon - (q-1)/p \) via interacting with \( A \), where \( q = q_m + 1 \).

Given a q-DDHI instance \( (g, g^\alpha, \ldots, g^{\alpha^q}, T) \in (G^*)^{q+2} \) for some unknown \( \alpha \in \mathbb{Z}_p^* \), \( B \) aims to distinguish \( T = g^{1/\alpha} \) from a random element \( T \). Firstly, \( B \) picks \( m_1, \ldots, m_{q-1}, m \xleftarrow{\$} \mathbb{Z}_p \). Using the Binomial Theorem, \( B \) can compute the tuple \( (g, g^\gamma, \ldots, g^{\gamma^q}) \) where \( \gamma = \alpha - m \). Then, as in the proof of Theorem 4, \( B \) generates \( g' = g^{f(\gamma)} \), \( w = (g')^\gamma \), and \( A_i = (g')^{1/(\gamma+m_i)} \) for each \( i \in [q-1] \), where
\[ f(x) = \prod_{j=1}^{q-1} (x + m_j). \]
Next, \( B \) returns \( \text{par}_{\text{mac}} = (G, p, g', w) \) to \( A \). For the \( i \)-th query to the `mac` oracle, \( B \) returns a pair \( (m_i, A_i) \) to \( A \).

If \( m \) is equal to one of \( m_1, \ldots, m_{q-1} \), \( B \) aborts. Otherwise, the polynomial \( f(x) \) is not divisible by \( (x + m) \). We have
\[ f(x) = q(x)(x + m) + \eta \]
for some \( \eta \neq 0 \), and write
\[ q(x) = \sum_{j=0}^{q-2} \delta_j x^j. \]
Then, \( B \) computes
\[ g^{q(\gamma)} = \prod_{j=0}^{q-2} (g^{\gamma^j})^{\delta_j} \]
and returns \( (m, \sigma = g^{q(\gamma)} \cdot T^\eta) \) to \( A \) as the challenge. Finally, \( A \) outputs a guess \( b' \), and \( B \) outputs \( b' \).

It is easy to see that the simulation of the `mac` oracle is perfect. If \( T = g^{1/\alpha} \), then
\[ \sigma = g^{q(\gamma)} T^\eta = g^{q(\gamma)} g^{\eta/(\gamma+m)} = g^{f(\gamma)/(\gamma+m)} = (g')^{1/(\gamma+m)}. \]
If \( T \) is uniformly distributed in \( G^* \), then so is \( \sigma \). If \( B \) does not abort, \( B \) succeeds if \( A \) wins. As \( \Pr(\exists i \in [q-1] \text{ s.t. } m = m_i) \leq (q-1)/p \), we have the claimed bound.