VII-C Unbound and TLS
We compare DNSCrypt and DNSCurve performance in
We are not the ﬁrst to suggest combining DNS and TLS.
A recent review of DNS privacy proposed TLS [9], and
NLnet Lab’s Unbound DNS server has supported TLS since
December 2011. Unbound currently supports DNS-over-TLS
only on a separate port, and doesn’t support out-of-order
processing § III-A, and there is no performance analysis. Our
work adds in-band negotiation and out-of-order processing
(see Table II), and we are the ﬁrst to study performance of
DNS with TCP and TLS. Since the only difference is signaling
TLS upgrade, our performance evaluation applies to other
TLS approaches, although unbound’s use of a new port avoids
1 RTT latency.
VII-D Reusing Other Standards: DTLS, TLS over SCTP,
HTTPS, and Tcpcrypt
Although UDP, TCP and TLS are widely used, additional
transport protocols exist to provide different semantics. Data-
gram Transport Layer Security (DTLS) provides TLS over
UDP [65], meeting our privacy requirement. While DTLS
strives to be lighter weight than TCP, it must re-create parts
of TCP: the TLS handshake requires reliability and ordering,
DoS-prevention requires cookies analogous to SYN cook-
ies in TCP’s handshake, and it caches these, analogous to
TCP fast-open. Thus with DoS-protection, DTLS provides
no performance advantage, other than eliminating TCP’s data
ordering. (We provide a more detailed evaluation of these in
our technical report [86].) Applications using DTLS suffer
the same payload limits as UDP (actually slightly worse
because of its additional header), so it does not address the
policy constraints we observe. Since DTLS libraries are less
mature than TLS and DTLS offers few unique beneﬁts, we
recommend T-DNS .
TLS over SCTP has been standardized [38]. SCTP is an
attractive alternative to TCP because TCP’s ordering guaran-
tees are not desired for DNS, but we believe performance is
otherwise similar, as with DTLS.
Several groups have proposed some version of DNS over
HTTP. Kaminsky proposed DNS over HTTP [40] with some
performance evaluation [41]; Unbound runs the DNS protocol
over TLS on port 443 (a non-standard encoding on the
HTTPS port); others have proposed making DNS queries over
XML [61] or JSON [10] and full HTTP or HTTPS. Use of
port 443 saves one RTT for TLS negotiation, but using DNS
encoding is non-standard, and HTTP encoding is signiﬁcantly
more bulky. Most of these proposals lack a complete speciﬁ-
cation (except XML [61]) or detailed performance analysis
(Kaminsky provides some [41]). At a protocol level, DNS
over HTTP must be strictly slower than DNS over TCP, since
HTTP requires its own headers, and XML or JSON encodings
are bulkier. One semi-tuned proxy shows 60 ms per query
overhead [75], but careful studies quantifying overhead is
future work.
layer. This subset
Tcpcrypt provides encryption without authentication at the
transport
is faster than TLS and shifts
computation to the client [8]. T-DNS’s uses TLS for privacy
(and DNSSEC for authentication), so tcpcrypt may be an
attractive alternative to TLS. Tcpcrypt is relatively new and
not yet standardized. Our analysis suggests that, since RTTs
dominate performance, tcpcrypt will improve but not qualita-
tively change performance; experimental evaluation is future
work.
The very wide use of TCP and TLS-over-TCP provides
a wealth of time-tested implementations and libraries, while
DTLS and SCTP implementations have seen less exercise.
We show that TCP and TLS-over-TCP can provide near-
UDP performance with connection caching. Because DTLS
carries out the same protocol exchange as TLS (when spoof
prevention is enabled), it will have the same latency. Our
analysis applies directly to HTTP-based approaches, although
its more verbose framing may have slightly higher overhead.
VII-E Other Approaches to DNS Privacy
Zhao et al. [85] proposed adding cover trafﬁc (additional
queries) to DNS to conceal actual queries from an eavesdrop-
per, Castillo-Perez and Garcia-Alfaro extend this work [14].
These approaches may help protect against an adversary
that controls the recursive resolver; we instead provide only
communications privacy, without range queries.
Lu and Tsudick [47] identify a number of privacy threats to
DNS and propose replacing it with a DHT-based system, and
Zhao et al. [84] later propose DNS modiﬁcations to support
their range queries [85]. Such approaches can provide very
strong privacy guarantees, but such large protocol modiﬁca-
tions pose signiﬁcant deployment challenges.
VII-F Speciﬁc Attacks on DNS
As a critical protocol, DNS has been subject to targeted
attacks. These attacks often exploit currently open DNS recur-
sive name servers, and so they would be prevented with use of
TLS’ secure client-to-server channel. Injection attacks include
the Kaminsky vulnerability [39], mitigated by changes to DNS
implementations; sending of duplicate replies ahead of the
legitimate reply [2], mitigated by Hold-On at the client [24];
and injection of IP fragments to circumvent DNSSEC [32],
mitigated by implementation and operations changes.
Although speciﬁc countermeasures exist for each of these
responding to new attacks is costly and slow.
attacks,
Connection-level encryption like TLS may prevent a broad
class of attacks that manipulate replies (for example, [32]).
184184
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:44 UTC from IEEE Xplore.  Restrictions apply. 
Although TLS is not foolproof (for example, it can be vulner-
able to person-in-the-middle attacks), and we do not resolve
all injection attacks (such as injection of TCP RST or TLS-
close notify), we believe TLS signiﬁcantly raises the bar for
these attacks.
Similarly, recent proposals add cookies to UDP-based DNS
to reduce the impact of DoS attacks [25]. While we support
cookies, a shift to TCP addresses policy constraints as well as
DNS, and enables use of TLS.
VIII. CONCLUSION
Connectionless DNS is overdue for reassessment due to
privacy limitations, security concerns, and sizes that constrain
policy and evolution. Our analysis and experiments show that
connection-oriented DNS addresses these problems, and that
latency and resource needs of T-DNS are manageable.
ACKNOWLEDGMENTS
We would like to thank several that contributed data to
this effort: DNS-OARC DITL program, operators of A, J, B
Root name servers, Level3 and Common Crawl. Calvin Ardi
extracted domain names from web pages from the Common
Crawl dataset. Xun Fan helped collect data from PlanetLab.
Christos Papadopoulos provided servers at CSU for our high-
latency experiments. John Wroclawski, Bill Manning, and
prior anonymous reviewers provided comments on the paper,
many helpful. We also thank colleagues at Verisign and partic-
ipants at the 2014 DNS-OARC workshop for comments and
many though-provoking questions, particularly about deploy-
ment. We thank Ted Faber and Joe Touch for their discussions
about TCP.
Research by Liang Zhu, Zi Hu, and John Heidemann
in this paper is partially sponsored by the Department of
Homeland Security (DHS) Science and Technology Direc-
torate, HSARPA, Cyber Security Division, BAA 11-01-RIKA
and Air Force Research Laboratory, Information Directorate
under agreement number FA8750-12-2-0344, and contract
number D08PC75599. The U.S. Government is authorized
to make reprints for Governmental purposes notwithstanding
any copyright. The views contained herein are those of the
authors and do not necessarily represent those of DHS or the
U.S. Government.
REFERENCES
[1] Alexa, http://www.alexa.com/.
[2] Anonymous, “The collateral damage of internet censorship by DNS
injection,” SIGCOMM Comput. Commun. Rev., Jun. 2012.
[3] Arbor Networks, “Worldwide infrastructure security report,” Arbor
Networks, Tech. Rep., Sep. 2012.
[4] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose, “DNS
Security Introduction and Requirements,” RFC 4033, Mar. 2005.
[5] R. Bellis, “DNS Transport over TCP - Implementation Requirements,”
RFC 5966, Internet Engineering Task Force, Aug. 2010.
[6] V. Bernat, “SSL computational DoS mitigation,” blog http://vincent.
bernat.im/en/blog/2011-ssl-dos-mitigation.html, Nov. 2011.
[7] R. Beverly, R. Koga, and kc claffy, “Initial longitudinal analysis of IP
source spooﬁng capability on the Internet,” Internet Society, Jul. 2013.
[8] A. Bittau, M. Hamburg, M. Handley, D. Mazi`eres, and D. Boneh,
“The case for ubiquitous transport-level encryption,” in Proceedings of
the 19th USENIX Conference on Security, ser. USENIX Security’10.
Berkeley, CA, USA: USENIX Association, 2010, pp. 26–26.
[9] S. Bortzmeyer, “DNS privacy problem statement,” Dec. 2013, Internet
draft.
[10] ——, “JSON format
to represent DNS data,” Feb. 2013, work in
progress (Internet draft draft-bortzmeyer-dns-json-01).
[11] R. Bush, D. Karrenberg, M. Kosters, and R. Plzak, “Root name server
operational requirements,” Internet Request For Comments, RFC 2870,
Jun. 2000, (also Internet BCP-40).
[12] M. Butkiewicz, H. V. Madhyastha, and V. Sekar, “Understanding
website complexity: Measurements, metrics, and implications,” in IMC,
Nov. 2011, pp. 313–328.
[13] M. Calder, X. Fan, Z. Hu, E. Katz-Bassett,
J. Heidemann,
and R. Govindan, “Mapping the expansion of Google’s serving
infrastructure,” in Proc. of ACM IMC. Barcelona, Spain: ACM, Oct.
2013, p. to appear.
[14] S. Castillo-Perez and J. Garcia-Alfaro, “Evaluation of two privacy-
preserving protocols for the DNS,” in Proc. of 6thIEEE International
Conference on Information Technology: New Generations.
IEEE, Apr.
2009, pp. 411–416.
[15] S. Castro, D. Wessels, M. Fomenkov, and K. Claffy, “A day at the root
of the Internet,” ACM Computer Communication Review, vol. 38, no. 5,
pp. 41–46, Oct. 2008.
[16] Y. Cheng, J. Chu, S. Radhakrishnan, and A. Jain, “TCP Fast Open,”
RFC 7413, Internet Engineering Task Force, Dec. 2014.
[17] C. Coarfa, P. Druschel, and D. S. Wallach, “Performance analysis of
TLS web servers,” vol. 24, no. 1, pp. 39–69, Feb. 2006.
[18] J. Damas, M. Graff, and P. Vixie, “Extension mechanisms for DNS
(EDNS(0)),” RFC 6891, Internet Engineering Task Force, Apr. 2013.
[19] J. Dean and L. A. Barroso, “The tail at scale,” Communications of the
ACM, vol. 56, no. 2, pp. 74–80, Feb. 2013.
[20] M. Dempsky, “DNSCurve: Link-level security for the Domain Name
System,” Feb. 2010, internet draft.
[21] T. Dierks and E. Rescorla, “The Transport Layer Security TLS Protocol
Version 1.2,” RFC 5246, Internet Engineering Task Force, Aug. 2008.
[22] DNS-OARC, https://www.dns-oarc.net/.
[23] R. Droms, “Dynamic host conﬁguration protocol,” Internet Request For
Comments, RFC 2131, Mar. 1997.
[24] H. Duan, N. Weaver, Z. Zhao, M. Hu, J. Liang, J. Jiang, K. Li, and
V. Paxson, “Hold-on: Protecting against on-path DNS poisoning,” in
SATIN, 2012.
[25] D. E. Eastlake, “Domain Name System (DNS) cookies,” Jan. 2014,
work in progress (Internet draft draft-eastlake-dnsext-cookies-04.txt).
[26] W. Eddy, “TCP SYN ﬂooding attacks and common mitigations,”
Internet Request For Comments, RFC 4987, Aug. 2007.
[27] Electronic Frontier Foundation, “Encrypt
the web with HTTPS
everywhere,” Web page https://www.eff.org/https-everywhere, Aug.
2011.
[28] T. Faber, J. Touch, and W. Yue, “The TIME-WAIT state in TCP and
its effect on busy servers,” INFOCOMM, 1998.
[29] T. Finch, “Secure SMTP using DNS-based authentication of named
entities (DANE) TLSA records.” Feb. 2014, internet draft.
[30] L.
Green,
phase,”
common-crawl-enters-a-new-phase/, Nov. 2011.
Common
blog
“Common
Crawl
crawl
enters
new
http://www.commoncrawl.org/
a
[31] G. Greenwald, “NSA collecting phone records of millions of Verizon
customers daily,” The Guardian, June 2013.
[32] A. Herzberg and H. Shulmanz, “Fragmentation considered poisonous,”
in Proc. of IEEE Conference on Communications and Network Security
(CNS), Oct. 2013.
[33] P. Hoffman and J. Schlyter, “The DNS-based authentication of named
layer security (TLS) protocol: TLSA,”
entities (DANE)
Internet Request For Comments, RFC 6698, Aug. 2012.
transport
[34] Z. Hu, L. Zhu,
J. Heidemann, A. Mankin, and D. Wessels,
“Starting TLS over DNS,” Jan. 2014, work in progress (Internet draft
draft-start-tls-over-dns-00).
[35] G. Huston, “A question of protocol,” Talk at RIPE ’67, 2013.
[36] ICANN, “Root server attack on 6 February 2007,” ICANN, Tech. Rep.,
Mar. 2007.
[37] J. Jung, E. Sit, H. Balakrishnan, and R. Morris, “DNS performance and
the effectiveness of caching,” ACM/IEEE ToN, vol. 10, Oct. 2002.
[38] A. Jungmaier, E. Rescorla, and M. Tuexen, “Transport Layer Security
Internet
over Stream Control Transmission Protocol,” RFC 3436,
Engineering Task Force, Dec. 2002.
[39] D. Kaminsky, “It’s the end of the cache as we know it,” Presentation,
Black Hat Asia, Oct. 2008.
185185
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:44 UTC from IEEE Xplore.  Restrictions apply. 
[40] ——, “The DNSSEC diaries, ch. 6: Just how much should we put in
DNS?” blog post http://dankaminsky.com/2010/12/27/dnssec-ch6/, Dec.
2010.
[41] ——, “DNSSEC interlude 1: Curiosities of benchmarking DNS over
alternate transports,” blog post http://dankaminsky.com/2011/01/04/
dnssec-interlude-1/, Jan. 2011.
[42] C. A. Kent and J. C. Mogul, “Fragmentation considered harmful,” in
SIGCOMM, Aug. 1987, pp. 390–401.
[43] M. K¨uhrer, T. Hupperich, C. Rossow, and T. Holz, “Hell of a
handshake: Abusing TCP for reﬂective ampliﬁcation DDoS attacks,” in
Proc. of USENIX Workshop on Offensive Technologies. San Diego,
CA, USA: USENIX, Aug. 2014.
[44] A. Langley, “Overclockign SSL,” blog post https://www.imperialviolet.
org/2010/06/25/overclocking-ssl.html, Jun. 2010.
[45] B. Laurie, G. Sisson, R. Arends, and D. Blacka, “DNS security
(DNSSEC) hashed authenticated denial of existence,” Internet Request
For Comments, RFC 5155, Mar. 2008.
[46] C. Lewis and M. Sergeant, “Overview of best email DNS-based list
(DNSBL) operational practices,” Internet Request For Comments, RFC
6471, Jan. 2012.
[47] Y. Lu and G. Tsudik, “Towards plugging privacy leaks in domain name
system,” in Proc. of IEEE International Conference on Peer-to-Peer
Computing. Delft, Netherlands: IEEE, Aug. 2010.
[48] J. Markoff and N. Perlroth, “Attacks used the Internet against itself to
clog trafﬁc,” New York Times, March 2013.
client
“Dnscurve
[49] Matthew Dempsky,
mdempsky/dnscurve/.
tool,”
https://github.com/
[50] J. Mauch, “Open resolver project,” Presentation, DNS-OARC Spring
2013 Workshop (Dublin), May 2013, https://indico.dns-oarc.net/
/contributionDisplay.py?contribId=24&sessionId=0&confId=0.
[51] W. Meng, R. Duan, and W. Lee, “DNS Changer remediation study,”
Talk at M3AAWG 27th, Feb. 2013.
[52] C. Metz, “Comcast trials (domain helper service) DNS hijacker,” The
Register, Jul. 2009.
[53] P. Mockapetris, “Domain names—implementation and speciﬁcation,”
RFC 1035, Internet Engineering Task Force, Nov. 1987.
[54] H. F. Nielsen, J. Gettys, A. Baird-Smith, E. Prud’hommeaux, H. Lie,
and C. Lilley, “Network performance effects of http/1.1, css1, and
png,” in SIGCOMM, Sep. 1997.
[55] NLnetLabs,
“Dnssec-trigger,” web
page
http://www.nlnetlabs.nl/
projects/dnssec-trigger/, May 2014.
[56] M. Nottingham, “HTTP/2 frequently asked questions,” web page
http://http2.github.io/faq/#why-is-http2-multiplexed, 2014.
[57] OpenDNS, “Dnscrypt,” http://www.opendns.com/technology/dnscrypt.
[58] ——,
https://github.com/opendns/
“Dnscrypt
proxy
tool,”
dnscrypt-proxy.
[59] ——, “Opendns website,” www.opendns.com, 2006.
[60] E. Osterweil, B. Kaliski, M. Larson, and D. McPherson, “Reducing the
X.509 attack surface with DNSSEC’s DANE,” in Proc. of Workshop
on Securing and Trusting Internet Names (SATIN), Teddington, UK,
Mar. 2012.
[61] M. Parthasarathy and P. Vixie, “draft-mohan-dns-query-xml-00,” Sep.
2011, work in progress (Internet draft draft-mohan-dns-query-xml-00).
[62] H. P. Penning, “Analysis of the strong set in the PGP web of trust,”
web page http://pgp.cs.uu.nl/plot/, Jan. 2014.
[63] P.
Ramaswami,
Ofﬁcial
“Introducing
DNS,”
http://googleblog.blogspot.com/2009/12/
Google
Public
Google
introducing-google-public-dns.html, Dec. 2009.
Blog
[64] S. Reifschneider,
“4.2.2.2: The
story behind a DNS legend,”
http://www.tummy.com/articles/famous-dns-server/.
[65] E. Rescorla and N. Modadugu, “Datagram Transport Layer Security
Version 1.2,” RFC 6347, Internet Engineering Task Force, Jan. 2012.
[66] C. Rossow, “Ampliﬁcation hell: Revisiting network protocols for DDoS
abuse,” in Proc. of ISOC Network and Distributed System Security
Symposium. San Diego, California, USA: The Internet Society, Feb.
2014.
[67] J. Salowey, H. Zhou, P. Eronen, and H. Tschofenig, “Transport Layer
Security (TLS) Session Resumption without Server-Side State,” RFC
5077, Internet Engineering Task Force, Jan. 2008.
[68] K. Schomp, T. Callahan, M. Rabinovich, and M. Allman, “On
measuring the client-side DNS infrastructure,” in IMC, Oct. 2013.
[69] S. Sengupta, “Warned of an attack on the Internet, and getting ready,”
New York Times, p. B1, Mar. 31 2012.
[70] H. Shulman, “Pretty bad privacy: Pitfalls of DNS encryption,” in
Proc. of 13th ACM Workshop on Privacy in the Electronic Society.
Scottsdale, Arizona: ACM, Nov. 2014, pp. 191–200.
[71] W. Simpson, “TCP cookie transactions (TCPCT),” Jan. 2011.
[72] A. Sullivan, “More keys
in the DNSKEY RRset at “.”, and
draft-ietf-dnsop-respsize-nn,” DNSOP mailing list, Jan. 2014, https:
//www.mail-archive.com/PI:EMAIL/msg05565.html.
[73] S. Sundaresan, N. Feamster, R. Teixeira, and N. Magharei, “Measuring
and mitigating web performance bottlenecks in broadband access
networks,” in Proc. of ACM IMC. Barcelona, Spain: ACM, Oct. 2013,
p. to appear.
[74] R. Vaughn and G. Evron,
“DNS ampliﬁcation attacks,” http:
//isotf.org/news/DNS-Ampliﬁcation-Attacks.pdf, Mar. 2006.
[75] Verisign Labs, “DNS over JSON prototype,” 2014.
[76] P. Vixie, “Extension mechanisms for DNS (EDNS0),” Internet Request
For Comments, RFC 1999, Aug. 1999.
[77] P. Vixie and A. Kato, “DNS referral response size issues,” May 2012,
internet draft.
[78] P. Vixie, “What DNS is not,” ACM Queue, Nov. 2009.
[79] N. Weaver, C. Kreibich, B. Nechaev, and V. Paxson, “Implications of
Netalyzr’s DNS measurements,” in Proc. of Workshop on Securing and
Trusting Internet Names (SATIN), Apr. 2011.
[80] W. Wijngaards and G. Wiley, “Conﬁdential dns,” Mar. 2014, internet
draft.
[81] S. Woolf and D. Conrad, “Requirements for a Mechanism Identifying
a Name Server Instance,” RFC 4892, Internet Engineering Task Force,
Jun. 2007.
[82] P. Wouters, “Using DANE to associate OpenPGP public keys with
email addresses,” Feb. 2014, internet draft.
[83] P. Wouters and J. Abley, “The edns-tcp-keepalive EDNS0 option,” Oct.
2013, work in progress (Internet draft draft-wouters-edns-tcp-keepalive-
00).
[84] F. Zhao, Fukuoka, Y. Hori, and K. Sakurai, “Analysis of existing privacy-
preserving protocols in domain name system,” in IEICE TRANSAC-
TIONS on Information and Systems, May 2010.
[85] F. Zhao, Y. Hori, and K. Sakurai, “Analysis of privacy disclosure in DNS
query,” in 5th Intl. Conf. on Multimedia and Ubiquitous Engineering.
Loutraki, Greece: FTRI, Apr. 2007.
[86] L. Zhu, Z. Hu, J. Heidemann, D. Wessels, A. Mankin, and N. Somaiya,
“Connection-oriented DNS to improve privacy and security (extended),”
USC/Information Sciences Institute, Tech. Rep. ISI-TR-2015-695, Feb.
2015.
186186
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:44 UTC from IEEE Xplore.  Restrictions apply.