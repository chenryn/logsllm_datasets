最近在研究关于聊天软件的一些信息获取。
对于微信来说获取个人信息就是读取内存中的字符串，这些字符包括电话、数据库key、username、
wxid等等，但是微信不同的版本字符串在内存中的位置不一样，也就是偏移不一样，看之前的 BIOPASS 
RAT ,它的微信模块定位使用版本号，不同版本号的偏移不一样。
艹老师说这种方式太麻烦了，微信每更新一个版本就得更新偏移。于是，我研究了根据微信特定数据结
构定位的方式，这种方式可以全版本通用。
定位
因为我的主要目的是获取数据库的key，通过看雪的这篇文章
https://bbs.pediy.com/thread-251303.htm 
可以得到我的key
地址是 14DA32A0
 打开CE搜索这个地址会得到一个基址
0xE0,0xF6,0x79,0x4E,0x14,0xE9,0x41,0x02,0x99,0xD4,0x0C,0x40,0xFD,0x29,0x57,0x2F,
0x5A,0x19,0x84,0xFD,0x06,0xBE,0x4A,0xBF,0x82,0xBE,0xAE,0xC7,0x61,0x94,0xD2,0xD1
在x32dbg定位到这个地方
这个基址不仅保存了数据库key的地址，还有wxid的地址，在往上可以翻到头像地址、username、手机
号等等信息。
说明这是微信中一个保存个人信息的全局变量的地方，那么只需要找可以明显定位到这里的机器码或字
符串就可以了，这个可能需要不同微信版本反复测试，我比较懒，找了一个比较明显的字符串。
在往下滑可以看到公钥和私钥
而 -----BEGIN PUBLIC 就是一个很明显的特征。
代码
于是根据这个思路编写代码，先寻找 -----BEGIN PUBLIC 字符串的地址，再反向搜索这个地址的地址，为
简单称这个地址为地址2吧。然后地址2要大于 WeChatWin.dll 的基址。
我们就能定位到上图中 7A05201C 的地方。然后以这个地方为原点，向上或向下取偏移获取数据，就能
得到个人信息的数据了。
这里给出我定位的数据结构偏移
手机型号 
$-C 文本长度 
$-1c地址
读wxid 
$-44 文本长度 
$-54 地址指针
读微信昵称 
$-5c 文本长度 
$-6c 地址
头像地址 
$-1a8 地址指针
$-198 长度
$-190 地址指针
$-180 长度
手机号
$-43c 地址
$-42c 长度
公钥
$ 文本指针地址
$+10 长度
私钥
$+18 文本指针地址
$+28 长度
数据库
$-90 数据库密钥指针地址 
$-8c 指针长度
用易语言简单实现的demo
程序运行截图
测试微信全版本都可以使用。