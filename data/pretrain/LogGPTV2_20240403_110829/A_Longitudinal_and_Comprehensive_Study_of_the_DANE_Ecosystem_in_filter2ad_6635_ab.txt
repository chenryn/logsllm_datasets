extension, however, has not been standardized yet.
Dukhovni et al. publish DANE deployment statistics pe-
riodically [34, 77]; they recently found that 1.4M domains
publish signed MX records that have TLSA records. Web-based
debugging tools such as DANE SMTP Validator [32] and
DANECheck [25] can help administrators verify correct
DANE deployment.
Our study extends these prior studies in three ways.
First, we examine all TLSA records in three of the largest
gTLDs and two ccTLDs with the highest DNSSEC deploy-
ment rates for 24 months to investigate the status of DANE
deployment longitudinally. Second, we primarily focus on
how recent incentives for DANE deployment [13,19,59] have
impacted on the dynamics of DANE ecosystem; this is in con-
trast to the earlier work in 2014 [83] that focused on the very
early stage of DANE deployment where nobody relied on
616    29th USENIX Security Symposium
USENIX Association
TLD
.com
.net
.org
.nl
.se
Measurement Period
2017-10-22 – 2019-10-31
2017-10-22 – 2019-10-31
2017-10-22 – 2019-10-31
2017-10-22 – 2019-10-31
2017-10-22 – 2019-10-31
Number
72,981,465
7,440,488
6,112,057
4,369,343
860,413
MX Records
Percent
with TLSA
0.7%
7.3%
7.0%
9.8%
38.2%
Table 1: Overview of the Daily datasets for this study. The number
and percentage of the domains that have TLSA records are as-of
October 31, 2019.
MX records and the corresponding TLSA records. In particular,
we carry out a longitudinal study to see how the email servers
have changed their MX and TLSA records over time. Let us ﬁrst
introduce the datasets of our study.
4.1 Datasets
Our goal in this section is to conduct a large scale and longitu-
dinal measurement study of DANE deployment in the email
ecosystem by focusing on their authoritative DNS servers.
Daily Scans: MX and TLSA records We utilise data from
the OpenINTEL [60, 80] measurement platform that fetches
DNS records for all registered domains in many TLDs, cur-
rently covering around 65% of the global name space. For
our study, we select the data for three generic TLDs (.com,
.net and .org) and two country code TLDs (.nl and .se);
we ﬁnd that there are 178M resolvable domains in the dataset
for these TLDs. We choose the .com, .net, and .org TLDs
because they are the three largest TLDs, and .nl and .se
because these countries show high rates of the DNSSEC de-
ployment [33], which is essential for DANE. For each domain,
we ﬁrst extract SOA and DNSKEY records with the correspond-
ing RRSIG records, and MX records. After that, we construct a
domain name to query TLSA records based on each MX record2.
The daily snapshots were fetched for 24 months between Oc-
tober 22, 2017 and October 31, 2019. Table 1 summarizes
this dataset.
Taken together, the daily scans represent one of the most
comprehensive datasets of DANE observations.
4.2 DANE prevalence
We begin by examining how DANE has been deployed by
email servers by focusing on the number of second-level do-
mains that serve at least one TLSA record for their MX records.
Figure 2 plots the fractions of .com, .net, .org, .nl, and .se
second-level domains that publish at least one TLSA record for
their MX records. We ﬁrst notice that DANE deployment for
MX records is very rare in gTLDs: only between 0.6% (.com)
2Because the SMTP protocol can use three possible port numbers (25,
465, and 587), we send three TLSA record requests for each MX record.
Figure 2: The percentages of domains with MX records in .com,
.org, .net, .nl, and .se domains that have TLSA records from
the Daily dataset are shown. 0.60% (.com) ∼ 0.73% (.net) of all
domains with MX records have corresponding TLSA records in the
latest snapshot.
and 0.73% (.org) have TLSA records for their MX records.
However, we also make the following observations:
First, we see that the fraction of MX records with TLSA
records is steadily growing. For example, the fraction in .com
rose from 0.10% in October 2017 to 0.65% in October 2019
showing more than 400K MX records have accompanying
TLSA records.
Second, we notice that while the overall DANE deployment
rate in the three gTLDs is quite low, the deployment rate is
much higher in .nl and .se. Recent studies [23, 49] reported
a similar trend for DNSSEC deployment in these two ccTLDs,
due to the ﬁnancial incentives from the registries.
Third, we observe that the growth in DANE deployment is
mainly due to the fact that a small number of email service
providers provide email hosting services leveraging TLSA
records such as one.com and Loopia. That is, we ﬁnd that
the “spikes” we observe in uptake are due to some popular
email service providers that provide email hosting services to
many domains. For example, the spike on November 23, 2018
was due to a single hosting provider (one.com) publishing
a single TLSA record, which impacted 934,066 domains that
pointed their MX records to one.com to outsource their email
services.3 Similarly, Loopia (a Swedish service provider)
published TLSA records for their MX records, which resulted
in DANE deployment for its 76,776 domains instantly in
September 2019. However, we are also able to observe drops
in August 2019, which were caused by one.com that removed
its TLSA records for some MX records making 12,658 .com,
.net, and .org domains temporarily forgo their TLSA records.
3This spike is not a coincidence; one of our co-authors presented on
DANE to the operator community two days before this spike, and we know
from private communication this inﬂuenced the decision of one.com to
enable DANE.
USENIX Association
29th USENIX Security Symposium    617
 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.801/1804/1807/1810/1801/1904/1907/1910/19active24.cz% of domains with TLSA records.com.net.org 0 5 10 15 20 25 30 35 40one.comloopia.se.nl.seFigure 3: The percentages of domains publishing both MX and TLSA
records as a function of website popularity are shown. More popular
websites are more inclined to deploy DANE for their email services.
This change was reverted in September 2019. We suspect
that one.com migrated these domains to other MX records.
This observation suggests that email hosting services play a
signiﬁcant role in DANE deployment for SMTP.
Next, we examine whether popular domains are more likely
to deploy DANE. Figure 3 shows the percentage of the MX
records in the Alexa top 1M domains in .com, .net, .org,
.nl, and .se that publish TLSA records, as of October 31,
2019. We ﬁrst observe that popular websites are more likely to
have TLSA records to support DANE, but the overall DANE de-
ployment remains low even among the most popular domains;
for example, the average percentage of domains with TLSA
records among the top 100,000 popular domains is 0.45%,
while that of the bottom 100,000 popular domains is 0.21%.
However, we cannot know if all of these domains correctly
deployed DANE only by analyzing TLSA records. We have
to check (1) if their TLSA records are correctly signed, (2)
if they support STARTTLS to present their certiﬁcates, and
(3) if the certiﬁcates are consistent with the corresponding
TLSA records. Thus, we perform a more detailed examination
of whether they operate DANE correctly in the following
sections.
4.3 Security considerations
We began by focusing on the second-level domains that serve
at least one TLSA record for their MX records. However, given
that domains can serve multiple MX records for better availabil-
ity, it is ideal to deploy TLSA records for all of their MX records
to stop active attackers who intentionally attempt to disrupt
an SMTP connection to the mail servers with TLSA records
and steer a victim SMTP client towards the mail servers that
are not equipped with TLSA records.
We now try to understand if domains have fully deployed
DANE by investigating the number of domains that have
deployed TLSA records for all of their MX records. Figure 4
shows the ratio of domains that fully deployed TLSA records
and we make a number of observations.
First, we found that a substantial portion of domains from
Figure 4: The percentage of domains with at least one TLSA record
that also fully deployed TLSA records for all of their MX records.
.com, .net, .org, and .nl partially deployed TLSA records;
on average 18% of .com, .net, .org and 39% of .nl do-
mains did not fully deploy TLSA records in our oldest snap-
shot, which implies that these domains were susceptible to
downgrade attacks. The fraction of these domains is, however,
steadily decreasing; for example, in the latest snapshot, we
found only less than 5% of .com, .net, and .org domains
partially deployed TLSA records and 15% of .nl domains did
so. Second, we observe that large email providers (one.com
and loopia.se) partially deployed their TLSA records ﬁrst
and introduced DANE for all of their MX records a few days
later; for example, it took two days for one.com to fully de-
ploy TLSA records. We believe this to be an intentional action
to minimize the risk of potential mistakes during the deploy-
ment and conﬁguration of the TLSA records.
5 DANE Management
Recall that properly managing DANE for emails means that
a domain owner must (1) enable DNSSEC correctly by pub-
lishing DNSKEY and RRSIG records, and uploading a DS record
in the TLD zone, (2) publish a TLSA record, and (3) support
STARTTLS and serve a certiﬁcate that can be veriﬁed using
its TLSA record. Thus, we now investigate whether domains
with MX and TLSA records take all the necessary steps to sup-
port DANE correctly.
5.1 Dataset
Our goal in this section is to understand how domains (i.e.,
email servers) with MX and TLSA records deploy and operate
DANE correctly. The Daily dataset sufﬁces for studying the
deployment of TLSA records in the SMTP protocol at a coarse
granularity. However, it does not tell us whether the email
servers present their certiﬁcates, and whether the certiﬁcates
618    29th USENIX Security Symposium
USENIX Association
 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 10200k400k600k800k% of domains withMX and TLSA recordsAlexa Site Rank (bins of 10,000) 0 10 20 30 40 50 60 70 80 90 10001/1804/1807/1810/1801/1904/1907/1910/19% of domains that fully deployedTLSA records.com.net.org 0 10 20 30 40 50 60 70 80 90 100one.comloopia.se.nl.seVantage
Point
Oregon
Virginia
São Paulo
Paris
Sydney
Measurement Period
2019-07-11
through
2019-10-31
The number of
Certs
TLSA
10,526
11,821
10,521
11,806
10,470
11,771
10,531
11,819
11,770
10,484
Table 2: Overview of the Hourly datasets. The number of the col-
lected TLSA records and the certiﬁcates are as-of the last snapshot
on October 31, 2019.
are actually consistent with the TLSA records. Thus, we also
collect (1) all the certiﬁcates presented by the email servers
indicated in the MX records, and (2) the corresponding TLSA
records, to observe dynamics at the time scale of hours.
Hourly scans: certiﬁcates and TLSA records The follow-
ing steps detail our methodology to obtain certiﬁcates from
the mail servers that publish TLSA records.
1. We ﬁrst obtain all the MX and TLSA records from our Daily
dataset, which are updated everyday.
2. We developed a measurement SMTP client that initiates an
SMTP connection to an email server (that corresponds to
each MX record) through each of the SMTP port numbers
(i.e., 25, 465, and 587). The client then sends the STARTTLS
command to upgrade the SMTP connection to TLS, and
fetches the certiﬁcate every hour.
3. We also collect and validate TLSA records in terms of
DNSSEC every hour.
4. We deploy the measurement SMTP client in ﬁve different
vantage points around the world —Oregon (Amazon Web
Services [AWS] U.S. West), Virginia (AWS U.S. East),
São Paulo (AWS Brazil), Paris (AWS France), and Sydney
(AWS Australia)—to comprehensively understand how
email servers and their DNS servers behave. All measure-
ment clients are perfectly synchronized to minimize dis-
crepancies between DNS records and certiﬁcates across
the vantage points.4
We used the above methodology to gather measurements
by sending on average 11,972 TLSA record lookups as well
as collecting the certiﬁcate chains every hour from July 11,
2019 to October 31, 2019. We refer to these measurements as
the Hourly dataset and Table 2 summarizes this dataset.
Ethical Considerations Our primary ethical concern is
to minimize the potential performance risks associated with
target email servers by establishing STARTTLS connections
every hour. First of all, we have not sent any emails to the
4Measurement completion times may differ depending on the vantage
point. The average difference between the fastest and slowest vantage point
is only 13.9 seconds. It is possible that two vantage points may fetch two
different TLSA records if a rollover occurs exactly between the two scans, but
we believe this to be very unlikely.
Figure 5: The percentage of signed TLSA records (top) and the
percentage of them missing DS records (bottom) from the Hourly
dataset are plotted. About 80% of TLSA records are signed, but 20%
of them still miss DS records in the latest snapshot.
email servers. We have only collected the presented certiﬁ-
cates from the email servers after sending STARTTLS com-
mands. We also registered a PTR record5 for each of the ﬁve
measurement clients, which indicates a domain that runs a
webpage explaining the purpose of our measurements and in-
structions for the DNS and SMTP operators on how to opt out.
During the four month measurement period, we received ten
opt-out requests and excluded their domains and IP addresses
from the measurement.
5.2 Missing Components
We now examine whether domains that publish TLSA records
also (1) publish all the necessary DNSSEC records and (2)
support STARTTLS.
DNSSEC Recall from section 2 that a domain that publishes
TLSA records must properly deploy DNSSEC; TLSA records
must be signed by its private key, which corresponds to the
public key in the DNSKEY record, and have a DS record in the
parent DNS zone to create a chain of trust. We ﬁrst focus
on the TLSA records published by a domain that attempts to
deploy DNSSEC for DANE by generating RRSIGs using their
DNSKEYs; consistent with prior work [50,79], we refer to these
records as signed records.
We begin by examining the percentage of signed TLSA
records using the Hourly dataset (top of Figure 5). A key
observation is that DNSSEC deployment for TLSA records is
pervasive, showing that 80% of TLSA records are signed.
Next, we see how many signed TLSA records do not have
corresponding DS records; Figure 5 (bottom) shows the per-
centage of signed TLSA records that cannot be validated due
5This DNS record is used for the reverse DNS lookup; it maps the
associated domain or host name for the IP address.
USENIX Association
29th USENIX Security Symposium    619
 0 20 40 60 80 10007/2508/0808/2209/0509/1910/0310/1710/31Without DS records% of signed TLSA recordsDateVirginiaOregonParisSydneySao-Paulo 0 20 40 60 80 100% of signed TLSA recordsFigure 6: The percentage of the established SMTP connections that
fail to initiate TLS connections is shown.
to missing DS records. Interestingly, we observe that 18.5%
of the signed TLSA records do not have DS records. This is
somewhat in line with a recent study [22], which showed that
about 30% of signed domains do not upload DS records be-
cause of mismanagement by large hosting service providers
that provide authoritative DNS servers for their customers.
This means that the email servers that use those TLSA records
do not proﬁt from any of the security beneﬁts that DANE
provides even if they present certiﬁcates through START-
TLS, which are consistent with their TLSA records. This is
because DANE-supporting email servers for outgoing emails
should not use TLSA records that cannot be validated through
DNSSEC. Installing DS records in the parent zone often re-
quires a manual process where the domain administrator typi-
cally needs to contact its registrar. Thus we believe that the
CDNSKEY and CDS protocols, which allow the domain owner
to directly upload the DS record to the registry could mitigate
this overhead [46, 82].
STARTTLS Now, we turn our attention to the email servers
running on the MX records. Our goal is to understand how the
email servers support STARTTLS to present their certiﬁcates.
Recall that we set up SMTP clients for testing purposes. For
this goal, we ﬁrst register PTR records for the IP addresses
used for the SMTP clients to prevent our connections from
being denied by the email servers; in this way, each SMTP
client can initiate an SMTP connection for each email server.
However, when we attempt to make an SMTP connection, we
notice that on average some 20 email servers block our con-
nections in each round. Even though we register PTR records
in our DNS server and send not-spam requests to well-known
block removal centers such as Spamhaus [73], some email
servers still do not allow us to initiate SMTP connections be-
cause of their custom block lists. SMTP error codes explicitly
show us that our connections are rejected due to their spam
ﬁlters. We identify the STARTTLS related errors by pairing
the error codes and messages such as 500 indicating that the
email server does not understand the command, or 502 in-
Figure 7: The percentage of TLSA records that are DNSSEC invalid
due to (1) wrong DNSSEC conﬁgurations such as expired RRSIGs
and (2) TLSA records inconsistent with the certiﬁcates.
dicating that the (STARTTLS) command is not implemented.
We also consider errors in negotiating TLS connections such
as malformed certiﬁcate structures, handshake failures, and
no certiﬁcates suggested. Figure 6 plots the fraction of the
established SMTP connections for which we cannot negotiate
STARTTLS connections; note that on average 0.22% of email
servers do not implement STARTTLS, and 0.29% of those
supporting STARTTLS provide no or malformed certiﬁcates.
Taken together, these results show that the majority of the fail-
ure of correct DANE deployment is due to missing DS records
rather than absence of STARTTLS support; the average failure
rate of the SMTP servers due to unimplemented STARTTLS
is less than 0.2%, while the failure rate due to missing DS
records is 20%.
Incorrect Components
5.3
Providing (i) a signed TLSA record and its DS record from the
DNS and (ii) certiﬁcates via STARTTLS is not sufﬁcient to
properly operate DANE. The Certificate Association
Data of the TLSA records must be correct and consistent with
the certiﬁcate presented by the email server.
• DNSSEC validation: We examine the correctness and fresh-
ness of the RRSIGs records of TLSA records. To this end, we
use Unbound [76] to fetch all the necessary DNS records
(e.g., DNSKEYs and DS records and their corresponding
RRSIGs), and verify the TLSA records based on the time
of the scan. The reasons for the DNSSEC validation fail-
ures can be expired RRSIGs, RRSIGs inconsistent with their
DNSKEYs, malformed RRSIGs, etc.
• Certiﬁcate validation: We also examine if the TLSA
records are consistent with the presented certiﬁcates.
To this end, we build a validation program using
the OpenSSL library to verify given certiﬁcates based
on the Certificate Usage in the TLSA records.6
The reason for certiﬁcate validation failures can be
6We also used the attime option to have OpenSSL validate the certiﬁ-
cates as of the time of the scan.
620    29th USENIX Security Symposium
USENIX Association
 0 0.3 0.6 0.9 1.207/2508/0808/2209/0509/1910/0310/1710/31TLS Handshake Errors% of SMTP servers that fail to establish a TLS connectionDateVirginiaOregonParisSao-PauloSydney 0 0.2 0.4 0.6 0.8 1Unimplemented STARTTLS 0 5 10 15 2007/2508/0808/2209/0509/1910/0310/1710/31% of TLSA recordsthat fails validationDateDNSSECCertificatemismatched Certificate Usage, Selector, Matching
Type, or Certificate Association Data.
Figure 7 shows the distribution of the validation failure rea-
sons during our measurement period. We make the following