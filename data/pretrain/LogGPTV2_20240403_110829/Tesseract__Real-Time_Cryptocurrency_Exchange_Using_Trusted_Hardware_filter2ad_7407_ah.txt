[43] LIN, H.-Y., AND HARN, L. Fair reconstruction of a secret.
Information Processing Letters 55, 1 (7 July 1995), 45–47.
[44] LIND, J., EYAL, I., KELBERT, F., NAOR, O., PIETZUCH, P. R.,
AND SIRER, E. G. Teechain: Scalable blockchain payments
using trusted execution environments. CoRR abs/1707.05454
(2017).
[45] LIND,
I., PIETZUCH, P. R., AND SIRER,
E. G. Teechan: Payment channels using trusted execution
environments. In Financial Cryptography 4th Bitcoin Workshop
(2017).
J., EYAL,
[46] LUU, L., AND VELNER, Y.
paper,
KyberNetworkWhitepaper.pdf.
2017.
KyberNetwork white
https://kyber.network/assets/
[47] MAPPUM (PSEUDONYM).
Mercury – fully trustless
cryptocurrency exchange, 2015. https://bitcointalk.org/
index.php?topic=946174.0.
[48] MATETIC, S., AHMED, M., KOSTIAINEN, K., DHAR, A.,
SOMMER, D., GERVAIS, A., JUELS, A., AND CAPKUN, S.
ROTE: Rollback protection for trusted execution, 2017. http:
//eprint.iacr.org/2017/048.
[49] MCCORRY, P., HEILMAN, E., AND MILLER, A. Atomically
trading with Roger: Gambling on the success of a hardfork.
https://eprint.iacr.org/2017/694, 2017.
[50] MCCORRY, P., M ¨OSER, M., SHAHANDASHTI, S. F., AND HAO,
F. Towards Bitcoin payment networks. In Information Security
and Privacy - 21st Australasian Conference, ACISP (2016).
[51] MCKEEN, F., ALEXANDROVICH, I., BERENZON, A., ROZAS,
C., SHAFI, H., SHANBHOGUE, V., AND SAVAGAONKAR,
U.
Innovative instructions and software model for isolated
execution. In HASP (2013).
[52] MCMILLAN, R. $1.2m hack shows why you should never store
Bitcoins on the internet. https://www.wired.com/2013/11/
inputs/, 2013.
[53] MILLER, A. Provable Security for Cryptocurrencies. PhD thesis,
University of Maryland, College Park, 2016.
[54] NAKAMOTO, S. Bitcoin: A peer-to-peer electronic cash system.
Bitcoin.org (2008).
[55] NAKAMOTO,
S.
https://bitcointalk.org/
index.php?topic=1786.msg22119#msg22119, 2010.
[56] OMNI. http://www.omnilayer.org/.
[57] OVED, M., AND MOSITES, D. Swap: A peer-to-peer protocol
https://swap.tech/
for trading Ethereum tokens, 2017.
whitepaper/.
[58] PASS, R., SEEMAN, L., AND ABHI SHELAT. Analysis of the
In Eurocrypt
Blockchain protocol in asynchronous networks.
(2017).
[59] PASS, R., SHI, E., AND TRAMER, F. Formal abstractions for
attested execution secure processors. In Eurocrypt (2017).
[60] POELSTRA, A., BACK, A., FRIEDENBACH, M., MAXWELL,
In Financial
G., AND WUILLE, P.
Cryptography Bitcoin Workshop. https://blockstream.com/
bitcoin17-final41.pdf.
Conﬁdential assets.
[61] POON,
J.,
AND DRYJA,
T.,
2016.
https://
lightning.network/lightning-network-paper.pdf.
[62] PORTELA, B., BARBOSA, M., SCERRI, G., WARINSCHI, B.,
BAHMANI, R., BRASSER, F., AND SADEGHI, A.-R. Secure
multiparty computation from SGX. In Financial Cryptography
(2017).
22
[63] PORTNOY, E., AND ECKERSLEY, P.
Intel’s management
engine is a security hazard, and users need a way to disable
it.
https://www.eff.org/deeplinks/2017/05/intels-
management-engine-security-hazard-and-users-
need-way-disable-it.
2017.
[64] PROFITGENERATOR.
- decentralized token
EtherDelta
exchange,
https://steemit.com/ethereum/
@profitgenerator/etherdelta-decentralized-token-
exchange.
[65] REDMAN,
Altcoin exchange performs ﬁrst atomic
https:
swap between bitcoin and ethereum,
//news.bitcoin.com/altcoin-exchange-performs-
first-atomic-swap-between-bitcoin-and-ethereum/.
Engineers demonstrate zcash/bitcoin atomic
https://news.bitcoin.com/engineers-
[66] REDMAN, J.
swaps, 2017.
demonstrate-zcashbitcoin-atomic-swaps/.
2017.
J.
[67] ROSENFELD, M.
Colored
coins.
bitcoil.co.il/files/Colored%20Coins.pdf
https://bitcoil.co.il/BitcoinX.pdf, 2012.
https://
and
[68] ROSENFELD, M. Analysis of hashrate-based double spending.
http://arxiv.org/abs/1402.2009, 2014.
[69] RUFFING, T., MORENO-SANCHEZ, P., AND KATE, A. P2P
In NDSS 2017
Mixing and Unlinkable Bitcoin Transactions.
(2017).
[70] SCHUH, F., AND LARIMER, D.
BitShares.
https:
//bravenewcoin.com/assets/Whitepapers/bitshares-
financial-platform.pdf.
[71] SCHUSTER, F., COSTA, M., FOURNET, C., GKANTSIDIS, C.,
PEINADO, M., MAINAR-RUIZ, G., AND RUSSINOVICH, M.
VC3: Trustworthy data analytics in the cloud using SGX.
In
IEEE S&P (2015).
[72] SHAPESHIFT. https://shapeshift.io/.
[73] SONG,
Atomic
swaps,
J.
2017.
https://
bitcointechtalk.com/atomic-swaps-d6ca26b680fe.
[74] STANDARD #20, E. T.
EIPs/issues/20.
https://github.com/ethereum/
[75] STRACKX, R., AND PIESSENS, F. Ariadne: A minimal approach
to state continuity. In 25th USENIX Security (2016).
BitUSD isn’t worth the trouble.
[76] SZTORC, P.
www.truthcoin.info/blog/bitusd/, 2015.
http://
[77] TODD, P.
OP CHECKLOCKTIMEVERIFY.
BIP 65,
https://github.com/bitcoin/bips/blob/master/bip-
0065.mediawiki, 2014.
[78] TRAMER, F., ZHANG, F., LIN, H., HUBAUX, J.-P., JUELS, A.,
AND SHI, E. Sealed-glass proofs: Using transparent enclaves to
prove and sell knowledge. In Euro S&P (2017).
[79] TRAN, M., LUU, L., KANG, M. S., BENTOV, I., AND SAXENA,
P. Obscuro: A secure and anonymous Bitcoin mixer using SGX,
2017.
[80] https://bitcoin.org/en/glossary/locktime.
[81] WARREN, W., AND BANDEALI, A.
0x: An open protocol
for decentralized exchange on the Ethereum blockchain, 2017.
https://0xproject.com/pdfs/0x white paper.pdf.
[82] WUILLE, P., ET AL. https://bitcoincore.org/en/2017/
03/23/schnorr-signature-aggregation/.
[83] WUILLE, P., MAXWELL, G., ET AL., 2015.
github.com/bitcoin-core/secp256k1.
https://
[84] XU, Y., CUI, W., AND PEINADO, M. Controlled-channel
attacks: Deterministic side channels for untrusted operating
systems. In Security and Privacy (SP), 2015 IEEE Symposium
on (2015), IEEE, pp. 640–656.
23
[85] YOUNG, J.
China imposes new capital controls; Bitcoin
price optimistic, 2016.
https://cointelegraph.com/
news/china-imposes-new-capital-controls-bitcoin-
price-optimistic.
[86] ZHANG, F., CECCHETTI, E., CROMAN, K., JUELS, A., AND
SHI, E. Town Crier: An authenticated data feed for smart
contracts. In CCS (2016).
A Proof of Security for ACCS
Per Deﬁnition 1,
requirement holds for
described in Section 2.
let us prove that the all-or-nothing
that we
the Πaccs protocol
A, TXS
We use TXOUTA, TXOUTB to denote the outputs
of the transactions TXA, TXB, respectively. We denote
by TXS
B the transactions that spend TXOUTA and
TXOUTB in steps 3 and 4 of Πaccs, respectively.
√
Proposition 1. Assume that s0 = Ω(
t0), and that any
Bitcoin client that wishes to submit a valid transaction
will be able to broadcast the transaction and have it
included in one of the next s0 blocks. Assume that
the probability of reversing c0 Bitcoin blocks or 4c0
Litecoin blocks is negligible. Let E0 denote the event that
the all-or-nothing property holds w.r.t. the transactions
B. If hash(·) is preimage-resistant and the
TXS
signature scheme is existentially unforgeable, then ¬E0
occurs with negligible probability.
A and TXS
Proof sketch. We deﬁne the following events:
• E1 ={TXA was reversed after Bob broadcasted TXB}
• E2 = {TXB was reversed after Alice revealed x}
• E3 ={Bob spent TXOUTA before Alice revealed x}
• E4 = {Alice spent both TXOUTA and TXOUTB
without forging a signature}
• EF = {The adversary forged a signature}
A was conﬁrmed by the Bitcoin network}
• EA ={TXS
B was conﬁrmed by the Litecoin network}
• EB ={TXS
It is enough to prove that Pr[¬E0 ∩¬EF ] is negligible,
because Pr[EF ] is negligible by assumption and
Pr[¬E0] = Pr[(¬E0 ∩ EF )∪ (¬E0 ∩¬EF )]
≤ Pr[EF ] + Pr[¬E0 ∩¬EF ] .
Assume that EF did not occur.
If Alice redeems
TXOUTB then Bob will be able to redeem TXOUTA
unless either the block that contains TXA was reversed
on the Bitcoin blockchain (event E1), or TXOUTA was
spent after the c0 + t0 + s0 timeout expired (event E4).
More formally, we have EA ∩¬EB ∩¬EF ⊆ E1 ∪ E4.
Assume again that EF did not occur. If Bob redeems
TXOUTA then Alice will be able to redeem TXOUTB
unless either the block that contains TXB was reversed
on the Litecoin blockchain (event E2), or TXOUTB never
appeared on the Litecoin blockchain (event E3). More
formally, we have EB ∩¬EA ∩¬EF ⊆ E2 ∪ E3.
Therefore, we obtain
Pr[¬E0 ∩¬EF ]
= Pr(cid:2)(cid:0)(EA ∩¬EB)∪ (EB ∩¬EA)(cid:1)∩¬EF
(cid:3)
≤ Pr[EA ∩¬EB ∩¬EF ]+Pr[EB ∩¬EA ∩¬EF ]
≤ Pr[E1 ∪ E4] + Pr[E2 ∪ E3]
≤ Pr[E1] + Pr[E2] + Pr[E3] + Pr[E4] .
By assumption, Pr[E1] and Pr[E2] are negligible since c0
is large enough. Furthermore, Pr[E3] = negl(λ ) because
the event E3 implies that Bob computed a preimage of
hash(Y ).
To bound Pr[E4], we need to consider the event that the
Bitcoin chain grew by t0 + s0 blocks before the Litecoin
chain grew by 4t0 blocks.
If this event occurs, then
Alice will be able to redeem TXOUTA ﬁrst, and still
have enough time to redeem TXOUTB too. Note that the
Bitcoin network is expected to generate only t0 blocks by
the time that the Litecoin network generated 4t0 blocks.
5 ) be a random variable with
negative binomial distribution that counts the total
number of blocks that both the Bitcoin and Litecoin
networks generated by the time that the Bitcoin network
generated t0 + s0 blocks, hence E[Z] = 5(t0 + s0). By
using a standard tail inequality [17, 26] for the binomial
distribution B(µ · E[Z], 1
Let Z = Z(t0 + s0, 1
5 ) with µ (cid:44) t0
t0+s0
, we obtain
Pr[E4] = Pr[Z  t0 + s0
1
B(µ · E[Z],
= Pr
5
µ −1)2µ(t0+s0)
1; ++i,dirvec>>=1) {
if( (branch[i]).empty() ) {
sha256double(curr, curr, curr);
continue;
}
if(dirvec & 1)
sha256double(curr, branch[i], curr);
else
sha256double(branch[i], curr, curr);
}
byte_swap(curr, SHA256_DIGEST_LENGTH);
return memcmp(curr, root, SHA256_DIGEST_LENGTH);
}
Figure 19: Verify authentication path of a deposit.
time_t renew(time_t timestamp, long user_id, cointype fee){
if (book.find(user_id) == book.end()
|| timestamp + RENEW_PERIOD > book[user_id].timeout
|| book[user_id].left < fee) {
return -1;
} else {
book[user_id].volume -= fee;
book[user_id].left -= fee;
timestamp = max(book[user_id].timeout,
timestamp + DEPOSIT_PERIOD);
book[user_id].timeout = timestamp;
return timestamp;
}
}
24
Figure 20: Renewal order.