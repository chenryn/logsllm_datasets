Making (and Hacking) the DEFCON 17 Badge 
by Joe Grand aka Kingpin
Me.
electrical engineer. 
hardware hacker. 
daddy.
Last Year
This Year
Hackers: The Next Generation
Introduction
Hardware
Firmware
Manufacturing
DEFCON 17 Haiku
Joe Grand aka Kingpin
Electronic badge
Audio input
Affects LED output
Sound and light combined
Upload new ﬁrmware
With serial bootloader
Voltage reassigned
Puzzle of seven
Badge-to-badge interfacing
Using I2C
Hack badge for prizes
Clever modiﬁcations
Can you impress me?
A Poem.
Microphone
RGB  LED
Freescale DSC 
& Testpoints
★ Bootloader
★ Party Mode
★ Quiet Mode
★ Sleep
★ ???
Badge Operation
★ Fall 2008: Recover from DEFCON 16
★ December 2008: Initial design & parts selection
★ January 2009: Prototype hardware design
★ February: PCB design completed, production order
★ March: Production component orders
★ April: Firmware frozen
★ May: All components shipped to e-Teknet China
★ June: Wait for Customs to release the only box 
containing parts we couldn't easily get duplicates of
★ July: Badge assembly/test
Timeline
Customs: China v. UPS
FAIL
China wins!
FedEx gets a small :(, too
★ Digital Signal Controller
๏ Part of the MC56F8xxx family
๏ Newly released
๏ Freescale gave us alpha samples to begin badge 
development back in November 2008
๏ Main product page: http://tinyurl.com/lyorks
๏ Direct link to data sheet: www.freescale.com/
files/dsp/doc/data_sheet/MC56F8006.pdf
๏ John Winters, co-designer of this part, is here 
at DEFCON!
Freescale MC56F8006
Freescale MC56F8006
It's Not Easy Picking an LED
★ AAA3528SURKQBDCGKC09
๏ Rear-mounting
๏ Three individual diodes in single package
๏ 200/80/90mcd @ 20mA (R/G/B)
Kingbright RGB LED
★ Dr. Hugh Knowles developed ﬁrst balanced 
armature receiver for hearing aids
★ Developed the ﬁrst silicon/MEMS microphone in 
1988
★ First moon landing: Neil Armstrong was wearing a 
Plantronics headset with Knowles microphone
★ Nearly 1 billion sold
๏ Used in laptops, cellphones, headsets
★ www.knowles.com
Knowles Acoustics Microphone
Knowles Acoustics Microphone 2
★ SPM0408LE5H-TB
๏ Rear-mounting
๏ Ampliﬁed (20dB gain)
๏ RF protected
Development Hardware
Freescale MC56F8006-DEMO board + custom circuitry
NOTE: RESISTORS ARE IN OHMS +/- 5% AND CAPACITORS ARE IN MICROFARADS, X7R UNLESS
OTHERWISE NOTED. SEE BOM FOR ACTUAL VOLTAGE AND SPECIFICATION.
VCC
CR2032, 3V @ 225mAh
VSS_IO2
27
VSS_IO
13
VSSA
9
VDDA
8
VDD_IO
26
GPIOB0/SCL
21
GPIOB1
2
TMS
31
TDO
32
TDI
30
TCK
14
RESET
15
GPIOC1
11
GPIOC2
10
GPIOC4/ANB8
5
GPIOC5
6
GPIOA0/PWM0
29
GPIOA1/PWM1
28
GPIOA2/PWM2
23
GPIOA3
24
GPIOA4
22
GPIOA5
20
GPIOC6
7
GPIOC0
12
GPIOA6
18
GPIOB5
4
GPIOB3
16
GPIOB2
17
GPIOB4/SDA
19
GPIOF0
25
GPIOB7/TXD
3
GPIOB6/RXD
1
U1
MC56F8006VLC
0 ohm
R3
0 ohm
R2
0 ohm
R1
Badge Address Selection (R1-R3)
Uber = R1, R2, R3
Goon = R1, R2
Contest = R1, R3
Speaker = R1
Vendor = R2, R3
Press = R2
Human = DNP
SCL
SDA
VCC
0.1uF
C1
0.1uF
C2
VCC
4
1
3
2
D1
AAA3528SURKQBDCGKC09
VCC
A1
GREEN
BLUE
RED
BT1
AMP 796136-1
GND
2
VCC
1
GND
5
GND
7
GND
6
OUT
3
GAIN
4
MK1
SPM0408LE5H-TB
0.47uF
C3
A0
10k
R5
10k
R4
VCC
MICOUT
MICPWR
100
R6
TDI
TDO
TCK
RST
TMS
VCC
A2
TXD
RXD
GND
Schematic
DEFCON 17 Circuit Board Badge
DEFCON 17 Circuit Board Badge
DEFCON 17 Circuit Board Badge
DEFCON 17 Circuit Board Badge
Bill-of-Materials
Bill-of-Materials
Bill-of-Materials
Note: Refer to schematic for R1, R2, R3 population requirements
Note: Refer to schematic for R1, R2, R3 population requirements
Note: Refer to schematic for R1, R2, R3 population requirements
Note: Refer to schematic for R1, R2, R3 population requirements
Note: Refer to schematic for R1, R2, R3 population requirements
Item
Quantity Reference
Manufacturer
Manuf. Part #
Distributor
Distrib. Part #
Description
1
1
BT1
AMP
796136-1
Digi-Key
A99327-ND
Single-cell battery holder for CR2032, SMD
1a
1
N/A
Panasonic
CR2032
Digi-Key
P189-ND
CR2032 Lithium 3V Coin Cell Battery (225mAh)
2
2
C1,C2
Kemet
C0603C104K4RACTU
Digi-Key
399-1096-2-ND
0.1uF ceramic capacitor, 16V, X7R, 0603
3
1
C3
Kemet
C0603C474K4RACTU
Digi-Key
399-4922-2-ND
0.47uF ceramic capacitor, 16V, X7R, 0603
4
1
D1
Kingbright
AAA3528SURKQBDCGKC09
N/A
N/A
LED, RGB, 200/80/90mcd @ 20mA, 3.5mm x 2.8mm, SMD
5
1
MK1
Knowles Acoustics
SPM0408LE5H-TB
N/A
N/A
Microphone, 20dB internal pre-amp, SMD
6
3
R1,R2,R3
Panasonic
ERJ-3GEY0R00V
Digi-Key
P0.0GTR-ND
0 ohm, 5%, 1/10W, 0603
7
2
R4,R5
Panasonic
ERJ-3GEYJ103V
Digi-Key
P10KGTR-ND
10k, 5%, 1/10W, 0603
8
1
R6
Panasonic
ERJ-3GEYJ101V
Digi-Key
P100GTR-ND
100, 5%, 1/10W, 0603
9
1
U1
Freescale
MC56F8006VLC
Avnet
N/A
Microcontroller/Digital Signal Controller, LQFP32
9a
1
N/A
N/A
N/A
Avnet
N/A
Microcontroller programming service
10
1
PCB
e-Teknet
DC17 1.0
N/A
N/A
PCB (includes assembly and testing)
Bill-of-Materials
Badge Shape Concepts
The badges are 
all puzzle pieces! Want 
to see a picture of 
them all together?
Assembly Drawing: Human
Assembly Drawing: Speaker
Assembly Drawing: Goon
Assembly Drawing: Vendor
Assembly Drawing: Contest
Assembly Drawing: Press
Assembly Drawing: Uber
Assembly Drawing: Close-Up
Battery Life Estimates
Freescale
CodeWarrior 
for 56800/E 
Digital Signal 
Controllers
★ Free for up to 16KB Flash
★ All tools on DEFCON CD (for real, this time)
★ http://tinyurl.com/kuwloq
Development Environment
Processor 
Expert
★ GUI for peripheral conﬁguration
★ Generates required drivers/function code for 
desired modules
Development Environment 2
★ Audio/signal processing function
★ Separates input signal from mic into N discrete 
bins (frequency elements)
★ Calculates power of each bin 
★ RGB LED color and brightness vary based on 
sound/frequency
Fast Fourier Transform (FFT)
Badge-to-Badge Communication
★ I2C
๏ SCL (Serial Clock)
๏ SDA (Serial Data)
๏ GND
★ Human = Master
★ Non-Human = Slaves
★ As long as they are all on the bus, it doesn't 
matter what order they are connected
★ Master only checks for slaves on power-up 
๏ Make sure slave badges are on, then power 
master
Badge-to-Badge Communication 2
★ Individually addressable
๏ Three resistors for setting device address
★ Data format (7 bytes)
๏ Address (1) : Red (2) : Green (2) : Blue (2)
Static Serial Bootloader
★ Serial port + HyperTerminal = Load your own 
ﬁrmware onto the badge
๏ TX, RX, GND
๏ Level-shifter required (HHV kit!)
★ Enabled for 10 seconds on power-up
★ When modifying the User Code, read the 
comments in cpu.c
๏ Need to ensure reset vector points to 
bootloader and not user code
•
Otherwise, you'll never be able to get to the 
bootloader
Static Serial Bootloader 2
Static Serial Bootloader 3
★ Simply upload hex ﬁle and the badge will do the rest...
Break Glass In Case Of Bricking
★ MC56F8006 typically programmed through JTAG 
interface
๏ Uses CodeWarrior USB TAP hardware, 
www.freescale.com/webapp/sps/site/
prod_summary.jsp?code=USBTAP
★ But, there is no direct JTAG connector on the 
badge
Break Glass In Case Of Bricking
★ I built a small header board that connects to the 
JTAG test points on the badge using pogo pins
★ Unit will be available in the Hardware Hacking 
Village for emergencies
★ You could solder a 2x7 male header onto 
prototyping area of the badge and connect wires 
to test points
Break Glass In Case Of Bricking
★ Use in conjunction with CodeWarrior or 56800E 
Flash Programmer tool to reload original 
ﬁrmware (including new bootloader)
Production Assembly @ e-Teknet
Production Assembly @ e-Teknet
Production Assembly @ e-Teknet
Speaker = 200
Goon = 200
Press = 200
Vendor = 100
Contest = 100
Uber = 50
Human = 5844
Total = 6694
Total Badge Types
Collect them 
all!!@#
A Labor of Love...
Documentation
3.9% 7:20
Research
4.6% 8:30
Meetings
6.5% 12:05
Hardware
32.7% 60:45
Admin
7.8% 14:35
TOTAL: 186 hours
Firmware
44.5% 82:45
Badge Hacking Contest HQ @ 
Hardware Hacking Village
Complete source code, schematics, etc. on DEFCON CD
Submissions due to 
Kingpin @ HHV by 
2pm Sunday
Previous results at www.grandideastudio.com/
portfolio/defcon-14-badge, /defcon-15-badge, 
& /defcon-16-badge
Now w/ 
Black Badge 
status!
Badge Hacking 
Contest
This project did not  
happen in a vacuum.
e-Teknet - PCB manufacturing & assembly 
(esp. Mike, Sam, Thomas, Kitty)
Freescale (esp. John Winters, Dennis Hicks, 
Erin Greene, Chris Coleman, William Jiang)
The Dark Tangent, Black Beetle, Neil
Keely & Ben
THE END!
PI:EMAIL
www.grandideastudio.com