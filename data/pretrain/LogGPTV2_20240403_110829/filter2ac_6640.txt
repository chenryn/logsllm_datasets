### Title: Battle of Windows Services: A Silver Bullet for Automated Discovery of File Privilege Escalation Bugs

#### Abstract:
System services have always been a critical component of Windows 10. In recent years, numerous privilege escalation vulnerabilities have been discovered within these services. While fuzzing has proven effective in automating the detection of memory corruption vulnerabilities, the discovery of logical vulnerabilities still largely relies on manual inspection. The goal is to achieve automated detection of such vulnerabilities.

File privilege escalation is a significant aspect of these vulnerabilities. If an attacker gains full control over any file, they can write shellcode into files like DLLs, leading to the creation of system-privileged processes. After analyzing and summarizing the characteristics of historical vulnerabilities, I have identified a "silver bullet" approach to discovering file privilege escalation bugs. This insight may pave the way for building a system that can automate this process.

In this presentation, I will share the full, in-depth details of my research. I will begin with a historical analysis of known vulnerabilities, followed by the methodology I used to start this work, despite having minimal knowledge of Windows internals and primarily being a web security researcher. I will explain the inner workings of my technique, including how I analyzed Advanced Local Procedure Call (ALPC), identified new attack surfaces, and applied hot patches to transform Process Monitor into a command-line tool capable of detecting sensitive operations. By combining these elements, I developed a system that can automatically discover file privilege escalation bugs.

Additionally, I will demonstrate advanced techniques for exploiting these vulnerabilities, bypassing security checks, and leveraging impersonation. Finally, I will discuss four new vulnerabilities discovered within a week, which successfully performed local privilege escalation in Windows 10 versions 1803 and 1809. These vulnerabilities include one arbitrary file-read bug, one arbitrary file-delete bug, and two arbitrary file DACL rewrite bugs, all of which allow full control over any file with system privileges.