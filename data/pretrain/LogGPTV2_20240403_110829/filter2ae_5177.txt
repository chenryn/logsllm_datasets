# CVE-2015-4400：Doorbot联网门铃配置信息泄漏

## 译文声明
本文为翻译文章，原文来源为360安全播报。译文仅供参考，具体内容和含义请以原文为准。

## 概述
2015年3月，FortiGuard向Doorbot的生产商报告了一个网络配置信息泄漏漏洞。该漏洞存在于第一代联网门铃设备（即Doorbot v1.0）中。然而，其他研究人员指出，此漏洞同样可能影响其他版本的新款联网门铃。该漏洞被赋予CVE编号CVE-2015-4400，并被称为“DoorBot联网配置信息泄漏”。我们还发布了与此漏洞相关的安全公告，并记录了其IPS特征码（DoorBot.Network.Configuration.Leak）。

## 产品介绍
所涉及的产品名为“Ring”（前身为Doorbot），是一款具备网络通信功能的智能门铃。它能够连接家庭Wi-Fi网络，使用户可以通过智能手机与门外访客进行对话。此外，当有人按门铃时，用户的手机会收到通知。用户还可以将这款智能门铃与家中现有的普通门铃相连，从而通过智能手机与门外的人交流。

## 漏洞发现
在2015年3月，研究人员发现了一个允许攻击者入侵家庭Wi-Fi网络的漏洞。为了更直观地展示这一问题，我们提供了一段概念验证视频：
[https://youtu.be/a05RciFhPrs](https://youtu.be/a05RciFhPrs)

简而言之，该漏洞源于GainSpan Wi-Fi模块的错误配置，使得攻击者可以以明文形式恢复出Doorbot的网络配置信息。另外，在同一时期的安全分析中，研究者还发现Doorbot的安卓应用程序将用户的登录凭证以明文形式存储在手机上。幸运的是，厂商在得知后迅速更新了应用并修复了这个问题。

## 漏洞利用
尽管制造商一直强调其重置按钮位于门铃背面难以触及的位置（得益于专利螺丝设计），但实际上，使用任何标准螺丝刀即可轻松拆卸设备并按下重置按钮。这反而导致新版本的Doorbot更加不安全。更重要的是，攻击者不仅可以利用此漏洞入侵智能门铃设备，而且即使在设备转售或废弃后，仍能通过重置按钮恢复前任用户的网络信息。

## GainSpan模块概述
在讨论GainSpan模块之前，有必要先了解一下物联网的基本概念。物联网是指通过互联网实现物品间的信息交换和通信的技术。它是新一代信息技术的重要组成部分，被认为是继计算机、互联网之后世界信息产业发展的第三次浪潮。目前，许多物联网设备采用了GainSpan Wi-Fi模块来提供联网功能。

### 运行模式
GainSpan模块支持以下两种操作模式：

1. **受限接入点**：在此模式下，物联网设备可作为临时接入点使用。对于Doorbot/Ring来说，这种模式会在调试安装期间启用。用户可通过移动应用连接到Doorbot的接入点，并接收当前使用的Wi-Fi网络详情。需要注意的是，一旦按下重置按钮，设备便会切换至受限接入点模式。
   
2. **基础客户端**：在这种模式下，物联网设备像其他Wi-Fi设备一样正常工作。GainSpan模块协同工作，增强了物联网设备的联网能力。

在此之前，GainSpan模块曾因设置不当而泄露过用户网络配置数据。类似事件也曾在Twine设备和Wi-Fi智能秤上发生过，提醒着所有物联网设备制造商，在引入新技术时应特别关注安全机制及配置。