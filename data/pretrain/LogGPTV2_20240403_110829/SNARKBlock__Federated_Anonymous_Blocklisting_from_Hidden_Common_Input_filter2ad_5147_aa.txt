# SNARKBlock: Federated Anonymous Blocklisting from Hidden Common Input Aggregate Proofs

**Authors:**
- Michael Rosenberg
- Mary Maller
- Ian Miers

**Affiliations:**
- Department of Computer Science, University of Maryland
- Ethereum Foundation

**Emails:**
- PI:EMAIL (Michael Rosenberg)
- PI:EMAIL (Mary Maller)
- PI:EMAIL (Ian Miers)

**Published in:**
2022 IEEE Symposium on Security and Privacy (SP)

## Abstract
Zero-knowledge blocklists (ZKBLs) enable cross-platform blocking of users without linking their identities within or across platforms. However, existing approaches, such as Tsang et al. (2010), require servers to perform work linear in the size of the blocklist for each verification of a non-membership proof. We introduce SNARKBlock, a new protocol for zero-knowledge blocklisting with server-side verification that scales logarithmically with the size of the blocklist. SNARKBlock is the first approach to support ad-hoc, federated blocklisting, allowing websites to combine and select their own blocklists and dynamically choose which identity providers they trust.

Our core technical contribution is the HICIAP (Hidden Common Input Aggregate Proofs) system, which addresses the challenge of using zero-knowledge proofs for repeated but unlinkable interactions. HICIAP aggregates multiple Groth16 proofs into a single O(log n)-sized proof, ensuring that the input proofs share a common hidden input while maintaining zero-knowledge properties. This innovation eliminates the need for costly recomputation and enables efficient, privacy-preserving blocklisting.

## 1. Introduction
Moderation is essential for combating online harassment, trolling, and spam. However, banning an account on one platform often fails to prevent the user from posting under different accounts or on other platforms. This leads to a trend towards stronger centralized identity providers, which can compromise user privacy and free speech.

### 1.1 Challenges in Privacy and Moderation
Providing both privacy and moderation is challenging. A user posting anonymously on a forum presents two problems for the service provider:
1. **Access Control:** The service provider cannot verify that the user is authorized to post.
2. **Revocation:** The service provider cannot revoke the user's posting permissions if their post violates forum policies.

Linking posts together raises privacy concerns, especially if applied across the web.

### 1.2 Zero-Knowledge Proofs of Blocklist Non-Membership
BLAC [TAKS10] introduced the first solution to anonymous blocklisting without a trusted third party. It provides users with long-term identities and allows them to prove, in zero-knowledge, that they are not on a blocklist. The user's identity is a random PRF key signed by an identity provider to ensure Sybil resistance. Anonymous comments and posts are associated with a tag, and a blocklist consists of tuples (tag, nonce) from offending posts. A user attests that they are not blocked by presenting a fresh (tag, nonce) pair and a zero-knowledge proof that:
1. The tag is computed correctly.
2. The key is signed by a valid party.
3. None of the blocklisted tags were generated by the key.

### 1.3 Limitations of Existing ZKBLs
Existing ZKBLs, such as Tsang et al. (2010), require the server to do linear work in the size of the blocklist when verifying a non-membership attestation. This results in quadratic growth in the service provider's workload as the site scales, making it costly and vulnerable to denial-of-service attacks. Additionally, proof sizes are also linear in the size of the blocklist, leading to large data uploads for clients.

## 2. Our Contribution
We design, implement, and benchmark SNARKBlock, a protocol for zero-knowledge blocklisting with server-side verification that scales logarithmically with the size of the blocklist. SNARKBlock supports ad-hoc, federated blocklisting, allowing websites to mix and match their own blocklists and dynamically choose which identity providers they trust.

### 2.1 HICIAP: Hidden Common Input Aggregate Proofs
HICIAP is a new type of zero-knowledge proof that aggregates n Groth16 proofs into a single O(log n)-sized proof, showing that the aggregated proofs all verify and share a common hidden input. HICIAP resolves the problem of using zero-knowledge proofs for repeated but unlinkable interactions by eliminating the need for costly recomputation.

### 2.2 Benefits of SNARKBlock
- **Logarithmic Verification:** Server-side verification scales logarithmically with the size of the blocklist.
- **Ad-Hoc Federated Blocklisting:** Websites can combine and select their own blocklists and dynamically choose which identity providers they trust.
- **Privacy-Preserving:** Ensures that the user's identity remains private and unlinkable across interactions.

## 3. Intuition for ZKBL Construction
Zero-knowledge Succinct Non-interactive Arguments of Knowledge (zkSNARKs) offer a path to ZKBLs with fast verification. However, limitations on prover performance make this challenging. Existing zkSNARKs, such as Groth16, can only handle pieces of a blocklist, and producing a zero-knowledge proof of knowledge is at least linear in the size of the input. HICIAP addresses these challenges by aggregating multiple proofs into a single, efficient, and privacy-preserving proof.

---

This optimized version of the text is more structured, clear, and professional, making it easier to understand the key points and contributions of the research.