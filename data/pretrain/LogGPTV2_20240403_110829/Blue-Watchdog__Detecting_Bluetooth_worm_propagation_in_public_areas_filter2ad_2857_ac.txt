321
AseachY(j)hasanormaldistribution,wehave:S(Z)|noworm∼N((cid:8)∀j:Mj∈Zμ0(j),(cid:8)∀Mj:j∈Zσ(j)2)S(Z)|worm∼N((cid:8)∀j:Mj∈Zμ1(j),(cid:8)∀j:Mj∈Zσ(j)2)SimilartoEq.(6),deﬁneg(cid:6)i(Z)forzoneZasfollows:g(cid:6)i(Z)=[gi−1(Z)+(si(Z)−(cid:3)∀j:Mj∈Zμ0(j))22(cid:3)∀Mj:j∈Zσ(j)2−(si(Z)−(cid:3)∀j:Mj∈Zμ1(j))22(cid:3)∀Mj:j∈Zσ(j)2]+,(15)wheresi(Z)istheobservedvalueofS(Z)withinthei-thmeasurementwindow.Similarly,h(Z)isgivenby:h(Z)=√κ((cid:3)∀j:Mj∈Zμ1(j)−(cid:3)∀j:Mj∈Zμ0(j))((cid:3)∀Mj:j∈Zσ(j)2)1/2,whereκistheexpectedobservationtimeofafalsealarm.Wesayaviolationoccurswhensumgexceedsapredeﬁnedthreshold.ForeachzoneZ,letv(Z)bethenumberofviolationtimes.Withthesedeﬁnitions,thewormdetectionalgorithmforzoneZisgiveninAlgo-rithm1.Init,analertisraisedonlyafterthereareatleastηconsecutiveviolations;otherwise,wekeepthepreviouscumulativesum.Thereasonforthisisthattheaveragepagingratecollectedfromeachindivid-ualmonitor(i.e.,Y(j))canbearhighvariation.Undernormalconditions,hence,theaveragepagingrateob-servedbyonemonitororagroupofthemcaneasilyleadtoaviolationwithinasinglemeasurementwin-dow,butitislesslikelytohaveconsecutiveviolations.Whenthereisawormoutbreak,however,itisverylikelytohaveconsecutiveviolationsbecauseinfecteddevicescontinuouslyattempttoinfectnewvictims.Algorithm1WormdetectionofzoneZRequire:gi−1(Z)andviolationtimesv(Z).1:Computesi(Z),andtheng(cid:6)i(Z)basedonEq.(15)2:ifg(cid:6)i(Z)>h(Z)then3:v(Z)←v(Z)+14:ifv(Z)≥ηthen5:AlertthatawormspreadsinzoneZ6:gi(Z)←0,v(Z)←07:else8:gi(Z)←gi−1(Z)9:endif10:else11:gi(Z)←g(cid:6)i(Z),v(Z)←012:endifDiscussiononselectionofΓ.WithmBluetoothmonitors,thereareintotal2m−1choicesforazoneZ(supposethatazonemusthaveonemonitorinit).Theexponentialfeaturerendersitimpracticalforac-tualdeployment.AsaBluetoothwormspreadsitselfinaproximity-basedfashion,welimitourchoicesforzoneZtoonlyspatiallycontinuousregions.Here,wecon-siderasphere-basedapproachtodeﬁnezones:azoneisrepresentedastheareainsideasphere.ItisknownthattheVapnik-Chervonenkis(VC)dimensionforthesetofallspheresinRdisd+1[12].LetS(m)denotethemaximumnumberofzoneswithdiﬀerentmonitorsinthem.BasedontheSauer’sLemma[3],wehaveS(m)≤(cid:3)d+1i=0(cid:9)mi(cid:10)≤(m+1)d+1≤(med+1)d+1.Hence,withmmonitors,|Γ|≤(0.9m)3for2-dimension,and|Γ|≤(0.68m)4for3-dimension.Itiseasytoseethatthesphere-basedapproachhasascalabilityissue:with1000monitorsdeployedina3-Dspace,theSauer’sLemmacanonlyguaranteethatatmost213billionzonesappearinΓ,whichisnotpromisinginpractice.Temporal-spatialdetectionalgorithm.Withthescalabilitychallengesshownabove,weproposealight-weightalgorithm.Foreachmonitor,wekeeptherclosestmonitorsfromit.ThematrixG(j,k),where1≤j≤mand1≤k≤r,storesthecumulativesumforzoneZ(j,k)thatcontainsthekclosestmonitorsfrommonitorj(includingitself).Thetemporal-spatialalgorithmisthensummarizedasfollows:Algorithm2Temporal-spatialwormdetection1:forj=1tomdo2:fork=1tordo3:DetectwormforzoneZ(j,k)withAlgo.1.AnnounceawarningifAlgo.1raisesanalert.4:endfor5:endforAlgorithm2simpliﬁesthesetΓbyconsideringonlyspheresthatarecenteredoneachofthemmonitorsandcontainatmostrmonitors.Inourimplementation,weprecomputetheclosestrmonitorsforeachmonitor.AsAlgorithm1canbedonewithinO(1)time6,thetimecomplexityoftheonlinetemporal-spatialdetectional-gorithmisO(mr),irrespectiveofthedimensionofthespaceinwhichthemonitorsaredeployed.Moreover,thememoryrequiredbythisalgorithmisonlyO(mr).Inpractice,theselectionofrreﬂectsthetradeoﬀbe-tweendetectionaccuracyandcomputationalcost:ahigherrdemandsmorecomputationalresourcesbutallowsmorezonestobeconsidered.6InAlgorithm1,si(Z)canbeupdatedincrementallywithO(1)time.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
322
6ExperimentalEvaluationInthissection,weevaluatetheperformanceofBlue-Watchdogusingthens-2networksimulator[1],ex-tendedwiththeUCBTmodulewhichsimulatestheBluetoothprotocolingreatdetails[2].BehavioralmodelofBluetoothworms.ThebehavioralmodelofBluetoothwormsinourexperi-mentsisdepictedinFigure3.WhenaBluetoothwormisactivated,itstartslookingforBluetoothneighbors.WithinacertainamountoftimeTinq(10.24secondsbydefault),ifitcollectsthreeresponsesfromitsneigh-bors,itstopstheinquiryprocess;otherwiseitstopstheinquiryprocessafterTinqtimeunits.Thewormthenattemptsthefollowingoneachdiscoveredneighbor:es-tablishaconnection,requestaﬁletransfer,transmitthewormcode,anddisconnectfromthevictimdevice.EstablishingaconnectiontoavictimdeviceinvolvesthepagingprocessinBluetooth.Inordertodetectpagingfailures,aBluetoothdeviceschedulesapaging(orconnectionestablishing)timerthatexpiresafter5.12seconds,whichisthedefaultvalueintheBlue-toothspeciﬁcationandisusedinourexperiments.Iftheinfecteddevicefailstoestablishaconnectiontoavictimdevicedueto,say,devicemobility,itre-movesitfromthelistandattemptstoinfectthenextone;otherwise,itsendsarequesttothevictimdeviceforaﬁletransfer.Whenthevictimdevicereceivestherequestpacket,it“thinks”forTthinktimeunitsbe-foresendingbackareplypacket,eitheracceptingorrejectingtherequest.Inourexperiments,theaccep-tanceprobabilityis0.5andthethinkingtimeTthinkisexponentiallydistributedwithmean5.0seconds.Iftherequestisaccepted,thewormtransmitsthewormcodeontothevictimdevice.Thesizeofthewormcodeis20,000bytesinallourexperiments.Todetectfailuresofcodetransfer,atimerisscheduledtoexpireafter10seconds;ifthewormcodecannotbesuccessfullytransferredwhenthistimerexpires,thetransferiscanceled.Ifthetransfersucceeds,thevictimdevicegetsinfectedandthechannelisdisconnected.Afterattemptingtoinfectalltheneighborsdiscov-eredduringtheinquiryphase,thewormkeepsinactivefor30secondsbeforeanotherinfectioncyclestarts.OurBluetoothwormmodelcloselymirrorsthebe-haviorofreal-worldBluetoothwormssuchasCommWar-rior.a!sysworm.Inthispaper,wedonotexplorehowthewormmodelparametersaﬀectitspropagationandwereferinterestedreadersto[25]forfurtherinsights.Instead,wefocusonhowthetwoBluetoothwormde-tectionschemesperformunderdiﬀerentmobilitypat-terns,whichhavesigniﬁcantimpactonBlueworthwormpropagation[24].Inthefollowing,weconsidertwotypesofmobilitymodels:randomwaypointmobilityIdleNoYesNoYesNoIdle timer expiresInquiry for new devicesBluetooth−enableddevice found?NoYesCollect a list of neighborsExtract a neighbor devicefrom the list, connect to itConnectionsucceeds?requestRequest timer expiresFile transferReplicatingtimer expiresReplicate worm codeDisconnectingtimer expiresDisconnect from victimYesList empty?Figure3.BehavioralmodelofBluetoothwormsinourexperimentsmodelandmorerealisticurbanpedestrianmobilitymodel.6.1RandomWaypointMobilityModelTherandomwaypointmobilitymodelhasbeenwidelyusedinthead-hocnetworkingcommunity,largelybe-causeofitssimplicity.Whenthismodelisusedinourexperiments,amobiledevicerandomlychoosesadestinationwithina250×250m2squareandmovesstraightlytothatplaceataspeeduniformlydrawnbe-tween0.5and2.5meterspersecond.Hence,theaver-agespeedofamovingmobiledeviceis1.5meterspersecond,whichmirrorstheaveragepedestrianspeed.Onceamobiledevicereachesitsdestination,itpausesforaperioduniformlybetween0and60seconds.Foreachmobiledeviceinthenetwork,itsnormalBluetoothapplicationbehaviorismodeledasfollows7.SimilartotheBluetoothworm,thisapplication,onceactivated,triestodiscoveratmostthreeneighborsinitsvicinity,andthereafterrandomlychoosesoneforaﬁletransfer.TheﬁlesizeisdrawnfromaParetodistributionwithscale(cutoﬀ)parameter20,000bytesandshapeparameter1.7.Oncethetransferisﬁnished,theapplicationsleepsforTsleeptimeunits,whichis7OurnormalBluetoothtraﬃcmodelismotivatedbythechar-acteristicsobservedinInternettraﬃc:ﬁlesizeshavelong-rangedependenceandusersessionsarePoisson[18].978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
323
exponentiallydistributedwithmean600seconds.Assumingthatthecoordinateoftheleftbottomcor-nerofthesquareis(0,0),weplace100Bluetoothwormmonitorsatcoordinates(250i/11,250j/11),where1≤i,j≤10.ABluetoothmonitortriestodiscoverasmanyneighborsaspossibleduringitsinquiryphase,whichlastsatmost10.24seconds(defaultvalueintheBluetoothprotocolspeciﬁcation);afteroneinquiryphase,itsleepsfor10secondsbeforeanotherinquiryphasestarts.Everyﬁveminutes,eachBluetoothmon-itorsendsitscollectedinformationtotheBluetoothwormdetectioncenter,asshowninFigure1.Thewin-dowsizeissochosenthattheaccumulativesumissuf-ﬁcientlylargefordetectionbutthedetectiondelayisintheorderoftensofminutes.Wesimulate1,000mobiledevicesfor5hours,andtheinitialinfecteddeviceisactivatedafter3hours.Weassumethatallmobiledevicesarevulnerablebe-causewewanttohaveasuﬃcientnumberofvulnerabledevicestoshowinfectioncurves,giventhescalabilitychallengeofns-2simulatorwhichtakesmorethanoneweektosimulateeachscenariowiththemachineswehave.Inourexperiments,wesimulate20samplerunswithdiﬀerentrandomnumberseeds.Figure4showstheinfectioncurvefromeachsamplerun8.Fromthegraph,wenotethatthepropagationspeedoftheBlue-toothwormvariessigniﬁcantlyindiﬀerentsampleruns.Also,thesimulationresultsrevealthatneitherXinorY(j)istrictlyfollowsthenormaldistribution.Evenso,ourexperimentalresultswillshowthatbothdetectionschemesstilleﬀectivelydetectthewormpropagation.Detectionperformance.Beforetheinitialin-fecteddevicestartsspreadingtheworm,eachBlue-toothmonitorhasalreadysentitscollectedinforma-tionfor35times(recallthateachBluetoothmonitorcollectsdataevery5minutes).Amongthesestates,weusetheﬁrst20ofthemfortrainingpurpose,andtheremaining15totestthefalsealarmrates.(1)Temporaldetection.Inthisapproach,wecalcu-latethecumulativesumgiasinEq.(7)attheendofeachmeasurementwindow.Parametersμ0andσcanbedirectlyderivedfromthetrainingdata.Weletμ1beαμ0.RecallthatthereisanotherinputparameterκinEq.(12)forthisdetectionscheme.Wevaryκamong1,2,3and4,andαamong2,3,4and5.Theresultsshowthatforeverycombinationofκandα,nofalsealarmshavebeenraisedandthedetectionratiois100%amongthe20sampleruns.Anothermeasureofdetectionperformanceisdetec-tiondelay,whichisthenumberofmeasurementwin-8Duetosomelogisticissues,acoupleofsamplerunsdidnotﬁnishuntilthepredeﬁnedsimulationtimeandtheirinfectioncurvesthusstopataroundsimulationtime13,800inFigure4.dowsrequiredtodetecttheworm.Thedetectionde-laysaredepictedinFigure5(1)(withonlyκ=1and4).Wenotethattheimpactofparameterκisverysmall.Thisisbecausethresholdhislinearwiththesquarerootofκ,asseeninEq.(12).Ontheotherhand,thedetectiondelayincreasesmoreprominentlywiththegrowthofparameterα,becausethresholdhincreaseslinearlywithα.Thefractionofinfectedde-viceswhenthewormisdetectedisillustratedinFigure5(2).Similarpatternscanbeobservedwithrespecttotheeﬀectsofκandα.Apparently,asmallαisde-sirableifwewanttodetecttheBluetoothwormatitsearlystage.Forinstance,ifαis2,only10%ofthedeviceshavebeeninfectedwhenthewormisdetected,regardlessofκ.(2)Temporal-spatialdetection.WeestimatethemeanandstandarddeviationofY(j)foreachBluetoothmonitorfromthetrainingdataset.Moreover,weletμ1(Y(j))bemin{βμ0(Y(j)),Cminpr}.Weboundμ1(Y(j))fromthelowersidebyCminprbecauseY(j),diﬀerentfromXiinEq.(2),maybearhighvariation.Consider,forinstance,amonitorinwhosemonitoringrangeBlue-toothdevicesnormallyseldompagetheirneighbors;hence,itsobservedaveragepagingrateiscloseto0.Whenadevicepagesaneighbor,themeasuredY(j),whichisstillhighrelativetothelowpagingrateob-servedinthepast,maytriggerafalsealarmifμ1(Y(j))isnotboundedfromthelowerside.Inourexperi-ments,weletCminprbeonepagingattemptperdiscov-eredneighborwithineachmeasurementwindow.RecallthatinAlgorithm1,parameterηspeciﬁesthemaximumnumberofviolationtimesbeforeanalertistriggered.Apparently,ahigherηhelpsreducefalsealarmrates,butitalsoelongatesthedetectiondelayifthereisaBluetoothwormoutbreak.Weletηbe2inallourexperiments.Inthissetofexperiments,wevaryκamong1,2,3,and4,andαamong2,3,4,and5.Asweonlyhave100monitorsinourexperiments,wesimplyletparameterrinAlgorithm2be100.Likethetemporaldetectionscheme,thetemporal-spatialdetectionschemecatchesthepropagationofBluetoothwormsamongall20samplerunswithoutinvokinganyfalsealarms.ThedetectiondelayandthefractionofinfecteddeviceswhenthewormisdetectedarealsoshowninFigure5.Weobservethattheef-fectsofparametersκandαaresimilartothoseforthetemporaldetectionscheme.Bycontrast,thedetectiondelayofthetemporal-spatialdetectionschemeislongerthanthatunderthetemporaldetectionscheme.Thisisexpectedbecause,toreducefalsealarmrates,thetemporal-spatialschemewaitsforanextraviolationbeforeanalertistriggeredanditalsoimposesalowerboundonμ1(Y(j)).IfweletCminprbe0andηbe1,978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
324