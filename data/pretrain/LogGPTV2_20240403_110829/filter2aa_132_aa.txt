1
dogcs 4.4 patch补丁分析
声明
加⼊我们的社区
前⾔
⽂件对⽐
JAVA端
aggressor/Aggressor.class
aggressor/AggressorClient.class
aggressor/browsers/Connect.class
aggressor/browsers/Sessions.class
aggressor/dialogs/AboutDialog.class
aggressor/dialogs/ConnectDialog.class
aggressor/headless/Start.class
aggressor/MultiFrame.class
aggressor/TabManager.class
aggressor/windows/BeaconConsole.class
aggressor/windows/CredentialManager.class
aggressor/windows/DownloadBrowser.class
aggressor/windows/FileBrowser.class
aggressor/windows/Files.class
aggressor/windows/KeystrokeBrowser.class
aggressor/windows/ScreenshotBrowser.class
aggressor/windows/SecureShellConsole.class
beacon/BeaconC2.class
beacon/BeaconData.class
beacon/BeaconHTTP.class
beacon/BeaconPayload.class
beacon/BeaconSetup.class
beacon/CommandBuilder.class
2
beacon/jobs/DesktopJob.class
beacon/TaskBeacon.class
beacon/TaskBeaconCallback.class
beacon/Tasks.class
c2proﬁle/MalleableHook.class
c2proﬁle/MalleableStager.class
cloudstrike/NanoHTTPD.class
cloudstrike/WebServer.class
common/AssertUtils.class
common/AuthCrypto.class
common/Authorization.class
common/BeaconEntry.class
common/CommonUtils.class
common/Download.class
common/Helper.class
common/License.class
common/ListenerConﬁg.class
common/LoggedEvent.class
common/MudgeSanity.class
common/Requirements.class
common/Starter.class
common/Starter2.class
common/TeamSocket.class
dns/AsymmetricCrypto.class
dns/BaseSecurity.class
server/Beacons.class
server/Listeners.class
server/ManageUser.class
server/Resources.class
server/ServerUtils.class
server/TeamServer.class
ssl/SecureServerSocket.class
3
ssl/SecureSocket.class
stagers/BeaconBindStagerX64.class
stagers/BeaconBindStagerX86.class
stagers/BeaconDNSStagerX86.class
stagers/BeaconHTTPSStagerX64.class
stagers/BeaconHTTPSStagerX86.class
stagers/BeaconHTTPStagerX64.class
stagers/BeaconHTTPStagerX86.class
stagers/BeaconPipeStagerX86.class
stagers/ForeignHTTPSStagerX86.class
stagers/ForeignHTTPStagerX86.class
stagers/ForeignReverseStagerX64.class
stagers/ForeignReverseStagerX86.class
stagers/GenericBindStager.class
stagers/GenericDNSStagerX86.class
stagers/GenericHTTPSStagerX64.class
stagers/GenericHTTPSStagerX86.class
stagers/GenericHTTPStager.class
stagers/GenericHTTPStagerX64.class
stagers/GenericHTTPStagerX86.class
stagers/GenericStager.class
stagers/Stagers.class
DLL端
resources/winvnc.x64.dll
resources/winvnc.x86.dll
sleeve/beacon.dll
sleeve/beacon.x64.dll
sleeve/dnsb.dll
sleeve/dnsb.x64.dll
sleeve/extc2.dll
sleeve/extc2.x64.dll
sleeve/hashdump.dll
4
sleeve/hashdump.x64.dll
sleeve/mimikatz-chrome.x64.dll
sleeve/mimikatz-chrome.x86.dll
sleeve/mimikatz-full.x64.dll
sleeve/mimikatz-full.x86.dll
sleeve/mimikatz-min.x64.dll
sleeve/mimikatz-min.x86.dll
sleeve/pivot.dll
sleeve/pivot.x64.dll
sleeve/screenshot.dll
sleeve/screenshot.x64.dll
其他
resources/credits.txt
resources/ua.txt
scripts/default.cna
最近某重要活动，安全娱乐圈⾥流传出来了⼀些图⽚，说某公鸡队的teamserver被登录了，然后beacon
全被删了。看截图是⽤的dogcs 4.4。 
就凭这些就去吐槽别⼈开发的⼯具有后⻔，被反制全是开发⼯具的问题。。。真的麻了，婊⼦你要当，
牌坊你也要⽴。。。。
后⾯⼤佬直接发声明再也不公开dogcs系列了，好好的4.5就这么被埋没了，真的⽆语了。 
声明
5
作为⼤佬的⼀名死灰级粉丝（没有⻅过⼤佬，但⼀直在分析⼤佬写的代码，偷学思路），笔者实在忍⽆
可忍，决定公开之前的dogcs 4.4 patch补丁分析笔记（这份笔记早在2周前就已经分析完了，本不打算公
开），为⼤佬声援⼀波，证实到底有没有放后⻔。分析花了有5天吧，业余时间就在分析。 
社区内全是实实在在分享⼲货的⼤佬，投资⾃⼰，换来更多的回报，这⻔买卖并不亏。
加⼊我们的社区
6
github上看到巨佬发的DogCS_4.4，忍不住想去看下巨佬新增的代码是啥样⼦的。 
⾸先便是拿原版的jar包与修改后的对⽐，diff结果显示以下⽂件存在变化。 
aggressor/Aggressor.class 
aggressor/AggressorClient.class 
aggressor/browsers/Connect.class 
aggressor/browsers/Sessions.class 
aggressor/dialogs/AboutDialog.class 
aggressor/dialogs/ConnectDialog.class 
aggressor/headless/Start.class 
aggressor/MultiFrame.class 
aggressor/TabManager.class 
aggressor/windows/BeaconConsole.class 
aggressor/windows/CredentialManager.class 
aggressor/windows/DownloadBrowser.class 
aggressor/windows/FileBrowser.class 
前⾔
⽂件对⽐
●
●
●
●
●
●
●
●
●
●
●
●
●
7
aggressor/windows/Files.class 
aggressor/windows/KeystrokeBrowser.class 
aggressor/windows/ScreenshotBrowser.class 
aggressor/windows/SecureShellConsole.class 
beacon/BeaconC2.class 
beacon/BeaconData.class 
beacon/BeaconHTTP.class 
beacon/BeaconPayload.class 
beacon/BeaconSetup.class 
beacon/CommandBuilder.class 
beacon/jobs/DesktopJob.class 
beacon/TaskBeacon.class 
beacon/TaskBeaconCallback.class  
beacon/Tasks.class 
c2profile/MalleableHook.class 
c2profile/MalleableStager.class 
cloudstrike/NanoHTTPD.class 
cloudstrike/WebServer.class  
common/AssertUtils.class 
common/AuthCrypto.class 
common/Authorization.class 
common/BeaconEntry.class 
common/CommonUtils.class 
common/Download.class 
common/Helper.class 
common/License.class 
common/ListenerConfig.class
common/LoggedEvent.class 
common/MudgeSanity.class
common/Requirements.class 
common/Starter.class 
common/Starter2.class 
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
8
common/TeamSocket.class 
dns/AsymmetricCrypto.class 
dns/BaseSecurity.class 
server/Beacons.class 
server/Listeners.class 
server/ManageUser.class 
server/Resources.class 
server/ServerUtils.class 
server/TeamServer.class 
sleeve/beacon.dll 
sleeve/beacon.x64.dll 
sleeve/dnsb.dll 
sleeve/dnsb.x64.dll 
sleeve/extc2.dll 
sleeve/extc2.x64.dll 
sleeve/hashdump.dll 
sleeve/hashdump.x64.dll 
sleeve/mimikatz-chrome.x64.dll 
sleeve/mimikatz-chrome.x86.dll 
sleeve/mimikatz-full.x64.dll 
sleeve/mimikatz-full.x86.dll 
sleeve/mimikatz-min.x64.dll 
sleeve/mimikatz-min.x86.dll 
sleeve/pivot.dll 
sleeve/pivot.x64.dll 
sleeve/screenshot.dll 
sleeve/screenshot.x64.dll 
ssl/SecureServerSocket.class 
ssl/SecureSocket.class 
stagers/BeaconBindStagerX64.class 
stagers/BeaconBindStagerX86.class 
stagers/BeaconDNSStagerX86.class 
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
9
stagers/BeaconHTTPSStagerX64.class 
stagers/BeaconHTTPSStagerX86.class 
stagers/BeaconHTTPStagerX64.class 
stagers/BeaconHTTPStagerX86.class 
stagers/BeaconPipeStagerX86.class 
stagers/ForeignHTTPSStagerX86.class 
stagers/ForeignHTTPStagerX86.class 
stagers/ForeignReverseStagerX64.class 
stagers/ForeignReverseStagerX86.class 
stagers/GenericBindStager.class 
stagers/GenericDNSStagerX86.class 
stagers/GenericHTTPSStagerX64.class 
stagers/GenericHTTPSStagerX86.class 
stagers/GenericHTTPStager.class 
stagers/GenericHTTPStagerX64.class 
stagers/GenericHTTPStagerX86.class 
stagers/GenericStager.class 
stagers/Stagers.class 
resources/credits.txt 
resources/ua.txt 
resources/winvnc.x64.dll 
resources/winvnc.x86.dll 
scripts/default.cna 
修改内容: 
修改Version信息 
修改UI⻛格，改为FlatIntelliJLaf 
删除CS的⽂件完整性校验 
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
JAVA端 
aggressor/Aggressor.class 
●
●
●
10
原版: 
修改版: 
修改内容: 客户端界⾯显示的标题 
原版: 
aggressor/AggressorClient.class 
11
修改版: 
修改内容:  
修改连接按钮标题
修改帮助按钮标题，点击后弹出changelog 
原版:  
修改版: 
修改内容: 
修复修改UI⻛格之后 JTable渲染Icon的bug 
aggressor/browsers/Connect.class 
●
●
aggressor/browsers/Sessions.class 
●