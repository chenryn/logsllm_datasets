# 勒索病毒应急响应 自救手册（第二版）
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
作者：360企业安全安服团队
## 编写说明
勒索病毒，是伴随数字货币兴起的一种新型病毒木马，通常以垃圾邮件、服务器入侵、网页挂马、捆绑软件等多种形式进行传播。机器一旦遭受勒索病毒攻击，将会使绝大多数文件被加密算法修改，并添加一个特殊的后缀，且用户无法读取原本正常的文件，对用户造成无法估量的损失。勒索病毒通常利用非对称加密算法和对称加密算法组合的形式来加密文件，绝大多数勒索软件均无法通过技术手段解密，必须拿到对应的解密私钥才有可能无损还原被加密文件。黑客正是通过这样的行为向受害用户勒索高昂的赎金，这些赎金必须通过数字货币支付，一般无法溯源，因此危害巨大。
自2017年5月WannaCry（永恒之蓝勒索蠕虫）大规模爆发以来，勒索病毒已成为对政企机构和网民直接威胁最大的一类木马病毒。近期爆发的Globelmposter、GandCrab、Crysis等勒索病毒，攻击者更是将攻击的矛头对准企业服务器，并形成产业化；而且勒索病毒的质量和数量的不断攀升，已经成为政企机构面临的最大的网络威胁之一。
为帮助更多的政企机构，在遭遇网络安全事件时，能够正确处置突发的勒索病毒，及时采取必要的自救措施，阻止损失扩大，为等待专业救援争取时间。360安服团队结合1000余次客户现场救援的实践经验，整理了《勒索病毒应急响应自救手册》，希望能对广大政企客户有所帮助。
## 第一章 常见勒索病毒种类介绍
自2017年“永恒之蓝”勒索事件之后，勒索病毒愈演愈烈，不同类型的变种勒索病毒层出不穷。
勒索病毒传播素以传播方式块，目标性强著称，传播方式多见于利用“永恒之蓝”漏洞、爆破、钓鱼邮件等方式传播。同时勒索病毒文件一旦被用户点击打开，进入本地，就会自动运行，同时删除勒索软件样本，以躲避查杀和分析。所以，加强对常见勒索病毒认知至关重要。如果在日常工作中，发现存在以下特征的文件，需务必谨慎。由于勒索病毒种类多至上百种，因此特整理了近期流行的勒索病毒种类、特征及常见传播方式，供大家参考了解：
###  WannaCry勒索
2017年5月12日，WannaCry勒索病毒全球大爆发，至少150个国家、30万名用户中招，造成损失达80亿美元。WannaCry蠕虫通过MS17-010漏洞在全球范围大爆发，感染了大量的计算机，该蠕虫感染计算机后会向计算机中植入敲诈者病毒，导致电脑大量文件被加密。受害者电脑被黑客锁定后，病毒会提示需要支付相应赎金方可解密。
常见后缀：wncry
传播方式：永恒之蓝漏洞
特征： 启动时会连接一个不存在url
创建系统服务mssecsvc2.0
释放路径为Windows目录
###  GlobeImposter勒索
2017年出现，2018年8月21日起，多地发生GlobeImposter勒索病毒事件，攻击目标主要是开始远程桌面服务的服务器，攻击者通过暴力破解服务器密码，对内网服务器发起扫描并人工投放勒索病毒，导致文件被加密多个版本更新，并常通过爆破RDP后手工投毒传播，暂无法解密。
常见后缀：auchentoshan、动物名+4444
传播方式：
  * RDP爆破
  * 垃圾邮件
  * 捆绑软件
特征：释放在%appdata%或%localappdata%
###  Crysis/Dharma勒索
最早出现在2016年，在2017年5月万能密钥被公布之后，消失了一段时间，但在2017年6月后开始继续更新。攻击方法同样是通过远程RDP爆力破解的方式，植入到用户的服务器进行攻击，其加密后的文件的后缀名为.java，由于CrySiS采用AES+RSA的加密方式，最新版本无法解密。
常见后缀：【id】+勒索邮箱+特定后缀
传播方式：RDP爆破
特征：勒索信位置在startup目录
样本位置在%windir%\System32
Startup目录
%appdata%目录
###  GandCrab勒索
2018年年初面世，作者长时间多个大版本更新，仅仅半年的时候，就连续出现了V1.0,V2.0,V2.1,V3.0,V4.0等变种，病毒采用Salsa20和RSA-2048算法对文件进行加密，并修改文件后缀为.GDCB、.GRAB、.KRAB或5-10位随机字母，并将感染主机桌面背景替换为勒索信息图片。GandCrab5.1之前版本可解密，最新GandCrab5.2无法解密。
常见后缀：随机生成
传播方式：
  * RDP爆破
  * 钓鱼邮件
  * 捆绑软件
  * 僵尸网络
  * 漏洞传播
  * ……
特征：
  * 样本执行完毕后自删除
  * 修改操作系统桌面背景
  * 后缀-MANUAL.txt
  * 后缀-DECRYPT.txt
###  Satan勒索
撒旦（Satan）勒索病毒首次出现2017年1月份。该勒索进行Windows&Linux双平台攻击，最新版本攻击成功后，会加密文件并修改文件后缀为“evopro”。除了通过RDP爆破外，一般还通过多个漏洞传播。
常见后缀：
  * evopro
  * sick
  * …
传播方式：
  * 永恒之蓝漏洞
  * RDP爆破
  * JBOSS系列漏洞
  * Tomcat系列漏洞
  * Weblogic组件漏洞
  * ……
特征：最新变种evopro暂时无法解密，老的变种可解密
###  Sacrab勒索
Scarab（圣甲虫）恶意软件于2017年6月首次发现。此后，有多个版本的变种陆续产生并被发现。最流行的一个版本是通过Necurs僵尸网络进行分发，使用Visual
C语言编写而成，又见于垃圾邮件和RDP爆破等方式。在针对多个变种进行脱壳之后，我们发现有一个2017年12月首次发现的变种Scarabey，其分发方式与其他变种不同，并且它的有效载荷代码也并不相同。
常见后缀：
  * .krab
  * .Sacrab
  * .bomber
  * .Crash
  * ……
传播方式：
  * Necurs僵尸网络
  * RDP爆破
  * 垃圾邮件
  * ……
特征：样本释放%appdata%\Roaming
###  Matrix勒索
目前为止变种较多的一种勒索，该勒索病毒主要通过入侵远程桌面进行感染安装，黑客通过暴力枚举直接连入公网的远程桌面服务从而入侵服务器，获取权限后便会上传该勒索病毒进行感染，勒索病毒启动后会显示感染进度等信息，在过滤部分系统可执行文件类型和系统关键目录后，对其余文件进行加密，加密后的文件会被修改后缀名为其邮箱。