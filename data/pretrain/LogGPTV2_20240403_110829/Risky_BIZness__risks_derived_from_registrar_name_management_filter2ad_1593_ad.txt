Risky BIZness
IMC ’21, November 2–4, 2021, Virtual Event, USA
Figure 3: New hijackable domains per month from April
2011 to September 2020.
Figure 5: Scatter plot showing the number of domains dele-
gated (capped at 1,000) and the hijack value of both hijack-
able and hijacked sacrificial nameservers.
Figure 4: New hijacked domains per month from April 2011
to September 2020.
the days that domains delegated to it were hijackable. For example,
if a sacrificial nameserver has one domain that was delegated to it
for 30 days and another for 50 days, then the hijack value of the
nameserver is 80 days.
Figure 5 shows the relationship between the hijack value of each
sacrificial nameserver and the number of domains that delegate to
it. Note that the x-axis is log scale, and we cap the y-axis at 1000
domain delegations to maintain clarity. While hijackers do register
sacrificial nameservers across the spectrum, the scatter-plot shows
that hijackers have registered most of the sacrificial nameservers
with the highest value and largest number of delegated domains in
our data set.
5.4 Time to Exploit
Next, we characterize how quickly hijackers exploit sacrificial name-
servers. For every sacrificial nameserver that was hijacked, we
count the number of days from when the sacrificial nameserver
was created until it was registered. Figure 6 shows the distributions
of these counts as two CDFs. The bottom CDF shows the time to
Figure 6: Time to exploit hijackable sacrificial nameservers
and vulnerable domains eventually hijacked.
exploit for sacrificial nameservers, and the top CDF for their as-
sociated domains. The results show that hijackers move quickly:
50% of vulnerable domains are hijacked within 5 days of when a
sacrificial nameserver is created, and more than 70% of vulnerable
domains within a month. The quick turnaround time between cre-
ation and exploitation suggests actors who routinely monitor for
these opportunities and exploit them when they become available.
Moreover, comparing the two CDFs reinforces the notion that
hijackers are selective when registering sacrificial nameserver do-
mains. The sacrificial nameservers with the most value are the ones
associated with many domains, and the CDFs reflect this difference:
the CDF for sacrificial nameservers shows a longer time to exploit
consistently relative to the CDF for their associated domains. For
instance, whereas 50% of vulnerable domains are registered within
a week, only 35% of sacrificial nameservers are registered in the
same time span.
5.5 Duration
Finally, we examine the durations for which domains are hijacked
further revealing interesting hijacking behaviors. Figure 7 compares
the durations for which domains are hijacked with the durations
681
01/1201/1301/1401/1501/1601/1701/1801/1901/20Month0200040006000800010000Newly Hijackable DomainsNewly Hijackable Domains01/1201/1301/1401/1501/1601/1701/1801/1901/20Month0100020003000400050006000Newly Hijacked DomainsNewly Hijacked Domains100101102103104105106Hijack Value01002003004005006007008009001000Number of Delegated DomainsHijacked Sacrificial NSNot Hijacked Sacrificial NS100101102103Time to Exploit (Days)0.00.10.20.30.40.50.60.70.80.91.0CDF1 week1 month1 year2 years4 yearsHijacked DomainsHijacked NameserversIMC ’21, November 2–4, 2021, Virtual Event, USA
Akiwate, Savage, Voelker, and Claffy
However, we note that even for unpopular domains, hijacking
carries risk in situations where the hijacked name carries reputa-
tion even if it does not receive much traffic. For example, as we
describe later in Section 6.1, in a controlled experiment we were
able to obtain complete control over a .edu domain for an oper-
ating educational institution and over an operating .gov domain.
Controlling such names, further embellished with working certifi-
cates and legitimate-looking web sites, would allow an attacker
to implicitly invoke the authority of the organization even if the
organization rarely used the domain prior to the hijack. For ex-
ample, approximately 200 of the affected domains were registered
by MarkMonitor which specializes in protecting “the online pres-
ence of the world’s leading brands”. These names typically include
brand names as part of the domain name (e.g., supporting particular
contests or advertising campaigns). These domains, though not in
current active use, would be attractive for phishing campaigns since
they explicitly invoke the brand in their name and are registered by
the same registrar used by the brand holder. Fortunately, we have
not identified any such attacks using these domains.
Finally, 3,520 of the currently hijackable domains use multiple
nameservers where only a subset are sacrificial. This situation is
particularly worrisome because, when one of their nameservers
becomes a sacrificial nameserver, these domains still have fully
functional name service as a result of the redundancy provided
by their other functional nameservers. Thus, it is entirely likely
that the domain owners may not realize that their domains have
become hijackable or even hijacked. Indeed, of the 3,520 hijackable
domains with alternate resolvable nameservers, 1,105 of them use
a sacrificial nameserver that has been hijacked.
Such “partially hijacked” domains include both those of suffi-
cient popularity to appear on the Alexa Top 1M List, but also those
used by parties whose communications are particularly sensitive,
including public health departments, law offices, law enforcement
organizations and courthouses. As an example of this sensitivity, we
note that the law enforcement portals of most large Web services
— used for serving legal process such as warrants and subpoenas
— perform their initial user authentication in large part based on
the ability of users to receive e-mail at existing well-known law
enforcement domains. Similarly, many courts now routinely issue
orders via e-mail — with an implicit authenticity accorded to mes-
sages arising from the court’s well-known domain names. We have
identified a number of partially-hijackable domains that fit this cri-
teria. While we have not identified attackers making sophisticated
use of partially hijacked domains, it is unsurprising because we
also know of no clear methodology for testing for such attacks.
We have disclosed these domains, as well as the others affected by
sacrificial nameservers, to the appropriate registrars and registries
for remediation with domain owners. Five months after notification,
fewer than 500 of these partially hijackable domains have fixed their
delegation. However, as we will describe further in Section 7, the
registrar community has deemed the issue of sufficient concern to
change their operational procedures and, as of this writing, there
are very few sacrificial nameservers still being created.
Figure 7: Fraction of domains hijacked or hijackable for at
most X days.
for which they are hijackable (at risk of being hijacked). The green
and red curves show the CDFs of the number of days for which
domains were at risk of being hijacked: the green CDF for domains
that were never hijacked, and the red CDF for domains that were
hijacked at least once. For domains that were hijacked, the blue CDF
further shows the number of days for which they were hijacked.
Comparing the green and red CDFs indicates that hijackers select
for domains that are hijackable for longer durations. For domains
that are not hijacked, 15% of them are hijackable for less than a
week. In contrast, 15% of hijacked domains are hijackable for a
month. The two steps in the curve for hijacked domains correspond
to domain registrations expiring after one and two years: 10% of
hijacked domains are hijacked for one year, and 5% are hijacked for
two years, after which they are not renewed even though at times
they are hijackable. Often registrars offer lower prices for initial
registrations, and then higher prices for renewals. Presumably the
domains hijacked via the registered sacrificial nameserver domains
were not providing sufficient value to the hijackers, and so they
stopped renewing the sacrificial nameserver domains.
We believe altogether these results indicate that hijackers are
sensitive to the return on investment — the cost to register the
sacrificial domain name — for the domains that they hijack.
5.6 The Nature of Hijacked Domains
If we examine the nature of the domains being hijacked we can
sometimes infer aspects of the hijacker’s intent. In our analysis,
the vast majority of hijacked domains are completely delegated to
a hijacked nameserver. While this provides the hijacker complete
control over the domain’s resolution, it also means that the domain
likely lost all nameservice when the renaming transition occurred.
This group of “fully hijacked” domains appears to select for unpop-
ular or moribund domains that are not in regular and active use.
We believe that the most prolific hijackers are insensitive to the
underlying nature of the affected domains and treat them primarily
as a source of cheap traffic or reputation. Indeed, of the domains on
the Alexa Top 1M list as of September 11, 2020, only ∼500 domains
were hijackable at some point of time before September 2020 as a
result of the renaming.
682
100101102103Days Hijacked and Hijackable0.00.10.20.30.40.50.60.70.80.91.0Fraction of Domains1 week1 month1 year2 years4 yearsHijacked Days (Hijacked Domains)Hijackable Days (Hijacked Domains)Hijackable Days (Not Hijacked)Risky BIZness
IMC ’21, November 2–4, 2021, Virtual Event, USA
Hijacker NS Domain
mpower.nl
protectdelegation.{ca,eu,com}
yandex.net
phonesear.ch
dnspanel.com
NS
3,261
2,551
2,468
433
549
Domains
63,759
48,871
36,001
14,324
14,293
Nameservers
Vuln. Hijacked
1,186 (3.2%)
36,553
26,796
1,210 (4.5%)
+24
-9,757
Affected Domains
Vuln.
Hijacked
53,970
40,578
-13,392
16,888 (31.3%)
14,606 (36.0%)
-2,282
Sep 2020
Feb 2021
Delta
Table 4: Top five hijackers overall by number of domains hi-
jacked (April 2011 – September 2020).
Table 5: Change in number of hijackable (vulnerable) and
hijacked sacrificial nameservers and affected domains after
notifications starting in September 2020.
6 CHARACTERIZING HIJACKERS
Sacrificial nameservers are clearly being registered that hijack the
domains that delegate to them. As a final analysis, we explore what
the hijacked domains are being used for — first using a controlled
experiment to confirm the capabilities of hijackers, and then more
broadly examining how bulk hijackers have been using hijacked
domains.
6.1 Controlled Experiment
When a registrar performs a renaming operation that creates a sac-
rificial nameserver name, it is just a name in the registry database.
A hijacker can then register the domain that corresponds to a sac-
rificial nameserver name, and operate a nameserver that answers
queries for delegated domains.
To confirm the capabilities that registering sacrificial nameserver
domains affords a hijacker, we registered five such domains without
issue. We then used our own infrastructure and confirmed that we
observed incoming queries for the domains, while being careful
to never respond. Surprisingly, we also saw queries for .edu and
.gov domains11 at our server. These queries were unexpected since
the host object renaming should not affect other TLDs, particularly
restricted TLDs that do not have traditional registrars.
This phenomenon revealed the situation described in Section 2.4:
in practice the renaming operation affects all of the TLDs managed
on the same shared EPP repository of a registry. In short, since
Verisign manages .edu and .gov, renaming a host object in .com
can affect domains in .edu and .gov (among others). Since the
.edu and .gov registries manage each registrant themselves, they
may not realize or anticipate that NS records in their zone can
be changed without their express involvement. Finally, to confirm
that we could truly hijack resolution for a domain in a restricted
TLD, we updated our infrastructure to respond to queries for the
hijackable .edu domain but only for queries coming from a /24 we
controlled. Note that we were extremely careful about both legal
issues (working closely with our general counsel in designing the
experiment) and ethics with this experiment. We discuss the ethical
considerations in more detail in Section 8.
long-standing domain registration proxy services, and the impact
of the GDPR on information in public registration records, means
that we rarely know much about a domain registrant. Moreover,
given the tremendous flexibility available to attackers with such
control, it is difficult to know precisely the intent of any particular
hijack without witnessing an attack in progress.
However, one category of use — bulk traffic exploitation — is
amenable to cursory automated analysis. In particular, we can dis-
tinguish hijacker groups based on the choice of NS records used to
support sacrificial name server domains (i.e., what nameservers are
used when a sacrificial nameserver domain is looked up?). Table 4
shows the most popular controlling nameserver domains over the
course of our study.12
Manually visiting the hijacked domains associated with these
controlling nameservers in September 2020 is consistent with our
hypothesis about their underlying motivation. The most prevalent
use of hijacked domains is to host a traditional parking site, with
topic links related to the original domain content designed to drive
low-quality advertising clicks. For example, sacrificial nameservers
controlled by mpower.nl direct their domains in this manner (e.g.,
alicornarts.com as of this writing). A mass monetization strategy
is offered by phonesear.ch, which is not only the controlling name-
server but also the destination site for its hijacked domains (via
redirect). phonesear.ch serves a Web site containing links to all
North American telephone numbers and appears to use its thou-
sands of hijacked domains to support a search engine optimization
(SEO) strategy for attracting traffic. We believe visitors are then
monetized via an affiliate relationship with Spokeo (each page at
phonesear.ch advertises Spokeo’s service to obtain more informa-
tion about a phone number).
Retrospectively, we also analyzed screenshots of 100 random
hijacked domains using the Internet Archive Wayback Machine
and confirmed that the use of hijacked domains has not changed
significantly over time, with parking sites dominating the sample.
We also specifically examined domains hijacked by phonesear.ch
in the past, but the screenshots were blank presumably due to how
the Wayback Machine handles redirections.
6.2 Bulk Hijackers
While it is straightforward to identify that a sacrificial nameserver
domain has been registered (and hence that it is likely being used
to hijack the domains for which it receives DNS requests), it is far
harder to identify who is behind such actions. The combination of
11The .gov domain delegation has since been fixed based on our outreach. The .edu
domain is no longer hijackable due to our defensive registrations pending outreach.
7 NOTIFICATION AND REMEDIATION
Beginning in September 2020, we initiated a broad outreach effort
to communicate our findings to the registrar community. The out-
reach had two main goals: to remediate currently affected domains,
12 yandex.net includes default nameservers for domains registered by Yandex.
683
IMC ’21, November 2–4, 2021, Virtual Event, USA
Akiwate, Savage, Voelker, and Claffy
and to prevent new domains from being exposed. There was consid-
erable surprise in the community about the nature of the issue and
sufficient concern to drive a range of efforts to address it. We assess
the impact of such actions here, first characterizing the remediation
of existing hijackable domains and then describing the effects of
new renaming practices on the creation of new hijackable domains.
Finally, we propose potential options for modifications to the EPP
standard and registrar operational practices that could form a more
robust permanent solution.