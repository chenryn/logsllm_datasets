day). Since the identification values (did) should be selected ran-
domly from a large domain (e.g., 2256), even a quota well in excess
of any reasonable law enforcement need (e.g., 1000/day) will not
provide a useful mechanism for enumerating the authorization keys
for unknown devices. Finally, it is possible to further encrypt the
contents of the HSM in such a way that manufacturer employees
never handle sensitive per-device values at all (e.g. dauth and any
protection keys).
Consider the following approach: a law enforcement agency
(e.g., the FBI) provides a public key, LEF BI , to the manufacturer
who installs it in the HSM.32 As before, a valid court order would
30For example, any manufacturer employee authorized to update system-level code is
in a position to compromise the integrity of the device’s security (e.g., by inserting
an obfuscated vulnerability that will appear in a future update) without any need for
access to the code signing key. Moreover, the consequence of such an insider threat has
far greater scope than losing an authorization key, since it potentially allows arbitrary,
remote, covert access across large numbers of devices.
31Some have argued that “law enforcement’s stated need for rapid access to data would
make it impractical to store keys offline” [20], but this claim is at odds with the reality
of lawful process—which is exceedingly slow in practice.
32Note, that the (infrequent) installation of an authorized law enforcement public
key into the HSM is a sensitive operation and this aspect of the protocol would need
to be performed with high assurance. In particular, full protection against rogue
include a statement including the did value obtained from the seized
device, but would now also include a signature S covering that
−1. The manufacturer’s
value, generated using the private key LEF BI
employees responsible for legal process would validate the court
order as they do today, then login to the HSM (using their HSM
credentials together to authorize access) and provide the values
for did and S. The HSM could then validate that S was a valid
signature for did and, if so, lookup the corresponding tuple in the
database (did,dauth,...), encrypt them with LEF BI , and return the
now opaque value to the manufacturer’s employees to be sent, in
turn, to law enforcement.33 In this way, legal process employees
would be unable to substitute another value of did, nor be able
to obtain an unencrypted version of dauth. As a general matter,
such an approach would be an improvement over the current state
of legal process and would provide an additional tool for benign
employees to distinguish valid court-orders from any potentially
fraudulent requests.34
To summarize, we do not believe that insider threats via legal
process employees are as significant as has been suggested; we are
unaware of empirical evidence that current legal process requests
are being subverted in this manner. Moreover, to the extent that
risks of insider theft of authorization keys is a significant concern,
there are meaningful technical approaches that would dramatically
reduce such risk.
5.4 Transparency
The last property we turn to is transparency. Here the goal is to
reveal that a device’s passcode has been acquired via the lawful
access procedure and minimize its value for covert use. On the
device itself, the escrow agent can burn an “unlock attempted”
status fuse upon initiating the authorization protocol (i.e., when
the device first provides did) and another “unlocked” fuse once it
completes the protocol and unlocks the device. The device firmware
can report on the state of these fuses when the device starts (e.g.,
audible and visible notifications that the device has been unlocked
by an outside party). If one needed to track subsequent events, one
could implement a count.35
One shortcoming to this approach is that it assumes that the
device itself will not be substituted (i.e., a variant of the “evil-maid”
attack). Thus, one might unlock a phone via the authorization pro-
tocol, extract the contents of the phone and then copy the contents
to a new phone (whose status fuses are still pristine). Should it
be possible to complete such a transfer without detection, such a
phone might be returned to the possession of its owner (a mini-
mum of three days later) without them knowing that their device’s
contents had been accessed. Note that since the plaintext passcode
is never revealed in our design, a potential covert actor has no way
manufacturer employees requires that only well-authenticated law enforcement keys
be configured in the HSM.
33Note that replay is not much of an issue in this context since each did is unique
to a given device. However, should this be important—for example in the context of
multiple warrants for the same device—a date could be added to the statement to be
signed.
34A problem deserving considerably more attention from the technical community is
the mechanisms by which court orders are authenticated in existing legal process.
35Note that some device manufacturers have indicated concern about this particular
approach because it may undermine the resale value of the device for its owner.
to relock a substituted device such that it will only open with the
appropriate passcode.36
Some manufacturers, such as Apple, already impose a per-device
registration protocol (ultimately aggregated based on AppleID) that
makes covert phone substitution challenging. In principal, a vari-
ant of such a protocol could also be used to inform the user that
one of their devices had been opened. However, a straightforward
implementation of such a protocol would require associating other-
wise anonymous device identifiers (did values) with well-known
identifiers (e.g., IMEI/MEID) and presupposes that all manufactur-
ers have a direct relationship with their customers (while this is
true for Apple, is decidedly not true for a range of other device
manufacturers). Instead, an alternative approach would be for the
manufacturer to simply publish the set of H(dauth) that have been
disclosed and each device (or a proxy) could periodically check to
find out if their secret was among those that had been disclosed.
This would require that H (dauth ) be readable on the device, or
at least could be matched, but it should have little effect on the
security of the authorization protocol due to the one-way nature
of H. Obviously, an actor able to produce a device with modified
code or able to prevent the manufacturer from communicating their
disclosures is in a position to block the transparency property.37
5.5 Manufacturer costs
A concern commonly raised is that the costs of any such scheme
may be excessive and place undue burden on manufacturers. There
are undoubtedly costs to be borne in this mechanism—both up front
investments and ongoing operational costs.
Perhaps the most significant upfront costs arise from the design
and implementation of the lawful access technical capability in
each device as well as the testing and quality assurance around
the resulting hardware and software. These are real costs but seem
likely modest in comparison to the extensive and high-value invest-
ments being made in improving device security (e.g., for example,
most of the complex work in this proposal is already an included
and necessary component of the design in Apple’s Secure Enclave).
There are also likely upfront costs for secure storage, authentica-
tion mechanisms and investments in operational security, but these
again seem likely to be quite small relative to manufacturer’s ex-
isting information technology investments (especially given that
much of what is needed here already exists to support existing legal
process requests).
Indeed, more emphasis has been placed on the potential ongoing
operational costs (e.g., “the cost and complexity of authenticating
a high volume of global law enforcement requests—not just accu-
rately, but fast enough to meet the quick turn-around time needed
in urgent investigations or possibly mandated by the applicable
key-recovery law—will fall entirely on the vendor” [50]). However,
the evidence is unclear if these costs are indeed large compared to
the size of these enterprises or if they would dramatically increase
36However, this depends on the owner of this device noticing this discrepancy, which
they may not, and a sophisticated attacker might install a false login screen on the
replacement to address this discovery risk.
37We can envision protocols involving third-parties in separate jurisdictions that might
offer stronger transparency guarantees, but these seem too complex, both operationally
and politically, to be realistic.
the costs currently borne by manufacturers in support of existing
criminal process requests.
To explore this question further, consider Apple’s most recent
transparency report: there were 4,479 device requests received from
U.S. law enforcement agencies in the first half of 2017 as well as re-
quests to access 6,407 accounts (i.e., iCloud)—or, in total, requests to
access roughly 20,000 devices or accounts per year [7]. By compari-
son, in one recent speech the Director of the FBI claimed that his
office had been unable to access the content on 7,775 devices in 2017
(across all manufacturers—Apple is roughly 30–40% of smartphones
in the U.S.)[63]. Subsequent reporting has suggested that the true
number of such devices is likely only 1,000-2,000 [22]. While there
is little doubt that state and local law enforcement agencies would
also make similar requests, it is not at all clear that their level of
demand would exceed that of the FBI. We are unaware of good
data on this topic (as most transparency reports do not break out
requests from federal vs non-federal sources), but some insight may
be gleaned from Twitter, which breaks out Federal, State and Local
requests in their transparency reports. In their July 2017-December
2017 report, Twitter documents 1,761 requests for account informa-
tion from U.S. sources, of which roughly two thirds were Federal [8].
Thus, while clearly creating a new criminal process demand on
manufacturers would create additional operational burden, we see
no evidence that this burden would be qualitatively distinct from
their existing criminal process workload.
Moreover, we find the claim of high costs needed to meet the
“quick turn-around time needed in urgent investigations” uncon-
vincing. In practice, court-ordered production of digital evidence
for criminal cases routinely takes several weeks if not longer (e.g.,
Linkedin’s guidelines instructs law enforcement to “Please allow
at least 3 weeks for processing” [18], Facebook’s guidelines offer
“2–6 weeks” for the same [3] and Ebay says requests “are proessed
in approximately 20 business days” [5]). Moreover, while most
heavily-served tech companies offer a mechanism for emergency
processing if there are exigent circumstances (e.g., Apple provides
the PI:EMAIL contact for precisely this reason), these
seem to be a small minority of requests. In Apple’s most recent
transparency report, they received 118 such emergency requests in
the first half of 2017 from U.S. law enforcement sources which is a
very small fraction of total requests received.
That is not to say that such operational costs are insignificant, nor
that it is a foregone conclusion that device manufacturers should
bear them. Indeed, current electronic searches under the Electronic
Communications Privacy Act (ECPA) already mandate cost recov-
ery to the provider for their efforts and a similar arrangement for
handling authorization key requests would seem entirely reason-
able. To summarize, we do not see strong evidence that costs would
be so burdensome as to make the approach we have described
untenable in practice.
6 CONCLUSIONS
In this paper we have described a systems-oriented design for a
lawful “device unlock” capability. We believe that this design effec-
tively forecloses its use for mass surveillance purposes and, further,
that it offers stronger safeguards and greater transparency than
the “lawful hacking”-based approach that forms the core of today’s
status quo. However, we have little doubt that the technical short-
comings of our design will be swiftly identified and that there will
be further refinements or yet other alternative strategies that will
be superior still. Indeed, we write this paper precisely in the hope
that there is sufficient additional research activity to obsolete our
own work. Most of all, we hope to help dissuade others of the no-
tion that such research “should not be done”, a sentiment that we
think is inherently unhealthy for the field. We contend that even
the most steadfast opponents of any lawful access capability are
well-served by a healthy set of concrete options to push against.
ACKNOWLEDGEMENTS
In doing this work, I’ve benefited from considerable constructive
feedback from a broad community. Thanks in particular to Herb
Lin for encouraging me to work on this problem, David Clark and
Danny Weitzner for inviting me to participate in their events, Ernie
Brickell and Ray Ozzie who, for different reasons, ended up in
similar places and were generous in sharing their ideas and criti-
cisms. In addition, I’ve benefited from the time and creativity of
a broad range of researchers who contributed key ideas or pro-
vided constructive feedback on drafts of this paper, foremost being
Mihir Bellare, Nick Weaver and Alex Gantman, as well as David
Kohlbrenner, Hovav Shacham, Philip Rogaway, Aaron Schulman,
Geoff Voelker, Ryan Kastner and a host of others. Finally, I’d like to
thank the anonymous ACM CCS referees, as well as my shepherd
from the same conference, for the candor of their feedback and
their open-mindedness in appreciating the value of design-oriented
papers.
REFERENCES
[1] FBI ’Going Dark’ FOIA Documents – Release 1, Part 1. https://www.eff.org/
document/fbi-going-dark-foia-documents-release-1-part-1.
[2] Declaration of Mark Klein in Support of Plaintiff’s Motion for Prelimi-
nary Injunction. https://www.eff.org/files/filenode/att/mark_klein_unredacted_
decl-including_exhibits.pdf, June 2006.
[3] Facebook Law Enforcement Guidelines. https://www.eff.org/files/filenode/social_
network/facebook2010_sn_leg-doj.pdf, 2010.
[4] Apple Inc’s motion to vacate order compelling Apple Inc. to assist agents in
search, and opposition to government’s motion to compel assistance. https:
//epic.org/amicus/crypto/apple/In-re-Apple-Motion-to-Vacate.pdf, Mar. 2016.
[5] Ebay Global Asset Protection: Resources for Law Enforcement Investiga-
tions and Service Levels. https://ir.ebaystatic.com/pictures/aw/pics/pdf/us/
eBayLEGuideSecurityCenter2016.pdf, 2016.
[6] In the matter of the search of an Apple iPhone seized during the execution of
a search warrant on a black Lexus IS300, California License Plate 35KGD203.
https://www.justice.gov/usao-cdca/file/825001/download, Feb. 2016.
[7] Report on Government and Private Party Requests for Customer Information:
January 1—June 30, 2017. https://images.apple.com/legal/privacy/transparency/
requests-2017-H1-en.pdf, 2017.
[8] Twitter Transparency Report: United States of America: July to Deceember 2017.
https://transparency.twitter.com/en/countries/us.html, 2017.
[9] Bring in the Nerds: EFF Introduces Actual Encryption Experts to the U.S. Senate
Staff. https://ssd.eff.org/en/blog/bring-nerds-eff-introduces-actual-encryption-
experts-us-senate-staff, May 2018.
[10] Cellebrite Advanced Unlocking Services. https://www.cellebrite.com/en/services/
advanced-unlocking-services/, 2018.
[11] CPU frequency: Hall of Fame. https://hwbot.org/benchmark/cpu_frequency/
[12] Decrypting the Encryption Debate: A Framework for Decision Makers. National
halloffame, May 2018.
Academies Press, Feb. 2018.
[13] Encryption
in
the U.S.: Crypto Colloquium Outcomes
Report.
https://www.accessnow.org/cms/assets/uploads/2018/02/Encryption-in-
the-United-States-Crypto-Colloquium-Outcomes-Report.pdf, Jan. 2018.
[14] Encryption Policy in Demogratic Regimes: Finding Convergent Paths and Bal-
anced Solutions. https://www.eastwest.ngo/sites/default/files/ewi-encryption.
pdf, Feb. 2018.
[15] Introducing GreyKey. https://graykey.grayshift.com/, 2018.
[16] iOS Security. https://www.apple.com/business/docs/iOS_Security_Guide.pdf,