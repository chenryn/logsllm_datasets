25, 2019 from https://developer.roku.com/docs/developer-program/discovery/
external-control-api.md
[66] Roku. 2019. Integrating the Roku Advertising Framework. (2019). Retrieved
August 25, 2019 from https://developer.roku.com/docs/developer-program/
advertising/integrating-roku-advertising-framework.md
(2019).
(2019). Retrieved August 25, 2019 from
[67] Roku. 2019. Roku Channel Store.
https://channelstore.roku.com/browse
[68] Roku. 2019. Roku Compliance. (2019). Retrieved August 25, 2019 from https:
//developer.roku.com/develop/platform-features/compliance
[69] Roku. 2019. Roku Express. (2019). Retrieved August 25, 2019 from https://www.
roku.com/products/roku-express
[70] Elias Saba. 2019. Amazon Fire TV Stick 2 has been Rooted for the first
(2019). Retrieved August 25, 2019 from http://www.aftvnews.com/
time.
amazon-fire-tv-stick-2-has-been-rooted-for-the-first-time/
[71] Selenium. 2019. Selenium - Web Browser Automation. (2019). Retrieved August
25, 2019 from https://www.seleniumhq.org/
[72] Sensepost. 2019. sensepost/objection. (Apr 2019). https://github.com/sensepost/
[73] Mike Shields. 2018. Inside Roku’s battle to control the future of TV advertising —
and why it better watch out for Amazon. (2018). Retrieved August 25, 2019 from
https://www.businessinsider.com/roku-wants-to-control-the-future-of-tv-ads
[74] Ashkan Soltani, Shannon Canty, Quentin Mayo, Lauren Thomas, and Chris Jay
Hoofnagle. 2010. Flash cookies and privacy. In 2010 AAAI Spring Symposium
Series.
[75] Sid Stamm, Zulfikar Ramzan, and Markus Jakobsson. 2007. Drive-by pharming.
In International Conference on Information and Communications Security. Springer,
495–506.
[76] Oleksii Starov and Nick Nikiforakis. 2017. Extended Tracking Powers: Measuring
the Privacy Diffusion Enabled by Browser Extensions. In Proceedings of the 26th
International Conference on World Wide Web. International World Wide Web
Conferences Steering Committee, 1481–1490.
[77] Brett Tingley. 2018. Over One Third of US Households Will Cut the Cord by
2020. (2018). Retrieved August 25, 2019 from https://www.streamingobserver.
com/over-one-third-of-us-households-will-cut-the-cord-by-2020/
[78] Amazon Fire TV. 2019. Remote Control Input. (2019). Retrieved August 25, 2019
from https://developer.amazon.com/docs/fire-tv/remote-input.html
[79] Daniel Veditz. 2011. Rizzo/Duong chosen plaintext attack (BEAST) on SSL/TLS 1.0
(facilitated by websockets -76). Technical Report. https://bugzilla.mozilla.org/
show_bug.cgi?id=665814
[80] WiGLE.net. 2019. WiGLE: Wireless Network Mapping. (2019). Retrieved August
25, 2019 from https://wigle.net/
objection
[81] Daniel Wood, Noah Apthorpe, and Nick Feamster. 2017. Cleartext data transmis-
sions in consumer iot medical devices. In Proceedings of the 2017 Workshop on
Internet of Things Security and Privacy. ACM, 7–12.
[82] Ning Xia, Han Hee Song, Yong Liao, Marios Iliofotou, Antonio Nucci, Zhi-Li
Zhang, and Aleksandar Kuzmanovic. 2013. Mosaic: Quantifying Privacy Leakage
in Mobile Networks. In Proceedings of the ACM SIGCOMM 2013 Conference on
SIGCOMM (SIGCOMM ’13). ACM, New York, NY, USA, 279–290. https://doi.org/
10.1145/2486001.2486008
A TLS INTERCEPTION SETTINGS
A.1 TLS Interception Certificate
When we cannot deploy our own certificate to the device, our TLS
interception rate is bounded by the number of channels with incor-
rect validation of certificates. We compared the success rate of TLS
interception using two different X.509 certificates on Roku. First,
a self-signed certificate generated by mitmproxy with a common
name matching the original certificate’s common name was used.
If a channel does not validate the chain of certificate authorities
(CAs), the client will complete the TLS handshake using this cer-
tificate and proceed with the communication. Second, a certificate
issued by Let’s Encrypt9 for a domain we own (“3016sale.xyz”)
was tried. In this case, the channel proceeds with the connection
if it does not validate the fields “Subject” or “Subject Alternative
Name” in the certificate [9]. Using the self-signed certificate, we
attempted intercepting sessions on top 100 channels on Roku. We
were able to intercept 12 distinct hosts from 9 channels using this
certificate; whereas, interception was successful only on 5 distinct
hosts from 4 channels with the Let’s Encrypt certificate. Thus, we
use the self-signed certificate for larger crawls.
A.2 TLS Interception Learning Rate
To measure how fast our TLS interception learns new endpoints
that cannot be intercepted and adds them to the no-intercept list, we
measure the number of endpoints where we attempted to intercept
the TLS connection but failed for each warm-up launch of a channel.
The resulting histogram is shown in Figure 6 and Figure 7 shows
the corresponding CDF.
Figure 6: Number of TLS failures in each warm-up launch
for Roku platform.
9https://letsencrypt.org/
14
123456891011121314151617181920Launch number050100150200250300350Number of TLS failuresFigure 7: CDF of TLS failures in each warm-up launch.
Launches up to ten do not feature any interaction with
the channel; launches after ten include smart crawls.
B BYPASSING TLS CERTIFICATE PINNING
In order to bypass application level certificate pinning for all of
the running applications, we built a script which uses the Frida
toolkit [29]. On initialization, the script collects all of the running
processes and uses Objection [72] to generate an API port linked
to each process. We then send a POST request to the Objection API
instructing it to send the Universal Android SSL Pinning Bypass
gadget [7] to the Frida server on the Fire TV as can be seen in
Figure 8.
A listener is also spawned which monitors the “ActivityManager”
process in Android using “adb logcat" which allows us to detect
any new processes which spawn and create an Objection instance
for them. Once the Objection instance is spawned we use a POST
request as explained above to instruct Objection to send the gadget
to Frida. The operation on the watchdog can be seen in Figure 8.
To prevent the system from crashing if a process is incompatible
with the Frida gadget, we maintain a blacklist of processes. A pro-
cess is added to the blacklist if Frida returns an error code while
trying to insert the gadget or if an app crashes within ten seconds
of a gadget being injected after two attempts are made.
C OTT SPECIFIC TRACKING DOMAINS
We list the domains that we found to engage in advertising and
tracking in OTT services and not listed in previous work in Table 11.
D WEAK TLS CIPHERSUITES
Method. Using the pcaps from the Roku-Top1K-NoMITM and
FireTV-Top1K-NoMITM crawls we extracted all TLS Client Hello
messages that the OTT device sent. From these Client Hello mes-
sages, we extracted the non-ephemeral parameters: the TLS hand-
shake version, along with a list of ciphers, extensions, compression
methods, elliptical curves (supported groups), EC point formats, and
signature algorithms. We concatenated these parameters — while
preserving the order of all the lists — and generated a SHA-256
hash as a fingerprint for the Client Hello message.
Figure 8: Frida script pipeline.
Domain
monarchads.com
ewscloud.com
kargo.com
adrise.tv
aragoncreek.com
lightcast.com
mtvnservices.com
myspotlight.tv
brightline.tv
junctiontv.net
Channel Count
74
31
25
18
7
7
7
6
3
2
Table 11: Domains that collect AD ID and are not blocked by
the five adblocking lists in Roku-Top1K-MITM crawl.
We use Client Hello fingerprints to identify potentially the same
TLS implementations and configurations. In other words, if two
channels send out Client Hello messages with the same fingerprints,
the channels are likely to have used the same TLS libraries and set-
tings. A Client Hello fingerprint associated with insecure settings,
such as using outdated TLS versions or advertising weak ciphers
(e.g., RC4), implies that all channels with this fingerprint are likely
affected.
Roku Result. Across the 1,000 Roku channels, we identify 16 dis-
tinct fingerprints. Multiple fingerprints may be associated with the
same channel. On average, a channel is associated with 3.00±0.19
distinct fingerprints. Two of the 16 fingerprints appear in all 1,000
channels, and one fingerprint appears in 991 channels. This obser-
vation suggests that the majority of the channels use some standard
TLS implementations provided by the platform. One of these fin-
gerprints which appears in all 1,000 channels advertises RC4 as one
of its supported ciphers. Even though no RC4 ciphers were actually
used (i.e., because the Server Hello picked a non-RC4 cipher), the
presence of RC4 ciphers may still face potential vulnerabilities. In
particular, past years have seen multiple attacks that targeted RC4,
and in February 2015, RFC 7465 prohibits the use of RC4 in TLS [58].
15
1234567891011121314151617181920Launch number0.00.20.40.60.81.0com.example.tv    8082InitializationadbStart Frida ServerfridaRetrieve Running ProcessesSpawn Objectioncom.example.tv     8080com.channel.tv      8081curl 127.0.0.1:8080/sslPinningDisablecurl 127.0.0.1:8081/sslPinningDisableSSL GadgetWatchdogadblogcat ListenerfridaSpawn ObjectionSSL Gadgetcurl RequestActivityManager: com.example.tv startedcurl RequestIn order to authenticate new clients, the Fire TV prompts the
user to enter a code displayed on the TV within the app. The app
uses this to generate an authentication key which is included with
all the future requests the remote sends to the TV. The remote
control app does not verify the TLS certificate the server provides
which allowed us to recover the authentication key using a man
in the middle attack. Once the authentication key is recovered, an
attacker can forge remote control interactions using POST requests
to either the insecure or secure port on the Fire TV’s web server.
This allows the attacker to install and uninstall channels, change
channels, and retrieve device information. However, we believe this
is not a practical attack since the attacker would need to be on the
local network in order to perform the man in the middle attack and
recover the authentication key.
G VIDEO TITLE LEAKS
The following tables summarize our video title leak detection results
(for a subset of channels).
Additionally, there is also a long tail of fingerprints that appear
in a small number of channels. Three fingerprints each appear in
two different channels, and another 10 fingerprints each appear
in exactly one channel. This long tail of fingerprints suggests the
use of custom TLS implementations and/or configurations in chan-
nels. Of the ten single-channel fingerprints, five of them advertise
the RC4 cipher across three channels: Sling TV (ranked #6), Vudu
(ranked #17), and Spotify Music (ranked #25). Furthermore, two of
these ten single-channel fingerprints use TLS 1.0: Amazon Prime
Video (ranked #3) and Vudu — whereas all other fingerprints in our
dataset use TLS 1.2. Researchers have shown in the past that TLS 1.0
can potentially be subject to attacks such as BEAST [79]. Amazon
Prime Video, for instance, communicated with amazon.com and
amazonvideo.com over TLS 1.0 using this particular fingerprint,
although the channel also uses four other fingerprints — all over
TLS 1.2 — to communicate with Amazon, Roku, and other services.
Amazon Result. Across the 1,000 channels, we identify 203 dis-
tinct fingerprints. One fingerprint appears in all 1,000 channels,
followed by a fingerprint in 797 channels and another fingerprint
in 774 channels. These top three fingerprints advertise the RC4
cipher and they use TLS 1.2. The fingerprint that is used in the
most number of channels and which negotiates TLS 1.0 appears
in 49 channels. In all cases, these 49 channels communicate with
amazonvideo.com using this fingerprint. A total of 67 channels use
fingerprints that are not used in other channels, which suggest ei-
ther (i) the channels use custom implementations or configurations
of the TLS library, or (ii) channels use random parameters in the
Client Hello, which appears as multiple fingerprints even though
only one TLS implementation/configuration is used. Unfortunately,
we are unable to distinguish these two cases.
E TRACKER DOMAINS MISSED BY PI-HOLE
Domain
tremorhub.com
irchan.com
bfmio.com
monarchads.com
adrise.tv
digitru.st
bidswitch.net
sharethrough.com
adsrvr.org
lightcast.com
Channel Count
66
42
41
38
15
12
12
9
6
6
Table 12: Domains that receive AD ID and Serial number af-
ter filtering requests with Pi-hole (Roku-Top1K-MITM)
F FIRE TV REMOTE API
The Fire TV remote control app uses a version of the Discovery and
Launch (DIAL) protocol [49] to locate the Fire TV on the network.
Once the Fire TV’s IP is located, the app queries a web server
running on the Fire TV which returns the device’s name along with
a secure and insecure port to continue communicating on. The
remote control continues the communication on the secure port
using TLS by default.
16
Channel Name
Newsy
WCJB TV-20 News
CBS News
1011 News
WEAU News
FilmRise Kids
KJRH 2 Works for You Tulsa
News 5 Cleveland WEWS
NewsChannel 5 Nashville WTVF
Video Title
Newsy’s Latest Headlines
Lets Go with Livestream
CBSN Live Video
Live Newscasts
Live Newscasts
Barnum
Sunday Night Forecast
Freddie Kitchens makes surprise appearance
Live: NewsChannel 5 This Morning at 4
Tracking Domain
google-analytics.com
scorecardresearch.com
scorecardresearch.com
scorecardresearch.com
scorecardresearch.com
spotxchange.com
google-analytics.com
google-analytics.com
google-analytics.com
Table 13: Title leaks in 100 random Roku channels from the Roku-Top1K-MITM crawl.
Video Title
KSAT-TV Livestream
Severe storms batter central U.S.
Severe storms batter central U.S.
Mood Indigo
Partly cloudy, cool Saturday
The Jesus Trek
In the Kitchen with Fireside Grill: Caribbean Jerk Chicken
Channel Name
KSAT TV
WRAL
WRAL
Yuyu - Movies & TV
WTMJ TODAY’s TMJ4 Milwaukee
Hillsong Channel NOW
KJRH 2 Works For You Tulsa
WPTV NewsChannel 5 West Palm To The Point
WKBW 7 Eyewitness News Buffalo Graffiti Patio officially opens at Tappo Pizza
NBC News
NBC News
Popcornflix Kids
Popcornflix Kids
Cooking Channel
Cooking Channel
Travel Channel
Travel Channel
PopcornflixTM- Movies.TV.Free
PopcornflixTM- Movies.TV.Free
Pluto TV - It’s Free TV
TODAY’s Headlines
TODAY’s Headlines
The Tuxedo
The Tuxedo
Raising the Heat
raising the heat
The Dead Files
the dead files
Planes Trains and Automobiles
Planes Trains and Automobiles
The Adventures of Tintin
Tracking Domain
google-analytics.com
scorecardresearch.com
google-analytics.com
spotxchange.com
google-analytics.com
litix.io
google-analytics.com
google-analytics.com
google-analytics.com
omtrdc.net
google-analytics.com
google-analytics.com
youboranqs01.com
conviva.com
google-analytics.com
conviva.com
google-analytics.com
youboranqs01.com
google-analytics.com
youboranqs01.com
Table 14: Title leaks in 100 random Fire TV channels from the FireTV-Top1K-MITM crawl.
17