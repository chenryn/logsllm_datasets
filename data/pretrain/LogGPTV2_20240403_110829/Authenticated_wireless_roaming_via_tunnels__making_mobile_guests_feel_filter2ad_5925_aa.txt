title:Authenticated wireless roaming via tunnels: making mobile guests feel
at home
author:Mark Manulis and
Damien Leroy and
François Koeune and
Olivier Bonaventure and
Jean-Jacques Quisquater
Authenticated Wireless Roaming via Tunnels:
Making Mobile Guests Feel at Home(cid:63)
Mark Manulis1, Damien Leroy2, Francois Koeune1, Olivier Bonaventure2, and Jean-Jacques Quisquater1
1UCL Crypto Group and 2IP Networking Lab, Dept CSE
Universit´e catholique de Louvain, B-1348 Louvain-la-Neuve, Belgium
{mark.manulis|damien.leroy|francois.koeune|olivier.bonaventure|jean-jacques.quisquater}@uclouvain.be
Abstract. In wireless roaming a mobile device obtains a service from some foreign network while
being registered for the similar service at its own home network. However, recent proposals try to
keep the service provider role behind the home network and let the foreign network create a tunnel
connection through which all service requests of the mobile device are sent to and answered directly
by the home network. Such Wireless Roaming via Tunnels (WRT) oﬀers several (security) beneﬁts
but states also new security challenges on authentication and key establishment, as the goal is not
only to protect the end-to-end communication between the tunnel peers but also the tunnel itself.
In this paper we formally specify mutual authentication and key establishment goals for WRT and
propose an eﬃcient and provably secure protocol that can be used to secure such roaming ses-
sion. Additionally, we describe some modular protocol extensions to address resistance against DoS
attacks, anonymity of the mobile device and unlinkability of its roaming sessions, as well as the
accounting claims of the foreign network in commercial scenarios.
Key words: Authentication, end-to-end security, key exchange, mobile networks, security model,
tunnel, wireless roaming
1 Introduction
In the today’s world of mobility one may observe the increasing popularity of wireless networks and
devices, both in companies and private households. In many environments wireless technology is the
default access technology for a variety of services. Its ubiquity combined to the demands on mobility
leads to the interesting research area of wireless roaming.
The main goal of wireless roaming is to provide a mobile device that is registered at its own home
network where it can access certain services, e.g. diverse Internet and mobile (phone) applications, with
similar services when it roams to another foreign network. The problem is that the foreign network is
usually not aware whether the mobile device is authorized to request a roaming connection, and the
mobile device may not know whether the foreign network is authorized to provide this connection (as a
contract partner of the home network).
Current solutions for wireless roaming deployed in wireless local networks (WLANs) and also in mo-
bile phone networks (GSM, CDMA, UMTS, CDMA2000) assume that the requested service is provided
directly by the foreign network. The actual involvement of the home network is reduced to the neces-
sary actions related to the authentication of the mobile device and the foreign network as well as the
establishment of a security association (e.g., session keys) between these two entities.
The recent proposal for wireless roaming by Sastry et al. [54] is conceptually diﬀerent. Instead of
considering the foreign network as the actual service provider they suggest to keep this role behind the
home network by establishing an opaque tunnel connection between the networks and using it to provide
the mobile device with the requested service.
The main technical contribution of our work is the design of a formal security model for authentication
and key establishment in Wireless Roaming via Tunnels (WRT, for short) and its realization through
a suitable protocol. Section 2 introduces the WRT concept as a solution for various practical problems.
(cid:63) This work is supported by the Belgian Walloon Region under its RW-WIST Programme, ALAWN Project.
This is the full version of the paper which appeared in: Proceedings of the ACM Symposium on Information, Computer and Communications Security (ASIACCS'09), March 10-12, 2009 R. Safavi-Naini, V. Varadharajan (Eds.), ACM, pp. 92--103.2
M. Manulis, D. Leroy, F. Koeune, O. Bonaventure, and J.-J. Quisquater
Section 3 describes related work on authentication and key establishment in wireless roaming. In the scope
of the security model in Section 4 we describe basic trust assumptions on the protocol participants and
specify necessary mutual authentication and key exchange requirements. For the proposed protocol, called
AWRT, those basic version is described in Section 5 we give detailed security analysis with respect to the
speciﬁed security goals, provide some eﬃciency remarks and brief ideas on the practical realization of the
tunneled connection. In Section 6 we address several (modular) protocol extensions dealing with forward
secrecy for the established keys, stricter resistance against various types of DoS attacks, anonymity and
unlinkability issues for the roaming mobile device, and the use of the protocol in commercial scenarios, in
which the foreign network is supposed to be reimbursed for the maintenance of the tunnel. We conclude
in Section 7.
2 Wireless Roaming via Tunnels
In the following, we introduce the general concept of WRT and illustrate the main diﬀerences between
our architecture and the original proposal [54]. We then present the advantages and disadvantages of
using tunnels as an alternative way to obtain services. Finally, we identify the desired security goals for
this new approach.
2.1 The Concept
The main scenario we deal with is that a mobile device, that belongs to a home network (e.g., its company)
temporary moves to a foreign network which cannot authenticate it directly. The mobile user would like
to access the Internet as a general service from this network under the same conditions and (security
and network) policies as within its home network. For this, an opaque tunnel is created from the foreign
network to the home network and all the packets sent by the mobile device are sent via this tunnel to its
home network that forwards them to the Internet if appropriate.
The only currently available solution for the tunnel-based roaming by Sastry et al. [54] is based on
VPN tunnels securing the end-to-end communication between the mobile device and its home network.
In their scheme the foreign network accepts every device without any authentication and grants it access
to the home network over the Internet. The mobile device can thus initiate a VPN connection (using
NAT traversal techniques if necessary). However, this solution has several weaknesses. First, the Internet
access granted by the foreign network, even a restricted one, may bear intrusion risks to its infrastruc-
ture. Second, the mobile device must comply with the network layer infrastructure of the foreign network
(e.g., IPv4/IPv6, IP assignment via DHCP). Third, VPN tunnels do not provide any proof to the for-
eign network that the mobile device is connecting to its real home network as a VPN connection can
be established to any server on the Internet. Fourth, foreign and home networks do not authenticate
each other and, as a consequence, neither accounting mechanisms nor quality-of-service contracts can be
securely implemented. We fairly remark that Sastry et al. were focusing on the actual architecture for
the city-wide WiFi roaming rather than dealing with the related authentication and key establishment
goals.
Our approach is diﬀerent. We increase the involvement of the foreign network into the roaming process
by considering it as an inherent part of the security architecture with the obvious goal to eliminate the
above mentioned weaknesses. In our setting the foreign network does not simply agree to grant the mobile
device a restricted Internet access to the claimed home network but is responsible for the establishment
of the tunnel connection between the both after having veriﬁed their authenticity. To achieve the desired
goals we propose a three-party authentication and key establishment protocol between the mobile device,
the foreign and the home network. This protocol permits the authentication of participants and exchange
of relevant session keys — not only for the end-to-end secure communication between the device and its
home network but also for the secure communication with the foreign network. The successful execution
of our protocol means that the foreign network will tunnel all the data sent by the mobile device from
its access point to its home network, lowering the risk of intrusion into its own infrastructure.
Authenticated Wireless Roaming via Tunnels: Making Mobile Feel at Home
3
2.2 Pro and Contra
The concept of WRT appears attractive mostly because of the additional security beneﬁts which it oﬀers
and because it shifts the role of the service provider back to the home network, this in contrast to the
non-tunnel-based approach.
WRT oﬀers several beneﬁts for the foreign network. First, the automatic forwarding of messages
provides better protection of the foreign network’s infrastructure, reducing the risk of unauthorized access
and intrusion attempts by malicious devices. Second, in WRT the mobile device appears to the outside
world (e.g., when accessing a server on the Internet) as part of its home network. Therefore, if a mobile
device misbehaves (e.g., up-/downloads illegal content or mounts DoS attacks) causing investigation and
IP traceback, the foreign network cannot be blamed or blacklisted for it; Robert et al. [51] argue that
WRT would lower the risk for the involvement of the foreign network into the legal investigations resulting
from such malicious activities. Additionally, using WRT eﬀectively prevents the mobile device from using
any value-added services to which the access is granted based on the IP membership within the domain
of the foreign network (e.g., access to digital libraries).
WRT still requires mutual authentication between the mobile device and its home network. This
eliminates impersonation attacks in case that the foreign network misbehaves. In contrast to the non-
tunnel-based approach, WRT may eﬀectively prevent DNS manipulations by the foreign network; thus,
thwarting pharming attacks [58]. In WRT the home network may eﬀectively enforce own security policies
regarding the provided service. In particular, the mobile device may access the same set of services while
it roams, whereas in the non-tunnel-based approach it can access services oﬀered by the foreign network.
For example, considering the connection to the Internet, some networks may impose ﬁrewall restrictions
on the use of diverse Internet application protocols. A mobile user which roams to a network with stricter
policies can then still execute applications he is used to within his own home network.
In commercial roaming scenarios where the foreign network has to be reimbursed for the provided
roaming service, WRT can signiﬁcantly simplify and strengthen the accounting process since both net-
works can keep track on the duration of the roaming connection and the amount of data being transferred
independently of each other.
One may think, that the use of WRT would result in the signiﬁcant increase of the communication
latencies, as every service request has to be sent and answered through the communication link between
the foreign and the home network. Obviously, this delay which relates to the round-trip time could
vary depending on the networks and their geographic location. For example, it has been shown that in
country-wide context (on the example of USA) the expected round trip latencies for the TCP/IP traﬃc
remains below 150 ms [38], while in the intercontinental context they remain below 250 ms for over 90%
of the residential broadband hosts [26]. These examples show that for many applications such as web
surﬁng and email the additional latencies in WRT would remain almost unnoticeable, and the quality
of provided service may still be suﬃcient even for some real-time applications such as Voice-over-IP for
which – according to the ITU-T recommendations [35] – a one-way trip latency below 400 ms might still
be acceptable.
2.3 Desired Security Goals
Suitable WRT authentication and key establishment protocols should take care of protecting not only the
end-to-end communication between the mobile device and the home network but also their communication
with the foreign network.
Obviously, the mobile device and its home network must authenticate each other prior to the use of
the tunnel and establish a session end-to-end key, that is considering the foreign network as a potential
man-in-the-middle attacker. To the contrary, in the non-tunnel-based approach the authentication of the
home network towards the mobile device is usually not required and the session key for the roaming
communication is established between the mobile device and the foreign network.
Further, it is desirable for both networks to mutually authenticate each other prior to the establishment
of the tunnel. This would lower the risk of attacks against the infrastructure of both networks, including
DoS attacks. In commercial scenarios where the foreign network should be reimbursed for the established
4
M. Manulis, D. Leroy, F. Koeune, O. Bonaventure, and J.-J. Quisquater
tunnel this mutual authentication would be useful to implement the accounting process, possibly in real-
time. Further, since the mobile device and the foreign network may not be aware of each other prior to the
protocol execution, the mutual authentication between the networks would indirectly prevent roaming
sessions where either the mobile device (hosted by the home network) or the foreign network is not
authorized to request or establish the tunnel connection, respectively.
In WRT the actual service requests are sent and answered through the established tunnel and can,
therefore, be protected using end-to-end keys. However, the home network and the mobile device may also
wish to exchange certain control messages directly with the foreign network; in particular, checks that the
mobile device and the home network are still connected, requests to close the established connection, and
accounting messages in commercial scenarios. In order to protect such messages and also achieve better
robustness of the roaming session (in particular, against session hijacking and data injection attacks) it is
desirable to provide the foreign network and the tunnel end-peers with an additional session tunnel key;
this key is speciﬁc to WRT and is not required for the non-tunnel-based roaming.
In addition to the previously mentioned mutual authentication and key establishment goals those
formal speciﬁcation and realization represents the main focus of this work, there are additional goals
which we informally address to the end of the paper. Some of them aim to achieve higher robustness of
WRT, e.g., protection against DoS attacks. The goal here is to minimize the risk that one party keeps
an open connection to another party during the protocol execution without being able to verify whether
that party is a valid protocol participant. Another desired goal for WRT in commercial scenarios is to
provide the foreign network with some veriﬁable information to compose its accounting claims. Further
security goals address the proﬁling of the mobile users. In particular, it might be desirable to hide the
user’s identity from the guest network and achieve unlinkability of its roaming sessions as it is currently
the case in GSM/UMTS through the use of TMSI.
3 Related Work on Authentication and Key Establishment in Wireless
Roaming
Many authentication and key establishment protocols for wireless roaming have been proposed so far, in
both academia and industry (as part of standardization), ranging from mobile phone networks of the 2nd
generation (GSM, CDMA) and 3rd generation (UMTS, CDMA2000) over to WLANs (IEEE 802.11 [1]).
3.1 Wireless Roaming in Mobile Phone Networks.
Most of the standard authentication and key establishment protocols for mobile phone networks, e.g.,
[2, 29, 52], are based on the pre-shared key between the home network and its mobile device. These
protocols establish the session key between the mobile device and the foreign network. Several solutions
have been further proposed to allow roaming among diﬀerent mobile phone networks. For example, the
authenticated roaming between GSM and UMTS has been speciﬁed within the UMTS standard [2] and
partially addressed in [3], and the roaming procedure between UMTS and CDMA2000 has been addressed
in [37].
3.2 Wireless Roaming in IP Networks.
In wireless IP networks, the access control is usually implemented based on the IEEE 802.11i security
architecture, either using pre-shared keys (WPA, WPA2) or using the IEEE 802.1X speciﬁcation. Al-
though pre-shared keys are widely used for home and small-oﬃce networks, these does not actually ﬁt
for roaming. In larger networks, preference is given to IEEE 802.1X that is based on EAP [5], a protocol
framework for the transmission of the authentication information between clients and networks. The ac-
tual protocols implemented within this framework are referred to as EAP methods and can be based for
example on usernames and passwords, shared keys, or public-key certiﬁcates (supplied by the client, the
server, or both). EAP using TTLS [32] is used for roaming purpose within the Eduroam infrastructure
composed of the European education institutions that have reached an agreement [28]. Eduroam uses
Authenticated Wireless Roaming via Tunnels: Making Mobile Feel at Home
5
EAP-TTLS in association with RADIUS servers hosted in each partner to authenticate and grant an
Internet access to students and personnel visiting another institution. Another widely used form of au-
thentication in WLANs, recommended by Wi-Fi alliance as a best practice solution [6], is web-based such
that the mobile user provides own credentials as input to the browser form. This technique when based
on the username / password is also known as the Universal Access Method (UAM), see also [7, 8, 41] for
some variations. These credentials are usually forwarded to the authentication server (e.g., RADIUS). As
noticed in [43] such web-based solutions become vulnerable to the access point impersonation, address
spooﬁng, and dictionary attacks. Some improvements to UAM supporting further types of credentials