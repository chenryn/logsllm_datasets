影子经纪人最早在2016年8月就开始对外兜售据称是NSA的网络武器或攻击工具。该组织自称获得了方程式组织的网络武器，并在GitHub公开拍卖。随后，斯诺登则隔空响应了影子经纪人的判断，公开了NSA绝密文档中几处技术细节，包括使用相同的DanderSpritz攻击框架，采用同一个MSGID追踪代码，证实NSA攻击工具与方程式组织攻击武器属于同源软件。
影子经纪人兜售的武器与斯诺登曝光的NSA武器细节特征完全吻合
2016年11月-12月，在拍卖邀请函无人问津，且被GitHub删去之后，影子经纪人并不罢休，而是直接泄露被方程式组织攻破的目标系统IP、域名及其单位名称，并继续以比特币方式售卖上述武器。于是，大量的.cn域名、中国的大学、科研院所出现在被公布的清单上。
2017年1月当Shadow
Brokers打包售卖网络武器再一次失败后，它决定改变商业模式，由批发转零售。开始在ZeroBin网站上较小批量销售黑客工具。在1月11日以750比特币（当时价值$
675,000）的价格打算出售一批能够绕过杀毒软件的Windows黑客工具。13日放出了一批免费的黑客工具，根据一些安全研究人员公布的数据显示，它包含61个Windows黑客工具，其中一些可以绕过杀毒软件的检测。尽管下载链接很快被关闭，但不可避免很多已经迅速泄露到互联网。
2017年4月8日，影子经纪人在medium.com博客网站上发表博文，其中公开了曾经多次拍卖失败的方程式组织Equation
Group的黑客工具包——EQGRP-Auction-Files，允许任何人都可以去解密这个文件，获取其中的一些有价值的东西。
2017年4月14日，影子经纪人再次公布了NSA的一批攻击武器，包括永恒之蓝、永恒王者、永恒浪漫、永恒协作、翡翠纤维、古怪地鼠、爱斯基摩卷、文雅学者、日食之翼和尊重审查等十几款漏洞利用工具。这些都是攻击Windows各组件系统（例如SMB协议、IIS组件、邮件系统等）、极为精巧高效的漏洞利用工具。这批攻击工具利用一个专门的框架平台，对任意的Windows操作系统，不管是什么版本，也不管是哪年的版本，基本上都能进行普适性的网络攻击，自由调配相应的网络攻击，瞄准漏洞即精确实施攻击，可谓武器化程度非常高。
尽管研制开发这些工具的具体年份尚不清楚，但从斯诺登曝光的标记为2008年的文件显示，美国包括NSA在内的情报组织，有可能已经长达数年在持续利用这些高级攻击武器。
而永恒之蓝利用的漏洞，微软刚刚在2017年3月份发布MS17-010补丁文件予以修复，但对于全球安装量极大，约占世界市场70%份额的Windows计算机来说，很难在短时期内完成全部的补丁部署，特别是很多专用系统和隔离网络的补丁安装更加困难。这也是后来5月份WannaCry病毒大肆爆发的直接原因。
这批被泄露的网络武器说明，NSA若干年前就已经掌握了Windows系统的许多漏洞信息，但微软的各国用户一直没有得到任何关于漏洞的信息。也就是说，全球无数台电脑在修复该漏洞之前，是否被NSA武器攻击过，只有NSA的人才清楚。
自2017年6月开始，影子经纪人持续“开闸放货”，声称每月都将定期提供数据泄露服务，逐月出售包括浏览器、路由器、手机等漏洞及相关工具、以及SWIFT供应商和目标国央行入侵等数据。
###  疑似CIA网络武器项目曝光
2017年3月，据《纽约时报》报道，“维基揭秘”网站发布了被认为属于美国中情局（CIA）的8700余份秘密文件，维基揭秘将这些数据命名为“7号军火库”（Vault
7），其中包括大量网络武器、网络黑客行动的细节信息。
泄露的文件显示，CIA组织策划了500余个网络攻击项目，每个项目都附带各自的子项目、恶意软件和黑客工具。项目针对的目标操作系统从微软Windows到苹果iOS，再到Android、Linux，甚至包括互联网节点路由器操作系统等，范围十分广泛。CIA的黑客工具不仅能入侵智能手机、PC终端，而且还可以渗透并控制汽车电子系统、智能电视系统。
中情局雇佣大批计算机网络顶尖技术人员，配合各个项目、行动持续进行武器研发。根据新华社报道，截止2016年底，CIA直属的网络情报中心拥有超过5000名员工，总共设计了超过1000个木马、病毒和其他“武器化恶意代码”。而2017年，从特朗普政府大幅提高军事预算的政策倾向看，CIA从事网络武器库开发人员数量会大幅增加。
CIA部分网络武器采用的是国际合作方式开发。例如英国的军事情报机构军情五处也参与其中。根据2013年斯诺登曝光的文件显示，美国和英国、加拿大、澳大利亚、新西兰等国组成的“五眼联盟”，对全球范围内展开情报收集与共享活动，因此不排除其他三个国家也参与其网络武器库的研发。
根据公开资料发现，CIA开发的一些网络武器，在命名上非常具有欺骗性。比如一款名为“精致美食”的黑客工具，貌似一款普通的打广告的推广软件而已。而“蜂房”也看似一个无害的程序，但实际可以攻击互联网路由器，建立被感染设备之间的通讯链路。
关于这些网络武器是否已经流入民用领域，维基解密表示：中情局对其黑客武器库已经“失控”，其中大部分工具“似乎正在前美国政府的黑客与承包商中未被授权地传播”，存在“极大的扩散风险”。
总之，从安全角度看，武器库的泄露致使大量高精尖的攻击性恶意程序，散播到开放的互联网，给一般的黑客、网络不法分子可乘之机，利用这些武器级工具肆意渗透系统、窃取数据信息、破坏信息基础设施等，将给广大普通互联网用户带来巨大危害，WannaCry就是最典型的代表。而且武器级工具和普通的恶意软件、渗透工具等结合，让很多攻击行为同时具备高级攻击手段和一般手段的特性，增加了犯罪分子的隐蔽性，也会干扰监测识别高级威胁。某种程度上，抬升了安全研究者的门槛，增加了APT的防控难度，网络安全企业任重道远。
##  APT攻击技术热点与发展趋势
###  OFFICE 0day漏洞成焦点
Office漏洞的利用，一直APT组织攻击的重要手段。2017年中，先后又有多个高危的Office漏洞被曝出，其中很大一部分已经被APT组织所使用。Office
0day漏洞已经成为APT组织关注的焦点。
下表给出了2017年新披露的部分Office漏洞及其被APT组织利用的情况。：
**CVE** **编号** | **漏洞类型** | **披露厂商** |  **0day** **利用情况** |  **Nday** **利用情况**  
---|---|---|---|---  
**CVE-2017-0261** | EPS中的UAF漏洞 | FireEye | 被Turla和某APT组织利用 | 摩诃草  
**CVE-2017-0262** | EPS中的类型混淆漏洞 | FireEye，ESET | APT28 | 不详  
**CVE-2017-0199** | OLE对象中的逻辑漏洞 | FireEye | 被多次利用 | 被多次利用  
**CVE-2017-8570** | OLE对象中的逻辑漏洞
(CVE-2017-0199的补丁绕过)
| McAfee | 无 | 不详  
**CVE-2017-8759** | .NET Framework中的逻辑漏洞 | FireEye | 被多次利用 | 被多次利用  
**CVE-2017-11292** | Adobe Flash Player类型混淆漏洞 | Kaspersky | BlackOasis | APT28  
**CVE-2017-11882** | 公式编辑器中的栈溢出漏洞 | embedi | 无 | Cobalt，APT34  
**CVE-2017-11826** | OOXML解析器类型混淆漏洞 | 奇虎360 | 被某APT组织利用 | 不详  
表5 Office 0day漏洞
借此我们也对APT攻击中常见的Office漏洞利用情况进行了分类总结：
  * 逻辑型漏洞
逻辑型漏洞并不是2017年独有的。CVE-2014-4114、CVE-2014-6352(沙虫漏洞及补丁绕过)、CVE-2015-0097都曾名噪一时。
CVE-2017-0199是OLE对象中的逻辑漏洞，并且补丁也存在问题，从而导致了CVE-2017-8570的出现。所幸的是CVE-2017-8570最早由安全研究人员发现，并没有出现0day利用。此外，CVE-2017-8759是.NET中的逻辑漏洞，同样影响Office，这也是Office的复杂性带来的问题。它们原理简单，易于构造，触发稳定，深受APT组织的青睐。
  * 内存破坏型漏洞
**Flash**
从2015年6月至今，卡巴斯基发现仅仅BlackOasis就利用了至少4个Flash
0day漏洞：CVE-2015-5119，CVE-2016-0984，CVE-2016-4117和CVE-2017-11292。不过千疮百孔的Flash
2020年以后就会正式淘汰，之后的利用应该会逐渐减少。
**EPS** **（Encapsulated Post Script)**
对于像CVE-2015-2545，CVE-2017-0261和CVE-2017-0262这样的漏洞来说，由于能够执行EPS脚本，所以具有极强的灵活性。Office
2010以后微软采取了在沙盒中解析EPS文件的方式进行缓解，但是仍然无法阻止攻击者结合内核提权漏洞绕过。2015年FireEye揭露了CVE-2015-2545＋CVE-2015-2546的野外利用，也就是一个EPS漏洞＋一个内核提权漏洞。
ESET曝光的APT28
使用CVE-2017-0262和CVE-2017-0263对法国大选进行攻击的同一天，FireEye也发布博客对Turla、APT28使用该模式的0day漏洞组合攻击做了说明，组合方式是EPS漏洞(CVE-2017-0261、CVE-2017-0262)和内核提权漏洞(CVE-2017-0001、CVE-2017-0263、CVE-2016-7255)。
2017年，360威胁情报中心也监控到了摩诃草组织从2017年11月至12月初的多起活跃攻击，发现摩诃草组织在2017年下半年跟进使用了CVE-2017-0261＋CVE-2016-7255的组合。2017年4月的补丁中微软禁用了EPS以彻底解决该类问题，不过相关利用可能仍然会流行一段时间。
  * 其它
除了上面所述的这些比较特殊的漏洞，近几年APT攻击常用的Office漏洞中除了CVE-2014-1761（RTF解析中的数组越界）巧妙地通过特定的RTF控制字来精确控制内存以至于在没有利用堆喷射的情况下就非常准确可靠地获得程序控制流之外，从CVE-2013-3906（TIFF解析中的整数溢出）第一次发现0day野外利用中ActiveX喷射的技巧开始，CVE-2015-1641（RTF解析中的类型混淆）、CVE-2016-7193（RTF解析中的数组越界）
、CVE-2017-11826（OOXML解析中的类型混淆）等等无一例外都靠这种方法来获得对EIP的控制，效果很不稳定，所需要的时间也比较长。
这些漏洞都很难写出全版本通用的EXP，同时还要通过msvcr71.dll，msvbvm60.dll等没有开启ASLR的模块绕过ASLR，Office
2013以后已经强制将没有开启ASLR模块的dll地址随机化，要想在Office 2013及更高版本上成功利用更是难上加难。
在这样的情况下CVE-2017-11882这个稳定通杀所有Office版本和所有Windows版本的漏洞就显得十分宝贵了，在十七年前编译好的EQNEDT32.EXE没有采用任何漏洞缓解措施，POC公布后就出现包括Cobalt和APT34在内的多个组织的利用，这也是历史遗留代码带来的问题。
虽然我们谈的这些漏洞很多跟OLE（Object Linking and
Embedding，对象连接与嵌入）看上去没有什么关系，但是它们大都通过嵌入或者链接OLE对象来实现利用。2015年BlackHat上Haifei Li
和Bing Sun做了题为Attacking Interoperability:An OLE
Edition的演讲，对历史Office漏洞的原因做了深度探讨。总体来说，OLE机制在Office中提供了巨大的攻击面。
除了传统的宏和VBA之外，DDE（Dynamic Data
Exchange，动态数据交换）技术也是2017年的热词。DDE允许Office应用程序从其他程序中加载数据。利用这种属性可以在Office应用程序中加载执行恶意代码。尽管微软一开始并不打算修复，但还是在2017年12月的补丁中禁用了DDE协议。该攻击方法虽然需要用户交互，但是由于安全意识的缺乏，依然有大量用户中招。2017年APT28就利用DDE技术和纽约恐袭事件发动了攻击。