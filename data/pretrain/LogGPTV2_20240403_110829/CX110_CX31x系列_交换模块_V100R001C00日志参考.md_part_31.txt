l 原因2：网络拓扑有设备优先级发生变化。
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看网络拓扑中优先级的更改操作是
否是正常操作。
n 如果是正常操作，则请执行步骤3。
n 如果不是正常操作，则请执行步骤2。
b. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实
际需要重新配置本桥的优先级。或者执行命令undo stp [ instance instance-id ]
priority、undo stp [ instance instance-id ] root将桥优先级还原成缺省值。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看网络中是否有端口被规划为根保
护端口。
n 如果有端口被规划为根保护端口，则请执行步骤4。
n 如果没有端口被规划为根保护端口，则请执行步骤5。
d. 在接口视图下，执行命令undo stp root-protection去除根保护配置。
e. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.7 MSTP/4/PORT_STATE_DISCARDING
日志信息
MSTP/4/PORT_STATE_DISCARDING:The port has been set to discarding state.
(InstanceID=[InstanceID], PortInstanceID=[PortInstanceID], PortID=[PortID],
IfIndex=[IfIndex], PortName=[PortName])
文档版本 09 (2017-09-04) 华为专有和保密信息 296
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
日志含义
端口状态变为Discarding状态。
日志参数
参数名称 参数含义
InstanceID 实例ID。
PortInstanceID 端口实例ID。
PortID 端口ID。
IfIndex 端口索引。
PortName 端口名称。
可能原因
原因1：网络拓扑发生变化。
处理步骤
l 原因1：网络拓扑发生变化。
a. 请查看网络拓扑中的物理设备，是否有启用生成树协议的新的物理链路加
入。
n 如果有启用生成树协议的新的物理链路加入，则请执行步骤2。
n 如果没有启用生成树协议的新的物理链路加入，则请执行步骤3。
b. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤3。
n 如果不是需要的物理链路，则请执行步骤4。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看各个端口是否符合协议计算结
果。
n 如果各个端口符合协议计算结果，则无需处理。
n 如果各个端口不符合协议计算结果，则请执行步骤5。
d. 请正确部署网络拓扑，查看问题是否解决。如果未解决，请执行步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.8 MSTP/4/PORT_STATE_FORWARDING
日志信息
MSTP/4/PORT_STATE_FORWARDING:The port has been set to forwarding state.
(InstanceID=[InstanceID], PortInstanceID=[PortInstanceID], PortID=[PortID],
IfIndex=[IfIndex], PortName=[PortName])
文档版本 09 (2017-09-04) 华为专有和保密信息 297
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
日志含义
端口状态变为Forwarding状态。
日志参数
参数名称 参数含义
InstanceID 实例ID。
PortInstanceID 端口实例ID。
PortID 端口ID。
IfIndex 端口索引。
PortName 端口名称。
可能原因
原因1：网络拓扑发生变化。
处理步骤
l 原因1：网络拓扑发生变化。
a. 请查看网络拓扑中的物理设备，是否有启用生成树协议的新的物理链路加
入。
n 如果有启用生成树协议的新的物理链路加入，则请执行步骤2。
n 如果没有启用生成树协议的新的物理链路加入，则请执行步骤3。
b. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤3。
n 如果不是需要的物理链路，则请执行步骤4。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看各个端口是否符合协议计算结
果。
n 如果各个端口符合协议计算结果，则无需处理。
n 如果各个端口不符合协议计算结果，则请执行步骤5。
d. 请正确部署网络拓扑，查看问题是否解决。如果未解决，请执行步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.9 MSTP/4/PORT_STATE_LEARNING
日志信息
MSTP/4/PORT_STATE_LEARNING:The port has been set to learning state.
(InstanceID=[InstanceID], PortInstanceID=[PortInstanceID], PortID=[PortID],
IfIndex=[IfIndex], PortName=[PortName])
文档版本 09 (2017-09-04) 华为专有和保密信息 298
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
日志含义
端口状态变为Learning状态。
日志参数
参数名称 参数含义
InstanceID 实例ID。
PortInstanceID 端口实例ID。
PortID 端口ID。
IfIndex 端口索引。
PortName 端口名称。
可能原因
原因1：Forward Delay Timer定时器超时。
处理步骤
l 正常运行信息，无需处理。
----结束
36.10 MSTP/4/PROEDGE_PORT_CHANGED
日志信息
MSTP/4/PROEDGE_PORT_CHANGED:When the port receives a BPDU packet, the edged-
port attribute will be disabled. (ProcessID=[ProcessID], InstanceID=[InstanceID],
PortID1=[PortID1], PortID2=[PortID2], PortID3=[PortID3], PortID4=[PortID4],
PortIDFlag=[PortIDFlag], IfIndex=[IfIndex], PortState=[PortState], PortName=[PortName])
日志含义
边缘端口收到BPDU报文后将失去边缘端口属性。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
PortID2 端口ID2。
PortID3 端口ID3。
PortID4 端口ID4。
文档版本 09 (2017-09-04) 华为专有和保密信息 299
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
参数名称 参数含义
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
可能原因
原因1：MSTP进程内配置为边缘端口的指定端口收到了BPDU报文。
处理步骤
l 原因1：MSTP进程内配置为边缘端口的指定端口收到了BPDU报文。
a. 请查看端口是否应该被规划为边缘端口。
n 如果应该被规划为边缘端口，则请执行步骤2。
n 如果不应该被规划为边缘端口，则请执行步骤3。
b. 请检查端口上BPDU报文的来源，确认是否有恶意攻击。
n 如果有恶意攻击，则请执行步骤4。
n 如果没有恶意攻击，则请执行步骤3。
c. 在接口视图下，执行命令undo stp edged-port和undo shutdown去除边缘端口
配置，重新启用端口。查看问题是否解决。如果未解决，则请执行步骤4。
d. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.11 MSTP/4/PROLOOPBACK_DETECTED
日志信息
MSTP/4/PROLOOPBACK_DETECTED:The MSTP Process's Port has been set to discarding
state because of detecting loopback. (ProcessID=[ProcessID], InstanceID=[InstanceID],
PortID1=[PortID1], PortID2=[PortID2], PortID3=[PortID3], PortID4=[PortID4],
PortIDFlag=[PortIDFlag], IfIndex=[IfIndex], PortState=[PortState], PortName=[PortName])
日志含义
MSTP进程的端口因为检测到环回而进入阻塞状态。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
文档版本 09 (2017-09-04) 华为专有和保密信息 300
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
参数名称 参数含义
PortID2 端口ID2。
PortID3 端口ID3。
PortID4 端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
可能原因
原因1：设备上使能STP的端口检测到环回。
处理步骤
l 原因1：设备上使能STP的端口检测到环回。
a. 查看产生日志的端口是否配置了本地环回。
n 如果是，则请执行步骤3。
n 如果不是，则请执行步骤2。
b. 排查网络中是否有Hub、集线器的连线自环。
n 如果是，则请执行步骤4。
n 如果不是，则请执行步骤5。
c. 删除本地环回的配置，查看问题是否解决。如果未解决，则请执行步骤5。
d. 拔出自环的网线，问题解决。
e. 收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.12 MSTP/4/PROLOST_ROOT_PRIMARY
日志信息
MSTP/4/PROLOST_ROOT_PRIMARY:MSTP process is no longer the root bridge of the
instance. (ProcessID=[ProcessID],InstanceID=[InstanceID])
日志含义
本桥不再是实例的根桥。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
文档版本 09 (2017-09-04) 华为专有和保密信息 301
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
参数名称 参数含义
InstanceID 实例ID。
可能原因
原因1：网络拓扑发生变化，有新的链路加入。新增设备通过配置stp root primary成为
根桥，且MAC地址小于原来的根桥。
原因2：网络拓扑有节点的优先级发生变化。
处理步骤
l 原因1：网络拓扑发生变化，有新的链路加入。新增设备通过配置stp root primary
成为根桥，且MAC地址小于原来的根桥。
a. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤2。
n 如果是不需要的物理链路，则请执行步骤3。
b. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看各个端口是否符合协议计算结
果。
n 如果符合协议计算结果，则无需处理。
n 如果不符合协议计算结果，则请执行步骤4。
c. 请正确部署网络拓扑，查看问题是否解决。如果未解决，请执行步骤4。
d. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
l 原因2：网络拓扑有节点的优先级发生变化。
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]检查网络拓扑中优先级更改操作是否
是正常操作。
n 如果是正常操作，则无需处理。
n 如果是非正常操作，则请执行步骤2。
b. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实
际需要重新配置本桥的优先级。或者执行命令undo stp [ instance instance-id ]
priority、undo stp [ instance instance-id ] root将桥优先级还原成缺省值。查看
问题是否解决。如果未解决，请执行步骤3。
c. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.13 MSTP/4/PROPORT_BPDU_GUARDED
日志信息
MSTP/4/PROPORT_BPDU_GUARDED:The MSTP process's edged-port that enabled
BPDU-Protection will be shutdown, because it received BPDU packet.
(ProcessID=[ProcessID], InstanceID=[InstanceID], PortID1=[PortID1], PortID2=[PortID2],
PortID3=[PortID3], PortID4=[PortID4], PortIDFlag=[PortIDFlag], IfIndex=[IfIndex],
PortState=[PortState], PortName=[PortName])
文档版本 09 (2017-09-04) 华为专有和保密信息 302
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
日志含义
MSTP进程启用了BPDU保护功能的边缘端口上收到了BPDU报文，将被shutdown。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
PortID2 端口ID2。
PortID3 端口ID3。
PortID4 端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
可能原因
原因1：使能BPDU保护的情况下，边缘端口收到BPDU报文。
处理步骤
l 原因1：使能BPDU保护的情况下，边缘端口收到BPDU报文。
a. 请查看端口是否应该被规划为边缘端口。
n 如果应该被规划为边缘端口，则请执行步骤2。
n 如果不应该规划为边缘端口，则请执行步骤3。
b. 请检查端口上BPDU报文的来源，确认是否有恶意攻击。
n 如果有恶意攻击，则请执行步骤4。
n 如果没有恶意攻击，则请执行步骤3。
c. 在接口视图下，执行命令undo stp edged-port和undo shutdown去除边缘端口
配置，重新启用端口。
d. 请收集告警信息、日志信息和配置信息，并联系华为技术支持工程师。
----结束
36.14 MSTP/4/PROPORT_LOOP_GUARDED
日志信息
MSTP/4/PROPORT_LOOP_GUARDED:The MSTP process's instance's LOOP-Protection
port did not receive BPDU packets in prescriptive time. (ProcessID=[ProcessID],
InstanceID=[InstanceID], PortID1=[PortID1], PortID2=[PortID2], PortID3=[PortID3],
文档版本 09 (2017-09-04) 华为专有和保密信息 303
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 36 MSTP
PortID4=[PortID4], PortIDFlag=[PortIDFlag], IfIndex=[IfIndex], PortState=[PortState],
PortName=[PortName])
日志含义
MSTP进程实例中启用了环路保护的端口在规定时间内没有收到BPDU报文。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 端口ID1。
PortID2 端口ID2。
PortID3 端口ID3。
PortID4 端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
可能原因
原因1：对端设备的生成树功能被关闭。
原因2：与对端相连的网络链路拥塞。
处理步骤
l 原因1：对端设备的生成树功能被关闭。
a. 请在相邻设备上执行命令display stp [ process process-id ] [ instance instance-
id ] [ interface interface-type interface-number ] [ brief ]，检查相邻设备端口上
STP功能是否关闭。
n 如果相邻设备端口上STP功能关闭，则请执行步骤2。