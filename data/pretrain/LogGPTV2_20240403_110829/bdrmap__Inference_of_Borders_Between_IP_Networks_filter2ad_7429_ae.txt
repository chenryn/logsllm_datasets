vided a sanitized dump of their interconnection partners
for three routers at interconnection facilities. In total,
they supplied validation data for 293 interconnections
we inferred, with 283 (96.6%) reported as correct.
5.7 Comparing traceroute and BGP views
Table 1 reports the coverage of interdomain connec-
tivity observed by one VP in each of three diﬀerent net-
works. We also used bdrmap to infer border routers of
25 other networks, with similar results. Table 1 catego-
rizes observed links into those observed in BGP (broken
down by inferred AS relationship), and those inferred
only in bdrmap’s traceroutes. bdrmap observed routers
connecting between 92.2% and 96.8% of BGP-observed
networks, with links for providers and peers the best
represented (at least one neighbor router observed for
all peers and providers for two of the three networks).
The rows in Table 1 list the results of the heuristics in
the order in which bdrmap applies them against an in-
ferred neighbor router. bdrmap infers at least half of in-
ferred customer routers with the ﬁrewall heuristic: i.e.,
bdrmap did not observe any interface originated by the
customer in a traceroute. The challenge in inferring cus-
tomers with traceroute is further illustrated by the rela-
tive use of the onenet and silent heuristics: only 3.9% –
8.6% of customers in these three networks had two con-
secutive interfaces in their network, but these heuristics
inferred 36.9% of peers and provider routers. Similarly,
bdrmap inferred that 2.7% – 8.6% of customers had dis-
abled time exceeded messages and ﬁrewalled our probes.
Figure 14: Distribution of number of border
routers and next hop ASes observed on paths
to all routed preﬁxes from 19 VPs in a large ac-
cess network. We found signiﬁcant redundancy
in the number of egress points towards a desti-
nation preﬁx. Most preﬁxes are routed via the
same next hop AS irrespective of VP location.
Figure 15: Marginal utility of VPs in discover-
ing interconnectivity of a large access network.
Some networks require a dense VP deployment
for bdrmap to uncover their links.
5.8 Supporting resource-limited devices
Some of the densest measurement infrastructure de-
ployments use extremely resource-limited devices. A
mapping of IP addresses to originating ASes, stop lists,
as well as state to guide alias resolution can require
substantial CPU time and memory storage relative to
resources available on some devices that could use our
technique. For example, the most powerful RIPE atlas
probes and SamKnows Whitebox measurement devices
use a MIPS-based processor operating at 400Mhz with
32MB of RAM and 4MB ﬂash, while bdrmap required
approximately 150MB of RAM to operate.
 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 5 10 15 20CDFBorder routersNext hop ASNsNumber of exits (border routersornext hop ASNs)GoogleNetflixAkamaiAppleLevel3Cogent 5 10 15 20 25 30 35 40 45 0 2 4 6 8 10 12 14 16 18 20Cumulative number of linksVPEdgecast393Figure 16: The impact of the VP’s geographic location (hollow circles) on the interdomain links (ﬁlled
symbols) observed by the VP for a large access network. Each row plots the longitude of the VP-side
of an interdomain link observed by a single VP in the access network. For Level3, the location of
the VP strongly inﬂuences the interdomain links observed. Because Akamai originates some preﬁxes
exclusively across individual interdomain links, all VPs observe all interdomain links.
We extended our data collection tools so that the
prober (scamper) can run on low-resource devices and
call back to a centrally-operated system, which has ac-
cess to greater compute resources and runs bdrmap.
We used VPs from the BISmark project [41] to prove
the system can feasibly run on other densely deployed
measurement systems. Similar to the SamKnows sys-
tems, the BISmark systems are OpenWrt-based with
a 450Mhz MIPS processor, 64-128MB of RAM, and
16MB of ﬂash storage. During our measurement, the
maximum CPU consumption used by scamper on the
BISmark VPs was 3%, and it used 3.5MB of RAM, or
11% of the total memory on the RIPE atlas and Sam-
Knows Whitebox devices. We use data we collected
from BISmark in §6.
6.
INTERCONNECTION INSIGHTS
We used 19 VPs deployed in a single large U.S. ac-
cess network to measure the diversity of its interdomain
paths in January 2016. Speciﬁcally, we computed the
number of border routers and next hop ASes traversed
on paths from these VPs towards all routed preﬁxes (ﬁg-
ure 14). This measure reﬂects network resiliency; many
border routers and next hop ASes able to reach a desti-
nation implies many redundant paths available in case
of network disruptions. The diversity in interconnection
is remarkable: we inferred that fewer than 2% of pre-
ﬁxes left this access network via the same border router
from each VP. For 73% of preﬁxes, we observed 5–15
distinct border routers, and 13% of preﬁxes had more
than 15 exit points. These numbers suggest astonishing
US East CoastUS West CoastInterconnection LocationPompano, FLAtlanta, GADetroit, MINashville, TNChicago, ILMinneapolis, MNHouston, TXBoulder, COAlbuquerque, NMSalt Lake City, UTSan Jose, CAMonterey, CASeattle, WABeaverton, ORUTCOTXMAILTNMNNYNJVAMDMIGAPAFLWAORCALevel3VP LocationAkamaiGoogleRockville, MDVP LocationVP LocationConcord, MAHillsborough, NJWashington, DCPittsburgh, PA394resiliency and redundancy toward most of the IPv4 In-
ternet. The AS-level density is lower: we inferred that
most (67%) preﬁxes are routed via the same next hop
AS regardless of VP location.
A driving motivation for this work is the ability to ac-
curately measure interdomain congestion and network
resiliency, which requires comprehensive coverage of in-
terdomain links of a network being studied. We thus
need to quantify how many VPs we need in a host-
ing network, and where we need them, to discover all
router-level interconnections. Using the same large ac-
cess network, we measured the marginal utility of ad-
ditional VPs for discovering interdomain links with two
large transit providers and ﬁve CDNs (ﬁgure 15). Aka-
mai and Level3 appear to be at two extremes in terms of
our ability to discover their interconnections from VPs
in the access network, revealing an interesting diﬀerence
in routing and interconnection strategies across these
networks. Speciﬁcally, a single VP in the access network
observes all the network’s interconnections with Aka-
mai, because Akamai advertises certain preﬁxes only at
speciﬁc interconnection points. In contrast, each addi-
tional VP reveals progressively more interconnections
with Level3, consistent with Level3 advertising most
preﬁxes at each interconnection point so that the ac-
cess network can hand oﬀ traﬃc toward a preﬁx at its
closest interconnection point – hot potato routing [42].
We observed all 45 router-level interconnections this ac-
cess network has with Level3 (as of January 2016), but
required 17 VPs in diverse geographical regions across
the U.S. to do so.
Figure 16 illustrates that it is not just number of VPs
but their geographical diversity within the VP that af-
fects the number of distinct interdomain links observed
for a large access network. For this access network, we
used the location information embedded in reverse DNS
mappings for IP addresses on their border routers to in-
fer their geographical location. Akamai’s announcement
policy allows a single VP anywhere to identify all points
of interconnection to this network. Visibility of inter-
connections to Google requires west and east coast VPs,
but visibility to all of Level3’s interconnections requires
VPs spread across the U.S. due to hot potato routing.
7. CONCLUSIONS
It would shock most people that something as basic
as connections between TCP/IP networks remains so
opaque to researchers and regulators, and the range of
research that is handicapped by lack of this measure-
ment capability. Although we have only taken the ﬁrst
step – identifying interdomain links directly connected
to and visible from the network hosting a measurement
vantage point – it is transformative for Internet map-
ping research. Our method uses targeted traceroutes,
detailed knowledge of traceroute behavior, and codiﬁ-
cation of topological constraints in a structured set of
heuristics, to correctly identify network boundaries at
the router-level. We applied our method to reveal the
tremendous density and diversity of router-level inter-
connection between some pairs of ASes. We explored
the parameter space of this method by computing the
marginal gains of VP deployment inside one large access
ISP, and the geographical diversity of VPs required to
achieve a full view of this ISP’s interconnectivity. This
topology measurement and analysis capability forms an
essential cornerstone of the system we are developing to
map interdomain performance measurements at Inter-
net scale, and we publicly release our source code.
Acknowledgments
We thank the operators who discussed aspects of their
network’s operations, the Research and Education Ad-
vanced Network New Zealand (REANNZ), Guilherme
Martins (Princeton) who deployed scamper on BISmark
nodes to support this work, and the anonymous review-
ers for their feedback. BISmark was supported by NSF
CNS-1422680 and CNS-1405781. This work was sup-
ported by NSF CNS-1414177 and CNS-1413905, by the
Department of Homeland Security (DHS) Science and
Technology Directorate, Cyber Security Division (DHS
S&T/CSD) via contract number HHSP233201600010C,
and by a grant from Comcast, but this paper represents
only the position of the authors.
8. REFERENCES
[1] B. Ager, N. Chatzis, A. Feldmann, N. Sarrar,
S. Uhlig, and W. Willinger. Anatomy of a large
European IXP. In SIGCOMM, 2012.
[2] B. Augustin, X. Cuvellier, B. Orgogozo, F. Viger,
T. Friedman, M. Latapy, C. Magnien, and
R. Teixeira. Avoiding traceroute anomalies with
Paris traceroute. In IMC, Oct. 2006.
[3] B. Augustin, B. Krishnamurthy, and
W. Willinger. IXPs: Mapped? In IMC, 2009.
[4] F. Baker. Requirements for IP version 4 routers,
June 1995.
[5] A. Bender, R. Sherwood, and N. Spring. Fixing
Ally’s growing pains with velocity modeling. In
IMC, pages 337–342, Oct. 2008.
[6] X. Cai, J. Heidemann, B. Krishnamurth, and
W. Willinger. Towards an AS-to-organization
map. In IMC, pages 199–205, Nov. 2010.
[7] B. Chandrasekaran, G. Smaragdakis, A. Berger,
M. Luckie, and K.-C. Ng. A server-to-server view
of the Internet. In CoNEXT, 2015.
[8] K. Chen, D. R. Choﬀnes, R. Potharaju, Y. Chen,
F. E. Bustamante, D. Pei, and Y. Zhao. Where
the sidewalk ends: Extending the Internet AS
graph using traceroutes from P2P users. In
CoNEXT, Dec. 2009.
[9] K. Claﬀy, A. Dhamdhere, M. Luckie, D. Clark,
and S. Bauer. Mapping interconnection in the
Internet: Colocation, connectivity and congestion.
http://www.caida.org/funding/nets-congestion/.
395[10] B. Donnet, T. Friedman, and M. Crovella.
Improved algorithms for network topology
discovery. In PAM, pages 149–162, Mar. 2005.
[11] R. Durairajan, P. Barford, J. Sommers, and
W. Willinger. InterTubes: A study of the US
long-haul ﬁber-optic infrastructure. In
SIGCOMM, Aug. 2015.
[12] Federal Communications Commission. MB Docket
No. 14-90), Memorandum Opinion and Order,
FCC 15-94, July 2015. https://apps.fcc.gov/
edocs public/attachmatch/FCC-15-94A1.pdf.
[13] V. Giotsas, G. Smaragdakis, B. Huﬀaker,
M. Luckie, and k claﬀy. Mapping peering
interconnections to a facility. In CoNEXT, 2015.
[14] V. Giotsas, S. Zhou, M. Luckie, and k claﬀy.
Inferring multilateral peering. In CoNEXT, Dec.
2013.
[15] R. Govindan and H. Tangmunarunkit. Heuristics
for Internet map discovery. In INFOCOM, pages
1371–1380, Mar. 2000.
[16] M. Gunes and K. Sarac. Analytical IP alias
resolution. In IEEE International Conf. on
Communications, pages 459–464, 2006.
[17] B. Huﬀaker, A. Dhamdhere, M. Fomenkov, and
kc claﬀy. Toward topology dualism: Improving
the accuracy of AS annotations for routers. In
PAM, Apr. 2010.
[18] B. Huﬀaker, K. Keys, R. Koga, M. Luckie, and
kc claﬀy. CAIDA inferred AS to organization
mapping dataset.
https://www.caida.org/data/as-organizations/.
[19] K. Keys. Internet-scale IP alias resolution
techniques. CCR, 40(1):50–55, 2010.
[20] K. Keys. iﬃnder alias resolution tool, 2012. http:
//www.caida.org/tools/measurement/iﬃnder/.
[21] K. Keys, Y. Hyun, M. Luckie, and k claﬀy.
Internet-scale IPv4 alias resolution with MIDAR:
System architecture. IEEE/ACM Transactions on
Networking, 21(2):383–399, Apr. 2013.
[22] A. Lakhina, J. W. Byers, M. Crovella, and P. Xie.
Sampling biases in IP topology measurements. In
INFOCOM, Apr. 2003.
[23] M. Luckie. Scamper: a scalable and extensible
packet prober for active measurement of the
Internet. In IMC, pages 239–245, Nov. 2010.
[27] M-Lab Research Team. ISP interconnection and
its impact on consumer Internet performance - a
measurement lab consortium technical report.
http://www.measurementlab.net/publications/,
2014.
[28] Z. M. Mao, D. Johnson, J. Rexford, J. Wang, and
R. Katz. Scalable and accurate identiﬁcation of
AS-Level forwarding paths. In INFOCOM, Mar.
2004.
[29] Z. M. Mao, J. Rexford, J. Wang, and R. H. Katz.
Towards an accurate AS-level traceroute tool. In
SIGCOMM, pages 365–378, Aug. 2003.
[30] A. Marder and J. M. Smith. MAP-IT: Multipass
accurate passive inferences from traceroute. In
IMC, 2016.
[31] J.-J. Pansoit and D. Grad. On routes and
multicast trees in the Internet. In SIGCOMM,
1998.
[32] Packet Clearing House. https://preﬁx.pch.net/
applications/ixpdir/menu download.php.
[33] PeeringDB. https://www.peeringdb.com/.
[34] RIPE RIS. http://www.ripe.net/ris/.
[35] U. Oregon Route Views Project.
http://www.routeviews.org/.
[36] S. Roy and N. Feamster. Characterizing correlated
latency anomalies in broadband access networks.
In SIGCOMM, pages 525–526, Aug. 2013.
[37] M. Sanchez, F. Bustamante, B. Krishnamurthy,
W. Willinger, G. Smaragdakis, and J. Erman.
Inter-domain traﬃc estimation for the outsider. In
IMC, Nov. 2014.
[38] J. Sherry, E. Katz-Bassett, M. Pimenova, H. V.
Madhyastha, T. Anderson, and A. Krishnamurthy.
Resolving IP aliases with prespeciﬁed timestamps.
In IMC, pages 172–178, 2010.
[39] R. Sherwood, A. Bender, and N. Spring.
DisCarte: A disjunctive Internet cartographer. In
SIGCOMM, pages 303–314, Aug. 2008.
[40] N. Spring, R. Mahajan, and D. Wetherall.
Measuring ISP topologies with Rocketfuel. In
SIGCOMM, pages 133–145, Aug. 2002.
[41] S. Sundaresan, S. Burnett, N. Feamster, and
W. de Donato. BISmark: A testbed for deploying
measurements and applications in broadband
access networks. In USENIX, June 2014.
[24] M. Luckie, A. Dhamdhere, D. Clark, B. Huﬀaker,
[42] R. Teixeira, A. Shaikh, T. Griﬃn, and J. Rexford.
and k claﬀy. Challenges in inferring Internet
interdomain congestion. In IMC, Nov. 2014.
[25] M. Luckie, B. Huﬀaker, A. Dhamdhere,
V. Giotsas, and k claﬀy. AS relationships,
customer cones, and validation. In IMC, Oct.
2013.
Dynamics of hot-potato routing in IP networks.
In SIGMETRICS, June 2004.
[43] W. Willinger, D. Alderson, and J. C. Doyle.
Mathematics and the Internet: a source of
enormous confusion and great potential. Notices
of AMS, 56(5), May 2009.
[26] M. Luckie and kc claﬀy. A second look at
[44] Y. Zhang, R. Oliveira, H. Zhang, and L. Zhang.
detecting third-party addresses in traceroute
traces with the IP timestamp option. In PAM,
Mar. 2014.
Quantifying the pitfalls of traceroute in AS
connectivity inference. In PAM, 2010.
396