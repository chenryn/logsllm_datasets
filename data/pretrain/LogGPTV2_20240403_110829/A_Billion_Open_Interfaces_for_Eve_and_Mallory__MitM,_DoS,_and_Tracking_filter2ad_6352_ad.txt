### 1. 计算 iφ 和 tφ

对于第二个目标，攻击者将根据公式 (16) 和 (17) 类似地计算 tφ。我们通过实验验证了这些计算的正确性，并在图 10 中展示了当目标相位 φ = τ/4 时，两个目标之间的相位偏移。

\[ t = \left\lfloor \frac{t \mod 64}{16} \right\rfloor + 4 \]
\[ t_{AW} = 64 - (t \mod 64) \]

### 2. 实验验证

我们通过实验验证了这些计算的正确性，并在图 10 中展示了当目标相位 φ = τ/4 时，两个目标之间的相位偏移。

### 3. 更复杂的攻击

更高级的攻击者可以通过对物理层（例如使用定向天线）进行攻击来实现类似单播的效果。然而，这种攻击在实际中很难实施。

### 4. 相关工作：反应式干扰

乍一看，我们的去同步攻击与反应式干扰器 [37, 52, 70, 91] 达到了类似的效果。然而，去同步攻击有两个优点：首先，去同步攻击原则上需要的能量比干扰攻击少。去同步攻击者只需要每 1.5 秒发送一个帧以保持其主节点的位置，因为 AWDL 节点如果超过 1.5 秒没有收到当前主节点的 AF 帧，就会选举新的主节点。相比之下，反应式干扰器需要为每个目标发送的数据包都发出干扰信号。其次，去同步攻击允许截获目标的数据帧，从而可以发动更复杂的中间人 (MitM) 攻击，如第 7 节所述。而普通的干扰器会破坏传输中的数据帧，使任何人都无法解码该帧 [70]。虽然存在一些更复杂的接收机设计可以消除干扰器自身的信号，但这通常需要特殊硬件 [37]。我们的去同步攻击只需要一个带有现成 Wi-Fi 芯片的系统，甚至可以在智能手机上实现 [71]。

### 5. MitM 攻击：通过 AirDrop 植入恶意软件

本节描述了一种针对流行的 AirDrop 服务的 MitM 攻击，该服务允许 iOS 和 macOS 设备通过 AWDL 直接交换文件。首先，我们评估了 AirDrop 的安全性，并发现不良的用户界面设计使得攻击者可以伪装成合法接收者。然后，我们描述了一种完整的 MitM 攻击，该攻击阻止任何发送者发现合法接收者，并随后可以拦截和修改任何 AirDrop 文件传输。最后，我们讨论了可能的缓解措施。

#### 5.1 接收者认证状态的模糊性

我们观察到 AirDrop 使用两种不同类型的连接，即认证连接和未认证连接（见第 3 节）。此外，用户可以将其设备设置为仅对联系人可见或对所有人可见。反直觉的是，可发现性设置仅适用于接收方。特别是，当接收方处于仅对联系人可见模式时，它只会接受来自认证发送者的文件，但发送者会看到所有可发现的接收者，无论它们是否经过认证。这种模糊性对安全性有深远的影响，因为决定连接是否经过认证的责任在于发送设备的用户，这可能会非常复杂。区分认证连接和未认证连接的唯一视觉提示是认证连接会显示接收者的名字和照片。然而，这两种提示都不足以明确判断接收者是否真实。图 12 显示了不同接收者图标，包括攻击者伪造的身份。

#### 5.2 完整的 AirDrop MitM 攻击

我们的 AirDrop MitM 攻击分为三个阶段：
1. 通过 DoS 攻击破坏发现过程。
2. 等待目标接收者变得对所有人可见，迫使用户降级连接。
3. 中继并操纵实际数据传输以在接收者处植入任意文件。图 13 说明了攻击流程，并详细解释了每个阶段。我们还提供了一个视频 PoC 来展示攻击 [77]。

#### 5.3 缓解措施

我们讨论了可能的缓解策略，并根据实施复杂性进行了评估，从最简单的开始：
- 提供更强的视觉提示以标识认证接收者。
- 在超时后将“对所有人可见”重置为“仅对联系人可见”。
- 引入安全 AirDrop 模式以处理非联系人连接。

### 6. 结论

本文详细描述了一种针对 AirDrop 服务的 MitM 攻击，并提出了几种可能的缓解措施。这些措施旨在提高 AirDrop 的安全性，防止攻击者利用现有的设计缺陷进行攻击。