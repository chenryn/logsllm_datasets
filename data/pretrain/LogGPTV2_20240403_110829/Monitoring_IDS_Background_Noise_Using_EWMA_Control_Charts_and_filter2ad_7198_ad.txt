metrics are however limited for this kind of comparisons. It is especially diﬃ-
cult to say if the hourly approach just marks more intervals as anomalous or
is it actually capturing interesting artifacts diﬀerently. On many occasions the
smaller reduction was at least partly due to abrupt intensity shifts. As several
diﬀerent statistics making up the hourly model signal an anomaly whereas the
182
Jouni Viinikka and Herv´e Debar
Table 5. The omnipresence of signatures and their types. Presence measured in active
intervals
signature
type < 5 % active present
ICMP Dst Unr (Comm Adm Proh)
WEB-IIS view source via translate header
ICMP PING speedera
SNMP request udp
WEB-PHP content-disposition
ICMP PING WhatsupGold Windows
SQL Sapphire Worm (incoming)
LOCAL-WEB-IIS CodeRed II attempt
DNS zone transfer
WEB-MISC http directory traversal
Known DDOS Stacheldraht infection
LOCAL-WEB-IIS Nimda.A attempt
DDOS Stacheldraht agent-¿handler (skillz)
BAD TRAFFIC bad frag bits
(spp rpc decode) Frag RPC Records
(spp rpc decode) Incompl RPC segment
ICMP L3retriever Ping
(spp stream4)STLTH ACT(SYN FIN scan)
network
info web
info net
info net
info web
info net
hostile
hostile
info net
info web
hostile
hostile
hostile
proto
proto
proto
info net
proto
ok
ok
ok
ok
ok
ok
ok
ok
no
no
ok
no
ok
no
no
no
no
no
2578
2548
2456
2311
2287
2069
1721
1229
855
708
563
537
512
432
421
276
107
29
95 %
93 %
90 %
85 %
84 %
76 %
63 %
45 %
31 %
26 %
20 %
19 %
18 %
15 %
15 %
10 %
3 %
1 %
continuously updated statistic does this only once. The two DDoS ﬂows had
intensity proﬁles resembling a step function, which caused the hourly model to
ﬂag signiﬁcantly more alerts than the continuous. Another factor encumbering
the comparisons are the diﬀerences in eﬃcient lengths of model memories. As
the time slot statistics of hourly and weekday models are updated with only the
corresponding intensity measures the values averaged have longer span in real
time. For example the hourly model’s statistics are aﬀected by 8 or 24 days old
measurements.
Class ﬂows. Grouping signature classes together increased the ﬂagging percent-
age. Table 6 shows obtained reductions with continuous model and (1−λ) = 0.92
for class aggregates with more than 1000 alerts. In fact, almost every class con-
tains one or more voluminous signatures that were problematic statistically al-
ready by themselves, and this aﬀects the behavior of class aggregate. The in-
creased ﬂagging could also indicate that anomalies in signature based ﬂows with
smaller volume are detected to some degree. The levels of busy intervals are re-
duced relatively well and again generally the ﬂagging increases as alert volume
decreases. The aggregation by class might be used to gain even more abstrac-
tion and higher level summaries in alert saturated situations. However, there are
likely to be better criteria for aggregation than than the alert classes.
Flow stability. To give an idea of the stability of ﬂow proﬁles, Table 7 com-
pares the alert and busy interval reduction obtained for four signatures used in
Monitoring IDS Background Noise Using EWMA Control Charts
183
Table 6. The reduction in alerts and busy intervals when aggregating according to
signature classes. Results for continuous model with 1 − λ = 0.92
ﬂow
misc-activity
class none
attempted-recon
known-issue
web-application-activity
bad-unknown
known-trojan
misc-attack
web-application-attack
attempted-user
attempted-dos
attempted-admin
raw
int. alerts
anomalous
int. alerts
1.9 % 8.9 %
2678 618273
4.8 % 18.3 %
1429 380568
3.7 % 7.0 %
2635 360613
1.7 % 1.1 %
563 308548
3.3 % 16.3 %
88554
3.7 % 20.9 %
65883
5.4 % 34.9 %
46014
1.3 % 2.1 %
39070
9587
9.1 % 40.5 %
3694 19.4 % 40.6 %
2782 24.3 % 67.8 %
1760 20.2 % 33.1 %
2569
2559
1511
1727
1017
272
361
444
Table 7. A comparison of results obtained during learning and testing phases. (1−λ) =
0.92
ﬂow
alerts
intervals
learn. test
learn. test
SNMP request udp
ICMP PING WhatsupGold Windows
ICMP Dst Unr (Comm Adm Proh)
ICMP PING speedera
2.7
4.6
12
2.8
3.5
3.6
36
3.2
2.2
2.9
3.2
1.3
3.5
3.6
3.7
2.0
the learning phase against the reduction in testing data. In general the ﬂagging is
slightly higher in the training data set, but for ICMP Dest Unr (Comm Adm Proh)
signiﬁcantly more alerts are marked anomalous in the test set. The large alert
impulse in this ﬂow, mentioned earlier, accounts for approximately 14 % units of
this increase in test data. Even if those alerts were removed, the increase would
be large. Still, the reduction in busy intervals is quite similar, suggesting higher
peaks in the test set. The ﬁfth signature enforcing a local policy, also viewed
in the learning phase, did not exist anymore in the testing data set. This sig-
nature created alert impulses (see LOCAL-POLICY in Fig. 1(a)) and the alert
reduction was marginal in learning data.
It seems like with the used parameters the reduction performance stays al-
most constant. This would suggest that after setting parameters meeting the
operators needs, our approach is able to adapt to lesser changes in alert ﬂow be-
havior without further adjustment. At least during this test period, none of the
originally nicely-enough-behaving ﬂows changed to more problematic impulse-
like nor vice versa. Also signatures having a constant alert ﬂow or more random
process type behavior, both feasible for the method, kept to their original proﬁle.
184
Jouni Viinikka and Herv´e Debar
To wrap up the results, it seems possible to use this approach to summarize
and monitor the levels of high volume background noise seen by an IDS. Up to
95 % of the one hour time slots showing activity from such an alert ﬂow can
be unburdened from the distraction. For the remaining intervals, instead of a
barrage of alerts, only one alert would be outputted in the end of the interval. As
both data sets came from the same system, the generality of these observations
is rather limited, and more comprehensive testing would be required for further
validation.
If the user is worried that aggregation at signature level loses too much data,
it is possible to use additional criteria, such as source and destination addresses
and/or ports to have more focused alert streams. The reduction in aggregation is
likely to create more ﬂagged intervals, and this is a tradeoﬀ that the user needs
to consider according to his needs and the operating environment. Determining
if the summarization masked important events in the test set was not possible,
as we do not possess records of actual detected intrusions and problems in the
monitored system against which we could compare our results.
4 Related Work
The focus of this work was only on volume reduction and alert aggregation,
not on content improvement nor activity tracking. In addition, the target is
high volume background noise instead of high impact alerts, so we consider the
approach to be diﬀerent from other correlation eﬀorts, such as presented by
Valdes and Skinner [14] or Qin and Lee [15].
Manganaris et al. [16] use data mining to gain better understanding of alert
data. Julisch and Dacier [2] take the approach further and report episode rules
a labor intensive approach and develop conceptual clustering to construct ﬁl-
ters for false positives. Instead of ﬁltering, we propose to monitor the levels of
background noise, if it is possible to signiﬁcantly reduce the number of alerts
displayed to the operator.
In addition to a plethora of other applications, the EWMA model has also
been harnessed for intrusion detection. There are two relatively recent ap-
proaches, a non-named from Ye et al.[9] [10], and ArQoS1 developed by Ma-
hadik et al. [11].
Both of these IDSes are meant mainly to detect Denial of Service (DoS) at-
tacks. Methods proposed by Ye et al. use host-based data source, the Solaris
BSM audit event intensity, for attack detection. ArQoS monitors DiﬀServ net-
work’s Quality of Service (QoS) parameters, like bit rate, jitter and packet drop
rate to detect attacks on QoS. So the latter can be said to be a network-based
approach.
Ye et al. test diﬀerent control charts, in [9] one meant for autocorrelated, an-
other for uncorrelated data, and [10] adds still one for the standard deviation, to
ﬁnd out the suitability for intrusion detection. Their conclusion was that all dif-
1 http://arqos.csc.ncsu.edu
Monitoring IDS Background Noise Using EWMA Control Charts
185
ferent charts could be used for detecting attacks causing statistically signiﬁcant
changes in event intensity.
Mahadik et al. [11] rely on EWMA techniques only to analyze the more
stationary ﬂows. For the less stationary they deploy a χ2 statistic. Their control
chart diﬀers from those used by Ye et al., and according to their tests the overall
system is capable to quickly detect QoS degradation. The approach we propose
diﬀers from these two in the following ways: 1) A view on system state instead
of detecting DoS attacks or intrusions in more general is provided. 2) The audit
source is the alert database created by network based sensor instead of host
based or network traﬃc information. So no access to host audit trail or routers
is required. 3) The control chart is deﬁned slightly diﬀerently.
5 Conclusions and Future Work
Alerts triggered by activity not considered as actual attacks but only harmful
tend to create huge amounts of alerts. Typically this kind of raw intelligence
outputted by sensors is insigniﬁcant and distracting for the operator, but the
changes in the levels of this background noise can be of interest. If these alerts
are removed by simply ﬁltering or judging them as false by correlation engine,
the operator will lose this information.
An alert processing method based on EWMA control charts to summarize
the behavior of such alert ﬂows was presented to meet the ﬁve objectives set
in Sect. 1.3: anomaly highlighting, decreasing operator load, reduction measure-
ment, determination of suitable ﬂows for monitoring, and trend visualization.
According to the experience with the technique, it can be used to highlight
anomalies in high volume alert ﬂows showing suﬃcient degree of regularity. With
this approach it is possible to make the high alert levels associated with these
ﬂows more sustainable without deactivating them. We believe that the method
could be used as such, or in complement to other means of correlation, to moni-
tor alerts considered as background noise of an operational system. The provided
additional diagnostic capabilities may be modest, but more importantly via sum-
marization the operator can save time for more relevant tasks as he is informed
only of signiﬁcant changes in the noise level. A metric based on the proportion of
time units freed from manual processing when monitoring an aggregate instead
of raw alert ﬂow was proposed.
Alert ﬂows creating less alerts or having strict requirements for the timeliness
of detection are better to be treated with other means, since the sampling interval
is scarce and the method is not able to ﬁnd useful trends from small amount of
alerts.
As the method applicability for a particular ﬂow is determined from its vi-
sualization, this goal is not met, and requires the deﬁnition of explicit criteria
and an automated process. Also the generation of meaningful alert summaries
for the operator needs to be addressed for the the objective ’trend visualization’
to be met.
For the moment, only the signatures and signature classes have been used as
the aggregation criterion. The use of source and destination hosts or networks
186
Jouni Viinikka and Herv´e Debar
could be a step towards more speciﬁc ﬂows, if required. We also intend to inves-
tigate diﬀerent similarity measures for forming the monitored aggregates. For
example similar packet payload is one such possibility.
Gathering user experience from the operators would be interesting, and for
this the method is being integrated as part of alert console used internally at
France T´el´ecom.
References
1. James P. Anderson. Computer Security Threat Monitoring and Surveillance. Tech-
nical report, James P. Anderson Co., Fort Washington, Pa 19034, April 1980.
2. Klaus Julisch and Marc Dacier. Mining Intrusion Detection Alarms for Actionable
In Proceedings of Knowledge Discovery in Data and Data Mining
Knowledge.
(SIGKDD), 2002.
3. P. A. Porras, M. W. Fong, and A. Valdes. A Mission-Impact-Based Approach to
INFOSEC Alarm Correlation. In Wespi et al. [17], pages 95–114.
4. B. Morin and H. Debar. Correlation of Intrusion Symptoms: an Application of
Chronicles. In Vigna et al. [18], pages 94–112.
5. H. Debar and B. Morin. Evaluation of the Diagnostic Capabilities of Commercial
Intrusion Detection Systems. In Wespi et al. [17].
6. Klaus Julisch. Mining Alarm Clusters to Improve Alarm Handling Eﬃciency. In
Proceedings of the 17th Annual Computer Security Applications Conference (AC-
SAC2001), December 2001.
7. Soon Tee Teoh, Kwan-Liu Ma, S. Felix Wu, and Xiaoliang Zhao. A Visual Tech-
In Proceedings of IASTED Computer
nique for Internet Anomaly Detection.
Graphics and Imaging. ACTA Press, 2002.
8. S. W. Roberts. Control Chart Tests Based On Geometric Moving Averages. Tech-
nometrics, 1(3):230–250, 1959.
9. Nong Ye, Sean Vilbert, and Qiang Chen. Computer Intrusion Detection Through
EWMA for Autocorrelated and Uncorrelated Data. IEEE Transactions on Relia-
bility, 52(1):75–82, March 2003.
10. Nong Ye, Connie Borror, and Yebin Chang. EWMA Techniques for Computer
Intrusion Detection Through Anomalous Changes In Event Intensity. Quality and
Reliability Engineering International, 18:443–451, 2002.
11. Vinay A. Mahadik, Xiaoyong Wu, and Douglas S. Reeves. Detection of Denial of
QoS Attacks Based on χ2 Statistic and EWMA Control Chart.
URL: http://arqos.csc.ncsu.edu/papers.htm, February 2002.
12. Peter Mell, Vincent Hu, Richard Lippman, Joss Haines, and Marc Zissman. An
Overview of Issues in Testing Intrusion Detection Systems. NIST IR 7007, NIST
CSRC - National Institute of Standards and Technology, Computer Security Re-
source Center, June 2003.
13. Herv´e Debar, Marc Dacier, and Andreas Wespi. A Revised Taxonomy of Intrusion-
Detection Systems. Technical Report RZ 3176 (#93222), IBM Research, Zurich,
October 1999.
14. A. Valdes and K. Skinner. Probabilistic Alert Correlation. In Wenke Lee, Ludovic
M´e, and Andreas Wespi, editors, Proceedings of the 4th International Symposium
on Recent Advances in Intrusion Detection (RAID 2001), volume 2212 of Lecture
Notes in Computer Science, Heidelberg, Germany, 2001. Springer–Verlag.
Monitoring IDS Background Noise Using EWMA Control Charts
187
15. Xinzhou Qin and Wenke Lee. Statistical Causality Analysis of INFOSEC Alert
Data. In Vigna et al. [18], pages 73–93.
16. Stefanos Manganaris, Marvin Christensen, Dan Zerkle, and Keith Hermiz. A Data
Mining Analysis of RTID Alarms. 2nd International Symposium on Recent Ad-
vances in Intrusion Detection (RAID 1999), 1999. Available online:
http://www.raid-symposium.org/raid99/PAPERS/Manganaris.pdf.
17. Andreas Wespi, Giovanni Vigna, and Luca Deri, editors. Proceedings of the 5th
International Symposium on Recent Advances in Intrusion Detection (RAID 2002),
volume 2516 of Lecture Notes in Computer Science, Heidelberg, Germany, 2002.
Springer–Verlag.
18. Giovanni Vigna, Erland Jonsson, and Christopher Kruegel, editors. Proceedings
of the 6th International Symposium on Recent Advances in Intrusion Detection
(RAID 2003), volume 2820 of Lecture Notes in Computer Science, Heidelberg,
Germany, 2003. Springer–Verlag.