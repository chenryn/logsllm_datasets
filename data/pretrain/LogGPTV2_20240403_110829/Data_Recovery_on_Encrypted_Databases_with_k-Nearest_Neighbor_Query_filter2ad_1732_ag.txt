### References

1. M. Garofalakis, “Practical private range search revisited,” in *Proc. of ACM SIGMOD*, 2016, pp. 185–198.

2. L. Devroye, “The equivalence of weak, strong, and complete convergence in L1 for kernel density estimates,” *The Annals of Statistics*, vol. 11, no. 3, pp. 896–904, 1983.

3. F. B. Durak, T. M. DuBuisson, and D. Cash, “What else is revealed by order-revealing encryption?” in *Proc. of the 23rd ACM CCS*, 2016, pp. 1155–1166.

4. Y. Elmehdwi, B. K. Samanthula, and W. Jiang, “Secure k-nearest neighbor query over encrypted data in outsourced environments,” in *Proc. of the 30th IEEE ICDE*, 2014, pp. 664–675.

5. S. Faber, S. Jarecki, H. Krawczyk, Q. Nguyen, M. Rosu, and M. Steiner, “Rich queries on encrypted data: Beyond exact matches,” in *Proc. of the 20th ESORICS*, 2015, pp. 123–145.

6. B. Fuller, M. Varia, A. Yerukhimovich, E. Shen, A. Hamlin, V. Gadepally, R. Shay, J. D. Mitchell, and R. K. Cunningham, “SoK: Cryptographically protected database search,” in *Proc. of the 38th IEEE S&P*, 2017, pp. 172–191.

7. G. Ghinita, P. Kalnis, A. Khoshgozaran, C. Shahabi, and K. Tan, “Private queries in location-based services: Anonymizers are not necessary,” in *Proc. of the ACM SIGMOD*, 2008, pp. 121–132.

8. O. Goldreich and R. Ostrovsky, “Software protection and simulation on oblivious RAMs,” *J. ACM*, vol. 43, no. 3, pp. 431–473, May 1996.

9. P. Grubbs, K. Sekniqi, V. Bindschaedler, M. Naveed, and T. Ristenpart, “Leakage-abuse attacks against order-revealing encryption,” in *Proc. of the 38th IEEE S&P*, 2017, pp. 655–672.

10. F. Hahn and F. Kerschbaum, “Poly-logarithmic range queries on encrypted data with small leakage,” in *Proc. of the ACM CCSW*, 2016, pp. 23–34.

11. B. Hore, S. Mehrotra, and G. Tsudik, “A privacy-preserving index for range queries,” in *Proc. of the 30th VLDB*, 2004, pp. 720–731.

12. M. S. Islam, M. Kuzu, and M. Kantarcioglu, “Access pattern disclosure on searchable encryption: Ramification, attack, and mitigation,” in *Proc. of the 19th NDSS*, 2012.

13. S. Kamara, C. Papamanthou, and T. Roeder, “Dynamic searchable symmetric encryption,” in *Proc. of the 19th ACM CCS*, 2012, pp. 965–976.

14. G. Kellaris, G. Kollios, K. Nissim, and A. O’Neill, “Generic attacks on secure outsourced databases,” in *Proc. of the 23rd ACM CCS*, 2016, pp. 1329–1340.

15. A. Khoshgozaran, H. Shirani-Mehr, and C. Shahabi, “Blind evaluation of location-based queries using space transformation to preserve location privacy,” *GeoInformatica*, vol. 17, no. 4, pp. 599–634, 2013.

16. E. M. Kornaropoulos, C. Papamanthou, and R. Tamassia, “Data recovery on encrypted databases with k-nearest neighbor query leakage,” *Cryptology ePrint Archive*, 2018/719, 2018, https://eprint.iacr.org/2018/719.

17. M. S. Lacharité, B. Minaud, and K. G. Paterson, “Improved reconstruction attacks on encrypted data using range query leakage,” in *Proc. of the 39th IEEE S&P*, 2018, pp. 1–18.

18. J. K. Lawder and P. J. H. King, “Using space-filling curves for multi-dimensional indexing,” in *Proc. of the 17th BNCOD*, 2000, pp. 20–35.

19. K. Lewi and D. J. Wu, “Order-revealing encryption: New constructions, applications, and lower bounds,” in *Proc. of the 23rd ACM CCS*, 2016, pp. 1167–1178.

20. F. Li, R. Shin, and V. Paxson, “Exploring privacy preservation in outsourced k-nearest neighbors with multiple data owners,” in *Proc. of the ACM CCSW*, 2015, pp. 53–64.

21. M. F. Mokbel, C. Chow, and W. G. Aref, “The new Casper: A privacy-aware location-based database server,” in *Proc. of the 23rd IEEE ICDE*, 2007, pp. 1499–1500.

22. B. Moon, H. v. Jagadish, C. Faloutsos, and J. H. Saltz, “Analysis of the clustering properties of the Hilbert space-filling curve,” *IEEE Trans. on Knowl. and Data Eng.*, vol. 13, no. 1, pp. 124–141, Jan. 2001.

23. M. Naveed, S. Kamara, and C. V. Wright, “Inference attacks on property-preserving encrypted databases,” in *Proc. of the 22nd ACM CCS*, 2015, pp. 644–655.

24. S. Nishimura and H. Yokota, “QUILTS: Multidimensional data partitioning framework based on query-aware and skew-tolerant space-filling curves,” in *Proc. of ACM SIGMOD*, 2017, pp. 1525–1537.

25. S. Papadopoulos, S. Bakiras, and D. Papadias, “Nearest neighbor search with strong location privacy,” *PVLDB*, vol. 3, no. 1, pp. 619–629, 2010.

26. V. Pappas, F. Krell, B. Vo, V. Kolesnikov, T. Malkin, S. G. Choi, W. George, A. Keromytis, and S. Bellovin, “Blind Seer: A scalable private DBMS,” in *Proc. of IEEE S&P*, 2014, pp. 359–374.

27. R. Poddar, T. Boelter, and R. A. Popa, “Arx: A strongly encrypted database system,” *Cryptology ePrint Archive*, Report 2016/591, 2016, https://eprint.iacr.org/2016/591.

28. R. A. Popa, C. M. S. Redfield, N. Zeldovich, and H. Balakrishnan, “CryptDB: Protecting confidentiality with encrypted query processing,” in *Proc. of the 23rd ACM SOSP*, 2011, pp. 85–100.

29. S. Shekhar, H. Xiong, and X. Zhou, Eds., *Encyclopedia of GIS*. Springer, 2017.

30. D. X. Song, D. A. Wagner, and A. Perrig, “Practical techniques for searches on encrypted data,” in *Proc. IEEE S&P*, 2000, pp. 44–55.

31. E. Stefanov, C. Papamanthou, and E. Shi, “Practical dynamic searchable encryption with small leakage,” in *Proc. of the 21st NDSS*, 2014.

32. B. Wang, Y. Hou, and M. Li, “Practical and secure nearest neighbor search on encrypted large-scale data,” in *Proc. of the 35th IEEE INFOCOM*, 2016, pp. 1–9.

33. W. K. Wong, D. W. Cheung, B. Kao, and N. Mamoulis, “Secure kNN computation on encrypted databases,” in *Proc. of the ACM SIGMOD*, 2009, pp. 139–152.

34. B. Yao, F. Li, and X. Xiao, “Secure nearest neighbor revisited,” in *Proc. of the 29th IEEE ICDE*, 2013, pp. 733–744.

35. M. L. Yiu, Y. Tao, and N. Mamoulis, “The Bdual-tree: Indexing moving objects by space-filling curves in the dual space,” *VLDB J.*, vol. 17, no. 3, pp. 379–400, 2008.

36. Y. Zhang, J. Katz, and C. Papamanthou, “All your queries are belong to us: The power of file-injection attacks on searchable encryption,” in *Proc. of the 25th USENIX Security*, 2016, pp. 707–720.

### Appendix

#### A. Proof of Theorem 2

Let \( \text{DB} \) have \( n \) values \( v_0, v_1, \ldots, v_{n-1} \). Recall that in the case of \( k \)-NN unordered responses, the bisectors that define the Voronoi segments are \( b_{0,k}, b_{1,k+1}, b_{2,k+2} \) up to \( b_{n-1-k,n-1} \).

To construct \( \text{DB}' \), we will change the values \( v_i \) in a way that the bisectors remain unchanged. This implies that the Voronoi segments will not change. Therefore, the leakage \( L_Q(\text{DB}) = L_Q(\text{DB}') \) while \( \text{DB} \neq \text{DB}' \).

To compute \( \text{DB}' \):
- Set \( v'_0 = v_0 + \epsilon \) and \( v'_k = v_k - \epsilon \), thus not affecting bisector \( b_{0,k} \).
- Changing \( v'_k \) by \( -\epsilon \) requires a change on \( v'_{2k} \) by \( +\epsilon \) so that bisector \( b_{k,2k} \) is not affected either.
- This cascading effect continues until we finally adjust \( v'_{\left\lfloor \frac{n}{k} \right\rfloor k} \).

Note that the range of values that \( \epsilon \) can take is easily computable. Specifically, it is the range from 0 to the minimum distance between any \( v_i \) and \( v_{i+1} \) or \( v_{i-1} \) for all \( i = 0, k, 2k, \ldots, \left\lfloor \frac{n}{k} \right\rfloor k \). Since there are arbitrarily many values in this range, we have an arbitrarily large number of potential \( \text{DB}' \) with the same Voronoi diagram.

#### B. Proof of Lemma 3

Using elementary row operations on the augmented matrix, we compute the echelon form and thus compute the rank of the matrix. Specifically, we introduce two types of echelon transformations:

**Transformation (1):**
\[ L_{n-1+i} - L_i \rightarrow L'_{i+2} \]
\[ L'_{i+2} + L_{i+1} \rightarrow L'_{i+2} \]
\[ L'_{i+2} \rightarrow L'_{i+2} \]

**Transformation (2):**
\[ L_{n-1+i} - L_{i+1} \rightarrow L'_{i} \]
\[ L'_{i} + L_i \rightarrow L'_{i} \]
\[ L'_{i} \rightarrow L'_{i} \]

where Transformation (1) takes values \( 1 \leq i \leq (n - 2) \), and Transformation (2) takes values \( 1 \leq i \leq 2 \).

For example, for Transformation (1) and \( i = 1 \):
\[ L_n - L_1 \rightarrow L'_3 \]
\[ L'_3 + L_2 \rightarrow L'_3 \]

By applying the above two transformations to all possible values of \( i \), we can construct the new set of linear equations and get the following augmented matrix:

\[
\begin{bmatrix}
1 & 0 & 0 & \cdots & 0 & 0 \\
0 & 1 & 0 & \cdots & 0 & 0 \\
0 & 0 & 1 & \cdots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \cdots & 0 & 0 \\
0 & 0 & 0 & \cdots & 1 & 0 \\
L'_{1}: & b_{0,2} - b_{1,2} + b_{0,1} \\
L'_{2}: & b_{1,3} - b_{2,3} + b_{1,2} \\
L'_{3}: & b_{0,2} - b_{0,1} + b_{1,2} \\
\vdots & \vdots \\
L'_{n}: & b_{n-3,n-1} - b_{n-3,n-2} + b_{n-2,n-1}
\end{bmatrix}
\]

From the resulting augmented matrix, we can verify that the rank of the matrix is \( n \), therefore the derived solution of the overdetermined system is unique.

#### C. Proof of Lemma 4

Let \( Z \) be a random variable defined to be the number of queries required to see at least one of each Voronoi segment. Let \( p_i \) be the probability that the \( i \)-th leftmost Voronoi segment is observed by a uniformly generated query. Let \( E^l_i \) be the event that the \( i \)-th leftmost Voronoi segment (with respect to their left-to-right order) is not observed in the first \( l \) queries.

\[ \Pr(E^l_i) = (1 - p_i)^l \leq e^{-p_i l} \]

Using the union bound, we get:
\[ \Pr(Z > m) = \Pr\left( \bigcup_{i=1}^{|R|} E^m_i \right) \leq \sum_{i=1}^{|R|} \Pr(E^m_i) \leq |R| e^{-m \cdot \min_{1 \leq j \leq |R|} p_j} \]

Thus,
\[ \Pr(Z > m) \leq |R| e^{-m \cdot \min_{1 \leq j \leq |R|} p_j} \]

Let us now analyze the above probability event:
\[ \Pr\left( \left| \sum_{i=1}^{|R|} (Y_i - \mathbb{E}[Y_i]) \right| \leq m \epsilon_1 \right) \geq 1 - 3 e^{-m \epsilon_2 / 25} \]

This implies:
\[ \left| \sum_{i=1}^{|R|} (Y_i - \mathbb{E}[Y_i]) \right| \leq m \epsilon_1 \]
\[ \Rightarrow -m \epsilon_1 \leq \sum_{i=1}^{|R|} (Y_i - \mathbb{E}[Y_i]) \leq m \epsilon_1 \]
\[ \Rightarrow \sum_{i=1}^{|R|} \mathbb{E}[Y_i] - m \epsilon_1 \leq \sum_{i=1}^{|R|} Y_i \leq \sum_{i=1}^{|R|} \mathbb{E}[Y_i] + m \epsilon_1 \]

Therefore, the probability that the sum of the deviations from the expected values is within \( m \epsilon_1 \) is at least \( 1 - 3 e^{-m \epsilon_2 / 25} \).