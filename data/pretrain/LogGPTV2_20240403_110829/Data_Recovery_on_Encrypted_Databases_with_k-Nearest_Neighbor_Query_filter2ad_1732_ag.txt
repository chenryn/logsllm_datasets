M. Garofalakis, “Practical private range search revisited,” in Proc. of
ACM SIGMOD, 2016, pp. 185–198.
[13] L. Devroye, “The equivalence of weak, strong and complete convergence
in L1 for kernel density estimates,” The Annals of Statistics, vol. 11,
no. 3, pp. 896–904, 1983.
[14] F. B. Durak, T. M. DuBuisson, and D. Cash, “What else is revealed by
order-revealing encryption?” in Proc. of the 23rd ACM CCS, 2016, pp.
1155–1166.
[15] Y. Elmehdwi, B. K. Samanthula, and W. Jiang, “Secure k-nearest neighbor
query over encrypted data in outsourced environments,” in Proc. of the
30th IEEE ICDE, 2014, pp. 664–675.
[16] S. Faber, S. Jarecki, H. Krawczyk, Q. Nguyen, M. Rosu, and M. Steiner,
“Rich queries on encrypted data: Beyond exact matches,” in Proc. of the
20th ESORICS, 2015, pp. 123–145.
[17] B. Fuller, M. Varia, A. Yerukhimovich, E. Shen, A. Hamlin, V. Gadepally,
R. Shay, J. D. Mitchell, and R. K. Cunningham, “SoK: Cryptographically
protected database search,” in Proc. of the 38th IEEE S&P, 2017, pp.
172–191.
[18] G. Ghinita, P. Kalnis, A. Khoshgozaran, C. Shahabi, and K. Tan, “Private
queries in location based services: anonymizers are not necessary,” in
Proc. of the ACM SIGMOD, 2008, pp. 121–132.
[19] O. Goldreich and R. Ostrovsky, “Software protection and simulation on
oblivious RAMs,” J. ACM, vol. 43, no. 3, pp. 431–473, May 1996.
[20] P. Grubbs, K. Sekniqi, V. Bindschaedler, M. Naveed, and T. Ristenpart,
“Leakage-abuse attacks against order-revealing encryption,” in Proc. of
the 38th IEEE S&P, 2017, pp. 655–672.
[21] F. Hahn and F. Kerschbaum, “Poly-logarithmic range queries on encrypted
data with small leakage,” in Proc. of the ACM CCSW, 2016, pp. 23–34.
[22] B. Hore, S. Mehrotra, and G. Tsudik, “A privacy-preserving index for
range queries,” in Proc. of 30th VLDB, 2004, pp. 720–731.
[23] M. S. Islam, M. Kuzu, and M. Kantarcioglu, “Access pattern disclosure
on searchable encryption: Ramiﬁcation, attack and mitigation,” in Proc.
of the 19th NDSS, 2012.
[24] S. Kamara, C. Papamanthou, and T. Roeder, “Dynamic searchable
symmetric encryption,” in Proc. of the 19th ACM CCS, 2012, pp. 965–
976.
[25] G. Kellaris, G. Kollios, K. Nissim, and A. O’Neill, “Generic attacks on
secure outsourced databases,” in Proc. of the 23rd ACM CCS, 2016, pp.
1329–1340.
[26] A. Khoshgozaran, H. Shirani-Mehr, and C. Shahabi, “Blind evaluation
of location based queries using space transformation to preserve location
privacy,” GeoInformatica, vol. 17, no. 4, pp. 599–634, 2013.
[27] E. M. Kornaropoulos, C. Papamanthou, and R. Tamassia, “Data recovery
on encrypted databases with k-nearest neighbor query leakage,” Cryptol-
ogy ePrint Archive, 2018/719, 2018, https://eprint.iacr.org/2018/719.
[28] M. S. Lacharit´e, B. Minaud, and K. G. Paterson, “Improved reconstruction
attacks on encrypted data using range query leakage,” in Proc. of the
39th IEEE S&P, 2018, pp. 1–18.
[29] J. K. Lawder and P. J. H. King, “Using space-ﬁlling curves for multi-
dimensional indexing,” in Proc. of the 17th BNCOD, 2000, pp. 20–35.
[30] K. Lewi and D. J. Wu, “Order-revealing encryption: New constructions,
applications, and lower bounds,” in Proc. of the 23rd ACM CCS, 2016,
pp. 1167–1178.
[31] F. Li, R. Shin, and V. Paxson, “Exploring privacy preservation in
outsourced k-nearest neighbors with multiple data owners,” in Proc.
of the ACM CCSW, 2015, pp. 53–64.
[32] M. F. Mokbel, C. Chow, and W. G. Aref, “The new casper: A privacy-
aware location-based database server,” in Proc. of the 23rd IEEE ICDE,
2007, pp. 1499–1500.
[33] B. Moon, H. v. Jagadish, C. Faloutsos, and J. H. Saltz, “Analysis of the
clustering properties of the hilbert space-ﬁlling curve,” IEEE Trans. on
Knowl. and Data Eng., vol. 13, no. 1, pp. 124–141, Jan. 2001.
[34] M. Naveed, S. Kamara, and C. V. Wright, “Inference attacks on property-
preserving encrypted databases,” in Proc. of the 22nd ACM CCS, 2015,
pp. 644–655.
[35] S. Nishimura and H. Yokota, “QUILTS: Multidimensional data parti-
tioning framework based on query-aware and skew-tolerant space-ﬁlling
curves,” in Proc. of ACM SIGMOD, 2017, pp. 1525–1537.
[36] S. Papadopoulos, S. Bakiras, and D. Papadias, “Nearest neighbor search
with strong location privacy,” PVLDB, vol. 3, no. 1, pp. 619–629, 2010.
[37] V. Pappas, F. Krell, B. Vo, V. Kolesnikov, T. Malkin, S. G. Choi,
W. George, A. Keromytis, and S. Bellovin, “Blind Seer: A scalable
private DBMS,” in Proc. of IEEE S&P, 2014, pp. 359–374.
[38] R. Poddar, T. Boelter, and R. A. Popa, “Arx: A strongly encrypted
database system,” Cryptology ePrint Archive, Report 2016/591, 2016,
https://eprint.iacr.org/2016/591.
[39] R. A. Popa, C. M. S. Redﬁeld, N. Zeldovich, and H. Balakrishnan,
“CryptDB: Protecting conﬁdentiality with encrypted query processing,”
in Proc. of the 23rd ACM SOSP, 2011, pp. 85–100.
[40] S. Shekhar, H. Xiong, and X. Zhou, Eds., Encyclopedia of GIS. Springer,
2017.
[41] D. X. Song, D. A. Wagner, and A. Perrig, “Practical techniques for
searches on encrypted data,” in Proc. IEEE S&P, 2000, pp. 44–55.
[42] E. Stefanov, C. Papamanthou, and E. Shi, “Practical dynamic searchable
encryption with small leakage,” in Proc. of the 21st NDSS, 2014.
[43] B. Wang, Y. Hou, and M. Li, “Practical and secure nearest neighbor search
on encrypted large-scale data,” in Proc. of the 35th IEEE INFOCOM,
2016, pp. 1–9.
[44] W. K. Wong, D. W. Cheung, B. Kao, and N. Mamoulis, “Secure kNN
computation on encrypted databases,” in Proc. of the ACM SIGMOD,
2009, pp. 139–152.
[45] B. Yao, F. Li, and X. Xiao, “Secure nearest neighbor revisited,” in Proc.
of the 29th IEEE ICDE, 2013, pp. 733–744.
[46] M. L. Yiu, Y. Tao, and N. Mamoulis, “The Bdual-tree: indexing moving
objects by space ﬁlling curves in the dual space,” VLDB J., vol. 17,
no. 3, pp. 379–400, 2008.
[47] Y. Zhang, J. Katz, and C. Papamanthou, “All your queries are belong
to us: The power of ﬁle-injection attacks on searchable encryption,” in
Proc. of the 25th USENIX Security, 2016, pp. 707–720.
VII. APPENDIX
A. Proof of Theorem 2
Let DB have n values v0, v1, . . . , vn−1. Recall that in the
case of k-NN unordered responses, the bisectors that deﬁne the
Voronoi segments are b0,k, b1,k+1, b2,k+2 up to bn−1−k,n−1.
To construct DB(cid:2)
we will change the values vi in a way that
the bisectors stay put. This implies that Voronoi segments
will not change. Therefore the leakage LQ(DB) = LQ(DB(cid:2)
)
while DB (cid:14)= DB(cid:2)
. To compute DB(cid:2)
0 = v0 +  and
k = vk − , thus not affecting bisector b0,k. Changing v(cid:2)
v(cid:2)
k by
−, however, requires a change on v(cid:2)
2k by + so that bisector
bk,2k is not affected either. This cascading effect continues
until we ﬁnally adjust v(cid:2)
(cid:5)n/k(cid:6)k. Note that the range of values
that  can take is easily computable. Speciﬁcally, it is the
, we set v(cid:2)
(cid:18)(cid:17)(cid:21)(cid:23)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:45:34 UTC from IEEE Xplore.  Restrictions apply. 
range from 0 to the minimum distance between any vi and
vi+1 or vi−1 for all i = 0, k, 2k, . . . ,(cid:10)n/k(cid:11)k. Since there are
arbitrarily many values in this range, we have an arbitrarily
number of potential DB(cid:2)
B. Proof of Lemma 3
with the same Voronoi diagram.
Using elementary row operations on the augmented matrix
we compute the echelon form and thus compute the rank of
the matrix. Speciﬁcally we introduce two types of echelon
transformations:
Transformation (1)
Ln−1+i − Li → L(cid:2)
i+2
i+2 + Li+1 → L(cid:2)
L(cid:2)
i+2 → L(cid:2)
L(cid:2)
i+2
i+2
1
2
Transformation (2)
Ln−1+i − Li+1 → L(cid:2)
i + Li → L(cid:2)
L(cid:2)
→ L(cid:2)
L(cid:2)
i
i
i
i
1
2
where Transformation (1) takes values 1 ≤ i ≤ (n − 2), and
Transformation (2) takes values 1 ≤ i ≤ 2. For example,
for Transformation (1) and i = 1 we have: Ln − L1 →
L(cid:2)
3, L(cid:2)
3. By applying the above two
transformations to all possible values of i we can construct
the new set of linear equations, L(cid:2)
n and get the
following augmented matrix.
3 + L2 → L(cid:2)
2, . . . , L(cid:2)
3 → L(cid:2)
1, L(cid:2)
2 L(cid:2)
3, 1
⎡
⎢⎢⎢⎢⎣
1
0
0
. . .
0
0
1
0
. . .
0
0
0
1
. . .
0
. . .
. . .
. . .
. . .
. . .
0
0
0
. . .
0
0
0
0
. . .
1
L
(cid:2)
1:
(cid:2)
2:
(cid:2)
3:
...
(cid:2)
n
:
L
L
L
b0,2 − b1,2 + b0,1
b1,3 − b2,3 + b1,2
b0,2 − b0,1 + b1,2
bn−3,n−1 − bn−3,n−2 + bn−2,n−1
. . .
⎤
⎥⎥⎥⎥⎦
From the resulting augmented matrix we can verify that the
rank of the matrix is n, therefore the derived solution of the
overdetermined system is unique.
C. Proof of Lemma 4
Let Z be a random variable deﬁned to be the number of
queries required to see at least one of each Voronoi segments.
Let pi be the probability that i-th leftmost Voronoi segment is
observed by a uniformly generated query. Let El
i be the even
that the i-th leftmost Voronoi segment (wrt to their left-to-right
order) is not observed in the ﬁrst l queries.
i) = (1 − pi)l ≤ e−pil
(cid:17)
Using the union bound we get:
≤
|R|(cid:19)
|R|(cid:19)
e−pim
Pr(Z > m) = Pr
Pr(Em
Pr(El
(cid:18)
∪|R|
i=1Em
i ) ≤
i
i=1
i=1
|R|(cid:19)
e−m·min1≤j≤|R| pj = |R|e−m·min1≤j≤|R| pj
i=1
≤
= |R|e− m
Thus, Pr(Z  m1) ≤ 3e−m2
(cid:9) |R|(cid:19)
i=1
1/25
|Yi − E[Yi]| ≤ m1) > 1 − 3e−m2
1/25.
Let us now analyze the above probability event:
Pr
⇒ Pr
|R|(cid:19)
i=1
|Yi − E[Yi]| ≤ m1
|R|(cid:19)
(Yi − E[Yi])| ≤
i=1
⇒ |
i=1
|R|(cid:19)
(cid:9)
(cid:10) − 1 ≤
Yi − E[Yi]
|R|(cid:19)
⇒ −m1 ≤
⇒(cid:9) |R|(cid:19)
i=1
E[Yi]
m
i=1
i=1
|R|(cid:19)
|Yi − E[Yi]| ≤ m1
(cid:10) ≤ m1
≤(cid:9) |R|(cid:19)
E[Yi]
(cid:10)
+ 1
Yi