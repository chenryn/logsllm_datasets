含x。为简单起见，我们假定下列法则中的所有表达式都是全面
5.5.1
遗的是
我们希望
避免使用这种技术，因为它不具有我们所要的数学性质。臀如，
LONGQU0T=(q:=0;r:=x;((r≥y)*(q:=q+1;r:=r-y)))
X5和X4的功能相同，但用减法计算商，即
X4设计一个进程，以正数y除自然数x，将商赋予4，余数赋予
表达式的表，它们可能包含x或y中的变元；f（e）包含e，f（x）包
用循环代替了原来的递归式。
X3行为如POS(5.1节X8)的进程
拟，
计算器的却值设置成零。
5
数，
，即对变元的任何可能值，都能给出结果。
在赋值法则中，x，y代表不同的变元的表；e,f(x)，f（e)代表
(m.left!1-→m.left!1-→SKIP)≠(m.teft!1-SKIP)
附庸进程和使用它的进程传递变元值。本章中，我们有意地
在4.5节X3中，我们已说明，变元的行为可用附庸进程模
若x，是不同变元的一个表，则
(x:=x) = SKIP
（x=ex=f(x))=（x=f（e))
法则
(1 -u=:u+umop|l +u=:u+-dn)*(0Q=P
L5--6b是幂等、结合，且对c可分配
的单个赋值。
L13
5
.11
8
将b看作二元的中缀算子，它具有几个熟知的代数性质
2
为有效地处理并发进程中的赋值，必须保证在一个并发进程
Pt-bQ=Q4bp
PfalseQ=Q
(PbQ)R=(P,R)b≠(Q;R)
x:=e;(P4b(x)Q)=(x:=;P)b(e)(x:=e;Q)
Pt(abc)Q=(PaQ)b(PcQ)
Pb(QR)=PbR
((olld)f'=x)=(of=:)(do=x)
var(P)∩acc(Q) =var(Q)∩acc(P)= {}
acc（P）可在P中的表达式中引用的变元集
tar（P）可在P中赋值的变元集
var(P)≤acc(P)≤aP
---
## Page 202
变元名字x表示程序变元x的初始值。而用x加上上标√，即x，
5.5.2描述
察到x~的值。因此，只在tr。=V/时，能对x进行描越。
表示x的终止值。进程终止时，即迹的最后事件是V时，才能观
法则L2,L4也需作小的修改
L16*
能引发任何事情。我们在法则中用CHAOS反映这个观点。
我们有理由认为e总是有定义的，即
刻面程序变元的初始值、终止值以及迹之间的关系。我们用程序
17'
术中，
有运算对象的值都在相应算子的定义域中。例如，在自然数的算
达式表，合要。为一个布尔表达式，其取真值当且仅当。中所
这条法则叉一次表明，b的值在并行分叉前或后都相同。
{1=()()o (d)(od)=(y0) s1
者任意穿插执行，而不会影响进程的外部可观察的行为。
4'
L2'
我们现在讨论表达式对某些变元值无定义的问题。若é是表
最后，并发组合对条件算子可分配
顺序进程的描逃，不仅要刻画可能出现的事件的迹，而且要
我们有意根本不提无定义表达式求值的结果，认为这样做可
(PbP)=(P@bCHAOS)
(x=;x=f(x))=(x=f(e)②e≠CHAOS)
(sOVHO=x)=（=x)
D(r-y)=y≤r
9(e+f)=geAof
④(y+1,z+y)=true
@(x+y)=(y>0)
②(ge) =true
179
---
## Page 203
描述。为证明SKIP满足这个描述，显然要求当迹为空时，这个
这里使用的（包括出现在以后描述中的）变元都表示自然数，
X5以后要用到一个更复杂的描述
X4川正数y除非负数x，将商赋予9，余数赋予r，即
S(x)。S（x)就写作描述的前提。
为使进程正常运行，往往需要规定程序变元x的某种前置条件
X3将第一个事伴赋予x，成为其终止值，y不变，描述为
完这个事件就终止，x和y的终止值同于初始值，其描述为
X2只做一个事件的进程，这个事件的符号就是变元x的初值，做
其描述为
X1什么事都不做，只把r加1，y不变，然后成功终止的进程，
描述为真；而且当迹为，xV的值等于其初始值时，描述亦成
在第二个操作数大于第一个操作数时，减法是无定义的。
如去掉前置条件，这个描逃是不可能完至满足的。
现在陈述证明进程满足其描述的法则。合S(x,tr,x")是一个
DIVL00P=(tr=<>V(tr=Ar=(q-4)xy+rAr0=>tr=<>V(t=Aq=(x+y)
若S(x，<>,x)
举例
T(n)=r,x)
tr=<>Vtr=V(tr=(x，V>Ax=xAy=y)
#tr≤2A（#tr=2→（tr=Ay=y))
tr=<>V（tr=Ax=x+1Ay=y)
Ax=xAy=y))
Ay=yAx=x))
Ar=x-（qxy)
故
口
口
厂
口
---
## Page 204
这也是一个显见的定理。本结论将用于X10。
（2）将描述中的tr代之，终止值代之初始值，得到
这是一个重言式。
证明
X7 SKIP sat (rDIVL00P))
其中x是A中所有变元的表，x~是这些带勾变元的表。X6可由LI
X6SKIP所满足的最强描远是
如果你想达到某个真正的目标，你就不能从非法赋值并始。
句的法则
将L2中P代之以SKIP并使用X6及5.2节L1，就可导出简单赋值语
e；P）满足修改后的描述，
置条件下，若P满足描述S(x)，修改S(x)使x的初值是e，则(x=
(1）将描远中的tr代之<>，得到
直接推论，反之亦然。
x8SKIPsat(tr≠<>>(tr=Aq=qAr=r
作为L2的推论，对任意P，关于(x:=1/0；P)，能证明的最强事实
L2Ax=sat(eAtr≠<>>r=Ax=eAx=xA)
则
12
若P sat S(x)
表达式e有定义是一个有效赋值x:=的前置条件。在这个前
r=<>V(=Ax=xAy=y
举密
(x:=e; P) sat(@e=S(e))
SKIP sat S(x,tr,x)
SKIPA sat (tr=<>V(tr=Ar=x))
r<>=<>V··
(x:=1/0; P) sat true
Ar=((q-q)xy+r)Ar(T(n +1)> DIV L00P))
由自然数的初等代数
这里 DIVLOOP'=(tr=<>V(tr=A(r-y)=
故
(r:=r-y;X)sat(y(r-y(tr=<>
X9
上一行中的描述等价于定义在X4中的DIV。
<>Vx(÷x)xV0DIVL0OP)
(P;Q)sat(3y,s,L.tr=(s;t)AS(x,s,y)AT(y,t,x))
P不发散
Q sat T(x,tr,x)
(q=q+1sr:=r-y;X) sat(y≤r>(r
tr=Aq=（x+y)Ar=（x-（x+y）xy)
(q-(q+1))xy+rAr(DIVL0OP' =DIVL00P)
Aq=Ar=x-qxyAyyAx=x)
Ay=yAx=x))
((( =(f-)V=A
Ay=yAx=x)
DIVLOOP'))
口
口
---
## Page 206
3n.T(n,x)是说明循环进程在有穷步选代后终止的前置条件，故
由于是不在R中出现的变元，故上式等价于
Vn,S(n),也就是
定义，则T（0,)为假，这样S（0)为真。对循环进程证明的结果是
x时，循环进程在n次重复前终止的条件。然后定义
显然，
构造S（#)的一般方法是发现一个谓词T（，x)，它刻画初始状态为
则我们必须找到描述S（n)，使得S（0)恒真，且
卫递归式的法则（见3.7.1节L8）。若R是所要的循环进程的描述，
得到所求结论。
为得到结论所需的两个充分条件，已在X7和X9中证明，故由L4A
d1xS(x-=+=)=NO0x
L4A若P sat(b→S),且Qsat(b→S)则
这条法则的另--可能便于使用的形式是
L4
条件为假时，则同于第二个成分的描速，即
们带上标后组成的表，y是与它们个数相同的新变元的表，
为证明循环算子的特性，需用到5.5节的递归定义D1，和无
条件算子的描述，当条件为箕时，同于第一个成分的描述，
若P sat S，且 Q sat T则
举例
循环进程不可能在少于0次重复下就终止，故若T（n，x）有
COND sat (T(n + J)>DIVLOOP)
X sat (T(n)=>DIVLOOP)
(PbQ)sat((bAS)V(bAT))
S(n) =(T(n,x)→R)
(3n.T(n,x))>R
(Vn,S(n))>R
Vn.(T(n,x)>R)
(PtbQ)sat S
183
L
---
## Page 207
不可能有强于该式的有关描迹了。
x))就是Cliff Jones 所定义的前/后置条件组。若R(x~)不提及
而且R（x，x~）刻画了初值x和终止值x的关系。这样（P(x），R（x，
就说明了，若Q启动时，其变元的初始值使P(x)成立，则Q终止，
程序中不出现输入和输出算子。若Q是纯顺序程序，则证明、
完成。读者可补全证明作为练习。
这是表示循环终止的前置条件。证明的其余部分已在X7和X5中
等价于
T(0)显然为假：命题
首先，我们需列出循环在n次重复前终止的条件
是证明循环体满足某个适当的描述，即证明
DIV的。本任务自然地分成两部分。
X11我们证明用重复减法实现除法（5.5节X5）‘是满足描述
则
和
L5 若一T(0,x)， 且 T(n,x)→@b
一般法则
方程涉及条件进程，故这个证明分为两部分。这样，我们导出了
最后，我们必须证明循环体满足描述。由于定义循环的递归
184
本节中的法则可作为纯顺序程序完全正确性的演算，在这种
举例