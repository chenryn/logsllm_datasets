0.45
0.42
0.68
10.00
10.14
1.32
5.78
BT UDP
P2P likely
unclassiﬁed
other known
BT/P2P likely
Fig. 3. Application mix (September 2013) for packets and bytes.
188
P. Richter et al.
Fig. 4. Application mix over time.
Table 2. Reported application mix in other studies (ﬁxed, IPv4).
Study Network type Method
Bytes
Year HTTP(S) Other known BT/P2P Unclassiﬁed
5 large ISPs
Payload-based
2009 52.1 %
110 Networks Port-based
2009 52 %
24 %
10 %
18.3 %
5.5 %
1 %
37 %
Large ISP
Payload-based
2009 57.6 %
23.5 %
13.5 %
10.6 %
Large ISP
Payload-based
2010 60 %
260 Networks Port-based
Various
Various
Various
Various
2013 69.2 %
Payload-based [5] 2014 ≈70 %
Payload-based [5] 2014 ≈65 %
Payload-based [5] 2014 ≈60 %
Payload-based [5] 2014 ≈65 %
28 %
4 %
N/A
N/A
N/A
N/A
12 %
<7 %
6 %
15 %
30 %
9.4 %
N/A
20 %
N/A
N/A
N/A
N/A
[21]
[21]
[23]
[16]
[12]
[4]
[4]
[4]
[4]
5 The Application Mix: A Moving Target
5.1 The Aggregate View
The Internet’s application mix has been the topic of numerous past studies by
networking researchers and commercial companies alike. In the following, we
report how the observed application mix at our IXP compares to other recent
studies that not only relied on traﬃc data from diﬀerent vantage points (and
hence diﬀerent types of peering links) but also used diﬀerent application classi-
ﬁcation methods. Recall that in this study, we are only considering traﬃc that
traverses the IXPs public peering links and have no visibility into the traﬃc
that is sent over the private peering links established a this IXP. Table 2 lists
some of the pertinent prior studies and provides information about the reported
application mix, the type of traﬃc data used, and (where available) the classiﬁ-
cation method used.2 A cursory comparison of the results of these studies with
our ﬁndings suggests that the application mix of the Internet is rather homo-
geneous. That is, HTTP(S) dominates with a share of roughly 60 %, no matter
2 Note that the applications belonging to the “other known” traﬃc class vary across
studies.
Distilling the Internet’s Application Mix from Packet-Sampled Traﬃc
189
where in the network and with what methodology the application mix was mea-
sured. Other protocols such as BitTorrent or P2P seem to vary by region from
around 10 % to 30 %, but these variations could also be in part due to varying
classiﬁcation approaches.
5.2 Beyond the Aggregate Application Mix
Next, we take a closer look at the apparent homogeneous nature of the Internet’s
application mix and examine in detail the application mix of the traﬃc that
traverses the peering links of speciﬁc networks.
Figure 5 shows the application mix for each of the top-15 traﬃc-contributing
member ASes of our IXP and top-3 traﬃc-contributing transit providers that
are also IXP members. The type of the top-15 traﬃc-contributing IXP mem-
bers is either Content/CDN, Hoster/IaaS or Eyeball/Access, and together they
are responsible for 59 % of the all the traﬃc (in bytes) seen at this IXP. We
see that for all networks of type Content/CDN HTTP(S) traﬃc clearly domi-
nates, with shares close to 100 %. While most of these networks still rely mainly
on HTTP, we notice one prominent network (third bar from the left) that has
almost a 50/50 ratio of HTTP and HTTPS traﬃc. This example suggests that
the earlier reported growth in HTTPS is mainly driven by some big content
providers switching over to HTTPS. Overall, for networks of type Content/CDN
we observe little or no application-mix heterogeneity on their individual links.
Networks of the type Hoster/IaaS show a more diverse proﬁle when it comes
to their application mix. While HTTP still dominates, we see surprisingly no
signiﬁcant amount of HTTPS traﬃc. At the same time, these networks also see
other types of traﬃc of various protocols as well as signiﬁcant shares of Bit-
Torrent traﬃc and unclassiﬁed traﬃc. Note that BitTorrent is also increasingly
used to deliver video content or software [2]. In short, the diverse application
mix contributed by Web hosters reﬂects the fact that they oﬀer infrastructure
services to a wide variety of companies and individuals, which in turn make
diﬀerent use of the provided resources. The results for Eyeball/Access networks
show that the application mix of networks connecting end-users to the IXP also
c
i
f
f
a
r
t
'
s
r
e
b
m
e
m
f
o
n
o
i
t
c
a
r
f
0
.
1
8
.
0
6
.
0
4
.
0
2
.
0
0
0
.
unclassified
BT + BT/P2P likely
other known
HTTPS
HTTP
Content/CDN          Hoster/IaaS       Eyeball/Access         Transit
Fig. 5. Application mix of the top-15 traﬃc-contributing non-transit member ASes
(grouped by business type) and the top-3 traﬃc-contributing member ASes that are
transit providers.
190
P. Richter et al.
Fig. 6. Application mix of the top-25 traﬃc-carrying links.
varies signiﬁcantly. While for some of them, HTTP(S) (along with small frac-
tions of other traﬃc such as email, RTMP, news) clearly dominates, we also see
eyeball networks with more than 50 % of BitTorrent traﬃc — the two networks
with signiﬁcant BitTorrent contributions are serving eastern European countries,
while the other three networks are serving users in central Europe. This obser-
vation suggests that the diﬀerences in BitTorrent usage also reﬂect geographic
properties (i.e., varying application popularity). The application mix seen for
Transit networks is in general quite diverse as they typically carry traﬃc from
a wide range of diﬀerent networks.
The picture of the Internet’s application mix sharpens even more when we
look at the application mix seen on individual peering links. Figure 6 shows the
application mix for the top-25 traﬃc-carrying bidirectional links at our IXP.
The ﬁgure also includes the business types of the networks on either side of
these peerings. Based on this set of links which see signiﬁcant traﬃc, we observe
a variety of diﬀerent application mixes. While all Content-to-Eyeball links carry
exclusively HTTP(S) and few other known applications, BitTorrent is the clear
winner on two links between Eyeball networks. Thus, when taking into account
the business types of two networks associated with a peering link, we notice a
strong dependency on the resulting applications mix. The few links that show
a more heterogeneous application mix are usually transit links or, interestingly,
links involving Hosters and IaaS providers. When looking at the top-25 unidirec-
tional links (not shown), we see a similar pattern, where for Content-to-Eyeball
links the resulting application homogeneity (i.e., HTTP) is even more dominant.
6 Conclusion
In this paper we developed a traﬃc classiﬁcation methodology that is by and
large able to overcome the challenges posed by packet-sampled traﬃc through the
use of a stateful classiﬁcation approach based on endpoint-aggregation. Using our
new methodology we can attribute more than 78 % of the bytes exchanged over
the public switching infrastructure of a large IXP to their respective application
by relying on strong payload-based classiﬁcation. We attribute another 11.5 %
Distilling the Internet’s Application Mix from Packet-Sampled Traﬃc
191
when including a heuristic based on communication patterns and classify an
additional 4.5 % using port-based classiﬁcation. In the process, we observe that
the aggregate application mix as seen at our IXP is largely consistent with
that reported in other recent studies. However, when dissecting the traﬃc and
examining the application mix of Internet traﬃc that traverses individual public
peering links, we show that the application mix becomes heterogeneous but is
strongly inﬂuenced by the business type of the networks on either side of a
peering link.
Acknowledgements. We want to express our gratitude towards the IXP operators
for their generous support and feedback. We thank the anonymous reviewers for their
helpful feedback. Georgios Smaragdakis was supported by the EU Marie Curie IOF
“CDN-H” (PEOPLE-628441).
References
1. BitTorrent Protocol Speciﬁcation v 1.0. https://wiki.theory.org/BitTorrent
Speciﬁcation
2. Digital Trends article, 12 October 2013. http://www.digitaltrends.com/opinion/
bittorrents-image-problem/
3. L7-ﬁlter. http://l7-ﬁlter.sourceforge.net/
4. Sandvine Global Internet Phenomena, 1H 2014. https://www.sandvine.com/
downloads/general/global-internet-phenomena/
5. Sandvine Traﬃc Classiﬁcation. https://www.sandvine.com/technology/traﬃc-
classiﬁcation.html
6. uTorrent Transport Protocol Speciﬁcation. http://www.bittorrent.org/beps/bep
0029.html
7. Ager, B., Chatzis, N., Feldmann, A., Sarrar, N., Uhlig, S., Willinger, W.: Anatomy
of a large European IXP. In: ACM SIGCOMM (2012)
8. Alcock, S., Nelson, R.: Libprotoident: Traﬃc classiﬁcation using lightweight packet
inspection. University of Waikato, Technical report (2012)
9. Bonﬁglio, D., Mellia, M., Meo, M., Ritacca, N., Rossi, D.: Tracking down skype
traﬃc. In: IEEE INFOCOM (2008)
10. Callado, A., Kamienski, C., Szabo, G., Gero, B., Kelner, J., Fernandes, S., Sadok,
D.: A survey on internet traﬃc identiﬁcation. IEEE Commun. Surv. Tutor. 11(3),
37–52 (2009)
11. Carela-Espa˜nol, V., Bujlow, T., Barlet-Ros, P.: Is our ground-truth for traﬃc clas-
siﬁcation reliable? In: Faloutsos, M., Kuzmanovic, A. (eds.) PAM 2014. LNCS, vol.
8362, pp. 98–108. Springer, Heidelberg (2014)
12. Czyz, J., Allman, M., Zhang, J., Iekel-Johnson, S., Osterweil, E., Bailey, M.: Mea-
suring IPv6 adoption. In: ACM SIGCOMM (2014)
13. Dainotti, A., Pescape, A., Claﬀy, K.: Issues and future directions in traﬃc classi-
ﬁcation. IEEE Netw. Mag. 26(1), 35–40 (2012)
14. Finamore, A., Mellia, M., Meo, M., Munafo, M., Rossi, D.: Experiences of Internet
traﬃc monitoring with Tstat. IEEE Netw. 25(3), 8–14 (2011)
15. Finamore, A., Mellia, M., Meo, M., Rossi, D.: KISS: Stochastic packet inspection
classiﬁer for UDP traﬃc. IEEE/ACM Trans. Netw. 18(5), 1505–1515 (2010)
16. Gerber, A., Doverspike, R.: Traﬃc types and growth in backbone networks. In:
OFC/NFOEC (2011)
192
P. Richter et al.
17. Iliofotou, M., Gallagher, B., Eliassi-Rad, T., Xie, G., Faloutsos, M.: Proﬁling-by-
association: A resilient traﬃc proﬁling solution for the internet backbone. In: ACM
CoNEXT (2010)
18. Karagiannis, T., Broido, A., Faloutsos, M., claﬀy, Kc.: Transport layer identiﬁca-
tion of P2P traﬃc. In: ACM IMC (2004)
19. Karagiannis, T., Papagiannaki, K., Faloutsos, M.: BLINC: multilevel traﬃc clas-
siﬁcation in the dark. In: ACM SIGCOMM (2005)
20. Kim, H., Claﬀy, K., Fomenkov, M., Barman, D., Faloutsos, M., Lee, K.-Y.: Internet
traﬃc classiﬁcation demystiﬁed: Myths, caveats, and the best practices. In: ACM
CoNEXT (2008)
21. Labovitz, C., Lekel-Johnson, S., McPherson, D., Oberheide, J., Jahanian, F.: Inter-
net inter-domain traﬃc. In: ACM SIGCOMM (2010)
22. Lee, C., Lee, D.K., Moon, S.: Unmasking the growing UDP traﬃc in a campus
network. In: Taft, N., Ricciato, F. (eds.) PAM 2012. LNCS, vol. 7192, pp. 1–10.
Springer, Heidelberg (2012)
23. Maier, G., Feldmann, A., Paxson, V., Allman, M.: On dominant characteristics of
residential broadband internet traﬃc. In: ACM IMC (2009)
24. Moore, A.W., Papagiannaki, K.: Toward the accurate identiﬁcation of network
applications. In: Dovrolis, C. (ed.) PAM 2005. LNCS, vol. 3431, pp. 41–54.
Springer, Heidelberg (2005)
25. Nguyen, T.T.T., Armitage, G.: A survey of techniques for internet traﬃc classiﬁ-
cation using machine learning. IEEE Commun. Surv. Tutor. 10(4), 56–76 (2008)
26. Popa, L., Ghodsi, A., Stoica, I.: HTTP as the narrow waist of the future Internet.
In: ACM HotNets (2010)
27. Richter, P., Smaragdakis, G., Feldmann, A., Chatzis, N., Boettger, J., Willinger,
W.: Peering at peerings: On the role of IXP route servers. In: ACM IMC (2014)
28. InMon–sFlow. http://sﬂow.org/
29. Valenti, D., Rossi, D., Dainotti, A., Pescap`e, A., Finamore, A., Mellia, M.: Review-
ing traﬃc classiﬁcation. In: TMA (2013)
30. Wang, L., Kangasharju, J.: Real-world sybil attacks in BitTorrent mainline DHT.
In: IEEE GLOBECOM (2012)