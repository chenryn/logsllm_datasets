Mac OS X Server
System Image
Administration
For Version 10.3 or Later
034-2348_Cvr  9/12/03  10:21 AM  Page 1
 Apple Computer, Inc.
© 2003 Apple Computer, Inc. All rights reserved. 
The owner or authorized user of a valid copy of 
Mac OS X Server software may reproduce this 
publication for the purpose of learning to use such 
software. No part of this publication may be reproduced 
or transmitted for commercial purposes, such as selling 
copies of this publication or for providing paid-for 
support services.
Use of the “keyboard” Apple logo (Option-Shift-K) for 
commercial purposes without the prior written consent 
of Apple may constitute trademark infringement and 
unfair competition in violation of federal and state laws. 
Apple, the Apple logo, AirPort, AppleShare, iBook, iMac, 
Mac, Macintosh, Mac OS, PowerBook, Power Mac, and 
Xserve are trademarks of Apple Computer, Inc., 
registered in the U.S. and other countries.
034-2348/09-20-03
LL2348.Book  Page 2  Thursday, August 21, 2003  10:58 AM
3
1
Contents
Chapter 1
7
About System Image Administration
7
NetBoot and Network Install
8
Inside NetBoot
8
Disk Images
8
NetBoot Share Points
9
Client Information File
9
Shadow Files
10
NetBoot Image Folders
11
Property List File
13
Boot Server Discovery Protocol (BSDP)
13
BootP Server
13
TFTP and the Boot Files
13
Using Images Stored on Other Servers
13
Security
14
Before You Set Up NetBoot
14
What You Need to Know
14
Client Computer Requirements
15
Network Hardware Requirements
15
Network Service Requirements
16
Capacity Planning
17
Setup Overview
Chapter 2
19
Creating Boot and Install Images
19
Creating Mac OS X Boot Images
19
Creating a Mac OS X Boot Image
21
Installing the Classic Environment on a Mac OS X Disk Image
21
Configuring Directory Access for a Boot Image
22
Adding an OS Update Package to a Mac OS X Boot Image
22
Creating a Mac OS X Boot Image From an Existing System
23
Synchronizing an Image With an Updated Source Volume
23
Choosing the Protocol Used to Deliver an Image
24
Compressing Images to Save Disk Space
24
Changing How Mac OS X NetBoot Clients Allocate Shadow Files
LL2348.Book  Page 3  Thursday, August 21, 2003  10:58 AM
4
Contents
25
Creating Mac OS 9 Boot Images
25
Installing a Mac OS 9 Boot Image
25
Modifying a Mac OS 9 Boot Image
27
Setting Up Multiple Mac OS 9 Images
27
Unlocking an Image
28
Creating Install Images
28
Creating an OS Install Image
29
Adding Software to Boot and Install Images
29
About Packages
30
Creating Packages
30
Adding Packages to a Boot or Install Image
30
Creating an Application-Only Install Image
31
Automating Installation of an Image
32
Viewing the Contents of a Package
32
Installing Mac OS Updates
Chapter 3
33
Setting Up NetBoot Service
33
Setting Up NetBoot
33
Configuring NetBoot Service
34
Starting NetBoot and Related Services
34
Enabling Images
35
Choosing Where Images Are Stored
35
Choosing Where Shadow Files Are Stored
36
Using Images Stored on Other NFS Servers
36
Moving Images to Headless Servers
37
Specifying the Default Image
37
Setting an Image for Diskless Booting
38
Restricting NetBoot Clients by Filtering Addresses
38
Changing Advanced NetBoot Options
Chapter 4
39
Setting Up Clients
39
Supporting Client Computers
39
Updating the Startup Disk Control Panel
39
Setting Up Diskless Clients
40
Selecting a NetBoot Boot Image (Mac OS X)
40
Selecting a NetBoot Boot Image (Mac OS 9)
41
Selecting a NetBoot Install Image (Mac OS X)
41
Selecting a NetBoot Install Image (Mac OS 9)
42
Starting Up Using the N Key
Chapter 5
43
Managing NetBoot Service
43
Controlling and Monitoring NetBoot
43
Turning Off NetBoot Service
LL2348.Book  Page 4  Thursday, August 21, 2003  10:58 AM
Contents
5
44
Disabling Individual Boot or Install Images
44
Viewing a List of NetBoot Clients
44
Checking the Status of NetBoot and Related Services
44
Viewing the NetBoot Service Log
45
Performance and Load Balancing
45
Boot Images
45
Distributing Boot Images Across Servers
46
Distributing Boot Images Across Server Disk Drives
46
Balancing Boot Image Access
47
Distributing Shadow Files
48
Advanced NetBoot Tuning
Chapter 6
49
Solving Problems
49
General Tips
49
A NetBoot Client Computer Won’t Start Up
50
You’re Using Macintosh Manager and a User Can’t Log In to a NetBoot Client
50
The Create Button in Network Image Utility Is Not Enabled
50
Controls and Fields in Network Image Utility are Disabled
50
I Can’t Set an Image to Use Static Booting (NetBoot version 1.0)
Glossary
51
Index
53
LL2348.Book  Page 5  Thursday, August 21, 2003  10:58 AM
LL2348.Book  Page 6  Thursday, August 21, 2003  10:58 AM
1
7
1
About System Image 
Administration
This chapter describes how to start up client computers 
using an operating system stored on a server and install 
software on client computers over the network.
NetBoot and Network Install
The NetBoot and Network Install features of Mac OS X Server offer you alternatives for 
managing the operating system and application software your Macintosh clients (or 
even other servers) need to start up and do their work. Instead of going from computer 
to computer to install OS and application software from CDs, you can prepare an OS 
install image that is automatically installed on each computer when it starts up. Or, you 
can choose not to install software on the clients at all but, instead, have them start up 
(or “boot”) directly from an image stored on the server. Clients don’t even need their 
own disk drives.
Using NetBoot and Network Install, you can have your client computers start up from a 
standardized Mac OS configuration suited to their specific tasks. Because the client 
computers start up from the same image, you can quickly update the operating system 
for the entire group by updating a single boot image.
A boot image is a file that looks and acts like a mountable disk or volume. NetBoot 
boot images contain the system software needed to act as a startup disk for client 
computers on the network. An install image is a special boot image that boots the 
client long enough to install software from the image, after which the client can boot 
from its own hard drive. Both boot images and install images are special kinds of disk 
images. Disk images are files that behave just like disk volumes.
You can set up multiple boot or install images to suit the needs of different groups of 
clients or to provide several copies of the same image to distribute the client startup 
load. 
You can use NetBoot in conjunction with Mac OS X client management services to 
provide a personalized work environment for each client computer user. For 
information about client management services, see the user management guide.
LL2348.Book  Page 7  Thursday, August 21, 2003  10:58 AM
8
Chapter 1
    About System Image Administration
You can use the following Mac OS X Server applications to set up and manage NetBoot 
and Network Install:
•
Network Image Utility—
to create Mac OS X disk images. Installed with Mac OS X 
Server software in the /Applications/Server folder.
•
Server Admin—
to enable and configure NetBoot service and supporting services. 
Installed with Mac OS X Server software in the /Applications/Server folder.
•
PackageMaker—
to create package files that you use to add additional software to 
disk images. On the 
Administration Tools
 CD in the Utilities folder.
•
Property List Editor—to edit property lists such as NBImageInfo.plist. On the 
Administration Tools
 CD in the Utilities folder.
•
NetBoot Desktop Admin—
an optional application for modifying Mac OS 9 system disk 
images and accompanying disk image for applications.
If you still have Mac OS 9 clients, you’ll need a copy of the 
NetBoot for Mac OS 9
 CD 
(available separately). The CD includes a preconfigured Mac OS 9.2.2 system disk image 
and the NetBoot Desktop Admin application.
Inside NetBoot
This section describes how NetBoot is implemented on Mac OS X Server, including 
information on the protocols, files, directory structures, and configuration details.
Disk Images
The read-only disk images contain the system software and applications used over the 
network by the client computers. The name of a disk image file typically ends in “.img” 
or “.dmg.” Disk Utility—a utility included with Mac OS X and Mac OS 9.2.2—can mount 
disk image files as volumes on the desktop.
You set up Mac OS 9 and Mac OS X disk images in slightly different ways.
You use Network Image Utility to create Mac OS X disk images, using a Mac OS X install 
disc or an existing system volume as the source. See “Creating a Mac OS X Boot Image” 
on page 19.
A preconfigured Mac OS 9 disk image is provided for you on a CD named 
NetBoot for 
Mac OS 9
, which is available separately. The CD contains localized versions of the 
Mac OS 9 image in several languages. See “Installing a Mac OS 9 Boot Image” on 
page 25. You can modify the Mac OS 9 disk image using NetBoot Desktop Admin. See 
“Modifying a Mac OS 9 Boot Image” on page 25. 
NetBoot Share Points
NetBoot sets up share points to make images and shadow files available to clients.
LL2348.Book  Page 8  Thursday, August 21, 2003  10:58 AM
Chapter 1    About System Image Administration
9
NetBoot creates share points for storing boot and install images in /Library/NetBoot on 
each volume you enable and names them NetBootSPn, where n is 0 for the first share 
point and increases by 1 for each additional share point. If, for example, you decide to 
store images on three separate server disks, NetBoot will set up three share points 
named NetBootSP0, NetBootSP1, and NetBootSP2.
The share points for client shadow files are also created in /Library/NetBoot and are 
named NetBootClientsn.
You can create and enable additional NetBootSPn and NetBootClientsn share points on 
other server volumes using the NetBoot service General settings in Server Admin.
Client Information File
NetBoot gathers information about a client the first time the client tries to 
start up from the NetBoot server. NetBoot stores this information in the file 
/var/db/bsdpd_clients.
Shadow Files
Many clients can read from the same boot image, but when a client needs to write 
anything back to its startup volume (such as print jobs and other temporary files), 
NetBoot automatically redirects the written data to the client’s shadow files, which are 
separate from regular system and application software.
The shadow files preserve the unique identity of each client during the entire time it is 
running off a NetBoot image. NetBoot transparently maintains changed user data in 