attacks) to enable an AS-level adversary to effectively
compromise user anonymity.
Our experimental results show that Raptor attacks
present a serious threat to the security of anonymity sys-
tems. Our key results include (1) demonstration of asym-
metric trafﬁc correlation on the live Tor network, which
achieves 95% accuracy with no observed false positives,
(2) quantifying the impact of routing asymmetry and
routing churn on AS-level attacks – an increase of 50% to
100% respectively compared to conventional attacks, (3)
uncovering historical BGP hijacks involving Tor relays,
and (4) successful demonstration of a trafﬁc analysis at-
tack via BGP interception on the live Tor network. We
also outlined a taxonomy of countermeasures against our
attacks.
Our work highlights the dangers of abstracting net-
work routing from the analysis of anonymity systems
such as Tor, and motivates the design of next generation
anonymity systems that resist Raptor.
10 Acknowledgments
Thanks to Ethan Katz-Bassett for support on setting up
Transit Portal provided by the PEERING project. Thanks
to ATLAS project for donating credits for our experimen-
tal setup. Thanks to Matthew Wright, Nick Feamster,
Nikita Borisov and Roger Dingledine for helpful discus-
sions. This work was supported by the NSF under the
grant CNS-1423139.
References
[1] BGP
proﬁt.
13
hijacking
cryptocurrency
http://www.secureworks.com/
for
USENIX Association  
24th USENIX Security Symposium  283
cyber-threat-intelligence/threats/
bgp-hijacking-for-cryptocurrency-profit/.
[2] Bgpmon:
Hijack by AS4761 Indosat
- a
http://www.bgpmon.net/
quick
hijack-by-as4761-indosat-a-quick-report/.
report.
[3] BGPMon:
Hijack Event Today
In-
http://www.bgpmon.net/
by
dosat.
hijack-event-today-by-indosat/.
[4] CollecTor: Your friendly data-collecting service
https://collector.
in the Tor network.
torproject.org/.
[5] RIPE Atlas. https://atlas.ripe.net/.
[6] RIPE RIS Raw Data. https://www.ripe.net/
data-tools/stats/ris/ris-raw-data.
[7] Routeviews. http://www.routeviews.org/.
[8] Tor metrics portal. https://metrics.torproject.org.
Accessed, February 2015.
[9] Who uses Tor? https://www.torproject.org/
about/torusers.html.en. Accessed, February
2015.
[10] How the NSA attacks Tor/Firefox
with QUANTUM and FOXACID.
//www.schneier.com/blog/archives/2013/
10/how_the_nsa_att.html, Oct. 2013.
users
https:
[11] Peeling back the layers of Tor with Egotis-
http://www.theguardian.
ticalGiraffe.
com/world/interactive/2013/oct/04/
egotistical-giraffe-nsa-tor-document,
Oct. 2013.
[12] Tor
stinks.
http://www.theguardian.
com/world/interactive/2013/oct/04/
tor-stinks-nsa-presentation-document,
Oct. 2013.
[13] AKHOONDI, M., YU, C., AND MADHYASTHA,
H. V. Lastor: A low-latency AS-aware Tor client.
In Proceedings of the 2012 IEEE Symposium on Se-
curity and Privacy (Washington, DC, USA, 2012),
SP ’12, IEEE Computer Society, pp. 476–490.
[14] ARNBAK, A., AND GOLDBERG, S. Loopholes for
circumventing the constitution: Warrantless bulk
surveillance on americans by collecting network
trafﬁc abroad.
In HotPETs (2014). Available at
http://ssrn.com/abstract=2460462.
[15] BALL, J. NSA stores metadata of millions of web
users for up to a year, secret ﬁles show. http://
www.theguardian.com/world/2013/sep/30/
nsa-americans-metadata-year-documents,
Sep. 2013.
[16] BALLANI, H., FRANCIS, P., AND ZHANG, X. A
study of preﬁx hijacking and interception in the In-
ternet. In Proceedings of the 2007 Conference on
Applications, Technologies, Architectures, and Pro-
tocols for Computer Communications (New York,
NY, USA, 2007), SIGCOMM ’07, ACM, pp. 265–
276.
[17] BOLDYREVA, A., AND LYCHEV, R. Provable se-
curity of S-BGP and other path vector protocols:
Model, analysis and extensions. In Proceedings of
the 2012 ACM Conference on Computer and Com-
munications Security (New York, NY, USA, 2012),
CCS ’12, ACM, pp. 541–552.
[18] BRANDOM,
R.
bomb
FBI
threats
tracked
harvard
Tor.
http://www.theverge.com/2013/12/18/5224130/fbi-
agents-tracked-harvard-bomb-threats-across-tor.
Accessed, July 2014.
agents
despite
[19] CHAN, H., DASH, D., PERRIG, A., AND ZHANG,
H. Modeling adoptability of secure BGP proto-
col.
In Proceedings of the 2006 Conference on
Applications, Technologies, Architectures, and Pro-
tocols for Computer Communications (New York,
NY, USA, 2006), SIGCOMM ’06, ACM, pp. 279–
290.
[20] CHUN CHENG, P., ZHAO, X., ZHANG, B., AND
ZHANG, L. Longitudinal Study of BGP Monitor
Session Failures. ACM SIGCOMM Computer Com-
munication Review (CCR) (April 2010).
[21] CLARKE, I., SANDBERG, O., WILEY, B., AND
HONG, T. W. Freenet: A distributed anonymous
information storage and retrieval system.
In In-
ternational Workshop on Designing Privacy En-
hancing Technologies: Design Issues in Anonymity
and Unobservability (New York, NY, USA, 2001),
Springer-Verlag New York, Inc., pp. 46–66.
[22] DANEZIS, G. Mix-networks with restricted routes.
In Privacy Enhancing Technologies, R. Dingledine,
Ed., vol. 2760 of Lecture Notes in Computer Sci-
ence. Springer Berlin Heidelberg, 2003, pp. 1–17.
[23] DANEZIS, G., DINGLEDINE, R., AND MATHEW-
SON, N. Mixminion: Design of a type iii anony-
mous remailer protocol. In Proceedings of the 2003
284  24th USENIX Security Symposium 
USENIX Association
14
IEEE Symposium on Security and Privacy (Wash-
ington, DC, USA, 2003), SP ’03, IEEE Computer
Society, pp. 2–.
[24] DINGLEDINE, R., HOPPER, N., KADIANAKIS,
G., AND MATHEWSON, N. One fast guard for life
(or 9 months). In HotPETs (2014).
[25] DINGLEDINE, R., MATHEWSON, N., AND
SYVERSON, P. Tor: The second-generation onion
router. In Proceedings of the 13th Conference on
USENIX Security Symposium - Volume 13 (Berke-
ley, CA, USA, 2004), SSYM’04, USENIX Associ-
ation.
[26] EDMAN, M., AND SYVERSON, P. AS-awareness
in Tor path selection.
In Proceedings of the 16th
ACM Conference on Computer and Communica-
tions Security (New York, NY, USA, 2009), CCS
’09, ACM, pp. 380–389.
[27] EVANS, N. S., DINGLEDINE, R.,
AND
GROTHOFF, C. A practical congestion attack
on Tor using long paths.
In Proceedings of the
18th Conference on USENIX Security Symposium
(Berkeley, CA, USA, 2009), SSYM’09, USENIX
Association, pp. 33–50.
[28] FEAMSTER, N., AND DINGLEDINE, R. Location
diversity in anonymity networks. In Proceedings of
the 2004 ACM Workshop on Privacy in the Elec-
tronic Society (New York, NY, USA, 2004), WPES
’04, ACM, pp. 66–76.
[29] GILL, P., SCHAPIRA, M., AND GOLDBERG, S.
Let the market drive deployment: A strategy for
transitioning to BGP security.
In Proceedings of
the ACM SIGCOMM 2011 Conference (New York,
NY, USA, 2011), SIGCOMM ’11, ACM, pp. 14–
25.
[30] HOPPER, N., VASSERMAN, E. Y., AND CHAN-
TIN, E. How much anonymity does network la-
tency leak? In Proceedings of the 14th ACM Con-
ference on Computer and Communications Secu-
rity (New York, NY, USA, 2007), CCS ’07, ACM,
pp. 82–91.
[31] HOPPER, N., VASSERMAN, E. Y., AND CHAN-
TIN, E. How much anonymity does network la-
tency leak? ACM Trans. Inf. Syst. Secur. 13, 2 (Mar.
2010), 13:1–13:28.
[32] HU, Y.-C., PERRIG, A., AND SIRBU, M. Spv:
Secure path vector routing for securing BGP.
In
Proceedings of the 2004 Conference on Applica-
tions, Technologies, Architectures, and Protocols
for Computer Communications (New York, NY,
USA, 2004), SIGCOMM ’04, ACM, pp. 179–192.
[33] JANSEN, R., TSCHORSCH, F., JOHNSON, A.,
The sniper attack:
AND SCHEUERMANN, B.
Anonymously deanonymizing and disabling the
Tor network.
In Proceedings of the 21st Annual
Network and Distributed System Security Sympo-
sium (NDSS ’14) (2014), Internet Society.
[34] JOHNSON, A., WACEK, C., JANSEN, R., SHERR,
M., AND SYVERSON, P. Users get routed: Traf-
ﬁc correlation on Tor by realistic adversaries.
In
Proceedings of the 2013 ACM SIGSAC Conference
on Computer and Communications Security (New
York, NY, USA, 2013), CCS ’13, ACM, pp. 337–
348.
[35] JUEN, J. Protecting anonymity in the presence of
autonomous system and Internet exchange level ad-
versaries, 2012. MS Thesis, University of Illinois
at Urbana-Champaign.
[36] MACASKILL,
E.,
to world’s
BORGER,
J.,
AND BALL,
HOP-
KINS, N., DAVIES, N.,
J.
GCHQ taps ﬁbre-optic cables for secret ac-
cess
http:
//www.theguardian.com/uk/2013/jun/21/
gchq-cables-secret-world-communications-nsa,
June 2013.
communications.
[37] MITTAL, P., KHURSHID, A., JUEN, J., CAESAR,
M., AND BORISOV, N. Stealthy trafﬁc analysis
of low-latency anonymous communication using
throughput ﬁngerprinting.
In Proceedings of the
18th ACM Conference on Computer and Communi-
cations Security (New York, NY, USA, 2011), CCS
’11, ACM, pp. 215–226.
[38] M ¨OLLER, U., COTTRELL, L., PALFRADER, P.,
AND SASSAMAN, L. Mixmaster Protocol — Ver-
sion 2. IETF Internet Draft, July 2003.
[39] MURDOCH, S. J., AND DANEZIS, G. Low-cost
trafﬁc analysis of Tor. In Proceedings of the 2005
IEEE Symposium on Security and Privacy (Wash-
ington, DC, USA, 2005), SP ’05, IEEE Computer
Society, pp. 183–195.
[40] MURDOCH, S. J., AND ZIELI ´NSKI, P.
Sam-
pled trafﬁc analysis by Internet-exchange-level ad-
versaries.
the 7th Interna-
tional Conference on Privacy Enhancing Technolo-
gies (Berlin, Heidelberg, 2007), PET’07, Springer-
Verlag, pp. 167–183.
In Proceedings of
USENIX Association  
24th USENIX Security Symposium  285
15
[41] OORSCHOT, P. V., WAN, T., AND KRANAKIS, E.
On interdomain routing security and pretty secure
BGP (psBGP). ACM Trans. Inf. Syst. Secur. 10, 3
(July 2007).
[50] ZEILEMAKER, N., AND POUWELSE, J. Open
source column: Tribler: P2P search, share and
stream. SIGMultimedia Rec. 4, 1 (Mar. 2012), 20–
24.
[42] OVERLIER, L., AND SYVERSON, P. Locating hid-
In Security and Privacy, 2006 IEEE
den servers.
Symposium on (May 2006), pp. 100–114.
[43] SCHLINKER, B., ZARIFIS, K., CUNHA, I., FEAM-
STER, N., AND KATZ-BASSETT, E. PEERING:
An AS for us.
In Proceedings of the 13th ACM
Workshop on Hot Topics in Networks (New York,
NY, USA, 2014), HotNets-XIII, ACM, pp. 18:1–
18:7.
[44] SHI, X., XIANG, Y., WANG, Z., YIN, X., AND
WU, J. Detecting preﬁx hijackings in the Internet
with Argus. In Proceedings of the 2012 ACM Con-
ference on Internet Measurement Conference (New
York, NY, USA, 2012), IMC ’12, ACM, pp. 15–28.
[45] SHMATIKOV, V., AND WANG, M.-H. Timing anal-
ysis in low-latency mix networks: Attacks and de-
fenses. In Proceedings of the 11th European Con-
ference on Research in Computer Security (Berlin,
Heidelberg, 2006), ESORICS’06, Springer-Verlag,
pp. 18–33.
[46] SYVERSON, P., TSUDIK, G., REED, M., AND
LANDWEHR, C. Towards an analysis of onion rout-
ing security. In International Workshop on Design-
ing Privacy Enhancing Technologies: Design Is-
sues in Anonymity and Unobservability (New York,
NY, USA, 2001), Springer-Verlag New York, Inc.,
pp. 96–114.
[47] TIMPANARO, J. P., CHRISMENT, I., AND FES-
TOR, O. A bird’s eye view on the I2P anonymous
ﬁle-sharing environment.
In Proceedings of the
6th International Conference on Network and Sys-
tem Security (Berlin, Heidelberg, 2012), NSS’12,
Springer-Verlag, pp. 135–148.
[48] VANBEVER, L., LI, O., REXFORD, J., AND MIT-
TAL, P. Anonymity on quicksand: Using BGP to
compromise Tor. In Proceedings of the 13th ACM
Workshop on Hot Topics in Networks (New York,
NY, USA, 2014), HotNets-XIII, ACM, pp. 14:1–
14:7.
[49] WRIGHT, M., ADLER, M., LEVINE, B. N., AND
SHIELDS, C. Defending anonymous communica-
tions against passive logging attacks. In Proceed-
ings of the 2003 IEEE Symposium on Security and
Privacy (Washington, DC, USA, 2003), SP ’03,
IEEE Computer Society.
[51] ZHANG, Z., ZHANG, Y., HU, Y. C., AND MAO,
Z. M. Practical defenses against BGP preﬁx hi-
jacking. In Proceedings of the 2007 ACM CoNEXT
Conference (New York, NY, USA, 2007), CoNEXT
’07, ACM.
[52] ZHANG, Z., ZHANG, Y., HU, Y. C., MAO, Z. M.,
AND BUSH, R. iSPY: Detecting IP preﬁx hijacking
on my own. IEEE/ACM Trans. Netw. 18, 6 (Dec.
2010), 1815–1828.
[53] ZHENG, C., JI, L., PEI, D., WANG, J., AND
FRANCIS, P. A light-weight distributed scheme
for detecting IP preﬁx hijacks in real-time.
In
Proceedings of the 2007 Conference on Applica-
tions, Technologies, Architectures, and Protocols
for Computer Communications (New York, NY,
USA, 2007), SIGCOMM ’07, ACM, pp. 277–288.
[54] ZHU, Y., FU, X., GRAHAM, B., BETTATI, R.,
AND ZHAO, W. On ﬂow correlation attacks and
countermeasures in mix networks. In Proceedings
of the 4th International Conference on Privacy En-
hancing Technologies (Berlin, Heidelberg, 2005),
PET’04, Springer-Verlag, pp. 207–225.
A Appendix: Rejected Countermeasures
Obfuscating packet timings and sizes: While the use
of high latency mix networks [38, 23] and constant
rate cover trafﬁc [22] can mitigate timing analysis even
against an adversary that observes all communications,
these defenses are considered too costly to be deployed
in the Tor network.
Mitigating asymmetric attacks: Recall that our asym-
metric correlation attack leverages information in the
TCP header, namely the sequence number ﬁeld that in-
dicates the number of acknowledged bytes. One poten-
tial countermeasure would be to encrypt the TCP header,
by leveraging IP-layer encryption techniques such as IP-
Sec. However, this approach introduces several chal-
lenges. First, it would require a substantial engineer-
ing effort to migrate Tor towards IPSEC. Second, since
IPSEC is not widely used, this would make Tor trafﬁc
easy to distinguish from other encrypted trafﬁc, thwart-
ing its use for applications such as censorship resistance.
Finally, encrypting the TCP header may not complete
solve the attack. For example, an adversary could at-
tempt to correlate TCP data packets with simply the
number of TCP ACK packets, disregarding the sequence
number ﬁeld.
286  24th USENIX Security Symposium 
USENIX Association
16