from AS12741 if and only if the corresponding AS-path is
originated by AS12741. However, in this case, it accept-
ed a route originated by AS47728, and the anomalous triple
h21021, 12741, 47728i was detected by Argus. When the traf-
ﬁc was hijacked by this route, Argus reported this case.
23(a)),
Export policy violation: PA 2 was caused by an ex-
port ﬁlter failure of AS31484. According to the IRR record-
s of AS31484, it has two providers, AS20764 and AS3267.
The route ﬁlter in the IRR, as shown in Fig. 23(b), mean-
s AS31484 will accept ANY route announced by the two
providers, but will only announce routes originated from
18Actually Argus reported route migrations, as expected.
AS31484 or AS196931 (its customer) to them. In this case,
AS31484 incorrectly announced routes learned from its provider
AS3267 to the other provider AS20764, so Argus detected
the anomalous triple h20764, 31484, 3267i. Later, it success-
fully identiﬁed the hijacking.
6.4 Non-hijacking Anomalies
As we have mentioned before, Argus can also classify non-
hijacking anomalies into diﬀerent types, including route mi-
gration, traﬃc engineering, etc., as shown in Fig. 8. We an-
alyze three cases to demonstrate this capability. Fig. 22 ex-
plains how they are diﬀerent from hijackings, where for each
case, we plot the corresponding ﬁngerprint Ft, the reachabil-
ity Dt to the anomalous preﬁx, and the number of polluted
eyes.
TE using BGP anycast: Root DNS servers usually use
In
BGP anycast to balance and optimize DNS requests.
this case, the anomalous preﬁx 193.0.16.0/24 was used by
the root DNS server k, and was operated by RIPE NCC.
Argus detected that this preﬁx was suddenly announced by
a new origin AS197000. Since all its eyes, either polluted
or not, could reach the target preﬁx (i.e., Dt = 1), while
the ﬁngerprint Ft was close to 0, it was identiﬁed as traﬃc
engineering. Fig. 22(a) shows the corresponding Ft and Dt.
TE with backup links: In this case, AS12476 announced
an AS-path with ASPP to AS6453, which was its provider
but had never appeared as the its neighbor before. The new
path exposed this backup link accidentally. Similarly to the
ﬁrst case, Ft was always 0 while Dt was always 1, as shown
in Fig. 22(b).
Route migration: AS12653 and AS7700 were operated
by the same ISP (KB Impuls Hellas, Greece). During the
route migration, AS12653 stopped announcing routes, while
AS7700 started to take the place. In the route convergence
process, almost all eyes that had learned the new routes
could reach the target preﬁx, while eyes using the old routes
could not. This led to a negative Ft (i.e., less than -0.6), as
is in Fig. 22(c).
7. DISCUSSION
To show the advantages of Argus, we compare it with some
representative hijacking detection systems proposed earlier.
A control plane based system such as Cyclops [12] will re-
port the 20K OA anomalies, while Argus can identify 122
stable hijackings out of them. This can lower the burden to
handle hijackings by two orders of magnitude. Data plane
methods [34, 36] have to continuously measure the Inter-
net for each preﬁx they care, while Argus only probe the
Internet for two minutes when an anomaly appears. The
measurement overhead in one year can be roughly comput-
ed as (40K anomalies) × (2 minutes) × (80 eyes) for Argus,
and as (400K preﬁxes) × (1 year) × (1 eye) for the system
in [36], resulting in a diﬀerence of four orders of magnitude.
The overhead of iSPY [34] is less since it only monitors the
preﬁxes owned by the organization who deploys the system,
but if the entire Internet is to be protected, the overhead
will be comparable to that in [36]. Moreover, these data
plane methods cannot detect sub-preﬁx hijackings (around
10% in our data), unless every possible sub-preﬁx is moni-
tored. They also cannot distinguish BGP anycast and route
migration from hijackings since they are based on data path
changes. The method utilizing both data and control plane
information [16] relies on host-speciﬁc ﬁngerprints, such as
26t
n
i
r
p
r
e
g
n
i
f
y
t
i
l
i
b
a
h
c
a
e
r
1.2
0.6
0.0
-0.6
-1.2
  reachability
  fingerprint
  polluted  eyes
0
20
40
time 
60
( seconds)
80
(a) BGP anycast
20
10
0
120
100
s
e
y
e
d
e
t
u
l
l
o
p
t
n
i
r
p
r
e
g
n
i
f
y
t
i
l
i
b
a
h
c
a
e
r
1.2
0.6
0.0
-0.6
-1.2
  reachability
  fingerprint
  polluted  eyes
0
20
40
time 
60
( seconds)
80
(b) Backup link
20
10
0
120
100
s
e
y
e
d
e
t
u
l
l
o
p
t
n
i
r
p
r
e
g
n
i
f
y
t
i
l
i
b
a
h
c
a
e
r
1.2
0.6
0.0
-0.6
-1.2
  reachability
  polluted  eyes
  fingerprint
0
20
40
time 
60
( seconds)
80
20
10
0
120
100
s
e
y
e
d
e
t
u
l
l
o
p
(c) Route migration
Figure 22: Case studies of non-hijacking anomalies: ﬁngerprint, reachability and the number of polluted eyes.
OS property, IP ID, timestamp, etc., thus may also fail when
BGP anycast or route migration happens. Besides, its de-
tection delay is at least a few minutes while Argus needs
only a few seconds.
Argus also has some limitations. It relies on ping to de-
tect blackholing behavior, so malicious attackers can evade
the system by actively responding to ping. However, we
believe our earlier measurement results are still reasonable,
and we will integrate other ﬁngerprinting methods into Ar-
gus. A carefully crafted AS-path based on existing path seg-
ments may also evade our detection although building such
a path is very diﬃcult, and advanced detection and protec-
tion methods are still needed. Another weakness may lie in
our metric Ft, which can be speciﬁcally attacked by carefully
choosing the time/preﬁx to hijack, and how to devise more
robust hijacking ﬁngerprints is worth further study. Many
components of Argus can be continuously improved, e.g., by
adding eyes in diﬀerent ASes, and refreshing live hosts [1].
Finally, much more can be done on the classiﬁcation of route
anomalies, and the characterization of realworld hijackings.
8. CONCLUSIONS
In this paper, we present Argus, a system for detecting IP
preﬁx hijackings. Compared with existing methods, Argus
has many advantages, and our one year practice in monitor-
ing the Internet shows it can accurately distinguish preﬁx
hijackings from a vast number of anomalies in a very short
time, and can further deduce the possible root causes. It is
very easy to deploy, and we are now providing it as a public
service, which has already successfully helped many network
operators to diagnose their network operations. In the fu-
ture, we plan to incorporate more diagnosis information and
make it more intelligent.
9. ACKNOWLEDGEMENT
We are grateful to the anonymous IMC reviewers and
our shepherd Mark Crovella for their insightful comments.
We also want to express our gratitude towards the net-
work operators we have contacted for their generous coop-
eration and feedback. This work is supported by the Na-
tional Key Technology R&D Program of China (Grant No.
2008BAH37B03), and the National Basic Research Program
of China (973 Program, Grant No. 2009CB320502).
10. REFERENCES
[1] Ant censuses of the internet address space.
http://www.isi.edu/ant/traces/index.html.
[2] Archipelago Measurement Infrastructure.
http://www.caida.org/projects/ark/.
[3] The BGPmon project.
http://bgpmon.netsec.colostate.edu.
[4] BGPmon.net. http://bgpmon.net/.
[5] Charter of the IETF Secure Inter-Domain Routing
Working Group.
http://tools.ietf.org/wg/sidr/charters.
[6] DNS records collected by Hurricane Electric.
http://bgp.he.net/net/166.111.0.0/16#_dns.
[7] Irr - internet routing registry. http://www.irr.net/.
[8] Ripe myasn system.
http://www.ris.ripe.net/myasn.html.
[9] H. Ballani, P. Francis, and X. Zhang. A study of preﬁx
hijacking and interception in the internet. In
SIGCOMM, 2007.
[10] S. M. Bellovin, R. Bush, and D. Ward. Security
requirements for bgp path validation. http://tools.
ietf.org/html/draft-ymbk-bgpsec-reqs-02, 2011.
[11] M. Caesar, L. Subramanian, and R. H. Katz. Towards
root cause analysis of internet routing dynamics. In
Berkeley EECS Annual Research Symposium, 2004.
[12] Y.-J. Chi, R. Oliveira, and L. Zhang. Cyclops: The
AS-level connectivity observatory. ACM SIGCOMM
Computer Communication Review, pages 7–16, 2008.
[13] N. Feamster, D. G. Andersen, H. Balakrishnan, and
M. F. Kaashoek. Measuring the eﬀects of internet path
faults on reactive routing. In SIGMETRICS, 2003.
[14] A. Feldmann, O. Maennel, Z. M. Mao, A. W. Berger,
and B. M. Maggs. Locating internet routing
instabilities. In SIGCOMM, 2004.
[15] S. Goldberg, M. Schapira, P. Hummon, and
J. Rexford. How secure are secure interdomain routing
protocols? In SIGCOMM, 2010.
[16] X. Hu and Z. M. Mao. Accurate real-time
identiﬁcation of ip preﬁx hijacking. In IEEE
Symposium on Security and Privacy, pages 3–17, 2007.
[17] G. Huston and G. Michaelson. RFC 6483: Validation
of Route Origination Using the Resource Certiﬁcate
Public Key Infrastructure (PKI) and Route Origin
Authorizations (ROAs).
http://tools.ietf.org/html/rfc6483, 2012.
[18] J. Karlin, S. Forrest, and J. Rexford. Pretty good
BGP: Improving BGP by cautiously adopting routes.
In ICNP, pages 290–299, 2006.
[19] E. Katz-Bassett. Announcement of university of
washington routing study. http://mailman.nanog.
org/pipermail/nanog/2011-August/039337.html.
[20] E. Katz-Bassett, H. V. Madhyastha, J. P. John,
A. Krishnamurthy, D. Wetherall, and T. E. Anderson.
Studying black holes in the internet with hubble. In
NSDI, 2008.
[21] S. Kent, C. Lynn, J. Mikkelson, and K. Seo. Secure
border gateway protocol (S-BGP). IEEE Journal on
Selected Areas in Communications, 18:103–116, 2000.
27 
#
(
)
#
#
(
)
#
#
(
)
#
[22] M. Lad, D. Massey, D. Pei, Y. Wu, B. Zhang, and
L. Zhang. PHAS: A preﬁx hijack alert system. In
USENIX, 2006.
[23] H. Madhyastha, T. Isdal, M. Piatek, C. Dixon,
T. Anderson, and A. Krishnamurthy. iPlane: An
information plane for distributed services. In OSDI,
pages 367–380, 2006.
[30] L. Subramanian, V. Roth, I. Stoica, S. Shenker, and
R. H. Katz. Listen and whisper: Security mechanisms
for BGP. In NSDI, pages 127–140, 2004.
[31] F. Wang, Z. M. Mao, J. Wang, L. Gao, and R. Bush.
A measurement study on the impact of routing events
on end-to-end internet path performance. In
SIGCOMM, 2006.
[24] R. Mahajan, D. Wetherall, and T. Anderson.
[32] Y. Xiang, Z. Wang, X. Yin, and J. Wu. Argus: An
Understanding bgp misconﬁguration. In SIGCOMM,
pages 3–16, 2002.
[25] S. Murphy. Rfc 4272: Bgp security vulnerabilities
analysis. http://tools.ietf.org/html/rfc4272,
2006.
[26] R. Oliveira, B. Zhang, D. Pei, R. Izhak-Ratzin, and
L. Zhang. Quantifying path exploration in the
Internet. In Proc. of the 6th ACM SIGCOMM
Internet Measurement Conference (IMC), Rio de
Janeriro, Brazil, 2006.
[27] Y. Rekhter, T. Li, and S. Hares. RFC 4271: Border
gateway protocol 4.
http://tools.ietf.org/html/rfc4271, 2006.
accurate and agile system to detecting ip preﬁx
hijacking. In Workshop on Trust and Security in the
Future Internet, 2011.
[33] B. Zhang, R. Liu, D. Massey, and L. Zhang. Collecting
the internet as-level topology. SIGCOMM Comput.
Commun. Rev., 35(1):53–61, 2005.
[34] Z. Zhang, Y. Zhang, Y. C. Hu, Z. M. Mao, and
R. Bush. iSPY: Detecting ip preﬁx hijacking on my
own. In SIGCOMM, pages 327–338, 2008.
[35] X. Zhao, D. Pei, L. Wang, D. Massey, A. Mankin,
S. F. Wu, and L. Zhang. An analysis of BGP multiple
origin as (MOAS) conﬂicts. In 1st ACM SIGCOMM
Workshop on Internet Measurement, 2001.
[28] Renesys. China’s 18-minute mystery.
[36] C. Zheng, L. Ji, D. Pei, J. Wang, and P. Francis. A
http://www.renesys.com/blog/2010/11/
chinas-18-minute-mystery.shtml, 2010.
[29] RIPE. Youtube hijacking: A ripe ncc ris case study.
http://www.ripe.net/news/
study-youtube-hijacking.html, 2008.
light-weight distributed scheme for detecting ip preﬁx
hijacks in real-time. In SIGCOMM, pages 324–334,
2007.
28