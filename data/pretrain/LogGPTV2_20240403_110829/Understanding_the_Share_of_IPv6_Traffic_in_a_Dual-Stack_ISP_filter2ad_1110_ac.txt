5
0
5
10
15
c
i
f
f
a
r
t
6
v
P
100
80
60
40
20
0
I
f
o
%
.
x
a
m
All subscribers are IPv6 active
Current subscriber connectivity
0
100
101
102
103
104
Service time difference in ms
# FQDNs that enable IPv6
Fig. 3. ECDF: Diﬀerences between
IPv6 and IPv4 TCP handshake and
DNS resolution times per host name.
Positive values indicate longer transac-
tions for IPv6 and AAAA RRs.
Fig. 4. Estimation of the maximum
possible share of IPv6 traﬃc when
IPv4-only FQDNs enable IPv6. We sort
FQDNs by their contribution in terms
of bytes.
for 62.5% of this traﬃc. Thus, there is a strong intent for IPv6 traﬃc that
cannot yet be satisﬁed by the service side. In fact, our measurement likely even
underestimates this value because we do not take into account negatively-cached
AAAA RRs (see Sect. 3.2).
Happy eyeballs. Given that part of the traﬃc carried over IPv4, which could
be carried over IPv6, can be attributed to (un-)happy eyeballs, we now study two
metrics concerning dual-stack applications and devices, i.e., the RTT estimates
and the DNS resolution times (see [47]). Our RTT estimate corresponds to the
backbone RTTs (Sect. refsec:dataset). For the DNS resolution time (A vs. AAAA),
we only consider transactions with non-empty responses and for which we ﬁnd
just one request and one response in the same UDP ﬂow. We aggregate these
per host name and compute the median only for those host names with at least
10 samples. Generally, dual-stack services oﬀer similar conditions, i.e., around
80% of the values are within a range of 10 ms. Under such conditions, happy-
eyeball implementations likely select IPv6, as indicated by our earlier results.
This observation is important for service providers transitioning to IPv6, as it
implies that after enabling IPv6 they can expect a signiﬁcant increase of IPv6
traﬃc if they already exchange high volumes of data with dual-stack consumer
networks. We note that the ﬁnal choice of connectivity is subject to how diﬀerent
implementations adapt to network conditions [6,26,27].
5.4 Case Studies
We next describe two case studies: a large search provider and a large CDN.
Our case studies illustrate two opposite facets of the transition to IPv6. These
providers contribute together to 35.7% of the overall and 73.1% of the IPv6
traﬃc. They both operate various Autonomous Systems (ASNs) as well as caches
inside ISPs. To identify their traﬃc, we rely on the origin ASN as derived from
the IP addresses in the ﬂows. To identify traﬃc from caches, we obtain a list
of the Fully Qualiﬁed Domain Names (FQDNs) associated with IP addresses
managed by these ASNs.
Understanding the Share of IPv6 Traﬃc in a Dual-Stack ISP
13
A large search provider. Our ﬁrst case study is a service provider that actively
supports and promotes IPv6. 37.6% of its traﬃc is IPv6, and it alone contributes
69.9% of all IPv6 traﬃc in the trace. After annotating 91.8% of the traﬃc with
FQDNs, we corroborate that almost all content –not all traﬃc relates to search
services– requested by users at this vantage point is available over IPv6 (98.7%).
IPv4-only and IPv6-inactive subscribers generate 74.1% of the IPv4 traﬃc while
the share of IPv6 traﬃc for the IPv6-active subscribers is 70.5%. This observation
suggests that for this provider the connectivity of the subscribers is the main
obstacle for the increase in IPv6 traﬃc.
A large CDN. We are able to annotate 84.7% of the CDN traﬃc with FQDNs.
Only 2.5% of the traﬃc is carried over IPv6, and only 3.3% of the CDN traﬃc
relates to IPv6-ready services. This implies that here the bottleneck for IPv6 is
the server side, since only 2.1% of the content requested with a AAAA is actually
exchanged over IPv6.
Transition to IPv6. Service providers willing to transition to IPv6 need to
update the corresponding DNS RRs. To illustrate the potential impact of this
process on the share of IPv6 traﬃc, we next concentrate on IPv4-only services.
We present in Fig. 4 an upper bound for the share of IPv6 traﬃc when the top
traﬃc-contributing FQDNs enable IPv6. We produce two estimates. The ﬁrst one
assumes that there are no changes in the subscribers connectivity. The second
one assumes that all subscribers become IPv6-active. Note, we do not take into
consideration 24.2% of the bytes in the trace as we cannot associate them with
a service. Enabling IPv6 connectivity for all subscribers immediately doubles
the upper bound for the IPv6 traﬃc share (almost 40%). However, to reach
IPv6 traﬃc shares close to 90%, more than 10 K FQDNs need to enable IPv6
connectivity. That said, and as shown earlier in this paper, IPv4-only devices
and happy-eyeballs fallbacks to IPv4 can reduce this share.
6 Discussion
We are well-aware that our vantage point is not representative of the Internet
as a whole. While this particular ISP promotes IPv6 connectivity, others opt to
deploy Carrier Grade NATs to combat IPv4 address scarcity. Yet, we argue that
our observations most likely apply to other dual-stack ISPs as well (e.g., [25]).
Hence, these observations can aid ISPs and service providers by providing guid-
ance on how to provision for IPv6 as well as insights on traﬃc dynamics during
the transition phase. For example, IPv4-only service providers could exchange
up to 30% of their traﬃc over IPv6 if they enable IPv6. By contrast, although
53% of the IPv4 traﬃc to IPv6-ready services involves subscribers whose CPEs
most likely do not provide IPv6 connectivity to their home network, happy eye-
balls usually chooses IPv6 over IPv4 (85%). We posit that IPv6 traﬃc shares
will likely be subject to sudden increments when CPE devices enable IPv6 sup-
port in the home network. Virtual CPEs [15] could make it easier for operators
to transition their subscribers to IPv6 and troubleshoot IPv6-related problems.
14
E. Pujol et al.
Hence, avenues for future work include a closer investigation of issues speciﬁc to
devices and applications as well as a characterization of happy-eyeballs fallbacks
to IPv4.
7 Conclusion
The Internet’s transition to IPv6 is a tremendous operational eﬀort. The research
community supports this eﬀort by providing measurements of IPv6 adoption
across the Internet. In this work, we push the envelope further and study a
lesser-known aspect: IPv6 usage. We reveal obstacles hampering IPv6 traﬃc
in dual-stack ISPs, including CPE devices not supporting IPv6, applications
falling back to IPv4, and a broad lack of IPv6 support among service providers.
In spite of such obstacles, we report a pronounced increase, intent, and potential
for growth regarding IPv6. We expect that increasing IPv6 traﬃc shares will
eventually make IPv6 the ﬁrst-class citizen of the Internet.
Acknowledgments. This work was partially supported by Leibniz Prize project
funds of DFG - German Research Foundation (FKZ FE 570/4-1).
References
1. Current implementation of AI ADDRCONFIG considered harmful. https://goo.
gl/prXWfz
2. Amsterdam Internet Exchange IPv6 Traﬃc (2016). https://goo.gl/ajS6PC
3. ARIN IPv6 Wiki: Broadband CPE (2016). https://goo.gl/Wydr3Q
4. IPv6 - Google (2016). https://goo.gl/Tl4cUZ
5. World IPv6 Launch (2016). https://goo.gl/hOoXNo
6. Aben, E.: Hampering Eyeballs - Observations on Two “Happy Eyeballs” Imple-
mentations. https://goo.gl/qUW6s
7. Aben, E., Trenaman, N., Kiessling, A., Wilhelm, R.: Lost Starts - Why Operators
Switch oﬀ IPv6 (2016). NANOG 66
8. Aboba, B., Zorn, G., Mitton, D.: RADIUS and IPv6. RFC 3162 (2001)
9. Alcock, S., Lorier, P., Nelson, R.: Libtrace: a packet capture and analysis library.
ACM CCR 42(2), 42–48 (2012)
10. Andrews, M.: Negative Caching of DNS Queries (DNS NCACHE). RFC 2308
(1998)
11. Bajpai, V., Sch¨onw¨alder, J.: IPv4 versus IPv6 - Who connects faster? In: IFIP
Networking (2015)
12. Bermudez, I.N., Mellia, M., Munaf`o, M., Keralapura, R., Nucci, A.: DNS to the
rescue: discerning content and services in a tangled web. In: ACM IMC (2012)
13. Beverly, R., Luckie, M., Mosley, L., Claﬀy, K.: Measuring and characterizing IPv6
router availability. In: Mirkovic, J., Liu, Y. (eds.) PAM 2015. LNCS, vol. 8995, pp.
123–135. Springer, Heidelberg (2015). doi:10.1007/978-3-319-15509-8 10
14. Callahan, T., Allman, M., Rabinovich, M.: On modern DNS behavior and proper-
ties. ACM CCR 43(3), 7–13 (2013)
15. Cant´o, R., L´opez, R.A., Folgueira, J.L., L´opez, D.R., Elizondo, A.J., Gamero, R.:
Virtualization of residential customer premise equipment. Lessons learned in Brazil
vCPE trial. Inf. Technol. 57(5), 285–294 (2015)
Understanding the Share of IPv6 Traﬃc in a Dual-Stack ISP
15
16. Cho, K., Luckie, M., Huﬀaker, B.: Identifying IPv6 network problems in the dual-
stack world. In: ACM SIGCOMM Network Troubleshooting Workshop (2004)
17. Claﬀy, K.: Tracking IPv6 evolution: data we have and data we need. ACM CCR
41(3), 43–48 (2011)
18. Colitti, L., Gunderson, S.H., Kline, E., Reﬁce, T.: Evaluating IPv6 adoption in the
internet. In: Krishnamurthy, A., Plattner, B. (eds.) PAM 2010. LNCS, vol. 6032,
pp. 141–150. Springer, Heidelberg (2010). doi:10.1007/978-3-642-12334-4 15
19. Czyz, J., Allman, M., Zhang, J., Iekel-Johnson, S., Osterweil, E., Bailey, M.: Mea-
suring IPv6 adoption. In: ACM SIGCOMM (2014)
20. Dec, W., Sarikaya, B., Zorn, G., Miles, D., Lourdelet, B.: RADIUS Attributes for
IPv6 Access Networks. RFC 6911 (2013)
21. Dhamdhere, A., Luckie, M., Huﬀaker, B., Claﬀy, K., Elmokashﬁ, A., Aben, E.:
Measuring the deployment of IPv6: topology. Routing and performance. In: ACM
IMC (2012)
22. Drake, K.: You have IPv6. Turn it on (2016). https://goo.gl/maSZRM
23. Giotsas, V., Luckie, M., Huﬀaker, B., Claﬀy, K.: IPv6 AS Relationships, Clique,
and Congruence. In: PAM (2015)
24. Gysi, M.: Residential IPv6 at Swisscom, an Overview (2012). https://goo.gl/
QO2SZF
25. Gysi, M.: Status of Swisscom’s IPv6 activities, outlook and opportunities. In: Swiss
IPv6 Council IPv6 Business Conference (2016)
26. Huston, G.: Bemused Eyeballs (2012). https://labs.apnic.net/?p=188
27. Huston, G.: Revisiting Apple and IPv6 (2015). https://goo.gl/qjKdv5
28. Karir, M., Huston, G., Michaelson, G., Bailey, M.: Understanding IPv6 populations
in the wild. In: Roughan, M., Chang, R. (eds.) PAM 2013. LNCS, vol. 7799, pp.
256–259. Springer, Heidelberg (2013). doi:10.1007/978-3-642-36516-4 27
29. Karpilovsky, E., Gerber, A., Pei, D., Rexford, J., Shaikh, A.: Quantifying the extent
of IPv6 deployment. In: Moon, S.B., Teixeira, R., Uhlig, S. (eds.) PAM 2009. LNCS,
vol. 5448, pp. 13–22. Springer, Heidelberg (2009). doi:10.1007/978-3-642-00975-4 2
30. Lagerholm, S., Roselli, J.: Negative caching of DNS records. Technical report,
Microsoft (2015)
31. Livadariu, I., Elmokashﬁ, A., Dhamdhere, A.: Characterizing IPv6 control and
data plane stability. In: IEEE INFOCOM (2016)
32. Luckie, M., Beverly, R., Brinkmeyer, W., Claﬀy,K.: Speedtrap: internet-scale IPv6
alias resolution. In: ACM IMC (2013)
33. Maier, G., Feldmann, A., Paxson, V., Allman, M.: On dominant characteristics of
residential broadband internet traﬃc. In: ACM IMC (2009)
34. McConachie, A.: How To Make Your Website Available Over IPv6 (2014). https://
goo.gl/Vs2IuO
35. Mori, T., Inoue, T., Shimoda, A., Sato, K., Ishibashi, K., Goto, S.: SFMap: inferring
services over encrypted web ﬂows using dynamical domain name graphs. In: TMA
(2015)
36. Morishita, Y., Jinmei, T.: Common Misbehavior Against DNS Queries for IPv6
Addresses. RFC 4074 (2005)
37. Nikkhah, M., Gu´erin, R.: Migrating the Internet to IPv6: An Exploration of the
When and Why. IEEE ToN (2015)
38. Nikkhah, M., Gu´erin, R., Lee, Y., Woundy, R.: Assessing IPv6 through web access
a measurement study and its ﬁndings. In: ACM CoNEXT (2011)
39. Plonka, D., Barford, P.: Context-aware clustering of DNS query traﬃc. In: ACM
IMC (2008)
16
E. Pujol et al.
40. Plonka, D., Barford, P.: Assessing performance of internet services on IPv6. In:
IEEE ISSC (2013)
41. Richter, P., Allman, M., Bush, R., Paxson, V.: A primer on IPv4 scarcity. ACM
CCR 45(2), 21–31 (2015)
42. Richter, P., Chatzis, N., Smaragdakis, G., Feldmann, A., Willinger, W.: Distilling
the internet’s application mix from packet-sampled traﬃc. In: PAM (2015)
43. Richter, P., Wohlfart, F., Vallina-Rodriguez, N., Allman, M., Bush, R., Feldmann,
A., Kreibich, C., Weaver, N., Paxson, V.: A multi-perspective analysis of carrier-
grade NAT deployment. In: ACM IMC (2016)
44. Rigney, C., Willens, S., Rubens, A., Simpson, W.: Remote Authentication Dial In
User Service (RADIUS). RFC 2865 (2000)
45. Salowey, J., Droms, R.: RADIUS Delegated-IPv6-Preﬁx Attribute. RFC 4818
(2007)
46. Sarrar, N., Maier, G., Ager, B., Sommer, R., Uhlig, S.: Investigating IPv6 traﬃc.
In: Taft, N., Ricciato, F. (eds.) PAM 2012. LNCS, vol. 7192, pp. 11–20. Springer,
Heidelberg (2012). doi:10.1007/978-3-642-28537-0 2
47. Schinazi, D.: Apple and IPv6 - Happy Eyeballs (2015). https://goo.gl/XBP9g4
48. Singh, H., Beebee, W., Donley, C., Stark, B.: Basic Requirements for IPv6 Cus-
tomer Edge Routers. RFC 7084 (2013)
49. Thaler, D., Draves, R., Matsumoto, A., Chown, T.: Default Address Selection for
Internet Protocol Version 6 (IPv6). RFC 6724 (2012)
50. Tikan, T.: IPv6 Deployment in Estonia (2015). https://goo.gl/vTQUpH
51. Wing, D., Yourtchenko, A., Eyeballs, H.: Success with Dual-Stack Hosts. RFC 6555
(2012)