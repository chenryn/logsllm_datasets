不管是本地模式还是云端模式，可做中间人攻击来截获打印内容。这里我是用手机转代理到电脑上，拦截了数据包。发现传输的时间和传输的内容都以base64方式进行编码，并未进行复杂的加密。
左图是app中的预览效果。右图是网站中解码的效果，图片还原注意加上头
### 如何控制打印机
**批量控制打印机**
漏洞成因：
1.AK泄露导致越权：在官方公开的API调用实例当中，泄露一可用AK。原本进行API打印需要根据流程申请AK，有效ＡＫ泄露导致任何人都可以在未申请的情况下，成为了开发者，拥有网上打印权限.。
下图是官方API给的打印所需构造的URL及其中包含的参数：
这里解释一下各个参数的含义：
memobirdID是设备编号，双击咕咕机时会自动打印出来
useridEntifying在官方开发群中说的是为咕咕号，是在APP中“我的”中查看到的6位编号
userid是根据APP里面注册之后，就会分配一个固定的userid。因为有些用户注册了，但是没有买设备，所以会造成一些userid并没有对应的设备编号，也会存在一个userid对应多个设备编号的情况。
所以：AK（形同虚设）+时间（形同虚设）+memobirdID + useridEntifying àuserid
2.服务器校验机制不完善：官方在要求绑定的时候，输入的useridEntifying需为咕咕号，文档中却说用户自定义。在官方公开的API源码（官方放在GitHub了：）当中分析却是，useridentifying未做任何处理，相当于架空该参数，在有设备编号的情况下直接返回userid
所以：AK（形同虚设）+ 时间（形同虚设）+memobirdID → userid
因为：memobirdID(16字节)+userid（1-6字节不等）→ 打印
memobirdID → userid
考虑：爆破memobirdID → 得到userid
memobirdID + userid → 打印，但memobirdID太长，爆破困难，并且猜测userid可能是递增，可能是统计用户量的值。
尝试：memobirdID ← userid
爆破userid → 得到 memobirdID
memobirdID + userid → 打印
3.加解密方式泄露：
在APP网页版中，点击打印
我们抓到了一个与userid有关，能返回smartguid（ 值=memobirdID ）的包
但是不管是发送还是响应，都是密文。我们要是想爆破简短的userid，就需要懂得他的加密方式，发送我们爆破，加密后的userid，他才会返回给我们smartguid。
这时我们之前扫到的那个config就有用了。这里面是加密算法
或者在APP中也可发现蛛丝马迹
加解密分析：
因为：GetSmartCoreByUserID，返回了加密的Smartguid
猜测：parameter应该是加密的userid。
验证：抓到的包中标黄的目录文件是之前泄露的源码，这里面有request发出前的加解密方式，大意是利用时间戳和私钥进行DES加解密，而且时间戳只精确到秒的十位，个位不参与。在github上找到一个别人写的py脚本
解密验证了猜想。
所以：userid → 加密的Smartguid
尝试：加密的Smartguid → 明文Smartguid
因为：userid（明）→ ← userid（密）
猜测： Smartguid （明）→ ← Smartguid （密）
尝试：用与userid相同的解密方式，解密Smartguid，发现失败。而且respond的时间戳和加密不是一个系统时段上的，估计算法可能也不一样了 。
4.打印所需参数可逆推
在点击查看已绑定的咕咕机的详情的时候
抓到这样一个能返回smartguid的明文的包！就是我们期待已久的：加密的Smartguid à明文Smartguid
这是两个危害比较严重的逆推：
明文和密文可以逆推
userid和smartguid逆推
这样导致所需打印参数通过爆破全部能获取
漏洞利用：根据导师写的脚本（附在github里），可在网络中爬到众多打印机，进而控制他们
**钓鱼控制打印机**
安卓API 8以上，备份设置默认开启。在开发者未经处理的情况下，会导致用户名和密码直接被备份。当备份到其他设备上时，该设备可直接登录被备份人的身份。
当前主流APP认识到此设置风险，纷纷将备份数据设置为需要重新登录才可以恢复。但众多小众APP并未意识到，导致隐私严重泄露
漏洞利用：
利用思路：在网上找到了一个脚本可以在电脑上批量检测手机中开了allowbackup的APP并批量备份。
预计一部手机中三分之一以上的APP可能会被波及。导致此手机中大量账号及其他敏感信息泄露。
尝试：我们学校的APP存在此配置问题，会导致学生身份证，学号等泄露。亦可以尝试一些租房APP，可能会有更多泄露。下图是咕咕机APP中备份文件中暴露的用户名和密码。
**蓝牙控制打印机**
此漏洞涉及型号为GT1，为纯蓝牙通信模式。以下研究全部属于我导师：
研究目标
上面有对二代的打印机进行分析，发现旗下还有一款三代用蓝牙控制的打印机，与二代不通的是三代是无法进行远程打印的，只能通过手机的蓝牙和打印机链接，打印机无法自己链接服务器，但是可以通过云端接口将打印的数据传给手机，然后手机与打印机进行蓝牙链接之后打印机自动打印纸条，我们下篇会对对这款打印机进行安全分析。