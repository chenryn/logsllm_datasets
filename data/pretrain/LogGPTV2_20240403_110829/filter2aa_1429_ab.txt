{'1276,1464': '%windir%\\system32\\net1.exe'},
{'536,1276': '%windir%\\system32\\net.exe'},
{'536,360': '%temp\\frame2_276.exe'},
{'536,492': '%temp\\liar3.exe'},
{'840,536': 'c:\\documents and settings\\user\\win.exe'}]}
===== DEBUG INFORMATION - GOAT MACHINE CHANGES =====
2008/05/21 16:52:19 - [UTCD-INFO] Target: http://www.interclass.dir.bg/
2008/05/21 16:52:19 - [UTCD-INFO] Priority Level: 5
2008/05/21 16:52:19 - [UTCD-INFO] UMS's URL ID: 365
2008/05/21 16:52:19 - [UTCD-INFO] Remaining Failure Retry: 3
2008/05/21 16:52:20 - [UTCD-INFO] URL Type: Web browser interpretable URL
2008/05/21 16:52:20 - [UTCD-INFO] Content Length: 1,540 bytes
2008/05/21 16:52:20 - [UTCD-INFO] Content-Type: text/html
2008/05/21 16:52:20 - [UTCD-INFO] Server Date: Wed, 21 May 2008 08:52:19 GMT
2008/05/21 16:52:20 - [UTCD-INFO] Server Type: Zeus/4.3
2008/05/21 16:52:20 - [UTCD-INFO] Last Modified: Tue, 20 May 2008 09:17:55 GMT
2008/05/21 16:52:20 - [GOAT-INFO] WXPSP2-1: Windows XP Pro SP2 + Firefox 1.0 and IE 6.0
2008/05/21 16:52:20 - [GOAT-INFO] IE6.0/IE7.0 = Enabled, Firefox1.0/2.0 = Enabled
2008/05/21 16:52:20 - [GOAT-INFO] Network IO Check Interval = 5secs
Analysis report of drive-by download website
Sunday, 10 August, 2008 Page 14
2008/05/21 16:52:20 - [GOAT-INFO] Network IO Check Interval = 5secs
2008/05/21 16:52:20 - [GOAT-INFO] Network IO Activity Tolerance = 512bytes
2008/05/21 16:52:20 - [UTCD-INFO] Sending URL to UAE for automated analysis...
2008/05/21 16:52:20 - [UTCD-INFO] Analyzing website in VMware goat environment...
2008/05/21 16:52:50 - [UTCD-INFO] Time elapsed 0 minutes and 30 seconds
2008/05/21 16:52:50 - [UTCD-INFO] Goat Process ID: 1648
2008/05/21 16:52:50 - [UTCD-INFO] IE 6.0/7.0 Process ID: 840
2008/05/21 16:52:50 - [UTCD-INFO] FireFox 1.0/2.0 Process ID: 1768
2008/05/21 16:52:50 - [UTCD-INFO] Pop-up Window(s) Found: 0
2008/05/21 16:52:50 - [UTCD-INFO] Analyzing tracer log... (766,680 bytes)
2008/05/21 16:52:50 - [UTCD-INFO] Time elapsed 0.0320420265198 second
2008/05/21 16:52:50 - [UTCD-INFO] Exploited web browser: Internet Explorer
2008/05/21 16:52:50 - [UTCD-INFO] Suspicious folder creation count: 0
2008/05/21 16:52:50 - [UTCD-INFO] Suspicious file creation count: 4
2008/05/21 16:52:50 - [UTCD-INFO] Suspicious registry key creation count: 1
2008/05/21 16:52:50 - [UTCD-INFO] Suspicious process creation count: 5
2008/05/21 16:52:50 - [UTCD-INFO] Threat percentage: 100%
2008/05/21 16:52:50 - [UTCD-INFO] Conclusion: Malicious
What is the malware most 
likely trying to do?
[CLUE]  net start…
Example 4: Website with drive-by download
Sunday, 10 August, 2008 Page 15
Analysis report drive-by download website
===== DEBUG INFORMATION - GOAT MACHINE CHANGES =====
{'createdir': [
{'dir': '%windir%\\fonts\\system'}],
'createfile': [
{'file': '%temp%\\_bnyunxing0.znb'},
{'file': '%temp%\\orz.exe'},
{'file': '%windir%\\system32\\atielf.dat'},
{'file': '%windir%\\system32\\gsdhadwd.sys'},
{'file': '%windir%\\system32\\mndhddwd.dll'},
{'file': '%windir%\\system32\\tpnc.bat'}],
'createkey': [
{'key': '%hklm%\\system\\currentcontrolset\\services\\atixeve2781'},
{'key': '%hklm%\\system\\currentcontrolset\\services\\security'}],
'newproc': [
{‘776,1375': '%temp\\orz.exe'},
{'1024,1744': '%temp\\orz.exe'},
{'1744,576': '%windir%\\system32\\svchost.exe'}]}
===== DEBUG INFORMATION - GOAT MACHINE CHANGES =====
2008/06/09 11:58:41 - [UTCD-INFO] Target: http://www.mx5e.com
2008/06/09 11:58:41 - [UTCD-INFO] Priority Level: 4
2008/06/09 11:58:41 - [UTCD-INFO] UMS's URL ID: 4096881
2008/06/09 11:58:41 - [UTCD-INFO] HTTP Request Metadata: null
2008/06/09 11:58:41 - [UTCD-INFO] Remaining Failure Retry: 3
2008/06/09 11:58:42 - [UTCD-INFO] URL Type: Web browser interpretable URL
2008/06/09 11:58:43 - [UTCD-INFO] Content Length: 157,608 bytes
2008/06/09 11:58:43 - [UTCD-INFO] Content-Type: text/html; charset=utf-8
2008/06/09 11:58:43 - [UTCD-INFO] Server Date: Mon, 09 Jun 2008 03:58:20 GMT
2008/06/09 11:58:43 - [UTCD-INFO] Server Type: Microsoft-IIS/6.0
2008/06/09 11:58:43 - [UTCD-INFO] X-Powered By: ASP.NET
2008/06/09 11:58:43 - [GOAT-INFO] WXPSP2-3: Windows XP Pro SP2 + Firefox 2.0.0.14 and IE 7.0
2008/06/09 11:58:43 - [GOAT-INFO] IE6.0/IE7.0 = Enabled, Firefox1.0/2.0 = Enabled
2008/06/09 11:58:43 - [GOAT-INFO] Network IO Check Interval = 5secs
Sunday, 10 August, 2008 Page 16
===== DEBUG INFORMATION - GOAT MACHINE CHANGES =====
2008/06/09 11:58:43 - [GOAT-INFO] Network IO Check Interval = 5secs
2008/06/09 11:58:43 - [GOAT-INFO] Network IO Activity Tolerance = 512bytes
2008/06/09 11:58:43 - [UTCD-INFO] Sending URL to UAE for automated analysis...
2008/06/09 11:58:43 - [UTCD-INFO] Analyzing website in VMware goat environment...
2008/06/09 12:00:05 - [UTCD-INFO] Time elapsed 1 minutes and 22 seconds
2008/06/09 12:00:06 - [UTCD-INFO] Goat Process ID: 1688
2008/06/09 12:00:06 - [UTCD-INFO] IE 6.0/7.0 Process ID: 776
2008/06/09 12:00:06 - [UTCD-INFO] FireFox 1.0/2.0 Process ID: 1024
2008/06/09 12:00:06 - [UTCD-INFO] Pop-up Window(s) Found: 0
2008/06/09 12:00:07 - [UTCD-INFO] Analyzing tracer log... (1,354,649 bytes)
2008/06/09 12:00:07 - [UTCD-INFO] Time elapsed 0.110128164291 second
2008/06/09 12:00:07 - [UTCD-INFO] Exploited web browser: IE and Firefox 
2008/06/09 12:00:07 - [UTCD-INFO] Suspicious folder creation count: 1
2008/06/09 12:00:07 - [UTCD-INFO] Suspicious file creation count: 6
2008/06/09 12:00:07 - [UTCD-INFO] Suspicious registry key creation count: 2
2008/06/09 12:00:07 - [UTCD-INFO] Suspicious process creation count: 2
2008/06/09 12:00:07 - [UTCD-INFO] Threat percentage: 100%
2008/06/09 12:00:07 - [UTCD-INFO] Conclusion: Malicious
Analysis was done in a VMware 
image with fully patched Windows 
XP Professional SP2 and latest 
version of web browsers
This website does not contain any 
zero-day exploit. So, how did our 
honey client get exploited?
…continued
Sunday, 10 August, 2008 Page 17
Two-factor authentication in a nutshell
Sunday, 10 August, 2008 Page 18
Source:
Images: http://en.wikipedia.org/wiki/Security_token
Article: http://www.finextra.com/fullstory.asp?id=15169
How does two-factor authentication works?
Sunday, 10 August, 2008 Page 19
Source: http://www.mocomsystems.com/Information/RSA.htm
Two-factor authentication ripped by phishers
Sunday, 10 August, 2008 Page 20
Bypassing the 2-factor authentication 1/3
1. Victim logins to the fake banking website using their username, password and one-time-use 
security token generated from security device provided by bank
2. The attacker uses the login information entered by victim at the fake banking website to 
login to the real banking website
3. To maintain access of the authenticated session, the attacker writes an automation script to 
let make his server reload the real website or randomly click on main links at the website
Sunday, 10 August, 2008 Page 21
Note:
The technique used in step 3 employs ‘local session riding’ at the attacker’s server to forge
request on behalf of the victim to the real banking site
Bypassing the 2-factor authentication 2/3
1. The attacker retrieves information from the real banking website and stores them to the 
simulated fake banking website database
Sunday, 10 August, 2008 Page 22
•
Account number
•
Account Owner Full Name
•
Account Balance
•
Last Login Date and Time
•
Transaction history
•
Other Details
Note:
The automation script written by the attacker will keep running at the simulated fake 
banking website to maintain the authenticated session with the real banking website
•
In online banking systems protected with 2-factor authentication, a security token is 
required from the user for each transaction to be performed
•
Whenever the victim enters a security token to perform transaction, the attacker 
uses the security token entered at the fake website to perform fund transfer from 
the victim’s banking account to their money mule’s account
Bypassing the 2-factor authentication 3/3
Sunday, 10 August, 2008 Page 23
Note:
The automation script written by the attacker will keep running at the simulated fake 
banking website to maintain the authenticated session with the real banking website
Transferring all money out from a banking 
account preset with daily transaction limit
•
Since the attacker’s automation script is running, the authenticated session can be
maintained from a few hours up to a few days depending the design of the web
application and frequency of server maintenance or reboot
•
If the victim’s banking account is preset with daily transaction limit, then the attacker might
perform several transactions repeatly in different days to steal all the money
Account Balance
: $100, 000
Daily Transfer Limit
: $  20, 000
Sunday, 10 August, 2008 Page 24
Daily Transfer Limit
: $  20, 000
Day 1 : - $20, 000
(Victim pays electricity bill)
- 1 security token
Day 1 : $0
(Victim logins to the account) 
- 1 security token
Day 2 : - $20, 000
(Victim logins to the account) 
- 1 security token
Day 2 : - $20, 000
(Victim performs fund transfer for business)  - 1 security token
Day 2 : - $20, 000
(Victim pays mobile phone bill)
- 1 security token
Day 3 : - $20, 000
(Victim login just to check balance)
- 1 security token
Account Balance
: $ 0
Daily Transfer Limit
: $ 20, 000
The ‘Local Session Riding’ (LSR) attack
Why such attack is possible?
•