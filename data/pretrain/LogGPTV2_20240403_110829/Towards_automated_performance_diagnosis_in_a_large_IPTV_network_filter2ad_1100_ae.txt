### Table 6: Trouble Ticket Characterization by Problem (Row) and Mitigation Actions (Column)
Each entry represents a percentage.

| Games | Total | 10.1 | 14 | 0 | 17 | 28 | 87 | 19.1 | 70 | 60.4 | 21.1 | 70 | 69 | 75 | 91 | 57 | 17.2 | 8.3 | 58 | 25 | 0.4 | 56.3 | 5.5 | 5.5 | 4.5 | 6 | 6 | 39 | 4.1 | 17 | 1.2 | 29 | 5.3 | 11.5 | 15.4 | 6.5 | 4 | 20 | 15.8 | 0.6 | 5.9 | 3.8 | 10.2 | 17.7 |
|-------|-------|------|----|---|----|----|----|------|----|------|------|----|----|----|----|----|------|-----|----|----|-----|------|-----|-----|-----|---|---|----|-----|----|-----|----|-----|------|------|-----|---|----|------|-----|-----|-----|-----|
|       |       |      |    |   |    |    |    |      |    |      |      |    |    |    |    |    |      |     |    |    |     |      |      |      |      |   |   |    |     |    |     |    |     |      |      |     |   |    |      |     |     |     |     |

### 4.3.2 Video Quality Alarms
In this subsection, we focus on symptom series from alarms generated by the video quality monitors deployed within the IPTV service provider network. These alarms indicate impairments in video quality due to issues such as excessive delay factor (DF), media loss rate (MLR), video stream outage, transport stream outage, IP flow bit rate thresholding crossing, transport stream synchronization errors, and transport stream bit rate thresholding crossing. The video quality monitors are deployed at Video Head-Ends (VHOs). Each VHO is responsible for a geographical region, which is the highest spatial level defined in Giza. We consider each type of alarm as a symptom event-series and correlate it with other event-series extracted from router syslogs at the VHO and the trouble tickets from customers associated with the VHO.

#### Correlation Results
We performed the correlation analysis using data collected over one month. The correlation time window was set to 60 seconds. When correlating alarm data with customer tickets, we used a time lag of four hours. We observed strong statistical correlations between video quality alarms and syslog events in the provider network, such as configuration changes, SAP port state changes, SDP bind status changes, BGP session downs, PPP/RSVP/SONET link downs, multicast neighbor loss, MPLS path re-routes, and layer-1 link flaps. However, most types of video quality alarms did not statistically correlate with customer trouble tickets. This is partly because the alarms from the monitoring device are too low-level; their purpose is to monitor the health of the video distribution network rather than customer-perceived performance. Short-term packet losses or delay jitters can be automatically repaired by Forward Error Correction (FEC) or retransmission of RUDP without interrupting the decoding of the video stream, thus having no impact on customers. By examining the significance of the correlation results, we can easily distinguish the alarms that would produce severe performance impairment of the video stream delivered to customers from those that would not. For example, alarms indicating long-term (24-hour) excessive media loss rates are likely due to persistent video feed problems and are correlated with customer complaints. We have also validated the discovered dependencies of video quality alarms on network events (extracted from router syslogs) with network operators. In the next section, we will further investigate the causal relationships among the network events.

### Table 7: Provider Network Syslog Correlation and Causality Results

| Number of Event-Series | Pairs to Correlate | Strong Pair-Wise Correlations | ℓ1 + Statistical Change Lag Correlation | ℓ1 + Max Lag Correlation |
|------------------------|--------------------|------------------------------|-----------------------------------------|--------------------------|
| 1318                   | 867,903            | 3352                         | 960                                     | 972                      |

### Layer-1 Alarms and VRRP Packet Discards
Layer-1 alarms, VRRP packet discards, link down, configuration changes, OSPF interface state down, multicast (PIM) neighbor loss, MPLS interface state changes, SAP port state changes, SDP bind status changes, and MPLS path re-routes were analyzed. VRRP (Virtual Router Redundancy Protocol) is used to increase network reliability by advertising a virtual router as a default gateway to hosts instead of a single physical router. Two or more physical routers are configured to act as a virtual router. When the primary physical router is down, the backup router takes over.

The strong statistical correlation between VRRP packet discards at VHO and SHO and multicast neighbor loss was due to packets looping within the network, causing the multicast protocol to timeout and resulting in neighbor loss. This behavior was more prevalent within the SHO and at VHOs closer to the SHO. Interestingly, when VRRP packet discards had a temporal correlation (or join) with multicast neighbor loss, we did not observe link downs. Thus, the packet looping does not appear to have been caused by link failures. We are currently collaborating with the operations team to analyze this scenario to further understand the behavior.

### Figure 12: Causal Graph Between Certain Network Syslog Event-Series
[Insert Figure 12 Here]

### 5. Related Work
In this section, we present related work.

### 4.4 Case Study: Provider Network Events
As discussed in Section 4.3.1, we observed statistical correlations between certain provider network syslog events (such as link downs, SAP/SDP state changes, multicast neighbor loss, and MPLS path re-routes) and different types of trouble tickets. In this section, we further investigate the statistical dependencies of these events on other provider network events.

The provider network syslog data contains a diverse set of events. Creating a separate time-series based on each unique message type results in the creation of hundreds of individual event-series from syslogs at every VHO or SHO. This provides us with a perfect opportunity to apply our statistical lag correlation and ℓ1 norm minimization algorithms to analyze how well they cope with the scale.

We used one week's worth of data to perform the causality analysis on 80 VHO and SHO routers within the provider network. We focused on four symptom event-series that demonstrated strong correlations with trouble tickets: (i) link down, (ii) SAP state changes, (iii) multicast neighbor loss, and (iv) MPLS path re-routes.

#### Correlation and Causality Discovery Results
Table 7 shows the correlation and causality discovery results for the provider network syslog data. There are a total of 1318 syslog event-series at several VHO and SHO locations. The total number of pairs to correlate is 867,903, out of which 3352 have strong correlation. For correlation, we performed the analysis for events that occur at the same VHO or SHO, achieving a reduction of 99.6% compared to the number of pairs for correlation. ℓ1 norm minimization along with lag correlation further reduces the number of pairs, achieving around 99.89% reduction.

A part of the causal graph reported by Giza is shown in Fig. 12. As can be seen in the figure, the root cause for link downs is layer-1 alarms. Link downs, in turn, cause SAP port state changes, OSPF interface state changes, SDP bind status changes, MPLS interface state changes, and multicast neighbor loss. These conclusions are consistent with domain knowledge and how the network technologies were designed to operate. The advantage of Giza is that it can discover the causal graph with minimal domain knowledge.

#### Findings
For the week analyzed, MPLS path re-routes had their major root cause as configuration changes. As expected, the strong statistical correlation was observed during the maintenance time-window, the period during which network operations personnel execute planned maintenance activities. Multicast neighbor losses demonstrated strong correlations with both link downs and configuration changes.

We also observed an interesting previously unknown dependency between multicast neighbor loss and VRRP packet discards. VRRP stands for Virtual Router Redundancy Protocol and is used for increased network reliability. It is achieved by advertising a virtual router as a default gateway to the hosts instead of one physical router. Two or more physical routers are configured to act as a virtual router. When the primary physical router is down, the backup router takes over.

### 5. RELATED WORK
In this section, we present related work.

#### IPTV, P2P, VoD Analysis
Cha et al. [6] present the first large-scale study of user behaviors in an IPTV system. They characterize user behaviors such as channel popularity and dynamics, viewing sessions, geographic locality, and channel surfing probabilities. Qiu et al. [24] develop a model that captures the dynamics of channel popularity in IPTV networks. There are many previous measurement studies on VoD [8, 19, 31], P2P IPTV [18, 25].

Our study, on the other hand, focuses on characterizing performance impairments and faults in a large-scale IPTV system. We believe this is the first characterization study aimed at understanding the performance issues in large-scale operational IPTV networks.

#### Hierarchical Heavy Hitter (HHH) Detection
There has been a great deal of work on finding heavy hitters at multiple aggregation points in network traffic data. The goal is to identify source-destination prefixes at multiple hierarchies that contribute to a large fraction of the total network traffic. Cormode et al. [12] were the first to extend the idea of heavy hitters to multiple dimensions. AutoFocus [16] presents several heuristics to detect interesting traffic clusters corresponding to anomalous traffic conditions. [13] presents online algorithms to identify approximate HHHs in one pass. [1, 32] propose algorithms to discover changes in hierarchical summaries.

The key difference of our significance test for detecting hierarchical heavy hitters is our ability to handle the diversity of distribution of spatial components across different aggregation levels.

#### Network Troubleshooting Using Statistical Analysis
Recently, there has been increasing interest in applying statistical analysis for network troubleshooting. The goal is to identify the set of root causes that can best explain a given symptom problem. SCORE [22] applies bipartite graphs to solve the fault diagnosis problem. Shrink [21] extends this model to deal with probabilistic settings. Sherlock [4] proposes a multi-level graph inference to learn the dependencies in enterprise networks. eXpose [20] learns communication rules in edge networks using spectral graph partitioning, useful in monitoring and intrusion detection. WISE [28] is a what-if analysis tool that estimates the effects of possible changes to network configuration on service response times.

Yemini et al. [30] present an event correlation library that describes faults and the symptoms of faults using a codebook. NetDiagnoser [14] performs fault localization using Boolean tomography. Orion [7] uses delay spike analysis to discover pair-wise dependencies in network traffic. NICE [23] focuses on troubleshooting undesirable chronic network conditions using Pearson’s correlations. NetPrints [2] uses decision-tree learning for troubleshooting home network misconfigurations. [27] is a white paper that discusses recent research efforts at Alcatel Lucent for designing end-to-end diagnosis capabilities in IPTV. Causal modeling is an area of active research, with rich literature in data mining and machine learning [3, 5, 9, 11, 17, 26].

### Table 8: Troubleshooting Infrastructure Taxonomy

| Property                  | Sherlock | Orion | Auto-correlation | Multi-variate Analysis | Multi-collinearity | Automated Edge Directionality | Multi-resolution Analysis |
|---------------------------|----------|-------|------------------|------------------------|--------------------|-------------------------------|---------------------------|
|                           | X        | X     | √                | X                      | X                  | X                             | X                         |
| NICE                      | X        | X     | √                | X                      | X                  | X                             | X                         |
| WISE                      | X        | X     | X                | √                      | X                  | X                             | X                         |
| Giza                      | √        | √     | √                | √                      | √                  | √                             | √                         |

We provide a qualitative comparison of several recently proposed troubleshooting infrastructures in Table 8. As you can see, Sherlock and Orion focus mainly on pair-wise correlation analysis and aim to automatically discover the directionality of the correlation. NICE addresses auto-correlation within each event-series and reduces false alarms when discovering the correlation graph. WISE is the first to apply multi-variate correlation techniques. However, WISE does not address auto-correlation and multi-collinearity when discovering causal dependencies, leading to lower accuracy as we show in Section 4. Giza addresses auto-correlation, goes beyond pair-wise analysis, handles the multi-collinearity problem when performing regression, discovers edge directionality automatically, and performs multi-resolution analysis.

### 6. Conclusions
In this paper, we presented the first characterization study of faults and performance impairments in the infrastructure of a large IPTV service provider in North America. Our analysis spanned routers in the backbone to set-top boxes (STBs) and residential gateways (RGs) in home networks, hardware and software crashes to video quality impairments. To deal with the scale and heterogeneity of the IPTV network, we proposed and designed a novel multi-resolution data analysis approach termed Giza, which enables fast detection and localization of problems. We also proposed novel techniques comprising statistical lag correlations and ℓ1 norm minimization for effective and scalable causal discovery. Our experience with applying Giza in the IPTV network has been very positive. The infrastructure promises to be of immense value to IPTV network operators in automatically detecting and troubleshooting important performance issues.

### Acknowledgements
We thank Aldo Adriazola, Seungjoon Lee, and Sigcomm anonymous reviewers for their feedback. We are also grateful to the network operations and customer support teams of the anonymous IPTV service provider for their kind help with data collection and case study analysis. This work was supported in part by NSF grants CNS-0546720, CNS-0615104, and CNS-0627020.

### 7. References
[1] D. Agarwal, D. Barman, D. Gunopulos, N. E. Young, F. Korn, and D. Srivastava. Efficient and Effective Explanation of Change in Hierarchical Summaries. In ACM KDD, 2007.
[2] B. Aggarwal, R. Bhagwan, V. N. Padmanabhan, and G. Voelker. NetPrints: Diagnosing Home Network Misconfigurations Using Shared Knowledge. In NSDI, 2009.
[3] A. Arnold, Y. Liu, and N. Abe. Temporal Causal Modeling with Graphical Granger Methods. In ACM KDD, pages 66–75, 2007.
[4] P. Bahl, R. Chandra, A. Greenberg, S. Kandula, D. A. Maltz, and M. Zhang. Towards Highly Reliable Enterprise Network Services via Inference of Multi-Level Dependencies. In Sigcomm, 2007.
[5] W. Buntine. Theory Refinement on Bayesian Networks. In Proc. Uncertainty in Artificial Intelligence, 1991.
[6] M. Cha, P. Rodriguez, J. Crowcroft, S. Moon, and X. Amatriain. Watching Television Over an IP Network. In ACM IMC, 2008.
[7] X. Chen, M. Zhang, Z. M. Mao, and P. Bahl. Automating Network Application Dependency Discovery: Experiences, Limitations, and New Solutions. In OSDI, 2008.
[8] B. Cheng, L. Stein, H. Jin, and Z. Zhang. Towards Cinematic Internet Video-on-Demand. In ACM EuroSys, 2008.
[9] P. R. Cohen, L. A. Ballesteros, D. E. Gregory, and R. S. Amant. Regression Can Build Predictive Causal Models. Technical Report UM-CS-1994-015, 1994.
[10] P. R. Cohen, D. E. Gregory, L. Ballesteros, and R. S. Amant. Two Algorithms for Inducing Structural Equation Models from Data. Technical Report UM-CS-1994-080, 1994.
[11] G. F. Cooper and E. Herskovits. A Bayesian Method for the Induction of Probabilistic Networks from Data. Machine Learning, 9(4):309–347, 1992.
[12] G. Cormode, F. Korn, S. Muthukrishnan, and D. Srivastava. Finding Hierarchical Heavy Hitters in Data Streams. In VLDB, 2003.
[13] G. Cormode, F. Korn, S. Muthukrishnan, and D. Srivastava. Diamond in the Rough: Finding Hierarchical Heavy Hitters in Multi-Dimensional Data. In ACM Sigmod, 2004.
[14] A. Dhamdhere, R. Teixeira, C. Dovrolis, and C. Diot. Netdiagnoser: Troubleshooting Network Unreachabilities Using End-to-End Probes and Routing Data. In CoNEXT, 2007.
[15] D.L. Donoho. For Most Large Underdetermined Systems of Equations, the Minimal l1-Norm Near Solution Approximates the Sparsest Near-Solution. In http://www-stat.stanford.edu/donoho/Reports/, 2004.
[16] C. Estan, S. Savage, and G. Varghese. Automatically Inferring Patterns of Resource Consumption in Network Traffic. In ACM Sigcomm, 2003.
[17] C. W. J. Granger. Investigating Causal Relations by Econometric Models and Cross-Spectral Methods. In Econometrica, 1969.
[18] X. Hei, C. Liang, J. Liang, Y. Liu, and K. W. Ross. A Measurement Study of a Large-Scale P2P IPTV System. IEEE Transaction on Multimedia, 2007.
[19] Y. Huang, T. Z. Fu, D.-M. Chiu, J. C. Lui, and C. Huang. Challenges, Design and Analysis of a Large-Scale P2P-VoD System. In ACM Sigcomm, 2008.
[20] S. Kandula, R. Chandra, and D. Katabi. What’s Going On? Learning Communication Rules in Edge Networks. In Sigcomm, 2008.
[21] S. Kandula, D. Katabi, and J.-P. Vasseur. Shrink: A Tool for Failure Diagnosis in IP Networks. In MineNet, 2005.
[22] R. R. Kompella, J. Yates, A. Greenberg, and A. C. Snoeren. Detection and Localization of Network Blackholes. In Infocom, 2007.
[23] A. Mahimkar, J. Yates, Y. Zhang, A. Shaikh, J. Wang, Z. Ge, and C. T. Ee. Troubleshooting Chronic Conditions in Large IP Networks. In ACM CoNEXT, 2008.
[24] T. Qiu, Z. Ge, S. Lee, J. Wang, J. Xu, and Q. Zhao. Modeling Channel Popularity Dynamics in a Large IPTV System. In ACM Sigmetrics, 2009.
[25] T. Silverston and O. Fourmaux. P2P IPTV Measurement: A Case Study of TVants. In ACM CoNEXT, 2006.
[26] P. Spirtes, C. N. Glymour, and R. Scheines. Causation, Prediction and Search. Lecture Notes in Statistics, 1993.
[27] K. Sridhar, G. Damm, and H. C. Cankaya. End-to-End Diagnostics in IPTV Architectures. Bell Lab. Tech. J., 2008.
[28] M. Tariq, A. Zeitoun, V. Valancius, N. Feamster, and M. Ammar. Answering What-If Deployment and Configuration Questions with WISE. In SIGCOMM, 2008.
[29] Wikipedia. Chebyshev Inequality. http://en.wikipedia.org/wiki/Chebyshev’s_inequality.
[30] S. A. Yemini, S. Kliger, E. Mozes, Y. Yemini, and D. Ohsie. High Speed and Robust Event Correlation. In IEEE Comm., 1996.
[31] H. Yu, D. Zheng, B. Y. Zhao, and W. Zheng. Understanding User Behavior in Large-Scale Video-on-Demand Systems. ACM Sigops Operating Systems Review, 2006.
[32] Y. Zhang, S. Singh, S. Sen, N. Duffield, and C. Lund. Online Identification of Hierarchical Heavy Hitters: Algorithms, Evaluation, and Applications. In ACM IMC, 2004.