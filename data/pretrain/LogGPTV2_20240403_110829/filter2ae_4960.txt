**Authorï¼šdawu@Knownsec 404 Team**  
**Date: May 4, 2018**  
**Chinese Version:[
https://paper.seebug.org/593/](https://paper.seebug.org/593/ "
https://paper.seebug.org/593/")**
#### 0x00 Preface
On April 30,2018, `vpnMentor` released the high-risk vulnerability of the
`GPON` router: Validation Bypass Vulnerability (CVE-2018-10561) and Command
Injection Vulnerability (CVE-2018-10562). With these two vulnerabilities, you
can simply execute a command on the `GPON Router` by sending a single request.
Based on the recurrence of this vulnerability, this paper analyzes the reason
for the existence of its related vulnerabilities.
#### 0x01 Vulnerability File Location
For the remote command execution vulnerability, using the `ps` command can
locate the vulnerability accurately.
It can be clearly seen that the process 14650 executed our command and found
the previous process `14649 root /bin/WebMgr -p 20 -s 0`. Because `pid` is
incremented, it is likely that the `/bin/WebMgr` file has a vulnerability.
#### 0x02 Vulnerability Analysis
After getting the `/bin/WebMgr` and `/lib/` files of a device, we start the
analysis.
##### 2.1 Before Analysis
Before the analysis, I've studied how the vunerability was exploited and the
web server was found to be `GoAhead-webs`.
According to the `Server` field, the version of the web server 
  2. `Seebug vulnerability platform` have recorded this vulnerability   
  3. Results from `ZoomEye cyberspace search engine`   
# About Knownsec & 404 Team
Beijing Knownsec Information Technology Co., Ltd. was established by a group
of high-profile international security experts. It has over a hundred frontier
security talents nationwide as the core security research team to provide
long-term internationally advanced network security solutions for the
government and enterprises.
Knownsec's specialties include network attack and defense integrated
technologies and product R&D under new situations. It provides visualization
solutions that meet the world-class security technology standards and enhances
the security monitoring, alarm and defense abilities of customer networks with
its industry-leading capabilities in cloud computing and big data processing.
The company's technical strength is strongly recognized by the State Ministry
of Public Security, the Central Government Procurement Center, the Ministry of
Industry and Information Technology (MIIT), China National Vulnerability
Database of Information Security (CNNVD), the Central Bank, the Hong Kong
Jockey Club, Microsoft, Zhejiang Satellite TV and other well-known clients.
404 Team, the core security team of Knownsec, is dedicated to the research of
security vulnerability and offensive and defensive technology in the fields of
Web, IoT, industrial control, blockchain, etc. 404 team has submitted
vulnerability research to many well-known vendors such as Microsoft, Apple,
Adobe, Tencent, Alibaba, Baidu, etc. And has received a high reputation in the
industry.
The most well-known sharing of Knownsec 404 Team includes: [KCon Hacking
Conference](http://kcon.knownsec.com/#/ "KCon Hacking Conference"), [Seebug
Vulnerability Database](https://www.seebug.org/ "Seebug Vulnerability
Database") and [ZoomEye Cyberspace Search Engine](https://www.zoomeye.org/
"ZoomEye Cyberspace Search Engine").
* * *