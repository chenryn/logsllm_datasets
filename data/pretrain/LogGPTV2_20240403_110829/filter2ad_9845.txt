# 作者：戒小贤@同盾反欺诈研究院

今天，我们将探讨IP地址研究的几个关键方面，这些问题可以归纳为以下三个核心议题：
1. **这个IP位于何处？**
2. **这个IP是什么类型？**
3. **这个IP做了什么？**

尽管这些问题看似简单，但每一个问题背后都需要进行深入的研究。在同盾科技进行IP画像的研发过程中，我们接触并评估了国内外多家优秀的IP数据服务商，通过一系列测试与调研后，最终选定了一家最佳的数据平台作为我们的基础数据供应商。基于这些数据，我们进一步生成了更丰富的信息，并将其应用于各种风险控制场景中。

## 关于IP的一些基础知识

**IP地址（本文特指IPv4地址）**是用于标识网络和主机的一种逻辑标志。得益于强大的TCP/IP协议，一个IP地址即可访问互联网上的所有资源。从本质上讲，IP地址只是一个32位无符号整数（unsigned int），其范围是从0到2^32-1，总共大约有43亿个可能的IP地址。为了便于人们使用，通常采用字符串形式表示IP地址，例如常见的192.168.0.1格式，这实际上是将整数每8位转换成十进制数字，并以点分隔的方式展示出来。比如，192.168.0.1和3232235521实际上代表同一个IP地址。

### 全球互联网分区
虽然《爱情公寓3》里提到的“格兰芬多、斯莱特林、赫奇帕奇及拉文克劳”等四大区域纯属娱乐性质的内容，但它确实反映了互联网确实被划分为不同的管理区域这一事实。实际上，全球共有五个主要的区域性互联网注册机构(RIRs)，它们分别是：

- 美洲互联网号码注册管理机构 (ARIN)
- 欧洲IP网络资源协调中心 (RIPE NCC)
- 亚太网络信息中心 (APNIC)
- 拉丁美洲及加勒比地区互联网地址注册管理机构 (LACNIC)
- 非洲网络信息中心 (AfriNIC)

其中负责亚洲地区IP地址分配的是APNIC，总部设在澳大利亚墨尔本。各RIR机构提供关于IP地址划分的登记信息，即whois记录，可以通过各大RIR机构提供的查询页面或whois命令获取相关信息。Whois记录中会显示特定IP所属网段及其运营商信息。例如，查询结果显示153.35.93.31隶属于江苏联通。

#### IP定位方法
对于第一个问题——"这个IP在哪里？"，除了利用whois信息外，在风控场景下还需要更加精准的位置信息。为此，一种常见做法是依靠大量用户提交的真实位置报告来构建数据库；另一种则是通过对海量Traceroute信息进行分析来确定IP的大致位置。后者有时也被称为“网络位置”，它指的是从互联网架构角度出发所确定的一个IP被分配给某个地区的运营商。然而，由于运营商内部运作复杂性以及某些特殊租赁安排等原因，单纯依赖上述任一方法都可能存在偏差。因此，在实际应用中往往需要结合多种技术手段综合判断。

此外，随着移动设备普及，在获得用户许可的前提下，还可以通过收集GPS坐标来辅助判断用户的实际地理位置。这种方法得出的结果称为“行为位置”。不过需要注意的是，由于存在作弊现象且需要较长时间积累有效样本量，故此法亦存在一定局限性。

综上所述，IP地址定位是一项复杂而精细的工作，需综合考虑多种因素才能得到较为准确的答案。希望以上内容能够帮助大家更好地理解相关概念和技术细节。后续还将继续分享有关IP地址其他方面的知识，请持续关注！