dataset containing the same RSA public key. In most cases
the public keys were shared between the authentication and
digital signature certiﬁcates of the same ID card, however,
in two occasions the same public key was shared between
two different cardholders. The occurrence of such a fault
could only have happened through a deep violation of the
production processes, since each key pair is required to be
unique even for the keys on the same ID card.
The set of 10 identiﬁed certiﬁcate pairs containing duplicate
public key is listed in Table 1. All certiﬁcates have been
issued for jTOP SLE66-powered ID cards. For each pair, the
certiﬁcate issuance times have just a few seconds difference,
indicating that the certiﬁcates were issued in parallel or close
to each other. In most of the cases, the duplicate public keys
were the result of the ID card renewal process, performed in
the PPA customer service points, to replace the vulnerable
applet for ID cards issued in 2011 (see Section 3).
No Time of cert issuance Type Cardholder
1
2
3
4
5
6
7
8
9
10
2012-11-06 15:35:09
2012-11-06 15:35:46
2013-02-06 15:35:54
2013-02-06 15:35:56
2013-02-07 12:18:34
2013-02-07 12:18:37
2013-02-19 09:09:58
2013-02-19 09:10:08
2013-02-25 09:33:17
2013-02-25 09:33:29
2013-03-04 11:36:08
2013-03-04 11:36:38
2013-03-30 13:40:38
2013-03-30 13:40:40
2013-03-30 13:42:03
2013-03-30 13:42:05
2013-04-15 09:16:11
2013-04-15 09:16:28
2014-10-08 12:01:16
2014-10-08 12:04:31
Phillip
sign Ülle
auth
Toivo
auth
sign
auth
Sandra
sign
auth Nadiia
sign
auth Moonika
sign
sign
Richard
auth Anu
auth
sign
auth
sign
auth
sign
auth
sign
Siim
Leili
Jaan
Liis
Issuance
PPA renewal
PPA renewal
Expiry date Revoked
2016-07-07
2016-07-04
2016-06-27
2014-11-21
Warranty
2014-10-09
2014-10-09
PPA renewal
2016-11-14
2015-05-04
2015-01-06
PPA renewal
2016-01-02
expired
not issued
PPA renewal
2016-11-24
2016-11-08
2014-12-22
PPA renewal
2016-08-22
2014-12-30
2014-12-22
PPA renewal
PPA renewal
2016-11-30
2016-08-12
2014-10-13
2014-10-23
2014-10-09
2014-10-09
initial
initial
2018-03-26
2015-05-14
2014-12-22
2018-03-26
2014-12-30
2014-12-22
PPA renewal
2016-05-06
expired
2014-12-22
initial
2019-10-07
2017-10-03
not issued
Table 1: Certiﬁcate pairs with duplicate public keys
4.1 Possible cause and impact
One explanation for these duplicate keys could be a poor
source of randomness used in the on-card key generation pro-
cess. However, we would expect such a failure to manifest
randomly, independently of the time when the key is gener-
ated, since the ID card chip has no built-in time source that
could be, for example, used to seed a pseudo-random number
generator. Since the keys for the affected ID cards have been
generated within an interval of a few seconds, this hypothesis
can be safely rejected.
The close timing of the certiﬁcate issuance suggests that
due to some software bug (such as race condition) a wrong
public key was included in the certiﬁcate, i.e., the same public
key was sent as a part of certiﬁcate signing request twice.
This, however, would result in at least one of the certiﬁcates
from the pair not being usable electronically, as the actual
private key residing on the ID card would not correspond to
the public key included in the certiﬁcate.
In the cases where the same public key is shared between
the digital signature and authentication certiﬁcates of the same
ID card, the risk is that the knowledge of only one PIN (PIN1
or PIN2 depending on which slot contains the corresponding
private key) allows the card to be used for both purposes.
A more serious risk occurs in the two cases where the same
public key is shared between different cardholders. For exam-
ple, in case of pair 1, depending on whose ID card contains the
corresponding private key, either Toivo can sign on behalf of
Ülle, or Ülle can use her digital signature key to authenticate
electronically as Toivo and decrypt ﬁles encrypted for Toivo
(these use cases, however, would require the modiﬁcation of
the software).
It could not be excluded that the ID cards actually do con-
tain duplicate private keys. However, if this was the case, the
only credible explanation would be that contrary to the secu-
rity requirements, the manufacturer had generated the keys
outside the card and due to a ﬂaw in the personalization pro-
cess the same key was imported in two different ID cards/key
slots.
4.2 Proof that ID cards share the same keys
Since we had a suspicion that private keys might be generated
outside the ID card, we decided to investigate the shared
public keys of the digital signature certiﬁcate of Ülle and
authentication certiﬁcate of Toivo (pair 1).
In summer 2013, we were able to get in contact with Toivo,
who informed us that his ID card was renewed in a PPA cus-
tomer service point in Viljandi. He provided us cryptographic
proof that both private keys in his ID card correspond to the
public keys speciﬁed in the certiﬁcates. To demonstrate that
Toivo’s authentication private key can be successfully used
to forge a digital signature of Ülle, with the assistance from
Toivo2, we created a proof-of-concept digital signature con-
tainer in the name of Ülle (see Figure 8).
We did not manage to get in contact with Ülle to obtain
a similar cryptographic proof from her ID card. In October
2014, we learned that the manufacturer had discovered the
incident, since Toivo was invited to replace his ID card with a
new one issued under warranty. The certiﬁcates of Ülle’s ID
card, however, remained valid. In spring 2015, we obtained
conﬁrmation from an Estonian service provider that Ülle had
used the ID card for both authentication and signing in the
e-service of the service provider. While this convinced us that
her ID card contained the same private key, we still hoped
to obtain cryptographic proof of that. In summer 2016, we
managed to get in contact with Ülle’s daughter who informed
us that her mother used the card daily to sign banking trans-
actions online, however, attempts to get in touch with Ülle
herself did not succeed. Later we learned that her ID card was
renewed in a PPA customer service point in Tallinn.
2Toivo was informed about the proof-of-concept signature forgery experi-
ment, but not the nature of the ﬂaw being exploited.
USENIX Association
29th USENIX Security Symposium    1789
her, therefore she kept using her ID card until its expiration.
In a meeting on 2017-02-06, we informed RIA about the
case of Toivo and Ülle and the most likely explanation of keys
being generated outside the ID card. At that time, we did not
exclude the possibility that RIA and PPA may be well aware
of the true reasons behind the ﬂaw.
When approached by the authorities, the manufacturer re-
sponded that this was the old case already investigated in
2014 and that the mistake only occured with public keys. At
the end of 2017, RIA ordered a follow-up study to determine
whether any further evidence of key generation outside the
ID card could be found [27]. Using statistical methods, strong
evidence was found, that in the renewal process in PPA cus-
tomer service points the keys were generated outside the ID
card (see Section 5).
As we see in Table 1, the certiﬁcates with duplicate public
keys were also found in 3 pairs of initially issued ID cards.
These cases could be the result of a separate personaliza-
tion fault where the cards actually do not contain duplicate
keys. We urged RIA and PPA to investigate this, by using the
database of OCSP certiﬁcate validity responses maintained
by SK, to see whether the relying parties had requested va-
lidity conﬁrmation of the involved certiﬁcates. From this it
would be possible to infer whether the ID cards had been
used successfully hence containing the keys speciﬁed in the
certiﬁcates. We are not aware if this has been investigated.
5 Private keys generated outside the ID card
At the end of 2013, in the context of Snowden revelations,
an opinion piece was published in Estonia [28] expressing
concerns about authorities having copies of ID card private
keys. The authorities rebutted the concerns [29], claiming that
the recording of private keys is ruled out by the technological
scheme used, i.e., the keys are generated inside the chip and
the ID card is designed so that the private key itself never
leaves the card.
Indeed, the security requirement of ID card key genera-
tion inside the chip has already been present in the ID card
concept [30], has been documented in the EstEID technical
speciﬁcation (Section 4.1.5 in [7]), has been speciﬁed in SK
certiﬁcation policy according to which the CA is audited (Sec-
tion 6.1.2 in [31]), and has also been present in the ID card
manufacturing contract between the manufacturer and the
state.
The rationale behind this requirement is that key generation
inside the chip provides higher security. It is easier to ensure
that copies are not created, rather than to make sure that all the
copies have been irreversibly destroyed to eliminate potential
misuse. For example, the Mobile-ID technology comes with
extra risks, since it is documented that the keys for Mobile-ID
are generated outside the chip (Section 6.1.1.3 in [32]).
In this section we describe our efforts to establish the true
origins of the ID card private keys on each ID card platform.
Figure 8: Digital signature of Ülle forged using the authenti-
cation key of Toivo
A similar (non-cryptographic) conﬁrmation that both keys
of the card are usable electronically was also obtained from
Liis (pair 9).
The ability to successfully use both certiﬁcates involved
in the duplicate certiﬁcate pair shows that the affected ID
cards/key slots do share the same private keys that were ap-
parently imported due to an error (e.g., race condition) in the
ID card renewal process.
Incident response
4.3
In October 2014, at the latest, the manufacturer learned of
the anomaly of duplicate keys. On 2014-10-09 a new ID card
was produced for Toivo and on 2014-10-10 Toivo received
an invitation from PPA to replace his ID card with a new one
under warranty. The email stated that the ID card renewal
on 2012-11-06 was unsuccessful and the card could not be
used electronically (which actually was not true). For other
cardholders the replacement cards were issued on 2014-10-09,
2014-12-22 and 2015-01-06 (the last column in Table 1). For
unknown reasons the duplicate keys on the ID card of Sandra
(pair 3) were missed, as for her the replacement ID card was
not issued. Apparently, the cause of the ﬂaw was not fully
ﬁxed and detection mechanisms were not implemented. As a
result, a similar fault occured later again with the ID card of
Siim (pair 10).
It is crucial to note that the incident was not handled as
a security issue. The affected certiﬁcates were not revoked
until the cardholders visited a PPA customer service point to
receive the replacement card. Ülle was able to use her ID card
until shortly before its expiration where it was then replaced.
Liis informed us that the invitation from PPA did not reach
1790    29th USENIX Security Symposium
USENIX Association
5.1 Finding the evidence
In 2016, Svenda et al. in their paper “The Million-Key Ques-
tion – Investigating the Origins of RSA Public Keys” [33]
described a method which can be used to infer from the RSA
public key modulus some details about the algorithm used
to generate the key. In particular, it was found that the most
signiﬁcant byte (MSB) of modulus N allows to establish the
range from which primes p and q were selected. This range
turned out to be different for different implementations of the
RSA key generation algorithm. We used this and other tech-
niques to verify whether the properties in the RSA keys from
the ID card certiﬁcates match the properties of the key gen-
eration algorithm implemented by the ID card platform. To
obtain reference keys, we generated and exported thousands
of keys from each ID card platform (when it was possible),
simultaneously measuring the time taken by the on-card key
generation process.
5.1.1 MICARDO
We found a conﬁguration ﬂaw in all MICARDO-powered
ID cards that allowed us to perform card management oper-
ations with PIN2, without knowing the manufacturer’s sym-
metric card management keys [19]. We used this to generate
and export over a million 1024-bit RSA key pairs generated
by the platform.