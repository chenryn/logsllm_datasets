3640
com/security-software-guidance/software-guidance/
rogue-system-register-read, May 2018.
System Register Read
INTEL-SA-00115,”
/
/ CVE-2018-
https://software.intel.
[74] J. Stecklina and T. Prescher, “LazyFP: Leaking FPU Register
State using Microarchitectural Side-Channels,” 2018.
[75] O. Weisse, J. Van Bulck, M. Minkin, D. Genkin, B. Kasikci,
F. Piessens, M. Silberstein, R. Strackx, T. F. Wenisch, and
Y. Yarom, “Foreshadow-NG: Breaking the virtual memory
abstraction with transient out-of-order execution,” Technical
report, 2018.
Intel,
Side
Channels: White paper,” Jan 2018, https://newsroom.
intel.com/wp-content/uploads/sites/11/2018/01/
Intel-Analysis-of-Speculative-Execution-Side-Channels.pdf
Retrieved 15.10.2018.
Speculative Execution
“Intel Analysis
[76]
of
[78]
[77] D. Woodhouse,
“x86/retpoline: Fill RSB on Context
Switch for Aﬀected CPUs,” https://git.kernel.org/pub/
scm/linux/kernel/git/torvalds/linux.git/commit/?id=
c995efd5a740d9cbafbf58bde4973e8b50b4d761, Jan 2018.
Intel, “Deep Dive: Intel Analysis of L1 Terminal Fault,”
https://software.intel.com/security-software-guidance/
insights/deep-dive-intel-analysis-l1-terminal-fault Retrieved
15.10.2018.
[79] J. Horn,
channel,”
01/reading-privileged-memory-with-side.html, Jan 2018.
“Intel Announces 9th Generation Core CPUs, Eight-Core
Core
https://www.tomshardware.com/news/
intel-9th-generation-coﬀee-lake-refresh,37898.html.
“Reading Privileged Memory with a Side-
https://googleprojectzero.blogspot.com/2018/
i9-9900K,”
[80]
[81] Z. Hua, D. Du, Y. Xia, H. Chen, and B. Zang, “EPTI: Eﬃcient
Defence against Meltdown Attack for Unpatched VMs,” in
ATC’18).
Appendix A
Statements from CPU Vendors
A. Statement from Intel
“We have disclosed details about the issue described
in VU Amsterdam’s paper with multiple parties in the
computing ecosystem who have the ability to help de-
velop mitigations. This includes operating system vendors
such as MSFT and Redhat, hypervisor vendors such as
VMWare and Citrix, silicon vendors or licensors such as
AMD and ARM, select operating system providers or
maintainers for open source projects, and others. These
disclosures have been conducted under coordinated vulner-
ability disclosure for purposes of architecting, validating,
and delivering mitigations, and all parties agreed to mutual
conﬁdentiality and embargo until 10AM PT May 14, 2019”.
(cid:18)(cid:17)(cid:20)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:51:31 UTC from IEEE Xplore.  Restrictions apply. 
B. Statement from AMD
“After reviewing the paper and unsuccessfully trying
to replicate the issue, AMD believes its products are not
vulnerable to the described issue”.
C. Statement from ARM
“After reviewing the paper and working with archi-
tecture licensees we are not aware of any Arm-based
implementations which are aﬀected by this issue. We thank
VU Amsterdam for their research”.
Appendix B
Extended Results
Figure 9 shows a more complete diagram of the Intel
Skylake microarchitecture.
Figure 10 shows a screenshot of our tool to test for
existing vulnerabilities as well as RIDL, to check what
mitigations are available and enabled and to provide a
general overview including the installed microcode version.
We will release this tool as open source on May 14, as
well as provide binaries of this tool for various platforms
including Microsoft Windows and Linux.
(cid:18)(cid:17)(cid:21)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:51:31 UTC from IEEE Xplore.  Restrictions apply. 
1
Front-end
3
Memory Pipeline
2
Out-of-Order Engine
Instruction
Predecode & Fetch
(16 bytes)
6 MOPs
Instruction Queue
(2x25 entries)
Macro
Fusion
5 MOPs
5-way Decoder
C
o
m
p
e
x
l
3
3
-
-
4
4
μ
μ
O
O
P
P
s
s
i
S
m
p
e
l
i
S
m
p
e
l
i
S
m
p
e
l
i
S
m
p
e
l
μ
O
P
μ
O
P
μ
O
P
μ
O
P
MS
ROM
S
e
q
u
e
n
c
e
r
μ
C
o
d
e
6 μOPs
5
μ
O
P
s
4 μOPs
Multiplexer
Branch
Prediction
Unit
Return Stack
Buffer
Branch
Target Buffer
μOP Cache
1.5K μOPs
8-way
Stack Engine
A
d
d
e
r
s
Allocation Queue
Allocation Queue
Allocation Queue
(2x64 entries)
(2x64 entries)
(2x64 entries)
Micro
Fusion
L1i Cache
32 kiB
8-way
L
1
i
T
L
B
Instruction
μOP
Cache Tags
L
2
T
L
B
L
1
d
T
L
B
L2 Cache
256 kiB
4-way
L1d Cache
32 kiB
8-way
Line Fill
Buffer
(10 entries)
STORE
AGU
LOAD
AGU
LOAD
loads
stores
Load Buffer
(72 entries)
Store & Forward Buffer
(56 entries)
branches
Branch Order Buffer
(48 entries)
μOPs
Re-order Buffer
(224 entries)
Physical
Register File
Integer
Registers
(180 entries)
Vector
Registers
(168 entries)
Retirement Unit
Register Alias Table
Primary
Shadow
RAT
RAT
4 μOPs
6 μOPs
Register
Allocation & Renaming
C
o
m
m
o
n
D
a
t
a
B
u
s
e
s
Execution Units
AGU
INT ALU
Branch
INT ALU
VEC
SHUFFLE
IVEC ALU
LEA
p
o
r
t
0
p
o
r
t
2
p
o
r
t
3
p
o
r
t
4
p
o
r
t
7
p
o
r
t
6
p
o
r
t
5
p
o
r
t
1
INT ALU
INT MUL
IVEC ALU
IVEC MUL
FP FMA
Bit Scan
INT ALU
INT DIV
IVEC ALU
IVEC MUL
FP FMA
AES
VEC STR
FP DIV
Branch
μOP Scheduler
Unied Reservation Station (97 entries)
CPU
Core
CPU
Core
LLC Slice
LLC Slice
LLC Slice
LLC Slice
CPU
Core
CPU
Core
System Agent
Display
Controller
PCIe
Memory
Controller
Fig. 9: a full overview of the Intel Skylake microarchitecture.
Fig. 10: A screenshot of our tool to test for vulnerabilities and mitigations including RIDL.
(cid:18)(cid:17)(cid:22)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:51:31 UTC from IEEE Xplore.  Restrictions apply.