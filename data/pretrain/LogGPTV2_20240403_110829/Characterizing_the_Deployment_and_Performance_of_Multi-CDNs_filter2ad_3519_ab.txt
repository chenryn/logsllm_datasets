2
−
7
0
7
1
0
2
−
0
1
8
1
0
2
−
1
0
8
1
0
2
−
4
0
8
1
0
2
−
7
0
Date (MM−YYYY)
(b) Microsoft IPv4 RTT
5
1
0
2
−
7
0
5
1
0
2
−
0
1
6
1
0
2
−
1
0
6
1
0
2
−
4
0
6
1
0
2
−
7
0
6
1
0
2
−
0
1
7
1
0
2
−
1
0
7
1
0
2
−
4
0
7
1
0
2
−
7
0
7
1
0
2
−
0
1
8
1
0
2
−
1
0
8
1
0
2
−
4
0
8
1
0
2
−
7
0
Date (MM−YYYY)
(b) Apple IPv4 RTT
Figure 2: CDN usage and Median RTTs by CDNs for Microsoft over IPv4.
Figure 4: CDN usage and Median RTTs by CDNs for Apple.
s
t
s
e
u
q
e
R
f
o
n
o
i
t
c
a
r
F
100%
75%
50%
25%
0%
OtherOther Edge Caches
Level 3
Akamai
Edge − Akamai
Microsoft
5
1
0
2
−
0
1
6
1
0
2
−
1
0
6
1
0
2
−
4
0
6
1
0
2
−
7
0
6
1
0
2
−
0
1
7
1
0
2
−
1
0
7
1
0
2
−
4
0
7
1
0
2
−
7
0
7
1
0
2
−
0
1
8
1
0
2
−
1
0
8
1
0
2
−
4
0
8
1
0
2
−
7
0
Date (MM−YYYY)
(a) CDNs providing Microsoft’s OS updates over IPv6.
)
s
m
(
T
T
R
n
a
i
d
e
M
150
100
50
0
OtherOther Edge Caches
Level 3
Akamai
Edge − Akamai
Microsoft
5
1
0
2
−
0
1
6
1
0
2
−
1
0
6
1
0
2
−
4
0
6
1
0
2
−
7
0
6
1
0
2
−
0
1
7
1
0
2
−
1
0
7
1
0
2
−
4
0
7
1
0
2
−
7
0
7
1
0
2
−
0
1
8
1
0
2
−
1
0
8
1
0
2
−
4
0
8
1
0
2
−
7
0
Date (MM−YYYY)
(b) Microsoft IPv6 RTT
Figure 3: CDN usage and Median RTTs by CDNs for Microsoft over IPv6.
4.1 Multi-CDN Mixture
In Figure 2a, we show the fraction of clients that receive Windows
updates over IPv4 from different CDNs over time. We observe that
almost all Microsoft IPv4 clients receive software updates from one
of 4 providers: Microsoft’s own network (registered in the USA),
Akamai’s network (registered in Europe), Level 3 (a tier-1 network
that also provides CDN services), and various Akamai and non-
Akamai edge caches. In mid-late 2015, Microsoft’s network was
directly responsible for serving roughly 45% of the clients, globally.
Since then, this percentage has steadily declined to only 11% in
April 2017. On the other hand, the percentage of clients served
by Level 3 steadily increases until February 2017 when Level 3
served a negligible number of Microsoft IPv4 clients. We discuss the
performance impact of the migration away from Level 3 (until the
year 2017) in detail (§6). We observe that in August 2017, roughly
40% Microsoft IPv4 clients are served by edge caches (including
Akamai’s). Since the end of 2017 there has been an increase in
non-Akamai edge caches serving Microsoft’s OS updates where
70% Microsoft clients in August 2018 receive content from edge
caches (Figure 2a). Figure 3a shows the CDNs that serve content to
Microsoft’s IPv6 clients. Until November 2015, Microsoft’s network
did not support IPv6. Since then, we see a similar CDN mixture for
IPv6 clients as seen for Microsoft’s IPv4 clients.
Apple’s CDN strategy (see Figure 4) shows a sharp contrast
from Microsoft’s. Unlike Microsoft, over 85% of Apple’s clients get
content directly from Apple’s own networks. Only 10% to 15% of
clients retrieve Apple’s software updates from other CDN providers
(e.g., Limelight, Akamai, Level 3).
4.2 Performance of CDNs
Figure 2b and 3b show the distribution of median RTT values for
Microsoft IPv4 and IPv6 clients respectively. The median RTT
observed by IPv4 clients is ⇡ 20 ms with similar values observed for
IPv6 clients (notable exceptions are IPv6 clients served by Level 3).
For both Microsoft (IPv4 and IPv6) and Apple (Figure 4b), edge
caches provide the least latency access to their clients with median
RTT values in between 10 and 25 milliseconds. As discussed in
Section 4.1, Microsoft relies heavily on Akamai’s edge caches to
distribute content but Apple does not follow this strategy. However,
edge caches provide low latency access to Apple’s content
(Figure 4b), suggesting the usefulness of larger edge cache
deployments.
4.3 Regional trends in performance
In Figure 5, we show the median RTT observed by clients in
different continents. We see that North American and European
clients observe stable low latencies near or below 20 ms for
Microsoft’s content (Figure 5(a) and (b)). However, other continents
go through periods of high variability in latency. For both IPv4 and
IPv6, African clients, we observe a general downward trend in
median RTT, showing that some progress has been made in
improving performance in developing regions; but they still observe
worse median RTTs (nearly 50 ms on average) than their North
American/European counterparts.
Compared to Microsoft, we observe Apple’s clients in Africa and
South America receive much worse latency (over 100 ms higher)
as seen in Figure 5(c). We attribute this to the lack of Apple edge
caches in developing regions (ﬁgure omitted for space). Interestingly,
in July 2017, we observe a sharp drop in median latency of clients
in Africa and South America. We ﬁnd the bulk of the clients that
observe this decrease in latency are shifting from other CDNs to
Limelight, another popular CDN provider.
We observe that Level 3 has high latency to both Microsoft and
Apple clients. We investigate regions where Level 3’s latency is
high and ﬁnd that while Level 3 has short RTTs (⇡ 20 ms) to North
American clients, clients elsewhere observe high latencies when
receiving content from Level 3. For instance, roughly 17% of clients
in Africa receive Microsoft’s updates from Level 3, and these clients
observe large RTT values (⇡ 168 ms) in the duration of our study.
In case of Apple, we ﬁnd that roughly 75% of clients in Africa are
served Apple updates from Level 3, which leads to overall high
latency access in Africa (see Figure 5(c)). We perform a detailed
analysis of the performance of Level 3 for content delivery in §6.1.
Since we observe more diversity in the CDNs employed by Mi-
crosoft (Figure 4a), we focus on analyzing Microsoft’s IPv4 clients
in the remaining sections.
5 STABILITY OF CDN ASSIGNMENTS
We now analyze the stability of the mapping between clients and
CDN server preﬁxes. Identifying co-located CDN servers is a hard
problem [10], one we do not focus on in this work. Instead, we
analyze the mapping of client preﬁxes to CDN server preﬁxes with
the goal of understanding the relationship between stable mappings
and latencies. We quantify stability using two metrics: (1) prevalence
as deﬁned in previous work [11] and (2) the average number of CDN
preﬁxes observed by clients in a given day.
Prevalence of CDN server preﬁxes. Prevalence of client to server
mapping captures how often a client receives content from a given
CDN preﬁx (/24). For each client, we calculate the probability of
receiving content from a given preﬁx in one day (i.e., a prevalence
of 1 means that the client is always referred to the same preﬁx). In
Figure 6(a), we show the mean prevalence of the dominant server
(the server that responds to the client most often) for Microsoft’s
IPv4 clients over time. Higher prevalence implies high stability in
the client to server mapping. We observe a general decreasing trend
in server prevalence for all continents, speciﬁcally in case of North
America.
CDN preﬁxes seen in a day. Next, we analyze the number of CDN
server preﬁxes observed by each client over the course of a day. A
lower number of preﬁxes per day would imply more stable mapping.
Figure 6(b) shows the mean number of CDN preﬁxes clients observe
each day, over time. We observe a general increasing trend, showing
that clients are becoming more likely to receive content from a
diverse set of servers. This trend is more pronounced for North
American clients.
Stability and latency. We analyze the relationship between the
stability of server mappings and client-side latency using linear
regression. We note that we are using latency as a proxy for
performance as we do not directly measure throughput of the
software downloads. Earlier work [12] has found that CDNs
trade-off latency by choosing a subset of edge servers for stable
anycast routing. Figure 7 shows the linear regression trend between
mean RTTs and stability of server mappings for clients in
developing regions. We observe that lower RTTs correlate with
more stable (high prevalence) server mappings.
IMPACT OF CDN MIGRATION
6
Multi-CDN deployments give content providers options as to which
CDN a given client will be referred to. In this section, we investigate
how different CDN selection strategies impact client latency. We in-
vestigate the impact of migrating to/away from Level 3 (Section 6.1)
in developing regions, and how edge caches improve performance
for clients (Section 6.2).
6.1 Content Delivery from Level 3
In Section 4, we observe ﬂuctuations in latencies for clients that
are being served from Level 3. We now investigate the impact of
migrating towards/away from Level 3 on a per-client basis. First, we
analyze cases of client migration from Level 3 to any other CDN
provider. We ﬁnd that migration away from Level 3 improves latency
for clients in developing regions and Oceania likely due to a dearth of
Level 3 servers in these regions. For instance, migration away from
Level 3 leads to improved RTTs 83%, 75% and 71% of the time for
clients in Oceania, Asia and South America, respectively. Figure 8
shows the distribution of the change in RTT ( oldRTT
newRTT ) when the
same client migrates towards or away from Level 3. Here, a value
of > 1 indicates a decrease in RTT and a value of < 1 indicates that
the new RTT was higher than the prior one. Clients located in the
developing world can obtain low latency access if they are migrated
away from Level 3 but this migration does not signiﬁcantly impact
clients in the developed world.
6.2 Content delivery from edge caches
Second, we analyze cases where Microsoft IPv4 clients migrate
from non-edge caches (i.e., servers in Level 3, Microsoft, Akamai’s
networks) to edge caches of different types (including Akamai’s
AfricaAsiaEurope
North America
Oceania
South America
AfricaAsiaEurope
North America
Oceania
South America
AfricaAsiaEurope
North America
Oceania
South America
)
s
m
(
T
T
R
n
a
i
d
e
M
200
150
100
50
0
)
s
m
(
T
T
R
n
a
i
d
e
M
200
150
100
50
0
)
s
m
(
T
T
R
n
a
i
d
e
M
200
150
100
50
0
f
l
o
e
c
n
e
a
v
e
r
p
e
g
a
r
e
v
A
r
e
v
r
e
s
N
D
C
t
i
n
a
n
m
o
d
1.0
0.8
0.6
0.4
0.2
0.0
5
1
0
2
−
0
1
6
1
0
2
−
1
0
6
1
0
2
−
4
0
6
1
0
2
−
7
0
6
1
0
2
−
0
1
7
1
0
2
−
1
0
7
1
0
2
−
4
0
7
1