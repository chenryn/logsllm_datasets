title:TRAKS: A Universal Key Management Scheme for ERTMS
author:Richard J. Thomas and
Mihai Ordean and
Tom Chothia and
Joeri de Ruiter
TRAKS: A Universal Key Management Scheme for ERTMS
Richard J. (cid:140)omas
University of Birmingham
Birmingham, UK
R.J.(cid:140)PI:EMAIL
Mihai Ordean
University of Birmingham
Birmingham, UK
PI:EMAIL
Tom Chothia
PI:EMAIL
University of Birmingham
Birmingham, UK
ABSTRACT
(cid:140)is paper presents a new Key Management and Distribution Scheme
for use in the European Rail Tra(cid:129)c Management System (ERTMS).
Its aim is to simplify key management and improve cross-border
operations through hierarchical partitioning. (cid:140)e current scheme
used in ERTMS involves the creation and distribution of 3DES keys
to train and trackside entities, which are then used as part of the Eu-
roRadio Protocol to provide message authentication. (cid:140)is results in
the distribution of tens of thousands of keys using portable media,
a prohibitively high burden on management and resourcing. We
present a symmetric key solution, TRAKS, which has the bene(cid:128)t of
being backwards compatible with the current ERTMS standard and
being post-quantum secure. (cid:140)is new scheme reduces the number
of cryptographic keys in circulation, and maintains the current se-
curity model. We achieve this by dynamically deriving unique keys
from a shared secret, i.e. the line secret, which is combined with
IDs of trains, and of signalling equipment. In addition to providing
be(cid:138)er key management, our scheme also adds authentication to
the location data provided by EuroBalises.
CCS CONCEPTS
•Security and privacy → Key management; Hash functions
and message authentication codes; Authorization; Mobile
and wireless security;
1 INTRODUCTION
In any Industrial Control System (ICS) that has safety-critical func-
tionality, it is important for any message to be authenticated in
order to ensure that the message came from a genuine entity who
had appropriate authorisation to send that message, and to detect
malicious modi(cid:128)cations by an a(cid:138)acker.
(cid:140)e European Rail Tra(cid:129)c Management System (ERTMS) is a
safety-critical ICS which provides a suite of protocols used to deliver
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for pro(cid:128)t or commercial advantage and that copies bear this notice and the full citation
on the (cid:128)rst page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permi(cid:138)ed. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior speci(cid:128)c permission
and/or a fee. Request permissions from permissions@acm.org.
ACSAC 2017, San Juan, PR, USA
© 2017 Copyright held by the owner/author(s). Publication rights licensed to ACM.
978-1-4503-5345-8/17/12...$15.00
DOI: 10.1145/3134600.3134631
Joeri de Ruiter
Radboud University
Nijmegen, NL
PI:EMAIL
a modern train management and signalling platform1. (cid:140)is standard
is designed with the intention to enable trains to interoperate across
borders and optimise the running operation of railways. At present,
the system is being rolled out across Europe and also on high-
speed lines around the world. ERTMS is de(cid:128)ned as a protocol stack
formed of the following three layers: GSM-R [9], EuroRadio and
the Application Layer Protocol. (cid:140)e EuroRadio and the Application
Layer Protocol form ETCS, the European Train Control System [16].
GSM-R, a rail-speci(cid:128)c variant of the GSM protocol, is used for
communications between the train and trackside infrastructure
such as radio block controllers (RBCs), i.e. the trackside components
that manage trains in a geographical area. RBCs are responsible for
issuing ‘movement authorities’, messages which permit a train to
move a speci(cid:128)c distance at a given speed, and managing safe train
movement in a geographic region of approximately 70km. Trains
periodically provide location updates and the RBC would respond
with an updated movement authority. (cid:140)e EuroRadio protocol layer
provides authentication and integrity of the communication using
cryptographic MACs. Messages which have a valid MAC (or are
from a carefully selected subset of messages that may be sent at a
high priority and not requiring a MAC) are passed to the application
layer. (cid:140)e Application Layer Protocol [6] is a stateful protocol that
de(cid:128)nes the ERTMS message standard and additionally implements
checks that help prevent message replays.
EuroBalises are devices placed between the tracks, typically in
groups of two or three, which are read by a train passing over them.
(cid:140)e train trusts the EuroBalise to provide accurate location (rather
than using GPS) and track pro(cid:128)le data, which can include speed
limits, gradients and tilt pro(cid:128)les. Currently, the balise data is vali-
dated using a CRC code, which is publicly known [21], and is only
for error detection but does not provide any integrity protection.
(cid:140)e current ERTMS standard [18] states that key provisioning
and management should be done based on geographical domains
(e.g. Great Britain), where each domain has a Key Management Cen-
tre (KMC) which is responsible for key generation and management
for that domain. Additionally, the KMC also de(cid:128)nes procedures to
install the keys on train on-board units (OBUs) and RBCs. (cid:140)rough-
out the paper we will interchangeably use the terms train and OBU
to refer to trains. (cid:140)e current procedure requires that keys for
an OBU or from an RBC are generated by the KMCs following a
request from a vendor (e.g. Siemens). A(cid:137)er generation, the keys for
1h(cid:138)p://www.ertms.net
ACSAC 2017, December 4–8, 2017, San Juan, PR, USA
Richard J. Thomas, Mihai Ordean, Tom Chothia, and Joeri de Ruiter
the requesting OBU or RBC are sent in the clear on portable media
devices [19], to be installed.
(cid:140)is setup is highly ine(cid:129)cient; using portable media devices to
move keys greatly increases the risk of compromise, especially due
to the fact that keys on the device are stored in cleartext. Addi-
tionally, this makes deployment and management of keys di(cid:129)cult
(i.e. in order to update a key for an RBC, an engineer needs to phys-
ically travel to the RBC’s location in order to install the key on the
portable media device). Informal discussions with rail systems man-
agers have highlighted that insecure strategies like (i) provisioning
all (OBU, RBC) key pairs to each OBU and RBC, or simply (ii) having
KMCs extend the life of keys when they are due to expire are used
in practice. Cross-border operation is also challenging as keys need
to be shared between geographical domains that are managed by
di(cid:130)erent KMCs. Under the current scheme, additional burden is
placed on the foreign KMC operators (KMC owners who are outside
of the ‘home domain’ that the train is registered). Whenever a new
OBU is to operate in their domain, they are required to establish
the appropriate keys to hand to the ‘home’ KMC, but they also have
to send an engineer to each of their RBCs to install the necessary
keys. In the case of a progressive national deployment, this burden
is high.
ICS environments are also designed with a long lifespan as a
key feature. Any solutions presented must consider issues such as
post-quantum security, where quantum computers could render
some encryption schemes insecure. It should, however, be noted
that there are current e(cid:130)orts by NIST and ETSI to standardise
post-quantum cryptography. (cid:140)e time required to standardise this,
though, is past the intended start of ERTMS national deployment.
For example in the United Kingdom, Crossrail and the East Coast
mainline are expected to be complete by 2021.
In this paper, we give a formal de(cid:128)nition of the security of the
ERTMS key generation. We continue by proposing a new key man-
agement scheme for ERTMS comprised of a key generation scheme,
which introduces line secrets to enforce an operational permissions
model, and, when combined with the train ID and RBC ID produces
a key which can be used in the EuroRadio protocol to negotiate
a session key for message MACs, and its corresponding key dis-
tribution protocol. Our solution is backwards-compatible with the
current scheme allowing infrastructure managers to progressively
implement it into the standard.
1.1 Contributions
(cid:140)is paper proposes TRAKS (Train and RBC Authenticated Key
Scheme), a key management scheme for ERTMS. Our main focus
with TRAKS is to reduce the management overhead, i.e. physically
transport keys on portable media devices, an ine(cid:129)cient process
which has lead to insecure practices, while maintaining the same
(cid:131)exibility and security for the keys. As such, our contributions are
as follows:
(1) Uni(cid:128)ed ERTMS Key Management and Distribution
Protocol. (cid:140)e TRAKS key management scheme is de-
signed to generate message authentication keys for com-
munications between OBUs and RBCs, and for communi-
cations between OBU and balises.
(2) Reduced deployment overhead. (cid:140)e TRAKS scheme
provides support for dynamic key generation using pseudo-
random functions (PRFs) and a shared secret. (cid:140)e method
of producing long-term keys removes the need to physi-
cally access RBC a(cid:137)er deployment (RBCs are still provi-
sioned with a secret during deployment).
(3) Backwards compatible and post-quantum secure. Our
protocol is designed using symmetric key cryptography in
a way that allows it to be fully backwards compatible with
the current scheme used by ERTMS. (cid:140)is makes it possible
to gradually roll out this scheme in existing systems. Addi-
tionally, TRAKS uses post-quantum secure PRFs to derive
keys.
(4) Security analysis. To our knowledge, we provide the
(cid:128)rst security de(cid:128)nition for the key generation protocol in
ERTMS. We also prove that TRAKS is at least as secure as
the current scheme while providing all additional bene(cid:128)ts
with respect to key management.
Issues with the existing ERTMS scheme and related work are
discussed in Section 2. We then provide a high-level overview
and intuition of the current o(cid:132)ine ERTMS scheme and TRAKS
in Section 3. In Section 4, we provide a generic formalism of the
o(cid:132)ine ERTMS scheme, followed by our scheme, TRAKS, in Sec-
tion 5. A security analysis is provided in Section 6. We discuss
the key management lifecycle and distribution in Sections 7 and
8 respectively. Example applications of the scheme, showing its
universal application in ERTMS, including EuroBalises (EBs) are
presented in Section 9, and we conclude in Section 10.
2 BACKGROUND AND RELATED WORK
Currently, ERTMS Key Management is de(cid:128)ned as two standards,
one o(cid:132)ine, and a proposed online scheme [19, 20]. Some past work
has looked at ERTMS Key Management, for example in [7, 8], where
ERTMS was taken as a case study in assessing the protection of
critical infrastructure, with an introduction to a proposed ERTMS
key management hierarchy, and study of the use of symmetric and
public key cryptography and their applicability to the problem.
(cid:140)ey advocate symmetric key solutions over public key solutions.
P´epin and Viglio(cid:138)i [12] perform an analysis of ERTMS Key Manage-
ment from a cryptographic perspective, identifying that the current
scheme will fail when 3DES may be feasibly broken, but do not
make any recommendations on how to amend the scheme other
than a change in cryptographic algorithms.
Since the development of the o(cid:132)ine scheme and the introduction
of the ETCS Level 3 baselines, an online solution has been proposed
in [20]. (cid:140)is involves the introduction of a PKI in which certi(cid:128)-
cates and keys are issued to trains and RBCs, where they can then
communicate with the Key Management Centre. (cid:140)is, however,
relies on the assumption that GSM-R bandwidths are capable of
these communications, and rely on the upgrade to GPRS support,
which is not currently rati(cid:128)ed for use in ERTMS. (cid:140)e move to an
online scheme would be disruptive for infrastructure managers.
(cid:140)e only bene(cid:128)t of this scheme it is that an engineer does not have
to interact with the train or RBC a(cid:137)er initial setup, with the excep-
tion of maintenance periods. Furthermore, the management of a
large-scale PKI for cross-border operation would become a burden
TRAKS: A Universal Key Management Scheme for ERTMS
ACSAC 2017, December 4–8, 2017, San Juan, PR, USA
as all trains and RBCs will be required to regularly contact all key
management centres they are entitled to use to update their certi(cid:128)-
cates and keys. With the limiting bandwidths available by GSM-R,
this is not a feasible solution, and places signi(cid:128)cant overheads on
the train owner and infrastructure manager, especially given the
long lifespan of ERTMS will limit the cryptographic primitives that
can be used. In a post-quantum world, however, with the use of
public-key cryptography de(cid:128)ned in [20], the scheme would also
not be secure, as it relies on RSA public key encryption. Both the
o(cid:132)ine and PKI-based schemes retain the same key hierarchy, as
presented in Table 1.
Di(cid:130)erent solutions for key management have been proposed
in the literature. For example, Biswas proposes a solution with
multiple two-party keys and one multi-party key, where base and
extended keys are used to exchange keys across a large, static
group [2]. Other schemes, such as the Advanced Access Control
System (AACS) [10], use pseudo-random functions to generate
symmetric keys which are used to derive the necessary keys to
decrypt media content. (cid:140)ese schemes are, however, not directly
applicable to ERTMS, as groups cannot be statically set and they
change over time. (cid:140)e AACS scheme is also establishes long-term
keys for decryption only and not for the authentication of payloads.
Alternative proposals are based on Di(cid:129)e-Hellman, which is not
post-quantum secure [11, 15].
Several proposals that have been made by the National Infras-
tructure Managers to speci(cid:128)cally improve ERTMS key manage-
ment [1, 3, 13], as the current schemes either lacked de(cid:128)nition on
key distribution2 or were not suitable for use. In the case of ProRail
and ¨OBB, keys are not issued equally, where ProRail tendered a