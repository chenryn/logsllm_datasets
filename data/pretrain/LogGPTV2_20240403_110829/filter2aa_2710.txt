The Great Hotel Hack
Adventures in attacking hospitality industry
Etizaz Mohsin
https://etizazmohsin.com
Disclaimer
No hotels were harmed during making of this presentation
Do not try this at home!
Images Courtesy: ANTlabs & INTSIGHTS
What this talk is not about
What this talk is about
Biggest threats are simple not sophisticated
Previous Research
Agenda
• Why Do hackers attack hotel
• Attack surface walkthrough
• Common attack vectors
• Who are threat actors
• Notable Data breaches
• What led to my research
• Demo NSA style hack
• Mitigations
Security Point Products 
• Network Security
• Endpoint Security
• Data Security
“Supreme excellence consists in breaking the enemy's resistance without fighting” 
– Sun Tzu
Why Do Threat Actors attack Hotel ?
• Second largest number of breaches after retail sector
• Prominent hotel brands attacked repeatedly
• Collect sensitive, valuable and varied data
• Manage large number of financial transactions
• Uses loyalty programs to encourage repeated visits
Hotel attack surface
• Large quantity of diverse endpoints
• Access to mothership
• Lack of employee security awareness
• Undefined security responsibilities
• High exposure to third parties
• Attacks on Point of Sale
• Spear phishing attacks
• WIFI network attack
• DDOS and Botnet attacks
• Internet of Things attacks
• Brand Impersonation
• Customer targeted attacks
• Ransomware
Attack Vectors
Threat Actors
• APT28 Fancy Bear
Threat Actors
• Darkhotel APT
Notable Data Breaches
Disclaimer Once Again!
How did this all start?
Disclosure Timeline
• 2018-10-31: First vendor notification – immediate response
• 2018-11-12: Technical details sent to vendor
• 2018-12-10: Vendor questions feasibility
• 2018-12-15: Proof of concept sent
• 2018-12-17: Vendor acknowledges vulnerability
• 2018-12-20: Vendor discusses update plans
• 2019-04-01: Vendor assures patching 
Hmm ??
Wi-Fi
Captive Portal
•
Radius
•
LDAP
•
Voucher
•
SMS
•
PMS
•
Social Login
Billing Feature
•
Credit Card
•
PMS (FIAS)
Management
•
Web portal
•
Role based access
•
DNS server
•
DHCP
•
Firewall
•
Lawful interception
Target Selection
Attack Surface
• Get private data
• Subscriber’s details, Network configuration, DHCP, DNS, firewall rules
• Backup, logs, PMS, Guest details, SSL, SMTP
• Set every parameter
• DHCP, DNS, WAN, LAN, Route Configuration
• Port forwarding, Syslog, SSL
• Download
• Configuration, database, backup, logs
• Upload
• Backup, Images
Web Management Portal
Web Server
TLS Certificates
Database
Read Write
Firewall rules
Configuration
Guest Details
Guest WIFI Configuration
Session Riding
Plain Text Credentials
Enumerating Users
SSH
System
Tools
Configuration
Owning DNS
• HTTP/S Downgrade
• Sniff plain text credentials
• FakeDNS
• WPAD abuse
• Hash capture (http_ntlm)
• Beef Hooks
• Browser autopwn2
• Evilgrade
• BDFProxy
User Reset
Management Portal
Active Users
Mac Addresses
User Details
DHCP Configuration
DNS Configuration
DNS Enteries
DYNDNS Configration
Network Configuration
Routes
Network Configuration Review
Port Forwarding
SSL Overview
Subnets
Interception
Firewall rules
Logs
Guest Details
PMS
Backup
SMTP
GUESS WHAT ?
DEMO
So, Who is Vulnerable ?
Once, we own the main box!
• PMS
• Corporate network
• Electronic door locks 
• Alarm
• HVAC
• Guests devices
• IOT devices
• CCTV
• In fact anything connected to the gateway
Mitigations for Guests
Mitigations for Guests
Mitigations for Guests
Mitigations for Guests
Mitigations for Guests
Mitigation for Guests
Mitigation for Guests
Mitigation for Owners
• Train and re-train your staff
• It takes one click on wrong link
• Train employees on best practices and
common attack vectors
Mitigation for Owners
• Strengthen your infrastructure
• Avoid easy to guess passwords on POS
• Use 2FA authentication
• Ensure end point protection is up to date
• Separate POS network from other
• Filter remote access for POS controller
• Segment WIFI Networks 
Mitigation for Owners
• Regulate vendors
• Ensure vendor meets compliance standard
• Regularly assess the risk of their vendors and partners
Mitigations for Owners
• Threat hunt inside your network
• Hackers move around to find valuable data
• Monitor network traffic to identify suspicious
activity and discover unauthorized access 
Mitigations for Owners
• Create a incident response plan to
speed up mitigation process.
Conclusion
• Stay aware while traveling
• Use VPN or 4G LTE
• Advanced persistent threats are devastating
• Biggest threats are simple not sophisticated
• No sign that attacks will slow down across any industry 
Thank You
https://www.linkedin.com/in/aitezaz/