### Threshold Adjustment for Notos to Detect Blacklisted Domains

To ensure that Notos could detect blacklisted domains (i.e., produce true positives), the threshold was adjusted. As a result, Notos classified 13,432 whitelisted domains as malicious, which were "visible" in the ISP1 traffic on the test day (see Figure 12a). Among these false positives (FPs):

- **Adult Content Domains**: 1,826 domain names (13.6% of FPs) were related to adult content, likely hosted on networks considered "dirty."
- **Malware-Queried Domains**: 234 domain names (1.7% of FPs) were queried at least once by malware samples executed in a sandboxed environment. While malware often queries popular benign domains, these domains may be flagged as "suspicious," leading Notos to assign them a low reputation.
- **Domains with Malware-Contacted IPs**: 2,011 domain names (15% of FPs) resolved to IP addresses that had been directly contacted by malware in the past.
- **Networks Hosting Malware-Contacted IPs**: 7,341 domain names (54.7% of FPs) resolved into a /24 network that had previously hosted IPs contacted by at least one malware sample.
- **No Evidence Available**: 2,020 domain names (15% of FPs) had no available evidence to explain why Notos classified them as malicious.

### Summary of False Positives

This analysis suggests that the actual number of "reputation-based" false positives could be less than 15% of the 13,432 domains classified as malicious, which corresponds to 2.94% of all whitelisted test domains. Even considering these filtered results, Notos would still generate 2.94% FPs. Therefore, our experiments show that Segugio outperforms Notos in discovering new malware-control domains.

### Table IV: Breakdown of Notos’s False Positives

| Category | Number of Domains | Percentage of FPs |
|----------|-------------------|-------------------|
| All Notos’s FPs | 13,432 | - |
| Explicit Evidence | - | - |
| - Adult Content | 1,826 | 13.6% |
| - Queried by Malware | 234 | 1.7% |
| - IPs Previously Contacted by Malware | 2,011 | 15% |
| Implicit Evidence | - | - |
| - Domains in /24 Networks Used by Malware | 7,341 | 54.7% |
| No Evidence | 2,020 | 15% |
| Potential Reputation FPs | - | 15% |

### Limitations and Discussion

#### Ground Truth Requirements
Segugio requires preliminary ground truth to label a set of "seed" known malware and benign nodes. This ground truth is often openly available from public C&C blacklists and popular domain whitelists, or can be obtained from commercial security providers. Section IV-E demonstrates that even using only public sources, Segugio can detect new malware-control domains. Some noise in the ground truth can be mitigated through filtering steps (see Section III).

#### Evasion Techniques
An attacker might attempt to evade Segugio by operating a malware-control channel under a legitimate and popular domain name, such as within a social network profile or blog comments. However, popular sites are often patrolled for security flaws, making such evasion more difficult. Attackers often prefer to use "bullet-proof" hosting providers to avoid takedown.

#### Detection Challenges
- **New Malware-Control Domains**: Segugio may struggle to detect malware-control domains that are never queried by known malware-infected machines. However, combining machine behavior features, domain activity, and IP abuse features, Segugio can still detect many new domains (see Section IV-C).
- **High DHCP Churn**: High DHCP churn can cause inflation in the number of machines querying a potentially malware-related domain. However, ISPs can correlate DHCP logs with DNS traffic to obtain unique machine identifiers.
- **Frequent Domain Changes**: Malware operators may change their C&C domains frequently to evade detection. However, Segugio can detect both malware-control domains and infected machines simultaneously, allowing administrators to track and remediate compromised machines.
- **Security Tool Noise**: Security tools that continuously probe malware-related domains can introduce noise into the bipartite machine-domain graph. Heuristics were used during experiments to filter out such anomalous clients.

### Related Work

#### Botnet/Malware Detection
- **Pleiades** [11]: Focuses on DGA-based malware by monitoring non-existent (NX) domains. Segugio monitors active domain names and aims to detect general malware-control domains.
- **BotSniffer** [13] and **BotMiner** [14]: Detect bot-compromised machines by monitoring network behavior. These systems require monitoring all network traffic and may not scale well to large ISP networks. Segugio uses a lightweight approach by monitoring DNS traffic.
- **Polonium** [17]: Detects malware files using graphical models. Segugio focuses on detecting new malware-control domains and does not rely on expensive algorithms.

#### Malware C&C Modeling and Tracking
- **Wurzinger et al.** [18]: Detects malicious activities and analyzes network traffic to find C&C communications. Segugio does not rely on detailed malware dynamic analysis.
- **Jackstraws** [20]: Generates behavior graphs for system calls related to network communications. Segugio focuses on passive DNS traffic analysis in live ISP networks.
- **Sato et al.** [21]: Studies co-occurrence of unknown domains with known C&C domains. Segugio has a lower false positive rate and can detect new C&C domains with low or no co-occurrence.

#### Signature-Based C&C Detection
- **Perdisci et al.** [22], **ExecScent** [23], and **FIRMA** [24]: Use signature-based approaches to detect C&C communications. These systems require access to all TCP traffic, whereas Segugio monitors only DNS traffic.

#### Other Related Work
- **Karagiannis et al.** [25], **Xu et al.** [26], and **Coskun et al.** [27]: Use graph-based approaches for various purposes, but differ from Segugio in goals and methods.
- **Felegyhazi et al.** [28]: Use domain registration information for proactive blacklisting. Segugio focuses on who is querying what and does not rely on domain registration records.

### Conclusion

In this paper, we presented Segugio, a novel defense system that efficiently discovers new malware-control domains by passively monitoring DNS traffic in large ISP networks. Deployed in two large ISP networks, Segugio achieved a true positive rate above 94% with less than 0.1% false positives. It also outperformed Notos [3] in detecting control domains related to previously unseen malware families.

### Acknowledgments

This work was supported in part by the National Science Foundation (grant No. CNS-1149051) and the Department of Homeland Security (contract No. N66001-12-C-0133). The opinions, findings, and conclusions expressed are those of the authors and do not necessarily reflect the views of the funding agencies.

### References

[References listed as in the original text]

---

This revised version aims to improve clarity, coherence, and professionalism, making the content more accessible and easier to understand.