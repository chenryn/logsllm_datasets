        -c own|host|both
            # 指定在恢复ARP配置时使用的硬件地址；当在清理（cleaning up）时，数据包的源地址可以用自己的也可以用主机（host）的硬件地址。使用伪造的硬件地址可能导致某些配置下的交换网络、AP网络或桥接网络通信中断，然而它比起默认值————使用自己的硬件地址要工作地更为可靠。
        -t target
            # 指定一个特殊的、将被ARP毒化的主机（如果没有指定，则认为是局域网中所有主机）。重复可以指定多个主机。
        -r  
            # 毒化两个主机（目标和主机（host））以捕获两个方向的网络流量。（仅仅在和-t参数一起使用时有效）
        host   #你想要截获数据包的主机 (通常是网关)。
**5\. 主机A作为网关主机欺骗**  
命令语句
    arpspoof -i eth0 -t 192.168.11.105 192.168.1.1
执行命令，Kali会向主机B发送ARP响应包，响应包的内容是Kali的ip-mac地址，而响应包里的ip则是网关主机ip地址。每一行代表一个响应包。从左到右：自己Kali的mac、主机B的mac、帧类型码(0806，代表ARP包)、包大小、包内容。
**6\. 被攻击主机B网络中断**  
我们在B主机用`arp -a`查看一下是否欺骗成功  
可以看到，网关主机C和攻击者主机A的mac地址相同，欺骗成功
在kali终端输入control + c 可以停止，清空并恢复原来正确的arp相应包，主机重新恢复联网状态
## 基于Arp攻击理解下的MITM
在前面Arp成功进行攻击后，我们开始作为中间人进行欺骗，需要设置ip转发，获取目标主机B的流量，其后配合其它工具(drifnet)等进行进一步嗅探。
值得一提的是，我们的Arp攻击也是欺骗，但它是单向欺骗，冒充网关主机来欺骗目标主机。实际中，中间人攻击一般是双向欺骗。即作为中间人，主机A双向欺骗主机B与C获得通信内容，但是不破坏通信数据的传输。为了不影响B与C传输的数据丢失，主机A开启ip转发，开启后来自B主机的数据包经过A主机的Kali后转发给主机C。欺骗两个主机B和C后，我们就能嗅探到双向数据包。
如果你的kali在虚拟机，那么以下步骤均需要一个外置的usb无线网卡。在虚拟机中，网络的连接比较复杂，而Ip转发很大程度上取决于网卡性能。如果你是在虚拟机中Kali进行转发，基本都会失败，因为笔记本的内置无限网卡满足不了需求。由于放假在家我的usb无线网卡落在了寝室..下面仅以文字给大家介绍攻击的思路和流程，还请见谅…….
###  linux的ip转发
linux因为系统安全，是不支持IP转发的，其配置文件写在/proc/sys/net/ipv4的ip_forward中。默认为0，需要修改为1。
开启方法大致有两种：
  1. 只接进入文件修改 
        cd /proc/sys/net/ipv4
    ls
    cat ip_forward
    #显示结果为0
    echo 1 > ip_forward
    cat ip_forward
    #显示结果为1，修改成功
  2. 使用echo 
        # echo  "1"> /proc/sys/net/ipv4/ip_forward
###  对网关和目标主机B的双向欺骗
这里进行一步执行，选用第二种Ip转发手段  
命令如下：
    root@kali:~# echo 1 > /proc/sys/net/ipv4/ip_forward && arpspoof -i eth0 -t 192.168.11.105 -r 192.168.11.1
###  利用driftnet进程监控
持续保持欺骗，再重新打开一个命令终端。  
输入命令：
    root@kali:~# driftnet -i eth0
跳出来的drift窗口即会显示本机正在浏览的图片
###  使用ettercap工具获取密码
  1. 打开新的终端，输入 attercap -G 启动工具
  2. 点击Sniff -> unified sniffing，选择要抓包的网卡，默认是自己的网卡eth0，点确定
  3. 然后单击Hosts -> Scan for host，待扫描完成后再次Scan for host，此时可以看到ettercap-NG已经扫描的主机列表
  4. 选择攻击目标，点击192.168.11.105的ip地址，点击Add to Target 1 ，然后选择网关的ip地址192.168.11.1，点击Add to Target 2
  5. 明确目标攻击方式：点击Mitm -> arp poisoning -> Sniff remote connections -> 确定
  6. 开始监听：start -> Start sniffing
工具就会抓取主机B的数据包和主机C返回的数据包,分析http post请求可以判断账号密码信息。
###  urlsnarf：获得受害者的HTTP请求
输入命令：
    root@kali:~# urlsnarf -i eth0
###  使用Wireshark抓包
使用Wireshark抓取所有的数据包，过滤分析不同请求，类似于ettercap。  
例如，要找HTTP POST请求，过滤，查看明文密码，一般是以POST形式上传的账号密码。
## 关于Arp欺骗的防御
防御原理很简单，就是不让攻击者肆意表明自己就是网关主机。我们进入网关主机（路由器后台地址），网络参数一栏一般有ip与mac绑定一栏，把网关的mac地址与网关地址绑定就好了。只要确定了对应关系，当攻击者发布arp相应包时，就不会更新相应的ip-mac缓存表。
我们重新进行欺骗后，再查询B主机的arp缓存表，如图  
网关主机的mac并没有被欺骗成功，我们的防御达到目的
如果想知道对方主机的ip地址其实也容易。我们在Cmd下键入命令`arp -a`看一下相同mac，就找到了攻击者。
## 总结
  * 公共区域的wifi存在钓鱼风险
  * 在传输数据过程中尽量使用加密程序