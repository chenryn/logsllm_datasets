while 1.8% resulted from typosquatting on subdomains. For exam-
ple, liinensource.com redirects to Rakuten LinkShare mer-
chant linensource.blair.com. We manually inspected 30
of the remaining 520 typosquatted domains that resulted in afﬁl-
iate cookies and found that these domains can be broadly classi-
ﬁed into three types. One-third of these domains are contextually
related to the ﬁnal landing page. For example, 0rganize.com
redirects to CJ merchant shopgetorganized.com, and bhea
lthypets.com and healthypts.com redirect to CJ merchant
entirelypets.com. Another third appear to be expired CJ of-
fers, and thus did not redirect to any merchant site. The remaining
one-third cookies result from typosquatted domains selling trafﬁc
to trafﬁc distributors like pureleads.com, 7search.com, and
blendernetworks.com that eventually redirect through an af-
ﬁliate URL. We revisit trafﬁc distributors in our discussion on re-
ferrer obfuscation in this section.
Iframes. Iframes are often used to render third-party content on a
Web page, which is otherwise forbidden by the Same-Origin policy
implemented by browsers. Most major afﬁliate programs disallow
the use of iframes, as it is a commonly used mechanism to facil-
itate cookie-stufﬁng. For example, HostGator explicitly prohibits
iframes: “iframes may not be used unless given express permis-
sion by HostGator, sales made through hidden iframes or Cookie-
stufﬁng methods will be considered invalid” [10]. Similarly, Ama-
zon Associates Program prohibits framing any Amazon link on a
page [3].
We received 420 cookies from content rendered in iframes on
third-party sites. Generally, a server can prevent a Web site from
framing its content on a page by using the X-Frame-Options
HTTP header with its value set to SAMEORIGIN to only allow ren-
dering content on a page with the same origin as the frame, or DENY
to completely disallow framing content on any Web site [14]. We
determined that Google Chrome and Firefox browsers honor the
X-Frame-Options header and do not render the iframe con-
tent, but both browsers save the cookies nonetheless. Thus, iframe
based stufﬁng is effective despite the use of X-Frame-Options
header.
We found that 17% of the cookies received from iframes set
X-Frame-Options to either SAMEORIGIN or DENY, includ-
ing every Amazon Associates Program cookie. Table 2 shows that
iframes still accounted for over a third of the stuffed Amazon cook-
ies. Unlike Amazon, only 2% of CJ cookies and 50% of LinkShare
cookies were accompanied by a restrictive X-Frame-Options
header.
We also used the style and size information gathered in our crawl
to determine how, if at all, a user would have seen the correspond-
ing iframe on the crawled page. We gathered this information
for 46% of the iframes. Of the 191 iframes, 64% explicitly set
the height or width to either 0 or 1px; 49 (25%) iframes have
visibility:hidden or display:none set, thereby mak-
ing the iframe invisible to an end user. Additionally, seven iframes
use CSS classes to hide the iframe DOM element. Of these, three
have the same afﬁliate ID kunkinkun and the CSS class rkt speci-
ﬁes left:-9000px, which positions the iframe outside the view-
port, and therefore invisible to the user. The same afﬁliate also de-
frauds Amazon Associates Program using the same technique and
ID shoppertoday-20. We also found two examples where iframes
were made invisible by setting the visibility CSS property on
their parent DOM elements. The 49 remaining iframes were not
hidden, and most of them correspond to ClickBank.
Images. Images can also be used to fetch third-party content on
a Web page. 504 cookies in our data set were requested as im-
ages. Of these we have recorded rendering information for 91%
cookies. Unlike our iframe data, we found that every single DOM
element either had width or height set to 0 or 1px, or style set to
display:none, effectively hiding the image from the end user.
We also found six cookies were requested by hidden img ele-
ments embedded within iframe elements. For example, best
blackhatforum.eu, a domain with Alexa rank 47,520, stuffs
cookies for three different LinkShare merchants (UDemy.com, mi
crosoftstore.com, origin.com), one CJ merchant (GoDa
45ddy.com), and Amazon. All of these afﬁliate URLs are requested
as hidden images of height and width zero pixels inside iframes
with src set to lievequinp.com, which is then observed by af-
ﬁliate programs as the referrer. As a result, the afﬁliate programs do
not observe the actual cookie-stufﬁng bestblackhatforum.eu
domain in the request for afﬁliate URLs thereby making detection
of cookie-stufﬁng difﬁcult. As shown in Table 3, fraudulent afﬁli-
ates use iframes to defraud Amazon and HostGator more often than
afﬁliate networks, suggesting greater difﬁculty in evading detection
by these in-house programs.
Scripts. Even though script tags can be used to fetch third-
party content from afﬁliate URLs by setting the src attribute, we
only found two such stuffed cookies. However, upon manual in-
spection of several cookie-stufﬁng domains we found that scripts
are often used for dynamic generation of hidden images and iframes
that then request the afﬁliate URLs.
Referrer Obfuscation. Next, we analyze the extent to which
fraudulent afﬁliates hide the actual cookie-stufﬁng domain behind
innocuous domains. Referrer obfuscation is used to make cookie-
stufﬁng via any technique, such as images, opaque to the afﬁliate
programs.
Of the 12K cookies we gathered in our crawl, 84% were fetched
via at least one intermediate domain. In fact, 77% of all cookies
were fetched via a single redirect, 4.5% via two redirects, and an-
other 2% via three or more redirects. Only the last redirect is seen
by the afﬁliate program in the HTTP Referer header.
We analyzed the intermediate domains, and found that a signiﬁ-
cant portion of the redirects go through a very small variety of do-
mains. The most common intermediate domains we observed are
cheap-universe.us, flexlinks.com, dpdnav.com, pgpa
rtner.com, 7search.com and pricegrabber.com. Of these,
flexlinks.com belongs to an afﬁliate program called FlexOf-
fers, while the other domains are likely trafﬁc distributors buying
trafﬁc and then monetizing via afﬁliate fraud. Over 25% of the
cookies in our data contain a redirect through at least one of these
trafﬁc distributors. In fact, 36% of all CJ cookies contain at least
one of these domains.
4.3 Prevalence of Afﬁliate Marketing
As described in Section 3, we gathered afﬁliate cookie data from
74 users over a two month period to study how often users click
on afﬁliate links and how often they receive stuffed cookies. Only
12 users received any afﬁliate cookie, encountering a total of 61
cookies for 23 distinct merchants. Over a third of these cookies
resulted from afﬁliate links on dealnews.com and slickdea
ls.net. Thus, while almost 84% of the users did not receive any
cookie at all, 12 users received an average of 5 cookies per user.
Table 3 shows the high level results.
Amazon Associates Program was the most popular afﬁliate pro-
gram in our study, accounting for almost 51% of the cookies. As
shown in Table 3, CJ Afﬁliate was the second most popular afﬁl-
iate program, followed by Rakuten LinkShare. Our users did not
receive any afﬁliate cookies from the ClickBank or HostGator af-
ﬁliate programs. This distribution is different from the networks
targeted by cookie-stuffers, where CJ Afﬁliate is targeted signiﬁ-
cantly more than Amazon.
Notably, none of these afﬁliate cookies were rendered within hid-
den DOM elements. We manually inspected all of them and veri-
ﬁed that none of the source afﬁliate Web sites are stufﬁng cookies.
To rule out the possibility that users were protected by ad-blocking
extensions that often disallow third-party cookies, we gathered the
Afﬁliate Network
Cookies Users Merchants Afﬁliates
Amazon Associates Program
CJ Afﬁliate
ClickBank
HostGator
Rakuten LinkShare
ShareASale
31
18
0
0
9
3
9
5
0
0
3
2
1
2
0
0
6
3
16
7
0
0
5
2
Table 3: Afﬁliate Programs that AffTracker users received cookies
for.
lists of extensions on their browsers and found that only four users
use any such extension. From our user study we found that users
rarely encounter cookie-stufﬁng fraud, and afﬁliate marketing is
dominated by a small number of afﬁliates. While the set of par-
ticipants of our user study is likely biased towards technologically
savvy users, our results are consistent with Snyder et al. [16] who
found that cookie-stufﬁng was a very small percentage of the HTTP
trafﬁc of a large public university.
5. CONCLUSION
In this study we characterized the abuse of afﬁliate marketing for
monetary gains through the use of techniques broadly classiﬁed as
cookie-stufﬁng. Overall, even through targeted crawling of domains
with higher likelihood of encountering afﬁliate fraud, we observed
only a limited amount cookie-stufﬁng in our study.
Most merchants interested in afﬁliate marketing have a choice
to either run their own afﬁliate programs, or join a large afﬁliate
network with thousands of other merchants and afﬁliates. Since af-
ﬁliate networks have a larger number of merchants, they provide
greater opportunity to fraudulent afﬁliates to simultaneously target
multiple merchants. In fact, of the afﬁliate fraud we did identify,
we observed that large afﬁliate networks are targeted disproportion-
ately more compared to the merchant-run afﬁliate programs who
are targeted to a smaller extent, but through more sophisticated and
costly cookie-stufﬁng techniques such as the use of intermediate
domains to obfuscate the cookie-stufﬁng domains. These results
suggest that the in-house afﬁliate programs are better placed to po-
lice their afﬁliate programs due to greater visibility into the afﬁli-
ate activities and the revenue ﬂow, and possibly shorter turnaround
time to take action against a fraudulent afﬁliate upon detection.
However, running an in-house afﬁliate program requires expertise
and cost investment not necessary for outsourcing the logistics of
running an afﬁliate program to an existing network.
Finally, we conducted a user study to determine the extent of
afﬁliate marketing encountered by users during their daily Web
browsing. We found that a small number of afﬁliates dominate af-
ﬁliate marketing, and, as with the crawling results, our users rarely
encountered cookie-stufﬁng fraud.
Acknowledgements
We thank our shepherd Paul Barford for his help with improving the
paper, and the anonymous reviewers for their valuable feedback.
We are also grateful to all the users of the AffTracker extension
without whom our user study would not have been possible. We are
in debt to Cindy Moore for her help in setting up the affiliatet
racker.ucsd.edu domain, and to Tristan Halvorson for manag-
ing the ˙COM zone ﬁle data. This work was supported by National
Science Foundation grant NSF-1237264 and by generous research,
operational and/or in-kind support from Google, Microsoft, Yahoo,
and the UCSD Center for Networked Systems (CNS).
466. REFERENCES
[1] Alexa. Does Alexa have a list of its top-ranked websites?
https://support.alexa.com/hc/en-us/
articles/200449834-Does-Alexa-have-a-lis
t-of-its-top-ranked-websites-.
[2] Amazon. Associates Program Advertising Fee Schedule.
https://affiliate-program.amazon.com/gp/
associates/help/operating/
advertisingfees.
[3] Amazon. Associates Program Participation Requirements.
https://affiliate-program.amazon.com/gp/
associates/help/operating/participation/.
[4] Civil Cover Sheet.
http://www.benedelman.org/affiliate-litig
ation/ebay-digitalpoint-hogan-kessler-t
hunderwood-dunning-complaint.pdf#page=8,
2008.
[5] Digital Point. Cookie Search. https://
tools.digitalpoint.com/cookie-search.
attachments/press-releases/
ftc-publishes-final-guides-governing-end
orsements-testimonials/
091005revisedendorsementguides.pdf.
[10] HostGator. Afﬁliate Terms of Service. http://
www.hostgator.com/tos/affiliate-tos.
[11] A. Kapravelos, C. Grier, N. Chachra, C. Kruegel, G. Vigna,
and V. Paxson. Hulk: Eliciting Malicious Behavior in
Browser Extensions. In Proceedings of the 23rd USENIX
Security Symposium, 2014.
[12] V. I. Levenshtein. Binary Codes Capable of Correcting
Deletions, Insertions, and Reversals. In Soviet Physics
Doklady, 1966.
[13] T. Moore and B. Edelman. Measuring the perpetrators and
funders of typosquatting. In Financial Cryptography and
Data Security, 2010.
[14] Mozilla Developer Network. The X-Frame-Options response
header. https://developer.mozilla.org/en-US/
docs/Web/HTTP/X-Frame-Options.
[6] B. Edelman. Afﬁliate fraud litigation index. http://
[15] mThink. The Top 20 Afﬁliate Networks 2014.
www.benedelman.org/affiliate-litigation/,
2015.
http://mthink.com/
the-top-20-affiliate-networks-2014.
[7] B. Edelman and W. Brandi. Risk, Information, and
[16] P. Snyder and C. Kanich. No Please, After You: Detecting
Incentives in Online Afﬁliate Marketing. In Journal of
Marketing Research, 2014.
[8] J. Edwards. How eBay Worked With The FBI To Put Its Top
Afﬁliate Marketers In Prison.
http://finance.yahoo.com/news/
ebay-worked-fbi-put-top-120500693.html,
2013.
[9] Federal Trade Commission. Guides Concerning the Use of
Endorsements and Testimonials in Advertising.
https://www.ftc.gov/sites/default/files/
Fraud in Afﬁliate Marketing Networks. In Proceedings of the
Workshop on the Economics of Information Security (WEIS),
2015.
[17] The Economist. Pay Per Sale.
http://www.economist.com/node/4462811.
[18] The New York Times. Surviving the Dark Side of Afﬁliate
Marketing. http://www.nytimes.com/2013/12/05/
business/smallbusiness/surviving-the-dar
k-side-of-affiliate-marketing.html.
47