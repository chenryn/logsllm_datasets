**Title: Practical Experience: Methodologies for Measuring Route Origin Validation**

**Authors:**
- Tomas Hlavacek
- Amir Herzberg
- Haya Shulman
- Michael Waidner

**Affiliations:**
- §Fraunhofer Institute for Secure Information Technology SIT, Darmstadt, Germany
- †University of Connecticut, U.S.

**Abstract:**
Route Origin Validation (ROV) is essential for filtering BGP announcements that contradict Route Origin Authorizations (ROAs), thereby protecting against BGP prefix hijacks. Recent studies have quantified ROV-enforcing Autonomous Systems (ASes) using control-plane experiments. However, this work demonstrates that such experiments do not provide accurate information about ROV-enforcing ASes. We introduce data-plane approaches to evaluate ROV in the Internet and conduct both control and data-plane experiments using various data acquisition sources. Our analysis and correlation of results identify the number of ASes enforcing ROV, and thus protected by RPKI. Simulations with identified ROV-enforcing ASes show that their impact on Internet security against prefix hijacks is negligible. We provide recommendations to address the main factors hindering the widespread adoption of ROV.

**1. Introduction**
The Border Gateway Protocol (BGP) has a long history of prefix hijacks due to benign misconfigurations and malicious attacks, leading to service failures, outages, and traffic interception [1], [2], [3], [4], [5], [6]. These incidents significantly impact the stability and security of Internet services and clients. The importance of BGP and its inherent insecurity have driven multiple efforts to develop defenses. The IETF designed and standardized the Resource Public Key Infrastructure (RPKI) [7] to allow networks to authenticate their prefixes. RPKI deployment involves two complementary processes: issuing Route Origin Authorizations (ROAs) and performing Route Origin Validation (ROV). ROAs bind IP address blocks to owner ASes, specifying which ASes are authorized to originate routes for a given IP prefix. BGP routers then use ROAs to filter routing announcements that violate these authorizations, detecting and suppressing prefix hijacks. In addition to preventing prefix hijack attacks, RPKI forms the basis for other BGP security proposals [8], [9], [10], [11].

Despite RPKI's importance for Internet security and extensive efforts to promote its deployment, adoption is slow, leaving networks vulnerable to traffic hijacks and outages due to misconfigurations and malicious attacks. Significant efforts focus on understanding the BGP security landscape, evaluating RPKI deployment (i.e., the prefixes with ROA objects and ROV-enforcing ASes), and identifying obstacles to wide adoption [12], [13], [14].

Quantifying prefixes with ROA objects is straightforward, as they are published in public RPKI repositories. The number of ROAs and their growth rate are publicly known. While ROA adoption is progressing slowly, there is a steady increase, particularly in the RIPE NCC service region, which leads in the growth of public ROA repositories. Recent measurements show that about 6.5% of IP prefixes advertised in BGP are covered by ROAs [15], [16]. Unfortunately, a large fraction of these ROAs are erroneous [17], [18], [13], often causing ASes to lose legitimate traffic and discouraging ROV enforcement. How many ASes are actually performing ROV?

Evaluating ROV adoption is challenging. How can one measure remotely whether an AS in the Internet performs ROV without direct access to its network or routers? Several studies have examined the implications of enforcing ROV locally [17], [18], [19], [14], suggesting that deploying ROV can disrupt legitimate traffic. A recent study [13] used passive observation of existing BGP paths from multiple vantage points of 19 RouteViews [20] collectors to provide an upper bound on non-ROV-enforcing ASes. This approach, based on observations of invalid prefix propagation, estimated that 9 out of the top 100 ASes might be enforcing ROV. However, this method relied on uncontrolled experiments using only BGP announcements generated by other ASes, resulting in limited coverage and high false positives.

A subsequent study [21] argued that uncontrolled experiments cannot differentiate between various causes of invalid route filtering, such as traffic engineering. To address this, [21] proposed controlled experiments using BGP announcements and ROAs, combined with control-plane observations from RouteViews [20] and RIPE RIS [22] vantage points, and found fewer ASes performing ROV than [13].

Our work builds on these previous efforts to evaluate ROV adoption. We demonstrate that previous methods relying solely on BGP data from a limited set of RouteViews collectors [20] do not accurately measure ROV deployment. We perform an in-depth evaluation using both control and data-plane measurements with a more diverse set of collectors. Our results show significant discrepancies, indicating that reliance on RouteViews collectors can be misleading. Unfortunately, our findings suggest that ROV deployment has an even lower impact than previously thought, with most ASes and Internet users remaining vulnerable to prefix hijack attacks.

**2. Contributions**
In this work, we explore ROV adoption in the Internet through controlled experiments combining control and data plane routing information. We also conduct two additional data collection experiments measuring real Internet routing and compare the results. Our findings reveal discrepancies between the ROV percentage observed at vantage points and actual Internet routing, indicating that vantage points often provide only a partial view. Our results paint a grim picture of BGP security, showing that the number of ASes enforcing ROV is smaller than previously reported [13], [21]. Using these results, we perform simulations to demonstrate the scale of insecurity to prefix hijacks and provide recommendations to address erroneous ROAs and motivate more ASes to enforce ROV.

**3. Organization**
- **Section II**: Methodology
- **Section III**: Control-Plane Analysis
- **Sections IV and V**: Data-Plane Approaches and Experimental Evaluations
- **Section VI**: Comparison of Results
- **Section VII**: Impact of Current ROV Adoption and Recommendations
- **Section VIII**: Conclusion

**II. Evaluation Methodology**
We developed two new data-plane approaches to evaluate ROV enforcement and conducted two new experiments based on these approaches. The first approach (Section IV) uses traceroute evaluations with RIPE Atlas, and the second (Section V) uses TCP connection establishment to 1.25M-top Alexa web servers [23]. We also ran a control-plane experiment (Section III) following the approach in [21] to validate our setup and results. Control-plane experiments with RouteViews and RIPE RIS, while low in noise and bad paths, are less accurate than our data-plane approaches. Specifically, control-plane experiments produce overly positive results that do not reflect the true state of ROV deployment.

Our study was conducted over five months, from February 2017 to June 2017, based on a controlled IPv4 prefix hijacking experiment. We announced two beacon prefixes, P1 (188.227.158.0/24) and P2 (188.227.159.0/24), from two distinct, geographically separated, and carefully selected ASes, A1 (AS29134) and A2 (AS378). Both prefixes and ASNs are assigned to organizations operating in the RIPE NCC service region. We created ROAs for the experimental prefixes and ASNs in the RIPE-hosted RPKI system according to the following schedule:

| Measurement Period | Published ROAs |
|--------------------|-----------------|
| February 2017 - May 2017 | ρ1 = {(P1, A1), (P2, A2)} |
| June 2017 | ρ2 = {(P1, A2), (P2, A1)} |

**III. Control-Plane Analysis**
This approach, used by [13] for an uncontrolled experiment and later by [21] for a controlled experiment, involves propagating valid and invalid (contradicting ROAs) BGP announcements in the Internet and analyzing which routes vantage points choose for the announced prefixes. We performed a similar experiment with active, controlled manipulation of BGP announcements and ROAs, limited to control-plane observations. During the experiment, we issued BGP announcements for the controlled prefixes, and Figure 1 illustrates the basic propagation pattern of our beacon prefix pairs in the Internet. The experiment uses two nearly identical prefixes from the same origin, as both are likely to propagate similarly. Any differences in propagation could indicate manual interventions or ROV filtering. We obtained and analyzed BGP table dumps in MRT format ([RFC6396] [24]) from public BGP collectors, including RIPE RIS and Route Views Project.

**A. Experimental Evaluation**
All available paths X = {Πi|∀i} consisting of prefix and AS-path: Πi = (pi, πi), were gathered from the vantage point BGP table dumps. Paths for our beacon prefixes P1 and P2, XP1,P2 = {Πi|∀i, pi = P1 ∨ pi = P2}, were selected. Each AS-path π = (a1, a2, ..., an) from XP1,P2 was categorized according to the route origin compliance with the relevant ROA. The path can be either valid or invalid with respect to the currently published ROA. We define a validity symbol v(Π, ρ) for path Π and ROA set ρ as follows:

\[ v(Π, ρ) = \begin{cases} 
1 & \text{if } Π = (p, π), π = (a1, a2, ..., an) \land (p, an) \in ρ \\
0 & \text{otherwise}
\end{cases} \]

All paths Π from XP1,P2 and the values v(Π, ρ) were collected in both measurement time frames, ρ1 (February 2017 - May 2017) and ρ2 (June 2017). This data yielded groups of ASNs falling into the following categories:

1. ASN a that occurs in a path invalid with respect to a valid ROA: ∃Π = (p, π), a ∈ π ∧ v(Π, ρ) = 0, ρ ∈ {ρ1, ρ2}.
2. ASNs a that occur only in paths Π = (p, π), a ∈ π compliant to ROA v(Π, ρ) for ρ ∈ {ρ1, ρ2}.
3. ASNs a that satisfy condition (2) and have seen paths {(P1, (. . . , a, . . .))ρ1, (P2, (. . . , a, . . .))ρ1, (P1, (. . . , a, . . .))ρ2, (P2, (. . . , a, . . .))ρ2} ⊆ X traversing a for both prefixes P1, P2 in both time frames ρ1, ρ2.
4. ASNs a that satisfy condition (2) and have seen at least two of four paths (P1, (. . . , a, . . .))ρ1, (P2, (. . . , a, . . .))ρ1, (P1, (. . . , a, . . .))ρ2, (P2, (. . . , a, . . .))ρ2 traversing a for at least one prefix of P1, P2 in two different time frames ρ1, ρ2.

The first case indicates that an AS a is not filtering out prefixes that fail ROA validation. However, it is still possible that the AS could be de-prioritizing non-compliant paths if an alternative compliant path is not available. The second case contains ASes that consistently follow ROA validation, providing a more accurate picture of ROV enforcement.