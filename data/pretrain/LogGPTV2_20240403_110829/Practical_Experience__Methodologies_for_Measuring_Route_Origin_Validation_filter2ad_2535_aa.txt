title:Practical Experience: Methodologies for Measuring Route Origin Validation
author:Tomas Hlavacek and
Amir Herzberg and
Haya Shulman and
Michael Waidner
2018 48th Annual IEEE/IFIP International Conference on Dependable Systems and Networks
Practical Experience:
Methodologies for Measuring Route Origin Validation
Tomas Hlavacek§, Amir Herzberg†, Haya Shulman§, Michael Waidner§
§Fraunhofer Institute for Secure Information Technology SIT
Darmstadt,Germany
†University of Connecticut, U.S.
Abstract
Performing Route Origin Validation (ROV) to ﬁlter
BGP announcements, which contradict Route Origin
Authorizations (ROAs) is critical for protection against
BGP preﬁx hijacks. Recent works quantiﬁed ROV
enforcing Autonomous Systems (ASes) using control-
plane experiments.
In this work we show that control-plane experi-
ments do not provide accurate information about ROV-
enforcing ASes. We devise data-plane approaches for
evaluating ROV in the Internet and perform both control
and data-plane experiments using different data acquisi-
tion sources. We analyze and correlate the results of our
study to identify the number of ASes enforcing ROV,
and hence protected with RPKI.
We perform simulations with the ROV-enforcing
ASes that we identiﬁed, and ﬁnd that their impact on
the Internet security against preﬁx hijacks is negligible.
As a countermeasure we provide recommendations how
to cope with the main factor hindering wide adoption
of ROV.
I. Introduction
The Internet’s routing infrastructure with Border Gate-
way Protocol (BGP) has a long history of BGP preﬁx
hijacks due to benign misconﬁgurations and malicious
attacks, causing failures, outages and trafﬁc intercep-
tion, e.g. [1], [2], [3], [4], [5], [6].
BGP preﬁx hijacks have detrimental impact on stabil-
ity and security of the Internet services and clients. The
signiﬁcance of BGP along with its insecurity generated
multiple efforts to devise defenses. To allow networks to
authenticate their preﬁxes the IETF designed and stan-
dardized Resource Public Key Infrastructure (RPKI) [7].
RPKI deployment consists of two complementary pro-
cesses: Issuing Resource Origin Authorizations (ROAs)
and performing Route Origin Validation (ROV). ROAs
bind IP address blocks to owner ASes, listing which
2158-3927/18/$31.00 Â©2018 IEEE
DOI 10.1109/DSN.2018.00070
634
ASes are authorised to originate routes for a given IP
preﬁx. BGP routers then perform ROV using ROAs in
order to ﬁlter routing announcements that violate the
ROAs. This allows to detect and suppress IP preﬁx
hijacks, in which an attacker or a misconﬁgured BGP
router announces an IP address block that belongs to
another AS. In addition to preventing preﬁx hijack
attacks RPKI also forms a basis for other BGP security
proposals, such as [8], [9], [10], for preventing more
advanced and sophisticated attacks, such as path ma-
nipulation,
[11].
Despite RPKI’s importance for Internet security and
extensive efforts to push its deployment forward, its
adoption is progressing slowly and the networks are still
exposed to trafﬁc hijacks and outages due to miscon-
ﬁgurations and malicious attacks. Signiﬁcant efforts are
focused on understanding the security landscape of BGP
and on evaluating the deployment of RPKI (i.e., the
preﬁxes with ROA objects and ROV enforcing ASes),
and identifying obstacles towards its wide adoption [12],
[13], [14].
Quantifying preﬁxes for which ROA objects were
created is easy,
they are published in public RPKI
repositories. Therefore, the number of ROAs and its
growth rate are publicly known. Adoption of ROAs is
progressing slowly yet there is a steady increase in the
number of certiﬁed resources, most notably in RIPE
NCC service region, which is leading the growth of pub-
lic ROA repositories. Recent measurements show that
about 6.5% of IP preﬁxes advertised in BGP are covered
by ROAs [15], [16] but unfortunately, a large fraction of
those ROAs are erroneous, [17], [18], [13]. Erroneous
ROAs often cause ASes to lose legitimate trafﬁc, hence
demotivating enforcement of ROV ﬁltering. How many
ASes are performing ROV?
In contrast to measuring ROA growth rate, evaluating
ROV adoption is a challenging task. How can one
measure remotely whether some AS in the Internet
performs ROV without having presence on that AS
nor having access to the routers on the network of the
AS? A number of studies evaluated the implications of
enforcing ROV locally on their own networks, [17],
[18], [19], [14], and suggested that deploying ROV
is likely to cause disruption of legitimate trafﬁc. A
recent study [13] examined ROV adoption in the In-
ternet by a passive observation of existing BGP paths
from multiple vantage points of 19 RouteViews [20]
collectors and provided an upper bound on non-ROV
enforcing ASes. The approach in [13] is based on
observations of invalid preﬁx propagation in the Internet
and measurements of ROV enforcement by leveraging
valid BGP announcements as well as invalid ones, i.e.,
those that contradict ROAs. The study then checked for
ASes that are on the paths towards the valid preﬁx but
not on paths of the invalid preﬁx, hence concluding
that those ASes ﬁlter invalid routes with ROV. Their
ﬁndings showed that most large ASes did not deploy
ROV and they estimated that 9 out of the top 100
ASes could potentially be enforcing ROV. The study
in [13] was based on uncontrolled experiments using
control-plane data with only the BGP announcements
that were generated by other ASes, none of which
actively participated in the measurements. As a result
the experiment could only provide partial information
about the propagation path and even less information
on the factors causing the propagation patterns, hence
resulting in limited coverage and high false positives.
A subsequent study [21] argued that with uncon-
trolled experiments one cannot differentiate between
the different causes for ﬁltering of the invalid routes,
and that often ﬁltering of an invalid route is applied
not due to ROV enforcement but also due to other
factors, such as trafﬁc engineering. To address this
concern, [21] describes an approach for performing
controlled experiments using BGP announcements and
ROAs in combination with control-plane observations
using RouteViews [20] and RIPE RIS [22] vantage
points, and shows that the number of ASes performing
ROV is smaller than the number that was found by [13].
Our work is inspired by these previous efforts to
evaluate ROV adoption. We show that
the previous
methods do not accurately measure ROV deployment
in the Internet, since these previous works solely relied
on the BGP data from the (limited) set of RouteView
collectors [20]. We perform an in depth evaluation by
using, in addition to control-plane, also data-plane mea-
surements. Furthermore, we use a signiﬁcantly larger
and more diverse set of collectors. Our results show sig-
niﬁcant differences, and indicate that complete reliance
on the RouteView collectors can be quite misleading.
Unfortunately, our results indicate that ROV de-
ployment has an even lower impact than is expected
based on previous works. Our results show that a vast
majority of the ASes and of Internet users are not
taking advantage of ROV and are hence vulnerable to
preﬁx hijack attacks. This is demonstrated with our
experiments where we propagate incorrect BGP an-
nouncements (contradicting ROAs) which are accepted
by most of the networks.
Contributions. In this work we explore ROV adop-
tion in the Internet. We perform controlled experiments
and combine control and data plane routing information.
Furthermore, in addition to the experiments performed
in [13], [21] we perform two additional data collection
experiments measuring real routing on the Internet, then
compare and analyze the results. Our results show that
there are discrepancies between the ROV percentage
observed in vantage points and the real routing in the
Internet, and that vantage points often do not reﬂect
the accurate Internet routing but provide only a partial
view. Our results portray a gloomy illustration of BGP
security: the number of ASes enforcing ROV is smaller
than was found in [13] and even smaller than in
[21]. Using these results we perform simulations to
demonstrate the scale of insecurity to preﬁx hijacks.
We provide recommendations for coping with erroneous
ROAs, to motivate more ASes to enforce ROV.
Organisation. In Section II we present our methodol-
ogy. We initiate with an active controlled control-plane
experiment in Section III. Then in Sections IV and V we
present our new approaches for ROV evaluation using
data-plane, and describe the experimental evaluations
based on them, along with the results. In Section VII we
discuss the impact of the current ROV adoption on In-
ternet security against BGP preﬁx hijacking and provide
recommendations for countermeasures. We compare the
results obtained from the three different approaches in
Section VI and conclude this work in Section VIII.
II. Evaluation Methodology
We devised two new approaches using data-plane for
evaluating enforcement of ROV and performed two
new experiments based on our approaches. The ﬁrst
approach (Section IV) is based on traceroute evaluations
with RIPE Atlas and the second (Section V) is with
TCP connection establishment to 1.25M-top Alexa web
servers [23]. We also ran a control plane experiment
(Section III) following an approach in [21] in order to
validate our setup and results. Control-plane experiment
with RouteViews and RIPE RIS is the only method
that was used in prior work – it results in low noise
and no bad paths. In RIPE Atlas traceroute and TCP
probing experiments there are inverted paths (with dif-
ference in routing opposite to ROAs), furthermore, the
measurements result in signiﬁcant noise, hence require
ﬁltering out randomness from the data. Our work shows
635
that although control plane experiments are easier to
launch, they are less accurate than our two new data-
plane approaches and hence inferior. Speciﬁcally, the
control-plane experiment produces results which are too
positive and do not reﬂect the state of ROV deployment
in the Internet.
Our study was performed over the period of ﬁve
months, between February 2017 and June 2017, and
is based on a controlled IPv4 preﬁx hijacking exper-
iment. During all the experiments we announce two
beacon preﬁxes P1 ≡ 188.227.158.0/24 and P2 ≡
188.227.159.0/24. Both preﬁxes were announced
from two distinct, geographically separated and metic-
ulously selected Autonomous Systems (ASes) A1 ≡
AS29134 and A2 ≡ AS378. The preﬁxes P1,P2 and
the Autonomous Systems Numbers (ASNs) A1,A2 are
assigned to organizations that operate in RIPE NCC
service region.
We created ROAs for the experimental preﬁxes and
ASNs in RIPE hosted RPKI system in each evaluation
batch according to the following table:
Measurement period
February 2017 - May 2017
June 2017
ρ1 = {(P1,A1), (P2,A2)}
ρ2 = {(P1,A2), (P2,A1)}
We next describe the approaches and the results from
Published ROAs
the experimental evaluations.
III. Control-Plane Analysis
In this approach, used by [13] for an uncontrolled
experiment, and later by [21] for a controlled experi-
ment, valid and invalid (contradicting the ROAs) BGP
announcements are propagated in the Internet. Analysis
is then performed to check which routes the vantage
points choose for the announced preﬁxes. We perform
a similar experiment with active controlled manipulation
of BGP announcements and of ROAs. This experiment,
similarly to [13], [21], is limited to the control-plane
observations. During the experiment we issue BGP an-
nouncements for preﬁxes we control; Figure 1 illustrates
the elementary propagation pattern of our beacon preﬁx
pairs in the Internet. The experiment uses two almost
identical preﬁxes from the same origin, since both are
likely to be propagated in the same way. Therefore,
any differences in the propagation could indicate either
manual interventions to the BGP best path selection
algorithm or may be consequences of ROV ﬁltering. To
ﬁnd the alteration in the path propagation we obtain and
analyze BGP table dumps in MRT format ([RFC6396]
[24]) from public BGP collectors - RIPE RIS and Route
Views Project.
636
Fig. 1: Control-plane experiment
A. Experimental Evaluation
All available paths X = {Πi|∀i} each consisting of
preﬁx and AS-path: Πi = (pi,πi), are gathered from
the vantage point BGP table dumps. The paths for our
={Πi|∀i, pi = P1∨ pi = P2}
beacon preﬁxes P1,P2: XP1,P2
are selected. AS-path π = (a1,a2, . . . ,an) from each path
in XP1,P2 has to be obtained and categorized according to
the route origin an compliance to the relevant ROA. The
path can be either valid or invalid with respect to the
currently published ROA. We deﬁne a validity symbol
for path Π and ROA set ρ.
if Π = (p,π),π = (a1,a2, . . . ,an)∧
∧(p,an) ∈ ρ
otherwise
v(Π,ρ) =
⎧⎨
1
⎩
0
All paths Π from XP1,P2 and the values v(Π,ρ) were
collected in both measurement time frames ρ1 (February
2017 - May 2017) and ρ2 (June 2017). This data yields
groups of ASNs that falls into the following categories:
(1) ASN a that occur in a path that is invalid with
respect to a valid ROA: ∃Π = (p,π),a ∈ π ∧ v(Π,ρ) =
0,ρ ∈ {ρ1,ρ2}.
(2) ASNs a that occur only in paths Π = (p,π),a ∈ π
that are compliant to ROA v(Π,ρ) for ρ ∈ {ρ1,ρ2}.
(3) ASNs a that satisfy the condition (2) and we have
seen paths {(P1, (. . . ,a, . . .))ρ1, (P2, (. . . ,a, . . .))ρ1,
(P1, (. . . ,a, . . .))ρ2, (P2, (. . . ,a, . . .))ρ2} ⊆ X
that tra-
verses a for both preﬁxes P1,P2 in both time frames
ρ1,ρ2.
(4) ASNs a that satisfy the condition (2) and we
have seen at least two of four paths (P1, (. . . ,a, . . .))ρ1,
(P2, (. . . ,a, . . .))ρ1, (P1, (. . . ,a, . . .))ρ2, (P2, (. . . ,a, . . .))ρ2
that traverses a for at least one preﬁx of P1,P2 in two
different time frames ρ1,ρ2.
ρ1,ρ2
P1,P2
The ﬁrst case indicates that an AS a is not ﬁltering
out preﬁxes that fail ROA validation. Nonetheless, it
is still possible that
the AS could be de-preferring
the non-compliant paths and the alternative compliant
path was not available. The second case contains the