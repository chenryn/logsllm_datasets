### 文档使用授权
本文件的使用权限仅限于清华大学。下载时间：2021年3月20日 09:59:20 UTC，来源于IEEE Xplore。使用受限制。

### 图2. 原始AS分布
横轴：CDF  
纵轴：原始AS的数量

### 图3. 直接子前缀数量
横轴：CDF  
纵轴：子前缀数量

### 图4. 聚合/解聚合持续时间
横轴：CDF  
纵轴：持续时间（分钟）  
图例：聚合、解聚合

### 表2. 前缀所有者Ri的协议
1. **哈希链初始化**  
   对于Ri的每个邻居，发送 (hn(sp))k−i。
2. **前缀公告**
   - 如果新前缀p没有覆盖前缀，公告 (p, hn−1(sp))。
   - 否则，找到p的直接覆盖前缀ˆp，发送公告 (p, hn−1(sp), hcˆp−1(sˆp))。
3. **更改原点AS**  
   Ri宣布新的原点AS，并发送 (p, hc−1(sp)) 和新的原点AS。
4. **撤销**  
   撤销前缀p及其最新的哈希链值hc(sp)，发送撤销消息 (p, hc−1(sp))。

### 协议的基本思想
我们的协议利用单向哈希链的轻量级安全属性来验证任何路由通告中的原点与公告前缀之间的关联。首先，决定部署此方案的AS需要以安全方式将哈希链的初始值传播给其他AS。初始化过程完成后，原点AS开始用其最新哈希值公告前缀。每个接收者通过附加的哈希值验证路由是否来自先前认证的原点。

### 更新哈希值的情况
- 前缀的原点AS发生变化。
- 其中一个子前缀被首次公告。
- 前缀完全撤销。

正常撤销和由于中间AS在备选路径之间切换引起的公告会重用相同的哈希值，因为这些变化不涉及原点的变化。

### 表3. 接收者Ri+1的协议
1. **哈希链初始化**  
   接收前缀p的初始值，验证并存储 ((hn(sp))k−i)k+i。签名并发送 (hn(sp))k−i+1。存储 hn(sp)。
2. **前缀公告**  
   接收带有 hc(sp) 的前缀p的公告。
   - 如果p已在路由表中且原点AS未改变，接受。
   - 如果p存在但原点AS改变且 h(hc(sp)) == 存储的 p，接受。存储 hc(sp) 在路由表中。
   - 如果p是现有ˆp的新子前缀且具有相同原点，接受。存储 hn−1(sp) 在路由表中。
   - 如果p是现有ˆp的新子前缀且具有不同原点AS且 h(hc(sˆp)) == 存储的 ˆp，接受。存储 hc(sˆp) 和 hn−1(sp) 在路由表中。
   - 否则，拒绝。
3. **撤销**  
   接收带有 hc(sp) 的前缀p的撤销。
   - 如果撤销包含更新的 hc(sp) 且 h(hc(sp)) == 存储的 p，接受。存储 hc(sp) 在路由表中。
   - 否则，拒绝。
   - 如果撤销带有旧哈希值，接受。

### 详细步骤
1. **哈希链初始化**  
   每个前缀都有一个初始值。原点AS需要安全地将其初始值传播给其他AS。假设相邻的eBGP对等路由器可以轻松交换密钥，使用带外机制建立对等会话。初始值在参与的相邻路由器之间逐跳传播。对于由AS Ri拥有的每个前缀，Ri首先分配一个初始哈希链值，然后使用 k−i 加密后传播给其邻居。邻近路由器Ri+1首先使用Ri的公钥解密，存储哈希值，用自己的密钥加密后再进一步传播。这是每个起始前缀的一次性开销。当哈希链值耗尽时，再次进行初始化。
   
2. **前缀公告**  
   如果前缀以相同的原点AS作为先前更新或子前缀以相同的原点AS作为其覆盖前缀公告，则不需要更新哈希链。但在以下两种情况下需要更新哈希链：
   - 原点AS改变。
   - 新子前缀公告。

3. **撤销**  
   撤销通常由于瞬时故障或路由收敛而频繁发生。大多数撤销是由路径上的瞬时故障引起的。对于这些瞬时撤销，不需要更新哈希链，因为瞬时故障不由原点AS引起或控制。在一个场景下需要更新哈希值：当原点AS Ri决定长期撤销现有前缀p时（例如，由于聚合或更换提供商），它需要包括更新后的哈希值。这可以防止攻击者在长期撤销后使用Ri作为原点AS和旧哈希值来公告p。

### 高级协议：HC-BGP公告中的部分排序
基本协议有两个安全漏洞：
1. 初始化期间，攻击者可以修改从其邻居收到的初始值。
2. 传播哈希链值更新期间，攻击者可以篡改该值，也可以通过将其自身AS作为原点来重放该值。

我们提出了一种部分排序算法，可以有效防止这些情况。以重放攻击为例，该算法也可用于防止初始化期间的攻击。

### 定理
如果BGP系统中的所有AS都遵循该指南，则除了攻击者及其客户外，每个AS只接受来自AS0的Up。

### 证明
我们使用三个引理来证明该定理：
- 引理1：在网络拓扑中，对于任何ASi，存在一条形式为 [(Customer→Provider)*(Peer→Peer)?] 的路径从ASi到其中一个Tier-1 AS。
- 引理2：每个AS都会接收到Up。可达性不受影响。
- 引理3：每个AS只接受来自AS0的Up。恶意路由不会被除攻击者及其直接客户外的任何网络接受。

### 总结
通过遵循这些指南，我们可以确保哈希链值的安全传播，并防止重放攻击和其他相关攻击。虽然这些指南引入了一些额外的路由传播延迟，但我们认为这不是严重问题，因为这些事件并不经常发生。

---

以上是对原文本的优化，使其更加清晰、连贯和专业。希望对你有帮助！