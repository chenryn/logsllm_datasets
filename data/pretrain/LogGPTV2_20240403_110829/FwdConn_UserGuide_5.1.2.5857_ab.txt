| 1 2 | |Pre-Installation Summary |
| 1 2 | |Installing... || 1 2 | |Installing... |
When installation of the connector core component is complete, the following dialog is displayed:
12 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector ArcSight Confidential
1 Overview and Installation
| 3 | Choose your ArcSight Forwarding Connector destination. | Choose your ArcSight Forwarding Connector destination. | Choose your ArcSight Forwarding Connector destination. ||---|---|---|---|
| 3 | |To forward events to an ArcSight Manager, proceed with “Forwarding Events to an ArcSight Manager” on page 15. |To forward events to an ArcSight Manager, proceed with “Forwarding Events to an ArcSight Manager” on page 15. |
| 3 | |To forward events to an ArcSight Logger, proceed with “Forwarding Events to ArcSight Logger” on page 19. |To forward events to an ArcSight Logger, proceed with “Forwarding Events to ArcSight Logger” on page 19. || 3 | |To forward events to an NSP appliance, proceed with “Forwarding Events to NSP Device Poll Listener” on page 20. |To forward events to an NSP appliance, proceed with “Forwarding Events to NSP Device Poll Listener” on page 20. |
| 3 | |To forward events to a CEF Syslog, proceed with “Forwarding CEF Syslog Events” on page 21. |To forward events to a CEF Syslog, proceed with “Forwarding CEF Syslog Events” on page 21. || 3 | |To forward events to a .csv file, proceed with “Forwarding Events to a CSV File” on page 22. |To forward events to a .csv file, proceed with “Forwarding Events to a CSV File” on page 22. |
| 3 | |To forward events to McAfee ePolicy Orchestrator (ePO), proceed with “Forwarding Events to McAfee ePolicy Orchestrator” on page 23.  |To forward events to McAfee ePolicy Orchestrator (ePO), proceed with “Forwarding Events to McAfee ePolicy Orchestrator” on page 23.  || 3 | | |Use of ePO requires installation of MSSQL Server 2005 for JDBC driver. For instructions on downloading, see “Installing the Microsoft SQL Server 2005 Driver for JDBC” on page 24. |
|  | | |Use of ePO requires installation of MSSQL Server 2005 for JDBC driver. For instructions on downloading, see “Installing the Microsoft SQL Server 2005 Driver for JDBC” on page 24. ||  | |For detailed configuration instructions on forwarding events to HP Operations Manager (HP OM), see Chapter 3‚ Configuration for HP Operations Manager‚ on page 29. |For detailed configuration instructions on forwarding events to HP Operations Manager (HP OM), see Chapter 3‚ Configuration for HP Operations Manager‚ on page 29. |
Uninstalling a ConnectorUninstalling a Connector
Before uninstalling a connector that is running as a service or daemon, first stop the service or daemon. To uninstall on Windows, open the Start menu. Run the Uninstall SmartConnectors program located under All Programs, ArcSight SmartConnectors. 
If Connectors are not installed on the Start menu, locate the $ARCSIGHT_HOME\UninstallerData folder and run:
Uninstall ArcSightAgents.exeUninstall ArcSightAgents.exe
To uninstall on UNIX hosts, open a command window on the 
$ARCSIGHT_HOME/UninstallerData directory and run the command:
./Uninstall_ArcSightAgents
 The UninstallerData directory contains a file .com.zerog.registry.xml with Read, Write, and Execute permissions for everyone. On Windows platforms, these permissions are required for the uninstaller to work. However, on UNIX platforms, you can change the permissions to Read and Write for everyone (that is, 666).The Uninstaller does not remove all the files and directories under the ArcSight SmartConnector home folder. After completing the uninstall procedure, manually delete these folders. 
Upgrading a Connector
To locally upgrade the Forwarding Connector:
| 1 | Stop the running connector.  | Stop the running connector.  |
|---|---|---||---|---|---|
| 2 |Run the new installer for the ArcSight Forwarding Connector, which prompts you for an installation location.  |Run the new installer for the ArcSight Forwarding Connector, which prompts you for an installation location.  |
| ArcSight Confidential |ArcSight Confidential |SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 13 |
1 Overview and Installation1 Overview and Installation
3 Select the location of the Forwarding Connector you want to upgrade; you will receive the message “Previous Version Found - Upgrade Possible” Select the option to continue and upgrade the connector. 
The original installation is renamed by prefacing characters to the original folder name; the upgraded connector is installed in the location 
$ARCSIGHT_HOME\currentDuring upgrade, the "Default User Groups" user group is updated and adds the /All Filters/ArcSight System/Core/No Events filter to the events ACL. If the Forwarding Connector user is in that group, the connector cannot send events to the destination Manager. To prevent this problem, edit the access control for the Forwarding Connector's parent user group and select a filter that gives permission to the subset of events for which the user has access.Alternatively, if the user has access to all the events, delete the /All Filters/ArcSight System/Core/No Events filter.
 The ArcSight Forwarding Connectors must be of the same version as the source ESM.
Rolling Back a Connector
To roll back a connector:
| 1 | Stop the upgraded connector, which is under current. | Stop the upgraded connector, which is under current. | Stop the upgraded connector, which is under current. ||---|---|---|---|
| 2 |Rename the current folder to a name based upon the build version of the upgraded connector. |Rename the current folder to a name based upon the build version of the upgraded connector. |Rename the current folder to a name based upon the build version of the upgraded connector. |
| 3 |Rename the old connector build folder to current. |Rename the old connector build folder to current. |Rename the old connector build folder to current. || 4 |Start the connector. |Start the connector. |Start the connector. |
|  | |Rolling back the connector to build 5116 or earlier disallows use of the McAfee ePolicy Orchestrator destination. |Rolling back the connector to build 5116 or earlier disallows use of the McAfee ePolicy Orchestrator destination. || 14 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |14 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |14 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |ArcSight Confidential |
Chapter 2 Configuration for Forwarding Events
This chapter provides step-by-step instructions for configuring various ForwardingConnector destinations. The following destinations are described.
“Forwarding Events to an ArcSight Manager” on page 15
“Forwarding Events to ArcSight Logger” on page 19
“Forwarding Events to NSP Device Poll Listener” on page 20
“Forwarding CEF Syslog Events” on page 21
“Forwarding Events to a CSV File” on page 22
“Forwarding Events to McAfee ePolicy Orchestrator” on page 23“Configuring Multiple Destinations” on page 26
Forwarding Events to an ArcSight Manager
To continue connector configuration for forwarding events to an Manager, follow the procedure below.
To continue connector configuration:
1 	Select ArcSight Manager (encrypted), and click Next.
| 2 | The Wizard first prompts you for Manager certificate information. | The Wizard first prompts you for Manager certificate information. ||---|---|---|
|  | |The default is No, the ArcSight Manager is not using a demo certificate. |
| ArcSight Confidential |ArcSight Confidential |SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 15 |
2 Configuration for Forwarding Events
 Choose Yes if ArcSight Manager is using a demo certificate.Before selecting this option, make sure the Manager is, in fact, using a demo SSL certificate. If you are unsure, select No or consult your system administrator. 
If your ArcSight Manager is using a self-signed or CA-signed SSL certificate, select No, the ArcSight Manager is not using a demo certificate and click Next.|  |  | After completing the SmartConnector installation wizard, remember to configure the connector for the type of SSL certificate your Manager is using manually. Refer to the Administrator's Guide for your ESM version for instructions about configuring your SmartConnector when the  |
|---|---|---||  |Manager is using a self-signed or CA-signed certificate, and for  instructions about enabling SSL client authentication on SmartConnectors so that the connectors and the Manager authenticate each other before sending data. |Manager is using a self-signed or CA-signed certificate, and for  instructions about enabling SSL client authentication on SmartConnectors so that the connectors and the Manager authenticate each other before sending data. || 3 |You are prompted for Manager Host Name and Manager Port. This is your destination Manager. Enter the information and click Next. |You are prompted for Manager Host Name and Manager Port. This is your destination Manager. Enter the information and click Next. |
| 4 | Enter a valid ArcSight User Name and Password and click Next.  | Enter a valid ArcSight User Name and Password and click Next.  ||---|---|---|
| 16 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |16 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |ArcSight Confidential |
2 Configuration for Forwarding Events
This is the user name and password for the user account you created on the 
destination Manager.destination Manager.
| 5 | You are given a choice of Forwarding Connector versions to install. If you are currently using ESM v4.0 SP3 or later, ArcSight recommends choosing the ArcSight 
Forwarding Connector (Enhanced) option. When choosing which version to use, note the following:  | You are given a choice of Forwarding Connector versions to install. If you are currently using ESM v4.0 SP3 or later, ArcSight recommends choosing the ArcSightForwarding Connector (Enhanced) option. When choosing which version to use, note the following:  |
|---|---|---|
| 5 | |The ArcSight Forwarding Connector option supports the previous software version and does not include the increased event rate and recoverability features of ArcSight Forwarding Connector (Enhanced). ArcSight recommends using the older option only when communicating with a pre-v4.0 SP3 ESM installation. || 5 | |Neither Forwarding Connector release is FIPS compliant. If you require FIPS compliance, retain your current Forwarding Connector version. |
| 5 | |The capacity of events that can be stored during a system failure is dependent on the FileStore size of your source Manager. Choosing the ArcSight Forwarding Connector (Enhanced) version requires configuration adjustments on your source Manager. |For instructions on how to determine and change your source disk settings, see 
“Increasing the FileStore size (Enhanced version only)” on page 11. Click Next.
ArcSight Confidential SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 17
2 Configuration for Forwarding Events
6 Enter the information to configure the Forwarding Connector, then click Next to continue. This is information about your source Manager, as described in the table below.Parameter Description
ArcSight Source 
Manager Hostname
ArcSight Source 
Manager Port
ArcSight Source 
Manager User Name
ArcSight Source 
Manager Password
Hostname where the ArcSight Source Manager is installed.
Network Port where the ArcSight Source Manager is accepting requests.
The ArcSight user name created with permissions for the Forwarding Connector on the ArcSight Source Manager.ArcSight's password that will be used to log this Connector into the ArcSight Source Manager.
|  |  |
|---|---|
| 7  8  9 |Enter a name for the connector and provide other information identifying the connector's use in your environment. Click Next. Read the connector summary; if it is correct, click Next. If the summary is not correct, click Previous to make changes before continuing. When the connector completes its configuration, click Next. The wizard now prompts you to choose whether you want to run the connector as a process or as a service. If you choose to run the connector as a service, the wizard prompts you to define service parameters for the connector. |10 After making your selections, click Next. The wizard displays a dialog confirming the 	connector's setup and service configuration.
11 Click Finish.
12 Click Done. 
18 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector ArcSight Confidential
2 Configuration for Forwarding Events
Forwarding Events to ArcSight LoggerForwarding Events to ArcSight Logger
 When configuring the Forwarding Connector to send events to a non-ESM destination, you might encounter problems with certificate validation during connector setup. See “Sending Events to a Non-ESM Location” on page 7 for information on certificate validation.Before you continue connector configuration for forwarding events to an ArcSight Logger, ensure that a SmartMessage Receiver has been set up on ArcSight Logger for the Forwarding Connector (Refer to the ArcSight Logger Administrator's Guide for details).
To continue connector configuration:
1 	Select ArcSight Logger SmartMessage (encrypted) from the following dialog:2 Enter the Logger Host Name/IP address, leave the port number at the default value of 443, and enter the Receiver Name. This Receiver Name is the name of the SmartMessage Receiver you set up on ArcSight Logger for the Forwarding Connector. Click Next to continue.| 3 | Click Next and continue following the steps to complete your configuration. Refer to the Parameters  on page 18 for parameter descriptions. When a message confirms that configuration was successful, click Finish to exit the wizard. | Click Next and continue following the steps to complete your configuration. Refer to the Parameters  on page 18 for parameter descriptions. When a message confirms that configuration was successful, click Finish to exit the wizard. ||---|---|---|
| ArcSight Confidential |ArcSight Confidential |SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 19 |
2 Configuration for Forwarding Events
Forwarding Events to NSP Device Poll Listener
 When configuring the Forwarding Connector to send events to a non-ESM destination, you might encounter problems with certificate validation during connector setup. See “Sending Events to a Non-ESM Location” on page 7 for information on certificate validation.To continue connector configuration for forwarding events to NSP:
1 	Select NSP Device Poll Listener from the selections and click Next.
2 Provide the NCM/TRM Host name or IP address, and login credentials for the NCM/TRM that will interact with the Syslog Connector
3 Click Next and continue following the steps to complete your configuration until a message confirms that it was successful. Click Finish to exit the wizard.For more information about NSP, refer to the ArcSight™ NSP Installation and Administration 
Guide.
20 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector ArcSight Confidential
2 Configuration for Forwarding Events
Forwarding CEF Syslog Events 
	You can also configure the ArcSight Forwarding Connector to send CEF Syslog events to 
any Syslog receiver (including ArcSight Logger.)When configuring the Forwarding Connector to send events to a non-ESM destination, you might encounter problems with certificate validation during connector setup. See “Sending Events to a Non-ESM Location” on page 7 for information on certificate validation.
To configure the connector to send CEF Syslog events:
1 	Select CEF Syslog from the following window:2 Enter the Logger hostname or IP address, the desired port, and choose UDP or TCP output. Click Next to continue.
| 3 | Click Next and continue following the Configuration Wizard to complete your configuration until a message confirms that it was successful. Click Finish to exit the wizard. | Click Next and continue following the Configuration Wizard to complete your configuration until a message confirms that it was successful. Click Finish to exit the wizard. ||---|---|---|
| ArcSight Confidential |ArcSight Confidential |SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 21 |
2 Configuration for Forwarding Events
Forwarding Events to a CSV File 
	This option allows you to capture events a SmartConnector would normally send to the 
ArcSight Manager and send them to a .csv file. The Excel-compatible comma-separatedvalues (CSV) format allows for comments prefixed by #.
 When configuring the Forwarding Connector to send events to a non-ESM destination, you might encounter problems with certificate validation during connector setup. See “Sending Events to a Non-ESM Location” on page 7 for information on certificate validation.
To forward events to a .csv file:
1 	Select CSV File and click Next.1 	Select CSV File and click Next.
2 	For these options, enter values as described in the table below.
| Parameter | Description | Description |
|---|---|---|
| CSV Path |The path to the output folder. If one does not exist, a  |The path to the output folder. If one does not exist, a  |
| folder is created. |folder is created. |folder is created. || 22 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |22 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |ArcSight Confidential |
2 Configuration for Forwarding Events
| Parameter | Description |
|---|---|
| Fields |A comma-delimited string of field names to be sent to the .csv file. Field names are in the form  event.. |
File rotation intervalFile rotation interval
Write format header
The desired file rotation interval, in seconds. The default is 3,600 (one hour).
Select true to send a header row with labels for each column, as described above.
3 Click Next and continue following the steps to complete your configuration until a message confirms that it was successful. Click Finish to exit the wizard.For more information about capturing events and .csv files, refer to the section titled “Capturing Events from SmartConnectors (ESM v4.0)” in the SmartConnector User’s Guide.
Forwarding Events to McAfee ePolicy Orchestrator 
This option allows you to forward events to McAfee ePolicy Orchestrator (ePO), a scalable tool for centralized anti-virus and security policy management and enforcement. ePO leverages ESM event filtering/correlation and auditing capabilities to create a single view into security events within ePO.McAfee ePO v4.0 and v4.5 are supported currently.
 Use of ePO requires installation of MSSQL Server 2005 for JDBC driver. For instructions on downloading, see “Installing the Microsoft SQL Server 2005 Driver for JDBC” on page 24.
To forward events to McAfee ePO:
1 On the destination selection window displayed, select McAfee ePolicy Orchestrator and click Next.|  | When using this transport, the Forwarding Connector is automatically configured to limit the outgoing event rate to 10 events per minute. This is due to a limitation on McAfee ePO’s database as specified by McAfee. |