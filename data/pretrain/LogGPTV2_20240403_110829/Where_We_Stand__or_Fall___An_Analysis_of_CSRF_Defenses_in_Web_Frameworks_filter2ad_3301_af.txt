129
60
77
77
1.5k
542
452
49.1k
41.7k
29.5k
12.5k
21.4k
14.7k
5.1k
4.1k
8.1k
51k
50.4k
19.2k
6.9k
3.7k
7.9k
224
1.4k
749
1.9k
59.9k
26k
10.7k
8.2k
5.7k
18k
1.4k
13.3k
10.2k
1.1k
38k
11.6k
8.8k
767
1.6k
7.7k
5.4k
304
1k
513
606
606
18.1k
4.8k
7.1k
8.1k
5.1k
2.8k
1.3k
1.9k
1k
632
440
451
13.6k
21.8k
5.4k
1.3k
865
791
84
88
67
836
18.8k
7.6k
1.9k
3.4k
2.8k
7.9k
294
6.9k
1.9k
243
25.7k
3.9k
1.5k
361
730
3.2k
1.1k
166
671
339
290
290
5.1k
1.6k
1.5k
Table 6: Official and unofficial external libraries implement-
ing CSRF defenses.
Language Web Framework
JavaScript Express v4.17.1
Python
Java
PHP
Library
csurf v1.11
koa-csrf v3.0.8
crumb v8.0
fastify-csrf v1.0.3
shield v3.0
flask-wtf v0.14.3
bottle-utils v2.0
zope.formlib v4.7.1
Koa v2.12
Hapi v19.1.1
Fastify v2.14.1
AdonisJs v0.9
Flask v1.1.2
Bottle v0.12
Zope v4.2
TurboGears v2.4.1 tgext.utils v0.0.3
Spring v5.2.6
Spark v3.0
Symfony v5.0.8
Slim v4.0
Spring Security v5.2.1
pac4j v4.0.2
security-csrf v5.1
Slim-Csrf v1.0
Legend:
red = unofficial external library;
384RAID ’21, October 6–8, 2021, San Sebastian, Spain
Xhelal Likaj, Soheil Khodayari, and Giancarlo Pellegrino
Table 9: Summary of vulnerability disclosure
Token Gen. Token Leakage Cookie
Integrity
Implementation Mistakes
s
s
e
n
m
o
d
n
a
R
n
e
k
o
T
s
s
e
n
m
o
d
n
a
R
y
e
K
.
.
ff
u
s
n
I
ff
u
s
n
I
s
s
e
n
m
o
d
n
a
R
e
r
u
c
e
s
n
I
s
e
i
r
a
r
b
i
L
o
t
p
y
r
C
.
l
n
u
V
e
g
a
k
a
e
L
r
e
r
r
e
f
e
R
H
C
A
E
R
B
.
f
n
o
C
S
R
O
C
.
m
r
e
p
-
r
e
v
O
.
p
m
C
n
o
s
k
c
a
t
t
A
g
n
m
T
i
i
g
n
i
p
p
a
M
n
e
k
o
T
e
r
u
c
e
s
n
I
k
c
e
h
c
.
t
e
M
P
T
T
H
e
f
a
S
w
o
fl
r
e
v
O
r
a
J
e
i
k
o
o
C
g
n
i
s
s
o
T
e
i
k
o
o
C
k
c
e
h
c
.
t
e
M
P
T
T
H
e
f
a
s
n
U
e
d
i
r
r
e
v
O
d
o
h
t
e
M
P
T
T
H
s
r
o
r
r
E
l
a
c
i
g
o
L
k
c
e
h
C
.
g
i
r
O
/
.
f
e
R
y
t
l
u
a
F
g
n
i
k
c
a
j
i
H
S
W
S
X
k
c
a
t
t
A
y
a
l
p
e
R
Table 8: Mapping between web frameworks and CSRF de-
fenses they implement.
k
c
e
h
C
r
e
d
a
e
H
n
i
g
i
r
O
/
r
e
r
e
f
e
R
s
n
o
i
s
s
e
S
r
e
s
U
s
s
e
l
-
e
i
k
o
o
C
r
e
d
a
e
H
t
s
e
u
q
e
R
m
o
t
s
u
C
n
o
i
t
a
c
i
t
n
e
h
t
u
a
-
e
R
n
e
k
o
T
e
m
T
-
e
n
O
i
s
t
u
o
g
o
l
t
n
e
u
q
e
r
F
s
e
i
k
o
o
c
e
t
i
S
e
m
a
S
A
H
C
T
P
A
C
)
e
r
(
n
e
k
o
T
d
e
t
p
y
r
c
n
E
n