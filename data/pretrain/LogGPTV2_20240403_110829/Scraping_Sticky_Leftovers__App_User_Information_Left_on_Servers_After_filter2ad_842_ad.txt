3
1
2
3
const−string v3, ”birthday”
......
invoke−interface {v1, v3, v4}, Landroid/content/
SharedPreferences$Editor;→ putString(Ljava/lang/
String;Ljava/lang/String;)Landroid/content/
SharedPreferences$Editor;
const−string v3, ”gender”
......
invoke−interface {v1, v3, v4}, Landroid/content/
SharedPreferences$Editor;→ putString(Ljava/lang/
String;Ljava/lang/String;)Landroid/content/
SharedPreferences$Editor;
As there is no AM delete operation, Fdp = Fdc = ∅. Finally,
the LAI is: Fr = (Fap + Fac) − (Fdp + Fdc) = {name, email,
password, birthday, gender}.
7. Leftover Account Cleaner
Account cleanup is a substantial user burden if it has to be
performed on dozens of uninstalled apps. To study the feasi-
bility of “automatic cleaning” we built LeftoverAccountCleaner,
a tool that helps Android users automatically delete leftover
accounts after app uninstall. LeftoverAccountCleaner runs on a
laptop, connected to the phone via adb.
The approach has three steps. First, LeftoverAccountCleaner
ﬁnds uninstalled apps as the set difference between the apps
in the account history on Google Play Store and the apps
currently installed on the phone (the account history records
all apps downloaded by the user, including the apps that have
been uninstalled). Second, LeftoverAccountCleaner re-installs the
uninstalled app by downloading it from Google Play.5 Third,
LeftoverAccountCleaner deletes the leftover account incurred by
the formerly-installed apps by logging-in, ﬁnding ADF, and
5. In our experiments, the same version of an uninstalled app was available
on Google Play. If an uninstalled app is an older version compared to the
current version on Google Play, retrieving and installing the older version
does not pose a substantial challenge, as in that case the older app version is
available on app mirroring sites, e.g., https://www.apkmirror.com/.
ﬁnally deleting the account, leveraging some LeftoverAccount-
Analyzer modules (Section 6).
8. Implementation
Our toolchain is implemented in Python, Java, and shell
script – about 6,000 LOC in total. The toolchain relies on
several “enabler” tools and libraries. To decode and rebuild
APK ﬁles, we employ apktool [3], a tool for reverse engi-
neering third-party, closed-source Android apps. As important
strings can be stored in images, we use Tesseract OCR [11]
to convert all images embedded in app screens and web pages
into strings. We use Screaming Frog [9] to crawl both static
and dynamic web content. We leverage the Appium mobile
automator [4] for UI and user interaction automation. We
employ NLTK [2] to support natural language processing. To
enable static data ﬂow analysis (i.e., def-use chain analysis),
we have modiﬁed Flowdroid [19]. To intercept and log AM
calls we built an LAI Monitor (described in Section 13.1) that
leverages the Xposed Framework [15] to “hook” Android API
functions.
9. Evaluation
We now present the results of a study of LAI issues, as well
as an evaluation of our toolchain. We start by describing the
dataset and test environment. Next, we present the high-level
ﬁndings (Section 9.1). Finally, we evaluate our approach along
two dimensions – effectiveness (Section 9.2) and efﬁciency
(Section 9.3).
Dataset. We started with 1,435 APKs from Google Play
Store and 771 corresponding websites; some apps do not have
websites. We only selected Android apps with a high number
of installs (more than 500K). The set was chosen to cover a
wide range of categories (Sports, Business, Communication,
Health and Fitness, Education, Games, etc.) and includes both
free and paid apps. Among the 1,435 apps, 938 apps require
user information when creating accounts (the other 497 do not
require sign-in); of those 938 apps, 260 use third-party sign-
in. Therefore, we focused on the remaining 678 apps which
use their own accounts and collect user information. The 188
apps used in the pilot study are not included in the 1,435-app
dataset.
Environment. Our testing environment consisted of: an In-
tel Xeon server (36 logical cores@4.3 GHz, 128GB RAM;
Ubuntu 18.04) where we ran the ADF analysis; 2 MacBook
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:00:26 UTC from IEEE Xplore.  Restrictions apply. 
92153
TABLE 6: Statistics on the 678-apps Dataset.
App Info
LAI remains on servers
after uninstallation
after account deletion
ADF buttons
app & website
in-app only, not on website
on website only, not in-app
no ADF buttons
Count Percentage
254
17
38
116
87
437
37.46%
2.5%
5.6%
17.11%
12.83%
64.45%
TABLE 7: Account
columns) or collected (last column).
information retained (LAI, middle
LAI Category
#Apps with
LAI After
Uninstallation
Government ID
Banking Info.
Password
Last Name
First Name
User Name
Phone
Email
ZIP Code
Location (address
or GPS)
Photo
Gender
Weight
Height
Age
Social Network
Language
6
49
218
101
107
66
181
230
27
210
89
80
25
41
82
180
73
#Apps with
LAI After
Account
Deletion
0
4
15
7
7
6
11
16
0
15
3
6
3
3
9
10
7
#Non-
ADF
Apps
12
94
418
202
210
135
352
437
48
423
189
139
51
66
148
357
140
Pro laptops (core i5, 8GB RAM) used to conﬁgure the Appium
server and to run LAI analysis as well as the LeftoverAccount-
Cleaner; and 2 Android phones (4 ARM PI:EMAIL GHz, 2GB
RAM, 16GB storage, Android 6.0).
9.1. High-level Findings
The high-level ﬁndings are shown in Table 6: 254 apps
(37.46%) have LAI after app uninstallation; 17 apps (2.5%)
have LAI after account deletion; and 437 apps (64.45%) offer
no ADF functionality at all. We believe that keeping LAI after
deletion, as well as not offering users a ‘Delete Account’
option are substantial reasons for concern. These ﬁndings
corroborate our pilot study’s ﬁndings (Table 1).
9.2. Effectiveness
This section discusses the effectiveness of, and analysis
results for, each of the four tools in our toolchain.
9.2.1. Leftover Account Analyzer. This analyzer infers the
information left on the servers, i.e., LAI. Table 7 shows the
number of apps that our analysis ﬂags as leaving sensitive
information after app uninstallation; after account deletion;
and information collected by apps that do not offer ADF
(discussed in Section 9.2.2). Certain LAI categories consist of
related ﬁelds grouped together, e.g., ‘Government ID’ (SSN,
driver license number, employee IDs) and ‘Banking Informa-
tion’ (credit card number, CVV number, payment methods,
transaction details, billing information).
LAI after uninstallation. As shown in the second column
of Table 7, a large number of apps have LAI after app uninstal-
lation. While some apps keep LAI in the name of convenience,
e.g., users might want to “re-activate” their account, a clear
retention policy should still be in place to indicate for how
long data is retained. We found that email and password
are the most common types of leftover information (230
apps require email, 218 apps require a password), followed
by location (210), social network proﬁles (181), and phone
number (180). Government IDs and banking information are
the least common, but the most sensitive LAI: 6 apps require
driver license (or social security numbers) and 49 apps require
banking information (credit card number, payment method,
billing address).
Some notable apps which have LAI after app uninstallation
include: Microsoft Word (email address), Spotify (social network
accounts), WhatsApp (phone numbers), AdobePhotoshop (edited
photos), eHarmony (spoken languages), McDonald’s (GPS loca-
tion), MyFitnessPal (weight and ZIP code).
LAI after account deletion. The third column of Table 7
shows that email, password, (and concerningly) location and
social network proﬁles, are the most frequent LAI left after
account deletion – more than 10 apps kept this information
post-account deletion. We veriﬁed whether apps retained data
in two scenarios. First, for apps without a retention period
(Table 8) we deleted the accounts on 02.01.20, then checked
for LAI on 02.26.20 and again on 07.10.20. Second, for apps
with a retention period (Table 9) we deleted some accounts on
02.01.20, some on 02.20.20, then checked for LAI after the
longest possible retention period had ended: on 04.16.20 and
again on 07.10.20.
As shown in Tables 8 and 9, 17 apps (2.5%) have LAI
even after account deletion. Of the 17 apps, 15 have more
than 1M installs. Apps in Table 8 do not specify a retention
period, but never truly remove account information even after
contacting their customer support, e.g., the OLIO app. Apps
in Table 9 have a speciﬁed retention period (7 minutes–30
days). However, when we rechecked the apps after the periods
expired, the accounts were still not deleted, which violates
users’ trust and the app’s own policy.
We contacted the companies whose apps appear in Table 8
and Table 9 by a variety of means: ‘Live chat’, ‘Contact’ form,
and email. Most companies have agreed to remove the leftover
account data. One company (Fitbit) informed us that they would
like to keep a part of the user data. Finally, some companies
have asked us to ﬁrst submit ofﬁcial identiﬁcation documents
(passport, driving license) before proceeding to remove data.
9.2.2. Account Deletion Analyzer. Ground Truth was ob-
tained via manual analysis on the 678 apps, which involved
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:00:26 UTC from IEEE Xplore.  Restrictions apply. 
102154
TABLE 8: Apps WITHOUT a Speciﬁed Retention Period.
Package Name
com.bandainamcoent.google.pac
com.olioex.android
com.discord
com.bearpty.talklife
com.myﬁtnesspal.android
com.relayrides.android.relayrides
com.ehi.enterprise.android
com.tophatter
com.etsy.android.soe
com.magix.android.mmjam
com.mercariapp.mercari
br.com.pinion
com.sarahah.com
#Installs
Account
Deletion
5M 02/01/2020
1M 02/01/2020
50M 02/01/2020
500K 02/01/2020
50M 02/01/2020
1M 02/01/2020
1M 02/01/2020
10M 02/01/2020
1M 02/01/2020
10M 02/01/2020
10M 02/01/2020
1M 02/01/2020
1M 02/01/2020
Checked
On
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
02/26/2020
Rechecked
On
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
07/10/2020
Data Retained
(or other LAI Conﬁrmation)
email, password
customer support has not deleted the account
still able to restore account
email, password