• Additionally, CSME has supported a TCG compliant TPM2.0 HW starting in 2015.
• It has been our goal to make this the most capable and feature‐rich TPM2.0 on the 
market.
• In order to compete with discrete TPM devices, physical attack mitigations, like the 
TRC, are required.
• Fault‐Injection Attack Basics
• Dive to the TRC (Tunable Replica Circuit)
• Why and How Intel Integrated of the TRC
• TRC Calibration and Validation
• Conclusions and Productization
Calibrating the TRC to Detect an Attack
• Circuits fail timing at a specific point on a Voltage/Frequency curve.
• At a fixed frequency, we know what voltage the circuits will fail.  
• This point is called vGlitch, calculated using pre and post‐silicon data.
vGlitch is global to each product
• TRC calibration is the act of converting vGlitch to a TRC delay and fusing that 
configuration into silicon.
• To ensure the calibration is correct, a sample of parts from multiple process 
corners are fused and run through false‐positive and fault‐injection testing.
• If any parts fail either test, the recipe is modified, and the process starts over.
• Once no failures occur, the calibration determined to be correct and high‐volume 
manufacturing can begin.
TRC Waveforms and Calibration
D
Q
CLK
D
Q
CLK
error
trc_input_clk
TRC Launch FF
TRC Capture FF
trc_data_ref
trc_data_actual
trc_input_clk
trc_data_ref
This is the Delay, corresponding to vGlitch, that is fused into each part
Pop‐Quiz:
Identify the Delay that corresponds to vGlitch
trc_data_actual
How is the Per‐Part vGlitch Delay Found?
1. At first‐silicon we calculate the slope 
associated with a Voltage/Delay curve, 
common to all parts.
2. In HVM (high‐volume manufacturing) each 
part’s TRC outputs to HVM testers the TRC 
delay at nominal voltage.
3. Using the Voltage/Delay slope, testers 
calculate the TRC delay (for each part) at 
vGlitch (using the below equation) and fuse 
this into silicon.
vGlitchDelay = vNomDelay – (vGlitch / Slope)
• (vGlitch / Slope) is a constant
• vNomDelay is per‐part data, captured in HVM
X‐Axis = Voltage
Y‐axis =
Delay
Value
vNom
vGlitch
Slope
vNom
Delay
vGlitch
Delay,  
Fused
Pop Quiz: What is wrong with the 
graph?
Delay Decreases, not Increases with 
Voltage
X‐Axis = Voltage
Delay Value
vNom
vGlitch
vNom
Delay
vGlitch
Delay
Fault‐Injection Testing
FI voltages are driven from a generator for varying 
pulse‐widths.
The band of red X’s highlights the TRC’s detection 
capability. 
The region of functionality before the SoC crashes is 
where an FI exploit will focus, as the objective is to 
change the state of the system without crashing. 
It is critical the red X band be present, proving the TRC 
is calibrated to detect voltage glitches before they 
begin crashing the SoC.
As can be seen, in the first pass of testing, the TRC 
missed some glitches.
TRC Calibration Tuning
The TRC failed initial testing; the red X band did not 
exist at every glitch length, indicating that the 
calibrated delay code was set too low. 
To fine tune the calibration we repeated the glitch 
scan, schmooing the delay codes. 
For a given glitch length, the width of the red X band 
was measured and plotted, as shown.
The initial delay code was 84.
Increasing the delay from 84 to 92 allowed the TRC 
to detect glitches in a larger range for a given glitch 
length.
There was no meaningful detection capability when 
going to a delay of 96.
• Fault‐Injection Attack Basics
• Dive to the TRC (Tunable Replica Circuit)
• Why and How Intel Integrated of the TRC
• TRC Calibration and Validation
• Conclusions and Productization
Testing Results and Productization
• From these (second pass) results we determined the initial batch of TRCs 
were calibrated too conservatively with vGlitch too low.
• Accordingly, we modified the value of vGlitch.
• New parts were calibrated, fused and (once again) sent through false‐
positive and FI testing. 
• This time, the TRC detected attacks at all glitch lengths while recording no 
false‐positives.
• Based on this data, we locked in this new calibration recipe for all 12th Gen 
Intel® Core™ (ADL) silicon and committed the TRC to high‐volume 
manufacturing.
Riscure Engagement
• To further gain confidence in the TRC and gain additional insight into FI testing, we 
contracted with Riscure to evaluate the TRC.
• We submitted multiple 12th Gen Intel® Core™ parts with the TRC to Riscure for 
clock, voltage and EMFI testing.
• In the end, Riscure was unable to successfully execute a FI attack against CSME, 
concluding, “In all cases the successful glitches were detected by the implemented 
countermeasures”
Acknowledgements
Thanks to the engineers who contributed to the TRC at Intel!
• Matias Leonetti 
• Swetha Basani 
• Parthiv Trivedi
• Sivakumar Ramakrishnan
• Joseph Friel
• Mohamad Faiz Mohd Faridh
• Nanda G Kumar Kalavai
• Masahide Kakeda
• Avinash Varna 
• Habib Shawal
Source Citations
GIF citations:
• Slide #3
• Lightning GIF, from ‐ https://an‐crazy.tumblr.com/post/65952328112
• Big Ben GIF, from ‐ https://gifs.alphacoders.com/gifs/view/75109
• Magneto GIF, from ‐ https://media.giphy.com/media/xTiQyrLULEB9EBfAwo/giphy.gif
• Fire GIF, from ‐ https://tenor.com/search/louise‐fire‐gifs
• Slide #4
• Cat lasers GIF, from ‐ https://www.wearepercolate.com/
• Slide #5:
• Will Smith Slap GIF, from ‐ https://www.xavierdegraux.be/
• Slide #6:
• Muppet Fire GIF, from ‐ https://tenor.com/search/beaker‐fire‐gifs
Legal Disclaimer
Intel provides these materials as‐is, with no express or implied warranties. 
All products, dates, and figures specified are preliminary, based on current expectations, and are subject to 
change without notice. 
Intel, processors, chipsets, and desktop boards may contain design defects or errors known as errata, which 
may cause the product to deviate from published specifications. Current characterized errata are available on 
request. 
Intel technologies' features and benefits depend on system configuration and may require enabled hardware, 
software or service activation. Performance varies depending on system configuration. No product or 
component can be absolutely secure. Check with your system manufacturer or retailer or learn more at 
https://www.intel.com. 
Some results have been estimated or simulated using internal Intel analysis or architecture simulation or 
modeling, and provided to you for informational purposes. Any differences in your system hardware, software 
or configuration may affect your actual performance. 
Intel and the Intel logo are trademarks of Intel Corporation in the United States and other countries. 
*Other names and brands may be claimed as the property of others. 
© Intel Corporation