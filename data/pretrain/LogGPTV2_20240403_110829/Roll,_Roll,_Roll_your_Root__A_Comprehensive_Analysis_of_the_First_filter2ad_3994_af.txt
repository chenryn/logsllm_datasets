due to validators lacking permission to persist state to disk, or
loss of state due to, e.g. container or virtual machine teardown
and reinitialisation. The latter issue has the potential to become a
bigger problem moving forward, as the proliferation of container
technologies was not envisioned when RFC 5011 was authored
11 years ago. Lastly, we are also beginning to see DNSSEC validation
in end user applications (e.g. the VPN client from Section 4.1.2),
often with hard-coded trust anchors (a search on GitHub yields
thousands of examples of this). This raises the question if in-band
updates through RFC 5011 remain the main means for trust anchor
management going forward.
As noted earlier, some resolver implementations distribute trust
anchors in their software packages (thus these get refreshed with
software updates). While this works to some extent, it does not scale
to encompass applications performing validation. Additionally, we
observed that there may be significant delays when retiring trust
anchors, as evidenced by the surprising comeback of KSK-2010.
Based on these results, we advocate that the preferred method
to distribute trust anchors should be with operating systems out-of-
band. Some distributions (e.g. Debian Linux) have already started
doing so. Applications can then rely on the OS and we strongly
urge against hard-coding of trust anchors. In addition to this, OS
distributors should tightly manage these trust anchors when they
are replaced. In Section 4.3.4, we ended with the question if the
retention of the retired KSK-2010 was problematic. On the face of
it, the answer to this question is “No”, since the key was retired
according to a schedule, and all copies of the key have now been
destroyed. Consider, however, two scenarios, one in which a key is
revoked because it has been compromised, and one in which the
algorithm for the key has been compromised. It is evident that a
speedy retraction of such a key as a trust anchor is imperative, and
it is also evident that the current practice we observed does not
suffice. Given the inertia of solving this issue Internet-wide, we
would recommend an additional security practice: if a key needs to
be revoked, then the root DNSKEY RRset should include the revoca-
tion signal until there is a reasonable certainty that systems have
been updated to remove the trust anchor. This practice guarantees
that software that correctly implements RFC 5011 will not use the
compromised key as a trust anchor.
7 CONCLUSIONS
In this paper we provide a comprehensive analysis of the very first
DNSSEC Root KSK Rollover. We show the rollover did not pass
without problems: hundreds of actively used resolvers failed to
validate signatures at some point during the rollover. Nevertheless,
this is only a minute share of the total resolver population and most
problems were fixed quickly. Additionally, thousands of resolvers
exhibit anomalous behavior during the rollover process, though it
remains unclear if this caused problems for end users. The signif-
icant traffic increase to root servers, seen after the revocation of
KSK-2010 requires attention from the DNS community with future
rollovers in mind. We demonstrated that at least some of these
queries can likely be attributed to bugs in resolver software.
We also demonstrate that telemetry, used to measure deployment
of new keys, was significantly distorted by a single application
(a VPN client). We analyzed a complementary protocol, which
while potentially a valuable addition, still has drawbacks. Based
on our experiences, we provide recommendations for incremental
improvements to both protocols. In addition to this, we observe
that trust anchor distribution — which the rollover design team
expected to happen mostly in-band — requires attention for future
rollovers, and provide recommendations for alternatives.
While, of course, our work focused heavily on anomalies, our
analysis supports ICANN’s conclusion that the rollover was indeed
an overall success. As with earlier changes to the root system, some
systems will fail and this study shows that the Root KSK rollover
was no different. These failures, however, were limited to a very
small set of resolvers and got fixed fast, limiting the impact. This
gives us confidence that this first ever rollover certainly should not
be the last.
Finally, taking a step back from the specifics of the DNS, there
are valuable lessons to be learned from this event that apply much
more broadly to Internet protocols. Firstly, the experience with this
event shows that telemetry is a key factor in the understanding of,
and decision-making for, major changes to the Internet. The event
is also demonstrative of the well-known inertia of the installed base
of networking software across the Internet that hampers the deploy-
ment of such telemetry enhancements, and underlines what others
in the network research community have argued about making
measurability an explicit concern when designing protocols [56].
Second, there are lessons to be drawn about trust anchor manage-
ment. The more different places in which trust anchors are stored
(i.e. in different applications and services), the harder it becomes to
predictably manage them. We posit that trust anchors should prefer-
ably be managed centrally, in the OS. While not a perfect solution,
it limits the risk of hard-coded or mismanaged trust anchors. This
is a lesson that equally applies to other Public Key Infrastructures.
ACKNOWLEDGEMENTS
The authors would like to thank the following organisations (in
alphabetical order): Amazon, DNS-OARC, ICANN, NIC.at, OVH,
Purdue University, RIPE and SURFnet. Furthermore, we would like
to thank Anna Sperotto, Evan Hunt, our shepherd Matthew Luckie,
Ondřej Surý, and the anonymous IMC reviewers. This research was
supported in part by NSF grants CNS-1850465, CNS-1901090 and
EC H2020 Project CONCORDIA GA 830927.
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Müller et al.
REFERENCES
[1] IANA. DNSSEC Practice Statement for the Root Zone KSK Operator. https:
//www.iana.org/dnssec/dps/ksk-operator/ksk-dps.txt, 2016.
[2] KSK Rollover Design Team. Root Zone KSK Rollover Plan. https://www.iana.org
/reports/2016/root-ksk-rollover-design-20160307.pdf, 04 2016.
[3] D. Wessels, W. Kumari, and P. Hoffman. Signaling Trust Anchor Knowledge in
DNS Security Extensions (DNSSEC). RFC 8145 (Proposed Standard), April 2017.
Updated by RFC 8553.
[4] ICANN. KSK Rollover Postponed. https://www.icann.org/news/announcemen
t-2017-09-27-en, 2017.
[5] ICANN Board. Board Approval of KSK Roll. https://www.icann.org/resources/pr
ess-material/release-2018-09-18-en, 2018.
[6] ICANN. Review of the 2018 DNSSEC KSK Rollover. https://www.icann.org/en/s
ystem/files/files/review-2018-dnssec-ksk-rollover-04mar19-en.pdf, 03 2019.
[7] Ramaswamy Chandramouli and Scott Rose. Secure Domain Name System (DNS)
Deployment Guide. NIST Special Publication, 800, September 2006.
[8] Verisign DNSSEC PMA. DNSSEC Practice Statement for the Root Zone ZSK
Operator. https://www.iana.org/dnssec/dps/zsk-operator/dps-zsk-operator-v2.0.
pdf, 2017.
[9] NTIA. NTIA Announces Intent to Transition Key Internet Domain Name Func-
tions. https://www.ntia.doc.gov/press-release/2014/ntia-announces-intent-trans
ition-key-internet-domain-name-functions, 2014.
[10] ICANN. Operational Plans for the Root KSK Rollover. https://www.icann.org/re
sources/pages/ksk-rollover-operational-plans, 2016–2018.
[11] Gijs Van Den Broek, Roland van Rijswijk-Deij, Anna Sperotto, and Aiko Pras.
DNSSEC Meets Real World: Dealing with Unreachability Caused by Fragmenta-
tion. IEEE Communications Magazine, 52(4):154–160, 6 2014.
[12] Christian Kreibich, Nicholas Weaver, Boris Nechaev, and Vern Paxson. Netalyzr:
Illuminating the Edge Network. In Proceedings of ACM IMC 2010, pages 246–259.
ACM, 2010.
[13] M. StJohns. Automated Updates of DNS Security (DNSSEC) Trust Anchors. RFC
5011 (Internet Standard), September 2007.
[14] J. Abley, J. Schlyter, G. Bailey, and P. Hoffman. DNSSEC Trust Anchor Publication
for the Root Zone. RFC 7958 (Informational), August 2016.
[15] NLnet Labs. Man-Page: Unbound Anchor. https://www.nlnetlabs.nl/documenta
tion/unbound/unbound-anchor/.
[16] Moritz Müller, Matthew Thomas, Duane Wessels, Wes Hardaker, Taejoong Chung,
Willem Toorop, and Roland van Rijswijk-Deij. Roll Roll Roll Your Root: Accom-
panying Data Sets. https://github.com/SIDN/RollRollRollYourRoot.
[17] Internet Assigned Numbers Authority (IANA). Root Servers. https://www.iana.o
rg/domains/root/servers.
[18] DNS Operations and Analysis Center (DNS-OARC). Day-in-the-Life Datasets.
https://www.dns-oarc.net/oarc/data/ditl.
[19] Sebastian Castro, Duane Wessels, Marina Fomenkov, and Kimberly Claffy. A Day
at the Root of the Internet. ACM SIGCOMM Computer Communication Review,
38(5):41–46, 2008.
[20] ICANN. Root Server System Advisory Committee. https://www.icann.org/grou
ps/rssac.
[21] RSSAC Caucus. RSSAC002 version 3 – RSSAC Advisory on Measurements of the
Root Server System, Jun 2016.
[22] RSSAC. RSSAC002 Datasets. https://github.com/rssac-caucus/RSSAC002-data.
[23] Roland van Rijswijk-Deij, Taejoong Chung, David Choffnes, Alan Mislove, and
Willem Toorop. The Root Canary: Monitoring and Measuring the DNSSEC Root
Key Rollover. In Proceedings of the 2017 SIGCOMM Posters and Demos, Part of
ACM SIGCOMM 2017, Los Angeles, CA, USA, 2017. ACM Press.
[24] RIPE NCC Staff. RIPE Atlas: A Global Internet Measurement Network. Internet
Protocol Journal (IPJ), 18(3), Sep 2015.
[25] G. Huston, J. Damas, and W. Kumari. A Root Key Trust Anchor Sentinel for
DNSSEC. RFC 8509 (Proposed Standard), December 2018.
[26] Luminati IO. Residential IP and Proxy Service for Businesses. https://luminati.io/,
[27] Taejoong Chung, David Choffnes, and Alan Mislove. Tunneling for Transparency:
A Large-Scale Analysis of End-to-End Violations in the Internet. In Proceedings
of ACM IMC 2016, 2016.
[28] Taejoong Chung, Roland van Rijswijk-Deij, Balakrishnan Chandrasekaran, David
Choffnes, Dave Levin, Bruce M. Maggs, Alan Mislove, and Christo Wilson. A
Longitudinal, End-to-End View of the DNSSEC Ecosystem. In Proceedings of
USENIX Security 2017, 2017.
[29] Luminati. Luminati End User License Agreement. https://luminati.io/license.
[30] NLnet Labs. Unbound DNS Resolver. https://www.unbound.net/.
May 2018.
1181, 10 2018.
[31] ICANN. 2018 KSK Rollover Operational Implementation Plan. https://www.icann.
org/en/system/files/files/2018-ksk-roll-operational-implementation-plan.pdf, 04
2018.
[32] ICANN, Office of the CTO.
Staff Report of Public Comment Proceed-
ing. https://www.icann.org/en/system/files/files/report-comments-ksk-rollo
ver-restart-23apr18-en.pdf, 04 2018.
[33] NLnet Labs. Man-Page: unbound.conf. https://nlnetlabs.nl/documentation/unb
ound/unbound.conf/.
[34] Ólafur Guðmundsson. DNSKEY cache purge. Comment at the mic during DNS-
OARC 29 meeting in Amsterdam, https://www.youtube.com/watch?v=yT51FwP
G0jE&t=6782, Oct 2018.
[35] Not Disclosed. European ISP flushing DNSKEY from cache before the rollover.
Private correspondence, Oct 2018.
[36] Wouter B De Vries, Roland Van Rijswijk-Deij, Pieter-Tjerk de Boer, and Aiko
Pras. Passive Observations of a Large DNS Service: 2.5 Years in the Life of Google.
In 2018 Network Traffic Measurement and Analysis Conference (TMA), pages 1–8.
IEEE, 2018.
[37] Stephen Murphy. ’Significant percentage’ of Eir customers affected by broadband
outage. https://www.rte.ie/news/2018/1013/1002966-eir-outage/, October 2018.
[38] Geoff Houston. Roll Over and Die? http://www.potaroo.net/ispcol/2010-02/roll
over.html, February 2010.
[39] Geoff Houston. Measuring the Root Zone KSK Trust. https://blog.apnic.net/2018/
04/11/measuring-the-root-zone-ksk-trust/, April 2018.
[40] Wes Hardaker. Configurations and Scripts to Test BIND Behavior in the Absence
of a Valid Trust Anchor. https://github.com/hardaker/isc-bind-dnskey-bug-test.
[41] Geoff Huston. APNIC Blog: Analyzing the KSK Roll. https://labs.apnic.net/?p=
[42] Peter B Danzig, Katia Obraczka, and Anant Kumar. An Analysis of Wide-Area
Name Server Traffic. In Proceedings of ACM SIGCOMM 1992, pages 281–292,
Baltimore, MD, USA, 1992. ACM Press.
[43] P.V. Mockapetris. Domain names - concepts and facilities. RFC 1034 (Internet
Standard), November 1987.
[44] N. Brownlee, K.C. Claffy, and E. Nemeth. DNS Measurements at a Root Server. In
Proceedings of IEEE GLOBECOM 2001, volume 3, pages 1672–1676, San Antonio,
TX, USA, 2001. IEEE Computer Society.
[45] Duane Wessels and Marina Fomenkov. Wow, That’s a lot of packets. In Proceedings
of the Passive and Active Network Measurement Workshop (PAM 2003), San Diego,
CA, Apr 2003. PAM.
[46] M Lentz, D Levin, J Castonguay, N Spring, and B Bhattacharjee. D-mystifying
the D-root Address Change. In Proceedings of ACM SIGCOMM 2013, pages 57–62,
Barcelona, Spain, 2013. ACM Press.
[47] Duane Wessels, Jason Castonguay, and Piet Barber. Thirteen Years of “Old J-Root”.
In DNS-OARC 24, Montréal, Canada, 2015.
[48] Bernhard Ager, Holger Dreger, and Anja Feldmann. Predicting the DNSSEC
Overhead Using DNS Traces. In Proceedings of the 40th annual IEEE Conference
on Information Sciences and Systems, CISS 2006, pages 1484–1489, Princeton, NJ,
USA, 2007. IEEE Comput. Soc.
[49] Wouter C A Wijngaards and Benno J. Overeinder. Securing DNS: Extending DNS
Servers with a DNSSEC Validator. IEEE Security and Privacy, 7(5):36–43, 2009.
[50] Daniel Migault, Cédric Girard, and Maryline Laurent. A Performance View on
DNSSEC Migration. In Proceedings of the 6th International Conference on Network
and Service Management (CNSM 2010), pages 469–474, Niagara Falls, Canada,
2010. IFIP.
[51] R. Van Rijswijk-Deij, K. Hageman, A. Sperotto, and A. Pras. The Performance
Impact of Elliptic Curve Cryptography on DNSSEC Validation. IEEE/ACM Trans-
actions on Networking, PP(99), 2016.
[52] Amir Herzberg and Haya Shulman. Fragmentation Considered Poisonous, or:
One-domain-to-rule-them-all.org. In 2013 IEEE Conference on Communications
and Network Security, CNS 2013, pages 224–232, 2013.
[53] Hao Yang, Eric Osterweil, Dan Massey, Songwu Lu, and Lixia Zhang. Deploy-
ing Cryptography in Internet-Scale Systems: A Case Study on DNSSEC. IEEE
Transactions on Dependable and Secure Computing, 8(5):656–669, 2011.
[54] Warren "Ace" Kumari, Evan Hunt, Roy Arends, Wes Hardaker, and David C
Lawrence. Extended DNS Errors. Internet-Draft draft-ietf-dnsop-extended-error-
05, Internet Engineering Task Force, March 2019. Work in Progress.
[55] Various Authors. KSK Rollover Mailing List Archive, March 2019. https://mm.i
cann.org/pipermail/kskA-rollover/2019-March/thread.html.
[56] Mark Allman, Robert Beverly, and Brian Trammell. Principles for Measurability
in Protocol Design. ACM SIGCOMM Computer Communication Review, 47(2):2–12,
2017.