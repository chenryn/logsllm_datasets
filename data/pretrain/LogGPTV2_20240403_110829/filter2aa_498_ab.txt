tracking provider
(backend/cloud)
DATA
DATA
DATA
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
DATA
DATA
DATA
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
evil twin
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
evil twin
victims view
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
DATA
DATA
DATA
DATA
evil twin
victims view
DATA
Mitm + Bad Crypto + Obfuscation
59
??
Mitm + Bad Crypto + Obfuscation
60
??
PI:EMAIL
secure123
Mitm + Bad Crypto + Obfuscation
61
GET /login/?aaa=Bi9srqo&nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A HTTP/1.1
http://s9.***********.com/login/?aaa...
Mitm + Bad Crypto + Obfuscation
62
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
1.
PI:EMAIL
secure123
Mitm + Bad Crypto + Obfuscation
63
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
ssp=CFF1CxQoaQcoLWoRaQ%3D%3D%0A& 
eml=4hBWVqJg4D& 
mix=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
HTTP/1.1
1.
2.
PI:EMAIL
secure123
Mitm + Bad Crypto + Obfuscation
64
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
ssp=CFF1CxQoaQcoLWoRaQ%3D%3D%0A& 
eml=4hBWVqJg4D& 
mix=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
HTTP/1.1
GET /login/?
psw=-ZI-WQe&
amr=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
rma=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
1.
2.
3.
PI:EMAIL
secure123
Mitm + Bad Crypto + Obfuscation
65
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
ssp=CFF1CxQoaQcoLWoRaQ%3D%3D%0A& 
eml=4hBWVqJg4D& 
mix=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
HTTP/1.1
GET /login/?
psw=-ZI-WQe&
amr=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
rma=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
aaa=ZTZrO& 
mag=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A& 
df=CFF1CxQoaQcoLWoRaQ%3D%3D%0A&
data=5JFJzgYW_
HTTP/1.1
1.
2.
3.
4.
PI:EMAIL
secure123
Mitm + Bad Crypto + Obfuscation
66
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
ssp=CFF1CxQoaQcoLWoRaQ%3D%3D%0A& 
eml=4hBWVqJg4D& 
mix=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
HTTP/1.1
GET /login/?
psw=-ZI-WQe&
amr=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
rma=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
aaa=ZTZrO& 
mag=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A& 
df=CFF1CxQoaQcoLWoRaQ%3D%3D%0A&
data=5JFJzgYW_
HTTP/1.1
1.
2.
3.
4.
PI:EMAIL
secure123
Mitm + Bad Crypto + Obfuscation
67
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
ssp=CFF1CxQoaQcoLWoRaQ%3D%3D%0A& 
eml=4hBWVqJg4D& 
mix=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
HTTP/1.1
GET /login/?
psw=-ZI-WQe&
amr=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
rma=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
aaa=ZTZrO& 
mag=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A& 
df=CFF1CxQoaQcoLWoRaQ%3D%3D%0A&
data=5JFJzgYW_
HTTP/1.1
1.
2.
3.
4.
PI:EMAIL
secure123
Mitm + Bad Crypto + Obfuscation
68
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
aaa=Bi9srqo
ssp = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
mix = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
eml=4hBWVqJg4D 
amr = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
rma = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
psw=-ZI-WQe
mag = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
df
= CFF1CxQoaQcoLWoRaQ%3D%3D%0A
aaa=ZTZrO
data=5JFJzgYW_
Mitm + Bad Crypto + Obfuscation
69
mag = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
ssp = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
rma = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
df
= CFF1CxQoaQcoLWoRaQ%3D%3D%0A
amr = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
mix = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
Mitm + Bad Crypto + Obfuscation
70
mag = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
ssp = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
rma = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
df
= CFF1CxQoaQcoLWoRaQ%3D%3D%0A
amr = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
mix = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
'k',1'c',1'#',1'a',1'p',1'p',1'#',1'k',1'e',1'y',1'#'}
Mitm + Bad Crypto + Obfuscation
71
mag = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
ssp = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
rma = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
df
= CFF1CxQoaQcoLWoRaQ%3D%3D%0A
amr = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
mix = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
'k',1'c',1'#',1'a',1'p',1'p',1'#',1'k',1'e',1'y',1'#'}
XOR
@
PI:EMAIL
Base64
Mitm + Bad Crypto + Obfuscation
72
mag = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
ssp = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
rma = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
df
= CFF1CxQoaQcoLWoRaQ%3D%3D%0A
amr = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
mix = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
'k',1'c',1'#',1'a',1'p',1'p',1'#',1'k',1'e',1'y',1'#'}
XOR
@
PI:EMAIL
Base64
{nl,1bhf,1mag,1bdt,1qac,1trn,1amr,1mix,1nch}
Mitm + Bad Crypto + Obfuscation
73
mag = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
ssp = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
rma = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
df
= CFF1CxQoaQcoLWoRaQ%3D%3D%0A
amr = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
mix = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
'k',1'c',1'#',1'a',1'p',1'p',1'#',1'k',1'e',1'y',1'#'}
XOR
@
PI:EMAIL
Base64
{nl,1bhf,1mag,1bdt,1qac,1trn,1amr,1mix,1nch}
Random()
“=“
+
+
Mitm + Bad Crypto + Obfuscation
74
mag = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
ssp = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
rma = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
df
= CFF1CxQoaQcoLWoRaQ%3D%3D%0A
amr = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
mix = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
XOR
Base64
{nl,1bhf,1mag,1bdt,1qac,1trn,1amr,1mix,1nch}
Random()
“=“
+
+
{df,1ssp,1fgh,1 drt,1tnd,1rfb,1rma,1vwe,1hac}
secure123
********
Random()
“=“
+
+
'k',1'c',1'#',1'a',1'p',1'p',1'#',1'k',1'e',1'y',1'#'}
PI:EMAIL
@
Decryption
75
CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
Decode Base64
Decryption
76
CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
XOR
Decode Base64
secure123
********
'k',1'c',1'#',1'a',1'p',1'p',1'#',1'k',1'e',1'y',1'#'}
PI:EMAIL
@
Mitm + Bad Crypto + Obfuscation
77
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
@
********
Mitm + Bad Crypto + Obfuscation
78
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
@
********
aaa=Bi9srqo
eml=4hBWVqJg4D 
aaa=ZTZrO
data=5JFJzgYW_
psw=-ZI-WQe
Mitm + Bad Crypto + Obfuscation
79
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
@
********
aaa=Bi9srqo
eml=4hBWVqJg4D 
psw=-ZI-WQe
aaa=ZTZrO
data=5JFJzgYW_
{usr,1psw,1uid,1data,1eml,1pss,1foo,1clmn,1count,1nam,1srv,1answ,1aaa1}
Random()
“=“
+
+
GenerateRandomString()
Mitm + Bad Crypto + Obfuscation
80
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
@
********
aaa=Bi9srqo
eml=4hBWVqJg4D 
psw=-ZI-WQe
aaa=ZTZrO
data=5JFJzgYW_
{usr,1psw,1uid,1data,1eml,1pss,1foo,1clmn,1count,1nam,1srv,1answ,1aaa1}
Random()
“=“
+
+
GenerateRandomString()
GenerateMultiPairs()
Mitm + Bad Crypto + Obfuscation
81
tnd = CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
nch = DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A 
@
********
aaa=Bi9srqo
Shuffle()
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
82
Correct Secure Communication
§ Use1https via1TLSQ1.2Qor1TLSQ1.3
§ Valid1server1certificate1
§ Implementation1in1Android:
URL url = new URL("https://wikipedia.org");
URLConnection urlConnection = url.openConnection();
val url = URL("https://wikipedia.org")
val urlConnection: URLConnection = url.openConnection()
Java:
https://developer.android.com/training/articles/security-ssl#java
Kotlin:
84
Realy ?
“Authentication“