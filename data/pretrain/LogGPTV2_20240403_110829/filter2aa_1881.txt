Cloud
inSecurity
PI:EMAIL
HIT2008
Cloud
inSecurity
Who am I?
Camera man @ HITCon
Member @
Sr. Engineer @
Network
Security
Web 2.0
Security
BSD/Linux
Kernel
Firewall
Internal
IPS/IDS
Anti-SPAM
Antivirus
Programming
Network
Appliance
苦命工程师
过勞
好人 Orz
Network
Access
Control
加班
Before the Presentation
This is a trend discussion.
No deep technical issues.
It’s about new security model.
Not technology.
AGENDA
Cloud Computing
in
Security World
AGENDA
Vendors are eager to adopt this 
technology.
Are bad guys scared?
(Or excited ☺)
AGENDA
and …
What about
Bad guys 0wn the Cloud.
What is the Cloud Computing?
What is Cloud Computing?
SaaS
(Software as a Service)
In-the-cloud Service
Thin Client
Cloud Computing (SaaS)
Move applications, storages, …
To Cloud Servers.
Client becomes simple.
Cloud Computing (SaaS)
Still no idea?
Google web applications
Amazon EC2/S3/Simple DB
…
Cloud Computing (SaaS)
No hardware issues,
No software update,
No storage problem, and
You can use it wherever you are.
Cloud Computing (SaaS)
This model is amazing, and
really changed our life.
But you may already know, 
hackers are always ahead of us.
They knows cloud computing very 
long time ago.
How it works?
Scenario 1
骇客小陈 的 Cloud Computing
云端储存 肉鸡储存
________
小陈的云 (乌云)
无辜的人
小陈
马神
后门神
How it works?
Scenario 2
还是 骇客小陈 的 Cloud Computing
云端运算 肉鸡运算
________
小陈的云 (乌云)
John 神
小陈
Shadow
密码档
Grid Computing
How it works?
Scenario 3
还是 骇客小陈 的 Cloud Computing
云端运算 肉鸡运算
________
小陈的云 (乌云)
无辜的网站
DDoS 神
小陈
不爽
召唤
Bot Net
MD5 Rainbow Table
本站4T硬盘已经上线,共有md5记录
457,354,352,282条，宇宙第一，且还在不断增长
中，已包含12位及12位以下数字、8位字母、全部
7 位及以下字母加数字等组合，并针对国内用户做
了大量优化，例如已经包含所有手机号码、全国部
分大中城市固定电话号码、百家姓、常用拼音等大
量组合，另加入 了大型网站真实会员密码数据100
万条。本站数据量大，查询速度快，同时支持16
位及32位密码查询。通过对10万会员的真实动网
论坛样本数据的测试，本 站对于动网论坛密码的
命中率达到83%。全国独此一家。
Dark Cloud
Malware is software,
software is moving to the cloud, 
therefore,
malware is moving to the cloud.
Dark Cloud
Malware as a Service
MaaS
Dark Cloud – Profit Driven
Criminals have adopted the 
new model too, and are 
offering
“crimeware as a service”
(CaaS).
Dark Cloud
Cybercrime is now about 
making money
CaaS
A few years ago they started 
selling e-mail addresses, 
credit-card numbers and other 
personal information.
CaaS
More recently they have taken 
to setting up and then renting
out botnets.
CaaS business model.
CaaS
The operator of the CaaS
provides real-time information 
on the size and availability of 
the botnets.
CaaS
That can be activated remotely to
flood a website with bogus 
requests (DDoS)
send millions of “spam”
CaaS
That can be activated remotely to
grab PC owners’ online 
banking information, or
steal log-in credentials.
So …
What do security venders do 
against such sophisticated 
Maas/CaaS?
Secure Cloud – Anti-Spam
Secure Cloud – Anti-Spam
Anti-spam adopted cloud model 
long time ago.
IP black-list
RBL, Spamhaus, SORBS, 
DSBL, and …
Secure Cloud – Anti-Spam
Mail Hosted Service (in the cloud)
Google Postini, Trend Micro 
IMHS, and many others
Secure Cloud – Anti-Spam
Problems:
The growing usage of zombies
and botnets has also made 
blacklists much less effective 
in blocking email.
Secure Cloud – URL Filtering
Real-time query for
URL/Domain Name reputation
Black listed model
Problems?
Secure Cloud – URL Filtering
Secure Cloud – URL Filtering
…
Secure Cloud – URL Filtering
Secure Cloud – URL Filtering
Secure Cloud – URL Filtering
Secure Cloud – URL Filtering
Secure Cloud – URL Filtering
Secure Cloud – Antivirus
Secure Cloud – Antivirus
Wait! What?
Secure Cloud – Antivirus
Antivirus vendors are facing very big challenges.
Secure Cloud – Antivirus
Panda Security
TruPrevent - Collective 
Intelligence  2007
Secure Cloud – Antivirus
TruPrevent - Collective 
Intelligence 
Benefiting from “community” knowledge to 
proactively protect others.
Automating and enhancing malware collection, 
classification and remediation.
Gaining knowledge on techniques to improve 
existing technologies.
Deploying new generation of security services 
from the cloud.
Secure Cloud – Antivirus
McAfee Artemis
Secure Cloud – Antivirus
McAfee Artemis
Provide customers with the most up-to-date 
detections for certain malware.
Looking for suspicious programs and dlls
Send a request to a central database server 
hosted by McAfee Avert Labs
Server will determine if this program is malicious 
and will respond
Secure Cloud – Antivirus
Secure Cloud – Antivirus
Secure Cloud – Antivirus
Trend Micro
File Reputation Service
and
Smart Protection Network
June, 2008
Secure Cloud – Antivirus
Threat Protection Databases
Patterns
Past
Slowly 
Changing
5,000
Per Day
Today
Threat Protection Databases
Traffic
Reputation
Agent
Agent
Multi-Threat 
Correlation
SDK
SDK
Future
Threat Protection Databases
Secure Cloud – Antivirus
Secure Cloud – Antivirus
Trend Micro FRS
Minimal endpoint pattern updates.
Significantly reduce endpoint memory 
consumption
Protect in real time
Reduce the need for pattern updates
Secure Cloud - Benefits
Effectiveness
Flexibility
Ease of Deployment and Use
No admin and setup overhead
Low total cost of Ownership
Scalability and Reliability
Secure Cloud - Benefits
It hopes the shift in 
architecture will help to speed 
its reaction to zero-day threats
and improve the performance
of end users' PCs.
Secure Cloud – Challenge -
Technical
Must be
Stable and
Internet Connected
Secure Cloud – Challenge -
Technical
DNS becomes very critical.
DNS hijacking risks.
DNS must be stable as well.
Secure Cloud – Challenge -
Technical
Antivirus ‘in the cloud’ problems
Easier to be bypassed?
(Cache attack)
It is still pattern based scanning.
(against dark cloud packer)
http://meatchicken.com/packer.pl?file=trojan.exe
Overestimated forensics engine
Secure Cloud – Challenge -
Technical
Are they all “hacker safe” ;-)
It makes total sense but they 
don’t mention what will happen if 
they get hacked
What you send is not what is 
received?
Cloud becomes critical.
(once hacked, all hacked.)
Secure Cloud – Challenge –
non Technical
Privacy Issue.
When someone else hosts and processes 
your data, how can you tell if it is "secure?"
If you haven’t noticed yet, everything is 
pushed into the cloud, not only your social 
life but your personal data and now even 
your health records thanks to Google.
Secure Cloud – Challenge –
non Technical
Cost
the cost of shifting away form 
their existing deployment.
Secure Cloud – Challenge –
non Technical
Enterprise Concerns
IT against.
New model introduced new 
vulnerabilities.
Billing model changed.
Secure Cloud – Challenge
SaaS infrastructures are
definitely more attractive to
attackers. :)
Secure Cloud – Challenge
Are you cloud services used 
by normal user or bad guys?
Leverage existing cloud 
services
(Hacking - power by Google 
cpu/bandwidth/…)
Discussion
Discussion
White list
vs
Black list
Discussion
Behavior / heuristic analysis
vs
Signature based protection
Discussion
Is it just a white or black listed
filtering model.
No, the most valuable thing is
collaboration
Discussion
Correlation technology with 
behavioral analysis.
Feedback loops contributing
Conclusion
It is still worth to try for
security vendors
(as well as for hackers)
Behind the Cloud
Who is watching you?