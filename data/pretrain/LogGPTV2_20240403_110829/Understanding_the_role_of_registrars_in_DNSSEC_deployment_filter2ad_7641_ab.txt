### Optimized Text

When a CDS (Child DS) record is created within one of its customers' domains, the registry authenticates this record and subsequently updates the DS (Delegation Signer) record. Once the old DS record is replaced with the new one, the customer can remove the DNSKEYs for the domain. DNSKEYs can be delivered out-of-band even if the domain does not have a DS record, enabling an RRSIG (Resource Record Signature) to be validated by the DNSKEYs. However, this is not the intended mechanism for deploying DNSSEC.

An anecdotal example is the case of the `isoc.org` domain, where the DS record was found to be incorrect at the 38th ICANN meeting in 2010 due to a transcription error made when the DS record was manually entered over the phone. This error was discovered shortly before a press conference announcing the ISOC (The Internet Society) DNSSEC deployment and was immediately corrected by one of our authors.

Since the DS record can be generated using the CDNSKEY (Child DNSKEY), publishing both a CDS and CDNSKEY is redundant but not incorrect. The operational methods for the registry to notice the CDNSKEY and CDS record may differ. The registry can use tools that periodically check each of its customers' domains to see if they have a CDS and CDNSKEY record, or it can provide a web interface for the customer to signal the parent zone to fetch these records.

**Figure 2: Steps in the process for inserting a DS record into the registry when the DNS operator is (1) a registrar, (2) a reseller, (3) the owner, and (4) a third-party. In each case, it is the DNS operator who actually generates the DS record; it then has to be handed off (potentially up to three times) to make it to the registry. Not shown is the case where a customer buys a domain from a reseller and uses a third-party DNS operator (adding yet another handoff).**

Once the DS record is inserted, the customer can remove the CDNSKEY and CDS records from their zone configuration settings. Unfortunately, CDS and CDNSKEY have seen very little adoption by registries, leaving us with the manual processes described above.

### Third-Party DNS Operators

Recently, we have observed the growth in popularity of organizations that provide management of DNS records but do not serve as registrars; we refer to these organizations as third-party DNS operators. These organizations act as authoritative nameservers for customers, manage DNS records, and often provide security services such as DDoS (Distributed Denial of Service) prevention. One prominent example of such a service is Cloudflare. With a third-party DNS operator, properly deploying DNSSEC becomes even more complicated, as it is the third-party who generates DNSKEYs and RRSIGs. Specifically, if the registry does not support CDS or CDNSKEY (which comprises all but one registrar at the time of writing), the third-party DNS operator does not have the authority to ask the registrar to upload a DS record; instead, it must ask the customer to relay a DS record to the registrar. As we will see later in the paper, this convoluted process plays a role in why DNSSEC adoption remains low.

**Figure 2: Summary of the process for inserting DS records into the registry, varying based on whether the DNS operator is the registrar, a reseller, the owner, or a third-party.**

### 3. Related Work

In this section, we discuss studies of DNSSEC deployment and DNS registrars.

#### DNSSEC Deployment

We first discuss related studies of DNSSEC deployment, covering both server-side (DNSSEC-enabled domain) and client-side (DNS resolver) studies.

**Server-Side Support:**
DNSSEC has attracted significant attention from both research and industrial stakeholders. Early studies measured the operational status of DNSSEC [34, 35] or operational challenges for wide deployments [48]. More recent studies found that 89% of generic TLDs (gTLDs) and 47% of country-code TLDs (ccTLDs) supported DNSSEC in 2016 [40], and that most major DNS server software supports DNSSEC [14]. Additionally, several free tools exist to help system administrators deploy DNSSEC, such as DNSSEC Debugger [11] and DNSViz [15]. Recent studies have also found that DNSSEC adoption for second-level domains remains low. Our recent study [8] showed that DNSSEC deployment is rare in second-level domains (approximately 1% of .com, .net, and .org domains), but is growing. Some studies have focused on DNSSEC misconfigurations: Adrichem et al. [43] analyzed a sample of second-level domains and found that 4% exhibited misconfigurations. Dai et al. [10] found that 19% of second-level domains from the Alexa Top-1M could not establish a chain of trust from the root. A common cause was the failure to upload DS records; nearly 30% of .com, .net, and .org domains do not properly upload DS records even though they have DNSKEYs and RRSIGs [8].

Our work complements these prior studies by focusing on why DNSSEC deployment remains so small and why there are high levels of DNSSEC misconfiguration. We purchase domains from popular registrars and resellers and examine the process of configuring DNSSEC for these domains. We also use broader datasets, including all second-level domains from three gTLDs (.com, .net, and .org) and two ccTLDs (.nl and .se).

**Client-Side Support:**
To measure client-side support for DNSSEC, studies have used advertisements in embedded webpages to cause clients to make DNS requests [4, 29, 40]; their results showed that about 26% of clients use DNSSEC-validating resolvers, but they retry querying non-validating resolvers if validation fails (defeating the point of DNSSEC). Using a similar technique, Lian et al. [29] showed that 1% of clients failed to resolve DNSSEC-enabled domains at all, while only 3% of clients successfully detected DNSSEC-signed domains with broken signatures. Finally, we used the Luminati proxy network [7] to induce DNS requests; we found that 83% of clients use a resolver that requests DNSSEC records, but only 12% of them actually bother to validate the response [8].

#### Registrars

Another line of work has examined the role of registrars in DNSSEC deployment. Recent work has found that many second-level domains with DNSKEYs fail to upload a DS record [8, 43, 44], suggesting that certain registrars may incorrectly deploy DNSSEC. Some studies focused on the process of enabling DNSSEC. The Internet Society [22], for example, stressed the role of registrars in enabling DNSSEC, publishing a list of registrars known to support DNSSEC. York's report [47] also pointed out that the low DNSSEC adoption rate is due to its complexity, and the most effective way to accelerate its deployment is to simplify the process of signing a domain, such as enabling DNSSEC by default.

On the other hand, several studies examined ways to increase DNSSEC deployment, primarily through financial incentives [9, 18–20]. Collectively, they showed how financial incentives for a registrar can lead to higher levels of DNSSEC adoption. Unfortunately, financial incentives are only offered by a small number of ccTLDs (e.g., .nl, .se, and .cz), and this approach has yet to expand to other TLDs.

**Table 1: Overview of the datasets used in this study. The number of overall domains and the percentage that have published DNSKEYs as of December 31, 2016.**

| TLD | Measurement Period | Number of Domains | Percent with DNSKEY |
|-----|--------------------|-------------------|---------------------|
| .com | 2015-03-01 – 2016-12-31 | 118,147,199 | 0.7% |
| .net | 2015-03-01 – 2016-12-31 | 13,773,903 | 1.0% |
| .org | 2015-03-01 – 2016-12-31 | 9,682,750 | 1.1% |
| .nl | 2016-02-09 – 2016-12-31 | 5,674,208 | 51.6% |
| .se | 2016-06-07 – 2016-12-31 | 1,388,372 | 46.7% |

There are also several attempts to make it easier for third-party DNS operators to use DNSSEC. For example, Cloudflare and CIRA, the registry operator for .ca, are working on a draft standard [13, 27], which would allow the third-party DNS operator to identify the registrars and communicate with them directly to enable or bootstrap DNSSEC using a REST-based protocol (without any effort from registrants).

### 4. Datasets

In this section, we present the datasets used in this study and briefly examine the overall support for DNSSEC to help motivate the subsequent analysis.

#### 4.1 TLD Zone Files

Our goal is to understand how different registrars have affected DNSSEC deployment. To do so, we rely on scans from five TLDs provided by OpenINTEL [36, 45]: the .com, .net, and .org generic TLDs, and .se and .nl country-code TLDs. We chose .com, .net, and .org because they are some of the largest TLDs, and .se and .nl because they show some of the highest rates of DNSSEC deployment [12].

Our dataset contains daily scans of all second-level domains in these five TLDs. The datasets start at different times: .com, .net, and .org start on March 1st, 2015, .nl starts on February 9th, 2016, and .se starts on June 7th, 2016. All end on December 31st, 2016. Table 1 shows a summary.

Each daily scan contains several pieces of information for each second-level domain in the zone:
1. The Nameserver (NS) record(s) for each domain, containing the authoritative nameserver(s) of the DNS operator.
2. The Delegation Signer (DS) record for each domain, if it exists.
3. The DNSKEY and DNSKEY RRSIGs for the domain, if any exist.

Taken together, the scans represent one of the most comprehensive sets of DNSSEC observations.

#### 4.2 Identifying the DNS Operator

To understand how different registrars behave, we need to know who manages each domain. One possible option is to use WHOIS data to obtain registrar information; however, the WHOIS infrastructure is distributed across registrars and resellers, is heavily rate-limited, and lacks a consistent schema [28]. Moreover, a domain could be managed by a reseller, but the WHOIS information may be served by its partner registrar, conflating the behavior of the reseller and the registrar.

Instead, we rely on the authoritative nameserver for each domain (from the NS record), which is present in our datasets, to indicate the DNS operator. The identity of the authoritative nameserver serves our purpose well, as the domain name of the authoritative nameserver typically identifies the organization managing the name. Specifically, we group domains if they share the same second-level domain in their NS records. For example, if two different domains have NS records of `ns01.domaincontrol.com` and `ns02.domaincontrol.com`, we group these under the DNS operator `domaincontrol.com` (owned by GoDaddy).

#### 4.3 Overall DNSSEC Support

We begin by examining how DNSSEC is deployed across different TLDs. Table 1 shows the number of domains in each of the TLDs we study, as well as the percentage of domains that have DNSKEYs. We observe that the overall DNSSEC deployment rate in the three generic TLDs is quite low—in line with recent studies [8]—but the percentage is much higher in .nl and .se. We explore this trend in more detail in the subsequent sections.

Next, we examine how the domains that attempt to deploy DNSSEC are distributed across registrars. To correctly deploy DNSSEC, a domain must (a) publish DNSKEYs and RRSIGs for all records, and (b) have a DS record in the TLD zone. Thus, we examine how three subsets of the domains are distributed across registrars: (1) all domains, (2) partially deployed domains, and (3) fully deployed domains.

**Figure 3: Cumulative distribution function (CDF) of the number of all .com, .net, and .org domains per registrar from the December 31, 2016 snapshot.**

We make two observations:
1. Partially and fully deployed domains show a much different distribution across registrars than the overall dataset: 26 registrars are necessary to cover 50% of all domains, but only four registrars are necessary to cover 50% of the partially deployed domains, and only two registrars are necessary to cover 50% of the fully deployed domains.
2. The small number of registrars that host an outsized proportion of DNSSEC domains suggests that many popular registrars fail to support DNSSEC. For example, the overlap between the 25 most popular registrars overall and the 25 most popular registrars among fully deployed domains is only three registrars, which paints a bleak picture of DNSSEC support among registrars.

Hence, to better understand why and how DNSSEC is deployed, we turn our attention to studying each registrar’s DNSSEC deployment policy and its impact.

### 5. Popular Registrars

We begin by examining how the most popular DNS registrars support DNSSEC. To do so, we register domains ourselves and attempt to deploy DNSSEC, as well as look at all domains operated by the registrar to look for patterns.

#### 5.1 Methodology

To understand how different registrars support DNSSEC, we need to register domains and try to deploy DNSSEC as a customer would. We focus on the most popular 31 DNS operators that serve DNS for the most domains across our datasets, which collectively cover 54.3% of .com, .net, and .org domains in the TLD zone files. For each of these 31 DNS operators, we proceed as follows:

1. **Check if the DNS operator is a registrar:** We found that nine are domain parking services and two are third-party DNS operators. We do not study the domain parking services further. The two third-party DNS operators, DNSPod and Cloudflare, are studied in Section 7. For the others, we purchase a .com domain.
2. **Examine DNSSEC support:** Next, we examine whether our purchased domain supports DNSSEC by default, or if DNSSEC is an opt-in feature. If we are unable to find a way to do so, we email the registrar to ask if they support DNSSEC.

**Table 2: Results of our study of registering domains using the 20 registrars among the top 31 DNS operators.**

| Registrar | Domains | All | Registrar DNS Operator | DNSSEC Default | DNSSEC Opt-In | Owner DNS Operator | DS Validation | DNSKEY Email | DNSSEC Support | Web | Email | DS Upload with DNSKEY |
|-----------|---------|-----|------------------------|----------------|---------------|--------------------|---------------|--------------|----------------|-----|-------|-----------------------|
| GoDaddy (domaincontrol.com) | 8,139 | 3 | 0 | 0 | 10 | 0 | 13,232 | 0 | 0 | 0 | 0 | 319,580 | 0 | 3 | 0 | 0 | 1,945 | 1 | 0 | 0 | 37,652,477 | 4,292,138 | 3,802,824 | 2,534,673 | 2,525,828 | 2,066,503 | 1,963,717 | 1,887,139 | 1,849,735 | 1,823,823 | 1,311,969 | 1,228,578 | 1,117,902 | 888,174 | 865,065 | 836,293 | 813,945 | 720,435 | 690,823 | 663,616 |
| Alibaba (hichina.com) | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - |