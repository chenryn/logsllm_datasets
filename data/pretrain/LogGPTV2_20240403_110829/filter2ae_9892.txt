# Emissary木马演变记录
|
##### 译文声明
本文是翻译文章，文章来源：360安全播报
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
2015年12月, Unit 42发表了一篇关于使用Emissary木马发动网络间谍攻击的博客。Emissary与Elise木马以及Operation
Lotus Blossom攻击活动相关,这促使我们开始收集Emissary其它的样本。
我们发现的最早的样本产生于2009年,意味着这个工具已经被使用了近7年。值得注意的是,这比我们发现最早的Elise样本还要早三年。此外,Emissary似乎只被用来针对台湾或香港的目标,他们使用的主题也与政府和军队有关。
我们也发现一些不同版本的Emissary有迭代变化,这能够显示出木马近年来是如何进化的。我们观察到他们开始使用被盗用但合法的域名来为恶意软件服务,C2基础设施也和Elise使用的有所不同。
针对目标
Emissary被用来攻击了多个东南亚国家和地区,我们收集到所有的Emissary样本使用的都是主要用于台湾和香港的繁体中文,我们已经确认的目标也位于这两个区域。尽管受限于有限的地理范围,但Emissary通过复制和粘贴网上看不到的新闻文章和文件来针对政府、高等教育和高科技公司。内容包括:
•一个Excel电子表格,其中包含台湾政府合法的联系方式,网上似乎没有。
•复制粘贴了一篇新闻文章,其中南京军区的副司令王洪光说中国大陆和台湾统一的可能性很低。
•复制了2010年的一篇新闻,人们抗议为了举办上海世博会强制迁移上海居民。
•台湾官方2016假期安排的副本,这也是台湾政府成立的第105周年。
发展求生存:TTP移位和基础设施
从我们第一次发布与Emissary有关的博客起,我们已经对Emissary的基础设施有了一些了解,我们发现只有一个专用的DDNS域从中国经销商处购买得来。相比之下,Elise样本使用的是actor-registered和DDNS的混合,actor-registered可以作为一个数据点约束所有的活动。
Emissary样本通常有三个写死的C2,它们是IP和域名的混合,其中一个域名或IP不被其他三个C2使用,可能是为了避免其失去控制。一个完整的IOC列表包含在这个报告的最后。
他们还使用被盗的合法台湾网站来为他们的恶意软件服务,其中包括民进党的官方网站。特别有趣的是,台湾1月16日才举行过受到密切关注的大选,民进党候选人蔡英文赢得选举。这是第一次有女性当选为台湾领导人,同时这也是国民党自1949年被驱逐出中国后,第二次失去领导权。蔡英文被广泛认为是一个支持台湾独立、不赞成与中华人民共和国统一的政治家。
恶意软件更新
我们的证据表明,恶意软件作者早在2009就创建了Emissary,actor们已经使用这个工具作为有效载荷进行了多年的网络间谍攻击。Emissary木马是一个有能力立足于目标系统的工具。虽然缺乏如屏幕捕获这种更高级的功能,它仍然能够完成大多数任务:漏出文件、下载并执行附加载荷、具有获得远程操作界面访问权的能力。actor似乎在不断使用这个木马,并发展出Emissary的几个更新版以保持它无法检测以及不过时。
我们对所有已知的Emissary的样本进行了分析,以确定在不同版本的木马之间,恶意软件作者做了哪些改动。通过我们的分析,
基于其编译时间我们研究了在每个样本的创建时间,并且做了一个简单的时间轴,在图2中显示了Emissary木马的发展历程。应该注意的是,我们知道一些不同配置的Emissary样本已被使用多次,所以时间轴只显示Emissary的开发活动时间,而不应该被误解为Emissary被用于攻击的时间。
图2中的时间轴显示,Emissary木马第一次被创建(1.0版)是在2009年5月,很快就得到了更新,这就是2009年6月的1.1版本。木马没有太多的形式改变,直到2011年9月作者发布了2.0版本。版本2.0在2013年10月进行了一次更新,其后恶意软件作者在2014年12月发布了3.0版本。恶意软件作者2015年3月发布了4.0版本,但是奇怪的是2015年6月26日其又创建一个示例3.0版本,版本递增的顺序有些混乱。2015年8月至11月期间,恶意软件作者又创建了几个新版本的Emissary,特别是5.0、5.1、5.3和5.4,与早期版本的开发过程相比更快也更连续。
图2: Emissary发展的时间线
基于明显的相似之处(原始3.0版本和其他早期版本的Emissary中没有看到),乱序的3.0版本似乎是5.0版本的一个早期的变体。与乱序3.0版本相关的代码是“3test”,
这意味着恶意软件作者是出于测试目的创建它的。另一个与乱序3.0版本相关的代码是“IC00001”,这可能表示攻击有效载荷,因为它似乎是一个描述运动的合理的代码。
虽然这可能是巧合,但乱序3.0版本是在我们发布Operation Lotus
Blossom博客十天后出现的。恶意软件作者可能受到了我们文章的启发,修改了恶意软件作为对我们的研究的回应。不管因果关系如何,
Emissary新版本的迅速发展表明,恶意软件作者正在频繁修改以逃避检测,这也表明actor正在积极使用Emissary木马作为攻击中的有效载荷。
由于文章篇幅有限,大家可以点击原文链接查看Emissary版本历史,其中对各版本有详细描述。
结论
这些使用Emissary的actor同时也是Operation Lotus Blossom的背后操作者,
已经在东南亚活跃了至少7年。他们是执着的,一直随着时间而发展,有足够的资源,也有多个定制的RAT以获得定期更新。他们的目标在很大程度上是军方或政府,某些情况下也会针对高等教育和高科技公司。他们也有能力用多种亚洲语言选择和使用合适的诱饵,让它们合法地出现。
Emissary似乎是针对台湾和香港使用的,它使用普通恶意软件更新以避免检测,并增加成功几率。一系列Emissary的更新时间与我们的报告之间也有一个有趣的巧合。第一次是在我们发布博客十天后,随后的更新在越来越短的时间间隔内被发布,约为每三个月一次,一直发展到目前发现的最终版本。而在我们发布文章之前,Emissary大约每两年更新一次。这表明actor可能注意到了我们的报告,并且完全有能力在必要时立即进行变化。
除了恶意软件进化,actor也从带附件鱼叉式网络钓鱼转向用妥协的合法网站托管恶意软件。木马的不断的更新和TTP的转变表明Emissary在未来将继续被用来进行间谍攻击。
我们已经为帕洛阿尔托网络更新了Emissary的标签,引导用户对博客中讨论的这一威胁进行了解。