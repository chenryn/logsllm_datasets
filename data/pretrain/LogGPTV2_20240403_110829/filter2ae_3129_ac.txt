....  
所以，校验的方式就是将两个数字相加。
* * *
第二行的数据DC05 原本以为是固定不变的数据，后来发现是每天的 **消费金额** ， 05DC 十进制是1500
是每天消费的金额15元，后面1表示的是每天消费的次数为1次。
* * *
第三行数据，分别比较各个数据 29
7X的数据是一个递增数据，猜测应该是某钟时间数据。根据后面的纪录，发现并不是依次递增，比如经过某个周末的时候，这个数据会跳两个。应该是日期的数据。  
然后就是0B1C0E的数据，这几个数据是不规则变化的，但是经过观察发现 1C
0E等等转化成十进制永远不超过60。猜测应该是上一次刷卡的时间数据。有一次中午吃饭的时候，观察了刷卡机上面的时间，验证得到确实是时间数据。  
比如0B2214 就是11：34：20秒，这样的一个时间数据。  
最后一个C674的数据也是个递增数据，应该是刷卡次数的递增数据。记录累计的一个刷卡次数。
然后还有最后两个十六进制数，猜测应该是一个校验数据。  
通过对比这些数据，我们可以对上述的卡片数据进行一个改造然后重新写入。  
但是，对数据进行改造之后发现无法对饭卡进行写入，错误是写访问秘钥A未知。  
但是我们之前已经爆破出来了读取的秘钥，写的秘钥有可能是这个软件的原因，也有可能是设备的原因（按道理是FFFFFFFFFF的默认秘钥），因此无法进行写入。可能需要后续购买设备进行研究。
# 5 总结和展望
### 5.1 智能卡 发展现状
**2013年的数据：**  
我国也已成为世界上最大的 IC 卡市场之一，2011年，我国 IC 卡实现销售收入达到 90 亿元，销售数量达到 24.3 亿张（包括接触式 IC
卡、非接触式 IC 卡和双界面卡）。二代身份证是我国非接触式 IC 卡最大的应用之一，据统计，截止 2011 年底，我国已累计发行二代身份证 10
亿张左右。
**智能卡片发展要求：**
  1. 高安全性  
应用最广泛的是对称密钥加密算法 DES 算法以及双长度密钥的 3DES 算法。此外，还有一些 IC 卡已经集成了非对称性密钥算法，如 1024 位 RSA
算法。
  2. 低功耗  
绝大多数非接触式 IC 卡的内部不带有电池，其工作电源主要来源于天线上感应到的磁场能量。因而低功耗设计对于非接触式 IC 卡来说显得极为重要，且现在非接触式
IC 卡的功能越来越复杂，容量也越来越大，有些 CPU卡中还包含微处理器及高性能的安全算法，这无疑对非接触式 IC 卡的低功耗设计提出了更高的要求。
  3. 一卡多用  
一张 IC 卡能够具有健康卡、信用卡、交通卡等多种功能, 如此将要求 IC 卡具有更大的存储容  
量、更快的存取速度。
  4. 大容量  
实现非接触式 IC 卡一卡多用的功能，需要在卡中集成具有一  
定容量的存储器以保证能够存放卡在不同应用下的数据。目前的 IC 卡大多采用  
存储器分区的方法来实现不同应用数据的存放。而 CPU 卡的出现，则使得 IC 卡  
需要开辟一定的存储区域用于存放卡内操作系统。因此，大容量是当今 IC 卡发  
展的重要方向。
  5. 复合式  
发展复合式 IC 卡 复合式卡即双界面卡，其既可以通过接触式方式与读卡器进行交互，也可以通过非接触式方式与读卡器进行交互，这使得 IC
卡可以应用于多种场合，极大的方便了人们的生活。现在很多国际大公司包括国内的一些公司都已成功开发了双界面IC卡并投入使用。
国家三种标准的非接触IC卡距离
### 5.2 威胁建模以及攻击方式研究现状
攻击者可利用标签和读卡器通信信道的物理特性实施的攻击，攻击主要方式有以  
下几种。  
【1】 **干扰攻击：**
干扰攻击主要采用一些技术手段扰乱、破坏标签和读写器之间的传输信号，以达到破坏系统的可用性的目的。但有些时候，攻击不都是外部有目的的干扰，也可能是多读写器同时工作，或信道本身质量不好导致的内部干扰。
* * *
【2】 **克隆攻击：**
也可以称之为复制攻击。主要通过复制他人的电子标签或智能卡等的信息，并利用它进行冒名顶替以获得某些经济或其它方面的利益。从目前的情形来看，攻击者复制智能卡的成本不是太高，对技术条件的要求也比较低，这样就使得克隆攻击经常发生。  
**【案例】**
2004年，约翰霍普金斯大学和实验室的一些研究人员找到了DST的安全弱点，并示范了对的复制攻击这里，是由德国仪器（公司制造的一种低频设备，该设备通过内置加密功能来实现数字签名验证功能。当时，主要被用于防止汽车盗窃，已经被配备在数以万计的汽车上。研究者们的攻击显示，只通过一些少量的、简单的挑战响应对，可以破解含有的汽车钢匙，实现对的完全复制。
* * *
【3】 **芯片攻击：**
芯片是标签的核心部件，承担存储和计算功能。针对标签芯片常见的攻击手段主要有两种：电流分析攻击和故障攻击。根据实施特点，电流分析攻击可以分为
**简单电源攻击和差分电源攻击**
。故障攻击的原理是通过攻击导致一个或多个触发器出现故障，从而对标签寄存器中的数据进行破坏。该攻击的主要目的是通过一些泄漏信息，来获得芯片内密码算法信息，甚至密钥信息。  
**【案例】**
：2008年，荷兰政府宣称的芯片可以被破解。是芯片类的一大家族，被广泛应用于城市的非接触公交卡和门禁卡，据估计，当时全球至少有亿张含芯片的卡片处于使用当中。芯片的易受攻击性可被黑客利用来克隆采用该芯片的非接触卡。荷兰大学和德国大学两个独立研究小组分别证实了芯片的易受攻击性。荷兰大学实际进行了芯片的破解过程，并将项的开展过程公布的网络上，还附上一段视频，以影片的形式讲述了一个黑客团体在未知的情况下对卡进行了克隆。德国大学则发表了篇破解芯片加密算法的论文。  
（由于 Mifare 1 卡的认证与数据的传输均采用相同的安全算法和密钥，安全算法的破解使得攻击者在较短时间内即可获得 Mifare 1 卡的密钥，进而获取
Mifare 1 卡中的数据信息并可对卡中的数据做恢复或对卡进行复制。为防止此类事件的出现，目前已有一些国家宣布禁止继续使用 Mifare 1
卡，而在其它一些地区，也对 Mifare 1 卡的安全性提出了重新评估的要求。与此同时，我国也下发了相关文件，要求各级单位对 IC
卡安全工作梳理排查，采取保障措施，防止不法分子利用 Mifare 1 卡漏洞进行恶意攻击和破坏。）  
**【案例】：** 2011年，德国鲁尔大学的研究人员采用侧信道攻击，花费了七个小时，破解了使用Mifare DESFire MF3ICD40
的安全算法，获得了智能卡使用的112位加密密明，破解所需设备需要3000美元。该破解加密力法的出现将使得对RFID芯片的完美复制成为可能。
* * *
【4】可用性攻击：
毁坏攻击是攻击者在获得、接触到标签实体的情况下，对标签实体实施物理破坏。例如对天线部分进行破坏，这样将导致标签无法获得足够的通信能量，还可以导致电子标签读写距离降到最小同时，种更高级的远程攻击方法被提出，在不需要接触标签的情况下，使招相关工具产生强电磁脉  
冲来破坏标签接收电路，使得标签不能使用。该攻击的的是使标签被损，不能与读写器通信。
* * *
【5】其他攻击方式  
重放，异化，标签失效，Dos攻击，窃听攻击，中间人，等等  
**【案例】**  
2009年2月13日，恩智普全球交通事业部总经理CiaranFisher和HenriArdevol恩智普中国智能识别事业部高级经理田陌晨、职员姜晨以及芯片代理商深圳市杰灵昌科技有限公司总经理曹磊一行共5人，专门就M1芯片漏洞及其解决方案到达实公司进行了长达三个小时的交流。并针对网上流传的荷兰政府发布了一项警告进行了澄清及解释，提出此破解S50卡前题还需要以下几个前提：  
1、需要购买国外提供破解方案组织的专用设备（此设备已根据相关政府组织禁止出售）  
2、或需要拿到正在使用中的原系统的读卡设备  
3、需要接触到正在使用中的用户卡片，再针对此算法的漏洞进行暴力破解。  
具备这些条件后，复制一张卡需要10~30分钟，这种破解方式，理论上任何密码都能破解，只要有足够的时间,从原理上说就是强行对密钥算法的破解。本次密钥的破解也只是针对使用标准钥匙算法中出现的一种风险事件，但并不代表所有使用Mifare卡系统产品的加密机制全部直接采用原有钥匙。
### 5.3 M1卡的安全建议
  1. 国内很多厂商对于卡密都没有进行修改大部分都是弱密码，如 FFFFFFFFFFFF、000000000000 等而 M1 是被动卡，需要读卡器为之供能，一旦读卡器切断电源，卡中临时数据就会丢失，所以无论试错多少次密码都不会被锁定因此容易被暴力破解。可以采用复杂密码以提高安全。
  2. IC 卡分 16 个扇区，很多厂商只对和金钱有关的扇区进行加密，这样就很容易通过对比来解密加密的扇区。可易 16 个扇区全加密多加混淆以提高分析难度。
  3. 由于有些厂商对 IC 卡的加密非常信任，数据完全存放于 IC 卡中，不与数据库做交互，因此有人利用这一漏洞来修改IC卡中的信息从而达到非法的目的。这种问题的解决办法是将卡中信息存入数据库中，每次刷卡时将IC卡中的信息与数据库中的信息做对照，如果一样可以使用，如果不一样则禁止此卡使用。
  4. 逐渐 M1 卡替换成安全系数更高的 CPU 卡。