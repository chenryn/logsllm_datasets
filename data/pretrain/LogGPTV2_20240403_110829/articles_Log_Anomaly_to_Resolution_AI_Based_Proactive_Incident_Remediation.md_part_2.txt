in the ELTC and NELTC that has its size less than 3rd
1) Independent: Two Stochastic Gradient Descent (SGD)
quartileand1st quartile,respectively,islabeledasAnomalous
modelsaretrainedindependentofeachother,onetopredict
Erroneous Log Template Cluster (AELTC) and Anomalous
the Category, another to predict the Sub-Category.
Non-Erroneous Log Template Cluster (ANELTC).
2) Conditional: Two SGD models are trained, where the
At the test-time, each incoming log line is classified into one second SGD model is conditioned on the predictions of
of the two classes, erroneous or non-erroneous, followed by the first SGD model. First SGD is trained to predict the
conversion into log template. The test-time further involves Category label, with log line as input. Second SGD is
twopathways:ErroneousPathwayforerroneouslogtemplates trained to predict Sub-Category label using log line and
and the Non-Erroneous Pathway for the non-erroneous log predicted Category as input.
templates. The Erroneous Pathway checks the membership of
The log data is split into training and validation sets in the
the erroneous log template with the AELTC. If it does, then
ratio of 80:20, i.e. 7416 log lines and 1671 erroneous log
label it as anomalous. Else, it checks for membership with
linesfortrainingandvalidation,respectively.Weexperimented
the ELTC. If it does, then the label it as as non-anomalous.
with the most common set of parameters, listed in Table
Else, the incoming log line is labeled as anomalous. The
I. Parameters were fine-tuned while building the Category
Non-Erroneous Pathway checks the membership of the non-
predictionmodel.Thelearnedparametervaluesaretransferred
erroneouslogtemplatewiththeANELTC.Ifitdoesthenlabel
to the Sub-Category prediction model under both the settings,
it as anomalous. Otherwise, check the membership with the
Independent and Conditional. Table I shows the range of
NELTC. If it does not then it means that the log line was
valuesconsideredandthebestsetofparametervalueslearned
never seen before during training, and hence it is a possible
fromtheCategorypredictionmodelthatachievedanaccuracy
anomalous candidate.
of (74.85%) over the validation set. For the Independent and
Conditional models, the accuracy of Sub-Category prediction
model is (52.1%) and (55.68%) respectively. Further, we
define joint accuracy as the percentage of log lines for
which both the Category and Sub-Category were predicted
correctly; joint accuracy of the Independent and Conditional
modelsis(50.9%)and(54.49%),respectively.ForLA2R,we
1167erroneousloglinesisasubsetof1852loglines.
Fig.4. LogAnomalyTrainingandTestingPipeline
1355
Authorized licensed use limited to: University of Guelph. Downloaded on August 10,2023 at 09:01:00 UTC from IEEE Xplore. Restrictions apply.
use Conditional model as it outperformed the corresponding TABLEII
Independent counterpart for each loss type. EVALUATIONOFMETADATAPREDICTION(CATEGORY)
(A) (B) (C) (D) (E) (F) (G) (H)
MC1E 12 2 0 - JDBC JDBC Y
TABLEI MC2E 9 2 0 - Security Security N
RANGEANDTHEBESTSETPARAMETERSFORCATEGORYPREDICTION
MC3E 7 3 3 3 System System Y
Parameter Range BestValue MC4W 3 2 2 2 JDBC JDBC Y
[log,hinge,modifiedhuber, MC5E 1 1 0 - Transac Transac N
loss type log
squaredhinge,perceptron] MC6E 1 1 1 1 Perf JMS N
classifier alpha [0.00001,0.000001] 0.000001 MC7W 1 1 1 1 System WebServ Y
n-grams [(1,1),(1,2)] (1,1) MC8W 2 2 0 - Classloader HTTP Y
vectornorm [’l1’,’l2’] ’l2’
MC9I 1 1 1 1 - JDBC Y
useidf [True,False] True
MC10I 1 1 0 - - Security N
maxdf [0.5,0.75,1.0] 0.5
MC11E 1 1 0 - - System Y
MC12W 1 1 1 1 - Perf Y
IV. EVALUATION MC13I 1 1 1 1 - JPA Y
MC14W 0 3 1 0 - Security Y
Dataset and Baseline: For evaluation of LA2R, we received
MC15W 0 3 3 1 - Security N
186Kloglinesfromaproductionapplicationserver,spanning
MC16I 0 3 3 0 - Security Y
across 45 days. LAD identified 15 unique anomalous log
Total 41 28 17 11 - - -
windows and 16 unique log anomalies, each log window is on valid ground truth data only, then the predicted category
defined as a group of log anomalies grouped by start-time. accuracy is (78.57%), i.e. 11/14. The joint accuracy of the
LA2R is compared against a baseline method which uses Category and Sub-Category prediction is 62%.
MessageCode to retrieve ResolutionUrls - this is equivalent In Table II, across 16 unique log lines, LA2R returned 28
towhataSREwouldusetofindtheresolutionintheProduct (C) results as compared to 41 (B) returned by the baseline,
Documentation.Forresultvalidation,FiveSREswhomanage a reduction of (31%) in the result set; this is because LA2R
theApplicationServerproductwereconsulted,majorityvoting leverages contextual Metadata during query formulation, re-
was used to arrive at the final result. sultinginamoretargetedresultset.Usingrule-basedapproach
For each anomalous log line, a row in Table II shows the for resolution classification (Step 3 during augmented dataset
obfuscated MessageCode and the last character ’E’, ’W’, ’I’ preparationinSectionII),17/28(60%)resolutionsareactually
indicates whether it is an error, warning or informational actionable (i.e. executable). Hence, it is clear that LA2R
(columnA),numberofretrievedResolutionUrlsusingbaseline wouldderiveproductivityimprovementsbyreducingcognitive
method (B), number of retrieved ResolutionUrls using LA2R burden for the users as they do not have to go through non-
(C), number of retrieved ResolutionUrls using LA2R that actionable resolutions (e.g. reference to another repository or
contain steps that can be executed by SRE for problem messages like problem solved or no action needed or contact
diagnosis and resolution (D), validation of column D by SRE support). Finally, per SRE evaluation 11/17 (64.7%) results
(E), actual category label (F), predicted category label (G), were found relevant; and based on observations discussed
SRE validation of F and G (H). For instance, for a given above, there is a room for improvement. Furthermore, Mes-
anomalous log line, MC15W: The res1 could not be found sageCodes of type informational and warning are predictive
for element with id attribute res2, the extracted MessageCode in nature, indicating that an incident may occur in near
isMC15W,themetadatapredictionmodelpredictedCategory future. Given that LA2R leverages log data for LAD, the
is System. The formulated query is MessageCode=’MC15W’ system identifies anomalous log windows containing such
and Category=’System’ that returns 3 results using LA2R. predictive signals; based on the MessageCodes in Table II,
Whereas, for the same query, the baseline returns 0 results, 62% are informational and warning that can aid in proactive
as the MessageCode is not present in the dataset. However, remediation of incidents.
the masked log line and the predicted Category helps LA2R
V. CONCLUSIONANDFUTUREWORK
to find the matching records in the dataset. Note that among
the 3 returned results, all are actionable (i.e. executable by We have set forward our vision for an end-to-end system
SRE). However, SREs suggested that only 1 result out of 3 is for proactive incident triaging using heterogeneous data in
relevant; a result is relevant if it helps resolve the problem. AIOps environment. We have presented an end-to-end LA2R
Metadata Prediction and Resolution Retrieval: For each of system that uses predictive models for incident remediation.
the unique anomalous log line, Category is predicted using We have demonstrated the efficacy of our system on a pro-
the Conditional Metadata Prediction model. Overall accuracy duction Application Server dataset. Based on SRE feedback,
of the predicted Category is (68.75%) i.e. 11/16. For the prediction accuracy is 78% and that 64% of resolutions are
MessageCodes MC2E and MC5E, SREs indicated that the actionableandrelevant.Further,62%predictiveloganomalies
ground truth Category labels were incorrect highlighting that contain information and warning MessageCodes that can aid
the model is trained on imperfect (subjective) data. Hence, in proactive incident remediation.
curatedtrainingdatamayleadtoimprovedaccuracyofpredic- Finally, we envision a closed loop system that can learn from
tion model. We recomputed the Category prediction accuracy theLA2RsystemusageinAIOpspipelinetofurtherfine-tune
1356
Authorized licensed use limited to: University of Guelph. Downloaded on August 10,2023 at 09:01:00 UTC from IEEE Xplore. Restrictions apply.
the models to improve the quality of the anomalies detected [14] Sasho Nedelkoski, Jasmin Bogatinovski, Alexander Acker, Jorge Car-
and the results retrieved. doso,andOdejKao. Self-attentiveclassification-basedanomalydetec-
tioninunstructuredlogs,2020.
[15] XuZhang,QingweiLin,QingweiLin,and...Robustlog-basedanomaly
REFERENCES
detectiononunstablelogdata. InFSE’19,August2019.
[1] JunjieChen,XiaotingHe,QingweiLin,HongyuZhang,DanHao,Feng [16] RafiulAhad,EricChan,andAdrianoSantos. Towardautonomiccloud:
Gao,ZhangweiXu,YingnongDang,andDongmeiZhang. Continuous Automatic anomaly detection and resolution. In 2015 International
incident triage for large-scale online service systems. In 2019 34th ConferenceonCloudandAutonomicComputing,pages200–203.IEEE,
IEEE/ACMInternationalConferenceonAutomatedSoftwareEngineer- 2015.
ing(ASE),pages364–375.IEEE,2019. [17] Pinjia He, Jieming Zhu, Zibin Zheng, and Michael R Lyu. Drain:
[2] Yujun Chen, Xian Yang, Hang Dong, Xiaoting He, Hongyu Zhang, An online log parsing approach with fixed depth tree. In 2017 IEEE
Qingwei Lin, Junjie Chen, Pu Zhao, Yu Kang, Feng Gao, et al. InternationalConferenceonWebServices(ICWS),pages33–40.IEEE,
Identifying linked incidents in large-scale online service systems. In 2017.
Proceedings of the 28th ACM Joint Meeting on European Software [18] Nikhil R Pal and Sankar K Pal. Entropy: A new definition and its
EngineeringConferenceandSymposiumontheFoundationsofSoftware applications. IEEE transactions on systems, man, and cybernetics,
Engineering,pages304–314,2020. 21(5):1260–1270,1991.
[3] Animesh Nandi, Atri Mandal, Shubham Atreja, Gargi Banerjee Das-
gupta, and Subhrajit Bhattacharya. Anomaly detection using program
controlflowgraphminingfromexecutionlogs.InBalajiKrishnapuram,
Mohak Shah, Alexander J. Smola, Charu C. Aggarwal, Dou Shen,
and Rajeev Rastogi, editors, Proceedings of the 22nd ACM SIGKDD
International Conference on Knowledge Discovery and Data Mining,
San Francisco, CA, USA, August 13-17, 2016, pages 215–224. ACM,
2016.
[4] WeiXu,LingHuang,ArmandoFox,DavidA.Patterson,andMichaelI.
Jordan. Detectinglarge-scalesystemproblemsbyminingconsolelogs.
InJeannaNeefeMatthewsandThomasE.Anderson,editors,Proceed-
ings of the 22nd ACM Symposium on Operating Systems Principles
2009,SOSP2009,BigSky,Montana,USA,October11-14,2009,pages
117–132.ACM,2009.
[5] JianGuangLou,QiangFu,ShengqiYang,YeXu,andJiangLi. Mining
invariants from console logs for system problem detection. In Paul
BarhamandTimothyRoscoe,editors,2010USENIXAnnualTechnical
Conference,Boston,MA,USA,June23-25,2010.USENIXAssociation,
2010.
[6] Zhen Ming Jiang, Ahmed E Hassan, Gilbert Hamann, and Parminder
Flora. Automatic identification of load testing problems. In 2008
IEEE International Conference on Software Maintenance, pages 307–
316.IEEE,2008.
[7] QingweiLin,HongyuZhang,Jian-GuangLou,YuZhang,andXuewei
Chen. Log clustering based problem identification for online service
systems. In Laura K. Dillon, Willem Visser, and Laurie A. Williams,
editors,Proceedingsofthe38thInternationalConferenceonSoftware
Engineering,ICSE2016,Austin,TX,USA,May14-22,2016-Compan-
ionVolume,pages102–111.ACM,2016.
[8] Max Landauer, Markus Wurzenberger, Florian Skopik, Giuseppe Set-
tanni,andPeterFilzmoser. Dynamiclogfileanalysis:Anunsupervised
clusterevolutionapproachforanomalydetection.computers&security,
79:94–116,2018.
[9] Huida Qiu, Yan Liu, Niranjan A Subrahmanya, and Weichang Li.
Grangercausalityfortime-seriesanomalydetection.In2012IEEE12th
internationalconferenceondatamining,pages1074–1079.IEEE,2012.
[10] Min Du, Feifei Li, Guineng Zheng, and Vivek Srikumar. Deeplog:
Anomalydetectionanddiagnosisfromsystemlogsthroughdeeplearn-
ing. In Bhavani M. Thuraisingham, David Evans, Tal Malkin, and
DongyanXu,editors,Proceedingsofthe2017ACMSIGSACConference
on Computer and Communications Security, CCS 2017, Dallas, TX,
USA,October30-November03,2017,pages1285–1298.ACM,2017.
[11] Shayan Hashemi and Mika Ma¨ntyla¨. Detecting anomalies in software
executionlogswithsiamesenetwork,2021.
[12] Siyang Lu, Xiang Wei, Yandong Li, and Liqiang Wang. Detecting
anomaly in big data system logs using convolutional neural network.
In 2018 IEEE 16th Intl Conf on Dependable, Autonomic and Secure
Computing,16thIntlConfonPervasiveIntelligenceandComputing,4th
IntlConfonBigDataIntelligenceandComputingandCyberScience
andTechnologyCongress(DASC/PiCom/DataCom/CyberSciTech),pages
151–158,2018.
[13] WeibinMeng,YingLiu,YichenZhu,ShenglinZhang,DanPei,Yuqing
Liu,YihaoChen,RuizhiZhang,ShiminTao,PeiSun,andRongZhou.
Loganomaly: Unsupervised detection of sequential and quantitative
anomalies in unstructured logs. In Proceedings of the Twenty-Eighth
InternationalJointConferenceonArtificialIntelligence,IJCAI-19,pages
4739–4745. International Joint Conferences on Artificial Intelligence
Organization,72019.
1357
Authorized licensed use limited to: University of Guelph. Downloaded on August 10,2023 at 09:01:00 UTC from IEEE Xplore. Restrictions apply.