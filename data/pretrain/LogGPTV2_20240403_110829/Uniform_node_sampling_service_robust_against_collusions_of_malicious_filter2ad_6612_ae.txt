and Lk,t =  104,  while 
launch a  flooding 
attack. 
successful, 
malicious 
fully robust against 
equal to Lk,t =  38 
it is equal to Ek =  44 and Ek =  110 to 
both attacks 
are 
of 
is 
the sampler service 
node identifiers. 
0.9 and 0.9999 is respectively 
Note that the omniscient 
Note that although 
both attacks. 
by  3 the 
divides 
strategy 
that need to be injected 
frequencies 
Figure 8 complements 
G K L of  the output stream over the  input 
Kullback-Leibler 
abuse of language D( IJ, U) (respectively 
Figure 7(a)  by showing the gain 
stream w.r. t. the 
let us denote by 
D( IJ', U)) as the 
Specifically, 
divergence. 
100000 r-----r----,--,---,------r----,--,---,------r-, 
Input Stream -­
Knowledge-free 
Omniscient 
strategy ---------
strategy·· .. .. .. 
. 
10000 
1 000  
Max frequency for Knowledge-free  strategy 
10------- 
o  100  200  300  400  500  600  700 
800 
900 1000 
Node identifier 
(a) The  input 
with a  = 4. 
distribution 
stream is biased by a peak attack generated 
by Zipfian 
1200 ,--------r---,----,--,---,------,----r----,----.---, 
Input Stream -­
strategy --------­
Knowledge-free 
Omniscient 
strategy·· .. 
to make  a targeted  attack  successful  with 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:44:04 UTC from IEEE Xplore.  Restrictions apply. 
-:":""""""""'''''--------------------------
Kullback-Leiber 
(respectively 
divergence 
output stream IJ') and a uniform one U, then 
between a given input stream IJ 
G  - 1 _ D(IJ', U) 
. 
KL -
D(IJ, U) 
and shows that the 
strategy 
This figure confirms the impressive 
scient strategy, 
knowledge-free 
system. 
Note that the 
the KL distance 
uniform stream. 
against 
robustness 
of  the omni­
pretty good resilience 
a peak attack in a very large 
of the 
inset graph in Figure 8 simply illustrates 
between the input and output streams 
and the 
09 .. .. >:':':::>':"
0.96 ! 
i 0.94 ! ! 0.92  ! 
0.9 J 
i 0.88 
0.86 
0.84 "-_"-_
o  100 200 300 400 500 600  700 
strategy" ,-..... 
800 900 1000 
------_.­
strategy 
L...::'--"---' 
Knowledge-free 
Omniscient 
Input Stream -­
Knowledge-free 
Omniscient 
strategy ---------
strategy" .. .. .. 
. 
(a) The input stream is biased by a peak attack generated 
by Zipfian distribution 
0.98 
0.96 
i;! \) .5 o 
g 2 5  .
0.94 
 c - 1.5 :l 1  0.5 
0.92 
0.9 "- __ _L-__ 
10 
o -
10 
100 
\000 
100 
  __ 
n value 
...-....J 
1000 
Fig.  8. G K L as  a  function 
biased by a peak attack generated 
m  = 100,000, k = 10, c  = 10, s  = 17. 
of the population 
size n. The  input 
by Zipfian  distribution 
with Q  = 4. Settings: 
stream is 
...L.-_ ...L.._ ....L._-'-_--'_--' __ 
c value 
with Q  = 4. :: ···· - -:/>:;= '="
: 
! 04 ! . i 
/ 0.2  ! : 
- .. ------
0.98 
0.96 
i;! 0.94 
\) c 
8 0.92 
0.9 
0.88 
! 
0.86 
/,-./v"-... -
····--····
-
····-···· -···­
10000 
Knowledge-free 
Omniscient 
------_.­
strategy 
.0 ••• 0 .0 . 
strategy 
100000  le+06 
111 value 
Fig. 9. G K L as a  function 
biased by a peak attack generated 
n  = 1,000, k = 10, c  = 10, s  = 17. 
of the population 
size m. The input stream is 
by Zipfian distribution 
with Q  = 4. Settings: 
Figure 9 shows that both  output 
streams (the one con­
and the knowledge-free 
strategy 
regime (i.e., a uniform stream) 
with  the 
structed 
omniscient 
one) reach their stationary 
very quickly. 
adversarially 
omniscient 
stream made of 1,000 distinct 
elements 
of  the  input 
strategy 
The first 3,000 (non necessarily 
ordered) 
are sufficient 
unbiased 
to build a definitively 
and 
for the 
output 
node identifiers 
distinct 
ids, while it takes 3 times more 
o  100 200 300 400 500 600 700  800  900 
o L- _  _ ...L.._ ....L._ -'- _ --' _ _ L-0 _m_nisc_ie_nJ_stra_tegY" L·"_"_" 
1000 
Knowledge-free 
strategy ---------
c value 
(b) The input stream is biased by both targeted 
by truncated 
Poisson  distribution 
with>. = . 
and flooding attacks 
generated 
Fig. 10. G K L as a function 
memory r. Settings: 
of the number of entries 
m  = 100,000, n  = 1,000, k = 10, s  = 17. 
c o f  the sampling 
to reach this stationary 
the very limited 
regime. This is still impressive 
given 
space of  the latter 
strategy. 
storage 
Figures l O(a)  and 
l O(b) illustrate 
the intuitive 
fact that 
c of  sampling 
the number of entries 
memory is 
increasing 
respectively 
a very powerful  defense  against 
peak attacks 
and 
targeted 
In  the former case, the peak 
attack is completely 
as soon as c =  300, while  in  the 
flooding attacks 
masked by the knowledge-free 
later case, both targeted 
and 
=  10). 
are masked for c =  700 (both with  k 
and flooding attacks. 
strategy 
Figure 1 1  illustrates 
as a function 
the gain obtained 
with the knowledge­
of  the number of malicious 
node 
in the input stream. 
the 
Obviously, 
nodes once their 
overrepresented 
becomes vulnerable 
10% of the full 
to malicious 
population 
of the 
according 
system. 
to  the result 
This 
free strategy 
identifiers 
strategy 
number reaches 
behavior 
presented 
moves theory into practice 
in Table I. 
stream for the knowledge-free 
strategy 
behavior 
of the omniscient 
Finally, 
Figure 12 illustrates 
provides 
in a real environment 
the fact running the sampler 
very good results. 
Note 
strategy. 
service 
the perfect 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:44:04 UTC from IEEE Xplore.  Restrictions apply. 
node identifiers. 
[ 1 0] E. Bortnikov, 
M. Gurevich, 
I. Keidar, 
G. Kliot, 
and A. Shraer, 
Byzantine  Resilient  Random  Membership  Sampling," 
works, 
vol. 53, pp. 2340-2359, 2009. 
"Brahms: 
Computer 
Net­
[4] L. Massoulie, 
E.  L. Merrer, 
and Sanlpling 
Counting 
ods,"  in Proceedings 
Distributed 
Compltling 
R. Rejaie, 
on Networki
P. Jesi, A. Montresor, 
Networks, 
[5] D. Stutzbach, 
biased Sampling 
Transactions 
Computer 
A.-M. Kermarrec, 
and A. Ganesh, "Peer 
in Overlay Networks: 
Random Walk Meth­
of the 25th Annual 
of 
(pODC). 
ACM Press, 2006, pp. 1 23-132. 
N. Duffield, S. Sen, and W. Willinger, 
"On Un­
IEEElACM 
ng, vol. 17, no.  02,  pp. 
2009. 
and M. van Steen, "Secure 
vol. 54, no. 12, pp. 2086-2098, 2010. 
for Unstructured 
Peer-to-Peer 
Networks," 
377-390, 
[6]  G. 
Peer Sampling," 
Symposium on Principles 
[7] D. Liu, P. Ning, and W. Du, "Detecting 
Discovery 
cure Location 
of the 25th IEEE International 
Conference 
Systems 
(ICDCS), 2005. 
in Wireless 
Malicious 
Beacon Nodes for Se­
Sensor Networks," 
in Proceedings 
on Distributed 
Compltling 
[8] A. Singh, T-W. Ngan, P. Druschel, 
[9] J. Douceur and J. S. Donath, 
Threats 
on Computer 
on Overlay Networks: 
Inti Conference 
lrst International 
Workshop 
pp.251-260. 
and  D.  S. 
Wallach, 
"Eclipse 
in Proc. of 
and Defenses," 
(INFO COM), 2006. 
Communications 
in Proceedings 
"The  Sybil 
on Peer-to-Peer 
Systems 
Attacks 
the 25th IEEE 
of the 
(IPTPS), 2002, 
Attack," 
[ I I ]  E. Anceaume, 
Y. Busnel, 
pling in Unstructured 
of the 14th International 
Proceedings 
Conference 
Distributed 
Systems 
vol. 6490, 2010, pp. 64-78. 
Algorithms 
[ 1 2] Muthukrishnan, 
Peer-to-Peer 
(OPODIS), 
Data Streams: 
Ergodic Sam­
Nodes," 
in 
On Principles Of 
Systems with Malicious 
and Applications. 
Now 
and  S.  Gambs,  "Uniform  and 
Publishers 
Inc., 2005. 
[ 1 3] Z. Bar-Yossef, T S. Jayram, 
R. Kumar, D. Sivakumar, 
and L. Trevisan, 
"Counting 
the 6th International 
Workshop 
Techniques 
of 
distinct  elements 
in  a data stream," 
on Randomization 
(RANDOM). Springer-Verlag, 
2002, pp. 1-10. 
counting 
"Probabilistic 
and G. N. Martin, 
and System Sciences, 
base applications," 
no. 2 ,  pp. 1 82-209, 1 985 . 
in Proceedings 
and Approximation 
Journal of Computer 
for data 
vol. 3 1 ,  
algorithms 
[ 1 4] P. Flajolet 
[ 1 5]  D. M. Kane, J. Nelson, 
for the distinct 
Principles 
and  D. P. Woodruff, "An optimal algorithm 
in Proceedings 
element problem," 
(PODS), 
2010. 
of the Symposium 
of Databases 
[ 1 6] N. Alon, Y. Matias, and M. Szegedy, 
"The space complexity 
of 
of the twenty­
in Proceedings 
moments," 
(STOC), 
on Theory of computing 
1 996, 
the frequency 
ACM symposium 
on 
K. Chen, and M. Farach-Colton, "Finding 
Theoretical 
Computer 
Science, 
frequent 
vol. 3 1 2 ,  no. I, pp. 
items 
in data streams," 
3-15,2004. 
[ 1 8] A. Chakrabarti, 
for computing 
algorithm 
Symposium on Discrete 
[ 1 9] A. Lall, V. Sekar, M. Ogihara, 
"A near-optimal 
G. Cormode, and A. McGregor, 
in In ACM-SIAM 
the entropy of a stream," 
Algorithms, 
335. 
2007, pp.  328-
J. Xu, and H. Zhang, "Data streaming 
entropy of network traffic," 
conference on Measurement and modeling 
in Proceedings 
of 
algorithms 
of the joint 
computer 
for estimating 
international 
systems 
"An information 
over  data 
Symposium 
streams," 
on Network 
[20] E. Anceaume and Y. Busnel, 
(SIGMETRICS). ACM, 2006. 
in Proceedings 
Algorithms. 
and  I. Stoica, 
in Proceedings 
[23] G. Corm ode and S. Muthukrishnan, 
[21] N. Lynch, Distributed 
[22]  P. 
divergence 
of the 11th IEEE International 
and Applications 
(NCA), 2012. 
Morgan Kaufmann Publishers, 
of the ACM 
"Minimizing 
SIGCOMM, 
2006. 
Journal of Algorithms, 
sketch and its applications," 
1 996. 
churn  in 
dis­
Computing 
"An improved 
estimation 
B .  Godfrey, 
S. Shenker, 
systems," 
data stream sum­
tributed 
mary: the count-min 
vol. 55, no.  I, 
pp. 58-75, 2005. 
0.7 
0.6 
0.5 
;;;j 0.4 
\:) c 8 0.3 
0.2 
0.1 
Knowledge-free 
strategy········· 
Number of malicious 
node identifiers 
Fig. I I .  G K L as  a function 
Settings: 
of the number of malicious 
m  = 100,000, n  = 1 ,000, c  = 50, k = 50, s  = 10. 
Input Slream 
2.5 c:::s:::s:::s:: Knowledge-free 
Knowledge-free 
strategy 
_ 
c::::::::::J Omniscient 
strategy 
slrategy 
- c = k = log n 
- c = k = O.Oln 
g 5b  
Ci 
B  1.5 
.., :3 
 -,; '" 
0.5 
-
.      
annual 
Fig. 12. Kullback-Leibler  divergence  between  the  different 
and output ones)  and  the  un i 
approximating 
eighth 
pp.20-29. 
[ 17] M. Charikar, 
streams (input 
form one. 
VII. CONCLUSION 
In this paper, we have studied 
the  node  sampling 
problem 
of malicious 
nodes in  a very large system by 
a probabilistic 
approach. 
We have proposed 
and 
two online algorithms. 
to any attacks 
in presence 
adopting 
analyzed 
resilient 
the knowledge-free 
the impact of adversarial 
space. As future work, we plan to analyze the transient 
behavior 
lumpability 
by  using 
in Markov chains described 
one is fully 
The omniscient 
by  a strong adversary, 
while 
on weak 
in [26] and [27]. 
one is capable of drastically 
of the sampling 
service 
very small memory 
decreasing 
the results 
by  using 
launched 
attacks 
REFERENCES 
[ I I  Q. Lv, P. Cao, E. Cohen, K. Li, and S. Shenker, 
Networks," 
Peer-to-Peer 
cation in Unstructured 
International 
Conference on Supercomputing 
(ICS), 
in Proceedings 
Repli­
of the 
2002,  pp. 
84-95. 
"Search  and 
[21 B .  Bollobas, Random Graphs -2nd Edition. Cambridge 
University 
Press, 200 1 .  
[ 3 1   A .  
Demers, D. Greene, C. Hauser, W. Irish, 
J .  Larson, 
S. Shenker, 
H. Sturgis,  D. 
cated database 
on Principles 
Swinehart, 
and D. Terry, 
mangement," 
of Distributed 
"Epidemic 
in Proceedings 
Computing 
(PODC), 
1 987. 
algorithms 
for repli­
of the 6th ACM Symposium 
''http:/
v/htmlltrac
Laboratory, 
/ita.ee.lbl.go
[25] S. Kullback 
Berkeley 
Annals 
[On line]. Available: 
[24] T I. T Archive, 
National 
Apr. 2008. 
"On information 
of Mathematical 
[26] J. G. Keneny and J. L. Snell, Finite 
[27] G. Rubino and B. Sericola, 
Statistics, 
vol. 22,  no. 
http://dx .doi.orgll 0.2307/2236703 
Markov Chains. 
"On weak lumpability 
and R. A. Leibler, 
Journal of Applied Probability, 
vol. 26, 1 989. 
es.html,'' Lawrence 
The 
and sufficiency," 
I ,  pp. 79-86, 1 95 1 .  
Springer-v., 
in  Markov 
chains," 
1 976. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:44:04 UTC from IEEE Xplore.  Restrictions apply.