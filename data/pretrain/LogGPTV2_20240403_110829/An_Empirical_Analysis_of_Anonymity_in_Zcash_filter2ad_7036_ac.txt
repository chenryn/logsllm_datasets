t-addresses, each receiving 1,000 ZEC. None of these
t-addresses had done a transaction before then, and
none have been involved in one since (i.e., the coins
received in this transaction have not yet been spent).
“One-man wolf packs” Both of the deposit spikes in
the graph correspond to single large deposits from un-
known t-addresses that, using our analysis from Sec-
tion 5, we identiﬁed as residing in single-address clus-
ters. For the ﬁrst spike, however, many of the de-
posited amounts came directly from a founder address
identiﬁed by our heuristics (Heuristic 3), so given our
analysis in Section 6.1 we believe this may also be
associated with the founders.
While this ﬁgure already provides some information
about how the pool is used (namely that most of the
money put into it is withdrawn almost immediately af-
terwards), it does not tell us who is actually using the
pool. For this, we attempt to associate addresses with the
types of participants identiﬁed in Section 3.2: founders,
miners, and ‘other’ (encompassing both services and in-
dividual users).
When considering deposits into the shielded pool, it is
easy to associate addresses with founders and miners, as
the consensus rules dictate that they must put their block
rewards into the shielded pool before spending them fur-
ther. As described in Section 5.2, we tagged founders ac-
cording to the Zcash parameters, and tagged as miners all
recipients of coingen transactions that were not founders.
We then used these tags to identify a founder deposit
as any t-to-z transaction using one or more founder ad-
dresses as input, and a miner deposit as any t-to-z trans-
action using one or more miner addresses as input. The
results are in Figure 6.
Looking at this ﬁgure, it is clear that miners are the
main participants putting money into the pool. This is
not particularly surprising, given that all the coins they
receive must be deposited into the pool at least once, so
if we divide that number of coins by the total number
deposited we would expect at least 63.7% of the deposits
to come from miners.
(The actual number is 76.7%.)
Founders, on the other hand, don’t put as much money
into the pool (since they don’t have as much to begin
with), but when they do they put in large amounts that
cause visible step-like ﬂuctuations to the overall line.
Figure 5: Over time, the amount of ZEC put into the shielded
pool (in red) and the amount taken out of the pool (in blue).
ileak’s t-address were made as t-to-t transactions. None
of these belong to clusters, as they have never sent a
transaction.
6
Interactions with the Shielded Pool
What makes Zcash unique is of course not its t-addresses
(since these essentially replicate the functionality of Bit-
coin), but its shielded pool. To that end, this section ex-
plores interactions with the pool at its endpoints, mean-
ing the deposits into (t-to-z) and withdrawals out of the
pool (z-to-t). We then explore interactions within the
pool (z-to-z transactions) in Section 7.
To begin, we consider just the amounts put into and
taken out of the pool. Over time, 3,901,124 ZEC have
been deposited into the pool,3 and 3,788,889 have been
withdrawn. Figure 5 plots both deposits and withdrawals
over time.
This ﬁgure shows a near-perfect reﬂection of deposits
and withdrawals, demonstrating that most users not only
withdraw the exact number of ZEC they deposit into the
pool, but do so very quickly after the initial deposit. As
we see in Sections 6.1 and 6.2, this phenomenon is ac-
counted for almost fully by the founders and miners.
Looking further at the ﬁgure, we can see that the sym-
metry is broken occasionally, and most notably in four
“spikes”: two large withdrawals, and two large deposits.
Some manual investigation revealed the following:
“The early birds” The ﬁrst withdrawal spike took place
at block height 30,900, which was created in Decem-
ber 2016. The cause of the spike was a single trans-
action in which 7,135 ZEC was taken out of the pool;
given the exchange rate at that time of 34 USD per
ZEC, this was equivalent to 242,590 USD. The coins
were distributed across 15 t-addresses, which initially
3This is greater than the total number of generated coins, as all coins
must be deposited into the pool at least once, by the miners or founders,
but may then go into and out of the pool multiple times.
USENIX Association
27th USENIX Security Symposium    469
Oct-2016Jan-2017Apr-2017Jul-2017Oct-2017Jan-2018Date-10-5051015Deposits-Withdrawals in each block (In thousands)DepositsWithdrawalsbe “ruled out” of the anonymity set of future users with-
drawing coins from the pool. We thus devote our atten-
tion to this type of analysis for the rest of the section.
The most na¨ıve way to link together these transactions
would be to see if the same addresses are used across
them; i.e., if a miner uses the same address to withdraw
their coins as it did to deposit them. By running this
simple form of linking, we see the results in Figure 8a.
This ﬁgure shows that we are not able to identify any
withdrawals as being associated with founders, and only
a fairly small number as associated with miners: 49,280
transactions in total, which account for 13.3% of the total
value in the pool.
Nevertheless, using heuristics that we develop for
identifying founders (as detailed in Section 6.1) and min-
ers (Section 6.2), we are able to positively link most of
the z-to-t activity with one of these two categories, as
seen in Figures 8b and 8c. In the end, of the 177,009 z-
to-t transactions, we were able to tag 120,629 (or 68%) of
them as being associated with miners, capturing 52.1%
of the value coming out of the pool, and 2,103 of them as
being associated with founders (capturing 13.5% of the
value). We then examine the remaining 30-35% of the
activity surrounding the shielded pool in Section 6.3.
6.1 Founders
After comparing the list of founder addresses against the
outputs of all coingen transactions, we found that 14 of
them had been used. Using these addresses, we were
able to identify founder deposits into the pool, as already
shown in Figure 6. Table 3 provides a closer inspection
of the usage of each of these addresses.
This table shows some quite obvious patterns in the
behavior of the founders. At any given time, only one
address is “active,” meaning it receives rewards and de-
posits them into the pool. Once it reaches the limit of
44,272.5 ZEC, the next address takes its place and it is
not used again. This pattern has held from the third ad-
dress onwards. What’s more, the amount deposited was
often the same: exactly 249.9999 ZEC, which is roughly
the reward for 100 blocks. This was true of 74.9% of
all founder deposits, and 96.2% of all deposits from the
third address onwards. There were only ever ﬁve other
deposits into the pool carrying value between 249 and
251 ZEC (i.e., carrying a value close but not equal to
249.9999 ZEC).
Thus, while we were initially unable to identify any
withdrawals associated with the founders (as seen in Fig-
ure 8a), these patterns indicated an automated use of
the shielded pool that might also carry into the with-
drawals. Upon examining the withdrawals from the
pool, we did not ﬁnd any with a value exactly equal to
249.9999 ZEC. We did, however, ﬁnd 1,953 withdrawals
Figure 6: Over time, the amount of ZEC deposited into the
shielded pool by miners, founders, and others.
Figure 7: The addresses that have put more than 10,000 ZEC
into the shielded pool over time, where the size of each node is
proportional to the value it has put into the pool. The addresses
of miners are green, of founders are orange, and of unknown
‘other’ participants are purple.
In terms of the heaviest users, we looked at the indi-
vidual addresses that had put more than 10,000 ZEC into
the pool. The results are in Figure 7.
In fact, this ﬁgure incorporates the heuristics we de-
velop in Sections 6.1 and 6.2, although it looked very
similar when we ran it before applying our heuristics
(which makes sense, since our heuristics mainly act to
link z-to-t transactions). Nevertheless, it demonstrates
again that most of the heavy users of the pool are miners,
with founders also depositing large amounts but spread-
ing them over a wider variety of addresses. Of the four
‘other’ addresses, one of them belonged to ShapeShift,
and the others belong to untagged clusters.
While it is interesting to look at t-to-z transactions
on their own, the main intention of the shielded pool is
to provide an anonymity set, so that when users with-
draw their coins it is not clear whose coins they are. In
that sense, it is much more interesting to link together
t-to-z and z-to-t transactions, which acts to reduce the
anonymity set. More concretely, if a t-to-z transaction
can be linked to a z-to-t transaction, then those coins can
470    27th USENIX Security Symposium
USENIX Association
Oct-2016Jan-2017Apr-2017Jul-2017Oct-2017Jan-2018Date0.511.522.533.54Total Value (in millions)AllFoundersMinersOthers(a) No heuristics
(b) Founder heuristic
(c) Founder and miner heuristics
Figure 8: The z-to-t transactions we associated with miners, founders, and ‘other’, after running some combination of our heuristics.
# Deposits Total value
19,600.4
43,944.6
44,272.5
44,272.5
44,272.5
44,272.5
44,272.5
44,272.5
44,272.5
44,272.5
44,272.5
44,272.5
44,272.5
17,500
568,042.5
548
252
178
192
178
178
178
178
190
188
190
178
191
70
2889
1
2
3
4
5
6
7
8
9
10
11
12
13
14
Total
# Deposits (249)
0
153
177
176
177
177
177
177
176
176
176
177
175
70
2164
Table 3: The behavior of each of the 14 active founder ad-
dresses, in terms of the number of deposits into the pool, the
total value deposited (in ZEC), and the number of deposits car-
rying exactly 249.9999 ZEC in value.
of exactly 250.0001 ZEC (and 1,969 carrying a value be-
tween 249 and 251 ZEC, although we excluded the extra
ones from our analysis).
The value alone of these withdrawals thus provides
some correlation with the deposits, but to further explore
it we also looked at the timing of the transactions. When
we examined the intervals between consecutive deposits
of 249.9999 ZEC, we found that 85% happened within
6-10 blocks of the previous one. Similarly, when ex-
amining the intervals between consecutive withdrawals
of 250.0001 ZEC, we found that 1,943 of the 1,953
withdrawals also had a proximity of 6-10 blocks.
In-
deed, both the deposits and the withdrawals proceeded
in step-like patterns, in which many transactions were
made within a very small number of blocks (resulting
in the step up), at which point there would be a pause
while more block rewards were accumulated (the step
across). This pattern is visible in Figure 9, which shows
the deposit and withdrawal transactions associated with
the founders. Deposits are typically made in few large
Figure 9: Over time, the founder deposits into the pool (in red)
and withdrawals from the pool (in blue), after running Heuris-
tic 3.
steps, whereas withdrawals take many smaller ones.
Heuristic 3. Any z-to-t transaction carrying 250.0001
ZEC in value is done by the founders.
In terms of false positives, we cannot truly know how
risky this heuristic is, short of asking the founders. This
is in contrast to the t-address clustering heuristics pre-
sented in Section 5, in which we were not attempting to
assign addresses to a speciﬁc owner, so could validate
the heuristics in other ways. Nevertheless, the high cor-
relation between both the value and timing of the trans-
actions led us to believe in the reliability of this heuristic.
As a result of running this heuristic, we added 75 more
addresses to our initial list of 48 founder addresses (of
which, again, only 14 had been used). Aside from the
correlation showed in Figure 9, the difference in terms
of our ability to tag founder withdrawals is seen in Fig-
ure 8b.
6.2 Miners
The Zcash protocol speciﬁes that all newly generated
coins are required to be put into the shielded pool be-
fore they can be spent further. As a result, we expect that
a large quantity of the ZEC being deposited into the pool
are from addresses associated with miners.
USENIX Association
27th USENIX Security Symposium    471
Oct-2016Jan-2017Apr-2017Jul-2017Oct-2017Jan-2018Date0.511.522.533.5Total Value (in millions)AllFoundersMinersOthersOct-2016Jan-2017Apr-2017Jul-2017Oct-2017Jan-2018Date0.511.522.533.5Total Value (in millions)AllFoundersMinersOthersOct-2016Jan-2017Apr-2017Jul-2017Oct-2017Jan-2018Date0.511.522.533.5Total Value (in millions)AllFoundersMinersOthersOct-2016Jan-2017Apr-2017Jul-2017Oct-2017Jan-2018Date102030405060Total value (In tens of thousands)DepositsWithdrawalsName
Flypool
F2Pool
Nanopool
Suprnova
Coinmine.pl
Waterhole
BitClub Pool
MiningPoolHub
Dwarfpool
Slushpool
Coinotron
Nicehash
MinerGate
Zecmine.pro
Addresses
3
1
2
1
2
1
1
1
1
1
2
1
1
1
t-to-z
65,631
742
8319