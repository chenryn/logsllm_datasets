通过上面的测试统计结果，我们可以清晰的看到：市面上三个主流方案均受假指纹的影响，可以顺利解锁，而各家所谓的生物识别、活体识别等似乎都没有奏效。
这里需要指出的是，虽然三个主流方案都受到影响，但是表现出的攻击难易度、特点各不相同，其中我们花费了很多时间在汇顶的方案上，经过多次反复优化、测试才得以通过，安全性在三者中相对最高。详情如下：
  * FPC方案：对指纹大小比例较不敏感，对导电特性的要求不敏感，接受优化过的指纹图像
  * AuthenTec方案：对指纹大小比例很不敏感，对导电特性的要求敏感，接受优化过的指纹图像
  * 汇顶方案：似乎对我们的指纹优化不买账，需要十分精确的对指纹纹路进行克隆，比例和导电性要求都很敏感，是我们测试的所有方案中攻破难度最大的一家。
#### 5 脆弱性分析及攻击场景
##### 5.1 活体检测貌似并不奏效
**概念解读**
先来看一下活体检测的官方解释。2014年6月，国家知识产权局专利局王馨宁审查员发表了《生物特征识别中的“活体检测”概念及分析》，作为专利审查工作中遵循的科技名词定义规范。其中活体检测概念定义为：“为了防止恶意者将伪造的他人生物特征用于身份认证，在生物特征识别过程中，针对待认证样本的是否具有生命特征进行检测的技术，称为活体检测。活体检测是将具有生命特征的人的样本，与仿制的人造样本进行区分的过程，是欺骗检测中的一种”。
**实际情况**
了解官方解释和测试标准后，我们来看下当前指纹识别的活体检测防范攻击情况和我们的待测假体的攻击级别。
首先介绍下指纹识别中各家常用的活体识别方案：
  * 对于光学传感器，一般都没有任何活体检测方案。少数会声称有如下方法：玻璃使用导电材料，主控检测是否带电（例如走廊的触控感应电灯）；检测玻璃温度。这里有个很奇怪的现象，主控检测是否带电主要是为了感应手指接触，接触时打开led光源，同时通知传感器采集指纹。而这样一种本身的功能需求实现竟然变成了一个活体检测的方法。
  * 同样的现象也存在电容传感器中。很多厂家会声称自家的模块带有手指导电性检测，以此来判断是否是真手指。但是根据前面的成像原理我们可以知道，电容传感器电荷感应是建立在手指导电的基础上的，是本身识别实现的要求，并不是一个加持检测方法。
下面我们分别对手机上的这三种指纹方案活体检测能力做下分析：
首先看下Apple的情况。网上关于IPhone 6系列手机的指纹模块安全性资料显示，touch
ID很可能采用了更加先进的活体识别方式（有大量关于射频真皮识别的新闻）。查阅相关专利，确实发现苹果在这方面有所研究，例如苹果公司的US 8180120
B2专利，使用固定角度的偏振光对手指进行照射，根据获取到的手指中的氧合血红蛋白和脱氧血红蛋白、β-胡萝卜素等等光谱情况来判断真假手指。但是这种技术是否在TouchID中有使用呢？答案当然是没有，否则我们的假指纹攻击也不会通过。查阅了苹果官网对TouchID的安全性介绍，我们可以发现，Touch
ID仍然还是传统单一的电容检测技术，只是苹果强调了它的精度是很高的。
图29 苹果官网对TouchID的安全性介绍
再来看看指纹识别处于领军地位的Fingerprints，以手机厂商1最新M系列上的FPC 1025为例，通过查阅Fingerprints公司对FPC
1025介绍，并没有发现提及活体检测方面的安全内容。
最后看下近来势头很猛的汇顶科技。其官网介绍文中有提到具有通过血液、心率信号检测来识别假指纹的技术。但是在我们测试的使用汇顶方案手机厂商5的X系列和手机厂商6的M系列产品中，依然可以通过我们制作的假指纹通过验证。可能这些手机并没有采用带这些高级活体检测的传感器，我们不得而知。
图30 汇顶科技官网上对其方案中活体检测技术的介绍
通过上面的分析，我们可以得出一个结论：现阶段拥有指纹识别模块的产品中，基本上没有使用有效的活体检测的技术去对抗攻击。
##### 5.2 极低的攻击成本：5-5攻击
我们一直认为，一切不切合实际的、超高成本的攻击方法，都是耍流氓。举个例子，最近IPhoneX很火，大家都在致力于破解FaceID。不少研究机构使用了高精度3D打印、高精度脸膜制作等方法，即使证明了可以破解，也很难在现实场景中产生危害。在一个安全漏洞的安全等级确定中，攻击成本占很大一部分分值。只有当这个安全问题的攻击成本很小，但是可以产生很大的危害时，才有可能影响到大部分人的利益，大家才会受到重视并且想办法去解决。
我们顺便再看下待测假体的攻击级别定义。在由多家单位、企业共同起草的行业标准《安防生物特征活体检测技术要求》的征求意见稿中，对待测假体类型划分了轻度、中度和重度三个级别：
  1. 轻度攻击性假体指以简单的技术手段为工艺获得的、具有低攻击能力的假体
  2. 中度攻击性假体是指以复杂的技术手段为工艺获得的、具有一定攻击能力的假体
  3. 重度攻击性假体是指以非常复杂的技术手段为工艺手段制造的、具有极高攻击能力、十分逼真的假体
根据这个级别划分定义，结合我们之前假指纹制作中所使用方法，以及攻击成本和达到的效果，我们的攻击方式可以划分到一个新级别：
以简单的技术手段为工艺获得的、具有很高攻击能力的假体。
回到我们探讨的指纹安全问题上，我们在前面的测试中已经实现了低成本的指纹图像获取和假指纹的制作，最终结果是可以顺利通过各种指纹验证。现在我们来总结下成本究竟有多低。
可见，最低成本只需要一部能拍照的手机、一个能用的打印机、一块几毛钱的光敏材料和一根铅笔就够了，一次性耗材不超过5角钱，制作时间不超过5分钟，我们称之为5-5攻击。
##### 5.3 其实你只剩一枚指纹
指纹、虹膜、人脸、静脉这些生物特征，是人生下来就有的，并且具有不重复唯一性，可以用来很精准的对一个人进行识别判断。在大家意识中，生物特征识别的安全性要高于传统密码的，同时生物特征又有验证便捷的特点（相对于密码输入）。但是大家可能忽略了一点：这些生物特征数量少而且无法更改，一旦泄露就会存在安全风险，除非是剁手指、整容&毁容、扣眼珠，开个玩笑。而密码，如果用了一个弱口令被猜出来了，你还可以换一个更复杂的。拿指纹举例来说，一个人的指纹只有十枚，泄露了就再也无法挽回。更重要的一点，我们经常使用的手指，只有一或两枚，我们做了一个20个人的小样本统计，统计结果如下：（由于手机指纹识别有正面和背面两种，分别对应拇指和食指，这里我们统一为拇指）
统计结果显示：
  * 没有人用单一偏门手指进行解锁的（例如无名指）
  * 所有人都录入了一枚右手拇指
通过数据来看，似乎只需要得到一枚被攻击者的右拇指指纹，便可以进行假指纹制作完成解锁手机，而不是之前的十个手指。也就是说，泄露机会从10次变成了一次，只要泄露一根拇指，指纹这个生物特征识别就和你拜拜了。而这个泄露，通常来说非常简单，招一招手，或者拿一下杯子、手机，指纹已经泄露了。
#### 6 总结与展望
综合前文分析，我们可以得出：
  * 由于大部分指纹模块都缺少对活体的识别，这给假指纹攻击带来了极大的便利，无需进行各种防御手段绕过，降低了攻击成本，同时提高了成功率
  * 由于指纹识别的原理（指纹采集、验证），我们找到了一套低成本的假指纹制作方案5-5攻击，表明假指纹攻击的威胁远比大家普遍认识的更加严重
  * 由于大部分用户只使用少数的固定手指进行验证，增大了指纹信息泄露的风险，即只需要少数手指的泄露，便可造成被攻击者指纹验证系统被破解。
通过上面的介绍，我们可以看出，看似便捷又安全的指纹识别验证，其实很容易被仿制攻破。既然存在了安全风险，就需要解决方案。通常对于软件层面的一些安全问题，都可以通过系统升级解决，对出问题的代码进行打补丁，一定时间的收敛后，威胁会大大降低。而我们今天所展示的是硬件指纹识别模块层面的安全问题，很多是由于硬件层面对安全考虑的不充分导致的，例如模块本身并没有设计足够抵抗假指纹的活体检测功能，也没有相应的传感器（例如真皮检测传感器）。这种硬件功能设计上的缺失，很难通过软件更新去解决。
在此，我们呼吁指纹方案厂商、手机厂商增强指纹防攻击方面的能力，让每一个人可以安全、便捷的使用指纹识别。包括：指纹模块制造商需要增强指纹模块的活体检测能力，例如对手指真皮进行检测、对脉搏进行检测，同时手机厂商应该优先采购这些安全性高的模块；高安全需求的场合，采用多因素复合认证，同时建议多采用基于用户行为习惯的识别、基于行为风控的判断。
* * *