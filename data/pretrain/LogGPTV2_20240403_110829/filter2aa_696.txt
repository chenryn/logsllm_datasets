The Bieber Project 
Ad Tech and Fraud 101 
Mark Ryan Talabis, zvelo 
zvelo proprietary and confidential 
Introduction 
! Chief Security Scientist, zvelo 
▫ Ad Tech Fraud Research 
! Formerly, Cloud Email Threat Protection, Fireeye 
!  Alumni Member, Honeynet Project 
"   Honeypots/Honeynets 
! Author, Elsevier-Syngress 
"  Information Security Analytics/Risk Management 
zvelo proprietary and confidential 
Main Topics 
! The Business and Currency of Digital Advertising 
! Ad Tech: The Ecosystem 
! The Ad Fraud Problem 
! Publisher-based Ad Fraud 
! Non Human Traffic and the Bieber Project 
Total digital ad spend is estimated to be 
$60 billion in 2015 
The Business of Digital Advertising 
The Currency of Digital Advertising 
! Primary metric: the number of delivered, or served, 
impressions  
! Primary problem: Not all online ads delivered actually 
have an opportunity to be seen 
! Advertisers are obviously not interested in paying for 
ads that were never seen 
Viewable 
Impressions 
Clicks 
Conversions 
The Currency of Digital Advertising 
$
The Business of Digital Advertising 
Reference: ComScore 
Supply and Demand 
The Business of Digital Advertising 
TV 
Online 
Advertising 
VS 
Ad Tech: The Ecosystem 
Well, it’s a bit 
complicated… 
Ad Tech: The Ecosystem 
Let’s go 
through the 
101 version… 
Advertiser 
Advertiser 
Advertiser 
Advertiser 
Agency 
Agency 
DSP 
Ad 
Networks 
Agency 
Trading 
Desk 
Ad Exchange / SSP 
Publisher 
Publisher 
Publisher 
Publisher 
Ad 
Network 
DMPs 
Other 
data / 
analytics 
companies 
DMPs 
DMPs 
Other 
data / 
analytics 
companies 
Other 
data / 
analytics 
companies 
Other 
data / 
analytics 
companies 
DMPs 
Process of Serving an Ad 
Campaign 
Mgmt. 
System 
User inputs 
info into 
Ad trafficker at DSP/Ad 
Network, etc. 
Campaign 
criteria 
defined 
Right dates, 
budget, CPM 
rate 
targeting 
criteria 
Creative 
assets 
IMG file 
Video file 
Javascript 
tag 
Other 
3rd party 
pixels 
1st party 
pixels 
1. Campaign Setup 
2. The Bidding Process 
Additional custom fields 
based on partners SSP 
woks with (e.g. data 
segments from DMP) 
DSP / Ad 
Network Bidder 
General auction 
information 
Auction type, Bidfloor, 
Currency 
Banner 
information 
Width, Height, Position 
Mobile app / site 
information 
Name, SSP ID, Bundle, 
Domain, StoreURL, IAB cats, 
Page cats, Section cats, 
Content, Keywords 
Device / user 
information 
Device OS, Device type, IP, 
Device ID, Geo, User 
registration data if 
applicable (age, gender) 
Auction 
meets 
campaign 
criteria? 
Bid (DSP bids via 
following OpenRTB 
bid request specs) 
Bid won? 
SSP sends 
winning bidder 
win notification 
Bid Request – 
OpenRTB format 
Integrated into 
SSP exchange to 
bid on auctions 
Auction is sent to 
bidders in form of 
Bid request 
Yes 
No: Bidder 
considers new 
bid request 
Yes 
No: Bidder 
considers new 
bid request 
3. Ad Serving 
Ad is served 
(Buyer uses their own ad 
server of choice, either in-
house, a vendor like 
Sizmek, or they rely on 
Publisher ad server. Less 
common, both publisher 
and buyer ad server is 
used simultaneously) 
Impression 
pixel is fired 
3rd party tags 
fired, if 
applicable 
Ad creative 
loads, along 
with any 
related 
Javascript 
associated 
within tag 
Mobile user 
opens App 
App where 
ad is served 
The Ad Fraud Problem 
!  Deliberate practice of attempting to 
serve ads that have no potential to 
be viewed by a human user 
!  Lots of varying statistics regarding 
the extent of the problem. 
!  Estimates range from 13% to as 
high as 60% of impressions served 
online were “suspicious”.  
!  What are we doing about it? 
Interactive Advertising Bureau  
! What is the IAB?  
! Doing good things but sometimes a 
bit confusing to us people in security 
! Released a Ad Fraud Taxonomy 
!  Illegitimate and Non-Human Traffic Sources 
▫  Hijacked device 
▫  Crawler masquerading as a legitimate user  
▫  Data-center traffic 
!  Non-traditional / other traffic 
▫  Proxy traffic  
▫  Non-browser User-Agent header 
▫  Browser pre-rendering  
!  Hijacked Tags 
▫  Ad Tag Hijacking 
▫  Creative Hijacking  
!  Site Impression Attributes 
▫  Auto-Refresh 
▫  Ad Density 
▫  Hidden Ads 
▫  Viewability 
▫  Misappropriated Content 
▫  Falsely Represented 
▫  Non Brand Safe 
▫  Contains Malware 
!  Ad creative / other 
▫  Cookie Stuffing 
IABs Ad Fraud Taxonomy 
101: What it Really Means 
There are basically 3 main types of Ad Fraud: 
1  Publisher Tricks to Increase Impression Count 
2  Illegal or Malicious Content 
3  Use of Non Human Traffic to Increase Impressions 
Publisher Tricks to Increase Impression Count 
! Various techniques that publishers use to make 1 
impression look like more! 
! Some prominent examples are:  
▫ 1x1 Pixels 
▫ Ad Stacking 
▫ Gray Areas: Ad Clutter, Auto-play Videos 
Publisher Tricks to Increase Impression Count 
Typically 
advertisers will 
want to see this: 
Normal
0 0 0
Lorem ipsum dolor sit amet, 
consectetur adipiscing elit, sed 
do eiusmod tempor incididunt 
ut labore et dolore magna 
aliqua.  consectetur adipiscing 
elit, sed do eiusmod tempor 
incididunt ut labore et dolore 
Ads
Ads
Ads
Publisher Tricks to Increase Impression Count 
Hidden iFrames
0 0 0
Lorem ipsum dolor sit amet, consectetur 
adipiscing elit, sed do eiusmod tempor incididunt 
ut labore et dolore magna aliqua. Ut enim ad 
minim veniam, quis nostrud exercitation ullamco 
laboris nisi ut aliquip ex ea commodo consequat. 
1x1, nx1, 1xn, 0xn, nx0 iFrames 
But some publishers 
will do this  
(Hidden Ads): 
Publisher Tricks to Increase Impression Count 
Or this (Ad Stacking): 
Ad Stacking
0 0 0
Lorem ipsum dolor sit amet, consectetur 
adipiscing elit, sed do eiusmod tempor incididunt 
ut labore et dolore magna aliqua. Ut enim ad 
minim veniam, quis nostrud exercitation ullamco 
laboris nisi ut aliquip ex ea commodo consequat. 
Ads stacked on top of each other
Ads
Ads
Ads
Ads
Illegal or Malicious Content 
! There are times when fraud doesn’t directly mean 
increasing impressions (though it could end up that way) 
! Some prominent examples are:  
▫ Serving malware or adware 
▫ Scams and Non Brand Safe 
Illegal or Malicious Content 
!  Next few slides are from an investigation of malware-infected traffic 
exhibiting ad fraudish tendencies 
!  The Ad Network itself was serving “dirty” inventory or at the very 
least “low quality” content 
Illegal or Malicious Content 
Ad network was 
serving malware! 
Illegal or Malicious Content 
Adware 
Ads that will serve you more Ads 
Illegal or Malicious Content 
Scamvertising! 
Use of Non Human Traffic to Increase Impressions 
! Bots! This is probably the most common 
thing that comes to mind.  
! Non Human Traffic or NHT can be more 
than bots though.  
What is the best way to 
investigate this? 
Buying Internet Traffic 
What is 
Purchased 
Internet Traffic 
made of? 
Can I buy 
internet traffic 
and get away 
with it? 
?
The Bieber Project 
Honeypot  
Fraudulent Impressions? 
Collected Information 
Bieber with a “Wire” 
Bieber with A Wire 
Data Stored for Analysis 
Traffic Vendors 
Traffic Vendors 
Traffic Vendors 
Traffic Vendors 
What is Purchased Internet Traffic Made Of? 
Well..obviously BOTS! 
(partly) 
Clues are in the 
Impression… 
How do we know? 
What are the Clues…? 
Browser has Suspicious User Agent… 
What are the Clues…? 
Lots of other suspicious information… 
•  No Plugins 
•  No Mime Types 
•  Invisible Viewport Sizes 
•  Zero Page and Mouse Coordinates 
•  No Product Identifiers 
It’s easy to catch “dumb” bots but 
what about the smarter ones? 
A Closer Look @ Smarter Bots 
This is a video 
demonstration of 
a malware that 
hijacks a user’s 
browser. 
A Closer Look @ Smarter Bots 
This is a video 
demonstration to 
show a stealthier 
ad fraud malware. 
A Closer Look @ Smarter Bots 
This is a video 
demonstration 
showing a smarter 
malware that 
reproduces user 
events 
What are the Clues…? 
For hijacked machines, we need to 
do some trends analysis… 
Example: Frequency between visits are too fast 
What are the Clues…? 
You’ll need to look at broader patterns… 
Example: Doesn’t help that almost 
all of the traffic was coming from 
one IP block from China… 
User Events 
Show video of 
user event 
collection… 
BUT it’s also made of 
HUMANS… 
Who for all intents and purposes do 
not know they are visiting your site 
Traffic Vendor 
Partner Site 
Your Site 
Traffic is delivered to you through:  
! Pop-unders 
! Pop-ups 
! Frames 
What are the Clues…? 
70% of the viewports are 1 pixel!  
Meaning the size of the browsers 
viewing your site looks like this: 
What are the Clues…? 
The window is not the active window: 
Your 
site is 
here 
So…can I buy internet traffic 
and get away with it? 
! If an advertiser will audit the traffic and they know what 
to look for, you will get caught.  
! If they don’t or if they don’t know what to look for, you 
won’t get caught.  
! The “quality” of traffic is also directly proportional to 
how much you pay for it.  
▫ The lower prices, you’ll get bots.  
▫ They higher prices, you’ll get frames, popups or pop-unders.  
Depends. 
If you liked my presentation 
! Visit us at zvelo.com 
! Check out my books: (available on Amazon) 
www.zvelo.com 
zvelo proprietary and confidential