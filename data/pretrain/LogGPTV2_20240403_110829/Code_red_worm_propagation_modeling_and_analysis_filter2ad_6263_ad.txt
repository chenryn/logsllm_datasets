8
7
6
5
4
3
2
1
0
0
Classical simple epidemic model: J(t)
Infected hosts: J(t)=I(t)+R(t)
Infectious hosts: I(t)
Removed hosts from susceptible: Q(t)
10
20
30
40
time: t
50
60
70
80
Figure 7: Numerical solution of two-factor worm
model
Comparing the two-factor model solution J(t) in Fig. 7
with the number of infected hosts in our Code Red worm
simulation Fig. 5, we can see that they are consistent and
well matched.
Figure 7 shows that the number of infectious hosts I(t)
reaches its maximum value at t = 29. From then on it
decreases because the number of removed infectious hosts in
a unit time is greater than the number of newly generated
infectious hosts at the same time.
We can explain this phenomenon by analyzing the two-
factor model equation (17). From (17) we can derive
dI(t)/dt = β(t)S(t)I(t) − dR(t)/dt
= [β(t)S(t) − γ]I(t)
(18)
The number of susceptible hosts, S(t), is a monotonically
145x 104
Code Red scan unique source IP data
two x.x.0.0/16 networks
Code Red scans per hour
12
10
8
6
4
2
s
e
c
r
u
o
s
e
u
q
n
u
i
f
o
r
e
b
m
u
n
12
10
s
t
s
o
h
s
u
o
i
t
c
e
f
n
i
f
o
r
e
b
m
u
N
8
6
4
2
x 104
Comparison between model and observed data
Observed Code Red infectious hosts
two−factor worm model: I(t)
0
04:00
09:00
14:00
19:00
UTC hours (July 19 − 20)
00:00
04:00
0
12:00
14:00
16:00
UTC hours (July 19 − 20)
18:00
20:00
22:00
00:00
Figure 8: Observed Code Red scan unique
sources hour-by-hour
Figure 9: Comparison between observed
data and our model
decreasing function of time. The maximum number of in-
fectious hosts, max I(t), will be reached at time tc when
S(tc) = γ/β(tc). β(t)S(t) − γ  tc, thus I(t)
decreases after t > tc.
The behavior of the number of infectious hosts I(t) in Fig.
7 can explain why the Code Red scan attempts dropped
down during the last several hours of July 19th [13, 16].
The data collected by Smith [16] and Eichman [13] contain
the number of the Code Red infectious sources that sent
out scans during each hour. It tells us how many computers
were still infectious during each hour on July 19th, thus the
number of observed infectious sources corresponds to I(t)
in our model. We plot the average values of these two data
sets in Fig. 8.
We plot in Fig. 9 both the observed data in Fig. 8 and
the I(t) derived from our model as shown in Fig. 7 (we
use the observed data from July 19th 12:00 to 00:00 UTC.
Code Red worm stopped propagation after 00:00 UTC July
20th). Figure 9 shows that they are matched quite well.
The classical simple epidemic model (1) can’t explain the
dropping down of Code Red propagation during the last
several hours of July 19th.
From the simple epidemic model (Fig. 4) and observed
data (Fig. 1), the authors in [31] concluded that Code Red
came to saturating around 19:00 UTC July 19th — almost
all susceptible IIS servers online on July 19th have been
infected around 19:00 UTC. However, the numerical solution
of our model, as shown in Fig. 7, shows that only roughly
60% of all susceptible IIS servers online have been infected
around that time.
7. CONCLUSION
In this paper, we present a more accurate Internet worm
model and use it to model Code Red worm propagation.
Since Internet worms are similar to viruses in epidemic re-
search area, we can use epidemic models to model Inter-
net worms. However, epidemic models are not accurate
enough. They can’t capture some speciﬁc properties of In-
ternet worms. By checking the Code Red worm incident
and networks properties, we ﬁnd that there are two major
factors that aﬀect an Internet worm propagation: one is the
eﬀect of human countermeasures against worm spreading,
like cleaning, patching, ﬁltering or even disconnecting com-
puters and networks; the other is the slowing down of worm
infection rate due to worm’s impact on Internet traﬃc and
infrastructure. By considering these two factors, we derive
a new general Internet worm model called two-factor worm
model. The simulations and the numerical solutions of the
two-factor worm model show that the model matches well
with the observed Code Red worm data of July 19th 2001.
In our two-factor worm model, the increasing speed of
the number of infected hosts will begin to slow down when
only about 50% of susceptible hosts have been infected. It
explains the earlier slowing down of the Code Red infection
in July 19th (Fig. 2). The number of current infected hosts
I(t) in Fig. 7 matches the corresponding observed data [13,
16] quite well as shown in Fig. 9.
It explains why Code
Red scans dropped down during the last several hours of
July 19th, while previous worm models can’t explain such
phenomenon.
Due to the two factors that aﬀect an Internet worm prop-
agation, the exponentially increased propagation speed is
only valid for the beginning phase of a worm.
If we use
the traditional epidemic model to do a worm prediction, we
will always overestimate the spreading and damages of the
worm.
The two-factor worm model is a general Internet worm
model for modeling worms without topology constraint. It
isn’t just a speciﬁc model for Code Red. The slowing down
of worm infection rate will happen when the worm ram-
pantly sweeps the whole Internet and causes some troubles
to the Internet traﬃc and infrastructure, like what Code
Red worm and Nimda worm did [7, 10, 33]. Human coun-
termeasures, like cleaning, patching, ﬁltering, or disconnect-
ing computers, play a major role in all kinds of viruses
or worms propagations no matter how fast or slow these
viruses or worms propagate. Human countermeasures will
successfully slow down and eventually eliminate viruses or
worms propagation. In real world, there are many viruses
and worms coming out almost every day, but few of them
show up and propagate seriously on Internet. Eventually all
of them pass away due to human countermeasures. Most
viruses and worms are not so contagious as Code Red and
146Nimda. After the cleaning and patching rate exceeds the
viruses or worms propagation rate, those viruses and worms
will gradually disappear from the Internet circulation.
However, Internet worm models have their limitations.
For example, the two-factor worm model as well as other
worm models are only suitable for modeling a continuously
spreading worm, or the continuously spreading period of
a worm. They can’t predict those arbitrary stopping or
restarting events of a worm, such as the stopping of Code
Red propagation on 00:00 UTC July 20th 2002 and its restart-
ing on August 1st — we can only ﬁnd such events through
manually code analysis.
In our two-factor worm model (17), we select parame-
ters, γ, µ, β0, n and η, such that the numerical solutions
can match with the observed Code Red data. Even for the
simple epidemic model (1), we still need to determine the
parameter β before using it. For the prediction and dam-
age assessment of future viruses and worms, we need to do
more research to ﬁnd an analytical way to determine these
parameters beforehand.
8. REFERENCES
[1] R. M. Anderson, R.M. May. Infectious diseases of
humans: dynamics and control. Oxford University
Press, Oxford, 1991.
[2] H. Andersson, T. Britton. Stochastic Epidemic Models
and Their Statistical Analysis. Springer-Verlag, New
York, 2000.
[3] N. T. Bailey. The Mathematical Theory of Infectious
Diseases and its Applications. Hafner Press, New
York, 1975.
[4] CERT Advisory CA-2001-23. Continued Threat of the
“Code Red” Worm.
http://www.cert.org/advisories/CA-2001-23.html
[5] CERT Advisory CA-2000-04. Love Letter Worm.
http://www.cert.org/advisories/CA-2000-04.html
[6] CERT Advisory CA-1999-04. Melissa Macro Virus.
http://www.cert.org/advisories/CA-1999-04.html
[7] Cisco Security Advisory: “Code Red” Worm -
Customer Impact.
http://www.cisco.com/warp/public/707/cisco-code-
red-worm-pub.shtml
[8] Cisco Tech. notes: Dealing with mallocfail and High
CPU Utilization Resulting From the “Code Red”
Worm. http://www.cisco.com/warp/public/63/
ts codred worm.shtml
[9] CNN news. “Code Red” worm “minimized” – for now.
http://www.cnn.com/2001/TECH/internet
/08/02/code.red.worm/
[10] J. Cowie, A. Ogielski, B. Premore and Y. Yuan.
Global Routing Instabilities during Code Red II and
Nimda Worm Propagation.
http://www.renesys.com/projects/bgp instability/
[11] eEye Digital Security. .ida “Code Red” Worm.
http://www.eeye.com/html/Research/Advisories/
AL20010717.html
[12] eEye Digital Security. CodeRedII Worm Analysis.
http://www.eeye.com/html/Research/Advisories/
AL20010804.html
[13] K. Eichman. Mailist: Re: Possible CodeRed
Connection Attempts.
http://lists.jammed.com/incidents/2001/07/0159.html
[14] eWeek news. Code Red Lessons, Big and Small.
http://www.eweek.com/article2/0,3959,113815,00.asp
[15] J. C. Frauenthal. Mathematical Modeling in
Epidemiology. Springer-Verlag, New York, 1980.
[16] D. Goldsmith. Maillist: Possible CodeRed Connection
Attempts.
http://lists.jammed.com/incidents/2001/07/0149.html
[17] T. Heberlein. Visual simulation of Code Red worm
propagation patterns.
http://www.incidents.org/archives/intrusions/
msg00659.html
[18] Incidents.org diary archive.
http://www.incidents.org/diary/july2001.php
[19] S. Junnarkar and R. Konrad. Code Red crawls back
into action.
http://news.cnet.com/news/0-1003-200-6738969.html
[20] J. O. Kephart and S. R. White. Directed-graph
Epidemiological Models of Computer Viruses.
Proceedings of the IEEE Symposimum on Security and
Privacy, 343-359, 1991.
[21] J. O. Kephart, D. M. Chess and S. R. White.
Computers and Epidemiology. IEEE Spectrum, 1993.
[22] J. O. Kephart and S. R. White. Measuring and
Modeling Computer Virus Prevalence. Proceedings of
the IEEE Symposimum on Security and Privacy, 1993.
[23] R. Lemos. Virulent worm calls into doubt our ability
to protect the Net.
http://news.com.com/2009-1001-270471.html
[24] R. Lemos. Microsoft reveals Web server hole.
http://news.com.com/2100-1001-268608.html
[25] Matlab Simulink. The Mathworks, Inc.
[26] V. Misra, W. Gong and D. Towsley. A ﬂuid based
analysis of a network of AQM routers supporting TCP
ﬂows with an application to RED. Proceedings of
ACM/SIGCOMM, 151-160, 2000.
[27] D. Moore. The Spread of the Code-Red Worm.
http://www.caida.org/analysis/security/code-
red/coderedv2 analysis.xml
[28] C. Nachenberg. The Evolving Virus Threat. 23rd
NISSC Proceedings, Baltimore, Maryland, 2000.
[29] SilentBlade. Info and Analysis of the ’Code Red’.
http://www.securitywriters.org/library/texts/
malware/commu/codered.php
[30] E.H. Spaﬀord. The internet worm incident. In
ESEC’89 2nd European Software Engineering
Conference, Coventry, United Kingdom, 1989.
[31] S. Staniford, V. Paxson and N. Weaver. How to Own
the Internet in Your Spare Time. 11th Usenix Security
Symposium, San Francisco, August, 2002.
[32] C. Wang, J. C. Knight and M. C. Elder. On Viral
Propagation and the Eﬀect of Immunization.
Proceedings of 16th ACM Annual Computer
Applications Conference, New Orleans, LA, 2000.
[33] L. Wang, X. Zhao, D. Pei, R. Bush, D. Massey, A.
Mankin, S. Wu and L. Zhang. Observation and
Analysis of BGP Behavior under Stress. Internet
Measurement Workshop, France, November, 2002.
[34] N. Weaver. Warhol Worms: The Potential for Very
Fast Internet Plagues.
http://www.cs.berkeley.edu/˜nweaver/warhol.html
147