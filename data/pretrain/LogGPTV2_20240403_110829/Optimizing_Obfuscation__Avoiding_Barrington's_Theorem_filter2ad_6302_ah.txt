### Optimized Text

**First Property Satisfied:**
\[ \Pr_{V^{\text{real}}_C} [p_e(V^{\text{real}}_C) = 0] = \Pr_{\tilde{V}^{\text{real}}_C} [p'_e(\tilde{V}^{\text{real}}_C) = 0] \]

We now show that the second property is satisfied. The degree of \(\prod_{i \in [n]} \det(R_i)\) is at most \(n \cdot w\). Therefore, the degree of \(p'_e\) is at most \(n \cdot w\) times the degree of \(p_e\), which remains a polynomial in \(n\).

Finally, we show that the third property is satisfied. Note that \(\text{adj}(R_i)\) can be expressed as a polynomial with degree at most \(w\) in the entries of \(R_i\). Using this, the distribution corresponding to \(\tilde{V}^{\text{real}}_C\) can be computed by a polynomial (of degree at most \(w\)) over values that are uniform over \(\mathbb{Z}_p\).

To obtain the desired result, we invoke the Schwartz-Zippel lemma:
\[ \Pr_{V^{\text{real}}_C} [p_e(V^{\text{real}}_C) = 0] = \Pr_{\tilde{V}^{\text{real}}_C} [p'_e(\tilde{V}^{\text{real}}_C) = 0] = \text{negl}(n) \]

**Zero-Testing Elements:**
We now show that to zero-test an element, it suffices to individually zero-test all the elements in its decomposition. This will complete the proof that our simulator satisfies the correctness property.

**Theorem 8:**
Consider an element \(e\) such that \(U \subseteq S(e)\) and let \(p_e\) be the polynomial computed by the circuit \(\alpha(e)\). We have the following:

1. If \(p_e\) is a non-zero polynomial, then \(\Pr_{V^{\text{real}}_C} [p_s(V^{\text{real}}_C) = 0] = \text{negl}(n)\) for some \(s \in D(e)\).
2. If \(p_e\) is a zero polynomial, then \(p_s \equiv 0\) for every \(s \in D(e)\).

**Proof:**
- **Case 1: \(p_e\) is a non-zero polynomial.**
  From Claim 18, we have:
  \[ \Pr_{V^{\text{real}}_C} [p_e(V^{\text{real}}_C) = 0] = \Pr_{V^{\text{real}}_C} [\exists s \in D(e) : p_s(V^{\text{real}}_C) = 0] = \text{negl}(n) \]

- **Case 2: \(p_e\) is a zero polynomial.**
  We claim that \(p_s\) is a zero polynomial for every \(s \in D(e)\). From Claim 18, we know that \(p_s\) can be expressed as \(q_{\text{Prof}(s)} \cdot \tilde{\alpha}_{\text{Prof}(s)}\), where \((b_{i1}, b_{i2}) = (\text{Prof}(s)_{\text{inp1}(i)}, \text{Prof}(s)_{\text{inp2}(i)})\). Observe that the marginal distribution of \(\tilde{\alpha}_{\text{Prof}(s)}\) is uniform for every \(s \in D(e)\). Hence, \(q_{\text{Prof}(s)}\) should be zero on all points of its support. In other words, \(q_{\text{Prof}(s)} \equiv 0\) and thus \(p_s \equiv 0\), proving the theorem.

**Corollary 2:**
Consider an element \(e\) such that \(U \subseteq S(e)\) and let \(p_e\) be the polynomial computed by the circuit \(\alpha(e)\). We have the following:

1. If \(p_e\) is a non-zero polynomial, then \(\Pr_{V^{\text{sim}}_s} [p_s(V^{\text{sim}}_s) = 0] = \text{negl}(n)\) for some \(s \in D(e)\).
2. If \(p_e\) is a zero polynomial, then \(p_s(V^{\text{sim}}_s) \equiv 0\).

**Proof:**
The proof follows from Theorem 8 and the following claim, which completes the proof of the correctness of the simulation of zero-testing.

**Claim 12:**
For every single-input element \(s\) such that \(U \subseteq S\), the assignment \(V^{\text{sim}}_s\), which is the distribution output by \(\text{SimBP}\), and the assignment to the same subset of variables in \(V^{\text{real}}_C\) are identically distributed.

**Proof:**
The distributions of the following variables generated by \(\text{Sim}\) and \(O(F)\) are identical from Theorem 6:
- \(R_0, R_n\)
- \(B_{i, b_{i1}, b_{i2}}\) for \(i \in [n]\), \(b_{i1} = \text{Prof}(s)_{\text{inp1}(i)}\), \(b_{i2} = \text{Prof}(s)_{\text{inp2}(i)}\)

Further, the following variables are sampled uniformly at random both by \(\text{Sim}\) and by \(O(F)\):
- \(\alpha_{i, b_{i1}, b_{i2}}\) for \(i \in [n]\), \(b_{i1} = \text{Prof}(s)_{\text{inp1}(i)}\), \(b_{i2} = \text{Prof}(s)_{\text{inp2}(i)}\)

The claim follows from the fact that the assignment \(V^{\text{sim}}_s\) and the assignment to the same subset of variables in \(V^{\text{real}}_C\) are both computed from the above values in the same way.

**Acknowledgements:**
We thank Paul Beame and Milos Ercegovac for discussions about formula size versus depth tradeoffs for interesting functions. We also thank Jean-Sebastien Coron and Shai Halevi for helpful discussions regarding secure parameter sizes for multilinear map instantiations. We thank Ilan Komargodski and Alexander Sherstov for bringing to our attention the best results on optimizing the depth of formulas. Additionally, we thank Omkant Pandey, Manoj Prabhakaran, and Mark Zhandry for several helpful comments. We are especially grateful to Ilan Komargodski for bringing the work of [31] to our attention as well as for several other helpful suggestions and comments. Finally, we thank the CCS Program Committee, and especially Mariana Raykova, for very useful feedback and suggestions.

**References:**
[1] P. Ananth, D. Boneh, S. Garg, A. Sahai, and M. Zhandry. Differing-inputs obfuscation and applications. Cryptology ePrint Archive, Report 2013/689, 2013.
[2] B. Applebaum. Bootstrapping obfuscators via fast pseudorandom functions. Cryptology ePrint Archive, Report 2013/699, 2013.
...
[44] T. Moran and A. Rosen. There is no indistinguishability obfuscation in pessiland. Cryptology ePrint Archive, Report 2013/643, 2013.