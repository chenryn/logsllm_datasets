the ﬁrst property is satisﬁed.
[pe(V real
C ) = 0] = PrV real
C
PrV real
C
(cid:89)
i∈[n]
[pe(V real
C )
e( ˜V real
[p(cid:48)
det(Rj) = 0]
C
C ) = 0]
= Pr
˜V real
We now show that the second property is satisﬁed. The degree of(cid:81)
i∈[n] det(Ri) is at most n· w
e is at most n · w times the degree of pe, which is still a polynomial in
and hence the degree of p(cid:48)
n. Finally, we show that that the third property is satisﬁed. To see this note that adj(Ri) can
be expressed as polynomial with degree at most w in the entries of Ri. Using this, we have that
the distribution corresponding to ˜V real
C can be computed by a polynomial (of degree at most w)
over values that are uniform over Zp.
on p(cid:48)
Now that we have constructed the polynomial p(cid:48)
e to obtain the desired result as follows:
e, we will invoke the Schwartz-Zippel lemma
[pe(V real
C ) = 0] = Pr
˜V real
C
PrV real
C
e( ˜V real
[p(cid:48)
C ) = 0] = negl(n)
We now show that in order to zero-test an element it suﬃces to individually zero-test all the
elements in its decomposition. This will complete the proof that our simulator satisﬁes the
correctness property.
Theorem 8. Consider an element e such that U ⊆ S(e) and let pe be the polynomial computed
by the circuit α(e). We have the following:
C ) = 0 with negligible (in n) probability, for some
- If pe is a non-zero polynomial then ps(V real
s ∈ D(e).
C ) ≡ 0
- If pe is a zero polynomial then ps(V real
C ) = 0] = 0 with negligible probability. Further since pe = (cid:80)
Proof. We ﬁrst consider the case when pe is a non-zero polynomial. From Claim 18, we have
[pe(V real
that PrV real
s∈D(e) ps, we
have the following.
C
PrV real
C
[pe(V real
C ) = 0] = PrV real
C
[∃s ∈ D(e) : ps(V real
C ) = 0]
= negl(n)
27
Further We now move to the case when pe is a zero polynomial. We claim that ps is a zero
polynomial for every s ∈ D(e). From Claim 18 we know that ps can be expressed as qProf(s) ·
2) = (Prof(s)inp1(i), Prof(s)inp2(i)). Observe that the marginal distribution of
˜αi,bi
˜αProf(s) is uniform for every s ∈ D(e). Hence, qProf(s) should be zero on all points of its support.
In other words, qProf(s) ≡ 0 and hence, ps ≡ 0 thus proving the theorem
, where (bi
1, bi
1,bi
2
As a consequence of the above theorem, we prove the following corollary.
Corollary 2. Consider an element e such that U ⊆ S(e) and let pe be the polynomial computed
by the circuit α(e). We have the following.
) = 0 with negligible (in n) probability, for some
- If pe is a non-zero polynomial then ps(V Sim
s ∈ D(e).
- If pe is a zero polynomial then ps(V Sim
s
) ≡ 0.
s
The proof of the above corollary follows from the above theorem and the following claim. This
completes the proof of correctness of the simulation of zero-testing.
Claim 12. For every single-input element s such that U ⊆ S we have that the assignment V Sim
,
which is the distribution output by SimBP, and the assignment to the same subset of variables in
V real
C are identically distributed.
Proof. The distributions of the following variables generated by Sim and O(F) are identical from
Theorem 6:
s
R0,
Bi,bi
1,bi
2
i ∈ [n], bi
1 = Prof(s)inp1(i), bi
2 = Prof(s)inp2(i)
, Rn
Further, the following variables are sampled uniformly at random both by Sim and by O(F):
: i ∈ [n], bi
1,bi
2
αi,bi
1 = Prof(s)inp1(i), bi
The claim follows from the fact that the assignment V Sim
to the same subset of variables in V real
way.
2 = Prof(s)inp2(i)
generated by Sim and the assignment
C are both computed from the above values in the same
s
(cid:111)
(cid:111)
(cid:110)
(cid:110)
Acknowledgements
We thank Paul Beame and Milos Ercegovac for discussions about formula size versus depth
tradeoﬀs for interesting functions. We thank Jean-Sebastien Coron and Shai Halevi for helpful
discussions regarding secure parameter sizes for multilinear map instantiations. We thank Ilan
Komargodski and Alexander Sherstov for bringing to our attention the best results on optimizing
depth of formulas. We also thank Omkant Pandey, Manoj Prabhakaran, and Mark Zhandry for
several helpful comments. We are especially grateful to Ilan Komargodski for bringing the work
of [31] to our attention as well as for several other helpful suggestions and comments. Finally, we
thank the CCS Program Committee, and especially Mariana Raykova, for very useful feedback
and suggestions.
References
[1] P. Ananth, D. Boneh, S. Garg, A. Sahai, and M. Zhandry. Diﬀering-inputs obfuscation and
applications. Cryptology ePrint Archive, Report 2013/689, 2013.
[2] B. Applebaum. Bootstrapping obfuscators via fast pseudorandom functions. Cryptology
ePrint Archive, Report 2013/699, 2013.
28
[3] B. Barak, N. Bitansky, R. Canetti, Y. T. Kalai, O. Paneth, and A. Sahai. Obfuscation for
evasive functions, 2014.
[4] B. Barak, S. Garg, Y. T. Kalai, O. Paneth, and A. Sahai. Protecting obfuscation against
algebraic attacks. In EUROCRYPT, 2014.
[5] B. Barak, O. Goldreich, R. Impagliazzo, S. Rudich, A. Sahai, S. P. Vadhan, and K. Yang.
On the (im)possibility of obfuscating programs. In CRYPTO, pages 1–18, 2001.
[6] D. A. M. Barrington. Bounded-width polynomial-size branching programs recognize exactly
those languages in NC1. In STOC, 1986.
[7] M. Bellare and V. T. Hoang. Adaptive witness encryption and asymmetric password-based
cryptography. Cryptology ePrint Archive, Report 2013/704, 2013. http://eprint.iacr.
org/.
[8] M. Bellare and P. Rogaway. Random oracles are practical: A paradigm for designing
eﬃcient protocols. In ACM Conference on Computer and Communications Security, pages
62–73, 1993.
[9] M. Bellare, I. Stepanovs, and S. Tessaro. Poly-many hardcore bits for any one-way function.
Cryptology ePrint Archive, Report 2013/873, 2013. http://eprint.iacr.org/.
[10] N. Bitansky, R. Canetti, O. Paneth, and A. Rosen. More on the impossibility of virtual-
black-box obfuscation with auxiliary input. Cryptology ePrint Archive, Report 2013/701,
2013.
[11] M. L. Bonet and S. R. Buss. Size-depth tradeoﬀs for boolean formulae.
Information
Processing Letters, 49(3):151–155, 1994.
[12] E. Boyle, K.-M. Chung, and R. Pass. On extractability obfuscation. Cryptology ePrint
Archive, Report 2013/650, 2013.
[13] E. Boyle and R. Pass. Limits of extractability assumptions with distributional auxiliary
input. Cryptology ePrint Archive, Report 2013/703, 2013.
[14] Z. Brakerski and G. N. Rothblum. Black-box obfuscation for d-CNFs. In Proceedings of
the 5th conference on Innovations in theoretical computer science, pages 235–250. ACM,
2014.
[15] Z. Brakerski and G. N. Rothblum. Virtual black-box obfuscation for all circuits via generic
graded encoding. In TCC, pages 1–25, 2014.
[16] R. P. Brent. The parallel evaluation of general arithmetic expressions. Journal of the ACM
(JACM), pages 201–206, 1974.
[17] C. Brzuska, P. Farshim, and A. Mittelbach. Indistinguishability obfuscation and UCEs:
The case of computationally unpredictable sources. Cryptology ePrint Archive, Report
2014/099, 2014.
[18] N. H. Bshouty, R. Cleve, and W. Eberly. Size-depth tradeoﬀs for algebraic formulae. In
FOCS, pages 334–341, 1991.
[19] R. Canetti, O. Goldreich, and S. Halevi. The random oracle methodology, revisited. J.
ACM, 51(4):557–594, 2004.
[20] R. Cleve. Towards optimal simulations of formulas by bounded-width programs. In STOC,
pages 271–277, 1990.
[21] H. Cohn, S. Goldwasser, and Y. T. Kalai. The impossibility of obfuscation with a universal
simulator. CoRR, abs/1401.0348, 2014.
[22] J.-S. Coron, T. Lepoint, and M. Tibouchi. Practical multilinear maps over the integers. In
CRYPTO, pages 476–493, 2013.
29
[23] R. Cramer, S. Fehr, Y. Ishai, and E. Kushilevitz. Eﬃcient multi-party computation over
rings. In EUROCRYPT, pages 596–613, 2003.
[24] W. Diﬃe and M. E. Hellman. Multiuser cryptographic techniques.
In AFIPS National
Computer Conference, pages 109–112, 1976.
[25] U. Feige, J. Kilian, and M. Naor. A minimal model for secure computation. In STOC,
pages 554–563, 1994.
[26] S. Garg, C. Gentry, and S. Halevi. Candidate multilinear maps from ideal lattices.
In
EUROCRYPT, pages 1–17, 2013.
[27] S. Garg, C. Gentry, S. Halevi, and M. Raykova. Two-round secure mpc from indistin-
guishability obfuscation. 2014.
[28] S. Garg, C. Gentry, S. Halevi, M. Raykova, A. Sahai, and B. Waters. Candidate indistin-
guishability obfuscation and functional encryption for all circuits. In FOCS, pages 40–49,
2013.
[29] S. Garg, C. Gentry, S. Halevi, and D. Wichs. On the implausibility of diﬀering-inputs
obfuscation and extractable witness encryption with auxiliary input. Cryptology ePrint
Archive, Report 2013/860, 2013.
[30] C. Gentry, S. Halevi, M. Raykova, and D. Wichs. Outsourcing private ram computation.
Cryptology ePrint Archive, Report 2014/148, 2014.
[31] O. Giel. Branching program size is almost linear in formula size. J. Computer and System
Sciences, pages 222–235, 2001.
[32] S. Goldwasser, V. Gordon, Dov Goyal, A. Jain, J. Katz, F.-H. Liu, E. Shi, H.-S. Zhou, and
A. Sahai. Multi-input functional encryption. 2014.
[33] V. Goyal, Y. Ishai, A. Sahai, R. Venkatesan, and A. Wadia. Founding cryptography on
tamper-proof hardware tokens. In TCC, pages 308–326, 2010.
[34] V. Goyal, A. Jain, V. Koppula, and A. Sahai. Functional encryption for randomized
functionalities. Cryptology ePrint Archive, Report 2013/729, 2013.
[35] S. Hohenberger, A. Sahai, and B. Waters. Replacing a random oracle: Full domain hash
from indistinguishability obfuscation. 2014.
[36] S. Jukna. Boolean Function Complexity - Advances and Frontiers, volume 27 of Algorithms
and combinatorics. Springer, 2012.
[37] V. Khrapchenko. On a relation between the complexity and the depth. Metody Diskretnogo
Analiza Synthesis of Control Systems, 32:76–94, 1978.
[38] J. Kilian. Founding cryptography on oblivious transfer. In STOC, pages 20–31, 1988.
[39] I. Komargodski, M. Naor, and E. Yogev. Secret-sharing for np from indistinguishability
obfuscation. Cryptology ePrint Archive, Report 2014/213, 2014.
[40] A. Langlois, D. Stehl´e, and R. Steinfeld. Gghlite: More eﬃcient multilinear maps from
ideal lattices. In EUROCRYPT, pages 239–256, 2014.
[41] H. T. Lee and J. H. Seo. Security analysis of multilinear maps over the integers.
In
CRYPTO (1), pages 224–240, 2014.
[42] A. Marcedone and C. Orlandi. Obfuscation ==¿ (ind-cpa security =/=¿ circular security).
Cryptology ePrint Archive, Report 2013/690, 2013.
[43] W. J. Masek. A fast algorithm for the string editing problem and decision graph complexity,
1976.
[44] T. Moran and A. Rosen. There is no indistinguishability obfuscation in pessiland. Cryp-
tology ePrint Archive, Report 2013/643, 2013.