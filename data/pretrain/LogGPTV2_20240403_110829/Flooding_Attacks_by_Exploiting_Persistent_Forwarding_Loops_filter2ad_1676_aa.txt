title:Flooding Attacks by Exploiting Persistent Forwarding Loops
author:Jianhong Xia and
Lixin Gao and
Teng Fei
Flooding Attacks by Exploiting Persistent Forwarding Loops
University of Massachusetts at Amherst
Jianhong Xia, Lixin Gao, Teng Fei
{jxia, lgao, tfei}@ecs.umass.edu
ABSTRACT
In this paper, we present ﬂooding attacks that exploit rout-
ing anomalies in the Internet.
In particular, we focus
on routing anomalies introduced by persistent forwarding
loops. Persistent forwarding loops may share one or more
links with forwarding paths to reachable addresses. An at-
tacker can exploit persistent forwarding loops to overload
the shared links to disrupt the Internet connectivity to those
reachable addresses.
To understand the extent of this vulnerability, we per-
form extensive measurements to systematically study per-
sistent forwarding loops and the number of network ad-
dresses that can be affected. We ﬁnd that persistent for-
warding loops do exist in the current Internet. About
0.2% of routable addresses experience persistent forward-
ing loops and 0.21% of routable addresses can be attacked
by exploiting persistent forwarding loops.
In addition,
85.16% of the persistent forwarding loops appear within
destination domains and they can be observed from var-
ious locations, which makes it possible to launch attacks
from many vantage points. We also ﬁnd that most persis-
tent forwarding loops are just two hops long, which enables
an attacker to amplify trafﬁc to persistent forwarding loops
signiﬁcantly. To the best of our knowledge, this is the ﬁrst
study of exploiting the vulnerability of persistent forward-
ing loops to launch DDoS attacks.
1 INTRODUCTION
Distributed denial of service (DDoS) attack is one of the
most prevailing threats in the Internet. In general, DDoS
attacks send trafﬁc from a large number of compromised
hosts to deplete network or host resources needed by the
victim. In this paper, we present ﬂooding attacks that ex-
ploit routing anomalies in the Internet.
In particular, we
focus on a critical vulnerability in network routing archi-
tecture that is caused by persistent forwarding loops. For-
warding loops have been observed in previous measure-
Traffic to X
L
ab
L
bc
R
a
Traffic to Y
R
b
R
c
WAN/
LAN
Host X
Host Y
Figure 1: Flooding Attacks by Exploiting Persistent For-
warding Loops
ment studies [3, 8, 11, 12]. Although transient forward-
ing loops disappear after routing protocol convergence, for-
warding loops caused by conﬁguration errors can last for a
long time. In addition to obvious issues that persistent for-
warding loops can blackhole network addresses, they can
also be exploited to overload links that appear in the persis-
tent forwarding loops.
Fig. 1 shows an example of a ﬂooding attack that ex-
ploits persistent forwarding loops. Trafﬁc to host X tra-
verses routers Ra, Rb, Rc and other network devices to
reach host X. At the same time, trafﬁc to host Y also tra-
verses routers Ra, Rb and Rc. However, due to misconﬁg-
urations in router Rc, trafﬁc to host Y will be forwarded
back to Rb. Therefore, any packet destined to Y falls into
the loop between Rb and Rc, and will be dropped until its
time-to-live (TTL) expires. In this scenario, link Lbc can
be ﬂooded if malicious attackers deliberately send a large
amount of trafﬁc to host Y . Host X would experience
denial of service. Since trafﬁc traversing a persistent for-
warding loop typically traverses the links in the loop sev-
eral times before being dropped, attackers take much less
effort to launch ﬂooding attacks, and therefore making the
attacks stealthy. Since network operators can see high con-
gestion only on the shared link Lbc but not on other links
such as Lab, without packet or ﬂow-level measurements on
the shared link, this kind of attack is hard to detect.
We perform extensive measurements to systematically
study persistent forwarding loops. We ﬁnd that persistent
forwarding loops do exist in the current Internet. About
0.2% of routable addresses experience persistent forward-
USENIX Association
Internet Measurement Conference 2005  
385
ing loops and 0.21% of routable addresses can be attacked
by exploiting persistent forwarding loops.
In addition,
85.16% of the persistent forwarding loops appear within
destination domains and they can be observed from var-
ious locations, which makes it possible to launch attacks
from many vantage points. We also ﬁnd that most persis-
tent forwarding loops are just two hops long, which enables
an attacker to amplify trafﬁc to persistent forwarding loops
signiﬁcantly.
The remainder of this paper is structured as follows.
Section 2 introduces the concept of persistent forwarding
loops. Section 3 describes measurement design and data
collection. Section 4 characterizes persistent forwarding
loops. Section 5 exploits ﬂooding attacks using persistent
forwarding loops. We summarize the paper in Section 6.
2 PERSISTENT FORWARDING LOOPS
2.1 Concept of Forwarding Loops
In general, a packet from source s traverses a sequence of
routers to reach destination d. A packet experiences a for-
warding loop if it traverses a set of routers more than once.
One of the powerful tools for discovering the forwarding
path from a source to a destination is traceroute, which
returns a sequence of router interfaces on the forwarding
path. We denote the sequence of router interfaces in a trace
If ri = rj and i 6= j,
from s to d as (r1, r2, . . . , rn).
then the trace contains a forwarding loop (ri, . . . , rj). The
length of forwarding loop (ri, . . . , rj) is j − i.
2.2 Transient and Persistent Forwarding
Loops
Forwarding loops can be transient or persistent. Tran-
sient forwarding loops are the forwarding loops that re-
solve themselves without human intervention or network
topology changes. They may occur during routing protocol
convergence [1]. Hengartner et al. [3] has demonstrated
that forwarding loops exist in the Sprint network by ana-
lyzing packet traces. In general, forwarding loops are tran-
sient if they will disappear once the routing protocol con-
verges. However, some forwarding loops will not disappear
without human intervention or network topology changes.
We refer to those forwarding loops as persistent forwarding
loops.
2.3 Shadowed Address and Imperiled Ad-
dress
If there is a persistent forwarding loop from source s to
destination d, we refer to the IP address of d as a shadowed
address. For example, the IP address of host Y in Fig. 1
is a shadowed address. Note that the links in persistent
Hop
Traceroute to shadowed
address 81.181.31.127
Traceroute to imperiled
address 80.96.192.10
128.119.91.254
128.119.2.238
...
166.49.147.134
195.39.208.66
193.226.179.18
193.226.130.226
194.176.189.42
194.105.11.178
80.96.192.10
1
2
...
18
19
20
21
22
23
24
25
26
27
28
29
30
128.119.91.254
128.119.2.238
...
166.49.147.134
195.39.208.82
193.226.179.18
193.226.130.226
194.176.189.42
193.226.130.226
194.176.189.42
193.226.130.226
194.176.189.42
193.226.130.226
194.176.189.42
193.226.130.226
194.176.189.42
Figure 2: A Shadowed Address and an Imperiled Address
forwarding loops may still be able to carry trafﬁc to other
reachable addresses. That is, a persistent forwarding loop
may share one or more links with forwarding paths to the IP
addresses other than shadowed addresses. If a destination
d0 is reachable and the forwarding path to d0 shares one or
more links with a persistent forwarding loop, we refer to
the IP address of d0 as an imperiled address. For example,
the IP address of host X in Fig. 1 is an imperiled address.
Imperiled address is named so because the address is in
a dangerous situation and it may suffer from the potential
threats posed by the persistent forwarding loops.
An example of a shadowed address and an imperiled
address is shown in Fig. 2.
In this example, trafﬁc to
the shadowed address 81.181.31.127 falls into a persis-
tent forwarding loop between routers 193.226.130.226 and
194.176.189.42. However, trafﬁc to the imperiled address
80.96.192.10 relies on the same link that appears in the for-
warding loop to reach the destination.
3 DATA COLLECTION
3.1 Measurement Design
We use traceroute to discover forwarding paths in our
study. Our goal is to identify all possible persistent for-
warding loops in the Internet. In order to reduce the mea-
surement overhead, we select a set of representative IP ad-
dresses to trace. We intend to select as few IP addresses as
we can, while trying to discover as many forwarding paths
as possible. Most networks or their subnets are allocated a
set of contiguous IP address blocks, and forwarding deci-
sion in a router is based on the destination IP address only.
Therefore, tracing different IP addresses in the same con-
tiguous IP block from a source may observe the same for-
386
Internet Measurement Conference 2005 
USENIX Association
Table 1: Summary on Measurement Design and Trace Data
Data
Set
DA
DB
DC
DD1
DD2
DD3
DD4
Fine-grained
Preﬁx Selection
# of Selected IP
Addresses/Preﬁx
# of Traces for Each
Selected IP Address
all ﬁne-grained preﬁxes
10% of candidate preﬁxes
35% of shadowed preﬁxes
46% of shadowed preﬁxes
46% of shadowed preﬁxes
46% of shadowed preﬁxes
46% of shadowed preﬁxes
2
2
50
4
4
4
4
once
5∼7 times
once
twice on average
twice on average
twice on average
twice on average
# of Preﬁxes
# of IP Addresses
Traced
5,238,191
12,983
3,705
4,894
4,894
4,894
4,894
Traced
9,259,257
21,212
171,218
19,762
20,691
20,657
17,825
# of Traces
Collected
9,384,350
139,739
187,980
41,556
44,969
44,936
34,873
warding path. Typically, a /24 block is used as the smallest
unit, thus the forwarding path to any IP address in a /24
block should represent forwarding paths to all IP addresses
in that block. Therefore, we design our measurement by
selecting a couple of IP addresses in each /24 block to per-
form traceroute.
It should be noted that not all IP addresses have been
allocated. Even we can obtain a list of all allocated IP ad-
dresses [5], not all allocated IP addresses have been used
in the current Internet. To reduce the overhead of our
measurement, we select the set of IP addresses based on
the information from BGP routing tables in the Route-
Views Project [10]. The RouteViews server peers with
BGP routers in many large ISPs such as AT&T and Sprint.
We refer to the preﬁxes in the BGP routing tables in the
RouteViews server as routable preﬁxes, and refer to the
IP addresses covered by routable preﬁxes as routable ad-
dresses.
We divide all routable preﬁxes whose lengths are shorter
than 24 into multiple /24 preﬁxes, and keep routable pre-
ﬁxes whose lengths are no shorter than 24 unchanged. For
example, preﬁx 12.0.0.0/8 is divided into 65, 536 preﬁxes
represented by 12.x.x.0/24. All preﬁxes in our measure-
ment have a length of at least 24. We refer to these preﬁxes
as ﬁne-grained preﬁxes.
Since the forwarding paths to only a limited number of
IP addresses are used to represent forwarding paths to all
IP addresses in a ﬁne-grained preﬁx, we extend the con-
cept of persistent forwarding loops to ﬁne-grained preﬁxes.
We say that there is a persistent forwarding loop to a ﬁne-
grained preﬁx p from source s if we ﬁnd a destination dp
in p that experiences persistent forwarding loops from s.
Similarly, if a ﬁne-grained preﬁx p contains a shadowed
address, we refer to preﬁx p as a shadowed preﬁx. If a ﬁne-
grained preﬁx q contains an imperiled address, we refer to
preﬁx q as an imperiled preﬁx.
3.2 Data Sets
We have collected four sets of trace data in this study. Most
traces are collected from one location. We also collect ad-
ditional traces on different hosts from various locations to
support our ﬁndings. Unless otherwise speciﬁed, all traces
are collected from the campus network of University of
Massachusetts at Amherst.
The ﬁrst data set, DA, is for detecting forwarding loops
in all ﬁne-grained preﬁxes. From a total of 0.17 million
routable preﬁxes, we obtain about 5.36 million ﬁne-grained
preﬁxes. Due to security and privacy concerns posed by
networks owned by governmental and military agencies,
we ﬁlter out their preﬁxes according to WHOIS [4]. Af-
ter ﬁltering, 5.24 million ﬁne-grained preﬁxes are traced.
To reduce the overhead of our measurement, we perform
traceroute to two IP addresses in each preﬁx, the ﬁrst one
and a random one. We collect 9.38 million traces in DA by
tracing to 9.26 million IP addresses. We refer to those ﬁne-
grained preﬁxes with forwarding loops in DA as candidate
preﬁxes. Since some selected IP addresses are traced twice
during the experiment, the number of traces is slightly
greater than the number of IP addresses in DA.
The second data set, DB, is for detecting persistent for-
warding loops. To identify persistent forwarding loops, we
trace to candidate preﬁxes and perform traceroute multiple
times. Although we can observe forwarding loops from a
single trace, it is impractical to monitor the network forever
to identify persistent forwarding loops. Thus, we adopt an
approximate criterion with respect to the general time scale
of routing convergence. We trace an IP address d multiple
times within four days. If there is a forwarding loop for all
traces to d, we classify the forwarding loop as a persistent
forwarding loop. In this case, d is a shadowed address and
the ﬁne-grained preﬁx that contains d is a shadowed preﬁx.
To collect DB, we trace to 10% of candidate preﬁxes and
select two IP addresses in each preﬁx, a ﬁrst one and a ran-
dom one. Each selected IP address is traced at least 5 up
to 7 times. We collect 139, 739 traces by tracing to 21, 212
IP addresses. Since in some preﬁxes only one IP address
is traced during the experiment, the number of selected IP