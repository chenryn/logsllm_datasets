2,ğ‘– â† Prove(cid:169)(cid:173)(cid:173)(cid:171)crs,(cid:169)(cid:173)(cid:173)(cid:171)ğ‘ˆ
(cid:18)
(cid:18)ğ‘ˆ
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ \ {ğ‘–} : Vf(cid:169)(cid:173)(cid:173)(cid:171)crs,(cid:169)(cid:173)(cid:173)(cid:171)
(cid:16)
(cid:16)
(cid:17) âˆ§ Vf
(cid:16)ğ‘—âˆˆğ‘ƒâˆª{0} Ëœğ‘ˆ ğ‘— ,ğ‘—âˆˆğ‘ƒâˆª{0} Ëœğ‘‰ğ‘—
(cid:17)
(cid:16)ğ‘—âˆˆğ‘ƒâˆª{0} Ëœğ‘ˆ â€²
ğ‘— ,ğ‘—âˆˆğ‘ƒâˆª{0} Ëœğ‘‰â€²
ensure Vf
( Ëœğ‘ˆ , Ëœğ‘‰) :=
( Ëœğ‘ˆ â€², Ëœğ‘‰â€²) :=
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ \ {ğ‘–} : Vf
Ëœğ‘ˆ â€²
Ëœğ‘‰â€²
ğ‘–
ğ‘†ğ‘–
Ëœğ‘ˆ ğ‘—
Ëœğ‘‰ğ‘—
crs, (ğ‘ˆ , Ëœğ‘ˆ0), ğœ‹2,0
(cid:170)(cid:174)(cid:174)(cid:172) ,
(cid:19)
ğ¼
ğœ†ğ‘ƒ,ğ‘–
1
ğº
crs,
crs,
ğœ‹â€²
, Ëœğ‘Ÿğ‘–
(cid:17)
ğ‘‰
ğ¼
ğ‘‰
ğ¼
ğ‘ˆ
ğ‘‹
ğ‘‹
ğ‘‰
ğ‘‰
ğ‘–
(cid:18) Ëœğ‘Ÿâ€²
ğ‘–
ğ‘ ğ‘–
(cid:19)(cid:170)(cid:174)(cid:174)(cid:172)
, ğœ‹2,ğ‘—
(cid:19)
(cid:170)(cid:174)(cid:174)(cid:172)
ğ‘—
(cid:170)(cid:174)(cid:174)(cid:172) , ğœ‹â€²
(cid:17)
Ëœğ‘ˆ â€²
Ëœğ‘‰â€²
ğ‘—
ğ‘† ğ‘—
0), ğœ‹â€²
2,0
2,ğ‘—
ğ¼
ğœ†ğ‘ƒ,ğ‘—
1
ğº
crs, (ğ‘ˆ , Ëœğ‘ˆ â€²
( Ëœğ‘ˆ , Ëœğ‘‰) :=
( Ëœğ‘ˆ â€², Ëœğ‘‰â€²) :=
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Joint decryption . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
ğ‘‡0 := Ëœğ‘ˆ ğ‘˜0 , ğ‘‡â€²
â„“=0 Â¯ğ¾ ğ‘—â„“
ğ¾ğ‘— :=ğ‘¡âˆ’1
0 := Ëœğ‘ˆ â€²ğ‘˜0
, âˆ€ğ‘— âˆˆ ğ‘ƒ
ğ‘– := Ëœğ‘ˆ â€²ğ‘˜ğ‘–
â„“
ğ‘—
ğ‘‡ğ‘– := Ëœğ‘ˆ ğ‘˜ğ‘– , ğ‘‡â€²
ğ¾ğ‘– := ğºğ‘˜ğ‘–
ğœ‹3,ğ‘– â† Prove
(cid:18)
(cid:18)
crs,
crs,
(cid:18)ğº
(cid:18) ğº
Ëœğ‘ˆ
Ëœğ‘ˆ â€²
(cid:19)
(cid:19)
, ğ‘˜ğ‘–
, ğ‘˜ğ‘–
(cid:19)
(cid:19)
ğ¾ğ‘–
ğ‘‡ğ‘–
ğ¾ğ‘–
ğ‘‡â€²
ğ‘–
ğ‘‡ğ‘– , ğœ‹3,ğ‘– ,ğ‘‡â€²
ğ‘– , ğœ‹â€²
3,ğ‘–
ğœ‹â€²
3,ğ‘– â† Prove
(cid:18)
(cid:18)
(cid:19)
(cid:19)
Ëœğ‘ˆ
, ğœ‹3,ğ‘—
(cid:19)
(cid:18)ğº
(cid:18) ğº
(cid:19)
, ğ‘‡â€² :=ğ‘—âˆˆğ‘ƒâˆª{0}ğ‘‡
ğ¾ğ‘—
ğ‘‡ğ‘—
ğ¾ğ‘—
ğ‘‡â€²
ğ‘—
Ëœğ‘ˆ â€²
, ğœ‹â€²
3,ğ‘—
crs,
â€²ğœ†ğ‘ƒ,ğ‘—
ğ‘—
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ : Vf
crs,
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ : Vf
ğ‘‡ :=ğ‘—âˆˆğ‘ƒâˆª{0}ğ‘‡
ğœ†ğ‘ƒ,ğ‘—
ğ‘—
if ( Ëœğ‘‰ â‰  ğ‘‡) then return ğœ–
ğ‘€ := (ğ¶1/( Ëœğ‘‰â€² Â· ğ‘‡â€²âˆ’1))
return ğ‘€
return ğ‘›
Figure 4: Decryption Protocol (Procedures for fine-grained rate-limiting in Figure 8)
8
ğ‘, Â¯ğ›½ ğ‘— , Â¯ğ›¿ ğ‘— â†$ Zğ‘, âˆ€ğ‘— âˆˆ [0, ğ‘¡ âˆ’ 1]
Â¯ğ›¿ ğ‘— ğ‘¥ ğ‘—
ğ‘—=0
ğ‘—=0
ğ‘¡âˆ’1âˆ‘ï¸
ğ‘¡âˆ’1âˆ‘ï¸
Â¯ğ›½ ğ‘— ğ‘¥ ğ‘— , Â¯ğ›¿(ğ‘¥) :=
RotateâŸ¨S(â€œrotâ€, sk0), Â· Â· Â·âŸ©
ğ›¾ â†$ Zâˆ—
Â¯ğ›½(ğ‘¥) :=
ğ›½ğ‘– := Â¯ğ›½(ğ‘–), ğ›¿ğ‘– := Â¯ğ›¿(ğ‘–), âˆ€ğ‘– âˆˆ [ğ‘š]
ğ‘ â€²
0 := SKE.KGen(1ğœ†)
ğ‘˜â€²
0 := ğ›¾ Â· ğ‘˜0
ğ¾â€²
0 := ğ¾ğ›¾
0
Â¯ğ›½ ğ‘— , Â¯ğ¾â€²
Â¯ğ‘†â€²
ğ‘— := Â¯ğ‘† ğ‘— Â· ğº
send (ğ›½ğ‘–, ğ›¾, ğ›¿ğ‘–, { Â¯ğ‘†â€²
skâ€²
0 â† (ğ‘ â€²
0, ğ¾â€²
0, ğ‘˜â€²
return (skâ€²
0, ğœ)
Â¯ğ›¿ ğ‘— , âˆ€ğ‘— âˆˆ {0, . . . , ğ‘¡ âˆ’ 1}
ğ‘— := Â¯ğ¾ğ›¾
ğ‘— ğº
ğ‘— }ğ‘¡âˆ’1
ğ‘— , Â¯ğ¾â€²
ğ‘—=0) to Rğ‘–, âˆ€ğ‘– âˆˆ [ğ‘š]
ğ‘— }ğ‘¡âˆ’1
ğ‘—=0), ğœ := (ğ‘ 0, ğ‘ â€²
ğ‘— , Â¯ğ¾â€²
0, { Â¯ğ‘†â€²
0, Â¯ğ›½0)
ğ‘— , Â¯ğ¾â€²
RotateâŸ¨Â· Â· Â· , Rğ‘–(â€œrotâ€, skğ‘–), Â· Â· Â·âŸ©
ğ‘— }ğ‘¡âˆ’1
receive (ğ›½ğ‘–, ğ›¾, ğ›¿ğ‘–, { Â¯ğ‘†â€²
ğ‘—=0) from S
ensure ğ›¾ â‰  0
ğ‘ â€²
ğ‘– := ğ‘ ğ‘– + ğ›½ğ‘–
ğ‘˜â€²
ğ‘– := ğ›¾ Â· ğ‘˜ğ‘– + ğ›¿ğ‘–
ğ¾â€²
0 := ğ¾ğ›¾
0
0, { Â¯ğ‘†â€²
ğ‘–, ğ¾â€²
ğ‘–, ğ‘˜â€²
ğ‘– := (ğ‘ â€²
skâ€²
ensure KVf(ğ‘–, skâ€²
ğ‘–)
return skâ€²
ğ‘— }ğ‘¡âˆ’1
ğ‘—=0)
ğ‘— , Â¯ğ¾â€²
ğ‘–
Udt(ğœ, ğ‘›, ğ¶)
parse ğœ as (ğ‘ 0, Ëœğ‘ 0, Â¯ğ›½0)
parse SKE.Dec((ğ‘ 0, ğ¶) as (ğ¶0, ğ¶1)
0 := ğ¶0 Â· ğ»0(ğ‘›) Â¯ğ›½0, ğ¶â€²
ğ¶â€²
return ğ¶â€² := SKE.Enc( Ëœğ‘ 0, (ğ¶â€²
KVf(ğ‘–, skğ‘–)
else return (ğºğ‘ ğ‘– =ğ‘¡âˆ’1
if ğ‘– = 0 then return (ğºğ‘˜0 = ğ¾0)
ğ‘— âˆ§ ğºğ‘˜ğ‘– =ğ‘¡âˆ’1
0, ğ¶â€²
1))
ğ‘—=0 Â¯ğ‘†ğ‘– ğ‘—
1 := ğ¶1 Â· ğ»1(ğ‘›) Â¯ğ›½0
ğ‘—=0 Â¯ğ¾ğ‘– ğ‘—
ğ‘—
)
Figure 5: Key-Rotation Protocol, Update Algorithm, and Key Verification Algorithm of TPHE
random elements, and the output ğ‘€ of the server (if honest)
is always the empty string ğœ–.
It remains to show that for all ğ‘ âˆˆ {0, 1} and all ğ‘ âˆˆ [ğ‘„Dec],
1
|PW| + negl(ğœ†) ,
Hybğ‘,3,ğ‘ = 1(cid:105)(cid:12)(cid:12)(cid:12) â‰¤
= 1(cid:105)(cid:12)(cid:12)(cid:12) â‰¤ negl(ğœ†) .
Hyb1,3,ğ‘„Dec
(cid:12)(cid:12)(cid:12) Pr(cid:104)
Hybğ‘,3,ğ‘âˆ’1 = 1(cid:105) âˆ’ Pr(cid:104)
and(cid:12)(cid:12)(cid:12) Pr(cid:104)
= 1(cid:105) âˆ’ Pr(cid:104)
(cid:12)(cid:12)(cid:12) Pr(cid:104)
Hybğ‘,3,ğ‘âˆ’1 = 1(cid:105) âˆ’ Pr(cid:104)
The theorem then follows.
Hyb0,3,ğ‘„Dec
3.3.1
Hybğ‘,3,ğ‘ = 1(cid:105)(cid:12)(cid:12)(cid:12) â‰¤
From Hybğ‘,3,ğ‘âˆ’1 to Hybğ‘,3,ğ‘. We show that
1
|PW| + negl(ğœ†)
under the DDH assumption in the random oracle model for all
ğ‘ âˆˆ {0, 1} and ğ‘ âˆˆ [ğ‘„Dec].
, which
is mostly identical to Hybğ‘,3,ğ‘ except that when answering the
adversaryâ€™s ğ‘-th critical query, then the server returns ğ‘€ = ğ‘€âˆ—
if
pw = pwâˆ—. Otherwise the server returns ğœ–.
We define an intermediate hybrid experiment Hybâ€²
ğ‘,3,ğ‘
We can immediately see that
Hybâ€²
(cid:12)(cid:12)(cid:12) Pr(cid:104)
ğ‘,3,ğ‘ = 1(cid:105) âˆ’ Pr(cid:104)
(cid:12)(cid:12)(cid:12) Pr(cid:104)
Hybğ‘,3,ğ‘âˆ’1 = 1(cid:105) âˆ’ Pr(cid:104)
|PW|
Hybğ‘,3,ğ‘ = 1(cid:105)(cid:12)(cid:12)(cid:12) â‰¤
ğ‘,3,ğ‘ = 1(cid:105)(cid:12)(cid:12)(cid:12) â‰¤ negl(ğœ†)
Hybâ€²
since the only way to distinguish between the two is to query DecO
with pw = pwâˆ—.
It thus suffices to show that
1
ğ‘
under the DDH assumption.
Suppose not, we construct an adversary B against DDH as fol-
lows. Let the ğ‘¡-th honest key rotation query be the latest one before
the ğ‘-th critical query. We can assume without loss of generality
that B knows ğ‘¡ as B can guess ğ‘¡ correctly with inverse-polynomial
probability. Let ğ¼ be the set of corrupt parties requested by A during
the ğ‘¡-th honest key rotation query. We consider two cases.
9
Case 1: 0 âˆ‰ ğ¼. Without loss of generality, we can assume that
ğ¼ = [ğ‘š]. In this case, B receives a DDH instance (ğº, ğºğ›¼, ğº ğ›½, ğºğ›¾),
and set ğ¾â€²
0 := ğºğ›¼ when answering the ğ‘¡-th honest key rotation
query. Note that B does not know ğ‘˜0 := ğ›¼ and hence, during the
time between the ğ‘¡-th and (ğ‘¡ + 1)-st honest key rotation, cannot