e
z
i
l
a
m
r
o
N
1.8
1.6
1.4
1.2
1.0
e
m
i
t
n
u
r
d
e
z
i
l
a
m
r
o
N
7
6
5
4
3
2
1
e
m
i
t
n
u
r
d
e
z
i
l
a
m
r
o
N
2.25
2.00
1.75
1.50
1.25
1.00
(8,6)
(12,9)
(16,12)
Coding Scheme
(20,15)
720
1440
2160
Number of Blocks
e
m
i
t
n
u
r
d
e
z
i
l
a
m
r
o
N
7
6
5
4
3
2
1
2880
100
200
Bandwidth (Mbps)
500
1000
LF
EDF
LF
EDF
LF
EDF
(a) Erasure coding scheme
(b) Number of native blocks
(c) Rack download bandwidth
e
m
i
t
n
u
r
d
e
z
i
l
a
m
r
o
N
2.00
1.75
1.50
1.25
1.00
e
m
i
t
n
u
r
d
e
z
i
l
a
m
r
o
N
3.0
2.5
2.0
1.5
1.0
1−node
2−node
Failure Pattern
1−rack
1%
10%
20%
Intermediate data
30%
1
2
3
4
5
6
Job ID
7
8
9
10
LF
EDF
LF
EDF
LF
EDF
(d) Failure pattern
(e) Amount of intermediate data
(f) Multi-job scenario
Figure 7. Comparisons of normalized runtimes of LF and EDF versus different parameters.
of the map phase and they only compete with the shufﬂed
data generated by themselves, while EDF has increasing
normalized runtime as its degraded tasks compete with the
shufﬂed data generated by the currently running local map
tasks. Nevertheless, EDF still reduces the normalized runtime
of LF by 20.0% to 33.2%.
We thus far focus on a single MapReduce jobs, and we
now evaluate LF and EDF when multiple MapReduce jobs
are simultaneously running. We generate 10 jobs, whose
inter-arrival times follow an exponential distribution with
mean 120s. The jobs are scheduled based on the default
ﬁrst-in-ﬁrst-out (FIFO) scheduling to allocate map/reduce
slots among different jobs. Figure 7(f) shows the normalized
runtime of each of the 10 jobs. We see that EDF remains
effective even in the multiple-job scenario, as it reduces the
normalized runtime of LF by 28.6% to 48.6%.
C. Basic vs. Enhanced Degraded-First Scheduling
We now compare BDF and EDF under various settings. We
consider both homogeneous and heterogeneous clusters. In
addition, we consider an extreme case where EDF signiﬁ-
cantly outperforms BDF.
We describe our simulation setup. The homogeneous
cluster has the same default conﬁguration as in Section V-B,
while the heterogeneous cluster follows the same conﬁgura-
tion as the homogeneous one except that half of the nodes
have worse processing power with the mean processing
times of the map and reduce tasks set to 40s and 60s,
respectively. We compute different metrics of BDF and EDF,
including the number of remote tasks launched, degraded
read time (i.e., the time from issuing a degraded read request
until k blocks are downloaded from surviving nodes), and
MapReduce runtime, and compare the results with that of
LF in failure mode (with a single node failure). We present
boxplots of 30 samples for each setting.
Figure 8(a) ﬁrst compares the percentage increase in the
number of remote tasks of BDF and EDF compared to LF.
BDF has more remote tasks than LF, by 35.4% and 25.4%
on average for homogeneous and heterogeneous clusters,
respectively. The reason is that BDF assigns degraded tasks
earlier and has fewer slots for the originally local tasks in LF,
some of which now become remote tasks. On the other hand,
EDF has fewer remote tasks than LF by 10.7% and 6.7%
on average for homogeneous and heterogeneous clusters,
respectively. EDF assigns degraded tasks to the nodes that
have low processing time for local tasks, and hence prevents
these nodes from stealing local tasks from other nodes. Thus,
the overall number of remote tasks drops.
Figure 8(b) shows the reduction of degraded read time
of BDF and EDF compared to LF. BDF reduces the degraded
read time by 80.5% and 83.1% on average for homogeneous
and heterogeneous clusters, respectively, while EDF achieves
the average reduction by 85.4% and 85.5%, respectively.
EDF further reduces the degraded read time since it assigns
427427427
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 08:03:27 UTC from IEEE Xplore.  Restrictions apply. 
f
o
r
e
b
m
u
n
n
i
e
s
a
e
r
c
n
I
)
%
(
s
k
s
a
t
e
t
o
m
e
r
200
100
0
−100
homogeneous
heterogeneous
Cluster Type
n
i
n
o
i
t
c
u
d
e
R
)
%
(
e
m
i
t
d
a
e
r
d
e
d
a
r
g
e
d
90
85
80
75
homogeneous
heterogeneous
Cluster Type
n
i
n
o
i
t
c
u
d
e
R
)
%
(
e
m
i
t
n
u
r
e
c
u
d
e
R
p
a
M
40
35
30
25
20
15
homogeneous
heterogeneous
Cluster Type
)
%
60
n
i
n
o
i
t
c
u
d
e
R
(
e
m
i
t
n
u
r
e
c
u
d
e
R
p
a
M
30
0
−30
−60
Extreme case
Algorithm
BDF
EDF
Algorithm
BDF
EDF
Algorithm
BDF
EDF
Algorithm
BDF
EDF