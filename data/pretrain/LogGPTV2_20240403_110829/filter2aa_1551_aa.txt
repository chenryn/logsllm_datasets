Lawful Interception of IP
Lawful Interception of IP
Traffic:
Traffic:
The European Context
The European Context
Jaya Baloo 
Jaya Baloo 
BLACKHAT
BLACKHAT
July 30, 2003
July 30, 2003
Las Vegas, Nevada
Las Vegas, Nevada
Contents
Contents
Introduction to Lawful Interception
Introduction to Lawful Interception
Interception of Internet services
Interception of Internet services
Origins in The European Community
Origins in The European Community
The European Interception Legislation in Brief
The European Interception Legislation in Brief
ETSI
ETSI
The Dutch TIIT specifications
The Dutch TIIT specifications
Interception Suppliers & Discussion of Techniques
Interception Suppliers & Discussion of Techniques
Future Developments & Issues
Future Developments & Issues
Introduction to Lawful Interception
Introduction to Lawful Interception
 ETSI definition of (lawful) interception:
ETSI definition of (lawful) interception:
 interception:
interception: action (based on the law),
 action (based on the law),
performed
performed by an network operator/access
 by an network operator/access
provider/service provider (NWO/AP/SvP), of
provider/service provider (NWO/AP/SvP), of
making available certain information and
making available certain information and
providing that information to a law enforcement
providing that information to a law enforcement
monitoring facility.
monitoring facility.
Network Operator,
Access Provider or 
Service Provider
Law
Enforcement
Agency 
(LEA)
Law
Enforcement
Monitoring
Facility
  LI
order
Deliver requested
information
LI
LI’’s Raison D
s Raison D’’etre
etre
 Why intercept?
Why intercept?
 Terrorism
Terrorism
 Pedophilia rings
Pedophilia rings
 Cyber stalking
Cyber stalking
 Data theft 
Data theft ––Industrial espionage
Industrial espionage
 Drug dealers on the internet
Drug dealers on the internet
 Why not?
Why not?
 Privacy
Privacy
 Security
Security
Legal Issues in LI
Legal Issues in LI
 Judge: "Am I not to hear the truth?"
Judge: "Am I not to hear the truth?"
Objecting Counsel: "No, Your Lordship is to hear the
Objecting Counsel: "No, Your Lordship is to hear the
evidence."
evidence."
 Some characteristics of evidence- relevance to LI
Some characteristics of evidence- relevance to LI
 Admissible 
Admissible –– can evidence be considered in court
 can evidence be considered in court––
*differs per country
*differs per country
 Authentic 
Authentic –– explicitly link data to individuals
 explicitly link data to individuals
 Accurate 
Accurate –– reliability of surveillance process over
 reliability of surveillance process over
content of intercept
content of intercept
 Complete 
Complete –– tells a 
 tells a ““complete
complete”” story of a particular
 story of a particular
circumstance
circumstance
 Convincing to juries 
Convincing to juries –– probative value, and subjective
 probative value, and subjective
practical test of presentation
practical test of presentation
Admissibility of Surveillance
Admissibility of Surveillance
Evidence
Evidence
 Virtual Locus Delecti
Virtual Locus Delecti
 Hard to actually find criminals in delicto  flagrante
Hard to actually find criminals in delicto  flagrante
 How to handle expert evidence? Juries are not
How to handle expert evidence? Juries are not
composed of network specialists. Legal not scientific
composed of network specialists. Legal not scientific
decision making.
decision making.
 Case for treating Intercepted evidence as secondary and
Case for treating Intercepted evidence as secondary and
not primary evidence
not primary evidence
 Primary
Primary  –– is the best possible evidence 
 is the best possible evidence –– e.g. in the
 e.g. in the
case of a document 
case of a document –– its original.
 its original.  
 Secondary
Secondary  –– is clearly not the primary source 
 is clearly not the primary source –– e.g.
 e.g.
in the case of a document 
in the case of a document –– a copy.
 a copy.
Interception of Internet services
Interception of Internet services
Interception of Internet services
Interception of Internet services
What are defined as Internet services?
What are defined as Internet services?
 access to the Internet
access to the Internet
 the services that go over the Internet, such as:
the services that go over the Internet, such as:
 surfing the World Wide Web (e.g. html),
surfing the World Wide Web (e.g. html),
 e-mail,
e-mail,
 chat and icq,
chat and icq,
 VoIP, FoIP
VoIP, FoIP
 ftp,
ftp,
 telnet
telnet
What about encrypted traffic?
What about encrypted traffic?
 Secure e-mail (e.g. PGP, S/MIME)
Secure e-mail (e.g. PGP, S/MIME)
 Secure surfing with HTTPS (e.g. SSL, TLS)
Secure surfing with HTTPS (e.g. SSL, TLS)
 VPNs (e.g. IPSec)
VPNs (e.g. IPSec)
 Encrypted IP Telephony (e.g. pgp -phone and
Encrypted IP Telephony (e.g. pgp -phone and
Nautilus)
Nautilus)
 etc.
etc.
 If applied by NWO/AP/SvP then
If applied by NWO/AP/SvP then
 encryption should be stripped before sending to
encryption should be stripped before sending to
LEMF or
LEMF or
 key(s) should be made available to LEA
key(s) should be made available to LEA
else
else
 a challenge for the LEA
a challenge for the LEA
Logical Overview
Logical Overview
Technical Challenges
Technical Challenges
 Req. 
Req. ––Maintain Transparency & Standard of
Maintain Transparency & Standard of
Communication
Communication
 Identify Target - Monitoring Radius 
Identify Target - Monitoring Radius –– misses
 misses
disconnect
disconnect
 Capture Intercept information 
Capture Intercept information –– Effective
 Effective
Filtering Switch
Filtering Switch
 Packet Reassembly
Packet Reassembly
 Software complexity increases bugginess
Software complexity increases bugginess
 Peering with LEMF
Peering with LEMF
Origins in The European
Origins in The European
Community
Community
What is LI based on in the EU?
What is LI based on in the EU?
 Legal Basis
Legal Basis
 EU directive
EU directive
 Convention on Cybercrime 
Convention on Cybercrime –– Council of Europe-
 Council of Europe-
 Article 20- Real time collection of traffic data
Article 20- Real time collection of traffic data
 Article 21- Interception of content data
Article 21- Interception of content data
 National laws & regulations
National laws & regulations
 Technically
Technically
 Not 
Not Carnivore
Carnivore
 Not
Not Calea
 Calea
 Standards, Best Practices based approach
Standards, Best Practices based approach
 IETF
IETF’’s standpoint (RFC 2804 IETF Policy on
s standpoint (RFC 2804 IETF Policy on
Wiretapping )
Wiretapping )
The European Interception
The European Interception
Legislation in Brief
Legislation in Brief
Solution Requirements
Solution Requirements
European Interception Legislation
European Interception Legislation
 France
France
 Commission Nationale de Contr
Commission Nationale de Contrôôle des
le des
Interceptions de S
Interceptions de Séécurit
curitéé -- La loi 91-636
 -- La loi 91-636
 Loi sur la Securite Quotidienne 
Loi sur la Securite Quotidienne –– November
 November
2001
2001
 Germany
Germany
 G-10 
G-10 –– 2001- 
 2001- ””Gesetz zur Beschr
Gesetz zur Beschräänkung des
nkung des
Brief-, Post- und Fernmeldegeheimnisses
Brief-, Post- und Fernmeldegeheimnisses””
 The Counter terrorism Act 
The Counter terrorism Act –– January 2002
 January 2002
UK Interception Legislation
UK Interception Legislation
UK
UK
Regulation of Investigatory Powers Act 2000
Regulation of Investigatory Powers Act 2000
Anti-terrorism, Crime and Security Act 2001
Anti-terrorism, Crime and Security Act 2001
““The tragic events in the United States on 11 September 2001
The tragic events in the United States on 11 September 2001
underline the importance of the Service
underline the importance of the Service’’s work on national security
s work on national security
and, in particular, counter-terrorism. Those terrible events
and, in particular, counter-terrorism. Those terrible events
significantly raised the stakes in what was a prime area of the
significantly raised the stakes in what was a prime area of the
Service
Service’’s work. It is of the utmost importance that our Security Service
s work. It is of the utmost importance that our Security Service
is able to maintain its capability against this very real threat, both in
is able to maintain its capability against this very real threat, both in
terms of staff and in terms of other resources. Part of that falls to
terms of staff and in terms of other resources. Part of that falls to
legislation and since this website was last updated we have seen the
legislation and since this website was last updated we have seen the
advent of the Regulation of Investigatory Powers Act 2000, Terrorism
advent of the Regulation of Investigatory Powers Act 2000, Terrorism
Act 2000 and the Anti-Terrorism Crime and Security Act 2001. Taken
Act 2000 and the Anti-Terrorism Crime and Security Act 2001. Taken
together these Acts provide the Security Service, amongst others, with
together these Acts provide the Security Service, amongst others, with
preventative and investigative capabilities, relevant to the technology
preventative and investigative capabilities, relevant to the technology
of today and matched to the threat from those who would seek to
of today and matched to the threat from those who would seek to
harm or undermine our society. 
harm or undermine our society. ““  –– The UK Home Secretary
 The UK Home Secretary’’ss
Foreword on www.MI5.gov
Foreword on www.MI5.gov
The Case in Holland
The Case in Holland
At the forefront of LI : both legally & technically
At the forefront of LI : both legally & technically
The Dutch Telecommunications Act 1998
The Dutch Telecommunications Act 1998–– Operator Responsibilities
 Operator Responsibilities
The Dutch Code of Criminal Proceedings 
The Dutch Code of Criminal Proceedings –– Initiation and handling of
 Initiation and handling of
interception request
interception request
The Special Investigation Powers Act -streamlines criminal
The Special Investigation Powers Act -streamlines criminal
investigation methods
investigation methods
WETVOORSTEL 20859 
WETVOORSTEL 20859 –– backdoor decree to start fishing
 backdoor decree to start fishing
expeditions for NAW info 
expeditions for NAW info –– Provider to supply info not normally
 Provider to supply info not normally
available
available
LIO 
LIO –– National Interception Office 
 National Interception Office –– in operation since end of 2002
 in operation since end of 2002
CIOT 
CIOT –– central bureau for interception for telecom
 central bureau for interception for telecom
European Telecommunications
European Telecommunications
Standards Institute
Standards Institute
Technical Specs. of Lawful
Technical Specs. of Lawful
Interception The ETSI model
Interception The ETSI model
NWO/AP/SvP’s
administration
function
IRI mediation
function
CC mediation
function
Network
Internal
Functions
IIF
INI
intercept related
information (IRI)
content of
communication (CC)
LI handover interface HI
HI1
HI2
HI3
LEMF
LEA
domain
NOW / AP / SvP‘s domain
IIF: internal interception function
INI: internal network interface
HI1: administrative information
HI2: intercept related information
HI3: content of communication
ETSI 
ETSI 
Purpose of ETSI LI standardization 
Purpose of ETSI LI standardization ––  ““to facilitate the economic
to facilitate the economic
realization of lawful interception that complies with the national and
realization of lawful interception that complies with the national and
international conventions and legislation 
international conventions and legislation ““
Enable Interoperability 
Enable Interoperability –– Focuses on Handover Protocol
 Focuses on Handover Protocol
Formerly ETSI TC SEC LI 
Formerly ETSI TC SEC LI –– working group
 working group
Now ETSI TC LI 
Now ETSI TC LI ––separate committee standards docs.
separate committee standards docs.
Handover Spec 
Handover Spec –– IP 
 IP –– expected in 2003-04-01 WI 0030-20
 expected in 2003-04-01 WI 0030-20
DTS/LI-00005 
DTS/LI-00005 –– Service specific details for internet access 
 Service specific details for internet access ––
RADIUS DHCP 
RADIUS DHCP –– etc. how  to intercept internet access services 
 etc. how  to intercept internet access services ––
payload
payload
DTS/LI-00004 
DTS/LI-00004 –– Email specific
 Email specific
Extras VOIP PPP tunneling 
Extras VOIP PPP tunneling –– proposals
 proposals
IPV6  - integrate in 0005 ?
IPV6  - integrate in 0005 ?
Current Status : still in progress
Current Status : still in progress
Comprised primarily of operators and vendors - WG LI
Comprised primarily of operators and vendors - WG LI
ETSI TR 101 944 
ETSI TR 101 944 –– The Issues
 The Issues
ETSI TR 101 944
ETSI TR 101 944
 Responsibility- Lawful Interception requirements
Responsibility- Lawful Interception requirements
must be addressed separately to Access Provider
must be addressed separately to Access Provider
and Service Provider.
and Service Provider.
 5 layer model - Network Level & Service Level
5 layer model - Network Level & Service Level
division
division
 Implementation Architecture 
Implementation Architecture ––
 Telephone cct. (PSTN/ISDN)
Telephone cct. (PSTN/ISDN)
 Digital Subscriber Line (xDSL)
Digital Subscriber Line (xDSL)
 Local Area Network (LAN)
Local Area Network (LAN)