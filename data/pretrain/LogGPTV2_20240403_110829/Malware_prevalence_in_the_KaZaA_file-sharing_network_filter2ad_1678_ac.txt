### 4.2 Virus Propagation Behavior in P2P Networks

In this section, we explore the tactics employed by P2P viruses beyond simply using popular file names such as "WinZip" or "Adobe."

**Figure 3: Query Strings vs. % of Infected Files for the May-06 Dataset**

#### 4.2.1 Virus Propagation in P2P Networks

We observed that some viruses in our datasets are not typically classified as P2P viruses. For example, Hidrag [22] is a Win32 virus that infects `.exe` files on the victim's logical drives. If the infected user has executable files in their KaZaA sharing folder, the virus can spread through the KaZaA P2P network. In principle, any virus can propagate in a P2P network if it places an infected binary in a shared folder.

Here, we discuss several factors that influence a virus's ability to spread within a P2.P network:

1. **Aliasing Factor**: The top three viruses in terms of the percentage of infected clients are designed to spread efficiently in a P2P network. These viruses create copies with multiple file names associated with over 10 query strings.
2. **Binary Variants**: These viruses also generate numerous binary variants (e.g., 62 Tanked variants and 14 SdDrop variants) to evade simple signature-based detection.

To determine the relationship between these factors and the spreadability of the virus, we compute a correlation coefficient \( r \) defined as:

\[
r = \frac{N \sum xy - \sum x \sum y}{\sqrt{\left(N \sum x^2 - (\sum x)^2\right)\left(N \sum y^2 - (\sum y)^2\right)}}
\]

where \( N \) is the number of sample points (97, the number of viruses found in both datasets). Our analysis indicates a positive correlation between these factors and the degree of propagation. Figure 4 shows a scatter plot with a strong positive correlation (\( r = 0.74 \)) between the percentage of infected clients (spreadability) and the combined effect of the aliasing factor and the number of binary variants.

**Figure 4: Scatter Plot of Spreadability vs. Combined Factors**

- **X-axis**: Multiplication of the aliasing factor and the number of binary variants.
- **Y-axis**: Percentage of infected clients.
- **Solid Line**: Linear regression fit to the data.

#### 4.3 Characteristics of Infected Hosts

Once compromised, a host can be used for various malicious activities, including DDoS attacks, spam relaying, and botnet command and control [13]. Table 4 categorizes the viruses found in the May-06 dataset by their attack methods, where available.

**Table 4: Known Attack Methods by Viruses in May-06**

| Attack Method | Virus List |
|---------------|------------|
| Backdoor      | Sndc, Tanked, Kwbot, Bagle, Darby, SdBot, SpyBot, Swen, IRCBot, Agent.Gen, Delf, Dropper |
| Spam (email)  | Bagle, Darby, Mapson-A, Ronoper, Swen, NetSky |
| Spam (messenger) | Bropia, Supova |
| DDoS         | Darby, Kindal, SdBot |
| Information Stealing | Darby, SdBot |

In the February-06 dataset, we observed that among the KaZaA client hosts not behind a NAT, 1,618 hosts contained infected files. Interestingly, 79 of these hosts were also found in the May-06 dataset. Except for one host that no longer had the infected file detected in February, 78 hosts (4.8%) remained infected in May. This suggests that these users either remain unaware of the infection or have been reinfected.

To check if these infected hosts were used for spam email relaying, we cross-referenced their IP addresses against six DNS-based blacklists (DNSBLs):

- bl.spamcop.net
- cbl.abuseat.org
- dnsbl.sorbs.net
- list.dsbl.org
- opm.blitzed.org
- sbl.spamhaus.org

As shown in Table 5, over 70% of the infected hosts are listed in one or more DNSBLs, indicating a high likelihood of spam activity.

**Table 5: KaZaA Client Host Statistics**

| Dataset | Infected | Listed in DNSBLs |
|---------|----------|------------------|
| Feb-06  | 1,618    | 1,146 (70.83%)   |
| May-06  | 2,576    | 1,825 (70.85%)   |

*Note: We excluded hosts in private address spaces (10/8, 172.16/12, and 192.168/16) since their information is unavailable in DNSBLs.*

### 5. Summary and Future Work

This study was motivated by the significant increase in network viruses and other malicious programs propagating through P2P networks. Using a crawler developed for the KaZaA file-sharing network, we collected data in February and May 2006. Our analysis revealed that approximately 15% of sampled executable files contain viral code. We identified 52 different active viruses in the KaZaA network in May 2006, with SdDrop and its variants, and Tanked viruses being the most prevalent, collectively accounting for 71% of the total infected clients.

Future work will focus on better understanding the distribution of malware in P2P networks, tracking changes in prevalent viruses, and developing models to explain virus propagation behavior. Additionally, we are developing a crawling-based malware detection system to automatically identify infected executables in P2P networks.

### Acknowledgments

We gratefully acknowledge funding from the Electronics & Telecommunications Research Institute (ETRI), Korea.

### References

[1] Ehtereal.com. Ethereal. http://www.ethereal.com/.

[2] FaceTime Security Labs. IM and P2P Threats. http://www.facetime.com/securitylabs/imp2pthreats.aspx.

[3] F. Le Fessant, S. Handurukande, A.-M. Kermarrec, and L. Massouli. Clustering in Peer-to-Peer File Sharing Workloads. In Proceedings of Peer-to-Peer Systems, 3rd International Workshop (IPTPS), February 2004.

[4] FreJon. FastTrack File Format. http://members.home.nl/frejon/55/ft/KazaaFileFormats.html#dbbformat.

[5] giFT Project. giFT: Internet File Transfer. http://gift.sourceforge.net/.

[6] Iain Ferguson. Sharman Cuts Off KaZaA Downloads in Australia. CNET News.com http://news.com.com/Sharman+cuts+off+Kazaa+downloads+in+Australia/2100-%1027_3-5983455.html.

[7] N. Naoumov Jian Liang and Keith W. Ross. The Index Poisoning Attack in P2P File-Sharing Systems. In Proceedings of INFOCOM 2006, April 2006.

[8] KaZaA.com. KaZaA. http://www.kazaa.com/us/index.htm.

[9] KaZaA.com. KaZaA SuperNode. http://www.kazaa.com/us/help/faq/supernodes.htm.

[10] Jian Liang, Rakesh Kumar, and Keith W Ross. The FastTrack Overlay: A Measurement Study. In Computer Networks, pages 842–858, August 2005.

[11] Jian Liang, Rakesh Kumar, Yongjian Xi, and Keith W Ross. Pollution in P2P File Sharing Systems. In Proceedings of INFOCOM 2005, March 2005.

[12] Bryn Loban. Between Rhizomes and Trees: P2P Information Systems. In First Monday Peer-Reviewed Journal on the Internet, September 2004.

[13] Martin Overton. Bots and Botnets: Risks, Issues and Prevention. In Proceedings of the 15th Virus Bulletin Conference, 2005.

[14] Poisoned Project. Poisoned. http://gottsilla.net/poisoned.php.

[15] Ron Rivest. The MD5 Message-Digest Algorithm. Internet Engineering Task Force, April 1992. RFC 1321.

[16] Slyck.com. Slyck’s P2P Network Stats Page. http://slyck.com/stats.php.

[17] Daniel Stutzbach and Reza Rejaie. Capturing Accurate Snapshots of the Gnutella Network. In Proceedings of 8th IEEE Global Internet Symposium, pages 127–132, March 2005.

[18] Daniel Stutzbach, Reza Rejaie, and Subhabrata Sen. Characterizing Unstructured Overlay Topologies in Modern P2P File-Sharing Systems. In Proceedings of the ACM SIGCOMM Internet Measurement Conference, October 2005.

[19] Symantec Security Response. CodeRed. http://www.symantec.com/avcenter/venc/data/codered.worm.html.

[20] Symantec Security Response. Slammer. http://www.symantec.com/avcenter/venc/data/w32.sqlexp.worm.html.

[21] University of Delaware Police Computer Forensic Lab. DBB KaZaA Share File. http://128.175.24.251/forensics/lastsharedate.htm.

[22] Viruslist.com. Hidrag. http://www.viruslist.com/viruses/encyclopedia?virusid=20627.

[23] Viruslist.com. Peer-to-Peer Worms. http://www.viruslist.com/en/virusesdescribed?chapter=153311928.

[24] VLAIBB. Sig2Dat. http://www.geocities.com/vlaibb/.

[25] Wikipedia. FastTrack. http://en.wikipedia.org/wiki/FastTrack.

[26] Wei Yu. Analyze the Worm-Based Attack in Large Scale P2P. In 8th IEEE International Symposium on High-Assurance Systems Engineering (HASE), pages 308–309, March 2004.

[27] Zeropaid.com. KaZaA Lite. http://www.zeropaid.com/kazaalite/.

[28] Kim Zetter. KaZaA Delivers More Than Tunes. The Wired Magazine, January 2004.

[29] Shanyu Zhao, Daniel Stutzbach, and Reza Rejaie. Characterizing Files in the Modern Gnutella Network: A Measurement Study. In Proceedings of SPIE/ACM Multimedia Computing and Networking, January 2006.

[30] Lidong Zhou, Lintao Zhang, Frank McSherry, Nicole Immorlica, Manuel Costa, and Steve Chien. A First Look at Peer-to-Peer Worms: Threats and Defenses. In Proceedings of the IPTPS, February 2005.