“WinZip”, or “Adobe”. In the next section, we discuss other tac-
tics that P2P viruses employ in addition to choosing a popular ﬁle
name.
Figure 3: Query strings vs. % of infected ﬁles for the may-06
dataset
4.2 Virus Propagation Behavior in P2P
Network
We note that some viruses seen in the datasets are not known
to be P2P viruses. For instance, Hidrag [22] is a Win32 virus that
infects .exe ﬁles in the victim’s logical drives. Therefore, if the
victim had executable ﬁes in the KaZaA sharing folder, the virus
could then spread into the KaZaA P2P network. In principle, any
virus can propagate in a P2P network as long as it places an in-
fected binary in a folder used for ﬁle sharing. Here, we discuss a
few factors that affect the propensity of a virus to spread in a P2P
network.
As shown in Figure 2, the top 3 viruses in terms of the percent-
age of infected clients are the ones that are crafted to efﬁciently
spread in a P2P network. On a closer examination, we ﬁnd that (1)
these viruses produce copies in many different ﬁles names associ-
ated with over 10 query strings, which we call an aliasing factor
and (2) they generate many binary variants (62 Tanked variants,
14 SdDrop variants) to render inefﬁcient a simple signature-based
detection.
To determine a relationship of each factor, x, with the spread-
ability, y, we compute a coefﬁcient coefﬁcient, r, deﬁned as
NP xy −P xP y
p(NP x2 − (P x)2)(NP y2 − (P y)2)
r =
where N is the number of sample points (97, the number of viruses
found from both datasets). It appears that both factors have a posi-
tive correlation with the degree of propagation. Figure 4 is a scatter
plot showing a strong positive correlation, r = 0.74, between the
percentage of infected clients (spreadability) and the combination
of both factors.10
Figure 4: A dot corresponds to each virus found in feb-06 and
in may-06. The x-axis is the multiplication of an aliasing fac-
tor and the number of binary variants found from each virus.
The y-axis is the percentage of infected clients. The solid line
represents the result of the linear regression to the data.
4.3 Characteristics of Infected Hosts
Once compromised, a host can be used for such nefarious ac-
tivities as DoS attacks, spam relaying, and botnet command and
control [13]. Table 4 categorizes the viruses found in the may-06
dataset by the employed attack method if such information is avail-
able.
In the feb-06 dataset, we observe that among the KaZaA client
hosts that are not behind a NAT box, 1,618 hosts contain an infected
10As the number of binary variants goes up to several hundreads for
certain virus, we computed a correlation coefﬁcient between log(x)
and log(y).
Attack
Backdoor
Spam
(email)
Spam
(messenger)
DDoS
Information steal-
ing
Virus list
Sndc, Tanked, Kwbot, Bagle, Darby, SdBot, Spy-
Bot, Swen, IRCBot, Agent.Gen, Delf, Dropper
Bagle, Darby, Mapson-A, Ronoper,
Swen, NetSky
Bropia, Supova
Darby, Kindal, SdBot
Darby, SdBot
Table 4: Known attack methods by the viruses found in
may-06
ﬁle. Interestingly, we see 79 of these infected client hosts in the
may-06 dataset as well. Except the one host that no longer has the
infected ﬁle that we detected in February, 78 of them (4.8%) appear
still to be infected in May. This result suggests that these users are
either unaware that their machines were infected for months or that
their machines have been reinfected.
To check whether these infected hosts may have been used
for relaying spam email, we check the IP addresses of the
infectees against six DNS-based black lists (DNSBLs), bl.
spamcop.net, cbl.abuseat.org, dnsbl.sorbs.net,
list.dsbl.org, opm.blitzed.org, sbl.spamhaus.
org. As shown in Table 5, over 70% of infectees are listed in
one or more of DNSBLs, which is a strong indicator that hosts in
question may have engaged in sending out spam email.
infected
listed in DNSBLs
feb-06
1,618
1,146 (70.83%)
may-06
2,576
1,825 (70.85%)
Table 5: KaZaA client host statistics: In generating these statis-
tics, we exclude hosts in private address space, 10/8, 172.16/12,
and 192.168/16 since their information is unavailable in DNS-
BLs.
5. SUMMARY AND FUTURE WORK
The work in this paper was motivated by a dramatic rise in net-
work viruses and other malicious programs that propagate over P2P
networks. Using a crawler developed for the KaZaA ﬁle-sharing
network, we have collected data in February and May 2006. The
analysis results show that about 15% of sampled executable ﬁles
contain a viral code. We have found 52 different viruses that are
active in the KaZaA network in May, 2006. SdDrop and its vari-
ants and Tanked viruses are more prevalent than other viruses, col-
lectively resulting in 71% of the total infected clients.
Our future work includes better understanding the distribution
of the malware in a P2P network, tracking the change of prevalent
viruses, and developing a model to explain the propagation behav-
ior of a virus in a P2P network. In parallel with more measurement
efforts, we are currently developing a crawling-based malware de-
tection system that automatically identiﬁes infected executables in
a P2P network.
Acknowledgments
We gratefully acknowledge funding from Electronics & Telecom-
munications Research Institute (ETRI), Korea.
 0.01 0.1 1 10 100 1 10 100 1000% of infected clients(aliasing factor) X (# of binary variants)y = 0.63x-1.936. REFERENCES
[1] Ehtereal.com. Ethereal. http://www.ethereal.com/.
[2] FaceTime Security Labs. IM and P2P Threats.
http://www.facetime.com/securitylabs/
imp2pthreats.aspx.
[3] F. Le Fessant, S. Handurukande, A.-M. Kermarrec, and
L. Massouli. Clustering in Peer-to-Peer File Sharing
Workloads. In Proceedings of Peer-to-Peer Systems, 3th
International Workshop (IPTPS), February 2004.
[4] FreJon. FastTrack File Format.
http://members.home.nl/frejon/55/ft/
KazaaFileFormats.html#dbbformat.
[5] giFT Project. giFT: Internet File Transfer.
http://gift.sourceforge.net/.
[6] Iain Ferguson. Sharman Cuts Off KaZaA Downloads in
Australia. CNET News.com http://news.com.com/
Sharman+cuts+off+Kazaa+downloads+in+
Australia/2100-%1027_3-5983455.html.
[7] N. Naoumov Jian Liang and Keith W. Ross. The Index
Poisoning Attack in P2P File-Sharing Systems. In
Proceedings of INFOCOM 2006, April 2006.
[8] KaZaA.com. KaZaA.
http://www.kazaa.com/us/index.htm.
[9] KaZaA.com. KaZaA SuperNode. http://www.kazaa.
com/us/help/faq/supernodes.htm.
[10] Jian Liang, Rakesh Kumar, and Keith W Ross. The
FastTrack Overlay: A Measurement Study. In Computer
Networks, pages 842–858, August 2005.
[11] Jian Liang, Rakesh Kumar, Yongjian Xi, and Keith W Ross.
Pollution in P2P File Sharing Systems. In Proceedings of
INFOCOM 2005, March 2005.
[12] Bryn Loban. Between Rhizomes and Trees: P2P Information
Systems. In First Monday Peer-Reviewed Journal on the
Internet, September 2004.
[13] Martin Overton. Bots and Botnets: Risks, Issues and
Prevention. In Proceedings of the 15th Virus Bulletin
Conference, 2005.
[14] Poisoned Project. Poisoned.
http://gottsilla.net/poisoned.php.
[15] Ron Rivest. The MD5 Message-Digest Algorithm. Internet
Engineering Task Force, April 1992. RFC 1321.
[16] Slyck.com. Slyck’s P2P Network Stats Page.
http://slyck.com/stats.php.
[17] Daniel Stutzbach and Reza Rejaie. Capturing Accurate
Snapshots of the Gnutella Network. In Proceedings of 8th
IEEE Global Internet Symposium, pages 127–132, March
2005.
[18] Daniel Stutzbach, Reza Rejaie, and Subhabrata Sen.
Characterizing Unstructured Overlay Topologies in Modern
P2P File-Sharing Systems. In Proceedings of the ACM
SIGCOMM Internet Measurement Conference, October
2005.
[19] Symantec Security Response. CodeRed.
http://www.symantec.com/avcenter/venc/
data/codered.worm.html.
[20] Symantec Security Response. Slammmer.
http://www.symantec.com/avcenter/venc/
data/w32.sqlexp.worm.html.
[21] University of Delaware Police Computer Forensic Lab. DBB
KaZaA Share File. http://128.175.24.251/
forensics/lastsharedate.htm.
[22] Viruslist.com. Hidrag. http://www.viruslist.com/
viruses/encyclopedia?virusid=20627.
[23] Viruslist.com. Peer-to-Peer Worms.
http://www.viruslist.com/en/
virusesdescribed?chapter=153311928.
[24] VLAIBB. Sig2Dat.
http://www.geocities.com/vlaibb/.
[25] Wikipedia. FastTrack.
http://en.wikipedia.org/wiki/FastTrack.
[26] Wei Yu. Analyze the Worm-Based Attack in Large Scale
P2P. In 8th IEEE International Symposium on
High-Assurance Systems Engineering (HASE), pages
308–309, March 2004.
[27] Zeropaid.com. KaZaA Lite.
http://www.zeropaid.com/kazaalite/.
[28] Kim Zetter. KaZaA Delivers More Than Tunes. The Wired
Magazine, January 2004.
[29] Shanyu Zhao, Daniel Stutzbach, and Reza Rejaie.
Characterizing Files in the Modern Gnutella Network: A
Measurement Study. In Proceedings of SPIE/ACM
Multimedia Computing and Networking, January 2006.
[30] Lidong Zhou, Lintao Zhang, Frank McSherry, Nicole
Immorlica, Manuel Costa, and Steve Chien. A First Look at
Peer-to-Peer Worms: Threats and Defenses. In Proceedings
of the IPTPS, February 2005.