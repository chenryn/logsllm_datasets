• Communicate/through/a/shared/event/log./
/
The Cobalt Strike client may connect to multiple team servers. Go to Cobalt Strike -> New 
Connection to initiate a new connection. When connected to multiple servers, a switchbar will 
show up at the bottom of your Cobalt Strike window.  
www.cobaltstrike.com/
/
11/
Figure 7. Server Switchbar 
This switchbar allows you to switch between active Cobalt Strike server instances. Each server 
has its own button. Right-click a button and select Rename to make the button’s text reflect the 
role of the server during your engagement. This button name will also identify the server in the 
Cobalt Strike Activity Report.. 
When connected to multiple servers, Cobalt Strike aggregates listeners from all of the servers it’s 
connected to. This aggregation allows you to send a phishing email from one server that 
references a malicious website hosted on another server. At the end of your engagement, Cobalt 
Strike’s reporting feature will query all of the servers you’re connected to and merge the data to 
tell one story. 
1.6 Scripting Cobalt Strike 
Cobalt Strike is scriptable through its Aggressor Script language. Aggressor Script is the  
spiritual successor to Armitage’s Cortana scripting language. The two are not compatible though. 
To manage scripts, go to Cobalt Strike -> Script Manager. 
Figure 8. Script Manager 
A default script inside of Cobalt Strike defines all of Cobalt Strike’s popup menus and formats 
information displayed in Cobalt Strike’s consoles. Through the Aggressor Script engine, you 
may override these defaults and customize Cobalt Strike to your preferences. 
You may also use Aggressor Script to add new features to Cobalt Strike’s Beacon and to 
automate certain tasks. 
To learn more about Aggressor Script, consult its documentation at: 
• https://www.cobaltstrike.com/aggressor-script//
www.cobaltstrike.com/
/
12/
2. User Interface 
2.1 Overview 
The Cobalt Strike user interface is split into two parts. The top of the interface shows a 
visualization of sessions or targets. The bottom of the interface displays tabs for each Cobalt 
Strike feature or session you interact with. You may click the area between these two parts and 
resize them to your liking. 
Figure 9. Cobalt Strike User Interface 
2.2 Toolbar 
The toolbar at the top of Cobalt Strike offers quick access to common Cobalt Strike functions. 
Knowing the toolbar buttons will speed up your use of Cobalt Strike considerably. 
Connect to another team server  
Disconnect from the current team server 
Create and edit Cobalt Strike’s listeners 
Change to the “Pivot Graph” visualization 
www.cobaltstrike.com/
/
13/
Change to the “Session Table” visualization 
Change to the “Target Table” visualization 
View credentials 
View downloaded files 
View keystrokes 
View screenshots 
Generate a stageless Cobalt Strike executable or DLL 
Setup the Java Signed Applet attack 
Generate a malicious Microsoft Office macro 
Stand up a stageless Scripted Web Delivery attack 
Host a file on Cobalt Strike’s web server 
Manage files and applications hosted on Cobalt Strike’s web server 
Visit the Cobalt Strike support page 
About Cobalt Strike 
2.3 Session and Target Visualizations 
Cobalt Strike has several visualizations each designed to aid a different part of your engagement. 
You may switch between visualizations through the toolbar or the Cobalt Strike -> 
Visualization menu. 
Targets Table 
The Targets Table shows the targets in Cobalt Strike’s data model. The targets table displays the 
IP address of each target, its NetBIOS name, and a note that you or one of your team members 
assigned to the target. The icon to the left of a target indicates its operating system. A red icon 
with lightning bolts indicates that the target has a Cobalt Strike Beacon session associated with 
it.  
Figure 10. Cobalt Strike Targets View 
www.cobaltstrike.com/
/
14/
Click any of the table headers to sort the hosts. Highlight a row and right-click it to bring up a 
menu with options for that host. Press Ctrl and Alt and click to select and deselect individual 
hosts. 
The target’s table is a useful for lateral movement and to understand your target’s network.  
Sessions Table 
The sessions table shows which Beacons are calling home to this Cobalt Strike instance. Beacon 
is Cobalt Strike’s payload to emulate advanced threat actors. Here, you will see the external IP 
address of each Beacon, the internal IP address, the egress listener for that Beacon, when the 
Beacon last called home, and other information. Next to each row is an icon indicating the 
operating system of the compromised target. If the icon is red with lightning bolts, the Beacon is 
running in a process with administrator privileges. A faded icon indicates that the Beacon session 
was asked to exit and it acknowledged this command. 
Figure 11. Cobalt Strike Beacon Management Tool 
If you use a DNS Beacon listener, be aware that Cobalt Strike will not know anything about a 
host until it checks in for the first time. If you see an entry with a last call time and that’s it, you 
will need to give that Beacon its first task to see more information.  
Right-click one or more Beacon’s to see your post-exploitation options.  
Pivot Graph 
Cobalt Strike has the ability to link multiple Beacons into a chain. These linked Beacons receive 
their commands and send their output through the parent Beacon in their chain. This type of 
chaining is useful to control which sessions egress a network and to emulate a disciplined actor 
who restricts their communication paths inside of a network to something plausible. This 
chaining of Beacons is one of the most powerful features in Cobalt Strike.  
Cobalt Strike’s workflows make this chaining very easy. It’s not uncommon for Cobalt Strike 
operators to chain Beacons four or five levels deep on a regular basis. Without a visual aid it’s 
very difficult to keep track of and understand these chains. This is where the Pivot Graph comes 
in. 
The Pivot Graph shows your Beacon chains in a natural way. Each Beacon session has an icon. 
As with the sessions table: the icon for each host indicates its operating system. If the icon is red 
with lightning bolts, the Beacon is running in a process with administrator privileges. A darker 
icon indicates that the Beacon session was asked to exit and it acknowledged this command. 
www.cobaltstrike.com/
/
15/
The firewall icon represents the egress point of your Beacon payload. A dashed green line 
indicates the use of beaconing HTTP or HTTPS connections to leave the network. A yellow 
dashed line indicates the use of DNS to leave the network. 
Figure 12. Cobalt Strike Graph View 
An arrow connecting one Beacon session to another represents a link between two Beacons. 
Cobalt Strike’s Beacon uses Windows named pipes and TCP sockets to control Beacons in this 
peer-to-peer fashion. An orange arrow is a named pipe channel. SSH sessions use an orange 
arrow as well. A blue arrow is a TCP socket channel. A red (named pipe) or purple (TCP) 
arrow indicates that a Beacon link is broken.  
Click a Beacon to select it. You may select multiple Beacons by clicking and dragging a box 
over the desired hosts. Press Ctrl and Shift and click to select or unselect an individual Beacon. 
Right-click a Beacon to bring up a menu with available post-exploitation options.  
Several keyboard shortcuts are available in the Pivot Graph.  
• Ctrl+Plus/—/zoom/in/
• Ctrl+Minus/—/zoom/out/
• Ctrl+0&—/reset/the/zoom/level/
• Ctrl+A/—/select/all/hosts/
• Escape/—/clear/selection/
• Ctrl+C/—/arrange/hosts/into/a/circle/
• Ctrl+S/—/arrange/hosts/into/a/stack/
www.cobaltstrike.com/
/
16/
• Ctrl+H/—/arrange/hosts/into/a/hierarchy.//
/
Right-click the Pivot Graph with no selected Beacons to configure the layout of this graph. This 
menu also has an Unlinked menu. Select Hide to hide unlinked sessions in the pivot graph. 
Select Show to show unlinked sessions again. 
2.4 Tabs 
Cobalt Strike opens each dialog, console, and table in a tab. Click the X button to close a tab. 
Use Ctrl+D to close the active tab. Ctrl+Shift+D will close all tabs except the active on. 
You may right-click the X button to open a tab in a window, take a screenshot of a tab, or close 
all tabs with the same name. 
Keyboard shortcuts exist for these functions too. Use Ctrl+W to open the active tab in its own 
window. Use Ctrl+T to quickly save a screenshot of the active tab. 
Ctrl+B will send the current tab to the bottom of the Cobalt Strike window. This is useful for 
tabs that you need to constantly watch. Ctrl+E will undo this action and remove the tab at the 
bottom of the Cobalt Strike window. 
Hold shift and click X to close all tabs with the same name. Hold shift + control and click X to 
open the tab in its own window. 
Use Ctrl+Left and Ctrl+Right to quickly switch tabs. 
You may drag and drop tabs to change their order. 
2.5 Consoles 
Cobalt Strike provides a console to interact with Beacon sessions, scripts, and chat with your 
teammates. 
Figure 13. A Console Tab 
www.cobaltstrike.com/
/
17/
The consoles track your command history. Use the up arrow to cycle through previously typed 
commands. The down arrow moves back to the last command you typed. 
Use the Tab key to complete commands and parameters.  
Use Ctrl+Plus to make the console font size larger, Ctrl+Minus to make it smaller, and Ctrl+0 
to reset it. This change is local to the current console only. Visit Cobalt Strike -> Preferences to 
permanently change the font. 
Press Ctrl+F to show a panel that will let you search for text within the console. 
Use Ctrl+A to select all text in the console’s buffer. 
2.6 Tables 
Cobalt Strike uses tables to display sessions, credentials, targets, and other engagement 
information.  
Most tables in Cobalt Strike have an option to assign a color highlight to the highlighted rows. 
These highlights are visible to other Cobalt Strike clients. Right-click and look for the Color 
menu. 
Press Ctrl+F within a table to show the table search panel. This feature lets you filter the current 
table. 
Figure 14. Table with Search Panel 
The text field is where you type your filter criteria. The format of the criteria depends on the 
column you choose to apply the filter to. Use CIDR notation (e.g., 192.168.1.0/24) and host 
ranges (192.168.1-192.169.200) to filter columns that contain addresses.  Use numbers or ranges 
of numbers for columns that contain numbers. Use wildcard characters (*, ?) to filter columns 
that contain strings.  
www.cobaltstrike.com/
/
18/
The ! button negates the current criteria. Press enter to apply the specified criteria to the current 
table. You may stack as many criteria together as you like. The Reset button will remove the 
filters applied to the current table. 
www.cobaltstrike.com/
/
19/
3. Data Management 
3.1 Overview 
Cobalt Strike’s team server is a broker for information collected by Cobalt Strike during your 
engagement. Cobalt Strike parses output from its Beacon payload to extract targets, services, and 
credentials.  
If you’d like to export Cobalt Strike’s data, you may do so through Reporting -> Export Data. 
Cobalt Strike provides options to export its data as TSV and XML files. The Cobalt Strike 
client’s export data feature will merge data from all of the team servers you’re currently 
connected to. 
3.2 Targets 
You may interact with Cobalt Strike’s target information through View -> Targets. This tab 
displays the same information as the Targets Visualization.  
Press Import to import a file with target information. Cobalt Strike accepts flat text files with 
one host per line. It also accepts XML files generated by Nmap (the –oX option). 
Press Add to add new targets to Cobalt Strike’s data model. 
Figure 15. Add a Target 
This dialog allows you to add multiple hosts to Cobalt Strike’s database. Specify a range of IP 
addresses or use CIDR notation in the Address field to add multiple hosts at one time. Hold 
down shift when you click Save to add hosts to the data model and keep this dialog open. 
Select one or more hosts and right-click to bring up the hosts menu. This menu is where you 
change the note on the hosts, set their operating system information, or remove the hosts from 
the data model. 
www.cobaltstrike.com/
/
20/
3.3 Services 
From a targets display, right-click a host, and select Services. This will open Cobalt Strike’s 
services browser. Here you may browse services, assign notes to different services, and remove 
service entries as well. 
Figure 16. The Services Dialog/
3.4 Credentials 
Go to View -> Credentials to interact with Cobalt Strike’s credential model. Press Add to add 
an entry to the credential model. Again, you may hold shift and press Save to keep the dialog 
open and make it easier to add new credentials to the model. Press Copy to copy the highlighted 
entries to your clipboard. Use Export to export credentials in PWDump format. 
Figure 17. The Credential Model 
3.5 Maintenance 
Cobalt Strike’s data model keeps all of its state and state metadata in the data/ folder. This folder 
exists in the folder you ran the Cobalt Strike team server from. 
To clear Cobalt Strike’s data model: stop the team server, delete the data/ folder, and its 
contents. Cobalt Strike will recreate the data/ folder when you start the team server next. 
If you’d like to archive the data model, stop the team server, and use your favorite program to 
store the data/ folder and its files elsewhere. To restore the data model, stop the team server, and 
restore the old content to the data/ folder.  
Reporting -> Reset Data resets Cobalt Strike’s Data Model without a team server restart. 
www.cobaltstrike.com/
/
21/
4. Listener and Infrastructure Management 
4.1 Overview 
The first step of any engagement is to setup infrastructure. In Cobalt Strike’s case, infrastructure 
consists of one or more team servers, redirectors, and DNS records that point to your team 
servers and redirectors. Once you have a team server up and running, you will want to connect to 
it, and configure it to receive connections from compromised systems. Listeners are Cobalt 
Strike’s mechanism to do this. 
A listener is simultaneously configuration information for a payload and a directive for Cobalt 
Strike to stand up a server to receive connections from that payload. A listener consists of a user-
defined name, the type of payload, and several payload-specific options. 
4.2 Listener Management 
To manage Cobalt Strike listeners, go to Cobalt Strike -> Listeners. This will open a tab listing 
all of your configured payloads and listeners.  
Figure 18. Listener Management Tab 
Press Add to create a new listener. 
When you create a listener, make sure you give it a memorable name. This name is how you will 
refer to this listener through Cobalt Strike’s commands and workflows. 
To edit a listener, highlight a listener and press Edit. 
To remove a listener, highlight the listener and press Remove. 
4.3 Cobalt Strike’s Beacon Payload 
Most commonly, you will configure listeners for Cobalt Strike’s Beacon payload. Beacon is 
Cobalt Strike’s payload to model advanced attackers. Use Beacon to egress a network over 
HTTP, HTTPS, or DNS. You may also limit which hosts egress a network by controlling peer-
to-peer Beacons over Windows named pipes and TCP sockets. 
www.cobaltstrike.com/
/
22/
Beacon is flexible and supports asynchronous and interactive communication. Asynchronous 
communication is low and slow. Beacon will phone home, download its tasks, and go to sleep. 
Interactive communication happens in real-time.  
Beacon’s network indicators are malleable. Redefine Beacon’s communication with Cobalt 
Strike’s malleable C2 language. This allows you to cloak Beacon activity to look like other 
malware or blend-in as legitimate traffic. Chapter 11 discusses this feature. 
4.4 Payload Staging 
One topic that deserves mention, as background information, is payloading staging. Many attack 
frameworks decouple the attack from the stuff that the attack executes. This stuff that an attack 
executes is known as a payload. Payloads are often divided into two parts: the payload stage and 
the payload stager. A stager is a small program, usually hand-optimized assembly, that 
downloads a payload stage, injects it into memory, and passes execution to it. This process is 
known as staging. 
The staging process is necessary in some offense actions. Many attacks have hard limits on how 
much data they can load into memory and execute after successful exploitation. This greatly 
limits your post-exploitation options, unless you deliver your post-exploitation payload in stages. 
Cobalt Strike does use staging in its user-driven attacks. These are most of the items under 
Attacks -> Packages and Attacks -> Web Drive-by. The stagers used in these places depend on 
the payload paired with the attack. For example, the HTTP Beacon has an HTTP stager. The 
DNS Beacon has a DNS TXT record stager. Not all payloads have stager options. Payloads with 
no stager cannot be delivered with these attack options. 
If you don’t need payload staging, you can turn it off. Set the host_stage option in your 
Malleable C2 profile to false. This will prevent Cobalt Strike from hosting payload stages on its 
web and DNS servers. There is a big OPSEC benefit to doing this. With staging on, anyone can 
connect to your server, request a payload, and analyze its contents to find information from your 
payload configuration. 
In Cobalt Strike 4.0 and later, post-exploitation and lateral movement actions eschew stagers and 
opt to deliver a full payload where possible. If you disable payload staging, you shouldn’t notice 
it once you’re ready to do post-exploitation. 
4.5 HTTP Beacon and HTTPS Beacon 
The HTTP and HTTPS beacons download tasks with an HTTP GET request. These beacons send 
data back with an HTTP POST request. This is the default. You have incredible control over the 