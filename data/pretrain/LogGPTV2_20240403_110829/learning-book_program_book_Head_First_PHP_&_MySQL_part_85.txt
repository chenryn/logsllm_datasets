2478159
6.用户对这个视频平均评分是多少？
4.17.
692
第12章
---
## Page 729
合成与Web服务
嗯，这些XML标记让我有些糊涂，它们有两个
名，并且用一个冒号分隔。这是一种组职标记的方
法吗？另外，视频类别中奇慢的&amp:代码又是
7什么？
这个不寻常的XML代码使用了命名空间和实体，这有助于组织标记和对
特殊字符编码。
如果看到一个XML标记有两个名并用一个冒号分隔，说明你看到了一个
命名空间，这是将一组标记组织为一个逻辑分组的方法。命名空间的作用
是：当同一个文档中使用了多个XML词汇表时，命名空间可以保证同名的
标记不发生冲突。举例来说，考虑以下两个XML标记：
Favorites of aliensabductedme
UFo Sighting in Yosemite Park near Area 51标记中没有media命名空间，而且倘若这两个标记出现在同一
名的XML标记
个XML代码中，那么就无法区分这两个标记。所以可以把命名空间认为是标记
，，一，一
组，而实体用
的XML文档不会发生冲突。YouTube响应代码使用了多个不同的命名空间，这
于对XML文档
说明它同时使用了多个不同的XML语言，命名空间则允许我们清楚地加以区
分。
中的特殊字符
为确保唯一性，XML命名空间总是与一个URL关联。例如，YouTubeXML数据
编码。
中使用的media命名空间在标记中建立：
这个URL并不是一个We6页面，这
只是一个命名空间的唯一标识符。
K
xmlns:media='http://search.yahoo.com/mrss/*
Yahoo！命名空间出现在YouTube
XML代码中看起来可能很奇怪
这只是表示YouTube部分依赖子
YouTubeXML代码中另一个奇怪的东西是&amp；，这是XML中表示AND字符
Yahoo创建的XML数据格式。
（&）的方法。它是一个XML实体（entity），即引I用一个特殊字符（如&、）
的符号表示，所有这些字符在XML代码中都有特殊的含义。以下是5个预定义
的XML实体，深入研究XML代码时往往会遇到这些实体：
&amp:
t;=
gt;=>
6quot;
=口
6apos;
你现在的位置
693
---
## Page 730
YouTubeXML响应剖析
剖析YouTubeXML响应
一旦了解了YouTube响应的结构，抽取出所需的视频数据就相当简单了。除
了了解哪些标记和属性存储哪些数据，理解标记相互之间有何关系也很重
要。如果还记得本章前面分析RSS提要时曾指出，XML文档可以看作是元
素的一个层次体系。YouTube视频响应返回的XML数据也是一样。
标记包含视频的
标题。
http://gdata.youtube.com/feeds/api/videos/_6Uibqf0vtA
在这个代码中，标记
2006-06-20T07:49: 05.000-07:00
名为“title“.命名空
K
间是“media"
UFo SightinginYosemite Parknear Area 51
I went on a trip to Yosemite Park in 2002. Yosemite Park is very
close to the border between California and Nevada, and close to Area 51..
视频的关键字。
ufo
视频的长度（秒数）。
Travel
medium='video'isDefault='true′expression='ful1'duration='50'yt:formdt
Tag
的链接。
time='00:00:25'/>
视频的缩略图
用于预览。
视频的平均用户评分
视频被叠看的次数
sd”命名空间代表GoosleData，包含
Goosle定义的表示各类数据的标记
YouTabe是Google的一部分。
要理解这个XML代码中隐藏的视频数据，一个重要的线索就是这里使用的不同
命名空间。media命名空间包含大多数专门与视频数据相关的标记，而yt命名
空间主要用于标记。最后，注释包含在标记中，
这属于gd命名空间。编写PHP代码来查找特定的标记及其数据时，这些命名空
间会很有帮助。
694
第12章
---
## Page 731
合成与Web服务
可视化显示XML视频数据
本章前面处理RSS代码时，曾指出XML文档可以图示化为元素（标记）的
元素就是考虑
一个有父子关系的层次结构。在处理XML代码以及访问其中存储的数据时，
XML标记及其
这个关系更显重要。实际上，如果通过查看一个XML文档就能立即可视化
显示出元素之间的关系，这是一个极有意义的本领。只需记住，包含在另
所包含数据的
一个元素中的所有元素都作为子元素，外围元素是其父元素。处理上一页
一种抽象方法。
YouTube视频的XML代码可以得到以下可视化图示。
entry元素是这个特定XML代码块
XML数据组织为元素（标记）的一
的最上民元素。
个层次结构。
entry
id
published
group
statisticsrating
title description
eywords
duration category
content
content
player
thumbnai1-
thumbnai1
feedLink
这个元素层次体系的意义在于，通过追踪由这个层次体系最上层开始
的路径，可以从任何元素导航到另一个元素。所以，举例来说，如果
希望得到视频的标题，可以如下追踪其路径：
要导航到XML文档中的一个元素，电
entry
group
title
要沿着从义元意到子元素的路径导航。
theregareno
DumbQuestions
这会对你如何通过程序访问XML元素产生影响。你会发现，空间不会显式出现在代码中，但大多数情况下，都会看到
编写处理XML数据的PHP代码时，与一个元素关联的命名标记名旁边有命名空间，所以标记会写作
空间会直接影响该元素。所以如果试图获取一个给定元素
而不只是。冒号左边的往往就是命名空间。
的数据，代码中必须考虑到命名空间。
你现在的位置
695
---
## Page 732
关于PHP对象
围对象访问XML数据
用PHP处理XML数据有很多不同方式，其中最好的一种方法就是使用对象。
对象是一个结合
对象是一个特殊的PHP数据类型，可以将数据和函数结合到一个构造中。不
了数据和函数的
过，这与XML有什么关系呢？事实上，一个XML文档中的整个元素层次结
构都包含在一个变量中，即一个对象。可以使用这个对象挖掘到数据，并
特殊PHP数据类
访问单个元素。对象还提供了方法，也就是绑定到对象的函数，从而允许
型。
进一步处理对象的数据。对于一个包含XML数据的对象，方法允许我们访
问一个元素的一组子元素以及其属性。
存能和处理XML数据所用的PHP对
SimpleXMLElement
象类型是SimpleXMCElement。
XML文格中的各个元素
可以作为一个XML对象
id
children ()
SimpleXMLElement对象提供了一些方法
的属性来访问。
updated
允许你了解有关元素的更多信息，如算
attributes()
子元素和属性。
category
entry
创建XML对象：
高版本。
define('YOUTUBE_URL'
'http://gdata.youtube.com/feeds/api/videos/-/alien/abduction/head/first') ;
$xml = simplexml_1oad_file(YOUTUBE_URL);
这个函数创建一个类型为
SimpleXMLElementPHP对象
这个代码会得到一个名为SxmI的变量，其中包含打包到一个PHP对象的所
其中包含YouTube视频响应中
有XMLYouTube视频数据。要访问这个数据，可以使用对象属性，即存储
的XML数据
在一个对象中的各部分数据。每个属性对应一个XML元素。来看下面的例
子，这里将访问文档中的所有entry元素：
逐过指定元素名（entry）.可以获取XML数
$entries = $xml->entry;
据中的所有entry元素。
利用一>提作符可以访问一个对
象中的属性。
所有视频项都存储在Sentzies数
组中。
这个代码使用一个属性来访问XML数据中的所有entry元素。由于数据中有
多个entry元素，$entries变量会存储一个对象数组，可以用来访问单个的视
频项。另外由于现在在处理一个数组，所以可以指定数据索引来访问各个
视频标记。例如，文档中第一个标记就是数组中的第一个元
素，第二个标记是第二个元素，依次类推。
Sentries
696
第12章
---
## Page 733
合成与Web服务
从XML元素到PHP对象
谈到XML数据和PHP对象时，实际上就是指一个对象集合。还记得前面关
于把XML文档可视化显示为一个元素层次结构的内容吗？实际上，这个层
次结构还可以在PHP中实现为一个对象集合。如下：
entry
id
published
group
statistics
rating
title description
teywordsduration category
content content
thumbnail
feedLink
I
从XML对象的角度来悉.XML元
素的层次结构就是一个嵌套的对
象集合。
rating是entry对象
的子对象，因为
标记是
的子标记。
dutation对象是stoup对象的
子对象，因为标
记是的子标记。
这个元素层次结构/对象集合可以作为理解PHP中如何处理XML数据的基
YouTube视频大多数有意思的
PDG
础。考虑到各个XML数据之间的这种关系，完全可以编写代码在数据中导
航。这样一来，我们可以抽取出深深存储在XML文档的某个特定标记或属
内容都包含在sroup对象的子
对象中。
性中的内容。
你现在的位置
697
---
## Page 734
访问对象数据
利用对象挖掘XML数据
再来看Owen的情况，我们的目标是取出有关视频的一些信息，这是作为XML
YouTube响应的一部分返回的。我们知道如何使用simplexml_load_file（）
函数将XML数据获取到一个PHP对象中，但是大多数有意思的数据还需要在其中
更深层次地查找。如何在对象集合中导航呢？答案是利用->操作符，这个操作
符用于引I用一个对象的属性或方法。对于XML对象，->操作符可以访问各个子
对象。所以以下代码会显示存储在一个Sentry变量中的视频的标题：
这里一>摄作符用于挖据嵌奢子
对象来访问title对象。
echo $entry->group->title;
这个代码相当依赖于title、group和entry对象之间的关系，这构成从
一个对象到下一个对象的父子关系。
title对象是sroup对象的子对
象，而stoup对象是entry对象
的子对象。
itle
->操作符从一个父对象引l用一个子对象。所以title是group的子对象，
而group是entry的子对象。记住->操作符可以用于访问属性以及方法。
还有一个非常方便的方法：attributes（）方法，可以用这个方法取出给
定元素的一个XML属性的值。
attributes）方法可以得到一个对象
（元意）的一个属性数组
这个代码挖掘到duration元素，然后获取其所有属性，并存储在Sattrs变
量中，这是所有属性的一个数组。然后从该数组获取第2个属性的值。
使用属性名作为数组的键，
可以获取一个特定的属性值
group
attributes()
698
第12章
---
## Page 735
合成与Web服务
不能没有命名空间！
上一页使用对象访问XML数据的代码有一个小问题，还必须处理命名空间。如
命名空间会使
果还记得，命名空间相当于标记的姓，把标记组织到有特定含义的集合中。所
访问XML数据
以在一个YouTube响应中，标记实际上编码为，
中的元素更困难
视频的标题则编码为，而不是。一个元素与一个命
名空间关联时，PHP代码中就不能只用标记名来引用。实际上，必须通过对父
一些。
对象调用children（）方法，首先按命名空间来抽取。
$media = $entry->children('http://search.yahoo.com/mrss/');
childzen(）方法返回一个数
这个代码会获取一个视频中命名空间为http：//search.yahoo.com/
组其中包含指定命名空
间中的所有子元素。
mrSs/的所有子对象。不过，这是命名空间的URL，而不是命名空间本身。
这个URL放在XML文档最前面的标记中。在这里可以找到所使用
的全部命名空间。
这个代码显示了各个命名空间如何与一个URL关联。更具体地，可以看到
使用children()
这里指定了media和yt命名空间要在文档中使用。你所要做的就是找到与
方法抽取出与一
这两个命名空间关联的标记。
个命名空间关
一且通过对父元素调用children（）方法抽取出一个特定命名空间
的子元素，就可以用->操作符继续访问子对象。例如，以下代码从
联的所有元素。
标记得到视频标题：
$title = $media->group->title;
标记是标
记的一个子标记。
使用以上的命名空间信息和PHP代码，完成下面的PHP代码，
得到一个视频片段的持续时间（秒数）。
$yt = Smedia->children(
echo Sattrs['
'];
你现在的位置
669
---
## Page 736
关于对象的“没有傻问题
harpenyour
Solution
使用以上的命名空间信息和PHP代码，完成下面PHP代码，得
到一个视频片段的持续时间（秒数）。
这是文档开始处
K
Syt =Smedia->chi1dren(*http://sdata.youtabe.com/schemas/2007·);
标记中所列命
名空间的URL
Sattrs-Syt->dutation->attibutes);
echo Sattrs['seconds.'];
获取标记的所
7
有属性。
属性名作为访问属性数组的键。
thereareno
DumbQuestions
吗？
它来访问一个子元素呢？
的一个区别是，对象可以通过方法为之关联可执行的代码。上存储为属性。所以使用->操作符访问一个子对象时，实
方法与函数很相似，只不过方法要绑定到一个对象，通常际就是在访问一个属性。SimpleXMLElement对象使之成
设计为专门处理存储在一个对象中的数据。数组则纯释存为可能。
储一组相关的数据，根本没有方法的概念。另外，数组元