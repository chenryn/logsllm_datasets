1
http://www.soldierx.com/defcon16speech/docsis_insecure_by_design-blake_durandal.ppt
Humor
2
Maybe Ted Stevens has a series of
hacked modems and a drop amp at his
place.  Could this be the reason he
thinks that the internet is a series of
tubes?
Background
• Personal
– Conducted SIPRNET Administration and Red Team
Penetration Testing for the USMC.
– I currently do research for SERC (Software
Engineering Research Center), an NSF
Industry/University Cooperative Research Center.
• Speech
– A much shorter version of this presentation was given
at the Spring 2008 SERC Showcase.
– Various people (such as Durandal from SOLDIERX)
have used the methods in this Defcon presentation to
put and keep modems online.
3
What This Speech Will Cover
• Requirements (for our examples)
• Network Overview
• Anonymous Access
– Gaining service with a non provisioned MAC address
• Cloning a HFC MAC linked to an ISP account
• How Anonymous You Really Are
– How close ISPs can pinpoint your location as well as
techniques to catch people abusing/stealing service
• Firmware Overview
• Hardware and Security
– Specifications, firmware disassembly, current and
future security solutions
4
Requirements
• What do you need for our examples?
– Coaxial connection to the cable company
– JTAG cable
• MIPS EJTAG (Enhanced Joint Test Action Group)
– - USB Cypress or FTDI based JTAG (Fast)
– - Parallel buffered/unbuffered JTAG (Slow)
– SB5100/5101 cable modem
• Other modems can be modified
– Soldering Skills + 10 pin header
• YouTube is an excellent resource for soldering reference
– Applications for flashing the firmware onto a modem
• Parallel - Schwartze Katze by tcniso.com
• USB - USB JTAG from usbjtag.com
5
Requirements In Depth
• Cable connection
• EJTAG Cable
– Easy to make
– Available online
• USBJtag
– Difficult to make
– Really fast
6
Requirements In Depth (cont’d)
7
Requirements In Depth (cont’d)
• Modify the SB5100/5101 or buy a Premod
– (available from sites like www.sbhacker.net)
8
Requirements In Depth (cont’d)
• Program the SB5100/5101 using
Schwarze Katze/USB JTAG.
9
Modified Firmware
• Features of Sigma X2/Haxorware:
– Enable factory mode
– Change all associated MAC Addresses
– Change serial number
– Disable ISP firmware upgrade
– Disable reboots
– Force network access (ignore unauthorized messages)
– Disable & Set ISP filters (ports blocked at modem level)
– Specify config filename and TFTP server IP address
– Force config file from ISP, local TFTP or uploaded flash
memory.
– Get & Set SNMP OID values and Factory mode OID values
– Broadcom CLI access through serial connection or telnet
– Full shell access to VxWorks/eCos (unix-like OS)
– Upload, flash and upgrade firmware
10
Cable Network Overview
11
Anonymous Internet Access
•
For our example of anonymous internet access, we will be using Comcast.
•
Why Comcast?
–
According to Alex Goldman’s research on isp-planet.com, as of the fourth quarter
of 2007 - Comcast is the second most used ISP in the United States, and the
number one used ISP using DOCSIS. (http://www.isp-
planet.com/research/rankings/usa.html)
•
If you hook a non-provisioned modem into the Comcast network, the only
page that comes up is a Comcast page asking you to sign up for service.
•
You can generally connect inbound to the computer that is hooked up to the
modem but you cannot connect outbound from the computer.
•
Changing the DNS servers gives you the ability to connect out (some of the
time). Forcing a config file at this point is all that is necessary to increase the
service class for a non provisioned modem.
•
Disabling SNMP filters in the console removes port blocking at the modem
level and allows a user to poll other modems for useful information on ISP
that allow SNMP polling through the entire HFC network:
–
cd /snmp
–
filters off
–
type and return yes for changes to take immediate effect
12
Faster Speeds
•
Anonymous access is good, but faster anonymous access is better.
•
In order to increase speeds, you can force a faster configuration file
from the ISP, served locally or from configs stored in flash memory.
•
You may specify a TFTP server, Comcast uses static instead of
dynamic configs and each server has the same configuration files.
•
Some example configuration files that Comcast uses:
– DOCSIS 1.0
• d10_m_sb5100_speedtierextreme2_c05.cm = 16/2
• d10_m_sb5100_showcase_c01.cm = 55/5
• d10_m_na_c05.cm = 0/0 (unrestricted)
– DOCSIS 1.1
• d11_m_sb5100_speedtierextreme2_c05.cm = 16/2
• d11_m_sb5100_showcase_c01.cm = 55/5
• d11_m_na_c05.cm = 0/0 (unrestricted)
13
Changing the Configuration File
• Navigate to http://192.168.100.1:1337
• The examples pictures are from Sigma X2 on the SB5100
14
You can either specify a file that
exists on ISP server, local server
or  upload and serve a file from
flash memory. Forcing you own
custom config file is not generally
possible.
Changing the Configuration File
• Navigate to http://192.168.100.1:1337
• The example is from Haxorware on the SB5101
15
Techniques for Remaining Anonymous
•
Disable the SNMP daemon after registration
– cd /non-vol/snmp
– diag_disable_post_reg true
– write
•
Hide the Modem’s HFC IP Address (You cannot hide CPE IP
addresses)
– cd /non-vol/snmp
– hide_ipstack_ifentries true
– write
•
Hide Reported Software Version (system OID)
– cd /snmp
– delete sysDescr
– write
• These and other settings can be hard coded into or set
by firmware for a desired result submitted to the CMTS.
16
Field Results
• Various anonymous cable modem hackers have
reported high success rates with zero signs of
detection
– Durandal has a machine on a business
configuration that has been seeding torrents
steadily for over a year
– Many people have as many as 8 or more
modems running concurrently
– In all of these scenarios, the individuals are
paying for service.  They are simply splicing
their line to add additional modems
17
Cloning
• Basic Cloning involves specifying a
provisioned HFC MAC address in order to
get a class of service assigned to the MAC.
• Due to the broadcast nature of the
network, you must use a HFC MAC
address that is on a CMTS other than
yours.
• This method allows you to then force any
config file, but it associates your modem
with someone else’s account.
18
Cloning (Cont’d)
•
The CMTS (Cable Modem Termination System) does not prevent the
cloning of a MAC address from Node 3 to Node 1.
19
Obtaining Information for Cloning
•
MAC addresses are traded privately on forums and IRC.
•
Finding HFC MAC addresses on your node can be found by
sniffing the DHCP packets that are sent from the CMTS to all
modems.
•
Wireshark can filter out broadcasted packets to easily
assemble a list of HFC MAC’s on a user’s node.
•
SNMP scanning the preferred method for obtaining HFC
MAC’s for multiple nodes with ISP’s that allow it.
•
Exact clones can be used by obtaining all identifying
information from the modem including the HFC MAC, ETHER
MAC, USB MAC, Serial, and all BPI+ Certificates.
•
Exact clones are usually non-provisioned modems - the
collective information simply allows the modem to pass initial
authentication checks and gain network access.  A faster
config file would be forced to bypass the ISP assigned non-
provisioned config that has a limited class of service.
20
How Anonymous Are You?
• The Operations Support System is normally unable to
pinpoint a modem to an exact location due to the design
of the hybrid fiber coax cable network.
• Usually, detection only goes as far as the node where the
modem in question is located.
21
How Anonymous Are You? (cont’d)
• Some ISPs poll for poor signal levels.
– Technicians would disconnect each line to find out which line is
causing the signal loss.
– You can prevent this by using an amp if your signal strength is too
low.  We personally like the BDA-S1 Broadband Drop Amp from
Motorola.
– The downstream should be between -15 and +15 dBmV and the
upstream should be between -35 to -50 (Upstream is always
negative).
• Many ISPs perform routine audits on lines that should not
be connected in order to verify that they are not.
– Most ISPs use colored tags to identify the account and service.
• Some ISP have adopted & implemented (at a cost) ROC
– Regional Operating Centers: independently networked to each
CMTS that collectively maintains a customer MAC database.
22
Throwing Up a Red Flag
• Not using previously discussed techniques
for remaining anonymous.
• Excessive torrenting.
• FTP/Web Servers hosting Warez/Porn (or
other types of heavily used services).
• Using cloned MAC addresses without
discretion, committing fraud crimes etc.
• Splitting the connection too many times
will weaken the signal and can cause
techs to come out to check it.
23
Precautions to Take
• Do not transfer personal information over
unencrypted connections….EVER!