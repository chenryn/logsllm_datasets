s
QQQQQ
AND

s2
7777777
(QQQQQQQQQQQ

AND
s3
7777777
1
2
3
2
3
4
3
4
5
Figure 4: Example of Threshold Access Tree.
attributes 1, 2, 3 to recover e(g, g)r¬∑s1 = Q5
the root is 2-of-3, so we select a random degree-1 polynomial
p such that p(0) = s. For i = 1, 2, 3, we set si := p(i). Then
s can be recovered given any two of the values s1, s2 and s3.
At the leaf level, we treat the AND gates as we do in the basic
scheme of Section 3. Take, for instance, the leftmost AND
gate. The ciphertext includes the following group elements:
hgs1 , T s1
2¬∑5+5i. This allows any user with
i=1 e(g, g)ri¬∑s1 .
The other AND gates are represented similarly in the ci-
2¬∑5+5i
phertext, using the tuples hgs2 , T s2
3 , T s2
2¬∑5+1, T s2
5 i. Thus, any user sat-
and hgs3 , T s3
4 , T s3
2¬∑5+1, T s3
isfying at least two of the three AND gates can decrypt by
recovering e(g, g)r¬∑s.
2¬∑5+2, T s3
1 , T s1
2 , T s1
3 , T s1
2¬∑5+4, T s1
2 , T s2
4 , T s2
3 , T s3
Unfortunately, this extended scheme is insecure. The key
point is that s1, s2, and s3 are not independent random
values. Consider a user with attributes ¬¨1, 2, 3, 4,¬¨5. Only
the middle AND gate is satisÔ¨Åed by this attribute set, and
hence decryption should not be allowed. However, notice
that 5 is a don‚Äôt care in the Ô¨Årst two AND gates. Therefore
the user can recover e(g, g)r5¬∑s1 and e(g, g)r5¬∑s2 . Since s1 and
s2 are two distinct points on the same degree-1 polynomial,
e(g, g)r5¬∑s3 can be recovered using interpolation. Moreover,
the user has attributes 3 and 4, and attributes 1 and 2 are
don‚Äôt care‚Äôs in the last AND gate, therefore he can obtain
(legitimately) e(g, g)ri¬∑s3 for i = 1, 2, 3, 4. Combining these
with e(g, g)r5¬∑s3 from interpolation, the user can now recover
e(g, g)r¬∑s3 , which in turns allows him to decrypt in violation
of the access policy.
To avoid such attacks, it seems necessary to have inde-
pendent random exponents s1, s2, and s3, so the attacker
cannot take advantage of don‚Äôt care‚Äôs and polynomial inter-
polation. For example, one can perform the secret sharing
procedure on the message M to obtain shares M1, M2 and
M3, which are then encrypted to the three AND gates in-
dependently. This proposal, however, suÔ¨Äers from collusion
attacks: if one user can recover M1 and another can recover
M2, then they can collude to recover M .
We note that collusion attacks of this type pose no threat
when we restrict to disjunctive normal form (DNF) policies,
although a formal security proof remains elusive. The dif-
Ô¨Åculty seems to be that, in the selective ID security game
(cf. Section 2), the adversary must commit to a challenge
If multiple AND
access structure before the game starts.
gates are used, the simulator in the reduction proof must
choose one of the AND gates and use it to obtain the public
key. The chosen AND gate is ‚Äúgood‚Äù if it corresponds to a
non-negligible jump in success probability in the subsequent
hybrid argument. It is unclear how the simulator can predict
which AND gate is good before the game starts.
A possible solution is to consider adaptive ID security,
which strengthens selective ID security by allowing the ad-
versary to choose a challenge access structure in the Chal-
lenge phase. In that setting, we are able to prove the secu-
rity of multiple encryptions [7]. Thus, we leave as important
future work to Ô¨Ånd adaptive ID security proofs for CP-ABE.
7. APPLICATIONS
As observed in [12], ABE has much potential in providing
data security in distributed environments, because it allows
complex access policies to be speciÔ¨Åed and enforced without
online interaction with trusted and/or centralized servers.
In this section, we outline two applications: selective data
sharing and group key management. Many other applica-
tion scenarios have been mentioned, including audit log and
targeted broadcast [10], distributed Ô¨Åle systems for medical
data and online social networks [12]. The areas of cryp-
tographic Ô¨Åle systems and content distribution are also of
interest.
7.1 Selective Data Sharing
Consider a scenario in which a large corporation installs a
standing committee to investigate any reports of improper
conducts of employees. Members of this committee are drawn
from diÔ¨Äerent departments and locations, and are given three
diÔ¨Äerent clearance levels. Using a hierarchical CP-ABE in-
stance similar to that in Section 5, these attributes can be
categorized as in Figure 5.
Committee
sggggggggggggg
!CCCC
{wwwwww
Dept
}zzzz
+VVVVVVVVVVVVV
#GGGGGG
~}}}}
Loc
@@@@
Acc
Pur
HR 1
3 NY DC LA
Clr
2
Figure 5: Attributes By Category.
Suppose there is an investigation regarding an account-
ing oÔ¨Écer in New York, and company policy says that no
committee member from the accounting department in New
York may take part in this investigation. To encrypt a memo
regarding this investigation, the content of the memo is Ô¨Årst
encrypted with a symmetric data key. The data key is then
encrypted separately with the AND gates in Figures 6 and 7.
(We write ‚ÄúAtt:‚àó‚Äù to indicate that we don‚Äôt care about the
attribute ‚ÄúAtt‚Äù.) The two ciphertexts are placed in a header
that accompanies the encrypted memo. Anyone not belong-
ing to an accounting department can decrypt the Ô¨Årst ci-
phertext, and anyone not working in New York can decrypt
the second. This enforces the desire access policy.
thhhhhhhhhhhhh
xrrrrr
Pur:‚àó
AND
HR:‚àó
*VVVVVVVVVVVV
&LLLLL
Clr:‚àó
¬¨Acc
Loc:‚àó
Figure 6: Excluding ‚ÄúAccounting‚Äù.
7.2 Group Key Management
CP-ABE is well-suited for the problem of Group Key Man-
agement (GKM) in the context of secure multicast. This
v


(












s


+
}


!
{


#
~


t
x


&
*
tiiiiiiiiiiii
ysssss
Clr:‚àó
AND
¬¨NY
*UUUUUUUUUUUU
%KKKKK
DC:‚àó
Dept:‚àó
tions. We also thank the anonymous referees for their com-
ments.
LA:‚àó
9. REFERENCES
[1] J. Bethencourt, A. Sahai, and B. Waters.
Figure 7: Excluding ‚ÄúNew York‚Äù.
problem requires a Group Controller (GC) to maintain a
shared data encryption key, which is used to encrypt mul-
ticast traÔ¨Éc and is known only to current group members
(GMs). New GMs are given this data key through a secure
unicast channel at the time of joining. The main challenge
is membership revocation: excluding a subset of the GMs
from future communications. This action requires the dis-
tribution of a new data key to all remaining GMs, so that
revoked members no long have access to future messages.
It has been noted that CP-ABE can be used to solve the
GKM problem. The main idea is to deÔ¨Åne attributes in such
a way that any subset of users can be distinguished from the
rest using a combination of attributes. More precisely, each
GM is associated with a set of attributes and, for revocation,
the GC computes an access policy that is (i) satisÔ¨Åed by the
attribute sets of all remaining users and (ii) not satisÔ¨Åed by
the attribute set of any revoked user. Therefore, remaining
GMs can use their secret keys to recover the new data key,
while revoked GMs gain no information even if they collude.
In [6], for example, we realized this intuition by con-
structing a collusion-resistant variant of the Ô¨Çat table GKM
scheme. This construction uses the CP-ABE scheme of [1]
and associates log(N ) attributes with each GM, where N is
the size of an ID space. SpeciÔ¨Åcally, each attribute corre-
sponds to one bit in the GM‚Äôs ID, and the GM receives a
CP-ABE secret key associated with his ID. For revocation,
the GC runs a Boolean function minimization algorithm to
obtain a sum of products expression that separates revoked
users from the remaining membership. This expression can
be viewed as a threshold access tree, and CP-ABE is used
accordingly to distribute the new data key.
8. CONCLUSIONS AND FUTURE WORK
In this paper we present several related CP-ABE schemes.
The basic scheme allows an encryptor to use any AND gate
on positive and negative attributes as an access policy on the
ciphertext. This scheme is proven to be CPA secure under
the DBDH assumption. To obtain CCA security, we extend
the basic scheme with strongly existentially unforgeable one-
time signatures.
We also present a variant with substantially smaller ci-
phertexts and faster encryption/decryption operations. The
main idea is to form a hierarchy of attributes, so that fewer
group elements are needed to represent all attributes in the
system. This eÔ¨Écient variant is proven to be CPA secure.
We believe our CCA secure scheme can be optimized in a
similar way.
For disjunctive normal form policies, we propose the use of
independent instances of CP-ABE encryption. The security
of this proposal remains as an open problem, as we look for
adaptive ID security proofs for CP-ABE.
Acknowledgments. We thank Ran Canetti, Ron Rivest,
Eran Tromer, and Brent Waters for many helpful sugges-
Ciphertext-policy attribute-based encryption. In
Proceedings of the 28th IEEE Symposium on Security
and Privacy (Oakland), 2007.
[2] D. Boneh, C. Gentry, and B. Waters. Collusion
resistant broadcast encryption with short ciphertexts
and private keys. In Advances in Crytology ‚Äì
CRYPTO 2005, volume 3621 of LNCS, 2005.
[3] D. Boneh, E. Shen, and B. Waters. Strongly
unforgeable signatures based on computational
DiÔ¨Ée-Hellman. In Proceedings of PKC 2006, volume
3958 of LNCS, pages 229‚Äì240, 2006.
[4] R. Canetti, S. Halevi, and J. Katz. Chosen ciphertext
security from identity based encryption. In Advances
in Cryptology ‚Äì EUROCRYPT 2004, volume 3027 of
LNCS, pages 207‚Äì222, 2004.
[5] M. Chase. Multi-authority attribute-based encryption.
In Proceedings of the 4th IACR Theory of
Cryptography Conference (TCC 2007), 2007.
[6] L. Cheung, J. Cooley, R. Khazan, and C. Newport.
Collusion-resistant group key management using
attribute-based encryption. Cryptology ePrint Archive
Report 2007/161, 2007. Presented at GOCP ‚Äô07.
[7] L. Cheung and C. Newport. Provably secure
ciphertext policy ABE. Cryptology ePrint Archive
Report 2007/183, 2007. http://eprint.iacr.org/.
[8] A. Fiat and M. Noar. Broadcast encryption. In
Advances in Cryptology ‚Äì CRYPTO ‚Äô93, volume 773
of LNCS, pages 480‚Äì491, 1993.
[9] E. Fujisaki and T. Okamoto. Secure integration of
asymmetric and symmetric encryption schemes. In
Advances in Cryptology ‚Äì CRYTO ‚Äô99, pages 537‚Äì554,
1999.
[10] V. Goyal, O. Pandey, A. Sahai, and B. Waters.
Attribute-based encryption for Ô¨Åne-grained access
control of encrypted data. In Proceedings of the 13th
ACM conference on Computer and Communications
Security (CCS 2006), pages 89‚Äì98, 2006.
[11] D. Naor, M. Naor, and J. Lotspiech. Recovation and
tracing schemes for stateless receivers. In Advances in
Cryptology ‚Äì CRYPTO 2001, volume 2139 of LNCS,
pages 41‚Äì62, 2001.
[12] M. Piretti, P. Traynor, P. McDaniel, and B. Waters.
Secure atribute-based systems. In Proceedings of the
13th ACM conference on Computer and
Communications Security (CCS 2006), 2006.
[13] A. Sahai and B. Waters. Fuzzy identity based
encryption. In Advances in Cryptology ‚Äì
EUROCRYPT 2005, volume 3494 of LNCS, pages
457‚Äì473, 2005.
[14] A. Shamir. Identity-based cryptosystems and
signature schemes. In Advances in Cryptology ‚Äì
CRYPTO ‚Äô84, pages 47‚Äì53, 1985.
t
y


%
*