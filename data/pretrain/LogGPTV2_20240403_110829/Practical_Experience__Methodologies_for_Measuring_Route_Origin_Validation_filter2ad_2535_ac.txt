1 if ∀P ∈ {P1,P2},R(d,P,A,ρ) = 1 =⇒
⎩
0 otherwise
⎧⎨
1 if ∃P ∈ {P1,P2},R(d,P,A,ρ) = 1∧
∧(P,A) /∈ ρ
⎩
0 otherwise
⎧⎨
1 if ∃P ∈ {P1,P2},R(d,P,A,ρ) = 1∧
∧(P,A) ∈ ρ
⎩
0 otherwise
and
v(cid:10)(d,A,ρ) =
and
(cid:10)(cid:10)(d,A,ρ) =
v
The ﬁrst symbol v(cid:10) is an indicator of probe desti-
nations d that in time frame ρ delivered into AS A
only replies to an address in the correct preﬁx according
to the valid ROA set. The second symbol v(cid:10) indicates
destinations that at least once delivered a response to AS
A, which contradicted ROA in time frame ρ. The last
symbol v(cid:10)(cid:10) is an indicator of destinations d that delivered
at least one reply in time frame ρ to AS A according to
valid ROAs. Using these symbols we can deﬁne groups
of destination IP addresses. The obvious deﬁnition for
upper bound group is
(cid:10)(d,Ai,ρ j) = 1∧ v(cid:10)(d,Ai,ρ j) = 0}
{d|∀i, j ∈ {1,2} : v
However, this upper bound proves to be too permissive,
because it contains all destinations that we have no
negative evidence for. It includes even the destinations
that do not respond to any of our probes. More precise
requirements set yields the following sets:
(2) Likely protected: 201 (0.03%)
(3) Unresolvable: 45163 (6.66%)
The results contain considerable number of unre-
solved destinations that failed to consistently respond
to at least one of the ASes A1, A2. The probing batches
consist of three uniform probes sent with approximately
3 second delays between them. Packet loss percentage
for each destination has been determined from all the
measurement batches and from both capturing points
in A1 and A2 combined together. The destination was
marked as unresolvable if it exhibited more than 90%
packet loss for at least one preﬁx of the preﬁxes P1 or
P2, because absence of the negative evidence in these
cases might be caused by packet loss rather than by
ROA validation. Moreover, we observed considerable
number of random routing cases (inconsistent routing
behavior within or among probing batches), they are
classiﬁed as unprotected in our experiment.
VI. Comparison of the Approaches
Figure 6 compares the results from the three methods.
We make the following observations: The higher per-
Protected
Unresolvable
Insecure
%
100
80
60
40
20
0
Control plane
Atlas
TCP probes
Fig. 6: Results from all measurement methods
centage of protected entities found by the control-plane
analysis and the Atlas traceroute experiment indicates
that these measurement platforms are likely to introduce
positive selection bias towards progressive technologies
and better network management.
The active TCP probing experiment proved the ex-
pected fact, that Internet core autonomous systems do
not deploy ROV. However, there are indisputable ROV
deployments that have potential to protect certain por-
tion of regional trafﬁc. Unfortunately we were not able
to ﬁnd any large scale ROV deployment.
A. Beneﬁts from ROV Adoption
Our results indicate that very few ASes enforce ROV
– less than the previous evaluations showed [13], [21].
What does this mean for Internet security against preﬁx
hijacks? To answer this question we perform simula-
tions on empirically derived datasets. Our simulations
compute BGP routes using methods in [26], [27], [28]
over the CAIDA AS-connectivity graph from December
2016. Our results average over 106 combinations of
attacker and victim (i.e., the legitimate owner of IP
preﬁx) ASes, both selected uniformly at random from
the set of all ASes, as in [26], [28]. The results quantify
to which extent
is secure against BGP
(sub)preﬁx hijacks given the ROV-supporting ASes that
we found through our experimental evaluation in pre-
vious sections. Figure 7 shows projected upper bound
of ROV adoption impact on number of autonomous
systems that would not be affected by the simulated
hijacking incidents and thus on routing security in the
Internet.
the Internet
d
e
t
c
e
t
o
r
p
t
e
n
r
e
t
n
I
f
o
%
0.30
0.25
0.20
0.15
0.10
0.05
0.00
0
10
20
30
40
50
60
70
Early deployments (autonomous systems)
Fig. 7: ROV adoption impact on routing security
The percentage of protected AS is unfortunately low.
Even the optimistic projection indicates that only a
small portion of the preﬁxes in the Internet could
beneﬁt from ROV deployed in smaller ASes outside the
Internet core. Our results illustrate an even more gloomy
situation than [13] since they arbitrarily assigned prob-
abilities for adoption of ROV, while we use our set
containing ROV adopting ASes that we identiﬁed in
our study. Generally, low ROV coverage in the Internet
is not going to change unless the ASes at the core
enforce ROV. Only wide spread adoption of ROV can
help meeting the goal of considerable improvement in
the Internet routing security.
VII. Security Against BGP Preﬁx Hijacks
In this section we demonstrate the impact of current
ROV adoption on the security of the Internet against
BGP preﬁx hijacks. We then provide recommendations
for countermeasures.
B. Countermeasures
Given the state of security against preﬁx hijacks,
adoption of ROV is paramount. However, as our results
show, ROV adoption is essentially non-existent. What
can we do to improve adotion of ROV? One of the
main obstacles towards wide enforcement of ROV is
640
loss of
that network operators are concerned about
trafﬁc if they apply ROV. This is mainly due to the
many problematic ROAs, mostly due to errors in ROA
issuance and to lack of coordination between different
providers and customers. Our recommendation is a two-
step solution: detect erroneous ROAs and then apply
ROV only on ROAs that appear to be correct.
The ﬁrst step can be performed using tools like
roalert.org, which validates whether an AS has a
valid ROA. In the second step the network can identify
and then ignore the problematic ROAs and ﬁlter BGP
announcements only according to ‘good’ ROAs.
VIII. Conclusions
ROV enforcement by ASes is critical to protecting the
Internet against BGP preﬁx hijacks. Previous efforts
on measuring ROV adoption focused on uncontrolled
[13] and controlled [21] control-plane experiments. We
demonstrate that control-plane provides an inaccurate
estimate of the number and percentage of ROV adopters.
We provide two new approaches and describe our ex-
periments based on them. We show that the percentage
of adopters is smaller than found in previous research.
We also demonstrate that the current ROV-enforcing
ASes have only a negligible impact on the Internet
security. We provide recommendations for tackling the
main problem hindering wide deployment of ROV - the
erroneous ROAs.
IX. Acknowledgements
Israel
We thank Hank Nussbacher,
Inter-University
Computation Center for setting up the experiment and
providing measured data. The research reported in this
paper has been supported in part by the German Federal
Ministry of Education and Research (BMBF), by the
Hessian Ministry of Science and the Arts within CRISP
(www.crisp-da.de/) and co-funded by the DFG as part
of project S3 within the CRC 1119 CROSSING.
References
[1] A. Toonk, “Hijack Event Today by Indosat,” http://www.
bgpmon.net/hijack-event-today-by-indosat/.
[2] “Renesys Blog - Pakistan Hijacks YouTube,” http://www.
renesys.com/blog/2008/02/pakistan hijacks youtube 1.shtml,
Feb. 2008.
[3] A. Toonk, “Turkey Hijacking IP Addresses for Popular Global
DNS Providers,” BGPMon.
[4] “The New Threat: Targeted Internet Trafﬁc Misdirection,” http:
//www.renesys.com/2013/11/mitm-internet-hijacking/.
[5] H. Ballani, P. Francis, and X. Zhang, “A study of preﬁx
hijacking and interception in the Internet,” in SIGCOMM,
J. Murai and K. Cho, Eds. ACM, 2007, pp. 265–276.
[Online]. Available: http://doi.acm.org/10.1145/1282380
[6] P.-A. Vervier, O. Thonnard, and M. Dacier, “Mind Your
Blocks: On the Stealthiness of Malicious BGP Hijacks,”
in NDSS. The Internet Society, 2015. [Online]. Available:
http://www.internetsociety.org/events/ndss-symposium-2015
641
[7] M. Lepinski and S. Kent, “An Infrastructure to Support Secure
Internet Routing,” RFC 6480 (Informational), RFC Editor,
Fremont, CA, USA, pp. 1–24, Feb. 2012. [Online]. Available:
https://www.rfc-editor.org/rfc/rfc6480.txt
[8] R. White, “Deployment Considerations for Secure Origin BGP
(soBGP).” June 2003. [Online]. Available: http://tools.ietf.org/
html/draft-white-sobgp-bgp-deployment-01
[9] A. Cohen, Y. Gilad, A. Herzberg,
and M. Schapira,
“Jumpstarting BGP Security with Path-End Validation,” in
SIGCOMM. ACM, 2016, pp. 342–355. [Online]. Available:
http://doi.acm.org/10.1145/2934872
[10] M. Lepinski and K. Sriram, “BGPsec protocol speciﬁcation,”
September 2017, RFC8205. [Online]. Available: http://tools.
ietf.org/rfc/rfc8205.txt
[11] A. Cohen, Y. Gilad, A. Herzberg, and M. Schapira, “One hop for
rpki, one giant leap for bgp security,” in Proceedings of the 14th
ACM Workshop on Hot Topics in Networks, ser. HotNets-XIV.
New York, NY, USA: ACM, 2015, pp. 10:1–10:7. [Online].
Available: http://doi.acm.org/10.1145/2834050.2834078
[12] Y. Gilad, O. Sagga, and S. Goldberg, “Maxlength considered
harmful to the RPKI,” in CoNEXT, 2017, pp. 101–107. [Online].
Available: http://doi.acm.org/10.1145/3143361.3143363
[13] Y. Gilad, A. Cohen, A. Herzberg, M. Schapira, and H. Shulman,
“Are we there yet? on rpki’s deployment and security.” NDSS,
2017.
[14] D.
Iamartino, C. Pelsser, and R. Bush, “boer,” in PAM,
ser. Lecture Notes in Computer Science, J. Mirkovic and
Y. Liu, Eds., vol. 8995. Springer, 2015, pp. 28–40. [Online].
Available: http://dx.doi.org/10.1007/978-3-319-15509-8
[15] NIST, “RPKI Monitor,” http://rpki-monitor.antd.nist.gov/, 2015.
[16] M. W¨ahlisch, R. Schmidt, T. C. Schmidt, O. Maennel, S. Uhlig,
and G. Tyson, “Ripki: The tragic story of rpki deployment in
the web ecosystem,” in Proceedings of the 14th ACM Workshop
on Hot Topics in Networks, Philadelphia, PA, USA, November
16 - 17, 2015, J. de Oliveira, J. Smith, K. J. Argyraki, and
P. Levis, Eds. ACM, 2015, pp. 11:1–11:7. [Online]. Available:
http://dl.acm.org/citation.cfm?id=2834050
[17] J. Kloots, “RPKI Routing Policy Decision-Making: A SURFnet
Perspective,” https://labs.ripe.net/Members/jac kloots/, January
2014.
[18] R. de Boer and J. de Koning, “BGP Origin Validation (RPKI),”
Univeristy of Amsterdam, systems and network engineering
group, Tech. Rep., July 2013.
[19] D. Iamartino, “Study and Measurements of the RPKI Deploy-
ment,” 2015.
routeviews.org/.
[20] “University of Oregon Route Views Project,” http://www.
[21] A. Reuter, R. Bush,
´I. Cunha, E. Katz-Bassett, T. C.
Schmidt, and M. W¨ahlisch, “Towards a rigorous methodology
for measuring adoption of RPKI
route validation and
ﬁltering,” CoRR, vol. abs/1706.04263, 2017. [Online]. Available:
http://arxiv.org/abs/1706.04263
[22] “Routing Information Service (RIS),” https://www.ripe.net/
analyse/internet-measurements/routing-information-service-ris.
[23] “Alexa Internet,” https://www.alexa.com/.
[24] L. Blunk, M. Karir, and C. Labovitz, “Multi-Threaded
Routing Toolkit (MRT) Routing Information Export Format,”
RFC 6396 (Proposed Standard), RFC Editor, Fremont, CA,
USA, pp. 1–33, Oct. 2011.
[Online]. Available: https:
//www.rfc-editor.org/rfc/rfc6396.txt
[25] “What is RIPE Atlas?” https://atlas.ripe.net/about/.
[26] P. Gill, M. Schapira, and S. Goldberg, “Let the Market Drive
Deployment: A Strategy for Transitioning to BGP Security,”
in SIGCOMM, S. Keshav, J. Liebeherr, J. W. Byers, and J. C.
Mogul, Eds. ACM, 2011, pp. 14–25.
[27] ——, “Modeling on Quicksand: Dealing with the Scarcity of
Ground Truth in Interdomain Routing Data,” Computer Com-
munication Review, vol. 42, no. 1, pp. 40–46, 2012.
[28] S. Goldberg, M. Schapira, P. Hummon, and J. Rexford, “How
Secure are Secure Interdomain Routing Protocols?” Computer
Networks, vol. 70, pp. 260–287, 2014. [Online]. Available:
http://dx.doi.org/10.1016/j.comnet.2014.05.007