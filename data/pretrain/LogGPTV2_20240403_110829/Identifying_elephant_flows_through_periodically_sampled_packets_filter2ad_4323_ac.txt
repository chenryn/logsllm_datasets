4
y’
6
8
10
5
10
y’
15
20
2
4
y’
6
8
10
Figure 4: FPR(y(cid:1)
f = 10
−3 (top) and f = 10
) and FNR(y(cid:1)
−4 (bottom).
) for the three traces:
pled per-ﬂow packet distribution Pr [Xj = i] can be inferred
from the observation of sampled per-ﬂow packet distribu-
tion Pr [Yj = i]. Approach C utilizes the observation that
the distribution of the number of per-ﬂow packets for In-
ternet traﬃc seems to decay in an approximately power-law
fashion.
In the following, we focus on Approach C. We investigate
how Pr [Xj = i] aﬀects ˆy. First, we look into several empir-
ical distributions obtained from packet traces measured in
diﬀerent networks. We then augment our investigation with
the case of a family of theoretical Pareto distributions. We
ﬁnd, somehow to our surprise, that the calculated thresh-
olds ˆy are similar for these empirical and theoretical distri-
butions. This result suggests that a threshold obtained for
one network can be used as an approximation for other net-
works as long as their ﬂow statistics also exhibit heavy-tail
characteristics.
5.1 Empirical distributions
To supplement the IPCL trace, we used two more unidi-
rectional packet traces of Internet traﬃc. The ﬁrst one was
measured at the same location as the IPCL trace, but at
other OC-48c backbone links, i.e., those between Indianapo-
Table 3: ˆy for the three traces by calculation
ˆy (f = 10
−3)
ˆy (f = 10
−4)
trace
IPCL
IPKS
CESCA
100
10-2
]
k
>
j
X
[
r
P
10-4
10-6
13
14
15
4
4
5
β = 0.5
β = 0.75
β = 1.0
β = 1.25
β = 1.5
IPCL
IPKS
CESCA
10-8
100
101
102
k
103
104
105
Figure 5: Complementary cumulative distributions
of Xj for the Pareto distributions.
Pr [Xj > k] = 1 −(cid:4)k
lis and Kansas City [9]. We refer to this trace as the IPKS
trace6. The second one was measured at a Gigabit Ethernet
link connecting the Anella Cientiﬁca to the global Internet
via RedIRIS [10]. We refer to this trace as CESCA7. Each
link had an adequate volume of traﬃc during the measure-
ment period.
Figure 3 shows complementary cumulative distributions
i=1 Pr [Xj = i] for these three traces.
Although their distributions are diﬀerent, they all exhibit
heavy-tail behaviors and decay in an approximately power-
law fashion. Then, we use the distribution Pr [Xj = i] for
each trace to calculate FPR(y(cid:1)
) and FNR(y(cid:1)
) (see Fig. 4),
−4}, and ˆx = 104; four sub-
with N = 107, f ∈ {10
−3, 10
ﬁgures show similar tendencies of FPR(y(cid:1)
) for
all these three traces. Next, we use (5) to calculate ˆy, with
 = 0.05. Table 3 lists the calculated thresholds of identify-
ing elephant ﬂows in sampled packets. As we can see, these
thresholds (ˆy) are very similar for traces with diﬀerent per-
ﬂow packet distributions.
5.2 Theoretical distributions
) and FNR(y(cid:1)
We use the Pareto distribution as a theoretical distri-
bution, since it is appropriate for evaluating behaviors for
which the complementary cumulative distribution decays in
a power-law fashion. This distribution is often referred to as
the basis of the elephant and mice phenomenon. The Pareto
distribution is deﬁned by Pr [Xj ≤ x] = 1− (α/x)β (x ≥ α),
where α > 0 is a location parameter, and β > 0 is a shape
parameter. With the above notation, the probability density
function is deﬁned as Pr [Xj = x] = βαβ/xβ+1. Figure 5 il-
lustrates the complementary cumulative distribution of the
Pareto distributions (α ≤ x ≤ 105). Here, α = 1.0, and
β ∈ {0.5, 0.75, 1.0, 1.25, 1.5}. The empirical distributions
6We use the ﬁrst 107 packets (corresponding to about 124
seconds) in the trace IPLS-KSCY-20020814-105000-1 [9].
7We use the ﬁrst 107 packets (corresponding to about 85
seconds) in the trace 20040219-120000-a [10].
β = 0.5
β = 0.75
β = 1.0
β = 1.25
β = 1.5
1
0.8
)
’
y
(
R
P
F
0.6
0.4
0.2
0
0
1
0.8
)
’
y
(
R
P
F
0.6
0.4
0.2
0
0
1
0.8
)
’
y
(
R
N
F
0.6
0.4
0.2
0
0
1
0.8
5
10
y’
15
20
5
10
y’
15
20
)
’
y
(
R
N
F
0.6
0.4
0.2
0
0
10
5
y’
5
y’
10
Figure 6: FPR(y(cid:1)
tributions: f = 10
) and FNR(y(cid:1)
−3 (top) and f = 10
) for the Pareto dis-
−4 (bottom).
Table 4: ˆy for the Pareto distributions by calculation
ˆy (f = 10
−3)
β
0.5
0.75
1.0
1.25
1.5
ˆy (f = 10
−4)
13
13
14
14
15
4
4
4
4
5
are also plotted for comparison purpose.
−3, 10
) and FNR(y(cid:1)
For each of the above Pareto distributions, we calculate
FPR and FNR by using (3) and (4) (see Fig. 6), and ˆy by
using (5) (see Table 4). Here, N = 107, f ∈ {10
−4},
ˆx = 104, and  = 0.05. Both FPR(y(cid:1)
) show
very similar tendencies for all distributions. The calculated
thresholds (ˆy) are similar for the Pareto distributions over
a relatively wide range of β, and are similar to those for the
empirical distributions.
As shown in Fig. 5, the empirical distributions of Xj for
the three traces roughly follow Pr [Xj > x] ∼ x−β, where
β is close to 1. Other measurement-based studies have re-
ported that ﬂow statistics exhibit such characteristics [5, 8,
12, 15, 16] in many diﬀerent networks (including the Inter-
net). Therefore, we may conclude that the value of ˆy cal-
culated by using the Pareto distribution (say, with β = 1.0)
can be used as approximations for a wide range of other net-
works as long as their per-ﬂow packet statistics also follow
heavy-tail distributions.
6. CONCLUSION
In this paper, we have described how to identify elephant
ﬂows through counting periodically sampled packets. The
key is to ﬁnd the threshold of per-ﬂow packets in sampled
packets which can reliably indicate whether or not a ﬂow
is actually an elephant ﬂow in unsampled packets. We have
shown that such a threshold can be obtained based on Bayes’
theorem, with a proper trade-oﬀ of false positives and false
negatives. Moreover, we have found that for various a pri-
ori distributions, the calculated thresholds are quite simi-
lar. This observation suggests that a threshold obtained for
one network will be applicable to other networks exhibiting
similar per-ﬂow packet distributions. Although our current
scheme only focus on identifying elephant ﬂows instead of
exacting detailed ﬂow statistics, we believe that identifying
elephant ﬂows is an important step toward the goal of the
latter during network operation and traﬃc engineering.
The advantage of our approach is due to its simplicity. Pe-
riodic sampling and stateless ﬂow identiﬁcation without per-
packet processing can be easily implemented in any contem-
porary high-end PC, which is of course a very cost-eﬀective
solution.
In addition, our analytical framework quantiﬁes
the intrinsic trade-oﬀ in ﬂow identiﬁcation and can provide
insights on how to choose appropriate parameters. For ISPs
operating large-scale networks with a variety of measure-
ment equipments, these features are considered very crucial
in practice.
Acknowledgments
The authors would like to acknowledge the people of the
PMA project for making their packet traces publicly avail-
able to the networking research community. We also wish
to thank anonymous reviewers, who have provided valuable
comments on an early version of this paper.
7. REFERENCES
[1] N. Duﬃeld, C. Lund, and M. Thorup, “Charging from
Sampled Network Usage,” ACM SIGCOMM Internet
Measurement Workshop, California, November, 2001.
[2] N. Duﬃeld, C. Lund, and M. Thorup, “Properties and
Prediction of Flow Statistics from Sampled Packet Streams,”
ACM SIGCOMM Internet Measurement Workshop, Marseille,
France, November, 2002.
[3] N. Duﬃeld, C. Lund, and M. Thorup, “Estimating Flow
Distributions from Sampled Flow Statistics,” In Proceedings of
ACM SIGCOMM, pp. 325–336, August 2003.
[4] C. Estan and G. Varghese, “New Directions in Traﬃc
Measurement and Accounting,” In Proceedings of ACM
SIGCOMM, pp. 323–336, August 2002.
[5] S. Ben Fredj, T. Bonald, A. Proutiere, G. Regnie, and
J. Roberts, “Statistical bandwidth sharing: a study of
congestion at ﬂow level,” In Proceedings of ACM SIGCOMM,
pp. 111–122, August 2001.
[6] L. Golab, D. DeHaan, E. Demaine, and A. Lopez-Ortiz,
“Identifying Frequent Items in Sliding Windows over On-Line
Packet Streams,” ACM SIGCOMM Internet Measurement
Conference, Florida, October, 2003.
[7] A. Kumar, J. Xu, J. Wang, O. Spatschek, and L. Li,
“Space-Code Bloom Filter for Eﬃcient Per-Flow Traﬃc
Measurement,” In proceedings of IEEE INFOCOM, Hong
Kong, China, March 2004.
[8] T. Mori, R. Kawahara, S. Naito, and S. Goto, “On the
characteristics of Internet Traﬃc variability: Spikes and
Elephants,” In Proceedings of IEEE/IPSJ SAINT, pp. 99–106,
Tokyo, Japan, Jan 2004
[9] NLANR: Abilene-I data set,
http://pma.nlanr.net/Traces/long/ipls1.html
[10] NLANR: CESCA-I data set,
http://pma.nlanr.net/Special/cesc1.html
[11] Cisco NetFlow,
http://www.cisco.com/warp/public/732/netﬂow/index.html
[12] K. Papagiannaki, N. Taft, S. Bhattacharya, P. Thiran,
K. Salamatian, and C. Diot, “On the feasibility of identifying
elephants in internet backbone traﬃc. Sprint ATL Technical
Report TR01-ATL-110918,” Sprint Labs, November 2001.
[13] IETF Packet Sampling (psamp) Working Group,
http://www.ietf.org/html.charters/psamp-charter.html
[14] InMon sFlow Probe,
http://www.inmon.com/products/probes.php
[15] K. Thompson, G. J. Miller, and R. Wilder, “Wide-area
internet traﬃc patterns and characteristics,” IEEE Network,
vol. 11, no. 6, pp. 10–23, November/December 1997.
[16] Y. Zhang, L. Breslau, V. Paxson, and S. Shenker, “On the
Characteristics and Origins of Internet Flow Rates,” In
Proceedings of ACM SIGCOMM, pp. 309–322, August 2002.