BinaryURL 
DropZone 
francejustel.ru 
/mail/hi.jpg 
ConfigURL 
newromentthere.ru 
/123.jpg 
/g.exe 
/img/pic.php 
ConfigURL 
BinaryURL 
DropZone 
orbitmanes.ru 
/sprit.jpg 
/01.exe 
/var/hy.php 
ConfigURL 
BinaryURL 
DropZone 
reznormakro.su 
/winconf/kernl.bin 
/manage/webstat.php 
ConfigURL 
DropZone 
6 
Phishing traffic 
Table 4. Sample Fast flux domains for phishing sites and associated URL patterns. 
Domain 
Known Url path 
amazon.de.k
unde-
secure.com 
/kunden_security/MDUuMjguMTQ%3D/4161/gp/newLogin/B007HCCOD0?charset.set=UTF&IP.hilfe
=ID00320070.uberpruf28476660/ 
httpsj.org 
/ap/deutschland/kunde 
/favicon.ico 
httpss.biz 
/sicherlich/deu/kunde 
Asprox CnC traffic 
The zbot fastflux domains are also used as CnCs for the Asprox botnet. After a machine is infected via Exploit kit 
attacks or malicious spam attachments (Figure 1), it performs multiple Asprox type callbacks to a selection of the fast 
flux domains then follows with clickfraud traffic. In the Table below, we show sample domains used as CnCs (some 
are live at the moment of this writing), the associated HTTP methods and URL patterns and the Emerging Threats 
alerts they trigger. 
Table 5. Sample Fast flux CnC domains used by Asprox and associated URL patterns and ET alerts. 
ET alert 
Domain 
HTTP method 
ET 
TROJAN 
W32/Asprox.ClickFraudBot 
CnC 
Beacon 
defie-guret.su 
harm-causer.com 
joye-luck.com 
joye-luck.su 
molinaderrec.com 
pg-free.com 
vision-vaper.su 
GET /b/eve/ 
bang-power.su 
cherry-white.com 
defie-guret.su 
grade-well.com 
harm-causer.com 
joye-luck.com 
joye-luck.su 
molinaderrec.com 
oak-cured.com 
original-lot.com 
pg-free.com 
valoherusn.su 
vision-vaper.su 
GET /b/letr/ 
biobetic-new.com 
carbiginer.com 
carbon-flx.su 
come-passere.com 
dialog-pow.com 
gummiringes.com 
head-pcs.com 
history-later.su 
GET /b/shoe/ 
7 
lare-funer.com 
mitger-qaser.com 
mix-juert.com 
older-hiuwm.com 
preluner-ter.com 
unuse-bubler.com 
valoherusn.com 
zemmes-gimbl.com 
ET 
TROJAN 
W32/Asprox.ClickFraudBot 
POST 
CnC Beacon 
apple-greens.com 
bang-power.su 
cherry-white.com 
defie-guret.su 
futere-poss.com 
garanering.su 
grade-well.com 
harm-causer.com 
hefu-juder.com 
innovation-citys.com 
jogurt-jetr.com 
joye-luck.com 
joye-luck.su 
juice-from.com 
molinaderrec.com 
nanoteches.com 
oak-cured.com 
on-bend.com 
original-lot.com 
pg-free.com 
ray-green.ru 
shark-yope.su 
supra-onfert.com 
taiborucheng.com 
terminus-hls.su 
trendf-news.ru 
tundra-red.com 
valoherusn.su 
vaping-qasdir.su 
vision-vaper.su 
POST /b/opt/ 
apple-greens.com 
cherry-white.com 
defie-guret.su 
garanering.su 
grade-well.com 
harm-causer.com 
joye-luck.com 
joye-luck.su 
molinaderrec.com 
oak-cured.com 
original-lot.com 
pg-free.com 
POST /b/req/ 
8 
supra-onfert.com 
taiborucheng.com 
valoherusn.su 
vision-vaper.su 
Notice that in the case of the URL patterns: /b/eve/, /b/letr/, /b/opt/ and /b/req/, they are followed by a 12 2-byte 
hexadecimal string. For example: 
http://vision-vaper.su/b/eve/1f40f89ea1eebf47748490eb 
http://grade-well.com/b/letr/7165F757DAA94FE2CD116CC4 
http://hefu-juder.com/b/opt/17D2BCDADA720FE35C6F00F1 
http://joye-luck.com/b/req/648EEF9F6EDBDEE2E5E7F800 
Other traffic patterns 
We list observed URL patterns used for other purposes: 
Beaconing and announcing version, make, OS 
GET /1/?uid=17428742&ver=1.14&mk=bb3b62&os=WinXP&rs=adm&c=1&rq=0 
with several occurring OS versions: 
os=S2000 
os=Win07 
os=Win_V 
os=WinXP 
os=Win08 
Getting binaries and configs 
azg.su, GET /coivze7aip/modules/bot.exe 
tundra-tennes.com, GET /infodata/soft32.dll 
tundra-tennes.com, GET /info-data/soft32.dll 
bee-pass.com, GET /info/soft32.dll 
quarante-ml.com, GET /nivoslider/jquery/ 
quarante-ml.com, GET /nivoslider98.45/ajax/ 
quarante-ml.com, GET /nivoslider98.45/jquery/ 
tundra-tennes.com, GET /nivoslider/ajax/ 
Pony panel hosted on zbot proxy network 
While investigating the zbot fast flux domains, we came across one that was hosting a panel for the Pony malware 
(botnet). As Figure 2 shows, the panel was hosted on the domain marmedladkos.com: 
9 
Figure 2. Pony panel on marmedladkos.com. 
Pony 1.9 was leaked in late 2012 to Trojan Forge. The malware is an infostealer identified by AV vendors as 
Win32/Fareit. It consists of a botnet controller via a panel, has features for user management, logging and statistics 
via a database. 
Figure 3. Pony features as advertised on Forums. 
10 
Figure 4. Detection of Pony by AV vendors as advertised in Forums. 
The Pony payload is commonly delivered via Exploit kit attacks or attachments in spam emails. In the table below, we 
show a few folders on the panel site and their functionality. It is notable that the character set cp1251 characteristic of 
Cyrillic scripts is used everywhere on the site and in config.php, the variable date_default_timezone_set is set to 
(‘Europe/Moscow’) which would be an indication about the origin country of the authors or users of the panel. 
Table 6. Folders on panel site and functionalities. 
Path on site 
Function 
p/Panel.zip 
controlling php scripts 
p/includes/design/images/modules/* 
images for each zeus plugin supported/tracked (Figure 
ww) 
p/includes/password_modules.php 
contains array with all software it tries to steal 
credentials for (Figure ee) 
p/includes/database.php 
contains db schema and accessors 
11 
Figure 5. Images for supported plugins. 
Figure 6. List of applications stored in the Panel db of which Pony steals the passwords. 
12 
Figure 7. db schema in database.php. 
Furthermore, we searched on Google for certain strings from the Pony panel website and we found several more 
sites with open panels with some sites hosting other malware payload. One Example of such site is shown in the 
figure below:  
Figure 8. Open panel with malware payload. 
The file DC.exe is an Andromeda malware sample as the below VT report shows: 
13 
Figure 9. VirusTotal’s detection results of the sample discovered on the panel site. 
In the table below, we show some of the open Pony panels we discovered from the initial one. These are not hosted 
on the zbot fast flux domains though. 
Table 7. Additional discovered panels. 
Open Panels 
epvpcash.net16.net/Panel/temp/ 
hgfhgfhgfhfg.net/pony/temp/ 
http://pantamati.com/dream/Panel/temp/ 
http://pantamati.com/wall/Panel/temp/ 
mastermetr.ru/steal/Panel/temp/ 
microsoft.blg.lt/q/temp/ 
santeol.su/p/temp/ 
terra-araucania.cl/pooo/temp/ 
thinswares.com/panel/temp/ 
www.broomeron.com/pn2/temp/ 
www.kimclo.com/cli/temp/ 
www.sumdfase2.net/adm/temp/ 
www.tripplem2.com/images/money/temp/ 
14 
Top Level Domain distribution of the zbot fast flux domains 
In the Figure below, we show the TLD distribution of a 900+ sample of zbot fast flux CnC domains. It is clear that .su 
and .ru are the most abused ccTLDs followed by the generic .com, .net. 
Figure 10. TLD distribution of zbot fast flux CnC domains. 
15 
Proxy network country distribution 
We take a sample of 170,000+ IPs of the zbot proxy network and show in the figures below the top hosting countries. 
We see a high presence of infected machines acting as hosting bots in Russia, Ukraine and Turkey. 
Figure 11. Top hosting countries of zbot proxy network IPs. 
Figure 12. Country distribution of zbot proxy network IPs on world map. 
16 
Country distribution of clients beaconing to CnCs 
We collected the client IPs that looked up the fast flux CnC domains for a period of 24 hours. The figure below shows 
the country distribution. A high volume of lookups comes from the US, which can be caused by targeted US victims. 
Figure 13. Top countries of client IPs looking up zbot fast flux domains for 24 hours. 
Figure 14. Country distribution of client IPs looking up zbot fast flux domains. 
17 
CnC domains and related malware samples 
We took a sample of 337 fast flux domains hosted on the zbot proxy network and identified 208 different samples 
(unique sha256) that have communicated with the CnCs. The notable top observed samples communicating with the 
CnC domains are: 
Trojan[Spy]/Win32.Zbot 
TrojanDownloader:Win32/Upatre 
Notice that Upatre has served as a downloader for Zeus GameOver and has been recorded as being sent as 
attachment in spam emails delivered by the Cutwail botnet. 
Part 2: Catching Malware IP-style 
Classical reputation systems used for network-level threat detection assign scores to IPs, BGP prefixes and ASNs 
based on counting the volume of hosted malicious domains or IPs. In this study, our goal is to assess malicious IP 
ranges in certain ASNs from a new perspective. We look beyond the simple counting of the number of bad domains 
and IPs hosted on prefixes of an ASN, by exploring the topology of the AS graph, and looking at a smaller granularity 
than the BGP prefix (sub-allocated ranges within BGP prefixes).  We will also present a unique approach for finding 
similar prefixes and autonomous systems that are related to the network hosting malicious software. This will help 
identify more networks and hosts that are already high risk or will be in the near future. 
Previous research has been conducted on exploring malicious ASNs. For example, in [5], B. Stone-Gross et al. 
assign scores to rogue ASNs based on the amount of events involving hosts engaged in phishing, spamming, hosting 
drive-by download malware, or botnet traffic. In [6] and [7], the authors use visualization to track security incidents 
and malware events drawn from blacklist databases, and [8] explores ASNs providing transit for malware ASNs. 
ASN GRAPH 
An Autonomous System Number (ASN) identifies every globally routable network on the Internet. An Autonomous 
System (AS) represents a collection of IPv4 and IPv6 network prefixes administered by the same entity and sharing a 