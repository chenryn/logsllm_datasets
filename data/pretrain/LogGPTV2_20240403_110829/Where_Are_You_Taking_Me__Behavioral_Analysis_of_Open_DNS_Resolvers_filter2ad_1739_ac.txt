Answer (AA) means that the server responding to the DNS
query is the authoritative name server for the given domain.
In our probing, we sent DNS queries for all IPv4 addresses,
and we were the only owner for the SLD, ucfsealresearch.net.
Therefore,
the
it
AA bit of all R2 is set
to 0 except one response from
our authoritative name server
itself. However, as shown
in Table V, 381,124 R2 packets came back with the AA bit
of 1, which is about 2.29% of all responses in 2013. Among
them, 231,368 responses contained dns_answer, of which
78,279 had incorrect results. The ratio of the false answers to
total answers with the AA bit of 1 is about 20.539%, which
is appropriate to assume that
is signiﬁcantly high compared to 0.372% when the AA is 0.
In 2018, we received 249,193 R2 responses with AA of 1.
Among them, 119,147 packets had dns_answer and 94,052
had incorrect information (79%), which is more than twice the
rate of 2013, while the rate for AA bit of 0 is about 0.621%.
The number of responses with AA bit of 1 is less than 4%
of the total answers, while incorrect answer with AA bit of 1
account for about 84.661% of all incorrect packets.
Comparing the results of 2013 and 2018, we can see that
the R2 with AA bit of 0 is greatly reduced (from 16 million
to 6 million). In the case of AA bit of 1, the number of
packets decreased from about 381k to 249k, which is about
61%. Nevertheless, the value of 249k is still abnormally higher
than the expected value of 1. As interesting as the ﬁndings of
the RA bit, however, the number of responses with inaccurate
information was similar or even higher, which results in a
signiﬁcantly high error rate in 2018, which more than doubled
from 2013.
As in the previous analysis of the RA ﬂag, the analysis of
the AA ﬂag also shows that a large number of open resolvers
do not work in a reliable manner.
3) Response Code: The response code (rcode) of the DNS
response provides metadata about the outcome of the reso-
lution. The rcode, which usually has a value from 0 to 15,
is set to 0 for NoError, 1 for FormErr, 2 for ServFail, 3 for
NXDomain, 4 for NotImp, 5 for Refused, 6 for YXDomain,
7 for YXRRSet, 8 for NXRRSet, and 9 for NotAuth [24]. All
but 0 (NoError) indicate that the resolution was not successful.
Table VI shows the distribution of rcode in the collected
R2. As expected, most responses containing dns_answer
ﬁeld contained an rcode of 0, while most responses had a
nonzero rcode without dns_answer. Except for this general
tendency, however, we found some R2 packets with abnormal
combinations: 14,005 contained a nonzero (error) rcode de-
spite having dns_answer ﬁeld; 12,723 for ServFail, 10 for
NXDomain, and 1,272 for Refused. Conversely, 1,198,772 R2
packets without the dns_answer ﬁeld had rcode of NoError.
In 2018, we also found 2,715 R2 packets with a nonzero
rcode, even with dns_answer ﬁeld. In particular, 23 R2 s
have rcode of 1, 2,489 have 2, 10 have 3, and 193 have 5;
377,803 responses with rcode of 0 had no dns_answer ﬁeld.
the number
of packets with most response codes decreased (NoError,
FormErr, ServFail, NXDomain, and Refused). However, we
also can see that the number of responses with the rcode of 1
(NotImp) and 9 (Not Auth) signiﬁcantly increased, while those
with the rcode of 6 (YXDomain) and 7 (YXRRSet) remained
at a similar level.
In analyzing response code, we found that
4) DNS Response with empty dns question: We brieﬂy
describe the analysis of 494 packets without dns_question
ﬁeld in 2018; excluded from the previous analysis.
DNS Answer Presence. Among the 494 packets, 19 R2
packets have the dns_answer ﬁeld, which is about 3.8%.
However, none of the 19 packets includes the correct answer.
There are 14 packets containing a private network address in
dns_answer (13 for 192.168.0.0/16, 1 for 10.0.0.0/8) and
498
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:55:40 UTC from IEEE Xplore.  Restrictions apply. 
THE STATISTICS OF THE dns_answer FIELD AND THE VALUE OF RA BIT IN R2. NOTICE THAT RA0 AND RA1 CORRESPOND TO THE VALUE OF RA FLAG
TABLE IV
BIT.
W/O
RA0
4,147,838
RA1
719,403
2013
W
WCorr
WIncorr
241,950
166,108
75,842
11,550,932
11,505,481
45,451
Total
Err(%)
W/O
4,389,788
31.346
3,434,415
12,270,335
0.393
207,694
2018
W
WCorr
WIncorr
69,166
3,994
65,172
2,794,489
2,748,568
45,921
Total
Err(%)
3,503,581
94.225
3,002,183
1.643
THE STATISTICS OF THE dns_answer FIELD AND THE VALUE OF AA BIT IN R2. NOTICE THAT AA0 AND AA1 CORRESPOND TO THE VALUE OF AA FLAG
TABLE V
BIT.
W/O
AA0
4,717,485
AA1
149,756
2013
W
WCorr
WIncorr
11,561,514
11,518,500
43,014
231,368
153,089
78,279
Total
Err(%)
W/O
16,278,999
0.372
3,512,053
381,124
20.539
130,046
2018
W
WCorr
WIncorr
2,744,518
2,727,477
17,041
119,147
25,095
94,052
Total
Err(%)
6,256,571
0.621
249,193
78.938
THE RCODE OF THE DNS REPONSES. Notice that each column corresponds to rcode of 0 to 7, and 9. The rcode of 8 (NXRRSet) is omitted due to the
TABLE VI
absence in our dataset.
2013
2018
NoError
11,780,575
1,198,772
12,979,347
2,860,940
377,803
3,238,743
FormErr
0
453
453
23
233
256
ServFail
12,723
354,176
366,899
2,489
200,320
202,809
W
W/O
Total
W
W/O
Total
NXDomain
NotImp
10
145,724
145,734
10
48,830
48,840
0
38
38
0
605
605
Refused
1,272
3,168,053
3,169,325
193
2,934,269
2,934,462
YXDomain
YXRRSet
Not Auth
0
0
0
0
1
1
0
2
2
0
2
2
0
11
11
0
80,032
80,032
one with incorrect format (e.g., 0000). Moreover, 4 R2 packets
had addresses which could not be found in Whois.
RA Flag. The 184 responses with RA bit of 1 were found.
The 19 responses with incorrect IP address above had a RA
bit of 1, and the other 165 packets did not include the resulted
address even if they had an RA of 1. All the 303 packets with
RA set to 0 did not contain dns_answer.
AA Flag. With AA ﬂag, only two responses out of 494
had an AA bit of 1, and the rest did not. Only one of two
responses contained dns_answer, although incorrect. The
19 R2 packets with the answer ﬁeld had the AA bit set to 0.
Response Code. Among the R2 packets, 26 responses had
an rcode of 0 (NoError), 1 response of 1 (FormErr), 301
responses of 2 (ServFail), 2 responses of 3 (NXDomain), and
163 responses of 5 (Refused). We can see that the failure and
refusal are major reasons for the blank dns_question.
C. Incorrect DNS Answers
Here we describe further analysis on the incorrect IP ad-
dresses included in R2 packets based on the result observed
in 2013 and 2018. As shown in Table III, we notice that
the wrong answer was provided in 110,093 packets out of
6,506,258 R2 packets in 2018, while 121,293 packets out of
16,660,123 provided the wrond answer in 2013.
Table VII shows a summary of the incorrect answers
collected through the measurement. We categorized 121,293
and 111,093 R2 packets in 2013 and 2018 with the wrong
result into three types: IP address, URL, string, according to
dns_answer. As a result, we found that 112,270 in 2013 and
110,790 in 2018 of the R2 packets had incorrect IP addresses,
while 249 and 231 R2 packets had incorrect URLs. We also
found that 10 and 72 responses include the abnormal strings
such as wild, ff, OK, 04b400000000, etc.
Caveats. As mentioned earlier, we used a C based system in
the process of collecting dataset in 2013 and stored the results
in a .pcap ﬁle. While parsing the packets using the libpcap
based code, we found in some packets that dns_answer was
not decoded appropriately. It appears that the open resolver
incorrectly ﬁlled some values in the process of creating the
response packet. Among the total 16 million of R2 packets in
2013, 8,764 packets were not decoded correctly, corresponding
to about 0.05% of total number.
1) Top 10 Analysis: Table VIII shows the top 10 IP
addresses with the most occurrences in R2 packets in
499
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:55:40 UTC from IEEE Xplore.  Restrictions apply. 
TABLE VII
THE SUMMARY OF INCORRECT ANSWERS. NOTICE THAT #R2 MEANS THE
NUMBER OF R2 PACKETS THAT INCLUDE THE ANSWER IN EACH FORM,
AND #u MEANS THE NUMBER OF UNIQUE VALUES APPEARING IN #R2.
TABLE VIII
TOP 10 IP ADDRESSES INCLUDED IN INCORRECT DNS RESPONSES IN
2018. ‘REPORTS’ IS WHETHER A SUSPICIOUS REPORT WAS FOUND WHEN
QUERYING THE ADDRESS USING CYMON API.
Form
IP
URL
string
N/A
Total
2013
2018
#R2
112,270
#u
28,443
#R2
110,790
#u
Example
15,022
216.194.64.193
80
29
-
u.dcoin.co
wild, OK, ff
249
10
8,764
121,293
175
57
-
231
72
-
28,675
111,093
15,131
-
2018. The most frequently observed IP address in incorrect
dns_answer was found in 23,692 responses, which is a do-
main and web hosting related company. The summed number
of top 10 appearances is 50,669, which is about half the total
number of incorrect R2 responses (111,093).
By examining the top 10 addresses, we found that four
of them are private networks that belonged to 10.0.0.0/8,
172.16.0.0/12, and 192.168.0.0/16. However, in the case of the