title:Measuring Video QoE from Encrypted Traffic
author:Giorgos Dimopoulos and
Ilias Leontiadis and
Pere Barlet-Ros and
Konstantina Papagiannaki
Measuring Video QoE from Encrypted Trafﬁc
Giorgos Dimopoulos
UPC BarcelonaTech
PI:EMAIL
Ilias Leontiadis
Telefonica Research
PI:EMAIL
Pere Barlet-Ros
UPC BarcelonaTech
PI:EMAIL
Konstantina
Papagiannaki
Telefonica Research
PI:EMAIL
ABSTRACT
Tracking and maintaining satisfactory QoE for video
streaming services is becoming a greater challenge for
mobile network operators than ever before. Download-
ing and watching video content on mobile devices is
currently a growing trend among users, that is caus-
ing a demand for higher bandwidth and better provi-
sioning throughout the network infrastructure. At the
same time, popular demand for privacy has led many
online streaming services to adopt end-to-end encryp-
tion, leaving providers with only a handful of indicators
for identifying QoE issues.
In order to address these challenges, we propose a
novel methodology for detecting video streaming QoE
issues from encrypted traﬃc. We develop predictive
models for detecting diﬀerent levels of QoE degrada-
tion that is caused by three key inﬂuence factors, i.e.
stalling, the average video quality and the quality vari-
ations. The models are then evaluated on the produc-
tion network of a large scale mobile operator, where we
show that despite encryption our methodology is able
to accurately detect QoE problems with 72%-92% ac-
curacy, while even higher performance is achieved when
dealing with cleartext traﬃc.
1.
INTRODUCTION
Mobile video will increase 11-fold by 2020, account-
ing for 75% percent of total mobile data traﬃc [1]. Such
rapid growth asserts signiﬁcant pressure to mobile op-
erators who have to radically rethink and optimize their
network.
Permission to make digital or hard copies of all or part of this work for personal
or classroom use is granted without fee provided that copies are not made or
distributed for proﬁt or commercial advantage and that copies bear this notice
and the full citation on the ﬁrst page. Copyrights for components of this work
owned by others than ACM must be honored. Abstracting with credit is per-
mitted. To copy otherwise, or republish, to post on servers or to redistribute to
lists, requires prior speciﬁc permission and/or a fee. Request permissions from
permissions@acm.org.
IMC ’16, November 14–16, Santa Monica, CA, USA.
c(cid:13) 2016 ACM. ISBN 978-1-4503-4526-2/16/11. . . $15.00
DOI: http://dx.doi.org/10.1145/2987443.2987459
To perform such optimizations and capacity planning,
operators have to deeply understand and monitor the
oﬀered Quality of Experience (QoE) on video delivery.
Currently, most operators have made signiﬁcant ef-
forts to facilitate the delivery of media-rich content us-
ing techniques such as caching, transcoding, compres-
sion and radio resource allocation across users.
At the same time, a signiﬁcant number of major In-
ternet services have begun to encrypt their traﬃc. Cur-
rently more than 60% of mobile traﬃc is encrypted, a
number that is rapidly rising [2]. Popular video providers
such as YouTube, Netﬂix and Hulu now encrypt a large
part of their video content and the trend indicates that
most of video traﬃc will be encrypted soon [3].
While encryption of video content ensures the users’
privacy, it signiﬁcantly impacts the ability of operators
to monitor or optimize their network [4]. Practically,
with encrypted traﬃc network operators cannot fulﬁll
essential tasks such as to inspect, protect, prioritize,
optimize, compress or balance traﬃc eﬀectively.
In this paper we present a framework that is able to
extract key QoE metrics such as i) stall detection, ii)
average representation (resolution), and iii) representa-
tion ﬂuctuations in encrypted traﬃc. More speciﬁcally,
our contributions are the following:
• We analyze more than 390,000 unique non-encrypted
video sessions collected by a web proxy that is de-
ployed on the cellular network of a large provider
with more than 10M customers in order to extract
insights about video delivery mechanisms and QoE
issues.
• We use the insights and the ground truth from
the non-encrypted traﬃc to build a uniﬁed QoE
measurement method for both adaptive and tradi-
tional video streaming over HTTP.
• We then validate our work on encrypted traﬃc
collected from the same network. First we com-
pare the similarities and the diﬀerences to the non-
encrypted traﬃc delivery. Furthermore, we setup
controlled experiments to verify the accuracy of
513the developed model. We demonstrate that the
models we developed can identify quality issues
from unencrypted data with accuracies between
78% and 93.5% and from encrypted traﬃc with
accuracies between 76% and 91.8%.
• We provide important insights about the informa-
tion that can be extracted from encrypted traﬃc.
Our results indicate that i) passive measurements
from a single vantage point are enough to accu-
rately detect the key factors that aﬀect the users’
experience ii) we discuss on the features that are
the most signiﬁcant for detecting each particular
problem iii) we demonstrate that client instrumen-
tation is not required.
2. BACKGROUND AND MOTIVATION
2.1 Video Streaming Background
For many content providers HTTP has become the
preferred protocol for video delivery over the last few
years. HTTP streaming combines advantages such as
ﬁrewall pass-through and easy network address trans-
lation, but also the beneﬁts of TCP, i.e.
congestion
control mechanisms and reliable packet delivery.
Traditional HTTP Video Streaming
In traditional HTTP video streaming, the video is down-
loaded as a single continuous ﬁle which represents a
single quality setting. Moreover, video buﬀering is em-
ployed as an additional measure to compensate for jitter
and short-term bandwidth variations.
Typically, each video session can be divided into two
buﬀering phases, i.e. the start-up phase and the steady
state [5]. During the start-up phase the player will
download the ﬁrst part of the video as fast as possi-
ble to quickly ﬁll the buﬀer and minimize the initial
delay before the playback begins.
Once the buﬀer has been ﬁlled up to a speciﬁc thresh-
old and the playback has started, the video session goes
into the steady state. This phase is characterized by
ON-OFF cycles, also referred to as pacing, where the
download is paused as soon as the buﬀer has been ﬁlled
and resumes when it is reaching depletion.
HTTP Adaptive Streaming (HAS)
In contrast to traditional streaming, HAS videos are
split on the server in multiple segments, each one cor-
responding to a few seconds of playback time. Each
segment is encoded in a range of diﬀerent quality pro-
ﬁles which are deﬁned by the content provider.
Instead of requesting the entire video, the player per-
forms HTTP requests to fetch consecutive segments.
The quality proﬁle of the next segment is determined
as a function of the throughput with which the previ-
ous segment was downloaded and the available seconds
of playback in the buﬀer. In this way, the representa-
tion of the video can change dynamically to adapt to
changes in the network and minimize stalls.
2.2 Factors that Affect Video QoE
Initial Delay
The initial delay refers to the time spent from the mo-
ment the user requests the video until the playback be-
gins. This delay has two components, the network de-
lay and the initial buﬀering delay. The former can be
attributed to factors such as network latency, longer
server response times, DNS lookups and/or CDN redi-
rections. The later is caused by the time required to
perform the initial ﬁll of the buﬀer with suﬃcient video
data to allow a smooth playback.
Both Mok et al. [6] and Etoh et al. [7] agree that this
factor has the lowest impact on the QoE as users tend
to be more tolerant to longer initial delays than other
impairments such as stalls or quality changes.
Stalls
Whenever the network throughput is not suﬃcient for
the content to be downloaded faster than the rate that
it is consumed, the buﬀer is depleted and the playback
is forced to pause until more data are downloaded and
the buﬀer is ﬁlled again.
Hoßfeld et al. [8] showed that not only the frequency
but also the duration of the playback stalls which occur
due to buﬀer outages, have a high correlation with poor
QoE. Speciﬁcally, the authors conclude that a video
with 2 stalls of 3 seconds duration each, will lead to
signiﬁcantly lower Mean Opinion Score (MOS).
Moreover, Mok et al.
[9] found that the rebuﬀering
frequency has the highest impact on QoE and that a
medium rebuﬀering frequency can result in a MOS lower
by 2 points.
In this work, we measure the stalls using the Rebuﬀer-
ing Ratio which is expressed as the time spent stalling
over the total duration of the video session.
Average Representation Quality
The average quality can be applied only to HAS video
sessions, since only in these cases quality representation
changes may occur. It is calculated as the average of all
the individual qualities of the segments which belong to
a video session.
Multiple related works have shown a high correlation
between the video representation quality and the user’s
QoE. In one of these studies [10], the subjective exper-
iments performed in mobile networks have shown that
video streams with higher quality representations are
linked to better overall QoE.
Representation Quality Variation
Another factor that aﬀects the QoE of adaptive video
streaming, is the changes in quality variation. The vari-
ation in this case has two dimensions, the frequency of
the changes and their amplitude. The frequency is the
absolute number of changes that occurred in a video ses-
514sion, while the amplitude corresponds to the diﬀerence
in magnitude between two consecutive qualities.
In [11], the authors investigate how the representa-
tion switching amplitude and the switching frequency
aﬀect the QoE. Their results show that the switching
amplitude has a very high impact on the user experi-
ence.
2.3 Problem Statement
Adaptive streaming and encryption are nowadays the
default technologies used by the majority of the popu-
lar content providers. The widespread adoption of these
new technologies has given rise to a new set of challenges
for identifying video QoE issues and has rendered pre-
vious solutions obsolete.
Deep Packet Inspection (DPI) solutions for extracting
quality metrics, such as the video resolution and stall
characteristics [12], [13], do not work anymore with en-
crypted traﬃc. Moreover, adaptive quality switching
has introduced new factors that aﬀect the user’s expe-
rience, i.e. quality switching amplitude and frequency.
However, these factors were not included in previous
models for video QoE.
These changes in video streaming technologies, have
caused a high demand, not only by network operators
but also the by research community, for updated tools
and methods for detecting and quantifying quality is-
sues.
Towards this end, this work aims to provide new
methods for assessing the diﬀerent types of impairments
that aﬀect the users’ QoE from encrypted traﬃc.
2.4 Challenges
Although many services have already made the mi-
gration towards adaptive streaming, their platforms con-
tinue to maintain backward compatibility with tradi-
tional static streaming. Therefore, one of the main
challenges in this work, is to provide a solution which
will be compatible with current but also previous video
streaming technologies.
Moreover, with end-to-end encryption enabled, a great
part of the metrics that were previously available in the
network traﬃc for detecting QoE issues is now becom-
ing inaccessible. For this reason, one of our challenges
is to identify the right metrics from the limited amount
of information that is provided by encrypted traﬃc and
build the models to detect quality impairments. In or-
der to accomplish that, we need to reverse engineer the
video services and rely on machine learning and time
series analysis.
Finally, in order to preserve the user’s privacy but at
the same to make our solution as generalizable as pos-
sible, we focus on developing a methodology that will
be capable of detecting problems from network traﬃc
alone and will not depend on the instrumentation of
devices or video players and therefore it can be easily
deployed by operators.
3. DATASET
The set which is presented in this section is con-
structed from unencrypted data that contains the ground
truth for the QoE impairments of each video session.
This information is then used to create the predictive
models for identifying each impairment type. We then
move to a set of encrypted data to validate the previ-
ously constructed models using controlled experiments.
3.1 Weblogs
The data is collected from a web proxy that is de-
ployed on the cellular network of a large European provider.
The proxy is capable of registering all unencrypted HTTP
traﬃc including IP-port tuples, URI’s, object sizes, trans-
action times, request time-stamps and more. Moreover,
each log is annotated with a set of transport layer per-
formance metrics, i.e. bandwidth-delay product (BDP),
bytes-in-ﬂight (BIF), packet loss, packet retransmissions
and RTT. The BDP is equal to the link’s capacity di-
vided by its round-trip delay and represents the max-
imum amount of bytes that can be transferred by the
link at any given time.
The dataset is created from YouTube traﬃc weblogs
which are collected over a period of 45 days spanning
from February to April 2016. From all the HTTP traﬃc
that is generated by the service, we keep the weblogs
that correspond to video and audio segment downloads
and the signalling exchanged between the video player
and the service during playback.
All the data is anonymized before the extraction by
removing all private information such as user agents,
subscriber and handset identiﬁers, MAC and IP ad-
dresses and so on. The only identiﬁer which is pre-
served is the unique 16-character video session ID which
is generated by YouTube. This parameter is described
in more detail in Section 3.2.
We ﬁnd that YouTube is the most suitable candidate
among the currently popular video streaming services
for developing and evaluating our methodology. The
main reasons for this are i) the service’s huge popular-
ity which allows the generation of a very rich dataset
in a short time window, ii) the diversity of the pro-
vided content in terms of video formats, qualities and
durations, iii) its popularity among mobile users and
iv) the adoption of modern technologies i.e. Dynamic
Adaptive Streaming over HTTP (DASH), HTML-based
video playback and pacing.
Moreover, most of the popular video sharing services
are currently following YouTube’s streaming paradigm,
adopting adaptive streaming, a variety of supported
codecs and HTML-based players.
Note that although Google has in the recent years de-
ployed HTTPS for all of its services including YouTube,
we can still observe signiﬁcant amount of video sessions
in cleartext HTTP in our dataset. This is attributed to
the fact that many users use legacy devices or players
515that either do not support TLS encryption or do not