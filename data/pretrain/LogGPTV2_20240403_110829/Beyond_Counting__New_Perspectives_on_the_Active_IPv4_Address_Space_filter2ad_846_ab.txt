.
4
0
.
6
0
.
8
0
.
0
1
.
(a) Visibility of IPv4 addresses, blocks, and networks.
unknown
server/router
server
router
IPs
(N=77m)
/24s
(N=495k)
BGP prefixes
(N=55k)
ASes
(N=2k)
0
0
.
2
0
.
4
0
.
6
0
.
8
0
.
0
1
.
(b) Classiﬁcation of IP addresses visible only in ICMP.
Figure 2: Visibility into the IPv4 address space of the
CDN compared with active measurements (Oct. 2015).
behind NAT gateways [32] and ﬁrewalls that do not permit
replies to external requests via ICMP or to hosts that respond
only intermittently. While this pitfall is well-known [13,15],
we are not aware of any prior studies that quantify this effect
at large scale. This incongruity is less pronounced when ag-
gregating the address space to /24 preﬁxes and ASes.4 For
routed preﬁxes and ASes, the number of (in)visible units is
comparable for both methods, with ICMP outnumbering the
CDN for the case of preﬁxes. Thus, measuring address space
activity on a per-preﬁx or even per-AS level, active measure-
ments provide a signiﬁcant coverage. On the per-IP level,
however, active measurements are insufﬁcient. We acknowl-
edge that there is a bias in favor of the CDN logs with respect
to WWW clients since we compare an entire month worth
of CDN logs against 8 snapshots of ICMP scans, which will,
naturally, not capture hosts that are active for only short pe-
riods of time.
3.3 Other Activity
Despite the fact that much WWW content is hosted on the
CDN platform and all the successful connections reported,
our dataset has at least two limitations: (i) the platform typi-
cally does not receive requests from Internet “infrastructure”
such as routers and servers (though some routers and servers
do obtain software updates from the WWW, and some servers
obtain content from the WWW to, in turn, complete requests
from their clients) and (ii) an IP may be assigned to a user
who did not interact with the CDN platform. To assess these,
we next compare the portion of IPs that do reply to an ICMP
request but are not present in our CDN dataset, i.e., the red
bars on the right in Figure 2(a). While this is roughly only
4Here, we count a preﬁx/AS as active if we see activity from
at least one IP address within the respective preﬁx/AS.
8% of the IPv4 addresses in the combined CDN/ICMP dataset,
we are interested in examining them further.
Figure 2(b) shows a classiﬁcation of these IP addresses,
preﬁxes, and ASes. Here, we use additional data to identify
servers and router infrastructure. To identify servers, we rely
on additional data from the ZMap project: IP addresses that
replied to server connection requests using HTTP(S), SMTP,
IMAP(S) or POP3(S). To identify router IP addresses, we
use one month worth of the Ark [8] dataset and extracted all
router IP addresses that appeared on any of the traceroutes
(N=490M), i.e., they replied with an ICMP TTL Exceeded
error. Close to half of the addresses that did not connect to
the CDN, indeed, can be attributed to server or infrastructure
IP addresses. This fraction increases when aggregating to
preﬁxes and ASes. We also note, however, that about half of
these IP addresses did not show any server or infrastructure
activity. These IP addresses might be (a) serving infrastruc-
ture that is not present in the Ark dataset, or infrastructure
running other protocols than those probed by ZMap, or (b)
practically unused IP addresses, or (c) active IP addresses
that simply do not connect to the CDN.
3.4 Geographical View
To gauge the geographic coverage of our dataset, as well
as how it compares to active probing techniques regionally,
we next dissect our dataset into geographic regions and coun-
tries. To accomplish this, we use allocation data provided by
the RIRs [25] to assign regions and countries to each IP ad-
dress.5 Figure 3(a) shows for each RIR the number of IP ad-
dresses that were visible both in the CDN dataset as well as
responded to ICMP (bottom red bars), the number of IP ad-
dresses that were only visible in the CDN logs (middle blue
bars), as well as those IP addresses that were invisible in our
logs, but appeared in ICMP scanning campaigns (green bars
on top). We observe that the CDN logs provide substantial
additional visibility in all regions. When put in relation to
the total number of active IP addresses per region, this effect
is particularly pronounced in the African region, where the
CDN logs increase the number of visible active IP addresses
by more than 150%.
In Figure 3(b), we show the partition of addresses for the
top countries in terms of the number of addresses seen in
the CDN logs and the ICMP scans. In addition, we annotate
each country with its rank of ﬁxed broadband and cellular
subscribers, based on ITU data [19]. Here, we see that the
top countries ranked by broadband subscribers are also the
top countries visible in the CDN logs. Thus, the coverage of
our dataset largely agrees with ITU estimates on global Inter-
net subscribers. This effect is much less-pronounced when
ranking countries per cellular subscribers, perhaps because
most cellular networks deploy Carrier-Grade NAT [32], blur-
ring the relationship of subscribers to IP addresses. Sec-
5We acknowledge that the exact geographic location of an
IP address does not necessarily correspond to the country
where the IP address was registered. We chose this dataset
because it is publicly available, and we believe that this data
is sufﬁcient to highlight regional characteristics for the pur-
pose of this study.
M
0
0
3
M
0
0
2
M
0
0
1
0
s
e
s
s
e
r
d
d
a
P
I
only ICMP
only CDN
CDN & ICMP
RIPE
ARIN
AFRINIC
(a) Visibility of IPv4 addresses grouped by RIR.
200M
LACNIC
APNIC
only ICMP
only CDN
CDN & ICMP
s
e
s
s
e
r
d
d
a
P
I
150M
100M
50M
0
broadband:
cellular:
US CN JP BR DE KR GB FR RU IT
12
2
3
16
4
14
9
25
8
19
5
22
1
1
3
7
7
5
6
6
IN
10
2
(b) Top countries, annotated with their rank of broad-
band and cellular subscribers (ITU, 2015).
Figure 3: IP address activity by geographic region.
ondly, we also see that the fraction of ICMP-responding IP
addresses varies heavily per country. In China, for example,
we ﬁnd that close to 80% of the IP addresses do respond to
ICMP requests, whereas in Japan only about 25% of the IP
addresses reply to ICMP requests. An observation to keep
in mind when, e.g., using active measurement techniques to
reason about Internet penetration or address space utilization
in speciﬁc parts of the world.
4. MACROSCOPIC VIEW OF ACTIVITY
To bootstrap our analysis, we study IPv4 address activity
on a broad scale in this section. In particular we focus on
how many addresses our vantage point observes as well as
how consistent the set of active IPs is over time. Then, we fo-
cus on spatial properties of the observed dynamics and com-
pare our observations with what is visible from the global
routing table.
4.1 Volatility of Address Activity
To assess address activity over time, we show in Figure 4(a)
the daily number of unique IPv4 addresses that contact the
CDN over the course of 16 weeks. We observe about 650M
unique active IPv4 addresses on a daily basis, and less on
weekend days. Although Figure 4(a) shows a relatively con-
stant number of active IPv4 addresses, the set of addresses
can vary. To capture changes in the population of active ad-
dresses, we deﬁne an up event if an address is not seen in a
given window of time, e.g., a day or 7 days, but then is seen
in the subsequent window. Likewise a down event occurs if
an address is seen in a given window of time, but not seen in
a subsequent window. Figure 4(a) shows an average of 55M
daily up events, likewise for down events. Hence, each day
●
●●●●
●●●●●
●●●●
●●●●●
●●●●●
●●●●●
●●●●●
●●●●●●●
●●●●●
●●●●●
●●●●●
●●●●
●●●●●
●
●●●●●
●●●●●
●
●
●●
●●●●●
●
●●
●●
●●
●●
●
●●
●●
●●
●
●●
●●
●●
●●
●●
●
active IPv4 addresses
up events
down events
s
e
s
s
e
r
d
d
a
4
v
P
I
e
u
q
n
u
i
M
0
0
6
M
0
0
4
M
0
0
2
0
0
14
28
42
56
70
84
98 112
days from 2015−08−17 to 2015−12−06
(a) Daily active IPv4 addresses and
up/down events.
t
o
h
s
p
a
n
s
r
e
p
s
P
I
e
v
i
t
c
a
f
o
%
5
1
0
1
5
0
●
●
●
●
1
●
up events [min,median,max]
down events [min,median,max]
● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ● ●
14
7
aggregation window [days]
21
28
s
e
s
s
e
r
d
d
a
4
v
P
I
e
v
i
t
c
a
n
i
e
g
n
a
h
c
M
0
0
2
M
0
0
1
0
M
0
0
1
−
M
0
0
2
−
appear
%
5
2
%
5
2
1
.
0
%
5
.
2
1
−
disappear
1 week
26 weeks
time lag from 2015−01−01
%
5
2
−
52 weeks
(b) Median up/down events between sub-
sequent snapshots for different aggrega-
tion windows (union of active IPs within
window).
(c) Difference in active IPv4 addresses
compared to ﬁrst snapshot of our period
(weekly).
Figure 4: Activity and churn in active IPv4 addresses.
we see 55M addresses showing activity that were not active
the day before. Another 55M addresses are active that day,
but not on the next day.
We next assess whether this churn appears only on short
timescales (i.e., due to short-term inactivity of certain IP
addresses) and disappears on longer timescales, e.g., when
comparing subsequent weeks to each other as opposed to
days. In Figure 4(b), we partition the 112 days of Figure 4(a)
into non-overlapping windows, of a given size. For a win-
dow size of 7 days, for example, there would be 16 windows,
or snapshots. In each window, we note the union of all active
IP addresses. Then, for window i and i + 1 we compute the
percentage of addresses that had an up event as 100 ⇥ (the
number of addresses in window i + 1 that are not present
in window i) divided by the number of addresses in window
i + 1. Hence, for a window size of 7 days, we obtain 15 such
percentages. We then note the minimum, median, and max-