title:On the feasibility of launching the man-in-the-middle attacks on VoIP
from remote attackers
author:Ruishan Zhang and
Xinyuan Wang and
Ryan Farley and
Xiaohui Yang and
Xuxian Jiang
On the Feasibility of Launching the Man-In-The-Middle
Attacks on VoIP from Remote Attackers
Ruishan Zhang†, Xinyuan Wang†, Ryan Farley†, Xiaohui Yang†, Xuxian Jiang‡
†Department of Computer Science
George Mason University
Fairfax, VA 22030, USA
{rzhang3, xwangc, rfarley3, xyang3}@gmu.edu
‡Department of Computer Science
N.C. State University
Raleigh, NC 27606, USA
PI:EMAIL
ABSTRACT
The man-in-the-middle (MITM) attack has been shown to
be one of the most serious threats to the security and trust
of existing VoIP protocols and systems. For example, the
MITM who is in the VoIP signaling and/or media path can
easily wiretap, divert and even hijack selected VoIP calls
by tempering with the VoIP signaling and/or media traﬃc.
Since all previously identiﬁed MITM attacks on VoIP require
the adversary initially in the VoIP signaling and/or media
path, there is a common belief that it is infeasible for a
remote attacker, who is not initially in the VoIP path, to
launch any MITM attack on VoIP. This makes people think
that securing all the nodes along the normal path of VoIP
traﬃc is suﬃcient to prevent MITM attacks on VoIP.
In this paper, we demonstrate that a remote attacker who
is not initially in the path of VoIP traﬃc can indeed launch
all kinds of MITM attacks on VoIP by exploiting DNS and
VoIP implementation vulnerabilities. Our case study of Von-
age VoIP, the No.1 residential VoIP service in the U.S. mar-
ket, shows that a remote attacker from anywhere on the In-
ternet can stealthily become a remote MITM through DNS
spooﬁng attack on a Vonage phone, as long as the remote
attacker knows the phone number and the IP address of the
Vonage phone. We further show that the remote attacker
can eﬀectively wiretap and hijack targeted Vonage VoIP calls
after becoming the remote MITM. Our results demonstrate
that (1) the MITM attack on VoIP is much more realis-
tic than previously thought; (2) securing all nodes along the
path of VoIP traﬃc is not adequate to prevent MITM attack
on VoIP; (3) vulnerabilities of non-VoIP-speciﬁc protocols
(e.g., DNS) can indeed lead to compromise of VoIP.
Categories and Subject Descriptors
C.2.0 [Computer-Communication Networks]: General—
Security and protection (e.g., ﬁrewalls); C.2.3 [Computer-
Communication Networks]: Network Operations—Net-
work monitoring
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
ASIACCS’09, March 10–12, 2009, Sydney, NSW, Australia.
Copyright 2009 ACM 978-1-60558-394-5/09/03 ...$5.00.
Keywords
VoIP Security, SIP, MITM Attacks, DNS Spooﬁng
1.
INTRODUCTION
VoIP has experienced explosive growth in the past few
years, and it is becoming an indispensable part of more and
more people’s daily life. An IDC report [4] predicted that
the number of U.S. residential VoIP subscribers will reach 44
million by 2010. In addition, VoIP has been widely used for
carrying mission critical 911 calls. The Federal Communica-
tions Commission (FCC) estimated [2] that there were about
3.5 million residential VoIP 911 calls in 2006. Therefore, fail-
ures in providing reliable and trustworthy VoIP services not
only disrupt the the normal operation of our society but also
may cost people’s lives under certain circumstances.
VoIP is built upon the interaction of a number of ap-
plication protocols on the Internet. The open architecture
of the Internet, however, makes VoIP protocols subject to
more attacks than what is possible in PSTN (public switched
telephone network). Signaling protocol and media transport
protocol are two integral components of any VoIP system.
Currently, the Session Initiation Protocol (SIP) [20] and the
Real Time Transport Protocol (RTP) [22] are the dominant
VoIP signaling protocol and media transport protocol re-
spectively. In fact, most deployed VoIP services (e.g., Von-
age, AT&T, Gizmo and Wengophone) use SIP and RTP. In
addition, all existing VoIP systems depend on DNS to func-
tion normally. Therefore, any vulnerabilities in SIP, RTP
or DNS could lead to the compromise of VoIP security and
trustworthiness.
Previous research [20, 12, 1, 26, 24, 15] has shown that
a man-in-the-middle (MITM), who is in the path of VoIP
traﬃc, is able to wiretap, divert and even hijack selected
VoIP calls by tempering with the VoIP signaling and/or
media traﬃc. Such MITM attacks on VoIP could cause seri-
ous consequences to the targeted VoIP users. For example,
VoIP wiretapping enables attackers to collect sensitive in-
formation (e.g., credit card number, bank account number,
PIN) of the victim VoIP users. Unauthorized VoIP call di-
version and voice pharming [24] could trick even the most
meticulous VoIP callers into talking with bogus bank teller
or interacting with bogus interactive voice response (IVR)
systems. All these MITM attacks on VoIP could cause iden-
tity theft and ﬁnancial loss to the victim VoIP users.
Since all previously identiﬁed MITM attacks on VoIP re-
quire the adversary initially in the VoIP signaling and/or
media path, there is a common belief that it is infeasible for
Figure 1: An Example of Message Flow of SIP Au-
thentication
a remote attacker, who is not initially in the VoIP path, to
launch any MITM attack on VoIP. As a result, many peo-
ple do not believe the MITM attack is a realistic threat to
current VoIP protocols and systems and they think that se-
curing all the nodes along the normal path of VoIP traﬃc is
suﬃcient to prevent MITM attacks on VoIP.
In this paper, we investigate the feasibility for a remote
attacker, who is not initially in the path of VoIP traﬃc, to
become the MITM. Our case study of Vonage VoIP service,
which is the No. 1 residential VoIP service in the U.S. [9],
shows that a remote attacker from anywhere on the Inter-
net can, by exploiting the vulnerabilities of DNS and SIP
message handling in the Vonage phone, stealthily become
the remote MITM and launch all kinds of MITM attacks on
target VoIP phones. Speciﬁcally, we ﬁnd that
• the remote attacker can crash and reboot the targeted
Vonage SIP phone by sending it crafted, malformed
SIP INVITE messages. This will cause the rebooted
Vonage SIP phone to send out DNS query about the
location of the SIP server to contact.
• the remote attacker can trick the Vonage SIP phone
into taking any IP address as that of the Vonage SIP
server via spoofed DNS responses.
• the remote attacker can cause all the calls to or from
the targeted Vonage phone to pass it. This makes the
remote attacker a MITM and enables him to wiretap
and hijack any calls to or from the targeted Vonage
phone.
Note, the identiﬁed remote MIMT attack on VoIP only
requires the knowledge of the phone number and the IP ad-
dress of the targeted Vonage phone, and it works even if the
targeted Vonage phone is behind NAT.
Our results demonstrate that (1) the MITM attack on
VoIP is much more realistic than previously thought; (2)
securing all nodes along the path of VoIP traﬃc is not ade-
quate to prevent MITM attack on VoIP; (3) vulnerabilities
of non-VoIP-speciﬁc protocols (e.g., DNS) can indeed lead
to compromise of VoIP.
The rest of this paper is organized as follows. Section 2
gives a brief overview of SIP and the MITM attack. Section
3 describes our investigation approach. Section 4 presents
Figure 2: Unauthorized Call Redirection via MITM
our case study and demonstrates the DNS spooﬁng, wire-
tapping and call hijacking attacks on a Vonage SIP phone.
Section 5 discusses potential mitigation strategies. Section 6
reviews related work. Finally, section 7 concludes the paper.
2. OVERVIEW OF SIP AND THE MIMT AT-
TACK
SIP is a HTTP-like, application layer signaling protocol
used to create, modify, and terminate multimedia sessions
(e.g., VoIP calls) among Internet endpoints. The SIP spec-
iﬁcation deﬁnes the following diﬀerent components: user
agents (UA), proxy servers, redirect servers, registrar servers,
location servers. An UA represents an endpoint of the com-
munication (i.e., a SIP phone). The proxy server is the in-
termediate server that forward the SIP messages from UAs
to its destination. Various SIP servers described above are
logical functions.
In most deployed systems, generic SIP
servers perform the functionalities of both registrar servers
and proxy servers.
The SIP speciﬁcation [20] recommends using TLS or IPSec
to protect SIP signaling messages, and using S/MIME to
protect the integrity and conﬁdentiality of SIP message bod-
ies. However, most deployed SIP VoIP systems (e.g., Von-
age, AT&T CallVantage) only use SIP authentication to pro-