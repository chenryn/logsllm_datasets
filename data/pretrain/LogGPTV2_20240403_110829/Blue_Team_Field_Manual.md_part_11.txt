Desktaolplso,mw usl tiDpelsek Stcorpe ens:
Refh.t tps://technet.microsoft.com/en­
us/sysinternals/cc817881
Rulni voep tion:
C:\">% ProgramFilEexsp%l\oIrnetre\rineextp lore.exe
"https://live.sysinternals.com/desktops.exe
Remomtoeu ntRienagad,n Rde ad/Write:
C:\n>e sth aMryeS hare_RO=NcL:FY\O 
/GRANT:EVERYONE,READ
C:\n>e sth aMryeS hare_RW=cF:O\LD /WRITE
/GRANT:EVERYONE,FULL
Remottaese kx ecuutsiioPnnSg E XEC:
Refh.t tps://technet.microsoft.com/en­
us/sysinternals/psexec.aspx
C:\p>s exec\.\eS NEARM E>
-p.exe
C:\p>s ex@e(c: \-.utP ROG>R>A M>,exe
C:\,txt
C:\p>s exec@.(e:x\e-.uc sv
p>\ /c
C:\.exe
Remottaese kx ecuatnisdoe nn odu tptuost h are:
C:\w>m i/cn ode:ComppruotcecerasNlscal rm eea te
ucmd,/ecnx eet s-taa>nt\ \\,txt
104
Comptawrofe i lfeosr c hanges:
PSC :\C>o mpare-(OGbejte-cCto, nl,o g-)D ifferen(cGeeOtb-jCeo.cn ,log)
Remottaese kx ecuutsiionnPg o werShell:
PSC :\I>n voke--CP S
COMMAND>}
PowerSChoemlmlHa enldp :
PSC :\G>e t-Hl l
LINUX
Analytzrea frfeimco toevlesyrs h:
# ssrho ot@
tcpd-uima pn- yU - s0 - w- 'nopto r2t2 '
Manuaaldlndyo te/tdoas tyas log:
#
logguesro metihmipnogrt tona ontti enL og"
#
dmeIsg gr e
Simprleea odn lmyo unting:
# mou-notr o/ dev/n t
Mountrienmgo toevleSyrS H:
#
apt-ignestt saslhlf s
#
addus e
Loogu atn ldo bga cikn .
mkdi/r
# ssh@:/
105
CreatSiMnsBgh airneL inux:
#u ser-amd d
#p ass
#s mbpa-sa
#e ch[oS ha>r>/e e]t c/samba/smb.conf
#e ch/oE>>
/etc/samba/smb.conf
#e chaov ail=ay bel>se>/ etc/samba/smb.conf
#e chvoa luisde =rR>>
/etc/samba/smb.conf
#e chroe aodn l=yn o>>/ etc/samba/smb.conf
#e chbor ows=ay bel>se> / etc/samba/smb.conf
#e chpou bl=iy ce>s>/ etc/samba/smb.conf
#e chwor ita=beyls>e> / etc/samba/smb.conf
#s ervsimcbrede start
Vissihta frreo rme mostyes tem:
>s mb:\A\D
Copfyi lteosr emostyes tem:
>s cS NEARM E>@:/
MouanntSd M sBh atroer emostyes tem:
#m ou-ntts mb-fosu sernamNeA=MSN/AAn RtE/  /
Moniatw oerb soirtf ei liess tiulpl/ there:
#whi:l;ed oc ur-ls Shrt tp://Ih ;
sle6e0pd; o ne
106
DECODING
HECXO NVERSION
Convefrrtoh me xt od ecimianWl i ndows:
C:\s>e /ta 0 xff
255
PSC :\0>x ff
255
OtheBra sMiact ihnW indows:
C:\s>e /ta 1 +2
3
C:\s>e /ta 3 *(9/4)
6
C:\s>e /ta ( 2*5)/2
5
C:\s>e /ta "3 2>3">
4
DecoBdaes et6e4xi tna file:
C:\c>e rtu-tdielc
DecoXdOeRa n ds earfcohhr t tp:
Ref,
https://blog.didierstevens.com/programs/xorsearch/
C:\x>o rsear-ci-h s,pt
Convefrrtoh me xt od ecimianLl i nux:
#
echuo0 xff"-ldw calc
=
255
107
Convferrotdm e citmoah le ixn L inux:
$e chuo2 5s"1-whc alc
=0 xff
DecoHdTeMS Lt rings:
PSC :\A>d d-T-yApses embSlyysNtaemme. Web
PSC :\>
[Syste::mU.nUersic]a peDataString("HTTP%3a%2f%2fHello
%20World.com")
HTTP:/W/oHrelldl.oc om
108
SNORT
SNORRUTL ES
SnoRrutl teosd eteMcett erptrreatfefri c:
Ref.
httpso:g/./dbildierstevens.com/2015/06/16/metasploit
-meterpreter-reverse-https-snort-rule/
aletrct$p H OMEa_nN-yE>$T E XTERN$AHLT_TNPE_TP ORTS
(msg:"MeUtsaesArpg leSontitrt i ng";
flows:etrov_setra,belicsohnetde;n t:"User-Agentl3al
Mozill(ac/o4m,p0a tMiSbI6lE.e 0\W\;i; n dNoTw s
5.l10)0d a lh"t;t p_hecaldaesrs;t ype:trojan­
activity;
reference:url,blog,didierstevens.com/2015/03/16/quic
kpost-metasploitg-su/ss;ie dr:-1a6g1e8n0t0-0s;t rin
rev:1;)
aletrct$p H OMEa_nN-yE>$T E XTERN$AHLT_TNPE_TP ORTS
(m s"gM:e tasUpsleAorgi etSn rtti ng";
flow:to_servecro,netsetnatb:l"iUssheerd-;A gentl3al
Mozill(ac/o4m.p0a tMiSbI6lE,e 1\W\;i; n dNoTwl)s0 d
0alh"t;t p_hecaldaesrs;t ype:trojan-activity;
reference:url,blog,didierstevens.com/2015/03/16/quic
kpost-metasploit-ussiedr:-1a6g1e8n0t0-1s;t rings/;
re1v;:)
aletrct$p H OMEa_nN-yE>$T E XTERN$AHLT_TNPE_TP ORTS
(ms"gM:e tasUpsleAorgi etSn ttr ing";
flow:to_sstearbvleicrso,hneetde;n t:"User-Agentl3al
Mozi/l4l,(a0c ompatMiSbI7lE,e 0\W\;i; n dNoTw s
6.l00)0d a lh"t;t p_hecaldaesprse;t: ytrojan­
activity;
referenced:iudrile,rbsltoegv.ens.com/2015/03/16/quic
kpost-metasploit-ussiedr:-1a6g1e8n0t0-2s;t rings/;
re1v;:)
aletrct$p H OMEa_nN-yE>$T E XTERN$AHLT_TNPE_TP ORTS
(msg:"MeUtsaesArpg leSontitrt i ng";
109
flow:to_servecro,netsetnatb:l"iUssheerd-;A gentl3al
Mozill(ac/o4m,p0a tMiSbI7lE,e 0\W\;i; n dNoTw s
6,0T\r;i dentS/I4M,B0A\R;= {7DB0F6DE-8DE7-4841-9084-
28FA914BS0LFC2CE,l}N\\l;0;0 a dl h"t;t p_header;
classtype:trojan-activity;
reference:url,blog.didierstevens.com/2015/03/16/quic
kpost-metasploit-ussiedr:-1a6g1e8n0t0-3s;t rings/;
re1v;:)
aletrct$p H OMEa_nN-yE>$T E XTERN$AHLT_TNPE_TP ORTS
(msg:"MeUtsaeAsrgp elSnottir ti ng";
flow:to_servecro,netsetnatb:l"iUssheerd-;A gentl3al
Mozill(ac/o4m.p0a tMiebtlaes\pR;lS oPiEtC0 )all0"d;
http_hcelaadsesrt;y pe:trojan-activity;
reference:url,blog,didierstevens.com/2015/03/16/quic
kpost-metasploit-ussiedr:-1a6g1e8n0t0-4s;t rings/;
re1v;:)
aletrct$p H OMEa_nN-yE>$T E XTERN$AHLT_TNPE_TP ORTS
(msg:"MeUtsaesArpg leSontitrt i ng";
flow:to_servecro,netsetnatb:l"iUssheerd-;A gentl3al
Mozill(aW/i5n,d0Uo \wW;si \n;d NoTw5 s, 1e\n;- US)
AppleWebK(iKtH/T5lM2iL5kG,,ee 1 c3k o)
Chrome/4S.a0f.a2r2i1/.5602 a5l,h"1t;3t lp0_dh eader;
classtype:trojan-activity;
reference:url,blog.didierstevens.com/2015/03/16/quic
kpost-metasploit-ussiedr:-1a6g1e8n0t0-5s;t rings/;
re1v;:)
aletrct$p H OMEa_nN-yE>$T E XTERN$AHLT_TNPE_TP ORTS
(m s"gM:e tasUpsleAorgi etSn rtti ng";
flow:to_server,established; content:"User-Agentl3al
Mozill(ac/o5m.p0a tGiobolgel\e;b ot/2.1\;
+http://www.goolg0l0dea .lc"o;m /bot.html)
http_hcelaadsesrt;y pe:trojan-activity;
reference:url,blog,didierstevens.com/2015/03/16/quic
kpost-metasploit-ussiedr:-1a6g1e8n0t0-6s;t rings/;
re1v;:)
aletrct$p H OMEa_nN-yE>$T E XTERN$AHLT_TNPE_TP ORTS
(ms"gM:e tasUpsleAorgi etSn rtti ng";
110
flow:etrov_esr,estcaobnltiesnhte:d";U ser-Agentl3al
Mozill(ac/o5m,p0a tMiSbI1lE0e ,\0W;\i ;n dNoTw s
6,1T\r;i denlt0/0d6a ,l0h")t; t p_header;
classtype:ttryo;j an-activi
reference:url,blo/g2.0d1i5d/i0e3r/s1t6e/vqeunisc. com
kpost-metasploit-ussiedr:-1a6g1e8n0t0-7s;t rings/;
re1v;:)
SnorRtu lteosd etePcStE XtErCa ffic:
Refh.t tps://github.com/John-Lin/docker­
snto/rblob/master/snortrules-snapshot-
2972/rules/policy-other.rules
aletrct$p H OMEa_nN-yE>$T H OME_NET [139,445]
(msg:"POLuIsCoeYf p- sOeTxHreEecRm ote
admiisrnta i to tno o;lf "lotwo:_ seersvtearb,l ished;
conteIFnIFStM:B"I1 "A;d2 eptho:f5f;s et:4;
conteISnCt :"
.0I0pI 0 I0sI 0 I0eI 0 I0xI 0 I0eI 0 I0cI 0 I0sI 0 I0vI 0 I0c ;"
nocamseet;a datan:estebrivoisc-es sn;
reference:url,technet.microsoft.com/en­
us/sysinternalsc/lbabs8s9t7y5p5e3:.paoslpixc;y ­
violatsiiod0n:0;28 4r;e v:1;)
aletrct$p H OMEa_nN-yE>$T H OME[_1N3E9T, 445]
(msg:"POLuIsCoeYf p- sOeTxHreEecRm ote
admintiisottnor oaSlM Bv2";
flow:to_servecro,netsetIFnaIEStb:Ml"Bi"s;h ed;
depthn:o8c;ac soen;t ent0:01"w"1i;0t 5h in:2;
distance:8;
content:"IEPllI00X00lI10ElS00lIS00l0I0V0lI0C0lI0"0;
fast_pattmeertna:doantlayn:;es tebrivoisc-es sn;
reference:url,technet.microsoft,com/en­
us/sysinternals/cblba8s9s7t5y5p3e.:apsoplxi[cly]­;
violatsiiodn:;3 0r2e8v1:;1 ;)
111
DOS/DDOS
FINGERDPORSI/NDTD OS
Fingerprtihnett yiponefg D oS/DDoS:
Refh.t tps://www.trustwave.com/Resources/SpiderLabs­
Blog/PCAP-Filrens--tA-rTeh-eGyr-e-a/t -A
VolumetBraincd:wc iodntshu mption
Exampslues,t aisneinnd1giG nobgf t raftfoi1 c0 Mb
connection
Refh.t tp://freecode.com/projects/iftop
#i ft-onp
andP rotoUcosole:f s pecipfrioct ocol
ExampSlYFeNl, o oIdC,MF Pl ooUdD,fP l ood
#t sha-rra-pq- zi o,phs
#
tsha-rc1k0 0-0q - zi o,phs
#t cpd-utmrn$p F ILIaE w -kF ' '.' {print
$1","."$$23"",'" s$Io4 r}Itu ni-qcI s or-tnI
tail
!=
#t cpd-uqmn"ptn c p[tcp&f (ltacgps-]s 0y"n )
#n ets-tsa t
Exampilseo,lo antpeer otoacnoodlr r emove other
protocols
#
tcpd-unmnnpo atr apn ndo itc mapn ndo utd p
#t cpd-unmtnpc p
112
ResouSrcteaa:t necd o nnecetxihoanu stion
ExampFlier,e wcaalhnla nd1l0e, 0s0i0m ultaneous
connectainaodtn tsa,cs keen2rd0 s, 000
#
nets-tnaI ta w'k{ pr$i6n}tI's orItu ni-qc
sor-ntr I h eda
ApplicaLtaiyo7ena r:t tacks
ExampHlTeTG,PE fTl oofdo,ar l arigmea fgiel e.
#
tsha-rc1k 0 0-0T0f iel-dehs t tp.hsorost tI
uni-qcI s or-tr heIa -dn1 0
#
tsha-rrck a ptu-rTfe i6e l-des