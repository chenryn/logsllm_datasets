f
o
s
e
s
s
a
C
l
D
I
r
e
s
U
21
7
27
28
15
18
12
44
36
19
13
45
33
43
38
37
16
8
35
34
24
9
40
3
46
42
30
1
21
15
39
24
28
20
47
41
23
6
19
18
22
44
7
14
31
33
9
32
5
10
4
12
8
13
38
40
45
2
36
29
25
16
26
17
35
27
43
34
37
11
Fig. 1. Local vs. wide-area connections per user
(Total number of connections per user varies
between 2.5 K and 3 M.)
Fig. 2. Bytes transferred on local vs. wide-area
connections per user (Total amount of trafﬁc per
user varies between 800 MB and 770 GB)
City: “Santa Cruz, California”; Country: “United States” as Work. Another example
containing ISP: “Free”; City: “Paris”; Country: “France” is labeled Home. This man-
ual classiﬁcation reduced the fraction of unlabeled traces to 2 %. Some traces have no
information that indicates the type of network.
Application Categorization. For our analysis of popular applications we rely on a
two-staged categorization process. First, we assign one of eleven application categories
or “unclassiﬁed” to each connection based on the process executable name. Second,
we label any connection that remains unclassiﬁed based on the application protocol as
derived from the port number using the IANA mapping. We assign categories to those
process names and application protocols that account for the most connections and the
most volume. Table 1 lists the eleven categories and gives example process names and
application protocols for each of them.
4 Results
This section ﬁrst compares local and wide-area trafﬁc in general. Then, it studies the
split of local and wide-area trafﬁc at home and at work.
Local vs. Internet: Connection and Bytes. Figures 1 and 2 show the fraction of local
(two bottom bars) and wide-area (two top bars) trafﬁc for each user (UserIDs are the
same across ﬁgures for comparison). For each user, we separate UDP (shaded bars)
from TCP (solid bars) trafﬁc. We consider the composition of trafﬁc by number of
connections (Figure 1) and bytes (Figure 2).
Take the example of the rightmost user in Figure 1, UserID 34, 77 % (46 % UDP
and 31 % TCP) of this user’s connections are local. The remaining trafﬁc is directed
to the Internet (0 % UDP and 23 % TCP). In general, we observe that Internet trafﬁc
dominates both in number of connections and bytes, although this dominance is much
more pronounced for bytes. In total, we classify 780 GB as local and 3 TB as wide-area
trafﬁc. Furthermore, we see that UDP dominates local connections for almost 80 % of
26
A. Reggani, F. Schneider, and R. Teixeira
Application Categories: Wide−Area
Application Categories: Local
Backup
Chat
DistantControl
Email
Personal
FileTransfer
Management
Miscellaneous
NameService
NetworkFS
P2P
Printing
Web
Unclassified
Bytes
Connections
Backup
Chat
DistantControl
Email
Personal
FileTransfer
Management
Miscellaneous
NameService
NetworkFS
P2P
Printing
Web
Unclassified
Bytes
Connections
0
20
40
60
80
100
0
20
40
60
80
100
Fig. 3. Application mix for wide-area trafﬁc
Fig. 4. Application mix for local trafﬁc
the users. The absence of shaded bars in Figure 2 clearly shows that almost all bytes are
transferred in TCP connections (>89 %).
The four rightmost users in Figure 2 transfer more bytes locally than in the wide-
area. As we discuss in the next section, most of this trafﬁc corresponds to network ﬁle
system, so these users could be playing music or watching videos from a local network
storage. In Figure 2, more than half of the users exchange almost all trafﬁc with hosts
in the wide-area (corroborating previous ﬁndings [5]). In the rare cases these users do
exchange trafﬁc with hosts in the local network, they mainly perform ﬁle transfers.
Local vs. Internet: Application Mix We now study how local and wide-area ap-
plications differ. Figures 3 and 4 show the application mix in terms of connections
(shaded bars) and data bytes (solid bars). These ﬁgures use the application categoriza-
tion method described in Section 3, which leaves no more than 12 % of connections and
7 % of bytes unclassiﬁed.
Figure 3 shows the application mix for wide-area trafﬁc. We see that the proportion of
bytes per application class agrees with results from previous studies [6, 7]. Web trafﬁc
and P2P are the top applications. In addition, we see some ﬁle transfers and distant
control trafﬁc (ssh and VNC). When we classify in terms of number of connections, the
mix changes and name services take the second place behind Web. Chat and Email are
also more prevalent in terms of connections than bytes.
Figure 4 shows that name services (e. g., DNS) dominates local trafﬁc in terms of
connections, whereas backup and network ﬁle systems (e. g., AFP and SMB) in terms
of bytes. A previous study of enterprise trafﬁc [9] also found that network ﬁle system
and name service dominate local trafﬁc, but their study found considerably more local
email and web trafﬁc than what we ﬁnd. A signiﬁcant part of our data is of home trafﬁc,
which may explain this difference. We now split the trafﬁc into home and work.
Trafﬁc at Home and Work Our analysis so far has mixed trafﬁc from multiple net-
work environments, including home, work, airports, coffee shops, or hotels. Based on
our extended environment labels (see Section 3) we investigate the differences not only
between local and wide-area trafﬁc, but also across different types of network envi-
ronments. Figure 5 shows the distribution of trafﬁc and users over the different envi-
ronments. Note that a single user can visit multiple environments. After applying our
An End-Host View on Local Trafﬁc at Home and Work
27
Users
Bytes
Connections
s
n
o
i
t
c
e
n
n
o
C
/
s
e
t
y
B
/
s
r
e
s
U
f
o
e
g
a
t
n
e
c
r
e
P
0
8
0
6
0
4
0
2
0
Home Work Co/Me Airp.
Hotel Coffee Public Other
0
0
1
0
8
0
6
0
4
0
2
0
]
%
[
r
e
s
u
r
e
p
s
e
t
y
B
c
i
f
f
a
r
t
f
o
s
e
s
s
a
C
l
D
I
r
e
s
U
Home/Wide−Area
Work/Wide−Area
Work/Local
Home/Local
21
23
20
44
9
39
24
13
38
3
31
18
16
26
32
28
14
7
19