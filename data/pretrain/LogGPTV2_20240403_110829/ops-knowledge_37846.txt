User: 给定一个Apache Kafka主题，请指导如何设置消费者组，并解释如何消费消息。
Assistant: 设置消费者组时，可以在消费者客户端的配置中指定。消费者组的目的是将消费者分组，每个组只能有一个消费者订阅一个主题的每个分区的消息，以避免消息重复消费和确保负载均衡。只有在消费者组中，才能使用消费者协调器进行消费者的动态分配和重新分配功能。

要消费消息，首先必须创建一个Kafka消费者对象，使用该消费者对象指定要消费的主题和消费者组的ID。然后在消费者配置中指定消费组的ID，以便将消费者组分配给消费者。消费者订阅主题和分区后，就可以使用poll()方法从Kafka集群中获取消息，消费者会从指定的分区中获取消息。处理完消息之后，要使用commitSync()方法将偏移量提交到Kafka集群中。

在消费者组中，同一分区通过协调器平等地分配给消费者，以确保负载平衡和高可用性。一个消费者可能被分配多个分区，或者有多个消费者订阅同一个分区。每个消费者都是独立的，可以以任何方式消费消息，但它们必须指定相同的消费组ID，以便协调器将消费者组中的消费者重新平衡。