1
2
Î ,A,ğ‘„Dec,PW(1ğœ†, 1ğ‘š, 1ğ‘¡) = 1(cid:105) âˆ’
Î ,A,ğ‘„Dec,PW(1ğœ†, 1ğ‘š, 1ğ‘¡) = 1(cid:105)(cid:12)(cid:12)(cid:12) â‰¤ ğ‘„Dec
|PW| + negl(ğœ†) .
We will prove the above statement via a typical hybrid argument,
1
Hid
for that we define the following hybrid experiments:
Î ,A,ğ‘„Dec,PW(1ğœ†, 1ğ‘š, 1ğ‘¡).
â€¢ Hybğ‘,0 is identical to Hidğ‘
â€¢ Hybğ‘,1 is mostly identical to Hybğ‘,0, except that all zero-
knowledge proofs are simulated by running the simulator of
the NIZKPoK scheme. It it straightforward to show that, for
all ğ‘ âˆˆ {0, 1},
(cid:12)(cid:12)(cid:12) Pr(cid:2)Hybğ‘,0 = 1(cid:3) âˆ’ Pr(cid:2)Hybğ‘,1 = 1(cid:3)(cid:12)(cid:12)(cid:12) â‰¤ negl(ğœ†)
using the zero-knowledge property of the NIZKPoK scheme.
â€¢ Hybğ‘,2 is mostly identical to Hybğ‘,1, except that when an
honest key rotation is triggered (the adversary queries the
RotateO oracle with HonestRot = 1), the secret key com-
ponents (ğ‘˜ğ‘–, ğ¾0, { Â¯ğ¾ğ‘—}ğ‘¡âˆ’1
ğ‘—=0) are freshly generated. For all ğ‘ âˆˆ
{0, 1}, note that Hybğ‘,1 and Hybğ‘,2 are functionally equiva-
lent, therefore
Pr(cid:2)Hybğ‘,1 = 1(cid:3) = Pr(cid:2)Hybğ‘,2 = 1(cid:3) .
â€¢ Hybğ‘,3,0 is identical to Hybğ‘,2.
â€¢ Hybğ‘,3,ğ‘, where ğ‘ âˆˆ [ğ‘„Dec], is mostly identical to Hybğ‘,ğ‘âˆ’1,
except that when answering the adversaryâ€™s ğ‘-th query to
the DecO oracle which triggers the increment of the counter
DecCount (called a critical query hereinafter), the group el-
ements sent by honest parties are replaced by uniformly
âˆ€ğ‘— âˆˆ [0, ğ‘¡ âˆ’ 1]
âˆ€ğ‘— âˆˆ [0, ğ‘¡ âˆ’ 1]
âˆ€ğ‘– âˆˆ [ğ‘š]
âˆ€ğ‘– âˆˆ [ğ‘š]
0,
ğ¾â€²
0 = ğºğ‘˜â€²
0 = ğ¾ğ›¾
Â¯ğ›½ ğ‘— ,
Â¯ğ‘†â€²
ğ‘— = Â¯ğ‘† ğ‘—ğº
Â¯ğ›¿ ğ‘— ,
Â¯ğ¾â€²
ğ‘— = Â¯ğ¾ğ›¾
ğ‘— ğº
ğ‘—=0 Â¯ğ‘†â€²ğ‘– ğ‘—
ğºğ‘ â€²
ğ‘—=0 Â¯ğ¾â€²ğ‘– ğ‘—
ğºğ‘˜â€²
ğ‘– =ğ‘¡
ğ‘– =ğ‘¡
ğ‘—
ğ‘—
,
, and
for some random Â¯ğ›½0, . . . , Â¯ğ›½ğ‘¡âˆ’1, ğ›¾, Â¯ğ›¿0, . . . , Â¯ğ›¿ğ‘¡âˆ’1 sampled by the server.
0, Â¯ğ›½0) and a nonce ğ‘›,the server can up-
date each ğ¶ âˆˆ SKE.Enc(ğ‘ 0, (ğ¶0, ğ¶1)) to ğ¶â€² â† SKE.Enc(ğ‘ â€²
0, ğ¶â€²
1))
1 := ğ¶1 Â· ğ»1(ğ‘›) Â¯ğ›½0.
where ğ¶â€²
With the update token (ğ‘ 0, ğ‘ â€²
0 := ğ¶0 Â· ğ»0(ğ‘›) Â¯ğ›½0 and ğ¶â€²
0, (ğ¶â€²
3.3 Correctness and Security
The correctness of our construction follows from the correctness
of SKE and the completeness of the NIZKPoK scheme described
in Appendix A.2. Below, we state the security of our construction,
and give a proof sketch.
Theorem 3.1 (Hiding). If the decisional Diffie-Hellman (DDH)
assumption holds with respect to GGen, and SKE is CCA-secure, then
the (ğ‘¡, ğ‘š)-PHE scheme constructed above is semi-adaptively hiding
in the random oracle model.
Proof. We first note that the well known generalized Schnorr
protocol [17] (recalled in Figure 7) is a perfectly zero-knowledge
NIZKPoK for the relation ğ‘…GDL in the random oracle model. We
therefore do not need extra assumptions on the NIZKPoK.
We want to prove that construction is hiding (under semi-adaptive
corruption). That is, for any PPT adversary A, any integer ğ‘„Dec â‰¥ 0,
7
DecâŸ¨. . . , . . .âŸ©
Server S(â€œdecâ€, sk0, pw, ğ‘›, ğ¶)
ensure KVf(0, sk0)
(ğ¶0, ğ¶1) â† SKE.Dec(ğ‘ 0, ğ¶)
ensure (ğ¶0, ğ¶1) â‰  âŠ¥
ğ‘‹0 := ğ»0(ğ‘›), ğ‘‹1 := ğ»1(ğ‘›)
ğ‘Œâˆ’1
0,0 := ğ¶âˆ’1
0
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Computing encryption of ğ‘ := ğ‘Œâˆ’1
ğ¾ := ğ¾0 Â· Â¯ğ¾0
ğ‘Ÿ0 â†$ Zğ‘ , (ğ‘ˆ0, ğ‘‰0) := (ğºğ‘Ÿ0 , ğ¾ğ‘Ÿ0 Â· ğ‘Œâˆ’1
0,0 )
Â· ğ»0(pw, ğ‘›)
Rate-limiter Rğ‘– (â€œdecâ€, skğ‘–), âˆ€ğ‘– âˆˆ [ğ‘š]
ensure KVf(ğ‘–, skğ‘–)
ğ‘›
0,0 Â·ğ‘–âˆˆğ‘ƒ ğ‘Œ
ğœ†ğ‘ƒ,ğ‘–
ğ‘–,0
ğ‘‹0 := ğ»0(ğ‘›), ğ‘‹1 := ğ»1(ğ‘›)
ğ‘Œğ‘–,0 := ğ‘‹ ğ‘ ğ‘–
0
for some ğ‘¡-subset ğ‘ƒ âŠ† [ğ‘š] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
ğœ†ğ‘ƒ,ğ‘—
ğ‘—
(ğ‘ˆ , ğ‘‰) :=
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Computing encryption of (ğ‘ Ëœğ‘Ÿ , ğ‘ Ëœğ‘Ÿâ€² Â· ğ»1(pw, ğ‘›) Â· ğ»1(ğ‘›)ğ‘–âˆˆğ‘ƒ ğœ†ğ‘ƒ,ğ‘– ğ‘ ğ‘– ) for some random Ëœğ‘Ÿ and Ëœğ‘Ÿâ€² . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
(cid:19)
ğœ†ğ‘ƒ,ğ‘—
ğ‘—
Ëœğ‘Ÿâ€²0 Â· ğ»1(pw, ğ‘›)(cid:17)
Ëœğ‘Ÿâ€²0 , ğ‘‰
Ëœğ‘Ÿâ€²
ğ‘– , ğ‘‰
Ëœğ‘Ÿâ€²
ğ‘– Â· ğ‘‹
ğœ†ğ‘ƒ,ğ‘–Â·ğ‘ ğ‘–
1
ğ‘† ğ‘— :=ğ‘¡âˆ’1
(cid:40)
â„“=0 Â¯ğ‘† ğ‘—â„“
â„“
, âˆ€ğ‘— âˆˆ [ğ‘š]
ğœ‹1,0 â† Prove (crs, (ğº, ğ‘ˆ0), ğ‘Ÿ0)
ğ‘— âˆˆ [ğ‘š] : Vf
P :=
ensure |P| â‰¥ ğ‘¡
ğ‘ƒ â† Subsetğ‘¡ (P)
(cid:32)
(cid:32) ğº,
crs,
ğ¼,
ğ‘‹0,
(cid:33)
(cid:33)
(cid:41)
= 1
, ğœ‹1,ğ‘—
ğ¼,
ğº,
ğ¾,
ğ‘† ğ‘—
ğ‘ˆ ğ‘—
ğ‘‰ğ‘—
(cid:19)
,ğ‘—âˆˆğ‘ƒâˆª{0}ğ‘‰
(cid:16)ğ‘ˆ
0) :=
0, Ëœğ‘‰â€²
ğœ†ğ‘ƒ,ğ‘—
ğ‘—
(cid:18)ğ‘—âˆˆğ‘ƒâˆª{0}ğ‘ˆ
(cid:16)ğ‘ˆ Ëœğ‘Ÿ0 , ğ‘‰ Ëœğ‘Ÿ0(cid:17) , ( Ëœğ‘ˆ â€²
(cid:16)
(cid:16)
crs, (ğ‘ˆ , Ëœğ‘ˆ0), Ëœğ‘Ÿ0
crs, (ğ‘ˆ , Ëœğ‘ˆ â€²
0), Ëœğ‘Ÿâ€²
0
(cid:17)
(cid:17)
Ëœğ‘Ÿ0, Ëœğ‘Ÿâ€²
0 â†$ Zğ‘
( Ëœğ‘ˆ0, Ëœğ‘‰0) :=
ğœ‹2,0 â† Prove
ğœ‹â€²
2,0 â† Prove
ğ‘‰
, ğœ‹2,ğ‘—
(cid:19)
crs,
Ëœğ‘ˆ ğ‘—
Ëœğ‘‰ğ‘—
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ : Vf
(cid:18)
(cid:18)ğ‘ˆ
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ : Vf(cid:169)(cid:173)(cid:173)(cid:171)crs,(cid:169)(cid:173)(cid:173)(cid:171)
(cid:16)ğ‘—âˆˆğ‘ƒâˆª{0} Ëœğ‘ˆ ğ‘— ,ğ‘—âˆˆğ‘ƒâˆª{0} Ëœğ‘‰ğ‘—
(cid:17)
(cid:16)ğ‘—âˆˆğ‘ƒâˆª{0} Ëœğ‘ˆ â€²
ğ‘— ,ğ‘—âˆˆğ‘ƒâˆª{0} Ëœğ‘‰â€²
ğ¼
ğœ†ğ‘ƒ,ğ‘—
1
ğº
ğ‘‰
ğ¼
ğ‘ˆ
ğ‘‹
ğ‘—
(cid:17)
(cid:19)
(cid:170)(cid:174)(cid:174)(cid:172) , ğœ‹â€²
2,ğ‘—
(cid:170)(cid:174)(cid:174)(cid:172)
ğ‘—
Ëœğ‘ˆ â€²
Ëœğ‘‰â€²
ğ‘—
ğ‘† ğ‘—
ğ‘ˆğ‘– , ğ‘‰ğ‘– , ğœ‹1,ğ‘–
(cid:8)( ğ‘—, ğ‘ˆ ğ‘— , ğ‘‰ğ‘— , ğœ‹1,ğ‘—) ğ‘—âˆˆ(ğ‘ƒâˆª{0})\{ğ‘–}(cid:9)
to ğ‘– âˆˆ ğ‘ƒ
Ëœğ‘ˆğ‘– , Ëœğ‘‰ğ‘– , ğœ‹2,ğ‘– , Ëœğ‘ˆ â€²
ğ‘– , Ëœğ‘‰â€²
ğ‘– , ğœ‹â€²
2,ğ‘–
{( ğ‘—, Ëœğ‘ˆ ğ‘— , Ëœğ‘‰ğ‘— , ğœ‹2,ğ‘— , Ëœğ‘ˆ â€²
2,ğ‘—)} ğ‘—âˆˆ(ğ‘ƒâˆª{0})\{ğ‘–}
ğ‘— , Ëœğ‘‰â€²
ğ‘— , ğœ‹â€²
to ğ‘– âˆˆ ğ‘ƒ
(cid:33)
(cid:33)
, ğœ‹1,ğ‘—
ğ‘† ğ‘—
ğ‘ˆ ğ‘—
ğ‘‰ğ‘—
(cid:19)
ğ¾ := ğ¾0 Â· Â¯ğ¾0
ğ‘Ÿğ‘– â†$ Zğ‘ , (ğ‘ˆğ‘– , ğ‘‰ğ‘–) := (ğºğ‘Ÿğ‘– , ğ¾ğ‘Ÿğ‘– Â· ğ‘Œğ‘–,0)
ğ‘¡âˆ’1
â„“=0 Â¯ğ‘†
ğ‘—â„“
â„“
(cid:32)
ğ‘† ğ‘— := ğº
ğ‘†ğ‘– := ğºğ‘ ğ‘–
, âˆ€ğ‘— âˆˆ [ğ‘š] \ {ğ‘–}
(cid:32) ğº,
ğ¼,
ğ‘‹0,
(cid:19)(cid:33)
(cid:33)
,
(cid:18)ğ‘ ğ‘–
ğ‘Ÿğ‘–
ğ¼,
ğº,
ğ¾,
ğ‘†ğ‘–
ğ‘ˆğ‘–
ğ‘‰ğ‘–
ğœ‹1,ğ‘– â† Prove
crs,
ğ‘ˆ
(cid:19)
crs,
ğ¼,
ğ‘‹0,
ğ¼,
ğº,
ğ¾,
ğœ†ğ‘ƒ,ğ‘—
ğ‘—
ğ‘– ) :=
(ğ‘ˆ , ğ‘‰) :=
ğœ‹2,ğ‘– â† Prove
ğ‘– , Ëœğ‘‰â€²
Ëœğ‘ˆğ‘–
Ëœğ‘‰ğ‘–
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ \ {ğ‘–} : Vf
Ëœğ‘Ÿğ‘– , Ëœğ‘Ÿâ€²
ğ‘– â†$ Zğ‘
( Ëœğ‘ˆğ‘– , Ëœğ‘‰ğ‘–) :=
(cid:32) ğº,
,ğ‘—âˆˆğ‘ƒâˆª{0}ğ‘‰
(cid:18)
(cid:32)
ensure Vf(cid:0)crs, (ğº, ğ‘ˆ0), ğœ‹1,0(cid:1)
(cid:18)ğ‘—âˆˆğ‘ƒâˆª{0}ğ‘ˆ
(cid:16)ğ‘ˆ Ëœğ‘Ÿğ‘– , ğ‘‰ Ëœğ‘Ÿğ‘–(cid:17) , ( Ëœğ‘ˆ â€²
(cid:18)
(cid:19)
(cid:18)ğ‘ˆ