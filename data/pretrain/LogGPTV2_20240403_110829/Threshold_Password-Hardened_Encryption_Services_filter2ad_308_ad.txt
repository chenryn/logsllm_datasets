### ä¼˜åŒ–åçš„æ–‡æœ¬

#### å®šä¹‰å’Œå£°æ˜
æˆ‘ä»¬å®šä¹‰ä»¥ä¸‹æ¦‚ç‡ï¼š
\[
\Pr[\Pi, A, Q_{\text{Dec}}, \text{PW}(1^\lambda, 1^m, 1^t) = 1] - \Pr[\Pi, A, Q_{\text{Dec}}, \text{PW}(1^\lambda, 1^m, 1^t) = 1 \mid Q_{\text{Dec}} \leq |PW| + \text{negl}(\lambda)].
\]
æˆ‘ä»¬å°†é€šè¿‡å…¸å‹çš„æ··åˆè®ºè¯æ¥è¯æ˜ä¸Šè¿°é™ˆè¿°ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å®šä¹‰ä»¥ä¸‹æ··åˆå®éªŒï¼š

1. **Hyb_ğ‘,0**ï¼šä¸Hid_ğ‘å®Œå…¨ç›¸åŒã€‚
2. **Hyb_ğ‘,1**ï¼šä¸Hyb_ğ‘,0å‡ ä¹ç›¸åŒï¼Œåªæ˜¯æ‰€æœ‰é›¶çŸ¥è¯†è¯æ˜éƒ½æ˜¯é€šè¿‡NIZKPoKæ–¹æ¡ˆçš„æ¨¡æ‹Ÿå™¨ç”Ÿæˆçš„ã€‚åˆ©ç”¨NIZKPoKæ–¹æ¡ˆçš„é›¶çŸ¥è¯†å±æ€§ï¼Œå¯ä»¥ç›´è§‚åœ°è¯æ˜ï¼š
   \[
   \left| \Pr[\text{Hyb}_ğ‘,0 = 1] - \Pr[\text{Hyb}_ğ‘,1 = 1] \right| \leq \text{negl}(\lambda).
   \]
3. **Hyb_ğ‘,2**ï¼šä¸Hyb_ğ‘,1å‡ ä¹ç›¸åŒï¼Œä½†åœ¨è¯šå®å¯†é’¥æ—‹è½¬è¢«è§¦å‘æ—¶ï¼ˆå³å¯¹æ‰‹æŸ¥è¯¢RotateO Oracleå¹¶è®¾ç½®HonestRot = 1ï¼‰ï¼Œç§˜å¯†å¯†é’¥ç»„ä»¶ï¼ˆ\(k_i, K_0, \{\bar{K}_j\}_{j=0}^{t-1}\)ï¼‰æ˜¯æ–°ç”Ÿæˆçš„ã€‚å¯¹äºæ‰€æœ‰ \(b \in \{0, 1\}\)ï¼ŒHyb_ğ‘,1 å’Œ Hyb_ğ‘,2 åœ¨åŠŸèƒ½ä¸Šç­‰ä»·ï¼Œå› æ­¤ï¼š
   \[
   \Pr[\text{Hyb}_ğ‘,1 = 1] = \Pr[\text{Hyb}_ğ‘,2 = 1].
   \]
4. **Hyb_ğ‘,3,0**ï¼šä¸Hyb_ğ‘,2å®Œå…¨ç›¸åŒã€‚
5. **Hyb_ğ‘,3,ğ‘**ï¼Œå…¶ä¸­ \(q \in [Q_{\text{Dec}}]\)ï¼Œä¸Hyb_ğ‘,ğ‘âˆ’1å‡ ä¹ç›¸åŒï¼Œä½†å½“å›ç­”å¯¹æ‰‹çš„ç¬¬ğ‘æ¬¡æŸ¥è¯¢åˆ°DecO Oracleå¹¶è§¦å‘è®¡æ•°å™¨DecCountå¢åŠ æ—¶ï¼ˆç§°ä¸ºå…³é”®æŸ¥è¯¢ï¼‰ï¼Œè¯šå®æ–¹å‘é€çš„ç¾¤å…ƒç´ è¢«æ›¿æ¢ä¸ºå‡åŒ€éšæœºç”Ÿæˆçš„å…ƒç´ ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºæŸäº›ç”±æœåŠ¡å™¨é‡‡æ ·çš„éšæœºæ•° \(\bar{\beta}_0, \ldots, \bar{\beta}_{t-1}, \gamma, \bar{\delta}_0, \ldots, \bar{\delta}_{t-1}\)ï¼š
   \[
   \forall j \in [0, t-1], \quad \forall i \in [m],
   \]
   \[
   K'_0 = G^{k'_0} = K_0^\gamma, \quad \bar{S}'_j = \bar{S}_j G^{\bar{\delta}_j}, \quad \bar{K}'_j = \bar{K}_j^\gamma G^{\bar{\beta}_j},
   \]
   \[
   S' = \prod_{j=0}^{t-1} \bar{S}'_{i,j}, \quad K' = \prod_{j=0}^{t-1} \bar{K}'_{i,j}.
   \]

#### æ›´æ–°ä»¤ç‰Œ
ç»™å®šæ›´æ–°ä»¤ç‰Œ \((s_0, s'_0)\) å’Œä¸€ä¸ªnonce \(n\)ï¼ŒæœåŠ¡å™¨å¯ä»¥å°†æ¯ä¸ª \(C \in \text{SKE.Enc}(s_0, (C_0, C_1))\) æ›´æ–°ä¸º \(C' \leftarrow \text{SKE.Enc}(s'_0, (C'_0, C'_1))\)ï¼Œå…¶ä¸­ï¼š
\[
C'_0 := C_0 \cdot H_0(n)^{\bar{\beta}_0}, \quad C'_1 := C_1 \cdot H_1(n)^{\bar{\beta}_0}.
\]

#### æ­£ç¡®æ€§å’Œå®‰å…¨æ€§
æˆ‘ä»¬çš„æ„é€ çš„æ­£ç¡®æ€§åŸºäºSKEçš„æ­£ç¡®æ€§å’Œé™„å½•A.2ä¸­æè¿°çš„NIZKPoKæ–¹æ¡ˆçš„å®Œæ•´æ€§ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬é™ˆè¿°æˆ‘ä»¬çš„æ„é€ çš„å®‰å…¨æ€§ï¼Œå¹¶æä¾›ä¸€ä¸ªè¯æ˜è‰å›¾ã€‚

**å®šç† 3.1ï¼ˆéšè—æ€§ï¼‰**ï¼šå¦‚æœå†³ç­–æ€§Diffie-Hellman (DDH) å‡è®¾å¯¹GGenæˆç«‹ï¼Œå¹¶ä¸”SKEæ˜¯CCAå®‰å…¨çš„ï¼Œé‚£ä¹ˆä¸Šè¿°æ„é€ çš„ \((t, m)\)-PHE æ–¹æ¡ˆåœ¨éšæœºé¢„è¨€æ¨¡å‹ä¸­æ˜¯åŠé€‚åº”éšè—çš„ã€‚

**è¯æ˜**ï¼šé¦–å…ˆï¼Œå¹¿ä¸ºäººçŸ¥çš„å¹¿ä¹‰Schnorråè®®[17]ï¼ˆè§å›¾7ï¼‰æ˜¯åœ¨éšæœºé¢„è¨€æ¨¡å‹ä¸­å¯¹äºå…³ç³» \(R_{\text{GDL}}\) çš„å®Œç¾é›¶çŸ¥è¯†NIZKPoKã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¯¹NIZKPoKè¿›è¡Œé¢å¤–å‡è®¾ã€‚

æˆ‘ä»¬éœ€è¦è¯æ˜è¯¥æ„é€ åœ¨åŠé€‚åº”è…è´¥ä¸‹æ˜¯éšè—çš„ã€‚å³ï¼Œå¯¹äºä»»ä½•å¤šé¡¹å¼æ—¶é—´ç®—æ³•å¯¹æ‰‹ \(A\) å’Œä»»ä½•æ•´æ•° \(Q_{\text{Dec}} \geq 0\)ï¼Œæœ‰ï¼š
\[
\left| \Pr[\Pi, A, Q_{\text{Dec}}, \text{PW}(1^\lambda, 1^m, 1^t) = 1] - \Pr[\Pi, A, Q_{\text{Dec}}, \text{PW}(1^\lambda, 1^m, 1^t) = 1 \mid Q_{\text{Dec}} \leq |PW| + \text{negl}(\lambda)] \right| \leq \text{negl}(\lambda).
\]

#### è¯¦ç»†æ­¥éª¤
1. **æœåŠ¡å™¨è§£å¯†**ï¼š
   \[
   \text{Server S("dec", sk0, pw, } n, C)
   \]
   ç¡®ä¿ \(\text{KVf}(0, \text{sk0})\) æˆç«‹ã€‚
   \[
   (C_0, C_1) \leftarrow \text{SKE.Dec}(s_0, C)
   \]
   ç¡®ä¿ \((C_0, C_1) \neq \bot\)ã€‚
   \[
   X_0 := H_0(n), \quad X_1 := H_1(n)
   \]
   \[
   Y^{-1}_{0,0} := C_0^{-1}
   \]
   è®¡ç®— \(Z := Y^{-1}_{0,0} \cdot H_0(\text{pw}, n)\) çš„åŠ å¯†ã€‚
   \[
   K := K_0 \cdot \bar{K}_0
   \]
   \[
   r_0 \leftarrow \mathbb{Z}_p, \quad (U_0, V_0) := (G^{r_0}, K^{r_0} \cdot Y^{-1}_{0,0})
   \]

2. **é€Ÿç‡é™åˆ¶å™¨**ï¼š
   \[
   \text{Rate-limiter R}_i("dec", \text{sk}_i), \quad \forall i \in [m]
   \]
   ç¡®ä¿ \(\text{KVf}(i, \text{sk}_i)\) æˆç«‹ã€‚
   \[
   n
   \]
   \[
   X_0 := H_0(n), \quad X_1 := H_1(n)
   \]
   \[
   Y_{i,0} := X_0^{s_i}
   \]
   å¯¹äºæŸä¸ª \(t\)-å­é›† \(P \subseteq [m]\)ï¼Œè®¡ç®— \((Z^{\tilde{r}}, Z^{\tilde{r}'} \cdot H_1(\text{pw}, n) \cdot H_1(n)^{\sum_{i \in P} \lambda_{P,i} s_i})\) çš„åŠ å¯†ï¼Œå…¶ä¸­ \(\tilde{r}\) å’Œ \(\tilde{r}'\) æ˜¯éšæœºæ•°ã€‚

3. **éªŒè¯**ï¼š
   \[
   \pi_{1,0} \leftarrow \text{Prove}(crs, (G, U_0), r_0)
   \]
   \[
   \forall j \in [m]: \text{Vf}(crs, (G, U_j), \pi_{1,j}) = 1
   \]
   \[
   P := \text{Subset}_t(P)
   \]
   \[
   \pi_{2,0} \leftarrow \text{Prove}(crs, (U, \tilde{U}_0), \tilde{r}_0)
   \]
   \[
   \pi'_{2,0} \leftarrow \text{Prove}(crs, (U, \tilde{U}'_0), \tilde{r}'_0)
   \]
   \[
   \forall j \in P: \text{Vf}(crs, (\tilde{U}_j, \tilde{V}_j), \pi_{2,j}) = 1
   \]
   \[
   \forall j \in P: \text{Vf}(crs, (\tilde{U}'_j, \tilde{V}'_j), \pi'_{2,j}) = 1
   \]

4. **è¿›ä¸€æ­¥éªŒè¯**ï¼š
   \[
   \text{ç¡®ä¿ } \forall j \in P \setminus \{i\}: \text{Vf}(crs, (U_j, V_j), \pi_{1,j}) = 1
   \]
   \[
   \tilde{r}_i, \tilde{r}'_i \leftarrow \mathbb{Z}_p
   \]
   \[
   (\tilde{U}_i, \tilde{V}_i) := (G^{\tilde{r}_i}, K^{\tilde{r}_i} \cdot Y_{i,0})
   \]
   \[
   \pi_{2,i} \leftarrow \text{Prove}(crs, (U, \tilde{U}_i), \tilde{r}_i)
   \]
   \[
   \pi'_{2,i} \leftarrow \text{Prove}(crs, (U, \tilde{U}'_i), \tilde{r}'_i)
   \]

é€šè¿‡è¿™äº›æ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿æ•´ä¸ªç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚