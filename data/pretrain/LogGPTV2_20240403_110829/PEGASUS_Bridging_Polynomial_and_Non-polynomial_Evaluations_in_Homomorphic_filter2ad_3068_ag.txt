The authors would like to thank the anonymous reviewers
of this paper for their insightful comments. The authors
would also like to thank Hao Chen, Ph.D. from Facebook
for helpful discussions on CHIMERA and TFHE.
REFERENCES
[1] M. R. Albrecht, R. Player, and S. Scott, “On the concrete
hardness of learning with errors,” J. Mathematical Cryptol-
ogy, vol. 9, no. 3, pp. 169–203, 2015.
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:25:55 UTC from IEEE Xplore.  Restrictions apply. 
1069
[2] K. E. Batcher, “Sorting networks and their applications,” in
American Federation of Information Processing Societies:
AFIPS Conference Proceedings: 1968 Spring Joint Computer
Conference, Atlantic City, USA, 30 April - 2 May 1968, pp.
307–314.
[3] J. W. Bos, K. E. Lauter, and M. Naehrig, “Private predictive
analysis on encrypted medical data,” J. Biomed. Informatics,
vol. 50, pp. 234–243, 2014.
[4] J. Bossuat, C. Mouchet, J. R. Troncoso-Pastoriza, and
J. Hubaux, “Efﬁcient bootstrapping for approximate homo-
morphic encryption with non-sparse keys,” IACR Cryptol.
ePrint Arch., vol. 2020, p. 1203, 2020.
[5] R. Bost, R. A. Popa, S. Tu, and S. Goldwasser, “Machine
learning classiﬁcation over encrypted data,” in 22nd Annual
Network and Distributed System Security Symposium, NDSS
2015, San Diego, USA, February 8-11, 2015.
[6] C. Boura, N. Gama, M. Georgieva, and D. Jetchev, “Simulat-
ing homomorphic evaluation of deep learning predictions,” in
Cyber Security Cryptography and Machine Learning - Third
International Symposium, CSCML 2019, Beer-Sheva, Israel,
June 27-28, 2019, Proceedings, pp. 212–230.
[7] ——, “Chimera: Combining ring-lwe-based fully homomor-
phic encryption schemes,” Journal of Mathematical Cryptol-
ogy, vol. 14, no. 1, pp. 316 – 338, 2020.
[8] Z. Brakerski, C. Gentry, and V. Vaikuntanathan, “(Leveled)
fully homomorphic encryption without bootstrapping,” in In-
novations in Theoretical Computer Science 2012, Cambridge,
USA, January 8-10, 2012, pp. 309–325.
[9] H. Chen, I. Chillotti, and Y. Song, “Improved bootstrapping
for approximate homomorphic encryption,” in Advances in
Cryptology - EUROCRYPT 2019 - 38th Annual International
Conference on the Theory and Applications of Cryptographic
Techniques, Darmstadt, Germany, May 19-23, 2019, Proceed-
ings, Part II, pp. 34–54.
[10] H. Chen, W. Dai, M. Kim, and Y. Song, “Efﬁcient multi-key
homomorphic encryption with packed ciphertexts with appli-
cation to oblivious neural network inference,” in Proceedings
of the 2019 ACM SIGSAC Conference on Computer and
Communications Security, CCS 2019, London, UK, November
11-15, 2019, pp. 395–412.
[11] ——, “Efﬁcient homomorphic conversion between (ring)
LWE ciphertexts,” IACR Cryptol. ePrint Arch., vol. 2020,
p. 15, 2020.
[12] J. H. Cheon, K. Han, A. Kim, M. Kim, and Y. Song,
“Bootstrapping for approximate homomorphic encryption,” in
Advances in Cryptology - EUROCRYPT 2018 - 37th Annual
International Conference on the Theory and Applications of
Cryptographic Techniques, Tel Aviv, Israel, April 29 - May 3,
2018 Proceedings, Part I, pp. 360–384.
[13] J. H. Cheon, S. Hong, and D. Kim, “Remark on the security
of ckks scheme in practice,” IACR Cryptol. ePrint Arch., vol.
2020, p. 1581, 2020.
[14] J. H. Cheon, A. Kim, M. Kim, and Y. S. Song, “Homomor-
phic encryption for arithmetic of approximate numbers,” in
ASIACRYPT 2017, Hong Kong, China, December 3-7, 2017,
pp. 409–437.
[15] J. H. Cheon, D. Kim, and D. Kim, “Efﬁcient homomor-
phic comparison methods with optimal complexity,” in ASI-
ACRYPT 2020, Daejeon, South Korea, December 7-11, 2020,
pp. 221–256.
[16] J. H. Cheon, D. Kim, D. Kim, H. Lee, and K. Lee, “Numer-
ical method for comparison on homomorphically encrypted
numbers,” in ASIACRYPT 2019, Kobe, Japan, December 8-
12, 2019, pp. 415–445.
[17] J. H. Cheon, D. Kim, and J. H. Park, “Towards a practical
clustering analysis over encrypted data,” IACR Cryptol. ePrint
Arch., vol. 2019, p. 465, 2019.
[18] I. Chillotti, N. Gama, M. Georgieva, and M. Izabach`ene,
“TFHE: fast fully homomorphic encryption over the torus,”
J. Cryptology, vol. 33, no. 1, pp. 34–91, 2020.
[19] “CHIMERA
Implementation,”
team
2020,
https://github.com/DPPH/chimera-iDash2018,
CEA-EPFL-Inpher: code for the iDash 2018 competition.
[20] A. Costache and N. P. Smart, “Which ring based somewhat
homomorphic encryption scheme is best?” in Topics in Cryp-
tology - CT-RSA 2016 - The Cryptographers’ Track at the
RSA Conference 2016, San Francisco, USA, February 29 -
March 4, 2016, Proceedings, pp. 325–340.
[21] R. Dathathri, B. Kostova, O. Saarikivi, W. Dai, K. Laine,
and M. Musuvathi, “EVA: an encrypted vector arithmetic
language and compiler for efﬁcient homomorphic computa-
tion,” in Proceedings of the 41st ACM SIGPLAN International
Conference on Programming Language Design and Imple-
mentation, PLDI 2020, London, UK, June 15-20, 2020, pp.
546–561.
[22] R. Dathathri, O. Saarikivi, H. Chen, K. Laine, K. E. Lauter,
S. Maleki, M. Musuvathi, and T. Mytkowicz, “CHET: an
optimizing compiler for fully-homomorphic neural-network
inferencing,” in Proceedings of
the 40th ACM SIGPLAN
Conference on Programming Language Design and Imple-
mentation, PLDI 2019, Phoenix, USA, June 22-26, 2019, pp.
142–156.
[23] D. Dua and C. Graff, “UCI machine learning repository,”
2017. [Online]. Available: http://archive.ics.uci.edu/ml
[24] L. Ducas and D. Micciancio, “FHEW: bootstrapping homo-
morphic encryption in less than a second,” in EUROCRYPT
2015, Soﬁa, Bulgaria, April 26-30, 2015, pp. 617–640.
[25] N. Emmadi, P. Gauravaram, H. Narumanchi, and H. Syed,
“Updates on sorting of fully homomorphic encrypted data,” in
2015 International Conference on Cloud Computing Research
and Innovation, ICCCRI 2015, Singapore, October 26-27,
2015, pp. 19–24.
[26] J. Fan and F. Vercauteren, “Somewhat practical fully homo-
morphic encryption,” IACR Cryptol. ePrint Arch., vol. 2012,
p. 144, 2012.
[27] C. Gentry, S. Halevi, and N. P. Smart, “Homomorphic evalu-
ation of the AES circuit,” in CRYPTO 2012, Santa Barbara,
USA, August 19-23, 2012., pp. 850–867.
[28] C. Gentry, A. Sahai, and B. Waters, “Homomorphic en-
cryption from learning with errors: conceptually-simpler,
asymptotically-faster, attribute-based,” in CRYPTO 2013,
Santa Barbara, USA, August 18-22, 2013., pp. 75–92.
[29] R. Gilad-Bachrach, N. Dowlin, K. Laine, K. E. Lauter,
M. Naehrig, and J. Wernsing, “CryptoNets: Applying neural
networks to encrypted data with high throughput and accu-
racy,” in ICML 2016, New York City, USA, June 19-24, 2016,
pp. 201–210.
[30] S. Halevi and V. Shoup, “Algorithms in HElib,” in Advances
in Cryptology - CRYPTO 2014 - 34th Annual Cryptology
Conference, Santa Barbara, USA, August 17-21, 2014, Pro-
ceedings, Part I, pp. 554–571.
[31] ——, “Faster homomorphic linear transformations in HElib,”
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:25:55 UTC from IEEE Xplore.  Restrictions apply. 
1070
in CRYPTO 2018, Santa Barbara, USA, August 19-23, 2018,
pp. 93–120.
[32] K. Han, M. Hhan, and J. H. Cheon, “Improved homomorphic
discrete fourier transforms and FHE bootstrapping,” IEEE
Access, vol. 7, pp. 57 361–57 370, 2019.
[33] K. Han and D. Ki, “Better bootstrapping for approximate
homomorphic encryption,” in Topics in Cryptology - CT-RSA
2020 - The Cryptographers’ Track at the RSA Conference
2020, San Francisco, USA, February 24-28, 2020, Proceed-
ings, pp. 364–390.
[34] A. J¨aschke and F. Armknecht, “Unsupervised machine learn-
ing on encrypted data,” in Selected Areas in Cryptography
2018, Calgary, Canada, August 15-17, 2018, Revised Selected
Papers, pp. 453–478.
[35] Jianchao Yang, Kai Yu, Yihong Gong, and T. Huang, “Linear
spatial pyramid matching using sparse coding for image
classiﬁcation,” in 2009 IEEE Conference on Computer Vision
and Pattern Recognition, 2009, pp. 1794–1801.
[36] W. jie Lu, S. Kawasaki, and J. Sakuma, “Using fully ho-
momorphic encryption for statistical analysis of categorical,
ordinal and numerical data,” in 24th Annual Network and
Distributed System Security Symposium, NDSS 2017, San
Diego, USA, February 26 - March 1, 2017.
[37] W. jie Lu, J. Zhou, and J. Sakuma, “Non-interactive and
output expressive private comparison from homomorphic
encryption,” in AsiaCCS 2018, Incheon, Republic of Korea,
June 04-08, 2018, pp. 67–74.
[38] C.
Juvekar, V. Vaikuntanathan, and A. Chandrakasan,
“GAZELLE: A low latency framework for secure neural
network inference,” in USENIX Security 2018, Baltimore,
USA, August 15-17, 2018, pp. 1651–1669.
[39] M. Kim, Y. Song, S. Wang, Y. Xia, and X. Jiang, “Secure
logistic regression based on homomorphic encryption,” IACR
Cryptol. ePrint Arch., vol. 2018, p. 74, 2018.
´A. Kiss, M. Naderpour, J. Liu, N. Asokan, and T. Schneider,
“Sok: Modular and efﬁcient private decision tree evaluation,”
PoPETs, vol. 2019, no. 2, pp. 187–208.
[40]
[41] B. Li and D. Micciancio, “On the security of homomorphic
encryption on approximate numbers,” IACR Cryptol. ePrint
Arch., vol. 2020, p. 1533, 2020.
[42] C. A. Melchor, J. Barrier, L. Fousse, and M. Killijian, “XPIR
: Private information retrieval for everyone,” PoPETs, vol.
2016, no. 2, pp. 155–174.
[43] D. Micciancio and Y. Polyakov, “Bootstrapping in FHEW-
like cryptosystems,” IACR Cryptol. ePrint Arch., vol. 2020,
p. 86, 2020.
[44] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel,
B. Thirion, O. Grisel, M. Blondel, P. Prettenhofer, R. Weiss,
V. Dubourg, J. Vanderplas, A. Passos, D. Cournapeau,
M. Brucher, M. Perrot, and E. Duchesnay, “Scikit-learn:
Machine learning in Python,” Journal of Machine Learning
Research, vol. 12, pp. 2825–2830, 2011.
[45] F. Rao, B. K. Samanthula, E. Bertino, X. Yi, and D. Liu,
“Privacy-preserving and outsourced multi-user k-means clus-
tering,” in Conference on Collaboration and Internet Comput-
ing 2015, Hangzhou, China, October 27-30, 2015, pp. 80–89.
[46] M. Scott, “A note on the implementation of the number
theoretic transform,” in Cryptography and Coding - 16th
IMA International Conference, IMACC 2017, Oxford, UK,
December 12-14, 2017, Proceedings, pp. 247–258.
[47] “Microsoft
3.5),”
https://github.com/Microsoft/SEAL, Apr. 2020, microsoft
Research, Redmond, WA.
(release
SEAL
[48] N. P. Smart and F. Vercauteren, “Fully homomorphic encryp-
tion with relatively small key and ciphertext sizes,” in Public
Key Cryptography 2010, Paris, France, May 26-28, 2010., pp.
420–443.
[49] ——, “Fully homomorphic SIMD operations,” Des. Codes
Cryptogr., vol. 71, no. 1, pp. 57–81, 2014.
[50] R. K. H. Tai, J. P. K. Ma, Y. Zhao, and S. S. M. Chow,
“Privacy-preserving decision trees evaluation via linear func-
tions,” in ESORICS 2017, Oslo, Norway, September 11-15,
2017, pp. 494–512.
[51] A. Tueno, Y. Boev, and F. Kerschbaum, “Non-interactive
private decision tree evaluation,” in DBSec 2020, Regensburg,
Germany, June 25-26, 2020, pp. 174–194.
APPENDIX
A. Operations of the RNS Variant of the CKKS Scheme
We give the details of the CKKS operations used in
primes q0, q1,··· , qL−1. Let Qi =(cid:81)i
PEGASUS.
• Setup. Dimension n is a 2-power value. L > 0 distinct
k=0 qi for all i ∈ (cid:104)L(cid:105).
The error distribution χerr is deﬁned as the centered dis-
crete normal distribution of standard deviation σckks > 0.
The encryption distribution χenc is deﬁned as the uniform
distribution over {0,±1}n.
• KeyGen. Sample the secret key s from {0,±1}n. Set
the public key pk ∈ RLWEn,QL−1
(0), i.e., a RLWE sample
of zero.
• Encryption. On a plaintext ˆm ∈ Rn,QL−1, computes
ct = ( ˆm + ˆe, 0) + ˆu · pk ∈ RLWEn,QL−1
( ˆm), where the
coefﬁcients of ˆe ∈ Rn,QL−1 are sampled from χerr and ˆu ∈
Rn,QL−1 are sampled from χenc.
• Extended Encryption. On a plaintext ˆm ∈ Rn,QL−1,
and a gadget g ∈ Zd, compute a set of RLWE samples
s
s
s
(c0,··· , cd−1) ∈
s
(cid:94)RLWE
n,QL−1
s
( ˆm; g)
(g[i] · ˆm) for i ∈ (cid:104)d(cid:105).
s
n,Ql
s
( ˆm + ˆm(cid:48)).
where ci ∈ RLWEn,QL−1
• Decryption. On the ciphertext ct = (c0, c1) ∈ R2
for any l ∈ (cid:104)L(cid:105), compute and output c0 + c1 · s ∈ Rn,Ql.
• Addition. On the ciphertexts (c0, c1) ∈ RLWEn,Ql
( ˆm)
( ˆm(cid:48)) for any l ∈ (cid:104)L(cid:105), compute
and (c(cid:48)0, c(cid:48)1) ∈ RLWEn,Ql
(c0 + c(cid:48)0, c1 + c(cid:48)1) ∈ RLWEn,Ql
s
• Multiplication. On
the
∈
( ˆm(cid:48)) and a relin-
RLWEn,Ql
earization key RelK ∈
(s2; g), for any l ∈ (cid:104)L(cid:105),
ﬁrst compute ˜c0 = c0·c(cid:48)0, ˜c1 = c0·c(cid:48)1 +c1·c(cid:48)0 and ˜c2 = c1·c(cid:48)1.
Then output (˜c0, ˜c1) + ˜c2 (cid:5) RelK ∈ RLWEn,Ql
• Rotation.
∈
RLWEn,Ql
∈
s
(cid:94)RLWE
n,Ql
(cid:104)L(cid:105),
compute
∈
s
(Ecd (m ≪ k)).
(φk(c0), 0) + c1 (cid:5) RotKk ∈ RLWEn,Ql
( ˆm · ˆm(cid:48)).
ciphertext
(c0, c1)
rotation key RotKk
( ˆm) and (c(cid:48)0, c(cid:48)1) ∈ RLWEn,Ql
On
(Ecd (m))
(φk(s); g),
the
and a
for
ciphertexts
(cid:94)RLWE
any l
(c0, c1)
s
n,Ql
s
s
s
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:25:55 UTC from IEEE Xplore.  Restrictions apply. 
1071