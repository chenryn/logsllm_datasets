title:Poster: A Reliable and Accountable Privacy-Preserving Federated
Learning Framework using the Blockchain
author:Sana Awan and
Fengjun Li and
Bo Luo and
Mei Liu
1
2
0
2
b
e
F
1
]
R
C
.
s
c
[
4
v
3
9
8
0
1
.
6
0
9
1
:
v
i
X
r
a
This paper appears in IEEE Internet of Things Journal (IoT-J). Please feel free to contact us for questions or remarks.
Privacy-Preserving Blockchain-Based Federated
Learning for IoT Devices
Yang Zhao, Student Member, IEEE, Jun Zhao, Member, IEEE, Linshan Jiang, Student Member, IEEE,
Rui Tan, Senior Member, IEEE, Dusit Niyato, Fellow, IEEE, Zengxiang Li, Member, IEEE,
Lingjuan Lyu, Member, IEEE, and Yingbo Liu, Member, IEEE
Abstract—Home appliance manufacturers strive to obtain feed-
back from users to improve their products and services to build a
smart home system. To help manufacturers develop a smart home
system, we design a federated learning (FL) system leveraging
a reputation mechanism to assist home appliance manufacturers
to train a machine learning model based on customers’ data.
Then, manufacturers can predict customers’ requirements and
consumption behaviors in the future. The working ﬂow of the
system includes two stages: in the ﬁrst stage, customers train
the initial model provided by the manufacturer using both the
mobile phone and the mobile edge computing (MEC) server.
Customers collect data from various home appliances using
phones, and then they download and train the initial model with
their local data. After deriving local models, customers sign on
their models and send them to the blockchain. In case customers
or manufacturers are malicious, we use the blockchain to replace
the centralized aggregator in the traditional FL system. Since
records on the blockchain are untampered, malicious customers
or manufacturers’ activities are traceable. In the second stage,
manufacturers select customers or organizations as miners for
calculating the averaged model using received models from
customers. By the end of the crowdsourcing task, one of the
miners, who is selected as the temporary leader, uploads the
model to the blockchain. To protect customers’ privacy and
improve the test accuracy, we enforce differential privacy on
the extracted features and propose a new normalization tech-
nique. We experimentally demonstrate that our normalization
technique outperforms batch normalization when features are
under differential privacy protection. In addition, to attract more
customers to participate in the crowdsourcing FL task, we design
an incentive mechanism to award participants.
Index Terms—Blockchain, Crowdsourcing, Differential pri-
vacy, Federated learning, IoT, Mobile edge computing.
Yang Zhao and Jun Zhao are supported by 1) Nanyang Technological
University (NTU) Startup Grant, 2) Alibaba-NTU Singapore Joint Research
Institute (JRI), 3) Singapore Ministry of Education Academic Research Fund
Tier 1 RG128/18, Tier 1 RG115/19, Tier 1 RT07/19, Tier 1 RT01/19,
and Tier 2 MOE2019-T2-1-176, 4) NTU-WASP Joint Project, 5) Singapore
National Research Foundation (NRF) under its Strategic Capability Research
Centres Funding Initiative: Strategic Centre for Research in Privacy-Preserving
Technologies & Systems (SCRIPTS), 6) Energy Research Institute @NTU
(ERIAN), 7) Singapore NRF National Satellite of Excellence, Design Science
and Technology for Secure Critical Infrastructure NSoE DeST-SCI2019-0012,
8) AI Singapore (AISG) 100 Experiments (100E) programme, and 9) NTU
Project for Large Vertical Take-Off & Landing (VTOL) Research Platform.
Linshan Jiang and Rui Tan are supported by the MOE AcRF Tier 1 grant
2019-T1-001-044. Dusit Niyato is supported by the National Research Foun-
dation (NRF), Singapore, under Singapore Energy Market Authority (EMA),
Energy Resilience, NRF2017EWT-EP003-041, Singapore NRF2015-NRF-
ISF001-2277, Singapore NRF National Satellite of Excellence, Design Science
and Technology for Secure Critical Infrastructure NSoE DeST-SCI2019-0007,
A*STAR-NTU-SUTD Joint Research Grant on Artiﬁcial Intelligence for the
Future of Manufacturing RGANS1906, Wallenberg AI, Autonomous Systems
and Software Program and Nanyang Technological University (WASP/NTU)
under grant M4082187 (4080), and Alibaba Group through Alibaba Inno-
vative Research (AIR) Program and Alibaba-NTU Singapore Joint Research
Institute (JRI), NTU-Singapore, Singapore Ministry of Education (MOE) Tier
1 (RG16/20). Zengxiang Li is partially supported by RIE 2020 Advanced
Manufacturing and Engineering (AME) Domain’s Core Funds-SERC Strategic
Funds: Trusted Data Vault (Phase 1) (Grant No. A1918g0063). Yingbo Liu is
supported by National Natural Science Foundation of China (No. 11703010)
(Corresponding author: Yingbo Liu).
Yang Zhao, Jun Zhao, Linshan Jiang, Rui Tan and Dusit Niyato
are with School of Computer Science and Engineering, Nanyang Tech-
nological University, Singapore, 639798. (Emails: PI:EMAIL,
PI:EMAIL,
PI:EMAIL, dniy-
PI:EMAIL).
PI:EMAIL,
Zengxiang Li is with the Institute of High Performance Computing (IHPC),
A*STAR, Singapore. (Email: zengxiang PI:EMAIL).
Lingjuan Lyu is with the Department of Computer Science, National
University of Singapore. (Email: PI:EMAIL).
Yingbo Liu is with Big Data Research Institute of Yunnan Economy and
Society, Yunnan University of Finance and Economics Kunming, China,
650201. (Email: PI:EMAIL).
I. INTRODUCTION
Internet of Things (IoT)-enabled smart home systems have
gained great popularity in the last few years since they have
an aim to increase the quality of life. A report by Statista [1]
estimates that by 2022, the smart home market size around
the world will be 53.3 billion. This smart home concept
is mainly enabled by IoT devices, smart phone, modern
wireless communications, cloud & edge computing, big data
analytics, and artiﬁcial intelligence (AI). In particular, these
advanced technologies enable manufacturers to maintain a
seamless connection among their smart home appliances. With
the proliferation of smart home devices,
tremendous data
are generated. Federated learning (FL) enables analysts to
analyze and utilize the locally generated data in a decentralized
way without requiring uploading data to a centralized server;
that is, the utility of data are well maintained despite data
are preserved locally. To help home appliance manufacturers
smartly and conveniently use data generated in customers’
appliances, we design an FL-based system. Our system con-
siders home appliances of the same brand in a family as a
unit, and a mobile phone is used to collect data from home
appliances periodically and train the machine learning model
locally [2]. Since mobile phones have limited computational
power and battery life, we ofﬂoad part of the training task to
the edge computing sever. Then, the blockchain smart contract
is leveraged to generate a global model by averaging the sum
of locally trained models submitted by users. In this federated
way, source data are supposed to maintain security and privacy.
However, Melis et al. [3] demonstrated that gradient updates
might leak signiﬁcant information about customers’ training
1
This paper appears in IEEE Internet of Things Journal (IoT-J). Please feel free to contact us for questions or remarks.
data. Attackers can recover data from gradients uploaded by
customers [4]. Besides, the federated approach for training the
model is susceptible to model poisoning attacks [5]. In addi-
tion, information leakage risks exist in the third party’s mobile
edge computing (MEC) server [6]. To address aforementioned
security and privacy issues, we adopt blockchain and differen-
tial privacy. It is worth noting Apple is successfully applying
differential privacy in FL to improve the privacy of its popular
voice assistant service Siri [7]. Speciﬁcally, manufacturers
upload a preliminary model with initialized parameters. The
model is available on the blockchain for customers to down-
load and train with their local data. The blockchain assists the
crowdsourcing requester (i.e. manufacturer) to audit whether
there are malicious updates from customers. The traditional
crowdsourcing system is hosted by a third party, which charges
customers costly service fees, while our designed system
uses blockchain to record crowdsourcing activities. Therefore,
customers and the requester can save high service fees while
keeping the crowdsourcing system functional. Due to the lim-
itation of the block size, we propose to use the InterPlanetary
File System (IPFS) [8] as the distributed storage solution when
the model size is large.
√
N − 1,
within [−√
More speciﬁcally, customers extract their data’s features
in the mobile using the deployed feature extractor and add
noise with a formal privacy guarantee to perturb the ex-
tracted features in the ﬁrst step. In the second step, cus-
tomers train fully connected layers of the model with per-
turbed features in the MEC server. Moreover, we improve
the traditional batch normalization by removing constraints
of mean value and variance, while constraining the bound
N − 1], where N denotes the batch
size. After training, customers sign on hashes of encrypted
models with their private keys and transmit locally trained
models to the blockchain. Selected miners verify identities
of senders, download models and calculate the average of
all model parameters to obtain the global model. One miner,
selected as the temporary leader, encrypts and uploads the
global model to the blockchain. Furthermore, to motivate more
customers to participate in the crowdsourcing task and reduce
malicious and poisoning updates, we utilize a reputation-based
crowdsourcing incentive mechanism, which rewards reliable
customers and punish malicious customers correspondingly.
Contributions. The major contributions of this paper are
summarized as follows:
• First, a hierarchical crowdsourcing FL system is proposed
to build the machine learning model to help home ap-
pliance manufacturers improve their service quality and
optimize functionalities of home appliances.
• Second, we propose a new normalization technique which
delivers a higher test accuracy than batch normalization,
while preserving the privacy of the extracted features of
each participant’s data. Besides, by leveraging differen-
tial privacy, we prevent adversaries from exploiting the
learned model to infer customers’ sensitive information.
• Third, our blockchain-based system prevents malicious
model updates by ensuring that all model updates are
held accountable.
2
Organization. The rest of the paper is organized as follows.
In Section II, we explain the concepts of blockchain and dif-
ferential privacy used in this paper. Section III presents related
work. We introduce our design of the system in Section IV.
Section V shows the advantages and disadvantages of our
designed system. Section VI presents the experimental results
showing that our technique is working. Section VII discusses
how we prevent information leakage using differential privacy
technique in our designed system. Then, we conclude the paper
and identify future directions in Section VIII.
Notations. Notations used in the rest of the paper are
summarized in Table I.
Table I: Summary of notations
Deﬁnition
differential privacy budget
batch size
mean value of normalized features
variance of normalized features
length of feature
width of feature
each batch
value at a position (cid:104)i, j(cid:105) for
the feature of image k
value at a position (cid:104)i, j(cid:105) for the
feature of image k after batch normalization
value at a position (cid:104)i, j(cid:105) for the
feature of image k after our normalized technique
score
number of updates
Byzantine miners
model update
reputation value
maximal reputation value
average reputation of the participating customers
low evaluation result
high evaluation result
Symbol

N
µ
σ
Lf
Wf
B
Xi,j,k
(cid:101)Xi,j,k
ˆXi,j,k
s
R
f
∆w
γ
γM ax
h
L
H
II. PRELIMINARIES
We organize this section on preliminaries as follows. In
Section II-A, we explain the concepts of blockchain and
InterPlanetary File System. In Sections II-B and II-C, we
introduce the formal deﬁnitions of differential privacy and