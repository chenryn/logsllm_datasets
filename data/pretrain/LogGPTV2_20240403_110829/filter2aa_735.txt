From ROOT 
to SPECIAL  
Hacking IBM 
Mainframes 
Soldier of Fortran 
@mainframed767 
DISCLAIMER! 
All research was done under 
personal time. I am not here 
in the name of, or on behalf 
of, my employer. 
Therefore, any views expressed 
in this talk are my own and 
not those of my employer.  
This talk discusses work 
performed in my spare time 
generally screwing around with 
mainframes and thinking 'what 
if this still works...'  
@mainframed767 
?Question? 
PLAIN  
TXT 
53% 
SSL 
47% 
INTERNET  
MAINFRAMES 
?SSL? 
Self  
Signed 
33% 
No 
Error 
49 
SSL TN3270 
MAINFRAMES 
Bad 
CA 
17% 
Who are you? 
•  Security Guy 
•  Tired of 90’s 
thinking 
•  Eye opening 
experience 
@mainframed767 
PCI 
Security 
Expert 
Mainframe 
Security 
Guru 
ISO 27002 
& PCI 
Certifier 
“What’s  
NETSTAT?” 
- Our Horrible Consultant 
Spoken 
z/OS? WTF 
•  Most popular 
“mainframe” OS 
•  Version 2.1 out 
now! 
Legacy my ass! 
@mainframed767 
z/OS Demo 
•  Let’s take a 
look at this 
thing 
•  It’ll all make 
sense 
@mainframed767 
zOS or PoS? 
•  Hard to tell, 
identifying 
sucks 
•  Scanner have 
“challenges” 
nmap -sV -p 992 
167.xxx.4.2 -Pn 
@mainframed767 
Nmap 6.40 
PORT: 992/tcp    
STATE: open 
SERVICE: ssl 
VERSION: 
IBM OS/390 
@mainframed767 
Nmap 6.46 
PORT: 992/tcp    
STATE: open 
SERVICE: ssl 
VERSION: 
Microsoft 
IIS SSL 
@mainframed767 
CENSORED(
CENSORED(
CENSORED(
CENSORED(
CENSORED(
CENSORED(
Other Methods 
•  Web Servers: 
IBM HTTP Server 
V5R3M0 
FTP Banner 
@mainframed767 
CENSORED(
Lets Break in 
•  Steal Credentials 
•  Web Server 
•  3270 Panels 
– Usin’ BIRP 
@mainframed767 
Ettercap Demo 
@mainframed767 
Missed it 
@mainframed767 
CGI-Bin in 
tyool 2014 
•  REXX / SH still 
used 
•  Injection simple, 
if you know TSO 
commands 
@mainframed767 
@mainframed767 
CENSORED(
CENSORED(
@mainframed767 
B.I.R.P. 
•  Big Iron Recon & 
Pwnage 
– By @singe 
– HITB 2014 
•  3270 is awesome 
@mainframed767 
Standard 3270 
@mainframed767 
BIRP 3270 
@mainframed767 
Only FTP? 
•  No Problem! 
•  FTP lets you run 
JCL (JCL = Script) 
•  Command: 
   SITE FILE=JES 
Access 
Granted 
•  Now we have 
access 
•  FTP Account 
•  Asking someone 
Now what? 
@mainframed767 
Escalate! 
•  Let’s escalate 
our privilege 
•  Connect with 
telnet/ssh/3270 
@mainframed767 
Getroot.rx 
•  rexx script 
•  Leverages 
CVE-2012-5951: 
Unspecified vulnerability in IBM 
Tivoli NetView 1.4, 5.1 through 5.4, 
and 6.1 on z/OS allows local users 
to gain privileges by leveraging 
access to the normal Unix System 
Services (USS) security level. 
Tsk tsk 
•  IBM not really 
being honest 
here 
• Works on any 
setuid REXX 
script! 
@mainframed767 
@mainframed767 
DEMO 
@mainframed767 
DEMO 
THANKS 
•  Swedish Black 
Hat community 
•  Oliver Lavery 
– GDS Security 
•  Logica Breach 
Investigation 
Files 
Keep ACCESS 
•  Get a copy of 
the RACF 
database 
•  John the Ripper 
racf2john racf.db 
john racf_hashes 
@mainframed767 
Steal 
•  Use IRRDBU00 to 
convert RACF to 
flat file 
•  Search for SPECIAL 
accounts 
•  Login with a SPECIAL 
account 
@mainframed767 
IRRDBU00 
CENSORED(
@mainframed767 
Welcome to 
OWN zone 
•  SPECIAL gives 
access to make 
any change to 
users 
•  Add Users 
•  Make others 
SPECIAL, 
OPERATIONS 
@mainframed767 
Giver UID 0 
@mainframed767 
Giver 
SPECIAL 
@mainframed767 
INETD 
@mainframed767 
INETD 
•  Works just like 
Linux 
Kill inetd: 
- ps –ef|grep inetd 
- Kill  
@mainframed767 
Connect with 
NETEBCDICAT 
•  EBCDIC! 
@mainframed767 
•  Use NetEBCDICat 
BPX. Wha? 
•  BPX.SUPERUSER 
– Allows people to 
su to root without 
password 
BPX.SUPERUSER 
•  As SPECIAL user 
type (change userid): 
PERMIT BPX.SUPERUSER 
CLASS(FACILITY) ID(USERID) 
ACCESS(READ) 
And 
SETROPTS GENERIC(FACILITY) 
REFRESH 
Tools 
•  CATSO 
–  TSO Bind/Reverse shell 
•  TSHOCKER 
– Python/JCL/FTP 
wrapper for CATSO 
•  MainTP 
– Python/JCL/FTP 
getroot.rx wrapper 
@mainframed767 
TShocker 
@mainframed767 
Maintp 
•  Uses GETROOT.rx 
+ JCL and FTP 
and NetEBCDICat 
to get a remote 
root shell 
@mainframed767 
Thanks  
•  Logica Breach 
Investigation 
Team 
•  Dominic White 
(@singe) 
•  The community 
Contact 
Twitter 
 @mainframed767 
Email 
 PI:EMAIL 
Websites: 
 Mainframed767.tumblr.com 
 Soldieroffortran.org