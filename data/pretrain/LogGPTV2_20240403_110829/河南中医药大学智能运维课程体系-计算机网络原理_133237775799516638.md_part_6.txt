c3d3
45
.?uE...
r......E
0020
2008d8ef
0035
002b
751eb7ab01
00
01
....5.+u....
0030
77 77 09 77 69 72 6573
..w ww.wires
00406
68 61 72 66 03 6f 72 67
10 00 10 0 0
---
## Page 91
91
64
a0
146726444626364762282923696a7
e7
41
41
00
1f
29
25823307
70248686
f5
08
09
45
00
08194548364869346707034623243836
16461420696156204942201549442896
1406356562665614265154156620366637
10606348421527203265616929652361
088778349762563786363323366
16451124626422:205
1674981860663326462324366661
976282488397183848８243446
03466782652269242889653926462
92199999694999999
18676707
4叶2
681
4206
44466659873241204496
520
3166
258
5667394224368
697
946546
3481362046286
6657
6303
39
20
3a
20
4b
65
65
70
2d
41
6c
69
76
65
Od
Oa
Od
Oa
---
## Page 92
bits)oninterface0
(00:1f:29:02:c
7:f5), Dst: Cisco_41:41:41 (64:a0:e7:41:41:41)
Destinat1on: Cisco_41:41:41 (64 : a0:e7:41:41:41))
Address:Cisco_41:41:41(64:a0:e7:41:41:41)
......0.
= LG bit: Globally unique address (factory default)
.0
= IG bit: Individual address (unicast)
Source:Hewlett-_02:c7:f5(00:1f:29:02:c7:f5)
Address: Hewlett-_02:c7:f5 (00:1f:29:02:c7:f5)
......0.....
.... .... = LG bit: Globally unique address (factory default)
............
........= IG bit: Individual address (unicast)
Type: IP (0x0800)
Internet Protocol Version 4, Src: 192.168.158.195 (192.168.158.195), Dst: 218.28.226.14 (218.28.226.14)
version:4
Header length: 20 bytes
 Differentiated Services Field: OxOo (DsCP OxOO: Default; ECN: OxOO: Not-ECT (Not ECN-capable Transport))
Total Length: 432
Identification: 0x11cb (4555)
 Flags: 0x02 (Don't Fragment)
Fragment_offset: 0
Time to1ive:128
Protocol:TCP（6)
Source: 192.168.158.195 (192.168.158.195)
Destination: 218.28.226.14 (218.28.226.14)
[SourceGeoIP:Unknown]
[Destination GeoIP: Unknown]
Transmission control Protocol. Src Port: 63079 (63079), Dst Port: 9319 (9319), Seq: 1, Ack: 1,Len: 392
source port: 63079 (63079)
Destination port: 9319 (9319)
[stream index: 20]
Sequence number: 1
(relative sequence number)
[Next sequence number: 393
(relative sequence number)]
Acknowledgment number: 1
(relative ack number)
Header length: 20 bytes
 Flags: Ox018 (PSH,ACK)
window size value: 16425
[calculated window size: 65700]
[window size scaling factor: 4]
 checksum: 0xfa02 [validation disabled]
 [sEQ/ACK analysis]
Hypertext Transfer Protocol
GET /images/logo/qishi_1ogo_1400818762. png HTTP/1.1\r\n
[Expert Info (Chat/Sequence): GET /images/logo/qishi_logo_1400818762.png HTTP/1.1\r\n]
0000
64a0e7414141001f
2902 c7 f508004500
d..AAA..
）.
....E.
0010
01
b0 11
cb
4000
8006
cb
e5
a8
9e
C3
da
1c
.CB. DP.
0020
e2
Oe
f6 67
24
67
5e
04
27
63
42
al
b7
44
50
18
40 29 fa 02 
'v5$6.
0030
47
45
54
202f
69
6d
61
67
65
@).
...GE
T /image
0040
732f
6c
6973
6869
5f
6c
6f
67
s/logo/q
ishi_10g
0050
6f
5f
31
34
3030
38
31
38
37
36
32
2e
70
6e
67
0_140081
8762.png
0060
2048
54
54
502f
31
2e
31
Od0a
41
63
63
65
70
HTTP/1.
1..Accep
---
## Page 93
93
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
口TCP的滑动窗口是以字节为单位的。
■假定A收到了B发来的确认报文段，其中窗口是20（字节），而确认号是31
（表示希望收到的下一个序号为31，序号30为止的数据已经收到）。
■根据窗口和确认号，A就可以构造出自己的发送窗口。
1说明：为了讨论方便，仅假定数据传输只在一个方向进行，即A发送数据
B给出确认。
---
## Page 94
94
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
后沿
前沿
×收缩
前移
前移
A的发送窗口=20
262728
56
不允许发送
已发送并
收到确认
允许发送的序号
B期望
收到的序号
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 95
95
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
口TCP的滑动窗口是以字节为单位的。
■发送窗口里面的序号表示允许发送的序号。
·窗口越大，发送发就可以在收到对方确认之前连续发送更多的数据，从而获得更
高的传输效率。
■发送窗口后沿的后面部分表示已发送且收到了确认。
口发送窗口前沿的前面部分表示不允许发送的。
■发送窗口的位置由窗口前沿和后沿的位置共同确定。
---
## Page 96
96
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
口发送窗口后沿的变化情况有两种可能：不动和前移。
■没有收到新的确认，就不动;
■收到了新的确认，就前移。
■发送窗口后沿不可能向后移动，因为不能够撤销已经收到的确认。
口发送窗口前沿的变化情况有三种可能：不动、前移和收缩。
■没有收到新的确认或者收到新的确认但窗口变小都可能造成前沿不动
■在对方通知的窗口缩小时，发送窗口前沿也可能向后收缩，但是TCP标准强
烈不造成这种做法。
---
## Page 97
97
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
假定A发送了序号31-41的数据。这时，发送窗口位置并未改变，但是31-
41的11个字节为已发送但未收到确认。42-50的9个字节为允许发送但尚
未发送。
口要描述一个发送窗口的状态需要三个指针：P1、P2、P3。
P3-P1=A的发送窗口
口P2-P1=已发送但尚未收到确认的字节数
口P3-P2=允许发送但尚未发送的字节数
---
## Page 98
98
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
A的发送窗口位置不变
可用窗口
已发送并
不允许发送
收到确认
已发送但未收到确认
允许发送但尚未发送
P
B的接收窗口
56
已发送确认
不允许接收
并交付主机
允许接收
未按序收到
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 99
99
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
假定B收到了序号为31的数据，并把序号为31-33的数据交付主机，然后B
删除这些数据。接着把接收窗口向前移动3个序号，同时给A发送确认
窗口值仍为20，确认号为34。同时B收到了37、38、40的数据，但是没
有按序到达。
口A收到B的确认后，就可以把发送窗口向前滑动3个序号，但指针P2不动。
A的可用窗口增大，可发送的序号范围是42-53。
---
## Page 100
100
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
A的发送窗口向前滑动
不允许
已发送并收到确认
已发送
发送
允许发送但尚未发送
但未收到确认
B的接收窗口向前滑动
已发送确认
不允许
并交付主机
允许接收
接收
未按序收到
先存下，等待缺少的数据的到达
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 101
101
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
口A在继续发送完序号42-53的数据后，指针P2向前移动和P3重合。发送窗
口内的序号都已用完，但还没有再收到确认。
口由于A的发送窗口已满，可用窗口已减小到零，因此停止发送数据。
河南中医药大学信息
---
## Page 102
102
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
A的发送窗口已满，有效窗口为零
2627
56
不允许
已发送并收到确认
已发送但未收到确认
发送
1
P2
P3
河南中医药大学信息技术学院互联网技术教学团队／https://intel
let.hactcm.edu.cn
---
## Page 103
103
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
发送方的应用进程把字节流写入TCP的发送缓存，接收方的应用进程从
TCP的接收缓存中读取字节流。
口窗口和缓存的关系对于研究TCP可靠传输非常重要。
在讨论之前说明两点：
缓存空间和序号空间都是有限的，且都是循环使用的。
■实际上缓存或窗口中的字节数都是非常大的。
河南中医药大学信息技
---
## Page 104
104
6.TCP可靠传输的实现
6.1以字节为单位的滑动窗口
暂时存放：
（1）发送应用程序传送给发送方TCP准备发
发送缓存与发送窗口
送的数据;
(2）TCP已发送出但尚未收到确认的数据。
不能发送太快，否则
发送应用程序
发送缓存会溢出。
发送窗口通常
最后写入缓
TCP
只是发送缓存
存的字节
发送缓存
的一部分。
发送窗口
已发送
最后被确认
最后发送