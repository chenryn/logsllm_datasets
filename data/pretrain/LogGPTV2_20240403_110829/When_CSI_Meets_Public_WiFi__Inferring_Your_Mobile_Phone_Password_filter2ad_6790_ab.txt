4.2
4.4
Sample
(a) Continuously Click in Diﬀerent Keys
Sample
x 10 4
5.6
6
5.8
Sample
6.2
x 10 4
7.3
7.4
7.5
Sample
7.6
7.7
x 10 4
1
2
3
4
Sample
5
6
7
8
x 10 4
(b) Continuously Click in the Same Key
Figure 3: CSI Change When Typing
the PIN entry can generate a unique pattern in the time-
series of CSI values, which can be used for keystrokes in-
ference. From our experiments, we found that two main
factors contributing to CSI changes are hand coverage and
the ﬁnger click.
Hand coverage and ﬁnger position on a smart phone
touchscreen are one of the major factors that cause the ﬂuc-
tuation of CSI waveform. It is widely acceptable that ﬁnger
position and coverage have a direct impact on the calling
quality. Similarly, since time series of CSI waveform reﬂects
the interference of several multi-path signals, diﬀerent ﬁnger
position and coverage will inevitably introduce the interfer-
ence to the WiFi signals and thus lead to the changes of
the CSI. We further demonstrate the it via a series of ex-
periments. Fig.3(b) shows a CSI stream when continuously
pressing diﬀerent number from 1 to 9, followed by 0, each for
5 times. It can be seen that the diﬀerent coverages lead to
the diﬀerent ﬂuctuation range of the CSI value, which can
be exploited for key inference.
Finger click is another important factor that contributes
to the ﬂuctuation of CSI. Compared with CSI change caused
1070by the hand coverage, the experiment shows that ﬁnger click
has a more direct inﬂuence on CSI by introducing a sharp
convex in Fig.3(a), which corresponds to the quick click’s
inﬂuence on multi-path propagation. This feature can be
used to distinguish the oblique touches in the case that the
human continuously presses the same key or the adjacent
keys, which produce similar CSI values.
4. THE DESIGN OF WINDTALKER
4.1 System Overview
The basic strategy of WindTalker is hitting two birds with
one stone. On one hand, it analyzes the WiFi traﬃc to
identify the sensitive attack windows (e.g., PIN number) on
smartphones. On the other hand, as long as an attack win-
dow is identiﬁed, WindTalker starts to launch the CSI based
keystroke recognition. As shown in Fig.4, WindTalker is
consisted of the following modules: Sensitive Input Window
Recognition Module, which is responsible for distinguishing
the sensitive input time windows, ICMP Based CSI Acquire-
ment Module, which collects the user’s CSI data during his
access to WiFi hotspot, Data Preprocessing Module, which
preprocesses the CSI data to remove the noises and reduce
the dimension, Keystroke Extraction Module, which enables
WindTalker to automatically determine the start and the
end point of keystroke waveform, and Keystroke Inference
Module, which compares the diﬀerent keystroke waveforms
and determines the corresponding keystroke.
Directional 
Antenna
Internet Control 
Message 
Protocol
CSI
Noise 
Removal
Dimension 
Reduction
Connected 
Victim
WiFi Packets 
Analysis 
Sensitive 
Input
Keystroke 
Extraction
Keystroke 
Recognition
Output
Figure 4: WindTalker Framework
4.2 Sensitive Input Window Recognition Mod-
ule
To distinguish the time window of the sensitive input from
that of insensitive input, WindTalker captures all the pack-
ets of the victim with Wireshark and records timestamp of
each CSI data. Currently, most of the important applica-
tions are secured via HTTPS, which provides end-to-end
encryption and prevents the eavesdropper from obtaining
the sensitive data such as the password. Our insight is that
though HTTPS provides end-to-end encryption, it cannot
protect the meta data of the traﬃc such as the IP address
of the destination sever, which can be used to recognize sen-
sitive input window.
In particular, WindTalker builds a Sensitive IP Pool for
the interested applications or services. Take the AliPay as
an example. During the payment process, it will be directed
to a limited number of IP addresses, which can be obtained
via a series of trials. In the experimental evaluation, it is
shown that, for Alipay users, the traﬃcs of the users under
the same network will be directed to the same server IP,
which will last for a period (e.g., several days for one round
of experiment). This allows WindTalker to ﬁgure out the
sensitive input time window.
During the attack process, as long as the traﬃc to the
Sensitive IP Pool is observed, WindTalker will record the
corresponding start time and the end time, which serve as
the start and the end of the Sensitive Input Window. Then,
it starts to analyze the CSI data in this period to launch the
password inference attack via WiFi signals.
4.3
ICMP based CSI Acquirement Module
4.3.1 Collecting CSI Data by Enforcing ICMP Reply
Diﬀerent from the previous works which rely on two de-
vices including both of the sender and the receiver to collect
CSI data, we apply an approach that leverages Internet Con-
trol Message Protocol (ICMP) in hotspot to collect CSI data
during the user accesses to the pre-installed access point. In
particular, WindTalker periodically sends a ICMP Echo Re-
quest to the victim smartphone, which will reply an Echo
Reply for each request. To acquire enough CSI informa-
tion of the victim, WindTalker needs to send ICMP Echo
Request at a high frequency, which enforces the victim to
replay at the same frequency. In practice, WindTalker can
work well for several smartphones such as XiaoMi, Samsung
and Nexus at the rate of 800 packets per second. It is im-
portant to point out that this approach does not require
any permission of the target smartphone and is diﬃcult to
be detected by the victim.
ICMP based CSI collection approach introduces a limited
number of extra traﬃc. For a 98 bytes ICMP packet, when
we are sending 800 ICMP packets per second to the victim,
it needs only 78.4 kB/s for the attack where 802.11n can
theoretically support the transmission speed up to 140 Mbits
per second. It is clear that the proposed attack makes little
interference to the WiFi experience of the victim.
4.3.2 Reducing Noise via Directional Antenna
CSI will be inﬂuenced by both ﬁnger movement and peo-
ple’s body movement. One of the major challenges of ob-
taining the exact CSI data in public space is how to min-
imize the interference caused by the nearby human beings.
We present a noise reduction approach by adopting the di-
rectional antenna. Diﬀerent from omni-directional antennas
that have a uniform gain in each direction, directional an-
tennas have a diﬀerent antenna gain in each direction. As a
result the signal level at a receiver can be increased or de-
creased simply by rotating the orientation of the directional
antenna. WindTalker employs directional antenna to focus
the energy toward the target of interest, which is expected to
minimize the eﬀects of the nearby human body movement.
WindTalker employs a TDJ-2400BKC antenna working
in 2.4GHz to collect CSI data of the targeted victim, whose
Horizontal Plane -3dB Power Beamwidth and Vertical Plane
respectively. Con-
-3dB Power Beamwidth are 30
sidering the case that the distance between the victim and
access point is 1.5 meter, we illustrate the eﬀective accep-
tance area of 0.67 meter high and 0.80 meter long.
and 25
◦
◦
Fig.5 shows the comparison of CSI collection with direc-
tional antenna and without directional antenna in public
place. Fig.5(b), Fig.5(c), Fig.5(d) show CSI amplitude in
1071e
d
u
t
i
l
p
m
A
I
S
C
50
45
40
35
30
25
20
0
e
d
u
t
i
l
p
m
A
I
S
C
28
26
24
22
20
18
16
0
6000
2000
Sample
4000
2000
4000
Sample
(a) Omni-directional An-
tenna in 75cm
(b) Directional Antenna
in 75cm
e
d
u
t
i
l
p
m
A
I
S
C
28
26
24
22
20
18
0
24
22
20
18
e
d
u
t
i
l
p
m
A
I
S
C
6000
16
0
2000
4000
Sample
6000
2000
4000
Sample
(c) Directional Antenna
in 125cm
(d) Directional Antenna
in 150cm
Figure 5: Antenna Performance in Public Place
the case that a victim is located at 75, 125, 150 cm accord-
ingly away from directional antenna while one people moving
nearby. Unique pattern caused by ﬁnger click in number 1
can be easily caught from the original CSI stream without
any preprocessing. However, these patterns are submerged
in human body’s inﬂuence on CSI stream obtained by omni-
directional antenna even when the victim and attacker is
close as 75 cm, which is shown in Fig.5(a).
4.4 Data Preprocessing Module
Before launching keystroke inference module, WindTalker
needs to preprocess the CSI data to remove the noises intro-
duced by commodity WiFi NICs due to the frequent changes
in internal CSI reference levels, transmit power levels, and
transmission rates. To achieve this, WindTalker ﬁrst turns
to low pass ﬁlter to remove the high frequency noise. Then,
WindTalker leverages the Principal Component Analysis to
reduce the dimensionality of the feature vectors to enable
better analysis of the data.
4.4.1 Low Pass Filtering
The observation behind low pass ﬁltering is that the vari-
ations of CSI waveforms caused by ﬁnger motion lie at the
low end of the spectrum while the frequency of the noise lies
at the high end of the spectrum. To remove noise, we adopt
Butterworth low-pass ﬁlter, which is designed to have a ﬂat
frequency response in the passband and thus does not distort
the ﬁnger motion signal much. It is observed that the fre-
quencies of the variations in CSI time series due to hand and
ﬁnger movements lie between 2 Hz and 30 Hz. As we sample
CSI values at a rate of S = 800 packets/s, WindTalker sets
some parameters to choose a proper ﬁlter in which the tran-
sition band ranges from 30Hz to 80Hz. We set the passband
≈ 0.075 πrads/sample
corner frequency Wp =
with 1 corresponding to the normalized Nyquist frequency
≈ 0.2
and stopband corner frequency Ws = 2∗fs
πrads/sample. Passband ripple in decibels is 1 and Stop-
2∗fp
S = 2∗30
800
S = 2∗80
800
band attenuation in decibels is 40. After low-pass ﬁlter,
most of the burst noises can be removed.
4.4.2 Dimension Reduction
Dimension reduction is essential for keystroke inference
via CSI information. For a CSI recording system using In-
tel 5300 NICs with NT X transmitter antennas and NRX re-
ceiver antennas, it can collect NT X ×NRX ×30 CSI streams.
It is important to reduce the dimensionality of the CSI infor-
mation obtained from 30 subcarriers in each TX-RX stream
and recognize those subcarriers which show the strongest
correlation with the hand and ﬁnger movements. WindTalker
adopts PCA, which is expected to choose the most repre-
sentative or principal components from all CSI time series.
PCA is also expected to remove the uncorrelated noisy com-
ponents. The procedure of dimension reduction of CSI time
series based on PCA includes the following steps.
Sample Centralization: Performing sample centraliza-
tion in every subcarries. We use a matrix H to present orig-
inal CSI stream data. For example, in a system with one
pair of TX-RX antenna, we will get 30 CSI streams from 30
subcarriers. Thus, with sample rate S and time T , H has
dimension of M × 30, where M = S × T . Every column
of H represents a CSI time series data stream in one sub-
carrier. Then we calculate the mean value of each column
in H and subtract the corresponding mean values in every
column. After the centralization step, we get a processed
matrix Hp.
Calculating Covariance Matrix: Calculating the cor-
relation matrix of Hp as Hp
T × Hp.
Calculating Eigenvalues and Eigenvectors of Co-
variance: Calculating the Eigenvalues and Eigenvectors of
Covariance. The Eigenvectors are normalized to unit vec-
tors.
Choosing Main Eigenvalues: Sorting the Eigenvalues
from large to small and choosing the maximum k number
of Eigenvalues. Then the corresponding k Eigenvectors are
used as the column vectors to form a Eigenvector matrix.
We will get a Eigenvector matrix whose dimension is 30× k.
Data Reconstruction: Projecting Hp onto the selected
k Eigenvector matrix. The reconstruction CSI data stream
Hr has the dimension of M × k.
Hr(M × k) = Hp(M × 30) × EigenV ectors(30 × k)
With PCA, we can identify the most representative com-
ponents inﬂuenced by the victim’s hand and ﬁnger’s move-
ment and remove the noisy components at the same time.
In our experiment, it is observed the ﬁrst k = 4 components
almost show the most signiﬁcant changes in CSI streams
and the rest components are noises. We only take one PCA
component from the ﬁrst 4 components in the password in-
ference module. We observed that the ﬁrst PCA compo-
nent reserves most changes in CSI while the ambient noise
is weakly. Otherwise, the ﬁrst component has a large noise
and the succeeding k − 1 components reserve most changes
in CSI.
4.5 Keystroke Inference Module
4.5.1 Keystroke Extraction
By processing the low pass ﬁltering and dimension reduc-
tion, it is observed that the CSI data shows a strong corre-
lation with the keystrokes. In the experiment, the sharp rise
10723
2
1
0
-1
l
e
u
a
V
I
S
C
J
Anchor Points
2
1.5
l
e
u
a
V
I