上面的文字‘проверяем доступность секции с
траншем’提到在代码段中检查‘траншем’的可用性，这是一个有趣的用词和重要的发现。
该注释是关于下面的代码将通过钱包地址来获得钱包中资金的总余额的事实。
‘траншем’这个词是‘ranche’的俄语，来自法语单词，表示交易的一部分或一部分。
第一条注释‘получаем баланс’，即’得到平衡’，第二条注释’баланс’是平衡’一词，第三条注释，’стоп
работ’，意为’停止工作’，这能说得通是因为当程序检查到余额为0的时候来到了这条正确的分支，意味着ATS没有资金可以转移而程序可以停止工作了。
第一条注释，’оставить кошелек
получателя’，翻译过来就是’设置收款人的钱包’，这与设置从钓鱼受害者的钱包中转移资金的交易收款人钱包地址的函数有关。第二条注释，’отправить
весь баланс в эмаунт ’，翻译过来就是’将全部余额转移’。这句话中的最后一个单词’эмаунт’是拼写为西里尔文的非俄语单词。
这些注释的出现意味着脚本的作者是一个以俄语为母语并至少拥有一定财务知识的人。
###### 结论
自事件发生以来，已经发布了很多关于这次具体攻击的具体细节，但我们决定更深入地了解到底发生了什么，并挖掘出与MEWKit相联系的额外见解。 亚马逊Route
53劫持（事件）只有一个目标。 虽然这次袭击的范围相对较小，但其范围可以更为巨大。
互联网是在几十年前创建的，并不是所有的构建模块都已经过时了 - BGP和DNS仍然是我们全球互联网中存在问题但至关重要的一部分。
与大多数网络安全问题一样，针对这些类型的攻击也有解决方案，但它们的效果取决于链中的每个人都加强安全性并部署解决方案。
#### IDN Phishery
几乎所有MEWKit实例都要注意的一点是攻击者利用国际化域名（IDNs）。 国际化域名攻击并不新鲜，但遗憾的是，它们在利用MEWKit的攻击中似乎非常有效。
浏览器正在迎头赶上去解决这个问题，Firefox和Chrome都实现了一个非常简单的算法来检查域名中的所有字符是否属于同一种语言。
如果不是，则显示以'xn--'开头的IDNA符号。
这个过滤器确实可以防止MEWKit的大量攻击，因为攻击者们使用来自西里尔文，希腊文，亚美尼亚文和希伯来文的特殊语言字符来替换带有特殊字符变体的字母。
当然，那些仍然会通过这些过滤器，我们希望在MyEtherWallet交易的每个人时保持小心。
请密切关注您打开的是哪个网址，最好是使用MyEtherWallet的书签页或自己输入域名。 不要使用来源于电子邮件，社交媒体的链接。
#### 不同之处
MEWKit战役中使用的大多数域和主机都使用非常特定的格式来模仿MyEtherWallet。
然而一个运行MEWKit的主机却不一样，经过仔细检查后发现其运行了一些令人好奇的脚本。
有问题的主机是tikkiepayment.info，托管在31.31.196.186。
4月9日，MEWKit实例被托管在`myyetherwallett.com/myether/`，它从以下位置加载它的MEWKit脚本：
     myyetherwallett.com/myether/js/wallet.js
     myyetherwallett.com/myether/js/sm.js
其后台地址在 wallet.js 脚本中被设置为  ，wallet.js
中还包含着解释变量的注释：
我们还发现位于同一主机上其他MEWKit的后台路径地址：
     https://tikkiepayment.info/pp/
     https://tikkiepayment.info/mycryptopanel/
     https://tikkiepayment.info/showpanel/
如果我们检查一下主机tikkiepayment.info，我们发现一些之前从来没有在其他MEWKit实例中见到过的奇怪的东西：它为攻击者运行着与MEWKit无关的基于web的工具。在
 上，托管着一个允许攻击者使用MyEtherWallet API来批量检查Ethereum
keys的工具：
尽管网络犯罪中窃贼之间通常不存在荣誉，但该工具是其他人可以使用的精简版MyEtherWallet，它检查帐户是否有效并且有一些余额。根据服务器上存在的工具以及它是我们曾经观察过MEWKit上的第一台主机的事实，我们认为这台主机是由MEWKit的创建者设置的。此外，根据本报告底部IOC部分显示的注册信息，域名会在任何MEWKit主机设置之前一个月进行登记。
#### 走出以太坊
尽管我们不能确切的说MEWKit操作是单一攻击者，但我们确实发现了MEWKit实例和其他加密货币和加密货币交易所的钓鱼页面之间的一些有趣链接。
4月17日，MEWKit实例在`www.xn--myetherwalle-occ.com`上正式运行，它的MEWKit脚本从以下位置加载：
     cdnsﬁles.com/js/wallet.js
     cdnsﬁles.com/js/sm.js
后端位置托管在，但另一个MEWKit实例直接托管在cdnsfiles.com上，其资源从上述同一位置加载，后端位置设置为cdns文件的.com / ADM
/。
我们看到另一个网站从cdnsfiles.com加载资源，这不是MEWKit实例，而是blockchain.info的钓鱼页面。
该页面本身是一个普通的钓鱼网站，并没有包含MEWKit所拥有的ATS组件 - 它只是收获了登录凭证。 然而，更有趣的是它从以下位置加载资源：
它在用于MEWKit的同时使用cdnfiles.com作为其钓鱼资源，这告诉我们MEWKit背后的攻击者拥有非常广泛的钓鱼页面组合。如果我们查看钓鱼页面的主机，185.207.205.16，我们发现另一大部分钓鱼域名主要关注blockchain.info。
然而，Coinbase也有一个IDN网络钓鱼：
资源: 
综上所述，因为此报告仅关注MEWKit ，所以RiskIQ
PassiveTotal中的域名尚未添加到本报告的IOC部分。然而，由于它提供了MEWKit，因此在本报告IOC部分中提到的IP地址将提供足够的数据点来开始单独的调查。
#### 总结
MEWKit自今年年初就一直被广泛使用了，尽管我们在2018年以前都没见过它，但或许MEWKit在外界早已以不同的功能或形式活跃了。BGP劫持亚马逊Route
53的行为显示了它驱动的攻击者和活动的持续性，执行其攻击的成本表明MEWKit异常成功，技术虽然简单，但却有效地窃取了以太坊。
正如我们在MEWKit的技术分析中所解释的那样，我们无法估计攻击者的收益，因为我们无法知道攻击者控制了多少钱包和地址，这是由于MyEtherWallet的设置方式是以每个受害者为基础发放的地址的。区块链的架构，特别是以太坊允许每个人通过公簿洞察钱包地址余额，但它也维护了所有者的完全匿名性。直到攻击者被抓获或执法部门提供MEWKit攻击中使用的精确地址的见解前，我们永远不会知道其确切的运作。
我们确实知道，各种钱包已经在社交媒体和论坛上发布，表面上收入可能达数百万美元，但我们无法高度自信地将其与MEWKit联系起来。
然而，随着注册域名数量的增加，服务器维护的增多以及活动水平的提高，我们可以推测这次攻击的收入必须足够丰厚，不仅能够维持运营，而且还能盈利。
#### 妥协指标
以下部分包括我们观察到的所有直接属于MEWKit的IOC（控制反转）以及IOC的行为，这些IOC同样可以用于自动化的PassiveTotal项目：
以下IP地址被检测到正在执行MEWKit实例，并且与列表下方列举在表格中的一个或多个域名相关联。
     185.145.131.134
     185.207.205.16
     185.207.205.25
     185.61.137.36
     198.50.209.83
     31.31.196.186
     37.1.203.209
     46.161.42.42
     5.45.69.74
以下是包含注册日期及用于注册的电子邮件地址的详细域名列表。如果电子邮件地址丢失，这意味着该字段默认由隐私服务或注册商填写。由MEWKit建立和用于活动的域名的注册日期紧密重合。
* * *
**高端渗透测试服务，请访问  
招贤纳士：PI:EMAIL**
* * *