• ghYU ZYg cb Xg_
• ghYU WfYXYbhUg !UWWcibh WcbY"
• J<>
• dfjYYX :IBg
• ;fckgYf *XUm
 C{}
graph LR;
A-->B;
click B callback ""
graph LR;
xss-->B;
click xss alert "callback"
click B "javascript:alert`1`" "link"
aYfaUXXYac ghY
DUhYl (FUh\Ul
• aUh\hmdYgYhhb
• DUhYl VYZcfYj)'*)')fW !/-)1 igYX ( *)0). ghUf ( 0,1 Zcf_"
• FUh\CUl VYZcfY j,VYhU',!*+*/ igYX( /12. ghUf ( 21+ Zcf_"
•
fYdcfhYX Vm ch\Yf img 3!
ZckW\Ufh'g
• ZckW\UfhXUfUag
• --1igYX ( /))) ghUfg ( 120 Zcf_g
• UhYgh jYfgcb
Kia h id
• aYfaUX !UhYgh"
• FUh\CUl !VYZcfY j,VYhU',"
• DUhYl !VYZcfYj)'*)')fW"
• ?ck b XYg_hcd Udd8
fYbXYfYf'g
• fYbXYf \ha Zfca gUbXVcl b U dfjYYX WcbhYlh
webview.addEventListener('dom-ready', function () {
// set webview title
document.querySelector('#navbar-
container .title').innerHTML = webview.getTitle()
document.querySelector('title').innerHTML = 
webview.getTitle()
})
JYXfYWh hc Yldch dUY igb PKK
• cWUhcb6\hhd3((llll(Yldch'\ha
• LfYf XcafYUXm
JYgdcbgVYXgWcgifY
• )0()1(+)*2fYdcfhYXhcAUW_F=
• )0(**(+)*2ZlYX
ALFE bYWhcb b Uddg
• bc CUjUKWfdh YlYWihcb
• d\g\b8 UXjYfhgb8
IfjYYX:IBg
• bcXY acXiYg
• Wighca :IB
• CK;fXY kh\ kfUddYf
• igiUm \UjY diVW XcWg
aVYXYXVfckgYfkh\Wighca:IBg
• E?WUbbchYlYWihYkh\cihl
• ;Ug\(Imh\cboUfYcdYbYXVmhYlhYXhcfg
• 'Ufkcf_g
:hhUW_ gWYbUfc
ci \UjY CUjU
ci WW_ U ?YYX
lW\UbY !ghYU YaUg"
• fYUm hc Ubch\Yf aUW\bYh\Uh \UjY h\Y gUaY dUggkcfX
• o
• ZcibX Vm 9g\WhcaU
PP> g bch Ybci\
• ghYU ZYg
• gYbX \hhd fYeiYghg
• 8
@\XfU Zfca PP> hc J<>
• CUjU k gYbX WfYXYbhUg k\Yb YbWcibhYfg GLEFVUgYX
-)* \hhd fYgdcbgY
• :hhUW_Yf gYh id U aUWcig \hhd gYfjYf
• JYUm h\Y WfYXYbhUg hc KF; gYfjWY
https://xlab.tencent.com/en/2019/03/18/ghidra-from-xxe-to-rce/
feature
XSS
Privileged 
API
Protocol 
Handler
http
JavaScript
file
jF))b
• 9<cXY<ccfgh
• 9aVYW\Yf !\hhdg3((h\iV'Wca(aVYW\Yf"
• 9ViYW)fY!\hhd3((ViYW)fY'Vcgdch'Wca"
• 9_*hhYb!\hhdg3((h\iV'Wca(_*hhYb"
• 9g\WhcaU
• 9JWhYfR !\hhdg3((h\iV'Wca(JWhYfR"
• o
L\Ub_g