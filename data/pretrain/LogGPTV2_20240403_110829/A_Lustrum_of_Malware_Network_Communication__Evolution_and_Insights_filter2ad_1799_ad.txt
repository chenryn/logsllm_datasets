### Behavior of Spammers and Malware Authors

The tactics employed by spammers can also be utilized by other malware authors. Additionally, it is possible that domains are quickly re-registered after their expiration and immediately used for malicious purposes. Another potential explanation is that our data feeds might not be the first to detect new samples. However, since we also consider the "first seen" date from VirusTotal, it is unlikely that adding other feeds would significantly reduce the "first seen" date for the malware samples in our dataset.

### Domain Lifetime Analysis

We analyzed the lifetime of malware domains using Figure 7, which shows a joint density distribution between the number of days a domain was resolved and its total lifetime in days for Potentially Unwanted Programs (PUPs), malware, and unclassified samples. The "lifetime" is defined as the difference between the first and last seen dates for each domain in passive DNS.

The joint distribution allows us to infer both the frequency and duration of domain resolution. In Figures 7b and 7c, we observe three hotspots corresponding to the most prevalent resolution behaviors for malware and unclassified malicious software. 

1. **Short-lived and Rarely Resolved Domains**: A large number of domains have short lifetimes and are rarely resolved.
2. **Long-lived and Frequently Resolved Domains**: These domains, located in the top right corner of both figures, are long-lived and frequently queried throughout the duration of our experiments.
3. **Long-lived but Infrequently Resolved Domains**: These domains, found in the bottom right of both figures, have a long lifetime but are infrequently resolved, with queries often years apart.

For PUP domains (Figure 7a), we observe a different distribution. This is due to two factors:
1. **Increased Prevalence of PUP Domains**: The rise in PUP domains over the past two to three years justifies the bounding of the joint distributions in the [1,000, 1,000] region.
2. **Continuing Resolution of PUP Domains**: The intense and ongoing resolution of PUP-related domains manifests as a higher density along the diagonal. This is likely due to organizations failing to block PUP domains and endpoint security engines not effectively remediating PUP infections.

Unclassified domains (Figure 7c) follow a similar pattern to malware domains (Figure 7b), suggesting that many unclassified domains are likely malware domains.

In summary, Figure 7 indicates that all three types of domains frequently have long lifetimes, and many of these domains are frequently looked up. Since we showed that most domains were only resolved by a single sample in Section V-A1, this suggests that many samples remain active on the Internet for extended periods.

### Infrastructure Analysis

In this section, we analyze the hosting infrastructure for the domains resolved by the malware samples in our dataset. We investigate whether certain IP ranges are more commonly used, the reasons behind this choice, and how the global infrastructure has evolved over time.

**Figure 8** shows a histogram of the number of samples with domains (after filtering) resolving into a given /24 subnet, for each year between 2012 and 2015. We observe spikes indicating that certain subnets are resolved by a very large number of samples during that year, ranging from hundreds of thousands of samples in 2013 and 2014 to peaks of a few million samples in 2012 and 2015. Some spikes, such as 66.150.14.0/24 (Akamai) in 2012–2013 and 148.81.111.0/24 (NASK Polish CERT) in 2014–2015, appear in multiple years, while most appear in a single year.

By analyzing the e2LDs that resolve to these ranges and using the mapping of e2LD to family produced by our classification in Section IV, we identify three reasons behind these spikes:

1. **Specific Malware Families Reusing Subnets**: The largest group of spikes is caused by specific malware families reusing the same subnet for long periods. Many of these spikes are due to PUP families (e.g., hotbar, domaiq, firseria, multiplug) and some polymorphic malware like vobfus. For example, in 2015, three of the top four spikes correspond to Amazon EC2 ranges and are due to e2LDs belonging to the multiplug PUP family, which migrated its hosting infrastructure to EC2 in 2015.

2. **Sinkholes for Malicious Domain Redirection**: The second group of spikes corresponds to sinkholes used to redirect resolutions of malicious domains after intervention. A notable example is 148.81.111.0/24 in 2014–2015, which is due to sinkhole.cert.pl, used by NASK to sink resolutions of the Polish domains used by the Virut botnet.

3. **Multiple Malware Families Using the Same Hosting Provider**: The third group of spikes is due to multiple malware families using the same hosting provider, indicating hotbeds of abuse. These providers may have had more open policies on acceptable behavior. Examples include Clara.Net (195.22.26.0/24) and ChinaNet (218.92.221.0/24).

Our analysis shows that the large spikes are dominated by PUP families and can last for multiple years, indicating that PUPs utilize seemingly stable IP infrastructure. This suggests that popular cloud hosting providers like Amazon EC2, LeaseWeb, or OVH, and CDNs like Akamai, where PUP spikes occur, may not have the same policies towards banning PUPs as they do for malware.

### DGA Malware

In the previous section, we provided an extensive analysis of the evolution of malware network infrastructure based on successful DNS resolutions. Here, we focus on the presence and impact of Domain Generation Algorithms (DGAs) in our dataset.

Since most DGA-related queries do not resolve to a valid IP address, we reintroduce the failed (NXDomain) resolutions filtered out in Section III. Since 2011, over 12.5 million malware samples in our dataset produced at least one NXDomain during their execution. The cumulative distribution function (CDF) in Figure 9 shows that half of the malware executions have less than two NXDomain resolutions, and only 950,644 have over five.

To identify DGA-generated domains, we check if the domains in our malware executions dataset appear in the DGArchive, which comprises 50M domains generated by the DGAs of 66 malware families. Table V summarizes the overlap of the DGArchive domains with both failed and successfully resolved domains in our malware executions dataset.

According to the DGArchive, at least 44% (3M) of all the e2LDs observed in our malware executions, regardless of whether they successfully resolved, were generated by DGAs. This percentage is a lower bound since the DGArchive likely misses some DGA families and variants. After filtering, at least 17% of remaining e2LDs come from DGAs.

Our malware executions contain DGA e2LDs for 42 out of 66 (64%) families in the DGArchive. The majority of DGA domains (82%) come from virut, followed by pykspa (6%) and necurs (4%). After filtering, successfully resolved virut DGA domains correspond to 12% of all unfiltered domains, followed by zbot-gameover (4%) and ramnit (0.5%).

While virut is the most common DGA family in our dataset, if normalized by the number of samples in the family, we observe that virut resolves 1.8 e2LDs per sample, well below the most aggressive families: emotet (82 e2LDs/sample), murofet (68), and cryptolocker (53).

The table shows that only 1.8% of DGA domains successfully resolved, emphasizing different DGA behaviors by malware families. For example, while we observe over 110K domain names queried by necurs, only one of them successfully resolved.