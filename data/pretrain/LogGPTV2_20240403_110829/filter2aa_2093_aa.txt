⿊黑⽆无⽌止境 — 那些年我们绕过的锁
Kevin2600
议程:
. 关于锁的那点事
. 开锁@数字时代
. 开锁@⽆无线时代
. 开锁@物联⺴⽹网时代 I
. 开锁@物联⺴⽹网时代 II
锁的起源:
历史上最早出现的锁,由⽊木头制成.可以追溯到4000年前
的古埃及. 
在随后的罗⻢马世纪, ⼜又出现了由⾦金银铜等材质制成的锁.  
这在当时是财富及⾝身份的象征.
在中国仰韶⽂文化遗址中出现过早期的⽊木质锁. 汉朝时出现
了俗称三簧锁的铜质簧⽚片锁，可以说是中国锁具发展历上
的⼀一次质的⻜飞越.
锁的类型：
锁的结构：
起始
错误
正确
开锁
开锁@⽆无线时代
Samsung: Ezon RFID ⻔门锁
分析ing：
Proxmark3：Snoop ⻔门卡和⻔门锁之间的数据交互…
Mifare 加密算法Crypto1 可轻易破解..但是...
Ezon ⻔门卡 == Mifare classic 1K !!?
但 Mifare UID 可读写卡的出现改变了这⼀一切.
早期的 Mifare 卡 Block 0  in Sector 0 不可写.
只需Sniff 到UID, 便可实现克隆. 连破解Key都省了.
分析数据的交互, 原来 4bytes 的 UID 才是亮点. 
真相⼤大⽩白: 
视频演⽰示：
防暴⼒力破解功能？
5 次错误密码, 触发警铃.
4次错误密码, 1次Reset 键呢?
HID-Prox2 低频⻔门锁
. ⽆无任何加密和认证机制
. 后端Wiegand 26 bits 协议(包括iClass)
. 设施编号 = 21(8 bits)
. 卡号 ＝29644 (16 bits)
神器 RFIDler
软件RFID: RF前端由硬件处理, 其余都交给软件负责(调制; 编码)
相对 Proxmark3 来说, 价格便宜的多. 但仅针对低频 125khz /134khz 
功能包括: 读写⻔门卡, 模拟⻔门卡, 外接天线, 嗅探⻔门卡和⻔门禁之间的交互
RFIDler 案例: 调制
HID
EM4x02
RFIDler 案例: HID 模拟
. 通过 minicom 连接到 RFIDler
. 也可通过 rﬁdler.py 直接跟其交互(import RFIDler)
> set tag hid26
> encode 123 87654 hid26
> emulator
视频演⽰示:
RFIDler 案例: 完全克隆
. RFIDler 完全⽀支持读写 T55x7; Q5; HITAG ..
. 低频⻔门禁卡克隆必备 T55x7 
> set tag hid26
> copy T55x7 
> clone
> ⽀支持多种编码格式 
> 可重复擦写10万次之多 
视频演⽰示:
RFIDler 案例: 暴⼒力枚举 
. 特定区域低级别⻔门禁卡号⽆无法访问
. 可以通过暴⼒力枚举的⽅方式实现升级访问⺫⽬目的
（github.com/kevin2600/RFIDler-HID26-BruteForce）
. HID 对每套⻔门禁的卡号分配都有规律可寻 
视频演⽰示:
BLEKey — RFID 读卡器后⻔门  github.com/LinkLayer/BLEKey
 开锁@数字时代
 不保险的保险箱
. 电影中破解保险箱时, 喜欢运⽤用各种⾼高⼤大上的科技⼿手段
. 要不就是必须使⽤用各种重型⼯工具: 钳⼦子; 榔头; 斧⼦子; 电锯..
. 其实是可以这样玩的….
传闻 vs 事实
保险箱的第1关: 备⽤用钥匙
保险箱通常⽤用传统钥匙, 来防⽌止密码遗忘. 但却往往是最薄弱的环节...
保险箱的第2关: 复位键
保险箱通常会⽤用复位键来清空密码. 但总出现在不该出现的地⽅方...
保险箱的第3关: 默认密码
保险箱有时还会有默认特权密码. 但⽤用户往往忘记更改…
保险箱的第4关: ⼚厂商后⻔门?
⼚厂商喜欢设置后⻔门来防⽌止密码遗忘. 但换来的却是… RTFM..
 指纹识别锁真的安全吗?
指纹识别技术通过读取指纹图像, 然后提取指纹的特征, 最后通过匹配识
别算法得到识别结果.
每个⼈人的指纹是独⼀一⽆无⼆二, 两⼈人之间不存在着相同的⼿手指指纹. 并且每个
⼈人的指纹是固定的, 通常不会发⽣生变化.
指纹识别中使⽤用的模板并⾮非最初的指纹图, ⽽而是由指纹图中提取的关键
特征. 指纹的特性使其⼲⼴广泛运⽤用在⻔门禁系统, 考勤系统中.
基本纹路图案包括: 环型 (Loop); 螺旋型 (whorl) 和⼸弓型 (Arch).  使其
独⼀一⽆无⼆二的是每个纹路的起点, 终点, 分叉等细节特征.
指纹的特性
指纹纹路上都布满了汗腺, 不断分泌汗⽔水, 脂肪和蛋⽩白质. 其分泌物
的粘性强, 挥发慢, 会停留在物体上较⻓长的时间.
⼿手指⽪皮肤组织有很强的再⽣生能⼒力. 在意外刮伤的情况下, 也能在⼀一段
时间后恢复原样. 纹路形状⼀一⽣生都不改变.
 指纹识别机
光学指纹识别是通过激光射在⼿手指指纹的凹凸⾯面,并反射回感应器，并形成指
纹图⽚片，再与之前采集的指纹图⽚片进⾏行⽐比较
当下最常⻅见的指纹识别机: 光学指纹识别(考勤机); 电容式指纹识别(IPhone)
影响指纹机识别率的因素: ⼿手指肮脏, ⼿手指疤痕等导致的指纹差异. 都会影响
指纹质量, 使同⼀一⼿手指的指纹⽆无法被系统正常辨识
 指纹模提取&复制
当光学指纹机激光射在硅胶指纹膜时,如果纹路清晰,指纹机就可以被正常
识别. 从⽽而达到欺骗指纹机的⺫⽬目的.
⽤用⼿手指按在热熔胶;蜡烛模上形成带有指纹的模具，然后将硅胶倒⼊入定型. 
经过倒模⼯工序后, 制成硅胶指纹套.
http://dasalte.ccc.de/biometrie/ﬁngerabdruck_kopieren.en
视频演⽰示:
临时解决⽅方案?
数字密码锁 - YL 99
Master 账号: 设置管理⽤用户密码 (默认 0123 #）
特殊账号: 可激活⼀一键开锁功能 (必须 9 作为起始）
普通账号: 同时存储10 多组密码供不同⽤用户使⽤用 (1 - 8 作为起始）
贴⼼心防密码泄漏功能:  起始码 + xxxx + 正确密码 + # (结束确认）
但是千⾥里之堤, 毁于蚁⽳穴 …