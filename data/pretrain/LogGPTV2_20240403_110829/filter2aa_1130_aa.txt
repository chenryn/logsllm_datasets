Searching for the Light: 
Adventures w/ OpticSpy
Joe Grand (@joegrand)
Hacker, Engineer, Daddy
OpticSpy
! Optical receiver to convert light into voltage 
! Wavelength:  Visible and near IR light (420-940nm) 
! Signal speed: 100Hz-1.5MHz 
! Data stream polarity: Select normal v. inverted 
! Gain and threshold adjustment via potentiometers 
! USB interface for direct connection to host PC
Covert Channels
! Hidden methods to intentionally exfiltrate/transfer 
data from a normally functioning system 
! Could be achieved with HW and/or FW 
modification 
! Specifications modified or misdesigned before 
manufacturing 
! On physical device during manufacturing or in-
the-field 
! Hardware implant via interdiction
Exploiting the Environment
! Leakage based on optical, acoustic, thermal, or RF 
characteristics of a system 
! Soft Tempest: Hidden Data Transmission Using 
Electromagnetic Emanations (Kuhn, Anderson) 
! Emanate Like a Boss: Generalized Covert Data 
Exfiltration with Funtenna (Cui) 
! Inaudible Sound as a Covert Channel in Mobile 
Devices (Deshotels) 
! BitWhisper: Covert Signaling Channel between 
Air-Gapped Computers using Thermal 
Manipulations (Guri et al.)
Blinkenlights
! Using LEDs to exfiltrate/send data 
! Modulation faster than the human eye can detect 
! Optical covert channels 
! Information Leakage from Optical Emanations 
(Loughry and Umphress, 2002) 
! Silence on the Wire: A Field Guide to Passive 
Reconnaissance and Indirect Attacks (Zalewski) 
! Extended Functionality Attacks on IoT Devices: 
The Case of Smart Lights (Ronen, Shamir) 
! xLED: Covert Data Exfiltration from Air-Gapped 
Networks via Router LEDs (Guri et al.)
A Selection of Optical History
! Alexander Graham Bell's Photophone (1880) 
! Fiber optic communications (~1963) 
! Laser tag (~1979) 
! Optical networking systems (VLC, Li-Fi, FSO) (2011)
Related Projects
! Heathkit Laser Trainer/Receiver (1985) 
! Engineerâ€™s Mini Notebook: Optoelectronics Circuits 
(Forest Mims III, 1985) 
! IRis (Craig Heffner, 2016) 
! See no evil, hear no evil: Hacking invisibly & silently 
with light & sound (Matt Wixey, 2017)
Design Goals
! Open source tool for optoelectronic experimentation 
! Easy to understand theory 
! Off-the-shelf components 
! Hand solderable 
! Raise awareness of other interesting communication/ 
exfiltration methods
Proof of Concept
Early Versions
Development
Block Diagram
Points of Interest
USB
Receive 
indicator
Power 
indicator
Polarity 
selection
Photodiode
Threshold 
voltage adjust
Gain adjust
Schematic
NOTE: RESISTORS ARE IN OHMS +/- 5a AND CAPACITORS ARE IN MICROFARADS UNLESS
OTHERWISE NOTED. SEE BOM FOR ACTUAL VOLTAGE AND SPECIFICATION.
OpticSpy Analog: Crowd Supply Edition
SIZE
DaTE
TITLE
FILENaME
3V3
10k
R9
1k
R3
3V3
TP5
Normal
Inverted
Place target LED near or onto sensor
Peak wavelength sensitivity @ 565nm
Power Indicator
D1
BPW21R
0.1uF
C1
Based on Maxim Integrated's AN1117: Small Photodiode Receiver
Handles Fiber-Optic Data Rates to 800kbps (July 2001)
2
3
4
5
1
U3
MAX985EUK
4
3
2
1
5
U1
MAX4124EUK
4
3
2
1
5
U2
MAX4124EUK
100k
R1
3V3
4.7k
R5
3V3
0.1uF
C2
3V3
0.1uF
C5
3V3
0.1uF
C7
0.1uF
C3
10k
R8
10k
R7
0.1uF
C4
1k
R6
3V3
1k
R11
3V3
0.1uF
C6
Threshold Detector
Non-Inverting Amplifier
TP1
TP2
TP3
Frequency response inversely proportional to gain
Total transimpedance gain = R2 x U1Av x U2Av
U1Av = 1 + R4/R5
U2Av = 1 + R10/R8
R4
500k
R12
20k
TP4
R10
1.0M
R2
20k
To Host
1
2
3
4
5
P1
UX60-MB-5S8
0.1uF
C11
USB Mini B
0.01uF
C8
220R@100MHz
L1
5V0
DATA_RX
4.7k
R15
D2
LED
5V0
3V3
Q1
MMBT3904
RTS
2
DCD
8
RI
5
VCC
15
TXD
20
CTS
9
CBUS0
18
3V3OUT
13
DTR
1
RXD
4
CBUS1
17
DSR
7
USBDM
12
USBDP
11
VCCIO
3
RESET
14
GND
16
GND
6
CBUS2
10
CBUS3
19
U4
FT231XS
27
R14
27
R13
47pF
C9
47pF
C10
TXLEDa
5V0
4.7k
R16
D3
LED
Receive Data Indicator
10uF
C13
TP6
10uF
C12
0.1uF
C14
IN
1
OUT
5
EN
3
BYP
4
GND
2
U5
MIC5205-3.3YM5
470pF
C15
VUSB
D_N
D_P
2
1
3
5
4
6
SW1
JS202011CQN
(2nd Stage)
(Comparator)
Non-Inverting Amplifier
(1st Stage)
PIC101
PIC102
COC1
PIC201
PIC202
COC2
PIC301
PIC302
COC3
PIC401
PIC402
COC4
PIC501
PIC502
COC5
PIC601
PIC602
COC6
PIC701
PIC702
COC7
PIC801
PIC802
COC8
PIC901
PIC902
COC9
PIC1001
PIC1002
COC10
PIC1101
PIC1102
COC11
PIC1201
PIC1202
COC12
PIC1301
PIC1302
COC13
PIC1401
PIC1402
COC14
PIC1501
PIC1502
COC15
PID101
PID102
COD1
PID201
PID202
COD2
PID301
PID302
COD3
PIL101
PIL102
COL1
PIP101
PIP102
PIP103
PIP104
PIP105
COP1
PIQ101
PIQ102
PIQ103
COQ1
PIR101
PIR102
COR1
PIR20CCW
PIR20CW
PIR20W
COR2
PIR301
PIR302
COR3
PIR40CCW
PIR40CW
PIR40W
COR4
PIR501
PIR502
COR5
PIR601
PIR602
COR6
PIR701
PIR702
COR7
PIR801
PIR802
COR8
PIR901
PIR902
COR9
PIR100CCW
PIR100CW
PIR100W
COR10
PIR1101
PIR1102
COR11
PIR120CCW
PIR120CW
PIR120W
COR12
PIR1301
PIR1302
COR13
PIR1401
PIR1402
COR14
PIR1501
PIR1502
COR15
PIR1601
PIR1602
COR16
PISW101
PISW102
PISW103
PISW104
PISW105
PISW106
COSW1
PITP101
COTP1
PITP201
COTP2
PITP301
COTP3
PITP401
COTP4
PITP501
COTP5
PITP601
COTP6
PIU101
PIU102
PIU103
PIU104
PIU105
COU1
PIU201
PIU202
PIU203
PIU204
PIU205
COU2
PIU301
PIU302
PIU303
PIU304
PIU305
COU3
PIU401
PIU402
PIU403
PIU404
PIU405
PIU406
PIU407
PIU408
PIU409
PIU4010
PIU4011
PIU4012
PIU4013
PIU4014
PIU4015
PIU4016
PIU4017
PIU4018
PIU4019
PIU4020
COU4
PIU501
PIU502
PIU503
PIU504
PIU505
COU5
PIC202
PIC502
PIC702
PIC1301
PIR101
PIR301
PIR601
PIR120CW
PIR1601
PIU105
PIU205
PIU302
PIU505
PIC1201
PIC1402
PID201
PIL102
PIU4015
PIU501
PIU503
PIC902
PIP102
PIR1301
NLD0N
PIC1002
PIP103
PIR1401
NLD0P
PISW102
PISW105
PITP501
PIU404
NLDATA0RX
PIC101
PIC201
PIC401
PIC501
PIC601
PIC701
PIC801
PIC901
PIC1001
PIC1101
PIC1202
PIC1302
PIC1401
PIC1501
PID302
PIP105
PIQ101
PIR20CCW
PIR502
PIR1102
PIR120CCW
PITP601
PIU102
PIU202
PIU305
PIU406
PIU4016
PIU502
PIC102
PID102
PIR102
PIC301
PIR701
PITP201
PIU203
PIC302
PIR40CW
PIR40W
PIU101
PIC402
PIR602
PIR702
PIR802
PIR1101
PIC602
PIR120W
PITP401
PIU304
PIC1102
PIU403
PIU4013
PIU4014
PIC1502
PIU504
PID101
PIR20CW
PIR20W
PITP101
PIU103
PID202
PIR1501
PID301
PIR1602
PIP104
PIQ102
PIR902
PIQ103
PIR302
PISW103
PISW106
PIR40CCW
PIR501
PIU104
PIR801
PIR100CCW
PIU204
PIR901
PISW101
PISW104
PIU301
PIR100CW
PIR100W
PITP301
PIU201
PIU303
PIR1302
PIU4012
PIR1402
PIU4011
PIU401
PIU402
PIU405
PIU407
PIU408
PIU409
PIU4017
PIU4018
PIU4019
PIU4020
PIR1502
PIU4010
NLTXLED#
PIC802
PIL101
PIP101 NLVUSB
Photodiode
! Vishay Semiconductor BPW21R 
! Converts light into current 
! Photoconductive mode (reverse bias) 
! Faster response -> higher bandwidth 
! Less sensitivity, increased dark current 
! Bias resistor affects response/sensitivity
D1
BPW21R
0.1uF
C1
100k
R1
3V3
TP1
R2
20k
Non-Inverting Amplifier
PIC101
PIC102
COC1
PID101
PID102
COD1
PIR101
PIR102
COR1
PIR20CCW
PIR20CW
PIR20W
COR2
PITP101
COTP1
PIU103
PIU104
PIR101
PIC101
PIR20CCW
PIC102
PID102
PIR102
PID101
PIR20CW
PIR20W
PITP101
PIU103
PIU104
Amplification
! Maxim MAX4124 Wide Bandwidth, Low Power, 
Rail-to-Rail Operational Amplifier 
! Two stages w/ signal massaging in between 
! Lower gain per stage -> less overall noise 
! Total transimpedance gain = R2 x U1Av x U2Av
4
3
2
1
5
U1
MAX4124EUK
4
3
2
1
5
U2
MAX4124EUK
3V3
4.7k
R5
3V3
0.1uF
C2
3V3
0.1uF
C5
0.1uF
C3
10k
R8
10k
R7
0.1uF
C4
1k
R6
3V3
1k
R11
3V3
0.1uF
C6
Threshold Detector
Non-Inverting Amplifier
TP1
TP2
TP3
Frequency response inversely proportional to gain
Total transimpedance gain = R2 x U1Av x U2Av
U1Av = 1 + R4/R5
U2Av = 1 + R10/R8
R4
500k
R12
20k
TP4
R10
1.0M
R2
20k
(2nd Stage)
Non-Inverting Amplifier
(1st Stage)
PIC201
PIC202
COC2
PIC301
PIC302
COC3
PIC401
PIC402
COC4
PIC501
PIC502
COC5
COC6
COR2
PIR40CCW
PIR40CW
PIR40W
COR4
PIR501
PIR502
COR5
PIR601
PIR602
COR6
PIR701
PIR702
COR7
PIR801
PIR802
COR8
PIR100CCW
PIR100CW
PIR100W
COR10
PIR1101
PIR1102
COR11
PIR120CCW
PIR120CW
PIR120W
COR12
PITP101
COTP1
PITP201
COTP2
PITP301
COTP3
PITP401
COTP4
PIU101
PIU102