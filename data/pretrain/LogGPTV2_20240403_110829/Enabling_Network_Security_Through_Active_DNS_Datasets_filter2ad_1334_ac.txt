### 4.1 Enhancing Public Blacklists

Due to the nature of Thales, we can leverage collected data to identify potential abuse signals from domains before they are officially classified as malicious. For example, blacklisted domains are a key category of indicators that can be registered, set up, and pointed to an IP address well before they are used in malicious activities. Therefore, active DNS data can serve as a valuable source for timely domain abuse detection.

As previously discussed, in addition to collecting active DNS data, we also gathered a variety of public domain name blacklists. As expected, many of the domain names in these blacklists appeared in our active DNS traces. For each domain name found in both the public blacklists and our active DNS data, we identified two critical dates:
1. The first date when the domain was probed by Thales, which is driven by its inclusion in our seed list, typically due to changes in zone files collected daily from top-level domain authorities.
2. The first date when the domain was listed in one of the public blacklists as part of a specific abusive activity.

We compared these dates and plotted the results in a cumulative distribution function (CDF) to illustrate the time difference in days between a domain's resolution in our passive or active DNS data and its appearance in a public blacklist. Negative values indicate that the domain first appeared in our DNS data before being blacklisted, while positive values indicate that the domain was blacklisted before it was resolved in our data.

It is important to note that not all public domain name blacklists were used as a seed source for Thales; only those described in Sect. 2.2 were utilized. This means we should expect a mix of both positive and negative values in the CDFs. Positive values indicate that a domain was first seen in a blacklist and then in either the active or passive DNS data, while negative values indicate that the domain was first seen in DNS before being blacklisted.

Thales resolves domains partly from zone files for major top-level domains, querying any newly registered domain within a day of its registration. This creates a temporal history of DNS activity, capable of describing the IP infrastructure supporting the domain before, during, and after blacklisting. This is a unique property of active DNS datasets, which is rarely seen in passive DNS data. Active DNS provides a stronger signal than passive DNS because infections are often remediated, and hosts are mobile, making it difficult for network operators to passively observe the evolution of the supporting infrastructure. Thus, Thales can augment existing passive DNS data with a robust signal, enhancing the capabilities of researchers and network operators.

Figure 7 shows CDF plots for different classes of malicious domain names (Figs. 7a to d). The plots include domains from our active and passive DNS datasets that have been blacklisted. For instance, 50% of domain names associated with spam were queried approximately 2.5 months before they were blacklisted. In contrast, for ephemeral attacks like phishing and exploit kits, about 75% of the domain names were queried by Thales at least one day earlier, with the 50% mark being around 50 days earlier.

In total, 42,000 domain names have been blacklisted and appeared in our active DNS dataset. Of these, 30% were queried and data collected for approximately 100 days before blacklisting (Fig. 7e). For 75% of the blacklisted domain names, we have collected data for more than a week before they appeared on a PBL. Given that PBLs are used as ground truth for various security systems [21,23,26,30], we plan to use this data over time to model domain behavior and identify threats long before current systems or even before they are exploited by adversaries.

Additionally, we identified 20,000 domain names in the passive DNS dataset that also appear in blacklists. The dashed line in Fig. 7 represents these domain names. Approximately 50% of the blacklisted domain names appear in the passive DNS data feed, with only 25% revealing themselves 50 days earlier than the blacklisting event (Fig. 7e). In this case, there are only 20,000 domain names that have been blacklisted, with visibility at approximately 15% for the 100 days mark. About 50% of all the domain names were seen roughly two days before they were blacklisted. This supports our claim about the value of active DNS datasets and how they complement existing passive DNS repositories. The early linkage between domain names and IP infrastructure, as witnessed by active DNS data, can enrich the signal in passive DNS data, potentially making local DNS modeling easier for researchers and operators.

In most cases, the active DNS dataset contains domain names far before they appear in either the passive DNS or the blacklist dataset. The intersection between active and passive DNS records that have been blacklisted is approximately 19,000. This is almost half of the domains in the active DNS dataset and 95% of the domain names in the passive DNS dataset. Passive DNS shows better results in the early days for spam domain names (Fig. 7b), but active DNS catches up very fast (within 15 days) and then loses the advantage again at the time of the blacklisting events (0 point in the plot).

Lastly, Fig. 7f depicts the difference between the day a blacklisted domain name was first seen in our active DNS dataset and the day it was seen in our passive DNS dataset. This includes only the domain names that were seen before the PBLs included them. Approximately 17,000 domain names have been found in both active and passive DNS before they were blacklisted. The vast majority were first resolved by Thales, at least one day before they were visited by a system in our university. Approximately 40% of the domain names were already being resolved by Thales for more than 100 days before they appeared in the passive DNS dataset.

### 4.2 Enhancing the Detection of Domainâ€™s Residual Trust Change

On the Internet, domain names serve as trust anchors for numerous systems and services, and ownership of a domain is often sufficient to prove one's identity. Lever et al. [25] highlighted the problems caused by using domains as trust anchors and showed that residual trust, implicitly inherited by domains after an ownership change, is a root cause of many security issues. Therefore, identifying changes in ownership, due to expiration or other causes, is crucial for protecting against the abuse of residual trust. WHOIS [19] is typically used to discover information about the owner of a particular domain, but collecting WHOIS data at scale is challenging due to rate limiting imposed on automated collection. These limits vary by registrar, adding to the complexity. To address this, Lever et al. proposed Alembic, a lightweight algorithm for locating potential ownership changes that relies solely on passive DNS. This algorithm uses three components: changes in infrastructure, changes in lookup volume distribution, and changes in SOA records.

While passive DNS is easier to collect, it is also sparse, leading to two limitations for Alembic: scores can only be computed for domains observed in passive DNS with sufficient historical resolutions. Active DNS can help improve these limitations. First, Fig. 6e shows that active DNS captures many more effective second-level domains than passive DNS. Even large networks, such as a university network, struggle to match the breadth of domains that can be collected using active DNS. Next, active DNS querying can consistently gather specified DNS record types over time. Figs. 5a and b show that active DNS results in substantially more SOA records than passive DNS each day. Since SOA records are a key component of the Alembic scoring, active DNS should enhance the performance of the Alembic scoring algorithm. However, active DNS cannot enhance the lookup volume distribution component, which is derived from user behavior observed in passive DNS.

To evaluate whether Alembic could work using only active DNS, we implemented a modified version of the algorithm that excluded lookup volume distribution and used a fixed window size of two weeks. We computed scores for March 27, 2016, resulting in 63,332,836 domains with non-zero scores, where larger scores indicate a higher confidence in an ownership change. The distribution of these scores is shown in Fig. 8, with the majority falling between 0.4 and 0.5, primarily due to changes in the SOA record. The next largest range was between 0.9 and 1.0, consisting of 5,652,910 domains. According to the algorithm, domains with scores in this range are most likely to have undergone a change in ownership. 5,625,397 (99.5%) of these domains had a score of 1.0, indicating complete changes in both infrastructure and SOA records. We found 10,885 of these domains on a public service's list [5] of expired domains for March 27, 2016, with the remainder providing interesting cases for further study.

Our modified version of the Alembic algorithm, originally proposed by Lever et al., demonstrates how active DNS can enhance or extend existing research. Without active DNS, deploying an algorithm like Alembic would require access to a large-scale passive DNS dataset. However, using openly available active DNS data, as offered by this research, can remove barriers to using or deploying existing DNS research.

### 4.3 Tracking Malicious Domain Names in Non-routable IP Space

Bogons are private, reserved, or otherwise unallocated network blocks [18,32,34]. By definition, they should not host anything in the context of the global Internet. However, occasionally, a domain name, such as `messisux.bix`, resolves to a bogon like `0.0.0.0` despite the fact that this IP cannot host anything. The presence of such a domain name indicates a service that should be globally reachable. These "nonsense" resolutions can be caused by misconfigurations, brand protection services, or malicious actors. To investigate further, we analyzed domain names that resolved to bogon IP space during our analysis, focusing on malicious infrastructure, a primary interest of the security community. However, we also noted that active DNS data resolving to bogons can provide additional insights into the broader landscape of DNS usage.