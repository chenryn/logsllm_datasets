• Starts from one cell,  
combines lines, spheres
• Regenerates after    
failure of most cells
Real Mouse Program
• 3B base pairs
• 98% same as human DNA
• Starts from one cell, 
complex protein interactions
www.cs.virginia.edu/evans/usenix04
35
Towards Real Systems
• Cells
– Sensor Devices, MEMS, Internet Nodes
• Division
– Processes
– Find new hosts
• Communication
– Point-to-point emissions
– Wireless multicast (can be multi-hop) 
diffusions
www.cs.virginia.edu/evans/usenix04
36
Exploiting Awareness of 
Environment: Message Direction
Use Directional Antennas to Mitigate Wormhole Attacks
A
X
B
Y
If Ahears B from its East, Bshould hear Afrom its West
Share information with neighbors to detect all wormholes
Lingxuan Hu and David Evans.  NDSS2004.
Mobile Localization: Lingxuan Hu and David Evans.  MobiCom2004.
www.cs.virginia.edu/evans/usenix04
37
Programs Summary
• Trillions of creatures have died to evolve 
the extremely robust programs that survive 
today
• Small programs with complex interactions
• Robustness and scalability require:
– Redundancy
– Awareness of surroundings
– Locality
www.cs.virginia.edu/evans/usenix04
38
Outline
• Process
– Evolution
• Programs (what results)
– Genotype
• Executions (what they produce)
– Phenotype
(cid:214)Some specific examples
(cid:214)General Principles
• Reasons for Pessimism
Reasons
for
Optimism
www.cs.virginia.edu/evans/usenix04
39
Use Prime Numbers
Cicada
17-year cycles
13-year cycles
Photo © Hilton Pond Center
www.cs.virginia.edu/evans/usenix04
40
Proof-Carrying Turkeys
Turkey wattles, cockerel comb
Red from carotenoid pigments
Extracted from food
Ability to extract is
affected by parasites
Lee Richardson Zoo 
www.cs.virginia.edu/evans/usenix04
41
Software Wattles?
Tripwire, Gene 
Kim and Eugene 
Spafford, 1994
Genuinity (Kennel and Jamieson), USENIX 2003
Shankar, Chew, Tygar, this morning
SWATT (Seshadri, Perrig, van Doorn, Khosla). 
Oakland 2004.
www.cs.virginia.edu/evans/usenix04
42
Viruses and Immune Systems
www.cs.virginia.edu/evans/usenix04
43
Viruses
• Genetic material (RNA) 
with protective coat
• Receptor binding proteins 
attach to cell
• Injects genetic material 
into cell nucleus
• Uses proteins in cell to 
reproduce
• Releases copies to infect 
more cells
200 nm
Influenza Virus
www.cs.virginia.edu/evans/usenix04
44
Influenza Virion
Hemagluttin
~ 400 spikes around virus 
Shape of spikes (encoded 
by virus genome) 
determines what it can bind 
to (red blood cells)
RNA
Envelope
(protective
shell built
using host lipids, 
proteins, and 
sugars)
Capsid
Neuraminidase 
Helps new virions escape 
host cell
www.cs.virginia.edu/evans/usenix04
45
Virus Binding
• To bind to a cell, 
virus receptor 
binding proteins 
must match cell 
membrane 
receptors
Receptor
• Virus is internalized 
by cell, injects RNA 
into nucleus
Host Cell
www.cs.virginia.edu/evans/usenix04
46
Virus Scanning
Antibody
Virions have a 
specific shape to 
bind to hosts, so 
scanners 
(antibodies) can 
recognize that 
shape and block 
virions
Receptor
Host Cell
47
Immune Systems vs. Virus Scanners
• Standard Anti-Virus software scans for 
known attacks: compare code against a 
library of already known attacks
• Approach doesn’t work if new viruses 
emerge quicker than updates
– Internet Worms: spread time ~ 20 minutes
– Human: genome updates ~ 20 years
Need a way to detect and defeat previously unknown attacks
www.cs.virginia.edu/evans/usenix04
48
Pathogen Diversity
• Genetic drift: random point mutations
– Some will be successful, and multiply
– RNA-based viruses mutate very rapidly
• Genetic reassortment: mixing up
– If two strains of influenza virus infect the 
same cell, they mix up their genes
www.cs.virginia.edu/evans/usenix04
49
Receptor Diversity
• Lymphocytes are white blood cells that have 
surface proteins to recognize intruders; when 
stimulated by antigen they make antibodies
• Need to recognize all foreign intruders, but DNA 
can’t know about all (~1016) possible intruders
• Gene segments are randomly combined to form 
different receptors
– Create 107 new lymphocytes every day
– Lymphocytes that match intruders reproduce quickly 
(build immunity)
• But, need to ensure lymphocytes don’t match self
www.cs.virginia.edu/evans/usenix04
50
Recognizing Self
• Major Histocompatibility Complex
– Surface molecules that are unique to 
individual on all cells (except red blood 
cells)
– Authenticate cell as self
– Diversity of MHC types protects a population
• Thymus gland
– Lymphocytes that match self molecules are 
eliminated, others are mature and enter 
body
www.cs.virginia.edu/evans/usenix04
51
Immune System Disorders
• False negatives are immune deficiencies
• False positives are auto-immune 
diseases:
– Reject organ transplants
– Multiple Sclerosis – motor nerve cells are 
antigens
– Rhumatoid Arthritis – connective tissue is 
antigen
www.cs.virginia.edu/evans/usenix04
52
Computer Immunology
• Forrest, Hofmeyr and colleagues, 1994
• Recognize computer intrusions 
• Generate library bit-strings that encode patterns 
of normal behavior (system calls, network 
connections, etc.)
• Generate random detectors: keep ones that 
don’t match the normal behavior
• Recognize behaviors that are abnormal as 
possible intrusions
www.cs.virginia.edu/evans/usenix04
53
Racing Parasites
• Parasites evolve quickly:
– E. Coli bacteria ~ 1 hour per generation
– Influenza virus
• Offspring should be optimized for a 
different environment than their parents 
– parasites have evolved
Matt Ridley, The Red Queen
www.cs.virginia.edu/evans/usenix04
54
Achieving Diversity
• Natural selection reduces diversity
– Will select against inferior genes for particular 
current environment
• Sex maintains diversity
– Obtain multiple forms of a gene (AB blood 
type)
– Retain currently unfavored genes
– Opposites attract!
• Wedekind and Füri found that men and women are 
attracted to odor of members of opposite sex that 
have MHC genes most different from themselves
55
www.cs.virginia.edu/evans/usenix04
Diversity in Computer Systems
• “A computing monoculture is a danger, a 
security danger, a national security danger. It is 
a danger on principle. It is a danger in 
practice.” 
Dan Geer, USENIX Tech 2004
• Microsoft Bashing
– Client OS (2002): Windows (93%)
– Client Applications: Office, IE
– Server OS (2002): Windows (55%), Linux (23%)
A more competitive marketplace might help...but not enough
www.cs.virginia.edu/evans/usenix04
56
Not All Bill’s Fault
• Protocols: IP (100%), TCP (>90%), IEEE 
802.11b/g, Bluetooth
• Firewall/VPN: ISS BlackICE/Real Secure (~20%)
– Enough for Witty Worm (12,000 victim hosts in ~45 
minutes)
• Image processing code: libPNG
– Same vulnerability may be exploitable in IE and Mozilla
on Mac, Windows, Solaris 
Human-engineered diversity is not enough
www.cs.virginia.edu/evans/usenix04
57
Automating Diversity
Key
Variant A
Original
Transformer
Variant B
Goal: 
Make variants that:
1. Look the same to legitimate
users and system administrators
2. Look different to attackers
Variant C
…
www.cs.virginia.edu/evans/usenix04
58
Diversity Techniques
• Modify instructions, memory 
[Cohen 1992], [Forrest+ 1999]
• System calls, library entry points
[Chew &  Song, 2002]
• Instruction set randomization
[Barrantes+, CCS 2003] [Kc+, CCS 2003]
• Addresses [Cowan+, USENIX 2003], [Bhatkar+, 
USENIX 2003]
• Work well against certain code injection attacks
www.cs.virginia.edu/evans/usenix04
59
Perspectives on Diversity
To a Great 
White Shark, 
all humans 
are basically 
alike
Computer systems must be diverse at many
abstraction levels to thwart different attacks
www.cs.virginia.edu/evans/usenix04
60
Data Diversity
Ammann and Knight, 1998
Input
Input
Transformer
Key
Original
Output
Transformer
Key
Output
www.cs.virginia.edu/evans/usenix04
61
Contextual Diversity
• Principle of “Less” Privilege
• Rhythmic Policies
– Divide execution into “beats” and “phrases”
– Allow certain operations only on particular 
beats (e.g., only make system calls every 
7th beat)
– Compiler produces “rhythmic” executable
– VM enforces policy (also transforms 
dynamically)
www.cs.virginia.edu/evans/usenix04
62
Policy Diversity
• Resource Consumption Policies
– Thresholds should be randomly different in 
different installations
• Attacker shouldn’t be able to guess 
resource consumption limits
• Can’t make limits too low and disrupt 
normal usage: diversity helps here
www.cs.virginia.edu/evans/usenix04
63
Diversity Effectiveness
• Attacker can do a lot of work to break one 
variant
– With “luck”, that doesn’t break other variants
– Depends on how fundamentally different they 
are
• If you’re worried about point attacks, vary 
dynamically
• Security through obscuritycan work if you 
can generate lots of obscurity cheaply
www.cs.virginia.edu/evans/usenix04
64
(and Can’t)
• Process
– Evolution
• Programs (what results)
– Genotype
• Executions (what they produce)
– Phenotype
(cid:214)Some specific examples
(cid:214)General Principles
• Reasons for Pessimism
Reasons
for
Optimism
www.cs.virginia.edu/evans/usenix04
65
Attacks Computers Face 
Are Different
• Human engineered, not evolved
• Designed with destruction as a goal
www.cs.virginia.edu/evans/usenix04
66
“Evolution is smarter than 
you are.”
Leslie Orgel’s Law
• Progress in human attacks is (usually) 
gradual: Build on old ideas
– More like virus genetic drift and reassortment
• Biological attacks aren’t designed, but 
scale of evolution makes them fiendishly 
clever
www.cs.virginia.edu/evans/usenix04
67
Out-of-Band/Side-Channel 
Attacks
• Cryptography: dumpster diving, social 
engineering, timing, differential power 
analysis
• Virtual machines: bit flips, convince end 
user to turn off security
www.cs.virginia.edu/evans/usenix04
68
Out-of-Band Attacks in Nature
• Massive Environmental Change
– Permian mass extinction (248M years ago)
• 90-95% of species became extinct
• Humans
– Engineer attacks on particular species
• Pesticides
• Antibiotics
• Vaccine (few eradication successes: smallpox)
www.cs.virginia.edu/evans/usenix04
69
Nature Fails Frequently
• Influenza Pandemic of 1918
– In 2 years, infected 1/5 of world
– Killed 20-40 million people
• ~99.9% of all species on Earth become 
extinct; 5% are always becoming extinct
• Everyone dies eventually (even if some 
genes are immortal)
www.cs.virginia.edu/evans/usenix04
70
Conclusion
• Nature has evolved mechanisms that 
enable species to survive in a hostile world 
where attackers are evolving much faster
– Redundancy, Awareness, Diversity
• But...nothing has evolved (or will) to deal 
with “out-of-band” attacks and nature 
often fails: we need to do much better!
• Two last lessons from cicadas:
– Sleep a lot
– Make a lot of noise when you are awake
www.cs.virginia.edu/evans/usenix04
71
Thanks!
http://www.cs.virginia.edu/evans/usenix04
Students:
Selvin George 
Salvatore Guarnieri
Lingxuan Hu
Steven Marchette
Nate Paul
Qi Wang
Joel Winstead
Jinlin Yang
Charles Zhang
Insighters:
Jack Davidson, Lance Davidson
Serge Egelman, Úlfar Erlingsson
Kevin Fu, Anita Jones, John Knight, 
Barry Lawson, Karl Levitt, Gary McGraw,
Radhika Nagpal, Mike Peck, 
Anh Nguyen-Tuong, Avi Rubin, 
Jonathan Shapiro, Dawn Song, 
Doug Szajda, Chenxi Wang
Funding:
NSF CAREER, ITR (Frederica Darema)
DARPA SRS (Lee Badger)
www.cs.virginia.edu/evans/usenix04
72