### Real Mouse Program
- **Initiation**: Begins with a single cell.
- **Structure**: Combines lines and spheres.
- **Regeneration**: Capable of regenerating even after the failure of most cells.
- **Genetic Composition**: 3 billion base pairs.
- **Similarity to Humans**: 98% identical to human DNA.
- **Development**: Involves complex protein interactions.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Towards Real Systems
- **Components**:
  - **Cells**: Sensor devices, MEMS, Internet nodes.
- **Division**:
  - **Processes**: Division into processes.
  - **Host Finding**: Processes find new hosts.
- **Communication**:
  - **Point-to-Point Emissions**: Direct communication.
  - **Wireless Multicast**: Can be multi-hop diffusions.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Exploiting Awareness of Environment: Message Direction
- **Technique**: Use directional antennas to mitigate wormhole attacks.
- **Example**:
  - If A hears B from its East, B should hear A from its West.
  - Share information with neighbors to detect all wormholes.

**References**:
- Lingxuan Hu and David Evans. NDSS 2004.
- Mobile Localization: Lingxuan Hu and David Evans. MobiCom 2004.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Programs Summary
- **Evolution**: Trillions of creatures have died to evolve extremely robust programs that survive today.
- **Characteristics**:
  - Small programs with complex interactions.
  - Robustness and scalability require:
    - Redundancy
    - Awareness of surroundings
    - Locality

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Outline
- **Process**:
  - Evolution
- **Programs (Results)**:
  - Genotype
- **Executions (Products)**:
  - Phenotype
- **Specific Examples**
- **General Principles**
- **Reasons for Pessimism**
- **Reasons for Optimism**

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Use Prime Numbers
- **Cicada Cycles**:
  - 17-year cycles
  - 13-year cycles

**Photo Credit**: Hilton Pond Center

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Proof-Carrying Turkeys
- **Turkey Wattles and Cockerel Combs**:
  - Red due to carotenoid pigments extracted from food.
  - Ability to extract pigments is affected by parasites.

**Photo Credit**: Lee Richardson Zoo

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Software Wattles?
- **Examples**:
  - Tripwire (Gene Kim and Eugene Spafford, 1994)
  - Genuinity (Kennel and Jamieson, USENIX 2003)
  - Shankar, Chew, Tygar (this morning)
  - SWATT (Seshadri, Perrig, van Doorn, Khosla, Oakland 2004)

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Viruses and Immune Systems
- **Virus Structure**:
  - Genetic material (RNA) with a protective coat.
  - Receptor binding proteins attach to the cell.
  - Injects genetic material into the cell nucleus.
  - Uses cell proteins to reproduce.
  - Releases copies to infect more cells.

**Example**: Influenza Virus (200 nm)

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Influenza Virion
- **Hemagglutinin**:
  - ~400 spikes around the virus.
  - Shape determines what it can bind to (e.g., red blood cells).
- **Envelope**:
  - Protective shell built using host lipids, proteins, and sugars.
- **Capsid**:
  - Neuraminidase helps new virions escape the host cell.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Virus Binding
- **Binding Process**:
  - Virus receptor binding proteins must match cell membrane receptors.
  - The virus is internalized by the cell, injecting RNA into the nucleus.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Virus Scanning
- **Antibody Recognition**:
  - Virions have a specific shape to bind to hosts.
  - Scanners (antibodies) recognize this shape and block virions.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Immune Systems vs. Virus Scanners
- **Standard Anti-Virus Software**:
  - Scans for known attacks by comparing code against a library of known attacks.
  - Limitation: New viruses can emerge faster than updates.
  - Example: Internet Worms spread in ~20 minutes, while human genome updates take ~20 years.
- **Need**: A method to detect and defeat previously unknown attacks.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Pathogen Diversity
- **Genetic Drift**:
  - Random point mutations; some will be successful and multiply.
  - RNA-based viruses mutate very rapidly.
- **Genetic Reassortment**:
  - Mixing up genes when two strains of influenza virus infect the same cell.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Receptor Diversity
- **Lymphocytes**:
  - White blood cells with surface proteins to recognize intruders.
  - When stimulated by an antigen, they produce antibodies.
- **Random Combination**:
  - Gene segments are randomly combined to form different receptors.
  - Creates 10^7 new lymphocytes daily.
  - Lymphocytes that match intruders reproduce quickly, building immunity.
- **Self-Recognition**:
  - Ensures lymphocytes don’t match self.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Recognizing Self
- **Major Histocompatibility Complex (MHC)**:
  - Surface molecules unique to each individual on all cells (except red blood cells).
  - Authenticate cells as self.
  - Diversity of MHC types protects a population.
- **Thymus Gland**:
  - Eliminates lymphocytes that match self molecules.
  - Mature lymphocytes enter the body.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Immune System Disorders
- **False Negatives**:
  - Immune deficiencies.
- **False Positives**:
  - Auto-immune diseases:
    - Reject organ transplants.
    - Multiple Sclerosis: motor nerve cells are antigens.
    - Rheumatoid Arthritis: connective tissue is an antigen.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Computer Immunology
- **Forrest, Hofmeyr, and Colleagues (1994)**:
  - Recognize computer intrusions.
  - Generate library bit-strings encoding patterns of normal behavior.
  - Generate random detectors, keeping those that don’t match normal behavior.
  - Recognize abnormal behaviors as possible intrusions.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Racing Parasites
- **Evolution Speed**:
  - E. Coli bacteria: ~1 hour per generation.
  - Influenza virus: Offspring optimized for a different environment.
- **Reference**: Matt Ridley, *The Red Queen*.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Achieving Diversity
- **Natural Selection**:
  - Reduces diversity by selecting against inferior genes.
- **Sexual Reproduction**:
  - Maintains diversity by obtaining multiple forms of a gene.
  - Retains currently unfavored genes.
  - Opposites attract: Wedekind and Füri found that men and women are attracted to odors of members of the opposite sex with the most different MHC genes.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Diversity in Computer Systems
- **Monoculture Danger**:
  - A computing monoculture is a security and national security danger.
  - Reference: Dan Geer, USENIX Tech 2004.
- **Market Dominance**:
  - Client OS (2002): Windows (93%)
  - Client Applications: Office, IE
  - Server OS (2002): Windows (55%), Linux (23%)

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Not All Bill’s Fault
- **Protocols**:
  - IP (100%), TCP (>90%), IEEE 802.11b/g, Bluetooth.
- **Firewall/VPN**:
  - ISS BlackICE/Real Secure (~20%)
  - Witty Worm: 12,000 victim hosts in ~45 minutes.
- **Image Processing Code**:
  - libPNG: Same vulnerability may be exploitable in IE and Mozilla on Mac, Windows, Solaris.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Automating Diversity
- **Goal**:
  - Create variants that look the same to legitimate users and system administrators but different to attackers.
- **Techniques**:
  - Modify instructions, memory, system calls, library entry points, instruction set randomization, addresses.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Perspectives on Diversity
- **Analogy**:
  - To a Great White Shark, all humans are basically alike.
  - Computer systems must be diverse at many abstraction levels to thwart different attacks.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Data Diversity
- **Transformers**:
  - Input and output transformers with keys to ensure data diversity.

**Source**: Ammann and Knight, 1998

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Contextual Diversity
- **Principle of “Less” Privilege**:
  - Rhythmic Policies: Divide execution into beats and phrases.
  - Allow certain operations only on particular beats.
  - Compiler produces rhythmic executable.
  - VM enforces policy and transforms dynamically.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Policy Diversity
- **Resource Consumption Policies**:
  - Thresholds should be randomly different in different installations.
  - Attacker shouldn’t be able to guess resource consumption limits.
  - Diversity helps in not making limits too low and disrupting normal usage.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Diversity Effectiveness
- **Attacker Effort**:
  - Can do a lot of work to break one variant, but with luck, it doesn’t break other variants.
  - Depends on how fundamentally different the variants are.
- **Dynamic Varying**:
  - Vary dynamically if worried about point attacks.
- **Security through Obscurity**:
  - Can work if you can generate lots of obscurity cheaply.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Attacks Computers Face Are Different
- **Human-Engineered**:
  - Designed with destruction as a goal.
- **Progress**:
  - Gradual, building on old ideas (like virus genetic drift and reassortment).

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Out-of-Band/Side-Channel Attacks
- **Cryptography**:
  - Dumpster diving, social engineering, timing, differential power analysis.
- **Virtual Machines**:
  - Bit flips, convincing end users to turn off security.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Out-of-Band Attacks in Nature
- **Massive Environmental Change**:
  - Permian mass extinction (248 million years ago): 90-95% of species became extinct.
- **Human-Engineered Attacks**:
  - Pesticides, antibiotics, vaccines (e.g., smallpox eradication).

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Nature Fails Frequently
- **Influenza Pandemic of 1918**:
  - Infected 1/5 of the world, killed 20-40 million people.
- **Extinction Rates**:
  - ~99.9% of all species on Earth become extinct.
  - 5% are always becoming extinct.
- **Mortality**:
  - Everyone dies eventually, even if some genes are immortal.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Conclusion
- **Nature’s Mechanisms**:
  - Enable species to survive in a hostile world where attackers evolve faster.
  - Key elements: Redundancy, Awareness, Diversity.
- **Limitations**:
  - Nature fails to deal with out-of-band attacks and often fails.
  - We need to do much better.
- **Lessons from Cicadas**:
  - Sleep a lot.
  - Make a lot of noise when awake.

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)

---

### Thanks!
- **Students**:
  - Selvin George, Salvatore Guarnieri, Lingxuan Hu, Steven Marchette, Nate Paul, Qi Wang, Joel Winstead, Jinlin Yang, Charles Zhang
- **Insighters**:
  - Jack Davidson, Lance Davidson, Serge Egelman, Úlfar Erlingsson, Kevin Fu, Anita Jones, John Knight, Barry Lawson, Karl Levitt, Gary McGraw, Radhika Nagpal, Mike Peck, Anh Nguyen-Tuong, Avi Rubin, Jonathan Shapiro, Dawn Song, Doug Szajda, Chenxi Wang
- **Funding**:
  - NSF CAREER, ITR (Frederica Darema), DARPA SRS (Lee Badger)

**Source**: [www.cs.virginia.edu/evans/usenix04](http://www.cs.virginia.edu/evans/usenix04)