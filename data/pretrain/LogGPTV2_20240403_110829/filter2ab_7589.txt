### Title: BlackHat Asia-22: Codema Attack - Exploiting Dangling Management Channels to Control Your Smart Home

In today's connected world, Internet of Things (IoT) devices can be managed through various channels, such as the device manufacturer's app, third-party apps like Apple's iOS Home, or smart speakers. Each management channel is supported by a framework integrated into the device, provided by different parties. For example, an IoT device that integrates the Apple HomeKit framework can be managed via the Apple Home app. We refer to this type of management framework, including all its device and cloud-side components, as a Device Management Channel (DMC).

Four widely used third-party DMCs are commonly integrated into modern IoT devices, alongside the device manufacturer's own DMC: HomeKit, Zigbee/Z-Wave compatible DMCs, and smart-speaker Seamless DMCs. Each DMC operates as a standalone system with full control over the device. However, if their security policies and controls are not aligned, it can lead to serious consequences. A malicious user could exploit one unsecured DMC to bypass the security controls imposed by the device owner on another DMC. We term this issue Chaotic Device Management (Codema).

To investigate the prevalence and impact of Codema, we analyzed 14 top-rated IoT devices and their integration and management of multiple DMCs. Our findings indicate that Codema is both widespread and fundamental: these DMCs are generally not designed to coordinate with each other for security policies and controls. This misalignment allows adversaries to gain unauthorized access to sensitive smart home devices, such as locks and garage doors.

We reported our findings to the affected parties, including Apple, August Home, Philips Hue, iSmartGate, and Abode, all of whom acknowledged the importance of the issue. To mitigate this new threat, we developed and implemented CGuard, a new access control framework that device manufacturers can easily integrate into their IoT devices to protect end users. Our evaluation demonstrates that CGuard is highly usable and acceptable to users, easy for manufacturers to adopt, and efficient and effective in enhancing security controls.