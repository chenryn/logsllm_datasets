手，或者购买竞争对手的技术和OEM许可。从实用的角度出发，这
也是快速获取大型样本数据库最为简单明了的方式，避免花费大量
的时间使用传统的方式获取样本数据，可以直接复制自己的竞争对
手已经完成的研究。
因此，这个行业被“越大越安全”的市场信息所改变。由于媒体对恶
意程序开始关注，这个行业也随之繁盛。有些读者可能还记得有些
攻击所造成的焦虑，例如PakistaniFlu（1986）、
Jerusalem（1987）、Morris（1988）、Michelangelo（199）、
Melissa（1999）、VBS/Loveletter—"ILove you"(2000）、Code
Red（2001）、Nimda（2001）、Klez（2001）、Blaster（2003）、
Slammer（2003）、Sobig（2003）、Sober（2003）、
MyDoom（2004）等山。每个新发现的病毒都会使媒体产生日益增
长的沮丧感，反病毒行业利用这个趋势成功地在人们心中产生恐
慌，促使顾客购买它们的产品。
有趣的是，另一个助长人们对网络攻击的恐惧感的关键因素与
Intermet没有任何关系，但它深深地印在每个人的脑海里，这就是
2001年9月11日。不论读者本人有没有受到这场悲剧的影响，它毫无
疑问增加了人们的恐惧感。结果，人们对所有类型的安全都更加重
视了。
尽管消费者安全领域的联合直到今天仍在继续，但它的紧迫性已经
被削弱，因为各个厂商不再投资必要的时间和金钱开发独有的数据
库。现在，它们在专业性方面展开竞争，声称自已把注意力集中在
某种特定类型的攻击上（银行木马、游戏未马、恶意程序工具包、
间谍软件、键盘记录器、垃圾邮件/钓鱼、恶意网站等）。这些区别
实质上常常并不十分重要，但是却产生了蛊惑人心的广告效果。
即使随着特性的增强，新的检测技术的出现以及反病毒服务所增加
的复杂性，我们可能会震惊地发现反病毒解决方案的整体效果其实
是在不断地下降。最近对随机PC人口的研究显示，尽管运行了主流
染，这就证明了现在的安全技术虽然很实用，但绝对是不够充分
的。
相同的研究显示这个问题变得越来越糟糕。反病毒产品在检测它们
所要针对的攻击类型时的成功率从2006年的平均50%下降到2007年
的30%
2481
---
## Page 2483
为了公平起见，大多数研究（如果说不是全部）由于使用了有限的
样本集合而存在缺陷，无法表示所有可能的恶意软件样本的真正数
量。我们不应该严肃地使用精确的数字，但这个结果仍然提示了值
得警惕的趋势。不管统计数据的真实性如何，这些研究显然并没有
为当前的方法增强信心。稍后，我们将观察反病毒和反间谍软件产
品的失败原因。
[1]参见
http://en.wikipedia.org/wiki/Timeline_of_notable_computer_viruses_and
worms 
16.1.2不止当行为的回报
链条的下一个环节直接来自Intermet泡沫，投资者将大把大把的金钱
投资在那些思路与Intermet哪怕只有极微弱联系的人的身上，差不多
相当于街上有个陌生人走到你身边，低声说：“！我有个不可思议
的想法，能够让您赚钱....”
这个灾难的其中一个幸存者是广告行业，这个行业在热情拥抱
Internet时找到了金矿。它们的圣杯就是有针对性的广告。他们认识
到了数字网络在记录和筛选数据方面所具有的无可比拟的带来机遇
的能力。因此，他们奋力投身于发掘用户账户并跟踪他们的冲浪习
惯的运动中，创建与行为、偏好、位置等因素有关的统计数据。然
后，他们向其他人出售这些信息，后者根据这些现实世界的数据设
计具有针对性的广告。
他们的技巧取得了引人瞩目的成功，获得了巨大的利润，从而驱使
人们进一步开辟从信息集合中获取利益的途径。最初适度的针对式
广告是免费软件的弹出式厂告，提示用户支付费用或者提供网站厂
告。随后，捆绑式广告组件变得越来越复杂，它们跟踪用户的冲浪
习惯以及其他所有可以通过挖掘主机得到的相关信息。
在恶意软件编写者发现可以通过这些被利润蒙住了双眼、希望自己
的内容出现在用户的计算机上而不管它们是通过什么途径到达那儿
从而使广告商赚钱之前，这些广告最多只不过浪费用户的时间罢
了。赚钱的动力使恶意软件编写者振作起精神，应用他们的丰富知
识欺诈性地安装广告组件。这使他们能够从那些极端愿意把自已的
金钱投人到不管用什么方法，只要能够提高它们的广告安装率的合
法厂告商那里并获取相应的回报。这种由最先进的犯罪活动所带来
2482
---
## Page 2484
的新收入来源促进了一些变化，导致了今天所使用的相当有效的行
业级恶意软件发布技术。（参见ChenxiWang所著的第4章和Ben
Edelman所著的第6章。）
16.1.3暴徒的响应
人们并没有预料到主流广告和恶意欺诈的结合，这种情况经过一段
时间之后才被发现。不同的独立研究人员和网络管理人员小组注意
到了这类欺诈的存在，成立了专门的新闻组（后来是在线论坛），
讨论阻止和消除它们的方法。
注意到这些程序所造成的私密性和安全性问题与反病毒公司声称要
与之作斗争的活动非常相似之后，研究人员和管理员开始向反病毒
公司施压，要求它们采取行动对抗欺诈型的针对式广告。但是成名
的公司却对这个请求缩手缩脚，它们把入侵式广告活动仅仅看成是
一种流氓式商业活动，而不是恶意攻击。
隐蔽性和安全性社区的活动家和热心人士开始收集在他们的技术论
坛上的分散信息，目标是帮助他们的成员找出攻击的来源。这些信
息一开始毫无条理，没什么实用价值。可以实际检测和消除恶意软
件的指令非常稀少，并局限于手工执行的步骤。渐渐地，包含了不
太完整的指导意见的研究报告慢慢变得常见起来。很遗憾的是，这
些论坛还包含了一些不正确的甚至是危险的建议。
迈问反间谋软件措施的实用实现方案的第一步是由GRC.com的Steve
Gibson迈出的，他和许多人付出了很大的努力，向公共和媒体宣传
间谍软件的危害，并开发了第一个称为OptOut的清理工具。这个工
具可以处理一些当前已知的广告攻击。这个工具在设计时主要考虑
了概念可靠性，因此它的效果相对有限，主要是为了推动其他人采
取下一个步骤开发真正的商业隐私解决方案。
在发布OptOut之后不久，德国的一位曾经参与过这些讨论的开发人
员接过了接力棒，开发了一种更为健壮的可以像商业的反病毒程序
一样定期更新的工具。这个工具在更新时并不是通过重写来处理每
个新发现的广告程序或威胁。他认识到（这个社区的其他人也抱有
同样的观念）一—强调反病毒方法（对新攻击所进行紧急的、持续
进行的搜索，并频繁发布可以处理它们的补丁）最终将会失败。但
是，由于当前的技术限制，研究人员接受了这个模型，因为这是他
们唯一可以用来转变以满足紧密和日益增长的需要的实用工具。
2483
---
## Page 2485
这样，一个新的以解决间谋软件所造成的威胁为已任的行业诞生
了。具有讽刺意味的是，隐私社区和反病毒服务用来让公众意识到
它们的问题的推动力是同一种恐惧信息（包括真实的和设想的）。
新产品吸引了越来越多的媒体的注意，推动了反间谋软件的成长，
从一家单独的公司发展为今天的反病毒甚至防火墙来解决问题的有
机组成部分。
这个变化为反病毒公司文赢得了一线生机，甚至开启了新一轮联合
的大门。现在已经出现了大量独特的恶意软件签名数据库，反病毒
软件公司想把它们融人到自己的产品中。明百了病毒和间谍软件之
间明显的相似性之后，它们走到一起只是时间问题。
这有什么不对劲的地方吗？它的极大成功抑制了开发新的惯用法以
及处理它们的产品中明显缺陷的道切动力。只要公司能够保持竞争
优势，能够通过具有吸引力的方式扩展供应并增加收入，在发展研
究和创建方面总是动机滞后于实干。这些因素加上它们所面临的激
烈竞争坏境，将会抑制它们在战略上任何真正的改变。
简单地进行历史总结，尽管越来越多的安全专家充满热情和作出令
人称赞的贡献，但过去15年里反病毒和反间课软件行业的主要特征
就是穷举式集合以及对现有恶意软件的分析。通过一种“越大越好
的方法，它们的产品吸收了竞争产品的优点并对研究人员设计的最
初产品做了创新，增加了它们的复杂性，以处理具有创造性的新威
胁。现在我们探讨，为什么我们已经遇到了这种方法的瓶颈，为什
么它已经成为一种不充分的方法。
16.2揭穿假象
在本节中，我们将回顾每种类型的安全解决方案，观察它是如何保
护计算机的以及它会在什么地方失败。
16.2.1严格审查：传统的和更新的反病毒扫描
第一个解决方案是传统的、基于签名的反病毒/反间谍软件过滤器。
这种程序把文件与一个定期更新的不良内容的“黑名单”进行比较。
如果这个文件位于这个列表中，过滤器将根据黑名单的指令阻止或
删除这个文件。任何没有出现在黑名单上的东西都被认为是良好
的。
2484
---
## Page 2486
黑名单方法的演变
事实上，当人们连接到Iinternet之后，黑名单方法就变得过时了，因
为它允许恶意软件跨越地理边界，在人们的眼皮底下传播。
反病毒软件供应商毫无疑问很早就意识到了签名方法最多只是一种
短期的解决方案，最终将无法提供先进的可靠保护。为了使用这种
方法提供保护，生产商首先必须掌握恶意软件的样本。接着，它必
须对它的签名进行更新，以便正确地确认和删除目标内容。
问题在于研究人员只有在恶意软件被发布之后才能隔离并查看它的
样本，以前有时要滞后几个月甚至几年。到目前为止所发现的基于
Windows的最危险的恶意程序工具包之一的Rustock.C就是这方面的
一个好例子，它在Intermnet上肆虐了超过一年之后才被发现、分析并
添加到检测签名中。即使是每日的更新也无法向生产商提供足够的
时间寻找、分析和发布针对新恶意软件的防护措施，因此用户容易
受到未知攻击的伤害（所谓的0day攻击）。
根据这些描述，一种很合理的结论是，研究人员所寻找的是恶意软
件的旧版本，其他恶意并发人员和“用户"有足够的时间来应付。每
种恶意攻击很快改变为某种全新的东西，或者把它的有些功能融入
到其他东西中。
而且，尽管反病毒公司所维护的开发队伍的人数可能高达几百，但
他们所积压的恶意软件的确认和签名生成任务也在不断地增加。他
们每大从他们的"honeypot"网络和其他来源接收到数以方计的新的怀
疑项。简而言之，寻找恶意软件的成本不断上升，而反恶意软件产
人们很早就意识到，基于签名的扫描系统虽然在过去被证明是行之
有效的，但是由于恶意软件的巨大数量以及它的极快变化率，它注
定只是一种单纯防御，尤其是最近出现行业化的、有组织的恶意软
件开发，使恶意软件的总量只过了一年（2007）就增加了100%。下
一个解决方案是前一种的一个变型，在它的基础上增加了试探法，
这种方法拓宽了防护程序的有效性，但它有一个非常遗憾的趋势就
是会增加假阳性率，就是把良好的文件看成是不良文件。这种方法
并不会使用户更加安全，而是会使他麻痹（多次叫喊“狼来了！"的
结果）或者增加他的恐惧。前一种情况使系统对攻击大开方便之
门，因为警告会被忽略。第二种情况会导致用户寻求更多的护身
2485
---
## Page 2487
符，因为不管广告是怎么宣传的，实际上并没有一种扫描方法能够
100%地检测到所有的恶意软件。
白名单方法
另一种方法是不再依赖黑名单的可靠性，而是把注意力集中在哪些
东西实际上是没有问题的，这种方法称为白名单。对于反病毒厂商
来说，这应该是非常简单的，只要简单地禁止任何新的或未知的东
西就可以了。
实现这种方法的一个途径是使用反可执行文件。正如它的名称所提
示的那样，这种防御措施阻止程序被运行或激活。这种策略相当于
WindowsVista用户经常看到的恼人对话框，迫使他们在申请一些日
常管理活动后点击一个按钮。