# OCR Output
## Page 1
PRACTICAL PACKET ANALYSIS 2NDEDITION
Wireshark数据包
[美] Chris Sanders 著
分析实战
:0000
诸葛建伟 陈霖许伟林译
（第2版）
---
## Page 2
PRACTICAL PACKET ANALYSIS 2ND EDITION
Wireshark数据包
[美] ChrisSanders
分析实战
人民邮电出版社
著
北京
诸葛建伟 陈霖许伟林译
（第2版）
---
## Page 3
计算机网络一数据一分析一应用软件IV.TP393.09
版权声明
任何部分不得以任何方式复制或抄袭。
reserved.
ISBN978-7-115-30236-6
Wireshark数据包分析实战
图书在版编目（CIP）数据
本书中文简体字版由美国No Starch出版社授权人民邮电出版社出版，未经出版者书面许可，对本书
中国版本图书馆CIP数据核字（2012）第294560号
版权所有，侵权必究。
①w.I.
读者服务热线：（010）67132692印装质量热线：
开本：800x10001/16
三河市海波印务有限公司印刷
人民邮电出版社出版发行
责任编辑
州
印数：1-4000册
字数：355千字
印张：17.75
网址http://www.ptpress.com.cn
邮编100061
Wireshark数据包分析实战（第2版）
陈霖，许伟林译
著作权合同登记号图字：01-2012-2971号
傅道坤
诸葛建伟陈霖许伟林
[美]ChrisSanders
电子邮件PI:EMAIL
反盗版热线：
ISBN978-7-115-30236-6
定价：49.00元
(010)67171154
北京市崇文区夕照寺街14号
2013年3月河北第1次印刷
2013年3月第1版
（010)67129223
---
## Page 4
络工程、信息安全等专业学生与网络技术爱好者阅读。
技术，同时也给出了噢探与数据包分析领域丰富的参考技术文档、网站、开源
工具与开发库等资源列表。
并找出原因以解决实际问题。本书覆盖了无线WiFi网络中的噢探与数据包分析
击等），来讲解如何应用Wireshark数据包分析技术和技巧，快速定位故障点，
正常上网、程序连接数据库错误、网速很卡，以及遭遇扫描渗透、ARP欺骗攻
管理员、IT技术支持、应用程序开发者们经常遇到的实际网络问题（包括无法
够顺着本书思路逐步地掌握网络数据包噢探与分析技能。最后，本书使用网络
络案例，图文并茂地演示使用Wireshark进行数据包分析的技术方法，使读者
络的具体实践技术与经验技巧。在此过程中，作者结合一些简单易懂的实际网
本使用方法及其数据包分析功能特性，同时还介绍了针对不同协议层与无线网
本书适合网络管理员、安全工程师、软件开发工程师与测试人员，以及网
本书从网络嗅探与数据包分析的基础知识开始，渐进地介绍Wireshark的基
内容提要
---
## Page 5
关于作者
联系作者
顿，以国防承包商的身份工作。
你在Twitter上成为@chrissanders88的粉丝
可以将你的疑问、评论、批评，甚至是求婚信，直接发送到我的电子邮箱
我非常期盼能够收到本书读者的反馈，如果你出于任何原因想联系我，你
---
## Page 6
的话，他也会成为一个好人。我非常幸运能够和一些优秀人士一起工作，你们
提供了建议，并让我占用了你家的车库长达6个月之久。
都已经是很大的帮助了。谢谢你成为我的好朋友和合作者，在很多项目中为我
视作我第二个母亲。如果没有你的支持和信任，我今天不会在做我自己想做的
我的亲生父母没有差异。
没有能像我所期望的那样经常会面，但我深深地感谢你们，对我来说，你们和
我没有一个大家庭，但我非常珍视我所拥有的亲情，特别是你们。尽管我们并
我自豪。
在天堂注视着我，并为我而自豪，我希望我能够继续努力，能够让你更加为
他任何事情能够让我更加高兴。对此，我对你真是感谢不尽。
事情
感谢我的同事们（过去的和现在的），我一直相信如果一个人周围都是好人
TinaNance，虽然最近我们并没有像以前那样有很多的交谈，但我一直将你
Debi叔叔和Randy阿姨，你们从我写书的第一天起就是我最大的支持者。
JasonSmith，你比其他任何人都承受了更多我的牢骚，
妈妈，本书第2版将在你过世10周年纪念日的前夕出版，我知道你一直
爸爸，我从很多来源获得动力，但比起听到你说你因为我而骄傲，没有其
本书的成功出版离不开很多人的直接贡献和间接支持。
致
谢
仅仅这样对我来说
---
## Page 7
是最棒最聪明的，你们是我的家人。
有趣的活儿，但是绝对必要并需要感谢。
仅是一次，而是两次的机会，谢谢你们对我的容忍和耐心，并帮助我让我的梦
么就不会像现在这样有趣。
想成真。
感谢Bill和No Starch出版社的同仁给予我这位来自肯塔基州的小人物不仅
---
## Page 8
关于译者
学士学位。新浪微博：@Larch爱刀刀。
微博：@清华诸葛建伟。
译的畅销图书有《网络攻防技术与实践》、《Metasploit渗透测试指南》等。新浪
队发起人和现任负责人、信息安全领域培训讲师和自由撰稿人，编写与参与翻
神科研团队负责人、CCERT紧急响应组成员、著名开源信息安全研究团队The
代码，并负责新浪微博@Nmap网络扫描的维护工作。新浪微博：@许伟林。
Nmap和TheHoneynetProject贡献IPv6主机发现模块与IPv6攻击检测器的开源
学获得计算机科学学士学位，曾两次参与GoogleSummerofCode计划，分别为
诸葛建伟，博士，现为清华大学网络与信息安全实验室副研究员、狩猎女
许伟林，现为清华大学网络与信息安全实验室助理工程师，于北京邮电大
陈霖，现就读于洛桑联邦理工学院硕士项目，于北京大学获得计算机科学
---
## Page 9
者
软件在网络安全与取证分析方面的重要作用与流行度。与此同时，Wireshark更
Metasploit、Nessus、Aircrack与Snort，占据榜首位置，这充分体现了Wireshark
场景案例来讲解数据包分析的基础技术、高级特性与实际应用技能。
数据包抓包与分析工具一
测试人员必备的基本技能，然而可惜的是国内却没有优秀的实用技术培训教材
软件开发工程师与测试人员所广泛使用。
断、网络应用开发与调试等各个方面都作为基本手头工具，而被网络管理员、
是一个通用化的网络数据噢探器与协议分析器，在网络运行管理、网络故障诊
础知识与技能，并掌握相关技能与方法来解决工作中的实际挑战，
序
大量宝贵时间，并对数据包分析技术的自我修炼不得要领。
Wireshark在2011年最新的 SecTools安全社区流行软件排行榜中，超越
谨以此书献给中国农村渴望得到更多计算机基础教育的孩子们！
决的实践技术方法。
尽管网络数据包分析技术是网络管理员、安全工程师、软件开发工程师与
Wireshark-
一作为基础软件，通过大量生动的真实
而往往只能
---
## Page 10
括无法正常上网、部署分部网络、程序连接数据库错误、网速很卡，以及遭遇
书以网络管理员、IT技术支持、应用程序开发者经常遇到的实际网络问题，包
使读者能够顺着本书思路逐步地掌握网络数据包探与分析的技能。最后，本
文并茂地结合这些具体案例来演示使用Wireshark进行数据包分析的技术方法，
技术和经验技巧，在此过程中，作者使用了简单易懂的一些实际网络案例，图
Wireshark的数据包分析功能特性，以及针对不同协议层与无线网络的具体实践
学生设立奖学金，致力于减少乡村学生与城市同龄学生们之间的数字鸿沟。
要程度。此外，本书在2007年第一版基础上又增加了更多的技术内容和案例，
排名位居Top20，以及4星半的良好评价，也验证了本书在网络安全领域的重
术文档、网站、开源工具与开发库等资源列表。
嗅探与数据包分析技术，同时也给出了在噢探与数据包分析领域丰富的参考技
巧，快速定位故障点与原因并解决实际问题。本书也覆盖了无线WFi网络中的
扫描渗透与ARP欺骗攻击等，来讲解如何应用Wireshark数据包分析技术和技
地描述出原书作者期望传递给读者的知识与技能。
推敲和统一全书技术词汇的译法，确保对翻译内容的技术掌控，从而能够忠实
译正值学校暑假，因此译者团队也都投入了充分的时间来保障翻译质量，仔细
仔细的统稿与审校，并由陈爱华、陈建军、刘跃、崔丽娟进行了试读。本书翻
陈霖译第47章，许伟林译第8~11章与附录。全书内容由诸葛建伟进行全面
和进度，我们组织起了3人的译者团队，由诸葛建伟译序、前言和第1~3章
那获知了本书下落，也非常高兴地接受了他们的翻译邀请。为了平衡翻译质量
秀的作品。机缘巧合的是，在新浪微博上回复一位读者@过来的微博评论时，
权的激烈竞争中，人民邮电出版社最终胜出，这也让译者一度认为无缘这本优
时，译者就已经对本书赞誉有加，并给出了引进的建议。之后，在本书中文版
专家后，成立了一家乡村科技基金会，并将本书的所有版税捐赠出来，为乡村
了本书的创作。他出生于美国的乡村地区，在通过自身努力成为一位网络技术
是通过了市场检验的一本好书。
本书原版取得了国外读者的一致好评，在Amazon网络安全领域图书销售
本书和译者也非常有缘，在2011年10月为电子工业出版社进行书籍评估
更加难能可贵的是，本书作者ChrisSanders是带着一颗善良感恩的心完成
在翻译到前言部分，获知本书作者的成长经历以及对乡村学生所做的公益事
---
## Page 11
在着大量的废旧电脑资源，城市里每年淘汰的电脑就达500万台。
维修之后，为打工子弟小学建立电脑室，将公益的精神传递下去。我们也非常
稿费捐赠给清华大学学生教育扶贫公益协会，通过@电脑传爱活动，将旧电脑
用至少2年。
过电脑维修做些公益并积累社会实践经验，也非常欢迎加入到@电脑传爱组织
过新浪微博@电脑传爱，也可以@清华诸葛建伟。如果你是高校学生，希望通
公益做出了一份贡献。如果你愿意捐赠淘汰的电脑和计算机基础书籍，欢迎通
欢迎读者能够参与公益事业，事实上，各位读者在购买本书的同时，就已经为
的高校电脑维修公益志愿者活动。
它汇成可以改变世界的力量！
因此译者团队达成共识，将本书的公益特性进行到底，决定将本书的译者
公益是举手投足之间的事，我们倡议，每个人为社会公益奉献一点点，让
一台电脑开启一扇窗，
电脑传爱行动
一次行动传递一份爱！
告
口
2013年1月于北京清华园
诸葛建伟陈霖许伟林
---
## Page 12
为什么购买本书
有比实际的经验更加重要的了，而本书通过大量的真实场景中的数据包分析案
答案在于本书的书名：Practical PacketAnalysis。让我们面对这样的现实一
也会喜欢本书，因为新版拥有全新设计的场景和扩展后的充实内容。
写作方式，以一种简单容易理解的风格来展示技术。如果你不喜欢第1版，你
是一位网络安全分析师，你都可以从本书描述的理解与使用数据包分析技术中
案例。无论你是一位网络技术员、网络管理员、首席信息官、IT技术支持，还
前置条件。后半部分则完全是一些你在日常网络管理中很容易遇到的一些实际
例，让你获得最贴近实际的经验。
果你喜欢本书第1版，那么你也会喜欢本书，因为本书采用了与第1版同样的
几乎都经过了重写，并采用了完全重新设计的网络捕获数据包文件和场景。如
本书出版之日，已经距离本书第1版发布的时间有4年之久。本书的所有内容
本书的前半部分将为你提供理解数据包分析技术和Wireshark软件的必备
你一定很想知道为什么应该买这本书，而不是其他关于数据包分析的书籍
本书从2009年底开始编写，在2011年中期完成，总计历时一年半。而在
一设
---
## Page 13
概念与方法
获得很多的收获。
大的肯塔基州来的，所以我不得不收起我们的一些夸张语气，但你如果在本书
清晰，让所有的定义更加明确、直白，没有任何繁文节。然而我终究是从伟
中看到一些粗野的乡村土话，请务必原谅我。
应该可以应用所学到的概念与技术，来解决你所遇到的实际问题。
的实战内容，
介绍的概念，
数据包分析的基础知识。
如果你真地想学习并精通数据包分析技术，你应该首先掌握本书前几章中
可以使用的各种不同技术方法。
的世界，我们将介绍Wireshark软件的入门知识一
子，来了解一些比较少见的操作。
接下来让我们快速浏览本书各个章节的主要内容。
·第5章：“Wireshark高级特性”，
，或许你在工作中并不会遇到完全相同的场景，但你在学习本书后
，因为它们是理解本书其余部分的前提。本书的后半部分将是纯粹
一哪里可以下载到，如何使用
---
## Page 14
如何使用本书
数据包的层次上来看。
带你了解3种最为常见的高层网络通信协议一
这些网络协议中发生的故障，你首先需要理解它们是如何工作的。
以及最初的现实世界场景中的案例。每个案例将采用一种容易跟随的方式进行
网络通信协议一
你可以从中找到继续使用你所学到的数据包分析技术的进一步资料。
题的实际案例。
的热点问题，本章将带给你几个关于如何使用数据包分析技术解决安全相关问
络性能很慢的情况，本章便是专门为解决这一问题而设计的。
据包分析技术的理解与掌握。这种方式会特别关注后面几章中的现实世界场
流量分析的几个案例。
算机，
展示，
中一本非常有用的参考书，当你需要快速重温如何使用Wireshark软件的某个特
到的，所以你可能会忘记它们是如何工作的。数据包分析实用技术是你的书柜
景案例。
装，讨论了无线数据包分析与有线数据包分析技术的差异，并包含了无线网络
·第7章：“常见高层网络协议”，继续讲解网络协议的相关内容，本章将
·附录A：“延伸阅读”，本书附录给出了其他一些参考工具和网站列表，
·作为一本教学书籍，你可以按一章接着一章的顺序阅读，来获得对数
我期待本书按照如下两种方式进行使用。
第11章：“无线网络数据包分析”，本章是无线网络数据包分析技术启
第10章：“安全领域的数据包分析”，网络安全是信息技术领域中最大
以及很少的分析一
包括问题、分析和解决方法。这些基础场景案例仅仅涉及到少量儿台计
第9章：“让网络不再卡”，网络技术人员最普遍遇到的网络问题便是网
作为一本参考索引资料，有些Wireshark软件的特性是你不会经常使用
—比如TCP、UDP和IP
一仅仅能够将你的脚打湿。
一从数据包的层次上来看。为了解决
HTTP、DNS与DHCP-
一井从
---
## Page 15
关于示例网络数据包捕获文件
乡村科技基金会
说明，已经被证明能够作为你进行数据包分析的有用索引参考。
载这些文件，并在你学习每个真实案例时使用它们。
利性组织，而这正是我最大梦想成为现实的巅峰时刻。
出的这一美好事物。在本书第一版出版后不久，我创办了一个501（c）（3）的非营
http://www.ruraltechfund.org/
比起城市与市郊的学生们，乡村学生即使拥有很优秀的成绩，仍然很少有
在我编写本书的前言时，我无法不提及由数据包分析实用技术书籍而衍生
—译者注
---
## Page 16
第2章监听网络线路
第1章数据包分析技术与网络基础
2.2
2.1
1.4小结
1.3流量分类
1.2网络通信原理
2.3
1.1
2.3.2集线器输出
2.3.1端口镜像.
1.3.3单播流量
1.3.1广播流量
1.2.4网络硬件
1.2.1协议
1.1.1评估数据包噢探器
数据包分析与数据包嗅探器
在交换式网络中进行噢探
在集线器连接的网络中进行噢探
混杂模式
1.3.2
1.2.3
1.2.2
1.1.2数据包噢探器工作原理