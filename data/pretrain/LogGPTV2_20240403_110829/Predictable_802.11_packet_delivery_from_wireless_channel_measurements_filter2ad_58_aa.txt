title:Predictable 802.11 packet delivery from wireless channel measurements
author:Daniel Halperin and
Wenjun Hu and
Anmol Sheth and
David Wetherall
Predictable 802.11 Packet Delivery from
Wireless Channel Measurements
Daniel Halperin∗, Wenjun Hu∗, Anmol Sheth†, and David Wetherall∗†
University of Washington∗ and Intel Labs Seattle†
ABSTRACT
RSSI is known to be a ﬁckle indicator of whether a wireless link
will work, for many reasons. This greatly complicates operation
because it requires testing and adaptation to ﬁnd the best rate, trans-
mit power or other parameter that is tuned to boost performance.
We show that, for the ﬁrst time, wireless packet delivery can be
accurately predicted for commodity 802.11 NICs from only the
channel measurements that they provide. Our model uses 802.11n
Channel State Information measurements as input to an OFDM re-
ceiver model we develop by using the concept of effective SNR. It
is simple, easy to deploy, broadly useful, and accurate. It makes
packet delivery predictions for 802.11a/g SISO rates and 802.11n
MIMO rates, plus choices of transmit power and antennas. We re-
port testbed experiments that show narrow transition regions (90%),
outside of a narrow (7 dB for 10% of the links). A key
factor in this improvement is the use of effective SNR to capture
frequency-selective fading, which is clearly visible in our testbeds.
No published work has explored effective SNR measures in 802.11
beyond simulation, to the best of our knowledge. Note that our ef-
fective SNR model does not predict the performance of links under
interference. However, our measurements show that its estimate
of interference-free link quality is robust to interfering transmis-
sions (§5). We also discuss ways to handle persistent interference.
Our method is practical and can be applied to many classic prob-
lems, including rate adaptation, transmit power tuning, and channel
and antenna selection. While we must leave most of this to future
work, we demonstrate how our model can inform rate adaptation.
Our second contribution is a rate selection algorithm that is as good
as the best 802.11a/g rate adaptation algorithms and extends this
excellent performance to 802.11n. Our algorithm simply uses our
model to predict the highest rate for the channel, repeating to track
the channel over time. We use a trace-driven simulation to compare
it with SampleRate, which is widely used in practice, and SoftRate,
which has the best published performance. Our algorithm tracks
the best rate nearly as well as is possible, even for dynamic mobile
channels. It performs very well for MIMO rates, and supports en-
hancements such as transmit power trimming and antenna selection.
As far as we are aware, there is no other reported work on 802.11n
rate adaptation that is evaluated for real, 802.11 channels, and no
other rate adaptation algorithms that support these enhancements.
In the rest of this paper, we ﬁrst motivate the need for better de-
livery predictions in §2, and then present our model in §3. Our ex-
perimental testbeds are described in §4, and our model is evaluated
in §5. In §6, we use simulation to study rate selection guided by
our model. §7 discusses related work, and §8 concludes the paper.
Modulation Coding Rate Data Rate (Mbps)
BPSK
QPSK
QPSK
QAM-16
QAM-16
QAM-64
QAM-64
QAM-64
1/2
1/2
3/4
1/2
3/4
2/3
3/4
5/6
6.5
13.0
19.5
26.0
39.0
52.0
58.5
65.0
Table 1: 802.11n single-stream rates.
2. MOTIVATION
Existing predictions of packet delivery for a given link are based
on its Received Signal Strength Indication (RSSI) value. This is
widely available as a proxy for the SNR. We characterize this map-
ping to motivate our research.
802.11 Setting. Our work applies to 802.11a/g/n radios that use
coded Orthogonal Frequency Division Multiplexing (OFDM). 20 or
40 MHz channels are divided into 312.5 kHz bands called subcar-
riers, each of which sends independent data simultaneously. Con-
volutional coding is applied across the bits for error correction and
bits are interleaved to spread them in frequency. Each subcarrier
in a packet is modulated equally, using BPSK, QPSK, QAM-16, or
QAM-64, with 1, 2, 4 or 6 bits per symbol, respectively. The data
rates depend on the combination of modulation and coding.
Our experimental platform uses 802.11n radios that operate on
20 MHz channels. The single-stream 802.11n rates are shown in
Table 1. The main innovation in 802.11n is the use of multiple an-
tennas for spatial multiplexing. By using MIMO processing, multi-
ple streams can be sent at the same time, each at the single-stream
rate, for higher overall rates. Note that the details of single-stream
802.11n differ slightly from 802.11a/g (optimized coding rates and
more data subcarriers), but in ways that are not material for our
work so that we can treat 802.11n as a superset of 802.11a/g.
Packet Delivery versus RSSI/SNR. Textbook analyses of modu-
lation schemes give delivery probability for a single signal in terms
of the signal-to-noise (SNR) ratio [8], typically expressed on a log
scale in decibels. This model holds for narrowband channels with
additive white Gaussian noise. It predicts a sharp transition region
of 1–2 dB over which a link changes from extremely lossy to highly
reliable. This makes the SNR a valuable indicator of performance.
RSSI values reported by NICs give an estimate of the total sig-
nal power for each received packet. From RSSI, the packet SNR
can then readily be computed using NIC noise measurements.1 We
generated performance curves using SNR for a real 802.11n NIC
over a simple wired link with a variable attenuator and for a sin-
gle transmit and receive antenna. The result is shown for all single
antenna 802.11n rates in Figure 1(a). We observe a characteristic
sharp transition region for packet reception rate (PRR) versus SNR.
This is despite the relatively wide 20 MHz channel, 56 OFDM sub-
carriers, coding and other bit-level operations. This is the behavior
we want from a link metric in order to predict packet delivery.
In contrast, packet delivery over real wireless channels does not
exhibit the same picture. Figure 1(b) shows the measured PRR ver-
sus SNR for three sample rates (6.5, 26, and 65 Mbps) over all wire-
less links in our testbeds, using the same 802.11n NICs. The SNR
of the transition regions can exceed 10 dB, so that some links easily
work for a given SNR and others do not. There is no longer clear
separation between rates. This is consistent with other reported
1We refer to the metric computed from RSSI and noise measure-
ments as the packet SNR, RSSI-based SNR, or simply RSSI.
160(a) A wired 802.11n link with variable attenuation has a
predictable relationship between SNR and packet recep-
tion rate (PRR) and clear separation between rates.
(b) Over real wireless channels in our testbeds, the transition