c
n
a
t
s
d
.
t
a
t
S
i
NodeLink
ValueLink
HistoLink
1.4
1.2
1
0.8
0.6
0.4
0.2
0
5000
10000
15000
20000
25000
30000
Number of nodes
(b)
Figure 3: Accuracy of random-walk based sampling. Figure (a) shows the e(cid:11)ect of the degree of the graph.
(n = 10000; log n = 14; NodeLink overlay.) Figure (b) shows the e(cid:11)ect of link structure.
6000
5000
h
t
g
n
e
L
k
n
L
i
e
g
a
r
e
v
A
4000
3000
2000
1000
0
0
HistoLink [1:1]
HistoLink [10:10]
NodeLink
ValueLink
2000
4000
Node Id
(a)
6000
8000
10000
D
I
r
o
b
h
g
e
N
i
D
I
r
o
b
h
g
e
N
i
 10000
 9000
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
 0
 10000
 9000
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
 0
 1000
 4000
 7000
 10000
Node ID
(b) NodeLink
 1000
 4000
 7000
 10000
Node ID
D
I
r
o
b
h
g
e
N
i
D
I
r
o
b
h
g
e
N
i
 10000
 9000
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
 10000
 9000
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
 0
 1000
 4000
 7000
 10000
Node ID
(c) ValueLink
 1000
 4000
 7000
 10000
Node ID
(d) HistoLink [1:1]
(e) HistoLink [log n : log n]
Figure 4: Distribution of long-distance links. Plot (a) summarizes the average link length as a function of
the Node ID for the di(cid:11)erent link construction algorithms. Plots (b)-(e) provide more detail about the links
constructed by each algorithm. In plots (b)-(e), the Y-axis plots the ID of the k = log n neighbors for each
node on the X-axis. Nodes are consecutively arranged on the hub circle. Number of nodes = 10000. For
HistoLink, [k1 : k2] means k1 nodes were queried per round each giving k2 estimate reports; 5 exchange rounds
were performed.
they can be easily multiplexed and piggy-backed (by simply
appending the IP address of the requesting node) over the
regular keep-alive pings that might be sent between neigh-
bors. Also, if the samples are uniformly distributed over
all nodes, each node receives O(1) sample requests per sam-
pling period. Hence, we conclude that the overhead of the
sampling method is very small.
5.2 Nodeâ€ºCount Histograms
In this section, we evaluate the accuracy of the node-
count histograms obtained by nodes using the mechanism
described in Section 4.2. These histograms, introduced in
Section 4.2.1, provide an estimate of the total number of
nodes in the system and help in establishing the long-distance
links correctly.
We measure the accuracy of the obtained histogram in
terms of its distance from the \true" histogram under the
L1 norm. Figure 5(a) plots the average accuracy of the
histogram (the average is taken over all nodes) as the pa-
rameters for the histogram maintenance process are varied.
In this experiment, 10 rounds of exchanges were performed.
We see that the error is consistently small and decreases
rapidly as the number of the nodes queried per round in-
creases.9 Although not obvious from the graph, the same
pattern is observed when the number of reports queried from
each node is increased. These e(cid:11)ects are expected, since the
number of samples received by each node per round grows
linearly with either of these parameters.
Figure 5(b) plots the overall node-count estimates pro-
duced by each node in a system of n = 10000 nodes. The
experiment was run for 10 exchange rounds, with k1 = k2 =
log n. We see that the estimates are very tightly clustered
around the actual node-count value of 10000.
During each round of the histogram maintenance process,
each node queries k1 randomly sampled nodes and receives
k2 estimate samples from each node. The messaging over-
head per round per node is thus proportional to k1k2.
5.3 Routing Performance
We now present an evaluation of the overall routing per-
formance of Mercury. This factors in the e(cid:11)ects of the ran-
9The graph does show some (cid:13)uctuations, but their magni-
tudes are tiny (result of experimental variations).
r
o
r
r
e
m
a
r
g
o
t
s
H
i
l
)
e
a
c
s
g
o
l
(
 0.1
 0.01
 0.001
 0.0001
1 reports per round
6 reports per round
14 reports per round
 0
 10
 20
 30
 40
 50
 60
 70
 80
Number of nodes queried per round
)
e
c
n
a
t
s
d
i
0
_
L
(
t
e
a
m
i
t
s
e
t
n
u
o
c
e
d
o
n
l
a
t
o
T
 10200
 10150
 10100
 10050
 10000
 9950
 9900
 0
 1000  2000  3000  4000  5000  6000  7000  8000  9000  10000
Node ID
s
p
o
h
g
n
i
t
u
o
r
#
e
g
a
r
e
v
A
12.4
12.2
12
11.8
11.6
11.4
11.2
11
10.8
1 reports per round
6 reports per round
14 reports per round
0
10
20
30
40
50
60
70
80
90
100
Number of nodes queried per round
(a) Histogram error (L1-distance)
(b) Node count estimates
(c) E(cid:11)ect on routing performance
Figure 5: Accuracy of sampled histograms. (n = 10000) Figure (a) shows the e(cid:11)ect of changing parameters
on average histogram error. Figure (b) shows the node count estimates gathered by each node. Figure (c)
shows e(cid:11)ect of changing parameters on overall routing performance.