运维生存时间(WWW.TTLSA.COM)
从入门到精通
ZABBIX
由浅入深 中文手册
凉白开
2016/2/25
感谢浏览，欢迎拍砖（虽有错别字，但核心内容犹在，谅解谅解!）
作者：凉白开 版本：v3.0.1 网址：http://www.ttlsa.com（运维生存时间）
目录
前言 ........................................................................................................................................................................... 6
版本记录 ............................................................................................................................................................ 8
第一章：简介 ............................................................................................................................................................ 9
Zabbix介绍 ........................................................................................................................................................ 9
Zabbix特性 ...................................................................................................................................................... 10
zabbix进程构成 ................................................................................................................................................ 13
第二章：安装 .......................................................................................................................................................... 14
zabbix软硬件需求 ........................................................................................................................................... 14
Zabbix数据库硬盘容量计算 ........................................................................................................................... 18
Zabbix安装 ...................................................................................................................................................... 20
Zabbix升级 ....................................................................................................................................................... 31
第三章：快速上手 ................................................................................................................................................... 33
Zabbix中文语言 ............................................................................................................................................... 33
Zabbix中文乱码 .............................................................................................................................................. 35
zabbix监控第一台服务器 ................................................................................................................................. 37
Zabbix用户管理 .............................................................................................................................................. 41
第四章：zabbix配置 ............................................................................................................................................... 48
配置简介 .......................................................................................................................................................... 48
zabbix主机与组配置 ....................................................................................................................................... 49
zabbix资产清单inventory管理 ...................................................................................................................... 53
zabbix监控项item .......................................................................................................................................... 56
zabbix创建监控项item ................................................................................................................................... 56
zabbix item key详解 ........................................................................................................................................ 62
zabbix item types监控类型 ............................................................................................................................. 65
zabbix agent 类型所有key ...............................................................................................................................67
zabbix External checks 外部命令检测 ............................................................................................................. 86
zabbix Simple checks基本检测 ........................................................................................................................ 87
zabbix ODBC数据库监控 ................................................................................................................................. 90
zabbix history trends历史与趋势数据详解 ..................................................................................................... 95
zabbix自定义用户key与参数User parameters ............................................................................................. 97
zabbix值映射Value mapping ........................................................................................................................ 100
zabbix Applications使用介绍 .......................................................................................................................... 103
zabbix触发器triggers ................................................................................................................................... 104
zabbix自定义触发器严重性 ........................................................................................................................... 107
zabbix触发器依赖关系详解 ........................................................................................................................... 110
zabbix单位符号Unit symbols ........................................................................................................................ 113
zabbix触发器表达式详解 ............................................................................................................................... 115
zabbix事件通知 .............................................................................................................................................. 121
Zabbix事件来源 ............................................................................................................................................. 123
zabbix脚本报警介质自定义 ........................................................................................................................... 125
zabbix action报警配置 .................................................................................................................................. 128
zabbix用户宏变量详解macro........................................................................................................................ 133
zabbix执行远程命令 ...................................................................................................................................... 135
zabbix Trapper监控项配置 ............................................................................................................................. 138
zabbix Aggregate checks聚合检测 ................................................................................................................. 141
zabbix Queue队列 ......................................................................................................................................... 144
zabbix正则表达式应用 ................................................................................................................................. 146
zabbix导入/导出配置文件 .............................................................................................................................. 151
windows安装zabbix监控 .............................................................................................................................. 157
zabbix windows性能计数器使用详解 ........................................................................................................... 160
zabbix加载扩展模块 第三方库支持.............................................................................................................. 163
zabbix telnet监控类型 ................................................................................................................................... 168
zabbix用户认证方式 内建、HTTP Basic、LDAP .......................................................................................... 170
zabbix第三方认证之http(nginx basic auth) ................................................................................................... 172
ZABBIX各版本之间的兼容性 ......................................................................................................................... 175
zabbix如何选择适合的监控类型 ................................................................................................................... 176
zabbix LTS和标准发行版的区别 .................................................................................................................... 179
zabbix主动、被动检测的详细过程与区别 ................................................................................................... 182
zabbix值缓存(value cache)说明 ...................................................................................................................... 187
第五章：zabbix SNMP ........................................................................................................................................... 188
zabbix snmp类型 ........................................................................................................................................... 188
snmp安装配置 ............................................................................................................................................... 191
snmp v3的安全配置 snmp认证与加密配置 ................................................................................................. 193
zabbix如何使用SNMP获取数据 SNMP监控实例 ...................................................................................... 195
zabbix snmp自定义OID nginx监控实例 ....................................................................................................... 197
第六章：zabbix通知媒介 ..................................................................................................................................... 200
zabbix报警媒介介绍 ..................................................................................................................................... 200
zabbix报警媒介：email ................................................................................................................................ 201
zabbix报警媒介：SMS ...................................................................................................................................203
zabbix报警媒介：Jabber............................................................................................................................... 205
zabbix报警媒介：Ez Texting ......................................................................................................................... 206
zabbix报警媒介： Custom alertscripts ......................................................................................................... 208
第七章：zabbix模板 .............................................................................................................................................. 211
zabbix模板介绍 .............................................................................................................................................. 211
zabbix模板创建 ............................................................................................................................................. 212
zabbix链接及解除模板链接 ...........................................................................................................................215
zabbix模板嵌套 Templates Nesting ............................................................................................................. 218
第八章：zabbix可视化 ......................................................................................................................................... 219
zabbix图表功能介绍 ..................................................................................................................................... 219
zabbix简易图表详解 ..................................................................................................................................... 220
zabbix自定义图表Graph .............................................................................................................................. 224
zabbix Screens视图配置 ................................................................................................................................ 228
zabbix Slide shows幻灯片展示 ...................................................................................................................... 234
zabbix网络拓扑图配置network map ............................................................................................................ 236
zabbix拓扑图展示链路状况Link indicators .................................................................................................. 243
IT services ....................................................................................................................................................... 245
第九章：WEB监控 ............................................................................................................................................... 252
zabbix监控web服务器访问性能 ................................................................................................................. 252
zabbix web监控项item详解 ........................................................................................................................ 254
zabbix实战监控WEB网站性能 .................................................................................................................... 256
zabbix监控API .............................................................................................................................................. 264
第十章：维护模式 ................................................................................................................................................ 268
zabbix Maintenance维护周期........................................................................................................................ 268
第十一章：事件确认 .............................................................................................................................................. 272
事件确认（Event acknowledgment） ............................................................................................................ 272
第十二章：网络发现 .............................................................................................................................................. 274
zabbix网络发现介绍Discovery ...................................................................................................................... 274
zabbix网络发现规则配置实战/详解 .............................................................................................................. 277
zabbix客户端自动注册 ................................................................................................................................. 283
zabbix低级别发现 ..........................................................................................................................................287
第十三章：API ...................................................................................................................................................... 294
Zabbix API二次开发 ...................................................................................................................................... 294
第十四章：zabbix命令 ......................................................................................................................................... 298
Zabbix命令：zabbix_server .......................................................................................................................... 298
Zabbix命令：zabbix_get ................................................................................................................................ 301
Zabbix命令：zabbix_agentd .......................................................................................................................... 303
Zabbix命令：zabbix_sender ......................................................................................................................... 306
Zabbix命令：zabbix_proxy ........................................................................................................................... 308
第十五章：分布式监控 ......................................................................................................................................... 309
zabbix分布式监控proxy vs nodes ................................................................................................................. 309
zabbix proxy分布式监控配置 ......................................................................................................................... 310
第十六章：性能优化 .............................................................................................................................................. 313
zabbix性能优化中的几个中肯建议 ............................................................................................................... 313
第十七章 Zabbix实战 ........................................................................................................................................... 315
Zabbix API开发实战：创建维护模式 ............................................................................................................. 315
Zabbix监控nginx性能 .................................................................................................................................. 320
zabbix监控php-fpm性能状态 ...................................................................................................................... 324
zabbix监控Tomcat/JVM实例性能................................................................................................................. 327
zabbix监控日志文件 MySQL日志为例 ........................................................................................................ 330
zabbix监控惠普打印机 .................................................................................................................................. 333
zabbix如何监控多个JMX/Redis等实例 ......................................................................................................... 336
zabbix监控mysql性能 ................................................................................................................................... 338
zabbix监控磁盘IO low-level-discory方式 .................................................................................................... 344
zabbix 2.4升级至zabbix 2.5/3.0过程 ............................................................................................................ 348
第十八章 Zabbix常见问题解决/FAQ .................................................................................................................... 350
zabbix Less than 25% free in the configuration cache解决 .............................................................................. 350
login as guest zabbix无法进入登陆界面 ........................................................................................................ 351
Received empty response from Zabbix Agent问题解决 .................................................................................. 353
zabbix key总是not supported的解决方法 ................................................................................................... 354
附录：配置文件详解 .............................................................................................................................................. 355
zabbix_server.conf配置文件详解 ................................................................................................................... 355
zabbix_agentd.conf配置文件详解 ................................................................................................................. 363
前言
感谢
感谢一直陪伴在我身边的老婆：兰若，给予我支持和鼓励，才能坚持把 zabbix 系列教程写到现在，并且完成这份
《zabbix教程从入门到精通》PDF电子书。
感谢靠谱云（www.kaopuyun.com）免费为本站提供云服务器。
感谢漠北、tonyty163以及其他网友为本站提供内容
关于运维生存时间
网站名称并没有特别的意思，运维时常接触到TTL以及职业本身便是SA（system administraotr），连起来便得到了
ttlsa.com。域名有了，名称也就这么来了–运维生存时间。
运维生存时间历程
日期 历程
2010年 8月4日：购买域名
2011年 2月13日：发布本站第一篇文章，团队陆续发布上百篇技术文章
2012年 本站放空的一年，偶尔更新文章
2013年 6月22日：重启TTLSA团队，用心经营本站。
将网站从国内空间迁移至linode，并运行了将近一年时间，之后迁移至阿里云2个月
2014年 7月7日：迎来了本站的首次赞助，kaopuyun.com免费提供国内云服务器。
12月14:Alexa排名首次进入10万以内，排名97901
本站用心更新，用户量也不断创新高，感谢作者们对TTLSA的无私奉献.
TTLSA原创系列教程
当然，zabbix只是我们系列之中的一份，我们还有更多系列教程，截至2015年1月20日星期二，我们一共有六个
原创系列教程，如下：
 《Zabbix教程从入门到精通》
作者：凉白开
电子书：http://ebook.ttlsa.com/monitor/
文章列表：http://www.ttlsa.com/zabbix/follow-ttlsa-to-study-zabbix/
 《Nginx教程从入门到精通》
作者：漠北、凉白开
电子书：http://ebook.ttlsa.com/nginx/
文章地址：http://www.ttlsa.com/nginx/nginx-tutorial-from-entry-to-the-master-ttlsa/
 《Mongodb实战教程》
作者：漠北
文章地址：http://www.ttlsa.com/mongodb/mongodb-study/
 《Mongodb官方监控：MMS》
作者：漠北
文章地址：http://www.ttlsa.com/mms/follow-me-to-use-mongodb-mms-services/
 《MySQL管理工具利器：MySQL Utilities》
作者：漠北
文章地址：http://www.ttlsa.com/mysql/mysql-manager-tools-mysql-utilities-tutorial/
 《TTLSA带你学习Thinkphp》
作者：tonyty163
文章地址：http://www.ttlsa.com/php/follow-ttlsa-to-study-thinkphp/
业务合作
一切运维有关业务可与我们联系洽谈
联系我们
E-mail：PI:EMAIL
QQ：757444407
QQ群：6690706、39514058(已满)
捐助
如果你喜欢我们的内容，也想支持我们，那么捐助我们吧！有钱，任性，那就打赏吧
版本记录
内容在不断更新中，请大家保持关注TTLSA，最新的PDF会同步放到官网
版本 更新内容 日期 操作人
V1.0 初始化文档 2015年01月20日 凉白开
V2.0 增加自动注册、发现、LLD、监控实例以及其他内容 2015年11月29日 凉白开
V3.0 内容添加 2016年02月25日 凉白开
第一章：简介
Zabbix 介绍
Alexei Vladishev创建了Zabbix项目，当前处于活跃开发状态，Zabbix SIA提供支持.
 Zabbix是一个企业级的、开源的、分布式的监控套件
 Zabbix可以监控网络和服务的监控状况. Zabbix利用灵活的告警机制，允许用户对事件发送基于Email的告警.
这样可以保证快速的对问题作出相应. Zabbix 可以利用存储数据提供杰出的报告及图形化方式. 这一特性将帮
助用户完成容量规划.
 Zabbix支持polling和trapping两种方式. 所有的Zabbix报告都可以通过配置参数在WEB前端进行访问. Web
前端将帮助你在任何区域都能够迅速获得你的网络及服务状况. Zabbix可以通过尽可能的配置来扮演监控你的
IT基础框架的角色，而不管你是来自于小型组织还是大规模的公司.
 Zabbix是零成本的. 因为Zabbix编写和发布基于GPL V2协议. 意味着源代码是免费发布的.
 Zabbix公司也提供商业化的技术支持.
Zabbix 特性
在知道zabbix是什么之后，我们最关心的是zabbix有什么特性，了解特性之后，我们才能决定是否会使用zabbix，
以及zabbix是否适合我们.Zabbix是一个高度集成的网络监控套件，通过一个软件包即可提供如下特性
 数据收集
a) 可用性及性能检测
b) 支持SNMP(trapping及polling)、IPMI、JMX监控
c) 自定义检测
d) 自定义间隔收集收据
e) server/proxy/agents吸能
 灵活的阀值定义
a) 允许灵活地自定义问题阀值，Zabbix中称为触发器(trigger), 存储在后端数据库中
 高级告警配置
a) 可以自定义告警升级(escalation)、接收者及告警方式
b) 告警信息可以配置并允许使用宏(macro)变量
c) 通过远程命令实行自动化动作(action)
 实时绘图
a) 通过内置的绘图方法实现监控数据实时绘图
 扩展的图形化显示
b) 允许自定义创建多监控项视图
c) 网络拓扑(network maps)
d) 自定义的面板(screen)和slide shows，并允许在dashboard页面显示
e) 报告
f) 高等级(商业)监控资源
 历史数据存储
a) 数据存储在数据库中
b) 历史数据可配置