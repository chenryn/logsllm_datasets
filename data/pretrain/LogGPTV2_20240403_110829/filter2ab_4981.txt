### Title: Exploiting Inter-Process Communication in SAP's HTTP Server: A Deep Dive into Internal Server Errors

More than 400,000 organizations, including 90% of Fortune 500 companies, rely on SAP's software to keep their business operations running smoothly. At the heart of every SAP deployment is the Internet Communication Manager (ICM), which handles all HTTP requests and responses. This talk will explore how to exploit two memory corruption vulnerabilities found in SAP's proprietary HTTP Server using advanced protocol exploitation techniques.

Both vulnerabilities, CVE-2022-22536 and CVE-2022-22532, were remotely exploitable and could be used by unauthenticated attackers to completely compromise any SAP installation. The first vulnerability involves an error in the HTTP request-handling process. By desynchronizing ICM data buffers, an attacker can hijack user accounts through advanced HTTP Smuggling. This presentation will demonstrate this technique, which does not rely on parsing errors, making it effective even in scenarios considered "impossible to exploit" without a proxy. The session will include a demo of the first desync botnet, leveraging JavaScript and Response Smuggling concepts.

The second vulnerability is a Use After Free (UAF) issue in the shared memory buffers used for Inter-Process Communication (IPC). By exploiting an incorrect deallocation, an attacker can tamper with messages belonging to other TCP connections and take control of all responses using Cache Poisoning and Response Splitting. Additionally, since the affected buffers are also used to store Out Of Bounds data, the presentation will explain a method to corrupt address pointers and achieve Remote Code Execution (RCE).

These vulnerabilities, collectively known as the Internet Communication Manager Advanced Desync (ICMAD), have been addressed by the US Cybersecurity and Infrastructure Security Agency (CISA) and CERTs worldwide, underscoring their significant impact on enterprise security.