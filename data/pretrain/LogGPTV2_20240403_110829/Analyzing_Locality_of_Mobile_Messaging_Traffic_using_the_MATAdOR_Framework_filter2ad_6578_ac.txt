– China with the only member China.
5 Results
With our experiments, running from Sep 30 2015 to Oct 12 2015, we conducted
406 measurements between the 28 PlanetLab nodes using the 4 selected mobile
messaging services, resulting in 1624 measurements in total.
Table 2 shows the path comparisons between application path and network
path. The ﬁrst columns evaluate the direct measurements between nodes and
show how many % of measurements failed to stay within the region. We found
that all traﬃc from Israel to other Asian countries is being routed through
Europe and the U.S. As we use seven nodes in Asia, six measurements from
Israel fail to remain within region. Also, with two nodes in South America, the
measurement between those two nodes leaves South America for routing through
North America. As the two in-country measurements stay in the region, the 33 %
understate the eﬀect, caused by the low number of nodes. As a result we highlight
that only Europe and North America feature at least one messenger that keeps
traﬃc local. Asia traﬃc for WeChat does not remain local because of Israel’s
aforementioned routing and also because of traﬃc from Singapore and Thailand
being routed to the Chinese WeChat servers through U.S. IXPs.
Table 3 shows how measurements from a speciﬁc region were subject to var-
ious interest groups, both for the network path and for the speciﬁc application
path:
Europe to Europe: 72 % of network path measurements within Europe were
accessible to 5 Eyes (by routing through UK). 98 % of measurements were acces-
sible to the European Union, with only measurements internal to Switzerland
and Norway not being accessible. For application paths, Threema reduces the 5
Analyzing Locality of Mobile Messaging Traﬃc
199
Table 2. Mobile messaging services in almost all cases direct traﬃc out of region.
Eyes access by 16 % as it eﬀectively proxies traﬃc through Switzerland, which
enforces continental routing for some routes (e.g. Poland - Switzerland - Spain
as compared to Poland - UK - Spain). 99 % of WeChat measurements within
Europe were accessible to 5 Eyes because of routing through the U.S. Only
the Switzerland internal measurement oﬀered a direct path to Hong Kong. As
Switzerland has a direct path to the U.S. as well, this also explains the one case
where EU can not access TextSecure messages. When using Threema within
Table 3. Mobile messaging services in most cases increase traﬃc accessibility for inter-
est groups.
200
Q. Scheitle et al.
Switzerland, the application path remains in Switzerland as well, hence the EU
cannot access those measurements.
Oceania to Oceania: As Australia and New Zealand are both members of 5
Eyes, obviously all measurements are accessible to the latter. It is remarkable
that all WeChat traﬃc, e.g. generated by exile Chinese, is routed through China.
Asia to Asia: At a network level, both 5 Eyes, China and the European Union
can access about 20 % to 40 % of traces sent within Asia. This is largely caused by
the before mentioned Israel routing. 75 % of Threema traﬃc is 5 Eyes accessible
by routing to Switzerland through the U.S. Also, a large portion of WeChat
traﬃc (46 %) is accessible to 5 Eyes, both by Israel routing through the U.S. and
by Singapore routing to WeChat’s Chinese backend through an U.S. IXP.
North America to North America: As expected, 100 % of traﬃc is 5 Eyes
accessible. For Threema, traﬃc from Canada to Switzerland was again routed
through a direct hop from Miami to Zurich, resulting in two measurements seem-
ing inaccessible to EU.
South America to South America: Measurements from Argentina were
routed through a direct tunnel from Miami to Zurich and hence were not acces-
sible for the EU in our metric. Hence only 2 out of 3 Threema measurements
from South America are accessible for the EU. However, South America’s com-
munication is, independently of the mobile messaging service being used, always
susceptible to 5 Eyes.
Russia and Arab League: None of the measurements did traverse Russia or
the Arab League. We hence excluded those from the table.
6 Summary and Conclusion
We conducted traﬃc locality measurements between 28 countries for four mobile
messaging services. We found those apps to heavily distort locality of traﬃc and
hence drastically widen the set of actors able to access it. With a few notable
exceptions, e.g. when using Threema in Switzerland, this has large negative
impact on the users’ privacy. This could be alleviated by decentralizing the
mobile messaging services’ backend infrastructures or even the services them-
selves, using P2P techniques. With this being the ﬁrst study on this particular
topic, we hope to raise user and operator awareness for this problem. To con-
duct our measurements, we introduced the MATAdOR framework to analyze
messaging traﬃc characteristics on mobile phones. A detailed overview over the
MATAdOR framework can be found in [35]. We fully release both the MATAdOR
framework and the dataset produced in our measurements through our website6.
This enables future work to easily validate our results or do further analysis, such
as deeper protocol analysis on the apps. Future work might also include analysis
of WeChat’s regional optimization within China, focus on peer-to-peer services
6 http://net.in.tum.de/pub/mobmes/
Analyzing Locality of Mobile Messaging Traﬃc
201
like Bleep, or further dissect protocols of mobile messaging services. To improve
quality of path measurement results, future work could use additional techniques
such as ﬁber maps [3].
Acknowledgments. We thank Andreas Loibl for early access to his Measurement
Proxy software.
References
1. Brandom, R.: WhatsApp rolls out end-to-end encryption using TextSecure code
(2014). https://www.theverge.com/2014/11/18/7239221/whatsapp-rolls-out-end-
to-end-encryption-with-textsecure. Accessed 14 September 2015
2. Kakao, D.: 2Q15 earnings report, August 2015. http://www.kakaocorp.com/
upload resources/ir/siljeok/siljeok 20150813080737.pdf. Accessed 23 September
2015
3. Durairajan, R., Barford, P., Sommers, J., Willinger, W.: InterTubes: a study of
the US long-haul ﬁber-optic infrastructure. In: SIGCOMM 2015 (2015)
4. Electronic Frontier Foundation. Secure Messaging Scorecard (2014). https://www.
eﬀ.org/secure-messaging-scorecard. Accessed 14 September 2015
5. Facebook. Messenger at f8, March 2015. http://newsroom.fb.com/news/2015/03/
messenger-at-f8/. Accessed 17 September 2015
6. Federal Network Agency for Electricity, Gas, Telecommunications Post and Rail-
way. Annual report 2014, p. 81 (2014)
7. Fiadino, P., Schiavone, M., Casas, P.: Vivisecting WhatsApp in cellular net-
works: servers, ﬂows, and quality of experience. In: Steiner, M., Barlet-Ros, P.,
Bonaventure, O. (eds.) TMA 2015. LNCS, vol. 9053, pp. 49–63. Springer,
Heidelberg (2015)
8. Frosch, T., Mainka, C., et al.: How Secure is TextSecure? Technical report (2014)
9. Golson, J.: Apple ﬁghting the US government over encrypted iMessages (2015).
http://www.techrepublic.com/article/apple-ﬁghting-the-us-government-on-
turning-over-encrypted-imessages/. Accessed 14 September 2015
10. Huang, Q., Lee, P.P., et al.: Fine-grained dissection of WeChat in cellular networks.
IWQoS (2015)
11. Huﬀaker, B., Fomenkov, M., Claﬀy, K.: DRoP: DNS-based router positioning.
ACM SIGCOMM CCR 44(3), 5–13 (2014)
12. Koum, J.: Whatsapp - now serving 900,000,000 monthly active users, September
2015. https://www.facebook.com/jan.koum/posts/10153580960970011. Accessed
23 September 2015
13. Line Corporation. LINE Corporation Announces 2015Q2 Earnings, July 2015.
http://linecorp.com/en/pr/news/en/2015/1043. Accessed 17 September 2015
14. Marlinspike, M.: A Saudi Arabia telecom’s surveillance pitch (2013). http://www.
thoughtcrime.org/blog/saudi-surveillance/. Accessed 14 September 2015
15. McMurchy, L.: Skype connection hub ads provide increased scale for mar-
http://advertising.microsoft.com/en/blog/29331/
17
keters,
skype-connection-hub-ads-provide-increased-scale-for-marketers. Accessed
September 2015
December
2014.
16. Mueller, R., Schrittwieser, S., et al.: What’s new with WhatsApp & Co.? Revisiting
the security of smartphone messaging applications. In: iiWAS (2014)
202
Q. Scheitle et al.
17. Open Whisper Systems. Textsecure, now with 10 million more users,
https://whispersystems.org/blog/cyanogen-integration/.
2013.
December
Accessed 23 September 2015
18. Pew Research Center. Mobile messaging and social media 2015 (2015). http://
www.pewinternet.org/ﬁles/2015/08/Social-Media-Update-2015-FINAL2.pdf.
Accessed 14 September 2015
19. PlanetLab Central. User tools. https://www.planet-lab.org/tools. Accessed 17
September 2015
20. Reader, R.: Wickr CEO Nico Sell: behind the glasses, January 2015. http://
venturebeat.com/2015/01/13/wickr-ceo-nico-sell-behind-the-glasses/. Accessed
23 September 2015
21. Statista. Number of monthly active viber users, April 2015. http://www.statista.
com/statistics/316423/. Accessed 23 September 2015
22. Statista. We are social. (n.d.). most popular global mobile messenger apps as of
August 2015. http://www.statista.com/statistics/258749/. Accessed 23 September
2015
23. Statista. Number of monthly active WhatsApp users worldwide. http://www.
statista.com/statistics/260819/number-of-monthly-active-whatsapp-users/.
Accessed 23 September 2015
24. Tango.
200 million members!, March 2014. http://www.tango.me/blog/
200-million-members. Accessed 17 September 2015
25. TechCrunch. Chat app kik hits 200m registered users, January 2015. http://
techcrunch.com/2015/01/28/dont-expect-kik-maus/. Accessed 23 September 2015
26. Tencent. 2015Q2 results, August 2015. http://www.tencent.com/en-us/content/
ir/news/2015/attachments/20150812.pdf. Accessed 23 September 2015
27. The European Commission. Case No COMP/M.7217 - FACEBOOK/ WHAT-
SAPP (2014). http://ec.europa.eu/competition/mergers/cases/decisions/m7217
20141003 20310 3962132 EN.pdf
28. The Telegram Team. Telegram reaches 1 billion daily messages, December 2014.
https://telegram.org/blog/billion. Accessed 17 September 2015
29. Threema. If you value security and privacy, September 2014. https://threema.ch/
press-ﬁles/1 press info/Press-Info Threema EN.pdf. Accessed 17 September 2015
30. TNS Global. The new social frontier: Instant messaging usage jumpps 12% (2015).
http://www.tnsglobal.com/press-release/new-social-frontier-instant-messaging-
usage-jumps. Accessed 7 October 2015
31. Vodafone. Law enforcement disclosure report 2015 (2015). https://www.vodafone.
14
com/content/index/about/sustainability/law enforcement.html. Accessed
September 2015
32. W¨ahlisch, M., Schmidt, T.C., de Br¨un, M., H¨aberlen, T.: Exposing a nation-centric
view on the German internet – A change in perspective on AS-level. In: Taft, N.,
Ricciato, F. (eds.) PAM 2012. LNCS, vol. 7192, pp. 200–210. Springer, Heidelberg
(2012)
33. Wikipedia. Mobile application testing (2015). https://en.wikipedia.org/wiki/
Mobile application testing#Some Mobile Application Testing Tools. Accessed 17
September 2015
34. Zhang, M., Ruan, Y., Pai, V.S., Rexford, J.: How DNS Misnaming Distorts Internet
Topology Mapping. In: USENIX (2006)
35. Zirngibl, J.: Security Analysis of Mobile Messaging Traﬃc with an Automated Test
Framework. Bachelor’s thesis, Technische Universit¨at M¨unchen (2015)