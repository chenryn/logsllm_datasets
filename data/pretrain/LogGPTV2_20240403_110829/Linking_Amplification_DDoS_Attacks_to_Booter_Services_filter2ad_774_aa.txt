# Linking Amplification DDoS Attacks to Booter Services

**Authors:**
- Johannes Krupp
- Mohammad Karami
- Christian Rossow
- Damon McCoy
- Michael Backes

**Affiliations:**
- **Johannes Krupp, Christian Rossow, and Michael Backes:** CISPA, Saarland University, Saarbrücken, Germany
- **Mohammad Karami:** Google, Inc., Mountain View, CA, USA
- **Damon McCoy:** New York University, New York, USA
- **Michael Backes:** MPI-SWS, Saarbrücken, Germany

## Abstract

We present techniques for attributing amplification DDoS attacks to the booter services that launched them. Our k-Nearest Neighbor (k-NN) classification algorithm is based on features characteristic of a DDoS service, such as the set of reflectors used by that service. This allows us to attribute DDoS attacks based on observations from honeypot amplifiers, augmented with training data from ground truth attack-to-services mappings we generated by subscribing to DDoS services and attacking ourselves in a controlled environment. Our evaluation shows that we can attribute DNS and NTP attacks observed by the honeypots with a precision of over 99% while still achieving recall of over 69% in the most challenging real-time attribution scenario. Furthermore, we develop a similarly precise technique that allows a victim to attribute an attack based on a slightly different set of features that can be extracted from a victim’s network traces. Executing our k-NN classifier over all attacks observed by the honeypots shows that 25.53% (49,297) of the DNS attacks can be attributed to 7 booter services and 13.34% (38,520) of the NTP attacks can be attributed to 15 booter services. This demonstrates the potential benefits of DDoS attribution to identify harmful DDoS services and victims of these services.

## 1. Introduction

Distributed Denial-of-Service (DDoS) attacks have become commoditized by DDoS-for-hire services, commonly called booters or stressers [7,19]. A large number of booter services advertise their services openly as an economical platform for customers to launch DDoS attacks. At the same time, DDoS attacks are increasing in number and magnitude. This proliferation of DDoS attacks has caused many network and website operators to rank this type of attack as one of the largest threats facing them [13]. The barrage of DDoS attacks has increased the demand for Content Delivery Networks (CDNs) and Software Defined Networking defenses that can absorb and filter these attacks [5]. In turn, this has prompted attackers to devise increasingly efficient methods of bypassing or overwhelming defenses, resulting in an escalating technological arms race between DDoS attackers and defenders that at times has congested segments of the core Internet infrastructure as collateral damage [17].

Despite the proliferation of DDoS services and attacks, little progress has been made on attributing the services that are launching these attacks on behalf of their customers. Most ideas for attribution focus on IP traceback mechanisms [16,21–23,30] to trace the source of spoofed IP packets, which require ISPs to assist and have not been widely deployed. This has resulted in most of these attacks being unattributed unless the attackers unveil themselves. While it is important to create strong technological DDoS defenses, we argue that there is also benefit in investigating other methods that enable attribution of DDoS attacks to the services responsible for launching these attacks. For instance, some of these booter services—seven out of 23 services that we studied—claim they are benign services by advertising as "stress-testing" services intended to be used only by authorized administrators. Attribution can remove this veil of legitimacy and assist efforts to undermine these services by allowing victims and law enforcement to attribute which booter services were responsible for an attack. Attribution also enables measuring the scale of these services and prioritizing undermining the larger services that are causing more harm. To assist ongoing investigations, we are continually sharing information from our study on DDoS attacks and booter services with the European Police Office (Europol), the United States Federal Bureau of Investigation (FBI), and large ISPs or backbone providers.

In this work, we show that it is possible to build supervised learning techniques that allow honeypot amplifier operators and victims to accurately attribute attacks to the services that launched them. We identify three key features that honeypot operators can record to construct a supervised k-NN classifier that can attribute attacks. To validate our method, we subscribed to 23 booter services and generated a ground truth dataset of attacks to booter service mappings. Validation of our classifier using the ground truth self-attack dataset shows that it is highly precise at attributing DNS and NTP attacks with a precision of over 99% at 69.35% recall in the worst case of real-time attribution. When retrospectively attributing attacks, the recall even increases to 86.25%. Executing our classifier over the set of all attacks observed by the honeypots shows that 25.53% (49,297) of the DNS attacks can be attributed to 7 booter services and 13.34% (38,520) of the NTP attacks can be attributed to 15 booter services.

Finally, we show that a k-NN classifier can also be used by victims to attribute DDoS attacks to the service that launched the attack. Our findings demonstrate that many of the attacks we observed can be attributed to a small set of booter services that are operating relatively openly. Our ability to attribute large numbers of attacks to a small set of booter services and sharing of this information with Europol and the FBI to assist in active investigations demonstrates the usefulness of our attribution methods.

In summary, our contributions are as follows:
- We present a k-NN-based classifier that attributes amplification DDoS attacks observed by honeypots with a precision of over 99% while still achieving recall of over 69% in the most challenging real-time attribution scenario.
- We present a similarly precise technique that allows a DDoS victim to attribute attacks based on features extracted from a victim’s network traces.
- We attribute 25.53% (49,297) of the DNS attacks to 7 booter services and 13.34% (38,520) of the NTP attacks to 15 booter services.

## 2. Background

### 2.1 Threat Model

Amplification DDoS constitutes a powerful attack in which an adversary aims to exhaust the bandwidth of a victim’s host or network by inducing a large volume of traffic. The attacker abuses multiple servers as so-called amplifiers. These servers offer UDP-based protocols prone to amplification, i.e., the server's response is significantly larger than the corresponding request sent to the server. At least 14 protocols suffer from this flaw [18], such as NTP and DNS, leading to a multitude of servers that can be exploited as amplifiers. Given the connection-less nature of UDP, an attacker can redirect the servers' responses to the victim by simply spoofing the source IP address in requests. Due to amplification ratios of a factor of 5 to 4500 [18], an attacker that sends requests at a rate of some Mbit/s can still cause attack traffic at Gbit/s-scale.

Furthermore, we are concerned with a special type of attacker: booter services. These offer platforms for DDoS-as-a-service, often under the guise of "stress-testing," where customers can request various types of attacks for a small fee. The booter will then launch these attacks using its infrastructure. Our threat model thus contemplates four parties: Customers, who commission attacks; booters, who conduct the actual attacks; amplifiers, who are exploited to amplify traffic; and victims, who are the targets of such attacks.

The aim of this paper is to attribute attacks to booters, when observed from either the victim’s or an amplifier’s perspective. This is non-trivial, as from the victim’s perspective, the attack seems to stem from the amplifiers. Similarly, from an amplifier’s perspective, the requests seem to be legitimate requests by the victim (due to the use of spoofed source IP addresses by the booter). While ultimately one would like to identify the customer, only the booter, amplifiers, and the victim are directly participating in an attack. Nonetheless, since the booter has a business relation to the customer, pinpointing the booter behind an attack constitutes an important step towards this goal.

### 2.2 Ethical Considerations

As part of our study, we subscribed to 23 booters and conducted a controlled set of self DDoS attacks. Furthermore, we also leveraged honeypots for amplification attacks. We settled on this methodology for collecting a ground truth dataset of mappings between observed attacks and the services that launched these attacks after finding that no dataset available to us could be used to validate our DDoS attribution techniques. Before we began performing these self DDoS attacks, we carefully attempted to minimize the harms and maximize the benefits associated with our methodology based on observations from previous studies that launch self-attacks to measure booter’s attacks [7,20].

We received an exemption from our Institutional Review Board (IRB), as our study did not include any personally identifiable information. Additionally, we consulted with our institution’s general counsel, who advised us not to engage with any DDoS service that advertised using botnets and to cease active engagement with any booter service that we realized was using botnets.

An analysis of TTL values observed by the honeypots indicated that it is unlikely any of the booter services we subscribed to used botnets. Based on the guidance of our institution’s general counsel, our victim server was connected by a dedicated 1 Gbit/s network connection that was not shared with any other servers. We also obtained consent from our ISP and their upstream peering points before conducting any DDoS attack experiments. We minimized the attack durations, notified our ISP before launching any attack, and had a protocol in place to end an attack early if it caused a disruption at our ISP.

We purchased subscriptions from 23 booter services. When doing so, we selected the cheapest option, which ranged from $6–$20 and averaged $12 per month, to minimize the amount of money given to these services. In total, we spent less than $400, and no individual booter service received more than $40 in payments as part of the measurements in this paper. All payments were made using PayPal, and we assumed that proper controls were put in place at PayPal to mitigate the risk of money flowing to extremist groups. As part of our design methodology, we minimized the amount of money paid and targeted a small set of booters to obtain a valuable ground truth dataset.

Our method created some harm to amplifiers and their upstream peering points by consuming bandwidth resources. The largest amount of bandwidth consumed was 984.5 kbit/s for NTP amplifiers and the least was 16.7 kbit/s for DNS amplifiers, similar to those reported in a previous study [7]. Over the course of our experiments, we did not receive any complaints from the operators of these amplifiers. We limited our attacks to 30 seconds. Based on analysis from a previous study that used a similar methodology [7], these short-duration attacks enable us to observe about 80% of the amplifiers used by a given booter service and reduce the harm we cause to misconfigured amplifiers.

Similarly, the use of DDoS honeypots might also incur harm on the Internet. We used AmpPot, a honeypot proposed by Krämer et al. [8]. To avoid contributing to DDoS attacks, AmpPot limits the rate of requests and deploys automatic IP blacklisting: The honeypots will stop responding for one hour to any IP address sending more than 10 requests per minute. This limits the maximum amount of data sent to a DDoS victim to a few kilobytes. For a more detailed ethical discussion on AmpPot, we refer the reader to [8].

## 3. Amplification Attack Dataset

To investigate if and how amplification attacks can be attributed to their originating booter service, we established two datasets that help us gain insights into the overall amplification attacks and find concrete attack instances caused by individual booters. In Section 3.1, we describe how we leverage amplification honeypots to gain insights into global amplification attacks. In Section 3.2, we discuss how we use booters and launch controlled attacks against ourselves to learn about attack techniques of certain attackers.

### 3.1 Honeypot Attacks

Although the general threat of amplification attacks has been known for years, actual attack insights are only documented in anecdotal evidence, such as attacks against Spamhaus or OVH at hundreds of Gbit/s attack volume. To collect insights into the set of global amplification attacks, we leverage data collected by AmpPot [8], a honeypot proposed by Krämer et al. AmpPot emulates seven UDP-based protocols that have known amplification vectors and will thus eventually be abused as part of real-world DDoS amplification attacks (QOTD, CharGen, DNS, NTP, RIPv1, MSSQL, and SSDP). Krämer et al. observed that attackers will eventually find such honeypots via Internet scans and start abusing them as potential reflectors shortly thereafter. AmpPot thus serves as an eye on global amplification attacks, and due to the nature of the attack traffic, can also observe who is being attacked and when.

In December 2014, eleven globally-distributed honeypots with single static IP addresses were deployed and have been operated continuously since then. In November 2015, a twelfth honeypot was added, listening on 48 static IP addresses. This honeypot employs a special feature named Selective Response, where each source scanning for amplifiers will find a unique set of 24 IP addresses [10].

We set our analysis period to two months from December 9, 2015, to February 10, 2016. In this period, the honeypots observed 570,738 amplification attacks (8,918 attacks per day on average). However, given that RIPv1, MSSQL, and QOTD combined account for less than 5% of these, we decided to exclude those protocols from our analyses.

### 3.2 Self-attacks

The honeypots give us valuable insights into global attacks but do not provide indications of where the attacks are coming from. Previous studies have identified so-called booter services ("booters") as being responsible for a large number of amplification attacks [6,7,20]. In an attempt to learn attack characteristics of these booters, we signed up at these services and then launched short-lived amplification attacks against a target in our control.

To start launching self-attacks and correlating them with the traffic seen at the honeypots, our first task was to identify booter services to cover in the study. Absent a centralized location for finding booters, we located services via search engines and advertisements on underground forums. We selected a total of 23 services offering amplification attacks based on NTP, DNS, CharGen, and SSDP. When selecting these booters, we tried to include services that we speculated to be more stable and have more subscribers based on reviewing user feedback on underground forums. To minimize the amount of money we paid to these abusive services, we kept the number of covered booters relatively small.

Table 1 provides an overview of the booter services that we cover and the amplification attack types they offer. NTP was the most popular attack protocol, followed by DNS. Sixteen of the 23 services clearly advertise malicious DDoS attacks. In contrast, seven services hide their malicious intention behind "stress-testing" services, a seemingly benign way to verify the resilience of a network against DDoS attacks. However, not a single service performs any kind of attack target validation. That is, service subscribers can specify any IP address (or domain) that should be attacked, regardless of whether the target is under the control of the client. This shows the clear malicious intention behind all 23 booter services.

| **Booter Service** | **CharGen** | **DNS** | **NTP** | **SSDP** |
|-------------------|-------------|---------|---------|----------|
| AUR               | ✓           |         | ✓       |          |
| BAN               | ✓           |         | ✓       |          |
| BO1               | ✓           |         | ✓       |          |
| BO2               | ✓           |         | ✓       |          |
| BO3               | ✓           |         | ✓       |          |
| CRI               | ✓           |         | ✓       |          |
| DOW               | ✓           |         | ✓       |          |
| EXI               | ✓           |         | ✓       |          |
| EXO               | ✓           |         | ✓       |          |
| KST               | ✓           |         | ✓       |          |
| INB               | ✓           |         | ✓       |          |
| NET               | ✓           |         | ✓       |          |
| RAW               | ✓           |         | ✓       |          |
| SER               | ✓           |         | ✓       |          |
| STA               | ✓           |         | ✓       |          |
| ST1               | ✓           |         | ✓       |          |
| ST2               | ✓           |         | ✓       |          |
| ST3               | ✓           |         | ✓       |          |
| ST4               | ✓           |         | ✓       |          |
| SYN               | ✓           |         | ✓       |          |
| THU               | ✓           |         | ✓       |          |
| VDO               | ✓           |         | ✓       |          |
| WEB               | ✓           |         | ✓       |          |

Booter services maintain front-end sites that allow their customers to purchase subscriptions and launch attacks using simple web forms. We created custom crawlers to automate the task of visiting the websites of covered booters and launching attacks directed at our own target. Using this automation, daily attacks were launched for each covered booter and attack type. A total of 13 booter services were covered within the first week of starting the self-attacks on December 9, 2015, and by January 14, 2016, all 23 booters were covered.

**Labeling Self-attacks:**
As we instructed all booters to attack the same target, we had to find a mechanism to separate multiple consecutive self-attacks to assign (booter) labels to the attack traffic. Initially, we relied on the time that attacks were initiated. To account for clock skew, we left 10 minutes between consecutive attacks and used a grace period of ±3 minutes for matching. On January 14, we started to use a distinct victim IP per booter service as an improved matching criterion. Based on the same criterion, we then also mapped the self-attacks to attacks observed at the honeypots.

| **Protocol** | **Booters** | **Launched Attacks** | **Observed Attacks** |
|--------------|-------------|----------------------|----------------------|
| CharGen      | 16          |                      |                      |
| DNS          |             |                      |                      |
| NTP          | 19          |                      |                      |
| SSDP         | 22          |                      |                      |
| **Total**    | 23          |                      |                      |

This structured approach ensures clarity, coherence, and professionalism in the presentation of the research.