title:Linking Amplification DDoS Attacks to Booter Services
author:Johannes Krupp and
Mohammad Karami and
Christian Rossow and
Damon McCoy and
Michael Backes
Linking Ampliﬁcation DDoS Attacks
to Booter Services
Johannes Krupp1(B), Mohammad Karami2, Christian Rossow1,
Damon McCoy3, and Michael Backes1,4
1 CISPA, Saarland University, Saarbr¨ucken, Germany
johannes.krupp@cispa.saarland
2 Google, Inc., Mountain View, CA, USA
PI:EMAIL
3 New York University, New York, USA
4 MPI-SWS, Saarbr¨ucken, Germany
Abstract. We present techniques for attributing ampliﬁcation DDoS
attacks to the booter services that launched the attack. Our k-Nearest
Neighbor (k -NN) classiﬁcation algorithm is based on features that are
characteristic for a DDoS service, such as the set of reﬂectors used by that
service. This allows us to attribute DDoS attacks based on observations
from honeypot ampliﬁers, augmented with training data from ground
truth attack-to-services mappings we generated by subscribing to DDoS
services and attacking ourselves in a controlled environment. Our eval-
uation shows that we can attribute DNS and NTP attacks observed by
the honeypots with a precision of over 99% while still achieving recall
of over 69% in the most challenging real-time attribution scenario. Fur-
thermore, we develop a similarly precise technique that allows a victim
to attribute an attack based on a slightly diﬀerent set of features that
can be extracted from a victim’s network traces. Executing our k -NN
classiﬁer over all attacks observed by the honeypots shows that 25.53%
(49,297) of the DNS attacks can be attributed to 7 booter services and
13.34% (38,520) of the NTP attacks can be attributed to 15 booter ser-
vices. This demonstrates the potential beneﬁts of DDoS attribution to
identify harmful DDoS services and victims of these services.
1 Introduction
Distributed Denial-of-Service (DDoS) attacks have become commoditized by
DDoS-for-hire services, commonly called booters or stressers [7,19]. A large num-
ber of booter services advertise their services openly as an economical platform
for customers to launch DDoS attacks. At the same time DDoS attacks are
increasing in number and in magnitude. This proliferation of DDoS attacks has
caused many network and website operators to rank this type of attack as one of
Electronic supplementary material The online version of this chapter (doi:10.
1007/978-3-319-66332-6 19) contains supplementary material, which is available to
authorized users.
c(cid:2) Springer International Publishing AG 2017
M. Dacier et al. (Eds.): RAID 2017, LNCS 10453, pp. 427–449, 2017.
DOI: 10.1007/978-3-319-66332-6 19
428
J. Krupp et al.
the largest threats facing them [13]. This barrage of DDoS attacks has increased
the demand for Content Delivery Networks (CDNs) and Software Deﬁned Net-
working defenses that can absorb and ﬁlter these attacks [5]. In turn, this has
prompted attackers to react by devising increasingly eﬃcient methods of bypass-
ing or overwhelming defenses. The result is an escalating technological arms-race
between DDoS attackers and defenders that at times has congested segments of
the core Internet infrastructure as collateral damage [17].
Despite the proliferation of DDoS services and attacks, little progress has
been made on attributing the services that are launching these attacks on behalf
of their customers. Most ideas for attribution focus on IP traceback mecha-
nisms [16,21–23,30] to trace the source of spoofed IP packets, which require
ISPs to assist and so far have not been widely deployed. This has resulted in
most of these attacks being unattributed unless the attackers unveil themselves.
While it is important to create strong technological DDoS defenses, we argue
that there is also beneﬁt in investigating other methods that enable attribu-
tion of DDoS attacks to the services responsible for launching these attacks.
For instance, some of these booter services—seven out of 23 services that we
studied—claim they are benign services by advertising as “stress-testing” ser-
vices intended to be used only by authorized administrators. For example, one
of these services included this statement on their website, “We provide a pro-
fessional and legal ip stresser service which is based on a massive 20 dedicated
server backend, ensuring that your server is tested to its limits.” Attribution can
remove this veil of legitimacy and assist eﬀorts to undermine these services by
allowing victims and law enforcement to attribute which booter services were
responsible for an attack. Attribution also enables measuring the scale of these
services and prioritizing undermining the larger services that are causing more
harm. In order to assist ongoing investigations, we are continually sharing infor-
mation from our study on DDoS attacks and booter services with the European
Police Oﬃce (Europol), the United States Federal Bureau of Investigation (FBI)
and large ISPs or backbone providers.
In this work, we show that it is possible to build supervised learning
techniques that allow honeypot ampliﬁer operators and victims to accurately
attribute attacks to the services that launched them. To begin, we identify three
key features that honeypot operators can record to construct a supervised k-NN
classiﬁer that can attribute attacks. In order to validate our method, we sub-
scribed to 23 booter services and generated a ground truth data set of attacks
to booter service mappings1. Validation of our classiﬁer using the ground truth
self-attack data set shows that it is highly precise at attributing DNS and NTP
attacks with a precision of over 99% at 69.35% recall in the worst case of real-time
attribution. When retrospectively attributing attacks, the recall even increases
to 86.25%. Executing our classiﬁer over the set of all attacks observed by the
honeypots shows that 25.53% (49,297) of the DNS attacks can be attributed to
7 booter services and 13.34% (38,520) of the NTP attacks can be attributed to
15 booter services.
1 Our ethical framework for these measurements is based on previous studies that
have used this methodology [7, 20].
Linking Ampliﬁcation DDoS Attacks to Booter Services
429
Finally, we show that a k-NN classiﬁer can also be used by victims to attribute
DDoS attacks to the service that launched the attack. Our ﬁndings demonstrate
that many of the attacks we observed can be attributed to a small set of booter
services that are operating relatively openly. Our ability to attribute large num-
bers of attacks to a small set of booter services and sharing of this information
with Europol and the FBI to assist in active investigations demonstrates the
usefulness of our attribution methods.
In summary, we frame our contributions as follows:
– We present a k-NN-based classiﬁer that attributes ampliﬁcation DDoS attacks
observed by honeypots with a precision of over 99% while still achieving recall
of over 69% in the most challenging real-time attribution scenario.
– We present a similarly precise technique that allows a DDoS victim to
attribute attacks based on features extracted from a victim’s network traces.
– We attribute 25.53% (49,297) of the DNS attacks to 7 booter services and
13.34% (38,520) of the NTP attacks to 15 booter services.
2 Background
2.1 Threat Model
Ampliﬁcation DDoS constitutes a powerful attack in which an adversary aims
to exhaust the bandwidth of a victim’s host or network by inducing a large
volume of traﬃc. Towards this, the attacker abuses multiple servers as so called
ampliﬁers. These servers oﬀer UDP-based protocols prone to ampliﬁcation, i.e.,
the server’s response is signiﬁcantly larger than the corresponding request sent
to the server. At least 14 protocols suﬀer from this ﬂaw [18], such as NTP
and DNS, leading to a multitude of servers that can be exploited as ampliﬁers.
Given the connection-less nature of UDP, an attacker can redirect the servers’
responses to the victim by simply spooﬁng the source IP address in requests.
Due to ampliﬁcation ratios of a factor of 5 to 4500 [18], an attacker that sends
requests at a rate of some Mbit/s can still cause attack traﬃc at Gbit/s-scale.
Furthermore, we are concerned with a special type of attacker: booter services.
These oﬀer platforms for DDoS-as-a-service, often under the disguise of “stress-
testing”, where customers can request various types of attacks for a small fee. The
booter will then launch these attacks using its infrastructure. Our threat model
thus contemplates four parties: Customers, who commission attacks; booters,
who conduct the actual attacks; ampliﬁers, who are exploited to amplify traﬃc;
and victims, who are the targets of such attacks.
The aim of this paper is to attribute attacks to booters, when observed from
either the victim’s or an ampliﬁer’s perspective. This is non-trivial, as from the
victim’s perspective the attack seems to stem from the ampliﬁers. Similarly,
from an ampliﬁer’s perspective, the requests seem to be legitimate requests by
the victim (due to the use of spoofed source IP addresses by the booter). While
ultimately one would like to identify the customer, only the booter, ampliﬁers,
and the victim are directly participating in an attack. Nonetheless, since the
430
J. Krupp et al.
booter has a business relation to the customer, pinpointing the booter behind
an attack constitutes an important step towards this goal.
2.2 Ethical Considerations
As part of our study we subscribed to 23 booters and conducted a controlled set
of self DDoS attacks. Furthermore, we also leveraged honeypots for ampliﬁcation
attacks. We settled on this methodology for collecting a ground truth data set of
mappings between observed attacks and the services that launched these attacks
after ﬁnding that no data set available to us could be used to validate our DDoS
attribution techniques. Before we began performing these self DDoS attacks we
carefully attempted to minimize the harms and maximize the beneﬁts associated
with our methodology based on observations from previous studies that launch
self-attacks in order to measure booter’s attacks [7,20].
We received an exemption from our Institutional Review Board (IRB), since
our study did not include any personally identiﬁable information. In addition, we
consulted with our institution’s general counsel, who advised us not to engage
with any DDoS service that advertised using botnets and to cease active engage-
ment with any booter service that we realized was using botnets.
An analysis of TTL values observed by the honeypots indicated that it is
unlikely any of the booter services we subscribed to used botnets. Based on the
guidance of our institution’s general counsel, our victim server was connected
by a dedicated 1 Gbit/s network connection that was not shared with any other
servers. We also obtained consent from our ISP and their upstream peering points
before conducting any DDoS attack experiments. We also minimized the attack
durations, notiﬁed our ISP before launching any attack and had a protocol in
place to end an attack early if it caused a disruption at our ISP.
We purchased subscriptions from 23 booter services. When doing so, we
selected the cheapest option, which ranged from $6–$20 and averaged $12 per
month, to minimize the amount of money given to these services. In total, we
spent less than $400 and no individual booter service received more than $40 in
payments as part of the measurements in this paper2. All payments were made
using PayPal and we assumed that proper controls were put in place at PayPal
to mitigate the risk of money ﬂowing to extremist groups. As part of our design
methodology, we minimized the amount of money paid and targeted a small set
of booters to obtain a valuable ground truth data set.
Our method created some harm to ampliﬁers and their upstream peering
points by consuming bandwidth resources. The largest amount of bandwidth
consumed was 984.5 kbit/s for NTP ampliﬁers and the least was 16.7 kbit/s for
DNS ampliﬁers, similar to those reported in a previous study [7].
Over the course of our experiments we did not receive any complaints from
the operators of these ampliﬁers. We limited our attacks to 30 s. Based on
2 To put this into perspective: Previous studies of these booters have shown that
they have thousands of paid subscribers and generate revenues of over $10,000 per
month [7, 19].
Linking Ampliﬁcation DDoS Attacks to Booter Services
431
analysis from a previous study that used a similar methodology [7], these short
duration attacks enable us to observe about 80% of the ampliﬁers used by a
given booter service and reduce the harm we cause to misconﬁgured ampliﬁers.
Similarly, the use of DDoS honeypots might also incur harm on the Inter-
net. We used AmpPot, a honeypot proposed by Kraemer et al. [8]. To avoid
contributing to DDoS attacks, AmpPot limits the rate of requests and deploys
automatic IP blacklisting: The honeypots will stop responding for one hour to
any IP address sending more than 10 requests per minute. This limits the max-
imum amount of data sent to a DDoS victim to a few kilobytes. For a more
detailed ethical discussion on AmpPot we refer the reader to [8].
3 Ampliﬁcation Attack Data Set
To investigate if and how ampliﬁcation attacks can be attributed to their origi-
nating booter service, we established two data sets that help us to gain insights
into the overall ampliﬁcation attacks, but also to ﬁnd concrete attack instances
caused by individual booters. In Sect. 3.1, we describe how we leverage ampliﬁ-
cation honeypots to gain insights into global ampliﬁcation attacks. In Sect. 3.2,
we discuss how we use booters and launch controlled attacks against ourselves
to learn about attack techniques of certain attackers.
3.1 Honeypot Attacks
Although the general threat of ampliﬁcation attacks has been known for years,
actual attack insights are only documented in anecdotal evidence, such as attacks
against Spamhaus or OVH at hundreds of Gbit/s attack volume. To collect
insights into the set of global ampliﬁcation attacks, we leverage data collected
by AmpPot [8], a honeypot proposed by Kr¨amer et al. AmpPot emulates
seven UDP-based protocols that have known ampliﬁcation vectors and will thus
eventually be abused as part of real-world DDoS ampliﬁcation attacks (QOTD,
CharGen, DNS, NTP, RIPv1, MSSQL, and SSDP). Kr¨amer et al. observed that
attackers will eventually ﬁnd such honeypots via Internet scans, and start abus-
ing them as potential reﬂectors shortly thereafter. AmpPot thus serves as an
eye on global ampliﬁcation attacks, and due to the nature of the attack traﬃc,
can also observe who is being attacked and when.
In December 2014, eleven globally-distributed honeypots with single static
IP addresses were deployed, and have been operated continuously since then.
In November 2015, a twelfth honeypot was added, listening on 48 static IP
addresses. This honeypot employs a special feature named Selective Response,
where each source scanning for ampliﬁers will ﬁnd a unique set of 24 IP
addresses3 [10].
We set our analysis period to two months from December 9, 2015 to February
10, 2016. In this period, the honeypots observed 570,738 ampliﬁcation attacks
3 The idea behind this is to imprint a unique ﬁngerprint on each scanner. Letting each
scanner ﬁnd 24 IP addresses maximizes the total number of ﬁngerprints.
432
J. Krupp et al.
(8,918 attacks per day on average). However, given that RIPv1, MSSQL, and
QOTD combined account for less than 5% of these, we decided to exclude those
protocols from our analyses.
3.2 Self-attacks
The honeypots give us valuable insights into global attacks, but do not give us
indications where the attacks were coming from. Previous studies have identiﬁed
so-called booter services (“booters”) as being responsible for a large number
of ampliﬁcation attacks [6,7,20]. In an attempt to learn attack characteristics
of these booters, we signed up at these services and then launched short-lived
ampliﬁcation attacks against a target in our control.
To start launching self-attacks and correlating them with the traﬃc seen at
the honeypots, our ﬁrst task was to identify booter services to cover in the study.
Absent a centralized location for ﬁnding booters, we located services via search
engines and advertisements on underground forums. We selected a total of 23
services oﬀering ampliﬁcation attacks based on NTP, DNS, CharGen and SSDP.
When selecting these booters, we tried to include services that we speculated
to be more stable and have more subscribers based on reviewing user feedback
on underground forums. To minimize the amount of money we paid to these
abusive services, we kept the number of covered booters relatively small.
Table 1 provides an overview of the booter services4 that we cover and the
ampliﬁcation attack types they oﬀer. NTP was the most popular attack pro-
tocol, followed by DNS. 16 of the 23 services clearly advertise malicious DDoS
attacks. In contrast, seven services hide their malicious intention behind “stress-
ing” services, a seemingly benign way to verify the resilience of a network against
DDoS attacks. However, not a single service performs any kind of attack target
validation. That is, service subscribers can specify any IP address (or domain)
that should be attacked, regardless of whether the target is under the control of
the client. This shows the clear malicious intention behind all 23 booter services.
Table 1. Covered booter services
AUR BAN BO1 BO2 BO3 CRI DOW EXI EXO KST INB NET RAW SER STA ST1 ST2 ST3 ST4 SYN THU VDO WEB
CharGen ✓ ✓ ✓ ✓ ✓
✓
✓ ✓
✓ ✓ ✓
✓ ✓ ✓
✓
DNS
NTP
✓ ✓
✓ ✓
✓ ✓
✓
✓ ✓ ✓ ✓ ✓ ✓
✓ ✓ ✓ ✓
✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓ ✓
✓ ✓ ✓ ✓ ✓ ✓
SSDP
✓ ✓ ✓ ✓ ✓
✓
✓ ✓ ✓ ✓
✓ ✓ ✓
✓
✓ ✓
Booter services maintain front-end sites that allow their customers to pur-
chase subscriptions and launch attacks using simple web forms. We created cus-
tom crawlers to automate the task of visiting the websites of covered boot-
ers and launching attacks directed at our own target. Using this automation,
4 To avoid unintentionally advertising booter services covered in this study, we replace
the name of booter services by the ﬁrst three letters of their domain name. The last
letter is replaced by a number in the case of name collisions.
Linking Ampliﬁcation DDoS Attacks to Booter Services
433
daily attacks were launched for each covered booter and attack type. A total of
13 booter services were covered within the ﬁrst week of starting the self-attacks
on December 9, 2015 and by January 14, 2016 all 23 booters were covered.
Labeling Self-attacks: As we instructed all booters to attack the same target,
we had to ﬁnd a mechanism to separate between multiple consecutive self-attacks
to assign (booter) labels to the attack traﬃc. To this end, we initially relied on
the time that attacks were initiated. To account for clock skew, we left 10 min
between consecutive attacks and used a grace period of ±3 min for matching.
On January 14, we started to use a distinct victim IP per booter service as an
improved matching criterion. Based on the same criterion, we then also mapped
the self-attacks to attacks observed at the honeypots.
Table 2. Overview over self-attacks
Protocol Booters Launched attacks
Observed
CharGen 16
DNS
NTP
SSDP
Total
19
22