这之后的过程就没有什么意思了。懒蜗牛在Windows
XP中进入刚刚创建的那个空间，双击那个setup.exe文件，就开始了Office的安装。在一堆毫无悬念的"下一步"之后，就装好了。
5.2.7 更多虚拟机介绍
内存里的软件们逐渐熟悉了Windows
XP的工作场景，渐渐地都把目光从大玻璃笼子里的Windows
XP身上收回来，并且从"好奇"档切换到"崇拜"档，然后投向盒子妹。大家纷纷称赞："盒子妹你真厉害！""竟然能控制好这么大的内存，里面关着Windows
XP还不让它溢出。""你是怎么给Windows XP虚拟出那么一块显卡的？"
盒子妹被崇拜得不大好意思，向大家说道："其实......也没有什么啦。我只是创造出一个虚拟的计算机而已。有这种能力的，也不是只有我有一个，像Qemu，VMware这些都是值得我学习的前辈。"
【老牌的VMware】
gedit小弟忙问："VMware？这是啥？说来听听。"
狐狸接过来说："我来介绍吧！VMware，这是个比较老牌的虚拟机软件，各方面都比较强悍。长相有些纠结，就是如图5.47所示这个样子。他的稳定性是很高的，好多企业服务器都用到他。"
![alt](images/00243.jpeg){.calibre3}
图5.47 VMware的Logo
我不解地问："服务器用虚拟机干什么？"盒子妹过来解释："主要是为了在节约硬件成本的同时，提高系统解决方案的安全性。打个比方吧，比如一个公司内部，要架设一个邮件服务器，和一台ftp文件共享服务器。由于用户不多，所以这两个服务都不需要很高的硬件配置。完全可以在一台服务器上跑这两个服务。"
"那就装俩呗！"gedit忍不住说。
"但是，"狐狸妹妹接了过来，"如果提供邮件服务的软件有漏洞，就可能有入侵者通过漏洞获取整个系统的管理员权限，然后就可以影响到ftp服务。反过来也一样。于是这台服务器被攻破的概率就变大了。是吧，妹子？"
盒子妹点点头："嗯！就是这个意思。在一个系统中，开启的服务越多，可能引来的漏洞就越多，一旦其中一个服务被攻击，就可能影响其他的服务。"
狐狸也点点头："对，就是这意思。"
盒子妹继续说："但是用VMware这样的虚拟机就不同了，可以在服务器上装虚拟机，再在每个虚拟机里分别装系统，每个虚拟系统分别跑一个服务。"
狐狸："对，分散。"
盒子："这样就算某个系统上的服务受到攻击......"
狐狸："也不影响其他服务。"
盒子："所以就等于把风险......"
狐狸："分散了。"
盒子："这样安全性就......"
狐狸："提高了。"
我和gedit都点点头："行，你们俩说相声去吧！"
【Virtual PC】
"那还有什么虚拟机软件呢？"gedit继续问。
狐狸说道："那时候还有个叫Virtual
PC的，一开始称得上跟VMware并驾齐驱了。那时候的情况是，VMware对内存的需求比较大，而Virtual
PC对硬盘用得比较多。不过后来那个Virtual
PC被微软公司收购了，自此以后就慢慢地销声匿迹了，我找到一张他工作时的照片，如图5.48所示。"众软件看了纷纷叹气摇头，惋惜这位明珠暗投的软件。
![alt](images/00244.jpeg){.calibre3}
图5.48 Virtual PC中运行的Windows XP
![alt](images/00011.jpeg){.tpzz}**提示：**[Virtual
PC被微软收购后，不再提供对Linux主系统及客户系统的支持。即：既不能在Linux系统中安装Virtual
PC软件，也不能在Virtual PC虚拟的计算机内安装Linux系统。后来自Virtual PC
2007版本以后，再没有更新桌面版Virtual PC。]{.kai1}
【Qemu】
狐狸妹妹稍稍停顿后继续说："后来，咱们开源界自然也不甘寂寞，有了Qemu这个虚拟机。这是一个字符界面的软件，使用起来有些费劲，不过功能很强大，可以和GDB协作，用于调试内核代码。也就是在Qemu创建的虚拟机里面跑一个内核，然后在虚拟机外开着一个GDB来进行调试。再加上他开源的性质，可以很方便地迁移到各种硬件平台，于是成为嵌入式开发者常用的软件。"
"哦......"大家虽然"哦"了一下，但我估计还有很多软件不知道嵌入式是什么意思。
狐狸妹妹继续说："后来呢，Qemu确实使用不方便，不过好在是开源的，于是就有人在Qemu的基础上进行改造，添加了图形界面，并且增强了对显卡的支持等，最终把Qemu改造成了一个很好用的虚拟机。"gedit问："改完了叫什么？还叫Qemu么？"狐狸微微笑了一下，望向盒子妹，只见盒子妹不好意思地说："就是我啦，我是在Qemu的基础上修改而来的。"
【KVM】
继续听狐狸介绍："再后来呢，出了那个叫CPU的虚拟技术，就是让CPU可以支持直接被虚拟机使用，比如Intel家的VT-x技术和AMD公司的AMD-v技术，虽然实现可能不大一样，不过从根本上讲其原理都差不多。"
gedit问："这种技术是干什么用的？"
盒子妹解释道："主要就是可以提高虚拟机的运行效率。对于这种技术支持得最好的，可以说就是KVM了。不过他需要内核的支持，并且本身并不是一个完整的虚拟机软件，因此需要依赖Qemu来运行。"
狐狸接过盒子的话说："这样运行起来的虚拟机，运算效率大幅度提高。但是KVM虚拟的显卡很差劲，所以用来虚拟不需要太多显示任务的服务器应用很有意义，但是对于桌面应用，看片、玩游戏，就不如咱们的盒子妹妹了。"盒子妹又不好意思地说："姐姐过奖了。"
![alt](images/00011.jpeg){.tpzz}**提示：**[现在的VirtualBox同样可以支持CPU虚拟化技术。在虚拟机管理界面单击"设置"按钮，在左侧列表框里选择"系统"，然后在右侧选择"硬件加速"标签，如图5.49所示。勾选"启用VT-x/AMD-V"，以及"启用Nested
Paging"复选框即可（前提是确认你的CPU支持相应虚拟化技术）。]{.kai1}
![alt](images/00245.jpeg){.calibre3}
图5.49 设置硬件加速
5.2.8 扩展阅读：虚拟化技术
刚才说到了CPU的虚拟化技术，顺道介绍介绍这个CPU的虚拟化到底是怎么回事吧。
【只有操作系统才能随意使用CPU】
话说这个CPU可是我们程序要使用的重要设备，每个程序都离不开它。可是CPU很贵，不能发给每个程序一个（否则懒蜗牛同学会破产），于是就得由我统一管理CPU的使用。狐狸妹妹来了，我会把CPU给她用，gedit小弟也来了，他也要用，那么我就告诉他俩，一人用一阵儿。
像狐狸，gedit这些普通的程序我都可以管，因为我是内核嘛。普通的程序们也都知道我让他们停止使用CPU时，一定得停止。并且，CPU的哪些功能是可以用的，哪些是不能用的，他们也都清楚。但是现在盒子妹饲养的Windows
XP工作，就不一样了。
![alt](images/00011.jpeg){.tpzz}**提示：**[某些CPU的高级命令只有内核级别的代码才能够使用。]{.kai1}
【虚拟的操作系统也想随意使用CPU】
Windows
XP在工作的时候，是不管其他人的。首先他根本也看不见其他人，再者，他也是个操作系统，正常来说，他运行在一台机器上的时候，所有软件都得听他的。他可以随便使用任何硬件，当然包括这个CPU，就像我在我们这里的地位一样。然而当他运行在虚拟机里的时候，我们可不能真的让他随意使用CPU，否则万一他执行个啥特权级指令，搞不好我们整个系统就挂了。
你问啥叫特权指令？简单地说，CPU的指令分为两种，普通指令和特权指令。一般软件用CPU的时候都是执行各种普通指令，特权指令只有我这个操作系统可以执行。之前不是说CPU就像是个计算器么，特权指令就像这个计算器上的一些特殊的按键，实现一些特殊的功能，比如关机、复位什么的。这些按键一般人不许动，只有我可以按。
【让虚拟的系统用虚拟的CPU去吧】
那么既然有我在，当然就不许Windows XP动这些东西。可是盒子妹要给Windows
XP营造一个真实的硬件环境才行，怎么办呢？很简单，虚拟一个假的给Windows
XP用。看Windows
XP给虚拟的CPU发了普通指令，就扭头向我申请使用CPU，然后把那个指令在真实的CPU上执行一下，最后把结果传回给Windows
XP。如果Windows
XP执行了一个特权命令，那么盒子就不真的去执行，而是模拟一下执行那个命令后应该有的效果。比如Windows
XP执行了CPU自爆指令，盒子妹就在那里模拟："轰隆！咔嚓，哎哟......"然后Windows
XP就信以为真了。
【虚拟化技术让虚拟系统能用上真的CPU】
那现在回来说这个CPU的虚拟化技术。
Windows
XP的每一个命令都由盒子妹转发是一件比较耗费时间的事情，于是人们提出了CPU的虚拟化技术。支持虚拟化技术的CPU有两种操作模式：VMX
root operation（根虚拟化操作）模式和VMX non-root
operation（非根虚拟化操作）模式，统称为VMX操作模式。VMX root
operation就是平时我们用的模式。而VMX non-root
operation则是像盒子妹饲养的Windows
XP这样的虚拟机系统所用的模式，在这种模式下，一些特权指令可以执行，但不会对真机起任何作用。
有了这种技术后，盒子妹就轻松了。Windows