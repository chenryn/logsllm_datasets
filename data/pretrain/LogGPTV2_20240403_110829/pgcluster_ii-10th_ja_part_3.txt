P($/%(1*728*9*827B
–
共有ストレージ（SAN/NASを利用）
L%/)&%A$)"4*.+/)’0/)"&
•
分散postmaster
730&"4*OCU*4$&%(1*4%/)&%A$)"4*/"&F"&/
–
分散サーバ间の共有IPC
Sh共ar有eIdP CIPC
postmaster postmaster postmaster
Shared storage
共有ストレージ
SSAAN/NNA /SNAS
PGCluster Copyright(c) 2006 A.Mitani 20
E+6*)+*/30&"*OCU*4$&%(1*
分散サーバ间でどのようにIPCを共有するか
4%/)&%A$)"4*/"&F"&/
Z0/%:0&".B /)+&01"9%.:9%.:%=: U&"0)"730&"4\"’+&D2(47"’0.3+&"/>B
CS7"’0.3+&"U&"0)">B /)+&01"9B
CS7"’0.3+&"!"/")>B /)+&01"9B
R+:;@0%)U0(:"<>B
CS7"’0.3+&"R+:;>B /)+&01"9B
/)+&01"9B
C&+:@0%)Q+&7%1(0<>B
CS7"’0.3+&"5(B /)+&01"9B
R@R+:;!"B
/)+&01"9B
U3":;L"04R+:;>B
C&+:7"(47%1(0<>B
/)+&01"9B
CS7"’0.3+&"Y&DR+:;>B /)+&01"9B
6 delegate functions Called 14 functions
PGCluster Copyright(c) 2006 A.Mitani 23
C0):3*.+%()*%(*+&4"&*)+
メモリ共有のためのパッチポイント
/30&"*’"’+&D
Z1@&%)"&73’"’ .+/)’0/)"&9A16&%)"&=: Z0:;1&+$(4@&%)"&\0%(>B Z$,,"&L"/:&%.)+&/ /)+&01"9A$,,"&9A$,i%(%)=: O(%)Z$,,"&C++<>B /3’O(F0B
Z1@&%)"&73’"’O(%)>B /)+&01"9A$,,"&9A$,’1&=: !"04Z$,,"&>B ("6R+:;\")3+4 /)+&01"9B
\$B C%(Z$,,"&>B C&+:SB
\$B /)+&01"9A$,,"&9,&""B C&+:k%B
7)0&)$.\$B 7)&0)"1DQ&""Z$,,"&>B L$’’DC&+:k%B
\$B Z$,,"&ZB
\$B 7)&0)"1DU+()&+B
15 pointers
Y&$(:0)"\$B 7)&0)"1DQ&""Z$,,"&>B
Called from 50 functions
Y6+C30/"7)0)" 0::"//9)&0(/0’9)6+.30/"=: Y6+C30/"73’"’O(%)>B 7)&0)"1DO(%)%0B
\0&;2/C&".0&%(1>B Q&""7.0:"\0. /)+&01"9,&""/.0:"9,&""/.0:"=: O(%)Q&""7.0:"\0.>B
!"’+F"Sj0:)>B 4"B
U+()&+B &"0B
@&%)"U+()&+B B
!"04U+()&+B $(B
5.40)"U+()&+B B
jRPS73’"’O(%)>B $(B
Z++)7)&0.jRPS>B :+’.0:)i,/’i/)+&01">B
7)0&)$.jRPS>B .$/3i,/’i&"B
U&"0)"U3":;C+%()>B C\7%1(0B
jR+1U)B 7"(4C+/)’0/)"&7%1(0<>B
24F0(:"jRO(/"&)Z$,,"&>B U3":;C+/)’0/)"&7%1(0<>B
jR+1@&%)">B .&+:2&&0D /)+&01"9%.:9.&+:0&&0D=: U&"0)"730&"4C&+:2&&0D>B
jRPS73’"’O(%)>B C&+:2&&0D244>B
7)0&)$.jRPS>B C&+:2&&0D!"’+F">B
PGCluster Copyright(c) 2006 A.Mitani 24
L"’+(/)&0)%+(*+,*CSU827*9*728B
•
ストレージ（NAS/SAN）
8")6+&;*>%7U7O*9*QUB
•
ネットワーク（iSCSI/FC）
PGCluster Copyright(c) 2006 A.Mitani 26
6-"7#""-&)
质疑応答
L%/:$//%+(*>-()"&.&%/"*$/01"B
质疑応答（エンタープライズ规模での利用）
E+6*)+*%’.&+F"*)3"*."&,+&’0(:"
•
いかにしてパフォーマンスを改善するか
@%)3*3$1"*/%b"*+,*40)0/
–
データサイズが巨大な场合
@%)3*A$/D*0::"//*>/"0&:39$.40)"9%(/"&)B
–
アクセスが多い场合（serach/update/insert）
E+6*)+*%(/$&"*)3"*0F0%CSU<$/)"&B
质疑応答（PGCluster）
• How to contribute as 3rd party
サードパーティとして贡献するには
• Shared / Non shared
共有/非共有
– Which is more important
どちらがより重要なのか
• What is required for PGCluster
PGClusterに必要なのはなにか
PGCluster Copyright(c) 2006 A.Mitani 29
Y30(;*D+$
谢辞
@3"(*D+$*30F"*0*
•
#$"/)%+(*ll*%//$"*ll*&"#$%&"’"()*
,+&*CSU<$/)"&X*6+$<4*D+$*.<"0/"*/"(4*"’0%<=
– ’%)0(%m/&06=:+=^.*
– .1:<$/)"&I1"("&0<m.1,+$(4&D=+&1
g+$*:0(*4+6(<+04*0<<*F"&/%+(*+,*
•
CSU<$/)"&*,&+’*,+<<+6%(1*/%)"X
– 3)).c99.1,+$(4&D=+&19.&+^":)/9.1:<$/)"&9
PGCluster Copyright(c) 2006 A.Mitani 30