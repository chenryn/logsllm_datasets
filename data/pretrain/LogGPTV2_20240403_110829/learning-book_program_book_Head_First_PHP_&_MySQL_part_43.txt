本中增加额外的逻辑。
现在Scone表单域只接受
数字值，而不再接受任
Please emier all of thse infoe
何其他内容。
Name:tthel Hecke
Sor：102g
Scrn shot: CoFlefl sce
(Add)
表单验证超出了数据库安全性的范
畴。第10章还会更详细地讨论表单
验证….
340
第6章
---
## Page 377
保证应用安全
停战！
看起来Ethel原本想要破坏GuitarWars高分，但她的企图最终落空了，
这要归功于对应用的改进，使它能够免受SQL注人攻击。已经发布一
个新的最高分宣布了本届GuitarWars冠军。
A0O
GuitarWars-HighScores
TopScore:465730
465730
Guitar
Name: Jacob Scorche
Date: 2008-05-05 23:28:07
终于等到了！我
Name:
以一个超强的新分数
OBNN≤U
重回到高分表的首位。
Score:
Guitar
20:36:45
Nane:
BNU
Jaco6相信现在高分是安全的
不全受到外部干扰.因此发布
哎呀！又失败了。可能
了一个无人能敌的新的最高分。
我真该学学怎么玩虚拟吉
他了。
Ethel意识到她最好是加入而
PDG
不是继续在下一次较量中失
利.认为可能该学习成为一
个真正的虚拟吉他手了。
你现在的位置
341
---
## Page 378
PHP&MySQL工具箱
PHP &MySQL工 具箱
真9
除了将GuitarWars高分应用提升到一个新的层
exit()
次，你还得到了一些新的工具和技术。下面来复
习其中最重要的一些工具。
这个内置PHP函数会导致PHP
脚本立即停止。一旦脚本遇到
exit（）函数，将不再执行任何算
他PHP代码，也不会向测览器传
header()
送其他HTML代码。
这个内置PHP函数用于从服务器
向浏览器发送一个首部，从而
$SERVER
完成诸如重定向一个页面、指
这个内置PHP超级全局变量提供
定某种内容类型或究成HTTP认
了很多功能，包括存储用户名
证等任务。
和口今，即用户试图访问一个
要求HTTP认证的页面时所输入
的用户名和口今。可以根据期
望值检查输入的值，以保护页
DEFAULT值
面的安全。
这个SQL语句会建立表中一列
is numeric()
的默认值。如果增加了一个新
这个内置PHP函数查看一个值
行，而且未设置该列，则取这
是否是一个数字。查看一个数
个默认值。
值表单域确实包含数字值会非
常有用。
trim(),mysqli_real
escape_string()
这两个内置PHP面数可以很方
便地处理表单数据，防止有问
题的字符干扰SQL奎询。第一
个面数金去除前导和末属空格
后者金对特殊字符转义。
PDG
342
喜9L
---
## Page 379
保证应用安全
人类仲裁
一切都需要仲裁！在这里，这
SQL注入
表示人类往往是找出和消除其
这是一种破坏安全性的方法，
他人发布不良内容的最佳防线。
是指做坏事的人以某种方式破
自动安全技术也很重要，不过
环一个SQL奎询从而非法访问
还是难于匹敌有大脑的活生生
数据库。大多数SQL注入都是
的人！
骗过We6表单在一个动态构造
的查询中直接传入危险的数据。
所以这个问题的解决方案往往
HTTP认证
是表单验证。
这是一种简单的We6安全技术，
通过使用一个用户名和口今限
表单验证
制对We6页面的访问。尽管不
这个过程会检查用户在表单中
遥用于高度安全性的应用，但
输入的所有数据，确保数据遵
HTTP认证确实可以方便快速地
为We6应用增加一定程度的安
循所期望的格式。除了让表单
更易于使用，由于不元许用户
全性。
输入不良数据，因此验证可以
列/值查询
使We6应用更为安全。
这种INSERT查询中，列和相应
的值要究全匹配，而不是依赖
于数据顺序与表结构中的列顺
序相匹配。
你现在的位置
343
---
## Page 381
7构建个性化Web应用
还记得我吗？
再问一次你的名字？Johnson，好的。呢，我
这里没有看到你的记录，Jackson先生。你确信已
经注册了低温存储电话的授权书吗？哦，我知道
了，这么说你现在就在用你的电话与我通话。不
好意思，再问一次你的名字？
任何人都不喜欢被遗忘，特别是Web应用的用户。如果应用提供某种“会员
资格”，这表示用户可以采用一种个性化方式与应用交互，相应地应用需要记住
这个用户。你肯定不愿意每次走进家门时都必须重新向家人介绍你自己，而且也
根本不需要这么做，因为你的家人有一个很好的本领，这就是记忆。不过Web应
用并不会自动地记住用户，要由高水平的Web开发人员使用他们喜欢的工具（可
能是PHP和MySQL）来构建能真正记住用户的个性化Web应用。
PDG
这是新的一章
345
---
## Page 382
很难找到合适的互补配对
他们说的是“对立产生吸引”
这是一个老掉牙的故事：男孩遇到女孩，女孩认为男孩完全是疯子，
而男孩觉得女孩毛病太多，不过他们之间的差异反倒产生了吸引，最
后他们从此幸福地生活在一起。受这个故事的启发，我们要构建一个
爱君这强健
前所未有的约会网站Mismatch.net。Mismatch将充分利用“对立产生
的肌肉！
吸引”理论，根据人们的差异来寻找互补配对。
问题在于，Mismatch还没有问世，非常需要一个Web开发人员完成系
统的构建。所以要请你来。数百万单身人士都在迫切期待你完成这个
应用不要让他们失望！
Johan Nettles
Sidney善欢真人秀、瑜珈
Male
和寿司，希望成功找到
1981-11-03
一个互补配对。
Athens, GA
我实在等不及
了，真希望找到
完美的互补配对。
个性化Web应用需要个人信息，这要求
用户能够在个人层次上访问应用。
SidneyKelsow
Fohan善欢专业裤胶、举重和
Female
Spam午餐肉.非常想知道谁金
1984-07-19
成为依赖他的另一半。
Tempe,AZ
Mismatch用户需要能够在个人层次上与网站交互。一方面，这说
明他们需要个人情况简表，可以在其中输入他们的个人信息，与
其他Mismatch用户共享，如性别、出生年月和所在位置。
346
第7章
---
## Page 383
构建个性化Web应用
Mismatch的关键就是个人数据
所以Mismatch就是要通过个人数据建立联系。这些联系必须在一个用户
社区中建立，其中每个用户能够与网站交互，并管理他们自己的个人数
据。这里使用一个名为mismatch_user的表来维护Mismatch用户，并
这就是Mismatch数据库。
存储他们的个人信息。
在Mismatch数据库
中，mismatch_user表存
储了用户及算个人情况
mismatch_user
K
简表数据。
first_mome
gender
dty
stole
pkcore
user_Id
pie_dete
Sidney
Kelsow
F
Tempe
AZ
sidneypic.jpg 
1
2008-04-17
09:43:11
2008-05-23
Johan
Netfles
M
1981-11-03
Athens
GA
Bd->iduoqol
11
12:24:06
mismatch_user表的每
一行包含一个用户的
个人数据。
AOO
EditProtilefoViewProtile页
Mismb
Mismatch-Edit Profile
面需要知道访问哪个用户的
Mismatch - View Profile
情况简表。
Personal Infomation
First name:
First name: Sidney
Sidney
Last name:
Last name: Kelso%
Kelsow
Gender:
SidneyKelsow
Gender:
Female
Birthdate:
1984-07-19
Birthdate: 1984-07-19
Temge
Female
City:
Location:
State:
AZ
1984-07-19
Ten
Picture:
Fae）
Tempe,AZ
除了查看用户的情况简表，Mismatch用户还可以使用
RAIN
POWER
EditProfile页面编辑他们自己的个人情况简表。不过这
里存在一个问题，应用需要知道要编辑哪个用户的情况
Mismatch如何为各个不同的用
简表。EditProfile页面需要以某种方式跟踪正在访问这
户定制EditProfile页面？
个页面的用户。
你现在的位置》
347
---
## Page 384
为Mismatch增加登录
Mismatch需要用户登录
通过用户登
要解决Mismatch个人数据访问的问题，需要用户完成登录，这说
录，Web应用可
明用户必须登录应用。这样一来，Mismatch就能够允许访问特别
以实现针对用户
针对各个不同用户的信息。例如，一个登录用户只能编辑他自己的
的个性化。
情况简表数据，不过还可以查看其他用户的情况简表。用户登录是
Mismatch应用实现个性化的关键。
用户登录通常涉及两部分信息：一个用户名和一个口令。
用户名
口今
用户名的任务是为每个用户提供一个唯一的
口令负责在用户登录时提供一定程度的安全
名，可以用于在系统内标识该用户。用户还
性，这有助于保护其个人数据。要实现登
可以通过其用户名进行访问以及适当地相互
录，用户必须同时输入用户名和口令。
通信。
******
sidneyk
jnettles
★★★★★★★
口今是极其机密的数据，绝
用户名通常由字母数字字符组
对不要在应用中（甚至教据
成，究全由用户决定。
库中）置为可见。
用户名和口令允许用户登录Mismatch应用并访问个人数据，如编辑其
情况简表。
Edit Probile页面现在指
示用户已经警录。
sidneyk
000
Mismatch-Edi
******
You are logged in as sidneyk.
用户的用户名和口今都是必要
Mismatch-EditProfile
的，这样才能让应用知道他们
用户整录时，应用能够
是谁。
记住这个用户，并提供
个性化体验。
Personal Information
First name:
Sidney
Last name:
Kelsow
Gender:
Female
Birthdate'
1984-07-19
348
第7章
---
## Page 385
构建个性化Web应用
提出用户登录规划
为Mismatch增加用户登录支持绝非易事，编写代码和运行数据库查
询之前一定要明确可能涉及到哪些方面，这很重要。我们知道已经有
一个存储用户的表，所以首先要修改这个表，使之存储登录数据。我
们还需要为用户提供一个输入登录数据的途径，这要以某种方式与
Mismatch应用的其余部分集成，使得用户只能在成功登录后才能访问
EditProfile等页面。以下是目前我们确定的登录开发步骤：
使用ALTER向表中增加usemame和password列。
数据库需要新的列来存储每个用户的登录数据。
这包括一个用户名和一个口令。
2
构建一个新的Log-ln脚本，提示用户输入其用户
名和口令。
最终会由LogIn表单保护个性化页面，因为它会提
示用户输人一个合法的用户名和口令。这个信息
必须正确输人，Mismatch才能够显示用户特定的
数据。所以这个脚本必须限制对个性化页面的访
问，未合法登录的情况下将不能查看这些页面。
3
将Log-In脚本连接到Mismatch应用的
其余部分。
Mismatch应用的Edit
Profile和View
Profile页面只能由登录用户访问。所
以需要确保用户只有通过LogIn脚本
PDO
登录才允许访问这些页面。
你现在的位置
349
---
## Page 386
mismatch创建