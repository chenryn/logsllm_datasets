**国家电网公司信息系统统一日志管理规范**

信息系统行为安全审计顶层设计组  
二○一六年三月

---

**目录**

1. 前言
   - 1.1 概述
   - 1.2 公司日志管理现状
   - 1.3 统一日志管理目标
2. 日志记录规范
   - 2.1 主机设备日志
   - 2.2 网络类设备日志
   - 2.3 安全类日志
   - 2.4 应用类日志
   - 2.5 终端类日志
3. 日志统一采集规范
4. 日志分析规范
   - 4.1 日志解析
   - 4.2 日志挖掘
5. 日志存储规范
   - 5.1 存储原则
   - 5.2 存储时间
   - 5.3 存储格式
   - 5.4 存储规范
6. 日志使用规范
   - 6.1 日志检索
   - 6.2 日志数据可视化
   - 6.3 日志导出
   - 6.4 对外接口

---

# 前言

## 1.1 概述

随着云计算、大数据和移动互联等新技术在国网公司信息化建设中的广泛应用，所面临的安全威胁也日益增多。网络中的主机、服务器、网络设备、安全设备、数据库以及各种应用服务系统在运行过程中会产生大量的运行日志、安全日志和行为日志。工作人员面对数量庞大的信息，由于缺乏有效的分析手段，难以及时准确地定位网络故障和安全隐患。因此，建立一个全面统一的日志收集、分析、存储和消费平台成为必然选择。

日志中心能够对全网范围内的各类设备产生的日志进行规范采集，统一格式，持久化存储，并制定统一策略。通过细致的分析和实时可视化呈现，帮助工作人员从海量日志数据中精确查找关键事件，准确定位网络故障并提前识别安全威胁，保障企业网络安全。

此外，日志中心还能收集运行类、安全类和行为类日志信息，实现对在线业务系统的全面分析。通过对主机、中间件及业务系统日志的关联分析，快速定位并解决问题，结合已有知识库预测潜在问题。

## 1.2 公司日志管理现状

目前，国网下属各公司中，部分公司已具备日志采集、分析和审计的相关系统。然而，这些系统要么建设较早，无法适应新技术和新环境，要么过于专业只能收集部分日志。缺乏统一的日志采集、格式和存储规范，没有进行深入的日志关联分析，不适应云计算和大数据技术。同时，缺少对业务系统运行和审计日志的统一收集、分析和存储，导致日志的准确性、完整性和可信性难以保证，结果分析存在偏差。

部分业务系统的日志记录不规范、不合理，没有统一的记录标准，且未进行长期存储，使得系统运维人员难以从中获取有价值的信息。伴随云计算技术的全面推进，云日志的收集和分析变得迫切。需要具备云日志的获取方法、部署模型、存留策略和灾难恢复策略，以解决监管、依从性和安全性问题。通过对云日志的分析，可以及时获取云环境的运行异常情况和安全态势。

不具备日志采集、分析和审计系统的公司，只能采用手工方式逐一登录每台设备查看日志，效率低下且需要较高的日志分析能力。即使使用一些简单开源工具，也因功能局限而难以达到预期效果。

## 1.3 统一日志管理目标

1. **智能、规范化的日志收集**：不仅完成对主机、网络安全设备、中间件、数据库等基本设备的日志收集，还对信息系统日志、安全审计日志、网络流量等进行全面收集。
2. **实时、极速的日志搜索**：实现日志实时收集和处理，从产生到搜索分析出结果只需几秒钟。
3. **统一标准化的日志记录格式**：针对不同类型日志制定记录规范，统一格式有利于快速解析和索引查询。
4. **统一的日志存储**：满足相关政策法规要求的日志类型和存储时间，规范存储格式，具备高扩展性的企业级分布式文件系统。
5. **安全事件快速定位与响应**：基于收集到的各类日志，快速响应安全事件，定位问题原因，追踪源头并采取相应措施。
6. **标准化的日志使用**：提供统一的使用接口，实现在线日志快速搜索、内容导出及告警和日志内容向第三方平台的推送。
7. **信息系统运行和使用情况分析**：通过对中间件、信息系统等日志的关联分析和数据挖掘，获取运行状态和用户使用情况。
8. **利用大数据和机器学习进行异常行为检测**：通过统计分析、关联分析和机器学习等多种技术手段检测异常模式，提高运维效率并为规则设定提供依据。
9. **安全态势可视化呈现**：从全局、局部和细节三个方面实现安全态势的可视化呈现。
10. **提高安全分析效率**：自动归类告警事件，提供安全事件回溯检索平台。
11. **未知威胁和异常行为检测**：自动识别未知的安全威胁和异常行为，变被动为主动。

---

# 日志记录规范

日志采用文档结构存储，以标准的JSON格式进行扩展。采用syslog、SNMP、端口镜像、第三方工具和代理等方式发送日志。

日志是日志中心处理的最小数据单元，采用半结构化数据模式定义一条日志，具体数据模型如下：

- **主题（Topic）**：用户自定义字段，用于标记一批日志（例如：访问日志根据不同的站点进行标记）。日志主题命名规范如下：
  | 主题标识 | 主题标识说明 |
  |----------|--------------|
  | Win_weblogic | Windows环境下weblogic的http访问类型日志 |
  | Win_weblogic_Server | Windows环境下weblogic服务器日志 |
  | Win_secure | Windows操作系统安全类日志 |
  | Win_system | Windows操作系统系统日志 |
  | Win_app | Windows操作系统应用类日志 |
  | Linux_weblogic | Linux环境下weblogic的http访问类型日志 |
  | Linux_weblogic_Server | Linux环境下weblogic服务器日志 |
  | Linux_message | Linux操作系统标准错误日志，非内核产生的引导信息；各子系统产生的信息 |
  | Linux_secure | Linux操作系统认证相关信息，如用户登录、修改用户信息等操作记录 |
  | Linux_cron | Linux操作系统记录cron和at服务日志信息 |
  | Linux_mail | Linux操作系统记录邮件系统的日志信息 |
  | Linux_boot | Linux操作系统记录系统服务的启动信息 |
  | Linux_dmesg | Linux操作系统记录内核的硬件检测信息 |
  | Switch | 交换机日志 |
  | FireWall_h3c | H3c防火墙日志 |
  | FireWall_dp | 迪普防火墙日志 |
  | Nfocus_ids | 绿盟IDS设备日志 |
  | Nfocus_WAF | 绿盟WAF设备日志 |
  | Nfocus_SAS | 绿盟SAS设备日志 |
  | Nfocus_IPS | 绿盟IPS设备日志 |
  | Trend_stda | 趋势设备日志 |
  | Linux_tomcat | Linux下tomcat http访问日志 |
  | Tap | Tap设备日志 |
  | win_tomcat | windows下tomcat http访问日志 |
  | Linux_tomcat_Cata | Linux下tomcat 服务日志 |
  | win_tomcat_Cata | windows下tomcat 服务日志 |
  | Orcl_Access | Oracle数据库访问日志 |
  | Orcl_opt | Oracle数据库操作日志 |
  | Mysql_Access | Mysql数据库访问日志 |
  | Mysql_opt | Mysql数据库操作日志 |
  | Net_mirror | 网络流量镜像日志 |
  | Sys_BussinessName | 业务系统日志，以sys_开头,后面跟业务系统名称 |
  | Other | 未归类日志，新发现的未知日志类型 |

- **时间（Time）**：保留字段，表示日志产生的时间（精度为秒，从1970-1-1 00:00:00 UTC计算起的秒数），格式统一为"yyyy-MM-dd HH:mm:ss"。

- **内容（Content）**：记录日志的具体内容，由一个或多个内容项组成，每个内容项由Key-Value对组成。

- **来源（Source）**：日志的来源地，例如产生该日志机器的IP地址，默认为空。

为了便于快速解析，我们分别制定了主机类、网络类、安全类和应用类的日志统一规范。

### 2.1 主机设备日志

#### 1. 物理主机日志格式规范

| 序号 | 记录项 |
|------|--------|
| 1    | 事件标识 |
| 2    | 事件产生时间 |
| 3    | 主机名 |
| 4    | 事件优先级 |
| 5    | 事件严重级别 |
| 6    | 事件内容 |
| 7    | 事件导致结果 |
| 8    | 事件源设备地址 |
| 9    | 事件源设备类型 |
| 10   | 事件文件名 |
| 11   | 事件源地址 |
| 12   | 事件源用户名称 |
| 13   | 事件源主机名称 |
| 14   | 事件归类1 |
| 15   | 事件归类2 |
| 16   | 产生事件进程名称 |
| 17   | 应用管理日志-应用名称 |
| 18   | 应用管理日志-安装位置 |
| 19   | 应用管理日志-版本号 |
| 20   | 应用管理日志-登录帐号 |
| 21   | 应用管理日志-操作时间 |
| 22   | 应用管理日志-操作类型 |
| 23   | 用户登录日志-登录时间 |
| 24   | 用户登录日志-登出时间 |
| 25   | 用户登录日志-登录帐号 |
| 26   | 用户登录日志-登录IP |
| 27   | 用户登录日志-登录认证方式 |
| 28   | 用户登录日志-登录认证结果 |
| 29   | 账号管理日志-登录账号 |
| 30   | 账号管理日志-目的账号 |
| 31   | 账号管理日志-操作时间 |
| 32   | 账号管理日志-操作类型 |

#### 2. 虚拟类主机日志格式规范

| 序号 | 记录项 |
|------|--------|
| 1    | 事件名标识 |
| 2    | 事件产生时间 |
| 3    | 主机名称 |
| 4    | 事件优先级 |
| 5    | 事件严重级别 |
| 6    | 事件内容 |
| 7    | 事件导致结果 |
| 8    | 事件源设备地址 |
| 9    | 事件源设备类型 |
| 10   | 事件文件名 |
| 11   | 事件源地址 |
| 12   | 事件源用户名 |
| 13   | 事件源主机名 |
| 14   | 事件分类1 |
| 15   | 事件分类2 |
| 16   | 产生事件进程名称 |
| 17   | 物理磁盘基本信息-磁盘名称 |
| 18   | 物理磁盘基本信息-磁盘类型 |
| 19   | 物理磁盘基本信息-磁盘序列号 |
| 20   | 物理磁盘基本信息-磁盘大小 |
| 21   | 物理磁盘运行信息-磁盘I/O |
| 22   | 逻辑磁盘基本信息-磁盘名称 |
| 23   | 逻辑磁盘基本信息-磁盘大小 |
| 24   | 逻辑磁盘基本信息-磁盘类型 |
| 25   | 逻辑磁盘运行信息-分区使用率 |
| 26   | 文件系统基本信息-名称 |
| 27   | 文件系统信息-大小 |
| 28   | 文件系统信息-类型 |
| 29   | 文件系统运行信息-使用率 |
| 30   | 用户列表信息-用户账号 |
| 31   | 用户列表信息-用户角色 |
| 32   | 密码策略-密码复杂性要求 |
| 33   | 密码策略-密码长度最小值 |
| 34   | 密码策略-密码最短使用期限 |
| 35   | 密码策略-密码最长使用期限 |
| 36   | 密码策略-密码强制密码历史 |

### 2.2 网络类设备日志

#### 1. 路由器设备日志格式规范

| 序号 | 记录项 |
|------|--------|
| 1    | 事件标识 |
| 2    | 事件产生时间 |
| 3    | 设备名称 |
| 4    | 事件优先级 |
| 5    | 事件严重级别 |
| 6    | 事件内容 |
| 7    | 事件导致结果 |
| 8    | 事件源设备地址 |
| 9    | 事件源设备类型 |
| 10   | 事件文件名 |
| 11   | 事件源地址 |
| 12   | 事件源用户名称 |
| 13   | 事件源主机名称 |
| 14   | 事件归类1 |
| 15   | 事件归类2 |
| 16   | 产生事件进程名称 |
| 17   | 接口信息-接口名称 |
| 18   | 接口信息-接口状态 |
| 19   | 接口信息-接口速率 |
| 20   | 接口信息-接口带宽 |
| 21   | 接口信息-接口流量 |
| 22   | 接口信息-接口错误 |
| 23   | 路由信息-路由表 |
| 24   | 路由信息-路由协议 |
| 25   | 路由信息-路由前缀 |
| 26   | 路由信息-下一跳地址 |
| 27   | 路由信息-度量值 |
| 28   | 配置信息-配置命令 |
| 29   | 配置信息-配置时间 |
| 30   | 配置信息-配置用户 |

---