### é€†å‘åˆ†æå¾·å›½Enigmaå¯†ç æœºä»¥è§£å¯†ç”µæŠ¥

#### èƒŒæ™¯
1940å¹´9æœˆ6æ—¥ï¼Œè‹±å›½æƒ…æŠ¥éƒ¨é—¨å†›æƒ…å…­å¤„æˆªè·äº†ä¸€å°é‡è¦çš„å¾·å›½ç”µæŠ¥ã€‚ä¸ºäº†å¸®åŠ©å†›æƒ…å…­å¤„è§£å¯†è¿™å°ç”µæŠ¥ï¼Œæˆ‘ä»¬éœ€è¦é€†å‘åˆ†æå¾·å›½ä½¿ç”¨çš„å¯†ç æœºEnigmaã€‚è¯·å°†æœ€ç»ˆå¾—åˆ°çš„flagä»¥MD5æ ¼å¼æäº¤ã€‚

#### ä¸»è¦å‡½æ•°
- **mainå‡½æ•°**ï¼šè¯»å–`inp`æ–‡ä»¶ä¸­çš„å†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°`enc`æ–‡ä»¶ä¸­ã€‚é¢˜ç›®ç›´æ¥ç»™å‡ºäº†`enc`æ–‡ä»¶ï¼Œè¦æ±‚æˆ‘ä»¬æ±‚å‡º`inp`æ–‡ä»¶çš„å†…å®¹ã€‚å…³é”®çš„åŠ å¯†å†…å®¹ä½äº`loc_4018F0`ã€‚
- **åŠ å¯†å‡½æ•°**ï¼šIDAæ— æ³•æ­£å¸¸è¯†åˆ«è¿™æ®µä»£ç ï¼Œå…¶ä¸­`0xC7 0xFF`å¼€å¤´çš„ä»£ç æ˜¯æ— æ³•æ‰§è¡Œçš„ã€‚ç¨‹åºé€šè¿‡è°ƒç”¨`SetUnhandledExceptionFilter`æ¥è®¾ç½®å¼‚å¸¸æ¥ç®¡å‡½æ•°ï¼Œå¤„ç†å¼‚å¸¸æ—¶æå–é™„è¿‘ä¿¡æ¯å¹¶å°†åå‡ ä¸ªå­—èŠ‚ä½œä¸ºå‚æ•°å¤„ç†ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œçš„`4`ä¼šè¿›å…¥switchè¯­å¥å¹¶è°ƒç”¨case 4åˆ†æ”¯ï¼Œå¹¶ä¼ å…¥å‚æ•°`1`å’Œ`0`ã€‚

#### åŠ å¯†é€»è¾‘
- é€šè¿‡ç±»ä¼¼opcodeå’Œå¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå®ç°äº†è™šæ‹Ÿæœºçš„æ•ˆæœã€‚ç”±äºä¸ä¼šä½¿ç”¨IDCè„šæœ¬ï¼Œåªèƒ½é€šè¿‡åæ±‡ç¼–å¼•æ“é€ä¸ªè¯»å–æŒ‡ä»¤ï¼Œé‡åˆ°é”™è¯¯å†…å®¹æ—¶å°†å…¶è§†ä¸ºopcodeå¤„ç†ï¼Œæœ€åæ‰‹åŠ¨è¿˜åŸæ‰€æœ‰æ±‡ç¼–ä»£ç ã€‚

#### åæ±‡ç¼–å·¥å…·
- ä½¿ç”¨ODï¼ˆOllyDbgï¼‰å†…éƒ¨åæ±‡ç¼–å¼•æ“ï¼Œè¯¥å¼•æ“å·²å¼€æºå¹¶åœ¨GitHubä¸Šæä¾›ã€‚ä¿®æ”¹åçš„ä»£ç å¯ä»¥åœ¨VSä¸Šè°ƒç”¨ï¼Œå…·ä½“å®ç°è§[GitHubåœ°å€](https://github.com/your-repo)ã€‚

#### opcodeè¿˜åŸä»£ç 
```c
// Free Disassembler and Assembler -- Demo program
//
// Copyright (C) 2001 Oleh Yuschuk
//
//  This program is free software; you can redistribute it and/or modify
//  it under the terms of the GNU General Public License as published by
//  the Free Software Foundation; either version 2 of the License, or
//  (at your option) any later version.
//
//  This program is distributed in the hope that it will be useful,
//  but WITHOUT ANY WARRANTY; without even the implied warranty of
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//  GNU General Public License for more details.
//
//  You should have received a copy of the GNU General Public License
//  along with this program; if not, write to the Free Software
//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

/*
* int Assemble(char *cmd, ulong ip, t_asmmodel *model, int attempt, int constsize, char *errtext) - å°†æ–‡æœ¬å‘½ä»¤æ±‡ç¼–ä¸ºäºŒè¿›åˆ¶ä»£ç 
* int Checkcondition(int code, ulong flags) - æ£€æŸ¥å‘½ä»¤ä¸­æ˜¯å¦æ»¡è¶³æ¡ä»¶
* int Decodeaddress(ulong addr, ulong base, int addrmode, char *symb, int nsymb, char *comment) - ç”¨æˆ·æä¾›çš„å‡½æ•°ï¼Œå°†åœ°å€è§£ç ä¸ºç¬¦å·åç§°
* ulong Disasm(char *src, ulong srcsize, ulong srcip, t_disasm *disasm, int disasmmode) - ç¡®å®šäºŒè¿›åˆ¶å‘½ä»¤çš„é•¿åº¦æˆ–å°†å…¶åæ±‡ç¼–åˆ°æ–‡æœ¬ä¸­
* ulong Disassembleback(char *block, ulong base, ulong size, ulong ip, int n) - å‘åèµ°äºŒè¿›åˆ¶ä»£ç 
* ulong Disassembleforward(char *block, ulong base, ulong size, ulong ip, int n) - å‘å‰èµ°äºŒè¿›åˆ¶ä»£ç 
* int Isfilling(ulong addr, char *data, ulong size, ulong align) - ç¡®å®šå‘½ä»¤æ˜¯å¦ç­‰äºNOP
* int Print3dnow(char *s, char *f) - è½¬æ¢3DNowï¼å¸¸é‡ä¸ºæ–‡æœ¬è€Œä¸è§¦å‘æ— æ•ˆæ“ä½œæ•°çš„FPUå¼‚å¸¸
* int Printfloat10(char *s, long double ext) - å°†10å­—èŠ‚æµ®ç‚¹å¸¸é‡è½¬æ¢ä¸ºæ–‡æœ¬è€Œä¸ä¼šå¯¼è‡´å¼‚å¸¸
* int Printfloat4(char *s, float f) - å°†4å­—èŠ‚æµ®ç‚¹å¸¸é‡è½¬æ¢ä¸ºæ–‡æœ¬è€Œä¸ä¼šå¯¼è‡´å¼‚å¸¸
* int Printfloat8(char *s, double d) - å°†8å­—èŠ‚æµ®ç‚¹å¸¸é‡è½¬æ¢ä¸ºæ–‡æœ¬è€Œä¸ä¼šå¯¼è‡´å¼‚å¸¸
*/

#define STRICT
#define MAINPROG                       // Place all unique variables here
#include <windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#include <stdarg.h>
#pragma hdrstop
#include "disasm.h"

unsigned char opcode[] = {
    0x55, 0x8B, 0xEC, 0x53, 0x56, 0x57, 0x68, 0x30, 0x16, 0xAF,
    0x00, 0xFF, 0x15, 0x00, 0x20, 0xB3, 0x00, 0xC7, 0xFF, 0x04,
    0x01, 0x00, 0x33, 0xC9, 0x83, 0xF9, 0x20, 0x7D, 0x17, 0xC7,
    0xFF, 0x00, 0x01, 0x11, 0xC7, 0xFF, 0x04, 0x01, 0x1F, 0x89,
    0x04, 0x8D, 0x70, 0x7A, 0xB4, 0x00, 0xC7, 0xFF, 0x02, 0x03,
    0xEB, 0xE4, 0x33, 0xC9, 0x83, 0xF9, 0x20, 0x7D, 0x2D, 0x8B,
    0x1C, 0x8D, 0x70, 0x7A, 0xB4, 0x00, 0x8B, 0x14, 0x8D, 0x74,
    0x7A, 0xB4, 0x00, 0x8A, 0x82, 0x4C, 0x7A, 0xB4, 0x00, 0x88,
    0x83, 0xE0, 0x79, 0xB4, 0x00, 0x8A, 0x83, 0x4C, 0x7A, 0xB4,
    0x00, 0x88, 0x82, 0xE0, 0x79, 0xB4, 0x00, 0xC7, 0xFF, 0x00,
    0x03, 0x02, 0xEB, 0xCE, 0x33, 0xC9, 0x83, 0xF9, 0x20, 0x7D,
    0x35, 0x8A, 0x99, 0xE0, 0x79, 0xB4, 0x00, 0xC7, 0xFF, 0x04,
    0x02, 0x1F, 0xC7, 0xFF, 0x07, 0x02, 0x03, 0x8B, 0xF1, 0x46,
    0x83, 0xE6, 0x1F, 0x8A, 0x96, 0xE0, 0x79, 0xB4, 0x00, 0x80,
    0xE2, 0xE0, 0x81, 0xE2, 0xFF, 0x00, 0x00, 0x00, 0xC7, 0xFF,
    0x08, 0x04, 0x05, 0x0A, 0xDA, 0x88, 0x99, 0x04, 0x7A, 0xB4,
    0x00, 0x41, 0xEB, 0xC6, 0xA0, 0x04, 0x7A, 0xB4, 0x00, 0xA2,
    0x28, 0x7A, 0xB4, 0x00, 0xB9, 0x01, 0x00, 0x00, 0x00, 0x83,
    0xF9, 0x20, 0x7D, 0x28, 0x8A, 0x99, 0x04, 0x7A, 0xB4, 0x00,
    0x8B, 0xF1, 0xC7, 0xFF, 0x03, 0x05, 0x32, 0x9E, 0x04, 0x7A,
    0xB4, 0x00, 0x8B, 0xF1, 0xC7, 0xFF, 0x04, 0x05, 0x03, 0x32,
    0x9E, 0xF0, 0x68, 0xB4, 0x00, 0x88, 0x99, 0x28, 0x7A, 0xB4,
    0x00, 0x41, 0xEB, 0xD3, 0x5F, 0x5E, 0x5B, 0x5D, 0xC3
};
```

#### æ€»ç»“
- é€šè¿‡åˆ†æå’Œé€†å‘å·¥ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥é€æ­¥è¿˜åŸå‡ºåŠ å¯†ç®—æ³•çš„å…·ä½“å®ç°ã€‚
- åˆ©ç”¨åæ±‡ç¼–å·¥å…·å’Œæ‰‹åŠ¨åˆ†æï¼Œå¯ä»¥å°†opcodeè¿˜åŸä¸ºå¯è¯»çš„æ±‡ç¼–ä»£ç ã€‚
- æœ€ç»ˆï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿè§£å¯†ç”µæŠ¥å¹¶æäº¤MD5æ ¼å¼çš„flagã€‚

å¸Œæœ›å„ä½å¸ˆå‚…èƒ½ç»™æˆ‘ç‚¹ä¸ªStarï¼Œå˜¿å˜¿~ ğŸ˜Š