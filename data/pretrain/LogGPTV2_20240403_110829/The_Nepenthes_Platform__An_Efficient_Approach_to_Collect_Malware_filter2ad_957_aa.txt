# The Nepenthes Platform: An Efficient Approach to Collect Malware

**Authors:**  
Paul Baecher¹, Markus Koetter¹, Thorsten Holz², Maximillian Dornseif², and Felix C. Freiling²

¹Nepenthes Development Team  
²University of Mannheim, Laboratory for Dependable Distributed Systems  
{holz, dornseif, freiling}@informatik.uni-mannheim.de

## Abstract
Currently, there is limited empirical data available on self-replicating malware, which hinders the development of effective countermeasures such as network- and host-based intrusion detection systems (IDS). We introduce the Nepenthes platform, a framework designed for large-scale collection of information on self-replicating malware. By emulating only the vulnerable parts of a service, Nepenthes provides an efficient and effective solution with numerous advantages over traditional honeypot-based methods. Additionally, Nepenthes offers flexible deployment options, enhancing its scalability. Through the use of this platform, we and other organizations have significantly expanded the empirical database of self-replicating malware, providing thousands of previously unknown samples to IDS and anti-virus vendors, thereby improving their detection rates.

**Keywords:** Honeypots, Intrusion Detection Systems, Malware

## 1. Introduction
### Automated Malware Collection
Malware, or malicious software, poses a significant threat to the integrity of individual computers and networks. Self-replicating malware, which spreads automatically by exploiting known or unknown vulnerabilities, can form botnets capable of launching distributed denial-of-service (DDoS) attacks, posing a constant danger even to uninfected sites.

The primary reasons for collecting malware are twofold:
1. **Defensive Improvement:** Analyzing individual malware samples allows for better defenses against similar threats. For example, IDS and anti-virus systems can refine their signature lists, leading to more effective detection.
2. **Statistical Insights:** Large-scale collection enables the generation of statistics on attack patterns, trends, and rates, providing valuable insights based on live and authentic data.

Collecting and analyzing malware in the wild is challenging. Manual forensic examinations of infected machines are labor-intensive and impractical given the rapid proliferation of new malware. Therefore, automated solutions are essential.

### Honeypot Technology
Honeypots are key tools for automated malware collection. They are designed to attract and study attackers by presenting a seemingly vulnerable system. There are two main types:
- **Low-Interaction Honeypots:** Emulate limited services, offering low risk and ease of deployment. Examples include honeyd.
- **High-Interaction Honeypots:** Provide a real system for interaction, offering detailed insights but at higher risk and complexity. Examples include GenIII honeynets.

While high-interaction honeypots offer more detailed insights, low-interaction honeypots are more scalable and easier to deploy.

### Contribution
In this paper, we introduce Nepenthes, a novel honeypot platform that combines the scalability of low-interaction honeypots with the expressiveness of high-interaction ones. Nepenthes is not a standalone honeypot but a platform for deploying vulnerability modules, allowing it to emulate various types of vulnerabilities. This flexibility enables the emulation of different operating systems and architectures on a single machine, enhancing scalability. Our experiments show that Nepenthes can emulate over 16,000 IP addresses on a single physical machine, and its modular design supports specialized analysis and reporting.

### Related Work
Previous research has focused on large-scale measurements of malicious network traffic using tools like the network telescope and darknets. These approaches passively collect information but do not provide detailed insights into full attacks. More expressive tools like the Internet Motion Sensor and honeyd offer limited capabilities compared to Nepenthes. High-interaction platforms like Collapsar and Potemkin, while promising, have limitations in flexibility and scalability.

### Roadmap
This paper is structured as follows:
- **Section 2:** Detailed introduction to the Nepenthes platform.
- **Section 3:** Results and effectiveness of the Nepenthes approach.
- **Section 4:** Future work.
- **Section 5:** Conclusion.

## 2. The Nepenthes Platform
### Overview
Nepenthes extends the concept of low-interaction honeypots to effectively collect malware and study attack patterns. It achieves this by emulating vulnerable services, offering a balance between expressiveness and scalability. Unlike honeyd, which is limited in its ability to emulate complex protocols, and high-interaction honeypots, which are resource-intensive, Nepenthes fills the gap by allowing the deployment of thousands of honeypots in parallel.

### Key Features
- **Vulnerability Modules:** Highly flexible configuration for different types of vulnerabilities.
- **Scalability:** Capable of emulating over 16,000 IP addresses on a single machine.
- **Modularity:** Supports specialized analysis and reporting.
- **Flexibility:** Can emulate different operating systems and architectures during a single attack.

### Deployment
Nepenthes can be deployed in a distributed manner, similar to the Collapsar platform, allowing for centralized management and decentralized presence. This setup enhances the platform's scalability and effectiveness in collecting and analyzing malware.

By leveraging these features, Nepenthes provides a powerful tool for researchers and security professionals to gain deeper insights into the behavior and spread of malware, ultimately contributing to the development of more robust defensive strategies.