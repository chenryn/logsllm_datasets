IT12w
IT11w
IT9
IT7
 64  256  1024  4096 16384 65536
 16
S - block size (addresses)
2005-09
2005-11
2006-01
2006-03
2006-05
2006-07
2006-09
2006-11
2007-01
2007-03
Census Date
Figure 10: Number of addresses protected by visible ﬁrewalls
(including personal ﬁrewalls), in absolute terms (left scale)
and in ratio to responsive, non-ﬁrewalled addresses. (Data
from IT 7 through IT 17w .)
Figure 11: Cumulative distribution of ﬁrewalled blocksize.
This graph omits 190–225k personal ﬁrewalls. (Data from
IT 7 through IT 17w .)
protected by visible ﬁrewalls (left axis and bottom line), and
the ratio of that count to the number of responsive addresses
(right axis and top line). The number of ﬁrewalled addresses
is then the sum of the size of all ﬁrewalled blocks.
We see nearly 40M addresses protected by visible ﬁrewalls.
The visibly ﬁrewalled space is a very small fraction of the al-
located address space (about 1.5% of 2.6B–2.8B addresses).
The ﬁrewalled address space is, surprisingly, relatively sta-
ble over three years of observation. However, when we com-
pare the ratio of addresses protected by visible ﬁrewalls to
the number of responsive, non-ﬁrewalled addresses, we see a
downward trend. In mid-2005, there was 1 visibly ﬁrewalled
address for every 2 responsive addresses; by the end of 2006
this ratio had declined to nearly 1:3. We suspect that this
trend is due to an increase in the number of invisible ﬁre-
walls, but this hypothesis requires further investigation.
Turning to ﬁrewall block size, the address space covered
by each ﬁrewall, we observe between 190k and 224k personal
ﬁrewalls across our surveys (not shown in our ﬁgures), with
no consistent trend over time. Personal ﬁrewalls greatly
outnumber block ﬁrewalls, 4:1. However, the block ﬁrewalls
cover more than 99% of ﬁrewalled address space.
Figure 11 shows the cumulative distribution of sizes of
ﬁrewall blocks, omitting personal ﬁrewalls. We assume that
the number of blocks corresponds to the number of block
ﬁrewalls, although it is conceivable that a single ﬁrewall may
handle multiple blocks. We see bumps at block sizes that
are powers of two, with a pronounced bump at /24, but
interestingly, also at /29 and /30 blocks. We also notice a
slight increase in the number of blocks over the course of
our study, mostly due to additional ﬁrewalls covering single
addresses.
From these observations we make several conjectures about
trends in ﬁrewall use. Since we see little increase in the
number of ﬁrewalled hosts across our censuses, we conjec-
ture that most newly deployed hosts are either visible, or
go behind silent ﬁrewalls that our methodology is unable to
account for. Given the relative stability in the number of
visible ﬁrewalls, we conjecture that existing ﬁrewalls main-
tain visibility and most new ﬁrewalls are conﬁgured to be
invisible. The latter may reﬂect the heightened sense of
security in new deployments, while the former the inertia
in changing existing conﬁgurations. Finally, this analysis
conﬁrms administrative structure in the Internet at sub-/24
block sizes, a structure hidden from previous BGP-based
analysis [31].
6.3 Validation
To evaluate these observations we review data from our in-
stitution, ICMP-nmapsurvey
USC . First, we extracted the 35 ﬁre-
walled blocks we detected in our university’s network. We
then conﬁrmed these detections with our network admin-
istrators, using their knowledge of the network as ground
truth. They validated that each range we detected cor-
responded to a router-level access control list, and there-
fore represents a true positive. They did not ﬁnd any non-
ﬁrewalls in our list, verifying that we have no false posi-
tives. In addition, they informally examined the block sizes
that we discovered, suggesting that we accurately estimated
the size of 24, and were oﬀ by a few addresses of six small
blocks (sizes 4 to 27). For overall coverage, of the 2,674 ﬁre-
walled addresses we discovered, operations conﬁrmed 2,639
addresses as ﬁrewalled, and we were incorrect for 35 ad-
dresses. These small diﬀerences may be due to conﬁguration
changes between observation and examination.
There are two possible classes of false negatives with our
methodology. First, invisible ﬁrewalls: we expect that the
7,720 passive-only addresses in Table 3 represent invisible
ﬁrewalled space. Our algorithm correctly classiﬁes these as
indeterminate, but this represents a limitation of our deﬁ-
nition. Second, there may be visible ﬁrewalls that we fail
to detect. Because there is no central list of ﬁrewalls at our
institution, we cannot conﬁrm we completely detected all
visible ﬁrewalls, but frequent probing makes omission due
to loss unlikely. While this validation is based on a single
enterprise, these results seem quite promising.
7. RELATED WORK
To our knowledge there has been no attempt to take a
full Internet census since 1982 [41]. Smallberg’s census in
1982 was aided by an independent, central enumeration of
all hosts; our approach instead enumerates all possible IP
addresses.
We are aware of only one other active survey of addresses.
Robin Whittle surveyed the Internet address space, ran-
domly pinging about 0.1% of the routed space over 24 hours
in March 2007 [49]. Projecting from the positive replies, he
estimated about 107M responsive addresses, within a few
percent of our census report of 103M in IT 15w four months
earlier. His results corroborate ours with a methodology like
our surveys.
He et al. use random sampling of addresses to study web
content [16]. They study the open web while we study ad-
dress usage in the visible Internet. Our study of method-
ology may aid understanding the accuracy of this type of
survey.
An alternative way to enumerate the Internet is to tra-
verse the domain name system. ISC has been taking cen-
suses of the reverse address space since 1994 [24]; Lottor
summarizes early work [30]. They contact name servers to
determine reverse-name mappings for addresses, rather than
contacting hosts themselves. Unlike our approach, they are
not aﬀected directly by ﬁrewalls, but they can overcount
because names may exist for addresses not in use, and un-
dercount, because addresses may lack reverse name map-
pings, or reverse mappings not made public (perhaps for
ﬁrewalled hosts). Because their methodology is so diﬀerent
from ours, the approaches are complementary and we are
planning to comparing results. As one example, their Jan-
uary 2007 survey found 433M reverse names, compared to
the 187M responsive addresses we found in the nearly con-
temporary IT 15w . Our active probing of edge addresses also
allows new kinds of analysis, such as our study of ﬁrewall
usage.
Closest to our methodology of active probing are several
projects that measure Internet connectivity, including Rock-
etfuel [45], Mercator [13], Skitter [19], and Dimes [40]. The
primary goal of these projects is to estimate the macro-
scopic, router-level connectivity of the Internet, a valuable
but complementary goal to ours. These projects therefore
do not exhaustively probe edge-hosts in IP address space,
but instead use tools such as traceroute to edge addresses to
collect data about routers that make up the middle of the
Internet.
Several other eﬀorts use diﬀerent approaches to also study
properties of the IP address space. First, Meng et al. use
BGP routing tables to study IPv4 address allocation at the
block level [31]. Like ours, this work is a longitudinal study
of address space allocation, they consider seven years of
data. However, their approach considers only block-level in-
formation gathered from IANA and injected into the global
routing tables, not a host-level study, and they consider only
new blocks, not the entire IPv4 address space. Our edge
study also reveals sub-/24 structure invisible to BGP.
As another example, Kohler et al. [26] studied the struc-
ture of IP destination addresses seen through passive ob-
servations on Internet links. Their measurements were con-
ducted at a few locations that included access links to uni-
versities, ISP routers with local peerings, and a major ISP’s
backbone routers. Their data collection considered several
links, each measured for several hours, observing between
70,000 and 160,000 addresses. They discover multifractal
properties of the address structure and propose a model that
captured many properties in the observed traﬃc. By con-
trast, our census unearthed upwards of 50 million distinct
IP addresses through active probing of addresses and so fo-
cuses more on the static properties of address usage rather
than their dynamic, traﬃc dependent properties.
Finally, Narayan et al. propose a model of IP routing ta-
bles based on allocation and routing practices [33] , and
Huston [20] and Gao et al. [5] (among others) have mea-
sured the time evolution of BGP tables and address space.
This work focuses on BGP and routing, not the the temporal
aspects of address space usage that we consider.
Because compromised home private machines are the source
of a signiﬁcant amount of unsolicited e-mail, a number of
anti-spam organizations maintain lists of dynamically as-
signed addresses (examples include [44, 34]). This work com-
plements our study of the behavior of dynamic addresses,
but uses primarily static or manually entered data, or semi-
automated probing in response to spam.
Recent research has explored how to detect dynamic ad-
dress space usage by examining login rates to a major on-line
e-mail hosting service [50]. As with our work they charac-
terize IP address usage, however their methodology is based
on passive monitoring of a large web service. Their work
complements ours in that they can reach strong conclusions
about the addresses that contact their service, and they can
peer behind NATs in ways we cannot, but they cannot evalu-
ate addresses that do not contact their service, limiting their
coverage to some subset of client computers in the Internet.
Much of the previous work on ﬁrewall detection has fo-
cused on discovering stealth ﬁrewalls. Early work was pub-
lished on the Phrack website [9], detecting ﬁrewalls that did
not verify checksums. Tools such as p0f [35] and nmap [38]
have options to detect a ﬁrewall either by passively moni-
toring ﬂows or actively sending specially crafted packets and
analyzing responses. These tools are more accurate than our
approach, but much more invasive; we believe our approach
is necessary to safely study the whole Internet.
8. FUTURE WORK AND CONCLUSIONS
There are several directions for future work,
including
reﬁning the methodology, exploring probe retransmissions,
exploring time/space trade-oﬀs, and improving our under-
standing of the visible Internet and characterization hosts
and addresses hidden to active probing.
This paper is the ﬁrst to show that censuses can walk the
entire IPv4 address space. We begin to quantify sources of
measurement error and show that surveys of fractions of the
address space complement full censuses. Our preliminary
application of this methodology shows trends and estimates
of address space utilization and deployment of visible ﬁre-
walls. However, we expect our methodology and datasets
to broaden the ﬁeld of Internet measurements from routers
and traﬃc to the network edge.
Acknowledgments: This work is partially supported by the
U.S. Dept. of Homeland Security contracts NBCHC040137 and
NBCHC080035 (LANDER and LANDER-2007), and by National
Science Foundation grants CNS-0626696 (MADCAT) and CNS-
0823774 (MR-Net). Conclusions of this work are those of the
authors and do not necessarily reﬂect the views of DHS or NSF.
We thank the many colleagues who assisted in this research:
T. Lehman and F. Houston (ISI), hosted probers; J. Pepin (Clem-
son), M. Dougherty, W. Prue, and S. George (USC), collection
infrastructure; M. Baklarz and L. Sheppard (USC), ﬁrewall data
collection; C. Smiley and D. Jongbloed (ISI), trace complaint as-
sistance; J. Mirkovic (ISI), R. Whittle (First Principles), R. Guerin
(U. Penn., paper shepherd), paper suggestions.
9. REFERENCES
[1] M. Allman, W. M. Eddy, and S. Ostermann. Estimating loss
rates with TCP. ACM Performance Evaluation Review,
31(3):12–24, Dec. 2003.
[2] G. Bartlett, J. Heidemann, and C. Papadopoulos.
Understanding passive and active service discovery. In Proc. of
the ACM Internet Measurement Conference. ACM, Oct. 2007.
[3] R. Beck. Passive-aggressive resistance: OS ﬁngerprint evasion.
The Linux Journal, Sept. 2001.
[4] R. Braden. Requirements for Internet hosts—communication
layers. RFC 1122, Internet Request For Comments, Oct. 1989.
[5] T. Bu, L. Gao, and D. Towsley. On characterizing BGP routing
[27] C. Labovitz, A. Ahuja, A. Abose, and F. Jahanian. Delayed
Internet routing convergence. In Proc. of the ACM SIGCOMM
Conference, pages 175–187, Stockholm, Sweeden, Aug. 2000.
ACM.
[28] W. Leland, M. Taqqu, W. Willinger, and D. Wilson. On the
self-similar nature of Ethernet traﬃc (extended version).
ACM/IEEE Transactions on Networking, 2(1):1–15, Feb.
1994.
[29] L. Li, D. Alderson, W. Willinger, and J. Doyle. A
ﬁrst-principles approach to understanding the Internet’s
router-level topology. In Proc. of the ACM SIGCOMM
Conference, pages 3–14, Portland, Oregon, USA, Aug. 2004.
[30] M. Lottor. Internet growth (1981-1991). RFC 1296, Internet
table growth. Proc. of the IEEE Global Internet, Nov. 2002.
Request For Comments, Jan. 1992.
[6] S. Deering and R. Hinden. Internet protocol, IP version 6
[31] X. Meng, Z. Xu, B. Zhang, G. Huston, S. Lu, and L. Zhang.
speciﬁcation. RFC 2460, Internet Request For Comments, Dec.
1998.
[7] X. Dimitropoulos, D. Krioukov, M. Fomenkov, B. Huﬀaker,
Y. Hyun, kc claﬀy, and G. Riley. AS relationships: Inference
and validation. ACM Computer Communication Review,
37(1):29–40, Jan. 2007.
[8] N. Duﬃeld and M. Grossglauser. Trajectory sampling for direct
traﬃc observation. In Proc. of the ACM SIGCOMM
Conference, pages 179–191, Stockholm, Sweeden, Aug. 2000.
ACM.
[9] Ed3f. Firewall spotting and networks analysis with a broken
CRC. http://www.phrack.org/archives/60/p60-0x0c.txt, Dec.
2002.
[10] M. Faloutsos, P. Faloutsos, and C. Faloutsos. On power-law
relationships of the internet topology. In Proc. of the ACM
SIGCOMM Conference, pages 251–262, Cambridge, MA, USA,
Sept. 1999. ACM.
[11] V. Fuller, T. Li, J. Yu, and K. Varadhan. Classless
inter-domain routing (CIDR): an address assignment and
aggregation strategy. RFC 1519, Internet Request For
Comments, Sept. 1993.
[12] L. Gao. On inferring automonous system relationships in the
internet. ACM/IEEE Transactions on Networking,
9(6):733–745, Dec. 2001.
[13] R. Govindan and H. Tangmunarunkit. Heuristics for Internet
Map Discovery. In Proc. of the IEEE Infocom, Tel-Aviv,
Israel, Mar. 2000.
[14] K. P. Gummadi, R. J. Dunn, S. Saroiu, S. D. Gribble, H. M.
Levy, and J. Zahorjan. Measurement, modelling, and analysis
of a peer-to-peer ﬁle-sharing workload. In Proc. of the 19th
Symposium on Operating Systems Principles, pages 314–329,
Bolton Landing, NY, USA, Oct. 2003. ACM.
[15] T. Hain. A pragmatic report on IPv4 address space
consumption. The Internet Protocol Journal, 8(3), 2004.
[16] B. He, M. Patel, Z. Zhang, and K. C.-C. Chang. Accessing the
deep web. Communications of the ACM, 50(5):94–101, May
2007.
[17] A. S. Hedayat and B. K. Sinha. Design and Inference in
Finite Population Sampling. John Wiley & Sons, Inc., 1991.
[18] J. Heidemann, Y. Pradkin, R. Govindan, C. Papadopoulos,
G. Bartlett, and J. Bannister. Census and survey of the visible
internet (extended). Technical Report ISI-TR-2008-649b,
USC/Information Sciences Institute, Feb. 2008. (Updated
August 2008.).
[19] B. Huﬀaker, D. Plummer, D. Moore, and K. C. Claﬀy.
Topology Discovery by Active Probing. In Proc. of the
Symposium on Applications and the Internet, Jan. 2002.
[20] G. Huston. Analyzing the Internet’s BGP routing table.
Internet Protocol Journal, 4(1), Mar. 2001.
[21] G. Huston. IPv4 address report. http://bgp.potaroo.net/ipv4/,
June 2006.
[22] IANA. Internet protocol v4 address space. web page
http://www.iana.org/assignments/ipv4-address-space, Sept.
2002.
[23] IANA. ICMP type numbers. web page
http://www.iana.org/assignments/icmp-parameters, Mar. 2007.
[24] Internet Software Consortium. Internet domain survey. web
page http://www.isc.org/ds.
[25] M. Khadilkar, N. Feamster, M. Sanders, and R. Clark.
Usage-based DHCP lease time optimization. In Proc. of the 7th
ACM Internet Measurement Conference, pages 71–76, Oct.
2007.
[26] E. Kohler, J. Li, V. Paxson, and S. Shenker. Observed
structure of addresses in IP traﬃc. In Proc. of the 2nd ACM
Internet Measurement Workshop, pages 253–266, Nov. 2002.
IPv4 address allocation and the BGP routing table evolution.
ACM Computer Communication Review, 35(1):71–80, Jan.
2005.
[32] W. M¨uhlbauer, O. Maennel, S. Uhlig, A. Feldmann, and
M. Roughan. Building an AS-topology model that captures
route diversity. In Proc. of the ACM SIGCOMM Conference,
pages 195–204, Pisa, Italy, Sept. 2006.
[33] H. Narayan, R. Govindan, and G. Varghese. On the impact of
routing and address allocation on the structure and
implementation of routing tables. In Proc. of the ACM
SIGCOMM Conference, Aug. 2003.
[34] NJABL. Not just another bogus list. http://www.njabl.org/,
2007.
[35] p0f Project. p0f passive OS ﬁngerprinting.
http://lcamtuf.coredump.cx/p0f.shtml, Sept. 2006.
[36] V. Paxson. End-to-end Internet packet dynamics. ACM/IEEE
Transactions on Networking, 7(3):277–292, June 1999.
[37] V. Paxson and S. Floyd. Why we don’t know how to simulate
the Internet. In Proc. of the 29th SCS Winter Simulation
Conference, pages 1037–1044, Atlanta, Georga, USA, Dec.
1997.
[38] N. Project. Nmap network security scanner.
http://www.insecure.org/nmap/, 1997.
[39] Y. Rekhter, B. Moskowitz, D. Karrenberg, G. J. de Groot, and
E. Lear. Address allocation for private internets. RFC 1918,
IETF, Feb. 1996.
[40] Y. Shavitt and E. Shir. Dimes: let the Internet measure itself.
SIGCOMM Comput. Commun. Rev., 35(5):71–74, 2005.
[41] D. Smallberg. Who talks TCP? RFC 832, Internet Request For
Comments, Dec. 1982.
[42] M. Smart, G. R. Malan, and F. Jahanian. Defeating TCP/IP
stack ﬁngerprinting. In Proc. of the USENIX Security
Symposium, pages 229–240, Denver, Colorado, USA, Aug.
2000. USENIX.
[43] F. D. Smith, F. Hernandez, K. Jeﬀay, and D. Ott. What
TCP/IP protocol headers can tell us about the web. In Proc. of
the ACM SIGMETRICS, pages 245–256, Cambridge, MA,
USA, June 2001. ACM.
[44] SORBS. Sorbs dynamic user and host list.
http://www.au.sorbs.net/faq/dul.shtml, 2004.
[45] N. Spring, R. Mahajan, D. Wetherall, and T. Anderson.
Measuring ISP topologies with Rocketfuel. ACM/IEEE
Transactions on Networking, 12(1):2–16, 2004.
[46] L. Subramanian, S. Agarwal, J. Rexford, and R. H. Katz.
Characterizing the Internet hierarchy from multiple vantage
points. In Proc. of the IEEE Infocom, pages 618–627, New
York, NY, USA, June 2002. IEEE.
[47] H. Tangmunarunkit, R. Govindan, S. Jamin, and S. S. W.
Willinger. Network Topology Generators: Degree-Based vs.
Structural. In Proceedings of ACM SIGCOMM, pages
188–195, Pittsburgh, PA, 2002.
[48] P. F. Tsuchiya and T. Eng. Extending the IP Internet through
address reuse. ACM Computer Communication Review,
23(1):16–33, Jan. 1993.
[49] R. Whittle. Probing the density of ping-responsive-hosts in
each /8 IPv4 preﬁx and in diﬀerent sizes of BGP advertised
preﬁx. Web page
http://www.firstpr.com.au/ip/host-density-per-prefix/, Nov.
2007.
[50] Y. Xie, F. Yu, K. Achan, E. Gillum, M. Goldszmidt, and
T. Wobber. How dynamic are IP addresses? In Proc. of the
ACM SIGCOMM Conference, Kyoto, Japan, Aug. 2007. ACM.