图: 基于零信任的安全防护架构
零 信 任 实 战 白 皮 书
行 业 客 户 案 例
零信任产业标准工作组
采用零信任架构后，在家办公员工可以直接访问应用系统，通过IAM系统提供的双因素认证，所有终端需
要部署安全Agent，负责采集办公设备的安全状态，只有通过安全基线要求的安全终端设备，才可以允许访问
系统。这两个安全措施，确保了用户可信和设备可信。此外，在家办公和在办公室办公，应用系统的访问体验
完全一致。认证通过后，根据员工的角色，应用提供了应用列表，只需点击应用的图标，可以单点登陆到对应
的应用，减少了再次输入账号口令的时间，改善了用户体验。
7.7.3 效果
集团存在多个办公区职场，通过多条专线连接到集团数据中心IDC，构成了一个大的企业内网。IDC机房有
丰富的带宽资源、BGP网络接入，原有专线造价昂贵，并且没有做好网络规划，多个分支职场呈现网状管理。
因业务发展和远程办公需要，希望将网络架构从纯内网访问安全架构，变成全部对外的外网入口管理体系。
7.8.1 需求
集团职场办公网络中有职场服务器区，业务比较少，属于历史业务，集团职场员工使用专线访问IDC区的
业务系统。集团职场环境下平时使用 
IDC中的业务较多，为了精简网络整个管理，集团职场也优先走IDC的互
联网入口，减少专线的使用，现有专线当作备用的传输线路，可以有效减少专线使用费用。其他职场区域则直
接去掉专线，通过互联网连接零信任网关访问IDC。
7.8.2方案
4）策略引擎基于实时数据，经过信任和风险评估中，生成控制策略，发送给策略管理器，由策略管理器
进行策略分解、编排并派发给安全访问代理、Web防护、威胁监测、数据防泄漏等策略执行点，实现对应用的
安全防护；
5）策略管理器、策略引擎、安全探针类设备、安全管理应用位于控制面，安全访问代理、Web安全防
护、业务应用、数据服务等位于数据面，通过将它们部署在不同VPC或区域内实现隔离。为保证安全性，安全
访问平台可以部署在独立的区域内，实现与数据中心的物理隔离。
零 信 任 实 战 白 皮 书
行 业 客 户 案 例
零信任产业标准工作组
实施零信任网络架构后，保持了集团职场、分支职场统一的IDC企业内部资源访问入口，并有效减少了原
有的专线使用率，降低了成本。
7.8.3 效果
零 信 任 实 战 白 皮 书
行 业 客 户 案 例
零信任产业标准工作组
公安实战平台是一个以服务公安实战为宗旨，开发出多渠道汇总、多角度接触、多领域应用、多层面管理
的平台。随着业务系统越来越多，虽然系统部署在内网环境，但仍然面临较多安全访问风险：
1）大量终端接入导致业务系统响应不及时，通过第三方的平台或者系统进行传输，不同厂家的数据传输
安全方案和安全等级各异，导致数据泄露风险点加大；
2）内部业务系统越来越多，人员访问造成的泄密风险增加；
3）访问设备安全性，因为设备也会暴露一些高危的漏洞，因此很可能也危及实战平台等业务系统。
为了提高访问通道加密级别，满足国密加密访问要求。通过搭建一套零信任安全防护解决方案，建设一条
内网业务系统的国密访问通道，保障公安体系数字化工作空间。
7.9.1 需求
方案集成了专用安全浏览器、零信任安全网关、零信任管控平台，从云、管、端形成三维一体的零信任安
全体系，通过专用安全浏览器提供统一身份认证、终端信息采集、单点登录和链路加密为实战平台提供应用安
全访问入口和可信身份验证；零信任管控平台通过身份、状态、行为、内容、安全风险分析进行访问的信任评
估；零信任安全网关以身份的零信任策略、访问的零信任策略、内容的零信任策略，为实战平台提供动态访问
控制和应用访问代理，以此保障应用访问安全性；通过远程投屏，数字水印，文档不落地等手段 为实战平台数
据资产全生命周期保驾护航，如图所示：
7.9.2 方案
7.9 某公安实战平台案例（任子行）
零 信 任 实 战 白 皮 书
行 业 客 户 案 例
零信任产业标准工作组
BeyondCorp项目是谷歌根据零信任理念的具体实现是目前公知的最佳实践之一。谷歌真正决定开始
BeyondCorp项目的原因很难确定，但从其发布的一系列论文和公开分享中可以看出，BeyondCorp项目目标很
明确，让每位谷歌员工都可以在不使用VPN的情况下通过不可信的网络顺利开展工作。这意味着在这家超大
型、很早使用云计算技术的全球性互联网公司中，需要摈弃对现有企业特权网络(企业内网)的依赖，并开创一
种全新的安全访问模式。可以看出，BeyondCorp解决的是用户对内部资源访问场景下的访问安全。
BeyondCorp的落地依赖谷歌特有的一些安全技术和系统（如内网统一的 RPC 协议安全栈，扩展了GFE谷
歌HTTP/HTTPS反向代理组件作为策略执行点，并复用其负载均衡等），可能无法直接照搬使用。但Beyond-
Corp背后的核心技术和理念值得业界参考。其核心思想仍是零信任的不信任任何对象，访问决策依赖于设备和
访问凭证等身份安全和信任评分因素，而不再仅仅关心网络位置。并使得用户可以从任何位置（企业内部、家
里、咖啡厅等）发起访问，除网络延迟以外，对资源的本地和远程访问体验基本一致。
BeyondCorp 的关键组件包括：
7.10.1 需求
7.10.2 方案
7.10 BeyCorp案例（谷歌）
图-BeyondCorp组件和访问流
1）设备目录数据库：包括设备清单数据库、用户群组数据库、设备和用户身份标识等；
2）信任推断：对访问环境（设备、用户行为、系统、应用等）的信任分析和度量；
3）访问控制引擎：持续监视并分析访问环境状态，并依据访问策略和信任等级，授权用户的资源访问操
作；
零 信 任 实 战 白 皮 书
行 业 客 户 案 例
零信任产业标准工作组
4）访问代理：实现访问策略的执行和访问流量加密，还会与谷歌的身份认证服务联动；
BeyondCorp的架构实践特点如下：
1）企业应用程序和服务不再对公网可见
整个BeyondCorp对外暴露的组件只有访问代理,单点登录(SSO)系统和在RADIUS组件,以及间接暴露的访问
控制引擎组件。其中访问代理和访问控制引擎组件共同组成谷歌前端访问代理(GFE),  集中对访问请求进行认证
和授权。BeyondCorp系统通过DNS CNAME方式, 将访问代理组件暴露在公网中,所有对企业应用或服务的的域
名访问,都指向了访问代理,由访问代理集中进行认证、授权和对访问请求的转发。
2）企业内网的边界消失
发起连接的设备所在网络位置和IP地址不再是认证授权的必要因素。无论设备是在谷歌大楼内,还是在家里
或者在机场，所有对企业应用或服务的访问请求,都必须经过一个逻辑集中访问代理组件的认证和授权。
3）基于身份、设备和信任评估的细粒度访问控制
只有公司的设备清单数据库组件中的受控设备(公司购买并管控),  并且用户必须在用户/群组数据库组件中
存在,才能通过认证;然后经过信任推断组件的信任计算和评估后,才会获得相应的授权。
4）仅对特定应用，而非底层网络授予访问权限
最终是用户和设备获得仅针对特定应用的访问授权。
5）提供网络通信的端到端加密
用户设备到访问代理之间经过TLS加密, 访问代理和后端企业应用之间使用谷歌内部开发的认证和加密框架 
LOAS(Low Overhead Authentication System)双向认证和加密。
BeyondCorp的实现概述：
1）验证用户
验证用户最基本的是用户名和密码，并通过多因素认证来获得额外的保证（国内一般是短信验证码或软硬
件token，当然也包括人脸、指纹等）。用户有很多类型：普通用户、管理员、外包、合作伙伴、客户等，多
因素认证都可以适用。
2）验证设备
要实现零信任原则，要把访问控制的决策扩展到设备级。如果设备未经过验证，设备就不可信。如果用户
使用常用的、可信设备访问，则可信度较高；如果在网吧用一台电脑来登陆，信任度就较低。设备验证还包括
了一些安全准入条件，比如是否安装杀毒软件和最新补丁。
3）限制访问权限和特权
根据最小权限原则赋予用户访问权限，最大程度限制恶意攻击的横向移动。在网络授权基础上，扩展到对
业务应用级的授权，业务层包含大量敏感数据，是攻击的首要目标，因此在应用侧限制权限非常重要。数据越
重要，权限越难获得，访问重要数据时也可以用多因素来进一步加强用户身份验证。
零 信 任 实 战 白 皮 书
行 业 客 户 案 例
零信任产业标准工作组
4）自学习和自适应
收集用户、设备、应用和服务器数据和访问行为等信息，形成日志数据库进行机器学习分析，达到异常识
别的目的，比如从异常位置访问资源，则立即触发强身份认证。
谷歌历时6年多，完成在企业网络的零信任改造，如今绝大部分谷歌员工的日常办公已能通过零信任网络
开展，提供基于用户和设备的身份认证与授权服务。
7.10.3 效果
零 信 任 实 战 白 皮 书
行 业 客 户 案 例
零信任产业标准工作组
08
零信任探索和展望
零信任产业标准工作组