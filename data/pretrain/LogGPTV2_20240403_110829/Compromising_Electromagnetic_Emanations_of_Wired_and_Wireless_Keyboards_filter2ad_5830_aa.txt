title:Compromising Electromagnetic Emanations of Wired and Wireless Keyboards
author:Martin Vuagnoux and
Sylvain Pasini
Compromising Electromagnetic Emanations
of Wired and Wireless Keyboards
Martin Vuagnoux
LASEC/EPFL
Sylvain Pasini
LASEC/EPFL
martin.vuagnoux@epﬂ.ch
sylvain.pasini@epﬂ.ch
Abstract
Computer keyboards are often used to transmit conﬁden-
tial data such as passwords. Since they contain elec-
tronic components, keyboards eventually emit electro-
magnetic waves. These emanations could reveal sensi-
tive information such as keystrokes. The technique gen-
erally used to detect compromising emanations is based
on a wide-band receiver, tuned on a speciﬁc frequency.
However, this method may not be optimal since a sig-
niﬁcant amount of information is lost during the signal
acquisition. Our approach is to acquire the raw signal
directly from the antenna and to process the entire cap-
tured electromagnetic spectrum. Thanks to this method,
we detected four different kinds of compromising elec-
tromagnetic emanations generated by wired and wireless
keyboards. These emissions lead to a full or a partial
recovery of the keystrokes. We implemented these side-
channel attacks and our best practical attack fully recov-
ered 95% of the keystrokes of a PS/2 keyboard at a dis-
tance up to 20 meters, even through walls. We tested
12 different keyboard models bought between 2001 and
2008 (PS/2, USB, wireless and laptop). They are all vul-
nerable to at least one of the four attacks. We conclude
that most of modern computer keyboards generate com-
promising emanations (mainly because of the manufac-
turer cost pressures in the design). Hence, they are not
safe to transmit conﬁdential information.
puters, to do e-banking money transfer, etc. A weakness
in these hardware devices will jeopardize the security of
any password-based authentication system.
Compromising electromagnetic emanation problems
appeared already at the end of the 19th century. Be-
cause of the extensive use of telephones, wire networks
became extremely dense. People could sometimes hear
other conversations on their phone line due to undesired
coupling between parallel wires. This unattended phe-
nomenon, called crosstalk, may be easily canceled by
twisting the cables.
A description of some early exploitations of compro-
mising emanations has been recently declassiﬁed by the
National Security Agency [26]. During World War II,
the American Army used teletypewriter communications
encrypted with Bell 131-B2 mixing devices. In a Bell
laboratory, a researcher noticed, quite by accident, that
each time the machine stepped, a spike appeared on an
oscilloscope in a distant part of the lab. To prove the vul-
nerability of the device, Bell engineers captured the com-
promising emanations emitted by a Bell 131-B2, placed
in a building across the street and about 25 meters away.
They were able to recover 75% of the plaintext.
During the Vietnam war, a sensor called Black Crow
carried aboard C-130 gunships was able to detect the
electromagnetic emanations produced by the ignition
system of trucks on the Ho Chi Minh trail, from a dis-
tance up to 10 miles [25, 11].
1 Introduction
1.1 Related Work
Today, most of the practical attacks on computers exploit
software vulnerabilities. New security weaknesses are
disclosed every day, but patches are commonly delivered
within a few days. When a vulnerability is based on hard-
ware, there is generally no software update to avoid the
exposure: the device must be changed.
Computer keyboards are often used to transmit sensi-
tive information such as passwords, e.g. to log into com-
Academic research on compromising electromagnetic
emanations started in the mid 1980’s and there has been
signiﬁcant recent progresses [28, 1]. The threat related
to compromising emanations has been constantly con-
ﬁrmed by practical attacks such as Cathode Ray Tubes
(CRT) displays image recovery [34], Liquid Crystal Dis-
play (LCD) image recovery [20], secret key disclo-
sure [16], video displays risks [18, 33] or radiations from
FPGAs [24].
Compromising electromagnetic emanations of serial-
port cables have been already discussed by Smul-
ders [30] in 1990. PS/2 keyboards still use bi-directional
serial communication to transmit the pressed key code to
the computer. Hence, some direct compromising electro-
magnetic emanations might appear. However, the char-
acteristics of the serial line changed since the 90’s. The
voltage is not 15 volts anymore and the transition times
of the signals are much longer (from picoseconds to mi-
croseconds).
Since keyboards are often the ﬁrst input device of a
computer system, they have been intensively studied.
For instance, the exploitation of visual compromising
information leaks such as optical reﬂections [5] which
could be applied to keyboards, the analysis of surveil-
lance video sequences [6] which can be used by an at-
tacker to recover the keystrokes (even with a simple we-
bcam) or the use of the blinking LEDs of the keyboard
as a covert channel [21]. Acoustic compromising emana-
tions from keyboards have been studied as well. Asonov
and Agrawal [4] discovered that each keystroke produces
a unique sound when it is pressed or released and they
presented a method to recover typed keystrokes with a
microphone. This attack was later improved, see [38, 7].
Even passive timing analysis may be used to recover
keystrokes. Song et al. highlighted that the keystroke
timing data measured in older SSH implementations [32]
may be used to recover encrypted passwords. A risk of
compromising emission from keyboards has been postu-
lated by Kuhn and Anderson [20, 17, 2]. They also pro-
posed countermeasures (see US patent [3]). Some unof-
ﬁcial documents on TEMPEST [37] often designate key-
boards as potential information leaking devices. How-
ever, we did not ﬁnd any experiment or evidence proving
or refuting the practical feasibility to remotely eavesdrop
keystrokes, especially on modern keyboards.
1.2 Our Contribution
This paper makes the following main contributions:
A Full Spectrum Acquisition Method. To detect com-
promising electromagnetic emanations a receiver tuned
on a speciﬁc frequency is generally used. It brings the
signal in base band with a limited bandwidth. Therefore,
the signal can be demodulated in amplitude (AM) or fre-
quency (FM). This method might not be optimal. Indeed,
the signal does not contain the maximal entropy since a
signiﬁcant amount of information is lost. We propose
another approach. We acquire the raw signal directly
from the antenna and analyze the entire captured electro-
magnetic spectrum with Short Time Fourier Transform
(also known as Waterfall) to distill potential compromis-
ing emanations.
The Study of Four Different Sources of Informa-
tion Leakage from Keyboards. To determine if key-
boards generate compromising emanations, we mea-
sured the electromagnetic radiations emitted when a key
is pressed. Due to our improved acquisition method,
we discovered several direct and indirect compromising
emanations which leak information on the keystrokes.
The ﬁrst technique looks at the emanations of the falling
edges (i.e. the transition from a high logic state to a low
logic state) from the bi-directional serial cable used in the
PS/2 protocol. It can be used to reveal keystrokes with
about 1 bit of uncertainty. The second approach uses the
same source, but consider the rising and the falling edges
of the signal to recover the keystrokes with 0 bits of un-
certainty. The third approach is focused on the harmonics
emitted by the keyboard to recover the keystrokes with
0 bits of uncertainty. The last approach considers the
emanations emitted from the matrix scan routine (used
by PS/2, USB and Wireless keyboards) and yields about
2.5 bits of uncertainty per keystroke. This compromis-
ing emanation has been previously posited by Kuhn and
Anderson [3], although that work provided no detailed
analysis.
The Implementation and the Analysis of Four
Keystroke Recovery Techniques in Four Different
Scenarios. We tested 12 different keyboard models, with
PS/2, USB connectors and wireless communication in
different setups: a semi-anechoic chamber, a small of-
ﬁce, an adjacent ofﬁce and a ﬂat in a building. We
demonstrate that these keyboards are all vulnerable to at
least one of the four keystroke recovery techniques in all
scenarios. The best attack successfully recovers 95% of
the keystrokes at a distance up to 20 meters, even through
walls. Because each keyboard has a speciﬁc ﬁngerprint
based on the clock frequency inconsistencies, we can de-
termine the source keyboard of a compromising emana-
tion, even if multiple keyboards from the same model are
used at the same time. First, we did the measurements
in a semi-anechoic electromagnetic chamber to isolate
the device from external noise. Then we conﬁrmed that
these compromising emanations are exploitable in real
situations.
We conclude that most of modern computer keyboards
generate compromising emanations (mainly because of
the manufacturer cost pressures in the design). Hence
they are not safe to transmit conﬁdential information.
1.3 Structure of the Paper
Section 2 describes some basics on compromising elec-
tromagnetic emanations.
In Section 3 we present our
acquisition method based on Short Time Fourier Trans-
form. In Section 4 we present four different setups used
for the measurements, from a semi-anechoic chamber to
2
real environments. In Section 5 we give the complete
procedure used to detect the compromising electromag-
netic emanations. Then, we detail the four different tech-
niques. In Section 6, we give the results of our measure-
ments in different setups. In Section 7, we describe some
countermeasures to avoid these attacks.
In Section 8,
we give some extensions and improvements. Finally we
conclude.
2 Electromagnetic Emanations
Electromagnetic compatibility (EMC) is the analysis of
electromagnetic interferences (EMI) or Radio Frequency
Interferences (RFI) related to electric devices. EMC
aims at reducing unintentional generation, propagation
and reception of electromagnetic energy in electric sys-
tems. EMC deﬁnes two kinds of unwanted emissions:
conductive coupling and radiative coupling. Conductive
coupling requires physical support such as electric wires
to transmit interferences through the system. Radiative
coupling occurs when a part of the internal circuit acts
as an antenna and transmits undesired electromagnetic
waves. EMC generally distinguishes two types of elec-
tromagnetic emissions depending on the kind of the ra-
diation source: differential-mode and common-mode.
Differential-mode radiation is generated by loops
formed by components, printed circuit traces, ribbon ca-
bles, etc. These loops act as small circular antennas and
eventually radiate. These radiations are generally low
and do not disturb the whole system. Differential-mode
signals are not easily inﬂuenced by external radiations.
Moreover they can be easily avoided by shielding the
system.
Common-mode radiation is the result of undesired in-
ternal voltage drops in the circuit which usually appear
in the ground loop. Indeed, ground loop currents are due
to the unbalanced nature of ordinary transmitting and re-
ceiving circuits. Thus, external cables included in the
ground loop act as antennas excited by some internal
voltages. Because these voltage drops are not intention-
ally created by the system, it is generally harder to detect
and control common-mode radiations than differential-
mode radiations.
From the attacker’s point of view there are two types
of compromising emanations: direct and indirect emana-
tions.
Direct Emanations. In digital devices, data is encoded
with logic states, generally described by short burst of
square waves with sharp rising and falling edges. During
the transition time between two states, electromagnetic
waves are eventually emitted at a maximum frequency
related to the duration of the rise/fall time. Because
these compromising radiations are provided straight by
the wire transmitting sensitive data, they are called direct
emanations.
Indirect Emanations. Electromagnetic emanations may
interact with active electronic components which induce
new types of radiations. These unintended emanations
manifest themselves as modulations or inter-modulations
(phase, amplitude or frequency) or as carrier signals
e.g. clock and its harmonics. Non-linear coupling be-
tween carrier signals and sensitive data signals, crosstalk,
ground pollution or power supply DC pollution may gen-
erate compromising modulated signals. These indirect
emanations may have better propagation than direct em-
anations. Hence, they may be captured at a larger range.
The prediction of these emanations is extremely difﬁ-
cult. They are generally discovered during compliance
tests such as FCC [15], CISPR [10], MIL-STD-461 [22],
NACSIM-5000 [37], etc.
3 Electromagnetic Signal Acquisition
Two techniques are generally used to discover compro-
mising electromagnetic emanations.
3.1 Standard Techniques
A method consists in using a spectral analyzer to detect
signal carriers. Such a signal can be caught only if the
duration of the carrier is signiﬁcant. This makes compro-
mising emanations composed of peaks difﬁcult to detect
with spectral analyzers.
Another method is based on a wide-band receiver
tuned on a speciﬁc frequency. Signal detection process
consists in scanning the whole frequency range of the re-
ceiver and to demodulate the signal according to its am-
plitude modulation (AM) or frequency modulation (FM).
When an interesting frequency is discovered, narrow-
band antennas and some ﬁlters are used to improve the
Signal-to-Noise Ratio (SNR) of the compromising em-
anations.
In practice, wide-band receivers such as R-
1250 [19] and R-1550 [12] from Dynamic Sciences In-
ternational, Inc. are used, see [17, 1].
Indeed, these
receivers are compliant with secret requirements for the
NACSIM-5000 [37] also known as TEMPEST. These de-
vices are quite expensive and unfortunately not owned
by our lab. Hence, we used a cheaper and open-source
solution based on the USRP (Universal Software Radio
Peripheral) [14] and the GNU Radio project [35]. The
USRP is a device which allows you to create a software
radio using any computer with USB port. With differ-
ent daughterboards, the USRP is able to scan from DC
to 2.9 GHz with a sample rate of 64 MS/s at a resolution
of 12 bits. The full range on the ADC is 2 volts peak
to peak and the input is 50 ohms differential. The GNU
3
Radio project is a powerful software library used by the
USRP to process various modulations (AM, FM, PSK,
FSK, etc.) and signal processing constructs (optimized
ﬁlters, FFT, etc.). Thus, the USRP and the GNU Radio
project may act as a wide-band receiver and a spectral
analyzer with software-based FFT computation.
any demodulation. Moreover, all compromising electro-
magnetic emanations up to a frequency of 2.5 GHz are
captured. Thus, with this technique, we are able to high-
light compromising emanations quickly and easily. This
solution is ideal for very short data burst transmissions
used by computer keyboards.
3.2 Novel Techniques
4 Experimental Setup
Some direct and indirect electromagnetic emanations
may stay undetected with standard techniques, especially
if the signal is composed of irregular peaks or erratic
frequency carriers. Indeed, spectral analyzers need sig-
niﬁcantly static carrier signals. Similarly, the scanning
process of wide-band receivers is not instantaneous and
needs a lot of time to cover the whole frequency range.
Moreover the demodulation process may hide some in-
teresting compromising emanations.
In this paper, we use a different method to de-
tect compromising electromagnetic emanations of key-
boards. First, we obtain the raw signal directly from the
antenna instead of a ﬁltered and demodulated signal with
limited bandwidth. Then, we compute the Short Time
Fourier Transform (STFT), which gives a 3D signal with
time, frequency and amplitude.
Modern analog-to-digital converters (ADC) provide
very high sampling rates (Giga samples per second). If
we connect an ADC directly to a wide-band antenna, we
can import the raw sampled signal to a computer and we
can use software radio libraries to instantly highlight po-
tentially compromising emanations. The STFT compu-
tation of the raw signal reveals the carriers and the peaks
even if they are present only for a short time.
Unfortunately there is no solution to transfer the high
amount of data to a computer in real time. The data
rate is too high for USB 2.0, IEEE 1394, Gigabit Eth-
ernet or Serial ATA (SATA) interfaces. However, with
some smart triggers, we can sample only the (small) in-
teresting part of the signal and we store it in a fast ac-
cess memory. Oscilloscopes provide triggered analog-
to-digital converters with fast memory. We used a Tek-
tronix TDS5104 with 1 Mpt memory and a sample rate
of 5 GS/s. It can acquire electromagnetic emanations up
to 2.5 GHz according to the Nyquist theorem. More-
over, this oscilloscope has antialiasing ﬁlters and sup-
ports IEEE 488 General Purpose Interface Bus (GPIB)
communications. We developed a tool to deﬁne some
speciﬁc triggers (essentially peak detectors) and to ex-
port the acquired data to a computer under GNU/Linux
over Ethernet. Thus the signal can be processed with the
GNU Radio software library and some powerful tools
such as Baudline [29] or the GNU project Octave [13].
The advantage of this method is to process the raw sig-
nal, which is directly sampled from the antenna without
The objective of this experiment is to observe the ex-
istence of compromising emanations of computer key-
boards when a key is pressed. Obviously electromagnetic
emanations depend on the environment. We deﬁned four
different setups.
Setup 1: The Semi-Anechoic Chamber. We used a pro-
fessional semi-anechoic chamber (7 × 7 meters). Our
aim was not to cancel signal echos but to avoid external
electromagnetic pollution (Faraday cage). The antenna
was placed up to 5 meters from the keyboard connected
to a computer (the maximum distance according to the
echo isolation of the room). The tested keyboard was on
a one meter high table and the computer (PC tower) was
on the ground.
Setup 2: The Ofﬁce. To give evidence of the feasibility
of the attacks with background noise, we measured the
compromising emanations of the keyboards in a small
ofﬁce (3 × 5 meters) with two powered computers and
three LCD displays. The electromagnetic background
noise was quite important with a cluster of 40 comput-
ers 10 meters away from the ofﬁce, more than 60 pow-
ered computers on the same ﬂoor and a 802.11n wireless
router at less than 3 meters away from the ofﬁce. The
antenna was in the ofﬁce and moved back through the
opened door up to 10 meters away from the keyboard in
order to determine the maximum range.
Setup 3: The Adjacent Ofﬁce. This setup is similar to
the ofﬁce setup but we measured the compromising ema-
nations of the keyboards from an adjacent ofﬁce through
a wall of 15 cm composed of wood and plaster.
Setup 4: The Building. This setup takes place in a ﬂat
which is in a building of ﬁve ﬂoors in the center of a
mid-size city. The keyboard was in the ﬁfth ﬂoor. We
performed measurements with the antenna placed on the
same ﬂoor ﬁrst. Then, we moved the antenna as far as
the basement (up to 20 meter from the keyboard).
Antennas. Since the compromising emanations were
found on frequency bands between 25 MHz and 300
MHz, we used a biconical antenna (50 Ohms VHA
9103 Dipol Balun) to improve the Signal-to-Noise Ratio
(SNR). We also tested if these compromising emanations
can be captured with a smaller antenna such as a simple
loop made of a wire of copper (one meter long).
4
Keyboards. We picked 12 different keyboard models
present in our lab: 7 PS/2 keyboards (Keyboard A1-
A7), 2 USB keyboards (Keyboard B1-B2), 2 Laptop key-