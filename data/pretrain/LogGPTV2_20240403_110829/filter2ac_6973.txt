titleblackhat:asia-22 ExplosION: The Hidden Mines in the Android ION Driver
The ION driver is an essential component introduced by Google into the Android kernel to facilitate allocations of device-accessible memory. It has been widely used by vendors for almost 10 years. In addition, almost all untrusted apps can access the ION driver, so any issue in ION could be exploited directly. However, only in recent years, a few ION-related vulnerabilities have been published. Due to this circumstance, it concerns us that there may be more hidden mines buried deeply in the ION.So far, we've found over 40 ION-related vulnerabilities, affecting millions of Android devices! We name the series of vulnerabilities ExplosION. Different from the vulnerabilities in other Android drivers, ExplosION is found to be a problem of the entire Android ecosystem due to the specialty of ION. First, ION as a base driver can be used to develop vendors' own drivers. Therefore, any flaw in ION could lead to vulnerabilities in vendors' drivers. Second, Google as upstream not only provides the design and implementation of ION's core APIs, but also provides interfaces for vendors to allow their customization to ION. Based on this, issues could be introduced in the customization part due to poorly documented APIs from Google, misuse of ION APIs by vendors, and so on. What's more, some vendors even customize ION's core APIs, resulting in known issues of ION not properly fixed due to code conflicts.In this talk, we will present ExplosION, as well as a thorough discussion of the root causes of the vulnerabilities stemming from the design and implementation of ION. To show the power of ExplosION, we will demonstrate how to achieve privilege escalation with ExplosION and then we will reflect on the vulnerabilities from the perspective of the entire Android ecosystem to explain why there are so many vulnerabilities in ION and how to avoid similar vulnerabilities in the future.