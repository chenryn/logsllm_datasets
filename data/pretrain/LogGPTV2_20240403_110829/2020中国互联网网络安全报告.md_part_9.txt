8 8
5
4 4
1
0
存储 传输 匿名化 完整性 归档 审计 物理防护 系统加固
保密性 保密性
图注： 符合 不符合
图2-35 2020年我国对医疗器械安全测评的结果（来源：CNCERT/CC）
在保密性方面，测试项包括存储保密性、传输保密性和患者隐私数据保护。共
有15款测评设备未加密医疗设备工作站中的健康数据，仅有部分厂商采用AES256等
算法对用户配置等信息进行加密。测评设备均采用节点认证或白名单机制，但其中
有11款没有使用加密的网络传输协议传输数据。测评设备均支持对可导出的健康数
据进行匿名化处理。
在完整性方面，主要从身份鉴别角度测试。所有设备均基于操作系统口令实现
用户身份鉴别，其中有15款设备提供了手动锁定、无操作自动注销的功能。
在可得性方面，测试项包括授权用户能否正常访问数据并进行健康数据归档。
所有设备均实现了授权用户数据的正常访问，共有11款提供了健康数据归档的功
能，但未对归档数据进行加密，也没有设计相应的防篡改机制。
62
02 网络安全专题分析
在安全审计方面，测试项主要包括抗抵赖性、可核查性和审计控制，共有10款
设备未采用足够的有效机制实现健康数据抗抵赖，且审计日志记录可以被修改。同
时，审计日志存在不够详尽、缺少关键信息等问题。
其他附加测试包括物理防护、系统加固。除5款设备外，其余厂商均通过设置物
理锁的方式保护工作站的数据安全。除1款设备外，其余设备均在一定程度上提供
了系统加固功能，如防火墙、端口关闭、快捷键封闭等。
2.4
SolarWinds 供应链攻击事件专题分析
2020年12月13日，美国著名信息系统管理和网络监控软件开发公司SolarWinds
的相关产品遭到供应链攻击事件被披露，引发全球关注。本次攻击事件被认为是近
年来美国遭受的最为严重的供应链攻击事件。
针对上述攻击事件，CNCERT/CC开展专题跟踪分析，北京启明星辰信息安全技
术有限公司和北京奇虎科技有限公司提供技术支持。
2.4.1 攻击事件概述
（1）事件背景
SolarWinds是美国著名信息系统管理和网络监控软件开发公司，创办于1999
年，总部位于美国德克萨斯州奥斯汀。公司旗下Orion平台是一个对网络设备提供
实时监测和分析的管理平台软件，客户包括政府、军事、教育等重要机构和国际知
名企业。2020年12月13日，美国安全厂商FireEye发布公告，称SolarWinds遭到APT
组织发动的供应链攻击，Orion平台软件的安装包被植入后门，软件使用客户均存
在被入侵风险。
本次攻击的主要过程为：攻击组织成功入侵SolarWinds公司用于软件开发、
打包、签名的服务器，在相关版本Orion产品的核心服务组件（SolarWinds.Orion.
Core.BusinessLayer.dll）中植入恶意后门。该组件拥有合法的数字签名证书，存在于
Orion的安装包和升级包内。同时，软件安装包被上传至官方更新服务器，通过在线
服务分发给所有的客户端进行升级。由于攻击组织成功控制了Orion的开发、打包及
编译环节，软件在源代码层面就已经受到污染，用户安装和升级相关版本的Orion平
63
2020年中国互联网网络安全报告
台软件都会被无差别地植入后门程序。本次攻击事件简要攻击流程如图2-36所示。
官方 核心服务组件安装包 后门组件
安装包
释放安装
释放安装
客户端在线升级 更新升级
图2-36 本次攻击事件简要攻击流程（来源：北京奇虎科技有限公司）
（2）攻击时间轴
据SolarWinds公司发布的消息，本次供应链攻击影响的Orion平台软件版本为
2019.4至2020.2.1，发布时间为2020年3月至6月。但通过对本次事件的主要后门组件
开展跟踪标注发现，攻击者最早的攻击行为可追溯至2019年9月。
本次攻击事件的时间轴可分为3个阶段。
第一阶段为测试后门的尝试植入。攻击者于2019年9月入侵SolarWinds内部网
络，并在Orion平台的原厂组件中植入了名为OrionImprovementBusinessLayer的测试
后门。该后门只针对用户的环境变量进行判断，目的用于攻击前期的测试工作。
第二阶段为完整后门的植入。2020年2月起，攻击者在Orion平台软件的安装包
和升级包中的核心组件（SolarWinds.Orion.Core.BusinessLayer.dll）中植入完整后
门。到2020年6月，攻击者在官方组件中清除相关后门代码。
第三阶段为渗透的持续与扩大。本次供应链攻击的受害者主要为美国政府机构
和知名企业，攻击者会对入侵主机的归属进行严格判断，并对当前主机环境进行安
全检测，满足多项触发条件后则会开展重要机密信息的窃取。同时，攻击者会进一
步横向移动攻击，入侵内网更多目标，扩大攻击范围。2020年12月13日，SolarWinds
供应链攻击事件正式被披露。12月14日，微软公司接管了本次供应链攻击事件中的
关键C2域名，标志着本次供应链攻击事件的结束。
本次供应链攻击事件详细的时间轴如图2-37所示。
64
02 网络安全专题分析
测试代码周期结束 Webshell恶意样本被安全研究人员上传至VT
2019年11月4日 2020年11月24日
攻击者注入测试代码
2019年9月12日 FireEye披露SolarWinds
植入后门组件 生产环境中移除后门组件 供应链事件
攻击者入侵SolarWinds 2020年2月20日 2020年6月4日 2020年12月13日
2019年9月4日 SolarWinds官方发布
安全公告
2020年12月14日
2019年 Sep Nov 2020 Mar May Jul Sep Nov 2021年 2021年
2020年12月14日
微软公司接管Sunburst C2域名
2020年2月
最早SSL证书注册 2020年12月28日
SolarWinds Orion RCE漏洞
CVE-2020-10148预警
2019年12月6日 2020年12月31日
DGA域名avsvmcloud.com注册 微软公司承认源代码
可能泄露
图2-37 本次供应链攻击事件详细的时间轴(来源：北京启明星辰信息安全技术有限公司)
2.4.2 Sunburst后门分析
本次SolarWinds供应链攻击事件的后门被各大厂商命名为Sunburst。Sunburst后
门在编写、部署和执行方面十分缜密。首先，Sunburst后门被植入Orion平台软件的
SolarWinds.Orion.Core.BusinessLayer.dll中，该组件拥有SolarWinds官方给予的合法
数字签名证书，如图2-38所示。其次，Sunburst后门的编写巧妙，命名规范、命名
语义和编写风格都刻意模仿Orion平台软件的正常代码。最后，Sunburst有严格的触
发机制、安全检测机制和通信机制。
SolarWinds W…
SolarWinds Worldwide, LLC
图2-38 SolarWinds供应链攻击事件后门组件文件合法签名证书（来源：北京奇虎科技有限公司）
65
2020年中国互联网网络安全报告
（1）后门触发机制
Sunburst后门的执行点为OrionImprovementBusinessLayer.Initialize，
通过InventoryManager类RefreshInternal方法进行调用。通过对比分析，
OrionImprovementBusinessLayer类在Orion平台软件的正常版本中不存在，因此判断该类
为攻击者植入。图2-39是相关DLL执行序列图。其中RefreshInternal是SolarWinds.Orion.
Core.BusinessLayer.dll中定期调用的方法之一，隶属于InventoryManager类，用于初始
化其他组件以及执行多项任务的CoreBusinessLayerPlugin类的Start方法启动执行。在
RefreshInternal方法植入Sunburst后门，既可以保障后门的执行，又可以避免后门在代码
审计过程中被发现。
定期调用
开启新线程
执行恶意代码
图2-39 DLL执行序列图(来源：北京启明星辰信息安全技术有限公司)
（2）后门安全检测机制
当Sunburst后门触发后，开始检测当前主机的环境状况，用于决定如何开展下一
步攻击操作。攻击者在Sunburst后门设计了一套精巧的安全检测和规避机制，以确
保后门可以在受害机器上持续、安全地运行。安全检测和规避机制包括启动进程检
测、程序休眠、域名检测、安全软件和服务检测等。
66
02 网络安全专题分析
第一，Sunburst后门会进行启动进程检测。利用进程的HASH值对比验证后门的
启动进程是否为BusinessLayerHost；若不是该进程，则会退出后门。
第二，Sunburst后门进行12～14天（288～336小时）的休眠。通过比较当前主机
系统时间和DLL的修改时间，判断是否结束休眠时间。若结束休眠，后门创建命名
管道583da945-62af-10e8-4902-a8f205c72b2e的实例。
第三，Sunburst后门进行主机所在域的域名检测。后门会获取当前主机系统所
在的域，判断上述域名是否在自己设置的黑名单中。黑名单解码情况如图2-40所
示。通过域名检测后，Sunburst后门利用所在主机MAC地址、域名以及机器GUID生
成用于后续通信的识别码UserID。通过对域名黑名单的分析发现，黑名单列表均为
SolarWinds公司的内部域名。上述情况表明，攻击者的攻击目标设定为SolarWinds公
司的客户而非公司本身，以防止过早被SolarWinds公司发现。同时，上述黑名单反
映出攻击者攻击前期已经渗透进SolarWinds内网，并精确掌握了公司构成和内部网
络结构。
图2-40 黑名单解码(来源：北京启明星辰信息安全技术有限公司)
第四，Sunburst后门进一步开展对安全软件的检测。该步骤被认为是攻防对抗。
安全软件的检测包括3个方面。
①检测本机是否存在常用的安全类分析工具，例如gdb、dnspy、pestudio、
wireshark、dumpcap等软件。
②检测当前系统是否存在安全软件服务。如果存在安全服务，则修改注册
67
2020年中国互联网网络安全报告
表目录（HKLM\SYSTEM\CurrentControlSet\ services\）下的安全服务项，修
改服务权限并设置为禁用，代码执行情况如图2-41所示。同时，Sunburst后门
利用配置文件（SolarWinds.Orion.Core.BusinessLayer.dll.config）中的配置选项
“ReportWatcherPostpone”来记录其禁用的服务和服务状态。
图2-41 代码执行情况(来源：北京启明星辰信息安全技术有限公司)
③Sunburst后门进一步检测当前系统环境的终端安全响应（EDR）驱动。
最后，Sunburst后门尝试解析域名api.solarwinds.com，测试当前系统的网络连
接情况。
上述任一安全检测过程出现失败，Sunburst后门则会立即终止，以确保攻击者操
作的安全、持续。如果所有检测条件均满足，则会开展后续网络通信机制。
（3）后门通信机制
Sunburst后门的网络通信机制共分为3个阶段。
①第一阶段为DGA生成及DNS隧道建立
首先，Sunburst后门采用DGA算法生成用于目标上报的子域名。上报子域名的格
式如图2-42所示。其中，encode_userId是一个8字节的标识值，编码后是长度为15字
节的字符串；char CreateString为生成的一个随机字符，encode_domain为编码后的计
算机domain name。
68
02 网络安全专题分析
encode_userId（生成15字节） char encode_domain domain2（随机选其一）
自定义Base64运算
XOR运算（key为范围内的随机值）
key: 自定义Base64运算 .eu-west-1
0x -81 使用MD5运算 由 生C 成re 一ate 个St 字rin 符g() .appsync-api . .e uu s- -w eae ss tt -- 12 .avsvmcloud.com
0xFE MAC domain 注册表 domain name .us-east-2
地址 name MachineGuid
0 1 8
组合生成随机DGA域名
图2-42 上报子域名格式 (来源：北京启明星辰信息安全技术有限公司)
攻击者会根据C2域名判断该主机是否是攻击目标。后门生成DNS请求数据包，
攻击者则通过C2服务器响应的信息控制该后门是否继续执行。
若攻击者认为当前受害主机可以作为攻击目标，响应信息会使Sunburst后门使用