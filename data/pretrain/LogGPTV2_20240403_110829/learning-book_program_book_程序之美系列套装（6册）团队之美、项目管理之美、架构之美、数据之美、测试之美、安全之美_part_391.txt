## Page 2257
[21参见
http://www.asiafunclub.com/japan/finance/stock_market/nikkei_1995.shtm
1以及ZangPeterG的《巴林银行破产和金融衍生品》一文，发表于
1995年的《世界科学》，第137页。
[3]详见http://www.cisecurity.org。
[4]详见http://www.plexlogic.com andhttp://www.metricscenter.org。
3.2.2TJX：外部侵害
在本章的第二个安全度量指标实例中，让我们观察有史以来（截止
到2008年）最大的支付卡诈骗案件。这是一个最近才发生的案子。
事实上，在本章写作之时（2008年10月）与这个案子有关的事件和
信息仍在不断地披露中。由于这个案子离现在太近，因此很难断言
哪些事情已经被证实、哪些事情还没有被证实。下面的有些描述来
源于司法部门未经证实的指控以及与这个案子密切相关的人们的陈
述。但是，这并不会减少我所总结出的这个教训的价值，因为我通
过这个案子说明了安全度量指标的价值。
侵害行为相信是从2005年1月在明尼苏达州靠近圣保罗市的一家
Marshalls折扣服装店外的一个停车场开始的。侵害行为持续了18个
月，直到TJX于2006年12月采取了行动。实际上，并不是TJX首先检
测到信用卡和其他顾客的私人数据被从它们的网络上被大量泄露
的。信用卡持有人和发行银行早在2005年11月就开始发现在他们的
信用卡账户上所发生的奇怪交易。直到2006年12月，TJX才对此引起
警觉，并雇用了审计专家展开调查。尽管TJX并没有因为此次侵害行
为而破产，但公司为了彻底平息这个事件可能被道在接下来的五年
里花费10亿美元，包括聘请的顾问费用、IT安全的升级、法律费用
以及向支付卡公司和银行的潜在赔付支出。受影响的个人以及与TJX
有业务往来的合伙伙伴所涉及的开销需要很长时间才能确定。
玩家
TJX公司2007年的营收超过170亿美元，是最大的平价服装和家居时
尚零售连锁店。这家公司拥有8个子公司、2500家商店和13万名员
工。TJX当前在美国的子公司包括T.J.、Maxx、Marshalls、
HomeGood和A.J.Wright。
2008年夏天，有11个人被指控不仅盗窃了T.J.Maxx和Marshalls，而且
还涉及另8家美国零售商：OfficeMax、Barnes&Noble、Sports
2256
---
## Page 2258
Authority、Boston Market、DSWShoe Warehouse、Dave&Buster's、
Forever21和B.J.'sWholesaleClub。其中10人已经被拘禁，另1人在
逃。被指控的主犯是AlbertGonzalez，27岁，佛罗里达州迈阿密人。
其他罪犯分别来自爱沙尼业、乌克兰、白俄罗斯和美国。
当Gonzalez被捕时，他已经拥有了一支格洛克27手枪、一辆2006款宝
马车、位于佛罗里达的一座公寓以及165万美元的现金。他高中毕
业、单身，与父母生活在一起。2003年，Gonzalez在新泽西州因为欺
诈指控而被捕，后来被美国特勤局雇用，协助调查一起重大的计算
机黑客事件。2004年，他被公认为协助开设了一项留言板操作，作
为购买和出售信用卡号码以及其他个人数据的中介。随后，他被特
勤局指派参与TJX案子。他的任务是充当线人，把他从黑客那里所获
得的消息透露给特勤局。但是，现在特勤局确信他是个双面线人
同时还把他从特勤局所获悉的消息透露给黑客。据称，Gonzalez在特
勤局的顾问工作使他每个月可以领取6000美元的薪水。
怎么发生的
首先让我们看一下事件是如何暴露于公众视野之中的。下面的时间
线是波士顿环球报在2007年10月25日发布的：
2007年1月17日：TJX公司声称它的计算机系统遭到未授权的入侵，
可能导致顾客的贷记卡和借记卡数据被盗用，所涉及的数据最早包
括2003年的。公司表示它确认并没有对数据使用错误。
2007年1月18日：信用卡公司、银行和顾客开始报告存储在TJX系统
中的贷记卡和借记卡账号被欺诈使用。有儿十张卡被取消。
2007年2月21日：TJX报告黑客可能早在2005年就获取了对它的计算
机的控制，比之前所想的早了一年。
2007年3月28日：TJX公布被黑客所盗用的贷记卡和借记卡号码的数
量为4570万，但它表示其中有75%已经过期或者数据被屏蔽。
2007年7月：佛罗里达警方从儿个人的认罪答辩中得知他们使用来自
TJX的信用卡号码，用代金卡和电子消费券从Wal-Mart和Sam'sClub
购买了价值800万美元的商品。
2007年8月14日，在一份公司整理的档案中，TJX推算由于这次数据
侵害所导致的总体支出为2亿5600万美元。
2257
---
## Page 2259
2007年9月21日，TJX与受侵害影响的顾客达成了一个临时和解协
议，向受害人提供公司代金券，并计划举行为期三天的“顾客满意”
销售。这个和解协议后来进行了修订，受害人可以选择领取代金券
或现金。
2007年9月25日：加拿大保密部门指责TJX没有采取有效的安全措施
保护顾客的信息。
2007年10月23日：在银行向TJX所指控的一个案子的法庭档案中显示
受盗窃事件影响的账号总数高达9400万。
这条时间线显示了此次侵害行为所造成的影响不断地上升，不管是
受影响的用户数量还是随之发生的诉讼（为了维护自己的权益）。
2007年10月的时候，犯罪分子还没有被捕获，但是已经在美国的儿
个州和另外儿个国家里展开了涉及多家执行机构的积极调查。直到
几乎一年之后的2008年8月，才公布了罪犯已被逮捕以及相关的犯罪
事实。
下面是一条从技术角度所看到的时间线：
1999年：无线LAN诞生：IEEE802.11b完成并被批准。
2001年：对无线通信的WEP保护的劫持和破解被证实存在。
2002年4月：IEEE802.1X批准使用可扩展认证协议（EAP）处理端口
层次的安全。这个协议工作于RADIUS服务器，已经得到了广泛的商
业用途。它的目标是对有线网络端口进行标准化，但被发现同样适
用于无线网络。
2002年7月：IEEE802.11b安全脆弱性被广泛公布，并附带详细的获
取企业级的强度的建议。
2004年6月：IEEE802.11i被批准为无线IEEE802.11标准的修正案，
以提供安全机制的标准规范，用于取代以前的安全规范。
2005年6月：TJX仍然在零售商店中厂泛地使用WEP保护。
现在，司法部门宣称Gonzalez和其他犯罪分子使用了一种流行的称为
驾驶攻击（wardriving）的低成本技术，用于发现开放的无线网络。
驾驶攻击就是在配备了PC和优质大线的汽车里对公共区域进行巡
查。天线可以发现无线网络。PC运行无线客户软件，如果该网络具
2258
---
## Page 2260
有开放的访问就试图对它进行连接。如果这个网络实现了某种形式
的访问安全，就记录被传输的数据包流。如果它的访问安全是脆弱
的，就可以通过适当的软件对数据包流进行分析，提取入侵需要使
用的所有信息。一旦成功侵入，黑客就可以访问该网络连接的顾客
数据库，开始收集信用卡号码和其他个人数据。
为了理解它的详细工作原理，让我们观察与无线网络有关的一些关
键事实。我们还将提供“一致性良好行为”，它们是由不同的行业小
组和标准化组织所开发的建议：
IEEE802.11b标准指定了一个服务集标识符（SSID），用于区分无
线接入点（独立的网络）。例如，一家称为GoodNight'sRest的宾馆
为了方便起见可能把它的WAP命名为GoodNR。默认模式下的WAP操
作每隔儿秒厂播这个SSID，称为“Beacon顿”。这种做法使授权用户
很容易发现并连接到网络，而且它同样为非授权用户提供了方便。
一致性良好行为：公司应该把所有的SSID的值设置为比较含糊。
像"TJX-Miami"这样的设置并不是很好的选择。另外，最好关掉SSID
广播。
为了对希望连接到网络的用户进行认证，IEEE802b指定了一个称为
无线等效加密（WEP）的协议。大多数WAP配备了一个默认设置，
用于开放式的认证，意味着WEP是被禁用的，因此对希望进行连接
的客户不会进行认证。
一致性良好行为：公司应该修改默认设置进行认证，不允许所有客
户的开放式访问。
当WEP被启用时，每个单独的客户用一个密钥进行配置，由它的相
关WAP所共享。想要访问网络的客户首先向WAP发送一个关联请
求，WAP对这个请求作出响应，向客户发送一个包含挑战文本的字
符串。然后客户采用一种称为RC4的算法对挑战文本进行加密并把
它发送回WAP。WAP根据客户是否正确地对挑战文本进行了加密而
决定是否通过客户的认证。
一致性良好行为：WEP的密钥管理是一个噩梦。为了修改共享密
钥，每个WAP和客户的配置必须进行更新。
WEP协议允许未授权的听众捕捉认证方程式的3个变量的其中2个：
挑战文本和RC4加密的响应。只要有足够的样本，黑客可以使用嵌
2259
---
## Page 2261
入到免费下载的软件中的广为人知的算法破解共享密钥。
一致性良好行为：WEP并没有对无线网络提供充分的保护。实现强
大的无线安全的行为包括：
一关闭WEP
一选择含糊的SSID
一采用路由器和防火墙隔离无线子网
一使用802.1X进行密钥管理
显然，和其他遭到侵害的零售商一样，TJX并没有遵循早在2002年7
月就已经颁布的指导方针。黑客们利用了这个事实，获取了对公司
网络的访问。结果，他们可以通过商店的网络获得顾客的信息，包
括通过无线传输的员工资格证书。黑客们使用员工资格证书，访问
商店的服务器以及TJIX位于马萨诸塞州总部存储了大量的顾客数据的
服务器。
哪里出错了
与由于访问管理过程的松邂而导致内部侵害行为的巴林银行的遭遇
不同，TJX的侵害行为是由外部攻击者利用网络和系统管理过程的松
解而发起的。有关的调查仍在进行之中，据相关人士透露，外部攻
击者发现了使用默认配置的WAP、使用了通俗易懂的SSID和开放式
访问的WAP以及被配置为使用WEP的WAP。这些WAP是黑客们伸手
可及的果实，他们只需要难以置信的微小投资就可以获得数量惊人
的有价值数据。
因此，站在事后的角度，TJX到底哪里做错了？技术上的松邂是很容
易列出的：
不充分的网络配置控制
不充分的网络使用监管
不充分的服务器配置和使用监视
不充分的数据保护，尤其是数据的外流
2260
---
## Page 2262
当然，在更深层次上，技术上的失败是由于管理上的错位所致：
忽视或不关心基本的安全行为，例如密码保护；
忽视无线网络的操作，没有遵循行业警告，并且不关注与常见漏洞
有关的新闻；
缺乏统一的策略，也缺乏与远程网站的通信，未能获取推荐的策
略：
在报告出现了问题时拒绝寻找问题的证据：
在所有时间内缺乏对安全的基本关注，包括安装、员工培训以及接
下来的运营期间。这些时期都应该进行监管。
无线标准委员会和生产商也对这个问题负有一定的责任，但这个问
题过于广泛，无法在这篇文章内深入讨论。
说明
并不仅仅是TJX应该受到指责。其他九家零售公司被相同的窃贼利用
相同的黑客技巧所人侵，也是利用了他们的T系统的相同安全漏
洞。
TJX：“如果......怎么样”
如果TJX使用了有效的感应系统，能够持续监视数以百万计的交易以