−12,205
614,941
468,070
270,663
−1088
1,007,383
138,285
−8131
2,399,494
80,695
7,735,834
17,942
−494
3,421,089
67,197
1676
277,004
310,317
818,507
4,923,961
433,040
203,153
833,715
31,745,933
1,601,580
−212
8,075,579
314,418
22,393
382,154
3,232,483
−6416
285,099
678,530
446,180
637,882
1,240,928
4,983,178
126,529
223,419
232,045
362,154
470,334
Di
26,974
135,766
−44,352
−171,099
−44,110
−18,457
58,936
−4332
2427
−15,320
−1,086,629
−7406
−1,001,304
5412
−515
−8732
−936
−120
−32
−33,692
−169,516
−447,172
234,848
−130
−40,652
−29,860
−6889
−2528
−2,078,370
−825
−707
−34,345
−157,989
−7466
−19,476
−44,278
−42,314
−74,015
−184,676
217,562,247
−60,522
46,946
−7571
−175,760
−409,148
Table 5: Recent botnet Risk values (compared against DS).
Figure 6: 3322.org aggregate daily lookup volume (log-
scale).
predicated backup plans for the 45 botnets are shown in Ta-
ble 4 and the associated Risk values are shown in Table 5.
Overall, the TIR values indicate we are gaining additional
infrastructure information as we did in the postmortem cases.
Similarly, we see very large TIRs for the expanded infras-
tructure set, De, further evidence that infrastructure related
by the passive DNS includes additional domains that need
to be narrowed down by categorizing the domain sets. These
TIR values were smaller, as we saw with the postmortems,
with the malware-related and reputation-based sets—Dm
and Dr, respectively—contributing the bulk of the newly
observed lookup volumes.
In addition to describing the enumerated infrastructure
sets, we also identify the backup mechanisms, if any, present
in the botnet. If a botnet’s malware has no backup plan, it
is a prime candidate for a smooth, DNS-only takedown, oth-
erwise we have identiﬁed the necessary conditions for per-
forming an eﬀective takedown. The most important ﬁnding,
however, is that of the 45 botnets we studied 42 of them had
no contingency plan for central C&C failure, suggesting the
bulk of these botnets can be successfully taken down without
requiring additional measures, such as reverse engineering a
DGA or combating a P2P-based C&C. This suggests that
while performing a takedown is diﬃcult, we are likely to
succeed in many cases.
6. CONCLUSION
We presented rza, a takedown analysis and recommenda-
tion system that performs postmortem analyses of past take-
downs, as well as making recommendations for performing
more eﬀective takedowns in the future. rza would be useful
in helping to both expedite the takedown process, as well as
ensuring future takedowns are more complete.
130Dr. Shiuhpyng Shieh for his guidance in improving our pa-
per. We also thank RZA for reinventing rap production and
bringing us the Wu-Tang Clan.
This material is based upon work supported in part by
the National Science Foundation under Grants No. CNS-
1017265, CNS-0831300, and CNS-1149051, by the Oﬃce of
Naval Research under Grant No. N000140911042, and by
the Department of Homeland Security under contract No.
N66001-12-C-0133. Any opinions, ﬁndings, and conclusions
or recommendations expressed in this material are those of
the authors and do not necessarily reﬂect the views of the
National Science Foundation, the Oﬃce of Naval Research,
or the Department of Homeland Security.
APPENDIX
A. POLICY DISCUSSION
Takedowns are currently performed in an ad-hoc manner
with little oversight, which makes it diﬃcult for the security
community at large to assist by contributing intelligence.
Furthermore, there is no standard policy for enacting a take-
down at the DNS-level forcing companies to coordinate with
multiple registrars, pay for expensive court proceedings, or
both to disable botnets. Existing measures for handling do-
main name issues exist, however, in the form of handling
trademark disputes.
Our postmortem studies illustrated several drawbacks to
the current ad-hoc manner in which takedowns are per-
formed, namely: a lack of coordination, little to no oversight,
and an environment that discourages collaboration. With-
out an eﬀective form of coordination, we will continue to
see instances in where two or more security companies, with
good intentions, will step on each others toes as we saw in
the Zeus takedown case. We also saw oversight issues in the
Zeus takedown where domains were clearly being sinkholed
before the date presented in the court order. Yet another,
but more subtle, oversight issue deals with the method of in-
stigating these takedowns: court orders. Each of the court
orders for the presented takedowns were ﬁled under seal,
meaning they are not open to the public and require either
the claimant to release the record under their discretion, or
other legal action to unseal the record. Even more worrisome
is language explicitly allowing further unveriﬁed action. In
the 3322.org takedown temporary restraining order it was
speciﬁed that “the authoritative name server ...
[is] to re-
spond to requests for the IP addresses of the sub-domains of
3322.org may respond to requests for the IP address of any
domain listed in Appendix A or later determined to be asso-
ciated with malware activity...” [13] (emphasis ours). While
an authoritative name server takeover technically grants this
ability, if the purpose of the court order is to prevent col-
lateral damage or unlawful takedown this clause eﬀectively
negates any future protection. It also suggests that the full
scope of the threat was not clear at the time of the takedown
by speciﬁcally permitting further cleanup actions.
Trademark and intellectual property interests were in-
volved very early on in during the formation of the Internet
Corporation for Assigned Names and Numbers (ICANN),
which is responsible for coordinating, among other critical
Internet infrastructure, the DNS. Through the World Intel-
lectual Property Organization (WIPO), trademark interests
were arguing for procedures to protect trademarks in the
DNS as early as December 1998 [16], and successfully forced
ICANN to require a dispute resolution procedure dubbed
the “Uniform Dispute Resolution Policy” or URDP.
URDP is an ICANN policy that speciﬁes independent ar-
bitrators to oversee the process of dispute resolution. These
“[i]ndependent arbitrators make a decision quickly and (rel-
ative to courts) inexpensively” [16] and are built in to the
accreditation contracts to registrars. The UDRP requires
three conditions to be met to ﬁle a complaint:
i. your domain name is identical or confusingly similar to
a trademark or service mark in which the complainant
has rights; and
ii. you have no rights or legitimate interests in respect of
the domain name; and
iii. your domain name has been registered and is being
used in bad faith.
[6]. In its ﬁrst year, UDRP successfully “handled over 2,500
cases involving nearly 4,000 names” [16] and has expanded
since.
In fact, ICANN is introducing The Uniform Rapid
Suspension System (URS) [7] as a more expedited form of
the URDP and is requiring new generic top-level domains
(gTLDs) to follow URS in their contracts.
We suggest a similar procedure ought to be available to
provide the security community a point of coordination and
a formal process to follow when performing takedowns. It
would reduce exorbitant fees paid to courts, would likely be
faster, and would mandate oversight from arbitrators. The
procedure could be applied to future TLDs as a test, much
like URS. Automated systems like rza could serve an invalu-
able place in this process to reduce the burden on human
operators and further expedite the takedown process.
B. RZA WITH ISC/SIE PDNS DATA
We replicated part of our evaluation using only ISC-SIE
data. Speciﬁcally, we generated the De, Dm, and Dr do-
main sets and computed the respective TIR values of Zeus
and ﬁve of the current botnets with the most domains we
tracked in our paper. Di sets were excluded due to time
limitations. Our results from the SIE dataset are shown in
Table 6 and are largely consistent and show that the process
employed by RZA can be done with other sources of pDNS
data. The important detail to glean is that the process rza
uses is independent of our private dataset and can be per-
formed using public sources of passive DNS data. Due to
regional variations, the TIR values are unlikely to be iden-
tical between the two datasets; however, the process and
generated sets are the important factors.
Takedown
Zeus
#1
#2
#3
#4
#5
De
4.843
1.108
0.969
0.787
0.680
1.944
Dm
0.000
1.012
0.969
0.787
0.680
1.451
Dr
1.014
1.082
0.459
0.718
0.613
1.122
Table 6: SIE-computed TIR values.
C. WINDOW JUSTIFICATION
We consider the activation of a domain name d ∈ De
to occur when d ﬁrst begins to resolve to a global IP ad-
131dress in the observation period and a deactivation to be the
day when d ∈ De no longer resolves to a global IP address.
Figure 7 shows the number of new domain activations and
deactivations for the domains in De for one of the take-
downs analyzed in Section 4, as well as the net change for
each day. We see that around seven days prior to the take-
down the number of activations/deactivations has achieved
an equilibrium motivating the choice of a 14 day observation
window around the time of the takedown. Other takedowns
exhibited similar behavior, but the details are not reported
due to space limitations.
Figure 7: Domain name activations and deactivations in
3322.org takedown’s De set.
D. REFERENCES
[1] M. Antonakakis, R. Perdisci, D. Dagon, and W. Lee.
Building a Dynamic Reputation System for DNS. In
Proceedings of the USENIX Security Symposium, 2010.
[2] L. Bilge, E. Kirda, C. Kruegel, and M. Balduzzi.
EXPOSURE: Finding Malicious Domains Using
Passive DNS Analysis. In Network and Distributed
System Security Symposium (NDSS), 2011.
[3] Conﬁcker Working Group. Conﬁcker Working Group:
Lessons Learned, 2011.
http://www.confickerworkinggroup.org/wiki/
uploads/Conficker_Working_Group_Lessons_
Learned_17_June_2010_final.pdf.
[4] Farsight Security, Inc. SIE/Farsight Security’s
DNSDB, 2013. https://www.dnsdb.info/.
[5] M. Harris. Spammers recovering from McColo
shutdown, 2009. http:
//www.techradar.com/news/internet/spammers-
recovering-from-mccolo-shutdown-591118.
[6] Internet Corporation for Assigned Names and
Numbers. Uniform Domain Name Dispute Resolution
Policy. Technical report, 1999.
[7] Internet Corporation for Assigned Names and
Numbers. Uniform Rapid Suspension System.
Technical report, 2012.
[8] B. Krebs. Major Source of Online Scams and Spams
Knocked Oﬄine, 2008.
http://voices.washingtonpost.com/securityfix/
2008/11/major_source_of_online_scams_a.html.
[9] B. Krebs. Spam Volumes Drop by Two-Thirds After
Firm Goes Oﬄine, 2008.
http://voices.washingtonpost.com/securityfix/
2008/11/spam_volumes_drop_by_23_after.html.
[10] B. Krebs. Mariposa Botnet Authors May Avoid Jail
Time, 2010.
http://krebsonsecurity.com/2010/03/mariposa-
botnet-authors-may-avoid-jail-time/.
[11] R. McMillan. After takedown, botnet-linked ISP
Troyak resurfaces, 2010. http://www.computerworld.
com/s/article/9169118/After_takedown_botnet_
linked_ISP_Troyak_resurfaces.
[12] Microsoft Corporation. Microsoft Corporation v.
Dominique Alexander Piatti; Jone Does 1-22. 2011.
Virginia Eastern District Court.
[13] Microsoft Corporation. Microsoft Corporation v. Peng
Yong et. al. 2012. Virginia Eastern District Court.
[14] Microsoft Corporation. Microsoft v. John Does 1-39.
2012. New York Eastern District Court.
[15] E. Mills. Microsoft halts another botnet: Kelihos,
2011.
http://news.cnet.com/8301-1009_3-20112289-
83/microsoft-halts-another-botnet-kelihos/.
[16] M. Mueller. Ruling the root. The MIT Press, 2004.
[17] Y. Nadji, M. Antonakakis, R. Perdisci, and W. Lee.
Understanding the prevalence and use of alternative
plans in malware with network games. In Proceedings
of the 27th Annual Computer Security Applications
Conference (ACSAC ’11), 2011.
[18] C. Rossow, D. Andriesse, and T. Werner. P2PWNED:
Modeling and Evaluating the Resilience of
Peer-to-Peer Botnets. In Proceedings of the 34th IEEE
Symposium on Security and Privacy (S&P 2013),
2013.
[19] U.S. Attorney’s Oﬃce - Southern District of New
York. Manhattan U.S. Attorney Charges Seven
Individuals for Engineering Sophisticated Internet
Fraud Scheme, 2011.
http://www.fbi.gov/newyork/press-
releases/2011/manhattan-u.s.-attorney-charges-
seven-individuals-for-engineering-
sophisticated-internet-fraud-scheme-that-
infected-millions-of-computers-worldwide-and-
manipulated-internet-advertising-business.
[20] VirusTotal. VirusTotal Intelligence. https://www.
virustotal.com/en/documentation/private-api/.
132