sary has to ensure that deviation in the ratio metric never exceeds ϵ
on every time window. To completely escape detection, it is manda-
tory for adversary to possess four additional knowledge: (i) Closed
Form Expressions of Harmonic Means (ii) Exact (non-attacked)
harmonic and arithmetic mean on each time slot (iii) ϵ value (iv)
skewness of data distribution. The skewness knowledge is public
(right skewed) and has no attack cost. Di(cid:29)erent microgrids will
have completely di(cid:29)erent ϵ values, hence the attacker needs to
know ϵ of each micro-grid. The ϵ value may be leaked by com-
promising an utility insider for each micro-grid, or the database
storing all the ϵ values. Both possibilities increase the attack cost.
Assuming, that attacker knows the ϵ, it further needs the exact
knowledge of HM and AM in each time slot. This is rather implau-
sible for adversary to know at runtime, unless it compromises 100%
of the meters. This is because the means do not have any stable
historical trend or time series, so attacker cannot reliably predict
them. Unless actual HM and AM is known, one cannot ensure that
the resultant Qr at io
av❕ (F ) from the attack will have a ratio deviation
that is lesser than the ϵ. Most importantly, the exact closed form ex-
pressions of harmonic means do not exist, and is an open problem
in real analysis. Several approximations exist [18], but note that
it does guarentee success everytime and the defender needs suc-
cess only once to raise an alarm. Even if the attacker knew every-
thing somehow, we show that the signatures are visually evident
for δav❕ values as low as 50W (see Appendix C).
The sensitivity to successful identi(cid:27)cation of compromised me-
ters is di(cid:29)erent from sensitivity to successful detection of presence
of orchestrated attacks. Given our model, we report that if that
attacker’s δav❕ < 300W , the missed detection rate drastically in-
creases to 52%, since such δav❕ is much less than standard devi-
ation which ends of with higher rating levels. For the attacker to
keep atleast 50% of its compromised meters undetected, the high-
est possible δav❕ = 300W when ρmal = 40%. However, at such
low δav❕, the impact per unit time is less (see Appendix D).
6 EXPERIMENTAL RESULTS
Data sets from 200, 700, and 5000 houses, were obtained
from PeCanStreet Project [25] and Irish Social Science Data
Archives [26], containing hourly power consumption data from
Texas, Austin and Dublin, Ireland respectively. The di(cid:29)erent micro-
grid sizes mimic decentralized and centralized deployments of de-
fense frameworks. We studied results of anomaly detection and
trust model for all types of data falsi(cid:27)cation. Additionally, we stud-
ied the performance scalability of Irish data for 5000 houses. For
anomaly detection results, a period of no attacks is followed by a
period of attacks. Deductive attack results have lesser δav❕ than
the others, since realistic values of power consumption are lower
bounded by zero. For clarity of representation, we show anom-
aly detection results using cumulative moving averages over time
frame (F ) of length 7 days. Additionally, for easy depiction of me-
ter classi(cid:27)cation results, all the compromised meters are assigned
lower meter id than the honest ones. Finally, we show performance
over all values of ρmal and δav❕ and compare with existing work.
0.3
0.25
0.2
0.15
0.1
0.05
0
400
e
t
a
r
r
o
r
r
E
0.25
0.2
0.15
0.1
0.05
e
t
a
R
r
o
r
r
E
800
∆
avg
1200
1
3
2
0
400
600
ǫ ( x  σ
)
ratio
3
2.5
800
1000
∆
avg
1200
1400
2
1.5
1
ǫ (x  σ
)
ratio
(a)
(b)
Figure 11: Error Rates: (a) ρmal = 40% (b) ρmal = 10%
6.1 Choice of ϵ for consensus correction
The choice of ϵ decides, whether the anomaly detection raises an
alarm or not, which in turns decides whether or not the consensus
correction is invoked that subsequently a(cid:29)ects classi(cid:27)cation error
rates. In the real-world, the drop/change in the ratio depends on
the attacker’s ρmal and δav❕ values which is always unavailable
to the defense framework at run-time. To provide a suitable recom-
mendation on the desired ϵ, we performed some experiments for
an appropriate recommended value of ϵ.
It is important to understand that, smaller ρmal and δav❕ pairs
will cause smaller drop/change in the ratios and therefore, ϵ will
need to be small to capture them. However, this aspect is o(cid:29)set by
Session 5: Machine Learning 1ASIACCS’18, June 4–8, 2018, Incheon, Republic of Korea181ASIA CCS ’18, June 4–8, 2018, Incheon, Republic of Korea
Bha(cid:29)acharjee et al.
the fact that they also do not a(cid:29)ect the consensus in a drastic way.
In that case, an unwarranted consensus correction will cause the
classi(cid:27)cation errors to increase. As a proof, it can be observed from
Fig. 11(a) and 11(b), error rates are higher for very low values of
ϵ. On the (cid:30)ip side, if the ϵ is too large, it will fail to raise alarm
for many possible ρmal and δav❕ pairs. Therefore, the consensus
correction will not be invoked, the trust scoring model will be ex-
ecuted with a biased consensus increasing the classi(cid:27)cation error
rates. Again this could be veri(cid:27)ed from Fig. 11(a) and 11(b), where
we see the error rates are very high when ϵ ∼ 3σr at io . Naturally,
there will be an intermediate optimal region of ϵ, where the error
rates will be minimized. From computational study, we observed
that regardless the wide variation of δav❕ (from 350W to 1400W),
the error rate minima is achieved at ϵ = [1.5σr at io , 2σr at io ] of the
ratio sample distribution, at ρmal = 10%,ρmal = 40% respectively.
Therefore, although ρmal and δav❕ may not be known apriori, the
recommended ϵ value could be learned a priori, by the above man-
ner. Following this, we have used ϵ = 2σr at io , for all performance
results, even for results parameterizing di(cid:29)erent ρmal .
6.2 Inferring Presence and Type of Falsi(cid:27)cation
Figure 12(a), shows the directional changes in H M and AM and
ratio drop to distinguish between legitimate changes and mali-
cious attacks. In the (cid:27)rst 57 days, H M and AM changed but
their growth/decay had a symmetry, indicating legitimate changes
in consumption through same Qr at io
av❕ (F ) ∼ 0.92 value. How-
ever, when additive attack phase was launched at 58th day, the
Qr at io
av❕ (F ) started to decrease from within 2 days of attack, due to
slower increase of H M compared to AM. The directional change
of both H M and AM values from Ft r i❕ (arrow upwards) indicate
the additive nature of attack. The inference of attack and its type
is quick. The Fig. 12(b) and Fig. 13(a), show real time anomaly de-
tection for deductive and camou(cid:30)age attacks respectively.
8
7.5
7
6.5
6
n
o
i
t
p
m
u
s
n
o
C
r
e
w
o
P
HM
AM
Additive
Attack
Starts
Ratio Drop
T
trig
20
40
60
80
Time (days)
7.5
7
6.5
6
5.5
5
)
)
P
(
n
l
(
n
o
i
t
p
m
u
s
n
o
C
r
e
w
o
P
Deductive
Attack
Starts
HM
AM
40
60
80
Time (days)
(a)
(b)
Figure 12: Ratio Change: (a) Additive (b) Deductive
7.5
7
6.5
6
5.5
)
)
P
(
n
l
(
n
o
i
t
p
m
u
s
n
o
C
r
e
w
o
P
HM
AM
0.94
0.92
0.9
Camouflage
Additive
Subtractive
o
i
t
a
R
0.88
0.86
40
Time (days)
60
80
0.84
0.82
0.8
0
20
40
60
80
100
Percentage of Compromised Meters
(a)
(b)
Figure 13: Ratio Change: (a) Camou(cid:30)age (b) Over all ρmal
6.3 Robustness of Anomaly Detection over ρmal
Qr at io
av❕ (F ) based detection is robust across larger fractions of com-
promised meters. Fig. 13(b), show that the drop in the Qr at io (F )
is larger than the chosen ϵ (i.e. Qr at io (F ) is decreased for ρmal <
85% values compared to the ratio when ρmal is 0%). This is the rea-
son for successful anomaly detection to higher fractions of compro-
mised meters. We also observe, that the minimum ratio is achieved
when ρmal ∼ 50%, for additive and deductive attacks. However,
for camou(cid:30)age attacks, the ratio always decreases with increasing
ρmal , since the deductive portion of the camou(cid:30)age attack only af-
fects the Harmonic Mean while keeping the AM same. Hence, the
resultant ratio decreases regardless the ρmal .
1
0.8
l
e
u
a
V
0.6
t
s
u
r
T
0.4
0.2
Malicious
Honest
Classifier (0.45)
Malicious
Honest
Classifier (0.70)
1
0.8
0.6
0.4
0.2
e
u
l
a
V
t
s
u
r
T
0
50
100
Meter ID
(a)
150
200
0
50
100
150
200
Meter ID
(b)
Figure 14: Texas Dataset: (a) Additive (b) Deductive
1
0.8
l
e
u
a
V
0.6
t
s
u
r
T
0.4
0.2
Additive Nodes
Deductive Nodes
Honest Nodes
Classifier (0.81)
1
0.8
l
e