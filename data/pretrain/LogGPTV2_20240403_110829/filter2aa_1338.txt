PbootCMSmodel-
>getSort($path) ，由于path变量可控，最终在 apps/home/model/ParserModel.php
下 getSort 函数处可造成注⼊
既然确定了那就继续深⼊看看，⾸先不是pathinfo穿参模式则进⼊下⾯的分，,当然默认情况下
不是采⽤pathinfo模式,会获取 QUERY_STRING 也就是get传参 ? 后⾯部分的内容保存到 qs 变量
当中，接下来通过 parse_str 做变量的赋值保存到 output 当中（这是坑后⾯会说到如何破
局），之后会把参数的key保存给path变量
接下来⽤ / 做分隔符，之后switch case取第⼀个元素作为分发的条件
我们需要进⼊default分⽀，才能到漏洞点，这⾥我们随便⽤⼀个字符串
test， http://127.0.0.1/?test
成功到漏洞点getSort，简简单单⽆过滤拼接查询
为了⽅便这⾥⽤布尔盲注了，回显的又臭又长
踩坑
可是当我们⼼⾼彩烈的去构造注⼊的时候 ?test/3' or if(0,0,1))%23 ，可以看到这⾥空
格都被替换成 _ 了，在这⾥你可能会告诉我，为什么你不⽤ %0a/%09 又或者 /**/ 去绕过
呢，这不是明摆着呢，但是你说 information_schema.xxx 怎么办，parse_str仍然会将 . 替
换为 _
在解决问题之前我⾸先给出payload ?test/3'/*[*/or if(1,0,1))%23 ，毕竟这篇⽂章还
得继续
我们可以通过控制if的判断 1 or 0 ，如果是0代表没有结果页⾯也会报错，根据这个特征我们
就可以写简简单单的布尔盲注的脚本了
看php内核代码破局
还记得那个parse_str函数么，虽然可以⽤⼀句话概括，也就是⽹上常说的⽤ parse_str 只有
第⼀个 [ 会被替换为 _ ，那么为什么⽆论加多少个空格都会被替换为 _ ，当然也不扯远了只
是想谈谈为什么
那么我就来教教⼤家如何绕过，这⾥我也不想通篇写整个步骤，这个函数咋解析的然后又传
到哪⾥去，感兴趣的师傅可以⾃⾏编译
直接放结果，在 main\php_variables.c ，下⾯这个函数已经明显的告诉了我们结果，就不
必多说了
如果有空格或者 . 就会被for循环⽆限替换为 _
那么重点来了，有什么办法打破这个循环，答案就是使⽤⼀个 [ ，那么这⾥再留两个问题，
为什么出现 [ 也给替换掉了，在php设计的时候为什么会认为出现 [ 就终⽌了呢？我们知道在
输⼊的时候什么情况下会出现，也就是数组，继续回到话题
在这⾥，php会认为你解析到了数组，给p为当前指针指向的变量名地址，并把当前指针指向
赋值为0，接下来来揭晓答案
这⾥因为没有 ] 进⾏匹配，这⾥可能php认为是误输⼊，所以把指针指向前⼀位赋值为 _ ，这
也就解释清楚了
同时你也应该知道了为什么 [[只将第⼀个[解析为_，第⼆个不解析了吗，以及[.、[空格等多种
操作
结果
简单通过⼆分法即可获得flag