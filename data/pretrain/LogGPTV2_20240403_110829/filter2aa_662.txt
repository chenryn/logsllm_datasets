Catching the Golden Snitch 
Leveraging Threat Intelligence Platforms  
to Defend Against Cyber Attacks 
  PI:EMAIL 
• Malware analysis, malicious document detection, 
advanced persistence threat research 
• Tracking several cyber espionage groups for years 
• Tracking new operations, TTP of APT groups 
  PI:EMAIL 
• 7+ years experience on Reverse Engineering 
• 5+ years experience on malware analysis 
• Sandbox, Exploit research 
• APT research 
•
 Available Products in each phase 
 Available TIP Products  
•
 Some takeaways 
•
 What do we fear about cyber threat? 
 Why do we need Cyber Threat Intelligence? 
•
 Main features of TIP 
 Aggregation, Analysis, Action 
•
 Story Begins 
 Pitfalls of Correlation 
 New activities of Menupass group 
INTRODUCTION 
State Secrete 
(Political, Economic, Defense) 
National Security 
Business Intellectual Property 
Customer Data 
Personal identifiable Data 
Privacy 
• However…… 
Cyber Espionage Attacks 
Hacktivism Attacks 
Cyber Espionage 
Cyber Crime 
• Breaches happens everyday 
• Data leaked everyday.. 
Personal identifiable Data 
Privacy 
• New breaches happens everyday 
• New indicators disclosed everyday 
• New vulnerabilities disclosed everyday 
• About 18 new CVE vulnerabilities disclosed everyday in 2015 
• Totally 6419 CVE vulnerabilities disclosed in 2015 
• Advanced Persistent Threat  
• Targeting your Achilles' heel 
• Knowledge about adversaries and their motivations, intentions, 
and methods that is collected, analyzed, and disseminated in 
ways that help security and business staff at all levels protect the 
critical assets of the enterprise.  
Jon Friedman et al, 2015, Definitive Guide to Cyber Threat Intelligence 
Ref: iThome 
“关于一银事件, 看完台湾新闻后, 目前我知道这
起盗领案是由一银内鬼看色情邮件和用XP Ping 
8.8.8.8 ，然后爱用Adidas和爱吃黑嘉丽软糖的嫌
犯可以把钱拿走，再去宜兰买捷安特吃白鲳鱼，
被捕之后说要上厕所再去看医生，而且你们有没
有发现, 安德鲁居然有张明星脸!” 
• Anunak: APT against financial 
institutions - Group-IB and 
Fox-IT  
• This report describes the 
details and type of operations 
carried out by an organized 
criminal group from Russia that 
focuses on financial industry. 
• How to aggregate all the data from different sources? (Open source 
intelligence,  Incident Response, Community, Customers, Exchange 
Platform) 
• How to manage all the information for better analysis? 
• How to analysis these data, co-relate incidents to campaigns? 
• What is the most significant threat to me? 
• How to aggregate these cyber threat intelligence with internal data? 
• How to share and do intelligence exchange? 
THREAT INTELLIGENCE PLATFORM 
Threat Intelligence Platform 
• To support research and tailored threat intelligence program 
• Simply defined, TIP include three main features: 
• Aggregating internal & external data:  
• Data from own surface and external 
sources 
• The most important source of relevant 
threat data of an organization is your 
own attack surface. 
• TTP = Tactics, Techniques, and 
Procedures  
• Targeted Attack Reconnaissance 
• Scanbox example 
• Supporting different input 
sources:  
• Samples input 
• Incident Respond Data 
• Different Logs?   
• Intelligence Feed 
• Indicators input 
• Spreadsheet? 
• Structured Language 
• Structured Threat Information 
Expression (STIX from MITRE)  
• Data management  
• Intelligence requirement – 
How to answer questions? 
• BE careful with “Details” 
• Data Structure, Data Base 
• Exchange Restriction 
• Traffic Light Protocol (TLP) 
• The core feature of TIP 
• Triaging data priority 
• Data Prioritization 
• Customization 
• Focusing on real threat, generating 
high-fidelity information 
• Validation 
• Analyst assessment 
• Turning information into actionable 
intelligence 
• Timely, Accurate, Relevant 
• Malware analysis 
• Static analysis: manual reversing, Yara database, AntiVirus detection 
• Dynamic: manual tracing and triggering, automated sandboxes 
• Automate technically processing as much as possible (sandbox, Yara..etc) 
• Identify code family, C&C servers, languages, possible victim, possible 
adversary 
• Exploit analysis 
• disclosed vulnerabilities, 0 days 
• Delivery method analysis 
• Social Engineering 
• Waterhole attacks 
• Lateral movement 
• Correlating C2 infrastructure in 
different attacks (operation 
tracking) 
• Domains, IP co-relations 
• Known malicious C2 
• Compromised machines 
• Web hosting servers, VPS servers 
• Passive DNS 
• WHOIS information analysis 
• Identify possible targets 
• Campaign Code 
• Decoy 
• Language 
• Theme 
• Targeted Data 
• Identify targeted data 
• What do actors interested 
in? 
• Example: Phishing 
(Accounts & Password) 
• Example: Python 
Downloader from 
Hangover Team 
• Identify adversary, actors, origin 
• Language 
• Tools 
• C2 infrastructure 
• Identify motivations, intentions 
• Cooperation relationship between 
different groups 
• Sharing tools? 
• Working together in same attacks? 
• Analyst skills 
• Technical Skills 
• Malware Analysis 
• TTP Analysis 
• Language 
• Background, 
International Relations 
• Tradecraft, Criminal, 
Cyberspace 
• Analytic & Critical 
Thinking 
• Discovery ability 
• “中华航空电子机票”   (probably Elirks) 
• DreamMail, FoxMail Phishing   (Probably Taidoor) 
• Password “flowerdance”  (probably Menupass) 
• Pivoting among data-
modelings 
• Search, Filter, Facet, Cluster 
• Tag, Comment, Classify, Score 
• Visualization, Timeline, 
Maltego 
• Collaboration 
• Exchange 
• Structure Language 
• STIX and CybOX 
• Sharing Program 
• TAXII 
• Reports 
• Basic report (Firewalls/IT Staff) 
• Malwares, Indicators of 
Compromise (Hashes, C&C) 
• Advance report 
• TTP 
• Adversary  
• Trend, outlook 
• Visualization 
Research Real Case  
The New Activities of Menupass group 
• In 2013, we observed an Email 
sample which were supposedly 
targeting Japan victim. 
• Poison Ivy is a public 
available RAT which 
has remained popular 
and effective for about 
11 years after its 
lastest releas. 
• Special Characteristic 
of the sample: 
• Password: keaidestone 
• ID: 2013/05/15-40 
• Finding related 
samples 
• ImpHash 
• Launcher, Dropper 
• C2 
• Specialties of 
malware samples 
(Yara Hunting)  
• OSINT 
• By now, we have gathered 360+ Samples of this group 
• More than 800+ indicators of Menupass group 
• Related OSINT Data:  
• 2011 Symentec – Inside a Back Door Attack 
• 2013 FireEye – POISON IVY: Assessing Damage and Extracting Intelligence 
• 2016 Cylance – Operation Dust Storm 
• Clustering sample data found that their earliest movement can be 
dated back to 2007. 
• We found other tools used by Menupass group by C2 correlation and 
clustering Yara Rule analysis. 
• Poison Ivy 
• PlugX 
• Gh0st 
• EvilGrab  
• SPIVY (New) 
• Poison Ivy Connection Password: 
• PlugX Connection Password: 
• Delivery 
• Spear-phishing Email with 
fabricated document file  
• Attachment file with download 
link 
• Decoy document 
• Tailored content in 
decoy document 
• Attachment file of 
instruction to “exploit” 
yourself. 
• 500+ C2 domains & IPs 
• Favor of Dynamic DNS & 
Virtual Private Servers. 
• PubYun  
• ChangeIP.com  
• No-IP 
• FreeDNS 
• Dyn.com 
• Oray (
) 
Region, Timeframe, Visibility 
Products Available 
HP ArcSight ($) 
IBM QRadar ($) 
Cisco Source Fire AMP ($) 
AlienVault (FREE /$) 
CHT EyeQuila ($) 
Google Rapid 
Response (FREE) 
Mandiant 
RedLine/MIR (FREE / $) 
Guidance EnCase 
Cyber Security ($) 
Verint XecProbe ($) 
Carbon Black ($) 
Falcon Host ($) 
Mandiant + Fireeye 
+ iSIGHT Partners ($) 
iDEFENSE ($) 
Dell SecureWorks ($) 
CrowdStrike ($) 
LookingGlass ($) 
Maltego (FREE / $) 
DomainTools IRIS ($) 
ThreatCrowd (FREE) 
PassiveTotal (FREE / $) 
FireEye MVX ($) 
Damballa ($) 
Lastline ($) 
ThreatTrack ($) 
ThreatGRID ($) 
Cuckoo (FREE)  
Threat Connect (FREE/ $) 
MISP (FREE) 
MITRE CRITS (Free) 
IBM X-Force ($) 
EclecticIQ Platform ($) 
ThreatScap ($) 
STIX (FREE) 
TAXII (FREE) 
CybOX (FREE) 
TAXII (FREE) 
Libtaxii TAXII Library (FREE) 
Yeti TAXII Server (FREE) 
• Community driven threat intelligence platform 
• Every instance of ThreatConnect includes 
access to Public Cloud Common Community.  
• Provide API, Threat Connect Marketplace 
• Malware information sharing platform 
• Storing and sharing Indicators of 
compromise (IP, domain, hashes) 
• Open source platform model (available 
on Github) 
• Sharing information between MISP 
instances 
Conclusion 
• Cyber Threat Intelligence provides researched and analyzed 
knowledge about adversaries to help quickly adapt to an ever-
changing threat landscape. 
• The most important source of relevant threat data of an organization 
is your own attack surface. 
• Threat Intelligence Platform fusing internal and external sources, 
facilitating analysis and support your actions. 
Q&A