### 02 安全架构

**Gartner定义的安全架构**：
安全架构是规划和设计组织内各组件（包括概念、逻辑和物理层面）的规程及相关过程。这些组件以一致的方式相互作用，并与业务需求相适应，从而实现并维持一种可管理的安全相关风险状态。

**ISF报告中的安全架构定义**：
安全架构是一系列表示形式，描述了环境中安全组件的功能、结构及其相互关系。安全组件可能因架构类型而异，但通常包括安全控制措施、安全服务（如身份验证、访问控制等）和安全产品（如防火墙、入侵检测系统等）。

在实战攻防演练中，经常暴露出许多应用层问题，例如高危框架或中间件、第三方开源组件漏洞、安全配置错误、设计不当、API未经授权访问等业务逻辑问题以及敏感数据保护不足等。安全人员面临的主要挑战是如何将业务问题、威胁及IT防御体系联系起来。安全架构提供了一种结构化的方法，通过向IT服务、应用程序和平台添加安全控制措施来系统性地解决安全风险问题。

在开发安全架构的过程中，会生成多种表示形式。随着业务安全需求转化为具体的安全控制措施，这些表示形式变得更加具体，形成了分层的安全架构模型。

### 安全架构的设计方法

安全架构的设计可以参考各种方法论或框架。框架是一组系统的控制点和实践组合，侧重于“做什么”；而方法论则是一系列从起点到目标的具体实施步骤，侧重于“如何做”。

**SABSA**是一个典型的安全架构方法论，基于Zachman企业架构方法论构建，采用类似的结构称为SABSA矩阵，用于帮助描述组成安全架构的视图和组件。NIST CSF则是另一个广泛使用的通用框架，它提供了一种为组织定义逻辑安全架构的方法，使用户能够识别业务活动中的网络安全风险，并据此构建一个控制能力概要。

### 安全设计原则

在安全架构设计中，遵循安全设计原则至关重要。其中最为经典的理论是由MIT的Saltzer教授于1975年提出的八大安全设计基本原则，被业界奉为“经典安全原则”。经过多年的实践和发展，在原有八大原则的基础上又衍生出了一些新的原则，例如“纵深防御”、“不要轻信”、“保护薄弱环节”、“提升隐私”等。

需要注意的是，并非所有安全设计原则都需要在一个系统中完全实现。某些原则之间可能存在冲突，因此需要权衡取舍。

### 威胁建模

威胁建模是一种分析应用程序安全性的结构化方法，通过识别威胁并定义相应的防御或消极威胁控制措施来进行。其主要步骤包括：

1. **识别资产**：确定必须保护的有价值资产，如敏感数据和个人隐私信息。
2. **创建架构概述**：绘制系统架构图，标识子系统、信任边界和数据流，以便更好地理解系统架构。
3. **分解应用程序**：根据架构图和功能需求描述进行数据流分析，绘制数据流图，识别关键技术、信任边界及系统入口。
4. **威胁识别**：使用威胁列表、攻击树或STRIDE方法等技术识别潜在威胁。STRIDE是一种常用的威胁分类方法，将威胁分为六类：仿冒、篡改、抵赖、信息泄露、拒绝服务和权限提升。
5. **记录威胁**：根据已识别的威胁提出缓解措施并记录下来。
6. **评估威胁**：采用DREAD风险模型对威胁进行优先级排序，确保首先解决最重要的威胁。

### 安全架构设计实践

以某证券机构金融APP为例，讲解如何通过轻量级威胁建模进行安全架构设计。该产品是一款支持移动客户端和Web页面的一体化服务平台，面向内部员工、外部客户及第三方机构。通过对项目组进行问卷调研，了解系统的关键信息后，进行攻击面分析及威胁建模。调研内容涵盖系统架构、使用场景、重要数据和部署方式等方面。最终，基于调研结果制定出一套全面的安全设计方案，旨在保护信息资产，确保信息安全三要素CIA（机密性、完整性和可用性）得到满足。