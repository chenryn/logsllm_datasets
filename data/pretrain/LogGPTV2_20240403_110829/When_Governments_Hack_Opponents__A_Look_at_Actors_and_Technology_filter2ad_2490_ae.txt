ac-
call,”
[Online]. Available:
2013,
cessed:
http://bit.ly/1aRUZ4b
[31] “Unionist Questioned,” 2013, accessed: 23-April-2013.
[Online]. Available: http://bit.ly/1gHnBiS
[32] N. Villeneuve, “Fake Skype Encryption Service Cloaks
DarkComet Trojan,” Apr. 2012, accessed: 4-August-
2013. [Online]. Available: http://bit.ly/17SpA1c
[33] E. Galperin and M. Marquis-Boire, “Fake YouTube
Site Targets Syrian Activists With Malware,” Mar.
2012, accessed: 4-August-2013. [Online]. Available:
http://bit.ly/HSCRet
[34] ——, “New Wave of Facebook Phishing Attacks Targets
Syrian Activists,” Apr. 2012, accessed: 4-August-2013.
[Online]. Available: http://bit.ly/1hDQsG8
[35] ——, “Pro-Syrian Government Hackers Target Activists
With Fake Anti-Hacking Tool,” Aug. 2012, accessed:
4-August-2013. [Online]. Available: http://bit.ly/1eJj12T
[36] J. Scott-Railton and M. Marquis-Boire, “A Call to Harm:
New Malware Attacks Target the Syrian Opposition,”
Citizen Lab, Tech. Rep., Jun. 2013, accessed: 3-August-
2013. [Online]. Available: http://bit.ly/1a2l9PK
[37] E. Galperin and M. Marquis-Boire, “Trojan Hidden
in Fake Revolutionary Documents Targets Syrian Ac-
tivists,” May 2012, accessed: 4-August-2013. [Online].
Available: http://bit.ly/1cSJT0
[38] M. Marquis-Boire and S. Hardy, “Syrian Activists Tar-
geted with BlackShades Spy Software,” Jun. 2012,
accessed:
[Online]. Available:
http://bit.ly/1a2l6mX
12-November-2013.
[39] S. Fagerland,
accessed:
http://bit.ly/HLyGR9
“The Syrian Spyware,” Feb. 2012,
4-August-2013.
[Online]. Available:
[40] Telecomix, “REPORT of a Syrian spyware,” p. 9, Feb.
2012, accessed: 4-August-2013. [Online]. Available:
http://bit.ly/1bsNcIk
[41] S.
Faris,
“The Hackers
of Damascus,” Nov.
2012, accessed: 9-August-2013. [Online]. Available:
http://buswk.co/17t8RRH
[42] L. Aylward, “Malware Analysis—Dark Comet RAT,”
Nov. 2011, accessed: 4-August-2013. [Online]. Avail-
able: http://bit.ly/16ZXgag
[43] Quequero, “DarkComet Analysis—Understanding the
Trojan used in Syrian Uprising,” Mar. 2012, accessed:
4-August-2013. [Online]. Available: http://bit.ly/19i6kEl
USENIX Association  
23rd USENIX Security Symposium  523
13
[44] S. Denbow and J. Hertz, “Pest Control: Taming the
RATs,” p. 14, accessed: 12-November-2013. [Online].
Available: http://bit.ly/1fzLA0m
[63] “Ultimate
Packer
for
cessed:
http://upx.sourceforge.net/
27-February-2014.
ac-
eXecutables,”
[Online]. Available:
[45] B. Brumﬁeld, “Computer spyware is newest weapon in
Syrian conﬂict,” Feb. 2012, accessed: 4-August-2013.
[Online]. Available: http://cnn.it/HLz5TA
[46] “jalnosra.com,” accessed: 27-February-2014. [Online].
Available: jalnosra.com
[47] “Skype Encryption.wmv,” accessed: 27-February-2014.
[Online]. Available: http://bit.ly/HZ3e1y
[48] E. Galperin and M. Marquis-Boire, “The Internet
is Back in Syria and So is Malware Targeting
Syrian Activists,” Dec. 2012, accessed: 4-August-2013.
[Online]. Available: http://bit.ly/1bngqFc
[49] “Free Syrian Army Sex Tape—Abdul Razzaq Tlass
[NSFW],” accessed: 5-August-2013. [Online]. Available:
http://bit.ly/1gHqDDH
[50] A. Lund, “Holy Warriors: A ﬁeld guide to Syria’s jihadi
groups,” Oct. 2012, accessed: 5-August-2013. [Online].
Available: http://atfp.co/17t8yq5
[51] “Ahmed Mansoor and Four Other Pro-Democracy
ac-
[Online]. Available:
Pardoned
10-November-2013.
Freed,”
2013,
and
Activists
cessed:
http://bit.ly/18pHpis
[52] “Royal Group,” accessed: 27-February-2014. [Online].
Available: http://www.royalgroupuae.com/
[53] T. Katsuki, “Crisis for Windows Sneaks onto Virtual
Machines,” 2012, accessed: 27-February-2014. [Online].
Available: http://bit.ly/MzheRJ
[54] “Hacking Team,” accessed: 27-February-2014. [Online].
Available: http://www.hackingteam.it/
[55] “MPRESS,” accessed:
27-February-2014.
[Online].
Available: http://www.matcode.com/mpress.htm
[56] “Sign
in
accessed:
https://support.google.com/accounts/answer/185833?hl=en
passwords,”
[Online]. Available:
using
27-February-2014.
application-speciﬁc
[57] S. Fagerland, “Systematic cyber attacks against
Is-
raeli and Palestinian targets going on for a year,”
2012, accessed: 12-November-2013. [Online]. Available:
http://bit.ly/1aSdw07
[58] V.
Silver,
to Beaten
“Spyware Leaves Trail
Flaw,”
2012,
ac-
[Online]. Available:
Activist Through Microsoft
cessed:
14-November-2013.
http://bloom.bg/1ja2geI
[59] B. Hubbard, “Emirates Balk at Activism in Region
Hit by Uprisings,” 2013, accessed: 14-November-2013.
[Online]. Available: http://nyti.ms/I4n2Aw
[60] “SPY NET,” accessed:
27-February-2014. [Online].
Available: http://newspynetrat.blogspot.com/
[61] “Asprotect SKE,” accessed: 27-February-2014. [Online].
Available: http://www.aspack.com/asprotect32.html
2010,
[62] “Unpacking VBInject/VBCrypt/RunPE,”
[Online].
7-August-2013.
ac-
Available:
cessed:
http://bit.ly/1e28nS2
[64] “CVE-2013-0422,” accessed: 27-February-2014. [On-
line]. Available: http://bit.ly/NA1O0A
[65] njq8, “New java drive-by 2013-1-11,” 2013, accessed:
27-February-2014. [Online]. Available: http://www.dev-
point.com/vb/t357796.html
[66] “Appin Technology Lab,” accessed: 27-February-2014.
[Online]. Available: http://www.appinonline.com/
[67] C. Guarnieri,
“Analysis of
the FinFisher Lawful
Interception Malware,” 2012, accessed: 7-August-2013.
[Online]. Available: http://bit.ly/1eJjVMV
[68] H. Moore, “Critical Research: Internet Security Survey,”
2012.
[69] “Democracy Index 2012: Democracy at a Standstill,”
2012, accessed: 7-August-2013. [Online]. Available:
http://bit.ly/HSEDMD
[70] “YARA - The pattern matching swiss knife for malware
[Online].
27-February-2014.
researchers,” accessed:
Available: http://plusvic.github.io/yara/
[71] “Cross-platform Trojan controls Windows and Mac
machines,” 2012, accessed: 7-August-2013. [Online].
Available: http://bit.ly/1eJnJgZ
[72] S. Golovanov, “Adobe Flash Player 0-day and Hack-
ingTeam’s Remote Control System,” 2013, accessed:
7-August-2013. [Online]. Available: http://bit.ly/17n12ro
[73] “Internet Census 2012,” 2013, accessed: 7-August-2013.
[Online]. Available: http://bit.ly/1i7rRHs
[74] Z. Durumeric, E. Wustrow, and J. A. Halderman, “ZMap:
Fast Internet-Wide Scanning and its Security Applica-
tions,” in USENIX Security, Aug. 2013.
of
[75] “Home
cessed:
https://pki.net.in.tum.de/
Crossbear
27-February-2014.
and OONIBear,”
ac-
[Online]. Available:
[76] “RIPE Database Query for FASTWEB-HT,”
cessed:
http://bit.ly/MzkigV
27-February-2014.
ac-
[Online]. Available:
[77] “How Government-Grade Spy Tech Used A Fake Scandal
To Dupe Journalists,” 2012, accessed: 7-August-2013.
[78] A. Ornaghi, “em-http-server,” accessed: 27-February-
2014. [Online]. Available: https://github.com/alor/em-
http-server
[79] SophosLabs,
“Anatomy
attack—
SophosLabs explores an Adobe zero-day “malware
experiment”,” 2013, accessed 7-August-2013. [Online].
Available: http://bit.ly/HQ1oRc
targeted
of
a
[80] K. Zetter,
“American Gets Targeted by Digital
2013,
[Online]. Available:
Spy Tool Sold to Foreign Governments,”
accessed:
http://wrd.cm/1fHonth
14-November-2013.
[81] M. Marquis-Boire and B. Marczak, “From Bahrain
With Love:
Jul.
2012, accessed: 4-August-2013. [Online]. Available:
http://bit.ly/1bngpB2
FinFisher’s Spy Kit Exposed?”
524  23rd USENIX Security Symposium 
USENIX Association
14
A FinSpy ﬁngerprints
in response to a request such as GET /,
Previous work by Guarnieri on scanning for FinSpy servers
found that
the
Bahraini FinSpy C&C server returns a response with the string
“Hallo Steffi” [67]. Guarnieri searched a database of
such responses compiled by the Critical.IO Internet scanning
project [68], locating 11 additional servers in 10 countries [67].
We refer to this ﬁngerprint as α1. Concurrent with this ef-
fort, we devised our own ﬁngerprint β1 that tested three as-
pects of the handshake between a FinSpy infectee and a Fin-
Spy C&C server, which follows a custom TLV-based protocol
running on ports such as 22, 53, 80, and 443. We conducted
targeted scanning of several countries using β1, and also con-
ﬁrmed Guarnieri’s ﬁndings for those servers still reachable af-
ter he published his ﬁndings.
We observed a trend: changes in HTTP response behavior
by FinFisher after publication of ﬁndings about the software.
In July 2012, for example, after a post about Bahraini FinSpy
samples [81], servers closed the TCP connection in response
to a GET / or HEAD / request (although servers continued
to behave consistently with β1. Other changes followed later
in 2012, including a new response to GET / requests that in-
cluded an imperfect copy of an Apache server’s HTTP response
(the Date header used UTC rather than GMT). We ﬁngerprinted
this error as α2, and later in 2012 ﬁngerprinted other distinctive
behavior in response to GET / requests as α3.
Subsequent scans of /0 for α2 and α3, and ﬁve service
probes of the Internet Census for α1 through α3, located several
additional servers. In Feburary 2013 we identiﬁed and ﬁnger-
printed new HTTP response behavior with α4 and modiﬁed β1
to produce β2, which tests only two of the three aspects of the
FinSpy handshake (the third test of β1 was broken when Fin-
Spy servers were updated to accept types of invalid data they
had previously rejected).
As of 3/13/13, all servers that matched any α ﬁngerprint
matched β2.
USENIX Association  
23rd USENIX Security Symposium  525
15