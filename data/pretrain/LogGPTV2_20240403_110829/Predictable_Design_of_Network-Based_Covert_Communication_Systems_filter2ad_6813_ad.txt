sage length is to choose a value that is half the total number
of exploit symbols, or 2n−1. The message length is there-
fore set at 128 bits.
From the design decisions above, the system metrics can
now be predicted. Figure 10 illustrates the predicted prob-
ability of detection and reliability as a function of exploit
signal-to-noise ratio. The operational SNR is deﬁned as the
cross-over between detectability and reliability. From the
graph this is determined to be 0.045; where the probability
of channel detection is estimated to be 0.81% and the bit
error rate is estimated to be 0.36%.
With an operational signal-to-noise ratio of 0.045 this
implies that the sending host injects exploit symbols at a
rate of 45 per 1000 naturally occurring exploit symbols. The
rate of natural occurrence of exploit symbols is the overall
exploit symbol proportion, νs, and from above is 8.39%.
Therefore overall injection rate becomes 0.00378.
Inter-
preting this result, a symbol injector should release signals
(symbols) into the background trafﬁc at a rate of about 38
per 10000 packets. Completing the analysis, it is known
from Equation 5 that the optimal sample size for the war-
den is given by
No = (cid:98)L/(νsSN Ro)(cid:99) ≈ 33, 900 symbols(packets).
319
Figure 9. Representative Packet Sizes in
Wireless Encrypted Trafﬁc [18]
message length. The system is validated by transmitting ar-
bitrary messages across the channel and observing the em-
pirical results as compared to those predicted.
The exploit ﬁeld chosen for the experiment is the 16-
bit packet size ﬁeld of a link layer protocol implementation
for encrypted wireless data. Figure 9 depicts the number
of occurrences of each packet size value for a period of
approximately 40 minutes of trafﬁc as recorded outbound
from a single host. Approximately 35,000 total packets
were recorded.
An analysis of the packet size data reveals a set of about
260 good candidate packet sizes for use as exploit symbols.
Among the set of candidate symbols, the probability of oc-
currence of each symbol ranges from 0.000266 to 0.000387
with an average of 0.000328. The resultant covert channel
is typical of that described above, namely that it is charac-
terized as one where the predominant error type is that of
symbol insertions.
The selection of an appropriate code is guided by the
total available candidate exploit symbols. Ideally the code
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 03:11:17 UTC from IEEE Xplore.  Restrictions apply. 
     802.11 - Observed Encrypted Data (WPA2-AES) Packet Traffic - Single PC Outbound050100150200250300350400450801291782272763253744234725215706196687177668158649139621011106011091158120712561305135414031452150115501599Packet Length# of occurances  Implementing the experiment involves transmitting an
arbitrary 128-bit message across this representative chan-
nel. A channel encoder uses the Square Toroid of Octagons
code to encode the message. A channel modulator maps
the outputs of the encoder (code symbols) one-to-one onto
the chosen exploit symbols. A symbol injector releases one
signal for roughly every 263 packets of background trafﬁc.
At the receiver, a channel demodulator extracts from the
received packets only those containing exploit symbols; in
other words only those where packet size values are from
the exploit symbol set. A channel decoder takes as input
the sequence of exploit symbols and decodes until it ﬁnds
a message of length 128; the message length is an assumed
shared secret between sender and receiver.
The experiment was run 100 times. The empirical reli-
ability was computed as the total number of bits decoded
correctly over the total number of bits decoded. From this
the observed BER was 0.25%. To conﬁrm the probability
of detection the observed number of each exploit symbol
was recorded and then compared to the upper control limit,
U CL, from Equation 5. If any exploit symbol count ex-
ceeded the U CL, it is considered an indicator of detection.
For each trial, the observed number of each exploit symbol
within the optimal sample size was compared to the U CL.
Over the 100 trials, a total of 0 detections were observed
across all exploit symbols. For the 100 trials conducted, the
maximum counts of any exploit symbol ranged from 17 to
20, and in only a single instance were 20 exploit symbols
counted; 65% of the time the highest count was 18, well
below the UCL limit of 21.
5. Conclusion
A unique design methodology for network-based covert
communication systems has been proposed. A quantita-
tive measure of the probability of detection has been devel-
oped for a generic storage-based network covert channel.
A general methodology for the design of error-correcting
codes for high numbers of symbol insertion errors has been
demonstrated, and a family of error-correcting codes have
been developed based upon the methodology. A general
expression for the reliability of the family of codes has
been developed. Finally, a system design experiment has
demonstrated the feasibility and predictability of the ap-
proach; the BER was predicted to be 0.36% while observed
to be 0.25%, and the detectability was predicted to be 0.81%
while observed to be 0%.
An expression for the efﬁciency (or throughput) of the
system has also been derived by the authors. The type of
channel formed by the experimental design yields a low
system efﬁciency; at most one bit of message is transmitted
in each packet sent. Designs of both higher efﬁciency
exploits and codes is currently being pursued. Extensions
to the trellis codes to support extremely low levels of SNR
are being investigated. Techniques for detecting these types
of channels are also being explored.
Acknowledgment The authors would like to thank
Dr Paul Van Oorschot of Carleton University for his
insightful comments on this work. This work was sup-
ported, in part, by MITACS through its research project
entitled, Understanding and Mitigating Malicious Activity
in Networked Computer.
References
[1] C. Abad.
Ip checksum covert channels and se-
http://www.gray-
lected hash collision. Web Site.
world.net/papers/ipccc.pdf, last visited April 2006.
[2] M. Allman and V. Paxson. On estimating end-to-end net-
work path properties. In ACM SIGCOMM 99, Sept. 1999.
[3] K. Ashan. Covert channel analysis and data hiding in
TCP/IP. Masters thesis, Department of Electrical and Com-
puter Engineering, University of Toronto, 2002.
[4] S. Cabuk, C. Brodley, and C. Shields. IP covert timing chan-
nels: Design and detection. CCS 2004, Oct. 2004.
[5] C. Cachin. An information-theoretic model for steganog-
In D. Aucsmith, editor, Proceedings of 2nd Work-
raphy.
shop on Information Hiding, volume 1525, Portland, Ore-
gon, USA, May 1998. Lecture Notes in Computer Science,
Springer.
[6] T. N. C. S. Center. A guide to understanding covert channel
analysis of trusted systems. NCSC-TG-030, Library No.S-
240,572, Version 1, Fort George G. Meade, Maryland, Nov.
1993.
[7] N. Computer Security Center.
Covert channel capac-
ity limit policy. NCSC Interpretation of TCSEC0113.
http://www.radium.ncsc.mil/tpep/library/interps/0113.html,
last visited June 2004.
[8] M. Davey and D. MacKay. Reliable communication over
channels with insertions, deletions and substitutions. IEEE
Transactions on Information Theory, 47(2):687–692, Feb.
2000.
[9] G. Drawson. Temporal interval modulation: An investiga-
tion into the modulation of packet timings as a means of
generating a detectable watermark. Masters thesis, Royal
Military College of Canada, Apr. 2002.
[10] J. Gifﬁn, R. Greenstadt, P. Litwack, and R. Tibbetts. Covert
messaging through TCP timestamps. In Workshop on Pri-
vacy Enhancement Technologies (PET), Apr. 2002.
[11] C. Girling. Covert channels in lan”s. IEEE Transactions on
software Engineering, SE13(2):292–296, Feb. 1987.
[12] T. Handel and M. Sandford. Hiding data in the OSI network
model. In First International Workshop on Information Hid-
ing, June 1996.
[13] D. Hintz. Channels in TCP and IP Headers. PowerPoint Pre-
sentation. http://guh.nu/projects/cc/, last visited November
2007.
[14] M. Kang, I. Moskowitz, and D. Lee. A network version
In Proceedings of the IEEE Symposium on
of the pump.
Security and Privacy, pages 144–154, 1995.
320
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 03:11:17 UTC from IEEE Xplore.  Restrictions apply. 
[15] B. Lampson. A note on the conﬁnement problem. Commu-
[33] R. Togneri and C. deSilva. Fundamentals of Information
Theory and Coding Design. Chapman & Hall, 2002.
[34] A. Viterbi and J. Omura. Principles of Digital Communica-
tions and Coding. McGraw-Hill, New York, 1979.
[35] H. Wadsworth, K. Stevens, and A. Godfrey. Modern Meth-
ods for Quality Control and Improvement. John Wiley &
Sons, 1986.
[36] X. Wang, D. Reeves, S. Wu, and J. Yuill. Sleepy watermark
tracing: An active network-based intrusion response frame-
In Proceedings of the IFIP TC11 Sixteenth Annual
work.
Working Conference on Information Security, pages 369–
384, June 2001.
[37] M. Wolf. Covert channels in LAN protocols. In Proceedings
of the Workshop on Local Area Network Security, pages 91–
102, 1989.
[38] Y. Zhang, N. Dufﬁeld, V. Paxson, and S. Shenker. On the
In Proceedings of
constancy of internet path properties.
the ACM SIGCOMM Internet Measurement Workshop, Nov.
2001.
nications of the ACM, 1973.
[16] V. I. Levenshtein. Binary codes capable of correcting dele-
tions, insertions, and reversals. Doklady Akademii Nauk
SSSR, 163(4):845–848, 1965. English translation in Soviet
Physics Doklady, vol. 10 no. 8 pp:707710, 1966.
[17] S. Lin and D. C. Jr. Error Control Coding: Fundamentals
and Applications. Prentice-Hall, New Jersey, 1983.
[18] P. Martin. Covert channels in secure wireless networks.
Master’s thesis (draft) not available as of March 2007, Royal
Military College of Canada, 2007.
[19] J. Millen. 20 years of covert channel modeling and analy-
sis. In IEEE Symposium on Security and Privacy, Oakland,
California, May 1999.
[20] I. Moskowitz and M. Kang. Covert channels - here to stay?
In Proceedings COMPASS ’94, pages 235–243, Gaithers-
burg, MD, 1994.
[21] I. Moskowitz,
R. Newman, D. Crepeau,
and
Covert channels and anonymizing net-
A. Miller.
the Workshop on Privacy
works.
in the Electronic Society (WPES 2003), Oct. 2003.
http://chacs.nrl.navy.mil/publications/CHACS/2003/
2003moskowitz-acm5.pdf,last visited April 2006.
In Proceedings of
[22] I. Moskowitz, R. Newman, and P. Syverson. Quasi-
In Proceedings CNIS 2003, Dec.
anonymous channels.
2003. http://chacs.nrl.navy.mil/publications/CHACS/2003/
2003moskowitz-5 3.pdf,last visited April 2006.
[23] V. Paxson.
End-to-end internet packet dynamics.
IEEE/ACM Transactions on Networking, 7(3):277–292,
June 1999. An earlier version appeared in Proc. ACM SIG-
COMM ´97, September 1997, Cannes, France.
[24] E. Ratzer. Marker codes for channels with insertions and
deletions.
to be presented at the 3rd International Sympo-
sium on Turbo Codes and Applications, Munich, Germany,
Apr. 2006.
[25] E. Ratzer and D. MacKay. Codes for channels with inser-
In In 2nd International
tions, deletions and substitution.
Symposium on Turbo Codes and Related Topics, pages 149–
156, Apr. 2000.
[26] F. Raynal.
Covert channels.
PowerPoint Presen-
http://www.securitylabs.org/Download/lsm2003-
tation.
Raynal.pdf.gz, last visited April 2006.
[27] S. Roman. Introduction to Information and Coding Theory.
Springer Verlag, 1996.
[28] C. Rowland. Covert channels in the TCP/IP Protocol Suite.
ﬁrst Monday - a peer-reviewed journal on the Internet, 2(5),
May 1997.
[29] R.Togneri and C. deSilva. Fundamentals of Information
Theory and Coding Design. Chapman & Hall, 2002. TdS02.
[30] M. V. S.D. Servetto. Communication using phantoms:
Covert channels in the internet. In Proceedings of the IEEE
International Symposium on Information Theory (ISIT),
Washington, DC, June 2001.
[31] G. Shah, A. Molina, and M. Blaze. Keyboards and covert
channels. In Proceedings of the 15th USENIX Security Sym-
posium, Vancouver, Cananda, Aug. 2006. ACM Press.
[32] T. Swart and H. Ferreira. A note on double insertion/deletion
correcting codes. IEEE Transactions on Information Theory,
49(1):269–273, Jan. 2003.
321
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 03:11:17 UTC from IEEE Xplore.  Restrictions apply.