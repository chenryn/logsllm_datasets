Top sites
Twitter
All
53.85
0.93
34.51
26.25
52.67
58.06
0.34
10.39
1.40
56.25
Table VIII
TDS PREVALENCE PER FEED
As described in Section V-B, we identify TDSes from
their URLs, which bear unique patterns of the tool kits they
are built upon. A recent report [7] shows that just like the kits
extensively used by exploit services, there are a whole set of
off-the-shelf TDS kits that can be conveniently utilized by
adversaries to manage, administrate and log trafﬁc coming
in and out of their systems. Among them, the most popular
ones are Sutra TDS, Simple TDS, and Advanced TDS. Using
known URL patterns, we ﬁnd that the Sutra TDS kit is the
most popular one, covering 71.02% of the TDS URLs in our
set. Sutra is not a free kit, whose price ranges from $200
to $270, but it has a wide range of supported features [13].
The second most popular kit is the Simple TDS, an open
source kit that covers 10.19% of the TDS URLs.
Prevalence. In Section V-B, we show that TDSes have
taken a lion’s share among all the detected dedicated HICs:
52.67% of doorway URLs are found to send web trafﬁc to
these TDSs. Table VIII further illustrates the important roles
they play in funneling trafﬁc from different data sources. Ex-
cept Warningbird, all data sources have signiﬁcant numbers
of URLs that lead to TDSes. We also ﬁnd TDSes to be
prevalent in paths not alarmed by ForeFront.
Inbound Trafﬁc. Over 97.1% of TDSes receive web trafﬁc
directly from doorways while only 6.37% of them get trafﬁc
from non-doorway redirectors. For the doorways that bring
trafﬁc to TDSes, some of them are intentional, e.g, adult
sites. Many others are compromised sites.
Figure 12 shows the cumulative percentage of new door-
way domains and IP addresses that bring trafﬁc to TDSes
during our crawling period. We can clearly see a step
function, which shows that doorway domains are often com-
promised and set up by attackers in batches and correspond
to different attack campaigns. Thus, studying the incoming
trafﬁc to TDSes can also be used to detect attack campaigns.
It is also worth noting that there is sharing of IP addresses
among compromised doorway domains. In total there are
18,369 new doorway pages and 12,711 unique IP addresses.
e
g
a
t
n
e
c
r
e
p
e
v
i
t
a
u
m
u
C
l
1
0.8
0.6
0.4
0.2
0
24-Dec
Doorway Domains
Doorway IP addresses
12-Feb
2-Apr
22-May
11-Jul
30-Aug
Date 
Figure 12. Cumulative percentage of new doorway domains and IPs that
redirect trafﬁc to TDSes during our 7 months of crawling.
TDS Status
Parked
Inactive Suspended
TDSes Appear to be down
Active Redirecting to search engines
TDSes Redirecting to None search engines
All TDSes
TDS
TDS
TDS
URLs(%) hosts(%) Paths(%)
69.66
12.69
8.58
0.03
15.50
126,180
23.9
12.25
55.65
1.14
21
3,168
51.07
4.91
2.58
0.004
41.43
2,211,291
LANDSCAPE OF TDS OPERATION. PERCENTAGES ARE CALCULATED TO
Table IX
THE TOTAL OF ALL TDSS
Outbound Trafﬁc. During our crawling, we ﬁnd that some
TDSes would not redirect trafﬁc further to other websites.
We call them inactive TDSes. These inactive TDSes can
be suspended for resell, parked, or appears to be down (not
resolving to an IP address or send back error response code).
Table IX shows the breakdown among the inactive TDSes.
A majority (69.66%) of the TDS URLs are parked, 12.69%
are suspended and 8.58% appear to be down by either giving
us error codes or not resolving.
Note that the TDSes giving us error response codes may
not be truly inactive. Actually, it is reported that TDSes
tool kits can perform IP ﬁltering [13] [7]. This ﬁnding has
also been conﬁrmed by our analysis of the Simple TDS
kit. Indeed, we have observed that among the TDSes that
have been crawled multiple times, some of them lead to
exploit servers when we ﬁrst crawl them, but later give
404 responses or forward the crawler to google.com on
subsequent visits. A more detailed look into the intersection
between the live TDSes and the TDSes of other categories
is provided in Table X where we ﬁnd that 23.08% of the live
TDSes are taken down in subsequent visits. Note that our
122
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:54:53 UTC from IEEE Xplore.  Restrictions apply. 
subsequent visits happen only when the same TDS appears
in another path for a later crawl.
In parked hosts
In suspended hosts
In hosts not resolving
In hosts responding with error codes
21 (3.11%)
0
156 (23.08%)
205 (30.33%)
ACTIVE TDSES APPEARING IN OTHER CATEGORIES
Table X
We further study attack types associated with the active
TDS paths, except those that cloak by leading to search
engines. 49.11% of them are found to connect to exploit
servers, 3.40% go to scam sites, and 60.80% of them redirect
to the places whose attack types cannot be conﬁrmed. The
percentages here do not add up to 100%, as some TDS hosts
lead to multiple types of attacks.
B. TDS hosting infrastructure
As discussed before, we study TDSes as a representative
of topologically dedicated hosts. For this type of services,
a question we hope to answer is how these services, at
least their domains, are hosted. In our research, we ﬁnd that
these TDS hosts extensively utilize free web services like
free domain providers and dynamic DNS (DDNS) providers.
DDNS providers such as freetcp.com let users register
sub-domains (e.g.,aaa.freetcp.com) and resolve them to the
users’ own IPs. Similarly, free domain providers such as
uni.me also give away sub-domains for free, but unlike
DDNS services, they offer free hosting on their IP addresses.
To quantify the TDSes hosted by different infrastruc-
tures, we utilize a few known lists to identify free domain
providers, DDNS providers, and URL shorteners. The lists
are downloaded from malwaredomains.com, which are
updated on a daily base. Using these lists, we ﬁnd that
26.44% of the TDSes use DDNS, 14.39% use free domain
providers and 0.7% use URL shortners. Please note that
these ﬁgures are lower bounds because the lists could be
incomplete. The actual number can be higher.
Additionally, we ﬁnd that many TDSes share IP addresses.
The top 12% of the IP addresses cover 21.5% of the TDSes.
More interestingly, many of these TDSes’ IP addresses share
IP preﬁxes:
the top 5 (out of 131) autonomous system
numbers (ASN) associated with these TDSes belong to a
few small cloud and hosting service providers, as illustrated
in Table XI.
#
1
2
3
4
5
ASN#
16265
24940
28753
44050
21788
ASN Name
LEASEWEB
HETZNER
LEASEWEB-DE
PIN-AS
NOC-Network
Country
Number of IPs
NL
DE
DE
RU
US
45
33
19
13
10
Table XI
TOP 5 ASNS HOSTING TDSS
123
C. TDS malicious life time
During our investigations of TDSes and their operations,
we observe that, unlike exploit domains, they tend to live
long before they’re detected. In this section we attempt to
estimate their life times.
Data source. We leverage the “PassiveDNS” data set, which
contains DNS records collected by the Security Information
Exchange (SIE) [26] since April 2010. This data source
has also been used in prior research [8], where raw DNS
records for two months were used. For our study, we have
an aggregated list of records over a 2 year period through
the SIE API [25]. Each record contains two time stamps
to indicate the ﬁrst and the last times the record has been
observed to have the same value (i.e. the Rdata ﬁeld in a
DNS packet).
To identify the malicious life span of a given host, we
ﬁnd that it is not enough to only consider the time between
the ﬁrst and the last valid A record (i.e. IP address lookup)
as the prior work does [8]. This is because that even after a
malicious domain is taken down and has no valid A records
for a while, it could be acquired by a domain registrar who
wants to sell it. During the reselling period, the domain has
a valid DNS record and is resolvable. More over, after a
domain is repurchased, it may become legitimate. Therefore,
the simple way of computing the duration between the ﬁrst
and last valid DNS records would just estimate the up time
of a domain, rather than the malicious life time.
To avoid the overestimates incurred by the above ap-
proach, we take a more conservative approach to just look
for a lower bound of a host’s malicious life span. That lower
bound is estimated based on the time interval between the
ﬁrst and the last observed A records that carry at least one
of the IP address(s) of a given host as discovered by our
crawler when it is associated with malicious activities. As a
result, what we get is the malicious life span for the TDSes
whose IPs are known to our crawlers. In total, there are
1,334 hostnames for such TDSes.
Observations. Querying the “PassiveDNS” dataset for those
TDSes, we retrieve the DNS records of 1308 hosts. Table XII
lists the malicious life times per hosting type (DDNS, Free
Domain hosts and others). The standard deviations in all
categories are quite high and thus we also consider their me-
dians. The median malicious life time for the hosts running
on possibly dedicated domains (in the “neither” category)
is 65.21 days, which is much higher than most malicious
domains reported in the literature, e.g. 2.5 hours [8] . We
observed some TDS hosts live for years. For example,
tr-af.com started resolving to the same IP address since
11th Jan, 2011 and it is still up. Also interestingly, we ﬁnd
that hosts using DDNS tend to be taken down sooner than
those using free domain providers. We believe this is due
to the difference in the ways they operate. As DDNSs just
provide DNS services, when they are noticed of malicious
domains, they can simply choose to not resolving IPs for
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:54:53 UTC from IEEE Xplore.  Restrictions apply. 
such domains. For free domain providers, they provide both
DNS and hosting service. Therefore, when they are notiﬁed
of malicious domains and they see these domains still have a
lot of incoming trafﬁc (details in the next sub section), they
could choose to monetize such trafﬁc by redirecting such
trafﬁc to ad networks.
Mean
Median
Standard Deviation
Total # of TDSes
DDNS hosts
Free domain hosts
43.20 d
99.02 d
5.75 d
371
105.32 d
128.74 d
61.76 d
154
Neither
138.59 d
200.88 d
65.21 d
745
Table XII
TDS MALICIOUS LIFE TIMES IN DAYS. NEITHER INDICATES HOSTS
RUNNING ON DEDICATED DOMAINS (I.E. NOT USING DDNS OR FREE
DOMAIN PROVIDERS)
D. TDS Parking
In Section VI-A, we discovered that the TDS hosts in
51% of TDS paths were parked. Such a high presence of
domain parking warrants a closer look into the motivation
behind such behavior which we elaborate on in this section.
Before we study how these malicious domains are parked,
we ﬁrst review how regular domains are parked.
Legitimate domain parking. Parking services offer a way
for newly acquired, underdeveloped domains, or domains
reserved for future use to monetize their trafﬁc through
advertising. Domains can be parked either by setting the
authoritative name server NS record to point to that of the
parking services or using a redirector to send trafﬁc to the
parking services. Upon arriving at the parking services, there
are two ways for monetization. The traditional way is to
navigate a visitor to a page ﬁlled with sponsored contextual
ads. Recently, a new model called ZeroClick was introduced
to redirect the visitor directly to an advertiser’s Web page
in which case the visitor never lands at the parked domain.
Per parking service agreements [24], parking services
allow only real user type-in trafﬁc. They do not allow third
party sites to redirect
to parked domains. As legitimate
parked domains are not actively in use, they typically do not
receive a lot of trafﬁc, except those that share very similar
spellings with well-known sites, who get trafﬁc through
users typos.
TDS parking. TDSes receive redirections from many door-
way pages, so they naturally have a lot of incoming trafﬁc.
As doorway pages usually reside on compromised domains
owned by different entities, it is hard to clean all of them
quickly. Therefore, even if an attack is detected and the
corresponding malicious domains are taken down,
there
could still be a lot of trafﬁc leading towards TDSes.
Domainers (i.e. domain owners) smartly leverage such a
rich source of trafﬁc by purchasing those suspended domains
and monetizing their trafﬁc through domain parking. Indeed,
our dataset shows that 51.07% of the paths lead to parked
TDSes. Using the “PassiveDNS”, we identify 642 parked
TDSes by checking whether the NS (Name Server) record
or the hosting IP belongs to a parking service. The top 10
parking services and the number of TDSes parked with them
are shown in Table XIII. Among them, Bodis Parking
is the most popular parking service targeted by the new
domain owners of TDS hosts. It is used to park 263 different
TDS hosts. Besides parking services, we ﬁnd that there are
also parking managers who offer a centralized approach to
manage a portfolio of domains parked with a number of
parking services. Above.com is one such parking manager
who acts as a middle man.
Parking Service
Bodis Parking
Dopa Parking
Oversee Parking