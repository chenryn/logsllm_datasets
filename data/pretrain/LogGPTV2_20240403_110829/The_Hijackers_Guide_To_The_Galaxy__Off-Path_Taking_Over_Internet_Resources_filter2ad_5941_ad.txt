record. After a DNS response, we follow with an ICMP PTB
error, that indicates different MTU values, and repeat the re-
quest. We check if the response arrived in fragments accord-
ing to the MTU value indicated in the ICMP error message.
We performed evaluations with the following MTU values of
1280, 576, 296 and 68 bytes.
Figure 4 (Left) shows cumulative distribution of frag-
mented packet size we received after sending ICMP PTB.
Right side shows the percentage of the domains where at least
one nameserver supported a MTU smaller than the plotted
size. As can be seen, for more than 90% of the domains with
PMTUD-conﬁgured nameservers, at least one nameserver is
willing to reduce the fragment size (in response to ICMP PTB)
to almost 548 bytes, for roughly 35% domains to 296 bytes
and for 10% to 68 bytes. This essentially allows to inﬂict
fragmentation to any size needed. Our evaluations in Section
4.5 indicate that 11964 RIR customer accounts (13.6%) and
2352 Alexa domain holder accounts (22.2%) are vulnerable
to the FragDNS attack.
We analyse the attacker’s success probability of crafting
the spoofed second fragment with the correct UDP checksum
and the correct IPID value. To compute the success rate to hit
the correct UDP checksum we performed the following evalu-
ation. For each customer domain in our dataset, we query the
nameservers of each domain multiple times sending the same
DNS request (with the domain of the customer’s email and
type MX), and check if the DNS responses from the name-
servers contain the same DNS records and the same order of
DNS records, during each iteration. The computation of the
UDP checksum for each domain is described in pseudocode
in Algorithm 1. Our evaluation shows that for 1748 domains
3156    30th USENIX Security Symposium
USENIX Association
0%10%20%30%40%50%/11/12/13/14/15/16/17/18/19/20/21/22/23/24% of prefixesRIR account nameserversAlexa registrar account nameservers 0 0.2 0.4 0.6 0.8 1 050010001500    CDFFragment size (bytes) 050010001500     Provider
k
n
a
R
Mail
service
provided
by
s
R
R
I
s
r
a
r
t
s
i
g
e
R
s
r
e
d
i
v
o
r
P
S
a
a
I
s
A
C
AFRINIC
APNIC
ARIN
LACNIC
RIPE NCC
godaddy
namecheap
networksolutions
enom
name.com
Alibaba cloud
AWS
gandi
namesilo
Google Cloud
OVHCloud
Amazon AWS
-
-
-
-
-
1
2
3
6
9
10
11
12
13
14
15
1
2 Microsoft Azure
3
4
5
(7)
(8)
-
-
-
-
-
-
-
1
2
3
4
5
Alibaba Cloud
Google Cloud
IBM Cloud
Tencent Cloud
Oracle Cloud
DigitalOcean
Linode
IONOS
Hostwinds
OVHCloud
Vultr
CloudSigma
IdenTrust
digicert.com
sectigo.com
godaddy
globalsign.com
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
Self
(1)
SendGrid
Self (AWS)
outlook.com
SendGrid
Mailchimp
Postmark
Mailchimp
Trend Micro
SendGrid
Resolver
Seen Via
Accept Fragment
BGP
DNSSEC
#
service
provided by
p
u
n
g
i
S
Self
Self
Self
Self
Self
Self
SendGrid
Self
Self, Google
Self (AWS)
Self
Self
Self
Self
Self
Self
Self
outlook.com
Self
Self
SendGrid
Self
Self
3
1
4
1
3
3
64
1
17
8
11
46
3
2
120
4
46
373
11
120
51
13
9
8 Mailchimp
2
2
15
4
8
6 Mailchimp
Self
Self
OpenDNS
Self
Self
114
137
10
3
35
Trend Micro
Self
SendGrid
Self
Google







(3)


















(3)





(3)


.
c
e
R
W
P













(1)
(1)




(1)
(1)

(1)


(1)




(1)



(1)
0
0
5
1
0
8
2
1
6
7
5
2
9
2
8
6
-
x
ﬁ
e
r
p
e
z
i
s
o
d
    
    
    
    
    

-
    

  
-
-
 
    
    
    
    
    
-
 
-


    
-
-
 