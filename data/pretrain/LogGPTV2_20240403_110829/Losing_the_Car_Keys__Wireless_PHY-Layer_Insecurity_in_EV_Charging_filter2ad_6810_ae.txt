current e-mobility charging infrastructure,
https://blog.deepsec.net/deepsec2016-
talk-security-privacy-current-e-mobility-
charging-infrastructure-achim-friedland/.
[36] Harald T Friis. A note on a simple transmission for-
mula. proc. IRE, 34(5):254–256, 1946.
[37] Flavio D Garcia, David Oswald, Timo Kasper, and
Pierre Pavlid`es. Lock it and still lose iton the (in) se-
curity of automotive remote keyless entry systems. In
25th USENIX Security Symposium, 2016.
[38] Jonathan M. Gitlin. Electrify america will deploy
2,000 350kw fast chargers by the end of 2019, 2018.
https://arstechnica.com/cars/2018/04/
electrify-america-will-deploy-2000-350kw-
fast-chargers-by-the-end-of-2019/.
[39] Mordechai Guri, Matan Monitz, and Yuval Elovici. Us-
bee: Air-gap covert-channel via electromagnetic emis-
In Privacy, Security and Trust (PST),
sion from usb.
2016 14th Annual Conference on, pages 264–268.
IEEE, 2016.
[40] Christina H¨ofer, Jonathan Petit, Robert Schmidt, and
Frank Kargl. Popcorn: Privacy-preserving charging for
emobility. In Proceedings of the 2013 ACM workshop
on Security, privacy & dependability for cyber vehicles,
pages 37–48. ACM, 2013.
[41] Jean-Pierre Hubaux, Srdjan Capkun, and Jun Luo. The
security and privacy of smart vehicles. IEEE Security
& Privacy, (3):49–55, 2004.
[42] InsideEVs.
Tesla model 3 with ccs combo in-
in europe, 2019.
s & x with ccs adaptor
let,
https://insideevs.com/tesla-model-3-
ccs-combo-s-x-adaptor/.
[43] InstaVolt.
https://
instavolt.co.uk/about-us/our-technology/.
technology, 2018.
Our
[44] InstaVolt Ltd. About InstaVolt, 2018.
instavolt.co.uk/.
https://
[45] INSYS MICROELECTRONICS GmbH.
INSYS
Powerline GP Manual, 2017. https://256.insys-
icom.com/bausteine.net/f/10637/HB_en_
INSYS_Powerline_GP_1711.pdf?fd=0.
[46] Rob Millerb Ishtiaq Roufa, Hossen Mustafaa,
Sangho Ohb Travis Taylora, Wenyuan Xua, Marco
Gruteserb, Wade Trappeb, and Ivan Seskarb. Security
and privacy vulnerabilities of in-car wireless networks:
A tire pressure monitoring system case study. In 19th
USENIX Security Symposium, Washington DC, pages
11–13, 2010.
[47] Road vehicles Vehicle to grid communication interface
Part 1: General information and use-case deﬁnition.
Standard, International Organization for Standardiza-
tion, Geneva, CH, 2013.
[48] Road vehicles Vehicle to grid communication interface
Part 2: Network and application protocol requirements.
Standard, International Organization for Standardiza-
tion, Geneva, CH, 2014.
[49] Mohammad Khodaei, Hongyu Jin, and Panagiotis Pa-
padimitratos. Secmace: Scalable and robust identity
and credential management infrastructure in vehicular
communication systems. IEEE Transactions on Intelli-
gent Transportation Systems, 19(5):1430–1444, 2018.
[50] Paul Klapwijk and Lonneke Driessen-Mutters. Explor-
ing the public key infrastructure for iso 15118 in the ev
charging ecosystem, 2018.
[51] Denis Foo Kune, John Backes, Shane S Clark, Daniel
Kramer, Matthew Reynolds, Kevin Fu, Yongdae Kim,
and Wenyuan Xu. Ghost talk: Mitigating emi signal
injection attacks against analog sensors. In 2013 IEEE
Symposium on Security and Privacy, pages 145–159.
IEEE, 2013.
[52] Seokcheol Lee, Yongmin Park, Hyunwoo Lim, and
Taeshik Shon. Study on analysis of security vulnerabil-
ities and countermeasures in iso/iec 15118 based elec-
In IT Convergence
tric vehicle charging technology.
and Security (ICITCS), 2014 International Conference
on, pages 1–4. IEEE, 2014.
[53] Michael Himmels. Devolo real world ﬁeld tests,
2011. http://www.homeplug.org/media/filer_
public/25/4f/254f6adb-096a-4913-842b-
91e3775da045/devolo_presentation.pdf.
USENIX Association
28th USENIX Security Symposium    421
[54] Andr´es Molina-Markham, Prashant Shenoy, Kevin Fu,
Emmanuel Cecchet, and David Irwin. Private mem-
oirs of a smart meter. In Proceedings of the 2nd ACM
workshop on embedded sensing systems for energy-
efﬁciency in building, pages 61–66. ACM, 2010.
[55] Marc M¨ultin. Das Elektrofahrzeug als ﬂexibler Ver-
braucher und Energiespeicher im Smart Home. PhD
thesis, KIT-Bibliothek, 2014.
[56] Open Fast Charging Alliance. Automatic charging start
and authorization of electric vehicles, 2017.
[57] Organisation
Internationale
Constructeurs
d’Automobiles. World Motor Vehicle Production:
World Ranking of Manufacturers, 2016.
des
[58] Johan Peeters. Fast charging just got faster. Presenta-
tion at eMove360 Conference 2017.
[59] POD Point. Open charge electric car charging stations,
2018. https://pod-point.com/open-charge.
[60] Recargo Inc.
PlugShare, 2018.
plugshare.com/.
https://www.
[61] Reuters. Paris plans to banish all but electric cars by
2030, 2017. https://www.reuters.com/article/
us-france-paris-autos/paris-plans-to-
banish-all-but-electric-cars-by-2030-
idUSKBN1CH0SI.
[62] Zeinab Rezvani, Johan Jansson, and Jan Bodin. Ad-
vances in consumer electric vehicle adoption research:
A review and research agenda. Transportation research
part D: transport and environment, 34:122–136, 2015.
[63] Matthias Schulz, Patrick Klapper, Matthias Hollick,
Erik Tews, and Stefan Katzenbeisser. Trust the wire,
they always told me!: On practical non-destructive
wire-tap attacks against ethernet. In Proceedings of the
9th ACM Conference on Security & Privacy in Wireless
and Mobile Networks, pages 43–48. ACM, 2016.
[64] Share&Charge.
Share&charge, 2019.
shareandcharge.com/.
https://
[65] Shell Plc.
Welcome to shell
recharge, 2019.
https://www.shell.co.uk/motorist/welcome-
to-shell-recharge.html.
[68] Wim Van Eck. Electromagnetic radiation from video
display units: An eavesdropping risk? Computers &
Security, 4(4):269–286, 1985.
[69] David Varodayan and Ashish Khisti.
Smart meter
privacy using a rechargeable battery: Minimizing the
rate of information leakage. In Acoustics, Speech and
Signal Processing (ICASSP), 2011 IEEE International
Conference on, pages 1932–1935. IEEE, 2011.
[70] Roel Verdult, Flavio D Garcia, and Josep Balasch.
Gone in 360 seconds: Hijacking with hitag2. In 21st
USENIX Security Symposium, pages 237–252, 2012.
[71] Brad Zarikoff and David Malone. Experiments with ra-
diated interference from in-home power line communi-
cation networks. In Communications (ICC), 2012 IEEE
International Conference on, pages 3414–3418. IEEE,
2012.
[72] Daniel Zelle, Markus Springer, Maria Zhdanova, and
Christoph Krauß. Anonymous charging and billing of
electric vehicles. In Proceedings of the 13th Interna-
tional Conference on Availability, Reliability and Secu-
rity, page 22. ACM, 2018.
[73] Kexiong (Curtis) Zeng, Shinan Liu, Yuanchao Shu,
Dong Wang, Haoyu Li, Yanzhi Dou, Gang Wang, and
Yaling Yang. All your GPS are belong to us: Towards
stealthy manipulation of road navigation systems.
In
27th USENIX Security Symposium, pages 1527–1544,
Baltimore, MD, 2018. USENIX Association.
[74] ZF Car eWallet GmbH. Car ewallet, 2019. https:
//car-ewallet.de/index.php/what-we-do/.
Appendices
A CCS Circuit Design
Figure 12 shows the communication circuit for PLC in CCS
charging systems, including the connection of the circuit to
the Control Pilot and Protective Earth lines, along with the
additional components affecting the Control Pilot line due
to the need for backwards-compatibility with the IEC 61851
communication that shares the lines.
B HomePlug GreenPHY Receiver
[66] Peter Smulders. The threat of information theft by re-
ception of electromagnetic radiation from rs-232 ca-
bles. Computers & Security, 9(1):53–58, 1990.
[67] U.S. Department of Energy Alternative Fuels Data
Centre. Alternative fueling stations, 2018. https:
//www.afdc.energy.gov/stations/.
In this section we describe our eavesdropping tool in detail.
As noted in Section 6, the tool is effectively a modiﬁed re-
ceiver design, although newly-implemented entirely in soft-
ware. Since HomePlug GreenPHY (HPGP) [5] is an orthog-
onal frequency-division multiplexing (OFDM) technology,
many elements of the tool structure are similar to a Wi-Fi
receiver.
422    28th USENIX Security Symposium
USENIX Association
Figure 12: A diagram of the CCS communication circuit.
The loads on each line connected to the PLC modem are not
balanced. Resistors R2 & R3 alter the voltage in the low-
level communication, but also vary the imbalance further.
Raw signals are ﬁrst collected using a suitable capture
device. A Rigol DSA-2302A oscilloscope was used in our
testbed arrangement, as can be seen in Figure 13. Even here
the radiated emissions were easily observed; the yellow line
in the ﬁgure represents the conducted signal, while the blue
line is the radiated signal received by a short random-wire
antenna. Although the distance shown here is very short, we
were still able to observe the signal from the other side of
the lab, several metres away. We later employed software-
deﬁned radios for signal capture, for their ability to receive
and stream a captured signal in real time.
The captured signal is ﬁltered in the frequency domain,
beneﬁting from knowledge of the active regions of the HPGP
band and the ability to survey initially an individual site’s
leakage before eavesdropping in earnest. A sharp-edged dig-
ital ﬁlter is used to remove regions with notable interference
ingress or where channel gain is so low as to provide no use-
ful information. The signal is then resampled into the HPGP
native timebase of 75MHz.
Frame Detection and Time Alignment With the signal
suitably pre-ﬁltered and digitised, the PPDUs are detected
using a Double Sliding-Window power detector; a design that
accurately identiﬁes the rise in power that accompanies the
start of a packet. The detector calculates the power of the in-
coming signal and maintains two windows A and B of equal
length L that are arranged with a time lag such that calcu-
lated power levels are included in window A at time t, sub-
sequently passing out of window A and into window B at
time t + L and out of the detector entirely at time t + 2L.
At each sample, the power in each window is updated and
Figure 13: HomePlug AV adaptors communicating across a
short wire. Conducted signals and radiated emissions can be
seen on the oscilloscope (top in yellow and bottom in blue,
respectively).
the total power in A is divided by that in B. This conﬁgura-
tion causes the output signal to spike quickly on increases in
power levels, while remaining stable at equal power levels
(i.e., prior to or during a frame). By selecting an appropriate
value of L (based on the frame’s structure), transient noise
can be prevented from triggering a frame.
OFDM requires precise time synchronisation in order to
demodulate correctly. We performed this by correlating the
entire preamble against a template, which provided sample-
accurate alignment.
CPO, SCO & Channel Estimation In practice, a trans-
mitter and receiver in an OFDM system will have nei-
ther precisely-aligned oscillators nor synchronised sample
clocks, leading to Carrier Phase Offset (CPO) and Sampling
Clock Offset (SCO). CPO causes an apparent frequency off-
set for the entire received signal, meaning that the frequency-
domain representation exhibits a phase rotation. Meanwhile,
SCO leads to an apparent phase drift across subcarriers in
the frequency domain. Both phenomena hamper demodula-
tion and must be corrected beforehand. Channel estimation
is also crucial to successful reception; assessing the gain and
phase alterations that have been experienced by the signal
due to the propagation environment.
Our receiver estimates the CPO using a method derived
from Bloessel et. al.’s work; estimating the CPO using the
seven full-amplitude SYNCP preamble symbols in place of
the Wi-Fi short-training sequence [11] (omitting the initial
USENIX Association
28th USENIX Security Symposium    423
been a 0 or 1 bit. These probabilities are expressed as a ratio,
the Log Likelihood Ratio (LLR) and then scaled according
to the gain for the subcarrier in the channel estimate, such
that the uncertainty inherent in weakly-received subcarriers
is represented.
Post Processing Demodulated soft bits are combined by
averaging to beneﬁt from HPGP’s redundancy schemes.
They are then rearranged in read-by-row-write-by-column
fashion to undo the channel interleaving process.
The FEC decoding is applied to produce hard decisions
about the bit values. HPGP uses an unpunctured Turbo code
with two systematic, rate 2
3 constituent codes. Each pair of
input bits (i, j) produces a codeword (i, j, p, q), where p and
q are parity bits, p from the in-order input and q from an
interleaved input.
Finally, the bits are unscrambled by XORing with the
same generator polynomial used in the transmitter to recover
the original sequence.
The CRC checks are computed over the received bits to
determine if the contents have been received successfully,
however the PHY-layer bits are delivered to the higher layers
irrespective as even messages containing errors may provide
useful information.
Each stage of the receiver is conﬁgurable with a wide
In particular, the power threshold to
range of parameters.
trigger PPDU capture, the frequency-domain ﬁltering, the
initial CPO estimate and the estimated noise variance for de-
modulation all permit tailoring the receiver to a given sce-
nario.
Considering the emissions as a wireless channel, the sim-
ple modulation and redundancy in HomePlug GreenPHY’s
robust (“ROBO”) transmission modes mean the attacker
need not match the channel characteristics of any particu-
lar receiver; they need only to receive the transmissions with
enough of the signal intact. Speciﬁcally, the attacker requires
a positive signal-to-noise ratio (SNR) over some fraction B of
the transmitted bandwidth. The selection of B depends upon
the transmissions mode in use and the effectiveness of any
error-correction mechanisms, however for a rough estimate
the level of redundancy can be used. Thus for MINI ROBO,
STD ROBO, HS ROBO B can be taken as 5.2MHz, 6.5MHz,
13MHz ( 1
2 of the 26 MHz HPGP bandwidth) re-
spectively.
4 and 1
5, 1
192 as they have been windowed in symbol shaping):
(cid:32)7·384
∑
i=0
(cid:33)
cpoest =
1
384
Arg
x[i]x[i + 384]
where x is the received signal samples.
From the extracted section of the preamble, complex sam-
ples are multiplied with the conjugate of the same sam-
ple in the next SYNCP block. This produces an estimate
of the phase progression introduced between those SYNCP
blocks by the mismatch between transmitter and receiver
(plus noise). Dividing through by the length of the SYNCP
block gives an estimate of the phase offset per sample. The
length of the sequence (2688) and the number of repetitions
(7) permit an accurate CPO estimate. The per-sample CPO
estimate can then be used to correct the remainder of the cap-
tured signal.
x[i] ← x[i]· e− jcpoest i
As the estimated CPO will not precisely match the actual
CPO, ongoing correction is applied to each received sym-
bol by estimating the CPO between the cyclic preﬁx and the
symbol tail, with a suitable correction being applied over that
symbol.
(cid:32) GI
∑
i=0
(cid:33)
cpoestcp =
1
3072
Arg
x[i]x[i + 3072]
where GI is the guard interval (with four values depending
on the symbol and system settings).
The channel estimation is performed in the frequency do-
main, by comparing the received preamble symbols to a
locally-computed template. HPGP provides no pilot symbols
so all estimation must be performed from the preamble and
maintained across the PPDU. The results for each preamble
symbol are averaged and a channel estimate from the active
preamble subcarriers computed. From this a channel esti-
mate for the full channel is derived by interpolation, while
the SCO is estimated from the slope of the phase differences
in the channel estimate. As the CPO and SCO are due to
hardware imperfections in the transmitter and receiver, rather
than channel properties, estimates are maintained between
received PPDUs by way of a moving average. The channel
estimate, by contrast, is discarded after a PPDU has been
received.
Demodulation Demodulation takes place in the frequency
domain (via a 3072-point DFT), after the removal of the
cyclic preﬁx for the symbol and correction for the channel
effects at each subcarrier. As HPGP uses QPSK modulation,
the receiver compares the measured value for the subcarrier
in the in-phase and quadrature channels to the nominal val-
ues and estimates, under an additive white Gaussian noise
assumption, the likelihood of the transmitted value having
424    28th USENIX Security Symposium
USENIX Association