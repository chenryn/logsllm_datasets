•
3:32:50 AM Buyer: I will have 1-2 mates from US to try out the function only.
•
3:49:50 AM NEW VERSION 2.8.2 AVAILABLE NOW: you tested with firefox?
•
3:50:12 AM Buyer: yeah
•
3:50:19 AM Buyer: and Chorme
•
3:50:43 AM NEW VERSION 2.8.2 AVAILABLE NOW: try now
•
3:51:02 AM NEW VERSION 2.8.2 AVAILABLE NOW: if 'enable bad traffic' is not checked 
it will not allow Chrome and other browsers visit the page
•
3:51:05 AM NEW VERSION 2.8.2 AVAILABLE NOW: only IE, FF, OP
•
3:51:38 AM NEW VERSION 2.8.2 AVAILABLE NOW: also its because you are visiting with 
a Mac, it is for Windows Only
•
3:52:19 AM Buyer: okay
•
4:50:01 AM Buyer: hi dude
•
4:50:13 AM Buyer: I have tried http://87.98.218.204/cn/index.php again in IE
•
4:50:16 AM Buyer: but it faile.
•
4:50:19 AM Buyer: failed
•
4:50:27 AM Buyer: Not Found message is shown.
•
4:54:18 AM NEW VERSION 2.8.2 AVAILABLE NOW: because you already visited it
•
4:54:30 AM NEW VERSION 2.8.2 AVAILABLE NOW: if your ip is already in the database it 
will show a 404 next time you visit
•
4:54:35 AM NEW VERSION 2.8.2 AVAILABLE NOW: clear the stats and you can visit again
•
4:54:52 AM NEW VERSION 2.8.2 AVAILABLE NOW: unnessicery to have duped victims
•
3:33:14 AM Buyer: do you have any readme/docs for me?
•
3:39:18 AM NEW VERSION 2.8.2 AVAILABLE NOW: go to 'settings' 
and upload exe
•
3:39:21 AM NEW VERSION 2.8.2 AVAILABLE NOW: send traffic 
to http://87.98.218.204/cn/index.php
•
3:47:52 AM Buyer: dude
•
3:47:59 AM Buyer: it is not found;
•
3:48:00 AM Buyer: http://87.98.218.204/cn/index.php
•
3:48:21 AM Buyer: do you have a handle for me call you?
•
3:48:21 AM NEW VERSION 2.8.2 AVAILABLE NOW: what browser 
you visit with?
•
3:48:25 AM Buyer: Firefox
•
3:48:51 AM NEW VERSION 2.8.2 AVAILABLE NOW: working for me
•
3:49:06 AM Buyer: Not Found
•
The requested URL / was not found on this server.
•
Main Menu
Referrer
Origin of countries
Blacklist Check
Build a Downloader
Clear Statistics
• Clear Stats
• It allows the administrator to clear up all 
statistics of latest malware deployment.
Setting?
Mission 2:  Analysis and 
Deobfuscation
The site is ready
• http://87.98.218.204/cn/index.php, 
• Aha, it is the seller’s server 
• I have uploaded a payload, simply calc.ex
– Payload characteristic
– Size: 112kb (114688 bytes) 
– md5: 829e4805b0e12b383ee09abdc9e2dc3c
Visit the site in VM
Pwned
• 114KB executable has been downloaded
How about automated scan?
• Wepaweb:  FAILED
How about automated scan?
• Jsunpack: Yeah!
• For more details and payload download, it 
could be found from the following URL: 
http://jsunpack.jeek.org/dec/go?report=f5b4
710bb96e4b9d4ea440164c2d70120299c3a3
• The password is “infected”.
More conversation
•
1:01:38 AM Buyer: does it support more obfuscation.
•
1:01:54 AM Buyer: Wepaweb cannot analyze it.
•
1:02:04 AM Buyer: however, Jsunpack could do it.
•
1:02:37 AM Crimepack 3.0-Delta available: crimepack itself does not make 
any other obfuscation due to Kaspersky detecting most of them so i 
figured out a way how to not get it detected and thats how its 
implemented
•
1:02:53 AM Crimepack 3.0-Delta available: i can take a look at jsunpack 
later, i've bypassed it quite a few times already 
•
1:04:36 AM Crimepack 3.0-Delta available: anyways im working on some 
improvements on the pack, ina few days i can give you another evaluation 
panel so you can try out the new version
•
1:04:52 AM Buyer: that's nice
•
1:05:38 AM Buyer: may be, you could allow us to import some exploits 
•
1:08:57 AM Crimepack 3.0-Delta available: yes i'm planning to add a few 
exploits for AIM (not the newest though) that hopefully will have some 
effect on US traffic, along with the Firefox 3.5 exploit, and a few activex 
control exploits
•
1:09:34 AM Crimepack 3.0-Delta available: and i'm also thinking about 
creating kind of a development framework so you can include your own 
exploits on the fly and enable/disable them
Manual” Kungfu
Syntax Error?
Ops, Document has no properties
Declare a variable type for zelslxls
instead of id name in 
• // Original: 
eS8kz…
• var zelslxls = “………”;
After executing the replace function, it is 
document.getElementById(“zeslxls”).innerHTML, 
we simply put it as “zelslxls” as it is no longer an 
id of  tag.
• //Original:
var 
mzmiycr=HeJKUePIhDF(document['pndqsqp
gpndqsqpepndqsqptpndqsqpEpndqsqplpndq
sqpepndqsqpmpndqsqpepndqsqpnpndqsqptp
ndqsqpBpndqsqpypndqsqpIpndqsqpdpndqsq
p'.replace(/pndqsqp/g,'')]("zeslxls")
.innerHTML);
• // Deobfuscated and zeslxls is not an ID of  but it 
is defined as a variable.
var mzmiycr=HeJKUePIhDF(zeslxls);
Replace the executed result “search” 
with […]
• //Original:
znknvsh['wklxnerswklxnerewklxne
rarwklxnerch'.replace(/wklxner/
g,'')](zdiubxv);
• var 
mcstfpj=znknvsh.search(zdiubxv);
Replace the executed result 
document.location.herf with any URL.
• //Original: 
return 
document['wklxnerlwklxnerowklxnerc
atwklxneriwklxnerowklxnern'.replac
e(/wklxner/g,'')].href;
• return "http://www.google.com";
Yeah!
Put it more simple
•
We have put a document.write and alert on the variable in the 
following code section with for-loop:
for (i=0;i<qfnynws.length;i+=2) {
mbtnpoq+=oragddz(ptdbrww(qfnynws[yaunsut[vfsc
kpg('vvbciksrtwlculxe','vvbcikspqioqrfjltwlcu
lxa','twlculxcvvbcikse')](/AJ/g,'')](i,zexegx
w),ptdeqea()));
}
document.write(mbtnpoq); 
alert(mbtnpoq);
We could still get the result
Mission 3: Let’s sum up
Exploit-based Crimeware
• Existing exploits
• Bundled attack
• Bypassing deobfuscation
• Bypassing AV
• Checking whether it is blacklisted.
….
Eleonore Browser Exploit Kit
http://krebsonsecurity.com/2010/01/a-peek-inside-the-eleonore-browser-exploit-kit/
GOLOD
http://malwareint.blogspot.com/2010/03/ipack-y-golod-new-on-scene-crimeware.html
iPack
Botnet-based Exploit Kit
•
Spyeye
– Made in Russia
– Formgrabbing (an advanced keylogging method of capturing web form data) 
supporting Firefox, IE, Maxthon and Netscape.
– CC Autofill (A module that, basically, automates the process of credit card 
frauds, and gives money to the owner)
– PHP-MYSQL Administration Panel
– Daily backup of the database via e-mail
– Exe String-Sources encryption
– FTP Grabbing (Total Commander, Notepad++, FileZilla, and others)
– POP3 Grabbing
– Invisible in processes list, hidden file, invisible in autorun (registry)
From:http://malwareint.blogspot.com/2010/01/spyeye-new-bot-on-market.html
Final Weapon: 0-Day Browser Exploit 
Kit
• Impassion Framework
– I try to get an trial account but failed.
– Provide 0-day exploits in IE and PDF monthly 
update.
– They claim they have the largest market share!
– 1400 EUROS/month!
– Features: 
http://malwareview.com/index.php?topic=712.0
– Watch the video from here:
• http://www.youtube.com/watch?v=F4J3SeFkzXg
Hmmm…
• Exploit kit could automate the threat 
propagation
• You simply pay it and use it, it is user friendly.
• Easy to keep track of the infection
• Allow deploy your own exploit
• Law and rule has never made it clear whether 
crimeware is illegal or not.
Bonus stage 
Mission 4: Exploit the crimeware
Google hacking or Search Malware List
• http://www.malwaredomainlist.com/mdl.php
?search=pack&colsearch=All&quantity=50
• http://www.malwaredomainlist.com/mdl.php
?search=kit&colsearch=All&quantity=50
Scan over them!
• NMAP
• Free web tools
• SQL injection
• Directory traversal
Hack them?!
• Hack them down…(hahaha, own them for 
justice?! Dude, unless your police force allows 
you to do it)
“All that is necessary for the 
triumph of evil is that good men do 
nothing.”
- Edmund Burkle
Thank you for listening
• You could reach me for the slide and a short 
paper about it at PI:EMAIL