title:Tracing Cross Border Web Tracking
author:Costas Iordanou and
Georgios Smaragdakis and
Ingmar Poese and
Nikolaos Laoutaris
Tracing Cross Border Web Tracking
Costas Iordanou
TU Berlin / UC3M
PI:EMAIL
Ingmar Poese
BENOCS
PI:EMAIL
Georgios Smaragdakis
TU Berlin
PI:EMAIL
Nikolaos Laoutaris
Data Transparency Lab / Eurecat
PI:EMAIL
ABSTRACT
A tracking flow is a flow between an end user and a Web track-
ing service. We develop an extensive measurement methodology
for quantifying at scale the amount of tracking flows that cross
data protection borders, be it national or international, such as the
EU28 border within which the General Data Protection Regulation
(GDPR) applies. Our methodology uses a browser extension to fully
render advertising and tracking code, various lists and heuristics to
extract well known trackers, passive DNS replication to get all the
IP ranges of trackers, and state-of-the art geolocation. We employ
our methodology on a dataset from 350 real users of the browser
extension over a period of more than four months, and then gener-
alize our results by analyzing billions of web tracking flows from
more than 60 million broadband and mobile users from 4 large
European ISPs. We show that the majority of tracking flows cross
national borders in Europe but, unlike popular belief, are pretty
well confined within the larger GDPR jurisdiction. Simple DNS
redirection and PoP mirroring can increase national confinement
while sealing almost all tracking flows within Europe. Last, we
show that cross boarder tracking is prevalent even in sensitive and
hence protected data categories and groups including health, sexual
orientation, minors, and others.
CCS CONCEPTS
• Information systems → Online advertising; • Security and
privacy → Privacy protections; • Networks → Network mea-
surement; Location based services; • Applied computing → Law;
ACM Reference Format:
Costas Iordanou, Georgios Smaragdakis, Ingmar Poese, and Nikolaos Laoutaris.
2018. Tracing Cross Border Web Tracking. In 2018 Internet Measurement
Conference (IMC ’18), October 31-November 2, 2018, Boston, MA, USA. ACM,
New York, NY, USA, 14 pages. https://doi.org/10.1145/3278532.3278561
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
© 2018 Association for Computing Machinery.
ACM ISBN 978-1-4503-5619-0/18/10...$15.00
https://doi.org/10.1145/3278532.3278561
1 INTRODUCTION
Online advertising, including bahavioral targeting over the Real
Time Bidding protocol (RTB) [62], fuels [26] most of the free ser-
vices of the web. In its principle, the concept of targeted (or per-
sonalized) advertising is benign: products and services offered to
consumers that they truly care about. It is in its implementation and
actual use when controversies arise. For example, tracking should
respect fundamental data protection rights of people, such as their
desire to opt-out, and should keep clear from sensitive personal
data categories, such as health, political beliefs, religion or sexual
orientation. One of the most important changes on how to process
and store personal data is the European Union General Data Protec-
tion Regulation (GDPR) [5]. GDPR offers protection to European
citizens across a wide range of privacy threats, including tracking
on sensitive categories such as those mentioned above. Now that
Europe’s new data protection law is in place (implementation date
of the GDPR across the European Union was on May 25, 2018; the
regulation entered into force on May 24, 2016), the next challenge
becomes implementing it in practice. GDPR has provisions that
include steep fines reaching up to 4% of worldwide turnover or
20 million euros, whichever is higher, for any company found in
violation. Monitoring the effectiveness of the law, investigating
complaints, and prosecuting violators can only be carried out based
on sound factual data. The measurement community, therefore,
has an important role to play in developing the necessary new
methodologies and in collecting data for GDPR related topics and
investigations.
A fast growing body of literature already exists around top-
ics such as “What information is leaking while users navigate
the web with fixed [28–30, 35, 41, 43, 44, 51, 58, 61] or mobile de-
vices?” [42, 52, 53, 60], “Who is collecting it?” [29, 52, 58], “How is it
being collected?” [27, 47, 57], “What is its financial worth?” [48, 49],
“Which are the potential hazards for citizens?” [45], etc. (see Sect. 8
for more related work). An area, however, that has received rela-
tively small attention has to do with the geographical aspects of
tracking, including questions such as: Where is the back end of a
tracker?, How far does a tracking flow go?, Which borders does it
cross?, What can be done to contain tracking within a certain data
protection jurisdiction?
Extracting the geographical footprint of trackers and tracking
flows is difficult for a number of reasons: It requires having access
to real tracking flows originating from real users and terminating
at dynamically bound trackers. The obtained sample needs to be
representative, unbiased, and complete in terms of coverage. The
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Costas Iordanou et al.
obtained measurements need to be precise, especially in terms of
geolocation accuracy.
Our contribution: In this paper, we develop a novel measure-
ment methodology for mapping the geographic characteristics of
tracking flows at scale. Our methodology is hybrid in nature – it
is using fully rendered webpages and executed tracking code to
detect tracking flows. For this we use a population of test users
from the CrowdFlower platform [4] who have installed our browser
extension. With trackers identified, we then look them up in large
NetFlow datasets from entire ISPs. Therefore, our browser exten-
sion is adding precision, and our lookup step, scale. An important
intermediate step has to do with guaranteeing the completeness
of the lookup, i.e., that we have identified all the IPs of a tracker,
and that we confirm that these IPs are dedicated for tracking. For
this we utilize DNS databases (archived passive DNS records, see
Sect. 3.3).
In summary, our methodology manages (i) to double the amount
of tracking flows detected compared to previous simpler approaches,
(ii) improve their geolocation accuracy, and (iii) monitor the track-
ing ecosystem continuously for a time period of more than four
months capturing any possible temporal variations.
Our findings: By applying our methodology on data from 350
CrowdFlower users and NetFlow data from 60M ISP subscribers,
we show that:
• Most tracking flows, typically around 90%, originating at
users within EU28 terminate at tracking servers hosted within
EU28. This result contrasts popular belief, as well as recent
studies, claiming that most tracking of European citizens
is conducted by trackers physically located outside Europe.
The discrepancy owes to geolocation accuracy, among other
reasons.
• Confinement within national borders is much lower: peaking
at less than 70% in the best case and becoming single digit
for small countries. There exists a correlation between the
density level of IT infrastructure of a country, mostly in
terms of datacenters, and the confinement of tracking flows
within its borders.
Subsequently, we turn our attention on what can be done to im-
prove the locality of tracking flows. We consider two mechanisms:
DNS redirection and PoP mirroring.
• With a more thoughtful DNS redirection on behalf of the
tracking domains administrators, the overall confinement
percentage can be improved at both, country and continent
level, at a minimal financial cost for the tracking domains.
• Applying PoP mirroring over popular public clouds also im-
proves the confinement percentage within the GDPR region,
but when applied on top of locality-improving DNS redirec-
tion, the improvement at national level is rather marginal
for all but a few countries.
Last, we look at sensitive personal data by tracing tracking flows
induced by websites involving sensitive categories, such as, ethnic-
ity and sexual orientation.
• We show that despite the threat of steep fines under GDPR,
around 3% of the total tracking flows identified, relate to
protected data categories.
• The percentage of such flows crossing borders appears to be
similar with that for general tracking traffic.
2 BACKGROUND
Before delving into technical details, we outline the current legisla-
tive and operational setting that motivate our study, and highlight
the challenges we want to overcome.
2.1 Why location matters?
As with most things, location matters also with data protection.
This may seem counter-intuitive since GDPR only requires that
an online service access a European citizen’s data to hold it ac-
countable independently of the location of its legal or technical
base. Thus a company incorporated in the US with its servers in,
for example, Singapore can still get fined if it fails to conform to
GDPR requirements while processing data of European citizens.
Then why is it important to know whether a tracking flow crosses
the EU28 borders? The answer is – investigation & enforcement.
Indeed data protection complaints can be investigated in greater
depth when a Data Protection Authorities (DPA) can be granted
legal access to the tracking backend. This is far easier done when
the tracking end point is within EU28 borders.1
But what about national borders? These are important for ju-
risdiction reasons. Although GDPR is the common data protection
law of all EU28 countries, its implementation is left to the corre-
sponding national DPAs. The national DPA is responsible for the
handling of a complaint of the citizen or legal entity filling the
complaint. Therefore, it is important to know how many tracking
flows cross national borders and where the tracking servers are
physically hosted.
Last but not least, other pieces of legislation exist that may impact
on tracking (e.g., security related, protection of minors, data or
server logs storage duration etc.), which only have a national scope.
For these cases it is also important to know whether a tracking flow
stays within national borders.
2.2 Online tracking over RTB
Figure 1 depicts a high level block diagram of the different entities
involved in targeted advertising over real-time bidding (RTB), one
of the main advertising and marketing applications that require
tracking end users across different publisher websites.2 For a de-
tailed description of the different entities, the reader is referred
to [62]. Virtually all the entities depicted in the diagram may be
present with advertising and/or tracking code at the publishers web-
site and thus, be rendered by a consumer’s browser while visiting
the publisher. The execution of such code induces tracking flows
between the consumer and the corresponding entity. Of course
there are additional flows related to tracking that are exchanged
1Notice that terminating a tracking flow within Europe does not guaranteed that
the personal data of citizens have not flown outside the continent. Once collected
by a tracker the data can be moved in any place in the world in a variety of means.
Having the terminating end-point within Europe, however, is important since it allows
a more thorough investigation to access the end-point and verify what data have been
collected and where else they have been transmitted. Data can also cross in and out of
Europe multiple times while in transit due to IP routing. In the process eavesdroppers
can take a look at them. We don’t consider such matters since they are subject to
different laws about telecommunications and surveillance.
2Open RTB [14] is the industrial standard of Interactive Advertising Bureau (IAB).
Tracing Cross Border Web Tracking
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Table 1: The real users dataset statistics.
# Users
350
# 1st party
Domains
5,693
# 1st party
Requests
76,507
# 3rd party
Domains
19,298
# 3rd party
Requests
7,172,752
3 METHODOLOGY
To address Challenge 1, we present in this section the design and im-
plementation of a browser extension for identifying tracking flows
triggered by real users’ actions and data. We also outline method-
ologies for improving the completeness and the precision of our
measurements, thereby addressing Challenges 2 and 3, respectively.
3.1 Our browser extension
To identify as many ad and tracking related domains, and their
associated IPs, as possible, requires collecting visits of real users
to websites (first-party request/domain) that embed such services.
User state information, such as their browsing history, cookies,
exact location, time of visit, etc., impact on the behavior of tracking,
e.g., through winning bids and tracking connections opened. Fur-
thermore, using real users’ browsers has the additional advantage
of capturing the interaction of the user with the elements of the
webpage, which itself alone can lead to the launching of additional
tracking requests. Finally, it is important to monitor requests from
as many geographic locations as possible, which becomes easier
when having a real user base across the globe. Many of the above
are impossible to achieve using scripted crawlers launched from few
measurement locations that do not correspond to usual residential
broadband networks and real user behavior.
To address all of the above, we have developed and distributed a
browser extension for Google Chrome. The extension is used for a
related measurement project about targeted advertising detection.
In the process, however, we obtain valuable data for this study as
well. Specifically, we can identify and monitor all outgoing third-
party requests, i.e., requests towards domains apart from the one
that the user is actually visiting during their normal browsing
sessions. For each outgoing third-party request, our extension maps
the associated server IP as observed in the corresponding response
header. Since we operate in the users’ browser, we only focus on
the final server that serves the third-party requests. The browser
API does not report on JavaScript or DNS redirections. However, it
reports the final IP that serves a request.
The small number of published reports based on measurements
from real users is indicative of the involved difficulties related with
such studies. To the best of our knowledge, apart from Razaghpanah
et al. [52] for mobile apps, this is the first time that a crowdsourced
approach is utilized to report on geographic aspects of tracking
using real users’ data.
We recruited users from the CrowdFlower platform [4]. We
excluded users having ad-blocking extensions installed on their
browser, such as, AdBlockPlus, Ghostery, etc. In total, 350 users
have installed the browser extension and contributed data to our
study in a time window of more than four months, from Sep. 1, 2017
to mid-Jan., 2018. The number of unique visited websites is more
than 76K and the total third-party requests logged exceeds 7.1M
Figure 1: High-level communication between parties in the
Open RTB Ecosystem [25] (courtesy: Interactive Advertising
Bureau).
directly between the entities without going through the end user’s
device. In this paper, we report only upon the directly visible track-
ing flows, i.e., those that involve execution of tracking code at the
consumer’s browser.
2.3 Challenges
Tracing the geographic aspects of tracking flows has received rel-
atively little attention. This is not surprising given the involved
technical challenges.
Challenge 1 - Collecting real tracking flows: Existing work has
gone mostly into quantifying and cataloging the trackers found
present in different publisher websites [29, 35, 36, 41, 58]. This is
already challenging since identifying tracking code requires full
rendering of publisher webpages. In our case things are even more
difficult since rendering webpages through automated crawlers is
not enough – we need real users, with real credentials and web
browsing history, at different locations to capture the full spatial
aspects of tracking flows. Releasing measurement code to real users
is difficult to scale, while passive network logs, e.g., NetFlow [32]
or sFlow [55], are at a much higher level that makes identifying
tracking flows difficult, either because there is no payload (NetFlow)
or there is partial or encrypted payload (sFlow).
Challenge 2 - Completeness of measurement: If one attempts
to combine the precision of full rendering via dedicated measure-
ment code with the scale of passively collected network logs, they
will eventually run into issues of completeness such as: Are there
any additional tracking domains other than the ones seen by the
measurement code? Which are the IPs associated with these do-
mains? Are there any additional IPs associated with these domains
that were not returned to the real users?
Challenge 3 - Precision of analysis: Collecting complete mea-
surements is only a first step. Next, the analysis has to be conducted
with care. For our study, accurate IP geolocation is key to deriving
reliable results and conclusions. It is well known that infrastructure
IPs, such as servers [31, 56] and routers [34, 37, 39, 50], are prone
to imprecise geolocation. It is also important to investigate if the
tracking IPs are dedicated to tracking, or are shared with other ser-
vices and domains. It is also important to identify the time period
that a specific IP is associated with a tracking service in order to
remove noise from dynamic use of IPs.
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Costas Iordanou et al.
Table 2: Comparison between the AdBlockPlus lists (easylist,
easyprivacy - top row) and the semi-manual classification
(bottom row) to identify ad and tracking related third-party
requests.
AdBlockPlus Lists
Semi-automatic
Total
# FQDN # TLD # Unique Requests
6,259
3,620
9,879
539,293
453,457
992,750
1,863
879
2,742
# Total Requests
2,446,460
1,964,408