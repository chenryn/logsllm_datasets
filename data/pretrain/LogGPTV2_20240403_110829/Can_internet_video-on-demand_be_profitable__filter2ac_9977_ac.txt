 40
 20
 0
 0
(a)
(b)
(a) Apr. 2006
(b) Dec. 2006
(c) 95th percentile cut
 0.5
 1
 1.5
 2
 2.5
 3
server bandwidth (Gbps)
Figure 7: 95 percentile rule: CDF of 5-minute aver-
ages in April and December
Figure 7 shows the 95 percentile value for two diﬀerent
months: April 2006 and December 2006. Using this rule,
we see that the bandwidth cost increases from 1.23 Gbps
in April to 2.20 Gbps in December. Hence, because of the
video quality upgrade and the increased popularity of the
service, the operational cost is increased by 78.5%. Looking
forward, when more users spend even more time watching
Internet videos, they are going to demand longer videos and
better quality. Providing such services to meet the demand
with a client-server architecture is going to be very costly
(if not prohibitive).
3. THEORY OF PEER-ASSISTED VOD
In this section we develop simple mathematical models for
peer-assisted VoD. The purpose of these models is to gain
broad insights into the design of peer-assisted VoD. In the
subsequent sections, we will combine the modeling insights
with trace-based simulations, enabling us to assess the full
potential of P2P solutions.
We focus on a single on-demand video of rate r bps. Users
watching the video will assist in the re-distribution of the
video to other users. We classify users according to their
In particular, let M denote the
upload link bandwidths.
number of user types, where a type m user has upload link
bandwidth wm. Users arrive at the system in a Poisson
process with parameter λ. Denote by pm the probability
that an arrival is a type m user. Using the property of the
compound Poisson process, the above user arrival model is
the same as if the m user types arrive as independent Poisson
processes with parameters pmλ, 1 ≤ m ≤ M . Naturally,
the average upload bandwidth of an arriving user is μ =
P
pmwm. Because a user may quit the video before it ends,
skip portions of the video, pause the video, or perform other
interactive actions, the time during which a user remains in
the system is random. Denote a user’s expected sojourn
time in the system as σ.4
P
It follows from Little’s law that in steady state the ex-
pected number of type m users in the system is given by
ρm = pmλσ. Thus, in steady state, the average demand is
wmρm =
D = r
μλσ. We say that the system is in the surplus mode if S > D;
in the deﬁcit mode if S  r,
and in the deﬁcit mode if μ  S, then on average the server must at least make up
the diﬀerence, that is, the average server rate is at least
max(D − S, 0). This trivial bound turns out to be too loose
to be useful in most circumstances.
We now outline how a more insightful lower bound can be
obtained. The basic idea is to remove the ordering restric-
tions from the allocation policies. That is, we suppose that
a peer can feed content to any peer, not just to the peers
that arrived after it. In this modiﬁed system, when there are
n peers in the system with upload capacities u1, u2, . . . , un,
then the entire aggregate capacity u1 + u2 + ··· + un can
be used, irrespective of arrival ordering of the peers. It is
clear that water-leveling is optimal for this modiﬁed sys-
tem. Thus, this modiﬁed system, which always makes full
use of the aggregate upload capacity and which allocates
bandwidth according to the water-leveling policy, will have
lower average server bandwidth than any prefetch policy for
the original system. If a prefetching policy is close to this
lower bound, then it is nearly optimal.
e
t
a
r
t
n
e
t
n
o
c
/
e
t
a
r
r
e
v
r
e
s
 8
 6
 4
 2
 1
 0.5
 0
1
1.001
1.002
no prefetching
water-leveling
greedy
improved bound
e
t
a
r
t
n
e
t
n
o
c
/
e
t
a
r
r
e
v
r
e
s
 100
 40
 20
 10
 4
 2
 1
 0.4
no prefetching
water-leveling
greedy
improved bound
trivial bound
1.10
1.20
1.40
1.001
1.002
1.004
1.01
1.02
1.04
1.10
1.20
1.40
1.004
1.01
1.04
Supply/Demand (S/D)
1.02
(a) Surplus mode
Demand/Supply (D/S)
(b) Deﬁcit mode
Figure 8: Comparison of three prefetching policies
3.4 Simulation Results
We developed a discrete-event simulator to study the per-
formance of the water-leveling and greedy policies and to
compare those policies to the no-prefetching policy and the
lower bound. We focus on the balanced mode, as that is
where there is the greatest potential for improvement with
the prefetch policies. It is also where we expect VoD systems
to operate in the future.
We ﬁx the user arrival rate at λ = 1 and vary the supply-
demand ratio between 1/1.4 to 1.4. Figure 8 shows the
simulation results. We make the following key observations:
• When the system operates in the balanced mode, prefetch-
ing can provide signiﬁcant improvements, reducing server
bandwidth requirements by a factor of three or more.
Note that the domain of the balanced mode becomes
wide for systems with a relatively small number of
users.
• The greedy policy does slightly better than the water-
leveling policy.
• Both the greedy and water-leveling policies are very
close to the lower bound. Thus, both of these policies