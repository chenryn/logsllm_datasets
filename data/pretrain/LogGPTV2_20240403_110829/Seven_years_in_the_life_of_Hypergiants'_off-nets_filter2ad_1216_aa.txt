title:Seven years in the life of Hypergiants' off-nets
author:Petros Gigis and
Matt Calder and
Lefteris Manassakis and
George Nomikos and
Vasileios Kotronis and
Xenofontas A. Dimitropoulos and
Ethan Katz-Bassett and
Georgios Smaragdakis
Seven Years in the Life of Hypergiants’ Off-Nets
Petros Gigis
Matt Calder
Lefteris Manassakis
FORTH-ICS
University College London
Microsoft & Columbia University
George Nomikos
FORTH-ICS & Lancaster University
Vasileios Kotronis
FORTH-ICS
Xenofontas Dimitropoulos
FORTH-ICS & University of Crete
Ethan Katz-Bassett
Columbia University
Georgios Smaragdakis
TU Delft
ABSTRACT
Content Hypergiants deliver the vast majority of Internet traffic to
end users. In recent years, some have invested heavily in deploying
services and servers inside end-user networks. With several dozen
Hypergiants and thousands of servers deployed inside networks,
these off-net (meaning outside the Hypergiant networks) deploy-
ments change the structure of the Internet. Previous efforts to study
them have relied on proprietary data or specialized per-Hypergiant
measurement techniques that neither scale nor generalize, provid-
ing a limited view of content delivery on today’s Internet.
In this paper, we develop a generic and easy to implement method-
ology to measure the expansion of Hypergiants’ off-nets. Our key
observation is that Hypergiants increasingly encrypt their traffic
to protect their customers’ privacy. Thus, we can analyze publicly
available Internet-wide scans of port 443 and retrieve TLS certifi-
cates to discover which IP addresses host Hypergiant certificates in
order to infer the networks hosting off-nets for the corresponding
Hypergiants. Our results show that the number of networks hosting
Hypergiant off-nets has tripled from 2013 to 2021, reaching 4.5k
networks. The largest Hypergiants dominate these deployments,
with almost all of these networks hosting an off-net for at least
one – and increasingly two or more – of Google, Netflix, Facebook,
or Akamai. These four Hypergiants have off-nets within networks
that provide access to a significant fraction of end user population.
CCS CONCEPTS
• Networks → Network measurement.
KEYWORDS
Hypergiants, Content Delivery Networks, TLS, Server Deployment.
ACM Reference Format:
Petros Gigis, Matt Calder, Lefteris Manassakis, George Nomikos, Vasileios
Kotronis, Xenofontas Dimitropoulos, Ethan Katz-Bassett, and Georgios
Smaragdakis. 2021. Seven Years in the Life of Hypergiants’ Off-Nets. In
ACM SIGCOMM 2021 Conference (SIGCOMM ’21), August 23–27, 2021, Virtual
This work is licensed under a Creative Commons Attribution International 4.0 License.
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
© 2021 Association for Computing Machinery.
ACM ISBN 978-1-4503-8383-7/21/08.
https://doi.org/10.1145/3452296.3472928
516
Figure 1: Hypergiant’s off-net footprint (in an ISP) and on-net foot-
print (in the Hypergiant’s AS).
Event, USA. ACM, New York, NY, USA, 18 pages. https://doi.org/10.1145/
3452296.3472928
1 INTRODUCTION
The vast majority of traffic to Internet users comes from a small
number of content providers, cloud providers, and content delivery
networks that are heavy traffic outbound, including Google, Netflix,
Facebook, and Akamai. These providers, dubbed Hypergiants (HGs)
by Labovitz et. al [64], deliver content to billions of users around
the world. In 2019, more than half of Internet traffic originated from
only 5 HGs [32, 85, 104], a significant consolidation of traffic since
2009, when it took the largest 150 ASes to contribute half the traffic,
and 2007, when it took thousands of ASes [64].
To deliver high quality user experience in the face of ever increas-
ing demand for content, HGs invest heavily in their infrastructure.
They construct datacenters [54, 96] and roll out fiber to build their
backbone [10, 16, 62]. They peer at colocation facilities and Internet
Exchange Points (IXPs) worldwide [48, 90, 113]. They also peer
directly with eyeball networks, bypassing transit providers to im-
prove user performance and cut costs [10, 11, 28, 40, 64, 69, 81]. For
example, Google peers with more than 7.5k networks [11] (ca. 2020),
by establishing peerings at more than 100 colocation facilities and
150 IXPs [50].
HG’s Off-net Footprint. HGs operate their own networks and
datacenters, with servers assigned IP addresses from their own ASes.
Some HGs also install servers inside eyeball or other networks, to
serve users in those networks or their customers [53, 69, 79, 81].
These servers are assigned IP addresses of the hosting network.
Since 2000, Akamai has deployed their servers in hundreds of net-
works around the globe [69, 81]. We refer to these servers as off-nets
because they are outside (off) the HG’s own network, in contrast to
the on-nets that a HG hosts on its own network (see Fig. 1). More
recently, other HGs have followed this model, e.g., Google launched
end userHypergiant off-net serverHypergiant on-net serverHypergiant ASISP ASServer-to-Server connectionAS-levelpeeringSIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
P. Gigis et al.
the Google Global Cache [53], Netflix has Open Connect [79], and
Facebook [89] and Alibaba [7] operate their own CDNs.
Despite the dominant role that HGs play in delivering Internet
content, the research community has lacked general and scalable
methods to track their growth and impact on the Internet topology.
Why measure Hypergiant Off-nets? Being able to track the
expansion of the Hypergiants inside other networks, especially
eyeball networks, has implications on the modeling of Internet
structure and Internet traffic flow. By deploying off-nets, HG’s
content is localized within the hosting network, with less traffic
crossing network boundaries. This view challenges the research
community’s mental model of the value of peering and exchanged
traffic between networks and can impact the scope and consid-
erations of net neutrality regulation. It has also implications on
network performance, as crossing network boundaries comes at
a cost [28, 44, 69]. Moreover, operating servers within a network
improves the strategic position of Hypergiants as they are able to
control both the origin server within their network as well as the
servers within other networks and, thus, optimize content deliv-
ery to end users. Looking forward, it is important to understand if
major Hypergiants, responsible for 90% of the traffic consumed by
end-users, have already taken steps towards delivering services in
emerging networks (e.g., 5G) that require close proximity to mo-
bile users and performance guarantees. The research community
lacks a good understanding of the global expansion strategies of
major Hypergiants and how much of the Internet population can
be served locally. Such insights can inform studies in other fields,
including economics, political science, and regulation. Section 8
revisits some of these topics in light of our results uncovering the
off-net footprints of major Hypergiants.
Challenges and Previous Work. Off-net servers of large HGs
(e.g., Google, Netflix, Facebook, Akamai, and many others) typically
use IP addresses announced by the hosting network (by ISPs rather
than by the HG), making it impossible to identify the server as
belonging to the HG using traditional techniques such as inspecting
BGP feeds. Alternate approaches have been used, but they either
require access to distributed vantage points and so have limited
coverage, or they are tailored to a particular HG, so lack generality
and are fragile to changes that the HG might make.
The first category of earlier approaches relies on issuing DNS
queries from many locations since HGs can direct users to a partic-
ular server by resolving DNS queries to the server’s IP addresses.
These approaches either use a distributed measurement platform [88,
102], open recursive resolvers that (generally mistakenly) will re-
spond to queries from arbitrary hosts [55, 105], or crowd sourced
requests [3, 74]. Approaches to study YouTube’s infrastructure have
used 5 vantage points in different networks [103] and a combination
of open DNS resolvers and PlanetLab [2]. However, none of these
techniques has resulted in truly global coverage, which becomes
more of a problem as HGs expand their footprints and use any-
cast [23], and studies that (ab)use open resolvers also raise ethical
concerns.
The second category of earlier approaches get around the need
for distributed vantage points via DNS-based techniques tailored
to individual HGs. Studies have emulated issuing DNS queries
from around the world by using the DNS Extension Client-Subnet
(ECS), which allows a DNS query to include the client’s IP prefix,
allowing researchers to issue queries to a HG that appear to come
from arbitrary locations/prefixes [22, 101]. However, many HGs
do not support ECS, and even ones that do may reply only to ECS
queries from whitelisted resolvers [26]. Further, even Google, the
subject of earlier ECS-based mapping, now only responds to DNS
queries for domains such as www.google.com with IP addresses
of on-net servers, and so ECS-based mapping efforts no longer
uncover Google off-nets. Other studies have mapped Facebook [13–
15] and Netflix [17] off-nets by exploiting patterns in the naming
scheme for off-net DNS records, then exhaustively trying queries
based on those patterns. This approach is fragile and tedious, as
hostname patterns may change, requires tailored patterns per HG
so can be difficult to scale, and is not general, as some HGs do not
have exploitable naming conventions.
Our Approach. We present the first approach for identifying off-
nets that is both general, working across Hypergiants, and complete,
achieving global coverage of their off-net footprints. Additionally,
our approach is amenable to using existing public datasets, enabling
us to apply it in a longitudinal study uncovering the growth in off-
net deployments.
Our approach relies on two key observations. First, a Hyper-
giant’s off-net servers host the Hypergiant’s Transport Layer Se-
curity (TLS) certificate(s) and must provide the certificate(s) in re-
sponse to queries. Recent years have seen a dramatic increase in
use of Transport Layer Security (TLS), such that the majority of
Internet traffic today is encrypted [32]. Adoption of encryption has
been particularly high among HGs, with the percentage of Google
traffic that is encrypted increasing from from 50% in 2014 to 95% in
2020 [51].
A TLS certificate validates the identity of a service run in a server,
and so a server possessing a Hypergiant’s certificate indicates it is
a server for the Hypergiant. If a server outside the Hypergiant’s
network has the certificate, it is an off-net for the Hypergiant, an
observation we validate later in the paper. Because TLS certificates
and message exchanges are standardized, TLS scans of the IP address
space provide an approach to identify off-nets that will work for any
Hypergiant (that uses TLS) and can cover all publicly-addressable
servers.
Second, because the approach relies on standard TLS scans, we
can use existing certificate corpuses to perform historical and longi-
tudinal analysis. Such corpuses are readily available for commercial
and research use, e.g., from Rapid7 [87] and Censys [36].
In combination, the wide adoption of TLS and the available certifi-
cate datasets provide an opportunity to infer the off-net footprints
of all HGs and to greatly enhance the community’s understanding
of Internet content delivery.
Our Contributions:
• We develop a generic methodology to infer all HGs’ off-net foot-
prints by analyzing corpuses of scanned certificates. We augment
our methodology with analysis of HTTP(S) header corpuses to
differentiate a HG service hosted on third party platforms (e.g.,
Netflix web servers running in AWS) from a HG service running
on its own servers (e.g., Netflix Open Connect video caches).
• By applying our methodology on certificate corpuses that span
more than seven years (2013-2021), we find that the number of
ASes that host HG off-net installations has tripled, reaching 4.5k
517
Seven Years in the Life of Hypergiants’ Off-Nets
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
in April 2021. We validate our results by surveying HG operators.
Those that replied indicated that we correctly uncovered 89-95%
of ASes hosting their off-nets.
• Of networks that host any HG off-nets, our analysis reveals that
the large majority host at least one of the four largest HGs (Google,
Netflix, Facebook, and Akamai, the four largest in terms of num-
ber of networks in which they have off-nets).
• ASes that already host at least one HG tend to host more over
time. Most off-nets are in small and medium ASes, which is not
surprising since most ASes in general are small, but a dispropor-
tionate share of large ASes host them as well.
• Hypergiants have rapidly expanded their off-net footprints in
Europe, Asia, and Latin America, the last seeing exponential
growth.
• As a result of this expansion, a significant fraction of the end user
population can be potentially served by the off-net deployments
of Google, Netflix, Facebook, and Akamai.
• Our analysis unveils different strategies by HGs. While a number