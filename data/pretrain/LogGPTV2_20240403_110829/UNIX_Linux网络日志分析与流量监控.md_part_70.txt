Morefilters
Search|Clear
10）此按钮能显示OSSIM系统各项配置信息。
7）这部分对SIEM事件信息显示产品类型的Top10，OSSIM的产品类型包括：
6）这部分显示系统中由探测器发来的疑似警报（一些比较可疑的报警信息）以及
ensor
1.日志过滤
searchfeom
SIEM事件控制台是日志分析的重要组成部分，它位于Analysis→SecurityEvents(SIEM)
9）此按钮显示整个系统数据快照，侧重安全事件，以便管理人员快速全面地掌握整个
8）此部分就是以饼图形式显示事件类别的Top10。
ast2hLastdays|Lat
GMT-4:00:
E
Week
1Last2WeeksLast Month
Ce
SigarePaylod
Back|Retresh
2013-07-06 10:50:17
Timeline
2013-07-060749:00
DateGMT-4:00
arah
图14-34SIEM面板显示内容
IA
国
alemad
tine>[07062013][myC
192.168.120.120
0.0.0.0
META
MtTCPIUDP
Summary Statistics
192.16.120.120
Sensors
PAYLOAD
Destination、Asset
Ase
CustomView
LAYER4
---
## Page 406
项中还可以由数据源组、网络/主机组以及日志种类等特性进行过滤。如图14-37所示。
数据源种类以及风险等级的低、中、高来更精确地过滤日志内容，在系统提供的更多过滤选
准。这样非常方便我们回退查找日志。
索条件都会列在右侧边栏中，如图14-36所示。我们可以通过点击“clear”
和“dst host”六项筛选方式。经过多重筛选后基本就能定位出你要找的日志。每次加入的搜
点击“IP”按钮，它会列出“src or dst ip”、“src ip”、“dst ip”、“src or dst host”、“src host”
与之匹配的日志，不过其中肯定有不少干扰日志项。接着进一步过滤，车
所示。
和 Risk 共七个部分组成，各部分含义如下：
oseLognsesinopened
oseLogisession oened
口
首先是“Search”，你可以输入日志的关键字，再点击“Signature”按钮，系统就会列出
其次是根据Sensor+数据源组合过滤进行查找。我们可以输入探测器IP地址，然后输入
ososufeoaso
playing
系统通过一些实用的日志过滤开关，实现过滤功能，在 SIEM 面板中有很丰富的过滤开
除此之外，我们还可在自定义显示方式中获得更多日志信息，如图14-35
●Signature:日志典型特征，包括 snort 过滤的一些典型规则。
显示从上至下，依次介绍如下：
。
Date：时间。
Risk：风险值。
Asset：资产
Source：源地址。
Sensor:探测器，表示从哪个探测去获取的日志。
Destination:
Extra data = {userdata2= login)...Clear...
Signature
Sensor=(alienvault)..Clear...
Current Search Criteria
201307-040454:45
2013-07-0510:01:01
2013-07-0603:2326
2013-07-0607:49:00
：目的地址。
2013-07-0503:31:14
2013-07-0503:51:45
DateGMT-4:00
META
图14-36列出当前查找标准
0.0.0.0
0.0.0.0
0.0.0.0
0.0.0.0
Source
[.Clear All Criteria..]
图14-35自定义列表
alervault
stenvaut
alenvault
Sersor
Authenication
Authenticaion
Authenfication
Authenication
福
Authentication
Category
PAYLOAD
afion
any
SubCategory
Login
Login
Login
Login
第14章OSSIM综合应用383
Login
any
Empty
号
输入IP地址，然后
Risk Analysis
Reputation
Taxonomy
Default
SelectView
来逐条删除标
LAYER4
none
Empty
---
## Page 407
查），如图14-39所示。
统自学的过程，积累时间一长，就会形成企业中独有的知识库结构，能更加方便今后故障筛
如图14-38所示。
根据协议和端口来分类），不同的嗅探器和不同的数据源，对收集来的日志进行分类统计，
384
另外，SIEM提供的日志统计功能非常不错，它可以按不同的地址，不同的日志（例如
Source|Destination
UNIX/Linux网络日志分析与流量监控
将日志加入到知识库（KDB数据库）
Unique addresses:
Events
P
SearchIClear
Fitters
searc
业
Destination Port:TCP|UDP
Mote Faes
EventTypes
SourcePort:TCPUDP
EventTypes
Unique Events
00
BackRetresh
Aeh
图14-39将日志加入知识库
图14-37SIEM过滤选项
Apeae
图14-38分类统计
Summary
DSGroup Nan
307-06 07:49:00
Tornetwori
entfile
Statistics
Product Types| Categories
Severity:
Activity:
b-Category:
entCateg
ductType:
Taxo
Taxonomy
ProductType
Current search CriteriaL.Clear AlCrteila.
Sensors
DOS分类下的子类信息
omyandRep
Flood
Denial Of Service
Alarm
softOfficeorPDFdoc
(Alarm}.Ciear..
Sur
arySta
Unique CountryEvents
Unique IP links [FQDN]
Unique Data Sources
品
DD0
?
---
## Page 408
三要素）组合在一起进行风险的计算，在OSSIM系统中使用以下公式：
模型如下式所示。
断。它实际上属于一种风险概率的分析。风险评估模型嵌入在OSSIM 关联引擎系统中，其
取针对性的安全防护措施。它需要综合考虑资产价值、漏洞、威胁、时间等因素做出综合判
断其价值、存在的脆弱性和面临的安全威胁，从而获得该资产的安全风险情况，继而可以采
包括网络威胁、资产统计和漏洞扫描的评估，其目的是帮助识别企业中的资产状况，分析判
14.6.1风险评估三要素
就可以添加/删除仪表盘，这样就完成了设置。
示屏和多屏显示系统尤为有利，可视范围增大后，方便了管理。
企业积累一笔宝贵的日志财富，这将为你今后网络故障诊断和取证留下重要参考信息。
风险评估（RiskAssessment）是对网络内的资产及整个网络进行实时的评估。风险评估
14.6风险评估方法
Deployment
intelience
Assets
Reports
Analysis
incidents
Dashbo
它将资产价值（Asset）、优先级（Priority）、可靠性（Reliability）三个参数（风险评估
调整面板具体操作方法是，先点击齿轮状按钮，然后在下拉菜单中选择“Edit Mode”
Risk
Dashboards
在OSSIM4.x系统中，主界面增添了自定义面板功能选项，用户可以自己添加
3.调仪表面板显示数量
通过收集这些日志信息，并存放到OSSIM的知识库中，经过长期积累记录能够为你的
Risk=R(asset,vulnerability,threat)
回
国
Tickets
Securty
Network
Rel Time
Honeypo Activity
Inver
图14-40调整仪表显示
4
Analysis
Incidents
Deployment Status
Dashboards
Dashboards
（公式14-1）
好口
第14章OSSIM综合应用385
大
Executive
---
## Page 409
库中。
面。另外在查询 SIEM日志时，右键点击某一个典型日志还可以将其加入到数据源数据
Directive来设置风险优先级，如图14-41所示。
常Risk值大于2就会发生报警，大于3就会标记为红色。一个资产的可靠性怎么推断出来
值越高，代表系统越不可靠，越容易遭到攻击，大家也可以将此理解为被攻击的可能性。
程度，数值越大，则危害程度越高；可靠性（Reliability）的取值范围为0～10，默认值为
级Priority的取值范围为0～5，默认值为1，优先级参数描述一次成功攻击所造成的危害
386UNIX/Linux网络日志分析与流量监控
古剑风
服务器造成威胁，由于它利用了一个严重的安全漏洞，因此管理员应立即修补漏洞。
了，这个攻击本身是危险的，它曾危害过成千上万台主机并易于传播，但是它并不仅对一台
能性为100%，也就是存在非常大的隐患。
TCP，这时OSSIM根据这些信息就能判断可靠性，目前来看这样配置的服务器被攻破的可
器安装RedHatLinux9，启动了Apache服务器，版本为1.3.33，服务端口80，协议为
的？这要根据操作系统类型、端口、协议、服务名称，以及版本综合判断。例如，一台服务
1，可靠性参数描述一次攻击可能成功的概率，
在实际操作中，可通过 Intelligence→Correlation Directives 下 Directives 选项，新建