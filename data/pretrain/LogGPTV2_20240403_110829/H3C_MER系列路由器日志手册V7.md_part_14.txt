10.2 ARP_ACTIVE_ACK_NOREQUESTED_REPLY
Interface [STRING] received from IP [STRING] an ARP reply that was not requested by
日志内容
the device.
$1：接口名称
参数解释
$2：IP地址
日志等级 6
ARP/6/ARP_ACTIVE_ACK_NOREQUESTED_REPLY: Interface GigabitEthernet1/0/1
举例
received from IP 192.168.10.1 an ARP reply that was not requested by the device.
ARP主动确认功能检测到攻击
日志说明
接口在未向ARP报文发送端IP地址发送ARP请求的情况下，收到ARP应答
处理建议 设备丢弃该ARP应答
10.3 ARP_BINDRULETOHW_FAILED
Failed to download binding rule to hardware on the interface [STRING], SrcIP [IPADDR],
日志内容
SrcMAC [MAC], VLAN [UINT16], Gateway MAC [MAC].
$1：接口名称.
$2：源IP地址
参数解释 $3：源MAC地址.
$4：VLAN编号.
$5：网关MAC地址.
日志等级 5
ARP/5/ARP_BINDRULETOHW_FAILED: Failed to download binding rule to hardware on
举例 the interface Ethernet1/0/1, SrcIP 1.1.1.132, SrcMAC 0015-E944-A947, VLAN 1,
Gateway MAC 00A1-B812-1108.
日志说明 由于硬件资源不足、内存不足或其他硬件错误导致绑定规则下发失败
1. 使用 查看硬件ACL资源是否充足：
display qos-acl resource
如果充足，则请执行步骤2
如果不充足，则请取消部分ACL配置或接受当前结果
处理建议 2. 使用 查看内存资源是否充足：
display memory
如果充足，则请执行步骤3
如果不充足，则请取消部分配置或接受当前结果
3. 硬件发生错误，请取消最后一次相关配置，并重新尝试
94
10.4 ARP_DYNAMIC
日志内容 The maximum number of dynamic ARP entries for the device reached.
参数解释 无
日志等级 6
举例 The maximum number of dynamic ARP entries for the device reached.
日志说明 设备学到的ARP表项总数到达最大值，打印该提示日志
处理建议 不需处理
10.5 ARP_DYNAMIC_IF
日志内容 The maximum number of dynamic ARP entries for interface [STRING] reached.
参数解释 $1：接口名
日志等级 6
The maximum number of dynamic ARP entries for interface GigabitEthernet3/0/1
举例
reached.
日志说明 接口学到的ARP表项总数到达最大值，打印该提示日志
处理建议 无需处理
10.6 ARP_DYNAMIC_SLOT
日志内容 The maximum number of dynamic ARP entries for [STRING] reached.
参数解释 $1：槽位号或者成员编号、槽位号
日志等级 6
The maximum number of dynamic ARP entries for slot 2 reached.
举例
The maximum number of dynamic ARP entries for chassis 1 slot 2 reached.
某槽位上板卡学到的ARP表项总数到达最大值(设备堆叠情况，打印成员编号)，打印该提
日志说明
示信息
处理建议 无需处理
95
10.7 ARP_HOST_IP_CONFLICT
The host [STRING] connected to interface [STRING] cannot communicate correctly,
日志内容
because it uses the same IP address as the host connected to interface [STRING].
$1：IP地址
参数解释 $2：接口名
$3：接口名
日志等级 4
ARP/4/ARP_HOST_IP_CONFLICT: The host 1.1.1.1 connected to interface
举例 GigabitEthernet1/0/1 cannot communicate correctly, because it uses the same IP
address as the host connected to interface GigabitEthernet1/0/2.
日志说明 接口收到主机ARP报文中的源IP与其他接口连接的主机的IP地址冲突
处理建议 检查发送ARP报文的主机的合法性。如果非法，需要断开该主机网络
10.8 ARP_RATE_EXCEEDED
The ARP packet rate ([UINT32] pps) exceeded the rate limit ([UINT32] pps) on interface
日志内容
[STRING] in the last [UINT32] seconds.
$1：ARP报文速率
$2：ARP报文限速速率
参数解释
$3：接口名称
$4：间隔时间
日志等级 4
ARP/4/ARP_RATE_EXCEEDED: The ARP packet rate (100 pps) exceeded the rate limit
举例
(80 pps) on interface GigabitEthernet1/0/1 in the last 10 seconds.
日志说明 接口接收ARP报文速率超过了接口的限速值
处理建议 检查ARP报文发送主机的合法性
10.9 ARP_SENDER_IP_INVALID
日志内容 Sender IP [STRING] was not on the same network as the receiving interface [STRING].
$1：IP地址
参数解释
$2：接口名称
日志等级 6
ARP/6/ARP_SENDER_IP_INVALID: Sender IP 192.168.10.2 was not on the same
举例
network as the receiving interface GigabitEthernet1/0/1.
日志说明 接口收到ARP报文中发送端IP与本接口不在同一网段
处理建议 检查发送端IP对应主机的合法性
96
10.10 ARP_SENDER_MAC_INVALID
Sender MAC [STRING] was not identical to Ethernet source MAC [STRING] on interface
日志内容
[STRING].
$1：MAC 地址
参数解释 $2：MAC 地址
$3：接口名称
日志等级 6
ARP/6/ARP_SENDER_MAC_INVALID: Sender MAC 0000-5E14-0E00 was not identical
举例
to Ethernet source MAC 0000-5C14-0E00 on interface GigabitEthernet1/0/1.
接口收到ARP报文的以太网数据帧首部中的源MAC地址和ARP报文中的发送端MAC地址
日志说明
不同
处理建议 检查发送端MAC地址对应主机的合法性
10.11 ARP_SRC_MAC_FOUND_ATTACK
日志内容 An attack from MAC [STRING] was detected on interface [STRING].
$1：MAC 地址
参数解释
$2：接口名称
日志等级 6
ARP/6/ARP_SRC_MAC_FOUND_ATTACK: An attack from MAC 0000-5E14-0E00 was
举例
detected on interface GigabitEthernet1/0/1.
源MAC地址固定的ARP攻击检测功能检测到攻击
日志说明
5秒内，收到同一源MAC地址（源MAC地址固定）的ARP报文超过一定的阈值
处理建议 检查该源MAC地址对应主机的合法性
10.12 ARP_TARGET_IP_INVALID
日志内容 Target IP [STRING] was not the IP of the receiving interface [STRING].
$1：IP 地址
参数解释
$2：接口名称
日志等级 6
ARP/6/ARP_TARGET_IP_INVALID: Target IP 192.168.10.2 was not the IP of the
举例
receiving interface GigabitEthernet1/0/1.
日志说明 接口收到ARP报文中的目标IP与本接口IP不一致
处理建议 检查发送ARP报文的主机的合法性
97
10.13 DUPIFIP
日志内容 Duplicate address [STRING] on interface [STRING], sourced from [STRING].
$1：IP 地址
参数解释 $2：接口名称
$3：MAC 地址
日志等级 6
ARP/6/DUPIFIP: Duplicate address 1.1.1.1 on interface Ethernet1/1/1, sourced from
举例
0015-E944-A947.
ARP检测到重复地址
日志说明
接口收到ARP报文的发送端IP地址与该接口的IP地址重复
处理建议 修改IP地址配置
10.14 DUPIP
IP address [STRING] conflicted with global or imported IP address, sourced from
日志内容
[STRING].
$1：IP 地址
参数解释
$2：MAC 地址
日志等级 6
ARP/6/DUPIP: IP address 30.1.1.1 conflicted with global or imported IP address, sourced
举例
from 0000-0000-0001.
日志说明 收到ARP报文中的发送端IP地址与全局或导入的IP地址冲突
处理建议 修改IP地址配置
10.15 DUPVRRPIP
IP address [STRING] conflicted with VRRP virtual IP address on interface [STRING],
日志内容
sourced from [STRING].
$1：IP 地址
参数解释 $2：接口名称
$3：MAC 地址
日志等级 6
ARP/6/DUPVRRPIP: IP address 1.1.1.1 conflicted with VRRP virtual IP address on
举例
interface Ethernet1/1/1, sourced from 0015-E944-A947.
日志说明 收到ARP报文中的发送端IP与VRRP虚拟IP地址冲突
处理建议 修改IP地址配置
98
11 ASPF
本节介绍ASPF模块输出的日志信息。
11.1 ASPF_IPV4_DNS
SrcIPAddr(1003)=[IPADDR];DstIPAddr(1007)=[IPADDR];RcvVPNInstance(1042)=[STRI
日志内容 NG];RcvDSLiteTunnelPeer(1040)=[STRING];DomainName(1099)=[STRING];Action(105
3)=[STRING];Reason(1056)=[STRING].
$1：源IP地址
$2：目的IP地址
$3：VPN实例的名称
$4：DS-Lite隧道本端地址
$5：域名
$6：对检测到的非法协议报文的处理行为，取值包括：
参数解释 drop：丢弃报文
logging：生成日志信息
none：不做处理，放行
$7：日志产生原因，取值包括：
 Invalid DNS RR：检测DNS RR无效
 Failed to check DNS header flag：检测DNS报文头的标志失败
 Failed to check DNS header ID：检测DNS报文头的ID失败
日志等级 6
ASPF/6/ASPF_IPV4_DNS:SrcIPAddr(1003)=1.1.1.3;DstIPAddr(1007)=2.1.1.2;RcvVPNI
举例 nstance(1042)=vpn;RcvDSLiteTunnelPeer(1040)=dstunnel1;DomainName(1099)=www.
h3c.com;Action(1053)=drop,logging;Reason(1056)=Check DNS RR invalid.
日志说明 开启DNS协议的ASPF检测，DNS报文格式非法时，丢弃报文并生成日志信息
处理建议 无
99
11.2 ASPF_IPV6_DNS
SrcIPv6Addr(1036)=[IPADDR];DstIPv6Addr(1037)=[IPADDR];RcvVPNInstance(1042)=[
日志内容 STRING];DomainName(1099)=[STRING];Action(1053)=[STRING];Reason(1056)=[STRI
NG].
$1：源IP地址
$2：目的IP地址
$3：VPN实例的名称
$4：域名
$5：对检测到的非法协议报文的处理行为，取值包括：
drop：丢弃报文
参数解释
logging：生成日志信息
none：不做处理，放行
$7：日志产生原因，取值包括：
 Invalid DNS RR：检测DNS RR无效
 Failed to check DNS header flag：检测DNS报文头的标志失败
 Failed to check DNS header ID：检测DNS报文头的ID失败
日志等级 6
ASPF/6/ASPF_IPV6_DNS:SrcIPv6Addr(1036)=2001::1;DstIPv6Addr(1037)=3001::1;Rc
举例 vVPNInstance(1042)=vpn;DomainName(1099)=www.h3c.com;Action(1053)=drop,loggin
g;Reason(1056)=Check DNS RR invalid.
日志说明 开启DNS协议的ASPF检测，DNS报文格式非法时，丢弃报文并生成日志信息
处理建议 无
12 ATK
本节介绍ATK模块输出的日志信息。
100