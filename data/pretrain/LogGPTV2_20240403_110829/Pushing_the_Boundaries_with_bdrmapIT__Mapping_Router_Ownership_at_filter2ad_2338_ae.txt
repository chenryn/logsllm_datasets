of the VP network, they do not demonstrate the true benefits of
bdrmapIT’s combined heuristics. The primary goal in the creation of
bdrmapIT is accurate border mapping for all ASes in Internet-wide
traceroute datasets, which is shown in the next set of experiments.
7.2 bdrmapIT Validation on ITDK Data
The second set of experiments demonstrate the benefit of bdrmapIT’s
adapted heuristics to mapping network borders in Internet-wide
datasets. To highlight the differences between bdrmapIT and bdrmap,
we used traceroute datasets without VPs in any of the validation
66
Figure 16: (no in-net VPs) bdrmapIT has far better coverage than MAP-IT. We
do not use in-network VPs. Under the network label is the number of links
visible in the paths.
networks. We compare bdrmapIT’s results to MAP-IT, which was also
designed for Internet-wide border mapping.
For these experiments we used the publicly available CAIDA
ITDK datasets for March 2016 [1] and February 2018 [6], which
include traceroutes run over 15 days and alias resolution for some
interfaces seen in the traceroutes. From each ITDK we removed
traceroutes from a VP in one of our ground truth networks, ensuring
that no traceroutes originated in any network we validated against.
This left us with traceroutes from 109 of 111 VPs in the 2016 ITDK,
and from 141 of 146 VPs in the 2018 ITDK. All the traceroutes used
ICMP Paris traceroute [15,39], which controls the IP and transport
headers to reduce load balancing, and a combination of iffinder [21]
and MIDAR [22] for alias resolution.
Similar to MAP-IT’s validation [31], we present the precision and
recall of our inferences. Precision in this context is the fraction
of inferred interdomain links that are correct, i.e., they are not
internal to a network, and we correctly identified the connected
networks. Recall is the number of correctly identified interdomain
links that appear in the dataset. When computing the recall, we
exclude interfaces which only appeared as Echo Replies. Unlike in
the previous experiments, which only validate correctness, since
we obtained the ground truth based on bdrmap’s inferences, these
experiments test bdrmapIT’s ability to find interdomain links in a
dataset.
Fig. 16 shows that bdrmapIT clearly outperforms MAP-IT, with
better precision for all of the ground truth networks except the
large access network, and vastly better recall, demonstrating the
benefit of the adapted bdrmap heuristics. Overall, bdrmapIT achieved
91.8%-98.8% precision, and 93.2%-97.1% recall.
All the adapted heuristics play a role in bdrmapIT’s higher accu-
racy, but the largest improvement comes from the use of destination
2016Tier126882016R&E21052016LAccess1792018Tier125560.91.0AccuracySingleIn-NetworkVPbdrmapITbdrmap0.91.0Precision–TP/(TP+FP)NoIn-NetworkVP:CorrectnessbdrmapITMAP-IT2016Tier125162016R&E11742016R&E2512016LAccess1462018Tier124772018R&E11900.40.50.60.70.80.91.0Recall–TP/(TP+FN)NoIn-NetworkVP:CoveragebdrmapITMAP-ITIMC ’18, October 31-November 2, 2018, Boston, MA, USA
A. Marder et al.
Figure 17: (no in-net VPs and no last hops) bdrmapIT has bet-
ter coverage of interdomain links seen in the middle of the
paths. Under the network label is the number of links.
ASes in the last hop heuristic (§5). MAP-IT does not use destina-
tion information, so it is unable to identify those links. Another
prominent reason is that bdrmapIT’s enhanced ability to leverage
AS relationships, specifically in the third party heuristic (§6.1.1) and
the multihomed customer exception (§6.1.3), improves on MAP-IT’s
coverage of low visibility links at the Internet edge. Links between
an ISP and an edge AS are especially problematic for MAP-IT, since
traceroute often reveals more interfaces from the provider’s address
space on a border router than customer addresses past the border,
if an address from the operating AS even appears in a traceroute.
Finally, Fig. 17 shows the difference in coverage when we exclude
the interdomain links which only appear as the last hop in the
traceroute dataset. bdrmapIT still substantially outperforms MAP-
IT, indicating that the adapted heuristics, and our overall more
aggressive inference strategy, leads to significantly better results.
7.3 Effect of Decreasing VPs
The next set of experiments evaluated whether bdrmapIT’s perfor-
mance was reliant on the number of VPs included in the ITDK
datasets. We validated bdrmapIT’s performance using groups of 20,
40, 60, and 80 VPs, running five experiments in each group using
five randomly chosen sets of VPs. For all experiments we excluded
the VPs in our ground truth networks.
The results are shown in Fig 18. Each graph shows the average
of the five sets of VPs for each group, along with the standard error.
Surprisingly, bdrmapIT’s accuracy does not diminish as the number
of VPs decreases. In the groups with 20 VPs, the precision ranges
from 92.4%-99.6% and the recall is between 95.4%-98.6%. Similarly,
when we increase the number of VPs to 80, the precision (93.1%–
98.5%) and recall (94.0%–97.2%) remain roughly equivalent, with the
means falling within a standard deviation of each other. Although
Figure 18: bdrmapIT performance is does not diminish as the
number of VPs is reduced. The bars show the average for the
precision and recall, along with the standard error between
the five groups.
Figure 19: The number of visible links (seen in traceroutes)
increases with the number of VPs. The bars show the num-
ber of interdomain links visible in the dataset using only the
VPs in the set, along with the standard error.
the number of interdomain links visible in the dataset drops with
the reduction in VPs (Fig 19), bdrmapIT’s ability to correctly identify
those that appear does not diminish. This is an important result, as
researchers might have only a few VPs at their disposal.
7.4 Importance of Alias Resolution
Finally, we investigate the impact of alias resolution on bdrmapIT’s
accuracy. First, we investigate the impact of using a different alias
resolution technique on the same set of traceroutes. Specifically,
we use kapar [20] along with midar and iffinder, while the results
67
0.91.0Precision–TP/(TP+FP)NoIn-NetworkVP(NoLastHop):CorrectnessbdrmapITMAP-IT2016Tier115662016R&E11712016R&E2342016LAccess1392018Tier18532018R&E11860.60.70.80.91.0Recall–TP/(TP+FN)NoIn-NetworkVP(NoLastHop):CoveragebdrmapITMAP-IT0.91.0PrecisionVaryingNumberofVPs:Correctness20406080NumberofVPs0.91.0RecallVaryingNumberofVPs:CoverageTier12016R&E12016R&E2LAccess20406080NumberofVPs0.60.70.80.91.0FractionofVisibleLinksVaryingNumberofVPs:VisibleLinksTier12016R&E12016R&E22016LAccess2016Pushing the Boundaries with bdrmapIT
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Figure 20: Comparison between alias resolution with and
without kapar, excluding all IRs without multiple aliases.
The decreased alias group precision using kapar decreases
the bdrmapIT’s accuracy for the ITDK datasets, compared to
using midar and iffinder alone.
presented in §7.2 use only the midar and iffinder techniques to
infer router aliases. Second, we show that bdrmapIT performs nearly
equivalently with the midar and iffinder alias resolution as it does
without any alias resolution.
kapar Alias Resolution: Along with the alias resolution datasets
we used in §7.2, the CAIDA ITDK includes a second alias resolution
dataset that includes kapar. Unlike midar, which produces highly
precise alias groups, kapar attempts to increase the number of
grouped aliases, which can result in less precise groupings [8]. To
determine the impact of less accurate, but larger alias groups on
bdrmapIT’s inferences, we ran experiments for both the 2016 and
2018 ITDKs using the alias resolution which includes kapar.
The results, shown in Fig 20, clearly demonstrate that the less
precise IRs generated by kapar decrease the accuracy of bdrmapIT’s
inferences. To highlight the differences between the alias group-
ings, in Fig 20 we only include IRs with multiple aliases. In our
ground truth datasets, kapar has a tendency to mistakenly group
interfaces into a single IR, when in actuality they are used on dif-
ferent physical routers. Since bdrmapIT ensures that each router
receives a single AS annotation, and then uses that information to
determine interdomain links, imprecise alias resolution results in
inaccurate inferences.
No Alias Resolution: Our final experiment aims to determine
the impact of using midar and iffinder alias resolution as com-
pared to not using any alias resolution. To do so, we ran bdrmapIT
on the ITDK datasets, but treated each interface as a separate IR.
The results are nearly identical, with less than 0.1% difference in
accuracy between using alias resolution with midar and iffinder,
and using an interface graph with no alias resolution.
Interestingly, the aggregation resulting from alias resolution
can impact the results both positively and negatively. Occasionally,
the additional IR links enable bdrmapIT to more accurately deter-
mine the IR operator, when one or more IR interface would not
have sufficient constraints for bdrmapIT to make a correct infer-
ence. Conversely, reallocated addresses and third party addresses
seen subsequent to a single interface can add confusion, causing
bdrmapIT to infer the incorrect operator for an IR group, while with-
out alias resolution the mistake would be limited to part of the IR. In
our experiments, the negative impacts of alias resolution occurred
exclusively at the edge of the Tier 1 network, where reallocated pre-
fixes are common. Further investigation is necessary to determine
when bdrmapIT with alias resolution performs better than using an
interface graph.
8 CONCLUSION
We addressed the surprisingly challenging problem of mapping the
borders of IP networks, which currently hampers both research
and regulatory efforts. In addressing this challenge, we presented
bdrmapIT, a traceroute analysis technique designed to infer the
operating AS for routers and identify links between Internet net-
works. Our method synthesizes two previous approaches, bdrmap
and MAP-IT, leveraging the strengths of each technique to create a
general-purpose solution.
To evaluate bdrmapIT, we performed experiments from in-network
and out-of-network VPs, validating the accuracy of our technique
and demonstrating that bdrmapIT outperforms its predecessors. We
performed additional experiments demonstrating that bdrmapIT’s
performance does not diminish as we reduce the number of VPs. Our
results suggest that bdrmapIT can form the foundation upon which
to address other network diagnostic challenges, including conges-
tion measurement [32,38], resilience assessment [14,25,33,36], and
traffic estimation [35]. We publicly release our source code.
68
2016Tier12016R&E12016R&E22016LAccess2018Tier12018R&E10.00.10.20.30.40.50.60.70.80.91.0AccuracyMultipleAliasIRs:AccuracymidarkaparInternet Topology Data Kit - March 2016. http://www.caida.org/data/
[2] 2018. AFRINIC Extended Allocation and Assignment Reports. ftp://ftp.afrinic.
[3] 2018. APNIC Extended Allocation and Assignment Reports. ftp://ftp.apnic.net/
[4] 2018. ARIN Extended Allocation and Assignment Reports. ftp.arin.net/pub/stats/
net/pub/stats/afrinic.
pub/stats/apnic.
arin.
[5] 2018. Euro-IX IXP Directory. https://www.euro-ix.net/tools/ixp-directory.
[6] 2018. Internet Topology Data Kit - February 2018. http://www.caida.org/data/
[7] 2018. LACNIC Extended Allocation and Assignment Reports. ftp.lacnic.net/pub/
internet-topology-data-kit/.
stats/lacnic.
stats/ripencc.
[8] 2018. Macroscopic Internet Topology Data Kit (ITDK). http://www.caida.org/
data/internet-topology-data-kit/.
[9] 2018. Packet Clearing House: Internet Exchange Directory. https://prefix.pch.
net/applications/ixpdir/menu_download.php.
[10] 2018. PeeringDB. https://peeringdb.com/api.
[11] 2018. RIPE Extended Allocation and Assignment Reports. ftp://ftp.ripe.net/pub/
[12] 2018. RIPE RIS Raw Data. https://www.ripe.net/analyse/internet-measurements/
routing-information-service-ris/ris-raw-data.
[13] 2018. University of Oregon Route Views Project. http://www.routeviews.org/.
[14] Réka Albert, Hawoong Jeong, and Albert-László Barabási. 2000. Error and attack
[17] Lixin Gao. 2001. On Inferring Autonomous System Relationships in the Internet.
tolerance of complex networks. Nature 406 (June 2000).
[15] Brice Augustin, Xavier Cuvellier, Benjamin Orgogozo, Fabien Viger, Timur Fried-
man, Matthieu Latapy, Clémence Magnien, and Renata Teixeira. 2006. Avoiding
Traceroute Anomalies with Paris Traceroute. In Proceedings of the ACM SIGCOMM
Internet Measurement Conference (IMC).
[16] Kai Chen, David R. Choffnes, Rahul Potharaju, Yan Chen, Fabian E. Bustamante,
Dan Pei, and Yao Zhao. 2009. Where the Sidewalk Ends: Extending the Internet
As Graph Using Traceroutes from P2P Users. In Proceedings of ACM CoNEXT.
IEEE/ACM ToN 9, 6 (2001), 733–745.
[18] B. Huffaker, A. Dhamdhere, M. Fomenkov, and k. claffy. 2010. Toward Topology
Dualism: Improving the Accuracy of AS Annotations for Routers. In Proceedings
of the Passive and Active Measurement Conference (PAM).
[19] Y. Hyun, A. Broido, and k. claffy. 2003. On Third-party Addresses in Traceroute
Paths. In PAM. San Diego, CA.
CCR 40, 1 (2010), 50–55.
[20] Ken Keys. 2010. Internet-scale IP alias resolution techniques. ACM SIGCOMM
[21] Ken Keys. 2018. iffinder. https://www.caida.org/tools/measurement/iffinder/.
[22] K. Keys, Y. Hyun, M. Luckie, and k. claffy. 2013. Internet-Scale IPv4 Alias Resolu-
[24] Anukool Lakhina, John W. Byers, Mark Crovella, and Peng Xie. 2003. Sampling
[25] Matthew Luckie and Robert Beverly. 2017. The Impact of Router Outages on the
[23] Thomas Krenc and Anja Feldmann. 2016. BGP Prefix Delegations: A Deep Dive.
tion with MIDAR. IEEE/ACM ToN 21, 2 (Apr 2013), 383–399.
In Proceedings of the ACM SIGCOMM Internet Measurement Conference (IMC).
Biases in IP Topology Measurements. In Proceedings of IEEE INFOCOM.
AS-level Internet. In Proceedings of ACM SIGCOMM.
[26] Matthew Luckie and kc claffy. 2014. A Second Look at Detecting Third-Party
Addresses in Traceroute Traces with the IP Timestamp Option. In PAM. 46–55.
[27] Matthew Luckie, Amogh Dhamdhere, Bradley Huffaker, David Clark, and kc
claffy. 2016. bdrmap: Inference of Borders Between IP Networks. In Proceedings
of the ACM SIGCOMM Internet Measurement Conference (IMC).
[28] Matthew Luckie, Bradley Huffaker, Amogh Dhamdhere, Vasileios Giotsas, and
kc claffy. 2013. AS Relationships, Customer Cones, and Validation. In Proceedings
of the ACM SIGCOMM Internet Measurement Conference (IMC).
[29] Z Morley Mao, David Johnson, Jennifer Rexford, Jia Wang, and Randy Katz. 2004.
Scalable and Accurate Identification of AS-Level Forwarding Paths. In Proceedings
of IEEE INFOCOM.
[30] Zhuoqing Morley Mao, Jennifer Rexford, Jia Wang, and Randy H Katz. 2003. To-
wards an Accurate AS-Level Traceroute Tool. In Proceedings of ACM SIGCOMM.
[31] Alexander Marder and Jonathan M Smith. 2016. MAP-IT: Multipass Accurate
Passive Inferences From Traceroute. In Proceedings of the ACM SIGCOMM Internet
Measurement Conference (IMC).
ISP Interconnection and its Impact on
Consumer Internet Performance - A Measurement Lab Consortium Technical
Report. http://www.measurementlab.net/publications/.
[32] Measurement Lab Consortium. 2014.
[33] Lin Quan, John Heidemann, and Yuri Pradkin. 2013. Trinocular: Understanding
Internet Reliability Through Adaptive Probing. In Proceedings of ACM SIGCOMM.
[34] Chris Ritzo. 2018. Paris Traceroute has a bug, and it causes some bad data.
https://www.measurementlab.net/blog/pt-bug/.
[35] Mario Sanchez, Fabian Bustamante, Balachander Krishnamurthy, Walter Will-
Inter-Domain Traffic
inger, Georgios Smaragdakis, and Jeffrey Erman. 2014.
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
A. Marder et al.
REFERENCES
[1] 2016.
internet-topology-data-kit/.
Estimation for the Outsider. In Proceedings of the ACM SIGCOMM Internet Mea-
surement Conference (IMC).
[36] Aaron Schulman and Neil Spring. 2011. Pingin’ in the rain. In Proceedings of the
ACM SIGCOMM Internet Measurement Conference (IMC).
[37] S. Sundaresan, A. Dhamdhere, M. Allman, and k. claffy. 2017. TCP Congestion
Signatures. In Proceedings of the ACM SIGCOMM Internet Measurement Conference
(IMC).
[38] Srikanth Sundaresan, Danny Lee, Xiaohong Deng, Yun Feng, and Amogh Dhamd-
here. 2017. Challenges in Inferring Internet Congestion Using Throughput Mea-
surements. In Proceedings of the ACM SIGCOMM Internet Measurement Conference
(IMC).
[39] Fabien Viger, Brice Augustin, Xavier Cuvellier, Clémence Magnien, Matthieu
Latapy, Timur Friedman, and Renata Teixeira. 2008. Detection, Understanding,
and Prevention of Traceroute Measurement Artifacts. Computer Networks 52, 5
(2008), 998–1018.
[40] Yu Zhang, Ricardo Oliveira, Hongli Zhang, and Lixia Zhang. 2010. Quantifying
the Pitfalls of Traceroute in AS Connectivity Inference. In Proceedings of the
Passive and Active Measurement Conference (PAM).
69