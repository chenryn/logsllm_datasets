－
进行信息 的搜集 ． 其 中
， ｔ ｈｅＨａｒｖｅｓ ｔ ｅｒ 借鉴 了 
Ｇｏｏｇ
ｌｅ
ｐ
ｌ ｏ ｉ ｔ
［８
＿
９ ］
， Ｗｉ ｒｅ Ｓｈ ａ ｒｋ
， Ｎｍａｐ 等数百 个强 大 的 渗 透
Ｈａ ｃ ｋ 的思 路
， 通过搜索 引 擎
、 ＰＧＰ 服务 器及
ｓ ｈｏ
－
测试工具
， 形成 了 完整的渗 透测 试体 系
， 是最为 成
ｄａｎ 数据库等来收集
ｅｍ ａ ｉ ｌ 、 子域名
、 开放端 口 等信
熟和知名 度最 高 的 渗 透测 试系 统
． 本文 中 所用 到
息
． Ｒ ｅｃ ｏｎ
－ＮＧ 是
一个模块化 的信 息搜 索 工具
， 它
的工具都来 自 于 Ｋａ ｌ ｉ
２ ． 
０ 版本 ．
可 以搜索 网站上 的
一些敏感文件如
ｒｏｂ ｏｔｓ ， 
ｔ ｘｔ 等 ．
总 的 来 说
， Ｇ ｏｏ ｇ
ｌ ｅ 
Ｈ ａ ｃｋ 及相关工具利用 互联
１
信息搜集技术研究
网来搜集
一 些 敏感信息
， 进而 由 这些信息 为 入 口
进行定点攻击
， 欲 防范 此类 攻击应避免在 互联 网
信息 搜集 阶段需 要搜 集 的 信息 数 目 庞大
、 种
上 暴露过多 的信息 ．
类繁多
， 为 了使信息搜集更加 高 效和 系统化
， 又 将
１ ． ２
目 标获 取
此阶段细 分为 几个小 的 部 分
， 包括 Ｇｏ ｏｇ
ｌ ｅ
Ｈａ ｃｋ 、
目 标获 取主要包括域名解析和 子域名 枚举
．
目 标获取
、 主机探测
、 主机扫 描 、 指 纹识别
、 协议分
域名解析是指利 用 ｄ ｉｇ 和 ｎ ｓｌ ｏ ｏｋ ｕｐ 等 工具来
析等
． 这几个部分将要 搜集 的 信息 系统 化地规整
解析 网址对应 的 域名 服务器
， 包括 Ａ 记 录 、 ＮＳ 记
起来
， 使信息搜集更加 全面高 效 ．
录 ＸＮＡＭＥ 记录 、 ＭＸ 记录 和 Ｓ０Ａ 记 录等
． 通过
１ ．
１
Ｇｏｏｇ
ｌｅ
Ｈａｃ ｋ
域名 解析可 以 得到 网 站 的 ＤＮＳ 服务 器 地址
、 别
从字面意 义上来看
，
“ Ｇｏ ｏｇ
ｌ ｅ
Ｈ ａｃｋ
” 即 为 谷歌
名
、 邮件服务器地址等信息
， 如 果信息 足 够多则 可
人侵 ． 实 际上 它 就是利 用 Ｇｏｏｇ
ｌ ｅ 等搜 集 引 擎对
一
能绘制 出 域名分布图 从而暴露整个网站部署架构 ．
些特定的 网 络主 机漏 洞 进行搜索
， 以 达 到 快速 找
子域名枚举 工具通过逐个枚举 ＤＮＳ 服务器
到存在某个漏 洞 的 主机或 者主机 中 存在 的 特定漏
的 方式来检测 是否 存在 区域传送漏洞
， 若都不存
洞 的 目 标 ． 利 用 常见 的 Ｇ ｏｏｇ
ｌ ｅ
Ｈ ａｃ ｋ 语 句 即 可 快
在则进行暴力 枚举二级域名 信息
， 其意 在得到 详
速找 到 目 标的很 多信 息 和 可 能 存在 的 漏洞
． 然 而
细 的 内 部 网 络架构
． 现有 Ｋ ａｌ ｉ 系 统 中 的
ｆｉ ｅｒ
ｃｅ 和
由 于
Ｇ ｏｏｇ
ｌ ｅ 在 中 国 市 场 的 退 出
， 狭 义 上 的
ｄ ｎ ｓｅｎ ｕｍ 等工具扫 描效率很高
， 若 ＤＮＳ 服务器配
“Ｇ ｏｏｇ
ｌ ｅ
Ｈ ａ ｃｋ
”在 国 内 已 经不再那 么有效了
．
置不 当 导致存在 区域传送漏 洞
， 会 很容易 被检测
在此可 以 将 Ｇｏｏ ｇ
ｌ ｅ 
Ｈａ ｃｋ 的 概 念扩大化
， 将
出来而受到攻击
．
通过互联 网 网 站 、 社交搜集 工 具 和集成 的 信 息 搜
１． ３
主机探测
集 工具等 手段 纳入 此部 分
， 形成
一个综合 的 利 用
主机探测 的 目 标是识别 目 标主机是否 在线 或
网 络进行信息搜集的工具集
．
可 用
， 只有存活 的主机才具有入侵 的可能 性
， 离线
在通 过互联 网 网 站 搜集信 息 方面
， 当 前存 在
主机在 网 络渗 透 中 是无意 义 的
， 以 此来 确 定攻击
一些很有 用 的 网 站 可 以 很 便捷地 查找 到 关键 信
目 标 ． 由 于 网 站安 全的 重要性 ， 很多 网 站 都装备 了
息
， 如 表
１ 所示
？ 通过表
１ 中所列 网 站进行搜索 可
人侵检测系统 （
ｉｎｔ ｒｕｓ ｉｏｎ 
ｄ ｅｔ ｅ ｃｔ ｉ ｏｎ 
ｓｙ ｓ ｔ ｅｍ ｓ ，
ＩＤＳ ）
、
以 得到某些有 效 的敏感信息 ．
入侵保护系统 （ ｉ ｎ ｔ ｒｕ ｓｉ ｏｎ 
ｐ ｒｅ ｖｅｎ ｔ ｉ ｏｎ
ｓｙ ｓｔ ｅｍ ，
ＩＰ Ｓ ）
２ １２
｜
？＞
．
． ．
和 网 站 应 用 级 人 侵 防 御 系 统
（ Ｗｅ ｂ
ａｐｐ
ｌ ｉ ｃａ ｔ ｉ ｏｎ
３ ）
ＴＣＰ
Ｆ ＩＮ 扫 描
： 最 隐蔽 的 扫 描 方式
， 原理
ｆ ｉ ｒｅｗａ ｌ ｌ
， 
ＷＡＦ ） 等 防御 系 统
， 所 以 此部 分将 对保
是有些 系 统关闭 的 端 口 会用 适 当 的 Ｒ ＳＴ 来 回 复
护措施的检测 作为支撑条件
．
ＦＩＮ 数据包
．
对于 网站 保护措施 的 检测 现有 的工具主要有
在 主机扫 描 中 最常 用 的 工具是被称为
“扫 描
ｗａ ｆｗＯ Ｏ ｆ 和
ｌ ｂ ｄ．
ｗａ ｆｗＯ Ｏ ｆ 是
一 个 ＷＡＦ 的 探查 工
神 器
”的 Ｎｍａ ｐ
， 它是主机扫 描的集大成者
， 支持主
具
， 它通 过故 意提交
一 个肯定在黑名 单中 的请求 ，
机探测 、 端 口 扫描 、 版本检测 、 系统检测等众多功能．
将返 回结果与 正确 请求 的 返 回结果 进行 比较来探
１． ５
指纹 识别
测 网 站是否存 在 ＷＡ Ｆ．
ｌ ｂ ｄ 工具用 来探测 网 站是
此阶段 的 目 标是识别 主机 的 操作系 统版本 与
否存在 ＤＮＳ 负 载 均衡
， 若 网 站无 负 载 均衡
， 会容
应用程序版本
， 进
一 步探测 操作系 统与 应用 级别
易 受到 ＤＤＯ Ｓ 攻击而导 致网 站瘫痪 ．
的 漏洞
， 分为 主 动 探测
、 被动 识别 和 Ｗ ｅｂ 指 纹识
对于 主机 的探测 分为 外 网 和 内 网
２ 个部 分．
别
３ 个部分 ．
Ｘ才外 网 主机 的 探测 来说
， 最基本最 简捷 的 方式就
主动探 测 包括 Ｂａ ｎｎ ｅｒ 抓 取和 利 用 Ｎｍ ａｐ 进
是被广泛应用 的
ｐ
ｉ ｎ ｇ 命令
， 即 通过发送
Ｉ ＣＭＰ 包
行常规主动 指纹识别
． Ｂａｎ ｎｅｒ 抓取是最基础
、 最简
来探测 主机的存活 情况
． 现有 的
ｆｐ
ｉ ｎ ｇ 和
ｎ ｅｔ ｅ ｎｕｍ
单的指 纹识别
， 它不需要专 门 的 工具
， 所得到 的信
等工具就是通过这种 方式来批量测 试存 活 主 机 ．
息准确 可靠
， 抓取到 的 信 息 是 网 站 的应用 程序指
值得注意 的是
， 有些主 机为 提高 安 全性会过滤
１Ｃ
－
纹信息
． 其 缺 点 是 如 果 网 站 修 改或 者禁 止 输 出
ＭＰ 包
，这就需要另 外的方式来探测其在线情况
？
Ｂａ ｎｎｅ ｒ 信息
，则 此手段便失去作用
．
对于 内 网 主 机来说
， 扫 描工 具通 常基 于
ａ ｒｐ
被动识别工具有 代表性 的 是 Ｐ 〇 ｆ ． 作为
一个 系
协议
， 如 ＡＲＰ ｉ ｎｇ． 通过
ａ ｒｐ 协 议可 以 探测 内 网 主
统指纹识别 工具
， 它不 向 目 标发送 具体 的 探测 数
机 的
ＩＰ 地址 、 ＭＡＣ 地址等信息
． 作为 其 中 的
一个
据
， 只是被动地接收数据并进行分析
， 所 以几 乎无
代表性工具
， Ｎｅ ｔ ｄｉ ｓｃ ｏｖｅ ｉ
？ 可 以 检测 到 当 前局 域 网
法被检测到
． 它抓取到 的 信息很详细
， 并且可 以 对
中 主 机 的
ＩＰ 、 ＭＡＣ 地 址
、 ＭＡ Ｃ 厂 商等信 息
？ 另
行仔细分析
，但其可供分析的信息量有限
．
外
， 在 内 网 主 机 中 有
一 个敏 感 服务
： Ｎｅ ｔＢ ＩＯＳ 服
Ｗ ｅｂ 指 纹 识 别 工 具包 括
ｗｈ ａ ｔｗｅｂ 和 ＷＰ
－
务
， 主机若开启此服务则可 能被 ｎｂ ｔｓ ｃａｎ 有关工具
Ｓｃ ａｎ， 
ｗｈ ａ ｔｗ ｅｂ 用 来探测 常 见 的 Ｗ ｅｂ 服务
， 如 应
利用 而得 到 主机 的
ＩＰ