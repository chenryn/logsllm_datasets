7/29/2003
8/5/2003
8/12/2003
8/19/2003
8/26/2003
9/2/2003
9/9/2003
Hot Research Areas…
• visualizing vulnerabilities 
• visualizing IDS alarms (NIDS/HIDS) 
• visualizing worm/virus propagation 
• visualizing routing anamolies 
• visualizing large volume computer network logs 
• visual correlations of security events 
• visualizing network traffic for security 
• visualizing attacks in near-real-time 
• security visualization at line speeds 
• dynamic attack tree creation (graphic) 
• forensic visualization 
http://www.cs.fit.edu/~pkc/vizdmsec04/
More Hot Research Areas…
• feature selection and construction 
• incremental/online learning 
• noise in the data 
• skewed data distribution 
• distributed mining 
• correlating multiple models 
• efficient processing of large amounts of data 
• correlating alerts 
• signature and anomaly detection 
• forensic analysis
http://www.cs.fit.edu/~pkc/vizdmsec04/
One Approach…
• Look at TCP/IP Protocol Stack Data 
(particularly header information)
• Find interesting visualizations
• Throw some interesting traffic at them
• See what they can detect
• Refine
Information Available On and 
Off the Wire
• Levels of analysis
• External data
– Time 
– Size
– Protocol compliance
– Real vs. Actual Values 
• Matrices of options
• Header slides
http://ai3.asti.dost.gov.ph/sat/levels.jpg
Ethernet:  http://www.itec.suny.edu/scsys/vms/OVMSDOC073/V73/6136/ZK-3743A.gif
Link Layer (Ethernet)
Network Layer (IP)
Examining 
Available Data…
Transport Layer (TCP)
Transport Layer (UDP)
IP: http://www.ietf.org/rfc/rfc0791.txt
TCP:  http://www.ietf.org/rfc/rfc793.txt
UDP:   http://www.ietf.org/rfc/rfc0768.txt
Grace
“Grace is a 
WYSIWYG 2D 
plotting tool for the X 
Window System and 
M*tif. Grace runs on 
practically any 
version of Unix-like 
OS. As well, it has 
been successfully 
ported to VMS, OS/2, 
and 
Win9*/NT/2000/XP” 
http://plasma-gate.weizmann.ac.il/Grace/
Parallel Plot
Target Machine’s Ports
Remote Machine’s Ports
Results
Example 1 - Baseline with Normal Traffic
Example 2 - Port Scan
Example 3 - Port Scan “Fingerprinting”
Example 4 - Vulnerability Scanner
Example 5 - Wargame
Example 1:  Baseline
External Port
Internal Port
External IP
Internal IP
Example 2 - PortScan
Defender
Attacker
nmap 3.00 default (RH 8.0)
nmap 3.00 udp scan (RH 8.0)
Superscan 3.0
Nmap Win 1.3.1
Example 3- PortScan “Fingerprinting”
nmap 3 (RH8)
NMapWin 3 (XP)
SuperScan 3.0 (XP)
SuperScan 4.0 (XP)
nmap 3 UDP (RH8) 
nmap 3.5 (XP)
scanline  1.01 (XP)
nikto 1.32 (XP)
Demo
Exploring nmap 3.0 in depth
(port to IP to IP to port)
default (root)
stealth FIN (-sF)
NULL (-sN)
SYN (-sS -O)
stealth SYN (-sS)
CONNECT (-sT)
UDP (-sU)
XMAS (-sX)
nmap within Nessus 
(port to IP to IP to port)
CONNECT (-sT)
UDP (-sU)
Nessus 2.0.10
Codebase Evolution
SuperScan 3.0
scanline 1.01
SuperScan 4.0
Three Parallel Scans
WinNMap
SuperScan 4.0
Example 4: Vulnerability Scanner
Nessus 2.0.10
Sara 5.0.3
Light
Medium
Heavy
Example 5: Wargame
Demo
Findings (Strengths)
• Tools can be fingerprinted
• Threading / multiple processes visible
• OS/Application features visible 
• Sequence of ports scanned visible
• Useful against slow scans
• Useful against distributed scans
Findings (Weaknesses)
• Spoofing
• Interaction with personal firewalls
• Countermeasures
• Scale / Labeling are issues
• Occlusion is a problem
• Greater interactivity required for forensics and less 
aggressive attacks
• Some tools are very flexible
• Source code not available for some tools
Future
• Active scanning, visualization of Nmap results
• Real-time vs. Offline
• Interesting datasets
• Honeypot Fingerprinting
• Other visualization techniques
• Visualization of protocol attacks
• Visualization of application layer attacks
• Visualization of physical layer attacks (?)
• Code up some stand-alone tools
Where to go for more 
information…
• www.rumint.com - for latest version of tool
• Course websites
– http://www.cc.gatech.edu/classes/AY2004/cs7450_spri
ng/detailref.html
– http://people.cs.vt.edu/~north/infoviz/
– http://graphics.stanford.edu/courses/cs448b-04-winter/
– http://www.otal.umd.edu/Olive/
More Information
Information Visualization
• Envisioning Information by Tufte
• The Visual Display of Quantitative Information by Tufte
• Visual Explanations by Tufte
• Information Visualization by Spence
• Information Visualization: Using Vision to Think by Card
• See also the Tufte road show, details at 
www.edwardtufte.com
images: www.amazon.com
What’s on the CD
• rumint visualization tool
• tcpdump | perl | xmgrace
– howto
– sample scripts
• gallery of classic visualizations (w/links)
• webpage with security infovis links
• this talk
Acknowledgements
• 404.se2600
– icer
– StricK
– Rockit
– Hendrick
– Clint
• Kulsoom Abdullah
– http://www.prism.gatech.edu/~gte369k/csc/
• Dr. John Stasko
– http://www.cc.gatech.edu/~john.stasko/
• Dr. Wenke Lee
– http://www.cc.gatech.edu/~wenke/
Questions?
http://carcino.gen.nz/images/index.php/04980e0b/53c55ca5
Backup Slides
Data Format
• tcpdump outputs somewhat verbose output
09:02:01.858240 0:6:5b:4:20:14 0:5:9a:50:70:9 62: 
10.100.1.120.4532 > 10.1.3.0.1080: tcp 0 (DF)
• parse.pl cleans up output
09 02 01 858240 0:6:5b:4:20:14 0:5:9a:50:70:9 
10.100.1.120.4532 10.100.1.120 4532 10.1.3.0.1080 10.1.3.0 
1080 tcp
• analyze.pl extracts/formats for Grace.
0 4532 
1 1080
0 4537 
1 1080 
0 2370 
1 1080
Required Files
Perl, tcpdump and grace need to be installed.
- http://www.tcpdump.org/
- http://www.perl.org/
- http://plasma-gate.weizmann.ac.il/Grace/
to install grace...
Download RPMs (or source)
ftp://plasma-gate.weizmann.ac.il/pub/grace/contrib/RPMS
The files you want
grace-5.1.14-1.i386.rpm
pdflib-4.0.3-1.i386.rpm
Install
#rpm -i pdflib-4.0.3-1.i386.rpm
#rpm -i grace-5.1.14-1.i386.rpm
Hello World Example
# tcpdump -lnnq -c10 | perl parse.pl | perl analyze.pl 
|outfile.dat
# xmgrace outfile.dat &
Optionally you can run xmgrace with an external format language file…
# xmgrace outfile.dat -batch formatfile
See ppt file for more detailed howto information
Hello World Example (cont)
Optionally you can run xmgrace with an external format language file…
xmgrace outfile.dat -batch formatfile
formatfile is a text file that pre-configures Grace e.g.
title "Port Scan Against Single Host"
subtitle "Superscan w/ports 1-1024"
yaxis label "Port"
yaxis label place both
yaxis ticklabel place both
xaxis ticklabel off
xaxis tick major off
xaxis tick minor off
autoscale
To Run Demo
See readme.txt
Two demo scripts…
– runme.bat   (uses sample dataset)
– runme_sniff.bat (performs live capture, must be root)
Note: you must modify the IP address variable in the 
Analyzer script. (See analyzer2.pl for example)
Example 1 - Baseline
• Normal network traffic
– FTP, HTTP, SSH, ICMP…
• Command Line
– Capture Raw Data
• tcpdump -l -nnqe -c 1000 tcp or udp | perl parse.pl > 
exp1_outfile.txt
– Run through Analysis Script
• cat exp1_outfile.txt | perl analyze_1a.pl > 
output1a.dat
– Open in Grace
• xmgrace output1a.dat &
Example 1 - Baseline
Target Machine’s Ports
Remote Machine’s Ports
Example 2 - PortScan
• Light “normal” network traffic (HTTP)
• Command Line 
– Run 2a.bat (chmod +x 2a.bat) 
echo running experiment 2 
echo 1-1024 port scan
tcpdump -l -nnqe -c 1200 tcp or udp > raw_outfile_2.txt
cat raw_outfile_2.txt | perl parse_2a.pl > exp2_outfile.txt 
cat exp2_outfile.txt | perl analyze_2a.pl > output_2a.dat
xmgrace output_2a.dat &
echo experiment 2 completed
Example 3- PortScan “Fingerprinting”
Tools Examined:
•Nmap Win 1.3.1 (on top of Nmap 3.00)
XP Attacker
(http://www.insecure.org/nmap/)
•Nmap 3.00 
RH 8.0 Attacker
(http://www.insecure.org/nmap/)
•Superscan 3.0
RH 8.0 Attacker
(http://www.foundstone.com/index.htm?subnav=resources/navigation.ht
m&subcontent=/resources/proddesc/superscan.htm)
Example 4: Vulnerability 
Scanner
• Attacker: RH 8.0 running Nessus 2.0.10
• Target:  RH 9.0 
Example 5: Wargame
• Attackers:  NSA Red Team
• Defenders: US Service Academies
Defenders lock down network, but must 
provide certain services
Dataset - http://www.itoc.usma.edu/cdx/2003/logs.zip