A Picture is Worth a 
Thousand Words, Literally: 
Deep Neural Networks for Social Stego
Philip Tully  |  Mike Raggo
1
#whoami
2
                        Philip Tully
                                                                             @phtully
Principal Data Scientist at ZeroFOX
PhD (KTH & University of Edinburgh)
Machine Learning and Neural Nets
  Mike Raggo
    @datahiding
  CSO @802 Secure, 17 yrs Stego Research
  StegSpy DC12, Author “Data Hiding”
  NSA National Cryptologic Museum
DC25: Community, Discovery and the 
           Unintended Uses of Technology 
3
2600: The Hacker Quarterly
4
Summer 1992
Summer 2017
25 years
A Picture is Worth a 
Thousand Words, Literally: 
Deep Neural Networks for Social Stego
The Evolution of Steganography
5
DIY Social Steganography
Deep Neural Networks for Social Stego
Data-Driven Red and Blue Teaming
Wrap Up
A Picture is Worth a 
Thousand Words, Literally: 
Deep Neural Networks for Social Stego
The Evolution of Steganography
6
Covert Communication 
7
“. . . any communication channel that can be exploited by a 
process to transfer information in a manner that violates the 
system's security policy.”
Source: U.S. Department of Defense. Trusted Computer System 
Evaluation “The Orange Book”. Publication DoD 5200.28-STD. 
Washington: GPO 1985 
WetStone Labs
Collected Steganography Programs 
Since January 1999 Includes versions
8
Tools are 
simple, 
designed to 
exploit sense 
weaknesses
Many copycats are 
born, with some 
new features,  
greater focus on 
JPEG embedding
Methods  
become 
more 
resilient to 
statistical 
attacks
Multimedia 
begins to 
evolve into a 
viable 
method
New versions emerge of 
existing Alg.  
Steganographic file 
systems begin to emerge
VOIP, RTP and UDP 
techniques emerge 
along with decoys to 
complicate detection 
and recovery
Evolution of Methods
Social Media Stego 
used in images and 
URLs with malware, 
CnC, and covert 
communications
Evolution of Stego - Internet Era 
9
▪ Stego Apps Decoy Techniques (OpenPuff) 
▪ Stealth Alternate Data Streams (NT) 
▪ Weaponized CnC - Operation Shady RAT 
▪ Protocols - VOIP, RTP, UDP => WiFi StegoStuffing, 
Bluetooth (Hosmer/Raggo - Wall of Sheep/Skytalks 
DEF CON 23 & 24)
▪ SmartWatch SWATtackhide.py Tizen SDK - Mike 
Raggo - DEF CON 23 Demo Labs & HackCon  
▪ MP3 ID3 Metadata exploitation - Hosmer/Raggo 
Skytalks DC24
Types of Steganography
10
▪ Text/Linguistic Stego - Natural Language 
▪ Image
▪ Spatial (e.g. LSB) 
▪ Frequency (DCT/DWT) 
▪ Metadata (varies by file type and 
versions) - JPEG EXIF vs. JFIF  
▪ Audio 
▪ Video
▪ Protocols
▪ Use of crypto with stego 
▪ Vigenere, base64, XOR, etc.  
TrendMicro
A Picture is Worth a
Thousand Words, Literally: 
Deep Neural Networks for Social Stego
11
DIY Social Steganography
Social Network Photo Targets 
12
▪Profile Image 
▪Background Image 
▪Posted Image(s)
▪Photo albums 
▪DM images
▪Links to images on 
other websites 
Carrier Image File Types
13
▪ Image quality properties:
▪ Lossy v. Lossless Raster 
Compression
▪ Common file formats:
▪ JPEG (Lossy)
▪ PNG (Lossless)
▪ TIFF (Lossless)
▪ GIF (Lossless)
▪ BMP (Lossless)
Trial and Error - Attempted Methods
14
▪Metadata fields (varies by image 
types JPEG EXIF vs. JFIF, etc.) 
▪LSB - Least Significant Bit 
▪Insertion 
▪Append after EOF marker 
▪Linguistic Steganography
▪Round trip: pre/post upload 
DataGenetics
High-Level Testing Workflow
15
Social 
Network 
Data Hiding 
Survivability
Testing
16
A Picture is Worth a
Thousand Words, Literally: 
Deep Neural Networks for Social Stego
17
Deep Neural Networks for Social Stego
18
100+ hours 
of video uploaded 
per minute.
4.75 billion
pieces of content 
shared per day.
500+ million
tweets per day.
80+ million
images uploaded per 
day.
5 billion
+1’s per day.
Signals in the Social Noise
Social Network Image Proliferation
19
▪Image-based social networks have the 
fastest growing user bases
▪Image-based social networks enjoy the 
highest daily time spent by users
▪“Photos or Images” is the content 
category most frequently shared
▪Social posts containing images produce 
650% higher engagement than text alone
Social Networks as Stego Conduits
20
▪Heavily trafficked, tons of images
▪Public nature and #broadcast capabilities
▪Convenient APIs for sharing (uploading / 
downloading) content for devs & apps
▪Fake account creation is trivial
▪Lack of IoC’s from network perspective
▪Wild examples - C&C, malware, phishing
Social Stego in the Wild
21
White Hat: Instegogram [ENDGAME] 
Black Hat: HAMMERTOSS [FireEye] 
Secretbook by Owen Campbell-Moore
22
▪ Open-source Social Stego tool
▪ Chrome Extension (2013)
▪ Reverse engineered Facebook’s 
lossy compression algorithm
▪ Allowed for payloads of up to 140 
characters in length
▪ Other heuristic DCT schemes exist
23
Bulk Image Uploads/Downloads
▪Data Acquisition made easy
■
Permissive APIs for content creation 
■
More content=more engagement=profit
▪Off-the-shelf photo aggregators
■
Facebook albums
■
Pinterest boards
■
Flickr sets
■
Google+ Collections
▪Or we can do it the ‘hard way’
■
for photo in album{
upload(photo); sleep(randInt); }
Automated High-Level Testing Workflow
24
Jamming Techniques
25
▪ Server-side image upload 
restrictions and alterations
▪ Fast mobile content delivery
▪ Common Image upload Alterations:
▪ Compression
▪ Lowpass filtering (slight blur)
▪ Metadata stripping
▪ Filetype conversion
▪ Resizing
▪ Alpha compositing
Targeting Unaltered Carrier Pixels
26
08 02 22 97 38 15 00 75 04 05 07 78 52
49 49 99 40 17 81 18 57 60 87 17 40 98
81 49 31 73 55 79 14 29 93 71 40 67 53
52 70 95 23 04 60 11 42 69 24 65 56 54 
22 31 16 71 51 67 63 89 41 92 36 54 22 
24 47 32 60 99 03 45 02 44 75 33 53 78
32 98 01 20 64 23 67 10 26 38 40 67 59
67 26 20 68 02 62 12 20 95 63 94 39 63
27
What humans see
What computers see
Auto-Generating Data
▪Select ~50k samples (e.g. ImageNet)
▪Automate uploads and downloads
▪=100k pre-uploaded and downloaded images
▪Compare pixels between phases
▪Can location choices be automated?
▪‘Classic’ Neural Nets don’t scale to images
■
width * height * 3 channels = unmanageable # weights
■
encode these properties into the architecture
28
Convolutional Neural Networks
▪Proven great for Computer Vision Tasks
■
Object classification, Facial recognition
▪Pose as Binary Classification Tasks
■
Locate optimally embeddable pixels
■
Akin to image segmentation
■
Feedforward networks and function approximation
▪Model spec
■
Keras on top of TensorFlow (Python)
■
Google GPU (8 vCPU Nvidia Tesla)
■
contracting/expanding, ~23 layers fed thru ReLUs
Illustration: Andrej Karpathy
CNNs: Szegedy, Toshev & Erhan, 2013
29
Image Segmentation - Predict Binary Masks
Left: DeepMask [Facebook Research]
Above: u-net [Ronneberger et al]
30
Prototype Evaluation
▪More robust, less detectable transmission
▪Recovery rates worsen with len(hidden data)
■
94.1% accuracy (FPs=lost data, FNs=lower capacity)
▪Minimizes Visual Dissimilarity
■
Distortion: peak signal-to-noise ratio, MS-SSIM
■
Capacity: bit survivability 
■
Otherwise, watermarking
▪Learned pixels correlate w/ carrier locations 
that are more complex and “busier”
31
Innovation and Novelty
▪Spatial stego = more storage capacity than 
frequency stego, compression-intolerant 
▪Previous ad hoc approaches weren’t data- 
driven. Learn from uploads (feedback)
■
Updated processing logic = retrain
■
In principle, generalizes across social networks
▪No need to know implementation details of 
compression or other nonlinear processing
■
Documentation not usually available anyway
+
=
Spatial Steganography
Frequency Steganography
↓DCT
Invert ↑
Modify DCT
A Picture is Worth a
Thousand Words, Literally: 
Deep Neural Networks for Social Stego
32
Data-Driven Red and Blue Teaming
 InfoSec ML Historically Prioritizes Defense
TIME
33
Data-Driven Social Engineering
34
Level of Effort
Success Rate
SNAP_R
Fully Automated
30-35% Accuracy
Spear Phishing
Highly Manual
45% Accuracy
Phishing
Mostly Automated
5-14% Accuracy
Low
High
Low
High
▪DEF CON 24
▪Why Twitter?
■
Bot-friendly API
■
Colloquial syntax
■
Shortened URLs
■
Abundant personal data
▪Machine grammar suffices
Red Team ML Rising
35
▪Growing number of examples:
■
Micro-targeted social engineering
■
Password cracking
■
Captcha subversion
■
AV evasion
■
Steganography
▪Offensive ML easier than defensive ML!
■
“Labeling Bottleneck” - unsupervised
▪Success matters more for blue than red team
▪Retreating barriers to entry
■
More open-source initiatives
■
Cheapening access to powerful machines (eg. GPUs) 
Not to worry, though...
36
▪Offensive ML a positive development
▪It will “keep us honest”
▪Emerging defenses keep pace:
■
Semi-supervised learning
■
Adversarial learning
■
Transfer learning
■
Self-supervised reinforcement learning
▪Ultimately fortify security
▪Faster this is realized, the better
A Picture is Worth a
Thousand Words, Literally: 
Deep Neural Networks for Social Stego
37
Wrap Up
Use Cases
38
▪ Data exfiltration, digital dead drops, C&C 
▪ Bypass online censors
▪ Privacy - Metadata tracks thru social 
                  media. Strip it if there’s concern
▪ Piracy - copyright in metadata
▪ Social media security awareness
Next Steps 
39
▪ More social networks, crypto
▪ Deal w/ filters, resizing
▪ Fragment/Disperse payload
▪ Test more file types
▪ Video files (MP4, MOV, etc.)
▪ News Feed promoted, soon-to-be most popular
▪ Audio files (MP3)
▪ Create custom MP3s w/ GarageBand, embedded JPEG insertion
▪ ID3 Headers DC 24 SkyTalks Hosmer/Raggo 
www.python-forensics.org
Mitigations
40
▪ More dynamic jamming techniques
▪ Histogram “zigzag” - color quantization 
▪ Statistical:  Means, variances, chi-square tests, 
    linear analysis, wavelet statistics, kurtosis
▪ Impermanence: delete by default 
▪ Ephemeral images a la Snapchat
▪ Steganalysis is hard w/o access to orig image
▪ Further obscurement through social’s scale, variance
Summary and Questions
41
▪ Social networks and image hosting 
services can be orthogonally used to 
transmit data covertly
▪ Steganography can be automated despite 
distorting image upload side effects 
▪ Offensive AI is cheaper and easier to 
implement than defensive AI
▪ Code to be released on GitHub piecemeal, 
followed by technical report (WIP)
Philip Tully
@phtully
Mike Raggo
@datahiding