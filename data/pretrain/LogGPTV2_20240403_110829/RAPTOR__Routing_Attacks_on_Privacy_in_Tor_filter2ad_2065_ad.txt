Bidirectional paths (day 21)
Total
Name
OVH
Hetzner
Online.net
# pfx
11.80
6.68
10.52
2.58 Wedos
4.27
3.86
39.71
Leaseweb
PlusServer
ASN
16276
24940
12876
197019
16265
8972
5
10
15
20
Time (Day)
Figure 9: Percentage of Tor circuits vulnerable to an AS
level adversary
if we also consider asymmetric paths (i.e., also look for
common ASes between P1 and P4, P2 and P3, and P2 and
P4), the percentage of vulnerable Tor circuits nearly dou-
bled to 21.3% on the ﬁrst day (blue line in Fig. 9), and
nearly tripled to 31.8% at the end of the three week pe-
riod (green line in Fig. 9).
5 BGP Attacks: Hijack and Interception
In this section, we study and evaluate the feasibility
of BGP hijack and interception attacks on the Tor net-
work. First, we show that Tor relays tend to be concen-
trated within few ASes and IP preﬁxes—making those
highly attractive targets for hijack and interception at-
tacks (§5.1). Second, we show that, in several real-
world BGP hijack attacks, Tor relays were among the
target preﬁxes (§5.2). Third, we perform a real-world
BGP interception attack against a live Tor guard relay,
with success, to demonstrate the ability to accurately
deanonymize Tor clients (§5.3).
5.1 Tor relays concentration
The amount of Tor trafﬁc attracted by a hijack or an in-
terception attack depends on the number of relays that
lie within the corresponding preﬁx. As such, preﬁxes
and ASes that host many relays of high bandwidth are an
interesting targets for attackers. To evaluate how vulner-
able the Tor network was to hijack and interceptions at-
tacks, we computed the number of relays present in each
AS and in each BGP preﬁx. Surprisingly, close to 30%
of all relays are hosted in only 6 ASes and 70 preﬁxes.
Together, these relays represent almost 40% of the band-
width in the entire Tor network (see Table 5). As such,
these few preﬁxes constitute extremely attractive targets.
Table 5: 6 ASes and 70 preﬁxes host ∼30% of all Tor
guard and exit relays as well as ∼40% of the entire Tor
network bandwidth. As such, these constitute extremely
attractive targets for hijacks and interceptions attacks.
5.2 Known Preﬁx Hijacking Attacks
While there have been numerous well-documented BGP
preﬁx hijacks and interceptions, it was unknown whether
Tor trafﬁc was intercepted or not. To this extent, we stud-
ied occurrences of well-known preﬁx hijacks and looked
for leaked preﬁxes covering at least a Tor relay. To do so,
we gathered BGP updates from Routeviews [7] around
the time of each attack and ﬁltered out the ones unre-
lated to Tor preﬁxes. Overall, we found that three well-
known hijacks affected Tor relays: two separate incidents
involving one of Indonesia’s largest telecommunication
networks, Indosat, as well as one malicious hijack attack
whose goal was to steal Bitcoins.
Event
# hijacked
relays
# hijacked
guards
# hijacked
exits
Indosat 2011
Indosat 2014
5 (0.24%)
44 (0.80%)
1 (0.15%)
38 (1.80%)
4 (0.44%)
17 (1.65%)
Table 6: Summary statistics for known Indosat preﬁx hi-
jacking events.
Indosat 2011. On January 14th, 2011, Indosat (AS4761)
originated 2,800 new preﬁxes, which covered 824 differ-
ent ASes [2]. 7 of these preﬁxes affected the Tor net-
work by covering 5 of the Tor relays. As discussed in
Section 2, Indosat could potentially have learned infor-
mation about the client IP addresses associated with each
of the guard relays (reduced anonymity set).
Indosat 2014. On April 3, 2014, Indosat originated
417,038 new preﬁxes;
it usually originates 300 pre-
ﬁxes [3]. This compromised 44 Tor relays, 38 of which
were guard relays and 17 of which were exit relays (11
hijacked relays were both guards and exits). Table 6
shows the summary statistics of both Indosat hijacking
incidents.
Canadian Bitcoin 2014.
From February 2014 to
May 2014, an attacker compromised 51 networks at
278  24th USENIX Security Symposium 
USENIX Association
8
Internet
traic
Internet
traic
announce 
184.164.244.0/23
GATECH
(AS 2637)
ISI
(AS 226)
VPN 
Tunneling
VPN 
Tunneling
Transit
Portal
Public AS
47065
Transit
Portal
Public AS
47065
client
guard relay
announce 
184.164.244.0/23
GATECH
(AS 2637)
announce 
184.164.244.0/24
ISI
(AS 226)
VPN 
Tunneling
VPN 
Tunneling
Transit
Portal
Public AS
47065
Transit
Portal
Public AS
47065
client
guard relay
Figure 10: Transit Portal setup
Figure 11: ISI performing interception attack
19 different ISPs, and resulted in the theft of ap-
proximately $83,000 in Bitcoin [1]. We found that
198.245.63.0/24 and 162.243.142.0/24 were hijacked,
and contained a Tor relay, 198.245.63.228. AS16276
(OVH) owns 198.245.63.0/24, but this preﬁx was hi-
jacked by AS21548 (MTO Telecom). The Tor relay that
consequently was hijacked, 198.245.63.228, was a guard
relay located in Montreal, Quebec.
While we do not make any claims about the intent of
the above hijacking ASes, our analysis shows the exis-
tential threat of real-world routing attacks on the Tor net-
work. Furthermore, the fact that the Tor and the research
community missed noticing the presence of Tor relays
among the hijacked preﬁxes is surprising.
5.3 BGP Preﬁx Interception Attack Exper-
iment
Methodology and setup. We now demonstrate the feasi-
bility of the interception attack by performing one, with
success, on the live Tor network. For that, we set up a
machine to run as a Tor guard relay and made it reachable
to the Internet by announcing a /23 preﬁx in BGP using
Transit Portal (TP) [43]. TP enables virtual ASes to es-
tablish full BGP connectivity with the rest of the Internet
by proxying their announcements via dozens of world-
wide deployments. Next, we conﬁgure the 50 Tor clients
in PlanetLab to use our Tor guard relay as the entry relay
to reach 50 web servers, also hosted in PlanetLab.
In order to perform the BGP preﬁx interception at-
tack, we used two TP deployments (GATECH and ISI),
located in different ASes. GATECH TP served the pur-
pose of the “good” AS through which Tor trafﬁc is nor-
mally routed, while ISI TP served as the “malicious”
AS which performed the interception attack. We con-
nected the two TPs to our Tor relay machine via VPN
tunnels. First, in order for our Tor guard relay (run-
ning on 184.164.244.1) to be reachable, we advertised
184.164.244.0/23 (run by us in its entirety for the dura-
tion of our research) via the GATECH TP, so that trafﬁc
destined for IP addresses within that range will be routed,
ﬁrst to the GATECH TP, and then sent to our machine
via the corresponding tunnel. We illustrate our setup in
Fig. 10.
Next, We advertise BGP preﬁx 184.164.244.0/24
via the ISI TP, which constitutes a more-speciﬁc preﬁx
attack against the original announcement announced by
the GATECH TP. Thus, after the new BGP preﬁx an-
nouncement gets propagated through the internet, Tor
client trafﬁc that is destined for our guard will be sent
to ISI instead. Since we conﬁgured the ISI TP to forward
trafﬁc to our guard machine, the Tor relay can still re-
ceive the trafﬁc and keep the Tor connection alive after
the attack. We illustrate the interception attack model in
Fig. 11.
Our setup constitutes a BGP interception attack. Ini-
tially, trafﬁc is routed via GATECH and arrives at our Tor
relay machine via GATECH tunnel. After the attack hap-
pens, trafﬁc drains from GATECH tunnel and gets routed
via ISI, and thus comes to our Tor relay machine via ISI
tunnel instead. Since the trafﬁc still arrives at the relay
machine, it is an interception attack and the connection
does not get interrupted. We use tcpdump on our relay
machine, listening to ISI tunnel, to capture client TCP ac-
knowledgment trafﬁc coming from that tunnel, which is
exactly the data that an adversary would get from launch-
ing such an interception attack.
In the experiment, we ﬁrst launch simultaneous HTTP
requests using wget at the 50 Tor clients for the 100MB
ﬁle at the 50 web servers. Then, 20 seconds after launch-
ing the wget requests, we start announcing the more-
speciﬁc preﬁx via ISI. We use tcpdump listening to ISI
tunnel to capture TCP acknowledgment trafﬁc sent from
the Tor clients during the interception attack. We also use
tcpdump to capture trafﬁc at the web servers during the
whole process. Finally, 300 seconds after launching the
USENIX Association  
24th USENIX Security Symposium  279
9
)
B
M
(
a
t
a
D
5
1
0
1
5
0
)
B
M
(
a
t
a
D
5
1
0
1
5
0
client
server
)
B
M
(
a
t
a
D
0
.
2
5
.
1
0
.
1
5
.
0
0
.
0
client
server
)
B
M
(
a
t
a
D
0
.
2
5
.
1
0
.
1
5
.
0
0
.
0
0
100
200
300
400
0
100
200
300
400
0
50
100
150
200
250
0
50
100
150
200
250
Time (s)
Time (s)
Time (s)
Time (s)
(a) Trafﬁc Flow via GATECH
(b) Trafﬁc Flow via ISI
(a) Client & Correlated Server
(b) Client & Uncorrelated Server
Figure 12: Trafﬁc Flow During the Experiment
Figure 13: Client ACK versus Server ACK analysis
attack, we send a withdrawal message via the ISI TP, so
the trafﬁc will be routed via GATECH again as normal.
Our interception attack successfully deanonymized
Tor sources with a 90% accuracy rate. In Fig. 12, we
plot the Tor trafﬁc ﬂow captured on our relay machine
from both GATECH tunnel and ISI tunnel. We can see
that all trafﬁc is routed via GATECH at the beginning.
At t = 20s, ISI starts advertising a more speciﬁc /24 pre-
ﬁx, which takes approximately 35 seconds for it to be
propagated through the internet and drain the trafﬁc from
GATECH. At t = 55s, trafﬁc starts showing up via ISI,
and GATECH does not receive trafﬁc any more. Then,
at t = 300s, ISI withdraws the IP preﬁx announcement,
which takes approximately 22 seconds for the trafﬁc to
appear back on GATECH again. During this interception
process, the connection stays alive.
The captured data from ISI tunnel is client TCP ac-
knowledgment trafﬁc. Thus, we will employ our Asym-
metric Trafﬁc Analysis approach, described in Section 3,
with sample size of 50 client machines and 50 server
machines to do the correlation analysis to deanonymize
users’ identity. We achieve 90% accuracy rate (see Ta-
ble 7).
Client ACK/Server ACK
Accuracy
Rate
90%
False
Negative
False
Positive
8%
2%