Google AuthSub, 326–327
Google Docs, 279, 284, 302
grant_type parameter, 87, 91, 144
G Suite, 304
H
Handshake protocol, 365
Alert protocol, 365
Certificate Verify message, 372
Change Cipher Spec protocol, 365
Cipher suites, 370
Client Hello message, 367, 368
Client Key Exchange, 373
premaster key, 371
Server Change Cipher Spec, 374
Server Hello message, 369
Harvard Business Review (HBR), 43
Hash-based Message Authentication 
Code (HMAC), 97, 158, 433
Hash collision attack (HashDoS), 58
HMAC-SHA256
JSON payload, 178, 180
non-JSON payload, 183, 184
HTTP basic authentication
GitHub API, accessing, 402–405
vs. HTTP digest authentication, 411
1.0 specification, 402
Recipe API, 418, 419
HTTP digest authentication
client key elements, 408, 410
MD5-sess, 410
Index
442
1.0 specification, 406
Recipe API, 422
RFC 2617, 410
server key elements, RFC 2617, 407
WWW-Authenticate challenge, 411
HTTP Request-Line, 433
Hypertext Transfer Protocol  
(HTTP), 18, 358
Hypervisor, 52
I
iCloud password, 37
Identity delegation model, 321
evolution
Flickr, 327
Google AuthSub, 326, 327
Google client login, 325
history, 323
OAuth, 328–330
protocols, 330
SlideShare, pre-2006, 324
Twitter, pre-2006, 324
Yahoo! BBAuth, 327, 328
Identity provider mix-up, 287
attack, 289
authorization server, 290
callback URLs, 290
grant type, 290
IdP options, 288
IETF draft specification, 290
redirection, 289
TLS, 288
Identity theft resource center, 34
Implicit grant type, 88–90, 301, 302
Indirect delegation, 322
Infrastructure as a service (IaaS), 38, 52
Integrated development  
environment (IDE), 70
Integrated Windows  
Authentication (IWA), 308
Integrity, 56
Inter-app communication
HTTPS URI scheme, 234
loopback interface, 234
private URI scheme, 234
Internet of Things (IoT), 1
Internet Protocol (IP), 359
J
Java Database Connectivity (JDBC), 14, 15
Java KeyStore (JKS), 74
JavaScript object signing and  
encryption (JOSE)
claims set, 160, 161
specification, 161–163
header, 158
parameters, 159
signature, 163–166
working groups, 166
JSON Web Encryption (JWE), 136, 185
JSON Web Signature (JWS), 56, 136, 167
compact serialization (see JWS 
compact serialization)
JWS JSON serialization (see JWS JSON 
serialization)
JSON Web Signature,  
nonrepudiation, 311, 312
JSON Web Token (JWT), 97, 121,  
134, 157, 267
aud parameter, 274
authorization server, 121, 123, 124
exp parameter, 275
MAC, 275
HTTP digest authentication (cont.)
Index
443
nbf parameter, 275
token validation, 274
JWE compact serialization, 185
ciphertext, 194
initialization vector, 194
JOSE header, 186, 188–191
JWE Encrypted Key, 191
process of encryption, 195, 196
JWE JSON serialization, 196
authentication tag, 199
ciphertext, 198
encryption process, 199, 200
initialization vector, 198
per-recipient unprotected header, 198
protected header, 197
unprotected header, 197
JWE vs. JWS, 202, 203
JWS compact serialization
JOSE header, 167, 169–172
JWS payload, 172
JWS signature, 172
process of signing, 172, 173
JWS JSON serialization, 174
building ingredients, 176, 177
payload, 174
protected header, 175
signature, 175
unprotected header, 175
JWT client authentication
application, 271–273
OAuth authorization server, 270
parameters, 271
RFC 7523, 271
JWT grant type
applications, 269, 270
assertion, 268
grant_type, 268
identity provider, 267
OAuth 2.0, grant types, 267
RFC 7521, 268
scope parameter, 268
JWT Secured Authorization Request 
(JAR), 97, 98
K
Keep it simple, stupid (KISS)  
principle, 48
Kerckhoffs’ principle, 44, 66
Key agreement, key wrapping, 193
Key encryption, 193
Key generation, 247
Key wrapping, 193
L
Least common mechanism, 52, 53
Lightweight directory access protocol 
(LDAP), 40
Linux Security Modules (LSM), 63
M
MD5 algorithm, 38
Message Authentication Code  
(MAC), 64, 275
Message Authentication Code  
(MAC) Token Profile, 425
Microservices
business capabilities, 29
componentization, 28
decentralized governance, 30
design for failure, 31
infrastructure automation, 30
products, 29
smart endpoints, 29
Index
444
Microsoft Active Directory (AD), 305
Mobile Single Sign-On (SSO), login
direct credentials, 228, 229
system browser, 230, 231
WebView, 229, 230
Multifactor authentication, 59, 60
Mutual Transport Layer Security  
(mTLS), 220, 305
N
National Security Agency (NSA), 41, 46, 355
Nested JWT, 201, 207, 209
Netflix API, 25
Nginx, 246, 254
Nonrepudiation, 64, 65, 312
O
OAuth 1.0
oauth signature
building signature, 343
business API invocation, 344, 346
PLAINTEXT method, 340
temporary-credential request 
phase, 340, 342
token credential request  
phase, 342
three-legges vs. two-legged  
oauth, 346
token dance
business API, invoking, 338, 339
resource-owner authorization 
phase, 335
temporary-credential request 
endpoint, 333, 334
token-credential request  
phase, 336, 337
OAuth 1.0 vs. OAuth 2.0, 96
OAuth 2.0
access delegation problem, 81, 83
actors role, 83
client types
confidential clients, 96
public clients, 96
MAC Token Profile
access token, 431
audience parameter, 431
vs. Bearer token, 427
cURL command, 429
grant types, 436
HMAC-SHA1, 433
HMAC-SHA256, 433
parameter, 430
protected API invocation, 432
HTTP Request-Line, 433, 434
resource server, validation, 435, 436
response_type value, 428
refresh token, 92
WRAP (see Web resource authorization 
profiles (WRAP))
OAuth 2.0 device authorization grant
authorization request, 239, 240
authorization server, 238
draft proposal, 237
expires_in parameter, 239
grant_type parameter, 239
login flow, 238
OAuth 2.0 Grant Types vs. OAuth  
WRAP Profiles, 84
OAuth 2.0 MAC Token Profile vs.  
OAuth 2.0, 437
OAuth 2.0, native mobile app
access token, 233
authorization, 233
Client Registration profile, 232
Index
445
identity provider, 232
inter-app (see Inter-app 
communication)
login flow, 232
PKCE, 235–237
URL scheme, 233
OAuth 2.0 refresh tokens, 249
OAuth 2.0 token validation, 109
OAuth bearer token, 95
Open design principle, 49, 50
OpenID connect
Amazon, 132
API security, 154
directed identity, 131
dynamic client  
registration, 151, 155
flow chart representation, 148
identity provider metadata, 149
ID token, 134
attributes, 134
JWE, 136
JWS, 136
JWT, 134
overview, 129
protocol flow, 131
relying party, 130
request attributes, 139
user attributes, 142, 145
WebFinger protocol, 146
identity provider, 149
rel parameter, 148
resource parameter, 148
Open policy agent (OPA), 64
Open redirector
attack, 299
attack, prevention, 299, 300
query parameter, 298
redirect_uri, 298
OpenSSL on Docker, 78, 79
Optimal asymmetric encryption padding 
(OAEP) method, 192
P, Q
@PathVariable, 72
Perfect forward secrecy (PFS), 376
Personal financial management (PFM) 
application, 277, 281
Phishing attack
domain name, 303
Facebook, 304
Google Docs, 302, 303