title:Toward the Accurate Identification of Network Applications
author:Andrew W. Moore and
Konstantina Papagiannaki
Toward the Accurate Identiﬁcation of
Network Applications
Andrew W. Moore1,(cid:1) and Konstantina Papagiannaki2
1 University of Cambridge
PI:EMAIL
2 Intel Research, Cambridge
PI:EMAIL
Abstract. Well-known port numbers can no longer be used to reliably
identify network applications. There is a variety of new Internet appli-
cations that either do not use well-known port numbers or use other
protocols, such as HTTP, as wrappers in order to go through ﬁrewalls
without being blocked. One consequence of this is that a simple inspec-
tion of the port numbers used by ﬂows may lead to the inaccurate clas-
siﬁcation of network traﬃc. In this work, we look at these inaccuracies
in detail. Using a full payload packet trace collected from an Internet
site we attempt to identify the types of errors that may result from port-
based classiﬁcation and quantify them for the speciﬁc trace under study.
To address this question we devise a classiﬁcation methodology that re-
lies on the full packet payload. We describe the building blocks of this
methodology and elaborate on the complications that arise in that con-
text. A classiﬁcation technique approaching 100% accuracy proves to be
a labor-intensive process that needs to test ﬂow-characteristics against
multiple classiﬁcation criteria in order to gain suﬃcient conﬁdence in
the nature of the causal application. Nevertheless, the beneﬁts gained
from a content-based classiﬁcation approach are evident. We are capable
of accurately classifying what would be otherwise classiﬁed as unknown
as well as identifying traﬃc ﬂows that could otherwise be classiﬁed in-
correctly. Our work opens up multiple research issues that we intend to
address in future work.
1
Introduction
Network traﬃc monitoring has attracted a lot of interest in the recent past.
One of the main operations performed within such a context has to do with the
identiﬁcation of the diﬀerent applications utilising a network’s resources. Such
information proves invaluable for network administrators and network designers.
Only knowledge about the traﬃc mix carried by an IP network can allow eﬃcient
design and provisioning. Network operators can identify the requirements of
(cid:1) Andrew Moore thanks the Intel Corporation for its generous support of his research
fellowship.
C. Dovrolis (Ed.): PAM 2005, LNCS 3431, pp. 41–54, 2005.
c(cid:1) Springer-Verlag Berlin Heidelberg 2005
42
A.W. Moore and K. Papagiannaki
diﬀerent users from the underlying infrastructure and provision appropriately.
In addition, they can track the growth of diﬀerent user populations and design
the network to accommodate the diverse needs. Lastly, accurate identiﬁcation
of network applications can shed light on the emerging applications as well as
possible mis-use of network resources.
The state of the art in the identiﬁcation of network applications through traf-
ﬁc monitoring relies on the use of well known ports: an analysis of the headers
of packets is used to identify traﬃc associated with a particular port and thus
of a particular application [1, 2, 3]. It is well known that such a process is likely
to lead to inaccurate estimates of the amount of traﬃc carried by diﬀerent ap-
plications given that speciﬁc protocols, such as HTTP, are frequently used to
relay other types of traﬃc, e.g., the NeoTeris VLAN over HTTP product. In ad-
dition, emerging services typically avoid the use of well known ports, e.g., some
peer-to-peer applications. This paper describes a method to address the accurate
identiﬁcation of network applications in the presence of packet payload informa-
tion1. We illustrate the beneﬁts of our method by comparing a characterisation
of the same period of network traﬃc using ports-alone and our content-based
method.
This comparison allows us to highlight how diﬀerences between port and
content-based classiﬁcation may arise. Having established the beneﬁts of the
proposed methodology, we proceed to evaluate the requirements of our scheme
in terms of complexity and amount of data that needs to be accessed. We demon-
strate the trade-oﬀs that need to be addressed between the complexity of the
diﬀerent classiﬁcation mechanisms employed by our technique and the resulting
classiﬁcation accuracy. The presented methodology is not automated and may
require human intervention. Consequently, in future work we intend to study its
requirements in terms of a real-time implementation.
The remainder of the paper is structured as follows. In Section 2 we present
the data used throughout this work. In Section 3 we describe our content-based
classiﬁcation technique. Its application is shown in Section 4. The obtained re-
sults are contrasted against the outcome of a port-based classiﬁcation scheme.
In Section 5 we describe our future work.
2 Collected Data
This work presents an application-level approach to characterising network traf-
ﬁc. We illustrate the beneﬁts of our technique using data collected by the high-
performance network monitor described in [5].
The site we examined hosts several Biology-related facilities, collectively re-
ferred to as a Genome Campus. There are three institutions on-site that employ
1 Packet payload for the identiﬁcation of network applications is also used in [4].
Nonetheless, no speciﬁc details are provided by [4] on the implementation of the
system thus making comparison infeasible. No further literature was found by the
authors regarding that work.
Toward the Accurate Identiﬁcation of Network Applications
43
Table 1. Summary of traﬃc analysed
Total
Total 573,429,697
Total
Packets MBytes
268,543
As percentage of Total
98.596
0.710
0.617
0.077
94.819
3.588
1.516
0.077
TCP
ICMP
UDP
OTHER
about 1,000 researchers, administrators and technical staﬀ. This campus is con-
nected to the Internet via a full-duplex Gigabit Ethernet link. It was on this
connection to the Internet that our monitor was placed. Traﬃc was monitored
for a full 24 hour, week-day period and for both link directions.
Brief statistics on the traﬃc data collected are given in Table 1. Other proto-
cols were observed in the trace, namely IPv6-crypt, PIM, GRE, IGMP, NARP
and private encryption, but the largest of them accounted for fewer than one
million packets (less than 0.06%) over the 24 hour period and the total of all
OTHER protocols was fewer than one and a half million packets. All percentage
values given henceforth are from the total of UDP and TCP packets only.
3 Methodology
3.1 Overview of Content-Based Classiﬁcation
Our content-based classiﬁcation scheme can be viewed as an iterative procedure
whose target is to gain suﬃcient conﬁdence that a particular traﬃc stream is
caused by a speciﬁc application. To achieve such a goal our classiﬁcation method
operates on traﬃc ﬂows and not packets. Grouping packets into ﬂows allows for
more-eﬃcient processing of the collected information as well the acquisition of
the necessary context for an appropriate identiﬁcation of the network applica-
tion responsible for a ﬂow. Obviously, the ﬁrst step we need to take is that of
aggregating packets into ﬂows according to their 5-tuple. In the case of TCP,
additional semantics can also allow for the identiﬁcation of the start and end
time of the ﬂow. The fact that we observe traﬃc in both directions allows clas-
siﬁcation of all nearly ﬂows on the link. A traﬃc monitor on a unidirectional
link can identify only those applications that use the monitored link for their
datapath.
One outcome of this operation is the identiﬁcation of unusual or peculiar
ﬂows — speciﬁcally simplex ﬂows. These ﬂows consist of packets exchanged be-
tween a particular port/protocol combination in only one direction between two
hosts. A common cause of a simplex ﬂow is that packets have been sent to an
invalid or non-responsive destination host. The data of the simplex ﬂows were
not discarded, they were classiﬁed — commonly identiﬁed as carrying worm and
44
A.W. Moore and K. Papagiannaki
Table 2. Methods of ﬂow identiﬁcation
Identiﬁcation Method
Example
I Port-based classiﬁcation (only) —
II Packet Header (including I)
III Single packet signature
IV Single packet protocol
V Signature on the ﬁrst KByte P2P
VI ﬁrst KByte Protocol
VII Selected ﬂow(s) Protocol
VIII (All) Flow Protocol
IX Host history
simplex ﬂows
Many worm/virus
IDENT
SMTP
FTP
VNC, CVS
Port-scanning
virus attacks. The identiﬁcation and removal of simplex ﬂows (each ﬂow con-
sisting of between three and ten packets sent over a 24-hour period) allowed the
number of unidentiﬁed ﬂows that needed further processing to be signiﬁcantly
reduced.
The second step of our method iteratively tests ﬂow characteristics against
diﬀerent criteria until suﬃcient certainty has been gained as to the identity
of the application. Such a process consists of nine diﬀerent identiﬁcation sub-
methods. We describe these mechanisms in the next section. Each identiﬁcation
sub-method is followed by the evaluation of the acquired certainty in the candi-
date application. Currently this is a (labour-intensive) manual process.
Identiﬁcation Methods
3.2
The nine distinct identiﬁcation methods applied by our scheme are listed in Table
2. Alongside each method is an example application that we could identify using
this method. Each one tests a particular property of the ﬂow attempting to
obtain evidence of the identity of the causal application.
Method I classiﬁes ﬂows according to their port numbers. This method rep-
resents the state of the art and requires access only to the part in the packet
header that contains the port numbers. Method II relies on access to the en-
tire packet header for both traﬃc directions. It is this method that is able to
identify simplex ﬂows and signiﬁcantly limit the number of ﬂows that need to
go through the remainder of the classiﬁcation process. Methods III to VIII
examine whether a ﬂow carries a well-known signature or follows well-known
protocol semantics. Such operations are accompanied by higher complexity and
may require access to more than a single packet’s payload. We have listed the
diﬀerent identiﬁcation mechanisms in terms of their complexity and the amount
of data they require in Figure 1. According to our experience, speciﬁc ﬂows may
be classiﬁed positively from their ﬁrst packet alone. Nonetheless, other ﬂows may
need to be examined in more detail and a positive identiﬁcation may be feasible
Toward the Accurate Identiﬁcation of Network Applications
45
Complexity
Flow (all)
Flow (selected)
1st KByte
Packet
a
t
a
D
f
o
t
n
u
o
m
A
VIII
VII
VI
IV
l
o
c
o
t
o
r
P
II
t
r
o
P
V
III
e
r
u
t
a
n
g
i
S
Fig. 1. Requirements of identiﬁcation methods
once up to 1 KByte of their data has been observed2. Flows that have not been
classiﬁed at this stage will require inspection of the entire ﬂow payload and we
separate such a process into two distinct steps. In the ﬁrst step (Method VII)
we perform full-ﬂow analysis for a subset of the ﬂows that perform a control-
function. In our case FTP appeared to carry a signiﬁcant amount of the overall
traﬃc and Method VII was applied only to those ﬂows that used the standard
FTP control port. The control messages were parsed and further context was
obtained that allowed us to classify more ﬂows in the trace. Lastly, if there are
still ﬂows to be classiﬁed, we analyse them using speciﬁc protocol information
attributing them to their causal application using Method VIII.
In our classiﬁcation technique we will apply each identiﬁcation method in turn
and in such a way that the more-complex or more-data-demanding methods (as
shown in Figure 1) are used only if no previous signature or protocol method
has generated a match. The outcome of this process may be that (i) we have
positively identiﬁed a ﬂow to belong to a speciﬁc application, (ii) a ﬂow appears
to agree with more than one application proﬁle, or (iii) no candidate application
has been identiﬁed. In our current methodology all three cases will trigger manual
intervention in order to validate the accuracy of the classiﬁcation, resolve cases
where multiple criteria have generated a match or inspect ﬂows that have not
matched any identiﬁcation criteria. We describe our validation approach in more
detail in Section 3.4.
The successful identiﬁcation of speciﬁc ﬂows caused by a particular network
application reveals important information about the hosts active in our trace.
2 The value of 1 KByte has been experimentally found to be an upper bound for the
amount of packet information that needs to be processed for the identiﬁcation of
several applications making use of signatures. In future work, we intend to address