e
c
i
v
e
D
:
I
V
E
L
B
A
T
d
n
a
s
n
a
e
m
A
N
/
c
i
t
a
m
o
t
u
)
A
e
l
b
a
t
p
e
c
c
a
(
.
t
s
e
u
q
e
r
r
e
s
u
a
i
v
e
t
a
d
p
u
e
c
i
v
e
d
l
a
u
n
a
)
M
(
s
i
n
o
i
t
a
r
u
g
ﬁ
n
o
c
e
c
i
v
e
d
t
l
u
a
f
e
)
D
(
;
p
u
t
e
s
;
e
d
a
r
g
p
u
o
t
e
c
i
v
e
d
e
h
t
r
o
f
d
e
r
i
u
q
e
r
s
i
r
e
s
u
s
i
;
n
o
i
t
n
e
v
r
e
t
n
i
r
e
s
u
t
u
o
h
t
i
w
d
e
i
l
p
p
a
e
c
i
v
e
d
e
h
t
y
b
t
n
e
s
n
o
)
C
(
n
e
h
w
e
g
n
a
h
c
n
o
i
t
a
r
u
g
ﬁ
n
o
c
.
e
t
a
r
e
p
o
o
t
e
c
i
v
e
d
e
r
a
.
e
l
b
a
c
i
l
p
p
a
t
o
n
s
i
y
r
o
g
e
t
a
c
e
h
t
i
n
i
M
L
9
0
0
5
S
C
D
k
n
i
L
-
D
n
o
d
r
a
K
n
o
m
r
a
H
e
d
r
e
V
a
s
a
C
M
b
u
H
n
o
e
t
s
n
I
i
d
l
e
i
h
S
e
m
o
H
e
l
g
o
o
G
e
m
o
H
e
l
g
o
o
G
e
t
i
2
L
a
r
e
V
k
n
i
W
s
o
n
o
S
a
i
d
i
V
n
0
1
V
T
t
r
a
m
S
m
a
c
b
e
W
g
n
u
s
m
a
S
e
s
e
n
i
h
C
y
n
o
m
r
a
H
h
c
e
t
i
g
o
L
h
c
u
o
T
d
n
u
o
S
d
n
o
m
A
ﬁ
l
i
r
u
c
e
S
e
m
a
c
t
e
N
n
i
k
l
e
B
o
M
W
n
i
k
l
e
B
e
o
M
W
n
i
k
l
e
B
n
o
i
t
o
M
e
o
M
W
n
i
k
l
e
B
g
n
u
s
h
c
t
i
m
a
S
w
S
k
n
i
L
d
o
P
e
m
o
H
e
l
p
p
A
s
g
n
i
h
T
t
r
a
m
S
e
k
o
v
n
I
e
s
o
B
b
l
u
b
t
h
g
i
L
s
s
e
l
e
r
i
W
k
e
e
g
o
o
K
a
t
e
s
a
C
e
u
H
s
p
i
l
i
h
P
V
T
o
h
c
E
e
r
i
F
l
l
e
b
r
o
o
D
V
T
4
u
k
o
R
u
k
o
R
n
o
z
a
m
A
n
o
z
a
m
A
t
s
u
g
u
A
Q
y
m
n
i
a
l
r
e
b
m
a
h
C
r
e
n
e
p
O
e
g
a
r
a
G
b
u
H
n
O
e
l
g
o
o
G
b
l
u
B
e
m
o
H
s
g
n
i
h
t
i
ﬁ
i
W
k
n
i
L
-
P
T
W
a
b
m
o
o
R
V
T
e
l
p
p
A
)
n
e
G
h
t
4
(
V
N
r
e
p
i
P
g
u
l
P
o
l
r
A
Q
I
a
r
e
m
a
C
d
r
a
u
G
e
l
c
r
i
C
m
a
C
i
g
o
L
t
s
e
N
t
s
e
N
t
s
e
N
e
l
l
e
b
r
o
o
D
g
n
i
R
ﬁ
i
W
k
n
i
L
-
P
T
o
M
W
n
i
k
l
e
B
r
a
e
g
t
e
N
b
l
u
B
X
F
I
L
y
r
a
n
a
C
t
o
p
k
c
o
r
C
d
e
c
r
o
)
F
(
s
e
t
a
d
p
u
s
w
o
l
l
a
e
c
i
v
e
D
(cid:18)(cid:20)(cid:24)(cid:26)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:41:49 UTC from IEEE Xplore.  Restrictions apply. 
APPENDIX B
EVALUATION CASES
Our evaluation shows that some devices have a better
security posture than others. In this section, we take a look at
three devices that we categorize based on their overall security
evaluation. We propose three categories: good, satisfactory,
and needs improvement, which highlight good security prac-
tices and short-comings.
A. Good: Withings Home
Functional Features.
The Withings Home device is a
camera paired with an air quality sensor. The device has
a mobile companion application, integrates with cloud end-
points, and communicates over the Internet and the local
network. The device exposes mDNS service, which allows
zero-conﬁguration protocols to ﬁnd and conﬁgure the device
(i.e. Apple’s Bonjour). The device uses a low-energy protocol,
Bluetooth, to conﬁgure the device initially, then switches to IP
communication. Device updates are not applied automatically
but require user consent.
Assessment. We found no issues with the mDNS service
running on the device. The companion mobile application
correctly utilizes secure storage facilities to store sensitive
data, correctly uses cryptographic protocols, and has proper
permission provisioning. The majority of the cloud infras-
tructure is self-hosted by Nokia and runs services to enable
user notiﬁcations and control. The network communication
between device-to-cloud, app-to-cloud, and app-to-device uses
full encryption and is not susceptible to MITM attacks. The
device did authenticate in clear-text (an insecure practice)
across the Internet to associate the device with the cloud
management interface that runs an XMPP server 4.
B. Satisfactory: Nest Cam
Functional Features. The Nest Cam is an indoor camera that
senses motion, records video, and notiﬁes users of activities.
The device uses forced conﬁguration, which means users have
to conﬁgure and set up their device before it can operate. The
camera uses the Bluetooth protocol to conﬁgure the device via
the mobile application, which pairs using a pin/barcode located
on the back of the camera. The camera does not utilize the
local network to control the device, all of the activities and
controls operate through the cloud endpoints. Finally, updates
to the device are applied automatically with no user consent,
ensuring the device always has the latest running ﬁrmware.
Assessment. The Nest Cam does not expose any services
but uses a client model, where the device acts as a client
that communicates directly with the cloud endpoints. The lack
of exposed services running on the Nest Cam considerably
shrinks the attack vector and limits an IP-based attacker. The
Nest Cam uses certiﬁcate pinning on the device, which veriﬁes
and validates the device to cloud communication is secure.
The device setup and conﬁguration requires mobile application
4endpoint located at: xmpp.withings.net:5222
TABLE VIII: List of devices and their CVEs with CVSS score
of Critical and High.
Device
CVSS
MiCasa
Verda
VeraLite
Wink 2
CVE
CVE-2012-5958, CVE-2012-5959,
CVE-2012-5960, CVE-2012-5961,
CVE-2012-5962, CVE-2012-5963,
CVE-2012-5964, CVE-2012-5965,
CVE-2013-4863
CVE-2012-0920
CVE-2016-7406, CVE-2016-7407
CVE-2016-7408
Critical
High
Critical
High
pairing via Bluetooth, which both ensures proximity of end-
user and limits remote attack vectors. The mobile application
manages all Nest products, including the Nest Cam, which re-
quests access to the microphone, camera/photos, geolocation,
and other sensitive services. The cloud endpoints fully manage
the Nest Cam, which means without Internet access the device
is inaccessible. The Nest products, in general, forcibly use the
Google DNS recursive and ignore the DHCP conﬁgurations
on the local network. A savvy user can conﬁgure static routes
on their gateway to redirect DNS trafﬁc toward their desired
resolver.
C. Needs Improvment: MiCasa Verde VeraLite
Functional Features. The VeraLite is a smart-home Z-Wave
enabled controller that can monitor and control low-energy
sensors and other devices around the home. The device pairs
through a cloud portal using a pre-printed pin on the back
of the device. The VeraLite requires manual updates, but the
device notiﬁes users of the availability of new updates. The
device exposes four services including a web, DNS, UPnP, and
SSH server. The mobile device requests excessive permissions
like calling, controlling phone network state (on/off/airplane
mode), and access to the camera. The VeraLite is a discontin-
ued product and no longer offered by the vendor.
Assessment. The VeraLite device provides a hardened setting
that disables many of the running services on the device,
but they are on by default. The hardened mode forces the
device management and monitoring from cloud endpoints.
The device has several exploitable vulnerabilities as illustrated
by Table VIII. The UPnP services use a vulnerable version of
the libupnp library, and the SSH services use a vulnerable
dropbear (2016.72) implementation.
The conﬁguration of the SSH server supports Cipher-Block-
Chaining (CBC) mode, speciﬁcally 3des-cbc, aes128-cbc, and
aes256-cbc, which an attacker can exploit
to recover the
plaintext from the ciphertext. The DNS service is conﬁgured
to allow queries for third-party domains that do not have the
recursion bit set; hence allowing attackers to snoop on the
DNS cache. The mobile application requires users to establish
an account with the Vera vendor, which allows end-users to
manage their controller. The device does not use certiﬁcate
pinning, which leaves the deployment susceptible to MITM
attacks. The cloud endpoints use clear-text authentication, run
exploitable services, expose sensitive information, and run
unsupported operating systems.
(cid:18)(cid:20)(cid:25)(cid:17)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:41:49 UTC from IEEE Xplore.  Restrictions apply.