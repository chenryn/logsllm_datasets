[53] R. S. Wahby, I. Tzialla, A. Shelat, J. Thaler, and M. Walfish. 2018. Doubly-Efficient
zkSNARKs Without Trusted Setup. In 2018 IEEE Symposium on Security and
Privacy (SP). 926â€“943. https://doi.org/10.1109/SP.2018.00060
[54] Gavin Wood et al. 2014. Ethereum: A secure decentralised generalised transaction
ledger. Ethereum project yellow paper 151, 2014 (2014), 1â€“32.
[55] Tiacheng Xie, Jiaheng Zhang, Yupeng Zhang, Charalampos Papamanthou, and
Dawn Song. 2019. Libra: Succinct Zero-Knowledge Proofs with Optimal Prover
Session 11B: Zero Knowledge II CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea3015Computation. In Advances in Cryptology â€“ CRYPTO 2019, Alexandra Boldyreva
and Daniele Micciancio (Eds.). Springer International Publishing, Cham, 733â€“764.
[56] Jiaheng Zhang, Weijie Wang, Yinuo Zhang, and Yupeng Zhang. 2020. Dou-
bly Efficient Interactive Proofs for General Arithmetic Circuits with Linear Prover
Time. Technical Report. Cryptology ePrint Archive, Report 2020/1247, 2020.
https://eprint. iacr. org ....
[57] Jiaheng Zhang, Tiancheng Xie, Yupeng Zhang, and Dawn Song. 2020. Transparent
polynomial delegation and its applications to zero knowledge proof. In 2020 IEEE
Symposium on Security and Privacy (SP). IEEE, 859â€“876.
[58] Yupeng Zhang, Daniel Genkin, Jonathan Katz, Dimitrios Papadopoulos, and
Charalampos Papamanthou. 2017. vSQL: Verifying arbitrary SQL queries over
dynamic outsourced databases. In 2017 IEEE Symposium on Security and Privacy
(SP). IEEE, 863â€“880.
[59] Yupeng Zhang, Daniel Genkin, Jonathan Katz, Dimitrios Papadopoulos, and
Charalampos Papamanthou. 2017. A Zero-Knowledge Version of vSQL. (2017).
A Formal definitions
A.1 Discrete logarithm relation assumption
Given a security parameter ğœ†, for every polynomial-time adversary
A and for all n â‰¥ 1, the discrete logarithm relation assumption [11]
assumes that
G â† Setup(1ğœ†),
$â† G,
G1, . . . , Gn
a1, . . . , an â† A(G1, . . . , Gn)
 â‰¤ negl(ğœ†).
(36)
 âˆƒ ai â‰  0 âˆ§
 ai Â· Gi = 0
We say 
Pr
iâˆˆ[n]
where negl(ğœ†) is a negligible function in the security parameter ğœ†.
ai Â· Gi = 0 is a non-trivial discrete logarithm relation
between G1, . . . , Gn. The discrete logarithm relation assumption
states that an adversary cannot find a non-trivial relation between
randomly chosen group elements. It degenerates to the discrete
logarithm assumption when n = 1.
A.2 Properties of Commitment schemes
A secure commitment scheme Com = (Setup, Commit, Check)
must satisfy the notion of correctness, binding and hiding.
(38)
Hiding: Com is perfectly hiding if for every polynomial-time
Binding: Com is computationally binding if for every polynomial-
time adversary A
pp â† Setup(1ğœ†),
(c, r) â† Commit(pp, u)
pp â† Setup(1ğœ†),
(c, u0, r0, u1, r1) â† A(pp)
Pr
adversary A
Pr
Check(pp, c, u, r) = 1
Check(pp, c, u1, r1) = 1 âˆ§
u0 â‰  u1
(cid:34)
Correctness: for any u âˆˆ Mpp, there is
 Check(pp, c, u0, r0) = 1 âˆ§
 A(pp, c) = b
(cid:34) (s, w) âˆ‰ R âˆ¨
Pr
Pr
âŸ¨P(ğœ, s, w), V(ğœ, s; ğœŒ)âŸ© = 1
pp â† Setup(1ğœ†),
(u0, u1) â† A(pp),
$â† {0, 1},
b
(c, r) â† Commit(pp, ub)
(cid:35)
(cid:35)
A.3 Properties of interactive arguments of knowledge
The key security properties for an interactive argument of knowl-
edge Arg = (KeyGen, P,V) are
nomial time adversary A,
Completeness: Arg has perfect completeness if for every poly-
= 1.
(37)
 â‰¤ negl(ğœ†).
 = 1
2 .
(39)
ğœ â† KeyGen(1ğœ†),
(s, w) â† A(ğœ)
= 1.
(40)
In random oracle model, Sim is allowed to run a partial simulation
of the random oracle [4].
Witness-extended emulation: Arg has computational witness-
extended emulation if for all deterministic polynomial-time Pâˆ—,
there exists a polynomial-time emulator E s.t. for every pair of
polynomial-time adversaries A = (A1, A2),
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Pr
 A1(tr) = 1
â€“ Pr
ğœ â† KeyGen(1ğœ†),
(s, w) â† A2(ğœ),
tr â† âŸ¨Pâˆ—(ğœ, s, w), V(ğœ, s)âŸ©
A1(tr) = 1 âˆ§
tr accepting â‡’
(s, w) âˆˆ R
ğœ â† KeyGen(1ğœ†),
(s, w) â† A2(ğœ),
(tr, w) â† EO(ğœ, s)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
â‰¤ negl(ğœ†),
(41)
where E is given oracle access to O = âŸ¨Pâˆ—(ğœ, s, w),V(ğœ, s)âŸ©, which
permits rewinding to a specific point and resuming with fresh
verifier randomness from this point onwards.
Public-coin: Arg is said to be public-coin is all messages sent
by V are sampled uniformly at random and independent of Pâ€™s
messages.
Special honest-verifier zero knowledge: Arg has perfect spe-
cial honest-verifier zero knowledge (PSHVZK) if for every pair of
polynomial-time adversaries A = (A1, A2) and (s, w) âˆˆ R, there
exists a probablistic polynomial-time simulator Sim s.t.
 A1(tr, ğœ, s) = 1
Pr
ğœ â† KeyGen(1ğœ†),
(s, w, ğœŒ) â† A2(ğœ),
tr â† âŸ¨P(ğœ, s, w), V(ğœ, s; ğœŒ)âŸ©
ğœ â† KeyGen(1ğœ†),
(s, w, ğœŒ) â† A2(ğœ),
tr â† Sim(ğœ, s, ğœŒ)
 A1(tr, ğœ, s) = 1
= Pr
.
(42)
A.4 Properties of non-interactive zero-knowledge arguments
of knowledge
The key security properties for a non-interactive zero-knowledge
argument of knowledge Î  are
Completeness: Î  has perfect completeness if for every (s, w) âˆˆ R,
Verify(ğœ, s, ğœ‹) = 1
ğœ â† KeyGen(1ğœ†),
ğœ‹ â† Prove(ğœ, s, w)
= 1
(43)
(cid:34)
Pr
Knowledge soundness: Î  has computational knowledge sound-
ness if for every polynomial-time adversary A there exists a polynomial-
time extractor Ext s.t.
(cid:35)
(cid:35)
ğœ â† KeyGen(1ğœ†),
(s, ğœ‹; w) â† (A||Ext)(ğœ)
â‰¤ negl(ğœ†),
(44)
(cid:34) (s, w) âˆ‰ R âˆ§
Pr
Verify(ğœ, s, ğœ‹) = 1
Zero-knowledge: Î  has perfect zero-knowledge if for every pair
of (s, w) âˆˆ R and every adversary A = (A1, A2) there exists a
simulator Sim that
A1(ğœ, s, ğœ‹) = 1
 (s, w) âˆˆ R âˆ§
 (s, w) âˆˆ R âˆ§
A1(ğœ, s, ğœ‹) = 1
Pr
= Pr
ğœ â† KeyGen(1ğœ†),
(s, w) â† A2(ğœ),
ğœ‹ â† Prove(ğœ, s, w)
ğœ â† KeyGen(1ğœ†),
(s, w) â† A2(ğœ),
ğœ‹ â† Sim(ğœ, s)
.
(45)
Session 11B: Zero Knowledge II CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea3016B Arguments for inner products
The arguments in this section all refer to the Pedersen commitment
scheme in Section 2.2.
B.1 Inner product
We first consider a simple case that with commitments L, R âˆˆ G to
vectors l, r âˆˆ Fn
p and commitment T âˆˆ G to scalar t âˆˆ Fp, a prover
P wants to demonstrate to a verifier V that âŸ¨l, râŸ© = t. In Figure 8
we show a simple protocol for the relation
L, R, T âˆˆ G;
l, r âˆˆ Fn
p, t âˆˆ Fp,
ğœ„, ğœŒ, ğœ âˆˆ Fp
Check(pp, L, l, ğœ„) = 1 âˆ§
Check(pp, R, r, ğœŒ) = 1 âˆ§
Check(pp, T, t, ğœ) = 1 âˆ§
âŸ¨l, râŸ© = t
(46)
 .
It has completeness, witness-extended emulation and zero knowledge.
In particular, it achieves zero knowledge by introducing randomly
sampled mask vectors ld and rd.
Public input: commitments L, R, T âˆˆ G
Pâ€™s private input: l, r âˆˆ Fn
p, t âˆˆ Fp, blinders ğœ„, ğœŒ, ğœ âˆˆ Fp
P : ld, rd
$â† Fn
p,
(Ld, ğœ„d) â† Commit(pp, ld),
s1 = âŸ¨l, rdâŸ© + âŸ¨ld, râŸ©,
(S1, ğœ1) â† Commit(pp, s1),
s2 = âŸ¨ld, rdâŸ©,
(Rd, ğœŒd) â† Commit(pp, rd),
(S2, ğœ2) â† Commit(pp, s2).
P â†’ V : Ld, Rd, S1, S2.
V â†’ P : e
$â† Fp.
P : lâ€² = l + e Â· ld,
ğœ„â€² = ğœ„ + e Â· ğœ„,
P â†’ V : lâ€², râ€², ğœ„â€², ğœŒâ€², ğœâ€².
r = r + e Â· rd,
ğœŒâ€² = ğœŒ + e Â· ğœŒd,
ğœâ€² = ğœ + e Â· ğœ1 + e2 Â· ğœ2.
and
V : Lâ€² = L + e Â· Ld, Check(pp, L, lâ€², ğœ„â€²) ?= 1,
Râ€² = R + e Â· Rd, Check(pp, R, râ€², ğœŒâ€²) ?= 1,
Tâ€² = T + e Â· S1 + e2 Â· S2,
Check(pp, Tâ€², âŸ¨lâ€², râ€²âŸ©,ğ›¾â€²) ?= 1.
Figure 8: Zero-knowledge argument for inner product
B.2 Sum of inner products
Another common scenario is that for a group of vectors {li, ri âˆˆ
p}iâˆˆ[m] committed as {Li, Ri âˆˆ G}iâˆˆ[m], and scalar value t âˆˆ Fp
Fn
committed as T âˆˆ G, P wants to demonstrate that t is the sum of
the m inner products
{Li, Ri âˆˆ G}iâˆˆ[m],
T âˆˆ G;
{li, ri âˆˆ Fn
p}iâˆˆ[m],
{ğœ„i, ğœŒi âˆˆ Fp}iâˆˆ[m],
t âˆˆ Fp, ğœ âˆˆ Fp


iâˆˆ[m]
iâˆˆmâŸ¨li, riâŸ© = t, or more formally
Check(pp, Li, li, ğœ„i) = 1 âˆ§
Check(pp, Ri, ri, ğœŒi) = 1 âˆ§
Check(pp, T, t, ğœ) = 1 âˆ§
iâˆˆ[m]
âŸ¨li, riâŸ© = t

iâˆˆ[m]
In Figure 9, we show how it can be reduced to the single inner
$â† Fp, one may compute
product case. With a random challenger z
.
(47)
p}iâˆˆ[m], t âˆˆ Fp, blinders {ğœ„i, ğœŒi}iâˆˆ[m], ğœ âˆˆ Fp
P : l(Z) = 
Public input: commitments {Li, Ri}iâˆˆ[m], T
Pâ€™s private input: {li, ri âˆˆ Fn
li Â· Z i,
âŸ¨l(Z), r(Z)âŸ© = t +
âˆ€ k âˆˆ [1 â€“ m, m â€“ 1]\0,
r(Z) = 

kâˆˆ[1â€“m,mâ€“1]\0
iâˆˆ[m]
ri Â· Zâ€“i,
iâˆˆ[m]
tk Â· Z k,
$â† Fp.
P â†’ V : {Tk}.
V â†’ P : z
P : lz = l(z) = 

ğœ„z = 

P & V : Lz = 
iâˆˆ[m]
ğœz = ğœ +
tz = t +
iâˆˆ[m]
kâˆˆ[1â€“m,mâ€“1]\0
zi Â· ğœ„i,

kâˆˆ[1â€“m,mâ€“1]\0
zi Â· Li,
iâˆˆ[m]
kâˆˆ[1â€“m,mâ€“1]\0
Tz =
zi Â· li,
zk Â· tk,
ğœŒz = 
Rz = 
iâˆˆ[m]
zk Â· ğœk.
iâˆˆ[m]
zk Â· Tk + T.
zâ€“i Â· ğœŒi,
zâ€“i Â· Ri,
(Tk, ğœk) â† Commit(pp, tk).
rz = r(z) = 
iâˆˆ[m]
zâ€“i Â· ri,
Public input: commitments Lz, Rz, Tz âˆˆ G,
Pâ€™s private input: lz, rz âˆˆ Fn
p, tz âˆˆ Fp, blinders ğœ„z, ğœŒz, ğœz âˆˆ Fp
Figure 9: Argument for sum of inner products
linear combinations of {li}iâˆˆ[m] and {ri}iâˆˆ[m] as
zâ€“i Â· ri,
tk Â· zk.
(48)
(49)