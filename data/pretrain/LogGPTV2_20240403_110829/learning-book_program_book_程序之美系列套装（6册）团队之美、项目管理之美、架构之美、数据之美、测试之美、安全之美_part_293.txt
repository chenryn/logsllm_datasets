TZ
20
40
60
80
20
40
80
80
drSage
dmSago
1662
---
## Page 1664
图17-6：魅力和年龄关系的平滑散点图，每个性别一个图（见彩
图60）
我们还可以试着把它们放到同一张图上（见图17-7）：
>
smoothScatterMult (d$age, d$attractive, d$male, blendFun=b1_bur
n, colramps=
C(colorRampPalette(c("white", "red") ),
ColorRampPalette(c ("white", "blue") ),
colorRampPalette(c ("white", "green") ))， pch=""
nrpoints=10000)
4.0
3.5
2.5
esp
2.0
0
20
40
60
80
d$age
图17-7：魅力和年龄关系的平滑散点图，通过性别着色，在一张
图上交叠显示（见彩图61）
1663
---
## Page 1665
这些图形显示了数据的完全分布，但是很难看出其中的模式。举个
例子，年龄如何影响魅力？通过计算总结统一和绘制它们更容易看
出这一点（见图17-8a）。
For males >dm=d[which(d$male), ]
and females, >df=d[which (d$female), ]
average across faces >male_avg_by_year=by(dm$attractive,
within bins cut (dm$age,breaks=0: 80) , mean)
(oe per year) >female_avg_by_year=by(df$attractive,
then cut (df$age,breaks=0: 80) , mean)
plot them >plot (male_avg_by_year,col='blue*)
all together. >points (female_avg_by_year,col='deeppink')
这个图可以开始描述一个故事了，但还是有点难以理解。有些点是
成千上万张脸当中的平均年龄值，而有些年龄更大的点来自少量的
观察。因此，图的右侧有更多的噪音数据，因为样本更小。
我们给该图增加了两个特征（见图17-8b）。首先，我们计算了95%
的置信区间，确保我们不是欺骗自己去看来自于噪音数据的模式，
置信区间是通过我们有限的数据来估计可能的均值范围的一种方
式。其次，我们将拟合局部加权回归(lcallyweighted
regression,LOESS)曲线，从而有助于对这种噪音序列数据的聚集模式
进行可视化。通常，我们可能会对数据进行线性回归，但是该数据
不是线性的，而且看起来不像我们所知道的任何一个函数。局部加
权回归函数是拟合任意曲线到数据的一种方法。它基本上是执行代
价高的移动平均值。该图还不够完美。图的两边有一些点包含一个
或者两个可以计算置信区间的样本。如果你查看图17-4的年龄直方
图，这些并不奇怪一—看起来超过50岁的人们只占数据集的1.7%。
而且，很多置信区间很大，以至于它们的数据点不是很有意义。因
此，对于包含很少数据点的区域——特别年轻的和年老的——我们
分别使用5年和10年这两种更大的桶。该图看起来噪音数据就少多了
（见图17-8c）。
1664
---
## Page 1666
20406080
20406080
年龄
年龄
图17-8：魅力和年龄以及性别的关系的三种选代绘图：a）平均值
在桶内区间的每个年龄：b）每个桶95%置信区间，以及局部加权回
归曲线：c）更大的桶，其中数据更稀疏（见彩图62）
一般来说，在所有年龄段中，除了婴儿，女人被认为比男人更有魅
力。我们发现婴儿被认为是最有吸引力（魅力）的，但是该吸引力
随着年龄增长而下降，直到18岁左右（可能用户对判定青少年为"有
魅力"的觉得不太自在？），然后魅力又开始上升，在27岁达到最高
值。在那以后，魅力值随着年龄下降，直到50岁，在50岁年龄点
魅力值似乎又开始上升。但是很难确定，因为大于50岁的数据非常
稀疏。
当然，对于20岁左右的非文本属性，存在很多关系需要探索。我们
可以描绘更多类似于图17-8的图，但是我们能否马上看到所有有趣
的交互？我们还是采用两两交互的方法，改变之前描绘的两两结对
图。我们不是在每个面板使用散点图，而是显示单一色彩表示属性
之间的全局关联。蓝色是正向关联，而红色是负向关联（见图17-
9）。
First compute pairwise correlations,
cors=cor (d, use='pair')
and order the attributes to try to >ord=order.hclust(cors)
put similar attributes next to each other.>
cors=cors [ord, ord]
1665
---
## Page 1667
Plot the correlation matrix,
>
image (cors, col=col.corrgram (7) )
with axis labels.
>axis (1， at=seq (0, 1,
length=nrow (cors)) , labels=row.names (cors))
喝醉-
W-B
AMI
和狗打架
值得信任-
WN
N
-
一的
X
AN
显得年轻-
NZZ
富有公公
性频向
魅力
W
W
整形手术
政治
体重
年龄
男性
发型-么
W
改造-
外套
ZNNN
N
农服
问题文本
衣服尺寸：我的衣服尺寸是多少？
·安全：如果你是一名机场安检巡警，你会检查我吗？
·外套：你喜欢我的外套吗？
·改造：我是否需要改造？
发型：你喜欢我的发型吗？
年龄：我多大了？
体重：我有多重？
政治面貌：我的政治面貌是什么？（越高越保守）
整形手术：我是否做过整形手术？
·性倾向：我的性倾向是什么？（值越高越有可能是同性志）
·题力：我有多大魅力？
富有：我有多富有？
·显得年轻：我是否（或者将来是否会）显得年轻？
·有才华：我是否有才华？
·聪明：我有多聪明？
·值得信任：我值得信任的程度有多高？
·和狗打架：你觉得我是否能打过一只中等大小的狗？
·雇佣：你会雇佣我吗？
·喝醇：我有多醇？
1666
---
## Page 1668
图17-9：Pearson关联矩阵，蓝色方块的属性对和上升的斜线是正
向关联，而红色方块的属性对和下降的斜线是逆相关（见彩图63）
该绘图蕴涵了很多有趣的关联信息，这些关系值得进一步调查：
女人被认为比男人更聪明。
女人被认为更有可能在和狗打架中胜出。
农服尺寸和体重只是弱相关。
·女人更有可能被雇佣为安全巡警。
那些看起来做过整容手术的人被雇佣为安全巡警的概率更小。
值得信任、聪明、有才华、显得年轻、富有和保守之间都两两关
联。一条“责任心-轴”？
观察标签
除了所有顺序和数值的数据，我们包含一组自由格式的标签，用户
能够输入人的照片。标签范围从描述性的（“雀斑”、“鼻子带环”)
，）（，）
的衣服很漂亮”）到建议性的（“修修头发”、“避免在太阳下暴晒”）
到评论性的（“太让人惊叹了！”、“Nancy，够了！”）到卑鄙的
（“那个肥胖的朋友"）到没有意义的（“"..."、“plokmnjiuhbygvt
fcrdxeszwaq"）。通常来说，自由格式的文本数据处理上更复杂。第
一件要做的事是检查标签的分布。最常见的标签是什么？
Load our tags >face_tags=read.delim ("face_tags.tsv",
sep="\t", as.is=T)
then count >counts=table(face_tags$tag)
and rank them. >sorted_counts=sort (counts,decreasing=T)
Show the most common tags. >sorted_counts [l: 20]
以下表包含了输出结果。
1667
---