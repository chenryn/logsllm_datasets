58.3M
530.4M
13.6M
14.4M
248.1M
31.1k
37.6k
155.8k
115.8k
178.7k
1.5M
76.5k
46.9k
29k
28.9k
46.6k
74.9k
177
299
1.6k
10
29
20
962.3k
405k
226k
226k
344k
737.2k
N/A
61k
225.1k
65.9k
116.6k
284.4k
65.9k
102.7k
222.3k
62.1k
13.9k
N/A
62.4k
110.1k
269.2k
3.5k
6.4k
15.3k
43
208
518
N/A
983k
6.5M
1.9M
282.9k
N/A
N/A
179.2k
852.1k
N/A
103.7k
1.1M
27
98
N/A
Table 4: Passive SCT data. SNIs from Sydney are not avail-
able as only outbound packets were observed (see Section 4).
Servers replied with stapled OCSP responses in 13.64% of
these connections (248.1M).
Our data collection at UCB also extended to ports other
than 443. 74,311 of certificates (99.2%) with an embedded
SCT were encountered on port 443 (followed by 279 cases
observed in TLS connections on port 80). For SCTs over TLS
and OCSP the situation is similar. As expected, we did not
encounter precertificates in active or passive data.
5.2 Properties of Certificates with SCTs
A small number of CAs are responsible for the majority
of issued certificates containing embedded SCTs: Symantec
issues 67.16% of all certificates with SCTs through their
brands Geotrust (33.67%), Symantec (28.75%), and Thawte
(4.74%). This is probably caused by Google requiring Syman-
tec to log all its certificates due to previous incidents of
mis-issuance [65]. Chrome shows a warning for Symantec
certificates without SCTs. Other CAs who issued significant
numbers of certificates containing embedded SCTs are Glob-
alSign (11.91%), Comodo (11.66%), and StartCom (3.19%).
StartCom and its parent company WoSign are already dis-
trusted by Mozilla for new certificates [78] and has been dis-
trusted by Google Chrome as planned in September 2017 [76].
Although we observe a substantial number of certificates con-
taining SCTs overall, only a few CAs are responsible for this;
some of whom are required by Google to provide SCTs. This
indicates that currently not many CAs seem interested in
providing embedded SCTs, showing that opinions did not
significantly change since 2014 [13].
Table 5 shows which logs created the SCTs that are embed-
ded in certificates, as well as sent over TLS extensions. The
most commonly used logs are currently operated by Syman-
tec, Google, and DigiCert, although the exact percentages
differ between active scans and passive observations. The
Google and DigiCert logs accept certificates from a wide
range of CAs; Symantec only allows certificates from a hand-
ful of CAs logs [66]. This shows that CAs are likely to submit
their precertificates to a low number of logs, and an even
lower number of operators, causing a certain concentration
of trust. We hope that this picture will change in the future
when more public log servers are established.
Table 6 shows how many SCTs from different logs and
log operators are added to certificates. This is an important
metric: Google’s future plans are to require that certificates
be included in a number of logs operated by different enti-
ties [28]. Our analysis shows that most certificates are logged
by more than one log operator already. However, we encounter
16.42k cases of certificates that are logged exclusively by one
operator; 16.3k of these are logged exclusively by Google.
Certificates logged in one log only are rare and mostly con-
tained in Symantec’s Deneb log, which we discuss in the next
section.
Invalid SCTs
5.3
We validate all SCTs. This nearly always succeeded, with a
few notable exceptions.
In exactly one case, a correctly CA-signed certificate con-
tained invalid embedded SCTs. The certificate, issued to
www.fhi.no by Norwegian CA Buypass, was observed in both
active and passive measurements. The three embedded SCTs
are from Google Aviator, Venafi, and Symantec logs. We
contacted Buypass regarding these invalid SCTs. Although
previously unaware of the problem, they confirmed that a
corner case in their implementation caused the embedding
of SCTs belonging to a different certificate for the same do-
main. Buypass revoked the certificate containing the faulty
SCTs [20] and issued a new certificate with valid SCTs [19].
Invalid SCTs in our data set originate primarily from TLS
extensions. Sending SCTs in the TLS extension typically
requires manual configuration on the server side. In our ac-
tive scan, we encounter this case on 121 domains serving
101 certificates. 91 of these were issued by Let’s Encrypt,
who currently do not embed SCTs in their certificates. Er-
roneous SCTs can be caused by operators updating their
server certificates manually, forgetting to update the SCT
configuration.
Another typical source of invalid SCTs is Symantec’s Deneb
log. This is a special log: all domains in the issued certifi-
cates are truncated to the second-level domain, excluding
subdomains [67]. Validation of a certificate against a Deneb
log signature requires modifying the received certificate and
truncating all domains contained within. The Deneb log is
not trusted by Google or, to our knowledge, anyone else. We
Mission Accomplished? HTTPS Security after DigiNotar
IMC ’17, November 1–3, 2017, London, United Kingdom
Active SCT in Cert
Symantec log (81.26%)
Active SCT in TLS
Symantec log (62.71%)
Google ’Pilot’ log (79.9%) Google ’Rocketeer’ log (58.53%)
Google ’Pilot’ log (58.42%)
Google ’Icarus’ log (14.35%) Google ’Rocketeer’ log (38.35%)
DigiCert Log Server (26.42%)
Google ’Aviator’ log (9.49%)
Symantec VEGA log (8.08%)
Venafi log (7.46%)
Google ’Skydiver’ log (7.22%)
WoSign ctlog (4.63%)
Izenpe log (0.58%)
DigiCert Log Server (4.07%)
Google ’Skydiver’ log (1.69%)
Venafi log (0.54%)
StartCom CT log (0.38%)
Venafi Gen2 CT log (1.58%)
Berkeley Passive SCT in TLS
Symantec log (96.16%)
Google ’Pilot’ log (51.51%)
Google ’Aviator’ log (42.79%) Google ’Rocketeer’ log (50.19%)
WoSign ctlog (2.64%)
Google ’Skydiver’ log (1.7%)
Venafi log (0.44%)
DigiCert Log Server (0.38%)
Google ’Icarus’ log (0.38%)
Google ’Aviator’ log (0.25%)
NORDUnet Plausible (0.06%)
Google ’Rocketeer’ log (31.73%)
DigiCert Log Server (26.95%)
Google ’Aviator’ log (25.68%)
Google ’Skydiver’ log (8.31%)
Symantec VEGA log (3.98%)
StartCom CT log (1.49%)
WoSign ctlog (0.67%)
Izenpe log (0.14%)
Berkeley Passive SCT in Cert
Symantec log (79.69%)
Google ’Pilot’ log (78.95%)
Table 5: Top logs by number of certificates with SCTs, for active scans from Sydney and passive monitoring in Berkeley.
Numbers as percentage relative to all certificates in scan with SCT in Cert/TLS. A certificate typically has more than one SCT.
# Logs
1
2
3
4
5
Certificates
(Active-All)
156 (0.02%)
601.87k (69.37%)
107.63k (12.4%)
57.24k (6.6%)
100.73k (11.61%)
Logs
Certificates
(Berkeley-Mon)
32 (0.04%)
33.76k (45.05%)
25.22k (33.65%)
10.54k (14.06%)
5.39k (7.19%)
(Berkeley-Mon)
134k (0.03%)
145M (27.36%)
165M (31.24%)
217M (40.99%)
2.0M (0.38%)
Connections # Ops.
Unique Log Operators
Certificates
(Active-All)
16.42k (1.89%)
740.99k (85.4%)
110.19k (12.7%)
42 (0%)
0 (0%)
Certificates
(Berkeley-Mon)
734 (0.98%)
67.55k (90.14%)
6.65k (8.88%)
2 (0%)
0 (0%)
Connections
(Berkeley-Mon)
312k (0.06%)
453M (85.47%)
76M (14.47%)
37 (0.00%)
0 (0.00%)
1
2
3
4
5
Table 6: Number of logs/log operators in certificates. Percentage relative to all certificates/all connections with SCT.
are not aware of any actual implementation of this highly
unusual validation method, which sidesteps one of the most
important properties of CT—to make a list of all issued
certificates per domain available to everyone. Symantec ad-
vertises this option for customers who do not want to disclose
the existence of their domains to monitors. In our active
scans, we encountered 129 certificates logged in Deneb logs.
Interestingly, we found that 87 of them were also included in
Google logs and 2 in a Comodo log, defeating the purpose of
Symantec’s Deneb log in such cases. Of these, 64 certificates
were issued for Amazon domains.
In our passive data from UCB, we find a particularly in-
teresting type of certificate with invalid SCTs not present in
our active scan. We observe 425 cases in which the certificate
contains an extension with an SCT object identifier, but no
SCT data. Instead, the extension contains the string ‘Ran-
dom string goes here’. The certificates cover 5 domains, with
352 certificates issued for *.cloudfront.com and 68 for twit-
ter.com. None of the certificates could be validated against
the CA certificate mentioned as the issuer. The server IP
addresses that served the certificates revealed several hosting
and dedicated server providers like LogicWeb. Manually try-
ing to connect to a number of these IP addresses resulted in
a TLS handshake error; no certificate was sent. Examining a
subset of the certificates reveals that they are exact clones
of existing certificates: the serial number, subject, issuer and
all extensions except for the SCT are exactly the same as in
the real certificates. We can only speculate about the use of
these certificates. They could be used to disguise traffic as be-
longing to popular services. A cursory inspection would show
normal-looking TLS connections with certificates seemingly
belonging to Twitter or CloudFront.
5.4 CT Inclusion Status
A natural question to ask is whether logs are well-behaved
and include every certificate for which we find a valid embed-
ded SCT. Inclusion of normal certificates is straightforward
to check, but precertificates require reconstruction from their
final end host certificate. We enhance a preexisting X.509 cer-
tificate parsing library for PostgreSQL, adding functionality
for stripping the signature, SCTs, and poison extension from
certificates. There also is a second, more complicated method
for precertificates where the precertificate chains to a special
precertificate CA certificate, not that of the final issuing CA.
For these exotic cases (a handful of certificates in our scan),
we manually verified inclusion in the respective CT logs. In
conclusion, all encountered certificates with a valid embedded
SCT were correctly logged by the respective CT logs. This
is a strong indication that CT’s precertificate system works
almost flawlessly, with the one negligible exception of the
www.fni.no certificate.
6 HSTS AND HPKP
In our active scans, we probe servers for HSTS and HPKP
headers by sending HTTP HEAD requests. We analyze de-
ployment, consistency, lifetime, and cryptographic validity
of the received headers. Table 7 provides the counts of do-
mains that respond with HTTP 200 (‘OK’) to our request.
We collapse responses from the same domain if the HSTS
and HPKP headers are consistent across all IP addresses.
We combine the analysis of HSTS and HPKP due to the
similarity of some of their attributes.
IMC ’17, November 1–3, 2017, London, United Kingdom
Amann, Gasser, Scheitle, Brent, Carle, Holz
MUC IPv4
SYD IPv4
MUC IPv6
Total
Consistent
HTTP 200
HSTS
26.8M 960.0k (3.59 %)
26.5M 948.5k (3.58 %)
1.2M 38.8k (3.36 %)
27.8M 1.0M (3.60 %)
27.8M 984.1k (3.54 %)
HPKP
5.9k (0.02 %)
5.8k (0.02 %)
1.0k (0.09 %)
6.2k (0.02 %)
6.2k (0.02 %)
Table 7: Unique HTTP code 200, HSTS, and HPKP domains
responding to MUCv4, SYDv4, SYDv6, and any scan. Last
row displays domains with consistent headers across scans.
6.1 Header Consistency
We first investigate intra-scan consistency, i.e., whether the
headers for a domain are consistent within each of the TUMv4,
TUMv6, and SYDv4 measurements. For each scan, we find