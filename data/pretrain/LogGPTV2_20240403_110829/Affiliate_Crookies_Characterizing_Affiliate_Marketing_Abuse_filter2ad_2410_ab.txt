a user should only receive an afﬁliate cookie upon clicking on an
afﬁliate URL. While crawling we do not click on any links and
therefore every afﬁliate cookie we receive is deemed fraudulent.
Since it is infeasible to crawl every Web page, we narrowed our
visits to four different sets of URLs where we expected to come
across afﬁliate fraud.
For every crawl we used a slightly modiﬁed version of our pub-
licly available extension, AffTracker, which automatically grabs
a new URL from a queue on Redis, a persistent key-value store.
Upon completion of a visit, the extension submits results to our
server and purges the crawler browser of all history, cookies, and
local storage. We purge the browser because we found afﬁliates
who save state in browsers to rate-limit their cookie-stufﬁng to
evade detection by afﬁliate programs. For example, an afﬁliate,
jon007, who controls bestwordpressthemes.com, sets a cus-
tom cookie called bwt which is valid for a month. As long as this
cookie remains valid in a browser, bestwordpressthemes.c
om does not request HostGator afﬁliate cookies for the user. Also,
inspired by Shawn Hogan who, according to EBay, rate-limited
his cookie-stufﬁng by only requesting an afﬁliate cookie once per
IP [4], we use 300 proxies to mitigate IP based detection by fraud-
ulent afﬁliates.
We crawled the following four sets of domains to gather afﬁliate
cookies. Except Alexa top domains set, the remaining three sets are
purposely biased towards domains where we expect to ﬁnd higher
concentration of cookie-stufﬁng.
Alexa Top Domains. We crawled the Alexa [1] top 100K do-
mains as of April 16, 2015 to ﬁnd popular domains stufﬁng cookies.
Reverse Cookie Lookups. After identifying the cookie names
used by different afﬁliate programs, we performed reverse lookups
on the cookie-search interface [5] on digitalpoint.com, a web-
master community that indexes all of the cookies its crawler en-
counters. Overall, we gathered 9.5K domains that the Digital Point
crawler observed performing cookie-stufﬁng over the last 2 years.
Reverse Afﬁliate ID Lookup. Using the cookie-stufﬁng afﬁli-
ate IDs discovered from our Digital Point domain crawl, we queried
an aggregator site, sameid.net, that indexes domains by Amazon
and ClickBank afﬁliate IDs seen on a domain. By iteratively crawl-
ing domains queried from the newly discovered cookie-stufﬁng af-
ﬁliate IDs, we visited a total of 74.5K domains.
Typosquatted Domains. In our ﬁrst three sets we observed
that much of the cookie-stufﬁng fraud was on domains typosquat-
ted on merchant domains names. Thus, we crawled all typosquatted
.com domains for over 7K domains belonging to major e-retailers.
Similar to Edelman et al. [7], we interpret the use of typosquat-
ting to redirect users to merchant sites without any explicit clicks
as cookie-stufﬁng, and therefore, fraudulent. Typically users vis-
iting typosquatted domains intend to visit the merchant site rather
than the typosquatted domain itself. Thus, typosquatting a domain
does not bring new customers to merchant sites via direct afﬁliate
marketing of products. Therefore, we recognize cookie-stufﬁng via
typosquatted domains as fraudulent.
We acquired the set of domains belonging to e-retailers from a
public API offered by Rakuten Popshops.3 The downloaded data
includes merchant lists for Commission Junction, ShareASale, and
Rakuten LinkShare afﬁliate networks. By calculating the Leven-
shtein distance [12] for merchant domains against all .com do-
mains in a zone ﬁle from April 19, 2015, we found over 300K ty-
posquatted domains with an edit distance of one. We visited this
set of domains as well.
We gather the same features about afﬁliate cookies through crawl-
ing as from the user study because we use the same browser ex-
tension, AffTracker, in both cases. Furthermore, we only visit
top-level pages of domains and therefore miss any cookie-stufﬁng
in domain sub-pages. Also, Google Chrome disables popups by
default, a feature we left unchanged because it emulates a user’s
browser more faithfully. However, this behavior likely caused our
2afﬁliatetracker.ucsd.edu
3https://www.popshops.com
43Afﬁliate Program
URL
Cookie
Amazon Associates Program http://www.amazon.com/dp/tag=&...
CJ Afﬁliate
ClickBank
HostGator
Rakuten LinkShare
ShareASale
http://www.anrdoezrs.net/click-- ...
http://..hop.clickbank.net/
http://secure.hostgator.com/~affiliat/...
http://click.linksynergy.com/fs-bin/click?...
http://www.shareasale.com/r.cfm?...
UserPref=.*
LCLK=.*
q=.*
GatorAffiliate=.*.
lsclick_mid=".*|- .*"
MERCHANT=
Table 1: Examples of afﬁliate URLs and cookies for different afﬁliate programs.
crawler to miss any afﬁliate fraud where a fraudster opens a popup
to load an afﬁliate URL.
Finally, while we can detect fraudulent afﬁliates stufﬁng cookies,
we are unable to discern whether an afﬁliate network has already
identiﬁed the fraudster. We have seen examples of ClickBank and
LinkShare afﬁliate sites where afﬁliate links show an error mes-
sage about afﬁliates having been banned, but some networks do not
break banned afﬁliate links to prevent bad end-user experience for
their URLs.
4. RESULTS
In this section we ﬁrst analyze the afﬁliate networks and mer-
chants most impacted by cookie-stufﬁng fraud. Next, we survey
various cookie-stufﬁng techniques used by afﬁliates, and then present
the results from our user study on the prevalence of afﬁliate mar-
keting and cookie-stufﬁng fraud.
4.1 Networks Affected by Cookie-Stufﬁng
Using data collected from our crawls, we identify the afﬁliate
networks most targeted by cookie-stufﬁng. Overall, we received
12,033 afﬁliate cookies from 11.7K domains. Table 2 summarizes
our results.
We found that CJ Afﬁliate and Rakuten LinkShare are the most
targeted programs, comprising 85% of all fraudulent cookies we
observed. We identiﬁed afﬁliate IDs for all but 1.6% of these cook-
ies. Every fraudulent CJ afﬁliate stuffed almost 50 cookies, while
every LinkShare afﬁliate stuffed 41 cookies. However, fraudulent
afﬁliates in Amazon and HostGator afﬁliate programs only stuffed
2.5 cookies per afﬁliate on average, the fewest of all afﬁliate pro-
grams in our study, suggesting that fraudulent afﬁliates target net-
works much more than they target in-house afﬁliate programs.
Generally, afﬁliate networks present greater cookie-stufﬁng op-
portunity to fraudulent afﬁliates because a single afﬁliate can si-
multaneously defraud multiple merchant members of the network.
Our data from the Popshops API (Section 3.3) contains almost
2.4K merchants in CJ Afﬁliate, and 1.3K merchants in Rakuten
LinkShare, and as Table 2 shows, each fraudulent afﬁliate targeted
more than three merchants in LinkShare on average. We received
10 and 15 cookies on average for every targeted merchant in CJ
Afﬁliate and Rakuten LinkShare, respectively.
Using the Popshops data as ground truth, we classiﬁed the de-
frauded merchants in all of the major networks (Figure 2) in our
study except ClickBank and 420 CJ Afﬁliate cookies. We found
that on the whole, Apparel and Accessories e-retailers are targeted
the most across all three afﬁliate networks while the second most
impacted group of merchants are Department Stores, again abused
in all three networks but to a greater extent in LinkShare. Travel
and Hotel sites were the third-most defrauded group. These three
sectors have a large number of merchants and we found almost 11
stuffed cookies on average for every targeted merchant. On the
other hand, the Tools and Hardware category only contains four
impacted merchants but we observed almost 45 cookies for each of
CJ Affiliate
ShareASale
Rakuten LinkShare
1000
i
s
e
k
o
o
C
750
500
250
0
A pparel & A ccessories
D epartm ent Stores
Travel & H otels
H o m e & G arden
S hoes & A ccessories
H ealth &  W ellness
Electronics & A ccessories
C o m puters & A ccessories
S oftw are
M usic & M usical Instru m ents
Figure 2: Stuffed cookie distribution for top 10 categories of im-
pacted merchants.
them on average, the highest of any category. Home Depot, a CJ
Afﬁliate member, was the most impacted merchant in this category
with 163 stuffed cookies.
We also found 107 merchants who were defrauded across two
or more networks. Chemistry.com, a member of CJ Afﬁliate and
LinkShare, was the most targeted merchant participating in more
than one afﬁliate program.
4.2 Prevalence of Cookie-Stufﬁng Techniques
We use the collected data to characterize the use of various cookie-
stufﬁng techniques against each of the afﬁliate programs under con-
sideration. As described in Section 3, whenever the browser re-
quests an afﬁliate URL, our extension ﬁnds the DOM element that
caused the fetch. Visiting a fraudulent afﬁliate’s Web page can
cause the user’s browser to fetch an afﬁliate URL without any ex-
plicit click from the user by setting it as the src attribute of im-
ages, iframes, or script tags. All of these DOM elements can re-
quest third-party content on a Web page. Our extension is able to
detect all afﬁliate cookies by observing the Set-Cookie HTTP
headers, and distinguish between these techniques automatically.
44Afﬁliate Program
Cookies
Domains
Merchants
Afﬁliates
Techniques
Avg. Redirects
Amazon Associates Program
CJ Afﬁliate
ClickBank
HostGator
Rakuten LinkShare
ShareASale
170 (1.41%)
7344 (61.0%)
1146 (9.52%)
71 (0.59%)
2895 (24.1%)
407 (3.38%)
122
7253
1001
63
2861
404
1
725
606
1
188
66
Images
Iframes
Redirecting
70
146
403
29
57
34
28.8%
0.29%
34.4%
43.7%
0.28%
0.25%
34.1%
2.46%
13.5%
19.7%
0.41%
0.0%
37.0%
97.2%
52.0%
35.2%
99.3%
99.8%
1.64
0.94
0.68
0.87
1.01
0.74
Table 2: Afﬁliate Programs affected by cookie-stufﬁng.
Table 2 shows the percentage of cookies corresponding to each of
these techniques for every afﬁliate program.
At a high level, we observe that fraudulent afﬁliates use a much
larger variety of techniques uniformly for afﬁliate programs run by
the merchants themselves compared with larger afﬁliate networks,
which are targeted primary via redirects to merchant sites without
user clicks. Table 2 also shows the average number of interme-
diate domains requested after the initial page visit but before the
afﬁliate URL, i.e., a value of zero means that an afﬁliate URL was
directly requested from the crawled page.
Intermediate referrers
can be used to obfuscate the original source of a fraudulent afﬁl-
iate URL request because an afﬁliate program only sees the ﬁnal
referrer when determining the legitimacy of such a request. Af-
ﬁliates defrauding Amazon Associates Program use more interme-
diate domains on average. Since the cost of getting intermediate
domains is higher, it is likely more expensive for fraudulent afﬁl-
iates to defraud Amazon Associates Program presumably due to
stricter policing by Amazon.
Redirecting. Fraudulent afﬁliates redirect users to afﬁliate URLs
without any clicks by either using 301 or 302 HTTP response sta-
tus codes, or using Flash or JavaScript to redirect the browser to the
afﬁliate URL. In each of these cases, the original page we crawled
only resulted in one stuffed cookie per visit. Such redirects de-
livered over 91% of all stuffed cookies, most of which resulted
from typosquatted domains. In fact, we received 84% of all afﬁliate
cookies from 10.1K typosquatted domains.
Of the 10.1K cookies from typosquatted domains, 93% (9.4K
cookies) are from domains typosquatting on merchant domain names