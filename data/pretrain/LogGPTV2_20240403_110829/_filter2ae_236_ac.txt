每个密码管理器对主密码的组成都有不同的要求。KeePass和KeePassX都允许对主密码进行任何组合，包括根本不使用主密码。基于扩展的密码管理器都需要主密码，但组成要求有所不同.LastPass，RoboForm和Bitwarden要求主密码至少应包含八个字符，但没有其他限制。
1PassWordX将最小长度增加到10，但是与其他三个相同。
OnlyDashlane具有构成要求，要求最小长度为8个字符，并且每个字符类（小写，大写，数字，符号）中的一个字符。
在基于浏览器的密码管理器中，只有Firefox处理其密码库本身的加密。它使用3DES加密密码数据，使用一轮SHA-1来导出加密密钥。它不对主密码强加任何策略。与处理自己的加密的其他密码管理器相比，Firefox是目前最弱的。
其余基于浏览器的系统依靠操作系统来帮助它们加密密码库。 Edge，Internet
Explorer和Safari都依赖于操作系统密钥环来存储凭据。对于Edge和Internet
Explorer，这是Windows保险柜；对于Safari，它使用macOS钥匙串。
Chrome和Opera还依赖于操作系统来加密密码，但是它们的操作方式因操作系统而异。在Windows上，CryptProtectData函数用于让Windows使用与当前用户帐户绑定的密钥来加密密码。在Linux上，这些系统首先尝试将密码写入GNOME密钥环或KWallet
4，如果这些钥匙串都不可用，则退回到以纯文本格式存储密码。在macOS上，虽然网站密码本身存储在本地而不是存储在钥匙串上，但是密码使用macOS钥匙串派生的密钥加密。
除Firefox外，基于浏览器的密码管理器均依靠操作系统来加密密码，因此不允许用户建立主密码。因此，无法单独锁定密码库和锁定帐户。尽管不在本文讨论范围之内，但还需要进行更多研究，以研究OS提供的加密功能和密钥链的安全性。
###  2)元数据隐私
与早期发现相比，发现基于应用程序和基于扩展的密码管理器在确保适当保护元数据方面有了很大的改进。
KeePassX和KeePassXC都加密所有元数据。基于扩展的密码管理器会加密大多数元数据，但是所有密码管理器都至少具有一个它们没有的项目。
1Password
X以明文形式存储扩展设置，从而使攻击者可以读取或修改设置。这些设置包括与安全性相关的设置，例如是否启用自动锁定，默认密码生成设置以及是否显示通知。
Dashlane加密网站URL时，不会加密与这些URL关联的网站图标，从而使攻击者可以推断用户拥有帐户的网站。所有基于扩展的密码管理器都会泄漏用于登录密码管理器的电子邮件地址。
依靠操作系统提供（Edge，Internet
Explorer，Safari以及Linux上的Chrome和Opera）的基于浏览器的管理器使用这些工具来保护所有相关的元数据。对于其他基于浏览器的密码管理器（Windows和macOS上的Chrome和Opera，以及所有操作系统上的Firefox），存在大量未加密的元数据。所有这三个密码管理器均以明文形式存储URL，只有Firefox会加密用户名。他们还提供有关创建帐户的时间，上次使用时间以及密码填充次数的信息。
## 0x06 Password Autofill
在评估过的密码管理器中，只有KeePassX不支持浏览器中的自动填充功能，而Bitwarden警告说其自动填充功能是试验性的。为了评估这些工具，开发了攻击网站。下表突出显示了本研究的一些发现。
###  1）用户互动要求
如果攻击者可以通过网络注入或XSS攻击来破坏网页，则他们可以插入恶意JavaScript，该JavaScript将在输入用户密码时窃取用户密码。如果密码管理器在没有首先提示用户的情况下自动填充密码，那么只需访问受感染的网站，用户的密码就会被秘密盗用。因此，理想情况下，应该在自动填充发生之前需要用户交互。在测试的密码管理器中，只有1Password
X和Safari在填写凭据之前始终需要用户交互。其余的密码管理器根据提供网站的协议（即HTTPS或HTTP）以及HTTPS证书是否有效而表现出不同的行为。
对于使用有效证书通过HTTPS服务的网站，KeePassXC，Bitwarden和RoboForm默认要求用户交互，但也允许禁用用户交互。尽管可以选择要求用户交互，但Dashlane，Lastpass和Firefox默认自动填充密码而无需用户交互。
Chrome，Edge，Internet
Explorer和Opera始终自动填充用户凭据。尽管可以选择要求用户交互（Dashlane，LastPass，Firefox）而不是缺少该选项（Chrome，Edge，Internet
Explorer，Opera），但实际上大多数用户（不太可能更改其用户）的结果是相同的默认选项）。
虽然在使用HTTPS的网站上仍然可以进行网络注入攻击（即TLS中间人攻击），但它们更容易实现，并且如果HTTPS证书无效，则更有可能。
HTTPS证书错误的原因包括良性（例如一天过期）到恶意（例如无效签名，已撤销）。在这两种情况下，密码管理器都应该完全拒绝填写密码，或者至少要求用户交互后才自动填写密码。如果证书无效，KeePassXC，Bitwarden，RoboForm，Dashlane，Lastpass和Firefox均会像使用有效证书一样起作用。
Edge和Internet Explorer都会更改其行为，并且始终需要用户交互才能获取错误的证书。
Chrome和Opera还会更改其行为，从而完全禁用自动填充密码的功能。
当使用不安全的连接（即HTTP）为网站提供服务时，网络注入攻击也更有可能并且更容易实现。与错误证书一样，密码管理者应拒绝自动填写密码或在填写密码之前要求用户互动。默认情况下，KeePassXC，Bitwarden和RoboForm仍要求用户互动，但允许用户禁用此要求。
Dashlane，LastPass，Edge和Internet Explorer都将其行为更改为始终要求用户交互，然后才能在HTTP网站上自动填充密码。
###  2）为iframe自动填充
无论是否需要用户交互，在iframe中自动填充密码都是特别危险的。例如，点击劫持可用于诱骗用户提供必要的用户交互以自动填充其密码，从而使攻击者可以窃取iframe中加载的漏洞网站（同源或跨域）的密码。更糟糕的是，如果跨域iframe允许自动填充并且不需要用户交互，则攻击者可以以编程方式收集所有网站的用户凭据，攻击者可以在其中执行网络注入或XSS攻击（通过将受感染的网站加载到iframe中）
。
对于点击劫持和收获攻击，用户必须首先访问一个恶意网站，然后该恶意网站才能发起攻击，但这通常并不是攻击者的主要障碍。在最坏的情况下，如果系统容易受到收割攻击，并且攻击者可以访问用户的WiFi接入点（例如，在酒店或机场），从而使他们可以轻松进行网络注入攻击，那么所有用户的凭据当用户查看受损访问点的网络登录页面时，可能会秘密地被盗。
KeePassXC，1Password X，Dashlane和LastPass在相同来源的iframe中自动填充，使它们容易受到点击劫持攻击。
Bitwarden和RoboForm也可以自动在相同来源的iframe中填充，但是如果需要用户交互，它们在很大程度上不受点击劫持的影响，因为这种交互发生在扩展下拉列表内的网站外部。所有浏览器都将使用相同来源的iframe自动填充。
KeePassXC确实允许跨域iframe自动填充；默认情况下，它确实需要用户交互才能在跨域iframe中自动填充，但可以禁用此要求，从而使KeePassXC容易受到上述收获攻击的攻击。在基于扩展程序的密码管理器中，1Password
X，LastPass和RoboForm不会在跨域iframe中自动填充。
Bitwarden和Dashlane会自动填充跨域iframe，但会自动填充最顶部窗口的域（即显示在网址栏中的域）的密码，从而防止攻击者窃取跨域凭据。
Chrome，Edge，Internet
Explorer，Opera和Safari都需要用户交互才能将密码自动填充到跨域iframe中，尽管这仍然使它们容易受到点击劫持攻击。
Firefox默认情况下，在将密码自动填充到跨域iframe之前不需要用户交互，因此默认情况下，它容易受到域捕获攻击的攻击。
###  3）不同于已保存表格的填写表单
密码管理器会检测用户何时在登录表单中手动输入密码，然后将其保存以供以后使用。当密码管理器稍后填写此密码时，它可以检查要填写的表单是否与保存密码时使用的表单相似（例如，相同的路径或协议）。这些类型的检查有助于确保用户以不妥协的形式输入密码，其安全性等同于他们首次保存密码时所使用的形式。不过，在许多情况下，更改表单仍然有意义-例如，密码已保存在注册表单中（即，不是登录表单）。
因此，如果密码管理器不允许填写表单或在填写表单与用于保存密码的表单之间存在差异时向用户显示通知，则给密码管理器加了一个全点。如果密码管理器在出现差异时需要用户交互，则给出半点，但前提是无法禁用此用户交互（在Bitwarden和RoboForm中可能如此）。请注意，1Password
X和Safari始终需要用户交互，因此始终收到至少半个点。在下面讨论的结果中，仅强调由于登录表单中的差异而导致密码管理器的行为不同。
密码管理器不会对提供表单的URL中的差异做出反应（除了检查域是否匹配之外）。如果密码保存在通过HTTPS提供的表单中，Chrome和Opera将拒绝将其填写在具有错误HTTPS证书的表单中，并且Edge和IE要求用户进行交互。如果改为通过HTTP提供表单，则1Password
X和Dashlane将警告用户，Chrome，Edge，Firefox，IE和Opera将拒绝填写密码。同样，LastPass将强制用户交互。