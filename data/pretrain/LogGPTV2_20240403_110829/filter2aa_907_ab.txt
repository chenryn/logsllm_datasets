image, but under another name.  
Figure 11: Embedded image in Pictures folder 
If this image is extracted and analyzed, it has all the original image’s metadata attached and, of 
course, the thumbnail that shows its original state. It´s possible to use any EXIF reader tool to 
analyze the thumbnail attached to the pictured to prove this as can be seen in Figure 12. 
Figure 6 EXIF Metadata from an embedded image 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 7 of 29 
Figure 12: Original thumbnail discover image’s manipulations 
2.7 MODIFICATIONS 
One of the features offered by OpenOffice Writer is to track changes in documents. This is 
useful when a document is being developed by multiple users or when you want to log all the 
modifications. The submenu "modification" of the Edit menu can activate this feature, as well as 
make visible or hide the changes. 
 A user can work on a document with this option activated, even by negligence, so that if the 
document is published without eliminating its history, anyone can guess if something has been 
removed or added, and by whom, and when these changes were made. 
Figure 13: Changes aren´t displayed 
Figure 14 shows that if you left the cursor on a change in the document for a few moments, 
there is a message indicating who made it and when. 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 8 of 29 
Figure 14: Changes are displayed 
All of this information about the change history is stored in the file content.xml: 
… 
  MiNombre MiApellido  
  2008-08-13T13:07:00  
  lamentablemente patética  
…
2.8 HIDDEN PARAGRAPHS 
Another option offered by OpenOffice is to hide text or paragraphs. This functionality allows 
working on a document in a display with hidden paragraphs, ready to print, and in another 
display, with all the paragraphs visible, for example, with the information for editing the 
document. This feature is activated including a special field in the paragraph: 
We can turn on or turn off the display of hidden text using the corresponding menu item "View". 
So, if we have a document with hidden paragraphs, but we do not have the option of seeing 
them, we are working with a display that does not show all the information that the document 
has. 
Figure 15 Document with hidden paragraphs 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 9 of 29 
Figure 16: Document displaying hidden paragraphs 
2.9 HIDDEN INFORMATION DUE TO THE FORMAT 
Another type of hidden text or content is the one that is not visible due to the document format: 
for example, other content, such as an image, overlaps with it or the text is in the same color 
that the document background. Of course, this kind of content should be carefully reviewed 
before publishing the document. 
2.10 NOTES, HEADERS, FOOTNOTES AND COMMENTS 
In an OpenOffice document there are a number of places where you can enter information that 
may go unnoticed in subsequent revisions. For example, in headers and footnotes, online 
annotations or comments, that can be entered using the "Notes" option in the "Insert" menu. 
These notes, unless you specify it, are not included when the document is printed or exported, 
for example, to PDF format, so it is easy to forget this information in the reviews. It has to be 
considered that some elements can be defined as "not printable"; therefore, a detailed revision 
of a document should not be limited to reading a printed version. 
Figure 17: Defining a document as printable or not printable (Spanish version, what a great language!) 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 10 of 29 
2.11 CUSTOMIZED METADATA 
Metadata, as it was discussed in the introduction of this document, are not harmful themselves, 
and on the contrary, they can be very useful for certain applications. In OpenOffice, the user is 
able to include customized Metadata in his/her documents and to add information to the 
document using the "Properties" option from the File menu. In addition to the customized 
Metadata, the document may store information if it is created from another previous document, 
inherited from this one. 
Figure 18: Customized metadata 
Sometimes, this customized information is used as a working tool in the process of document 
elaboration and may include corporate or personal opinions, more or less politically correct, 
identifications and other personal data or references to documentary sources. Of course, all this 
information must be reviewed before the document publication. 
2.12 DATABASES 
The combination of documents with databases must be considered too. One of the most 
important functionalities provided by Office applications nowadays is the ability to generate 
models that, combined with databases, allow customized and automatic documents generation. 
These models, designed from mail merging, deserve a special consideration, since they contain 
information that allows describing the database they are taking the information from. All the 
information related to the database can be found in the settings.xml file. There is information 
about the name of the database and about the table used for the combination. 
Referencias 
0 
Contactos 
true 
Figure 19: Information related to database in settings.xml 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 11 of 29 
And in content.xml file we can find the name of the database, the table and the fields: 
… 
…
Figure 20: Information related to database in content.xml 
However, information regarding the connection to the database is not in the ODF document. 
This information could show the path to a database file or the credentials to access a server, 
and is stored in a user's profile file called DataAccess.xcu, that should be especially protected 
by the user. 
C:\Documents and Settings\USER_ACCOUNT\Program data\ 
\OpenOffice.org2\user\registry\data\org\openoffice\Office\DataAccess.xcu 
Although connection’s credentials to database are not published, the information stored with the 
document may be enough to help a potential attacker to prepare his attacks to the database, 
directly or through SQL Injection techniques on the company's website. 
2.13 VERSIONS OF DOCUMENTS 
 Like other Office packages, OpenOffice allows saving different versions of the same document. 
This feature is extremely useful in collaborative work environments, allowing the evaluation of 
the document changes and, if necessary, restoring the previous state after a mishandling. In the 
File menu, the "Versions" option is to save the current version of the document, and to save a 
new version of the document every time. 
Figure 21: Document’s versions (Software in Spanish) 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 12 of 29 
Within an ODF document that contains different versions we can find important information. 
First of all, a file called VersionList.xml with information about who saved each different version 
and when: 
… 
Figure 22: VersionList.xml 
Secondly, all the different versions of the document are stored in a folder called "Versions". For 
each of them, we can find the complete structure of a document in OpenOffice, ODF, that is, 
each version contains the files meta.xml, settings.xml, content.xml, etc... 
Figure 23: Versions folder 
2.13 ANALYSIS AND CLEANING TOOLS 
There are some tools to analyze and remove Metadata in OpenOffice, such as 3BOpenDoc or 
3BClean, but these tools only remove the file meta.xml, leaving the information about printers, 
possible internal servers and data connections to databases in the files settings.xml and 
content.xml.  
It is true that the meta.xml file is especially important because, as the documentation says, this 
file is not going to be encrypted even when you save the file as password protected, but in 
terms of security the rest of the Metadata is equal. 
Therefore it is very important to have a tool capable of analyzing all the information stored in 
these files and providing a convenient and user-friendly environment for all users in an 
organization to clean al the Metadata files in OpenOffice.  
OpenOffice itself offers the option to "Remove personal information when you leave," but this 
option does not remove the information from the operating system, printers, the version of the 
product, the path to the template. And we have seen that this information can show hidden 
routes or addresses from internal servers and of course, connection information to databases 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 13 of 29 
Figure 24: Delete all personal information when save the document (Software in Spanish) 
As a conclusion, the "Delete all personal information" option and the use of the available tools 
eliminate some metadata but not all the hidden information within an OpenOffice document.  
A last alternative is to use tools to recover damaged documents. Using the Recovery for Writer, 
for example, the information stored in the meta.xml and settings.xml files, disappears. However, 
the information about the structure of the database and the connection in the content.xml file 
does not disappear, and in documents created with templates, the look of the document may 
change. Therefore, it is not a definitive solution. 
Figure 25: Recovery for Writter 
2.14 OOMETAEXTRACTOR 
As a better solution we conclude to develop a tool to extract and clean metadata and hidden 
info in OpenOffice documents. This tool is available under a Microsoft Public License in 
Codeplex web site. It has been developed in .Net so it needs .NET Framework and it has been 
tested only in Microsoft Windows operating systems. 
This tool allows users to analyze not only an ODF document but also a complete folder full of 
ODF documents in ODT, ODS or ODP formats. All metadata and hidden info are shown and 
can be exported in a text file. Moreover, this tool cleans all documents, even templates, links to 
documents, printer configuration and customized metadata. 
In order to create a company’s policy with metadata this tool has an option to set up a template 
for metadata. This means, what to do whit some kind of metadata. For instance, it would be 
desirable set up company’s name in company metadata, or a fixed author for all documents. 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 14 of 29 
This can be done easily with OOMetaExtractor. This tool is available for download along with its 
source code at http://www.codeplex.com/oometaextractor    
Figure 26: OOMetaExtractor (yes, it´s in Spanish) 
3 METADATA AND HIDDEN INFORMATION INSIDE MICROSOFT OFFICE 
DOCUMENTS 
During the Microsoft Office installation, a dialog lets the user input information about him or her. 
From that moment on, the information the user provided will be added to each and every 
document created, or edited, by that user with this software. 
Figure 27: User Information in Microsoft Office 2003 
In multi-user environments, the same product is often used by different users on the same 
computer. When a user runs an Office application for the first time, a new dialog appears asking 
for information about him or her. And, again, this information will be added to every document 
the user edits o creates. 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 15 of 29 
Figure 27: Another User stars Microsoft Office 2003 
And this information can pose a risk, above all because the default value for the “Name” field is 
the user account name. 
3.1 DOCUMENT PROPERTIES 
Upon document creation, authors can explicitly assign metadata to it, that is, creator can 
introduce a short description, keywords, and their department o whatever that may be suitable 
or useful. This data gets stored indefinitely inside the document file. When a document 
containing metadata is used as a template in order to create new documents, these ones will 
inherit this information. 
Document metadata is customizable, so they may contain any attribute and value the author 
could add. This must be kept into account when publishing documents created in corporative 
environments, because an inappropriate metadata can damage the organization image. 
Figure 28: Document´s properties (all in Spanish….) 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 16 of 29 
3.2 EMBEDDED FILES 
Microsoft Office allows users to embed images and other documents into the documents they 
create. These embedded documents may contain their own metadata, thus being a potential 
source for information leaks. 
The next example shown an image file created with GIMP, a graphic document creation 
program. That image contains EXIF information, readable with any EXIF extraction tool. It may 
be seen that the image has a metadata attribute showing the program used. It also has a 
thumbnail for the image inside the same file. 
Figure 29: EXIF Metadata in an embedded image 
Let’s embed this image inside a Microsoft Word 97 document, using the “Insert Image” option 
from the “File” menu. Then, using a hexadecimal editor, the image metadata can be read. 
3.3 EXTRACTING EMBEDDED FILES 
It is easy to extract these embedded files from Microsoft Word DOC, Excel XLS or PowerPoint 
PPT files. Just by saving the document in HTML (web page) format, these programs extract 
embedded files and store them as independent files. 
Figure 30:  Extracting embedded files 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 17 of 29 
It can be seen that EXIF information has not been modified. In this example, the thumbnail 
looks different from the image, showing that some editing work has been made on it. 
This metadata preserving behavior can be found in Microsoft Office versions. They don’t modify 
EXIF information unless the author uses the “Modify Image” option and then, saves the 
document. 
Microsoft Office 2007 introduces a new file format, called OOXML which will become to ISO DIS 
29500 in next Microsoft Office versions. DOCX, XLSX, and PPTX files are ZIP compressed 
archives in which embedded files are stored as independent items. These items can also be 
easily extracted. 
Figure 31: Files inside an OOXML file 
3.4 REVISIONS Y MODIFICATIONS 
Users involved in document sharing and workflows find Microsoft Office “Revision” feature 
especially useful. This feature allows more than one user to work on the same document, while 
keeping track of who made each change, so that previous document states can be recovered. 
But when the document is made available to the public, this data is no longer useful and can 
turn into compromising information. 
Figure 32: Changes can be seen (Image in Spanish) 
As the image shows, older contents are shown in red color. Final document view gives a 
positive result, while the older one gave a negative one. This could be seen by any user, only by 
selecting the “see original document”. 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 18 of 29 
3.5 NOTES, HEADERS AND PAGE FOOTINGS 
There are other places where non intended information may appear, such as notes and page 
headers and footers, or presentation annotations. They can contain reference codes used inside 
the organization, names of users that worked on the document or file paths. All this information 
must be taken into account before the document is published. 
3.6 ELEMENTS HIDDEN BY THEIR FORMAT 
In a Microsoft Office document, an image can be hidden by other ones above it. Template 
elements may contain undesired data that afterwards can be hidden by document text or 
images. Some text can be of the same color than the background. All these items are not 