Figure 6 shows the survival probability of the 26 673 source in-
fections observed throughout the entire time period. Any measure
of infection lifetimes involves “censored” data points, that is, in-
fections that have not been remedied by the end of the observation
period. In our dataset, 1 178 source infections were still actively
redirecting at the end of data collection and are therefore censored.
Survival analysis can deal with such incompleteness in the data by
building an estimated probability distribution that takes censored
data points into account. Figure 6 plots the survival probability as
calculated using the Kaplan-Meier estimator [13].
Figure 5: Percentage of search results per category, based on
the type of query. Active redirections dominate results regard-
less of the intention of the query.
the progress defenders (such as search engines) have made in com-
bating this method of abuse. We now study much more explicitly
how the interplay between those perpetrating search-redirection at-
tacks and those working to stop them has evolved.
Figure 6: Survival probability for source infections. We use the
entire measurement interval T1, T2, T3 to compute this metric.
Several conditions must simultaneously hold for a search-redirection
attack to be successful. First, the source infection must appear in
the search results for popular queries. Second, the infection must
remain on the website appearing in the results. Third, any interme-
diate trafﬁc brokers must remain operational. Fourth, the destina-
tion website must stay online. Defenders may disrupt any one of
these components to counter search-redirection attacks. In this sec-
tion we examine how effective defenders have been in combating
each component of the attack infrastructure. We ﬁrst study the per-
sistence of source infections over time, before investigating trafﬁc
brokers and destinations.
6.1 Cleaning up source infections
A key measure of defense is the time source infections persist
in the search results and continue redirecting trafﬁc elsewhere. We
calculate the survival time of a source infection as the number of
days a fully-qualiﬁed domain name (FQDN) is ﬁrst and last ob-
served to be actively redirecting to different domains while appear-
Figure 7: (Top) Median time (in days) to cleanup source in-
fections over time. (Middle) Source infections per 100 results
over time. (Bottom) Median time (in days) to cleanup source
infections by TLD.
We can see from the ﬁgure that many infections are short-lived.
One-third last ﬁve days or less, while the median survival time for
infections is 19 days. Nonetheless, it is noteworthy that some infec-
tions persist for a very long time. 17% of infections last at least six
months, while 8% survive for more than one year. 459 websites,
1.7% of the total, remain infected for at least two years! Hence,
while most infections are remedied in a timely fashion, a minority
persist for much longer.
We next investigate how the time required to cleanup source in-
fections has changed over time. We computed a survival function
for each month from April 2010 to March 2013. We included all
source infections that were ﬁrst identiﬁed in that month. To make
4We treat different URLs on the same FQDN as coming from a
single infection. The reason we consider different FQDNs shar-
ing the same second-level domain name as distinct infections is
that frequently differing FQDNs represent distinct servers (e.g.,
bronx.mit.edu and strategic.mit.edu both appear in
our sample). There is one exception to this policy. Whenever we
observe multiple FQDNs cleaned up on the same day, we treat them
as a single infection.
2011201220130204060Search result distribution: illicit intent% of search resultsG1G2G3C1C2B1B2B3Active redirectsUnlicensed pharmaciesHealth resourcesUnclassified2011201220130204060Search result distribution: benign intent% of search resultsG1G2G3C1C2B1B2B32011201220130204060Search result distribution: gray intent% of search resultsG1G2G3C1C2B1B2B315105010050010000.00.20.40.60.81.0Survival probability over entire durationDays before cleanupSurvival probability20112012201310203040Median days before cleanup (overall)Median # days before cleanup20112012201301234Source infections over timeInfected FQDNs per 100 search results201120122013020406080Median days before cleanup (by TLD)Median # days before cleanupOverall.COM.EDU.ORGcomparisons consistent across months, we censored any observed
survival time greater than 180 days.5
Figure 7 (top) reports the median survival time (in days) for each
monthly period. We can immediately see that the median time is
highly volatile, ranging from 42 days in April 2010 to 2 days in
June 2012. However, the overall trend is down, as indicated by the
best-ﬁt orange dotted line. Judging by the trend line, it appears that
the median time to clean up source infections has fallen by around
10 days in three years.
While this is a welcome trend, we wondered what impact, if any,
expedited cleanup times could have on the attacker’s strategy. In
particular, shorter-lived source infections could lead attackers to
simply compromise more websites than before. Figure 7 (mid-
dle) plots the number of source infections per 100 search results
observed each month.6 Here we observe a strongly positive ef-
fect. While the number of infected FQDNs hovered around 1 per
100 search results in 2010 and early 2011, observed infections in-
creased substantially beginning in late 2011. This rose to nearly 4
infections per 100 search results by late 2012, before falling some-
what. Hence, it does appear that any crackdown in cleaning up
source infections has been matched by an uptick in new infections,
which helps to explain the increase in the percentage of search re-
sults that redirect as shown in Section 5.
Finally, Figure 7 (bottom) examines how cleanup times have
changed for source infections on different top-level domains (TLDs).
In our earlier work [15], we found that .edu websites remained in-
fected for much longer than others, and that .org and .com were
cleaned more quickly. The ﬁgure shows that .com websites (de-
noted by the long dashed brown line) still in fact closely follow
the overall trends in cleanup times. Notably, however, .edu web-
sites (indicated by the dashed green line) went from considerably
above-average survival times in 2010 to following the average by
mid-2011. In their place, however, .org websites began to lag be-
hind starting in mid-2011. The timing suggests that attackers may
have even shifted to targeting .org websites once .edu websites
started to be cleaned up.
6.2 Cleaning up trafﬁc brokers and destina-
tions
Source infections are not the only hosts that can be targeted by
defenders when combating search-redirection attacks. Trafﬁc bro-
kers and destinations can also be shut down. We now compare the
survival times of these to source infections.
Figure 8 (top) plots the survival time for source infections, trafﬁc
brokers and destinations. For trafﬁc brokers and destinations, we
report the second-level domain survival time, since subdomains of-
ten change to match drug names (e.g., zoloft.example.com).7
We also report the survival time for websites appearing for at least
two days, since this removes a substantial number of false positives.
The graph shows that source infections are removed fastest, fol-
lowed by destinations and trafﬁc brokers. For example, 43% of
sources are removed within three weeks, compared to 29% of traf-
ﬁc brokers and 36% of destinations. The median survival time for
source infections is 34 days, compared to 59 days for destinations
and 86 days for trafﬁc brokers. So while the median trafﬁc broker
performs worst, the story changes slightly in the tail of the distri-
bution: the 20% longest-lived source infections survive at least 6
5This censoring also explains why we do not report anything for
the ﬁnal six months of the study.
6The missing points in Figure 7 (middle) are from months when
there are temporary 50% or greater drops in gathered search results.
7We removed 7 trafﬁc brokers and 5 destinations from considera-
tion here because they are known URL shortening services.
Figure 8: (Top) Survival probability for source infections, traf-
ﬁc brokers and destinations over all time.
(Bottom) Median
time in days (survival time) to cleanup source infections, trafﬁc
brokers and destinations.
Figure 9: Major autonomous systems hosting trafﬁc brokers.
The plot shows the number of redirection chains using brokers
from these ASes. In early 2013, US1 stopped hosting trafﬁc
brokers, which seemingly moved to NL.
months, compared to 9 months for trafﬁc brokers and 11 months
for destinations.
Figure 8 (bottom) tracks how the median survival time changes
over time for source infections, trafﬁc brokers and destinations.
The median times are calculated quarterly, rather than monthly as
in Figure 7 (bottom), due to the smaller number of trafﬁc brokers
and destinations compared to sources. We see once again the slow
but steady improvement in reduced survival times for source infec-
tions. However, we see much greater vacillation for the survival
times of trafﬁc brokers and destinations. For some quarters the me-
dian time is around 5 months, whereas in others it follows more
closely the survival times of sources. Notably, the survival times of
trafﬁc brokers and destinations are positively correlated.
We conclude from this analysis that trafﬁc brokers and destina-
tions have not received the same levels of pressure from defenders
as source infections have. This is reﬂected in the longer survival
times, as well as in the smaller number of domains ultimately used.
Where are trafﬁc brokers hosted? The previous set of ﬁndings
led us to look up the autonomous system (AS) each trafﬁc broker
belongs to. It turns out that only 7 ASes (3 in the US, 3 in Ger-
many, 1 in the Netherlands) support more than 10 trafﬁc brokers
every day. We plot on Figure 9, the number of redirection chains
2510205010020050010000.00.20.40.60.81.0Survival probability over entire durationDays before cleanupSurvival probabilitysource infectionstraffic brokersdestinations201120122013050100150Median time to cleanup source infections, traffic brokers and destinationsTime website first observed in search−redirection attackMedian # days before cleanupsource infectionstraffic brokersdestinations201220130200400600800Traffic brokers observed each day grouped by AS# of redirection chainsUS1US2US3DE1DE2NLDE3Daily average (FQDNs)
Per broker
Trafﬁc brokers
Redirecting to a single pharmacy
Redirecting to many pharmacies
Redirecting to other brokers
#
%
23.1
14.4
3.8
61.1%
33.8%
5.2%
Infections
18.9 URLs
11.8 URLs
-
Pharmacies
1 URL
2.8 URLs
-
Pharmacies
Without trafﬁc broker
With dedicated trafﬁc broker
With shared trafﬁc broker
#
%
59.0
17.8
32.0
55.9%
18.1%
28.4%
Daily average (FQDNs)
Per pharmacy
Infections
4.6 URLs
24.2 URLs
5.4 URLs
Trafﬁc brokers
-
1.3 URLs
2.2 URLs
Table 4: Characteristics of trafﬁc brokers. The data is given
in averages of daily means over T3.
Table 5: Characteristics of pharmacies. Data given as averages
of daily means (over T3).
supported by brokers belonging to these 7 ASes as a function of
time. None of these autonomous system provides “bulletproof host-
ing.” In fact, US1 is a known cloud-service provider. Some time in
2013, US1 seemingly decided to shutdown these brokers that had
been using their service for more than a year. Some of them con-
sequently shifted to NL, but what is most striking in this plot is the
high concentration in trafﬁc brokers over a few autonomous sys-
tems, especially since mid-2012. Coordinated take-downs among
these ASes could be a very promising avenue for intervention.
7. ADVERTISING NETWORK
We next turn to a deeper discussion of the redirection chains
involved in search-redirection attacks. Redirection chains can in-
deed yield valuable insights about the “advertising network” used
by criminals to peddle their products. We study trafﬁc brokers and
destinations in this section. We only focus on interval T3, since
from Table 2, neither Datasets 1 nor 2 contain enough information
to be able to extract the information we discuss here. In the remain-
der of this section, we always look at trafﬁc brokers and pharmacies
at the fully-qualiﬁed domain name level.
Source infections to trafﬁc brokers. We start by looking at the
connections between source infections and trafﬁc brokers. On av-
erage, over 95% of the source infections a given day actually work;
that is, less than 5% fail to take the visitor to a questionable site,
instead landing on a parking page.
About a quarter (25.1%) of these source infections send trafﬁc
directly to a pharmacy without any intermediate trafﬁc broker.
Another 42.8% use dedicated brokers that only get trafﬁc from
a single infection. More interestingly, on average about 14.8% of
source infections send trafﬁc to a broker shared with other source
infections. Such brokers on average send trafﬁc to 2.4 different
pharmacies.
Trafﬁc broker characteristics (Table 4). Unsurprisingly, in light
of what we saw above, 61.1% of brokers drive trafﬁc to a single
pharmacy, receiving trafﬁc from 18.9 infected URLs on average.
33.8% of brokers redirect to multiple pharmacies, and receive on
average trafﬁc from 11.8 URLs. Finally only 5.2% of trafﬁc brokers
send trafﬁc to other trafﬁc brokers.
Pharmacies (Table 5). We see that 56% of pharmacies do not rely
on any broker and get their trafﬁc, on average, from 4.6 infected
URLs. 17.8% of all pharmacies get trafﬁc from a dedicated broker,
which feeds them trafﬁc coming from about 24.2 distinct infected
URLs. Slightly less than a third of all pharmacies use a shared traf-
ﬁc broker, which—interestingly enough—forward trafﬁc from only
5.2 infected URLs. In other words, dedicated trafﬁc brokers appear
to be driving considerably more trafﬁc than “co-hosted” solutions
using shared trafﬁc brokers. This in turn seems to give further cre-
dence to the belief that “advertising networks” (e.g., pharmaceuti-
cal afﬁliates) are highly heterogeneous, with actors ranging from
powerful “dedicated” brokers to others operating on a shoe-string
budget. The proportion of pharmacies directly linked to infections,
without a trafﬁc broker, is high – and can be explained by the dif-
Graph characteristics
Number of nodes
Redirecting results
Trafﬁc brokers
Pharmacies
Connected components
Daily average
#
1055.4
908 (URLs)
41.3 (FQDNs)
106.1 (FQDNs)
82.6
%
100
86.0
3.9
10.1