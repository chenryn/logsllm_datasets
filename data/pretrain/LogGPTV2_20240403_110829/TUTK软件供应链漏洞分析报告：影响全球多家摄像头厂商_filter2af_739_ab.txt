  * 不使用AuthKey进行IOTC连接的设备固件
  * 使用AVAPI模块而不启用DTLS机制的设备固件
  * 使用P2PTunnel或RDT模块的设备固件
**修复方案**
  * 如果SDK是3.1.10及以上，请开启Authkey和DTLS
  * 如果SDK低于3.1.10，请将库升级到3.3.1.0或3.4.2.0并开启Authkey/DTLS
## 写在最后
相对于CVSS 给出的 9.1 的威胁评分和需要抓取流量作为利用前提，摄像头类的设备面临的 RCE
漏洞往往更为致命，我们呼吁关注设备厂商关注摄像头设备的代码质量和供应链的风险。
在分析此漏洞的过程中，通过安全大脑在全网的持续监测，我们观测到该漏洞影响的厂商和产品型号范围依然在增长变动的过程：（完整的受影响设备固件和文件列表见文末附件）
此外，安全大脑还监测到mirai_ptea僵尸网络正在利用上述设备的其他漏洞进行DDos攻击和传播[6]，这引发了另一个角度的思考：
在供应链安全风险的问题上，过去业界主要聚焦于关键基础设施等个别领域，而在其他领域，特别是IoT等小型智能设备领域上，往往由于单个IoT设备安全问题影响较小而普遍被忽视。
**但是，如今由智能家居、产业数字化升级、智慧城市建设、智能车联网、智能工业互联网等形成的超过百亿联网IoT设备聚集起来形成的设备网络，某种意义上讲已经形成了另一种形态的新型关键基础设施，并且可以触达城市/工厂/居民家庭的各个角落，一旦大规模的IoT设备被僵尸网络控制，将可能被用于窃取城市、国家方方面面的情报数据以及发动大规模的网络攻击。特别当再次出现类似由上游软件供应链问题导致的大规模安全事件时，将可能导致网络空间成千上万的联网设备同时出现安全风险，其可能导致的潜在威胁将足以比拟关键基础设施安全问题。**
产业的全球化进程导致了软件供应链问题更加错综复杂，全球各厂商生产制造过程彼此互相交织，网络空间安全已经是全球问题，需要全球合作，携手保障数字经济安全。
从近年来的国家立法层面以及激励政策方面，已经可以看到越来越多提及到供应链安全，例如《网络安全审查办法》（修订草案征求意见稿）[7]中的开篇第一条：
第一条 **为了确保关键信息基础设施供应链安全，维护国家安全**
，依据《中华人民共和国国家安全法》《中华人民共和国网络安全法》《中华人民共和国数据安全法》，制定本办法。
以及在《网络安全产业高质量发展三年行动计划(2021-2023年）（征求意见稿）》[8]中 **将软件供应链安全列为重点任务之一** ：
6. **加强共性基础支撑** 。持续建设高质量威胁信息、漏洞、恶意代码、恶意地址、攻击行为特征等网络安全基础知识库，强化网络安全知识支撑能力。加快发展恶意代码检测、高级威胁监测分析、信息处理、逆向分析、漏洞分析、密码安全性分析等底层引擎和工具，提升网络安全知识使用水平。 **加快发展源代码分析、组件成分分析等软件供应链安全工具，提升网络安全产品安全开发水平。** 积极推进网络靶场技术研究，建设结合虚拟环境和真实设备的安全孪生试验床，提升网络安全技术产品测试验证能力。
相信未来软件供应链安全问题的治理将会得到不断的改善，360安全大脑与安全专家团队也将持续为客户提供更好的软件供应链安全治理服务与基础设施建设服务。
在此也欢迎厂商和我们联系以获取更详细的信息，协手合作，共同提升安全防护能力。
另外，我们近期正在招聘，包括安全研究员、Web前端开发、Web服务端开发等岗位，校招社招都有，欢迎热爱技术的你加入我们，简历请投递：PI:EMAIL。
## Reference
[1] [https://www.nozominetworks.com/blog/new-iot-security-risk-throughtek-p2p-supply-chain-vulnerability/](https://www.nozominetworks.com/blog/new-iot-security-risk-throughtek-p2p-supply-chain-vulnerability/)
[2] [https://www.throughtek.com/about-throughteks-kalay-platform-security-mechanism/](https://www.throughtek.com/about-throughteks-kalay-platform-security-mechanism/)
[3] [https://github.com/cnping/TUTK](https://github.com/cnping/TUTK)
[4]
[https://download.csdn.net/download/u013852008/12797862](https://download.csdn.net/download/u013852008/12797862)
[5]
[http://www.sunipcam.com/sdk/%E8%87%AA%E5%8A%A8%E8%B7%9F%E8%B8%AA%E7%90%83%E6%9C%BASDK%E5%BC%80%E5%8F%91%E5%8C%85.zip](http://www.sunipcam.com/sdk/%E8%87%AA%E5%8A%A8%E8%B7%9F%E8%B8%AA%E7%90%83%E6%9C%BASDK%E5%BC%80%E5%8F%91%E5%8C%85.zip)
[6] [https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/](https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/)
[7]
[http://www.cac.gov.cn/2021-07/10/c_1627503724456684.htm](http://www.cac.gov.cn/2021-07/10/c_1627503724456684.htm)
[8]
[https://wap.miit.gov.cn/gzcy/yjzj/art/2021/art_34f89fff961b4862bf0c393532e2bf63.html](https://wap.miit.gov.cn/gzcy/yjzj/art/2021/art_34f89fff961b4862bf0c393532e2bf63.html)
## 附件
### 受影响固件型号列表
厂商
|
固件名称
|
MD5  
---|---|---  
HanwhaTechwin
|
WisenetMobile.zip
|
92d6c709a941d44aa476b6736470c336  
HME
|
HM-4LADVR264-205.01.09.XXX-v154.zip,HM-4AL.zip
|
e325a54bbd66cb9442344bcf92e892ad  
HM-16LADVR264-32.03.12.XXX-v154.zip,HM-16AL.zip
|
88bfa641a374460ec84a5e994f19764d  
HM-8LADVR264-211.02.39.XXX-v154.zip,HM-8AL.zip
|
8d6d09b89f505ec818993f1fdbde37a3  
HM-45DVR264-214.01.08.XXX-v154.zip
|
bbdaad67344f93a52cef6e5a5d65f644  
HM-4M16ADVR264-32.03.08.XXX-v154.zip
|
089581374bb8a1538c6fa81ebe038a10  
HM-16ADVR264-32.03.09.XXX-v154.zip
|
711fcaf06bf1f5a95402749a20900fb4  
HM-8HDVR264-211.02.42.XXX-v154.zip
|
d13c5c24014d961c722f066cfa21c02c  
HM-3116AFHDLDVR264-31.03.07.XXX-v132.zip
|
61c2e2eed4d06d2a6b84c4e1474b7fd2  
HM-8ADVR264-211.02.09.XXX-v154.zip
|
acb94b5846382a83634776a4b2014389  
HM-4M8ADVR264-211.02.08.XXX-v154.zip
|
d224c59b1aca9d234bcfcb5fb6d5399f  
HM-165DVR264-35.03.08.XXX-v165.zip
|
4bd5014ad4598b1763ed810730851215  
HM-4M4ADVR264-211.01.08.XXX-v154.zip
|
22b18fc59e656d1f40b31006ef47991a  
Aquila.zip
|
3add1a452d0544ec6d46fee94be3c554  
HM-85DVR264-214.02.08.XXX-v85.zip
|
f02a265b656cd5d5693f9586fc4180a6  
HM-16HDVR264-32.03.42.XXX-v154.zip
|
57e29ad61b11409ff6ffb29d0428b801  
HM-4ADVR264-211.01.09.XXX-v154.zip
|
7445506d2d7eb699aed4c5909819a97f  
IODATA
|
wfssr02_f111.exe
|
4d7ea755ddfd7c6002da284eb0a2a46a  
wfssr02_f110.zip
|
f2911a80cc815ce22156c4c57b75cb16  
wfssr02_f110.exe
|
6fd383b1eb1c12decf7dd911c93897af  
wfssr02_f111.zip
|
9487aec3ccef0dcf156a2af2c6db3199  
KGuard
|
How_to_upgrade_QRT601_FW6K_IPC_V4.00.00.80_20170426.zip
|
55e74555b5919a8d714cc34a03580c49  
dvrupgrade.zip
|
60c1fec812eb21b2011e30ccf6585b43  
UPG_ipc5955a-mw7-M20-hi3518e-20151201_171603.zip
|
405592d898e8f6956b77d3b7d7a94f72  
UPG_ipc2564a-w7-M20-hi3518e-20160104_155726.ov
|
c5377798cd9740d9be066e824718c68b  
CONSUMER_KGUARD_6K_IPC_V4.00.00.79_20170104.img.rom.zip
|
49313db90be3adb99aa4d5480c6324a7  
V20160831.zip
|
3c23f77c568193e6cb5da5956c60ba87  
UPG_ipc2564a60N-w7-M20-hi3518e-20160606_144704.ov
|
9b224d97849cdf242345d1b307ee6f18  
CONSUMER_KGUARD_6K_IPC_V4.00.00.80_20170426.img.rom
|
56c35f4839080d4e242228d2a679f7a9  
dvrupgrade.zip
|
36676808c7e51107fe1407e3240d85e6  
V20160831.zip
|
ea99decbcd2d0843b1947a70f6bff967  
UPG_ipc2564a60N-w7-M20-hi3518e-20160831_161521.ov
|
b33a7cff0cb3f860fa8fefa6c3f2e14c  
LiLin
|
DHD204A–USBRecoveryTool.zip
|
f2dfc5a9bf894f76a5d15aee82799cf9  
DHD216Firmwarev2.0b60_20200207.zip
|
a608295e6a0be3e9a925f0f14c020eae  
DHD208Firmwarev2.0b60_20200207.zip
|
ec934cbcdc328a7c46aabde3827c29f8  
Firmware-DHD504A-EN.zip
|
f38fc70b5fa8f45dcae9c6edb6e2f910  
DHD216A–USBRecoveryTool.zip
|
d688cee5b0704aa6335502d483d428dc  
DHD204AFirmwarev2.0b60_20161123.zip,Firmware-DHD204A-EN.zip
|
d0c31820e03f24df77f55b4b3cc6fedb  
DHD208A–USBRecoveryTool.zip
|
8b3af5fc3b5cf45ccd25cb7379259c69  
Firmware-DHD216-EN.zip
|
8dde05721ec30927c062e7e67556e0ec  
DHD208AFirmwarev2.0b60_20200207.zip
|
0b335d7cab4e5ef460bb7df1607697bc  
DHD204AFirmwarev2.0b60_20200207.zip
|
642aa28e3a36188e798b67901a6bb193  
DHD208AFirmwarev2.0b60_20161123.zip,Firmware-DHD208A-EN.zip
|
59eb27fc1bb61f2c2c9c3e4da717ffd4  
DHD216AFirmwarev2.0b60_20200207.zip
|
31328d3424c79895232c599941ef03dd  
DHD308AFirmwarev2.0b1_20200122.zip
|
a8f2daf3b1d072e56bf6c09066edd0b1  
Firmware-DHD316A-EN.zip
|
da4a90762aa1be0204b24ab4c6f9c098  
Firmware-DHD516A-EN.zip
|
d3d70caf606648c5f682f4ee4b68be2b  
Firmware-DHD208-EN.zip
|
7cbacba456dddc30ac490a2414af0d4b  
Firmware-DHD304A-EN.zip
|
f8104380a8e4a606db575c70fe9228a6  
Firmware-DHD216A-EN.zip
|
c0d3206baaf7740f30a63e6cb29670fc  
Firmware-DHD508A-EN.zip
|
5bafd973bdcf0ad65c4faceef71804ac  
DHD508AFirmwarev2.0b1_20200831.zip
|
1ee2c99601c974e4cffe2afc060e1c0f  
DHD204AFirmware.zip
|
3bb95a6a11d6213fdc8a65752bf85091  
Firmware-DHD308A-EN.zip
|
11bc95e2f178973eae61d069107803a2  
DHD208Firmware.zip
|
e5220410a9b337eb77ada1e1c7faa05a  
DHD516AFirmwarev2.0b1_20200122.zip
|
0f874ec282b07bb4f53dd937daea77c6  
DHD516AFirmwarev2.0b1_20200831.zip
|
fac35e234798c162ea2338ae5375e35e  
DHD304AFirmwarev2.0b1_20200122.zip
|
732933d0537fd8fbbc07066489f57909  
DHD216AFirmware.zip
|
60b7cad13e980f0375c09a491d14fef7  
DHD504AFirmwarev2.0b1_20200831.zip
|
7e13031205a2f2b6a12464608a18d2c2  
DHD508AFirmwarev2.0b1_20200122.zip
|
1f6e90038859d338a5f2a571a68498c3  
DHD308AFirmwarev2.0b1_20200122.zip
|
e4426c0afb65aa6a7170c4b308135ab2  
DHD316AFirmwarev2.0b1_20200122.zip
|
7ed897f4379618cbc0f4a55ee6c4bbdd  
DHD316AFirmwarev2.0b1_20200122.zip
|
dd5a032b9253b2ad033c5277e4e10a54  
Firmware-DHD216A-EN.zip,DHD216AFirmwarev2.0b60_20161123.zip
|
c637b9257c4e32fc561268383d640680  
DHD504AFirmwarev2.0b1_20200122.zip
|
2e9aa72f61745a0e41f6522e37ea107f  
DHD216Firmware.zip
|
6b17da1367893e4cd37595cc00d40433  
DHD304AFirmwarev2.0b1_20200122.zip
|
2b1c05d37361929d526f48ecdf7baa87  
DHD504AFirmwarev2.0b1_20191202–JPEGC4panels.zip
|
bb0569fcd47f3d00e0682bc9084a7ffd  
DHD216Firmwarev2.0b60_20160504.zip
|
9ec09b458d285581a1c1861cb86da1ff  
DHD308AFirmwarev2.0b1_20180828.zip
|
36d12e7c6fb405eb1393c432c92b86d3  
DHD316AFirmwarev2.0b1_20171128C4Panels.zip
|
25fcb06fb2cd16ce60c594588ecc9d3a  
DHD504AFirmwarev2.0b1_20200122.zip