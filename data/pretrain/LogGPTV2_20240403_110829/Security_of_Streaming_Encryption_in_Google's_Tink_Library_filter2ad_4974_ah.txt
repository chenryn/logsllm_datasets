ğ‘–,1, . . . , ğ¶*
1 âˆ’(ï¸1 âˆ’ ğ‘
)ï¸ğ‘ â‰¤ 1 âˆ’(ï¸1 âˆ’ ğ‘
)ï¸ğ‘ â‰¤ ğ‘ğ‘
2ğ‘˜+2
2ğ‘˜+2 ,
2ğ‘›ğ‘Ÿ
where the first inequality is due to the fact that ğ‘›ğ‘Ÿ â‰¥ ğ‘˜ + 2, and the second inequality is due to
Bernoulliâ€™s inequality.
Wrapping up. Summing up, the adversaryâ€™s advantage is at least
ğ‘ğ‘
2ğ‘˜+1 âˆ’ ğ‘ğ‘
2ğ‘˜+2 = ğ‘ğ‘
2ğ‘˜+2 .
B.2 AE Attack
Let ğ›± = (K, E, D) be a conventional AE scheme of ğ‘˜-bit key length and ğ‘ -bit nonce length. Let
ğ‘, ğ‘ â‰¥ 1 be integers such that ğ‘ğ‘ â‰¤ 2ğ‘˜.
The attack. Let ğ´ be the empty-string AD. The adversary ğ’œ first picks an arbitrary message
ğ‘€ such that |ğ‘€| â‰¥ ğ‘˜ + 2, and an arbitrary nonce ğ‘. It then queries ğ¶ğ‘– â† Enc(ğ‘–, ğ‘, ğ´, ğ‘€)
for every ğ‘– = 1, . . . , ğ‘. It then picks arbitrary distinct keys ğ¾1, . . . , ğ¾ğ‘ âˆˆ {0, 1}ğ‘˜, and computes
ğ‘— â† E(ğ¾ğ‘—, ğ‘, ğ´, ğ‘€) for every ğ‘— = 1, . . . , ğ‘. If there are ğ‘– â‰¤ ğ‘ and ğ‘— â‰¤ ğ‘ such that ğ¶ğ‘– = ğ¶*
ğ¶*
ğ‘— then
the adversary outputs 1, otherwise the adversary outputs 0.
Real worldâ€™s analysis. In the real world, if there is an adversarial key ğ¾ğ‘— that coincides with
the key of user ğ‘– then the adversary will output 1. Since the user keys are chosen uniformly at
random, this happens with probability
1 âˆ’(ï¸1 âˆ’ ğ‘
)ï¸ğ‘ â‰¥ ğ‘ğ‘
2ğ‘˜
2ğ‘˜+1 .
where the last inequality is due to Lemma 4. Hence in the real world, the adversary outputs 1 with
probability at least ğ‘ğ‘/2ğ‘˜+1.
Ideal worldâ€™s analysis. Assume that there are no two keys ğ¾ğ‘– and ğ¾ğ‘— such that ğ¶*
ğ‘— . For
real AE schemes, this assumption is very likely to hold if ğ‘€ is long enough. In the ideal world,
the oracle answers are independent, truly random strings, and thus the chance that the adversary
outputs 1 is at most
ğ‘– = ğ¶*
1 âˆ’(ï¸1 âˆ’ ğ‘
)ï¸ğ‘ â‰¤ ğ‘ğ‘
2ğ‘˜+2 ,
2ğ‘˜+2
25
procedure Initialize
ğ¾1, ğ¾2, . . . â†$ ğ’¦; ğ‘ â†$ {0, 1}
ğœ‹1, ğœ‹2, . . . â†$ Perm(ğ‘›)
procedure Finalize(ğ‘â€²)
return (ğ‘â€² = ğ‘)
procedure Enc(ğ‘–, ğ‘‹)
ğ‘Œ1 â† ğ¸(ğ¾ğ‘–, ğ‘‹); ğ‘Œ0 â† ğœ‹ğ‘–(ğ‘‹)
return ğ‘Œğ‘
procedure Dec(ğ‘–, ğ‘Œ )
ğ‘‹1 â† ğ¸âˆ’1(ğ¾ğ‘–, ğ‘Œ ); ğ‘‹0 â† ğœ‹
return ğ‘‹ğ‘
âˆ’1
ğ‘–
(ğ‘Œ )
Fig. 14: Game GÂ±prp
ğ¸
defining multi-user prp security of a blockcipher ğ¸.
where the inequality is due to Bernoulliâ€™s inequality.
Wrapping up. Summing up, the adversaryâ€™s advantage is at least
2ğ‘˜+1 âˆ’ ğ‘ğ‘
2ğ‘˜+2 = ğ‘ğ‘
ğ‘ğ‘
2ğ‘˜+2 .
C Proof of Lemma 3
Our proof is based on the H-coefficient technique of Patarin [8,27] that we briefly review below.
The H-coefficient technique. The H-coefficient technique considers a deterministic distin-
guisher ğ’œ that tries to distinguish a â€œrealâ€ system S1 from an â€œidealâ€ system S0. The adversaryâ€™s
interactions with those systems define transcripts ğ’¯1 and ğ’¯0, respectivel. The following Lemma 5
bounds the statistical distance SD(ğ’¯1,ğ’¯0) between ğ’¯1 and ğ’¯0, namely the best distinguishing ad-
vantage of ğ’œ between S1 and S0.
Lemma 5.
good and bad ones. Further, suppose that there exists ğœ– â‰¥ 0 such that 1 âˆ’ pS1(ğœ)
transcript ğœ. Then,
[8, 27] Suppose we can partition the set of valid transcripts for the ideal system into
pS0(ğœ) â‰¤ ğœ– for every good
SD(ğ’¯1,ğ’¯0) â‰¤ ğœ– + Pr[ğ’¯0 is bad] .
Strong multi-user PRP. We will prove a better result that DESX1 is a (multi-user) strong
PRP. We now define the notion. Let ğ¸ : ğ’¦ Ã— {0, 1}ğ‘› â†’ {0, 1}ğ‘› be a blockcipher. Let Perm(ğ‘›) be
the set of all permutations on {0, 1}ğ‘›. For an adversary ğ’œ, let
AdvÂ±prp
ğ¸
(ğ’œ) = 2 Pr[GÂ±prp
ğ¸
(ğ’œ)] âˆ’ 1 ,
ğ¸
be the advantage of the adversary against the multi-user strong PRP security of ğ¸, where game
GÂ±prp
is defined in Fig. 14. This game is written as a standard-model notion; in the ideal-cipher
model, the adversary will be given oracle access to ğ¸ and its inverse as well. The (ordinary) PRP
notion is simply a special case of the strong PRP notion where adversaries are not allowed to make
Dec queries.
Results. The following Proposition 2 shows that DESX1 is a good strong PRP, which implies
Lemma 3.
26
Proposition 2. Let ğ¸ : {0, 1}ğ‘˜ Ã— {0, 1}ğ‘› â†’ {0, 1}ğ‘› be a blockcipher that we model as an ideal
cipher, and let ğº â† DESX1[ğ¸]. Then for any adversary ğ’œ that makes at most ğ‘ ideal-cipher
queries and ğ‘ Enc/Dec queries,
AdvÂ±prp
ğº (ğ’œ) â‰¤ 2ğ‘ğ‘ + ğ‘2
2ğ‘˜+ğ‘›
.
Proof. Our proof is based on the H-coefficient technique. We will consider even a computationally
unbounded adversary, and thus we can assume that the adversary is deterministic and never repeats
a prior query. Assume further that the adversary never makes a redundant query: (i) if it queries
ğ‘Œ â† Enc(ğ‘–, ğ‘‹) then it wonâ€™t query Dec(ğ‘–, ğ‘Œ ) and vice versa, and (ii) if it queries ğ‘Œ â† ğ¸(ğ½, ğ‘‹)
then it wonâ€™t query ğ¸âˆ’1(ğ½, ğ‘Œ ) and vice versa. The real system corresponds to game GÂ±prp
with
challenge bit ğ‘ = 1, and the ideal system corresponds to game GÂ±prp
with challenge bit ğ‘ = 0.
Setup. In the real world, after the adversary finishes querying, we will give it the keys ğ¾ğ‘– = (ğ½ğ‘–, ğ¿ğ‘–)
of all users ğ‘– that the adversary queries. In the ideal world, we instead give the adversary truly
random strings ğ¾ğ‘– â†$ {0, 1}ğ‘˜+ğ‘›, independent of the transcript. This key revealing only helps the
adversary. Thus a transcript consists of the revealed keys and the following information:
â€“ Ideal-cipher queries: For each query ğ‘Œ â† ğ¸(ğ½, ğ‘‹) or ğ‘‹ â† ğ¸âˆ’1(ğ½, ğ‘Œ ), we associate it with
â€“ Evaluation queries: For each query ğ‘Œ â† Enc(ğ‘–, ğ‘‹) or ğ‘‹ â† Dec(ğ‘–, ğ‘Œ ), we associate it with
an entry (prim, ğ½, ğ‘‹, ğ‘Œ ).
an entry (eval, ğ‘–, ğ‘‹, ğ‘Œ ).
ğº
ğº
Defining bad transcripts. We say that a transcript is bad if one of the following happens
â€“ There are entries (prim, ğ½, ğ‘‹, ğ‘Œ ) and (eval, ğ‘–, ğ‘‹*, ğ‘Œ *) such that (i) ğ½ = ğ½ğ‘– and (ii) either ğ‘‹* =
ğ‘‹ âŠ• ğ¿ğ‘– or ğ‘Œ * = ğ‘Œ âŠ• ğ¿ğ‘–, where ğ¾ğ‘– = ğ½ğ‘– â€– ğ¿ğ‘– is the key of user ğ‘– as indicated by the transcript.
In the real world these entries must be consistent, but it is unlikely in the ideal world.
â€“ There are entries (eval, ğ‘–, ğ‘‹, ğ‘Œ ) and (eval, ğ‘—, ğ‘‹*, ğ‘Œ *), with ğ‘– Ì¸= ğ‘—, such that (i) ğ½ğ‘– = ğ½ğ‘— and (ii)
either ğ‘‹ âŠ• ğ¿ğ‘– = ğ‘‹* âŠ• ğ¿ğ‘— or ğ‘Œ âŠ• ğ¿ğ‘– = ğ‘Œ * âŠ• ğ¿ğ‘—, where ğ¾ğ‘– = ğ½ğ‘– â€– ğ¿ğ‘– and ğ¾ğ‘— = ğ½ğ‘— â€– ğ¿ğ‘— are the
keys of users ğ‘– and ğ‘— respectively as indicated by the transcript. In the real world these entries
must be consistent, but it is unlikely in the ideal world.
If a transcript is not bad then we say that itâ€™s good.
Probability of bad transcripts. Let ğ’¯0 be the random variable for the transcript in the ideal
system. We now bound the probability that ğ’¯0 is bad. For each ğ‘– âˆˆ {1, 2}, let Badğ‘– be the set of
transcripts that violates the ğ‘–-th constraint of badness.
We first bound the probability that ğ’¯0 âˆˆ Bad1. Consider a pair of entries (prim, ğ½, ğ‘‹, ğ‘Œ ) and
(eval, ğ‘–, ğ‘‹*, ğ‘Œ *). Recall that in the ideal world, ğ½ğ‘– and ğ¿ğ‘– are uniformly random, independent of
those entries. Thus the chance that ğ½ = ğ½ğ‘– and either ğ‘‹* = ğ‘‹ âŠ• ğ¿ğ‘– or ğ‘Œ * = ğ‘Œ âŠ• ğ¿ğ‘– is at most
2/2ğ‘˜+ğ‘›. Summing that over ğ‘ğ‘ pairs of such entries,
Pr[ğ’¯0 âˆˆ Bad1] â‰¤ 2ğ‘ğ‘
2ğ‘˜+ğ‘› .
27
We next bound the probability that ğ’¯0 âˆˆ Bad2. Consider a pair of entries (eval, ğ‘–, ğ‘‹, ğ‘Œ ) and
(eval, ğ‘—, ğ‘‹*, ğ‘Œ *), with ğ‘– Ì¸= ğ‘—. Recall that in the ideal world, ğ½ğ‘–, ğ½ğ‘—, ğ¿ğ‘–, ğ¿ğ‘— are uniformly random,
independent of those entries. Thus the chance that ğ½ğ‘– = ğ½ğ‘— and either ğ‘‹ âŠ• ğ¿ğ‘– = ğ‘‹* âŠ• ğ¿ğ‘— or
ğ‘Œ âŠ• ğ¿ğ‘– = ğ‘Œ * âŠ• ğ¿ğ‘— is at most 2/2ğ‘˜+ğ‘›. Summing that over(ï¸€ğ‘
Pr[ğ’¯0 âˆˆ Bad2] â‰¤ ğ‘2
2
)ï¸€ â‰¤ ğ‘2
2 pairs of such entries,
2ğ‘˜+ğ‘› .
Summing up,
Pr[ğ’¯0 is bad] â‰¤ Pr[ğ’¯0 âˆˆ Bad1] + Pr[ğ’¯0 âˆˆ Bad2] â‰¤ 2ğ‘ğ‘ + ğ‘2
2ğ‘˜+ğ‘›
.
(3)
Transcript ratio. Fix a good transcript ğœ. For a key ğ½ âˆˆ {0, 1}ğ‘˜, let ğ‘‰ (ğ½) be the number
of entries (prim, ğ½, ğ‘‹, ğ‘Œ ), and let ğ‘ˆ(ğ½) be the number of entries (eval, ğ‘–, ğ‘‹, ğ‘Œ ) such that ğ½ğ‘– = ğ½.
Suppose that the transcript ğœ contains exactly ğ‘¢ users. Then in the ideal world,
Pr[ğ’¯0 = ğœ] â‰¤ 2âˆ’ğ‘¢(ğ‘˜+ğ‘›) âˆï¸
ğ‘‰ (ğ½)âˆ’1âˆï¸
ğ½âˆˆ{0,1}ğ‘˜
ğ‘–=0
ğ‘ˆ(ğ½)âˆ’1âˆï¸
ğ‘—=0
1
2ğ‘› âˆ’ ğ‘—
.
1