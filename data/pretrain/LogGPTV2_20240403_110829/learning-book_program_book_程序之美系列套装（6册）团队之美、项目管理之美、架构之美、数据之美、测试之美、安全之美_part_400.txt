1Edelman,Benjamin."Banner Farms in the Crosshairs."June 12,
2006.http://www.benedelman.org/news/061206-1.html。
6.2.2避开容易受骗的CPM广告
对于不满意CPM的广告客户，在线广告销售商提供了另两种基本方
式。首先，广告客户可以根据CPC（每点击成本）付费，只有当用
户点击了广告时才需要付费。另外，广告客户可以根据CPA（每行
动成本）付费，只有当广告客户实际卖出东西时才需要付钱。初看
上去，这两种方式都没有CPM容易受骗。也许它们确实更好一点，
但经验显示它们同样会受到欺骗。
玩弄CPC广告
CPC厂告是搜索引擎的基石，从本质上说是Google的所有利润的来
源。在最好的情况下，CPC使广告客户能够找到正在考虑购物的顾
客，这很可能是一种非常有效的市场策略。但是，CPC广告策略也
存在令人吃惊的过度付费问题。
考虑一个独立的网站发布者，他与一家CPC广告销售商达成了一种
合作关系。在这种合约中，CPC广告销售商向该发布者支付一笔费
用，一般是广告客户依据用户在该发布者的网站上点击了一个广告
而支付的钱的某个预定百分比。这使发行者很自然地产生尽可能地
多报告点击次数的动力。怎么做？有些发行者告诉它们的用户点击
这些广告。（“支持我的网站：请点击下面的广告之一”）其他发行
者使用JavaScript使用户的浏览器“点击”一个广告，而不管用户是否
想要访问这个广告山。大多数技艺高超的流氓发行者使用肉鸡类型
的代码，使被感染的PC加载各种CPC厂告，这些都是在用户并没有
请求厂告的情况下发生的，甚至是在用户根本没有看到广告客户的
网站的情况下发生的[2]。
CPC广告容易受到这类攻击，因为它的底层跟踪方法非常容易被愚
弄。就像CPM广告网络无法方便地确定一个用户是否实际看到了一
个广告一样，CPC广告销售商也无法分辨一次广告"点击"是由于一
的，还是由于其他类型虚假点击所导致的。总之，CPC广告销售商
根据发送给搜索引擎的Web服务器所携带发行者ID的特殊编码HTTF
请求跟踪点击的。但是，流氓发行者可以轻松地在用户并没有点击
2316
---
## Page 2318
任何东西的情况下伪造这类请求。在发展中国家，由承包人整天点
击广告以便从对应的网站收取费用也是一种成本很低的服务3]。
对于关注这个问题的CPC网络而言，一个很容易想到的办法是拒绝
合作伙伴，而只在自己的网站上显示广告。例如，在2008年中期，
Microsoft只在Live.com、Microsof的网站以及由受信任的顶级伙伴所
运行的网站上显示广告。但是这个策略限制了CPC网络的到达范
围，减少了广告客户的网络流量。反之，Google选择了相反的策
略：在2008年第二季度，Google向它的伙伴支付了14.7亿美元购买它
们的网站上的广告位置山。这么一大笔钱使Google增加了它的广告
的到达范围，使它的服务对潜在的广告客户更有吸引力。毫不奇怪
的是，Microsoft也在2008年7月坦白地宣布它将更广泛地开拓合作伙
伴国。
CPC广告销售者声称它们具有健壮的方式确认无效的点击，包括对IP
地址、重复点击和其他模式的无效点击回进行监控。但是，很难让
人对他们的方法充满信心。CPC销售商怎么才能知道哪些东西是他
们无法捕捉的呢？CPC销售商如何检测一个见多识厂的肉鸡每个月
在每台PC上只点击几次广告呢？如何应对把欺诈性点击与真正的点
击混合在一起并伪造正确HTTP头部的做法呢？更有甚者，有些欺诈
性点击会在每个广告客户的网站上浏览几个页面，这种情况又该怎
使合作伙伴可以无风险地要求额外的费用。
2005和2006产生了一系列的集体诉讼，认为顶级搜索引擎Yahoo！等
公司在防止点击欺诈、保护广告客户的账户方面无所作为。最终的
和解补偿金超过了1亿美元，尽管广告客户的实际损失可能远远不到
这个数。（如果一个广告客户未提交索赔申请，就无法分享这些和
解金）。同时，搜索引擎商们发布了为自己辩解的报告，否认点击
欺诈是重大的问题口。但是，根本的安全缺陷并没有得到改变。
为了保护自己免受点击欺诈的伤害，广告客户们有时雇用第三方的
点击欺诈检测服务对它们的Web服务器的日志文件进行审核，以搜
索可疑的活动[]。Google通过公开的响应，对其中一些服务的分析
误差进行了秤击。（很容易预测的是，Google掩盖了由于自己向
这些服务所提供的数据有限而导致它们存在缺陷的程度）。Google
甚至尚不清楚点击欺诈检测服务是否可以检测到那些来源于肉鸡的
包含点击后浏览的点击欺诈。不过，虽然点击欺诈检测服务确实存
2317
---
## Page 2319
在缺陷，但它们至少能够找到一些明显的点击欺诈，可以对搜索引
擎的过度收费进行部分纠正。
增加CPA成本
每行动成本（CPA）广告看上去是最不容易受到欺诈的，这种广告
只有当用户在广告客户的网站上进行一次购买时才支付广告费用。
从某种重要的意义上，CPA降低了广告客户的风险：如果没有用户
看到广告、没有用户点击广告或者没有用户在点击广告后进行了购
买，广告客户就不需要支付广告费用。因此，像LinkShare和
CommissionJunctiontoutCPA这样的附属网络可以作为其他类型的在
线广告的低风险替代品[10]。
但是，CPA距离对欺诈免疫还差得很远。假设大家都知道一个商家
采用立即支付佣金的方式，例如在订单产生的当天支付。一位合谋
者可以通过攻击者的CPA链接进行购买，然后退还商品并要求全额
退款。这样，由于商家立即向攻击者支付佣金，因此虽然发生了退
款，但攻击者还是拿到了佣金。另外，如果被拒绝的信用卡或者退
款是在儿大后才知道的，攻击者有可能在商家注意到这种情况前骗
走了佣金。看上去这种事情很难大规模地发生，但事实上这类诈骗
还是时有出现（现在比过去要少一些）。
在一个更精密的方案中，攻击者设计一个网页或横幅广告，自动调
用CPA链接，不需要用户采取任何行动点击这个链接。如果用户以
后恰好从对应的商家进行了购买，攻击者就可以得到佣金。把这个
方案应用于Amazon、eBay等Web上最大的商家后，这些"填满的
cookie"可以产生大量的佣金支出，因为即使没有广告的鼓励，仍然
有非常多的用户在这些顶级商业网站上进行购买[]。所有的迹象
表明，问题的数量还是相当可观的。例如，eBay认为这样的欺诈非
常严重，值得联邦立法。eBay于2008月8月对DigitalPointSystems及
其他公司的诉讼就是例子。在诉讼中，eBav要求共同被告们强制在
用户的计算上安装eBay的跟踪cookie，因此如果没有提供真正的市场
服务或者没有通过任何方式增加eBay的市场影响力，就无法从eBay
获取佣金[12]。
在一种特别复杂的CPA方案中，攻击者首先在用户的计算机上安装
跟踪软件，即间谍软件（或者用更礼貌的说法，恶意广告软件）。
然后，这种跟踪软件监视用户的浏览活动并调用CPA链接最大限度
地获取佣金。假设一位攻击者注意到一个用户正在浏览Dell网站的
2318
---
## Page 2320
笔记本电脑网页，这位攻击者可以打开一个指向Dell的CPA链接，这
样如果用户从Dell1网站进行了购买，这位攻击者就可以获得2%的佣
金。（不管怎么说，到哪里去寻找比刚刚浏览了Dell新产品的用户
更好的Del1顾客呢？）对于Dell而言，事情看上去很正常：所有迹象
显示，一位用户点击了一个CPA链接并进行了购买。但是，Dell并没
有意识到用户实际上并没有点击这个链接。反之，是间课软件打开
了这个链接。Dell没办法知道用户实际上肯定会购买笔记本电脑，
这意味着它所支付的2%佣金是完全没有必要并且很浪费。遗憾的
是，Dell无法知道事实真相，因为Dell无法确认“点击"实际上来自间
课软件而不是用户的点击，并且Dell无法推断出即使它不支付CPA佣
金，用户仍然会进行购买。
在过去的4年里，我发现了上百个使用这些使俩的假冒CPA附属网络
[13]。欺骗者的数量最终超过了我手工记录这些事件的能力，因此我
在去年创建了一个自动化系统自动发现这类事件。我的软件在一组
感染了间谋软件的虚拟机上浏览Web，监测任何意料之外的CPA“点
击"事件，并在日志和屏幕捕捉视频中保存它的发现[4]。现在，我
常常能够每天找到几个新的欺骗者，并且我并不是唯一注意到这个
现象的人。例如，在一个针对ValueClick的集体诉讼中，商家们寻求
万美元，作为退回给商家的佣金以及由于攻击者改写网络佣金cookie
而遭受佣金损失的合法附属网络的补偿。
[1] Edelman,Benjamin."The Spyware-Click-Fraud Connection-and
Yahoo's Role Revisited."April 4,
2006.http://www.benedelman.org/news/040406-1.html。
[2] Daswani,Neil and Stoppelman,Michael."The Anatomy of
Clickbot.A."Proceedings of the First Workshop on Hot Topics in
Understanding Botnets.2007。
[3] Vidyasagar,N."India's Secret Army of Online Ad 'Clickers."The Times
of India.May 3， 2004。
[4] Google Form 10-Q,Q2 2008。
[5]Microsoft adCenterPublisher
Program (http://advertising.microsoft.com/publisher)。
[6]例如，参见"HowDoesGoogleDetectInvalid
Clicks?"https://adwords.google.com/support/bin/answer.py?answer=6114
&topic=10625。
[Z]例如，参见Tuzhilin,Alexander."The Lane's Gifts v.Google
Report."June 21, 2006.http://googleblog.blogspot.com/pdf/
2319
---
## Page 2321
Tuzhilin_Report.pdf.
[]例如，参见ClickDefense（http:/www.clickdefense.com）和Click
Forensics (http://www.clickforensics.com）。
[2]"How Fictitious Clicks Occur in Third-Party Click Fraud Audit
Reports."August 8,
2006.http://www.google.com/adwords/ReportonThird-
PartyClickFraudAuditing.pdf。
[10]例如，参见"pay affiliates only when a sale.....is completed" within
"LinkShare-Affiliate
Information."http://www.linkshare.com/affiliates/affiliates.shtml 。
[11]例如，参见Edelman,Benjamin."CPAAdvertisingFraud：Forced
Clicks and Invisible
Windows。"http://www.benedelman.org/news/100708-1.html.2008年10
月7日。
[12] eBay,Inc.v.Digital Point Solutions,No.5:08-cv-04052-
PVT (N.D.Cal.complaint filed Aug.25，2008）。
[13]参见Edelman,Benjamin."Auditing Spyware Advertising Fraud：
Wasted Spending at VistaPrint."http://www.benedelman.org/news/093008-
1.html.September 30，2008.另参见"Spyware StillCheatingMerchants
and Legitimate Affiliates."http://www.benedelman.org/news/052107-
1.html。2007年5月21日。另参见"HowAffiliate ProgramsFund
Spyware."2005年9月14日。http://www.benedelman.org/news/091405-
1.html 。
[14] Edelman,Benjamin."Introducing the Automatic Spyware Advertising
Tester."http://www.benedelman.org/news/052107-2.html.2007年5月21
。U.S.patent pending
[15]Settlement Recovery Center v. ValueClick.Cen.Dis.Calif.No.2: 07-
cV-02638-FMC-CTx。
6.2.3广告客户为何不奋起反击
根据几年来对在线广告的审核经验，我感觉许多广告客户并没有把
欺诈放在很重要的位置。当然也存在例外，许多小型或中小广告客
户无法承受欺诈所造成的损失。有些大公司对公平和道德的做法具
有普遍的承诺。也就是说，虽然大公司因为欺诈而产生了很大的损
失，但它们倾向于默默承受。
市场人士常常把广告欺诈看成是一种不可避免的商业成本。对我来
说，这显然是本末倒置。谁说欺诈应该得到回报，为什么要把它看
2320
---
## Page 2322
成是一种商业成本呢？通过提高对欺诈响应的有效性（寻找低成本
的方式确定并预防），商家可以把“不可避免的"损失转化为一条更