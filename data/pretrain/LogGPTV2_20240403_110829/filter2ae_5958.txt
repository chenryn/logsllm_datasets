**作者：dawu@知道创宇404实验室**  
**日期：2018/05/04**  
**英文版本：**
#### 0x00 前言
2018/04/30，`vpnMentor`公布了 `GPON`
路由器的高危漏洞：验证绕过漏洞(CVE-2018-10561)和命令注入漏洞(CVE-2018-10562)。将这两个漏洞结合，只需要发送一个请求，就可以在
`GPON路由器` 上执行任意命令。本文在复现该漏洞的基础上，分析了相关漏洞形成的原因。
#### 0x01 漏洞文件定位
在有回显的远程命令执行漏洞中，使用 `ps` 命令往往能够很好地定位到漏洞点。
可以很明显地看到，进程14650执行了我们的命令，找到上一个进程`14649 root /bin/WebMgr -p 20 -s 0`。因为 `pid`
是递增的，所以很可能是 `/bin/WebMgr` 这个文件存在漏洞。
#### 0x02 漏洞分析
在获取到某设备的 `/bin/WebMgr` 和 `/lib/` 文件后，我们开始分析。
##### 2.1 分析前
分析前研究了这个漏洞的利用，发现了该web服务器是 `GoAhead-webs`
根据 `Server`字段判断，该web服务器的版本 
  2. `Seebug漏洞平台` 收录该漏洞  
  3. `ZoomEye网络空间搜索引擎` 搜索结果  
* * *