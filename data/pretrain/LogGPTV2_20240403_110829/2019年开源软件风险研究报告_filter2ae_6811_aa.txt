# 2019年开源软件风险研究报告
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
## 一、序言
>
> 开源软件安全风险与知识产权风险已成为不可忽视的重要风险。开源软件作为关键信息基础设施供应链中的重要组成部分，其风险需要重点关注。为此，国家互联网应急中心与苏州棱镜七彩信息科技有限公司共同研究，发布2019年开源软件风险研究报告，本报告由CNCERT软件安全和苏州棱镜七彩信息科技有限公司联合发布。
开源软件已经渗透到信息技术领域的方方面面，无论是CPU、DSP等芯片，抑或驱动、固件等底层软件，抑或操作系统、浏览器、数据库等系统软件，抑或消息中间件、应用服务器等中间件软件，抑或各种各样的应用软件，都有开源软件的应用。我国信息技术领域各个行业也大量使用了开源软件。对于政府、军工、能源、金融等关键行业，也从以前的“谈开源软件色变”，到现在已经广泛接受和应用开源软件。开源软件已经成为当前软件供应链中十分重要的组成部分。
开源软件为IT行业带来了极大便利，提高了开发效率，降低了成本。然而，由于开源软件的依赖和引用关系较为复杂，其安全性也往往缺少审查和管理，因此，开源软件也增加了软件供应链的复杂性和安全风险。2019年，Github的报告指出，超过360万个开源项目依赖了Top50的开源项目之一。rails/rails、facebook/jest、axios/axios等知名项目被其他上百万个开源项目使用。同时，开源项目平均有180个第三方依赖组件，具体的依赖组件数量从几个到上千个不等。另一方面，
NVD、CNVD等漏洞库中的开源软件漏洞数量不断增加，还有大量开源软件漏洞未被收录到这些漏洞库中，例如，被广泛使用的fastjson组件，在2019年持续出现的严重漏洞中，多个漏洞尚未收录到国家漏洞库中。恶意软件包也不断出现在开源社区中，如pip包管理平台的roels、req-tools和dark-magic等恶意软件包、NPM包管理器的m-backdoor、rceat、path-to-regxep等恶意软件包等。
除了信息安全风险，开源软件还可能引入知识产权风险。由于开源软件的依赖关系的复杂性，在使用开源软件时，不同开源软件的许可证可能存在合规性和兼容性风险，从而导致知识产权风险。2019年11月6日，数字天堂（北京）网络技术有限公司诉柚子（北京）科技有限公司、柚子（北京）移动技术有限公司侵犯计算机软件著作权纠纷一案终审判决，判令柚子公司停止侵权并赔偿71万元。该案被称为中国第一个涉及GPL协议的诉讼案件。虽然该案在开源社区中有不同的讨论和解读，但进一步说明了开源软件的知识产权风险，是不可忽视的重要风险之一。
由此可见，开源软件复杂的供应链关系、不断增加的安全漏洞与恶意软件包，以及开源许可证的风险，已成为不可忽视、亟需重视和管控的领域。2020年4月27日，国家互联网信息办公室、国家发改委等12个部门联合发布了《网络安全审查办法》，《网络安全审查办法》中第一条明确指出：“为了确保关键信息基础设施供应链安全，维护国家安全，依据《中华人民共和国国家安全法》《中华人民共和国网络安全法》，制定本办法”。开源软件作为关键信息基础设施供应链中十分重要的组成部分，其安全性也需要重点关注。因此，为了更详细地进行分析，我们从Github、码云社区中选取了一批开源项目进行分析，就其依赖组件、安全漏洞、开源许可证等方面进行分析。
## 二、开源软件的安全风险分析
本报告一共选取了48363个项目进行分析，其中GitHub中选取星数为500星及以上的开源项目38530个，Gitee中选取星数为5星及以上的开源项目9833个。进一步，使用开源安全检测工具对48363个开源项目进行依赖检测，检测是否含有来自于Maven、Nuget、Packagist、PyPI、NPM、RubyGems六个包管理平台的依赖组件。在检测结果中，共有31553个开源项目包含上述六个平台的依赖组件，占总数的比例为65.24%。在含有依赖组件的开源项目中，来自于Github社区的项目数为25959个，占比82.27%；来自于Gitee社区的项目数为5594个，占比17.73%。本报告通过对31553个含依赖组件的开源项目（下称“样本项目”）进一步进行分析。
样本项目中一共包含701724个来自Maven、Nuget、Packagist、PyPI、NPM、RubyGems六个平台的依赖组件，其中Github的样本项目包含535326个依赖组件，占比76.29%，Gittee的样本项目包含166398个依赖组件，占比23.71%。通过对样本项目的依赖组件安全性进行分析，共获得依赖组件漏洞警告信息83834条。其中，总样本项目的20.79%存在依赖组件漏洞，按开源社区划分，18.03%的Github样本项目包含依赖组件漏洞，33.63%的Gitee样本项目包含依赖组件漏洞。基于以上数据，本报告从样本项目的依赖组件安全风险、漏洞等级分布、开源许可证等维度进行进一步分析。
###  （一）组件安全风险分析
####  （1）组件安全风险宏观分析
#####  1.1. 样本项目的组件漏洞数量①持续增长
组件漏洞数量及其增长态势是宏观上衡量开源安全风险的重要指标，根据以上数据分析可知，开源项目依赖组件漏洞数量逐年增长，近4年中2019年增长最快，
**2019年组件漏洞数量相较2018年环比增长72.99%。**
2019年，Github样本项目的依赖组件漏洞数量环比增长71.05%，Gitee样本项目的依赖组件漏洞数量环比增长74.18%。以上表明，组件漏洞数量一直处于较高增长态势，成为开源项目不可忽视的重要漏洞来源之一。  
（①注：本报告组件漏洞数量是指开源项目中依赖组件中的漏洞数量。年度组件漏洞数量指截止当年末为止的历史累计组件漏洞总量。漏洞知识库以CVE漏洞为主，也含有部分开源社区漏洞来源，如Github、NPM等。）
#####  1.2. 多数组件漏洞集中于少数包管理器平台
在本次分析的6个主流包管理器Maven、Nuget、Packagist、PyPI、NPM、RubyGems中， **Maven组件漏洞数量最多，**
占比73.54%，Maven组件漏洞数在近4年中每年均远多于其它包管理器，并在近两年中大幅增长，2019年环比增长达到76.53%。
**NPM位居第二，**
占比16.11%，但仍与Maven差值巨大。其它包管理器则一直维持在增长较为缓慢、漏洞数较少的水平。总体而言，大多数组件漏洞集中在少数包管理器平台。
#####  1.3. 直接依赖漏洞数量比间接依赖漏洞数量少约10%
**软件工程中所包含的开源组件按依赖层级分为直接依赖组件与间接依赖组件，软件工程所依赖的第一层级的开源组件被称为直接依赖组件，第一层级以及更深层级开源组件所依赖的开源组件被称为间接依赖组件，直接依赖组件漏洞和间接依赖组件漏洞都是不可忽视的安全风险。**
依据依赖组件漏洞数量的总体结果分析，直接依赖漏洞的数量为37865个，占比为45.17%，间接依赖的漏洞数量为45969个，占比为54.83%。直接依赖组件的漏洞数量比间接依赖组件的漏洞数量少约10%。同时，由于间接依赖关系需要对组件的依赖关系进行多层次分析，间接依赖组件漏洞相比直接依赖组件漏洞更具隐蔽性。
####  （2）样本项目组件漏洞危害性分析
#####  2.1. 超半数组件漏洞具有较高危害性
根据安全漏洞的危害程度不同，由美国国家基础设施咨询委员会NIAC（The National Infrastructure Advisory
Council）发布的通用漏洞评估方法CVSS（Common Vulerability Scoring
System）将安全漏洞分为超危、高危、中危、低危4个等级的漏洞。根据本报告统计结果， **组件漏洞多集中于中危及以上等级，占比94.38%；**