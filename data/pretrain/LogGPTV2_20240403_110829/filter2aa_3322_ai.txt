下需要借助SecureCRT或Putty等工具实现SSH访问操作。
图2-22 reGeorg模拟扫描
（5）Netsh
Netsh（Network Shell）是Windows系统自带的网络配置命令行脚
本工具，可用来通过修改本地或远程网络配置实现端口转发功能，支
持配置从IPv4或IPv6端口转发代理，或者IPv4与IPv6的双向端口转发
代理。
8. 网络抓包分析工具
网络抓包分析工具是拦截并查看网络数据包内容的软件工具，可
对通信过程中的网络数据的所有IP报文进行捕获并逐层拆包分析，从
中提取有用信息。借助网络抓包分析工具，蓝队可进行目标网络通联
分析、攻击工具通信分析和安全通信认证信息截获等操作。
（1）Wireshark
Wireshark是一款非常常用的网络抓包分析软件，提供抓取网络封
包、显示封包资料、检测网络通信数据、查看网络通信数据包中的详
细内容等非常实用的功能，更强大的功能有包含强显示过滤器语言和
查看TCP会话重构流的能力，支持上百种协议和媒体类型，实时检测通
信数据，检测其抓取的通信数据快照文件等（见图2-23）。
图2-23 Wireshark数据抓包示例
（2）Fiddler
Fiddler是一个非常好用的HTTP调试抓包工具，该数据抓包工具能
记录所有客户端与服务器的HTTP和HTTPS请求，允许用户监视，设置断
点，对通过网络传输发送与接收的数据包进行截获、重发、编辑、转
存等操作，用其检测与调试Web浏览器和服务器的交互情况（见图2-
24）。
图2-24 Fiddler网络数据调试
（3）tcpdump
tcpdump是Linux平台下一款非常知名、非常强大的网络抓包分析
工具，它可以将网络中传送的数据包完全截获下来提供分析。不仅支
持针对网络层、协议、主机、网络或端口的过滤，还支持功能强大和
灵活的截取策略，实现对网络数据的筛选和分组输出（见图2-25）。
图2-25 tcpdump抓包示例
9. 开源集成工具平台
（1）Linux集成环境（Kali）
Kali是基于Debian的Linux免费发行版，预装了许多渗透测试软
件，集成了包括Metasploit在内的超过300个渗透测试工具。
（2）Windows集成环境（Commando VM）
Commando VM是基于Windows的高度可定制的渗透测试虚拟机环
境，集成了超过140个开源Windows工具，包含一系列常用的工具，比
如Python和Go编程语言，Nmap和Wireshark网络扫描器，Burp Suite之
类的网络安全测试框架，以及Sysinternals、Mimikatz等Windows安全
工具。
（3）Cobalt Strike
Cobalt Strike是一款由美国Red Team开发的渗透测试神器，常被
业界人士称为CS。CS采用Metasploit为基础的渗透测试GUI框架，支持
多种协议上线方式，集成了Socket代理、端口转发、Office攻击、文
件捆绑、钓鱼、提权、凭证导出、服务扫描、自动化溢出、多模式端
口监听、exe和PowerShell木马生成等功能。
（4）Burp Suite
Burp Suite是用于攻击Web应用程序的集成平台，包含许多工具，
集成了Web访问代理、Web数据拦截与修改、网络爬虫、枚举探测、数
据编解码等一系列功能。Burp Suite为这些工具设计了许多接口，可
以加快攻击应用程序的部署与调用。
2.1.2 专业技能储备
专业技能是蓝队快速应对攻击任务中各种情况、解决各种困难问
题、顺利推进任务的保障。蓝队的专业技能储备涉及漏洞、工具、战
法策略等多方面，主要有以下4种。
1. 工具开发技能
“工欲善其事，必先利其器。”对于蓝队来说也一样，好的攻击
工具往往能起到事半功倍的效果。通过公开手段常常能搜集到好用的
开源工具，但公开特征太过明显，往往容易被防守方态势感知系统和
防火墙发现并拦截，从而极大地影响工作效率，因此需要借助自主开
发或开源工具改版来开展工作。熟练的工具开发技能，可以让蓝队通
过借鉴他人的高效思路，快速实现新的工具开发或对原有工具软件架
构和模块功能的针对性改进，为攻击工作提供有力的工具保障。
2. 漏洞挖掘技能
漏洞挖掘技能是利用动态或静态调试方法，通过白盒或黑盒代码
审计，对程序代码流程和数据流程进行深入分析与调试，分析各类应
用、系统所包含的编程语言、系统内部设计、设计模式、协议、框架
的缺陷，并利用此类缺陷执行一些额外的恶意代码实现攻击破坏的能
力。对于蓝队来说，漏洞是大杀器，往往能起到一招毙命的效果。前
期的漏洞准备对于外网打开突破口和内网横向拓展都非常重要，但公
开的漏洞往往由于时效问题作用有限，而自主挖掘的0day却总能作为
秘密武器出奇制胜，同时漏洞贡献能力是蓝队在实战攻防演练中的一
个重要的得分项。因此，蓝队需要有足够多的漏洞挖掘技能储备，尤
其是与蓝队攻击密切相关的互联网边界应用、网络设备、办公应用、
移动办公、运维系统、集权管控等方面的漏洞挖掘技能。
3. 代码调试技能
代码调试技能是对各类系统、应用、平台或工具的代码进行的分
析、解读、调试与审计等一系列技术能力。蓝队攻击中情况千变万
化，面对的系统、应用、平台或工具各式各样，很少能用一成不变的
模式应对所有情况，这就需要通过代码调试技能快速分析研判并寻找
解决方法。只有具备良好的代码调试能力，蓝队才能快速应对各种情
况，比如：针对攻击过程中获取的一些程序源码，需要运用代码调试
技能对其进行解读和代码审计，以快速发现程序bug并利用；漏洞挖掘
过程中，需要对某些未知程序和软件的逆向分析与白盒/黑盒代码审计
能力；注入攻击过程中，对于一些注入异常，需要对注入代码进行解
析和调试，通过代码变形转换实现规避；蓝队使用的渗透工具经常会
被杀毒软件拦截或查杀，这时需要运用代码调试技能快速定位查杀点
或特征行为，实现快速免杀应对；等等。
4. 侦破拓展技能
侦破拓展技能是在渗透攻击过程中对渗透工具使用、关键节点研
判、渗透技巧把握、战法策略运用等一系列技能的综合体现。实战攻
防演练存在时间短、任务紧的特点，因此对蓝队在侦破拓展技能方面
就有比较高的要求。侦破拓展技能是建立在蓝队丰富的实战经验积累
上的，是经验向效率转换的直接体现。蓝队良好侦破拓展技能主要表
现在三方面：一是对攻防一体理念的深刻理解，作为攻击者，可以从
防守者的角度思考问题，能快速定位防守弱点和突破口；二是对目标
网络和系统的正确认识，能根据不同攻击目标快速确定攻击策略和战
法，针对性开展攻击工作；三是对渗透工具的高效运用，能快速根据
攻击策略实现对各类工具的部署应用，能够快速将攻击思路转化为实
践，高效开展攻击工作。
2.1.3 人才队伍储备
蓝队不可能是一个人，而是一支由各类网络安全专长人才组成的
综合技能队伍。因为网络安全建设涵盖了软件应用、硬件部署、网络
架构和数据安全等多方面，所以开展网络攻击的人也必须具备包括代
码调试、逆向工程、系统攻击和数据分析在内的许多专业技术知识，
而一个人不可能同时专精于所有这些专业技术知识。蓝队攻击队伍需
要各类专长人才进行搭配组合，团队人员包括拥有情报搜集、渗透拓
展、工具开发、漏洞挖掘与免杀等各类特长的人员。人才队伍是各项
技能的载体，有了充足而全面的人才队伍储备，蓝队就可以从容应对
攻击任务中的各类情况，有效解决各类专业问题。各类专长人才的科
学组合是一支蓝队队伍高水平的体现（见图2-26）。
图2-26 综合团队是蓝队高效运转的基础
2.2 目标网情搜集
2.2.1 何为网情搜集
网情搜集是指围绕攻击目标系统的网络架构、IT资产、敏感信
息、组织管理与供应商等方面进行的情报搜集。网情搜集是为蓝队攻
击的具体实施做情报准备，是蓝队攻击工作的基础，目的在于帮助蓝
队在攻击过程中快速定位薄弱点和采取正确的攻击路径，并为后两个
阶段的工作提供针对性的建议，从而提高蓝队攻击工作效率和渗透成
功率。比如：掌握了目标企业的相关人员信息和组织架构，就可以快
速定位关键人物以便实施鱼叉攻击，或者确定内网横纵向渗透路径；
而收集了IT资产信息，就可以为漏洞发现和利用提供数据支撑；掌握
企业与供应商合作的相关信息，可为有针对性地开展供应链攻击提供
素材。而究竟是要社工钓鱼，还是直接利用漏洞攻击，抑或从供应链
下手，一般取决于安全防护的薄弱环节究竟在哪里，以及蓝队对攻击
路径的选择（见图2-27）。
图2-27 网情搜集工作
2.2.2 网情搜集的主要工作
网情搜集的内容主要包括目标系统的组织架构、IT资产、敏感信
息、供应商信息等方面：
·组织架构包括单位部门划分、人员信息、工作职能、下属单位
等；
·IT资产包括域名、IP、C段、开放端口、运行服务、Web中间
件、Web应用、移动应用、网络架构等；
·敏感信息包括代码信息、文档信息、邮箱信息、历史漏洞信息
等；
·供应商信息包括合同、系统、软件、硬件、代码、服务、人员
等的相关信息。
2.2.3 网情搜集的途径
1. 专业网站
（1）专业网络信息网站
通过专业网络信息网站搜集目标的IP范围、域名、互联网侧开放
服务端口、设备指纹与网络管理等相关信息。下面介绍几个比较典型
的网络信息查询网站。
1）Shodan（https://www.shodan.io）。Shodan是互联网上著名
的搜索引擎，百度百科里这样描述：“Shodan可以说是一款‘黑
暗’谷歌，一刻不停地在寻找着所有和互联网关联的服务器、摄像