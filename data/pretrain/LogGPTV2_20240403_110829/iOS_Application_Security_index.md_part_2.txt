frame selectcommand,66–67
kSecAttrAccessGroup,218–219
frame variablecommand,66
protectionattributes,212–214
image list,87
SecItemAdd,214–215,219
print objectcommand,67–68
SecItemCopyMatching,216
llvm,90
SecItemDelete,216
LocalAuthenticationAPI,231–232
SecItemUpdate,215
Logos,98
sharedKeychains,218–219
loopbackinterface,46–47
usage,214–217
Lua,12
wrappers,217–218
keyderivation,227–228
M
keylogging,175–177
killallcommand,79,101 M7processor,242
kSecAttrAccessGroup,218–219 MAC(mandatoryaccesscontrol),4–5
kSecAttrAccessible,220 MACaddress,234
kSecAttrSynchronizable,219 Mach-Obinaryformat,77,85
MachOView,88
L MacPorts,94
malloc,197–198
LAContext,231–232
mandatoryaccesscontrol(MAC),4–5
ldidcommand,97
MATCHESoperator,205
LDID(linkidentityeditor),97
MCEncryptionNone,126
legacyissues,fromC,189–198
MCEncryptionOptional,126
bufferoverflows,193–196
MCEncryptionRequired,126
example,194–195
MCSession,126
preventing,195–196
messagepassing,13–15
formatstringattacks,190–193
methodswizzling,23–25
NSString,192–193
MobileSafari,44
preventing,191–193
MobileTerminal,78
integeroverflow,196–198
multipeerconnectivity,125–127
example,197–198
certificateHandler,126
preventing,198
didReceiveCertificate,126
libc,8
encryption,125–127
Librarydirectory,35–37
ApplicationSupport directory,35
N
Cachesdirectory,35–36,187
Snapshotsdirectory,36 netcatcommand,78
Cookiesdirectory,36 networking,107–129
Preferencesdirectory,36 AFNetworking,122–124
SavedApplicationState directory,37 certificatepinning,123–124
LIKEoperator,205
254 INDEX iOS Application Security: The Definitive Guide for Hackers and Developers
© 2016 David Thiel
ASIHTTPRequest,122,124–125 NSURL,188
backgroundSessionConfiguration,117 NSURLCache,74–75,150
CFStream,48,107,128–129 NSURLConnection,48,108,117
ephemeralSessionConfiguration,117 NSURLConnectionDelegate,109,114
multipeerconnectivity,125–127 NSURLCredential,113,120
certificateHandler,126 NSURLCredentialStorage,110–111,121
didReceiveCertificate,126 NSURLIsExcludedFromBackupKey,35,
encryption,125–127 187–188
NSInputStream,49 NSURLProtectionSpace,109–111,122
NSOutputStream,49 NSURLProtocol,155
NSStream,48,107,127–128 NSURLRequest,108,148–149
NSURLSession,122 NSURLResponse,108
URLloadingsystem,107–122 NSURLSession,48,,117–122
HTTPbasicauthentication, NSURLSessionConfiguration,117–119
110–111,119–121 NSURLSessionDataTask,18
HTTPredirects,113–114 NSURLSessionTaskDelegate,119
NSURLConnection,48,108 NSUserDefaults,36,37,178
NSURLConnectionDelegate,109 NSUUID,234
NSURLCredential,120 NSXMLParser,205–206
NSURLCredentialStorage,110–111
NSURLRequest,108 O
NSURLResponse,108
Objective-C,13–25
NSURLSession,48,117
blocks
NSURLSessionConfiguration,
declaring,18
120–121
exposingtoJavaScript,150–151
NSURLSessionTaskDelegate,119
categories,22–23
sharedCredentialStorage,
codestructure,15–17
120–122
delightfulnessof,13
storedURLcredentials,121–122
garbagecollection,18
NotificationCenter,224–225
implementation,declaring,16–17
NSCoder,185–187
ivars,15–16
NSCoding,21–22
messagepassing,14–15
NSData,113
privatemethods,lackthereof,16
NSExtensionContext,143
propertysynthesis,17
NSExtensionItem,143
referencecounting,18–19
NSFileManager,221–223
odcctools,78,84
NSHTTPCookieStorage,237
OpenSSH,78
NSHTTPRequest,122
OpenSSL,94,228–229
NSInputStream,49
opensslcommand,138
NSLog,95,161–164,192
openURL,132–137
disabling,163
otool,53,78,84–86,
NSNotificationCenter,224–225
inspectingbinaries,90–92
NSOperation,122
outputencoding,200–202
NSOutputStream,49
NSPredicate,204–205
P
NSStream,48,107,127–128
NSString,192–193,195,202 p12file,113
NSURAuthenticationMethodClient- parameterizedSQL,203–204
Certificate,112 pasteboardDBfile,165–167
iOS Application Security: The Definitive Guide for Hackers and Developers INDEX 255
© 2016 David Thiel
pasteboards,164–169 privacypolicies,247–248
canPerformAction,168 proximitytracking,244–247
disablingcopy/paste,168–169 requestingpermission,243
pasteboardDBfile,165–167 uniquedeviceidentifier(UDID),
pasteboardWithUniqueName,165–167 233–235
UISearchBar,165 advertisingIdentifier,235
pasteboardWithUniqueName,165–167 identifierForVendor,234
PhoneGap,11,150 NSUUID,234
physicalattackers,161 uniqueIdentifier,234
PIE(position-independent privatemethods,16
executable),53–54 propertysynthesis,17
removing,87 protocols,20–22
plistfiles,29–31 declaring,21–22
converting,30–31 proximitytracking,244–247
XML,29–30 proxysetup,43–50
plutilcommand,30–31
popen,10 Q
position-independentexecutable
QuickLook,35,68
(PIE),53–54
QuickType,177
removing,87
predicateinjection,204–205
R
LIKEoperator,205
MATCHESoperator,205 referencecountingmodel,18–19
wildcards,204–205 retainandrelease,18–19
predicates,205 references,strongandweak,19
predicateWithFormat,204–205 release,18–19
Preferencesdirectory,36 remotedevicewipe,5,6
printfcommand,87,190–192 removeAllCachedResponses,75
print objectcommand,67–68 respringing,79,101
privacyconcerns,233–248 restorationIdentifier,184–185
advertisingTrackingEnabled,235 retain,18–19
bluetoothlowenergy(BTLE),244 return-to-libcattack,8
cookies,237–238 RNCryptor,186,230
DoNotTrack,236–237 rootViewController,183
geolocation,238–240 rsynccommand,78
accuracy,239
CLLocationManager,240 S
locationManager,244
safestringAPIs,195
risks,238–239
Sandbox,4–5
GPS,238
SavedApplicationState directory,37
HealthKit,240–241
Seatbelt,4–5
iBeacons,244–247
SecCertificateRef,112–113
CBPeripheralManager,246
SecIdentityRef,112–113
CLBeaconRegion,244–246
SecItemAdd,186,212,215,219
CLLocationManager,244
SecItemCopyMatching,216
startMonitoringForRegion,244
SecItemDelete,216
M7processor,242
SecItemUpdate,215
MACaddress,234
SecRandomCopyBytes,227
microphone,233
SecTrustRef,112–113
256 INDEX iOS Application Security: The Definitive Guide for Hackers and Developers
© 2016 David Thiel
SecureBoot,4 strcat,195
SecureNSCoder,186–187 strcpy,194,195
securityd,7 stringByEvaluatingJavaScriptFrom-
serialization,21 String,149–150
setAllowsAnyHTTPSCertificate,108 strlcat,195–196
setJavaScriptCanOpenWindows- strlcpy,195–196
Automatically,159 strongreferences,19
setJavaScriptEnabled,159–160 stunnel,46
setResourceValue,188 subclassing,23
setSecureTextEntry,175–177 synthesize,17
setShouldResolveExternal- syslog,162,190
Entities,206
Shared directory,37 T
sharedCredentialStorage,120–122
task_for_pid-allow,82
sharedHTTPCookieStorage,237
tcpdumpcommand,78
sharedKeychains,218–219
tcpprox,49–50
shouldAllowExtensionPoint-
TCPproxying,49–50
Identifier,143
testdevices,42
shouldmessages,20
textsegment,85–86
shouldSaveApplicationState,20
Theos,97–98
shouldStartLoadWithRequest,148
thinbinaries,85
sideloading,77–80
ThisDeviceOnly,212
signedinteger,196
TLS(TransportLayerSecurity),
signedness,51,196
108–119,127–129
Simulator,43–46
BEASTattack,118
camera,43
bypassingvalidation,44–47,119
case-sensitivity,43
certificatepinning,114–117,
installingcertificates,44
123–124
Keychain,43
CRIMEattack,118
PBKDF2,43
mutualauthentication,112–113
proxying,44–46
setAllowsAnyHTTPSCertificate,108
truststore,44
validation,categorybypasses,22
SpringBoard,79
tmpdirectory,37,80,187
SQLinjection,201,203–204
Todayscreen,131
parameterizedSQL,203–204
TOFU(trustonfirstuse),127
SQLite,203–204
TouchID,231–232
SSH,28,82
LAContext,231–232
SSL,see TLS(TransportLayer
TransportLayerSecurity,see TLS
Security)
(TransportLayerSecurity)
SSLConservatory,115–117
Tribbles,51
SSLKillswitch,96–97
trustonfirstuse(TOFU),127
stack,8,53–54,190,193
tweaks,CydiaSubstrate,97
startMonitoringForRegion,244
statepreservation,184–187
U
leaks,184–185
restorationIdentifier,184–185 UDID(uniquedeviceidentifier),
secure,185–187 233–235
staticanalysis,54 advertisingIdentifier,235
std::string,195 identifierForVendor,234
iOS Application Security: The Definitive Guide for Hackers and Developers INDEX 257
© 2016 David Thiel
UDID(uniquedeviceidentifier), userpreferences,178
continued UUID,27
NSUUID,234 uuidgen,244
uniqueIdentifier,234
UIActivity,139–140 V
UIAlertView,183
Valgrind,55
UILayers,182–183
vbindiffcommand,78,88
UIPasteBoard,144,164–169
vfork,10
UIPasteboardNameFind,165
.vimrc file,30
UIPasteboardNameGeneral,165
vmaddr,88
UIRequiredDeviceCapabilities,34
UIResponderStandardEditActions,169
W
UISearchBar,165,175
UITextField,175 wardriving,238
UITextView,175 warningpolicies,51
UIView,182–183 watchdog,58–59
UIWebView,200,201 watchmedocommand,58–59
UIWindow,182–183 weak_classdump,93
uniquedeviceidentifier(UDID), weakreferences,19
233–235 webapps,147–160
advertisingIdentifier,235 WebViews,9,147–160
identifierForVendor,234 Cordova,154–157
NSUUID,234 risks,156
uniqueIdentifier,234 XmlHttpRequest,155
uniqueIdentifier,234 JavaScript,149
universallinks,137–138 executinginCordova,154–157
unsignedinteger,196 executinginUIWebView,149–150
URLloadingsystem,107 stringByEvaluatingJavaScriptFrom-
credentialpersistencetypes,111 String,149–150
HTTPbasicauthentication,110–111 JavaScript–Cocoabridging,150–157
HTTPredirects,113–114 JavaScriptCore,149–154
NSURLConnection,108 blocks,150–151
NSURLConnectionDelegate,109 JSContext,152–154
NSURLCredential,120 JSExport,151–152
NSURLCredentialStorage,110–111 just-in-time(JIT)compiler,149
NSURLRequest,108 Nitro,148,149
NSURLResponse,108 NSURLRequest,148–149
NSURLSession,117–122 UIWebView,147–150
NSURLSessionConfiguration,117–119 WebKit,11,147–148
NSURLSessionTaskDelegate,119 WKWebView,see WKWebView
sharedCredentialStorage,120–122 whitelisting,149,152,200–201
storedURLcredentials,121–122 willmessages,20
URLschemes,132–133 willSendRequestForAuthentication-
CFBundleURLSchemes,133 Challenge,112
defining,132–133 Wireshark,46
hijacking,136–137 WKPreferences,160
validatingURLsandsenders,134 WKWebView,148158–160
USB,TCPproxying,84 addUserScript,159
usbmuxdcommand,84 benefitsof,159–160
258 INDEX iOS Application Security: The Definitive Guide for Hackers and Developers
© 2016 David Thiel
didFinishNavigation,159–160
hasOnlySecureContent,159–160
setJavaScriptCanOpenWindows-
Automatically,159
setJavaScriptEnabled,159–160
WKPreferences,160
WKUserScript,159
WKWebViewConfiguration,160
X
xcodebuild,190
Xcodesetup,50–53,55
warnings,51–53
Xcon,10
XMLinjection,207
NSXMLParser,205–206
XMLexternalentities,205–206
XPath,207
XN(eXecuteNever),8–9
XPath,207
XSS(cross-sitescripting),199–200
inputsanitization,200–201
outputencoding,201–202
xxdcommand,88
iOS Application Security: The Definitive Guide for Hackers and Developers INDEX 259
© 2016 David Thiel