JUST WHAT THE DOCTOR ORDERED? 
SCOTT ERVEN 
Founder/President – SecMedic 
@scotterven 
SHAWN MERDINGER 
Healthcare Security Researcher 
Founder – MedSec LinkedIn Group 
@medseclinkedin 
1 
Why Research Medical Devices?  
• Patient Safety & Quality Patient Care 
• To Equip Defenders In Assessing & 
Protecting These Life Saving Devices 
• Directly Contributes To & Affects Healthcare 
Organizations’  Mission  and  Values 
2 
Disclosure Process Overview  
• April 30th – SMB Findings Disclosed To 
DHS/ICS-CERT 
• May 5th – SMB Detailed Briefing With 
DHS/ICS-CERT  
• May 20th – Additional Disclosure To 
DHS/ICS-CERT for Defibs, Healthcare Orgs 
• Ongoing Assistance Provided To Federal 
Agencies, Healthcare Organizations and 
Manufacturers 
3 
What Will Be Revealed?  
• No Zero Days 
• Most Vulnerabilities Not From This Decade 
• Threat Modeling – Connecting The Dots 
• Medical Device Exposure From Public 
Internet 
4 
Bad News 
• The external findings pose a significant risk to 
patient safety and medical devices 
• We located most of these external risks within 
1 hour utilizing only previously disclosed 
vulnerabilities and open source 
reconnaissance 
• These findings provide support that 
Healthcare is 10 years behind other 
industries in addressing security 
5 
Good News 
• These significant external risks can be 
mitigated easily 
• The external risks can be identified by an 
organization within 1 hour using open source 
reconnaissance tools 
• The external findings can be remediated with 
little to no investment from an organization 
6 
Review of  Previous Research 
• Lab Systems 
• Refrigeration Storage 
• PACS – Imaging 
• MRI/CT  
• Implantable Cardiac Defibrillators 
• External Cardiac Defibrillators 
• Infusion Pumps 
• Medical Device Integration 
7 
Review of Previous Research - Top Risks 
• Hard-Coded Privileged Accounts 
• Unencrypted Web Applications & Web 
Services/Interfaces 
• Excessive Services With No Operational Use 
Case 
• System Updates & Patching 
8 
Phase II Research – Why Do More? 
• Many have been misinformed that medical 
devices can not be accessed by an attacker 
from the Internet. 
– “The  biggest  vulnerability  was  the  perception  of  IT  health  
care  professionals’  beliefs  that  their  current  perimeter  
defenses and compliance strategies were working when 
clearly  the  data  states  otherwise.”  – FBI Advisory April 8th, 
2014 PIN#140408-009  
• Physicians and public are unaware or have 
been misinformed about the risks associated 
with these life saving devices.  
9 
Phase II Research – Why Do More? 
• “I  have  never  seen  an  industry  with  more  
gaping holes.  If our financial industry 
regarded security the way the health-care 
sector does, I would stuff my cash in a 
mattress  under  my  bed.” 
–
Avi Rubin, John Hopkins University 2012/12/25 
10 
Shodan Search & Initial Finding 
• Doing a search for anesthesia in Shodan and 
realized it was not an anesthesia workstation. 
• Realized it was a public facing system with 
SMB open, and it was leaking intelligence 
about  the  healthcare  organization’s  entire  
network including medical devices. 
11 
Initial Healthcare Organization Discovery 
• Very large US healthcare system consisting 
of over 12,000 employees and over 3,000 
physicians. Including large cardiovascular 
and neuroscience institutions.  
• Exposed intelligence on over 68,000 systems 
and provided direct attack vector to the 
systems.  
• Exposed numerous connected third-party 
organizations and healthcare systems.  
12 
So Did We Only Find One?   
• Of Course Not. We Found Hundreds!! 
• Change the search term and many more 
come up.  Potentially thousands if you include 
exposed third-party healthcare systems. 
13 
Heat Map – Health* 
14 
Heat Map - Clinic 
15 
Heat Map - Hospital 
16 
Heat Map - Medical 
17 
So Who Cares About SMB Right? 
• Well it also happened to be a Windows XP 
system vulnerable to MS08-067 in many 
instances!!  CVE-2008-4250 
18 
Why Does This Matter?  
• It’s  A  Goldmine  For  Adversaries  &  Attackers!! 
• It leaks specific information to identify medical 
devices and their supporting technology 
systems and applications. 
• It leaks system hostnames on connected 
devices in the network. 
• It often times leaks floor, office, physician 
name and also system timeout exemptions. 19 
Let Me Paint The Picture.   
Impact:  
System May Not Require Login 
Impact: 
Electronic Medical Record Systems 20 
Getting a little warmer!! 
Impact: PACS Imaging Systems, MRI/CT Systems 
Impact: Infant Abduction Systems  
21 
This Is Not Good.  
Impact: 
Pacemaker Controller Systems 
Pediatric Nuclear Medicine 
Anesthesia Systems 
22 
OK You Found A Few Devices Right? 
• Wrong!! 
• We dumped the raw data on the organization 
and extracted the following information on 
medical devices and their supporting 
systems. 
• We identified thousands of medical devices 
and their supporting systems inside this 
organization. 
23 
Summary Of Devices Inside Organization 
• Anesthesia Systems – 21 
• Cardiology Systems – 488 
• Infusion Systems – 133 
• MRI – 97 
• PACS Systems – 323 
• Nuclear Medicine Systems – 67 
• Pacemaker Systems - 31 
24 
Potential Attacks – Physical Attack 
• We know what type of systems and medical 
devices are inside the organization. 
• We know the healthcare organization and 
location. 
• We know the floor and office number 
• We know if it has a lockout exemption 
25 
Potential Attacks – Phishing Attack 
• We know what type of systems and medical 
devices are inside the organization. 
• We know the healthcare organization and 
employee names. 
• We know the hostname of all these devices. 
• We can create a custom payload to only 
target medical devices and systems with 
known vulnerabilities.  
26 
Potential Attacks – Pivot Attack 
• We know the direct public Internet facing 
system is vulnerable to MS08-067 and is 
Windows XP. 
• We know it is touching the backend networks 
because it is leaking all the systems it is 
connected to. 
• We can create a custom payload to pivot to 
only targeted medical devices and systems 
with known vulnerabilities.  
27 
Potential Attacks – Targeted Attack 
• We can use any of the previous three attack 
vectors. 
• We now know their Electronic Medical Record 
system and server names to attack and gain 
unauthorized access.  This can tell an 
attacker where a patient will be and when. 
• We can launch a targeted attack at a specific 
location since we know specific rooms these 
devices are located in. 
28 
Disclosure Overview & Results – Big Win! 
• DHS/ICS-CERT Coordinated Disclosure 
• DHS/ICS-CERT Coordinated Follow-Up Call 
With Affected Organization 
• Affected Organization Shared Incident 
Response Documentation 
• First Time DHS/ICS-CERT Had Coordinated 
Security Researchers & Healthcare 
Organization 
29 
Are Medical Devices On Public Internet? 
• Yes They Are 
• In Many Cases It Is By Design 
• In Many Cases They Utilize Public Cellular 
Carrier Networks 
30 
So Did We Find Anything Public Facing? 
• Defibrillators 
• Fetal/Infant Monitoring Systems 
• EEG Systems 
• PACS/Imaging Systems 
31 
What Else Was Accessible? 
• Healthcare Systems 
– Unauthenticated Edge Routers 
• Device Manufacturer Infrastructure 
• Third-Party Contracted Organizations 
32 
Case Study – Glucose Meters 
• 1st Reported Medical Device On Public IP 
– Late 2012 
• Roche Glucose Meter 
– Basestation Has Telnet Open 
• Excellent Vendor Response 
• Excellent DHS/ICS-CERT  
    Response 
33 
Case Study – Kodak PACS Systems 
• Hundreds Sitting On Public IP 
• Issues 
– Client Connectivity Requires Old Browser 
– Internet Explorer 6.0 
• Dedicated Client Box Only For This? 
34 
Case Study – Fetal Monitors 
• May 18th – Fetal Monitor Findings Disclosed 
To DHS/ICS-CERT, Manufacturer, FDA, 
OCR, Joint Commission 
• Previous Disclosure 
– Dec. 2012 - Fetal monitor findings reported to 
DHS ICS-CERT 
– Media Coverage 
• 3/25/2013 
– http://www.wired.com/2013/03/our-health-information/ 
• 9/5/2013 
– http://www.forbes.com/sites/kashmirhill/2013/09/05/the-
crazy-things-a-savvy-shodan-searcher-can-find-exposed-
on-the-internet/ 
35 
Case Study – 28 Fetal Monitors 
• Shodan Map Of Fetal Monitors On Public IP 
36 
Case Study – Fetal Monitors 
• System Details 
– Windows 2003 Server 
• IIS 6.0 (16 Systems) – Behind On Vendor Updates 
– Windows 2008 Server 
• IIS 7.0 (12 Systems) 
• Remote Access For Physicians/Support 
– Remote Desktop Web Access Through Browser 
– Terminal Services Clients 
• HIPAA Compliant RDP Crypto Access? 
37 
Case Study – Fetal Monitors 
• FDA MAUDE Reports 
– Several Cases Of Fetal Alarm Capability Disabled 
• Is There Correlation To Exposed Devices? 
– Impossible To Tell From MAUDE Alone 
• User Submitted Reports 
• Sanitized Data 
• Attachments Removed 
• BTW - MAUDE Reports And Search Interface 
Are  “Teh Suck” 
38 
Case Study – Fetal Monitors 
• So Where Are We Today? 
– I Previously Disclosed This To DHS In Fall 2012 
– Many Still On Public IP 
– Several Still Running IIS 6.0 
• Vendor Did Reach Out 
– Conference Call, Interest In Customer Misuse 
Cases, Security Researcher Communication 
• Lessons Learned 
– Need Better Reporting Method 
– Need Follow-Up Action 
– Need Authority For Location Identification  
39 
Adversary Misconceptions 
• Adversaries Only Care About Financial Gain 
– OK Maybe The Russians Do!! 
• Adversaries  Live  In  Caves  &  Can’t  Figure  It  Out 
– I Swear Some Ignorant Individual Actually Emailed Me This. 
• Adversaries Are Not Technically Adept To Carry Out 