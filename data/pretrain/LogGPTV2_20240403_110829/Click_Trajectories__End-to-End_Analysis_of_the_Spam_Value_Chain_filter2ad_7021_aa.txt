title:Click Trajectories: End-to-End Analysis of the Spam Value Chain
author:Kirill Levchenko and
Andreas Pitsillidis and
Neha Chachra and
Brandon Enright and
M&apos;ark F&apos;elegyh&apos;azi and
Chris Grier and
Tristan Halvorson and
Chris Kanich and
Christian Kreibich and
He Liu and
Damon McCoy and
Nicholas Weaver and
Vern Paxson and
Geoffrey M. Voelker and
Stefan Savage
2011 IEEE Symposium on Security and Privacy
Click Trajectories: End-to-End Analysis of the Spam Value Chain
∗
Kirill Levchenko
∗
Andreas Pitsillidis
∗
Tristan Halvorson
∗
Chris Kanich
†(cid:3)
Nicholas Weaver
Vern Paxson
Neha Chachra
Brandon Enright
Christian Kreibich
†(cid:3)
∗
Geoffrey M. Voelker
He Liu
∗
‡
M´ark F´elegyh´azi
∗
∗
Damon McCoy
∗
Stefan Savage
†
Chris Grier
∗
†(cid:3)
†
∗
(cid:3)
Department of Computer Science and Engineering
University of California, San Diego
Computer Science Division
University of California, Berkeley
‡
International Computer Science Institute
Berkeley, CA
Laboratory of Cryptography and System Security (CrySyS)
Budapest University of Technology and Economics
Abstract—Spam-based advertising is a business. While it
has engendered both widespread antipathy and a multi-billion
dollar anti-spam industry, it continues to exist because it fuels a
proﬁtable enterprise. We lack, however, a solid understanding
of this enterprise’s full structure, and thus most anti-spam
interventions focus on only one facet of the overall spam value
chain (e.g., spam ﬁltering, URL blacklisting, site takedown).
In this paper we present a holistic analysis that quantiﬁes
the full set of resources employed to monetize spam email—
including naming, hosting, payment and fulﬁllment—using
extensive measurements of three months of diverse spam data,
broad crawling of naming and hosting infrastructures, and
over 100 purchases from spam-advertised sites. We relate these
resources to the organizations who administer them and then
use this data to characterize the relative prospects for defensive
interventions at each link in the spam value chain. In particular,
we provide the ﬁrst strong evidence of payment bottlenecks in
the spam value chain; 95% of spam-advertised pharmaceutical,
replica and software products are monetized using merchant
services from just a handful of banks.
I. INTRODUCTION
We may think of email spam as a scourge—jamming
our collective inboxes with tens of billions of unwanted
messages each day—but to its perpetrators it is a potent
marketing channel that taps latent demand for a variety of
products and services. While most attention focuses on the
problem of spam delivery, the email vector itself comprises
only the visible portion of a large, multi-faceted business
enterprise. Each click on a spam-advertised link is in fact just
the start of a long and complex trajectory, spanning a range
of both technical and business components that together
provide the necessary infrastructure needed to monetize a
customer’s visit. Botnet services must be secured, domains
registered, name servers provisioned, and hosting or proxy
services acquired. All of these,
in addition to payment
processing, merchant bank accounts, customer service, and
fulﬁllment, reﬂect necessary elements in the spam value
chain.
While elements of this chain have received study in
isolation (e.g., dynamics of botnets [20], DNS fast-ﬂux
networks [17], [42], Web site hosting [1], [22]), the re-
lationship between them is far less well understood. Yet
1081-6011/11 $26.00 © 2011 IEEE
DOI 10.1109/SP.2011.24
431
it
is these very relationships that capture the structural
dependencies—and hence the potential weaknesses—within
the spam ecosystem’s business processes. Indeed, each
distinct path through this chain—registrar, name server,
hosting, afﬁliate program, payment processing, fulﬁllment—
directly reﬂects an “entrepreneurial activity” by which the
perpetrators muster capital investments and business rela-
tionships to create value. Today we lack insight into even
the most basic characteristics of this activity. How many
organizations are complicit in the spam ecosystem? Which
points in their value chains do they share and which operate
independently? How “wide” is the bottleneck at each stage
of the value chain—do miscreants ﬁnd alternatives plentiful
and cheap, or scarce, requiring careful husbanding?
to address
The desire
these kinds of questions
empirically—and thus guide decisions about the most effec-
tive mechanisms for addressing the spam problem—forms
the core motivation of our work. In this paper we develop
a methodology for characterizing the end-to-end resource
dependencies (“trajectories”) behind individual spam cam-
paigns and then analyze the relationships among them. We
use three months of real-time source data, including captive
botnets, raw spam feeds, and feeds of spam-advertised URLs
to drive active probing of spam infrastructure elements
(name servers, redirectors, hosting proxies). From these,
we in turn identify those sites advertising three popular
classes of goods—pharmaceuticals, replica luxury goods
and counterfeit software—as well as their membership in
speciﬁc afﬁliate programs around which the overall business
is structured. Finally, for a subset of these sites we perform
on-line purchases, providing additional data about merchant
bank afﬁliation, customer service, and fulﬁllment. Using this
data we characterize the resource footprint at each step in
the spam value chain, the extent of sharing between spam
organizations and, most importantly, the relative prospects
for interrupting spam monetization at different stages of the
process.
The remainder of this paper is organized as follows.
Section II provides a qualitative overview of the spam
ecosystem coupled with a review of
related research.
Section III describes the data sources, measurement tech-
niques and post-processing methodology used in our study.
Section IV describes our analysis of spam activities between
August and October of 2010, and the implications of these
ﬁndings on the likely efﬁcacy of different anti-spam inter-
ventions, followed by our conclusions in Section V.
II. BACKGROUND AND RELATED WORK
As an advertising medium, spam ultimately shares the
underlying business model of all advertising. So long as the
revenue driven by spam campaigns exceeds their cost, spam
remains a proﬁtable enterprise. This glib description belies
the complexity of the modern spam business. While a decade
ago spammers might have handled virtually all aspects of the
business including email distribution, site design, hosting,
payment processing, fulﬁllment, and customer service [33],
today’s spam business involves a range of players and
service providers. In this section, we review the broad
elements in the spam value chain, the ways in which these
components have adapted to adversarial pressure from the
anti-spam community, and the prior research on applied e-
crime economics that informs our study.
A. How Modern Spam Works
While the user experience of spam revolves principally
around the email received, these constitute just one part of a
larger value chain that we classify into three distinct stages:
advertising, click support, and realization. Our discussion
here reﬂects the modern understanding of the degree to
which specialization and afﬁliate programs dominate the
use of spam to sell products. To this end, we draw upon
and expand the narrative of the “Behind Online Pharma”
project [4], which documents the experience of a group of
investigative journalists in exploring the market structure
for online illegal pharmaceuticals; and Samosseiko’s recent
overview [46] of afﬁliate programs, including many that we
discuss in this paper.
Advertising. Advertising constitutes all activities focused
on reaching potential customers and enticing them into click-
ing on a particular URL. In this paper we focus on the email
spam vector, but the same business model occurs for a range
of advertising vectors, including blog spam [39], Twitter
spam [12], search engine optimization [53], and sponsored
advertising [26], [27]. The delivery of email spam has
evolved considerably over the years, largely in response to
increasingly complex defensive countermeasures. In particu-
lar, large-scale efforts to shut down open SMTP proxies and
the introduction of well-distributed IP blacklisting of spam
senders have pushed spammers to using more sophisticated
delivery vehicles. These include botnets [13], [20], [56],
Webmail spam [9], and IP preﬁx hijacking [45]. Moreover,
the market for spam services has stratiﬁed over time; for
example, today it is common for botnet operators to rent
their services to spammers on a contract basis [40].
432
The advertising side of the spam ecosystem has by far
seen the most study, no doubt because it reﬂects the part
of spam that users directly experience. Thus, a broad and
ongoing literature examines ﬁltering spam email based on a
variety of content features (e.g., [2], [19], [43], [57]). Simi-
larly, the network characteristics of spam senders have seen
extensive study for characterizing botnet membership [58],
identifying preﬁx hijacking [45], classifying domains and
URLs [14], [32], [44], [55], [56], and evaluating black-
lists [47], [48]. Finally, we note that most commercial anti-
spam offerings focus exclusively on the delivery aspect of
spam. In spite of this attention, spam continues to be de-
livered and thus our paper focuses strictly on the remaining
two stages of the spam monetization pipeline.
Click support. Having delivered their advertisement, a
spammer depends on some fraction of the recipients to
respond, usually by clicking on an embedded URL and
thus directing their browser to a Web site of interest. While
this process seems simple,
in practice a spammer must
orchestrate a great many moving parts and maintain them
against pressure from defenders.
Redirection sites. Some spammers directly advertise a
URL such that, once the recipient’s browser resolves the
domain and fetches the content from it, these steps con-
stitute the fullness of the promoted Web site. However, a
variety of defensive measures—including URL and domain
blacklisting, as well as site takedowns by ISPs and do-
main takedowns by registrars—have spurred more elaborate
steps. Thus, many spammers advertise URLs that, when
visited, redirect to additional URLs [1], [22]. Redirection
strategies primarily fall into two categories: those for which
a legitimate third party inadvertently controls the DNS
name resource for the redirection site (e.g., free hosting,
URL shorteners, or compromised Web sites), and those for
which the spammers themselves, or perhaps parties working
on their behalf, manage the DNS name resources (e.g., a
“throwaway” domain such as minesweet.ru redirecting to
a more persistent domain such as greatjoywatches.com).
Domains. At some point, a click trajectory will usually
require domain name resources managed by the spammer
or their accomplices. These names necessarily come via the
services of a domain registrar, who arranges for the root-
level registry of the associated top-level domain (TLD) to
hold NS records for the associated registered domain. A
spammer may purchase domains directly from a registrar,
but will frequently purchase instead from a domain reseller,
from a “domaineer” who purchases domains in bulk via
multiple sources and sells to the underground trade, or
directly from a spam “afﬁliate program” that makes domains
available to their afﬁliates as part of their “startup package.”
Interventions at this layer of the spam value chain depend
signiﬁcantly on the responsiveness of individual registrars
and the pressure brought to bear [29]. For example, a recent
industry study by LegitScript and KnujOn documents heavy
concentration of spam-advertised pharmacies with domains
registered through a particular set of registrars who appear
indifferent to complaints [28].
Name servers. Any registered domain must in turn have
supporting name server infrastructure. Thus spammers must
provision this infrastructure either by hosting DNS name
servers themselves, or by contracting with a third party.
Since such resources are vulnerable to takedown requests, a
thriving market has arisen in so-called “bulletproof” hosting
services that resist such requests in exchange for a payment
premium [23].
Web servers. The address records provided by the spam-
mer’s name servers must in turn specify servers that host
(or more commonly proxy) Web site content. As with name
servers, spam-advertised Web servers can make use of bul-
letproof hosting to resist takedown pressure [3], [51]. Some
recent
interventions have focused on effectively shutting
down such sites by pressuring their upstream Internet service
providers to deny them transit connectivity [6].
To further complicate such takedowns and to stymie
blacklisting approaches, many spammers further obfuscate
the hosting relationship (both for name servers and Web
servers) using fast-ﬂux DNS [17], [41], [42]. In this ap-
proach, domain records have short-lived associations with
IP addresses, and the mapping infrastructure can spread
the domain’s presence over a large number of machines
(frequently many thousands of compromised hosts that in
turn proxy requests back to the actual content server [5]).
Furthermore, recently innovators have begun packaging this
capability to offer it to third parties on a contract basis as a
highly resilient content-hosting service [7].
Stores and Afﬁliate Programs. Today, spammers operate
primarily as advertisers, rarely handling the back end of the
value chain. Such spammers often work as afﬁliates of an
online store, earning a commission (typically 30–50%) on
the sales they bring in [46]. The afﬁliate program typically
provides the storefront templates, shopping cart manage-
ment, analytics support, and even advertising materials. In
addition, the program provides a centralized Web service
interface for afﬁliates to track visitor conversions and to
register for payouts (via online ﬁnancial instruments such as
WebMoney). Finally, afﬁliate programs take responsibility
for contracting for payment and fulﬁllment services with
outside parties. Afﬁliate programs have proven difﬁcult to
combat directly—although, when armed with sufﬁcient legal
jurisdiction, law enforcement has successfully shut down
some programs [8].
Realization. Finally, having brought
the customer to
an advertised site and convinced them to purchase some
product, the seller realizes the latent value by acquiring
the customer’s payment through conventional payment net-
works, and in turn fulﬁlling their product request.
Payment services. To extract value from the broadest
possible customer base, stores try to support standard credit
card payments. A credit card transaction involves several
parties in addition to the customer and merchant: money is
transferred from the issuing bank (the customer’s bank) to
the acquiring bank (the bank of the merchant) via a card
association network (i.e., Visa or MasterCard). In addition
to the acquiring bank, issuing bank, and card association,
the merchant frequently employs the services of a payment
processor to facilitate this process and act as the technical
interface between the merchant and the payment system.
Card associations impose contractual restrictions on their
member banks and processors, including the threat of ﬁnes
and de-association; but to our knowledge little public docu-
mentation exists about the extent to which the associations
apply this pressure in practice nor the extent to which it
plays an important role in moderating the spam business.
Evidence from this study suggests that any such pressure is
currently insufﬁcient to stop this activity.
Fulﬁllment. Finally, a store arranges to fulﬁll an order1
in return for the customer’s payment. For physical goods
such as pharmaceuticals and replica products, this involves
acquiring the items and shipping them to the customer.
Global business-to-business Web sites such as Alibaba, EC-
Plaza, and ECTrade offer connections with a broad variety of
vendors selling a range of such goods, including prepack-
aged drugs—both brand (e.g., Viagra) and off-brand (e.g.,
sildenaﬁl citrate capsules)—and replica luxury goods (e.g.,
Rolex watches or Gucci handbags). Generally, suppliers will
offer direct shipping service (“drop shipping”), so afﬁliate
programs can structure themselves around “just in time”
fulﬁllment and avoid the overhead and risk of warehousing
and shipping the product themselves.2 Fulﬁllment for virtual
goods such as software, music, and videos can proceed
directly via Internet download.
B. Pharmacy Express: An Example
Figure 1 illustrates the spam value chain via a concrete
example from the empirical data used in this study.
On October 27th, the Grum botnet delivered an email
titled VIAGRA R(cid:4) Ofﬁcial Site (). The body of the mes-
sage includes an image of male enhancement pharma-
ceutical tablets and their associated prices (shown). The
image provides a URL tag and thus when clicked ()
directs the user’s browser to resolve the associated domain
name, medicshopnerx.ru. This domain was registered by
REGRU-REG-RIPN (a.k.a. reg.ru) on October 18th ()—
it is still active as of this writing. The machine providing
name service resides in China, while hosting resolves to a
1In principle, a store could fail to fulﬁll a customer’s order upon receiving
their payment, but this would both curtail any repeat orders and would
lead to chargebacks through the payment card network, jeopardizing their
relationship with payment service providers.
2Individual suppliers can differ in product availability, product quality,
the ability to manage the customs process, and deliver goods on a timely
basis. Consequently, afﬁliate programs may use different suppliers for
different products and destinations.
433
Figure 1:
Infrastructure involved in a single URL’s value chain, including advertisement, click support and realization steps.
machine in Brazil (). The user’s browser initiates an HTTP
request to the machine (), and receives content that renders