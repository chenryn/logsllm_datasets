What you’ll learn
• What are the origins of this exploit.
• What are the differences between “executable” 
and “Static” images?
• How to create images with PHP & GD
• How to fool servers into executing images 
(instead of serving them to browsers)
• How to do cool things with images on Web 2.0 
websites 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What you’ll learn
• What are the origins of this exploit.
• What are the differences between “executable” 
and “Static” images?
• How to create images with PHP & GD
• How to fool servers into executing images 
(instead of serving them to browsers)
• How to do cool things with images on Web 2.0 
websites 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What you’ll learn
• What are the origins of this exploit.
• What are the differences between “executable” 
and “Static” images?
• How to create images with PHP & GD
• How to fool servers into executing images 
(instead of serving them to browsers)
• How to do cool things with images on Web 2.0 
websites 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What you’ll learn
• What are the origins of this exploit.
• What are the differences between “executable” 
and “Static” images?
• How to create images with PHP & GD
• How to fool servers into executing images 
(instead of serving them to browsers)
• How to do cool things with images on Web 2.0 
websites 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What you’ll learn
• What are the origins of this exploit.
• What are the differences between “executable” 
and “Static” images?
• How to create images with PHP & GD
• How to fool servers into executing images 
(instead of serving them to browsers)
• How to do cool things with images on Web 2.0 
websites 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What you won't learn
• This is not the GDI exploit
• This exploit works on images downloaded 
from servers
• This is not a client-side exploit.
• That's not entirely true... 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What you won't learn
• This is not the GDI exploit
• This exploit works on images downloaded 
from servers
• This is not a client-side exploit.
• That's not entirely true... 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What you won't learn
• This is not the GDI exploit
• This exploit works on images downloaded 
from servers
• This is not a client-side exploit.
• That's not entirely true... 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What you won't learn
• This is not the GDI exploit
• This exploit works on images downloaded 
from servers
• This is not a client-side exploit.
• That's not entirely true... 
javascript image
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Goals
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
–To learn how program “executable images”
–To learn where they can be applied
–To get you started on your own applications
–This is not a “code-heavy” presentation!
Goals
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
–To learn how program “executable images”
–To learn where they can be applied
–To get you started on your own applications
–This is not a “code-heavy” presentation!
Goals
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
–To learn how program “executable images”
–To learn where they can be applied
–To get you started on your own applications
–This is not a “code-heavy” presentation!
Goals
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
–To learn how program “executable images”
–To learn where they can be applied
–To get you started on your own applications
–This is not a “code-heavy” presentation!
Who’s Schrenk?
• Long-time webbot writer
• 8th DEFCON, 3rd time speaker
• Minneapolis & Madras (Chennai)
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Who’s Schrenk?
• Long-time webbot writer
• 8th DEFCON, 3rd time speaker
• Minneapolis & Madras (Chennai)
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Who’s Schrenk?
• Long-time webbot writer
• 8th DEFCON, 3rd time speaker
• Minneapolis & Madras (Chennai)
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
Who’s Schrenk?
• Long-time webbot writer
• 8th DEFCON, 3rd time speaker
• Minneapolis & Madras (Chennai)
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Who’s Schrenk?
• Long-time webbot writer
• 8th DEFCON, 3rd time speaker
• Minneapolis & Madras (Chennai)
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Who’s Schrenk?
• Long-time webbot writer
• 8th DEFCON, 3rd time speaker
• Minneapolis & Madras (Chennai)
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Exploit Origins
• To create a really good 
MySpace tracker.
• Wanted to add image to 
“friends” pages that looks 
like this: 
• Got frustrated because 
MySpace doesn’t allow 
such images. 
• Most web 2.0 sites don’t
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Exploit Origins
• To create a really good 
MySpace tracker.
• Wanted to add image to 
“friends” pages that 
looks like this: 
• Got frustrated because 
MySpace doesn’t allow 
such images. 
• Most web 2.0 sites don’t
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Exploit Origins
• To create a really good 
MySpace tracker.
• Wanted to add image to 
“friends” pages that 
looks like this: 
• Got frustrated because 
MySpace doesn’t allow 
such images.
• Most web 2.0 sites don’t
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Exploit Origins
• To create a really good 
MySpace tracker.
• Wanted to add image to 
“friends” pages that 
looks like this: 
• Got frustrated because 
MySpace doesn’t allow 
such images. 
• Most web 2.0 sites don’t
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Exploit Origins
• MySpace won’t allow you to reference 
images like  
because:
– This is a program not actually an image
– It is a executable image
• May still send an image to the browser
• May also:
– Write cookies
– Track environment variables
– Access databases, Send instant messages, etc 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
Exploit Origins
• MySpace won’t allow you to reference 
images like  
because:
– This is a program not actually an image
– It is a executable image
• May still send an image to the browser
• May also:
– Write cookies
– Track environment variables
– Access databases, Send instant messages, etc 
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What is a executable image?
• Executable images are programs
• Often used when images are stored in databases
• Can dynamically deliver “altered” images
– Watermarks (with time stamp or IP addresses)
– CAPTCHAs
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What is a executable image?
• Executable images are programs
• Often used when images are stored in databases
• Can dynamically deliver “altered” images
– Watermarks (with time stamp or IP addresses)
– CAPTCHAs
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
What is a executable image?
• Executable images are programs
• Often used when images are stored in databases
• Can dynamically deliver “altered” images
– Watermarks (with time stamp or IP addresses)
– CAPTCHAs
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
You can “pull” an image from a database with code like this
Executable image example #1
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
You can “pull” an image from a database with code like this
Executable image example #1
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
• Doesn’t require any special graphics 
libraries
• Image must be previously stored in 
database as a blob
• Images may be referenced by index or by 
name.
• Useful when web servers lack file 
permissions to read/write files
Executable image example #1
The Executable Image Exploit
DEFCON XV Las Vegas Nevada
PI:EMAIL
The Executable Image Exploit
www.schrenk.com
• Doesn’t require any special graphics 
libraries
• Image must be previously stored in 
database as a blob