# 如何利用开源工具收集美国关键基础设施情报？
##### 译文声明
本文是翻译文章，文章原作者 代码卫士，文章来源：代码卫士
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
编译：奇安信代码卫士团队
本报告研究的是工业控制系统 (ICS) 。作者 Wojciech
说明了如何通过开源情报对关键基础设施实施侦察。很多时候，可以从具体的建筑物如发电厂、废水池或化学和制造设施入手开展研究。本研究由美国被暴露的2.6万台设备组成。奇安信代码卫士团队现将报告翻译如下，供各位参考:
## 开源情报 (OSINT)
开源情报(OSINT)
是个较为宽泛的领域，很多人都在不知不觉的情况下使用它。你所阅读的或观看的影响你的看法，而基于所收集的信息你坚持己见并作出自己的决策和判断。这些信息的来源可能是传统的大众媒体如电视、收音机或报纸或互联网及其所含信息如网站、社交媒体或博客。另外，OSINT用于开展多项调查如地理定位照片或追踪特定个体的行踪。它还夹杂着其它情报技术如人工智能
(HUMINT)、地理空间智能 (GEOINT) 或网络智能
(CYBINT)。根据照片或威胁行动者遗留的微小线索，人们就能够收集很多信息，将它们拼凑成完整的图像，进而得出最终结论。另外，OSINT有助于网络犯罪防范组织追踪犯罪分子的行踪，有利于情报机构获取关于对手的能力信息，在真实世界和网络世界中均是如此。了解了乌克兰、伊朗和沙特阿拉伯发生的事件后，我们应该意识到国家关键基础设施可能遭受的损害。如遇冲突，直接暴露在互联网上的设备可能被黑并以多种方式引发损害。美国中情局(CIA)
强调的五大主要OSINT 领域包括：
  * 互联网——在本研究中我使用了很多 Web 信息。我获取了直接联网并暴露于互联网的工控设备。
  * 传统的大众媒体
  * 照片——多数源自社交媒体服务以及其它来源如谷歌街景，本研究也使用了谷歌街景。
  * 会议——人们分享简介和信息的地方，它也同时包含专业记者和智库的研究成果。
  * 地理空间信息——包含地图和商业图像产品，包括检查地理位置并追踪可能和设备之间存在关联的最近建筑物。
而我在本研究中使用 OSINT 来可视化并收集美国所暴露的约2.6万台 ICS 设备的地理位置信息和技术信息。
## 关键基础设施
我们很难界定哪些是关键基础设施哪些不是。通常而言，构成社会和国民经济主要部分的且它们的破坏或功能丧失会影响国家安全、医疗、能源或水利行业的行业和资产都属于关键基础设施。因此，负责运营美国国土安全局
(DHS) 所罗列的16个行业的每个建筑物和财产必须以关键基础设施对待而且应该实现适当的安全控制和机制。
为了更好地理解这一概念，举个例子：商场附近的停车场可以使用工控设备但它并非关键基础设施；与之相反，任何发电厂（如被黑或遭攻陷可能导致个人和企业无法使用能源）就被视作关键基础设施。DHS
提到的16个关键基础设施行业包括：
  * 化学制品——包括化学设施、制药或特殊/农业化学制品；
  * 商业设施——聚集大规模人群的场所如体育场、购物中心、赌场、游乐园、动物园或酒店；
  * 通信——它提供其它关键基础设施的连接，并包括无线、地面和卫星传输；
  * 运输——它负责以各种方式将大量的人或货物运输到不同的地方。例如铁路或机场；
  * 制造业——涉及不同行业的制造业：初级金属、机械、电气设备和运输设备。制造业的作用是确保经济繁荣和国家的连续性；
  * 大坝——防止洪水泛滥，并提供蓄水和控制服务；
  * 国防工业基地——每个负责生产、设计或交付军事武器的设施都被视为关键基础设施。此外，提供研发的行业，如政府承包商也在这一领域。它是国防上最重要的部门之一，因为没有它，就不可能动员、部署和维持军事行动；
  * 应急——该行业构成社会生活的核心，包括执法和消防部门、公共工程和医疗急救服务。它还提供其它服务如特警队、搜救队、融合中心、犬科和911呼叫中心；
  * 能源——为城市和企业提供电力。没有稳定的能源供应，其它的关键基础设施也可能处于危险之中。它也是所有人日常活动的必需品；
  * 金融——保险公司、存托机构和融资组织；
  * 粮食和农业——高度依赖于能源、化学、废物和运输领域，包括农场、饭店和食品制造业；
  * 政府设施——国家所有或出租的建筑物。该行业最关键的设施是军事设施、国家实验室、法院或使馆。此外，它还包括网络元素，例如访问控制系统和闭路电视系统。它还设有一个教育设施分部门，涵盖学校和高等教育机构。负责保护存储设施和投票站等资产的选举基础设施也是政府设施行业的一个子部分。
  * 医疗保健和公共卫生——保护其它行业免受自然/人为灾难或传染病的侵害；
  * 信息技术——主要侧重于提供硬件、软件和信息技术，并与通信部门一起提供互联网；
  * 核反应堆、材料和废物——包括动力堆、研究和测试反应堆或核燃料循环设施；
  * 水和废水系统——确保饮用水和废水处理的供应。
## 开源情报和关键基础设施
了解了开源情报的基础和关键基础设施行业之后，我们可以结合二者获取某个国家的关键资产情报。它对于理解对手网络的潜力和弱点发挥着重要作用，也是发动所有网络攻击的首要步骤。关键基础设施的开源情报多数供情报服务用于在战争时期从事间谍活动以及实施潜在的破坏活动，或者只是用于展示自身的网络实力。犯罪组织也对攻陷某个国家的关键行业感兴趣，但多数是为了获取金钱收益——他们使用开源情报实施侦察，目的是开发并出售
ICS 恶意软件或交易被盗凭证。可能攻击关键 ICS
设备并使用开源情报的群体是恐怖分子，他们的目的是削弱国家经济、挫败公众士气并威胁国家安全。我将内部人员也算在这一群体内，因为他们具备已部署基础设施的大量知识，他们可能不具备所有一切关键基础设施的访问权限，但了解用于关键基础设施例如发电厂的网络和技术。我们可以从开源数据收集很多某些关键基础设施建筑物的信息，比如某个建筑物或城市的准确的地理位置信息等。这样我们就能从物理监控、社交媒体照片、谷歌地图或街景中收集更多的信息。查找关键基础设施某个元素的漏洞或入口点，我们不应该忘记其中的工作人员。适当的侦查允许雇佣内部人员、安插自己的卧底，不过鱼叉式钓鱼活动也起着重要作用。值得注意的是，开源情报是在目标不知道自己正在被调查的情况下被动地收集数据。如果你具备设备的如下技术详情，那么主动侦查的大门已经敞开：
  * IP地址/主机名——用于扫描附近的资产或不常用端口；
  * 技术——借此找到或研究某个特定系统的漏洞。例如，如果知道目标多数时间使用 Niagara Fox，那么我们就不需要花费太多时间查找 Codesys 产品的新利用；
  * 端口——设备的其它开放端口可能为攻击者提供了一个入口点。过时和易受攻击的 Apache 服务器可用于深入网络；
  * 设备响应——它提供了所运行设备的很多有用且详细的信息。它还极大地有利于建立运营设备所在建筑物的真实地址。在安装过程中，技术人员通常会说明街道的名称、建筑物、确切的地址位置、电话号码或其它敏感信息
BACnet 设备的示例字段：
  * Vendor ID
  * Vendor Number
  * Object Identifier
  * Firmware Revision
  * Application Software Revision
  * Object Name
  * Model Name
  * Description
  * Location
  * Broadcast Distribution Table (BDT)
  * Foreign Device Table (FDT)
Niagara Fox 的字段示例：
  * Fox Version
  * Hostname
  * Host Address
  * Application Name
  * Application Version
  * Station Name
  * VM Name
  * VM Version
  * OS Name