over all public values, and the resulting root node could
be used to authenticate any one-time signature in that
tree. For signature veriﬁcation, a node would include
all the values in the hash tree that allow a veriﬁer to
recompute the root node of the hash tree; for n nodes,
this approach would require ln n extra values. Using the
parameters suggested by Rohatgi [31] for the Merkle-
Winternitz signature, a signature is 230 bytes large, and
the additional veriﬁcation values would require an addi-
tional 100 bytes. This is quite large for a sensor network,
and thus we suggest using asymmetric cryptography to
achieve smaller messages, despite the higher veriﬁcation
cost. Since message transmission accounts for the ma-
jority of energy consumption, we may conserve energy
by sending smaller messages but requiring a higher com-
putation overhead.
as the real neighbors of α (e.g., in the Randomized Mul-
ticast, β will forward the location claim to a randomly
selected set of witness nodes).
The use of pseudo-neighbors successfully defeats
masked-replication attacks.
If the masked nodes fail
to send out location claims, then the closest legitimate
nodes will have a higher probability of appointing them-
selves pseudo-neighbors. If the replicated nodes fail to
respond to requests from the pseudo-nodes, the legiti-
mate nodes will cut off communication. By forcing all
nodes to provide location claims, we can rely on the re-
siliency of our detection algorithm to revoke replicated
nodes.
8.4 Masked-Replication Attacks
8.5 Emergent Properties
In our discussion of the resiliency of the various pro-
tocols, we have assumed that each node has at least one
legitimate neighbor. Without this assumptions, all of the
protocols discussed thus far may fail to detect node repli-
cation. If the adversary compromises all of α’s neigh-
bors, then she can create one replica of α without fear
of detection, since the compromised nodes will not send
out location claims for the original α. To create a sec-
ond replica of α, the adversary must also compromise
the nodes surrounding the ﬁrst replica. Thus, the adver-
sary must compromise an additional d nodes for each
replica of α she wishes to create. However, if the com-
promised nodes mask the replicated nodes, the adversary
can improve her foothold in the network. For example,
if the adversary compromises nodes µ1, µ2 . . . µk, then
she can assign replicas of {µ1, µ2 . . . µi−1, µi+1 . . . µk}
as neighbors of µi. This gives the adversary the inﬂu-
ence of k2 nodes after she compromises k nodes. As a
concrete example, suppose the adversary compromises
(cid:2)
nodes µ1 and µ2. Now, she can create replicas µ
1 and
(cid:2)
(cid:2)
2’s only neighbor, and µ2 as
2. By assigning µ1 as µ
µ
(cid:2)
1’s only neighbor, the compromised nodes can mask
µ
the replicas. None of the protocols discussed will de-
tect these replicas, since they rely on a replicated node’s
neighbors to propagate the replica’s location claims.
Fortunately, we can thwart this attack with a straight-
forward defense. Each node β maintains a list of the m
nodes from which it has seen the most trafﬁc. For each
node α on the list, β appoints itself a pseudo-neighbor
of α with probability
Ppseudo ∝ trafﬁcα
claimsα
(17)
where trafﬁcα is the amount of trafﬁc that β has seen
from α, and claimsα is the number of location claims
β has seen concerning α. As a pseudo-neighbor, β re-
quests a location claim directly from α.
If α fails to
respond, β ceases to forward trafﬁc from α. If α does re-
spond, β follows the same protocol-dependent behavior
Our two primary algorithms, Randomized Multicast
and Line-Selected Multicast, achieve distributed detec-
tion of global events, while imposing low overheads
and providing high resiliency. Their strong properties
are a result of their emergent nature. Emergent algo-
rithms utilize the collective efforts of multiple sensor
nodes to provide capabilities beyond those of any indi-
vidual node. For example, after a network’s initial de-
ployment, a topology emerges as nodes exchange neigh-
bor information and establish a routing infrastructure.
Since emergent algorithms operate in a distributed fash-
ion, they tend to be highly robust in the face of individ-
ual node failures, and they avoid the problems inherent
in centralized solutions. These properties make them
ideal for security applications, particularly in a setting
in which we cannot predict the number or identity of
the sensors that will be subverted by an adversary. To
the best of our knowledge, our protocols represent the
ﬁrst application of emergent algorithms to the problem
of security in sensor networks, and we believe that ad-
ditional research will only continue the trend towards
distributed solutions. Furthermore, emergent algorithms
apply more generally to security in other classes of net-
works in which individual nodes are vulnerable to com-
promise (e.g., peer-to-peer networks and ad-hoc wire-
less networks), allowing solutions in one class to extend
naturally to the others.
9 Related Work
Eschenauer and Gligor [13] propose centralized node
revocation in sensor networks. When the base station
detects a misbehaving node, it broadcasts a message to
revoke that node. Chan, Perrig, and Song [6] propose
a localized mechanism for sensor network node revoca-
tion; in their approach, nodes can revoke their neigh-
bors. Neither paper discusses a distributed approach for
detecting distributed intrusions.
In broadcast encryption, key revocation has been
an important mechanism to recover from compromised
Proceedings of the 2005 IEEE Symposium on Security and Privacy (S&P’05) 
1081-6011/05 $ 20.00 IEEE
keys [2, 3, 15, 16, 21, 26]; however, these approaches do
not provide duplicate node detection in sensor networks.
Similarly, the results of key revocation in the context of
multicast content distribution [35, 37] do not apply here.
The Sybil attack is related to the node replication
attack—in the Sybil attack, a malicious node gains an
unfair advantage by claiming multiple identities [10].
Douceur presents countermeasures for peer-to-peer net-
works that involve resource veriﬁcation (computation,
communication, and memory) [10]. Newsome et al.
present techniques to defend against the Sybil attack in
sensor networks [27]. Their countermeasures include
wireless network testing, key space veriﬁcation, and
central node registration. Only their centralized node
registration technique (similar to the one we describe in
Section 3.1) can detect a node replication attack, but it
is brittle in the face of node compromise and has a high
overhead, as we show in this paper.
Bawa et al. [1] propose an algorithm for counting the
number of members of a peer-to-peer network that is re-
lated in spirit to our approach; they propose a random
sampling approach that provides an estimate of the net-
n) samples are drawn and a dupli-
work size after O(
cate node is sampled (for a network of size n), by using
the birthday paradox. Our Randomized Multicast also
relys on the birthday paradox.
√
10 Future Work
In the preceding discussion, we have assumed that the
nodes controlled by the adversary continue to follow the
protocols described. In our future work, we would like
to explore additional mechanisms to ensure that our pro-
tocols continue to function even in the face of misbehav-
ing nodes. For example, McCune et al. describe a tech-
nique that uses secure implicit sampling to detect nodes
that suppress or drop messages [23]. We could also use
some of the techniques described in Section 8.2 to peri-
odically sweep the network for replicas, thus preventing
the adversary from establishing a signiﬁcant foothold in
the network.
11 Conclusion
We have discussed various approaches used to detect
node replication. In Section 3, we show how central-
ized approaches place excessive trust in the base station
and excessive load on those nodes near it. Local vot-
ing schemes are ill equipped to detect distributed node
replication. In contrast, we present two schemes that en-
able distributed detection of distributed events. The ﬁ-
nal scheme, Line-Selected Multicast, provides excellent
resiliency while achieving near optimal communication
overhead with only modest memory requirements. Both
of our primary schemes illustrate the power of emer-
gent properties in sensor networks. Given the adversary
Proceedings of the 2005 IEEE Symposium on Security and Privacy (S&P’05) 
1081-6011/05 $ 20.00 IEEE
model typically assumed in sensor networks, we argue
that the security of such networks will increasingly de-
pend on emergent algorithms. Cost considerations and
unattended deployment will always leave individual sen-
sors vulnerable to compromise. Since we cannot predict
the exact nature or number of targets the adversary will
select, the network must collectively resist, report and
revoke compromised nodes in a manner that goes be-
yond traditional intrusion detection systems. We expect
that emergent algorithms will ultimately provide the best
defense against these insidious attacks.
Acknowledgements
The authors would like to thank Haowen Chen and
Dawn Song for their insightful comments and sugges-
tions. Diana Seymour provided discerning observations
and invaluable help editing the paper. We would also
like to thank the anonymous reviewers for their helpful
suggestions.
References
[1] M. Bawa, H. Garcia-Molina, A. Gionis, and R. Motwani.
Estimating aggregates on a peer-to-peer network. Tech-
nical report, Stanford University, 2003.
[2] C. Blundo and A. Cresti. Space requirements for broad-
In Advances in Cryptology (EURO-
cast encryption.
CRYPT), 1995.
[3] C. Blundo, L. Mattos, and D. Stinson. Trade-offs be-
tween communication and storage in unconditionally se-
cure schemes for broadcast encryption and interactive
key distribution. In Advances in Cryptology (CRYPTO),
1996.
[4] D. Braginsky and D. Estrin. Rumor routing algorithm
for sensor networks. In Proceedings of ACM Workshop
on Wireless Sensor Networks and Applications, 2002.
[5] N. Bulusu, J. Heidemann, and D. Estrin. GPS-less low-
cost outdoor localization for very small devices. IEEE
Personal Communications Magazine, October 2000.
[6] H. Chan, A. Perrig, and D. Song. Random key predistri-
bution schemes for sensor networks. In Proceedings of
IEEE Symposium on Security and Privacy, May 2003.
[7] T. Cormen, C. Leiserson, R. Rivest, and C. Stein. Intro-
duction to Algorithms. MIT Press, 2001.
[8] L. Doherty, K. S. J. Pister, and L. E. Ghaoui. Convex
position estimation in wireless sensor networks. In Pro-
ceedings of IEEE Infocom, 2001.
[9] D. Dolev and A. C. Yao. On the security of public key
IEEE Transactions on Information Theory,
protocols.
1983.
[10] J. R. Douceur. The Sybil attack. In Proceedings of Work-
shop on Peer-to-Peer Systems (IPTPS), Mar. 2002.
[11] J. Dyer, M. Lindemann, R. Perez, R. Sailer, L. van
Doorn, S. W. Smith, and S. Weingart. Building the IBM
4758 Secure Coprocessor. IEEE Computer, 2001.
[12] J. Elson, L. Girod, and D. Estrin. Fine-grained net-
work time synchronization using reference broadcasts.
SIGOPS Oper. Syst. Rev., 2002.
table for data-centric storage. In Proceedings of ACM In-
ternational Workshop on Wireless Sensor Networks and
Applications (WSNA), Sept. 2002.
[31] P. Rohatgi. A compact and fast hybrid signature scheme
for multicast packet. In Proceedings of ACM Conference
on Computer and Communications Security (CCS), Nov.
1999.
[32] A. Seshadri, A. Perrig, L. van Doorn, and P. Khosla.
Swatt: Software-based attestation for embedded devices.
In Proceedings of IEEE Symposium on Security and Pri-
vacy, May 2004.
[33] S. W. Smith and S. Weingart.
Building a high-
performance, programmable secure coprocessor. Com-
puter Networks, Apr. 1999. Special Issue on Computer
Network Security.
[34] H. Solomon. Geometric Probability. Society for Indus-
trial and Applied Mathematics (SIAM), 1978.
[35] D. Wallner, E. Harder, and R. Agee. Key manage-
ment for multicast: Issues and architectures.
Internet
Request for Comment RFC 2627, Internet Engineering
Task Force, June 1999.
[36] S. Weingart. Physical security devices for computer sub-
systems: A survey of attacks and defenses.
In Cryp-
tographic Hardware and Embedded Systems (CHES),
Aug. 2000.
[37] C. Wong, M. Gouda, and S. Lam. Secure group com-
munications using key graphs. In Proceedings of ACM
SIGCOMM, 1998.
[13] L. Eschenauer and V. Gligor. A key-management
scheme for distributed sensor networks. In Proceedings
of the ACM Conference on Computer and Communica-
tion Security (CCS), Nov. 2002.
[14] D. Estrin, R. Govindan, J. S. Heidemann, and S. Kumar.
Next century challenges: Scalable coordination in sensor
networks. In Mobile Computing and Networking, 1999.
[15] A. Fiat and M. Naor. Broadcast encryption. In Advances
in Cryptology (CRYPTO), 1994.
[16] J. Garay, J. Staddon, and A. Wool. Long-lived broad-
cast encryption. In Advances in Cryptology (CRYPTO),
2000.
[17] V. D. Gligor. Security of emergent properties in ad-hoc
networks. In Proceedings of International Workshop on
Security Protocols, Apr. 2004.
[18] A. Hu and S. D. Servetto. Asymptotically optimal time
synchronization in dense sensor networks. In Proceed-
ings of ACM International Conference on Wireless Sen-
sor Networks and Applications, 2003.
[19] B. Karp and H. T. Kung. GPSR: Greedy perimeter state-
less routing for wireless networks.
In Proceedings of
Conference on Mobile Computing and Networking (Mo-
biCom), Aug. 2000.
[20] D. Liu and P. Ning. Efﬁcient distribution of key chain
commitments for broadcast authentication in distributed
sensor networks.
In Proceedings of Network and Dis-
tributed System Security Symposium (NDSS), Feb. 2003.
[21] M. Luby and J. Staddon. Combinatorial bounds for
In Advances in Cryptology
broadcast encryption.
(EUROCRYPT), 1998.
[22] D. Malan, M. Welsh, and M. Smith. A public-key infras-
tructure for key distribution in TinyOS based on elliptic
curve cryptography. In Proceedings of IEEE Conference
on Sensor and Ad hoc Communications and Networks
(SECON), Oct. 2004.
[23] J. M. McCune, E. Shi, A. Perrig, and M. K. Reiter. De-
tection of denial-of-message attacks on sensor network
broadcasts. In Proceedings of IEEE Symposium on Se-
curity and Privacy, May 2005.
[24] R. Merkle. Protocols for public key cryptosystems. In
Proceedings of the IEEE Symposium on Research in Se-
curity and Privacy, Apr. 1980.
[25] R. Merkle. A digital signature based on a conven-
tional encryption function. In Advances in Cryptology
(CRYPTO), 1988.
[26] D. Naor, M. Naor, and J. Lotspiech. Revocation and
tracing schemes for stateless receivers. In Advances in
Cryptology (CRYPTO), 2001.
[27] J. Newsome, E. Shi, D. Song, and A. Perrig. The Sybil
attack in sensor networks: Analysis and defenses.
In
Proceedings of IEEE Conference on Information Pro-
cessing in Sensor Networks (IPSN), Apr. 2004.
[28] J. Newsome and D. Song. GEM: Graph embedding for
routing and data-centric storage in sensor networks with-
out geographic information. In ACM Conference on Em-
bedded Networked Sensor Systems (SenSys), Nov. 2003.
[29] A. Perrig, R. Szewczyk, V. Wen, D. Culler, and J. D.
Tygar. SPINS: Security protocols for sensor networks.
In ACM Conference on Mobile Computing and Networks
(MobiCom), July 2001.
[30] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin,
R. Govindan, and S. Shenker. GHT: A geographic hash
Proceedings of the 2005 IEEE Symposium on Security and Privacy (S&P’05) 
1081-6011/05 $ 20.00 IEEE
A Network Topologies
(a) Thin H
(b) Thin Cross
(c) S
(d) Large Cross
(e) L
(f) Large H
Figure 4. Assorted Network Topologies We tested the Line-Selected Multicast protocol with a variety of network topolo-
gies. Samples of each are shown here. Dots represent nodes, and lines represent connections between neighbors.
Proceedings of the 2005 IEEE Symposium on Security and Privacy (S&P’05) 
1081-6011/05 $ 20.00 IEEE