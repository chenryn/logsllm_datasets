points on the polynomials: Y = {Y (i) =Qm−1
In MNSpend, the user gives the merchant the thresh-
old unendorsed coin (S0, T 0, Φ0, R, Z) and stores the en-
dorsement X. The merchant needs to verify the unen-
dorsed coin: he uses uses Z, a commitment to the poly-
nomials’ coeﬃcients, to calculate Y , a commitment to
k=0 (Zk)ik :
i ∈ [0, n]}. The merchant sets y = Y (0) and veriﬁes Φ0
in the usual way.
Now the merchant needs to get m endorsements.
3 ) : i ∈
The user has n endorsements: {(X (i)
[1, n]}. They can use the homomorphic one-way func-
tion φ(a, b, c) = ga
3 to do an optimistic fair ex-
1 gb
2gc
change because φ(X (i)
1 , X (i)
3 ) = Y (i) (remember,
Φ0 proves the Y (i) are correct). In MNReconstruct, the
merchant uses the m points to interpolate the polyno-
mials and learn (x1, x2, x3).
2 , X (i)
2 , X (i)
1 , X (i)
Security:
this is a straightforward application of
Pedersen VSS. The user creates n veriﬁable shares of
the secret (x1, x2, x3) and gives the merchant the stan-
dard veriﬁcation vector. Each endorsement is a share
of the secret.
5 Conclusion
We have shown how to perform truly fair exchange
of oﬀ-line and on-line e-cash for digital goods and ser-
vices. We provide a new protocol for eﬃciently ex-
changing multiple e-coins simultaneously; this proto-
col can be applied to fair exchange of any secret that
lends itself to Pedersen commitments. Our threshold
endorsed e-cash allows exchanging a single e-coin for
multiple goods and services. By reducing the exchange
of e-cash to the exchange of lightweight endorsements,
we make it possible to apply many (eﬃcient) standard
cryptographic techniques to e-commerce.
Acknowledgements
Part of Jan Camenisch’s work reported in this pa-
per is supported by the European Commission through
the IST Programme under Contracts IST-2002-507932
ECRYPT and IST-2002-507591 PRIME. The PRIME
projects receives research funding from the European
Communitty’s Sixth Framework Programme and the
Swiss Federal Oﬃce for Education and Science. Anna
Lysyanskaya is supported by NSF Grant CNS-0627553.
Mira Meyerovich is supported by a U.S. Department of
Homeland Security Fellowship and NSF Grant CNS-
0627553. All opinions expressed in this paper are the
authors’ and do not necessarily reﬂect the policies and
views of EC, DHS, and NSF.
References
[ADS03] Alessandro Acquisti, Roger Dingledine, and
Paul Syverson.
On the economics of
anonymity. Financial Cryptography, pages
84–102, 2003.
[ASW97] N. Asokan, Matthias Schunter, and Michael
Waidner. Optimistic protocols for fair ex-
change. In Proc. 4th ACM Conference on
Computer and Communications Security,
pages 6–17. ACM press, 1997.
[ASW00] N. Asokan, Victor Shoup, and Michael
Waidner. Optimistic fair exchange of dig-
ital signatures. IEEE Journal on Selected
Areas in Communications, 18(4):591–610,
April 2000.
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007[BB04]
Dan Boneh and Xavier Boyen. Eﬃcient
selective-id secure identity based encryp-
tion without random oracles. In Advances
in Cryptology — EUROCRYPT 2004, vol-
ume 3027 of Lecture Notes in Computer
Science, pages 223–238. Springer-Verlag,
2004.
[BLS01] Dan Boneh, Ben Lynn,
and Hovav
Shacham. Short signatures from the Weil
pairing. In Colin Boyd, editor, Proceedings
of ASIACRYPT2001, volume 2248 of Lec-
ture Notes in Computer Science, pages 514–
532. Springer-Verlag, 2001.
[BP97]
[BP02]
[Bra93a]
[Bra93b]
[Bra93c]
Niko Bari´c and Birgit Pﬁtzmann. Collision-
free accumulators and fail-stop signature
schemes without trees.
In Walter Fumy,
editor, Advances in Cryptology — EU-
ROCRYPT ’97, volume 1233 of Lecture
Notes in Computer Science, pages 480–494.
Springer Verlag, 1997.
Mihir Bellare and Adriana Palacio. Gq and
schnorr identiﬁcation schemes: Proofs of se-
curity against impersonation under active
and concurrent attacks. In Moti Yung, edi-
tor, Advances in Cryptology — CRYPTO
2002, volume 2442 of Lecture Notes in
Computer Science, pages 162–177. Springer
Verlag, 2002.
Stefan Brands. An eﬃcient oﬀ-line elec-
tronic cash system based on the representa-
tion problem. Technical Report CS-R9323,
CWI, April 1993.
Stefan Brands. Untraceable oﬀ-line cash in
wallets with observers. manuscript, CWI,
1993.
Stefan Brands. Untraceable oﬀ-line cash
in wallets with observers.
In Douglas R.
Stinson, editor, Advances in Cryptology —
CRYPTO ’93, volume 773 of Lecture Notes
in Computer Science, pages 302–318, 1993.
[CFN90] David Chaum, Amos Fiat, and Moni Naor.
Untraceable electronic cash. In Shaﬁ Gold-
wasser, editor, Advances in Cryptology
— CRYPTO ’88, volume 403 of Lecture
Notes in Computer Science, pages 319–327.
Springer Verlag, 1990.
[Cha81]
David Chaum. Untraceable electronic mail,
return addresses, and digital pseudonyms.
Communications of the ACM, 24(2):84–88,
February 1981.
[Cha83]
[Cha84]
David Chaum. Blind signatures for un-
traceable payments.
In David Chaum,
Ronald L. Rivest, and Alan T. Sherman,
editors, Advances in Cryptology — Pro-
ceedings of CRYPTO ’82, pages 199–203.
Plenum Press, 1983.
David Chaum. Blind signature systems. In
David Chaum, editor, Advances in Cryp-
tology — CRYPTO ’83, page 153. Plenum
Press, 1984.
[CHK+06] Jan Camenisch,
Susan Hohenberger,
Markulf Kohlweiss, Anna Lysysanskaya,
and Mira Meyerovich. How to win the
clone wars:
Eﬃcient periodic n-times
anonymous authentication. In ACM CCS,
pages 201–210, 2006.
[CHL05]
[CHL06]
[CL02]
[CL04]
[CL05]
[Coh03]
Jan Camenisch, Susan Hohenberger, and
Anna Lysysanskaya. Compact e-cash.
In
Ronald Cramer, editor, Advances in Cryp-
tology – EUROCRYPT. lncs, 2005.
Jan Camenisch, Susan Hohenberger, and
Anna Lysysanskaya. Balancing account-
ability and privacy using e-cash. In Secu-
rity and Cryptography for Networks – SCN.
lncs, 2006.
Jan Camenisch and Anna Lysyanskaya. A
signature scheme with eﬃcient protocols. In
Giuseppe Persiano, editor, Security in com-
munication networks, volume 2576 of Lec-
ture Notes in Computer Science, pages 268–
289. Springer Verlag, 2002.
Jan Camenisch and Anna Lysyanskaya.
Signature schemes and anonymous creden-
tials from bilinear maps.
In Advances
in Cryptology — CRYPTO 2004, Lecture
Notes in Computer Science. Springer Ver-
lag, 2004.
Jan Camenisch and Anna Lysyanskaya. A
formal treatment of onion routing. In Vic-
tor Shoup, editor, Advances in Cryptology
— CRYPTO 2005, volume 3621 of Lecture
Notes in Computer Science, pages 169–187.
Springer-Verlag, August 2005.
Bram Cohen. Incentives build robustness in
bittorrent. In Procceedings of the 1st Work-
shop on Economics of Peer-to-Peer Sys-
tems, Berkeley, CA, 2003.
[CP93]
David Chaum and Torben Pryds Pedersen.
Transferred cash grows in size. In Rainer A.
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007[CPS94]
[CS03]
Rueppel, editor, Advances in Cryptology —
EUROCRYPT ’92, volume 658 of Lecture
Notes in Computer Science, pages 390–407.
Springer-Verlag, 1993.
Jan L. Camenisch, Jean-Marc Piveteau,
and Markus A. Stadler. Blind signatures
based on the discrete logaritm problem.
In Alfredo De Santis, editor, Advances
in Cryptology — EUROCRYPT ’94, vol-
ume 950 of Lecture Notes in Computer
Science, pages 428–432. Springer Verlag
Berlin, 1994.
Jan Camenisch and Victor Shoup. Prac-
tical veriﬁable encryption and decryption
of discrete logarithms. In Dan Boneh, ed-
itor, Advances in Cryptology — CRYPTO
2003, Lecture Notes in Computer Science.
Springer Verlag, 2003. To appear.
[CTS95] B. Cox, J. D. Tygar, and M. Sirbu. Netbill
security and transaction protocol. In Pro-
ceedings of the First Usenix Workshop on
Electronic Commerce, pages 77–88, 1995.
[DDM03] George Danezis, Roger Dingledine, and
Nick Mathewson. Mixminion: Design of a
type III anonymous remailer protocol.
In
IEEE Symposium on Security and Privacy.
IEEE Computer Society Press, 2003.
[DY05]
Yevgeniy Dodis and Aleksandr Yampolskiy.
A veriﬁable random function with short
proofs and keys.
In Proceedings of the
Workshop on Theory and Practice in Public
Key Cryptography, volume 3386 of Lecture
Notes in Computer Science, pages 416–431,
2005.
[FTY96] Yair Frankel, Yiannis Tsiounis, and Moti
Yung. “Indirect discourse proofs:” Achiev-
ing eﬃcient fair oﬀ-line e-cash. In Kwangjo
Kim and Tsutomu Matsumoto, editors, Ad-
vances in Cryptology — ASIACRYPT ’96,
volume 1163 of Lecture Notes in Computer
Science, pages 286–300. Springer Verlag,
1996.
[FY92]
Matthew Franklin and Moti Yung. To-
wards provably secure eﬃcient electronic
cash. Technical Report TR CUSC-018-92,
Columbia University, Dept. of Computer
Science, April 1992. Also in: Proceedings of
ICALP 93, Lund, Sweden, July 1993, vol-
ume 700 of LNCS, Springer Verlag.
[Jak95]
[Kra99]
Markus Jakobsson. Ripping coins for a fair
exchange.
In Advances in Cryptology —
EUROCRYPT ’95, volume 921, pages 220–
230. Springer Verlag, 1995.
Hugo Krawczyk. Diﬀerential power anal-
ysis.
In Michael J. Wiener, editor, Ad-
vances in Cryptology — CRYPTO ’99, vol-
ume 1666 of Lecture Notes in Computer
Science, pages 388–397. Springer Verlag,
1999.
[McC01]
Jim McCoy. Mojo nation responds, 2001.
[Mic97]
[MSK02]
[NSN05]
[Pai99]
[Ped92]
Silvio Micali. Certiﬁed e-mail with invisible
post oﬃces. Presentation at the 1997 RSA
Security Conference, 1997.
and
Shigeo Mitsunari, Ryuichi Sakai,
Masao Kasahara. A new traitor tracing.
In IEICE Transactions on Fundamentals
of Electronics, Communications and Com-
puter Sciences, volume E85-A, No. 2, pages
481–484, 2002.
Lan Nguyen and Rei Safavi-Naini. Dynamic
k-times anonymous authentication. In Ap-
plied Cryptography and Network Security,
volume 3531 of Lecture Notes in Computer
Science, pages 318–333, New York, 2005.
Pascal Paillier. Public-key cryptosystems
based on composite residuosity classes. In
Jacques Stern, editor, Advances in Cryptol-
ogy — EUROCRYPT ’99, volume 1592 of
Lecture Notes in Computer Science, pages
223–239. Springer Verlag, 1999.
Torben Pryds Pedersen. Non-interactive
and information-theoretic secure veriﬁable
secret sharing.
In Joan Feigenbaum, ed-
itor, Advances in Cryptology – CRYPTO
’91, volume 576 of Lecture Notes in Com-
puter Science, pages 129–140. Springer Ver-
lag, 1992.
[RWW05] Michael Reiter, XiaoFeng Want,
and
Matthew Wright. Building reliable mix
networks with fair exchange.
In Applied
Cryptography and Network Security: Third
International Conference, pages 378–392.
Lecture Notes in Computer Science, June
2005.
[Sch91]
Claus P. Schnorr. Eﬃcient signature gener-
ation for smart cards. Journal of Cryptol-
ogy, 4(3):239–252, 1991.
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007[SPC95] Markus Stadler, Jean-Marc Piveteau, and
Jan Camenisch.
Fair blind signatures.
In Louis C. Guillou and Jean-Jacques
Quisquater, editors, Advances in Cryptol-
ogy — EUROCRYPT ’95, volume 921 of
Lecture Notes in Computer Science, pages
209–219. Springer Verlag, 1995.
[TS04]
[Tsi97]
Isamu Teranishi and Kazue Sako. k-times
anonymous authentication with a constant
proving cost. In Public Key Cryptography
– PKC 2006, volume 3958 of Lecture Notes
in Computer Science, pages 525–542, New
York, NY, 2004.
Yiannis S. Tsiounis. Eﬃcient Electonic
Cash: New Notions and Techniques. PhD
thesis, Northeastern University, Boston,
Massachusetts, 1997.
[Wei05]
Victor K. Wei. More compact e-cash with
eﬃcient coin tracing. Available at: http:
//eprint.iacr.org/2005/411, 2005.
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007