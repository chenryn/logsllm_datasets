âˆ’ ğ´
ğ‘‘ğµğ‘š
o Receive Power Level (RPL)
ğ‘…ğ‘ƒğ¿ = 10 âˆ— log"#
$%& âˆ—(!"
)*&#
âˆ’ ğ´
ğ‘‘ğµğ‘š
We devised and present a 
technique that remote 
attackers can apply to 
circumvent this obstacle
23
Â© 2022 Nozomi Networks Inc.  
Obtaining the anchor coordinates is the most challenging requirement. They are manually input at the first 
installation and never transmitted through the network
â€¢ It is not possible to directly estimate the absolute distance, due to evolving temporary conditions
â€¢ However, if in a given moment t0 the power level information is identical, the tag j0 that triggered 
those packets must be positioned about exactly at the same distance from all anchors
ğ·ğ‘’ğ‘™ğ‘¡ğ‘ ğ‘–0, ğ‘—0, ğ‘¡0 =
ğºğ‘‡ ğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’, ğ‘—0, ğ‘¡0 âˆ’ ğºğ‘‡ ğ‘–0, ğ‘—0, ğ‘¡0
âˆ— ğ‘ = 0
â€¢ Considering that CS(reference, t0) = 1 and ToF(reference) = 0, we can exploit this information and 
estimate the time of flights, thus the distances of the other anchors from the reference
ğ‘‡ğ‘œğ¹(ğ‘–0) = ğ¶ğ‘†(ğ‘–0, ğ‘¡0) âˆ— (ğ‘ğ‘‡ğ‘ (ğ‘–0, ğ‘—0, ğ‘¡0) âˆ’ ğ‘ ğ‘‡ğ‘†(ğ‘–0, ğ‘¡0)) âˆ’ ğ‘ğ‘‡ğ‘ (ğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’, ğ‘—0, ğ‘¡0) + ğ‘ ğ‘‡ğ‘†(ğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’, ğ‘¡0)
Anchor Coordinates Prerequisite â€“ Contâ€™d
Attacker with Remote Access â€“ Contâ€™d
24
Â© 2022 Nozomi Networks Inc.  
Obtaining the anchor coordinates is the most challenging requirement. They are manually input at the first 
installation and never transmitted through the network
â€¢ Finally, to obtain the coordinates, we can leverage the following installation constraint:
Anchor Coordinates Prerequisite â€“ Contâ€™d
Attacker with Remote Access â€“ Contâ€™d
â€¢ Given that the anchor map is most times a rectangle, by arbitrarily setting the reference 
anchor in position (0;0), the coordinates of all other anchors can be easily estimated (they 
are given by the two shortest distances)
â€¢ An attacker can adapt the expected shape on the basis of the number of anchors detected 
in the communications 
25
Â© 2022 Nozomi Networks Inc.  
Obtaining the anchor coordinates is the most challenging requirement. They are manually input at the first 
installation and never transmitted through the network
Anchor Coordinates Prerequisite â€“ Contâ€™d
Attacker with Remote Access â€“ Contâ€™d
â€¢ This was actually tested in the Avalue RTLS, 
using both the First Path Power Level (FPPL) 
as well as the Receive Power Level (RPL)
â€¢ The best results are obtained using FPPL 
with a threshold of ~1% between the lowest 
power level and the highest
It was possible to estimate the anchors coordinates 
with an error of less than 10% with respect 
to the real values
â€¢ This can be accurate enough for attack scenarios 
where cm-level precision is not required
Anchors Coordinates Average Error wrt First Path 
Power Level (FPPL) Acceptance Threshold
26
Â© 2022 Nozomi Networks Inc.  
Obtaining the anchor coordinates is the most challenging requirement. They are manually input at the first 
installation and never transmitted through the network
Adversary Tactics, 
Techniques, and 
Procedures (TTPs)
Traffic Interception
Intercepting traffic requires two steps:
1.
gaining a foothold inside the 
anchors-server backhaul network
2.
executing a Man in the Middle (MitM) attack
Network Access
â€¢ Both Sewio and Avalue RTLS allow either Ethernet 
or Wi-Fi to be used for the network backhaul
â€¢ Gaining access to an Ethernet network requires 
that an attacker:
o either compromises a computer in that network
o or surreptitiously adds a rogue device
â€¢ The complexity of these attacks varies on the 
basis of the RTLS deployment configuration
Deployment configurations available on Sewio RTLS
To perform any meaningful attacks against RTLSs, an attacker first needs to intercept all network packets
28
Â© 2022 Nozomi Networks Inc.  
Network Access â€“ Contâ€™d
â€¢ As for Wi-Fi, both solutions support WPA2-PSK
â€¢ Gaining access to a Wi-Fi network requires:
o either the knowledge of the WPA2 password
o or the exploitation (if any) of vulnerabilities in the 
wireless appliances
â€¢ As for the first point, out of the box, both solutions 
use a static password that can be found in the 
public documentation
â€¢ In case an asset owner does not change it, 
obtaining access to the backhaul network is 
simple
To perform any meaningful attacks against RTLSs, an attacker first needs to intercept all network packets
Traffic Interception â€“ Contâ€™d
Default WPA2-PSK password on Avalue RTLS
29
Â© 2022 Nozomi Networks Inc.  
To perform any meaningful attacks against RTLSs, an attacker first needs to intercept all network packets
Traffic Interception â€“ Contâ€™d
Man in the Middle
â€¢ In the tests executed, it was 
possible to MitM both 
solutions via standard ARP 
spoofing attacks
The attacks were completely undetected by the RTLS. No warnings or abnormal 
behavior that may alert an operator were shown.
MitM attack against Sewio RTLS
ğ‘ğ‘Ÿğ‘ğ‘ ğ‘ğ‘œğ‘œğ‘“ âˆ’ ğ‘– ğ‘ğ‘¡ğ‘¡ğ‘ğ‘ğ‘˜ğ‘’ğ‘Ÿ_ğ‘’ğ‘¡â„ âˆ’ ğ‘¡ ğ‘ ğ‘’ğ‘Ÿğ‘£ğ‘’ğ‘Ÿ_ğ‘–ğ‘ ğ‘ğ‘›ğ‘â„ğ‘œğ‘Ÿ1_ğ‘–ğ‘ & ğ‘ğ‘Ÿğ‘ğ‘ ğ‘ğ‘œğ‘œğ‘“ âˆ’ ğ‘– ğ‘ğ‘¡ğ‘¡ğ‘ğ‘ğ‘˜ğ‘’ğ‘Ÿ_ğ‘’ğ‘¡â„ âˆ’ ğ‘¡ ğ‘ğ‘›ğ‘â„ğ‘œğ‘Ÿ1_ğ‘–ğ‘ ğ‘ ğ‘’ğ‘Ÿğ‘£ğ‘’ğ‘Ÿ_ğ‘–ğ‘
30
Â© 2022 Nozomi Networks Inc.  
After obtaining access to an RTLS network and launching the MitM attack, an attacker can reconstruct the 
position of tags by executing one of the TDoA algorithms known in literature
Passive Eavesdropping Attacks
01
Position of 
target shown 
in RTLS
02
Traffic is intercepted, 
anchor coordinates are 
estimated, timestamps 
are extracted
03
A TDoA algorithm 
is applied
04
Attacker obtains the 
position of target
31
Â© 2022 Nozomi Networks Inc.  
To accomplish an active attack, an attacker first needs to do a target reconnaissance and add traffic 
filtering routines to the attack algorithm
Active Traffic Manipulation Attacks
Target Reconnaissance
â€¢ To successfully deceive an operator, it is 
important that the tag movements appear natural
â€¢ This phase can be accomplished 
by simply performing a passive eavesdropping 
attack against the target
If the target is a human being, faking its position 
with harsh, sudden movements would warn an 
operator and make them think that, at the very 
least, a malfunctioning is occurring
Active Traffic Filtering
â€¢ If the packet is a synchronization 
packet, it must be automatically 
forwarded to the destination
â€¢ If the packet is a positioning packet of a 
target, its timestamp must be modified 
(and the checksum updated). If not a 
target one, it must be forwarded unaltered
â€¢ Many techniques are available. Notably, 
we leveraged iptables NFQUEUE, a 
flexible userspace packet handler
32
Â© 2022 Nozomi Networks Inc.  
Finally, an attacker can alter the timestamps by simply inverting all the equations previously described
Active Traffic Manipulation Attacks â€“ Contâ€™d
Packet Information Manipulation
â€¢ In a manipulation attack, the tag coordinates are known (they are the target coordinates that an 
attacker wants to fake for a given tag) and the positioning timestamps are unknown
â€¢ First, the attacker derives the modified positioning timestamps according to the target coordinates
â€¢ Finally, the attacker re-computes the packet checksums and then sends the modified packets
04
Position of target is 
altered in RTLS
03
Packet is
updated
01
The attacker defines 
a target coordinate for 
a given tag
ğ‘‹ğ‘—0, ğ‘¡0 â€“ ğ‘‹ğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’ ! +
ğ‘Œğ‘—0, ğ‘¡0 â€“ ğ‘Œğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’ ! +
ğ‘ğ‘—0, ğ‘¡0 â€“ ğ‘ğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’ !
âˆ’
ğ‘‹ğ‘—0, ğ‘¡0 â€“ ğ‘‹1 ! +
ğ‘Œğ‘—0, ğ‘¡0 â€“ ğ‘Œ1 ! +
ğ‘ğ‘—0, ğ‘¡0 â€“ ğ‘1 ! = ğ·ğ‘’ğ‘™ğ‘¡ğ‘(1, ğ‘—0, ğ‘¡0)
â€¦
ğ‘‹ğ‘—0, ğ‘¡0 â€“ ğ‘‹ğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’ ! +
ğ‘Œğ‘—0, ğ‘¡0 â€“ ğ‘Œğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’ ! +
ğ‘ğ‘—0, ğ‘¡0 â€“ ğ‘ğ‘Ÿğ‘’ğ‘“ğ‘’ğ‘Ÿğ‘’ğ‘›ğ‘ğ‘’ !
âˆ’
ğ‘‹ğ‘—0, ğ‘¡0 â€“ ğ‘‹ğ‘ ! +
ğ‘Œğ‘—0, ğ‘¡0 â€“ ğ‘Œğ‘ ! +
ğ‘ğ‘—0, ğ‘¡0 â€“ ğ‘ğ‘ ! = ğ·ğ‘’ğ‘™ğ‘¡ğ‘(ğ‘, ğ‘—0, ğ‘¡0)
02
The TDoA algorithm is 
applied backwards
33
Â© 2022 Nozomi Networks Inc.  
Attack Demos
Locating and Targeting People/Assets
35
Â© 2022 Nozomi Networks Inc.  
Geofencing
36
Â© 2022 Nozomi Networks Inc.  
Contact Tracing
37
Â© 2022 Nozomi Networks Inc.  
Remediations
Segregation and Firewall Rules
Advantages
â€¢ Allows the problem to be mitigated 
relatively quickly
â€¢ Can be enacted by deploying traditional 
solutions such as VLANs, IEEE 802.1X, 
firewall rules
Challenges
â€¢ Some RTLS servers expose core network 
services on all interfaces. Firewall rules must be 
set to allow as few services as possible on the 
management interface
â€¢ Does not protect from a physical MitM (either 
via wire tap, or wireless sniffer if wireless 
password is compromised)
Siemens RTLS4030G operating instructions
Goal
â€¢
Move the entire UWB RTLS backhaul network to 
a segregated network, and secure the access to 
the network both physically and logically
This is now mandated by some RTLS vendors
39
Â© 2022 Nozomi Networks Inc.  
Intrusion Detection Systems
Detection of a MitM attack by an IDS
Goal
â€¢
Detect signs of MitM attacks. Leverages the fact 
that MitM attacks are unavoidable to obtain the 
timestamps
This option was successfully tested on both Sewio and 
Avalue RTLS
Challenges
â€¢ Does not protect from a physical MitM (either 
via wire tap, or wireless sniffer if wireless 
password is compromised)
40
Â© 2022 Nozomi Networks Inc.  
Advantages
â€¢ Plug-and-play solution
â€¢ Allows the problem to be 
mitigated very quickly
Traffic Encryption
Advantages
â€¢ The closest mitigation to 
completely solving the problem
â€¢ Allows basic RTLS functionalities 
to remain unaltered
SSH tunnel PoC on Avalue RTLS
Goal
â€¢
Add a traffic encryption layer on top of the 
existing communications, to protect even against 
a physical MitM
This option was successfully tested on the Avalue RTLS for 
a PoC using standard tools (SSH tunnel and Socat)
Challenges
â€¢ In Avalue RTLS, it was necessary to reduce the 
number of syncs per second to counteract the 
higher load, at the expense of a reduced accuracy
â€¢ Entirely depends on the accessibility of the RTLS 
server and anchors from the vendor
41
Â© 2022 Nozomi Networks Inc.  
Summary &
Key Takeaways
Wireless technology increases 
efficiency + productivity while 
reducing unnecessary cabling 
infrastructure costs
Summary
â€¢ IEEE 802.15.4z has out of scope areas, creating 
security loopholes
â€¢ Nozomi Networks Labs discovered zero-days in 
two popular UWB RTLS  
â€¢ UWB RTLS is used for personnel tracking, 
geofencing, and contact tracing 
â€¢ Threat actor TTPs are MitM and eavesdropping 
or manipulation tactics
â€¢ Mitigations include segregation and firewall rules, 
IDS, and traffic encryption 
43
Â© 2022 Nozomi Networks Inc.  
Black Hat Sound Bytes
Weak security 
requirements in critical 
software can lead to 
safety issues that cannot 
be ignored
There are attack surfaces 
out there that no one is 
looking at, but they have 
significant consequences 
if compromised
Exploiting secondary 
communications in UWB 
RTLS can be challenging, 
but it is doable
Key Takeaways
44
Â© 2022 Nozomi Networks Inc.  
Thank You!
Questions?
PI:EMAIL