better  in  this  regard  than  all  the  other  AQM  schemes.  With  the 
addition of ECN, the number of timeouts is greatly reduced and PI 
enables  the  vast  majority  of  all  responses  to  experience  response 
times proportional to their RTT divided by their window size. This 
is seen in Figure 26 by observing the dense triangle-shaped mass 
of points starting at the origin and extending outward to the points 
(100,000, 6,000) and (100,000, 500). (Note as well the existence of 
similar triangles offset vertically by multiples of 1 second — the 
canonical packet loss timeout.) 
The second most striking result is that performance varied substan-
tially between PI and REM with packet dropping and this perform-
ance gap was closed through the addition of ECN. A preliminary 
analysis  of  REM’s  behavior  suggests  that  ECN  is  not  so  much 
improving  REM’s  behavior  as  it  is  ameliorating  a  fundamental 
design problem. Without ECN, REM consistently causes flows to 
100
80
60
40
20
)
%
(
y
t
i
l
i
b
a
b
o
r
p
e
v
i
t
l
a
u
m
u
C
0
0
Uncongested network
drop-tail 90load - qlen=240
PI/ECN 90load - qref=24
REM/ECN 90load - qref=24
ARED/ECN 90load - thmin=120 thmax=360 w=1/8192
500
1000
1500
2000
Figure 21: Comparison of all schemes with ECN, 90% load. 
Response time (ms)
100
80
60
40
20
)
%
(
y
t
i
l
i
b
a
b
o
r
p
e
v
i
t
l
a
u
m
u
C
0
0
Uncongested network
drop-tail 98load - qlen=240
PI/ECN 98load - qref=24
REM/ECN 98load - qref=24
ARED/ECN 98load - thmin=12 thmax=36 w=1/8192
500
1000
1500
2000
Response time (ms)
Figure 22: Comparison of all schemes with ECN, 98% load. 
100
80
60
40
20
)
%
(
y
t
i
l
i
b
a
b
o
r
p
e
v
i
t
l
a
u
m
u
C
0
0
Uncongested network
drop-tail 105load - qlen=240
PI/ECN 105load - qref=24
REM/ECN 105load - qref=24
ARED/ECN 105load - thmin=12 thmax=36 w=1/8192
500
1000
1500
2000
Figure 23: Comparison of all schemes with ECN, 105% load. 
Reponse time (ms)
experience  multiple  drops  within  a  source’s  congestion  window, 
forcing  flows  more  frequently  to  recover  the  loss  through  TCP’s 
timeout mechanism rather than its fast recovery mechanism. When 
ECN is used, REM simply marks packets and hence even if multi-
ple packets from a flow are marked within a window the timeout 
will  be  avoided.  Thus  ECN  appears  to  improve  REM’s  perform-
ance by mitigating the effects of its otherwise poor (compared to 
PI) marking/dropping decisions.  
1
0.1
0.01
0.001
0.0001
1e-05
1e-06
1e-07
)
%
(
y
t
i
l
i
b
a
b
o
r
p
e
v
i
t
l
a
u
m
u
c
y
r
a
t
l
n
e
m
e
p
m
o
C
1e-08
10
Uncongested network
drop-tail 98load - qlen=240
PI/ECN 98load - qref=24
REM/ECN 98load - qref=24
ARED/ECN 98load - thmin=12 thmax=36 w=1/8192
100
1000
10000
100000
1e+06
1e+07
Reponse time (ms)
Figure 24: CCDF of all schemes with ECN, 98% load. 
The  final  point  of  note  is the difference  in  performance  between 
ARED  and  the  other  AQM  schemes,  in  particular,  the  fact  that 
response time performance is consistently worse with ARED than 
with drop-tail. The exact reasons for the observed differences re-
mains  the  subject  of  continued  study,  however,  the  experiments 
reported here  and  others  lead us  to  speculate  that there  are  three 
primary factors influencing these results. First, PI and REM oper-
ate in “byte mode” by default — they monitor the queue length in 
bytes  rather  than  packets.  While  ARED  also  has  a  byte  mode, 
“packet mode” is the recommended setting. Byte mode allows for 
finer  grain  queue  measurements  but  more  importantly,  in  PI  and 
REM the marking/dropping probability for an individual packet is 
biased by a factor equal to the ratio of the current packet size to the 
average  (or  maximum)  packet  size.  This  means  that  in  PI  and 
REM, SYNs and pure ACKs experience a lower drop probability 
than  data  segments  arriving  at  the  router  at  the  same  time  and 
hence fewer SYNs and ACKs are dropped than under ARED. 
Second, in ARED’s “gentle mode,” when the average queue size is 
between  maxth  and  2xmaxth,  ARED  drops  ECN-marked  packets, 
following the ECN guidelines that state packets should be dropped 
when  the  AQM  scheme’s  queue  length  threshold  is  exceeded  in 
this  manner.  The  motivation  for  this  rule  is  to  more  effectively 
deal with potential non-responsive flows that are ignoring conges-
tion indications [12]. Our analysis indicates that this rule is in fact 
counter-productive  and  explains  much  of  ARED’s  inability  to 
benefit from ECN. 
Finally, PI and REM periodically sample the (instantaneous) queue 
length  when  deciding  to  mark  packets.  ARED  uses  a  weighted 
average. We believe that the reliance on the average queue length 
significantly limits ARED’s ability to react effectively in the face 
of highly bursty traffic such as the Web traffic generated herein. 
Of note  was the  fact that changing ARED’s  weighting factor  for 
computing average queue length by an order of magnitude had no 
effect on performance. 
7  CONCLUSIONS  
From  the  results  reported  above  we  draw  the  following  conclu-
sions.  These  conclusions  are  based  on  a  premise  that  user-
perceived response times are the primary yardstick of performance 
and  that  link  utilization  and  packet  loss  rates  are  important  but 
secondary measures.  
10000
8000
6000
4000
2000
)
s
m
(
e
m
i
t
e
s
n
o
p
s
e
R
0
0
20000
40000
60000
80000
100000
Figure 25: Scatter plot of PI performance without ECN, 98% load. 
Response size (bytes)
•  For  offered  loads  up  to  80%  of  bottleneck  link  capacity,  no 
AQM  scheme  provides  better  response  time  performance  than 
simple drop-tail FIFO queue management. Further, the response 
times achieved on a 100Mbps link are not substantially different 
from the response times on a 1 Gbps link with the same number 
of active users that generate this load. This result is not changed 
by combining any of the AQM schemes with ECN. 
•  For loads of 90% of link capacity or greater, PI results in a mod-
est  improvement  over  drop-tail  and  the  other  AQM  schemes 
when ECN is not used.  
•  With ECN, both PI and REM provide significant response time 
improvement at offered loads at or above 90% of link capacity. 
Moreover, at a load of 90%, PI and REM with ECN provide per-
formance  on  a  100  Mbps  link  competitive  with  that  achieved 
with a 1 Gbps link with the same number of active users. 
•  ARED  with  recommended  parameter  settings  consistently  re-
sulted in the poorest response time performance. This result was 
not changed with the addition of ECN.  
We conclude that without ECN there is little end-user performance 
gain to be realized by employing any of the AQM schemes studied 
here.  However,  with  ECN  performance  can  be  significantly  im-
proved  at  near-saturation  loads  with  either  PI  or  REM.  Thus,  it 
appears likely that provider links  may be operated at 80% of ca-
pacity even when not deploying any AQM (with or without ECN). 
Further, providers may be able to operate their links at even higher 
load  levels  without  significant  degradation  in  user-perceived  per-
formance provided PI or REM combined with ECN is deployed in 
their routers and ECN is implemented in TCP/IP stacks on the end-
systems.  
8  ACKNOWLEDGEMENTS  
We are indebted to Sanjeewa Athuraliya, Sally Floyd, Steven Low, 
Vishal Misra, and Don Towsley, for their assistance in performing 
the experiments described herein. In addition, we are grateful for 
the constructive comments of the anonymous referees and for the 
help of our shepherd, Dina Katabi.  
This work was supported in parts by the National Science Founda-
tion  (grants  ITR-0082870,  CCR-0208924,  and  EIA-0303590), 
Cisco Systems Inc., and the IBM Corporation.  
10000
8000
6000
4000
2000
)
s
m
(
e
m
i
t
e
s
n
o
p
s
e
R
0
0
20000
40000
60000
80000
100000
Response size (bytes)
Figure 26: Scatter plot of PI performance with ECN, 98% load. 
9  REFERENCES 
[1]  S. Athuraliya, A Note on Parameter Values of REM with Reno-like 
Algorithms, http://netlab.caltech.edu, March 2002. 
[2]  S. Athuraliya, V. H. Li, S.H. Low, Qinghe Yin, REM: Active Queue 
Management, IEEE Network, Vol. 15, No. 3, May 2001, pp. 48-53. 
[3]  B. Braden, et al, Recommendations on Queue Management and Con-
gestion Avoidance in the Internet, RFC 2309, April, 1998. 
[4]  M. Christiansen, K. Jeffay, D. Ott, and F.D. Smith, Tuning RED for 
Web Traffic, Proc., ACM SIGCOMM 2000, Sept. 2000, pp. 139-150. 
[5]  W.  Feng,  D.  Kandlur,  D.  Saha,  K.  Shin,  A  Self-Configuring  RED 
Gateway, Proc., INFOCOM ‘99, March 1999, pp. 1320-1328. 
[6]  S. Floyd, R. Gummadi, S. Shenker, Adaptive RED: An Algorithm for 
Increasing  the  Robustness  of  RED’s  Active  Queue  Management, 
http://www.icir.org/floyd/papers/ adaptiveRed.pdf, August 1, 2001. 
[7]  S.  Floyd,  and  V.  Jacobson,  Random  Early  Detection  Gateways  for 
Congestion  Avoidance,  IEEE/ACM  Transactions  on  Networking, 
Vol. 1 No. 4, August 1993, p. 397-413. 
[8]  C.V. Hollot, V. Misra, W.-B. Gong, D. Towsley, On Designing Im-
proved Controllers for AQM Routers Supporting TCP Flows, Proc., 
IEEE INFOCOM 2001, April 2001, pp. 1726-1734 
[9]  L. Rizzo, Dummynet: A simple approach to the evaluation of network 
protocols, ACM CCR, Vol. 27, No. 1, January 1997, pp. 31-41.  
[10]  C.  Kenjiro,  A  Framework  for  Alternate  Queueing:  Towards  Traffic 
Management by PC-UNIX Based Routers, Proc., USENIX 1998 An-
nual Technical Conf., New Orleans LA, June 1998, pp. 247-258. 
[11]  V. Misra, W.-B. Gong,, D. Towsley, Fluid-based Analysis of a Net-
work of AQM Routers Supporting TCP Flows with an Application to 
RED, Proc., ACM SIGCOMM 2000, pp. 151-160. 
[12]  K. Ramakrishnan, S. Floyd, D. Black, The Addition of Explicit Con-
gestion Notification (ECN) to IP, RFC 3168, September 2001. 
[13]  F.D. Smith, F. Hernandez Campos, K. Jeffay, D. Ott, What TCP/IP 
Protocol Headers Can Tell Us About the Web, Proc. ACM SIGMET-
RICS 2001, June 2001, pp. 245-256.  
[14]  W.  Willinger,  M.S.  Taqqu,  R.  Sherman,  D.  Wilson,  Self-similarity 
through high variability: statistical analysis of ethernet LAN traffic at 
the source level, IEEE/ACM Transactions on Networking, Vol. 5, No. 
1, February 1997, pp. 71-86.