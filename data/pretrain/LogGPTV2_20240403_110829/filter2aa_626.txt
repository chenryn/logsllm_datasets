DEFCON 19 // Adam Baldwin
Pillaging DVCS 
Repos
...for fun and profit
$ whoami
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
@adam_baldwin
Co-Founder of nGenuity
Pentester of webs
evilpacket.net
WTF is DVCS
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
Objectives
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
Identify web accessible repos
Pillage as much info as possible
???
Proﬁt
Alexa top million sites
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
GIT
HG
BZR
GIT: 1498 repos
HG: 312 repos
BZR: 235 repos
Repo Identiﬁcation
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
GIT: .git/HEAD
HG: .hg/requires
BZR: .bzr/README
http://example.com/.git/HEAD
W3AF Plugin
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
Cloning 
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
0. Check for dir browsing
1. Get predictable ﬁles
2. List repo ﬁles
3. Download references to ﬁles
4. Restore the repo (if possible)
Pillaging 
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
Platform details (.php, .cgi, etc)
Downloadable ﬁles (.old, .sql)
Source Code
Credentials / Certs / API Keys
Pillaging Ideas
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
.sql / .sql.bz2
.pem
conﬁg
.bak
.sql.gz
.xls / .xlsx
.ini
.cfg
.tar / .tar.gz
.doc / .docx
.sh
export
htpasswd
private
.qbw / .mny
backup
id_rsa
.pst / .ost
conﬁdential
dump / .dmp
id_dsa
settings
.csv
.txt
Thanks to @ﬂirzan & @quitlahok for some of these!
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
Montage of fail 
Customer 
Invoices
Demo  
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
The Tool
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
https://github.com/ngenuity/DVCS-Pillage
Questions?
PI:EMAIL // @adam_baldwin
Pillaging DVCS Repos   //     DEFCON 19     //     @adam_baldwin
References
nGenuity: 
http://ngenuity-is.com
http://ngenuity-is.com/blog/2011/mar/22/gotta-git-up-to-get-down/
http://ngenuity-is.com/blog/2011/apr/30/git-pillaging-revisited/
Evilpacket: 
http://evilpacket.net
W3AF:
http://w3af.sourceforge.net/
DVCS Pillage Toolkit:
http://github.com/ngenuity/dvcs-pillage