Order sets based on what you know of that app
 44 hours
 $13,200
Sequential logﬁles can help identify timelines
Sequential Log Files:
A Timeline
This log shows 3 sets 
of similar times
Order of sets can be 
identiﬁed from this 
sequential log
 44 hours
 $13,200
This logﬁle shows 3 sets of similar times
It also shows the ordering of each set
The BIOS time was changed twice
Malicious MACE Times
When all timestamps are scrambled, you know to 
ignore the values
If all ﬁles appear normal, you will never know if a single 
ﬁle has been updated to appear consistent
Investigative reports typically cite:
“this time is consistent with that time”
when describing artifacts found during analysis
 44 hours
 $13,200
Smart investigators never say “This occurred at this time”
They say ‘Logs show it occurred at this time’
and “This time is consistent with these other logs which reference this 
action”
Confounding ﬁle analysis
“Separate 
Wheat From 
Chaff”
Process Data 
For Analysis
#4. Analyze Data
Analyze Data 
for Relevance
Prepare Report 
on Findings
Archive Data 
For Future
Create 
Working Copy
 44 hours
 $13,200
When the suite youʼre using doesnʼt show you everything you want to see, 
you typically take the ﬁle out of the image to your workstation
You can then use your own app to analyze the ﬁle
AF Technique #6
Restricted Filenames
Even Windows 7 still has holdovers from DOS days: 
Restricted ﬁlenames
CON
PRN
AUX
NUL
COM1, COM2, COM3, COM#
LPT1, LPT2, LPT#
Use these ﬁlenames liberally
 1 hour
 $300
Windows 7 still has parts of DOS in it
This wonʼt take up too much time but will still frustrate the investigator.
Heʼll likely ﬁgure out whatʼs wrong in less than an hour, but will bill a full hour 
of work for it.
Creating Restricted Filenames
Access NTFS volume via UNC
\\host\C$\Folder
Call Windows API function MoveFile manually from a 
custom app (Kernel32.lib)
Boot from Linux with NTFS support and mv the ﬁle
 45 hours
 $13,500
You can’t just create a ﬁle with a restricted name. You need to trick 
Windows into doing it
Mitigating
Restricted Filenames
Never export ﬁles with native ﬁlenames
Always specify a different name
FTK 4 does this by default (1.jpg)
Export by FileID or other automatically generated name
 45 hours
 $13,500
Your analysis machine should go by your rules. You make up the ﬁlenames.
AF Technique #7
Circular References
Folders in folders have typical limit of 255 characters 
on NTFS
“Junctions” or “Symbolic Links” can point to a parent
C:\Parent\Child\Parent\Child....
Store criminal data in multiple nested ﬁles/folders
 4 hours
 $1,200
When a circular reference is followed, it could cause programs to enter an 
inﬁnite loop.
Other programs may detect that the path theyʼre trying to access is > 255 
characters and throw an exception
Circular References
Tools that use HDD images don’t bat an eye (FTK4, 
EnCase) 
Many tools that recursively scan folders are affected by 
this attack
“Field Triage” and “Remote Analysis” methodologies 
are affected
 49 hours
 $14,700
Reminder: The 3 Methodologies are: 
* Image Everything, Analyze Later
* Field Triage to decide what to image
* Remote Analysis, target only evidence you need
Mitigating
Circular References
Always work from an image
Be mindful of this attack when dealing with an 
attacker’s live system
Just knowing about it will help you recognize it
 49 hours
 $14,700
AF Technique #8
Broken Log Files
Many investigators process log ﬁles with tools
These tools use string matching or
Regular Expressions
Use ƒuñ ÅsçÎÍ characters in custom messages
Commas, “quotes” and |pipes| make parsing difﬁcult
Use eLfL (0x654c664c) in Windows Event Logs
 6 hours
 $1,800
eLfL is the 4byte header for Windows Event Logs
It marks the start of an eventlog record
Throwing these characters in the middle of a record will confuse some 
parsers into thinking a new entry has begun
Mitigating
Broken Log Files
Do you need the log? Try to prove your point without it
Parse the few pertinent records manually and 
document your methodology
At worst, write a small app/script to parse it the way 
you need it to be parsed
 51 hours
 $15,300
Zeroing in on the speciﬁc records you need is a lot better than parsing the 
whole log
AF Technique #9
Use Lotus Notes
NSF ﬁles and their .id ﬁles are headaches
There are many tools to deal with NSFs
Every one of them has its own problems
 6 hours
 $1,800
Lotus Notes uses NSF ﬁles to hold emails, similar to PST ﬁles.
ID ﬁles include a user ID and an encryption key that can be unlocked 
with the userʼs password
2hrs per custodian
Lotus Notes
Most apps use IBM’s own Lotus Notes dlls/API to work 
with NSF ﬁles
When opening each
encrypted NSF, the API raises
the password dialog:
Examiners/eDiscovery operators must select
the user’s ID ﬁle and type the associated password
for every NSF ﬁle being processed
 57 hours
 $17,100
The password dialog is raised in an interactive context, even when 
automated
The moment the API is used to open an NSF ﬁle, this dialog is presented to 
the user
This means you canʼt easily script NSF processing
Mitigating
Lotus Notes
Train yourself on Lotus Notes itself
Do not rely on NSF conversion tools
Lotus Notes is the best NSF parser but has its quirks
Once you know the quirks you can navigate around 
them
 57 hours
 $17,100
Load up each NSF manually and deal with it using your own keyboard and 
mouse
Print the notable emails to PDF to be included in your report/afﬁdavit
#5. Report Your Findings
Confounding the reporting process
“Separate 
Wheat From 
Chaff”
Process Data 
For Analysis
Prepare Report 
on Findings
Archive Data 
For Future
Create 
Working Copy
Analyze Data 
For Relevance
 57 hours
 $17,100
Reporting didnʼt seem to have many hacks at ﬁrst until I started thinking 
about it....
AF Technique #10
HASH Collisions
MD5 and SHA1 hashes are used to locate ﬁles
Add dummy data to your criminal ﬁles so its MD5 hash 
matches known good ﬁles
Searching by hash will yield unexpected results
badﬁle.doc    e4d909c290d0fb1ca068ffaddf22cbd0
goodﬁle.doc  e4d909c290d0fb1ca068ffaddf22cbd0
 2 hours
 $600
What if you match your bad stuff with rundll.dll?
NSRL will suppress it!
Hash Collisions
Of course, this would only be useful in a select few cases:
i.e. you stole company data and stored on a volume 
they could seize/search
Try explaining why GoodFile.doc and BadFile.doc have 
identical hashes to judges/justices/arbiters/non-techies
could provide just-the-right-amount of
‘reasonable doubt’
 59 hours
 $17,700
Hash Collisions (cont.)
Lots of work has been done on this already
Marc Stevens of the Technische Universiteit Eindhoven
developed HashClash for his Masters Thesis in 2008
Other tools that exploit this are available
 59 hours
 $17,700
Most of the research into MD5 collisions is a result of Marc’s 2008 
paper
Mitigating
HASH Collisions
Use a hash function with fewer collisions (SHA256, 
Whirlpool)
Doublecheck your ﬁndings by opening each matched 
ﬁle to verify the search was REALLY a success
boy would your face be red!
 59 hours
 $17,700
Always doublecheck your ﬁndings!
Never rely on hash matches to guarantee youʼve found the ﬁle youʼre looking 
for
AF Technique #11
 Dummy HDD
PC with an HDD that isn’t used
USB-boot and ignore the HDD for everyday use
Persist work on cloud/remote machine
Mimic regular usage of dummy HDD with random 
writes. Use a daemon/service
 3 hours
 $900
Using your computer without a hard drive is very easy nowadays thanks to 
large removable media
Dummy HDD (cont.)
Dummy daemon/service can:
Retrieve news webpages and write cache to HDD
Sync mail with a benign/legit mail account
Execute at random intervals
As long as the HDD has ‘recent’ entries, the 
investigator will think it’s been used recently
 62 hours
 $18,600
Creating a “dummy service” can simulate recent usage of a computer
Mitigating
Dummy HDDs
Always check for USB drives in USB
slots AND on motherboards.
They can be SMALL these days...
Pageﬁle on USB drive may point to network locations
(if the OS was paging at all...)
If possible, monitor network trafﬁc before seizure to 
detect remote drive location
 62 hours
 $18,600
Look on the motherboard itself and identify every USB header.
Follow all USB cables to the external ports on the case.
Donʼt be fooled!
#6. Archive Data For Future
Confounding the archiving process
“Separate 
Wheat From 
Chaff”
Process Data 
For Analysis
Archive Data 
For Future
Create 
Working Copy
Analyze Data 
For Relevance
Prepare Report 
On Findings
 62 hours
 $18,600
In the event a case is challenged in a year or two, ﬁrms need to archive data 
for the future
Technique #1
Data Saturation
Same as Technique #1
The more data you have,
the more they need to keep
We’ve come full circle
 1 hours
 $20/mo per HDD
3 HDDs per month = $60
3 HDDs per year = $720
Budget Overrun
We’ve taken up roughly 63 hours of an investigator’s 
time
That’s more than 8 workdays, without overtime
This extra time was spent trying to image drives, export 
ﬁles, read email, and perform other menial tasks
The investigator still needs to do his regular work!
Increased likelihood that opposing council will settle
 63 hours
 $18,900 + 
$~720/yr
Questions
Have you encountered frustration in your 
examinations?
How did you deal with it?
I’d love to hear about it in the speaker Q&A room!
Thanks!
Thanks DEFCON for letting me speak
Thanks:
Forensic Friends (Josh, Joel, Nick)
Family
Coworkers
You!
Slide Availability
The slides on your CD are outdated
You can grab this latest version of these slides from:
http://www.perklin.ca/~defcon20/
perklin_antiforensics.pdf
References
Berinato, Scott. June 8, 2007. The Rise of Anti-Forensics.
Last accessed on June 12, 2012 from 
Max. July 3, 2011. Disk Wiping with dcﬂdd.
Last accessed on June 12, 2012 from 
The grugq. Unknown Date. Modern Anti-Forensics.
Last accessed on June 12, 2012 from 
Henry, Paul. November 15, 2007. Anti-Forensics.
Last accessed on June 12, 2012 from 
Garﬁnkel, Simson. 2007. Anti-Forensics: Techniques, Detection, and Countermeasures.
Last accessed on June 12, 2012 from 
Kessler, Gary. 2007. Anti-Forensics and the Digital Investigator.
Last accessed on June 12, 2012 from 
Hilley, S. 2007. Anti-Forensics with a small army of exploits.
Last accessed on June 12, 2012 from 
References (cont.)
Dardick, G., La Roche, C., Flanigan, M. 2007. BLOGS: Anti-Forensics and Counter Anti-Forensics.
Last accessed on June 12, 2012 from 
Hartley, Matthew. August, 2007. Current and Future Threats to Digital Forensics.
Last accessed on June 12, 2012 from 
Perklin, Michael. April 26, 2012. Anti-forensics:  Techniques that make our lives difﬁcult, and what we can do to mitigate them. 
Presented at HTCIA Ontario Chapter, Brampton, ON. Canada.
Peron, C., Legary, M. . Digital Anti-Forensics: Emerging trends in data transformation techniques.
Last accessed on June 12, 2012 from 
Stevens, M. June, 2007. On Collisions for MD5.
Last accessed on June 12, 2012 from 
Foster, J., Liu, V. July 2005. Catch Me If You Can: Exploiting Encase, Microsoft, Computer Associates, and the rest of the bunch…
Last Accessed on June 12, 2012 from 
Moulton, S. July 2009. RAID Recovery: Recover your PORN by sight and sound.
Last Accessed on June 12, 2012 from 