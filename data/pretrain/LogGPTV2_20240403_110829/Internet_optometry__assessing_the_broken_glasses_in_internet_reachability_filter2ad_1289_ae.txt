not suggest a very large inﬂuence of the probing location. We set up
two test-boxes in the US, one located in Seattle on the West Coast,
and one in Ashburn on the East Coast. We had another test-box in
Tokyo, Japan and one located in Wellington, New Zealand. Com-
paring the results from those locations, we found that in 93.75% of
the cases, the location did not matter at all.
We compared the three measurement campaigns and only for
0.55% of the cases, we observed a difference between the locations
during all three campaigns. This is not a very signiﬁcant proportion
of our pingable IP addresses, especially in the light of measurement
artifacts, e.g. inaccurate IP to AS mapping or ICMP related mea-
surement artifacts. We observed differences between the locations
during one campaign in 4.2% of the cases and during two cam-
paigns in 1.5% of the cases. Given our results, we cannot claim that
there are signiﬁcant differences between locations. Making conﬁ-
dent inferences about why differences are observed in reachability
is very difﬁcult without additional information.
So far we talked about differences between locations on an IP ad-
dress basis, but many ﬁltering policies are implemented AS-wide.
For instance, network administrators typically place bogon ﬁlters
at all their border routers. While these ﬁlters affect certain preﬁxes,
we are looking for the ASes that are conﬁguring those ﬁlters, not
their victims. Similarly, router misconﬁgurations [21] and routing
instabilities [22] often exhibit large differences on a per-AS ba-
sis. Many reachability problems can be seen at the AS granularity,
without delving into individual IPs.
In this case it is good to have several IP addresses to probe within
an AS to compare their results. We noticed that for 84.9% of all
probed ASes, all IPs within those ASes show no differences be-
tween the probing locations. If there are differences, this typically
affects only very few IPs out of the set of probed IPs within that
AS. This suggests that measurement artifacts are more likely to be
the cause of inconsistencies between probing sites than differences
in reachability.
6.2
IP to AS number mapping
A general issue we encountered during all experiments is the
mapping of IP to AS number, e.g., [23–26]. To determine the AS
number corresponding to an IP address, one performs a lookup in
BGP routing tables. However, it is common that customer routers
get upstream-facing IP addresses from their provider’s address space.
Thus, when a probe enters the customer AS, the response comes
from an IP address that still belongs to the provider’s address space,
which is managed by the customer. In our dual probing for example
(Section 5.2), the ping initiated from the anchor preﬁx would indi-
cate, incorrectly, that the customer router belongs to the provider’s
AS. If the customer does not respond to the test-preﬁx probe, but
their upstream provider would, we would mis-diagnose that the
provider’s IP address did not respond.
Not only does the IP to AS mapping create issues such as the
one mentioned before, but changes in the advertised address space
require us to monitor changes in the mappings. We observed the
changes in mapping over time during the default routing experi-
ment (Section 3). We ﬁrst performed an IP to AS mapping of our IP
address list in 2007, and compared it with another mapping based
on a set of BGP routing tables from RIPE and Routeviews from the
same period as the default routing experiment in 2009. We noticed
that on a per-preﬁx basis things changed quite a bit from 2007 to
2009. Only 88.0% of the preﬁxes still had the same mapping in
2009. 7.43% of the preﬁxes were not in the BGP routing tables
anymore. By this we mean exact matches of a given preﬁx. If for
some reason the preﬁx was not visible in RIPE or Routeviews but
only a more or less speciﬁc preﬁx was in the table on that day, it ap-
pears as if the preﬁx is not in the routing table. In less than 0.5% of
the cases, a preﬁx showed multiple origin ASes (MOAS). MOAS
preﬁxes are problematic as we typically do not necessarily know
on which AS number they react to.
IP to AS number mapping can also be a general problem in the
default route methodology. Imagine we probe IP1, which we have
mapped to AS 1, but which would actually belong within AS 2.
If we do AS path poisoning with AS 1, IP1 would reply (as its
administratively with AS 2) and therefore we mis-classify AS 1 as
having default.
2516.3 What type of probe to use?
When designing an experiment based on active probing, one of
the basic questions one has to answer is which probing tool to use,
e.g. ping or traceroute? In theory, ping should be sufﬁcient if one is
primarily concerned to know if the probed address space has reach-
ability towards the tested address space. In case reachability cannot
be established, neither ping nor traceroute will give the information
we want most – the return path taken by the probes. Predicting this
return path can be done only very partially by leveraging the record-
route option and using forward probing from different locations [2].
The limited number of locations from which probing can be done
in practice implies that guessing the reverse path of traceroutes will
typically be a highly underconstrained inference problem. Only a
tool that will record the full path of the probe and its answer will
solve this limitation.
ICMP vs. UDP.
When relying on ping probes, the type of packet (ICMP, UDP, or
TCP) used affects signiﬁcantly the chance of obtaining an answer.
We observed the responsiveness of both ICMP and UDP probes
during the three measurement campaigns of the bogon ﬁltering ex-
periment (Section 5.2). We found similar results across the three
campaigns. For ICMP, roughly 70% of the IP addresses were reach-
able. For UDP, the responsiveness was only 30%. By compar-
ing those unsuccessful UDP probes with the corresponding ICMP
probe that reached the destination, we observed that 74% of those
UDP probes stopped one hop before the destination. The UDP
probes are probably ﬁltered by ﬁrewalls or NATs before reaching
the target IP address. We observed that 90% of those UDP probes
got ﬁltered either at the destination hop or exactly one IP-hop be-
fore, and 98% got ﬁltered less than two IP-hops away from the the
destination. We also tried TCP, but the responsiveness of our probes
was even worse than UDP – around 5%, likely for similar reasons.
We conﬁrm the results from [20] that also found ICMP probes
superior to UDP and TCP. However, the responsiveness of the IP
addresses we probed is quite different from what is reported in [20].
The difference between our results and those from [20] probably
lies in the type of hosts probed. We chose our pingable IP ad-
dresses in such a way that we cover as many ASes in the Internet
as possible. The authors of [20] were targeting speciﬁcally the re-
sponsiveness of routers and did not aim at a wide coverage of ASes.
7. RELATED WORK
This work addresses one of the most fundamental services of the
Internet: reachability. It is therefore not surprising to see numerous
papers and presentations. Some of those studies are interested in
how “happy” the packets are [3, 27]. Most recent works have stud-
ied pathological behaviors related to the address space, e.g. bogon
advertisements [8, 28], hijacking [29, 30], misconﬁgurations [31],
or DDoS attacks [32].
However, most research studies have so far concentrated on BGP
[33]. Slow BGP convergence [34, 35], issues with policy rout-
ing [36], oscillations in BGP [37], and routing instabilities [22] are
among the many problems encountered.
Few have looked at the data plane as a means of exploring the
control plane, though [38] explores some issues of preﬁx propaga-
tion similar to our testing of a /25 preﬁx.
Researchers and practitioners either have to gather their own data
or rely upon data collected by various sources, such as CAIDA’s
Skitter successor, Archipelago [11], and large BGP data collec-
tion projects like RIPE Routing Information Service [39] or Ore-
gon RouteViews [40], or Team Cymru’s services [26]. Available
datasets have such partial visibility of the Internet topology [41,42]
that it is unwise to rely on them to debug reachability.
Few tools are available to debug reachability, ping and traceroute
are the most widely used today. Those tools suffer from important
limitations, which are hardly compensated by trying to obtain part
of the reverse path [2]. Ping can be ﬁltered by ﬁrewalls and NATs.
In addition, ping probes between any two hosts, cannot conﬁrm that
reachability is bug-free. If some routers do not propagate routes for
part of the address space, routing will try to ﬁnd paths around the
problematic regions. In that case, routing will use a "suboptimal
path". Often this is not considered when we are concerned with
simple reachability, but suboptimal routing may result in intermit-
tent problems as packets are rerouted and these are very hard to
debug by normal means.
Traceroute reveals paths, but also has many limitations. Dynam-
ics in the routing paths or load-balancing are only partially visible
by traceroute [19]. The record route option in IP packets [43, 44]
provides another way to sample the forward path from a host to-
wards a probed host though it is not always supported, and has hop
distance limitations [14]. Most importantly for this study no tech-
nique known today measures the return path from the probed host
towards the probing host. The reverse path would give valuable
information about the suboptimal routing, but we are restricted (in
ﬁnding this information) to public traceroute servers that can create
a forward path towards our test equipment.
8. CONCLUSION AND FUTURE WORK
In this paper we discussed the biases and practices that make
reachability more complex than it appears from publicly available
BGP data. Our experiments show that data-plane reachability is
different from control plane visibility. Features such as default
routing are common, and provide alternative means for packets to
reach their destination even when a route has failed to propagate
widely.
We have also explained the need for improved methodologies
when debugging reachability issues. We showed that because of the
limitations of current probing tools, building methodologies to de-
bug reachability issues requires far more care and effort than might
be expected by the networking community. We present two tech-
niques that have been very useful in our context: route poisoning,
and dual probing.
Our work clearly supports more work towards better assessments
of data plane and control plane performance and their interactions.
For instance, we believe that our results shed light on unexpected
results about data plane behavior [3] that revealed non-trivial rela-
tionships between the data plane and the control plane.
Acknowledgments
We are grateful to all network operators around the world for their
feedback and ARIN for loaning previously unallocated preﬁxes to
us. In addition we thank David Ward, Ed Kern, Gert Doering and
SpaceNet, Andy Linton and Citylink, Matsuzaki Yoshinobu and
IIJ. This project has been made possible in part by a gift from The
Cisco University Research Program Fund, and by the Australian
Research Council through grant DP0665427, as well as the G-lab
project, a research project of the DFG in Germany (support code
01 BK 0805).
2529. REFERENCES
[1] R. Oliveira, D. Pei, W. Willinger, B. Zhang, and L. Zhang,
“In Search of the elusive Ground Truth: The Internet’s
AS-level Connectivity Structure,” in Proceedings of ACM
SIGMETRICS, (Annapolis, USA), June 2008.
[2] E. Katz-Bassett, H. Madhyastha, V. Adhikari,
A. Krishnamurthy, and T. Anderson, “Reverse traceroute.”
Under submission, 2009.
[3] F. Wang, Z. M. Mao, J. Wang, L. Gao, and R. Bush, “A
Measurement Study on the Impact of Routing Events on
End-to-End Internet Path Performance,” in Proc. ACM
SIGCOMM, 2006.
[4] L. Colitti, Internet Topology Discovery Using Active
Probing. PhD thesis, University di "Roma Tre", 2006.
[5] R. Oliveira and B. Zhang, “IRL - Internet Topology
Collection,” 2009. http://irl.cs.ucla.edu/topology/.
[6] R. Oliveira, B. Zhang, and L. Zhang, “Observing the
Evolution of Internet AS Topology,” in Proceedings of ACM
SIGCOMM, August 2007.
[7] M. Roughan, S. Tuke, and O. Maennel, “Bigfoot, sasquatch,
the yeti and other missing links: what we don’t know about
the AS graph,” inProc. ACM SIGCOMM IMC, 2008.
[8] N. Feamster, J. Jung, and H. Balakrishnan, “An empirical
study of bogon route advertisements,” ACM Comput.
Commun. Rev., vol. 35, no. 1, pp. 63–70, 2005.
[9] N. Spring, R. Mahajan, and D. Wetherall, “Measuring ISP
Topologies with Rocketfuel,” in Proc. ACM SIGCOMM,
2002.
[10] M. Caesar and J. Rexford, “BGP routing policies in ISP
networks,” IEEE Network, vol. 19, no. 6, 2005.
[11] K. Claffy, Y. Hyun, K. Keys, M. Fomenkov, and
D. Krioukov, “Internet mapping: From art to science,” in
Proc. of IEEE Conference For Homeland Security,
Cybersecurity Applications & Technology, 2009.
[12] R. Govindan and H. Tangmunarunkit, “Heuristics for
Internet map discovery,” in Proc. IEEE INFOCOM, 2000.
[13] Y. Shavitt and E. Shir, “DIMES: let the Internet measure
itself,” ACM CCR, vol. 35, no. 5, pp. 71–74, 2005.
[14] R. Sherwood, A. Bender, and N. Spring, “Discarte: a
disjunctive Internet cartographer,” in Proceedings of ACM
SIGCOMM, 2008.
[15] J. Heidemann, Y. Pradkin, R. Govindan, C. Papadopoulos,
G. Bartlett, and J. Bannister, “Census and survey of the
visible Internet,” in Proc. ACM SIGCOMM IMC,
pp. 169–182, 2008.
[16] B. Donnet, P. Raoult, T. Friedman, and M. Crovella,
“Efﬁcient algorithms for large-scale topology discovery,” in
Proc. of ACM SIGMETRICS, pp. 327–338, 2005.
[17] B. Donnet and T. Friedman, “Internet topology discovery: a
survey,” IEEE Communications Surveys and Tutorials,
vol. 9, pp. 2–15, December 2007.
[18] A. Zeitoun and S. Jamin, “Rapid exploration of Internet live
address space using optimal discovery path,” in Proc. Global
Communications Conference, 2003.
[19] B. Augustin, X. Cuvellier, B. Orgogozo, F. Viger,
T. Friedman, M. Latapy, C. Magnien, and R. Teixeira,
“Avoiding traceroute anomalies with Paris traceroute,” in
Proceedings of the 6th ACM SIGCOMM on Internet
measurement, 2006.
[20] M. H. Gunes and K. Saraç, “Analyzing router responsiveness
to active measurement probes,” in Proc. of Passive and
Active Measurement conference (PAM), 2009.
[21] R. Mahajan, D. Wetherall, and T. Anderson, “Understanding
BGP Misconﬁgurations,” in Proc. ACM SIGCOMM,
September 2002.
[22] A. Feldmann, O. Maennel, Z. Mao, A. Berger, and
B. Maggs, “Locating Internet routing instabilities,” in Proc.
ACM SIGCOMM, (Portland, OR), 2004.
[23] Z. M. Mao, J. Rexford, J. Wang, and R. H. Katz, “Towards
an accurate AS-level traceroute tool,” in Proc. ACM
SIGCOMM, 2003.
[24] H. Chang, S. Jamin, and W. Willinger, “Inferring AS-level
Internet topology from router-level path traces,” in
Proceedings of SPIE ITCom, 2001.
[25] Y. H. Andre, Y. Hyun, A. Broido, and K. Claffy, “On
third-party addresses in traceroute paths,” 2003.
[26] Team Cymru. http://www.team-cymru.org/.
[27] V. Paxson, “End-to-end routing behavior in the Internet,”
IEEE/ACM Trans. Networking, 1997.
[28] C. Labovitz and A. Ahuja, “Shining Light on Dark Internet
Address Space,” NANOG 23, 2001.
[29] M. Lad, D. Massey, D. Pei, Y. Wu, B. Zhang, and L. Zhang,
“PHAS: A preﬁx hijack alert system,” in Proc. of the 15th
USENIX Security Symposium, 2006.
[30] P. Boothe, J. Hiebert, and R. Bush, “How Prevalent is Preﬁx
Hijacking on the Internet?,” NANOG 36, February 2006.
[31] D. Wetherall, R. Mahajan, and T. Anderson, “Understanding
BGP misconﬁgurations,” in Proc. ACM SIGCOMM, 2002.
[32] Y. Chen, A. Bargteil, D. Bindel, R. Katz, and J. Kubiatowicz,
“Quantifying network denial of service: A location service
case study,” in Proc. of ICICS, 2001.
[33] T. G. Grifﬁn Interdomain routing links. http:
//www.cl.cam.ac.uk/users/tgg22/interdomain/.
[34] C. Labovitz, R. Malan, and F. Jahanian, “Internet routing
instability,” IEEE/ACM Trans. Networking, 1998.
[35] Z. M. Mao, R. Govindan, G. Varghese, and R. Katz, “Route
ﬂap damping exacerbates Internet routing convergence,” in
Proc. ACM SIGCOMM, 2002.
[36] T. G. Grifﬁn and G. Huston, “BGP Wedgies.” RFC 4264,
2005.
[37] D. McPerson, V. Gill, D. Walton, and A. Retana, “Border
Gateway Protocol (BGP) Persistent Route Oscillation
Condition.” Internet Engineering Task Force, RFC 3345,
August 2002.
[38] R. Beverly and S. Bauer, “The spoofer project: Inferring the
extent of source address ﬁltering on the internet,” in
Proceedings of USENIX SRUTI workshop, July 2005.
[39] RIPE’s Routing Information Service.
http://www.ripe.net/ris/.
[40] University of Oregon RouteViews project.
http://www.routeviews.org/.
[41] A. Lakhina, J. Byers, M. Crovella, and P. Xie, “Sampling
biases in IP topology measurements,” in Proc. IEEE
INFOCOM, (San Francisco, CA), April 2003.
[42] H. Chang, R. Govindan, S. Jamin, S. Shenker, and
W. Willinger, “Towards capturing representative AS-level
Internet topologies,” Computer Networks, Elsevier, vol. 44,
April 2004.
[43] J. Postel, “Internet protocol speciﬁcation.” Internet
Engineering Task Force, RFC791, September 1981.
[44] F. Baker, “Requirements for IP version 4 routers.” Internet
Engineering Task Force, RFC1812, June 1995.
253