less NFC payment [40, 41] and online mobile wallet pay-
ment [52, 12], has been studied. NFC-based payment has
been adopted by the major phone vendors, like Google
and Apple. Attack [37, 8, 9] and defense [18, 38, 47]
techniques regarding this channel have been investigated,
but none of them are similar to our STLS attack. Due
to its extremely short communication distance and the
challenge-response based bidirectional communication
pattern, NFC payment is not affected here.
Users’ perception of the emerging mobile payment
techniques is also investigated and studied. These studies
show that several factors could impede the adoption of
mobile payment methods, including their security, usabil-
ity, and cost [32, 45, 19].
7 Conclusion
In this paper, we present a new threat called STLS which
can enable adversaries to attack off-line payment schemes
by snifﬁng payment token, aborting current transaction,
and spending the stolen token at other places. We have
investigated some leading off-line payment systems in
real world and demonstrated that such STLS attacks are
completely realistic. We also carreid out security analysis,
which reveals some major limitations of existing token
protection techniques. Contrary to the closed settings of
traditional payment systems, off-line mobile payment so-
lutions have larger attacking surface. Channels between
smartphone and POS terminal are susceptible to snifﬁng
attack. Communications between mobile POS and back-
end servers are built on WiFi or 3G/4G network, thus
the ongoing transactions can be disrupted. More impor-
tantly, most token delivering channels are one-way only,
so tokens cannot be bound to the POS terminal of cur-
rent transaction. Meanwhile, shortening the token valid
period only still cannot guarantee adequate payment se-
curity. To mitigate STLS threats, we propose POSAUTH
which forces a payment token to include the unique ID
of current POS terminal and, when combined with short
valid period, is able to conﬁne a token to be used in le-
gitimate transactions only. In the future, we plan to work
with merchants and deploy POSAUTH in real-world POS
systems.
Acknowledgments
We thank anonymous reviewers for their precious com-
ments. Authors from Tsinghua University are supported
in part by Research Grant of Beijing Higher Institu-
tion Engineering Research Center. The project is also
supported in part by NSFC (Grant No. 61572415),
NSF CNS-1223477, 1223495, 1527141, 1618493, ARO
W911NF1610127, and the General Research Funds
(Project No. 14217816 and 24207815) established un-
der the University Grant Committee of the Hong Kong
Special Administrative Region, China.
References
[1] Supporting materials: Stls in mobile payment. https://sites.
[Online; ac-
google.com/site/stlsinmobilepayment/.
cessed 14-Feb-2017].
[2] 21, A. Ansi/iso alpha and bcd data format. http://www.
abacus21.com/Magnetic-Strip-Encoding-1586.html.
[Online; accessed 19-Jan-2017].
[3] ALVADOR MENDOZA. Samsung Pay: Tokenized Numbers, Flaws
and Issues. Tech. rep., 2016.
[4] APPLIDIUM. Audio modem: data over sound.
https:
//applidium.com/en/news/data_transfer_through_
sound/, 2013. [Online; accessed 19-Jan-2017].
[5] BRIDG. Bridg. https://www.bridgtheapp.com.
accessed 19-Jan-2017].
[Online;
[6] CHOI, D., AND LEE, Y. Eavesdropping one-time tokens over
magnetic secure transmission in samsung pay. In Proceedings of
the 10th USENIX Conference on Offensive Technologies (2016),
USENIX Association, pp. 52–58.
[7] DE, P., DEY, K., MANKAR, V., AND MUKHERJEA, S. An as-
sessment of qr code as a user interface enabler for mobile payment
apps on smartphones. In Proceedings of the 7th International
Conference on HCI, IndiaHCI 2015 (2015), ACM, pp. 81–84.
[8] DRIMER, S., MURDOCH, S. J., ET AL. Keep your enemies close:
Distance bounding against smartcard relay attacks. In USENIX
Security (2007), vol. 2007, pp. 87–102.
[9] EMMS, M., AND VAN MOORSEL, A. Practical attack on contact-
less payment cards. In HCI2011 Workshop-Heath, Wealth and
Identity Theft (2011).
[10] FUJIAN NEWLAND AUTO-ID TECH. CO., L. Nls-fr40. http:
//www.newlandaidc.com/h-pd-j-70-3_10.html. [Online;
accessed 19-Jan-2017].
[11] GAO, J., KULKARNI, V., RANAVAT, H., CHANG, L., AND MEI,
H. A 2d barcode-based mobile payment system. In Multimedia
and Ubiquitous Engineering, 2009. MUE’09. Third International
Conference on (2009), IEEE, pp. 320–329.
[12] GAO, J. Z., CAI, J., LI, M., AND VENKATESHI, S. M. Wireless
payment–opportunities, challenges, and solutions. Published by
High Technology Letters 12 (2006).
[13] GARG, G. Qr code payment introduction. http://scanova.io/
[Online; ac-
blog/blog/2015/04/08/qr-code-payment/.
cessed 19-Jan-2017].
[14] GOOGLE. Fileobserver. https://developer.android.com/
reference/android/os/FileObserver.html.
[15] GOOGLE.
Flag secure.
https://developer.android.
com/reference/android/view/WindowManager.
LayoutParams.html#FLAG_SECURE.
[Online;
19-Jan-2017].
accessed
606    26th USENIX Security Symposium
USENIX Association
[16] GOOGLE.
Google
tone.
https://chrome.
google.com/webstore/detail/google-tone/
nnckehldicaciogcbchegobnafnjkcne?hl=en.
accessed 19-Jan-2017].
[Online;
[17] GOOGLE.
System alert window.
https://developer.
android.com/reference/android/Manifest.
permission.html#SYSTEM_ALERT_WINDOW.
cessed 19-Jan-2017].
[Online; ac-
[18] HALEVI, T., MA, D., SAXENA, N., AND XIANG, T. Secure
proximity detection for nfc devices based on ambient sensor data.
In European Symposium on Research in Computer Security (2012),
Springer, pp. 379–396.
[19] HUH, J. H., VERMA, S., RAYALA, S. S. V., BOBBA, R.,
BEZNOSOV, K., AND KIM, H. I don’t use apple pay because
it’s less secure...: Perception of security and usability in mobile
tap-and-pay.
L.
nearﬁeld
[20] INC,
band
http://www.google.com/patents/US8814046, 2014.
accessed 19-Jan-2017].
base-
transmitter.
[Online;
System and method
magnetic
stripe
data
for
a
[21] INTELLIGENCE, B.
mpos us installation base.
http:
//www.businessinsider.com/square-makes-another-
play-at-retailers-2017-2.
2017].
[Online; accessed 16-Feb-
[22] KALEBKE.
Gyroscopeexplorer.
KalebKE/GyroscopeExplorer.
2017].
https://github.com/
[Online; accessed 19-Jan-
[23] KHARRAZ, A., KIRDA, E., ROBERTSON, W., BALZAROTTI, D.,
AND FRANCILLON, A. Optical delusions: A study of malicious
qr codes in the wild. In Dependable Systems and Networks (DSN),
2014 44th Annual IEEE/IFIP International Conference on (2014),
IEEE, pp. 192–203.
[24] KIESEBERG, P., LEITHNER, M., MULAZZANI, M., MUNROE,
L., SCHRITTWIESER, S., SINHA, M., AND WEIPPL, E. Qr code
security. In Proceedings of the 8th International Conference on
Advances in Mobile Computing and Multimedia (2010), ACM,
pp. 430–435.
[25] KOVACS, E.
Samsung has one day token lifetime.
http://www.securityweek.com/samsung-pay-token-
flaw-allows-fraudulent-transactions.
accessed 16-Feb-2017].
[Online;
[26] KROMBHOLZ, K., FRÜHWIRT, P., KIESEBERG, P., KAPSALIS,
I., HUBER, M., AND WEIPPL, E. Qr code security: A survey
of attacks and challenges for usable security. In International
Conference on Human Aspects of Information Security, Privacy,
and Trust (2014), Springer, pp. 79–90.
[27] L., K.
Hidden risks with 2d qr
code payment.
https://www.linkedin.com/pulse/20140907174521-
104874410-hidden-risks-with-2d-qr-code-payment.
[Online; accessed 12-Feb-2017].
[28] LEE, J., CHO, C.-H., AND JUN, M.-S. Secure quick response-
payment (qr-pay) system using mobile device. In Advanced Com-
munication Technology (ICACT), 2011 13th International Confer-
ence on (2011), IEEE, pp. 1424–1427.
[29] LEE, Y. S., KIM, N. H., LIM, H., JO, H., AND LEE, H. J. Online
banking authentication system using mobile-otp with qr-code.
In Computer Sciences and Convergence Information Technology
(ICCIT), 2010 5th International Conference on (2010), IEEE,
pp. 644–648.
[30] LIAO, K.-C., AND LEE, W.-H. A novel user authentication
scheme based on qr-code. JOURNAL OF NETWORKS 5, 8 (2010),
937.
[31] LIÉBANA-CABANILLAS, F., RAMOS DE LUNA,
I., AND
MONTORO-RÍOS, F. J. User behaviour in qr mobile payment
system: the qr payment acceptance model. Technology Analysis
& Strategic Management 27, 9 (2015), 1031–1049.
[32] LINCK, K., POUSTTCHI, K., AND WIEDEMANN, D. G. Security
issues in mobile payment from the customer viewpoint.
[33] LOOPPAY. Looppay faq. https://www.looppay.com/faqs/.
[Online; accessed 19-Jan-2017].
[34] LTD, A. Chirp. http://chirp.io, 2013. [Online; accessed
19-Jan-2017].
[35] LTD, O. W. R.
http://www.
oxfordwaveresearch.com/products/spectrumviewapp/.
[Online; accessed 19-Jan-2017].
Spectrumview.
[36] MA, T., ZHANG, H., QIAN, J., HU, X., AND TIAN, Y. The de-
sign and implementation of an innovative mobile payment system
based on qr bar code. In Network and Information Systems for
Computers (ICNISC), 2015 International Conference on (2015),
IEEE, pp. 435–440.
[37] MARKANTONAKIS, K., FRANCIS, L., HANCKE, G., AND
MAYES, K. Practical relay attack on contactless transactions by
using nfc mobile phones. Radio Frequency Identiﬁcation System
Security: RFIDsec 12 (2012), 21.
[38] MEHRNEZHAD, M., HAO, F., AND SHAHANDASHTI, S. F. Tap-
tap and pay (ttp): preventing the maﬁa attack in nfc payment. In
International Conference on Research in Security Standardisation
(2015), Springer, pp. 21–39.
[39] NSEIR, S., HIRZALLAH, N., AND AQEL, M. A secure mobile
payment system using qr code. In Computer Science and Infor-
mation Technology (CSIT), 2013 5th International Conference on
(2013), IEEE, pp. 111–114.
[40] ONDRUS, J., AND PIGNEUR, Y. An assessment of nfc for future
mobile payment systems. In Management of Mobile Business,
2007. ICMB 2007. International Conference on the (2007), IEEE,
pp. 43–43.
[41] PASQUET, M., REYNAUD, J., ROSENBERGER, C., ET AL. “pay-
ment with mobile nfc phones” how to analyze the security prob-
lems. In 2008 International Symposium on Collaborative Tech-
nologies and Systems.(see section 2) (2008).
[42] RAMPTON,
J.
the mobile payment.
https://techcrunch.com/2016/06/17/the-evolution-
of-the-mobile-payment/. [Online; accessed 16-Feb-2017].
The evolution of
[43] SAMSUNG.
Samsung pay faq.
http://security.
samsungmobile.com/doc/Press_Guidance_Samsung_
Pay.pdf. [Online; accessed 19-Jan-2017].
[44] SAMSUNG. Samsung’s looppay: What it is, and why you should
care. https://www.cnet.com/news/samsungs-looppay-what-it-is-
and-why-you-should-care/.
[45] SCHIERZ, P. G., SCHILKE, O., AND WIRTZ, B. W. Under-
standing consumer acceptance of mobile payment services: An
empirical analysis. Electronic commerce research and applica-
tions 9, 3 (2010), 209–216.
[46] SHARMA, V. A study of malicious qr codes. International Jour-
nal of Computational Intelligence and Information Security 3, 5
(2012), 21–26.
[47] SHRESTHA, B., SAXENA, N., TRUONG, H. T. T., AND ASOKAN,
N. Drone to the rescue: Relay-resilient authentication using
ambient multi-sensing. In International Conference on Financial
Cryptography and Data Security (2014), Springer, pp. 349–364.
[48] STARNBERGER, G., FROIHOFER, L., AND GÖSCHKA, K. M.
Qr-tan: Secure mobile transaction authentication. In Availability,
Reliability and Security, 2009. ARES’09. International Conference
on (2009), IEEE, pp. 578–583.
USENIX Association
26th USENIX Security Symposium    607
Global mobile payment
revenue 2015-2019.
[49] STATISTA.
https://www.statista.com/statistics/226530/
mobile-payment-transaction-volume-forecast/.
[Online; accessed 19-Jan-2017].
[50] TECHNOLOGIES, S. Symbol ds6708-dl product reference guide.
https://www.zebra.com/content/dam/zebra_new_ia/
en-us/manuals/barcode-scanners/ds6707-digital-
imager-scanner-product-reference-guide-en-us.
pdf. [Online; accessed 19-Jan-2017].
[51] TONETAG. Tone tag. https://www.tonetag.com/about.
html. [Online; accessed 19-Jan-2017].
[53] VIDAS, T., OWUSU, E., WANG, S., ZENG, C., CRANOR, L. F.,
AND CHRISTIN, N. Qrishing: The susceptibility of smartphone
users to qr code phishing attacks. In International Conference
on Financial Cryptography and Data Security (2013), Springer,
pp. 52–69.
[54] YAO, H., AND SHIN, D. Towards preventing qr code based
attacks on android phone using security warnings. In Proceedings
of the 8th ACM SIGSAC Symposium on Information, Computer
and Communications Security (New York, NY, USA, 2013), ASIA
CCS ’13, ACM, pp. 341–346.
[52] VARSHNEY, U., AND VETTER, R. Mobile commerce: frame-
work, applications and networking support. Mobile networks and
Applications 7, 3 (2002), 185–198.
[55] ZHOU, Y., AND JIANG, X. Dissecting android malware: Charac-
terization and evolution. In Security and Privacy (SP), 2012 IEEE
Symposium on (2012), IEEE, pp. 95–109.
608    26th USENIX Security Symposium
USENIX Association