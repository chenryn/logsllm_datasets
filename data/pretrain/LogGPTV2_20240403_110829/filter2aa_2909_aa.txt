Digital Active
Digital Active
Self Defense
Self Defense
DEFCON 12
DEFCON 12
OUDOT Laurent
OUDOT Laurent
oudot
oudot@
@rstack
rstack.org
.org
http://www.
http://www.rstack
rstack.org/
.org/oudot
oudot//
Some references
•
Active Defense research project, Dittrich
– http://staff.washington.edu/dittrich/ad/
•
Defending your right to defend: Considerations of an automated strike-back
technology
– Timothy M. Mullen
•
Launch on Warning: Aggressive Defense of Computer Systems
– Curtis E.A. Karnow
•
Enforcer, Automated Worm Mitigation for private networks
– BlackHat Seattle, February 2003, Timothy M.Mullen, AnchorIS.com
•
Vigilantes on the net
– Barbara Moran, NewScientist, 12 june 2004
•
Symbiot, Adaptive Platform for Network Security
– http://www.symbiot.com
Summary
•
Introduction
– Digital threats,
– Hardening / reaction
– Prevention / Countermeasure
– Active Defense…?
•
Legal Issues
•
Technical considerations
– Fighting back
– Requirements
– Honeypots
– Handling Internal threats
– Examples
– Technical limitations
•
Conclusions
Introduction
• Current threats
– Known limitations for defense technologies
• Many solutions in the information security field
– Laws fail for certain kind of activities
• Natural temptation
– Fighting back attackers, counterstrike…
• Not so many solutions that use active countermeasure
capabilities
– Interesting field of research and development ?
The digital threats
• Though we use more and more security technologies,
there are still security problems
– Confidentiality, Integrity, Availability, Copyright, etc
– Information Assurance
• External threats
– Firewall, Proxies, Hardened services…
• Ethical Hackers, Corporate spies, Cyber terrorists...
• Internal threats : easier/faster access
– Authentication, In-depth Protection...
• Trainees, Outsourcing, Employees…
From hardening to reaction
• A lot of technologies might be used to block evil traffic
– Routers, Firewalls, proxies, etc
– Allow the minimum that is needed
• But aggressors still find solutions like :
– Bouncing in (bad security rules, bugs, etc)
– Getting an access inside the minimum accepted (target
services, target end-users with stupid clients, etc)
• Countermeasure technologies
– While getting a sign of an attack (IDS…), security resources
will respond by trying to stop the attack
– Could it be an interesting answer to handle some threats ?
Countermeasure problems
• Countermeasure : Detection  Reaction
• The delay between a detection and the associated
response is not zero second
– Some packets may reach the victims
– IDS see signs of attacks while victims receive the attacks, so
that responses (RST, ICMP, firewall ruleset modified…) may
arrive too late to stop the attack (which has ever begun)
– Examples of problems :
• SQL-Worm : 1 UDP small packet !
• Multiple sources of attackers...
Prevention / Countermeasure
• « Intrusion Detection Systems + Firewall » ?
– Why couldn't we prevent the attack when we detect the
attack, in order to avoid problems ?
– Easy to say  new concept ?!
• “happy super market concept” ?  OR  “real technical concept” ?
• Intrusion Prevention Systems
– NIPS : Network IPS
• Inline IDS
• Bait and switch honeypots…
– HIPS ?
• Sanboxes (grsecurity, systrace…)...
Prevention + Deception
• Diverting evil traffic
– “Building an Early Warning System in a Service Provider Network”, BH
Europe 2004, Nicolas Fischbach
• Bait and switch, « aggressive honeypot »
– Easy GPL modification on snort : snort plugin output
– Netfilter and routing under Linux2.4
– When evil packets are caught by snort from a given IP source, this one
is redirected to a fake network : prevention and deception
• An attacker launch an attack to the production network
• He is caught by the modified snort
• All his future actions will be transparently redirected to a deception network
(dedicated to blackhat people)
Taken from
http://www.violating.us/projects/baitnswitch
Bait & Switch example
Diversion & Drawbacks
• Excellent cool concept mixing firewalls, IDS and
honeypots in a kind of prevention architecture
• Some limitations :
– Yet another single point of failure (DOS)
– Rulesets and evasions against the IDS (snort)
– Denial of service with IP Spoofing of attacks claiming to come
from friendly hosts (white list to maintain)
– Fingerprinting a B&S network
• TCP problems after the switching
• TCP Timestamp changes…
• Multiple IP Source for the attacks : deception detected
Attacks against IPS
• Denial of service
– « IDS are too slow & easy to attack with states tables attacks, packet bombing...»
– More problems with IPS : detection AND prevention to do !
• Abusing the rulesets
– « easy to bypass ids with evasion, and 0-days exploits can’t be caught »
– More problems with IPS : 0-prevention !
• Generating a denial of service
– Spoofing an attack coming from (a) friendly host(s)
– Solution: white list, but what if a friend is used to bounce to you ?
• What about distributed attacks ?
– Multiple sources of coordinated attackers
• …
Active Defense…?
• Usual methods would not always work ?
– Block incoming traffic
• Might be problem for online services
– Apply rate limitation
• Bandwidth adjusted
– Divert the traffic
• Bait and switch technologies (honeypots)
– Fake responses (decoy)
• Should we use more aggressive methods ?
– Self Defense
– Counterstrike
• Disable, destroy, control the attacker
Warning
• Limitations
– Not a legal expert
– Legal issues might be different depending of the countries...
Legal Issues
• Toward a concept of digital active self defense ?
• Self defense occurs when someone is threatened with
imminent bodily harm
– Might be applied to avoid injury to property (computers…)
• Requirements
– Necessity: No choice but using force
• No adequate alternatives
– Proportionality: This force is reasonable
• Proportional response to the harm avoided
– The threat is unlawful
Proportional response
• What could mean proportional ?
– Risk of subjectivity / interpretation
• Need to create a classification of attacks to chose the
appropriate response
– Families of attacks and hierarchy
• DDOS > DOS ?
• Remote shell > Scan ?
• …
• Once it is done, you might be able to take a decision
No adequate alternatives
• Proving that you had no other choice ?
• Experts could argue that many other possibilities might
be used :
– First consideration : disconnect the victim(s) to avoid the
attack ?
• Self Defense doctrine does not always require the victim to back
away
• Such a disconnection would result in a kind of DOS on the victim
– What about an e-business web server ?
– Other possibilities : perimeter defenses ?
• How can we explain that the counterstrike tools were
able to fight back the attacker and that they could not
block the attack ?
– So many solutions of security to avoid an attack
• Conclusion : might be difficult to prove that you had no
other possibility
No adequate alternatives
Legal Issues and IW
• What about Information Warfare ?
– Not officially recognized by The Hague and Geneva
Conventions
– No real example of act of war on the cyber battlefield
• Individuals, groups, governments…
– No real legal considerations
Technical considerations
•
Striking back ?
–
Identify the tools/methods/sources
•
IDS, logs, network captures…
•
Avoid spoofing…
–
Take a decision
•
White list / Black list : destination of counterstrike allowed
–
e.g. hacking back internal users
–
Strike back !
Self Defense
Usual clients
Scanners
Exploits
Trojan clients
...
Action
Action
Victim
Aggressor
Reaction
Reaction
Risk with spoofing
• Risk of hacking back : attacking innocents
– May be difficult to find the real source of an aggression
• Example : aggressions with spoofing, reflectors...
– Idle scan : Aggressor is invisible on the target !
Aggressor
Zombie
Target
[1] (spoofing zombie)
[2] Syn|Ack or Rst
[3] Syn|Ack
(IPID probe)
[4]Rst