must be sampled in a non-biased fashion. Otherwise the mea-
surements will be skewed towards the biased peer selection.
P3 Long Sessions Given an interval τ and a minimum accu-
racy ϵ, τ
ϵ short sessions, i.e., uninterrupted time-windows
of availability, can be measured. However, only one session
of length τ can be observed in the measurement period τ.
P4 False Negatives False negatives within the measurements
may occur due to network congestion or temporal failure of
network connections. This may lead to bots appearing to be
offline even when they are not.
P5 Brief Events If the time between measurements is not gran-
ular enough, short-lived events may not be recorded. Conse-
quently, sessions might be missed or multiple short sessions
(mis)-interpreted as a single long session.
P6 NAT Devices behind a Network Address Translation (NAT)
device or firewall cannot be contacted directly over the In-
ternet unless they first initiate the connection. Measuring
such nodes may lead to skewed results due to frequently
changing ports or shared IP address.
P7 Dynamic IP Addresses Many Internet Service Providers
(ISPs) uses Dynamic Host Configuration Protocol (DHCP) or
Point-to-Point Protocol (PPP) to assign dynamic IP addresses.
Reassignment of IPs will appear as separate leave-and-join
events even though the bots remained online.
P8 Synchronization When using multiple monitoring instances,
it must be assured, that the clocks are synchronized. Other-
wise aggregated results may lead to contradicting observa-
tions about the availability of bots.
P9 Non-persistent Identifiers The lack of unique and persis-
tent identifiers introduces measurement inaccuracies of the
population, as new bots and re-joining bots can not be easily
differentiated.
P10 Anti-monitoring Mechanisms P2P botnets may deploy
anti-monitoring mechanisms to hinder monitoring attempts.
Such mechanisms must be considered and circumvented to
obtain accurate churn measurements.
3.2 Botnet Monitoring Framework (BMF)
In this subsection, we introduce BMF. This framework which is
depicted in Figure 1, aims at improving the efficiency of future
botnet monitoring activities with increased accuracy. Specifically,
in the context of obtaining churn measurements, BMF attempts to
address most of the pitfalls explained in Section 3.1.
BMF consists of three major components: 1) a NoSQL database,
2) (modular) monitoring modules and 3) a coordinator. The sheer
amount of obtainable data through monitoring activities does not
scale with relational databases. Moreover, the obtainable type of in-
formation varies across different botnets. Hence, NoSQL databases,
e.g., MongoDB, are best suited to store such information.
The most commonly used monitoring mechanisms are honey-
pots, crawlers and sensors. However, as pointed out by many re-
searchers [7, 8], each of the methods has their own advantages
and disadvantages. Hence, the information from all of these mecha-
nisms are often combined during analysis, e.g., churn measurement
analysis. BMF is designed to enable a modular monitoring system
that integrates existing monitoring mechanisms as well the possibil-
ity to include newer ones in the future. These monitoring modules
are controlled by a Coordinator which has an overall view of the
PosterCCS ’19, November 11–15, 2019, London, United Kingdom2662analysis exists (P1). The churn model could then be used in simu-
lators such as BSF to conduct realistic churn simulations to allow
defenders to study the impact of a potential botnet takedown.
4 SUMMARY AND FUTURE WORK
Within this paper we discussed the necessity for accurate churn
measurements of P2P botnets to evaluate P2P botnet takedowns
and enable realistic simulations. Therefore, we outlined ten pitfalls
in measuring churn in live P2P botnets. Moreover, we propose
BMF, a framework that addresses these pitfalls and allows uniform
measurements of churn in various P2P botnets. As part of ongoing
work, we also intend to address pitfalls P7 and P9, which are not yet
addressed. We observed these two pitfalls in an early measurement
of the Hide’n Seek (HnS) botnet. After 148.16 hours of measurement,
a group of bots disconnected simultaneously from a particular ISP.
We presume, that this was caused by an IP address re-assignment.
However, due to the lack of a unique identifier, we were unable to
re-identify the bots under their new IPs. Our goal is to address these
issues in the future by fingerprinting bots based on their shared
information and response behavior, e.g. TTL and round-trip times.
For future work, we intend to implement BMF and conduct long
term measurements for P2P botnets such as Sality, ZeroAccess, HnS
and Hajime. Based on these measurements, we want to address three
major goals: 1) enable more realistic simulations of P2P botnets, 2)
compare churn across different botnets and analyze the difference
between traditional and Internet of Things (IoT)-based botnets, and
3) make BMF and the collected dataset freely available to foster
collaboration and advances in the fight against botnets.
ACKNOWLEDGMENTS
This work was supported by the Royal Bank of Canada (Grant
Agreement 2761478.4) and German Federal Ministry of Education
and Research (BMBF) as well as by the Hessen State Ministry for
Higher Education, Research and the Arts (HMWK) within CRISP.
REFERENCES
[1] Dennis Andriesse, Christian Rossow, and Herbert Bos. 2015. Reliable Recon
in Adversarial Peer-to-Peer Botnets. In Proceedings of the 2015 ACM Internet
Measurement Conference, IMC 2015, Tokyo, Japan, October 28-30, 2015. 129–140.
https://doi.org/10.1145/2815675.2815682
[2] Leon Böck, Emmanouil Vasilomanolakis, Max Mühlhäuser, and Shankar Karup-
payah. 2018. Next generation P2P Botnets: monitoring under adverse conditions. In
International Symposium on Research in Attacks, Intrusions, and Defenses. Springer,
511–531.
[3] Leon Böck, Emmanouil Vasilomanolakis, Jan Helge Wolf, and Max Mühlhäuser.
2019. Autonomously detecting sensors in fully distributed botnets. Computers &
Security 83 (2019), 1–13. https://doi.org/10.1016/j.cose.2019.01.004
[4] Stutzbach Daniel and Rejaie Reza. 2006. Understanding churn in peer-to-peer
networks. In Internet Measurement Conference. ACM, 189–202.
[5] Steffen Haas, Shankar Karuppayah, Selvakumar Manickam, Max Mühlhäuser,
and Mathias Fischer. 2016. On the resilience of P2P-based botnet graphs. In
Communications and Network Security (CNS). IEEE, 225–233.
[6] Stephen Herwig, Katura Harvey, George Hughey, Richard Roberts, and Dave Levin.
2019. Measurement and Analysis of Hajime, a Peer-to-peer IoT Botnet. In Network
and Distributed System Security Symposium.
[7] Shankar Karuppayah. 2016. Advanced monitoring in P2P botnets. Ph.D. Dissertation.
Technische Universität Darmstadt.
[8] Christian Rossow, Dennis Andriesse, Tillmann Werner, Brett Stone-Gross, Daniel
Plohmann, Christian J Dietrich, and Herbert Bos. 2013. Sok: P2pwned-modeling
and evaluating the resilience of peer-to-peer botnets. In IEEE Symposium on Secu-
rity and Privacy. 97–111.
[9] Tillmann Werner. 2013. Peer-to-Peer Poisoning Attack against the Kelihos.C
Botnet. (2013). https://www.crowdstrike.com/blog/peer-peer-poisoning-attack-
against-kelihosc-botnet/
Figure 1: Illustration of a BMF setup
entire monitoring process and can synchronize the logged data
from different monitoring nodes (P8).
Since information of all monitoring mechanisms needs to be
considered as a whole, it only makes sense to introduce a modular
monitoring system. For instance, bots that are executed in a honey-
pot or sandbox, would continuously communicate with other active
bots. From that, BMF can keep track of recently active peers in the
botnet. Therefore, once a crawler and a sensor are implemented,
they can be bootstrapped into the botnet using the list of active
peers, instead of stale bootstrap entries. Moreover, crawlers could
also be leveraged to bootstrap or popularize the deployed sensors
in the same manner (P6,P8).
Recent P2P botnets and the state of the art in this domain have
seen many new anti-monitoring mechanisms that could hamper
monitoring; hence affecting the quality of the monitored data [1, 3].
For instance, one of the most common restriction mechanism is the
blacklisting of IP addresses. BMF can circumvent such mechanisms
by coordinating the crawlers to yield better discovery without trig-
gering the anti-monitoring mechanisms (P10). Moreover, the ability
to coordinate the monitoring modules also enables the possibility
to assign monitoring nodes from different networks to probe a
single bot. Consequently, this can reduce the false positives from
network congestion or temporal network failures (P4). In addition,
the coordinator could also distribute the monitoring activities.
The design of BMF is also intended for long-term botnet monitor-
ing (P2,P3). Moreover, the granularity of the monitoring frequency
can be adjusted as needed (P5). The data generated from such
long-term granular monitoring could be useful for many purposes;
ranging from understanding to taking them down.
Finally, the collected data can be analyzed for purposes such as
churn analysis to produce a churn model. Considering that long-
term monitoring data is available, duration of the analysis can be
chosen such that no interruptions that could affect the resulting
AnalysisBotnetNoSQL DBCoordinatorBMF123……N2Crawlers…C1CN3Sensors…S1SN…1HoneypotsH1HNActionsSimulation &ExperimentsBotBot behind NAT / FirewallPosterCCS ’19, November 11–15, 2019, London, United Kingdom2663