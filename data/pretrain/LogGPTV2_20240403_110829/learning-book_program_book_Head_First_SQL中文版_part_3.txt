子查询的构造流程
394
作为欲选取列的子查询
397
范例：子查询搭配自然联接
398
非关联子查询
399
SQL真情指数：在众多选择中，挑出最好的查询方式
400
有多个值的非关联子查询：IN、NOTIN
403
关联子查询
408
OUTERquery
一个搭配NOTEXISTS的（好用）关联子查询
409
EXISTS与NOTEXISTS
410
INNERquery
Greg的RecruitingService正式开业
412
前往派对的路上
413
你的SQL工具包
414
外层查询
SELECT some_column，
another_column
FROM table
内居查询（子查询）
WHERE column=
（SELECTcolumn FROM table）;
xvili
---
## Page 25
目录
外联接、自联接与联合
10
新策略
关于联接，我们只认识了一半。我们已经看过返回每个可能行的交叉联接，
返回两张表中相符记录的内联接。但我们还没见过外联接，它可以在表中没有匹配
记录的情况下返回记录，自联接（光听名称就很奇怪了），它可以联接表本身；还
有联合，它可以合并查询结果。学会这些技巧后，你就可以采用自己需要的方式取
得所有数据（而且本章也没有忘记探讨关于子查询的真相！）
清理旧数据
418
一切都跟左、右有关
419
请看左外联接
420
外联接与多个相符结果
425
右外联接
426
利用外联接
429
UN3ON能让
可以创建新表
430
Greg结合来自三
个不同壹询的结
新表的位置
431
果的一张结果表。
自引用外键
432
job_desited ()
联接表与它自己
433
jo6_cattext)
title别
我们需要自联接
title别
435
另一种取得多张表内容的方式
436
可以利用UNION
437
UNION的使用限制
438
必须是同时出现
UNION规则的运作
439
在两张来中的
UNIONALL
title
440
从联合创建表
jos_lesited的
441
jo6_caent 
titte)
title列
INTERSECT和EXCEPT
442
我们已经解决了联接，应该进入
443
应该进人子查询与联接的比较了
443
把子查询转换为联接
444
把自联接变成子查询
449
只有不在EXCEPT
任何同时存在于两
Greg的公司正在成长
指定的表中的
张表中的ciele都舍
450
title才金出现
从叠诸结集中设
你的 SQL工具包
452
排警。
xix
---
## Page 26
目录
约束、视图与事务
人多手杂，数据库受不了
你的数据库成长到一定规模了，出现了其他需要使用数据库的人。
问题是，其他人的SQL技术可能不像各位这么娴熟。结果我们需要防止其他人输入
错误的数据，需要让其他人只看到部分数据的技术，还需要防止大家同时输入数据
时互相踩到别人的地盘。在本章中，我们开始保护数据，以免其他人对数据进行错
误的操作。欢迎来到“数据库自卫术Part1”。
Greg雇用了帮手
456
Jim的第一天：插入新客户的数据
457
Jim尽力避免NULL
458
三个月后
459
检查约束：加入CHECK
460
为性别列设定检查约束
461
Frank的工作很无聊
463
创建视图
465
查看你的视图
466
视图的实际行动
467
何为视图
468
利用视图进行插入、更新与删除
471
秘密在于假装视图是真正的表
472
带有CHECKOPTION的视图
475
视图有可能更新，如果
476
当视图使用完毕
477
DATAVILLE
当乖乖的数据库发生了人间惨剧
478
SAVINGS &LOAN
ATM里发生了什么事
479
ATM发生更多麻烦
480
并非痴人说梦，而是事务
482
经典ACID测试
483
SQL帮助你管理事务
ATM里应该发生什么事
485
如何让事务在MySQL下运作
486
现在动手试试看
487
你的SQL工具包
490
XX
---
## Page 27
目录
安全性
12
保护你的资产
为了创建数据库，大家已经花了许多时间与精力。如果数据库受到了什
么伤害，你一定会崩溃吧！而且虽然让其他人访问你的数据有其必要性，但真的会
忍不住担心有人插人或更新数据时的操作不正确，甚至发生更糟的情况：删错了数
据。我们即将要学到如何把数据库和其中的对象变得更安全，以及如何全面控制谁
对数据进行什么操作。
用户的问题
494
避免小丑追踪数据库的错误
495
保护用户账号：root
497
添加新用户
498
判断用户的确切需求
499
简单的GRANT语句
500
GRANT的各种变化
503
撤销权限：REVOKE
504
撤销授权许可（GRANTOPTION）
505
具精确度的撤销操作
506
共享账号的问题
510
使用角色
512
卸除角色
512
加上WITHADMINOPTION的角色
514
结合CREATEUSER与GRANT
519
Greg`sList已经成为跨国企业了
520
你的SQL工具包
522
Greg'sList在你的城市发展得好不好？
524
请把SQL应用到你的项目中，只要有心，你也会是Greg！
524
root
bashful
doc
dopey
grumpy
happy
sleepy
sneezy
xxi
---
## Page 28
目录
附录1
十大遗珠
尽管刚刚结束一场SQL盛宴，但总会有剩下的东西。我想
各位还需要知道一些其他补充事项，就算只能简短提一下也好忽略
了就是觉得怪怪的。放下本书前，希望大家稍微看一下本章的SQL小花
絮。
另外，本章结束后还有两篇附录…可能还有几篇广告然后就真的
结束了，真的，我保证！
#1.为RDBMS取得图形用户界面
526
#2.保留字与特殊字符
528
#3.ANY、ALL和SOME
530
#4.再谈数据类型
532
#5.临时表
534
#6.转换数据类型
535
#7.你是谁？现在几点？
536
#8.有用的数字函数
537
#9.索引能加快速度
539
#10.给我两分钟，我给你PHP/MySQL
540
xxii
---
## Page 29
目录
附录2
安装MySQL
自己动手试
各位学到这么多SQL技巧，如果没有施展的场所，岂
非英雄无用武之地？本篇附录说明了安装MySQL的方式，让大
家有地方自我琢磨技艺。
开始了，冲吧！
544
安装说明与疑难排除
544
在Windows上安装MySQL
545
在MacOSX上安装MySQL
548
附录3
ili
SQL工具总整理
崭新的SQL工具包
所有SQL工具初次齐聚一堂，仅限今夜哦！
（开玩笑啦！）这篇附录收集了所有我们提到的SQL工具，
花一点时间浏览一下，感受一下那份成就感—你已经完全学
会这些工具了哦！
符号
552
A-B
552
C-D
553
E-I
554
L -N
555
O-S
556
T-W
557
xxiii
---
## Page 30
对《HeadFirstSQL》的赞誉
“有些书籍会激发我们的购买欲，有些书籍会让我们把它带在身边，有些书籍我们则只会把它放在
书桌上当摆设，感谢O'Reilly和HeadFirst制作小组的出现，从他们手中诞生了翻到书页卷边、被
画得乱七八糟、令人爱不释手的“HeadFirst”系列。《HeadFirstSQL》现在在我家书架上排第
一位。”
-一BillSawyer，ATG课程管理人，Oracle
，“这本书不是简化版的SQL教科书，而是充满挑战的SQL、让人感兴趣的SQL、让人觉得好玩的
SQL。它甚至回答了长久以来的疑问：应该如何讲解非关联子查询而不会失去正面积极的心
态？”风格明快又不严肃，而且阅读过程美妙无比一一这才是正确的学习方式。“
AndrewCumming，《SQLHacks》的作者，ZooKeeperatsqlzoo.net
“真是不敢相信我的眼睛！SQL不是一种计算机语言吗？一本关于SQL的书应该是写给计算机看
的书，不是吗？可是《HeadFirstSQL》却是写给人类的书！怎么会发生这种事？！”
DanTow，《SQLTuning》的作者
---
## Page 31
对HeadFirst系列书籍的赞誉
“《深入浅出设计模式》条理清晰、幽默风趣、真材实料，甚至能帮助非程序员来好好思考问题解
决之道。”
CoryDoctorow，BoingBoing的共同编辑
《Down and Out in the Magic Kingdom》与
《SomeoneComestoTown，SomeoneLeavesTown》的作者
“如果你认为Ajax是相当复杂的技术，《深入浅出Ajax》就是为你而写。本书让每一位Web编程
-人员都能体验到无与伦比的动态感和吸引力。”
JesseJamesGarrett,AdaptivePath
“我昨天刚收到这本书，在回家的路上便开始阅读，简直欲罢不能，于是我把书带到健身房，一边
运动一边阅读，脸上堆满笑容。这真是太棒了！不仅有趣、涵盖许多基础知识，而且观点正确，
给我留下了深刻的印象。”
ErichGamma，IBM杰出工程师、《DesignPatterns》的共同作者
“本书融乐趣、捧腹大笑、洞察力、技术深度、非常实用的建议于一体，成为一本寓教于乐的书
籍。不管是初次学习设计模式，或者已经具有多年的使用设计模式的经验，你都可以在访问对象
村（Objectville）的过程中学到东西。”
—Richard Helm，《DesignPatterns》的共同作者
“这是我所读过的关于软件设计最有趣、最聪明的书籍之一。“
AaronLaBerge，技术副总，ESPN.com
“我刚读完《深入浅出面向对象分析与设计》，已经深深爱上它！我最喜欢这本书把焦点放在为什
么要实践OOA&D上一为了写出美妙的软件！”
KyleBrown，IBM杰出工程师
“我衷心喜欢《深人浅出HTML与CSS、XHTML》这本书一它以妙趣横生的形式讲述了需要学
习的一切。”
一SallyApplin，UI设计师及精致艺术工作者，sally.com
---
## Page 32
对HeadFirst风格的赞誉
“《深入浅出Java》明快、轻松、优雅并且充满乐趣，你自然而然就能从中学到东西。”
KenArnold，SunMicrosystem前任资深工程师、
《The JavaProgrammingLanguage》的共同作者
“（谈完《深入浅出设计模式》）我觉得好像刚刚把一本千斤重的书举过头顶。”
WardCunningham，Wiki发明者、HillsideGroup创始人
“《深入浅出设计模式》近乎完美，它在提供专业知识的同时，还保有相当高的可读性，口吻权
威、阅读轻松。它是我所读过的软件书籍中极少数让我觉得不可或缺的一本。”
—DavidGelernter，耶鲁大学计算机科学系教授
《MirrorWorld》和《MachineWorld》的作者
“《深入浅出设计模式》的内容正适合我们这些喜欢新技术的人。本书为实际的开发策略提供正确
的参考，让我的头脑运转顺畅，不会被专家枯燥乏味的用语搞得头昏脑胀。”
TravisKalanick，MIT TR100的Scour and Red SwooshMember的创始人
“运用‘HeadFirst’／‘HeadRush’系列惯有的读谐幽默风格，本书单刀直入地教你如何编写给服
务器发送请求以及在返回时更新网页的JavaScript……本书最大的好处是除了对程序代码如何运作
有绝妙诠释外，也顾及安全防护的主题。假如你通过这本书学习Ajax，就不太可能会忘记你所学
过的一切。”
—Stephen Chapman,JavaScript.About.com
---
## Page 33
1
数据和表
保存所有东西的地方
米
我以前都用纸和笔追踪病人的情况，
但是经常出状况！现在我改用SQL，再
也不会弄错了！学学如何使用表，不
会很难的！
你是否也很讨厌总是找不到东西？找不到你的车钥匙、
UrbanOutfitter75折优惠券以及应用程序的数据吗？在最需要的
时候，偏偏找不到需要的东西，还有什么比这更糟？提到应用程
序，存储程序重要信息的最佳场所非表莫属。所以请翻到下一页，
踏人关系数据库的世界吧。
进入新章节
---
## Page 34
棘手的情况
定义数据
Greg认识许多单身贵族，他最喜欢记录每位朋友的兴
趣爱好，并为有缘人从中合。他把每个人的信息写在
便笺上，就像这样：
Daniel Reese
B-day:6/13/1980
WebDesigner
Single
Sunnyvale,CA
PI:EMAIL
Interests:Outdoor
Music,Travel,Cooking
Seeking:Friends,Women todate
Greg的这套系统已经行之有年。不过，他上星期刚把
为人找新工作也加人自己的便笺中，结果他的人才列表飞
快增长，非常非常快.
2
第1章
---
## Page 35
数据和表
只是Ctes的便美的
小部分
功动赔
有更好的方式来组织信息吗？你会怎么做？
当前位置
---
## Page 36
数据的分类
做个数据库怎么样？这本书不就是
要讲数据库吗？
正是如此。我们就是需要数据库。
不过在创建数据库前，我们还需了解要存储
数据的类型以及把数据分类的方式。
4
第1章
---
## Page 37
数据和表
磨笔上阵
你看，下面是Greg的便笺。看看你能从这些便笺中找出哪
些类似信息。为每种相似信息贴上标签来描述它的信息分
类，然后把列出的标签写在本页的空白处。
Ann Branson
Jamle Hal
Bdy:7/A1962
B-Jay:91o1964
Sofnwae Engoor
S A
Singlo,bet od
Single
Mountn Vow.CA
Sunnyale.CA
dontbothor@broalnockpirea
Interote Cellect-
Intets Hdng.ng.
lgbBeg.Eq
Sooklng:NowJob
Ine:Frlends,Wom
lehtodage
Alan Soukap
Seeking
B-Jay:7/1966
AeonautkalEngt
Manied
Sen Anlo.TX
soukupebeeaka
Angolina Mendoza
B-day:8191979
Untx Sysm
Marled
San Frcl,CA
angellnqbucofoo
Ingerests: Aetng,Dancing
Seoking:Now job
当前位置
h
---
## Page 38
磨笔上阵解答
磨笔上阵
解答
你看，下面是Greg的便利贴。看看你能从这些便利贴中找出
哪些类似信息。为每种相似信息贴上标签来描述它的信息分类，
然后把列出的标签写在本页的空白处。
Fitst Name
既然创建了信息分
Last Name
类，我们就可以用分
类来组织数据。
Jamiedlamtiton
B-Jay:7/962
Sorwae Engineet