includes an unnecessary detour. Relationships are complex; tran-
sit and peering relationships may be preferred one over the other.
Models with ﬁner granularity for ranking neighbors of an AS may
resolve these issues [27].
Another violation occurs at a US university U. The univer-
sity ﬁrst routes through Internet2 (AS11537) toward one of the
PEERING locations in the US. After we poison Internet2, U routes
through AMPATH (AS20080) toward the PEERING location in
Brazil. We list this as a violation because CAIDA identiﬁes In-
ternet2 as a provider and AMPATH as a settlement-free peer of U.
Our last observed violation is similar, where a European network
ﬁrst routes through Switch (AS559, identiﬁed as a provider) and
then routes through NCSA (AS10764, identiﬁed as a settlement-
free peer) to reach PEERING after we poison Switch. These viola-
tions indicate that identifying links used as back-up might improve
our routing models.
Reverse engineering BGP decisions. We now turn to our second
control plane experiment, where we use anycast to explore consid-
erations such as route age on routing decisions. Table 2 shows the
root cause behind BGP routing decisions. Although most decisions
are made based on relationship and path length, more than 17%
of decisions are made based on intradomain tie-breakers and route
age, which are not considered in and could improve current models.
Limitations. BGP poisoning does not work when BGP loop
prevention is disabled or when ASes ﬁlter poisoned announce-
ments [20,22]. Intermediate ASes between PEERING locations and
target ASes may prevent us from controlling routes exported to the
target AS. These factors limit our ability to identify all routes avail-
able to and neighbors of target ASes. We consider the subset of
routes we observed and neighbors we identiﬁed. Moreover, our re-
sults for these experiments cover a small fraction of the Internet and
are probably biased toward academic and research networks. Our
control plane techniques, however, are general and could be used
by other networks to cover different portions of the Internet. We be-
lieve better coverage and visibility would result in discovering more
violations. To this end, we are working to extend the PEERING
platform and RIPE has conﬁgured periodic measurements from a
diverse set of Probes toward all PEERING preﬁxes.
5. SKEWNESS BY SOURCE AND DESTI-
NATION
We now investigate which source and destination ASes account
for most of the routing decisions which deviate from our model.
Figure 2 (a) and (b) shows the cumulative fraction of routing deci-
sions which violate either the Best or Short condition (i.e., the AS
chooses a path that is longer or more expensive than we would ex-
pect). If violations were evenly distributed across ASes, the curves
would ﬁx y = x; otherwise, some ASes are responsible for a dis-
proportionately larger (or smaller) fraction of violations. We ﬁnd
this effect is present in both plots, but more prominently for desti-
nation ASes. We focus on the latter.
Destination ASes owned by Akamai account for 21% of vio-
lations. Of these, Cogent (AS174) is the most common source,
responsible for 3.4% of these Akamai related violations. These
Cogent-Akamai violations tend to occur when Cogent prefers a
peer-to-peer path through a Tier-1 AS over a longer customer route
towards Akamai. Netﬂix’s AS is the destination on 17% of paths
with violations. Of these, nearly a quarter (24%) are due to a stale
inter-AS link in CAIDA’s topology, which included a direct link be-
tween AS3549 and Netﬂix that no longer exists according to RIPE
ASN Neighbor History [32]. For source ASes, the distribution is
less skewed. Cogent and Time Warner are the top two sources,
responsible for 4.1% and 2.2% of violations, respectively.
(a) Distribution of violations across source ASes.
(b) Distributions of violations across destination ASes.
Figure 2: CDF plot of the fraction of violations (x-axis) ex-
plained by source and destinations ASes (y-axis). Violations ob-
served in our dataset are skewed signiﬁcantly toward Akamai
and Netﬂix (21% and 17% of total NonBest/Short violations
respectively). The skew for source ASes is less prominent.
 0 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 1Cumulative fraction of decisionsSource ASes ranked by fraction of decisionsBest+LongNonBest+ShortNonBest+Long 0 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 1Cumulative fraction of decisionsDestination ASes ranked by fraction of decisionsBest+LongNonBest+ShortNonBest+Long75Violation type
Non-Best & Short
Best & Long
Non-Best & Long
Pct. of decisions explained
3.0%
6.5%
4.5%
Table 4: Fraction of decisions of each type that can be at-
tributed to undersea cables.
rine Cable Map [38] to identify ASes for undersea cable operators.
Overall, cable-ASes appear on less than 2% of paths but most of
the decisions (51.2%) involving cable-ASes caused deviations from
Best/Short paths. Table 4 shows fraction of each type of decision
explained by undersea cable ASes.
7. CONCLUSION
In this work, we investigated how interdomain paths predicted
by state-of-the-art routing models differ from empirically observed
routes. We found that while a majority of paths in our dataset agree
with models, more than a third do not. We explained a signiﬁcant
fraction of these differences due to factors such as sibling ASes,
selective preﬁx announcements and undersea cables. Further, we
investigated how the models hold up when comparing with ground-
truth routing preferences revealed using PEERING announcements,
and identiﬁed AS behavior that is not included in existing models.
As part of future work, we are continuing to investigate cases of
routing decisions that violate today’s models, and we aim to incor-
porate our ﬁndings into new models of Internet routing.
Acknowledgments
Research in this paper was funded by NSF grants CNS-1422566,
CNS-1351100, CNS-1413978; CNPq grant PU-477932; a Com-
cast TechFund Award; and a Google Faculty Research Award. The
PEERING testbed was partially funded by NSF CNS-1406042. We
gratefully acknowledge GENI for support of an early incarnation
of PEERING. We also thank RIPE Atlas for help with traceroute
measurements.
8. REFERENCES
[1] H. Ballani, P. Francis, and X. Zhang. A study of preﬁx hijacking and
interception in the Internet. In SIGCOMM, 2007.
[2] M. Berman, J. S. Chase, L. Landweber, A. Nakao, M. Ott,
D. Raychaudhuri, R. Ricci, and I. Seskar. GENI: A Federated
Testbed for Innovative Network Experiments. Computer Networks,
61:5–23, 2014.
[3] R. Bush, O. Maennel, M. Roughan, and S. Uhlig. Internet optometry:
Assessing broken glasses in internet reachability. In ACM IMC, 2009.
[4] X. Cai, J. Heidemann, B. Krishnamurthy, and W. Willinger. Towards
an AS-to-organization map. In ACM IMC, 2010.
[5] M. Calder, X. F. Z. Hu, E. K.-B. J. Heidemann, and R. Govindan.
Mapping the Expansion of Google’s Serving Infrastructure. In
Proceedings of the ACM Internet Measurement Conference (IMC
’13), October 2013.
[6] B. Chandrasekaran, M. Bai, M. Schoenﬁeld, A. Berger, N. Caruso,
G. Economou, S. Gilliss, B. Maggs, K. Moses, D. Duff, K. Ngâ ˘A˘a,
E. G. Sirer, R. Weberâ ˘A˘a, and B. Wong. Alidade: Ip geolocation
without active probing. Department of Computer Science, Duke
University, Technical Report, 2015.
[7] K. Chen, D. Choffnes, R. Potharaju, Y. Chen, F. Bustamante, D. Pei,
and Y. Zhao. Where the sidewalk ends: Extending the internet AS
graph using traceroutes from P2P users. In CoNEXT ’09, 2009.
[8] Cisco. BGP Best Path Selection Algorithm: How the Best Path
Algorithm Works. Document ID: 13753, May 2012.
[9] L. Colitti. Internet Topology Discovery Using Active Probing. Ph.D.
thesis, University di Roma Tre, 2006.
[10] L. Gao, T. Grifﬁn, and J. Rexford. Inherently safe backup routing
with BGP. IEEE INFOCOM, 2001.
Figure 3: Breakdown of routing decisions for traceroutes that
stay within continents of Africa (AF), North America (NA), Eu-
rope (EU), South America (SA), Asia (AS) and all continents
combined (Cont), and for intercontinental traceroutes (Non
Cont).
Continent
Asia
Africa
Europe
N. America
Oceania
S. America
Non-Best/Short Decisions explained
40.1%
62.5%
64.3%
10.9%
62.9%
66.6%
Table 3: Summary of Non-Best/Short decisions explained by
ASes preferring intra-country routes.
6.
IMPACT OF GEOGRAPHY
We next consider the role of geography on routing decisions.
First, we isolate traceroutes that stay within a continent (Continen-
tal traceroutes), i.e., all hops stay inside a given continent based on
geolocating router IP addresses. Figure 3 shows the breakdown of
decisions in the continental traceroutes (45% of our dataset). The
fraction of decisions explained by GR for continental traceroutes is
signiﬁcantly greater than for intercontinental ones.
Domestic paths. Next we focused on traceroutes where we infer
that the entire traceroute stayed within a single country, but there is
a better multinational Best/Short path (in the CAIDA data), which
we deﬁne to be a path with at least one AS registered (via whois
data) in a country outside the source and destination AS’s country.
We ﬁnd that more than 40% of non-Best/Short decisions can be ex-
plained by avoiding alternative multinational paths. One limitation
of this approach is that even for the ASes that reside in multiple
countries, whois data still points to just one country or when an
AS spans across multiple regional internet registries then each RIR
shows different country as the origin of that AS. Table 3 details the
non-Best/Short decisions explained by ASes preferring domestic
routes.
Undersea cables. Undersea cable ASes are a critical component
of Internet topologies that previous works overlook [15,25]. While
some cables are jointly owned by large ISPs, e.g., Pan-American
Crossing, Americas-II (owned by AT&T, Sprint, and many oth-
ers), we observed that others, e.g., EAC- C2C (PACNET), are oper-
ated by independent organizations using their own allocated ASNs
and IP preﬁxes. Because these cable operators only provide point-
to-point transit along the cables (i.e., they do not originate trafﬁc
and peer in locations proportional to cable landings), they resemble
high-latency, high-cost IXPs and thus confuse existing AS relation-
ship models. As such, we need techniques to identify cable ASes
and correct their relationships in inferred topologies.
We use a list of undersea cables from the TeleGeography Subma-
 0 20 40 60 80 100AFNAEUSAASContNon ContPercentage of DecisionsBest/ShortNonBest/ShortBest/LongNonBest/Long76[11] L. Gao and J. Rexford. Stable Internet routing without global
coordination. Trans. Netw., 2001.
[12] P. Gill, S. Goldberg, and M. Schapira. A survey of interdomain
routing policies. ACM CCR, 2014.
[13] P. Gill, M. Schapira, and S. Goldberg. Let the market drive
deployment: A strategy for transistioning to BGP security.
SIGCOMM’11, 2011.
[14] P. Gill, M. Schapira, and S. Goldberg. Modeling on quicksand:
dealing with the scarcity of ground truth in interdomain routing data.
SIGCOMM Comput. Commun. Rev., 42(1):40–46, Jan. 2012.
[15] V. Giotsas, M. Luckie, B. Hufﬁer, and K. Claffy. Inferring Complex
AS Relationships. In ACM IMC, November 2014.
[16] S. Goldberg, M. Schapira, P. Hummon, and J. Rexford. How secure
are secure interdomain routing protocols? In SIGCOMM’10, 2010.
[17] T. Grifﬁn, F. B. Shepherd, and G. Wilfong. The stable paths problem
and interdomain routing. Trans. Netw., 2002.
[18] G. Huston. Peering and settlements - Part I. The Internet Protocol
Journal (Cisco), 2(1), March 1999.
[19] G. Huston. Peering and settlements - Part II. The Internet Protocol
Journal (Cisco), 2(2), June 1999.
[20] U. Javed, I. Cunha, D. R. Choffnes, E. Katz-Bassett, T. Anderson,
and A. Krishnamurthy. Poiroot: Investigating the root cause of
interdomain path changes. In SIGCOMM, 2013.
[21] J. Karlin, S. Forrest, and J. Rexford. Nation-state routing:
Censorship, wiretapping, and BGP. CoRR, 2009.
[22] E. Katz-Bassett, C. Scott, D. R. Choffnes, I. Cunha, V. Valancius,
N. Feamster, H. V. Madhyastha, T. Anderson, and A. Krishnamurthy.
LIFEGUARD: Practical repair of persistent route failures. In
SIGCOMM, 2012.
[23] C. Labovitz, S. Iekel-Johnson, D. McPherson, J. Oberheide, and
F. Jahanian. Internet inter-domain trafﬁc. In SIGCOMM’10, 2010.
[24] M. Lad, D. Massey, D. Pei, Y. Wu, B. Zhang, and L. Zhang. PHAS:
A preﬁx hijack alert system. In Proc. USENIX Security Symposium,
2006.
[25] M. Luckie, B. Huffaker, A. Dhamdhere, and V. Giotsas. AS
relationships, customer cones, and validation. In ACM Internet
Measurement Conference, 2013.
[26] R. Lychev, S. Goldberg, and M. Schapira. Is the juice worth the
squeeze? BGP security in partial deployment. In SIGCOMM’13,
2013.
[27] H. Madhyastha, E. Katz-Bassett, T. Anderson, A. Krishnamurthy,
and A. Venkataramani. iPlane Nano: Path prediction for peer-to-peer
applications. In Usenix NSDI, 2009.
[28] R. Mazloum, M. Buob, J. Auge, B. Baynat, D. Rossi, and
T. Friedman. Violation of Interdomain Routing Assumptions. In
Passive and Active Measurement Conference, March 2014.
[29] W. Mühlbauer, A. Feldmann, O. Maennel, M. Roughan, and
S. Uhlig. Building an AS-topology model that captures route
diversity. In SIGCOMM, 2006.
[30] R. Oliveira, D. Pei, W. Willinger, B. Zhang, and L. Zhang.
Quantifying the completeness of the observed internet AS-level
structure. UCLA Computer Science Department - Techical Report
TR-080026-2008, Sept 2008.
[31] Quantcast. http://www.quantcast.com.
[32] RIPE ASN Neighbor History. https:
//stat.ripe.net/widget/asn-neighbours-history.
[33] RIPE RIS raw data. http://www.ripe.net/data-tools/
stats/ris/ris-raw-data.
[34] RIPE Network Coordination Center. RIPE Routing Information
Service.
http://www.ripe.net/data-tools/stats/ris/routing-information-service.
[35] M. Roughan, W. Willinger, O. Maennel, D. Perouli, and R. Bush. 10
lessons from 10 years of measuring and modeling the Internet’s
autonomous systems. JSAC, 2011.
[36] Sandvine. Fall 2012 global internet phenomena, 2012.
[37] B. Schlinker, K. Zariﬁs, I. Cunha, N. Feamster, and E. Katz-Bassett.
PEERING: An AS for Us. In Proc. ACM HotNets, Los Angeles, CA,
October 2014.
[38] TeleGeography Submarine Cable Map.
http://www.submarinecablemap.com/.
[39] University of Oregon Route Views Project.
http://www.routeviews.org/.
[40] V. Valancius, N. Feamster, J. Rexford, and A. Nakao. Wide-area
route control for distributed services. In USENIX ATC, 2010.
[41] J. Wu, Y. Zhang, Z. M. Mao, and K. Shin. Internet routing resilience
to failures: Analysis and implications. In CoNEXT, 2007.
77