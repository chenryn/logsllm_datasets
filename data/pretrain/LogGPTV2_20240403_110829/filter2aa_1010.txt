July 19, 2005
C
1
Hacking from WEB
行政院 国家资通安全会报
技术服务中心
For HIT2005
Charmi Lin
C
2
前言
•网站伺服器(Web Server)，几乎是每一个
组织单位在网际网路上都必须要提供的网
路服务。
•WEB管理失当的危险
C
3
常见的WEB弱点
• 伺服器应用程式Buffer Overflow
• MISConfiguration(配置失当)
• 使用者输入验证上的错误
• 网页程式逻辑上的错误
• 程式输出错误
• 密码管制失当
C
4
Buffer Overflow
•常被使用也最容易修补、发现
•修补方式仅需安装厂商的修补程式即可
C
5
MISConfiguration
•目录权限失当
–Windows 2000预设将inetpub\wwwroot目录给
于everyone完全的控制权限(可以执行、读取、
写入) 
–User将Apache使用root权限执行
C
6
MISConfiguration
•提供功能失当
–WEBDAV的支援
–汤姆猫的8005 port
C
7
WebDAV
•WebDAV是什么？
•"Web-based Distributed Authoring and 
Versioning".
•它是一组由 HTTP/1.1 的功能延伸出来的
通讯协定，让用户端发行(公布资源让他人
使用)、锁定、并管理 Web 上的资源，使得
使用者们得以经由网页来共同编辑、整
理、管理档案资料。
C
8
WebDAV的‘好处’
•启用WebDAV的好处???
–具有权限的使用者就可以在 WebDAV 目录中自由复制、寻找 、
删除并移动档案。
–修改与某些资源相关的内容。 举例来说，使用者可以写入并取回
档案的内容资讯。
–将资源锁定或解除锁定，如此多位使用者可同时读取档案，但一
次只有一个人可以修改档案。
–搜寻 WebDAV 目录中的档案的要旨与内容。举例来说，您可以搜
寻所有含有 table 这个字的档案，或是搜寻所有由 Fred 建立的档
案。
谁是有权限的使用者?
谁可以决定要不要用webdav功能?
好处真的是好处吗?
C
9
WebDAV指令
• OPTIONS  ? 可以查询网站提不提供WebDAV指令
OPTIONS * HTTP/1.1
Host: localhost
HTTP/1.1 200 OK
Server: Microsoft-IIS/5.0
Date: Fri, 11 Aug 2000 14:09:10 GMT
Content-Length: 0
Accept-Ranges: bytes
DASL: 
DAV: 1, 2
Public: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, 
MKCOL, PROPFIN
D, PROPPATCH, LOCK, UNLOCK, SEARCH
Allow: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE,
MKCOL, PROPFIND
, PROPPATCH, LOCK, UNLOCK, SEARCH
Cache-Control: private
C
10
WebDAV指令
•HEAD ? 查询档案存不存在
HEAD /dir/ HTTP/1.1
Host: iis-server
Content-Length: 0 
C
11
WebDAV指令
•PUT 直接上传档案
•Delete 删除档案
•Move 搬移档案
C
12
MISConfiguration
•元件配置失当
–FrontPage Server Extension元件
C
13
FrontPage Server Extension漏洞
•什么是FrontPage Server Extension 
–一套功能强大的网站管理软体，支援
FrontPage 中的HTML 编辑制作；并扩充 Web 
伺服器功能之程式及 Script 的集合，让使用者
可以快速地进行搬移档案、检查超连结等动
作，管理整个网站
又是一样的老问题：
谁有权利可以透过FrontPage来管理网站?
谁可以决定要不要启用FrontPage Server Extension功能?
C
14
FrontPage Server Extension漏洞
•谁有权利可以透过FrontPage来管理网站?Windows的
存取控制
•!!!!!!Windows预设Everyone拥有档案的完全控制权
任何人都可以透过
FrontPage来管理你
的网站
C
15
FrontPage Server Extension漏洞
•谁可以决定要不要启用FrontPage Server 
Extension功能?
!!!!预设会安装FrontPage Server Extension!!!!
C
16
MISConfiguration
•范例档配置失当
–IIS showcode.asp
–Php phpinfo.php
–Tomcat pageInfo.jsp
C
17
MISConfiguration
•网页编辑器失当
–old
–bak
–~
C
18
使用者输入验证上的错误
•SQL Injection 
•XSS
•Code injection
•路径跳脱
C
19
XSS
•http://IP/
C
20
程式逻辑上的错误
•仅对使用者是否有权限读取档案作管理
•仅对登入画面做权限控管
•将重要的资料放在Form表单的隐藏栏位中
•使用教科书上的档名、目录
C
21
程式输出错误
C
22
密码管制失当
C
23
案例说明－OfficeScan隐含弱点事
件
•Trend Micro OfficeScan CGI Directory Insufficient 
Permissions Vulnerability
–Trend Micro OfficeScan Corporate Edition 3.0
–Trend Micro OfficeScan Corporate Edition 3.5
–Trend Micro OfficeScan Corporate Edition 3.11
–Trend Micro OfficeScan Corporate Edition 3.13
–Trend Micro OfficeScan Corporate Edition 3.54
–Trend Micro Virus Buster Corporate Edition 3.52
–Trend Micro Virus Buster Corporate Edition 3.53
–Trend Micro Virus Buster Corporate Edition 3.54
–皆有弱点
C
24
案例说明－OfficeScan隐含弱点事
件
•正常的登录画面
–拥有密码的人才有权利进入系统 ???
C
25
案例说明－OfficeScan隐含弱点事
件
•只要知道档案放在哪里，就可以窜改密码!!!!!!!
C
26
恭请指正