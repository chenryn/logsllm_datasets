title:Performance Limitations of ADSL Users: A Case Study
author:Matti Siekkinen and
Denis Collange and
Guillaume Urvoy-Keller and
Ernst W. Biersack
Performance Limitations of ADSL Users:
A Case Study(cid:2)
Matti Siekkinen1,(cid:2)(cid:2), Denis Collange2, Guillaume Urvoy-Keller3,
and Ernst W. Biersack3
1 University of Oslo, Dept. of Informatics, Postbox 1080 Blindern, 0316 Oslo, Norway
2 France T´el´ecom R&D, 905, rue Albert Einstein, 06921 Sophia-Antipolis, France
PI:EMAIL
3 Institut Eurecom, 2229, route des crˆetes, 06904 Sophia-Antipolis, France
PI:EMAIL
{urvoy,erbi}@eurecom.fr
Abstract. We report results from the analysis of a 24-hour packet trace
containing TCP traﬃc of approximately 1300 residential ADSL clients.
Some of our observations conﬁrm earlier studies: the major fraction of
the total traﬃc originates from P2P applications and small fractions of
connections and clients are responsible for the vast majority of the traﬃc.
However, our main contribution is a throughput performance analysis of
the clients. We observe suprisingly low utilizations of upload and down-
load capacity for most of the clients. Furthermore, by using our TCP root
cause analysis tool, we obtain a striking result: in over 90% of the cases,
the low utilization is mostly due to the (P2P) applications clients use,
which limit the transmission rate and not due to network congestion, for
instance. P2P applications typically impose upload rate limits to avoid
uplink saturation that hurt download performance. Our analysis shows
that these rate limits are very low and, as a consequence, the aggregate
download rates for these applications are low.
1 Introduction
We analyze a large packet trace of clients connected to the Internet via ADSL
to investigate the causes of throughput limitations experienced by the end users.
For this purpose we use a TCP root cause analysis tool that we apply to TCP
connections. We consider throughput as the performance metric. The cause that
limits the performance of a particular connection can be located either at the
edge (sender or receiver) of a connection or inside the network. Limitations at
edge comprise the application not providing data fast enough to the TCP sender
or the TCP receiver window being too small. A network limitation may be due
to the presence of a bottleneck anywhere along the end-to-end path. We perform
root cause analysis of performance both at connection level and at client level.
Based on a packet level trace that captures the activity of over one thousand
ADSL clients during 24 hours we see that
(cid:2) This work has been partly supported by France Telecom, project CRE-46126878.
(cid:2)(cid:2) Work mostly done while at Institut Eurecom.
S. Uhlig, K. Papagiannaki, and O. Bonaventure (Eds.): PAM 2007, LNCS 4427, pp. 145–154, 2007.
c(cid:2) Springer-Verlag Berlin Heidelberg 2007
146
M. Siekkinen et al.
– The distribution of the client activity in terms of volume and duration is
highly skewed. Most clients are active only during a short period of time.
Also, most clients generate a limited amount of traﬃc in the order of sev-
eral tens of MB, while a small number of (heavy hitter) clients upload and
download hundreds of MB each.
– The utilization of the uplink and downlink is very low for most of the clients.
Even heavy hitters are far from saturating their access link.
– The low utilization is mainly due to the applications that limit their rate of
transfer, which is now very common for P2P applications such as eDonkey.
2 Dataset
We collected one full day (Friday March 10, 2006) of traﬃc generated by ap-
proximately 3000 ADSL users identiﬁed by IP addresses. We captured all IP,
TCP and UDP headers of packets without any sampling or loss. The data col-
lected on this day represents approximately 290 GB of TCP traﬃc in total, out
of which 64% is downstream and 36% upstream. This day can be considered as
a typical day in terms of volumes uploaded and downloaded by clients. Out of
those 3000 clients, 1335 generated enough data to enable any root cause analy-
sis. We consider only those clients in further analysis. In addition to the packet
trace, we have a list of IP addresses that belong to local clients, which allows
us to distinguish the upstream traﬃc from the downstream traﬃc. However, we
do not know the clients subscription rates, i.e., their uplink and downlink ca-
pacities. The oﬀered subscriptions were (down/up): 128/64, 512/128, 1024/256,
1024/128, 2048/128, 2048/256, 3072-4096/160, 4096-5120/192, 5120-6144/224,
6144-8640/256, and 18500/840.
We ﬁrst analyzed the overall characteristics of the trace. Due to space con-
straints, we report here only the main ﬁndings from this study. For further de-
tails, we refer the reader to our technical report[1] which is an extended version
of this paper.
The average volume of data uploaded is quite constant during the whole
day, around 2GB per 30 minute period. The volume of downloaded data is less
constant, around 3 GB per 30 minute period from midnight to 6 am and around
4 GB per 30 minute period for the rest of the day.
Only 5 applications generated more than 5% of the total amount of bytes: E-
donkey, applications using port 80/8080, BitTorrent, email and telnet (due to a
couple of hosts that generated large amount of traﬃc using telnet for some un-
known reasons). We identify applications using port numbers and associated the
TCP port range 4660-4669 to eDonkey, the ports 6880-6889 and 6969 (tracker)
to BitTorrent. We do not want to declare the traﬃc seen on ports 80 and 8080 as
Web traﬃc since it is likely to include also P2P traﬃc. The dominant category of
traﬃc, however, is the traﬃc from unidentiﬁed applications, referred to as “other”
traﬃc in the rest of the paper. Since much of today’s traﬃc is not using ﬁxed ports
but “hiding” [2], we are not able with our port-based method to classify much of
the traﬃc seen. Therefore, the “other” traﬃc represents about 50% of the total
Performance Limitations of ADSL Users: A Case Study
147
traﬃc. However, our root cause analysis (see next section) does not rely on the
identiﬁcation of the application to infer the causes for throughput limitation.
Distributions of the traﬃc per connection and per client are heavily skewed.
Consequently, clients can be classiﬁed into two classes: heavy hitters and non
heavy hitters. We identiﬁed heavy hitters as the 15% of clients that generated
85-90% of the bytes both upstream and downstream. They represent 200 clients.
Those results are in line with the ones of a recent study performed on a much
larger scale for Japan’s residential user traﬃc [3]. The average amount of bytes
uploaded and downloaded by a heavy-hitter client is approximately 470 MB and
760 MB, respectively, while for a non heavy-hitter those average values are 9
MB and 27 MB.
Heavy hitters also diﬀer from non heavy hitters in terms of the set of ap-
plications they use. Overall, heavy hitters tend to use P2P applications more
extensively, which is visible when looking at the identiﬁed applications (heavy
hitters heavily use eDonkey) and also when merely looking at the volumes up-
loaded and downloaded (see above), which are signiﬁcantly more symmetric for
a heavy hitter than for a non heavy hitter.
Access link utilizations1, uplink and downlink, are in general very low. We
observed that 80% of the clients have a downlink utilization of less than 20%
and uplink utilization of less than 40% for a given 30 minute period.
Having seen that most clients achieve very low link utilization, we will now
set out to investigate the causes. For this purpose, we will use some techniques
referred to as root cause analysis (RCA) that has been originally proposed by
Zhang et al. [4] and further reﬁned by Siekkinen et al. [5].
3 Performance Analysis of Clients
3.1 Connection-Level Root Cause Analysis
To apply RCA, we need TCP connections that carry at least 130 data packets,
which is equivalent to about 190 kB of data, if we assume MSS to be 1450 B.
As pointed out in Section 2, most connections are quite small, but most of the
bytes are carried in a tiny fraction of the largest connections. As a consequence,
our RCA will only be able to analyze the 1% of the largest connections, which
however carry more than 85% of total bytes.
We classify in a ﬁrst step the packets of a connection into two groups. Each
packet is either part of an application limited period (ALP) or a bulk data
transfer period (BTP). Roughly speaking, the throughput of packets that are
part of an ALP is limited by the behavior of the application. For example, an
IP telephony application that produces packets at a ﬁxed rate clearly deter-
mines (and limits) the throughput achieved. Therefore, the packets of the TCP
connection carrying these data should all be put into an ALP.
1 Due to lack of knowledge about clients’ access link capacities, we estimated a lower
bound for the capacity and, thus, obtain an upper bound for the utilization. Details
are presented in the extended version[1].
148
M. Siekkinen et al.
The packets that are not part of an ALP will be part of a BTP. For the details
on how packets get classiﬁed into ALPs and BTPs, we refer to our technical
report [6].
For packets that are part of a BTP, there can be a number of causes that
limit the throughput achieved, such as:
– Network limitation: A bottleneck limits the observed throughput. We dis-
tinguish between two types of network limitation. One is called un-shared
bottleneck and corresponds to the case where a single connection uses the
full capacity of the bottleneck link. The other type, called shared bottle-
neck, occurs when several connections share the capacity of the bottleneck
link.
– TCP end-point limitation: The advertised receiver window is too small
as compared to the bandwidth-delay product of the path, which prevents
the sender to achieve a higher throughput. Note that in practice, the sender
buﬀer size is rarely too small[5]. We count into this category also transport
limitation which relates to the time spent for TCP ramp up[4].
The choice of the most likely limitation is based on a set of metrics computed
from the packet header trace of the connection and a threshold-based classiﬁca-
tion scheme. For details, see [5] and esp. Chapter 7 of [7].
3.2 Client-Level Root Cause Analysis
We are interested in doing RCA not only at connection level but also at client
level. We identify four types of limitations for clients, which are: (i) Applications,
(ii) Access link saturation, (iii) Network limitation due to a distant bottleneck,
and (iv) TCP end-point limitation. Our analysis showed the TCP end-point
limitation category (described above) to be marginal in our data set. Hence, we
exclude this limitation category from further discussions.
In this analysis, we focus on active clients. We deﬁne a client to be active
during a period of 30 minutes if it transferred at least 100 kB during that period.
For each active client we consider all the bytes transferred by all the connections
of the client within a given 30-minute period. We then associate these bytes into
the three considered client-level limitations. To do this association, we use the
connection-level RCA as follows: All the bytes carried by the ALPs of all the
connections of the client are associated to application limitation. All the bytes
carried by all the BTPs that are labeled network limited (unshared or shared
bottleneck) by connection-level RCA and during which the utilization is above
90% of the maximum are associated to access link saturation. All the bytes
carried by the rest of the network limited BTPs during which the utilization is
below 90% of the maximum are associated to network limitation due to a distant
bottleneck. All the rest of the bytes transferred by the client, and not covered by
these three limitations, are associated to “other” (unknown) client limitation.
The amount of bytes associated with a limitation serves as a quantitative metric
of the degree of that limitation for a given client during a 30-minute period.
Performance Limitations of ADSL Users: A Case Study
149
We know from our previous work on RCA that for a single, possibly very long
connection, the limitation cause may vary over time. Also, a single client may
run one or more applications that will originate multiple connections. Assign-
ing a single limitation cause to each client is therefore tricky. For this reason,
we distinguish for each client between “main limitation” and “limitations ex-
perienced”. As main limitation, we mean the limitation that aﬀects the most
number of bytes for this client. This classiﬁcation is exclusive. i.e. each client
belongs to a single limitation category.
On the other hand, under limitations experienced a single client will be
considered in all the categories whose limitation causes it has experienced. There-
fore, this classiﬁcation is not exclusive. The results are presented in Table 1 for
two 30-minute periods of the day: 4-4:30am and 3-3:30pm, which are represen-
tative for the diﬀerent periods of the day. During the night time, heavy hitters
dominate (70 out of 77 active uploading clients and 61 out of 83 active download-
ing clients), which is not surprising if one considers that heavy hitters heavily
use P2P applications and P2P ﬁle transfer that can run for several hours [8]. If
we look at the absolute number of clients, we see that only a small fraction of
1335 clients is active in either 30-minute period. We show only the results for
the upstream direction, the ones for the downstream direction being very similar
and are given in our technical report [6].
Table 1. Number of active clients limited by diﬀerent causes
limitation cause
Total active # application access link other link other cause
Upstream
all
all
main
4am
clients 3pm
limitation heavy 4am
hitters 3pm
4am
limitations clients 3pm
experienced heavy 4am
hitters 3pm
77
205
70
111
77
205
70
111
95%
86%
94%
92%
100%
100%
90%
92%
0%
6%
0%
2%
0%
7%
0%
5%
4%
4%
4%
3%
60%
39%
66%
64%
1%
4%
2%
3%
–
–
–
–
Main Limitation. If we look at the main limitation cause experienced by the
clients, we see that almost all clients see their throughput performance mainly
limited by the application. This holds irrespective of the direction of the stream
(upstream or downstream), of the type of client, average client or heavy hitter,
and of the period of the day.
The clients that are not application limited see their throughput either limited
by the capacity of the access link or the capacity of another link along the end-
to-end path. Capacity limitations occur more frequently during the daytime
than at night. The very limited number of cases where we observe a saturation
of the access link complies with the low access link utilization observed in the
preliminary analysis (Section 2).
150
M. Siekkinen et al.
Limitations Experienced. Besides the main limitation, we also consider all
the limitation causes experienced by a single client. The most striking result is
the diﬀerence between main limitation and limitations experienced for the ”other
link” limitation. As we have seen, this limitation is rarely the main limitation,
while the percentage of clients that experience such limitation is between 40%
and 60%, which means that while approximately half of the clients experience
such network limitation, this limitation cause is not dominant. Moreover, we
checked that for a given client, the amount of bytes transferred while limited by
the network is generally clearly less than the amount of bytes transferred while
limited by the dominant cause, i.e. the application in almost all of the cases.
3.3 Throughput Limitations Causes Experienced by Major
Applications
Having done the root cause analysis on a per-client basis, we now perform
application-level RCA, i.e. we investigate what are the most important appli-
cations that experience the diﬀerent limitation causes, namely (i) application
limited, (ii) saturated access link, and (iii) bottleneck at distant link. For each
30-minute period, we associate bytes ﬂagged with limitations by client-level RCA
to diﬀerent applications based on the used TCP ports (as in Section 2).
Figure 1(a) shows the main applications that generate traﬃc that is appli-
cation limited. If we look at the evolution of the total volume of traﬃc that is
application limited we see very little variation in time and an upload volume
almost as big as the download volume, both being around 2 GB per 30 minutes.
The largest single application that generates application limited traﬃc is, as ex-
pected, eDonkey. However, if we look by volume, the largest category is “other”,
i.e. the one where we were not able to identify the application generating the
traﬃc. The overall symmetry of upload and download volumes for the “other”
category as well as a manual analysis of the traﬃc of some heavy hitters strongly
suggest that the “other” category contains of a signiﬁcant fraction of P2P traﬃc.
Figure 1(b) shows the main applications that saturate the access link. For this
cause, no traﬃc originating from recognized P2P applications was seen. Instead,
a signiﬁcant portion of traﬃc saturating the uplink is e-mail. For the downlink it
is mainly traﬃc on ports 80 and 8080 and traﬃc for which the application could
not be identiﬁed. The fact that the traﬃc using ports 80 and 8080 primarily
saturates only downlink suggests that it could be real Web traﬃc that consists
of small upstream requests and larger downstream replies from the server, as
opposed to P2P traﬃc which is typically more symmetric. If we look at the
absolute volumes, we see that most of the activity is concentrated to day time,
with the peak being in the early afternoon.
Figure 1(c) shows the main applications that see their throughput limited
by a link that is not the client’s access link. The category of other applications
is clearly dominating in terms of volume. Otherwise, we observe a mixture of
applications. It is expected that the set of applications is diverse since this type
of network limitation can occur at any point of the network regardless of the
application behavior at the particular client experiencing that limitation.
Performance Limitations of ADSL Users: A Case Study
151
m
a
e
r
t
s
p
u
d
e
r
r
e
f
s
n
a
r
t
s
e
t
y
b