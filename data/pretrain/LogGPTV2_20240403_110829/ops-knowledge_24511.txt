User: How to configure the automatic expansion strategy in the Kubernetes cluster
Assistant: The automatic expansion strategy in the Kubernetes cluster can be realized by using the Horizontal Pod Autoscaler (HPA). HPA is a controller in Kubernetes that can automatically expand or shrink pods according to indicators such as CPU usage and memory usage. The following are the steps to create an HPA: 1. In the deployment or replica set, set the resource limit for the Pod, for example, the CPU usage limit is 50m: ``` apiVersion: apps/v1 kind: Deployment metadata: name: my-app spec: replicas : 3 template: metadata: labels: app: my-app spec: containers: - name: my-app image: my-image resources: limits: cpu: "50m" requests: cpu: "30m" ``` 2. Create HPA specifies resource indicators and target values, such as keeping the average CPU usage below 50%: ``` apiVersion: autoscaling/v2beta2 kind: HorizontalPodAutoscaler metadata: name: my-app-hpa spec: scaleTargetRef: apiVersion: apps/v1 kind: Deployment name: my-app minReplicas: 1 maxReplicas: 10 metrics: - type: Resource resource: name: cpu targetAverageUtilization: 50 ``` The above HPA automatically expands and shrinks the number of Pod replicas to maintain CPU usage The average is below 50%. 3. Apply HPA: ``` kubectl apply -f hpa.yaml ``` Now, Kubernetes will automatically expand and shrink Pods according to the specified parameters. You can use `kubectl get hpa` command to view HPA status and metrics.