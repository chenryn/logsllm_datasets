有更高的基础技能要求，初学者不易掌握。在实战化环境中，最常用
的工具有IDA、Ghidra、Binwalk、OllyDbg、Peach Fuzzer等。
1）IDA。IDA是一个专业的反汇编工具，是安全渗透人员进行逆向
安全测试的必备工具，具有静态反汇编和逆向调试等功能，能够帮助
安全测试人员发现代码级别的高危安全漏洞。
2）Ghidra。Ghidra是一款开源的跨平台软件逆向工具，目前支持
的平台有Windows、macOS及Linux，提供反汇编、汇编、反编译等多种
功能。Ghidra P-Code是专为逆向工程设计的寄存器传输语言，能够对
许多不同的处理器进行建模。
3）Binwalk。Binwalk是一个文件扫描、提取、分析工具，可以用
来识别文件内包含的内容和代码。Binwalk不仅可以对标准格式文件进
行分析和提取，还能对非标准格式文件进行分析和提取，包括压缩文
件、二进制文件、经过删节的文件、经过变形处理的文件、多种格式
相融合的文件等。
4）OllyDbg。OllyDbg是一款强大的反汇编工具，结合了动态调试
与静态分析等功能。它是一个用户模式调试器，可识别系统重复使用
的函数并将其参数注释。OllyDbg还可以调试多线程应用程序，从一个
线程切换到另一个线程、挂起、恢复和终止，或改变它们的优先级。
5）Peach Fuzzer。Peach Fuzzer是一款智能模糊测试工具，广泛
用于发现软件中的缺陷和漏洞。Peach Fuzzer有两种主要模式：基于
生长的模糊测试和基于变异的模糊测试。
7. 编写PoC或EXP等高级利用
前文已经介绍了PoC和EXP的概念，这里不再赘述。相较于针对Web
应用和智能硬件/IoT设备编写PoC或EXP，针对各种类型的操作系统和
安全设备编写PoC或EXP要更加困难。高阶能力中，比较受关注的操作
系统平台有Android、iOS、Linux、macOS。
1）Android平台代码能力。Android是由谷歌公司和开放手机联盟
领导及开发的操作系统，主要用于移动设备，如智能手机和平板电脑
上。这里Android平台代码能力代指在Android操作系统上找到漏洞并
利用漏洞编写PoC或EXP的能力。
2）iOS平台代码能力。iOS是由苹果公司开发的移动操作系统，主
要用于iPhone、iPod touch、iPad上。这里iOS平台代码能力代指在
iOS操作系统上找到漏洞并利用漏洞编写PoC或EXP的能力。
3）Linux平台代码能力。Linux主要用于服务器的操作系统，
Ubuntu、CentOS等均属基于Linux内核基础上开发的操作系统。这里
Linux平台代码能力代指在Linux操作系统上找到漏洞并利用漏洞编写
PoC或EXP的能力。
4）macOS平台代码能力。macOS是由苹果公司开发的操作系统，主
要用于Macintosh系列电脑上。macOS的架构与Windows不同，很多针对
Windows的电脑病毒在macOS上都无法攻击成功。这里macOS平台代码能
力代指在macOS操作系统上找到漏洞并利用漏洞编写PoC或EXP的能力。
在实战化环境中，经常会使用的网络安全设备和系统有IP密码
机、安全路由器、线路密码机、防火墙、安全服务器、公开密钥基础
设施（PKI）系统、授权证书（CA）系统、安全操作系统、防病毒软
件、网络/系统扫描系统、入侵检测系统、网络安全预警与审计系统
等。网络安全设备本身也会存在各种各样的安全漏洞，在近年来的实
战攻防演练中，对此类漏洞的利用越来越多。这里网络安全设备代指
在各类网络安全设备中找到漏洞并利用漏洞编写PoC或EXP的能力。
8. 团队协作
攻击队主要包含行动总指挥、情报搜集人员、武器装备制造人
员、打点实施人员、社工钓鱼人员、内网渗透人员等角色。随着实战
攻防演练的不断深入，防守队的整体能力持续提升，这就使得攻击队
人员凭个人能力单打独斗取得胜利的希望越来越小。而由3～5人组成
的攻击小队，通过分工协作高效完成攻击行动的模式越来越成熟。是
否拥有团队协作的作战经验，团队中各成员分别扮演什么样的角色，
是蓝队实战化能力的重要指标。
团队作战，成功的关键是协作与配合。通常来说，每支攻击队的
成员都会有非常明确的分工和角色。在实战攻防演练中，攻击队比较
常见的角色分工主要有6种，分别是行动总指挥、情报搜集人员、武器
装备制造人员、打点实施人员、社工钓鱼人员和内网渗透人员。
1）行动总指挥：通常是攻击队中综合能力最强的人，需要有较强
的组织意识、应变能力和丰富的实战经验。负责策略制订、任务分
发、进度把控等。
2）情报搜集人员：负责情报侦察和信息搜集，搜集的内容包括但
不限于目标系统的组织架构、IT资产、敏感信息泄露、供应商信息
等。
3）武器装备制造人员：负责漏洞挖掘及工具编写，是攻击队的核
心战斗力量，不仅要能找到并利用漏洞，还要力求在不同环境下达到
稳定、深入的漏洞利用。
4）打点实施人员：负责获取接入点，进行Web渗透等。找到薄弱
环节后，利用漏洞或社工等方法，获取外网系统控制权限；之后寻找
和内网连通的通道，建立据点（跳板）。
5）社工钓鱼人员：负责社工攻击。利用人的安全意识不足或安全
能力不足等弱点，实施社会工程学攻击，通过钓鱼邮件或社交平台等
进行诱骗，进而打入内网。
6）内网渗透人员：负责进入内网后的横向拓展。利用情报搜集人
员的情报结合其他弱点来进行横向拓展，扩大战果。尝试突破核心系
统权限，控制核心任务，获取核心数据，最终完成目标突破工作。
第5章 蓝队经典攻击实例
实战攻防演练中红队网络的部署情况各有特点，蓝队也会根据攻
击目标的不同而采取不同的攻击策略和手段。下面几个案例展示的就
是针对红队网络的不同薄弱点采取的不同的典型攻击策略与方法手
段。
5.1 正面突破：跨网段控制工控设备
某企业为一家国内的大型制造业企业，其内部生产网大量使用双
网卡技术实现网络隔离。在本次实战攻防演练中，攻击队的目标是获
取该企业工控设备的控制权限。
经过前期的情报搜集与分析，攻击队制定了首先突破办公内网，
再通过办公内网渗透进入工控网的战略部署。
（1）突破办公内网
攻击队首先选择将该企业的门户网站作为突破口，并利用一个
0day漏洞获取了该门户网站的应用及操作系统的管理员权限，从而获
取到该企业办公内网的接入权限。
在横向拓展过程中，攻击队又探测到该企业内网中的多个服务系
统和多台服务器。使用已经获得的门户网站管理员账号和密码进行撞
库攻击，成功登录并控制了该企业内网中的绝大多数服务器。这表
明，该企业内网中有大量系统服务器使用了相同的管理员账号和密
码。
至此，攻击队突破办公网的第一阶段目标顺利完成，并取得了巨
大的战果。接下来的目标就是找到工控网络的突破口。
（2）定位运维人员
经过对已攻破服务器系统的全面排查，攻击队发现，有多台服务
器中存储了用Excel明文记录的密码本，密码本中包含所有系统用户的
账号和密码。同时，服务器上还明文存储了大量内部敏感文件，包括
企业IT部门的组织架构等信息。结合组织架构及密码本信息，攻击队
成功定位到一位工控系统的运维人员，并对其联网行为展开长时间的
监控。
（3）突破工控网
经过一段时间的监控，攻击队发现该运维人员的办公终端上有嵌
套使用远程桌面的情况：首先通过远程桌面登录一台主机A，继而又用
主机A通过远程桌面登录另一网段的主机B。通过与密码本比对，发现
主机A和B都是该企业工控系统中的主机设备，但处于网络拓扑结构中
的不同层级。其中，主机B之下连有关键的工控设备。
进一步分析发现：主机A使用了双网卡，两个网卡分别对应不同网
段，但它们之间没有采取任何隔离措施；主机B也是一台双网卡主机，
其上部署了隔离卡软件用于双网卡切换。
最终，攻击队发现了主机B上隔离卡软件的一个重大设计缺陷，并
利用该缺陷成功绕过双网卡的隔离机制，成功获取到工控设备的操作
权限，可以随意停止、启动、复位相应的工控设备，某些操作可对设
备的生产过程造成直接且严重的伤害。
同时，攻击队的另一组人马继续摸排受控主机的用途和存储文
件。功夫不负有心人，攻击队最终又发现一台名为“生产主操作室”
的主机设备，其上存储有生产专用的文件，其中有一些涉密文件，这
些涉密文件一旦被窃取，后果难以想象。
5.2 浑水摸鱼：社工钓鱼，突破系统
某企业为一家国内的大型国有企业，该企业部署了比较完善的网
络安全防护设备。在本次实战攻防演练中，攻击队的目标是获取该企
业财务系统的控制权限。
经过前期的情报搜集与分析，目标企业外网的开放系统非常少，
也没有可利用的漏洞，很难直接突破目标外网，于是攻击队将突破重
点放在了钓鱼上。
（1）破解员工邮箱密码
攻击队通过网上搜索以及搜索一些开源社工库，搜集到一批目标
企业的工作人员邮箱列表。掌握这批邮箱列表后，攻击队便根据已泄
露的密码规则、123456和888888等常见弱口令、用户名与密码相同、
用户名123这种弱口令生成了一份弱口令字典。利用hydra等工具进行
爆破，攻击队成功破解一名员工的邮箱密码。
（2）改造和伪装钓鱼邮件
攻击队对该名员工的来往邮件进行分析后发现，他是IT技术部员
工。查看该邮箱发件箱，看到他发过一封邮件，邮件标题和附件如
下。
标题：关于员工关掉445端口以及3389端口的操作过程
附件：操作流程.zip
攻击队决定浑水摸鱼，在此邮件的基础上进行改造和伪装，构造
钓鱼邮件，邮件标题和附件如下。其中，zip文件为带有木马的压缩文
件。
标题：关于员工关掉445端口以及3389端口的操作补充
附件：操作流程补充.zip
（3）根据身份精准钓鱼