第8章入侵感知体系177
4.螺虫特色功能
Ircbot都是那些古老的功能，下面这些常常才是各种不同BotNet特有的。
漏洞扫描攻击
本案例中是PHP CGI的RCE（CVE-2012-1823）：
vir:~/t1/aa/tmp # 1s
ChangeLog MakefileTODObm.hinst
ipsort
ipsort.sgml php-c  pnscan.1 pnscan.0
version,cws
LICENSE
README
bm.c bm.oinstall-shipsort.1php
pnscan pnscan,c
pnscan.sgml version.0
vir:~/t1/aa/tmp  head php c
/* Apache Magica by Kingcope */
/、 TssT- exTbtuoqoede o- o*extbew-auoede oob /
This is a code execution bug in the combination of Apache and PHP.
On Debian and Ubuntu the vulnerability is present in the default install
Sn 3eo = dsa/ee/4/~:xTA
qsrq/utq/1#
while [ 1 ]: do
_A=echo $((((SRANDOM> PATHS 2>/dev/nul1
TOTAL=grep
SHIVd
ATA.
f151
at
通过上述分析，我们可以看到此僵户网络利用CVE-2012-1823漏洞大肆传播，并且利用
被控的肉鸡进行2种网络货币的挖掘，充分榨取肉鸡系统资源。Botnet架构如图8-33所示。
黑客
挖
Bof
Bot
漏洞攻击
图 8-33BotNet 架构
8.7.3应对僵户网络威胁
图8-34是2013年11月某新出的0day导致的蚂虫（Botnet）爆发，图表示同期Botnet
攻击尝试趋势统计。Botnet从建立到覆灭是有其生命周期的，如图8-35所示，如果发现得
早是可以及时修补漏洞，建立阻断策略，避免其危害扩散。