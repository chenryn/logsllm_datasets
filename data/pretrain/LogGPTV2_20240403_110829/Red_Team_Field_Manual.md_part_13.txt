Provides source routing functionality
Special-Use Ranges
Fragment (44)
::/0 Default route Included when a packet has been fragmented by its source
::/128 Unspecified Encapsulating Security Payload (50)
Provides payload encryption (IPsec)
::1/128 Loopback
Authentication Header (51)
::/96 IPv4-compatible* Provides packet authentication (IPsec)
::FFFF:0:0/96 IPv4-mapped Destination Options (60)
Carries additional information which pertains only to the recipient
2001::/32 Teredo
Transition Mechanisms
2001:DB8::/32 Documentation
Dual Stack
2002::/16 6to4
Transporting IPv4 and IPv6 across an infrastructure simultaneously
FC00::/7 Unique local
Tunneling
FE80::/10 Link-local unicast IPv6 traffic is encapsulated into IPv4 using IPv6-in-IP, UDP (Teredo),
or Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)
FEC0::/10 Site-local unicast*
Translation
FF00::/8 Multicast Stateless IP/ICMP Translation (SIIT) translates IP header fields, NAT
* Deprecated Protocol Translation (NAT-PT) maps between IPv6 and IPv4 addresses
by Jeremy Stretch v2.0
UDPHeader tcpdump Usage
Bit Number
tcpdump [-aenStvx] [-F file]
1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 [-i int] [-r file] [-s snaplen]
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 [-w file] ['filter_expression']
Source Port Destination Port -e Display data link header.
-F Filter expression in file.
Length Checksum
-i Listen on int interface.
TCP/IP and tcpdump -n Don't resolve IP addresses.
UDP Header Information -r Read packets from file.
Common UDP Well-Known Server Ports Version July-2010 -s Get snaplen bytes from each packet.
7 echo 138 netbios-dgm -S Use absolute TCP sequence numbers.
19 chargen 161 snmp P O C K E T R E F E R E N C E G U I D E -t Don't print timestamp.
37 time 162 snmp-trap -v Verbose mode.
53 domain 500 isakmp
-w Write packets to file.
67 bootps (DHCP) 514 syslog
PI:EMAIL • www.sans.org • http://isc.sans.org -x Display in hex.
68 bootpc (DHCP) 520 rip
69 tftp 33434 traceroute -X Display in hex and ASCII.
The SANS Technology Institute (STI)
137 netbios-ns
Length offers two degree programs: Acronyms
(Number of bytes in entire datagram including header; COURSES & GIAC CERTIFICATIONS
minimum value = 8)
MS in Information Security Management  
Checksum FOR558  
(Covers pseudo-header and entire UDP datagram) and Network Forensics  
MS in Information Security Engineering.
ARP MGT512  
SANS Security Leadership Essentials For
Bit Number  
Managers with Knowledge Compression™  
1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 If you have a bachelor’s degree and 12 months GSLC                            
Hardware Address Type Protocol Address Type of experience in information security, follow  
SEC401  
H/w Addr Len Prot. Addr Len Operation these easy steps to get started: SANS Security Essentials Bootcamp Style  
Source Hardware Address GSEC  
Source Hardware Addr (cont.) Source Protocol Address • Complete an application – downloadable at  
www.sans.edu/admissions/procedure.php SEC502
Source Protocol Addr (cont.) Target Hardware Address  
Perimeter Protection In-Depth
Target Hardware Address (cont.)
• Submit the employer recommendation – form is GCFW  
Target Protocol Address  
provided
ARP Parameters (for Ethernet and IPv4) SEC503  
Intrusion Detection In-Depth  
Hardware Address Type • Have your college send sealed transcripts to STI
1 Ethernet GCIA
6 IEEE 802 LAN
• Submit an application fee  
Protocol Address Type SEC556  
2048 IPv4 (0x0800)
Comprehensive Packet Analysis
Hardware Address Length  
6 for Ethernet/IEEE 802  
Protocol Address Length Learn more at www.sans.edu SEC560  
4 for IPv4 Network Penetration Testing & Ethical Hacking  
Operation Contact us at
GPEN  
1 Request
2 Reply PI:EMAIL or (720) 941-4932 All RFCs can be found at http://www.rfc-editor.org
DNS ICMP IPHeader TCPHeader
Bit Number Bit Number Bit Number
Bit Number
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
LENGTH (TCPONLY) Type Code Checksum Version IHL Type of Service Total Length Source Port Destination Port
ID. Other message-specific information... Identification Flags Fragment Offset Sequence Number
QR Opcode AA TC RD RA Z RCODE Time to Live Protocol Header Checksum Acknowledgment Number
Type Name/Codes (Code=0 unless otherwise specified)
Offset
QDCOUNT 0 Echo Reply Source Address (Header Length)Reserved Flags Window
ANCOUNT 3 Destination Unreachable Destination Address Checksum Urgent Pointer
0 Net Unreachable
NSCOUNT 1 Host Unreachable Options (optional) Options (optional)
2 Protocol Unreachable
ARCOUNT 3 Port Unreachable IP Header Contents TCP Header Contents
4 Fragmentation Needed & DF Set
Question Section Common TCP Well-Known Server Ports
5 Source Route Failed Version
7 echo 110 pop3
Answer Section 6 Destination Network Unknown 4 IP version 4
19 chargen 111 sunrpc
7 Destination Host Unknown
Internet Header Length 20 ftp-data 119 nntp
Authority Section 8 Source Host Isolated
Number of 32-bit words in IP header; minimum 21 ftp-control 139 netbios-ssn
Additional Information Section 9 Network Administratively Prohibited value = 5 (20 bytes) & maximum value = 15 (60 bytes) 22 ssh 143 imap
10 Host Administratively Prohibited
11 Network Unreachable for TOS Type of Service (PreDTRCx) --> Differentiated Services 23 telnet 179 bgp
DNS Parameters 12 Host Unreachable for TOS Precedence (000-111) 000 25 smtp 389 ldap
13 Communication Administratively Prohibited D (1 = minimize delay) 0 53 domain 443 https (ssl)
Query/Response 4 Source Quench T (1 = maximize throughout) 0 79 finger 445 microsoft-ds
0 Query 5 Redirect R (1 = maximize reliability) 0 80 http 1080 socks
1 Response 0 Redirect Datagram for the Network C (1 = minimize cost) 1 = ECN capable Offset
x (reserved and set to 0) 1 = congestion experienced
Opcode 1 Redirect Datagram for the Host Number of 32-bit words in TCP header; minimum value = 5
0 Standard query (QUERY) 2 Redirect Datagram for the TOS & Network Total Length
1 Inverse query (IQUERY) 3 Redirect Datagram for the TOS & Host Number of bytes in packet; maximum length = 65,535 Reserved
8 Echo 4 bits; set to 0
2 Server status request (STATUS) Flags (xDM)
9 Router Advertisement
x (reserved and set to 0)
AA 10 Router Selection Flags (CEUAPRSF)
D (1 = Don't Fragment)
(1 = Authoritative Answer) 11 Time Exceeded M (1 = More Fragments) ECN bits (used when ECN employed; else 00)
TC 0 Time to Live exceeded in Transit CWR (1 = sender has cut congestion window in half)
(1 = TrunCation) 1 Fragment Reassembly Time Exceeded Fragment Offset ECN-Echo (1 = receiver cuts congestion window in half)
12 Parameter Problem Position of this fragment in the original datagram,
RD 0 Pointer indicates the error in units of 8 bytes U (1 = Consult urgent pointer, notify server application
(1 = Recursion Desired) of urgent data)
1 Missing a Required Option Protocol A (1 = Consult acknowledgement field)
RA 2 Bad Length 1 ICMP 17 UDP 57 SKIP P (1 = Push data)
(1 = Recursion Available) 13 Timestamp 2 IGMP 47 GRE 88 EIGRP R (1 = Reset connection)
Z 14 Timestamp Reply 6 TCP 50 ESP 89 OSPF S (1 = Synchronize sequence numbers)
(Reserved; set to 0) 15 Information Request 9 IGRP 51 AH 115 L2TP F (1 = no more data; Finish connection)
16 Information Reply
Response code 17 Address Mask Request Header Checksum Checksum
0 No error 18 Address Mask Reply Covers IP header only Covers pseudoheader and entire TCP segment
1 Format error 30 Traceroute Addressing
2 Server failure NET_ID RFC 1918 PRIVATE ADDRESSES Urgent Pointer
3 Non-existant domain (NXDOMAIN) 0-127 Class A 10.0.0.0-10.255.255.255 Offset pointer to urgent data
4 Query type not implemented PING (Echo/Echo Reply) 128-191 Class B 172.16.0.0-172.31.255.255
5 Query refused 192-223 Class C 192.168.0.0-192.168.255.255 Options
Bit Number 224-239 Class D (multicast) 0 End of Options list 3 Window scale
QDCOUNT
240-255 Class E (experimental) 1 No operation (pad) 4 Selective ACK ok
(No. of entries in Question section) 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
HOST_ID 2 Maximum segment size 8 Timestamp
ANCOUNT
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 0 Network value; broadcast (old)
(No. of resource records in Answer section)
255 Broadcast
NSCOUNT Type (8 or 0) Code (0) Checksum
Options (0-40 bytes; padded to 4-byte boundary)
(No. of name server resource records in Authority section)
Identifier Sequence Number 0 End of Options list 68 Timestamp
ARCOUNT 1 No operation (pad) 131 Loose source route
(No. of resource records in Additional Information section. Data... 7 Record route 137 Strict source route
VLAN
S
packetlife.net
Trunk Encapsulation Trunk Types
26 6 6 2 4 802.1Q ISL
ISL Dest Source Header Size 4 bytes 26 bytes
ISL Type FCS
Header MAC MAC
Trailer Size N/A 4 bytes
Dest Source Standard IEEE Cisco
Untagged Type
MAC MAC
Maximum VLANs 4094 1000
Dest Source
802.1Q 802.1Q Type
MAC MAC VLAN Numbers
6 6 4 2 0 Reserved 1004 fdnet
VLAN Creation 1 default 1005 trnet
1002 fddi-default 1006-4094 Extended
Switch(config)# vlan 100
Switch(config-vlan)# name Engineering 1003 tr 4095 Reserved
Access Port Configuration Terminology
Trunking
Switch(config-if)# switchport mode access
Switch(config-if)# switchport nonegotiate Carrying multiple VLANs over the same
Switch(config-if)# switchport access vlan 100 physical connection
Switch(config-if)# switchport voice vlan 150
Native VLAN
By default, frames in this VLAN are untagged
Trunk Port Configuration
when sent across a trunk
Switch(config-if)# switchport mode trunk Access VLAN
Switch(config-if)# switchport trunk encapsulation dot1q The VLAN to which an access port is assigned
Switch(config-if)# switchport trunk allowed vlan 10,20-30
Voice VLAN
Switch(config-if)# switchport trunk native vlan 10
If configured, enables minimal trunking to
SVI Configuration support voice traffic in addition to data traffic
on an access port
Switch(config)# interface vlan100
Dynamic Trunking Protocol (DTP)
Switch(config-if)# ip address 192.168.100.1 255.255.255.0
Can be used to automatically establish trunks
between capable ports (insecure)
VLAN Trunking Protocol (VTP)
Switched Virtual Interface (SVI)
Domain
A virtual interface which provides a routed
Common to all switches participating in VTP
gateway into and out of a VLAN
Server Mode
Generates and propagates VTP advertisements to clients; Switch Port Modes
default mode on unconfigured switches
trunk
Client Mode Forms an unconditional trunk
Receives and forwards advertisements from servers; VLANs
dynamic desirable
cannot be manually configured on switches in client mode
Attempts to negotiate a trunk with the far end
Transparent Mode
dynamic auto
Forwards advertisements but does not participate in VTP;
Forms a trunk only if requested by the far end
VLANs must be configured manually
access
Pruning Will never form a trunk
VLANs not having any access ports on an end switch are
removed from the trunk to reduce flooded traffic Troubleshooting
show vlan
VTP Configuration
show interface [status | switchport]
Switch(config)# vtp mode {server | client | transparent}
Switch(config)# vtp domain  show interface trunk
Switch(config)# vtp password 
show vtp status
Switch(config)# vtp version {1 | 2}
Switch(config)# vtp pruning show vtp password
by Jeremy Stretch v2.0
VOIP B
ASICS
packetlife.net
Pulse Code Modulation (PCM) Power Over Ethernet (PoE)
14 13.6 13.5 14 14 Cisco Inline Power (ILP)
12 12.4 12 12 Pre-standard; employs a 340 kHz tone
12.3
10 9.2 10 10 to detect devices; power needs
8 9.1 8 8
communicated via CDP
6 6.0 5.9 6 6
4 4 4 IEEE 802.3af
2.8 2.7
2 2 2
0.9 1.0 Detects power requirements of PoE
0 0 0
device by the line resistance present
Sampling Quantization Encoding
IEEE 802.3at
Sampling
Uses LLDP to negotiate delivery of up
8000 discrete signal measurements are taken at equal intervals every second
to 25 watts in .10 W intervals
Quantization
The level of each sample is rounded to the nearest expressible value IEEE 802.3af Classes
Encoding 0 15.4 W 3 15.4 W
Digital values are encoded as binary numbers for encapsulation
1 4 W 4 Reserved
Compression (Optional)
The digital signal is compressed in real time to consume less bandwidth 2 7 W
Voice Codecs IP Phone Boot Process
MOS Bandwidth Complexity Free
3
G.722 SB-ADPCM 4.13 48-64 kbps Medium Yes
G.711 PCM 4.1 64 kbps Low Yes
iLBC 4.1 15.2 kbps High Yes 2
5
G.729 CS-ACELP 3.92 8 kbps High No 1 4
G.726 ADPCM 3.85 32 kbps Medium Yes
G.729a CS-ACELP 3.7 8 kbps Medium No TFTP Server Call Server
G.728 LD-CELP 3.61 16 kbps High No