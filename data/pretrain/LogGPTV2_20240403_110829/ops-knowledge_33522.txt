User: 请回答以下安全问题有什么好的理由不对您存储的密码进行salt/hash处理吗？我经常与之打交道的两个组织（包括我的银行）要求我输入密码，以便向他们进行身份验证。。。好他们要求从我的密码中输入“随机”字符。
据我所知，这意味着密码不能被加盐和散列存储？它必须以可检索的格式存储。无论是明文还是某种可逆加密方式。
我的问题是，这是否合理？这真的是个更好的主意吗？
在我看来，这些好处是：
重播攻击更难（哈哈！）
客户希望意识到请求整个密码的网络钓鱼是网络钓鱼
但是，这真的足以抵消技术上非常非常有可能获得整个密码存储的巨大劣势吗？

Assistant: 安全是一项复杂的工作，像“明文密码？永远不会”这样的下意识反应就像“密码必须包含特殊字符”或“我的密码比你的大”或“如果我不能理解，没有人能理解”一样糟糕，如果你不考虑完整的上下文。
首先，让我们分析一下资产。有两个主题：银行和客户。他们持有若干资产：
银行的钱。根据攻击者的行为，银行可能需要花钱解决问题，以补偿客户或其他方，并可能看到其声誉受损。
客户的钱（以及他的私人信息）。
客户的密码。如果妥协，他将需要改变它，也许在其他网站上也是如此。
在一个会话期间发送的身份验证数据。这可能与密码不同，例如，在这里考虑的情况下，这（通常）是密码中的两个随机字符。
银行完全控制着安全架构。毫不奇怪，它将自己资产的安全置于客户资产之上。这对密码来说不是个好兆头。
密码有很多威胁，包括（为了方便起见，编号并不表示任何特定的重要性顺序）：
攻击者可以访问银行的实时系统或备份，并能够以存储中的编码方式访问密码。通过这种方式，攻击者几乎可以肯定地同时获得大量密码。
攻击者可以访问客户使用的计算机（例如，通过在其上安装恶意软件）并获取身份验证数据，从而可能劫持会话。
攻击者通过肩上冲浪或其他无法控制会话的方法获取身份验证数据。
对银行服务器上的密码进行哈希处理可以专门缓解威胁#1，即未经授权访问编码密码。这种缓解措施是有限的，因为它只对足够强的密码有效；即使受到慢速哈希的保护，弱密码也会丢失。
从密码中分离身份验证数据会增加此威胁的漏洞。另一方面，它减轻了威胁#3，在较小程度上减轻了威胁#2：拥有一个会话的身份验证数据的攻击者无法轻易地复制该数据以打开另一个会话。如果他多次尝试，直到收到与他所拥有的身份验证数据相匹配的挑战，他的尝试很可能会被银行的服务器阻止。最终，如果他观察了足够多的成功验证，他会得到整个密码，但他有被注意的风险。
在这一点上，银行需要权衡威胁#1的风险和损害与威胁#3的风险和破坏，并考虑减轻威胁#3的替代方法。有许多身份验证方法，我在这里不详细介绍；我将专注于威胁#1。
如果威胁#1导致攻击，则攻击者拥有大量哈希或非哈希密码。请记住，哈希只会对足够强的密码产生影响。无论如何，攻击者不太可能攻击所有账户，因为过一段时间后，银行的欺诈模式检测会检测到他（可能不是100%准确，但足以减缓他的速度）。因此，他满足于关注那些密码最容易破解的账户；大麻并没有让他慢那么多。在这种情况下，哈希提供的缓解效果不是很好。
如果你是一个拥有强大密码的用户，可以理解的是，你宁愿不受攻击的影响——让游吟诗人首当其冲。该银行有不同的前景：它不在乎谁的账户被攻破，只在乎被攻破的账户数量。如果在这一点上，你对银行不关心那些重视安全的极客感到愤怒——你有信用卡吗？只要有一个，任何人都可以通过快速说出一个16位数的数字来向你的账户收取购买费用，所以你还有一段路要走。
密码哈希评估的另一部分是考虑其他缓解措施。银行不是托管在5美元VPS上的某种服务，它可以提供更好的安全性。例如，银行往往对员工有非常严格的控制，这降低了内部违规的风险。对于外部人员来说，将密码存储在HSM中是一种很好但很尴尬的防御措施（尤其是备份很难）。对密码进行加密并将加密密钥存储在几个智能卡上是另一种可能的缓解措施——它不能保护实时系统，但对备份有效。只要密钥和密码数据库足够独立，很难一起窃取，加密就可以很好地缓解#1的威胁（即使对极弱的密码也有效）。
综合考虑，在这种情况下，密码哈希并不是万能的。虽然这不是一个坏主意，但定性分析表明，需要可逆密码存储的替代方法可能会提供更好的安全性。需要对欺诈和可用性进行非常彻底的研究，才能定量评估使用密码中的随机字符进行身份验证是否值得进行上述密码哈希。