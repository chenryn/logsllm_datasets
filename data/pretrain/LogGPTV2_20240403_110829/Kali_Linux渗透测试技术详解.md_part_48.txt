第3篇各种渗透测试
（9）从该界面可以清楚的看到，截获的客户端用户信息及登录的网站。
9.6在树莓派上破解无线网络
大部分的命令可以正常的运行在BackTrack5或Kali上。在Kali上可以实现的无线渗
透测试，在树莓派上也可以运行。在第1章中介绍了在树莓派上安装KaliLinux操作系统，
下面将介绍在树莓派上实现无线攻击。
（1）在树莓派上使用ifconfig命令查看无线网卡是否被识别。执行命令如下所示：
root@kali:~# ifconfig
etho
Link encap:EthernetHWaddr 00:0c:29:7a:59:75
inet addr:192.168.0.112Bcast:192.168.0.255Mask:255.255.255.0
inet6 addr: fe80:20c:29ff:fe7a:5975/64 Scope:Link
UP BROADCAST RUNNING MULTICASTMTU:1500MetriC:1
RX packets:240510 errors:0 dropped:0 overruns:0 frame:0
TX packets:130632 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:1000
RX bytes:275993519 (263.2 MiB)TX bytes:26073827 (24.8 MiB)
Link encap:Local Loopback
inet addr:127.0.0.1Mask:255.0.0.0
inet6 addr: :1/128 Scope:Host
UP LOOPBACK RUNNING
MTU:65536Metric:1
RX packets:1706270 errors:0 dropped:0 overruns:0 frame:0
TX packets:1706270 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:250361463 (238.7 MiB)TX bytes:250361463 (238.7 MiB)
wlano
Link encap:EthernetHWaddr 22:34:f7:f6:c1:d0
UP BROADCAST MULTICASTMTU:1500Metric:1
RX packets:0 errors:0 dropped:0 overruns:0 frame:0
TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:1000
RX bytes:0 (0.0 B)TX bytes:0 (0.0 B)
从输出的信息中，看到有一个名为wlan0的接口。这表示无线网卡已被识别。如果没
有看到类似信息，执行如下命令启动无线网络，如下所示：
root@kali:~#ifconfig wlan0 up
（2）查看无线网卡信息。执行命令如下所示：
root@kali:~# iwlist wlan0 scanning
wlanO
Scan completed :
Cell 01 - Address: 14:E6:E4:AC:FB:20
Channel:1
Frequency:2.412 GHz (Channel 1)
Quality=62/70Signal level=-48 dBm
Encryption key:on
ESSID:"Test"
Bit Rates:1 Mb/s; 2 Mb/s; 5.5 Mb/s; 11 Mb/s; 6 Mb/s
9 Mb/s;12 Mb/s;18 Mb/s
Bit Rates:24 Mb/s; 36 Mb/s; 48 Mb/s; 54 Mb/s
Mode:Master
Extra:tsf=0000000339efb6a2
Extra: Last beacon: 48ms ago
IE: Unknown:000454657374
· 298 ·
---
## Page 311
第9章无线网络渗透测试
IE:Unknown:010882848B960C121824
IE: Unknown: 030101
IE: Unknown: 0706555320010D14
IE: Unknown: 2A0100
IE: IEEE 802.11i/WPA2 Version 1
Group Cipher: CCMP
Pairwise Ciphers (1): CCMP
Authentication Suites (1):PSK
IE: Unknown: 32043048606C
IE: Unknown: 2D1A2C0003FF000000000000000000000000000000
0000000000000000
IE: Unknown:331A2C0003FF0000000000000000000000000000000
0000000000000
IE:Unknown:3D16010011000000000000000000000000000000000
00000
IE: Unknown:3416010011000000000000000000000000000000000
00000
IE: WPA Version 1
Group Cipher:CCMP
Pairwise Ciphers (1) : CCMP
Authentication Suites (1) : PSK
IE: Unkn0Wn: DD180050F2020101030003A4000027A4000042435E
0062322F00
IE: Unknown: DD0900037F01010000FF7F
IE: Unknown: DD800050F204104A0001101044000102103B0001031
04700100000000000001000000014E6E4ACFB201021000754502D4C
494E4B10230009544C2D57523734304E10240003312E30104200033
12E301054000800060050F204000110110018576972656C65737320
4E20526F757465722057523734304E100800020086103C000101
Cell 09-Address:DA:64:C7:2F:A0:FF
Channel:11
Frequency:2.462 GHz(Channel 11)
Quality=36/70Signal level=-74 dBm
以上输出了的信息显示了无线网卡的相关信息。如网卡MAC地址、信道、加密、速
率和模式等。
（3）启动无线网卡为监听模式。执行命令如下所示：
root@kali:~# airmon-ng start wlan0
Found 3 processes that could cause trouble.
ae buxuom sdojs bu-unpie jo bu-ejdaje *bu-dunpoie 
a short period of time, you may want to kill (some of) them!
a-
PID Name
2618 NetworkManager
2870 wpa_supplicant
27052
dhclient
Interface
Chipset
Driver
wlano
Ralink RT2870/3070 rt2800usb - [phy16]
(monitor mode enabled on mon0)
从输出的信息中，可以看到无线接口wlan0已启动监听模式，其监听接口为mon0。现
在，就可以使用该接口捕获无线管理与控制帧。
在树莓派中，可以使用Wireshark的命令行程序tcpdump或tshark来捕获数据。如果
不喜欢在命令行操作的话，可以使用Wireshark的图形界面来实现。
（1）启动Wireshark工具。执行命令如下所示：
· 299 ·
---
## Page 312
第3篇各种渗透测试
root@kali:~#wireshark &
（2）在Wireshark的接口列表中选择mon0接口，并单击Start按钮，如图9.36所示。
Capture
Files
Interface List
Open
Live list of the capture interfaces
一
aty pa.njdes Ajsnoyaud euado
(courts incoming packets)
Open Recent:
Start
e interfaces to capture from, then Start
Sample Captures
~
A rich assor
 wlano
mono
Ready to load or capture
No Packets
Profile: Default
图9.36选择捕获接口
（3）启动Wireshark捕获后，将显示如图9.37所示的界面。
EleEdtYewGoCaptureAnalyzeStatsticsTelephenyIoosJntemasHep
Fiter
wlanf.type ss 0
Clear Apply Save
Destinatior
gth Infc
108 43.174220000 Tp-L1nkT_ac:fb:20 K1ngJonD_20:22:92 802.11
407 Probe
L09 43.406340000 1p-L1nkT_ac:1b:20 K1ng3oniD_20:22:92 802.11
 Responise,
904
Flagi
BI=100,
BI=100,
： Response,
sBei
BI=100
551D=Test
FCU
ryed: 76 (37.3%)
图9.37捕获的无线数据包
（4）在该界面可以看到106顿是客户端发送ProbeReques包，请求连接路由器。107
帧路由器发送ProbeResponse包，响应了客户端的请求。
从以上信息中，可以看到使用隐藏SSID并不意味着是一个安全的网络。在Wireshark
中，使用MAC地址过滤也不是最有效的方法。这里可以使用airodump命令监听一个无线
接入点，获取到连接该接入点的任何设备MAC地址。语法格式如下所示：
当成功获取客户端的MAC地址时，用户只需使用macchanger命令将自己无线网卡的
MAC地址修改为客户端的MAC地址，即可成功连接到网络。
【实例9-5】使用FernWiFiCracker工具攻击，在树莓派上攻击WEP和WPA/WPA2
无线网络。具体操作步骤如下所示。
（1）启动FernWiFiCracker工具。执行命令如下所示：
root@kali:~# fern-wifi-cracker
执行以上命令后，将显示如图9.38所示的界面。
·300 ·
---
## Page 313
第9章无线网络渗透测试
Fern WiFI Cracker
()
WiFi
FermWiF1 Cracker 1.9
WiFI
图9.38FemWiFi Cracker主界面
（2）在该界面选择无线网络接口，并单击ScanforAeeesspoints图标扫描无线网络，
如图9.39所示。
Fern WiFI Cracker
()
WiFi
Fern WIFI Cratker1.9
WiFi
图9.39扫描无线网络
·301·
---
## Page 314
第3篇各种渗透测试
（3）在该界面选择WiFiWEP或WiFiWPA图标，将显示如图9.40所示的界面。
图9.40选择攻击目标
（4）在该界面选择攻击目标。然后单击WiFiAttack按钮，开始攻击，如图9.41所示。
Attack Panel
lect Target kgoess Fdire
图9.41正在攻击
（5）从该界面可以看到，已捕获到6556个数据包。当捕获到大约2万个包时，将会
破解出密码。但是此过程的时间相当长，需要耐心的等待。
·302 ·
---
## Page 315
第9章无线网络渗透测试
9.7
攻击路由器
前面介绍的各种工具，都是通过直接破解密码，来连接到无线网络。由于在一个无线
网络环境的所有设备中，路由器是最重要的设备之一。通常用户为了保护路由器的安全，
通常会设置一个比较复杂的密码。甚至一些用户可能会使用路由器的默认用户名和密码。
但是，路由器本身就存在一些漏洞。如果用户觉得对复杂的密码着手可能不太容易。这时
候，就可以利用路由器自身存在的漏洞实施攻击。本节将介绍使用Routerpwn工具实施攻
击路由器。
Routerpwn可能是使用起来最容易的一个工具。它用来查看路由器的漏洞。Routerpwn
不包括在Kali中，它只是一个网站。其官网地址为http:/routerpwn.com/。该网站提供的漏
洞涉及很多厂商的路由器，如图9.42所示。
2Wire
3Com
Comtrend
Netgear
TRENDnet
Arris
DD-Wrt
Pirelli
Ubee
D-Link
Alcatel
RuggedCom
Ubiquiti
EE
Sagem
Unicorn
Lucent
EasyBox
Alpha
Seagate
UTStarcom
Fibrehome
Siemens
Asmax
Xavi
Freebox
Sitecom
Asus
ZyXEL
Belkin
Huawei
SMC
ZTE
MiFi
Thomson
Zoom
Cisco
Motorola
TP-Link
图9.42Routerpwn主页面
从该界面可以看到有很多厂商的路由器，如国内常用的D-Link、Huawei、Netgear和
TP-Link等。根据自己的目标路由器选择相应生产厂商，这里选择TP-Link，将显示如图
9.43所示的界面。
TP-LINK
TD-8817,TD-W8901G,WDR740N,WR743ND,WR842ND,WA-901ND,
WR941N,WR941ND,WR1043ND,WR2543ND,MR3220,MR3020,
WR841N,TD-8840T,WDR740N,WDR740D
05/26/12
[+]
TP-Link WDR740ND/WDR740N - Directory Traversa
[SET IP]
01/14/14
[+]
TD-8840T - Reset Password to Blank
[SET IP]
08/06/13
WR1043ND denial of service
(SET IP)
08/06/13
[+]
WR1043ND enable root flsystem on FTP CSRF
[SET IP]
04/06/13
[+]
TD-8817 TD-W8901G blank admin password CSRF
(SET IP)
05/26/12
[三]
Webshell backdoor (user: osteam password: 5up)
(SET IP}]
* Top
图9.43支持的型号及漏洞
· 303 ·
---
## Page 316
第3篇各种渗透测试
从该界面可以看到支持有十六种型号的TP-LINK路由器及可利用的漏洞。在路由器漏
洞列表中显示了漏洞日期、漏洞描述信息和一个选项[SETIP]。该选项是用来设置目标路
由器的IP。
【实例9-6】利用Webshellbackdoor漏洞，获取一个远程路由器（本例中路由器IP地
址为192.168.0.1）命令行。具体操作步骤如下所示。
（1）在图9.43中单击[SETIP]按钮，将弹出一个对话框，如图9.44所示。
（2）在该对话框中，输入要攻击的路由器的IP地址。然后单击“确定”按钮，将弹出
如图9.45所示的对话框。
需要进行身份验证
显务器http/192.168.0.1:80要求用户错入用户名和密码。
股务器提示 : TP-LINK Wireless N Router WR1041N。
routerpwn.com上的网页显示：
用户名：
admin
密码：
确定
取消
图9.44输入目标路由器IP地址
图9.45登录路由器对话框
（3）在该界面输入登录路由器的用户名和密码，一般路由器默认的用户名和密码是
admin。然后单击“登录”按钮，将显示如图9.46所示的界面。
用户名
上一条
发
查看进程
查看网络
查看路由
查看NAT
查看内存
查看内核模块
查看防火墙
查看日志
查看连接款
查看ARP
查看流量
图9.46命令行界面
（4）此时，在该界面可以执行一些查看路由器信息的命令，如查看进程、网络、路由
表和NAT等。或者直接单击图9.46中右侧栏的按钮查看相关信息。在该界面执行命令时，
需要输入用户名和密码。这里的用户名和密码是Routerpwn网站中Webshellbackdoor漏洞
· 304 ·
---
## Page 317
第9章无线网络渗透测试
提供的用户名和密码（osteam和5up）。例如，单击“查看网络”按钮，将显示如图9.47
所示的界面。
回口
 TL-WR1041N
★
三
用户名
osteam
上一条下一条
发通
清空
出
ifeonfig
br0
Link emeap:Ethernet HFaddr 6C:E8:73:F9:3C:C0
inet adr:192.168. 0. 1Beart:192. 168.0.255 Mastk:255, 255 255.0
R packets:221877601 errors:0 dropped:0 overruns:0 fraae:0
UPBROADCAST RNIBG MILTICAST MTU:1500Metrie:1
TE packets:244867896 errere10 dropped:0 owerruns:0 carrier:0
RE bytes:1780662856 (1.6 GiB)TE bytes:2348209445 (2.1 GiB)
collisiens:0 txgueuelen:0
th0
Link encap:Ethernet HWaddr 00:03:7F:FF:FF:FF
UP BROADCAST RUNNING WILTICAST MTU:150OMetriC:1