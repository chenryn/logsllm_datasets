**种子语料库：** 我们从每个DBMS的官方Github存储库收集种子输入，其中单元测试通常涵盖大多数类型的查询。
我们向评估中的所有六个模糊器提供相同的种子，但SQLsmith不需要任何初始输入。
**设置：** 我们在装有Intel Xeon CPU E5-2690（2.90GHz），16核和`188GB RAM`的计算机上的Ubuntu
16.04系统中执行评估。 我们将afl-clang与llvm模式结合使用，以测试经过测试的DBMS，并采用边缘覆盖作为反馈。
考虑到DBMS的代码量很大，我们使用256K字节的位图来缓解路径冲突问题。 Angora使用1024K字节的位图，这是设计中的默认大小。
对于错误检测，由于时间限制和实施进度的原因，我们已经运行Squirrel来测试SQLite 40天，测试MySQLite和PostgreSQL
11天，以及MariaDB测试1天。 对于其他评估，我们将每个模糊测试实例（fuzzer + DBMS）运行24小时，然后重复该过程五次。
每个模糊测试实例都在具有一个CPU和10G内存的docker中单独运行。 我们报告平均结果以减少随机噪声，并在附录表6中提供p值。
### 8.1 DBMS Bugs
Squirrel已成功检测到来自经过测试的DBMS的63个错误，包括SQLite的51个错误，MySQL的7个错误和MariaDB的5个错误。表3列出了已发现的错误的详细信息。我们已将所有错误报告给了相应的DBMS开发人员，并收到了他们的积极反馈。在撰写本文时，已修复了所有错误中的52个。由于严重的安全后果，其中12个获得了CVE编号。相比之下，由Google发起的OSS-Fuzzer项目已经对第一个数据库管理系统进行了广泛的测试，并且在三年内发现了来自SQLite的19个错误，在四个月内发现了来自MySQL的15个错误，而没有来自PostgreSQL的错误。我们检查了OSS-Fuzzer检测到的MySQL错误，并发现所有错误均发生在MySQL逻辑的最开始：在解析阶段之前。概念验证（PoC）甚至不是有效的SQL查询，而只是一些随机位。因此，我们相信我们的模糊器可以更有效地发现来自DBMS的错误。我们计划将我们的工具集成到OSS-Fuzzer中，以提高DBMS的安全性。
> 表3：已检测到的错误。SQLite
> 3.31正在开发中，我们在Github上测试了最新版本。SQLite没有漏洞的严重性评分。表示严重性尚未由开发人员确定。
UAF: use-after-free. BOF: buffer overflow of Global(G), Heap(H), and Stack(S).
BUF: buffer underflow. AF: assertion failure. OOM: ouf of memory. UB:
undefined behavior.
ID | TYPE | FUNCTION | STATUS | SEVERITY | REFERENCE  
---|---|---|---|---|---  
**SQLite v3.30.1,300K LoC** |  |  |  |  |  
1 | BOF | PRAGMA integrity_check | Fixed | Critical | CVE-2019-19646  
2 | NP | lookupName | Fixed | Critical | CVE-2019-19317  
3 | UAF | WITH | Fixed | High | CVE-2019-20218  
4 | BOF | exprListAppendList | Fixed | High | CVE-2019-19880  
5 | BOF | ZipFile extension | Fixed | High | CVE-2019-19959  
6 | NP | zipfileUpdate | Fixed | High | CVE-2019-19925  
7 | NP | parser | Fixed | High | CVE-2019-19926  
8 | NP | LEFT JOIN optimization | Fixed | High | CVE-2019-19923  
9 | SBOF | ALTER TABLE | Fixed | Medium | CVE-2019-19645  
10 | NP | JOIN INDEX | Fixed | Medium | CVE-2019-19242  
11 | NP | parser | Fixed | Medium | CVE-2019-19924  
12 | BOF | propagateConstantExprRewrite | Fixed | Medium | CVE-2020-6405  
13 | UB | fopen/fopen64 | Fixed | – | 0c4f820  
14 | GBOF | sqlite3VdbeMemPrettyPrint | Fixed | – | 5ca0632  
15 | AF | sqlite3GenerateConstraintChecks | Fixed | – | ad5f157  
16 | AF | IN expression optimization | Fixed | – | b97f353  
17 | AF | whereLoopAddOr | Fixed | – | 9a1f2e4  
18 | AF | WHERE with OR opt. | Fixed | – | a4b2df5  
19 | AF | wherePathSatisfiesOrderBy | Fixed | – | 77c9b3c  
20 | AF | Bytecode OP_DeferredSeek | Fixed | – | be3da24  
21 | AF | WHERE | Fixed | – | 4adb1d0  
22 | AF | WHERE flag setting | Fixed | – | 118efd1  
23 | AF | Bytecode OP_ResultRow release | Fixed | – | 02ff747  
24 | AF | sqlite3SelectReset | Fixed | – | aa328b6  
25 | AF | Bytecode OP_SCopy | Fixed | – | 629b88c  
26 | AF | scalar subquery | Fixed | – | 629b88c  
27 | AF | Bytecode OP_ResultRow | Fixed | – | 02ff747  
28 | AF | SELECT | Fixed | – | fbb6e9f  
29 | AF | WHERE | Fixed | – | f1bb31e  
30 | AF | PRAGMA encoding | Fixed | – | b5f0e40  
**SQLite v3.31 (under development), 304K LoC** |  |  |  |  |  
31 | GBOF | ZipFile extension | Fixed | – | 8d7f44c  
32 | HBOF | ZipFile extension | Fixed | – | a194d31  
33 | HBUF | ZipFile extension | Fixed | – | 8d7f44c  
34 | UAF | sqlite3GenerateConstraintChecks | Fixed | – | 6d67aff  
35 | NP | VTable | Fixed | – | c7a5ff4  
36 | NP | ORDER BY Windows Function | Fixed | – | 73bacb7  
37 | NP | SF_Aggregate flag setting | Fixed | – | 9e10f9a  
38 | NP | USING | Fixed | – | 0824d5b  
39 | NP | ZipFile extension | Fixed | – | 0d21eae  
40 | NP | LEFT JOIN uses values from IN | Fixed | – | 74ebaad  
41 | AF | WHERE | Fixed | – | b592d47  
42 | AF | NEVER marco can be true | Fixed | – | 78b5220  
43 | AF | impliesNotNullRow | Fixed | – | aef8167  
44 | AF | Code Generator for inline function | Fixed | – | 25c4296  
45 | AF | scalar SELECT w/ WINDOW | Fixed | – | 4ea562e  
46 | AF | Code Generator for sub query | Fixed | – | fc705da  
47 | AF | AND¸ optimization | Fixed | – | 2b6e670  
48 | AF | Bytecode OP_Move | Fixed | – | 4cbd847  
49 | AF | Bytecode OP_Copy-coalesce opt. | Fixed | – | 9099688  
50 | AF | sqlite3ExprCodeIN | Fixed | – | f6ea97e  
51 | AF | whereTermPrint | Fixed | – | 6411d65  
**MySQL v8.0, 4250K LoC** |  |  |  |  |  
52 | OOM | WITH optimization | Verified | Critical | ID98190  
53 | NP | JOIN optimization | Fixed | Serious | ID98119  
54 | NP | JOIN optimization | Verified | ? | ID99438  
55 | NP | UPDATE optimization | Verified | ? | ID99424  
56 | AF | SELECT | Verified | ? | ID99420  
57 | AF | INDEX | Verified | ? | ID99421  
58 | AF | CREATE TABLE | Verified | ? | ID99454  
**MariaDB v10.5.3, 3641K LoC** |  |  |  |  |  