test  oracle), and  1 otherwise.  By  the  analysis above, A* 
breaks & with probability  &, 
disregarding negligible 
0 
probabilities. 
Theorem 6.4  Suppose 
the  underlying  RSA  signature 
scheme  is  deterministic  (i.e.,  K~~~  =  0). 
If  a  type 
ADV((dvc,  no}) forger  (q, €)-breaks the  S-RSA[€, D] 
scheme,  then  either  there  exists  an  attacker  A*  that 
or there  exists  a 
(2q,,,, 
forger F* that (2qsvr, €“)-breaks the utiderljing RSA signa- 
ture scheme with  E”  % ;. 
€‘)-breaks &  with  E’  x &, 
23 
7. Conclusion 
Dictionary  attacks  against  password-protected  private 
keys are a significant threat if the device holding those keys 
may  be captured.  In  this  paper  we  have  presented  an  ap- 
proach to render devices invulnerable to such attacks.  Our 
approach requires the device to interact with a remote server 
to perform its private key  operations.  Therefore,  it is pri- 
marily  suited to a device that  uses its private key in  inter- 
active cryptographic protocols (and so necessarily has net- 
work connectivity to reach the server when use of its private 
key  is  required).  A  prime example is a  device that  plays 
the role of a client in  the TLS protocol  with client authen- 
tication.  Though our protocol  requires the device to inter- 
act with a remote server, we prove that this server poses no 
threat to the device.  Specifically, it gains no significant ad- 
vantage in  forging signatures that can  be  verified  with the 
device’s public  key  or decrypting messages encrypted  un- 
der the device’s public key.  In  particular,  it  cannot mount 
a dictionary attack to expose the device’s private key. Even 
if both the device and server are compromised, the attacker 
must still succeed in an offline dictionary attack before sign- 
ing on behalf of the device. 
In addition to the above properties, we presented proto- 
cols that  further provide the feature of key  disabling.  This 
enables the user to disable the device’s private key immedi- 
ately, even after the device has been captured and even if the 
attacker has guessed  the user’s password.  Once disabled, 
the device’s key is provably useless to the attacker (provided 
that the attacker cannot also compromise the server).  Key 
disabling is thus an effective complement to any public key 
revocation mechanism that might exist, particularly if  there 
is a delay for revoking public keys. 
Proof: Given F  E ADv({dvc, T O } )  that (GI €)-breaks the S- 
RSA[&, D] scheme, we show that either we  can  construct 
a forger F* for the  underlying RSA  signature scheme, or 
an  attacker A*  against  E .   We  first  construct  a  forger F* 
that runs F  against a simulation  of S-RSA, such that if  F 
forges in the simulation with probability  5, F* (2qsvr, E ” ) -  
breaks the underlying RSA signature scheme with E’’  M 5. 
Assuming F  does  not  forge a  signature in  that  simulation 
with probability  5  then  we show that we can  construct an 
attacker A* that (2qsvr, €’)-breaks E  with E’  M 
Part  I  F*  is  given  public  key     for  the  RSA 
scheme and simulates the S-RSA system for F .  
Part I  Simulation: F* gives   to F as the device’s 
public  signature key.  Then F* generates the  server’s key 
pair (pk,,,,  .sksvr), and gives pk,,,  to F .  Next F* generates 
the data a, b, U ,  and  dl  in  the  normal way, using random 
t , v  E  {0,1}“, but computes7 = E p ~ , , , ( 0 3 K c f 2 X ) .  
F* gives 
a, U ,  and T to F .  
F* responds to a getVals query to the disable oracle by 
returning t, T. 
F* responds  to  a  svr  disable(t’,~’)  query  as  a  normal 
server would. F* responds to svr serve(y, 6 , ~ ’ )  queries for 
a T’  that has not been disabled as follows: 
Case  I :   (y, S, T‘) 
is  from  a  dvc  start(m)  query:  Query 
the  signature  oracle  to  get    (where  Irl  = 0, since 
the  signature  scheme  is  deterministic),  and  then  return 
p@ (s/(encode(m,  T ) ) ~ ’  mod N) where p is from the start 
query. 
Case 2:  y and T’  are from a dvc start query, but not 6: Be- 
have like a normal server (i.e., the svr  will abort). 
Case  3:  T’  =  T,  but  y is  not  from  a  dvc  start  query: 
Say    t Dsk,,,(y).  Behave  like  a  normal 
server, but if  p  = b, then query  the signature oracle to get 
0 = , and return p@ (s/(encode(m,  ~ - ) ) ~ l  mod N ) .  
Case 4:  T’  #  T,  but y is from a dvc start(m) query:  Say 
  t DSkrv, (T’).  Behave like  a  normal 
server, but using m, T ,  /3, and p from the dvc start(m) query. 
Case 5:  T’  # T and y is not from a dvc start query: Behave 
like a normal server. 
F*  responds  to  a  dvc  start(m)  query  as  a  normal 
dvc  would,  except  setting  y =  Epk,v,(Olml+“+X). For 
a  dvc  finish(7)  query  corresponding  to  a  start(m)  query 
that  returned  (y,d,.r), if  7  was  not  returned  from  a  svr 
serve(y, 6 , ~ )  query, have dvc abort.  Otherwise F* returns 
the signature found in that serve(?,  6, T) query. 
Part  I  Analysis:  If  F  forges in the simulation, then F* 
forges in the underlying signature scheme. 
Purr 2 The second part of the proof is similar to Part 2 of 
the proof of Theorem 6.3, except with t,b  replaced by E,  and 
o 
no 
term. 
24 
References 
N. Asokan, G. Tsudik, and M. Waidner. Server-supported signatures. 
./oifrJid of  Coinputer Securih 5( I),  1997. 
P. BCguin and J. J. Quisquater. Fast server-aided RSA signatures se- 
cure against active attacks. In Advunces in Cryptology-CRYPT0 
'95 
(Lecture Notes in Computer Science 963), pp. 57-69,  1995. 
M.  Bellare,  A.  Desai,  D.  Pointcheval,  and  P.  Rogaway.  Relations 
among  notions  of  security  for  public-key  encryptoin  schemes.  In 
Advunces in CI:\./~t"l(~gy-CRYPTO  '98 (Lecture Notes in Computer 
Science  1462), pp. 2 6 4 5 ,  1998. 
M. Bellare and S .  Miner. A forward-secure digital  signature scheme. 
'99 (Lecture Notes  in  Com- 
In  Advcirices in  Cryptohgy-CRYPT0 
puter Science  1666). pp. 431438, 1999. 
M.  Bellare,  D.  Pointcheval,  and  P.  Rogaway.  Authenticated 
key  exchange  secure  against  dictionary  attacks.  In  Advunce.7  iri 
Cryptology-EUROCRYPT  2000  (Lecture Notes  in  Computer Sci- 
ence 1807). pp.  139-1 55, 2000. 
M.  Bellare  and  P.  Rogaway.  Random  oracles  are  practical:  A 
paradigm  for designing efficient  protocols. In  lSt ACM  Conference 
on Computer und Co~~rrirurri~.(iti(~~r.~ 
Security, pp. 62-73,  Nov.  1993. 
M. Bellare  and  P.  Rogaway. Optimal asymmetric encryption.  In Ad- 
vu-nces  in  Cryptology-EUROCRYPT 
'91 (Lecture Notes  in  Com- 
puter Science 950). pp. 92-1  1 I.  1995. 
M. Bellare and P. Rogaway. The exact security of digital  signatures- 
How  to  sign  with  RSA  and  Rabin.  In  Advunces  in  Cryptology- 
EUROCRYPT  '96 (Lecture  Notes  in  Computer Science  1070), pp. 
399416, 1996. 
S. M. Bellovin  and  M. Memtt. Encrypted key exchange:  Password- 
based protocols secure against dictionary  attacks. In  I992 IEEE Sym- 
posium on Secirrie (incl Privucy, pp. 72-84,  1992. 
C.  Boyd.  Digital  multisignatures.  In  H.  J.  Beker  and  F.  C.  Piper, 
editors,  Cryptogruphy  id  Coding, pp.  241-246.  Clarendon  Press, 
1989. 
V. Boyko, P. MacKenzie, and S. Patel. Provably  secure password au- 
thentication and key exchange using Diffie-Hellman. In Advurices in 
Cry/~t~)/ogy-EUR0CRYP T  ZOO0  (Lecture  Notes  in  Computer Sci- 
ence  I807), pp.  156- I7 I ,  2000. 
R. Canetti, 0. Goldreich and  S.  Halevi.  The random oracle method- 
ology.  revisited.  In O O ~ "  ACM ~yrriposirmi on  T/reory of  Computing, 
pp. 209-218,  1998. 
R. Cramer and  V. Shoup. A practical  public key cryptosystem prov- 
ably  secure  against  adaptive  chosen  ciphertext  attack.  In Advunces 
in  Cryptology-CRYP  TO  '98 (Lecture  Notes  in  Computer Science 
1462), pp.  13-25.  1998. 
D. E.  Denning.  Digital  signatures  with  RSA  and  other  public-key 
cryptosystems.  Co~~r~~iif~ric(itio~r.~ 
of  the  ACM  27(4):388-392,  Apr. 
1984. 
T. Dierks and C. Allen. The TLS protocol  version  I .O.  IETF Request 
for Comments 2246, Jan.  1999. 
D. Dean, T. Berson, M. Franklin, D  Smetters and M. Spreitzer. Cryp- 
tography as a network service. In 2001 1SOC S ~ m p o s i i i ~ n  on Network 
und Disrribirted  System Secxrih, Feb. 200 I .  
T. EIGamal. A public key cryptosystern  and a signature scheme based 
on  discrete  logarithms.  1EEE T,.un.wrctions on  hifiwmutioti  Theory 
3 1:469472,  1985. 
D. Feldmeier and P.  Kam. UNIX password security-Ten 
In  Advunce.r  in  Cryptology-CRYPT0 
puter Science 435).  1990. 
years later. 
'89 (Lecture Notes  in  Com- 
25 
1191  W. Ford and  B. S .  Kaliski, Jr. Server-assisted generation of a strong 
. .  
secret from a password. In  5th IEEE hrernutioncr/ Workshop on En- 
terprise Security, 2000. 
[20]  0. Goldreich, S. Goldwasser and S .  Micali. How to construct random 
functions. Journul ofthe ACM 33(4):792-807,  Oct.  1984. 
[21]  S .   Goldwasser,  S .   Micali,  and  R.  L.  Rivest.  A  digital  signature 
scheme secure against adaptive chosen-message attacks. SIAM Jour- 
nu/ ~ j "  Coniputbig  17(2):281-308,  Apr.  1988. 
[22]  J. Histad,  J.  Honsson, A.  Juels,  and  M. Yung. Funkspiel  schemes: 
An  alternative to conventional tamper  resistance.  In  7th ACM  Con- 
,ference  on  Computer nrrd  Corniiru,iicntiorrs Security,  pp.  125-1  33, 
Nov. 2000. 
[23]  S .  Halevi  and  H. Krawczyk. Public-key  cryptography and  password 
protocols.  In  5t" ACM  Conference on  Computer und  Comniunicu- 
tioiir Secrrriry, pp.  122-131,  1998. 
[24]  D.  N.  Hoover  and  B.  N.  Kausik.  Software  smart  cards  via crypto- 
graphic camouflage. In  1999 IEEE Symposium on Security und Pri- 
vucy, pp. 208-2  15, May  1999. 
[25]  S .  Hong, J.  Shin,  H. Lee-Kwang,  and  H. Yoon. A new  approach to 
server-aided secret computation.  In  lSt Internuriontrl  Conference on 
Informution Security and Crypmlogy, pp. 33-45,  1998. 
[26]  D. Jablon.  Strong password-only  authenticated key exchange. ACM 
Computer Communicurion Review 26(5):5-20,  1996. 
[27]  D.  Klein. Foiling  the  cracker:  A  survey  of,  and  improvements  to, 
password security. In 2nd USENIX Security Workshop, Aug.  1990. 
[28]  D. W. Kravitz. Digital  signature algorithm. U.S. Patent 5,231,668, 27 
July  1993. 
[29]  H.  Krawczyk. Simple forward-secure  signatures from any signature 
scheme. In  7th ACM  Conference on  Computer trnd  Communicution 
Security, pp.  108-1  15, Nov. 2000. 
[30]  T. M. A. Lomas, L. Gong, J. H. Saltzer, and  R. M. Needham. Reduc- 
ing risks from poorly  chosen  keys. ACM  Operutirrg Systems Review 
23(.5):14-18.  Dec.  1989. 
[31]  P.  MacKenzie,  S.  Patel,  and  R.  Swaminathan.  Password  authenti- 
cated  key  exchange  based  on  RSA.  In  Advurices  in  CryptoIogy- 
ASIACRYPT2000, pp. 599-613,  2000. 
[32]  P. MacKenzie and M. K. Reiter. Two-party generation of DSA signa- 
tures. Manuscript, 2001. 
[33]  T. Matsumoto, K. Kato, and  H.  Imai. Speeding up computation with 
insecure auxiliary devices. In Advunces in Cryptology-CRYPT0  '88 
(Lecture Notes in Computer Science 403), pp. 497-506,  1989. 
[34]  U.  Maurer  and  S .   Wolf.  The  Diffie-Hellman  protocol.  Designs, 
Codes, und  Cryptogruphy  19: 147-1 7 I ,   Kluwer Academic  Publish- 
ers, 2000. 
[35]  R.  Moms  and  K.  Thompson.  Password  security:  A  case  history. 
Cor,rniunicutiorIs of  the ACM, 22( I  1):594-597, Nov.  1979. 
[36]  R.  Perlman  and  C. Kaufman.  Secure password-based  protocol  for 
downloading a private  key. In  1999 Nenvork wid Distributed  Sy.rterrr 
Security Symposium. Feb.  1999. 
[37]  C.  Rackoff  and  D.  Simon.  Noninteractive  zero-knowledge  proof 
of  knowledge  and  chosen  ciphertext  attack.  In  Advunces  in 
Cr~ptO/og~-CRYPTO '91, pp. 4 3 3 4 4 ,  1991. 
[38]  R. L. Rivest,  A.  Shamir,  and  L. Adleman.  A method  for obtaining 
digital  signatures and public-key  cryptosystems. Coiiiniimircrrio,i.r of 
the ACM 21(2):12&126,  Feb.  1978. 
[39]  V. Shoup and R. Cennaro. Securing threshold  cryptosystems against 
chosen ciphertext attack. In Advunces in Cryprology-EUROCRYP  T 
'98, pp.  1-16,  1998. 
[40]  T. Wu. The secure remote password protocol.  In  19YR Nehwrk und 
Dis/ribirred System Securih Symnpo.riirm, Feb.  1999. 
[41]  T. Wu. A real-world analysis of Kerberos password security. In  I999 
Network und Disrribured  Sjsrcm Security Swrrposium, Feb. 1999.