o
t
e
g
a
n
e
c
r
e
P
 12
 10
 8
 6
 4
 2
 0
0
4/0
9
0
4/1
1
0
4/1
3
0
4/1
5
0
4/1
7
0
4/1
9
0
4/2
1
0
4/2
3
0
4/2
5
0
4/2
7
0
4/2
9
0
5/0
1
Date
Figure 5: Certiﬁcate Replacement on Vulnerable Alexa Sites.
We monitored certiﬁcate replacement on vulnerable Alexa Top 1 Mil-
lion sites and observe only 10% replaced certiﬁcates in the month
following public disclosure.
e
t
a
c
i
f
i
t
r
e
C
e
m
a
S
h
t
i
w
s
P
I
f
o
r
e
b
m
u
N
 30000
 25000
 20000
 15000
 10000
 5000
 0
March
April
 6
 8
 10
 12
 14
 16
 18
 20
 22
 24
 26
 28
Day
Figure 6: ICSI Notary Certiﬁcate Changes. Over both March and
April, we track the number of servers who have the same certiﬁcate
as on the 6th of each month. We only include servers that served the
same certiﬁcate for the previous month.
 500000
 400000
4
1
0
2
Heartbleed Disclosed
s
n
o
i
t
a
c
o
v
e
R
e
v
i
t
 300000
 200000
l
a
u
m
u
C
 100000
 0
0
1/0
1
0
2/0
1
0
3/0
1
0
4/0
1
0
5/0
1
0
6/0
1
0
7/0
1
Date
Figure 7: Revocations after Heartbleed. Certiﬁcate revocations
dramatically increased after the disclosure. The jumps reﬂect Glob-
alSign (ﬁrst) and GoDaddy (rest). However, still only 4% of HTTPS
sites in the Alexa Top 1 Million revoked their certiﬁcates between
April 9 and April 30, 2014.
certiﬁcates, and an even smaller number revoked their vulnerable
certiﬁcates.
5.2 Certiﬁcate Revocation
When a certiﬁcate or key can no longer be trusted, sites can
request the issuing CA to revoke the certiﬁcate. CAs accomplish
this by publishing certiﬁcate revocation lists (CRLs) and supporting
the Online Certiﬁcate Status Protocol (OCSP) for live queries. Even
though most vulnerable hosts failed to revoke old certiﬁcates, we
observed about as many revocations in the three months following
public disclosure as in the three previous years.
Prior to the vulnerability disclosure, we saw on average 491
(s=101) revocations per day for certiﬁcates found in our scans. As
seen in Figure 7, in the days following disclosure, the number of
revocations dramatically increased. The sudden increases were due
to individual CAs invalidating large portions of their certiﬁcates.
Most notably, GlobalSign revoked 56,353 certiﬁcates over two days
(50.2% of their visible certiﬁcates), and GoDaddy, the largest CA,
revoked 243,823 certiﬁcates in week-long bursts over the follow-
ing three months. GlobalSign’s large number of revocations were
precipitated by a major customer, CloudFlare, revoking all of their
customers’ certiﬁcates [60].
Revoking such a large number of certiﬁcates burdens both clients
and servers. Clients must download large CRLs, which CAs must
host. GlobalSign’s CRL expanded the most, from 2 KB to 4.7 MB
due to CloudFlare’s revocations. CloudFlare hesitated to revoke their
certiﬁcates, citing its signiﬁcant cost, which they estimated would
require an additional 40 Gbps of sustained trafﬁc, corresponding
to approximately $400,000 per month [60]. StartCom, a CA that
offers free SSL certiﬁcates, came under ﬁre for continuing their
policy of charging for revocation after the Heartbleed disclosure [44].
However, revocation places a sizable ﬁnancial strain on CAs due to
bandwidth costs [9, 60].
5.3 Forward Secrecy
Heartbleed highlights the importance of using forward secret
cipher suites in TLS. Without forward secrecy, the compromise
of a server’s private key, such as due to Heartbleed, allows an
attacker who recorded previous communications encrypted with
TLS to recover the session key used to protect that communication,
subverting its conﬁdentiality. Thus, we might expect operators to
respond to Heartbleed by ensuring that at least in the future their
servers will support forward secrecy.
Unfortunately, we ﬁnd that only 44% of the connections observed
by the ICSI Notary in May 2014 used forward secrecy. There
has been a slow increase in adoption between December 2013 and
April 2014, a gain of 1.0–4.3% each month. We observe a 4.2%
increase between March and April 2014, but no larger than that
between January and February. Surprisingly, this trend stagnated
from April to August; the percentage of connections using forward
secrecy stayed virtually the same. Currently, we are not sure why the
increase in forward secrecy cipher use ceased. However, it appears
clear that Heartbleed did not spur adoption of forward secrecy.
6. ATTACK SCENE
In addition to tracking vulnerable servers, we analyzed who was
scanning for the Heartbleed vulnerability by examining network
trafﬁc collected from passive taps at Lawrence Berkeley National
Laboratory (LBNL), the International Computer Science Institute
(ICSI), and the National Energy Research Scientiﬁc Computing
Center (NERSC), as well as a honeypot operated by a colleague on
Amazon EC2.
482To detect Heartbleed scanning, we extended the Bro’s SSL/TLS
analyzer to recognize Heartbeat messages [25, 57]. Note that this
approach parses the full TLS protocol data stream, including the
TLS record layer which remains unencrypted throughout the ses-
sion, and thus achieves an accuracy signiﬁcantly better than that
provided by simple byte pattern matching. We have released our
Bro modiﬁcations along with our detection script via the Bro git
repository.
6.1 Pre-Disclosure Activity
LBNL’s network spans two /16s, one /20 and one /21. The insti-
tute frequently retains extensive packet traces for forensic purposes,
and for our purposes had full traces available from February–March
2012, February–March 2013, and January 23–April 30 2014. ICSI
uses a /23 network, for which we had access to 30-days of full traces
from April 2014. NERSC has a /16 network, for which we analyzed
traces from February to April 2014. The EC2 honeypot provided
full packet traces starting in November 2013.
For all four networks, over these time periods our detector found
no evidence of any exploit attempt up through April 7, 2014. This
provides strong evidence that at least for those time periods, no
attacker with prior knowledge of Heartbleed conducted widespread
scanning looking for vulnerable servers. Such scanning however
could have occurred during other time periods.
6.2 Post-disclosure Activity
To detect post-disclosure scanning, we similarly examined packet
traces from LBNL, ICSI, and the EC2 honeypot. The ﬁrst activity
we observed originated from a host at the University of Latvia on
April 8, starting at 15:18 UTC (21 hours 29 minutes after public
disclosure), targeting 13 hosts at LBNL. This ﬁrst attack was unusual
in that it sent both unencrypted (pre-handshake) and encrypted (post-
handshake) Heartbleed exploit packets to each host, likely trying to
gauge the effectiveness of both approaches. We observed scanning
of the other two networks within a few more hours.
In total, we observed 5,948 attempts to exploit the vulnerability
from 692 distinct hosts (Table 7). These connections targeted a total
217 hosts. 7 attackers successfully completed 103 exploit attempts
against 12 distinct hosts (excluding the intentionally vulnerable
honeypot). Figure 8 presents the temporal behavior of scanning as
seen at each location.
We detected several different types of exploit attempts, which we
list in Table 6. In types (1) and (2), attackers sent exploit attempts
prior to completely establishing the TLS session, which allowed
us to directly inspect the attack payload. After establishment of
the TLS session, the only pieces of information we can retrieve
are the message type and size, which are both transferred in the
clear. To detect scanning conducted in a fashion similar to our
own, we checked the length of the encrypted message (3). We
also consider all Heartbeat messages that we see prior to the ﬁrst
transmission of application data (4) to reﬂect exploit attempts.* We
identify attacks as successful when the destination server responds
with more data than included in the original request (5), though as
noted above we do not consider attacks on the EC2 honeypot as
“successful”.
The sixteen most aggressive probe sources (by number of scans)
reside in Amazon address space. The scans originating from these
hosts share many characteristics, including the use of encryption,
the same packet length, and identical cipher suites. Closer exam-
⇤Heartbeat messages should never precede application data. We
veriﬁed this does not happen in real-world trafﬁc by manually re-
viewing traces prior to the Heartbleed disclosure. We observed no
such instances.
LBNL
ICSI
EC2
s
t
p
m
e
t
t
A
n
a
c
S
f
o
r
e
b
m
u
N
 350
 300
 250
 200
 150
 100
 50
 0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
4
-
0
4
-
0
4
-
1
4
-
1
4
-
1
4
-
1
4
-
1
4
-
1