title:Are We There Yet? On RPKI's Deployment and Security
author:Yossi Gilad and
Avichai Cohen and
Amir Herzberg and
Michael Schapira and
Haya Shulman
Are We There Yet?
On RPKI’s Deployment and Security
Yossi Gilad∗, Avichai Cohen†, Amir Herzberg‡, Michael Schapira† and Haya Shulman§
∗Boston University and MIT CSAIL
†Hebrew University of Jerusalem
‡Bar Ilan University
§Fraunhofer SIT
Abstract— The Resource Public Key Infrastructure (RPKI)
binds IP address blocks to owners’ public keys. RPKI enables
routers to perform Route Origin Validation (ROV), thus prevent-
ing devastating attacks such as IP preﬁx hijacking. Yet, despite
extensive effort, RPKI’s deployment is frustratingly sluggish,
leaving the Internet largely insecure. We tackle fundamental
questions regarding today’s RPKI’s deployment and security:
What is the adoption status of RPKI and ROV? What are the
implications for global security of partial adoption? What are the
root-causes for slow adoption? How can deployment be pushed
forward? We address these questions through a combination of
empirical analyses, a survey of over 100 network practitioners,
and extensive simulations. Our main contributions include the
following. We present the ﬁrst study measuring ROV enforcement,
revealing disappointingly low adoption at the core of the Internet.
We show,
in contrast, that without almost ubiquitous ROV
adoption by large ISPs signiﬁcant security beneﬁts cannot be
attained. We next expose a critical security vulnerability: about a
third of RPKI authorizations issued for IP preﬁxes do not protect
the preﬁx from hijacking attacks. We examine potential reasons
for scarce adoption of RPKI and ROV, including human error
in issuing RPKI certiﬁcates and inter-organization dependencies,
and present recommendations for addressing these challenges.
I.
INTRODUCTION
The Border Gateway Protocol (BGP) computes routes
between the tens of thousands of smaller networks, called
Autonomous Systems (ASes), which make up the Internet.
ASes range from large ISPs and content providers to small
businesses and universities. BGP is notoriously vulnerable
to devastating attacks and conﬁguration errors. Consequently,
nation states and corporations are in constant danger from
attacks that utilize BGP’s insecurity to disconnect ASes from
the Internet and to launch highly effective man-in-the-middle
attacks. A particularly worrisome and common attack vector
is IP preﬁx hijacking, where an AS advertises in BGP an
IP preﬁx not belonging to it. Preﬁx hijacks are effective and
easy to launch, with the extra beneﬁt of a plausible excuse:
benign conﬁguration errors [53]. Every year several high-
proﬁle incidents resulting from preﬁx hijacks make the news
Permission  to  freely  reproduce  all  or  part  of  this  paper  for  noncommercial 
purposes is granted provided that copies bear this notice and the full citation 
on the ﬁrst page. Reproduction for commercial purposes is strictly prohibited 
without the prior written consent of the Internet Society, the ﬁrst-named author 
(for  reproduction  of  an  entire  paper  only),  and  the  author’s  employer  if  the 
paper  was  prepared  within  the  scope  of  employment.
NDSS  ’17,  26  February  -  1  March  2017,  San  Diego,  CA,  USA
Copyright  2017  Internet  Society,  ISBN  1-891562-46-0
http://dx.doi.org/10.14722/ndss.2017.23123
[1], [8], [51], [52]), and many others go under the
(e.g.,
radar [55].
The Resource Public Key Infrastructure (RPKI) [38] is a
hierarchical certiﬁcation system. RPKI stores Route Origin
Authorizations (ROAs), signed records that bind an IP address
block to the AS that is allowed to advertise it in BGP. ROAs
can be leveraged by BGP routers to perform Route-Origin
Validation (ROV) [9], [45]: identifying and discarding “invalid”
BGP route-advertisements from unauthorized ASes, thus pro-
tecting against IP preﬁx hijacking. Beyond being the leading
and, thus far, only standardized solution to preﬁx hijacking,
RPKI is also a prerequisite for prominent routing security
mechanisms such as BGPsec [42], and for other proposals for
defending against BGP path-manipulation attacks, e.g., [15],
[16], [58].
Yet, despite RPKI’s crucial role in securing the Internet
routing system, RPKI’s deployment is frustratingly low [47],
leaving the Internet largely exposed to dangerous trafﬁc hi-
jacking attacks. We embark on a systematic study of RPKI’s
deployment and security. We tackle the following fundamental
questions: What is the adoption status of RPKI and ROV?
What are the implications for security of partial adoption of
RPKI/ROV? What are the root-causes for the slow adoption
rates? How can deployment be pushed forward? We address
these questions through a combination of empirical analyses of
multiple datasets, a survey of over 100 network practitioners,
and extensive simulations on empirically-derived data. We next
describe our main contributions.
A. Deployment Status
Extensive effort
is devoted to promoting the adoption
of RPKI and ROV. The IETF’s SIDR (Secure Inter-Domain
Routing) working group standardized the relevant protocols,
and router support for ROV is already available from all major
vendors. For RPKI to provide meaningful security guarantees,
two conditions must be met: (1) ASes should issue ROAs
covering their address blocks, and (2) ASes should conﬁgure
BGP routers to do ROV, i.e., discard BGP advertisements that
are incompatible with ROAs. Only about 6.5% of IP preﬁxes
advertised in BGP are covered by ROAs [47], [57]. (We will
discuss the root-causes for this scarce deployment later on.)
What about adoption of ROV?
Any AS, anywhere, can enforce ROV, provided that its
routers support ROV (most modern routers do). We aim
to understand how many ASes actually do. We present the
ﬁrst quantitative study of ROV adoption. Our ﬁndings are
disappointing: only a very small fraction of the large ISPs
at the core of the Internet enforce ROV.
B. Security Evaluation
Security in partial deployment. Given our results for ROV
adoption, a natural question arises: What is the impact on
global routing security of partial adoption of ROV? We
identify interesting phenomena that can manifest when ROV
is not globally adopted. Not surprisingly, ROV enforcement by
an AS can yield collateral beneﬁts, protecting others routing
through that AS from trafﬁc hijacking attacks. Less obviously,
however, non-adoption by an AS can cause collateral damage
resulting in ROV-enforcing ASes falling victim to attacks.
To gain insights into how these effects impact security,
we present the results of extensive simulations of partial ROV-
adoption scenarios. We ﬁnd that ROV is effective against preﬁx
hijacking if and only if almost all of the largest ISPs (e.g., top
100) enforce ROV. Consequently, under today’s meagre ROV
adoption, an AS that issues a ROA for its IP address blocks
is largely unprotected from such attacks.
Insecure ROAs. We next expose a critical security vulnerabil-
ity of RPKI: about a third of the IP preﬁxes in BGP tables that
are covered by ROAs are badly issued and, consequently, the
issuing organizations remain vulnerable to trafﬁc hijacking. In
fact, an attacker can hijack all trafﬁc destined for the issuers
of such “insecure ROAs” even if all ASes on the Internet
do ROV. We show that even large ISPs, e.g., Swisscom and
Orange, suffer from this vulnerability. (We present, throughout
this paper, real-world examples of security vulnerabilities and
other RPKI-related undesirable phenomena. All these problems
have been reported to network operators.)
C. Obstacles to Adoption
While the hurdles to deployment of BGPsec were studied
in depth (e.g., see [23], [41]), fairly little attention has been
given to RPKI’s (non)deployment. Clearly, RPKI and ROV
suffer from a circular dependency: ASes do not gain sufﬁcient
security beneﬁts from ROV so long as so many IP preﬁxes
advertised in BGP are not certiﬁed through RPKI, yet there is
little incentive to certify ownership over an IP preﬁx (issue a
ROA) when so few ASes do ROV.
This circular dependency is not unique to RPKI and ROV.
Similar dependencies hinder adoption of other standards, e.g.,
DNSSEC and IPv6 (see, for example, DNSSEC adoption
rates [18], [22]). RPKI and ROV, however, do not share other
major drawbacks of these other standards, e.g., interoperability
concerns (i.e., compatibility with legacy protocols), runtime
overheads (e.g., resulting from online cryptography), etc.
What, then, are the main factors hindering RPKI deployment?
Human error. Beyond insufﬁcient value/incentive for adop-
tion, RPKI and ROV suffer from an even worse problem:
(justiﬁed) mistrust. Past studies [19], [33], [34] show that
about 8% of IP preﬁxes advertised in BGP that are covered by
ROAs are “invalid”. Consequently, an AS doing ROV would
be immediately disconnected from thousands of legitimate IP
preﬁxes owned by hundreds of organizations, an arguably
worse outcome than the attack RPKI is meant to prevent.
Our survey of network operators conﬁrms that mistrust in the
RPKI infrastructure is indeed an important reason for non-
deployment. Our empirical measurement results, however, re-
veal a more nuanced (and somewhat more optimistic) picture:
a breakdown of invalid IP preﬁxes by organizations shows that
roughly 20 organizations are responsible for the invalidity of
most of these IP preﬁxes, giving hope that this situation can
be greatly improved via highly focused efforts.
Inter-organization dependencies. Another potential reason
for RPKI’s slow certiﬁcation rates is inter-organization de-
pendencies that force an AS that wishes to issue a ROA to
wait for other ASes to issue ROAs ﬁrst. We show that while
such dependencies do not pertain to most ASes, some of the
world’s largest ISPs cannot easily issue ROAs for this reason.
D. Recommendations
We present several concrete proposals for driving RPKI
adoption forward. We advocate concentrating standardization,
regulatory, and educational efforts in the following directions.
Eliminating obstacles to deployment via modest changes
to RPKI. We introduce a new kind of ROAs, compatible
with the current format, which can eliminate troublesome inter-
organization dependencies.
Targeting the core of the Internet. Our security evaluation of
ROV in partial deployment shows that adoption by the largest
ISPs is key to attaining meaningful security guarantees. We
thus advocate targeting effort (regulatory, providing proper in-
centives, etc.) on boosting ROV adoption amongst the top ISPs.
Improving RPKI’s reliability and integrity. Our results
on RPKI deployment show that human error (when issuing
ROAs) is a key factor in RPKI’s unreliability and insecurity
and that relatively few organizations are responsible for the
majority of badly issued ROAs. Thus, concentrating effort
on these organizations can lead to a drastic decrease in the
number of badly issued ROAs. To alert network operators
about “bad ROAs” affecting their connectivity or security,
and inform them about their organization-speciﬁc obstacles to
RPKI deployment, we present ROAlert, identifying incorrect
ROAs and alerting administrators via email and via web. We
encourage the reader to enter the ROAlert website at roalert.org
to discover whether her/his IP address (or any other IP address
of her/his choice) is correctly protected by a ROA in RPKI
and, if not, why (the relevant terminology is presented in
the sequel). Our experience with ROAlert, including feedback
from dozens of network administrators, indicates that ROAlert,
if employed and promoted by the relevant entities, could aid
in building trust in RPKI and boosting its adoption.
E. Organization
Section II provides the required background on RPKI and
ROV. We discuss ROV’s adoption status and its impact on
global routing security in Sections III and IV, respectively.
We present our results on the insecure ROAs in Section V,
exposing a vulnerability of RPKI deployment in practice. We
discuss and quantify obstacles to adoption in Section VI and
introduce, in Section VII, our proposals for facilitating wider
adoption. We review related work in Section VIII and conclude
in Section IX.
2
Fig. 1: Deutsche Telekom received an RC from RIPE and
issued a ROA to protect its IP-preﬁx (advertised through BGP)
II. BACKGROUND: RPKI, RCS, ROAS, AND ROV
RPKI [38] maps IP address blocks to organizations that
“own” them,
thus laying the foundation for combating IP
preﬁx hijacking and for further protection from attacks on
inter-domain routing via BGPsec and alternative proposals for
defending against BGP path-manipulation attacks [15], [16],
[42], [58]. We next elaborate on how ownership of IP preﬁxes
is certiﬁed in RPKI and how this information can be used to
discard bogus BGP route-advertisements.
A. Certifying Ownership
RPKI assigns an IP preﬁx to a public key via a Resource
Certiﬁcate (RC), issued by the authoritative entity for that IP
preﬁx. This allows the owner of the corresponding private key
to issue a Route Origin Authorization (ROA) specifying the AS
numbers of ASes authorized to advertise the IP preﬁx in BGP.
We explain below some of the speciﬁcs involved in issuing
RCs and ROAs.