Italy.
for Digital
(2018, oct) Dss demonstration
webapp v5.2. [Online]. Available: https://dss.agid.gov.it/
validation
[21] eesti.
(2018, oct) Siva demo application.
[Online].
[22] Evrotrust.
Available: https://siva-arendus.eesti.ee/
(2018, Oct.) Validate
signature.
[Online]. Available: https://www.evrotrust.com/landing/
en/a/validation
a
[23] iText PDF.
iText Online PDF Service.
[Online].
Available: https://itextpdf.com/en/
[24] intarsys.
intarsys Online PDF Service.
[Online].
Available: https://www.intarsys.de/
[25] ISO, ISO 32000-2:2017 - Document management –
Portable Document Format – Part 2: PDF 2.0, 1st ed.,
Sep. 2017.
[26] V. Mladenov, C. Mainka, K. Meyer zu Selhausen,
M. Grothe, and J. Schwenk, “1 trillion dollar refund –
how to spoof pdf signatures,” in ACM Conference on
Computer and Communications Security, Nov. 2019.
[27] Y. Chen, L. Xing, Y. Qin, X. Liao, X. Wang, K. Chen,
and W. Zou, “Devils
in the guidance: Predicting
logic vulnerabilities in payment syndication services
through automated documentation analysis,” in 28th
USENIX Security Symposium (USENIX Security 19).
Santa Clara, CA: USENIX Association, Aug. 2019, pp.
747–764. [Online]. Available: https://www.usenix.org/
conference/usenixsecurity19/presentation/chen-yi
[28] T. Lv, R. Li, Y. Yang, K. Chen, X. Liao, X. Wang,
P. Hu, and L. Xing, “Rtfm! automatic assumption
discovery and veriﬁcation derivation from library
document for api misuse detection,” in Proceedings
of
the 2020 ACM SIGSAC Conference on Computer
and Communications Security, ser. CCS ’20. New
York, NY, USA: Association for Computing Machinery,
2020, p. 1837–1852. [Online]. Available: https://doi.org/
10.1145/3372297.3423360
[29] M. Acharya and T. Xie, “Mining api error-handling spec-
iﬁcations from source code,” in International Conference
on Fundamental Approaches to Software Engineering.
Springer, 2009, pp. 370–384.
[30] H. A. Nguyen, R. Dyer, T. N. Nguyen, and H. Ra-
jan, “Mining preconditions of apis in large-scale code
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:29:12 UTC from IEEE Xplore.  Restrictions apply. 
141498
corpus,” in Proceedings of
the 22nd ACM SIGSOFT
International Symposium on Foundations of Software
Engineering, 2014, pp. 166–177.
of
[31] B. Hom`es, Fundamentals
Software
Testing,
[Online]. Available:
ISTE. Wiley,
ser.
https://books.google.de/books?id=z1XDNlSceFkC
2013.
[32] K. G. Paterson, T. Ristenpart, and T. Shrimpton,
“Tag size does matter: Attacks and proofs for the tls
record protocol,” in Proceedings of the 17th International
Conference on The Theory and Application of Cryptology
and Information Security, ser. ASIACRYPT’11. Berlin,
Heidelberg: Springer-Verlag, 2011, p. 372–389. [Online].
Available: https://doi.org/10.1007/978-3-642-25385-0
20
[33] H. B¨ock,
J. Somorovsky, and C. Young, “Return
of bleichenbacher’s oracle threat (ROBOT),” in 27th
USENIX Security Symposium (USENIX Security 18).
Baltimore, MD: USENIX Association, Aug. 2018, pp.
817–849. [Online]. Available: https://www.usenix.org/
conference/usenixsecurity18/presentation/bock
[34] K. Bhargavan, A. D. Lavaud, C. Fournet, A. Pironti,
and P. Y. Strub, “Triple handshakes and cookie cutters:
Breaking and ﬁxing authentication over tls,” in 2014
IEEE Symposium on Security and Privacy, 2014, pp. 98–
113.
[35] M. Heiderich, J. Schwenk, T. Frosch, J. Magazinius,
and E. Z. Yang, “Mxss attacks: Attacking well-secured
web-applications by using innerhtml mutations,” in
Proceedings of
the 2013 ACM SIGSAC Conference
on Computer & Communications Security, ser. CCS
’13. New York, NY, USA: Association for Computing
Machinery, 2013, p. 777–788.
[Online]. Available:
https://doi.org/10.1145/2508859.2516723
[36] S. Lekies, K. Kotowicz, S. Groß, E. A. Vela Nava, and
M. Johns, “Code-reuse attacks for the web: Breaking
cross-site scripting mitigations via script gadgets,” in
Proceedings of
the 2017 ACM SIGSAC Conference
on Computer and Communications Security, ser. CCS
’17. New York, NY, USA: Association for Computing
Machinery, 2017, p. 1709–1723. [Online]. Available:
https://doi.org/10.1145/3133956.3134091
[37] Y. Zhang, X. Zheng, Z. Wang, G. Ai, and Q. Huang,
“Implementation of a parallel gpu-based space-time
kriging framework,” ISPRS Int. J. Geo Inf., vol. 7,
no. 5, p. 193, 2018.
[Online]. Available: https:
//doi.org/10.3390/ijgi7050193
[38] J. M¨uller, F. Ising, V. Mladenov, C. Mainka, S. Schinzel,
and J. Schwenk, “Practical decryption exﬁltration: Break-
ing pdf encryption,” in ACM Conference on Computer
and Communications Security, Nov. 2019.
[39] M. Grothe, C. Mainka, P. R¨osler, and J. Schwenk, “How
to break microsoft rights management services,” in 10th
USENIX Workshop on Offensive Technologies (WOOT
16). Austin, TX: USENIX Association, Aug. 2016.
[Online]. Available: https://www.usenix.org/conference/
woot16/workshop-program/presentation/grothe
[40] J. M¨uller, F. Ising, C. Mainka, V. Mladenov, S. Schinzel,
and J. Schwenk, “Ofﬁce document security and privacy,”
in 14th USENIX Workshop on Offensive Technologies
(WOOT 20).
USENIX Association, Aug. 2020.
[Online]. Available: https://www.usenix.org/conference/
woot20/presentation/muller
[41] Statista, Inc. (2019, Sep.) Operating Systems - Statistics
& Facts. [Online]. Available: https://www.statista.com/
topics/1003/operating-systems/
[42] Datanyze. Adobe Acrobat DC Market
Share
Avail-
Competitor
https://www.datanyze.com/market-share/other-
and
able:
sales-software--408/adobe-acrobat-dc-market-share
[Online].
Report.
“Electronic
advanced
[43] European Telecommunications
signatures
electronic
pdf
1,” Tech. Rep.,
(ETSI),
(esi);
part
https://www.etsi.org/deliver/etsi ts/102700 102799/
10277801/01.01.01 60/ts 10277801v010101p.pdf
Institute
infrastructures
proﬁles;
[Online]. Available:
Standards
and
signature
2009.
[44] ——, “Electronic signatures and infrastructures (esi);
[Online].
https://www.etsi.org/deliver/etsi ts/103100
cades baseline proﬁle,” Tech. Rep., 2012.
Available:
103199/103173/02.01.01 60/ts 103173v020101p.pdf
[45] J. M. Esparza. (2014, Oct.) Pdf attack - a journey from
to the shellcode. [Online]. Available:
the exploit kit
https://www.blackhat.com/docs/eu-14/materials/eu-14-
Esparza-PDF-Attack-A-Journey-From-The-/Exploit-
Kit-To-The-Shellcode.pdf
[46] V. Hamon, “Portable Document Format (PDF) Security
Analysis and Malware Threats,” Black Hat Abu Dhabi,
2012.
[47] P.
Stokes.
(2019, Mar.) Malicious
pdfs —
revealing the techniques behind the attacks. [Online].
Available: https://www.sentinelone.com/blog/malicious-
pdfs-revealing-techniques-behind-attacks/
[48] R. Brandis and L. Steller, “Threat Modelling Adobe
PDF,” Command, Control, Communications and Intel-
ligence Division, DSTO, Australien, 2012.
[49] Adobe Systems Incorporated, JavaScript for Acrobat API
[50] Adobe
Reference - Adobe Acrobat SDK 8.1, Apr. 2007.
Inc.
Jul.)
(2020,
-
[Online]. Avail-
https://www.adobe.com/devnet-docs/acrobatetk/
acrobat application security guide.
able:
tools/AppSec/javascript.html
Javascript
controls
[51] C.-t.-a. Mainka, V.-d.-l. Mlade nov, and S. Rohlmann,
“Shadow Attacks: Hiding and Replacing Content
in
Signed PDFs,” in Proceedings 2019 Network and Dis-
tributed System Security Symposium.
Internet Society,
Feb. 2021.
[52] Microsoft.
(2020) Allow changes
to
parts
of
Available:
protected
document.
a
https://support.microsoft.com/en-us/ofﬁce/allow-
changes-to-parts-of-a-protected-document-187ed01c-
8795-43e1-9fd0-c9fca419dadf
[Online].
[53] I. Grigg. (2008) Technologists on signatures: looking
http:
[Online]. Available:
the wrong
place.
in
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:29:12 UTC from IEEE Xplore.  Restrictions apply. 
151499
[54] I. Grigg.
//ﬁnancialcryptography.com/mt/archives/001056.html
(2012) Signatures on fax & email
-
intend to be bound, why did
to write it? [Online]. Available: http:
if you did not
you bother
//ﬁnancialcryptography.com/mt/archives/001364.html
[55] F. Raynal, G. Delugr´e, and D. Aumaitre, “Malicious
in Computer Virology,
Origami
vol.
[Online].
6,
Available: http://esec-lab.sogeti.com/static/publications/
08-pacsec-maliciouspdf.pdf
in PDF,” Journal
no.
289–315,
2010.
pp.
4,
[56] G. Lax, F. Buccafurri, and G. Caminiti, “Digital docu-
ment signing: Vulnerabilities and solutions,” Information
Security Journal: A Global Perspective, vol. 24, no. 1-3,
pp. 1–14, 2015.
[57] M. Stevens, E. Bursztein, P. Karpman, A. Albertini, and
Y. Markov, “The ﬁrst collision for full sha-1,” in Annual
International Cryptology Conference.
Springer, 2017,
pp. 570–596.
[58] P. Domingues and M. Frade, “Digitally signed and
permission restricted pdf ﬁles: A case study on digital
forensics,” in Proceedings of
the 13th International
Conference on Availability, Reliability and Security,
ser. ARES 2018. New York, NY, USA: Association
for Computing Machinery, 2018. [Online]. Available:
https://doi.org/10.1145/3230833.3232811
[59] F. Buccafurri, “Digital signature trust vulnerability:
A new attack on digital
signatures,” Information
Management & Computer Security, vol. 4, pp. 28–6,
2005. [Online]. Available: http://www.unirc.it/ﬁrma/en/
Buccafurri ISSA 1008.pdf
[60] F. Buccafurri, G. Caminiti, and G. Lax, “Fortifying
the dal`ı attack on digital signature,” in Proceedings
of
the 2nd International Conference on Security of
Information and Networks, ser. SIN ’09. New York,
NY, USA: Association for Computing Machinery, 2009,
p. 278–287. [Online]. Available: https://doi.org/10.1145/
1626195.1626262
“This
content
[61] D. Popescu,
“Hiding malicious
[62] A. Albertini,
in PDF
documents,” CoRR, vol. abs/1201.0397, 2012. [Online].
Available: http://arxiv.org/abs/1201.0397
a
or,
a Picture of Cats,”
This Proof of Concept
PoC 11 GTFO 0x03, 2014.
[Online]. Available:
https://www.alchemistowl.org/pocorgtfo/pocorgtfo03.pdf
[63] M. McIntosh and P. Austel, “XML signature element
wrapping attacks and countermeasures,” in SWS ’05: Pro-
ceedings of the 2005 Workshop on Secure Web Services.
New York, NY, USA: ACM Press, 2005, pp. 20–27.
PDF
is
JPEG;
is
[64] J. Somorovsky, A. Mayer, J. Schwenk, M. Kampmann,
and M. Jensen, “On breaking saml: Be whoever you want
to be,” in 21st USENIX Security Symposium, Bellevue,
WA, Aug. 2012.
A. List of Permission-Incompliant PDF Applications
APPENDIX
The following applications do not correctly implement
permission-level checks. This implementation issue enables
the adaption of SSA to P1 certiﬁed documents and EAA to
P1 and P2 certiﬁed documents.
• Expert PDF 14, 14.0.28.3456, Windows
• LibreOfﬁce Draw, 6.4.2.2, Windows
• Master PDF Editor, 5.4.38, Windows
• PDF Architect 7, 7.1.14.4969, Windows
• PDF-XChange Editor, 8.0 (Build 336.0), Windows
• Perfect PDF 8 Reader, 8.0.3.5, Windows
• Perfect PDF 10 Premium, 10.0.0.1, Windows
• Soda PDF Desktop, 11.2.46.6035, Windows
• LibreOfﬁce Draw, 6.4.2.2, macOS
• Master PDF Editor, 5.4.38, Linux
• LibreOfﬁce Draw, 6.4.2.2, Linux
B. Fixed Applications
The following applications have been reported to us by the
vendors as ﬁxed.
• Adobe Acrobat DC, 2021.001.20315, Windows
• Adobe Acrobat 2020, 2020.001.30020, Windows
• Adobe Acrobat 2017, 2017.011.30190, Windows
• Foxit PhantomPDF, 10.1.1, Windows
• Foxit Reader, 10.1.1, Windows
• LibreOfﬁce, 7.0.4, Windows
• Adobe Acrobat DC, 2021.001.20315, macOS
• Adobe Acrobat 2020, 2020.001.30020, macOS
• Adobe Acrobat 2017, 2017.011.30190, macOS
• Foxit PhantomPDF, 4.1.1, macOS
• Foxit Reader, 4.1.1, macOS
• LibreOfﬁce, 7.0.4, macOS
• LibreOfﬁce, 7.0.4, Linux
C. PDF-Tester Workﬂow
Start
User Conﬁguration
Screenshot Generation
Yes
No
Screenshot Evaluation
Choose Attack Vector
PDF File
Yes
Open External Program
PDF Application
Take Screenshot,
Close Program
Select Unmanipulated
Screenshot
Ground Truth
Select Manipulated
Screenshot
Compare
Yes
Save Screenshot
Store Result
More Programs?
More Screenshots?
No
More PDFs?
No
End
PDF Tester Concept. The left part shows PDF Tester’s
screenshot generation. In the right part, PDF Tester’s screen-
shot evaluation is depicted.
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:29:12 UTC from IEEE Xplore.  Restrictions apply. 
161500
D. PDF-Detector Report
1 {
2
3
4
5
"status": "OK/warning/error",
"type": "approval/certified/none",
"permission": "1/2/3/none",
"incremental-update-changes": "annotation/signature/
annotation+signature/exists/none",
6
"changes-danger-level": "very high/high/medium/low/
none",
"message": ""
7
8 }
Listing 2. PDF-Detector returns a report as a JSON message. The message
contains information if dangerous elements intersecting with original content
occur in the document.
E. Priviliged JavaScript Execution in PDF
/JS (app.launchURL(
"https://www.malicious.org/",
true
1 >
);)
/S /JavaScript
Listing 3. Privileged JavaScript execution automatically invoking a URL.
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:29:12 UTC from IEEE Xplore.  Restrictions apply. 
171501