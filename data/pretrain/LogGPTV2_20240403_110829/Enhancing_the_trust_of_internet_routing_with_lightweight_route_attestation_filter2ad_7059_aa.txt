title:Enhancing the trust of internet routing with lightweight route attestation
author:Qi Li and
Mingwei Xu and
Jianping Wu and
Xinwen Zhang and
Patrick P. C. Lee and
Ke Xu
IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY, VOL. 7, NO. 2, APRIL 2012
691
Enhancing the Trust of Internet Routing
With Lightweight Route Attestation
Qi Li, Student Member, IEEE, Mingwei Xu, Member, IEEE, Jianping Wu, Fellow, IEEE,
Xinwen Zhang, Member, IEEE, Patrick P. C. Lee, Member, IEEE, and Ke Xu, Senior Member, IEEE
Abstract—The weak trust model in Border Gateway Protocol
(BGP)
introduces severe vulnerabilities for Internet routing
including active malicious attacks and unintended misconﬁgura-
tions. Although various secure BGP solutions have been proposed,
the complexity of security enforcement and data-plane attacks
still remain open problems. We propose TBGP, a trusted BGP
scheme aiming to achieve high authenticity of Internet routing
with a simple and lightweight attestation mechanism. TBGP
introduces a set of route update and withdrawal rules that, if cor-
rectly enforced by each router, can guarantee the authenticity and
integrity of route information that is announced to other routers
in the Internet. To verify this enforcement, an attestation service
running on each router provides interfaces for a neighboring
router to challenge the integrity of its routing stack, enforced
rules, and the attestation service itself. If this attestation succeeds,
the neighboring router updates its routing table or announces the
route to its neighbors, following the same rules. Thus, a router
on a routing path only needs to verify one neighbor’s routing
status to ensure that the route information is valid. Through this,
TBGP builds a transitive trust relationship among all routers on
a routing path. We implement a prototype of TBGP to investigate
its practicality. In our implementation, we use identity-based
signature and trusted computing techniques to further reduce the
complexity of security operations. Our security analysis and per-
formance study shows that TBGP can achieve the security goals
of BGP with signiﬁcantly better convergence performance and
lower computation overhead than existing secure BGP solutions.
Index Terms—Border gateway protocol (BGP), hijacking, pre-
vention, routing, secure BGP.
I. INTRODUCTION
T HE Border Gateway Protocol (BGP) is the only widely
deployed interdomain routing protocol connecting dif-
ferent IP networks or autonomous systems (ASes) to construct
the whole Internet [1]. In ordinary BGP, every AS announces its
Manuscript received December 21, 2010; revised November 01, 2011; ac-
cepted November 14, 2011. Date of publication December 01, 2011; date of
current version March 08, 2012. This work was supported by the National Nat-
ural Science Foundation of China under Grant 61073166, Grant 61133015, and
Grant 61161140454, by the National Basic Research Program of China (973
Program) under Grant 2009CB320502 and Grant 2012CB315803, and by the
National High-Tech Research and Development Program of China (863 Pro-
gram) under Grant 2011AA01A101. The associate editor coordinating the re-
view of this manuscript and approving it for publication was Dr. Yong Guan.
Q. Li, M. Xu, J. Wu, and K. Xu are with the Department of Computer
Science, Tsinghua University, Beijing 100084, China (e-mail: liqi@csnet1.
cs.tsinghua.edu.cn; PI:EMAIL; PI:EMAIL;
PI:EMAIL).
X. Zhang is with Huawei America Research Center, Santa Clara, CA 95050
USA (e-mail: PI:EMAIL).
P. P. C. Lee is with the Department of Computer Science and Engineering,
The Chinese University of Hong Kong, Hong Kong (e-mail: pclee@cse.cuhk.
edu.hk).
Color versions of one or more of the ﬁgures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identiﬁer 10.1109/TIFS.2011.2177822
route information with different preﬁxes. However, its neigh-
boring ASes cannot validate this route information, but rather
directly propagate it across the Internet. Obviously, this weak
trust model allows forged route announcement propagations,
which is a fundamental security weakness of BGP. Forged
routes, which can be generated by conﬁguration errors or
malicious attacks, can cause large-scale network connectivity
problems. For instance, on Feb. 24th, 2008, Pakistan Telecom
(AS17557) started an unauthorized announcement of
the
preﬁx 208.65.153.0/24. One of Pakistan Telecom’s upstream
providers, PCCW Global (AS3491) forwarded this announce-
ment to the rest of the Internet, resulting in the hijacking of
YouTube trafﬁc on a global scale [2]. The situation could be
worse if forged routes are generated by remote attacks [3].
In order to effectively eliminate false announcements and
improve the security of BGP, several security-enhanced BGP
solutions have been proposed. They generally can be classiﬁed
into two categories: cryptography-based prevention [4]–[8],
and anomaly detection [9]–[11]. Cryptographic approaches,
such as SBGP [4] and SoBGP [5], use a centralized routing
registration authority and public key infrastructure (PKI) to
ensure the authentication of routing announcements. These
solutions are not sufﬁcient to prevent data-plane attacks, where
an AS can announce a route not adopted by itself [12]. More-
over, they usually consume a signiﬁcant amount of extra router
resources including computation and storage, and exacerbate
the routing convergence performance. It is obvious that pure
cryptography-based solutions are not cost-efﬁcient to defend
against routing attacks, and this impedes their deployment on
the Internet. On the other hand, anomaly detection approaches
aim to discover underlying hijacks in BGP announcements,
e.g., by comparing BGP announcements with out-of-band
information and querying third-party routing services [10].
However, most of the anomaly detection solutions raise false
positives and require network operators to take actions in order
to block detected anomalous routes [9]–[11].
In this paper, we propose a trusted BGP scheme called TBGP,
which aims to use minimal computation cost to achieve BGP se-
curity goals. Unlike existing cryptography-based approaches,
we do not solely rely on cryptography mechanisms to secure
routing. Instead, we propose a set of well-deﬁned route update
and withdrawal rules that are enforced by the ﬁlters of each BGP
router along a routing path. These rules guarantee that route an-
nouncements comply with the BGP speciﬁcation [1]. Thus, the
enforcement of these rules provides automatic route authenticity
in each router and prevents the spread of forged routes over the
Internet. In order to ensure that these rules are not misconﬁg-
ured or maliciously modiﬁed, and hence correctly enforced on
each router, TBGP introduces an attestation service running on
1556-6013/$26.00 © 2011 IEEE
692
IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY, VOL. 7, NO. 2, APRIL 2012
each router. With this service interface, a neighbor router can
challenge this router’s current running state, including the in-
tegrity of its routing protocol stack, the routing rules, and the
attestation service itself. When this attestation veriﬁcation suc-
ceeds, the attesting router has the assurance that the route in-
formation it receives from this router is legitimate and follows
the routing speciﬁcation. Thus, the router can use the route in-
formation to update its own routing table, or announce it to its
neighbors based on the same set of rules. In turn, its routing state
and enforced rules can be challenged by other router. Thus, a
transitive trust relationship can be built by attesting and veri-
fying only one neighboring router along a routing path. TBGP
exploits the transitive trusts among routers to extensively save
computation and network resources compared to traditional se-
cure BGP approaches.
The above attestation does not prevent a malicious router
from claiming to own a particular AS number and generating
forge routes. In order to verify the owner of an AS number
and the authorization of using it, each route update is digitally
signed by the attestation service upon the successful attesta-
tion challenge. A router is authorized to use its own private key
to sign any valid announcement only when routes are success-
fully attested in OUT ﬁlters. The signature is then veriﬁed by its
neighbors via their own attestation service. As the private key is
bound with the AS number owned by the router, the attestation
process can guarantee the authenticity of announced routes of a
benign router.
We implement a prototype to demonstrate the practicality of
TBGP and use commodity techniques to further improve its per-
formance. First, with the advent of Trusted Computing (TC)
technologies, we note that TC-enabled chips are equipped in al-
most all commodity PCs and are ready for embedded systems
[13]–[15]. Thus, we use this facility to securely store the private
keys in each router and bind the integrity of router software and
the correct enforcement of BGP rules with authorized signing
operations using the protected keys. Furthermore, we accom-
plish the veriﬁcation of preﬁx originals and AS_PATH with the
identity-based signature (IBS) scheme [16], [8], which elimi-
nates the centralized certiﬁcate management infrastructure and
the aggregated signatures as in traditional RSA- and DSA-based
algorithms. This signiﬁcantly reduces the overhead of runtime
security operations.
The security analysis shows that TBGP achieves the security
requirements of BGP, including AS number authentication,
BGP speaker (router) authentication, AS path authentication,
and preﬁx origin authentication. It also effectively prevents
data-plane attacks such as trafﬁc attraction attacks [12] by
guaranteeing normal BGP execution routines and enforcing
route attestation rules in each BGP speaker. We evaluate the
performance of TBGP with both experimental studies and
simulations. The experimental studies show that TBGP only
introduces by an average of 2-ms delay in route selection and
announcement of every route (per-preﬁx). We then seed the ex-
perimental data as the parameters into large scale simulations.
Our simulation results show that TBGP has signiﬁcantly lower
performance overhead and resource consumption than existing
secure BGP approaches. When compared to prior secure BGP
solutions, TBGP has an improvement of at least 1.25 times in
convergence time and 9.26 times in memory consumption. This
Fig. 1. Examples of normal route and malicious route announcements of BGP.
(1) indicates a complete preﬁx attack and (2) an invalid path attack.
evidently shows that TBGP could be a potential solution for
building a trustworthy Internet routing infrastructure.
The remainder of the paper is organized as follows. In
Section II, we introduce the problem statement of BGP se-
curity and existing solutions and the design goals of TBGP.
In Section III, we propose the BGP route rules to build trust
between different ASes. The implementation details of our
prototype are illustrated in Section IV. Section V presents per-
formance evaluation results. We discuss some issues of TBGP
deployment in Section VI. Section VII concludes this paper.
II. BACKGROUND AND DESIGN GOALS
A. BGP Security Threats
Current BGP is always under attacks from maliciously mis-
conﬁgured speakers or intercepted unauthorized BGP sessions,
both of which can cause BGP routing anomaly and further In-
ternet disruption. Since BGP speakers fail to verify the ori-
gins of BGP announcements, a BGP speaker can announce any
preﬁx that does not belong to its AS. Similarly, a BGP speaker
cannot validate the AS path of a received BGP announcement.
Thus, the announced route may be invalid and redirect trafﬁc to
wrong/malicious destinations. In general, there are two types of
attacks in BGP: preﬁx hijacks and invalid path attacks [17].
Preﬁx hijacks include the complete preﬁx and subpreﬁx hi-
jacks. It is easy to carry out complete preﬁx hijacks on the In-
ternet, but it is relatively hard to detect them. For example, a
complete preﬁx hijack can occur when an AS announces itself
as the origin of a preﬁx that it does not own, and its neighboring
ASes then reroutes any trafﬁc with corresponding destination
to the hijacker. Attack (1) shown in Fig. 1 is a complete preﬁx
hijack, in which a malicious speaker in AS 6 announces that
AS 6 is the owner of the preﬁx 12.34.8.0/24 and advertises AS
path {6} to AS 4. The subpreﬁx hijack is similar to the complete
preﬁx hijack except that its announced preﬁx is a subset of an-
other announced preﬁx.
An invalid path attack occurs when the AS path of a BGP
announcement includes fake AS numbers. For instance, attack
(2) illustrated in Fig. 1 is an invalid path attack, where AS 6
advertises a forged AS path {61} to AS 5 and any trafﬁc to AS
1 is redirected to AS 6 if AS 5 adopts this route. Because BGP
is a policy vector routing protocol, it cannot detect relationships
between ASes. Therefore, it is also very hard to detect invalid
path attacks.
LI et al.: ENHANCING TRUST OF INTERNET ROUTING WITH LIGHTWEIGHT ROUTE ATTESTATION
693
B. Related Work
Several security-enhanced BGP solutions have been pro-
posed in literature, and they can be classiﬁed into two types, in
general. The ﬁrst type uses cryptographic algorithms to provide
the authentication of ASes and AS_PATHs (i.e., sequences of
ASes that represent routes), such as SBGP [4], SoBGP [5],
psBGP [6] and SPV [8]. The second type is to deploy invalid
route detection mechanisms, such as IRV [10], Listen and
Whisper [9], PGBGP [11], iSPY [18] and NetReview [19].
SBGP is the ﬁrst proposed secure BGP solution [4], which
uses public key infrastructure (PKI) to issue AS and preﬁx cer-
tiﬁcates for veriﬁcation of announced preﬁxes and AS paths. In
SBGP, aggregated signatures are used to guarantee the authen-
ticity and integrity of BGP announcements. For a speciﬁc route,
different signatures of preﬁx and AS_PATH are attached in an-
nouncements by traversed ASes. To improve the performance of
SBGP, S-A and SAS apply cryptographic operation speedup and
sequential aggregate signature, respectively [20]. SPV adopts
a more efﬁcient cryptographic mechanism [8]. However, these
solutions have the drawback of large computation and memory
costs. To address these issues, Secure origin BGP (SoBGP) uses
a distributed trust model [5], in which a new BGP message is in-
troduced to deliver certiﬁcates. Unfortunately, SoBGP cannot
prevent invalid AS path attacks. Pretty secure BGP (psBGP)
uses a signed preﬁx assertion list (PAL) that consists of a number
of bindings of AS numbers and (zero or more) IP preﬁxes [6].
Similar to SBGP and SoBGP, it is difﬁcult to apply psBGP in
real application scenarios where customer ASes may obtain IP
addresses from different ISPs in a hierarchical way.
Towards trusted route update in individual router platform,
BIND [21] uses a Trusted Computing (TC) mechanism to run
routing processes in an isolated memory space and sign and
verify the integrity of AS_PATH. Similar to TBGP, BIND aims
to achieve a transitive trust between routers so as to reduce
integrity veriﬁcation complexity. However, the transitive trust
of BIND and TBGP are achieved with different mechanisms.
BIND focuses on attesting the AS_PATH of a neighbor router
and uses a shared-key protected MAC value of the result of a
routing update. On the other hand, TBGP achieves transitive
trust with attesting valid security rules enforcement of routing
updates. Thus, TBGP and BIND complement each other. The
path authentication proposed by Butler et al.. [22] leverages a
cryptographic proof system to reduce signature validations by
carrying proofs in routing updates based on reference locality
of BGP announcements, which introduces more communication
overhead than SBGP.
In summary, these solutions usually need to consume large
computation resources and cannot meet the practical require-
ments of real scenarios. Moreover, they usually cannot prevent
data-plane attacks [12] because they cannot detect the incon-
sistency between BGP’s control-plane (calculated routes) and
data-plane (routes to forward packets).
Interdomain route validation (IRV) [10] introduces an addi-
tional route validation service in BGP, through which the au-
thenticity of BGP route information is veriﬁed. However, IRV
cannot detect forged AS attacks. The Listen and Whisper so-
lution [9] monitors all exchanged route announcements to de-
tect underlying anomalies but offers weaker detection capability
[20]. Moreover, Pretty Good BGP (PGBGP) [11] blocks large-
scale attacks by delaying the propagation of suspicious routes.
Recently, several improved preﬁx hijack detection approaches
have been proposed. Lad et al. [23] propose an alert system
to detect preﬁx hijacks by detecting the changes of preﬁx ori-
gins. Hu et al. [24] improve the detection accuracy by ana-
lyzing conﬂicts in data-plane footprints. Zhang et al. [18] pro-
pose iSPY to detect hijacks by analyzing preﬁx reachability
in preﬁx owner networks. N-BGP [25] is proposed to build a
trusted third party to realize a policy monitor using trusted com-
puting (TC). N-BGP enforces route attestation rules for routing
anomaly detection with a BGP monitor, but not in individual
BGP speakers. These solutions can be easily deployed on the