title:MERS: Statistical Test Generation for Side-Channel Analysis based
Trojan Detection
author:Yuanwen Huang and
Swarup Bhunia and
Prabhat Mishra
MERS: Statistical Test Generation for Side-Channel
Analysis based Trojan Detection
Yuanwen Huang
Department of Computer and
Information Science and
Engineering,
University of Florida,
Florida 32611, USA
yuanwenhuang@uﬂ.edu
Swarup Bhunia
Department of Electrical and
Computer Engineering,
University of Florida,
Florida 32611, USA
swarup@ece.uﬂ.edu
Prabhat Mishra
Department of Computer and
Information Science and
Engineering,
University of Florida,
Florida 32611, USA
prabhat@uﬂ.edu
ABSTRACT
Hardware Trojan detection has emerged as a critical chal-
lenge to ensure security and trustworthiness of integrated
circuits. A vast majority of research eﬀorts in this area has
utilized side-channel analysis for Trojan detection. Func-
tional test generation for logic testing is a promising al-
ternative but it may not be helpful if a Trojan cannot be
fully activated or the Trojan eﬀect cannot be propagated
to the observable outputs. Side-channel analysis, on the
other hand, can achieve signiﬁcantly higher detection cover-
age for Trojans of all types/sizes, since it does not require
activation/propagation of an unknown Trojan. However,
they have often limited eﬀectiveness due to poor detection
sensitivity under large process variations and small Trojan
footprint in side-channel signature. In this paper, we address
this critical problem through a novel side-channel-aware test
generation approach, based on a concept of Multiple Exci-
tation of Rare Switching (MERS), that can signiﬁcantly in-
crease Trojan detection sensitivity. The paper makes several
important contributions: i) it presents in detail the statisti-
cal test generation method, which can generate high-quality
testset for creating high relative activity in arbitrary Tro-
jan instances; ii) it analyzes the eﬀectiveness of generated
testset in terms of Trojan coverage; and iii) it describes two
judicious reordering methods can further tune the testset
and greatly improve the side channel sensitivity. Simulation
results demonstrate that the tests generated by MERS can
signiﬁcantly increase the Trojans sensitivity, thereby making
Trojan detection eﬀective using side-channel analysis.
CCS Concepts
•Hardware → Hardware test; Very large scale integra-
tion design; Hardware validation;
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full cita-
tion on the ﬁrst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from permissions@acm.org.
CCS’16, October 24-28, 2016, Vienna, Austria
c(cid:13) 2016 ACM. ISBN 978-1-4503-4139-4/16/10. . . $15.00
DOI: http://dx.doi.org/10.1145/2976749.2978396
Keywords
Hardware Security; Hardware Trojan Detection; Side-Channel
Analysis; Statistical Test Generation.
1.
INTRODUCTION
Hardware Trojan attacks relate to malicious modiﬁcations
in the design of Integrated Circuits (ICs) at diﬀerent stages
of the design or fabrication process [1]. An adversary can
introduce these modiﬁcations in a design in order to cause
disruption in normal functional behavior and/or to leak se-
cret information from a chip during operation in ﬁeld. With
the emerging trend of increased globalization of IC design
and fabrication process and consequently reduced control on
these steps by a trusted chip manufacturer, ICs are becom-
ing increasingly vulnerable to these attacks. Since the threat
of hardware Trojan in the form of a malicious implant in a
design came into light about a decade ago through an US
Department of Defense announcement [2], it has triggered
wide array of research activities in threat analysis as well
as design/validation solutions to evaluate this threat and
protect against it. Hardware Trojan attacks are also being
increasingly recognized in the semiconductor industry as a
serious security concern.
A Trojan is expected to be covert and diﬃcult to detect,
i.e. an intelligent adversary will likely insert a Trojan circuit
in a way that evades detection during post-manufacturing
functional/parametric testing, but manifests itself during
long hour of in-ﬁeld operation. This can be achieved by
externally triggering its operation or by making it depen-
dent on rare circuit conditions inside an IC. The condition
of Trojan activation as commonly referred to as trigger con-
dition, which can be purely combinational or sequential, i.e.
related to the clock or a sequence of rare events in the state
elements (e.g. ﬂip-ﬂops of registers). The internal circuit
nodes aﬀected by a Trojan activation are referred to as pay-
load of a Trojan. Fig. 1 shows some example Trojan circuits
including a combinational and a sequential Trojan. For ex-
ample, a Trojan circuit could be triggered only when a data
bus attains a unique rare value or when the number of times
it attains the rare value equals to a particular count. The
malicious eﬀects of Trojan payloads can range from passive,
such as leakage of secret information to altering the original
functionality of the chip in a critical or destructive fashion.
Protection against hardware Trojan attacks can be ac-
complished in two broad ways: (1) design-for-security (DfS)
techniques that make Trojan insertion diﬃcult or make a
(a) Combinational Trojan
(b) Sequential Trojan
Figure 1: Example of a combinational and a sequential Tro-
jan with triggers from two rare internal nodes A and B.
Trojan easily detectable through post-silicon testing; and
(2) manufacturing test approaches that aim at detecting an
arbitrary Trojan by observing its eﬀect into a circuit’s op-
erational behavior. The ﬁrst class of techniques, primarily
relies on diﬀerent types of hardening approaches - e.g.
in-
sertion of dummy cells into empty spaces in a circuit layout;
or key-based obfuscation of a design that make malicious
alteration by an adversary provably hard. DfS techniques,
however, come at the cost of additional design, veriﬁcation,
and test time, as well as additional design overhead. For
example, key-based obfuscation, even though is capable of
providing high level of robustness against Trojan attacks,
come at a cost of 10% or more area overhead [3]. More
importantly, design solutions, however, only work for new
designs and not legacy designs, and hence has limited ap-
plicability. Hence, eﬃcient test/validation approaches that
can provide high level of conﬁdence regarding IC trustwor-
thiness in presence of Trojan threat provides an attractive
solution to the IC manufacturers.
Existing test solutions for hardware Trojan detection can
be broadly classiﬁed into: 1) logic testing and 2) side-channel
analysis approaches.
In logic testing approach, directed
structural or functional tests are generated to activate rare
events in a circuit and propagate the malicious eﬀect of a
Trojan in logic values to primary outputs. Such approaches
are known to be more eﬀective in detecting ultra-small Tro-
jans (typically a few gates in size) reliably under large pro-
cess variations. The main challenge with logic testing ap-
proaches, however, is the diﬃculty to trigger a Trojan and
observe its eﬀect, particularly the complex sequential Tro-
jans, and the inordinately large number of possible Trojan
instances an adversary can exploit. On the other hand, side-
channel analysis approaches depend on measurement and
analysis of physical “side-channel” parameters like power sig-
nature or path delay of an IC in order to identify a structural
change in the design. Such approaches have the advantage
that they do not require triggering a malicious change and
observing its impact at the primary output. Side-channel
analysis (SCA), primarily based on supply current, has been
extensively investigated by large number of research groups
and various solutions to increase the signal-to-noise (SNR)
have been proposed. A disadvantage of SCA arises from the
large process variations (e.g. 20X leakage power and 30%
delay variations in 180nm technology [4]) which can poten-
tially mask the minute eﬀect of a Trojan in the measured
side-channel parameter.
Even though SCA has shown tremendous promise in de-
tecting unknown Trojans of various types during manufac-
turing test of an IC, a major issue with SCA is the low
detection sensitivity. For a billion transistor modern IC, a
Trojan with just a few logic gates would have a minuscule
side-channel foot-print, which will require a measurement
resolution and dynamic range in an instrument, that is hard
to achieve. For example, a delta shift in several nano or
pico amp of transient current in ten’s of amp of background
current, would be practically infeasible to detect even with
most precise and expensive instrument. The problem is ag-
gravated by orders of magnitude due to presence of both
systematic and random variations in device parameters due
to intrinsic process variations.
A solution to the sensitivity problem can be achieved by
judicious test generation approach that aims at maximizing
the sensitivity for an arbitrary Trojan in unknown circuit
location. Through the remainder of the paper, we focus on
transient current or power as our side-channel parameter
of interest. Some of the concepts however can be applied
to other side-channel parameters. To maximize sensitivity
of a given Trojan, one needs to amplify activity inside the
Trojan circuit and simultaneously minimize the background
activity (i.e. activity in the original circuit). However, since
the number of possible Trojan instances in a design can be
inordinately large, a deterministic test generation method
similar to conventional stuck-at fault test generation, cannot
work. To address this issue, in this paper, we present a novel
test generation framework that can maximize the detection
sensitivity for an arbitrary Trojan.
1.1 Main Idea and Our Contributions
The goal of our work is to generate eﬃcient test vectors
for Trojan detection using side-channel analysis. Functional
test can detect Trojan eﬀect only when it is fully triggered
and its payload is propagated to the primary outputs, which
makes functional test infeasible to detect Trojans in most
cases. Side channel analysis can detect well-hidden Trojans
by inspecting the side channel signals, for example, transient
current in the circuit. If the switching eﬀect introduced by
the Trojan circuit is distinguishable, in the presence of pro-
cess variation, the Trojan will get identiﬁed. In this paper
we propose a comprehensive test generation framework to
assist side channel analysis for hardware Trojan detection.
We use the relative switching of the Trojan with respect
to the whole circuit to indicate the sensitivity of the side
channel signals. The statistical test patterns can maximize
relative Trojan detection sensitivity under any process noise.
Process variation is not expected to aﬀect our side channel
sensitivity computation since we consider switching activity
instead of actual current or power values. The assumptions
we have made are similar to the state-of-the-art side-channel
analysis based Trojan detection approaches. The proposed
method can be combined with any existing process calibra-
tion approaches (such as one in [21] or [22]) to minimize the
false positives/negatives and maximize Trojan coverage.
To make side channel analysis successful in detecting Tro-
jans, we need to: (1) maximize the switching activity in the
Trojan circuit; (2) minimize the switching activity in other
parts of the circuit so that the relative switching eﬀect is
maximized. The main idea of this paper is to generate high
quality test patterns which can achieve these two goals and
increase the sensitivity of side channel analysis. The follow-
ing are the major contributions of this paper:
1. It presents, for the ﬁrst time in our knowledge, a sta-
tistical test generation approach for increasing side-
channel analysis based Trojan detection sensitivity. The
proposed approach can be applicable to any transient
current based Trojan detection approach.
2. The methodology, referred to as MERS (Multiple Ex-
citation of Rare Switching) for statistical test gener-
ation, is shown to derive a compact testset that can
trigger each of the rare nodes to satisfy rare switching
for multiple times. MERS can have a good coverage of
all rare nodes and greatly increase the switching eﬀect
inside arbitrary Trojans in unknown locations of the
circuit.
3. Two reordering methods are proposed to reduce the
total switching of the circuit and thus further increase
the sensitivity of side channel analysis. First, a simple
and low-cost method based on Hamming distance of
input vector pairs is introduced to reorder the tests.
Next, we develop another simulation based method to
more eﬀectively balance switching in rare nodes and
the total switching.
Our side-channel based approach is targeted towards de-
tecting unknown Trojans, which means it will remain equally
eﬀective even if the adversary is aware of the proposed method.
This is due to the following two reasons: (1) the proposed
test generation method is statistical in nature - so, unlike
conventional deterministic test approaches, it maximizes the
activation probability for arbitrary Trojans designed with
any trigger condition; and (2) it maximizes the detection
sensitivity of unknown Trojans, however “stealthy”, by am-
plifying its eﬀect in side-channel signature. Our simulation
platform inserts large number of arbitrary Trojans in a de-
sign and shows that the proposed approach is highly eﬀective
in detecting them.
The rest of the paper is organized as follows. Section 2
provides overview of hardware Trojan attacks and the broad
classes of Trojan detection approaches. Section 3 presents
related work in side channel analysis and functional test gen-
eration for Trojan detection. Section 4 presents the MERS
test generation algorithm and the test reordering algorithms
to improve sensitivity of side channel analysis. Section 5 de-
scribes the experiment setup and presents results on a set
of ISCAS benchmarks with detailed analysis. Section 6 con-
cludes the paper.
2. BACKGROUND AND PRELIMINARY
In this section we brieﬂy describe the growing threat of
hardware Trojan attacks and discuss two broad classes of
Trojan detection approaches.
2.1 Hardware Trojan Attacks
Malicious modiﬁcation of IC at diﬀerent stages of its life
cycle, known as hardware Trojan attacks, is an impending
threat in the electronics industry. Increased reliance on third
party hardware intellectual property (IP) blocks and design
automation tools in the IC design ﬂow as well as outsourc-
ing of design/fabrication steps to external parties due to
economic reasons are rapidly increasing the vulnerability to
Trojan attacks. An adversary can mount such an attack
with an objective to cause in-ﬁeld operational failure or to
leak secret information from inside a chip - e.g. the key in
a cryptographic IC. Recent investigations have shown that
an intelligent adversary can insert tiny Trojans of numer-
ous forms and sizes into a million-transistor design, which
can easily evade conventional manufacturing test that is not
designed to isolate the stealthy Trojan attacks.
Depending on their mode of operation and structure, hard-
ware Trojans can be grouped into several broad classes. A
common classiﬁcation of Trojans [1][7] is based on the activa-
tion mechanism (referred as Trojan trigger ) and the eﬀect on
the circuit functionality (referred as Trojan payload ). Tro-
jans can be both combinationally and sequentially triggered.
Typically, an adversary would choose an extremely rare acti-
vation condition so that it is highly unlikely for the Trojan to
trigger during conventional manufacturing test. Sequentially
triggered Trojans (the so-called “time bombs”), on the other
hand, are activated by the occurrence of a sequence, or after
a period of continuous operation. The simplest sequential
Trojans are synchronous stand-alone counters, which trigger
a malfunction on reaching a particular count. The trigger
mechanism can also be analog in nature, whereby on-chip
sensors are used to trigger a malfunction. For example, the
Trojan gets activated when the temperature of a particular
region of the IC exceeds a threshold [1]. Trojans can also be
classiﬁed based on their payload mechanisms into two main
classes - digital and analog. Digital payload Trojans can ei-
ther aﬀect the logic values at chosen internal payload nodes,
or can modify the contents of memory locations. Analog pay-
load Trojans, on the other hand, aﬀect circuit parameters
such as performance, power and noise margin.
2.2 Trojan Detection Approaches
Detecting hardware Trojan instances in an IC before it
is used in an electronic system is of paramount importance.
Even though DfS approaches that aim at hardening a design
with respect to Trojan insertion or facilitating Trojan detec-
tion during manufacturing test are being actively researched
[3], they have several major limitations: (1) they cannot
provide provably robust defense against all forms of Trojan
attacks; (2) they often incur unacceptable design overhead;
and (3) they cannot be applied to legacy designs, which is
diﬃcult to change for incorporating DfS features. Hence, a
Trojan detection step for trust validation during post-silicon
manufacturing test is becoming crucial to isolate ICs aﬀected
with Trojans.
It is worth noting that conventional post-manufacturing
test using functional / structural test patterns performs poorly
to reliably detect hardware Trojans. This is because man-
ufacturing test generation and application aim at detect-
ing manufacturing defects with well-characterized behavior
and model that cause deviation from functional or paramet-
ric speciﬁcations. They do not aim at detecting additional
functionalities incorporated by a Trojan or deviation in cir-
cuit behavior triggered by rare events. Hence, conventional
testing methods typically provide poor Trojan detection ca-
pability, as observed by researchers [5]. Destructive test-
ing of a chip by de-packaging, de-metallization and micro-
photography based reverse-engineering is highly expensive
(in time and cost) and not a feasible solution because an
attacker may selectively insert Trojan into a small subset of
the manufactured ICs [8].
Existing Trojan detection approaches fall into two major
classes: (a)functional testing based, and (b) side-channel
analysis based. Most Trojan detection techniques proposed
in the literature are characterized by their eﬃciency in de-
tecting particular classes of Trojan. These approaches typi-
cally fail to provide high conﬁdence in detecting an inserted
Trojan of arbitrary operating mode. The enormous vari-
ety of Trojans and the inordinately large Trojan population
that might be present in a circuit makes it diﬃcult to de-
vise deterministic test patterns for them. The functional
testing based Trojan detection approaches [5] aim to trig-
ger rare events at internal nodes in the circuit to activate
Trojans and then compare the obtained output logic val-
ues of the circuit with the expected golden values of the IC.
On the other hand, the side-channel analysis based Trojan
detection approaches [9][12][19] are based on observing the
eﬀect of an inserted Trojan on a physical parameter such
as circuit transient current, power consumption or path de-
lay, and then comparing it with the pre-characterized golden
value for a Trojan-free IC (or a model of the IC). If the ob-
served value of the measured parameter diﬀers by more than
a threshold from the golden value, the presence of a Trojan
is suspected. Both classes of Trojan detection techniques
have their relative pros and cons. The main challenge for
functional testing based Trojan detection approaches is the
enormously large Trojan design space, which makes com-
plete enumeration and test generation for all feasible Trojan
instances in a moderately-sized circuit computationally in-
feasible. This makes it extremely diﬃcult to guarantee that
an arbitrary inserted Trojan would be activated, cause cir-
cuit malfunction and thus get detected during the test ap-
plication phase. On the other hand, the advantage of the
side-channel analysis based approaches lies in the fact that
even if the Trojan circuit does not cause observable mal-
function in the circuit during test, the presence of the extra
circuitry can be reﬂected in the measured side-channel pa-
rameter. Further, such techniques are suitable for arbitrarily