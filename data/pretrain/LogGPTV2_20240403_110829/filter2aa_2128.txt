Could Googling Take Down A President, 
a Prime Minister, or an Average Citizen?
Gregory Conti
United States Military Academy
West Point, New York
PI:EMAIL
Outline
• Information Disclosure
– Computing Platform
– Network Eavesdropping
– Destination Websites
• Vectors
• Cross-site Tracking
– Advertising and Embedded Content
• User Motivation
– The survey says
• Solutions
   “Never talk when you 
can nod, and never nod 
when you can wink, and 
never write an e-mail 
because it's death. 
You're giving prosecutors 
all the evidence we 
need.” 
- Eliot Spitzer 
  Two Years before his resignation
http://abcnews.go.com/Blotter/story?id=4424507&page=1
Eliot Spitzer
Former-Governor of New York
Maf54 (7:43:27 PM): 
well dont ruin my 
mental picture
Xxxxxxxxx (7:43:32 PM): 
oh lol...sorry
Maf54 (7:43:54 PM): 
nice
Maf54 (7:43:54 PM): 
youll be way hot 
then
Xxxxxxxxx (7:44:01 PM): 
haha...hopefully
Mark Foley
Former-US Congressman
http://abcnews.go.com/WNT/BrianRoss/Story?id=2509586&page=2
   Can anyone help me please! This stalking 
thing is not funny at all. When I type my 
name in keyword it gives a list of places 
that show where I have been on aol on the 
net. This is nobodys business. I have not 
done anything wrong at all and I have 
contacted aol about this matter and they 
keep saying they will do something about 
it but never do. 
-Debbie
   How do I get stuff removed from aol 
stalker? Can anyone tell me? Aol won't 
respond even though they claim 
willingness to remove data when 
requested. Someone, anyone, please help!
-Sally
http://blogs.ittoolbox.com/security/investigator/archives/aol-stalker-website-unleashed-11133
AOL Demo
• User #10291
• User #2708
The AOL Dataset Debacle
SIGIR – IR List (August 2006)
Subject: research.aol.com 
AOL is embarking on a new direction for its 
business making its content and products 
freely available to all consumers. To support 
those goals, AOL is also embracing the 
vision of an open research community.  To 
get started, we invite you to visit us at 
http://research.aol.com, where you will 
find: 
•
20,000 hand labeled, classified queries 
•
3.5 million web question/answer queries 
(who, what, where, when, etc.) 
•
Query streams for 500,000 users over 3 
months (20 million queries) 
•
2 million queries against US Government 
domains 
Also, please feel free to provide feedback 
on the site, datasets you'd like to see in the 
future, and any other comments about our 
vision. 
AOL Psycho
AOL Stalker
Definitions
• googling: The full spectrum of free 
online tools and services (such as 
search, mapping, email, Web-based 
word processing and calendaring 
etc.)
• web-based information disclosure: 
the information we disclose as we 
surf the web
Global Computing Statistics
• World Population 
~6.6 Billion
• Cell Phones
~3.3 Billion
• Personal Computers 
~1.2 Billion
• MP3 Players
~220 Million
• Digital Cameras
~120 Million
• Webcams
~100 Million
• PDAs
~85 Million
• DVRs
~44 Million
• Servers
~27 Million
Kevin Kelly, “The Planetary Computer.”  Wired, 16.07, July 2008, pp52-55
Data Collection
http://www.nytimes.com/2008/03/10/technology/10privacy.html?pagewanted=1&_r=1&hp / Comscore
Unique Visitors
(millions / month)
http://www.nytimes.com/2008/03/10/technology/10privacy.html?pagewanted=1&_r=1&hp & Comscore
• 1.319 Billion for Year End 2007
• 20% Overall Penetration
source: http://www.internetworldstats.com/stats.htm
Information Leakage on a PC
Information Leakage and Spurious 
Emanations on a Network
ISPs vs. Large Online Companies
 Online Company
• Sees global traffic 
from many customers
– domain specific
• Advertising and 
embedded content 
brings in additional 
information
• Limited knowledge of 
user identity
• Extensive datamining
ISP
• Sees all traffic from its 
set of customers
– except encrypted traffic
– traffic analysis 
• Limited to no visibility 
on non-customers
• Knows identity and 
location of accounts
• Ability to manipulate 
network flows
– DNS
– blocking P2P
Vantage Points of ISPs vs Online Companies
DNS Based Vulnerabilities
Major Threat Vectors
• Email
• Search
• Mobile Phones
• FTP Replacement
• Web office suites
• Mapping
• ...
The Many Flavors of Search
(Simply Google)
Malware Search
http://metasploit.com/research/misc/mwsearch/index.html
http://www.theregister.co.uk/2006/07/18/malware_search/
Motivation
• Cost benefit analysis
– users
– webmasters
– bloggers
• Short-term gain vs. long term risks
• stats
• boils down to trust and awareness
If the content on the web 
it is fair game.
Case Studies
Craig’s List
Ebay
Amazon
Hotmail
   Any email 
that touches 
any of these 
servers 
should be 
considered 
compromised.
Everyscape
http://www.everyscape.com/sanfrancisco-ca.us.aspx
Linked In
   Social 
networking 
sites know 
your contacts 
and your 
contacts’ 
contacts.  Old 
friends will 
find you and 
let the site 
know of the 
relationship.
Map Quest
  Mapping 
sites reveal 
locations of 
interest, 
allowing 
diverse 
groups of 
users to be 
linked.
You Send It
rot 13
  Even the 
most 
innocent 
appearing 
services 
should be 
considered 
as collecting 
your data
Cross-site Tracking
• Web Analytics
• Embedded content
– Webbugs
– YouTube Videos
• Advertising
– Doubleclick
– AdSense
• Referer data
• Javascript Libraries
• Clickthrough Tracking
A Visit to MSNBC
0.0.0.0
255.255.255.255
•
a365.ms.akamai.net
•
a509.cd.akamai.net
•
ad.3ad.doubleclick.net
•
amch.questionmarket.com
•
c.live.com.nsatc.net 
•
c.msn.com.nsatc.net 
•
rad.msn.com.nsatc.net
•
context3.kanoodle.com
•
global.msads.net.c.footprint.net
•
hm.sc.msn.com.c.footprint.net
•
msnbcom.112.2o7.net
•
prpx.service.mirror-image.net
•
wrpx.service.mirror-image.net
•
switch.atdmt.com
•
view.atdmt.com
•
www-google-analytics.l.google.com
•
16 third-party sites
•
10 separate companies
http://www.msnbc.msn.com/
Third Party Content and Web Bugs
Linking a User Across Many Platforms
Linking Users, Groups, and 
Organizations
Advertising – The DoubleClick Model
Click Through Tracking
Browser Supplied Information
Google-Analytics
         var _gat=new Object({c:"length",lb:"4.2",m:"cookie",b:undefined,cb:function(d,a)
{this.zb=d;this.Nb=a},r:"__utma=",W:"__utmb=",ma:"__utmc=",Ta:"__utmk=",na:"__utmv=",oa:"__utmx=",Sa:"GASO=",X:"__ut
mz=",lc:"http://www.google-analytics.com/__utm.gif",mc:"https://ssl.google-analytics.com/__utm.gif",Wa:"utmcid=",Ya:"utmcsr=",
$a:"utmgclid=",Ua:"utmccn=",Xa:"utmcmd=",Za:"utmctr=",Va:"utmcct=",Hb:false,_gasoDomain:undefined,_gasoCPath:undefined,e
:window,a:document,k:navigator,t:function(d){var a=1,c=0,g, o;if(!_gat.q(d)){a=0;for(g=d[_gat.c]-1;g>=0;g--)
{o=d.charCodeAt(g);a=(a>21:a}}return a},C:function(d,a,c){var 
g=_gat,o="-",k,m,q=g.q;if(!q(d)&&!q(a)&&!q(c)){k=g.w(d,a);if(k>-1){m=d.indexOf(c,k);if(m0&&_gat.P(" \n\r\t",d)},P:function(d,a){return _gat.w(d,a)>-1},h:function(d,a){d[d[_gat.c]]=a},T:function(d){return 
d.toLowerCase()}, z:function(d,a){return d.split(a)},w:function(d,a){return d.indexOf(a)},F:function(d,a,c){c=_gat.b==c?
d[_gat.c]:c;return d.substring(a,c)},uc:function(){var 
d=_gat.b,a=window;if(a&&a.gaGlobal&&a.gaGlobal.hid)d=a.gaGlobal.hid;else{d=Math.round(Math.random()*2147483647);a.gaGlo
bal=a.gaGlobal?a.gaGlobal:{};a.gaGlobal.hid=d}return d},wa:function(){return 
Math.round(Math.random()*2147483647)},Gc:function(){return(_gat.wa()^_gat.vc())*2147483647},vc:function(){var 
d=_gat.k,a=_gat.a,c=_gat.e,g=a[_gat.m]? a[_gat.m]:"",o=c.history[_gat.c],k,m,q=[d.appName,d.version,d.language?
d.language:d.browserLanguage,d.platform,d.userAgent,d.javaEnabled()?
1:0].join("");if(c.screen)q+=c.screen.width+"x"+c.screen.height+c.screen.colorDepth;else if(c.java)
{m=java.awt.Toolkit.getDefaultToolkit().getScreenSize();q+=m.screen.width+"x"+m.screen.height}q+=g;q+=a.referrer?
a.referrer:"";k=q[_gat.c];while(o>0)q+=o--^k++;return _gat.t(q)}});_gat.hc=function(){var d=this,a=_gat.cb;function c(g,o)
{return new 
a(g,o)}d.db="utm_campaign";d.eb="utm_content";d.fb="utm_id";d.gb="utm_medium";d.hb="utm_nooverride";d.ib="utm_source";
d.jb="utm_term";d.kb="gclid";d.pa=0;d.I=0;d.wb="15768000";d.Tb="1800";d.ea=[];d.ga=[];d.Ic="cse";d.Gb="q";d.ab="google";
d.fa=[c(d.ab,d.Gb),c("yahoo","p"),c("msn","q"),c("aol","query"),c("aol","encquery"),c("lycos","query"),c("ask","q"),c("altavista","q"),c
("netscape","query"),c("cnn","query"),c("looksmart","qt"),c("about", 
"terms"),c("mamma","query"),c("alltheweb","q"),c("gigablast","q"),c("voila","rdata"),c("virgilio","qs"),c("live","q"),c("baidu","wd"),c("
alice","qs"),c("yandex","text"),c("najdi","q"),c("aol","q"),c("club-
internet","query"),c("mama","query"),c("seznam","q"),c("search","q"),c("wp","szukaj"),c("onet","qt"),c("netsprint","q"),c("google.inte
ria","q"),c("szukacz","q"),c("yam","k"),c("pchome","q"),c("kvasir","searchExpr"),c("sesam","q"),c("ozu","q"),c("terra","query"),c("nost
rum","query"),c("mynet","q"), 
c("ekolay","q"),c("search.ilse","search_for")];d.B=undefined;d.Kb=false;d.p="/";d.ha=100;d.Da="/__utm.gif";d.ta=1;d.ua=1;d.G="
|";d.sa=1;d.qa=1;d.pb=1;d.g="auto";d.D=1;d.Ga=1000;d.Yc=10;d.nc=10;d.Zc=0.2};_gat.Y=function(d,a){var 
c,g,o,k,m,q,r,f=this,p=_gat,w=p.q,x=p.c,i,z=a;f.a=d;function A(h){var b=h instanceof Array?h.join("."):"";return 
w(b)?"-":b}function B(h,b){var e=[],j;if(!w(h)){e=p.z(h,".");if(b)for(j=0;j<e[x];j++)if(!p.Ea(e[j]))e[j]="-"}return e}function n()
{return u(63072000000)}function u(h){var b=new Date,e=new Date(b.getTime()+h);return"expires="+e.toGMTString()+"; 
"}function l(h,b){f.a[p.m]=h+"; path="+z.p+"; "+b+f.Cc()}function s(h,b,e){var j=f.V,t,v;for(t=0;t<j[x];t++){v=j[t][0]; v+=w(b)? 
http://www.google-analytics.com/ga.js
AJAX Libraries API 
• jQuery
• prototype
• script.acu
lo.us
• MooTools
• dojo
• cached
http://code.google.com/apis/ajaxlibs/
Ebay pulling ads from a Yahoo server
Profiling
“Career Watcher”
Tacoda, The Home of Behavioral Targeting, http://www.tacoda.com/
“Active Gamer”
• Google hackers
• Security 
researchers
• Political activists
• Company XXX 
employee
• Corporate leaders
• Law enforcement 
officer
• Government 
official
Data Mining
http://xkcd.com/369/
Countermeasures
•
Patching Users
– Raised Awareness
– Know What You are Disclosing
– Usable Security
– ...
•
Technical Countermeasures
– Cookie Managers
– Content Filtering
– Self-monitoring
– Search Term Chaffing
– Encryption
– Anonymizing Proxies
– Tor
– NAT Firewalls
– ...
•
Policy Countermeasure
– Petition Law and Policy Makers
– Support EFF and other Privacy Organizations
– ...
TrackMeNot
TorCheck
Tor Button
Chained Proxies
Threat Spectrum
Likely
Less Likely
Data Spills
Government
collaboration
User 
profiling
Targeted 
advertising
Third-party
sharing
User 
fingerprinting
Cross-site 
tracking
Redirect to 
malicious 
sites
Search result
ranking 
manipulation
DNS
Redirection
Service eliminated
Future Countermeasures
• Plug-in that 
monitors 
information 
disclosures
• Plug-in that 
displays third-
party contacts
– at least serve 
as a history 
function for the 
status bar
Conclusions
• what online companies posses vs. 
what they share are two entirely 
different things
– blurring streetview
– blurring google maps
– internal search logs vs. public interface
Acknowledgements
• 3efd09cddc148ee790d17e35ae323852
• Kulsoom Abdullah
• Ed Sobiesk
• New Security Paradigms Workshop
• Symposium on Usable Privacy and 
Security
Questions?