c. 请检查网络拓扑振荡的原因并修复。查看告警是否消除。如果告警未消除，
则请执行步骤2。
d. 在MSTP进程视图下执行命令stp tc-protection threshold threshold，重新设置
MSTP进程处理TC类型BPDU报文的数量。查看告警是否消除。如果告警未消
除，则请执行步骤5。
e. 请确认是否存在恶意攻击。
n 如果存在恶意攻击，则请执行步骤6。
n 如果不存在恶意攻击，则请执行步骤7。
f. 请找出攻击源并进行排除，查看告警是否消除。如果告警未消除，则请执行
步骤7。
g. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 550
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
37.12 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.17
hwMstpProRootChanged
Trap Buffer 信息解释
The root bridge of MSTP process changed. (ProcessID=[ProcessID],
InstanceID=[InstanceID], PortID=[PortID])
MSTP进程的根桥发生变化。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Warning
Mnemonic Code hwMstpProRootChanged
Trap OID 1.3.6.1.4.1.2011.5.25.42.4.2.17
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID 端口ID。
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpProID;hwMstpInsta hwMstpProInstanceRootPor
28.1.5 nceID t
文档版本 06 (2017-09-12) 华为专有和保密信息 551
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
对系统的影响
如果不是核心节点被选举为根桥，会影响整个网络的性能。
可能原因
原因1：A new device was added, which had the optimal bridge ID.（新加入了设备，该设
备的桥ID最优。）
原因2：The priorities of the devices or the domain configuration in the current network were
modified.（修改了原有网络中设备的优先级或域配置。）
处理步骤
l 原因1：A new device was added, which had the optimal bridge ID.
a. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤2。
n 如果不是需要的物理链路，则请执行步骤3。
b. 在新加入的设备上，执行命令display stp [ process process-id ] [ instance
instance-id ] [ interface interface-type interface-number | slot slot-id ] [ brief ]查看
桥ID是否为整个网络最优。
n 如果是整个网络最优，则请执行步骤3。
n 如果不是整个网络最优，则请执行步骤5。
c. 请确认新加入设备的桥ID是否应该规划为整网中最优ID。
n 如果应该规划为整网中最优ID，则无需处理。
n 如果不应该规划为整网中最优ID，则请执行步骤4。
d. 请按照网络拓扑正确配置，查看告警是否消除。如果告警未消除，则请执行
步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因2：The priorities of the devices or the domain configuration in the current network
were modified.
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看该实例的优先级向量或者域配置
的更改是否是正常操作。如果不是正常操作，则请执行步骤2。
b. 请按照网络拓扑正确配置，查看告警是否消除。如果告警未消除，则请执行
步骤3。
c. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
37.13 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.18
hwMstpProNewPortStateForwarding
Trap Buffer 信息解释
The MSTP process's port has been set to forwarding state. (ProcessID=[ProcessID],
InstanceID=[InstanceID], PortID1=[PortID1], PortID2=[PortID2], PortID3=[PortID3],
文档版本 06 (2017-09-12) 华为专有和保密信息 552
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
PortID4=[PortID4], PortIDFlag=[PortIDFlag], PortState=[PortState], IfIndex=[IfIndex],
PortName=[PortName], PwName=[PwName])
MSTP进程的端口进入转发状态。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Warning
Mnemonic Code hwMstpProNewPortStateForwarding
Trap OID 1.3.6.1.4.1.2011.5.25.42.4.2.18
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 MSTP进程内端口ID1。
PortID2 MSTP进程内端口ID2。
PortID3 MSTP进程内端口ID3。
PortID4 MSTP进程内端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
PwName PW名称。
文档版本 06 (2017-09-12) 华为专有和保密信息 553
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpProNewPortState hwMstpProNewPortState
29.1.1
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpPwName hwMstpPwName
33
1.3.6.1.2.1.31.1.1.1.1 ifName ifName
对系统的影响
网络拓扑发生变化。
可能原因
原因1：The network topology changes.（网络拓扑发生变化。）
处理步骤
l 原因1：The network topology changes.
a. 请查看网络拓扑中的物理设备，是否有启用生成树协议的新的物理链路加
入。
n 如果有启用生成树协议的新的物理链路加入，则请执行步骤2。
n 如果没有启用生成树协议的新的物理链路加入，则请执行步骤3。
b. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤3。
n 如果不是需要的物理链路，则请执行步骤4。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number | slot slot-id ] [ brief ]查看各个端口是否符合协
议计算结果。
n 如果各个端口符合协议计算结果，则无需处理。
n 如果各个端口不符合协议计算结果，则请执行步骤5。
d. 请正确部署网络拓扑，查看告警是否消除。如果告警未消除，请执行步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
37.14 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.19
hwMstpProNewPortStateDiscarding
Trap Buffer 信息解释
The MSTP process's port has been set to discarding state. (ProcessID=[ProcessID],
InstanceID=[InstanceID], PortID1=[PortID1], PortID2=[PortID2], PortID3=[PortID3],
文档版本 06 (2017-09-12) 华为专有和保密信息 554
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
PortID4=[PortID4], PortIDFlag=[PortIDFlag], PortState=[PortState], IfIndex=[IfIndex],
PortName=[PortName], PwName=[PwName])
MSTP进程的端口进入阻塞状态。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Warning
Mnemonic Code hwMstpProNewPortStateDiscarding
Trap OID 1.3.6.1.4.1.2011.5.25.42.4.2.19
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 MSTP进程内端口ID1。
PortID2 MSTP进程内端口ID2。
PortID3 MSTP进程内端口ID3。
PortID4 MSTP进程内端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
PwName PW名称。
文档版本 06 (2017-09-12) 华为专有和保密信息 555
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpProNewPortState hwMstpProNewPortState
29.1.1
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpPwName hwMstpPwName
33
1.3.6.1.2.1.31.1.1.1.1 ifName ifName
对系统的影响
网络拓扑发生变化。
可能原因
原因1：The network topology changes.（网络拓扑发生变化。）
处理步骤
l 原因1：The network topology changes.
a. 请查看网络拓扑中的物理设备，是否有启用生成树协议的新的物理链路加
入。
n 如果有启用生成树协议的新的物理链路加入，则请执行步骤2。
n 如果没有启用生成树协议的新的物理链路加入，则请执行步骤3。
b. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤3。
n 如果不是需要的物理链路，则请执行步骤4。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number | slot slot-id ] [ brief ]查看各个端口是否符合协
议计算结果。
n 如果各个端口符合协议计算结果，则无需处理。
n 如果各个端口不符合协议计算结果，则请执行步骤5。
d. 请正确部署网络拓扑，查看告警是否消除。如果告警未消除，请执行步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
37.15 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.20
hwMstpProNewBridgeLostRootPrimary
Trap Buffer 信息解释
MSTP process is no longer the root bridge of the instance.
(ProcessID=[ProcessID],InstanceID=[InstanceID],proInstRootType=[proInstRootType])
文档版本 06 (2017-09-12) 华为专有和保密信息 556
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
本桥不再是实例的根桥。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Warning
Mnemonic Code hwMstpProNewBridgeLostRootPrimary
Trap OID 1.3.6.1.4.1.2011.5.25.42.4.2.20
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
proInstRootType 根类型。
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpProID;hwMstpInsta hwMstpProInstanceRootTyp
28.1.6 nceID; e
对系统的影响
网络实际拓扑可能与组网预期不一致。
可能原因
原因1：A new link was added to the network topology, and the network topology changed.
（网络拓扑发生变化，有新的链路加入。）
原因2：The priorities of some switches changed in the network.（网络拓扑有设备优先级
发生变化。）
文档版本 06 (2017-09-12) 华为专有和保密信息 557
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
处理步骤
l 原因1：A new link was added to the network topology, and the network topology
changed.
a. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是需要的物理链路，则请执行步骤2。
n 如果是不需要的物理链路，则请执行步骤3。
b. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number | slot slot-id ] [ brief ]查看各个端口是否符合协
议计算结果。
n 如果符合协议计算结果，则无需处理。
n 如果不符合协议计算结果，则请执行步骤4。
c. 请正确部署网络拓扑，查看告警是否消除。如果未消除，请执行步骤4。
d. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因2：The priorities of some switches changed in the network.
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]检查网络拓扑中优先级更改操作是否
是正常操作。
n 如果是正常操作，则无需处理。
n 如果是非正常操作，则请执行步骤2。
b. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实