To begin, we looked at the size of transactions; i.e., the num-
ber of bitcoins sent in a transaction. Figure 2 depicts the chang-
ing percentage of various transaction sizes over time. Not surpris-
ingly, until approximately April 2010 — the ﬁrst 15 months that
Bitcoin was deployed — almost all transactions involved exactly 50
bitcoins (the initial reward for mining a block), and indeed these
transactions became a minority of all transactions only in January
2011. This activity reﬂects the adoption phase of Bitcoin, in which
most blocks contained the coin generation transaction and nothing
more.
(In later phases, the mining reward is likely a little more
than 50 because it includes miner fees, which is why we created a
separate bin for values between 50 and 55.) We also see a second
turning point in early 2012, in which the percentage of transactions
carrying less than a single bitcoin in total value doubled abruptly
(from 20% to 40%), while the percentage of transactions carrying
less than 0.1 BTC tripled.
We also observed how quickly bitcoins were spent; i.e., once
they were received, how long did it take the recipient to spend
them? Figure 3 shows breakdowns both in terms of public keys
(how many recipient public keys spent their contents in a certain
time window) and in terms of value (how many of the bitcoins that
were received were spent in a certain time window).
Looking at this ﬁgure, we again see two clear turning points. The
ﬁrst, in early 2011, represents a point at which users began mean-
ingfully spending bitcoins, rather than just “hoarding” them; in
fact, from this point on a negligible fraction of bitcoins are hoarded.
Nevertheless, these early hoarders in fact took most of the bitcoins
out of circulation; as observed by Ron and Shamir [18], a signiﬁ-
cant majority of all bitcoins are in these “sink” addresses that have
to date never spent their contents (at the time they parsed the block
chain it was 75%, whereas we observed it to be 64%), meaning
only 4 million bitcoins are currently in circulation. Nevertheless,
these remaining coins are circulating quite actively, as seen in the
second turning point in Figure 3: in April 2012, the percentage of
bitcoins being spent immediately (i.e., in the same block in which
DateAverage percentage of transactions per block0204060801002009−01−092010−02−212011−04−062012−05−19>= 500>= 55 and  50 and = 1 and  0.1 and < 1<= 0.1Figure 3: The trend, over time and averaged weekly, of how long public keys hold on to the bitcoins received. The plot on the left shows the
percentage over all public keys, and the plot on the right shows the percentage over all value transacted. The values run bottom to top, from
longest to spend (unspent as of now) to shortest to spend (spent within the same block).
they were received) doubled, and more generally half of all bitcoins
are now spent within an hour of being received and 80% of bitcoins
are spent within a day.
As it turns out, and as we see in Section 5.1, both these recent
trends of smaller transactions and faster spending can be largely at-
tributed to a single service: the gambling site Satoshi Dice. Thus,
even a longitudinal study of the Bitcoin network already makes
clear the effect that services have on current Bitcoin usage.
3. DATA COLLECTION
To identify public keys belonging to the types of services men-
tioned in Section 2.2, we sought to “tag” as many addresses as pos-
sible; i.e., label an address as being deﬁnitively controlled by some
known real-world user (e.g., Mt. Gox or Instawallet). As we will
see in Section 4.3, by clustering addresses based on evidence of
shared control, we can bootstrap off the minimal ground truth data
this provides to tag entire clusters of addresses as also belonging to
that user.
Our predominant method for tagging users was simply transact-
ing with them (e.g., depositing into and withdrawing bitcoins from
Mt. Gox) and then observing the addresses they used; additionally,
we collected known (or assumed) addresses that we found in var-
ious forums and other Web sites, although we regarded this latter
kind of tagging as less reliable than our own observed data.
3.1 From our own transactions
We engaged in 344 transactions with a wide variety of services,
listed in Table 1, including mining pools, wallet services, bank ex-
changes, non-bank exchanges, vendors, gambling sites, and mis-
cellaneous services.
Mining pools. We attempted to mine with each of the major
mining pools (a pie chart depicting the relative productivity of min-
ing pools can be found at blockorigin.pfoe.be/chart.
php). To do this, we used an AMD Radeon HD 7970, capable
of approximately 530 million SHA-256 computations per second;
this effort allowed us to trigger a payout of at least 0.1 BTC (often
the minimum payout for pools) with 11 different pools, anywhere
from 1 to 25 times. For each payout transaction, we then labeled
the input public keys as belonging to the pool. One of these pools,
Eligius, split the coin among the miners immediately upon being
mined, and we were thus unable to tag any of their public keys
using this method.
Wallets. We kept money with most of the major wallet services
(10 in total), and made multiple deposit and withdrawal transac-
tions for each. Three of these services — My Wallet, Easycoin, and
Strongcoin — kept the funds of their users separate, which meant
we were unable to link many addresses together for them.
Bank exchanges. Most of the real-time trading exchanges (i.e.,
in which the exchange rate is not ﬁxed) also function as banks.
As such, we tagged these services just as we did the wallets: by
depositing into and withdrawing from our accounts (but rarely par-
ticipating in any actual currency exchange). We kept accounts with
18 such exchanges in total.
Non-bank exchanges.
In contrast, most of the ﬁxed-rate ex-
changes did not function as banks, and are instead intended for
one-time conversions. We therefore were able to participate in
fewer transactions with these exchanges, although we again tried
to transact with most of the major ones at least once (8 in total).
Vendors. We purchased goods, both physical and digital, from a
wide variety of vendors. Some of the vendors, such as Bitmit and
CoinDL, function more as marketplaces (the “eBay” and “iTunes”
of the Bitcoin economy, respectively), while others were individual
merchants. Although we purchased from Etsy, they do not provide
a Bitcoin payment interface and we instead negotiated individually
with the merchant. Many of the vendors we interacted with did
not use an independent method for accepting bitcoins, but relied
instead on the BitPay payment gateway (and one used WalletBit as
a payment gateway). We also kept a wallet with Silk Road, which
allowed us to tag their public keys without making any purchases.
Figure 4 depicts all of our physical purchases.
Gambling. We kept accounts with ﬁve poker sites, and trans-
acted with eight sites offering mini-games and/or lotteries. Many
of the dice games (Satoshi Dice, BTC Dice, etc.) advertised their
public keys, so we did fewer transactions with these services.
Miscellaneous. Four of the additional services we interacted
with were mix or laundry services: when provided with an output
address, they promised to send to that address coins that had no as-
sociation with the ones sent to them; the more sophisticated ones
offered to spread the coins out over various transactions and over
time. One of these, BitMix, simply stole our money, while Bitcoin
Laundry twice sent us our own coins back, indicating we were pos-
sibly their only customer at that time. We also interacted with Bit
Visitor, a site that paid users to visit certain sites; Bitcoin Adver-
tisers, which provided online advertising; CoinAd, which gave out
free bitcoins; Coinapult, which forwarded bitcoins to an email ad-
DateAverage percentage of incoming value020406080100(cid:21)(cid:19)(cid:19)(cid:28)(cid:239)(cid:19)(cid:20)(cid:239)(cid:19)(cid:28)(cid:21)(cid:19)(cid:20)(cid:19)(cid:239)(cid:19)(cid:21)(cid:239)(cid:21)(cid:20)(cid:21)(cid:19)(cid:20)(cid:20)(cid:239)(cid:19)(cid:23)(cid:239)(cid:19)(cid:25)(cid:21)(cid:19)(cid:20)(cid:21)(cid:239)(cid:19)(cid:24)(cid:239)(cid:20)(cid:28)DateAverage percentage of incoming transactions020406080100(cid:21)(cid:19)(cid:19)(cid:28)(cid:239)(cid:19)(cid:20)(cid:239)(cid:19)(cid:28)(cid:21)(cid:19)(cid:20)(cid:19)(cid:239)(cid:19)(cid:21)(cid:239)(cid:21)(cid:20)(cid:21)(cid:19)(cid:20)(cid:20)(cid:239)(cid:19)(cid:23)(cid:239)(cid:19)(cid:25)(cid:21)(cid:19)(cid:20)(cid:21)(cid:239)(cid:19)(cid:24)(cid:239)(cid:20)(cid:28)immediatelywithin 1 hour(cid:20)(cid:239)(cid:21)(cid:23)(cid:3)(cid:75)(cid:82)(cid:88)(cid:85)(cid:86)(cid:20)(cid:239)(cid:26)(cid:3)(cid:71)ays(cid:20)(cid:239)(cid:23)(cid:3)weeks(cid:20)(cid:239)(cid:20)(cid:21)(cid:3)(cid:80)(cid:82)(cid:81)(cid:87)(cid:75)(cid:86)(cid:20)(cid:239)(cid:23)(cid:3)yearsunspentAurum Xchange
BitInstant
Bitcoin Nordic
BTC Quick
BTC-e
CampBX
CA VirtEx
ICBit
Mercado Bitcoin FastCash4Bitcoins
Mt Gox
The Rock
Vircurex
Virwox
Lilion Transfer
Nanaimo Gold
OKPay
Easywallet
Flexcoin
Instawallet
Paytunia
BTC Guild
Deepbit
EclipseMC
Eligius
Mining
50 BTC
ABC Pool
Bitclockers
Bitminter
Wallets
Bitcoin Faucet
My Wallet
Coinbase
Easycoin
Exchanges
Bitcoin 24
Bitcoin Central
Bitcoin.de
Bitcurex
Bitﬂoor
Bitmarket
Bitme
Bitstamp
BTC China
Vendors
ABU Games
Bitbrew
Bitdomain
Bitmit
Bitpay
Bit Usenet
Gambling
BitZino
Bit Elﬁn
BTC Grifﬁn
Bitcoin 24/7
Bitcoin Darts
BTC Lucky
Bitcoin Kamikaze BTC on Tilt
Bitcoin Mineﬁeld Clone Dice
Miscellaneous
Bit Visitor
Bitcoin Advertisers Bitlaundry
Bitcoin Laundry
BTC Buy
BTC Gadgets
Casascius
Coinabul
CoinDL
Etsy
Itzod
Ozcoin
Slush
Strongcoin
WalletBit
HealthRX
JJ Games
NZBs R Us
Silk Road
WalletBit
Yoku
Gold Game Land
Satoshi Dice
Seals with Clubs
CoinAd
Coinapult
Wikileaks
Figure 4: The physical items we purchased with bitcoins, including
silver quarters from Coinabul, coffee from Bitcoin Coffee, and a
used Boston CD from Bitmit. The items in green were purchased
from CoinDL; in blue from Bitmit; and in red using the payment
gateway BitPay.
4. ACCOUNT CLUSTERING HEURISTICS
In this section, we present two heuristics for linking addresses
controlled by the same user, with the goal of collapsing the many
public keys seen in the block chain into larger entities. The ﬁrst
heuristic, in which we treat different public keys used as inputs
to a transaction as being controlled by the same user, has already
been used and explored in previous work, and exploits an inherent
property of the Bitcoin protocol. The second is new and based
on so-called change addresses; in contrast to the ﬁrst, it exploits a
current idiom of use in the Bitcoin network rather than an inherent
property. As such, it is less robust in the face of changing patterns
within the network, but — as we especially see in Section 5.2 —
it provides insight into the current Bitcoin network that the ﬁrst
heuristic does not.
4.1 Deﬁning account control
Before we present our heuristics, we clarify what the results of
our clustering algorithms imply; in particular, we must deﬁne what
we mean by address control. Put simply, we say that the controller
of an address is the entity (or in exceptional cases multiple entities)
that is expected to participate in transactions involving that address.
While this requirement implies a priori that the controller of an ad-
dress knows the corresponding private key (recall that transactions
are signatures, and thus knowledge of the signing key is necessary
to form a valid transaction), knowledge of the private key is not a
sufﬁcient requirement for control. Consider, for example, buying
physical bitcoins from a vendor such as Casascius. To form the
physical bitcoin to send to you, Casascius must know the private
key. Then, once you receive the bitcoin, you also learn the private
key. Finally, if you redeem this private key with a service such as
Mt. Gox, that service also learns the private key. In such a case,
control deﬁned solely by knowledge of the secret key is therefore
not well deﬁned.
In the above case, however, the controller of the address is in
fact quite clear: as you redeemed the private key with Mt. Gox
Bitfog
BitMix
Table 1: The various services we interacted with, grouped by (ap-
proximate) type.
dress, where they could then be redeemed; and ﬁnally, Wikileaks,
with whom we donated to both their public donation address and
two one-time addresses generated for us via their IRC channel.
3.2 From other sources
In addition to our own transactions, many users publicly claim
their own addresses; e.g., charities providing donation addresses,
or LulzSec claiming their address on Twitter. While we did not
attempt to collect all such instances, many of these tags are conve-
niently collected at blockchain.info/tags, including both
addresses provided in users’ signatures for Bitcoin forums, as well
as self-submitted tags. We collected all of these tags — over 5,000
in total — keeping in mind that the ones that were not self-submitted
(and even the ones that were) could be regarded as less reliable than
the ones we collected ourselves.
Finally, we searched through the Bitcoin forums (in particular,
bitcointalk.org) looking for addresses associated with ma-
jor thefts, or now-defunct services such as Tradehill and GLBSE.
Again, these sources are less reliable, so we consequently labeled
users only for addresses for which we could gain some conﬁdence
through manual due diligence.
and thus stored any bitcoins inside with them, the expected entity
responsible for forming transactions on behalf of that address is
Mt. Gox (otherwise, if you plan to form your own transactions,
why store your money with them?).
Finally, we emphasize that our deﬁnition of address control is
quite different from account ownership; for example, we consider
a wallet service such as Instawallet to be the controller of each of
the addresses it generates, even though the funds in these addresses
are owned by a wide variety of distinct users.
4.2 Graph structure and deﬁnitions
To deﬁne our heuristics formally, we consider two important di-
rected graph structures for the Bitcoin network: a transaction graph
and a public key graph. In the former, vertices represent transac-
tions, and a directed edge from a transaction t1 to a transaction t2
indicates that an output of t1 was used as an input in t2. Using this
graph, we deﬁne in degrees and out degrees for transactions, which
correspond exactly to the in and out degrees in the graph (i.e., the
number of edges incident to and from the node, respectively).
DEFINITION 4.1. The in degree for a transaction t, denoted by