.
b
e
w
m
o
c
.
q
q
p
j
.
o
c
.
o
o
h
a
y
m
o
c
.
r
e
v
a
n
t
i
.
o
r
e
b
i
l
u
r
.
x
e
d
n
a
y
m
o
c
.
3
6
1
m
o
c
.
c
w
t
t
e
n
.
m
u
a
d
t
e
n
.
x
o
c
t
e
n
.
t
t
a
l
p
.
p
w
t
e
n
.
l
l
e
b
c
a
p
m
o
c
.
u
h
o
s
C (cid:32) % (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
h % ? % % % % (cid:35) % (cid:35) % (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) % (cid:35) (cid:35)(cid:35) % (cid:35) (cid:35)
g (cid:32) ? (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
y (cid:32) ? (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) -
a (cid:32) ? (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
g (cid:32) ? (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) - (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
m (cid:32) ? (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
y (cid:32) ? (cid:32) (cid:32) % % (cid:35) (cid:32) (cid:35) % (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) % (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
c % ? % % % % (cid:35) % (cid:35) % (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) % (cid:35) (cid:35)(cid:35) % (cid:35) -
w (cid:32) ? (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) - (cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
q % ? % % % % (cid:35) % (cid:35) % (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) % (cid:35) (cid:35)(cid:35) % (cid:35) (cid:35)
y (cid:35) ? (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) - (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:35)
n (cid:32) ? % (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
1 (cid:35) ? % (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:35)
t (cid:35) ? (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:35) - (cid:35)(cid:35) (cid:35) (cid:35) (cid:35)
l (cid:35) ? (cid:35) (cid:35) - (cid:35) (cid:35) (cid:35) - (cid:35) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:35) - (cid:35)(cid:35) (cid:35) (cid:35) (cid:35)
y (cid:32) ? (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
d (cid:35) ? (cid:35) (cid:35) - (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) - (cid:35) (cid:35) (cid:35)
c (cid:35) ? (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:35)
a (cid:32) ? (cid:32) % (cid:32) % (cid:35) (cid:32) (cid:35) % (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) % (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
w (cid:32) ? (cid:32) % (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) - (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
p (cid:32) ? (cid:32) % (cid:32) (cid:32) (cid:35) % (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)(cid:35) (cid:32) (cid:35) (cid:35)
s (cid:35) - (cid:35) -
- (cid:35) (cid:35) - (cid:35) (cid:35) (cid:35) (cid:35) - (cid:35) - (cid:35) - (cid:35)
- (cid:35) (cid:35) -
-
Table 6: Pairwise behavior of top mail providers. Each row is labeled with the ﬁrst
character of the provider’s name. (cid:32) indicates TLS support, % indicates TLS support
was added within the past year, (cid:35) indicates that the message was sent with no TLS
whatsoever, ? means that the MTA link did not record any information about the pro-
tocol or use of TLS, and - means that the message did not go through.
Incoming MTA Server Certiﬁcates
The top 10 providers cover 70% of the users in the leaked Adobe
user list. Given that all of the top 10 providers supported TLS at the
incoming MTA, it is worth recasting the above numbers in terms
of users. When weighted by the number of users, TLS support in-
creased from 52% of users (top 1 million domains only) in 2014 to
89% in 2015, a substantial improvement largely due to Hotmail’s
adoption TLS at incoming MTAs.
5.3.5
Of the 10 select providers that used TLS, the incoming MTAs of
3 used mismatched but otherwise valid certiﬁcates. Beyond these
providers, however, the certiﬁcates produced by the incoming MTAs
ranged wildly in quality. Table 5 summarizes our ﬁndings. We are
pleased to see that in the past year the percentage of valid certiﬁ-
cates has risen, and self signed, expired and revoked certiﬁcates has
fallen. Certiﬁcates that did not match the hostname of the incoming
MTA did rise, which we attribute to the overall increase in TLS use,
and the reduction of otherwise invalid certiﬁcates that would have
previously been in another category.
5.3.6 Pairwise TLS Support
The premise of our large-scale analysis is that knowing outgo-
ing and incoming MTA behavior allows us to infer how the two
would behave talking to each other. To validate this, we sent email
between the 22 select providers. Table 6 shows the results of this
experiment. Each element of the table shows whether TLS was
C
C
E
R
S
A
S
M
N
D
D
Implementation DNS Lookup Enforcement
C
R
A
M
D
C
R
A
M
D
M
K
D
M
K
D
M
K
D
F
P
S
F
P
S
F
P
S
I
I
I
Domain
hotmail.com
gmail.com
yahoo.com
aol.com
gmx.de
mail.ru
yahoo.co.in
comcast.net
web.de
qq.com
yahoo.co.jp
naver.com
163.com
twc.com
libero.it
yandex.ru
daum.net
cox.net
att.net
wp.pl
pacbell.net
sohu.com
Table 7: DNS mechanism conﬁguration and behavior of the top mail providers. Im-
plementation indicates whether the provider has the correct DNS records for verifying
messages they send. DNS Lookup shows whether the provider queried our DNS server
for the selector for each feature when sending mail. Enforcement indicates whether the
provider takes any action when receiving a message from a host that SPF forbids, an
invalid DKIM signature, or rejecting DMARC records.
indicates support,
the provider took action on mail sent from a host not listed in the SPF record.
indicates a strict DKIM policy of “reject” and
indicates no support,
indicates that
used on the inter-provider hop, based on Received header data.
For example, a message from GMail to Hotmail was transferred
from GMail to Hotmail over a TLS-secured session, represented by
the % mark in the ﬁrst row labeled g (for gmail.com) and column
labeled hotmail.com.
A number of entries are absent (shown as “-”). These cases oc-
curred when we could not send a message from one provider to
another. We had particular trouble sending getting email from our
sohu.com account accepted. It turned out that the sohu.com SMTP
submission servers did not require a user to authenticate, allow-
ing spammers to use their SMTP MSA as an open proxy. Entries
marked “?” are cases where Received header analysis did not pro-
vide a conclusive indication one way or another. This happened
with one provider, Hotmail, which used a protocol of SMTPSVC,
that was used for both TLS and non-TLS connections.
Several abnormalities were observed in the 2014 measurement
where both the sending provider and the receiving provider sup-
ported TLS but TLS was not used. For example yahoo.co.in
sending to aol.com. We are unable to observe the connection be-
tween the two providers to know what caused this behavior, but it
is possible that the two providers where using incompatible TLS
ciphers, or where misconﬁgured. However all were resolved when
performing the 2015 measurement.
There was only one abnormal result observed in the 2015 study.
A message from 163.com was transferred to gmail.com using
TLS, even though the 163.com outgoing MTA did not issue the
STARTTLS command when send mail to our server.
5.4 SPF and DKIM
A scan of the Alexa and Adobe top million domains shows us
that just over 40% have a valid SPF record, which covers 85.02%
458Metric
DNSSEC
Valid
Invalid
DMARC
None
Quarantine
Reject
SPF
Alexa Hosts
3.40%
2.96%
0.44%
0.97%
0.73%
0.08%
0.16%
42.26%
Adobe Hosts
2.75%
2.12%
0.63%
0.90%
0.66%
0.06%
0.18%
43.60%
Adobe Users
4.92%
1.35%
3.57%
67.81%
51.29%