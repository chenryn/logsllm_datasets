Understanding the Web browser threat:
Examination of vulnerable online Web browser
populations and the "insecurity iceberg"
Stefan Frei1, Thomas Duebendorfer2, Gunter Ollmann3, Martin May1
1 Communication Systems Group, ETH Zurich, Switzerland
2 Google Switzerland GmbH
3 IBM Internet Security Systems, USA
Contact: PI:EMAIL
http://www.techzoom.net/insecurity-iceberg
ETH Zurich Tech Report Nr. 288
1.
INTRODUCTION
In recent years the Web browser has increasingly become
targeted as an infection vector for vulnerable hosts. Classic
service-centric vulnerability exploitation required attackers to
scan for and remotely connect to vulnerable hosts (typically
servers) in order to exploit them. Unlike these, Web browser
vulnerabilities are commonly exploited when the user of the
vulnerable host visits a malicious Web site.
Attacks against Web browsers depend upon malicious con-
tent being rendered by the appropriate built-in interpreter (e.g.,
HTML, JavaScript, CSS, etc.) or vulnerable plug-in technol-
ogy (e.g., Flash, QuickTime, Java, etc.) [1, 2]. Vulnerabilities
lying within these rendering technologies are then exposed to
any exploit techniques or malicious code developed by the at-
tacker. Vulnerability trend reports have indicated that remotely
exploitable vulnerabilities have been increasing since the year
2000 and reached 89.4% of vulnerabilities reported in 2007
[3]. A growing percentage of these remotely exploitable vul-
nerabilities are associated with Web browsers.
Proﬁt motivated cyber-criminals have rapidly adopted Web
browser exploitation as a key vector for malware installation.
Due to the methodology of exploiting Web browser vulner-
abilities and the unpredictable browsing patterns of typical
users, for widespread infection of vulnerable hosts the crim-
inals must seed a mix of popular and high-trafﬁc websites, or
incentivize users through email spam, with URLs directing po-
tential victims to Web servers hosting their malicious content.
The former method is commonly known as drive-by down-
load, where ”drive-by” refers to the fact that Web browsers
must initially navigate to a malicious page and ”download”
refers to the covertly downloaded and executed malware - typ-
ically trojans.
As popularity of this attack vector has blossomed, there have
been frequent reports of hundreds of thousands of Web sites
succumbing to mass-defacement [1, 4, 5, 6, 7, 8] - where the
”defacement” often consists of an embedded iframe. These
iframes typically inlcude content from servers hosting mali-
cious JavaScript code designed to exploit vulnerabilities ac-
cessible through the user’s Web browser and subsequently to
initiate a drive-by malware download. These mass-defacements
Internet
users
at risk due to
not updating to
most secure  Web 
browser and plug-ins
not latest most 
secure browsers
browsers with built-in or 
plug-in vulnerabilities
Opera 5 million
Safari 17 million
Firefox 38 million
Estimated:
Internet 
Explorer
 577 million
Figure 1: The Web browser Insecurity Iceberg represents
the number of Internet users at risk because they don’t use
the latest most secure Web browsers and plug-ins to surf
the Web. This paper has quantiﬁed the visible portion of
the Insecurity Iceberg (above the waterline) using passive
evaluation techniques - which amounted to more than 600
million users at risk not running the latest most secure Web
browser version in June 2008.
cause once-benign sites to turn against their visitors. Even
pages owned by institutions like the United Nations (un.org),
the UK government (.gov.uk) and many others have succumbed
to such attacks. In 2007, Google uncovered more than three
million malicious Web addresses (URLs) that initiate drive-by
downloads [9].
While several studies and reports have focused upon the scale
of the mass-defacements and malicious content being served
by compromised servers, none have provided quantitative ana-
lysis of the most critical component in drive-by download at-
tacks - the number of users likely to become victims of the
attack due to the use of insecure Web browser technologies.
The analysis presented in this paper is based on the large
global user base of Google’s Web search and application sites.
By measuring the lower bounds of insecure Web browsers
used to daily surf the Internet, we provide new insights into
the global vulnerable Web browser problem. To capture the
extent of this security problem, we introduce the notion of the
"Insecurity Iceberg" (see Figure 1) and estimate the number
of users worldwide relying on a Web browser version differ-
ent from the latest most secure version or vulnerable plug-ins,
which could result in a host compromise.
Following this detailed analysis, we identify and discuss a
number of current and future protection technologies that can
help mitigate the escalating threat to vulnerable Web browsers.
2.
DATA SOURCES AND METHODOL-
OGY
As with all studies of Internet threats and trends, the analysis
and conclusions reached are dependent upon the breadth and
scope of the data. While statistics concerning Web browser
market shares can be found in many locations, we believe the
data sources used for this detailed analysis of vulnerable Web
browsers are unique in both scope, detail and quality.
The data used to measure the worldwide vulnerable Web
browser population within each browser type was provided
by Google, and is a subset of non-personally identiﬁable data
accumulated by Google’s search and Web application server
logs from around the globe; processed daily between January
2007 and June 2008. With Google’s search queries coming
from more than 75% [10, 11] of Internet Web search users,
our measurements of Web browser proliferation are of a truly
global scale.
Our purpose of analysis was to establish the global scale of
Web browser-based insecurity. A critical difference between
our analysis and seemingly related ”browser market share”
studies [12, 13, 14, 15] is the use of both major and minor
version information and the correlation with known security
patch release dates for each Web browser type. Any discrep-
ancies between browser version share numbers can likely be
attributed to sample sizes and degree of global coverage. Key
points in our data sampling and analysis methodology are as
follows:
• With each page request a Web browser typically imparts
information such as its type, version, and operating sys-
tem in the HTTP USER-AGENT header ﬁeld [16] which
is recorded in most common Web server logs. Using
this large data set, we calculated the major version us-
age share within Firefox, Opera, Safari, and Internet Ex-
plorer users for each day.
– Unlike ubiquitous Web browser "market share" statis-
tics, we were not interested in the number of page
hits or visits. Instead, we measured the number of
unique Web browser installations active on a given
day.
• Where applicable, minor version information was ob-
tained from the USER-AGENT data to help enumerate
the speciﬁc patch-level of the Web browser.
– This method of analysis allowed for unbiased mea-
surements of detailed browser patch level at a global
scale, without requiring interaction with the user
and is the ﬁrst global scale measurement of pop-
ular browser patch dynamics.
– The USER-AGENT header ﬁelds for Firefox, Sa-
fari, and Opera contain both major and minor ver-
sion information, whereas Internet Explorer only
contains the major version. Therefore, it was not
possible to enumerate the patch level of Microsoft
Internet Explorer using this method beyond its ma-
jor release numbers.
• Each Web browser was counted only once per host, per
day. The default Google cookie system served as a uni-
queness identiﬁer for the ﬁrst visit of each actively used
browser exactly once per day - and helped reduce over-
counting due to multiple visits.
• For reasons of conciseness, we have taken week-day
statistics as the data-points for graphing and compari-
son purposes.
• We measure the dynamics of major and minor software
version updates and compare results with the mecha-
nisms available to carry out the updates. We correlate
our results with measurements of Secunia’s Personal Soft-
ware Inspector [17] to estimate the global population of
Internet users not using the most recent version of their
browser. Our measurement does not include the addi-
tional risk exposure of unpatched browser plug-ins or
0-day exploits.
• We acknowledge that there are multiple opinions con-
cerning business usage and application compatibility rea-
sons for not upgrading to a current version of a Web
browser technology (in particular applications that have
embedded Internet Explorer objects), but do not believe
that those opinions have a bearing on the methodology
used to establish the insecurity of the global Web browser
problem. While not using the latest version represents a
risk, it may be reduced or mitigated through the use of
complementary security measures.
At no time during this study did the authors of this paper
have any access to personally identiﬁable information. The
data sets analyzed used a unique cookie value (when avail-
able) to merely identify a unique browser visit, and the pro-
vided data could not be used to identify an individual or their
browsing patterns either directly or through correlation.
Google takes privacy of its users very seriously and automa-
tically expires cookies after a limited period of time. For per-
sonalized services like Gmail or Google calendar where state
information is required, cookies are used to keep the log-in
status, but are optional when utilizing Google’s Web search.
3.
THE INSECURITY ICEBERG OF IN-
TERNET USERS AT RISK
3.1
Measurement of Browser Versions in
Daily Use
In the face of a more hostile environment, most commercial
vendors of Web browser technologies have made progress over
recent years in making their products more resilient to com-
mon security threats - dropping insecure features and strength-
ening others. Their development life-cycles have matured and
typically encompass multiple levels of secure design and vul-
nerability testing, as well as new processes for promptly han-
dling externally discovered ﬂaws. As such, most updates and
patches for existing Web browser technologies (both the core
browsing engine and third-party plug-ins) increasingly incor-
porate new and vital security ﬁxes - a trend that is expected to
continue in to the future.
For years the software industry has promoted one security
best practice over all others: always use the most recent ver-
sion of the installed software and instantly apply the latest
patches. With today’s hostile Internet and drive-by download
attack vectors, failure to apply patches promptly or missing
them entirely is a recipe for disaster; exposing the host to in-
fection and possibly subsequent data disclosure or loss.
Analysis of Web browser USER-AGENT information from
the Google data set, combined with a catalogue of known vul-
nerabilities and subsequent security patches associated with a
particular update, enabled us to estimate the lower bound of
the number of Web browsers in use repeatedly failing to apply
patches, many of which ﬁxed built-in browser vulnerabilities.
In mid June 2008, the most commonly encountered browser
technologies used to navigate the Internet were Microsoft’s In-
ternet Explorer (IE) 78%, Mozilla’s Firefox (FF) 16%, Ap-
ple’s Safari (SF) 3%, and Opera (OP) 1% according to The-
Counter.com [15]. The combined usage share of these four
browsers was 98.6%, dominated by Internet Explorer and Fire-
fox as can be seen in Table 1.
Browser Type
IE
FF
SF
OP
Total
Share of browsers
in daily use in per-
cent
78.3 %
16.1%
3.4%
0.8%
98.6%
Browsers in daily
use in million (on
the Internet world-
wide)
1103
227
48
11
1389
Table 1: Percentage of Web browsers by type according to
TheCounter.com averaged over Feb 1st to June 18th, 2008.
The absolute worldwide user counts were derived from the
global Internet user count of 1,408 billion users.
3.2
Most secure browser
In this section, the most secure browser designates the lat-
est ofﬁcial public release of a vendor’s Web browser at a given
date. Beta versions are not considered an ofﬁcial public re-
lease.
We used the most recent major versions of Internet Explorer
7 (IE7), Firefox 2 (FF2), Safari 3 (SF3) and Opera 9 (OP9)
as the benchmark version for our most secure Web browser
measurements. Microsoft’s Internet Explorer version 6, inde-
pendent of its patch level, is not considered the most secure
version of Internet Explorer by Windows expert Brian Liv-
ingston [18] and even Microsoft calls IE7 ”an extremely im-
portant update from a security perspective” over IE6 [19] and
states ”There are dangers that simply didn’t exist back in 2001,
when Internet Explorer 6 was released to the world. Internet
Explorer 7 makes surﬁng the web fundamentally safer by of-
fering greater protection against viruses, spyware, and other
online risks.”.
Table 2 shows the usage share of the latest major browser
version within each type of Web browser (e.g. the share of
IE7 within the IE population). There were 1,408 million Inter-
net users worldwide end of March 2008 [20]. Globally only
59.1% (832 million users), make use of the latest major ver-
sion of their preferred Web browser to navigate the Internet.
This is an estimate for the upper bound for the global share of
the most secure browsers in use. However, 576 million users
surfed the Internet without using the latest major browser ver-
sion of their preferred browser.
Latest
Major
Version
IE7
FF2
SF3
OP9
Total
Release
date
of latest major
version
2006-
10-18
2006-
10-24
2007-
10-26
2006-
06-20
Share of latest
major
version
within browser
type
52.5%
92.2%
70.2%
90.1%
59.1%
Number of lat-
est major ver-
sion in million
(worldwide)
579
209
34
10
832
Table 2: Share of the latest major version within a given
type of browser as seen on Google’s search and application
Web sites in ﬁrst week of June 2008. Absolute counts were
calculated using Table 1.
Analysis of the distribution of patches within the latest major
version is used to measure the share of the most secure version
for each browser type.
For Firefox, Safari and Opera we used the HTTP user-agent
information in the Google’s Web log data sets to determine
the minor version. For Internet Explorer we relied upon the
results of Secunia’s PSI statistics [21] to estimate the share of
the most secure version.
As shown in Figure 3, we discovered that at most 83.3% of
Firefox users, 65.3% of Safari users, 56.1% of Opera users,
and 47.6% of Internet Explorer users were using the latest
most secure browser version on any day between January 2007
to June 2008. For the latest version analysis of Safari, we only
considered the date range Dec 2007 to June 2008, when Safari
version 3 became widespread.
Despite the single-click integrated auto-update functionality
of Firefox, rather surprisingly, 16.7% Firefox users (one out of
six) continue to surf the Web with an outdated version of the
Web browser. Meanwhile, 43.9% of all Opera users surf the
Web with an outdated browser version. In the case of Internet
Explorer, 52.4% of that user population continues to rely upon
superseded versions of the Web browser.
While Table 2 represents the early June 2008 snapshot of the
usage share of the latest major version within each browser
type, Figure 2 depicts how these usage shares have changed
over time as users migrate to the latest major version of their
favorite Web browser between January 2007 to June 2008.
It is noteworthy that it has taken 19 months since the ini-
tial general availability of IE7 (public release October 2006)
to reach 52.5% proliferation amongst users that navigate the
Internet with Microsoft’s Web browser. Meanwhile, 92.2% of
Firefox users have migrated to FF2. The migration between
major versions was found to be generally a slow process, ex-
0
20
40
60