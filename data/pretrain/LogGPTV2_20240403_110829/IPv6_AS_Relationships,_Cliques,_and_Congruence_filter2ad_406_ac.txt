both ASNs for these two organizations to capture their full connectivity during
the period they were shifting all of their neighbors to their primary ASN.
Figure 5 shows the IPv6 clique inferred using the improved clique inference
method. The improved method infers more stable IPv6 cliques that are composed
of transit-free ASes with the number of ASes entering or leaving the clique
reducing from an average 3.4 ASes with the IPv4-focused method to 1.8 with
our IPv6-focused method. This improvement brings the edit distance between
temporally adjacent cliques much closer to IPv4’s average of 1.5 ASes.
IPv6 AS Relationships, Cliques, and Congruence
119
4.3 Inferring Clique-Stub Relationships
After we infer the clique, we apply the rest of the steps in Algorithm 1 without
modiﬁcation until step 9, which infers stub ASes to be customers of clique ASes
irrespective of whether we observed a clique AS exporting a stub AS as a cus-
tomer. In IPv4, this step avoids misinferring backup transit links as p2p, and
relies on the fact that no clique members have an open peering policy. Establish-
ing backup transit links is a popular strategy for IPv4 ASes that need to ensure
reliable connectivity in the face of failures, but backup transit links appear to
be less critical in IPv6 given the low levels of traﬃc [8] and small size of the
topology. Therefore, we skip step 9 of the algorithm.
4.4 Validation
1
2006
2008
0.9
0.8
0.7
0.6
0.5
2004
We evaluated the positive predictive
value (PPV) of our improved algo-
rithm, deﬁned as the proportion of
inferences of a particular type that
were correct. Figure 6 shows the PPV
over time according to our validation
datasets described in Sect. 3.2. Our
algorithm achieves high PPV through-
out the period of inferences (January
2004–July 2014), with PPV for both
p2c and p2p inferences consistently
above 96 % after spring 2009 for the
communities and after fall 2012 for
the RPSLng data. The PPV for infer-
ences validated using the LocPref data
is over 96 % for the three points in time
where we have LocPref data. The diversity of validation data sources and high
PPV values strengthens our conﬁdence in the suitability of our algorithm and the
accuracy of our inferences. Figure 6 shows that both p2c and p2p relationships
are inferred with high PPV, except for before 2006 when p2c inferences have a
PPV of less than 80 % for many BGP snapshots. However, our validation dataset
(and the IPv6 AS topology) is considerably smaller (Fig. 1) prior to 2006.
Fig. 6. Validation of our inferences over
time using the three validation datasets
described in Sect. 3.2. Validation results
involving the BGP communities and local
preference datasets are in strong agree-
ment despite involving diﬀerent ASes.
2010
2012
2014
5 Analysis
We compare IPv6 and IPv4 routing relationships starting from 2006 to avoid
artifacts from inference errors on very small early topologies. Congruent rela-
tionships refer to dual-stack AS links with the same relationship type in IPv4
and IPv6; disparate relationships are dual-stack links where the relationship dif-
fers from IPv4 to IPv6. The fraction of disparate relationships decreases linearly
over time (Fig. 7a), from 15 % in 2006 to 5 % in 2014, because congruent rela-
tionships increase in number faster than disparate ones, suggesting convergence.
120
V. Giotsas et al.
(a) Fraction of disparate relationships for
dual-stack AS links. Inset graph plots
number of disparate relationships.
(b) The fraction of disparate relationships
by type (colored areas), and the contribu-
tion of AS 6939 (HE, dashed line).
Fig. 7. The fraction of disparate relationships decreases over time to about 5 % in
July 2014, showing convergence between the IPv4 and IPv6 topologies. Most disparate
relationships after 2010 are due to HE’s free IPv6 transit service.
Figure 7b shows the fraction of disparate relationships by relationship type.
Most inferred disparate relationships are p2c in IPv6 and p2p in IPv4, and
the remaining disparate relationships are p2p in IPv6 and p2c in IPv4. HE
(AS6939) contributes over 50 % of the disparate IP v6p2c/IP v4p2p relationships
after 2010, peaking in July 2014 when it contributed 87 % of observed disparate
relationships. These observations are consistent with the behavior of the IPv6
tunnel broker service provided by HE, which allows free transit, so that IPv4
peers can be IPv6 customers without cost [1]. This strategy allows HE to acquire
many IPv6 (free-transit) customers compared to IPv4, illustrated by comparing
HE’s IPv4 and IPv6 customer cones. The customer cone is deﬁned as the ASes
that an AS can reach by following a customer link (the AS’s customers, customers
of those customers, and so on) and is a metric of inﬂuence of an AS in the transit
market. Figure 8 compares the relative size of the customer cones between IPv4
and IPv6 over the last 9 years for the 9 largest providers as of July 2014. HE is
the only AS with a signiﬁcantly larger customer cone in IPv6 than in IPv4 (over
Fig. 8. The fraction of ASes in the customer cones of the largest 9 providers. The left
plot compares the customer cones between IPv6 and IPv4 for July 2014. The right plot
shows their growth over time. HE (AS6939) has a larger customer cone in IPv6 than
in IPv4; most other ASes have smaller, but still growing customer cones (except for
AS3549, Global Crossing, which merged with Level3 in 2012).
IPv6 AS Relationships, Cliques, and Congruence
121
50 % of IPv6 ASes). However, the relative sizes of customer cones of the largest
providers have an increasing trend, in contrast with the trend observed in the
IPv4 topology [18]. The only exception is Global Crossing (AS3549), which was
acquired by Level3 (AS3356) in 2012.
6 Conclusion
The low level of IPv6 deployment has hindered eﬀorts to accurately infer IPv6
AS relationships. We tackled this challenge by modifying CAIDA’s IPv4 rela-
tionship inference algorithm, which required a focus on the correct inference of
the IPv6 clique. The clique is a crucial component of AS topology, but with
fundamental disparities between IPv4 and IPv6, including the extreme peering
openness of some IPv6 ASes, and long-lived peering disputes among transit-free
IPv6 networks. To overcome these obstacles, we used two new metrics to help
ﬁlter out topological inconsistencies in IPv6: peering policy and BGP-observed
reachability.
We validated ten years of our algorithm’s inferences against three data sources:
BGP communities, RPSLng, and local preference values, which covered 25 % of
the BGP-observed topology for July 2014. Our inferences achieved an overall Pos-
itive Predictive Value of at least 96 % for each dataset since 2009, with increasing
accuracy over time. We found that dual-stack relationships are increasingly con-
gruent, as disparate relationships decreased from 15 % in 2006 to 5 % in 2014, while
the number of nodes and links increased by a factor of 14.5 times and 22 times,
respectively. Notably, disparate relationships are now dominated by a single AS,
Hurricane Electric, whose long-standing oﬀer of free IPv6 transit has enabled it
to become the dominant transit-free provider in IPv6, with the largest customer
cone in the IPv6 topology, despite not even being a transit-free network in IPv4.
Our validation and inference data is available at http://www.caida.org/
publications/papers/2015/asrank6/
Acknowledgements. The work was supported by U.S. NSF grant CNS-1111449,
DHS S&T Cyber Security Division (DHS S&T/CSD) BAA 11-02 and SPAWAR Sys-
tems Center Paciﬁc via contract number N66001-12-C-0130, and by DRDC pursuant to
an Agreement between the U.S. and Canadian governments for Cooperation in Science
and Technology for Critical Infrastructure Protection and Border Security. The work
represents the position of the authors and not of NSF, DHS, or DRDC.
References
1. Hurricane electric IPv6 tunnel broker. https://tunnelbroker.net/
2. PeeringDB. http://www.peeringdb.com
3. RIPE Routing Information Service (RIS). http://www.ripe.net/ris
4. Route Views. http://www.routeviews.org/
5. Blunk, Y., Damas, J., Parent, F., Robachevsky, A.: Routing policy speciﬁcation
language next generation (RPSLng). RFC 4012, March 2005
122
V. Giotsas et al.
6. Chandra, R., Traina, P., Li, T.: BGP communities attribute. RFC 1997. August
1996
7. Colitti, L., Gunderson, S.H., Kline, E., Reﬁce, T.: Evaluating IPv6 adoption in the
internet. In: Krishnamurthy, A., Plattner, B. (eds.) PAM 2010. LNCS, vol. 6032,
pp. 141–150. Springer, Heidelberg (2010)
8. Czyz, J., Allman, M., Zhang, J., Iekel-Johnson, S., Osterweil, E., Bailey, M.: Mea-
suring IPv6 adoption. In: SIGCOMM, pp. 87–98 (2014)
9. Dhamdhere, A., Luckie, M., Huﬀaker, B., claﬀy, k., Elmokashﬁ, A., Aben, E.:
Measuring the deployment of IPv6: topology, routing and performance. In: IMC,
pp. 537–550 (2012)
10. Gao, L.: On inferring autonomous system relationships in the Internet. IEEE/ACM
Trans. Netw. 9(6), 733–745 (2001)
11. Gill, P., Schapira, M., Goldberg, S.: A survey of interdomain routing policies. CCR
44(1), 28–34 (2013)
12. Giotsas, V., Luckie, M., Huﬀaker, B., claﬀy, k.: Inferring complex AS relationships.
In: IMC, November 2014
13. Giotsas, V., Zhou, S.: Detecting and assessing the hybrid IPv4/IPv6 AS relation-
ships. In: SIGCOMM Poster, pp. 424–425 (2011)
14. Giotsas, V., Zhou, S.: Valley-free violation in Internet routing - analysis based on
BGP community data. In: IEEE ICC 2012 CQRM, pp. 1208–1212, June 2012
15. Internet Archive: Wayback Machine. http://archive.org/web/
16. Karpilovsky, E., Gerber, A., Pei, D., Rexford, J., Shaikh, A.: Quantifying the extent
of IPv6 deployment. In: Moon, S.B., Teixeira, R., Uhlig, S. (eds.) PAM 2009. LNCS,
vol. 5448, pp. 13–22. Springer, Heidelberg (2009)
17. Leber, M.: IPv6 internet broken, cogent/telia/hurricane not peering, NANOG.
http://mailman.nanog.org/pipermail/nanog/2009-October/014017.html
18. Luckie, M., Huﬀaker, B., claﬀy, K., Dhamdhere, A., Giotsas, V.: AS relationships,
customer cones, and validation. In: IMC 2013, pp. 243–256 (2013)
19. Norton, W.: Restrictive peering policy. DrPeering International. http://drpeering.
net/FAQ/What-is-a-restrictive-peer.html
20. Oliveira, R., Pei, D., Willinger, W., Zhang, B., Zhang, L.: The (in)completeness of
the observed Internet AS-level structure. IEEE/ACM Trans. Netw. 18(1), 109–122
(2010)
21. UCLA: Internet AS-level topology archive. http://irl.cs.ucla.edu/topology
22. Zmijewski, E.: A Bakers Dozen, 2013 Edition. Renesys Blog. http://www.renesys.
com/2014/01/bakers-dozen-2013-edition/
23. Zmijewski, E.: World IPv6 Day. Renesys Blog. http://www.renesys.com/2011/06/
world-ipv6-day/