说明如果你在图形化桌面环境下使用emacs，本节中介绍的一些命令的效果会和描述的不太一
样。要想在图形化桌面环境中使用控制台模式的emacs，可以使用emacs-nw命令。如果
你想使用emacs的图形化特性，请阅读10.3.3节。
和vim编辑器的不同之处在于：使用vim时，你必须不停地从插入模式中进出，从而在输人命
令和插人文本之间切换：而emacs编辑器只有一个模式。如果你输人可打印字符，emacs就将它插
人到光标当前位置：如果你输人一个命令，emacs就执行命令。
如果emacs正确地检测到了你的终端仿真器，可以使用方向键和PageUp以及PageDown键在缓
冲区域移动光标。如果未能正确检测，有一些命令可用来移动光标。
C-P：上移一行（文本中的前一行）。
---
## Page 207
192
第10章使用编辑器
c-b：左移一字符。
c-f：右移一字符。
C-n：下移一行（文本中的下一行）。
还有一些命令能够让光标在文本中进行较长距离的跳跃。
M-E：右移到下个单词。
M-b：左移到上个单词。
C-a：移至行首。
C-e：移至行尾。
口M-a；移至当前句首。
M-e：移至当前句尾。
-v：上翻一屏。
 C-v：下翻一屏。
M-：移至文本的尾行。
还有几个命令可以将编辑器缓冲区保存至文件并退出emacs。
C-xC-s：保存当前缓冲区到文件。
C-z：退出emacs并保持在这个会话中继续运行，以便你切回。
 C-x C-c：退出emacs并停止该程序。
你会注意到这些功能中有两个需要两次键命令。C-x命令叫作扩晨命令（extendcommand）。
这为我们提供了另外一组命令。
2.编辑数据
emacs编辑器在插人和删除缓冲区中的文本时非常强大。要插人文本，只需将光标移动到想
插人文本的位置就可以开始输入了。要想删除文本，emacs使用退格键删除光标当前所在位置之
前的字符，使用删除键来删除光标当前位置之后的字符。
emacs编辑器还有剪切文本的命令。删除文本和剪切文本的差别在于：当你剪切文本时，emacs
会将其放在一个临时区域，你可以取回（参见接下来的一小节）；而删除的文本则会永远消失。
有几个命令可用来剪切缓冲区中的文本。
M-Backspace：剪切光标当前所在位置之前的单词。
口M-d：剪切光标当前所在位置之后的单词。
口C-k：剪切光标当前所在位置至行尾的文本。
口M-k：剪切光标当前所在位置至句尾的文本。
emacs编辑器还包括了一种独特的块剪切（mass-killing）的方法。移动光标到待剪切区域的
起始位置并按下c-B或c-Spacebar键，然后移动光标到待剪切区域的结束位置并按下c-w命令
键。这两个位置之间的文本都将被剪切。
①英文为kill，emacs专有的说法。
---
## Page 208
10.3emacs 编辑器
193
如果你在剪切文本时不巧弄错了，使用c-/命令就能撤销剪切命令，返回到剪切前的状态。
3.复制和粘贴
你已经看到了如何从cmacs缓冲区域剪切数据，现在该看看如何将它粘贴到其他地方了。遗
憾的是，如果你用过vim编辑器，那么emacs编辑器的用法可能会让你犯晕。
不巧的是，粘贴数据在emacs中也叫yanking。而在vim编辑器中，yanking指的是复制。如果
你恰好要用两种编辑器，这可就难记了。
当你用剪切命令剪切了某个数据后，将光标移动到你要粘贴数据的位置，用C-y来粘贴。这
会将文本从临时区域取出并将其粘贴在光标所在的位置。C-y命令会取出最后一个剪切命令存下
的文本。如果你执行了多个剪切命令，可以用M-y命令来循环选择它们。
要复制文本，只需将它粘贴到剪切它的地方然后移动到新的位置并再使用一次C-y命令即
可。如果需要，你可以粘贴文本任意多次。
4.查找和替换
在emacs编辑器中查找文本可用c-s和c-r命令。C-s命令是在会从缓冲区域中从光标当前位
置到缓冲区尾部执行前向查找，而c-r命令会是从在缓冲区域中从光标从当前所在位置到缓冲区
头部执行后向查找。
当输人C-s和c-r两者中的任意一个时，底行会出现一个提示，询问要查找的文本。emacs
可以执行两种类型的查找。
在渐进式（incremental）查找中，emacs编辑器在你键入单词时以实时方式执行文本查找。
当键人第一个字母时，它会高亮显示缓冲区中所有该字母出现的地方。当键人第二个字母时，它
会高亮显示文本中所有出现这两个字母组合的地方。如此往复，直到输人完要查找的文本。
在非渐进式（non-incremental）查找中，在C-s或C-r命令后按下回车键。这会将查询锁定在
底行区域，允许你在查找前输人完整的待查找文本。
要用新字符串来替换一个已有文本字符串，就必须用M-x命令。这个命令需要一个文本命令
和参数。
该文本命令是replace-string。输入该命令并按下回车键，emacs会询问要替换的已有字
10
符串。输人之后，再按一次回车键，emacs会询问用来替换的新字符串。
5.在emacs中使用缓冲区
emacs编辑器可以使用多个缓冲区同时编辑多个文件。你可以把文件加载到一个缓冲区中，
编辑时在多个缓冲区中切换。
当你处于emacs中时，可以使用c-xC-f组合键将新的文件加载到缓冲区。这是emacs的查找
文件模式。它会把你带到窗口的底行，允许你输人要开始编辑的文件名。如果不知道文件的名称
或位置，可以按下回车键。它会在编辑窗口启动一个文件浏览器，如图10-所示
你可以在这里浏览到要编辑的文件。要进人上一级目录，移动到双点条目并按下回车键。要
进人下一级目录，移动到该目录条目并按下回车键。如果找到了要编辑的文件，按下回车键，emacs
会自动将它加载到新的缓冲区域。
---
## Page 209
t61
第10章使用编辑器
e B/t odlos affers Tools lperaie Nosk Begekg lanedlete SaMir lelp
dre--
TW-
213
ahristie
hristise
Christise
frve
Christise
Christise
MakLog
-rw-f-----.
1 Christise (
Christine
2 Christise
Pucsecm.a
X-DXNI
Cristise
Christise 
Cristise
Farta
gceal
ia1.sk
x=-F1
图10-4emacs查找文件模式浏览器
你可以按下c-xC-b扩展命令组合来列出工作缓冲区。emacs编辑器会拆分编辑器窗口，在
底部窗口显示一个缓冲区列表。除了主要的编辑缓冲区，emacs还提供了另外两个缓冲区：
草稿区域，称为*scatch*；
消息区域，称为*Messages*。
草稿区域允许输人LISP编程命令以及个人笔记。消息区域则显示在操作期间由emacs生成的
消息。如果在使用emacs时出现了任何错误，它们会显示在消息区域中。
有两种方式可在窗口中切换到不同的缓冲区域。
口C-×o：切换到缓冲区列表窗口。用方向键移动到你想要的缓冲区域并按下回车键。
口C-xb：输人你要切换到的缓冲区域的名字。
当选择切换到缓冲区列表窗口的选项时，emacs会在新的窗口区域打开缓冲区。emacs编辑器
允许在单个会话中打开多个窗口。接下来的一节将讨论如何在emacs中管理多个窗口。
6.在控制台模式的emacs中使用窗口
控制台模式的emacs编辑器要比图形化窗口早出现了好多年。即便在当时，emacs也是出类拔
萃的，因为它可以支持在主窗口中打开多个编辑窗口。
可以用下面两个命令将emacs编辑窗口拆分成多个窗口。
C-×2：将窗口水平拆分成两个窗口。
C-x3：将窗口竖向拆分成两个窗口。
要从一个窗口移动到另一个，可用c-xo命令。注意，在创建一个新窗口时，emacs会在新
窗口中使用原始窗口的缓冲区域。一旦移动到了新窗口，你可以在新窗口中用c-xC-f命令来加
载一个新文件，或者用其中一个命令切换到一个不同的缓冲区域
要关闭窗口，移动到该窗口并用c-x0（数字0）命令；如果你想关掉除了你所在窗口之外
的所有窗口，用c-x1（数字1）命令。
---
## Page 210
10.3emacs 编辑器
195
10.3.3在GUI环境中使用emacS
如果在GUI环境中使用emacs（比如Unity或GNOME桌面），它会以图形模式启动，如图10-5
所示。
PI:EMAIL
-×
File
Edit Options Buffers Tools C Help
ginc lude 
int main()
int nunber = 5;
for(i=1; i s nunber; i++)
 + dete, = [eoe,
printf(*The factorial of % is d\n*, nuaber, factorial);
return 8;
AUL LI
(C/l Abbrev].......
*GNU Esacs*Top L3(Fundanental...
Lean basic keystroke Ci
spue
图10-5emacs图形化窗口
如果你已经在控制台模式下用过emacs，应该非常熟悉图形模式。所有的键命令都以菜单项
的形式存在。emacs菜单栏包括下列菜单项
File：允许你在窗口中打开文件、创建新窗口、关闭窗口、保存缓冲区和打印缓冲区。
口Edit：允许你将选择的文本剪切并复制到剪贴板，将剪贴板的内容粘贴到光标当前所在
10
位置，以及查找文本和替换文本。
口Options：提供许多emacs功能设定，如高亮显示、自动换行、光标类型和字体设置。
口Bufers：列出当前可用的缓冲区，可以让你在缓冲区域间轻松切换。
口Tools：提供对emacs高级功能的访问，比如命令行界面访间、拼写检查、文件内容比较
（称为diff）、发送电子邮件消息、日历以及计算器。
口Help：提供emacs的在线手册，以获取特定emacs功能的帮助。
除了普通的emacs图形化菜单项外，针对编辑器缓冲区中特定的文件类型，通常还会有一个
独立的菜单项。图10-5中打开一个C程序，所以emacs提供了一个C菜单项，允许用户进行相关的
高级设置，例如C语法高亮、编译、运行以及命令行代码调试。
图形化的emacs窗口是古老的控制台程序向图形化世界迁移的一个例子。现在许多Linux发行
---
## Page 211
196
第10章使用编辑器
版都提供了图形化桌面（甚至在不需要它们的服务器上），图形化编辑器也越来越司空见惯。流
行的Linux桌面环境（如KDE和GNOME）都提供了针对各自环境的图形化文本编辑器，本章接下
来将介绍。
10.4KDE系编辑器
如果你所用的Linux发行版中采用的是KDE桌面（参见第1章），那么有几种文本编辑器可供
选择。KDE项目官方支持两种流行的文本编辑器。
口KWrite：单屏幕文本编辑程序。
口Kate：功能全面的多窗口文本编辑程序。
这两个编辑器都是图形化文本编辑器，含有许多高级功能。Kate编辑器提供了更高级的功能，
以及标准文本编辑器中不常见的细致之处。本节将分别介绍这两种编辑器，并演示一些可用来帮
你编写shell脚本的功能。
10.4.1KWrite编辑器
KDE环境的基本编辑器是KWrite。它提供了简单的文字处理类型的文本编辑功能，还支持代
码语法高亮显示和编辑。默认的KWrite编辑窗口如图10-6所示。
[]  feerteKete
9
ractorigL-4
for (sel: 1 < Irurber; 1** 2)
factorral=°expr sractorlal. * $1
NS LNE Bsh fsctsral. th
图10-6编辑shell脚本程序时的默认KWrite窗口
尽管可能没法在图10-6中看出来，但KWrite编辑器确实可以识别好几种类型的编程语言，并
采用代码着色来标识常量、函数和注释。另外要注意，在for循环处有个图标连接起了开始和结
束的花括号。这叫作折叠标记（folding marker）。点击这个图标就可以将函数折叠成一行。这是
---
## Page 212
10.4KDE系编辑器
197
处理大型应用时非常好的一个功能。
KWrite编辑窗口用鼠标和方向键提供了完整的剪切和粘贴功能。跟在文字处理器中一样，你
可以高亮显示并剪切文本区域中任意位置的文本，并将其粘贴到其他地方。
要用KWrite编辑文件，你可以从桌面上的KDE菜单系统中选择KWrite（一些Linux发行版甚
至为其创建了一个面板按钮）或从命令行下启动：
S kwrite factorial.sh
kwrite命令有以下几个命令行参数可用来定制它如何启动。
--stdin：让KWrite从标准输人设备中而非文件中读取数据。
--encoding：为文件指字符编码类型。
--line：指定编辑器窗口中开始的文件行号。
--column：指定编辑器窗口中开始的文件列号。
KWrite编辑器在编辑器窗口的顶部提供了菜单栏和工具栏，允许你选择KWrite编辑器的功能
以及修改其配置设置。
菜单栏含有下面的条目。
File：加载、保存、打印以及导出文件中的文本。
Edit：操作缓冲区中的文本。
口View：管理如何在编辑器窗口中显示文本。
口Bookmarks：处理返回文本中特定位置的指针（这个选项可能要在配置中启用）
口Tools：包含操作文本的特定功能。
口 Setings：配置编辑器处理文本的方式。
口Help：获取编辑器和命令的有关信息。
Edi菜单提供了你需要的所有文本编辑命令。你不需要记住像密码一般的键命令（顺便提一
下，KWrite也支持），只要在Edit菜单项中选取条目即可，如表10-3所示。
表10-3KWrite Edit菜单条目
10
条
目
描
述
Undo
取消最后一个动作或操作
Redo
取消最后—个撤销动作
Cut
删除选择的文本并将其放人剪贴板
Copy
将选择的文本复制到剪贴板
Paste
在光标当前所在位置插人剪贴板的当前内容
Select AlI
选择编辑签中的所有文本
Deselect
取消选择当前选定的文本
Overurie Mode
从插人模式切换到改写模式，在改写模式中，文本会被新输人的文本覆盖，面不是仅
插人新文本
Find
产生一个查找文本对话框。允许你定制文本查找
 P
在级冲区中向前重复上一个查我操作
---
## Page 213
198
本01
使用编辑器
（续）
Find Previous
条
目
描
在级冲区中向后重复上一个查找操作
Replace
产生一个替换文本对话框，允许你定制文本查找和替换
Find Selected
查找选定文本下一次出现的地方
Find Selected Backwands
查找选定文本上一次出现的地方
Go to Line
产生一个Goto（跳到）对话框，允许你输入一个行号。光标会移到指定行
Find功能有两种模式：普通模式执行简单的文本搜索和加强搜索。替换模式可以进行必要的
高级查找和替换。可以用Find区域的绿色箭头切换这两种模式，如图10-7所示。
dss