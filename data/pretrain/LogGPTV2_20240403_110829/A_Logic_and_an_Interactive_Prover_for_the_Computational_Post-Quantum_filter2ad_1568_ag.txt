proofs that require rewinding or that are in the ROM, but such
restriction do not hinder proving a wide range of protocols
from the literature. As discussed previously, it is unclear
which kind of rewinding should be integrated currently in
Squirrel. Integrating the ROM (and QROM) into PQ-BC and
PQ-SQUIRREL could be interesting future work. However,
while (Q)ROM is often needed for the analysis of primitives,
it is less often needed for protocols. A class of protocol we
cannot typically verify are e-voting protocols, that often rely
on the ROM. However, there is a long-standing debate on the
ROM model, because it is not realizable in practice. Typically,
it is often preferable to use the PRF assumption when a secret
seed is derived in the protocol, as we did in our case studies.
In other cases, integrating results such as [52] into PQ-BC
might offer a solution in the future.
Besides protocols whose proofs require rewinding or the
ROM, we are not aware of any inherent limitations of the
logic or the prover that would hinder the proofs of other post-
quantum protocols.
C. Reﬁning the case studies
The goal of our case studies is to show the usability and
scalability of the tool, not to provide an exhaustive analysis of
each of them. For example, our current key exchange analysis
only consider a model with static compromise. However, this
is not an inherent limitation of the logic, and the threat model
is only part of the protocol modeling. As such, a natural
future work is to reﬁne our case studies and try to prove more
advanced properties such as PFS or PCS.
D. Improving automation
Based on our ﬁrst set of case studies, PQ-SQUIRREL shows
the potential to tackle complex case studies such as the proposal
of a recent post-quantum TLS [55]. Performing such complex
case studies would beneﬁt from improving the automation in
PQ-SQUIRREL. We see two main possible routes to achieve
this. First, some low level reasoning about message equalities
and inequalities is already automated in many cases, but could
be improved by leveraging SMT solvers. Second, the unique
abstraction level of our logic enables us to reason both at the
high-level of the executions traces as well as at the low level
of the indistinguishability of two messages. This abstraction
opens the door for the application of more advanced constraint
solving techniques, similar to the one used in symbolic tools,
which can further improve automation.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:34:09 UTC from IEEE Xplore.  Restrictions apply. 
15139
VII. CONCLUSION
We deﬁned the PQ-BC logic for proving protocol security
against quantum attackers, and a corresponding PQ-SQUIRREL
prover to mechanize the reasoning. In the process of extending
the BC logic for this purpose, we identiﬁed three simple
syntactic side conditions that are both necessary and sufﬁ-
cient; these conditions, and the new tactics we developed
for PQ-SQUIRREL, can be useful for the classical setting as
well. Our initial case studies show that PQ-SQUIRREL can be
effectively used to prove post-quantum protocol security.
Acknowledgments.: We thank Hubert Comon for many
interesting discussions.
REFERENCES
[1] Long version of this paper. https://eprint.iacr.org/2022/401.
[2] The Squirrel Prover repository. https://github.com/squirrel-prover/squirre
l-prover/.
[3] José Bacelar Almeida, Manuel Barbosa, Gilles Barthe, Matthew Cam-
pagna, Ernie Cohen, Benjamin Gregoire, Vitor Pereira, Bernardo Portela,
Pierre-Yves Strub, and Serdar Tasiran. A Machine-Checked Proof of
Security for AWS Key Management Service. In Proceedings of the 2019
ACM SIGSAC Conference on Computer and Communications Security,
pages 63–78, London United Kingdom, November 2019. ACM.
[4] Andris Ambainis, Ansis Rosmanis, and Dominique Unruh. Quantum
attacks on classical proof systems: the hardness of quantum rewinding.
In 2014 IEEE 55th Annual Symposium on Foundations of Computer
Science, pages 474–483. IEEE, 2014.
[5] David Baelde, Stéphanie Delaune, Charlie Jacomme, Adrien Koutsos,
and Solène Moreau. An interactive prover for protocol veriﬁcation in
the computational model. In 42nd IEEE Symposium on Security and
Privacy (S&P 2021). IEEE, 2021.
[6] Gergei Bana, Rohit Chadha, and Ajay Kumar Eeralla. Formal Analysis
of Vote Privacy Using Computationally Complete Symbolic Attacker.
In Computer Security - 23rd European Symposium on Research in
Computer Security, ESORICS 2018, Barcelona, Spain, September 3-7,
2018, Proceedings, Part II, pages 350–372, 2018.
[7] Gergei Bana and Hubert Comon-Lundh. A Computationally Complete
Symbolic Attacker for Equivalence Properties. In Proceedings of the 21st
ACM Conference on Computer and Communications Security (CCS’14),
pages 609–620, Scottsdale, Arizona, USA, November 2014. ACM Press.
[8] Manuel Barbosa, Gilles Barthe, Xiong Fan, Benjamin Grégoire, Shih-
Han Hung, Jonathan Katz, Pierre-Yves Strub, Xiaodi Wu, and Li Zhou.
In Proceedings of
EasyPQC: Verifying post-quantum cryptography.
the 2021 ACM SIGSAC Conference on Computer and Communications
Security, pages 2564–2586, 2021.
[9] Gilles Barthe, François Dupressoir, Benjamin Grégoire, César Kunz,
Benedikt Schmidt, and Pierre-Yves Strub. EasyCrypt: A Tutorial. In
Foundations of Security Analysis and Design VII: FOSAD 2012/2013
Tutorial Lectures, Lecture Notes in Computer Science, pages 146–166.
Springer International Publishing, Cham, 2014.
[10] David Basin, Ralf Sasse, and Jorge Toro-Pozo. Card brand mixup attack:
Bypassing the PIN in non-Visa cards by using them for Visa transactions.
In 30th USENIX Security Symposium USENIX Security 21), 2021.
[11] Mihir Bellare, Anand Desai, David Pointcheval, and Phillip Rogaway.
Relations among notions of security for public-key encryption schemes.
In Annual International Cryptology Conference, pages 26–45. Springer,
1998.
[12] Daniel J Bernstein, Tanja Lange, Chloe Martindale, and Lorenz Panny.
Quantum circuits for the CSIDH: optimizing quantum evaluation of
In Annual International Conference on the Theory and
isogenies.
Applications of Cryptographic Techniques, pages 409–441. Springer,
2019.
[13] Karthikeyan Bhargavan, Bruno Blanchet, and Nadim Kobeissi. Veriﬁed
models and reference implementations for the TLS 1.3 standard candidate.
In IEEE Symposium on Security and Privacy (SP 2017), pages 483–502.
IEEE, 2017.
[14] Jean-François Biasse, Annamaria Iezzi, and Michael J. Jacobson. A note
on the security of CSIDH. In Progress in Cryptology – INDOCRYPT
2018, pages 153–168, Cham, 2018. Springer International Publishing.
[15] B. Blanchet. A Computationally Sound Mechanized Prover for Security
Protocols. IEEE Transactions on Dependable and Secure Computing,
5(4):193–207, October 2008. Conference Name: IEEE Transactions on
Dependable and Secure Computing.
[16] Bruno Blanchet. Modeling and Verifying Security Protocols with the
Applied Pi Calculus and ProVerif. Foundations and Trends® in Privacy
and Security, 1(1-2):1–135, October 2016. Publisher: Now Publishers,
Inc.
[17] Xavier Bonnetain and André Schrottenloher. Quantum security analysis
of CSIDH. Advances in Cryptology–EUROCRYPT 2020, 12106:493,
2020.
[18] Colin Boyd, Yvonne Cliff, Juan M. Gonzalez Nieto, and Kenneth G.
Paterson. One-round key exchange in the standard model. International
Journal of Applied Cryptography, 1(3):181, 2009.
[19] Mayla Brusò, Konstantinos Chatzikokolakis, and Jerry den Hartog.
Formal veriﬁcation of privacy for RFID systems. In CSF, pages 75–88.
IEEE Computer Society, 2010.
[20] David Carrel and Dan Harkins. The Internet Key Exchange (IKE). RFC
2409, November 1998.
[21] Wouter Castryck, Tanja Lange, Chloe Martindale, Lorenz Panny, and
Joost Renes. CSIDH: An efﬁcient post-quantum commutative group
action. In Advances in Cryptology – ASIACRYPT 2018, pages 395–427,
Cham, 2018. Springer International Publishing.
[22] Katriel Cohn-Gordon, Cas Cremers, Benjamin Dowling, Luke Garratt,
and Douglas Stebila. A formal security analysis of the Signal messaging
protocol. Journal of Cryptology, 33(4):1914–1983, 2020.
[23] Hubert Comon, Charlie Jacomme, and Guillaume Scerri. Oracle
simulation: a technique for protocol composition with long term shared
secrets. In Proceedings of the 27st ACM Conference on Computer and
Communications Security (CCS’20), Orlando, USA, November 2020.
ACM Press.
[24] Hubert Comon and Adrien Koutsos. Formal Computational Unlinkability
Proofs of RFID Protocols. In Proceedings of the 30th IEEE Computer
Security Foundations Symposium (CSF’17), pages 100–114, Santa
Barbara, California, USA, 2017. IEEE Computer Society Press.
[25] V. Cortier, C. C. Dr˘agan, F. Dupressoir, B. Schmidt, P. Strub, and
B. Warinschi. Machine-Checked Proofs of Privacy for Electronic Voting
Protocols. In 2017 IEEE Symposium on Security and Privacy (SP), pages
993–1008, May 2017. ISSN: 2375-1207.
[26] Cas Cremers, Marko Horvat, Jonathan Hoyland, Sam Scott, and Thyla
van der Merwe. A comprehensive symbolic analysis of TLS 1.3. In
ACM SIGSAC Conference on Computer and Communications Security
(CCS 2017), pages 1773–1788. ACM, 2017.
[27] Cas Cremers, Benjamin Kiesl, and Niklas Medinger. A formal analysis
of IEEE 802.11’s WPA2: Countering the kracks caused by cracking the
counters. In 29th USENIX Security Symposium (USENIX Security 2020),
pages 1–17. USENIX Association, 2020.
[28] Maria Luisa Dalla Chiara, Roberto Giuntini, and Richard Greechie.
Reasoning in quantum theory: sharp and unsharp quantum logics,
volume 22. Springer Science & Business Media, 2013.
[29] A. Delignat-Lavaud, C. Fournet, M. Kohlweiss, J. Protzenko, A. Rastogi,
N. Swamy, S. Zanella-Beguelin, K. Bhargavan, J. Pan, and J. K.
Zinzindohoue. Implementing and Proving the TLS 1.3 Record Layer. In
2017 IEEE Symposium on Security and Privacy (SP), pages 463–482,
May 2017. ISSN: 2375-1207.
[30] Antoine Delignat-Lavaud, Cédric Fournet, Bryan Parno, Jonathan
Protzenko, Tahina Ramananandro, Jay Bosamiya, Joseph Lallemand,
Itsaka Rakotonirina, and Yi Zhou. A Security Model and Fully Veriﬁed
Implementation for the IETF QUIC Record Layer. page 17.
[31] D. Dolev and A. Yao. On the security of public key protocols. IEEE
Transactions on Information Theory, 29(2):198–208, 1983.
[32] Léo Ducas, Eike Kiltz, Tancrede Lepoint, Vadim Lyubashevsky, Peter
Schwabe, Gregor Seiler, and Damien Stehlé. Crystals-dilithium: A lattice-
based digital signature scheme. IACR Transactions on Cryptographic
Hardware and Embedded Systems, pages 238–268, 2018.
[33] Martin Feldhofer, Sandra Dominikus, and Johannes Wolkerstorfer. Strong
authentication for RFID systems using the AES algorithm. In CHES,
volume 3156 of Lecture Notes in Computer Science, pages 357–370.
Springer, 2004.
[34] Scott Fluhrer, Panos Kampanakis, David McGrew, and Valery Smyslov.
Mixing Preshared Keys in the Internet Key Exchange Protocol Version
2 (IKEv2) for Post-quantum Security. RFC 8784, June 2020.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:34:09 UTC from IEEE Xplore.  Restrictions apply. 
16140
Santiago Zanella-Béguelin. Dependent types and multi-monadic effects
In Proceedings of the 43rd Annual ACM SIGPLAN-SIGACT
in F*.
Symposium on Principles of Programming Languages, POPL ’16, pages
256–270, New York, NY, USA, January 2016. Association for Computing
Machinery.
[58] Dominique Unruh. Quantum proofs of knowledge.
In Annual inter-
national conference on the theory and applications of cryptographic
techniques, pages 135–152. Springer, 2012.
[59] Dominique Unruh. Quantum Relational Hoare Logic. Proceedings of
the ACM on Programming Languages, 3(POPL):1–31, 2019.
[60] John Watrous. Zero-knowledge against quantum attacks. SIAM Journal
on Computing, 39(1):25–58, 2009.
[61] W. K. Wootters and W. H. Zurek. A single quantum cannot be cloned.
Nature, 299(5886):802–803, October 1982.
[62] Mark Zhandry. How to construct quantum random functions. Journal of
the ACM (JACM), 68(5):1–43, 2021.
[35] Atsushi Fujioka, Koutarou Suzuki, Keita Xagawa, and Kazuki Yoneyama.
Strongly Secure Authenticated Key Exchange from Factoring, Codes,
and Lattices. Technical Report 211, 2012.
[36] Tommaso Gagliardoni. Quantum Security of Cryptographic Primitives.
arXiv:1705.02417 [quant-ph], May 2017. arXiv: 1705.02417.
[37] Paul Grubbs, Varun Maram, and Kenneth G. Paterson. Anonymous,
Robust Post-Quantum Public Key Encryption. 2021. https://ia.cr/2021/7
08.
[38] Keitaro Hashimoto, Shuichi Katsumata, Kris Kwiatkowski, and Thomas
Prest. An efﬁcient and generic construction for Signal’s handshake
(X3DH): Post-quantum, state leakage secure, and deniable. In Public-
Key Cryptography – PKC 2021, pages 410–440, Cham, 2021. Springer
International Publishing.
[39] Lucca Hirschi, David Baelde, and Stéphanie Delaune. A method for
unbounded veriﬁcation of privacy-type properties. J. Comput. Secur.,
27(3):277–342, 2019.
[40] Ari Juels and Stephen A. Weis. Deﬁning strong privacy for RFID. ACM
Trans. Inf. Syst. Secur., 13(1):7:1–7:23, 2009.
[41] Charlie Kaufman, Paul E. Hoffman, Yoav Nir, Pasi Eronen, and Tero
Kivinen. Internet Key Exchange Protocol Version 2 (IKEv2). RFC 7296,
October 2014.
[42] Tomoki Kawashima, Katsuyuki Takashima, Yusuke Aikawa, and Tsuyoshi
Takagi. An efﬁcient authenticated key exchange from random self-
In International Conference on Information
reducibility on CSIDH.
Security and Cryptology, pages 58–84. Springer, 2020.
[43] Nadim Kobeissi, Karthikeyan Bhargavan, and Bruno Blanchet. Automated
veriﬁcation for secure messaging protocols and their implementations: A
symbolic and computational approach. In IEEE European symposium
on security and privacy (EuroS&P 2017), pages 435–450. IEEE, 2017.
[44] Nadim Kobeissi, Georgio Nicolas, and Karthikeyan Bhargavan. Noise
Explorer: Fully automated modeling and veriﬁcation for arbitrary Noise
In IEEE European Symposium on Security and Privacy
protocols.
(EuroS&P 2019), pages 356–370. IEEE, 2019.
[45] A. Koutsos. The 5G-AKA Authentication Protocol Privacy. In 2019
IEEE European Symposium on Security and Privacy (EuroS&P), pages
464–479, June 2019.
[46] Adrien Koutsos. Preuves symboliques de propriétés d’indistinguabilité
calculatoire. Theses, Université Paris-Saclay, September 2019.
[47] B. Lipp, B. Blanchet, and K. Bhargavan. A Mechanised Cryptographic
Proof of the WireGuard Virtual Private Network Protocol. In 2019 IEEE
European Symposium on Security and Privacy (EuroS P), pages 231–246,
June 2019.
[48] Simon Meier, Benedikt Schmidt, Cas Cremers, and David Basin. The
TAMARIN Prover for the Symbolic Analysis of Security Protocols. In
Computer Aided Veriﬁcation, Lecture Notes in Computer Science, pages
696–701, Berlin, Heidelberg, 2013. Springer.
[49] David Molnar and David A. Wagner. Privacy and security in library
RFID: issues, practices, and architectures. In CCS, pages 210–219. ACM,
2004.
[50] Waka Nagao, Yoshifumi Manabe, and Tatsuaki Okamoto. On the
equivalence of several security notions of key encapsulation mechanism.
IACR Cryptol. ePrint Arch., 2006:268, 2006.
[51] Chris Peikert. He gives C-sieves on the CSIDH. Advances in Cryptology–
EUROCRYPT 2020, 12106:463, 2020.
[52] Phillip Rogaway. Formalizing human ignorance.
In International
Conference on Cryptology in Vietnam, pages 211–228. Springer, 2006.
[53] Guillaume Scerri and Stanley-Oakes Ryan. Analysis of Key Wrapping
APIs: Generic Policies, Computational Security. pages 281–295. IEEE
Computer Society, June 2016.
[54] Peter Schwabe, Douglas Stebila, and Thom Wiggers. Post-Quantum
TLS Without Handshake Signatures. In Proceedings of the 2020 ACM
SIGSAC Conference on Computer and Communications Security, CCS
’20, pages 1461–1480, New York, NY, USA, October 2020. Association
for Computing Machinery.
[55] Peter Schwabe, Douglas Stebila, and Thom Wiggers. Post-quantum TLS
without handshake signatures. In ACM SIGSAC Conference on Computer
and Communications Security (CCS 2020), pages 1461–1480. ACM,
2020.
[56] Fang Song. A note on quantum security for post-quantum cryptography.
In International Workshop on Post-Quantum Cryptography, pages 246–
265. Springer, 2014.
[57] Nikhil Swamy, C˘at˘alin Hri¸tcu, Chantal Keller, Aseem Rastogi, Antoine
Delignat-Lavaud, Simon Forest, Karthikeyan Bhargavan, Cédric Fournet,
Pierre-Yves Strub, Markulf Kohlweiss, Jean-Karim Zinzindohoue, and
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:34:09 UTC from IEEE Xplore.  Restrictions apply. 
17141