easy to ﬁnd via exhaustive search. Furthermore,
as we mentioned in Section 7.4, manufacturers of-
ten deployed their cars with predictable transpon-
der passwords. As shown in Figure 8, there are
four pages available of user deﬁned memory in a
Hitag2 transponder. These could be used to extend
the transponder password with 128 bits of random
data to increase its entropy. This implies that an
adversary needs to get access to the transponder’s
memory before being able to steal a car.
• Delay authentication after failure
The cryptographic car-only attack explained in Sec-
tion 5.3 requires several authentication attempts to
reduce the computational complexity. Extending
the time an adversary needs to gather these traces
increases the risk of being caught. To achieve
this, the immobilizer introduces a pause before re-
authenticating that grows incrementally or exponen-
tially with the number of sequential incorrect au-
thentications. An interesting technique to imple-
ment such a countermeasure is proposed in [40].
The robustness, availability and usability of the
product is affected by this delay, but it increases the
attack time considerably and therefore reduces the
risk of car theft.
Besides these measures, it is important to improve the
pseudo-random number generator in the vehicles which
is used to generate reader nonces. Needless to say, the
same applies to cryptographic keys and transponder pass-
words. NIST has proposed a statistical test suite which
can be used to verify the quality of a pseudo-random
number generator [41].
9 Conclusions
We have found many serious vulnerabilities in the Hitag2
and its usage in the automotive industry. In particular,
Hitag2 allows replaying reader data to the transponder;
provides an unlimited keystream oracle and uses only
one low-entropy nonce to randomize a session. These
weaknesses allow an adversary to recover the secret key
within seconds when wireless access to the car and key
is available. When only communication with the car is
possible, the adversary needs less than six minutes to
recover the secret key. The cars we tested use identi-
ﬁer white-listing. To circumvent this, the adversary ﬁrst
needs to obtain a valid transponder id by other means
e.g., eavesdrop it when the victim locks the doors. This
UHF transmission can be intercepted from a distance of
100 meters [18]. We have executed all our attacks (from
Section 5) in practice within the claimed attack times.
We have experimented with more than 20 vehicles of
various makes and models and found also several imple-
mentation weaknesses.
In line with the principle of responsible disclosure, we
have notiﬁed the manufacturer NXP six months before
disclosure. We have constructively collaborated with
NXP, discussing mitigating measures and giving them
feedback to help improve the security of their products.
10 Acknowledgments
The authors would like to thank Bart Jacobs for his
ﬁrm support in the background. We are also thankful
to E. Barendsen, L. van den Broek, J. de Bue, Y. van
Dalen, E. Gouwens, R. Habraken, I. Haerkens, S. Hop-
penbrouwers, K. Koster, S. Meeuwsen, J. Reule, J. Re-
ule, I. Roggema, L. Spix, C. Terheggen, M. Vaal, S. Ver-
nooij, U. Zeitler, B. Zwanenburg, and those who prefer to
remain anonymous for (bravely) volunteering their cars
for our experiments.
References
[1] Ross J. Anderson. Security Engineering: A guide
to building dependable distributed systems. Wiley,
2010.
[2] Atmel. Embedded avr microcontroller including rf
transmitter and immobilizer lf functionality for re-
mote keyless entry - ATA5795, 2010.
[3] Steve Babbage. A space/time tradeoff in exhaust-
ive search attacks on stream ciphers. In European
Convention on Security and Detection, volume 408
of Conference Publications, pages 161–166. IEEE
Computer Society, 1995.
[4] Josep Balasch, Benedikt Gierlichs, Roel Verdult,
Lejla Batina, and Ingrid Verbauwhede. Power ana-
lysis of Atmel CryptoMemory - recovering keys
from secure EEPROMs.
In 12th Cryptograph-
ers’ Track at the RSA Conference (CT-RSA 2012),
volume 7178 of Lecture Notes in Computer Sci-
ence, pages 19–34. Springer-Verlag, 2012.
[5] Alex Biryukov, Ilya Kizhvatov, and Bin Zhang.
the Atmel cipher in Secure-
Cryptanalysis of
Memory, CryptoMemory and CryptoRF. In 9th Ap-
plied Cryptography and Network Security (ACNS
2011), pages 91–109. Springer-Verlag, 2011.
[6] Alex Biryukov, Sourav Mukhopadhyay, and Palash
Improved time-memory trade-offs with
Sarkar.
multiple data.
In 13th International Workshop
on Selected Areas in Cryptography (SAC 2006),
volume 3897 of Lecture Notes in Computer Sci-
ence, pages 110–127. Springer-Verlag, 2006.
[7] Alex Biryukov and Adi Shamir. Cryptanalytic
time/memory/data tradeoffs for stream ciphers. In
6th International Conference on the Theory and
Application of Cryptology and Information Secur-
ity, Advances in Cryptology (ASIACRYPT 2000),
volume 1976 of Lecture Notes in Computer Sci-
ence, pages 1–13. Springer-Verlag, 2000.
[8] Andrey Bogdanov. Linear slide attacks on the Kee-
In Information Security and
Loq block cipher.
Cryptology (INSCRYPT 2007), volume 4990 of
Lecture Notes in Computer Science, pages 66–80.
Springer, 2007.
[9] Andrey Bogdanov and Christof Paar. On the se-
curity and efﬁciency of real-world lightweight au-
thentication protocols.
In 1st Workshop on Se-
cure Component and System Identiﬁcation (SECSI
2008). ECRYPT, 2008.
[10] Stephen C. Bono, Matthew Green, Adam Stubble-
ﬁeld, Ari Juels, Aviel D. Rubin, and Michael
Szydlo. Security analysis of a cryptographically-
enabled RFID device.
In 14th USENIX Security
Symposium (USENIX Security 2005), pages 1–16.
USENIX Association, 2005.
[11] Johan Borst, Bart Preneel, Joos Vandewalle, and
Joos V. On the time-memory tradeoff between ex-
haustive key search and table precomputation. In
19th Symposium in Information Theory in the Be-
nelux, pages 111–118, 1998.
[12] Nicolas T. Courtois. The dark side of security by
obscurity - and cloning MIFARE Classic rail and
building passes, anywhere, anytime. In 4th Inter-
national Conference on Security and Cryptography
(SECRYPT 2009), pages 331–338. INSTICC Press,
2009.
[13] Nicolas T. Courtois, Gregory V. Bard, and David
Wagner. Algebraic and slide attacks on Kee-
Loq. In 15th International Workshop on Fast Soft-
ware Encryption (FSE 2000), volume 5086 of Lec-
ture Notes in Computer Science, pages 97–115.
Springer-Verlag, 2008.
14
[14] Nicolas T. Courtois, Sean O’Neil, and Jean-Jacques
Quisquater.
Practical algebraic attacks on the
Hitag2 stream cipher. In 12th Information Secur-
ity Conference (ISC 2009), volume 5735 of Lec-
ture Notes in Computer Science, pages 167–176.
Springer-Verlag, 2009.
[23] Flavio D. Garcia, Peter van Rossum, Roel Ver-
dult, and Ronny Wichers Schreur. Dismantling Se-
cureMemory, CryptoMemory and CryptoRF.
In
17th ACM Conference on Computer and Commu-
nications Security (CCS 2010), pages 250–259.
ACM/SIGSAC, 2010.
[15] Joan Daemen and Vincent Rijmen. The Design of
Rijndael: AES - The Advanced Encryption Stand-
ard. Springer-Verlag, 2002.
[16] Gerhard de Koning Gans, Jaap-Henk Hoepman,
and Flavio D. Garcia. A practical attack on the MI-
FARE Classic. In 8th Smart Card Research and Ad-
vanced Applications Conference (CARDIS 2008),
volume 5189 of Lecture Notes in Computer Sci-
ence, pages 267–282. Springer-Verlag, 2008.
[17] Federal Communications Commission
FCC.
Guidelines for evaluating the environmental effects
of radio frequency radiation. Technical report,
Federal Communications Commission FCC, April
2009.
[18] Aur´elien Francillon, Boris Danev, and Srdjan
ˇCapkun. Relay attacks on passive keyless entry
and start systems in modern cars. In 18th Network
and Distributed System Security Symposium (NDSS
2011). The Internet Society, 2011.
[19] Flavio D. Garcia, Gerhard de Koning Gans, Ruben
Muijrers, Peter van Rossum, Roel Verdult, Ronny
Wichers Schreur, and Bart Jacobs. Dismantling MI-
FARE Classic.
In 13th European Symposium on
Research in Computer Security (ESORICS 2008),
volume 5283 of Lecture Notes in Computer Sci-
ence, pages 97–114. Springer-Verlag, 2008.
[20] Flavio D. Garcia, Gerhard de Koning Gans, and
Roel Verdult. Exposing iClass key diversiﬁcation.
In 5th USENIX Workshop on Offensive Technolo-
gies (USENIX WOOT 2011), pages 128–136, San
Francisco, CA, USA, 2011. USENIX Association.
[21] Flavio D. Garcia, Gerhard de Koning Gans, Roel
Verdult, and Milosch Meriac. Dismantling iClass
and iClass Elite. In 17th European Symposium on
Research in Computer Security (ESORICS 2012),
Lecture Notes in Computer Science. Springer-
Verlag, 2012.
[24] Gerhard P. Hancke. Practical attacks on proximity
identiﬁcation systems (short paper). In 27th IEEE
Symposium on Security and Privacy (S&P 2006),
pages 328–333. IEEE Computer Society, 2006.
[25] Martin E. Hellman. A cryptanalytic time-memory
trade-off. IEEE Transactions on Information The-
ory, 26(4):401–406, 1980.
[26] Motoki Hirano, Mikio Takeuchi, Takahisa Tomoda,
and Kin-Ichiro Nakano. Keyless entry system with
radio card transponder. IEEE Transactions on In-
dustrial Electronics, 35:208–216, 1988.
[27] Sebastiaan Indesteege, Nathan Keller, Orr Dunkel-
mann, Eli Biham, and Bart Preneel. A prac-
tical attack on KeeLoq.
In 27th International
Conference on the Theory and Application of
Cryptographic Techniques, Advances in Crypto-
logy (EUROCRYPT 2008), volume 4965 of Lecture
Notes in Computer Science, pages 1–8. Springer-
Verlag, 2008.
[28] Markus Kasper, Timo Kasper, Amir Moradi, and
Christof Paar. Breaking KeeLoq in a ﬂash: on
extracting keys at lightning speed.
In 2nd In-
ternational Conference on Cryptology in Africa,
Progress in Cryptology (AFRICACRYPT 2009),
volume 5580 of Lecture Notes in Computer Sci-
ence, pages 403–420. Springer-Verlag, 2009.
[29] Keyline. Transponder guide. http://www.keyline.it/
ﬁles/884/transponder guide 16729.pdf, 2012.
[30] Ziv Kﬁr and Avishai Wool. Picking virtual pockets
using relay attacks on contactless smartcard. In 1st
International Conference on Security and Privacy
for Emerging Areas in Communications Networks
(SecureComm 2005), pages 47–58. IEEE Computer
Society, 2005.
[22] Flavio D. Garcia, Peter van Rossum, Roel Verdult,
and Ronny Wichers Schreur. Wirelessly pickpock-
eting a mifare classic card.
In 30th IEEE Sym-
posium on Security and Privacy (S&P 2009), pages
3–15. IEEE Computer Society, 2009.
[31] Ilan Kirschenbaum and Avishai Wool. How to
build a low-cost, extended-range RFID skimmer.
In 15th USENIX Security Symposium (USENIX Se-
curity 2006), pages 43–57. USENIX Association,
2006.
15
[32] Kerstin Lemke, Ahmad-Reza Sadeghi, and Chris-
tian Stble. An open approach for designing se-
cure electronic immobilizers. In Information Secur-
ity Practice and Experience (ISPEC 2005), volume
3439 of Lecture Notes in Computer Science, pages
230–242. Springer-Verlag, 2005.
[42] Mate Soos, Karsten Nohl, and Claude Castelluc-
cia. Extending SAT solvers to cryptographic prob-
lems.
In 12th International Conference on The-
ory and Applications of Satisﬁability Testing (SAT
2009), volume 5584 of Lecture Notes in Computer
Science, pages 244–257. Springer-Verlag, 2009.
[43] Frank Stajano and Ross J. Anderson. The resurrect-
ing duckling: Security issues for ad-hoc wireless
networks.
In 7th International Workshop on Se-
curity Protocols (WSP 2000), volume 1796 of Lec-
ture Notes in Computer Science, pages 172–182.
Springer-Verlag, 2000.
[44] Siwei Sun, Lei Hu, Yonghong Xie, and Xiangyong
Zeng. Cube cryptanalysis of Hitag2 stream cipher.
In 10th International Conference on Cryptology
and Network Security (CANS 2011), volume 7092
of Lecture Notes in Computer Science, pages 15–
25. Springer-Verlag, 2011.
[45] Petr ˇStembera and Martin Novotn´y. Breaking
Hitag2 with reconﬁgurable hardware. In 14th Eur-
omicro Conference on Digital System Design (DSD
2011), pages 558–563. IEEE Computer Society,
2011.
[46] Pang-Chieh Wang, Ting-Wei Hou, Jung-Hsuan Wu,
and Bo-Chiuan Chen. A security module for car ap-
pliances. International Journal of World Academy
Of Science, Engineering and Technology, 26:155–
160, 2007.
[47] I.C. Wiener.
Philips/NXP
Hitag2
PCF7936/46/47/52
reference
implementation. http://cryptolib.com/ciphers/hitag2/,
2007.
stream cipher
[48] Marko Wolf, Andre Weimerskirch, and Thomas
Wollinger. State of the art: Embedding security in
vehicles. EURASIP Journal on Embedded Systems,
2007:074706, 2007.
[49] Jung-Hsuan Wu, Chien-Chuan Kung, Jhan-Hao
Rao, Pang-Chieh Wang, Cheng-Liang Lin, and
Ting-Wei Hou. Design of an in-vehicle anti-theft
component. In 8th International Conference on In-
telligent Systems Design and Applications (ISDA
2008), volume 1, pages 566–569. IEEE Computer
Society, 2008.
[33] Kerstin Lemke, Ahmad-Reza Sadeghi, and Chris-
tian St¨uble. Anti-theft protection: Electronic im-
mobilizers. Embedded Security in Cars, pages 51–
67, 2006.
[34] Karsten Nohl. Immobilizer security. In 8th Inter-
national Conference on Embedded Security in Cars
(ESCAR 2010), 2010.
[35] Karsten Nohl, David Evans, Starbug, and Henryk
Pl¨otz. Reverse engineering a cryptographic RFID
tag. In 17th USENIX Security Symposium (USENIX
Security 2008), pages 185–193. USENIX Associ-
ation, 2008.
[36] Transponder IC, Hitag2. Product Data Sheet, Nov
2010. NXP Semiconductors.
[37] Hitag pro. Product Data Sheet, 2011. NXP Semi-
conductors.
[38] Philippe Oechslin. Making a faster cryptana-
lytic time-memory trade-off. In 23rd International
Cryptology Conference, Advances in Cryptology
(CRYPTO 2003), volume 2729 of Lecture Notes
in Computer Science, pages 617–630. Springer-
Verlag, 2003.
[39] Security transponder plus remote keyless entry –
Hitag2 plus, PCF7946AT. Product Proﬁle, Jun
1999. Philips Semiconductors.
[40] Amir Rahmati, Mastooreh Salajegheh, Dan Hol-
comb, Jacob Sorber, Wayne P. Burleson, and Kevin
Fu.
TARDIS: Time and remanence decay in
SRAM to implement secure protocols on embed-
ded devices without clocks. In 21st USENIX Secur-
ity Symposium (USENIX Security 2012). USENIX
Association, 2012.
[41] Andrew Rukhin, Juan Soto, James Nechvatal,
Miles Smid, Elaine Barker, Stefan Leigh, Mark
Levenson, Mark Vangel, David Banks, Alan Heck-
ert, James Dray, and San Vo. A statistical test
suite for the validation of random number generat-
ors and pseudo random number generators for cryp-
tographic applications. NIST Special Publication,
pages 800–822, 2001.
16