![](media/image1.png)![](media/image7.png)![](media/image9.jpeg)![](media/image17.jpeg)![](media/image19.png)![](media/image20.png)![](media/image22.png)![](media/image24.jpeg)![](media/image27.png)![](media/image31.png)![](media/image35.png)![](media/image36.jpeg)![](media/image38.png)![](media/image39.png)![](media/image40.png)![](media/image41.png)![](media/image42.png)![](media/image43.png)![](media/image44.png)![](media/image45.png)![](media/image46.png)![](media/image47.png)![](media/image48.png)![](media/image49.png)![](media/image50.png)![](media/image51.png)
> ![](media/image52.png)
>
> ![](media/image53.png)
>
> ![](media/image54.jpeg)
>
> ![](media/image55.png)
>
> ![](media/image56.jpeg)
>
> ![](media/image57.jpeg)
## Hands-On Red Team Tactics
> A practical guide to mastering Red Team operations
[]{#_bookmark1 .anchor}Himanshu Sharma Harpreet Singh
> ![](media/image58.jpeg)
## BIRMINGHAM - MUMBAI
> []{#_bookmark2 .anchor}**Hands-On Red Team Tactics**
>
> Copyright Â© 2018 Packt Publishing All rights reserved. No part of this
> book may be reproduced, stored in a retrieval system, or transmitted
> in any form or by any means, without the prior written permission of
> the publisher, except in the case of brief quotations embedded in
> critical articles or reviews.
>
> Every effort has been made in the preparation of this book to ensure
> the accuracy of the information presented. However, the information
> contained in this book is sold without warranty, either express or
> implied. Neither the authors, nor Packt Publishing or its dealers and
> distributors, will be held liable for any damages caused or alleged to
> have been caused directly or indirectly by this book.
>
> Packt Publishing has endeavored to provide trademark information about
> all of the companies and products mentioned in this book by the
> appropriate use of capitals. However, Packt Publishing cannot
> guarantee the accuracy of this information.
>
> **Commissioning Editor:** Vijin Boricha **Acquisition Editor:** Rohit
> Rajkumar **Content Development Editor:** Ronn Kurien **Technical
> Editor:** Prachi Sawant
>
> **Copy Editor:** Safis Editing
>
> **Project Coordinator:** Jagdish Prabhu
>
> **Proofreader:** Safis Editing **Indexer:** Tejal Daruwale Soni
> **Graphics:** Tom Scaria
>
> **Production Coordinator:** Deepika Naik First published: September
> 2018 Production reference: 1270918
>
> Published by Packt Publishing Ltd. Livery Place
>
> 35 Livery Street Birmingham
>
> B3 2PB, UK.
>
> ISBN 978-1-78899-523-8
>
> [www.packtpub.com](http://www.packtpub.com/)
>
> []{#_bookmark3 .anchor}![](media/image59.jpeg)
>
> [mapt.io](https://mapt.io/)
>
> Mapt is an online digital library that gives you full access to over
> 5,000 books and videos, as well as industry leading tools to help you
> plan your personal development and advance your career. For more
> information, please visit our website.
# Why subscribe?
> Spend less time learning and more time coding with practical eBooks
> and Videos from over 4,000 industry professionals
>
> Improve your learning with Skill Plans built especially for you
>
> Get a free eBook or video every month
>
> Mapt is fully searchable
>
> Copy and paste, print, and bookmark content
# Packt.com
> Did you know that Packt offers eBook versions of every book published,
> with PDF and ePub files available? You can upgrade to the eBook
> version at [www.packt. com and as a print book customer, you are
> entitled to a discount on the eBook](http://www.packt.com/) copy. Get
> in touch with us at  for more details.
>
> At [www.packt.com](http://www.packt.com/), you can also read a
> collection of free technical articles, sign up for a range of free
> newsletters, and receive exclusive discounts and offers on Packt books
> and eBooks.
# Contributors
> []{#_bookmark7 .anchor}**About the authors**
>
> **Himanshu Sharma** has already achieved fame for finding security
> loopholes and vulnerabilities in Apple, Google, Microsoft, Facebook,
> Adobe, Uber, AT&T, Avira, and many more with hall of fame listings. He
> has helped celebrities such as Harbhajan Singh in recovering their
> hacked accounts, and also assisted an international singer in
> recovering his hacked accounts. He was a speaker at the international
> conference Botconf \'13, CONFidence 2018 and RSA Singapore
>
> 2018\. He also spoke at IEEE Conference as well as for TedX.
> Currently, he is the cofounder of BugsBounty, a crowd-sourced security
> platform.
>
> **Harpreet Singh** has more than 5 years experience in the field of
> Ethical Hacking, Penetration Testing, and Red Teaming. In addition, he
> has performed red team engagement in multi-national banks and
> companies. Harpreet is a Offensive Security Certified Professional
> (OSCP) and Offensive Security Wireless Professional (OSWP). He has
> trained 1500+ students including Govt. officials in International
> projects.
# About the reviewers
> **Nipun Jaswal** is an International Cyber Security Author and an
> award-winning IT security researcher with a decade of experience in
> penetration testing, vulnerability assessments, surveillance and
> monitoring solutions, and RF and wireless hacking.
>
> He has authored Metasploit Bootcamp, Mastering Metasploit, and
> Mastering Metasploit---Second Edition, and coauthored the Metasploit
> Revealed set of books. He has authored numerous articles and exploits
> that can be found on popular security databases, such as packet storm
> and exploit-db. Please feel free to contact him at \@nipunjaswal.
>
> **Ashwin Iyer** is an M.Tech Graduate in Information Security and
> Computer Forensics with more than 5 years of experience in Cyber
> Security and earned a bachelor\'s degree in computer science. He has
> exposure to penetration testing and infrastructure security.
>
> He is currently working at SAP ARIBA, as a Red Team Lead. He has
> experience in Infrastructure Security, Harden the underlying
> technology / OS / Device. He is also experienced in web and network
> pentest---both e-commerce and software product domains.
>
> He has got professional certifications in GIAC GSEC #35151 (SANS),
> OSCP Certified OS-13175, ISO 27001:2013, ITILv3 2011 Foundation,
> Certified Ethical Hacker (CEHv7), CISRA.
# Packt is searching for authors like you
> If you\'re interested in becoming an author for Packt, please visit
> [authors.packtpub.c om and apply today. We have worked with thousands
> of developers and tech](http://authors.packtpub.com/) professionals,
> just like you, to help them share their insight with the global tech
> community. You can make a general application, apply for a specific
> hot topic that we are recruiting an author for, or submit your own
> idea.
# Table of Contents
> [Title Page](#hands-on-red-team-tactics)
>
> [Copyright and Credits](#_bookmark1)
>
> [Hands-On Red Team Tactics](#_bookmark2) [Packt Upsell](#_bookmark3)
>
> [Why subscribe?](#why-subscribe) [Packt.com](#packt.com)
>
> [Contributors](#contributors)
>
> [About the authors](#_bookmark7) [About the
> reviewers](#about-the-reviewers)
>
> [Packt is searching for authors like
> you](#packt-is-searching-for-authors-like-you) [Preface](#preface)
>
> [Who this book is for](#who-this-book-is-for) [What this book
> covers](#what-this-book-covers)
>
> [To get the most out of this book](#to-get-the-most-out-of-this-book)
> [Download the color images](#download-the-color-images) [Conventions
> used](#conventions-used)
>
> [Get in touch](#get-in-touch)
>
> [Reviews](#reviews) [Disclaimer](#disclaimer)
1.  [Red-Teaming and Pentesting](#red-teaming-and-pentesting)
> [Pentesting 101](#pentesting-101)
>
> [OWASP](#owasp)
>
> [Open Source Security Testing Methodology
> Manual&#xA0;(OSSTMM)](#open-source-security-testing-methodology-manual-osstmm)
>
> [Information Systems Security Assessment Framework
> (ISSAF)](#information-systems-security-assessment-framework-issaf)
> [Penetration Testing Execution Standard
> (PTES)](#penetration-testing-execution-standard-ptes)
>
> [Pre-engagement interactions](#pre-engagement-interactions)
> [Intelligence gathering](#intelligence-gathering) [Threat
> modeling](#threat-modeling) [Vulnerability
> analysis](#vulnerability-analysis) [Exploitation](#exploitation)
>
> [Post-exploitation](#post-exploitation) [Reporting](#reporting)
>
> [A different approach](#a-different-approach)
> [Methodology](#methodology)
>
> [How is it different?](#how-is-it-different)
>
> [Summary](#summary) [Questions](#questions) [Further
> reading](#further-reading)
2.  [Pentesting 2018](#pentesting-2018)
> [Technical requirements](#technical-requirements) [MSFvenom Payload
> Creator](#msfvenom-payload-creator)
>
> [Resource file](#resource-file) [Koadic](#koadic)
>
> [Installation](#installation)
>
> [Why use MSHTA as the dropper
> payload?](#why-use-mshta-as-the-dropper-payload)
> [Terminology](#terminology)
>
> [Stager establishment](#stager-establishment) [Payload
> execution](#payload-execution) [Running Implants](#running-implants)
>
> [Pivoting](#pivoting) [Summary](#summary-1) [Questions](#questions-1)
> [Further reading](#further-reading-1)
3.  [Foreplay - Metasploit Basics](#foreplay---metasploit-basics)
> [Technical requirements](#technical-requirements-1) [Installing
> Metasploit](#installing-metasploit) [Running Metasploit](#_bookmark56)
>
> [Auxiliaries](#auxiliaries) [Exploits](#exploits)
> [Payloads](#payloads) [Encoders](#encoders)
> [Meterpreter](#meterpreter)
>
> [Armitage and team server](#armitage-and-team-server) [Metasploit with
> slack](#metasploit-with-slack) [Armitage and Cortana
> scripts](#armitage-and-cortana-scripts) [Summary](#summary-2)
>
> [Questions](#questions-2) [Further reading](#further-reading-2)
4.  [Getting Started with Cobalt
    > Strike](#getting-started-with-cobalt-strike)
> [Technical requirements](#technical-requirements-2) [Planning a
> red-team exercise](#planning-a-red-team-exercise)
>
> [Cyber kill chain (CKC)](#cyber-kill-chain-ckc)
> [Reconnaissance](#reconnaissance) [Weaponization](#weaponization)
> [Delivery](#delivery)
>
> [Exploitation](#exploitation-1) [Installation](#installation-1)
>
> [Command and Control Server](#command-and-control-server)
> [Actions](#actions)
>
> [Objective and goal](#objective-and-goal)
>
> [Rules of Engagement (RoE)](#rules-of-engagement-roe)
> [Scenario/strategy](#scenariostrategy) [Deliverables](#deliverables)
>
> [Introduction to Cobalt Strike](#introduction-to-cobalt-strike) [What
> is a team server?](#what-is-a-team-server)
>
> [Cobalt Strike setup](#cobalt-strike-setup) [Cobalt Strike
> interface](#cobalt-strike-interface)
>
> [Toolbar](#toolbar)
>
> [Connecting to another team
> server](#connecting-to-another-team-server) [Disconnecting from the
> team server](#disconnecting-from-the-team-server) [Configure
> listeners](#configure-listeners)
>
> [Session graphs](#session-graphs) [Session table](#session-table)
> [Targets list](#targets-list) [Credentials](#credentials) [Downloaded
> files](#downloaded-files) [Keystrokes](#keystrokes)
> [Screenshots](#screenshots)
>
> [Payload generation&#xA0;&#x2013; stageless Windows
> executable](#payload-generation-stageless-windows-executable) [Payload
> generation&#xA0;&#x2013; Java signed
> applet](#payload-generation-java-signed-applet)
>
> [Payload generation&#xA0;&#x2013; MS Office
> macros](#payload-generation-ms-office-macros) [Scripted web
> delivery](#scripted-web-delivery)
>
> [File hosting](#file-hosting)
>
> [Managing the web server](#managing-the-web-server) [Server
> switchbar](#server-switchbar)
>
> [Customizing the team server](#customizing-the-team-server)
> [Summary](#summary-3)
>
> [Questions](#questions-3) [Further reading](#further-reading-3)
5.  [./ReverseShell](#reverseshell)
> [Technical requirement](#technical-requirement)
>
> [Introduction to reverse
> connections](#introduction-to-reverse-connections)
>
> [Unencrypted reverse connections using
> netcat](#unencrypted-reverse-connections-using-netcat) [Encrypted
> reverse connections using
> OpenSSL](#encrypted-reverse-connections-using-openssl)
>
> [Introduction to reverse shell
> connections](#introduction-to-reverse-shell-connections) [Unencrypted
> reverse shell using netcat](#unencrypted-reverse-shell-using-netcat)
>
> [Encrypted reverse shell for \*nix with OpenSSL packages
> installed](#encrypted-reverse-shell-for-nix-with-openssl-packages-installed)
> [Encrypted reverse shell using
> ncat](#encrypted-reverse-shell-using-ncat)
>
> [Encrypted reverse shell using
> socat](#encrypted-reverse-shell-using-socat) [Encrypted reverse shell
> using cryptcat](#encrypted-reverse-shell-using-cryptcat) [Reverse
> shell using powercat](#reverse-shell-using-powercat)
>
> [reverse_tcp](#reverse_tcp) [reverse_tcp_rc4](#reverse_tcp_rc4)
> [reverse_https](#reverse_https)
>
> [reverse_https with a custom SSL
> certificate](#reverse_https-with-a-custom-ssl-certificate)
> [Meterpreter over ngrok](#meterpreter-over-ngrok)
>
> [Reverse shell cheat sheet](#reverse-shell-cheat-sheet) [Bash reverse
> shell](#bash-reverse-shell)
>
> [Zsh reverse shell](#_bookmark128) [TCLsh/wish reverse
> shell](#tclshwish-reverse-shell) [Ksh reverse
> shell](#ksh-reverse-shell)
>
> [Netcat reverse shell](#netcat-reverse-shell) [Telnet reverse
> shell](#telnet-reverse-shell) [(G)awk reverse
> shell](#awk-reverse-shell) [R reverse shell](#r-reverse-shell) [Python
> reverse shell](#python-reverse-shell) [Perl reverse
> shell](#perl-reverse-shell) [Ruby reverse shell](#ruby-reverse-shell)
> [Php reverse shell](#php-reverse-shell) [Lua reverse
> shell](#lua-reverse-shell) [Nodejs reverse shell](#_bookmark140)
>
> [Powershell reverse shell](#_bookmark141) [Socat reverse shell over
> TCP](#socat-reverse-shell-over-tcp) [Socat reverse shell over
> UDP](#socat-reverse-shell-over-udp)
>
> [Socat reverse shell over SSL (cert.pem is the custom certifica
> te)](#_bookmark144)
>
> [Summary](#summary-4) [Questions](#questions-4) [Further
> reading](#further-reading-4)
6.  [Pivoting](#pivoting-1)
> [Technical requirements](#technical-requirements-3) [Pivoting via
> SSH](#pivoting-via-ssh) [Meterpreter port
> forwarding](#meterpreter-port-forwarding) [Pivoting via
> Armitage](#pivoting-via-armitage)
>
> [Multi-level pivoting](#multi-level-pivoting)
>
> [Summary](#summary-5)
>
> [Further reading](#further-reading-5)
7.  [Age of Empire - The Beginning](#age-of-empire---the-beginning)
> [Technical requirements](#technical-requirements-4) [Introduction to
> Empire](#introduction-to-empire)
>
> [Empire setup and installation](#empire-setup-and-installation)
> [Empire fundamentals](#empire-fundamentals)
>
> [Phase 1 &#x2013; Listener Initiation](#phase-1-listener-initiation)
> [Phase 2 &#x2013; Stager Creation](#phase-2-stager-creation) [Phase 3
> &#x2013; Stager Execution](#phase-3-stager-execution) [Phase 4
> &#x2013; Acquiring Agent](#phase-4-acquiring-agent)
>
> [Phase 5 &#x2013; Post Module
> Operations](#phase-5-post-module-operations) [Empire post exploitation
> for Windows](#empire-post-exploitation-for-windows)
>
> [Empire post exploitation for
> Linux](#empire-post-exploitation-for-linux) [Empire post exploitation
> for OSX](#empire-post-exploitation-for-osx)
>
> [Popping up a Meterpreter session using
> Empire](#popping-up-a-meterpreter-session-using-empire) [Slack
> notification for Empire agents](#_bookmark170)
>
> [Summary](#summary-6) [Questions](#questions-5) [Further
> reading](#further-reading-6)
8.  [Age of Empire - Owning Domain
    > Controllers](#age-of-empire---owning-domain-controllers)
> [Getting into a Domain Controller using
> Empire](#getting-into-a-domain-controller-using-empire)
>
> [Automating Active Directory exploitation using the
> DeathStar](#automating-active-directory-exploitation-using-the-deathstar)
> [Empire GUI](#empire-gui)
>