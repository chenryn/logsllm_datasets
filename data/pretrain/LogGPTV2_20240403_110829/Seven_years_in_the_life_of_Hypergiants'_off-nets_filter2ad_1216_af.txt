05001000Total #ASes0500100015002000250030003500400045005000Total number of ASes2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-04100.0%100.0%100.0%100.0%99.9%99.9%99.9%99.4%98.0%97.7%97.7%97.6%97.6%97.4%97.7%97.0%96.8%96.7%96.9%96.7%97.2%97.0%96.3%96.3%96.3%96.2%96.0%95.7%97.2%95.7%96.0%1 top-4 HG2 top-4 HGs3 top-4 HGs4 top-4 HGsSIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
P. Gigis et al.
important role in future services, including 5G. The extended serv-
ing infrastructure can also better deal with increased traffic, e.g.,
during the COVID-19 pandemic [43], as was reported recently by
Google [56] and Akamai [70]. At the same time, these deployments
mean that a substantial fraction of traffic demand can be served
locally without crossing inter-domain links or private interconnec-
tions [81, 86, 90, 111, 113, 114]. This “zero AS-hop” Internet has
regulatory implications. Servers which are located inside a network
to exclusively serve users of that network, e.g., IPTV, “private” CDN
clusters, can be considered specialized services [68]. In this setting,
it is debatable if network neutrality regulations apply [100], since
exceptions may be granted for such specialized services.
When ISPs allow the deployment of servers within their net-
work, they can lose negotiation power in peering agreements with
HGs, because the servers reduce the amount of traffic traversing
peering interconnections [69, 73, 107]. Smaller networks may see
an opportunity to host such servers and reduce their upstream or
downstream traffic, thus improving the service they offer to their
customers and reducing upstream provider cost and reliance (in-
creasingly bypassing the public Internet) [40, 64, 68]. Nevertheless,
HGs and ISPs have to negotiate who will cover the operational cost
of hosting content servers (power, bandwidth, maintenance), that
can be another source of dispute.
Unintended Consequences. Widespread adoption of TLS– in-
tended to protect users’ privacy and support secure protocols – had
the unintended consequence of providing the basis for revealing
HGs’ footprints. Our study shows that it is feasible to infer HGs’
off-net footprint, using only publicly available data. We view this
outcome as important to understand the dynamics that underpin
the phenomenal growth of network traffic and shape the Inter-
net’s topology, but this information may have other uses – some
less benign. First, knowledge of the network locations and IP ad-
dresses of HG servers makes it easier for attackers to be effective.
They can use this information to better orchestrate DDoS attacks
or target specific servers that deal with critical services or have
high financial interest for them. Servers that are deployed outside
HG networks may be more vulnerable to attacks, as the security
measures and available capacity may not meet the standards of
HG datacenters. Authoritarian regimes can also collect intelligence
about deployments in their countries or in other countries for their
benefit, such as for surveillance purposes. Second, knowledge of
HGs’ off-net footprints can be utilized for business intelligence by
competitors. Knowing where servers are deployed is considered a
business secret, as competitors may decide to place their servers in
the same location or not to achieve their own strategic objectives.
It also allows for inference of deployment and expansion strategies
of HGs over time, which could inform investment decisions and
planning of competitors. It can also provide the opportunity to new
cloud providers to expand and prioritize their server deployment
in a more optimized way.
Hide-and-Seek. HGs may want to hide their footprints from our
detection methodology for confidentiality and security reasons.
There are a number of possible approaches:
(1) Increasing the bar for deployment identification is rather
simple: the default certificate should not disclose information, e.g.,
by setting a null certificate, and the certificate should be presented
only when there is a TLS-SNI request for specific domains. These
changes would make existing datasets (e.g., Rapid7) less suitable to
our methodology, but they are surmountable at the cost of increased
measurement overhead with global scans for fully qualified SNI
domains. In our study, we noticed two cases where the null default
certificates hamper our detection methodology. One is the case
of Netflix between 2017-04 and 2019-10, when a large number of
Netflix servers identifiable by certificate due to use of HTTP (not
HTTPS). The second case are on-net servers of Google, which
only answer TLS-SNI requests for specific first-party domains (e.g.
www.google.com).
(2) HGs could instruct off-net servers to respond only to requests
originated by the customer cone of the hosting network, although
the risk of blackholing legitimate traffic may not be worthwhile.
(3) HGs can modify their certificate content by altering fields
that we currently use to infer ownership and to extract fingerprints.
For example, remove the Organization entry from the Subject
Name of the EE certificate or use unique domain names per off-net
deployment.
(4) Anonymizing headers or using bot-detection to exclude head-
ers also helps in hiding the identity of HGs’ off-nets, as it blinds
our validation technique. However, headers are commonly used for
debugging, so removing them may increase diagnostic complexity
for operators.
(5) IPv6-only HG servers would be invisible to IPv4 global In-
ternet scans used by Censys and Rapid7 but increases the risk of
outages for IPv4-only clients.
Our methodology relies on the fact that HGs include company
information in their TLS certificates to help establish their identifies
to users. Despite these possible approaches, we expect that the
central idea behind our methodology will continue to work, as HGs
will always need to provide organizational information to prove
their identity.
9 CONCLUSION
Hypergiants are responsible for a significant fraction of the traffic
delivered to end users, and they contributed to the notable consoli-
dation and privatization of Internet infrastructure. HGs have been
expanding their infrastructures towards and into eyeball networks,
including via off-net servers inside those networks, to be as close
as possible to the end users. However, as these Hypergiants grew
in importance, their serving infrastructures become less and less
visible to traditional measurement techniques, and mapping their
expansions was an unmet challenge. In this work, we developed a
generic methodology to measure their expansion, leveraging more
than 7 years (2013-2021) worth of information extracted from cor-
puses of TLS certificate scans and other active measurements. We
observe that the number of ASes hosting HGs’ off-nets has more
than doubled during this period, with the vast majority of them
hosting at least one of the top-4 HG (Google, Netflix, Facebook, and
Akamai), and tending to host more of them over time. Recently,
growth has been particularly fast in Europe, Asia, and, especially,
Latin America. Consequently, these large Hypergiants can serve
large fractions of the world’s Internet users directly from within the
users’ networks. Our study opens interesting research directions
on Internet privatization, content delivery, and security practices.
527
Seven Years in the Life of Hypergiants’ Off-Nets
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
ACKNOWLEDGEMENT
We would like to thank our shepherd, Olivier Bonaventure and the
anonymous reviewers for their valuable feedback. We also greatly
appreciate the Hypergiant operators who validated our results. We
are grateful to Rapid7 [87] and Censys [36] for providing us research
access to their datasets. This work and its dissemination efforts
are partially supported by the European Research Council (ERC)
Starting Grant ResolutioNet (ERC-StG-679158) and by NSF awards
CNS-1836872 and CNS-2028550.
REFERENCES
[1] Josh Aas, Richard Barnes, Benton Case, Zakir Durumeric, Peter Eckersley, Alan
Flores-López, J. Alex Halderman, Jacob Hoffman-Andrews, James Kasten, Eric
Rescorla, Seth Schoen, and Brad Warren. 2019. Let’s Encrypt: An Automated
Certificate Authority to Encrypt the Entire Web. (2019).
[2] Vijay Kumar Adhikari, Sourabh Jain, Yingying Chen, and Zhi-Li Zhang. 2012.
[3] Bernhard Ager, Wolfgang Mühlbauer, Georgios Smaragdakis, and Steve Uhlig.
Vivisecting Youtube: An Active Measurement Study. In IEEE INFOCOM.
2011. Web Content Cartography. In ACM IMC.
figures.jsp.
[4] Akamai. 2020. Facts & Figures. https://www.akamai.com/us/en/about/facts-
[5] Akamai. 2021.
EdgeWorkers User Guide: 500 Internal Server er-
ror. https://learn.akamai.com/en-us/webhelp/edgeworkers/edgeworkers-user-
guide/GUID-04E378BA-DBD2-40F9-91BB-912E0FFFD2A4.html.
[6] Alibaba. 2020. Alibaba Cloud: EdgeScript. https://static-aliyun-doc.oss-cn-
hangzhou.aliyuncs.com/download%2Fpdf%2F126597%2FEdgeScript_intl_en-
US.pdf.
[7] Alibaba. 2021. Alibaba Cloud CDN. https://www.alibabacloud.com/product/cdn.
[8] Amazon.
https://docs.
CloudFront Developer Guide.
2021.
aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/
RequestAndResponseBehaviorCustomOrigin.html.
[9] Amazon. 2021. Configure connection draining for your Classic Load Bal-
ancer. https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/config-
conn-drain.html.
[10] Todd Arnold, Ege Gurmericliler, Georgia Essig, Arpit Gupta, Matt Calder,
Vasileios Giotsas, and Ethan Katz-Bassett. 2020. (How Much) Does a Private
WAN Improve Cloud Performance?. In IEEE INFOCOM.
[11] Todd Arnold, Jia He, Weifan Jiang, Matt Calder, Italo Cunha, Vasileios Giotsas,
and Ethan Katz-Bassett. 2020. Cloud Provider Connectivity in the Flat Internet.
In ACM IMC.
[12] Shehar Bano, Philipp Richter, Mobin Javed, Srikanth Sundaresan, Zakir Du-
rumeric, Steven J. Murdoch, Richard Mortier, and Vern Paxson. 2018. Scanning
the Internet for Liveness . ACM CCR 48, 2 (2018).
[13] Anurag Bhatia. 2018. Mapping Facebook’s FNA (CDN) nodes across the
world! https://anuragbhatia.com/2018/03/networking/isp-column/mapping-
facebooks-fna-cdn-nodes-across-the-world/.
[14] Anurag Bhatia. 2019. Facebook FNA node update. https://anuragbhatia.com/
2019/11/networking/isp-column/facebook-fna-node-update/.
[15] Anurag Bhatia. 2021. Facebook FNA updates – April 2021. https://anuragbhatia.
com/2021/04/networking/isp-column/facebook-fna-updates-april-2021/.
[16] Zachary S. Bischof, Romain Fontugne, and Fabian E. Bustamante. 2018. Untan-
gling the world-wide mesh of undersea cables. In HotNets.
[17] Timm Böttger, Felix Cuadrado, Gareth Tyson, Ignacio Castro, and Steve Uhlig.
2018. Open Connect everywhere: A glimpse at the internet ecosystem through
the lens of the Netflix CDN. CCR 48, 1 (2018).
[18] Timm Böttger, Felix Cuadrado, Gareth Tyson, Ignacio Castro, and Steve Uhlig.
2018. Open Connect Everywhere: A Glimpse at the Internet Ecosystem through
the Lens of the Netflix CDN. ACM SIGCOMM Computer Communication Review
48, 1 (2018), 28–34.
[19] Timm Böttger, Felix Cuadrado, and Steve Uhlig. 2018. Looking for Hypergiants
[22] Matt Calder, Xun Fan, Zi Hu, Ethan Katz-Bassett, John Heidemann, and Ramesh
Govindan. 2013. Mapping the Expansion of Google’s Serving Infrastructure. In
ACM IMC.
[23] Matt Calder, Ashley Flavel, Ethan Katz-Bassett, Ratul Mahajan, and Jitendra
Padhye. 2015. Analyzing the Performance of an Anycast CDN. In ACM IMC.
[24] Frank Cangialosi, Taejoong Chung, David Choffnes, Dave Levin, Bruce M.
Maggs, Alan Mislove, and Christo Wilson. 2016. Measurement and analysis of
private key sharing in the https ecosystem. In ACM CCS.
[20] CAIDA. 2013-2021. The CAIDA AS Organizations Dataset. http://www.caida.
[21] CAIDA. 2013-2021. The CAIDA AS Relationships Dataset. http://www.caida.
in PeeringDB. ACM CCR 48, 3 (2018).
org/data/as-organizations/.
org/data/active/as-relationships/.
[25] CDNetworks. 2021. HTTP Protocol Optimization.
https://documents.
cdnetworks.com/document/cate/16023/16281.
[26] Fangfei Chen, Ramesh K. Sitaraman, and Marcelo Torres. 2015. End-User Map-
ping: Next Generation Request Routing for Content Delivery. In ACM SIG-
COMM.
[27] Yingying Chen, Sourabh Jain, Vijay Kumar Adhikari, and Zhi-Li Zhang. 2011.
Characterizing roles of front-end servers in end-to-end performance of dynamic
content distribution. In IMC.
[28] Yi-Ching Chiu, Brandon Schlinker, Abhishek Balaji Radhakrishnan, Ethan Katz-
Bassett, and Ramesh Govindan. 2015. Are We One Hop Away from a Better
Internet?. In ACM IMC.
[29] Taejoong Chung, Yabing Liu, David Choffnes, Dave Levin, Bruce MacDowell
Maggs, Alan Mislove, and Christo Wilson. 2016. Measuring and applying invalid
SSL certificates: The silent majority. In ACM IMC.
2015. Characterizing IPv4 Anycast Adoption and Deployment. In CoNEXT.
https://support.cloudflare.com/hc/en-us/articles/203118044-Gathering-
information-for-troubleshooting-sites.
[30] Danilo Cicalese, Jordan Augé, Diana Joumblatt, Timur Friedman, and Dario Rossi.
Gathering information for
[31] Cloudflare. 2021.
troubleshooting sites.
[32] Craig Labovitz. 2019. Internet Traffic 2009-2019. APRICOT 2019.
[33] David Cooper, Stefan Santesson, Stephen Farrell, Sharon Boeyen, Russ Housley
and Tim Polk. 2008. Internet X.509 Public Key Infrastructure Certificate and
Certificate Revocation List (CRL) Profile - RFC-5280. https://tools.ietf.org/html/
rfc5280.
[34] Digicert. 2020. What fields are required when generating a Certificate Signing
Request (CSR)? https://knowledge.digicert.com/solution/SO16317.html.
[35] Donald Eastlake 3rd. 2011. Transport Layer Security (TLS) Extensions: Extension
Definitions. https://tools.ietf.org/html/rfc6066.
[36] Zakir Durumeric, David Adrian, Ariana Mirian, Michael Bailey, and J. Alex
Halderman. 2015. A Search Engine Backed by Internet-Wide Scanning. In CCS.
[37] Zakir Durumeric, Eric Wustrow, and J. Alex Halderman. 2013. ZMap: Fast
Internet-wide scanning and its security applications. In USENIX Security.
Introducing Proxygen, Facebook’s C++ HTTP Framework.
https://engineering.fb.com/2014/11/05/production-engineering/introducing-
proxygen-facebook-s-c-http-framework/.
[38] Facebook. 2014.
[39] Facebook. 2021. Graph API Debugging. https://developers.facebook.com/docs/
graph-api/using-graph-api/debugging/.
[40] Peyman Faratin, David D. Clark, Steven Bauer, William Lehr, Patrick Gilmore,
and Arthur Berger. 2008. The Growing Complexity of Internet Interconnection.