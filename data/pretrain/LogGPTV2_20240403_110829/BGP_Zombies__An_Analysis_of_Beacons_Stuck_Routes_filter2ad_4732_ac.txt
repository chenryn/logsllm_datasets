outbreaks, 45% of the IPv4 outbreaks have between 1 and 6 ASes.
By manually looking at the results we noticed certain patterns among out-
breaks. We hypothesize that the number of zombie ASes is usually related to
the importance of the transit networks aﬀected by zombies. To illustrate this
we select for each outbreak the most prominent transit network aﬀected by the
outbreak using global AS hegemony [8,12]. AS hegemony measures the central-
ity of an AS in the Internet, higher values standing for Tier-1 ISPs. Comparing
the size of outbreaks to the largest AS hegemony score of aﬀected ASes (Fig. 5b)
shows that small outbreaks consist only of edge networks (i.e. low AS hegemony)
and large transit networks belong only to the largest outbreaks.
Figure 6 illustrates two outbreaks where we detected zombies in large transit
networks. The left hand side graph (Fig. 6a) represents an outbreak where the
zombie AS with the highest hegemony score is Init7 and all ASes downstream are
also aﬀected by the outbreak. The right hand side graph (Fig. 6b) depicts another
outbreak where we inferred a zombie in a Tier-1 network, Level(3). As Level(3)’s
customer cone is larger the scope of the outbreak is also more important. This
results in about half of the RIS peers having zombie routes through Level(3).
BGP Zombies: An Analysis of Beacons Stuck Routes
207
Table 2. Top 5 aﬀected transit ASes for IPv4, IPv6, and each measurement period.
Each percentage is the number of outbreaks that include the AS divided by the total
number of outbreaks for the corresponding measurement period.
(a) IPv4
Mar./Apr. 2017
Oct./Dec. 2017
Jul./Aug. 2018
AS3303 Swisscom 46.13% AS6939 HE
14.84% AS6667 Elisa
AS12874 Fastweb 46.07% AS1103 SURFnet
9.90% AS680 DFN
AS8359 MTS
9.93% AS7575 AARNet
9.38% AS7018 AT&T
19.81%
17.69%
16.73%
AS680 DFN
9.18% AS286 KPN
9.38% AS3549 Level3 GBLX 15.96%
AS7018 AT&T
8.60% AS6453 TATA
9.11% AS7575 AARNet
15.19%
(b) IPv6
Mar./Apr. 2017
AS8455 Atom86
AS13030 Init7
Oct./Dec. 2017
AS13030 Init7
AS8455 Atom86
39%
39%
AS5580 Hibernia 36%
AS8928 Interoute
AS7018 AT&T
AS28917 Fiord
8%
6%
AS9002 RETN
Jul./Aug. 2018
AS13030 Init7
AS8455 Atom86
AS7018 AT&T
AS23106 CEMIG
57%
55%
36%
35%
74%
73%
15%
13%
13%
AS33891 Core-Backbone 22%
AS1916 RNP
In the absence of zombies we observe much less AS paths that contain Init7
or Level(3). This demonstrates again the role of path hunting in zombie propa-
gation. When a beacon is withdrawn and a zombie appears on a transit network,
downstream ASes are selecting that zombie path as other paths get discarded.
The frequency of zombies at transit networks is hence directly related to
the topological spread of zombie outbreaks reported earlier (Fig. 5a). In Table 2
we list transit networks that appeared the most in zombie outbreaks. We again
employ AS hegemony to focus only on large transit ASes, we arbitrarily picked
ASes with an hegemony higher than 0.001. For IPv4 the top-5 ASes vary signif-
icantly across the three measurement periods. For IPv6 we found that Init7 and
Atom86 are always the top two aﬀected networks. Our manual inspection of the
data reveals that Atom86 is downstream of Init7, so is aﬀected every time Init7
has zombies. Init7’s zombies usually propagate to 14 downstream ASes (exam-
ple shown in Fig. 6a), which explains the large number of outbreaks composed
of about 15 ASes in IPv6 in our results (Fig. 5a).
Network operators at Init7 acknowledged these issues with IPv6 routes, likely
due to misbehaving vendor software, and expressed the need for zombie report-
ing systems, as it creates customer complaints every few months. Mitigation of
the BGP zombies usually required the clearing of some Route Reﬂector iBGP
sessions within Init7’s network. Init7 operates its backbone using Extreme Net-
works MLXe (formerly known as Brocade MLXe) platform, which seems to be
uncommon. Upgrading to later ﬁrmware version did not resolve the problem.
Notice that we do not imply that detected outbreaks are caused by the transit
networks listed in Table 2. Finding the root cause of zombie outbreaks requires
additional measurements within these networks and their peers.
208
R. Fontugne et al.
5 Discussion
While detecting BGP zombies with RIS beacons is straightforward, we faced
signiﬁcant challenges in pinpointing the root cause of observed zombies. Given
the erratic patterns observed in our study and the investigations conducted with
network operators, we believe zombies are mainly the results of software bugs
in routers, BGP optimizers, and route reﬂectors. The systematic identiﬁcation
of zombie root causes on the Internet has proven to be very challenging, even
for operators, as it requires timely and detailed information from a complex
and occasionally misbehaving infrastructure. It is however a crucial challenge to
ensure that this issue will not cause an increasing amount of diﬃcult to debug
issues for network operators.
If the fraction of zombie routes in the wild is in the same order of magnitude as
what we see for RIS beacons, this can have interesting consequences that would
merit further research. For instance, in the case of large route leaks, zombie
routes could add signiﬁcantly to the complexity of mitigating these incidents.
Our study focuses only on RIS beacons as we know their withdraw times
a priori. However, these results cannot be easily extrapolated for any routed
preﬁx. We could infer zombies for cases where a preﬁx is withdrawn in a short
period of time for most, but not all route collector peers, and it remains diﬃcult
to distinguish this from a routing conﬁguration change intended to limit the
visibility of a preﬁx. Furthermore, in the case of large zombie outbreaks, which
are of prime interest, one may confuse the few observed withdraws with a local
routing issue. We plan to address these challenges in future works. A rigorous
method for detecting zombies in the wild would allow us to estimate the overall
impact of zombies on routing tables and to provide network operators with tools
to eﬀectively identify zombies.
6 Conclusions
In this paper, we investigated the emergence of BGP zombies with the help of
RIS beacons. Our study spans across a year and half of data and revealed that
BGP zombies are seen daily, although the scope of outbreaks is usually limited
to a small fraction of monitored ASes (on average 10% for IPv4 and 17% for
IPv6). We found almost no regularity in the appearance of zombies. They rarely
emerge synchronously on all monitored preﬁxes. Numerous zombie paths are
revealed during path hunting and the scope of an outbreak is usually related to
the aﬀected transit networks. Our future plans are to identify zombies for any
preﬁx announced on the Internet (i.e. not only beacon preﬁxes) and quantify the
impact of zombies in the wild. Finally, we make our tools and traceroute results
publicly available [1] in order to share our ﬁndings and assist researchers in their
zombie hunt.
BGP Zombies: An Analysis of Beacons Stuck Routes
209
References
1. BGP Zombie: Tools and Data. https://github.com/romain-fontugne/BGPzombies
SSL
2. Isolario Project. https://www.isolario.it/
3. RIPE NCC, Atlas. https://atlas.ripe.net
4. RIPE NCC, Current RIS Routing Beacons. https://www.ripe.net/analyse/inter
net-measurements/routing-information-service-ris/current-ris-routing-beacons
5. RIPE NCC, RIPEstat: BGP Looking Glass. https://stat.ripe.net/widget/looking-
glass
6. RIPE NCC, RIS Raw Data. https://www.ripe.net/analyse/internet-measuremen
ts/routing-information-service-ris/ris-raw-data
7. The RouteViews Project. http://www.routeviews.org/
8. AS Hegemony Results (2017). http://ihr.iijlab.net/ihr/hegemony/
9. Asturiano, V.: The Shape of a BGP Update. https://labs.ripe.net/Members/
vastur/the-shape-of-a-bgp-update
10. Avrachenkov, K., Gon¸calves, P., Legout, A., Sokol, M.: Classiﬁcation of content
and users in BitTorrent by semi-supervised learning methods. In: 8th International
Wireless Communications and Mobile Computing Conference (IWCMC), pp. 625–
630, August 2012
11. Avrachenkov, K., Mishenin, A., Gon¸calves, P., Sokol, M.: Generalized optimization
framework for graph-based semi-supervised learning. In: Proceedings of the 2012
SIAM International Conference on Data Mining, pp. 966–974 (2012)
12. Fontugne, R., Shah, A., Aben, E.: The (thin) bridges of AS connectivity: measuring
dependency using AS hegemony. In: Beverly, R., Smaragdakis, G., Feldmann, A.
(eds.) PAM 2018. LNCS, vol. 10771, pp. 216–227. Springer, Cham (2018). https://
doi.org/10.1007/978-3-319-76481-8 16
13. Luckie, M., Dhamdhere, A., Huﬀaker, B., Clark, D., Claﬀy, K.: bdrmap: Inference
of borders between IP networks. In: Proceedings of the 2016 Internet Measurement
Conference, IMC 2016, pp. 381–396. ACM, New York (2016)
14. Mao, Z.M., Bush, R., Griﬃn, T.G., Roughan, M.: BGP beacons. In: Proceedings
of the 3rd ACM SIGCOMM Conference on Internet Measurement, pp. 1–14. ACM
(2003)
15. Marder, A., Smith, J.M.: MAP-IT: multipass accurate passive inferences from
traceroute. In: Proceedings of the 2016 Internet Measurement Conference, IMC
2016, pp.397–411. ACM, New York (2016)
16. Orsini, C., King, A., Giordano, D., Giotsas, V., Dainotti, A.: BGPStream: a soft-
ware framework for live and historical BGP data analysis. In: IMC, pp. 429–444.
ACM (2016)
17. Sangli, S., Chen, E., Systems, C., Fernando, R., Scudder, J., Rekhter, Y.: Graceful
restart mechanism for BGP (No. RFC 4724). Technical report (2007)
18. Subramanya, A., Bilmes, J.: Soft-supervised learning for text classiﬁcation. In: Pro-
ceedings of the Conference on Empirical Methods in Natural Language Processing,
pp. 1090–1099 (2008)
19. Subramanya, A., Talukdar, P.P.: Graph-Based Semi-supervised Learning. Morgan
& Claypool Publishers, San Rafael (2014)
20. Villamizar, C., Chandra, R., Govindan, R.: BGP route ﬂap damping (No. RFC
2439). Technical report (1998)
21. Zhao, M., Chan, R.H.M., Chow, T.W.S., Tang, P.: Compact graph based semi-
supervised learning for medical diagnosis in Alzheimer’s disease. IEEE Sig. Process.
Lett. 21(10), 1192–1196 (2014)