shared Random Oracle ğ»(Â·) whose range is {0, 1}ğœ…. We use ğ‘ to de-
note the number of random oracle queries available to each party
per round. The honest parties search the space by performing ğ‘
queries for ctr â† 1 to ğ‘. The adversary controlling ğ‘¡ parties gets
ğ‘ğ‘¡ total queries per round.
It has been proven [21, 22] that executions follow the properties
of Chain Growth, Common Prefix, and Chain Quality.
We define a ğ‘„-block as a block satisfying a predicate ğ‘„ on its
hash. Note that this evaluation does not depend on any particular
execution.
Definition 6.1 (ğ‘„-block). A block property is a predicate ğ‘„ de-
fined on a hash output â„ âˆˆ {0, 1}ğœ…. Given a block property ğ‘„, a
valid block with hash â„ is called a ğ‘„-block if ğ‘„(â„) is true.
The block properties we are interested in will be evaluated in ac-
tual executions as ğ‘„(ğ»(âŸ¨ğ‘ğ‘¡ğ‘Ÿ, ğ‘ , ğ‘¥âŸ©)) for particular blocks. As such,
we will be interested in properties which are polynomially com-
putable given â„ as the input.
Definitions of random variables. We will call a query of a party
successful if it submits a triple (ğ‘ğ‘¡ğ‘Ÿ, ğ‘ , ğ‘¥) such that ğ»(ğ‘ğ‘¡ğ‘Ÿ, ğ‘ , ğ‘¥) â‰¤ ğ‘‡ .
Consider a block property ğ‘„. Let ğœ‰ğ‘„ = Pr[ğ‘„(â„)|â„ â‰¤ ğ‘‡], when â„ is
uniformly distributed over the range of the hash function. For each
round ğ‘–, query ğ‘— âˆˆ [ğ‘], and ğ‘˜ âˆˆ [ğ‘¡] (the ğ‘˜th party controlled by the
adversary), we define Boolean random variables ğ‘‹ğ‘„(ğ‘–), ğ‘Œğ‘„(ğ‘–) and
Session 12D: Decentralized Cryptographic ProtocolsCCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea3495ğ‘˜=1
âˆ‘
ğ‘ğ‘„(ğ‘–, ğ‘—, ğ‘˜) as follows. If at round ğ‘– an honest party obtains a ğ‘„-
block, then ğ‘‹ğ‘„(ğ‘–) = 1, otherwise ğ‘‹ğ‘„(ğ‘–) = 0. If at round ğ‘– exactly
one honest party obtains a ğ‘„-block, then ğ‘Œğ‘„(ğ‘–) = 1, otherwise
âˆ‘ğ‘
ğ‘Œğ‘„(ğ‘–) = 0. Regarding the adversary, if at round ğ‘–, the ğ‘—th query of
the ğ‘˜th corrupted party obtains a ğ‘„-block, then ğ‘ğ‘„(ğ‘–, ğ‘—, ğ‘˜) = 1, oth-
erwise ğ‘ğ‘„(ğ‘–, ğ‘—, ğ‘˜) = 0. Define also ğ‘ğ‘„(ğ‘–) =
ğ‘—=1 ğ‘ğ‘„(ğ‘–, ğ‘—, ğ‘˜).
For a set of rounds ğ‘†, let ğ‘‹ğ‘„(ğ‘†) =
ğ‘Ÿ âˆˆğ‘† ğ‘‹ğ‘„(ğ‘Ÿ) and similarly define
ğ‘Œğ‘„(ğ‘†) and ğ‘ğ‘„(ğ‘†). We drop the subscript from all variables ğ‘‹, ğ‘Œ, ğ‘,
when the ğ‘„-block is simply the property of being a valid block.
Further, if ğ‘‹(ğ‘–) = 1, we call ğ‘– a successful round and if ğ‘Œ (ğ‘–) = 1, a
uniquely successful round.
âˆ‘ğ‘¡
As in the backbone model[21], the probability ğ‘“ that at least one
honest party computes a solution at given round is an important
parameter. Writing ğ‘ = ğ‘‡/2ğœ… for the probability of success of a
single query, we have
(1 âˆ’ ğ‘“ )ğ‘ğ‘(ğ‘› âˆ’ ğ‘¡) â‰¤ ğ‘“ = E[ğ‘‹(ğ‘–)] = 1 âˆ’ (1 âˆ’ ğ‘)ğ‘(ğ‘›âˆ’ğ‘¡) â‰¤ ğ‘ğ‘(ğ‘› âˆ’ ğ‘¡).
The following bounds relate the expectations of the random vari-
ables defined above to ğ‘“ , for all ğ‘– and block properties ğ‘„.
ğœ‰ğ‘„ ğ‘“ â‰¤ E[ğ‘‹ğ‘„(ğ‘–)] â‰¤ ğœ‰ğ‘„ ğ‘“
1 âˆ’ ğ‘“
,
ğœ‰ğ‘„ ğ‘“ (1 âˆ’ ğ‘“ )  3ğœ– +3ğ‘“ , an execution
is typical with probability 1 âˆ’ ğ‘’âˆ’Î©(ğœ–2 ğ‘“ ğœ†).
Proof. The proof uses standard Chernoff bounds, along the
lines of [20]. We just note that the variables ğ‘‹ğ‘„(ğ‘–) (and similarly
ğ‘Œğ‘„(ğ‘–) and ğ‘ğ‘„(ğ‘–, ğ‘—, ğ‘˜)) are independent Bernoulli trials for each ğ‘„
and successful with probability Î˜(ğœ‰ğ‘„ ğ‘“ ). In addition, a union bound
is applied over all ğ‘„.
â–¡
Lemma 6.4. Assume ğ‘¡  3ğœ–+3ğ‘“ (the honest
majority assumption) and a Q-typical execution. Then, the following
hold for any ğ‘„ âˆˆ Q and any set ğ‘† of at least ğœ†/ğœ‰ğ‘„ consecutive rounds.
3)ğœ‰ğ‘„ ğ‘“ |ğ‘†|  ğ‘Ÿâˆ—) and would not mine on a
shorter chain. The second inequality holds because ğ‘£ > ğ‘¢â€² contra-
dicts an honest party having a chain of length ğ‘¢â€² at round ğ‘Ÿâ€² > ğ‘–
(since Câˆ—[ğ‘£] was received by round ğ‘Ÿâ€²). The inequality then follows
by Lemma 6.5, since it is always possible to find a block distinct
from Câˆ—[ğ‘£] on C or Câ€² (we may use Câ€², unless Câˆ—[ğ‘£] is on Câ€², in
Session 12D: Decentralized Cryptographic ProtocolsCCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea3496which caseâ€”due to the minimality of ğ‘Ÿâ€²â€”we have ğ‘£  ğ‘(ğ‘†â€²). Note that, in a typical execution, no such ğ‘†â€² may
contain elements outside ğ‘ˆ â€². Letting ğ‘¦ = ğ‘Œ (ğ‘ˆ) and ğ‘§ = ğ‘(ğ‘ˆ), we
need to show ğ‘¦ âˆ’ |ğ‘†| â‰¤ 2ğ‘§ + 2(1 âˆ’ 2ğ›¿
Let us focus on the uniquely successful rounds not in ğ‘†. Consider
a collection T of sets of consecutive rounds with the following
properties.
â€¢ For all ğ‘‡ âˆˆ T , ğ‘Œ (ğ‘‡) â‰¤ ğ‘(ğ‘‡).
â€¢ For each ğ‘Ÿ âˆˆ ğ‘ˆ \ ğ‘†, there is a ğ‘‡ âˆˆ T that contains ğ‘Ÿ.
â€¢ |T | is minimum among all collections with the above prop-
We now observe that the minimality condition on T implies that
no round ğ‘Ÿ with ğ‘ğ‘Ÿ > 0 belongs to more than two sets of T . If that
was the case, then there would be three sets ğ‘‡1,ğ‘‡2,ğ‘‡3 in T with
ğ‘‡1 âˆ© ğ‘‡2 âˆ© ğ‘‡3 â‰  âˆ…. But then, we could keep the two sets with the
leftmost and rightmost endpoints, contradicting the minimality of
T . Furthermore, no round in ğ‘ˆ â€² \ ğ‘ˆ belongs to more than one set
erties.
of T . Thus,
ğ‘¦ âˆ’ |ğ‘†| =
âˆ‘
ğ‘–âˆˆğ‘ˆ\ğ‘†
âˆ‘
ğ‘‡ âˆˆT
ğ‘Œğ‘– â‰¤
ğ‘Œ (ğ‘‡) â‰¤
âˆ‘
ğ‘‡ âˆˆT
ğ‘(ğ‘‡) â‰¤ 2ğ‘§ + ğ‘(ğ‘ˆ â€² \ ğ‘ˆ).
The third inequality holds because every round in which the adver-
sary was successful is counted at most twice inside ğ‘ˆ and at most
once outside ğ‘ˆ (by the discussion above the inequalities). Finally,
using |ğ‘ˆ â€² \ ğ‘ˆ | â‰¤ 2ğœ† and Lemma 6.4(c) we obtain the stated bound.
â–¡
The proof of this lemma is quite generous to the adversary on
two accounts. First, it reveals to the adversary all coin flips in the
beginning of the execution. Second, it gives the adversary two
choices for each one of his blocks, and assumes that he will be able
to choose among these as he sees fit. Nevertheless, we conjecture
that the bound ğ‘¦ âˆ’ 2ğ‘§ cannot be substantially increased in the case
the property is rare.
We can now prove that an adversary with less than 1/3 of the
total mining power cannot create a chain with more ğ‘„-blocks than
an honest chain. Such a task would require the adversary to both
suppress many ğ‘„-blocks from the honest chain and to obtain many
of them for the adversarial chain.
3 âˆ’ ğ›¿)ğ‘›
with ğ›¿ > 3ğœ– + 3ğ‘“ and a Q-typical execution. Consider a round at
which a chain C is adopted by an honest party and suppose there
exist another chain Câ€² such that Câ€² \ (Câ€² âˆ© C) has at least 22ğœ†ğœ‰ğ‘„ ğ‘“
ğ‘„-blocks. Then, with overwhelming probability, C has more ğ‘„-blocks
than Câ€².
Lemma 6.8 (ğ‘„-block Common-Prefix). Assume ğ‘¡ < ( 1
= C âˆ© Câ€² was computed (if no such block exists let ğ‘Ÿâˆ—
Proof. Assume an execution in which the assumptions of the
lemma hold. Let ğ‘Ÿâˆ— be the round on which the last honest block
on Câˆ—
= 0)
and define the set of rounds ğ‘† = {ğ‘– : ğ‘Ÿâˆ— < ğ‘– â‰¤ ğ‘Ÿ}. We will study
the execution during the rounds in ğ‘†. To that end, let ğ‘Š â€² denote
the set of adversarial queries on Câ€² \ Câˆ— at some round at least ğœ†
greater from ğ‘Ÿâˆ—. Denote by ğ‘Š the rest of the adversarial queries in