#### 尚存或演进的问题
  * 以CS 模式通信 , 但是通信结构和验证过程过于简单或没有 ,导致⼀旦攻破便可危害所有在网设备
  * APP 的安全开发意识十分薄弱
  * 厂商合作之间的信任链单一 , 信任关系简单
  * 多模式设计下 , 短板效 应明显 , 在某一模式安全性的缺失则导致整套安全系统崩溃
  * 对用户信息 , 设备的存储和查询 , 存在致命的缺陷 , 对用户信息无任何保护手段 , 很容易获得设备用户的对应关系
> 早期 , 网络病毒、蠕虫入侵的对象只是计算机 , 随着物联网时代的到来 , 入侵的对象由电脑转向网络摄像头和 路由器 . 万物互联时代的恶意软件猖獗 ,
> 导致 IoT 僵尸网络的疯狂滋生。
>
> 此处我们会讨论 2017 年几个极具代表 性的 IoT 恶意软件。
### IoT 恶意软件威胁
2016 年爆发的 Mirai 事件经过一年的沉淀 , 依旧对互联网产生着影响 , 尤其是作者公开源代码后 , 各种 Mirai 变
种”百花齐放”,不少变种比 Mirai 原本更具有攻击性 .
#### IoT_reaper
以 2017 年 10 月 爆 发 的 IoT_reaper 为 例 , 该 僵 尸 网络 脱 胎 于mirai, 但是在诸多方面比 mirai 更进一步
, 特别是开始放 弃弱口令猜测 , 完全转向利用 IoT 设备漏洞收割。
IoT_reaper 相较于 mirai 仍有几个明显区分点：
  1. 恶意代码投入时不再使用弱口令猜测、而是使用 iot 设备漏洞，扫描发现效率大大提高；
  2. 恶意代码中集成了 LUA 执行环境，从⽽支持通过 lua 脚本编写复杂的攻击指令；
  3. 主动抑制了扫描速度，被安全研究者发现的风险大大降低。
其中最为可评说的是 IoT_reaper 完全放弃了 mirai 中利用弱口令猜测的方式，转为利用 IoT 设备的漏洞植入，当前样本中集成了了 9 个
IoT 设备漏洞。
IoT_reaper 利用漏洞情况
在 2017.10.13 至 2017.10.23 之间单台 C2 的感染情况如下：
#### Satori
2017 年 11 月 22 日 , 360 网 络 安 全 研 究 院 观 测 到 有 大 量 扫 描集 中 在 23 和 2323 端 口 , 并 通
过 admin/CentryL1nk admin/QwestM0dem 两组用户名密码进行爆破 , 其针对的是 ZyXEL 调  
制解调器 , 之后该僵尸网络 C2 被 sinkhole。
2017 年 12 月 05 日 , Satori 的 新 版 本 开 始 在 端 口 37215 和52869 上迅速传播。
相较于 mirai, 区分如下：
  * bot 不再完全依赖以往的 loader/scanner 机制进行恶意代码的远程植入，而是自身有了扫描能力 ;
  * bot 中增加了两个新的漏洞利⽤，分别工作在端口 37215和 52869 上
从 12 月 05 日开始可以看到 263250 个不同的 IP 在扫描目标端口：
12 月 5 日目标端口扫描情况
此次 Satori 的新版本主要利用到的是 CVE-2014-8361(52869端口 ) 和一个华为路由器的 0day
CVE-2017-17215(37215 端口 )。
Satori 在传播过程中 , 不仅会利用上述漏洞利用 , 而且会迫使受感染设备从原始下载 URL 处继续下载 Satori 自身的恶意代码。这样周而复始
, 使得恶意代码类似蠕虫式地传播。
#### Setbox
2017 年 8 月 , 国内观测到一系列 DDoS 攻击 , 通过溯源发现攻击来自于一批电视机顶盒 , 通过样本分析 , 依旧可以归为 mirai 家族的
Satori 变种 , 其 DDoS 攻击代码一致 , 代码结构基本没改变。  
但该僵尸网络针对有线电视终端机顶盒进行 telnet 口令爆破 , 将mirai 的攻击面延展到机顶盒设备 , 这无疑增加了影响范围。
该僵尸网络攻击传播如图所示：
Satori 僵尸网络船舶原理
通过 360 网络安全研究院数据观测 , 两个 C2 请求态势如下：
185.130.xxx.xxx:7723
185.47.xx.xxx:8716
#### 小结
由以上三个 IoT 恶意软件看出 , 在 Mirai 开源代码后 , 其变种层出不穷 , 且青出于蓝胜于蓝 , 主要表现为 :
  * 保留 Mirai 的基本框架特性
  * 利用漏洞 ( 甚至 0day) 收割未被弱口令命中的 IoT 设备
  * 自身添加了扫描能力
  * 集成 LUA 环境升级自身编码能力
  * 和安全研究人员对抗性加强
> 在物联网相关的安全问题越来越引发关注的背景下 , 对在互联网上暴露的 IoT 设备进行分析和梳理是非常有必要的 ,360CERT 自行研发的 QUAKE
> 网络测绘平台孕育而生 , 利用网络空间测绘技术 ,  
>  发现存储相关的 IoT 设备 , 形成威胁情报。
### IoT 设备网络测绘情况
IoT 设备网络测绘总览
由于不同厂商设备指纹凌乱特征区分不明显 , 搜索结果可能和实际情况有出入 , 实际暴露情况可能比以下数据更多。
从全球分布来看 , 设备暴露情况以路由器为主 , 超过了 3100 万。
路由器全球测绘情况
其次为是视频监控设备 , 超过 800 万设备暴露在公网。
监控设备全球测绘情况
其中打印机位列第三 , 超过 80 万打印机暴露于公网。
打印机全球测绘情况
#### 路由器暴露情况
通过统计 , 我们发现一个有趣的情况 , 在路由器暴露全球分布上 ,中国独占鳌头总量超过 1000 万。
全球范围内 , 暴露数量最多的服务依次是 HTTP、FTP、UPnP和 TR-069; 国内范围内 , 83% 的路由器开放了 UPnP 服务。
  * HTTP 服务以 80, 8080, 8081 等常见端口为主
  * FTP 服务端口为 21, 不排除存在匿名访问的情况
  * TR-069 协议以 7567, 4567 端口为主
  * Telnet 以 23 和 2323 为主 , 很多可以直接访问到魔改前后的路由系统 , 也由此 Telnet 成为攻击者的主要目标
  * 从国内数据统计来看 , 超过 80% 的路由设备开放了 UPnP服务
#### 视频监控设备暴露情况
视频监控设备一直在安防领域占据主导地位 , 但今年发生的一些黑天鹅事件已经对智能安防设备的安全性敲响了警钟。
海康威视和大华两大厂商作为监控设备龙头 , 市场占有量大 , 所以暴露在公网的设备也以这两大厂商为主。
海康达到 300 万左右的全球设备暴露量 , 大华达到 200 万左右的全球设备暴露量 , 剩下以 D-Link, Cross 等厂商设备为主。
( 该图表数据来自于绿盟 )
#### 打印机设备情况
在本次统计中 , 令人意想不到的是打印机暴露占比不少 , 随着智能化办公的推进 , 移动设备打印需求增大 , 打印机逐渐朝着智能化发展 ,
越来越多的功能也伴随而来更多的攻击面。
在全球设备暴露方面 , 惠普占量最多 , 达到 50 万左右 , 其次爱普生 ,富士施乐等大厂商也占比较高。
惠普打印机全球以美国暴露量最大 , 其次为韩国 , 加拿大。
在打印机寻求攻击面上 , 除了常规的 web 控制端 , 631 端口 ipp 访问弱口令一类认证问题 , 我们还发现了 9100 端口 PJL
服务安全问题。
通过PJL 命 令 , 可 以 使 支 持 Postscript 的 打 印 机 切 换 至Postscript 模式 , 直接执行 Postscript
代码进而控制整个打印机。
#### 小结
虽然一个物联网设备暴露在互联网并不一定意味着这个设备存在问题 , 但能说明该设备存在被攻击甚至被利用的风险。
通过网络测绘 , 我们发现以下问题：
  * IoT 设备暴露公网量巨大 , 且很多存在安全风险
  * 路由器和智能安防设备占有量为主
  * 中国在全球设备暴露量中占比较大
  * 大量的 IoT 设备暴露给攻击者落地进一步攻击提供了便携
  * 越来越多的传统设备在向智能化靠近且已经占到全球设备暴露量前列
## IoT 安全发展展望
### 合规性管理
IoT 正在驱动着一轮新的行业变革 , 但在不同行业 , 安全需求不统一 , 落地的安全方案也不全面成熟 ,
在安全监管和应对措施上也没有明确思路。仅仅依靠某个组织 , 行业的安全推动是远远不够的 ,  
需要更高层级的协调以及统一的合规性管理。
举例参考 2016 年由于 Mirai 引发的断网事件 , 美国次月即发布了《保护物联网策略准则 (1.0 版 )》, 今年 5
月还签署了总统令《加强联邦网络和关键基础设施的网络安全》, 均要求各私营企业、研  
究机构、社会团体围绕减少僵尸网络威胁和维护物联网终端设备安全问题 , 提出法律、政策、标准、技术等方面的建议 。
加强政府的监管和立法，不仅有助于提高社会和国家对物联网安全的重 视程度，而且也能进一步推进物联网产业向着健康、安全的方向良性发展。
### 物联网安全标准建设
在任何技术的发展和演进过程中 , 标准都有着至关重要的作用 , 理论形成标准 , 标准指导产品和解决方案的完善。从现在的情况看来 , IoT
处于起步蓬勃发展的阶段 , 以指南和框架为主 , 能够指导产业落地 , 解决大块的安全痛点。
## 参考
[ http://blog.netlab.360.com/wa-a-new-mirai-variant-is-spreading-in-worm-style-on-port-37215-and-52869/](http://blog.netlab.360.com/wa-a-new-mirai-variant-is-spreading-in-worm-style-on-port-37215-and-52869/)
[ http://blog.netlab.360.com/iot-reaper-a-quick-summary-of-a-rapid-spreading-new-iot-botnet/](http://blog.netlab.360.com/iot-reaper-a-quick-summary-of-a-rapid-spreading-new-iot-botnet/)
[
http://www.nsfocus.com.cn/upload/contents/2017/12/20171205171653_35944.pdf](http://www.nsfocus.com.cn/upload/contents/2017/12/20171205171653_35944.pdf)