扩展检测与响应（XDR）功能正在涌现，以提升检测的准确性、威胁遏制能力并改善事件管理。
 **5.3.2 项目难度**
中等。XDR给到大家的是一个重要的承诺，但也会带来被特定供应商锁定的风险。不同供应商的XDR功能差异很大。
 **5.3.3 项目关键**
范化数据的集中存储和集中式事件响应，并且能够改变作为修复过程组成部分的单个安全产品的状态。也就是说，项目关键在于数据范化、集中数据存储、集中事件响应，以及安全设备协同联动。
 **5.3.4 项目建议**
基于自身技能水平/胜任力以及员工水平来评估是采用XDR还是寻求MSSP。XDR最初是从EDR发展而来，并进一步结合了NDR、SIEM、SOAR，以及其它安全检测与响应技术，这些技术统统都是高度依赖安全专家的，因此，用户要考虑清楚到底是要XDR产品，还是先找安全服务商用类似MDR的方式来实现检测与响应。
 **5.3.5 技术成熟度**
根据Gartner2020年的安全运营Hype Cycle，XDR目前处于初现阶段，位于炒作的初期，位于安全运营Hype Cycle的最左侧。
 **5.3.6 技术解析**
XDR的全称是扩展检测与响应。XDR这个词出现在厂商侧已经有一段时间了，但纳入Gartner的体系是今年初的事儿。Gartner将XDR从某些厂商的产品品牌变成了一个细分技术和市场术语。刚刚进入Gartner的术语表就登上了10大安全项目，可见XDR的威力。借助XDR，将原本各种检测系统的孤立告警进行了整合，通过在各种检测系统之上的数据集成与综合关联分析，呈现给用户更加精准和有价值的告警，以及更清晰的可见性（Visibility）。此外，XDR还具备与单一的安全工具之间的API对接与基础的编排能力，从而能够快速地实施告警响应与威胁缓解。XDR异军突起，成为了Gartner在安全运营的检测与响应子领域首推的技术和项目，因此有必要进一步对其进行探究。笔者作为一直专注于SIEM/SOC领域的从业者也关注XDR近两年，下面进一步阐述个人对XDR的理解。
 **5.3.6.1 XDR的产生**
现在普遍认为XDR最早源于端点检测与响应（EDR）。EDR的概念自提出以来，得到了迅速发展，一方面逐渐向端点保护平台EPP融合，另一方面也在试图扩展自身的价值。如何扩展？首先是增强端点检测的能力，深化诸如行为分析、异常检测等的机器学习能力，并加入威胁猎捕的能力；其次是增强响应的能力，实现更灵活的设备联动，甚至嵌入部分响应流程。但这还不够，因为从检测的角度来看，仅仅依靠端点自身的遥测数据还不够，为了更精准的发现问题，还需要获取其它遥测数据。因此，部分EDR厂商开始将目光投向端点之外的检测，加入对邮件安全的检测、网络检测、以及云工作负载的检测信息，试图顺着攻击者的视角补全检测的短板。再往后干脆将这些不同来源的遥测数据放到一个统一的平台上进行集中的分析与响应，逐步衍生出了XDR的概念。此时XDR的保护目标已经不再局限于端点上的用户，以及他们使用的应用和数据，而是扩展到了更广泛的空间，从数据中心，到云，再到边缘，都可以应用XDR。当EDR演进成了XDR，就已经不再是一个端点安全类产品了。显然，这是一个从EDR开始，从一点到多点，自底向上的横向扩展，纵向延伸的过程。与此同时，一些SIEM厂商也发现了这个机会，试图在其SIEM中内置EDR功能来获取对于端点安全的遥测数据，以更好地去让SIEM实现威胁检测的能力。这是一个自顶向下延伸的过程。基于共同的目标（威胁检测与响应），来自不同方向的技术路线碰撞到了一起，于是XDR诞生了。
 **5.3.6.2 XDR定义**
从前面的XDR产生过程可以发现，XDR其实就是整合了多种检测能力的，具有集中化存储和分析这些遥测数据，并集中实施响应的综合性检测与响应平台。目前，Gartner给XDR的定义是：XDR是一种基于SaaS的，绑定到特定供应商的安全威胁检测和事件响应工具，可以将（该供应商的）多个安全产品原生地集成到一个统一的安全运行系统中，以统一所有授权的安全组件。为了方便大家研读，提供英文原文如下：XDR
is a SaaS-based, vendor-specific, security threat detection andincident
response tool that natively integrates multiple security products intoa
cohesive security operations system that unifies all licensed
securitycomponents.Gartner给出了当前XDR的4个基本特征：1）整合多款自家的现成产品；2）集中的对数据进行处理、存储和分析；3）能够在响应的时候协同联动多种安全产品；4）采用基于SaaS的交付模式。上图展示了Gartner的XDR概念架构。从上向下看【笔者注：反的，有点别扭】，首先是获取多种安全产品（EDR是基础）的数据，然后是对数据进行范化，送入大数据湖，再进行关联分析，实现综合威胁检测，最后激活响应。在响应的时候，可以运用自动化的方式，通过API接口实施，并且可以内嵌响应工作流程。作为参考，笔者摘录对XDR颇有研究的咨询公司ESG对XDR的定义如下：XDR是一个跨混合IT架构的多个安全产品的集成套件，旨在协同地进行威胁防范、检测与响应。它将各种控制点、安全遥测点、分析和运营统一到一个企业级系统之中。上图是ESG的XDR架构示意图。ESG更直接表示可以把XDR看作是EDR+SIEM+SOAR的集合。笔者认为，XDR=EDR+简化SIEM+简化SOAR。XDR的目标就是全面的威胁检测与响应，或者叫统一威胁检测与响应（UDR）、NGDR。1）
EDR是XDR的必备组件。当前的威胁检测必然要从端点上收集遥测数据，因为这里能够发现的攻击痕迹最多。看看ATT&CK就知道，大量的TTP都是基于端点的。缺少端点数据，攻击链很难刻画出来。2）
简化的SIEM是XDR的平台支撑。XDR不是一个简单的单点系统，而是一个平台型系统。SIEM的大数据核心框架为XDR的后端平台提供技术支撑，包括海量多源异构数据的采集、处理、存储、分析、调查、呈现，等等。借助SIEM平台框架，XDR应实现对EDR以及其它自家安全设备的集成。简化之处在于仅提供对厂商自有产品的数据采集、范化和分析，而不必考虑接入第三方厂商数据的问题。3）
简化的SOAR为XDR的响应能力提供支撑。SOAR的能力裁剪后跟SIEM整合到一起。
 **5.3.6.3 XDR与SIEM/SOAR的关系**
通过上面的分析，大家都会产生一个疑问：XDR跟SIEM/SOAR是什么关系？注意，这里我们将SIEM/SOAR打包到一起来跟XDR进行对比，是为了避免阐释SIEM和SOAR的关系，此刻这个问题先放一边。先看看Gartner是怎么说的。Gartner表示，尽管XDR与SIEM/SOAR在功能上存在相似性（譬如都有异构数据采集、范化、关联，而且通常都会采用大数据分析技术，还可能都有剧本编排与自动化响应技术），但在目标定位和技术路线上存在差异。在目标定位上，XDR仅关注威胁检测与响应，而SIEM除了关注威胁检测与响应，还要覆盖日志存储及合规审计等其它场景。在技术路线上，XDR强调对单一厂商的安全产品集成，并且在出厂前就将这些产品打包在一起，提供了更易于部署和使用的操作过程。相比之下，SIEM/SOAR必须具备跨厂商产品集成能力。正是因为在设计上的这些简化，XDR规避了SIEM/SOAR当前存在的几个大坑（笔者注：譬如架构开放性和扩展性问题、产品集成问题、部署和实施复杂性问题、知识管理问题），使得XDR的部署和实施复杂度相较于SIEM/SOAR要简化不少。此外，如果是针对云计算环境，云中的端点安全和工作负载安全能力，以及平台架构作为成为了衡量云安全检测与响应的关键。此时，XDR厂商比大部分SIEM/SOAR厂商更占优势，因为先进的XDR通常都基于云原生架构来实现。并且，XDR厂商在云端EDR及CWPP方面更具优势。简言之，就是在相同条件下，以威胁检测为目标，XDR出效果比SIEM/SOAR更快。当然，Gartner认为XDR也存在一些问题。由于XDR集成的都是自家的产品，虽然简化了不少，但却容易将用户锁定在单一厂商之下。XDR厂商的“全家桶”模式难以确保除EDR之外的检测能力都是同类最佳，且如果各种单点产品都基于同一个厂商，未来的维护、升级都存在风险。此外，笔者认为，XDR还存在以下问题：首先，XDR还有不少技术短板需要补齐。在多源安全数据采集分析，尤其是关联分析方面，XDR厂商普遍落后于SIEM厂商。在响应方面，SOAR的编排自动化技术也是XDR需要补足的。其次，也是最关键的，XDR是作为一个集成化的产品和解决方案提供给客户的，用于解决其一揽子的威胁检测与响应的问题。而新一代的SIEM/SOAR则越来越强调给用户赋能，是以能力建设的形式输出给用户的。对于大型用户而言，网络中必定存在不同厂商的安全防护设施，也必定需要一个统一的SOC。因此，XDR无法取代SIEM/SOAR。但对于中型客户而言，XDR可能会在SOC中占据更主要的位置。还有一部分客户，Gartner建议他们既不要考虑XDR，也不要考虑SIEM/SOAR，而是优先考虑MSS。XDR虽然比SIEM/SOAR简化了不少，但还是需要运营的。必须指出，Gartner对于XDR还在不断厘清的过程中，该技术（所代表的细分市场）并不稳定，也许在一段时间后会消失。因为XDR与SIEM/SOAR存在一定的重叠性，并且更多是因为SIEM/SOAR技术的发展过程中存在的问题而引伸出来的一个“过渡性”解决方案，也许随着SIEM/SOAR的成熟而消失，抑或找到一个属于自己的缝隙市场。
 **5.3.7 从检测技术的划分看XDR的发展趋势**
**5.3.7.1 检测技术划分**
如前所述，XDR可以看作是多种检测与响应技术的集成，作为一个统一的、全面的检测与响应平台。对XDR而言，不是要研究新的检测与响应技术，而更多是考虑如何将不同的检测与响应技术整合到一起。因此，为了了解XDR未来的发展趋势，必须先了解当下都有哪些检测与响应技术。当Gartner研究和讨论检测与响应类技术的时候，涉及的技术面和细分市场是相当广泛的，需要多个不同的Gartner安全分析师团队之间的合作，而一年一度的Hype
Cycle（炒作曲线）则是各个分析师协作的一个成果体现。目前，检测和响应相关的技术大都收录在“安全运营”炒作曲线中。“安全运营”这两个炒作曲线分类是2020年新提出来的，之前叫“面向威胁”，始于2017年，在2016年及以前叫“基础设施保护”。下图是2020年的“安全运营”技术炒作曲线，里面基本涵盖了Gartner涉及的所有检测与响应类技术。上图虽然列举了大量检测与响应技术，却并没有对他们进行分类。而对检测与响应技术进行分类是一个重要但十分困难的事情，Gartner自己也做过多种尝试，目前尚无定论。Gartner在2013年为了讨论高级威胁检测（ATD）的时候提出了一个划分新型检测技术的方法论，虽在2016年后逐渐淡出Gartner报告的视野，但却依然有一定价值。如下图所示，Gartner当时从分析对象和分析时间两个维度划分了五种新型检测技术：针对这幅图，笔者结合自己的认识，对当下主流的几种新型检测技术进行了标注如下：可以看到，NTA是当下主流的基于网络的新型检测技术，NFT（网络取证工具）作为基于网络的响应技术比较少被提及。从2020年开始，Gartner正式将NTA改名为NDR（网络检测与响应）。注意，上图只对D进行了划分，没有提及R。因此，NDR不仅包括NTA，NFT，还要包括响应能力。对应NDR，现在还有一个初现的提法，叫NGIDS，或者NG
IDPS，所谓下一代入侵检测，但这些提法缺乏对R的体现。从基于端点的视角来看，style4和style5两种技术现在已经不再加以区分，统称为EDR，或者作为下一代EPP的关键能力之一了。上图中位于中间的基于负载的检测技术，基本就是指代沙箱技术了。而该技术事实上还可以分解到基于端点的沙箱和基于网络的沙箱两个维度中去，成为更广泛意义上的NDR和EDR的功能点之一。上图对于阐释当下最热门的两种新型检测与响应技术——NDR和EDR——及其市场演进是有价值的，但却远远无法表达完整意义上的检测与响应技术，更何况检测与响应技术本身也仅仅检测与响应体系建设的一环而已。2018年，Gartner在一份名为《如何开展威胁检测与响应实践》的报告中给出了一个基本的检测与响应体系的参考模型，如下图：上图比较全面地表达了检测与响应体系所应涵盖的技术（能力）、流程和团队三个方面的内容，给出了10个技术能力和4个关键流程，并沿用至今。这10个技术能力从目标对象和时间先后两个维度进行了划分，与前面的新型威胁检测二维划分方式基本一致。不同之处在于目标对象粒度更细，最关键地是加入了针对日志的检测与响应，并把SIEM和CLM（集中日志管理）作为最基本的检测与响应的平台，位置要高于后面4个。此外，在这个10大技术能力矩阵图中，响应能力从技术视角来看被称作了“可见性”，所谓可见性就是在威胁猎捕和安全响应（包括调查、取证）的时候能够提供相关的技术支撑。检测与响应能力从流程视角对应了4个方面，它们从技术上可以由SOAR来提供支撑。事实上，即便是上面的10+4检测与响应参考架构图都没能将检测与响应技术描绘全，譬如基于用户/实体进行检测的UEBA技术，以及欺骗技术。Gartner自己也表示上图仅仅是针对基本的检测与响应能力进行阐释。额外需要提及的包括UEBA、欺骗平台、BAS。在2020年的炒作曲线中，UEBA已经去掉了，Gartner表示它已经成为了其它技术的组成部分，主要是融入了SIEM，而XDR、EDR和NDR也都会用到。Gartner将欺骗技术单独作为一个技术分支，与面向日志的检测与响应技术、面向网络的检测与响应技术和面向端点的检测与响应技术并称为四大检测与响应技术路线。对于SIEM而言，欺骗平台的告警可以成为一个高置信度的数据源。BAS（破坏与攻击模拟）也是一种检测与响应技术，可以为SIEM提供重要的基于验证的检测与响应能力补充。
 **5.3.7.2 XDR发展趋势分析**
笔者认为，未来XDR理论上可以集成上面所有检测与响应技术，但那个时候XDR是不是还叫XDR就不得而知了。目前市场上已经出现了将EDR、欺骗技术、NDR集成到一起的XDR解决方案。还有的厂商把SIEM/LM所具备的对第三方日志采集、存储与分析能力作为其XDR解决方案的一部分。几乎所有的XDR厂商都宣称自己具有UEBA能力，并都集成了威胁情报。进一步分析当前的XDR厂商，可以发现大家的做法可谓五花八门。最经典的XDR来自有实力的EDR厂商，这些EDR厂商同时具备其它检测类产品，因而通常也都是综合性厂商。他们的XDR基本上就是以EDR为核心的产品全家桶。还有一类更大型的综合性厂商野心更大。他们将其各种产品打包到一起，上面再戴个帽子，形成了一个更雄心勃勃的战略和XDR解决方案，仔细一看，其实就是把XDR变成了SIEM/SOAR和SOC平台。还有一类厂商则剑走偏锋，把XDR做成了一个检测与响应中间件（中台？也许吧），对下可以接入自家或者别家的遥测数据，对上则可以汇入别家的SIEM/SOAR。最后，还有SIEM厂商也加入了XDR战场，他们基于其SIEM/SOAR领域的积累，向下集成包括EDR、NDR在内的多种检测技术，推出自己的XDR。总体而言，当前的XDR技术并不复杂，核心是产品和能力集成与打包。目前大家在XDR市场竞争的焦点主要不在技术上，而在商业模式、市场推广上。显然，XDR还处于萌芽状态，未来发展的可能性还很多，变数也不小。
### 5.4 云安全配置管理（CSPM）项目
**5.4.1 项目描述**
现在对云服务的攻击基本都利用了客户对云疏于管理、配置不当等错误。因此，云用户急需对（尤其是跨多云环境下的）IaaS和PaaS云安全配置的正确性与合规性进行全面、自动化地识别、评估和修复。
 **5.4.2 项目难度**
中等，必须同步进行流程和文化的变革。
 **5.4.3 项目关键**
支持多云环境，具备敏感数据发现和风险暴露面评估，支持所有的IaaS和PaaS服务，不仅能评估更要能修复。
 **5.4.4 项目建议**