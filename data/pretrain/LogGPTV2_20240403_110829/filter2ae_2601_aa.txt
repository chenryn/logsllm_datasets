Integrated Threat Management For Dummies(综合威胁管理)  
by Peter Gregory
# 1 当前的威胁场景
## 威胁发展
年龄大一点的安全专家会记得那个防火墙和反病毒软件就可以阻挡大多数攻击的时代。现在出现了越来越多的威胁和攻击，每年有成年上万的新的恶意软件变种，现在可能每小时就有上千个。本节介绍讲敏感数据和系统置于危险中的威胁。
### 变异的恶意软件
一般来说，以基于签名的反病毒软件作为主要防御方式的时代已经过去了。而依赖签名来是识别和阻止病毒、蠕虫、木马的反病毒软件对于今天的经过变异的恶意软件来说是没有用的。现在的恶意软件已经变成了一种武器：能够在感染的主机上进行自我变异。带来的后果就是每个受感染的主机都被恶意软件的不同部分攻击。恶意软件厂商为这类恶意软件创建了进行识别的签名以后，当应用到终端时，该签名已经过时了，因为受感染主机上是另外一个独特的备份（即用于识别的签名不同）。
### 内部威胁
当安全专家讨论内部威胁时，他们讨论的实际上是整个潜在的有害活动。许多人会以为这只包括一些恶意的职员，但是内部威胁远不止这些。如今内部威胁的概念包括：
  * 无意的错误。职员无意间点击了他们不应该点击的东西（垃圾邮件），发送邮件给不应该收到的接受者。
  * 判断失误。职员重用密码、存储隐私信息到个人云，在浏览器上安装工具插件等。
  * 缺乏培训。职员收到了存储敏感信息的新办法，但是他们可能不理解如何去具体的应用。有时这会让隐私数据和系统处于危险中。
  * 恶意职员。一些职员可能觉得资金要被解雇了，他们就会下载所有的客户数据和获奖项目源代码，开发人员还可能会植入时间炸弹来在将来的某个时间破坏重要数据。
恶意威胁很难阻止，主要是因为信息系统只做告诉做的事情，而不会考虑公司的政策和用于的意图。所有好的计划都可以被误用或者滥用来达到某些恶意意图。
### 逐渐消失的网络边界
曾有一段时间，用户可以通过防火墙来保护内部网络。随着互联网的发展，用户和商业伙伴可以访问内部和外部系统，职员的笔记本电脑从世界各地连接到公司网络，企业也将重要数据存储到云上。目前，网络边界上许多的漏洞，然而防御的方案并不综合。
### 云迁徙
许多企业已经不在购买硬件来在自己的数据中心安装商业应用了。企业正在逐渐迁徙到云端，他们从IBM Softlayer，Amazon Web
Services，Microsoft
Azure这样的IaaS租了基于云的应用和操作系统。迁徙到云上给企业带来了巨大的经济效应，但是很少有企业考虑这种迁徙带来的威胁和风险。企业组织假定云提供商为他们的云服务提供了更多的安全措施，而与云服务商的合同给了客户很少的权力和可见性。
**在工作中使用自己的设备**  
Apple这样的公司满足了我们对更好的终端设备的需求，比如MacBook
Air笔记本、iPads和iPhones等。人们会带着这样的设备去公司并连接到企业内部网络。大多数的IT是不能阻止他们的，尤其是当高管说我们要把我的iPad连接到内部网络时。这样的话，IT就市区了对企业终端和重要数据的控制权。你以为这就到此为止了吗？每天都会有免费或者廉价的云应用出现在市场上，然后会迅速出现在下周的采购报告中。就这样，企业完成市区了对重要数据的控制权和可见性，因为职员和部门将数据迁徙到云上是不需要IT、法务和安全部门的许可的，甚至不需要告知。
新的技术发展让非IT的职员在不告知IT部门的情况下，做任何想做的事情。这可能在一些方面对企业是有好处的，而带来的潜在风险也是很多。许多的商务人士在工作中选择使用自己的设备，并使用云服务，但是他们那个没有考虑到这样做带来的潜在威胁。
## APT
Advanced Persistent Threats
(APTs)已经是一种高级持续性攻击，特定的组织和个人可以用来攻击其他单元达到窃取用户数据、破坏数据或者信息系统的目的。APT包含许多的攻击工具和技术，攻击者用这些工具和技术来收集关于攻击目标的情报，然后系统地按步骤达到工具目的。在APT攻击中，威胁者创建了之前未见过的恶意软件。利用一些之前没有发现的漏洞并创建恶意软件来利用这些0day漏洞。
## 数据泄露
### U.S. 医疗保险提供商
2015年初，一个大的US医疗保险商报告说8千万市民的个人信息可能被窃了。窃取这些数据的方法并没有公开，但是应该是通过钓鱼攻击或水坑攻击发起的一个简单的恶意软件攻击开始的。
### U.S. 零售商
该公司的数据泄露导致超过1亿客户的信用卡数据被窃，这些客户都在2013年底在商店用信用卡进行过支付。窃取明文信用卡号的恶意软件被植入到收款终端中。企业有检测恶意软件的安全工具，但是安全操作人员没能影响和移除该恶意软件。与其他零售商数据泄露一样，入侵者通过供应商的登录证书进入到网络中。
### U.S. 医疗提供商
Kentucky的一家医院发布过一份声明说，医院的服务器感染了勒索软件。在系统恢复上线前，医疗电子记录无法访问。
### 计算机和网络安全提供商
虽然是一家安全提供商，但这家公司在2011年被黑。目标是这家公司的双因素认证产品，所以入侵者能够尝试用产品自带的远程访问认证来入侵公司的网络。攻击是从发送给人力资源部的含有恶意软件的钓鱼邮件开始的，有人打开了邮件中的恶意附件，然后攻击就发生了。
# 2 防御复杂攻击
## 攻击预防
攻击预防是手动的，但是预防并不是可选的。愿意在信息系统上进行投资来支持商业过程的企业，必须同时在培训员工和获取工具上进行投资，来帮助保护他们的系统。
### 攻击预防的原则
因为存在不同的攻击方法，所以会有不同的方法来预防这些攻击的发生。在了解攻击和预防技术技术之前，我们首先要理解攻击预防的原则。
如果深入思考这些原则，你可能会得到和大多数安全专家同样的结论：网络斗争是不公平的，表中的原则几乎不可能实现。很明显，在这场斗争中，攻击者是有优势的，当防御者处于道德高地时，攻击者处于战略优势。
### 攻击防御实践
当你觉得自己处于劣势的时候，你可以做一些努力：
  * 漏洞管理：必要的商业实践含有许多识别漏洞、使用漏洞数据反馈、对系统打补丁的活动。这对减少漏洞利用有一定的帮助，也能让攻击者访问目标系统变难。
  * 补丁管理：这包括获取可用补丁信息和通过简历的变化管理过程来优化和应用漏洞补丁。
  * 系统硬化：这是紧缩系统和组件配置的实践，移除非必要的模块和工具，移除非必要的用户账户。这些技术记录在系统和组件硬化标准中，应该包含在应用到企业的新笔记本、服务器、网络设备的主镜像中。
  * 权限减小：减少管理和普通用户的权限到工作级。这可以限制攻击者接管账户后的能力范围。
  * 供给面减少：通过从环境中移除对功能没有重要影响的组件和系统来预防攻击。这可以减少潜在攻击目标的数量，也减少了攻击者入侵企业的入口点。
  * 安全意识培训：这是对终端用户进行抵抗社会工程学攻击的实践，比如强密码、遵循安全策略和步骤、限制对敏感和重要信息的使用和传播这样的安全实践。
## 网络入侵防御
网络入侵防御是使用工具和技术来帮助检测和拦截基于网络的攻击的安全实践。因为网络是攻击者进行侦查、发起攻击、窃取敏感数据的方式，所以使用一些检测和拦截基于网络的攻击活动的方法是很有必要的。  
预防网络入侵的基本攻击是IPS也叫做NIPS。IPS和NIPS有所不同，IPS是基于主机的入侵防御系统（HIPS），而NIPS是基于网络的入侵防御系统。文中的IPS既可以指代NIPS也可以指代HIPS。
IPS连接内外网，检查进入和外出的网络流量，并与预设的规则进行比较，来决定接受、还是拦截数据包。图2-1是企业中IPS的描述。当包被拦截后，IPS就创建一条日志记录。许多IPS都有监控或者检测模式，在这种模式下不对包进行拦截，只对一些可疑的包进行警告或记录日志。
## 终端恶意软件保护
黑客在攻击中会使用一些技术来避免被检测到。使用这些避免被检测到的技术，黑客不仅可以入侵企业还可以在几个月内不被检测到。在网络中建立落脚点是很琐碎的，经常使用一些经过测试效果较好的恶意工具来在目标终端上建立落脚点。
为了应对该威胁，许多厂商已经从基于静态签名的检测机制转移到下一代基于行为的的检测机制，更多的关注攻击者活动的模式，而不是和攻击者相关的某个事件、文件和IP。这一定程度上提高了检测的速率，但是检测只是应对这种攻击的第一步。如果检测机制不能提供完整的图景，就会导致一种安全的错觉，这是及其危险的。
# 3 检测基础设施中的威胁
## 理解威胁检测的原则
如果有人尝试去入侵你的环境，需要注意一个或更多的系统或网络组件。他们注意的东西可能刚开始不是威胁，但这可能是入侵的信号。下面是的威胁检测的重要和时效性原则，对每个企业来说都是必须的：
  * 尽可能收集所有的安全数据。应该记录发生在存储、处理、传播敏感数据的每个系统和设备上的重要信息。高级攻击可以关闭日志、编辑日志、甚至删除日志，因此收集日志信息就不够的，还应该收集网络流这样不能被擦去的数据。
  * 存储安全事件数据到统一的数据库。有所有设备的登录日志当然很好，可是当这些数据散布在整个企业的不同服务器上，当你想要查看时，就会比较麻烦。甚至日志数据有时候会被忽略掉。
  * 保护日志数据。收集日志数据的目的是因为攻击系统的人会想要擦掉他入侵的记录，因此这会让中央登录系统变成第二个攻击目标。日志存储的设备和系统必须要正确的配置，这样即使管理人员也不能修改、删除或者增加日志记录。
  * 生成有意义事件的告警消息。最小的系统每天也能生成M单位的日志数据，大一点的系统每天可以生成上G的日志。这么大量的日志数据，人们很难从中寻找到威胁。集中化的系统需要知道如何生成告警消息并发送给相应处理安全事件的工作人员。
  * 遵循响应步骤。对于每种可能生成的告警，工作人员都需要知道他们应该采取什么样的行动。响应流程应该是书面性的，而且应该进行检查和实践。
  * 记录对于威胁告警的响应。当告警产生以后，对于该告警消息产生的响应应该进行记录。这包括采取的措施、时间、以及执行的人。
  * 检查重要事件。重要事件需要进行复查，讨论事件的原因，和应对这种事件的所应该采取的变化，以及响应的有效性。