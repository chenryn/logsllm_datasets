User: How to monitor CPU and memory utilization and network traffic of Pods in Kubernetes using Prometheus and Grafana?
Assistant: Here are the steps on how to use Prometheus and Grafana to monitor the CPU and memory utilization and network traffic of Pods in Kubernetes: 1. Install Prometheus and Grafana: ``` $ kubectl create namespace monitoring $ helm install prometheus stable/prometheus \ --namespace monitoring \ --set alertmanager.persistentVolume.storageClass="gp2" \ --set server.persistentVolume.storageClass="gp2" \ --set alertmanager.persistentVolume.size="2Gi" \ --set server.persistentVolume.size=" 8Gi" $ helm install grafana stable/grafana \ --namespace monitoring \ --set persistence.storageClassName="gp2" \ --set persistence.enabled=true \ --set persistence.size="10Gi" ``` 2. Deploy node-exporter: ``` $ kubectl apply -f https://raw.githubusercontent.com/prometheus/node_exporter/master/examples/kubernetes/node-exporter.yml ``` 3. Deploy kube-state-metrics: ``` $ kubectl apply -f https://raw.githubusercontent.com/kubernetes/kube-state-metrics/master/examples/standard/rbac.yaml $ kubectl apply -f https://raw.githubusercontent.com/ kubernetes/kube-state-metrics/master/examples/standard/kubernetes-metrics.yaml ``` 4. Deploy the Prometheus Adapter: ``` $ helm repo add metrics-server https://charts.helm.sh/stable $ helm install metrics-server metrics-server/metrics-server $ helm repo add prometheus-community https://prometheus-community.github.io/helm-charts $ helm install prometheus-adapter prometheus-community/prometheus-adapter \ -- namespace monitoring \ --set prometheus.url=http://prometheus-server ``` 5. Configure Grafana: First, you need to log in to the Grafana console (the default user name and password are admin/admin). Next, you need to do the following: - Add a data source: Select "Configuration" -> "Data Sources" -> "Add data source" in Grafana, and enter the following information: Type: Prometheus Name: Prometheus URL: http:/ /prometheus-server:80 Access: Server (default) - Add Dashboard: Select "Dashboards" -> "Create" -> "Import" in Grafana, and enter the following information: JSON: https://raw.githubusercontent.com /kubernetes/ingress-nginx/master/deploy/grafana/dashboards/nginx-ingress.json Name: Nginx Ingress Controller - Modify Dashboard: Select "Dashboards" -> "Manage" -> "Nginx Ingress Controller" in Grafana, then Select "Edit" and modify the following: - Panel 1: Modify the "Namespace" and "Name" to specify the Pods to monitor - Panel 2: Modify the "Namespace" and "Name" to specify the Pods to monitor - Panel 3: Modify "Namespace" and "Service" to specify the service to be monitored 6. View monitoring indicators: In Grafana, you can view CPU utilization, memory usage, and network traffic. Different time frames can be selected to view historical data. Since Prometheus collects data periodically, monitoring metrics can be viewed in real time.