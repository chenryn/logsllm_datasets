linuxfu
Rial
cleaner
kis
|SM|
45
53
106
37
4827
14797
14783
27
16
73
46
57
5
32097
3
8
modhide
modhide1
# of eﬀective SM
Max |eﬀective SM|
Ad1 Ad2 Ad3
16
45
26
37
16
106
0
0
0
0
3
1
1
3
2
3
4
5
9
20
8
5
0
6
0
3
4
3
0
0
0
0
10
10
37
26
37
53
26
0
0
2
2
3
5
19
4
6
0
3
0
0
10
37
fuuld
hide lkm
0
0
0
37
13
16
16
0
0
0
0
0
0
0
0
0
3
16
0
0
0
13
4827
13
13
0
0
0
0
0
0
0
0
0
3
13
SK
10
10
1
16
13
superkit
10
10
1
16
13
14797
14769
14766
14783
0
2
10
1
5
0
17
0
1
12
0
2
10
0
5
0
2
0
2
11
14769
14766
hp
3
3
2
0
0
0
0
27
0
1
14
0
0
1
0
0
6
14
kbdv3
knark
linuxfu Rial
cleaner
5
5
4
0
0
1
1
0
16
4
0
2
0
1
0
0
8
5
20
19
9
0
0
2
2
1
4
73
1
4
0
3
0
0
10
20
5
4
8
0
0
1
0
5
0
1
46
0
0
1
0
0
7
8
7
7
0
0
0
1
1
0
6
4
0
57
0
2
0
2
8
7
0
0
3
0
0
0
0
0
0
0
0
0
5
1
2
2
4
3
kis
17
19
6
0
0
18
3
1
3
19
1
10
1
32097
1
5
13
19
modhide modhide1
0
0
0
0
0
0
0
0
0
0
0
0
2
1
3
2
3
2
0
0
0
0
0
1
2
0
0
0
0
2
2
5
2
8
6
5
If the rootkit used for the signature and the rootkit in the
tested run are identical, the entire signature was matched
giving |I| = |SM|. For example, the signatures of adore
0.38, SucKIT, and modhide rootkits fully match the kernel
runs with those rootkits (shown in italics). We consider
that a tested run includes a potential malware running if
one or more signatures have a matched element with the
kernel run. In our experiments, all kernel runs with rootkits
shared elements with one or more signatures, leading to the
detection of 16 kernel rootkits.
4.2 Similarities among Data Behavior Signa-
tures
In the previous section we demonstrated that a variety of
rootkits can be detected by using the signatures of a few clas-
sic rootkits because they have common data access patterns.
In this section we quantitatively measure the similarities in
data behavior across rootkits by generating and comparing
the signatures of the tested rootkits.
We ﬁrst generated the signatures of 16 kernel rootkits by
applying the set operations (Section 2.3) on ﬁve kernel runs
with rootkits and ﬁve benign kernel runs. Then we calcu-
lated the similarities among signatures by applying Algo-
rithm 1 on the combinations of 16 rootkit signatures. Table
3 lists the number of common data behavior elements in
such combinations. For a pair of rootkits M1 in the row
heading and M2 in the column heading, the cross section of
the corresponding row and column shows the number of data
behavior elements common in two signatures of M1 and M2.
This number may not be symmetric for M1 and M2 because
a data behavior element can have two representations for its
f ﬁeld (an oﬀset or a range of oﬀsets). If M1 and M2 are
the same rootkit, the number of elements is shown in italics.
For the rootkit M2 in the column heading, if positive num-
bers are listed in the column, the signatures of the rootkits
(in the row headings) can be used to determine M2. The
number of such signatures (except SM2 itself) is presented
at the second bottom row (# of eﬀective SM ). The max-
imum size of such signatures is shown in the bottom row
(Max |eﬀective SM|). In our experiments, a rootkit shares
its data behavior with 3∼13 of other rootkits (more than
seven rootkits in average). The rootkits show similar data
behavior not only among close variants (e.g., diﬀerent ver-
sions of adore rootkits) but also across the rootkits having
diﬀerent attack mechanisms (e.g., SucKIT shows similarities
with driver-based rootkits such as knark or kis).
The similarities of data behavior across rootkits are visu-
alized in Figure 4. A node represents a rootkit signature and
an arrow shows the similarity between two signatures using
three diﬀerent arrow types. An arrow from a node M1 to a
node M2 means that the signature M1 can be used to deter-
mine the rootkit of the signature M2. This ﬁgure illustrates
that several groups of rootkits have strong similarities. The
family of adore rootkits (i.e., adore 0.38, adore 0.53, and
adore-ng 1.56) are strongly related in general. The adore-ng
1.56 is connected to other versions with less strong connec-
tions, thick dashed arrows, because in newer adore versions
(bigger than 1.0 whose name is changed to adore-ng), the
internal attack vector is substantially changed to use dy-
namic objects instead of static objects. A group of rootkits
using the /dev/kmem memory device (i.e., SucKIT, hide_lkm,
fuuld, and superkit) have a strong relationship to one an-
other. The SucKIT and the superkit are especially connected
by using thick solid arrows because they share a majority
of data behavior. Some rootkits have relationships with dif-
ferent kinds of rootkits. For example, the kis rootkit is
connected to driver-based rootkits such as the adore rootk-
its and the knark rootkit; but, it is also closely related to
/dev/kmem based rootkits such as the SucKIT.
As seen in Figure 4, the data behavior is not only common
in the family of rootkits or similar kinds, but also is available
across diﬀerent kinds of rootkits. The signatures of these
related rootkits can be interchangeably used to detect one
another.
4.3 Extracting Common Data Behavior Ele-
ments
In this section we demonstrate the details of common
rootkit attacks which are systematically extracted based on
the similarities in rootkits’ data behaviors. The data behav-
ior elements from the signatures of all experimented rootkits
are ranked with the order of the appearance in rootkits’ sig-
natures (N ). The top elements are presented in Table 4 after
being classiﬁed into several categories.
The ﬁrst ﬁve columns present the contents of data behav-
ior elements (quintuple): the accessing code (c); the kind
of memory access (o) such as a read (R: o = 0) or a write
(W: o = 1); the kind of accessed memory (m) such as a dy-
namic object (D: m = 0) or a static object (S: m = 1); the
accessed memory’s class (i), which is converted to a data
hide_lkm
fuuld
SucKIT
superkit
Rial
adore 0.38
adore 0.53
modhide1
kis
modhide
knark
adore-ng 1.56
linuxfu
hp
kbdv3
cleaner
Figure 4: Similarities among the data behavior of rootkits. Types of arrows (|I|: # of the matched elements):
thin solid (0  30).
Table 4: Top common data behavior elements among the signatures of 16 rootkits (Ad1: adore 0.38, Ad2:
adore 0.53, Ad3: adore-ng 1.56, SK: SucKIT).
m Accessed data (i)
o
D task struct
R
R
D task struct
W D task struct
R
D task struct
W D task struct
W D task struct
W D task struct