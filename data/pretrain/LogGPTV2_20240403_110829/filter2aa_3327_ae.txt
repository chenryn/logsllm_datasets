attack simulation
(b) Selectivity
0
200
400
600
721
0
10
20
30
40
Average Conversion Rates
Minutes
Conversion [%]
O2 (30.67%)
C2H4 (9.81%)
HAc (29.06%)
(c) Conversion
0
200
400
600
721
0
0.2
0.4
0.6
0.8
Total Product Loss: 11.445,02 $
Minutes
Outflow [Kmol/min]
VAc
H2O
HAc
(d) Loss of ﬁnal product (decanter)
Figure 6.7: Analysis of the physical processes in the reactor
from 87% to under 82% and the amount of the secondary reaction increases by 4.32% on average
(Fig. 6.7a). Selectivity has also dropped to a lower level (Fig. 6.7b). Since selectivity is calculated
based on the ethylene consumed in both primary and secondary reactions, we can conclude that an
increase of the secondary reaction has a stronger effect on the reagents consumed than it has on
the products produced. In other words, the consumption of reagents is the more expressive metric
in this case. Fig. 6.7c plots the conversion rates for the main reagents in the reactor. Ideally, the
conversion rate of acetic acid is ≈ 37%, around 2% higher than the oxygen conversion. However,
due to the attack, the conversion rate of acetic acid drops beneath oxygen conversion, indicating
that the reaction kinetics have changed.This is because the newly induced secondary reaction also
consumes oxygen (even more than the primary reaction) At the same time the ethylene consumption
has increased. Therefore we can conclude that the amount of the primary reaction has decreased
(less acetic acid is converted), and the amount of ethylene combustion has increased. The result of
the attack on XMV(2) is a signiﬁcant reduction in production of the ﬁnal product (Fig. 6.7d)
6.6
Discussion
Our initial attacker model restricts the attacker from crossing any operational constraints. In reality
the attacker may suppress alarms while supplying the operator with good process values, e.g. using
32
Chapter 6. Attaining Attack Objectives
techniques proposed in our other work [29, 30].
We did check whether it might be beneﬁcial for the attacker to violate operational constrains
to cause more damage. Whereas we could almost double the loss in case of steady state attacks,
the increase of amount of damage in periodic attacks was modest. Note, that in certain cases
violation of operational alarms eventually moves the process into an unsafe state and triggers process
shutdown via interlocks. Suppressing safety alarms and interlock triggers requires additional and
more advanced hacking.
An attacker is not restricted to a single scenario. Many attacks are not mutually exclusive. It may
be possible to attack one part of the process and then later attack another part based on the success of
the ﬁrst. In hacker circles this is referred to as getting “multiple bites at the apple”. An attacker may
never have full knowledge of the process and the environment. It may also be impossible for the
attacker to fully test her code before deploying it. Chaining together multiple attacks into a single
payload maximizes the chance that one of them will have the desired effect.
7. Damn Vulnerable Chemical Process
One of the challenges of cyber-physical security research is the lack of large-scale test beds for
studying complex attacks and their effects on physical processes. Building such a testbed requires
not only signiﬁcant ﬁnancial investment and a specialized personnel but also regulatory permissions
to conduct potentially unsafe experiments. Moreover it would involve additional expenses to re-build
the testbed if it is broken as a result of successful offensive experiment. Out of this considerations
a more affordable way of conducting cyber-physical experimentation is to use testbeds in form of
simulation models.
In 1993 Down and Vogel published a model of an industrial chemical process (Tennessee
Eastmann process – TE) for the purpose of developing, studying and evaluating process control
technologies [15]. For many years their model has proved to be beneﬁcial to the process control
community serving as a realistic check on the the industrial and practical relevance of novel process
control solutions. Many publications have appeared about the TE process which became one the most
popular research process models. Not surprisingly, also the ICS security community has adopted the
TE model for studying the impacts of cyber attacks on physical processes (see e.g. [26, 43, 18, 7, 8]).
One disadvantage of the TE model are the missing details about chemical reactions and the
equipment involved. The dynamic behavior of the plant was provided in the form of a simulation
in Fortran code accompanied by a ﬂowsheet, a steady-state material balance, and a qualitative
description of the key process characteristics. As a result this implementation does not allow
studying speciﬁc research questions related to the modeled process. To address the continued interest
among researchers to have additional industrial benchmark processes, Luyben and Tyreus published
details of an industrial process for the production of Vinyl Acetate Monomer (VAC) in 1997 [39].
This model involves real non-ideal chemical components, a realistically large process ﬂow sheet and
consists of several standard unit operations that are typical of many chemical plants with the recycles
stream and energy integration. With that the VAC process model goes a step beyond the TE process
model.
34
Chapter 7. Damn Vulnerable Chemical Process
What makes chemical plants excellent case studies?
Chemical plants are large physical processes with very complex non-liner interdependencies.
Their models include disturbances with wide spectrum of dynamic behaviors. Also plant
models include simulation of controllers. Chemical plant models have challenging objective
functions to maintain: optimal production, safety and minimize production costs. Those
functions also allows to numerically evaluate the success of attack from several perspectives.
7.1
Framework description
Damn Vulnerable Chemical Process (DVCP) is an open-source framework developed for cyber-
physical security experimentation based on two above mentioned models of chemical plants [27, 28].1
DVCP allows to study what it takes to convert a cyber attack into a successful cyber-physical attack.
The frameworks are useful for offensive research to design individual attack instances and complex
attacks (combination of attack instances). Consequently the “defendors” can study resilience of
processes to cyber attacks and develop risk assessment methods, robust control algorithms, attack
detecting techniques, process-aware authentication methods, etc. The framework can be used
standalone or as a physical layer of the distributed industrial control systems infrastructure as it is
done e.g. at NIST [6]. Below we summarize our contribution to DVCP framework.
Tennessee Eastman Process
In our framework we use TE Matlab model developed by Ricker [48]. We redesigned the initial
model of the TE process to include simulation of data integrity and DoS attacks on sensor signals and
the manipulated variables (actuators) as shown in Fig. 7.3. Simulink model is multilayered and care
must be taken to ensure correct implementation and propagation of attack parameters through the
layers to individual controllers. A functional implementation of an integrity attack on an individual
controller at the lowest layer is illustrated in Fig. 7.2. Attack data are stored in the work space for
further the analysis and visualization. We enhanced the Simulink model with a user interface which
allows to set attacks with few mouse clicks. (Fig. 7.3). The user can select attack value, attack time
and its duration (predeﬁned or random) as well frequency of attacks (single or periodic). Several
attacks can be chained together or run in parallel. Besides, we enabled selection of the sampling
frequency of sensor signals (process data).
Original TE model does not allow any randomness in the simulations to guarantee the repeatabil-
ity of the plant operation disturbances. It means that each simulation run produced identical results.
It was a signiﬁcant disadvantage of TE model as it was not possible to statistically evaluate impact of
the attack strategies. We modiﬁed the original code by generating a new seed for the random number
generator for each simulation run while preserving underlying dynamics of process behavior. It is
now possible to switch off randomness or set a speciﬁc seed.
Vinyl Acetate Process
The authors of the Vinyl Acetate plant process built a rigorous nonlinear dynamic model of the
process to verify the feasibility of the simulation the plant. Details on the assumptions and details of
1Authors: Marina Krotoﬁl and Alexander Isakov
7.1 Framework description
35
Figure 7.1: Simulink model enhanced with attack blocks
Figure 7.2: Functional implementation of attack modeling in Simulink
the modeling are described in Section 5 in [39]. The simulation model was implemented in TMODS,
DuPont’s in-house dynamic simulation environment, and thus, is not available for public use. In
several academic works on vinyl acetate process models are implemented in specialized commercial
simulation tools such as HYSYS [12], Visual Modeler [51], Aspen Plus [51] and others. To make
process model available for a wider range of users Luyben et. al. have developed simulation model
36
Chapter 7. Damn Vulnerable Chemical Process
Figure 7.3: GUI for launching attacks
of VAM for Matlab[10, 9]. Both the steady state and dynamic behavior of the Matlab model were
designed to be close to the TMODS model.
Originally, process equations had been modeled in Matlab and then translated into C-routines.
The C coded is compiled into “MEX functions” and can be called within the Matlab environment.
A separate m-ﬁle is responsible for the control of the VAC process (scheduling of the C-routines)
with a developed multiloop SISO architecture. Additional four Matlab routines were developed for
plotting the results of the simulations. No simulation data were output to the workspace for further
analysis. The initial model did not provide any interface to process code and any manipulations of
the model inputs (e.g. setpoint or controller update) must have been carried out directly in the C code
requiring its re-compilation.
Considering the number of variables in the complex VAM process and the inconvenience of
manipulating the process within the source code, we have developed a Simulink model of the
process.2 Simulink provides an interactive, graphical environment for modeling, simulating, and
analyzing the dynamic systems at any level of details. Simulink models are compact enough to be
understood with moderate effort. The interactive nature of Simulink allows easy experimenting by
changing the model and its parameters and immediately observing what happens. Thus, modeling of
attack on a selected process component can be dome easily by adding a function block with several
lines of code. Such functionality suits well the “what if” nature of cyber-physical exploitation.
To allow users to beﬁt from the experience curve we intentionally designed a Simulink Model
for VAC process similar to one used in the TE model.3 We instrumented the Simulink model with
a user interface for convenient update of process parameters and setting up attacks on individual
2Initially we have developed user interface and attack codes without building a Simulink model. Several months of
experimentation have revealed limitations of such approach.
3We also named manipulated variables as XMV and controlled variables as XMEAS maintain consistent notation
between TE and VAM Simulink models.
7.1 Framework description
37
Figure 7.4: User interface for setting up attacks
components (Fig. 7.4). We also implemented an output of the simulated data to the workspace for
further analysis and enabled their automatic visualization (Fig. 7.5). We ﬁxed several implementation
mistakes in process code and also made several improvements to its control model to make process
more stable.
Figure 7.5: Visualization of simulation results
The advantage of the VAC model is that it is "‘built"’ out of realistic "‘components"’. With
the open source code one can easily modify process model by e. g. changing catalyst decay
conditions or adding dynamics of the pumps.
38
Chapter 7. Damn Vulnerable Chemical Process
7.2
Comparison of TE and VAM processes
This section gives a short comparison between Tennessee Eastman and Vinyl Acetate process models.
Involvement of the real non-ideal chemical components and the size of the process (Tbl. 7.1) make
Vinyl Acetate a more challenging process control problem.
TE
VAM
# sections
5
10
# states
50
246
# measurements
41
43
# MV
12
26
# modes
6
1
# setpoint changes
4
2
# disturbance modes
20
5
Process complexity
Medium
High
Table 7.1: Complexity of the process
Availability of literature on the VAC process speciﬁcs (Tbl. 7.2) allows to design targeted attacks. In
contrast, absence of the a priory information about the TE process makes it an excellent case study
for emulation of “grey-box” exploitation use cases. In addition, TE model includes a wide choice of
the disturbances with both plantwide and local effects what can make exploitation more challenging.
TE
VAM
Chemicals and reactions are speciﬁed
-
+
Equipment is speciﬁed
-
+
Safety constraints
+
+
Operating constraints
+
+
Operating cost function
+
−
Sensor signal noise
+
-
Process randomness
∓ 4
-
Predeﬁned process code
+
-
Literature on the process
∓ 5
+
Table 7.2: Speciﬁcation of the processes
In [40] authors specify a number of complexities and interesting dynamic effects of the VAM
process. Vinyl Acetate process quickly becomes unstable if pushed outside of the steady state
conditions. In contrast, controlling TE process is rather straightforward and the process is more
robust to malicious manipulations. Both processes have control loops with short and large time
constants and exhibit fast and slow dynamics depending on the input parameters of the process
(change in the operating conditions).
4Enabled by us
5Since the exact chemistry of TE process is unknown, there is no literature on the process details. However, there is a
large number of works on the topic related to TE process control, its safety and security. In contrast, VAM is a real process.
There is a large body of literature on the speciﬁcs of the individual unit operations and chemical reactions.
7.3 Potential applications
39
7.3
Potential applications
As was mentioned above, the models can be used standalone or as a physical layer6 of the distributed
industrial control systems reference architecture (Fig. 7.6). The latter is useful for researching
security questions at the upper layers of the reference architecture (networks and components). To
be precise, since process models also include controllers and an implemented control strategy, they
encompass layers 0-1 of the reference architecture (process and basic/regulatory control).
Field equipment
Level 0
Process
Level 1
Level 2
Level 3
Level 4
Basic control
Supervisory Control
Process management