④桥 Bridges（二层）
桥将两个异构的网络(拓扑结构、线缆类型和速度不同的网络)连接在一起，以便连接使用
相同协议的网段。桥将通信从一个网络转发至另一个网络。将使用不同传输速率的网络连接在
一起的桥可以缓存数据包，直至这些数据包被转发至较慢的网络，这称为存储转发设备。桥在
OSI 模型的第二层上工作，基于 MAC 地址。桥两侧的系统位于相同的广播域内，不过所在的冲
突域不同。
⑤交换机 Switches（二层）
交换机知道每个出站端口上所连接系统的地址，能够更有效地流量传递、建立隔离的冲突
域以及提高数据的总体吞吐量。在用于创建 VLAN 时，交换机也可以创建隔离的广播域。交换
机主要在 OSI 模型的第二层上工作，用于连接使用相同协议的网段，两侧的系统位于同一广
播域内，不过冲突域不同。一个交换机的每端口都是一个冲突域，使用 CSMA/CD 逻辑传输机制，
能够更有效率的在以太网络中传输。
如果是三层交换机，原理等同于路由器，两侧的系统位于不同的广播域和冲突域内。
⑥路由器 Routers
路由器用于控制网络上的通信流，在 OSI 模型的第三层上工作，用于连接使用相同协议
的网段，两侧的系统属于不同的广播域和冲突域。动态的路由协议有：RIP、OSPF 和 BGP。还
有一种叫做桥式路由器（Brouters）的东西，我没见过。如果路由失败，那么就默认进行桥接。
⑦网关 Gateways
网关能够连接使用不同网络协议的网络。通过将通信的格式转换为与每个网络采用的协议
或传输方法都兼容的形式，网关就可以负责从一个网络向另一个网络传输通信信息。网关也称
为协议转换器，既可以作为独立硬件设备，也可以作为一种软件服务(例如 IP-to-IPX 网关) 。
网关两侧的系统位于不同的广播域和冲突域内。网关具有很多类型，包括数据、邮件、应用、
安全和互联网。网关通常在 OSl 模型的第七层上工作。
B.2 传输介质(例如：有线、无线、光纤)
—123—
1.同轴电缆 Coaxial Cable
同轴电缆的设计使其能够完全抵抗电磁干扰(EMI) electromagnetic interference，能够
支持高带宽(对比同时代的其他技术)，并且提供比双绞线更长的可用长度。由于双绞线更加低
廉的成本且安装简便，它最终失去了其主导地位。同轴电缆的两端（末端）需要使用网段终结
器（50 欧姆电阻器）（2000 年以前读大学的，宿舍局域网都用过同轴网卡）。
①细缆/细同轴，也被称为 10Base2，通常用来将系统连接到粗缆主干线路。细缆可以扩
展到 185 米的距离，并且能够提供高达 10Mbps 的吞吐率。
②粗缆/粗同轴，也被称为 10Base5，可以扩展到 500 米的距离，能够提供高达 10Mbps 的
吞吐率。
2.基带和宽带线缆 Baseband and Broadband Cables
10Base2 线路中的 Base，就是表示线路的基带或宽带特性；10 代表速率，2 代表距离。基
带线缆一次只能够传输一个单独的信号，宽带线缆则可以同时传输多个信号。绝大多数网络连
线都采用基带线缆。然而，在特定的配置中使用时，同轴电缆可以被用作宽带连接，例如线缆
调制解调器。
3.双绞线 Twisted-Pair
有屏蔽层的双绞线被称为屏蔽双绞线（CTP）shielded twisted-pair，反正为非屏蔽双绞
线（UTP）。线缆的缠绕可以使线缆免受外部的无线电频率、电子和磁性干扰，并且降低了线
对之间的串扰。缠绕得越紧(每英寸进行的缠绕越多)，那么对内部和外部干扰以及串扰的屏蔽
也就越强，因此吞吐的能力也就越大(也就是说具有更大的带宽)。长度不超 100 米。
各类双绞线的速度也要搞清楚，懒得列出来了。（七类万兆，超五、六类是千兆）
4.铜导线 Conductors
铜导线存在电阻，这使得信号的强度和质量在超出线缆的长度时会降低。信号的这种降低
被称为衰减attenuation。阻燃线缆是一种用燃烧时不会释放毒烟的特殊材料包围的线缆连接，
就像传统的 PVC 覆盖布线。
5.光纤
单模：该模式具有小直径芯，减少电缆内光反射的次数。这可以有更大的传输距离，达到
80 公里，是多模光纤的 50 倍还多。
多模：这种模式使用比单模有更大直径的电缆。随后，增加光的反射。通常用于短距离。
传输距离可达 400 米。
塑料光纤(POF)：采用塑料芯和允许较大直径的纤维芯。信号失真是由于塑性大大增加，
这明显的限制了它的范围。传输距离约 100m。
B.3 网络访问控制设备（例如：防火墙、代理服务器）
1.防火墙 Firewalls
防火墙被用于阻止或过滤通信，可以基于内容、应用、协议、端口或源地址来阻止已知的
恶意数据、消息或数据包，能够对公共网络隐藏专用网络的结构和寻址方案，并提供日志记录、
审计和监控性能以及警报和基本的入侵检测系统（IDS）功能。TCP_Wrapper 软件包是一种基
于 TCP/IP 协议之上的、运行于 UNIX/Linux 系统、基于访问控制技术的一种网络防火墙软件。
—124—
防火墙分类是很基础的知识，必考：
①静态的数据包过滤防火墙 Static Packet-Filtering Firewalls（第一代）(第三层)
检查 IP 报文头部的数据进行通信的过滤。过滤规则基于于源地址、目的地址和端口地址。
静态过滤防火墙不提供身份验证，不区分数据包来源，来自专用网络内部还是外部。这种防火
墙也被称为屏蔽路由器或常用路由器。
②应用级网关(代理)防火墙 Application-Level Gateway Firewalls（第二代）(第七层)
应用级网关防火墙也称为代理防火墙，基于用于传送或接收数据的网络服务(也就是应用)
来过滤通信。每种应用类型都必须具有其自己的唯一代理服务器。因此，应用级网关防火墙包
括很多独立的代理服务器。由于每个信息数据包在通过防火墙时都必须经过检查和处理，因此
这种类型的防火墙性能不高。应用级网关在 OSI 模型的应用层(第七层)上工作。
③电路级网关（代理）防火墙 Circuit-Level Gateway Firewalls（第二代）(第五层)
电路级网关防火墙也称为电路代理，用于在可信合作伙伴之间建立通信会话，它在 OSI 模
型的会话层(第五层)上工作。SOCKS (来自安全套接字，就像 TCP/IP 端口一样)是电路级网关
防火墙的通用实现。相当于信道加密。这种防火墙只基于通信电路的终点名称(也就是源地址、
目的地址以及服务端口号)来许可或拒绝转发决策。它仍被视为第二代防火墙。
④状态检测防火墙 Stateful Inspection Firewalls（第三代）(第四层)
状态检测防火墙也被成为动态包过滤防火墙，要对网络通信的状态或环境进行评估。通过
查看源和目的地地址、应用习惯、起源地以及当前数据包与同一会话先前数据包之间的关系，
状态检测防火墙就能够为己授权的用户和活动授予广泛的访问权限，并且能够积极地监视和阻
止未授权的用户和活动。状态检测防火墙通常比应用级网关防火墙更为有效。状态检测防火墙
被视为第三代防火墙，并且在 OSI 模型的网络层和传输层(第三、四层)上工作，即网络层过滤，
会话层和应用层检查。
2.多宿主防火墙 Multihomed Firewalls
防火墙一般都具有多个接口(具有两个接口的防火墙被称为双宿主防火墙)。其实要 1 对接
口才能串接进网络，2 对接口可以管控 2 个子网。不过，这 2 个子网必须隔离，不能在防火墙
内实现数据交换。
堡垒主机/屏蔽主机 bastion host /screened host
位于专用网络和不可信网络之间的防火墙系统（边界设备），通常位于外联路由器之后。
堡垒主机不仅负责过滤进入专用网络的通信，而且还负责保护内部客户端的身份。术语"堡垒"
来源于中世纪的城堡建筑风格，其中堡垒警戒室位于主入口前面，也就是现在的门户岗亭。
利用堡垒主机(Bastion Host)和一台包过滤路由器构建，堡垒主机处于内网中提供代理服
务，包过滤路由器除提供过滤功能外，还被配置为只允许堡垒主机进行外部访问，所以内部主
机只能通过堡垒主机代理访问外部网络，安全性较高。
屏蔽子网 screened subnet
屏蔽子网与屏蔽主机(也就是堡垒主机)在概念上相似，是指包含堡垒主机的，位于外网、
内网两个路由器之间，1 个子网。是内部系统外联的一个代理区。
DMZ
就是屏蔽子网，是个网络隔离区（停火区/非军事区）。能够访问外网、内网，与外网、
—125—
内网间都有隔离手段。DMZ 常常是公共 Web、电子邮件、文件以及其他资源服务器的宿主。
3.防火墙的部署
①单层部署。只提供最低限度的保护，很简单。
②双层部署。使用多个防火墙，分别联外网、内网，形成一个 DMZ。中等安全。
③三层部署。在 DMZ 以内，再部署防火墙，区分不同等级的事务处理子网。太复杂了。
4.防火墙策略类型
①静默规则（要少日志）：不记录任何被过滤流量的日志，减少系统日志大小。
Silent rule,Drops “noisy” traffic without logging it. This reduces log sizes
by not responding to packets that are deemed unimportant.
②安全规则（要严登陆）：严格限定登陆和配置防火墙的终端设备，禁止未授权访问。
Stealth rule,Disallows access to firewall software from unauthorized systems.
③消除规则（最后一条）：配置在防火墙规则库（策略库）的最后一条，过滤所有不符合
前述规则的流量，并记录相关日志。
Cleanup rule,The last rule in the rule base, which drops and logs any traffic that
does not meet the preceding rules.
④限制规则（精细配置）：不能使用“ANY”等任意的、宽泛的策略，必须精细配置每一
条通信需要开放的 IP、服务和端口，实现通信完全受控。
Negate rule,Used instead of the broad and permissive “any rules.” Negate rules
provide tighter permission rights by specifying what system can be accessed and how.
5.网络地址转换(NAT)
防火墙可以改变每个外出流量的源地址(从可信不可信网络)到不同的地址。一个不可路由
的地址（私网地址）是不会被互联网路由器转发的，因此，如果远程攻击使用不可路由的内部
地址，是不能在开放的互联网上路由的。匿名是另一个使用 NAT 的理由。NAT 也极大地扩展了
组织的 IP 地址空间能力，使 IPv4 地址可以继续使用。详细的 NAT 在 C.5 章节里讲。
6.端口地址转换(PAT)
以前叫动态 NAT。PAT 是 NAT 的延伸，是将所有内部地址的源端口号的映射到一个可路由
IP 地址的不同端口上去。使用了 PAT 的端口映射技术，将允许防火墙跟踪多个通信会话。
7.入侵检测和防御系统(IDS/IPS)
有两大类：
*基于主机的 IDS/IPS，监控服务器和工作站的活动
*基于网络的 IDS/IPS，监控网络活动。
入侵检测的探测有好几种。在第 7 域 H.2 章节详述。
8.安全事件管理(SEM)/安全事件和意外管理(SEIM)
SEM/SEIM 是一个解决方案，包括，从各种不同的来源、服务器或资产信息中收集日志和
事件，并分析这个复杂情况，形成综合报告视图。同样，整个 IT 基础设施可以部署集中化的
大范围的 SEM/SEIM 系统，对日志和事件信息进行集中管理。SEM/SEIM 不仅将综合日志将进行
分析，根据既定怀疑模型，发现异常时还会发出警报。
—126—
B.4 端点安全（终端安全）
也就是终端安全。每个单独设备必须维护本地安全，不论其网络或通信通道是否提供安全。
有时这被表示为“末端设备应对它自己的安全负责”。每个系统都应该有合适的安全组合，包
含本地主机防火墙、反恶意软件扫描、身份验证、授权、审计和垃圾邮件过滤器以及 IDS/IPS
服务。还要打补丁，裁减服务什么的。等级防护评测最后肯定要检查终端的。
B.5 内容分发网络
内容分发网络 CDN（Content Distribution Networks），或叫内容转发网络，是一个资
源服务的集合，其部署在互联网许多数据中心上以提供低延迟、高性能、高可用性和承载的内
容。其实就是在各地的节点安装一个缓存服务器，提高并发访问效能。如今，CDN 服务是互联
网内容的一个主要服务分支，包括 Web 对象(文本，图形和文字)，下载对象(可下载媒体文件，
软件，文档)，应用(电子商务，门户网站)，流媒体直播，点播流媒体，社会网络。
B.6 物理设备
详见 B.1 章节。
C.设计与建立安全通信信道
为特定应用通信信道提供安全服务协议被称为安全通信协议。先列一些主流的安全通信协
议，重要的在后面再详细介绍：
1.用于安全通信的（必考）
①IP 简单密钥管理(SKIP) Simple Key Management for Internet Protocol
这是一种用于保护无会话数据报协议的加密工具（无线 WAP 用了）。SKIP 被设计为与 IPSec
相结合，并且在 OSI 模型的第三层上工作。SKIP 能够对 TCP/IP 协议族的任何子协议进行加密。
SKIP 在 1998 年被互联网密钥交换(IKE)替代。
②软件 IP 加密(swIPe) Software IP Encryption
这是另一种第三层 IP 安全协议。它通过使用封装协议来提供身份验证、完整性和机密性。
③安全远程过程调用(S-RPC) Secure Remote Procedure Call
这是一种身份验证服务，只是防止在远程系统上在未经授权的情况下执行代码的手段。
④安全套接层(SSL) Secure Sockets Layer
这是一种由 Netscape 开发的加密协议，目的是保护 Web 服务器和 Web 浏览器之间的通信。
SSL 可以被用于保护 Web、电子邮件、FTP 甚至 Telnet 通信的安全。SSL 是一个面向会话的协
议，使用对称密钥来加密数据，使用非对称密钥来进行对等认证（Peer Authentication）,
它提供了机密性和完整性。SSL 使用 40 位密钥或 128 位密钥进行部署。CISSP 认为 SSL 位于传
输层（网络层之上，应用层之下），实际上它由两个协议组成：一个工作在会话层的底部，另
一个工作在传输层的顶部。在 SSL 上运行的 HTTP 就是 HTTPS（HTTP Secure）。
POODLE 漏洞(Padding Oracle On Downloaded Legacy Encryption vulnerability)，可
被攻击者用来窃取采用 SSL3.0 版加密通信过程中的内容，又被称为“贵宾犬攻击”。虽然该
攻击利用有一定的难度，需要完全控制网络流量，但在公共 wifi 遍地都是和强调国家之间对
抗的 APT 背景下，该漏洞仍有不小的影响。它迫使用户放弃 SSL，选用 TLS。