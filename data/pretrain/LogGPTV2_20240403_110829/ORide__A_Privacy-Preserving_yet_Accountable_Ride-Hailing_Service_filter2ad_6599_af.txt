[5] Recommendation for Key Management, Part 1: General, SP 800-
57 Part 1 Rev. 4. Online: http://dx.doi.org/10.6028/
NIST.SP.800-57pt1r4, January 2016. Last visited: Feb. 2017.
Figure 4: Effect of Euclidean distance on the extra dis-
tances for the drivers (left) and on the waiting time for
the riders (right) w.r.t. different zone settings. Our results
show that the overhead added by ORide is reasonable.
case of a very strong adversarial SP is already large. In
special cases, such as concerts and sport events, the SP
can split a crowded zone into sub-zones, in order to ﬁnd
a balance for the aforementioned trade-off. For areas
that have fewer ride activities, such as other boroughs
in NYC or other cities, an entire borough or city can be
a zone. For example, a zone consisting of the boroughs
of Queens and Bronx would guarantee an anonymity set
of at least 26,000 for a ride, while requiring the drivers
to have an Internet connection of only at most 2 Mbps.
9.5 Effect on Ride Matching
To minimize the extra costs for both the drivers (e.g., gas
and driving time to pickup) and the riders (e.g., waiting
times at pick-up locations), ideally, the ride-matching al-
gorithm should take into account the road networks and
real-time trafﬁc conditions. Due to the limited opera-
tions supported by SHE, ORide uses a simpler matching
metric, i.e., Euclidean distances between the riders’ and
drivers’ locations. In addition, due to the bandwidth con-
straints, the ORide ride-matching algorithm matches a
rider to drivers in the same zone, hence suboptimality,
e.g., if a rider is close to the border of a zone, the closest
driver might be in one of the neighboring zones.
Fig. 4 shows the CDFs of the relative extra costs due
to the suboptimality of ORide, compared to the ideal so-
lution, w.r.t. thee different zone settings: Z1, Z2, and
the entire city of New York (NYC). The experiment
was done on a set of 1,000 randomly selected ride re-
quests. For the ideal matching, we used the Google
Maps Distance Matrix APIs [24] to compute the times
and distances between a pick-up request and the avail-
able drivers (see assumptions in Section 9.1). To reduce
the number of requests made to the Google APIs3, from
the set of available drivers, we selected 100 drivers who
were closest to the pick-up location as the potential can-
didates for the ideal matching.
It can be observed that the median extra costs are
3The number of requests per day is limited.
USENIX Association
26th USENIX Security Symposium    1249
 40 60 80 100 0 0.5 1 1.5Proportion of rides [%]Extra distance [km] 0 2 4 6Extra waiting time [min]Zone settings:Z1Z2NYC[6] A¨IVODJI, U. M., GAMBS, S., HUGUET, M.-J., AND KIL-
LIJIAN, M.-O. Meeting points in ridesharing: A privacy-
preserving approach. Transportation Research Part C: Emerging
Technologies (2016).
[7] ALBRECHT, M. R. On dual lattice attacks against small-secret
LWE and parameter choices in HElib and SEAL. Cryptology
ePrint Archive, Report 2017/047, 2017. http://eprint.iacr.
org/2017/047.
[8] ARFAOUI, G., LALANDE, J.-F., TRAOR ´E, J., DESMOULINS,
N., BERTHOM ´E, P., AND GHAROUT, S. A Practical Set-
Membership Proof for Privacy-Preserving NFC Mobile Ticket-
ing. Proc. of the 15th Privacy Enhancing Technologies Sympo-
sium (2015).
[9] BALDIMTSI, F., AND LYSYANSKAYA, A. Anonymous creden-
tials light. In Proc. of Conference on Computer & communica-
tions security (2013).
[10] https://www.bloomberg.com/view/articles/2016-
09-09/wells-fargo-opened-a-couple-million-fake-
accounts. Last visited: Jan 2017.
[11] http://uk.businessinsider.com/despite-its-
problems-uber-is-still-the-safest-way-to-order-
a-taxi-2014-12?r=US&IR=T. Last visited: Feb. 2017.
[12] https://newsroom.uber.com/updated-cancellation-
policy/. Last visited: Jan. 2017.
[13] CHAUM, D. Blind signatures for untraceable payments. In Proc.
of CRYPTO (1983).
[14] DAI, C., YUAN, X., AND WANG, C.
Privacy-preserving
ridesharing recommendation in geosocial networks. In Proc. of
Conference on Computational Social Networks (2016).
[15] http://www.dailydot.com/via/uber-lyft-safety-
background-checks/. Last visited: Feb. 2017.
[16] FAN, J., AND VERCAUTEREN, F. Somewhat Practical Fully
Homomorphic Encryption. Cryptology ePrint Archive, Report
2012/144, 2012. http://eprint.iacr.org/2012/144.
[17] FELDMAN, P. A practical scheme for non-interactive veriﬁable
secret sharing. In Proc. of Symposium on Foundations of Com-
puter Science (1987).
[18] http://www.forbes.com/sites/kashmirhill/2014/10/
03/god-view-uber-allegedly-stalked-users-for-
party-goers-viewing-pleasure/. Last visited: Jan. 2017.
[19] www.forbes.com/sites/ellenhuet/2014/09/08/
uber-lyft-cars-arrive-faster-than-taxis/
#3f819c3c5f73. Last visited: May 2017.
[20] GE, Y., KNITTEL, C. R., MACKENZIE, D., AND ZOEPF, S.
Racial and gender discrimination in transportation network com-
panies. Tech. rep., National Bureau of Economic Research,
2016. http://www.nber.org/papers/w22776. Last visited:
Jan. 2017.
[21] GOEL, P., KULIK, L., AND RAMAMOHANARAO, K. Optimal
pick up point selection for effective ride sharing. IEEE Transac-
tions on Big Data (2016).
[22] GOEL, P., KULIK, L., AND RAMAMOHANARAO, K. Privacy-
aware dynamic ride sharing. Trans. on Spatial Algorithms and
Systems (2016).
[23] https://support.google.com/trustedcontacts/?hl=
en. Last visited: Jan. 2017.
[25] http://www.ibtimes.co.uk/former-uber-employee-
reveals-drivers-used-tracking-technology-stalk-
celebrities-politicians-1596263.
2017.
Last visited:
Jan
[26] ISERN-DEY `A, A. P., VIVES-GUASCH, A., MUT-PUIGSERVER,
M., PAYERAS-CAPELL `A, M., AND CASTELL `A-ROCA, J. A se-
cure automatic fare collection system for time-based or distance-
based services with revocable anonymity for users. The Computer
Journal (2013).
[27] LAURIE, B., LANGLEY, A., AND KASPER, E. Certiﬁcate trans-
parency. https://tools.ietf.org/html/rfc6962, 2013.
[28] https://www.link.nyc. Last visited: Feb. 2017.
[29] LYUBASHEVSKY, V., PEIKERT, C., AND REGEV, O. On Ideal
Lattices and Learning with Errors Over Rings. Cryptology ePrint
Archive, Report 2012/230, 2012. http://eprint.iacr.org/
2012/230.
[30] MELCHOR, C. A., BARRIER, J., GUELTON, S., GUINET, A.,
KILLIJIAN, M., AND LEPOINT, T. NFLlib: NTT-Based Fast
Lattice Library. In Proc. of the RSA conference - The Cryptogra-
phers’ Track (2016).
[31] MILUTINOVIC, M., DECROIX, K., NAESSENS, V., AND
DE DECKER, B. Privacy-preserving public transport ticketing
system. In Proc. of Conference on Data and Applications Secu-
rity and Privacy (2015).
[32] https://www.nerdwallet.com/blog/utilities/best-
unlimited-data-plans/. Last visited: Feb. 2017.
[33] https://research.neustar.biz/2014/09/15/riding-
with-the-stars-passenger-privacy-in-the-nyc-
taxicab-dataset/. Last visited: Jan. 2017.
[34] https://newsroom.uber.com/philippines/new-
upfront-fares-on-uberx/. Last visited: Jan. 2017.
[35] http://www.oregonlive.com/today/index.ssf/2014/
11/sex_the_single_girl_and_ubers.html. Last visited:
Jan. 2017.
[36] http://oride.epfl.ch.
[37] http://www.orlandosentinel.com/news/breaking-
news/os-lyft-driver-arrest-sex-battery-20160929-
story.html. Last visited: Jun. 2017.
[38] PEDROUZO-ULLOA, A., TRONCOSO-PASTORIZA, J. R., AND
PEREZ-GONZALEZ, F. Number theoretic transforms for secure
signal processing. Trans. on Information Forensics and Security
(2017).
[39] PHAM, T. V. A., DACOSTA PETROCELLI,
I., JACOT-
GUILLARMOD, B., HUGUENIN, K., HAJAR, T., TRAM `ER, F.,
GLIGOR, V., AND HUBAUX, J.-P. PrivateRide: A Privacy-
Enhanced Ride-Hailing Service. In Proc. of Privacy Enhancing
Technologies Symposium (2017).
I.
[40] S ´ANCHEZ, D., MART´INEZ, S., AND DOMINGO-FERRER, J.
Co-utile P2P ridesharing via decentralization and reputation man-
agement. Transportation Research Part C: Emerging Technolo-
gies (2016).
[41] https://techcrunch.com/2016/11/29/just-like-
uber-lyft-launches-upfront-fares/. Last visited: Jan.
2017.
[42] http://thenextweb.com/insider/2016/12/13/uber-
tracks-customers-long-after-their-ride-is-over/.
Last visited: Jan. 2017.
[24] https://developers.google.com/maps/
documentation/distance-matrix/. Last visited:
2017.
Jan.
[43] http://toddwschneider.com/posts/analyzing-
1-1-billion-nyc-taxi-and-uber-trips-with-a-
vengeance/. Last visited: Feb. 2017.
1250    26th USENIX Security Symposium
USENIX Association
[44] https://github.com/toddwschneider/nyc-taxi-data.
Last visited: Jan. 2017.
[45] http://www.usatoday.com/story/tech/columnist/
stevenpetrow/2016/10/12/fake-uber-drivers-dont-
become-next-victim/91903508/. Last visited: Jan 2017.
[46] http://www.usatoday.com/story/tech/2014/11/19/
uber-privacy-tracking/19285481/.
2017.
Last visited:
Jan.
[47] https://www.uwgb.edu/dutchs/FieldMethods/
UTMSystem.htm. Last visited: Feb. 2017.
[48] http://www.wcnc.com/news/crime/uber-driver-
attacked-rider-over-politics-man-says/339458660.
Last visited: Jan 2017.
[49] http://wfla.com/2016/12/27/uber-and-lyft-
Last
drivers-worry-about-passenger-attacks/.
visited: Jun. 2017.
A Appendix
A.1 Covertly Active SP
Fig. 5 illustrates the changes introduced to the original
ride set-up procedure (Section 5.4) to handle a covertly
active SP. In this protocol, we introduce the notion of
Proof-of-Ride (PoR), a token that is used to prove to the
drivers that the rider is real, i.e., she did a ride in the past.
A.2 Plaintext Space
Assume a geographical area of size s× s and a plaintext
space of b bits to represent the squared-Euclidean dis-
tances between points in the area. The area can be quan-
tized into a grid with cells of size s/2(b−1)/2×s/2(b−1)/2,
with the explanation as follows. Assuming the area is
discretized into a grid of v× v cells, the largest possible
squared-Euclidean distance between any two points on
the grid is 2× v2, and this has to be at most 2b. There-
fore, v ≤ 2(b−1)/2. In other words, each edge of size s can
be discretized into v points, and the distance between any
pair of two consecutive points is s/2(b−1)/2. Therefore,
the area can be represented by a grid with cells of size
s/2(b−1)/2 × s/2(b−1)/2.
For example, with 20-bit plaintext space, a geographi-
cal area of size 60 km2, such as the borough of Manhat-
tan in NYC, would be quantized into a grid of resolution
approximately 10 m × 10 m.
A.3 Cryptographic Primitives
In this section, we brieﬂy describe the cryptographic
building blocks used in ORide.
Blind signatures. A blind-signature scheme [13] is
a form of digital-signature schemes in which the signer
does not know the content of the message that she is sign-
ing. This is achieved by enabling the signature requester
to ‘blind’ (i.e., randomize) the message before sending
it to the signer. When the signature requester receives
the signature on her blinded message, she ‘unblinds’ it
to obtain a valid signature for the original message. The
signer, when is asked to verify the signature of an un-
blinded message, is not able to link this message back to
the blinded version she signed.
Anonymous credentials. An anonymous credential
(AC) is a cryptographic token with which the credential
owner can prove to another party that she satisﬁes certain
properties without revealing her real identity. In ORide,
a user is identiﬁed when she obtains ACs from the SP.
However, when she wants to start an anonymous session,
she reveals to the SP only the expiration date and the role
speciﬁed in the AC (i.e., rider or driver), and she proves
to the SP, in a zero-knowledge fashion, that she knows
the private key associated with the AC. To prove her rep-
utation to a driver, a rider reveals to the driver the repu-
tation score speciﬁed in her AC together with the proof
to show that the revealed value is trustworthy. ORide
relies on the Anonymous Credentials Light (ACL) [9].
However, note that ACL is a linkable anonymous cre-
dential scheme, i.e., a user can only use a credential once
to avoid her transactions from being linkable.
Number-Theoretic Transform (NTT). An NTT is
the ﬁnite ring version of a Discrete Fourier Transform; an
n-point NTT of a vector xxx ∈ Zn
t and its inverse operation
NTT−1 have the form
(cid:34)n−1
(cid:34)
∑
i=1
n−1
xiαki
n−1
∑
k=1
Xkα−ki
k=0 =
XXX = [NTT(xxx)k]n−1
(cid:3)n−1
xxx =(cid:2)NTT
−1(XXX)k
k=0 =
(cid:35)n−1
,
k=0
(cid:35)n−1
,
i=0
where n−1 is the modulo inverse of n in Zt, and α is
a principal n-th root of unity in Zt, whose existence is
a necessary condition for the transform. The NTT can
be implemented with fast algorithms with complexity
O(nlogn), especially when n is a power of 2. The NTT
presents a convolution property, that relates the circular
convolution ((cid:126)) of two vectors with the component-wise
product (·) of their transformed versions, such that
xxx(cid:126) yyy = NTT
−1(NTT(xxx)· NTT(yyy)).
Therefore, an O(n2) operation like the convolu-
tion gets reduced to the complexity of the transforms
(O(nlogn)) and the component-wise product (O(n)). For
the used cryptographic application, the product operation
in the polynomial ring is a nega-cyclic convolution in-
stead of a cyclic one; this slightly changes its formula-
tion, and it imposes the requirement of a 2n-th root of
unity in Zt (we refer the reader to [38] for further de-
tails).
USENIX Association
26th USENIX Security Symposium    1251
Rider: anonymous session sR
SP
Driver: anonymous session sD
(1) z, dt, cccxR, cccyR, kkkp, PoR
(2) kkkp, PoR
[Steps (3) to (10) are the same as in Fig. 2]
(10) Fare report
(10a) rand
(10b) BsigSP{sigD{rand}}
(10c) PoR = sigSP{sigD{rand}}
Figure 5: Changes introduced to the original ride set-up protocols (Fig. 2) to handle covertly active SP.
1252    26th USENIX Security Symposium
USENIX Association