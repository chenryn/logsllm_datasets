No MAS:
Mike Davis
(misadventures in high security lock design)
Introduction
• I Hack stuff for IOActive
 Weird embedded stuff
• Amateur lock picker
 I’m not very good
• Pretty good understanding of how the pixies flow
• I’m not interested in hacking one thing, I want to hack all 
of the things.
2
Todays plan
• We’re going to (try to) think like a lock vendor
• Quick look at the evolution of ”High Security” lock design
 and a look at the seemingly pervasive flaw that these design 
requirements and decisions lead to.
• Look at how the same flaw keeps expressing itself.
• Discuss responsible cdisclosure a bit
3
Design Requirements!
• Lock
• Electronic
• Audit trail
• Long lived power solution
 Replacing batteries isn’t really an option.
• Permissions systems not entirely related to physical possession of 
the key
• Drop-in replacement for the traditional mechanisms.
 Mmm physical constraints…
• More secure-er then traditional (mechanical) designs!
 Because… electronic!
4
Lock Design
6
Lock Design + Security
7
Cyberlock
8
“As the CyberLock is directly powered through the communications port, it appears that an SPA (power 
analysis) attack may succeed against a CyberLock in-situ, as the lock leaks a significant power side-channel 
to any potential “key” as the processor slowly clocks the key across an I2C bus at the Fcpu/4 bps. However, 
this approach seems somewhat overboard given the existing issues.”
-IOActive Cyberlock Advistory
Cyberlock – power hungry
• I Hack stuff for IOActive
9
Some lessons learned
• Pluses
 Drop in replacements for classical design
 Locks don’t need batteries
 Audit trails and permission systems
• Minuses
 Bullshit crypto
 Reliant on external power
 Could not be fixed
10
A Quick Tangent
11
Yet Another Design
• I Hack stuff for IOActive
12
Some lessons learned
• Pluses
 Cheap
 Battery failure doesn’t kill safe
• Minuses
 Still reliant on external power
 Introduction of secondary side-channels (beep)
13
Another quick Tangent
14
15
“So, here’s where the money is stored in an ATM, as you can see it's protected with this heavy door; which in the old 
days criminals were trying to break into this, so by now they are more sophisticated” – Guy I owe a beer to.
16
17
QUESTIONS?
18
No MAS:
Mike Davis
(misadventures in high security lock design
No MAS:
AuditCon
Gen2
S2000
”Encrypted”
22
The combinations, ATM, bank and master, are typically stored in encrypted form as an added security factor; 
the form of encryption is not critical. The preferred encryption is to distribute the bits of a binary representation 
of the combination in various locations of a memory and filling the unoccupied locations in the memory with 
random binary bits to disguise the combination. Decryption involves removal of the random binary bits and 
reassemblage of the remaining bits representing combination. Other encryption/decryption schemes may be 
used in lieu of the preferred scheme if desired.
- Patent US5488660A
•
There is no cryptography used, there is just no room for it
•
The Locks load their personality on every single boot before accepting combinations
•
Every lock is identical with the exception of their EEPROM contents
•
Each type of lock works a bit differently
23
What exactly is encrypted?
24
[  SOFT I2C REQ  ]
[
HARDWARE I2C RESPONSE                                                ]
Soft I2C
• I Hack stuff for IOActive
25
Hardware I2C
• I Hack stuff for IOActive
26
Pop!
27
Demo!
28
“Gen2”
AuditCon
“… but what about Gen2?”
*gen2 is… interesting..
Done Right?
• Write advisory
• Do disclosure
• …DEFCON
30
Fuuuuuuu.
• Sometimes Kaba != Kaba
• We called the wrong Kaba, but they make locks too!
• From pictures of their locks found online they seem to share 
the same design pattern
 (https://www.keypicking.com/viewtopic.php?f=100&t=8680)
• “I believe that you will find that the X-09 design different 
enough to be much more of a challenge. If you are 
experimenting on an X-10 lock, you have obtained the lock 
illegally and whoever from the U.S. provided / sold you the 
lock will be pursued by U.S. Federal agents.”
31
32
No MAS:
Mike Davis
(misadventures in high security lock design
No MAS:
Mike Davis
(misadventures in high security lock design
X-08
X-09
37
38
WHY REDUNDANT DESIGN MATTERS..
No MAS:
Mike Davis
(misadventures in high security lock design
No MAS:
Mike Davis
(misadventures in high security lock design
But… What about the X-10?
“Based on the information presented at the meeting, it does not look like it would be 
beneficial to spend any time looking at the X-10 model.”
- GSA
Questions?
PI:EMAIL
Did I even leave time for questions?