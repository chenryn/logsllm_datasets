0.8
16/16
0
0.9
16/16
0
16/16
16/16
16/16
0
0
0
16/16
16/16
16/16
0
0
0
2/16
3/16
16/16
16/16
16/16
0.95
16/16
2/953
16/16
2/953
16/16
2/953
16/16
2/953
10000
Table XV: Detection Rate and False Positive Rate for Dif-
ferent Θ𝑏𝑜𝑡 and 𝐶𝑛𝑡𝑏𝑖𝑟𝑐ℎ
0
0
0
0
0
3/16
0
used for downloading/uploading ﬁles, thereby dominating
the trafﬁc proﬁle of the host. In this case, if we use the
trafﬁc proﬁle of the entire host (e.g., the average ﬂow size
and number of destination IP addresses) to detect the bot, the
bot behavior will be concealed by the Bittorrent trafﬁc.
As a consequence, the detection approaches such as [19],
which use the trafﬁc proﬁle of the entire host for detection,
will lose effectiveness.
However, since our system leverages ﬁne-grained infor-
mation of ﬁngerprint clusters, which describe the proﬁles of
P2P applications instead of entire host, it can still detect
bots even if their underlying hosts are running legitimate
P2P applications. The hierarchical
tree for detection is
presented in Figure 5(b), where Waledac bots and Storm
bots still form dense clusters. Compared to the hierarchical
tree in Figure 5(a), the tree structure in Figure 5(b) stays
stable, which is not affected by the overlaid legitimate
P2P applications. It is because the distance of two bot-
compromised hosts is based on the minimum distance of
ﬁngerprint clusters from two P2P bots, the new ﬁngerprint
clusters introduced by the P2P application would not affect
the minimum distance.
In 𝐷2, our system identiﬁed 26 P2P clients, where 25
out of them exhibit persistent P2P behaviors. With Θ𝑏𝑜𝑡 =
0.95, we cut the tree at 0.475, and identify three groups
of hosts (18 in total). Among these 18 suspicious hosts,
all 16 P2P bots are successfully identiﬁed with a low false
positive rate (0.2%). The detection result is not affected by
the overlaid trafﬁc from legitimate P2P applications. This
demonstrates that our system can effectively detect bots even
if bot-compromised hosts run legitimate P2P applications.
4) Detection Performance in Special Cases
It is possible that in the monitored network, only two hosts
are compromised by bots from the same botnet. We applied
our system on data set 𝐷′
2, and achieved the detection rate
of 100% and false positive rate of 0.2%.
It is also possible that the monitored network is “clean”,
where no host is compromised by P2P bot. In this case, the
false positive is a concern. We applied our system on 𝐷′
1,
which simulates a “clean” network environment, where we
get a low false positive rate of 0.2%.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:47:04 UTC from IEEE Xplore.  Restrictions apply. 
130Cluster Dendrogram
Cluster Dendrogram
Cut at
Θbot ∗ hightmax = 0.47516
5
.
0
4
.
0
3
.
0
2
.
0
1
.
0
0
.
0
x
a
m
e
c
t
n
h
a
t
g
s
i
D
h
i
C
@
3
T
B
2
m
r
o
t
S
6
m
r
o
t
S
0
1
m
r
o
t
S
1
1
m
r
o
t
S
9
m
r
o
t
S
3
1
m
r
o
t
S
8
m
r
o
t
S
4
m
r
o
t
S
5
m
r
o
t
S
3
m
r
o
t
S
1
m
r
o
t
S
7
m
r
o
t
S
2
1
m
r
o
t
S
1
c
a
d
e
a
W
l
2
c
a
d
e
a
W
l
3
c
a
d
e
a
W
l
C
@
1
T
B
C
@
2
e
p
y
k
S
2
s
e
r
A
1
s
e
r
A
l
1
e
u
m
E
l
2
e
u
m
E
C
@
3
e
p
y
k
S
C
@
1
e
p
y
k
S
1
t
n
e
r
r
o
t
t
i
B
2
t
n
e
r
r
o
t
t
i
B
1
e
r
i
w
e
m
L
i
2
e
r
i
w
e
m
L
i
5
.
0
4
.
0
3
.
0
2
.
0
1
.
0
0
.
0
e
c
n
a
t
s
D
i
1
e
p
y
k
S
2
e
p
y
k
S
C
@
1
T
B
l
2
e