WARNING: Unable to locate/open X configuration file
New X configuration file written to '/etc/X11/xorg.conf
输出的信息，表示重新生成了xorg.conf文件。然后，重新启动系统。
（8）检查NVIDIA显卡驱动是否成功安装。首先检查GLX模块，执行命令如下所示：
root@kali:~# glxinfo | grep -i "direct rendering
direct rendering:Yes
检查NVIDIA驱动模块。执行命令如下所示：
 37 ·
---
## Page 50
第1篇Linux安全渗透测试基础
root@kali:~# Ismod| grep nvidia
nvidia
944288029
i2c_core
24129 2 i2c_i801,nvidia
root@kali:~# Ismod | grep nouveau
通过查看以下文件的内容，确定开源的NVIDIA驱动nouveau是否被加入黑名单，如
下所示：
root@kali:~# cat /etc/modprobe.d/nvidia.conf
alias nvidia nvidia-current
remove nvidia-current rmmod nvidia
root@kali:~# cat /etc/modprobe.d/nvidia-blacklists-nouveau.conf
# You need to run “update-initramfs -u” after editing this file.
#see #580894
blacklist nouveau
root@kali:~# cat/etc/modprobe.d/nvidia-kernel-common.conf
alias char-major-195* nvidia
# To enable FastWrites and Sidebus addressing, uncomment these lines
# options nvidia NVreg_EnableAGPSBA=1
# options nvidia NVreg_EnableAGPFW=1
看到以上输出信息，就表示nouveau已被加入黑名单。
为了加快用户破解一些大数据文件，需要安装CUDA（ComputeUnifiedDevice
Architecture）。CUDA是一种由NVIDIA推出的通用并行计算架构，该架构使GPU能够
解决复杂的计算问题。
安装NVIDIACUDA工具集和NVIDIAopenCL。执行命令如下所示：
执行以上命令后，如果输出过程中没有出错的话，表示该软件包安装成功。以后就可
以使用CUDA破解加密的大数据文件。
2.3应用更新和配置额外安全工具
本节将介绍更新Kali的过程和配置一些额外的工具。这些工具在后面的章节中将是有
上下载的软件包更有用。本节将通过更新安装的方法，获取Nessus的一个激活码。最后安
装Squid。
应用更新和配置额外安全工具的具体操作步骤如下所示。
（1）更新本地软件包列表库。执行命令如下所示：
root@Kali:~# apt-get update
执行以上命令后，需要等待一段时间。执行完后，会自动退出程序。
（2）升级已存在的包。执行命令如下所示：
root@Kali:~# apt-get upgrade
·38 *
---
## Page 51
第2章配置KaliLinux
（3）升级到最新版本。执行命令如下所示：
root@Kali:~# apt-get dist-upgrade
(4）从 http://www.nessus.org/products/nessus/nessus-plugins/obtain-an-activation-code 官
网获取一个激活码。在浏览器中输入该地址后，将显示如图2.2所示的界面。
竹★章
Goo百度学的访间出楼了百度下.你就道abeblnk
tenable
三
ObtainanActivation Code
Using Nessus at
Worki
Using Nessus at
图2.2
获取激活码
在该界面选择免费版UsingNessusatHome?选项，单击Select按钮，将显示如图2.3
所示的界面。
htp/ww.tenaDC Nesss Home|Tenable  X
介★章
Gcog甜译图百度-的访问出措了图百度一下，你就知道aboutblank
Nessus'Home
Register for an
able Nessus Home allows you to scan your personal ho
Activatlon Code
work (up to 16 IP addresses per scanner with the same high-
ments end egentiess scenning
e note that Nessus Home does not provide access to
suasuoo jo sxpaup aouedwoo wuoped on nof moge uodd
idits, or allow you to use the Nessus virtual eppliance. If you
quire support and these additional features, pleese purchase a
[Chia
ent only. It is not for use by any con
cla
check to reo
图2.3注册信息
•39 ·
---
## Page 52
第1篇Linux安全渗透测试基础
在该界面填写一些注册信息，填写完后，单击Register按钮，将在注册的邮箱中收到
一份邮件。进入邮箱后，可看到该邮件中有一个激活码。
（5）为Nessus网络接口创建一个用户账户。执行命令如下所示：
root@Kali:~#/opt/nessus/sbin/nessus-adduser
Login : admin
#输入用户名为admin
Login password :
#输入用户密码
Login password (again) :
#输入确认密码
Do you want this user to be a Nessus 'admin’ user ? (can upload plugins, etc..) (y/n) [n]: y
User rules
#用户规则
nessusd has a rules system which allows you to restrict the hosts
that admin has the right to test. For instance, you may want
him to be able to scan his own host only.
Please see the nessus-adduser manual for the rules syntax
Enter the rules for this user, and enter a BLANK LINE once you are done :
(the user can have an empty rules set)
#按下空格键提交输入
Login
: admin
Password
：***8*****e*
This user will have 'admin' privileges within the Nessus server
Rules
Is that ok ? (y/n) [y] y
：
User added
#用户被添加
从输出的信息中可以看到admin用户被添加成功了。
（6）激活Nessus。执行命令如下所示：
root@Kali:~#/opt/nessus/bin/nessus-fetch--registerXXXX-XXXX-XXXX-XXXX-XXXX
以上命令中的XXXX-XXXX-XXXX-XXXX-XXXX指的是在邮件中获取到的激活码。
执行以上命令后，输出信息如下所示：
Your Activation Code has been registered properly - thank you.
Now fetching the newest plugin set from plugins.nessus.org
#等待一段时间
（7）启动Nessus服务。执行命令如下所示：
root@Kali:~#/etc/init.d/nessusd start
在第（6）步骤中激活Nessus时，输出和以上相同的信息，表示没有激活Nessus。这
个问题在RHEL上不会出现的。不过，这里有方法来解决这个问题。具体操作步骤如下
所示。
（1）删除文件nessus-fetch.rc。执行命令如下所示：
root@Kali:~#rm/opt/nessus/etc/nessus/nessus-fetch.rc
（2）使用nessus-fetch--challenge获取挑战码。执行命令如下所示：
Challenge code:xxxxxxxxxxxxxxxxxxxxxxxx
You can copy the challenge code above and paste it alongside your
Activation Code at:
---
## Page 53
第2章配置KaliLinux
https://plugins.nessus.org/offline.php
其中，xxxxxxxxxxxxxxxxxxxxxxxx是输出的挑战码。
(3）重新登录 http://www.nessus.org/products/nessus/nessus-plugins/obtain-an-activation-
code网站获取激活码。
（4）登录https://plugins.nessus.org/offline.php网站，在该界面输入生成的挑战码和激活
码，如图2.4所示的界面。
Tenable Network Security = Iceweasel
EileEdt yiewHigtory BookmarksIoolsHelp
O Tenable Network Security
+
php
Iloffensive Security , Kali Linux , Kali Docs Exploit-DB Aircrack-ng
tenable
ort& Tra
图2.4获取插件
此时单击Submit按钮，将显示如图2.5所示的界面。
Tenable Network Security - lceweasel
-口x
EileEdit View HistoryBookmarksTools Help
O Tenable Network Security
+
Most VisitedIiOffensive Security , Kali Linux , Kali Docs MlExploit-DB  Aircrack-ng
Thank you. You can now obtain the newest Nessus plugins at :
http:/plugins.nessus.org/get.php?f=all-2.0.tar.gz&u=c725ab5a948e49b8a564c5b79336409f&
p=eb02c79d67t9859d891f27b74dc5d1f0
You also need to copy the following file to :
• /opt/nessus/etc/nessus/nessus-fetch.rc (Unix)
• C:Documents and Settings\All Users\Application Data/TenableNessusiconfnessus-
fetch.rc (Windows XP/2K3)
● C:ProgramData/iTenable(Nessus/confnessus-fetch.rc (Windows Vista/7/8/2008/2012)
● /Library/Nessus/run/etc/nessus/nessus-fetch.rc (Mac OS X)
• /usr/local/nessus/etc/nessus/nessus-fetch.rc (FreeBSD)
nessus-fetch.rc
图2.5下载插件
· 41 ·
---
## Page 54
第1篇Linux安全渗透测试基础
从该界面下载nessus-fetch.rc和all-2.0.tar.gz，将其下载到本地。
（5）将下载到的nessus-fetch.rc文件复制到/opt/nessus/etc/nessus/目录下。执行命令如
下所示：
root@Kali:~#cp/root/nessus-fetch.rc /opt/nessus/etc/nessus
执行以上命令后，没有任何输出信息。
（6）使用nessus-update-plugins命令将Nessus的插件all-2.0.tar.gz加载。执行命令如下
所示：
root@Kali:~#/opt/nessus/sbin/nessus-updlate-plugins /root/al/all-2.0.tar.gz
Expanding /root/all/all-2.0.tar.gz..
Done. The Nessus server will start processing these plugins within a minute
（7）重新启动Nessus服务。执行命令如下所示：
root@Kali:~#/etc/init.d/nessusd restart
SShutting down Nessus :.
$Starting Nessus:
以上步骤操作完成后，Nessus就被激活了。如果不激活Nessus，它是不能使用的。
在Kali中安装Squid服务。执行命令如下所示：
root@Kali:~# apt-get install squid3
设置Squid服务开机不自动启动。执行命令如下所示：
root@Kali:~#update-rc.d -f squid3 remove
2.4设置ProxyChains
ProxyChains是Linux和其他Unices下的代理工具。它可以使任何程序通过代理上网，
允许TCP和DNS通过代理隧道，支持HTTP、SOCKS4和SOCKS5类型的代理服务器，
并且可配置多个代理。ProxyChains通过一个用户定义的代理列表强制连接指定的应用程
序，直接断开接收方和发送方的连接。本节将介绍设置ProxyChains的方法。
设置ProxyChains的具体操作步骤如下所示。
（1）打开ProxyChains配置文件。执行命令如下所示：
root@Kali:~# vi /etc/proxychains.conf
执行以上命令后，打开文件的内容如下所示：
# proxychains.conf VER 3.1
#
HTTP,SOCKS4,SOCKS5 tunneling proxifier with DNS
# The option below identifies how the ProxyList is treated.
# only one option should be uncommented at time,
# otherwise the last appearing option will be accepted
#dynamic_chain
# Dynamic - Each connection will be done via chained proxies
· 42 ·
---
## Page 55
第2章配置KaliLinux
# all proxies chained in the order as they appear in the list
# at least one proxy must be online to play in chain
# (dead proxies are skipped)
#otherwise EINTR is returned to the app
#
strict_chain
#
#Strict-Each connection will be done via chainedproxies
# all proxies chained in the order as they appear in the list
# all proxies must be online to play in chain
#otherwise EINTR is returned to the app
#random_chain
#
#Random- Each connection will be done via random proxy
# (or proxy chain, see chain_len) from the list.
# this option is good to test your IDS :)
输出的信息就是proxychains.conf文件的内容。由于篇幅的原因，这里只列出了部分
内容。
（2）将proxychains.conf文件中的dynamic_chain前面的注释符取消。要修改的配置项，
是上面加粗的部分，如下所示：
dynamic_chain
（3）添加一些代理服务器到列表（proxychains.conf文件末尾），如下所示：
#ProxyList format
#
type host port [user pass]
#
(values separated by 'tab' or “blank')
#
#
#
Examples:
#
#
socks5
192.168.67.78
1080
lamer
secret
#
http
192.168.89.3
8080
justu hidden
#
socks4
192.168.1.49
1080
#
http
192.168.39.93
8080
#
#
#
proxy types:http, socks4,socks5
#
( auth types supported: “basic"-http
“user/pass"-socks)
#
[ProxyList]
# add proxy here ...
#meanwile
# defaults set to “tor”
socks4127.0.0.1 9050
socks5 98.206.2.31893
socks5 76.22.86.170 1658
插入
以上信息中加粗的部分为添加的代理服务器。
（4）通过用户的连接代理解析目标主机。执行命令如下所示：
root@kali:~# proxyresolv www.target.com
默认情况下，执行proxyresolv命令，可能看到该命令没找到错误信息。因为proxyresolv
保存在/usr/lib/proxychains3/目录中，而不能被执行。proxyresolv会被proxychains调用，所
• 43 *
---
## Page 56
第1篇Linux安全渗透测试基础
以将这两个文件放在一个目录中，如usr/bin。执行命令如下所示：
root@kali:~#cp/usr/lib/proxychains3/proxyresolv/usr/bin/
执行完以上命令后，proxyresolv命令就可以执行了。
（5）通过用户想要使用的应用程序运行ProxyChains，例如，启动msfconsole。执行命
令如下所示：
root@kali:~# proxychains msfconsole
ProxyChains-3.1 (http://proxychains.sf.net)
[DNS-request] 0.0.0.0
[S-chain]-<>-127.0.0.1:9050-
执行以上命令后，看到msf>提示符表示msfconsole启动成功了。表示ProxyChains设
置成功。
2.5目录加密
在Kali中提供了一个目录加密工具TrueCrypt。该工具是一款开源的绿色加密卷加密
软件，不需要生成任何文件即可在硬盘上建立虚拟磁盘。用户可以按照盘符进行访问，所
以虚拟磁盘上的文件都被自动加密，访问时需要使用密码解密。TrueCrypt提供多种加密算
法，包括AES、Serpent、Twofish、AES-Twofish和AES-Twofish-Serpent等。本节将介绍
TrueCrypt工具的使用。
2.5.1创建加密目录
使用TrueCrypt工具加密目录。具体操作步骤如下所示。
（1）启动TrueCrypt工具。在终端执行如下所示的命令：
root@kali:~# truecrypt
· 44 ·
---
## Page 57
第2章配置KaliLinux
执行以上命令后，将显示如图2.6所示的界面。
TrueCrypt
Volu
Favorites Tools Settings Help
Slot
Volume
Size Mount Directory
Type
1
2
3
 4
5
6
7
8
9
10
11
12
 Create Volume
Wipe Cache
Volume
V
Select File..
 Never save history
Volume Tools.
Select Device.