**技术交底书**
  -------------------------------------- ------------------------------------------ -------------------- ---------- ---------------
  **发明名称**                           **一种对海量数据热搜索的自动加速的方法**                        **案号**   
  **关键词**                                                                                                        
  **专利方案是否已在公司产品上应用**                                                否 是 ：                        
                                                                                    （产品名称）                    
  **专利方案是否即将在公司产品上应用**                                              否 是 ：                        
                                                                                    （产品名称）日志易              
  **备注**                                                                                                          
  -------------------------------------- ------------------------------------------ -------------------- ---------- ---------------
  ------------------------ --------------------------- ---------------------------- ----------------
  **发明人姓名**           绕琛琳                      梁玫娟                       （第三发明人）
  **工号**                                                                          
  **入职时间**             15101127811                 18513600216                  
  **座机**                 PI:EMAIL   PI:EMAIL   
  **手机**                                                                          
  **邮箱**                                                                          
  **所属项目组**                                                                    
  **部门主管**                                                                      
  **奖金比例**                                                                      
  **第一发明人身份证号**                               362502198801110219           
  ------------------------ --------------------------- ---------------------------- ----------------
> 1 发明名称：
一种热搜索的自动加速的方法
2.  详细介绍技术背景,并描述已有的与本发明最相近似的实现方案
> 关于本发明的背景技术，请您简单介绍现有的一、两种现有技术的实现方法。该现有技术必须是与本发明相关的现有技术，且该现有技术必须存在本发明所能解决的技术问题）
在信息技术飞速发展的今天，人们在各种社会和经济活动中产生大量的数字信息，企业信息技术基础设施建设规模不断扩大，IT监控、运维系统也得到广泛运用，同时各种传感器、智能家电产生的数据，以及各种交易系统（证券交易系统、电子商务交易系统）产生的交易数据等数量巨大。
在IT环境中，大多数设备每天生成日志。这些日志对于操作、统计、消除缺陷和其他管理工作是非常重要的。一般地，日志条目是非结构化数据。为了促进这些任务，解析非结构化日志并且将有价值的信息存储到数据库中是常见惯例。然而，当管理大型IT环境比如全球公司时，或者向大量消费者提供云服务时，日志量可能是巨大的。从数百亿记录内找到合适的信息是困难且耗时的任务。
现有日志搜索管理大多采用搭建ELK平台(分布式日志搜索平台，由Elasticsearch搜索服务器，Logstash数据收集引擎，Kibana可视化平台等工具组成)来实现日志的搜索，其中Elasticsearch基于Lucene搜索引擎(全文搜索引擎)，提供了index(索引)存储、集群管理、搜索等功能；Logstash负责日志采集；Kibana则提供日志查询界面，具体由Logstash采集日志，并统一存储在Elasticsearch集群，用户通过Kibana发起日志搜索请求时，在集群中查找对应的日志并在Kibana展示。
3 现有技术的缺点是什么？
（客观评价现有技术的缺点，他们存在的问题必须是本发明所能够解决的问题，如果不能解决，可以不用提，如果无法指出存在的问题，可以不介绍现有工具的实现方法，只说用户有这种需求即可）
传统方法检索数百亿的大量数据，常规的完整的执行询需要耗费很长时间才能返回结果，用户想尽快知道数据情况，需要通过一种加速搜索的方式获取概要数据信息。
4.  本发明技术方案的详细阐述，应该结合流程图、原理框图、电路图、时序图进行说明
> （越详细越好；最好能够配合流程图和结构图等进行说明。发明中每一功能的实现都要有相应的技术实现方案，以别人不看附图即可明白技术方案为准；所有英文缩写都应有中文注释；所有附图都应该有详细的文字描述，同时附图中的关键词或方框图中的注释都尽量用中文；方法专利都应该提供一个流程图，并提供相关的系统装置.
-   含有程序的方法发明：该类申请包括解决特定技术问题的应用程序和计算机硬件系统，应结合相关硬件，按相应的应用程序流程图来描述该程序所执行的各个功能，即实现各个功能的步骤等，可以设计相关的工艺参数、数学模型和操作条件。）
具体步骤如下：
1)  采集日志数据，抽取时间信息，提取相关的关键字段（系统内置正则表达式规则，也可由用户自定义），对其命名（field_name），建立field_name=field_value（field_value为抽取的关键字段）；
2)  对日志数据建立索引，用户通过输入搜索语句进行查询；
3)  根据搜索引擎接收到的查询语句进行分析，解析热语句，统计热点字段的查询频率并进行排序；
4)  根据搜索引擎现有的索引字段的情况（列存的读取频率、索引的读取频率），对上一步的统计结果进行过滤，记录下查询频率高但并不是现成存在的字段，将这些字段列为待加速字段
5)  对过滤出来的待加速字段，针对不同的统计函数，生成中间结果字段，方便加速查询过程中使用；
    具体可分为以下两种情况
-   事先未提取字段，例如频繁出现的查询语句为
    \* \| parse \"(?\xxx)\" \| stats count() by aaa
    即自动构建一个 aaa 字段的加速索引。
-   事先已提取字段，例如频繁出现的查询语句为
    \* \| bucket timestamp span=1m as ts \| stats avg(duration) by ts
    avg(duration)平均值，avg(duration)实际为sum(duration)/count(duration)，即可构建一个包含
    count(duration) 和 sum(duration)
    的加速索引。则除了上述查询语句，包括 \| bucket timestmap span=15m as
    ts \| stats count(duration) by ts 等查询也一样能自动被加速。
6.  按年/月/日/多级记录中间结果字段。在加速查询时根据实际选择的时间范围寻找对应级别的中间结果。用户也可以自定义常用时间级别，例如7天/3个月等；
7.  对计算的中间结果设置自动淘汰时间，超过时间自动丢弃；例如，选择7天为自动淘汰时间，则表示系统会自动删除早于7天的数据，同时继续根据新传入的最近7天的数据统计中间结果字段；
8.  对计算的中间结果设置统计频率，即多久更新一次计算结果；
9.  加速检索时，针对加速索引及预先计算的中间结果字段，而不是完整的数据索引进行搜索，因为加速索引数量小于完整索引，因此会比直接检索所有数据速度有极大提升。
```{=html}
```
5.  本发明的关键点和欲保护点是什么？
> （发明内容部分提供的是完成一定功能的完整技术方案，在本部分应提炼出技术方案的关键创新点，列出1、2、3\...，以提醒代理人注意，便于专利代理人撰写权利要求书）
1)  通过用户自定义规则匹配关键字段/系统内置匹配规则提取关键字段建立"field_name"
    ："field_value"统一格式
2)  对搜索引擎接收到的查询语句进行统计分析，确定热搜索语句
3)  统计热点字段，将使用频率高但并非现成的字段记为待加速字段，保存这些中间结果字段值；
4)  加速字段包括未提取字段新建字段和根据搜索语句生产相应的新的中间结果统计值；
5)  可设置这些中间结果字段的自动清除时间/统计频率/统计时间范围
6)  加速搜索时直接在加速索引和中间结果字段中进行检索
6 与第4条所属的最好的现有技术相比，本发明有何优点
> （结合发明内容简单介绍，一两个自然段即可）
自动加速无需用户进行额外的设定规则，可以自动识别出热搜索语句，从而自动建立加速索引，加速索引可以直接用于分析，对于大量数据检索能显著提升速度，提高搜索效率。同时原始索引的存储成本也只有一小部分，原始数据可以和新的汇总索引并存。
7 本发明是否经过实验、模拟、使用而证明可行，结果如何？
> （简单介绍实际的情况）
已经通过实验，未来将用于实际产品中
8 其他有助于专利代理人理解本技术的资料
> （给代理人提供更多的信息，可以有助于代理人更好更快的完成申请文件）
类似专利：
https://www.iprabc.com/s?ds=all&fc=%5B%7B%22type%22%3A%22type%22%2C%22op%22%3A%22include%22%2C%22values%22%3A%5B%22CN\_%E5%8F%91%E6%98%8E%E5%85%AC%E5%BC%80%22%2C%22CN\_%E5%AE%9E%E7%94%A8%E6%96%B0%E5%9E%8B%22%2C%22CN\_%E5%A4%96%E8%A7%82%E8%AE%BE%E8%AE%A1%22%2C%22CN\_%E5%8F%91%E6%98%8E%E6%8E%88%E6%9D%83%22%2C%22TW\_%E5%8F%91%E6%98%8E%E4%B8%93%E5%88%A9%22%2C%22TW\_%E5%AE%9E%E7%94%A8%E6%96%B0%E5%9E%8B%22%2C%22TW\_%E5%A4%96%E8%A7%82%E8%AE%BE%E8%AE%A1%22%2C%22HK\_%E5%8F%91%E6%98%8E%E4%B8%93%E5%88%A9%22%2C%22MO\_%E5%8F%91%E6%98%8E%E4%B8%93%E5%88%A9%22%2C%22CN\_%E5%8F%91%E6%98%8E%E5%85%AC%E5%BC%80%22%5D%7D%5D&dm=mix&q=%E7%94%A8%E4%BB%A5%E6%90%9C%E7%B4%A2%E5%8C%85%E5%90%AB%E5%A4%A7%E9%87%8F%E6%9D%A1%E7%9B%AE%E7%9A%84%E6%97%A5%E5%BF%97%E7%9A%84%E6%96%B9%E6%B3%95%E5%92%8C%E7%B3%BB%E7%BB%9F