Picking Electronic Locks 
Using TCP Sequence 
Prediction
Ricky Lawshae 2009
3/25/2009
1
 OSCP, GPEN
 Network Technician for Texas State University
 Have been working with electronic building access systems 
for more years than I like to think about
Who am I?
3/25/2009
2
 Testing of security of building access systems always 
focused on ID cards and other authentication mediums
 RFID
 Magstripe
 Biometrics
 More prevalent usage of networked building access 
systems means more focus needs to be put on the 
controllers themselves
 Lack of encryption
 Persistent TCP sessions
 Predictable sequence numbering
Abstract
3/25/2009
3
Is it possible for attackers to spoof commands
to these access systems without needing 
an authentication medium at all?
The Question
3/25/2009
4
 Authentication devices and locking devices both connected 
to control system (door controller)
 Door controllers connected via TCP/IP to central database
 Client programs used to make changes to database which 
are propagated down to door controllers
 Status of locks/alarm points monitored remotely
 Commands to lock and unlock(!!) doors can be sent 
across the network
Brief Overview of Electronic Building Access
3/25/2009
5
Picking the Lock
client
database
door controller
doors
3/25/2009
6
Picking the Lock
client
database
door controller
doors
attacker
3/25/2009
7
 All comes down to TCP sequence prediction
 Usually used to hijack TCP sessions
 Guess the next sequence number, inject a packet into an 
existing session
 Has been fixed in most modern operating systems and 
applications
 Embedded systems are still notoriously bad
Why It Works
3/25/2009
8
TCP Sequence Prediction Illustrated
Sender
Receiver
SEQ 0
SEQ 30
SEQ 60
SEQ 90
3/25/2009
9
TCP Sequence Prediction Illustrated
Sender
Receiver
SEQ 0
SEQ 30
SEQ 60
SEQ 60
Attacker
WTF??
3/25/2009
10
Proof of Concept?
3/25/2009
11
 Breaking authentication medium not necessary to bypass 
networked electronic building access system
 Any networked device must protect itself against 
networking vulnerabilities
 These problems are not hard to fix!
 You
 Put door controllers on separate LAN
 Monitor for MITM attacks
 Vendor
 Make sequence numbers harder to guess
 ENCRYPT THE TRAFFIC
Conclusion
3/25/2009
12
The End
3/25/2009
13