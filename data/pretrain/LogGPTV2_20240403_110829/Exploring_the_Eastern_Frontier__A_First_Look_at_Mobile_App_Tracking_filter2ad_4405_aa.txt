# Exploring the Eastern Frontier: A First Look at Mobile App Tracking in China

**Authors:**  
Zhaohua Wang<sup>1,2</sup>, Zhenyu Li<sup>1,2,3(B)</sup>, Minhui Xue<sup>4</sup>, and Gareth Tyson<sup>5</sup>  

**Affiliations:**  
1. Institute of Computing Technology, Chinese Academy of Sciences, Beijing, China  
2. University of Chinese Academy of Sciences, Beijing, China  
3. Purple Mountain Laboratories, Nanjing, China  
4. The University of Adelaide, Adelaide, Australia  
5. Queen Mary University of London, London, UK  

**Abstract:**  
Many mobile applications are integrated with mobile advertising and tracking services that operate in the background to collect user information. Given that China currently leads in mobile traffic growth globally, this paper aims to provide an initial analysis of mobile tracking patterns in China using a large 4G network dataset. Our findings reveal the dominance of popular domestic trackers and pervasive tracking across mobile apps. We also discover a highly interconnected tracking community, where less popular trackers form local communities, each focusing on specific categories of mobile apps. Additionally, we find that some trackers have a monopoly on particular groups of mobile users, and 10% of users upload Personally Identifiable Information (PII) to trackers, with 90% of PII data remaining within China. These results highlight a distinct mobile tracking market in China, which can inform users and stakeholders about the interplay between mobile tracking and potential security and privacy issues.

## 1. Introduction

Mobile applications often incorporate mobile Advertising and Tracking Services (ATSes) for various purposes, such as monetization, app maintenance, and audience understanding [15,27,34]. However, this can lead to the exposure of a wide range of information to third-party services, often without clear transparency on how it is used. The sensitive nature of the data collected on mobile devices makes the prevalence of ATSes a significant concern [4,6,17,22,29,30], especially since users often have limited control over tracking behavior once they grant app permissions [11,40].

Recent research in this area has utilized static app analysis [1,2,11], dynamic device monitoring [12,25,26,28], and network traffic inspection [13,32]. These studies have revealed several insights, including the prominence of a few major ATS platforms, the presence of privacy-invasive leaks (e.g., phone numbers), and attempts at cross-device tracking. Despite these insights, most studies focus primarily on Western countries, particularly North America and Europe. This bias leaves a gap in our understanding of how these trends apply to the Chinese market, one of the fastest-growing regions in terms of mobile traffic [7].

This paper presents the first comprehensive characterization of mobile ATS traffic patterns in China. Using a dataset containing 28 billion anonymized access logs from mobile users, we explore the unique properties of the tracking market in China. Our analysis reveals a highly active ecosystem dominated by a set of major players, many of which are distinct from those observed in Western markets due to the presence of the Great Firewall of China.

**Key Findings:**
- A distinctive mobile tracking market in China, dominated by several popular domestic trackers.
- Cross-tracking of users is prevalent, with 35% of trackers present in two or more mobile apps.
- Popular trackers co-occur with less popular ones, which tend to cluster into local communities, each tracking a specific category of apps.
- Some trackers exclusively track specific groups of users, and 10% of users send PII data to trackers, with 90% of PII data confined to China.

## 2. Dataset and Methodology

### 2.1 Data Description

Our dataset consists of user access logs from a major 4G cellular ISP. These logs are generated by combining Deep Packet Inspection (DPI) traces from the Serving Gateway (SGW) and information from the Mobility Management Entity (MME). Each log entry includes the anonymized unique ID of the user, destination IP address, request URL, HTTP-Referrer, User-Agent, data volume, and the timestamp of the request. To identify the mobile apps generating each HTTP request, we use a rule-based approach from SAMPLES [39]. The rule-set is updated regularly to include new apps. In total, we identified 1,812 unique mobile apps.

Although we cannot extract URLs from HTTPS traffic (approximately 20% of the observed mobile traffic), many apps that use HTTPS also use HTTP. For example, WeChat, the most popular app among the Chinese diaspora, uses HTTPS for third-party APIs but also sends requests via HTTP for cached images. This allows us to observe a significant portion of the activities. The Kendall correlation between the top-100 most popular apps in our dataset and those obtained from [8] is 0.85, indicating that our dataset is representative of general usage. The dataset contains 2,811,233,521 access logs from 3,516,828 users in a major Chinese city.

### 2.2 Identifying ATS Domains

We utilize four ATS-specific lists provided by AdBlock-Plus [10] (the easylist and easyprivacy lists) and hpHosts [23] (the ATS list), along with the EasyList China list, to identify ATS domains. These lists contain string matching rules commonly used by ad blockers. We apply these rules to both the URL and HTTP-Referrer of each flow to identify cases where a URL not classified as an ATS was requested by an ATS [16].

In total, we attribute 260 million HTTP requests (9.2%) to ATS domains, covering 24,985 unique fully-qualified domain names (FQDNs) and 8,773 unique second-level domains (SLDs). Our focus is not only on third-party tracking services but also on first-party trackers that collect personal data, as listed in EasyPrivacy [24].

### 2.3 Associating ATS Domains to Apps

To identify the trackers used by individual mobile apps, we analyze the popularity distribution of mobile apps. The most popular app, WeChat, is accessed by 92% of users in a single day, while the majority of services (outside the top 500) are accessed by less than 0.1% of users per day. Therefore, we focus on the top-500 mobile apps, which account for 86.7% of HTTP flows in our dataset. We exclude 29 mobile browsers to avoid potential inflation or bias caused by web trackers bundled in web pages.

We use the HTTP-Referrer and User-Agent in ATS requests to associate trackers with apps. However, for many unattributed apps, the HTTP-Referrers are empty, and the User-Agents do not meet the required specifications. Thus, we adopt a heuristic approach inspired by [31]. We associate an ATS request with the closest preceding app request, dividing user requests into sessions with a 1-minute interval. This approach yields 193,527,553 sessions, and we filter out sessions containing requests from multiple apps. For the remaining sessions (4,238,015) with a single app request, we safely associate the ATS domain with the app.

For each app, \( s \), we create a vector \( R_s \) where each element represents an ATS domain and the number of users seeing their association. We further filter out ATS domains that issue periodic requests, ensuring that only frequently occurring associations are considered. Finally, we process all access logs for each user to associate ATS requests with their host app, assuming the appâ€™s request precedes the ATS request by less than 1 second.

### 2.4 Limitations

It is important to acknowledge potential limitations in our data. The four ATS lists used for identifying ATS domains may not fully cover the current ATSes in China's mobile networks. However, we have identified prominent and recognized mobile tracker domains consistent with the Chinese mobile ecosystem. The heuristic method for ATS-to-app association may not capture all up-to-date ATSes. Manual testing using Lumen [27] and Lightbeam [21] for the top 10 most popular apps revealed an association accuracy of F1-score 0.75 (precision: 0.7, recall: 0.82). For example, for the popular video app Youku, 6 out of 9 inferred trackers were detected by Lumen or Lightbeam.

Additionally, while the rule-based approach for app identification in [39] has shown high accuracy, the exact accuracy is unknown due to the confidentiality of the DPI provider. Approximately 12% of HTTP requests could not be attributed to specific apps and are labeled as "others."

### 2.5 Ethical Considerations

The ISP collects user access logs to improve service quality and security. Users are notified that the ISP may collect and analyze their personal and access information for these purposes, including tracking behavior, and may share the information with the research community after anonymization. The dataset is stored in the ISP's data center, with access granted only to the authors' affiliation. Precautions, such as substituting unique user IDs with random numbers and encrypting sensitive data, are taken to protect user privacy. Approval from the ISP was obtained for accessing the request URL, HTTP-Referrer, and User-Agent fields.

## 3. Results and Analysis

### 3.1 How Prevalent Are ATSes?

**Presence of ATSes.** Based on the user request sessions, we model the domains (FQDNs) accessed within an app as a bipartite graph \( G = (U, V, E) \), where \( U \) denotes mobile apps, \( V \) represents ATS domains and normal visited domains, and \( E \) is the set of edges connecting vertices in \( U \) to vertices in \( V \). This 2-mode graph reveals connections between ATS domains and mobile apps. We analyze the number of ATSes present in each app in graph \( G \) and present its CDF distribution in Figure 1(a).

Unsurprisingly, we find that many apps incorporate multiple ATSes. Table 1 shows the presence of the top 20 ATS domains (SLDs) in mobile apps.

| **ATS (SLDs)** | **#FQDNs** | **%App** |
|----------------|------------|----------|
| qq.com         | 31         | 67       |
| umeng.com      | 4          | 34       |
| 71.am          | 1          | 28       |
| baidu.com      | 45         | 25       |
| uc.cn          | 3          | 14       |
| 360.cn         | 5          | 13       |
| google-analytics.com | 1   | 9        |
| ksmobile.com   | 1          | 7        |
| cnzz.com       | 33         | 1        |
| xiaomi.com     | 2          | 1        |
| kuwo.cn        | 1          | 1        |
| flurry.com     | 1          | 1        |
| baidustatic.com | 4        | 1        |
| mmstat.com     | 3          | 1        |
| hiido.com      | 1          | 1        |

These results highlight the widespread use of ATSes in Chinese mobile apps and the dominance of certain domestic trackers.