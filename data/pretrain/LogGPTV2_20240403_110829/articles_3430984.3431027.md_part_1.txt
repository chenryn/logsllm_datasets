Evaluation of Causal Inference Techniques for AIOps
V.Arya1,K.Shanmugam2,P.Aggarwal1,Q.Wang2,P.Mohapatra1,S.Nagar1
IBMResearchAI(India1,USA2)
ABSTRACT especiallyfaultlocalizationandrootcauseanalysis,istheability
InferringcausalityofeventsfromlogdataiscriticaltoIToperations todeterminecausalityofeventsfromhistoricallogdata.Inthis
teamswhocontinuouslystrivetoidentifyprobablerootcausesof work, we evaluate the performance of state-of-the-art Granger
eventsinordertoquicklyresolveincidentticketssothatdown- causalinferencetechniquesusingtemporallogdataobtainedfrom
timesandserviceinterruptionsarekepttoaminimum.Although abenchmarkmicroservicesystem[36].
priorworkhasappliedsomespecificcausalinferencetechniques Whilepriorworkhasstudiedtheproblemofinferringcausal
onproprietarylogdata,theyfailtobenchmarktheperformanceof relationshipsfromlogdatainthecontextofISPnetworks[13,14],
differenttechniquesonacommonsystemordataset.Inthiswork, datacenters[15],andsearchenginequerylogs[28],theseworks
weevaluatetheperformanceofmultiplestate-of-the-artcausal applyspecificcausalinferencetechniquesonproprietarydataand
inferencetechniquesusinglogdataobtainedfromapubliclyavail- failtocomparetheperformanceofdifferenttechniquesonacom-
ablebenchmarkmicroservicesystem.Wemodellogdatabothasa monsystemorapubliclyavailablelogdataset.Asaconsequenceit
timeseriesoferrorcountsandasatemporaleventsequenceand becomesachallengetoreplicateresultsorunderstandtheadvan-
evaluate3familiesofGrangercausaltechniques:regressionbased, tagesanddisadvantagesofdifferentcausalinferencetechniques
independencetestingbased,andeventmodels.Ourpreliminaryre- andrecommendtherightoneinthecontextofanewITenviron-
sultsindicatethateventmodelsyieldcausalgraphsthathavehigh ment.Moreoverpriorworkmodelslogdataprimarilyasatime
precisionandrecallincomparisontoregressionandindependence seriesandappliesavariantofthePCalgorithm[12]basedoninde-
testingbasedGrangermethods. pendencetestingoravariantofregressionbasedGrangercausality
test[9]toinferthecausalrelationshipsamongevents.Thismod-
CCSCONCEPTS ellingchoicelimitstherangeofcausalinferencetechniquesthat
cansubsequentlybeappliedonlogdata.Inthiswork,wecompare
•Computingmethodologies→Causalreasoninganddiagnostics.
theperformanceof3familiesofGrangercausalinferencetech-
niquesandtheirvariantsonabenchmarkTrainTicketmicroservice
KEYWORDS
systemthatispubliclyavailable[34–36]:(a)PCalgorithmbased
CausalInference,Grangercausality,AIOps,ITOperations,logdata
onindependencetestsanditsvariants(b)variantsofregression
ACMReferenceFormat: basedtechniques,and(c)graphicaleventmodels[3,10].Whilein
V. Arya1, K. Shanmugam2, P. Aggarwal1, Q. Wang2, P. Mohapatra1, S. thefirsttwoapproaches,thelogdataismodelledasatimeseries,
Nagar1.2021.EvaluationofCausalInferenceTechniquesforAIOps.In inthethirdapproach,thelogdataismodelledasatemporalevent
8thACMIKDDCODSand26thCOMAD(CODSCOMAD2021),January sequenceandweleveragetherecentlyproposedgraphicalevent
2–4, 2021, Bangalore, India. ACM, New York, NY, USA, 5 pages. https: modelstoinfercausalrelationships.Wepresentpreliminaryper-
//doi.org/10.1145/3430984.3431027
formanceresultsofdifferentGrangercausalinferencetechniques
onalogdatasetthatspanshalfanhourandisobtainedbyinjecting
1 INTRODUCTION
afaultinoneofthemicroservicesinthebenchmarksystemwhich
AIOps(AIforITOperations)solutionsattempttoautomatethe
includesatotalof41microservices.Withthehelpofgroundtruth
monitoringoflargecomplexenterpriseapplicationenvironments
data,wecomputetheprecision,recall,andF1scoresoftheinferred
andtheirsupportinginfrastructure.Byingestingdatafrommultiple
causalgraphsamongasubsetofimpactedmicroservices.Weview
sourcessuchasapplications,infrastructure,network,cloudand
themaincontributionsofthisworkasfollows:
existingmonitoringtools,theseintegratedsolutionspromiseto
provideawidevarietyoffunctionstominimiseserviceoutages • Usinglogdatacollectedfromapubliclyavailablebenchmark
microservicesystem,weinvestigatetheperformanceofdifferent
andassistsitereliabilityengineeringteamswithrapidincidentres-
Grangercausalinferencealgorithmsandpresentpreliminary
olution[18].Thesefunctionsgenerallyincludeanomalydetection,
evaluation results for different variants of each algorithm. In
eventcorrelation,predictionandpreventionofemergingincidents,
additiontomodellingthelogdataasatimeserieswhichiscom-
reductioninfalsealarmsoralert/ticketstormsandrootcauseanaly-
monlyusedinpriorwork,wealsomodelitasatemporalevent
sis.Akeycomponentneededtoimplementmostofthesefunctions,
sequenceandpresentaccuracyresultsfortherecentlyproposed
Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalor graphicaleventmodels.
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed • Ourpreliminaryexperimentalresultsshowthateventmodelsin
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
onthefirstpage.CopyrightsforcomponentsofthisworkownedbyothersthanACM generalyieldcausalgraphsthathavehighprecisionandrecall
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish, in comparison to other approaches. However regression and
topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
independencetestingbasedGrangermethodshaveparameters
fee.Requestpermissionsfrompermissions@acm.org.
thatmaybefinetunedtoimproveperformance.
CODSCOMAD2021,January2–4,2021,Bangalore,India
©2021AssociationforComputingMachinery. Thebalanceofthispaperisorganisedasfollows.Section2briefly
ACMISBN978-1-4503-8817-7/21/01...$15.00
https://doi.org/10.1145/3430984.3431027 describesthebenchmarkmicroservicesystemandmodellingoflog
188
CODSCOMAD2021,January2–4,2021,Bangalore,India V.Arya,etal.
specificapproachaboveinordertoavoidintroducingerrorsin
labellingoflogssothatwecanfirstevaluatetheperformanceof
differentcausalinferencemethodsintheabsenceofanylabelnoise.
Modelinglogsastimeseries.Weconsiderdifferenttimebinsizes
(10ms,100ms,1sec)andcountthenumberoferrorlogsineach
bintoobtainatimeseriesoferrorcountscorrespondingtoeach
impactedmicroservice(e.g.seefigure1(b)).
Modelinglogsasaneventsequence.Weconstructatuplese-
quence{(ti,li)}whereti referstothetimeatwhichtheerrorlogof
microserviceli occurs.Weconsideruniquetuplesonly,i.e.,ifmore
thanoneerrorlogofthesamemicroserviceisrecordedatthesame
time,onlyonetupleisretained.Howeveriferrorlogsofdifferent
microservicesoccuratthesametime,alloftheseareretained.
Ourgoalistoinferthecausalgraphamongthemicroservices
whichhavebeenimpactedbythefaultinordertoaidrootcause
analysis.Figure1(c)showsasamplegraphwhichexplainshow
errorsinonemicroservicearecausedbyerrorsinanothermi-
Figure1:(a):Logdata,(b)Modelinglogdataasatimeseries croservice.Thenextsectionbrieflyreviewsthethreefamiliesof
or event sequence, and (c) A sample causal graph that we causalinferencetechniquesthatweevaluateinourexperiments.
wish to infer which implies that errors in microservice A
arecausedbyerrorsinmicroserviceBarecausedbyerrors
3 OVERVIEWOFGRANGERCAUSALITYFOR
inmicroserviceC(i.e.rootcauseoferrorisC).
TIMESERIESANDEVENTSEQUENCES
data.Section3providesanoverviewof3familiesofGrangercausal
TheintuitiveideaofGrangercausality[9]isthatifthetimese-
inferencetechniques.Section4presentsexperimentalresultsand
riesAGrangercausestimeseriesB,thepastofAhasadditional
weconcludeinsection5withdirectionsforfuturework.
informationaboutthefutureofBoverandabovetheinformation
containedinthepastoftimeseriesB.Thiscriterioncouldbeusedto
2 LOGDATAANDMODELLING
verifyifa"causal"relationshipsbetweentimeseriesAandBexists.
BenchmarkMicroserviceSystem.Inthiswork,weuseapub- Sincethecriterionispurelyassociational(againstanotherwise
liclyavailablebenchmarkTrainTicketmicroservicesystem1and
interventionalnotionpopularinothercausaltheories[11,19])but
deployitonaKubernetesclusterinordertocollectlogdata.This appliedwiththeaidofarrowoftime,thisnotionofteniscalled
systemhasabout41microservicesthatworktogetherandallow Grangercausalitytodistinguishitfrominterventionalnotions.
userstoreservetraintickets,makepayments,enterstation,etc.
SeveralmicroservicesintheTrainTicketsysteminteractwithone
3.1 RegressionBasedApproaches
anotherresemblingmicroservicesystemscommonlyseeninlarge