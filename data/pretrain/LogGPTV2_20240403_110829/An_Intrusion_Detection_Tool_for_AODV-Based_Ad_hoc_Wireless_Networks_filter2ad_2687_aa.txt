title:An Intrusion Detection Tool for AODV-Based Ad hoc Wireless Networks
author:Giovanni Vigna and
Sumit Gwalani and
Kavitha Srinivasan and
Elizabeth M. Belding-Royer and
Richard A. Kemmerer
Available online at www.sciencedirect.com
Ad Hoc Networks 6 (2008) 578–599
www.elsevier.com/locate/adhoc
Threshold-based intrusion detection in ad hoc networks
and secure AODV q
A. Patwardhan a,*, J. Parker a, M. Iorga b, A. Joshi a, T. Karygiannis b, Y. Yesha a
a Computer Science and Electrical Engineering Department, UMBC, 1000 Hilltop Circle, Baltimore, MD 21250, United States
b Computer Security Division, National Institute of Standards and Technology, Gaithersburg, MD 20899, United States
Received 1 November 2006; received in revised form 28 February 2007; accepted 9 May 2007
Available online 18 May 2007
Abstract
Mobile ad hoc networks (MANETs) play an important role in connecting devices in pervasive environments. MANETs
provide inexpensive and versatile communication, yet several challenges remain in addressing their security. So far, numer-
ous schemes have been proposed for secure routing and intrusion detection, with only simulations to validate them; little
work exists, in implementing such schemes on small handheld devices. In this paper, we present our approach of securing a
MANET using a threshold-based intrusion detection system and a secure routing protocol. We present a proof-of-concept
implementation of our IDS deployed on handheld devices and in a MANET testbed connected by a secure version of
AODV over IPv6 – SecAODV. While the IDS helps detect attacks on data traﬃc, SecAODV incorporates security features
of non-repudiation and authentication, without relying on the availability of a Certiﬁcate Authority (CA) or a Key
Distribution Center (KDC). We present the design and implementation details of our system, the practical considerations
involved, and how these mechanisms can be used to detect and thwart malicious attacks.
Ó 2007 Elsevier B.V. All rights reserved.
Keywords: MANETs; Secure routing; Intrusion detection; SecAODV
1. Introduction
Continued advances in hardware for miniature
devices like Personal Digital Assistants (PDAs),
mobile phones and converged devices like PDA-
q This research was supported by NSF award 9875433, and
grants from NIST and IBM.
* Corresponding author. Tel.: +1 410 4558680.
E-mail addresses: PI:EMAIL (A. Patwardhan),
PI:EMAIL (J. Parker), PI:EMAIL (M. Iorga),
PI:EMAIL (A. Joshi), PI:EMAIL (T. Kary-
giannis), PI:EMAIL (Y. Yesha).
phones are adding signiﬁcant computational, stor-
age and communication capabilities to them. Paral-
lel advances in both infrastructure based and ad hoc
mobile networks are allowing these devices to inter-
connect, often spontaneously with other devices in
their vicinity. These developments have led to eﬀorts
to provide services to these devices. Some of these
use infrastructure based networks with client–server
models [1,2]. Others have a broader (and longer
term) vision of services in the vicinity being used
in a peer-to-peer manner over ad hoc networks
[3,4]. Application scenarios for the latter include
providing connectivity to First Response Teams in
1570-8705/$ - see front matter Ó 2007 Elsevier B.V. All rights reserved.
doi:10.1016/j.adhoc.2007.05.001
A. Patwardhan et al. / Ad Hoc Networks 6 (2008) 578–599
579
search and rescue missions in disaster aﬀected areas,
battleﬁelds etc. Any infrastructure in such situations
is non-existent, damaged, or compromised. Other
scenarios involve ad hoc collaborations in busy pub-
lic places such as airports and malls.
In most of these scenarios, the communicating
devices may or may not have prior trust associations
with each other. Due to the open and dynamic nat-
ure of such environments, identiﬁcation and authen-
tication become challenging problems. Devices can
easily take ‘‘fake’’ identities and spoof IP addresses.
Mobile devices can add a layer of security using
cryptographic protocols for communication. How-
ever,
identities of trusted devices are diﬃcult to
determine, since authentication services may not
be available. Also even in the case of pre-distributed
security credentials, a device can be captured or
compromised and subsequently try to subvert the
network of which it is a part.
In this paper, we present our implementation of a
two pronged approach for protecting MANETs
against attacks – secure the routing process and
deploy IDSs on individual nodes throughout the
network to detect misbehavior. This is a unique
combination of known approaches viz. the concept
of a watchdog [5] for intrusion detection in MAN-
ETS, and using security mechanism of decentralized
cryptograhic generation of IPv6 addresses to enable
unique and non-repudiable identities [6].
Until now, several intrusion detection schemes
and routing protocols for MANETs have been pro-
posed in literature, but their validation has been lim-
ited to simulations. Our main contribution is the
actual
implementation of an intrusion detection
system (IDS) and an IPv6-based secure routing
protocol SecAODV, that we have deployed and
tested on Linux-based mobile handheld devices
(iPAQs connected via 802.11 in ad hoc mode, see
Section 6). This combination of a secure routing pro-
tocol and an IDS, complementing each other, to
secure a MANET from most known attacks,
is
another signiﬁcant departure from existing eﬀorts
described in literature, and to the best of our knowl-
edge the ﬁrst such implementation on actual devices/
networks. We present a detailed analysis of issues
involved in the implementation and deployment of
SecAODV and IDS in our testbed. We also present
interesting results that provide insights into practical
considerations
involved in deploying these on
resource-constrained devices, that have not been
addressed thus far, and are not apparent from simu-
lations. The source code for the MANET IDS and
SecAODV have been made publicly available under
the UMBC Gnu Public License [7,8].
Our IDS scheme is based on an algorithm that
employs a threshold-based anomaly detection
scheme to detect intrusions [9]. We have extended
the AODV protocol and added security features to
it that help prevent most of the prevalent attacks
on AODV. The IDS on the other hand monitors
data traﬃc and helps detect malicious or chronically
faulty nodes. This paper is an extension of our ear-
lier work [10] and incorporates large scale simula-
tion results. The simulation results are used to
analyze the scalability of our approach and also
bring out several important properties of MANET
environments.
The paper is organized as follows. In Section 2,
we discuss security threats to MANETs and the dif-
ﬁculties in dealing with them. We also discuss related
work that addresses some of these problems in Sec-
tion 3. We present the SecAODV protocol in Section
4. In Section 5 we present our threshold-based detec-
tion approach and describe in detail how anomaly
detection and routing state monitoring can be used
to provide secure routing and detect attacks on data
traﬃc. We propose a distributed Intrusion Detection
System (IDS) architecture for MANETs that will
help detect and prevent attacks on data traﬃc. We
present the prototype performance analysis in Sec-
tion 6. In Section 7 we describe the concept of our
snooping based IDS and simulation results. We
describe our prototype implementation which dem-
onstrates the viability of
the our two pronged
approach of a distributed IDS system and secure
routing mechanism based on AODV called Sec-
AODV. Finally, we conclude with lessons learned
and ideas for future work.
2. Background
Our focus is on two goals: (i) ensuring a secure,
reliable routing mechanism and (ii) protecting the
reliability and ﬁdelity of data transmissions along
established routes.
2.1. Collaborative routing mechanisms
MANETs are comprised of mobile devices com-
municating via their wireless interfaces, and their
topology is continuously changing. Several routing
protocols have been proposed for such environ-
ments, that are resilient to these conditions and are
eﬃcient in establishing and maintaining routes. We
580
A. Patwardhan et al. / Ad Hoc Networks 6 (2008) 578–599
focus on on-demand or reactive routing protocols,
which do not maintain any a priori network topol-
ogy information. Typically, devices advertise their
presence by broadcasting HELLO messages. Neigh-
boring nodes discover each other by listening to
these messages to update their set of directly reach-
able nodes. To be able to communicate with nodes
beyond their own radio range, these nodes issue
route requests. Route requests are processed by
neighboring nodes and on-demand routes are cre-
ated if the routing process succeeds. A combination
of timeouts, frequency of usage, and reachability, in
addition to protocol speciﬁc routing messages are
used to update individual routing tables. Intermedi-
ate nodes have to cooperate in the routing process
and also relay data once the routes have been setup.
Essentially, each device functions as a router.
Numerous protocols of this type have been pro-
posed and some have been implemented for IPv4.
Among them are Dynamic Source Routing (DSR)
[11], Temporarily Ordered Routing Algorithm
(TORA) [12], Ad-Hoc On Demand Distance Vector
(AODV)
routing [13,14], Signal Stability-Based
Adaptive (SSA) routing [15], to mention a few.
However, the proposed routing protocols assume
non-hostile environments, where nodes faithfully
forward all packets, and malicious nodes are absent.
We describe a ﬁrst of its kind implementation of a
secure routing protocol based on AODV that uses
IPv6 called SecAODV described in Section 4.
2.2. MANET vulnerabilities and possible attacks
MANETs are inherently vulnerable to several
kinds of attacks due to the open medium of commu-
nication, resource-constrained devices, and the col-
laborative nature of the routing process. MANETs
basically function to provide connectivity to devices
in the absence of infrastructure support using a
shared open communication medium and rely on
collaboration from participating devices in doing
so. Devices participate in the MANET by complying
to the speciﬁcations of the routing protocol. Lack of
conventional mechanisms for identiﬁcation and
authentication for individual devices and reliance
on unknown nodes for collaboration increases the
vulnerabilities of the MANET connectivity and
resources of the individual devices (like routing
tables and message buﬀers).
Since MANETs have not yet been widely
deployed, no actual data is currently available that
allows comprehensive attack analysis. Huang and
Lee [16] propose an attack analysis model for ad
hoc networks that uses a taxonomy of anomalous
events to detect and analyze attacks. Several possi-
ble attacks on MANETs have been identiﬁed in
literature [17–19,16]. They can be broadly classiﬁed
into two types: (i) routing disruption attacks and
(ii) resource consumption attacks. A more detailed
survey and discussion on current state of secure
routing protocols has been presented by Hu and
Perrig in [20].
Attacks can target various layers of the protocol
stack. Resource consumption attacks that exploit
vulnerabilities
in the Medium Access Control
(MAC) layer and Physical (PHY) layers to consume
bandwidth and energy in order to starve resource-
constrained devices, are examples of sleep-depriva-
tion attacks. To prevent against such attacks,
security mechanisms must be provided in the
MAC and PHY layers; they cannot be repulsed at
higher levels.
We focus only on attacks speciﬁc to the network-
ing and application layers (routing process and data
traﬃc). A detailed classiﬁcation of the possible
attacks can be found in [16].
2.3. Identities and key management
As computing becomes pervasive, people expect
to access services and information anytime and any-
where. These systems lack centralized control, are
not under any single administrative domain, and in
addition their users are not all known a priori. More-
over, devices are only guaranteed to be able to
communicate with peers in their vicinity – internet
connectivity is ‘limited.’ In other words, as a device
moves about and interacts with other devices, it can-
not be assumed that the identity of all the devices it
interacts with is known up front. Due to this inher-
ent ad hoc connectivity in pervasive environments,
it is not feasible to be dependent on conventional
client–server methods of Identiﬁcation and Authen-
tication typically used in wired networks. It may not
be possible to contact any trust/reputation authori-
ties to validate identities during every encounter
due to network partitions. Given the vast possible
number of devices, it will also not be scalable to have
all resources centrally registered and later authenti-
cated, especially where no ﬁxed networking infra-
structure exists. Besides suﬀering from the inherent
problems of centralized and federated architectures
like lack of scalability and fault tolerance – total reli-
ance on such external authorities to provide trust
A. Patwardhan et al. / Ad Hoc Networks 6 (2008) 578–599
581
related services will severely limit the use of the
potentially abundant resources in other peers in a
device’s vicinity.
in systems
These constraints rule out maintaining security
associations via ‘‘web-of-trust’’
like
PGP [21]. PGP provides a ‘‘web-of-trust’’ process
by which a node can determine the validity and trust
of public keys without actually conﬁrming the
authenticity of the key. For instance node A might
trust the authenticity of a public key for node C
based on the fact that node A veriﬁed (sometime
in the past) the authenticity of node B’s public keys,
and node B has veriﬁed the authenticity of node C’s
public keys. There are public databases available on
the Internet for determining these PGP authentica-
tion chains. While this is an elementary form of dis-
tributed trust, it still relies on connectivity to keying
servers, which may not always be possible in perva-
sive systems. It also lacks mechanisms for immedi-
ate response to suspicious activity and revoking
existing trust relationships. Partitions in ad hoc net-
works are common, and response to intrusions in
the local neighborhoods must be local and immedi-
ate to ensure the correct and secure operation of the
device.
To secure MANETs, unique and reliable creden-
tials must be possessed by each node. Also, reliable
authentication mechanisms must be incorporated to
secure the routing process and to classify legitimate,
malicious, and faulty nodes. Without
reliable
authentication, securing the routing process and
intrusion response are not possible. To ensure cor-
rect and reliable operation of any MANET related
activity, some mechanism must exist for non-repu-
diation and to verify authenticity of messages.
2.4. Intrusion detection challenges
prevention measures,
Although encryption and signed headers are
intrusion
vulnerabilities
remain nonetheless. An IDS further strengthens
the defense of a MANET. A reliable IDS, operating
within a MANET, requires that trust be established
amongst collaborating nodes in the absence of any
pre-existing trust associations.
MANETs present a number of unique problems
for Intrusion Detection Systems (IDS). Diﬀerentiat-
ing between malicious network activity and spuri-
ous but typical problems associated with an ad
hoc networking environment, is a challenging task.
In an ad hoc network, malicious nodes may enter
and leave the immediate radio transmission range
at random intervals or may collude with other mali-
cious nodes to disrupt network activity and avoid
detection. Malicious nodes may behave maliciously
only intermittently,
complicating their
detection.
further
Traﬃc monitoring in wired networks is usually
performed at switches, routers and gateways, but
an ad hoc network does not have these types of net-
work elements where the IDS can collect audit data
for the entire network. A wired network under a sin-
gle administrative domain allows for discovery,
repair, response, and forensics of suspicious nodes.
A MANET is most likely not under a single admin-
istrative domain, making it diﬃcult to perform any
kind of centralized management or control. Net-
work traﬃc can be monitored on a wired network
segment, but ad hoc nodes or sensors can only mon-