413
(3,0)(3,0)MAPPhase 1MAPPhase 2(2,1)(2,1)(1,2)(1,2)(0,3)(0,3)q1,12,1q1,11,2q2,12,2q1,22,2q2,12,1q1,22,1q2,22,1q2,21,2Legend(a)QBDMAPPhase 1MAPPhase 2(3,0)(3,0)(2,1)(2,1)(1,2)(1,2)(0,3)(0,3)(b)HorizontalCutMAPPhase 1MAPPhase 2(3,0)(3,0)(2,1)(2,1)(1,2)(1,2)(0,3)(0,3)(c)VerticalCutsFigure2.Finitequasi-birthdeath(QBD)processofthetwoqueueMAPnetworkconsideredinSec-tion4.Astatelabel(n1,n2)indicatesthequeue-lengthoftheexponentialandtheMAPqueue,respectively.lengthsareinter-relatedbyanumberofequationsthatin-volvemeanquantitiesonlyandthat,surprisingly,donotre-quiredetailedlow-levelprobabilisticinformationaboutthemodel,suchasresidualservicetimesseenbyarrivaljobsorprobabilityofﬁndingtheMAPserverinacertainstate4,thatareinsteadubiquitousinnon-product-formqueueinganalysis[1].ThisisfundamentaltounderstandthecriticalquantitiesthatshouldbeestimatedbyMAP-AMVA.LetusconsidertheverticalcutsinFigure2(c)whichim-posestatisticalequilibriumbetweenthedepartureprocessesoftheresources.Eachcutprovidesapartialbalance(cid:2)Kk=1(qk,12,1+qk,22,1)P[n2,k]=q1,11,2P[n2−1,1]+q2,21,2P[n2−1,2],(5)forallpossiblejobpopulations1≤n2≤Natthesec-ondresource,whereweomitthepopulationn1fromnota-tionsincethisisimmediatelycomputedasn1=N−n2.Theleft-handsideof(5)describesdeparturesfromtheMAPqueue,theright-handsidecharacterizesdeparturesfromtheexponentialqueue.WithintheMAP-AMVAapproach,wetransformexpressionsinvolvingprobabilitiesintorelationsinvolvingonlymeanvaluesbyweightedsummationoftheprobabilisticexpressionsandbyMAPﬁltration[9]appliedtostudythestateofaresourceuponarrivalofanewjob.Forexample,summingallpossiblebalances(5)andweightingthecontributionofeachtermbyn2,theleft-handsideof(5)gives(cid:2)Kk=1(qk,12,1+qk,22,1)(cid:2)Nn2=1n2P[n2,k]=(cid:2)Kk=1(qk,12,1+qk,22,1)Qk2(N),(6)whiletheright-handsideof(5)sumsto(cid:2)Kk=1qk,k1,2(cid:2)Nn2=1n2P[n2−1,k]=X(N)V2(1+A2(N)),4Notethat,forMAPqueuewithserviceprocess(D0,D1),theresidualtimeiscomputedas(cid:2)aT(−D0)−1(cid:2)1,where(cid:2)1=(1,1,...,1)and(cid:2)a=(a1,a2,...,aK)isdeﬁnedbytheprobabilityakthatanarrivingjobﬁndsthejobinservicewiththeMAPinphasek.Therefore,residualtimesinMAPsaredeﬁnedprobabilisticallyanddonotimmediatelysimplifytomeanquantitieslikeinM/G/1systems[1]sincetheseareobtainedunderrenewalassumptionthatdonotapplyingeneraltoMAPnetworks.whereV2isthemeannumberofvisitsofjobstoqueue2andA2(N)isthemeanqueue-lengthseenbyajobuponarrivalattheMAPresource(notcountingitself).ThelastobservationfollowsbyMAPﬁltration,sincewehavethattheprobabilitythatajobarrivingtothesecondresourceﬁndstheren2−1enqueuedjobswhiletheMAPisinphase1isParr[n2−1,1]=q1,11,2P[n2−1,1]/(X(N)V2),see[4]foraproof.Accordingtotheaboveobservations,wehavethattheper-phasequeue-lengthsatthesecondresourcearerelatedby(cid:2)Kk=1(qk,12,1+qk,22,1)Qk2(N)=X(N)V2(1+A2(N)),(7)andmultiplyingbothsidesbyQ2(N)wegetQ2(N)=X(N)D2(N)(1+A2(N)),(8)whichisconsistentwithclassicMVAtheoryandwherethe“meanservicedemand”D2(N)isD2(N)=(cid:7)V2(cid:2)Kk=1fk2(N)(qk,12,1+qk,22,1)(cid:8),(9)withfk2(N)=Qk2(N)/Q2(N)beingthefractionofthecustomerswhichwaitsintheMAPqueuewhiletheserverisinphasekand(qk,12,1+qk,22,1)isthetotalrateofserviceinthatphase.HereD2(N)summarizesinasinglenumberseveraldelaytermssuchasmeanservicetimeandresidualtimeofthejobfoundinservicebyanewarrival;D2(N)canbethoughtasasimplewaytocompactthiscomplexityinasinglenumberasiftheserviceprocesswouldbeexpo-nentialinsteadofMAP.UsingsimilarpassagesinthecaseoftheexponentialqueueweobtainQ1(N)=X(N)D1(1+A1(N)),(10)whichisagainconsistentwithclassicMVAtheoryandwhereD1=S1V1isthemeanservicedemandattheex-ponentialqueuewhichdoesnothaveservicephases.Discussion.Equations(8)-(10)statesurprisingproper-tiesofMAPnetworks.Aﬁrstcounter-intuitivepropertyisthattheresidualtimeforcompletingthejobinservicewhenanewjobarrivesdoesnotneedtobeexplicitlyin-volvedinthecomputationofthemeanqueue-lengthand978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
414
consequentlyalsoofthemeanresponsetimeR2(N)=Q2(N)/X(N).Thisissurprising,sinceeachjobsuffersadifferentresidualtimeaccordingtothearrivalorderandthestatisticalcorrelationsbetweenservicetimes;thus,be-causeofthecorrelations,onewouldnotexpecttofactoroutmeanperformancemetricsintosimpleproductssuchas(8).Equation(8)suggestsinsteadthatwedonotneedtoexplic-itlyaccountforresidualtimesaslongasweprovideintheanalysisdetailonthemeanqueue-lengthsinthedifferentMAPserverphases(i.e.,theQk2(N)terms).Asecondobservationisthatthestructureof(8)-(10)ismuchhardertorecursivelyapproximatethanproduct-formmodels,becauseresponsetimesdependnotonlyonthequeue-lengthsseenonarrival,butalsoontheparticu-larworkloadfractionsfk2(N)observedforpopulationN.Thistellsusthatbasicinterpolationsofthequeue-lengthseenonarrivalusingamodelwithpopulationN−1arenotenoughtoapproximatethemodel,sinceoneshouldalsogainknowledgeonhowQ2(N)isdistributedovertheQk2(N)terms.Furthermore,(8)-(10)providemeanstoun-derstandifthearrivaltheoremruleAj(N)=Qj(N−1)usedinclassicMVAanalysisofproduct-formmodels[1]applies,atleastapproximately,toMAPqueueingnetworks.Weﬁrstobservethat,byinsertingtheconditionn2=N−n1intothederivationof(7)-(10),onecouldeasilyshowthatA1(N)+A2(N)=N−1,(11)whichisconsistentwiththeproduct-formcasewhereA1(N)+A2(N)=Q1(N−1)+Q2(N−1)=N−1.NotethatthevalidityofA1(N)+A2(N)=N−1forgen-eralclosednetworkshasbeenrecentlyprovedbyVarkietal.[13],thusthisresultisexpected.Despiteproperty(11),inMAPqueueingnetworksitissimpletoﬁndcaseswhereAj(N)>>Qj(N−1)orAj(N)1,andcon-sideringtheplanethatseparatesstateswhereihasnijobsfromstateswhereithasni−1jobs,regardlessoftheactiveMAPphase.Thesegeneralizedcutsspecializetotheverti-calandhorizontalcutsillustratedinFigure2(b)-(c)inthecaseM=2andK=2.Further,bymanipulationsalongthesamelinesofSection4,wecanobtainalsofromthesecutsasetofgeneralizedMVArelations.LetusbeginbyconsideredtheMVArelationsarisingfromhorizontalcuts.Theorem1.ThegeneralizedhorizontalcutsoverthestatespaceofaMAPnetworkgivethefollowingMVAbalance(cid:2)Kh=1h(cid:3)=k(cid:2)Mw=1qk,hM,wQkM+(cid:2)Km=1(cid:2)M−1j=1qm,kM,jUmM=(cid:2)M−1j=1qk,kj,MUkj+(cid:2)Kh=1h(cid:3)=k(cid:2)Mw=1qh,kM,wQhM,(12)forallMAPphasesk=1,...,K.Proof.Theoremproofisgivenin[4].Theinterestfor(12)isthatitrelatestheper-phasemeanqueue-lengthsQkM(N)andthusprovidesimmediateinfor-mationthatcanbeexploitedtoapproximatetheworkloadfractionsfkM(N)=QkM(N)/QM(N).Tounderstandpre-ciselyhowtheworkloadfractionsinteractwithmeanqueue-lengthsandthemeanqueue-lengthseenonarrivalinthegeneralcase,wenowstudythebalancearisingfromthegeneralizedverticalcuts.Theorem2.ThegeneralizedverticalcutsoverthestatespaceofaMAPnetworkgivethefollowingMVAbalanceQi(N)=Di(N)X(N)(1+Ai(N))(13)fori=1,...,M,whereAi(N)andDi(N)=(cid:7)Vi(cid:2)Kk=1(cid:2)Kh=1(cid:2)Mj=1qk,hi,jfki(N)(cid:8)(14)arerespectivelythemeanqueue-lengthandthemeanser-vicedemandseenonarrivalatqueuei,andfki(N)=Qki(N)/Qi(N)isthefractionofthemeanloadatqueueithatwaitswhentheserverisinphasek.Inparticular,ifiisanexponentialserverthenDi(N)simpliﬁestoDi,whichisthemeanservicedemandofthequeue.Proof.Theoremproofisgivenin[4].Finally,wehavethefollowingcorollary.Corollary1.Themeanqueue-lengthsseenonarrivalsat-isfytherelation(cid:2)Mi=1Ai(N)=N−1.Proof.Asobservedearlierinthepaper,thetheoremisaspecializationoftherecentresultsobtainedin[13].TheaboveresultsprovideanimmediategeneralizationoftheconceptsdiscussedinthespecialcaseoftheQBDinSection4toMAPnetworkswitharbitrarysize.Therefore,thediscussionoftheaboveresultsisidenticaltothatinSec-tion4andconﬁrmsthevalidityofourobservationsontheapplicabilityoftheMVAapproachtoMAPnetworks.5.2Network-LevelEquationsThebalanceswehaveexploredsofardescribethestateofaqueueuponarrivalofanewjob.Considerthefollow-ingquestions:whenanewjobarrivestoqueuei,whatisthestateoftheotherqueuesinthenetwork?Howthisaf-fectsthestateofqueuei?Thesearenon-trivialquestionsthattrytocapturetheessenceofnon-product-formmodels,whereresourcescannotbeassumednearly-independentofeachotherasinproduct-formnetworks.Wenowobtainacharacterizationofthestateofthenetworkseenatarrivalinstantsatqueuei.Considertheinstantofarrivalofanewjobatqueuei;letusrecallthatAi(N)isthemeanqueue-lengthofresourceiseenbythenewarrival.DeﬁneEij(N)=meanqueue-lengthofresourcejwhenanewjobarrivestoqueuei(alsofromself-loops).Clearly,Ai(N)=Eii(N)andbecauseoftheclosednatureofthesystem(cid:2)Mj=1Eij(N)=N,foranychoiceofthearrivaldestinationqueuei.Wecannowdeterminetherelationbetweenmeansystemperfor-manceandEij(N)values.Theorem3.Thestateofthenetworkseenuponarrivalofajobtoqueueisatisﬁesthefollowingbalance(cid:2)Kk=1(cid:2)Kh=1((cid:2)Mj=1j(cid:3)=iqk,hi,jQki(N)+(cid:2)Mj=1qk,hj,iQkj(N))=(N+M−1+(cid:2)Ml=1l(cid:3)=i(cid:3)=j(1+Eil))ViX(N).(15)Proof.Theoremproofisgivenin[4].Inthenextsection,(12)andTheorem3areusedinthedeﬁnitionoftheMAP-AMVAapproximation.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE