by Qj := д(q j )
an F (3)
gp -mapping of all relevant magnitudes of the positional digit
1
Session I3:  Personal PrivacyCCS’17, October 30-November 3, 2017, Dallas, TX, USA1940system. The system constants q, ηmax, Nmax are included in the
CRS.
8.1.3 Concrete Range Proof. As already stated, we want to proof
w ∈ {v, . . . , Nmax} and need to shift the values such that the interval
limits fit into the proof scheme. In preparation let η ∈ [ηmax] be
defined as η := ⌊logq (Nmax − v)⌋ + 1 and N := qη − 1, i. e. N + 1 is
the smallest q-power greater than Nmax − v. It follows
w ∈ {v, . . . , Nmax}
(cid:40) Nmax − w ∈ {0, . . . , N} ∧
⇔ Nmax − w ∈ {0, . . . , Nmax − v}
⇔ Nmax − w ∈ {0, . . . , N} ∩ {Nmax − v − N , . . . , Nmax − v}
⇔
η−1(cid:88)
η−1(cid:88)
N + v − w ∈ {0, . . . , N}
∃ w
′
η−1 ∈ {0, . . . , q − 1} : Nmax − w =
′
0, . . . , w
⇔
j=0
w
′
jqj
w
j =0
∃ w
′′
0 , . . . , w
′′
η−1 ∈ {0, . . . , q − 1} : N + v − w =
′′
j qj
(10)
In our instantiation of the BBA+ scheme, openings of commit-
ments are elements from the implicit message space G1. For this
reason, w does not directly become part of the witness but an F (3)
gp -
mapping W = дw1 and Eq. (10) translates into a statement about
gp -mapped balance W ∈ G1 the user
group elements. For an F (3)
proves
∃ w
′
0, . . . , w
′
η−1 ∈ Zp : W
∃ w
′′
0 , . . . , w
′′
η−1 ∈ Zp : W
w′
j
j
Q
w′′
j
j
Q
Nmax
= д
1
= дN +v1
.
(11)
(12)
η−1(cid:89)
η−1(cid:89)
j=0
j=0
These are multi-scalar multiplication equations (MSEs) and there-
fore fit into our Groth-Sahai proof system.12
assert that w′
j
, w′′
tionally prove that w′
j
j
i ∈ {0, . . . , q − 1} let σi
signature using signature scheme S. Then the user proves
Note, that in contrast to Eq. (10) the Eqs. (11) and (12) do not
j ∈ {0, . . . , q − 1}. Hence, the user must addi-
are indeed valid digits. For each digit
:= S.Sgn(sksig, дi2) be a corresponding
, w′′
∀ j ∈ {0, . . . , η − 1} :
w′
j2 , σw′
S.Vfy(pksig, д
j
w′′
) = 1 ∧ S.Vfy(pksig, д
j2
) = 1.
, σw′′
j
(13)
in order to show that it knows a valid signature for each digit. These
expand into two power-product equations (PPEs) each, using the
signature scheme from [1]. In summary, including a range proof
into the BBA+ scheme increases the NIZK of the Vfy protocol by 2
MSEs for correctness of representation and 4η PPEs for correctness
of the digits.
This concludes our description. We leave it as future work to
implement such a range proof and evaluate the absolute runtime
12Groth-Sahai distinguish between different types of equations that are supported by
their proof system.
penalty for concrete choices of q and ηmax. Moreover, the security
model and proofs must be adopted to the new setting in order to
formally reestablish the security guarantees.
8.2 Fully Active Adversaries
In the security model described in Section 3.3, we consider adver-
saries that may arbitrarily deviate from the protocol. In the full
version of the paper [22], we give a full-fledged security model,
where the adversary may additionally eavesdrop on protocol exe-
cutions of honest users in several security experiments.
However, even in our full-fledged model, the adversary does
not control the network and therefore cannot tamper with the
messages of honest parties but is restricted to passively eavesdrop.
In other words, man-in-the-middle attacks are excluded by the
model. While we believe this is a realistic model for several of the
applications mentioned before, where the user and the operator
(issuer, accumulator, and verifier) are in direct contact with each
other, it may be insufficient if communication is done over a wide-
area network.
We therefore consider it interesting to extend our model to ad-
versaries that are not restricted to passively eavesdrop on honest
users, but may arbitrarily tamper with their communication as a
man-in-the-middle. However, we leave extending our model and
construction to such adversaries as future work.
ACKNOWLEDGMENTS
We would like to thank Jessica Koch and Valerie Fetzer for fruitful
discussions on black-box accumulation and their comments on ear-
lier version of this paper. Moreover, we also would like to thank the
anonymous ACM CCS reviewers for their constructive comments.
REFERENCES
[1] Masayuki Abe, Jens Groth, Kristiyan Haralambiev, and Miyako Ohkubo. 2011.
Optimal Structure-Preserving Signatures in Asymmetric Bilinear Groups. In
Advances in Cryptology – CRYPTO 2011 (Lecture Notes in Computer Science),
Phillip Rogaway (Ed.), Vol. 6841. Springer, Heidelberg, Germany, Santa Barbara,
CA, USA, 649–666.
[2] Masayuki Abe, Markulf Kohlweiss, Miyako Ohkubo, and Mehdi Tibouchi. 2015.
Fully Structure-Preserving Signatures and Shrinking Commitments. In Advances
in Cryptology – EUROCRYPT 2015, Part II (Lecture Notes in Computer Science), Elis-
abeth Oswald and Marc Fischlin (Eds.), Vol. 9057. Springer, Heidelberg, Germany,
Sofia, Bulgaria, 35–65.
[3] William Aiello, Yuval Ishai, and Omer Reingold. 2001. Priced Oblivious Transfer:
How to Sell Digital Goods. In Advances in Cryptology – EUROCRYPT 2001 (Lecture
Notes in Computer Science), Birgit Pfitzmann (Ed.), Vol. 2045. Springer, Heidelberg,
Germany, Innsbruck, Austria, 119–135.
[4] Aimia Coalition Loyalty UK Ltd. 2016. The Nectar loyalty program. Online
Resource. (2016). https://www.nectar.com/.
[5] D. F. Aranha and C. P. L. Gouvêa. 2016. RELIC is an Efficient Library for Cryp-
tography. Online Resource. (2016). https://github.com/relic-toolkit/relic.
[6] Foteini Baldimtsi, Melissa Chase, Georg Fuchsbauer, and Markulf Kohlweiss. 2015.
Anonymous Transferable E-Cash. In Public-Key Cryptography - PKC 2015 - 18th
IACR International Conference on Practice and Theory in Public-Key Cryptography,
Gaithersburg, MD, USA, March 30 - April 1, 2015, Proceedings (Lecture Notes in
Computer Science), Jonathan Katz (Ed.), Vol. 9020. Springer, 101–124. https:
//doi.org/10.1007/978-3-662-46447-2_5
[7] Paulo S. L. M. Barreto and Michael Naehrig. 2006. Pairing-Friendly Elliptic
Curves of Prime Order. In SAC 2005: 12th Annual International Workshop on
Selected Areas in Cryptography (Lecture Notes in Computer Science), Bart Preneel
and Stafford Tavares (Eds.), Vol. 3897. Springer, Heidelberg, Germany, Kingston,
Ontario, Canada, 319–331.
[8] Mira Belenkiy, Melissa Chase, Markulf Kohlweiss, and Anna Lysyanskaya. 2008.
P-signatures and Noninteractive Anonymous Credentials. In TCC 2008: 5th Theory
of Cryptography Conference (Lecture Notes in Computer Science), Ran Canetti (Ed.),
Vol. 4948. Springer, Heidelberg, Germany, San Francisco, CA, USA, 356–374.
Session I3:  Personal PrivacyCCS’17, October 30-November 3, 2017, Dallas, TX, USA1941[9] Dan Boneh and Xavier Boyen. 2004. Short Signatures Without Random Oracles. In
Advances in Cryptology – EUROCRYPT 2004 (Lecture Notes in Computer Science),
Christian Cachin and Jan Camenisch (Eds.), Vol. 3027. Springer, Heidelberg,
Germany, Interlaken, Switzerland, 56–73.
[10] Jan Camenisch, Rafik Chaabouni, and abhi shelat. 2008. Efficient Protocols for
Set Membership and Range Proofs. In Advances in Cryptology – ASIACRYPT 2008
(Lecture Notes in Computer Science), Josef Pieprzyk (Ed.), Vol. 5350. Springer,
Heidelberg, Germany, Melbourne, Australia, 234–252.
[11] Jan Camenisch, Maria Dubovitskaya, and Gregory Neven. 2010. Unlinkable
Priced Oblivious Transfer with Rechargeable Wallets. In FC 2010: 14th Interna-
tional Conference on Financial Cryptography and Data Security (Lecture Notes in
Computer Science), Radu Sion (Ed.), Vol. 6052. Springer, Heidelberg, Germany,
Tenerife, Canary Islands, Spain, 66–81.
[12] Jan Camenisch, Susan Hohenberger, and Anna Lysyanskaya. 2005. Compact
E-Cash. In Advances in Cryptology - EUROCRYPT 2005, 24th Annual International
Conference on the Theory and Applications of Cryptographic Techniques, Aarhus,
Denmark, May 22-26, 2005, Proceedings (Lecture Notes in Computer Science), Ronald
Cramer (Ed.), Vol. 3494. Springer, 302–321. https://doi.org/10.1007/11426639_18
[13] Sébastien Canard and Aline Gouget. 2008. Anonymity in Transferable E-cash. In
Applied Cryptography and Network Security, 6th International Conference, ACNS
2008, New York, NY, USA, June 3-6, 2008. Proceedings (Lecture Notes in Computer
Science), Steven M. Bellovin, Rosario Gennaro, Angelos D. Keromytis, and Moti
Yung (Eds.), Vol. 5037. 207–223. https://doi.org/10.1007/978-3-540-68914-0_13
[14] Rafik Chaabouni, Helger Lipmaa, and Bingsheng Zhang. 2012. A Non-interactive
Range Proof with Constant Communication. In FC 2012: 16th International Con-
ference on Financial Cryptography and Data Security (Lecture Notes in Computer
Science), Angelos D. Keromytis (Ed.), Vol. 7397. Springer, Heidelberg, Germany,
Kralendijk, Bonaire, 179–199.
[15] Delphine Christin, Andreas Reinhardt, Salil S. Kanhere, and Matthias Hollick.
2011. A survey on privacy in mobile participatory sensing applications. Journal
of Systems and Software 84, 11 (2011), 1928–1946.
[16] Gerhard de Koning Gans, Jaap-Henk Hoepman, and Flavio D. Garcia. 2008. A
Practical Attack on the MIFARE Classic. In Smart Card Research and Advanced
Applications: 8th IFIP WG 8.8/11.2 International Conference, Proceedings, Gilles
Grimaud and François-Xavier Standaert (Eds.). Springer, Heidelberg, Germany,
London, UK, 267–282.
[17] Taher ElGamal. 1984. A Public Key Cryptosystem and a Signature Scheme Based
on Discrete Logarithms. In Advances in Cryptology – CRYPTO’84 (Lecture Notes
in Computer Science), G. R. Blakley and David Chaum (Eds.), Vol. 196. Springer,
Heidelberg, Germany, Santa Barbara, CA, USA, 10–18.
[18] Alex Escala and Jens Groth. 2014. Fine-Tuning Groth-Sahai Proofs. In PKC 2014:
17th International Conference on Theory and Practice of Public Key Cryptography
(Lecture Notes in Computer Science), Hugo Krawczyk (Ed.), Vol. 8383. Springer,
Heidelberg, Germany, Buenos Aires, Argentina, 630–649.
[19] Flavio D. Garcia, Gerhard de Koning Gans, Ruben Muijrers, Peter van Rossum,
Roel Verdult, Ronny Wichers Schreur, and Bart Jacobs. 2008. Dismantling MIFARE
Classic. In ESORICS 2008: 13th European Symposium on Research in Computer
Security (Lecture Notes in Computer Science), Sushil Jajodia and Javier López (Eds.),
Vol. 5283. Springer, Heidelberg, Germany, Málaga, Spain, 97–114.
[20] Flavio D. Garcia, Peter van Rossum, Roel Verdult, and Ronny Wichers Schreur.
2009. Wirelessly Pickpocketing a Mifare Classic Card. In 2009 IEEE Symposium
on Security and Privacy. IEEE Computer Society Press, Oakland, CA, USA, 3–15.
[21] Jens Groth and Amit Sahai. 2008. Efficient Non-interactive Proof Systems for
Bilinear Groups. In Advances in Cryptology – EUROCRYPT 2008 (Lecture Notes in
Computer Science), Nigel P. Smart (Ed.), Vol. 4965. Springer, Heidelberg, Germany,
Istanbul, Turkey, 415–432.
[22] Gunnar Hartung, Max Hoffmann, Matthias Nagel, and Andy Rupp. 2017. BBA+:
Improving the Security and Applicability of Privacy-Preserving Point Collection
(full paper). (2017). http://homepage.rub.de/andy.rupp/papers/bbap_full_paper.
pdf.
[23] Gottfried Herold, Max Hoffmann, Michael Klooß, Carla Ràfols, and Andy Rupp.
2017. New Techniques for Structural Batch Verification in Bilinear Groups with
Applications to Groth-Sahai Proofs. Cryptology ePrint Archive, Report 2017/802.
(2017). http://eprint.iacr.org/2017/802.
[24] Malika Izabachène, Benoît Libert, and Damien Vergnaud. 2011. Block-Wise P-
Signatures and Non-interactive Anonymous Credentials with Efficient Attributes.
In 13th IMA International Conference on Cryptography and Coding (Lecture Notes
in Computer Science), Liqun Chen (Ed.), Vol. 7089. Springer, Heidelberg, Germany,
Oxford, UK, 431–450.
[25] Tibor Jager and Andy Rupp. 2016. Black-Box Accumulation: Collecting Incentives
in a Privacy-Preserving Way. Proceedings on Privacy Enhancing Technologies
(PoPETs) 2016, 3 (2016), 62–82.
[26] Yuto Kawahara, Tetsutaro Kobayashi, Michael Scott, and Akihiro Kato. 2016.
Barreto-Naehrig Curves. Internet Draft. Internet Engineering Task Force. Work
in Progress.
[27] Willett Kempton and Jasna Tomic. 2005. Vehicle-to-grid power fundamentals:
Calculating capacity and net revenue. Elsevier Journal of Power Sources 144, 1
(2005), 268–279.
[28] Milica Milutinovic, Italo Dacosta, Andreas Put, and Bart De Decker. 2015. uCen-
tive: An efficient, anonymous and unlinkable incentives scheme. In 2015 IEEE
Trustcom/BigDataSE/ISPA, Vol. 1. IEEE Computer Society Press, Helsinki, Finland,
588–595.
[29] Dustin Moody, Rene C. Peralta, Ray A. Perlner, Andrew R. Regenscheid, Allen L.
Roginsky, and Lidong Chen. 2015. Report on Pairing-based Cryptography. In
Journal of Research of the National Institute of Standards and Technology, Vol. 120.
National Insititute of Standards and Technology, Gaithersburg, MD, USA, 11–27.
[30] NXP Semiconductors Netherlands B.V. 2014. MIFARE Classic EV1 4K Product Data
Sheet Revision 3.1. NXP Semiconductors Netherlands B.V.
[31] NXP Semiconductors Netherlands B.V. 2016. MIFARE DESFire EV2 contactless
multi-application IC Data Sheet Rev. 2.0. NXP Semiconductors Netherlands B.V.
[32] David Oswald and Christof Paar. 2011. Breaking Mifare DESFire MF3ICD40:
Power Analysis and Templates in the Real World. In Cryptographic Hardware
and Embedded Systems – CHES 2011 (Lecture Notes in Computer Science), Bart
Preneel and Tsuyoshi Takagi (Eds.), Vol. 6917. Springer, Heidelberg, Germany,
Nara, Japan, 207–222.
[33] PAYBACK GmbH. 2016. The Payback loyalty program. Online Resource. (2016).
https://www.payback.net/.
Session I3:  Personal PrivacyCCS’17, October 30-November 3, 2017, Dallas, TX, USA1942