### References

1. **Alessia Garofalo, Cesario Di Sarno, Luigi Coppolino, and Salvatore D’Antonio.** A GPS spoofing resilient WAMS for smart grid. In *EWDC*, 2013.
2. **Inside GNSS.** Feasibility of multi-frequency spoofing. 2018. [Link](https://insidegnss.com/infeasibility-of-multi-frequency-spoofing/)
3. **G. Goavec-Merou, J.-M. Friedt, and F. Meyer.** GPS spoofing using software-defined radio. In *FOSDEM*, 2019.
4. **Google.** Raw GNSS Measurements. 2020. [Link](https://developer.android.com/guide/topics/sensors/gnss/)
5. **Christoph Günther.** A survey of spoofing and counter-measures. *NAVIGATION: Journal of The Institute of Navigation*, 2014.
6. **Pinyao Guo, Hunmin Kim, Nurali Virani, Jun Xu, Minghui Zhu, and Peng Liu.** Roboads: Anomaly detection against sensor and actuator misbehaviors in mobile robots. In *DSN*, 2018.
7. **Todd E. Humphreys, Brent M. Ledvina, Mark L. Psiaki, Brady W. O’Hanlon, and Paul M. Kintner.** Assessing the spoofing threat: Development of a portable GPS civilian spoofer. In *Radio Navigation Laboratory Conference Proceedings*, 2008.
8. **Hridu Jain, Sherman Lo, Yu Hsuan Chen, Fabian Rothmaier, and J. David Powell.** Accommodating direction ambiguities in direction of arrival-based GNSS spoof detection. In *ION Pacific PNT*, 2019.
9. **S. Rao Jammalamadaka and Ambar Sengupta.** Topics in circular statistics. World Scientific, 2001.
10. **Kai Jansen, Matthias Schäfer, Daniel Moser, Vincent Lenders, Christina Pöpper, and Jens Schmitt.** Crowd-GPS-Sec: Leveraging crowdsourcing to detect and localize GPS spoofing attacks. In *IEEE SP*, 2018.
11. **Kai Jansen, Nils Ole Tippenhauer, and Christina Pöpper.** Multi-receiver GPS spoofing detection: Error models and realization. In *ACSAC*, 2016.
12. **Wonho Kang and Youngnam Han.** SmartPDR: Smartphone-based pedestrian dead reckoning for indoor localization. *IEEE Sensors Journal*, 2015.
13. **Andrew J. Kerns, Daniel P. Shepard, Jahshan A. Bhatti, and Todd E. Humphreys.** Unmanned aircraft capture and control via GPS spoofing. *JFR*, 2014.
14. **Sherman C. Lo and Yu Hsuan Chen.** Robust GNSS spoof detection using direction of arrival: Methods and practice. In *ION GNSS+*, 2018.
15. **Steve Markgraf.** osmo-fl2k: Using cheap USB 3.0 VGA adapters as SDR transmitter. 2019. [Link](https://osmocom.org/projects/osmo-fl2k/wiki/Osmo-fl2k)
16. **Michael Meurer, Andriy Konovaltsev, Manuel Appel, and Manuel Cuntz.** Direction-of-arrival assisted sequential spoofing detection and mitigation. In *ION GNSS+*, 2016.
17. **Damian Miralles, Nathan Levigne, Dennis M. Akos, Juan Blanch, and Sherman Lo.** Android raw GNSS measurements as the new anti-spoofing and anti-jamming solution. In *ION GNSS+*, 2018.
18. **Paul Y. Montgomery.** Receiver-autonomous spoofing detection: Experimental results of a multi-antenna receiver defense against a portable civil GPS spoofer. In *Radio Navigation Laboratory Conference Proceedings*, 2011.
19. **Ruben Morales-Ferre, Philipp Richter, Emanuela Falletti, Alberto de la Fuente, and Elena Simona Lohan.** A survey on coping with intentional interference in satellite navigation for manned and unmanned aircraft. *IEEE Communications Surveys & Tutorials*, 2019.
20. **NASA.** Broadcast ephemeris data. 2020. [Link](https://cddis.nasa.gov/Data_and_Derived_Products/GNSS/broadcast_ephemeris_data.html)
21. **Tyler Nighswander, Brent Ledvina, Jonathan Diamond, Robert Brumley, and David Brumley.** GPS software attacks. In *ACM CCS*, 2012.
22. **Juhwan Noh, Yujin Kwon, Yunmok Son, Hocheol Shin, Dohyun Kim, Jaeyeong Choi, and Yongdae Kim.** Tractor beam: Safe-hijacking of consumer drones with adaptive GPS spoofing. *ACM TOPS*, 2019.
23. **Brady W. O’Hanlon, Mark L. Psiaki, Jahshan A. Bhatti, Daniel P. Shepard, and Todd E. Humphreys.** Real-time GPS spoofing detection via correlation of encrypted signals. *NAVIGATION: Journal of The Institute of Navigation*, 2013.
24. **osqzss.** gps-sdr-sim. 2016. [Link](https://github.com/osqzss/gps-sdr-sim/)
25. **Mark L. Psiaki and Todd E. Humphreys.** Protecting GPS from spoofers is critical to the future of navigation. *IEEE Spectrum*, 2016.
26. **Mark L. Psiaki, Steven P. Powell, and Brady W. O’Hanlon.** GNSS spoofing detection using high-frequency antenna motion and carrier-phase data. In *ION GNSS+*, 2013.
27. **Aanjhan Ranganathan, Hildur Ólafsdóttir, and Srdjan Capkun.** Spree: A spoofing resistant GPS receiver. In *MobiCom*, 2016.
28. **Fabian Rothmaier, Yu-Hsuan Chen, and Sherman Lo.** Improvements to steady-state spoof detection with experimental validation using a dual-polarization antenna. In *ION GNSS+*, 2019.
29. **Desmond Schmidt, Kenneth Radke, Seyit Camtepe, Ernest Foo, and Michał Ren.** A survey and analysis of the GNSS spoofing threat and countermeasures. *ACM Computing Surveys (CSUR)*, 2016.
30. **Erick Schmidt, Zachary Ruble, David Akopian, and Daniel J. Pack.** Software-defined radio GNSS instrumentation for spoofing mitigation: A review and a case study. *IEEE TIM*, 2018.
31. **Souvik Sen, Romit Roy Choudhury, and Srihari Nelakuditi.** SpinLoc: Spin once to know your location. In *HotMobile*, 2012.
32. **Junjie Shen, Jun Yeon Won, Zeyuan Chen, and Qi Alfred Chen.** Drift with devil: Security of multi-sensor fusion based localization in high-level autonomous driving under GPS spoofing. In *USENIX Security*, 2020.
33. **Daniel P. Shepard, Todd E. Humphreys, and Aaron A. Fansler.** Evaluation of the vulnerability of phasor measurement units to GPS spoofing attacks. *IJCIP*, 2012.
34. **Yubo Song, Kan Zhou, and Xi Chen.** Fake BTS attacks of GSM system on software radio platform. *Journal of Networks*, 2012.
35. **Ivan Studnia, Vincent Nicomette, Eric Alata, Yves Deswarte, Mohamed Kaâniche, and Youssef Laarouchi.** Survey on security threats and protection mechanisms in embedded automotive networks. In *DSN-W*, 2013.
36. **Sashank Narain, Aanjhan Ranganathan, and Guevara Noubir.** Security of GPS/INS-based on-road location tracking systems. In *IEEE SP*, 2019.
37. **Peter F. Swaszek, Scott A. Pratz, Benjamin N. Arocho, Kelly C. Seals, and Richard J. Hartnett.** GNSS spoof detection using shipboard IMU measurements. In *ION GNSS+*, 2014.
38. **Çağatay Tanıl, Samer Khanafseh, Mathieu Joerger, and Boris Pervan.** An INS monitor to detect GNSS spoofers capable of tracking vehicle position. *IEEE TAES*, 2018.
39. **Nils Ole Tippenhauer, Christina Pöpper, Kasper Bonne Rasmussen, and Srdjan Capkun.** On the requirements for successful GPS spoofing attacks. In *ACM CCS*, 2011.
40. **Bertold Van den Bergh and Sofie Pollin.** Keeping UAVs under control during GPS jamming. *IEEE Systems Journal*, 2018.
41. **Kyle D. Wesson, Jason N. Gross, Todd E. Humphreys, and Brian L. Evans.** GNSS signal authentication via power and distortion monitoring. *IEEE TAES*, 2018.
42. **Tegg Westbrook.** The global positioning system and military jamming. *Journal of Strategic Security*, 2019.
43. **Yuan Wu, Hai-Bing Zhu, Qing-Xiu Du, and Shu-Ming Tang.** A survey of the research status of pedestrian dead reckoning systems based on inertial sensors. *IJAC*, 2019.
44. **Nian Xue, Liang Niu, Xianbin Hong, Zhen Li, Larissa Höffaeller, and Christina Pöpper.** DeepSim: GPS spoofing detection on UAVs using satellite imagery matching. In *ACSAC*, 2020.
45. **Kexiong Curtis Zeng, Shinan Liu, Yuanchao Shu, Dong Wang, Haoyu Li, Yanzhi Dou, Gang Wang, and Yaling Yang.** All your GPS are belong to us: Towards stealthy manipulation of road navigation systems. In *USENIX Security*, 2018.
46. **Zengbin Zhang, Xia Zhou, Weile Zhang, Yuanyang Zhang, Gang Wang, Ben Y. Zhao, and Haitao Zheng.** I am the antenna: Accurate outdoor AP location using smartphones. In *MobiCom*, 2011.

### Appendix: Spoofer Localization

With the ability to estimate the Angle of Arrival (AoA) of GPS signals, we can further infer the location of the spoofer with additional analysis. A naive approach is to perform rotation from at least two different locations and use the estimated AoAs to locate the spoofer by simple triangulation. However, this naive approach is highly dependent on accurate AoA estimation, which can be error-prone, especially under spoofing conditions. Instead, we perform AoA-guided navigation (an adaptation of [43, 57]) to locate the spoofer.

#### Illustration of the Spoofer Localization Algorithm

The basic idea is demonstrated in Figure 17. At an initial location \( T_1 \), the GPS receiver spins locally to obtain an AoA \( \text{aoa}_1 \). Then, it moves toward the AoA direction for a certain distance \( d \) and arrives at \( T_2 \). After that, the receiver spins again and repeats the above steps until the spoofer is within view. During the process, we leverage the built-in IMU sensors in the smartphone to measure the moving distance \( d \) based on an existing method [23].

#### Evaluation: Direction Derivation

Localization depends on an accurate estimation of AoAs. We first evaluate the accuracy of AoA inference. We considered both the basic attack and the adaptive attack. We examined two methods to derive AoAs: sine-wave fitting (Section 5.1) and frequency analysis (Section 8.2). The derived AoAs are used to compare with ground-truth AoAs to calculate the AoA error (i.e., the absolute difference between the two angles). Table 2 shows the AoA errors for the OAH setting. These observations suggest that a simple triangulation of AoAs cannot accurately locate the spoofer.

From Table 2, we observe that:
1. The sine-wave fitting method works better than the FA method for deriving AoAs.
2. The sine-wave fitting method is able to get basic spoofing signals' AoAs accurately with an average error of 10.5° but is more difficult to estimate AoAs under adaptive attacks (with an average error of 29.6°).

#### Simulation Results

To evaluate our proposed method, we built a simulation framework (in MATLAB), which allows us to analyze the localization results without performing spoofing in a large outdoor space. In this framework, a GPS spoofer is randomly assigned at a location \( L \) meters away from the GPS receiver. Once our system detects the spoofing signal, it will use the sine-wave fitting method to derive the AoA and repeat steps in the AoA-guided navigation method to locate the spoofer. Once the GPS receiver is close enough to the spoofer (less than \( c \) meters), the simulation is terminated as the spoofer is within view. We record the number of steps it takes to locate the spoofer. In an ideal situation where AoA error is 0, the number of steps should be close to \( L/d \) (where \( d \) is the moving distance per step). Both AoA error and walking distance measurement errors are modeled by a normal distribution (the mean and standard deviation are set based on our measured data).

The experiment results are shown in Figure 18. We set the spoofing signals to be generated by a basic attack and the sine-wave fitting method will be used to derive AoA. Then we set the moving distance \( d \) to 10m, the threshold distance for stopping searching \( c \) to 10m, and change \( L \) from 20m to 100m. For each setting, 1000 simulations are performed, and the distribution of required steps is plotted as blue box plots in Figure 18. The orange line connects the average value of steps in each setting. Our observation is that as \( L \) changes from 20m to 100m, the value of required steps for locating the spoofer centralizes in the range of \([L/d - 1, L/d + 1]\), which is close to the results from the ideal situation where AoA error is 0. These results suggest that the multi-step navigation helps to rectify the AoA inference errors and converge to the spoofer location.

### Other Supporting Materials

We put other supplementary materials in this section. Figures 19 and 20 are photos of our experiment setups. Figure 21 shows the radiation pattern of an omnidirectional dipole antenna with a metal plate as the blocking material. With the blocking material, the radiation pattern can effectively mimic that of a directional antenna. Algorithm 3 shows the detailed process of the spectrum analysis (SA) based spoofing detection method. The SA method is used to detect adaptive spoofing attacks.

#### Algorithm 3: Spectrum Analysis

**Input:** G  
**Output:** AoA

1. **Initialization:** AoA ← ∅
2. **Time window:** timewindow = {1, 2, ..., N}
3. **Preprocessing:** Obtain \( \text{fr}, S = \{s_1, s_2, ..., s_M\}, \text{Csi} = (c_{1s_i}, c_{2s_i}, ..., c_{Ns_i}) \) and \( A = [a_1, a_2, ..., a_N] \) from GNSS measurements G
4. **For each satellite \( s_i \):**
   1. \( X_{s_i}(f) = \text{FFT}(\text{Csi}) \)
   2. Get phase from the rotation frequency \( \text{fr}: \)
      1. \( \text{phase}_{s_i} = \text{getAngle}(X_{s_i}(\text{fr})) \)
      2. \( \text{aoa}_{s_i} = a_1 - \text{phase}_{s_i} \)
      3. \( \text{AoA} = \text{append}(\text{AoA}, \text{aoa}_{s_i}) \)
5. **End for**
6. **Return:** AoA

---

This revised version provides a clearer, more organized, and professional presentation of the text.