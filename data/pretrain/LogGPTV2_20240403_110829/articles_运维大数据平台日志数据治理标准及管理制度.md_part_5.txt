|   |           |          |     |     | yyyy-MM-dd       |         |
|   |           |          |     |     | HH:mm:ss.SSS     |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 3 | 全局统    | global   | Gtn | 必  | 发起端系统填充   | 全部    |
|   | 一流水号  | trace    |     | 填  | ，整个交易流转过 |         |
|   |           | number   |     |     | 程中该流水号不变 |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 4 | 调        | global   | Gpn | 必  | 调用路径编号     | 全部    |
|   | 用路径号  | path     |     | 填  |                  |         |
|   |           | number   |     |     |                  |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 5 | 日志类型  | log type | Lt  | 必  | G：全局跟踪日志  | 全部    |
|   |           |          |     | 填  |                  |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 6 | 节点类型  | node     | nt  | 可  | 条               | 全部    |
|   |           | type     |     | 空  | 线自定义，可为空 |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 7 | 主机名    | host     | hn  | 可  | 当               | 全部    |
|   |           | name     |     | 空  | 前服务器主机名称 |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 8 | 成员行号  | bank id  | bid | 可  | 获取不到可为空   | 全部    |
|   |           |          |     | 空  |                  |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 9 | 服务      | invoke   | it  | 必  | 0：非组合交易    | 全部    |
|   | 调用类型  | type     |     | 填  |                  |         |
|   |           |          |     |     | 1：组合          |         |
|   |           |          |     |     | 交易，本服务依赖 |         |
|   |           |          |     |     | 其他服务调用结果 |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | 2：组合交        |         |
|   |           |          |     |     | 易，本服务不依赖 |         |
|   |           |          |     |     | 其他服务调用结果 |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | 3：通过消        |         |
|   |           |          |     |     | 息中间件发布消息 |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | 4：通过消        |         |
|   |           |          |     |     | 息中间件订阅消息 |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 联机      | invoke   | Is  | 必  | **               | 全部    |
| 0 | 交互模式  | step     |     | 填  | 单向消息模式：** |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | RS               |         |
|   |           |          |     |     | （请求报文发送） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | RC               |         |
|   |           |          |     |     | （请求报文接收） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | **请求应答       |         |
|   |           |          |     |     | 模式（同步）：** |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | SRS              |         |
|   |           |          |     |     | （请求报文发送） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | SRC              |         |
|   |           |          |     |     | （请求报文接收） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | SPS              |         |
|   |           |          |     |     | （响应报文发送） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | SPC              |         |
|   |           |          |     |     | （响应报文接收） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | **请求应答       |         |
|   |           |          |     |     | 模式（异步）：** |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | ARS              |         |
|   |           |          |     |     | （请求报文发送） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | ARC              |         |
|   |           |          |     |     | （请求报文接收） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | APS              |         |
|   |           |          |     |     | （响应报文发送） |         |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | APC              |         |
|   |           |          |     |     | （响应报文接收） |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 服        | r        | r   | 必  | 联盟统一规       | 全部    |
| 1 | 务请求方  | equester | sid | 填  | 划的11位系统编号 |         |
|   | 系统编号  | system   |     |     |                  |         |
|   |           | id       |     |     | 举               |         |
|   |           |          |     |     | 例：80100180000  |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 服        | provider | p   | 必  | 联盟统一规       | 全部    |
| 2 | 务提供方  | system   | sid | 填  | 划的11位系统编号 |         |
|   | 系统编号  | id       |     |     |                  |         |
|   |           |          |     |     | 举例：801        |         |
|   |           |          |     |     | 00180000，对于服 |         |
|   |           |          |     |     | 务请求方来说，如 |         |
|   |           |          |     |     | 果不能确定可为空 |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 组件      | c        | cid | 必  | 联盟统一规       | 全部    |
| 3 | 实例编号  | omponent |     | 填  | 划的组件实例编号 |         |
|   |           | id       |     |     |                  |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 组        | c        | cp  | 可  | 组               | 全部    |
| 4 | 件实例服  | omponent |     | 空  | 件实例服务端口号 |         |
|   | 务端口号  | port     |     |     | ，获取不到可为空 |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 服务请求  | r        | rtc | 可  |                  | 全部    |
| 5 | 方交易码  | equester |     | 空  |                  |         |
|   |           | trade    |     |     |                  |         |
|   |           | code     |     |     |                  |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 服务提供  | provider | ptc | 可  |                  | 全部    |
| 6 | 方交易码  | trade    |     | 空  |                  |         |
|   |           | code     |     |     |                  |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 业        | trade    | tsn | 可  | esbx             | 全部    |
| 7 | 务流水号  | serial   |     | 空  | ml报文service_sn |         |
|   |           | number   |     |     | ，获取不到可为空 |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 交易状态  | status   | S   | 必  | 成功：0          | 需接口  |
| 8 |           |          |     | 填  |                  | 响应报  |
|   |           |          |     |     | 失败：1          | 文接收  |
|   |           |          |     |     |                  |         |
|   |           |          |     |     | 超时(            |         |
|   |           |          |     |     | 没有收到信息)：2 |         |
+---+-----------+----------+-----+-----+------------------+---------+
| 1 | 响应码    | response | Rc  | 可  |                  | 供接口  |
| 9 |           | code     |     | 空  |                  | 响应报  |
|   |           |          |     |     |                  | 文发送  |
+---+-----------+----------+-----+-----+------------------+---------+
|   | 自定义    |          |     |     | 各系统自定义字段 |         |
+---+-----------+----------+-----+-----+------------------+---------+
跟踪日志其他规范定义请参阅《交易路径跟踪全局统一流水号规范》。
##### 1.5.14.3.2性能日志 {#性能日志 .list-paragraph}
###### 1.5.14.3.2.1作用 {#作用-1 .list-paragraph}
性能日志用来记录系统各种逻辑处理步骤和调用的耗时情况，为后续的性能分析提供数据支撑。跟踪日志从宏观跨系统的粒度，记录了系统间调用的性能情况；而性能日志则从微观的粒度，记录了系统内部各个耗时的处理环节的性能情况；二者结合起来便可以输出整个交易粗细两级的性能统计。
###### 1.5.14.3.2.2日志类型名 {#日志类型名-1 .list-paragraph}
pfm
###### 1.5.14.3.2.3关键要素 {#关键要素-1 .list-paragraph}
+-----+---------+---------+---------+-------+-----------------------+
| *   | **要素  | **英文  | **英文  | **填  | **描述**              |
| *序 | 名称**  | 全称**  | 简写**  | 写**  |                       |
| 号  |         |         |         |       |                       |
| **  |         |         |         |       |                       |
+=====+=========+=========+=========+=======+=======================+
| 1   | 开      | begin   | Bt      | 可空  | 时间格式：            |
|     | 始时间  | time    |         |       |                       |
|     |         |         |         |       | yyyy-MM-dd            |
|     |         |         |         |       | HH:mm:ss.SSS          |
+-----+---------+---------+---------+-------+-----------------------+
| 2   | 结      | end     | Et      | 可空  | 时间格式：            |
|     | 束时间  | time    |         |       |                       |
|     |         |         |         |       | yyyy-MM-dd            |
|     |         |         |         |       | HH:mm:ss.SSS          |
+-----+---------+---------+---------+-------+-----------------------+
| 3   | 主机名  | host    | Hn      | 可空  | 应用系统日志无需输出  |
|     |         | name    |         |       | ，由日志分析平台在接  |
|     |         |         |         |       | 入日志时补充此字段。  |
+-----+---------+---------+---------+-------+-----------------------+
| 4   | 应用系  | system  | sysid   | 必填  | 联盟统                |
|     | 统编号  | id      |         |       | 一规划的11位系统编号  |
|     |         |         |         |       |                       |
|     |         |         |         |       | 举例：80100180000     |
+-----+---------+---------+---------+-------+-----------------------+
| 5   | 组件实  | co      | cid     | 必填  | 联盟统                |
|     | 例编号  | mponent |         |       | 一规划的组件实例编号  |
|     |         | id      |         |       |                       |
+-----+---------+---------+---------+-------+-----------------------+
| 6   | 全      | global  | Gtn     | 必填  | 详见《交易路径跟踪    |
|     | 局统一  | trace   |         |       | 全局统一流水号规范》  |
|     | 流水号  | number  |         |       |                       |
+-----+---------+---------+---------+-------+-----------------------+
| 7   | 业务    | trade   | Tsn     | 选填  |                       |
|     | 流水号  | serial  |         |       |                       |
|     |         | number  |         |       |                       |
+-----+---------+---------+---------+-------+-----------------------+
| 8   | 线程号  | thread  | tn/pn   | 必填  | 多                    |
|     | /进程号 | number/ |         |       | 线程程序填写线程号，  |
|     |         | process |         |       | 单线程程序填写进程号  |
|     |         | number  |         |       |                       |
+-----+---------+---------+---------+-------+-----------------------+
| 9   | 步      | step    | Sn      | 必填  | 业务逻辑              |
|     | 骤名称  | name    |         |       | 处理步骤和调用的名称  |
+-----+---------+---------+---------+-------+-----------------------+
| 10  | 状态    | status  | S       | 必填  | 成功：0               |
|     |         |         |         |       |                       |
|     |         |         |         |       | 失败：1               |
|     |         |         |         |       |                       |
|     |         |         |         |       | 超时：2               |
+-----+---------+---------+---------+-------+-----------------------+
| 11  | 日志    | log     | Lv      | 必填  | 日志规                |
|     | 版本号  | version |         |       | 范的版本号，此文档中  |
|     |         |         |         |       | 日志规范的版本号为1.0 |
+-----+---------+---------+---------+-------+-----------------------+
|     | 自定义  |         |         |       | 各系统自定义字段      |
+-----+---------+---------+---------+-------+-----------------------+
###### 1.5.14.3.2.4输出方案 {#输出方案 .list-paragraph}
性能日志输出方案可以有两种选择：
1)  输出单条性能日志：每个操作步骤只在结束的时候输出一条性能日志，开始时间、结束时间两个字段都要填写。
2)  输出两条性能日志：每个操作步骤输出两条性能日志，操作开始的时候输出一条，填写开始时间字段，结束时间为空；操作结束的时候输出一条，填写结束时间字段，开始时间为空；
各应用系统可根据自身情况选择适合的方案使用。
###### 1.5.14.3.2.5建议日志埋点 {#建议日志埋点 .list-paragraph}
1)  系统内部比较耗时的方法调用。
2)  系统外部调用。
3)  CPU密集型任务：也叫计算密集型任务，特点是要进行大量的计算，消耗CPU资源，比如计算圆周率、对视频进行高清解码等，完全依赖CPU的运算能力。
4)  IO密集型任务：涉及到网络传输、磁盘IO、外部硬件设备IO的任务都是IO密集型任务，这类任务的特点是CPU消耗很少，任务的大部分时间都在等待IO操作完成（因为IO的速度远远低于CPU和内存的速度）。
5)  数据库事务处理。
##### 1.5.14.3.3交易日志 {#交易日志 .list-paragraph}
###### 1.5.14.3.3.1作用 {#作用-2 .list-paragraph}
交易日志用来记录一笔交易在整个处理过程中的关键数据，可以理解为交易快照。主要包括服务调用方的请求报文或参数，和服务提供方的响应报文或返回值。
###### 1.5.14.3.3.2日志类型名 {#日志类型名-2 .list-paragraph}
trd
###### 1.5.14.3.3.3关键要素 {#关键要素-2 .list-paragraph}
+-----+----------+------------+---------+-----+----------------------+---+
| *   | **要     | **         | **英文  | *   | **描述**             |   |
| *序 | 素名称** | 英文全称** | 简写**  | *可 |                      |   |
| 号  |          |            |         | 空  |                      |   |
| **  |          |            |         | **  |                      |   |
+=====+==========+============+=========+=====+======================+===+
| 1   | 时间     | Time       | t       | 必  | 时间格式：           |   |
|     |          |            |         | 填  |                      |   |
|     |          |            |         |     | yyyy-MM-dd           |   |
|     |          |            |         |     | HH:mm:ss.SSS         |   |
+-----+----------+------------+---------+-----+----------------------+---+
| 2   | 主机名   | host name  | hn      | 可  | 应用系统日志无需输出 |   |
|     |          |            |         | 空  | ，由日志分析平台在接 |   |
|     |          |            |         |     | 入日志时补充此字段。 |   |
+-----+----------+------------+---------+-----+----------------------+---+
| 3   | 应用     | system id  | sysid   | 必  | 联盟统               |   |
|     | 系统编号 |            |         | 填  | 一规划的11位系统编号 |   |