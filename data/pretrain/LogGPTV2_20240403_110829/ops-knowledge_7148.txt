User: 请解答这个和日志有关的问题Mongod stuck in stop/waiting on Ubuntu 14.04 I installed MongoDB on Ubuntu 14.04 as per the documentation. It runs and works fine, except that it mysteriously stops every few hours and requires a manual restart with service mongod restart to get going again. There's nothing in the mongod.log when this happens.

In addition, when I restart and then check status with service mongod status, it gives me mongod stop/waiting event hough the application is able to connect to it. I've been searching around on how to debug this, but am stuck at this point.

Assistant: It turns out the issue was with OOMkiller killing the mongod process. As noted in the MongoDB production notes (https://docs.mongodb.com/v3.2/administration/production-notes/#disk-and-storage-systems):


  Allocating swap space can avoid issues with memory contention and can
  prevent the OOM Killer on Linux systems from killing mongod.


I used the below commands to create the swap file, which fixed the issue (on Ubuntu 14.04):

&gt; sudo fallocate -l 2G /swapfile
&gt; sudo chmod 600 /swapfile
&gt; sudo mkswap /swapfile
&gt; sudo swapon /swapfile


I then added the following to the /etc/fstab file to make this permanent:


  /swapfile   none    swap    sw    0   0