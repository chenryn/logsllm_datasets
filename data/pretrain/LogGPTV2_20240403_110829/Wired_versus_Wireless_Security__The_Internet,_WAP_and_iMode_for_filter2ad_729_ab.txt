session established with the Enterprise’s web server.   This 
problem is discussed in detail in Section 5.3. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:04:51 UTC from IEEE Xplore.  Restrictions apply. 
and 
send 
download  applets  (e.g.,  games).  iMode  uses  packet-
switched 
the 
communication  and  is  carried  over  TCP/IP  for  the  wired 
part of the communication. 
the  wireless  part  of 
technology 
for 
Packet 
systems 
switching 
receive 
information by dividing messages into small blocks called 
packets and adding headers containing address and control 
information 
to  each  packet.  This  allows  multiple 
communications to be carried on a common channel. This 
allows for efficient channel usage with low cost.  
"DoPa,"  which 
is  DoCoMo's  dedicated  data 
communications  service,  offers  connections  to  LAN  and 
Internet  service  providers  by  applying  this  principle  of 
packet  switching  to  the  wireless  section  as  well.  The 
mobile  packet  communications  system  has  a  network 
configuration 
the  packet  communications 
function is added and integrated into DoCoMo’s Personal 
Digital  Cellular  (PDC)  which  is  the  digital  system  for 
portable and automobile telephones.  
in  which 
Int
Int
Packet
Processing
Module
Mobile
Message
Packet
Gateway
Module
iMode
Server
Radio tower
Int
Base
Station
PDC-P Network
In  such  cases, 
the  WAP  Gateway  should  be 
maintained  at  the  Enterprise,  as  shown  in  Figure  4. 
Maintaining  a  WAP  Gateway  does  not  require  any 
telecommunications  skills;  the  Gateway  receives  regular 
UDP packets. The problem with this solution remains the 
absence  of  the  DNS  client  at  the  mobile  device,  which 
would require the storage of profiles for every target on the 
mobile device.  This also requires that the Enterprise set up 
a  relationship  with  the  Service  Provider  whereby  all 
incoming packets destined for the Enterprise (identified by 
IP address) are immediately routed by the WSP directly to 
the Enterprise and are never sent to the WSP’s Gateway. 
Int
WAP GW
Modem
Bank &
RAS
Router
Service Provider
WAP GW
Server
 Web Server
Enterprise
To Other Content Providers
Figure 4: e-Commerce Specific WAP 
Networking Environment 
We  refer  to  this  environment  as  an  “e-commerce 
specific”  environment  as  it  is  within  the  realm  of  e-
commerce transactions that this type of architecture will be 
required. 
2.3 
iMode Networking Environment 
iMode is the proprietary protocol of NTT DoCoMo of 
Japan.  iMode  provides  Internet  service  using  Personal 
Digital  Cellular-Packet  (PDC-P)  and  a  subset  of  HTML 
3.0 
allows 
application/content  providers  to  distribute  software  (Java 
applets)  to  cellular  phones  and  also  allows  users  to 
content  description 
iMode 
[19]. 
for 
Server
Internet
Figure 5: DoCoMo iMode Wireless Networking 
Environment 
DoCoMo has developed a data transmission protocol 
specific  to  iMode.  This  protocol  is  used  with  DoCoMo’s 
PDC-P system. Connections between the iMode server and 
the  Internet  use  generic  TCP/IP  technology.  The  PDC-P 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:04:51 UTC from IEEE Xplore.  Restrictions apply. 
network  includes  a  mobile  message  packet  gateway  (M-
PGW)  to  handle  conversions  between  these  two  protocol 
formats. 
The  iMode  server  is  a  regular  Web  server.  It  can 
reside at NTT DoCoMo or at the Enterprise. DoCoMo has 
been  acting  as  a  portal  and  so  “normally”  maintains  the 
iMode  server.  For  future  implementations  with  advanced 
security  requirements,  it  is  possible  to  host  the  iMode 
server at the Enterprise. 
The  web  site  http://ww.kyoto-bauc.or.jp/i  (requires  a 
Kanji-enabled browser) is a standard iMode site, while the 
site https://kabu.com is an SSL protected iMode site.  
3  The Wired and Wireless Protocols 
This  section  provides  a  brief  introduction  to  the  two 
wireless protocols, WAP and iMode. We also discuss the 
similarities and differences in these protocols. We do not 
include a discussion of the wired protocols, SSL/TLS [7], 
TCP/IP  [4]  and  so  on,  for  which  there  are  plenty  of 
excellent references available. 
3.1  The WAP Specification 
The  WAP  specification  defines  an  open,  standard 
architecture and a set of protocols for the implementation 
of wireless access to the Internet. 
•  A 
Language 
The WAP specification includes among others [1]: 
•  An  XML-type  markup 
language,  Wireless 
(WML):  WML 
Markup 
and 
WMLScript  provide  a  set  of  markup 
tags 
appropriate  for  wireless  devices.  WML  content 
is accessed on a (traditional) web server over the 
Internet  using  standard  Hypertext  Transfer 
Protocol (HTTP 1.1) requests. 
•  A  “microbrowser”  specification:  This  defines 
how WML and WMLScript are interpreted at the 
wireless handset. 
lightweight  protocol  stack:  Designed 
to 
minimize  bandwidth  requirements,  this  allows 
different  wireless  networks 
run  WAP 
applications.  Wireless  Session  Protocol  is  the 
equivalent to HTTP in a compressed format. 
to 
to 
•  Framework for Wireless Telephony Applications 
(WTA):  This  provides  access 
traditional 
telephony  services  (such  as  Call  Forwarding) 
through WMLScript. 
•  Provisioning:  This  allows  Service  Providers  to 
reconfigure  mobile  telephones  from  a  distance 
using Short Messaging System (SMS) (note that 
SMS is a GSM standard) [5]. 
WML:    Wireless Markup Language
WSP:    Wireless Session Protocol
WTP:    Wireless Transport Protocol
WTLS:  Wireless Transport Layer Security
WCMP: Wireless Control Management Protocol
WDP:    Wireless Datagram Protocol
HTML, XML
JavaScript,
Java
HTTP
SSL/TLS
TCP
IP
ICMP
Internet
Protocol
Stack
UDP
IP
ICMP
Internet
Protocol
Stack
WML
WBXML
WMLScript
WSP
WTP
WTLS
WCMP
WDP &
Adaptation
WAP
Stack
WCMP
WDP &
Adaptation
WAP
Stack
Figure 6:  WAP Protocol Stack Specification 
Figure 6 shows the relationship between the traditional 
Internet protocols and the WAP protocols. 
3.2  The iMode Specification 
service  carrier's  network 
iMode  is  a  proprietary  service  currently  only  offered 
in  Japan  and  can  not  be  made  readily  available  on  any 
other 
iMode 
specification is a proprietary protocol of NTT DoCoMo of 
Japan. As such, the details of the protocol and specification 
are  not  publicly  available.  The  information  that  we  are 
reporting  in  this  paper  is  based  on  personal  experience 
with iMode and the resources sited in this paper. 
[16].  The 
The protocol stacks used by iMode have been reported 
in public forums (at RSA 2001 [15] and at IETF 47 [19]). 
Figure 7 shows the iMode protocol stacks. iMode Security 
is  provided  at  the  transport  layer  using  SSL/TLS  and  is 
based on the security provided by these Internet protocols. 
The  TL  and  LAPD-M  protocols  are  standards  of  the 
Association of Radio Industries and Business (ARIB) [20]. 
iMode  uses  “compact  HTML”,  or  “cHTML”  for 
representing  on-line  (on-air)  content.  The  structure  of 
cHTML  means  that  a  user  can  also  view  “traditional” 
HTML pages (although cHTML pages look better). This is 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:04:51 UTC from IEEE Xplore.  Restrictions apply. 
in contrast to WAP, where HTML pages must be translated 
to WML. 
cHTML
(HTML
subset)
HTTP
SSL/TLS
TL
Call ctl
LADP-M
Physical
Layer
Cellular
Phone
HTML, XML,
JavaScript,
Java
HTTP
SSL/TLS
TCP
IP
Link Layer
Physical
Layer
Internet
Protocol
Stack
TL
IP (PMAP)
Link Layer
Physical
Layer
TCP
IP
Link Layer
Physical
Layer
Mobile-Packet
Gateway Module
Call ctl
LADP-M
Physical
Layer
IP (PMAP)
Link Layer
Physical
Layer
Packet
Processing
Module
W ireless
Proprietary Network
Internet
Figure 7: iMode Protocol Stacks 
4  Wired  and  Wireless  Security 
Features 
In  this  section  we  provide  a  brief  overview  of 
the  security  features  of  each  of  the  wired  and 
wireless protocols.  
4.1  Wired Security 
the 
The  majority  of  e-commerce  applications  run 
over  TCP/IP  protocols.  Typically, 
resources 
accessed by a user are HTML pages or Java-based 
resources.  These  resources  are  accessed  using  the 
HTTP.  If  the  user  requires  access  to  a  sensitive 
resource, they  will be required to establish an SSL 
session  with 
session 
establishment will be prompted by the back-end and 
may  be  “server-side”  or  “mutually  authenticated” 
SSL. 
back-end.  This 