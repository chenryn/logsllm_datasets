    $ ansible -m raw localhost -a 'echo connection' --sudo -K -vvvv -c local          
    Using /etc/ansible/ansible.cfg as config file
    SUDO password: 
    Loaded callback minimal of type stdout, v2.0
    ESTABLISH LOCAL CONNECTION FOR USER: badger
    127.0.0.1 EXEC /bin/sh -c 'sudo -H -S  -p "[sudo via ansible, key=dsvxgavwyxalsjrucewuzwdyxmpasolo] password: " -u root /bin/sh -c '"'"'echo BECOME-SUCCESS-dsvxgavwyxalsjrucewuzwdyxmpasolo; echo connection'"'"''
    localhost | FAILED | rc=0 >>
    ERROR! privilege output closed while waiting for password prompt:
    BECOME-SUCCESS-dsvxgavwyxalsjrucewuzwdyxmpasolo
    connection
    [pts/36@roan /srv/ansible/ansible-friday]$ ansible -m raw localhost -a '/bin/echo connection' --sudo -K -vvvv -c local
    SUDO password: 
    localhost | SUCCESS | rc=0 >>
    connection
    [pts/36@roan /srv/ansible/ansible-friday]$ ansible -m raw -i 'rhel7-test,' '*' -a 'echo connection' --sudo -K
    SUDO password: 
    rhel7-test | SUCCESS | rc=0 >>
    connection
    [pts/36@roan /srv/ansible/ansible-friday]$ ansible -m raw -i 'rhel7-test,' '*' -a '/bin/echo connection' --sudo -K
    SUDO password: 
    rhel7-test | SUCCESS | rc=0 >>
    connection
    [pts/36@roan /srv/ansible/ansible-friday]$                                                      *[devel]  (20:03:38)
The first run is the problem run. The rest work. Could it be a problem with
the echo shell builtin (since the version with full path to echo works?) I
also notice that the full path to echo but still running on localhost has one
less newline in its output (between the header and "connection") than the
output when run over ssh. Maybe that's a clue?
This does work in 1.9.x:
    $ ansible -m raw localhost -a 'echo connection' --sudo -K
    SUDO password: 
    localhost | success | rc=0 >>
    connection
    $
**EDIT:** pipelining must be on