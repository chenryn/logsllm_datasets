### Lemma 5.4
**Statement:** Suppose there exists a constant \( C > 0 \) and \( 0 < \epsilon < 1 \). For any graph \( G \) with \( n \) nodes, the following holds with high probability:
\[
\min_{R, B' \subseteq [i-1]: |R| \leq m} \left( |B'| c_b + |\text{ancestors}_{G - R - B'}(T)| c_r \right) \geq \min \left( \Omega(n^{2/3 - \epsilon}) c_b, \Omega(n) c_r \right).
\]

**Proof:**
Consider the metagraph \( G_k \) with \( n/k \) nodes for some constant \( k \) that we shall define. Let \( B \) be the set of nodes in \( G \) that have a blue pebble at some point, and let \( B_m \) be the set of meta-nodes that contain some node in \( B \). Partition the second half of the graph \( G \) into intervals of size \( \ell = n^{2/3} \). By Lemma 5.3, there exists a constant \( \alpha \) such that for \( k = \alpha n^{1/3} \), there are at least \( \beta n / k \) meta-nodes in \( G_k \) with high probability. Thus, pebbling the interval \([i, i + \ell - 1]\) requires pebbling at least \( \beta n / k - m - |B_k| \) meta-nodes in \( G_k \) for some constant \( \beta \).

Noting that \( m = O(n^{1/3 + \epsilon}) \), and that the middle \( k/3 \) nodes of a meta-node must be pebbled for two meta-nodes that are connected in \( G_k \), it follows that at least \( \Omega(n) \) nodes must be pebbled. Therefore, the cost of pebbling \([i, i + \ell - 1]\) is at least:
\[
\min \left( \Omega \left( \frac{n}{k} \right) c_b, \Omega(n) c_r \right) = \min \left( \Omega(n^{2/3 - \epsilon}) c_b, \Omega(n) c_r \right).
\]

### Reminder of Theorem 1.5
**Statement:** There exists a constant \( C > 0 \) such that for any \( 0 < \rho < 1 \), if \( G \) is a graph generated by DRSample with an interval \( T = [i, i + \ell - 1] \) of length \( \ell = O(n^\rho) \), then the following holds with high probability:
\[
\min_{R \subseteq [i-1]: |R| \leq m} \min_{B' \subseteq [i-1]} \left( |B'| c_b + |\text{ancestors}_{G - R - B'}(T)| c_r \right) \geq \min \left( \Omega(n^\rho) c_b, \Omega(n^{1/2 + \rho/2}) c_r \right).
\]

**Proof:**
Using Lemma 5.5 (whose proof appears in Appendix A.2), we can show that the above inequality holds.

### Reminder of Theorem 1.4
**Statement:** There exists a constant \( C > 0 \) such that for all \( m \leq C n^\rho \) and an interval \( T = [i, i + \ell - 1] \) of length \( \ell = n^{2/3} \log n \), a graph generated by aATSample satisfies the following with high probability:
\[
\min_{R, B' \subseteq [i-1]: |R| \leq m} \left( |B'| c_b + |\text{ancestors}_{G - R - B'}(T)| c_r \right) \geq \min \left( \Omega \left( \frac{n}{\log n} \right) c_b, \Omega(n) c_r \right).
\]

**Proof:**
We use Lemma 5.6 (whose proof appears in Appendix A.1) to establish the result.

### Reminder of Theorem 1.3
**Statement:** Let \( G \) be a graph generated by aATSample. Then there exists a constant \( C > 0 \) such that for all \( m \leq C n^{2/3} \log n \), the following holds with high probability:
\[
\| \text{rbpeb}(G, m) \| \geq \min \left( \Omega(n) c_b, \Omega(n \log n) c_r \right).
\]

**Proof:**
Applying Lemma 5.6 to each of the disjoint \( \log n \) intervals in the second half of the graph \( G \), the theorem follows from Theorem 5.2.

### Acknowledgements
The authors would like to thank Daniel Wichs for helpful discussions and anonymous reviewers for important comments that improved the presentation of the paper. The research was supported in part by the National Science Foundation under NSF Awards #1704587 and #1649515. The views expressed in this paper are those of the authors and do not necessarily reflect those of the National Science Foundation.

### References
[AB16] Joël Alwen and Jeremiah Blocki. Efficiently computing data-independent memory-hard functions. In Matthew Robshaw and Jonathan Katz, editors, CRYPTO 2016, Part II, volume 9815 of LNCS, pages 241–271. Springer, Heidelberg, August 2016.

[AB17] Joël Alwen and Jeremiah Blocki. Towards practical attacks on Argon2i and balloon hashing. In Security and Privacy (EuroS&P), 2017 IEEE European Symposium on, pages 142–157. IEEE, 2017.

[ABH17] Joël Alwen, Jeremiah Blocki, and Ben Harsha. Practical graphs for optimal side-channel resistant memory-hard functions. In Bhavani M. Thuraisingham, David Evans, Tal Malkin, and Dongyan Xu, editors, ACM CCS 17, pages 1001–1017. ACM Press, October / November 2017.

[ABMW05] Martín Abadi, Michael Burrows, Mark S. Manasse, and Ted Wobber. Moderately hard, memory-bound functions. ACM Trans. Internet Techn., 5(2):299–327, 2005.

[ABP17] Joël Alwen, Jeremiah Blocki, and Krzysztof Pietrzak. Depth-robust graphs and their cumulative memory complexity. In Jean-Sébastien Coron and Jesper Buus Nielsen, editors, EUROCRYPT 2017, Part III, volume 10212 of LNCS, pages 3–32. Springer, Heidelberg, April / May 2017.

[ACP+17] Joël Alwen, Binyi Chen, Krzysztof Pietrzak, Leonid Reyzin, and Stefano Tessaro. Scrypt is maximally memory-hard. In Jean-Sébastien Coron and Jesper Buus Nielsen, editors, EUROCRYPT 2017, Part III, volume 10212 of LNCS, pages 33–62. Springer, Heidelberg, April / May 2017.

[AdRNV16] Joël Alwen, Susanna F. de Rezende, Jakob Nordström, and Marc Vinyals. Cumulative space in black-white pebbling and resolution. In Proceedings of the 2016 ACM Conference on Innovations in Theoretical Computer Science, 9-11 January 2017, Berkeley, California USA, 2016.

[AS15] Joël Alwen and Vladimir Serbinenko. High parallel complexity graphs and memory-hard functions. In Rocco A. Servedio and Ronitt Rubinfeld, editors, 47th ACM STOC, pages 595–603. ACM Press, June 2015.

[Bac02] Adam Back. Hashcash-a denial of service counter-measure, 2002.

[BCS16] Dan Boneh, Henry Corrigan-Gibbs, and Stuart E. Schechter. Balloon hashing: A memory-hard function providing provable protection against sequential attacks. In Jung Hee Cheon and Tsuyoshi Takagi, editors, ASIACRYPT 2016, Part I, volume 10031 of LNCS, pages 220–248. Springer, Heidelberg, December 2016.

[BDK15] Alex Biryukov, Daniel Dinu, and Dmitry Khovratovich. Fast and tradeoff-resilient memory-hard functions for cryptocurrencies and password hashing. IACR Cryptology ePrint Archive, 2015:430, 2015.

[BDK16] Alex Biryukov, Daniel Dinu, and Dmitry Khovratovich. Argon2: New generation of memory-hard functions for password hashing and other applications. In IEEE European Symposium on Security and Privacy, EuroS&P 2016, Saarbrücken, Germany, March 21-24, 2016, pages 292–302, 2016.

[BDKJ16] Alex Biryukov, Daniel Dinu, Dmitry Khovratovich, and Simon Josefsson. The memory-hard Argon2 password hash and proof-of-work function, March 2016.

[Ber05] Daniel J. Bernstein. Cache-timing attacks on AES, 2005.

[BHZ18] Jeremiah Blocki, Ben Harsha, and Samson Zhou. On the economics of offline password cracking. In IEEE Symposium on Security and Privacy, SP, pages 35–53, 2018.

[BZ17] Jeremiah Blocki and Samson Zhou. On the depth-robustness and cumulative pebbling cost of Argon2i. In Yael Kalai and Leonid Reyzin, editors, TCC 2017, Part I, volume 10677 of LNCS, pages 445–465. Springer, Heidelberg, November 2017.

[BZ18] Jeremiah Blocki and Samson Zhou. On the computational complexity of minimal cumulative cost graph pebbling. Financial Cryptography and Data Security, 22nd International Conference, FC, 2018. (to appear).

[DKW11a] Stefan Dziembowski, Tomasz Kazana, and Daniel Wichs. Key-evolution schemes resilient to space-bounded leakage. In Advances in Cryptology - CRYPTO - 31st Annual Cryptology Conference, Proceedings, pages 335–353, 2011.

[DKW11b] Stefan Dziembowski, Tomasz Kazana, and Daniel Wichs. One-time computable self-erasing functions. In Theory of Cryptography - 8th Theory of Cryptography Conference, TCC Proceedings, pages 125–143, 2011.

[DL17] Erik D. Demaine and Quanquan C. Liu. Inapproximability of the standard pebble game and hard to pebble graphs. In Algorithms and Data Structures - 15th International Symposium, WADS 2017, St. John’s, NL, Canada, July 31 - August 2, 2017, Proceedings, pages 313–324, 2017.

[DN92] Cynthia Dwork and Moni Naor. Pricing via processing or combatting junk mail. In Advances in Cryptology - CRYPTO, 12th Annual International Cryptology Conference, Proceedings, pages 139–147, 1992.

[FLW13] Christian Forler, Stefan Lucks, and Jakob Wenzel. Catena: A memory-consuming password scrambler. Cryptology ePrint Archive, Report 2013/525, 2013. http://eprint.iacr.org/2013/525.

[GLT79] John R. Gilbert, Thomas Lengauer, and Robert Endre Tarjan. The pebbling problem is complete in polynomial space. In Proceedings of the 11th Annual ACM Symposium on Theory of Computing (STOC), pages 237–248, 1979.

[HK81] Jia-Wei Hong and H. T. Kung. I/O complexity: The red-blue pebble game. In Proceedings of the 13th Annual ACM Symposium on Theory of Computing, May 11-13, 1981, Milwaukee, Wisconsin, USA, pages 326–333, 1981.

[Liu17] Quanquan Liu. Red-blue and standard pebble games: Complexity and applications in the sequential and parallel models. Master’s thesis, Massachusetts Institute of Technology, February 2017.

[LT82] Thomas Lengauer and Robert E. Tarjan. Asymptotically tight bounds on time-space trade-offs in a pebble game. J. ACM, 29(4):1087–1130, October 1982.

[Nak08] Satoshi Nakamoto. Bitcoin: A peer-to-peer electronic cash system, 2008.

[Per09] Colin Percival. Stronger key derivation via sequential memory-hard functions. BSDCan, 2009.

[PHC15] Password hashing competition, 2013–2015.

[RD17] Ling Ren and Srinivas Devadas. Bandwidth hard functions for ASIC resistance. In Yael Kalai and Leonid Reyzin, editors, TCC 2017, Part I, volume 10677 of LNCS, pages 466–492. Springer, Heidelberg, November 2017.

[Sch83] Georg Schnitger. On depth-reduction and grates. In 24th Annual Symposium on Foundations of Computer Science, pages 323–328, 1983.

### A. Missing Proofs
Let \( G = ([n], E) \) be any directed acyclic graph (DAG) such that \((i, i + 1) \in E\) for each \( i < n \). Let \( c \) be a positive integer and \( T_i = ((i-1)c\ell + 1, ic\ell] \).

**Reminder of Theorem 5.2:**
\[
\| \text{rbpeb}(G, m) \| \geq \sum_{i=1}^{\lceil n / (c\ell) \rceil} \min_{R, B' \subseteq [(i-1)c\ell]: |R| \leq m} \left( |B'| c_b + |\text{ancestors}_{G - R - B'}(T_i)| c_r \right).
\]

**Proof of Theorem 5.2:**
(Sketch) Consider an optimal red-blue pebbling and let \( t_i \) denote the first time we place a pebble on node \( ic\ell \). For each \( i \), the red-blue cost incurred between steps \( t_{i-1} + 1 \) and \( t_i \) starting from some red-blue configuration \( B_{t_{i-1}}, R_{t_{i-1}} \) is at least:
\[
\| \text{rbpeb}(G, m, T_i, B_{t_{i-1}}, R_{t_{i-1}}) \| \geq \min_{R, B' \subseteq [(i-1)c\ell]: |R| \leq m} \left( |B'| c_b + |\text{ancestors}_{G - R - B'}(T_i)| c_r \right).
\]
To complete the proof, we observe that:
\[
\| \text{rbpeb}(G, m) \| \geq \sum_{i=1}^{\lceil n / (c\ell) \rceil} \| \text{rbpeb}(G, m, T_i, B_{t_{i-1}}, R_{t_{i-1}}) \|.
\]