title:Improving accuracy in end-to-end packet loss measurement
author:Joel Sommers and
Paul Barford and
Nick G. Duffield and
Amos Ron
Improving Accuracy in End-to-end
Packet Loss Measurement
Joel Sommers
University of Wisconsin-Madison
PI:EMAIL
Nick Dufﬁeld
AT&T Labs-Research
dufﬁPI:EMAIL
ABSTRACT
Measurement and estimation of packet loss characteristics are chal-
lenging due to the relatively rare occurrence and typically short du-
ration of packet loss episodes. While active probe tools are com-
monly used to measure packet loss on end-to-end paths, there has
been little analysis of the accuracy of these tools or their impact
on the network. The objective of our study is to understand how
to measure packet loss episodes accurately with end-to-end probes.
We begin by testing the capability of standard Poisson-modulated
end-to-end measurements of loss in a controlled laboratory envi-
ronment using IP routers and commodity end hosts. Our tests show
that loss characteristics reported from such Poisson-modulated probe
tools can be quite inaccurate over a range of trafﬁc conditions. Mo-
tivated by these observations, we introduce a new algorithm for
packet loss measurement that is designed to overcome the deﬁcien-
cies in standard Poisson-based tools. Speciﬁcally, our method cre-
ates a probe process that (1) enables an explicit trade-off between
accuracy and impact on the network, and (2) enables more accu-
rate measurements than standard Poisson probing at the same rate.
We evaluate the capabilities of our methodology experimentally by
developing and implementing a prototype tool, called BADABING.
The experiments demonstrate the trade-offs between impact on the
network and measurement accuracy. We show that BADABING re-
ports loss characteristics far more accurately than traditional loss
measurement tools.
Categories and Subject Descriptors: C.2.3 [Network Operations]:
Network monitoring, C.2.5 [Local and Wide-Area Networks]: In-
ternet (e.g., TCP/IP), C.4 [Performance of Systems]: Measurement
Techniques
General Terms: Algorithms, Design, Experimentation, Measure-
ment
Keywords: Active Measurement, BADABING, Network Conges-
tion, Network Probes, Packet Loss
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
SIGCOMM’05, August 22–26, 2005, Philadelphia, Pennsylvania, USA.
Copyright 2005 ACM 1-59593-009-4/05/0008 ...$5.00.
Paul Barford
University of Wisconsin-Madison
PI:EMAIL
Amos Ron
University of Wisconsin-Madison
PI:EMAIL
1.
INTRODUCTION
Measuring and analyzing network trafﬁc dynamics between end
hosts has provided the foundation for the development of many dif-
ferent network protocols and systems. Of particular importance is
understanding packet loss behavior since loss can have a signiﬁ-
cant impact on the performance of both TCP- and UDP-based ap-
plications. Despite efforts of network engineers and operators to
limit loss, it will probably never be eliminated due to the intrinsic
dynamics and scaling properties of trafﬁc in packet switched net-
work [19]. Network operators have the ability to passively monitor
nodes within their network for packet loss on routers using SNMP.
End-to-end active measurements using probes provide an equally
valuable perspective since they indicate the conditions that appli-
cation trafﬁc is experiencing on those paths.
The most commonly used tools for probing end-to-end paths to
measure packet loss resemble the ubiquitous PING utility. PING-
like tools send probe packets (e.g., ICMP echo packets) to a target
host at ﬁxed intervals. Loss is inferred by the sender if the response
packets expected from the target host are not received within a spec-
iﬁed time period. Generally speaking, an active measurement ap-
proach is problematic because of the discrete sampling nature of
the probe process. Thus, the accuracy of the resulting measure-
ments depends both on the characteristics and interpretation of the
sampling process as well as the characteristics of the underlying
loss process.
Despite their widespread use, there is almost no mention in the
literature of how to tune and calibrate [28] active measurements
of packet loss to improve accuracy or how to best interpret the
resulting measurements. One approach is suggested by the well-
known PASTA principle [36] which, in a networking context, tells
us that Poisson-modulated probes will provide unbiased time av-
erage measurements of a router queue’s state. This idea has been
suggested as a foundation for active measurement of end-to-end de-
lay and loss [3]. However, the asymptotic nature of PASTA means
that when it is applied in practice, the higher moments of measure-
ments must be considered to determine the validity of the reported
results. A closely related issue is the fact that loss is typically a rare
event in the Internet [39]. This reality implies either that measure-
ments must be taken over a long time period, or that average rates
of Poisson-modulated probes may have to be quite high in order to
report accurate estimates in a timely fashion. However, increasing
the mean probe rate may lead to the situation that the probes them-
selves skew the results. Thus, there are trade-offs in packet loss
measurements between probe rate, measurement accuracy, impact
on the path and timeliness of results.
157The goal of our study is to understand how to accurately mea-
sure loss characteristics on end-to-end paths with probes. We are
interested in two speciﬁc characteristics of packet loss: loss episode
frequency, and loss episode duration [39]. The commonly referred
to notion of loss rate [8, 27] can be estimated directly from these
two measurements. Our study consists of three parts: (i) empirical
evaluation of the currently prevailing approach, (ii) development of
estimation techniques that are based on novel experimental design,
novel probing techniques, and simple validation tests, and (iii) em-
pirical evaluation of this new methodology.
We begin by testing standard Poisson-modulated probing in a
controlled and carefully instrumented laboratory environment con-
sisting of commodity workstations separated by a series of IP routers.
Background trafﬁc is sent between end hosts at different levels of
intensity to generate loss episodes thereby enabling repeatable tests
over a range of conditions. We consider this setting to be ideal for
testing loss measurement tools since it combines the advantages of
traditional simulation environments with those of tests in the wide
area. Namely, much like simulation, it provides for a high level
of control and an ability to compare results with “ground truth.”
Furthermore, much like tests in the wide area, it provides an abil-
ity to consider loss processes in actual router buffers and queues,
and the behavior of implementations of the tools on commodity
end hosts. Our tests reveal two important deﬁciencies with simple
Poisson probing. First, individual probes often incorrectly report
the absence of a loss episode (i.e., they are successfully transferred
when a loss episode is underway). Second, they are not well suited
to measure loss episode duration over limited measurement peri-
ods.
Our observations about the weaknesses in standard Poisson prob-
ing motivate the second part of our study: the development of a dif-
ferent approach for end-to-end loss measurement. There are three
key elements in this new approach. First, we design a probe pro-
cess that assesses the likelihood of loss experienced by other ﬂows
that use the same path, rather than merely reporting its own packet
losses. Second, we design a new experimental framework with
estimation techniques that directly estimate the mean duration of
the loss episodes without estimating the duration of any individ-
ual loss episode. Our estimators are proved to be consistent, under
mild assumptions of the probing process. Third, we provide simple
validation tests (that require no additional experimentation or data
collection) for some of the statistical assumptions that underly our
analysis.
The third part of our study involves the empirical evaluation of
our new loss measurement methodology. To this end, we developed
a one-way active measurement tool called BADABING. BADABING
sends ﬁxed-size probes at speciﬁed intervals from one measure-
ment host to a collaborating target host. The target system collects
the probe packets and reports the loss characteristics after a speci-
ﬁed period of time. We also compare BADABING with a standard
tool for loss measurement that emits probe packets at Poisson inter-
vals. The results show that our tool reports loss episode estimates
much more accurately for the same number of probes.
The most important implication of these results is that there is
now a methodology and tool available for wide-area studies of packet
loss characteristics that enables researchers to understand and spec-
ify the trade-offs between accuracy and impact. Furthermore, the
tool is self-calibrating [28] in the sense that it can report when esti-
mates are poor. Practical applications could include its use for path
selection in peer-to-peer overlay networks and as a tool for network
operators to monitor speciﬁc segments of their infrastructures.
The remainder of the paper is structured as follows. In Section 2,
we consider related work in the areas of loss measurement tech-
niques and loss measurement studies.
In Section 3, we provide
deﬁnitions for loss episode frequency and duration which provide
critical context for our probe process. Our laboratory testbed con-
ﬁguration and results of our tests of basic Poisson-modulated prob-
ing are reported in Section 4. Details on our new probe process
and an analytic treatment of the validity of the resulting loss esti-
mators is provided in Section 5. A description of the tool that we
built to implement our probe process and results of its evaluation
experiments are described in Section 6. We provide a discussion
of practical considerations for using our tool in Section 7. A con-
cluding summary and future directions for this work are provided
in Section 8.
2. RELATED WORK
It is well known that packet loss can have a substantial impact
on the performance of a wide range of Internet protocols and ap-
plications. Understanding the characteristics and impact of packet
loss led, for example, to the development of the NewReno [15] and
SACK [21] versions of TCP. Loss characteristics are also a funda-
mental component of TCP throughput modeling [10, 22, 24].
There have been many studies of packet loss behavior in the In-
ternet. Bolot [8] and Paxson [27] evaluated end-to-end probe mea-
surements and reported characteristics of packet loss over a selec-
tion of paths in the wide area. Yajnik et al. evaluated packet loss
correlations on longer time scales and developed Markov models
for temporal dependence structures [37]. Zhang et al. character-
ized several aspects of packet loss behavior in [39]. In particular,
that work reported measures of constancy of loss episode rate, loss
episode duration, loss free period duration and overall loss rates.
The authors in [25] used a sophisticated passive monitoring infras-
tructure inside Sprint’s IP backbone to gather packet traces and
analyze loss episodes frequency and duration. Finally, Sommers
and Barford pointed out some of the limitations in standard end-
to-end Poisson probing tools by comparing the loss rates measured
by such tools to loss rates measured by passive means in a fully
instrumented wide area infrastructure [6].
The foundation for the notion that Poisson Arrivals See Time Av-
erages (PASTA) was developed by Brumelle in [9], and later for-
malized by Wolff in [36]. Adaptation of those queuing theory ideas
into a network probe context to measure loss and delay character-
istic began with Bolot’s study in [8] and was extended by Paxson
in [27]. Of particular relevance to our work is Paxson’s recom-
mendation and use of Poisson-modulated active probe streams to
reduce bias in delay and loss measurements. Several studies in-
clude the use of loss measurements to estimate network properties
such as bottleneck buffer size and cross trafﬁc intensity [4, 29] .
The Internet Performance Measurement and Analysis efforts [16,
17] resulted in a series of RFCs that specify how packet loss mea-
surements should be conducted. However, those RFCs are devoid
of details on how to tune probe processes and how to interpret the
resulting measurements. We are also guided by Paxson’s recent
work in [28] where he advocates rigorous calibration of network
measurement tools.
ZING is a tool for measuring end-to-end packet loss in one di-
rection between two participating end hosts [2, 20]. ZING sends
UDP packets at Poisson-modulated intervals with ﬁxed mean rate.
Savage developed the STING [30] tool to measure loss rates in both
forward and reverse directions from a single host. STING uses a
clever scheme for manipulating a TCP stream to measure loss. All-
man et al. demonstrated how to estimate TCP loss rates from pas-
sive packet traces of TCP transfers taken close to the sender. A
related study using passive packet traces taken in the middle of the
network was presented in [7]. Network tomography based on using
Figure 1: Simple model for system under consideration. N
ﬂows on input links with aggregate bandwidth Bin compete for
a single output link on router R with bandwidth Bout where
Bin > Bout. The output link has Q seconds of buffer capacity.
both multicast and unicast probes has also been demonstrated to
be effective for inferring loss rates on internal links on end-to-end
paths [11, 12].
Finally, controlled laboratory environments like the one used in
this paper have begun to emerge as effective arenas for network
protocol and system evaluation (e.g., [18]). Environments such as
WAIL [1], DETER [32], and Emulab [35] are openly available to
the research community, often include IP routers as well as general
purpose workstations, and are ideal for measurement tool testing.
3. DEFINITIONS OF LOSS
CHARACTERISTICS
There are many factors that can contribute to packet loss in the
Internet. We will describe some of these in detail as a foundation
for understanding our active measurement objectives. The envi-
ronment that we consider is modeled as a set of N ﬂows that pass
through a router R and compete for a single output link with band-
width Bout as depicted in Figure 1. The aggregate input bandwidth
(Bin) must be greater than the shared output link (Bout) in order for
loss to take place. The typical round trip time for the N ﬂows is
M seconds. Router R is conﬁgured with Q bytes of packet buffers
to accommodate trafﬁc bursts, with Q typically sized on the order
of M × B [5, 34]. We assume that the trafﬁc includes a mixture of
short- and long-lived TCP ﬂows as is common in today’s Internet,
and that the value of N will ﬂuctuate over time.
Figure 2 is an illustration of how the occupancy of the buffer
in router R might evolve over time. Congestion occurs when the
aggregate sending rate of the N ﬂows exceeds the capacity of the
shared output link. The onset of congestion results in ﬁlling of
the output buffer which is seen as a positive slope in queue length
graph. The rate of increase of the queue length depends both on
the number N and on sending rate of each source. A loss episode
begins when the aggregate sending rate has exceeded Bout for a
period of time sufﬁcient to load Q bytes into the output buffer of
router R (e.g., at times a and c in Figure 2). A loss episode ends
when the aggregate sending rate drops below Bout and the buffer
begins a consistent drain down to zero (e.g., at times b and d in
Figure 2). This typically happens when TCP sources sense a packet
loss and halve their sending rate, or simply when the number of
competing ﬂows N drops to a sufﬁcient level. In the former case,
the duration of a loss episode is related to M, depending whether
loss is sensed by a timeout or fast retransmit signal. We deﬁne loss
episode duration as the difference between start and end times (i.e.,