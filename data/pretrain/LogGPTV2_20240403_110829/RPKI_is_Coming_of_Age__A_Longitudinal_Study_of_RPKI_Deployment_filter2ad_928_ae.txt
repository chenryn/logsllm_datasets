limit their flexibility by not allowing the more specifics. For exam-
ple, there may be needs for traffic engineering, or rerouting traffic
through DDoS mitigation services that warrant making more spe-
cific announcements at unpredictable moments. Authorizing such
announcements just in time may not work, as it will take time for
new ROAs to be published to the repositories and validated, and
routers may not use the VRPs immediately (e.g., some operators
build static filter lists every 24 hours).
Figure 13: The percentage of Akamai’s HTTP/S traffic com-
ing from the IP prefixes in the “other” category from Decem-
ber 1st to December 28th, 2018. Note that y axis ends at 0.3%.
Hence, there is a trade-off to consider for these operators. Strictly
speaking, their networks will be more secure against malicious hi-
jacks by not allowing more specifics, but at the same time traffic
engineering will be indistinguishable from such hijacks. If one
does not ever use such traffic engineering, then the decision is
simple. However, for networks that do use traffic engineering tech-
niques regularly, there is something to be said for allowing the
more specifics. The networks will be more vulnerable to malicious
attacks, but they will still be protected against accidental hijacks,
which is considered to be the majority.
This balance will continue to be a discussion point between
operators until practical path verification can be done. Currently
operators may have some information about the plausibility and
validity of BGP paths based on the information through out-of-band
mechanisms such as Peering DB.
7.2 RPKI and Path Validity
The RPKI standards also include a specification for BGPsec, which
makes entire BGP paths verifiable. Sadly, however, BGPsec is not
getting deployed [20, 35]. There are several reasons for this; for
example, BGPsec only works when every ASN on a path participates.
Also, it requires that cryptographic signing and validation is done
by BGP speakers, which is currently supported by only a handful
of BGP software such as Quagga [42] and Bird [55]. As a result
the SIDROPS working group [54] in the IETF is now considering a
pragmatic approach and they recently introduced two new drafts [1,
2], which seem promising. In a nutshell, the proposal is that any
ASN may publish an exclusive list of ASNs that they can be seen to
advertise announcements to as an RPKI signed object. These objects
are called Autonomous System Provider Authorizations (ASPAs).
Just like for ROAs, cryptographic validation is done by Relying
Party software, and the routers get a simple list of tuples of verified
ASN adjacencies. This allows routers to evaluate adjacencies in
a path and reject any path where an adjacency is present where
the origin ASN authorized some ASN(s), but not the ASN that is
found. Note that this would mitigate the concerns around using
the MaxLength attribute in VRPs, as spoofing the origin ASN (by
prepending an ASN to the origin on the BGP path) would become
much more detectable if ASPA objects are published.
Furthermore, the ASPA approach also allows for an incremental
opt-in adoption path: if no ASPA object is published for an ASN then
12
 0 0.05 0.1 0.15 0.2 0.25 0.312/0112/0712/1412/2112/28% of traffic fromthe other categoryDateany adjacency is simply unknown, rather than invalid. Thus, there is
a benefit for individual ASNs to protect themselves against spoofing
by publishing objects. Obviously, the more ASes participate the
better BGP as a whole is protected, but there is no requirement that
all ASes have to participate before individual ASes start to benefit.
8 CONCLUSIONS
In this paper we studied the Resource Public Key Infrastructure
from its inception over 8 years ago to the present day. Over this
period RPKI saw very significant deployment to the extent that
globally 12.1% of the IPv4 address space is now already covered by
Route Origin Authorizations (ROAs). As our analysis showed, in the
early days of RPKI deployment the number of misconfigurations
that could lead to BGP announcements being marked as invalid was
significant. Data quality, however, improved dramatically over the
years to the point where nowadays over 94.3% of announcements
(in the RouteViews dataset) covered by ROAs are valid.
This does not mean there are no more misconfigurations. Our
analysis identified four common types of misconfigurations and
classified how pervasive these misconfigurations are over time.
Identifying misconfigurations also allowed us to filter these out to
leave what we dubbed “potentially malicious announcements”. At
present, this filtering is not accurate enough to be able to use RPKI
to actually detect malicious announcements.
Yet detection was never the goal of RPKI; the goal was to be able
to filter out BGP updates with unauthorized announcements. Our
analysis shows that RPKI is highly successful at this, especially as
data quality improved dramatically over the years. With this in
mind, we believe RPKI is “ready for the big screen” and operators
can start relying on RPKI to drop invalid announcements. And
we are not alone in this; a number of prominent operators have
already started dropping invalids (e.g., AT&T [4]). Furthermore,
common practices are emerging in the operator community such
as guidelines for reaching out to owners of prefixes with broken
ROAs and temporarily making exceptions to prevent these prefixes
from being marked as invalid [45].
Future Work At present, there is no way to detect if an announce-
ment is actually malicious with a high degree of confidence. Existing
systems such as BGPStream [40] rely on heuristics to do this. As
RPKI coverage expands and data quality keeps improving, invalid
announcements detected by RPKI may become a valuable source of
evidence of malicious intent. Observations in this paper may help
find a way to do this; as the CDFs in Figure 9 show, for example,
there appears to be evidence that malicious announcements have
a much shorter lifetime than actual misconfigurations. This could
help separate the wheat from the chaff when identifying hijacks.
ACKNOWLEDGMENTS
We thank the anonymous reviewers and our shepherd, Olaf Maen-
nel, for their helpful comments. This research was supported in
part by NSF grants CNS-1850465, CNS-1564143, CNS-1901325, CNS-
1900879, CNS-1563320, CNS-1901090, CNS-1901047 and EC H2020
Project CONCORDIA GA 830927, and made possible by Akamai
Technologies and Cloudflare.
13
REFERENCES
[1] A. Azimov, E. Bogomazov, R. Bush, K. Patel, and J. Snijders.
Verification of AS PATH Using the Resource Certificate Public
Key Infrastructure and Autonomous System Provider Autho-
rization. IETF, 2018. https://tools.ietf .org/html/draft-azimov-
sidrops-aspa-verification-01.
[2] A. Azimov, E. Uskov, R. Bush, K. Patel, J. Snijders, and R. Hous-
ley. A Profile for Autonomous System Provider Authorization.
IETF, 2018. https://tools.ietf .org/html/draft-azimov-sidrops-
aspa-profile-00.
[3] H. Ballani, P. Francis, and X. Zhang. A study of prefix hijacking
and interception in the internet. SIGCOMM, 2007.
[4] J. Borkenhagen. AT&T/AS 7018 Now Drops Invalid Pre-
fixes from Peers. https://mailman.nanog.org/pipermail/nanog/
2019-February/099501.html, 2019.
[5] K. Butler, T. R. Farley, P. McDaniel, and J. Rexford. A survey
of BGP security issues and solutions. Proceedings of the IEEE,
98(1), IEEE, 2010.
[6] R. Bush and R. Austein. https://tools.ietf.org/html/rfc8210.
RFC 8206, IETF, 2017.
[24] Y. Gilad, S. Goldberg, K. Sriram, J. Snijders, and B. Maddi-
son. The Use of Maxlength in the RPKI draft-ietf-sidrops-
rpkimaxlen-02. IETF, 2019.
[25] Y. Gilad, A. Cohen, A. Herzberg, M. Schapira, and H. Shulman.
Are We There Yet? On RPKI’s Deployment and Security. NDSS,
2017.
RFC 8210, IETF, 2017.
2008. https:
[7] M. A. Brown. Pakistan hijacks YouTube.
//dyn.com/blog/pakistan-hijacks-youtube-1/.
[8] R. D. Boer and J. D. Koning. BGP Origin Validation (RPKI).
Univeristy of Amsterdam, 2013. https://www.os3.nl/ media/
2012-2013/courses/rp2/p59 report.pdf.
[9] BGPStream. https://bgpstream.com/.
[10] BGPStream. https://twitter.com/bgpstream/.
[11] A. Cohen, Y. Gilad, A. Herzberg, and M. Schapira. One Hop
for RPKI, One Giant Leap for BGP Security. HotNets, 2015.
[12] D. Cooper, E. Heilman, K. Brogle, L. Reyzin, and S. Goldberg.
On the risk of misbehaving RPKI authorities. HotNets, 2013.
[13] H. Chan, D. Dash, A. Perrig, and H. Zhang. Modeling adopt-
ability of secure BGP protocol. SIGCOMM, 2006.
blog/chinas-18-minute-mystery/.
[14] J. Cowie. China’s 18-Minute Mystery. 2010. https://dyn.com/
[15] B. Cartwright-Cox. Measuring RPKI Adoption via the
data-plane. NLNOG Day 2018. https://nlnog.net/static/
nlnogday2018/8 Measuring RPKI ben NLNOG 2018.pdf.
[16] CAIDA ASOrganizations Dataset. http://www.caida.org/data/
as-organizations/.
[17] CAIDA ASRelationships Dataset. http://www.caida.org/data/
[18] Cloudflare RPKI Validator Tools and Libraries.
https://
as-relationships/.
github.com/cloudflare/cfrpki.
[19] C. Dietzel, A. Feldmann, and T. King. Blackholing at IXPs: On
the Effectiveness of DDoS Mitigation in the Wild. PAM, 2016.
[20] P. Gill, M. Schapira, and S. Goldberg. Let the market drive
deployment: a strategy for transitioning to BGP security. SIG-
COMM, 2011.
[21] S. Goldberg. Why is It Taking So Long to Secure Internet
Routing? ACM Queue, 12(8), 2014.
[22] S. Goldberg, M. Schapira, P. Hummon, and J. Rexford. How
secure are secure interdomain routing protocols? SIGCOMM,
2010.
[23] W. George and S. Murphy. https://tools.ietf.org/html/rfc8206.
[26] Y. Gilad, O. Sagga, and S. Goldberg. MaxLength Considered
Harmful to the RPKI. CoNEXT, 2017.
[27] A. Herzberg, M. Hollick, and A. Perrig. Secure Routing for
Future Communication Networks (Dagstuhl Seminar 15102).
2015. http://drops.dagstuhl.de/opus/volltexte/2015/5267/.
[28] G. Huston, R. Loomans, and G. Michaelson. A Profile for
Resource Certificate Repository Structure. RFC 6481, IETF,
2012.
[29] D. Iamartino. Study and measurements of the RPKI deploy-
ment. Master’s Thesis, Politecnico di Milano, 2015.
[30] M. Jonker, A. Sperotto, R. van Rijswijk-Deij, R. Sadre, and A.
Pras. Measuring the Adoption of DDoS Protection Services.
IMC, 2016.
Scanner. INFOCOM, 2013.
2003.
[32] C. Lynn, J. Mikkelson, and K. Seo. Secure BGP (S-BGP). IETF,
[31] A. Lutu, M. Bagnulo, and O. Maennel. The BGP Visibility
[33] M. Lepinski and S. Kent. An Infrastructure to Support Secure
Internet Routing. RFC 6480, IETF, 2012.
[34] M. Lepinski, S. Kent, and D. Kong. A Profile for Route Origin
Authorizations (ROAs). RFC 6482, IETF, 2012.
[35] R. Lychev, S. Goldberg, and M. Schapira. BGP security in
partial deployment. Is the juice worth the squeeze? SIGCOMM,
2013.
[36] C. McArthur and M. S. Guirguis. Stealthy IP Prefix Hijacking:
Don’t Bite Off More Than You Can Chew (Poster). SIGCOMM,
2008.
[37] P. Mohapatra, J. Scudder, D. Ward, R. Bush, and R. Austein.
BGP Prefix Origin Validation. RFC 6811, IETF, 2013.
[38] R. Mahajan, D. Wetherall, and T. Anderson. Understanding
[39] Meeting of
BGP misconfiguration. SIGCOMM, 2002.
the NRO Executive Council – 101221.
https://www.nro.net/meeting-of-the-nro-executive-council-
101221/.
[40] C. Orsini, A. King, D. Giordano, V. Giotsas, and A. Dainotti.
BGPStream: A Software Framework for Live and Historical
BGP Data Analysis. IMC, 2016.
[41] R. V. Oliveira, D. Pei, W. Willinger, B. Zhang, and L. Zhang.
In search of the elusive ground truth: the internet’s as-level
connectivity structure. SIGMETRICS, 2008.
[42] Quagga Routing Suite. https://www.quagga.net/.
[43] A. Reuter, R. Bush, I. Cunha, E. Katz-Bassett, T. C. Schmidt, and
M. Whlisch. Towards a Rigorous Methodology for Measuring
Adoption of RPKI Route Validation and Filtering. CCR, 48(1),
2018.
[44] A. Reuter, M. W¨ahlisch, and T. C. Schmidt. RPKI MIRO: Mon-
itoring and Inspection of RPKI Objects (Poster Paper). SIG-
COMM, 2015.
[45] N. Raijer. RPKI for Managers. 5th NLNOG Day, 2018.
[46] RIPE RPKI Certification Stats.
https://certification-
[49] RPKI
Deployment Monitor.
monitor.antd.nist.gov.
en/resources/route-server-guides/rpki.
[50] RPKI at the DE-CIX route servers. https://www.de-cix.net/
[51] RTRlib: The RPKI RTR Client C Library.
https://
rpki.realmv6.org/.
[52] Routinator. https://nlnetlabs.nl/projects/rpki/routinator/.
[47] RIR Regional Statistics.
stats.ripe.net.
statistics/.
[48] RPKI
- Validator.
validator.
https://www.nro.net/about/rirs/
https://github.com/RIPE-NCC/rpki-
https://rpki-
(sidr).
[54] Secure
Inter-Domain
[55] The BGPsec enabled Bird Routing Daemon.
[53] L. Subramanian, V. Roth, I. Stoica, S. Shenker, and R. H. Katz.
Listen and whisper: security mechanisms for BGP. NSDI, 2003.
https:
Routing
//datatracker.ietf .org/wg/sidr/about/.
www.securerouting.net/tools/bird/.
[56] The Forrester Wave: DDoS Mitigation Solutions, Q4
2017. https://www.cloudflare.com/media/pdf/forrester-wave-
ddos-mitigation-solutions-q4-2017.pdf.
[57] Tim Harrington, APNIC. Personal Communication.
[58] M. W¨ahlisch, R. Schmidt, T. C. Schmidt, O. Maennel, S. Uhlig,
and G. Tyson. RiPKI: The Tragic Story of RPKI Deployment
in the Web Ecosystem. HotNets, 2015.
Secure Origin BGP (soBGP). IETF, 2006.
[59] R. White. Architecture and Deployment Considerations for
http://
14