开源版
PolarDB
高级特性
Objectives
• PolarDB是什么
• 如何安装PolarDB开源版
• PolarDB高级特性原理讲解
• 体验PolarDB高级特性
• 更多数据库高级进阶课程
• 如何提升职场竞争力
• 加入PolarDB开源社区
是什么
PolarDB
• 阿里云自研云原生关系型数据库，
100%兼容PostgreSQL & MySQL，
高度兼容Oracle语法
• 基于分布式架构和普通PC服务器，提
供与商用数据库相当的能力，成本仅
有1/10
是什么
PolarDB
是什么
PolarDB
PolarDB-PG
项目主页地址：
https://github.com/ApsaraDB/PolarDB-for-PostgreSQL/
PolarDB-X
项目主页地址：
https://github.com/polardb/polardbx-sql
技术架构
PolarDB
全面开源时间线
PolarDB
如何安装 开源版
PolarDB
• # 拉取 HTAP PolarDB 镜像
docker pull polardb/polardb_pg_local_instance:htap
• # 创建运行并进入容器
docker run -it --cap-add=SYS_PTRACE --privileged=true --name polardb_pg_htap
polardb/polardb_pg_local_instance:htap bash
• # 测试实例可用性
psql -h 127.0.0.1 -c 'select version();'
version
--------------------------------
PostgreSQL 11.9 (POLARDB 11.9)
(1 row)
参考 PolarDB 动手实践课 (如何⼀键本地部署PolarDB for PostgreSQL 版):
https://developer.aliyun.com/adc/scenarioSeries/7e5d067521df4552b8fd10e14565200f
PolarDB官网手册: https://apsaradb.github.io/PolarDB-for-PostgreSQL/zh/
高级特性 多机并行
PolarDB - ePQ
高级特性 多机并行计算
PolarDB - ePQ
4块SATA盘，10亿条数据71GB的表，开跨节点的并行做group by，102秒出结果：
postgres=# explain analyze select n, count(*) from test01 group by n;
QUERY PLAN
-------------------------------------------------------------------------------------------------------------------------------------------------------
PX Coordinator 24:1 (slice1; segments: 24) (cost=0.00..7702.11 rows=9013 width=12) (actual time=101217.270..101219.245 rows=10001 loops=1)
-> Finalize HashAggregate (cost=0.00..7701.85 rows=376 width=12) (actual time=101210.990..101211.068 rows=444 loops=1)
Group Key: n
-> PX Hash 24:24 (slice2; segments: 24) (cost=0.00..7701.80 rows=376 width=12) (actual time=99847.258..101210.355 rows=1482 loops=1)
Hash Key: n
-> Partial HashAggregate (cost=0.00..7701.79 rows=376 width=12) (actual time=101108.066..101108.458 rows=1581 loops=1)
Group Key: n
-> Partial Seq Scan on test01 (cost=0.00..2195.57 rows=41666408 width=4) (actual time=160.269..93734.425 rows=41690624 loops=1)
Planning Time: 6.280 ms
Optimizer: PolarDB PX Optimizer
Execution Time: 101265.420 ms
(11 rows)
Time: 101272.064 ms (01:41.272)
高级特性 预读
PolarDB –
高级特性 预读
PolarDB –
400GB 表的vacuum性能： 400GB 表的 SeqScan 性能：
高级特性 预扩展
PolarDB –
高级特性 预扩展
PolarDB –
未开启预扩展功能:
开启预扩展功能, 写入速度提升4倍:
alter system set polar_bulk_extend_size=512;
select pg_reload_conf();
高级特性 一写多读
PolarDB –
传统架构: PolarDB:
每个数据库实例需要一份数据, 通过日志进行同步. 一份数据, 多个计算节点
RW RO RO RO
缺点: 计算 计算 计算 计算
计算+ 计算+ 计算+ 计算+
• 成本高
• 同步延迟较高 数据 数据 数据 数据
• 扩展不方便
分布式
产生LOG 回放LOG 回放LOG 回放LOG
共享块存储
数据
LOG LOG LOG LOG
同步LOG
高级特性 冷热分离
PolarDB –
计算 计算 计算 计算
按需建立连接
分布式 分布式
共享块存储 对象海量存储存储(OSS)
数据
本地存储: OSS存储: 延迟高、带宽一般、速度一般、便宜
延迟低、带宽高、速度快、贵、 可以跨实例分享数据.
无法直接跨实例分享数据 近乎无限存储空间
高级特性 冷热分离
PolarDB –
高级特性 冷热分离
PolarDB –
参考手册:
https://help.aliyun.com/document_detail/118532.html
高级特性 向量检索
PolarDB –
hnsw:
适合AI的向量相似搜索, 需要向量索引的加速:
图像识别、聊天机器人、相似论文筛选、...
ivfflat:
参考文档: https://help.aliyun.com/document_detail/446755.html
体验 高级特性
PolarDB
PolarDB for PostgreSQL 版动手实践实验:
https://developer.aliyun.com/adc/scenarioSeries/7e5d067521df4552b8fd10e14565200f
体验 高级特性
PolarDB
练习, 用PolarDB证明巴菲特的投资理念
https://github.com/digoal/blog/blob/master/202209/20220908_02.md
https://github.com/digoal/blog/blob/master/202209/20220909_01.md
更多数据库进阶课程
1.PG手册: https://www.postgresql.org/docs/current/index.html
2.PG开源项目: https://git.postgresql.org/gitweb/?p=postgresql.git;a=summary
3.PolarDB-PG手册: https://apsaradb.github.io/PolarDB-for-PostgreSQL/
4.PolarDB-PG开源项目: https://github.com/ApsaraDB/PolarDB-for-PostgreSQL
5.PolarDB-X手册: https://doc.polardbx.com/
6.PolarDB-X开源项目: https://github.com/polardb/polardbx-sql
7.PolarDB-X知乎官方号: https://www.zhihu.com/org/polardb-x
8.PolarDB 开源社区B站视频号: https://space.bilibili.com/2070322174
9.PolarDB 高手课: https://developer.aliyun.com/learning/course/1258
10.PolarDB-PG 内核从入门到精通: https://developer.aliyun.com/learning/topic/database
11.PolarDB 开源学习图谱: https://www.aliyun.com/database/openpolardb/activity
12.免费动手实验: https://developer.aliyun.com/adc/
13.免费云资源: https://click.aliyun.com/m/1000371820/
14.其他资料:
https://www.interdb.jp/pg/index.html
https://postgrespro.com/community/books/internals
https://github.com/digoal/blog/blob/master/README.md
精品课程
开发者赛事
如何提升职场竞争力
学生痛点
:
• 1 压力大: 学分、毕业设计、考研、就业
• 2 静不下心来深入钻研
• 3 不了解企业业务场景和用人需求
• 4 圈子小 (老师, 同学, 亲人) , 酒香(优秀学员)也怕巷子深
• 5 简历单薄, 缺乏竞争力
如何提升职场竞争力
什么样的人才具有竞争力
?
如何提升职场竞争力
• 1 获得内核研发技能
• 《数据库内核研发从入门到精通》 https://developer.aliyun.com/article/1128441
• 成果: 学完可以进行云原生分布式数据库功能研发
• 2 获得数据库通识和应用技能
• 《PG&PolarDB开源数据库工作室》课程
• 成果: 掌握数据库原理、应用开发、实践技能
• 3 掌握企业应用场景和实战技能
• 免费云资源: https://click.aliyun.com/m/1000371820/
• 免费实验室: https://developer.aliyun.com/adc/
• 4 获得技能证明 (但不要止步于考证)
• 参与考试认证 (训练营、数据库人才认证)
• 学习和考试图谱: https://www.aliyun.com/database/openpolardb/activity/
如何提升职场竞争力
• 5 进入开源数据库圈子 (拓展人脉, 专家直通问答, 提升自己的连接数)
• 微信群、钉钉群、PolarDB开源工作室、合作生态伙伴、合作社区等 ... 数十万人群(行业领袖,企业CTO,架构师,开发者等)
• 6 参加分享, 提升个人影响力, 变成社区明星, 提升自己的被连接数 以及 强连接数
• 参与开源meetup分享、开源官网发表文章、在线分享(开源学堂、开源训练营等)、评选数据库之星 ...
• 7 参加比赛; 加入SIG, 参加开源项目代码贡献(顺便完成毕业设计)
• 组队参与编程之夏、开源之夏、黑客松等比赛活动(赢钱赢名气);
• 参与PolarDB开源兴趣小组和开源项目代码贡献;
• 把自己变成金字塔尖人才, 为简历镀金, 争取“保送”机会;
• 8 优秀人才内部推荐、实习机会
加入 开源社区
PolarDB
总结
• PolarDB是什么
• 如何安装PolarDB开源版
• PolarDB高级特性原理讲解
• 体验PolarDB高级特性
• 更多数据库高级进阶课程
• 如何提升职场竞争力
• 加入PolarDB开源社区
练习
• 1、观察多机并行查询对大表查询性能的提升效果
• 2、观察预读带来的大表查询seqscan和vacuum性能提升
• 3、观察预扩展对数据批量写入带来的性能提升
• 4、连接到不同的计算节点, 观察每个计算节点的数据同步延迟