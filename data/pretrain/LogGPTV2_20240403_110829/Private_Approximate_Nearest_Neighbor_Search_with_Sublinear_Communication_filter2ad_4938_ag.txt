Sciences, 60(3):592–629, 2000.
[42] Niv Gilboa and Yuval Ishai. Distributed point functions
and their applications. In Annual International Confer-
ence on the Theory and Applications of Cryptographic
Techniques, pages 640–658. Springer, 2014.
[43] Aristides Gionis, Piotr Indyk, Rajeev Motwani, et al.
In
Similarity search in high dimensions via hashing.
VLDB, volume 99, pages 518–529, 1999.
[44] Oded Goldreich, Silvio Micali, and Avi Wigderson. How
to play any mental game, or a completeness theorem
for protocols with honest majority. In Providing Sound
Foundations for Cryptography: On the Work of Shaﬁ
Goldwasser and Silvio Micali, pages 307–328. 2019.
[45] Internet Security Research Group. Prio services: Privacy-
respecting application metrics. https://www.abetterinternet.
org/prio/, 2021. Accessed August 2021.
[46] Vivien Gueant. iPerf—the TCP, UDP and SCTP network
https://iperf.fr/, 2021.
tool.
bandwidth measurement
Accessed August 2021.
[47] Saikat Guha, Bin Cheng, and Paul Francis. Privad: Prac-
tical privacy in online advertising. In USENIX conference
on Networked systems design and implementation, pages
169–182, 2011.
[48] Sariel Har-Peled, Piotr Indyk, and Rajeev Motwani.
Approximate nearest neighbor: Towards removing the
curse of dimensionality. Theory of computing, 8(1):321–
350, 2012.
[49] Piotr Indyk and Rajeev Motwani. Approximate nearest
neighbors: towards removing the curse of dimensionality.
In Proceedings of the thirtieth annual ACM symposium
on Theory of computing, pages 604–613, 1998.
[50] Piotr Indyk and David Woodruff. Polylogarithmic private
In Theory of
approximations and efﬁcient matching.
Cryptography Conference, pages 245–264. Springer, 2006.
[51] Yuval Ishai, Eyal Kushilevitz, Rafail Ostrovsky, and Amit
Sahai. Batch codes and their applications. In Proceedings
of the thirty-sixth annual ACM symposium on Theory of
computing, pages 262–271, 2004.
[52] William B Johnson and Joram Lindenstrauss. Extensions
of Lipschitz mappings into a Hilbert space 26. Contem-
porary mathematics, 26, 1984.
[53] Shakira Banu Kaleel and Abdolreza Abhari. Cluster-
discovery of Twitter messages for event detection and
trending. Journal of computational science, 6:47–57,
2015.
[54] Donald Ervin Knuth. The art of computer programming,
[26] Hao Chen, Ilaria Chillotti, Yihe Dong, Oxana Poburinnaya,
Ilya Razenshteyn, and M Sadegh Riazi. SANNS: Scaling
up secure approximate k-nearest neighbors search.
In
29th USENIX Security Symposium (USENIX Security 20),
2020.
[27] Weikeng Chen and Raluca Ada Popa. Metal: A metadata-
hiding ﬁle-sharing system. IACR Cryptol. ePrint Arch.,
2020:83, 2020.
[28] Benny Chor, Oded Goldreich, Eyal Kushilevitz, and
In Pro-
Madhu Sudan. Private information retrieval.
ceedings of IEEE 36th Annual Foundations of Computer
Science, pages 41–50. IEEE, 1995.
[29] Benny Chor, Niv Gilboa, and Moni Naor. Private
information retrieval by keywords. Citeseer, 1997.
[30] J. Conway and N. Sloane. Soft decoding techniques for
codes and lattices, including the golay code and the leech
lattice. IEEE Transactions on Information Theory, 32(1):
41–50, 1986. doi: 10.1109/TIT.1986.1057135.
[31] J. H. Conway, R. A. Parker, and N. J. A. Sloane. The
covering radius of the Leech lattice. Proceedings of
the Royal Society of London. Series A, Mathematical
and Physical Sciences, 380(1779):261–290, 1982. ISSN
00804630. URL http://www.jstor.org/stable/2397303.
[32] Henry Corrigan-Gibbs and Dan Boneh. Prio: Private,
robust, and scalable computation of aggregate statistics. In
14th USENIX Symposium on Networked Systems Design
and Implementation (NSDI 17), pages 259–282, 2017.
[33] Henry Corrigan-Gibbs, Dan Boneh, and David Mazières.
Riposte: An anonymous messaging system handling
millions of users. In 2015 IEEE Symposium on Security
and Privacy, pages 321–338. IEEE, 2015.
[34] Mayur Datar, Nicole Immorlica, Piotr Indyk, and Vahab S
Mirrokni. Locality-sensitive hashing scheme based on
In Proceedings of the twentieth
p-stable distributions.
annual symposium on Computational geometry, pages
253–262, 2004.
[35] Emma Dauterman, Eric Feng, Ellen Luo, Raluca Ada
Popa, and Ion Stoica. DORY: An encrypted search system
with distributed trust. In 14th USENIX Symposium on
Operating Systems Design and Implementation (OSDI
20), pages 1101–1119, 2020.
[36] Jack Doerner and abhi shelat. Scaling oram for secure
computation. In Proceedings of the 2017 ACM SIGSAC
Conference on Computer and Communications Security,
pages 523–535, 2017.
[37] Saba Eskandarian, Henry Corrigan-Gibbs, Matei Zaharia,
and Dan Boneh. Express: Lowering the cost of metadata-
hiding communication with cryptographic privacy.
In
30th USENIX Security Symposium (USENIX Security 21),
pages 1775–1792, 2021.
[38] David Evans, Yan Huang, Jonathan Katz, and Lior Malka.
Efﬁcient privacy-preserving biometric identiﬁcation. In
Proceedings of the 17th conference Network and Dis-
tributed System Security Symposium, NDSS, volume 68,
pages 90–98, 2011.
[39] GNU foundation. GMP library.
https://gmplib.org/.
volume 3. Pearson Education, 1997.
[55] Dmitry Kogan and Henry Corrigan-Gibbs.
Private
In 30th USENIX
blocklist
Security Symposium (USENIX Security 21), pages 875–
lookups with checklist.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:00:59 UTC from IEEE Xplore.  Restrictions apply. 
15925
892. USENIX Association, August 2021. ISBN 978-1-
939133-24-3. URL https://www.usenix.org/conference/
usenixsecurity21/presentation/kogan.
[56] Brian Kulis and Kristen Grauman. Kernelized locality-
sensitive hashing for scalable image search. In 2009 IEEE
12th international conference on computer vision, pages
2130–2137. IEEE, 2009.
[57] Yann LeCun, Léon Bottou, Yoshua Bengio, and Patrick
Haffner. Gradient-based learning applied to document
recognition. Proceedings of the IEEE, 86(11):2278–2324,
1998.
[58] Yury Lifshits. The homepage of nearest neighbors
and similarity search. http://simsearch.yury.name/, 2008.
Accessed August 2021.
[59] Yehuda Lindell and Benny Pinkas. An efﬁcient protocol
for secure two-party computation in the presence of mali-
cious adversaries. In Annual international conference on
the theory and applications of cryptographic techniques,
pages 52–78. Springer, 2007.
[60] Dandan Lu, Yue Zhang, Ling Zhang, Haiyan Wang,
Wanlin Weng, Li Li, and Hongmin Cai. Methods of
privacy-preserving genomic sequencing data alignments.
Brieﬁngs in Bioinformatics, 2021.
[61] Qin Lv, William Josephson, Zhe Wang, Moses Charikar,
and Kai Li. Multi-probe LSH: efﬁcient indexing for
high-dimensional similarity search. In 33rd International
Conference on Very Large Data Bases, VLDB 2007, pages
950–961. Association for Computing Machinery, Inc,
2007.
[62] Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg S
Corrado, and Jeff Dean. Distributed representations of
words and phrases and their compositionality. In Advances
in neural information processing systems, pages 3111–
3119, 2013.
[63] Michael Mitzenmacher and Eli Upfal. Probability and
computing: Randomization and probabilistic techniques
in algorithms and data analysis. Cambridge university
press, 2017.
[64] Rajeev Motwani, Assaf Naor, and Rina Panigrahi. Lower
bounds on locality sensitive hashing. In Proceedings of
the twenty-second annual symposium on Computational
geometry, pages 154–157, 2006.
[65] Muhammad Naveed, Erman Ayday, Ellen W Clayton,
Jacques Fellay, Carl A Gunter, Jean-Pierre Hubaux,
Bradley A Malin, and XiaoFeng Wang. Privacy in the
genomic era. ACM Computing Surveys (CSUR), 48(1):
1–44, 2015.
[66] Zachary Newman, Sacha Servan-Schreiber, and Srinivas
Devadas. Spectrum: High-Bandwidth anonymous broad-
cast. In 19th USENIX Symposium on Networked Systems
Design and Implementation (NSDI 22), Renton, WA, April
2022. USENIX Association. URL https://www.usenix.
org/conference/nsdi22/presentation/newman.
[67] Laurent Noé and Gregory Kucherov. YASS: Similarity
search in DNA sequences. PhD thesis, INRIA, 2003.
[68] Naoaki Okazaki and Jun’ichi Tsujii. Simple and efﬁcient
[86] Clara E Yoon, Ossian O’Reilly, Karianne J Bergen,
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:00:59 UTC from IEEE Xplore.  Restrictions apply. 
16926
algorithm for approximate dictionary matching.
In
Proceedings of the 23rd International Conference on
Computational Linguistics (Coling 2010), pages 851–859,
2010.
[69] Rina Panigrahy. Entropy based nearest neighbor search
in high dimensions. arXiv preprint cs/0510019, 2005.
[70] Yinian Qi and Mikhail J Atallah. Efﬁcient privacy-
In 2008 The
preserving k-nearest neighbor search.
28th International Conference on Distributed Computing
Systems, pages 311–319. IEEE, 2008.
[71] Michael O Rabin. How to exchange secrets with oblivious
transfer. IACR Cryptol. ePrint Arch., 2005(187), 2005.
[72] Anand Rajaraman and Jeffrey David Ullman. Mining of
massive datasets. Cambridge University Press, 2011.
[73] Deepak Ravichandran, Patrick Pantel, and Eduard Hovy.
Randomized algorithms and NLP: Using locality sensitive
hash functions for high speed noun clustering.
In
Proceedings of the 43rd Annual Meeting of the Association
for Computational Linguistics (ACL’05), pages 622–629,
2005.
[74] Eric Rescorla and Tim Dierks. The transport layer security
(TLS) protocol version 1.3. 2018.
[75] M Sadegh Riazi, Beidi Chen, Anshumali Shrivastava,
Dan Wallach, and Farinaz Koushanfar.
Sub-linear
privacy-preserving near-neighbor search. arXiv preprint
arXiv:1612.01835, 2016.
[76] Sacha Servan-Schreiber, Simon Langowski, and Srinivas
Devadas. Private approximate nearest neighbor search
with sublinear communication. Cryptology ePrint Archive,
2021.
[77] Adi Shamir. How to share a secret. Communications of
the ACM, 22(11):612–613, 1979.
[78] Hayim Shaul, Dan Feldman, and Daniela Rus. Secure
k-ish nearest neighbors classiﬁer. Proceedings on Privacy
Enhancing Technologies, 2020(3):42–61, 2020.
[79] Speedtest.com. Speedtest.com global index. https://www.
speedtest.net/global-index, 2021. Accessed August 2021.
[80] Vincent Toubiana, Arvind Narayanan, Dan Boneh, Helen
Nissenbaum, and Solon Barocas. Adnostic: Privacy
preserving targeted advertising. In Proceedings Network
and Distributed System Symposium, 2010.
[81] Avery Wang et al. An industrial strength audio search
algorithm. In Ismir, volume 2003, pages 7–13. Citeseer,
2003.
[82] Web Incubator CG. FLoC. https://github.com/WICG/ﬂoc,
2021. Accessed August 2021.
[83] Guowen Xu, Hongwei Li, Hao Ren, Xiaodong Lin,
and Xuemin Sherman Shen. DNA similarity search
IEEE
with access control over encrypted cloud data.
Transactions on Cloud Computing, 2020.
[84] Andrew C Yao. Protocols for secure computations. In 23rd
annual symposium on foundations of computer science
(sfcs 1982), pages 160–164. IEEE, 1982.
[85] Peter N Yianilos. Locally lifting the curse of dimension-
ality for nearest neighbor search. 1999.
and Gregory C Beroza. Earthquake detection through
Science
computationally efﬁcient similarity search.
advances, 1(11):e1501057, 2015.
[87] Martin Zuber and Renaud Sirdey. Efﬁcient homomorphic
evaluation of k-NN classiﬁers. Proc. Priv. Enhancing
Technol., 2021(2):111–129, 2021.
A. LSH-based ANN data structure
APPENDIX
We describe the LSH-based data structure for approximate
nearest neighbor search of Gionis et al. [43] in Figure 9.
LSH-based ANN search data structure
BUILD(DB,H, L) → (T1, . . . , TL) takes as input a set of N
vectors DB = {v1, . . . , vN}, LSH family H (Deﬁnition 1),
and number of tables L. Outputs hash tables T1, . . . , TL.
1: Sample L LSH functions h1, . . . , hL from H.
2: Use hi to build Ti by hashing each vector v1, . . . , vN .
3: Output L hash tables T1, . . . , TL.
QUERY(T1, . . . , TL, h1, . . . , hL, q) → ID takes as input a
query vector q, L hash tables, and LSH functions.
1: Compute bucket key α ← hi(q) and retrieve the corre-
sponding bucket Bα in Ti under key α (if non-empty).a
2: Set C := B1 ∪ ··· ∪ BL.
3: Find j such that vj ∈ C and ∆(vj, cR) ≤ cR via brute-
force distance comparisons.
4: if no such j exists, output 0; else output j.
aNote that by the properties of LSH, the query will collide with
probability proportional to the relative distance from other vectors.
Fig. 9: ANN search data structure based on locality-sensitive hashing
of Gionis et al. [43].
B. Determining LSH radii for radix sorting
We discuss how to determine the radii to use when instanti-
ating the data structure of Figure 4. We sample 10, 000 points
from each training set, and ﬁnd the nearest neighbor among the
other training set points. The results are shown in Figure 11. We
use a normal distribution computed over the resulting distances
as an approximation (orange line in Figure 11), and choose the
Ri along the quantiles of the normal distribution. Figure 11 is
shown for L = 10. This ensures that the number of expected
candidates colliding at each Ri is approximately the same (in
Figure 11, the area between the dashed lines is the same). Our
intuition is that equal areas means that each table will have 1
L
of the collisions, balancing the load and maximizing efﬁciency.
Each vertical dotted line in Figure 11 corresponds to the Ri
for an LSH family for the ith hash table, where R1 > Dmin
and R10 = Rmax.