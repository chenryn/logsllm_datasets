user population and personalization. Previous stud-
ies mostly rely on user surveys or active user par-
ticipation (e.g., by installing a software on user ma-
chines) [12, 11, 16, 14]. Their ﬁndings show that 30% to
40% of users clear cookies monthly. A separate study by
Yahoo! [13] ﬁnd that 40% and 60% of users have empty
browser caches, so they probably have cleared cookies
as well. While our results are consistent with previous
ﬁndings, the approach we take requires neither user co-
operation nor special content setup.
Host mobility studies have been performed in the
context of wireless [17, 27, 22, 25], ad hoc [24, 26],
and cellular networks [19] to obtain more accurate de-
vice moving models or to predict user locations. Sim-
ler et al. [35] studied user mobility in terms of ses-
sion characteristics based on login events to a university
email server in order to generate synthetic traces. Re-
cent work [33] proposed a technique for classifying IP
addresses into home and travel categories to study host
travel and relocation patterns in the U.S. By studying
cross-domain cookies, our work focuses on normal host
mobility patterns that enable us to observe uncommon
phenomena and detect malicious activities.
7 Discussion and Conclusion
In this paper, we perform a large-scale exploration
of common identiﬁers and quantify the amount of host-
identifying information that they reveal. Using month-
long datasets from Hotmail and Bing, we show that com-
mon identiﬁers can help track hosts with high precision
and recall.
Our study also informs service providers of the
potential information leakage when they anonymize
datasets (e.g., replacing IP addresses with IP preﬁxes)
and release data to third-party collaborators or to the
public. For example, we show that hashes of browser
information (i.e., the anonymized UA strings) alone can
be quite revealing when examined in one network do-
main. Furthermore, coarse-grained IP preﬁxes achieve
similar host-tracking accuracy to that of precise IP ad-
dress information when they are combined with hashed
UA strings.
Our analysis suggests that users who do not wish to
be tracked should do much more than clear cookies. Un-
common behaviors such as clearing cookies for each re-
quest may instead distinguish a host from others who do
not do so. Users should take notice of their user-agent
strings (e.g., modify the default setting [10]), consider
the use of proxies, and possibly resort to sophisticated
techniques such as anonymous routing [37].
In some
cases, several of these techniques should be combined
to be effective, e.g., clearing cookies in addition to the
use of proxies or Tor.
Finally, despite its privacy implications, we demon-
strate the security beneﬁt of host-tracking. Given the
growing concerns over account hijacking and session hi-
jacking, we expect host ﬁngerprinting and tracking tech-
niques can help defend against such attacks in the future.
Acknowledgments
We are grateful to Hotmail, Bing, and Windows Up-
date for providing us with data access that makes this
study possible. We thank Zijian Zheng for his guidance
and insight on cookie-churn analysis. We thank Keiji
Oenoki and Hersh Dangayach for providing us with data
related with cookie-forwarding attacks and for the help
in the subsequent investigation. We thank the reviewers,
and in particular Paul Syverson, for their suggestions of
improvements to this paper.
References
[1] CookieCooker.
http://www.cookiecooker.
de/.
[2] Nmap free security scanner. http://nmap.org.
[3] Project details for evercookie. http://samy.pl/
evercookie/.
[4] Project details
for p0f.
http://lcamtuf.
coredump.cx/p0f.shtml.
[5] Project details for xprobe. http://sourceforge.
net/projects/xprobe/.
your PC and website
hijacking.
[6] Secure
session
com/businesscenter/article/210028/
secure your pc and website from
firesheep session hijacking.html.
from Firesheep
http://www.pcworld.
[7] Tor
Project:
Torbutton.
https://www.
torproject.org/torbutton/.
[8] Tor Proxy List. http://proxy.org/tor.shtml.
[9] U. Oregon Route Views Project.
http://www.
routeviews.org/.
[10] User-agent switcher. https://addons.mozilla.
org/en-US/firefox/addon/59/?id=59.
[11] 40% of consumers zap cookies weekly.
http://
www.marketingsherpa.com/!newsletters/
bestofweekly-4-22-04.htm#topic1, 2004.
[12] Measuring unique visitors: Addressing the dramatic de-
cline in accuracy of cookie-based measurement. White
paper, Jupiter Research, 2005.
user
part 2:
interface blog:
[13] Yahoo!
search,
http://yuiblog.com/blog/2007/01/04/
performance-research-part-2/, 2007.
Performance re-
Browser cache usage exposed!
[14] Cookie corrected audience data. White paper, Quantcast
Corp., 2008.
[15] Protecting consumer privacy in an era of rapid change.
Federal Trade Commission Staff Report, 2010.
[16] M. Abraham, C. Meierhoefer, and A. Lipsman. The im-
pact of cookie deletion on the accuracy of site-server and
ad-server metrics: an empirical comScore study. White
paper, comScore, Inc., 2007.
[17] M. Balazinska and P. Castro. Characterizing mobility
and network usage in a corporate wireless local-area net-
work. In Intl. Conf. Mobile Systems, Applications, Ser-
vices, 2003.
[18] V. Brik, S. Banerjee, M. Gruteser, and S. Oh. Wireless
device identiﬁcation with radiometric signatures. In Intl.
Conf. Mobile Computing and Networking, 2006.
[19] I. Constandache, S. Gaonkar, M. Sayler, R. Choudhury,
and L. Cox. Energy-efﬁcient localization via personal
mobility proﬁling. In Intl. Conf. Mobile Computing, Ap-
plications, and Services, 2009.
[20] P. Eckersley. How unique is your web browser? In Pri-
vacy Enhancing Technologies Symp., 2010.
[21] J. Franklin, D. McCoy, P. Tabriz, V. Neagoe, J. V. Rand-
wyk, and D. Sicker. Passive data link layer 802.11 wire-
less device driver ﬁngerprinting.
In USENIX Security
Symp., 2006.
[22] J. Ghosh, M. Beal, H. Ngo, and C. Qiao. On proﬁling
In
mobility and predicting locations of wireless users.
Intl. Workshop on Multi-hop ad hoc networks, 2006.
[23] J. Hall, M. Barbeau, and E. Kranakis. Detection of
transient in radio frequency ﬁngerprinting using signal
phase. In Intl. Conf. Wireless and Optical Communica-
tions, 2003.
[24] X. Hong, M. Gerla, G. Pei, and C. Chiang. A group
In ACM
mobility model for ad hoc wireless networks.
Intl. Workshop on Modeling, Analysis and Simulation of
Wireless and Mobile Systems, 1999.
[25] N. Husted and S. Myers. Mobile location tracking in
In ACM Conf. Com-
metro areas: Malnets and others.
puter and Communication Security, 2010.
[26] A. Jardosh, E. Belding-Royer, K. Almeroth, and S. Suri.
Towards realistic mobility models for mobile ad hoc net-
works. In Intl. Conf. Mobile Computing and Networking,
2003.
[27] M. Kim, D. Kotz, and S. Kim. Extracting a mobility
model from real user traces. In IEEE Infocom, 2006.
[28] T. Kohno, A. Broido, and K. Claffy. Remote physical de-
vice ﬁngerprinting. In IEEE Symp. Security and Privacy,
2005.
[29] B. Krishnamurthy and C. E. Wills. Characterizing pri-
In ACM Workshop on
vacy in online social networks.
Online Social Networks, 2008.
[30] B. Krishnamurthy and C. E. Wills. Privacy leakage in
mobile online social networks. In USENIX Conf. Online
Social Networks, 2010.
[31] J. R. Mayer. “Any person... a pamphleteer”:
Internet
anonymity in the age of Web 2.0. Senior Thesis, Stan-
ford University, 2009.
[32] J. Pang, B. Greenstein, R. Gummadi, S. Seshan, and
D. Wetherall. 802.11 user ﬁngerprinting. In Intl. Conf.
Mobile Computing and Networking, 2007.
[33] A. Pitsillidis, Y. Xie, F. Yu, M. Abadi, G. Voelker, and
S. Savage. How to tell an airport from a home: Tech-
niques and applications. In ACM Workshop on Hot Top-
ics in Networks, 2010.
[34] K. Rasmussen and S. Capkun. Implications of radio ﬁn-
In Intl.
gerprinting on the security of sensor networks.
Conf. Security and Privacy in Comm. Networks, 2007.
[35] K. Simler, S. Czerwinski, and A. Joseph. Analysis
In IEEE Workshop
ofwide area user mobility patterns.
on Mobile Computing Systems and Applications, 2004.
[36] A. Soltani, S. Canty, Q. Mayo, L. Thomas, and C. Hoof-
nagle. Flash cookies and privacy. SSRN preprint, 2009.
[37] P. Syversion, D. Goldschlag, and M. Reed. Anonymous
connections and onion routing. In IEEE Symp. Security
and Privacy, 1997.
[38] Y. Xie, F. Yu, and M. Abadi. De-anonymizing the inter-
net using unreliable IDs. In ACM SIGCOMM, 2009.
Appendix
A Tracking Stable Hosts
In the presence of NATs, proxies, and dynamic IP
addresses, the mapping between a host and an IP ad-
dress can be extremely volatile. Service providers that
are interested in ﬁngerprinting stable hosts may trade
coverage for accuracy. We show that the binding win-
dow length can serve as a conﬁdence measure for this
purpose.
Intuitively, stable and active hosts should have longer
binding windows that make them easier to track than
hosts that appear infrequently or that change IP ad-
dresses often. Indeed, using UA+IP as an example, Fig-
ure 10(a) shows the increase in precision and recall with
longer binding windows.
However, as we impose increasingly strict require-
ments on the binding window length, the percentage of
ﬁngerprints remaining decreases roughly proportionally,
as shown in Figure 10(b). Half of the ﬁngerprints have
binding windows no longer than one week. We can thus
explore a tradeoff between accuracy and coverage of
)
%
(
t
e
g
a
n
e
c
r
e
P
)
%
(
s
t
n
i
r
p
r
e
g
n
i
f
f
o
t
e
g
a
n
e
c
r
e
P
100
99
98
97
96
95
94
93
0
100
80
60
40
20
0
0
Precision
Recall
5
10
15
20
Binding Window Length (Days)
(a)
5
10
15
20
Binding Window Length (Days)
(b)
Figure 10. Binding length and accuracy
tradeoff.
tracking hosts using the binding window length as an
adjustable parameter. In particular, Figure 10 suggests
that using a binding window length of ﬁve days in prac-
tice can achieve both high precision and recall without
losing signiﬁcant coverage.
B Non-returning Users
For those 101,427 “one-time” non-returning users
that were observed only on the ﬁrst day of the Search
dataset we are interested in whether this is because they
stopped using the service or because they cannot be
tracked. We expect users who leave the service to be
less engaged than returning users. To test this hypoth-
esis, we examine the average number of queries sub-
mitted by each CID and the percentage of CIDs that
have clicked on the query results. We compare these
two statistics between the set of returning users and the
set of non-returning users. We consider only churned
new CIDs in this comparison. For example, if a return-
ing user has queries associated ﬁrst with CID1 and later
with CID2, we consider the subset of queries that cor-
respond to CID1 only, as they represent ﬁrst-time user
experience.
Table 11 shows that returning users indeed appear to
Average number of queries per CID
Percentage of CIDs with clicks
4.7
60.73%
7.0
77.85%
Non-returning users
Returning users
Table 11. The query and click behaviors of returning and non(cid:173)returning users from the ﬁrst day
of the log.
be more engaged in the service, generating more queries
on average and are also more likely to make clicks.
Overall, 77.85% of the churned new CIDs that belong
to returning users have clicks, while only 60.73% of the
churned new CIDs from non-returning users have clicks.
We further examine, for each CID, the percentage of
search queries that resulted in clicks. For CIDs that be-
long to returning users, Figure 11 shows a larger per-
centage of queries have clicks than CIDs that belong
to non-returning users. Half of the CIDs associated
with returning users have clicks on 80% of their queries,
while half of those associated with non-returning users
have them on less than 50%.
)
%
(
s
D
I
i
e
k
o
o
c
d
e
n
r
u
h
c
f
o
e
g
a
t
n
e
c
e
P
100
90
80
70
60
50
40
30
20
0
Returning users
Not returning users
80
20
Percentage of queries clicked (%)
40
60
100
Figure 11. Cumulative distribution of the
fraction of queries per CID that resulted in
clicks.
Another question of interest is whether users stop us-
ing the service because they are less active and have in-
frequent online activities. To quantify the degree of ac-
tivity of the non-returning users, we measure the time
interval and the number of login events between the last
Bing search query and the last Hotmail login event that
fall within the host’s binding windows, shown in Fig-
ure 12. We ﬁnd that though users in our data may have
left the search service, many of them have continued on-
line activities. More than 80% of these users are active
even after 25 days (Figure 12(a)), and around 60% of
them logged in more than 40 times (Figure 12(b)).
(a)
(b)
Figure 12. (a) The time between the last
Bing search query and last Hotmail login.
(b) The number of Hotmail logins after the
last Bing search query.