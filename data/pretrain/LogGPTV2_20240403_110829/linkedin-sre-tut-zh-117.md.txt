# 持续交付与部署

持续交付（Continuous Delivery, CD）是指在非生产环境中频繁地进行应用构建的部署，例如在系统集成测试（SIT）、用户验收测试（UAT）以及集成测试环境（INT）中，并在此过程中自动执行集成测试和验收测试。对于基于微服务架构的应用而言，这些测试是在整个集成后的应用程序上进行，而不仅仅针对单独的微服务组件。此外，所有类型的测试都应涵盖功能测试及验收测试，特别是那些涉及用户界面的部分。

为了确保一致性，所使用的构建包必须是不可变的，即无论在哪种环境下——包括但不限于生产环境——都应该使用相同的软件包来进行部署。尽管如此，在将最终版本推送到实际生产之前，通常还需要额外的手动批准步骤，比如性能测试等。如果实现了从代码提交到生产的完全自动化流程，则这种做法被称为“持续部署”（Continuous Deployment），而非简单的持续交付。持续部署要求具备特性开关机制，以便能够在不重新部署的情况下快速启用或禁用特定功能。

实践中，向生产环境过渡时往往采用多阶段策略，如蓝绿部署法就是一个典型例子。这种方法通过先将更新发布到一个独立但并行运行的新“绿色”环境中，待验证无误后再切换流量至该新环境，从而最大限度减少对现有服务的影响，实现无缝切换而不必中断服务。

![](img/0fd2923f2208df91aec588d6ef82acd1.png)

*图 3: 连续交付管道示意图*