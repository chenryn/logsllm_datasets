suring larger number of samples for high volume hostnames. Speciﬁcally, we assign
a weight # of malicious webpages of the cluster
for each cluster of URLs that share the
same hostname. We chose 400 samples to manually check whether they are malicious.
Since total number of hostnames is less than this number, we picked at least one URL
from each cluster. The remaining were sampled using the weight calculated above. We
found that 93 webpages belonged to a group of fast ﬂux hostnames (discussed in sec-
tion 3.4), that we are quite certain that they are malicious. Out of the rest, we found that
more than 87% of the webpages are actually malicious.
# of malicious webpages overall
3.1 Temporal Analysis
The PhishLive system computes the number of HTTP requests and number of malicious
URLs observed per hour. Host users behave very differently at different times of a
day, that could mean different fraction of malicious website accesses depending on the
time of day. To investigate this, we focus on the ratio of malicious website visits as a
proportion of the total number of HTTP requests (which we call malicious ratio in our
paper). From the perspective of an IDS, a higher malicious ratio at a certain time means
that a HTTP connection observed at this time has higher probability to be malicious
website attack.
Figure 2(a) shows the malicious ratio which varies from 0.008% to 0.257% over
the one month period. Users usually make more HTTP requests during daytime than
night, which could mean more malicious website accesses during daytime than night.
However, from Figure 2(b) which displays the average malicious ratio for 24 hours,
we observe that the malicious ratio is signiﬁcantly higher (almost double) from 11 PM
to 5 AM compared to daytime. Upon further investigation, we found that the abso-
lute number of attacks is almost the same during daytime and night, with a slight edge
during night (average 11,460 during daytime compared with 12,098 during nighttime).
We believe the reason for this stems from the fact that these accesses could be auto-
matically initiated by malware already present on infected computers rather than via
human accesses. As the study [9] on malware infections indicates, about 58.6% of all
244
L. Cao, T. Probst, and R. Kompella
Malicious Ratio Over 31 days
)
%
(
o
i
t
a
R
s
u
o
c
i
i
l
a
M
0.25
0.2
0.15
0.1
0.05
0
4−18−2012
4−17−2012
4−16−2012
4−15−2012
4−14−2012
4−13−2012
4−12−2012
4−11−2012
4−10−2012
4−09−2012
4−08−2012
4−07−2012
4−06−2012
4−05−2012
4−04−2012
4−03−2012
4−02−2012
4−01−2012
3−31−2012
3−30−2012
3−29−2012
3−28−2012
3−27−2012
3−26−2012
3−25−2012
3−24−2012
3−23−2012
3−22−2012
3−21−2012
3−20−2012
3−19−2012
4−19−2012
(a) Malicious ratio
Date
Average Malicious Ratio Over 24 hours
0.09
0.08
0.07
0.06
0.05
0.04
)
%
(
o
i
t
a
R
s
u
o
c
i
i
l
a
M
0.03
23:00
22:00
21:00
20:00
19:00
18:00
17:00
16:00
15:00
14:00
13:00
12:00
11:00
10:00
09:00
08:00
07:00
06:00
05:00
04:00
03:00
02:00
01:00
24:00
Time
(b) Time of day
Fig. 2. Prevalence and location of malicious websites in our dataset. Subplot (a) shows the ratio
of malicious URLs to benign over the month. (b) shows per-hour average malicious ratio.
malware make HTTP accesses, which partly explains our observations. In addition, we
found a non-negligible numbers of visits to pornographic websites at nights compared
to daytime, which are often associated with many types of malware.
3.2 Access Characteristics of Victims
We now analyze the malicious URL access characteristics. Speciﬁcally, we focus on
the timing of the user accesses to attacker domains (IP addresses) and the relationship
between victims (IP addresses) and attacker domains. Figure 3(a) displays the timing
characteristics of when the attacker domains have been accessed by users. The y-axis
represents distinct hostnames of attackers we observed in our data, while the x-axis is
the date, with a resolution of one day. We can see that there are roughly three types of
attacker domains. Type I attacker domains are those that users access frequently over a
long period of time; such domains are appear as a horizontal line in the ﬁgure. Attacker
domains of type II are those that may be intermittently accessed by users. They appear
as dashed horizontal line in the ﬁgure. Type III attackers scatter attacks infrequently, and
mostly appear as sparse points in the ﬁgure. Figure 3(b) shows the scatter plot between
victims and attacker domains. From the ﬁgure, we can see that a signiﬁcant number of
victims seem to have contacted a few popular attacker IP addresses. Similarly, vertically,
many users seem to have contacted many different attacker IP addresses as well.
(a) Attacker hostnames
(b) Victim Attacker scatter plot
Fig. 3. Behavior of attacker’s hostnames and IP addresses over time
PhishLive: A View of Phishing and Malware Attacks from an Edge Router
245
3.3 Persistence of Hostnames
The previous graphs used IP addresses; since a single IP address could host many dif-
ferent hostnames, we now switch to understanding the persistence characteristics of the
various hostnames we observed. Since we do not exactly know the lifetime of a host-
name, we only focus on duration between the ﬁrst and last times a URL was observed
from a given hostname as an estimate of the lifetime of a given hostname. In Figure 4(a),
we plot a histogram of the number of days a particular hostname was observed in our
dataset. The x-axis is the number of days an attack hostname was observed, while the
y-axis shows the fraction of attacks. Since we have collected only one month’s trace,
we restrict ourselves to the hostnames collected in the ﬁrst 15 days, so each hostname
has the same chance of appearing in the next 15 days from the ﬁrst time a hostname
appears to eliminate the fringe bias in our data. In Figure 4(a), we found that almost
50% of the attacker hostnames were present for less than 1 day, which conﬁrms the
fast-ﬂux like behavior observed in previous studies [20, 21]. But there are a non-trivial
number of hostnames that were accessed persistently for a number of days. Close to
10% of the hostnames were accessed for all 15 days; due to lack of data beyond, we
cannot conclusively determine how long these campaigns actually persisted.
s
e
m
a
n
t
s
o
H
f
o
n
o
i
t
p
o
r
P
0.5
0.45
0.4
0.35
0.3
0.25
0.2
0.15
0.1
0.05
0
1
2
3
5
6
8
4
Number of Days Attacks Happened
9 10 11 12 13 14 15
7
s
e
m
a
n
t
s
o
H
f