diﬀer, we deduce that either (A1) or (A2),
or both, have been violated. Since our observations do not allow us to distinguish
violations of (A1) from violations of (A2), we state merely that a path length
incoherency reveals a violation of the composite assumption (A1 ⊕ A2).
Incoherent AS Relationships. We observe incoherent AS relationships as
follows. According to (A3), an AS assigns higher values of local_pref to its
customers than to its peers, which in turn receive higher values than do the
providers. Also, according to (A4), there is only one relationship between two
ASes, which means that there is one value of local_pref per neighboring AS
and that this value further corresponds to the type of the relationship. Further,
according to (A1), if an AS X is observed to do multi-exit routing through two
diﬀerent ASes Y and Y (cid:3)
then routes learned from those ASes have the same
value of local_pref. Finally, according to (A2), Y and Y (cid:3)
must have identical
types of relationship with X (e.g., they are both customers of X).
As a consequence, our second criterion is to examine the relationships between
an AS and its next-hop ASes in a multi-exit. This requires the availability of an
AS relationship database. We consider c2p and peer relationships, leaving out
the special case of s2s without aﬀecting our conclusions. If the relationships
diﬀer, then we can infer that at least one of the assumptions in the composite
set (A1 ⊕ A2⊕ A3⊕ A4) is violated.
4 Results
4.1 Data Sources
Our study is based on two types of data: BGP updates and AS relationships.
We parsed IPv4 BGP updates from BGPmon, which gathers data provided by
RouteViews2 and peers to some other BGP routers [1].
We ran our analysis on snapshots taken in August 2012, then January, March,
and August 2013. Results presented here are based on a snapshot taken on 24
March 2013 at 10:00:00 GMT. Table 2 lists some snapshot statistics and results.
The other snapshots were similar.3
To increase the likelihood that each route that has been introduced has indeed
had a chance to propagate to all of the vantage points, we apply a route stability
ﬁlter. We consider a route stable if it is the last one received by a BGP router
concerning a preﬁx and it has been received at least 24 hours ago without being
withdrawn. The ﬁlter causes us to slightly undercount multi-exits, and its eﬀect
on the overall results is negligible.
http://www.routeviews.org/
2
3 All of our data is publicly available at http://top-hat.info/routing-assumptions/.
Violation of Interdomain Routing Assumptions
179
We also remove from AS paths any ASNs reported by CAIDA [3] to belong
to Internet exchange points (IXPs). In principle, these do not play a role in the
routing policy of the ASes they interconnect.
Table 2. Snapshot statistics and results
routes
stable routes
preﬁxes
vantage points
triplets
unique triplets
transit ASes
transit ASes having multi-exits
MEs (multi-exits)
MEs with incoherence
MEs with incoherent path length only
MEs with incoherent relationships only
MEs with both incoherencies
3,948,447
3,493,673
459,532
35 routers in 32 ASes
13,852,998
8,257,351
100%
21%
100%
63%
30%
6%
27%
6,762
1,441
204,423
129,590
62,051
12,229
55,310
There is limited publicly available ground truth for AS relationships. From the
projects that aim to infer them, we chose CAIDA’s relationship dataset [3] since
it is the only one we know to have a fully public methodology. For the 34.6% of
their inferences that they were able to validate against either public or privately-
obtained ground truth, they report accuracy of 99.6% for c2p relationships and
98.7% for peer relationships [17].
4.2 Quantifying Multi-exits
We observed 204,423 multi-exits, each having usually 2, but in some cases as
many as 5, next-hop ASes. These constitute 2.7% of the (AS, destination preﬁx)
pairs in our database (the remainder having just one next-hop AS), so by this
metric multi-exits might seem to be rare. However, of the 6,762 transit ASes
in our dataset, we observed 21% to be performing multi-exit routing. We found
multi-exits in the ASes ranked 1 through 38 in CAIDA’s AS ranking [2], including
in all of the dozen or so ASes that are generally considered to be tier 1. So,
multi-exit observations reveal information about ASes that play a central role
in Internet routing.
4.3 Quantifying Incoherences
Fully 63% of the multi-exits in our dataset show incoherencies. AS Path length
incoherencies, implying a violation of composite assumption (A1⊕ A2), showed
up in 57% of multi-exits. AS relationship incoherencies, implying a violation of
(A1 ⊕ A2 ⊕ A3 ⊕ A4), appeared in 33% of the multi-exits. There is overlap, with
27% of multi-exits revealing both kinds of incoherency.
180
R. Mazloum et al.
4.4 Possible Causes for Violations
We speculate on reasons for these assumptions to be violated.
Traﬃc Engineering. From our conversations with people familiar with large
operators, we believe that the assumptions don’t fully capture contemporary
traﬃc engineering practices. An AS might prefer, for example, to send some
traﬃc through a peer rather than a customer, or through a provider rather
than a peer, intentionally violating (A3). This could happen when the customer
has insuﬃcient bandwidth. It could also arise when a router in a large AS is
geographically closer to a peer than to a customer, and the revenue that would
be generated by routing via the customer is outweighed by the cost of carrying
the traﬃc internally to the egress point for that customer.
Complex or Hybrid AS Relationships. Previous work [15,17] has highlighted
the existence of complex or hybrid relationships, in which, for example, one large
AS might be another’s peer on one continent and its customer elsewhere. Such rela-
tionships violate (A4), and to be implemented (A2) must be violated. The CAIDA
AS relationship database [17] is built using an understanding of this sort of rela-
tionship, but it provides as output only one relationship per AS pair.
Misconﬁgurations. A router misconﬁguration might cause any one of the as-
sumptions to be violated. For example, an incorrect value of local_pref could
result in an AS inadvertently favoring a provider over a customer, violating (A3).
Erroneous AS Relationships. An alternative is that assumptions are not
violated as often as our results indicate, but rather that CAIDA’s database is
not indicating the correct AS relationships, despite its high accuracy in cases
where it has been validated. However, it would need to be incorrect in a large
portion of cases in order to change our overall conclusions.
5 Related Work
As we have described in previous sections, many papers in the literature [5–17]
have employed various assumptions about interdomain routing. Some of these
papers, as well as others, have looked at violations of these assumptions.
Feamster et al. [18] give some examples of violations of (A1) that can appear.
Gill et al. [19] queried 100 network operators for their private data, ﬁnding
that 77% of ASes do not modify the value of local preference, i.e., they are
coherent with (A2). The same survey reports that 87% of the concerned ASes
are also coherent with (A3). M¨uhlbauer et al. [9] compared the routes that
actually propagate to vantage points with the routes that ought to propagate,
revealing violations of (A3). Giotsas et al. [20] show that relationships between
pairs of ASes for IPv4 routes diﬀer in 13% of the cases from those for IPv6
routes. Roughan et al. [21] summarize lessons about modeling ASes based on an
extensive study of common assumptions. They observe, notably, that modeling
an AS interconnection by a single connection is insuﬃcient. M¨uhlbauer et al. [8]
similarly show the weaknesses in modeling an AS as an atomic entity.
Violation of Interdomain Routing Assumptions
181
Our work goes further by providing a method for detecting violations of com-
monly employed assumptions using publicly available data. We supply the ﬁrst
quantiﬁcation of the extent of observable violations.
Our ﬁnding that violations can be observed in a large portion of transit ASes,
including all of the biggest ones, does not mean, however, that previous work that
made simplifying assumptions should be considered invalid. Most work on AS
relationship inference [5,11–17] makes only assumption (A4). As we have noted,
our method does not allow us to specify precisely which of a set of assumptions
have been violated, and so we cannot say how often (A4) in particular does not
hold. Furthermore, if (A4) is indeed violated, it might not be to a degree that
would change previous results.
Our results might pose more serious questions for other work. Javed et al. [10]
use the four assumptions to reduce the set of ASes that may be the root cause
for an routing event in the network. If the assumptions are violated, the ﬁnal set
might not contain the root cause AS. Buob et al. [6] aim to solve a problem in
which the assumptions are respected.
6 Conclusion and Future Work
This paper formalized four assumptions about interdomain routing in the In-
ternet that are commonly used in the literature. We employed a data-driven
method to challenge these assumptions, making novel use of so-called “multi-
exit” scenarios to reveal incoherencies between sets of these assumptions and
actual interdomain routing decisions. We observe multi-exits in 21% of transit
ASes in a BGP snapshot from March 2013, and ﬁnd that that in 63% of these
multi-exits at least one assumption is violated. Other snapshots showed similar
results. Given this, we believe that future work should use these assumptions
with caution.
We expect that our technique of using multi-exits to reveal characteristics
of interdomain routing behavior can be further developed. Studying how they
change over time could, for instance, tell us more about how ASes perform traﬃc
engineering. We also believe that much more can be revealed by combining the
BGP data with IP level measurements, which is part of our future work.
Acknowledgments. We thank Martin Levy of Hurricane Electric for taking
the time to impress upon us the weaknesses in assumptions (A2) and (A3). We
also thank the anonymous reviewers and Matthew Luckie for their feedback.
The research leading to these results has received funding from the European
Union’s Seventh Framework Programme (FP7/2007-2013) under grant agree-
ments no. 287581 – OpenLab, and no. 318627 – mPlane.
182
R. Mazloum et al.
References
1. Yan, H., Oliveira, R., Burnett, K., Matthews, D., Zhang, L., Massey, D.: BGPmon:
A real-time, scalable, extensible monitoring system. In: Proc. CATCH (2009)
2. CAIDA: The CAIDA AS Ranking service, http://as-rank.caida.org/
3. CAIDA: The CAIDA AS Relationships dataset,
http://www.caida.org/data/active/as-relationships/
4. Rekhter, Y., Li, T.: A border gateway protocol 4 (BGP-4). RFC 1771, Internet
Engineering Task Force (March 1995)
5. Gao, L.: On inferring autonomous system relationships in the Internet. IEEE/ACM
Trans. Netw. 9(6), 733–745 (2001)
6. Buob, M.O., Meulle, M., Uhlig, S.: Checking for optimal egress points in iBGP
routing. In: Proc. DRCN (2007)
7. Teixeira, R., Shaikh, A., Griﬃn, T., Voelker, G.M.: Network sensitivity to hot-
potato disruptions. In: Proc. SIGCOMM (2004)
8. M¨uhlbauer, W., Feldmann, A., Maennel, O., Roughan, M., Uhlig, S.: Building an
AS-topology model that captures route diversity. In: Proc. SIGCOMM (2006)
9. M¨uhlbauer, W., Uhlig, S., Fu, B., Meulle, M., Maennel, O.: In search for an ap-
propriate granularity to model routing policies. In: Proc. SIGCOMM (2007)
10. Javed, U., Cunha, I., Choﬀnes, D., Katz-Bassett, E., Anderson, T., Krishnamurthy,
A.: PoiRoot: Investigating the root cause of interdomain path changes. In: Proc.
SIGCOMM (2013)
11. Subramanian, L., Agarwal, S., Rexford, J., Katz, R.: Characterizing the Internet
hierarchy from multiple vantage points. In: Proc. Infocom (2002)
12. Di Battista, G., Patrignani, M., Pizzonia, M.: Computing the types of the relation-
ships between autonomous systems. In: Proc. Infocom (2003)
13. Xia, J., Gao, L.: On the evaluation of AS relationship inferences. In: Proc. Globe-
com (2004)
14. Dimitropoulos, X., Krioukov, D., Huﬀaker, B., Claﬀy, K., Riley, G.: Inferring AS
relationships: Dead end or lively beginning? In: Nikoletseas, S.E. (ed.) WEA 2005.
LNCS, vol. 3503, pp. 113–125. Springer, Heidelberg (2005)
15. Dimitropoulos, X., Krioukov, D., Fomenkov, M., Huﬀaker, B., Hyun, Y., Claﬀy, K.,
Riley, G.: AS relationships: inference and validation. ACM SIGCOMM CCR 37(1),
29–40 (2007)
16. Shavitt, Y., Shir, E., Weinsberg, U.: Near-deterministic inference of AS relation-
ships. In: Proc. ConTEL (2009)
17. Luckie, M., Huﬀaker, B., Dhamdhere, A., Giotsas, V., Claﬀy, K.: AS relationships,
customer cones, and validation. In: Proc. IMC (2013)
18. Feamster, N., Balakrishnan, H.: Detecting BGP conﬁguration faults with static
analysis. In: Proc. NSDI (2005)
19. Gill, P., Schapira, M., Goldberg, S.: A survey of interdomain routing policies. ACM
SIGCOMM CCR (to appear, 2014)
20. Giotsas, V., Zhou, S.: Detecting and assessing the hybrid IPv4/IPv6 As relation-
ships. In: Proc. SIGCOMM (2011)
21. Roughan, M., Willinger, W., Maennel, O., Perouli, D., Bush, R.: 10 lessons from
10 years of measuring and modeling the Internet’s Autonomous Systems. IEEE
JSAC 29(9), 1810–1821 (2011)