# 对安全即时通讯软件的流量分析攻击（上）
|
##### 译文声明
本文是翻译文章，文章原作者 Alireza Bahramali, Amir Houmansadr, Ramin Soltani, Dennis
Goeckel, Don Towsley，文章来源：arxiv.org
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
近年来，像Telegram，Signal和WhatsApp这样的即时消息（IM）应用程序变得非常流行。此类即时消息服务一直是被持续监视和审查的目标，因为这些服务是社会和政治敏感主题的公共和私人沟通频道的所在地。为了保护客户，流行的IM服务部署了最先进的加密机制。在本文中表明，尽管使用了高级加密，但流行的IM应用程序会将其客户端的敏感信息泄漏给仅监视其加密IM流量的攻击者，而无需利用IM应用程序的任何软件漏洞。具体而言，设计了流量分析攻击，使攻击者能够以较高的准确性识别管理员以及目标IM频道（例如论坛）的成员。研究表明，此类服务的用户面临着巨大的现实威胁。
## 0x01 Introduction
近年来，像Telegram，Signal和WhatsApp这样的即时消息（IM）应用程序已变得非常流行。最近的研究估计，全世界有超过20亿人在使用移动IM应用程序。
IM服务使用户能够形成私人和公共社交团体，并交换各种类型的消息，包括文本消息，图像，视频和音频文件。特别是，IM应用程序被广泛用于交换具有政治和社会敏感性的内容。结果，政府和公司越来越多地监视通过流行的IM服务进行的通信。
IM服务的一个显着例子是Telegram，在全球拥有2亿用户，其中很大一部分用户来自伊朗和俄罗斯等媒体法规严格的国家/地区。特别是，Telegram在伊朗受欢迎以至于据估计它消耗了伊朗60％以上的互联网带宽。因此，伊朗官员采取了各种措施来监视和阻止Telegram：从请求Telegram在伊朗境内托管其某些服务器以启用监视，到请求Telegram消除有争议的政治和非政治渠道。最终，由于Telegram的不遵守规定，伊朗于2018年4月完全封锁了Telegram。尽管如此，统计数据表明，通过各种VPN连接到Telegram的伊朗用户仅略有减少。俄罗斯Telegram也被封锁，因为电报运营商没有将其加密密钥交给俄罗斯官员进行监视。
**一个基本漏洞：**
流行的IM应用程序（例如Telegram，WhatsApp和Signal）部署加密（端对端或端对端）以保护用户通信。将此类服务称为安全IM（SIM）应用程序。在本文中，演示了尽管使用了高级加密，但流行的IM应用程序仍将有关其客户活动的敏感信息泄漏给监视方。具体而言，证明监视方能够仅使用低成本的流量分析技术就能以很高的准确性识别目标IM通信（例如，政治敏感的IM频道）的成员和管理员。请注意，攻击不是由于安全漏洞或错误的软件实现引起的；尽管很重要，但这种安全漏洞很少，一旦被IM提供商发现，便会立即修复。相反，攻击仅通过监视IM用户的加密IM流量，并假设底层IM软件是完全安全的，即可进行监视。造成攻击的主要因素是，由于混淆对此类服务的可用性和性能造成影响，因此主要IM运营商并未部署任何机制来混淆流量特征（例如，数据包时间和大小）。因此，认为攻击在主要的即时IM服务中显示出一个基本漏洞，并且正如将演示的那样，它们可以对所有主要的IM服务起作用。
贡献：为SIM卡通信设计流量分析攻击算法；攻击的目的是确定目标SIM卡通信的管理员和/或成员。受到攻击的原因是，广泛使用的SIM服务没有采用任何机制来模糊其通信的统计特征。
从建立IM流量特征的统计模型开始，这样的模型对于寻找对SIM服务的有效流量分析攻击至关重要。为了对IM通信建模，加入了1000多个公共Telegram频道并记录了它们的通信，基于此导出了IM流量功能的统计模型。使用SIM模型来得出有关流量分析算法有效性的理论界限；还使用统计模型生成任意数量的综合SIM频道，以增强经验评估的可信度。
基于用于IM通信的统计模型，使用假设检验来系统地设计有效的流量分析攻击算法。具体来说，设计了两种流量分析攻击算法；第一个算法（称为event-based的相关检测器）依赖于为SIM卡通信推导的统计模型，以提供用户与频道的最佳匹配。第二种算法（称为shape-based的算法）将SIM卡流量的形状关联起来，以使用户与目标频道匹配。与基于事件的算法相比，基于形状的算法速度较慢，但提供了更高的准确率检测性能。在实践中，攻击者可以将这两种算法串联起来，以优化计算成本（和可扩展性）与检测性能之间的关系。请注意，正如通过实验证明的那样，统计检测器的性能优于基于IM训练的基于深度学习的检测器。这是因为，深度学习流量分类器仅在统计模型变得不可靠的具有非平稳噪声条件（例如Tor）的网络应用中胜过统计分类器。
对实时和合成SIM卡流量进行了广泛的实验，以评估攻击的性能。证明了算法在公开目标SIM卡通信的参与者方面具有极高的准确性。特别是，证明基于形状的检测器仅需15分钟的Telegram流量就足以识别目标SIM卡频道的管理员，其准确度为94％，误报率为10^(-3)，而攻击者可以减少误报通过观察一个小时的流量将其提升为5×10^(-5)（攻击者可以分层进行此操作，例如，通过监视使用15分钟流量标记的用户以获取更长的流量间隔）。
## 0x02 Secure Instant Messaging (SIM) Applications
将安全IM（SIM）服务定义为满足以下两个属性的即时消息传递服务：
（1）它在其用户通信（端对端或端对端）上部署了强大的加密功能，
（2）它不受攻击者的控制或操作。
虽然攻击也适用于非安全IM应用程序，但攻击者可以使用其他技术来破坏非安全IM服务的隐私。例如，如果即时通讯服务的运营商与监视者全面合作，即时通讯提供商可以让攻击者识别目标用户而无需流量分析机制。同样，无需进行复杂的流量分析攻击就可以轻松窃听具有弱加密的IM服务。下表概述了一些最受欢迎的SIM服务。
###  A. SIM服务如何运作
体系结构：如上表所示，所有主要的IM服务都是集中式的。因此，此类服务中的所有用户通信都是通过IM提供者公司托管的服务器（例如Telegram
Messenger LLP）进行交换的（请注意，一些不受欢迎的服务使用对等服务-对等架构，例如FireChat，Ring和Briar）。每个IM服务都有一个用于身份验证和密钥交换的服务器。数据库服务器存储消息内容和其他用户信息（可能使用客户端密钥加密）。一些IM使用Content
Delivery
Network（CDN）来运行其数据库，以提高服务质量并抵御攻击。现有的IM服务使用各种消息传递协议进行用户通信，包括Signal，Matrix，MTProto
和 Off-the-Record。这些协议的每一个都涉及几个阶段，包括身份验证，密钥交换，消息传输，重新密钥和MAC密钥发布。
流行的IM服务通过使用户流量通过其服务器来中介所有用户通信。这样的集中式体系结构允许IM提供商提供高质量的服务，并解决关键问题，例如与脱机客户端和NAT
/防火墙后面的客户端进行连接。但是，由于IM服务器参与所有用户通信，因此这给用户带来了不同的隐私威胁。某些IM服务会部署端到端加密来减轻这种情况，如下所示。
**安全功能：**
IM服务使用标准的身份验证机制（例如授权密钥和公共密钥证书）来对IM服务器和对等方进行身份验证。而且，他们使用标准技术来确保消息的完整性。所有主要的IM服务都对用户通信进行加密以保护机密性。一些IM提供程序还在用户通信上部署了端到端加密。这样可以防止IM操作员看到通讯内容。但是，他们仍然可以看到通信元数据，例如，谁在与谁聊天，何时与谁聊天。
WhatsApp，Skype，Line以及Telegram和Facebook
Messenger提供端到端加密，而WeChat，Snapchat和BlackBerry Messenger不提供。
此外，包括WhatsApp，Viber，Signal和Facebook
Messenger在内的几家主要的IM提供商通过使用短期会话密钥进行用户通信，为保密提供了完美的方法。请参考Johansen等。
###  B. IM服务的先前安全性研究
**元数据泄漏：** Coull和Dyer[1]率先将流量分析应用于消息传递应用程序。它们演示了流量分析攻击，这些攻击可以推断目标Apple
iMessage用户的各种元数据，特别是操作系统版本，IM操作的类型以及某种程度上的对话语言。最近，Park和Kim[2]对韩国的KakaoTalk
IM服务进行了流量分析，以使用基本的分类算法识别用户的在线活动本文工作与这些工作不同之处在于，探测器的设计依赖于IM通信的理论基础和精细建模。此外，认为攻击能够揭示比以前的工作所识别的更为敏感的IM元数据。演示了针对几种IM服务的攻击的适用性，并设计和评估了量身定制的对策。
**安全漏洞：**
Johansen等调查了SIM卡协议的不同实现，例如Signal，WhatsApp和Threema，并评估了它们的安全性和可用性。他们得出的结论是，所研究的应用程序都不是绝对可靠的。
Unger等[3]对即时通讯协议进行了全面的研究，重点是它们在信任建立，对话安全和传输隐私方面的安全性。此外，Aggarwal等[4]研究了在广泛使用的消息传递应用程序中加密的实现。
此外，已经对消息传递应用程序进行了各种身份枚举攻击。特别是，由于某些IM服务使用SMS文本消息来激活新设备，因此对抗性电话公司可以启动和拦截此类授权码，以识别用户或访问其帐户。
Telegram承诺将通过更新来解决此问题，该更新将允许用户隐藏其电话号码。
Schliep等[5]评估针对信号服务器的信号协议的安全性。它们确定了漏洞，这些漏洞使Signal服务器可以学习附件的内容，重新排序和放置消息以及从群组对话中添加/删除参与者。请注意，他们的研究对象与本文攻击者完全不同，即他们的攻击者是受感染/恶意的信号服务器，而在本文情况下，攻击者是能够窃听加密IM流量的任何第三方。而且，它们的攻击仅针对Signal，而本文攻击则适用于所有主要的IM服务，因为它们依赖于IM服务的基本通信行为。