### 优化后的文本

#### 表格数据
```
0 0 1 1 2 0 1 1 1 1 0 1 1 2 1 0 1 1 1 0 2 1 1 0
Fri. 0 1 0 0 1 1 1 1 1
Sat. 1 0 0 2 0 3 1 2 1
Sun. 1 1 1 0 1 2 2 3 1
成功率 1.00 1.00 0.50 0.57 1.00 1.00 1.00 1.00 0.71
0 1 0 0 0 1 2 1 1
每天成功攻击次数 Tue. Wed. Thu.
```

#### 表七：应用干扰技术复制表四中攻击的结果
| 测试床受害者规则 | 可复制？ | 受害者规则 | 可复制？ |
| --- | --- | --- | --- |
| T1 | T2 | 1 & 2 | 6 & 7 | 10 & 11 | 14 & 15 | 1 & 2 | 5 & 6 | ✓ | ✓ | ✗ | ✓ | ✗ | ✗ |
| 3 & 4 | 8 & 9 | 12 & 13 | 3 & 4 | 8 & 9 | ✗ | ✓ | ✓ | ✓ | ✗ |

**注释**：当用户进入书房（触发规则6）时，会触发延迟事件（触发规则5）。需要注意的是，DAI攻击通常是独立的，除非两个并发攻击需要对同一事件或命令进行不同的延迟。如果攻击失败，不会断开TCP会话，攻击者可以无缝地尝试其他攻击。

简而言之，表六中的结果表明，攻击者有足够机会发起攻击，这引发了严重的安全和隐私问题。

### D. 干扰攻击对比
干扰攻击不需要受害家庭的WiFi密码。因此，我们评估了是否可以使用干扰来构建DAI攻击。研究了两种干扰技术。第一种是WiFi微干扰 [53]，通过高频切换发送干扰信号来轻微延迟无线通信。测试结果显示，引入的延迟（约10毫秒）太短，无法进行有效的攻击。另一种技术 [54] 通过向无线介质中填充随机帧来干扰无线通信。根据该技术，我们使用由开源代码 [55] 支持的Alfa AWUS036NHA无线适配器来干扰WiFi帧。对于表四中列出的每个攻击，我们使用干扰来丢弃（即无限延迟）“事件/命令延迟”列中列出的事件/命令，并观察后果。

表七中的结果显示，干扰可以复制部分攻击（11个中有6个）。这表明干扰作为一种低级攻击方法，可以替代TCP劫持和ARP欺骗，达到某些DAI攻击的效果，这是令人担忧的。这两种攻击方法的区别如下：
1. 基于TCP劫持的方法仅延迟事件/命令而不丢弃它们，而干扰丢弃消息只能构造某些类型的攻击。例如，如果触发事件被丢弃（而不是延迟），订阅规则将不会被触发。
2. 一般的干扰频繁导致TCP超时和断开连接警报。我们在第VI-B节讨论了不丢弃消息或导致断开连接的反应式干扰。

### VI. 讨论
#### A. 针对DAI攻击的对策
首先，智能家居终端用户可以通过使用强WiFi密码并在共享WiFi网络的情况下为IoT设备设置隔离子网来提高攻击者的入侵门槛。此外，IoT设备/中心和WiFi路由器的供应商应增强其产品的安全性。例如，我们发现许多IoT设备和家用路由器并不抵抗ARP欺骗（也在IoT Inspector项目 [50] 中得到验证），尽管存在有效的防御措施。一个可能的原因是TLS在流量劫持攻击下给人一种“足够”的保护错觉，而我们的工作则说明了相反的情况。我们认为消除ARP欺骗攻击还有很长的路要走。

其次，设备供应商和平台提供商可以减少TLS保护的心跳（又称保持活动）消息的时间间隔，并强制执行事件和命令消息的双向存活检查，从而显著减少允许的延迟。然而，这需要IoT供应商修改其协议和设备固件。此外，更频繁的心跳消息会导致更高的开销，这在IoT设计中应慎重考虑。

第三，已知的同步和恢复技术可用于处理分布式系统中的不一致性和无序问题 [56]、[57]、[58]。在IoT中部署这些技术的一个挑战是缺乏一个具有全局视图和控制异构IoT设备及多个专有IoT平台的中央实体，或者一种机制使分布式平台能够协同同步碎片化IoT生态系统中的正确设备观测。

第四，研究人员可以设计检测潜在DAI攻击的方法。最新的研究成果 [6]、[47]、[26]、[5] 提供了从给定智能家居系统中提取部署信息（如设备、规则和平台）的技术。将提取的信息纳入我们的形式模型后，可以使用基于观测等价的技术（见第IV-A节和附录C）来检测是否存在任何一对规则在延迟攻击下不是CRI抗性的。检测结果可以呈现给用户，以便他们重新配置规则。另一种缓解策略是强制执行安全属性/目标，防止设备进入不安全状态 [8]。

#### B. 其他引入延迟的方法
TCP劫持和ARP欺骗并不是引入延迟的唯一方法。更复杂的干扰，如反应式干扰，是另一种有前景的方法。反应式干扰器可以从加密的IEEE 802.11流量 [29] 中识别事件或命令，并以智能方式选择性地干扰事件/命令，尽管它需要特定的硬件；也就是说，通过利用TCP协议的重传机制，干扰器可以阻止目标事件/命令的前N-1次重传，并让第N次重传通过，从而使TCP超时不会因前N-1次重传失败而触发，但会在第N次重传也失败时触发。这样，在传输过程中注入了一个等于从第一次到第N次重传之间的时间差的延迟。与可以从普通WiFi设备发起的ARP欺骗不同，反应式干扰需要具有高灵敏度和计算能力的专用硬件来识别和干扰在传递给接收方之前的目标事件/命令。我们将基于反应式干扰的实现作为未来的工作。

### VII. 相关工作
#### A. IoT中的同步
同步在智能家居IoT系统中至关重要，因为IoT设备、平台和移动应用程序在智能家居中密切交互。Zhou等人 [59] 指出，设备、移动应用程序和云的工作状态转换没有得到适当的保护。通过触发和利用不同步漏洞，攻击者可以远程破坏系统，包括接管设备并用假设备替换它们。本文研究了不同的主题：延迟IoT事件/命令的传输及其利用。OConnor等人 [60] 利用IoT设备遥测的设计缺陷，阻止传感器测量值传递到IoT服务器或命令传递到执行器，导致设备和云之间的同步问题。与基于干扰或丢弃消息的攻击 [60] 不同，我们的工作利用延迟，并且不会在IoT协议栈的任何层引起警报或依赖于实现漏洞。

#### B. IoT安全和隐私
IoT的安全和隐私已在多个方面进行了研究，如平台、应用程序、设备和数据。Fernandes等人 [61] 和Mi等人 [62] 分别揭示了著名IoT平台SmartThings和IFTTT的漏洞。最近的研究 [63]、[38]、[39]、[64]、[65] 密集地研究了IoT应用程序级别的安全。关于IoT设备，提出了增强认证 [66]、[67] 和访问控制 [68]、[69] 的解决方案。研究人员还采用了数据驱动技术来检测设备异常 [70]、[71]、[72]。Fu等人 [72] 设计了HAWatcher，利用丰富的语义信息挖掘智能家居环境中的相关性，实现了高度准确且可解释的异常检测。多种方法 [73]、[51]、[74]、[75] 被设计用来保护隐私敏感的IoT数据。Chi等人 [51] 提出了PFirewall，通过实施数据最小化策略显著减少IoT数据的披露，保护用户隐私，而无需更改IoT设备或平台。尽管有大量的研究，但在多平台系统中独特的威胁研究较少。Yuan等人 [76] 报告了跨多个IoT云的IoT设备访问委托中的漏洞。我们是第一个研究多平台系统中独特延迟衍生安全威胁的人。

#### C. 规则间干扰问题
规则间干扰（CRI）问题引起了IoT安全研究人员的广泛关注。许多工作致力于分类 [5]、[9]、理解 [40] 和检测 [5]、[6]、[7]、[9]、[77]、[8]、[10] CRI问题。我们的前期工作 [4]、[5] 是最早全面分类和形式化描述CRI威胁的研究。在这些工作中，CRI问题是由于用户错误配置了自己的智能家居自动化规则造成的。然而，所有这些工作都只考虑了单平台系统中的CRI，隐含假设设备状态的一致性和有序观测。虽然IoTGuard [8] 和IoTIE [11] 在两个平台SmartThings和IFTTT上配置规则进行评估，但它们在分析CRI问题时并没有考虑多平台或其独特特征。此外，这两项工作都将IFTTT规则转换为等效的SmartThings应用程序，并使用SmartThings运行所有规则；本质上，它们仍然做出了相同的假设。我们的工作是首次在更复杂但现实的系统模型中研究CRI问题，其中存在多个事件/命令传输路径和/或多平台共存。我们的工作也是首次将延迟因素引入CRI问题的研究，并揭示和展示了现有CRI检测解决方案所忽略的一系列新攻击。

### VIII. 负责任的披露
我们已向IoT供应商报告了事件/命令延迟攻击及其可能的利用：Google、SimpliSafe、Apple (HomeKit)、Ring和SmartThings。Google、SimpliSafe和Ring承认了这个问题。Google和SimpliSafe表示将与产品团队一起进行漏洞修复程序。Ring表示他们已经计划了一种减轻侧信道攻击难度的缓解措施。Apple认为报告的攻击是“预期行为并按设计工作”，尽管Apple的HomeKit允许最长的延迟窗口（数十分钟甚至更长）。

### IX. 结论
我们研究了单平台多路径和多平台智能家居系统中由于不一致性和无序问题引起的独特跨规则干扰（CRI）问题。我们揭示了选择性消息延迟攻击对智能家居自动化的严重影响，导致了现有检测器无法检测的各种CRI问题。我们揭示了七类此类攻击，称为基于延迟的自动化干扰（DAI）攻击，并使用两个智能家居进行了分析和演示。评估结果显示，所有七类DAI攻击都可以发起，并且攻击者可以在当前IoT协议栈的任何层不引起警报的情况下以高成功率进行DAI攻击。

### 致谢
本研究得到了美国国家科学基金会（NSF）的部分支持，资助编号为CNS-1828363、CNS-2204785、CNS-2205868、CNS-1856380、CNS-2016415和CNS-2107093。

### 参考文献
[1] “Apple HomeKit,” https://www.apple.com/ios/home/, 2020.
[2] “SmartThings,” https://www.smartthings.com/, 2020.
[3] “Amazon Alexa,” https://developer.amazon.com/en-US/alexa/devices/smart-home-devices, 2020.
[4] H. Chi, Q. Zeng, X. Du, and J. Yu, “Cross-app interference threats in smart homes: Categorization, detection and handling,” arXiv preprint arXiv:1808.02125, 2018.
[5] ——, “Cross-app interference threats in smart homes: Categorization, detection and handling,” in 50th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN), 2020.
[6] Z. B. Celik, P. McDaniel, and G. Tan, “Soteria: Automated iot safety and security analysis,” in Usenix Security Symposium, 2018.
[7] D. T. Nguyen, C. Song, Z. Qian, S. V. Krishnamurthy, E. J. Colbert,