title:blackhat:us-20 A Decade After Stuxnet&#39;s Printer Vulnerability: Printing is Still the Stairway to Heaven
In 2010, Stuxnet, the most powerful malware in the world revealed itself, causing physical damage to Iranian nuclear enrichment centrifuges. In order to reach Iran's centrifuges, it exploited a vulnerability in the Windows Print Spooler service to gain code execution as NT AUTHORITY\SYSTEM. Due to the hype around this critical vulnerability, we (and probably everyone else) were pretty sure that this attack surface would no longer exist a decade later. We were wrongâ€¦The first clue was that two out of three vulnerabilities which were involved in Stuxnet were not fully patched. That was the case also for the 3rd vulnerability used in Stuxnet, which we were able to exploit again in a different manner. It appears that Microsoft has barely changed the code of the Windows Print Spooler mechanism over the last 20 years. We started to investigate the Print Spooler mechanism in the latest Windows 10 Insider build and discovered two 0-day vulnerabilities providing LPE as SYSTEM and Denial-of-Service. The first one can also be used as a new, unknown persistence technique.In this presentation, we will present:Past Stuxnet's vulnerabilities and how they were partially patched (even multiple times)The analysis of the 3rd Stuxnet vulnerability in the Windows Print Spooler, which was considered fully patched until nowA live demo of two 0-day vulnerabilities we discovered in the Windows Print Spooler. One of them works on all the Windows releases from 2000 to Windows 10 (32 and 64-bit); the other works on all the Windows releases from Windows 7 to Windows 10 (32 and 64-bit)Our research process, our methodology and home-brewed toolsA more robust way to mitigate future exploitation of similar vulnerabilitiesSeveral open-source tools for testing the system against the attack, mitigating it and helping other researchers to challenge this mechanism as well.