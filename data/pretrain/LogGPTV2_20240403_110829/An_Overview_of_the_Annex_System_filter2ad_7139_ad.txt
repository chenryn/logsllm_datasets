### 4.4 Badge

The Badge is a complementary device to the Button, designed as a wearable display that provides secure display and video capture capabilities for the Annex Ensemble. We have developed a prototype of the Badge using an embedded Linux computer, an FPGA, a touch-sensitive LCD, forward and backward-facing cameras, video compression hardware, and a Bluetooth radio. 

Similar to the Button, the FPGA on the Badge encrypts and decrypts Bluetooth communications. However, it also provides digital signature and verification functionalities. This enables the Badge to serve as a Multi-Level Security (MLS) data display, suitable for displaying classified imagery or video streams, or as a trusted Graphical User Interface (GUI) for certain MiniSec applications.

Additionally, the Badge functions as a context-aware identity badge. It adjusts its display based on the environment, using securely transmitted signals from nearby Bricks (see Section 4.6). For example, outside a defense installation, the display may become inactive, while inside a high-security facility, it will show the full credentials of its holder. The Badge can also assist in verifying the credentials of unknown parties. A security guard, for instance, could use their Badge to display a visitor's identity photo, sourced from their Codestick or a trusted database, thereby protecting against the use of forged, stolen, or tampered devices.

### 4.5 Codestick

The Codestick is a high-assurance credential exchange device designed to alleviate the burden on Defense personnel of remembering multiple passwords, carrying multiple security tokens, or forwarding security clearance details before meetings. The Codestick is a tamper-proof device that can only be activated via biometric authentication, which we anticipate will help it achieve very high levels of security accreditation.

Two individuals with personalized Codesticks can directly exchange personal security credentials without involving a third party. Secure cryptographic protocols, directed communication mechanisms, and a trusted high-assurance design ensure that these exchanges are truly peer-to-peer, providing integrity and confidentiality for all data involved. This represents a significant improvement over the current Defense credential exchange system, where each party must have their security officer manually exchange clearance information with the other party's security officer—a process that is cumbersome, slow, and prone to errors.

The Codestick also offers single sign-on functionality, allowing its owner to automatically log into Enterprise networks and any number of web-based systems. It also provides digital signature, encryption, decryption, and signature verification capabilities to protect the owner's email.

Many functions of the Codestick have reached stable operation, and a user trial of the device is currently being prepared. More information about the Codestick can be found in patent number WO 2004/109973 [4].

### 4.6 Bricks

Although not strictly part of the Annex Ensemble (i.e., the devices carried by individuals), Bricks are essential components of the Annex system. Bricks are infrastructure devices that form the backbone of the Annex network or provide other Annex-enabled services. Similar to how our MiniSec is comprised of a COTS iPAQ augmented with an SMC card, we have developed several prototype Bricks by adding an SMC card to existing server or network hardware. Coupling these SMCs with appropriate trusted object implementations allows us to bring these platforms under the control of the Annex capability framework, providing numerous authorization and security benefits.

The first Brick modules we implemented provide gateways between our secure Voice over IP (VoIP) system and the Public Switched Telephone Network (PSTN) and GSM phone networks. Calls from MiniSec devices to a public telephone system transit the secure VoIP network to a gateway point, which then establishes a new, normal telephone call between the gateway device and the destination telephone, acting as an intermediary for audio data. We used OpenH323 [21] to implement the PSTN side of our gateway device. Outgoing calls can be made using a fixed-line telephony card, or, through an extension to OpenH323 that we developed, via a mobile telephone supporting the Bluetooth Hands Free profile [6]. Incoming calls from either the PSTN or a Bluetooth-enabled mobile phone are supported by the same processes in reverse.

We have also created experimental IPv6 routers and wireless access points whose operational parameters can be controlled by trusted objects running under an Annex Capability Kernel. This was achieved by connecting a serial line from a trusted "router control" object on a MiniSec device to the serial console (i.e., configuration) port on a Cisco router. The control object implements a state machine that models the router’s command line interface, abstracting away the configuration terminal’s stateful behavior and exposing a simple yet powerful interface for accessing the extensive range of configuration options available via the router’s executive. We used this to implement a proof-of-concept Multi Level Secure (MLS) network admission policy, ensuring that only appropriately classified MiniSec devices could use a particular network.

### 5 The Annex Testbed

The Annex testbed is a reference implementation of all the Annex elements described in this paper. It includes several dozen complete ensembles, though most elements are still early prototypes. The Annex IPv6 network, distributed by a wide-area ATM network connecting DSTO sites almost 1,000 km apart, consists of several Cisco routers and 802.11b access points employing 802.11i link-layer security. Recently, we have also linked this network to the IPv6 Internet. Our MiniSecs use a modified Mobile IPv6 for Linux (MIPL) implementation, allowing users to seamlessly roam with their ensembles throughout the entire network. This provides an ideal platform for experimentation with the Annex framework and novel security and mobility applications.

We began conducting both on-site and off-site demonstrations (via the IPv6 Internet) of our secure mobile telephony application using the Annex testbed in August 2005. This environment allows users to make any number of concurrent point-to-point calls, conference calls, and calls to external telephone numbers via the PSTN or GSM mobile phones, all under the secure control of the Annex capability system. This not only provides a robust platform for further experimentation and implementation but also demonstrates the viability of the overall Annex concept and the technologies that underpin it.

### 6 Conclusion and Further Work

This paper summarizes the security and network architecture that underpins a family of DSTO-developed technologies and devices collectively known as the Annex System. The centerpiece of all our devices is the Annex Security Architecture, explained in Section 2, which is a trusted platform for distributed object-capability-based software. This approach is inherently more secure and amenable to formal analysis than programs developed using current software engineering practices. Additionally, Section 3 describes how the distributed aspect of our security architecture is based on next-generation networking technologies such as IPv6 and 802.11i wireless networking, with a few important extensions to improve security, robustness, and mobility in a military context.

While some researchers have been separately investigating similar security and network architectures, we are not aware of any other projects that have made significant progress—or even attempts—to combine these types of technology. Furthermore, because both concepts must be used in tandem to truly advance the state of the art in secure mobile devices, very few of these projects have gone beyond simple proof-of-concept examples.

In contrast, our contribution has been to not only combine advances in high-assurance software and mobile devices but also to demonstrate complex real-world applications based on the fusion of these ideas.

In Section 4, we introduced our reference implementation of the Annex security and network architecture, a Multi-Level Secure ensemble of devices including: the MiniSec, a wide-area communications hub with an example MLS voice application; the Button, a small, secure Bluetooth-based speakerphone; the Badge, a secure, wearable, context-sensitive display; the Codestick, a high-assurance credential exchange device; and Bricks, a range of commodity network infrastructure devices retrofitted for subservience to an auxiliary, trusted Annex security device.

We have been performing demonstrations and conducting scientific trials of our ensemble of Annex devices since late 2005. Since then, we have also been working on a second generation of Annex devices, including a more refined version of the Codestick and a substantially improved MiniSec. Our "MiniSec2" device, which we hope to publish more details on soon, supports Multi-Level Secure operation for any unmodified, off-the-shelf applications, including document editing and viewing, email, web browsing, voice, and video communications, and more.