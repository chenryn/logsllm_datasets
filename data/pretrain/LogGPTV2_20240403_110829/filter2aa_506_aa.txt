DISCLAIMER
• This publication contains references to the products of SAP AG. SAP, R/3, SAP NetWeaver and other 
SAP products.
• Products and services mentioned herein are trademarks or registered trademarks of SAP AG in 
Germany, in the US and in several other countries all over the world.
• SAP AG is neither the author nor the publisher of this publication and is not responsible for its content. 
The SAP Group shall not be liable for errors or omissions with respect to the materials.
Vicxer, Inc. Is a registered Trademark. All rights reserved. Reproduction of this presentation without 
author’s consent is forbidden.
JOR DAN SANTARSIERI
VICXER’S FOUNDER
Originally devoted to Penetration Testing, Vulnerability Research & Exploit 
writing, discovered several vulnerabilities in Oracle, SAP, IBM and many others.
Speaker and trainer at Black-Hat, OWASP-US, Hacker Halted, YSTS, 
Insomni’hack, AusCERT, Sec-T, RootCon, Ekoparty, etc.                                                           
I started researching ERP Software back in 2008.
Had the honor to secure more than 1000 SAP implementations all around the 
globe, including Fortune-500 companies, military institutions and the biggest 
ONG on the planet.
@ J S A N T A R S I E R I
CHAPTER 02
Project ARSAP is Born
CHAPTER 04
Ransomware and the Weaponization of 
Weaknesses
CHAPTER 01
Brief Introduction to SAP
CHAPTER 03
A Traditional Approach to Malware Distribution
INTRODUCTION
CHAPTER 01
A Brief Introduction to SAP
WHAT IS SAP?
• SAP stands for Systems Applications and Products in Data Processing. It is a German company founded in 
1972 by ex-IBM employees.  
• SAP counts 88,500+ Employees Worldwide
• SAP Has 378,000+ Customers
• Is Present in More Than 180 Countries
• Dominate the Market With 87% of Forbes Global 2000
•
SAP ERP (Enterprise Resource Planning)
•
SAP BI (Business Intelligence)
•
SAP CRM (Customer Relationship 
Management)
•
SAP SRM (Supplier Relationship Management)
TWO TYPES OF SAP SOLUTIONS
ENTERPRISE SOLUTIONS
SUPPORTING SOLUTIONS
•
SAP GRC (Government Risk and Compliance)
•
SAP Business Objects
•
SAP Mobile
•
SAP Cloud Connectors
These Solutions, provide direct 
services to end users
These Solutions support the 
operations of the Enterprise 
Solutions
SAP NETWEAVER
• Netweaver is the framework where SAP is built in. It is the most important technology so far as it 
synchronizes and regulates the operatory of the different SAP components
• Netweaver is service oriented! and it is divided in two different stacks, ABAP & J2EE.
Database
Operating System
SAP Business Logic
SAP Application Layer
SAP Netweaver System
SAP Solution
Base Infrastructure
SAP NETWEAVER
• Each stack counts with different services, some of them are shared between stacks, some others are not
• Each one of those services will have its own protocol for communications. Some of them are open, but 
most of them are proprietary
SAP USER CLIENTS
• There are MANY ways that a regular user could use to connect to the SAP systems. The most popular 
ones are:
• SAP GUI (SAP proprietary protocol, extra thick client, around 1.4Gb of size)
• SAP Web Application Servers (ICM, Java HTTP, XSA)
IN A FEW WORDS …
• Why would someone attack your SAP implementation? Easy….
CHAPTER 02
A NEW BEGINNING
“Project ARSAP is Born”
ABOUT US
WE ARE VICXER!
•
A company focused in securing the business critical 
applications and its adjacent infrastructure (SAP, Oracle 
Siebel and others)
•
All of our customers belong to the Fortune-500 Group
•
We do:
Oracle & SAP Penetration Testing
Cyber-Security Trainings
Vulnerability Assessment and Management
SAP Forensics & Many More!
PROJECT ARSAP
“Sometimes, reinventing the wheel makes sense” - Scenario
• As a young company, we had the same challenges that everyone else has when they just start, getting 
new leads that could end-up in new customers
• The approach that most companies take here, is to simply buy a list of businesses that are already 
running SAP, so they can try to “cold call” the CISO / security managers and pitch what they do
• The success rate of this procedure is 1%, same success rate that the spammers get. Coincidence? I think 
not!
• We said to ourselves, this cannot be the best possible way! there must be a more efficient way to tackle 
this challenge
……. and then the project ARSAP was born!
PROJECT ARSAP
“Sometimes, reinventing the wheel makes sense” - Scenario
• We used search engines like Shodan, Google, Bing, ZoomEye to more “sketchy” and esoteric deep-web 
resources (deep-web search engines, private forums, etc.) in order to find the different SAP systems 
(ABAP, Java, Business Objects, HANA) that were already exposed to the Internet
• We ended-up creating one “extractor” per each data-source, as we knew since the very beginning that 
the SAP map that we would obtain would be “alive”, meaning that the discovered SAP systems could 
come and go every-day (yes, people tend to expose non-productive SAP systems to the Internet too!)
• Once we had a list of servers, we also had the necessity of categorizing and tagging the detected SAP 
systems for further analysis. Fortunately for us, the exposed SAP services were QUITE verbose!
PROJECT ARSAP
“Sometimes, reinventing the wheel makes sense” - Scenario
• At this point, we did not only have the list of exposed SAP systems, but we were also able to classify 
them per the exposed SAP services, country & continent (of the server hosting the SAP system), SSL 
support and the different SAP / services version!
• We used different techniques to discover what companies / individuals were behind the discovered 
assets.
• Now, of course, we needed a way to prioritize our efforts on which potential clients we would contact 
first, so what we did offline, was to analyze the detected SAP services versions and compare them to 
our own vulnerability database. This exercise allowed us to also classify the SAPs per “potential” risk (as 
we did not actually trigger any attack probes)
Are you intrigued about the results?
PROJECT ARSAP
“ARSAP By the Numbers”
• We found more than 14k
SAP Services
PROJECT ARSAP
“ARSAP By the Numbers”
• We have identified the owners of 
37.86% of the detected assets
PROJECT ARSAP
“ARSAP By the Numbers”
• We also discovered that at least 27% of the detected assets were potentially vulnerable to critical and 
high criticity vulnerabilities like RCE, Directory Transversal, Arbitrary File uploads / Arbitrary File Reads 
• We ended up being highly surprised by our discoveries and we immediately started to think that a 
sufficiently skilled attacker could provoke the “next SAP tragedy” without much effort
• How? you say, well, keep watching …
YOU GOT EMAIL!
CHAPTER 03
“A traditional approach to malware distribution”
“A traditional approach to Malware distribution” – Thinking Like an Attacker
• Think about it, if you were an attacker who has recollected the information that we highlighted on the 
previous slides, it would be trivial for you to enumerate email addresses from the people that works at 
the target company
• You know that the target organization uses SAP, probably across the board
• You know that the target organization has enough resources to acquire and use an SAP system. This 
indicates that the level of resources belonging to the company are high and the head-count is significant
• Almost all the big companies, with good amount of resources and a lot of employees use SSO (Single 
Sign-on) to facilitate access to SAP
YOU GOT EMAIL!
“SAP Gui Scripts”
• In SAP Words
• By default, the execution of SAP GUI scripts is disabled, but in our experience, 90% of corporate users 
use this functionality to do performance and functional testing
YOU GOT EMAIL!
“SAP GUI Scripting is an automation interface that enhances the capabilities of SAP GUI. By using this interface, 
end users may automate repetitive tasks by running macro-like scripts”
“SAP Gui Scripts”
• The attacker has already harvested some corporate email accounts and is ready to send some malware
• The distribution channel will be an email with a malicious SAP GUI Script attached to it
• The attacker will leverage the privileges of the victim and use them to completely delete a table 
containing public debt, Robin Hood Style!
YOU GOT EMAIL!
WEAPONIZATION
“You Got Email!” - Scenario
USER’S 
VLAN
SERVER’S 
VLAN