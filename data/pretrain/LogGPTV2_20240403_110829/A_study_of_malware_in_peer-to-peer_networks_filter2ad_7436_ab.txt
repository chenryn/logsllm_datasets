361
206
51
149
24
114
1
12
107
50
11
3
47
Table 3: Summary of top malware found in OpenFT.
Many of the malware observed in OpenFT are also observed in
Limewire, including 8 of the top 10 (all except Trojan.Downlo-
ader.Delf-286 and RAR). Of the top 10 in Limewire, 8 are also
seen in OpenFT (all except Worm.VB-26 and Worm.P2P.Sel-
mo.A). In fact, 5 of the top 10 malware shown in Tables 2 and 3 are
common, implying the co-existence of the same pieces of malware
across different systems.
Although we downloaded ﬁles from a large list of extensions, we
actually found only zip and exe ﬁles to be infected in large amounts.
We also found a very small number of rar and doc ﬁles that were
infected. The rest of the ﬁle formats did not contain any malware.
3.2 Malware Functionality
We ﬁnd a large variety of malware in the ﬁles we downloaded
for Limewire and OpenFT, with downloaders and worms being the
most popular types of malware. Table 4 shows the functionality
of different malware we found (the categorizations are done per
information available at [1, 14, 15, 17]). Some malware embed
more than one functionality, hence the percentages in Table 4 ex-
ceed 100%.
Function
Downloader
Worm
Unknown
Backdoor
Adware
Dialer
Keylogger
Limewire OpenFT
34.78%
39.13%
30.43%
17.39%
8.70%
4.35%
0.0%
45.16%
40.32%
30.65%
25.81%
4.84%
4.84%
3.23%
Table 4: Functionality and percentage of malware in Limewire
and OpenFT. The percentages do not add up to 100% due to
malware programs with more than one function.
3.3 Malware Growth
Figure 1 shows the percentage of qualifying trafﬁc we see each
day on the two networks that is malicious. Since we can only iden-
tify malicious ﬁles from those we downloaded successfully, this
ﬁgure shows a lower bound on the extent of malware. A large per-
centage of Limewire responses are infested with malware. On the
other hand, malware on OpenFT spikes only on one day, the day
Poom.A worm hits.
s
e
s
n
o
p
s
e
R
s
u
o
i
c
i
l
a
M
%
Limewire
OpenFT
60.0%
50.0%
40.0%
30.0%
20.0%
10.0%
0.0%
4/9/06
4/16/06
4/23/06
4/30/06
Date
Figure 1: The percentage of qualifying responses per day on
Limewire and OpenFT that were classiﬁed as malware. The
spike in OpenFT corresponds to the Poom.A worm, which is
shown in Figure 3.
Next, we investigate if the growth pattern of speciﬁc malware
change over time. In general, we ﬁnd that most malware follow
similar growth trends during the span of our data. An example
of this is depicted in Figure 2, which shows the prevalence of Al-
can.D worm in Limewire. An exception to this growth trend is
the Poom.A worm, which shows distinct spikes in the number of
responses seen on different days in both OpenFT and Limewire.
Figure 3 shows the prevalence of Poom.A over time in Limewire
and OpenFT.
3.4 Effect of Re-downloads in Limewire
As mentioned in Section 2.3, we re-download “clean” ﬁles in
Limewire after 7 days from when we ﬁrst saw the ﬁle to ensure
that we detect new malware which ClamAV [16] may not have had
signatures created for when we ﬁrst saw the ﬁles. We found 3 new
malware in the 30 unique ﬁles that we re-downloaded. These are
Worm.VB-26, Trojan.Clicker.VB-20, and W32.Poli-
pos.A. This brings up the total count of distinct malware found
in Limewire to 95.
3.5 Queries
We now analyze if certain queries fetch more malware than oth-
ers. Tables 5 and 6 show the top 10 queries in Limewire and
OpenFT respectively that fetch the most malware. It appears that
while names of movies return the most malware in Limewire, such
is not the case for OpenFT.
3.6 Host Characteristics
Table 7 depicts the top 10 IP addresses that serve the most mal-
ware in Limewire. Table 8 does the same for OpenFT. We see very
different host characteristics across the two systems. In Limewire,
a surprisingly high amount of malware is served from private IP
addresses3 while we do not see any private address in OpenFT. In
Limewire, most of the top sources are serving more than one dis-
tinct malware. This is not the case in OpenFT. Also, all of the top
3Notice that this does not mean that the private IP addresses we
mention are routable - we typically ended up downloading the ﬁle
served by a host with a private IP address from another peer with a
routable address.
5/7/06
5/14/06
Figure 2: Distribution of Alcan.D as percent of responses ob-
served over a period of 5 weeks on Limewire. Most malware
follow a similar distribution.
.
l
D
n
a
c
A
h
t
i
w
s
e
s
n
o
p
s
e
R
%
10.0%
8.0%
6.0%
4.0%
2.0%
0.0%
4/9/06
4/16/06
4/23/06
4/30/06
Date
5/7/06
5/14/06
.
A
m
o
o
P
h
t
i
w
s
e
s
n
o
p
s
e
R
%
25.0%
20.0%
15.0%
10.0%
5.0%
0.0%
Limewire
OpenFT
4/9/06
4/16/06
4/23/06
4/30/06
Date
5/7/06
5/14/06
Figure 3: Number of responses infected each day from the
Poom.A worm. We see a sudden increase in the number of in-
fections on both Limewire and OpenFT, though on different
days.
Query
scary movie 4
ice age 2
2006
lost
silent hill
ice age
sex
prison break
hostel
nero
Files Responses
19003
17020
12008
10550
10117
9388
7600
6704
5571
5406
64
145
1706
237
65
145
248
78
41
180
Table 5: Top 10 malware returning queries in Limewire.
Query
crack
adobe
sims
limewire
games
windows xp
macromedia
dreamweaver
zip
the sims
Files Responses
872
422
407
280
230
222
188
165
164
155
94
16
14
94
13
7
7
3
80
14
Table 6: Top 10 malware returning queries in OpenFT.
IP
Infected
Files
Clean
Files Respon-
Infected Mal- Clean
Respon- ware
ware
ses
192.168.1.11
65.34.187.196
192.168.1.100
192.168.1.2
192.168.1.101
192.168.1.47
192.168.1.3
192.168.0.10
85.167.159.53
3982
4782
7593
5624
4736
1593
4710
3471
3248
72418
18257
14664
9393
9219
7851
7418
6421
5823
4
2
10
12
8
2
9
2
1