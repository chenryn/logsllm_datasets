| _moreInfo |                                                          |
| .png](med |                                                          |
| ia/image8 |                                                          |
| 1.png){wi |                                                          |
| dth="0.12 |                                                          |
| 708333333 |                                                          |
| 333333in" |                                                          |
| heig      |                                                          |
| ht="0.127 |                                                          |
| 083333333 |                                                          |
| 33333in"} |                                                          |
+-----------+----------------------------------------------------------+
| Data      | 字段数据的区域设置。                                     |
| Locale    |                                                          |
|           | 可以确定处理器如                                         |
|           | 何格式化转换的数据，例如使用逗号或句点作为十进制分隔符。 |
|           |                                                          |
|           | 适用于受区域设置影响的类型。                             |
+-----------+----------------------------------------------------------+
| Treat     | 将长字段转换为字符串数据类型时，将输入字段视为日期时间。 |
| Input     |                                                          |
| Field as  | 选择将长字段中                                           |
| Date      | 的时间戳（如epoch或unix时间）转换为字符串（如"2017-02-01 |
|           | 12:00:00"）的时间。处理器首先将                          |
|           | 长值转换为日期时间，然后使用指定的日期格式转换为字符串。 |
|           |                                                          |
|           | 清除后，                                                 |
|           | 处理器将长值（如1485979200）转换为字符串值"1485979200"。 |
+-----------+----------------------------------------------------------+
| Scale ![h | 转换为十进制数据类型时要使用的小数位数。                 |
| ttps://st |                                                          |
| reamsets. | 输入零或正数以指示小数点右侧的位数。如果输入一个负数     |
| com/docum | ，处理器会将该数字的未标度值乘以10，得到刻度的负数的幂。 |
| entation/ |                                                          |
| datacolle | 有关指定比例的详细信息，请参阅https://docs.              |
| ctor/late | oracle.com/javase/8/docs/api/java/math/bigdecimal.html。 |
| st/help/d |                                                          |
| atacollec |                                                          |
| tor/UserG |                                                          |
| uide/Grap |                                                          |
| hics/icon |                                                          |
| _moreInfo |                                                          |
| .png](med |                                                          |
| ia/image8 |                                                          |
| 1.png){wi |                                                          |
| dth="0.12 |                                                          |
| 708333333 |                                                          |
| 333333in" |                                                          |
| heig      |                                                          |
| ht="0.127 |                                                          |
| 083333333 |                                                          |
| 33333in"} |                                                          |
+-----------+----------------------------------------------------------+
| Rounding  | 小数位数转换过程中使用的舍入策略。                       |
| Strategy  |                                                          |
|           | 有关每个舍入策略的描述，请参阅https://docs.              |
|           | oracle.com/javase/8/docs/api/java/math/bigdecimal.html。 |
+-----------+----------------------------------------------------------+
| Date      | 要转换的日期、日期时间或时间数据的格式。用于将不         |
| Format    | 带时区或UTC偏移量详细信息的日期时间数据转换为日期、日期  |
|           | 时间或时间。或者将日期、日期时间或时间数据转换为字符串。 |
|           |                                                          |
|           | 选择要使用的格式或创建自定义格式。要使用时区或偏         |
|           | 移量信息转换日期时间数据，请使用ZonedDateTime格式属性。  |
|           |                                                          |
|           | 注意：数据预览使用浏览器区域                             |
|           | 设置的默认格式显示日期、日期时间和时间数据。例如，如果浏 |
|           | 览器使用en-us区域设置，则预览将使用以下格式显示日期：mmm |
|           | d，y h:mm:ss a。                                         |
+-----------+----------------------------------------------------------+
| Other     | 用于输入自定义日期格式。                                 |
| Date      |                                                          |
| Format    | 有关创建自定义日期格式的详细信息，请参阅Oracle           |
|           | Java文档。                                               |
+-----------+----------------------------------------------------------+
| Zoned     | 要转换的日期、日期时间或时                               |
| Datetime  | 间数据的格式。用于将具有时区或偏移量信息的日期时间数据转 |
| Format    | 换为区域日期时间格式，或将区域日期时间数据转换为字符串。 |
|           |                                                          |
|           | 选择以下选项之一：                                       |
|           |                                                          |
|           | •yyyy-mm-dd\'t\'hh:mm:ssx-用于带UTC偏移量的日期时间值。  |
|           |                                                          |
|           | •yyyy-mm-dd\'t\'hh:mm:ssx                                |
|           | \[vv\]-用于具有UTC偏移量和时区的日期时间值。如果日期时间 |
|           | 值不包括UTC偏移量，则阶段将使用指定时间戳的最小偏移量。  |
|           |                                                          |
|           | •其他-用于输入不同的区域日期时间格式。                   |
|           |                                                          |
|           | 要转换                                                   |
|           | 没有时区或偏移量信息的日期时间数据，请使用日期格式属性。 |
+-----------+----------------------------------------------------------+
| Other     | 用于输入自定义的区域日期时间格式。                       |
| Zoned     |                                                          |
| Datetime  | 有关创建自定义分区日期时间格式的详细信息，请参阅Oracle   |
| Format    | Java文档。                                               |
+-----------+----------------------------------------------------------+
| Charset   | 要转换的数据的字符编码。                                 |
|           |                                                          |
|           | 适用于受编码影响的类型。                                 |
+-----------+----------------------------------------------------------+
3、要配置其他类型转换，请单击添加图标，然后重复上一步。您可以使用简单或批量编辑模式来配置其他转换。
#### Field Zip/字段合并
Field Zip处理器将来自两个字段的列表数据合并到一个字段中。可以使用Field
Zip处理器合并两个List字段或List-Map字段，或使用处理器合并相关的数据列表。
Field
Zip处理器将列表数据与相应的列表合并。如果任一列表包含的项目多于另一个列表，则不会合并额外的列表项目。处理器保留原始列表字段，因此不会丢失任何数据。
配置Field
Zip处理器时，指定要合并的两个字段及用于写入合并数据的字段。默认情况下，处理器合并列表中的字段名称和值。您可以将处理器配置为仅合并值。
如果记录中的一个或两个字段与要合并的指定字段不匹配，则可以将Field
Zip处理器配置为按原样传递记录而不合并任何字段，或将记录传递给管道以进行错误处理。
##### 合并列表数据
在列表字段中合并数据时，Field
Zip处理器将列表中的每个项目与另一个列表中的相应项目合并。处理器使用列表的顺序合并列表，并返回Map字段列表。
列表中没有其他列表中匹配项的任何项目都不会合并。
例如，假设您有一个包含两个List字段的记录：
+--------------------------+----------------------+--------------------+
| **order**                | **itemID**           | **cost**           |
+==========================+======================+====================+
| 23523482                 | 2                    | 89.95              |
|                          |                      |                    |
|                          | 113                  | 8.95               |
|                          |                      |                    |
|                          | 954                  | 6.95               |
|                          |                      |                    |
|                          | 6502                 |                    |
+--------------------------+----------------------+--------------------+
假设您配置Field
Zip处理器以合并ItemID和Cost字段并将数据写入Purchase字段。 Field
Zip处理器然后生成以下记录：
![https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Graphics/FieldZip-RecordMap.png](media/image82.png){width="2.3309853455818024in"
height="3.4691786964129485in"}
在"Purchase"字段中，合并的数据是"Map"字段的列表。
每个映射都具有ItemID列表中的字段名称和值，并与"Cost"列表中的相应字段名称和值合并。
请注意，第四个ItemID / ItemID /
3未包含在合并列表中，因为它没有相应的成本信息。
如果将Field
Zip处理器配置为仅合并值，则处理器将返回相同的数据而不包含原始字段名称，如下所示：
![https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Graphics/FieldZip-Record-NoNames.png](media/image83.png){width="2.7530872703412075in"
height="4.543233814523185in"}
##### 透视合并列表
根据您的使用情况，您可能希望在将列表数据与Field Zip处理器合并后，将Field
Pivoter处理器添加到管道中。
Field Pivoter可以透视合并的列表数据，并为列表中的每个第一级项创建记录。
例如，假设您使用Field
Pivoter处理上面第一个List示例中生成的数据，并在合并列表中包含字段名称。
您配置Field Pivoter以将透视数据写入名为Purchased_Item的新字段。
单个记录的轴心导致合并列表中的以下三个记录：
![](media/image84.png){width="5.775324803149607in"
height="3.749692694663167in"}
##### 配置字段压缩处理器
使用字段压缩处理器合并记录中的两个对应列表字段。
1、在"属性"面板的"常规"选项卡上，配置以下属性：
+---------------+------------------------------------------------------+
| **常规属性**  | **说明**                                             |
+===============+======================================================+
| 姓名          | 阶段名称                                             |
+---------------+------------------------------------------------------+
| 说明          | 可选说明                                             |
+---------------+------------------------------------------------------+
| [Required     | 必须包含要传递到阶段的记录的数据的字段。             |
| Fie           |                                                      |
| lds](https:// | 提示：您可以包括阶段使用的字段。                     |
| streamsets.co |                                                      |
| m/documentati | 不包括所                                             |
| on/datacollec | 有必需字段的记录将根据为管道配置的错误处理进行处理。 |
| tor/latest/he |                                                      |
| lp/datacollec |                                                      |
| tor/UserGuide |                                                      |
| /Pipeline_Des |                                                      |
| ign/DroppingU |                                                      |
| nwantedRecord |                                                      |
| s.html#concep |                                                      |
| t_dnj_bkm_vq) |                                                      |
+---------------+------------------------------------------------------+
| [Preconditi   | 必须计算为true才能允许                               |
| ons](https:// | 记录进入处理阶段的条件。单击添加以创建其他前提条件。 |
| streamsets.co |                                                      |
| m/documentati | 不满足所                                             |
| on/datacollec | 有前提条件的记录将基于为阶段配置的错误处理进行处理。 |
| tor/latest/he |                                                      |
| lp/datacollec |                                                      |
| tor/UserGuide |                                                      |
| /Pipeline_Des |                                                      |
| ign/DroppingU |                                                      |
| nwantedRecord |                                                      |
| s.html#concep |                                                      |
| t_msl_yd4_fs) |                                                      |
+---------------+------------------------------------------------------+
| [On Record    | 阶段的错误记录处理：                                 |
| Error         |                                                      |
| ](https://str | 丢弃-丢弃记录。                                      |
| eamsets.com/d |                                                      |
| ocumentation/ | 发送到错误-将记录发送到管道以进行错误处理。          |
| datacollector |                                                      |
| /latest/help/ | 停止管道-停止管道。                                  |
| datacollector |                                                      |
| /UserGuide/Pi |                                                      |
| peline_Design |                                                      |
| /ErrorHandlin |                                                      |
| g.html#concep |                                                      |
| t_atr_j4y_5r) |                                                      |
+---------------+------------------------------------------------------+
2、在Zip选项卡上，配置以下属性：
+-----------+----------------------------------------------------------+
| **Field   | **说明**                                                 |
| Zip       |                                                          |
| P         |                                                          |
| roperty** |                                                          |
+===========+==========================================================+
| Fields to | 配置要合并的字段和输出字段，如下所示：                   |
| Zip       |                                                          |
|           | •第一个字段-要使用的第一个列表或列表映射字段。           |
|           |                                                          |
|           | •第二个字段-要使用的第二个列表或列表映射字段。           |
|           |                                                          |
|           | •压缩字段路径-处理器写入合并列表数据的字段。             |
+-----------+----------------------------------------------------------+
| Zip       | 合并列表时仅包括字段值。未选中时，处理器包含字段名和值。 |
| Values    |                                                          |
| Only      | 有                                                       |
|           | 关处理器如何合并列表数据的详细信息，请参阅合并列表数据。 |
+-----------+----------------------------------------------------------+
| Field     | 当一个记录中不存在一个或两个列表字段时要采取的操作：     |
| Does Not  |                                                          |
| Exist     | •包含而不处理-按原样传递记录而不创建合并字段。           |
|           |                                                          |
|           | •发送到错误-将记录传递到管道进行错误处理。               |
+-----------+----------------------------------------------------------+
#### Stream Selector/流控
Stream
Selector流选择器为要创建的每个数据流定义条件，并根据条件将数据传递给流，与用户定义的条件不匹配的记录，则使用默认流来传递。
定义条件时，流选择器会创建一个连接到管道下游分支的输出。流选择器将记录传递给与其条件匹配的所有流。例如，您创建以下条件：
Stream 1: \${record:value(\"/State\")==CA}
Stream 2: \${record:value(\"/ID\")==null}
当您运行管道时，来自加利福尼亚的记录传递到流1，缺少ID的记录传递到流2，来自加利福尼亚且缺少ID的任何记录两个流都传递。
##### 默认流
默认流捕获与用户定义的条件不匹配的记录。使用默认流来管理不匹配的记录。
配置流选择器时，将每个流连接到管道中的分支。默认流是阶段中的最后一个流。
您可以为默认流配置分支以执行其他处理或直接写入目标。
如果您不需要默认流中的记录，则可以将流连接到"Trash"目标。
例如，下图显示了处理推特数据的流选择器的条件：
![](media/image85.png){width="5.666666666666667in"
height="1.1666666666666667in"}
第一个条件评估已删除的记录，第二个条件评估标记为敏感的记录，第三个默认条件捕获所有剩余记录。
下图显示了管道中的流选择器：
![https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Graphics/StreamSelector-Pipeline.png](media/image86.png){width="5.763888888888889in"
height="2.392714348206474in"}
第一个流将已删除的推文传递给已删除的推文目的地，第二个流将带有敏感语言的新推文传递给Field
Masker以掩盖不适当的文本，第三个流（默认流）将所有剩余的推文直接传递到新推文目的地。
##### 流的样本条件
条件定义传递给关联流的数据，满足条件的所有记录都将传递给流。使用表达式语言定义条件。
定义条件时，通常将其基于记录中一个或多个字段中的值。
样品条件：
以下条件是您可能适合您使用的常见方案：
\$ {str：contains（record：value（"/ line"），"ERROR"）}
在"行"字段中检查文本"ERROR"的数据。
如果该字段包含"ERROR"，则记录将传递给流。
\$ {str：contains（str：toLower（record：value（"/
message"）），"fatal"）}
在Message字段中缩小字符串值，然后在字段中检查"致命"数据。
如果该字段包含"致命"，则记录将传递给流。
\$ {record：value（"/ priority"）\> 1}
如果"优先级"字段中的值大于1，则记录将传递给流。
\$ {记录：值（ "/帐户ID"）== NULL}
如果AccountID字段为null，则记录将传递到流。