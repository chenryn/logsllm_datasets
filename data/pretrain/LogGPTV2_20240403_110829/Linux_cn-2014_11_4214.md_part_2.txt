强调一下，我们捣腾的电子器件可能会让你受到电击。请确保你做的任何改动都是有资质的电子工程师帮你检查过的。我们也不会深入讨论如何获取游戏，但是有很多合法的资源，例如基于MAME模拟器的老游戏，以及较新的商业游戏。
#### 第一步：街机机柜
街机机柜本身就是最大的挑战。我们在eBay上淘了个二手的90年代初的双人泡泡龙游戏机。然后花了£220装在一台旅行车后面送过来。类似这种机柜的价格并不确定。我们看到过很多在£100以内的。而另一方面，还有很多人愿意花数千块钱去买原版侧面贴纸完整的机器。
决定买一个街机机柜，主要有两个考虑。第一个是它的体积：这东西又大又重。又占地方，而且需要至少两个人才能搬动。如果你不缺钱的话，还可以买DIY机柜或者全新的小一点的，例如适合摆在桌子上的那种。然后，酒柜也能很合适。
![](/data/attachment/album/201411/13/153536shrb277zyt7zyedk.jpg)
*这种机柜可能很便宜，但是他们都很重。不要一个人去搬。一些更古老的机器可能还会需要一点小关怀，例如重新喷个漆以及一些修理工作*
除了获得更加真实的游戏体验以外，购买原版的街机机柜的一个绝佳理由是可以使用原版的控制器。从eBay上买到的大多数机器都支持两个人同时玩，有两个摇杆以及每个玩家各自的一些按钮，再加上玩家一和玩家二的选择按钮。为了兼容更多游戏，我们建议您找一台每个玩家都有6个按键的型号，这个是通用配置。也许你还想看看支持超过两位玩家的控制台，或者有空间放其他游戏控制器的，比如说街机轨迹球（类似疯狂弹珠这种游戏需要的），或者一个旋钮（打砖块）。这些待会都可以轻松装上去，因为有现成的现代USB设备。
控制器是第二考虑的，而且我们认为是最重要的，因为要通过它把你的摇动和拍打转变成游戏里的动作。当你准备买一个机柜时需要考虑一种叫JAMMA的东西，它是日本娱乐机械制造商协会（Japan Amusement Machinery Manufacturers Association）的缩写。JAMMA是街机游戏机里的行业标准，定义了包含游戏芯片的电路板和游戏控制器的连接方式，以及投币机制。它是一个连接两个玩家的摇杆和按钮的所有线缆的接口电路，把它们统一到一个标准的连接头。JAMMA就是这个连接头的大小以及引脚定义，这就意味着不管你安装的主板是什么，按钮和控制器都将会连接到相同功能接口，所以街机的主人只需要再更换下机柜上的外观图片，就可以招揽新玩家了。
但是首先，提醒一下：JAMMA连接头上带有12V电压供电，通常由大多数街机里都有的电源模块供给。为了避免意外短路或是不小心掉个螺丝刀什么的造成损坏，我们完全切断了这个供电。在本教程后面的任何阶段，我们也不会用到这个连接头上的任何电源脚。
![](/data/attachment/album/201411/13/153539mprzirstivgtsjge.png)
#### 第二步：J-PAC
有一点非常方便，你可以买到这样一种设备，连接街机机柜里的JAMMA接头和电脑的USB端口，将机柜上的摇杆和按键动作都转换成（可配置的）键盘命令，它们可以在Linux里用来控制任何想玩的游戏。这个设备就叫J-Pac（[www.ultimarc.com/jpac.html](http://www.ultimarc.com/jpac.html) – 大概£54）。
它最大的特点不是它的连接性；而是它处理和转换输入信号的方式，因为它比标准的USB手柄强太多太多了。每一个输入都有自己独立的中断，而且没有限制同时按下或按住的按钮或摇杆方向的数量。这对于类似街头霸王的游戏来说非常关键，因为他们依赖于同时迅速按下的组合键，而且用来对那些发飙后按下自己所有按键的不良对手发出致命一击时也必不可少。许多其他控制器，特别是那些生成键盘输入的，受到了他们所采用的USB控制器的同时六个输入的限制，以及一堆的Alt，Shift和Ctrl键的特殊处理的限制。J-Pac还可以接入倾角传感器，甚至某些投币装置，不用预先配置就可以在Linux下工作了。
另外的选择是一个类似的叫I-Pac的设备。它做了和J-Pac相同的事情，只不过不支持JAMMA接头。这意味着你不能把JAMMA控制器接上去，但同时也就是说你可以设计你自己的控制器布局，再把每个控制接到I-Pac上去。这对第一个项目来说也许有点小难，但是这却是许多街机迷们选择的方式，特别是他们想设计一个支持四个玩家的控制板的时候，或者是一个整合许多不同类型控制的面板的时候。我们采用的方式并不是我们推荐必须要做的，我们改造了一个输入有问题的二手X-Arcade Tankstick控制面板，换上了新的摇杆和按钮，再接到新的JAMMA接口，这样有一个非常好的地方就是可以用便宜的价格（£8）买到所有用到的线材包括电路板边缘插头。
![](/data/attachment/album/201411/13/153655tdaxgv8xajd8xgka.jpg)
*上图是我们已经装到机柜上的J-Pac。右边的蓝色和红色导线接到我们的机柜上额外的1号和2号玩家按钮*
不管你选择的是I-Pac或是J-Pac，它们产生的按键都是MAME的默认值。也就是说运行模拟器之后不需要手动调整输入。例如玩家1，会默认将键盘方向键映射成上下左右，以及将左边的Ctrl，左边的ALT，空格和左边的Shift键映射到按钮1-4。但是真正实用的功能是，对于我们来说，是双键快捷方式。当按下并按住玩家1按钮后，就可以通过把玩家1的摇杆拉到下的位置发出用来暂停游戏的P按键，推到上的位置调整音量，以及推到右的位置来进入MAME自己的设置界面。这些特殊组合键设计的很巧妙，不会对正常玩游戏带来任何干扰，因为他们只有在按住玩家1按钮后才会生效，然后可以让你正在运行游戏的时候也能做任何需要的事情。例如，你可以完全地重新配置MAME，使用它自己的菜单，在玩游戏的时候改变输入绑定和灵敏度。
最后，按住玩家1按钮然后按下玩家2按钮就可以退出MAME，如果你使用了启动菜单或MAME管理器的话就很有用了，因为他们会自动启动游戏，然后你就可以用最快的速度开始玩另一个游戏了。
对于显示屏我们采取了比较保守的方式，拿掉了街机原装的笨重的而且已经坏掉的CRT，换成一个低成本的LCD显示器。这样做有很多好处。首先，这个显示器有HDMI接口，这样他就可以轻易地直接连接到树莓派或是现代的显卡上。第二，你也不用去设定驱动街机屏幕所需要的低频率刷新模式，也不需要驱动它的专用图形硬件。第三，这也是最安全的方式，因为街机屏幕往往在机身背后没有保护措施，让很高的电压离你的手只有几英寸的距离。也不是说你完全不能用CRT，如果那就是你追求的体验的话 – 这也是获得所追求的游戏体验的最真实的方式，但是我们在软件里充分细调了CRT模拟部分，我们对输出已经很满意了，而且不需要用那个古老的CRT更是让我们高兴。
你也许还需要考虑用一个老式的4:3长宽比的LCD，而不是那种宽屏的现代产品，因为4:3模式用来玩竖屏或横屏的游戏更实用。比如说玩竖屏的射击游戏，例如雷电，如果使用宽屏显示器的话，会在屏幕两边都有一个黑条。这些黑条一般会用来显示一些游戏指引，或者你也可以把屏幕翻转90度，这样就可以用上每个像素了，但这却不实用，除非你只玩竖屏游戏或者有一个容易操作的旋转支座。
装载显示屏也很重要。如果你拿掉了CRT的话，没有现成的地方安装LCD。我们的方式是买了一些中密度纤维板(MDF)并切割成适合原来摆放CRT的地方。固定以好，我们把一个便宜的VESA支座放在中间。VESA底座可以用来挂载大多数屏幕，大的或小的。最后，因为我们的机柜前面有烟玻璃，我们必须保证亮度和对比度都设置的足够高。
### 第三步：装配
现在几个硬件大件都选好了，而且也基本上确定了最终街机机柜要摆放的地方，把这几个配件装到一起并没有太大难度。我们安全地把机柜后面的电源输入部分拆开，然后在背后的空间接了一个符合插座。接在了电源开关之后的电线上。
几乎所有的街机机柜右上角都有个电源开关，但通常在机柜靠下一点的地方有大量的导线铰接在它上面，也就是说我们的设备可以使用普通的电源连接头。我们的机柜上还有一个荧光管，用做机器上边灯罩的背光，之前是直接连接到电源上的，我们可以用一个普通插头让它保持和电源连接。当你打开机柜上的电源开关的时候，电流会流入机柜里的各个部件 - 你的树莓派和显示屏都会开机，所有一切就都准备好了。
J-Pac模块直接插到JAMMA接口上，但你可能还需要一点手动调整。标准的JAMMA只支持每个玩家最多三个按键（尽管许多非正式的支持四个），而J-Pac可以支持六个。为了连接额外的按钮，你需要把按钮开关的一端接到J-Pac的GND上，另一端接到J-Pac板边有螺丝固定的输入上。它们被标记成1SW4，1SW5，1SW6，2SW4，2SW5和2SW6。J-Pac也有声音的直通连接，但是我们发现杂音太多没法用。改成把机柜上的喇叭连接到一个二手的SoundBlaster功放上，再接到树莓派的音频输出端口。声音不一定要纯正，但音量一定要足够大。
![](/data/attachment/album/201411/13/153555og58jou825t93tuo.jpg)
*我们的树莓派已经接到J-Pac左边，也已经连接了显示屏和USB hub*
然后把J-Pac或I-Pac模块通过PS2转USB连接线接到你的PC或树莓派，也可以直接接到PC的PS2接口。要用旧的PS2接头的话额外还有个要求，你的电脑得足够古老还有这个，但是我们测试发现用USB性能是一样的。当然，这个不能用于不带PS2的树莓派，而且别忘了树莓派也需要供电。我们一般建议使用一个带电源的USB hub，因为没有供电是树莓派不工作最常见的错误。你还需要保证树莓派的网络正常，要么通过以太网（也许使用一个藏到机柜里的电力线适配器），或者通过无线USB设备。网络很关键是因为在树莓派被藏到机柜里后你还可以重新配置它，不用接键盘或鼠标就可以让你调整设置以及执行管理任务。