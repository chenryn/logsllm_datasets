title:Skeptic: Automatic, Justified and Privacy-Preserving Password Composition
Policy Selection
author:Saul A. Johnson and
João F. Ferreira and
Alexandra Mendes and
Julien Cordry
0
2
0
2
l
u
J
7
]
R
C
.
s
c
[
1
v
9
0
8
3
0
.
7
0
0
2
:
v
i
X
r
a
Skeptic: Automatic, Justified and Privacy-Preserving Password
Composition Policy Selection
Saul Johnson
PI:EMAIL
Data Analytics Research Group
Teesside University
Middlesbrough, UK
Alexandra Mendes
PI:EMAIL
HASLab, INESC TEC, Porto and
Department of Informatics
Universidade da Beira Interior
Covilhã, Portugal
INESC-ID and Instituto Superior Técnico
Immersive Tech. Research Group
João F. Ferreira
PI:EMAIL
University of Lisbon
Lisbon, Portugal
Julien Cordry
PI:EMAIL
Teesside University
Middlesbrough, UK
ABSTRACT
The choice of password composition policy to enforce on a
password-protected system represents a critical security decision,
and has been shown to significantly affect the vulnerability of user-
chosen passwords to guessing attacks. In practice, however, this
choice is not usually rigorous or justifiable, with a tendency for
system administrators to choose password composition policies
based on intuition alone. In this work, we propose a novel method-
ology that draws on password probability distributions constructed
from large sets of real-world password data which have been fil-
tered according to various password composition policies. Password
probabilities are then redistributed to simulate different user pass-
word reselection behaviours in order to automatically determine
the password composition policy that will induce the distribution
of user-chosen passwords with the greatest uniformity, a metric
which we show to be a useful proxy to measure overall resistance
to password guessing attacks. Further, we show that by fitting
power-law equations to the password probability distributions we
generate, we can justify our choice of password composition policy
without any direct access to user password data. Finally, we present
Skeptic—a software toolkit that implements this methodology, in-
cluding a DSL to enable system administrators with no background
in password security to compare and rank password composition
policies without resorting to expensive and time-consuming user
studies. Drawing on 205,176,321 passwords across 3 datasets, we
lend validity to our approach by demonstrating that the results we
obtain align closely with findings from a previous empirical study
into password composition policy effectiveness.
CCS CONCEPTS
• Security and privacy → Formal security models; Logic and
verification; Authentication; Systems security.
ASIA CCS ’20, October 5–9, 2020, Taipei, Taiwan
© 2020 Copyright held by the owner/author(s). Publication rights licensed to ACM.
This is the author’s version of the work. It is posted here for your personal use. Not
for redistribution. The definitive Version of Record was published in Proceedings of the
15th ACM Asia Conference on Computer and Communications Security (ASIA CCS ’20),
October 5–9, 2020, Taipei, Taiwan, https://doi.org/10.1145/3320269.3384762.
KEYWORDS
Password composition policy, Passwords, Password authentication,
Formal verification, Interactive theorem proving
ACM Reference Format:
Saul Johnson, João F. Ferreira, Alexandra Mendes, and Julien Cordry. 2020.
Skeptic: Automatic, Justified and Privacy-Preserving Password Composition
Policy Selection. In Proceedings of the 15th ACM Asia Conference on Computer
and Communications Security (ASIA CCS ’20), October 5–9, 2020, Taipei,
Taiwan. ACM, New York, NY, USA, 15 pages. https://doi.org/10.1145/3320269.
3384762
1 INTRODUCTION
If we wish to increase the resilience of a password-protected system
to password guessing attacks, our thoughts might turn in the first
instance to password composition policies—sets of rules that dictate
which subset of the space of all supported passwords users are per-
mitted to create on the system. The selection of a suitable password
composition policy, however, has not historically been carried out
according to rigorous selection criteria [8], with a tendency for sys-
tem administrators to base their decision on which one “feels” like it
would lead to a more secure distribution of user-chosen passwords.
For such a critical component of system security, the finding that
the restrictiveness of a password composition policy has little to
no correlation with the value of the assets it protects is somewhat
alarming [14], and makes a strong case for a more rigorous method
of selection.
While much study to date has been conducted on how password
composition policies affect the security of password-protected sys-
tems, such work usually consists of an analysis of either leaked data
sets that have since been released into the public arena [36] or of
passwords that have been collected under different password com-
position policies specifically for the purpose of the study [24, 31].
The former condition means that it is very difficult to estimate how
some of the more exotic password composition policies affect sys-
tem security because databases of passwords created under those
policies are not available. While it might be tempting to merely
filter these datasets according to the policy we wish to examine,
previous work [22] finds that this does not create a dataset that
ASIA CCS ’20, October 5–9, 2020, Taipei, Taiwan
S. Johnson, J. F. Ferreira, A. Mendes, and J. Cordry
is representative of one that is actually created under that policy,
with passwords in filtered datasets tending to be stronger. The
latter condition, while allowing password security researchers to
collect data under any password composition policy they choose,
has considerably less ecological validity; the participants were, after
all, creating passwords in an experimental setting and not on any
real-world system of value to them as individuals. Gathering and
analysing data in this way is also expensive, time-consuming, and
requires significant domain expertise, placing it beyond the reach
of a typical system administrator working in the field. Finally, both
of these methodologies raise privacy concerns. In each case, we are
handling user-generated passwords that may still be in use by those
individuals, or else be usable to infer passwords that are. We are
motivated, therefore, to search for a methodology that permits us to
automatically choose a suitable password composition in a way that
allows us to justify that choice while avoiding the propagation of
the user password data that informs it. This is especially important
considering the recent rise in previously-leaked passwords being
employed in phishing scams [29] against the users they belong to.
In this work, we propose such a methodology, and present Skep-
tic—a software toolchain that puts it into practice. We begin by
drawing on large sets of leaked password data [6, 10, 18] to de-
rive password probability distributions. By redistributing password
probabilities in different ways, we can simulate different modes of
password reselection behaviour that might be exhibited by users
when forced to select a different password by the password com-
position policy. Drawing on work by Malone and Maher [26] and
Wang et al. [35], we fit power-law curves to these password proba-
bility distributions, allowing us to quantify the additional guessing
attack resistance conferred by their associated password composi-
tion policies in isolation from the password data itself. Following
related research into increasing system security by maximising
password diversity [4, 26, 30], we achieve this by using the unifor-
mity of these distributions as a proxy for their overall resistance to
guessing attacks. To maximise the practical utility of the data we
generate, Skeptic includes the Password Composition Policy As-
sertion Language (Pacpal)—a DSL for straightforwardly comparing
and ranking password composition policies using this data.
Using a selection of password composition policies drawn
from related work and data from three large-scale password data
breaches, we demonstrate our methodology and its implementation
(as the Skeptic toolchain) by rigorously and justifiably ranking
password composition policies under a range of different assump-
tions about user password reselection behaviour. As our evaluation
data, we use 3 datasets containing a total of 205,176,321 passwords,
studying 28 distinct password composition policies. The results
we obtain correlate strongly with those from previous empirical
studies on the effects of password composition policies on the secu-
rity of user-chosen passwords, with some interesting findings that
warrant further study. For instance, we find that stricter (i.e. less
usable) password composition policies dramatically reduce pass-
word probability distribution uniformity if we assume that user
password reselection behaviour will converge on a small number
of remaining permitted passwords. We further demonstrate that
the Skeptic toolchain supports straightforward specification of
password composition policies from within the Coq proof assistant,
with all the advantages we would expect from such an encoding, in-
cluding the ability to check from within Coq that certain password
composition policies confer immunity to the Mirai and Conficker
botnet malware.
We have introduced the work and its motivation in this Sec-
tion 1. In Section 2, we introduce related work. We then move on
to describing our methodology in detail in Section 3, in a man-
ner designed to facilitate implementation to encourage replication
and experimentation. In Section 4 we describe the implementation
of our methodology as the Skeptic toolchain. Section 5 contains
an evaluation of our approach, in which we attempt to replicate
previous empirical research [31] on password composition policy
effectiveness. Finally, we conclude in Section 6.
2 RELATED WORK
There exists a wealth of password data online that has been com-
promised from various sources and released into the public arena.
Weir et al. [36] draw on a few different sets of this data in order
to examine the validity of using password entropy as defined in
NIST document SP800-63-1 [8] to determine the security provided
by various password composition policies. The authors conclude,
based on experiments run against some of the same datasets we use
in this work [11], that it is not a valid metric, empirically validating
earlier work by Verheul [34] proving that conversion of Shannon
entropy-like measures into password guessing entropy under dif-
ferent password composition policies is not possible. Such work
demonstrates the effective use of large breached datasets in pass-
word composition policy research, and in Section 5.3 we replicate a
subset of its results as part of validation of our novel methodology.
It is also possible to use these breached user credential databases
straight away to inform our choice of password policy by sim-
ply prohibiting all the passwords we can find in them outright.
The Pwned Passwords web application and API [19] provides this
functionality as a service, aggregating over 500 million unique pass-
words that have been exposed in data breaches and made publicly
available online. Just because a password has not been exposed be-
fore, however, does not mean that it is a good password. At the time
of writing, for instance, “breakfast321” is not present in Pwned Pass-
words but as a dictionary word and run of sequential digits is very
likely to be cracked with minimal effort by any of the great number
of password cracking algorithms in widespread use today [37, 39],
with the popular zxcvbn password strength checking library [38]
estimating that this particular example could be cracked in around
105 guesses—well within the capabilities of even the lowliest at-
tacker. The inadequacy of blacklist-based measures alone motivates
work such as ours, which aims to equip system administrators with
tooling to evaluate the security of arbitrary rule-based password
composition policies.
Other studies such as that by Shay et al. [31] actively recruit
users to create passwords under various password composition
policies, and attempt to quantify the security of those policies by
running password cracking attacks against passwords collected
under these policies. This is considered by many to represent the
gold standard of password composition policy research, and as such
we replicate results from Shay et al. [31] in Section 5.2 to validate
our novel methodology.
Skeptic: Automatic, Justified and Privacy-Preserving Password Composition Policy Selection
ASIA CCS ’20, October 5–9, 2020, Taipei, Taiwan
Regardless of how it is obtained, it is of vital importance that
any model designed to evaluate the effectiveness of password com-
position policies in reducing the vulnerability of human-chosen
passwords to guessing attacks is in some way informed by human-
generated password data. Password choice varies significantly
across different user demographics (age and nationality for ex-
ample [5]) and by extension across password-protected systems
which have user bases comprising different proportions of these
demographics. By consequence of this variability, there can be no
definitive password composition policy that will lead to ideal secu-
rity or usability outcomes across all systems—such policies must
be designed on a system-by-system basis. Work by Galbally et al.
[16] reaffirms this idea—no password strength estimation metric
is ideal for all passwords under all conditions. With this in mind,
the methodology presented in our work is designed to be attack-
independent, and provide a general idea of the security of password
composition policies when deployed “in the wild” where the shape
of password guessing attacks the system might be subjected to can
seldom be known in detail. The only assumption we make about
the threat model we face is that the attacker is attempting to guess
more common passwords first.
As the weakest passwords are, ostensibly, those that are the
most likely to be chosen by users, we can think of the ideal pass-
word composition policy as the one that induces the most uniform
password distribution on our system. Password policies with poor
usability will cause users to converge on fewer easy-to-remember
passwords and those with poor security will permit the selection
of very weak passwords such as “password” and “123456”. This is
not a novel argument. Work on adaptive password composition
policies [30] supports the view that greater password diversity is
key to system security while research into password composition
policy optimisation [4] focuses on maximising minimum password
entropy—that is, reducing the probability of the most likely pass-
word, analogous to increasing password distribution uniformity.
Malone and Maher [26] highlight that user-chosen password dis-
tributions are non-uniform, and mention that if this were not the
case, attacks that rely on attempting to guess common passwords
would become less effective.
3 METHODOLOGY
In this section, we present our methodology for rigorous and justi-
fiable password composition policy selection in detail, beginning
with raw password data and ending with arbitrary user-specified
password composition policies ranked under various assumptions
about user behaviour.
3.1 Sourcing Human-Chosen Passwords
With the variability of user password choice in mind [5], our
methodology is parametric on an input set—some collection of
password data that we expect to be representative of the user base
we are modelling, given as a password frequency distribution. In-
put sets can be sourced from any user credential database where
the password plaintext is known, but those used within this work
include:
• RockYou—compromised in plaintext from the RockYou on-
line gaming service of the same name around the year
2009 [11]. The password composition policy in place at the
time enforced a minimum length of 5 characters with no
other requirements [17]. The version we obtained contained
32,603,048 passwords.
• Yahoo—compromised in plaintext from the Yahoo Voice
VoIP service around the year 2012 [18]. The password com-
position policy in place at the time of the breach enforced a
minimum length of 6 characters with no other requirements
[27]. The version we obtained contained 453,492 passwords.
• LinkedIn—compromised from the professional social net-
working site LinkedIn around the year 2012. The true extent
of this breach was unknown until 2016 when it was revealed
to be much more extensive than was initially made public [6].
Unsalted password hashes in SHA-1 format were compro-
mised, and ≈ 98% of these have subsequently been cracked.
It is these cracked passwords that make up the LinkedIn
dataset we use in this work. The policy in place at the time
of the breach enforced a minimum length of 6 characters [27].
The version we obtained contained 172,428,238 passwords.
3.1.1 Data cleansing. For a dataset to be as representative as pos-
sible, each password within it must have been created by a human
under a known password composition policy which has a permitted
password space that is a superset of that of the password composi-
tion policies we wish to model. It is therefore useful to filter these
datasets according to the password composition policy they were
created under in order to remove any passwords created under old
password composition policies or non-password artifacts [22] that
might be present within them. In cases where this policy is not
known, it is possible to attempt to infer it using a password com-
position policy inference tool such as pol-infer [21]. Each dataset
was first filtered according to the password composition policy it is
known to have been created under. The small proportion of pass-
words containing non-ASCII characters were then removed to avoid
encoding issues that might arise due to multi-byte characters being
stored as multiple characters, artificially inflating password length.
Some passwords in the Yahoo dataset (10,654 passwords) appeared
to be single sign-on flags for integration with an external service,
and were accordingly removed. Likewise, some passwords in the
LinkedIn dataset (174,088 passwords) appeared to be hexadecimal
data (perhaps due to encoding issues), and were also removed. The
sizes of each dataset used in this study after this filtration step are
shown in Table 1.
Table 1: A breakdown of the number of passwords filtered
from each dataset used in this study.
Dataset
RockYou [11]
Yahoo [18]
LinkedIn [6]
Filtered size
32,506,433
434,287
172,235,601
Removed
96,615 (0.30%)
19,205 (4.23%)
192,637 (0.11%)
Frequencies to probabilities. Following Blocki et al. [3], given
3.1.2
a cleansed input set I of N user passwords, we use fi to denote the
frequency of the ith most common password in the set and pwdi
to denote the ith most common password in the set.
ASIA CCS ’20, October 5–9, 2020, Taipei, Taiwan
S. Johnson, J. F. Ferreira, A. Mendes, and J. Cordry
The set I induces a probability distribution D over passwords
defined as:
 fi
N
0
D(p) =
if p = pwdi
otherwise