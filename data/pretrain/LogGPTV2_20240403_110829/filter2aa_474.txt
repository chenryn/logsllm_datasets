Jon Rose 
Trustwave’s SpiderLabs 
Flash Remoting Technologies 
Flex Data Services 
•  Data Management 
–  Update client and/or server when data changes 
•  Messaging  
–  Real Time Messaging protocol (RTMP) 
–  Pub-sub model 
–  Real-time data  streaming 
•  Remoting 
–  HTTP, SOAP, AMF 
–  Automatic  data marshalling 
•  PDF 
–  Create and edit PDF’s 
CrossDomain.xml 
Flash Remoting Insecurity 
•  Developers fail to restrict access to methods: 
–  Authentication  
–  Authorization 
•  Method & Service names can be brute-forced 
•  Flex servers can be fingerprinted 
•  Common vulns in remote methods: 
–  Injections 
–  Information leakage 
–  Denial of service 
–  Privilege escalation 
Finding Methods & Services 
•  Decompile SWF and search for remoting calls 
•  Watch network traffic 
•  Dictionary attack against server 
Finding SWF Remoting Calls 
•  Download SWF file 
•  Decompile  
–  Sothink SWF decompiler or HP SWFScan 
•  Analyze ServerConfig.xml 
•  Regex for remoting methods 
SWF Remoting ServerConfig.xml 
•  Often embedded in the 
SWF 
•  Provide URL's and service 
names 
•  Destination id represents 
services 
–  securityService 
–  exampleService 
–  mathService 
SWF Remoting Search 
•  Search for remoting methods 
–  send, service, remote, etc 
findstr /I /N /S ”sender\." *.as 
AMF Network Traffic 
•  AMF is: 
–  Serialized ActionScript object 
–  Transported as HTTP POST body 
•  Charles proxy can intercept and decode AMF traffic 
•  Wireshark captures can disclose Url's, Services, and Methods 
–  No native decoder 
AMF Network – Charles Proxy 
AMF Network – Wireshark 
Dictionary Attacks 
•  Determine valid service and methods 
–  Based on error messages 
–  Fairly fast 
–  Easily predictable method/service names 
•  Login 
•  getters 
•  setters 
–  Possible to build default wordlist 
Securing Flash Remoting 
•  BlazeDS 
–  Only public methods defined in remoting-config can be called 
–  Use security-constraints in remoting-config.xml to each method 
•  include-methods  
•  exclude-methods  
–  Read the Adobe BlazeDS security docs 
Securing Flash Remoting 
•  AMFPHP 
–  Methods that start with an underscore cannot be remotely called 
–  Remove the Service Browser and DiscoveryService service 
–  Disable remote tracing and debugging headers by setting 
PRODUCTION_SERVER 
–  Use beforeFilter for authorization controls 
•  PYAMF 
–  Enable authentication on the server 
Questions 
•  Next Steps 
•  Future Research 
•  Latest Code  
–   deblaze-tool.appspot.com 
•  Thanks 
–  Spiderlabs 
–  Nick Joyce 
–  Stads9000 
–  GDS crew 
•  Contact me: 
–  PI:EMAIL 
–  PI:EMAIL