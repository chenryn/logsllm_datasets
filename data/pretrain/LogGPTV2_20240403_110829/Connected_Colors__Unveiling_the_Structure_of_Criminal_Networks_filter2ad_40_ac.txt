6,772
9,070
14,373
12,511
45,654
4,635
Table 1: Top 10 ASes in Rustock criminal network by eigenvector centrality
which would explain its high importance in this criminal network. Castle Access
Inc. and Cable Bahamas are known to be used for domain parking monetization,
which would explain their presence.
Rustock was taken down in March of 2011 (Operation b107), however the
Rustock criminal network has facilitated other criminal operations until this day.
This shows that single botnet takedown approaches can solve only the short term
problem of a threat (i.e., spamming activity facilitated by Rustock botnet). In
the case of Rustock criminal network, we saw that Internet abuse continued to
use the same criminal infrastructure, as the Rustock botnet used to use, long
after the botnet was taken oﬀ-line. During the 8 months of our experiment, we
observed 4,381 new malicious domain names per day that began to use this
criminal network.
5.2 MojoHost Benign Hosting Network
The MojoHost benign hosting network (Figure 3c) is an example of a benign
hosting provider being abused by Internet miscreants for criminal infrastructure.
We want to make the distinction clear that we are not saying MojoHost is com-
plicit in criminal activity, but rather, malicious threats abuse MojoHost to build
their criminal network. It is a smaller community of 255 vertices that has several
distinct campaigns, the “orbiting” sub-communities, using it as infrastructure.
The most structurally signiﬁcant vertices are colored by their eigenvector cen-
trality (Figure 3d). These 12 black vertices all belong to a single AS (AS27589)
which provides redundancy for the malicious campaigns.
We identiﬁed seven distinct operators using the MojoHost benign hosting
network for their malicious infrastructure, primarily to act as C&C servers. There
were three distinct Zeus kit campaigns, two Blackhole exploit kit campaigns, and
three unidentiﬁed malware family campaigns running C&C servers. In addition
to C&C servers, the community was also home to three data exﬁltration drop
sites used by a mixture of Zeus instances. The Blackhole exploit kits facilitated
drive-by downloads that infected victims with a Delf malware family instance,
which is used to perform the second-stage of a two-stage binary drop. Most
domains were registered through dynamic DNS providers which are commonly
used in Blackhole exploit kit instances.
Despite the fact that the MojoHost community is benign, it presents an
interesting hierarchical structure that would intuitively be fairly resistant against
AS-level take downs. While the main support structure for the campaigns exists
in a single AS, the orbiting communities are spread across 58 ASs in total. If a
criminal network contained several layers in this hierarchical fashion, it would
be diﬃcult to cripple it quickly due to the redundancy. Maintaining this level
of structure may prove to be diﬃcult in scale, which may explain why criminal
networks seen in practice are much less organized (Sections 5.1 and 5.4).
5.3 Botnet Criminal Network
This criminal network is a large botnet that provides fast ﬂux services across
1,226 vertices, most of which belong to consumer dynamic IP address space.
The graph is almost complete with a graph density of 0.956 (see Figure 4c). It
is in the botnet operator’s best interest to keep this structure as it maximizes
the redundancy of the vertices using DNS agility. Since the graph is nearly
complete, it is reasonable to assume that most of the vertices are of about equal
importance. The eigenvector centrality, however, reveals interesting underlying
structure by highlighting the vertices considered less important to the overall
criminal network. In Figure 4d, we see the eigenvector centrality graph where the
vertex shading is inverted (darker is less important in this case), which highlights
32 vertices within the botnet’s sub-structure that are used for other purposes.
Speciﬁcally, these vertices with lower than normal EC appears to be C&C servers
and data exﬁltration drop sites for Zeus v2 (a.k.a. Zeus Group B) and Blackhole
kit generated malware for a single operator. In this case it is important to note
that the only way to truly disable the network is to target the central nodes.
Eliminating lower centrality nodes would quickly disable the smaller campaigns
contained within, but would not cause damage to the larger criminal network,
which is the focus of this paper. Furthermore, signiﬁcant portion of the domain
names in this botnet are related with FakeAV/RogeAV type of threats. One of
the main diﬀerences of the FakeAV threats facilitated by this criminal network
is that they are primarily delivered by search engine optimization poisoning
techniques.
Botnet criminal networks are likely to present themselves as dense or com-
plete graphs with a relatively uniform eigenvector centrality distribution due to
the fundamental nature of how they are operated by criminals. Furthermore, by
looking for vertices that are considered less important by centrality measures,
we may identify underlying substructures that diﬀer in function.
(a) Rustock criminal
network
(b) MojoHost benign
hosting network
(c) Masterhost crimi-
nal network
(d) Botnet criminal
network
Fig. 6: Domain-level takedown CDFs
5.4 Masterhost Criminal Network
At 3,725 vertices and 11,519 edges, the Masterhost criminal network is the largest
criminal network we identiﬁed during our study (Figure 4a). Much like the Ru-
stock criminal network, the Masterhost criminal network is very sparse (graph
density of 0.002), but the densely malicious networks are missing from the center.
In this criminal network, dense vertices are not considered structurally impor-
tant as shown by Figure 4b. This means that the malicious domains contained
within these dense structures are not heavily replicated throughout the criminal
network, making these good candidates for AS-level takedowns.
AS# AS Description
25532 Masterhost
21788 Network Operations Center Inc.
3561 Savvis
7303 Telecom Argentina
32613 iWeb Technologies
21740 eNom, Inc.
25847 ServInt
16509 Amazon Inc.
7788 Magma Communications Ltd.
6939 Hurricane Electric, Inc.
# of Domains
12,281
3,692
3,285
2,830
2,684
2,292
2,275
2,254
2,225
2,201
Table 2: Top 10 ASes in Masterhost criminal network by number of malicious
domains
The top 10 ASes by number of hosted malicious domains in the Masterhost
criminal network are shown in Table 2. Notice the number of domains per AS
is substantially smaller than it was for the Rustock criminal network due to the
lack of centralized malicious hosting. The biggest AS, with the respect of the
domain names that facilitate resolutions for, is the “Masterhost”. Masterhost is
a very well known bulletproof network that has been identiﬁed by the security
community since 2007 and it is highly related with the Russian Business Network
organization [12]. In the 8 months of our experiments, we observed a median of
1,065 new malicious domain names every day that began to use the Masterhost
criminal network.
5.5 Simulating Takedowns
Using Equation 3, we identify critical vertices in the case study networks and
simulate takedowns by producing the network-level and domain-level takedown
CDFs in Figure 5 and Figure 6, respectively. These CDFs show the proportion
of networks or domain names removed from the criminal network against the
loss in the total amount of potential victim lookups that were made to the
entire criminal network. Successful takedowns will manifest as superlinear CDFs,
denoting that we can eliminate many potential victims by selectively removing
few critical vertices in the criminal network. The aggregate DNS lookup volume
to the malicious infrastructure proxies the potential loss in victim population;
intuitively, infrastructure that is queried frequently is likely to cause the greatest
problems to the attacker if it is taken down. In the two largest cases, the Rustock
criminal network and Masterhost criminal network, we see the network-level
takedowns are very eﬀective (Figure 5a/5c). In the Rustock criminal network,
removing only 20% of the criminal network infrastructure decreases to total
number of lookups by 70%. In the Masterhost criminal network, we can decrease
total lookups by 40% by focusing our takedown eﬀorts on the worst 20% of the
networks. Recall from Figures 3b and 4b that the Rustock criminal network
had a dense core of dedicated malicious hosting, while the Masterhost criminal
network did not. This would explain the diﬀerence in takedown performance
between the two criminal networks. Figures 6a and 6c show that domain-level
takedowns for these two criminal networks are ineﬀective, based on the sublinear
and linear CDFs. Intuitively, this makes sense as the graphs are very sparse.
A single domain name is unlikely to substantially damage the infrastructure
because the domain names are less distributed.
Figures 5b and 6b illustrate the diﬃculty in taking down a well structured
network seen in the MojoHost benign hosting network. Since the underlying
network infrastructure is benign, the miscreants abusing MojoHost must take
great care in distributing their malicious activities, which makes takedowns more
diﬃcult. This also suggests that creating hierarchical criminal networks resilient
against takedowns is possible, but we did not ﬁnd these structures in the wild.
For the Botnet criminal network, both network-level (Figure 5d) and domain-
level (Figure 6d) takedowns were successful; eliminating 40% of the networks or
domains associated with the botnet caused an 80% and 70% decrease in total
lookups, respectively. Since Botnet criminal network has a much higher graph
density than the other case studies, it makes sense that the domain-level take-
down would be eﬀective. However, understanding the success of the network-level
takedown requires an understanding of the type of threats the network facilitates
the hosting infrastructure for. Most of the malicious hosting that uses the Bot-
net criminal network are for C&C servers, which need to be highly available.
This availability requirement causes the dense structure, which lowers the dis-
criminatory function of the EC metric as most nodes will be considered highly
important. Our selection process compensates for this by targeting networks
densely populated with malicious domain names and IPs.
6 Conclusion
In this paper, we proposed a graph-based method to representing criminal net-
work infrastructures and unveiling their key components. Furthermore, we pro-
posed an approach to analyze the graph properties of malicious network infras-
tructures and better understand what actions could be taken to dismantle them
completely or to inﬂict signiﬁcant damage to the adversaries’ criminal opera-
tions. We showed that in many smaller criminal networks, their network graph
structure and domain name distribution make complete takedowns possible, by
revoking the domains associated with the criminal network with the help of
the domain registrars. In more complex cases, we provided three key metrics
that can identify critical components of a criminal network, and quantiﬁed the
eﬀectiveness of our suggested takedown measures.
Acknowledgements The authors thank the anonymous reviewers for their
insightful and helpful comments as well as the RZA for being razor sharp and
always on point.
References
1. M. Abu Rajab, J. Zarfoss, F. Monrose, and A. Terzis. A multifaceted approach to
understanding the botnet phenomenon. Proceedings of the 6th ACM SIGCOMM
conference on Internet measurement, pages 41–52, 2006.
2. M. Bastian, S. Heymann, and M. Jacomy. Gephi: An Open Source Software for
Exploring and Manipulating Networks. In International AAAI Conference on We-
blogs and Social Media, 2009.
3. T. Bates, P. Smith, and G. Huston. CIDR report bogons.
4. V. Blondel, J. Guillaume, R. Lambiotte, and E. Lefebvre. Fast unfolding of commu-
nities in large networks. Journal of Statistical Mechanics: Theory and Experiment,
2008.
5. S. Brin and L. Page. The anatomy of a large-scale hypertextual web search en-
gine. In Proceedings of the seventh international conference on World Wide Web
7, WWW7, pages 107–117, Amsterdam, The Netherlands, The Netherlands, 1998.
Elsevier Science Publishers B. V.
6. J. Caballero, C. Grier, and C. Kreibich. Measuring Pay-per-Install: The Com-
In Proceedings of the USENIX Security
moditization of Malware Distribution.
Symposium, 2011.
7. C. Cho, J. Caballero, and C. Grier. Insights from the inside: A view of botnet
management from inﬁltration. In Proceedings of the USENIX Workshop on Large-
Scale Exploits and Emergent Threats (LEET), 2010.
8. N. Christin, S. S. Yanagihara, and K. Kamataki. Dissecting one click frauds.
In Proceedings of the 17th ACM Conference on Computer and Communiations
Security (CCS), 2010.
9. M. Collins, T. Shimeall, S. Faber, J. Janies, R. Weaver, and M. D. Shon. Predict-
ing future botnet addresses with uncleanliness. In Proc. of IMC. CERT Network
Situational Awareness Group, 2007.
10. A. D. Correa. Malware patrol.
11. M. Cova, C. Leita, O. Thonnard, A. Keromytis, and M. Dacier. An analysis of
rogue AV campaigns. In Recent Advances in Intrusion Detection. UCSB, Columbia,
2010.
12. dn1nj4. RBN ”Rizing”. Technical report, Shadowserver.org, 2008.
13. DNS-BH. Malware prevention through DNS redirection.
14. dnsbl.abuse.ch. dnsbl.abuse.ch.
15. T. Holz, M. Engelberth, and F. Freiling. Learning more about the underground
In Computer Security–
economy: A case-study of keyloggers and dropzones.
ESORICS 2009, 2010.
16. Internet Systems Consortium. Security Information Exchange Portal.
17. M. Konte, N. Feamster, and J. Jung. Fast ﬂux service networks: Dynamics and
roles in hosting online scams. Technical report, 2008.
18. M. Konte, N. Feamster, and J. Jung. Dynamics of online scam hosting infras-
In Passive and Active Network Measurement. Georgia Tech and Intel
tructure.
Research, 2009.
19. N. Leontiadis, T. Moore, and N. Christin. Measuring and analyzing search-
In Proceedings
redirection attacks in the illicit online prescription drug trade.
of the USENIX Security Symposium, August 2011.
20. L. Lu, V. Yegneswaran, P. Porras, and W. Lee. BLADE: an attack-agnostic ap-
proach for preventing drive-by malware infections. In Proceedings of the 17th ACM
Conference on Computer and Communiations Security (CCS 2010). Georgia Tech,
SRI International, 2010.
21. Malc0de. Malc0de DNS blacklist.
22. Malware Domain List. Malware domain list.
23. D. McCoy, A. Pitsillidis, G. Jordan, N. Weaver, C. Kreibich, B. Krebs, G. M.
Voelker, S. Savage, and K. Levchenko. Pharmaleaks: Understanding the business
of online pharmaceutical aﬃliate programs. In 21st Usenix Security Symposium
(USENIX 2012), 2012.
24. R. McMillan. After takedown, botnet-linked ISP Troyak resurfaces, 2010.
25. S. Nagaraja and R. Anderson. The topology of covert conﬂict. In Workshop on
the Economics of Information Security (WEIS), 2006.
26. S. Nagaraja, P. Mittal, C.-Y. Hong, M. Caesar, and N. Borisov. Botgrep: ﬁnding
p2p bots with structured graph analysis.
In Proceedings of the 19th USENIX
conference on Security, USENIX Security’10, pages 7–7, Berkeley, CA, USA, 2010.
USENIX Association.
27. M. Newman. Networks: An Introduction. Oxford University Press, USA, 1 edition,
May 2010.
28. F. Roveta, L. D. Mario, F. Maggi, G. Caviglia, S. Zanero, and P. Ciuccarelli.
BURN: Baring Unknown Rogue Networks. In VizSec. Politecnico di Milano, 2011.
29. Snort Labs. Snort DNS/IP/URL lists.
30. SpamHaus. drop.lasso.
31. SpyEye Tracker. SpyEye tracker.
32. B. Stone-Gross, C. Kruegel, K. Almeroth, A. Moser, and E. Kirda. Fire: Finding
rogue networks. In ACSAC. UCSB, Technical University Vienna, Eurocom, 2009.
33. P. Stranger, J. McQuaid, S. Burn, D. Glosser, G. Freezel, B. Thompson, and W. Ro-
gofsky. Top 50 Bad Hosts and Networks. Tech Report.
34. Team Cymru. Bogons.
35. F. Weimer. Passive DNS replication. In 17th Annual FIRST Conference on Com-
puter Security Incidents, 2005.
36. D. B. West. Introduction to Graph Theory (2nd Edition). Prentice Hall, 2 edition,
Sept. 2000.