# OCR Output
## Page 1
CNUTCon 2017
CNUT
全球运维技术大会
京东物流系统自动化运维平台
技术揭密
赵玉开
京东资深架构师
Geekbang>.InfoQ
主办方
极客邦科技
---
## Page 2
QCon
九折即将结束
团购还享更多优惠，折扣有效期至9月17日
全球软件开发大会
扫描右方二维码即可查看大会信息及购票
10月17-19日上海·宝华万豪酒店
如果在使用过程中遇到任何问题，可联系大会主办方，欢迎咨询！
扫码锁定席位
微信：qcon-0410
电话：010-84782011
七折即将截止立省2040元
ArchSummit
使用限时优惠码AS200，
以目前最优惠价格报名ArchSummit
全球架构师峰会2017
仅限前20名用户，优惠码有效期至9月19日
扫描右方二维码即可使用
扫码锁定席位
如果在使用过程中遇到任何问题，可联系大会主办方，欢迎咨询！
12月8-9日北京·国际会议中心
微信：aschina666
电话：15201647919
---
## Page 3
Geekbang>.
极客邦科技
极客搜索
全站干货，一键触达，只为技术
s.geekbang.org
扫描二维码立即体验
有没有一种搜索方式，能整合InfoQ 中文站、极客邦科技旗下12大微信公众号矩阵的全部资源？
极客搜索，这款针对极客邦科技全站内容资源的轻量级搜索引擎，做到了！
扫描上方二维码，极客搜索！
---
## Page 4
EGO
EXTRA GEEKS' ORGANIZATION
NETWORKS
这里只有
KAZAKHSTAN MONGOLIA CHINA
CHINA
TURKEYn
IRAN
技术领导者
CHINA
ARABIA
EGO会员第二季招募季正式开启
报名时间：9月1日－9月15日
TECHNOLOGY
扫描添加E小欧,
邀您进入EGO会员预报名群
EGO
立即报名
E小欧
---
## Page 5
TABLE OFCONTENTS
起因
架构
开仓
总结
CNUTCon2017
Geek bang>. InfoQ
主办方
CNUT
全球运维技术大会
---
## Page 6
解决痛点
业务增长需要每周开n个仓
需要运维、研发、运营、质控配合开仓，沟通成本高
应用繁多、关联关系复杂
CNUTCon2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 7
沟通成本
运维
研发
仓库
质控
运营
CNUTCon2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 8
应用依赖复杂度
基础资料
权限管理
抹货计划
拣货
报表
数据同步
内配
库存
出库
入库
供应商预约
任务调度
APS
DEC
NGiVX
NGiVX
JMQ
数据库
REDIS
Web Server
CNUTCon 2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 9
TABLEOFCONTENTS
起因
架构
开仓
总结
CNUTCon2017
Geek bang>. InfoQ
主办方
CNUT
全球运维技术大会
---
## Page 10
架构选型
Puppet
Saltstack
Chef
Ansible
CNUTCon 2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 11
技术栈
Spring
MyBatis
Drools
MVEL
Java
Activiti
Salt
module
grain
pillar
runner
rsync
CNUTCon 2017
Geekbang). InfoQ
主办方
NUT)
全球运维技术大会
---
## Page 12
Saltstack
4505下发指令
salt minion cmd.run "df -h"
4506回传结果
master
minion
minion
salt *' state.sls redis
master
Runner
master
minion
redis.sls
redis:
 pkg.installed
service:
- running
- require:
minion
minion
minion
- pkg: redis
CNUTCon2017
Geekbang). InfoQ
主办方
NUT)
全球运维技术大会
---
## Page 13
总体架构
开仓
园区仓
容器仓
WEB
亚一仓
工作流引擎
部署
上线
回滚
重启
Salt-API Proxy
Rsync
运维工作
数据库
应用扩容
维修
Salt-API
元数据管理
Server
用户管理/权限管理/操作日志
Salt-Master
监控
网络
服务器
应用实例
任务
VPN
检查
进程
数据库
HTTP
中间件
Minion]
[Minion
Minion
[Minion
工具
网络
系统命令
JVM
中间件
Minion
|Minion
Minion]
|Minion
Minion]
|Minion
Minion
Minion
SALTSTACK
CNUTCon 2017
Geekbang). InfoQ
主办方
全球运维技术大会
---
## Page 14
后端自定义模块
MySQL
安装
主从同步
结构比较|索引比较
ddl执行
dml执行
数据初始化
主从切换
REDIS
安装
哨兵配置
命令执行
Tomcat
安装
配置应用
JVM参数
后端自定义模块
NGINX
安装
反向代理
配置修改
路由规则
Java
安装
jstat
jmap
jstack
jps
部署
上线
重启
回滚
扩容
缩容
文件系统
目录浏览
文件查看
文件编辑
tail
日志清除
内存
工具
网络命令
进程管理
10
cpu
检查
MySQL
Redis
端口
HTTP
进程
CNUTCon2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 15
元数据
性能
部署
指标
规则
基本
监控
数据
环境
属性
信息
规则
变量
作业
服务器
单位
人员
应用
应用
实例
基本
依赖
检查
运行
信息
配置
关系
基本
规则
状态
信息
信息
CNUTCon 2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 16
TABLEOFCONTENTS
起因
架构
开仓
总结
CNUTCon2017
Geek bang>. InfoQ
主办方
CNUT
全球运维技术大会
---
## Page 17
开仓流程
安装
初始化服
初始化系
安装系统
初始化数
建仓
务器数据
统实例
minion
实例
据库
初始化环
境变量
Drools
Activiti
选择模版
包
完成
通知上游
应用实例
应用实例
初始化应
抽数配置
质控确认
开仓
系统
检查
部署
用实例
CNUTCon 2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 18
系统实例安装
仓库属性
线程池
服务器
分组A
系统实例
依赖分组
分组B
Salt-API
Drools
分组C
CNUTCon 2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 19
规则引|擎分配实例
Drools
CNUTCon2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 20
规则引擎分配实例
{App1, App2, App5 ...},
{App7, App9, App15, App13 ...},
{App1, App2, App5 ...},
Drools
public interface ServerRuleMapper {
boolean belong(int serverIndex) ;
int mapRule(int serverIndex);
serverRuleMapperl, serverRuleMapper2
serverRuleMapper3
CNUTCon2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 21
上线
打包
上传
下发
配置
停止
启动
备份
并行发布
提高
效率
自动配置
CNUTCon 2017
Geekbang). InfoQ
主办方
CNUT)
全球运维技术大会
---
## Page 22
并行发布
合并请求
并行发布
多线程下发
CNUTCon 2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 23
自动配置
模版引擎
环境变量
MVEL
系统实例属性，例如mysql主库vip
domain.wms5.jd.com=@{SYS.ware.domain}
center.centerDomain=@{SYS.ware.domain}/cluster1
作业单位属性
2.
setting.domain=@{SYS.ware.domain}
3.
运维维护密码／token
server.ip=@{sys.nginxMaster.vip}
4.
研发自定义变量
@foreach{warehouse : warehouses}
5.
默认值机制
@{warehouse.cky2}
@end}
CNUTCon 2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 24
TABLEOFCONTENTS
起因
架构
开仓
总结
CNUTCon2017
Geek bang>. InfoQ
主办方
CNUT
全球运维技术大会
---
## Page 25
总结
自动化
可视化
效率
CNUTCon2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 26
THANKS!
智能时代的新运维
CNUTCon 2017
---