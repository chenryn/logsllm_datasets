### 1.3 熵增问题熵增，是借用了物理热力学的比喻，表达更复杂混乱的现象；程序规模变大，复杂度变高之后，再去修改程序或添加功能就更容易引发未知的Bug。腾讯曾经分享过 QQ 的架构演进变化，到了 3.5 版本 QQ的用户在线规模进入亿时代，此时在原有架构下去新增一些功能，比如：> "昵称" 长度增加一半，需要两个月；>> 增加 "故乡" 字段，需要两个月；>> 最大好友数从 500 变成 1000，需要三个月。后端系统的高度复杂性和耦合作用导致即使增加一些小功能特性，也可能带来巨大的牵连影响，所以一个小改动才需要数月时间。我们不断进行架构升级的本质，就在于随着业务和场景功能的增加，去控制住程序系统整体"熵" 的增加。而复杂且耦合度高（熵很高）的系统，正是容易滋生 Bug 的温床。
## 2. 吸取教训为了避免重蹈覆辙，我们有什么办法来吸取曾经犯错的教训么？
### 2.1 优化方法粗心大意，可以通过开发规范、代码风格、流程约束，代码评审和工具检查等工程手段来加以避免。甚至相对写错别字，代码更进一步，通过补充单元测试在运行时做一个正确性后验，反过来去发现这类我们视而不见的低级错误。认知偏差，一般没什么太好的自我发现机制，但可以依赖团队和技术手段来纠偏。每次掉坑里爬出来后的经验教训总结和团队内部分享，另外就是像一些静态代码扫描工具也提供了内置的优化实践，通过它们的提示来发现与你的认知产生碰撞纠偏。熵增问题，业界不断迭代更新流行的架构模式就是在解决这个问题。比如，微服务架构相对曾经的单体应用架构模式，就是通过增加开发协作，部署测试和运维上的复杂度来换取系统开发的敏捷性。在协作方式、部署运维等方面付出的代价都可以通过提升自动化水平来降低成本，但只有编程活动是没法自动化的，依赖程序员来完成，而每个程序员对复杂度的驾驭能力是有不同上限的。所以，微服务本质上就是将一个大系统的熵增问题，局部化在一个又一个的小服务中。而每个微服务都有一个熵增的极限值，而这个极限值一般是要低于该服务负责人的驾驭能力上限的。对于一个熵增接近极限附近的微服务，服务负责人就需要及时重构优化，降低熵的水平。而高水平和低水平程序员负责的服务本质差别在于熵的大小。而熵增问题若不及时重构优化，最后可能会付出巨大的代价。丰田曾陷入的 "刹车门"事件，就是因为其汽车动力控制系统软件存在缺陷。而为追查其原因，在十八个月中，有12位嵌入式系统专家受原告诉讼团所托，被关在马里兰州一间高度保安的房间内对丰田动力控制系统软件（主要是2005年的凯美瑞）源代码进行深度审查。最后得到的结论把丰田的软件缺陷分为三类：-   非常业余的结构设计-   不符合软件开发规范-   对关键变量缺乏保护第一类属于熵增问题，导致系统规模不断变大、变复杂，结果驾驭不了而失控；第二类属于开发过程的认知与管理问题；第三类才是程序员实现上的水平与粗心大意问题。
### 2.2 塑造环境为了修正真正的错误，而不是头痛医头、脚痛医脚，我们需要更深刻地认识问题的本质，再来开出"处方单"。在亚马逊（Amazon），严重的故障需要写一个 COE（Correction ofErrors）的文档，这是一种帮助去总结经验教训，加深印象避免再犯的形式。其目的也是为了帮助认识问题的本质，修正真正的错误。但一旦这个东西和 KPI 之类的挂上钩，引起的负面作用是 COE的数量会变少，但真正的问题并没有减少，只是被隐藏了。而其正面的效应像总结经验、吸取教训、找出真正问题等，就会被大大削弱。关于如何构造一个鼓励修正错误的环境，我们可以看看来自《异类》一书讲述的大韩航空的例子，大韩航空曾一度困扰于它的飞机损失率：> 美国联合航空 1988 年到 1998 年的飞机损失率为百万分之> 0.27，也就是说联合航空每飞行 400> 万次，会在一次事故中损失一架飞机；而大韩航空同期的飞机损失率为百万分之> 4.79，是前者的 17 倍之多。事实上大韩航空的飞机也是买自美国，和联合航空并无多大差别。它的飞行员们的飞行时长，经验和训练水平从统计数据看也差别不大，那为什么飞机损失率会如此地高于其他航空公司的平均水平呢？在《异类》这本书中，作者以此为案例做了详细分析，我这里直接引用结论。> 现代商业客机，就目前发展水平而言，跟家用烤面包机一样可靠。空难很多时候是一系列人为的小失误、机械的小故障累加的结果，一个典型空难通常包括> 7 个人为的错误。一个飞机上有正副两个机长，副机长的作用是帮助发现、提醒和纠正机长在飞行过程中可能发生的一些人为小错误。大韩航空的问题正在于副机长是否敢于以及如何提醒纠正机长的错误。其背后的理论依据源自荷兰心理学家吉尔特·霍夫斯泰德（GeertHofstede）对不同族裔之间文化差异的研究，就是今天被社会广泛接受的跨文化心理学经典理论框架：霍夫斯泰德文化纬度（Hofstede'sDimensions）。> 在霍夫斯泰德的几个文化维度中，最引人注目的大概就是> "权力距离指数（Power Distance> Index）"。权力距离是指人们对待比自己更高等级阶层的态度，特别是指对权威的重视和尊重程度。> 而霍夫斯泰德的研究也提出了一个航空界专家从未想到过的问题：让副机长在机长面前维护自己的意见，必须帮助他们克服所处文化的权力距离。想想我们看过的韩国电影或电视剧中，职场上后辈对前辈、下级对上级的态度，就能感知到韩国文化相比美国所崇尚的自由精神所表现出来的权力距离是特别远的。因而造成了大韩航空未被纠正的人为小错误比例更高，最终的影响是空难率也更高，而空难就是航空界的终极系统故障，而且结果不可挽回。吸取大韩航空的教训应用到软件系统开发和维护上，就是：需要**建立和维护有利于程序员及时暴露并修正错误，挑战权威和主动改善系统的低权力距离文化氛围，这其实就是推崇扁平化管理和"工程师文化" 的关键所在**。一旦系统出了故障非技术背景的管理者通常喜欢用流程、制度甚至价值观来应对问题，而技术背景的管理者则喜欢从技术本身的角度去解决当下的问题。我觉着两者需要结合，站在更高的维度去考虑问题：**规则、流程或评价体系的制定所造成的文化氛围，对于错误是否以及何时被暴露，如何被修正有着决定性的影响**。我们常与错误相伴，查理·芒格说：> 世界上不存在不犯错误的学习或行事方式，只是我们可以通过学习，比其他人少犯一些错误，也能够在犯了错误之后，更快地纠正错误。但既要过上富足的生活又不犯很多错误是不可能的。实际上，生活之所以如此，是为了让你们能够处理错误。人固有缺陷，程序固有Bug；吸取教训避免重蹈覆辙，除了不断提升方法，也要创造环境。你觉得呢？欢迎你留言和我分享。------------------------------------------------------------------------![](Images/a1e61bd5d0a80da9fdfd53ba1e12f2e4.png){savepage-src="https://static001.geekbang.org/resource/image/45/b8/456def9c2e16edaec6543cfa03376cb8.jpg"}
# 15 \| 根源：计划的愿景------仰望星空在前面第 2 章节 "程序之术"中，我已把对"设计""编程"和"Bug"的思考与理解都分享给你了。今天开始进入第3 章节，是关于成长修行中 "由术入道"的部分，而"道"的维度众多，我就先从和个人成长最直接相关的 "计划体系"讲起。它会有助于你一步一步走向你"理想的自己"，所以可别小看它的重要性。我想你肯定做过计划，我也不例外。一般在开始一件中长期的活动前，我都会做计划，但更重要的是反问为什么要做这个计划，因为计划是抵达愿望的途径。如果不能清晰地看见计划之路前方的愿景，计划半途而废的概率就很大了。古希腊哲学家苏格拉底有一句名言："未经检视的人生不值得活。"那么我们为什么要检视自己的人生呢？正是因为我们有成长的愿望，那么愿望的根源又到底是什么呢？
## 需求模型上世纪四十年代（1943年）美国心理学家亚伯拉罕·马斯洛在《人类激励理论》中提出了需求层次理论模型，它是行为科学的理论之一。该理论认为个体成长发展的内在力量是动机，而动机是由多种不同性质的需要所组成，各种需要之间，有先后顺序与高低层次之分，每一层次的需要与满足，将决定个体人格发展的境界或程度。其层次模型的经典金字塔图示如下：![](Images/5255bf6fe25ec111fdc207fcb81d9dbe.png){savepage-src="https://static001.geekbang.org/resource/image/36/90/363a67db781786a5f0aca5417d6e0090.png"}```{=html}```马斯洛的经典金字塔图：需求层次模型]{.reference}```{=html}`````{=html}在人生的不同阶段，会产生不同层次的目标需求。在人生的早期，我们努力学习，考一个好大学，拥有一技之长，找一份好工作，带来更高薪的收入，这很大程度都是为了满足图中最底层的生存需求，让生活变得更舒适美好。成长拼搏数年，事业小成，工作稳定，有房，有车，有娃后，第二层次，也就是安全的需求开始凸显。有人在这阶段开始给自己、父母、老婆、孩子都买人寿保险，开始考虑理财，投资甚至强身健体。然而处在这个阶段时，我却有一种强烈的不安全感，这也许和长年的程序员职业经历养成的习惯也有关系。我们做系统应用服务时总是需要考虑各种意外和异常事件发生，一般至少提供主备方案。于人生而言，保持持续学习，与时俱进，追求成长，这其实也是一种主备方案：主，指当前支撑生活的工作；备，是通过持续学习，同步成长，保持核心能力的不断积累与时间的付出来获得一份备份保障，以避免"主" 出现意外时，"备" 的能力已被时代淘汰。需求金字塔底部两层属于物质层次的"经济基础"，而再往上则进入了更高精神层次的"上层建筑"。就个体而言，高层次需求要比低层次需求具有更大的价值。在"生存" 和 "安全"基本满足的保障基础之上，我们才会更从容地向内求，更多地探求内心，进而向外索，对外去探索、发现和建立不同的圈层关系，以满足上层的社交"归属"、获得 "尊重" 与 "自我实现" 的需求。马斯洛把底层的四类需求：生存、安全、归属、尊重归类为 "缺失性"需求，它们的满足需要从外部环境去获得。而最顶层的"自我实现" 则属于"成长性" 需求。成长就是自我实现的过程，成长的动机也来自于 "自我实现"的吸引。就像很多植物具有天生的向阳性，而对于人，我感觉也有天生的"自我实现" 趋向性。人生最激荡人心的时刻，就在于自我实现的创造性过程中，产生出的一种"高峰体验"感。正因为人所固有的需求层次模型，我们才有了愿望，愿望产生目标，目标则引发计划。