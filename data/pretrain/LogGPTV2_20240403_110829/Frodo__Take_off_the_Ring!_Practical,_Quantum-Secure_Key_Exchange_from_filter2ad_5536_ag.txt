connections per second, connection time in milliseconds, and handshake size in bytes. Connection
time under load is reported as the 75th percentile value across 20 measurements. Values measured
across experiments were within 2× the reported value. All TLS ciphersuites used AES256-GCM
authenticated encryption with SHA384 in the MAC and KDF. Note that diﬀerent key exchange
methods are at diﬀerent security levels; see Table 4 for details.
(with nistp256 keys): as noted in the introduction, future quantum adversaries would be able
to retroactively decipher information protected by a non-quantum-safe key exchange, but not be
able to retroactively impersonate parties authenticated using non-quantum-safe digital signatures.
(We omit TLS-level benchmarks of Frodo-Paranoid since its microbenchmarks are similar to Frodo-
Recommended, and similarly omit SIDH since its performance is on the order of a handful of
21
LatencyThroughputLatency vs. throughput curveThroughputmeasured hereconnections per second.)
For the server, we used Apache httpd6 version 2.4.20, compiled against our customized OpenSSL
library above, and using the prefork module for multi-threading. The client and server were con-
nected over the standard data center network with a ping time of 0.62ms ± 0.02ms which did not
achieve saturation during any of our experiments.
Connections/second (throughput). Multiple client connections were generated by using the
http_load tool7 version 09Mar2016, which is a multi-threaded tool that can generate multiple http
or https fetches in parallel. We found that we could sometimes achieve better performance by
running multiple http_load processes with fewer threads in each process. For each ciphersuite mea-
sured below, Figure V shows a typical tradeoﬀ between latency (connection time) and throughput
(connections/sec). As we increase loads beyond the point at which we report throughput, there is
very little increase in connections/sec but a signiﬁcantly larger increase in mean connection time.
At this point, we posit that the bottleneck in serving TLS requests shifts to the Apache process
scheduling and request buﬀer management rather than ciphersuite performance. Our client machine
had suﬃcient power to ensure our server computer reached at least 90% CPU usage throughout the
test. Results reported are the mean of ﬁve executions, each of which was run for thirty seconds.
Connection time and handshake size. Wireshark8 was used to measure the time for the client
to establish a TLS connection on an otherwise unloaded server, measured from when the client opens
the TCP connection to when the client starts to receive the ﬁrst packet of application data, and
the size in bytes of the TLS handshake as observed. Connections were initiated using the openssl
s_client command.
We considered two scenarios in this measurement. In scenario 1, client-server connections were
initiated when the server was under no load. The results reported under the column “w/o load” in
Table 5 were the average of ten executions. In scenario 2, client-server connections were initiated
when the server was under approximately 70% CPU load (also due to concurrent TLS connections).
Connection time naturally had a larger variance under load and we report the 75th percentile results
over twenty experiments under the column “w/load” in Table 5.
Discussion. Due to HTTPS loads imposing stress on many diﬀerent parts of the system, slower
compute time of LWE compared to R-LWE (NewHope) has a much lower impact on overall perfor-
mance. This is especially true when considering hybrid ciphersuites. Our results are not necessarily
generalizable to all applications, but do provide a good indication of how TLS-based applications
with a variety of load proﬁles are aﬀected.
Since establishing a TLS connection involves several round trips as well as other cryptographic
operations, the connection times (for a server without load) for all ciphersuites we tested all range
between 12ms and 21ms, which are an order of magnitude smaller than the load times of typical
web pages, so perceived client load times will be minimally impacted in many applications. Even
under reasonable load, the increase in connection times for LWE follows similar increases across the
diﬀerent ciphersuites proﬁled.
Our key exchange does aﬀect server throughput, but the gap between LWE and R-LWE is
smaller and (naturally) decreases as page size increases. For 1 KiB pages, LWE can support 1.6×
fewer connections than R-LWE (NewHope), but this gap narrows to 1.2× fewer for 100 KiB pages,
and outperforms NTRU. When measuring server throughput with hybrid ciphersuites, the overhead
of LWE is further reduced to just about 15% for 100 KiB pages when compared to NewHope.
6http://httpd.apache.org/
7http://www.acme.com/software/http_load/
8https://www.wireshark.org/
22
While LWE does have an impact on both TLS client and server performance and on the hand-
shake size, the complex nature of TLS connections and various system bottlenecks when serving
webpages mute the perceived gap seen between LWE and R-LWE in the microbenchmarks. For
many applications, such as web browsing and secure data transfers, the LWE latency and commu-
nication size are small compared to typical application proﬁles.
Going forward, if we choose to deploy a post-quantum ciphersuite that combines LWE and
ECDHE instead of a (non-post-quantum) ECDHE ciphersuite, the additional overhead in serving
typical webpages between 10 KiB and 100 KiB will only decrease server throughput by less than a
factor of two. This might be a small price to pay for long-term post-quantum security based on
generic lattices without any ring structure, in order to avoid the possibility of attacks that this
structure gives rise to.
Acknowledgments
JB and LD were supported in part by the Commission of the European Communities through the
Horizon 2020 program under project number 645622 (PQCRYPTO). DS was supported in part by
Australian Research Council (ARC) Discovery Project grant DP130104304 and a Natural Sciences
and Engineering Research Council of Canada (NSERC) Discovery Grant. The authors would like
to thank Adam Langley, Eric Grosse, and Úlfar Erlingsson for their inputs. A large part of this
work was done when VN was an intern with the Google Security and Privacy Research team.
References
[1] D. Adrian, K. Bhargavan, Z. Durumeric, P. Gaudry, M. Green, J. A. Halderman, N. Heninger,
D. Springall, E. Thomé, L. Valenta, B. VanderSloot, E. Wustrow, S. Z. Béguelin, and P. Zimmermann.
Imperfect forward secrecy: How Diﬃe-Hellman fails in practice.
In I. Ray, N. Li, and C. Kruegel:,
editors, ACM CCS 15, pages 5–17. ACM Press, Oct. 2015.
[2] S. Agrawal, D. Boneh, and X. Boyen. Eﬃcient lattice (H)IBE in the standard model. In H. Gilbert,
editor, EUROCRYPT 2010, volume 6110 of LNCS, pages 553–572. Springer, Heidelberg, May 2010.
[3] S. Agrawal, D. Boneh, and X. Boyen. Lattice basis delegation in ﬁxed dimension and shorter-ciphertext
hierarchical IBE. In T. Rabin, editor, CRYPTO 2010, volume 6223 of LNCS, pages 98–115. Springer,
Heidelberg, Aug. 2010.
[4] M. Ajtai. Generating hard instances of lattice problems. Quaderni di Matematica, 13:1–32, 2004.
Preliminary version in STOC 1996.
[5] M. R. Albrecht, R. Player, and S. Scott. On the concrete hardness of learning with errors. Journal of
Mathematical Cryptology, 9(3):169–203, 2015.
[6] E. Alkim, L. Ducas, T. Pöppelmann, and P. Schwabe. Post-quantum key exchange - a new hope. In
USENIX Security 16. USENIX Association, 2015.
[7] B. Applebaum, D. Cash, C. Peikert, and A. Sahai. Fast cryptographic primitives and circular-secure
encryption based on hard learning problems. In S. Halevi, editor, CRYPTO 2009, volume 5677 of LNCS,
pages 595–618. Springer, Heidelberg, Aug. 2009.
[8] S. Arora and R. Ge. New algorithms for learning in presence of errors. In L. Aceto, M. Henzinger, and
J. Sgall, editors, ICALP 2011, Part I, volume 6755 of LNCS, pages 403–415. Springer, Heidelberg, July
2011.
[9] D. Augot, L. Batina, D. J. Bernstein, J. W. Bos, J. Buchmann, W. Castryck, O. Dunkelman,
T. Güneysu, S. Gueron, A. Hülsing, T. Lange, M. S. E. Mohamed, C. Rechberger, P. Schwabe,
23
N. Sendrier, F. Vercauteren, and B.-Y. Yang. Initial recommendations of long-term secure post-quantum
systems, 2015. http://pqcrypto.eu.org/docs/initial-recommendations.pdf.
[10] S. Bai, A. Langlois, T. Lepoint, D. Stehlé, and R. Steinfeld. Improved security proofs in lattice-based
cryptography: Using the Rényi divergence rather than the statistical distance. In T. Iwata and J. H.
Cheon, editors, ASIACRYPT 2015, Part I, volume 9452 of LNCS, pages 3–24. Springer, Heidelberg,
Nov. / Dec. 2015.
[11] E. Barker, W. Barker, W. Burr, W. Polk, and M. Smid. Recommendation for key management – part 1:
General (rev 3), 2012. Available at http://csrc.nist.gov/publications/nistpubs/800-57/sp800-
57_part1_rev3_general.pdf.
[12] A. Becker, L. Ducas, N. Gama, and T. Laarhoven. New directions in nearest neighbor searching with
applications to lattice sieving. In R. Krauthgamer, editor, 27th SODA, pages 10–24. ACM-SIAM, Jan.
2016.
[13] D. J. Bernstein, T. Chou, and P. Schwabe. McBits: Fast constant-time code-based cryptography. In
G. Bertoni and J.-S. Coron, editors, CHES 2013, volume 8086 of LNCS, pages 250–272. Springer,
Heidelberg, Aug. 2013.
[14] J. W. Bos, C. Costello, M. Naehrig, and D. Stebila. Post-quantum key exchange for the TLS protocol
from the ring learning with errors problem. In 2015 IEEE Symposium on Security and Privacy, pages
553–570. IEEE Computer Society Press, May 2015.
[15] J. W. Bos, M. Naehrig, and J. van de Pol. Sieving for shortest vectors in ideal lattices: a practical
perspective. International Journal of Applied Cryptography, 2016. to appear, http://eprint.iacr.
org/2014/880.
[16] Z. Brakerski, A. Langlois, C. Peikert, O. Regev, and D. Stehlé. Classical hardness of learning with
errors. In D. Boneh, T. Roughgarden, and J. Feigenbaum, editors, 45th ACM STOC, pages 575–584.
ACM Press, June 2013.
[17] Z. Brakerski and V. Vaikuntanathan. Eﬃcient fully homomorphic encryption from (standard) LWE.
SIAM Journal on Computing, 43(2):831–871, 2014.
[18] D. Cash, D. Hofheinz, E. Kiltz, and C. Peikert. Bonsai trees, or how to delegate a lattice basis. Journal
of Cryptology, 25(4):601–639, Oct. 2012.
[19] L. Chen, S. Jordan, Y.-K. Liu, D. Moody, R. Peralta, R. Perlner, and D. Smith-Tone. Report on
post-quantum cryptography. NISTIR 8105, DRAFT, 2016. http://csrc.nist.gov/publications/
drafts/nistir-8105/nistir_8105_draft.pdf.
[20] Y. Chen. Lattice reduction and concrete security of fully homomorphic encryption. PhD thesis,
l’Université Paris Diderot, 2013. Available at http://www.di.ens.fr/~ychen/research/these.pdf.
[21] Y. Chen and P. Q. Nguyen. BKZ 2.0: Better lattice security estimates. In D. H. Lee and X. Wang,
editors, ASIACRYPT 2011, volume 7073 of LNCS, pages 1–20. Springer, Heidelberg, Dec. 2011.
[22] D. Coppersmith. Finding a small root of a univariate modular equation.
In U. M. Maurer, editor,
EUROCRYPT’96, volume 1070 of LNCS, pages 155–165. Springer, Heidelberg, May 1996.
[23] D. Coppersmith and S. Winograd. Matrix multiplication via arithmetic progressions. In A. Aho, editor,
19th ACM STOC, pages 1–6. ACM Press, May 1987.
[24] C. Costello, P. Longa, and M. Naehrig. Eﬃcient algorithms for supersingular isogeny diﬃe-hellman.
In M. Robshaw and J. Katz, editors, CRYPTO 2016, Part I, volume 9814 of LNCS, pages 572–601.
Springer, Heidelberg, Aug. 2016.
[25] P. D’Alberto and A. Nicolau. Adaptive Strassen and ATLAS’s DGEMM: a fast square-matrix multiply
for modern high-performance systems. In High-Performance Computing in Asia-Paciﬁc Region, pages
45–52. IEEE Computer Society, 2005.
24
[26] M. H. Devoret and R. J. Schoelkopf. Superconducting circuits for quantum information: an outlook.
Science, 339(6124):1169–1174, 2013.
[27] T. Dierks and E. Rescorla. The Transport Layer Security (TLS) protocol version 1.2. https://tools.
ietf.org/html/rfc5246. RFC 5246.
[28] W. Diﬃe, P. C. Van Oorschot, and M. J. Wiener. Authentication and authenticated key exchanges.
Designs, Codes and cryptography, 2(2):107–125, 1992.
[29] J. Ding, X. Xie, and X. Lin. A simple provably secure key exchange scheme based on the learning with
errors problem. Cryptology ePrint Archive, Report 2012/688, 2012. http://eprint.iacr.org/2012/
688.
[30] G. Frey and H.-G. Rück. A remark concerning m-divisibility and the discrete logarithm in the divisor
class group of curves. Math. Comp., 62(206):865–874, 1994.
[31] E. Fujisaki and T. Okamoto. Secure integration of asymmetric and symmetric encryption schemes. In
M. J. Wiener, editor, CRYPTO’99, volume 1666 of LNCS, pages 537–554. Springer, Heidelberg, Aug.
1999.
[32] N. Gama, P. Q. Nguyen, and O. Regev. Lattice enumeration using extreme pruning. In H. Gilbert,
editor, EUROCRYPT 2010, volume 6110 of LNCS, pages 257–278. Springer, Heidelberg, May 2010.
[33] C. Gentry, C. Peikert, and V. Vaikuntanathan. Trapdoors for hard lattices and new cryptographic
constructions. In R. E. Ladner and C. Dwork, editors, 40th ACM STOC, pages 197–206. ACM Press,
May 2008.
[34] L. K. Grover. A fast quantum mechanical algorithm for database search. In 28th ACM STOC, pages
212–219. ACM Press, May 1996.
[35] V. Gupta, D. Stebila, S. Fung, S. C. Shantz, N. Gura, and H. Eberle. Speeding up secure web transac-
tions using elliptic curve cryptography. In NDSS 2004. The Internet Society, Feb. 2004.
[36] J. Hoﬀstein, J. Pipher, and J. H. Silverman. NTRU: A ring-based public key cryptosystem. In Algo-
rithmic number theory, pages 267–288. Springer, 1998.
[37] J. Huang, F. Qian, A. Gerber, Z. M. Mao, S. Sen, and O. Spatscheck. A close examination of performance
and power characteristics of 4G LTE networks. In The 10th International Conference on Mobile Systems,
Applications, and Services, MobiSys’12, pages 225–238, 2012.
[38] T. Jager, F. Kohlar, S. Schäge, and J. Schwenk. On the security of TLS-DHE in the standard model. In
R. Safavi-Naini and R. Canetti, editors, CRYPTO 2012, volume 7417 of LNCS, pages 273–293. Springer,
Heidelberg, Aug. 2012.
[39] A. Kawachi, K. Tanaka, and K. Xagawa. Multi-bit cryptosystems based on lattice problems.
In
T. Okamoto and X. Wang, editors, PKC 2007, volume 4450 of LNCS, pages 315–329. Springer, Heidel-
berg, Apr. 2007.
[40] J. Kelly, R. Barends, A. G. Fowler, A. Megrant, E. Jeﬀrey, T. C. White, D. Sank, J. Y. Mutus,
B. Campbell, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, I.-C. Hoi, C. Neill, P. J. J. O/’Malley,
C. Quintana, P. Roushan, A. Vainsencher, J. Wenner, A. N. Cleland, and J. M. Martinis. State
preservation by repetitive error detection in a superconducting quantum circuit. Nature, 519:66–69,
2015.
[41] P. Kirchner and P.-A. Fouque. An improved BKW algorithm for LWE with applications to cryptography
and lattices. In R. Gennaro and M. J. B. Robshaw, editors, CRYPTO 2015, Part I, volume 9215 of
LNCS, pages 43–62. Springer, Heidelberg, Aug. 2015.
[42] H. Krawczyk, K. G. Paterson, and H. Wee. On the security of the TLS protocol: A systematic analysis.
In R. Canetti and J. A. Garay, editors, CRYPTO 2013, Part I, volume 8042 of LNCS, pages 429–448.
Springer, Heidelberg, Aug. 2013.
[43] T. Laarhoven. Search problems in cryptography. PhD thesis, Eindhoven University of Technology, 2015.
25
[44] T. Laarhoven. Sieving for shortest vectors in lattices using angular locality-sensitive hashing. In R. Gen-
naro and M. J. B. Robshaw, editors, CRYPTO 2015, Part I, volume 9215 of LNCS, pages 3–22. Springer,
Heidelberg, Aug. 2015.
[45] R. Lindner and C. Peikert. Better key sizes (and attacks) for LWE-based encryption. In A. Kiayias,
editor, CT-RSA 2011, volume 6558 of LNCS, pages 319–339. Springer, Heidelberg, Feb. 2011.
[46] V. Lyubashevsky, C. Peikert, and O. Regev. On ideal lattices and learning with errors over rings.
Journal of the ACM, 60(6):43:1–35, November 2013. Preliminary version in Eurocrypt 2010.
[47] A. Menezes, S. A. Vanstone, and T. Okamoto. Reducing elliptic curve logarithms to logarithms in a
ﬁnite ﬁeld. In 23rd ACM STOC, pages 80–89. ACM Press, May 1991.
[48] D. Micciancio and C. Peikert. Hardness of SIS and LWE with small parameters. In R. Canetti and
J. A. Garay, editors, CRYPTO 2013, Part I, volume 8042 of LNCS, pages 21–39. Springer, Heidelberg,
Aug. 2013.
[49] M. Mosca. Cybersecurity in an era with quantum computers: Will we be ready? Cryptology ePrint
Archive, Report 2015/1075, 2015. http://eprint.iacr.org/2015/1075.
[50] National Security Agency (NSA). Cryptography today. https://www.nsa.gov/ia/programs/suiteb_
cryptography/, August 2015.
[51] NIST. http://www.nist.gov/itl/csd/ct/post-quantum-crypto-workshop-2015.cfm.
[52] NIST Suite B. https://www.nsa.gov/ia/programs/suiteb_cryptography/index.shtml.
[53] C. Peikert. Public-key cryptosystems from the worst-case shortest vector problem: extended abstract.
In M. Mitzenmacher, editor, 41st ACM STOC, pages 333–342. ACM Press, May / June 2009.
[54] C. Peikert. Lattice cryptography for the Internet. In M. Mosca, editor, PQCrypto 2014, volume 8772
of LNCS, pages 197–219. Springer, 2014.
[55] C. Peikert. A decade of lattice cryptography. Foundations and Trends in Theoretical Computer Science,
10(4):283–424, 2016.
[56] C. Peikert. How (not) to instantiate ring-LWE. Cryptology ePrint Archive, Report 2016/351, 2016.
http://eprint.iacr.org/2016/351.
[57] J. Proos and C. Zalka. Shor’s discrete logarithm quantum algorithm for elliptic curves. Quantum Info.
Comput., 3(4):317–344, 2003.
[58] O. Regev. On lattices, learning with errors, random linear codes, and cryptography. In H. N. Gabow
and R. Fagin, editors, 37th ACM STOC, pages 84–93. ACM Press, May 2005.
[59] O. Regev. On lattices, learning with errors, random linear codes, and cryptography. Journal of the
ACM, 56(6):34, 2009.
[60] M. Schneider. Sieving for shortest vectors in ideal lattices. In A. Youssef, A. Nitaj, and A. E. Hassanien,
editors, AFRICACRYPT 13, volume 7918 of LNCS, pages 375–391. Springer, Heidelberg, June 2013.
[61] P. Shor. Polynomial-time algorithms for prime factorization and discrete logarithms on a quantum
computer. SIAM J. Comput., 26(5):1484âĂŞ1509, 1997. Preliminary version in STOC 1994.
[62] V. Strassen. Gaussian elimination is not optimal. Numerische Mathematik, 13(4):354–356, 1969.
[63] N. Thiagarajan, G. Aggarwal, A. Nicoara, D. Boneh, and J. P. Singh. Who killed my battery?: analyzing
mobile browser energy consumption. In Proceedings of the 21st international conference on World Wide
Web, pages 41–50. ACM, 2012.
[64] W. Whyte, M. Etzel, and P. Jenney. Open source NTRU public key cryptography algorithm and
reference code. https://github.com/NTRUOpenSourceProject/ntru-crypto, 2013.
[65] J. Zhang, Z. Zhang, J. Ding, M. Snook, and Ö. Dagdelen. Authenticated key exchange from ideal
lattices. In E. Oswald and M. Fischlin, editors, EUROCRYPT 2015, Part II, volume 9057 of LNCS,
pages 719–751. Springer, Heidelberg, Apr. 2015.
26