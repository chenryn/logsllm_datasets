DailyCatch is configured to test anycast blocks (as announced by
a large, global CDN) that have been configured with the transit
and all-providers configurations described in Section 3.4. Under the
transit configuration, announcements are made to a restricted set
of transit providers, while under the all-providers configuration,
announcements are made to nearly all providers.
DailyCatch has been running in this way since August 2017.
The case studies discussed here are from comparisons made during
this period. The data is presented to demonstrate the utility of
DailyCatch, rather than provide a comprehensive measurement of
peering policies; as a result, the data is drawn from measurements
taken throughout the period that DailyCatch has been in operation.
4.2.1 Biggest Movers. First, we examine the largest (both pos-
itive and negative) scores generated by DailyCatch for a single
day during the test period. Table 2 shows the 3 largest and small-
est scores, for both North American (left), and Europe (right); we
mask AS numbers with letters to avoid revealing provider-level
operational data. Broadly, we see that the groups with high scores
tend to have higher vд values, though not exclusively (Note Z /
US-AZ). From this, we conclude that, in networks that matter most
to the CDN, the experimental configuration (i.e., announcing to
more peers) improves performance. We can split the causes of the
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Stephen McQuistin, Sree Priyanka Uppu, and Marcel Flores
NA Group
A / US-MN
B / US-CO
C / US-OR
Probes RTTtx
27.8
28.5
19.9
5
13
4
RTTall
11.4
10.9
12.2
B / US-MA
Y / US-NC
Z / US-AZ
11
2
13
11.6
26.8
21.8
15.3
145.3
27.8
vд
.015
.011
.013
Score
.008
.006
.005
...
.009 −.003
.007 −.007
.028 −.008
EU Group
D / FR
E / GB
F / IT
Probes RTTtx
198
21.0
49.6
70
60
41.3
RTTall
10.2
21.0
20.8
vд
.025
.024
.010
Score
.019
.013
.006
X / ES
W / PT
V / ES
13
11
7
9.9
16.9
7.7
13.2
40.8
37.4
.011 −.003
.004 −.004
.009 −.009
Table 2: Largest positive and negative scores for North America (NA) and Europe (EU) (from April 2018). Each row shows an
individual group, where AS numbers are masked by letters.
scores shown in Table 2 into three broad categories: catchment
shifts, path changes (but without catchment shifts), and transient,
anomalous behavior.
As shown in Section 3, the addition of peering shifts catchments:
upstream providers are likely to prefer to send traffic across a
peering link. Groups B/US-CO, C/US-OR, D/FR, E/GB, and F/IT all
see improved performance as a result of their catchments shifting
to a closer site. However, groups B/US-MA, Y/US-NC, W/PT, and
V/ES are all directed to farther away sites, and as a result, see worse
performance. DailyCatch, by subdividing ASes by country or US
state, allows us to identify that AS B sees changes in both directions;
without this, the effect would likely be averaged out and hidden.
Further, by weighting the changes by relative volume, DailyCatch
identifies the sites where the addition of peering links would be
most impactful. This targeted approach, enabled by group-level
scoring and the collection of path information, is important to
DailyCatch’s practical, operational use.
We also identified changes in routing without a shift in catch-
ment. Groups A/US-MN and Z/US-AZ see better or worse (respec-
tively) performance resulting from taking faster or slower routes
to the same site. Identifying path and catchment changes directly
informs DailyCatch’s need for traceroutes.
An artifact of our vantage point selection can be seen in the false
positive visible in Group Y/US-NC. One of the two probes sees sig-
nificantly worse performance. However, the other probe sees good
behavior on an almost identical path. Group Y/US-NC’s variation
is a result of being a small group, where a measurement from one
outlier can have a significant impact. Ultimately, we found that the
benefit in visibility gained by including small groups outweighed
the penalty of such outliers. We note, however, that the relatively
low vд weight for Y/US-NC has resulted in only a small negative
contribution. The shifts seen in other small groups (e.g., C/US-OR)
show that small groups can provide meaningful data.
In this particular example, an operator may be satisfied with
the improvements, but may consider altering the change to miti-
gate the poor performance for Z/US-AZ. By capturing a traceroute,
DailyCatch allows the operator to identify the provider that AS Z’s
traffic arrived over. If, as in this example, AS Z is a direct peer, the
announcement policy can be adjusted to not announce anycast to
AS Z. This configuration can then be re-evaluated to ensure that
there are no indirect impacts from excluding the provider. Other,
moderate impacts (to B/US-MA, for example) may be deemed ac-
ceptable, due to the group’s low relative volume.
In summary, many of the large changes shown in Table 2 result
from significant shifts in both the where and how of client behavior.
Many design decisions have also been validated: (i) subdividing by
geolocation gives us insight into the behavior of a single network
at multiple sites (e.g., AS B); (ii) small probe groups give meaningful
data (e.g., AS C); and (iii) weighting by relative volume, vд, surfaces
relevant shifts. These variations show the complexity of anycast and
provider interactions, emphasizing the importance of our sub-AS
groupings.
4.2.2 Cause of Catchment Shifts. Another comparison surfaces
from three notable positive score changes shown in Table 3. These
three groups suffer from poor site selection when relying on transit
providers, with all groups connecting to San Jose, despite a nearby
site in Denver. Manual inspection shows that this is the result of
a policy choice: the origin ASes prefer to route through a transit
provider that is not available at the Denver site. The performance
impact is clear: choosing a physically distant site inflates RTTs. In
the all-providers configuration, probes now have access to a direct
peering link, and select the better site.
This case study exposes the advantage of DailyCatch’s approach.
First, BGP collector data suggests that, in the transit configuration,
these groups of clients should route to a site in Denver. By using
active measurements, DailyCatch sees the impact of otherwise
opaque BGP policies: it is not possible to determine why the clients
do not take the available transit path, but it is sufficient to know
that they don’t. Finally, by announcing to additional peers, it is
clear that performance can be improved directly, without explicit
provider co-operation.
4.2.3 Mixed Impacts Scenarios. Figure 12 shows the difference
in RTT in groups from three large North American ASes. The
groups vary significantly in size, ranging from 4 probes to over
70, but we observe that group size doesn’t correlate with observed
performance. Impacts are not uniform within each AS, emphasizing
the need for our grouping function in showing sub-AS-level varia-
tions. For example, in the leftmost AS, clients in Colorado achieved
a nearly 13ms improvement, while clients in New Mexico had an
almost 20ms penalty: a spread of more than 30ms. Similar behaviors
are seen in the other ASes shown.
We note that groups that performed worse generally have a di-
rect path that is performing worse. Ultimately, this is caused by
providers always preferring peering links when available, which,
Taming Anycast in the Wild Internet
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Group
Probes RTTtx
35.36
45.03
35.82
21
4
3
RTTall
10.70
20.23
21.00
vд
A / US-CO
B / US-CO
A / US-UT
Denver
Denver
Denver
Table 3: Notable catchment shifts between transit and all-peers configurations.
0.0163
0.0132
0.0023
Score
0.0098
0.0066
0.0009
Catchmenttx
San Jose
San Jose
San Jose
Catchmentall
Figure 12: Change in median RTT for 3 large North American ASes. Each AS demonstrated mixed behavior across the groups.
Gray bars indicate group size and circles indicate change in RTT.
US states per AS is 1.02 in Europe, compared with 1.71 in North
America. One large provider appears in our data as no less than 6
distinct ASes. DailyCatch is agnostic to such differences, and is able
to assess changes in behavior regardless of the particular network
structure.
5 DISCUSSION
In this section, we discuss two important topics that relate to
DailyCatch’s use: how representative the RIPE Atlas platform is of
the studied CDN, and the network misconfigurations that, when
combined with the complex provider relationships discussed earlier,
make an active measurement approach a requirement for the man-
agement of many-provider anycast announcement configurations.
5.1 RIPE Atlas Representation
At the time of writing, RIPE Atlas consists of over 10, 000 globally
distributed probes. However, only 19% of IPv4 ASes seen by the
studied CDN contain at least one RIPE Atlas probe. While this is
greater than the raw AS coverage (5.958% of total ASes have at
least 1 probe at time of writing [2]), when we consider the weighted
fraction of requests from networks, we see even greater coverage:
61% of in-bound volume originates from networks with at least 1
probe.
However, this leaves a number of networks that have insufficient
coverage. To explore these networks, we consider the mismatch
between a network’s popularity as seen by the CDN, and its probe
coverage in RIPE Atlas. For a given AS, we define P as the number
of probes it contains, and v to be its relative volume defined in
Section 4.1. We then define the mismatch, M, as:
M =
1 +
ev
P
Pt ar дet
.
Figure 13: A large provider may prefer peering links that
require traveling long distances over nearby transit, often
altering catchment.
as illustrated in Figure 13, is a policy that may alter site catch-
ments, and user-experienced latency, significantly. It is important
to recognise the variations between sites: each has a different set
of upstream providers and peers, depending on announcement
configuration, business needs, and physical presence. In provid-
ing visibility into the behavior of individual groups, at specific
sites, DailyCatch generates the data necessary to address many
of the issues surfaced here, by adding peering, or reconfiguring
announcements.
For the largest European networks, 3 saw significant improve-
ments over 10ms, but none saw the mixed behavior seen in North
America. This is potentially due to a different management ap-
proach, in which many European providers appear to operate sepa-
rate ASes for each country or market. This difference is visible in
the data: in Europe we observe a total of 731 ASes, spread over 75
countries. In contrast, in North America, we observe only 107 ASes,
spread over 60 countries or US states. In Europe, 9 ASes appear in
more than one country, while in North America, 19 appear in more
than one country or US state. The average number of countries or
Site 1Site 2Peer APeer ALoc 1Loc 2Transit YIMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Stephen McQuistin, Sree Priyanka Uppu, and Marcel Flores
Figure 14: Changes in median RTT between the beacons and