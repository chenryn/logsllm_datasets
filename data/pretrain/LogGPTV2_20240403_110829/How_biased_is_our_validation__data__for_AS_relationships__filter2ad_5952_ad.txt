research space. Hence, we advocate that future efforts should be
evaluated against more diverse goals. Further, given our findings
from §4.2, we advocate for more careful and explicit handling of
spurious labels, sibling relationships, and complex relationships
during future validation efforts.
ACKNOWLEDGMENTS
We want to thank the anonymous reviewers and our shepherd,
Cecilia Testart, for their valuable comments. We further thank
Yuchen Jin and Zitong Jin for granting us access to the validation
data for ProbLink and Toposcope.
REFERENCES
[1] Lida Abdi and Sattar Hashemi. 2015. To combat multi-class imbalanced problems
by means of over-sampling techniques. IEEE transactions on Knowledge and Data
Engineering 28, 1 (2015), 238–251.
[2] AFRINIC. 2021. Extended Delegations, 20180405. https://ftp.apnic.net/stats/
afrinic/2018/delegated-afrinic-extended-20180405. (2021). Last accessed: 24th
April, 2021.
[3] Bernhard Ager, Nikolaos Chatzis, Anja Feldmann, Nadi Sarrar, Steve Uhlig, and
Walter Willinger. 2012. Anatomy of a large European IXP. In Proceedings of the
ACM SIGCOMM 2012 conference on Applications, technologies, architectures, and
protocols for computer communication. 163–174.
[4] APNIC. 2021. Extended Delegations, 20180405. https://ftp.apnic.net/stats/apnic/
2018/delegated-apnic-extended-20180405.gz. (2021). Last accessed: 24th April,
2021.
[5] APRICOT. 2021. Future APRICOTs. Available at https://www.apricot.net/. (2021).
last-accessed: Tuesday, 20th April 2021.
[6] ARIN. 2021. Extended Delegations, 20180405. https://ftp.arin.net/pub/stats/arin/
delegated-arin-extended-20180405. (2021). Last accessed: 24th April, 2021.
[7] Todd Arnold, Jia He, Weifan Jiang, Matt Calder, Italo Cunha, Vasileios Giotsas,
and Ethan Katz-Bassett. 2020. Cloud provider connectivity in the flat internet. In
Proceedings of the ACM Internet Measurement Conference. 230–246.
How biased is our Validation (Data) for AS Relationships?
IMC ’21, November 2–4, 2021, Virtual Event, USA
RFC Editor.
[8] Shehar Bano, Philipp Richter, Mobin Javed, Srikanth Sundaresan, Zakir Du-
rumeric, Steven J Murdoch, Richard Mortier, and Vern Paxson. 2018. Scanning
the internet for liveness. ACM SIGCOMM Computer Communication Review 48, 2
(2018), 2–9.
[9] Giuseppe Di Battista, Tiziana Refice, and Massimo Rimondini. 2006. How to
extract BGP peering information from the internet routing registry. In Proceedings
of the 2006 SIGCOMM workshop on Mining network data. 317–322.
[10] Timm Böttger, Felix Cuadrado, and Steve Uhlig. 2018. Looking for hypergiants
in peeringDB. ACM SIGCOMM Computer Communication Review 48, 3 (2018),
13–19.
[11] Joy Buolamwini and Timnit Gebru. 2018. Gender shades: Intersectional accu-
racy disparities in commercial gender classification. In Conference on fairness,
accountability and transparency. PMLR, 77–91.
[12] CAIDA. 2018. The CAIDA AS Relationships Dataset, 1st April 2018. https:
//publicdata.caida.org/datasets/as-relationships/. (2018).
[13] Ignacio Castro, Juan Camilo Cardona, Sergey Gorinsky, and Pierre Francois. 2014.
Remote peering: More peering without internet flattening. In Proceedings of the
10th ACM International on Conference on emerging Networking Experiments and
Technologies. 185–198.
[14] R. Chandra, P. Traina, and T. Li. 1996. BGP Communities Attribute. RFC 1997.
[15] Balakrishnan Chandrasekaran, Mingru Bai, Michael Schoenfield, Arthur Berger,
Nicole Caruso, George Economou, Stephen Gilliss, Bruce Maggs, Kyle Moses,
David Duff, et al. 2015. Alidade: Ip geolocation without active probing. Depart-
ment of Computer Science, Duke University, Tech. Rep. CS-TR-2015.001 (2015).
[16] Hyunseok Chang, Ramesh Govindan, Sugih Jamin, Scott J Shenker, and Walter
Willinger. 2004. Towards capturing representative AS-level Internet topologies.
Computer Networks 44, 6 (2004), 737–755.
[17] Nitesh V Chawla, Kevin W Bowyer, Lawrence O Hall, and W Philip Kegelmeyer.
2002. SMOTE: synthetic minority over-sampling technique. Journal of artificial
intelligence research 16 (2002), 321–357.
[18] Kai Chen, David R Choffnes, Rahul Potharaju, Yan Chen, Fabian E Bustamante,
Dan Pei, and Yao Zhao. 2009. Where the sidewalk ends: Extending the Internet
AS graph using traceroutes from P2P users. In Proceedings of the 5th international
conference on Emerging networking experiments and technologies. 217–228.
[19] Davide Chicco, Niklas Tötsch, and Giuseppe Jurman. 2021. The Matthews cor-
relation coefficient (MCC) is more reliable than balanced accuracy, bookmaker
informedness, and markedness in two-class confusion matrix evaluation. BioData
mining 14, 1 (2021), 1–22.
[20] Xenofontas Dimitropoulos, Dmitri Krioukov, Marina Fomenkov, Bradley Huf-
faker, Young Hyun, KC Claffy, and George Riley. 2007. AS relationships: Inference
and validation. ACM SIGCOMM Computer Communication Review 37, 1 (2007),
29–40.
[21] Adriano Faggiani, Enrico Gregori, Alessandro Improta, Luciano Lenzini, Valerio
Luconi, and Luca Sani. 2014. A study on traceroute potentiality in revealing the
internet as-level topology. In 2014 IFIP Networking Conference. IEEE, 1–9.
[22] Guoyao Feng, Srinivasan Seshan, and Peter Steenkiste. 2019. UNARI: an
uncertainty-aware approach to AS relationships inference. In Proceedings of
the 15th International Conference on Emerging Networking Experiments And Tech-
nologies. 272–284.
[23] Alberto Fernández, Salvador Garcia, Francisco Herrera, and Nitesh V Chawla.
2018. SMOTE for learning from imbalanced data: progress and challenges, mark-
ing the 15-year anniversary. Journal of artificial intelligence research 61 (2018),
863–905.
[24] Lixin Gao. 2001. On inferring autonomous system relationships in the Internet.
IEEE/ACM Transactions on networking 9, 6 (2001), 733–745.
[25] Phillipa Gill, Michael Schapira, and Sharon Goldberg. 2013. A survey of interdo-
main routing policies. ACM SIGCOMM Computer Communication Review 44, 1
(2013), 28–34.
[26] Vasileios Giotsas, Matthew Luckie, Bradley Huffaker, and KC Claffy. 2014. Infer-
ring complex AS relationships. In Proceedings of the 2014 Conference on Internet
Measurement Conference. 23–30.
[27] Vasileios Giotsas, Matthew Luckie, Bradley Huffaker, and Kc Claffy. 2015. IPv6
AS relationships, cliques, and congruence. In International Conference on Passive
and Active Network Measurement. Springer, 111–122.
[28] Vasileios Giotsas, Shi Zhou, Matthew Luckie, and Kc Claffy. 2013.
Inferring
multilateral peering. In Proceedings of the ninth ACM conference on Emerging
networking experiments and technologies. 247–258.
[29] Enrico Gregori, Alessandro Improta, Luciano Lenzini, Lorenzo Rossi, and Luca
Sani. 2014. A novel methodology to address the internet as-level data incom-
pleteness. IEEE/ACM Transactions on Networking 23, 4 (2014), 1314–1327.
[30] Haibo He, Yang Bai, Edwardo A Garcia, and Shutao Li. 2008. ADASYN: Adaptive
synthetic sampling approach for imbalanced learning. In 2008 IEEE international
joint conference on neural networks (IEEE world congress on computational intelli-
gence). IEEE, 1322–1328.
[31] J. Heitz, J. Snijders, K. Patel, I. Bagdonas, and N. Hilliard. 2017. BGP Large
Communities Attribute. RFC 8092. RFC Editor.
618
[32] Bradley Huffaker, Amogh Dhamdhere, Marina Fomenkov, et al. 2010. Toward
topology dualism: improving the accuracy of as annotations for routers. In In-
ternational Conference on Passive and Active Network Measurement. Springer,
101–110.
[33] B. Huffaker, K. Keys, M. Fomenkov, and K. Claffy. [n. d.]. AS-to-Organization
Dataset. http://www.caida.org/research/topology/. ([n. d.]). data range used:
20180401.
[34] IANA. 2021. Autonomous System (AS) Numbers. Available at https://www.iana.
org/assignments/as-numbers/as-numbers.xhtml. (2021). last-accessed: Tuesday,
22nd April 2021.
[35] Yunchen Jin. 2019. ProbLink. GitHub repository: https://github.com/YuchenJin/
ProbLink. (2019).
[36] Yuchen Jin, Colin Scott, Amogh Dhamdhere, Vasileios Giotsas, Arvind Krish-
namurthy, and Scott Shenker. 2019. Stable and Practical {AS} Relationship
Inference with ProbLink. In 16th {USENIX} Symposium on Networked Systems
Design and Implementation ({NSDI} 19). 581–598.
[37] Ziting Jin. 2020. TopoScope. GitHub repository: https://github.com/Zitong-
Jin/TopoScope. (2020).
[38] Zitong Jin, Xingang Shi, Yan Yang, Xia Yin, Zhiliang Wang, and Jianping Wu.
2020. TopoScope: Recover AS Relationships From Fragmentary Observations. In
Proceedings of the ACM Internet Measurement Conference. 266–280.
[39] T. King, C. Dietzel, J. Snijders, G. Doering, and G. Hankins. 2016. BLACKHOLE
Community. RFC 7999. RFC Editor.
[40] Thomas Krenc and Anja Feldmann. 2016. BGP prefix delegations: a deep dive. In
Proceedings of the 2016 Internet Measurement Conference. 469–475.
[41] LACNIC. 2021. Extended Delegations, 20180405. https://ftp.lacnic.net/pub/stats/
lacnic/delegated-lacnic-extended-20180405. (2021). Last accessed: 24th April,
2021.
[42] Aemen Lodhi, Natalie Larson, Amogh Dhamdhere, Constantine Dovrolis, and
Kc Claffy. 2014. Using peeringDB to understand the peering ecosystem. ACM
SIGCOMM Computer Communication Review 44, 2 (2014), 20–27.
[43] Matthew Luckie, Bradley Huffaker, Amogh Dhamdhere, Vasileios Giotsas, and
KC Claffy. 2013. AS relationships, customer cones, and validation. In Proceedings
of the 2013 conference on Internet measurement conference. 243–256.
[44] MANRS. 2021. About MANRS. Available at https://www.manrs.org/about/. (2021).
last-accessed: Tuesday, 20th April 2021.
[45] Pedro Marcos, Lars Prehn, Lucas Leal, Alberto Dainotti, Anja Feldmann, and
Marinho Barcellos. 2020. AS-Path Prepending: there is no rose without a thorn.
In Proceedings of the ACM Internet Measurement Conference. 506–520.
[46] Alexander Marder, Matthew Luckie, Amogh Dhamdhere, Bradley Huffaker, KC
Claffy, and Jonathan M Smith. 2018. Pushing the boundaries with bdrmapit: Map-
ping router ownership at Internet scale. In Proceedings of the Internet Measurement
Conference 2018. 56–69.
[47] Tyler McDaniel, Jared M Smith, and Max Schuchard. 2020. Flexsealing BGP
against route leaks: peerlock active measurement and analysis. arXiv preprint
arXiv:2006.06576 (2020).
[48] Tyler McDaniel, Jared M Smith, and Max Schuchard. 2021. Peerlock: Flexsealing
[49] Reynaldo Morillo, Justin Furuness, Amir Herzberg, Cameron Morris, Bing Wang,
and James Breslin. 2021. ROV++: Improved deployable defense against BGP
hijacking. NDSS.
[50] Lucas Müller, Matthew Luckie, Bradley Huffaker, Kc Claffy, and Marinho Barcel-
los. 2019. Challenges in inferring spoofed traffic at IXPs. In Proceedings of the 15th
International Conference on Emerging Networking Experiments and Technologies.
96–109.
[51] NANOG. 2021. Future NANOG Meetings. Available at https://www.nanog.org/
meetings/future/. (2021). last-accessed: Tuesday, 20th April 2021.
[52] Ricardo Oliveira, Dan Pei, Walter Willinger, Beichuan Zhang, and Lixia Zhang.
2009. The (in) completeness of the observed Internet AS-level structure.
IEEE/ACM Transactions on Networking 18, 1 (2009), 109–122.
[53] Cathy O’Neil. 2016. Weapons of math destruction: How big data increases inequality
and threatens democracy (first edition ed.). Crown, New York.
[54] Alice B Popejoy and Stephanie M Fullerton. 2016. Genomics is failing on diversity.
Nature News 538, 7624 (2016), 161.
[55] Lars Prehn, Franziska Lichtblau, and Anja Feldmann. 2020. When wells run dry:
the 2020 IPv4 address market. In Proceedings of the 16th International Conference
on emerging Networking EXperiments and Technologies. 46–54.
[56] RADB. 2021. Query for AS3356. Available at https://www.radb.net/query?
keywords=AS3356. (2021).
last-accessed: Tuesday, 22nd April 2021, Internet
Archive snapshot: https://web.archive.org/web/20210422074619/https://www.
radb.net/query?keywords=AS3356.
[57] RIPE. 2021. Meetings and Events. Available at https://www.ripe.net/participate/
meetings. (2021). last-accessed: Tuesday, 20th April 2021.
[58] RIPE NCC. 2021. Extended Delegations, 20180405. https://ftp.apnic.net/stats/ripe-
ncc/2018/delegated\T1\textemdashripencc-extended-20180405.bz2. (2021). Last
accessed: 24th April, 2021.
[59] Pavlos Sermpezis, Vasileios Kotronis, Petros Gigis, Xenofontas Dimitropoulos,
Danilo Cicalese, Alistair King, and Alberto Dainotti. 2018. ARTEMIS: Neutralizing
BGP. NDSS.
IMC ’21, November 2–4, 2021, Virtual Event, USA
Prehn, Lars and Feldmann, Anja
IEEE/ACM Transactions on Networking 26, 6
(8) the relative difference in transit degree between the incident
ASes
ASes
are present
(9) the relative difference in PPDC size between the incident
(10) and the number of common IXPs where both incident ASes
(11) and the number of common peering facilities where both
(12) how the incident ASes behave, e.g., BGP serial hijackers [61]
incident ASes are present
vs MANRS participants [44]
BGP hijacking within a minute.
(2018), 2471–2486.
[60] Lakshminarayanan Subramanian, Sharad Agarwal, Jennifer Rexford, and Randy H
Katz. 2002. Characterizing the Internet hierarchy from multiple vantage points.
In Proceedings. Twenty-First Annual Joint Conference of the IEEE Computer and
Communications Societies, Vol. 2. IEEE, 618–627.
[61] Cecilia Testart, Philipp Richter, Alistair King, Alberto Dainotti, and David Clark.
2019. Profiling BGP serial hijackers: capturing persistent misbehavior in the
global routing table. In Proceedings of the Internet Measurement Conference. 420–
434.
[62] Martino Trevisan, Danilo Giordano, Idilio Drago, Maurizio Matteo Munafò, and
Marco Mellia. 2020. Five years at the edge: Watching internet from the isp
network. IEEE/ACM Transactions on Networking 28, 2 (2020), 561–574.
[63] Wikipedia. 2021. List of Tier 1 networks. (2021). Available at https://en.wikipedia.
org/wiki/Tier_1_network Last accessed: March 30th, 2021.
[64] Florian Wohlfart, Nikolaos Chatzis, Caglar Dabanoglu, Georg Carle, and Walter
Willinger. 2018. Leveraging interconnections for performance: the serving in-
frastructure of a large CDN. In Proceedings of the 2018 Conference of the ACM
Special Interest Group on Data Communication. 206–220.
A DOES PERFORMANCE CORRELATE WITH
VALIDATION COVERAGE?
Some of the link classes for which the inference algorithms perform
poorly have a higher validation coverage. In this section, we show
that there is no correlation between these two metrics. We set
up the following experiment: We uniformly sample a subset of
relationships and track their evaluation performance using the
metrics discussed in §6. We vary the subset size between 50 % and
99 % of the original set size by increments of 1 %. To get a more
stochastically robust result, we repeat this process 100 times for
each sample size. While we have done this analysis for all link
classes mentioned in §5, we now discuss the results for the 𝑇 1 −
𝑇 𝑅 class as it produced low-performance results while containing
more than 600 peering relationships. Figure 4, 5, and 6 show the
sample size on the x-axis against the precision (𝑃𝑃𝑉𝑃), recall (𝑇 𝑃𝑅𝑃),
and MCC on the y-axis. While the figures mark the individual
performance measurements for each sampled set with a cross, they
also show the interquartile-range (IQR) and median across all 100
sampled sets. Even though we observe that the variance increases
with decreasing sample size, we neither observe an increasing nor
a decreasing trend for the performance metrics. Notably, the other
link classes (not shown) allow for similar conclusions.
B PLOTS FOR ALTERNATIVE METRICS
Figures 7, 8, and 9 show alternate variants of figure 3 for the cus-
tomer cone size (CCS), CCS when ignoring links incident to route
collector peers (i.e., vantage point ASes), and the node degree.
C POTENTIAL FEATURES
The following per-link metrics might help to identify additional
groups of ’hard links’:
(1) visibility over time
(2) number of prefixes redistributed via link
(3) number of addresses covered by those prefixes
(4) number of prefixes originated through the link
(5) number of addresses covered by those prefixes
(6) number of ASes that can observe (i.e., occur left from) the
(7) number of ASes that might receive traffic via (i.e., occur right
link
from) the link
619
How biased is our Validation (Data) for AS Relationships?
IMC ’21, November 2–4, 2021, Virtual Event, USA
Figure 4: Correlation Analysis: Preci-
sion (P2P) for randomly drawn subsets of
𝑇 1 − 𝑇 𝑅 links with increasing size.
Figure 5: Correlation Analysis: Recall
(P2P) for randomly drawn subsets of 𝑇 1−𝑇 𝑅
links with increasing size.
Figure 6: Correlation Analysis: MCC for
randomly drawn subsets of 𝑇 1−𝑇 𝑅 links with
increasing size.
Figure 7: Customer Cone Imbalance for
transit links
Figure 8: Customer Cone Imbalance for
transit links (ignoring links with inci-
dent Route Collector Peers)
Figure 9: Node degree Imbalance for
transit links
620
5060708090100randomsamplesize(percentage)0.810.820.830.840.850.860.87PPVPMedianIQR5060708090100randomsamplesize(percentage)0.930.940.950.960.97TPRPMedianIQR5060708090100randomsamplesize(percentage)0.860.870.880.890.900.91MCCMedianIQR153045Smaller PPDC sizeInference250500750Larger PPDC size153045Validation0.0050.050.100.150.200.25Fraction of links153045Smaller PPDC sizeInference250500750Larger PPDC size153045Validation0.0050.050.100.150.20Fraction of links50100150Smaller Node DegreeInference50010001500Larger Node Degree50100150Validation0.0050.0150.0300.045Fraction of links