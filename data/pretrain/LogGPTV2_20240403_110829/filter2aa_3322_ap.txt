无线电通信攻防等能力于一体的网络攻击手段。不同于传统的网络攻
击渗透“边界”受限于常见的Web平台、系统应用、防火墙网关等外部
接口，攻击者只能从“边界”外部开展攻击，近源攻击中攻击者位于
目标附近或建筑内部，攻击也是从目标“内部”发起的。目标内部常
常存在更多的安全盲点，比如各类无线通信网络、物理接口或智能终
端设备等，攻击者可以利用这些安全盲点更加隐蔽地突破目标安全防
线进入内网，最终实现对目标网络的深度渗透。实战攻防演练中，蓝
队主要通过乔装、社会工程学攻击等方式实地物理侵入企业的办公区
域，从被攻击目标内部的各种潜在攻击面（如Wi-Fi网络、RFID门禁、
暴露的有线网口、USB接口等）找到突破口，并以隐蔽的方式对攻击结
果进行验证，由此证明目标网络安全防护存在漏洞。常用的攻击方式
有以下两种。
（1）Wi-Fi边界突破
现在Wi-Fi网络在办公区使用比较普遍，可以利用目标办公区附近
的Wi-Fi网络，通过无线设备和工具抓取Wi-Fi通信数据包，重点对有
Wi-Fi安全认证访问的数据进行解码分析，破解其认证信息，从而获取
Wi-Fi网络接入权限；或者通过伪造热点（如用相似名字暗示），利用
伪造的热点更强的信号或通过攻击真实Wi-Fi路由使其瘫痪，从而诱骗
内部人员连接伪造的热点，窃取目标人员的Wi-Fi凭证。
（2）乔装侵入
乔装侵入就是利用目标的安全监管漏洞，假冒目标内部人员进入
目标办公区，在目标内部寻找暴露的有线网口、智能终端设备、无人
监管主机等可能具有内网连接条件的设备，通过这些网口或设备接入
目标内网实施攻击渗透。比如：通过暴露的网口可以直接连接电脑，
很有可能可以接入目标内网；智能终端设备多留有USB接口，可以借助
此类接口进行恶意代码植入；无人监管主机可以通过授权验证绕过漏
洞进行控制，直接进入内网。
下面来看一个实战攻防演练中比较典型的例子。某目标网络攻防
演练任务中，攻击者以参会名义假冒参会人员进入目标办公区会场，
在会场的某张桌子下发现暴露的LAN口，直接连接笔记本电脑后可扫描
内网网段，利用漏洞控制网络管理平台，进一步将其作为跳板渗透拓
展。
第4章 蓝队攻击的必备能力
开展网络渗透对蓝队人员的岗位技能和动手能力都有较高的要
求，这些能力要求侧重于攻防实战，是蓝队人员综合能力水平的体
现。因为蓝队人员在实战攻防演练中面对的是十分契合真实网络条件
的环境，各项技能与手段都需要在实战中得到实践运用，所以对蓝队
人员的能力要求与对传统网络安全的能力要求有一定的区别。同时，
蓝队能力综合了漏洞挖掘、攻击开发、代码调试、侦破拓展多个方
面，根据蓝队人员技术专长、能力水平、技能掌握难易程度等不同情
况，蓝队能力有基础能力、进阶能力和高阶能力之分。
4.1 实战化能力与传统能力的区别
由于实战攻防演练是对真实黑客攻防过程进行模拟和再现，因此
也要求蓝队成员在攻击过程中所使用的战术手法能够达到甚至超过黑
产组织或APT组织的攻击水平。与传统的漏洞挖掘人才能力要求不同，
实战化能力要求蓝队成员具备在真实的业务系统上，综合利用各种技
术和非技术手段进行动态实战攻防的能力。具体来说，实战化能力主
要有以下几个特点。
（1）针对业务系统，而非IT系统
传统或一般的漏洞挖掘工作主要针对的是各类IT信息系统本身或
系统中的设备、协议等，如各类Web系统、操作系统、PC终端、IoT设
备、工业协议、区块链协议等；而实战攻防演练工作的核心目标是发
现和解决由网络安全问题引发的业务安全及生产安全问题，攻击过程
针对的是实际运行中的业务系统或生产设备。
此外，传统的漏洞挖掘工作主要关注的是对单一系统的单点突
破。实战攻防演练更多关注的则是多个系统并存的复杂体系，是复杂
体系在运行、管理过程中存在的安全隐患。对于多数大中型政企机构
来说，内部存在几十上百个不同的信息化系统的情况是非常普遍的。
（2）漏洞挖掘只是辅助，攻击必须有效
单纯的漏洞挖掘工作，一般只需证明漏洞的存在，提交漏洞报告
即可。但在实战化的业务环境中，存在漏洞不等于能够实现有效的攻
击。一方面，这是因为漏洞的实际触发可能依赖于诸多条件，这些条
件在实际的业务环境中未必具备；另一方面，即便漏洞是有效的，但
如果蓝队只能实现单点突破，而无法达到预设的最终目标，同样不能
完成有效的攻击。
（3）攻击是个过程，允许社会工程学方法
对单一漏洞进行挖掘和利用，往往只能实现某个局部的技术目
标。但事实上，在绝大多数的实战攻防演练中，蓝队需要连续突破多
个外围系统或关联系统，才能最终达成计划中的攻击目标。也就是
说，蓝队需要掌握一系列漏洞，并能够对机构内部的IT架构、运行管
理机制进行有效分析，才有可能找到有效的攻击路径，实现实战攻防
演练环境下的有效攻击。事实上，在实战攻防演练中，蓝队一方可能
需要连续数日，多人协作才能完成一整套攻击。
此外，一般的漏洞挖掘或渗透测试是不允许使用社会工程学方法
的。但在实战化环境下，社会工程学是必不可少的攻击手法，因为真
实的攻击者一定会使用这项技能。事实上，以人为突破口，往往是实
战攻防演练中攻击方的优选。
（4）动态攻防环境，有人运行值守
单纯的漏洞挖掘工作一般不需要考虑攻防过程，也就是说不需要
考虑人的参与。但在实战攻防演练中，防守方红队实际上是有专业团
队在进行安全运行维护和24小时值守工作的。攻击方蓝队一旦开始行
动，就有可能被防守方发觉。而防守方一旦发现入侵行为，也会采取
各种反制措施、诱捕行动及攻击溯源。所以，实战化能力就要求蓝队
成员必须掌握一定的身份隐藏技能，掌握匿名网络、免杀技术、权限
维持等各种安全对抗技术。
4.2 实战化蓝队人才能力图谱
实战化蓝队人才能力可以分为不同的级别和类型。在本书中，我
们主要综合考虑了掌握技能的难易程度、市场人才的稀缺程度及实战
化能力的有效性这三方面的因素，将蓝队的实战化能力从低到高依次
分为基础能力、进阶能力和高阶能力。
（1）掌握技能的难易程度
不同的能力，学习和掌握起来难易程度不同。而技能的难易程度
是能力定级的首要因素。例如，Web漏洞利用相对容易，而Web漏洞挖
掘要困难一些，系统层漏洞的挖掘则更为困难，所以这三种能力也就
分别被列入基础能力、进阶能力和高阶能力。
（2）市场人才的稀缺程度
人才的稀缺程度也是能力定级的重要参考因素。例如，在蓝队一
方，掌握系统层漏洞利用的人只有1成左右；在iOS系统中，会编写PoC
或EXP的人员也相对少见。因此，这些能力就被归入了高阶能力。
（3）实战化能力的有效性
总体而言，越是高阶的能力防守方就越难以防御和发现，其在实
战攻防演练中发挥实效的概率也就越大。
接下来说分类问题。从不同的视角出发，可以对实战化能力进行
不同的分类。而本书所采用分类方法主要考虑了以下几个因素。
·只对实战化过程中最主要、最实用的能力进行分类，边缘技能
暂未列入分类。
·不同的能力分类之间尽量不交叉。
·分类与分级兼顾，同一领域的不同能力，如果分级不同，则作
为不同的分类。
·将挖掘、利用、开发、分析等能力作为不同的技能来分类。比
如，同样是对于Web系统，漏洞利用、漏洞挖掘、开发与编程都是不同
的能力分类。
以前述分级与分类原则为基础，本书将实战化蓝队人才能力分为3
个级别、14类、85项具体技能。其中，基础能力2类20项，进阶能力4
类23项，高阶能力8类42项，如图4-1所示。
图4-1 实战化蓝队人才能力图谱
4.2.1 基础能力
基础能力主要包含Web漏洞利用能力和基础安全工具利用能力两
类。
（1）Web漏洞利用能力
Web漏洞利用能力即利用Web系统或程序的安全漏洞实施网络攻击
的能力。由于Web系统是绝大多数机构业务系统或对外服务系统的构建
形式，所以Web漏洞利用也是最常见、最基础的网络攻击形式之一。在
实战攻防演练中，蓝队常用的Web漏洞形式有命令执行、代码执行、解
析漏洞、XSS、弱口令、文件上传、SQL注入、逻辑漏洞、信息泄露、
配置错误、反序列化、权限绕过等。
（2）基础安全工具利用能力
主要包括Burp Suite、sqlmap、AppScan、AWVS、Nmap、
Wireshark、MSF、Cobalt Strike等基础安全工具的利用能力。熟练的
工具利用能力是高效开展渗透工作的保障。
4.2.2 进阶能力
进阶能力主要包括Web漏洞挖掘、Web开发与编程、编写PoC或EXP
等利用、社工钓鱼四类。
（1）Web漏洞挖掘
Web漏洞挖掘能力主要是对Web系统或软件进行漏洞挖掘的能力。
在蓝队挖掘的Web应用漏洞中，比较常见的漏洞形式有命令执行、代码
执行、解析漏洞、XSS、弱口令、文件上传、SQL注入、逻辑漏洞、信
息泄露、配置错误、反序列化、权限绕过等。
（2）Web开发与编程
掌握一门或几门编程语言，是蓝队人员深入挖掘Web应用漏洞、分
析Web站点及业务系统运行机制的重要基础能力。在实战攻防演练中，
蓝队最常遇到、需要掌握的编程语言有Java、PHP、Python、C/C++、
Go等。
（3）编写PoC或EXP等利用
PoC是Proof of Concept的缩写，即概念验证，特指为了验证漏洞
存在而编写的代码。有时也被用作0day、Exploit（漏洞利用）的别
名。
EXP是Exploit的缩写，即漏洞利用代码。一般来说，有漏洞不一
定有EXP，而有EXP，就肯定有漏洞。