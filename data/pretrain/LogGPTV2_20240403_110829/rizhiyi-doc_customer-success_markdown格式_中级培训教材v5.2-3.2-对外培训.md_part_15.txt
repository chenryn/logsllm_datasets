看出对网站路径，不同IP地址访客的访问偏好:
3-155
日志学院
即使不调整SPL语句，也可以通过手动调整X轴字段设置和分组字段设置来达到相同的效
果。此外，X轴还有更细节的展示效果控制:
对于可能出现乱序的统计数据，可以在X轴设置里，强制要求绘图之前再次排序。
曲线图是两个数据点之间用直线连接起来，为了追求美观或特殊的效果，还可以如上图将两
点之间用曲线连接，这种图又叫平滑曲线图。平滑曲线图与折线图用法相同，只是每个数据
点之间的绘制是曲线的。在日志易中，点击设置，开启Y轴平滑选项即可：
3-156
日志学院
在日志易中，会尽力自动换算折线图Y轴的刻度范围，但用户依然可以自行指定自己所期
望的Y轴刻度范围。
上图中，就强制指定了Y轴最大值设置为500。
此外，用户还可以自行指定 Y 轴标记值的单位，比如"°C","bps"等。字符最多不超过4个字
节。除了Y轴设置，图例的展示位置也可以按需调整。日志易支持三种方式:
 不展示
 底部展示
 右侧展示
建议不要绘制4条以上的折线。如下图错误的示例，线都折叠在一起并且又没有明显的对比，
整张图表就会混乱并难以阅读。
 展示曲线图的数据时，要避免刻意的歪曲趋势。如下图，左图过于扁平化掩盖了想传达
的信息，右图过于夸大趋势。要根据展示数据波动的参考单位，做有意义的波动分析。
正确的数据高度是线约占Y轴高度的2/3。
面积图
面积图与曲线图很相近，都可以用来展示随着连续时间的推移数据的变化趋势。区别在于，
面积图在折线与类别数据的水平轴（即X轴）之间填充颜色，形成一个区域面积，来表示
数据体积。相对于折线而言，被填充的区域可以更好的引起人们对总值趋势的注意，所以面
积图主要用于传达趋势的大小，而不是确切的单个数据值。日志易中，区域图的配置方式与
折线图配置方式相同，您可以按需无缝切换成区域图模式：
3-157
日志学院
 面积图要用填充区域来展示数据，当图表上有多个图层时，要尽量确保数据不要重叠；
 面积图适合用来展示二到三组数据，建议最多不要展示超过四组数据系列，数据系列过
多会导致无法数据辨识，因此要避免在需要比较多个类别和确切的数据值的情况下使用
面积图。超过三个系列的非堆叠面积图表是很难阅读的；
 当数据值相距很远时，区域是模糊不清的，此时不太适合使用面积图展示。
堆叠面积图
堆积面积图是一种特殊的面积图，可以用来比较在一个区间内的多个变量。堆叠面积图和面
积图的区别在于，其每个数据系列的起点都是基于前一个数据系列绘制的，也就是每度量一
行就要填满行与行之间的区域。
如果有多个数据序列，并想分析每个类别的部分到整体的关系，展示部分量对于总量的贡献
时，使用堆积面积图是非常合适的。例如显示某个设备对集群流量负载的分时贡献。
日志易中，您只需要在普通面积图的分组设置中，开启堆叠效果即可：
3-158
日志学院
 图表有重叠的数据时，类别数量越多，重叠越多，因此可见度越低。使用面积图时会因
为相互重叠而无法阅读。这类数据，换成使用堆叠面积图展示，则相对更容易阅读；
 虽然多数据系列时堆叠面积图比面积图有更好的展示效果，但依然不建议堆叠面积图
中包含过多数据系列（最好不要多于7个），以免数据难以辨识；
 堆积面积图要展示部分和整体之间的关系，所以不能用于包含负值的数据的展示。
散点图
散点图在直角坐标系显示数据的两个变量（X和Y轴）之间的关系，数据显示为点的集合，
适合用于在不考虑时间的情况下比较大量的数据点。散点图通常用来识别两个变量之间的相
关性或用来观察他们的关系，从而发现某种趋势，对于查找异常值或理解数据分布也很有效。
散点图会显示不同类型的相关性，相关性即变量之间的关系。通常有正相关、负相关、不相
关三种相关性：
• 正相关：数据点从低x、y 值的点到高x、y 值，一个变量增加，另一个变量增加；
• 负相关：数据点从高x、y 值的点到低x、y 值，一个变量增加，另一个变量减少；
• 不相关：数据没有明显的方向性，一个变量变化对另一个没有影响。
3-159
日志学院
需要注意的是，散点图能够有效的说明两个变量之间的相关性，但是并不能有力地证明其中
存在因果关系。例如广告投放量和点击率是正相关的，但是不能说点击率高一定是因为广告
投放量多造成的。但是，如果有明显的正相关性，就有足够的理由去增加投放量，然后再去
观察数据。
在日志易中，散点图的配置方式与折线图配置方式相同，您可以按需无缝切换成散点图模式：
散点图可以设置气泡大小，选择字段，从而不同的字段值展示的气泡大小不同。
 如果一个散点图没有显示变量之间的任何关系，那么或许该图表类型不是此数据的最
佳选择；
 只有当你有足够多的数据点，并且数据之间有相关性时散点图才能呈现很好的结果。如
果你只有极少的信息或者数据间没有相关性，那么绘制一个很空的散点图和不相关的散
点图都是没有意义的。
3-160
日志学院
柱状图
柱状图是最常见的图表类型，使用水平或垂直的柱子来显示不同类别之间的数值。柱状图的
一个轴显示正在比较的类别，而另一个轴代表对应的刻度值。
柱状图的柱是垂直方向的，如果改为水平方向的，又称条形图。条形图与柱状图表达数据的
形式是一样的，不过，当图表的数据标签很长或者有超过10 个项目进行比较时，横向柱状
图会无法完全显示完标签，或者倾斜展示影响美观，所以，当标签过长时使用条形图可以获
得比较好的展示效果。条形图在日志易中的配置方式见稍后章节。
日志易中，柱状图的配置方式与折线图配置方式类似，您可以按需无缝切换成柱状图模式。
 Y轴数据应该从0 基线开始，以恰当地反映数值。如果展示的是被截断的数据，那可能
会误导观众做出错误的判断。
分组柱状图
分组柱状图也被称为聚集柱状图。当两个或多个数据序列并排显示并在同一轴上的类别下分
组时，将使用分组柱状图。分组柱状图相当于包含带有两个或更多图表的简单的柱状图。
分组柱状图通常是用于将分组变量或类别与具有相同变量或类别类型的其他组进行比较。像
柱状图一样，每个柱的长度用于显示类别之间的数值比较，每个数据系列被分配一个单独的
颜色或相同色系的不同饱和度以区分它们。分组柱状图每组数据间相互间隔。
在日志易中，选择单个分组字段后的效果，将自动采用分组柱状图方式。比如:
3-161
日志学院
 如果每个分组中拥有的系列过多，数据的阅读难度就会越增加，因此不建议在分组柱状
图中包含过多的系列组。在系列较多时，可考虑使用堆叠柱状图。
堆叠柱状图
堆叠柱状图是柱状图的扩展，不同的是，柱状图的数据值为并行排列，堆叠柱图则是一个个
叠加起来的。它可以展示每一个分类的总量，以及该分类包含的每个小分类的大小及占比，
因此非常适合处理部分与整体的关系。
与饼图显示单个部分到整体的关系不同的是，堆叠柱状图可以显示多个部分到整体的关系。
例如一个班级体育课选课的各项目人数统计，你可以用柱状图或饼图展示。但是当需要进一
步区分男生和女生参与到不同项目中的人数分别是多少，那就需要把每个项目中包含的男生
数和女生数都展示出来。如图用堆叠柱状图，不仅能显示每个项目的总人数，还能分析每个
项目中的一部分与整体的关系。
日志易中，可以点开柱状图分组设置，切换分组效果为堆叠效果:
3-162
日志学院
日志易中，柱状图可以支持两个分组字段。这时候，可以绘制带有堆叠效果的分组柱状图。
如下图所示，第一个字段采用普通分组效果，第二个字段采用堆叠效果。
如果反过来，第一个字段采用堆叠效果，第二个字段采用普通分组效果，则结果如下图。注
意：图例文字内容也发生了变化。
3-163
日志学院
 堆叠柱状图不适合用于对比不同分组内同个分类数据的大小；
 最好的做法是每个组只使用两到三个类别，因为太多会使数据中的模式变得非常困难；
 由于要分析部分数据在整体中的占比，因此要避免用堆叠柱状图展示包含负数的数据。
维度
作为维度类图型，自动配置的两个参数及默认的字段取值规则：
1. 数值：取第一个统计数值
2. 切分（可添加）取第一个分组字段
维度类图型包括以下几种：
饼图：饼图主要用于展现不同类别数值相对于总数的占比情况；
玫瑰图：与饼图相似，但更适合展现数据季节性（或维度性）的变化；
条形图：适用于分组数目较多、字段值名称较长的场景，可设置lable标签，使字段名显示
在条形图上；
旭日图：多个分组进行饼图展示。
饼图
饼图主要用于展现不同类别数值相对于总数的占比情况。图中每个分块（扇区）的弧长表示
该类别的占比大小，所有分块数据总和为100%。
*|statscount(apache.clientip)asip_countbyapache.clientip|sortbyip_count
例如：针对上面的搜索结果，鼠标点击“饼状图”，展示字段选择“ip_count”，分组字段选择
“apache.clientip”，点击生成统计图，即看到：
3-164
日志学院
用户可以添加数据集中的一到多个字段进行二次分组转换，达到理想的可视化效果。
虽然饼图能快速有效地展示数据的比例分布，并被广泛用于各个领域，但是饼图及其变形图
表一直是比较受争议的图表。因此，我们在使用饼图及其变形图表时一定要谨慎并避免走进
误区。
 饼图适合用来展示单一维度数据的占比，要求其数值中没有零或负值，并确保各分块占
比总和为100%。
 我们很难比较一个分块过多的饼图的数据，建议尽量将饼图分块数量控制在五个以内。
当数据类别较多时，我们可以把较小或不重要的数据合并成第五个模块命名为"其它"。
如果各类别都必须全部展示，此时选择柱状图或堆积柱状图或许更合适。
 饼图不适合被用于精确数据的比较，因此当各类别数据占比较接近时（如下左图），我
们很难对比出每个类别占比的大小。此时建议选用柱状图或南丁格尔玫瑰图（如下右图）
来获取更好的展示效果。玫瑰图的使用方法，请阅读稍后章节。
3-165
日志学院
饼图可以设置label展示数据的详细程度：
玫瑰图
玫瑰图，又叫极区图、鸡冠花图，是南丁格尔护士在推动医事改良过程中，为了表达军医院
季节性的死亡率而发明的。其与普通饼图的区别在于：普通饼图采用扇形角度来表达大小，
而玫瑰图采用扇形面积来表达大小，更有利于突出视觉差距。
日志易中，您可以按需无缝切换饼图成玫瑰图模式。比如上例的统计，玫瑰图效果如下:
3-166
日志学院
相比较而言，玫瑰图大小差异就比较明显。
条形图
日志易中条形图与饼图配置方式相同，可以按需无缝切换成条形图模式：
如上图所示效果，也验证了前文已经提到过的使用建议，条形图比较适于分组数目较多，字
段值名称较长的场景。
3-167
日志学院
条形图可以设置lable的位置，lable展示更多信息。
旭日图
当用户需要多个分组进行饼图展示时，原始饼图只能自动把各分组字段的值拼接成一个长字
符串。导致在仪表盘钻取时无法正确获取原始字段值，也不方便判断单个分组字段的大小关
系。
日志易推荐改用旭日图效果进行更合理的展示。
*|statscount()byappname,hostname,tag配置为旭日图效果如下。可以明显看出各层级的
占比细节。
关系
作为关系类图，自动配置的三个参数及默认的字段取值规则：
3-168
日志学院
1. 来源：取第一个分组字段
2. 目标：取第二个分组字段
3. 权重：取第一个统计数值
关系图统一支持颜色分组，采用字段名称约定的方式，只要有{name}_group，就自动把group
值用上，同一group的数据颜色相同，没有{name}_group就和原来一样。详情请见桑基图。
关系图包括以下几种：
和弦图：显示分组关系，如展现Nginx访问用户访问了哪些资源；
桑基图：常用于链式数据流向展示；
力图：常用于发现异常数据，如根据用户及访问URL分析，发现访问冷数据的IP。
和弦图
例如如下搜索:
logtype:apacheAND(apache.clientip:171.221.120.144OR
apache.clientip:121.236.143.48)|statscount()byapache.clientip,
apache.request_path
自动配置结果为:
• 来源：apache.clientip
• 目标：apache.request_path
• 权重：count()
可以得到如下结果：
3-169
日志学院
以上配置得出的数据图表中，每一个来源与不同目标的对应关系都用同一颜色的关系线来连
接，可清楚观察不同clientip之间在关系对应上的区别。若用户想观察区分的对象为
request_path，则需要将两个分组字段的位置对调，如下所示：
logtype:apacheAND(apache.clientip:171.221.120.144OR
apache.clientip:121.236.143.48)|statscount()byapache.request_path,
apache.clientip
统计图表结果如图：
桑基图
桑基图常用于链式数据流向展示。
例如如下搜索:
appname:trans
|transactionjson.aid,json.bid,json.cid,json.did,json.eid,
json.fidwithstatesa,b,c,d,e,finjson.module resultsbyflow
|statscount()byfromstate,tostate
可以得到如下结果：
3-170