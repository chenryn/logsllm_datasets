Hardw
are
bac
kdo
oring
is
practical
Jonathan
Brossard
-
PI:EMAIL
Securit
y
Researc
h
Engineer
&
CEO,
T
oucan
System,
F
rance
and
Australia
Blac
khat
Briengs
and
Defcon
conferences,
Las
V
egas,
2012
T
o
cr
e
ate
is
to
r
esist,
to
r
esist
is
to
cr
e
ate
National
Council
of
the
Resistance
Abstract.
This
article
will
demonstrate
that
p
ermanen
t
bac
kdo
oring
of
hardw
are
is
practical.
W
e
ha
v
e
built
a
generic
pro
of
of
concept
malw
are
for
the
in
tel
arc
hitecture,
Rakshasa
1
,
capable
of
infecting
more
than
a
h
undred
dieren
t
motherb
oards.
The
rst
net
eect
of
Rakshasa
is
to
disable
NX
p
ermanen
tly
and
remo
v
e
SMM[1
℄
related
xes
from
the
BIOS,
an
Unied
Extensible
Firm
w
are
In
terface
(UEFI)[2
℄[3
℄
rm
w
are,
or
from
a
PCI[4℄
rm
w
are,
resulting
in
p
ermanen
t
lo
w
ering
of
the
securit
y
of
the
bac
kdo
ored
computer,
ev
en
after
complete
earasing
of
hard
disks
and
reinstallation
of
a
new
op
erating
system.
W
e
shall
also
demonstrate
that
preexisting
w
ork
on
MBR
sub
v
ertions
suc
h
as
b
o
otkiting
and
preb
o
ot
authen
tication
soft
w
are
bruteforce
or
faking
can
b
e
em
b
edded
in
Rakshasa
with
little
eort.
More
o
v
er,
Rakshasa
is
built
on
top
of
free
soft
w
are,
including
the
Coreb
o
ot[5
℄,
Seabios[6℄,
and
iPXE[7
℄
pro
jects,
meaning
that
most
of
its
source
co
de
is
b
oth
already
public
and
non
malicious,
therefore
extremely
hard
to
detect
as
suc
h.
W
e
shall
nally
demonstrate
that
bac
kdo
oring
of
the
BIOS
or
PCI
rm
w
ares
to
allo
w
the
silen
t
b
o
oting
a
remote
pa
yload
via
an
h
ttp(s)
connection
is
equally
practical
and
ruins
all
hop
e
to
detect
the
infection
using
existing
to
ols
suc
h
as
an
tivirii
or
existing
forensics
to
ols.
It
is
hop
ed
to
raise
a
w
areness
of
the
industry
regarding
the
dangers
asso
ciated
with
the
PCI
standard,
esp
ecially
question
the
use
of
non
op
en
source
rm
w
ares
shipp
ed
with
an
y
computer
and
question
their
in
tegrit
y
or
actual
in
tend.
This
shall
also
result
in
upgrading
the
b
est
practices
in
companies
regarding
forensics
and
p
ost
in
trusion
analysis
b
y
including
the
afore
men
tioned
rm
w
ares
as
part
of
their
scop
e
of
w
ork.
Keyw
ords:
Hardw
are
bac
kdo
oring,
PCI
rm
w
are,
BIOS,
EFI,
romkitting,
remote
b
o
ot,
Botnet.
1
Rakshasa
is
the
Hindi
w
ord
for
deamon.
T
able
of
Con
ten
ts
1
In
tro
duction
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
3
2
Related
w
ork
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
3
3
Ov
erview
of
the
IBM
PC
and
its
legacy
problems
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
5
4
Designing
the
p
erfect
bac
kdo
or
:
scop
e
of
w
ork
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
6
5
Implemen
tation
details
:
Rakshasa
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
7
6
Inner
w
orking
of
Rakshasa
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
8
7
Em
b
edded
features
of
Rakshasa
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
10
8
Ho
w
to
prop
erly
build
a
b
otnet
from
the
BIOS
:
BIOSBonets
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
11
9
Wh
y
(p
ossibly
hardw
are
assisted)
encryption
w
on't
solv
e
the
problem
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
12
10
Remediation
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
13
11
Conclusion
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
13
12
A
c
kno
wledgemen
ts
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
14
1
In
tro
duction
A
recen
t[8
℄
rep
ort
from
the
US-China
Economic
and
securit
y
review
commission
b
y
Northrop
Grumman
Corp
called
"Occup
ying
the
Information
High
Ground:
Chinese
Capabilities
for
Computer
Net
w
ork
Op
erations
and
Cyb
er
Espionage"
concluded
that:
"This
close
relationship
b
et
w
een
some
of
China's
-and
the
w
orld's-
largest
telecomm
unications
hardw
are
man
ufacturers
creates
a
p
oten
tial
v
ector
for
state
sp
onsored
or
state
directed
p
enetrations
of
the
supply
c
hains
for
micro
electronics
supp
orting
U.S.
military
,
civilian
go
v
ernmen
t,
and
high
v
alue
civilian
industry
suc
h
as
defense
and
telecomm
unications,
though
no
evidence
for
suc
h
a
connection
is
publicly
a
v
ailable."
In
other
w
ords
:
since
China
has
b
ecome
the
de
facto
man
ufacturer
of
most
IT
equipmen
t
in
the
w
orld,
China
can
bac
kdo
or
an
y
computer
at
will.
An
yb
o
dy
part
of
the
supply
c
hain
can.
W
e
b
eliev
e
this
is
an
euphemism
:
w
e
shall
here
demonstrate
the
practicalit
y
of
suc
h
a
bac
kdo
oring
using
existing
op
en
source
soft
w
are,
lo
w
ering
the
bar
of
suc
h
an
attac
k
from
state
lev
el
or
otherwise
v
ery
large
corp
orations
to
an
y
16bits
assem
bly
exp
ert,
as
w
ell
as
demonstrate
that
installing
suc
h
a
bac
kdo
or
remotely
is
equally
practical.
2
Related
w
ork
The
rst
kno
wn
virus,
brain,
w
as
alledgely
built
in
Romania
in
the
early
80's.
It
w
as
targetting
the
Master
Bo
ot
Record
(MBR)
of
the
rst
b
o
otable
hard
driv
e
in
order
to
gain
early
execution
and
used
opp
y
disks
to
propagate.
This
attac
k
v
ector
has
b
een
replicated
b
y
literally
thousands
of
viruses
during
the
80s
and
90s,
un
till
the
app
earance
of
the
in
ternet,
when
viruses
switc
hed
to
userland
in
order
to
b
enet
from
in
ternet
access
as
a
propagation
v
ector.
Gaining
early
execution
has
long
b
een
b
eliev
ed
the
b
est
w
a
y
to
gain
maxim
um
privileges
on
IBM
PCs.
In
2009,
at
Cansecw
est,
Anibal
Saco
and
Alfredo
Ortega[9
℄
demonstrated
ho
w
they
managed
to
patc
h
a
Pho
enix-A
w
ard
BIOS
to
em
b
ed
malicious
features
(mo
difying
the
shado
w
le
on
Unix-lik
e
systems,
or
patc
h
Microsoft
Windo
ws
binaries).
In
2007,
John
Heasman[10
℄
demonstrated
that
infecting
The
Extensible
Firm
w
are
In
terface
(EFI)
b
o
otloader
w
ould
lead
to
the
same
results.
If
the
former
targetted
one
sp
ecic
BIOS,
the
latter
w
ould
b
e
mitigated
b
y
reinstalling
a
sane
b
o
otloader.
Op
erating
mo
dications
on
the
le
system
isn't
stealth
and
lea
v
es
clear
forensics
evidence
:
as
a
matter
of
fact,
a