in Section 3.4) so future research can obtain timing measurements
from all current and future MITM phishing tools. All code and data
can be found at https://catching-transparent-phish.github.io
Acknowledgements: We thank our shepherd Sooel Son and the
anonymous reviewers for their helpful feedback. This work was
supported by the Office of Naval Research (ONR) under grant
N00014-20-1-2720, as well as by the National Science Foundation
(NSF) under grants CMMI-1842020, CNS-1813974, CNS-1941617,
and CNS-2126654.
Session 1A: Cybercrime CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea48[10] 2021. JA3. https://github.com/salesforce/ja3.
[11] 2021. JA3er. https://ja3er.com.
[12] 2021. Let’s Encrypt. https://letsencrypt.org.
[13] 2021. Linode. https://linode.com.
[14] 2021. Modlishka. https://github.com/drk1wi/Modlishka.
[15] 2021. Muraena. https://github.com/muraenateam/muraena.
[16] 2021. Necrobrowser. https://github.com/muraenateam/necrobrowser.
[17] 2021. Nginx. https://nginx.com.
[18] 2021. Openphish. https://openphish.com.
[19] 2021. Phishtank. https://phishtank.com.
[20] 2021. Reelphish. https://github.com/fireeye/ReelPhish.
[21] 2021. Selenium. https://selenium.dev.
[22] 2021. Squid Proxy Server. http://squid-cache.org.
[23] 2021. TLS Prober. https://github.com/WestpointLtd/tls_prober.
[24] 2021. TOR. https://torproject.org.
[25] 2021. VirusTotal. https://virustotal.com.
[26] 2021. VirusTotal Evilginx Analysis Results. https://www.virustotal.com/gui/
file/35636566f7ce11d44c2acf6ce6dca00b730b39710e82000a0e92b4af4a75e52c/
detection.
[27] Sahar Abdelnabi, Katharina Krombholz, and Mario Fritz. 2020. VisualPhishNet:
Zero-Day Phishing Website Detection by Visual Similarity. In Proceedings of the
ACM Conference on Computer and Communications Security (CCS).
[28] Moruf A Adebowale, Khin T Lwin, Erika Sanchez, and M Alamgir Hossain. 2019. In-
telligent web-phishing detection and protection scheme using integrated features
of Images, frames and text. Expert Systems with Applications 115 (2019), 300–313.
[29] Daniel R Alexander. 2015. Inferring the Presence of Reverse Proxies Through Timing
Analysis. Technical Report. Naval Postgraduate School Monterey CA.
[30] Manos Antonakakis, Roberto Perdisci, Wenke Lee, Nikolaos Vasiloglou, and David
Dagon. 2011. Detecting Malware Domains at the Upper DNS Hierarchy.. In
Proceedingsofthe10thUSENIXSecuritySymposium(USENIXSecurity),Vol.11.1–16.
[31] APWG. 2017. Global Phishing Survey: Trends and Domain Name Use in 2016.
Technical Report.
REFERENCES
[1] 2021. Amazon Web Services. https://aws.amazon.com.
[2] 2021. Apache Traffic Server. https://trafficserver.apache.org.
[3] 2021. Apache Web Server. https://apache.org.
[4] 2021. Certificate Transparency. https://certificate-transparency.org.
[5] 2021. CloudFlare. https://cloudflare.com.
[6] 2021. CredSniper. https://github.com/ustayready/CredSniper.
[7] 2021. Digital Ocean. https://digitalocean.com.
[8] 2021. Evilginx. https://github.com/kgretzky/evilginx2.
[9] 2021. Facebook Certificate Transparency API. https://developers.facebook.com/
docs/certificate-transparency.
[32] Aaron Blum, Brad Wardman, Thamar Solorio, and Gary Warner. 2010. Lexical
feature based phishing URL detection using online learning. In Proceedings of
the 3rd ACM Workshop on Artificial Intelligence and Security. 54–60.
[33] Davide Canali, Marco Cova, Giovanni Vigna, and Christopher Kruegel. 2011.
Prophiler: a fast filter for the large-scale detection of malicious web pages. In
Proceedings of the 20th International Conference on World Wide Web (WWW). ACM,
197–206.
[34] Igino Corona, Battista Biggio, Matteo Contini, Luca Piras, Roberto Corda, Mauro
Mereu, Guido Mureddu, Davide Ariu, and Fabio Roli. 2017. Deltaphish: Detecting
phishing webpages in compromised websites. In Proceedings of the 2017 European
Symposium on Research in Computer Security. Springer, 370–388.
[35] Zakir Durumeric, Eric Wustrow, and J Alex Halderman. 2013. ZMap: Fast
Internet-wide scanning and its security applications. In 22nd USENIX Security
Symposium. 605–620.
[36] Xiao Han, Nizar Kheir, and Davide Balzarotti. 2016. Phisheye: Live monitoring
of sandboxed phishing kits. In Proceedings of the 2016 SIGSAC Conference on
Computer and Communications Security (CCS). ACM, 1402–1413.
[37] Shuang Hao, Alex Kantchelian, Brad Miller, Vern Paxson, and Nick Feamster.
2016. PREDATOR: proactive recognition and elimination of domain abuse
at time-of-registration. In Proceedings of the 2016 ACM SIGSAC Conference on
Computer and Communications Security. 1568–1579.
[38] Luca Invernizzi, Kurt Thomas, Alexandros Kapravelos, Oxana Comanescu,
Jean-Michel Picod, and Elie Bursztein. 2016. Cloak of visibility: Detecting when
machines browse a different web. In 2016 IEEE Symposium on Security and Privacy
(SP). IEEE, 743–758.
[39] Ankit Kumar Jain and Brij B Gupta. 2018. Towards detection of phishing websites
on client-side using machine learning based approach. Telecommunication
Systems 68, 4 (2018), 687–700.
[40] Panagiotis Kintis, Najmeh Miramirkhani, Charles Lever, Yizheng Chen, Rosa
Romero-Gómez, Nikolaos Pitropakis, Nick Nikiforakis, and Manos Antonakakis.
2017. Hiding in plain sight: A longitudinal study of combosquatting abuse. In
Proceedings of the 2017 SIGSAC Conference on Computer and Communications
Security. ACM, 569–586.
[41] Anh Le, Athina Markopoulou, and Michalis Faloutsos. 2011. Phishdef: Url names
say it all. In Proceedings of the 2011 IEEE INFOCOM. IEEE, 191–195.
[42] Xueni Li, Guanggang Geng, Zhiwei Yan, Yong Chen, and Xiaodong Lee. 2016.
Phishing detection based on newly registered domains. In 2016 IEEE international
conference on big data (big data). IEEE, 3685–3692.
[43] Samuel Marchal, Jérôme François, Thomas Engel, et al. 2012. Proactive discovery
of phishing related domain names. In International Workshop on Recent Advances
in Intrusion Detection. Springer, 190–209.
[44] Anutthamaa Martin, Na Anutthamaa, M Sathyavathy, Marie Manjari Saint
Francois, Dr V Prasanna Venkatesan, et al. 2011. A framework for predicting
phishing websites using neural networks. arXiv preprint arXiv:1109.1074 (2011).
[45] S Matthew and Geoffrey Xie. 2013. Fingerprinting Reverse Proxies Using Timing
Analysis of TCP Flows. Technical Report. Naval Postgraduate School Monterey CA.
[46] Eric Medvet, Engin Kirda, and Christopher Kruegel. 2008. Visual-similarity-based
phishing detection. In Proceedings of the 4th international conference on Security
and privacy in communication netowrks. 1–6.
[47] Antonio Nappa, Rana Faisal Munir, Irfan Khan Tanoli, Christian Kreibich, and
Juan Caballero. 2016. RevProbe: detecting silent reverse proxies in malicious
server infrastructures. In Proceedings of the 32nd Annual Conference on Computer
Security Applications. 101–112.
[48] Terry Nelms, Roberto Perdisci, Manos Antonakakis, and Mustaque Ahamad. 2016.
Towards measuring and mitigating social engineering software download attacks.
In Proceedings of the 25th USENIX Security Symposium (USENIX Security). 773–789.
[49] Adam Oest, Yeganeh Safaei, Adam Doupé, Gail-Joon Ahn, Brad Wardman,
and Kevin Tyers. 2019. Phishfarm: A scalable framework for measuring the
effectiveness of evasion techniques against browser phishing blacklists. In 2019
IEEE Symposium on Security and Privacy (SP). IEEE, 1344–1361.
[50] Adam Oest, Yeganeh Safei, Adam Doupé, Gail-Joon Ahn, Brad Wardman, and
Gary Warner. 2018. Inside a phisher’s mind: Understanding the anti-phishing
ecosystem through phishing kit analysis. In 2018 APWG Symposium on Electronic
Crime Research (eCrime). IEEE, 1–12.
[51] Adam Oest, Yeganeh Safei, Adam Doupé, Gail-Joon Ahn, Brad Wardman, and
Gary Warner. 2018. Inside a Phisher’s Mind: Understanding the Anti-Phishing
Ecosystem Through Phishing Kit Analysis. In Proceedings of the 2018 APWG
Symposium on Electronic Crime Research (eCrime). IEEE, 1–12.
[52] Adam Oest, Penghui Zhang, Brad Wardman, Eric Nunes, Jakub Burgis, Ali
Zand, Kurt Thomas, Adam Doupé, and Gail-Joon Ahn. 2020. Sunrise to Sunset:
Analyzing the End-to-end Life Cycle and Effectiveness of Phishing Attacks at
Scale. In Proceedings of the 29th USENIX Security Symposium (USENIX Security).
[53] Pawan Prakash, Manish Kumar, Ramana Rao Kompella, and Minaxi Gupta. 2010.
Phishnet: predictive blacklisting to detect phishing attacks. In 2010 Proceedings
IEEE INFOCOM. IEEE, 1–5.
[54] Babak Rahbarinia, Roberto Perdisci, and Manos Antonakakis. 2015. Segugio:
Efficient behavior-based tracking of malware-control domains in large ISP
networks. In Proceedings of the 45th Annual IEEE/IFIP International Conference
on Dependable Systems and Networks. IEEE, 403–414.
[55] Steve Sheng, Brad Wardman, Gary Warner, Lorrie Cranor, Jason Hong, and
Chengshan Zhang. 2009. An Empirical Analysis of Phishing Blacklists. (2009).
[56] Gianluca Stringhini, Christopher Kruegel, and Giovanni Vigna. 2010. Detecting
spammers on social networks. In Proceedings of the 26th Annual Computer Security
Applications Conference. 1–9.
[57] Kurt Thomas, Frank Li, Ali Zand, Jacob Barrett, Juri Ranieri, Luca Invernizzi, Yarik
Markov, Oxana Comanescu, Vijay Eranti, Angelika Moscicki, et al. 2017. Data
Breaches, Phishing, or Malware? Understanding the Risks of Stolen Credentials.
In Proceedings of the 2017 SIGSAC Conference on Computer and Communications
Security. ACM, 1421–1434.
[58] Enis Ulqinaku, Daniele Lain, and Srdjan Capkun. 2019. 2FA-PP: 2nd Factor
Phishing Prevention. In Proceedings of the 12th Conference on Security and Privacy
in Wireless and Mobile Networks (WiSec). 60–70.
[59] Matthew S Weant. 2013. Fingerprinting reverse proxies using timing analysis of
TCP flows. Technical Report. Naval Postgraduate School Monterey CA.
[60] Nicholas Weaver, Christian Kreibich, Martin Dam, and Vern Paxson. 2014. Here
be web proxies. In Proceedings of the International Conference on Passive and Active
Network Measurement. Springer, 183–192.
[61] Colin Whittaker, Brian Ryner, and Marria Nazif. 2010. Large-scale automatic
classification of phishing pages. In Proceedings of the 17th Network and Distributed
System Security Symposium (NDSS).
Session 1A: Cybercrime CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea499 APPENDIX
-
-
-
proxy_hosts:
domain: ' twimg . com '}
domain: ' twitter . com '}
keys:
c r e d e n t i a l s:
username:
s u b _ f i l t e r s :
auth_tokens:
[ ]
- domain: '. twitter . com '
{ phish_sub: ' api ', orig_sub: ' api ',
session:
t r u e }
{ phish_sub: ' abs ', orig_sub: ' abs ',
is_landing:
t r u e ,
[ ' kdt ',' _twitter_sess ',' twid ',' auth_token ' ]
{ phish_sub: '', orig_sub: '', domain: ' twitter . com ',
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
Listing 1: Example configuration file for Evilginx specifying
options for a Twitter phishing web page
key: ' session \[ username_or_email \] '
search: ' (.*) '
type: ' post '
key: ' session \[ password \] '
search: ' (.*) '
type: ' post '
domain: ' twitter . com '
path: '/ login '
password:
login:
j s _ i n j e c t :
Table 7: Full feature set of our 2FA phishing toolkit classifier
Feature Name
Feature Type
Network Timing Features
TCP SYN/ACK RTT
TLS Client Hello RTT
Malformed TLS Client Hello RTT
TLS Handshake Timing
HTTP GET Request Timing
HTTP GET Request w/o Host Header Timing
Malformed HTTP GET Request Timing
HTTPS GET Request Timing
HTTPS GET Request w/o Host Header Timing
Malformed HTTPS GET Request Timing
TCP SYN/ACK to HTTP GET Request Timing Ratio
TCP SYN/ACK to Malformed HTTP GET Request Timing Ratio
TCP SYN/ACK to Malformed HTTPS Get Request Timing Ratio
Malformed to Valid HTTPS GET Request Timing Ratio
TLS Versions Supported
SSLv2
SSLv3
TLSv1
TLSv1.2
TLSv1.3
Apache Tomcat 7.0.53
Apache Tomcat 7.0.54
TLS Library
... 177 more TLS libraries ...
openssl 1.0.2a default source build
wolfSSL 3.4.0
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Numeric
Binary
Binary
Binary
Binary
Binary
Numeric
Numeric
Numeric
Numeric
Table 8: Full set of trademarks our system received impersonating
domains for from Certificate Transparency logs
Domain
Email
Financial
Google, Yahoo, Outlook, Protonmail
Paypal, Chase, Wells Fargo, Bank of America
HSBC, Citi Bank, Captial One, American Express
Facebook, Instagram, Twitter, Linkedin
Social Media
Web Services Dropbox, Amazon, Github, Office 365
Technology
Apple, Microsoft
Session 1A: Cybercrime CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea50