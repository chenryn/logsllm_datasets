4.1.2.2STP有三种
286
4.1.2.3同时启用多项可选功能
289
4.1.2.4利用BPDU切断桥接环路
290
4.1.3网络层的余技术
292
4.1.3.1FHRP
292
4.1.3.2利用路由协议确保通往上层设备的路径
302
4.1.4从传输层到应用层的余技术
304
4.1.4.1防火墙的究余技术
304
4.1.4.2负载均衡器的余技术
310
高可用性设计
312
4.2.1高可用性设计
312
4.2.1.1串联式结构
312
4.2.1.2单路并联式结构
316
4.2.2理清通信流
320
4.2.2.1串联式结构
320
4.2.2.2单路并联式结构
332
管理设计
339
管理技术
340
5.1.1用NTP同步时间
340
NTP的工作原理非常第单
340
5.1.2
用SNMP检测故障
346
5.1.2.1通过SNMP管理器和SNMP代理交换信息
346
5.1.2.2熟练掌握三种运作模式
347
5.1.2.3限制源IP地址
351
5.1.3用Syslog检测故障
352
Syslog 的工作原理非常简单
352
5.1.4传递设备信息
355
5.1.4.1CDP
355
---
## Page 16
xiv|目录
5.1.4.2LLDP
356
5.1.4.3注意CDP和LLDP的数据安全问题
357
管理设计
358
5.2.1确定主机名
358
5.2.2通过标签管理连接
358
5.2.2.1线绝标签
358
5.2.2.2本体标签
359
5.2.3设计密码
359
5.2.4管理设置信息
360
5.2.4.1在备份设计中应定义时机、方式和保存地点
360
5.2.4.2发生故障时执行恢复处理
361
---
## Page 17
第0章
本书的用法
本章概要
本章针对本书的讲解顺序和使用方法进行说明。基础设计是服务器
端网络架构中最重要的一个阶段，本书将立足于基础设计的设计细分项
日，介绍各细分项目的相关技术和设计要点。基础设计中会制定一些重
要规则，这些规则一旦定下便不可动据，它们对系统今后的可扩展性和
可操作性等，乃至对整个网络都将产生重大影响。为了各位读者今后能
够进行着眼于未来的基础设计，首先请通过本章了解如何使用本书。
---
## Page 18
0.1
网络架构的流程
首先说明一下网络架构的大致流程。各位在理解了网络架构的大致流程之后，就可以将该
）
一进行匹配
0.1.1网络架构分为六个阶段
普通服务器端的网络架构由六个阶段构成，分别为需求定义、基础设计、详细设计、架构、
测试和运行。各个阶段并非完全独立，而是前一个阶段为后一个阶段提供输人，被此之间是密
切相关的。
0.1.1.1需求定义
需求定义是确认客户的需求并将它们一一定义出来的阶段。客户会给出需求方案说明书
（RFP，RequestForProposal）来描述他们的需求，但这份资料中只有需求的大致内容。我们应
在参考这份资料的基础上听取客户的其体需求，将需求明确和细化，然后整理成一份叫作需求
定义书的文档
0.1.1.2基础设计
基础设计是确定各要素设置规则的阶段。如果网络设备都属于同一个种类，那么只有设置
方法和设置对象不一样而已，它们的功能应该是大同小异的。所以可以这么说，这里定下的规
则决定了后面的所有阶段。对网络架构来说，这个阶段是它的生命线。我们应将这里制定的规
则整理成一份叫作基础设计书的文档。
0.1.1.3详细设计
-o
详细设计是根据基础设计中的信息确定各机器参数（设定值）的阶段。母庸置疑，设置对
象会因机器本身、机器种类和OS版本等要索的不同而各不相同。我们应详细规定每台机器的
设定值，保证无论是谁去看设计书都能够完成设置，进面完成系统架构。我们还应将这里制定
---
## Page 19
0.1网络架构的流程|3
的参数整理成一份叫作详细设计书的文档。
不同的企业和供应商对详细设计书有着不同的定义。有的把记载了所有参数的机器设置书
和参数表叫作详细设计书，有的则把总结了设定值要点的资料叫作详细设计书，形式多样，不
一面足。所以，请事先向客户确认好他们需要什么样的详细设计书。
0.1.1.4架构
-o
架构是根据详细设计书中的信息（参数、设定值）对机器进行设置的阶段。详细设计书是
落实设定值的资料，而在架构这个阶段，我们就要利用这些信息对机器进行设置和连接。毋庸
置疑，设置方法也因机器本身、机器种类和OS版本等要素的不同面各不相同。我们应根据设
置人员的技术水平和客户的要求编写操作手册和操作检查表，将操作步骤细化，力求减少设置
失误。
0.1.1.5测试
测试是指在完成架构的环境中进行单元测试、正常测试、故障（余化）测试等各种测试。
测试前我们应编写测试规格说明书和测试计划书，然后根据资料中的测试事项进行测试，最后
将结果整理成一份叫作测试报告的文档。
在单元测试中应确认例如LED能否正常亮灯、OS能否以预想的版本正常启动、接口能否
衔接等事项，以此来确认单机是否能正常运行。
在正常测试中应确认机器在连接的环境中是否按我们设想的那样接通、是否能进行应用通
信、是否组成了元余结构、是否能进行Syslog、SNMP、NTP等管理通信等事项，以此来确认
各相关机器能否彼此协作运行。
在故障测试中应针对所有进行了元余配置的设备确认如下事项：当该处发生故障时能否继
续提供服务，出现故障时会发送怎样的日志，等等。
0.1.1.6运行
运行是为了持续稳定地提供完成架构的系统而存在的阶段。并不是架构完系统就万事大吉
了，而从这里才刚刚开始起步，以后可能有些机件会损坏，也可能会需要新增服务器。所以，
除了日常操作之外我们还应多方考虑，做到有备无患。我们应将所有和运行相关的业务整理成
一份叫作运行手册的文档。
---
## Page 20
4第0章本书的用法
图0.1.1网络架构分为六个阶段
明客户的求并连一定义
1求定义
+
确定各机器的各种参数
3设计
←
根评设计的修数进行设置
4
进行各种测试
+
6行
0.1.2网络架构的重点是基础设计
网络架构中最重要的阶段就是基础设计阶段。基础设计中确定的规则对系统以后的可扩展
性和可操作性等，乃至对整个网络都将产生重大影响。由于不同的客户对基础设计的程度会有
不同的要求，我们应在一开始就向客户确认他们所需要的程度，然后根据他们的具体要求进行
基础设计。如果有其他的现有系统存在，不妨去察看一下该系统的基础设计书，了解设计书大
致处于怎样的水平。
关于服务器端的网络架构，本书将重点介绍基础设计这一最重要的阶段，并对各设计细分
项目所需的技术和设计要点进行说明。普通服务器端的网络架构基础设计可大致分为物理设计、
逻辑设计、安全设计与负载均衡设计、高可用性设计、管理设计这五个设计细分项目。当然这
些只是一般的例子，设计细分项目会因客户需求、服务性质等的不同面不同。我们可根据实际
需要自行调整，对这些细分项目进行切分、删除和添加。
接下来要对各设计细分项目的概要以及本书中与各设计细分项目相关的技术细分项目和设
---
## Page 21
0.1网络架构的流程1：5
计细分项目进行梳理和说明。希望会试物理设计的读者请参看第1章，希望尝试逻辑设计的读
者请参看第2章。
图0.1.2本书的结构
基动计分项目
水中的#天
确客户的更求并逐一定文
定义
第1章
1.1
确定络的规到
2基设计
2
设计
←
2.1
2.3
的提水
确定各机器的各种参数
3详设计
安全设计与负载均街设计
络属的技术
2.2
←
+
详银设计的参数进行设置
高可用性计
提营余送行设计
3章安业设计
+
五载约表设计
+
从会话制
3.2
运行
应用层的授木
运行加好的环境
第4章高可用性设计
余技术
4.1
高可用性设计
4.2
第5
0.1.2.1物理设计
-
在物理设计中，我们要定义服务器端所有实体对象的所有规则。实体对象种类繁多，从线
缆到机架、电源，这些都是实体对象。我们要对所有的实体对象都进行严格的定义。
本书的第1章讲述物理设计，这章将对物理设计所必需的技术和设计要点进行说明。关于
设计细分项目以及本书中与之相关的技术细分项目和设计细分项目的详细内容请参看下表。
---
## Page 22
61第0章本书的用法
表0.1.1本书中与物理设计相关的技术细分项目和设计细分项目
设计分项目
设计概要
本书中的相关技术细分项目
本书中的相关设计组分项目
物理设计
对实体方面进行设计
1.1
物理层的技术
1.2
物理设计
1.1
物理设计规则
定义物理设计的整体
一
规则
1.2
物理结构设计
如何连接各台机器