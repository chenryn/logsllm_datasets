### 5. Evaluation

#### 5.1 Overview
We begin our evaluation by examining the classification accuracy and the 6-digit password inference accuracy of WindTalker. We then investigate various factors that may influence the inference accuracy, such as distance and direction. In Section 6, we present a specific case study involving the inference of mobile payment passwords for Alipay. At this stage, we only perform user-specific training and will discuss its limitations in Section 7.

#### 5.2 Classification Accuracy
In Section 3, we demonstrated that different keystrokes can be correlated with distinct CSI waveforms. This section aims to determine whether these differences are significant enough to recognize different key inputs in a real-world setting. We collected training and testing data from 10 volunteers. Each volunteer generated 10 loop samples, where a loop consists of the CSI waveform for key numbers 0 to 9. We then evaluated the classification accuracy of WindTalker using the collected CSI data through cross-validation. For each 10-loop dataset, one loop was used for testing while the remaining nine loops were used for training. WindTalker employs the classifier introduced in Section 4.5 to recognize keystrokes. The evaluation was conducted on Samsung Note 5, Xiaomi Redmi Note 3, and Nexus 5, running Android 6.0.1, 5.0.2, and 6.0.1, respectively. Using all ten loops, WindTalker achieved average classification accuracies of 81.8% for Xiaomi, 73.2% for Nexus, and 64% for Samsung. Figure 8 shows the average classification accuracy for all 10 volunteers across the 10 PIN numbers.

Figure 9 presents the confusion matrix for Xiaomi, indicating the inference results for each typed number. Darker areas represent higher probabilities of correct keystroke inference, suggesting that neighboring numbers are more likely to be confused during the inference process.

#### 5.3 Password Inference
In practical scenarios, it may not be feasible for WindTalker to obtain 10 training samples for each PIN number. Therefore, we use only 3 samples per number for training. To evaluate WindTalker's performance in password inference, we asked volunteers to enter 10 randomly generated 6-digit passwords, using their corresponding 3 loops as the training dataset. This experiment was repeated for both Samsung and Xiaomi devices.

We tested a total of 200 sets of passwords, comprising 1200 keys. The results showed that 852 keys were successfully recovered. As shown in Table 1, WindTalker achieved an average 1-digit recovery rate of 79.0% for Xiaomi and 63.0% for Samsung. For a 6-digit password in Alipay, the attacker can try several times to recover the password, increasing the success rate. Thus, we introduce a new metric: the recovery rate with Top N candidates, which indicates the rate of successfully recovering the password after trying N times. This provides a more realistic measure of the attacker's capability in practical settings. As shown in Table 1, the 1-digit recovery rate improves significantly when considering top 2 and top 3 candidates.

To further investigate the number of candidates needed to predict the correct 6-digit payment password, we calculated the probability of matching each waveform with the predicted key number. The probability of a predicted password is defined as the product of the six individual probabilities. For a 6-digit password, we obtained 100,000 predicted passwords, sorted them by probability in descending order, and defined a successful inference as the real password being included in the top N candidates. Figure 10(a) and (b) show the password inference accuracy under different top N candidates, demonstrating encouraging results.

#### 5.4 Impact of Distance and Direction
Several factors can affect CSI, including the distance and direction between the AP and the mobile device. We investigate these factors in our experiments.

##### 5.4.1 Distance
In real-world scenarios, the distance between the victim's mobile device and the AP is not fixed. As shown in Figure 11(a), the recovery rate of WindTalker decreases as the distance increases. However, even at a distance of 1.6 meters, WindTalker can achieve a 1-digit recovery rate of 70% under top 3 candidates. This demonstrates that WindTalker can still function effectively at distances up to 1.6 meters. This is because the attacker can force the smartphone to send WiFi signals, and the AP to receive them. Although the distance between the victim and the receiver (AP) increases, the distance between the WiFi sender (smartphone) and the victim (fingers) remains relatively stable, ensuring key recognition. Figure 11(b) shows that both the shape and degree of CSI change with distance, indicating the need for retraining datasets for the same victim at different distances. To partially address this limitation, the attacker can fix the location of tables and chairs, making the user's position more stable.

##### 5.4.2 Direction
The relative direction between the victim and the attacker can significantly affect CSI due to different multi-path propagation. We evaluated WindTalker's performance under different directions, with the mobile device in front of the victim. Notably, for right-handed users, WindTalker performs better when the AP is on the left side of the victim, as it is easier to sense finger clicks and hand movements. Figure 12 shows the recovery accuracy of WindTalker in different directions, revealing that WindTalker can achieve high performance even when the AP is behind the victim. This highlights a significant advantage of CSI-based keystroke inference, as it can work effectively even if the attacker is behind the user without visual access to the clicking actions.

### 6. Real-World Experiment: Mobile Payment Password Inference towards Alipay

#### 6.1 System Setup
To demonstrate the practicality of WindTalker, we conducted an experimental evaluation of password inference on Alipay, a popular mobile payment platform available on both Android and iOS systems. Alipay is the world's largest mobile payments company, with 450 million monthly active users, including 270 million mobile payment users. As shown in Figure 13, we deployed a WindTalker system in a cafeteria-like environment and released an authentication-free WiFi. The AP, equipped with an Intel 5300 NIC and antennas, was set up behind the counter, making it less likely to be visually detected. The victim was positioned 1 meter away from the deployed WiFi devices. During data collection, one user walked past the victim, but no users walked between the victim and the AP.

To simulate real-world attack scenarios, we recruited participants to enter their Alipay passwords in a controlled environment. The results of this experiment will be discussed in detail in the following sections.