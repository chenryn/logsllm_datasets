%
(
e
g
a
s
U
U
P
C
 12
 10
 8
 6
 4
 2
 0
Diabled
Enabled Triggered
Status of Secure MDC at UE
(a) UE
)
%
(
e
g
a
s
U
U
P
C
 40
 30
 20
 10
 0
 0
 60
 30
 90  120  150
Number of Conn. Requests(K)
(b) Gateway
Figure 15: The average CPU usage of Secure MDC at the UE
(a) and the gateway (b).
states (i.e., disabled, enabled, and triggered). Each CPU usage slice
is 200ms. In each test, we collect 5-minute trace for the ﬁrst two
states and all those samples when our extra processing is triggered.
It shows that, the UE consumes about 4% CPU usage no matter
whether our defense is enabled or disabled. It implies that extra
processing overhead in normal cases is negligible. Upon event de-
tection, the CPU usage climbs to 9.2% (average) but only occupies
a single slice. This CPU usage is to trigger a process that issues a
request or feedback to the gateway. We observe similar CPU us-
age at the gateway. Therefore, the overhead by our defense module
is low and affordable. We further run scaling tests at the gateway.
Figure 15(b) plots the average CPU usage with respect to the num-
ber of connection requests when our components are enabled. It
shows that, the CPU usage increases linearly with the number of
active connections. Our solution thus works ﬁne with edge routers
in the network.
We also assess the impact of the spamming rate. Figure 16 shows
that, our defense can effectively stop spamming given the increas-
ing spamming rate. The overcharge volume increases slightly due
to communication delay to the gateway. Figure 17 measures this
latency by sending an explicit request to the gateway using our pro-
totype. It is about 100ms in our tests.
)
B
M
(
g
n
i
g
r
a
h
c
r
e
v
O
10
1
10-1
10-2
10-3
 0
w/ Secure MDC
w/o Secure MDC
 200  400  600  800  1000
Source Rate (Kbps)
(a) OP-I
)
B
M
(
g
n
i
g
r
a
h
c
r
e
v
O
10
1
10-1
10-2
10-3
 0
w/ Secure MDC
w/o Secure MDC
 200  400  600  800  1000
Source Rate (Kbps)
(b) OP-II
Figure 16: The overcharging volumes varies with spamming
rates in OP-I (a) and OP-II (b).
 400
)
s
m
(
 300
Implicit
Explicit
 400
)
s
m
(
 300
Implicit
Explicit
 200
 100
d
a
e
h
r
e
v
O
 0
 0  3  6  9  12  15  18  21
xth Hour
 200
 100
d
a
e
h
r
e
v
O
 0
 0  3  6  9  12  15  18  21
xth Hour
Figure 17: The (min/med/max) delay of an explicit request at
24-hours in OP-I (left) and OP-II (right).
6. RELATED WORK
Several studies recently assess the MDC system in cellular net-
works [21, 22, 27, 28, 36]. They mainly explore its accounting mis-
behaviors in normal use or under attacks. Speciﬁcally, [28, 36]
study the accounting inaccuracy in the presence of weak or no wire-
less connectivity, user mobility, and policy misconﬁgurations by
operators. The others exploit the vulnerability that the MDC system
does not carefully consider transport-layer’s trafﬁc (TCP retrans-
mission [21, 22]) and application-layer’s (DNS, VoIP and phishing
737links [27]). These studies attempting to solve individual exploits
have been ad-hoc to secure the MDC system. Different from them,
we examine vulnerabilities in the MDC system along all three AAA
dimensions. We further stretch several new and practical attacks,
and then provide the solutions. In particular, we have not seen sim-
ilar solutions to authentication and authorization in the literature.
Others (e.g., [23, 32]) work on the pricing scheme, which is related
to MDC but orthogonal to the AAA issues studied in this paper.
Except the MDC system, research on the performance and secu-
rity aspects of cellular networks has been an active area in recent
years (see [1, 9, 18, 24, 26, 29–31, 33–35, 38] for a few examples).
They conduct security studies in three broad aspects. First, they
identify the vulnerabilities in cellular-speciﬁc technologies, such
as ID leakage via SIM/USIM card hijacking [1], AKA loopholes
in user authentication [9, 26], battery drain via MMS pushing [31].
Second, they assess the Internet technology in the cellular network
context. For example, [38] studies the NAT and ﬁrewall policies
over cellular carriers, and introduces the TCP hijacking attacks
in [29, 30]. [34] analyzes the impact of cellular botnets. [24] an-
alyzes malicious trafﬁc from one large operational carrier. The last
category explores the interaction between the cellular technologies
and data services. For example, [18, 33] exploit SMS to launch de-
nial of service (DoS) attacks via overloading the control channels
for data services, and [35] generalizes to a series of DoS attacks by
exploiting difference between cellular networks and the traditional
Internet. Security and privacy of mobile devices and applications is
another active research area (such as [11, 13, 17, 37, 39]). They are
independent of the MDC system in this work.
7. CONCLUSION
In this work, we conduct systematic security analysis of the
MDC system in cellular networks. We uncover vulnerabilities in
every subsystem of authentication, authorization, and accounting.
We show that, no sophisticated attacks are needed, and simple at-
tacks may work in practice. As far as we know, many cellular op-
erators are still unaware of such security weakness. For the same
reason, simple yet effective defense measures have not been de-
ployed by many of them. These results catch us off guard to certain
extent. Although cellular data charging has been operational for
years and is generally successful, our study illustrates how fragile
the networked system can be from the security standpoint.
Acknowledgments
We would like to thank the anonymous reviewers for their valuable
comments. This work is supported in part by the National Science
Foundation under Grants No. CNS-1421933 and CNS-1422835.
Any opinions, ﬁndings, and conclusions or recommendations ex-
pressed in this material are those of the authors and do not neces-
sarily reﬂect the views of the National Science Foundation.
8. REFERENCES
[1] Millions of cell phones could be vulnerable to this sim card hack.
http://gizmodo.com/sim-cards-are-hackable-and-researchers-have-
found-the-v-860779912,2013.
[2] Tor. https://www.torproject.org/.
[3] 3GPP. TS32.240: Charging architecture and principles, 2006.
[4] 3GPP. TS25.413: UTRAN Iu interface RANAP Signaling, 2008.
[5] 3GPP. TS33.210: 3G security; Network Domain Security (NDS); IP
network layer security, Dec. 2012.
[6] 3GPP. TS 23.203: Policy and Charging Control Architecture, 2013.
[7] 3GPP. TS33.401: 3GPP SAE; Security architecture, Sep. 2013.
[8] Allot. Allot mobiletrends charging report, 2011.
http://www.allot.com/MobileTrendsChargingReport.html.
[9] M. Arapinis, L. Mancini, E. Ritter, M. Ryan, N. Golde, K. Redon,
and R. Borgaonkar. New Privacy Issues in Mobile Telephony: Fix
and Veriﬁcation. In ACM CCS, 2012.
[10] AT&T. Data Plans from AT&T.
http://www.att.com/media/att/planner/index.html.
[11] K. W. Y. Au, Y. F. Zhou, Z. Huang, and D. Lie. Pscout: analyzing the
android permission speciﬁcation. In ACM CCS, 2012.
[12] H. Balakrishnan, S. Seshan, and R. H. Katz. Improving reliable
transport and handoff performance in cellular wireless networks.
Wireless Networks, 1(4):469–481, 1995.
[13] M. Becher, F. C. Freiling, J. Hoffmann, T. Holz, S. Uellenbeck, and
C. Wolf. Mobile Security Catching Up? Revealing the Nuts and
Bolts of the Security of Mobile Devices. In IEEE S&P, 2011.
[14] S. M. Bellovin. Security problems in the TCP/IP protocol suite.
SIGCOMM Comput. Commun. Rev., 19(2):32–48, 1989.
[15] Cisco. Cisco GGSN Release 10.0 Conﬁguration Guide, 2010.
[16] Cisco Visual Networking Index. Global Mobile Data Trafﬁc Forecast
Update, 2013–2018, 2014. http://www.cisco.com/en/US/
solutions/collateral/ns341/ns525/ns537/ns705/
ns827/white_paper_c11-520862.html.
[17] W. Enck, D. Octeau, P. McDaniel, and S. Chaudhuri. A study of
android application security. In USENIX Security, 2011.
[18] W. Enck, P. Traynor, P. McDaniel, and T. La Porta. Exploiting Open
Functionality in SMS-Capable Cellular Networks. In CCS, 2005.
[19] H. Falaki, D. Lymberopoulos, R. Mahajan, S. Kandula, and
D. Estrin. A ﬁrst look at trafﬁc on smartphones. In IMC, 2010.
[20] FCC. FCC approves AT&T acquisition of Qualcomm Licenses. 2011.
[21] Y. Go, D. F. Kune, S. Woo, K. Park, and Y. Kim. Towards accurate
accounting of cellular data for tcp retransmission. In HotMobile’13.
[22] Y. Go, J. Won, D. F. Kune, E. Jeong, Y. Kim, and K. Park. Gaining
Control of Cellular Trafﬁc Accounting by Spurious TCP
Retransmission. In NDSS, 2014.
[23] S. Ha, S. Sen, C. Joe-Wong, Y. Im, and M. Chiang. TUBE:
Time-dependent Pricing for Mobile Data. In SIGCOMM, 2012.
[24] C. Lever, M. Antonakakis, B. Reaves, P. Traynor, and W. Lee. The
Core of the Matter: Analyzing Malicious Trafﬁc in Cellular Carriers.
In NDSS, 2013.
[25] mobiThinking. Global mobile statistics 2013.
[26] E. R. M. R. Myrto Arapinis, Loretta Ilaria Mancini. Privacy through
pseudonymity in mobile telephony systems. In NDSS, 2014.
[27] C. Peng, C. Li, G. Tu, S. Lu, and L. Zhang. Mobile Data Charging:
New Attacks and Countermeasures. In ACM CCS, 2012.
[28] C. Peng, G. Tu, C. Li, and S. Lu. Can We Pay for What We Get in 3G
Data Access? In MobiCom, 2012.
[29] Z. Qian and Z. Mao. Off-Path TCP Sequence Number Inference
Attack-How Firewall Middleboxes Reduce Security. In S&P, 2012.
[30] Z. Qian, Z. M. Mao, and Y. Xie. Collaborative TCP Sequence
Number Inference Attack: How to Crack Sequence Number under a
Second. In ACM CCS, 2012.
[31] R. Racic, D. Ma, and H. Chen. Exploiting MMS vulnerabilities to
stealthily exhaust mobile phone’s battery. In SecureComm’06.
[32] S. Sen, C. Joe-Wong, S. Ha, and M. Chiang. Pricing Data: A Look at
Past Proposals, Current Plans, and Future Trends. CoRR, 2012.
[33] P. Traynor, W. Enck, P. McDaniel, and T. La Porta. Mitigating
Attacks on Open Functionality in SMS-capable Cellular Networks.
In ACM MobiCom, 2006.
[34] P. Traynor, M. Lin, M. Ongtang, V. Rao, T. Jaeger, P. McDaniel, and
T. L. Porta. On Cellular Botnets: Measuring the Impact of Malicious
Devices on a Cellular Network Core. In ACM CCS, 2009.
[35] P. Traynor, P. McDaniel, and T. La Porta. On Attack Causality in
Internet-Connected Cellular Networks. In USENIX Security, 2007.
[36] G.-H. Tu, C. Peng, C.-Y. Li, X. Ma, H. Wang, T. Wang, and S. Lu.
Accounting for Roaming Users on Mobile Data Access: Issues and
Root Causes. In ACM MobiSys, 2013.
[37] R. Wang, L. Xing, X. Wang, and S. Chen. Unauthorized origin
crossing on mobile platforms: Threats and mitigation. In CCS, 2013.
[38] Z. Wang, Z. Qian, Q. Xu, Z. Mao, and M. Zhang. An Untold Story of
Middleboxes in Cellular Networks. In SIGCOMM, 2011.
[39] Y. Zhou and X. Jiang. Dissecting Android Malware: Characterization
and Evolution. In IEEE S&P, 2012.
738