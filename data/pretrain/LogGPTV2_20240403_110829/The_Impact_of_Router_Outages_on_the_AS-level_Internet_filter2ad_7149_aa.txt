title:The Impact of Router Outages on the AS-level Internet
author:Matthew J. Luckie and
Robert Beverly
The Impact of Router Outages on the AS-level Internet
Matthew Luckie
University of Waikato
PI:EMAIL
ABSTRACT
We propose and evaluate a new metric for understanding the depen-
dence of the AS-level Internet on individual routers. Whereas prior
work uses large volumes of reachability probes to infer outages,
we design an efficient active probing technique that directly and
unambiguously reveals router restarts. We use our technique to
survey 149,560 routers across the Internet for 2.5 years. 59,175 of
the surveyed routers (40%) experience at least one reboot, and we
quantify the resulting impact of each router outage on global IPv4
and IPv6 BGP reachability.
Our technique complements existing data and control plane out-
age analysis methods by providing a causal link from BGP reacha-
bility failures to the responsible router(s) and multi-homing config-
urations. While we found the Internet core to be largely robust, we
identified specific routers that were single points of failure for the
prefixes they advertised. In total, 2,385 routers – 4.0% of the routers
that restarted over the course of 2.5 years of probing – were single
points of failure for 3,396 IPv6 prefixes announced by 1,708 ASes.
We inferred 59% of these routers were the customer-edge border
router. 2,374 (70%) of the withdrawn prefixes were not covered by
a less specific prefix, so 1,726 routers (2.9%) of those that restarted
were single points of failure for at least one network. However, a
covering route did not imply reachability during a router outage,
as no previously-responsive address in a withdrawn more specific
prefix responded during a one-week sample. We validate our reboot
and single point of failure inference techniques with four networks,
finding no false positive or false negative reboots, but find some
false negatives in our single point of failure inferences.
CCS CONCEPTS
• Networks → Network measurement; Network reliability;
KEYWORDS
Internet reliability, single points of failure, BGP, routing
ACM Reference format:
Matthew Luckie and Robert Beverly. 2017. The Impact of Router Outages
on the AS-level Internet. In Proceedings of SIGCOMM ’17, Los Angeles, CA,
USA, August 21-25, 2017, 14 pages.
https://doi.org/10.1145/3098822.3098858
ACM acknowledges that this contribution was authored or co-authored by an em-
ployee, or contractor of the national government. As such, the Government retains a
nonexclusive, royalty-free right to publish or reproduce this article, or to allow others
to do so, for Government purposes only. Permission to make digital or hard copies for
personal or classroom use is granted. Copies must bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. To copy otherwise, distribute, republish, or post, requires prior
specific permission and/or a fee. Request permissions from permissions@acm.org.
SIGCOMM ’17, August 21-25, 2017, Los Angeles, CA, USA
© 2017 Association for Computing Machinery.
ACM ISBN 978-1-4503-4653-5/17/08...$15.00
https://doi.org/10.1145/3098822.3098858
Robert Beverly
Naval Postgraduate School
PI:EMAIL
1 INTRODUCTION
While the Internet is well-established as critical infrastructure, its
complex ecosystem of systems, users, applications, and service
providers make an accurate assessment of resilience difficult. At
the infrastructure substrate, networks may utilize routing protocols
and multiple routers, links, and providers to take advantage of
available diversity, and to gain redundancy and resilience to failure.
In this paper, we take a new step towards understanding Internet
reliability by examining individual router reboots and measuring
the broader global impact of these outages.
Graph-theoretic approaches to understanding and characterizing
resilience [1, 12] are notoriously fragile [31, 49] due to the underly-
ing difficulty in obtaining accurate Internet topologies [11, 23, 44].
While a router may appear central to a network’s connectivity,
significant redundancy may be invisible to measurement. Despite
a pressing need for complete and sound data on Internet infras-
tructure resilience, the inherently global, unregulated, complex,
and decentralized nature of the Internet makes obtaining such data
challenging. Attempts to quantify the network’s resilience have
largely come from researchers attempting to infer outages, attacks,
and their causes from noisy and incomplete data. For instance,
prior work has shown that continual, high-volume probing of edge
devices can expose more reachability failures than control-plane
analysis alone [39, 43], and [17] uses control plane analysis to iden-
tify failures and tomography to isolate their causes.
In contrast, we seek to empirically quantify the dependence of
interdomain routing on individual routers. We employ an efficient
active probing technique that elicits IPv6 fragment identifiers from
routers. These 32-bit fragment identifiers are commonly mono-
tonic, unambiguously and directly exposing router reboots when
there is a discontinuity in the sampled sequence [7]. While our
restart inference technique is only effective for routers with an IPv6
control plane, we show in §5 that the restart events we find also
frequently manifest as IPv4 BGP churn and withdrawals due to the
preponderance of IPv4/IPv6 infrastructure sharing [16].
We survey 149,560 distinct routers over 2.5 years. We associate
each router with a set of destinations (IPv4 and IPv6 network pre-
fixes) reachable via that router, as indicated by analysis of CAIDA’s
traceroute topology data [10]. We opportunistically correlate each
observed router outage with BGP control plane activity – the se-
quence of globally visible BGP update and withdrawal messages for
the associated prefixes observed at the Routeviews looking glass –
to shed light on the impact of more than 2.5 years of such events
on global IPv4 and IPv6 BGP reachability.
In addition to localizing BGP reachability failures to responsible
routers and configurations, we identify specific routers that are
single points of failure for their networks. Surprisingly, we find that
4.0% of the surveyed routers were relied on by their AS to announce
a prefix in BGP. In summary, our contributions include:
SIGCOMM ’17, August 21-25, 2017, Los Angeles, CA, USA
Matthew Luckie and Robert Beverly
(1) A new perspective on characterizing the importance of
individual routers on Internet resilience.
identify and characterize router restarts over 2.5 years.
(2) An Internet-wide large-scale measurement campaign to
(3) Correlation of restarts against ≈12M BGP update messages
to quantify their global IPv4 and IPv6 reachability impact.
(4) Identification of 2,385 individual routers in the global topol-
ogy that represented single-points of failure for 1,708 ASes.
(5) Week-long high-frequency active probing of networks be-
hind rebooting routers to assess the impact of the reboot
on the data-plane.
(6) Public release of the source code for our adaptive probing
engine as part of scamper [32].
The remainder of this work is organized as follows. Section 2
provides background and context, while §3 gives an overview of the
extensive prior work in measuring and mitigating network outages.
Section 4 details our methodology and data, while §5 provides
the results of our extended, Internet-wide measurement study. We
conclude in §6 with a discussion on the broader implications of our
findings and suggestions for future research.
2 BACKGROUND
We start with background on our technique for inferring router
restarts, a discussion of our use of BGP in understanding the effect
of router restarts, as well as a summary of the myriad ways in which
networks interconnect, deploy redundancy, and attempt to provide
resilience. Based on the different multi-homing configurations, we
discuss the expected effects of a router restart to provide context
for our results in §5.
2.1 Router Restarts
In contrast to prior efforts that indirectly localize outages, black-
holes, and reachability faults (e.g., via traceroutes, topology atlases,
tomography, etc), we directly interrogate the control-plane IPv6
stack on routers in order to unambiguously determine whether the
router has restarted. At a high-level, we construct a per-router time
series of IP Identifier (IPID) values from fragmented IPv6 response
packets, and use discontinuities in the series to infer that the router
restarted some time during the polling interval.
We focus on IPv6 routers for two reasons. First, as we show in
§4.1.1, probing routers affords significant efficiencies as compared
to probing edge systems, where even finding a stable set of edge
IPv6 addresses presents a practical difficulty. Second, probing IPv6
routers allows us to unambiguously determine that a router re-
booted, rather than relying on fragile tomography inferences. Only
IPv6 routers provide a clean signal that allows us to reliably infer
that a restart occurred. While the IPv4 stack on routers also has an
IPID field, it is both small (16-bits) and has natural velocity since
every control packet the router originates must have an IPID [5] in
case the packet is fragmented in the network. In contrast, the IPv6
IPID field is 32-bits in size with no natural velocity because routers
rarely send fragmented packets, and only the sender can fragment
a packet. The small size of the IPv4 IPID field, combined with the
fact that a router may send packets in bursts due to operational
and control traffic, makes it infeasible to distinguish an IPv4 router
restart from a counter wrap.
The IPID field is an optional IPv6 extension header. To obtain
fragmented responses, we use our method from [7] and send 1300-
byte ICMP6 echo request packets to router interfaces; upon receipt
of an ICMP6 echo reply larger than 1280 bytes, we respond with
an ICMP6 packet too big message asking the receiver to reduce
its packet size to 1280 bytes. This process induces the router to
fragment subsequent ICMP6 echo replies, exposing the router’s
IPv6 IPID counter values. In our data, 27.1% of router interfaces
that responded for at least 14 days during our 2.5 years of probing
assigned IPID values from a counter; others assigned values from
a pseudo random number generator, did not send fragmented re-
sponses to our probes, had fragments blocked along the reverse
path, or ICMP packet too big messages were blocked along the
forward path. A responsive router with a monotonic sequence that
resets therefore represents a restart. Section 4.1 provides our full
algorithm for inferring a router outage.
2.2 BGP
The Border Gateway Protocol version 4 (BGP) is the protocol used
by ASes to organize interdomain routing [40, 41]. To quantify the
impact of an inferred router outage, we examine the sequence of
BGP messages received at the Routeviews looking glass. In this
section, we discuss subtleties of BGP that manifest in the BGP
update and withdrawal messages we can observe, and how they
can impact our ability to correlate BGP activity with router outages.
An AS exchanges network-layer reachability information with
neighboring ASes according to the configuration applied by the
router’s operator. An AS establishes a session with a neighbor
using TCP, and each peer keeps state regarding which prefixes are
reachable; a neighbor may announce new routes, withdraw existing
routes, or update routes.
Ending a BGP session: A router may end a BGP session grace-
fully by notifying the peer that it is closing the session, or by closing
the TCP connection. A graceful shutdown occurs when an operator
halts, reboots, or changes the configuration of a router to remove
the peer. A router will not shutdown a BGP session gracefully if the
neighbor router crashes or fails, or if a physical link between the
peers is broken and the router does not detect the link failure. A
router infers that a peer has failed if it does not receive a BGP keep-
alive message from the peer within the hold time period agreed by
the peers using the BGP protocol [41]. The BGP specification sug-
gests that routers send keep-alive messages at 30 second intervals,
and wait 90 seconds after receiving a keep-alive message before
deciding the BGP session has failed. However, the Cisco default is
to send keep-alive messages at 60 second intervals, and wait 180
seconds before deciding the BGP session has failed. A router may
infer a BGP session with a peer has failed more quickly if the oper-
ator configures a shorter hold time for the peer, or if the operator
configures Bidirectional Forwarding Detection [25], which allows
the router to verify the peer is responsive at the network layer.
Path hunting: When a router’s BGP session with a peer fails
or is gracefully shutdown, the router removes the routes it received
from that peer from its Routing Information Base (RIB). The router
then runs a decision process to select alternative routes for the
withdrawn routes that were previously the best available for the
prefixes. If the router has no other route available for a prefix, it
The Impact of Router Outages on the AS-level Internet
SIGCOMM ’17, August 21-25, 2017, Los Angeles, CA, USA
sends a withdrawal notice to its peers, causing them to remove the
route from their RIBs and to run the BGP route decision process.
Depending on the availability of alternative routes, routers may
begin path hunting or path exploration, where a router replaces
the withdrawn route with what it believes to be a valid route with
a different path. However, if the replacement route is via a path
affected by the same failure, the replacement route may also be sub-
sequently withdrawn or updated as routing information converges.
This activity typically induces a burst of withdrawal and update
messages to propagate through the Internet, so-called “churn.”
Route flap damping: Excessive BGP control traffic and churn
is a source of instability in the network if BGP routers are un-
able to process BGP control traffic at the same rate it arrives. The
BGP specifications [40, 41] recommend that BGP routers use a
Minimum Route Advertisement Interval (MRAI) of 30 seconds for
routes exchanged between ASes. The initial BGP specification rec-
ommends that the MRAI not apply to withdrawn routes [40], how-
ever an update to the specification includes withdrawn routes in
the MRAI [41]. In practice, the MRAI is applied per-neighbor, rather
than per prefix. To further reduce the impact of unstable routes
sustained over long time-scales, the IETF standardized a protocol
for route flap damping [47]. A router that uses route flap damping
(RFD) scores each prefix according to recent activity, penalizing
prefixes that contribute significant BGP load by suppressing up-
dated routes for the prefix at increasingly long durations, up to one
hour. Individual network operators make their own decisions about
the configuration and deployment of MRAI and RFD.
2.3 Network Redundancy
Network redundancy is implemented in a wide variety of ways,
and the resulting control-plane artifacts and failure-modes can
be both subtle and complex. A customer, which we informally
define as an entity at the network edge that pays for access from
a service provider, can have redundant i) routers; ii) links; and iii)
providers. This redundancy may be utilized via load-balancing, only
during failures, or deployed in more complex configurations (e.g.,
via selective advertisement of more specific prefix announcements)
[3]. In this work, we focus on the role routers play in providing
network resilience, and ignore failures of links connecting routers
(e.g., a severed long-haul optical link).
The types of customer connectivity range from the cross-product
of single versus multiple customer edge routers, single versus mul-
tiple provider edge routers, and the use of a single or multiple
providers. In the most basic case, no redundancy exists: a single
customer edge router connects to a single provider edge router, and
requires neither BGP nor provider-independent address space. We
expect outages of these customer edge routers to have no impact
or discernible effect on the global BGP control-plane.
The more interesting case, and the focus of this paper, involves
a customer with their own AS and address space. Regional Internet
Registries (RIRs) require a multi-homing plan for an organization
to obtain an AS number. Perhaps surprisingly, we uncover a non-
trivial number of singly-homed customers in this class. An outage
of such a customer or their provider’s router will manifest as a
series of withdrawal and update messages in the global BGP system
during path exploration. Eventually, we observe all Routeviews
peers withdrawing the customer’s prefix. A significant component
of our work is determining, for a given customer’s network prefix,
the provider and customer edge routers (see §4.2).
More complex scenarios invoke more subtle behaviors. While
we do not know the cause of a router reboot, a single router outage
should not cause a complete prefix withdrawal if the network is