Computer and Communications Security. ACM.
[10] Karthikeyan Bhargavan, Bruno Blanchet, and Nadim Kobeissi. 2017. Verified
Models and Reference Implementations for the TLS 1.3 Standard Candidate. In
2017 IEEE Symposium on Security and Privacy (SP). 483–502. https://doi.org/10.
1109/SP.2017.26
[11] Bruno Blanchet. 2016. Modeling and Verifying Security Protocols with the
Applied Pi Calculus and ProVerif. Foundations and Trends in Privacy and Security
1, 1–2 (Oct. 2016), 1–135.
[12] Ravishankar Borgaonkar, Lucca Hirshi, Shinjo Park, Altaf Shaik, Andrew Mar-
tin, and Jean-Pierre Seifert. 2017. New Adventures in Spying 3G & 4G Users:
Locate, Track, Monitor.
https://www.blackhat.com/us-17/briefings.html#
new-adventures-in-spying-3g-and-4g-users-locate-track-and-monitor Briefing
at BlackHat USA 2017.
[13] Colin Boyd and Wenbo Mao. 1993. On a limitation of BAN logic. In Workshop on
the Theory and Application of of Cryptographic Techniques. Springer, 240–247.
[14] Vincent Cheval, Steve Kremer, and Itsaka Rakotonirina. 2018. DEEPSEC: Deciding
Equivalence Properties in Security Protocols - Theory and Practice. In Proceedings
of the 39th IEEE Symposium on Security and Privacy (S&P’18). IEEE Computer
Society Press, San Francisco, CA, USA, 529–546.
[15] Katriel Cohn-Gordon, Cas Cremers, and Luke Garratt. 2016. On post-compromise
security. In Computer Security Foundations Symposium (CSF), 2016 IEEE 29th. IEEE,
164–178.
[16] Cas Cremers, Marko Horvat, Jonathan Hoyland, Sam Scott, and Thyla van der
Merwe. 2017. A Comprehensive Symbolic Analysis of TLS 1.3. In ACM CCS
2017: Proceedings of the 24th ACM Conference on Computer and Communications
Security, Dallas, USA, 2017. 1773–1788.
[17] Cas Cremers, Marko Horvat, Jonathan Hoyland, Sam Scott, and Thyla van der
Merwe. 2017. A Comprehensive Symbolic Analysis of TLS 1.3. In Proceedings of
the 2017 ACM SIGSAC Conference on Computer and Communications Security, CCS
2017, Dallas, TX, USA, October 30 - November 03, 2017, Bhavani M. Thuraisingham,
David Evans, Tal Malkin, and Dongyan Xu (Eds.). ACM, 1773–1788. https:
//doi.org/10.1145/3133956.3134063
[18] Cas Cremers, Marko Horvat, Sam Scott, and Thyla van der Merwe. 2016. Au-
tomated Analysis and Verification of TLS 1.3: 0-RTT, Resumption and Delayed
Authentication. In IEEE Symposium on Security and Privacy.
[19] Martin Dehnel-Wild and Cas Cremers. 2018.
nerability in the most
http://www.cs.ox.ac.uk/people/cas.cremers/tamarin/5G/.
5G AKA drafts
recent
Authentication vul-
(February 2018).
A Formal Analysis of 5G Authentication
D. Basin, J. Dreier, L. Hirschi, S. Radomirović, R. Sasse and V. Stettler
[20] Danny Dolev and Andrew C. Yao. 1981. On the security of public key protocols.
Information Theory, IEEE Transactions on 29, 2 (March 1981), 198–208. https:
//doi.org/10.1109/TIT.1983.1056650
[21] Jannik Dreier, Lucca Hirschi, Saša Radomirović, and Ralf Sasse. 2018. Automated
Unbounded Verification of Stateful Cryptographic Protocols with Exclusive OR.
In 31st IEEE Computer Security Foundations Symposium, CSF 2018, Oxford, United
Kingdom, July 9-12, 2018. IEEE Computer Society, 359–373. https://doi.org/10.
1109/CSF.2018.00033
[22] Pierre-Alain Fouque, Cristina Onete, and Benjamin Richard. 2016. Achieving
better privacy for the 3GPP AKA protocol. Proceedings on Privacy Enhancing
Technologies 2016, 4 (2016), 255–275.
[23] Nico Golde, Kévin Redon, and Jean-Pierre Seifert. 2013. Let Me Answer That for
You: Exploiting Broadcast Information in Cellular Networks. In 22Nd USENIX
Conference on Security. USENIX Association.
[24] GSMA. 2017.
Global Mobile Trends 2017.
https://www.gsma.com/
globalmobiletrends/. Accessed: 2018-05-06.
[25] Syed Rafiul Hussain, Omar Chowdhury, Shagufta Mehnaz, and Elisa Bertino.
2018. LTEInspector: A Systematic Approach for Adversarial Testing of 4G LTE.
In Network and Distributed Systems Security (NDSS) Symposium 2018.
[26] Nadim Kobeissi, Karthikeyan Bhargavan, and Bruno Blanchet. 2017. Automated
verification for secure messaging protocols and their implementations: A sym-
bolic and computational approach. In IEEE European Symposium on Security and
Privacy (EuroS&P).
[27] Robert Künnemann and Graham Steel. 2013. YubiSecure? Formal Security Anal-
ysis Results for the Yubikey and YubiHSM. In Security and Trust Management,
Audun Jøsang, Pierangela Samarati, and Marinella Petrocchi (Eds.). Springer
Berlin Heidelberg, Berlin, Heidelberg, 257–272.
[28] Gavin Lowe. 1997. A Hierarchy of Authentication Specifications. In 10th Computer
Security Foundations Workshop. IEEE Computer Society Press.
[29] Simon Meier. 2013. Advancing automated security protocol verification. Ph.D.
Dissertation. ETH Zurich.
[30] Simon Meier, Benedikt Schmidt, Cas J. F. Cremers, and David Basin. 2013. The
TAMARIN Prover for the Symbolic Analysis of Security Protocols. In CAV (LNCS),
Vol. 8044. Springer, 696–701.
[31] Piers O’Hanlon, Ravishankar Borgaonkar, and Lucca Hirschi. 2017. Mobile sub-
scriber WiFi Privacy. In 2017 IEEE Security and Privacy Workshops, SP Workshops
2017, San Jose, CA, USA, May 25, 2017. 169–178.
[32] David Rupprecht, Adrian Dabrowski, Thorsten Holz, Edgar Weippl, and Christina
Pöpper. 2018. On Security Research towards Future Mobile Network Generations.
IEEE Communications Surveys & Tutorials (2018).
[33] Benedikt Schmidt, Simon Meier, Cas Cremers, and David Basin. 2012. Auto-
mated analysis of Diffie-Hellman protocols and advanced security properties. In
Computer Security Foundations Symposium (CSF). IEEE, 78–94.
[34] Benedikt Schmidt, Ralf Sasse, Cas Cremers, and David Basin. 2014. Automated
Verification of Group Key Agreement Protocols. In Proceedings of the 2014 IEEE
Symposium on Security and Privacy (SP ’14). IEEE Computer Society, Washington,
DC, USA, 179–194. https://doi.org/10.1109/SP.2014.19
[35] Altaf Shaik, Jean-Pierre Seifert, Ravishankar Borgaonkar, N. Asokan, and Valtteri
Niemi. 2016. Practical Attacks Against Privacy and Availability in 4G/LTE Mobile
Communication Systems. In 23nd Annual Network and Distributed System Security
Symposium, NDSS.
[36] Fabian van den Broek, Roel Verdult, and Joeri de Ruiter. 2015. Defeating IMSI
Catchers. Proceedings of the 2015 ACM Conference on Computer and Communica-
tions Security - CCS ’15 (2015).
A NOTATIONS AND ACRONYMS
We list all the acronyms we introduced throughout the paper in
Table 4 and give a correspondence table between our simplified
terminology and the 3GPP terminology in Table 5.
We describe the cryptographic messages format in Table 6 (ab-
stracting away AMF, other constants and sub-message lengths).
exactly as in 5G AKA:
KSEAF = KDF(KAUSF, SNname)
but KAUSF is derived differently: KAUSF = MK[1152...1407] (we
write [x ..y] for the substring from bit x to y) where the master key
MK is:
KDF(⟨KDF(IK, SNname), KDF(CK, SNname)⟩, ⟨’EAP-AKA’’, SUPI⟩).
Therefore,
KSEAF = KeySeed(K, R, SQNHNSNname, SUPI)
= KDF(KDF(⟨KDF(IK, SNname), KDF(CK, SNname)⟩,
⟨’EAP-AKA’’, SUPI⟩)[512..767],
SNname).
The messages AT_MAC are MAC messages over the other sub-
messages as part of the same message. The key in use is Kaut =
MK[1152...1407].
AKA are as follows:
Conceptually, the main difference of EAP-AKA’ compared to 5G
• the challenge xRES does not directly bind the SN’s identity
SNname. However, since the challenge is MACed (with the
session key Kaut) together with SNname, both are de facto
bound together.
• SN serves as a pass-through until the authentication is con-
sidered successful by the HN. Only at this time SN obtains
SUPI and KSEAF from the HN, while it obtains KSEAF already
in the first message in 5G AKA.
C LOWE’S TAXONOMY AND TAMARIN
MODELING
Lowe’s Taxonomy [28] notably defines aliveness, recent aliveness,
weak agreement, non-injective agreement, and injective agreement.
After an introductory example showing how properties are typically
modelled in Tamarin, we show how aliveness and non-injective
agreement properties are modelled. The process for the other prop-
erties is similar.
C.1 Introductory Example: Secrecy
As an introductory example, let us see how secrecy properties are
modeled in Tamarin. For instance, we model the property that the
SUPI of subscribers is never revealed to the attacker. Formally, such
a property is formalized in Tamarin using the formula defined
below, where facts Claim_Secret(a, k) are produced for each rule
of agent a (some subscriber or some HN) who accesses or stores
the identifier SUPI. Note that K(t) denotes the fact that t is in the
attacker’s Knowledge.
Definition C.1. Secrecy is modeled via the following formula:
∀a t #i. Claim_secret(a, t)@i ⇒ ¬(∃#j. K(t)@j).
B THE EAP-AKA’ PROTOCOL
We depict the core flow of the EAP-AKA’ protocol in Figure 4. We
omit the MAC failure and Re-synchronization failure phases that
are the same as for 5G-AKA (see Section 2.2.2 and Figure 3). We
also omit the message headers specific to the EAP framework such
as ’EAP Request’ and ’EAP Success’. The key derivation is a
bit different compared to 5G AKA. KSEAF is derived from KAUSF
C.2 Aliveness
Lowe defines aliveness as follows (excerpt from [28]):
We say that a protocol guarantees to an initiator
A aliveness of another agent B if, whenever
A (acting as initiator) completes a run of the
protocol, apparently with responder B, then B
has previously been running the protocol.
14
A Formal Analysis of 5G Authentication
D. Basin, J. Dreier, L. Hirschi, S. Radomirović, R. Sasse and V. Stettler
Acronym Full name
RAND (R) Random Challenge
Description (if needed)
Reference
Section 2.2
Anonymity Key
Appendix A
Authentication Management Field
Access and Mobility Management Function
Appendix A
Authentication credential Repository and Processing Function Appendix A
Appendix A
Authentication Server Function
Section 2.2
Extensible Authentication Protocol
Section 2.1
International Mobile Subscriber Identity
Uniquely identify subscribers
Appendix A new generation base station
NR Node B
Section 4.3
Globally Unique Temporary UE Identity
Section 2.1
Mobile Equipment
Appendix A Uniquely identify HNs’ countries
Mobile Country Code
Appendix A Uniquely identity HNs in a country
Mobile Network Code
Section 2.2
Appendix A
Appendix A
Section 2.2
Section 2.1
Section 2.1
Appendix A
Appendix A
Appendix A
Appendix A
Section 2.1
Section 2.2
Appendix A Uniquely identify SNs
RESponse
SEcurity Anchor Function
Subscription Concealed Identifier
Subscription Permanent Identifier
SeQuence Number
Unified Data Management
Universal Subscriber Identity Module
eXpected RESponse
Subscription Identifier De-concealing Function
Subscription Concealed Identifier
Subscription Permanent Identifier
SN identity
Randomized encryption of SUPI
Uniquely identify a subscriber and its HN
AK
AMF
AMF(∗)
ARPF
AUSF
EAP
IMSI
gNB
GUTI
ME
MNC
MNC
RES
SEAF
SUCI
SUPI
SQN
UDM
USIM
XRES
SIDF
SUPI
SUCI
SNid
Table 4: Acronyms and abbreviations (mostly from [TS 33.501, Sec. 3.2])
Our notion Correspondent notion in TS33.501
Serving Network Combination of SEAF, AMF(∗) and gNB
Home Network Combination of AUSF, ARPF, UDM and SIDF
Table 5: Correspondence between our terminology with the one of TS33.501
Let us see how this property is mathematically modelled in
Tamarin. We assume that the Tamarin model is equipped with facts
Claim_commit(a, b, ⟨A, B⟩) (i.e., an agent a of role A claims it has
established aliveness of b whose role is B) and Claim_running(b, B)
(i.e., an agent b of role B claims it has run the protocol).
Definition C.2. Aliveness of a role A towards a role B is modeled
via the following formula:
∀a b #i. Claim_commit(a, b, ⟨A, B⟩)@i ⇒
∃#j. Claim_running(b, B)@j.
Note that we do not restrict the timestamp #j to be before the
timestamp #i (e.g., with a constraint #j⋖#i) since the trace semantics
of Tamarin already accounts for this constraint. More precisely,
if, for some execution, there was a fact Claim_running(b, B)@j but
only after the fact Claim_commit(a, b, ⟨A, B⟩)@i (i.e., #i⋖#j), then it
would suffice, for falsifying the property, to consider a prefix of the
considered execution that contains Claim_commit(a, b, ⟨A, B⟩)@i
but not Claim_running(b, B)@j.
C.3 Non-injective Agreement
Another example is the non-injective agreement property, defined
as follows (excerpt from [28]):
We say that a protocol guarantees to an initiator
A non-injective agreement with a responder B
on a set of data items ts (where ts is a set of free
variables appearing in the protocol description)
if, whenever A (acting as initiator) completes
a run of the protocol, apparently with respon-
der B, then B has previously been running the
protocol, apparently with A, and was acting
as responder in his run, and the two agents
agreed on the data values corresponding to all
the variables in ts.
We assume that the Tamarin model is equipped with facts
Claim_commit_agr(a, b, ⟨A, B, ts⟩) (i.e., an agent a of role A claims
it has established agreement on data t with b whose role is B) and
Claim_running_agr(b, a, ⟨A, B, ts⟩) (i.e., an agent b of role B claims
15
A Formal Analysis of 5G Authentication
D. Basin, J. Dreier, L. Hirschi, S. Radomirović, R. Sasse and V. Stettler
Message Name Content
⟨IMSI, MMC, MNC⟩
SUPI