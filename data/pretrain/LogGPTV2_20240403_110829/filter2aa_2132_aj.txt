    Nt Hash : 31d6cfe0d16ae931b73c59d7e0c089c0 (Empty string) 
------------------------------------------------------------------------ 
       User : IUSR_REDTEAM-52B93E3 
        Rid : 1003 
    Expired : false 
  Exception : false 
Lanman Hash : 57d1eb3bd0c15cd00f2ffe835ddbaaf7 
    Nt Hash : f395d07949f5cf1fe5bc05b26c3a171d 
------------------------------------------------------------------------ 
       User : IWAM_REDTEAM-52B93E3 
        Rid : 1004 
    Expired : false 
  Exception : false 
Lanman Hash : 6fd8ec0ee1ed2ffac2a89a4f770fa067 
    Nt Hash : 423d015c82d4bda2a9760154013fac1f 
------------------------------------------------------------------------ 
       User : SUPPORT_388945a0 
        Rid : 1001 
    Expired : false 
  Exception : false 
Lanman Hash : aad3b435b51404eeaad3b435b51404ee (Empty string) 
    Nt Hash : 672ecd041d7d16bd38c1f732ce377091 
------------------------------------------------------------------------ 
Secret : aspnet_WP_PASSWORD 
 Value : 
    61 00 71 00 36 00 25 00  55 00 40 00 24 00 57 00    |    a . q . 6 . % .  
U . @ . $ . W .  
    72 00 33 00 32 00 50 00  5c 00 65 00                |    r . 3 . 2 . P .  
\ . e .  
------------------------------------------------------------------------ 
Secret : D6318AF1-462A-48C7-B6D9-ABB7CCD7975E-SRV 
 Value : 
    c3 d5 7e 9f a3 d0 04 46  9a a3 15 1e 47 e9 df a2    |    . . ~ . . . . F  
. . . . G . . .  
------------------------------------------------------------------------ 
Secret : DPAPI_SYSTEM 
 Value : 
    01 00 00 00 82 85 f5 9c  6d ea 1b 52 42 f1 7e b1    |    . . . . . . . .  
m . . R B . ~ .  
    61 44 d0 14 c1 ef 49 bc  a5 ba e8 7c 5b 78 c6 35    |    a D . . . . I .  
. . . | [ x . 5  
    82 a1 79 09 94 e0 ab ed  cc f8 4c 55                |    . . y . . . . .  
. . L U  
------------------------------------------------------------------------ 
Secret : L$HYDRAENCKEY_28ada6da-d622-11d1-9cb9-00c04fb16e75
 Value : 
    52 53 41 32 48 00 00 00  00 02 00 00 3f 00 00 00    |    R S A 2 H . . .  
. . . . ? . . .  
    01 00 01 00 8d 65 0f f6  71 05 bb 9e 28 93 52 b4    |    . . . . . e . .  
q . . . ( . R .  
    c6 93 54 f1 2f 60 31 d0  13 f9 1c 49 53 b0 2c 46    |    . . T . / ` 1 .  
. . . I S . , F  
    45 ef 61 99 18 36 07 a2  8d 43 e5 04 8a bb 56 1a    |    E . a . . 6 . .  
. C . . . . V .  
    c1 a7 f4 18 a7 84 04 0d  7c 00 45 d8 85 28 90 02    |    . . . . . . . .  
| . E . . ( . .  
    da 26 d2 ba 00 00 00 00  00 00 00 00 0b 52 9d 71    |    . & . . . . . .  
. . . . . R . q  
    f7 aa 22 dd 9b 41 08 c7  e5 df 4f 7e f0 e6 2d 91    |    . . " . . A . .  
. . O ~ . . - .  
    32 8b da 25 1e 87 7a 27  e4 70 69 dc 00 00 00 00    |    2 . . % . . z '  
. p i . . . . .  
    c7 3d a8 93 84 a2 66 4e  a8 e0 9c 58 53 e1 63 42    |    . = . . . . f N  
. . . X S . c B  
    9c f7 11 98 ba e5 c2 11  be 88 52 15 d1 40 fc d8    |    . . . . . . . .  
. . R . . @ . .  
    00 00 00 00 f5 61 59 51  f4 eb bb 3f 90 db e4 ea    |    . . . . . a Y Q  
. . . ? . . . .  
    5c e4 66 8c 28 98 db 21  61 53 aa c1 dd d5 03 4d    |    \ . f . ( . . !  
a S . . . . . M  
    8c 78 6a b8 00 00 00 00  8b 9c 03 de 42 d9 5a 07    |    . x j . . . . .  
. . . . B . Z .  
    bf 8e 4c 70 33 54 c3 3a  cf cf b5 b8 8e a2 b2 6f    |    . . L p 3 T . :  
. . . . . . . o  
    cb e5 e0 3b bd 8c e4 d7  00 00 00 00 95 de fd c1    |    . . . ; . . . .  
. . . . . . . .  
    a9 dd 38 32 c9 e6 a1 40  3c c9 d7 17 63 0a ee 42    |    . . 8 2 . . . @  
 0 X . m h X .  
. M \ . . . . .  
    81 fa b9 9a e5 51 26 1f  ab 4e 47 bd 7e 26 05 0c    |    . . . . . Q & .  
. N G . ~ & . .  
    4e c7 ee 4b 2b d6 03 2d  7b 8e 4d 0b b3 3b 62 dd    |    N . . K + . . -  
{ . M . . ; b .  
    3e d5 29 b0 09 95 0f 6f  36 73 17 93 19 b3 56 76    |    > . ) . . . . o  
6 s . . . . V v  
    f4 e7 ba 73 29 d0 c3 90  3c bf 18 6b ed 24 fa 13    |    . . . s ) . . .  
< . . k . $ . .  
    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00    |    . . . . . . . .  
. . . . . . . .  
    00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00    |    . . . . . . . .  
. . . . . . . .  
    00 00 00 00 00 00 00 00  00 00 00 00                |    . . . . . . . .  
. . . .  
------------------------------------------------------------------------ 
Secret : L$RTMTIMEBOMB_1320153D-8DA3-4e8e-B27B-0D888223A588 
 Value : 
    00 d0 3a 2b 52 ac d8 01                             |    . . : + R . . .   
------------------------------------------------------------------------ 
Secret : L$TermServLiceningSignKey-12d4b7c8-77d5-11d1-8c24-00c04fa3080d 
 Value : 
------------------------------------------------------------------------ 
Secret : L$TermServLicensingExchKey-12d4b7c8-77d5-11d1-8c24-00c04fa3080d 
 Value : 
------------------------------------------------------------------------ 
Secret : L$TermServLicensingServerId-12d4b7c8-77d5-11d1-8c24-00c04fa3080d 
 Value : 
------------------------------------------------------------------------ 
Secret : L$TermServLicensingStatus-12d4b7c8-77d5-11d1-8c24-00c04fa3080d 
 Value : 
------------------------------------------------------------------------ 
Secret : L${6B3E6424-AF3E-4bff-ACB6-DA535F0DDC0A} 
 Value : 
    88 a8 11 1a 97 93 db 78  1d 98 84 19 83 97 72 c2    |    . . . . . . . x  
. . . . . . r .  
    f5 bf f8 98 20 fb d6 4b  d1 7e 88 4b f1 1c 4b b4    |    . . . .   . . K  
. ~ . K . . K .  
    f9 0d 69 97 a0 44 83 64  52 5d ec fb 2f 61 84 0a    |    . . i . . D . d  
R ] . . / a . .  
    75 b0 22 68 13 df 96 db                             |    u . " h . . . .   
------------------------------------------------------------------------ 
Secret : SAC 
 Value : 
    02 00 00 00                                         |    . . . .   
------------------------------------------------------------------------ 
Secret : SAI 
 Value : 
    02 00 00 00                                         |    . . . .   
------------------------------------------------------------------------ 
Secret : SCM:{148f1a14-53f3-4074-a573-e1ccd344e1d0} 
 Value : 
    00 00                                               |    . .   
------------------------------------------------------------------------ 
Secret : SCM:{3D14228D-FBE1-11D0-995D-00C04FD919C1} 
 Value : 
    32 00 30 00 52 00 56 00  3a 00 49 00 51 00 21 00    |    2 . 0 . R . V .  
: . I . Q . ! .  
    73 00 5f 00 51 00 34 00  25 00 47 00 00 00          |    s . _ . Q . 4 .  
% . G . . .  
------------------------------------------------------------------------ 
Secret : _SC_Alerter 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_ALG 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_aspnet_state 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_Dhcp 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_Dnscache 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_LicenseService 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_LmHosts 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_MSDTC 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_RpcLocator 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_RpcSs 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_stisvc 
 Value : 
------------------------------------------------------------------------ 
因为操作麻烦，暂不演示了。
Exploit
exploit就是漏洞的列表，简单说明见下表。
模块
漏洞
影响系统
默认端口
Easypi
IBM Lotus Notes
漏洞
Windows NT, 2000 ,XP, 2003
3264
Easybee
MDaemon
WorldClient电子
邮件服务器漏洞
WorldClient 9.5, 9.6, 10.0, 10.1
Eternalblue
SMBv2漏洞
MS17010
Windows XP32,Windows Server
2008 R232/64,Windows
732/64
139/445
Doublepulsar
SMB和NBT漏洞
Windows XP32, Vista, 7,
Windows Server 2003, 2008,
2008 R2
139/445
Eternalromance
SMBv1漏洞
MS17010和
NBT漏洞
Windows XP, Vista, 7, Windows
Server 2003, 2008, 2008 R2
139/445
Eternalchampion
SMB和NBT漏洞
Windows XP, Vista, 7, Windows
Server 2003, 2008, 2008 R2,
2012, Windows 8 SP0
139/445
Eternalsynergy
SMB和NBT漏洞
Windows 8, Windows Server 2012
139/445
Explodingcan
IIS6.0远程利用漏
洞
Windows Server 2003
80
Secret : _SC_TlntSvr 
 Value : 
------------------------------------------------------------------------ 
Secret : _SC_WebClient 
 Value : 
------------------------------------------------------------------------ 
    Command completed successfully 
模块
漏洞
影响系统
默认端口
Emphasismine
IMAP漏洞
IBM Lotus Domino 6.5.4, 6.5.5,
7.0, 8.0, 8.5
143
Ewokfrenzy
IMAP漏洞
IBM Lotus Domino 6.5.4, 7.0.2
143
Englishmansdentist
SMTP漏洞
25
Erraticgopher
RPC漏洞
Windows XP SP3, Windows 2003
445
Eskimoroll
kerberos漏洞
Windows 2000, 2003, 2003 R2,
2008, 2008 R2
88
Eclipsedwing
MS08067漏洞
Windows 2000, XP, 2003
139/445
Educatedscholar
MS09050漏洞
Windows vista, 2008
445
Emeraldthread
SMB和NBT漏洞
Windows XP, 2003
139/445
Zippybeer
SMTP漏洞
445
Esteemaudit
RDP漏洞
Windows XP, Windows Server
2003
3389
ImplantConfig
这些配置信息，用来生成Beacon，但是这个版本下，已经改用GUI来生成，这里就不折腾了。
总结
到此为止，基本上将Windows平台的Payloads关系理顺，这样可以在一个整体框架下分析，梳
理其中的关系，理解其体系结构，操作逻辑。
根据样本分析的信息，这些样本有了很长的捕获时间，也就是说这个平台运行了很长时间，里面
的模块的完成度也比较高。
从代码的耦合度和风格来看，这个平台应该是个python下的命令行界面，后来还增加了Java
Swing的GUI操作界面。
这些代码比较庞杂，经过很多公司，很多人的不懈努力，才慢慢捋顺，我尽可能把涉及到的文
章，添加到参考列表中。如果您发现自己的文章被引用，但是木有说明，请通知我添加。
在操作过程中，这个工具有支持gs脚本进行自动化的信息收集，并且Beacon支持Proxy方法，可
以作为进一步的支点，完成整个渗透的过程。
参考
 [分享]NSA工具fb.py eternalblue和doublepulsar模块测试-二进制漏洞-看雪论坛-安全社
区|安全招聘|bbs.pediy.com
 DoublePulsar  A Very Sophisticated Payload for Windows  SecPod Blog
 Defense in depth: DoublePulsar | Sumo Logic
 Analyzing the DOUBLEPULSAR Kernel DLL Injection Technique  FSecure Blog
 090928401445.pdf (venustech.com.cn)
 The Equation Group’s post-exploitation tools DanderSpritz and more) Part 1 
Kudelski Security Research
 Windows 远程漏洞利用工具总览分析 – 绿盟科技技术博客 (nsfocus.net)
 方程式组织DanderSpritz工具测试环境研究 - FreeBuf网络安全行业门户
 初识 Fuzzbunch  FreeBuf网络安全行业门户
 https://danderspritz.com
 x0rz/EQGRP_Lost_in_Translation: Decrypted content of odd.tar.xz.gpg,
swift.tar.xz.gpg and windows.tar.xz.gpg (github.com)
 NSA DanderSpiritz测试指南——木马生成与测试  3gstudent  Good in study, attitude
and health
 Introducing: DanderSpritz_Lab. Build fully functional DanderSpritz… | by Francisco
Donoso | Medium
 johnbergbom/PeddleCheap: Pcaps for PeddleCheap and implant communication +
script for interpreting and decrypting pcaps. (github.com)
 “方程式组织”攻击SWIFT服务提供商EastNets事件复盘分析报告 (antiy.cn)
 blog/NSA方程式工具利用与分析.md at master · sherlly/blog (github.com)
 Killsuit_Research_01.pdf (f-secure.com)