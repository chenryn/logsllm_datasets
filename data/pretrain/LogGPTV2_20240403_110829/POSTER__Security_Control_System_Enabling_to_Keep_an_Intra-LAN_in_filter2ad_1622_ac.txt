Furthermore, it also maintains the freshness of the message that limits adversarial access to data. Let us assume that 
node     forwards the data to the cluster head node     . Hence the format of the packet can be described as: 
where ′   : data sent to      ,    : reading of the node ‘A’,      : Data payload and   : Packet encrypted. 
Page 8 of 21 
The sent data using the MAC key      complies with the message authentication code of the data. Once cluster head 
node      receives the aggregated encrypted packet      from node    , it forwards to the next hop node       that 
could be either the BS or another cluster head. Thus, the data format can be sent as: 
   :  Resultant  aggregated  data  of  cluster  head  node,        :  Group  of  secret  random  keys  shared  by  either  two 
cluster head nodes or cluster head node and BS. 
We observed that data       could not be modified by the attacker while delivering the aggregation reports between 
intermediate nodes. By combining the features of Equations (6) and (9), we get authentication, integrity, hop-to-hop 
count, and end-to-end delay that lead to QoS provisioning    . Combining of these equations result: 
The intermediary node uses its processing unit to perform aggregation and de-aggregation functions. In addition, it 
has service access unit that helps in setting up and fine-tuning the timer-setting to perform the efficient aggregation. 
Finally,  the  intermediary  node  applies  the  aggregating-control  unit  to  take  the  decision  regarding  the  amount  of 
traffic to be forwarded to the next node in order to avoid possible congestion and data losses. These multiple units 
tighten the security by working as single aggregation unit as shown in Figure 2. 
When  traffic  is  tuned  and  refined,  the  intermediately  node  requires  picking  the  next  valid  communicating  cluster 
node        for  forwarding  specific  amount  of  traffic  based  on  the  capacity  of  the  node.  The sensed  reading        of 
sensor  node        and  resultant  aggregation  listening  capability       of        for  any  chosen  event       can  be  seen  in 
Equation (13). Thus, every valid cluster node     belonging to the respective      updates the valid       and invalid 
      information  of  cluster-Head    .  Hence,  valid  communicating  cluster  nodes          at  the  current  detection  time 
      can be obtained as: 
Furthermore,  we can identify  valid        and non-valid         cluster  nodes that  help improves the  authentication 
and integration process since there is a minimum chance of compromising the aggregated data. 
Where     :  affected  aggregated  data.  Hence,  this  process  correctly  determines  the  valid  (legitimate)  and  non-valid 
(malicious) sensor nodes to forward the aggregated data using equation (13). 
3.2.2.  Accuracy and Energy Efficiency 
Page 9 of 21Communication overhead consumes additional energy consumption. One of the goals of our proposed scheme is to 
provide  a  mechanism  to  reduce  the  communication  overhead  and  maintain  the  accuracy  by  offering  the  privacy 
preservation. Let us assume the network  N’ with       sensor nodes are exchanging the messages      and     . The 
exchanged messages between intermediate nodes can be described as: 
Equations  (17)  and  (18)  show  the  communication  overhead  of  the  messages  exchanged  between  the  two 
intermediate nodes. Using these two equations, the total communication overhead       of the exchanged messages 
can be calculated as follows: 
If we compare the overhead ratio       of our proposed approach with the well-known FESA, we see overhead ratio 
can be obtained as:   
Thus,  the  computation  overhead  of  the  proposed  SDAACA  scheme  is  lower  than  the  FESA  that  further  helps  in 
preserving the energy consumption. The overhead ratio for the proposed SDAACA scheme can be quantified as: 
In order to evaluate the energy consumption, the  sensing energy      can be computed by:              , where   is 
the constant that represents the energy to sense a bit of data and “    is sensing rate in bit/sec. For communication 
purpose, the energy dissipated      for sensor node     to transmit the packet size       of specific length to sensor 
node     can be obtained as: 
Where   :  one-hop  distance  between  two  sensor  nodes;  and            :  the  constant  parameters.  We  set  distance      
equivalent  to  one.  Once  dissipated  energy  is  obtained  for  transmitting  the  packet,  the  energy  for  receiving  the 
packets can be obtained as: 
The  description  of  used  notations  of  access  control  model  is  given  in  Table  1.  In  addition,  a  comparison  of  all 
parameters and computation of numerical values for the proposed SDAACA scheme and the  existing FESA model 
is presented in Table 1. The detail of used notations and description can be found in Table 2. 
4.  Simulation Setup and Experimental Results  
To show the practicality of the proposed scheme, we implement the secure data aggregation using access control and 
authentication for WSNs. Specifically, we create the model and run simulations for a realistic oil-refinery plant that 
currently experiencing several security and data privacy challenges. The network simulator (NS3.26) with Ubuntu-
16.04  operating  system  is  used  to  simulate  the  proposed  protocol.  The  objective  of  simulation  is  to  monitor  the 
different parts of an oil refinery plant including working staff and vehicles. Several scenarios are generated to show 
the  performance  of  the  proposed  protocol  against  malicious  attempts.  In  these  scenarios,  different  activities  are 
monitored  and  measured  to  reflect  the  problems  of  secure  data  aggregation  in  WSNs,  as  discussed  earlier  in  this 
Page 10 of 21paper. For our simulations, we also consider the mobility of the sensor nodes in these scenarios since mobility could 
affect the performance of the entire working process.  The scenarios replicate a real wireless sensor data aggregation 
environment. The obtained simulation results are  fairly considerable and identical to realistic tentative results. The 
main  objective  of  simulation  is  to  determine  the  performance  of  the  proposed  SDAACA  in  presence  of  malicious 
nodes and to identify the strength using QoS parameters. In addition, the performance of the proposed SDAACA is 
compared with secure data aggregation protocols such as SDA, SDAT, SEEDA, ESSDA, and FESA. For the sake of 
a realistic comparison, the similar factors/parameters are used for all data aggregation protocols for simulation.  
The  simulation  scenarios  involve  460  sensor  nodes  (maximum)  that  are  enough  to  cover  the  area  of  1280  *  1000 
square  meters.  However,  we  also  simulated  different  size  of  network  topologies  to  determine  the  impact  of  the 
topologies on our proposed and contending protocols. All  examined protocols show a similar behavior even for the 
smaller or larger network topologies. However, we observed that a network with 1280 * 1000 square meters is ideal 
to cover 460 nodes and could monitor all parts of an oil-refinery plant. We set the transmission range to 50 meters as 
this is considered as a sufficient range to transmit the data-frames to the next node. The standard energy for sensor 
node is set to 3.6 joules. However, we assign a higher energy to other nodes depending on their roles and the place 
of  deployment.  For  instance,  we  set  6  joules  energy  for  event-monitoring  nodes  and  cluster  nodes,  12  joules  for 
aggregator  node,  and  14 joules  for  cluster  head  node.  In  our  approach,  the  cluster  head  node  is  static  whereas  the 
cluster  nodes  can  be  either  static  or  mobile.  Different  bandwidths  are  set  for  each  node.  For  example,  the  event-
monitoring  node  has  a  bandwidth  of  30  kbps,  aggregator  node  has  a  bandwidth  of  65  kbps,  cluster  node  has  a 
bandwidth  kbps,  and  the  cluster  head  has  much  more  bandwidth  capacity  of  130  kbps.  All  the  bandwidth-setting 
parameters meet the standard criteria to handle the events in a real environment. Furthermore, we set 13.8 Mw and 
15.4  Mw  power  consumptions  for  receiving  and  transmitting  the  data,  respectively.  The  sensor  nodes  require  the 
pause time in some situation. We set a 20 second pause time with a 27 minute simulation time. Determining the next 
node  (neighbor  discovery  node),  the  least  distance  smart  neighboring  search  (LDSNS)  protocol  [39]  is  used.  The 
LDSNS  uses  small-sized  preamble  to  determine  the  one-hop  shortest  path  nodes.  The  preamble  is  sent  using 
Anycasting  addressing  methodology  to  deal  with  only  selected  nodes  at  the  one-hop  neighborhood.   The  results 
demonstrate an average of 15 simulation runs. The simulation parameters are summarized in Table 3. 
4.1. End-to-end delay 
The  lack  of  bidirectional  reliability  deteriorates  the  data  aggregation  process  and  gives  an  unsuitable  data 
aggregation collection. Figure 3 shows end-to-end delay of SDAACA and its comparison with other known secure 
data  aggregation  protocols.  We  reduce  the  overall  end-to-end  delay  using  an  authorization  process.  Furthermore, 
energy is preserved using short-range and 1-hop communication rather than long range communication. The advent 
of new mobility-based applications causes a higher network traffic rate to be common in  WSNs.  We demonstrate 
that  in  the  situation  of    high  network  traffic  rate,  reduction  in  end-to-end  delay  is  vital  for  improving  the  overall 
throughput performance. The effect of this reduction in end-to-end delay is possible due to the forwarding range of 
sensor  nodes,  as  can  be  seen  in  Figure  3.  The  message  monitoring  and  forwarding  processes  are  performed  using 
event-monitoring  nodes and aggregator nodes, respectively. Based on  the simulation results,  we observed that our 
proposed  SDAACA  protocol  produces  the  minimum  latency  as  compared  with  other  competing  data  aggregation 
protocols. The result confirms that the latency increases with respect to time. However, our proposed protocol has a 
maximum  latency  of  0.05  seconds  for  monitoring  single  events  consisting  of  15  hops,  whereas  other  competing 
protocols have higher latency between 0.06-0.072, which is considered quite high for sensitive applications. 
4.2. Resilience time and affected network 
We simulate to show the performance of network during resilience time after the sinkhole and the Sybil attacks, as 
shown in Figure 4. The attacker can launch several attacks (including both Sybil and sinkhole attacks) against a non-
secure synchronization time among different types of legitimate nodes [39-41]. Based on the results of Figure 4, we 
observe  a  linear  increase  in  the  affected  network  ration  with  respect  to  time.  However,  our  proposed  protocol  has 
less resilience time as compared to other competing protocols. Our protocol has a maximum resilience time between 
Page 11 of 210.037-0.074  seconds  with  9-18%  network  effect,  while  other  competing  protocols  has  a  resilience  time  of  0.056-
0.094 seconds with 9-18% network effect. The reason for better performance of our proposed approach is the use of 
access control that helps the BS in detecting the falsely calculated aggregated data. In addition, our authorization and 
freshness models correctly identify legitimate nodes and their communication process. Thus, there is  a less chance 
of  additional  resilience  time,  whereas  the  other  known  approaches  do  not  have  support  of  authorization  and 
freshness.  
4.3. Reliability and malicious trend of node  
Figure  5  shows  the  reliability  rates  in  the  presence  of  different  malicious  nodes  in  the  network.  To  determine  the 
effectiveness  of  our  proposed  model,  we  sampled  the  behavior  of  Sybil  and  sinkhole  attacks,  and  also  created 
malicious  nodes  to  launch  both  types  of  attacks.  Both  types  of  attacks  were  also  generated  for  other  known 
approaches  with  the  same  number  of  malicious  nodes.  Based  on  the  experimental  results,  we  observed  that  our 
proposed approach reaches the reliability of 98.8% with the presence of 9% malicious nodes that launch these types 
of attacks. When the number of malicious nodes increases up to 27%, our approach has a slightly lower reliability 
rate  of  approximately  98.65%.  The  results  show  that  our  approach  is  not  highly  affected  by  an  increase  in  the 
number of malicious nodes. On the other hand, the competing approaches have a relatively lower reliability rate of 
between  92.05-96.1%  with  9%  malicious  nodes.  When  the  number  of  malicious  nodes  increases  in  the  system 
(reaches  to  27%),  the  reliability  rate  of  the  competing  approaches  decreased  to  89.03-92.12%.  The  statistical  data 
indicates that our SDAACA outperforms other competing approaches in the presence of Sybil and sinkhole attacks 
generated  by  the  malicious  nodes.  This  is  due  to  the  fact  that  our  proposed  approach  initiates  the  authorization 
process prior to the start of the authentication for newly arrived nodes in the network.  
4.4. Energy consumption in presence of malicious nodes 
    The  existing  research  on  secure  data  aggregation  mostly  depends  on  energy  consumption  for  maintaining  QoS 
provisions. This is also a significant trade-off which has not properly been explored. The energy consumption and 
preservation processes are detected  when completing the event-monitoring process and continuing the sending and 
receiving of the data process. The energy is consumed when the data duplication process keeps continuing with the 
involvement of an adversary. As a result, several possible attacks are expected on the network, but we particularly 
focus on sinkhole and Sybil attacks and their negative impact for excess energy consumption. Based on the results, 
we observed that the energy consumption ratio increases when monitoring process increases.  Figures 6 shows that 
energy  consumption  increased  as  the  percentage  of  malicious  nodes  increased  with  an  additional  increase  of 
monitoring  process  time  (days).  Our  proposed  SDACCA  protocol  has  a  maximum  of  2.91,  3.32,  and  3.36  joules 
energy  consumption  with  10,  20,  and  30  malicious  nodes,  respectively.  On  the  other  hand,  the  other  known 
competing  approaches  consume  3.32-3.37,  3.6-4.32,  and  4.32-4.48  joules  with  10,  20,  and  30  malicious  nodes, 
respectively.  Our  SDACCA  approach  includes  the  feature  that  minimizes  the  communication  overhead  and 
maintains accuracy by reducing the additional amount of energy as well as maintaining the tradeoff between energy 
consumption and QoS provisioning. 
Page 12 of 21 
5.  Conclusion 
This paper presented secure data aggregation scheme using access control and authentication processes for handling 
two  types  of  attacks:  Sybil  and  sinkhole  attacks  in  WSNs.  The  proposed  scheme  aims  to  monitor  the  oil-refinery 
plant. We proposed two algorithms: a secure data fragmentation process and a node authorization process. The first 
algorithm helps in providing the secure data fragmentation to ensure the secure data communication and avoid any 
unexpected attacks by an adversary. In the second algorithm, we initiate the node authorization process to prevent 
illegitimate  nodes  entering  the  network.  Furthermore,  the  protocol  consists  of  an  access  control  scheme  primarily 
focusing on authentication, freshness, accuracy and energy consumption. In addition, these components maintain the 
tradeoff between energy efficiency, accuracy, and QoS provisioning. To show the practicality, our proposed scheme 
is  programmed  in  C++  and  implemented  in  NS3.  Based  on  extensive  experimental  results,  we  show  that  our 
proposed SDAACA protocol outperformed other similar types of schemes such as SDA, SDAT, SEEDA, ESSDA, 
and FESA. This comparison is done from the perspective of end-to-end delay, resilience time, reliability and energy 
consumption  in  the  presence  of  sinkhole  and  Sybil  attacks.  In  the  future,  we  intend  to  expand  on  our  proposed 
protocol using scalability and mobility models as well as analyzing the state-of-art QoS parameters.  
References 
1.  Razaque, Abdul, and Khaled M. Elleithy. "Energy-efficient boarder node  medium access control protocol 
for wireless sensor networks." Sensors 14, no. 3 (2014): 5074-5117. 
2.  Li,  Hongjuan,  Kai  Lin,  and  Keqiu  Li.  "Energy-efficient  and  high-accuracy  secure  data  aggregation  in 
wireless sensor networks." Computer Communications 34, no. 4 (2011): 591-597. 
3.  Liu,  Chen‐Xu,  Yun  Liu,  Zhen‐Jiang  Zhang,  and  Zi‐Yao  Cheng.  "High  energy‐efficient  and 
privacy‐preserving  secure  data  aggregation  for  wireless  sensor  networks." International  Journal  of 
Communication Systems 26, no. 3 (2013): 380-394. 
4.  Roy,  Sankardas,  Mauro  Conti,  Sanjeev  Setia,  and  Sushil  Jajodia.  "Secure  data  aggregation  in  wireless 
sensor  networks:  Filtering  out  the  attacker's  impact." IEEE  Transactions  on  Information  Forensics  and 
Security 9, no. 4 (2014): 681-694. 
5.  Conti,  Mauro.  "Secure  Data  Aggregation."  In Secure  Wireless  Sensor  Networks,  pp.  101-124.  Springer 
New York, 2016. 
6.  Razaque,  Abdul,  and  Khaled  Elleithy.  "Modular  energy-efficient  and  robust  paradigms  for  a  disaster-
recovery process over wireless sensor networks."Sensors 15, no. 7 (2015): 16162-16195. 
7.  Wang, Taochun, Xiaolin Qin, and Liang Liu. "An energy-efficient and scalable secure data aggregation for 
wireless sensor networks." International Journal of Distributed Sensor Networks 2013 (2013). 
8.  Kumar,  Manish,  Shekhar  Verma,  and  Kusum  Lata.  "Secure  data  aggregation  in  wireless  sensor  networks 
using homomorphic encryption." International Journal of Electronics 102, no. 4 (2015): 690-702. 
9.  Li,  Xing,  Dexin  Chen,  Chunyan  Li,  and  Liangmin  Wang.  "Secure  data  aggregation  with  fully 
homomorphic encryption in large-scale wireless sensor networks." Sensors 15, no. 7 (2015): 15952-15973. 
10.  Jariwala, Vivaksha, Himanshu Patel, Parth Patel, and Devesh C. Jinwala. "Integrity and Privacy Preserving 
Secure Data Aggregation in Wireless Sensor Networks." International Journal of Distributed Systems and 
Technologies (IJDST) 5, no. 3 (2014): 77-99. 
11.  Othman,  Soufiene  Ben,  Abdelbasset  Trad,  Habib  Youssef,  and  Hani  Alzaid.  "Secure  data  aggregation  in 
wireless  sensor  networks."  In Ad  Hoc  Networking  Workshop  (MED-HOC-NET),  2013  12th  Annual 
Mediterranean, pp. 55-58. IEEE, 2013. 
12.  Vaidehi, V., R. Kayalvizhi, and N. Chandra Sekar. "Secure data aggregation in wireless sensor networks." 
In Computing  for  Sustainable  Global  Development  (INDIACom),  2015  2nd  International  Conference  on, 
pp. 2179-2184. IEEE, 2015. 
Page 13 of 2113.  Huang, Shih-I., Shiuhpyng Shieh, and J. D. Tygar. "Secure encrypted-data aggregation for wireless sensor 
networks." Wireless Networks 16, no. 4 (2010): 915-927. 
14.  Groat,  Michael  M.,  Wenbo  Hey,  and  Stephanie  Forrest.  "KIPDA:  k-indistinguishable  privacy-preserving 
data  aggregation  in  wireless  sensor  networks."  In INFOCOM,  2011  Proceedings  IEEE,  pp.  2024-2032. 
IEEE, 2011 
15.  Ozdemir,  Suat,  and  Yang  Xiao. "Integrity  protecting  hierarchical  concealed  data  aggregation  for  wireless 
sensor networks." Computer Networks 55, no. 8 (2011): 1735-1746. 
16.  Chen, Chien-Ming, Yue-Hsun Lin, Ya-Ching Lin, and Hung-Min Sun. "RCDA: recoverable concealed data 