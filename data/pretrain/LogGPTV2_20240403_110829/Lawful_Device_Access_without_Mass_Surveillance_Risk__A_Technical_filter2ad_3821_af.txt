2018.
[17] Legal Process Guidelines.
enforcement-guidelines-us.pdf, 2018.
https://www.apple.com/legal/privacy/law-
[18] Linkedin Law Enforcement Data Request Guidelines. https://help.linkedin.com/
ci/fattach/get/7890851/0/filename/Law_Enforcement_Guidelines_January%
202018.pdf, 2018.
[19] Policy
Approaches
to
the
Encryption Debate.
https://
2o9ub0417chl2lg6m43em6psi2i-wpengine.netdna-ssl.com/wp-content/
uploads/2018/04/133-1-1.pdf, Mar. 2018.
[20] H. Abelson, R. Anderson, S. M. Bellovin, J. Benaloh, M. Blaze, W. Diffie, J. Gilmore,
M. Green, S. Landau, P. G. Neumann, R. L. Rivest, J. I. Schiller, B. Schneier,
M. A. Specter, and D. J. Weitzner. Keys under doormats: mandating insecurity
by requiring government access to all data and communications. Journal of
Cybersecurity, 1(1):69–79, 2015.
[21] Andrey Belenko. iOS Forensics with Open-Source Tools. https://www.blackhat.
com/docs/sp-14/materials/arsenal/sp-14-Belenko-IOS-Forensics-Slides.pdf,
2014.
[22] D. Barrett. FBI repeated overstated encryption threat figures to Congress, public.
Washington Post, May 2018.
[23] M. Bellare and S. Goldwasser. Encpasulated key escrow. Technical Report 688,
MIT Laboratory for Computer Science, Apr. 1996.
[24] M. Bellare and S. Goldwasser. Verifiable Partial Key Escrow. In ACM Conference
on Computer and Communications Security, 1997.
[25] M. Bellare and B. Yee. Forward-Security in Private-Key Cryptography. In Topics
in Cryptology — CT-RSA 2003, 2003.
[26] S. M. Bellovin, M. Blaze, D. Boneh, S. Landau, and R. Rivest. Op-ed: Ray Ozzie’s
crypto proposal—a dose of technical reality. https://arstechnica.com/information-
technology/2018/05/op-ed-ray-ozzies-crypto-proposal-a-dose-of-technical-
reality/, May 2018.
[27] S. M. Bellovin, M. Blaze, S. Clark, and S. Landau. Lawful Hacking: Using Ex-
isting Vulnerabilities for Wiretapping on the Internet. Northwestern Journal of
Technology and Intellectual Propertuy, 12(1):1–66, 2014.
[28] M. Blaze. Oblivious Key Escrow. Lecture Notes in Computer Science, 1174:335–343,
1996.
May 2006.
[29] C. A. Boyd, X. Boyen, C. Carr, and T. Haines. Key recovery: Inert and Public.
Lecture Notes in Computer Science, 10311, 2017.
[30] L. Cauley. NSA has massive database of Americans’ phone calls. USA Today,
[31] D. Chaum, D. Das, F. Javani, A. Kate, A. Krasnova, J. D. Ruiter, and A. T. Sherman.
cMix: Mixing with Minimal Real-Time Asymmetric Cryptographic Operations.
IACR Cryptology ePrint Archive, 2016:008, 2016.
[32] S. Checkoway, J. Maskiewicz, C. Garman, J. Fried, S. Cohney, M. Green,
N. Heninger, R.-P. Weinmann, E. Rescorla, and H. Shacham. A systematic anal-
ysis of the Juniper Dual EC incident. In Proceedings of the ACM Conference on
Computer and Communications Security, 2016.
[33] F. Courbon, S. Skorobogatov, and C. Woods. Reverse Engineering Flash EEPROM
Memories Using Scanning Electron Microscopy. In Proceedings of the International
Conference on Smart Card Research and Advanced Applications (CARDIS), pages
57–72. Springer, 2017.
[34] EFF. What’s the likely global impact if the FCC approves the tentative rules set
forth in the NPRM. https://www.eff.org/pages/calea-faq#19, 2004.
[35] Ernest Worthman. Why Every Chip Can Be Hacked With This Tool. Semiconduc-
tor Engineering, Aug. 2014.
[36] S. Ghosh. Apple, Amazon and Microsoft and helping Google fight an order to
hand over foreign emails. Business Insider, Mar. 2017.
[37] M. Green.
A few thoughts on Ray Ozzie’s
’CLEAR’ Proposal.
https://blog.cryptographyengineering.com/2018/04/26/a-few-thoughts-
on-ray-ozzies-clear-proposal/, Apr. 2018.
[38] A. Greenberg. The father of online anonymity has a plan to end the crypto war.
Wired, Jan. 2016.
[39] D. James, D. Yang, S. Wegner, C. Davis, and A. Cowsky.
Inside the
iPhone 6S. http://www.techinsights.com/about-techinsights/overview/blog/
inside-the-iphone-6s/, 2018.
[40] J. Kelsey. Dual EC in X9.82 and SP 800-90. https://csrc.nist.gov/csrc/media/
projects/crypto-standards-development-process/documents/dualec_in_x982_
and_sp800-90.pdf.
[41] J. Kong, F. Koushanfar, P. K. Pendyala, A.-R. Sadeghi, and C. Wachsmann. Pu-
fatt: Embedded platform attestation based on novel processor-based pufs. In
Proceedings of the Design Automation Conference, New York, NY, USA, 2014.
[42] S. Levy. Cracking the crypto war. Wired, Apr. 2018.
[43] Y. Li, K. Sakiyama, S. Gomisawa, T. Fukunaga, J. Takahashi, and K. Ohta. Fault
sensitivity analysis. In Proceedings of the Workshop on Cryptographic Hardware
and Embedded Systems, Berlin, Heidelberg, 2010.
[44] V. Lomne, T. Roche, and A. Thillard. On the Need of Randomness in Fault Attack
Countermeasures—Application to AES. In Proceedings of the Workshop on Fault
Diagnosis and toleraing in Cryptography, Sept. 2012.
Jan. 2017.
[45] J. Markoff and S. Shane. Documents Show Link Between AT&T and Agency in
Eavesdropping Case. New York Times, Apr. 2006.
[46] P. Mishra, S. Bhunia, and M. Tehranipoor. Hardware IP Security and Trust. Springer
Publishing Company, Incorporated, 1st edition, 2017.
[47] H. Nguyen. Lawful hacking: towards a middle-ground solution to the going dark
problem. Master’s thesis, Naval Postgraduate School, Monterey, California, Mar.
2017.
[48] R. Ozzie. CLEAR. https://github.com/rayozzie/clear/blob/master/clear-rozzie.pdf,
[49] S. Patranabis, A. Chakraborty, D. Mukhopadhyay, and P. Chakrabarti. Using
State Space Encoding To Counter Biased Fault Attacks on AES Countermeasures.
IACR Cryptology ePrint Archive, 2015:806, 2015.
[50] R. Pfefferkorn.
The Risks of
’Responsible Encryption’.
https:
//cyberlaw.stanford.edu/files/publication/files/2018-02-05%20Technical%
20Response%20to%20Rosenstein-Wray%20FINAL.pdf, Feb. 20185.
[51] T. Reed.
GreyKey iPhone unlocker poses serious security concerns.
https://blog.malwarebytes.com/security-world/2018/03/graykey-iphone-
unlocker-poses-serious-security-concerns/, Mar. 2018.
[52] J. Risen and E. Lichtblau. Bush Lets U.S. Spy on Callers without Courts. New
[53] P. Rogaway. The moral character of cryptographic work.
IACR Cryptology
[54] C. Savage. Justice Dept. Revives Push to Mandate a Way to Unlock Phones. New
York Times, Dec. 2005.
ePrint Archive, 2015:1162, 2015.
York Times, Mar. 2018.
[55] M. Scanlon. Battling the Digital Forensic Backlog through Data Deduplication.
In Proceedings of the IEEE International Confernece on Innovative Computing
Technology, Aug. 2016.
[56] M. Seaborn and T. Dullien.
to gain kernel privileges.
exploiting-dram-rowhammer-bug-to-gain.html, Mar. 2015.
Exploiting the DRAM rowhammer bug
https://googleprojectzero.blogspot.com/2015/03/
[57] R. Staff. FBI paid under 1 million to unlock San Bernardino iPhone: sources.
Reuters, Apr. 2016.
[58] Tarjei Mandt and Mathew Solnik and David Wang.
Demystifying the
Secure Enclave Processor. https://www.blackhat.com/docs/us-16/materials/
us-16-Mandt-Demystifying-The-Secure-Enclave-Processor.pdf, 2016.
[59] Thomas Fox-Brewster. It Might Cost the FBI Just $1,500 To Get Into Terrorist’s
iPhone. Forbes, Mar. 2016.
[60] R. Torrance and D. James. The State-of-the-Art in IC Reverse Engineering.
In Proceedings of the International Workshop on Cryptographic Hardware and
Embedded Systems(CHES), pages 363–381, 2009.
[61] E. Tromer. Eran Tromer’s Attack on Ray Ozzie’s CLEAR Protocol. https://www.
cs.columbia.edu/~smb/blog/2018-05/2018-05-02.html, May 2018.
[62] J. Williams. The Unofficial Guide to Facebook’s Law Enforcement Portal Version
2. https://cdn.netzpolitik.org/wp-upload/2016/08/facebook-law-enforcement-
portal-inofficial-manual.pdf, 2013.
[63] C. Wray. Raising Our Game: Cyber Security in an Age of Digital Transforma-
tion. https://www.fbi.gov/news/speeches/raising-our-game-cyber-security-in-
an-age-of-digital-transformation, 2018.
[64] C. Wright and M. Varia. Crypto Crumple Zones: Enabling limited Access without
Mass Surveillance. In Proceedings of the IEEE European Symposium on Security
and Privacy, 2018.
Appendix A COMMON QUESTIONS
Because of the long history of conflict over lawful access, there
are a set of standard questions that invariably arise. While these
questions have been addressed implicitly in the paper, we believe
there is value in calling them out explicitly here to avoid potential
misunderstandings.
• What prevents a criminal from simply using a third-party encryp-
tion product above the operating system? or purchasing a phone
abroad in a jurisdiction that doesn’t support lawful access?
The answer is that nothing prevents such behavior. We do not
believe there is an implementable policy option that would provide
a universal decryption capability.38 We also believe that this is a
completely acceptable outcome. The reality is that most criminals
will not use such third-party products (or if they do, will not use
them in a secure fashion, with device-independent credentials),
38Even the wildly overreaching Feinstein/Burr “Court Orders Act”, which mandates
plain-text access capability for all software, services and products sold, would not
achieve this goal if implemented.
just as most criminals do not encrypt their telephone calls or their
instant messages. It is not a new phenomenon that criminals with
stronger operational security practices will require greater effort
to investigate.
• What about in an emergency? Surely a device could be unlocked if
a victim’s life depended on it?
The nature of the system we’ve described is that it makes tradeoffs
that are inherently compromises. The purpose of the lockout period
is to undermine the use of this mechanism for covert purposes and
an inherent side effect of that design choice is that there is no
mechanism for “expedient access”. The choice of the lockout period
duration implicitly balances the likelihood and costs of one scenario
against the likelihood and costs of the other.
• What if the manufacturer gets hacked by a state actor?
It has become fashionable to observe that, with the plethora of
high-profile state-sponsored data-breaches (e.g., OPM), virtually all
organizations are susceptible. In some ways this may be true, but it
is worth reflecting on the consequence of this truth. Thus, if we are
confident that state actors will so thoroughly penetrate a manufac-
turer as to compromise an offline HSM containing authorization
keys and then jump the air gap again to exfiltrate those keys, how
much trust can we place in the security of the significantly more
valuable assets that the manufacturer must already protect? For
example, capturing the signing keys for device update would allow
the creation of new code updates for any of the manufacturer’s
devices—providing arbitrary remote access at arbitrary scale. Simi-
larly, any developer account with commit rights to system level code
is in a position to insert obfuscated vulnerabilities to be released in
later software versions and, as with updates, provide large-scale re-
mote covert capabilities.39 Moreover, leading device manufacturers
(e.g., Apple, Google) frequently have access to much of their cus-
tomer’s content online (e.g., via standard backup services, and via
cloud services such as photos on Apple iCloud and e-mail Google’s
Gmail) and these are available to key employees and systems. All
of these would appear to be easier and/or more attractive targets
for state actors. This is not to imply that manufacturers are not
indeed vulnerable to such attacks, but that we should not hold a
significantly weaker lawful access capability to a higher standard
of state actor-resistance than more valuable existing capabilities.
• Don’t all lawful access schemes inherently weaken the security of
the device?
Part of the answer to this question is philosophical. Security is,
among other things, about limiting data access to authorized par-
ties. If we do not believe that law enforcement agents operating
under color of law are authorized, then yes, by definition, any law-
ful access scheme weakens security. However, this is a definition
that presupposes an answer and is an inherently non-technical
argument. If instead we accept the assumptions of this paper (i.e.,
that there is a communal interest in considering some such access
authorized) then the answer to this question is more nuanced. Now
the question is, what is the residual risk that the mechanism pro-
vided for lawful access will be misused in unlawful ways? We do not
39While the precise timeline and authorship of the several code and data implants
in the Juniper NetScreen case may never be publicly known, even the most conser-
vative account of the evidence supports a finding that malicious code commits were
commercially distributed for well over a year without discovery [32].
believe the answer to this question is clear and we have yet to iden-
tify how the approach described in this paper offers significantly
greater residual risks than those we already face today.
• Isn’t this scheme vulnerable to a variant of Tromer’s attack on
CLEAR?
As described, a qualified yes. Eran Tromer’s attack on Ozzie’s
CLEAR proposal is a trojan man-in-the-middle attack in which an
adversary attacks a phone x, by creating an imitation phone x′ that
purports to be x (e.g., by announcing the did the attacker obtains
from x) and then plants the imitation phone (e.g., at a crime scene)
to entice law enforcement to unlock the phone using their lawful
access protocol. The imitation phone then relays all authorization
protocol messages it receives from law enforcement to the attacker
who is then able to replay them to the targeted phone to unlock it
(the attack is described in more detail here [61]). This attack exploits
the implicit trust placed in the authorization protocol messages
produced by a device under interrogation by law enforcement and
we have made no efforts to address it (i.e., in our current design
there is no attempt to authenticate that a device is who it says it is).
However, the attack places unusually demanding requirements
on the adversary: that they must obtain extended physical access
to the target device (i.e., to obtain its did value), then must also
create a replica device with internal hardware that will spoof the
authorization protocol, then must convince law enforcement to
seize that device and obtain legal process for opening it. Most criti-
cally, they must devise a mechanism such that their replica device
can transmit the messages it receives while in law enforcement
custody (seized devices are routinely stored and accessed in RF
shielded environments precisely because law enforcement is con-
cerned about outside tampering with a device). This is not to say
that such a scenario is impossible. However, in our estimation it is
at the far end of the threat spectrum and we feel that the value in
addressing this particular threat is far outweighed by the value of
simplicity in the current design. That said, we are confident that
should others disagree with this assessment, there are a range of
technical solutions that could be employed (e.g., time-bounding
to prevent real-time relaying and explicit device authentication
via a shared secret before providing any authorization material) to
address this concern.