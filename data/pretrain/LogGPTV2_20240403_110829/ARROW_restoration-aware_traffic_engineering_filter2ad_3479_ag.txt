Management During COVID-19 and Beyond.. In NSDI. 217‚Äì231.
[86] Jin Y Yen. 1971. Finding the k shortest loopless paths in a network. management
(2020).
Science 17, 11 (1971), 712‚Äì716.
[87] Y. Yoshida, A. Maruta, K.-I. Kitayama, M. Nishihara, T. Tanaka, T. Takahara, J.C.
Rasmussen, N. Yoshikane, T. Tsuritani, I. Morita, Shuangyi Yan, Yi Shu, Yan Yan, R.
Nejabati, G. Zervas, D. Simeonidou, R. Vilalta, R. Munoz, R. Casellas, R. Martinez,
A. Aguado, V. Lopez, and J. Marhuenda. 2015. SDN-Based Network Orchestration
of Variable-Capacity Optical Packet Switching Network Over Programmable
Flexi-Grid Elastic Optical Path Network. Lightwave Technology, Journal of 33, 3
(Feb 2015), 609‚Äì617.
[88] Hui Zang, Jason P Jue, Biswanath Mukherjee, et al. 2000. A review of routing
and wavelength assignment approaches for wavelength-routed optical WDM
networks. Optical networks magazine 1, 1 (2000), 47‚Äì60.
[89] Chengliang Zhang, Junjie Li, Haiqiang Wang, Aihua Guo, and Christopher Janz.
2019. Evaluation of Dynamic Optical Service Restoration on a Large-Scale
ROADM Mesh Network. IEEE Communications Magazine 57, 4 (2019), 138‚Äì143.
[90] Zhizhen Zhong, Manya Ghobadi, Maximilian Balandat, Sanjeevkumar Katti, Ab-
bas Kazerouni, Jonathan Leach, Mark McKillop, and Ying Zhang. 2021. BOW: First
Real-World Demonstration of a Bayesian Optimization System for Wavelength
Reconfiguration. In 2021 Optical Fiber Communications Conference (OFC).
[91] Zhizhen Zhong, Nan Hua, Massimo Tornatore, Jialong Li, Yanhe Li, Xiaoping
Zheng, and Biswanath Mukherjee. 2019. Provisioning Short-Term Traffic Fluctu-
ations in Elastic Optical Networks. IEEE/ACM Transactions on Networking 27, 4
(2019), 1460‚Äì1473.
[92] John Zyskind and Atul Srivastava. 2011. Optically amplified WDM networks.
Academic press.
Special Interest Group on Data Communication on the Applications, Technolo-
gies, Architectures, and Protocols for Computer Communication (SIGCOMM ‚Äô20).
Association for Computing Machinery, New York, NY, USA, 139‚Äì153. https:
//doi.org/10.1145/3387514.3405858
[49] Xin Jin, Yiran Li, Da Wei, Siming Li, Jie Gao, Lei Xu, Guangzhi Li, Wei Xu, and
Jennifer Rexford. 2016. Optimizing bulk transfers with software-defined optical
WAN. In Proceedings of the 2016 ACM SIGCOMM Conference. 87‚Äì100.
[50] Masahiko Jinno, Bartlomiej Kozicki, Hidehiko Takara, Atsushi Watanabe, Yoshi-
aki Sone, Takafumi Tanaka, and Akira Hirano. 2010. Distance-adaptive spectrum
resource allocation in spectrum-sliced elastic optical path network [topics in
optical communications]. IEEE Communications Magazine 48, 8 (2010), 138‚Äì145.
[51] Joseph Junio, Daniel C Kilper, and Vincent WS Chan. 2012. Channel power
excursions from single-step channel provisioning. IEEE/OSA Journal of Optical
Communications and Networking 4, 9 (2012), A1‚ÄìA7.
[52] Takuya Kanai, Yumiko Senoo, Kota Asaka, Jun Sugawa, Hideaki Tamai, Hiroyuki
Saito, Naoki Minato, Atsushi Oguri, Seiya Sumita, Takehiro Sato, et al. 2018.
Novel automatic service restoration technique by using self-reconfiguration
of network resources for a disaster-struck metro-access network. Journal of
Lightwave Technology 36, 8 (2018), 1516‚Äì1523.
[53] Nanxi Kang, Monia Ghobadi, John Reumann, Alexander Shraer, and Jennifer
Rexford. 2015. Efficient traffic splitting on commodity switches. In Proceedings of
the 11th ACM Conference on Emerging Networking Experiments and Technologies.
1‚Äì13.
[54] Ginni Khanna, Shengxiang Zhu, Mark Filer, Christos Gkantsidis, Francesca Parmi-
giani, and Thomas Karagiannis. 2020. Towards all optical DCI networks, In Opti-
cal Fiber Communication Conference (OFC) 2020. Optical Fiber Communication
Conference (OFC) 2020, W2A.33. https://doi.org/10.1364/OFC.2020.W2A.33
[55] D Kilper, M Bhopalwala, H Rastegarfar, and W Mo. 2015. Optical power dynamics
in wavelength layer software defined networking. In Photonic Networks and
Devices. Optical Society of America, NeT2F‚Äì2.
[56] Adil Kodian and Wayne D Grover. 2005. Failure-independent path-protecting
p-cycles: Efficient and simple fully preconnected optical-path protection. Journal
of lightwave technology 23, 10 (2005), 3241.
[57] Praveen Kumar, Chris Yu, Yang Yuan, Nate Foster, Robert Kleinberg, and Robert
Soul√©. 2018. YATES: Rapid prototyping for traffic engineering systems. In Pro-
ceedings of the Symposium on SDN Research. 1‚Äì7.
[58] Praveen Kumar, Yang Yuan, Chris Yu, Nate Foster, Robert Kleinberg, Petr La-
pukhov, Chiun Lin Lim, and Robert Soul√©. 2018. Semi-oblivious traffic engineer-
ing: The road not taken. In NSDI‚Äô18. 157‚Äì170.
[59] Danny Lahav, Haim Moshe, Arie Menscher, and Aryeh Lezerovitz. 2006. Com-
bined SONET/SDH and OTN architecture. (Sept. 12 2006). US Patent 7,106,968.
[60] Youngseok Lee, Yongho Seok, Yanghee Choi, and Changhoon Kim. 2002. A
constrained multipath traffic engineering scheme for MPLS networks. In ICC
(2002). IEEE, 2431‚Äì2436.
[61] George Leopold. 2017. Building Express Backbone: Facebook‚Äôs new long-haul
network. http://code.facebook.com/posts/1782709872057497/. (2017).
[62] Yao Li and Daniel C Kilper. 2018. Optical physical layer SDN. Journal of Optical
Communications and Networking 10, 1 (2018), A110‚ÄìA121.
[63] Hongqiang Harry Liu, Srikanth Kandula, Ratul Mahajan, Ming Zhang, and David
Gelernter. 2014. Traffic engineering with forward fault correction. In Proceedings
of the 2014 ACM conference on SIGCOMM. 527‚Äì538.
[64] Biswanath Mukherjee. 2006. Optical WDM networks. Springer Science & Business
[65] Biswanath Mukherjee, Dhritiman Banerjee, Sav Ramamurthy, and Amarnath
Mukherjee. 1996. Some principles for designing a wide-area WDM optical net-
work. IEEE/ACM transactions on networking 4, 5 (1996), 684‚Äì696.
[66] Gurobi Optimization. [n. d.]. Gurobi optimizer. ([n. d.]). http://www.gurobi.com.
[67] Yan Pan, Daniel C Kilper, Annalisa Morea, Joseph Junio, and Vincent WS Chan.
2012. Channel power excursions in GMPLS end-to-end optical restoration with
single-step wavelength tuning. In OFC/NFOEC. IEEE, 1‚Äì3.
[68] Coriant White Paper. [n. d.]. The role of OTN switching in 100G & beyond
transport networks. ([n. d.]). https://www.ofcconference.org/getattachment/
90c0e6a4-08c1-45fb-a7f2-2957d444dc7d/The-Role-of-OTN-Switching-in-
100G-Beyond-Transpo.aspx.
[69] Abhinav Pathak, Ming Zhang, Y Charlie Hu, Ratul Mahajan, and Dave Maltz.
2011. Latency inflation with MPLS-based traffic engineering. In Proceedings of the
2011 ACM SIGCOMM conference on Internet measurement conference. 463‚Äì472.
[70] Prabhakar Raghavan and Clark D Tompson. 1987. Randomized rounding: a
technique for provably good algorithms and algorithmic proofs. Combinatorica
7, 4 (1987), 365‚Äì374.
[71] Byrav Ramamurthy and Ashok Ramakrishnan. 2000. Virtual topology reconfigu-
ration of wavelength-routed optical WDM networks. In GLOBECOM.
[72] S Ramamurthy and Biswanath Mukherjee. 1999. Survivable WDM mesh networks.
II. Restoration. In 1999 IEEE International Conference on Communications (Cat.
No. 99CH36311), Vol. 3. IEEE, 2023‚Äì2030.
[73] Kim B Roberts, James Harley, and David Boertjes. 2020. Adjustment of control
(Sept. 22 2020). US Patent
parameters of section of optical fiber network.
10,784,980.
Media.
A APPENDIX
Appendices are supporting material that has not been peer-reviewed.
A.1 Path Inflation and Modulation Change
After Restoration
Fiber path length inflation. An important factor in Arrow is the
potential path inflation when the length of the surrogate restoration
fiber path (R-path) is significantly longer than the original primary
fiber path (P-path). Fig. 17 plots the CDF of the path inflation ratio
(restoration path length divided by primary path length) for Arrow
to perform optical restoration with and without frequency tuning
at Facebook. Interestingly, the figure shows that, on average, 50%
of IP links‚Äô restoration paths are shorter than the corresponding
primary paths. This means the modulation formats of the restored
wavelengths do not need to be reconfigured, thus simplifying Ar-
row‚Äôs operations. For the remaining IP links whose restoration
paths are longer than their primary path, we plot the top 10 longest
restoration paths in Fig. 17(b) (with transponder frequency tun-
ing) and Fig. 17(c) (without transponder frequency tuning). We
observe that all restoration fiber paths are shorter than 5,000 km;
hence, they can support 100 Gbps modulation based on our device
datasheet in Table 6. Higher datarates may be possible for some
shorter paths, and restoring such highly-modulated wavelengths to
a longer restoration fiber path may trigger the change of modula-
tion formats. Prior work has demonstrated that modulation change
latency in WANs is 70 seconds using commodity hardware and can
be improved to 35 ms [77].
WAN transponders datarate vs. reach. We use the following
specifications from our optical device vendors to plan and man-
age the optical layer at Facebook. For the same wavelength slot,
higher capacity is achieved with more aggressive modulation, thus
requiring shorter transmission distance [34, 76, 77]. Note that ad-
vanced modulation techniques, e.g. probabilistic constellation shap-
ing, could even extend the optical reach with finer-granularity data
rates [24].
Daterate (Gbps)
100
200
300
400
Reach (km)
5000
3000
1500
1000
Table 6: Terrestrial long-haul optical transponder specifica-
tion sheet at Facebook.
A.2 Routing and Wavelength Assignment
(RWA) Formulation
The RWA is a classical problem in optical networking [88]. Here,
we show the RWA formulation used in Arrow.
Separation of routing and wavelength assignment. Routing
and wavelength assignment problems can be combined into one
formulation, but Arrow separates the routing step from the wave-
length assignment step. The RWA problem is known to be compu-
tational intractable because it requires jointly optimizing a wave-
length‚Äôs routing path length and the wavelength‚Äôs frequency and
ùëí , ..., ùëÉùëò
modulation assignment. Arrow‚Äôs separation significantly reduces
the formulation complexity, making the problem solvable for large
topologies like Facebook within several minutes, while not compro-
mising optimality because routing paths are pre-computed respect-
ing wavelengths‚Äô modulation format maximum transmission reach
as noted in Table 6. Note that our RWA is solved on a provisioned
brown-field (some wavelengths are already populated to carry live
traffic) optical network for restoring the failed wavelengths only,
while prior proposals are for green-field optical network planning
(the network uses dark fibers, and no wavelengths are populated).
This is another reason why our RWA can be solved within several
minutes.
Routing the restored wavelengths. Consider a fiber cut scenario
ùëû where a set of IP links ùê∏ is lost. To restore each IP link ùëí ‚àà ùê∏ and
revive its IP layer capacity, we run ùëò-shortest-path algorithm [86] to
find its ùëò surrogate fiber paths {ùëÉ1
ùëí } with path-length upper
bounds based on the modulation format of the failed IP links.10
Note that we allow multiple restored wavelengths of an IP link to be
routed over multiple surrogate restoration fiber paths because their
IP-layer bandwidth capacity can be aggregated thanks to the link
aggregation protocol (IEEE 802.3ad LACP) [44]. We then represent
the routing information using a binary parameter ùúãùëí,ùëò
ùúô as 1 if a fiber
ùúô ‚àà ùëÉùëò
Wavelength assignment of the restored wavelengths. After
obtaining the routing path for restored wavelengths, we need to
assign a frequency to each restored wavelength. Consider a fiber
ùúô on the optical layer topology; its spectrum occupancy can be
represented by a binary vector ùúô.ùë†ùëùùëíùëêùë°ùëüùë¢ùëö = [0, 0, 1, ..., 1, 0] (e.g.,
96 wavelength slots under ITU-T DWDM standard [38]), where 0
means this wavelength slot is already utilized by some working
wavelengths carrying live traffic, and 1 means this wavelength slot
is available for hosting the reconfigured wavelength for optical
restoration. Under one failure scenario, we define a binary variable
ùúâùëí,ùëò
ùúô,ùë§ as 1 if the restored IP link ùëí‚Äôs ùëò surrogate restoration fiber
path uses wavelength slot ùë§ on fiber ùúô and 0 otherwise. We fur-
ther define an integer variable ùúÜùëò
ùëí that represents the number of
restored wavelengths of failed IP link ùëí on its ùëò surrogate restora-
tion fiber paths. Hence, the wavelength assignment of all restored
wavelengths for each restored IP link ùëí should follow the follow-
ing constraints when maximizing the total restored wavelength
ùëí and 0 otherwise.
numberùëíùëò ùúÜùëò
ùëí .
ùëíùëò ùúâùëí,ùëò
ùëò ùúÜùëò
ùëí √ó ùúãùëí,ùëò
ùúÜùëò
ùúô,ùë§ = ùúâùëí,ùëò
ùúâùëí,ùëò
ùúô‚Ä≤,ùë§
ùëí ‚â§ ùõæùëí
‚àÄùúô, ùë§ :
‚àÄùëí, ùëò, ùúô :
‚àÄùëí, ùëò, ùë§ :
‚àÄùëí :
ùúô,ùë§ ‚â§ ùúô.ùë†ùëùùëíùëêùë°ùëüùë¢ùëö[ùë§]
ùúô =ùë§ ùúâùëí,ùëò
ùúô,ùë§
if ùúô, ùúô‚Ä≤ ‚àà ùëÉùëò
ùëí
(14)
(15)
(16)
(17)
Constraint (14) ensures each available wavelength on surrogate
restoration fibers can only be used once. Constraint (15) formulates
the relationship between restored capacity ùúÜùëò
ùëí of IP link ùëí routed
on its ùëò surrogate restoration fiber path ùëÉùëò
ùëí and the wavelength
assignment on fibers ùúô ‚àà ùëÉùëò
ùëí . Constraint (16) is the wavelength
10Higher-capacity links use more aggressive modulation on the optical layer and hence
require shorter transmission distance [34, 76, 77].
Figure 17: Path length inflation analysis (R-path is short for restoration path, and P-path is short for primary path). 50% of IP
links‚Äô restoration path is shorter than their primary paths. Hence, no modulation change needed. The length ratio between
restoration path and primary path has implications for both transponder modulation on the optical layer [50] and service
latency on the IP layer [69].
continuity constraint that ensures the occupied wavelength slots
are the same all along the fiber path [12]. Constraint (17) ensures
failed IP link ùëí‚Äôs total restored wavelength number on all ùëò surro-
ùëí does not exceed the initial
gate restoration fiber paths ùúÜùëí =ùëò ùúÜùëò
wavelength number ùõæùëí of failed IP link ùëí.