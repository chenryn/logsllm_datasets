568579
Weperformedfullpropertyextraction(i.e., all36identifiedproperties)against5k,
ovfeprrsoiopneritsietsy(pei.gca.,lolynllyesussetrhaonrIhPaaldfdtrheesssriaztehoerftthhaenoarlilgiinnfaolrmraawtiolongthaantdco1u0lxdspmotaelnletriatlhlyan
569580
10k, 15k, and 20k log-lines, respectively, and compare the original size of raw log data,
bteheexgtreanceteradt)ewdiRllDtyFpgicraalplyh.haTvheesrmesaullletringgengerraapthioonutitmpuets.wouldbeevensmallerforfewer
570581
thegeneratedRDFgraphinTURTLE[19]format(.ttl),andthecompressedgraphoutputin
extractedproperties,minimizingresourcerequirements(i.e. storage/diskspace).
582
GthraepHhDCTofmorpmreast.sion
571
2F5igure13showstheperformanceforloggraphcompressionontheAuditlogdataset.
Originalrawlogdata 572
20 GeneratedRDFGraph(.ttl)
38 ExperimentscarriedoutonAuditLogdataonasinglehost. CompressedRDFGraph(.hdt)
15 )BM(ezis
10
5
0
5k 10k 15k 20k
numberofloglines
FFiigguurree1133..GGrraapphhccoommppreresssisoionn.
7.3. Multi-hostevaluation
583
Toevaluatethescalabilityofourapproach,wemeasurethelogprocessingtimefor
584
multiplehostsonthesamenetwork. Thisevaluationincludesnotonlythelogprocessing
585
butalsothequeryfederationperformance. Federationmeansthatthequeriesarenotonly
586
executedconcurrently,butthattheyinvolveevaluatingandcombiningindividualquery
587
resultstoachieveintegratedresults.
588
Table5summarizestheevaluationsetupthatconsistsofsixexperimentsrangingfrom
589
30minutesupto5hours. Thetimeframedescribesthestartingtimeandtheendtimeof
590
analysis;loglinesperhostsummarizestherangeofloglinesperhostwithinthetimeframe.
591
Forthisevaluation,weusedtheApachelogdatasetdescribedinTable4andconducted
592
theanalysiswithinthelogtimeframeofMarch2nd,2020,startingfrom8pm. Host1to
593
host4storethedatafromtheoriginal4serversinthedataset(host1mail.cup.com,host2
594
mail.insect.com,andsoon);forthe3additionalhostsintheevaluation,wereplicatedthe
595
logfilesfrommail.cup.com,mail.insect.com,andmail.spiral.com. Similartothesingle-host
596
evaluation,foreachexperiment,wereportedtheaveragetimesoverfiveruns.
597
Table5.MultihostExperimentTimeframe
Experiment Duration Loglinesperhost Experiment Duration Loglinesperhost
E1 30min 0.7k-1k E4 3h 3k-5k
E2 1h 1k-1.7k E5 4h 6k-8k
E3 2h 2.8k-4k E6 5h 8k-10k
Figure14showstheaveragelogprocessingtimesforeachexperiment. The1hour
598
experimentshowsthatlogprocessingfortwohoststakesapprox. 4.7secondsonaverage.
599
Inthesameexperiment,thetimeslightlyincreaseswithanincreasingnumberofhostsand
600
reachesamax. of7.5seconds. Thelogprocessingtimeforthe5hoursexperimentwith
601
twohoststakesapprox. 19.01secondsonaverageandreachesthemax. averagetimeof
602
39 https://www.w3.org/TR/turtle/
40 Evaluationoflinkingtobackgroundknowledgestoredonexternalserversisoutofscope.
Mach.Learn.Knowl.Extr.2022,4 390
For5kloglines(1MBrawlog)compressionresultsinapproximately0.4MBcompared
to5.4MBfortheuncompressedRDFgraph. 20kloglines(4MBrawlog)compressesto
about1.87MBfrom21.4MBuncompressedgeneratedRDFgraph. Overall,thecompressed
versionistypicallylessthanhalfthesizeoftheoriginalrawlogand10timessmallerthan
thegeneratedRDFgraph. Theresultinggraphoutputwouldbeevensmallerforfewer
extractedproperties,minimizingresourcerequirements(i.e.,storage/diskspace).
7.3. Multi-HostEvaluation
Toevaluatethescalabilityofourapproach,wemeasuredthelogprocessingtimefor
multiplehostsonthesamenetwork. Thisevaluationincludesnotonlythelogprocessing
butalsothequeryfederationperformance. Federationmeansthatthequeriesarenotonly
executedconcurrently,butthattheyinvolveevaluatingandcombiningindividualquery
resultstoachieveintegratedresults.
Table5summarizestheevaluationsetupthatconsistsofsixexperimentsrangingfrom
30minupto5h. Thetimeframedescribesthestartingtimeandtheendtimeofanalysis;
loglinesperhostsummarizestherangeofloglinesperhostwithinthetimeframe. Forthis
evaluation,weusedtheApachelogdatasetdescribedinTable4andconductedtheanalysis
withinthelogtimeframeof2March2020,startingfrom8pm. Host1tohost4storethedata
fromtheoriginalfourserversinthedataset(host1mail.cup.com,host2mail.insect.com,
andsoon);forthethreeadditionalhostsintheevaluation,wereplicatedthelogfilesfrom
mail.cup.com,mail.insect.com,andmail.spiral.com. Similartothesingle-hostevaluation,
foreachexperiment,wereportedtheaveragetimesoverfiveruns.
Table5.MultihostExperimentTimeframe.
Experiment Duration LogLinesperHost Experiment Duration LogLinesperHost
E1 30min 0.7k–1k E4 3h 3k–5k
E2 1h 1k–1.7k E5 4h 6k–8k
E3 2h 2.8k–4k E6 5h 8k–10k
Figure 14 shows the average log processing times for each experiment. The 1 h
experiment shows that log processing for two hosts takes approx. 4.7 s on average. In
thesameexperiment,thetimeslightlyincreaseswithanincreasingnumberofhostsand
reachesamax. of7.5s. Thelogprocessingtimeforthe5hexperimentwithtwohoststakes
approximately19.01sonaverageandreachesthemaximumaveragetimeof26.10swith7
hosts. Basedontheseresults,weconcludethatthegrowthofthelogprocessingtimeasa
functionofthenumberofhostsismoderate. Therefore,thisapproachscaleswellwitha
growingnumberofhoststomonitor,asthelogprocessingoneachhostisparallelizedand
VersionApril1,2022submittedtoJournalNotSpecified 20of22
thequeryfederationoverheadislow.
30 E1
E2
25
E3 )ces(emit.gva
20 E4
E5
15
E6
10
5
0
2 3 4 5 6 7
numberofhosts
Figure14F.igQuureery14e.xQecuuetriyonextiemcuetiinonatfiemdeerianteadfseedtetirnagtefdorsedtitfifnegrefnotrtdimifefefrreanmtetism.Eevfaralumaetiso4n0oflinking
tobackgroundknowledgestoredonexternalserversisoutofscope.
26.10secondswith7hosts. Basedontheseresults,weconcludethatthegrowthofthelog
603
processingtimeasafunctionofthenumberofhostsismoderate. Therefore,thisapproach
604
scaleswellwithagrowingnumberofhoststomonitor,asthelogprocessingoneachhost
605
isparallelizedandthequeryfederationoverheadislow.
606
8. Discussion
607
In this section, we reflect upon benefits, limitations, and possible applications of the
608
proposedvirtuallogknowledgegraphframework.
609
Graph-basedLogIntegrationandAnalysis
610
Representinglogdatainsemanticgraphstructuresopensupnewpossibilities, suchas
611
handlinglogdatainauniformrepresentation,exploringconnectionsbetweendisparate
612
entities,andapplyinggraph-basedqueriestosearchforabstractorconcretepatternsoflog
613
events. Comparedtotext-basedsearch,graph-patternbasedqueriesaremoreexpressive
614
and make it possible to link entities that appear in log lines to background knowledge.
615
Furthermore,theabilitytoprovidequeryresultsasagraphenablesnewworkflowsfor
616
analysts and may help them to be more efficient in exploring log data and ultimately
617
improvingtheirsituationalawarenessfaster.
618
Inourevaluation,wefindthatSPARQLasastandardizedRDFquerylanguagepro-
619
videspowerfulmeansforgraphpattern-basedad-hocloganalyses. Achallenge,however,
620
is that analysts are typically not familiar with the language and require some training.
621
This may improve in the future, as SPARQL is often already part of computer science
622
curriculaandisincreasinglybeingadoptedinmanyindustries41. Furthermore,intuitive
623
general-purposevisualquerybuildingandexplorationtoolssuchas[? ? ] couldbeused
624
andpossiblyadaptedforsecurityapplicationstoabstractthecomplexityofwritingqueries
625
directlyinSPARQL.
626
DecentralizationandVirtualization
627
Decentralizedad-hocextractionontheendpointsatqueryexecutiontimeisaparticularly
628
usefulapproachinscenarioswherelogacquisition,aggregation,andstoragearedifficult
629
or impractical. This includes scenarios with a large number of distributed hosts and
630
logsources. Pushingloganalysistowardstheendpointsisalsoparticularlyinteresting
631
in settings where bandwidth constraints do not permit continuous transmission of log
632
streamstoacentrallogarchive.
633
Whereastheseconsiderationsapplygenerally,thedecentralizedapproachalsohas
634
benefits that are specific to our knowledge-graph based approach for log integration
635
andanalysis. Specifically,thefederatedexecutiondistributesthecomputationalloadof
636
extraction,transformation,and(partly)queryexecutiontowardstheendpoints.Thiswillbe
637
usefulinmanypracticalsettingswherethescaleofthelogdatathatisconstantlygenerated
638
in a distributed environment is prohibitively large and it is not feasible to transform
639
41 cf.http://sparql.club
Mach.Learn.Knowl.Extr.2022,4 391
8. Discussion
Inthissection,wereflectuponbenefits,limitations,andpossibleapplicationsofthe
proposedvirtuallogknowledgegraphframework.
Graph-BasedLogIntegrationandAnalysis
Representinglogdatainsemanticgraphstructuresopensupnewpossibilities,such
ashandlinglogdatainauniformrepresentation,exploringconnectionsbetweendisparate
entities,andapplyinggraph-basedqueriestosearchforabstractorconcretepatternsoflog
events. Comparedtotext-basedsearch,graph-patternbasedqueriesaremoreexpressive
and make it possible to link entities that appear in log lines to background knowledge.
Furthermore,theabilitytoprovidequeryresultsasagraphenablesnewworkflowsfor
analysts and may help them to be more efficient in exploring log data and ultimately
improvingtheirsituationalawarenessfaster.
Inourevaluation,wefindthatSPARQLasastandardizedRDFquerylanguagepro-
videspowerfulmeansforgraphpattern-basedad-hocloganalyses. Achallenge,however,
is that analysts are typically not familiar with the language and require some training.
This may improve in the future, as SPARQL is often already part of computer science
curriculaandisincreasinglybeingadoptedinmanyindustries[58]. Furthermore,intuitive
general-purposevisualquerybuildingandexplorationtoolssuchas[59,60]couldbeused
andpossiblyadaptedforsecurityapplicationstoabstractthecomplexityofwritingqueries
directlyinSPARQL.
DecentralizationandVirtualization
Decentralizedad-hocextractionontheendpointsatqueryexecutiontimeisapartic-
ularlyusefulapproachinscenarioswherelogacquisition,aggregation,andstorageare
difficultorimpractical. Thisincludesscenarioswithalargenumberofdistributedhosts
andlogsources. Pushingloganalysistowardstheendpointsisalsoparticularlyinteresting
in settings where bandwidth constraints do not permit continuous transmission of log
streamstoacentrallogarchive.
Whereastheseconsiderationsapplygenerally,thedecentralizedapproachalsohas
benefits that are specific to our knowledge-graph based approach for log integration
andanalysis. Specifically,thefederatedexecutiondistributesthecomputationalloadof
extraction,transformation,and(partly)queryexecutiontowardstheendpoints. Thiswill
be useful in many practical settings where the scale of the log data that is constantly
generated in a distributed environment is prohibitively large and it is not feasible to
transform the complete log data into a Knowledge Graph (KG) presentation. In such
settings,thedecentralizedapproachfacilitatesad-hocgraph-basedanalyseswithoutthe
needtosetup,configureandmaintainsophisticatedlogaggregationsystems.
Our evaluation showed that this ad-hoc extraction, transformation, and federated
query execution works efficiently for temporally restricted queries over dispersed log
datawithoutprioraggregationandcentralizedstorage. Consequently, theapproachis
particularlyusefulforiterativeinvestigationsoversmallersubsetsofdistributedlogdata