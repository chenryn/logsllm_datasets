If we now compute a commitment to a message µ ∈ Sq, then, by Theorem 3.1, it is enough to
prove that µ is ﬁxed by the Galois automorphisms in H in order to establish that µ lies in Sq of
order qk. In fact, it clearly suﬃces to only prove that µ is ﬁxed by a set of generators for H, which
are usually only one or two.
For using Theorem 3.1 in practice we need to be able to compute elements in Sq. For this we
give a Zq-basis of the ﬁeld Sq. By the primitive element theorem there exists a single generator
α of L = Q[α] that lies in S [Hun12, Proposition 6.15]. Its powers form a Q-basis for L but in
general, since L is not necessarily cyclotomic, they do not form an integral basis so they are not a
Z-basis for S. In fact, O = Z[α] is only a so-called order in L which can be strictly smaller than
the ring of integers S. Fortunately this does not pose a problem for us as we are only interested in
Sq. Oq = O/qO is a subring of Sq but since it also has qk elements it must be equal to Sq. This
i
13
shows there is an element of O in every coset of S modulo qS and we can use the powers of α as a
Zq-basis for Sq. More precisely, 1, α, α2, . . . , αk−1 is a Zq-basis for Sq and we have
Sq = {c0 + c1α + ··· + ck−1αk−1 ∈ Rq | ci ∈ Zq}.
As we are mainly interested in the power-of-two case we only give concrete generators α for
all cyclic subﬁelds of power-of-two cyclotomic ﬁelds in the next section but it is easy to compute
generators for other examples.
What remains is to decide whether a given prime q is inert in L. A general approach is to
compute the minimal polynomial of a generator α of L. Then the Dedekind-Kummer theorem
says that q is inert in L if and only if the minimal polynomial is irreducible modulo q [Coh00,
Theorem 4.8.13]. For the power-of-two case we give a much more direct answer to this question.
3.2 Power-of-Two Cyclotomic Rings
We consider the case where K = Q[X]/(X d + 1) is a power-of-two cyclotomic ﬁeld. The Galois
group G, being isomorphic to Z×
2d, has structure Z2 × Zd/2 where the cyclic subgroups Z2 and Zd/2
are generated by σ−1 and σ5, respectively [LS18, Lemma 2.4].
In the simplest case when we choose the subgroup H to be the full Galois group G, then the
ﬁxed ﬁeld L is Q and Sq = Zq is a ﬁeld for every prime number q. Theorem 3.1 gives that if some
element µ ∈ Rq is ﬁxed by σ−1 and σ5, then µ ∈ Zq.
For subﬁelds of degree k|d with k  k ≥ 1 be powers of 2. The subgroup H = (cid:104)σ−1, σk
2k − X
G = Gal(K/Q) has index k. Its ﬁxed ﬁeld L is generated by α = X d− d
L = Q[α] ⊂ K.
5(cid:105) = Zk.
5(cid:105) of the Galois group
2k over Q inside K,
d
Proof. (Theorem 3.2) For k = 1 the subgroup H is equal to the whole Galois group G so its ﬁxed
ﬁeld is Q which indeed is generated by α = 0. For k > 1, H has order 2 · d
k and thus G/H
2k + X d− 2k = α since X d = −1. By
2k = −X
has order k. Now observe σ−1(α) = X
repeated squaring one ﬁnds 5k ≡ 1+4k (mod 8k) and hence d
2k (5k−1) ≡ 0 (mod 2d). Consequently
2k − X
k = α. So, α lies in L. Now consider the subﬁeld L(cid:48) ⊂ K
5 (α) = X (d− d
= X d− d
σk
(cid:105). It has degree k/2 and is contained in L since its Galois group
ﬁxed by the Galois group (cid:104)σ−1, σk/2
contains H, which implies L is of degree 2 over L(cid:48). α is not ﬁxed by σk/2
5 which means it does not
lie in the subﬁeld L(cid:48) of degree k/2 and therefore α generates L.
2k−d − X− d
2k )5k − X
2k = d
d
2k 5k
5
d
d
d
For selecting primes it is helpful to compute the minimal polynomial of the generator α of L.
The roots of the minimal polynomial are the conjugates of α under the action of G/H so it is given
by
(cid:89)
σ∈G/H
φ(Y ) =
(Y − σ(α))
and the coeﬃcients are the symmetric polynomials in the conjugates of α. We give an example
for the case where the subﬁeld has degree k = 4. A system of representatives for the Galois group
8 − X 5 d
G/H is given by {1, σ5, σ2
8 are σ5(α) = X d−5 d
8 ,
5(α) = −σ5(α). Now it is easy
5(α) = X d−25 d
σ2
to compute φ(Y ) = Y 4 − 4Y 2 + 2.
5}. The conjugates of α = X d− d
8 − X d+ d
8 − X
8 = −α and σ3
5, σ3
8 = X− d
8 − X d− d
8 − X 25 d
8 = X
d
d
14
Theorem 3.3. The prime numbers that are inert in the ﬁxed ﬁeld L of (cid:104)σ−1, σk
5(cid:105) for some power
of two 1 < k < d are precisely the primes that are congruent to 3 or 5 modulo 8. They split into
two prime ideals in K.
Proof. (Theorem 3.3) First consider the case q ≡ 5 (mod 8). The Legendre symbol (−1/q) is equal
to 1 so there is a square root r of −1 modulo q. We get that X d + 1 ≡ (X d/2 − r)(X d/2 + r)
(mod q). It follows from [LN86, Theorem 3.35] that the two factors of degree d/2 are irreducible.
Hence q splits into two prime ideals in K. They are ﬁxed by σ5 and mapped to each other by
σ−1. Therefore q splits over the course of the subextension K/L where L is the ﬁxed ﬁeld of (cid:104)σ−1(cid:105)
and stays inert in L and in all subﬁelds of L. Next we handle the case q ≡ 3 (mod 8). In this
case (−2/q) = 1 so that there exist an r ∈ Zq with r2 ≡ −2 (mod q). This allows us to write
X d + 1 ≡ (X d/2 + rX d/2 − 1)(X d/2 − rX d/4 − 1). These factors are again irreducible and q splits
only into two prime ideals that are stabilized by the subgroup (cid:104)σ−1σ5(cid:105) of order d/2, which therefore
is the decomposition group of q. Since σ−1 is not contained in this group we see that q again splits
over the course of the extension K/L and consequently stays inert in all subﬁelds of L.
We end this section by giving and alternate subﬁeld of degree 2 where we take H = Zd/2 = (cid:104)σ5(cid:105).
Then σ5(X d/2) = X 5d/2 = X d/2 and hence X d/2 lies in the ﬁxed ﬁeld L of H. But since L is only
of degree 2, it is already generated by α = X d/2. In fact, α has minimal polynomial Y 2 + 1 and L is
the ﬁeld of Gaussian integers inside K. An odd prime number q is inert in this imaginary quadratic
is equal to −1 [NS99, Proposition 8.5], which is the
ﬁeld if and only if the Legendre symbol
case if and only if q ≡ 3 (mod 4). This subﬁeld of degree 2 has the advantage that only proving
stability under one automorphism σ5 is necessary. Also in this case there exist prime numbers q
that split into more than two primes in K which allows for faster multiplication using the Fast
Fourier Transform. We have
(cid:16)−1
(cid:17)
q
Sq = {c0 + cd/2X d/2 ∈ Rq | c0, cd/2 ∈ Zq}.
Table 3 summarizes the subﬁelds of degree k ≤ 8 in K for d = 4096. We give an example
how it can be used. Suppose we want to commit to messages in a subﬁeld of size q2 in Rq =
Zq[X]/(X 4096 + 1) and give a proof that they are really contained in this subﬁeld. Then we can
compute messages µ = c0 + c1α = c0 + c1(X 3072 − X 1024) ∈ Rq with arbitrary c0, c1 ∈ Zq. They are
ﬁxed by the two automorphisms σ−1 and σ2
5 and if we prove that they indeed are, then it follows
the messages are of this form. Moreover, these messages form a subﬁeld of Rq and are therefore
invertible.
4 Proofs of Knowledge
The goal of this section will be to construct a proof that a commitment opens to a message that is
invariant under certain automorphisms. We will ﬁrst introduce a more generic protocol that allows
one to prove that the openings of a set of commitments verify a given linear relation. This protocol
can be used even if the aforementioned commitments use diﬀerent public keys and have diﬀerent
dimensions. We present this protocol as a standalone result as we think it can be of independent
interest. We then show how, using the results of Section 3.1, we can adapt this generic protocol to
obtain a proof of automorphism stability.
15
Degree Galois group H Generator α of L
polynomial of
Minimal
α
1
2
2
4
8
(cid:104)σ−1, σ5(cid:105)
(cid:104)σ−1, σ2
5(cid:105)
(cid:104)σ5(cid:105)
(cid:104)σ−1, σ4
5(cid:105)
(cid:104)σ−1, σ8
5(cid:105)
1
X 2048
X 3072 − X 1024
X 3584 − X 512
X 3849 − X 256
Y − 1
Y 2 − 2
Y 2 + 1
Y 4 − 4Y 2 + 2
Y 8 − 8Y 6 +
20Y 4 −
16Y 2 + 2
Table 3. Subﬁelds of the power-of-two cyclotomic ﬁeld K = Q[X]/(X 4096 + 1) of degree at most 8 with generators
for the corresponding Galois group H, generators of the subﬁelds, and their minimal polynomials over Q.
4.1 Generic Proof for Linear Relations
In this section we will present a novel proof of knowledge that a set of commitments t1, . . . , tτ are
such that their openings m1, . . . , mτ verify
τ(cid:88)
1
Bjmj = 0
for any ﬁxed B1, . . . , Bτ . An interesting property of this protocol will be that the commitment
matrices A1, . . . , Aτ do not have to be identical, in fact they can even have diﬀerent dimensions as
long as all the matrices B1, . . . , Bτ have the same number of rows.
Concretely, for j ∈ [τ ] let Aj :=
let
with Aj,1 ∈ Rnj×kj
and Aj,2 ∈ Rlj×kj
, let Bj ∈ Rx×lj
, and
(cid:21)
q1
q2
q2
(cid:20)Aj,1
(cid:21)
Aj,2
= Ajrj +
, with rj ∈ Rkj , mj ∈ Rlj
q2
(cid:20)tj,1
tj,2
tj :=
be such that
(cid:21)
(cid:20) 0
τ(cid:88)
mj
Bjmj = 0.
(13)
We prove in Lemma 4.1 that the protocol of Figure 1, in which the challenge space is
1
C = {c ∈ R : (cid:107)c(cid:107)1 = κ, (cid:107)c(cid:107)∞ = 1} ,
is a proof of knowledge that the commitments t1, . . . , tτ are well formed and that their openings
verify (13)
1 . Let ξ ≥ 11κ(cid:112)d(cid:80) kj and B(cid:48)
j ≥ (cid:112)2dkjξ. Also, let ¯C (deﬁned as in
Lemma 4.1. Let rj
Table 2) be such that all elements in it are invertible over Rq2. Then the protocol Πlin of Figure 1
achieves the following properties:
$← Skj
– Correctness: The prover aborts with probability at most 2
veriﬁer accepts with overwhelming probability.
3 + 2−100, and if he does not abort the
– Honest-Veriﬁer Zero-Knowledge: Non-aborting transcripts with an honest veriﬁer can be sim-
ulated with statistically indistinguishable distribution.
16
P
For j ∈ [τ ]
Aj :=
(cid:20)Aj,1
Aj,2
(cid:21)
, rj, mj, Bj
V
Aj, tj,1, tj,2, Bj, B(cid:48)
j ≥(cid:112)2dkjξ
q1
(cid:21)
where:
Aj,1 ∈ Rnj×kj
rj ∈ Rkj , mj ∈ Rlj
= Ajrj +
s.t
(cid:20)tj,1
(cid:20) 0
and(cid:80) Bjmj = 0 ∈ Rx
tj,2
mj
q2
, Aj,2 ∈ Rlj×kj
q2
q2 , Bj ∈ Rx×lj
q2
(cid:21)
∀j, yj ← Dkj
∀j, wj,1 := A1yj
w2 =(cid:80)
ξ
j BjAj,2yj
∀j, zj := rjc + yj
Rej((z1, . . . , zτ ), (r1c, . . . , rτ c), ξ)
∀j, wj,1, w2- c $← C
c
∀j, zj -
Fig. 1. Proof that a set of commitments t1, . . . , tτ open to messages m1, . . . , mτ such that(cid:80) Bjmj = 0 mod q2.
Check:∀j, (cid:107)zj(cid:107) ≤ B(cid:48)
(cid:80) BjAj,2zj = c(cid:80) Bjtj,2 + w2
∀j, Aj,1zj = tj,1c + wj,1
j
– Special Soundness: Given two accepting transcripts one can extract valid openings ¯zj, ¯mj, ¯c of
tj for j ∈ [τ ] such that ¯c ∈ ¯C, (cid:107)¯zj(cid:107) ≤ 2B(cid:48)
j, and(cid:80) Bj ¯mj = 0.
Proof.
– Correctness: If P and V are honest then (cid:107)(r1c, . . . , rτ c)(cid:107) ≤ κ(cid:112)d(cid:80) kj, the probability of abort
coeﬃcient of zj is statistically close to Dξ, then according to (12) we have (cid:107)zj(cid:107) ≤(cid:112)2kjdξ with
is exponentially close to 2/3 by deﬁnition of rejection sampling and lemma 2.2. Since each
overwhelming probability.
– Honest-Veriﬁer Zero-Knowledge: We only show that the protocol is zero-knowledge when the
prover does not abort prior to sending zj. The reason that this is enough for practical purposes
is that HVZK Σ-protocols are ﬁrst converted into non-interactive proofs via the Fiat-Shamir
transform, in which case the veriﬁer never sees the aborting transcripts. One can also, using