If we now compute a commitment to a message Âµ âˆˆ Sq, then, by Theorem 3.1, it is enough to
prove that Âµ is ï¬xed by the Galois automorphisms in H in order to establish that Âµ lies in Sq of
order qk. In fact, it clearly suï¬ƒces to only prove that Âµ is ï¬xed by a set of generators for H, which
are usually only one or two.
For using Theorem 3.1 in practice we need to be able to compute elements in Sq. For this we
give a Zq-basis of the ï¬eld Sq. By the primitive element theorem there exists a single generator
Î± of L = Q[Î±] that lies in S [Hun12, Proposition 6.15]. Its powers form a Q-basis for L but in
general, since L is not necessarily cyclotomic, they do not form an integral basis so they are not a
Z-basis for S. In fact, O = Z[Î±] is only a so-called order in L which can be strictly smaller than
the ring of integers S. Fortunately this does not pose a problem for us as we are only interested in
Sq. Oq = O/qO is a subring of Sq but since it also has qk elements it must be equal to Sq. This
i
13
shows there is an element of O in every coset of S modulo qS and we can use the powers of Î± as a
Zq-basis for Sq. More precisely, 1, Î±, Î±2, . . . , Î±kâˆ’1 is a Zq-basis for Sq and we have
Sq = {c0 + c1Î± + Â·Â·Â· + ckâˆ’1Î±kâˆ’1 âˆˆ Rq | ci âˆˆ Zq}.
As we are mainly interested in the power-of-two case we only give concrete generators Î± for
all cyclic subï¬elds of power-of-two cyclotomic ï¬elds in the next section but it is easy to compute
generators for other examples.
What remains is to decide whether a given prime q is inert in L. A general approach is to
compute the minimal polynomial of a generator Î± of L. Then the Dedekind-Kummer theorem
says that q is inert in L if and only if the minimal polynomial is irreducible modulo q [Coh00,
Theorem 4.8.13]. For the power-of-two case we give a much more direct answer to this question.
3.2 Power-of-Two Cyclotomic Rings
We consider the case where K = Q[X]/(X d + 1) is a power-of-two cyclotomic ï¬eld. The Galois
group G, being isomorphic to ZÃ—
2d, has structure Z2 Ã— Zd/2 where the cyclic subgroups Z2 and Zd/2
are generated by Ïƒâˆ’1 and Ïƒ5, respectively [LS18, Lemma 2.4].
In the simplest case when we choose the subgroup H to be the full Galois group G, then the
ï¬xed ï¬eld L is Q and Sq = Zq is a ï¬eld for every prime number q. Theorem 3.1 gives that if some
element Âµ âˆˆ Rq is ï¬xed by Ïƒâˆ’1 and Ïƒ5, then Âµ âˆˆ Zq.
For subï¬elds of degree k|d with k  k â‰¥ 1 be powers of 2. The subgroup H = (cid:104)Ïƒâˆ’1, Ïƒk
2k âˆ’ X
G = Gal(K/Q) has index k. Its ï¬xed ï¬eld L is generated by Î± = X dâˆ’ d
L = Q[Î±] âŠ‚ K.
5(cid:105) = Zk.
5(cid:105) of the Galois group
2k over Q inside K,
d
Proof. (Theorem 3.2) For k = 1 the subgroup H is equal to the whole Galois group G so its ï¬xed
ï¬eld is Q which indeed is generated by Î± = 0. For k > 1, H has order 2 Â· d
k and thus G/H
2k + X dâˆ’ 2k = Î± since X d = âˆ’1. By
2k = âˆ’X
has order k. Now observe Ïƒâˆ’1(Î±) = X
repeated squaring one ï¬nds 5k â‰¡ 1+4k (mod 8k) and hence d
2k (5kâˆ’1) â‰¡ 0 (mod 2d). Consequently
2k âˆ’ X
k = Î±. So, Î± lies in L. Now consider the subï¬eld L(cid:48) âŠ‚ K
5 (Î±) = X (dâˆ’ d
= X dâˆ’ d
Ïƒk
(cid:105). It has degree k/2 and is contained in L since its Galois group
ï¬xed by the Galois group (cid:104)Ïƒâˆ’1, Ïƒk/2
contains H, which implies L is of degree 2 over L(cid:48). Î± is not ï¬xed by Ïƒk/2
5 which means it does not
lie in the subï¬eld L(cid:48) of degree k/2 and therefore Î± generates L.
2kâˆ’d âˆ’ Xâˆ’ d
2k )5k âˆ’ X
2k = d
d
2k 5k
5
d
d
d
For selecting primes it is helpful to compute the minimal polynomial of the generator Î± of L.
The roots of the minimal polynomial are the conjugates of Î± under the action of G/H so it is given
by
(cid:89)
ÏƒâˆˆG/H
Ï†(Y ) =
(Y âˆ’ Ïƒ(Î±))
and the coeï¬ƒcients are the symmetric polynomials in the conjugates of Î±. We give an example
for the case where the subï¬eld has degree k = 4. A system of representatives for the Galois group
8 âˆ’ X 5 d
G/H is given by {1, Ïƒ5, Ïƒ2
8 are Ïƒ5(Î±) = X dâˆ’5 d
8 ,
5(Î±) = âˆ’Ïƒ5(Î±). Now it is easy
5(Î±) = X dâˆ’25 d
Ïƒ2
to compute Ï†(Y ) = Y 4 âˆ’ 4Y 2 + 2.
5}. The conjugates of Î± = X dâˆ’ d
8 âˆ’ X d+ d
8 âˆ’ X
8 = âˆ’Î± and Ïƒ3
5, Ïƒ3
8 = Xâˆ’ d
8 âˆ’ X dâˆ’ d
8 âˆ’ X 25 d
8 = X
d
d
14
Theorem 3.3. The prime numbers that are inert in the ï¬xed ï¬eld L of (cid:104)Ïƒâˆ’1, Ïƒk
5(cid:105) for some power
of two 1 < k < d are precisely the primes that are congruent to 3 or 5 modulo 8. They split into
two prime ideals in K.
Proof. (Theorem 3.3) First consider the case q â‰¡ 5 (mod 8). The Legendre symbol (âˆ’1/q) is equal
to 1 so there is a square root r of âˆ’1 modulo q. We get that X d + 1 â‰¡ (X d/2 âˆ’ r)(X d/2 + r)
(mod q). It follows from [LN86, Theorem 3.35] that the two factors of degree d/2 are irreducible.
Hence q splits into two prime ideals in K. They are ï¬xed by Ïƒ5 and mapped to each other by
Ïƒâˆ’1. Therefore q splits over the course of the subextension K/L where L is the ï¬xed ï¬eld of (cid:104)Ïƒâˆ’1(cid:105)
and stays inert in L and in all subï¬elds of L. Next we handle the case q â‰¡ 3 (mod 8). In this
case (âˆ’2/q) = 1 so that there exist an r âˆˆ Zq with r2 â‰¡ âˆ’2 (mod q). This allows us to write
X d + 1 â‰¡ (X d/2 + rX d/2 âˆ’ 1)(X d/2 âˆ’ rX d/4 âˆ’ 1). These factors are again irreducible and q splits
only into two prime ideals that are stabilized by the subgroup (cid:104)Ïƒâˆ’1Ïƒ5(cid:105) of order d/2, which therefore
is the decomposition group of q. Since Ïƒâˆ’1 is not contained in this group we see that q again splits
over the course of the extension K/L and consequently stays inert in all subï¬elds of L.
We end this section by giving and alternate subï¬eld of degree 2 where we take H = Zd/2 = (cid:104)Ïƒ5(cid:105).
Then Ïƒ5(X d/2) = X 5d/2 = X d/2 and hence X d/2 lies in the ï¬xed ï¬eld L of H. But since L is only
of degree 2, it is already generated by Î± = X d/2. In fact, Î± has minimal polynomial Y 2 + 1 and L is
the ï¬eld of Gaussian integers inside K. An odd prime number q is inert in this imaginary quadratic
is equal to âˆ’1 [NS99, Proposition 8.5], which is the
ï¬eld if and only if the Legendre symbol
case if and only if q â‰¡ 3 (mod 4). This subï¬eld of degree 2 has the advantage that only proving
stability under one automorphism Ïƒ5 is necessary. Also in this case there exist prime numbers q
that split into more than two primes in K which allows for faster multiplication using the Fast
Fourier Transform. We have
(cid:16)âˆ’1
(cid:17)
q
Sq = {c0 + cd/2X d/2 âˆˆ Rq | c0, cd/2 âˆˆ Zq}.
Table 3 summarizes the subï¬elds of degree k â‰¤ 8 in K for d = 4096. We give an example
how it can be used. Suppose we want to commit to messages in a subï¬eld of size q2 in Rq =
Zq[X]/(X 4096 + 1) and give a proof that they are really contained in this subï¬eld. Then we can
compute messages Âµ = c0 + c1Î± = c0 + c1(X 3072 âˆ’ X 1024) âˆˆ Rq with arbitrary c0, c1 âˆˆ Zq. They are
ï¬xed by the two automorphisms Ïƒâˆ’1 and Ïƒ2
5 and if we prove that they indeed are, then it follows
the messages are of this form. Moreover, these messages form a subï¬eld of Rq and are therefore
invertible.
4 Proofs of Knowledge
The goal of this section will be to construct a proof that a commitment opens to a message that is
invariant under certain automorphisms. We will ï¬rst introduce a more generic protocol that allows
one to prove that the openings of a set of commitments verify a given linear relation. This protocol
can be used even if the aforementioned commitments use diï¬€erent public keys and have diï¬€erent
dimensions. We present this protocol as a standalone result as we think it can be of independent
interest. We then show how, using the results of Section 3.1, we can adapt this generic protocol to
obtain a proof of automorphism stability.
15
Degree Galois group H Generator Î± of L
polynomial of
Minimal
Î±
1
2
2
4
8
(cid:104)Ïƒâˆ’1, Ïƒ5(cid:105)
(cid:104)Ïƒâˆ’1, Ïƒ2
5(cid:105)
(cid:104)Ïƒ5(cid:105)
(cid:104)Ïƒâˆ’1, Ïƒ4
5(cid:105)
(cid:104)Ïƒâˆ’1, Ïƒ8
5(cid:105)
1
X 2048
X 3072 âˆ’ X 1024
X 3584 âˆ’ X 512
X 3849 âˆ’ X 256
Y âˆ’ 1
Y 2 âˆ’ 2
Y 2 + 1
Y 4 âˆ’ 4Y 2 + 2
Y 8 âˆ’ 8Y 6 +
20Y 4 âˆ’
16Y 2 + 2
Table 3. Subï¬elds of the power-of-two cyclotomic ï¬eld K = Q[X]/(X 4096 + 1) of degree at most 8 with generators
for the corresponding Galois group H, generators of the subï¬elds, and their minimal polynomials over Q.
4.1 Generic Proof for Linear Relations
In this section we will present a novel proof of knowledge that a set of commitments t1, . . . , tÏ„ are
such that their openings m1, . . . , mÏ„ verify
Ï„(cid:88)
1
Bjmj = 0
for any ï¬xed B1, . . . , BÏ„ . An interesting property of this protocol will be that the commitment
matrices A1, . . . , AÏ„ do not have to be identical, in fact they can even have diï¬€erent dimensions as
long as all the matrices B1, . . . , BÏ„ have the same number of rows.
Concretely, for j âˆˆ [Ï„ ] let Aj :=
let
with Aj,1 âˆˆ RnjÃ—kj
and Aj,2 âˆˆ RljÃ—kj
, let Bj âˆˆ RxÃ—lj
, and
(cid:21)
q1
q2
q2
(cid:20)Aj,1
(cid:21)
Aj,2
= Ajrj +
, with rj âˆˆ Rkj , mj âˆˆ Rlj
q2
(cid:20)tj,1
tj,2
tj :=
be such that
(cid:21)
(cid:20) 0
Ï„(cid:88)
mj
Bjmj = 0.
(13)
We prove in Lemma 4.1 that the protocol of Figure 1, in which the challenge space is
1
C = {c âˆˆ R : (cid:107)c(cid:107)1 = Îº, (cid:107)c(cid:107)âˆ = 1} ,
is a proof of knowledge that the commitments t1, . . . , tÏ„ are well formed and that their openings
verify (13)
1 . Let Î¾ â‰¥ 11Îº(cid:112)d(cid:80) kj and B(cid:48)
j â‰¥ (cid:112)2dkjÎ¾. Also, let Â¯C (deï¬ned as in
Lemma 4.1. Let rj
Table 2) be such that all elements in it are invertible over Rq2. Then the protocol Î lin of Figure 1
achieves the following properties:
$â† Skj
â€“ Correctness: The prover aborts with probability at most 2
veriï¬er accepts with overwhelming probability.
3 + 2âˆ’100, and if he does not abort the
â€“ Honest-Veriï¬er Zero-Knowledge: Non-aborting transcripts with an honest veriï¬er can be sim-
ulated with statistically indistinguishable distribution.
16
P
For j âˆˆ [Ï„ ]
Aj :=
(cid:20)Aj,1
Aj,2
(cid:21)
, rj, mj, Bj
V
Aj, tj,1, tj,2, Bj, B(cid:48)
j â‰¥(cid:112)2dkjÎ¾
q1
(cid:21)
where:
Aj,1 âˆˆ RnjÃ—kj
rj âˆˆ Rkj , mj âˆˆ Rlj
= Ajrj +
s.t
(cid:20)tj,1
(cid:20) 0
and(cid:80) Bjmj = 0 âˆˆ Rx
tj,2
mj
q2
, Aj,2 âˆˆ RljÃ—kj
q2
q2 , Bj âˆˆ RxÃ—lj
q2
(cid:21)
âˆ€j, yj â† Dkj
âˆ€j, wj,1 := A1yj
w2 =(cid:80)
Î¾
j BjAj,2yj
âˆ€j, zj := rjc + yj
Rej((z1, . . . , zÏ„ ), (r1c, . . . , rÏ„ c), Î¾)
âˆ€j, wj,1, w2- c $â† C
c
âˆ€j, zj -
Fig. 1. Proof that a set of commitments t1, . . . , tÏ„ open to messages m1, . . . , mÏ„ such that(cid:80) Bjmj = 0 mod q2.
Check:âˆ€j, (cid:107)zj(cid:107) â‰¤ B(cid:48)
(cid:80) BjAj,2zj = c(cid:80) Bjtj,2 + w2
âˆ€j, Aj,1zj = tj,1c + wj,1
j
â€“ Special Soundness: Given two accepting transcripts one can extract valid openings Â¯zj, Â¯mj, Â¯c of
tj for j âˆˆ [Ï„ ] such that Â¯c âˆˆ Â¯C, (cid:107)Â¯zj(cid:107) â‰¤ 2B(cid:48)
j, and(cid:80) Bj Â¯mj = 0.
Proof.
â€“ Correctness: If P and V are honest then (cid:107)(r1c, . . . , rÏ„ c)(cid:107) â‰¤ Îº(cid:112)d(cid:80) kj, the probability of abort
coeï¬ƒcient of zj is statistically close to DÎ¾, then according to (12) we have (cid:107)zj(cid:107) â‰¤(cid:112)2kjdÎ¾ with
is exponentially close to 2/3 by deï¬nition of rejection sampling and lemma 2.2. Since each
overwhelming probability.
â€“ Honest-Veriï¬er Zero-Knowledge: We only show that the protocol is zero-knowledge when the
prover does not abort prior to sending zj. The reason that this is enough for practical purposes
is that HVZK Î£-protocols are ï¬rst converted into non-interactive proofs via the Fiat-Shamir
transform, in which case the veriï¬er never sees the aborting transcripts. One can also, using