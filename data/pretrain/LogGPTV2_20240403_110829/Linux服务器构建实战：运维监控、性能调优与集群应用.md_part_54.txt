openais[2755] :[
openais[2649]:
openais[2649]
openais[2649]
openais[2649]
openais[2649]
kernel:dlm:closing
openais[2649]:
openais[2649]
cpenais[2649]
openais [2649] :
openais [2649] :
openais[2649]:
openais [2649]
openais [2649]:
openais[2649]：
openais [2649]:
openais[2649]:
openais [2649]
openais[2649] :
（重点看日志中斜体部分）。
使内核崩溃
Linuxidc.
[CLM
[CLM
[NEIOL]
[TOTEM]
[CLM
[CLM
[CLM
[TOTEM]
[TOTEM]
[TOTEM]
[TOTEM]
[TOTEM]
[TOTEM]
[TOTEM]
[TOTEM]
CLM
CLM
[TOTEM]
TOTEM]
TOTEM]
TOTEM]
TOTEM]
ICPG
[CPG
CPG
CL
CLM
CLM
connection to node
CLM
日志。
New
CIM CONFIGURATION CHANGE
Memb
Members Left:
New Configuration:
Did
aru
previous ring seq 3020 rep 192.168.12.230
position[
previous
position
aru 78 hig
previous
position
entering
entering
Saving state aru 78
entering GATHER
entering GATHER
got
got
r(0) ip(192.168.12.240)
r(0) ip(192.168.12.230)
q06
r（0)
r(0) ip(192.168.12.230)
r(0） ip(192.168.12.232)
Configuration:
H
CONFIGURATION CHANGB
joinlist message
joinlist
ioinliet
nodejoin
nodejoin message 192.168.12.232
not need to originate any messages
nodejoinm
信息如下：
nodejoin
ip(192.168.12.232)
ip(192.168.12.231)
rs Joined:
ip(192.168.12.231)
high delivered 78 received flag 1
[2] member 192.168.12.232:
ring seq 3020 rep 192.168.12.230
[1] member 192.168.12.231:
igh delivered 78 received flag
ring seq 3020 rep 192.168.12.230
[0]member 192.168.12.230:
RECOVERY state
COMMIT state.
message
me88age 192.168.12.240
message
message 192.168.12.230
state from 11.
.com
1
state
high seg received 78
id
from
from node
from
from node3
：192.168.12.231
for
nnode
ring bdo
343
in
H
PDG
---
## Page 359
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
一模一样，这里不再重复讲述。
处于挂起的状态，直到fenced进程成功。
启动。在fenced进程没有返回成功信息之前，所有节点挂载的GFS2共享分区将无法使用，
异常岩机，所以RHCS为了保证集群资源的唯一性，必须重置web2节点，于是fenced进程
然后在节点web2上查看/var/log/messages日志。信息如下：
[root@webl-]#init0
在节点web1上执行正常关机命令。
（1）节点web1正常关机
3.节点web1宕机时
节点Mysql2在正常关机和异常岩机时，RHCS的切换状态与上面讲述的web2节点情况
2.节点Mysql2宕机时
由输出可知，
[root@webl ~]#clustat
此时，在节点web1上查看web2的集群状态如下：
从输出信息可知，qdiskd首先检测到web2出现异常，然后将它从集群中隔离。由于是
Aug2402:26:45Mysql1kermel:GFS2:feid=mycluster:my-gfe2.2:jid=3:Done
Member Name
web2
Aug 24 02:26:36 Mysql1 fenced[2688]: web2 not a cluster member after 0 sec post_fail
Aug 24 02:26:36 Mysql1 openais [2649] : [CLM
24 02:15:03 web2 clurgmgrd[3239]: Starting stopped service
24 02:14:58 web2 clurgmgrd[3239]:Member 4shutting down
jouznal...
jouznal lock..
2402:26:36
2402:26:36
2402:26:36
delay
24 02:26:45
24 02:26:36 Mysql1 openais[2649]:[CLM
02:26:36
02:26:36
WWW.L
02:26:36
02:26:36
web2已经处于Offline状态了。
Mysql1
ITbSAW
Mysq11
Mysql1
Mysql1
Mysql1
Mysql1
Mysq11
Mysq11
fenced(2688):
openais[2649]
openais[2649]
openais[2649]
openais[2649]
openais2649
openais[2649]
-m web2
offline
Status
Linuxidc.com
fsid=mycluster:my-gfs2.2:jid=3:Trying to acquire
fence
fencing
[CLM
[TOTEM] entering OPERATIONAL state.
[SYNc ] This node is within the primary component
CPG
CLM
CLM
node
Members Joined:
1 Members Left:
succe:
joinlist message from node
joinlist
joinlist
nodejoin
nodejoin
"web2"
88
message
message
口
message
abessam
from node
from node
192.168.12.232
：192.168.12.230
W
PDG
---
## Page 360
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
Aug
Aug 24 02:15:06
Aug 24 02:15:05
in recovery.
already in use
24
and
24
24
2
24
192.168.12.233
service:webserver
02:15:41 web2
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02 :15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15 :41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:41
02:15:21
02:15:08
02:15:07
www.
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2 in.rdigcd[4451]:
on etho.
web2 avahi-daemon[3110]:
openais [2689]:
openais [2689]
openais [2689]
openais[2689]
openais[2689]
openais[
openais[2689]
service.
openais[2689]
openais [2689]
openais
openais
openais [2689]
openais[2689] :
openais[2689]:
openais [2689]
kernel:dlm:clc
openais[2689]:
openais[2689]
openais[2689]
openais [2689] :
openais [2689]
openais[2689];
openais [2689]
openais
openais[2689]
openais
openais
openais[2689]
openais[2689]
openais [2689]
openais
openais
openais
openais[2689]
qdiakd[2712]:
clurgmgrd[3239]:
in.rdiscd[4451]:
[2689]
[2689]
[2689]
[2689]
[2689]
[2689]
[2689]
[2689]
[2689]
[2689]
Linuxidc.
Node
CLM
[CLM
CLM
OL
[CLM
[CLM
(CLM