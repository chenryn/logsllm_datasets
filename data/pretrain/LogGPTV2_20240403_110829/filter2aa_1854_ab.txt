an Intel 8051 family integrated circuit, to evaluate signals 
from the remote station and to control all the instrument 
link functions except those associated with the one 
second timer, the auto transmit counter, and the 
functions associated with those components.”
•
“The Electronically Erasable Programmable Read-Only 
Memory (EEPROM) interfaces with the microcontroller 
through a serial interface and provides one (1) kilobit 
(Kbit) of non-volatile storage. The EEPROM provides a 
means for storing configuration parameters and data that 
must be saved when the microcontroller is powered down 
(i.e. the instrument link sleep mode). For example, the 
EEPROM stores diagnostic data relating to the 
performance of the instrument link and a remote station. 
The EEPROM may be a Thompson 93C46 or equivalent.”
•
“An interrogation signal preamble is followed by a 
interrogation message that is preferably a Manchester 
encoded message at a data rate of 1 kbit per second. The 
interrogation message contains a variety of parameters 
including the interrogation mode (blind or geographic), 
instrument link ID with possible wild cards, reply window 
length, reply RF channel to be used, the pseudorandom 
code to be used for spread spectrum modulation, the 
reading cycle number, and the data to be transmitted (i.e. 
register reading or diagnostic information). Such a 
message is typically protected against transmission bit 
errors by a 16 bit CRC field.”
21
Radio Frequencies
Manufacturer
Frequency
FHSS?
Security?
•
Aclara (Hexagram)
450 – 470
•
Badger (Itron)
902 – 928
•
Landis+Gyr (Cellnet)
902 – 928
•
Datamatic
902 – 928
FHSS
•
Elster AMCO (Severn)
902 – 928
FHSS
•
Inovics
902 – 928
FHSS
•
Itron
910 – 920
•
Master Meter
902 – 928
DSSS
Encryption
•
Mueller (Hersey)
902 – 928
FHSS
•
Neptune 
900 – 950
FHSS
None
•
Performance 
902 – 928
FHSS 
•
RAMAR 
902 – 928
•
Sensus
900 – 950
DSSS
Encryption
22
900 Mhz
• 900 MHz most commonly used 
for water meters in USA
• Neptune Meter; Transmitter 
Specifications:
- Transmit Period - Every 14 
seconds
- Transmitter Channels – 50
- Channel Frequency –
910-920 MHz
- FCC Part 15.247 (802.15.247)
- Security? No encryption. FHSS
23
Frequency Hopping Spread Spectrum
•
FHSS is a Layer One method of 
transmission
•
“Some have expressed ideas that 
frequency hopping in FHSS may 
contribute to the security of 802.11, 
but these are invalid expectations—
the hopping codes used by FHSS are 
specified by the standard and are 
available to anyone, thus making the 
expectation of security through FHSS 
unreasonable.” Internet Protocol 
Journal, March 2002 Vol. 5 No. 1
•
Touted by many as a security feature 
that makes encryption unnecessary
•
While there are methods being 
researched to crack FHSS, it is still an 
obstacle to sniffing or eavesdropping
•
However, researches have shown that 
FHSS can be cracked and should not 
be considered a security feature.
24
Why Hack Into Water Meters?
(1) Reduce water bill
(2) Steal water
(3) Evade water restrictions
(4) Surveillance
(5) Jack up other’s water bills
(6) Route to introduce malware 
into water SCADA system(?)
(7) Get into other ‘smartgrid’ 
networks like electric grid
(8) Recon for potential attack?
25
Evil Consumer
• Theft of services
• Build and distribute MITM 
boxes, like a pirate cable 
descrambler,  or 
electricity theft device 
(being used in China), to 
lower reported usage, 
lowering water bills; 
stealing water & money.
• EFFECT: less revenue to 
water utility, leading to 
less maintenance of 
system and higher rates.
26
Evil Insider
•
Insider threat: one or more individuals 
with the access and/or inside knowledge 
of a company, organization, or enterprise 
that would allow them to exploit the 
vulnerabilities of that entity’s security, 
systems, services, products, or facilities 
with the intent to cause harm. 
•
“A new intelligence report from the 
Department of Homeland Security issued 
Tuesday, titled Insider Threat to Utilities, 
warns "violent extremists have, in fact, 
obtained insider positions," and that 
"outsiders have attempted to solicit 
utility-sector employees" for damaging 
physical and cyber attacks.” ABC News, 
July 20, 2011
•
The Maroochie incident in 2000, when a 
disgruntled former contractor used inside 
info to release 800,000 liters of sewage 
into the environment, using wireless 
network communications from his laptop, 
is an example of how insider threat could 
impact a wireless sensor network.
27
Terrorist Attack
• Recon. Terrorist sends worm 
to intercept all signals to 
build hydraulic map of 
system for optimum results 
when inject poison into 
distribution system
• Disruption. Terrorist sends 
worm to shut off all water 
on certain date and time, 
coinciding with other 
attacks, updates firmware to 
keeps water turned off until 
utility can update them all.
28
Smart Grid is very “worm-able”
• Thanassis Giannetsos 
demonstrated a worm 
attack on wireless sensor 
networks with his SENSYS 
attack tool [BH Spain 
2010]
• IOactive successfully ran a 
worm in a simulated city 
of 225,000 smart electric 
meters [BH USA 2009]
• Water smart grid could be 
just as vulnerable
29
Evil Water Utility: Big Brother?
• “Cary's citizens are right to be 
concerned about the information 
about our private lives that our 
Town staff will be able to collect if 
the Aquastar/AMI water meter 
system is implemented as planned.
• According to Daniel Burrus, a 
technology futurist and keynote 
speaker at the Autovation 
conference last September, "As a 
utility, I could know exactly when 
you take a shower, exactly when you 
water the plants or wash the dishes. 
• I could figure out how much water 
or electricity you are using at any 
point in time, and probably figure 
out what you are using it for."
30
Are We Being Paranoid?
31
Up the Ante: Hydrosense
•
HydroSense is a simple, single point, sensor 
of pressure of water in a building, which can 
give accurate information about when each 
water fixture is turned on and for how long.
•
Hydrosense is a simple, screw-on device 
that doesn’t require the services of a 
plumber. It operates on battery power, or 
uses WATTR, a self-powered version that 
uses the flow of water to power the device. 
•
Hydrosense measures the change in 
pressure  and then to estimate  the flow 
rate, which is related to pressure change via 
Poiseuille’s Law, 
•
Poiseuille’s Law is that the volumetric rate 
of fluid in a pipe Q is dependent on the 
radius of the pipe r, the length of the pipe l, 
the viscosity of the fluid µ and the pressure 
drop .
•
The information is then sent via wireless –
perhaps “backhauled” over the same 
wireless channel used by the water meter –
to the water utility.
32
Vulnerabilities of Wireless 
Water Meters
•
Some inherent vulnerabilities of 
the design – low onboard 
memory
•
One vendor tells us what 
frequencies they transmit on, 
with no FHSS or encryption!
•
Badger gives out its default  
network username, password 
and wireless key on web site
•
Transceivers can be purchased 
on Ebay
•
No encryption, FHSS, or DSSS 
on many of them
•
However, more of them are 
coming out with encryption 
now
33
Design Advances in Water Meters
• “Third Generation” 
electronic water meters 
do not need batteries, 
have 99.9% accuracy.
• More wireless water 
meters are now being 
sold with encryption, 
such as AES 128 bit, 256 
bit encryption
34
Sniffing FHSS Transceivers
•
atlas, cutaway & Q – At Shmoocon 2011, 
atlas, cutaway & Q presented Hop Hacking 
Hedy and showed how FHSS was not 
inherently secure and how to crack it in 
900 Mhz wireless devices using the 
CC1111EMK 868-915 Evaluation Module 
Kit programmed with Goodfet, using 
SmartRFstudio and python code they 
wrote.
•
Rob Havelt - At Black Hat Europe 2009, in 
Yes it is Too WiFi, and No It’s Not 
Inherently Secure, Rob Havelt discussed 
how he was able to crack Frequency 
Hopping Spread Spectrum (FHSS) in 2.4 
GHz 802.11 using GNU radio and a USRP 
2.0 and how it is not inherently secure. 
“For legacy 802.11, it was possible to just 
use a USRP locked to a specific channel 
band, then feed the raw data into the BBN 
Adroit code - for kicks, you could set a file 
as the sniffer interface for Kismet or a tool 
like that to do analysis at each layer.”
35
FAIL!
• I was hoping to supplement 
this talk with results of 
sniffing packets from my 
900 MHZ FHSS wireless 
water meter.
• But, didn’t have time or 
resources to do this before 
this talk, but the work is still 
ongoing.
• Tried Amtel RZ600, also 
FUNcube software radio 
peripheral, couldn’t get 
them to work yet.
36
Ongoing Work
•
Atmel RZ600 Development Kit. Has a 900 Mhz 
antenna and is advertised to be capable of being 
used as a development platform or just for packet 
sniffing. However, it did not work right out of the 
box. I am experimenting with some software to 
link it to Wireshark, but no success to date.
•
Texas Instruments CC1111 868-915 Mhz 
Evaluation Module Kit. Will use to try to replicate 
the FHSS technique demonstrated by atlas, 
cutaway & Q, after making a working Goodfet. 
May also try Bus Pirate and a TI CC Debugger.
•
RFM DNT900DK. The kit includes: two DNT900P 
radios installed in DNT900 interface boards, etc. 
Looks promising but haven’t tried it yet.
•
FunCUBE Dongle Pro. The FunCUBE Pro is 
advertised as a software defined radio that 
operates in the 64 – 1,700 Mhz range. I will see if I 
can use it to replicate Havelt’s methodology.
•
IM-Me. I am dying to replicate the uses of this 
pager which was demonstrated in “Real Men Carry 
Pink Pagers” by Travis Goodspeed and Michael 
Ossmann at ToorCon 2010, and see what other 
uses I can get out of it. I will try this if I have time.
•
Breaking down wireless water meters and start to 
reverse engineer them.
37
Wrapping Up
•
Water meters are an integral 
component of the national drinking 
water infrastructure
•
Tampering with water meters, 
either mechanically or 
electronically, cost s money for 
local water systems
•
Wireless water meters need to be 
better secured to prevent potential 
financial loss to water suppliers 
and to reduce potential security 
vulnerability to the water system.
•
Thanks to:
•
Marc Maiffret
•
Rob Havelt
•
Travis Goodspeed
•
atlas, cutaway, & Q
•
Bob Johnston, CISSP, for his 
archived DHS Daily Infrastructure 
Reports (cited in my white paper)
38