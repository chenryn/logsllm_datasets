可能原因
网关MAC变化。
处理步骤
l 1.确认网关MAC变化是由于正常网关迁移或更换网关设备导致还是非法报文攻
击。
l 2.如果是正常网关迁移或者更换网关设备，无需处理。
l 3.如果为非法报文攻击，请联系华为技术工程师。
l 4.结束。
----结束
文档版本 09 (2017-09-04) 华为专有和保密信息 276
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
35
MSDP
关于本章
35.1 MSDP/3/CLOSE_SOCK_FAIL_MSDP
35.2 MSDP/3/CREAT_SOCK_FAIL_MSDP
35.3 MSDP/2/msdpBackwardTransition_active
35.4 MSDP/2/msdpBackwardTransition_clear
35.5 MSDP/4/MSDP_RCV_ERR_PKT
35.6 MSDP/4/MSDP_SA_LIMIT
35.7 MSDP/6/PEER_NTFDWN
35.8 MSDP/6/PEER_TIMEOUT
35.9 MSDP/6/PEER_UP
35.10 MSDP/6/SEND_PCK_FAIL
35.11 MSDP/6/SEND_PCK_OK
文档版本 09 (2017-09-04) 华为专有和保密信息 277
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
35.1 MSDP/3/CLOSE_SOCK_FAIL_MSDP
日志信息
MSDP/3/CLOSE_SOCK_FAIL_MSDP:Close Socket failed. (Comp=[Comp],
VPNName=[VPNName], Socket Handle=[handle], SockFD=[sockFd],
SockPipeID=[sockPipeId], Peer Address=[peerAddr], ErrorCode=[ErrorCode])
日志含义
组件关闭Socket失败。
日志参数
参数名称 参数含义
Comp 组件名称。
VPNName VPN实例名称。
Socket Handle Socket句柄。
SockFD Socket ID。
SockPipeID Socket管道ID。
Peer Address 对等体地址。
ErrorCode 错误码。
可能原因
原因1:
组件繁忙，没有响应关闭Socket的消息。
原因2:
组件发送的关闭Socket的消息丢失。
处理步骤
l 请收集该设备的配置信息、告警信息和日志信息，并联系华为技术支持工程师。
----结束
文档版本 09 (2017-09-04) 华为专有和保密信息 278
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
35.2 MSDP/3/CREAT_SOCK_FAIL_MSDP
日志信息
MSDP/3/CREAT_SOCK_FAIL_MSDP:Create Socket failed. (Comp=[Comp],
VPNName=[VPNName], Socket Handle=[Handle], Peer Address=[peerAddr],
ErrorCode=[ErrorCode])
日志含义
创建Socket失败。
日志参数
参数名称 参数含义
Comp 组件名称。
VPNName VPN实例名称。
Socket Handle Socket句柄。
Peer Address 对等体地址。
ErrorCode 错误码。
可能原因
原因1：
已经创建的Socket还未关闭。
原因2：
组件没有收到Socket创建成功的消息。
处理步骤
l 请收集该设备的配置信息、告警信息和日志信息，并联系华为技术支持工程师。
----结束
35.3 MSDP/2/msdpBackwardTransition_active
日志信息
MSDP/2/msdpBackwardTransition_active:MSDP peer exit the established state.
(RemoteAddr=[RemoteAddr], PeerState=[PeerState], InstanceName=[InstanceName],
ExitReason=[ExitReason])
文档版本 09 (2017-09-04) 华为专有和保密信息 279
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
日志含义
MSDP对等体由Established状态转移到其它状态。
日志参数
参数名称 参数含义
RemoteAddr MSDP对等体地址。
PeerState MSDP对等体的状态。
InstanceName 实例名称。
ExitReason 告警原因。
FsmEstablishedTransitons 转变到连接状态的次数。
可能原因
原因1：HoldTime expired.（MSDP对等体的HoldTime定时器超时。）
原因2：Socket error.（Socket错误。）
原因3：Receive invalid TLV.（收到无效TLV。）
原因4：Receive notification TLV.（收到告警TLV。）
原因5：User operation.（用户操作。）
处理步骤
l 原因1：HoldTime expired.
a. 使用命令ping检查和对等体之间的链路是否连通。
n 如果连通，则请执行步骤3。
n 如果不连通，则请执行步骤2。
b. 使用命令display ip routing-table检查到对等体的单播路由是否正常。
n 如果路由正常，则请执行步骤3。
n 如果路由不正常，可排除单播路由故障来解决告警问题。
c. 在对等体的MSDP视图下使用display msdp peer-status命令检查对等体的状
态，即State字段。
n 如果状态为Up，则请执行步骤4。
n 如果状态为Shutdown，则说明MSDP对等体处于Shutdown状态，可在对
等体的MSDP视图下执行undo shutdown命令解决告警问题。
n 如果状态为Down，可检查Connect interface字段，建立TCP连接的接口地
址是否正确。
○ 如果正确，则请执行步骤4。
文档版本 09 (2017-09-04) 华为专有和保密信息 280
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
○ 如果不正确，可在MSDP视图下执行peer peer-address connect-
interface interface-type interface-number命令配置正确的接口地址来
解决告警问题。
n 如果为其他状态，检查对等体两端的MSDP认证配置是否相同。
○ 如果相同，则请执行步骤4。
○ 如果不相同，可为对等体两端配置相同的MSDP认证来解决告警问
题。
d. 请收集日志信息，并联系华为技术支持工程师。
l 原因2：Socket error.
a. 使用命令ping检查和对等体之间的链路是否连通。
n 如果连通，则请执行步骤3。
n 如果不连通，则请执行步骤2。
b. 使用命令display ip routing-table检查到对等体的单播路由是否正常。
n 如果路由正常，则请执行步骤3。
n 如果路由不正常，可排除单播路由故障来解决告警问题。
c. 使用命令display current-configuration检查对等体两端是否使能组播。
n 如果使能了组播，则请执行步骤4。
n 如果未使能组播，可执行multicast routing-enable命令使能组播解决告警
问题。
d. 在MSDP视图下使用命令display this检查是否配置了MSDP对等体。
n 如果配置了MSDP对等体，则请执行步骤5。
n 如果未配置MSDP对等体，可在MSDP视图下执行peer peer-address
connect-interface interface-type interface-number命令配置MSDP对等体解
决告警问题。
e. 请收集日志信息，并联系华为技术支持工程师。
l 原因3：Receive invalid TLV.
a. 可能由于对等体两端的设备对MSDP协议的实现不一致。请收集日志信息，并
联系华为技术支持工程师。
l 原因4：Receive notification TLV.
a. 确认对端设备是否执行了用户视图下的reset msdp peer命令。
n 如果执行了，则等待对等体重新建立即可。
n 如果未执行，则请执行步骤2。
b. 在对端设备的MSDP视图下执行命令display this检查是否配置了MSDP对等
体。
n 如果配置了，则请执行步骤3。
n 如果未配置，可在MSDP视图下执行peer peer-address connect-interface
interface-type interface-number命令配置MSDP对等体解决告警问题。
c. 使用命令display interface brief命令检查对等体接口是否配置了shutdown命
令。
n 如果配置了，可在接口视图下执行undo shutdown命令解决告警问题。
n 如果未配置，则请执行步骤4。
d. 请收集日志信息，并联系华为技术支持工程师。
文档版本 09 (2017-09-04) 华为专有和保密信息 281
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
l 原因5：User operation.
a. 确认用户是否执行了用户视图下的reset msdp peer命令。
n 如果执行了，则等待对等体重新建立即可。
n 如果未执行，则请执行步骤2。
b. 在MSDP视图下使用命令display this检查是否配置了MSDP对等体。
n 如果配置了，则请执行步骤3。
n 如果未配置，可在MSDP视图下执行peer peer-address connect-interface
interface-type interface-number命令配置MSDP对等体解决告警问题。
c. 使用命令display interface brief命令检查接口是否配置了shutdown命令。
n 如果配置了，可在接口视图下执行undo shutdown命令解决告警问题。
n 如果未配置，则请执行步骤4。
d. 请收集日志信息，并联系华为技术支持工程师。
----结束
35.4 MSDP/2/msdpBackwardTransition_clear
日志信息
MSDP/2/msdpBackwardTransition_clear:MSDP peer enter the established state.
(RemoteAddr=[RemoteAddr], FsmEstablishedTransitons=[EstablishedTransitons],
InstanceName=[InstanceName])
日志含义
本端设备与对端设备建立MSDP peer连接，会报告警清除。
日志参数
参数名称 参数含义
RemoteAddr MSDP对等体地址。
PeerState MSDP对等体的状态。
InstanceName 实例名称。
ExitReason 告警原因。
FsmEstablishedTransitons 转变到连接状态的次数。
可能原因
MSDP peer进入Established状态。
文档版本 09 (2017-09-04) 华为专有和保密信息 282
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
处理步骤
l 正常运行信息，无需处理。
----结束
35.5 MSDP/4/MSDP_RCV_ERR_PKT
日志信息
MSDP/4/MSDP_RCV_ERR_PKT:MSDP receives an error packet and drops it.
(VrfName=[VrfName], PktType=[PktType], ErrPktCnt=[ErrPktCnt])
日志含义
MSDP收到错误报文后将其丢弃。
日志参数
参数名称 参数含义
VrfName 实例名称。
PktType 报文类型。
ErrPktCnt 错误报文计数。
可能原因
MSDP收到错误报文后将其丢弃。
处理步骤
l 正常运行信息，无需处理。
----结束
35.6 MSDP/4/MSDP_SA_LIMIT
日志信息
MSDP/4/MSDP_SA_LIMIT:In the VPN instance, the number of (S, G) entries learned from
an MSDP peer exceeded the maximum number of entries allowed by the SA cache.
(InstanceName=[InstanceName], RPAddr=[RPAddr], SourceAddr=[SourceAddr],
GroupAddr=[GroupAddr], PeerAddr=[PeerAddr], MaxNum=[MaxNum])
日志含义
在VPN实例中，从MSDP对等体学到的（S，G）项数量超过了SA缓存的最大值。
文档版本 09 (2017-09-04) 华为专有和保密信息 283
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
日志参数
参数名称 参数含义
InstanceName VPN实例名。
RPAddr RP地址。
SourceAddr 源地址。
GroupAddr 组地址。
PeerAddr 对等体地址。
MaxNum 最大的数量。
可能原因
在VPN实例中，从MSDP对等体学到的（S，G）项数量超过了SA缓存的最大值。
处理步骤
l 正常运行信息，无需处理。
----结束
35.7 MSDP/6/PEER_NTFDWN
日志信息
MSDP/6/PEER_NTFDWN:In VPN instance, a session with the peer was closed because a
Notification TLV was received from this peer. (VPNName=[VPNName],
PeerAddr=[PeerAddr])
日志含义
在VPN实例中，因为从对等体收到一个Notification TLV，关闭一个与对等体的会话。
日志参数
参数名称 参数含义
VPNName VPN实例名。
PeerAddr 对等体IP地址。
可能原因
在VPN实例中，因为从对等体收到一个Notification TLV，关闭一个与对等体的会话。
文档版本 09 (2017-09-04) 华为专有和保密信息 284
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
处理步骤
l 正常运行信息，无需处理。
----结束
35.8 MSDP/6/PEER_TIMEOUT
日志信息
MSDP/6/PEER_TIMEOUT:In the VPN instance, a session with peer was closed because the
peer holding time expired. (VPNName=[VPNName], PeerAddr=[PeerAddr])
日志含义
在VPN实例中，因为对等体的保留时间超时，关闭一个与对等体的会话。
日志参数
参数名称 参数含义
VPNName VPN实例名。
PeerAddr 对等体IP地址。
可能原因
在VPN实例中，因为对等体的保留时间超时，关闭一个与对等体的会话。
处理步骤
步骤1 执行ping命令检查线路是否正常连接。
l 如果是，则请执行步骤2。
l 如果不是，则请执行步骤3。
步骤2 执行display msdp peer-status确认对端配置是否改变。
步骤3 请收集日志信息，并联系华为技术支持工程师。
----结束
35.9 MSDP/6/PEER_UP
日志信息
MSDP/6/PEER_UP:In the VPN instance, a session with the peer was initiated.
(VPNName=[VPNName], PeerAddr=[PeerAddr])
日志含义
在VPN实例中，启动一个与对等体的会话。
文档版本 09 (2017-09-04) 华为专有和保密信息 285
版权所有 © 华为技术有限公司
CX110&CX31x系列 交换模块
日志参考 35 MSDP
日志参数
参数名称 参数含义
VPNName VPN实例名。
PeerAddr 对等体IP地址。
可能原因
在VPN实例中，启动一个与对等体的会话。
处理步骤
l 正常运行信息，无需处理。
----结束
35.10 MSDP/6/SEND_PCK_FAIL