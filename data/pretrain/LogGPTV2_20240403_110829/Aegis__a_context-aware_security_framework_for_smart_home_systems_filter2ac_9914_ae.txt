FOR EDUCATIONAL PURPOSES ONLY
[12] Earlence Fernandes, Amir Rahmati, Jaeyeon Jung, and Atul Prakash. 2017. Secu-
rity implications of permission models in smart-home application frameworks.
In IEEE Security & Privacy.
[13] Behrang Fouladi and Sahand Ghanoun. 2013. Honey, I’m Home!!, Hacking ZWave
Home Automation Systems. In Black Hat.
[14] Google. 2019. Cloud AutoML. https://cloud.google.com/automl/
[15] Rachel Gunter. 2017. Making Sense of Samsung’s SmartThings Initiative. https:
//marketrealist.com/2017/12/making-sense-samsungs-smartthings-initiative
[16] Grant Ho, Derek Leung, Pratyush Mishra, Ashkan Hosseini, Dawn Song, and
David Wagner. 2016. Smart locks: Lessons for securing commodity internet of
things devices. In Proceedings of the 11th ACM on Asia conference on computer
and communications security.
[17] IoTBench. 2017. https://github.com/IoTBench. [Online; accessed 09-October-
2018].
[18] Yunhan Jack Jia, Qi Alfred Chen, Shiqi Wang, Amir Rahmati, Earlence Fernandes,
Z Morley Mao, Atul Prakash, and Shanghai JiaoTong Unviersity. 2017. ContexIoT:
Towards providing contextual integrity to appified IoT platforms. In Proceedings
of The Network and Distributed System Security Symposium.
[19] Julian Keilson. 2012. Markov chain models—rarity and exponentiality. Vol. 28.
Springer Science & Business Media.
[20] Changmin Lee, Luca Zappaterra, Kwanghee Choi, and Hyeong-Ah Choi. 2014. Se-
curing smart home: Technologies, security challenges, and security requirements.
In IEEE Conference on Communications and Network Security (CNS).
[21] Byungho Min and Vijay Varadharajan. 2015. Design and evaluation of feature dis-
tributed malware attacks against the Internet of Things (IoT). In 20th International
Conference on Engineering of Complex Computer Systems (ICECCS). IEEE.
[22] Mujahid Mohsin, Zahid Anwar, Ghaith Husari, Ehab Al-Shaer, and Moham-
mad Ashiqur Rahman. 2016. IoTSAT: A formal framework for security analysis of
the internet of things (IoT). In IEEE Conference on Communications and Network
Security (CNS).
[23] Sukhvir Notra, Muhammad Siddiqi, Hassan Habibi Gharakheili, Vijay Sivaraman,
and Roksana Boreli. 2014. An experimental study of security and privacy risks
with emerging household appliances. In IEEE Conference on Communications and
Network Security (CNS).
[24] Charith Perera, Arkady Zaslavsky, Peter Christen, and Dimitrios Georgakopoulos.
IEEE
2014. Context aware computing for the internet of things: A survey.
communications surveys & tutorials 16, 1 (2014), 414–454.
[25] Michael Schiefer. 2015. Smart home definition and security threats. In Ninth
International Conference on IT Security Incident Management & IT Forensics (IMF).
IEEE.
[26] Tara Seals. 2015. BlackHat: Critical ZigBee Flaw Compromises Smart Homes. https:
//www.infosecurity-magazine.com/news/blackhatcritical-zigbee-flaw-smart/
[27] Amit Kumar Sikder, Hidayet Aksu, and A. Selcuk Uluagac. 2017. 6thSense: A
Context-aware Sensor-based Attack Detector for Smart Devices. In 26th USENIX
Security Symposium.
[28] Amit Kumar Sikder, Hidayet Aksu, and A Selcuk Uluagac. 2019. A Context-
aware Framework for Detecting Sensor-based Threats on Smart Devices. In IEEE
Transactions on Mobile Computing.
[29] Amit Kumar Sikder, Hidayet Aksu, and A Selcuk Uluagac. 2019. Context-aware
intrusion detection method for smart devices with sensors. US Patent App.
15/729,092.
[30] Vijay Sivaraman, Dominic Chan, Dylan Earl, and Roksana Boreli. 2016. Smart-
phones attacking smart-homes. In Proceedings of the 9th ACM Conference on
Security & Privacy in Wireless and Mobile Networks.
[31] Vijay Sivaraman, Hassan Habibi Gharakheili, Arun Vishwanath, Roksana Boreli,
and Olivier Mehani. 2015. Network-level security and privacy control for smart-
home IoT devices. In 11th International Conference on Wireless and Mobile Com-
puting, Networking and Communications (WiMob). IEEE.
[32] Statista. 2018. Installed base of home automation/smart home systems in the United
States from 2012 to 2017 (in millions). https://www.statista.com/statistics/286813/
installed-base-of-smart-home-systems-us/
[33] Biljana L Risteska Stojkoska and Kire V Trivodaliev. 2017. A review of Internet
of Things for smart home: Challenges and solutions. Elsevier.
[34] Darlene Storm. 2016. Hackers demonstrated first ransomware for IoT thermostats at
DEF CON. https://www.computerworld.com/article/3105001/security/hackers-
demonstrated-first-ransomware-for-iot-thermostats-at-def-con.html
[35] Yuan Tian, Nan Zhang, Yueh-Hsun Lin, XiaoFeng Wang, Blase Ur, XianZheng
Guo, and Patrick Tague. 2017. SmartAuth: User-Centered Authorization for the
Internet of Things. In 26th USENIX Security Symposium.
[36] Qi Wang, Wajih Ul Hassan, Adam Bates, and Carl Gunter. 2018. Fear and Logging
in the Internet of Things. In ISOC NDSS.
[37] Nong Ye et al. [n.d.]. A markov chain model of temporal behavior for anomaly de-
tection. In Proceedings of the 2000 IEEE Systems, Man, and Cybernetics Information
Assurance and Security Workshop, Vol. 166. West Point, NY, 169.
[38] Amit Kumar Sikder Z. Berkay Celik, Leonardo Babun. 2018. A micro-benchmark
suite to assess the effectiveness of tools designed for IoT apps. https://github.com/
IoTBench/
A PERFORMANCE METRICS
In the evaluation of Aegis, we used six different performance met-
rics: True Positive rate (TP), False Negative rate (FN), True Negative
rate (TN), False Positive rate (FP), Accuracy, and F-score. TP rate in-
dicates the percentage of correctly identified benign activities while
TN rate refers to the percentage of correctly identified malicious
activities. On the other hand, FP and FN illustrates the number of
malicious activities identified as benign and the number of benign
activities detected as malicious activities respectively. F-score is a
indicator of accuracy of a framework which considers TP and TN
as computational vector. The performance metrics are defined by
the following equations:
T P r ate =
F N r ate =
T N r ate =
F P r ate =
T P
T P + F N ,
F N
T P + F N ,
T N
T N + F P ,
F P
T N + F P ,
T P + T N
Accur acy =
T P + T N + F P + F N ,
F − scor e = 2 ∗ T P ∗ T N
T P + T N .
(4)
(5)
(6)
(7)
(8)
(9)
B SAMPLE SMART APP FOR APP CONTEXT
One of the features of Aegis is using app context to verify the device
states in the SHS. To build the app context, we used similar static
analysis approaches used in prior works [6, 8]. We performed a
source-to-sink taint analysis similar to [6] to extract the app context.
Additionally, we consider the sources for smart apps proposed
in [8, 18]. We then built the abstract syntax tree (AST) and model a
trigger-action scenario of an app. We tracked the Subscribe method
to represent the trigger and follow the conditional statement (e.g.,
if and switch) to reach the sink. This flow from entry point (source)
to a sink is used to construct the condition of an app which is then
represented into app context. We collected 150 official Samsung
SmartThings apps (available in their website) and created the app
context database using this method.
Listing 3: A code snippet of a sample smart app
input "contact1", "capability.contactSensor", title: "Where?"
input "light1", "capability.light"
name: "Smart Light App",
namespace: "smartthings",
author: "anonymous",
description: "Turn lights on when door is open.",
category: "Convenience",
section("When the door opens/closes...") {
}
section("Turn on/off a light...") {
}
1 /∗ This is a sample smart light app for Samsung SmartThings ∗/
2 definition(
3
4
5
6
7
8 )
9 preferences {
10
11
12
13
14
15
16 }
17 def installed() {
18
19 }
20 def updated() {
21
22
23 }
24 def contactHandler(event) {
25
light1.on()
26
27
light1.off()
28
29
30 }
if (event.value == "open") {
} else if (event.value == "closed") {
}
unsubscribe()
subscribe(contact1, "contact", contactHandler)
subscribe(contact1, "contact", contactHandler)
Version Accepted by ACSAC'19: A. K. Sikder, L. Babun, H. Aksu, A. Selcuk Uluagac
FOR EDUCATIONAL PURPOSES ONLY
researchers. Our threat model covers the malicious apps presented
in the prior works and Aegis can detect these threats with high
accuracy.
Aegis Threat Model
ContextIoT [18]
Listing 4: trigger-action Scenario of a sample app
1 Trigger: Contact1
2 Action: Switch1
3 Logic 1: contact1 = on, light1 = on
4 Logic 2: contact1 = off, light1 = off
Listing 5: Generated app context of a sample app
1 App Context 1: contact1 = 1 , Light1 = 1
2 App context 2: contact1 = 0, Light1 = 0
C LIST OF SMART HOME DEVICES USED IN
AEGIS
Device
Type
Model
Description
Smart Home Hub
Samsung SamrtThings Hub
Smart Light
Philips Hue Light Bulb
Smart Lock
Fire Alarm
Smart
Monitoring
System
Smart
Thermostat
Smart TV
Motion, Light,
& temperature
sensor
Yale B1L Lock with
Z-Wave Push Button
Deadbolt
First Alert 2-in-1 Z-Wave
Smoke Detector and
Carbon Monoxide Alarm
Arlo by NETGEAR
Security System
Ecobee 4 Smart Thermostat
Samsung 6 Series
UN49MU6290F LED
Smart TV
Fibaro FGMS-001 Motion Sensor
• Works as a central access point for
smart home entities.
• Supports Wi-Fi, ZigBee,and Z-Wave.
• Uses a separate communication bridge
to connect with smart home hub.
• Uses ZigBee to communicate with other
components in SHS.
• Supports up to 12 different sensors.
• Uses Z-Wave to connect with other
• Offers different pin code for different
• Provides both manual and remote
• Uses Z-Wave to connect with the hub
• Provides built-in smoke and CO sensors.
• Uses Wi-Fi to connect with smart home
• Offers both live monitoring and still
• Uses Wi-Fi to communicate with smart
• Can be configured with sensors.
• Connects with smart home hub using
Wi-Fi.
• Uses Z-Wave to connect with the hub.
• Can be configured with different
devices simultaneously.
devices.
users.
access.
hub.
pictures.
hub.
Threat-1
Threat-2
Threat-3
Threat-4
Threat-5
IoTBench [38]
• Permissions- Implicit 2
—
• Side Channel - Side Channel 1.
• Side Channel - Side Channel 1.
—
—
• Backdoor pin code injection.
• Lock access revocation.
• LockManager.
• App Update – PowersOutAlert.
• Lock access revocation.
• Fake alarm.
• Remote control – FireAlarm.
• Remote command – SmokeDe-
tector.
• Leaking information.
• creating seizures using strobed
light.
• IPC – MaliciousCameraIPC &
PresenceSensor.
• MidnightCamera.
• Disabling vacation mode.
• Abusing permission.
• Surreptitious surveillance.
• Undesired unlocking.
• IPC – MaliciousCameraIPC &
PresenceSensor.
Table 5: Malicious Apps mapping of Aegis, ContextIoT, and
IoTBench
E ALERT SYSTEM IN AEGIS
Aegis proposes an adaptive training mode to improve the accuracy
of the framework and detect the false positive and negative oc-
currences. In Figure 8, both adaptive training mode and normal
operation mode are illustrated.
Samsung Multipurpose Sensor
Door Sensor
Table 4: List of devices used in the data collection.
smart home hub.
• Uses ZigBee protocol to connect with
D DETAILED THREAT MODEL USED DURING
AEGIS EVALUATION
To evaluate Aegis, we considered five different threat models (Sec-
tion 3). We built five malicious apps to represent these threats. Our
malicious apps cover several known threats presented by other
researchers in [18, 38]. To perform the attack described in Threat 1,
we built a battery monitor App for smart locks that leaks the unlock
code via SMS to the attacker. We realized the impersonation attack
by unlocking the smart lock as an outsider using the leaked unlock
code. For Threat 2, we built an app that injects false smoke sensor
data to trigger the fire alarm in the SHS. For Threat 3, we created an
app that flickered a smart light in a specific pattern while nobody
was in the home. To perform the denial-of-service attack described
in Threat 4, we developed an app that stopped the smart thermostat
for a pre-defined value. For Threat 5, we created an app that could
generate morse code using a smart light while no person was in
the room and triggered a smart camera to take stealthy pictures.
Our malicious apps cover several existing attacks on smart home
devices presented by the researchers [18, 38]. In Table 5, we mapped
our threat models with existing malicious apps presented by the
(a) Normal Mode
(b) Adaptive Training Mode
Figure 8: User interface of Aegis in different operation mode.
F EXAMPLE OF SHS LAYOUT USED DURING
EVALUATION
To collect data for Aegis, we setup three different SHS layouts where
users replicated their daily activities in a smart home. In Figure 9,
the single bedroom layout of a smart home is shown which is used
to take the user data in our emulator. Users clicked on different
places in the layout while listing their daily activities in a timely
manner. These activities were used to train and test the efficacy of
Aegis.
Version Accepted by ACSAC'19: A. K. Sikder, L. Babun, H. Aksu, A. Selcuk Uluagac
FOR EDUCATIONAL PURPOSES ONLY
Figure 9: Single bedroom smart home layout used during evaluation.