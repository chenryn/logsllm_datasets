scaling parameters for feature set f which can be one of the four
different combinations of features (high/low bins of CANH/CANL).
Now we need to leverage this knowledge to upgrade our IDS in a
way that it accounts for variations in the supply voltage level. To do
so, we extracted features on supply voltage levels that already had
training data available and scaled them to a specific target voltage
domain (to avoid the drift in the fingerprints caused by variations of
the voltage level). Next, we need to be capable of repeating the same
process on supply voltage levels for which the training data is not
available. This is leads to a generalized solution in the following.
Compensating for supply voltage changes. In the previous
discussions, we defined different voltage domains for generating
features and exploited regression as a simple tool for mapping the
features from one domain to another. Now we apply the idea to our
scenario and estimate matrices A and B, as n × 1 matrices, where
the rows correspond to the voltage level varying in the interval
of [3.00, 3.25] V with steps of 50 mV to cover the operating range
f
f
of our ECUs. The column in A and B hold the values of a
0 and a
1
explained in Eq. 10. Depending on the type of feature f (low/high
of CANH/CANL), the A and B values would be:
f
0(v1), a
1(v1), a
f
f
0(v2), · · · , a
1(v2), · · · , a
f
a
a
,
,
(11)
(cid:104)
(cid:104)
A =
B =
0(vn)(cid:105)⊺
1(vn)(cid:105)⊺
f
f
assuming there are n voltage levels.
After generating the A and B matrices we fit another linear
regression to elements of each matrix, trying to estimate the cor-
f
responding ˆa
1 for another voltage level in source domain,
ˆν, for which we do not have access to training data. In fact, we are
able to estimate the scaling parameters for mapping the features
f
0 and ˆa
Impact of Temperature. At all rounds of data collection, the
6.1.2
temperature values are collected and stored on a per frame basis
for further analysis. We investigate the possibility of a linear re-
lationship between the features and temperature in a controlled
setup, which emulates the rise of temperature once the engine gets
started. Such a linear relationship can be modelled using Eq. 12,
f
0 ∗ T + c
f
1
F = c
(12)
where F is the vector of features, T is the internal temperature, and
f
f
0 and c
1 are the estimation parameters for feature set f which
c
can be one of the four different combinations of features (high/low
bins of CANH/CANL), later validated in Sec. 6.2.
6.2 Evaluation
An experimental setup is used for emulating the ECUs that are con-
nected via a CAN bus and send messages that are crafted based on
CAN protocol. The setup includes TM4C123GXL micro-controllers
[46] integrated on a TivaC launchpad which are programmed to
send extended CAN (2.0b) messages with 29 bit identifiers, where
the identifier and data section for each frame in each round of data
collection are configured to be random. These devices have exactly
the same configuration, have been built by the same manufacturer,
and purchased at the same time. The ECUs send a CAN message
every 1 s with data rate of 110 Kbps, and a USB2523-MCC DAQ
[32] with 12 bits of resolution is used to perform sampling at rate
of 500 Ksps on each channel associated with CANH and CANL. Fig.
7a illustrates the basic setup that was used for data collection.
6.2.1 Results for Constant Voltage with Natural Variations in Tem-
perature. We emulate 10 ECUs in this setup, and collect 10,000 CAN
frames from each. Next we select 2 % of the data at random to ex-
tract feature templates for each ECU and generate thresholds. The
remaining data is used for the testing phase. The ECUs take turns to
be the legitimate device in each round of analysis which is indicated
as Case i where the ith ECU is the legitimate one. The EERs and
the thresholds associated with them are reported in Table 3a.
Table 3a shows that the features generated based on SIMPLE
are able to distinguish perfectly between the devices when Vcc is
constant and give EER values close to 0% (the ideal EER value).
6.2.2 Results for Changing Voltage with Natural Variations in Tem-
perature. We collect new rounds of data from devices when the Vcc
is reduced by steps of 50 mV, within the operating voltage range
of the transceivers covering Vcc ∈ {3.00, 3.05, 3.10, 3.15, 3.20, 3.25}.
The primary analyses demonstrate as low EER results as 0% which
are not presented here due to space limitations.
Next, we validate the proposed solution provided in Sec. 6.1,
which accounts for the variations in the voltage levels with no data
available for exact scaling parameter training. We collect new data
at different voltages than the ones mentioned above, but within
the operating range of our transceiver (3.3 V with drop value of
within 0.3 V [46]). Now results of two sample voltage levels, Vsr
= 3.275 V and Vsr = 3.225 V are given here as representatives of
several rounds of data collection and testing. Tables 3b and 3c give
the EER values and their corresponding thresholds for after using
the estimated scaling parameters for mapping features from source
domains (no training data) to the target domain (Vtg = 3.30 V here).
The Mahalanobis distances of features calculated during test
phase of Case 2 (where all ECUs take turns to send malicious frames
on behalf of ECU02, whereas ECU02 is sending legitimate frames)
are plotted on top on each other as a sample result in Fig. 6b, which
shows the capability of SIMPLE to compensate for Vcc variation.
6.2.3 Results for Constant Voltage with Natural Variations in Tem-
perature. In all rounds of data collection, the temperature values
are collected with an ADC and temperature sensor integrated in the
same TivaC LaunchPad [26], and stored for each frame for further
analysis. We train our templates for each device on different days
with different conditions such as no air conditioning. Fig. 6a is a
sample result when other ECUs take turns doing a masquerade
attack on ECU01. After accounting for the variations in the Vcc
level, and are able to identify the malicious frames with EER of zero,
regardless of the temperature differences during the training and
testing phase. Repeating the same analysis on more than 70 rounds
of data collection on different days, and EER of zero for all, allows
us conclude that features used by SIMPLE are robust enough that
they are not affected by natural temperature changes up to ±6◦C.
7 EXPERIMENTAL VALIDATION
The above in-lab experiments, carried out using commonly avail-
able parts, allowed us to determine the factors that affect ECU
fingerprints. In this section we extend this analysis by examining
emulated ECUs that are architected to reflect actual automotive
ECUs and built using automotive grade parts.
7.1 In-lab Experiments
Automotive grade transceivers, reported in Table 2, were used for
building ECUs on a CAN bus shown in Fig. 7b. TM4C123GXL mi-
crocontrollers were used as the CAN protocol controller, and TI
voltage regulators for proper powering of the devices (Fig. 5d).
Table 2: Automotive grade transceivers on the CAN bus pro-
totype.
CAN transceiver
TJA1050 [41]
NCV7340 [25]
HA13721 [11]
TCAN332 [24]
MAX3051 [27]
Manufacturer
NXP
ON Semiconductor
Renesas
Texas Instruments
Maxim Integrated
Quantity
3
1
2
2
2
Voltage Regulator
TLV1117-50 [23]
TLV1117-50 [23]
TLV1117-50 [23]
TLV1117-33 [23]
TLV1117-33 [23]
7.1.1 Results for Varying Voltage with Natural Variations Tempera-
ture. The results of the lab experiments presented in Sec. 6.2.1, illus-
trate that the fingerprints deviate mainly due to changes in voltage
source values. However, in this setup as in actual automotive ECUs,
Vcc was tightly controlled via a voltage regulator in the powering
circuitry. In order to analyse how voltage drops in Vcc change the
fingerprints, we tested extreme cases where the Vcc was dropped
with steps of 1 Volt, covering values of Vsr = {8, 9, 10, 11, 12} V
and collected 10,000 sample frames. Next, we did the feature trans-
formation conducted in Sec. 6.1.1 to scale features that were col-
lected in a source voltage level domain (could be any value out of
Vsr = {8, 9, 10, 11} V) up to a target voltage domain of choice (12 V
in this work). Repeating the same procedure as Sec. 6.1.1, we were
able to estimate the new scaling coefficients (Eq. 10) for a randomly
selected voltage level in the continuous interval of Vsr ∈ [8 : 12]
V without collecting training data. Table 3d illustrates the conven-
tional analysis where we collected 10,000 sample frames from the
ECUs on the bus when Vcc = 12.00 V and using K-fold cross valida-
tion for the EER analysis. In results shown at Table 3f, the feature
transformation coefficients were trained on the data collected at
Vsr = {9, 10, 11} V and validated on the data collected at Vsr = 8.00
V. Fig. 6c shows a sample result, where the data collected from the
ECU with HA13721-02 (HA02) transceiver at Vsr = 8.00 was scaled
up to Vtg = 12.00 and tested against any other existing ECU on
the bus that could impersonate it. As shown in the temperature
graph, natural variations in temperature did not affect the proper
performance of SIMPLE.
Table 4: Cross validating a linear regression for modelling
the change of features with temperature.
CAN transceiver
TJA1050 [41]
NCV7340 [25]
HA13721 [11]
TCAN332 [24]
MAX3051 [27]
Correlation type
with high-of-CAN
negative
negative
negative
positive
positive
R2 (round-a)
MSE (round-b)
0.9874
0.9330
0.9684
0.9812
0.9850
0.0002
0.0132
0.0165
0.0180
0.0168
7.1.2 Results for Constant Voltage with Controlled High Temper-
ature. Here we slightly modified the benchtop setup by using a
cardboard covering and increasing the temperature of the ECUs
using a heat gun during data collection. Fig. 8a illustrates how the
first feature of NCV7340 changed over time in the upper graph,
with the changes in the temperature is depicted in the lower graph.
We use the linear regression model given at Eq. 12 to correlate the
features of every device to temperature values, a sample of which
shown at Fig. 8b for NCV7340. The average R2 values of this fitting
model are given at table 4, where the averaging was performed
over different features. R2 values of close to unity for all devices,
validates that there was a linear relationship between the features
and the temperature. We observe both positive and negative corre-
lations between the feature and temperature for different devices,
which is a consistent behaviour based on repetitive experiments on
each device. Next, we tested the trained linear model on another
round of experiment (round-b). The average of mean square error
(MSE) values of estimation of features for round-b given at Table
4 are close to zero which validates the goodness of the fit in this
model. Note that the graphs in this section include the first feature
as a representative of the rest of features which show similar be-
haviour. In summary, SIMPLE is robust to variations in temperature
and supply voltage values.
7.2 In-vehicle Experiments
We collected CAN messages from two vehicles, Nissan Sentra 2016
(Fig. 9a) and Subaru Outback 2011 (Fig. 9b), via the OBD-II port
using a Tektronix DPO 3012 oscilloscope shown in Fig. 9c. The
oscilloscope sampled at 50 Msps per channel with 8 bits of resolution
and sent records to a computer via USB connection. We drove the
vehicles for about forty minutes in each round, including local and
(a)
(b)
(c)
(d)
Figure 6: (a) The effect of temperature on fingerprinting process of ECU1. The training is done at Vsr = 3.00 V on an ambient
temperature different from the testing phase with voltage level of Vtg = 3.30 V. Natural variations of temperature values are
plotted in the lower graph with respect to CAN frame indices. (b) The Mahalanonbis distance of CAN frames transmitted from
all ECUs from the template feature of ECU02. The source voltage is set to Vsr = 3.225 V and Vtg = 3.30 V. (c) The Mahalanonbis
distance of CAN frames transmitted from all ECUs from the template feature of ECU:HA02. The source voltage is set to Vsr
= 8.00 V and Vtg = 12.00 V. Natural variations of temperature values are plotted in the lower graph with respect to CAN frame
indices. The ambient temperature is different at training and testing process, however, it does not affect the functionality of
the identification process. (d) The Mahalanonbis distance of CAN frames transmitted from all ECUs from the template feature
of ECU:F collected from Subaru Outback.
Table 3: The EER values and their corresponding thresholds (Mahalanobis distances). ECUi corresponds to the ith emulated
ECU being the legitimate device. Tables (b)(c)(e)(f) show that we were able to test the frames transmitted from ECUs at different
source voltages without having training data for that source level.
(b) Vsr = 3.225 V, and Vcc = 3.30 V
(c) Vsr = 3.275 V, and Vcc = 3.30 V
EER
0%
0%
0%
0%
0%
EER
0%
0%
0.02%
0.05%
0%
Thresh.
208.378
112.142
143.402
982.568
1290.6
ECU6
ECU7
ECU8
ECU9
ECU10
ECU1
ECU2
ECU3
ECU4
ECU5
(f) Vsr = 8.00 V, and Vcc = 12.00 V
EER
0%
0%
0.04%
0%
0%
Thresh.
3.7624e + 03
752.0212
400.4652
1.0970e + 03
1.1843e + 03
EER
0%
2.3%
0.52%
0%
0.08%
ECU6
ECU7
ECU8
ECU9
ECU10
Thresh.
578.659
341.115
45.741
44.206
1235.5
Thresh.
730.6701
13.7138
19.1959
1515.6
861.1623
ECU1
ECU2
ECU3
ECU4
ECU5
EER