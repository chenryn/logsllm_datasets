should be done to harden these solutions.
Disparities across Populations. We are not the rst to con-
sider how changes in protocols and network infrastructure impact
dierent populations in varying ways. In 2010, Howard et al. [23]
studied the so-called “digital divide” between the higher and lower
income groups in the U.S. and Canada. They gathered empirical
measurements demonstrating dierences in the frequency and na-
ture of Internet usage across income groups. More recently, Nielsen
et al. [38] studied progress towards closing this divide, nding that
there may be a tipping point around 50% Internet usage for many
populations, after which Internet usage increases more rapidly.
Quan et al. [41] studied which networks and regions experience the
largest changes in devices online between day and night, nding
that areas populations with lower per capita GDP experience a
higher percent decrease in connected devices at night, possibly due
to an increased emphasis on saving energy and money in those
regions. These studies emphasize the importance in understanding
how new technologies can aect dierent populations in substan-
tially dierent ways.
9 CONCLUSION
The work studied the performance impact that a transition to DoH
would have to residential clients around the globe. We devised a
careful methodology, employing 22,052 clients across the world to
collect our measurements. The resultant data paints a complex pic-
ture, with DoH providing performance benets in certain regions
and slowdowns in others. We then studied dierences between four
major public DoH providers, outlining dierences in architecture
and routing capabilities that may aect overall resolution perfor-
mance. We also analyzed several explanatory variables correlated
363
with the performance impact of a switch from Do53 to DoH, nding
that clients in countries with higher quality Internet infrastructure
(faster speeds, more ASes) and clients from higher-income countries
are less likely to experience a slowdown from a switch to DoH, and
in many cases may experience a DoH speedup. This raises important
questions about the asymmetrical eects of global DoH adoption,
and should be studied further and weighed in DoH deployment
decisions. We make our dataset available for further study, and we
hope our ndings will help inform the DoH community as adoption
continues to accelerate.
ACKNOWLEDGMENTS
We thank our shepherd Aaron Schulman and the anonymous re-
viewers for their constructive comments and suggestions. This work
was supported in part by the National Science Foundation (NSF)
under grant #2030859 to the Computing Research Association for
the CIFellows Project, and grant #2030521. Any opinions, ndings,
conclusions, or recommendations expressed in this material are
those of the authors and do not necessarily reect the views of any
funding agencies.
REFERENCES
[1] Apple. 2020. Enable encrypted DNS. https://developer.apple.com/videos/play/
wwdc2020/10047/.
[2] Kenji Baheux. 2020. A safer and more private browsing experience on Android
with Secure DNS. https://blog.chromium.org/2020/09/a-safer-and-more-private-
browsing.html.
[3] World Bank. 2021. https://data.worldbank.org/indicator/NY.GDP.MKTP.CD.
[4] BrightData. 2021. Bright Data (formerly Luminati Network). https://brightdata.
[5] BrightData. 2021. Bright Data’s super proxy servers. https://brightdata.com/
com/.
proxy-types/super-proxy.
[6] Martin Brinkmann. 2020. Chrome 83: rollout of DNS over HTTPS (Secure DNS) be-
gins. https://www.ghacks.net/2020/05/20/chrome-83-rollout-of-dns-over-https-
secure-dns-begins/.
[7] Content by Rodney. 2021. How to Enable Encrypted DNS on iPhone iOS 14.
https://rodneylab.com/how-to-enable-encrypted-dns-on-iphone-ios-14/.
[8] Timm Böttger, Felix Cuadrado, Gianni Antichi, Eder Leão Fernandes, Gareth
Tyson, Ignacio Castro, and Steve Uhlig. 2019. An Empirical Study of the Cost of
DNS-over-HTTPS. In ACM Internet Measurement Conference.
[9] Taejoong Chung, Roland van Rijswijk-Deij, Balakrishnan Chandrasekaran, David
Chones, Dave Levin, Bruce M. Maggs, Alan Mislove, and Christo Wilson. 2017.
A Longitudinal, End-to-End View of the DNSSEC Ecosystem. In USENIX Security
Symposium.
[10] Taejoong Chung, Roland van Rijswijk-Deij, David Chones, Dave Levin, Bruce M.
Maggs, Alan Mislove, and Christo Wilson. 2017. Understanding the Role of
Registrars in DNSSEC Deployment. In ACM Internet Measurement Conference.
[11] Google Cloud. 2021. https://cloud.google.com/cdn/docs/locations.
[12] Cloudare. 2021. Android Pie and later supports DNS over TLS. https://developers.
cloudare.com/1.1.1.1/setup-1.1.1.1/android.
[13] Cloudare. 2021. Cloudare 1.1.1.1. https://1.1.1.1
[14] Federal Trade Commission. 2021.
broadband-speed-guide.
https://www.fcc.gov/consumers/guides/
dns
[15] Casey Deccio and Jacob Davis. 2019. DNS Privacy in Practice and Prepara-
tion. In ACM International Conference on emerging Networking EXperiments and
Technologies.
[16] Trinh Viet Doan, Irina Tsareva, and Vaibhav Bajpai. 2021. Measuring DNS over
TLS from the Edge: Adoption, Reliability, and Response Times. In Passive and
Active Measurement Conference.
[17] Google. 2019. Google Public DNS. https://developers.google.com/speed/public-
[18] Brian Haberman and Catherine Master. 2017. DNS-over-TLS Measurements with
RIPE Atlas Probes. https://datatracker.ietf.org/meeting/102/materials/slides-102-
dprive-dns-over-tls-measurements-with-ripe-atlas-probes-01.
[19] Nguyen Phong Hoang, Arian Akhavan Niaki, Nikita Borisov, Phillipa Gill, and
Michalis Polychronakis. 2020. Assessing the Privacy Benets of Domain Name
Encryption. In ACM ASIA Conference on Computer and Communications Security.
[20] Austin Hounsel, Kevin Borgolte, Paul Schmitt, Jordan Holland, and Nick Feamster.
2019. Analyzing the Costs (and Benets) of DNS, DoT, and DoH for the Modern
IMC ’21, November 2–4, 2021, Virtual Event
Rishabh Chhabra, Paul Murley, Deepak Kumar, Michael Bailey, and Gang Wang
Web. In Applied Networking Research Workshop.
[21] Austin Hounsel, Kevin Borgolte, Paul Schmitt, Jordan Holland, and Nick Feamster.
2020. Comparing the Eects of DNS, DoT, and DoH on Web Performance. In The
ACM Web Conference.
[22] Austin Hounsel, Paul Schmitt, Kevin Borgolte, and Nick Feamster. 2021. Can
Encrypted DNS Be Fast?. In Passive and Active Measurement Conference.
[23] Philip N Howard, Laura Busch, and Penelope Sheets. 2010. Comparing digital
divides: Internet access and social inequality in Canada and the United States.
Canadian Journal of Communication 35, 1 (2010).
[24] Qing Huang, Deliang Chang, and Zhou Li. 2020. A Comprehensive Study of
DNS-over-HTTPS Downgrade Attack. In USENIX Workshop on Free and Open
Communications on the Internet.
[25] Geo Huston. 2018. DOH! DNS over HTTPS explained. https://blog.apnic.net/
2018/10/12/doh-dns-over-https-explained/.
[26] IPInfo. 2021. https://ipinfo.io/countries.
[27] Bind9 ISC. 2021. Bind9 Name Server - ISC. https://www.isc.org/bind/
[28] Zhihao Li, Dave Levin, Neil Spring, and Bobby Bhattacharjee. 2018. Internet
anycast: performance, problems, & potential. In ACM Special Interest Group on
Data Communication.
[29] Chaoyi Lu, Baojun Liu, Zhou Li, Shuang Hao, Hai-Xin Duan, Mingming Zhang,
Chunying Leng, Ying Liu, Zaifeng Zhang, and Jianping Wu. 2019. An End-to-End,
Large-Scale Measurement of DNS-over-Encryption: How Far Have We Come?.
In ACM Internet Measurement Conference.
[30] Luminati. 2021. Monetize your active and inactive users by becoming a Bright SDK
partner. https://luminati.io/sdk
[31] Mauro Huc. 2021. How to enable DNS over HTTPS (DoH) on Windows 11.
https://pureinfotech.com/enable-dns-over-https-windows-11/.
[32] Maxmind. 2021. https://www.maxmind.com.
[33] Patrick McManus. 2018.
Firefox Nightly Secure DNS Experimental Re-
sults. https://blog.nightly.mozilla.org/2018/08/28/refox-nightly-secure-dns-
experimental-results/.
[34] Microsoft. 2019. https://techcommunity.microsoft.com/t5/networking-blog/
windows-will-improve-user-privacy-with-dns-over-https/ba-p/1014229.
[35] P. Mockapetris. 1987. Domain names - implementation and specication. RFC
1035. https://doi.org/10.17487/RFC1035
[36] Mozilla. 2020. https://blog.mozilla.org/blog/2020/02/25/refox-continues-push-
to-bring-dns-over-https-by-default-for-us-users/.
[37] NextDNS. 2021. NextDNS. https://nextdns.io/
[38] Morten Meyerho Nielsen, Ibrahim Kholilul Rohman, and Nuno Vasco Lopes.
2018. Empirical Analysis of the Current Digital Divides since 2010. In International
Conference on Theory and Practice of Electronic Governance.
[39] Ookla. 2021. https://www.speedtest.net/global-index.
[40] Quad9. 2018. DoH with Quad9 DNS Servers. https://www.quad9.net/news/blog/
doh-with-quad9-dns-servers/
[41] Lin Quan, John Heidemann, and Yuri Pradkin. 2014. When the Internet Sleeps:
Correlating Diurnal Networks with External Factors. In ACM Internet Measure-
ment Conference.
[42] Eric Rescorla. 2018. The Transport Layer Security (TLS) Protocol Version 1.3.
RFC 8446. https://doi.org/10.17487/RFC8446
[43] RIPE NCC 2021. What is RIPE Atlas? RIPE NCC. https://atlas.ripe.net/about/.
[44] Sandra Siby, Marc Juarez, Claudia Diaz, Narseo Vallina-Rodriguez, and Carmela
Troncoso. 2019. Encrypted DNS –> Privacy? A Trac Analysis Perspective. In
ISOC Network and Distributed Systems Security Conference.
[45] Systemd. 2021. Add support for DNS-over-HTTPS to systemd-resolved. https:
//github.com/systemd/systemd/issues/8639.
[46] TrendMicro. 2018.
Shining a Light on the Risks of HolaVPN and Lumi-
nati. https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-
digital-threats/shining-a-light-on-the-risks-of-holavpn-and-luminati.
[47] Liang Zhu, Zi Hu, John S. Heidemann, Duane Wessels, Allison Mankin, and Nikita
Somaiya. 2015. Connection-Oriented DNS to Improve Privacy and Security. In
IEEE Security and Privacy Symposium.
A ETHICS
Our measurement methodology involves the use of the BrightData
proxy network and RIPEAtlas measurement platform. Below, we
discuss the key ethical aspects related to our experiments. First,
BrightData is a commercial platform. We purchased their services
and strictly followed their Terms of Service when running our exper-
iments. We also had signicant conversations with the BrightData
team about our experiments ahead of time and received explicit
approval from them that we could conduct our measurements on
their platform. Second, the exit nodes of the BrightData network are
364
Google
NextDNS
Resolver
Cloudare
GDP
Bandwidth
Num ASes
Nameserver Dist.
Resolver Dist.
GDP
Bandwidth
Num ASes
Nameserver Dist.
Resolver Dist.
GDP
Bandwidth
Num ASes
Nameserver Dist.
Resolver Dist.
GDP
Bandwidth
Num ASes
Nameserver Dist.
Resolver Dist.
Metric Coef. (ms)
2e-4*
-1.4
-6.3e-2
1.23e-2
9.33-2
-5.18e-5*
-0.95
-5.12e-2
1.54e-2
8.48e-2
-9.66e-4*
-2.32
-7.34e-2
6.48e-3
6.78e-2
-1.05e-3*
-2.1
-3.6e-2
1.1e-2
3.4e-2
Scaled Coef. (ms)
4.14*
-85.3
-85.8
32.7
155.7
-1.07*
-56.8
-69.7
40.87
140.02
-19.9*
-138.3
-99.8
17.2
111.99
-21.6*
-124.1
-49.1
27.8
56.0
Table 6: Linear Modeling of DNS Performance by Resolver—
We show the results of our linear modeling split by each resolver for the delta
between a single DoH request compared to Do53. All results are statistically
signicant with ? < 0.001 unless indicated by an asterisk (*).
Quad9
Figure 8: Clients in Our Dataset—A map showing the clients we
used to conduct our Do53 and DoH measurements. Clients in our dataset
span 22,052 unique IP addresses across 224 total countries and territories.
recruited/enrolled by the platform. The exit nodes and the Bright-
Data platform have agreements to route trac through the exit
nodes (in exchange for free VPN services). Third, our experiments
only involve generating DNS queries to benign DNS resolvers to
query benign domain names (under our control). This experiments
does not introduce any harm to the proxy service or the exit nodes.
We note that we do not ever store raw client IP addresses in our
study. Any geolocation lookups presented in this work are based
on the /24 of the IP address. We do log the IP addresses of the pub-
lic recursive resolvers used to perform DoH queries, however, we
take careful note not to inspect any potentially sensitive client data
(e.g., client IPs present in the ECS-client-subnet DNS extension).
Measuring DNS-over-HTTPS Performance Around the World
IMC ’21, November 2–4, 2021, Virtual Event
(a) Cloudare
(b) Google
(c) NextDNS
(d) Quad9
Figure 9: Per-Client Distance to Servicing DoH PoP—For each resolver, we present the distance for each client to the PoP that was used to perform
the resolution. Providers excel in varying regions. Quad9, for example, assigns PoPs which are relatively close for clients in the southern part of Africa, but
seems to underperform other providers by this metric in southern Brazil and Argentina.
Finally, our use of RIPE Atlas is in line with their terms of ser-
vice and involves just minimal testing for ground truth validation
experiments.
B DATASET
We provide some additional gures characterizing our dataset. Fig-
ure 8 shows a map with all of the Maxmind-located clients we used
in this study (locating them based on their /24). Figure 9 shows
these clients by resolver, coloring them based on the geographic
distance to the DoH resolver point-of-presence they used.
C REGRESSION ANALYSIS
In addition to conducting aggregate regressions, we also compute
linear regressions ltered by each DoH resolver provider. We show
the results in Table 6.
365