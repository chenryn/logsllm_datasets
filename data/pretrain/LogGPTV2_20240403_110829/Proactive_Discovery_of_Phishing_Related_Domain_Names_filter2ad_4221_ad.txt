0
4
0
0
0
6
0
0
0
8
0
0
0
0
0
0
0
0
0
0
0
1
e
+
0
6
m
m
m
m
m
m
m
m
m
m
m
m
m
m
m
m
m
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
2
4
6
8
1
1
1
1
1
2
2
2
2
2
3
3
3
0
2
4
6
8
0
2
4
6
8
0
2
4
Time (in month) after the generation
# of generated domain names
Fig. 7. Distribution of domain discovered
regarding the time they are blacklisted
Fig. 8. Number of domain names discov-
ered regarding the method
• MC + 5/20 DISCO: the Markov chain model and for each selected state of
the Markov chain ﬁve words randomly picked from the twenty most related
words, regarding Disco, are tested.
• MC + 5/50 DISCO: the Markov chain model and for each selected state of
the Markov chain ﬁve words randomly picked from the ﬁfty most related
words, regarding Disco, are tested.
The objective of this assessment is to identify the best tradeoﬀ between the
success rates in discovering rogue domain names with respect to the computa-
tional eﬀort.
Figure 8 shows the number of actual generated malicious domain names
with respect to the number of probes performed over a probing campaign. The
same training set is used to build the generation model for the four diﬀerent
probing campaigns. It clearly comes out that the Markov chain model alone
yields the best results in term of number of malicious domain names discovered
with a total of 370. However even if DISCO strategies are able to generate only
between 57 and 90 malicious domain names over these campaigns depending on
the technique, between 79% and 85% of these generated domains are unique,
i.e. none of the other strategies are able to ﬁnd them. If a global probing is
targeted all the part of the generation module must be used in order to discover
the maximum of phishing related domain names. However, the Markov chain
model is suﬃcient to ﬁnd out domains over a short period of time.
5 Related Work
Because of their essential role, anti-phishing and identiﬁcation of malicious do-
main are increasingly popular and addressed in several previous works. Two
major approaches exist: methods based on blacklists and heuristics-based meth-
ods.
Heuristic-based approaches rely on classiﬁcation algorithms to identify
whether a domain is malicious or not, based on features extracted from dif-
Proactive Discovery of Phishing Related Domain Names
17
ferent sources. The leveraging of machine learning techniques to classify on the
ﬂy, domains as malicious or benign is widely used, with either batch methods
such as SVM, Naive Bayes, Logistic Regression(like in [2–4]), or on-line classiﬁ-
cation algorithms such as Conﬁdence Weighted (CW), Adaptive Regularization
of Weight (AROW), Passive-Aggressive (PA) (see [5, 9, 15]).
Their diﬀerences are mainly related to the feature set. In [2–4], the building
of classiﬁcation models relies on passively gathered DNS queries to ﬁgure out
predominantly malware domains involved in botnet communications. However
for phishing detection purposes, it can be either host-based features (WHOIS
info, IP preﬁx, AS number) in [15] or web page content-based features in [25].
The majority of features are however extracted directly from URLs. These
can be for instance the type of protocol, hostname, TLD, domain length, length
of URL, etc. In [5, 9, 11], the authors particularly focus on the tokens that com-
pose a complete URL, which includes the domain as well as the path and the
query. In these studies, the classiﬁcation is based on the relative position of these
tokens (domain or path level for instance) or the combination of these tokens (to-
ken1.token2/token3/token4?token5=token6 ). The conclusion is that tokens that
occur in phishing URLs belong to a limited dictionary and tend to get reused in
other URLs. Moreover, Garera et al., in [8], are the ﬁrst to use the occurrences
of manually deﬁned words (secure, banking, login, etc.) in URL as features. In
[13], Le et al. use both batch and on-line classiﬁcation techniques to show that
lexical features extracted from URLs are suﬃcient to detect phishing domains.
Even also based on lexical features, our work is diﬀerent as we consider mean-
ingful words that compose the same label of a domain name. Moreover, our work
consists in a predictive and active discovery rather than classiﬁcation of domain
names observed on network traﬃc.
There have been other works taken advantage of URL based lexical analysis
for diﬀerent purposes. In [27], statistical measures are applied to alphanumeric
characters distribution and bigrams distribution in URLs in order to detect
algorithmically generated ﬂuxing domains. The same technique is used in [6]
to detect DNS tunnels and, in [26], Xie et al. generate signature for spamming
URLs using Regular Expressions. URLs related to the same spam campaign are
grouped for creating a signature based on regular expression.
This work is close to our approach but only lead to disclose domain names
related to a speciﬁc spam campaign from which some domain names have been
already observed. Our approach is more general and allows discovering new
phishing domains that have no apparent relations with previous ones.
Blacklisting approaches consist in the partially manual construction of a
list of malicious URLs that will be used by web browser or e-mail client in
order to prevent the users to access them. Due to their short lifetime, the early
identiﬁcation of phishing websites is paramount, as a result several methods
have been proposed to avoid reactive blacklisting and develop more proactive
methods. In [10], Hao et al. analyze early DNS behavior of newly registered
domains. It is demonstrated that they are characterized by DNS infrastructure
pattern and DNS lookup patterns monitored as soon as they are registered, such
18
Samuel Marchal, J´erˆome Fran¸cois, Radu State, and Thomas Engel
as either a wide scattering of resource records across the IP address space in
only few regions, or resource records that are often hosted in tainted autonomous
systems. A very close approach is used in [7] to build proactive domain blacklists.
Assuming a known malicious domain, zone information is mined to check if other
domains are registered at the same time, on the same name server and on the
same registrar. However, this approach cannot be widely applied because domain
zone information is not always available and needs a prior knowledge.
Predictive blacklisting is also addressed in [28] where it’s assumed that a host
should be able to predict future attackers from the mining of its logs. Hence,
a host can create its own customized blacklist well ﬁtted to its own threats.
The composition of this blacklist relies also on other machines’ logs that are
considered as similar. This similarity score is calculated using the number of
common attackers between two victims and stored into a graph explored using a
PageRank algorithm to estimate whether a domain is likely to conduct an attack
against a particular victim or not. The similarity calculation is reﬁned in[23].
Another proactive blacklisting approach to detect phishing domains is ad-
dressed through Phishnet in [20]. This work is the closest to ours, the idea is
to discover new phishing URLs based on blacklist of existing phishing URLs.
As in [26], URLs are clustered based on their shared common domain names,
IP addresses or directory structures, then a regular expression is extracted from
each cluster. The variable part of regular expression is exploited to generate new
URLs instead of only compare existing URLs to extracted patterns like in [26].
Though this method is more proactive than the previous ones, it is only able
to disclose URLs related to already blacklisted URLs that are likely to belong
to the same phishing attack. Whereas these URLs are part of a very small pool
of domains, our approach is capable to extend the knowledge about distinct
phishing attacks. Therefore these approaches are quite complementary.
Finally we have already treated and proved the eﬃcacy of algorithmic domain
generation based on Markov chain in [24]. We apply this technique on bigrams
in order to perform a discovery of all the subdomains (www, mail, ftp) of a given
domain (example.com). We extend this approach in [16], based on an existing
list of subdomains, we leverage semantic tools and incremental techniques to
discover more subdomains.
6 Conclusion and future work
This paper introduces an eﬃcient monitoring scheme for detecting phishing sites.
The main idea consists in generating a list of potential domain names that might
be used in the future by an attacker. This list can be checked on a daily basis to
detect the apparition of a new phishing site. The list is generated using language
models applied to known ground truth data. We have proposed a novel technique
to generate domain names following a given pattern that can be learned from
existing domain names. This domain generation leverages a Markov chain model
and relevant lexical features extracted from a semantic splitter. Domain speciﬁc
knowledge is added from semantic tools. The eﬃciency of this generation tool is
Proactive Discovery of Phishing Related Domain Names
19
tested on the real world datasets of phishing domain names. We proved that our
method is able to generate hundreds of new domain names that are actually re-
lated to phishing and appear to be in use in the period following their generation.
To the best of our knowledge, our approach is the only one to propose proactive
generation and discovery of malicious domains, which is complementary to state
of the art approaches that addressed proactive blacklisting of URLs.
In future works, the remaining part of the architecture, the domain checker,
will be implemented shortly. Furthermore, the feedback from this checker will
be used to adapt the Markov chain transition probability through reinforcement
learning in order to strengthen the generation model. The code is available on
request.
Acknowledgements. This work is partly funded by OUTSMART, a European
FP7 project under the Future Internet Private Public Partnership programme.
It is also supported by MOVE, a CORE project funded by FNR in Luxembourg.
The authors would like to thank P. Bedaride for discussions and advice on natural
language processing tools.
References
1. Anti-Phishing Working Group and others: Phishing Activity Trends Report -
1H2011. Anti-Phishing Working Group (2011)
2. Antonakakis, M., Perdisci, R., Dagon, D., Lee, W., Feamster, N.: Building a dy-
namic reputation system for dns. In: Proceedings of the 19th USENIX conference
on Security. pp. 18–18. USENIX Security’10, USENIX Association, Berkeley, CA,
USA (2010)
3. Antonakakis, M., Perdisci, R., Lee, W., Vasiloglou, II, N., Dagon, D.: Detecting
malware domains at the upper dns hierarchy. In: Proceedings of the 20th USENIX
conference on Security. pp. 27–27. SEC’11, USENIX Association, Berkeley, CA,
USA (2011)
4. Bilge, L., Kirda, E., Kruegel, C., Balduzz, M.: EXPOSURE: Finding Malicious
Domains Using Passive DNS Analysis. In: NDSS 2011. Internet Society (Feb 2011)
5. Blum, A., Wardman, B., Solorio, T., Warner, G.: Lexical feature based phishing
url detection using online learning. In: Proceedings of the 3rd ACM workshop on
Artiﬁcial Intelligence and Security. pp. 54–60. ACM (2010)
6. Born, K., Gustafson, D.: Detecting dns tunnels using character frequency analysis.
Arxiv preprint arXiv:1004.4358 (2010)
7. Felegyhazi, M., Kreibich, C., Paxson, V.: On the potential of proactive domain
blacklisting. In: Proceedings of the 3rd USENIX conference on Large-scale exploits
and emergent threats: botnets, spyware, worms, and more. pp. 6–6. USENIX As-
sociation (2010)
8. Garera, S., Provos, N., Chew, M., Rubin, A.: A framework for detection and mea-
surement of phishing attacks. In: Proceedings of the 2007 ACM workshop on Re-
curring malcode. pp. 1–8. ACM (2007)
9. Gyawali, B., Solorio, T., Wardman, B., Warner, G., et al.: Evaluating a semisuper-
vised approach to phishing url identiﬁcation in a realistic scenario. In: Proceedings
of the 8th Annual Collaboration, Electronic messaging, Anti-Abuse and Spam Con-
ference. pp. 176–183. ACM (2011)
20
Samuel Marchal, J´erˆome Fran¸cois, Radu State, and Thomas Engel
10. Hao, S., Feamster, N., Pandrangi, R.: Monitoring the initial DNS behavior of ma-
licious domains. In: Proceedings of the ACM SIGCOMM Internet Measurement
Conference. pp. 269–278. IMC ’11, ACM, New York, NY, USA (Nov 2011)
11. Khonji, M., Iraqi, Y., Jones, A.: Lexical url analysis for discriminating phishing and
legitimate websites. In: Proceedings of the 8th Annual Collaboration, Electronic
messaging, Anti-Abuse and Spam Conference. pp. 109–115. ACM (2011)
12. Kolb, P.: DISCO: A Multilingual Database of Distributionally Similar Words. In:
Storrer, A., Geyken, A., Siebert, A., W¨urzner, K.M. (eds.) KONVENS 2008 –
Erg¨anzungsband: Textressourcen und lexikalisches Wissen. pp. 37–44 (2008)
13. Le, A., Markopoulou, A., Faloutsos, M.: Phishdef: Url names say it all. In: INFO-
COM, 2011 Proceedings IEEE. pp. 191–195. IEEE (2011)
14. Ludl, C., Mcallister, S., Kirda, E., Kruegel, C.: On the eﬀectiveness of techniques
to detect phishing sites. In: Proceedings of the 4th international conference on
Detection of Intrusions and Malware, and Vulnerability Assessment. pp. 20–39.
DIMVA ’07 (2007)
15. Ma, J., Saul, L., Savage, S., Voelker, G.: Identifying suspicious urls: an application
of large-scale online learning. In: Proceedings of the 26th Annual International
Conference on Machine Learning. pp. 681–688. ACM (2009)
16. Marchal, S., Fran¸cois, J., Wagner, C., Engel, T.: Semantic exploration of DNS. In:
IFIP/TC6 Networking 2012. Prague - Czech Republic (may 2012)
17. Mockapetris, P.: Rfc 1035: Domain names - implementation and speciﬁcation
18. Mockapetris, P.: Rfc 1034: Domain names - concepts and facilities (1987)
19. Mockapetris, P., Dunlap, K.: Development of the domain name system. In: Pro-
ceedings of the 1988 ACM SIGCOMM. pp. 123–133. IEEE Computer Society,
Stanford, CA, USA (1988)
20. Prakash, P., Kumar, M., Kompella, R., Gupta, M.: Phishnet: predictive blacklisting
to detect phishing attacks. In: INFOCOM, 2010 Proceedings IEEE. pp. 1–5. IEEE
(2010)
21. Rasmussen, R., Aaron, G.: Global phishing survey: trends and domain name use
in 1h2011. Anti-Phishing Working Group (2011)
22. Segaran, T., Hammerbacher, J.: Beautiful Data: The Stories Behind Elegant Data
Solutions, chap. 14. O’Reilly Media (2009)
23. Soldo, F., Le, A., Markopoulou, A.: Predictive blacklisting as an implicit recom-
mendation system. In: INFOCOM, 2010 Proceedings IEEE. pp. 1–9. IEEE (2010)
24. Wagner, C., Fran¸cois, J., State, R., Engel, T., Dulaunoy, A., Wagener, G.: SDBF:
Smart DNS Brute-Forcer. In: Proceedings of IEEE/IFIP Network Operations and
Management Symposium - NOMS. IEEE Computer Society (2012)
25. Xiang, G., Hong, J.: A hybrid phish detection approach by identity discovery and
keywords retrieval. In: Proceedings of the 18th international conference on World
wide web. pp. 571–580. ACM (2009)
26. Xie, Y., Yu, F., Achan, K., Panigrahy, R., Hulten, G., Osipkov, I.: Spamming
botnets: signatures and characteristics. In: ACM SIGCOMM Computer Commu-
nication Review. vol. 38, pp. 171–182. ACM (2008)
27. Yadav, S., Reddy, A.K.K., Reddy, AL, Ranjan, S.: Detecting algorithmically gen-
erated malicious domain names. In: Proceedings of the 10th annual conference on
Internet measurement. pp. 48–61. ACM (2010)
28. Zhang, J., Porras, P., Ullrich, J.: Highly predictive blacklisting. In: Proceedings
of the 17th conference on Security symposium. pp. 107–122. USENIX Association
(2008)