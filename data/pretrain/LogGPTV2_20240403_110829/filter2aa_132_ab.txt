12
在界⾯上添加所有Beacon和在线Beacon元素 
原版: 
修改版: 
●
13
修改内容: 
修改Logo图⽚ 
修改creds.txt⾥的致谢信息，并⽤bUTF8String函数加载 
原版: 
修改版: 
aggressor/dialogs/AboutDialog.class 
●
●
14
修改内容: 
修改连接TeamServer窗⼝的标题信息 
修改新建连接Profile界⾯的提示标题信息和默认的账号、密码、端⼝ 
删除HostNames、Alias Names按钮，增加Readme.md按钮 
原版: 
aggressor/dialogs/ConnectDialog.class 
●
●
●
15
修改版: 
16
修改内容: ⽆任何修改，编译器编译差异导致 
修改内容: ⽆任何修改，编译器编译差异导致 
修改内容: ⽆任何修改，编译器编译差异导致 
修改内容: 新增whoami、cat命令 
aggressor/headless/Start.class 
aggressor/MultiFrame.class 
aggressor/TabManager.class 
aggressor/windows/BeaconConsole.class 
17
原版：
修改版：
修改内容: 删除暗桩 
原版: 
aggressor/windows/CredentialManager.class 
18
修改版: 
修改内容: 修改下载⽂件管理⻚⾯的显示元素的顺序。 
原版: 
修改版: 
修改内容: ⽆任何修改，编译器编译差异导致 
修改内容: ⽆任何修改，编译器编译差异导致 
aggressor/windows/DownloadBrowser.class 
aggressor/windows/FileBrowser.class 
aggressor/windows/Files.class 
19
修改内容: 删除暗桩。 
原版: 
修改版: 
修改内容:  删除暗桩。 
原版: 
修改版: 
aggressor/windows/KeystrokeBrowser.class 
aggressor/windows/ScreenshotBrowser.class 
20
修改内容:  新增Cat命令 
原版: 
修改版: 
aggressor/windows/SecureShellConsole.class 
beacon/BeaconC2.class 
21
修改内容:  删除⽂件完整性检测。 
原版: 
修改版: 
修改内容:  修改shouldPad属性为false 
原版: 
beacon/BeaconData.class 
22
修改版: 
修改内容:  删除了NULL jitter task的构造函数 
原版: 
beacon/BeaconHTTP.class 
23
修改版: 
修改内容: 修改配置信息的异或密钥 
原版: 
beacon/BeaconPayload.class 
24
修改版: 
修改内容:  编译器差异，⽆变化。 
修改内容:  
删除暗桩
修改命令⽣成逻辑
原版: 
beacon/BeaconSetup.class 
beacon/CommandBuilder.class 
●
●
25
修改版: 
beacon/jobs/DesktopJob.class 
26
修改内容:  编译器差异，⽆变化。 
修改内容: 
修改Desktop、Hashdump、Screenshot、Logonpasswords的注⼊⾏为，由spawn改为注⼊⾃身所
在进程，绕过360核晶 
新增whoami、cat命令处理函数 
原版: 
beacon/TaskBeacon.class 
●
●
27
修改版: 
28
修改内容:  新增cat命令的命令执⾏处理回调 
修改版:  
beacon/TaskBeaconCallback.class 
29
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:   编译器差异，没有变化。 
修改内容:  删除CS HTTP server this.sendError默认返回的状态提示信息。 
原版: 
beacon/Tasks.class 
c2profile/MalleableHook.class 
c2profile/MalleableStager.class 
cloudstrike/NanoHTTPD.class 
30
修改版: 
修改内容:  
修改URI checksum8编码的值 
patch 信息泄露漏洞CVE-2022-23317 
原版: 
cloudstrike/WebServer.class  
●
●
31
修改版:  
修改内容:   编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容: 静态patch验证信息，设置解密密钥，完成破解。 
原版: 
common/AssertUtils.class 
common/AuthCrypto.class 
common/Authorization.class 
32
修改版: 
修改内容:   编译器差异，没有变化。 
common/BeaconEntry.class 
33
修改内容:   
新增bUTF8String函数 
修改从resource当中读取cobaltstrike.auth 
原版: 
修改版: 
修改内容:   编译器差异，没有变化。 
common/CommonUtils.class 
●
●
common/Download.class 
common/Helper.class 
34
修改内容:   删除⽂件完整性校验代码。 
原版: 
修改版: 
修改内容:   编译器差异，没有变化。 
修改内容:  删除添加反病毒特征代码。 
原版: 
common/License.class 
common/ListenerConfig.class 
35
修改版: 
修改内容:  修改beacon初始回连时，在eventconsole界⾯显示的信息。 
原版: 
修改版: 
common/LoggedEvent.class 
36
修改内容:   
修改读取beacon返回数据错误提示信息 
修改授权信息
取消返回数据10240⻓度的限制 
原版: 
common/MudgeSanity.class 
●
●
●
37
修改版: 
38
39
修改内容:  删除判断系统启动环境。 
原版: 
修改版: 
common/Requirements.class 
40
修改内容: 删除⽂件完整性校验不通过退出的暗桩。 
原版: 
修改版: 
修改内容:   删除⽂件完整性校验不通过退出的暗桩。 
原版: 
common/Starter.class 
common/Starter2.class 
41
修改版: 
修改内容: 未完成开发的代码，没有什么实质性作⽤。 
修改内容: 编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容: 编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容: 
common/TeamSocket.class 
dns/AsymmetricCrypto.class 
dns/BaseSecurity.class 
server/Beacons.class 
server/Listeners.class 
server/ManageUser.class 
42
新增getResources⽅法 
修改winvnc dll的路径 
原版: 
修改版: 
修改内容: 
删除⽂件完整性校验暗桩
新增getTranscripts⽅法 
原版: 
●
●
server/Resources.class 
●
●
43
修改版: 
修改内容:   编译器差异，没有变化。 
修改内容: 删除⽂件完整性校验暗桩。 
原版: 
修改版: 
修改内容:  修改TeamServer登录时服务端校验的头标志位。 
原版: 
server/ServerUtils.class 
server/TeamServer.class 
ssl/SecureServerSocket.class 
44
修改版: 
修改内容:  修改TeamServer登录时客户端发送的校验头标志位。 
原版: 
修改版: 
修改内容:  编译器差异，没有变化。 
ssl/SecureSocket.class 
stagers/BeaconBindStagerX64.class 
stagers/BeaconBindStagerX86.class 
45
修改内容:   编译器差异，没有变化。 
修改内容:   编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:   编译器差异，没有变化。 
修改内容:   修改URI的结果为DogCsDogCs.js。 
原版: 
stagers/BeaconDNSStagerX86.class 
stagers/BeaconHTTPSStagerX64.class 
stagers/BeaconHTTPSStagerX86.class 
stagers/BeaconHTTPStagerX64.class 
stagers/BeaconHTTPStagerX86.class 
stagers/BeaconPipeStagerX86.class 
stagers/ForeignHTTPSStagerX86.class 
46
修改版: 
修改内容:  修改URI的结果为DogCsDogCs.js。 
原版: 
修改版: 
修改内容:  编译器差异，没有变化。 
stagers/ForeignHTTPStagerX86.class 
stagers/ForeignReverseStagerX64.class 
47
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
修改内容:  编译器差异，没有变化。 
stagers/ForeignReverseStagerX86.class 
stagers/GenericBindStager.class 
stagers/GenericDNSStagerX86.class 
stagers/GenericHTTPSStagerX64.class 
stagers/GenericHTTPSStagerX86.class 
stagers/GenericHTTPStager.class 
stagers/GenericHTTPStagerX64.class 
stagers/GenericHTTPStagerX86.class 
stagers/GenericStager.class 
stagers/Stagers.class 
48
修改内容:  编译器差异，没有变化。 
该DLL与外部third-party⽬录下的vnc dll相同。 
该DLL与外部third-party⽬录下的vnc dll相同。 
bypass beaconEye 
修改XOR key 
同beacon.dll。 
同beacon.dll。 
DLL端 
resources/winvnc.x64.dll
resources/winvnc.x86.dll
sleeve/beacon.dll 
●
●
sleeve/beacon.x64.dll 
sleeve/dnsb.dll 
49
同beacon.dll。 
同beacon.dll。 
同beacon.dll。 
修改动态加载的⽬的函数，从CorExitProcess改为CorExitThread 
修改导⼊表ExitProcess为ExitThread 
sleeve/dnsb.x64.dll 
sleeve/extc2.dll 
sleeve/extc2.x64.dll 
sleeve/hashdump.dll 
●
●
50
51
同hashdump.dll。 
同hashdump.dll。 
同hashdump.dll。 
sleeve/hashdump.x64.dll 
sleeve/mimikatz-chrome.x64.dll 
sleeve/mimikatz-chrome.x86.dll 
sleeve/mimikatz-full.x64.dll 
52
同hashdump.dll。 
同hashdump.dll。 
同hashdump.dll。 
同hashdump.dll。 
同beacon.dll。 
同beacon.dll。 
同hashdump.dll。 
同hashdump.dll。 
修改内容:  修改原来的致谢信息，改为⾃⼰定义的修改的特性列表。 
原版: 
sleeve/mimikatz-full.x86.dll 
sleeve/mimikatz-min.x64.dll 
sleeve/mimikatz-min.x86.dll 
sleeve/pivot.dll 
sleeve/pivot.x64.dll 
sleeve/screenshot.dll 
sleeve/screenshot.x64.dll 
其他
resources/credits.txt 
53
修改版: 
修改内容:  修改默认CS⽣成Stager、Beacon的UA头，改为⾃定义UA头 
原版: 
修改版: 
resources/ua.txt 
54
修改内容:  新增FindAv插件 
原版: 
修改版: 
scripts/default.cna 
55