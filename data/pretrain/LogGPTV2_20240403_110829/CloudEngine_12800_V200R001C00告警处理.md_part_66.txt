参数名称 参数含义
RemoteAddr MSDP对等体地址。
PeerState MSDP对等体的状态。
InstanceName 实例名称。
文档版本 06 (2017-09-12) 华为专有和保密信息 525
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 36 MSDP
参数名称 参数含义
ExitReason 告警原因。
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.3.92.1.1.5.1.3 msdpPeerState msdpPeerRemoteAddress
对系统的影响
MSDP邻居连接中断或建连失败，路由不可达，MSDP转发业务中断。
可能原因
原因1：HoldTime expired.（MSDP对等体的HoldTime定时器超时。）
原因2：Socket error.（Socket错误。）
原因3：Receive invalid TLV.（收到无效TLV。）
原因4：Receive notification TLV.（收到告警TLV。）
原因5：User operation.（用户操作。）
处理步骤
l 原因1：HoldTime expired.
a. 使用命令ping检查和对等体之间的链路是否连通。
n 如果连通，则请执行步骤3。
n 如果不连通，则请执行步骤2。
b. 使用命令display ip routing-table检查到对等体的单播路由是否正常。
n 如果路由正常，则请执行步骤3。
n 如果路由不正常，可排除单播路由故障来解决告警问题。
c. 在对等体的MSDP视图下使用display msdp peer-status命令检查对等体的状
态，即State字段。
n 如果状态为Up，则请执行步骤4。
n 如果状态为Shutdown，则说明MSDP对等体处于Shutdown状态，可在对
等体的MSDP视图下执行undo shutdown命令解决告警问题。
n 如果状态为Down，可检查Connect interface字段，建立TCP连接的接口地
址是否正确。
○ 如果正确，则请执行步骤4。
○ 如果不正确，可在MSDP视图下执行peer peer-address connect-
interface interface-type interface-number命令配置正确的接口地址来
解决告警问题。
文档版本 06 (2017-09-12) 华为专有和保密信息 526
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 36 MSDP
n 如果为其他状态，检查对等体两端的MSDP认证配置是否相同。
○ 如果相同，则请执行步骤4。
○ 如果不相同，可为对等体两端配置相同的MSDP认证来解决告警问
题。
d. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因2：Socket error.
a. 使用命令ping检查和对等体之间的链路是否连通。
n 如果连通，则请执行步骤3。
n 如果不连通，则请执行步骤2。
b. 使用命令display ip routing-table检查到对等体的单播路由是否正常。
n 如果路由正常，则请执行步骤3。
n 如果路由不正常，可排除单播路由故障来解决告警问题。
c. 使用命令display current-configuration检查对等体两端是否使能组播。
n 如果使能了组播，则请执行步骤4。
n 如果未使能组播，可执行multicast routing-enable命令使能组播解决告警
问题。
d. 在MSDP视图下使用命令display this检查是否配置了MSDP对等体。
n 如果配置了MSDP对等体，则请执行步骤5。
n 如果未配置MSDP对等体，可在MSDP视图下执行peer peer-address
connect-interface interface-type interface-number命令配置MSDP对等体解
决告警问题。
e. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因3：Receive invalid TLV.
a. 可能由于对等体两端的设备对MSDP协议的实现不一致。请收集告警信息、日
志信息和配置信息，并联系技术支持人员。
l 原因4：Receive notification TLV.
a. 确认对端设备是否执行了用户视图下的reset msdp peer命令。
n 如果执行了，则等待对等体重新建立即可。
n 如果未执行，则请执行步骤2。
b. 在对端设备的MSDP视图下执行命令display this检查是否配置了MSDP对等
体。
n 如果配置了，则请执行步骤3。
n 如果未配置，可在MSDP视图下执行peer peer-address connect-interface
interface-type interface-number命令配置MSDP对等体解决告警问题。
c. 使用命令display interface brief命令检查对等体接口是否配置了shutdown命
令。
n 如果配置了，可在接口视图下执行undo shutdown命令解决告警问题。
n 如果未配置，则请执行步骤4。
d. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因5：User operation.
a. 确认用户是否执行了用户视图下的reset msdp peer命令。
n 如果执行了，则等待对等体重新建立即可。
文档版本 06 (2017-09-12) 华为专有和保密信息 527
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 36 MSDP
n 如果未执行，则请执行步骤2。
b. 在MSDP视图下使用命令display this检查是否配置了MSDP对等体。
n 如果配置了，则请执行步骤3。
n 如果未配置，可在MSDP视图下执行peer peer-address connect-interface
interface-type interface-number命令配置MSDP对等体解决告警问题。
c. 使用命令display interface brief命令检查接口是否配置了shutdown命令。
n 如果配置了，可在接口视图下执行undo shutdown命令解决告警问题。
n 如果未配置，则请执行步骤4。
d. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 528
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
37
MSTP
关于本章
37.1 MSTP_1.3.6.1.2.1.17.0.1 newRoot
37.2 MSTP_1.3.6.1.2.1.17.0.2 topologyChange
37.3 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.1 hwMstpiPortStateForwarding
37.4 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.2 hwMstpiPortStateDiscarding
37.5 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.3 hwMstpiBridgeLostRootPrimary
37.6 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.4 hwMstpiPortRootGuarded
37.7 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.5 hwMstpiPortBpduGuarded
37.8 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.6 hwMstpiPortLoopGuarded
37.9 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.7 hwMstpiEdgePortChanged
37.10 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.15 hwMstpiTcGuarded
37.11 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.16 hwMstpProTcGuarded
37.12 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.17 hwMstpProRootChanged
37.13 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.18 hwMstpProNewPortStateForwarding
37.14 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.19 hwMstpProNewPortStateDiscarding
37.15 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.20 hwMstpProNewBridgeLostRootPrimary
37.16 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.21 hwMstpProNewPortRootGuarded
37.17 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.22 hwMstpProNewPortBpduGuarded
37.18 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.23 hwMstpProNewPortLoopGuarded
37.19 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.24 hwMstpProNewEdgePortChanged
37.20 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.25 hwMstpProLoopbackDetected
文档版本 06 (2017-09-12) 华为专有和保密信息 529
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
相关主题
HUAWEI-MSTP-MIB
文档版本 06 (2017-09-12) 华为专有和保密信息 530
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
37.1 MSTP_1.3.6.1.2.1.17.0.1 newRoot
Trap Buffer 信息解释
This bridge changed to be the root bridge.
生成树协议计算后，本桥选举成为拓扑中新的根桥。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Critical
Mnemonic Code newRoot
Trap OID 1.3.6.1.2.1.17.0.1
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
无
VB 信息参数
VB OID VB Name VB Index
None None None
对系统的影响
引起拓扑流量改变，有可能会引起流量丢失。
可能原因
原因1：The local bridge is added into a new network topology.（本桥新加入一个网络拓
扑。）
原因2：The priority of the local bridge is increased.（本桥的优先级被提高。）
原因3：The root bridge in the original topology is faulty.（原有拓扑中的根桥故障。）
文档版本 06 (2017-09-12) 华为专有和保密信息 531
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
原因4：The priority of the root bridge in the original topology is reduced.（原有拓扑根桥的
优先级被降低。）
处理步骤
l 原因1：The local bridge is added into a new network topology.
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看本桥的优先级是否是网络中最小
的。
n 如果是，则请执行步骤2。
n 如果不是，则请执行步骤3。
b. 请检查本桥是否被规划为二层网络拓扑中的根桥。
n 如果是，则无需处理。
n 如果不是，则请执行步骤3。
c. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实
际需要重新配置本桥的优先级。或者执行命令undo stp [ instance instance-id ]
priority将本桥优先级还原成缺省值。
l 原因2：The priority of the local bridge is increased.
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看本桥的优先级是否是网络中最小
的。
n 如果是，则请执行步骤2。
n 如果不是，则请执行步骤3。
b. 请检查本桥是否被规划为二层网络拓扑中的根桥。
n 如果是，则无需处理。
n 如果不是，则请执行步骤3。
c. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实
际需要重新配置本桥的优先级。或者执行命令undo stp [ instance instance-id ]
priority将本桥优先级还原成缺省值。
l 原因3：The root bridge in the original topology is faulty.
a. 请正确修复原有网络拓扑中存在的故障，查看根桥是否恢复。
n 如果是，则无需处理。
n 如果不是，则请执行步骤2。
b. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因4：The priority of the root bridge in the original topology is reduced.
a. 请在原根桥设备上执行命令stp [ instance instance-id ] priority priority或者stp
[ instance instance-id ] root primary重新指定原根桥为根桥。查看问题是否解
决，如果未解决，则请执行步骤2。
b. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
37.2 MSTP_1.3.6.1.2.1.17.0.2 topologyChange
文档版本 06 (2017-09-12) 华为专有和保密信息 532
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
Trap Buffer 信息解释
Bridge topology changed.
生成树协议计算出的拓扑发生改变。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Alert
Mnemonic Code topologyChange
Trap OID 1.3.6.1.2.1.17.0.2
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
无
VB 信息参数
VB OID VB Name VB Index
None None None
对系统的影响
拓扑改变，有可能会引起流量丢失。
可能原因
原因1：The network topology changes because a new link is added into the network
topology.（网络拓扑发生变化，有新的链路加入。）
原因2：The network topology changes because interfaces go Up or Down.（网络拓扑发生
变化，有端口Up/Down。）
原因3：A fault occurs on the network.（网络拓扑发生故障。）
文档版本 06 (2017-09-12) 华为专有和保密信息 533
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
处理步骤
l 原因1：The network topology changes because a new link is added into the network
topology.
a. 请检查新加入的物理链路是否是需要的物理链路。
n 如果是，则请执行步骤2。
n 如果不是，则请执行步骤3。
b. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看各个端口是否符合协议计算结
果。
n 如果是，则告警消除。
n 如果不是，则请执行步骤3。
c. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因2：The network topology changes because interfaces go Up or Down.（网络拓扑
发生变化，有端口Up/Down。）
a. 请在接口视图下执行命令undo shutdown，重新打开端口。查看问题是否解
决，如果未解决，请执行步骤2。
b. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因3：A fault occurs on the network.（网络拓扑发生故障。）
a. 请正确修复网络拓扑中存在的故障。如果故障无法排除，请执行步骤2。
b. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
37.3 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.1
hwMstpiPortStateForwarding
Trap Buffer 信息解释
The port has been set to forwarding state. (InstanceID=[INTEGER], PortIndex=[INTEGER],
IfIndex=[INTEGER], PortName=[STRING], PwName=[PwName])
端口进入转发状态。
Trap 属性
Trap属性 描述
Alarm or Event Event