0
1
0
0
100
200
300
400
100
200
300
400
0
100
200
300
400
e_NetP
Estimator
e_NetO
100
200
300
400
Estimator
Fig. 4. Histograms vs. est. density (red dashes) and Q-Q plots, for both ˆfO and ˆfP
we have enough statistical evidence for refusing H1 and accepting the null one.
Symmetrically, refusing the null hypothesis of the second test means that the
N etO alert stream (regarding to all hosts but pascal) is correlated to the alert
stream regarding pascal.
Note that, the above two tests are strongly related to each other: in an
ideal correlation framework, it cannot happen that both “N etP is correlated
to HostP ” and “N etO is correlated to HostP ”: this would imply that the net-
work activity regarding to all hosts but pascal (which raises N etO) has to do
with the host activity of pascal (which raises HostP ) with the same order of
magnitude of N etP , that is an intuitively contradictory conclusion. Therefore,
the second test acts as a sort of “robustness” criterion.
From our alerts, we can compute a sample of εN etP by simply picking, for
each value in N etP , the value in HostP which is closest, but greater (applying
a threshold as deﬁned above). We can do the same for εN etO, using the alerts in
N etO and HostP .
The next step involves the choice of the distributions of the random variables
we deﬁned above. Typical distributions used for modeling random occurrences
of timed events fall into the family of exponential Probability Density Functions
(PDF)s [13]. In particular, we decided to ﬁt them with Gamma PDFs, because
our experiments show that such a distribution is a good choice for both the
εN etP and εN etO.
The estimation of the PDF of εN etP , fP := fεN etP , and εN etO, fO := fεN etO,
is performed using the well known Maximum Likelihood (ML) technique [18]
as implemented in the GNU R software package: the results are summarized in
Fig. 4. fP and fO are approximated by Gamma[3.0606, 0.0178] and Gamma
[1.6301, 0.0105], respectively (standard errors on parameters are 0.7080, 0.0045
for fP and 0.1288, 0.009 for fO). From now on, the estimator of a given density
f will be indicated as ˆf.
Fig. 4 shows histograms vs. estimated density (red, dashed line) and quantile-
quantile plots (Q-Q plots), for both ˆfO and ˆfP . We recall that Q-Q plots are
an intuitive graphical “tool” for comparing data distributions by plotting the
quantile of the ﬁrst distribution against the quantile of the other one.
Considering that the samples sizes of ε(·) are around 40, Q-Q plots empirically
conﬁrms our intuition: in fact, ˆfO and ˆfP are both able to explain real data
well, within inevitable but negligible estimation errors. Even if ˆfP and ˆfO are
both Gamma-shaped, it must be noticed that they signiﬁcantly diﬀer in their
174
F. Maggi and S. Zanero
HostP − NetP
HostP − NetO
y
t
i
s
n
e
D
6
0
.
0
4
0
.
0
2
0
.
0
0
0
0
.
y
t
i
s
n
e
D
6
0
.
0
4
0
.
0
2
0
.
0
0
0
0
.
10
20
30
40
50
0
10
20
30
40
50
60
e_NetP
e_NetO
Fig. 5. Histograms vs. est. density (red dashes) for both ˆfO and ˆfP (IDEVAL 1998)
parametrization; this is a very important result since it allows to set up a proper
criterion to decide whether or not εN etP and εN etO are generated by the same
phenomenon.
Given the above estimators, a more precise and robust hypotheses test can
be now designed. The Test 1 and 2 can be mapped into two-sided Kolmogorov-
Smirnov (KS) tests [13], achieving the same result in terms of decisions:
H0 : εN etP ∼ fP vs. H1 : εN etP (cid:2)∼ fP
H0 : εN etO ∼ fO vs. H1 : εN etO (cid:2)∼ fO
(3)
(4)
where the symbol ∼ means “has the same distribution of”. Since we do not know
the real PDFs, estimators are used in their stead. We recall that the KS-test is
a non-parametric test to compare a sample (or a PDF) against a PDF (or a
sample) to check how much they diﬀers from each other (or how much they
ﬁt). Such tests can be performed, for instance, with ks.test() (a GNU R native
procedure): resulting p-values on IDEVAL 1999 are 0.83 and 0.03, respectively.
Noticeably, there is a signiﬁcant statistical evidence to accept the null hypoth-
esis of Test 3. It seems that the ML estimation is capable of correctly ﬁtting a
Gamma PDF for fP (given εN etP samples), which double-checks our intuition
about the distribution. The same does not hold for fO: in fact, it cannot be
correctly estimated, with a Gamma PDF, from εN etO. The low p-value for Test
4 conﬁrms that the distribution of εN etO delays is completely diﬀerent than the
one of εN etP . Therefore, our criterion doest not only recognize noisy delay-based
relationships among alerts stream if they exists; it is also capable of detecting if
such a correlation does not hold.
We also tested our technique on alerts generated by our NIDS/HIDS running
on IDEVAL 1998 (limiting our analysis to the ﬁrst four days of the ﬁrst week),
in order to cross-validate the above results. We prepared and processed the
data with the same procedures we described above for the 1999 dataset. Start-
ing from almost the same proportion of host/net alerts against either pascal
or other hosts, the ML-estimation has computed the two Gamma densities
shown in Fig. 5: fP and fO are approximated by Gamma(3.5127, 0.1478) and
Gamma(1.3747, 0.0618), respectively (standard errors on estimated parameters
On the Use of Diﬀerent Statistical Tests for Alert Correlation
175
are 1.3173, 0.0596 for fP and 0.1265, 0.0068 for fO). These parameter are very
similar to the ones we estimated for the IDEVAL 1999 dataset. Furthermore,
with p-values of 0.51 and 0.09, the two KS tests conﬁrm the same statistical
discrepancies we observed on the 1999 dataset.
The above numerical results show that, by interpreting alert streams as ran-
dom processes, there are several (stochastic) dissimilarities between net-to-host
delays belonging to the same net-host attack session, and net-to-host delays be-
longing to diﬀerent sessions. Exploiting these dissimilarities, we may ﬁnd out
the correlation among streams in an unsupervised manner, without the need to
predeﬁne any parameter.
6 Conclusions
In this paper we analyzed the use of of diﬀerent types of statistical tests for the
correlation of anomaly detection alerts, a problem which has little or no solu-
tions available today. One of the few correlation proposals that can be applied
to anomaly detection is the use of a Granger Causality Test (GCT). After dis-
cussing a possible testing methodology, we observed that the IDEVAL datasets
traditionally used for evaluation have various shortcomings, that we partially
addressed by using the data for a simpler scenario of correlation, investigating
only the link between a stream of host-based alerts for a speciﬁc host, and the
corresponding stream of alerts from a network based detector.
We examined the usage of a GCT as proposed in earlier works, showing that it
relies on the choice of non-obvious conﬁguration parameters which signiﬁcantly
aﬀect the ﬁnal result. We also showed that one of these parameters (the order
of the models) is absolutely critical, but cannot be uniquely estimated for a
given system. Instead of the GCT, we proposed a simpler statistical model of
alert generation, describing alert streams and timestamps as stochastic variables,
and showed that statistical tests can be used to create a reasonable criterion for
distinguishing correlated and non correlated streams. We proved that our criteria
work well on the simpliﬁed correlation task we used for testing, without requiring
complex conﬁguration parameters.
This is an exploratory work, and further investigations of this approach on
real, longer sequences of data, as well as further reﬁnements of the tests and the
criteria we proposed, are surely needed. Another possible extension of this work
is the investigation of how these criteria can be used to correlate anomaly and
misuse-based alerts together, in order to bridge the gap between the existing
paradigms of intrusion detection.
Acknowledgments
We need to thank prof. Ilenia Epifani and prof. Giuseppe Serazzi for their helpful
comments, as well as the anonymous reviewers.
176
F. Maggi and S. Zanero
References
1. Akaike, H.: A new look at the statistical model identiﬁcation. Automatic Control,
IEEE Transactions on 19(6), 716–723 (1974)
2. Dain, O., Cunningham, R.: Fusing heterogeneous alert streams into scenarios. In:
Proc. of the ACM Workshop on Data Mining for Security Applications, November
2001, pp. 1–13. ACM Press, New York (2001)
3. Eckmann, S., Vigna, G., Kemmerer, R.: STATL: An attack language for state-based
intrusion detection. In: Proceedings of the ACM Workshop on Intrusion Detection,
Atene, November 2000, ACM Press, New York (2000)
4. Haines, J., Ryder, D.K., Tinnel, L., Taylor, S.: Validation of sensor alert correlators.
IEEE Security and Privacy 01(1), 46–56 (2003)
5. Julisch, K., Dacier, M.: Mining intrusion detection alarms for actionable knowledge.
In: Proc. of the 8th ACM SIGKDD Int’l Conf. on Knowledge Discovery and Data
Mining, New York, NY, USA, pp. 366–375. ACM Press, New York (2002)
6. Lippmann, R., Haines, J.W., Fried, D.J., Korba, J., Das, K.: The 1999 darpa oﬀ-
line intrusion detection evaluation. Comput. Networks 34(4), 579–595 (2000)
7. Lippmann, R., Haines, J.W., Fried, D.J., Korba, J., Das, K.: Analysis and results
of the 1999 DARPA oﬀ-line intrusion detection evaluation. In: Debar, H., M´e, L.,
Wu, S.F. (eds.) RAID 2000. LNCS, vol. 1907, Springer, Heidelberg (2000)
8. Maggi, F., Matteucci, M., Zanero, S.: Detecting intrusions through system call
sequence and argument analysis (submitted for publication, 2006)
9. Maggi, F., Matteucci, M., Zanero, S.: Reducing false positives in anomaly detectors
through fuzzy alert aggregation (submitted for publication, 2006)
10. Mahoney, M.V., Chan, P.K.: An analysis of the 1999 DARPA / Lincoln laboratory
evaluation data for network anomaly detection. In: Vigna, G., Kr¨ugel, C., Jonsson,
E. (eds.) RAID 2003. LNCS, vol. 2820, pp. 220–237. Springer, Heidelberg (2003)
11. McHugh, J.: Testing intrusion detection systems: a critique of the 1998 and 1999
DARPA intrusion detection system evaluations as performed by lincoln laboratory.
ACM Trans. on Information and System Security 3(4), 262–294 (2000)
12. Ning, P., Cui, Y., Reeves, D.S., Xu, D.: Techniques and tools for analyzing intrusion
alerts. ACM Trans. Inf. Syst. Secur. 7(2), 274–318 (2004)
13. Pestman, W.R.: Mathematical Statistics: An Introduction. Walter de Gruyter,
Berlin (1998)
14. Qin, X., Lee, W.: Statistical causality analysis of INFOSEC alert data. In: Vigna,
G., Kr¨ugel, C., Jonsson, E. (eds.) RAID 2003. LNCS, vol. 2820, pp. 73–93. Springer,
Heidelberg (2003)
15. Templeton, S.J., Levitt, K.: A requires/provides model for computer attacks. In:
NSPW ’00: Proceedings of the 2000 workshop on New security paradigms, New
York, NY, USA, pp. 31–38. ACM Press, New York (2000)
16. Thurman, W.N., Fisher, M.E.: Chickens, eggs, and causality, or which came ﬁrst?
American Journal of Agricultural Economics (1998)
17. Valeur, F., Vigna, G., Kruegel, C., Kemmerer, R.A.: A comprehensive approach to
intrusion detection alert correlation. IEEE Trans. Dependable Secur. Comput. 1(3),
146–169 (2004)
18. Venables, W., Ripley, B.: Modern Applied Statistics with S. Springer, Heidelberg
(2002)
19. Viinikka, J., Debar, H., M´e, L., S´eguier, R.: Time series modeling for IDS alert
management. In: Proc. of the 2006 ACM Symp. on Information, computer and
communications security, New York, NY, USA, pp. 102–113. ACM Press, New
York (2006)
On the Use of Diﬀerent Statistical Tests for Alert Correlation
177
20. Zanero, S.: Analyzing TCP traﬃc patterns using self organizing maps. In: Roli, F.,
Vitulano, S. (eds.) ICIAP 2005. LNCS, vol. 3617, pp. 83–90. Springer, Heidelberg
(2005)
21. Zanero, S.: Unsupervised Learning Algorithms for Intrusion Detection. PhD thesis,
Politecnico di Milano T.U., Milano, Italy (May 2006)