title:Mash-IF: Practical information-flow control within client-side mashups
author:Zhou Li and
Kehuan Zhang and
XiaoFeng Wang
201O IEEEIIFIP International 
Conference 
on Dependable 
Systems & Networks (DSN) 
Mash-IF: Practical 
Information-Flow 
Control within Client-side 
Mashups 
Zhou Li, Kehuan Zhang, XiaoFeng Wang 
at Bloomington 
Indiana University 
{lizho, kehzhang, xw7}@indiana.edu 
Abstract 
Mashup is a representative 
of Web 2.0 technology 
that 
access and protec­
pro­
access to the 
but little 
domains, 
the security 
on mediating 
a new technique 
of cross-domain 
risks it brings in. Solutions 
has been done to con­
In this paper, we 
con­
needs both convenience 
tion against 
posed by prior research focused 
data in different 
trol the use of the data after the access. 
present Mash-IF, 
for information-flow 
trol within mashups. Our approach allows cross-domain 
communications 
disclosure 
of sensitive 
the user's 
permission. 
isting mashups and works on the client without 
rations from other parties. 
a novel technique 
that automatically 
cation rules for a script by statically 
Such rules can be efficiently 
the script's 
analyzing 
through monitoring 
collabo­
interest 
declassifi­
within a browser, but disallows 
and DaM operations. 
Also of particular 
the cross-domain 
to remote parties 
information 
call sequences 
It mediates 
generates 
enforced 
channels 
in ex­
without 
its code. 
is 
Keywords: Web, Browser, 
Model, Information-Flow 
Control 
Mashup, Protection, 
Security 
1. Introduction 
The rapid progress 
of Web 2.0 technologies 
has brought 
of web services, 
such as Flickr, 
Among them is client­
hybrid, commonly known as client­
that syndicates 
data and components 
sources into an single tool that runs within 
browser. 
Examples of mashups include 
on­
in a whole new category 
YouTube, Facebook and Wikipedia. 
side web application 
side mashup, a service 
from different 
a web client's 
line realtors 
estate data [12], financial 
tion from one's multiple 
that integrate 
are gaining 
as Google and Microsoft, 
velopment. 
that label locations 
news websites 
aggregators 
accounts 
different 
on Google Maps with real 
that compile informa­
[3], and news 
aggregators 
[17]. Those services 
support from major web service 
who provide APIs 
providers 
such 
for mashup de­
of a document from a different 
cross­
against 
on the client side [30]. For a mashup, how­
web contents 
ori­
among its components 
Without proper security 
controls 
To get out of this 
in 
are actively 
seeking 
properties 
communication 
accessing 
gin [36]. It is meant to protect 
domain attacks 
ever, cross-domain 
becomes a necessity. 
place, this opens the door to the attacks. 
dilemma, both academia and industry 
effective 
among mutually-untrusting 
Prominent 
and OMash [22]. These approaches 
level abstractions 
tors to specify 
as well as new cross-domain 
cording to the policies. 
that allow content 
solutions 
policies 
examples 
channels 
web services 
include 
within browsers. 
SMash [31], MashupOS [39] 
suggest new mash up­
providers 
and integra­
are accessed, 
on how their contents 
that are mediated 
ac­
that permit but regulate 
the interactions 
A fundamental 
problem of the recently 
proposed ap­
protection 
the access to the contents 
a client-side 
financial 
ac­
after the 
accounts 
financial 
domains, 
is that they only control 
a mashup version of personal 
software 
is designed 
into a single web page. 
script needs to cross its domain 
such as Mint. com [3]. Such an 
to consolidate 
information 
from a 
not the use of the contents 
for information 
consider 
proaches 
from different 
This is often insufficient 
access. 
within mashups. As an example, 
count aggregator, 
management 
aggregator 
user's multiple 
To this end, the integrator 
so as to access the user's bank accounts 
of these accounts [3]. However, the last thing we want is 
that the script transfers 
to the 
information 
party we do not trust. Similar problems also happen, for 
example, when a gmail user uses a twitter 
her twitter 
tacts are exfiltrated 
mitigated without 
within mashups. 
Moreover, 
for guiding the development 
might not be suitable 
nels within a large number of existing 
need cooperation 
label information. 
account but is afraid that her emails and con­
by the gadget. Such a risk cannot be 
flows 
for managing the cross-domain 
mashups. They also 
proper management 
of information 
such sensitive 
from content 
providers 
chan­
gadget to access 
proposals 
existing 
of new mash ups and therefore, 
are designed 
and integrators 
to 
and the passwords 
In this paper, we present 
a new technique, 
IF, that makes a first step towards practical 
flow control 
place existing 
within mashups. Mash-IF is not meant to re­
mechanisms, 
such as 
browser-level 
called Mash­
information­
security 
The concept of mashups, unfortunately, 
fundamentally 
model adopted by current web 
i.e., the Same Origin Policy (SOP). The policy 
the security 
contravenes 
browsers, 
prevents 
defined as a combination 
the documents 
or scripts 
loaded from one origin, 
of protocol, 
port and host, from 
978-1-4244-7501-8/10/$26.00 
©201O IEEE 
251 
DSN 2010: Li et al. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:05:29 UTC from IEEE Xplore.  Restrictions apply. 
20lO IEEEIIFIP International 
Conference 
on Dependable 
Systems & Networks (DSN) 
to flow into any remote party 
call sequences. 
Compared with the prior 
under our model, a fi­
[38], this approach avoids potentially 
intensive 
dissemination. 
a new information-flow 
can cross domains to gather one's credit 
access within a browser, 
consent from the user, dis­
[31, 39, 22]. In­
layer of protec­
however such access and 
can only happen within the user's browser and 
includes 
our approach 
For example, 
to add an additional 
user data through mediating 
in prior research 
SOP and those proposed 
stead, it is designed 
tion of private 
Specifically, 
model that permits cross-domain 
but in the absence of an explicit 
allows sensitive  information 
other than its origin. 
nancial 
aggregator 
or debit data from her accounts; 
aggregation 
the information 
to unauthorized 
website. 
DOM (Document 
calls within scripts 
effectively 
munication, 
through API functions 
We also developed 
information 
tent providers 
from the accounts 
recipients, 
and integrators. 
for example, 
important 
because such communication 
by web service 
supplied 
control 
To enforce this model, our technique 
Object Model) operations 
at the add-on level. This enables us to 
existing 
for cross-domain 
channels 
com­
typically 
goes 
to her without involvement 
of con­
is not allowed to be sent 
mediates 
and function 
a tool to let the user label and identify 
providers. 
an advertisement 
approach. We propose novel tech­
analyze 
to generate 
scripts 
declas­
rules. These rules allow our approach 
to achieve 
than the black-box 
models like BLP, 
.Novel declassification 
niques that automatically 
sification 
finer-grained 
control 
which is necessary 
of mashups. 
itoring 
research 
instruction-level 
Enforcement 
scripts' 
monitoring. 
for preserving 
legitimate 
functionalities 
of these rules is based upon mon­
.Implementation 
Mash-IF as an add-on for the Mozilla Firefox, 
it using 10 real mashups. Our experimental 
strates 
and evaluation. We implemented 
and evaluated 
study demon­
the efficacy of our techniques. 
The rest of the paper is organized 
as follows. 
our model and its enforcement 
Section 2 
4 reports 
and 3 describe 
Section 
our approach 
tations 
our evaluation 
study. Section 
with prior work. Section 6 discusses 
of our techniques 
and Section 7 concludes 
techniques. 
5 compares 
the limi­
the paper. 
2. The Model 
a subject 
their policies 
Classic 
information-flow 
models like BLP treat 
websites, 
some outputs 
Mitigation 
For example, 
any sensitive 
and as a result, 
does not involve 
with untrusted 
as a black-box, 
rules for scripts. 
data, our approach 
Whenever a script reads 
In our research, 
generates 
forbid a script that inputs sensitive 
data to 
even if such com­
data (e.g., 
down­
of this problem often relies 
of a subject. 
that automatically 
a script) 
"no read up" and "no write down") can become over­
for web applications. 
the BLP model 
(e.g., 
(e.g., 
strict 
will completely 
communicate 
munication 
loading a picture). 
on declassifying 
we propose a new technique 
declassification 
sensitive 
identify all the execution 
sitive 
ients. These paths are fingerprinted 
function 
The rule created 
sifies the outputs of the script unrelated 
A prominent 
to analyze a script once and can reuse the same rules af­
terwards 
which can be verified using its hash value. This strategy 
works particularly 
change often. We summarize 
as follows: 
as their scripts 
the contributions 
to other part of a mashup or remote recip­
as long as its code does not change, 
paths that could propagate 
its code to 
the sen­
call sequences. 
well for mashups, 
is that it only needs 
of this approach 
information 
on the script, 
thereby declas­
statically 
to the sequences. 
of the paper 
analyzes 
property 
do not 
by their corresponding 
flows. We propose 
flows within mashups. 
.Management of mashup information 
a new model to mediate information 
The model is enforced 
tions and function 
mation flow tracking 
code. Also different 
not rely on content 
to the practical 
calls within scripts, 
providers' 
deployment 
through interposing 
on DOM opera­
infor­
which enables 
and control 
from prior work is that Mash-IF does 
without changing 
browser 
cooperation, 
which is critical 
a node in a DOM tree or a cookie, or 
some basic concepts 
flows, labels 
in 
and own­
for information. 
It can be 
objects, 
Here, we introduce 
subjects,
Basic  concepts. 
Mash-IF, including 
ers. An object is a repository 
local, for example, 
remote, for example, 
port and host. A subject 
that works on objects. 
scripts 
object, 
tions happen, flows that carry information 
object to the subject, 
running in a browser!.  A subject 
which includes 
or from the subject 
In mashups, 
read and write. When these opera­
moves from the 
to the object. 
a web server identified 
can operate 
on an 
it typically 
refers to the 
by protocol, 
is an information-processing 
unit 
Individual 
objects, 
subjects 
and flows are associated 
high (sensitive) 
three sensitiv­
These levels correspond 
by MashupOS [39]: 
by any domain, 
content 
(public) 
identified 
sensitive) 
(sensitive) 
that can be accessed 
Our model includes 
or public), 
an origin. 
low (non-sensitive 
sensitive). 
with a set of labels. A label can be described 
as a tu­
level and 0 
ple (T,O), where T is a tag for a sensitivity 
represents 
ity levels, 
or very high (highly 
to three trust relationships 
open content 
access-controlled 
to other domains through mediation 
(highly 
that is completely 
mains. Another relationship 
unauthorized 
out the privileges 
additional 
does not seem to be necessary 
providers 
ation from content 
is supposed 
to be identified 
indicative 
jects/subjects/flows 
to is described 
the web content 
of any domain, could be modeled by an 
or integrators, 
by these parties. 
proposed 
that describes 
sensitivity 
by its owner tag. 
content, 
isolated 
of the domain from which information 
belongs 
comes. The domain a subject 
within ob­
in the absence ofthe cooper­
level very low. This level, however, 
that is only accessible 
and isolated 
from other do­
content 
by the prior work, 
as such content 
An origin is 
with­
of our techniques. 
1 Note that scripts 
are web content and therefore 
also objects. 
978-1-4244-7501-8/10/$26.00 
©2010 IEEE 
252 
DSN 20lO: Li et al. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:05:29 UTC from IEEE Xplore.  Restrictions apply. 
2010 IEEE/IFIP International 
Conference 
on Dependable 
Systems & Networks (DSN) 
the 
by labeling 
protection, 
can be eliminated 
of CSRF, for example, 
cookie as highly sensitive. 