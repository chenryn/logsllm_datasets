In the previous paragraphs we applied the online EM
algorithm to different traces and compared the quality of the
estimation to ofﬂine algorithms according to likelihood values.
The purpose of the approach is, of course, to use the esti-
mated distributions as part of larger performance or reliability
models. To demonstrate the applicability of our approach we
present results from a single server queue with limited buffer
capacity and exponentially distributed service times. The ar-
rivals are generated according to the distributions from ofﬂine
and online EM ﬁtting and from the trace to obtain reference
values. We use the trace from the previous experiments. Since
the real trace contains the lengths of availability intervals the
server could be interpreted as a maintenance or repair process
that is triggered at the end of availability intervals to ﬁx failed
components. Fig. 10 shows the fraction of rejected requests at
the server at time t for a buffer capacity of 100 and utilization
ρ = 0.83 resulting from 50 replications of the simulation. For
the distribution from the ofﬂine EM algorithm the probability
of a rejected request due to a full buffer is close to zero,
while the distributions from the online EM algorithms provide
results that are closer to the behavior of the trace. One can also
observe that change point detection signiﬁcantly improves the
results and that the more complex PHDs provide better results
than the simpler subclasses. We performed similar experiments
for the synthetical traces. Results from the second trace for a
buffer capacity of 10 are shown in Fig. 11. The results from
online EM ﬁtting provide a very close approximation of the
trace results in this case, which conﬁrms our observations that
the online EM approach with change point detection reacts
very fast to changes in the input stream.
The experiments show that for inhomogenous data, that
changes its characteristics over time, classic ofﬂine approaches
for parameter estimation are not sufﬁcient. In contrast, online
approaches can react to changes in the input stream and modify
their estimates accordingly. The experiments also show that an
explicit detection of change points allows for a much faster
reaction to changes and further increases the performance
results. From the plots of the forward likelihoods (e.g. Figs. 5
109
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:54:41 UTC from IEEE Xplore.  Restrictions apply. 
d
o
o
h
i
l
e
k
i
l
e
g
a
r
e
v
a
 0
-0.2
-0.4
-0.6
-0.8
-1
-1.2
-1.4
 0
 HExp offline EM def. 
 HExp offline EM 
 HExp online EM 
 10000
 20000
i
 30000
 40000
(a) Hyperexponential
d
o
o
h
i
l
e
k
i
l
e
g
a
r
e
v
a
 0
-0.2
-0.4
-0.6
-0.8
-1
-1.2
-1.4
 0
 HErD offline EM def. 
 HErD offline EM 
 HErD online EM 
 10000
 20000
i
 30000
 40000
(b) Hyper-Erlang
d
o
o
h
i
l
e
k
i
l
e
g
a
r
e
v
a
 0
-0.2
-0.4
-0.6
-0.8
-1
-1.2
-1.4
 0
 APHD offline EM def. 
 APHD offline EM 
 APHD CF online EM 
 APHD online EM
 10000
 20000
i
 30000
 40000
(c) Acyclic PHDs
Fig. 7: Synthetical trace 3: Average forward likelihood lf wd
i
x
 1.4e+07
 1.2e+07
 1e+07
 8e+06
 6e+06
 4e+06
 2e+06
 0
 0
 100000
 200000
i
s
t
s
e
u
q
e
r
d
e
t
c
e
j
e
r
f
o
n
o
i
t
c
a
r
f
 0.35
 0.3
 0.25
 0.2
 0.15
 0.1
 0.05
 0
 0
Trace
HErD offline EM def.
HErD offline EM
HErD online EM
 10000  20000  30000  40000  50000
t
Fig. 8: Availability times
Fig. 11: Queueing results for synthetical trace 2
d
o
o
h
i
l
e
k
i
l
e
g
a
r
e
v
a
 HExp offline EM 
 HExp online EM 
 HExp online EM (w=5; (cid:1)=0.01; bc=11) 
 HErD online EM (w=5; (cid:1)=0.01; bc=11) 
 APHD CF online EM (w=10; (cid:1)=0.01; bc=13)
APHD CF
HErD
HExp
 180
 160
 140
 120
 100
 80
 60
 40
 20
 0
 0
 50000  100000  150000  200000  250000  300000
i
Fig. 9: Average forward likelihood lf wd
i
and 7) one can see that after a change point the online algo-
rithm requires some observations until the estimates and the
likelihood values are stable again. The amount of observations
required varies depending on the distribution and is in the
order between 102 and 103 for our experiments. If change
points occur much more frequently, the ﬁtting results might
become bad, because the algorithm does not see enough data
to obtain good estimates before change point detection resets
s
t
s
e
u
q
e
r
d
e
t
c
e
j
e
r
f
o
n
o
i
t
c
a
r
f
 1
 0.8
 0.6
 0.4
 0.2
 0
 0
Trace
HExp offline EM
HExp online EM (no changepoint detection)
HExp online EM
HErD online EM
APHD CF online EM
 50000  100000  150000  200000  25000
t
Fig. 10: Queueing results for the real trace
them again.
VII. CONCLUSIONS
The paper presents an online EM algorithm to estimate
parameters of Phase-Type distributions from a continuous
data stream. Several variants of the algorithm tailored to
speciﬁc subclasses of Phase-Type distributions are proposed.
By integrating methods to detect change points, the estimated
distributions adopt changing behaviors in observed sequences.
The algorithms can be applied in online situations where data
is permanently gathered from a running system and they may
also be used for very large traces where standard ofﬂine EM
algorithms are inefﬁcient.
The experiments suggest that the quality of the change point
detection is sensitive to parameters of the algorithm and a
poor choice of values could lead to a lot of false positives.
This could be addressed with an adaptive scheme to set those
algorithm parameters during runtime using techniques from
machine learning or heuristics that adjust the parameters if
change points are detected too frequently.
Ofﬂine EM approaches for PHDs have been generalized
to estimate the parameters of Markovian Arrival Processes to
account for autocorrelations in the input data. Future work will
aim at extending our algorithm for cases with correlated data.
Obviously the online estimation of distribution parameters
is only one step in an environment where stochastic models
are used online to predict and analyze the future behavior of a
running system. Thus, there is still a need for further research
how to exploit the resulting distributions in stochastic models
because the change of the distribution parameters changes the
whole model such that for example simulations have to be
restarted.
110
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:54:41 UTC from IEEE Xplore.  Restrictions apply. 
[25] A. Aue and L. Horvath, “Structural breaks in time series,” Journal of
Time Series Analysis, vol. 34, pp. 1–16, 2013.
[26] A. R. Brazzale and V. Mameli, “Likelihood asymptotics in nonregular
settings - a reviewwith emphasis on the likelihood ratio,” Department
of Statistics, University of Padua, Working Paper Series 4, September
2018.
[27] Y. Cao, L. Xie, Y. Xie, and H. Xu, “On near optimality of one-sample
update for joint detection and estimation,” arXiv, Tech. Rep. 1705.06995,
2017.
[28] J. R. Esparza, B. F. Nielsen, and M. Bladt, “Maximum likelihood esti-
mation of phase-type distributions,” Kgs. Lyngby, Denmark: Technical
University of Denmark (DTU), IMM-PHD-2010-245, 2011.
[29] S. Asmussen, Applied probability and queues. Springer, 2003.
[30] P. Liang and D. Klein, “Online EM for unsupervised models,” in
Human Language Technologies: Conference of
the North American
Chapter of the Association of Computational Linguistics, Proceedings,
May 31 - June 5, 2009, Boulder, Colorado, USA. The Association
for Computational Linguistics, 2009, pp. 611–619. [Online]. Available:
http://www.aclweb.org/anthology/N09-1069
[31] J. Olsson and J. Westerborn, “An efﬁcient particle-based online EM for
general state-space models,” IFAC-PapersOnLine, vol. 48, no. 28, pp.
963–968, 2015.
[32] O. Cappe, “Online EM algorithm for hidden Markov models,” Journal
of Computational and Graphical Statistics, vol. 20, no. 3, pp. 728–749,
2011.
[33] H. Kushner and G. Yin, Stochastic Approximation and Recursive Algo-
rithms and Applications. Springer, 2003.
[34] S. Aminikhanghahi and D. J. Cook, “A survey of methods for time series
change point detection,” Knowl. Inf. Syst., vol. 51, no. 2, pp. 339–367,
2017. [Online]. Available: https://doi.org/10.1007/s10115-016-0987-z
[35] T. L. Lai, “Sequential changepoint detection in quality control and
dynamical systems,” Journal of the Royal Statistical Society Series B,
vol. 57, no. 4, pp. 613–658, 1995.
[36] D. Kondo, B. Javadi, A. Iosup, and D. H. J. Epema, “The failure trace
archive: Enabling comparative analysis of failures in diverse distributed
systems,” in CCGRID.
IEEE, 2010, pp. 398–407.
[37] B. Javadi, D. Kondo, A. Iosup, and D. H. J. Epema, “The failure trace
archive: Enabling the comparison of failure measurements and models
of distributed systems,” J. Parallel Distrib. Comput., vol. 73, no. 8, pp.
1208–1223, 2013.
[38] A.
Iosup, M.
Jan, O. Sonmez, and D. H. Epema, “On the
dynamic resource availability in grids,” in 8th IEEE/ACM International
Conference on Grid Computing, September 2007. [Online]. Available:
http://www.pds.ewi.tudelft.nl/∼epema/Papers/2007/GRID2007.pdf
[39] A. L. Reibman and K. S. Trivedi, “Numerical transient analysis of
Markov models,” Computers & OR, vol. 15, no. 1, pp. 19–36, 1988.
[Online]. Available: https://doi.org/10.1016/0305-0548(88)90026-3
REFERENCES
[1] A. M. Law, Simulation Modeling and Analysis, 5th ed. McGraw-Hill,
2015.
[2] P. Buchholz, J. Kriege, and I. Felko, Input Modeling with Phase-Type
Distributions and Markov Models - Theory and Applications. Springer,
2014. [Online]. Available: http://dx.doi.org/10.1007/978-3-319-06674-5
[3] M. F. Neuts, “Probability distributions of phase type,” in Liber Amicorum
Prof. Emeritus H. Florin. University of Louvain, 1975, pp. 173–206.
[4] G. Latouche and V. Ramaswami, Intorduction to Matrix Analytical
Methods in Stochastic Modeling. SIAM, 1999.
[5] A. P. Dempster, N. M. Laird, and D. B. Rubin, “Maximum-likelihood
from incomplete data via the EM algorithm,” Journal of the Royal
Statistical Society, vol. 39, no. 1, pp. 1–38, 1977.
[6] S. Asmussen, O. Nerman, and M. Olsson, “Fitting phase type distribu-
tions via the EM algorithm,” Scand. J. Statist., vol. 23, pp. 419–441,
1996.
[7] O. Cappe
and E. Moulines,
expectation-maximization
algorithm for latent data models,” Journal of
the Royal Statistical
Society. Series B (Statistical Methodology), vol. 71, no. 3, pp. 593–613,
2009. [Online]. Available: http://www.jstor.org/stable/40247590
“On-line
[8] C. Olivier, Online Expectation Maximisation. Wiley-Blackwell, 2011,
ch. 2, pp. 31–53. [Online]. Available: https://onlinelibrary.wiley.com/
doi/abs/10.1002/9781119995678.ch2
[9] M. F. Neuts, Matrix-geometric solutions in stochastic models.
Johns
[10] W. J. Stewart, Probability, Markov Chains, Queues, and Simulation.
Hopkins University Press, 1981.
Princeton University Press, 2009.
[11] P. Buchholz and A. Panchenko, “An EM algorithm for ﬁtting of real
trafﬁc traces to PH-distribution,” in PARELEC. IEEE Computer Society,
2004, pp. 283–288.
[12] R. E. A. Khayari, R. Sadre, and B. Haverkort, “Fitting world-wide web
request traces with the EM-algorithm,” Performance Evaluation, vol. 52,
pp. 175–191, 2003.
[13] A. Th¨ummler, P. Buchholz, and M. Telek, “A novel approach for phase-
type ﬁtting with the EM algorithm,” IEEE Trans. Dep. Sec. Comput.,
vol. 3, no. 3, pp. 245–258, 2006.
[14] H. Okamura, T. Dohi, and K. S. Trivedi, “A reﬁned EM algorithm for
PH distributions,” Perform. Eval., vol. 68, no. 10, pp. 938–954, 2011.
[15] A. Riska, V. Diev, and E. Smirni, “An EM-based technique for ap-
proximating long-tailed data sets with PH distributions,” Perform. Eval.,
vol. 55, pp. 147–164, 2004.
[16] T. Ryd´en, “An EM algorithm for estimationin Markov modulated
Poisson processes,” Computational Statistics and Data Analysis, vol. 21,
pp. 431–447, 1996.
[17] A. Cumani, “On the canonical representation of homogeneous Markov
processes modeling failure-time distributions,” Microelectronics Relia-
bility, vol. 22, no. 3, pp. 583–602, 1982.
[18] G. Casale, E. Z. Zhang, and E. Smirni, “Trace data characterization and
ﬁtting for markov modeling,” Performance Evaluation, vol. 67, no. 2,
pp. 61 – 79, 2010.
[19] A. Horvath and M. Telek, “Matching more than three moments with
acyclic phase type distributions,” Stochastic Models, vol. 23, no. 2, pp.
167–194, 2007.
[20] M. C. Kaptein and P. Ketelaar, “Maximum likelihood estimation of a
ﬁnite mixture of logistic regression models in a continuous stream,”
arXiv, Tech. Rep. 1802.10529, February 2018.
[21] S. Kim and W. Whitt, “Are call center and hospital arrivals well
modeled by nonhomogeneous poisson processes?” Manufacturing &
Service Operations Management, vol. 16, no. 3, pp. 464–480, 2014.
[Online]. Available: https://doi.org/10.1287/msom.2014.0490
[22] V. Nagaraju, L. Fiondella, P. Zeephongsekul, C. L. Jayasinghe,
and T. Wandji, “Performance optimized expectation conditional
maximization algorithms for nonhomogeneous poisson process software
reliability models,” IEEE Trans. Reliability, vol. 66, no. 3, pp. 722–734,
2017. [Online]. Available: https://doi.org/10.1109/TR.2017.2716419
[23] Z. Zheng and P. W. Glynn, “Fitting continuous piecewise linear
poisson intensities via maximum likelihood and least squares,” in
2017 Winter Simulation Conference, WSC 2017, Las Vegas, NV, USA,
December 3-6, 2017.
IEEE, 2017, pp. 1740–1749. [Online]. Available:
https://doi.org/10.1109/WSC.2017.8247912
[24] A. P. Dempster, “The direct use of likelihood for signiﬁcance testing,”
Statistics and Computing, vol. 7, pp. 247–252, 1997.
111
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:54:41 UTC from IEEE Xplore.  Restrictions apply.