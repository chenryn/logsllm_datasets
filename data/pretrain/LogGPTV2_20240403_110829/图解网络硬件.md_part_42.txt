路由选择
VLAN10
VLAN20
L2交换机
PC1
PC2
属于VLAN10
属于VLAN20
L3交换机
L3交换机能够在交换机内部直接完成VLAN之间的路由选择。
UDLD
UDLD（Uni-DirectionalLinkDetection，单向链路检测）由RFC5171文档公布，是思科公司
开发的L2协议，用于检测在发送（TX）或接收（RX）数据时线缆发生的单向链路故障。由于传
输媒介无论是光纤还是双绞线，以太网都会通过接收方和发送方两边的物理线缆来传输数据，因
此线缆发生某种敌障造成单向链路的可能性很大。
一旦发生单向链路故障，无论端口是否处于已连接的状态，都会造成通信一方的交换机只能
---
## Page 246
232|第4章理解L3交换机的性能与功能
发送数据而不能接收数据，另一方则只能接收数据而不能发送数据的状况。而且发生单向链路故
障时，生成树也无法正常工作，位于转发线路上的数据帧也会被丢弃。
交换机上UDLD生效的端口如果根据UDLD检测出了链路发生的单向敌障，就能够及时关
闭端口，修正网络上的不良运行状态。
图4-24
单向链路发生故障的概念图
TX
RX
RX
TX
发生故障
---
## Page 247
5
第
章
防火墙功能与防范威胁的对策
本章将介绍防火墙和安全设备的历史、产品类型、功能等，
帮助读者理解安全设备性能的考量方法与相关注意事项。
另外，本章还会介绍TCP连接、UDP等传输层会话管理，
以及IPSeC、使用SSL的VPN等相关内容。
---
## Page 248
2341第5章防火墙功能与防范威胁的对策
05.01防火墙是怎样的网络硬件
20世纪90年代，随着互联网的普及，出现了路由器访问控制列表无法抵御的攻击和非法访
问等一系列威胁，因此出现了针对这些威胁的防范策略需求。1992年OECD?组织发布了“信息
系统安全指导书”，其中定义了为构建安全网络体系而需要遵循的CIA基本理念。CIA是机密性
（Confidentiality）、完整性（Integrity）、可用性（Availability）三个英文单词的首字母组合，这三
个方面的主要威胁及其对策如表5-1所示。
表5-1
CIA的内容
CIA条目
威胁的种类
对策使用的技术对策实施的装置
说明
机密性
窃听、非法访
用户认证、加密
防火墙、VPN
信息的机密性是指只允许合法用户访问相关
问、窃取等
IDS/IPS等
信息。确保信息的机密性即保证信息不被泄
露，设立防止非法访问等保护对策
完整性
篡改、冒充等
数据认证、电子
防火墙、VPN、
处理正确信息，保证信息的完整和确切，防
签名、加密
IDS/IPS等
止信息被篡改
可用性
DoS攻击等
过滤、兄余、策
防火墙、带宽控
确保合法用户能够访问授权的信息。需要重
略
制装置等
视服务器或网络硬件的运维，避免系统出现
当机问题
防火墙硬件作为防范装置能够同时实现CLA中3个条目的相应对策。在20世纪90年代中
期，普通企业一般都会在网关（LAN与互联网的边界）中设置防火墙。
防火墙（Firewall）是指为了防止发生火灾时，火势蔓延至建筑物内其他区域而设置的、由防
火材质（主要是石膏板）铸成的墙（图5-1）。
图5-1防火墙示意图
防火墙
①经济合作与发展组织，全称为OrganizationforEconomicCo-operation andDevelopment。—译者注
---
## Page 249
05.02防火墙是如何诞生的丨235
将自外而内的网络入侵行为看作火灾，那么防止这种人侵的对策即可称为防火墙。在网络结
构图中经常也使用“砖墙”的图标来表示防火墙（图5-2）。
图5-2Windows中防火墙的图标
图53思科公司的防火墙图标
（企业的Intranet）进行的DoS攻击或不法访问（Hacking，黑客行为），但现在也开始需要防范从
内部网络向互联网泄露信息或将内部网络作为攻击跳板等行为。
05.02防火墙是如何诞生的
现在的防火墙是作为专用设备出现在网络中的，但最初的防火墙则出现在1985年左右，采
用分组过滤技术由思科公司的IOS软件实现，是路由器的一个功能。
不久之后，DEC公司和AT&T的贝尔实验室开始了防火墙的相关研究工作。当时DEC公司
的防火墙装置是将配有两个接口的计算机同外部网络（互联网）和内部网络（Intranet）进行连接，
内部网络用户只有登录该计算机（网关）才能完成对外部互联网的访问。而当时AT&T贝尔实验
室的防火墙装置则是属于第二代防火墙技术的电路层（CircuitLevel）防火墙（参考05.04节）。该
装置使用了配有两个接口的、DEC公司的VAX计算机，内部网络用户必须通过该计算机的电路
中继，才能完成对互联网的访问。
随后，从1988年到1990年，DEC公司的防火墙装置不仅需要用户登录，还添加了限制非
法通信的功能（称为screend）。当时作为限制对象的网络服务有USENET新闻、FTP、Telnet、
邮件等。在这之后，业内又逐步转向开发无需用户登录，单纯对网络服务进行控制的防火墙产
品。该类型防火墙属于第三代防火墙，即应用层防火墙（也称为代理防火墙）另外，这一时期
的文献中也记录了一些类似于“确认连接建立”“允许输人响应”“在IP层面保持状态”等功能，
DEC公司的防火墙原本常用于大学或科研机构，但在1991年，DEC公司开始面向企业销售
名为DECSEAL（ScreeningExternalAccessLink）的防火墙产品。
---
## Page 250
236第5章防火墙功能与防范威胁的对策
第四代防火墙即分组过滤防火墙的早期装置一Visas的研发工作开始于1992年?。Visas
也成为1994年由CheckPointSoftwareTechnologies公司②开发的商用防火墙产品Firewall-1的
原型
1996年，Global互联网SoftwareGroup公司开始研发第五代防火墙，即基于内核代理架构
（kernelproxyarchitecture）的防火墙。第二年，思科公司发售了首个基于内核代理技术的防火墙
产品CiscoCentriFirewall。CiscoCentriFirewall是在WindowsNT上运行的软件，其中的诸多技
术被后来思科公司的防火墙设备PIXFirewall继承（CiscoCentriFirewall在1998年停止销售）。
到了2000年左右，随着宽带网络的普及，越来越多的企业开始使用VPN。这一时期在日
本，有很多用户使用防火墙通过FTTH或ADSL线路、以PPPoE的形式构建站点到站点（siteto
site）的VPN。
2004年，UTM（UnifiedThreatManagement，统一威胁管理）产品发布，是一款将IDP/IPS
（DeepInspection，深度检测）、反病毒、反垃圾邮件（anti-spam）、URL过滤等功能集成在一起的
防火墙设备产品。
UTM产品包括JuniperNetworks公司的SSG系列和ISG系列、Fortinet公司?的FortiGate系
列、CheckPoint公司的UTM-1系列以及思科公司的ASA系列等。
2007年，PaloAltoNetworks公司发布了新一代防火墙（NGFW，NextGenerationFirewall）
该防火墙不再基于端口而是基于应用程序来执行相关的安全策略。新一代防火墙同样配备类似
UTM的基于内容安全的功能，协同活动目录（ActiveDirectory）或Web认证等完成用户识别，
从而执行并非基于IP地址，而是基于用户名、群组名的安全策略。
表5-2中列出了防火墙设备与安全设备的发展历史。
表5-2防火墙设备与安全设备的发展历史
年
事件
1984年
SecureComputing公司成立
1988年
思科公司的1OS8.3开始支持访问控制列表
1991年
SonicWall公司成立
1992年
OECD制定“信息系统安全指南”
①该项目是由美国南加州大学的BobBraden和AnnetteDeSchon发起的。——译者注
②一家以色列公司，成立于1993年。—译者注
③当时Visas仅仅是一个带有图形界面的实验室原型产品，最后这些特性被以色列的CheckPoint公司引入，成为其拳
头产品Firewall-1。——译者注
④该公司于1997年被思科公司收购。—译者注
③该产品是思科收购Global互联网SoftwareGroup公司后发布的。—译者注
和NetScreen公司一样，由知名硅谷华人创业者谢青创办。—译者注
该公司最早从霍尼韦尔国际公司独立出来，在2008年被迈克菲公司收购，而迈克菲公司则被英特尔收购。—译者注
---
## Page 251
05.02防火墙是如何诞生的1237
（续）
年
事件
1993年
CheckPointSoftwareTechnologies公司成立
1994年
NetworkTranslation公司开发PIX
记述了私有地址相关内容的RFC1597发布
CheckPointSoftwareTechnologies公司开发状态检测型防火墙（Firewall-1）
CheckPointSoftwareTechnologies公司发布VPN-1产品
ISS（互联网SecuritySystems）公司成立（IDS/IPS设备产品）
1995年
思科公司收购NetworkTranslation公司、发布CiscoPIXFirewall产品
IPsec版本1以RFC文档（RFC1852等）形式发布
1996年
Watchguardtechnologies公司成立（防火墙产品）@
1997年
NetScreenTechnologies公司成立（防火墙产品）②
Nokia公司发布安装有CheckPointSoftwareTechnologies公司VPN-1/FireWal-1产品的IP系列安全设备。
1998年
IPsec版本2以RFC文档（RFC2401等）形式发布
1999年
OneSecure公司成立（IDS/IPS设备产品）
TippingPoint公司成立（IDS/IPS设备产品）
TLS版本1.0以RFC文档（RFC2246）形式发布
NetScreenTechnologies公司发布NetScreen-5、NetScreen-10、NetScreen-100
NetScreen NetScreen-5
2000年
Fortinet公司成立（防火墙/UTM设备）
Neoteris公司成立（SSL-VPN设备）
思科公司收购AltigaNetworks公司、发布VPN3000系列（IPsec-VPN远程接入集中设备）产品
2002年
OneSecure公司发布IDP设备（IPS产品）
NetScreenTechnologies公司收购OneSecure公司
NetScreenTechnologies公司发布NetScreen-200、NetScreen-5000系列产品
Fortinet公司发布FortiGate系列产品
2003年
NetScreenTechnologies公司收购Neoteris公司
2004年
JuniperNetworks公司收购NetScreenTechnologies公司
业内开始使用UTM这一术语
2005年
PaloAltoNetworks公司成立
思科公司发布适配性安全产品ASA（AdaptiveSecurityAppliance）系列
IPsec版本3以RFC文档（RFC4301等）形式发布
3Com公司收购TippingPoint公司
①该公司中文名称为沃奇卫士。
译者注
②该公司由知名硅谷华人创业者谢青、柯岩等创办。——译者注
③当时的诺基亚公司既有手机产品线也有网络硬件产品线，甚至还有个人计算机产品线。—译者注
④该公司于2002年被NetScreen收购。——译者注
该公司于2005年被3Com收购，后3Com又于2010年被HP收购。——译者注
---
## Page 252
238丨第5章防火墙功能与防范威胁的对策
（续）
年
事件
2006年
CiscoIOS开始支持SSLVPN功能
JuniperNetworks公司发布SSG系列产品
CheckPointSoftwareTechnologies公司发布UTM-1系列产品
IBM收购ISS公司
2007年
PaloAltoNetworks公司发布PA系列产品
思科公司收购电子邮件安全公司lronPort
2008年
McAfee公司收购SecureComputing公司
2009年
业内开始使用“新一代防火墙”这一术语
JuniperNetworks发布SRX系列产品
CheckPointSoftwareTechnologies公司收购Nokia公司的安全设备事业部\将其IP系列安全产品纳入旗
下产品线
2010年
Intel公司收购McAfee公司
2012年
Dell公司收购SonicWall公司
05.03
防火墙如何分类
05.03.01
软件型防火墙
■个人防火墙
个人防火墙运行于个人计算机上，用于监控个人计算机与外部网络之间的通信信息，主要功
能如表5-3所示。
在Windows操作系统中集成了Windows防火墙。
一般拥有杀毒软件产品的厂商会以综合安全软件套件的形式销售个人防火墙（表5-4）。
表5-3个人防火墙产品的功能
确认连接请求
向用户确认是否阻止特定的连接请求
根据需要生成记录（安全日志），记录计算机正常连接与错误连接的信息。这些
安全日志
记录在做故障分析时会起到很大作用
反病毒（病毒对策）功能
阻止接收到计算机病毒和蠕虫通信
反间谋软件（间谍对策）功能
阻止接收到来自于以犯罪为目的的间课软件或程序的通信
个人信息保护功能
设立对策以防止个人信息被窃取、浏览恶意网站以及钓鱼诈骗等
---
## Page 253
05.03防火墙如何分类
239
表5-4主要带有个人防火墙的产品
趋势科技公司（TRENDmicro）
VirusBuster-Grand（面向个人）
VirusBuster-BusinessSecurity（面向企业）
赛门铁克公司（Symantec）
Norton 360