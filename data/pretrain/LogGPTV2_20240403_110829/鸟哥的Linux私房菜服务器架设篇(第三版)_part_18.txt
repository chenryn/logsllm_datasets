联机所应该要放置的状态。最终我们也列出本书所需要的局域网络联机架构图喔！
3.1 局域网络的联机
3.1.1 局域网络的布线规划
3.1.1-1 Linux 直接联网-与 PC 同地位
3.1.1-2 Linux 直接联网-与一般 PC 分开网域
3.1.1-3 Linux 直接联网-让 Linux 直接管理 LAN
3.1.1-4 Linux 放在防火墙后-让 Linux 使用 Private IP
3.1.2 网络媒体选购建议
3.2 本书使用的内部联机网络参数与通讯协议
3.2.1 联机参数与通讯协议
3.2.2 Windows 个人计算机网络设定范例
3.3 针对本文的建议：http://phorum.vbird.org/viewtopic.php?p=112104
3.1 局域网络的联机
谈完了第二章网络基础后， 现在就让我们实际的来将家里或者小型企业内部的全
部计算机给他连接起来吧！ 当然啦，我们这里主要介绍的是小型局域网络的架构，如
果是比较大型的企业内部， 那么将‘配线盘、线路设计、墙上网络孔’分别拆开施工
的结构化布线会比较妥当。 不过，结构化布线并非本文所想要讨论的，如果你的企业
有需求的话，可以向专业人士寻求协助， 举例来说，酷学园
(http://phorum.study-area.org)的 ZMAN 兄就是一位很棒的网络布线专家。无论如何，
先来将所有的网络硬件联机起来吧！
3.1.1 局域网络的布线规划
从前一章的数据探讨中，你现在应该已经知道局域网络的定义了。大部分狭义的定
义中， 都将局域网络定位在一个以星形联机连接的实体网络中，再透过 IP 网段来连
接在一起的情况。 所以啦，这个联机是怎么连接在一块的，以及 IP 网段是如何规划
的，就显的非常重要啰！
PI:EMAIL
记得以前听 ZMAN 大哥某场演讲的时候提到，网络布线是‘数十年大计’中最重要
的一环， 因为‘服务器主机能力不够时换主机就好了，Switch 交换力不足时换 switch
就好了， 但如果布线不良，难道要拆掉房子将管线挖出来重新安装设定？’所以说， 最
初规划的布线严谨度真的会影响到未来网络的分布情况啊！
所以说，如果你的企业‘整栋大楼需要重新布线’时，真的非常建议你务必要找寻
专业网络布线专家帮忙设计规划， 因为连一个小小的机柜配线箱都有大学问～设计的
好的话，每部独立的主机要改线路、 要换插孔都变的很简单！而且主机到墙上插孔的
距离也会变的很短，维护也会很方便！线段也会很美观！ 当然啦，如此一来，网络线
材的选择也就不能够用太差的！而且网络布线经过折角区时，也需要特别留意施工呐。
但是本文讨论的是一些比较小的局域网络环境，这样的环境可以是在一间办公室内
而已， 所以我们这里谈到的大多是比较单纯的布线状态，并没有考虑到办公室外部的
环境， 所以参考本文时，请特别留意这种差异性喔！
在这样单纯的环境中，我们可以利用一个以 switch 为中心来串连所有设备的星形
联机 (star topology) 架构来设计我们的局域网络啊！在这样的环境中你需要担心的
是‘那我的 Linux 服务器要放在那个地方？’会考虑 Linux 服务器是因为鸟哥假设你
需要在你的局域网络内架设对 Internet 开放网络的服务！ 而 Linux 是否具有
Public IP 对于主机的维护与设定的复杂度有很大的影响，所以当然需要考虑啰！ 底
下鸟哥以目前在台湾挺流行的 ADSL 利用电话线路上网的环境来说明几种联机状态。
在底下的环境当中，鸟哥假设我们仅有一条 ADSL 的对外联机，也就是说， 我们
的 Linux 与一般 PC (不论何种操作系统) 都是透过同一条线连到 Internet 上面去
的。
3.1.1-1 Linux 直接联网-与 PC 同地位
如果你使用的 ADSL 是多 IP 的条件 (例如拨接可以给予 2-8 个 IP 的情况)，
那么最简单的方式就是如下图的联机模式：
PI:EMAIL
图 3.1-1、Linux 服务器取得 public IP 的联机方式之一(具有多个可用 IP 情况)
在这种联机模式当中， Linux 与一般 PC 或打印机都是同等地位，并没有谁比较
‘大尾！’^_^ 如果不急着连上 Internet 时，那么每个设备都给予一个同网域的私有
IP 就可以进行网络联机的工作了，你也可以很快乐的使用打印机或者是网络上的芳邻
等等工作。 此外， Linux 服务器也可以作为内部的文件服务器或者是打印机服务器等
等。
当需要连上 Internet 时，每部计算机 (包括 PC 与 Linux 主机) 都可以自己直
接透过拨接连上， 而由于拨接是在每部机器上面‘额外增加一个实体的 ppp0 接口’，
此时，你的系统内就会有两个可以使用的 IP 了 (一个是 public 一个是 private IP)。
因此， 拨接上网之后每部主机还是可以使用原有的局域网络内的各项服务，而无须更
动原本设定妥当的私有 IP 。 这样的情况对于一般家庭使用者来说，可以算是最佳的
解决方案啦！因为如果你的 Linux 主机挂点时， 其他个人的 PC 是不会被影响的！
不过这样的环境对于小型企业主来说，却不好管理。因为无法掌握每个员工实际上
网的情况， 而且对于防火墙来说，‘根本就是一个没有防火墙的环境’，所以， 是没
有办法对员工进行任何实际网络的掌控的，并且由于网络内外部 (LAN 与外部环境) 并
没有明确的分开，网管人员对于进入客户端的封包是没有任何管理的能力， 所以对于
网络安全来说，是很难管控的一种环境啊！因此对于企业来说，不建议这种环境。
3.1.1-2 Linux 直接联网-与一般 PC 分开网域
如果你有多个可用的 public IP ，并且你的 Linux 服务器主要是提供 Internet
的 WWW 或 mail 服务， 而不是作为内部的文件服务器之用，那么将 Linux 服务器与
内部的网域分开也是个可行的方法， 而且 Linux 拥有 public IP，在设定与维护上面
也不困难，如下所示：
PI:EMAIL
图 3.1-2、Linux 服务器取得 public IP 的联机方式之二(具有多个可用 IP 情况)
所有的 LAN 内的计算机与相关设备都会在同一个网域内，所以在 LAN 内的传输速
度是没有问题的， 此外，这些计算机要连出至 Internet 时，必须要透过 IP 分享器，
所以你也可以在 IP 分享器上面设定简单的防火墙规则， 如果 IP 分享器可以换更高
阶的设备时，那么你就可以在该设备上面架设规则较为完整的防火墙， 对于内部主机
有相当程度的管理，并且好维护啊！
3.1.1-3 Linux 直接联网-让 Linux 直接管理 LAN
如果你不想要购买 IP 分享器的话，那么直接利用 Linux 服务器来管理就好了啊！
那么你可以这样布线：
图 3.1-3、让 Linux 管理 LAN 的布线情况
PI:EMAIL
这种情况下，不论你有多少个 IP 都可以适用的，尤其是当你只有一个 public IP
时，就非得使用这种方式不可了。 让 Linux 作为 IP 分享器的功能相当的简单，同时
Linux 必须具备两张网络卡，分别是对外与对内， 由于 Linux 依旧具有 public IP ，
所以在服务器的设定与维护上相当的简单，同时 Linux 服务器可以做为内部网域对外
的防火墙之用，由于 Linux 防火墙的效能挺不错加上设定也很简单，功能却也是很不
错的！ 因此，网络管理人员也较能进行较完善的掌控，并且， Linux 服务器也要比高
阶的硬件防火墙便宜多了！ ^_^ 鸟哥个人是比较喜好这种方式的联机啦！
不过，我们都知道‘服务器提供的网络服务越单纯越好’， 因为这样一来主机的
资源可以完全被某个程序所使用，不会互相影响，而且当主机被攻击时， 也比较能够
立即了解是那个环节出了问题。但是如同图 3.1-3 的状况来说的话，由于内部的 LAN
是需要通过 Linux 才能联机出去，所以 Linux 挂点时，整个对外联机就挂了，此外，
Linux 的服务可能就太复杂了点，可能会造成维护上的困难度。 但对于小型区网来说，
图 3.1-3 这种架构还是可以应付的来的啦！
3.1.1-4 Linux 放在防火墙后-让 Linux 使用 Private IP
我们可以将 Linux 服务器放在 LAN 后面喔！瞎密？我们的 Linux 主机放在 LAN
里面？有没有搞错啊？没搞错啊～ 比较大型的企业通常会将他们的服务器主机放置在
机房内，主要是在 LAN 的环境下， 再透过防火墙的封包重新导向的功能，将来自
Internet 的封包先经过防火墙后才进入到服务器， 如此一来可在防火墙端就砍掉一堆
莫名其妙的侦测与攻击，当然会比较安全啊！ 这种架构还依防火墙的多寡而又可分为
非军事区 (DMZ) 的配置，不过，太麻烦了～不建议初学者直接使用。 底下我们仅介绍
较简单的架构来说明：
图 3.1-4、Linux 主机放在 LAN 里面的布线情况
这里我们以一个较简单的图示来说明，所以利用的还是 IP 分享器，可能的话， 你
可以将 IP 分享器换成 Linux 主机来架设防火墙，也是一个不错的选择啊！ 反正现在
PI:EMAIL
计算机天天在升级，升级后的旧配备其实就可以作为 Linux 防火墙之用了！ 反正防火
墙又不需要什么硬盘与强效的显示或者 CPU， 只要有不错的网络接口就能够达到不错
的防火墙效能了。
不过这里得再次的强调， Linux 服务器主机若放在 LAN 里面 (使用 private IP)，
则当你要对 Internet 提供网络服务时， 防火墙的规则将变的相当复杂，因为需要进
行封包转递的任务，在某些比较麻烦的协议当中， 可能会造成设定方面的困扰。所以，
在你初接触 Linux 服务器时， 不建议新手使用这种联机架构，避免由于失去信心而没
有动力学习～(@_@)。
每种联机的方式都有其适用的使用者群，所以没有那个是比较好的，完全是看你自
己的网络环境而定喔！ OK！我们现在知道要连上以太网络组成的局域网络，就得要有
网络卡、网络线、网络集中媒体(hub/switch)、 连上 Internet 的调制解调器等等，
在这里鸟哥将防火墙、路由器等等设备归类为主机， 因为基本上，这些组件内部一定
会含有一个网络卡，只是操作系统的精简程度与软件功能的不同就是了。 那么这些所
需要的网络硬件又该如何挑选呢？
3.1.2 网络媒体选购建议
在开始底下的介绍之前，你必须要对于跳线、并行线、RJ-45 网络线、Hub/Switch
的优劣等等有一定程度的了解，请再前往第二章网络基础看一看。 此外，不在我们局
域网络内的设备，例如调制解调器，那就得向你的 ISP 询问了！一般来说， 调制解调
器是中华电信提供给用户的，然而由于‘中华电信因为不同批次安装的调制解调器模块
不同， 所以会有不一样的连接与线材处理方式！’(跳线与并行线的差异喔！) 所以请
特别向你的 ISP 询问才行。底下主要针对局域网络内的网络媒体来进行介绍与说明。
 主机硬件系统：考虑使用年限、省电、虚拟技术等
过去我们都觉得旧的计算机拿来安装 Linux ，作为一个 Linux server 挺不错。后来鸟哥
发现，很多旧计算机其实已经超过使用年限， 硬要使用有点问题，因为电子零件恐怕会撑
不了太久的运作时间。而且，某些时刻生产的主机其实非常耗电！现在我们都强调要节能减
碳嘛！ 所以，可以购买省电型的计算机主机，并且 CPU 含有虚拟化能力的更好。如此一来，
不但比较省电，而且一部主机可以透过虚拟化的功能， 仿真出多部操作系统同时运作的环
境，真正达到节能减碳的目的，那样也是很好的选择呦！
不过，选购什么主机配备与该主机即将运作的服务其实是有关系的，例如防火墙系统与 DHCP
等服务并不需要很强的主机， 但是 Proxy 及 SQL 等服务器就得要强而有力的主机系统，
甚至得要磁盘阵列的辅助会比较好！鸟哥在后续的章节所要介绍的服务， 大多仅是企业内
部或者是外部很轻松的服务，并不需要什么强效的主机系统，因此目前的双核心入门级机种，
已经非常棒了！ 所以啰，花太多时间在介绍主机硬件就变的没有什么意义！你只要记得，
新购买主机时，最好选有伪指令集的 CPU 即可。
PI:EMAIL
 Linux 操作系统：考虑稳定、可网络升级、能够快速取得协助支持
你可以将目前的 distribution 分成两大类，一类是多功能新鲜货，例如 Fedora ， 一种
是强调性能稳定但软件功能较旧的企业用途货，包括 RHEL, CentOS, SuSE 及 B2D 等！
一般来说，我们会建议你如果想要架设服务器时，尽量选择‘稳定性较高的企业版’较佳，
因为功能新且强的版本例如 Fedora 由于太强调新鲜货，所以核心与软件的变动情况较为频
繁， 那就很容易造成一些困扰，因为很多用户自行安装的软件可能无法在新的核心上面跑，
所以，只要核心一升级，哇！很多需要编译的软件就都需要再重新编译过！有点麻烦就是了。
由于鸟哥用惯了 RPM 以及 Red Hat 系统的关系，所以在这里推荐你使用
RHEL/CentOS/SuSE 这几个 Linux distributions，因为他够稳定且设定上面不难。不过，
里面的软件版本可能就不会是最新的， 这点你可能就得要自行设法啰！比较特别的是
CentOS，他不但标榜完全相同于 RHEL ，并且可以直接透过 yum 这个软件进行完整版本的
网络升级，既不会影响到原有的设定，升级时所花费的时间又短，所以， 目前鸟哥都是以
这个版本来进行服务器的架设啊！
 网络卡：考虑服务器用途、内建与否、驱动程序的取得等
一般来说，目前的新主机几乎都是内建 gigabit 的以太网络卡了，所以你不需要额外购买
网络卡。 不过，使用内建的网络卡时，你得要注意到该网络卡是否为特殊的网络芯片，根
据以往的经验，内建的网络卡通常是芯片较特殊的， 所以可能导致 Linux 预设的网卡驱动
程序无法顺利的驱动该网络卡，那就比较累了～因为你必须要额外的安装网卡驱动程序之后，
才能够顺利的使用该款网络卡哩。
如果是想要作为 Linux 服务器的话，那么你的网络卡可能必须要购买好一点的。举例来说，
某些主板内建便宜的 gigabit 网络接口，但越便宜的网络接口可能会造成损耗较多的 CPU
资源，如果能够购买类似 Intel/3Com 等知名品牌的 gigabit 适配卡，不但传输较为稳定，
并且可以降低系统资源的耗费，是有一定程度的帮助的。另外，如果强调高速的话， 甚至
可以选用 PCI-Express 的网络卡，而不使用传统的 PCI 接口。因为 PCI-Express 的传输
带宽更高。
Tips:
你知道吗？鸟站 (http://linux.vbird.org) 使用的主机硬件是旧
式的 AthlonXP 2000+， 内存也仅有 1.5G ，使用的网络卡则是早
期的 3Com 3c905C 芯片，速度仅有 10/100 Mbps。但是，使用到目