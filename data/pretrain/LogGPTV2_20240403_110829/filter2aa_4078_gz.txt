蠕虫给网络安全带来了 空前的风险。 它们包含的破坏潜力与其他恶意代码对象相同 ， 并且还具
有额外的手段， 也就是不需要任何人为干预就可 以传播自己 。
625
626
CISSP 官方学 习指南(第 7 版)
互联网蠕虫是互联网上发生的首例主要的计算机安全事件。 从那时起， 成百上千个新的蠕虫(带
有成千上万个变种)开始在互联网上散播它们 的破坏力量。
1. Code Red 蠕虫
在 200 1 年夏天， 当 Code Red 蠕虫在未安装补丁程序的 Microsoft Internet Information Server但S)
Web 服务器之间快速传播时， 受到了 媒体的极大关注。 Code Red 在被其惨透的系统中执行下列三种
恶意动作 :
• 随机选择成百上千的 IP 地址， 并且随后探测这些主机， 查看这些主机是否运行存在漏洞的
IIS 版本。 任何被找出 的系统都很快被破坏。 因为每个被感染的主机继续寻找很多新 目 标，
Code Red 的破坏范围也就随之显著扩大 了 。
• 破坏本地 Web 服务器上的 HTML 页面， 并且将正常的内容替 换为如下所示 的文本 :
Welcome to http : / /www . wo rm . com !
HackedBy Ch工nese !
• 向 系统植入一个逻辑炸弹， 这个逻辑炸弹将向 E 地址 1 98. 1 37.240.9 1 发起拒绝服务攻击，
该地址在当时属于驻留 白 宫主页的 Web 网站服务器。 反应敏捷的政府 Web 站点管理员在实
际攻击发生之前便改变 了 白宫的 IP 地址 。
互联网蠕虫、 Code Red 及其详多变种的破坏力量给现代互联网带来 了极大的风险。 系统管理员
必须确保他们为连接 Internet 的系统使用 了软件供应商所发布的适当的安全补丁。 针对 Code Red 利
用 的 IIS 漏洞的安全补丁在蠕虫攻击互联网之前一个月 左右就己由 Microsoft 发布， 如果安全管理员
迅速地安装了 这个补丁 ， 那么 Code Red 将会是一种失败的病毒 。
RTM 与互联网蠕虫
1988 年 1 1 月 ， 一位年轻的名 叫 Robert Tappan Morris 的计算机专业学生， 仅仅利用 几行计算机
代码就使得刚 刚起步的互联网遭受重创 。 他宣称由他作为实验制造的一个恶意蠕虫被意外地梓放到
了 互联网上， 很快这个蠕 虫 就传播并破坏 了 大量 的 系 统。
如下所示， 这个蠕 虫 通过利用 Unix 操作系统4 个特殊的安全漏洞进行传播:
Sendmail 调试模式 当 时流府的 Sendrnail 软件包的最新版本羊皮用 于在王联网上对电子邮件进
行路由 ， 但是它却包含一个安全漏洞。 这个漏洞准许蠕虫通过向远程系统上的 Sen也nail 程序友送特
殊的 、 包含蠕 虫 代码的破坏性电子邮件来传播 自 己。 远程 系 统在处理邮件时就会被感染 。
密码攻击 这个蠕虫还使用 了 字典攻击， 通过使用 一个有效系统用 户 的用 户 名和密码来试图获
得对远程 系 统的访问权限(本章后 面部分将介绍字典攻击 的 更多 内 容)。
finger 漏洞 流行的互联网 实用程序 :finger 准许用 户 决定谁可以登录到远程系统。 当 时沈行的
fmger 软件的最新版本包含一个缓冲 区溢出漏洞 ， 这个漏洞使得蠕虫 能够进行传播(本章稍后部分将
对缓冲 区溢出进行详细讨论)。 自 此， finger 程序就从大多 数连接王联网的系 统上被删除了 。
信任关系 在感染 系 统后 ， 这个蠕虫分析 了 网络中该系统与 其他系统之间存在的信任关 系 ， 并
且试图通过可信路径传播至这些 系 统。
多 分支的方式使得互联网蠕虫 变得极为危险。 幸运的是， 计算机安全组织很快组织 了 一个研究
小组， 他们解除了 互联网蠕虫的危险， 并且为受影响的系统开发了 补丁程序。 由 于王联网蠕虫存在
一些低效的代码 ， 进而限制 了 自 身 的传播速度， 因 此研究 小组的工作变得容 易 了 许多 。
第 21 章 恶意代码与应用攻击
由 于法律执行机构和法院系统在处理计算机犯罪方面缺少经验， 因 此 Morris 只为其犯罪行为受
到轻微控诉。 根据 1986 年的计算机违法犯罪法案(Computer Fraud and Abuse Act) ， 他被判三年缓刑 、
400 小 时的社区服务和一万美元的罚款。 具有讯刺意味的是， 在事件发生时， Morris 的 父亲 Robert
Morris 走国 家安全机构(NSA)下属国 家计算机安全中 心(NCSC)的 主管 。
2. 震 网病毒
在 2010 年年中 ， 名 为震网(Stuxnet)的蠕虫在互联网上出现。 这种高度复杂的蠕虫使用各种高级
技术来传播 ， 包括多 个 以前未记录的漏洞。 震 网病毒使用 以 下传播技术:
• 在本地网络上搜索未受保护的 管理共享系统
• 利用零 日 漏洞攻击 Windows 服务器上的服务和打印机后 台处理程序
• 使用默认的数据库密码连接系统
• 使用共享的 USB 设备进行传播
震网病毒在从一个系统传播到另一个系统的过程中， 系统本身不受伤害， 它实际上是在寻找一
种特殊类型的系统一-使用 由西门子制造的控制器系统， 据称是用于生产核武器材料的系统。 当发
现这样的系统时， 它会执行一系列 旨在摧毁连接到西 门 子控制器离心机的动作 。
震网病毒似乎从中 东开始传播， 特别是位于伊朗的系统。 据称， 它是由西方国家设计的， 意 图
破坏伊朗核武器计划 。 根据 《纽约时报》 的一个故事， 以色列的一个设施包含用于测试蠕虫的设备。
故事说 " 以色列己经开发了与伊朗几乎完全相同 的核能离心机"， 并继续说 "那里的运行以及在美
国 的相 关努力都是一一该病毒被设计 为美国和 以色列项 目 的线索， 意 图破坏伊朗核方案"。
如果这些指控是真实的， 震网病毒标志着恶意代码世界里的两个主要演变: 使用蠕虫对设施造
成严重的物理损坏 ， 以及在国 家之 间 的战争中 使用恶意代码。
21 . 1 .6 间谍软件与广告软件
在正常使用计算机时， 我们还会遇到其他两种不希望的软件干预类型。 间谍软件会监控你的动
作 ， 并且向暗中监视你活动的远程系统传送重要的细节。 例如， 间谍软件可能等待你登入某个银行
站点， 随后将你的用户 名和密码传送给间谍软件的创作者。 此外， 间谍软件也可能等待你在某个电
子商务站点输入信用卡号， 然后将卡号传送给在黑市进行贩卖交易 的骗子。
广告软件在形式上与间谍软件极为相似， 只 是具有不同的 目 的。 广告软件使用多种技术在被感
染的计算机上显示广告。 最简单的广告软件形式会在你连接 Web 时在屏幕上显示弹出式广告。 更恶
毒 的广告软件版本可能会监控你的购物行为并将你重定向至竞争者的 Web 站点。
注意 :
广告软件和恶意软件的作者通常利用 流行的王联网 工具的第二方插件(如 Web 浏 览器)来传播其
恶意 内 容。 他们发现插件 已经具有强 大的用 户 基础， 这些插件被投予权限在他们的浏览器内运行和/
或获取他们的信息。 然后他们用原始插件代码补充恶意代码， 这些代码散布恶意软件 、 窃取信息或
执行其他不 必要的活动。
627
CISSP 官方学 习指南(第 7 版)
2 1 . 1 .7 对策
针对恶意代码的主要防护手段是使用反病毒过滤软件。 这些软件包主要是特征型系统， 它们被
设计用于检测在系统中运行的 己知病毒。 如下所示， 至少在三个关键区域考虑实现反病毒过滤是非
常明智的。
客户端系统 : 网络中 的每个工作站都应当通过更新的反病毒软件在本地文件系统中查找恶意
代码。
服务器系统: 服务器应当具有类似的防护。 因为公用服务器上的一个病毒会迅速在整个网络内
传播， 所 以保护服务器系统 比保护客户端系统更为重要。
内容过滤器: 目 前的大多数病毒都通过互联网传播。 继续在网络上根据恶意代码的特征， 对入
站和 出 站 电子邮件 以及 Web 流量进行内 容过滤 ， 是非常明智的做法。
注意 :
利用 当 前的反病毒软件， 往往能够在发现恶意代码后的敖个小 时内执行去除操作。 去除操作会
删除恶意代码， 但是并不修复恶意代码导致的损坏。 往往能够在发现恶意1v马数天之后使用 清除功
能 。 清除操作不仅能够删 除恶意代码 ， 而且还 能够修复恶意代码导致的损坏。
警告 :
需要记住的是， 大多数反病毒过滤器都是特征型软件。 因此， 反病毒过滤软件只有在病毒定义
文件是最新时才能有效运作。 定期更新这些文件至关重要， 尤其在王联网上出现新的 高风险恶意代
码特征时更是如此。
特征型过滤器依赖于软件开发人员提供的对己知病毒的描述。 因此， 任何指定病毒从第一次现
身网络到更新过滤器之间存在一定的时间周期。 目 前 ， 有两种常用 的解决方案能够解决这个问题:
• 使用完整性检查软件(例仔例t蜘如 Tri甲pw阳1町reι， 在 WWW.tr且住的叫1ψp阳阳wire比削e怠ω.启吨O
628
件系统中意夕外卡的 更改并定期报告 。
• 应 当严格地维护和实施访问控制， 从而限制恶意代码破坏数据和在网络上传播的能力。
此外 ， 下列三种额外的技术能够专 门 防止系统受到活动 内容内嵌的恶意代码的感染:
• Java 的沙箱技术为 applet 提供了一个隔离的环境， 在这个环境中 ， applet 不需要访问关键的
系统资源就能够安全地运行。
• ActiveX 控件签名技术利用数字签名系统来确保代码来 自 可信源。 最终用户需要确定通过身
份认证的来源是否可信 。
• 操作系统级别的应用程序 白 名单要求管理员指定批准的应用程序。 操作系统使用此列衰，
仅允许 己知的 良好应用程序运行。
要对数字签名进行深入理解 ， 请查看第 7 章 " PKl 和 密码学应用 " 中 的 内容。
许多形式的恶意代码利用零 日漏洞一一被黑客发现的安全漏洞， 这些漏洞尚未得到彻底解决。
系 统受到这些漏洞影响 的两个主要原因是:
• 在发现新型恶意代码和发布补丁及更新病毒特征库之间的时间拖延
• 在系统管理期间应用更新缓慢
零 日漏洞的存在， 使得必须在组织中拥有强大的补丁管理程序 ， 确保应用及时更新。 此外， 可
第 21 章 恶意代码与应用攻击
能希望使用漏洞扫描程序定期扫描系统来查找 己知的安全问题。
21 .2 密码攻击
攻击者用于获得对系统的非法访问 的最简单技术之一是: 获悉己授权系统用户的用 户名和密码。
一旦作为正常用户获得访问权限， 那么攻击者就会在系统中具有立足之地。 此时， 攻击者可以使用
其他技术(包括 r∞tkit 软件包) 自 动获取增强级别的系统访问权限(参看本章稍后的 " 权限提升和
rootkit" 部分)。 攻击者还可能将受到危害的系统作为跳板 ， 从而攻击相 同网络中其他更加诱人的
目 标。
下面几节分析了 攻击者用于获悉合法用户 密码并访问系统的三种方法: 密码猜测攻击、 字典攻
击和社会工程学攻击。 很多这些类型的攻击依赖于脆弱的密码存储机制 。 例如， 许多 Unix 操作系统
在/etc/passwd 文件中存储用户 密码的加密版本。
21 .2. 1 密码猜测攻击
在这种最基本的密码攻击类型中， 攻击者只是试图猜测用户 的密码。 无论进行了 多少次安全性