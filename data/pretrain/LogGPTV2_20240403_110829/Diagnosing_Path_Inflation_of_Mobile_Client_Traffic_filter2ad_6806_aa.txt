title:Diagnosing Path Inflation of Mobile Client Traffic
author:Kyriakos Zarifis and
Tobias Flach and
Srikanth Nori and
David R. Choffnes and
Ramesh Govindan and
Ethan Katz-Bassett and
Zhuoqing Morley Mao and
Matt Welsh
Diagnosing Path Inﬂation of Mobile Client Trafﬁc
Kyriakos Zariﬁs1, Tobias Flach1, Srikanth Nori1, David Choffnes2,
Ramesh Govindan1, Ethan Katz-Bassett1, Z. Morley Mao3, and Matt Welsh4
1 University of Southern California, Los Angeles, CA 90089, USA
{kyriakos,flach,snori,ramesh,ethan.kb}@usc.edu
2 Northeastern University, Boston, MA 02115, USA
PI:EMAIL
3 University of Michigan, Ann Arbor, MI 48109, USA
PI:EMAIL
4 Google Inc., Mountain View, CA 94043, USA
PI:EMAIL
Abstract. As mobile Internet becomes more popular, carriers and content provi-
ders must engineer their topologies, routing conﬁgurations, and server deploy-
ments to maintain good performance for users of mobile devices. Understanding
the impact of Internet topology and routing on mobile users requires broad, longi-
tudinal network measurements conducted from mobile devices. In this work, we
are the ﬁrst to use such a view to quantify and understand the causes of geograph-
ically circuitous routes from mobile clients using 1.5 years of measurements from
devices on 4 US carriers. We identify the key elements that can affect the Internet
routes taken by trafﬁc from mobile users (client location, server locations, car-
rier topology, carrier/content-provider peering). We then develop a methodology
to diagnose the speciﬁc cause for inﬂated routes. Although we observe that the
evolution of some carrier networks improves performance in some regions, we
also observe many clients - even in major metropolitan areas - that continue to
take geographically circuitous routes to content providers, due to limitations in
the current topologies.
1 Introduction
As mobile Internet becomes more popular, carriers and content providers must engi-
neer their topologies, routing conﬁgurations, and server deployments to maintain good
performance for users of mobile devices. A key challenge is that performance changes
over space and time, as users move with their devices and providers evolve their topolo-
gies. Thus, understanding the impact of Internet topology and routing on mobile users
requires broad, longitudinal network measurements from mobile devices.
In this work, we are the ﬁrst to identify and quantify the performance impact of
several causes for inﬂated Internet routes taken by mobile clients, based on a dataset of
901,000 measurements gathered from mobile devices during 18 months. In particular,
we isolate cases in which the distance traveled along a network path is signiﬁcantly
longer than the direct geodesic distance between endpoints. Our analysis focuses on
performance with respect to Google, a large, popular content provider that peers widely
with ISPs and hosts servers in many locations worldwide. This rich connectivity allows
M. Faloutsos and A. Kuzmanovic (Eds.): PAM 2014, LNCS 8362, pp. 23–33, 2014.
c(cid:2) Springer International Publishing Switzerland 2014
24
K. Zariﬁs et al.
us to expose the topology of carrier networks as well as inefﬁciencies in current routing.
We constrain our analysis to devices located in the US, where our dataset is densest.
Our key results are as follows. First, we ﬁnd that path inﬂation is endemic: in the last
quarter of 2011 (Q4 2011), we observe substantial path inﬂation in at least 47% of mea-
surements from devices, covering three out of four major US carriers. While the average
fraction of samples experiencing path inﬂation dropped over the subsequent year, we
ﬁnd that one ﬁfth of our samples continue to exhibit inﬂation. Second, we classify root
causes for path inﬂation and develop an algorithm for identifying them. Speciﬁcally,
we identify whether the root cause is due to the mobile carrier’s topology, the peer-
ing between the carrier and Google, and/or the mapping of mobile clients to Google
servers. Third, we characterize the impact of this path inﬂation on network latencies,
which are important for interactive workloads typical in the mobile environment. We
show that the impact on end-to-end latency varies signiﬁcantly depending on the carrier
and device location, and that it changes over time as topologies evolve. We estimate
that additional propagation delay can range from at least 5-50ms, which is signiﬁcant
for service providers [4]. We show that addressing the source of inﬂation can reduce
download times by hundreds of milliseconds. We argue that it will become increasingly
important to optimize routing as last-mile delays in mobile networks improve and the
relative impact of inﬂation becomes larger. Last, we make our dataset publicly available
and provide an online tool for visualizing our network performance data.
2 Background and Related Work
Background. As Internet-connected mobile devices proliferate, we need to understand
factors affecting Internet service performance from mobile devices. In this paper, we
focus on two factors: the carrier topology, and the routing choices and peering arrange-
ments that mobile carriers and service providers use to provide access to the Internet.
The device’s carrier network can have multiple Internet ingress points — locations
where the carrier’s access network connects to the Internet. The carrier’s network may
also connect with a Web service provider at a peering point — a location where these
two networks exchange trafﬁc and routes. The Domain Name System (DNS) resolvers
from (generally) the carrier and the service provider combine to direct the client to a
server for the service by resolving the name of the service to a server IP address.
Idealized Operation. This paper focuses on Google as the service provider. To under-
stand how mobile devices access Google’s services, we make the following assump-
tions about how Google maps clients to servers to minimize latency. First, Google has
globally distributed servers, forming a network that peers with Internet service provider
networks widely and densely [2,5]. Second, Google uses DNS to direct clients (in our
case, mobile devices) to topologically nearby servers. Last, Google can accurately map
mobile clients to their DNS resolvers [6]. Since its network’s rich infrastructure aims
at reducing client latency, Google is an excellent case study to understand how carrier
topology and routing choices align with Google’s efforts to improve client performance.
We use Fig. 1 to illustrate the ideal case of a mobile device connecting to a Google
server. A mobile device uses DNS to look up www.google.com. Google’s resolver
Diagnosing Path Inﬂation of Mobile Client Trafﬁc
25
User Cell Tower
Ingress
Metro Area
Internet
Peering
Server
Fig. 1. Optimal routing for mobile clients
returns an optimal Google destination based on a resolver-server mapping. Trafﬁc from
the device traverses the carrier’s access network, entering the Internet through an ingress
point. Ideally, this ingress point is near the mobile device’s location. The trafﬁc enters
Google’s network through a nearby peering point and is routed to the server.
In this paper, we identify signiﬁcant deviations from this idealized behavior. Specif-
ically, we are interested in metro-level path inﬂation [10], where trafﬁc from a mobile
client to a Google server exits the metropolitan (henceforth metro) area even though
Google has a presence there. This metro-level inﬂation impacts performance by in-
creasing latency.
Example Inﬂation. Carrier topology determines where trafﬁc from mobile hosts enters
the carrier network. Prior work has suggested that mobile carriers have relatively few
ingress points [11]. Therefore, trafﬁc from a client in the Los Angeles area may enter the
Internet in San Francisco because the carrier does not have an ingress in Los Angeles.
If the destination service has a server in Los Angeles, the topology can add signiﬁcant
latency compared to having an ingress in LA. Routing conﬁgurations and peering ar-
rangements can also cause path inﬂation. As providers move services to servers located
closer to clients, the location where carriers peer with a provider’s network may signiﬁ-
cantly affect performance. For instance, if a carrier has ingress points in Seattle and San
Francisco, but peers with a provider only in San Francisco, it may route Seattle trafﬁc
to San Francisco even if the provider has a presence in Seattle.
Related Work. Research showed 10 years ago that interdomain routes suffer from
path inﬂation particularly due to infrastructure limitations like peering points only at
select locations, but also due to routing policies [8]. In recent work, researchers in-
vestigated reasons for suboptimal performance of clients of Google’s CDN, showing
that clients in the same geographical area can experience much different latencies to
Google’s servers [4,12]. Cellular networks present new challenges and opportunities
for studying path inﬂation. One study demonstrates differences in metro-area mobile
performance but does not investigate the root causes [7]. Other work shows that routing
over suboptimal paths due to lack of nearby ingress points causes a 45% increase in
RTT latency because of the additional distance traveled, compared to idealized rout-
ing [1]. We show how topologies and path inﬂation have evolved, and that ingress point
location is only one of several factors that can affect performance.
3 Dataset
Data Collected. Our data consists of network measurements (ping, traceroute, HTTP
GET, UDP bursts and DNS lookups) issued from Speedometer, an internal Android app
developed by Google and deployed on thousands of volunteer devices. Speedometer
26
K. Zariﬁs et al.
conducts approximately 20-25 measurements every ﬁve minutes, as long as the device
has sufﬁcient remaining battery life (80%) and is connected to a cellular network.1
Our analysis focuses on measurements toward Google servers including 310K tracer-
outes, 300K pings and 350K DNS lookups issued in three three-month periods (2011
Q4, 2012 Q2 and Q4). We focus on measurements issued by devices in the US, where
the majority of users is located, with a particular density of measurements in areas with
large Google ofﬁces. All users running the app have consented to sharing collected data
in an anonymized form.2 Some ﬁelds are stripped (e.g. device IP addresses, IDs), oth-
ers are replaced by hash values (e.g. HTTP URLs). Location data is anonymized to the
center of a region that contains at least 1000 users and is larger than 1 km2.
The above measurements are part of a dataset that we published to a Google
Cloud Storage bucket and released under the Creative Commons Zero license3. We
also provide Mobile Performance Maps, a visualization tool to navigate parts of the
dataset, understand network performance and supplement the analysis in this paper:
http://mpm.cs.usc.edu.
Finding Ingress Points. In order to identify locations of ingress points, for each carrier,
we graphed the topology of routes from mobile devices to Google, as revealed by the
traceroutes in our dataset. We observe that traceroutes from clients in the same regions
tend to follow similar paths. We used the DNS names of routers in those paths to identify
the location of hops at which they enter the public Internet. In general, the traceroutes
form well-deﬁned structures, starting with private or unresolvable addresses, where all
measurements from a given region reach the Internet in a single, resolvable location,
generally a point of presence of the carrier’s backbone network. We deﬁne this location
as the ingress point.
Finding Peering Points. To infer peering locations between the carriers and Google,
we identiﬁed for each path the last hop before entering Google’s network, and the ﬁrst
hop inside it (identiﬁed by an IP address from Google’s blocks). Using location hints
in the hostnames of those hop pairs, we infer peering locations for each carrier [9]. In
cases where the carrier does not peer with Google (i.e., sends trafﬁc through a transit
AS), we use the ingress to Google’s network as the inferred peering location.
4 A Taxonomy of Inﬂated Routes
Types of Path Inﬂation. Table 1 shows, for traceroutes in our dataset from the four
largest mobile carriers in the US, the fraction of routes that incurred a metro-level path
inﬂation.
For three of the four carriers, more than half of all traceoutes to Google experienced
a metro-level deviation in Q4 2011. Further, nearly all measurements from AT&T cus-
tomers traversed inﬂated paths to Google. Note that these results are biased toward
locations of users in our dataset and are not intended to be generalized. Nevertheless, at
a high-level, this table shows that metro-level deviations occur in routes from the four
1 The app source is available at: https://github.com/Mobiperf/Speedometer
2 Google’s privacy and legal teams reviewed and approved data anonymization and release.
3 http://commondatastorage.googleapis.com/speedometer/README.txt
Diagnosing Path Inﬂation of Mobile Client Trafﬁc
27
Table 1. Fraction of traceroutes from major US carriers that show metro-level inﬂation
Q4 2011
Q2 2012
Q4 2012
AT&T Sprint T-Mobile Verizon
0.98
0.98
0.00
0.10
0.21
0.21
0.65
0.25
0.20
0.47
0.15
0.38