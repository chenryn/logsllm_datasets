title:ProjecToR: Agile Reconfigurable Data Center Interconnect
author:Monia Ghobadi and
Ratul Mahajan and
Amar Phanishayee and
Nikhil R. Devanur and
Janardhan Kulkarni and
Gireeja Ranade and
Pierre-Alexandre Blanche and
Houman Rastegarfar and
Madeleine Glick and
Daniel C. Kilper
ProjecToR:	Agile	Reconfigurable	
Data	Center	Interconnect
Monia	Ghobadi
Ratul	Mahajan					Amar	Phanishayee					
Nikhil	Devanur					Janardhan Kulkarni					
Gireeja	Ranade
Pierre	Blanche				Houman	Rastegarfar				
Madeleine	Glick				Daniel	Kilper
Today’s	data	center	interconnects
10Gbps
10Gbps
A
B
C
D
A
B
C
D
Static	capacity	
between	ToR pairs
A					B					C				D
0
3
3
3
3
3
0
3
3
0
3
3
3
3
0
3
A					B					C				D
0
0
0
0
0
0
0
0
0
0
0
0
7
0
0
0
0
0
0
0
0
0
7
0
0
8
0
0
0
0
0
0
0
0
0
0
0
0
0
0
6
0
0
0
6
0
0
0
0
0
0
0
0
0
0
0
0
0
12
0
6
0
0
0
6
0
0
0
0
0
0
0
6
0
0
0
0
0
8
0
A
B
C
D
Ideal	demand	matrix:	
uniform	and	static
Non-ideal	demand	matrix:	
skewed	and	dynamic
2
Need	for	a	reconfigurable	interconnect
Data:
• 200K	servers	across	4	production	clusters
• Cluster	sizes:	100	-- 2500	racks
Observation:
• Many	rack	pairs	exchange	little	trafﬁc	
• Only	some	hot	rack	pairs	are	active
Implication:
• Static	topology	with	uniform	capacity:
• Over-provisioned	for	most	rack	pairs	
• Under-provisioned	for	few	others
Reconﬁgurable	interconnect:	
To	dynamically	provide	additional	capacity	between	hot	rack	pairs
3
Desirable	properties	of	a	reconfigurable	interconnect
Static
Reconfigurable
Optical	switch
A
B
C
D
Observation:	
Implication:	
• Traffic	matrices	differ	widely
• Difficult	to	determine	static	vs.	reconfigurable	divide	
(Seamless	interconnect)
4
Desirable	properties	of	a	reconfigurable	interconnect
Observation:	
Implications:	
•
•
•
Source	racks	send	large	amounts	of	traffic	to	many	other	racks	
Should	create	direct	links	to	lots	of	other	racks	(high	fan-out)
Should	switch	quickly	among	destinations	(low	switching	time)
5
Properties	of	reconfigurable	interconnects
Seamless High	Fan-out Low	switching
Seamless High	Fan-out Low	switching
time
time
Helios, Mordia
Helios, Mordia
[sigcomm’10, sigcomm’13]
[sigcomm’10, sigcomm’13]
3D	Beam	forming,	Flyways
Flyways,	3D	Beam	forming	
[sigcomm’12,	hotnets’09]
[sigcomm’11,	sigcomm’12]
FireFly [sigcomm’14]
FireFly [sigcomm’14]
ProjecToR
Enabler	technology
Enabler	technology
Optical	Circuit	Switch
Optical	Circuit	Switch
60GHz
60GHz
Free-Space	Optics
Free-Space	Optics
Free-Space	Optics
6
ProjecToR interconnect
• Free-space	topology	(seamless)
• 18,000	fan-out		(60	x	more	than	optical	circuit	switches)
• 12	us	switching	time	(2500	x	faster	than	optical	circuit	switches)
Laser
Photodetector
Static	topology
7
7
Reconfiguration	in	a	ProjecToR interconnect
• Digital	micromirror device	to	redirect	light
• Mirror	assembly	to	magnify	reach
8
8
Digital	Micromirror Device	(DMD)
Array	of	micromirrors (10	um)
Memory	cell	
9
Using	DMDs	to	redirect	light
0
0
0
0
1
0
0
0
0
1
1
1
1
0
1
1
1
1
• Theoretical	number	of	accessible	locations:	total	number	of	micromirrors
• 768x768	=	589824
• Cross-talk	between	adjacent	locations
• Achievable	number	of	accessible	locations
• 768x768	/	32	= 18,432
10
Using	mirror	assemblies	to	magnify	reach
• Challenge:	DMDs	have	a	narrow	angular	reach
• Solution:	Coupling	DMDs	with	angled	mirrors	
11
11
Questions	to	answer
• How	feasible	is	a	ProjecToR interconnect?
• Built	and	micro-benchmarked	a	small	ProjecToR prototype
• Robustness	to	environmental	conditions
• How	should	packets	be	routed	in	a	ProjecToR interconnect?
• Devised	a	scheduling	algorithm	and	simulated	its	performance
• How	much	does	a	ProjecToR interconnect	cost?
• Estimated	cost	based	on	cost	break	down	of	each	component
12
Prototype:	A	3-ToR	ProjecToR interconnect
ToR3
ToR2
ToR1
13
Prototype:	A	3-ToR	ProjecToR interconnect
Mirrors	
reflecting	to	
ToR2	and	ToR3
DMD
Source	laser
14
Prototype:	A	3-ToR	ProjecToR interconnect
ToR3
ToR2
ToR1
15
Prototype:	throughput
ProjecToR	Link Wired	Link
F
D
C
1.00
0.80
0.60
0.40
0.20
0.00
8.8
9
9.2
8.9
9.3
TCP	Throughput	(Gbps)
9.1
9.4
16
Prototype:	switching	time
ToR3
ToR2
ToR1
17
Prototype:	switching	time
-10
-15
-20
-25
-30
-35
-40
-45
-50
)
m
B
d
(
r
e
w
o
P
e
v
i
e
c
e
R
ToR	1	->	ToR	2
ToR	1	->	ToR	3
12	us
0
5
10
Time	(us)
15
20
18
Connecting	lasers	and	photodetectors
lasers
photodetectors
ToR1
ToR2
ToR3
ToR1
ToR2
ToR3
ToR1
ToR2
ToR3
ToR1
ToR2
ToR3
dedicated topology
ToR1
ToR2
ToR3
ToR1
ToR2
ToR3
opportunistic links
• Two	topology	approach
• Slow	switching	topology	or	dedicated topology
• Fast	switching	links	or	opportunistic links
19
Routing	packets
2
2
2
2
2
2
2
2
3
3
3
Virtual	output	queues
ToR1
ToR2
ToR3
ToR1
ToR2
ToR3
opportunistic link
dedicated topology
K-shortest	paths	routing
20
Scheduling	opportunistic	links
• Given	a	set	of	potential	links	and	current	traffic	demand,	find	a	set	of	
active	opportunistic	links
ToR1
ToR2
ToR3
ToR1
ToR2
ToR3
s
o
u
r
c
e
d		e		s		t		i		n		a		t		i		o		n
100
0
0
0
100
0
0
0
0
21
Scheduling	opportunistic	links
• Standard	switch	scheduling	problem
• Blossom	matching
• Matrix	decomposition
• Centralized	scheduler
• Single	tiered	matching
0
0
100
s
o
u
r
c
e
d		e		s		t		i		n		a		t		i		o		n
100
0
0
0
100
0
input
output
22
Scheduling	opportunistic	links
• Standard	switch	scheduling	problem
• Blossom	matching
Src ToRs
• Matrix	decomposition
• Centralized	scheduler
• Single	tiered	matching
Decentralized
Two-tiered
Dst ToRs
input
output
Extended	the	Gale-Shapely	algorithm	for	finding	stable	matches	[GS-1962]
Constant	competitive	against	an	offline	optimal	allocation
23
Simulations
Fat	tree
FireFly
ProjecToR
• 128-ToR	(1024	servers)	with	16	lasers	and	photodetectors	
• Day-long	traffic	matrix:	to	build	the	dedicated	topology
• 5-min	traffic	matrix:	to	generate	probability	of	ToR pair	communication
• TCP	flows	arrival	with	poison	arrival	rate	and	realistic	flow	sizes
24
Simulation	results
i
l
e
m
T
n
o
i
t
e
p
m
o
C
w
o
F
e
g
a
r
e
v
A
l
)
s
m
(
40
35
30
25
20
15
10
5
0
20
30
50
60
40
Average	Load	(%)
70
80
FireFly
Fat	tree
95%
ProjecToR
- Slow	switching	time
- Low	fan-out
• Tail	flow	completion	time
• Different	traffic	matrices
- No	reconfigurability
• Impact	of	fan-out	
• Impact	of	switching	time
+	Reconfigurable
+	Switching	time:	12us
+	high	fan-out
25
ProjecToR:	A	reconfigurable	data	center
ToR1
ToR2
ToR3
ToR1
ToR2
ToR3
Seamless,	high	fan-
out,	low	switching	
time	interconnect
Small	prototype	
demonstrates	
feasibility
Decentralized	flow	
scheduling	
algorithm
26