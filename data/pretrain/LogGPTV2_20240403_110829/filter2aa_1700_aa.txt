Christopher	
  Pogue	
  is	
  the	
  Managing	
  Consultant	
  of	
  the	
  SpiderLabs	
  Incident	
  Response	
and	
  Digital	
  Forensics	
  team.	
  Having	
  served	
  as	
  a	
  US	
  Army	
  Signal	
  Corps	
  Warrant	
  Oﬃcer,	
he	
  worked	
  on	
  digital	
  forensic	
  invesIgaIons	
  and	
  as	
  Cyber	
  Security	
  Instructor.	
  Pogue	
joined	
  the	
  IBM	
  Internet	
  Security	
  Systems	
  (ISS)	
  X-­‐Force	
  aPer	
  leaving	
  the	
  military.	
  As	
  a	
PenetraIon	
  Tester	
  and	
  Forensic	
  InvesIgator	
  with	
  IBM,	
  he	
  performed	
  over	
  300	
penetraIon	
  tests	
  and	
  50	
  invesIgaIons.	
  In	
  his	
  role	
  with	
  SpiderLabs,	
  Pogue	
  leads	
  the	
team	
  that	
  performs	
  invesIgaIons	
  all	
  over	
  the	
  United	
  States,	
  Central	
  and	
  South	
America,	
  and	
  the	
  Caribbean	
  Islands.	
  He	
  also	
  assists	
  local,	
  state,	
  and	
  federal	
  law	
enforcement	
  agencies	
  with	
  cases	
  involving	
  digital	
  media.	
Tim	
  MaleIc	
  is	
  a	
  Senior	
  Security	
  Consultant	
  within	
  the	
  PenetraIon	
  TesIng	
  team	
  at	
Trustwave's	
  SpiderLabs.	
  Tim	
  has	
  been	
  working	
  in	
  IT	
  since	
  the	
  birth	
  of	
  the	
  web,	
  and	
has	
  been	
  focused	
  full-­‐Ime	
  on	
  informaIon	
  security	
  since	
  2001.	
  Prior	
  to	
  joining	
Trustwave,	
  Tim	
  held	
  posiIons	
  as	
  Senior	
  UNIX	
  Engineer,	
  Senior	
  Security	
  Engineer,	
  and	
InformaIon	
  Security	
  Oﬃcer.	
1	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
Welcome!	
We’re	
  very	
  excited	
  to	
  have	
  this	
  opportunity	
  to	
  share	
  some	
  ideas	
  about	
  pushing	
  incident	
response,	
  forensics,	
  and	
  penetraIon	
  tesIng	
  to	
  the	
  next	
  level.	
We	
  are	
  honored,	
  and	
  humbled,	
  to	
  present	
  to	
  a	
  DEF	
  CON	
  audience.	
  Our	
  mission	
  is	
  to	
  inspire	
network	
  defenders	
  and	
  a`ackers	
  to	
  work	
  more	
  closely	
  together	
  to	
  make	
  each	
  other	
  be`er.	
We’ll	
  ﬁnish	
  oﬀ	
  the	
  session	
  with	
  a	
  giant	
  group	
  hug	
  and	
  a	
  few	
  rounds	
  of	
  “Kum	
  ba	
  ya”!	
But	
  ﬁrst	
  we’re	
  going	
  to	
  introduce	
  ourselves	
  and	
  our	
  methods	
  and	
  the	
  problems	
  we	
  see	
ourselves	
  trying	
  to	
  address.	
  We’ll	
  then	
  give	
  a	
  quick,	
  advanced	
  introducIon	
  to	
  the	
  forensics	
methodology	
  we	
  call	
  “Sniper	
  Forensics”.	
  We’ll	
  follow	
  that	
  up	
  with	
  our	
  contribuIons	
  to	
  what	
we’re	
  calling	
  the	
  “Real-­‐World	
  PenetraIon	
  TesIng”	
  movement.	
Next	
  we’re	
  going	
  to	
  show	
  how	
  we	
  are	
  applying	
  these	
  ideas	
  in	
  context	
  by	
  stepping	
  through	
some	
  sample	
  a`acks	
  that	
  do	
  and	
  do	
  not	
  exemplify	
  our	
  methods.	
Then	
  we’ll	
  wrap-­‐up	
  with	
  the	
  hugs	
  and	
  songs.	
2	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
3	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
State	
  of	
  IR	
  &	
  Forensics	
• 	
  FighIng	
  the	
  uphill	
  ba`le	
  of	
  completely	
  changing	
  the	
  mindset	
  of	
  the	
  digital	
  forensic	
  discipline	
• 	
  Cops	
  are	
  good	
  at	
  being	
  cops,	
  WE	
  are	
  good	
  at	
  being	
  computer	
  engineers	
  –	
  every	
  so	
  oPen,	
  we	
  get	
hybrids	
  –	
  LEs	
  who	
  are	
  actually	
  techie	
• 	
  Constantly	
  evolving	
  data	
  sample	
  –	
  new	
  systems	
  mean	
  new	
  a`acks	
  –	
  means	
  research	
  –	
  if	
  I	
  haven’t	
seen	
  it	
  before…then	
  what?	
• 	
  Proof	
  of	
  concept	
  exercises	
  with	
  Pentest…opens	
  Forensics	
  up	
  to	
  the	
  larger	
  world	
  of	
  digital	
  whodunit	
State	
  of	
  pentesIng	
• 
We	
  are	
  sploit	
  happy.	
  I	
  use	
  “sploit”	
  to	
  mean	
  exploits	
  that	
  take	
  advantage	
  of	
  memory	
  corrupIon	
bugs.	
  About	
  75%	
  of	
  the	
  stuﬀ	
  living	
  under	
  the	
  exploit	
  tree	
  in	
  metasploit.	
  I	
  am	
  re-­‐appropriaIng	
  the	
term	
  “exploit”	
  to	
  mean	
  all	
  the	
  exploits	
  that	
  aren’t	
  “sploits”.	
  Note	
  that	
  this	
  is	
  usage	
  is	
  running	
opposite	
  to	
  current	
  trends.	
  But	
  I	
  think	
  it’s	
  important.	
  Language	
  shapes	
  our	
  reality.	
  If	
  you	
  heard	
Richard	
  Thieme	
  yesterday	
  then	
  I	
  can	
  rest	
  my	
  case.	
  More	
  on	
  this	
  later.	
• 
I’m	
  going	
  to	
  be	
  arguing	
  throughout	
  this	
  talk	
  that	
  we	
  can	
  –	
  mostly	
  –	
  ignore	
  sploits	
  and	
  instead	
  focus	
on	
  exploits.	
• 
The	
  way	
  we	
  scope	
  and	
  perform	
  and	
  document	
  penetraIon	
  tests	
  are	
  pushing	
  us	
  further	
  and	
  further	
away	
  from	
  modeling	
  real-­‐world	
  a`acks.	
• 
The	
  genesis	
  of	
  the	
  OPFOR	
  idea	
  was	
  simple.	
  I	
  presented	
  to	
  Grrcon	
  on	
  the	
  results	
  of	
  a	
  pet	
  project	
  to	
catalog	
  SpiderLabs’	
  most	
  successful	
  (i.e.,	
  most	
  commonly	
  used	
  and	
  producIve)	
  internal	
  network	
a`ack	
  techniques.	
  A	
  couple	
  talks	
  later,	
  my	
  friend	
  Tim	
  Crothers,	
  then	
  doing	
  Incident	
  Response	
  for	
GE	
  gave	
  an	
  awesome	
  presentaIon	
  where	
  he	
  stepped	
  through	
  keystrokes	
  captured	
  from	
  a	
  live	
  C&C	
server	
  of	
  an	
  a`acker	
  manually	
  exploiIng	
  an	
  internal	
  network.	
  There	
  was	
  a	
  high	
  degree	
  of	
  overlap	
between	
  the	
  a`acker’s	
  methods,	
  and	
  the	
  methods	
  I	
  was	
  recommending,	
  and	
  I	
  thought	
  that	
  fact	
was	
  very	
  interesIng.	
  So	
  here	
  we	
  are.	
4	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
When	
  I	
  explained	
  what	
  I	
  wanted	
  to	
  do	
  to	
  Chris,	
  he	
  said:	
  “Oh,	
  OPFOR.	
  Cool.”	
  I’m	
  not	
  ex-­‐
military,	
  and	
  I’m	
  not	
  a	
  computer	
  gamer,	
  so	
  I	
  had	
  to	
  go	
  look	
  that	
  up.	
  Is	
  there	
  anyone	
  *else*	
  in	
this	
  room	
  who	
  would	
  have	
  to	
  look	
  that	
  acronym	
  up?	
  I	
  thought	
  not.	
But	
  I	
  know	
  how	
  to	
  use	
  google,	
  so	
  I	
  read	
  up	
  on	
  some	
  unclassiﬁed	
  US	
  Army	
  training	
  manuals	
  on	
OPFOR.	
  An	
  OPFOR	
  is	
  basically	
  what	
  we	
  think	
  of	
  as	
  a	
  red	
  team.	
  But	
  of	
  course	
  as	
  applied	
  by	
the	
  US	
  Army,	
  it’s	