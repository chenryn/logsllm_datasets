P
b
y
图5.22棋盘密码
这样，每个字母就对应了由两个数构成的字符aβ，a是该字母所在行的标号，β是列标号。
如c对应13，s对应43等。如果接收到密文为：
43151345421532154343112215
则对应的明文即为securemessage
另一种具有代表性的密码是恺撒密码。它是将英文字母向前推移k位。如k=5，则密文字
母与明文有如下对应关系：
abcdefghijklmnopqrstuvwxyz
FGHIJKLMNOPQRSTUVWXYZABCDE
于是对应于明文securemessage，可得密文为XJHZWJRJXXFLJ。此时，k就是密钥。为
了传送方便，可以将26个字母一一对应于从0到25的26个整数。如a对1，b对2，，y
对25，z对0.这样恺撒加密变换实际就是一个同余式：
c= m+k mod 26
其中m是明文字母对应的数，c是与明文对应的密文的数。
随后，为了提高恺撒密码的安全性，人们对恺撒密码进行了改进。选取k，b作为两个参
数，其中要求k与26互素，明文与密文的对应规则为：
c= km+b mod 26
可以看出，k=1就是前面提到的恺撒密码。于是这种加密变换是恺撒野加密变换的推广，
并且其保密程度也比恺撒密码高。
以上介绍的密码体制都属于单表置换。意思是一个明文字母对应的密文字母是确定的。根
据这个特点，利用频率分析可以对这样的密码体制进行有效的攻击。方法是在大量的书籍、报
刊和文章中，统计各个字母出现的频率。例如，e出现的次数最多，其次是t，a，o，1等。破
译者通过对密文中各字母出现频率的分析，结合自然语言的字母频率特征，就可以将该密码体
制破译。
2.多表密码
鉴于单表置换密码体制具有这样的攻击弱点，人们自然就会想办法对其进行改进，来弥补
这个弱点，增加抗攻击能力。法国密码学家维吉尼亚于1586年提出一个种多表式密码，即一
个明文字母可以表示成多个密文字母.其原理是这样的：给出密钥K-k[1k[2]..k[n]，若明文
为M=m[1]m[2]..m[n]，则对应的密文为C=e[1]c[2]..c[n]。
其中Cli]-（m[j]+k[i]）mod26。例如，若明文M为data security，密钥k-best，将明文分解
为长为4的序列data security，对每4个字母，用k-best加密后得密文为：
C=EELT TIUN SMLR
从中可以看出，当K为一个字母时，就是恺密码。而且容易看出，K越长，保密程度就
237..
---
## Page 246
网络安全进阶笔记
越高。显然这样的密码体制比单表置换密码体制具有更强的抗攻击能力，面且其加密、解密均
可用所谓的维吉尼亚方阵来进行，从面在操作上简单易行。该密码曾被认为是三百年内破译不
了的密码，因面这种密码在今天仍被使用着。
古典密码在第二次世界大战时达到了项点，也达到了终点。当年希特勒一上台就试验并使
组合，假如一个人日夜不停地工作，每分钟测试一种密钥的话，需要约4.2万年才能将所有的
密钥可能组合试完。希特勒完全相信了这种密码机的安全性。
然而，英国获知了“谜”型机的原理，启用了数理逻辑天才、现代计算机设计思想的创始
人，年仅26岁的AlanTuring.1939年8月，在Turing领导下完成了一部针对“谜”型机的密
码破译机，每秒钟可处理2000个字符，人们给它起了个绰号叫“炸弹（Bomb）”。半年后，它
几乎可以破译截获德国的所有情报。后来又研制出一种每秒钟可处理5000个字符的“巨人
（Colossus）型密码破译机，1943年投入使用。至此，同盟国儿乎掌握了希特勒德国的绝大多
数军事秘密，为战争的胜利立了大功。
5.3.3精彩案例：利用“霏霏认证”进行算法演示
为了进一步理解上述安全术语，下面，我们将通过“罪罪认证”这个软件进一步深化对这
些策略的认识。
1.软件安装和特点
软件下载地址：htp://www.offca.com/ffca/down/rar/ffca101.rar
补丁下载地址：htp://www.flash2be.com/tools/f2b_AS2FLA/Comdlg32.ocx
注意：如果运行软件时出现缺少“COMDLG32.OCX”的提示，表明计算机上没有安装
COMDLG32.OCX控件。以Windows2000为例，可以通过上述地址下载并将文件复制到
C:WINNTsystem32目录，或者从网上下载该文件。
靠靠认证（以下简称FFCA）是绿色软件，无需安装，卸载时将目录删除即可。它具有加密、
电子签名和身份认证的功能，且将加密、数字证书合二为一，这样更加有助于我们了解一些
安全策略。值得一提的是，软件采用了F加密系列算法，该算法可以轻松地制作任意长度的
密钥。
2.生成密钥
号
就好像开门一样，初次使用FFCA时，我们需要制作属于自己的钥匙，即密钥。密钥和密
码是两个不同的概念，密钥是程序用来对文件进行加密/解密/签名操作时所需要的一个数据文
件，密码是保护私钥的，用来检验用户的合法性，每次使用私钥时，必须输入该密码，以防止
我们的私钥被他人非法使用。
在软件主界面中，点击“生成新密钥”选项，在弹出的界面中依次提示填写姓名、密码，
在下面的自我介绍栏写入个人简介，然后在密钥有效期后填入到期时间，单击“确定”按钮，
软件就会生成一对密钥。如图5.23所示。
在这里，我们就能体会到加密策略中的非对称算法的作用了。
238
---
## Page 247
龙
图5.23利用靠靠认证软件生成新密钥
通过上面的操作，可以生成一个公钥和一个私钥，而且这两个密钥总是成对出现的。其中，
公钥放在FFCA目录下的DATA子目录下，以K为扩展名，它是公开的，供与他人通讯时使
用的，可将其散发给朋友。私钥在FFCA目录下的KEY子目录下，以KEY为扩展名，是用户
专用的，需要仔细保存。
3.查看公钥
在主界面中，打开“密钥管理器”，你可以看见公钥，它们以列表的形式显示在左边的概
中，如图5.24所示。
自价绍：买一正米自北方的
2月日
备理过是风之员的公销
DOFAKCOOIHDIEKJO
图5.24靠靠认证软件的密钥管理器
字后，单击“查找”按钮，结果将显示在左边的列表框中，如果将“关键字”文本框清空，则
列出所有公钥。
230
---
## Page 248
网络安全进阶笔记
犹如每人都有自己独特的、终生不变的指纹一样，软件生成的每一对密钥也有自己独特的、
无法改变的指纹。其顺序是：先产生公钥，再根据公钥计算出其指纹，由于其不可逆性，任何
人都无法根据指纹推导出公钥。此外，我们还可以在公钥中为每一个公钥加一个备注，如“我
是一匹来自北方的狼”。
如果我们需要制作一个属于自己的头像，可以在制作密钥时，将图片放在SET目录下，
以myphoto.jpg为文件名，就可以把图片加入公钥了，图片的大小建议不超过310x390像素。
4.加密和解密
现在假设你已经制作了两对密钥，一对用户名为A，另一对用户名为B。加密和解密之前，
我们必须清楚这样一个原理：如果要别人能打开加密的保险柜，就必须使用他的锁。基于此原
理，我们需要得到收件人的公钥来发送邮件。
假设要给朋友B发一个文件，如Test.doc。打开程序，进入主界面，点击“加密”，选择
要发送的文件，即TesLdoc。按提示选择收件人的公钥。单击“确定”按钮即可。进入文件的
存放目录，我们会发现多了一个以FF为扩展名的文件test.doc.FF，这就是加密了的文件。
现在假设我们是收件人，朋友利用我们的公钥加密了一个文件，我们收到加密后的
test.doc.FF文件后，从程序的主界面选择“解密”，找到test.doc.FF，程序会自动找到私钥，
并提示输入密码，如图5.25所示。解密出来的文件存放在FDocuments子目录下。
区Y（）
输入作的名销完码
*****州
图5.25靠罪认证软件解密时的密码输入框
5.签名
假设我们现在要给朋发发一个文件，并要在文件上签名。打开程序，进入主界面，单击“签
名”按钮，选择被签名的文件，如TesLdoc。按提示，选择我们自已的私钥，按提示输入密码
即可，进入原文件的存放目录，我们会发现多了一个以SIG为扩展名的文件，这个Test.doc.SIG
就是test.doe的签名。现在就可以安全地把tesLdoc和test.doc.SIG发给朋友了。
如果指纹验证成功，软件会显示公钥中所填写的信息，包括“用户名”、“自我介绍”、
“备注”、“有效期”以及发送者的“指纹”等5个项目。如果你对被签名文件testdoc做了
改动，则无法通过签名核对。使用该功能，可以确信你收到的文件testdoc是A签发的，因为
签名时必须使用私钥，面只有A才有该私钥。
同时进行文件的加密和签名操作，产生的文件以FS为扩展名，与原文件在同一目录下，
该操作需要对方的公钥和你的私钥.大致方法与上面类似。
240
---
## Page 249
第5章趣解加密与解密
6.剪贴板操作
就被复制到剪贴板中。在软件主界面中，单击“剪贴板操作”，会看到刚才被复制到剪贴板中
的文字出现在了该界面的文本框中，也可以在文本框里直接改动文字。单击“加密”按钮，然
后就可以把加密后的文字贴到E-mail里发送给朋友了，如图5.26所示。
A（认）
加密
签名
加名
NUGNFOHMOHFEERONWEKIANFPFDEFCLMELHOFGLDNEFPCOMLFLGM
-FF-CA-END
wOFFCAconENDFF-CA.-.
图5.26靠靠认证软件的剪贴板操作
需要注意的是，软件界面没有“解密”按钮，必须将加密后的文字复制到剪贴板，然后再
进入剪贴板操作界面，程序会自动检测，如发现有FF加密的文字，会自动进行解密操作。如
图5.27所示。
A（认证）的作
加
签名
加4名
加名成功！
JOHKDMA
NNFHAEAFAMHKOPFPFKBHEADULUDAFTGPNGMEACEFMBAOADG
HNLHMINGPSOMAFGINUPIPGEGEAEHDJ
图5.27零靠认证软件的自动解密操作
241
---
## Page 250
网络安全进阶笔记
以上是信息加密策略的一些筒单应用，正是通过这些应用的扩展，才构筑了安全可信的网
络环境，只有在这样的环境中，企业才能更为稳健有序地发展，才能以必要的准备把握网络商
业环境中无所不在的机会，以前瞻的眼光迎接信息化美好的明天。
5.4对称密码算法基础知识
5.4.1对称密码简介
对称密码的历史十分悠久，几乎从密码学开始就已经产生了对称密码。所谓对称密钥就是
加密和解密用的密钥是相同的。对称密码的优点是有很强的保密强度，且能够经受住时间的检
验和攻击，但其密钥必须通过安全的途径传送。因此，其密钥管理成为系统安全的重要因素。
当一个文本要加密传送时，该文本用密钥加密构成密文，密文在信道上传送，收到密文后用同
一个密钥将密文解出来，形成普通文体供阅读。在对称密钥中，密钥的管理极为重要，一旦密
钥丢失，密文将无密可保。
由于对称密钥密码系统具有加解密速度快、安全强度高等优点，在军事、外交以及商业应
用中使用越来越普遍。对称密码的算法有分组密码和序列密码两种。分组密码（见表5.1）算法包
括 DES、IDEA、SAFERK+、Blowfish、Skipjack、Twofish、LOKI、CAST、Cryption、MARS、
RC2.RC5.RC6.Rijndael、Serpent等算法，序列密码算法包括RC4.SEAL、Vemam、A5.RC4.
Fish、Pike、Wake、Pkzip等。其中多数算法为专利算法。以上这些算法有些已经遭到了破译，
有些安全强度不如DES，有些强度高于DES，有些强度不明，还有待于进一步分析。
对称加密系统最著名的是美国数据加密标准DES、AES（高级加密标准）和欧洲数据加密标