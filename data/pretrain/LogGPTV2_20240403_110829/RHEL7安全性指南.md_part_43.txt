:::
:::
:::
:::
[]{#app-Audit_Reference.html}
::: appendix
::: titlepage
# [⁠]{#app-Audit_Reference.html#app-Audit_Reference}附录 B. 审核系统引用 {.title}
:::
::: section
::: titlepage
# [⁠]{#app-Audit_Reference.html#sec-Audit_Events_Fields}B.1. 审核事件字段 {.title}
:::
::: para
[表 B.1 "事件字段"](#app-Audit_Reference.html#table-event_fields){.xref}
列举了目前所有获得支持的审核事件字段。一个事件字段是在审计日志文档中等号前的值。
:::
::: table
[⁠]{#app-Audit_Reference.html#table-event_fields}
**表 B.1. 事件字段**
::: table-contents
+-------------------+--------------------------------------------------+
| 事件字段          | 解释                                             |
+===================+==================================================+
| `a0`{.literal},   | 记录系统调用前四个参数，标为十六进制。           |
| `a1`{.literal},   |                                                  |
| `a2`{.literal},   |                                                  |
| `a3`{.literal}    |                                                  |
+-------------------+--------------------------------------------------+
| `acct`{.literal}  | 记录用户账号名。                                 |
+-------------------+--------------------------------------------------+
| `addr`{.literal}  | 记录 IPv4 或者 IPv6 地址，这一字段通常紧随一个   |
|                   | `hostname`{.varname} 字段并包含主机名解释地址。  |
+-------------------+--------------------------------------------------+
| `arch`{.literal}  | 记                                               |
|                   | 录关于中央处理器结构的系统信息，以十六进制编码。 |
+-------------------+--------------------------------------------------+
| `auid`{.literal}  | 记                                               |
|                   | 录审核用户身份。当用户身份改变的时候，身份在登录 |
|                   | 时被指定给另一个用户并在每次操作时继承（例如，用 |
|                   | `su - john`{.command} 切换用户名）。             |
+-------------------+--------------------------------------------------+
| `capa             | 记下二进制位的数字，用来设置 Linux 功能。        |
| bility`{.literal} | 更多关于 Linux 功能的信息，参见                  |
|                   | [[                                               |
|                   | capabilities]{.refentrytitle}(7)]{.citerefentry} |
|                   | 页。                                             |
+-------------------+--------------------------------------------------+
| `                 | 记录的数据与文件系统功能设置。                   |
| cap_fi`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `                 | 记录与设置一个与许可文件系统功能相关的数据。     |
| cap_fp`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `                 | 记下与设置有效处理功能相关的数据。               |
| cap_pe`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `                 | 记下与设置继承处理功能相关的数据。               |
| cap_pi`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `                 | 记下与设置许可处理功能相关的数据。               |
| cap_pp`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `                 | 记下 `cgroup`{.command}                          |
| cap_pp`{.literal} | 的路径，其中包含处理审计时间生产的处理。         |
+-------------------+--------------------------------------------------+
| `                 | 记下整条执行的命令行。这在 shell 解释程序在      |
| cap_pp`{.literal} | `exe`{.literal} 输入栏 record                    |
|                   | 领域记录时有用，例如，`/bin/bash`{.literal} 在   |
|                   | shell 解释程序和 `cmd`{.literal}                 |
|                   | 其余执行的命令行字段记录，例如，                 |
|                   | `helloworld.sh --help`{.literal}.                |
+-------------------+--------------------------------------------------+
| `comm`{.literal}  | 记录被执行的要求。这在 `exe`{.literal}           |
|                   | 的字段记录在 shell                               |
|                   | 解译程序中很有用，例如`/bin/bash`{.literal}      |
|                   | 作为套解译程序以及 `comm`{.literal}              |
|                   | 字段记录的                                       |
|                   | 脚本被执行，或者在执行`helloworld.sh`{.literal}  |
|                   | 时很有用。                                       |
+-------------------+--------------------------------------------------+
| `cwd`{.literal}   | 记录系统调用目录路径。                           |
+-------------------+--------------------------------------------------+
| `data`{.literal}  | 记下TTY记录相关数据。                            |
+-------------------+--------------------------------------------------+
| `dev`{.literal}   | 记录                                             |
|                   | 设备中的次要和主要ID，包含事件记录的文件或目录。 |
+-------------------+--------------------------------------------------+
| `de               | 记录主要设备ID。                                 |
| vmajor`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `de               | 记录次要设备ID。                                 |
| vminor`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `egid`{.literal}  | 记录开始分析进程用户的有效组ID。                 |
+-------------------+--------------------------------------------------+
| `euid`{.literal}  | 记录开始分析进程用户的有效用户ID。               |
+-------------------+--------------------------------------------------+
| `exe`{.literal}   | 记录曾调用分析进程的可执行路径。                 |
+-------------------+--------------------------------------------------+
| `exit`{.literal}  | 记录由系统调用                                   |
|                   | 返回的退出代码。此值随系统调动变化。可以将此值解 |
|                   | 释给它的人类可以读得懂的对应值，根据以下命令：`  |
|                   | ausearch --interpret --exit exit_code`{.command} |
+-------------------+--------------------------------------------------+
| `                 | 记录使用的地址协议类型，IPv4 还是 IPv6。         |
| family`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `fi               | 记录文件类型。                                   |
| letype`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `flags`{.literal} | 记录文件系统名标志。                             |
+-------------------+--------------------------------------------------+
| `fsgid`{.literal} | 记录开始分析进程的用户文件系统组ID。             |
+-------------------+--------------------------------------------------+
| `fsuid`{.literal} | 记录开始分析进程的用户文件系统用户 ID。          |
+-------------------+--------------------------------------------------+
| `gid`{.literal}   | 记录组 ID。                                      |
+-------------------+--------------------------------------------------+
| `ho               | 记录主机名称。                                   |
| stname`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `ic               | 记录接收到的 ICMP                                |
| mptype`{.literal} | （因特网信息控制协议）包类型。审核包含这         |
|                   | 一字段的信息，通常由[**iptables**]{.application} |
|                   | 生成。                                           |
+-------------------+--------------------------------------------------+
| `id`{.literal}    | 记录变动账户的用户 ID。                          |
+-------------------+--------------------------------------------------+
| `inode`{.literal} | 记录在审核时，关联文件或目录的 inode 数字。      |
+-------------------+--------------------------------------------------+
| `ino              | 记录 inode 所有者的组 ID。                       |
| de_gid`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `ino              | 记录 inode 所有者的用户 ID。                     |
| de_uid`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `items`{.literal} | 记录路径数目，该记录会被附加。                   |
+-------------------+--------------------------------------------------+
| `key`{.literal}   | 记录与在审核日                                   |
|                   | 志中能产生一个特定事件条例相关的用户定义字符串。 |
+-------------------+--------------------------------------------------+
| `list`{.literal}  | 记录审查规则列表 ID。以下是列表已知的 ID 是：    |
|                   |                                                  |
|                   | ::: itemizedlist                                 |
|                   | -   ::: para                                     |
|                   |     0 --- `user`{.literal}                       |
|                   |     :::                                          |
|                   |                                                  |
|                   | -   ::: para                                     |
|                   |     1 --- `task`{.literal}                       |
|                   |     :::                                          |
|                   |                                                  |
|                   | -   ::: para                                     |
|                   |     4 --- `exit`{.literal}                       |
|                   |     :::                                          |
|                   |                                                  |
|                   | -   ::: para                                     |
|                   |     5 --- `exclude`{.literal}                    |
|                   |     :::                                          |
|                   | :::                                              |
+-------------------+--------------------------------------------------+
| `mode`{.literal}  | 记录文件目录权限，以数值表示法编码。             |
+-------------------+--------------------------------------------------+
| `msg`{.literal}   | 记录时间戳和记录中的唯一 ID ，或者不同的事件特定 |
|                   | `=`{.literal}                       |
|                   | 匹配，由内核或用户空间应用提供。                 |
+-------------------+--------------------------------------------------+
| `m                | 记录基于用户的 AVC 拒绝返回的信息类型            |
| sgtype`{.literal} | 。信息类型由 D-Bus 决定。                        |
+-------------------+--------------------------------------------------+
| `name`{.literal}  | 记                                               |
|                   | 录以自变量形式传到系统调用的全部文件或目录路径。 |
+-------------------+--------------------------------------------------+
| `ne               | 记录分配给虚拟机的新磁盘资源名字。               |
| w-disk`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `n                | 记录分配给虚拟机的新记忆资源数量。               |
| ew-mem`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `ne               | 记录分配给虚拟机的新虚拟 CPU 资源的数量。        |
| w-vcpu`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `n                | 记录分配给虚拟机的新网络界面资源的 MAC 地址。    |
| ew-net`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `n                | 记录指定给用户的组 ID。                          |
| ew_gid`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `oauid`{.literal} | 记录登录进入系统用户的用户                       |
|                   | ID（预期                                         |
|                   | 相对的是，例如，使用`su`{.command}）并开始目标进 |
|                   | 程。这一字段专用于记录类型`OBJ_PID`{.constant}。 |
+-------------------+--------------------------------------------------+
| `ocomm`{.literal} | 记                                               |
|                   | 录用来启动目标进程的命令。这一字段专用于记录类型 |
|                   | `OBJ_PID`{.constant}。                           |
+-------------------+--------------------------------------------------+
| `opid`{.literal}  | 记录目标进程的进程 ID。这一字段专用于记录类型    |
|                   | `OBJ_PID`{.constant}。                           |
+-------------------+--------------------------------------------------+
| `oses`{.literal}  | 记录目标进程的会话 ID。这一字段专属于记录类型    |
|                   | `OBJ_PID`{.constant}。                           |
+-------------------+--------------------------------------------------+
| `ouid`{.literal}  | 记录目标进程中的真实用户 ID。                    |
+-------------------+--------------------------------------------------+
| `obj`{.literal}   | 记录以 SELinux                                   |
|                   | 为对象的内容，该对象可                           |
|                   | 以是文档、目录、承接，或任何一个被动接受的物体。 |
+-------------------+--------------------------------------------------+
| `o                | 记录对象的组 ID。                                |
| bj_gid`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `obj_le           | 记录对象的高 SELinux 级别。                      |
| v_high`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `obj_l            | 记录对象的低 SELinux 级别。                      |
| ev_low`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `ob               | 记录对象的 SELinux 角色。                        |
| j_role`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `o                | 记录对象的 UID。                                 |
| bj_uid`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `ob               | 记录对象的关联用户。                             |
| j_user`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `ogid`{.literal}  | 记录对象所有者的群组 ID。                        |
+-------------------+--------------------------------------------------+
| `ol               | 当一个新的磁                                     |
| d-disk`{.literal} | 盘资源被分配给一个虚拟机时记录旧磁盘资源的名字。 |
+-------------------+--------------------------------------------------+
| `o                | 当                                               |
| ld-mem`{.literal} | 新内存额被指定给虚拟机时，记录旧的内存资源总额。 |
+-------------------+--------------------------------------------------+
| `ol               | 当新虚拟 CPU 被指定给虚拟机，记录旧虚拟 CPU      |
| d-vcpu`{.literal} | 资源。                                           |
+-------------------+--------------------------------------------------+
| `o                | 当新的网络界面被指定给虚拟机时，记录 MAC         |
| ld-net`{.literal} | 地址的旧网络界面资源。                           |
+-------------------+--------------------------------------------------+
| `ol               | 记录网络混杂标志的上一个值。                     |
| d_prom`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `ouid`{.literal}  | 记录开始目标进程的真实用户 ID。                  |
+-------------------+--------------------------------------------------+
| `path`{.literal}  | 记                                               |
|                   | 录以自变量形式传到系统调用的全部文件或目录路径。 |
+-------------------+--------------------------------------------------+
| `perm`{.literal}  | 记录曾调用分析进                                 |
|                   | 程的可执行路径。（即，读、写、操作或者变更属性） |
+-------------------+--------------------------------------------------+
| `pid`{.literal}   | ::: para                                         |
|                   | `pid`{.varname}语义场取决于该领域起源的价值。    |
|                   | :::                                              |
|                   |                                                  |
|                   | ::: para                                         |
|                   | 由用户控件衍生出来的领域，该领域拥有一个操作     |
|                   | ID。                                             |
|                   | :::                                              |
|                   |                                                  |
|                   | ::: para                                         |
|                   | 在由内核衍生的领域，该领域拥有一个线程号。线程   |
|                   | 号等同于单线进程中的进程标识。注明该线程号的值和 |
|                   | [pthread_t]{.type}                               |
|                   | 在用户空间账号所用值是不一样的。更多信息，参考   |
|                   | [[gettid]{.refentrytitle}(2)]{.citerefentry}     |
|                   | 操作说明。                                       |
|                   | :::                                              |
+-------------------+--------------------------------------------------+
| `ppid`{.literal}  | 记录父进程标识（Parent PID）。                   |
+-------------------+--------------------------------------------------+
| `prom`{.literal}  | 记录网络简短社交活动标志。                       |
+-------------------+--------------------------------------------------+
| `proto`{.literal} | 记录曾用的网络协议。这个领域是专门针对由         |
|                   | [**iptables**]{.application} 衍生的审核事件的。  |
+-------------------+--------------------------------------------------+
| `res`{.literal}   | 记录引发审核事件操作的结果。                     |
+-------------------+--------------------------------------------------+
| `                 | 记录引发审核事件操作的结果。                     |
| result`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `saddr`{.literal} | 记录套接地址。                                   |
+-------------------+--------------------------------------------------+
| `sauid`{.literal} | 记                                               |
|                   | 录发送者的审计登录用户账号。这个账号由作为内核的 |
|                   | D-Bus                                            |
|                   | 提供，                                           |
|                   | 并不能看到哪个用户发送了最初的`auid`{.command}。 |
+-------------------+--------------------------------------------------+
| `ses`{.literal}   | 记录会话 ID，在该会话中分析过程被调用。          |
+-------------------+--------------------------------------------------+
| `sgid`{.literal}  | 记录开始分析进程用户的群组 ID。                  |
+-------------------+--------------------------------------------------+
| `sig`{.literal}   | 记录导致项目异常                                 |
|                   | 终止的信号代码。通常，这是一个系统被入侵的迹象。 |
+-------------------+--------------------------------------------------+
| `subj`{.literal}  | 记录以 SELinnux                                  |
|                   | 为对象的内容，这个对象可以是一                   |
|                   | 个过程、一个用户、或者是任何对目标起作用的事物。 |
+-------------------+--------------------------------------------------+
| `su               | 记录 SELinux 对象的清除许可。                    |
| bj_clr`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `sub              | 记录对象的 SELinux 的角色。                      |
| j_role`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `su               | 记录对象 SELinux 的敏感度。                      |
| bj_sen`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `sub              | 记录和主题相关的用户。                           |
| j_user`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `s                | 记录系统调用是成功还是失败。                     |
| uccess`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `suid`{.literal}  | 记录开启分析过程用户的设置用户 ID。              |
+-------------------+--------------------------------------------------+
| `s                | 记录发送到内核的系统调用类型。                   |
| yscall`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `te               | 记录终端名称（不包括`/dev/`{.filename}）。       |
| rminal`{.literal} |                                                  |
+-------------------+--------------------------------------------------+
| `tty`{.literal}   | 记录控制终端的名称。如果过程没有控制终端，则用   |
|                   | `(none)`{.literal}的值。                         |
+-------------------+--------------------------------------------------+
| `uid`{.literal}   | 记录启动分析进程的用户的真实 ID。                |
+-------------------+--------------------------------------------------+
| `vm`{.literal}    | 记录产生审核事件的虚拟机名称。                   |
+-------------------+--------------------------------------------------+
:::
:::
:::
::: section
::: titlepage
# [⁠]{#app-Audit_Reference.html#sec-Audit_Record_Types}B.2. 审核记录类型 {.title}
:::
::: para
[表 B.2 "记录类型"](#app-Audit_Reference.html#table-record_types){.xref}
列举了所有支持当前审核记录的类型。事件类型在每个审核记录开头的`type=`{.literal}
的字段中被指定。