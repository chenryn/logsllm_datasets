对抗实践
目录
01  终端风控的对抗体系
02 设备指纹的对抗之道
03 设备指纹的对抗实践
04 合规挑战的适应应对
01终端风控
对抗体系
设备
指纹
智能
验证
生物探针
行为
分析
应用
加固
安全管控
终端风控态势感知系统
机器学习平台
反欺诈模型
01终端风控
风险对抗
设备
指纹
智能
验证
生物探针
行为
分析
应用
加固
安全管控
唯一
标识
模拟
器
设备
篡改
设备
伪造
群控
识别
人机
识别
本人
识别
人机
验证
机刷
对抗
黑产
工具
刷机
抹机
联防
联控
异常
行为
风险
行为
敏感
权限
隐私
数据
网络
行为
动态
加载
应用
保护
文件
保护
代码
保护
文件
操作
合规
检测
数据
加密
反调
试
数据
盗爬
hook
攻击
02设备指纹
技术原理
场景
JS SDK
Android
iOS
SDK
浏览器类型、
版本
设备型号、设备名称
操作系统类型、
版本
系统版本、运营商、内网IP
屏幕分辨率
CPU、内存、存储大小
canvas指纹
开机时间、电量、屏幕亮度
浏览器插件
模拟器等系统运行环境信息
网络环境信息
各种传感器信息
协议指纹
SSL协议指纹、TCP/IP协议栈等信息
02设备指纹
技术原理
特征A
特征B
特征C
特征D
1 .组合特征
A+B+C+D
3.建
立映
射
设备精准
唯一ID
存
储
随机
算法
4.映射关系持久化
2.生成设备ID
生成
特征A
特征B
特征C
特征D
1 .组合特征
A+B+C+D
存
储
2.查找映射对应的ID
3.返回对应的device ID
还原
02设备指纹
风险画像构建
实际对抗中，设备指纹技术及模型算法需有效识别出模
拟器、作弊工具、云模拟器、改机、二次打包Ap p 、位
置伪造等上百种设备风险。业务风控平台可选用相关标
签进行风控策略配置，来有效识别并阻断恶意用户。
03对抗实践
黑灰产常用的手段
B
注入攻击 hook
D
群控/自动化工具 automation
F
刷机/恢复出厂设置 recovery
A
C
应用重打包 repacking app
E
多开 multiopen
模拟器/云模拟器 emulator
03对抗实践
改机、作弊框架、HOOK
对抗实践中可以采用通用特征识别结合特定
特征识别的方式，来有效识别各类已知、未
知改机作弊框架和工具，对于某些隐藏特征
的高级作弊工具也可以做到精确识别
03对抗实践
模拟器、云控、位置伪造
实际对抗中设备指纹需具备系统特征识别、协议指纹识别和C PU指令探测等通用的模
拟器识别算法，来有效识别各类已知和未知的终端模拟器、云模拟器。
常见品牌模拟器：如夜神、雷电、Mumu、逍遥、andyroid
云模拟器（红手指、海马云）
。Anbox/虚拟大师/blissOS
03对抗实践
群控、设备农场
示例：
群控监测
设备指纹，检测特定作弊工具
操作状态，输入速度，传感器状态
策略 & 无监督聚类
03对抗实践
M1芯片终端
M1之于业务的挑战
真机运行ipa
风控之于M1的对抗
识别M1真机、M1模拟器
02对抗实践
其他典型对抗
多开/分身：区分软件多开和系统多开
备份恢复/抹机恢复：相似度算法+黑科技
定制rom检测：检测到黑产ROM，会有特殊规则，输出风险标签
刷机检测：设备疑似刚刷过机，典型特征：应用数量少，开机时间短，存储空间利用率极低等
逆向对抗：数据结构加固、vmp保护、js动态更新、ast混淆
03对抗实践
典型有意思的业务思考
非本机恢复的思考
任意两部相同型号相同系统版本的设备，通过备份克隆APP，生成不同的设备指纹
逻辑上需要生成两个ID，有些业务“想”生成相同ID，业务上可以结合用户设备的一些字段，比如特别是设备名称、网
络、已占用的存储之类的 是可以配合来确认是否是同一个用户
网络信息异常
网络参数不合逻辑，如网络类型为Wi-Fi，但Wi-Fi为未连接状态，Wi-Fi、基站IP、VPN IP相同
改机检测与虚假设备
改机检测有可能没有实际发生参数篡改，虚假设备是发生篡改后的
03对抗实践
典型的终端风控模块
生物探针
智能验证
行为分析
安全管控
应用加固
安全清场
是不是本人
是不是真人
传感器数据
按压力度数据
操作链路数据
行为轨迹数据
设备维度数据
其他非敏感数据
加速度传感数据
陀螺仪传感数据
磁场传感器数据
滑动行为数据
按压力度数据
设备纬度数据
传感器特征模型
传感器时序模型
行为习惯模型
行为特征模型
生物探针技术
用户画像
生物特征模型
AI对抗+干扰+模型+终端风控
基底+画像
04合规挑战
适应与应对
安全
合规
数据安全
隐私合规
敏感数据
合法采集
系统限制
最小采集
去标识化
合规流程
算法优化
主被结合
联防联控
自适应性
风险
对抗
最小
采集
冷热
并用
去标
识化
主被
结合
终端
风控
跟随宿主权限、最小化采集
不要求敏感权限：GPS定位、手机状态
不依赖敏感字段：imei、wifimac、idfa
等
强化被动式设备指纹能力补充
强化设备基因能力
强化相似度算法
高版本强稳定字段
 boot文本特征
支持灵活冷启动冷更新，采
集字段自定义配置；
支持热更新，配置下发，灵
活全局配置采集字段、采集
策略
设备ID不落前端，设备ID业
务动态化，动态+静态ID
分级
存储
风险
监测
严格控制采集频率、文件读写频率
严格控制文件读写位置，提供位置
配置化
按数据的重要性、敏感性、访问频
率、保留时间、容量、性能等分级；
合作方数据隔离；
THANKS
THANKS