do not appear in the literature in a way that exposes all of their
constants. It is clear that their asymptotic performance is superior
to VEX’s, though we think VEX is likely to perform better over the
range that it deals with (numbers less than 10,000; see Section 7.1).
Indeed, commitment generation, proof generation, and proof ver-
iﬁcation all take roughly 1 ms in this range. In contrast, a recent
implementation of Boudot’s scheme [38] requires relatively large
proofs (5.3 KB), and proof generation and veriﬁcation take 74 and
31 ms, respectively.
 0 400 800generationgenerationgenerationverificationthroughput (audits/second)(vex)(vex-cp)(vex-nocc)1700102050100102050100102050100102050100 0 400 800generationgenerationgenerationverificationthroughput (audits/second)(vex)(vex-cp)(vex-nocc)20005000700090002000500070009000200050007000900020005000700090002047.8 Summary and outlook
Our evaluation indicates that the additional latency imposed by VEX
and its variants is fairly low (tens of milliseconds per auction) and
comes primarily from an additional round of communication. Net-
work costs are moderate (hundreds of bytes per bid), storage costs
for the auctioneer are considerable (but still tolerable), and auction-
eer throughput is reasonable (one of the optimized variants of VEX
imposes overhead of 2×). The audit-to-auction ratio (in terms of the
expense of an audit) is 1 for every 18 auctions for VEX-CP, and 1
for every 160 auctions for VEX-NOCC. This ratio could in principle
permit a signiﬁcant fraction of auctions to be audited. The principal
cost during the auction phase is the bidders’ commitment genera-
tion. This cost is comparable to proof generation and veriﬁcation in
the audit phase, and accounts for about 1.2 ms of CPU time.
8 OTHER RELATED WORK
We covered work on hash chains and zero knowledge range proofs
in Sections 3 and 7.7. Below, we discuss three categories of re-
search: online advertisement, secure auctions, and general-purpose
auditing.
Online advertising. Privad [31], Adnostic [51], and work by
Juels [35] apply to ad networks, versus our concern of ad exchanges.
Also, their focus is privacy for Web users, versus our concern of in-
tegrity in auctions. Reznichenko et al. [47] develop auction proto-
cols, but again the focus is ad networks, and the goal is user privacy.
Recent work by Dave et al. [23] and Haddadi [32] focuses on
measuring, detecting, and preventing fraudulent clicks in online
ad networks; this work could complement VEX by helping to de-
fend against attacks on impression delivery (§5.3). Stone-Gross et
al. [49] characterize the different types of fraudulent activity in ad
exchanges, such as click fraud and keyword stufﬁng, but unlike
VEX, their work assumes the correctness of the ad exchange itself.
Lastly, Muthukrishnan [39] describes ad exchanges generally, and
poses nine theoretical problems that range from mechanism design
to the development of a veriﬁable ad exchange. We address the lat-
ter problem with VEX.
Secure auctions. A large body of work in secure auctions focuses
on privacy [19, 34, 40]. This work is valuable but orthogonal to the
focus of this paper. Other work [17, 30, 37, 44–46, 50] recognizes
the importance and the challenge of designing veriﬁable online auc-
tions, and proposes several schemes based on novel cryptographic
techniques and distributed protocols. We provide a summary of the
most relevant work below.
The work by Rabin et al. [45] is the most recent in a line of
work [44, 46] that aims for auction integrity. This work achieves
stronger guarantees than VEX (for instance, unlike VEX, their
scheme does not require disclosing the auction’s sale price to ver-
ify that an auction was conducted properly), and reports impressive
performance results. On the other hand, as the authors acknowl-
edge, the performance results correspond to a construction with
soundness (probability of detecting an incorrect outcome) of only
25%. Amplifying this rate would require bidders to submit a large
number of commitments, leading to large computational, storage,
and communication costs.
Some work [30, 37, 50] proposes the design of secure auctions
by splitting up the role of the auctioneer into multiple parties. Note
that some of these schemes prevent misbehavior (versus detecting
it, as in VEX). The tradeoff is that they require a non-collusion as-
sumption among some of the parties. This is a reasonable assump-
tion in many instances, but the centralized nature of ad exchanges
makes this work not directly applicable to our requirements (§4.1).
Auditing. General-purpose auditing systems, such as PeerRe-
view [33], provide strong guarantees that would beneﬁt ad ex-
changes, but they require participants (and their public keys) to
be well-known. The more specialized SPIDeR [61], though not di-
rectly applicable to auctions, has a similar ethos to VEX: SPIDeR
uses low cost, weak cryptographic primitives and couples them with
careful design to obtain security guarantees.
9 DISCUSSION AND CONCLUSION
As mentioned in the introduction and described in Section 5, VEX
has limitations. We now return to two of them. First, VEX has unde-
niable overhead. However, it is not absurd and in fact is consistent
with the price of cryptographic guarantees in systems.
Second, the auctioneer can manipulate auctions, by choice of
participants, by colluding with a bidder, or by labeling auctions
non-auditable. However, under our analysis, this is all that the auc-
tioneer can do, and given the nature of the problem—that there are
billions of latency-sensitive auctions per day, that none of the par-
ticipants know each other, that the integer comparison protocol (§3)
gives weak guarantees, that the auctioneer seems to hold all of the
cards, etc.—we were not sure that we could provide any guaran-
tees at all. So we have been pleasantly surprised that the guaran-
tees (§4.2, §5.1) appear strong enough for real use.
In fact, a natural avenue of future work is to broaden VEX’s appli-
cability: to other ads, to other auctions, and to other contexts. Con-
cerning other ads, we have assumed impression ads; we would like
to know if VEX applies to cost-per-click ads and other types. Con-
cerning other auctions, we expect that VEX’s core protocol, under
generalizations, can verify k-price auctions (winning bidder pays k-
highest bid), generalized Vickrey auctions (m items are allocated to
m bidders, who pay the m − 1-highest bid), and modiﬁed second-
price auctions (the highest bidder pays the second-highest bid plus
a ﬁxed amount). And concerning other contexts, we have phrased
the core protocol in terms of ads (Figures 4–8), but we believe that
the design is mostly independent of this context. With minor mod-
iﬁcations, it should apply to eBay, online funding platforms, and
other online auctions.
This is not to say that misbehavior is rampant in these contexts,
just that veriﬁability would be a Good Thing: it would strengthen
the service given to auction participants while lowering the barrier
to entry for new auctioneers, by reducing the trust required.
Acknowledgments
This paper was improved by comments from Allen Clement, Alan
Dunn, Lon Ingram, Arvind Krishnamurthy, Josh Leners, Srinath
Setty, Emmett Witchel, Edmund L. Wong, and the anonymous re-
viewers; and by conversations with Bobby Bhattacharjee, Amar
Goel, Saikat Guha, and Jon Howell; Maxwell Krohn brought ad
exchanges to our attention. We thank our shepherd, Dave Levin, for
his detailed attention, and abhi shelat for a particularly careful read
that identiﬁed several problems and for suggesting ﬁxes. The re-
search was supported by AFOSR grant FA9550-10-1-0073 and by
NSF grants 1055057 and 1040083, a Sloan Fellowship, and an Intel
Early Career Faculty Award.
205REFERENCES
[1] Blacks Law Dictionary. 6th edition, 1990.
[2] Cookie Matching.
http://developers.google.com/ad-exchange/rtb/cookie-guide,
Apr. 2013.
[3] DoubleClick Ad Exchange Real-Time Bidding Protocol.
https://developers.google.com/ad-exchange/rtb/downloads.
[4] DoubleClick Bid Request Message. https://developers.google.com/
ad-exchange/rtb/downloads/realtime-bidding-proto.txt.
[5] DoubleClick Ad Exchange.
http://google.com/doubleclick/advertisers/ad_exchange.html.
[6] Google Display Network. http://google.com/ads/displaynetwork.
[7] Fast SHA-256 implementations on Intel architecture processors. http://
download.intel.com/embedded/processor/whitepaper/327457.pdf.
[8] Microsoft Media Network. http://advertising.microsoft.com/
advertise/microsoft-media-network.
[9] OpenX. http://www.openx.com.
[10] PAPI. http://icl.cs.utk.edu/papi/index.html.
[11] Rightmedia. http://www.rightmedia.com.
[12] Source lines of code counter. https://github.com/bytbox/sloc.
[13] Yahoo! Advertising Solutions. http://advertising.yahoo.com.
[14] Y. Aumann and Y. Lindell. Security against covert adversaries: Efﬁcient
protocols for realistic adversaries. Journal of Cryptology, 23(2):281–343,
2010.
[15] H. Beales. The value of behavioral targeting.
http://www.networkadvertising.org/pdfs/Beales_NAI_Study.pdf,
2010.
[16] M. Bellare and P. Rogaway. Random oracles are practical: A paradigm for
designing efﬁcient protocols. In ACM CCS, Nov. 1993.
[17] P. Bogetoft, D. L. Christensen, I. Damg˚ard, M. Geisler, T. Jakobsen,
M. Krøigaard, J. D. Nielsen, J. B. Nielsen, K. Nielsen, J. Pagter,
M. Schwartzbach, and T. Toft. Secure multiparty computation goes live. In
Financial Cryptography and Data Security, Feb. 2009.
[18] F. Boudot. Efﬁcient proofs that a committed number lies in an interval. In
EUROCRYPT, May 2000.
[19] F. Brandt. How to obtain full privacy in auctions. International Journal of
Information Security, 5(4):201–216, Oct. 2006.
[20] E. Brickell, D. Chaum, I. Damg˚ard, and J. V. de Graaf. Gradual and
veriﬁable release of a secret. In CRYPTO, Aug. 1987.
[21] J. Camenisch, R. Chaabouni, and a. shelat. Efﬁcient protocols for set
membership and range proofs. In ASIACRYPT, Dec. 2008.
[22] R. Chaabouni, H. Lipmaa, and B. Zhang. A non-interactive range proof with
constant communication. In Financial Cryptography and Data Security,
Feb. 2012.
[23] V. Dave, S. Guha, and Y. Zhang. Measuring and ﬁngerprinting clickspam in
online ad networks. In ACM SIGCOMM, Aug. 2012.
[24] DoubleClick. Search before the purchase: Understanding buyer search
activity as it builds to online purchase.
http://google.com/doubleclick/research/index.html, Feb. 2005.
[25] DoubleClick. Proﬁting from non-guaranteed advertising: The value of
dynamic allocation and auction pricing for online publishers. http://www.
google.com/doubleclick/pdfs/DC_Ad_Exchange_WP_100713.pdf,
2010.
[26] DoubleClick. Google white paper: The arrival of real-time bidding and what
it means for media buyers.
http://google.com/doubleclick/research/index.html, July 2011.
[27] E. Elkind and H. Lipmaa. Interleaving cryptography and mechanism design:
The case of online auctions. In Financial Cryptography, Feb. 2004.
[28] P. Fauzi, H. Lipmaa, and B. Zhang. New non-interactive zero-knowledge
subset sum, decision knapsack and range arguments. Cryptology ePrint
Archive, Report 2012/548, Feb. 2013.
[29] A. Fiat and A. Shamir. How to prove yourself: practical solutions to
identiﬁcation and signature problems. In CRYPTO, Nov. 1986.
[30] M. K. Franklin and M. K. Reiter. The design and implementation of a secure
auction service. In IEEE Symposium on Security and Privacy, May 1995.
[31] S. Guha, B. Cheng, and P. Francis. Privad: Practical privacy in online
[32] H. Haddadi. Fighting online click-fraud using bluff ads. ACM SIGCOMM
advertising. In NSDI, Mar. 2011.
CCR, 40(2):22–25, Apr. 2010.
[33] A. Haeberlen, P. Kuznetsov, and P. Druschel. PeerReview: Practical
accountability for distributed systems. In SOSP, Oct. 2007.
[34] M. Harkavy, J. D. Tygar, and H. Kikuchi. Electronic auctions with private
bids. In USENIX Workshop on Electronic Commerce, Aug. 1998.
[35] A. Juels. Targeted advertising... and privacy too. In RSA Security
Conference, The Cryptographers’ Track, Apr. 2001.
[36] L. Lamport. Password authentication with insecure communication.
Communications of the ACM, 24(11):770–772, 1981.
[37] H. Lipmaa, N. Asokan, and V. Niemi. Secure Vickrey auctions without
threshold trust. In Financial Cryptography, Mar. 2002.
[38] S. Meiklejohn, C. C. Erway, A. K¨upc¸ ¨u, T. Hinkle, and A. Lysyanskaya.
ZKPDL: A language-based system for efﬁcient zero-knowledge proofs and
electronic cash. In USENIX Security Symposium, Aug. 2010.
[39] S. Muthukrishnan. Ad exchanges: Research issues. In Workshop on Internet
and Network Economics. Dec. 2009.
[40] M. Naor, B. Pinkas, and R. Summer. Privacy preserving auctions and
mechanism design. In ACM Conference on Electronic Commerce, Nov.
1999.
[41] K. Q. Nguyen, Y. Mu, and V. Varadharajan. Digital coins based on hash
chain. In National Information Systems Security Conference, Oct. 1997.
[42] T. Okamoto and J. Stern. Almost uniform density of power residues and the
provable security of ESIGN. In ASIACRYPT, Nov. 2003.
[43] OpenX. Openx handles more than one trillion ad requests in 2011.
http://www.openx.com/content/
openx-handles-more-one-trillion-ad-requests-2011, 2011.
[44] D. C. Parkes, M. O. Rabin, S. M. Shieber, and C. A. Thorpe. Practical
secrecy-preserving, veriﬁably correct and trustworthy auctions. In
International Conference on Electronic Commerce, Aug. 2006.
[45] M. O. Rabin, Y. Mansour, S. Muthukrishnan, and M. Yung.
Strictly-black-box zero-knowledge and efﬁcient validation of ﬁnancial
transactions. In International Colloquium on Automata, Languages and
Programming, July 2012.
[46] M. O. Rabin, R. A. Servedio, and C. A. Thorpe. Highly efﬁcient
secrecy-preserving proofs of correctness of computations and applications.
In IEEE Symposium on Logic in Computer Science, July 2007.
[47] A. Reznichenko, S. Guha, and P. Francis. Auctions in do-not-track
compliant internet advertising. In ACM CCS, Oct. 2011.
[48] N. Singer. Your online attention, bought in an instant.
http://www.nytimes.com/2012/11/18/technology/
your-online-attention-bought-in-an-instant-by-advertisers.
html, Nov. 2012. The New York Times.
[49] B. Stone-Gross, R. Stevens, R. Kemmerer, C. Kruegel, G. Vigna, and
A. Zarras. Understanding fraudulent activities in online ad exchanges. In
IMC, Nov. 2011.
[50] K. Suzuki, K. Kobayashi, and H. Morita. Efﬁcient sealed-bid auction using
hash chain. In Information Security and Cryptology, Dec. 2000.
[51] V. Toubiana, A. Narayanan, D. Boneh, H. Nissenbaum, and S. Barocas.
Adnostic: Privacy preserving targeted advertising. In NDSS, Feb. 2010.
[52] J. Trevathan and W. Read. Undesirable and fraudulent behavior in online
auctions. In SECRYPT, Aug. 2006.
[53] V. Vaidya. Cookie synching.
http://www.admonsters.com/blog/cookie-synching, Apr. 2010.
[54] N. Vratonjic, J. Freudiger, and J.-P. Hubaux. Integrity of the web content:
The case of online advertisement. In Workshop on Collaborative Methods
for Security and Privacy, Aug. 2010.
[55] N. Vratonjic, J. Freudiger, J.-P. Hubaux, and M. Felegyhazi. Securing online
advertising. Technical Report LCA-REPORT-2008-017, Laboratory for
Computer Communications and Applications, ´Ecole Polytechnique F´ed´erale
de Lausanne, July 2008.
[56] N. Vratonjic, J.-P. Hubaux, M. Raya, and D. C. Parkes. Security games in
online advertising: Can ads help secure the web? In Workshop on
Economics of Information Security, June 2010.
[57] K. Weide. Real-time bidding in the United States and Western Europe,
2010–2015. http://info.pubmatic.com/rs/pubmatic/images/IDC_
Real-Time%20Bidding_US_Western%20Europe_Oct2011.pdf, Oct.
2011.
[58] B. White, J. Lepreau, L. Stoller, R. Ricci, S. Guruprasad, M. Newbold,
M. Hibler, C. Barb, and A. Joglekar. An integrated experimental
environment for distributed systems and networks. In OSDI, Dec. 2002.
[59] A. C.-C. Yao. How to generate and exchange secrets. In FOCS, Oct. 1986.
[60] ZenithOptimedia. Quadrennial events to help ad market grow in 2012
despite economic troubles.
http://www.zenithoptimedia.com/about-us/press-releases/
zenithoptimedia-adspend-forecast-update-dec-2011, Dec. 2011.
[61] M. Zhao, W. Zhou, A. J. Gurney, A. Haeberlen, M. Sherr, and B. T. Loo.
Private and veriﬁable interdomain routing decisions. In ACM SIGCOMM,
Aug. 2012.
206