99
LL2346.Book  Page 7  Friday, August 22, 2003  2:38 PM
LL2346.Book  Page 8  Friday, August 22, 2003  2:38 PM
1
9
1 About File Services
This chapter gives an overview of Mac OS X Server file 
services, important concepts, and related security issues.
Overview
File services let clients of the Mac OS X Server access shared files, applications, and 
other resources over a network. 
Mac OS X Server includes file services based on four common protocols:
• AFP service uses the Apple Filing Protocol (AFP) to share resources with clients who 
use Macintosh or Macintosh-compatible computers.
• Windows service uses the Server Message Block (SMB) protocol to share resources 
with and provide name resolution for clients who use Windows or Windows-
compatible computers.
• FTP service uses the File Transfer Protocol to share files with anyone using FTP client 
software.
• NFS service uses the Network File System to share files and folders with users 
(typically UNIX users) who have NFS client software.
You can use the following Mac OS X Server applications to set up and manage file 
services:
• Server Admin Use to turn on and configure individual file services for each protocol
• Workgroup Manager Use to create share points and set access privileges
You can also perform most setup and management tasks by typing commands at a 
command prompt in Terminal. For more information, see the file services chapter of the 
command-line administration guide.
LL2346.Book  Page 9  Friday, August 22, 2003  2:38 PM
10
Chapter 1    About File Services
Privileges
Privileges specify the type of access users have to shared items. There are four types of 
access privileges you can assign to a share point, folder, or file:  Read & Write, Read 
Only, Write Only, and None. The table below shows how the privileges affect user 
access to different types of shared items (files, folders, and share points).
You can assign everyone but its owner Write Only privileges to a folder to create a drop 
box. The folder’s owner can see and modify the drop box’s contents. Everyone else can 
only copy files and folders into the drop box, without seeing what it contains.
Note:  QuickTime Streaming Server and WebDAV have separate privileges settings. For 
information about QTSS, refer to the QTSS online help and the QuickTime website 
(www.apple.com/quicktime/products/qtss/). You’ll find information about Web 
privileges in the Web technologies administration guide. 
Users can
Read 
& Write
Read 
Only
Write 
Only
None
Open a shared file
Yes
Yes
No
No
Copy a shared file
Yes
Yes
No
No
Open a shared folder or share point
Yes
Yes
No
No
Copy a shared folder or share point
Yes
Yes
No
No
Edit a shared file’s contents
Yes
No
No
No
Move items into a shared folder or share point
Yes
No
Yes
No
Move items out of a shared folder or share point
Yes
No
No
No
LL2346.Book  Page 10  Friday, August 22, 2003  2:38 PM
Chapter 1    About File Services
11
Explicit Privileges
Share points and the shared items they contain (including both folders and files) have 
separate privileges. If you move an item to a different folder, it retains its own privileges 
and doesn’t automatically adopt the privileges of the folder where you moved it. In the 
following illustration, the second folder (Designs) and the third folder (Documents) 
were assigned privileges that are different from those of their parent folders:
You can also set up an AFP or SMB share point so that new files and folders inherit the 
privileges of their parent folder. See “Changing Apple File Settings for a Share Point” on 
page 23 or “Changing Windows (SMB) Settings for a Share Point” on page 24.
The User Categories Owner, Group, and Everyone
You can assign access privileges separately to three categories of users:
Owner
A user who creates a new item (file or folder) on the file server is its owner and 
automatically has Read & Write privileges for that folder. By default, the owner of an 
item and the server administrator are the only users who can change its access 
privileges, that is, allow a group or everyone to use the item. The administrator can also 
transfer ownership of the shared item to another user. 
Note:  When you copy an item to a drop box on an Apple file server, ownership of that 
item is transferred to the owner of the drop box. This is done because only the owner 
of the drop box has access to items copied to it.
Group
You can put users who need the same access to files and folders into group accounts. 
Only one group can be assigned access privileges to a shared item. For more 
information on creating groups, see the user management guide.
Everyone
Everyone is any user who can log in to the file server:  registered users and guests.
Engineering
Read & Write
Designs
Documents
Read Only
Read & Write
LL2346.Book  Page 11  Friday, August 22, 2003  2:38 PM
12
Chapter 1    About File Services
Hierarchy of Privileges
If a user is included in more than one category of users, each of which has different 
privileges, these rules apply:
• Group privileges override Everyone privileges.
• Owner privileges override Group privileges.
For example, when a user is both the owner of a shared item and a member of the 
group assigned to it, the user has the privileges assigned to the owner.
Client Users and Privileges
Users of AppleShare Client software can set access privileges for files and folders they 
own. Windows file sharing users can set folder properties, but not privileges. 
Privileges in the Mac OS X Environment
If you’re new to Mac OS X and are not familiar with UNIX, it’s important to know that 
there are some differences in the way ownership and privileges are handled compared 
to Mac OS 9.
To increase security and reliability, Mac OS X sets many system directories, such as 
/Library, to be owned by the root user (literally, a user named “root”). Files and folders 
owned by root can’t be changed or deleted by you unless you’re logged in as the root 
user. Be careful—there are few restrictions on what you can do when you log in as the 
root, and changing system data can cause problems.
Files and folders are, by default, owned by the user who creates them. After they’re 
created, items keep their privileges even when moved, unless the privileges are 
explicitly changed by their owners or an administrator. 
Therefore, new files and folders you create are not accessible by client users if they are 
created in a folder for which the users do not have privileges. When setting up share 
points, make sure that items allow appropriate access privileges for the users with 
whom you want to share them.
LL2346.Book  Page 12  Friday, August 22, 2003  2:38 PM
Chapter 1    About File Services
13
Customizing the Mac OS X Network Globe
The Network globe you find at the top level of a Mac OS X Finder window contains 
shared network resources. You can customize the contents of the Network globe to suit 
your clients by setting up automatically-mounting share points. You can provide 
automatic access to system resources such as fonts and preferences by automatically 
mounting share points containing them in specific directory locations.
Share Points in the Network Globe
The Network globe on OS X clients represents the /Network directory. By default, the 
Network globe contains at least these folders:
• Applications
• Library
• Servers
You can mount share points into any of these folders. See “Automatically Mounting 
Share Points for Clients” on page 29 for instructions.
Additional servers and shared items are added as they are discovered on your network.
Adding System Resources to the Network Library Folder
The Library folder in the Network globe is included in the system search path. This 
gives you the ability to make available, over the network, any type of system resource 
usually found in the local Library folder. These resources could include fonts, 
application preferences, ColorSync profiles, desktop pictures, and so forth. You can use 
this capability to customize your managed client environment.
For example, suppose you wish to have a specific set of fonts available to each user in a 
given Open Directory domain. You would create a share point containing the desired 
fonts and then set the share point to mount automatically as a shared library in 
/Network/Library/Fonts on client machines. See “Automatically Mounting Share Points 
for Clients” on page 29 for more information.
LL2346.Book  Page 13  Friday, August 22, 2003  2:38 PM
14
Chapter 1    About File Services
Security Considerations
Security of your data and your network is critical. The most effective method of 
securing your network is to assign appropriate privileges for each file, folder, and share 
point as you create it.
Be careful when creating and granting access to share points, especially if you’re 
connected to the Internet. Granting access to Everyone, or to World (in NFS service), 
could potentially expose your data to anyone on the Internet.
NFS share points don’t have the same level of security as AFP and SMB, which require 
user authentication (typing a user name and password) to gain access to a share point’s 
contents. If you have NFS clients, you may want to set up a share point to be used only 
by NFS users. 
Restricting Access for Unregistered Users (Guests)
When you configure any file service, you have the option of turning on guest access. 
Guests are users who can connect to the server anonymously without entering a valid 
user name or password. Users who connect anonymously are restricted to files and 
folders with privileges set to Everyone.
To protect your information from unauthorized access, and to prevent people from 
introducing software that might damage your information or equipment, you can take 
these precautions using the Sharing module of Workgroup Manager:
• Share individual folders instead of entire volumes. The folders should contain only 
those items you want to share.
• Set privileges for Everyone to None for files and folders that guest users shouldn’t 
access. Items with this privilege setting can be accessed only by the item’s owner or 
group.
• Put all files available to guests in one folder or set of folders. Assign the Read Only 
privilege to the Everyone category for that folder and each file within it. 
• Assign Read & Write privileges to the Everyone category for a folder only if guests 
must be able to change or add items in the folder. Make sure you keep a backup 
copy of information in this folder. 
• Check folders frequently for changes and additions and use a virus-protection 
program regularly to check the server for viruses.
• Disable anonymous FTP access using the FTP service settings in Server Admin.
• Don’t export NFS volumes to World. Restrict NFS exports to a subnet or a specific list 
of computers. 
LL2346.Book  Page 14  Friday, August 22, 2003  2:38 PM
Chapter 1    About File Services
15
For More Information About File Services
For more information about the protocols used by file services, see these resources:
• Apple Filing Protocol (AFP)  www.apple.com/developer/
• Server Message Block (SMB) protocol (for Windows file services)  www.samba.org
• FTP  You can find a Request for Comments (RFC) document about FTP at 
www.faqs.org/rfcs/rfc959.html. To obtain the UNIX manual pages for FTP, open the 
Terminal application in Mac OS X. At the prompt, type man ftp and press Return.
• NFS  Search the Web for “Network File System”
RFC documents provide an overview of a protocol or service that can be helpful for 
novice administrators, as well as more detailed technical information for experts. You 
can search for RFC documents by number at this website:  www.faqs.org/rfcs.
LL2346.Book  Page 15  Friday, August 22, 2003  2:38 PM
LL2346.Book  Page 16  Friday, August 22, 2003  2:38 PM
2
17
2 Setting Up Share Points
This chapter shows how to share specific volumes and 
directories via the AFP, SMB, FTP, and NFS protocols.
Overview
You use the Sharing module of Workgroup Manager to share information with clients 
of the Mac OS X Server and control access to shared information by assigning access 
privileges.
To share individual folders or entire volumes that reside on the server, you set up share 
points. A share point is a folder, hard disk, hard disk partition, CD, or DVD that you 
make accessible over the network. It’s the point of access at the top level of a hierarchy 
of shared items. Users with privileges to access share points see them as volumes 
mounted on their desktops or in their Finder windows.
Before You Begin
Consider the following topics before you set up a share point.
Consider the Privileges Your Clients Need
Before you set up a share point, you need to understand how privileges for shared 
items work. Consider which users need access to shared items and what type of 
privileges you want those users to have. Privileges are described in Chapter 1 (see 
“Privileges” on page 10). 
LL2346.Book  Page 17  Friday, August 22, 2003  2:38 PM
18
Chapter 2    Setting Up Share Points
Decide on Which Protocols to Use
You also need to know which protocols clients will use to access the share points. In 
general, you will want to set up unique share points for each type of client and share 
each using a single protocol:
• Mac OS clients—Apple Filing Protocol (AFP)
• Windows clients—Server Message Block (SMB)
• UNIX clients—Network File System (NFS)
• FTP clients—File Transfer Protocol (FTP)
In some cases you might want to share an item using more than one protocol. For 
example, Mac OS and Windows users might want to share graphics or word processing 
files that can be used on either platform. In a case such as this, you can create a single 
share point that supports users of both platforms.
Conversely, you might want to set up share points using a single protocol even though 
you have different kinds of clients. For example, if most of your clients are UNIX users 
and just a few are Mac OS clients, you may want to share items using only NFS to keep 
your setup simple. Keep in mind, however, that NFS doesn’t provide many AFP features 
that Mac OS users are accustomed to, such as performance optimization or quick file 
searching. 
Organize Your Shared Information
Once you have created share points, users will start to form “mental maps” of the 
organization of the share points and the items they contain. Changing share points and 
moving information around can cause confusion. If you can, organize shared 
information before you set up the share points. This is especially important if you’re 
setting up network home directories.
For Your Windows Users
If you share applications or documents that are exclusively for Windows users, you can 
set up an SMB share point to be used only by them. This provides a single point of 
access for your Windows users and lets them take advantage of both opportunistic and 
strict file locking.
LL2346.Book  Page 18  Friday, August 22, 2003  2:38 PM
Chapter 2    Setting Up Share Points
19
Opportunistic Locking (oplocks)
SMB share points in Mac OS X Server support the improved performance offered by 
opportunistic locking (“oplocks”).
In general, file locking prevents multiple clients from modifying the same information 
at the same time; a client locks the file or part of the file to gain exclusive access. 
Opportunistic locking grants this exclusive access but also allows the client to cache its 
changes locally (on the client computer) for improved performance. 
To enable oplocks, you change the Windows protocol settings for a share point using 
Workgroup Manager.
Important:  Do not enable oplocks for a share point that’s using any protocol other 
than SMB.
Strict Locking
It’s normally the responsibility of a client application to see if a file is locked before it 
tries to open it. A poorly written application may fail to check for locks, and could 
corrupt a file already being used by someone else.
Strict locking, which is enabled by default, helps prevent this. When strict locking is 
enabled, the SMB server itself checks for and enforces file locks.
Consider Security
Review the issues discussed in “Security Considerations” on page 14.
Share Points for Network Home Directories
If you’re setting up a share point on your server to store user home directories, keep 
these points in mind:
• There’s a share point named Users already set up when you install Mac OS X Server 
that you can use for home directories.
• Make sure you set the Network Mount settings for the share point to indicate that it’s 
used for user home directories.
• Make sure you create the share point in the same Open Directory domain as your 
user accounts.
Disk Quotas
You can limit the disk space a user’s home directory can occupy by setting a quota on 
the Home pane of the user’s account settings in Workgroup Manager.
To set space quotas for other share points, you must use the command line. See the file 
services chapter of the command-line administration guide.
LL2346.Book  Page 19  Friday, August 22, 2003  2:38 PM
20
Chapter 2    Setting Up Share Points
Setup Overview
You use the Sharing module of Workgroup Manager to create share points and set 
privileges for them. 
Here is an overview of the basic steps for setting up share points:
Step 1:  Read “Before You Begin”
Read “Before You Begin” on page 17 for issues you should consider before sharing 
information on your network.
Step 2:  Locate or create the information you want to share
Decide which volumes, partitions, or folders you want to share. You may want to move 
folders and files to different locations before setting up the share point. You may want 
to partition a disk into volumes so you can give each volume different access privileges 
or create folders that will have different levels of access. See “Organize Your Shared 
Information” on page 18.
Step 3:  Set up share points and set privileges
When you designate an item to be a share point, you set its privileges at the same time. 
You create share points and set privileges in the Sharing module of Workgroup 
Manager. See “Setting Up a Share Point” on page 21.
Step 4:  Turn specific file services on
For users to access share points, you must turn on the required Mac OS X Server file 
services. For example, if you use Apple File Protocol with your share point, you must 
turn on AFP service. You can share an item using more than one protocol. See 
Chapter 3, “AFP Service,” on page 37, Chapter 4, “Windows Service,” on page 55, 
Chapter 5, “NFS Service,” on page 69, or Chapter 6, “FTP Service,” on page 75.
LL2346.Book  Page 20  Friday, August 22, 2003  2:38 PM
Chapter 2    Setting Up Share Points
21
Setting Up a Share Point
This section describes:
• How to create share points
• How to set share point access privileges
• How to share using specific protocols (AFP, SMB, FTP, or NFS)
• How to automatically mount share points on clients’ desktops
You use Workgroup Manager to accomplish these tasks.
See “Managing Share Points” on page 30 for additional tasks that you might perform 
after you have set up sharing on your server.
LL2346.Book  Page 21  Friday, August 22, 2003  2:38 PM
22
Chapter 2    Setting Up Share Points
Creating a Share Point and Setting Privileges
You use the Sharing module of Workgroup Manager to share volumes (including disks, 
CDs and DVDs), partitions, and individual folders by setting up share points. 
Note:  Don’t use a slash (/) in the name of a folder or volume you plan to share. Users 
trying to access the share point might have trouble seeing it.
To create a share point and set privileges:
1 Open Workgroup Manager and click Sharing.
2 Click All and select the item you want to share.
3 Click General.
4 Select “Share this item and its contents.”
5 To control who has access to the share point, change the owner or group of the shared 
item. Type names or drag names from the Users & Groups drawer. 
To open the drawer, click Users & Groups. If you don’t see a recently created user or 
group, click Refresh. To change the autorefresh interval, choose Workgroup Manager > 
Preferences.
6 Use the pop-up menus next to the fields to change the privileges for the Owner, Group, 
and Everyone.
Everyone is any user who can log in to the file server:  registered users and guests.
7 (Optional) To apply the ownership and privileges of the share point to all files and 
folders it contains, click Copy. This overrides privileges that other users may have set.