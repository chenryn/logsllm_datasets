大的底线，从而赢得真正的竞争优势。然而，这种情况并不是经常
发生，我相信这在很大程度上是由于广告客户的工作人员动力不足
所致。
在购买在线广告的公司内部，个体员工的动力可能会阻碍保护公司
免受广告欺诈。例如，有一家广告购买商认识到公司的其中一个供
应商向公司多收取了好几千美元的费用。按说，这家公司应该立即
追究这个事情，很可能把它提交给公司法律顾问或其他管理人员。
但是在向上追查时，这家广告购买商将不可避免地承认它以前的失
败，事实上它向供应商多支付了几个月才发现这种欺诈行为。我与
广告购买商的交谈使我确信这些令人尴尬的效果是真实存在的。广
告购买商觉得自已之前就该了解此事，并且它们会在本能上责备自
己。或者不管如何，它们总是试图平息错误的事态。
同样严重的是，有些广告客户通过某些途径对广告购买商进行补
偿，致使广告购买商缺少追究欺诈的动力。假设公司把在线广告总
花费的10%支付给一家广告购买商，这家广告购买商很难拒绝来自
虚假来源的广告。对于公司在那里所花费的每一美元，这家广告购
买商将得到10美分的回报。这种补偿比局外人所想象的要普遍得
多。许多广告客户就是通过这种方式向它们的外部广告代理提供补
偿的。
对于内部广告购买商，这个动机甚至可能更加明显。例如，一位
（）
CPA程序年度增长额的20%。如果一个程序的毛收入从50万美元增加
到80万美元，这位经理可以得到非常可观的6万美元的奖金。但是，
如果这位经理发现了5万美元的欺诈金额，他的奖金就将减少1万美
元。即使对于最具奉献精神的员工，这也是一剂难以下咽的苦药。
毫不奇怪的是，许多广告联盟程序甚至无法拒绝即使是最臭名昭著
的罪犯。
类似的动机问题也困扰着广告网络公司对它们的伙伴、下属机构和
经营者的监管。如果一家广告网络公司承认它的一部分流量是欺诈
性的，它就需要在商家所收取的费用中扣除相关的部分。反之，如
果隐藏或否认这个问题，广告网络公司所收取的费用就更高。大的
问题无法永远隐瞒，但是通过拖延或低调处理欺诈事件，广告网络
公司可以增加短期的收益。
2321
---
## Page 2323
6.2.4其他采购坏境的教训：在线采购的特殊挑战
当大型公司采购供应品时，它们一般成立具有健壮的内部控制的采
购部门。考虑一下顶级生产商对供应链的监管方式：经过精心培训
的工作人员所组成的采购部门对候选生产商进行评估，以证实它们
是合法和诚信的商家。在线广告行业的许多公司已经发展了规模更
大的供应网络。例如，至少有几十万家网站向Google的AdSense服务
方法对发行者进行评估。
事实上，在线广告的两个特点使在线广告的采购比其他环境的采购
更为艰难。首先，广告媒体倾向于它们将在哪里刊登广告持保密态
度。由于担心竞争对手撬走它们的顶级合作伙伴，因此广告网络公
司把它们的发行者名单作为机密。但是这样一来，从GoogleAdSense
或ValueClickMedia处进行购买的广告客户就无法知道有哪些网站刊
登了它们的广告。因此，广告客户就没有办法通过手工检查合作伙
伴的网站来证实它们的正当性和合法性。
而且，即使有一家发行者由于违反了某个可施行的规则而被捕获，
也仍然很滩防正它用一个新名字和URL重起炉灶。因此，即使在线
广告客户即使设法检测到了不法分子，但是仍然对它们无计可施。
在我的论文"通过优化的延迟付款策略阻止在线广告欺诈”山中，我
建议了另外一种方法：延迟付款2到4个月，这样如果发行者的恶行
被发现，它将面临经济上的损失。但是，到目前为止，大多数广告
客户仍然采用快速付款的方法，使发行者进行欺诈时遭到处罚的风
险很小。而且，广告客户仍然把快速付款作为一项优点，而没有意
识到太快的付款将会导致它们在发现欺诈时仍然无能为力。
[1] Edelman,Benjamin."Deterring Online Advertising Fraud Through
http://ssrn.com/abstract=1095262。
6.3创建在线广告的责任制
在线广告仍然是“狂野西部”，用户常常会遇到他们不该信任的广
告，公司常常会过度地支付广告费用，而没有收到承诺的回报。但
是，事情并不一定要这样发展。公共机构开始有所作为，提醒厂告
客户和广告网络公司，长远的消费者保护规则同样适用于在线厂
2322
---
## Page 2324
告。并且，随着广告客户变得越来越老练，它们将越来越不能容忍
那些无法确认得到的服务的不透明收费。
同时，在线广告经济为那些具有跨学科兴趣并结合了软件工程师的
创造性、侦探的敏锐噢觉和公仆的奉献精神的人们提供了令人兴奋
的机遇。好好工作，抓住那些坏蛋们！
第7章PGP信任网络的演变
Jon Callas
当PGP（PrettyGoodPrivacy）于1991年问世时，人们才开始使用以
前只有重要的政府部门才能使用的强大加密技术。
对于人权组织和世界上关注隐私问题的其他用户而言，PGP带来了
新的机会，但它同时也带来了一些容易被误解的法律问题，稍后我
们将讨论这些话题。
PGP最重要的特点之一就是它为从未谋面的人们（因此完全没有机
会交换安全密钥）之间的安全联系提供了解决方案。这个解决方案
很快赢得了“信任网络（WebofTrust）"的绰号，这个名称非常准确
地描述了这个系统的操作方式。
PGP的信任机制与它早期发布时相比已经演变了很多。我们有必要
研究这个信任模型的采用原因以及PGP为了提供更好的健壮性而进
行演变的方式。
信任网络还提供了一个有趣的历史角度，因为它是一种早期的对等
设计，毫无疑问是最早的社交网络之一。
关于PGP以及实用的公钥加密技术的论著已经有很多。但是，令人
沮丧的是，有许多论著包含了大量不准确的内容。在本章中，我们
的目标是描述PGP信任模型和它的实现、标准化和用途。我们还将
在历史和政治的语境中讨论这些内容。
7.1PGP和OpenPGP
2323
---
## Page 2325
PGP是软件，OpenPGP是标准和协议。PGP还是PGP公司所拥有的一
个注册商标（并包括相关的术语"PrettyGoodPrivacy"和"Pretty
Good"）。
在PGP成为协议之前，它只是个软件。这个概念非常重要，因为目
前我们使用"PGP"这个术语表示PGP公司所开发的软件。这个软件实
现了一些标准和协议，其中包括OpenPGP。另外，PGP是OpenPGP标
准的许多实现的其中一种。但是，OpenPGP标准的许多东西都来自
PGP，因此并没有严格定义的术语区分OpenPGP之前的软件和
OpenPGP之前的协议。
OpenPGP协议的核心是根据IETFRFC4880和RFC3156定义的。早期
的PGP协议是由RFC1991定义的。因此，我们将用PGP表示早期的软
件，用RFC1991表示早期的协议。
7.2信任、验证和授权
信任是一个很广阔的概念。在许多上下文环境中，它意味着许多东
西。在本章中，我们将使用狭窄的、严格的定义：信任就是决定
一
个密钥是否合法的机制。如果一个密钥确实是一个声称拥有它的人
所拥有的，它就是合法的。换句话说，如果与密钥相关的描述信息
是准确的，这个密钥就是合法的。我们告诉PGP谁是我们所信任的
密钥介绍人，然后PGP告诉我们哪些密钥是合法的。
因此，如果一个密钥声称它的主人就是拥有电子邮件地
址"Alice"PI:EMAIL的人，并且这个信息是准确的，那么这
个密钥就是合法的（或准确的）。如果Bob因为Charlie对这个密钥进
行了签名而相信它是合法的，那么Bob就认为Alice的密钥是合法
的，因为他信任Charlie。
让我们从下面这个定义开始展开讨论：
然后我们转移到“信任"的定义：
“信任"是决定一个密钥是否合法的机制。
2324
---
## Page 2326
大多数人会混淆信任和合法这两个术语，即便像我们这种最了解信
任网络的人有时也会犯错。合法只是一个评分，只能用于确定一个
密钥的名称是否准确。信任是一种关系，可以帮助我们确定是否合
法。
我们告诉PGP谁是我们所信任的密钥介绍人，然后PGP告诉我们哪些
密钥是合法的。它根据密钥签名人以及我们对密钥签名人的信任程
度为每个密钥设置一个分数。（PGP把签名人称为介绍人，稍后将
介绍其中的原因。）
例如，如果Bob相信Charlie所签名的密钥是合法的，那么Charlie可以
签名Alice的密钥并且Bob将会信任这个密钥，因为他信任Charlie。
信任模型是一种通用方案，对信任进行形式化，使计算机可以自动
进行信任计算。下面我们讨论信任模型的基础知识。
7.2.1直接信任
直接信任是最简单易懂的信任类型。在直接信任中，Bob信任一个认
证是Alice的，因为Alice把它交给了Bob。这是最佳的信任模型，简
单到用不着想个名称来描述它。它不仅是最简单的信任模型，而且
也是最值得信任的模型。
人们随时都在使用直接信任，例如在他们的电子邮件或商业信用卡
上加上一个OpenPGP密钥指纹（它本身是一个OpenPGP密钥的一个
散列值）。甚至还有更简单的，如果我把自己的密钥通过电子邮件
发送给你，我们就在使用直接信任。你将信任这个密钥是合法的，
因为如果出了错，我只会伤害到我自己。
在直接信任系统中，常常由一个证书保存这个证书本身所签名的密
钥。换句话说，它是自签名的。自签名非常实用，因为它提供了一
致的检查。我们知道，一个自签名的证书要么完全正确，要么完全
不止确。
直接信任的唯一问题是它无法迅速得到扩展，无法适合Intermet的规
模。但这并不意味着它是不实用的，只能说它的伸缩性不够强。
7.2.2层次式信任
2325
---
## Page 2327
层次式信任也非常简单明了。在层次式信任中，我们信任一个证书
合法的原因是因为它是由一个我们所信任的人签名的，就像前面所
举的例子一样。Bob认为Alice的证书是合法的，因为它是由Charlie
签名的。Bob相信Charlie得到了授权，可以进行正确的签名。有许多
公司提供了类似Charlie这样的角色的业务。例如，GoDaddy和
VeriSign就是两家受到广泛信任的认证中心（CA）。它们受到信任
是使用一些数量较少的密钥，对信任进行扩展。这些密钥本身保存
在根证书中（它们是自签名的证书）。根证书中的密钥对其他证书
中的密钥进行签名。这个过程可以经过几次扩展，一直延伸到我们
所感兴趣的实际证书。
为了对证书进行验证，我们可以跟踪一个证书链。Alice的证书是由
一个证书所签名的，后者文是由另一个证书所签名的，而最后这个
证书文是由Jack所创建的证书所签名的。许多大型公司、政府部门
等都拥有自已所创建和维护的层次式信任。
在网络上，SSL连接所使用的X.509类型的证书就使用了层次式的信
任。如果我们访问Amazon.com，它的Web服务器拥有一个通过层次
式信任所签名的证书，最终可以回溯到我们所信任的一个根证书。
这些商业的认证中心一般使用两层或三层的深度。
任。Web浏览器内置了一组根证书。我们可以把它们看成是合法
的，因为它们是我们所安装的软件的组成部分。这是一个重要的概
念：层次式信任最终是从直接信任扩展而来的。
层次式信任简单明了，但具有一个明显的风险。如果授权方发生了
错误，那么这个错误所造成的影响也将非常大。这个问题有过一个
臭名昭著的例子，Microsoft在它的代码签名系统Authenticode中使用
了一个层次式信任系统。这个层次结构是由VeriSign所维护的。几年
前，一些歹徒说服VeriSign，相信他们是Microsoft的员工，但实际上
并不是。VeriSign向不是Microsoft公司的人发布了Microsft代码签名证