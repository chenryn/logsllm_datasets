LTE REDIRECTION
Forcing Targeted LTE Cellphone into Unsafe Network
Wanqiao Zhang
Unicorn Team – Communication security researcher
Haoqi Shan
Unicorn Team – Hardware/Wireless security researcher
Qihoo 360 Technology Co. Ltd.
LTE and IMSI catcher myths
• In Nov. 2015, BlackHat EU, Ravishankar Borgaonkar, and Altaf Shaik etc. 
introduced the LTE IMSI catcher and DoS attack.
IMSI Catcher
Once a cellphone goes through 
the fake network coverage area, 
its IMSI will be reported to the 
fake network. 
DoS Attack
DoS message examples:
ü You are an illegal cellphone!
ü Here is NO network available. You 
could shut down your 4G/3G/2G 
modem. 
Redirection Attack
Malicious LTE: “Hello 
cellphone, come into my 
GSM network…” 
Demo
Fake LTE Network
Fake GSM Network
USRPs
Demo Video
Risk
• If forced into fake network
• The cellphone will have no service (DoS).
• The fake GSM network can make malicious call and SMS.
• If forced into rogue network
• All the traffic (voice and data) can be eavesdropped. 
A femtocell
controlled
by attacker
LTE Basic Procedure
• (Power on)
• Cell search, MIB, SIB1, SIB2 and other SIBs
• PRACH preamble
• RACH response
• RRC Connection Request
• RRC Connection Setup
• RRC Connection Setup Complete + NAS: Attach request + ESM: 
PDN connectivity request
• RRC: DL info transfer + NAS: Authentication request
• RRC: UL info transfer + NAS: Authentication response
• RRC: DL info transfer + NAS: Security mode command
• RRC: UL info transfer + NAS: Security mode completer
• ……
Unauthorized area
Attack Space!
Procedure of IMSI Catcher
Firstly send a TAU 
reject, then cellphone 
will send Attach 
Request, with its IMSI!
Procedure of DoS Attack
Attach Reject message 
can bring reject cause. 
Some special causes 
result in NO service on 
cellphone.
Procedure of Redirection Attack
RRC Release message 
can bring the cell info 
which it can let cellphone 
re-direct to. 
How to Build Fake LTE Network
• Computer + USRP
How to Build Fake LTE Network
• There are some popular open source LTE projects:
• Open Air Interface by Eurecom
• http://www.openairinterface.org/
• The most completed and open source LTE software
• Support connecting cellphone to Internet
• But have complicated software architecture
• OpenLTE by Ben Wojtowicz
• http://openlte.sourceforge.net/
• Haven’t achieved stable LTE data connection but functional enough for fake LTE network
• Beautiful code architecture
• More popular in security researchers
OpenLTE
OpenLTE Source Code (1/3)
In current OpenLTE release, the TAU request isn’t handled.
But TAU reject msg packing function is available. 
So we could add some codes to handle TAU case and give appropriate TAU 
reject cause.  
Procedure of IMSI Catcher
Firstly send a TAU 
reject, then cellphone 
will send Attach 
Request, with its IMSI!
OpenLTE Source Code (1/3)
Set the mme procedure as TAU REQUET
Call the TAU reject msg packing function
Refer to Attach reject function
OpenLTE Souce Code (2/3)
DoS attack can directly utilize the cause setting in Attach Reject message.  
Procedure of DoS Attack
Attach Reject message 
can bring reject cause. 
Some special causes 
result in NO service on 
cellphone.
OpenLTE Source Code (3/3)
redirectCarrierInfo can be inserted into RRC Connection Release message. 
OpenLTE Source Code (3/3)
Procedure of Redirection Attack
RRC Release message 
can bring the cell info 
which it can let cellphone 
re-direct to. 
Think from the other side
Attacker
Defender
Why is RRC redirection message not encrypted?
Is This a New Problem?
• "Security Vulnerabilities in the E-RRC Control Plane", 
3GPP TSG-RAN WG2/RAN WG3/SA WG3 joint meeting, 
R3-060032, 9-13 January 2006
• This document introduced a ‘Forced handover’ attack:
An attacker with the ability to generate RRC signaling—that is, any of the forms of
compromise listed above—can initiate a reconfiguration procedure with the UE, directing
it to a cell or network chosen by the attacker. This could function as a denial of service (if
the target network cannot or will not offer the UE service) or to allow a chosen network to
“capture” UEs.
An attacker who already had full control of one system (perhaps due to weaker security on
another RAT) could direct other systems’ UEs to “their” network as a prelude to more
serious security attacks using the deeply compromised system. Used in this way, the ability
to force a handover serves to expand any form of attack to UEs on otherwise secure
systems, meaning that a single poorly secured network (in any RAT that interoperates with
the E-UTRAN) becomes a point of vulnerability not only for itself but for all other
networks in its coverage area.
3GPP’s Decision
• “Reply LS on assumptions for security procedures”, 3GPP TSG SA WG3 
meeting #45, S3-060833, 31st Oct  - 3rd Nov 2006
(1) RRC Integrity and ciphering will be started only once during the attach 
procedure (i.e. after the AKA has been performed) and can not be de-
activated later.
(2) RRC Integrity and ciphering algorithm can only be changed in the case of 
the eNodeB handover.
Why 3GPP Made Such Decision
• In special cases, e.g. earthquake, hot events
• Too many people try to access one base station then make this base station overloaded. 
• To let network load balanced, this base station can ask the new coming cellphone to 
redirect to another base station. 
• If you don’t tell cellphones which
base station is light-loaded,
the cellphones will blindly
and inefficiently search one
by one, and then increase 
the whole network load.
Overloaded
Base station
Overloaded
Base station
Overloaded
Base station
Light-loaded
Base station
Network Availability vs.. Privacy
• Global roaming
• Battery energy saving
• Load balance
• IMSI Catcher
• DoS Attack
• Redirection Attack
VS.
Basic  requirement
High level  requirement
e.g. Wifi MAC addr tracking
Countermeasures  (1/2)
• Cellphone manufacture – smart response
• Scheme 1: Don’t follow the redirection command, but auto-search other available base 
station.
• Scheme 2: Follow the redirection command, but raise an alert to cellphone user: Warning! 
You are downgraded to low security network.
Countermeasures  (2/2)
• Standardization effort
• Fix the weak security of legacy network: GSM
• 3GPP TSG SA WG3 (Security) Meeting #83, S3-160702, 9-13 May 
2016 Legacy Security Issues and Mitigation Proposals, Liaison 
Statement from GSMA. 
• Refuse one-way authentication
• Disabling compromised encryption in mobile
Acknowledgements
• Huawei
• Peter Wesley (Security expert)
• GUO Yi (3GPP RAN standardization expert)
• CHEN Jing (3GPP SA3 standardization expert)
• Qualcomm
• GE Renwei (security expert)
• Apple
• Apple product security team
Thank you!