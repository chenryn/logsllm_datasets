当图像的缩放产生更少的像素时，核函数的窗口需要在s上移动一个特定的步长，这类似于信号处理中的采样过程。采样比例定义了这个步长，所以每个采样点由下式给出
其中，p是d中的目标像素，g(p)是我们放置核窗口的位置。  
所以缩放后得到的图像为：
不同的缩放算法有不同的核函数，比如最近邻缩放的核函数为：
该算法只使用最接近g(p)的值，换句话说，最近邻缩放只是简单的将像素从离散网格上的s复制到d。  
不同核函数使用的像素数量以及为像素限定的权重都是不同的。  
下图展示了通用缩放算法中的标准核函数的可视化
上面已经介绍了信号处理的基本知识。现在我们可以研究图像缩放攻击可以存在的根本原因了。  
我们从之前的分析已经知道，源图像中的所有像素对缩放后的图像的贡献是不同的，在缩放过程中，靠近核中心的像素获得较高的权重，而所有剩余的像素只有有限的作用，如果步长超过核宽，一些像素会被忽略，直接和缩放过程无关了。我们在上上副图也可以看到，在缩放时，我们只考虑了9个点中的3个。  
源图像中的像素对缩放后图像的不平等的贡献，为图像缩放攻击提供了基础。攻击者只需要修改具有高权重的像素来控制缩放，同时可以保持图像的其余部分不变。  
从信号处理的角度来看，图像缩放攻击可以被解释为有针对性的混叠，其中攻击者刻意选择下采样期间被会被采用的信号区域，而这些区域在源图像中产生一个高频信号，在空域不可见。  
图像缩放攻击还依赖于高权重的像素的稀疏性，如果这些像素密集，则攻击者扰动后的图像就与源图像存在较大差异，不满足图像缩放攻击的隐蔽性。  
事实上，两个因素决定了这些像素的稀疏性：缩放比率和核宽度  
缩放比率越大，则缩放时考虑的像素越少，在下图可以看到，β= 4时，攻击图像看起来像源图像，而猫是不可见的。β=
1.3时，攻击图像是源图像和目标图像的混合。β = 1，攻击显然失败。  
核宽度越小，那么每次卷积时考虑的像素就越少，在下图可以看到，a取下图的三个值，攻击图像都可以在缩放后得到猫，但是只有a=1时，攻击图像是咖啡杯，a=2时，虽然总体是咖啡杯，但是能看见猫的样子，a=4时则只有猫了，不满足前面提到的攻击目标2.  
调整缩放比率和核宽度，从下图的结果可知，缩放比率高，核宽度小，则攻击更容易成功。
## 实战：
我们首先需要一个源图像和目标图像。分别使用猫和咖啡杯
接下来需要选择缩放算法和对应的图像处理库，这里缩放算法我们选择最近邻插值算法，这是最简单的图像缩放算法，也是默认的算法，图像处理库选择opencv
然后生成一个缩放对象来保存缩放矩阵
其中的create_scaling_approach定义如下
接下来可以开始攻击了,这里我们将eps设置为1，即确保缩放后的攻击图像与目标图像之间最大差值为1
其中QuadraticScaleAttack类定义如下
关键函数有两个，分别是attack_in_one_direction以及solve_problem
我们前面已经说过，成功的缩放攻击需要满足两个目标  
1.攻击图像和源图像尽可能相似  
2.缩放后的攻击图像与目标图像尽可能相似  
先来看看目标1是否满足
可以看到，源图像与目标图像差异不大，它们都是咖啡杯的样子而不是猫，满足目标1  
再来看看目标2  
需要将攻击图像进行缩放处理(这一步就是在正常的机器学习流程中的预处理步骤)，然后同时打印出目标图像与缩放后的图像
可以看到缩放后的图像不是size更小的咖啡杯而是猫，且它和目标图像一模一样，说明也满足目标2，证明缩放攻击成功了。这个output图像是模型在训练时实际使用的图像，攻击者可以使用这项技术来进一步攻击模型：由于在人眼看起来图像是attack那张图像，即咖啡杯，但是在经过预处理后图像是output那种，即猫，所以可以用于发动规避攻击，或者数据投毒攻击，且能够轻易规避人眼的检测。
## 参考
1.Xiao Q, Chen Y, Shen C, et al. Seeing is not believing: Camouflage attacks
on image scaling algorithms[C]//28th {USENIX} Security Symposium ({USENIX}
Security 19). 2019: 443-460.  
2.Quiring E, Klein D, Arp D, et al. Adversarial preprocessing: Understanding
and preventing image-scaling attacks in machine learning[C]//29th {USENIX}
Security Symposium ({USENIX} Security 20). 2020: 1363-1380.  
3.Chen Y , Shen C , Wang C , et al. Scaling Camouflage: Content Disguising
Attack Against Computer Vision Applications[J]. IEEE Transactions on
Dependable and Secure Computing, PP(99):1-1.  
4.  
5.