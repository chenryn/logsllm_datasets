### 5.1 Host-Based Rate Limiting

Deploying rate limiting filters at individual hosts is analogous to implementing such filters at the leaf nodes of a star topology, as described in Section 4. Let \( q \) be the percentage of nodes that install the filter mechanism. The number of infected nodes without the filter mechanism is \( x_1 = I(1 - q) \), and the number of infected nodes with the filter mechanism is \( x_2 = Iq \). Here, \( \beta_1 \) represents the contact rate of an infected host without the filter, while \( \beta_2 \) is the contact rate allowed by the filter, with \( \beta_1 \gg \beta_2 \).

We can use Equation (3) to model the time evolution of the infection. The solution to this equation is given by:
\[ \frac{I}{N} = \frac{C + e^{\lambda t}}{e^{\lambda t}}, \]
where \( \lambda = q\beta_2 + (1 - q)\beta_1 \approx \beta_1(1 - q) \). The analysis from Section 4 on rate limiting at leaf nodes also applies here.

Figure 2 illustrates the time evolution of \( I \) with \( \beta_1 = 0.8 \) and \( \beta_2 = 0.01 \). As shown, the deployment of host-based confinement mechanisms results in a linear slowdown in the infection rate of the worm. The difference between 80% and 100% deployment of rate limiting highlights that significant benefits are only realized when all end hosts implement rate limiting.

### 5.2 Edge-Router Based Deployment

Edge-router based deployment follows a similar approach to host-based rate limiting. For networks that install the filter, we can calculate the effective \( q \) (percentage of nodes with the filter mechanism), and the rest of the calculations remain the same.

When filters are installed at edge routers, worms propagate faster within subnets than across the Internet. We denote the contact rate within the subnet as \( \beta_1 \) and the contact rate across the Internet as \( \beta_2 \), where \( \beta_1 \geq \beta_2 \). For a random propagation worm, the infection growth within a subnet is given by:
\[ x = \frac{e^{\beta_1 t}}{C_1 + e^{\beta_1 t}}, \]
where \( x \) is the number of infected nodes within a particular subnet. The number of infected subnets grows similarly:
\[ y = \frac{e^{\beta_2 t}}{C_2 + e^{\beta_2 t}}, \]
where \( y \) is the number of infected subnets.

For worms using preferential targeting (i.e., targeting nodes within the same subnet), the growth formula remains the same, but the infection rate within the subnet, \( \beta_1 \), could be significantly higher than for a random propagating worm. Consequently, the effectiveness of rate control at edge routers diminishes when a worm employs an intelligent targeting algorithm such as subnet preferential selection.

Figure 3 shows the analytical models for both local preferential and random propagation worms with rate limiting filters at edge routers. It depicts the time evolution of the percentage of hosts infected with \( \beta_1 = 0.8 \) and \( \beta_2 = 0.01 \). In the base case with no rate limiting, the infection grows exponentially before reaching its maximum limit. With rate control, there is a slight slowdown in the infection rate. Figure 3(a) indicates that edge router rate limiting is more effective for the random propagation model. To verify this, we conducted simulations comparing edge router rate limiting for both local preferential and random propagation models. The simulation results are presented in Section 5.4.

### 5.3 Rate Limiting at Backbone Routers

In this section, we investigate rate limiting at the backbone routers of the Internet. For a worm to propagate from one network to another, its packets must pass through backbone routers. Therefore, deploying rate limiting mechanisms at these routers can help throttle worm propagation. We perform an approximate analysis of rate limiting at backbone routers below.

If the rate limiting mechanism is deployed on core routers covering \( \alpha \) percent of the total IP-to-IP paths, then the differential equation governing the infection spread is:
\[ \frac{dI}{dt} = I\beta(1 - \alpha)\frac{(N - I)}{N} + \delta\frac{(N - I)}{N}, \]
where \( \beta \) is the contact rate of one infected host, \( \delta = \min(I\beta\alpha, rN/2^{32}) \), and \( r \) is the average overall allowable rate of the routers with the rate limiting control. When \( r \) is relatively small, the right-hand side of the equation can be approximated by the first term. Thus, we obtain:
\[ \frac{I}{N} = \frac{C + e^{\lambda t}}{e^{\lambda t}}, \]
where \( \lambda = \beta(1 - \alpha) \) and \( C \) is a constant.

### 5.4 Simulation Results

The simulator used for our experiments is built on top of Network Simulator (ns-2) [4]. All experiments in this section are conducted using a 1,000 node power-law graph generated by BRITE [9], which shares characteristics with an AS topology like the Oregon router views. Each simulation is averaged over 10 individual runs, and the time units are simulation ticks as defined by ns-2.

Each simulation starts with a random set of initial infections. At each time unit, each infected node attempts to infect others with probability \( \beta \). The infection packet is routed using a shortest path algorithm through the network. Links with the rate limiting mechanism route packets at a rate of \( \gamma \).

Figure 4 shows the simulation results for random propagation worms under different rate limiting scenarios: no rate limiting, rate limiting at 5% of the end hosts, edge routers, and backbone routers. The results confirm our analytical models in Sections 5.1 and 5.2. Specifically, there is negligible difference between no rate limiting and rate limiting at 5% of end hosts. While rate limiting at edge routers shows a slight improvement, rate limiting at backbone routers provides a substantial improvement. Compared to end host and edge router-based rate limiting, it takes approximately five times longer for the worm to spread to 50% of all susceptible hosts if rate limiting is implemented at the backbone routers.

Figure 5 shows the simulated propagations for rate limiting at the edge router for both local preferential and random propagation worms within subnets. The dotted lines represent the base cases (no rate limiting) for local preferential and random worms. Our simulations show that there is very little benefit to implementing rate limiting at edge routers if worms use a local preferential algorithm. However, for random propagation worms, rate control at edge routers still provides some improvement.