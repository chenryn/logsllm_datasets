an effort to clean up. The second release option is to ask for
assistance from the ISP abuse staff to restore the connection.
Customers might end up in assisted release because they
no longer have the self-release option or because they have
contacted the ISP for help. Quarantined customers can contact
abuse desk members via email, via the walled garden form, or
they can call the regular help desk. The third option is to get
a time-out release. After 30 days, customers are automatically
released, even if they have not contacted the ISP.
IV. STUDY DESIGN
Aiming at understanding the impact of the notiﬁcations on
the remediation process of Mirai-infected devices, we designed
a study which consisted of two stages: (i) an observational
study on walled garden notiﬁcations that the ISP conducted
during 4 months; and (ii) a randomized controlled experiment
to assess the impact of an improved notiﬁcation tailored to
IoT infection remediation. Figure 2 shows the timeline of both
studies. Furthermore, to understand Mirai infection dynamics,
we also conducted a battery of tests with real vulnerable
devices.
Figure 2: Timeline of the experiment
A. Data sources
To identify and track the infected Mirai devices in the ISP
network, we leveraged a combination of several data sources.
Table II provides a high-level summary.
1) Daily Shadowserver abuse feeds: The Shadowserver
Foundation is a non-proﬁt security organization that gathers
and distributes data on abused Internet resources, most notably
compromised machines. It provides network operators with a
3
JunNovAprStandard walled garden notificationImproved walled garden notificationEmail notificationControlObservational studyJun - Oct 2017Randomized controlled experimentNov 2017 - Apr 2018Table II: Data Sources – We used various data sources to analyze the remediation rate of infected ISP subscribers
Role
Data Source
Collection Period
Data Volume
Detecting infections
Tracking infections
Device identiﬁcation
Customer experience
Shadowserver drone feed
IoT honeypot
Darknet
Shadowserver drone feed
IoT honeypot
Censys scans
Nmap scans
Phone interviews
Walled garden forms
Communication logs
01/06/2017-18/04/2018
01/06/2017-18/04/2018
01/06/2017-18/04/2018
01/06/2017-18/04/2018
01/06/2017-18/04/2018
02/05/2017-16/04/2018
01/06/2017-18/04/2018
10/10/2017-18/04/2018
01/06/2017-18/04/2018
01/06/2017-18/04/2018
658 IP addresses
512 IP addresses
349 IP addresses
349 IP addresses
281 IP addresses
49 Internet-wide scans
349 port scans
76 subscribers
159 forms
521 tickets
daily report on compromised hosts in their networks (Botnet-
Drone feed [26]). We use the daily reports sent to our partner
ISP, in combination with other datasources, to detect and track
Mirai-infected users. During the study period, 658 IP addresses
that belong to one of the ISP’s networks were detected as
infected with Mirai. We selected 349 of these IP addresses for
the purpose of our study (see Section IV-C for the speciﬁcs of
the selection process). These 349 IP addresses correspond to
343 different subscribers, i.e., there are 6 subscribers whose IP
addresses were not completely static during the study period.
2) IoT Honeypot: An additional data source for detecting
and tracking infected devices are the daily log ﬁles of a
low-interaction honeypot running the open-source IoTPOT
software [25]. This IoT-speciﬁc honeypot emulates various
well-known vulnerable network services by implementing
speciﬁc IoT architectures. These emulated services include
Telnet protocol, IoT devices’ HTTP front-ends, the CPE WAN
Management Protocol (CWMP) and the remote access setup
service of several types of IP cameras. To capture infected IoT
devices, the honeypot has been deployed over 738 IP addresses
distributed across three countries, including the country in
which the partner ISP operates.
Figure 3: Number of unique IP addresses per day of Mirai-
infected hosts in the consumer broadband network of the ISP,
as detected by Shadowserver, darknet, and honeypot (log-scale)
During the study period, the honeypot captured 512 differ-
ent IP addresses that belonged to the partner ISP. As the ISP
only relies on Shadowserver feeds, we did not use these IP
addresses for notiﬁcation purposes –note that 54.9% (281 IP
addresses) of them overlapped with the IP addresses captured
by Shadowserver– but
instead we used them to track the
infections together with the darknet.
3) Darknet: A third data source for detection and tracking
is the darknet mentioned in Section II. We have monitored 16
protocols that are known to be abused by Mirai botnets for the
network ranges operated by the partner ISP. The darknet data
4
is much more granular than the honeypot and Shadowserver
data, so we mostly rely on this data for measuring the time to
remediation.
Figure 3 shows the number of unique IP addresses seen
each day in each of the data sources. The darknet has the
best coverage, with around 150 unique IP addresses seen every
day. The honeypot and the Shadowserver observe only around
10% of these hosts. It is important to note that the ISP’s abuse
handling process only works with the Shadowserver feed. We
use the darknet and IoT honeypot sources only for tracking
the infected hosts that entered the ISP abuse handling process.
4) Censys Scans: Censys [9] is a platform that scans the
IPv4 space and aggregates application layer data about hosts
on the Internet. We obtained the raw scan data for 49 Internet-
wide scans, including HTML code and banner information,
for each IP address of the ISP where an infected host was
observed. We focused our analysis on scans of CWMP (port
7547), FTP (port 21), HTTP (port 80 and 8080), HTTPS (port
443), SSH (port 22) and Telnet (port 23 and 2323) between
May 01, 2017 and April 31, 2018.
5) NMAP Scans: We used the Nmap network scanner tool
[22] to enrich the dataset used for the device identiﬁcation.
Once a device was identiﬁed as infected with Mirai, we
obtained a list of the open ports as well as banner information.
In total, we scanned 349 IP addresses, though 67 of these were
already off-line at the time of the scan.
B. Treatment variables
Our studies are designed to determine the impact of differ-
ent notiﬁcation mechanisms on remediation. For this purpose,
we compare two experimental treatments using a different
notiﬁcation method (walled garden and email-only) to a control
group where no notiﬁcations were made during the experiment
period. While preparing the experiment, we also improved the
standard ISP notiﬁcation message so as to provide more ac-
tionable advice to users. We assess the impact of the improved
message via comparing the remediation rate and speed for
the new walled garden notiﬁcation to those measured in the
observational study, where the ISP was still using the standard
walled garden notiﬁcation. Figure 2 summarizes the different
treatment groups that we compare across the two studies. We
now take a closer look at the two main treatment variables:
notiﬁcation method and notiﬁcation content.
1) Notiﬁcation method:
ISPs have various methods to
notify end users for malware infections, such as email, phone
calls, SMS, postal mail and a walled garden. However, the
efﬁcacy of these methods has rarely been studied, let alone for
1101001000Nov-2017Dec-2017Jan-2018Feb-2018Mar-2018Apr-2018#Unique IP addresses per dayDarknetIoTPotShadowserverIoT malware cleanup. In the experimental study, we compare
two common methods: email and walled garden.
Email: This method is commonly used by ISPs as it is
cheap and easy to scale. However, a major drawback is that it
cannot be assured that the email is read in a timely manner, or
whether it is read at all. A user might use a different primary
email address than the one provided by or to the ISP. The user’s
email service might also classify the notiﬁcation as spam. In
short, while email is a convenient method, it is unclear how
effective this is in terms of promoting IoT malware cleanup.
Walled garden: Walled garden notiﬁcations – i.e., the land-
ing page in the quarantine environment – are much more likely
to be read by a user. Furthermore, the quarantining provides a
strong incentive for the user to remediate. That being said,
remediation is not assured. The option of self-release does
provide an option to leave the walled garden without any
action. Also, when the ISP staff provides an assisted-release, it
cannot actually see whether the user successfully remediated.
Only when a later Shadowserver report ﬂags the same user
again, might the ISP conclude that cleanup failed.
2) Notiﬁcation content: Crafting usable security notiﬁca-
tions for end users is a difﬁcult challenge. A range of previous
studies have focused on how different abuse and vulnerability
notiﬁcation contents can expedite remediation of the security
issues [32], [19], [7]. However, such work has not been
conducted on remediating IoT malware nor with consumers
in real-world broadband networks.
We discussed with the partner ISP the standard notiﬁcation
content that they were using (see Appendix A). We noticed
it used technical jargon that is probably unfamiliar to most
consumers (e.g., Telnet, SSH). Also, the steps that customers
were supposed to take were somewhat buried in the overall
message. In collaboration with the ISP, we drafted an improved
version which avoided certain technical terms and organized
the remediation in a numbered series of steps, which we hoped
would be more actionable for users. We also added steps to
reset the router, as this would close all ports as well as disable
the demilitarized zone (DMZ) and universal plug and play
(UPnP) (See Appendix B).
C. Study procedure
As shown in Figure 2, our study consisted of two stages.
The ﬁrst stage was an observational study of the effective-
ness of the existing ISP walled garden mechanism. In the
period from June 2017 to the end of October 2017, the ISP
quarantined 97 customers and informed them via the standard
walled garden notiﬁcation. All of these users were reported
by Shadowserver as having a Mirai infection. We looked up
customer IDs and the set of IP addresses associated with each
customer over the period of the study. (Most users retained the
same IP address.) We then checked these IP addresses against
our three sources of infection data: Shadowserver, honeypot,
and darknet. We also logged how long each customer had spent
in quarantine, during which they would not be observed in
the infection data, of course. By combining these datasets, we
could measure remediation success and speed for each user.
Once the ﬁrst stage of the study was done, we continued
with the randomized controlled experiment. To determine the
total sample size, in other words how many users needed to
be notiﬁed, we completed a power calculation for the main
outcome variable, remediation rate. We estimated power for
an 90% level and used a 10.95 standard deviation based on
prior studies [6]. Differences in mean fourteen-day cleanup
time of about 10 hours between conditions can be detected with
90% power in two-tailed tests with 95% conﬁdence, based on
a sample of 40 Mirai-infected users in each treatment group.
This resulted in a total sample size of 120 Mirai-infected users.
The experiment was conducted from the ﬁrst week of
November 2017 to early April 2018. Throughout this period,
we followed the procedure summarized in Figure 4. First, for
each IP address in the Shadowserver report, we identiﬁed
the customer ID. Then, we checked whether this customer
was notiﬁed before for Mirai. As prior experience with the
notiﬁcation procedure and remediation actions might inﬂuence
the remediation time, we discarded a handful of cases that had
been notiﬁed previously. All others were randomly assigned:
40 users ended up in the walled garden treatment group, 40
in the email-only group, and 43 in the control group. To
establish a baseline, the control group was notiﬁed later than
the treatment groups. For ethical reasons, this delay has to be
limited, so as not to expose the customers to unnecessary risks.
In collaboration with the ISP, this delay was set at 14 days.
After these 14 days, if these customers were still reported in
the Shadowserver feeds, then they would be assigned to the
walled garden treatment group. When customers in either of
the treatment groups were seen again in the Shadowserver feed
within this period of 14 days, we would repeat the treatment.
In practice this means that some users got multiple e-mails or
were quarantined more than once. This study design means the
comparison of the treatments will be conducted over these 14
days, though we did keep track of infections and reinfections
after this period, as well will explain below.
In parallel to the experiment (November 2017–April 2018),
we also collected data on the remediation of infected cus-
tomers in two additional networks that belong to two different
networks of the partner ISP: (i) business services and; (ii) a
subsidiary operating under another consumer brand offering
broadband services. Customers in these networks do not re-
ceive any IoT malware notiﬁcations from the ISP. During the
experiment period, the business network had 62 infected cus-
tomers and the subsidiary network had 61 infected customers.
We used the same methodology as in the observational study
to estimate the remediation rates and compared these to the
control group of the consumer network.
Finally, we conducted tests in a lab setup to observe Mirai’s
infection, cleanup and reinfection process with real vulnerable
IoT devices. By infecting these devices with the malware
captured with the honeypot, we could test certain assumptions
about removal and reinfection.
D. Tracking the infected hosts
Remotely assessing the cleanup status of an IoT device is
daunting as passive data sources only allow us to corroborate
infections, not cleanup. In this sense, the fact that IP addresses
disappear from the infection data (Shadowserver Mirai feed,
IoTPOT and darknet) do not necessarily mean the device
is clean. We could also be missing observations. It is quite
5
Figure 5: Number of infected devices on the ISP’s consumer
market before and after the notiﬁcation experiment
walled garden and email-only notiﬁcation) to both the control
group (no notiﬁcation) and group of the observational study
(standard walled garden notiﬁcation). Next, we will dive into
the high remediation rates for the control group. We ﬁnd
similar results in the two reference networks (business and
subsidiary brand) where no notiﬁcations were issued. We will
then discuss the issue of reinfection and long term efﬁcacy of
remediation as well as the inﬂuence of device type on cleanup.
We will end with discussing the results from lab experiments
with remediation and reinfection of real IoT devices.
A. Impact of notiﬁcation mechanism
We ﬁrst determined the impact of notiﬁcations on re-
mediation by comparing the experimental groups. The top
of Table III shows the percentage of IoT devices that were
remediated 14 days after the initial notiﬁcation. It also includes
the median infection time for each group. The control group
achieved the lowest cleanup rate (74%), closely followed by
email-only treatment group (77%). Remarkably, the email-only
treatment seemed to have no effect, displaying no statistically
signiﬁcant difference with the control group. The remediation
rate of the email-only group is a bit higher, but the median
time is a bit
longer. The results were signiﬁcantly better
for the customers who received the improved walled garden
notiﬁcations: 92% of the infected devices were remediated
after 14 days. The median infection time is substantially
shortened as well: 26 hours, less than half of the 66 hours
for the control group.
We also plotted the survival probabilities for the different
groups (see Figure 6a). The groups are quite close one day after
the notiﬁcation, but by day ﬁve we see notable differences in
the cleanup rates. For instance, 60% of the infected devices
in the control group are cleaned within 5 days, compared to
55% of those receiving an email notiﬁcation and 88% of those
receiving improved walled garden notiﬁcations.
The log-rank test shows that the difference between the
control group and the improved walled garden treatment group
is signiﬁcant (χ2 = 4.4, p = 0.0359). In short, these results
provide evidence that quarantining is effective, while email-