recover the full secret key of the 3DES. Applying the meth-
ods described in this paper, the keys used for the bitstream
encryption can be recovered with modest eﬀorts in less than
one hour, using the measurements of only one single conﬁg-
uration process.
After the key recovery the attacker can decrypt the pro-
tected bitstream from the Virtex-II Pro FPGA, and hence
possesses its complete content. As a consequence, she can
produce a clone of the original FPGA on the basis of an
empty device by simply conﬁguring it with the extracted
bitstream, even without using the encryption feature, for
example to replicate the product of a competitor.
Furthermore, by reverse-engineering the internal wiring of
the FPGA from the bitstream a stolen design can be ana-
lyzed, the internal secrets extracted and used for malicious
purposes. The stolen design could even be improved and dis-
guised as an own product that outrivals the original. While
Xilinx tries to establish security by obscurity by keeping the
exact mapping of the bitstream to the internal circuitry of
their product conﬁdential, there already exist methods to re-
cover the original design of an FPGA from a bitstream [24,
30].
In addition to lost IP, in a security-critical environment re-
programming the attacked FPGA with an ill-intended mod-
iﬁed code, e.g., to accomplish malfunctioning or to unno-
ticedly implement a hardware trojan [21], is a particularly
damaging option. In the following we illustrate possible im-
plications that our attacks may have at hand of two exam-
ples from the commercial sector2, without naming manufac-
turers.
4.1 Real-World Example 1: Set Top Box
Set-top boxes are widely used in the ﬁeld for receiving dig-
ital TV and radio programmes, pay-per-view special events,
allow to watch recent movies on a subscription basis and
enable video on demand, i.e., remotely renting a video in-
cluding the ability to pause, rewind, and fast forward. A
set-top box is an ideal candidate for using FPGAs with
bitstream encryption: In addition to the computationally
highly demanding demodulating and decompressing algo-
rithms for descrambling the transmitted TV and radio pro-
grammes, the manufacturers often employ their proprietary
encryption schemes, e.g., for the above mentioned applica-
tions. The secure bitstream encryption feature enables to
regularly update and improve the ﬁrmware running on the
set-top boxes in the households, for example by cable or a
satellite link, and establish corresponding business models
without disclosing the descrambling schemes or secret keys
to potential attackers.
Our key-recovery attack puts set-top boxes relying on the
investigated or similar FPGAs using bitstream encryption
at a high risk: an attacker extracting the ﬁrmware of a set-
2for obvious reasons we do not cover military applications
here.
121top box knows amongst others the scrambling scheme and
secret keys, can gain access to all digital content without
paying and is thus able to circumvent the above mentioned
business models. A criminal can make high ﬁnancial gain
(and cause high ﬁnancial losses for the service provider) by
producing new set-top boxes or modifying the ﬁrmware of
existing set-top boxes to enable the usage of the services free
of cost by the customers.
4.2 Real-World Example 2: Router
Network routers redirect data traﬃc with a speed of hun-
dreds of Gigabits per second in local networks and often con-
stitute the interface to the outside world, e.g., the Internet,
for companies, government agencies and private households.
In addition to routing data, an FPGA in common products
often realizes security-relevant functions such as a ﬁrewall
to separate private local networks from other insecure ones.
In case of a bug in the ﬁrmware or if a security ﬁx is re-
quired, some routers can be updated remotely — again, the
bitstream encryption is the basis for establishing this func-
tionality. Assuming a router that is based on a Virtex-II
Pro, an attacker having one-time physical access to it can
perform our key-recovery attack. From there on, she can
remotely initiate ﬁrmware updates, e.g., via the Internet,
to modify the functionality of the router according to her
demands.
A denial-of-service attack, aiming at malfunctioning or
to destroy the device or other connected equipment is one
option. More likely, a modiﬁed ﬁrmware can be used to
open a covered channel allowing the adversary to spy out
and access data from the internally connected computers
and other devices, e.g., by implementing a trojan horse that
secretly forwards all internal traﬃc to the adversary. The
user typically has no means to verify whether his ﬁrmware
has been manipulated or if it is original, hence — depending
on the location where the manipulated router is used —
a modiﬁed ﬁrmware can have a devastating impact on the
privacy and security, and even the safety, of the attacked
individual or company.
4.3 Scope of our Findings
As researchers of a university with this paper we intend to
inform about possible vulnerabilities when using bitstream
encryption and warn the end-users of products incorporat-
ing this feature from possible damage. We believe there can
be fairly severe real-world implications (depending on the
commercial devices in which Virtex-II Pro FPGAs are used)
due to our ﬁndings. Furthermore, it seems highly likely that
certain determined attackers, e.g., foreign intelligence ser-
vices, are already capable of extracting and altering FPGA
designs using power analysis techniques. Since the success
of a power analysis attack in general does not depend on
the cipher employed, it is conceivable that similar attacks
can be applied to newer generations of FPGAs from diﬀer-
ent manufacturers, employing diﬀerent ciphers, such as the
Virtex 4 family or Altera products using AES-256 in their
bit encryption schemes [7, 29].
5. CONCLUSION
We presented the ﬁrst attacks targeting the bitstream en-
cryption of FPGAs in the literature. By proﬁling the power
consumption of the target FPGA we reverse-engineered all
relevant details of the security feature and pinpointed the
time instant when the decryption of the ciphertext blocks
of the bitstream is performed by a dedicated hardware con-
tained in the FPGA. We identiﬁed the appropriate power
model for attacking the triple DES engine by means of power
analysis and deduced the internal architecture of the hard-
ware. Our proposed techniques for the digital signal pro-
cessing of the power measurements enable a highly eﬃcient
power analysis attack that allows the full secret key of the
triple DES to be extracted in only 3 minutes of computa-
tion time from only 25, 000 measurements, obtainable with
a single boot up of the device. Our ﬁndings indicate that
the attacks are possible using a low-cost oscilloscope with a
sample rate as little as 100 MS/s.
In particular, we have successfully exempliﬁed our at-
tack at hand of the bitstream decryption of a Virtex-II Pro
XC2CP7 FPGA manufactured by the market leader Xilinx.
We are able to recover all three diﬀerent keys used by its
triple DES module from a single power-up of the device in a
real-world scenario. The lithium battery for the key storage,
providing extra security according to Xilinx, does not have
to be removed for the attack. It is highly conceivable that
similar attacks can be applied to other series of FPGAs, e.g.,
from other manufacturers.
Besides the obscurity that emerges from Xilinx keeping
the details of their bitstream ﬁles secret we encountered no
countermeasures against side-channel analysis — an alarm-
ing fact considering the protection of many devices deployed
in the ﬁeld: an attacker knowing the secret key used for the
encryption of the bitstream can obtain all secrets and in-
tellectual property contained in commercial products, e.g.,
proprietary encryption schemes or processing algorithms.
As a consequence of our attacks, cloning of the prod-
ucts protected by the bitstream encryption scheme becomes
straightforward. After reverse engineering the content of
the FPGA from the bitstream, improved products could be
marketed by a competitor that outrival the original. Much
worse, the content of commercial products can be updated
remotely, e.g., via Internet, with a maliciously modiﬁed new
ﬁrmware. This poses a severe threat to the reliability of the
products, puts the privacy of individuals and companies at
a high risk and further enables to infect the devices with
embedded malware.
6. REFERENCES
[1] Defense Science Board.
http://www.acq.osd.mil/dsb/.
[2] Side-channel Attack Standard Evaluation Board
(SASEBO). Further information are available via
http://www.rcis.aist.go.jp/special/SASEBO/.
[3] Xilinx ISE Design Suite.
http://www.xilinx.com/tools/designtools.htm.
[4] IEEE Standard Test Access Port and Boundary-Scan
Architecture. IEEE Std 1149.1-2001, pages i –200,
2001.
[5] D. Abraham, G. Dolan, G. Double, and J. Stevens.
Transaction Security System. In IBM Systems Journal
30, pages 206–229, 1991.
[6] G. Agosta, A. Barenghi, F. D. Santis, and G. Pelosi.
Record Setting Software Implementation of DES
Using CUDA. Information Technology: New
Generations, Third International Conference on, pages
748–755, 2010.
122In CHES, volume 5747 of LNCS, pages 382–395.
Springer, 2009.
[22] A. Menezes, P. C. van Oorschot, and S. A. Vanstone.
Handbook of Applied Cryptography. CRC Press, 1996.
[23] NIST. FIPS-46-3: Data Encryption Standard (DES),
1999.
[24] J.-B. Note and ´E. Rannaud. From the bitstream to
the netlist. In M. Hutton and P. Chow, editors, 16th
International Symposium on Field Programmable Gate
Arrays, FPGA 2008. ACM, 2008.
[25] S. B. ¨Ors, E. Oswald, and B. Preneel. Power-Analysis
Attacks on an FPGA - First Experimental Results. In
CHES 2003, volume 2779 of LNCS, pages 35–50.
Springer, 2003.
[26] Recurity Labs. Embedded Analysis. 27th Chaos
Communication Congress, Dec. 2010. http://events.
ccc.de/congress/2010/wiki/Embedded_Analysis.
[27] F.-X. Standaert, S. B. ¨Ors, J.-J. Quisquater, and
B. Preneel. Power Analysis Attacks Against FPGA
Implementations of the DES. In FPL 2004, volume
3203 of LNCS, pages 84–94. Springer, 2004.
[28] A. Telikepalli. Is Your FPGA Design Secure? XCell
Journal, XILINX, Fall 2003.
[29] C. W. Tseng. Lock Your Designs with the Virtex-4
Security Solution. XCell Journal, XILINX, Spring
2005.
[30] T. J. Wollinger, J. Guajardo, and C. Paar. Security on
FPGAs: State-of-the-art implementations and attacks.
ACM Transactions in Embedded Computing Systems
(TECS), 3(3):534–574, 2004.
[31] XILINX. Virtex-2 Platform FPGA User Guide
(UG002 version 2.2). Technical report, November
2007. http://www.xilinx.com/support/
documentation/user_guides/ug002.pdf.
[32] XILINX. Virtex-II Pro and Virtex-II Pro X FPGA
User Guide. Technical report, 2007.
http://www.xilinx.com/support/documentation/
user_guides/ug012.pdf.
[33] XILINX. Virtex-II Pro Platform FPGAs: Complete
Data Sheet (DS 083 version 4.7). Technical report,
November 2007. http://www.xilinx.com/support/
documentation/data_sheets/ds083.pdf.
[7] ALTERA. Using the Design Security Feature in
Stratix II and Stratix II GX Devices (AN 341 version
2.3). Technical report, August 2009.
http://www.altera.com/literature/an/an341.pdf.
[8] ATK. XM25 Counter Deﬁlade Target Engagement
System. http://www.atk.com/customer_solutions_
missionsystems/documents/sw_iw_xm25.pdf, May
2009. Post “FPGAs in interesting places – the XM25
Airburst Weapon System” by Saar Drimer on
www.fpgasecurity.com.
[9] A. Barenghi, G. Pelosi, and Y. Teglia. Improving ﬁrst
order diﬀerential power attacks through digital signal
processing. In ACM-SIGSAC International Conference
on Security of Information and Networks, pages
124–133. ACM, 2010.
[10] A. Barenghi, G. Pelosi, and Y. Teglia. Information
leakage discovery techniques to enhance secure chip
design. In C. A. Ardagna and J. Zhou, editors,
WISTP, volume 6633 of Lecture Notes in Computer
Science, pages 128–143. Springer, 2011.
[11] E. Brier, C. Clavier, and F. Olivier. Correlation Power
Analysis with a Leakage Model. In CHES 2004,
volume 3156 of LNCS, pages 16–29. Springer, 2004.
[12] W. J. Broad, J. Markoﬀ, and D. E. Sanger. Israeli
Test on Worm Called Crucial in Iran Nuclear Delay.
Technical report, New York Times, January 2011.
http://www.nytimes.com/2011/01/16/world/
middleeast/16stuxnet.html.
[13] O. Coudert. Why FPGA startups keep failing, 2009.
FPGA market shares according to Gartner Inc, 2008.
[14] S. Drimer. Security for volatile FPGAs. Technical
Report UCAM-CL-TR-763, University of Cambridge,
Computer Laboratory, Novembre 2009. ISSN
1476-2986 http://www.cl.cam.ac.uk/techreports/
UCAM-CL-TR-763.pdf.
[15] T. Eisenbarth, T. Kasper, A. Moradi, C. Paar,
M. Salmasizadeh, and M. T. M. Shalmani. On the
Power of Power Analysis in the Real World: A
Complete Break of the KeeLoq Code Hopping
Scheme. In CRYPTO 2008, volume 5157 of LNCS,
pages 203–220. Springer.
[16] Eric Peeters and Fran¸cois-Xavier Standaert and
Jean-Jacques Quisquater. Power and Electromagnetic
Analysis: Improved Model, Consequences and
Comparisons. Integr. VLSI J., 40(1):52–60, 2007.
[17] T. G¨uneysu, T. Kasper, M. Novotn´y, C. Paar, and
A. Rupp. Cryptanalysis with COPACOBANA. IEEE
Transactions on Computers, 57(11):1498–1513, 2008.
[18] P. Kocher, J. Jaﬀe, and B. Jun. Diﬀerential Power
Analysis. In CRYPTO 99, volume 1666 of LNCS,
pages 388–397. Springer, 1999.
[19] R. Krueger. Application Note XAPP766: Using High
Security Features in Virtex-II Series FPGAs.
Technical report, XILINX, 2004.
http://www.xilinx.com/support/documentation/
application_notes/xapp766.pdf.
[20] A. Lesea. IP Security in FPGAs, White Paper WP
261. Technical report, XILINX, February 2007.
[21] L. Lin, M. Kasper, T. G¨uneysu, C. Paar, and
W. Burleson. Trojan Side-Channels: Lightweight
Hardware Trojans through Side-Channel Engineering.
123