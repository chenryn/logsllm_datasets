title:SMS-Watchdog: Profiling Social Behaviors of SMS Users for Anomaly
Detection
author:Guanhua Yan and
Stephan J. Eidenbenz and
Emanuele Galli
SMS-Watchdog: Proﬁling Social Behaviors of
SMS Users for Anomaly Detection
Guanhua Yan, Stephan Eidenbenz, and Emanuele Galli
Information Sciences (CCS-3)(cid:2)
Los Alamos National Laboratory
{ghyan,eidenben,egalli}@lanl.gov
Abstract. With more than one trillion mobile messages delivered world-
wide every year, SMS has been a lucrative playground for various attacks
and frauds such as spamming, phishing and spooﬁng. These SMS-based
attacks pose serious security threats to both mobile users and cellular net-
work operators, such as information stealing, overcharging, battery ex-
haustion, and network congestion. Against the backdrop that approaches
to protecting SMS security are lagging behind, we propose a lightweight
scheme called SMS-Watchdog that can detect anomalous SMS behaviors
with high accuracy. Our key contributions are summarized as follows: (1)
After analyzing an SMS trace collected within a ﬁve-month period, we con-
clude that for the majority of SMS users, there are window-based regular-
ities regarding whom she sends messages to and how frequently she sends
messages to each recipient. (2) With these regularities, we accordingly pro-
pose four detection schemes that build normal social behavior proﬁles for
each SMS user and then use them to detect SMS anomalies in an online
and streaming fashion. Each of these schemes stores only a few states (typ-
ically, at most 12 states) in memory for each SMS user, thereby imposing
very low overhead for online anomaly detection. (3) We evaluate these four
schemes and also two hybrid approaches with realistic SMS traces. The re-
sults show that the hybrid approaches can detect more than 92% of SMS-
based attacks with false alarm rate 8.5%, or about two thirds of the attacks
without any false alarm, depending on their parameter settings.
Keywords: SMS, anomaly detection, relative entropy, JS-divergence.
1 Introduction
The Short Message Service (SMS) provided by cellular carriers is a connectionless
message transfer service with low capacity. Since its inception in December 1992,
when the ﬁrst short message was delivered in the Vodafone GSM network in the
United Kingdom [12], SMS has been growing at a blistering speed. According to
the IDC research ﬁrm, the total number of SMS subscribers in the US in 2006
was estimated at 102 million and is expected to reach 184 million in 2011; the
number of short messages delivered in the US will grow at an even faster pace,
(cid:2) Los Alamos National Laboratory Publication No. LA-UR 08-07637.
E. Kirda, S. Jha, and D. Balzarotti (Eds.): RAID 2009, LNCS 5758, pp. 202–223, 2009.
c(cid:2) Springer-Verlag Berlin Heidelberg 2009
SMS-Watchdog: Proﬁling Social Behaviors of SMS Users
203
which will jump from 157 billion in 2006 to 512 billion in 2011 [22]. Another
report by Gartner shows that the Asia-Paciﬁc region, whose SMS subscribers
sent 1.5 trillion short messages in 2007, is leading the SMS growth over North
America and Western Europe, whose SMS subscribers generated 189 and 202
billion short messages in 2007, respectively [18].
Due to its increasing popularity, SMS has become a lucrative target for fraud-
ulent behaviors that have been rampant in the Internet for decades. For instance,
88 percent of mobile users in China [4] have been plagued by SMS spams. Mean-
while, the convergence of the telecommunication world and the Internet has led
to the emergence of SMS phishing, also dubbed “SMiShing”, which could steal
conﬁdential account information from mobile devices [16] or spreading mobile
malware [15]. SMS spooﬁng is another type of attacks based on SMS: by manip-
ulating address information in SMS messages, an SMS spooﬁng attack simulates
the behavior of a legitimate mobile device so that foreign networks (as opposed
to the home network of the mobile device) mistakingly think these messages
originate from that device. SMS spooﬁng attacks have been launched against
major cellular operators in Europe in the past [19]. Besides these spamming,
phishing and spooﬁng attacks, other SMS-based attacks include SMS ﬂooding,
which aims to overload the cellular network, and SMS faking, which mimics the
behavior of an SMS switch to send messages [17]. In particular, SMS ﬂooding
could shut down cellular services entirely in a large area [6].
SMS-based attacks pose serious security threats to both mobile users and
cellular networks, including information stealing, overcharging, battery exhaus-
tion, and network congestion. Eﬀective countermeasures, unfortunately, are still
lagging behind. Many existing solutions are aimed at detecting malware on mo-
bile devices with techniques inspired by their counterparts in IP networks. For
instance, signature-based detection schemes are proposed to examine mobile net-
work traﬃc [8] or power usage of mobile applications [9] for signatures that are
extracted from existing mobile malware instances. A machine learning-based ap-
proach is developed in [1] to catch mobile malware by discriminating behaviors
of normal applications and malware at the level of system events and API calls.
Although eﬀective against some SMS-based attacks, these mobile malware de-
tection approaches have their ﬂip sides. First, not all aforementioned SMS-based
attacks originate from mobile malware. For instance, SMS spooﬁng usually comes
from a device that simulates an authentic mobile handheld to fool a foreign net-
work. Second, many of these approaches demand extra computational resources
on mobile devices, which accelerate exhaustion of their batteries. Third, operat-
ing systems of existing mobile devices often lack sophisticated countermeasures
to prevent mobile malware from disabling device-resident detection schemes.
In this work, we take a diﬀerent avenue to detect anomalous SMS behaviors.
We propose a detection framework called SMS-Watchdog, which is deployed at
a place where a mobile user’s short message records can be easily accessed, such
as the Short Messaging Service Center (SMSC) in a typical SMS architecture.
Hence, our work alleviates typical shortcomings of device-resident mobile de-
tection schemes, such as extra power consumption for detection and inability to
204
G. Yan, S. Eidenbenz, and E. Galli
catch spoofed short messages. Motivated by observations made from a real-world
SMS dataset, our work exploits regularities inherent in a typical user’s SMS be-
haviors for anomaly detection. Our key contributions in this paper are summa-
rized as follows: (1) After analyzing an SMS trace collected within a ﬁve-month
period, we conclude that for the majority of SMS users, there are window-based
regularities regarding whom she sends messages to and how frequently she sends
messages to each recipient. (2) With these regularities, we accordingly propose
four detection schemes that build normal social behavior proﬁles for each SMS
user and then use them to detect SMS anomalies in an online and streaming
fashion. Each of these schemes stores only a few states (typically, at most 12
states) in memory for each SMS user, thereby imposing very low overhead for
online anomaly detection. (3) We evaluate these four schemes and also two hy-
brid approaches with realistic SMS traces and the results show that the hybrid
approaches can detect more than 92% of SMS-based attacks with false alarm
rate 8.5%, or two thirds of the attacks without any false alarm, depending on
their parameter settings.
Related work. In [27], Zerfos et al. used an SMS trace collected from a na-
tional cellular carrier in India to examine message size distribution, message
service time distribution, and thread-level characteristics. The same trace was
later investigated by Meng et al. to understand delivery reliability and latency
[13]. It is noted that their trace, although containing more SMS users than the
one analyzed in this paper, lasts only three weeks. By contrast, our trace contains
short messages within ﬁve months, thus oﬀering insights on long-term and per-
sistent behaviors of SMS users. Enck et al. showed that SMS ﬂooding from the
Internet side can cause severe denial-of-service attacks against cellular network
operations in a large area [6] and later they proposed some countermeasures to
prevent such attacks [24]. Our work in this paper attempts to identify anomalous
SMS behaviors by comparing them against normal SMS user’s social behavior
proﬁles and is thus complementary to their work.
Techniques based on proﬁling human social behaviors have been applied to
detect anomalies in other types of network traﬃc. For instance, Stolfo et al.
developed a data mining system that builds behavioral proﬁles or models with
methods such as user cliques, Hellinger distance, and cumulative distributions
for emails users [20]. Using injected simulated viral emails, they show that the
detection system performs well with high accuracy. In [26], Yan et al. applied
change-point detection techniques to detect worm propagation in IM (Instant
Messaging) networks. They show that schemes simply counting the number of
instant messages sent by each user can easily be circumvented by a carefully
crafted IM worm. Observing that the distribution of the number of messages
sent to each contact on the buddy list is typically highly skewed, they developed
an eﬀective technique that periodically calculates the overall likelihood that in-
stant messages are sent to each recipient and look for abrupt changes to detect
IM worm propagation. Moreover, in this work we use information-theoretical
measures to detect anomalies in SMS traﬃc and these techniques have been ap-
plied to detect anomalies in Internet traﬃc before [11][14]. Besides focusing on a
SMS-Watchdog: Proﬁling Social Behaviors of SMS Users
205
diﬀerent type of network traﬃc, we also address the scalability issues that were
not considered in previous work. For a more comprehensive survey on anomaly
detection techniques and their applications, we refer interested readers to [2].
Anomaly detection for mobile phone networks has a long history. For instance,
calling activities have been examined to detect mobile phone fraud [7][23][5] and
mobility patterns of mobile devices have been proﬁled to detect cloning attacks
and cell phone losses [25][21]. Recently, due to the increasing popularity of smart
phones, a growing number of malware instances have been observed on these
mobile devices. Many existing approaches to detect mobile malware work by
proﬁling behaviors of normal applications [9][1]; our work instead focuses on
proﬁling normal SMS user behaviors.
Organization. The remainder of the paper is organized as follows. Section 2
brieﬂy introduces typical SMS architectures and how we collect the SMS trace.
In Section 3, we ﬁrst analyze SMS user behaviors in the trace and discuss
what statistic metrics exhibit low variation. We then discuss the design of SMS-
Watchdog in Section 4. Based on the results from the trace analysis in Section
3, we propose four diﬀerent detection schemes in Section 5. We evaluate the
performance of these four schemes and also two hybrid schemes in Section 6. We
ﬁnally make concluding remarks and discuss the scope of our work in Section 7.
2 Background on SMS and SMS Traces
SMS architecture. SMS is a service that provides a connectionless transfer of
messages with at most 160 characters using signaling channels in cellular net-
works. Figure 1 illustrates the basic SMS architecture in a GSM-based system.
A short message sender (on the right bottom corner) uses an originating MS
(Mobile Station) to send a short message to a receiver (on the left bottom cor-
ner in Figure 1). The short message is delivered to a nearby BSS (Basestation
System) through the GSM signaling channel and then the MSC (Mobile Switch-
ing Center) associated with this BSS. The MSC ﬁrst checks with a VLR (Visitor
Location Register) database whether the originating MS is allowed to receive
SMS Proxy 
User 1
BSS
GPRS
SGSN
GGSN
SMS Proxy 
User 2
GSM
SMS Proxy
VLR
HLR
VLR
GSM
Modem
MSC
SMSC
MSC
BSS
Short
Message 
Receiver
BSS
Short
Message
Sender  
Fig. 1. SMS Architecture and SMS Proxy
206
G. Yan, S. Eidenbenz, and E. Galli
the short message service. The VLR database temporarily stores subscription
information for the visiting mobile stations so that the associated MSC knows
what services should be provided to them. If the originating MS is allowed to
use SMS, the MSC further routes the short message to SMSC, a dedicated store-
and-forward server that handles SMS traﬃc.
The SMSC is responsible for forwarding the short message to the targeted
mobile device, also called terminating MS (on the left bottom corner). To do
that, it queries an HLR (Home Location Register) database, which keeps infor-
mation about cellular subscribers, such as their proﬁle information, current loca-
tion, billing data, and validation period. The HLR responds by sending back the
serving MSC address of the terminating MS. Thereafter, the SMSC forwards the
short message to that MSC, which further queries its associated VLR database
for the location area of the terminating MS. Once the location of the terminating
MS is found, the short message is delivered to it through its nearby BSS.
SMS trace collection. The SMS trace used in this work was collected from an
SMS proxy in Italy. This SMS proxy connects with the Internet, and also the
GSM network through a GSM modem. There are two classes of users for this
SMS proxy. Similar to the regular SMS sender, the ﬁrst class (e.g., User 1) also
use an MS to send short messages. These short messages, however, do not use
GSM signaling channels; instead, they are delivered through the GPRS network
to the SMS proxy, which further forwards these messages to their recipients
through the GSM modem. The second class of SMS proxy customers (e.g., user
2) send their short messages to the SMS proxy through the Internet and then to
their receiving MSes through the GSM modem. The economic incentive for such
an SMS proxy is the price diﬀerence between regular SMS and GPRS messages.
The SMS proxy was launched in early 2008 and we obtained communication
logs of all its users from April 15, 2008 to September 14, 2008. Through this
period, there were 2,121 users that have used it to send short messages. In total,
146,334 short messages have been sent through this proxy. As this data trace
covers a large number of users, we believe that it is representative of general
SMS traﬃc. Due to its short history, the SMS proxy has not been seen suﬀering
malicious attacks yet. Hence, analysis on the data collected sheds light on how
normal SMS users behave socially. Moreover, the long time span of this trace
enables us to investigate the persistent behavioral patterns of SMS users. This
is contrast to previous work which mainly focus on analyzing communication
traces of SMS users only within a short period of time [27][13].
3 Trace Analysis
In this section, we analyze the dynamics of the system from which the trace was
collected and then derive regularities inherent in behaviors of normal SMS users.
In Figure 2, we show the number of short messages that
System dynamics.
have been observed by the SMS proxy each day. From the graph, we observe an
SMS-Watchdog: Proﬁling Social Behaviors of SMS Users
207
r
e
b
m
u
N
 1800
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
 0
#messages
#unique senders
 30
 60
 90
 120
 150
Day ID
r
e
b
m
u
N
 12
 10
 8
 6
 4
 2
 0
#messages per sender
#receivers per sender
 0
 30
 60
 90
 120
 150
Day ID
Fig. 2. Number of messages and num-
ber of unique senders per day
Fig. 3. Number of messages and re-
ceivers per sender per day
s
e
g
a
s
s
e
m
f
o
r
e
b
m
u
N
 120
 100
 80
 60
 40
 20
 0
-20
-40
-60
-80
[Mean-std dev, mean+std dev]
Avg. number of msgs
 1
 5
 25
 125
 625
User rank
(1) Daily
s
e
g
a
s
s
e
m
f
o
r
e
b
m
u
N
 600
 500
 400
 300
 200
 100
 0
-100
-200
[Mean-std dev, mean+std dev]
Avg. number of msgs
 1
 5
 25
 125
 625
User rank
(2) Weekly
Fig. 4. Average numbers of messages for persistent users
obvious trend that an increasing number of short messages have been transmitted
through the SMS proxy. For instance, the number of short messages observed
has increased by 67% from May to August. This is attributed to the growing
number of users of the system during the trace collection period. Figure 2 also
depicts the number of users that sent at least one message in a day. In August,
there were 972 active customers, as opposed to only 662 ones in May.
Although the number of users in the system was not stationary during the
data collection period, we ﬁnd that both the number of messages sent out by
each user and the number of receivers per sender each day are quite stationary.
They are illustrated in Figure 3, from which we observe that each day an active
user sends about 5.4 messages to 2.4 recipients on average. We also note that
some users in the dataset used the SMS proxy to send short messages for only a
short period of time. As we are only interested in persistent behaviors of SMS
users, we do not consider these temporary users. From the dataset, we obtain a
list of 662 users whose ﬁrst and last short messages were sent at least 60 days
apart. For brevity, we call them persistent users, who contributed about 75% of
the entire set of short messages.
Temporally periodic behaviors of persistent users. We are interested in
statistically time-invariant metrics that characterize behaviors of SMS users so
208
G. Yan, S. Eidenbenz, and E. Galli
i
i
s
t
n
e
p
c
e
r
f
o
r
e
b
m
u
N
 50
 40
 30
 20
 10
 0
-10
-20
-30
[Mean-std dev, mean+std dev]
Avg. number of recipients
 1
 5
 25
 125
 625
User rank
(1) Daily