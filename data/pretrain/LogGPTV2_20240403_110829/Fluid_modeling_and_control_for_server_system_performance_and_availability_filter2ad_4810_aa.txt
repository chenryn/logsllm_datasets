title:Fluid modeling and control for server system performance and availability
author:Luc Malrait and
Sara Bouchenak and
Nicolas Marchand
978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
389
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:35:50 UTC from IEEE Xplore.  Restrictions apply. 
FluidModelingandControlforServerSystemPerformanceandAvailabilityLucMalraitNeCSControlTheoryResearchGroupINRIA–GipsaLabGrenoble,FranceLuc.Malrait@inria.frSaraBouchenak∗SARDESDistributedSystemsResearchGroupUniv.ofGrenobleI–INRIAGrenoble,FranceSara.Bouchenak@inria.frNicolasMarchandNeCSControlTheoryResearchGroupCNRS–GipsaLabGrenoble,FranceNicolas.Marchand@inria.frAbstractAlthoughservertechnologyprovidesameanstosupportawiderangeofonlineservicesandapplications,theirad-hocconﬁgurationposessigniﬁcantchallengestotheperformance,availabilityandeconomicalcostsofapplications.Inthispa-per,weexaminetheimpactofserverconﬁgurationonthecen-traltradeoffbetweenserviceperformanceandavailability.First,wepresentaservermodelasanonlinearcontinuous-timemodelusingﬂuidapproximations.Second,wedevelopadmissioncontrolofserversystemsforanoptimalconﬁgu-ration.WeprovidetwocontrollawsfortwodifferentQoSobjectives.AM-Cisanavailability-maximizingadmissioncontrolthatachievesthehighestserviceavailabilitygivenaﬁxedperformanceconstraint;andPM-Cisaperformance-maximizingadmissioncontrolthatmeetsadesiredavailabil-itytargetwiththehighestperformance.WeevaluateourﬂuidmodelandcontroltechniquesontheTPC-Cindustry-standardbenchmark.Ourexperimentsshowthatthepro-posedtechniquesimproveperformancebyupto30%whileguaranteeingavailabilityconstraints.Keywords:Modeling,Control,Serversystems,Admissioncontrol,QoS1.IntroductionAlargevarietyofInternetservicesexists,rangingfromwebserverstoe-mailservers[27],streamingmediaser-vices[3],e-commerceservers[2],anddatabasesystems[23].Theseservicesareusuallybasedontheclassicalclient-serverarchitecture,wheremultipleclientsconcurrentlyaccessanonlineserviceprovidedbyaserver(e.g.readingwebpages,sendingemailsorbuyingthecontentofashoppingcart).Suchserversystemsfacevaryingworkloadsasshowninseveralstudies[5,8,4].Forinstance,ane-mailserverislikelyto∗Contact.Phone:+33(0)476615382,Fax:+33(0)476615252Submissioncategory:Regularpaper,Approximatewordcount:7000–Thematerialhasbeenclearedthroughtheauthorafﬁliations.faceaheavierworkloadinthemorningthanintherestoftheday,sincepeopleusuallyconsulttheire-mailswhenar-rivingatwork.Initsextremeform,aheavyworkloadmayinduceserverthrashingandserviceunavailability,withun-derlyingeconomicalcosts.ThesecostsareestimatedatuptoUS$2.0million/hourforTelecomandFinancialcompa-nies[12,22].Aclassicaltechniqueusedtopreventserversfromthrash-ingwhentheworkloadincreasesisadmissioncontrol[11].Itconsistsinlimitingclientconcurrencyonservers–alsoknownasthemulti-programminglevel(MPL)conﬁgurationparameterofservers.Obviously,servers’MPLconﬁgurationhasadirectimpactonserverperformance,availabilityandquality-of-service(QoS).Existingapproachestoadmissioncontroleitherrelyonad-hoctuningandheuristicswithoutop-timalityguarantees[6,21,20],orapplylinearcontroltheorywhichdoesunfortunatelynotcapturetheintrinsicnonlinearbehaviorofserversystems[25,7],orfollowaqueuingthe-oryapproachwherethesystemcanbeaccuratelymodeledbutattheexpenseofahardmodelcalibrationprocesswhichmakesitunwieldytouse[28,30,24].Webelievethatmod-elingserversystemsisnecessarytoprovideguaranteesontheQoS.However,wearguethatfortheeffectivedeploymentofservermodeling,themodelsmustaccuratelycapturethedy-namicsandthenonlinearbehaviorofserversystemswhilebeingsimpletodeployonexistingsystems.Inthispaper,weapplyanonlinearcontinuous-timecontroltheorybasedonﬂuidapproximations,inordertomodelandcontroltheQoSofserversystems.Themaincontributionofthepaperistwofold:•Thedesignandimplementationofanonlinearcontinuous-timemodelofserversystemsthatissimpletousesinceitinvolvesveryfewexternalparam-eters,andwhichstillaccuratelycapturesthedynamicsofserversystemsasﬂuidﬂows.•Thedesignandimplementationofnonlinearadmissioncontrolforserversystems.Twovariantsofcontrollaws978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
390
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:35:50 UTC from IEEE Xplore.  Restrictions apply. 
areproposed:AM-Cisanavailability-maximizingop-timalserveradmissioncontrolthatachievesthehigh-estserviceavailabilitygivenaﬁxedperformancecon-straint,andPM-Cisaperformance-maximizingopti-malserveradmissioncontrolthatmeetsadesiredavail-abilitytargetwiththehighestperformance.ThepaperpresentsourexperimentsontheTPC-Cappli-cation,anindustry-standardbenchmark,runningonthePost-greSQLdatabaseserver.Theresultsoftheexperimentsshowthattheproposedtechniquesprovidesigniﬁcantbeneﬁtsontheperformanceandtheavailabilityofthecontrolledsystemcomparedtoanon-controlledsystem.Theremainderofthepaperisorganizedasfollows.Sec-tion2givesanoverviewofthebackground.Sections3and4presentourcontributionsintermsofrespectivelyaﬂuidmodelforserversystems,andfeedbackadmissioncontrollawsforservers.Section5describestheresultsofourexper-imentalevaluation,andSection6presentstherelatedwork.Finally,Section7drawsourconclusions.2Background2.1ServersystemsWeconsiderserversystemssuchasdatabaseserversandwebserversthatfollowtheclient-serverarchitecturewhereserversprovideclientswithsomeonlineservice,suchason-linebookstore,ore-banking.Clientsandserversarehostedondifferentcomputersconnectedthroughacommunicationnetwork.Basically,aclientremotelyconnectstotheserver,sendsitarequest,theserverprocessestherequestandbuildsaresponsethatisreturnedtotheclientbeforetheconnectionisclosed.Multipleclientsmayconcurrentlyaccessthesameserver.Serverworkloadischaracterized,ontheonehand,bythenumberofclientsthattrytoconcurrentlyaccessaserver(i.e.workloadamount),andontheotherhand,bythenatureofrequestsmadebyclients(i.e.workloadmix),e.g.read-onlyrequestsmixvs.read-writerequestsmix.WorkloadamountisdenotedasNwhileworkloadmixisdenotedasM.Further-more,serverworkloadmayvaryovertime.Thiscorrespondstodifferentclientbehaviorsatdifferenttimes.Forinstance,ane-mailserviceusuallyfacesahigherworkloadamountinthemorningthanintherestoftheday.Serveradmissioncontrolisaclassicaltechniquetopre-ventaserverfromthrashingwhenthenumberofconcur-rentclientsgrows[11].Itconsistsinﬁxingalimitforthemaximumnumberofclientsallowedtoconcurrentlyaccessaserver–theMulti-ProgrammingLevel(MPL)conﬁgurationparameterofaserver.Abovethislimit,incomingclientre-questsarerejected.Thus,aclientrequestarrivingataservereitherterminatessuccessfullywitharesponsetotheclient,orisrejectedbecauseoftheserver’sMPLlimit.Therefore,duetotheMPLlimit,amongtheNclientsthattrytocon-currentlyaccessaserver,onlyNeclientsactuallyaccesstheserver,withNe≤MPL.Servers’MPLhasadirectimpactonthequality-of-service(QoS),performanceandavailabilityofserversasdiscussedbelow.2.2ServiceperformanceandavailabilitySeveralcriteriamaybeconsideredtocharacterizeserviceperformanceandavailability[20].Inthefollowing,wecon-siderinparticulartwometricsthatreﬂectperformanceandavailabilityfromtheuser’sperspective[20],namelylatencyandabadonrate.Serviceperformance–Latency.Clientrequestlatencyisdeﬁnedasthetimeneededbytheservertoprocessarequest.TheaverageclientrequestlatencyisdenotedasL.Alowclientrequestlatency(orlatency,forshort)isadesirablebe-haviorwhichreﬂectsareactivesystem.Figure1describestheimpactofserveradmissioncontrolandMPLvalueonclientrequestlatency,whentheworkloadamountvaries1.Here,threevaluesofMPLareconsidered,alowvalue(1),amediumvalue(25)andahighvalue(75).ThelowMPLisveryrestrictiveregardingclientconcurrencyontheserverandthus,keepstheserverunloadedandimpliesalowclientrequestlatency.Incontrast,withahighMPL,whentheserverworkloadamountincreasesclientrequestlatencyin-creasestoo.Serviceavailability–Abandonrate.Clientrequestaban-donrateisdeﬁnedastheratiobetweenrequestsrejectedduetoadmissioncontrolandthetotalnumberofrequestsreceivedbyaserver.Itisdenotedasα.Alowclientrequestaban-donrate(orabandonrate,forshort)isadesirablebehaviorthatreﬂectsserviceavailability.Figure2describestheim-pactofMPLonclientrequestabandonrate1.AlowMPLisveryrestrictiveregardingclientconcurrencyontheserver,andobviouslyimpliesahigherabandonratecomparedtoahighMPLwhichacceptsmoreclients.ServiceperformanceandserviceavailabilityarepartoftheSLA(ServiceLevelAgreement).TheSLAspeciﬁestheser-vicelevelobjectives(SLOs)suchasthemaximumlatencyLmaxandthemaximumabandonrateαmaxtobeguaranteedbytheserver.3FluidModelforServerSystemsWeproposeaﬂuidmodelwhichrendersthedynamicsofserversystemsandcapturescharacteristicsthatreﬂectthe1DetailsontheunderlyingexperimentaltestbedaregiveninSec-tion5.1.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
391