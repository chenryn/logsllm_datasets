1.6
22.8
80
MAC addr
# uniq
46,742
1,771
311,567
28,558
82,964
94,375
EUI-64 addr
# uniq
%
%
1.4
46,811
99.9
76.7
1,844
96.0
1.4
319,067
97.6
1.3
29,463
96.9
95.0
82,965
100.0
12.8
94,440
99.9
0.6
100.0
37.0
98.7
0.0
99.4
0.4
92.8
12.2
97.4
53.3
95.4
33.1
96.3
0.4
98.8
0.3
98.6
7.6
96.5
Scanning Date: Nov 2020
251,592
647,826
2,329,720
15,452
20,995
258,392
679,108
2,419,951
3,832,520
539
153
536
142
92,429
91,260
80
Broadband
Mobile
Broadband
Mobile
Enterprise
Broadband
IN
US
CN
Mobile
15,640
21,290
3,973,467
-
Scan Range: 32-bit space, uniq: unique number, same: same /64 with probe addr’s, diff: different /64 from probe addr’s
-
-
can only permute the rear segment of the 32-bit IPv4 address,
XMap could permute all the address space with any length and
at any position, such as the space between the 20th and 25th bit
of 2001:db8::/20-25 and 192.168.0.0/20-25. We leverage GMP
[35] to implement the address generation module. Nonetheless,
GMP just provides a big integer library, and all the related data
structures and functions should be rewritten, including the tree
structure to present addresses, the blocklist structure to ignore
addresses, the cyclic module to form a succeeding address, and
the expression structure to ﬁlter speciﬁc ﬁelds. In addition, the
IID generation module is created to ﬁll up the left bits behind
the preﬁx, and all related codes are improved to support IPv6.
XMap is fully compatible with ZMap and works for Linux,
macOS, and BSD, with about 15,000 SLOC of C. Researchers
could utilize it to conduct large-scale IPv6 network scanning
for security assessments, targeting any address or preﬁx space
with affordable network ability and facility. Network adminis-
trators can leverage it to evaluate their own networks’ security
and risks of being exposed. We believe XMap will contribute
to the future IPv6 Internet measurement studies and help the
security community gain more insights into the IPv6 networks.
C. Limitations
We acknowledge that there are several potential limitations
in our experiments. First, owing to various ISP’s ﬁltering poli-
cies and packet loss, the inferred sub-preﬁx length might be in-
correct. Thus, if an ISP has set up upstream ICMPv6, we could
underestimate the discovered devices. However, according to
measurement results in Table II, this situation is less common
in our study scope. Nevertheless, this case does not introduce
any false discovery. Second, there is no explicit ground-truth
dataset to determine whether the IPv6 periphery we discover
is indeed the last hop. Nonetheless, as described in Section II,
the unique /64 preﬁx tends to be the subnet boundary, and a
signiﬁcant portion of all the periphery addresses are the EUI-
64 format addresses. We examine the device types based on
the encoded MAC addresses, which turns out to be the CPE
and the UE devices in Table IV. Additionally, we also collect
TABLE III
-
EUI-64
Low-byte
Embed-IPv4
IID ANALYSIS OF DISCOVERED PERIPHERIES
# num
%
39.60M 75.5
5.46M
10.4
52.48M 100.0
# num %
7.6
3.97M
1.0
511.18k
2.91M
5.5
Randomized
Byte-pattern
Total
-
TOP APPEARED PERIPHERY VENDORS AND DEVICE NUMBER
TABLE IV
Total (3.9M), China Mobile (2.0M), ZTE (611.5k)
Skyworth (509.0k), Fiberhome (260.5k), Youhua Tech (146.5k)
China Unicom (107.9k), AVM (97.9k), Technicolor (46.3k)
Huawei (41.7k), StarNet (32.2k), TP-Link (1.8k), D-Link (1.5k)
Xiaomi (994), Hitron Tech (914), Netgear (149), Linksys (147)
Asus (145), Optilink (127), Tenda (110), MikroTik (50)
Total (1.8k), NTMore (633), HMD Global (282), Vivo (194)
Oppo (165), Apple (162), Samsung (126), Nokia (107)
LG (50), Motorola (30), Lenovo (25), Nubia (21), OnePlus (5)
CPE
UE
CPE: customer premise edge, e.g., home router (gateway)
UE: user equipment, e.g., smartphone
application-level information to conﬁrm the periphery to be
the last hop from Section V. Although the device owners may
modify the information, it has been addressed in [91] and the
identifying means is widely used in the community [66], [77].
D. Ethical Considerations
Our network scanning may induce several ethical concerns.
Here, we discuss them ﬁrst before presenting our measurement
results. Throughout this research, we acted in accordance with
the ethical conventions for network measurement studies, in-
cluding the best practices [29] and the broad ethical guidelines
[12], to minimize the potential impact as much as possible.
For instance, in our measurements, (i) we set up web pages
on the source probing IPv6 addresses, signal the benign intent
of the network scans, and show our contact details; (ii) we limit
the probing rate and lighten the probing to minimize negative
impacts; (iii) we restrict ourselves to regular TCP/UDP/ICMP
connection attempts followed by RFC-compliant protocols and
never undertake to exploit any vulnerabilities; (iv) in the end,
we also avoid releasing the discovered periphery addresses for
privacy concerns and disclose all found weaknesses or vulnera-
bilities to involved device vendors and network administrators.
92
Authorized licensed use limited to: Tsinghua University. Downloaded on October 11,2021 at 09:24:27 UTC from IEEE Xplore.  Restrictions apply. 
E. Periphery Discovery Results
XMap Performance. We performed the measurements from a
physical machine with a Xeon Silver 4210 2.2 GHz processor
and 16 GB RAM in November 2020. We only take 1
services are probed simultaneously at the same target address.
The application-speciﬁc requests and valid counterpart re-
sponses for each service are listed in Table VI. For TCP, a SYN
request is sent ﬁrstly to check the port openness. For UDP and
open TCP ports, then, we send the application-speciﬁc request.
If a valid response is received, we conclude that the service on
one target is active. We use the ZGrab2 tool [92] to collect the
basic application-level information, probing at 1000 pps rate
and never attempt to conduct further connecting and weakness
exploiting, following all the ethical steps in Section IV-D.
B. Measurement results
Overall, we ﬁnd unintended exposed services becoming an
emerging security risk in IPv6 networks. Speciﬁcally, we dis-
cover 4.7M unique IPv6 peripheries (9% of all the peripheries)
with as least one service alive. The number and proportion of
peripheries within each service and ISP are listed in Table VII.
For instance, 741k (1.4%) devices providing DNS resolution
services turn out to be DNS forwarders (home routers). 1.3M
(2.4%) routers’ web management pages (HTTP/80) could be
accessed by arbitrary external visitors. 138.6k (0.3%) routers
open remote login access (SSH/22) through the IPv6 network.
We use MAC addresses [45] embedded in EUI-64 addresses
and application-level provider information to identify the de-
vice vendors. Finally, we conﬁrm 1.7M devices with explicit
vendor afﬁliation, which are from the CPE device providers.
Figure 2 shows the top 10 most-frequently appeared vendors
and the number of devices with alive services, which are liable
to open. The top two most-opening services are HTTP (4.8M)
and DNS (741k). For example, devices from China Mobile are
prone to open HTTP/80 (8080) and DNS/53 services to public
IPv6 networks, whereas StarNet’s devices only tend to expose
HTTP/8080 to external visitors. All of the selected 7 services
except NTP are accessible for Youhua Tech’s devices.
Besides, Figure 3 demonstrates the number and proportion
of top 20 vendors within each service and presents which ven-
dor is likely to place some services open. Among the services,
several services are contributed by numbers of vendors, e.g.,
DNS (China Mobile, Fiberhome, Youhua Tech, ZTE), while
some are mainly supplied by two or three vendors, e.g., SSH
(Fiberhome, Youhua Tech) and TELNET (Youhua Tech, ZTE).
Fig. 3. Results of Top 20 Periphery Device Vendors within Each Service
For each service, we discuss its application-level results and
possible impacts. The most-frequently used software (version,
device number) are listed in Table VIII, including the number
of existing CVEs (from CVE database [83]), which are likely
leveraged to exploit the device with speciﬁc software version.
DNS. The IPv6 hitlist [33] holds ∼300k UDP/53 responsive
addresses in Nov 2020 and Hendriks et al. uncover 1,038 IPv6
DNS resolvers [42]. Park et al. ﬁnd the number of IPv4 open
DNS resolvers has decreased signiﬁcantly from 12M in 2013
to 3M in 2019 [69]. However, we still ﬁnd 741k active IPv6
open DNS resolvers within 15 sample IPv6 blocks.
As for the DNS software, we ﬁnd out the software running
on those devices is chieﬂy dnsmasq with a version from 2.4x
to 2.7x, released 2-8 years ago. 16 vulnerabilities could impact
such devices, e.g., DoS and buffer overﬂow bugs. Additionally,
accessible DNS service can (i) leak internal-only DNS records
and cache, and (ii) facilitate DDoS attacks for IPv6 [42].
For example, both 28k devices from Reliance Jio and 23k
devices from Bharti Airtel are running dnsmasq 2.7x. In China
Mobile’s broadband network, devices opening DNS services
are mainly from Fiberhome (198k), Youhua Tech (142k), and
China Mobile (62k). Thereinto, the software on 141k Youhua
Tech devices is dnsmasq 2.4x released ∼8 years ago.
HTTP and HTTPS. Respectively, We ﬁnd 1.3M (HTTP/80),
3.5M (HTTP/8080), and 144k (TLS/443) active devices. The
most-frequently adopted web servers are listed in Table VIII,