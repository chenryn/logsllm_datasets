### References

1. **Lorenz Breidenbach, Phil Daian, Floriantra Er, and Ari Juels. 2018. Enter the Hydra: Towards Principled Bug Bounties and Exploit-Resistant Smart Contracts.**
   - *In 27th USENIX Security Symposium (USENIX Security 18). 1335–1352.*
   - *URL:* [https://thehydra.io/paper.pdf](https://thehydra.io/paper.pdf)

2. **Miguel Castro and Barbara Liskov. 1999. Practical Byzantine Fault Tolerance.**
   - *In Proceedings of the Third Symposium on Operating Systems Design and Implementation. 173–186.*
   - *DOI:* [https://doi.org/10.1.1.17.7523](https://doi.org/10.1.1.17.7523)
   - *arXiv:* [arXiv:arXiv:1203.6049v1](https://arxiv.org/abs/1203.6049v1)

3. **Gaby G. Dagher, Benedikt Bünz, Joseph Bonneau, Jeremy Clark, and Dan Boneh. 2015. Provisions: Privacy-preserving proofs of solvency for Bitcoin exchanges.**
   - *In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security (CCS '15). ACM Press, New York, New York, USA, 720–731.*
   - *DOI:* [https://doi.org/10.1145/2810103.2813674](https://doi.org/10.1145/2810103.2813674)

4. **Philip Daian, Steven Goldfeder, Tyler Kell, Yunqi Li, Xueyuan Zhao, Iddo Bentov, Lorenz Breidenbach, and Ari Juels. 2019. Flash Boys 2.0: Frontrunning, Transaction Reordering, and Consensus Instability in Decentralized Exchanges.**
   - *arXiv:1904.05234*
   - *URL:* [http://arxiv.org/abs/1904.05234](http://arxiv.org/abs/1904.05234)

5. **Bernardo David, Peter Gaži, Aggelos Kiayias, and Alexander Russell. 2018. Ouroboros Praos: An Adaptively-Secure, Semi-synchronous Proof-of-Stake Blockchain.**
   - *In Advances in Cryptology - EUROCRYPT 2018, Jesper Buus Nielsen and Vincent Rijmen (Eds.), Vol. 46. Springer International Publishing, Cham, 66–98.*
   - *DOI:* [https://doi.org/10.1007/978-3-319-78375-8_3](https://doi.org/10.1007/978-3-319-78375-8_3)

6. **Shane Frederick, George Loewenstein, and Ted O’Donoghue. 2002. Time Discounting and Time Preference: A Critical Review.**
   - *Journal of Economic Literature 40, 2 (2002), 351–401.*
   - *JSTOR:* [http://www.jstor.org/stable/2698382](http://www.jstor.org/stable/2698382)

7. **Sebastian Gajek. 2018. Graded Token-Curated Decisions with Up/Downvoting.**
   - *URL:* [https://medium.com/coinmonks/graded-token-curated-decisions-with-up-downvoting-designing-cryptoeconomic-ranking-and-2ce7c000bb51](https://medium.com/coinmonks/graded-token-curated-decisions-with-up-downvoting-designing-cryptoeconomic-ranking-and-2ce7c000bb51)

8. **Juan Garay, Aggelos Kiayias, and Nikos Leonardos. 2015. The Bitcoin Backbone Protocol: Analysis and Applications.**
   - *In Advances in Cryptology - EUROCRYPT 2015. Springer, 281–310.*
   - *URL:* [http://courses.cs.washington.edu/courses/cse454/15wi/papers/bitcoin-765.pdf](http://courses.cs.washington.edu/courses/cse454/15wi/papers/bitcoin-765.pdf)

9. **Arthur Gervais, Ghassan O Karame, Karl Wüst, Vasileios Glykantzis, Hubert Ritzdorf, and Srdjan Capkun. 2016. On the Security and Performance of Proof of Work Blockchains.**
   - *In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security. ACM, 3–16.*

10. **Arthur Gervais, Hubert Ritzdorf, Ghassan O Karame, and Srdjan Capkun. 2015. Tampering with the Delivery of Blocks and Transactions in Bitcoin.**
    - *In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security. ACM, 692–705.*

11. **Dominik Harz and Magnus Boman. 2019. The Scalability of Trustless Trust.**
    - *In 2nd Workshop on Trusted Smart Contracts (Financial Cryptography and Data Security). 279–293.*
    - *DOI:* [https://doi.org/10.1007/978-3-662-58820-8_19](https://doi.org/10.1007/978-3-662-58820-8_19)
    - *arXiv:* [arXiv:1801.09535](https://arxiv.org/abs/1801.09535)

12. **Ethan Heilman, Alison Kendler, Aviv Zohar, and Sharon Goldberg. 2015. Eclipse Attacks on Bitcoin’s Peer-to-Peer Network.**
    - *In 24th USENIX Security Symposium (USENIX Security 15). 129–144.*
    - *URL:* [https://www.usenix.org/system/files/conference/usenixsecurity15/sec15-paper-heilman.pdf](https://www.usenix.org/system/files/conference/usenixsecurity15/sec15-paper-heilman.pdf)

13. **Ferry Hendrikx, Kris Bubendorfer, and Ryan Chard. 2015. Reputation Systems: A Survey and Taxonomy.**
    - *J. Parallel and Distrib. Comput. 75 (January 2015), 184–197.*
    - *DOI:* [https://doi.org/10.1016/j.jpdc.2014.08.004](https://doi.org/10.1016/j.jpdc.2014.08.004)

14. **Audun Jøsang, Roslan Ismail, and Colin Boyd. 2007. A Survey of Trust and Reputation Systems for Online Service Provision.**
    - *Decision Support Systems 43, 2 (March 2007), 618–644.*
    - *DOI:* [https://doi.org/10.1016/j.dss.2005.05.019](https://doi.org/10.1016/j.dss.2005.05.019)

15. **Harry Kalodner, Steven Goldfeder, Xiaoqi Chen, S Matthew Weinberg, and Edward W Felten. 2018. Arbitrum: Scalable, Private Smart Contracts.**
    - *In Proceedings of the 27th USENIX Conference on Security Symposium. USENIX Association, 1353–1370.*

16. **Sepandar D Kamvar, Mario T Schlosser, and Hector Garcia-Molina. 2003. The Eigentrust Algorithm for Reputation Management in P2P Networks.**
    - *In Proceedings of the Twelfth International Conference on World Wide Web (WWW '03). ACM Press, New York, New York, USA, 640.*
    - *DOI:* [https://doi.org/10.1145/775152.775242](https://doi.org/10.1145/775152.775242)

17. **Rami Khalil and Arthur Gervais. 2017. Revive: Rebalancing Off-Blockchain Payment Networks.**
    - *Cryptology ePrint Archive, Report 2017/823.*
    - *URL:* [http://eprint.iacr.org/2017/823.pdf](http://eprint.iacr.org/2017/823.pdf) (Accessed: 2017-09-26)

18. **Rami Khalil, Arthur Gervais, and Guillaume Felley. 2018. NOCUST – A Securely Scalable Commit-Chain.**
    - *IACR Cryptology ePrint Archive 2018, 642.*

19. **Rami Khalil, Arthur Gervais, and Guillaume Felley. 2019. TEX – A Securely Scalable Trustless Exchange.**
    - *IACR Cryptology ePrint Archive 2019, 265.*

20. **Ahmed Kosba, Andrew Miller, Elaine Shi, Zikai Wen, and Charalampos Papamanthou. 2016. Hawk: The Blockchain Model of Cryptography and Privacy-Preserving Smart Contracts.**
    - *In Symposium on Security & Privacy. IEEE.*
    - *URL:* [http://eprint.iacr.org/2015/675.pdf](http://eprint.iacr.org/2015/675.pdf)

21. **Ranjit Kumaresan and Iddo Bentov. 2014. How to Use Bitcoin to Incentivize Correct Computations.**
    - *In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security. ACM, 30–41.*
    - *URL:* [http://www.cs.technion.ac.il/~idddo/incentivesBitcoin.pdf](http://www.cs.technion.ac.il/~idddo/incentivesBitcoin.pdf)

22. **Yoad Lewenberg, Yoram Bachrach, Yonatan Sompolinsky, Aviv Zohar, and Jeffrey S Rosenschein. 2015. Bitcoin Mining Pools: A Cooperative Game Theoretic Analysis.**
    - *Proceedings of the 14th International Conference on Autonomous Agents and Multiagent Systems (AAMAS 2015), 919–927.*

23. **Orfeas Stefanos Thyfronitis Litos and Dionysis Zindros. 2017. Trust Is Risk: A Decentralized Financial Trust Platform.**
    - *156 pages.*

24. **Loi Luu, Jason Teutsch, Raghav Kulkarni, and Prateek Saxena. 2015. Demystifying Incentives in the Consensus Computer.**
    - *In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security. ACM, 706–719.*
    - *URL:* [http://www.comp.nus.edu.sg/~prateeks/papers/VeriEther.pdf](http://www.comp.nus.edu.sg/~prateeks/papers/VeriEther.pdf)

25. **Trent McConaghy. 2018. The Layered TCR.**
    - *URL:* [https://blog.oceanprotocol.com/the-layered-tcr-56cc5b4cdc45](https://blog.oceanprotocol.com/the-layered-tcr-56cc5b4cdc45)

26. **Patrick McCorry, Alexander Hicks, and Sarah Meiklejohn. 2018. Smart Contracts for Bribing Miners.**
    - *In Financial Cryptography and Data Security (FC 2018), Vol. 10958. Springer Berlin Heidelberg, 3–18.*
    - *DOI:* [https://doi.org/10.1007/978-3-662-58820-8_1](https://doi.org/10.1007/978-3-662-58820-8_1)

27. **Mike Goldin. 2017. Token-Curated Registries 1.0.**
    - *10 pages.*
    - *URL:* [https://medium.com/@ilovebagels/token-curated-registries-1-0-61a232f8dac7](https://medium.com/@ilovebagels/token-curated-registries-1-0-61a232f8dac7)

28. **Andrew Miller, Yu Xia, Kyle Croman, Elaine Shi, and Dawn Song. 2016. The Honey Badger of BFT Protocols.**
    - *In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security. ACM, 31–42.*

29. **Tyler Moore and Nicolas Christin. 2013. Beware the Middleman: Empirical Analysis of Bitcoin-Exchange Risk.**
    - *In International Conference on Financial Cryptography and Data Security. Springer, 25–33.*

30. **Satoshi Nakamoto. 2008. Bitcoin: A Peer-to-Peer Electronic Cash System.**
    - *URL:* [https://bitcoin.org/bitcoin.pdf](https://bitcoin.org/bitcoin.pdf) (Accessed: 2015-07-01)

31. **Noam Nisan, Tim Roughgarden, Eva Tardos, and Vijay V. Vazirani. 2007. Algorithmic Game Theory.**
    - *Vol. 1. Cambridge University Press, Cambridge. 1–754 pages.*
    - *DOI:* [https://doi.org/10.1017/CBO9780511800481](https://doi.org/10.1017/CBO9780511800481)
    - *arXiv:* [arXiv:0907.4385](https://arxiv.org/abs/0907.4385)

32. **Rafael Pass, Lior Seeman, and Abhi Shelat. 2017. Analysis of the Blockchain Protocol in Asynchronous Networks.**
    - *In Advances in Cryptology - EUROCRYPT 2017, Vol. 10211. 643–673.*
    - *DOI:* [https://doi.org/10.1007/978-3-319-56614-6_22](https://doi.org/10.1007/978-3-319-56614-6_22)

33. **Isaac Pinyol and Jordi Sabater-Mir. 2013. Computational Trust and Reputation Models for Open Multi-Agent Systems: A Review.**
    - *Artificial Intelligence Review 40, 1 (2013), 1–25.*
    - *DOI:* [https://doi.org/10.1007/s10462-011-9277-z](https://doi.org/10.1007/s10462-011-9277-z)

34. **Joseph Poon and Thaddeus Dryja. 2016. The Bitcoin Lightning Network.**
    - *URL:* [https://lightning.network/lightning-network-paper.pdf](https://lightning.network/lightning-network-paper.pdf) (Accessed: 2016-07-07)

35. **Achill Rudolph. 2018. Ranking Token Curated Registries.**
    - *URL:* [https://medium.com/coinmonks/ranking-token-curated-registries-e9a92dc85b31](https://medium.com/coinmonks/ranking-token-curated-registries-e9a92dc85b31)

36. **Tuomas W. Sandholm and Victor R. Lesser. 2001. Leveled Commitment Contracts and Strategic Breach.**
    - *Games and Economic Behavior 35, 1-2 (2001), 212–270.*
    - *DOI:* [https://doi.org/10.1006/game.2000.0831](https://doi.org/10.1006/game.2000.0831)

37. **Tendermint. 2016. Introduction to Tendermint.**
    - *URL:* [https://tendermint.com/intro](https://tendermint.com/intro)

38. **Jason Teutsch and Christian Reitwießner. 2017. A Scalable Verification Solution for Blockchains.**
    - *44 pages.*
    - *URL:* [https://www.cs.cornell.edu/~iddo/pisa.pdf](https://www.cs.cornell.edu/~iddo/pisa.pdf)

39. **Petar Tsankov, Andrei Dan, Dana Drachsler-Cohen, Arthur Gervais, Florian Buenzli, and Martin Vechev. 2018. Securify: Practical Security Analysis of Smart Contracts.**
    - *In Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications Security. ACM, 67–82.*

40. **Gavin Wood. 2014. Ethereum: A Secure Decentralised Generalised Transaction Ledger.**
    - *32 pages.*

41. **Michael Wooldridge. 2009. An Introduction to MultiAgent Systems (2nd ed.).**
    - *Wiley Publishing.*

42. **Jiangshan Yu, David Kozhaya, Jeremie Decouchant, and Paulo Verissimo. 2019. RepuCoin: Your Reputation is Your Power.**
    - *IEEE Trans. Comput. (2019), 1–1.*
    - *DOI:* [https://doi.org/10.1109/TC.2019.2900648](https://doi.org/10.1109/TC.2019.2900648)

43. **Alexei Zamyatin, Dominik Harz, Joshua Lind, Panayiotis Panayiotou, Arthur Gervais, and William J. Knottenbelt. 2019. XCLAIM: Trustless, Interoperable, Cryptocurrency-Backed Assets.**
    - *In Proceedings of the IEEE Symposium on Security & Privacy, May 2019. 1254–1271.*
    - *DOI:* [https://doi.org/10.1109/SP.2019.00085](https://doi.org/10.1109/SP.2019.00085)

44. **Fan Zhang, Ethan Cecchetti, Kyle Croman, Ari Juels, and Elaine Shi. 2016. Town Crier: An Authenticated Data Feed for Smart Contracts.**
    - *In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security. ACM, 270–282.*
    - *URL:* [https://eprint.iacr.org/2016/168.pdf](https://eprint.iacr.org/2016/168.pdf)

45. **Guy Zyskind, Oz Nathan, and Alex Pentland. 2015. Enigma: Decentralized Computation Platform with Guaranteed Privacy.**
    - *arXiv preprint arXiv:1506.03471.*
    - *URL:* [https://arxiv.org/pdf/1506.03471.pdf](https://arxiv.org/pdf/1506.03471.pdf) (Accessed: 2017-08-22)

### A. Cryptoeconomic Protocols
**Figure 6: A cryptoeconomic protocol consists of three states:**
1. **Commitment:** An agent commits to fulfilling a specification ϕ.
2. **Execution:** The agent executes an action that either evaluates to true or false with respect to the specification.
3. **Conclusion:** The protocol concludes by rewarding or punishing the agent based on their action.

### B. Incentive Proofs
The rational agent type \( T_r \) needs to decide which action to perform at the highest layer. From Figure 3, we see that at the highest layer, the agent has the choice to perform the desired action, resulting in a utility of \( p - c_A - E[rD_3] \), or an undesired action, resulting in a utility of \( v - c_A - E[rD_3] - D_3 \). In this simplified figure, there are three layers, but we can generalize this by assuming \( \omega \) layers. By Definition 4, the rational type cannot come to a decision just considering these two utility functions; reaching a decision requires \( T_r \) to consider several time-steps. By integrating Balance, we transform the decision process into a sequential game.

#### B.1 Decision Boundary for Type \( T_r \)
The total utility received by an agent performing desired actions in the highest layer, for a sequence that lasts \( t = \omega \) rounds, is expressed by:
\[
u_A = \sum_{t=0}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( p - c_A - E[rD_\omega] \right)
\]
Summing over cycles to infinity yields the following expression (with \( \tau \) swapped for \( t \) to express ‘within’ cycle time):
\[
u_A = \sum_{\gamma=0}^{\infty} \left( \frac{\delta}{1 + r} \right)^{\gamma \omega} \sum_{\tau=0}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^\tau \left( p - c_A - E[rD_\omega] \right)
\]

The total utility corresponding to an agent who commits an undesired action in the highest layer \( \omega \), followed by \( \omega - 1 \) desired actions to return to that layer, can be expressed as a sequence with \( t = \omega \) rounds as follows. We express the deposit \( D \) of layer \( L_m \in L \) at time \( t \) with \( D_t \):
\[
u_A = v - c_A - E[rD_\omega] - D_\omega + \sum_{t=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( p - c_A - E[rD_t] \right)
\]
Summing over cycles to infinity yields the following expression (with \( \tau \) swapped for \( t \) to express ‘within’ cycle time):
\[
u_A = \sum_{\gamma=0}^{\infty} \left( \frac{\delta}{1 + r} \right)^{\gamma \omega} \left( v - c_A - D_\omega - E[rD_\omega] \right) + \sum_{\tau=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^\tau \left( p - c_A - E[rD_\tau] \right)
\]

The decision boundary for agents of type \( T_r \) is found by equating equations (25) and (27):
\[
\sum_{\gamma=0}^{\infty} \left( \frac{\delta}{1 + r} \right)^{\gamma \omega} \sum_{\tau=0}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^\tau \left( p - c_A - E[rD_\omega] \right) = \sum_{\gamma=0}^{\infty} \left( \frac{\delta}{1 + r} \right)^{\gamma \omega} \left( v - c_A - D_\omega - E[rD_\omega] \right) + \sum_{\tau=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^\tau \left( p - c_A - E[rD_\tau] \right)
\]

**Proof.** First, we equate (24) and (26) characterizing the decision boundary. Next, we set \( D_\omega = f_\omega D_{\text{base}} \) and \( D_t = f_t D_{\text{base}} \) (where \( t \) and \( m \) are substitutes for a single cycle). This leaves us with the following equality:
\[
\sum_{t=0}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( p - c_A - E[r f_\omega D_{\text{base}}] \right) = v - c_A - E[r f_\omega D_{\text{base}}] - (f_\omega D_{\text{base}}) + \sum_{t=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( p - c_A - E[r f_t D_{\text{base}}] \right)
\]

We assume that the agent is able to progress to the next layer after every time step \( t \). Also, we apply our initial assumptions that \( p - c_A \) for performing a desired action is 0, and that \( c_A \) for the undesired action is 0. We then simplify (31):
\[
\sum_{t=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( p - c_A - E[r f_\omega D_{\text{base}}] \right) = v - f_\omega D_{\text{base}} - E[r f_\omega D_{\text{base}}] + \sum_{t=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( p - c_A - E[r f_t D_{\text{base}}] \right)
\]
\[
\sum_{t=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( - E[r f_\omega D_{\text{base}}] \right) = v - f_\omega D_{\text{base}} - E[r f_\omega D_{\text{base}}] + \sum_{t=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( - E[r f_t D_{\text{base}}] \right)
\]
\[
\sum_{t=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( - E[r f_\omega D_{\text{base}}] \right) = v - f_\omega D_{\text{base}} - E[r f_\omega D_{\text{base}}] + \sum_{t=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^t \left( - E[r f_t D_{\text{base}}] \right)
\]
\[
E[r D_{\text{base}} (f_t - f_\omega)] = v - f_\omega D_{\text{base}}
\]

Summing over cycles to infinity yields the following expression:
\[
\sum_{\gamma=0}^{\infty} \left( \frac{\delta}{1 + r} \right)^{\gamma \omega} \sum_{\tau=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^\tau \left( - E[r f_\omega D_{\text{base}}] \right) = \sum_{\gamma=0}^{\infty} \left( \frac{\delta}{1 + r} \right)^{\gamma \omega} \left( v - f_\omega D_{\text{base}} - E[r f_\omega D_{\text{base}}] \right) + \sum_{\tau=1}^{\omega-1} \left( \frac{\delta}{1 + r} \right)^\tau \left( - E[r f_t D_{\text{base}}] \right)
\]

This completes the proof.