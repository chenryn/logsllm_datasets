MPLS Raw
Complete
2009
2010
5
8
2011 13
2012 21
2013 25
2014 29
7,765
2,128
988
4,009
17,472
3,550
1,363
6,331
0
21
51,636
8,347
2,365 12,307 211
154,791 18,589
3,918 23,225 704
14
48
199
680
47 68 %
59 52 %
1,235 22 %
2,783 42 %
256,725 25,891
4,992 33,239 370
1,468
14,366 45 %
772,461 32,391
6,224 43,309 719
2,526
49,232 77 %
2015 29
1,181,139 38,901
8,181 58,150 420
3,098
50,805 85 %
Fig. 2. Raw number of IPv6 traces
traversing at least one MPLS tunnel.
Fig. 3. IPv6 MPLS tunnels length
distribution
the IPv4 core, the IPv4 router may be unable to send an ICMPv6 error message.
In this case, the traceroute will be incomplete and the non-responding hop will
be replaced by a *. If the router has no IPv6 connectivity but is IPv6-aware, it
may send an ICMPv6 message, using a so-called IPv4-mapped IPv6 address [20]
as source address. The error message is then propagated towards the Egress LER
using MPLS, and then propagated through IPv6 routing.
3 Evaluation
3.1 Dataset
For evaluating the deployment of MPLS under IPv6, we use the IPv6 Archipe-lago
dataset [21]. The data is collected by performing ICMP-based ParisTraceroute
364
Y. Vanaubel et al.
measurements [22], using scamper [23]. Each vantage point probes all announced
IPv6 preﬁxes (/48 or shorter) once every 48 h by targeting a single random des-
tination in each preﬁx. Some vantage points might, in addition, probe the ﬁrst
address (i.e., ::1) in a preﬁx.
Table 1 provides raw statistics about the IPv6 dataset. We collected the
probing campaign made every January 1st since 2009. From this dataset, we
extracted the various traces, explicit MPLS tunnels, and performed an IP2AS
mapping using Team Cymru.1 As already stated by others [1,2], we observe a
slow deployment of IPv6 between 2009 and 2013, compensated by a fast increase
between 2014 and 2015. MPLS deployment in IPv6 follows that tendency, the
peak of MPLS tunnels being reached in 2014 and 2015. In the following sub-
section, we will focus on data collected between January, 1st 2014 and August,
1st 2015. For that period of time, we take into account the ﬁrst measurement
snapshot of each month, leading to 20 measurement cycles.
Figures 2 and 3 provide basic statistics about MPLS deployment in IPv6.
In particular, Fig. 2 gives the raw number of traceroute (between January,
1st 2014 and August, 1st 2015) that traverses at least one MPLS tunnel. If the
quantity of traces increases over time, on the contrary, the amount of traces
involved in an MPLS tunnel remains quite stable. Compared to IPv4 [4,5,7],
traceroute are traversing much less MPLS tunnels: on the order of 7–8% in
IPv6 against (at least) 40 % for IPv4. Note that the drop observed, in terms of
number of traces seen, in early 2015, is due to less active vantage points.
Figure 3 gives the tunnel length distribution for four measurement snapshots,
including Ingress and Egress LER in the length distribution. This means that a
length of 3 corresponds to a tunnel with a single LSR. We observe that the tunnel
length oscillates between 3 and 21. More interestingly, the tunnel length seems
to decrease over time, i.e., tunnels observed in 2015 are shorter than tunnels in
2014. This is due to the fact that MPLS tunnels of AS174 (Cogent) disappear
from the dataset around October 2014, and Cogent made use of long tunnels.2
While encountering a few longer tunnels, MPLS IPv6 tunnels length distribution
follows observations made in IPv4 [4,5].
3.2 Label Stack Size Distribution
In this section, we study the characteristics of IPv6 MPLS tunnels compared to
IPv4 ones. First, we are interested in the typical LSE size used by both data
planes (i.e., the number of MPLS labels contained at each single LSR). The
methodology we follow is quite simple: for each LSR of each tunnel, we count
the number of labels contained in the stack and, on this basis, we map each
tunnel to the maximum number of labels revealed by each of its LSRs. For
short MPLS tunnels, it allows for mapping them to their most likely usage. For
instance, and for IPv4 data plane, a short tunnel made of three LSRs such that
we ﬁnd the sequence 1,2,1 (in term of LSE sizes) we claim that such a tunnel
1 http://www.team-cymru.org/.
2 The impact of AS174 in IPv6 has already been discussed in the past [24, 25].
A Brief History of MPLS Usage in IPv6
365
is likely to be used for VPN purposes so that we retain the maximum value of
two to map it to a 2-label LSP. Note that, in such a case, the bottom label is
constant (i.e., the same from end-to-end) in order to denote the outgoing VRF
(Virtual Routing and Forwarding) to use at the Egress LER.
Figure 4 shows the LSE size distribution over time, between January, 1st,
2014 and August, 1st, 2015. Globally speaking, we observe a diﬀerent behavior
between IPv4 (Fig. 4(a)) and IPv6 (Fig. 4(b)). Indeed, under IPv4, the major-
ity of tunnels (around 80 %) exhibits a single LSE (this results is aligned with
Sommers et al. observations [4]) while, in IPv6, the majority of tunnels (around
80 % also during the ﬁrst half of the considered period) exhibits at least two
labels.3 This result may appear really surprising since there is no obvious reason
that justiﬁes a more extensive use of VPN in IPv6 than in IPv4.
Figure 5 deeper investigates the LSE typical content in IPv6. In particular, it
looks at the label value at the bottom of the stack. As explained in Sect. 1, if the
value is 2, it suggests a usage of 6PE where core LSRs are dual-stack capable.
Figure 5 clearly depicts a shift around October 2014. Before that date, tunnels
with a label stack are observed almost as often with a bottom label 2 as with
another bottom label. After October 2014, things are crystal clear: the majority
of tunnels (more than 80 %) having a LSE stack use a bottom label of 2, meaning
the usage of this type of 6PE is prevalent.
For tunnels with bottom label 2, we remove this bottom label, and compare
the series of remaining labels with series of labels from tunnels found in IPv4
MPLS traces (in the same period).4 We ﬁnd out that a match is present in more
than 40 % of the cases meaning that the same IPv4 LSP is used for IPv6 traﬃc
reinforcing so our assumption about the 6PE usage.
The radical behavior change depicted in Fig. 5 is very surprising at the ﬁrst
glance. To explain it, we investigate the diﬀerent ASes we encountered in the
dataset around this date. Before October 2014, around 50 % of the tunnels belong
to AS174 (Cogent). In November 2014, this AS disappears from the MPLS
dataset while it remains visible through numerous non MPLS IPs. Almost all
tunnels belonging to this Tier-1 network have a 2-label stack, but never use the
bottom label 2. This is the reason why we have such a behavior modiﬁcation in
Fig. 5. The usage of label stack for Cogent is investigated in details in Sect. 3.3
since it is almost only speciﬁc to this AS.
Figure 6 looks at the architecture of the network core in case of dual-stack 6PE
usage (i.e., bottom label 2). We observe a tiny proportion of 6PE tunnels that map
IPv4 addresses into IPv6 ones (black region in Fig. 6). We understand this as a
case where core LSRs are IPv6 aware (i.e., they are dual-stack) but do not have
public IPv6 addresses. In order to be able to reply to probes (i.e., generating ICMP
time-exceeded messages), they map their IPv4 address in a “fake” IPv6 one.
Most dual-stack 6PE tunnels we observed in the dataset have an IPv6 core
(LSRs are dual-stack and have public IPv6 addresses). However, this 6PE usage
3 The drop around October 2014 in IPv6 is due to the drastic decrease of MPLS usage
by Cogent in the dataset. We show in details in Sect. 3.3 that Cogent has been a
heavy user of LSE stacks but then got rid of MPLS.
4 These IPv4 MPLS traces were also downloaded from the Archipelago dataset.
366
Y. Vanaubel et al.
Fig. 4. LSE stack size distribution over time.
Fig. 5. Distribution of the value in the
bottom stack LSE in IPv6.
Fig. 6. 6PE core architecture.
corresponds to the case where LSPs are deployed with LDPv4. That is, the
same LSPv4 generally built with LDP and attached to a given IPv4 loopback
destination on the Egress LER is used for both IPv4/v6 traﬃcs. The bottom
label 2 indicates to the Egress LER that the traﬃc is made of IPv6 packets
rather than IPv4 ones (where the LSP is made of the same series of top labels
without the bottom label). However, note that in practice and at the origin,
6PE has been used to ensure connectivity between IPv6 islands with a tunnel
having a pure IPv4 core. In this case, LSRs are not IPv6 aware (no dual-stack
and no IPv6 addresses). In such an architecture, IPv4 LSRs will not respond
to IPv6 probes of traceroute, and the traces in our dataset are incomplete
(several * appear between 6PEs). Unfortunately, we are not able to diﬀerentiate
such a behavior from IPv6 nodes that simply not respond to the probes. The
proportion of this type of 6PE tunnels is therefore underestimated in this paper.
3.3 The Cogent Case
The Cogent case is particularly interesting and quite intriguing. It has both
a very prominent position in the dataset (Cogent is one of the largest Tier-1,
in particular it has the second highest AS rank according to CAIDA5) and,
5 See http://as-rank.caida.org/.
A Brief History of MPLS Usage in IPv6
367
most of all, an MPLS IPv6 behavior completely diﬀerent from other ASes we
observed. This can be seen in Fig. 5 where around October 2014 Cogent more or
less disappears from CAIDA MPLS traces and at the same time the proportion
of stacks with bottom label 2 rises sharply.
First, the fact that MPLS traces are almost absent from Cogent after this
date may either be due to a change in the conﬁguration of its routers or, more
simply, that the operator gets rid of MPLS. We conduct some tests to understand
whether Cogent removes ttl-propagate at Ingress LERs to make MPLS tunnels
invisible or not. This type of phenomenon has already been observed for IPv4
MPLS (look at Vanaubel et al. [7] and the speciﬁc study on Level3). For this