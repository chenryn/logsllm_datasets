lows (see also Fig. 4). When A makes a query to Ty (resp. Tx)
by sending a challenge a(cid:48) (resp. a(cid:48)(cid:48)), B reads the correspond-
if j = cntt,β ≤ γ
ing index j = cntt,β (resp. cntt,β⊕1):
(resp. j = cntt,β⊕1 ≤ q), B retrieves the k-bit block s = yj
(resp. s = xj), sends the value c(cid:48) = hs(a(cid:48)) back to attacker
A, and then increments cntt,β (resp. cntt,β⊕1); otherwise,
B draws a random bit α, returns it, and aborts. In phase 2,
B disables access to tag Tiβ⊕1 = Tx (since according to the
privacy game, the random bit β drawn by B makes Tiβ = Ty
the tag selected for phase 2) and answers challenges a(cid:48)(cid:48) to Tiβ
by ﬁrst ensuring that j = cntt,β  s, this gives:
a − s
2q + 1
2q + 1
2q + 1
d(cid:48)∈D(cid:48)
Pr
d∈D
”
+ a
d∈D
d∈D
+
2
2
.
.
.
(cid:48)
We thus have shown that if there exists a (q, T (cid:48), a)-privacy
adversary then the probability distributions D and D(cid:48) can
be distinguished from each other in time T (cid:48) + 3qTh with an
advantage at least a−s
2q+1 . This can be restated as follows:
AdvD,D(cid:48) (T
(cid:48)
+ 3qTh) ≥ a − s
2q + 1
.
(1)
˜”
,
The following lemma which proof is given in Appendix D,
exhibits a link between the advantage in distinguishing the
probability distributions D and D(cid:48) and the advantage in
distinguishing g from a perfect random number generator.
Lemma 10. For any running time T we have:
AdvD,D(cid:48) (T ) ≤ (3q + 2) Adv
prng
g
(T + (2q + 2)Tg) .
If we apply the above Lemma 2 to T (cid:48) + 3qTh and observe
that (T (cid:48) + 3qTh) + (2q + 2)Tg ≤ T (cid:48) + (ω + 1)(Tg + 2qTh) = T
and that Adv
(T ) ≤ g, we get the inequality:
prng
g
+ 3qTh) ≤ (3q + 2)g .
AdvD,D(cid:48) (T
(2)
Combining (1) and (2) shows that if there is a (q, T (cid:48), a)-
privacy adversary, then a ≤ (2q + 1)(3q + 2)g + s which
concludes the proof.
5.4 Correctness of PFP
(cid:48)
Theorem 11. Let g be a (T, g)-secure PRNG where T ≥
(N − 1)ω2Th + (ω + 1)Tg, let {hs}s∈S be an -almost strongly
universal hash functions family, and let q ≤ 1
2 . The PFP
RFID authentication protocol is (q, T (cid:48), c)-correct with T (cid:48) =
T − (ω + 1)(Tg + qTh) and c = (N − 1)ω22−m + N ωg +
ω(g + 2−l + (1 + 2q)).
Proof. A reader only rejects an undisturbed authentica-
tion exchange initiated by a legitimate tag when the reader
has updated its state with respect to this tag but the tag did
not update its internal state (we denote by p the probability
of this event). This only happens through an impersonation
attack by the attacker or because of a desynchronization.
As g is (T, g)-secure, Prop. 7 shows that the probability of
an impersonation attack is less than ω(g + 2−l + (1 + 2q)).
The desynchronization results from the back-end system
authenticating a tag Tj instead of the tag Tj(cid:48) actually run-
ning the authentication protocol. This happens when a col-
(j(cid:48))
lision hg2(σ
)(a) occurs and results in the
)(a) = hg2(σ
i(cid:48)
back-end system updating its view of the internal state σ(j)
of Tj instead of that of T (cid:48)
j . To upper-bound the probability
of a desynchronization event, we prove that in a system with
N tags, the probability pc that a collision involving a given
tag Tj occurs during the up to N ω authentications that may
take place during the lifetime of the system is negligible.
ω is ((N − 1)ω2Th, N ωg)-secure.
Theorem 3 shows that GN
If (xi
j)1≤i≤ω is a random sequence of ω blocks of m bits for
any 1 ≤ j ≤ N , Lemma 5 shows that for any ﬁxed value a:
(j)
i
(cid:48) (cid:54)= j, i, i
(cid:48) | hxi
j
(a) = hxi(cid:48)
Prˆ∃j
Prˆ∃j
Assume for a contradiction that for a ﬁxed a and N random
values σ(j), we have:
(cid:48) (cid:54)= j, i, i
(cid:48) | hg2(gi
1(σ(j)))(a) = hg2(gi(cid:48)
−m .
j(cid:48) (a)˜ ≤ (N − 1)ω22
1 (σ(j(cid:48))))(a)˜
> (N − 1)ω22
−m + N ωg .
We can then construct an adversary A that distinguishes a
sequence generated by the extended generator GN
ω in time
j)1≤i≤ω}1≤j≤N , A outputs ‘1’ if
(N − 1)ω2Th: on input {(yi
a collision involving the sequence (yi
j(cid:48) )1≤i≤ω is found for the
input value a, and outputs ‘0’ otherwise. If A has received a
j) = 1] ≤ (N−1)ω22−m.
truly random sequence, then Pr[A(yi
If A has received {`g2(gi
PrˆA`g2(gi
1(sj))´ = 1˜ > (N − 1)ω22
1≤i≤ω
1(σ(j)))´
}1≤j≤N then:
−m + N ωg ,
prng
GN
ω
((N − 1)ω2Th) > N ωg, a contradiction.
so that Adv