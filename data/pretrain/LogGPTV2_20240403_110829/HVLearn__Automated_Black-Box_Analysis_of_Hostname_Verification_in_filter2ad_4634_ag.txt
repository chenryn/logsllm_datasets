(e.g., DNS, IPv4, and email). The library does not include
support for IPv6 yet. MatrixSSL also provides a separate
function, psX509ValidateGeneralName that should be
used before calling matrixValidateCerts for name checking for
ﬁltering out invalid input.
JSSE (Java Secure Socket Extension). SunJSSE [58],
as part of the JSSE release, has internal built-in hostname
checking support (sun.security.util.HostnameChecker [42]). It
supports domain name, IPv4, and IPv6 veriﬁcation through the
HostnameChecker.match interface.
CPython SSL. CPython is the oldest and one of the
most popular Python VM implementation. CPython’s inbuilt
SSL support depends on the OpenSSL library, but does
not use OpenSSL’s hostname veriﬁcation function. Instead,
it
includes its own hostname veriﬁcation implementation,
match_hostname function. Currently, it only supports do-
main name and IP address veriﬁcation but does not support
email veriﬁcation.
IPv4,
IPv6,
HttpClient.
supports
(Apache HttpClient)
is used extensively
such as Apache Axis 2
in Web-services middleware
and domain name veriﬁca-
It
tion [32]. By default
the library provides a verify func-
tion in DefaultHostnameVerifier to perform the
identity veriﬁcation. The veriﬁer can also be used with
PublicSuffixMatcher object
to perform additional
checks.
cURL. By default, it uses OpenSSL [7] but implements
its own hostname veriﬁcation function verifyhost that
supports domain name, IPv4, and IPv6 veriﬁcation.
B. Developer Responses
the
We
notiﬁed
developers
each
affected
library/application for all of our ﬁndings,
including RFC
violations and discrepancies.
In this section, we present
an overview of the developer responses for each different
library/application.
of
GnuTLS. The GnuTLS team is currently working on a
patch to ﬁx the issue of seeking a match in the CN when
an IP address identiﬁer is in the subjectAltName [1]. The
developers also plan to provide a way to specify the identiﬁer
type in order to avoid the confusion between hostnames and
IP addresses [2]. Additionally, the team plans to remove a
fallback option which matches an IP address with a subjectAlt-
Name DNS [9], thus resolving the potential attack presented
in Section VI-C [3]. Finally, GnuTLS has recently introduced
IDNA2008 support in version 3.5.9 and performs extensive
checks to verify the format of the DNS names stored in the
certiﬁcate.
MbedTLS. We are currently discussing the discovered
issues with the MbedTLS team.
MatrixSSL. MatrixSSL is prioritizing the ﬁxes for the RFC
violations, including the incorrect order of checking between
subject CN and subjectAltName identiﬁer (violation of RFC
6125) and matching the local-part of an email address in a
case-insensitive manner (violation of RFC 5280). These ﬁxes
are deployed in their new version 3.9.0 [4]. This version also
addresses other discrepancies we reported by providing an
optional ﬂag for hostname input validation, and providing
parameters for users in order to specify the type of the
identiﬁer (e.g., DNS, IP ADDR) in order to address the attack
discussed in Section VI-C.
JSSE. The JSSE team does not consider RFC 6125 com-
pliance to be a feature of the current version of the library.
However, the team informed us that they are currently working
on plans to add compliance with RFC 6125 in the next versions
of the library.
CPython SSL. CPython plans to deprecate their hostname
veriﬁcation implementation and directly use OpenSSL’s im-
plementation in the next release.
OpenSSL. The OpenSSL team decides not to address the
issue of matching a partial hostname sufﬁx of a subject
CN/subjectAltName, as this discrepancy is not an RFC viola-
tion. For the other discrepancies e.g., matching a wildcard in
a public sufﬁx or matching an invalid hostname, the OpenSSL
team believes that they should be handled at the application
level or by certiﬁcate authorities and therefore, they should
not be ﬁxed in the library itself.
HttpClient. The HttpClient team has addressed the viola-
tions of matching a subject CN in case sensitive manner (viola-
tion of RFC 6125 and RFC 5280) and attempting to match sub-
ject CN when a subjectAltName is present (violation of RFC
6125). These issues are resolved in version 4.5.3, which is cur-
rently an alpha release [5]. The HttpClient team decided not to
address the other reported issues as they are handled correctly
if the application calls the DefaultHostnameVerifier
with the PublicSuffixMatcher in the veriﬁer construc-
tor.
C. Detailed list of discrepancies
In Table VIII, we present a detailed list of the discrepancies
discovered between various SSL/TLS libraries and applica-
tions.
537
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:20:25 UTC from IEEE Xplore.  Restrictions apply. 
SAMPLE STRINGS ACCEPTED BY THE AUTOMATA INFERRED FROM DIFFERENT HOSTNAME VERIFICATION IMPLEMENTATIONS
TABLE VIII
Test Certiﬁcate Identiﬁer Template OpenSSL
Wildcard in Certiﬁcate
GnuTLS
MbedTLS
MatrixSSL
JSSE
CPython SSL HttpClient
cURL
*.aaa.aaa
aaa.*.aaa
a*.aaa.aaa
aaa.a*.aaa
xn--aaa*.aaa
*.xn--aaa.aaa
xn--aaa.*.aaa
Wildcard Unclear Practices
*.aaa
a*b*c*.aaa.aaa
*.*.aaa.aaa
*b.aaa.aaa
.aaa.aaa
Email Address
SAN email: *@aaa.aaa
SAN email: aaa@*
SAN email: aaa@*.aaa
SAN email: aaa@aaa.*
SAN email: PI:EMAIL
SAN email: PI:EMAIL
IP Address
SAN IP Addr: *.111.111.111
a.aaa.aaa
.aaa.aaa
*.aaa.aaa
.aaa
a.aaa.aaa\0
.aaa.aaa\0
.aaa\0
*.aaa.aaa\0
aaa.*.aaa
.aaa
.*.aaa
aaa.*.aaa\0
.aaa\0
.*.aaa\0
aa.aaa.aaa
a.aaa.aaa
a*.aaa.aaa
.aaa.aaa
.aaa
aa.aaa.aaa\0
a.aaa.aaa\0
a*.aaa.aaa\0
.aaa.aaa\0
.aaa\0
aaa.a*.aaa
.aaa
.a*.aaa
aaa.a*.aaa\0
.aaa\0
.a*.aaa\0
.aaa
.aaa\0
a.xn--aaa.aaa
.aaa
.xn--aaa.aaa
*.xn--aaa.aaa
a.xn--aaa.aaa\0
.aaa\0
.xn--aaa.aaa\0
*.xn--aaa.aaa\0
.aaa
.*.aaa
xn--aaa.*.aaa
.aaa\0
.*.aaa\0
xn--aaa.*.aaa\0
.aaa
*.aaa
.aaa\0
*.aaa\0
a*b*c*.aaa.aaa
.aaa.aaa
.aaa
a*b*c*.aaa.aaa\0
.aaa.aaa\0
.aaa\0
.aaa.aaa
.*.aaa.aaa
*.*.aaa.aaa
.aaa
.aaa.aaa\0
.aaa\0
.*.aaa.aaa\0
*.*.aaa.aaa\0
ab.aaa.aaa
b.aaa.aaa
.aaa.aaa
*b.aaa.aaa
.aaa
ab.aaa.aaa\0
b.aaa.aaa\0
.aaa.aaa\0
.aaa\0
*b.aaa.aaa\0
.aaa.aaa
.aaa
.aaa.aaa\0
.aaa\0
*@aaa.aaa
*@aaa.aaa\0
aaa@*
aaa@*\0
aaa@*.aaa
aaa@*.aaa\0
aaa@aaa.*
aaa@aaa.*\0
PI:EMAIL
PI:EMAIL\0
PI:EMAIL
PI:EMAIL\0
.aaa.aaa
.aaa.aaa\0
a.aaa.aaa
a.aaa.aaa\0
a.aaa.aaa
a.aaa.aaa\0
a.aaa.aaa
a.aaa.aaa
.aaa.aaa
aaa.*.aaa
aaa.*.aaa\0
aaa.*.aaa
aaa.*.aaa\0
none
aaa.a.aaa
aaa.*.aaa
aaa..aaa
a*.aaa.aaa
a*.aaa.aaa\0
a*.aaa.aaa
a*.aaa.aaa\0
none
a.aaa.aaa
a.aaa.aaa
a.aaa.aaa
aaa.a*.aaa
aaa.a*.aaa\0
aaa.a*.aaa
aaa.a*.aaa\0
none
aaa.a.aaa
aaa.a*.aaa
aaa.a.aaa
xn--aaa*.aaa
xn--aaa*.aaa\0
xn--aaa*.aaa
xn--aaa*.aaa\0
none
xn--aaa.aaa
xn--aaa*.aaa xn--aaa.aaa
.xn--aaa.aaa
.xn--aaa.aaa\0
.xn--aaa.aaa
.xn--aaa.aaa\0
none
a.xn--aaa.aaa a.xn--aaa.aaa .xn--aaa.aaa
xn--aaa.*.aaa
xn--aaa.*.aaa\0
xn--aaa.*.aaa
xn--aaa.*.aaa\0 none
xn--aaa.a.aaa xn--aaa.*.aaa xn--aaa..aaa
none
a.aaa
a.aaa\0
a.aaa
a.aaa\0
a.aaa
a.aaa
.aaa
a*b*c*.aaa.aaa
a*b*c*.aaa.aaa\0
a*b*c*.aaa.aaa
a*b*c*.aaa.aaa\0 none
abc.aaa.aaa
none
ab*c*.aaa.aaa
.*.aaa.aaa
.*.aaa.aaa\0
a.*.aaa.aaa
a.*.aaa.aaa\0
none
a.a.aaa.aaa
a.*.aaa.aaa
.*.aaa.aaa
b.aaa.aaa
b.aaa.aaa\0
*b.aaa.aaa
*b.aaa.aaa\0
none
ab.aaa.aaa
b.aaa.aaa
b.aaa.aaa
b.aaa.aaa
none
.aaa.aaa
.aaa.aaa\0
none
aaa.aaa
.aaa.aaa
.aaa.aaa
a.aaa.aaa
a.aaa.aaa.\0
a.aaa.aaa\0
a.aaa.aaa.
aaa.*.aaa
aaa.*.aaa.\0
aaa.*.aaa\0
aaa.*.aaa.
aa.aaa.aaa
aa.aaa.aaa.\0
aa.aaa.aaa\0
aa.aaa.aaa.
aaa.a*.aaa
aaa.a*.aaa.\0
aaa.a*.aaa\0
aaa.a*.aaa.
xn--aaa*.aaa
xn--aaa*.aaa.\0
xn--aaa*.aaa\0
xn--aaa*.aaa.
a.xn--aaa.aaa
a.xn--aaa.aaa.\0
a.xn--aaa.aaa\0
a.xn--aaa.aaa.
xn--aaa.*.aaa
xn--aaa.*.aaa.\0
xn--aaa.*.aaa\0
xn--aaa.*.aaa.
*.aaa
*.aaa.\0
*.aaa\0
*.aaa.
aab*c*.aaa.aaa
aab*c*.aaa.aaa.\0
aab*c*.aaa.aaa\0
aab*c*.aaa.aaa.
a.*.aaa.aaa
a.*.aaa.aaa.\0
a.*.aaa.aaa\0
a.*.aaa.aaa.
ab.aaa.aaa
ab.aaa.aaa.\0
ab.aaa.aaa\0
ab.aaa.aaa.
.aaa.aaa
.aaa.aaa.\0
.aaa.aaa\0
.aaa.aaa.
–
–
–
*@aaa.aaa
*@aaa.aaa\0
aaa@*
aaa@*\0
aaa@*.aaa
aaa@*.aaa\0
aaa@aaa.*
aaa@aaa.*\0
–
PI:EMAIL
PI:EMAIL\0 –
PI:EMAIL
PI:EMAIL\0
–
none
none
none
–
–
–
none
–
PI:EMAIL
PI:EMAIL\0 –
PI:EMAIL
PI:EMAIL\0 –
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
none
none
–
none
none
none
none
none
538
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:20:25 UTC from IEEE Xplore.  Restrictions apply.