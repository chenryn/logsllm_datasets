由电脑鉴识看帐号
由电脑鉴识看帐号/密码的窃取
密码的窃取
2009/July
2009/July
讲师
讲师:鉴真数位
鉴真数位 黄敬博
黄敬博
PI:EMAIL
PI:EMAIL
(EnCE/CCE/CIFI/CHFI/CEH/CISSP)
(EnCE/CCE/CIFI/CHFI/CEH/CISSP)
PDF created with pdfFactory Pro trial version www.pdffactory.com
简报大网
简报大网
帐号密码遭窃的严重性
不可知的残留
帐号/密码存在的位置及方式
破密的逻辑
常用的窃取手法
问题与讨论
PDF created with pdfFactory Pro trial version www.pdffactory.com
国内趋势
国内趋势
• 根据内政部警政署的统计资料显示
根据内政部警政署的统计资料显示
去年
去年(97
(97年)妨害电脑使用案，犯罪方式第一名为
妨害电脑使用案，犯罪方式第一名为
无故取得、删除或变更他人电脑或电磁纪录
无故取得、删除或变更他人电脑或电磁纪录
(56.47%)
(56.47%)
PDF created with pdfFactory Pro trial version www.pdffactory.com
案例说明
案例说明
• Yahoo 
Yahoo 帐号失窃案例
帐号失窃案例
– 网路犯罪最爱偷的帐号
网路犯罪最爱偷的帐号
若是Gmail 遭窃 ?
PDF created with pdfFactory Pro trial version www.pdffactory.com
有组织的犯罪结构
有组织的犯罪结构
• 中国骇客黑色产业链
中国骇客黑色产业链:2.38
:2.38亿年产值带来
亿年产值带来76
76
亿损失
亿损失
– 僵尸电脑租借
僵尸电脑租借
– 帐号
帐号/密码
密码 (其中每天有超过上万人次填写申诉
其中每天有超过上万人次填写申诉
资料，反映
资料，反映QQ
QQ密码被盗
密码被盗)
PDF created with pdfFactory Pro trial version www.pdffactory.com
简报大网
简报大网
帐号密码遭窃的严重性
不可知的残留
帐号/密码存在的位置及方式
窃取的手法
破密的逻辑
问题与讨论
PDF created with pdfFactory Pro trial version www.pdffactory.com
不可知的残留
不可知的残留
• 根据加州柏克莱大学的研究，目前公司中
根据加州柏克莱大学的研究，目前公司中
有超过
有超过93%
93%的资讯产出是以数位格式分散贮
的资讯产出是以数位格式分散贮
存在各个系统中，同时相同的研究也指出
存在各个系统中，同时相同的研究也指出
在所有的资讯犯罪、侵权案例中，有超过
在所有的资讯犯罪、侵权案例中，有超过
85%
85%的案例均会留下数位遗趾。
的案例均会留下数位遗趾。 (Foot print) 
(Foot print) 
Ł 示范
示范
PDF created with pdfFactory Pro trial version www.pdffactory.com
硬碟
硬碟Unallocate
Unallocate区的残留
区的残留
• File Slack
File Slack
• Unallocated cluster
Unallocated cluster
• Hardisk Unallocated area
Hardisk Unallocated area
PDF created with pdfFactory Pro trial version www.pdffactory.com
虚拟记忆体的残留
虚拟记忆体的残留
• Pagefile.sys
Pagefile.sys
为Windows
Windows平台中的虚拟记忆体
平台中的虚拟记忆体,程式执行中
程式执行中
的资讯很多会残留在此部份
的资讯很多会残留在此部份,且可能以明文
且可能以明文
的方式显示
的方式显示
– 帐号
帐号/密码
密码
– Instant Message 
Instant Message 聊天的内容
聊天的内容
PDF created with pdfFactory Pro trial version www.pdffactory.com
Windows 
Windows 休眠
休眠
• Hibernate.sys 
Hibernate.sys 及 Hiberfil.sys
Hiberfil.sys
为Windows
Windows平台中休眠时，将记忆体中的资
平台中休眠时，将记忆体中的资
讯贮存档案名称，可于停止休眠时迅速回
讯贮存档案名称，可于停止休眠时迅速回
复系统原始运行的状态
复系统原始运行的状态
PDF created with pdfFactory Pro trial version www.pdffactory.com
Memory Dump
Memory Dump
• 作业系统中所有正在执行的程式及保留的
作业系统中所有正在执行的程式及保留的
输入资料存在许多有用的资讯
输入资料存在许多有用的资讯
• 使用记忆体倾印工具可将记忆体资料完整
使用记忆体倾印工具可将记忆体资料完整
保留为一个映像档
保留为一个映像档
PDF created with pdfFactory Pro trial version www.pdffactory.com
记忆体残留的密码分析
记忆体残留的密码分析
• Strings 
Strings 将ASCI
ASCI字串取出
字串取出
– 采用支援
采用支援Uni
Uni--code
code的Strings
Strings
– 输出档案输入编辑器搜寻
输出档案输入编辑器搜寻(Ex: UltraEdit)
(Ex: UltraEdit)
• 使用商业软体进行检视及搜寻
使用商业软体进行检视及搜寻
– Encase / FTK / X
Encase / FTK / X--Ways Forensics
Ways Forensics
PDF created with pdfFactory Pro trial version www.pdffactory.com
简报大网
简报大网
帐号密码遭窃的严重性
不可知的残留
帐号/密码存在的位置及方式
破密的逻辑
常用的窃取手法
问题与讨论
PDF created with pdfFactory Pro trial version www.pdffactory.com
帐号
帐号/密码存在的形式
密码存在的形式
• 贮存在档案中
贮存在档案中
• 贮存在
贮存在Registry
Registry中
• 贮存在
贮存在Cookie
Cookie中
• 贮存在
贮存在Data Base
Data Base中
• 贮存在
贮存在Token Card/iKey
Token Card/iKey
PDF created with pdfFactory Pro trial version www.pdffactory.com
MSN
MSN的帐号
的帐号/密码
密码
• MSN version 8.x/9.x
MSN version 8.x/9.x 的密码
的密码:
The passwords are stored in the Credentials 
The passwords are stored in the Credentials 
file, with entry name begins with 
file, with entry name begins with 
“WindowsLive:name=“
“WindowsLive:name=“
• MSN version 7.x/6.x
MSN version 7.x/6.x 的密码
的密码:
则贮存在
则贮存在Registry 
Registry 机码中
机码中
V7.0:  HKEY_CURRENT_USER
V7.0:  HKEY_CURRENT_USER\Software
Software\\Microsoft
Microsoft\IdentityCRL
IdentityCRL\\Creds
Creds\[Account Name] 
[Account Name] 
V6.0: HKEY_CURRENT_USER
V6.0: HKEY_CURRENT_USER\\Software
Software\\Microsoft
Microsoft\\MSNMessenger or Microsoft
MSNMessenger or Microsoft\\MessengerService 
MessengerService 
PDF created with pdfFactory Pro trial version www.pdffactory.com
Yahoo messenger 
Yahoo messenger 及Google talk
Google talk的
帐号
帐号/密码
密码
• Yahoo messenger 
Yahoo messenger 最新版为
最新版为 Ver 9.x:
Ver 9.x:
历来
历来8/7/6
8/7/6的版本密码主要均贮存于机码中
的版本密码主要均贮存于机码中
HKEY_CURRENT_USER
HKEY_CURRENT_USER\Software
Software\Yahoo
Yahoo\\Pager
Pager
• Google talk 
Google talk 最新版为
最新版为 Ver 1.0.x:
Ver 1.0.x:
密码主要均贮存于机码中
密码主要均贮存于机码中
HKEY_CURRENT_USER
HKEY_CURRENT_USER\\Software
Software\Google
Google\Google 
Google 
Talk
Talk\Accounts
Accounts\[Account Name]
[Account Name]
PDF created with pdfFactory Pro trial version www.pdffactory.com
Outlook/Outlook express 
Outlook/Outlook express 帐号
帐号/密码
密码
Outlook
Outlook
• Outlook 2002
Outlook 2002--2008 
2008 帐号密码贮存在同一个
帐号密码贮存在同一个
Registry Key
Registry Key中
• 但是若经由
但是若经由AD
AD认证去取
认证去取Exchange 
Exchange 伺服器的信
伺服器的信
件则帐号
件则帐号/密码则存在于
密码则存在于Credential file
Credential file中
Outlook Express
Outlook Express
• 密码贮存
密码贮存Protected Storage
Protected Storage
•
Protected Storage information is saved in a special location in the Registry. 
Protected Storage information is saved in a special location in the Registry. 
PDF created with pdfFactory Pro trial version www.pdffactory.com
IE Auto
IE Auto--complete 
complete 的帐号
的帐号/密码
密码
• 新版
新版IE V7
IE V7及V8 
V8 贮存密码于两个地方
贮存密码于两个地方
• AutoComplete passwords are stored in the 
AutoComplete passwords are stored in the 
Registry under 