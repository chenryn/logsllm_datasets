否使能？
Trap Trapbuffer3 Trap缓冲区
否
Logbuffer 4 Log缓冲区
状态为active的告警
告警 SNMP agent5 SNMP代理
日志
Logfile 9 日志文件
日志信息
Trap信息
Alarm信息
告警通过不同的形式输出，信息格式也是不一样的。
– Alarm
Alarm信息输出到远程终端或控制台。
#265/active/mplsLdpSessionDown/Critical/occurredTime:2015-08-07 12:44:01/-/-/alarmID:
0x09020000/CID=0x801c043c:
The LDP session status is Down. (PeerLsrId=19.19.19.19:0, VrfName=_public_,
SessionType=Local, IfName=10GE1/0/22, SubReason=0,
Reason=The LDP Keepalive timer expired.)
文档版本 06 (2017-09-12) 华为专有和保密信息 6
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 3 Trap简介
图3-3 Alarm格式
#Seq/state/alarmName/Severity/occurredTime/-/-/alarmID/CID=Z:Desc
1 2 3 4 5 6 7 8
序 告 告 告 告 告 组 详
列 警 警 警 警 警 件 细
号 状 名 级 产 ID ID 信
态 称 别 生 息
时
间
Alarm信息会通过Monitor或Console通道在终端屏幕打印，屏幕上打印的Alarm
信息格式与Logbuffer中记录的告警日志、Trapbuffer中记录的告警Trap格式不
一样，但是信息内容是一样的。
说明
Alarm ID唯一标识一条Alarm，建议您通过Alarm ID在手册中搜索，从而快速查找到对
应告警的解释和处理步骤。
– 告警Trap
告警Trap信息输出到Trap缓冲区。
Aug 17 2015 12:44:01 HUAWEI %%01LDP/1/Session-Down-MIB(t):CID=0x801c043c-
OID=1.3.6.1.2.1.10.166.4.0.4;
The LDP session status is Down. (PeerLsrId=19.19.19.19:0, VrfName=_public_,
SessionType=Local, IfName=10GE1/0/22, SubReason=0,
Reason=The LDP Keepalive timer expired.)
图3-4 告警Trap格式
Time Host %%ddModule/Severity/Brief(t):CID=Z-OID=F; Des
1 2 3 4 5 6 7 8 9 10 11
时 主 华 版 模 Trap 信 Trap 组 Trap 详
间 机 为 本 块 级 息 标 件 OID 细
戳 名 标 号 名 别 摘 识 ID 信
识 要 息
告警Trap也会通过Monitor或Console通道在终端屏幕打印，屏幕上打印的信息
格式与Trapbuffer中记录的告警Trap格式一样。
该手册主要介绍Trapbuffer中记录的Trap，详细信息请见3.2 发往Trap显示区的
Trap信息。
– 告警日志
告警日志信息输出到日志缓冲区。
Aug 17 2015 12:44:01 HUAWEI %%01LDP/1/mplsLdpSessionDown_active(l):CID=0x801c043c-
alarmID=0x09020000;
The LDP session status is Down. (PeerLsrId=19.19.19.19:0, VrfName=_public_,
SessionType=Local, IfName=10GE1/0/22, SubReason=0,
Reason=The LDP Keepalive timer expired.)
图3-5 告警日志格式
Time Host %%ddModule/Severity/Brief(l):CID=Z-alarmID=F;Desc
1 2 3 4 5 6 7 8 9 10 11
时 主 华 版 模 日 信 日 组 告 详
间 机 为 本 块 志 息 志 件 警 细
戳 名 标 号 名 级 摘 标 ID ID 信
识 别 要 识 息
文档版本 06 (2017-09-12) 华为专有和保密信息 7
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 3 Trap简介
告警日志也会通过Monitor或Console通道在终端屏幕打印，屏幕上打印的信息
格式与Logbuffer中记录的告警日志格式一样。
日志缓冲区中记录的日志，可通过信息摘要在《日志参考》手册中搜索。
l 事件
说明
所有事件都是以日志形式记录，只有发送Trap的事件，才会触发事件Trap。
– 发送Trap的事件
图3-6 发送Trap的事件输入与输出原理图
信息类型 信息通道 输出方向
Console 0 控制台
无动作
Monitor 1 远程终端
发送Trap的 否 Loghost 22 日志主机
事件
Trap是 是 事件 Trapbuffer 3 Trap缓冲区
否使能？
Trap Logbuffer 4 Log缓冲区
SNMP agent5 SNMP代理
Logfile 9 日志文件
Trap信息
发送Trap的事件以事件Trap形式保存，通过不同的信息通道输出，信息格式也
是一样的（除SNMP代理），信息格式如图3-7所示。
图3-7 事件Trap格式
Time Host %%ddModule/Severity/Brief(t):CID=Z-OID=F; Des
1 2 3 4 5 6 7 8 9 10 11
时 主 华 版 模 Trap 信Trap 组 Trap 详
间 机 为 本 块 级 息 标 件 OID 细
戳 名 标 号 名 别 摘 识 ID 信
识 要 息
以屏幕打印事件Trap为例：
Aug 17 2015 21:27:58 HUAWEI %%01MSTP/4/hwMstpProRootChanged(t):CID=0x8054042c-
OID=1.3.6.1.4.1.2011.5.25.42.4.2.17;
The root bridge of MSTP process changed. (ProcessID=0,InstanceID=0, PortID=2)
该手册主要介绍Trapbuffer中记录的Trap，详细信息请见3.2 发往Trap显示区的
Trap信息。
– 不发送Trap的事件
文档版本 06 (2017-09-12) 华为专有和保密信息 8
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 3 Trap简介
图3-8 不发送Trap的事件输入与输出原理图
信息类型 信息通道 输出方向
Console 0 控制台
不发送Trap Monitor 1 远程终端
的事件
Loghost 22 日志主机
事件
日志
Trapbuffer 3 Trap缓冲区
Logbuffer 4 Log缓冲区
SNMP agent5 SNMP代理
Logfile 9 日志文件
日志信息
不发送Trap的事件以事件日志形式保存，信息格式如图3-9所示。
图3-9 事件日志格式
Time Host %%ddModule/Severity/Brief(l):CID=Z;Desc
1 2 3 4 5 6 7 8 9 10
时 主 华 版 模 日 信 日 组 详
间 机 为 本 块 志 息 志 件 细
戳 名 标 号 名 级 摘 标 ID 信
识 别 要 识 息
终端屏幕、日志主机、日志文件以及Log缓冲区中体现的日志格式是一样的。
以终端屏幕显示为例：
Aug 17 2015 21:16:38 HUAWEI %%01OSPF/3/NBR_DOWN_REASON(l):CID=0x80830436;Neighbor state
left full or changed to Down.
(ProcessId=65534, NeighborRouterId=128.254.255.252, NeighborIp=128.254.255.252,
NeighborAreaId=0.0.0.0,NeighborInterface=-,NeighborDownImmediate
reason=Neighbor Down Due to Kill Neighbor, NeighborDownPrimeReason=Link Fault or
Interface Configuration Change,CpuUsage=0%)
日志缓冲区中记录的日志，可通过信息摘要在《日志参考》手册中搜索。
3.2 发往 Trap 显示区的 Trap 信息
Trap在命令行终端界面上的输出格式如下：
Aug 17 2015 12:44:01 HUAWEI %%01LDP/1/Session-Down-MIB(t):CID=0x801c043c-
OID=1.3.6.1.2.1.10.166.4.0.4;
The LDP session status is Down. (PeerLsrId=19.19.19.19:0, VrfName=_public_, SessionType=Local,
IfName=10GE1/0/22, SubReason=0,
Reason=The LDP Keepalive timer expired.)
发往Trap显示区的Trap信息格式如图3-10所示。
文档版本 06 (2017-09-12) 华为专有和保密信息 9
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 3 Trap简介
图3-10 Trap信息输出格式
Time Host %%ddModule/Severity/Brief(t):CID=Z-OID=F; Des
1 2 3 4 5 6 7 8 9 10 11
时 主 华 版 模 Trap 信Trap 组 Trap 详
间 机 为 本 块 级 息 标 件 OID 细
戳 名 标 号 名 别 摘 识 ID 信
识 要 息
字段 字段含义 说明
Time 时间戳，信息输出 时间戳有如下格式可供选择：
的时间
l boot型：指定时间戳采用相对时间类型，
即系统启动后经过的时间。格式是
xxxxxx.yyyyyy，xxxxxx为系统启动后经过
时间的毫秒数高32位，yyyyyy为低32位。
l date型：指定时间戳采用系统当前日期和时
间。中文环境下为yyyy/mm/dd hh:mm:ss；
英文环境下为mm dd yyyy hh:mm:ss。
l short-date型：指定时间戳采用短日期格
式。这种格式的时间戳与date类型的时间戳
基本相同，唯一区别是短日期格式取消了
年份的显示。
l format-date型：按照年、月、日、时、分、
秒的格式显示：YYYY-MM-DD
hh:mm:ss。
时间戳与主机名之间用一个空格隔开。系统支
持配置信息输出的时间格式。
Host 主机名 缺省是“HUAWEI”。
%% 华为公司的标识 标识该Trap是由华为公司的产品输出的。
dd 版本号 用来标识该Trap格式的版本。
Module 模块名 输出信息的模块名称。
文档版本 06 (2017-09-12) 华为专有和保密信息 10
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 3 Trap简介
字段 字段含义 说明
Severity Trap的级别 表示Trap的级别。
Trap级别用于标识一条Trap的严重程度，按严
重或紧急程度分为8级，信息越严重，其严重
等级越小。
l 0：严重等级为Emergency。
设备致命的异常，系统已经无法恢复正
常，必须重启设备，如程序异常导致设备
重启，内存的使用被检测出错误等。
l 1：严重等级为Alert。
设备重大的异常，需要立即采取措施，如
设备内存占用率达到极限等。
l 2：严重等级为Critical。
设备重大的异常，需要采取措施进行处理
或原因分析，如设备内存占用率超过低界
线，温度超过低温Trap线，BFD探测出设
备不可达，检测出错误的信息（信息是由
本设备内部生成）等。
l 3：严重等级为Error。
错误的操作或设备的异常流程，需要关注
和原因分析，如用户的错误指令，用户密
码错误，检测出错误协议报文（报文是由
其他设备获得）。
l 4：严重等级为Warning。
设备异常运转的异常点，需要引起注意，
如用户对关闭路由进程，BFD探测的一次
报文丢失，检测出错误协议报文等。
l 5：严重等级为Notice。
用于设备正常运转的关键操作信息，如用
户对接口的shutdown命令，邻居发现，协
议状态机的正常跳转等。
l 6：严重等级为Informational。
用于设备正常运转的一般性操作信息，如
用户使用display命令等。
l 7：严重等级为Debugging。
设备正常运转的一般性信息，用户无需关
注。
Brief 信息摘要 用来说明信息的摘要。
(t) 信息类别 用来标识该信息为Trap。
CID=Z 组件ID 用来标识系统内部组件的ID。
OID=F Trap OID 用来标识告警OID，MIB文件中定义的对象标
识。
文档版本 06 (2017-09-12) 华为专有和保密信息 11
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 3 Trap简介
字段 字段含义 说明
Des 详细信息 各个模块输出的信息的具体内容。由各个模块
在每次输出时填充，详细描述该Trap的具体内
容。
3.3 Trap 手册内容简介
Trap Buffer 信息解释
包括两个部分：Trap信息和Trap含义。
l Trap信息：在设备上显示的Trap信息字符串。
l Trap含义：指明该Trap表示什么意思。
Trap 属性
Trap属性简介如表3-2所示。
表3-2 Trap属性
Trap属性 描述
Alarm or Event Trap类型：
l Alarm：告警
l Event：事件
Trap Severity 该Trap对应故障对业务的影响程度。
Mnemonic Trap内容的摘要，便于记忆。
Code
Trap OID MIB文件中定义的对象标识。
Alarm ID 网络管理系统NMS（Network Management System）定义的对象标
识。
文档版本 06 (2017-09-12) 华为专有和保密信息 12
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 3 Trap简介
Trap属性 描述
Alarm Type 表示该告警的性质。
l communicationsAlarm：通讯告警
这类告警与信息传送的处理进程有关，包括网元之间、网元与
OS之间或者OS之间的通信失败时产生的相关告警。
l qualityOfServiceAlarm：业务质量告警
这类告警是由于业务质量退化问题而引起的，包括发生拥塞、
性能下降、资源占用率高、带宽减小等业务质量降低时产生的
告警。
l processingErrorAlarm：处理出错告警