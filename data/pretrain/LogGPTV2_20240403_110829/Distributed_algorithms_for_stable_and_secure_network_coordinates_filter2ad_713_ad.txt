5000
6000
0.4
0.2
0
0
1000
2000
4000
Simulation time(s)
3000
5000
6000
(a)
(b)
s
e
d
o
n
s
u
o
c
i
i
l
a
m
f
o
n
o
i
t
c
a
r
F
s
e
d
o
n
s
u
o
c
i
i
l
a
m
f
o
n
o
i
t
c
a
r
F
e
c
n
a
m
r
o
f
r
e
p
n
o
i
t
c
e
t
e
D
s
e
d
o
n
s
u
o
c
i
i
l
a
m
f
o
n
o
i
t
c
a
r
F
1
0.5
False negative
False positive
0
0
500
1000
2000
Simulation time(s)
1500
2500
3000
0.6
0.4
0.2
0
0
500
1000
2000
Simulation time(s)
1500
2500
3000
(c)
Figure 8: Detection performance for delay attack (a) Spatial outlier detection (b) Temporal outlier detection (c) Kalman ﬁlter detec-
tion
tial outlier detection and temporal outlier detection. In spatial out-
lier detection, only the most recent neighbor observations are used
to compute the centroid; while in temporal outlier detection, all the
previous observations are used to compute the centroid.
4.3.2 Malicious Attacks
In a network coordinates system, a malicious node can lie about
its coordinates and delays to other nodes. It can generate faked co-
ordinates in any arbitrary way. It can also inﬂate its delay to other
nodes. Since it is not possible to exhaust all attacks, we system-
atically design a set of attacks that stresses different aspects of the
system. The attack set includes six attacks: Shifting attack, Iso-
lation attack, Inﬂation attack, Deﬂation attack, Oscillation attack
and Delay attack. We evaluate the performance of existing statisti-
cal detection mechanisms on all these attacks. Due to space limit,
in this paper, we only discuss the most interesting results for two
simple attacks. A complete set of results is provided in a technical
report [34].
Shifting attack - In the shifting attack, a malicious node always
shifts its own coordinates by a random distance in a ﬁxed direction
and reports the shifted coordinates to other nodes. The shifting
attack can mimic the coordinates movement of normal nodes. In
our experiments, malicious nodes shift their coordinates by up to
300ms.
Delay attack - In the delay attack, malicious nodes focus on at-
tacking the delay measurement. A delay attacker randomly inﬂates
the delays to victims for up to 300 ms. The delay attackers compute
their coordinates honestly based on the inﬂated delays.
We apply these attacks to the Vivaldi system. Table 1 shows the
median absolute error of legitimate nodes’ coordinates with differ-
ent percents of malicious nodes. We can see that the simple attacks
can signiﬁcantly degrade the accuracy of network coordinates.
We set up simulation experiments to study the behavior of the
Kalman ﬁlter and the outlier detection mechanisms. Each node
randomly selects 32 neighbors and uses a 5D Euclidean space to
compute coordinates. We always inject 30% of malicious nodes
into the system. 30% may seem to be a large fraction, but a suc-
cessful solution must be able to tolerate a large-scale attack. For the
outlier detection mechanisms, we use the recommended detection
thresholds, which are 1.5 for spatial outlier detection, and 4.0 for
temporal outlier detection. For the Kalman ﬁlter detection mech-
anism, the detection threshold is computed by the Kalman ﬁlter
parameters, which is different for different nodes. In the Kalman
ﬁlter experiments, we randomly select 8% of the nodes as survey-
ors, which is recommended in [10]. To monitor the evolution of
the statistical detection procedure, we set up an observation pool
that always records the results of the most recent 10000 detections.
From this observation pool, we can monitor the dynamic evolution
of false negative, false positive rate and the fraction of malicious
nodes in neighbor set.
4.3.3 Experimental results
Figure 7 shows the performance of all the detection mechanisms
on shifting attack. In these ﬁgures, the top graph plots the evolu-
tion of false negative and false positive rates, and the bottom graph
shows how the fraction of malicious nodes in neighbor sets changes
during the experiment. From these graphs, we can see that none of
the statistical detection mechanisms can effectively detect shifting
attackers. To understand the reason for these results, Figure 9 plots
the metric distributions of all the detection mechanisms on good
nodes and shifting attackers. We can make two interesting obser-
vations.
First, since the Mahalanobis distance metric in outlier detection
is extracted from the network coordinates that are being attacked,
n
o
i
t
c
n
u
F
y
t
i
s
n
e
D
y
t
i
l
i
b
a
b
o
r
P
n
o
i
t
c
n
u
F
y
t
i
s
n
e
D
y
t
i
l
i
b
a
b
o
r
P
0.14
0.12
0.1
0.08
0.06
0.04
0.02
0
0
0.016
0.014
0.012
0.01
0.008
0.006
0.004
0.002
0
0
Good nodes
Malicious nodes
n
o
i
t
c
n
u
F
y
t
i
s
n
e
D
y
t
i
l
i
b
a
b
o
r
P
2
4
6
8
Mahalanobis distance for spatial outlier detection
(a)
Good nodes
Malicious nodes
10
20
30
40
Mahalanobis distance for spatial outlier detection
10
50
n
o
i
t
c
n
u
F
y
t
i
s
n
e
D
y
t
i
l
i
b
a
b
o
r
P
0.06
0.05
0.04
0.03
0.02
0.01
0
0
0.016
0.014
0.012
0.01
0.008
0.006
0.004
0.002
0
0
Good nodes
Malicious nodes
Good nodes
Malicious nodes
0.08
0.07
0.06
0.05
0.04
0.03
0.02
0.01
n
o
i
t
c
n
u
F
y
t
i
s
n
e
D
y
t
i
l
i
b
a
b
o
r
P
2
4
6
8
Mahalanobis distance for temporal outlier detection
(b)
Good nodes
Malicious nodes
5
10
15
Mahalanobis distance for temporal outlier detection
10
20
0
−10
−5
0
5
10
Kalman filter prediction error Minus Threshold
(c)
Good nodes
Malicious nodes
0.16
0.14
0.12
0.1
0.08
0.06
0.04
0.02
n
o
i
t
c
n
u
F
y
t
i
s
n
e
D
y
t
i
l
i
b
a
b
o
r
P
0
−10
−5
0
5
10
Kalman filter prediction error Minus Threshold
(d)
(e)
(f)
Figure 9: Metric distribution of detection mechanisms for shift attack (a) Spatial outlier detection at time 0 second (b) Temporal
outlier detection at time 0 second (c) Kalman ﬁlter detection at time 0 second (d) Spatial outlier detection at time 2000 second (e)
Temporal outlier detection at time 2000 second (f) Kalman ﬁlter detection at time 2000 second
when malicious nodes attack the system for a long time, the met-
ric distribution can be signiﬁcantly impacted. We can see from
Figure 9 (d) and (e) that, after the malicious nodes have attacked
the system for 2000 seconds, the Mahalanobis distance metric for
spatial outlier detection and temporal outlier detection are signiﬁ-
cantly shifted to very large values (note the x-axis scales are dif-
ferent). The shifting of metric distribution signiﬁcantly impacts
the performance of outlier detection. Since the outlier detection
mechanisms use ﬁxed threshold to detect malicious nodes, while
the Mahalanobis distances for good nodes and malicious nodes are
all shifted to large values, the false positive rate becomes larger
and larger. Finally, the outlier detection mechanisms become so
aggressive that they falsely identiﬁes most good nodes as mali-
cious and introduces more malicious nodes into nodes’ neighbor
set during neighbor replacement procedure. On the contrary, since
the Kalman ﬁlter detection mechanism uses an external reference
model learned from trusted nodes, the metric distribution is not dra-
matically impacted by malicious attacks.
Second, we can see from Figure 9 that, from the beginning of the