for periodicity, i.e., for the existence of a webmail server.
We believe that the basic idea behind our approach could in gen-
eral be used to distinguish between user- and machine-initiated traf-
ﬁc. Hence, a spectrum of other applications as well is likely to have
a characteristic ﬁngerprint related to ﬂow timing (in fact, our pre-
liminary results already hint to such a direction).
3254. EVALUATION
The results of the preceding Section 3 are promising in the sense
that it is apparently possible to discriminate between e-mail related
web trafﬁc and other HTTPS trafﬁc leveraging correlations across
protocols and time. In this section we explain how to build a classi-
ﬁer using our proposed features and present ﬁrst results. Our main
concern is not maximum accuracy. Rather we seek to demonstrate
the general feasibility and the potential of our approach in a proof
of concept study.
The general approach is as follows: We use the Support Vector
Machine (SVM) library provided by [4]. For classiﬁcation we rely
on the four features presented in the preceding Section 3, namely
service proximity, activity proﬁles, session duration, and periodic-
ity. These features are used to discriminate between the two classes
mail and non-mail. To estimate classiﬁcation accuracy, we rely on
5-fold cross-validation: we partition the set of hosts into ﬁve com-
plementary subsets of equal size. Four subsets are used as training
data, the remaining subset serves as validation data. We repeat this
process ﬁve times such that each of the ﬁve subsets is used exactly
once as validation data.
Based on the top500 data set, see Table 1, we classify webmail
hosts that are inside the SWITCH network.
classiﬁed as mail
classiﬁed as non mail
accuracy (mean)
Number of true HTTPS
mail servers
61
16
93.2% (±3)
non mail servers
16
382
Table 2: Classiﬁcation of internal HTTPS servers.
As shown in Table 2, our classiﬁcation realizes a remarkably
high mean accuracy of 93.2% (with standard deviation 3.0) across
the ﬁve runs of our 5-fold cross-validation. In addition, the pre-
cision for the mail class is also reasonably good at 79.2% relying
solely on ﬂow data and can be further improved by optimizing the
classiﬁer. By manually scrutinizing the results of the classiﬁcation,
we ﬁnd our classiﬁer can effectively discriminate between web-
mail and Skype nodes mainly due to the service proximity feature
of Section 3.1 and also between webmail and authentication ser-
vices mainly due to the session duration feature of Section 3.2.2.
However, it is challenging to distinguish between VPN and web-
mail servers, which is the main reason for false negatives when
classifying webmail hosts.
Popular webmail platforms such as GMail, Yahoo!, or Hotmail
do not maintain servers within the SWITCH network and, there-
fore, have been ignored in our discussion and analysis so far. Fi-
nally, we brieﬂy illustrate that applying our approach to uncover
arbitrary webmail applications is equally feasible, irrespective of
whether hosts are internal or external.
To this end, we extract additional data from our trace collected
in March 2010. Following the methodology outlined in Section 2,
we select 500 popular external HTTPS hosts/sockets. Manually la-
beling this data set reveals 32 GMail servers2. For 452 additional
HTTPS servers we established that they provide other non-mail ser-
vices such as online banking, update, Facebook login servers, etc.
We now merge the original top500 data set and the labeled
external hosts creating a new data set with 1000 HTTPS servers.
Based on our proposed features we build a classiﬁer and again ap-
ply 5-fold cross-validation.
classiﬁed as mail
classiﬁed as non mail
accuracy (mean)
Number of true HTTPS
mail servers
94
19
94.8% (±3)
non mail servers
30
820
Table 3: Classiﬁcation of internal and external HTTPS servers.
Table 3 shows that we are able to classify internal and external
HTTPS servers with overall accuracy of 94.8% ± 3 and precision
of 75.8% for the mail class. Although these results are preliminary,
it appears possible to detect mail servers outside the SWITCH net-
work using the same features, even though only a small sample of
the total trafﬁc of these servers is visible in our network. More-
over, our case study on GMail suggests that the techniques pro-
posed in this paper are not limited to speciﬁc applications (e.g.,
Outlook Web Access, Horde).
5. RELATED WORK
Though extensive research has focused on trafﬁc classiﬁcation3,
only a comparably tiny portion has studied methods for dissect-
ing WWW trafﬁc. Schneider et al. [29] extracted trafﬁc to four
popular Ajax-based sites from full packet traces and characterized
differences between Ajax and HTTP trafﬁc. Li et al. used man-
ually constructed payload signatures to classify HTTP trafﬁc into
14 applications and discussed trends from the early analysis [18]
of two datasets collected three years apart. Compared to previous
studies, our work focuses on extracting mail trafﬁc from WWW
traces and operates on ﬂows, solving a substantially more challeng-
ing problem than previous HTTP classiﬁcation studies, which used
full packet traces (e.g., [8]).
Some research has recently focused on the trafﬁc characteristics
of mail. Notably, Ramachandran et al. [26] characterized a number
of network properties of spammers and emphasized that spammers
can alter the content of spam to evade ﬁlters, whereas they cannot
easily change their network-level footprint. This work suggested
the plausibility of network-based spam ﬁltering and was followed
by the SNARE system [10], which uses a small number of simple
trafﬁc features to block spammers with reasonable accuracy.
Finally, compared to host-based classiﬁcation, the novelty of our
method can be mostly traced to the addition of the following two
“dimensions”: (i) we introduce a timing dimension, as this con-
tains valuable information about user- and machine- behaviors; (ii)
while earlier host-based approaches [14] attempt to identify a com-
mon communication pattern (graph) shared by all hosts of this ap-
plication, we try to correlate the unknown host behavior to known
hosts running a different, but related application; as a result, hosts
with different patterns could be validly identiﬁed under one class.
6. CONCLUSION
In this paper, we have presented a number of ﬂow-level tech-
niques that can be used to separate webmail trafﬁc from other HTTPS
trafﬁc. The novelty of our approach goes into two main directions:
(i) we leverage correlations across (related) protocols (e.g. IMAP,
POP, SMTP, and webmail) and among hosts sharing a similar client
base, and (ii) we identify and exploit timing characteristics of web-
mail applications. Based on these, we have introduced novel fea-
tures, investigated their efﬁciency on a large ﬂow data set, and used
them to produce preliminary classiﬁcation results on internal and
2Recall that GMail recently switched to HTTPS.
3For a survey of trafﬁc classiﬁcation literature refer to [16].
326external HTTPS servers. This is the ﬁrst work to show that it is
possible to uncover HTTPS webmail applications solely based on
ﬂow-level data with approximately 93.2% accuracy and 79.2% pre-
cision.
While the main focus of this paper has been the presented novel
features, in future work, we intend to optimize our classiﬁer and if
needed to further extend our set of features (along the two direc-
tions discussed) to improve the precision of our classiﬁcation. In
the same direction, we would also like to test the effect of sampling
on our techniques, as we believe that most of the features presented
are likely immune to sampling. Furthermore, we believe that our
features are of broader interest for trafﬁc classiﬁcation, and could
be used, for example, to facilitate demultiplexing of HTTP(S) traf-
ﬁc in general. Finally, having a reliable method to extract webmail
trafﬁc, we intend to perform an extensive characterization of the
long-term evolution of mail-related trafﬁc including usage trends
and trafﬁc mix between classical delivery and web-mail protocols.
Acknowledgments
We are grateful to SWITCH for providing their trafﬁc traces and to
the anonymous reviewers for their helpful comments. Also, we
want to thank Bernhard Tellenbach, Martin Burkhart and Brian
Trammell for their contributions. Special thanks to Simon Leinen
for assisting with ﬂow collection and processing. Finally, we are
grateful to our shepherd Mark Allman. Part of this work has been
funded by the EC Marie Curie IRG project 46528.
7. REFERENCES
[1] T. Auld, A. Moore, and S. Gull. Bayesian Neural Networks
for Internet Trafﬁc Classiﬁcation. IEEE Transactions on
Neural Networks, 2007.
[2] L. Bernaille, R. Teixeira, and K. Salamatian. Early
application identiﬁcation. In Proc. of ACM CoNEXT, 2006.
[3] Trojan Now Uses Hotmail, Gmail as Spam Hosts.
http://news.bitdefender.com/NW544-en-n-\
-Trojan-Now-Uses-Hotmail-as-Spam-Hosts.
html, 2007.
[4] C. Chang and C. Lin. LIBSVM: a Library for Support Vector
Machines, 2001.
www.csie.ntu.edu.tw/~cjlin/libsvm.
[5] T. Choi, C. Kim, S. Yoon, J. Park, B. Lee, H. Kim, and
H. Chung. Content-Aware Internet Application Trafﬁc
Measurement and Analysis. In Proc. of IEEE/IFIP NOMS,
2005.
[6] Email client popularity. http://www.
campaignmonitor.com/stats/email-clients.
[7] M. Crotti, M. Dusi, F. Gringoli, and L. Salgarelli. Trafﬁc
Classiﬁcation Through Simple Statistical Fingerprinting.
ACM SIGCOMM CCR, 2007.
[8] H. Dreger, A. Feldmann, M. Mai, V. Paxson, and R. Sommer.
Dynamic Application-Layer Protocol Analysis for Network
Intrusion Detection. In Proc. of USENIX Security
Symposium, 2006.
[9] P. Haffner, S. Sen, O. Spatscheck, and D. Wang. Acas:
Automated Construction of Application Signatures. In Proc.
of SIGCOMM MineNet Workshop, 2005.
[10] S. Hao, N. Feamster, A. Gray, N. Syed, and S. Krasser.
Detecting Spammers with SNARE: Spatio-Temporal
Network-level Automatic Reputation Engine. In Proc. of
USENIX Security Symposium, 2009.
[11] The Horde Project. www.horde.org.
[12] Scammers Exploit Public Lists of Hijacked Hotmail
Passwords. http://www.computerworld.com/s/
article/9139092/Scammers_exploit_public_
lists_of_hijacked_Hotmail_passwords, 2007.
[13] M. Iliofotou, P. Pappu, M. Faloutsos, M. Mitzenmacher, and
G. Varghese. Network Monitoring Using Trafﬁc Dispersion
Graphs. In Proc. of ACM IMC, 2007.
[14] T. Karagiannis, K. Papagiannaki, and M. Faloutsos. BLINC:
Multilevel Trafﬁc Classiﬁcation in the Dark. In Proc. of ACM
SIGCOMM, 2005.
[15] T. Karagiannis, K. Papagiannaki, N. Taft, and M. Faloutsos.
Proﬁling the End Host. In Proc. of PAM, 2007.
[16] H. Kim, K. Claffy, M. Fomenkov, D. Barman, M. Faloutsos,
and K. Lee. Internet Trafﬁc Classiﬁcation Demystiﬁed:
Myths, Caveats, and the Best Practices. In Proc. of ACM
CoNEXT, 2008.
[17] H. Kim, M. Fomenkov, K. Claffy, N. Brownlee, D. Barman,
and M. Faloutsos. Comparison of Internet Trafﬁc
Classiﬁcation Tools. In Proc. of IMRG workshop on
application classiﬁcation and identiﬁcation report, 2009.
[18] W. Li, A. W. Moore, and M. Canini. Classifying HTTP
Trafﬁc in the New Age. In ACM SIGCOMM, Poster Session,
2008.
[19] Z. Li, R. Yuan, and X. Guan. Accurate Classiﬁcation of the
Internet Trafﬁc Based on the SVM Method. In Proc. of IEEE
International Conference on Communications (ICC), 2007.
[20] A. McGregor, M. Hall, P. Lorier, and J. Brunskill. Flow
Clustering Using Maching Learning Techniques. In Proc. of
PAM, 2004.
[21] The Middleware Threats.
http://biz.yahoo.com/msft/p7.html.
[22] A. Moore and D. Zuev. Internet Trafﬁc Classiﬁcation Using
Bayesian Analysis Techniques. In Proc. of ACM
SIGMETRICS, 2005.
[23] A. W. Moore and P. Konstantina. Toward the Accurate
Identiﬁcation of Network Applications. In Proc. of PAM,
2005.
[24] J. Myers and A. Well. Research Design and Statistical
Analysis (2nd edition). Routledge, 2002.
[25] Microsoft Outlook Web Access. www.microsoft.com/
exchange/code/OWA/index.html.
[26] A. Ramachandran and N. Feamster. Understanding the
Network-Level Behavior of Spammers. In Proc. of ACM
SIGCOMM, 2006.
[27] M. Roughan, S. Sen, O. Spatschek, and N. Dufﬁeld.
Class-of-Service Mapping for QoS: a Statistical
Signature-Based Approach to IP Trafﬁc Classiﬁcation. In
Proc. of ACM IMC, 2004.
[28] D. Schatzmann, M. Burkhart, and T. Spyropoulos. Inferring
Spammers in the Network Core. In Proc. of PAM, 2009.
[29] F. Schneider, S. Agarwal, T. Alpcan, and A. Feldmann. The
New Web: Characterizing AJAX Trafﬁc. In Proc. of PAM,
2008.
[30] S. Sen, O. Spatscheck, and D. Wang. Accurate, Scalable
In-Network Identiﬁcation of P2P Trafﬁc Using Application
Signatures. In Proc. of WWW, 2004.
[31] The Swiss Education and Research Network (SWITCH).
http://www.switch.ch.
327