# 2018年度 上半年暗链监测分析报告
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
## 1\. 报告概述
安恒数据大脑近期跟踪发现，国内站点暗链情况较为严重，据不完全检测统计发现，国内有超过5万站点已被植入暗链/黑链，其中企业由于体量巨大与安全能力较弱成为了重灾区，而近千起的政府、事业单位网站也沦陷为黑产牟利工具，其中县市区的站点占比在50%以上，是我国重要站点受害严重的群体。
由于暗链的植入是一个通过漏洞利用、后门植入、维护暗链的过程，网站的安全程度与管理员的维护情况直接相关，这些站点的沦陷也是由于安全能力与安全意识不到位引起。
暗链的猖獗很大程度上是由上游黑产暴利行业的推动，本次检测数据发现博彩已成为暗链的最大源头，其次为代孕、色情、私服游戏、开房记录查询这类无法公开宣传推广，需要通过暗链渠道提升搜索排行的黑灰产。
因此暗链不仅仅是单个站点安全问题，更是网络空间中的非法产业的滋生传播，影响网络空间和社会秩序的问题。
综上所述，暗链的治理需要我们进一步行动起来，一方面，网站运营单位需加大对暗链的安全认识程度，在安全加固、暗链清理、后门清查等方面进行全面的检查，加强日常的安全监测与管理；另一方面，行业主管单位与网络安全监管部门，需要进一步提升对网络空间黑灰产的治理，通过暗链的现象的监管与整改，切断其传播渠道与媒介。
## 2\. 暗链成为影响网站安全的头号问题
###  2.1. 我国过万站点被植入暗链
2018年上半年，安恒数据大脑检测分析到全国约13万起暗链事件（以url为计数单位），共涉及约5.6万个网站，其中有95.93%的站点是企业站点，政府机关事业单位网站有1042个，占全部被植入暗链网站总数的1.85%，从被植入暗链网页的顶级域名分布来看，“com”占比最多，占总数的73.46%。
####  2.2.1 暗链网站的区域分布
从数据大脑收录的数据来看，全国共有56294个网站被植入暗链，如下图所示，31个省、直辖市及自治区中或多或少都存在暗链事件。各省网站暗链总数排名前五名的地区分别为广东（占比12.5%）、江苏（占比10.2%）、北京（占比9.6%）、上海（占比8.0%）、山东（占比7.9%），这五个省份的暗链网站的总数约为所有暗链网站总数的50%。
图2-1 各省网站现存暗链总数
####  2.2.2 暗链网站的行业分布
根据风暴中心对上述5.6万个被植入暗链网站进行单位/行业归类，共统计影响近14个不同行业/部门，其中企业站点为受攻击的重灾区，占全部被植入暗链网站总数的95.93%，企业站点安全水平能力较低，总体数量多，非常容易受到黑客攻击，植入暗链也难于被察觉，因此可长期有效。
其他非企业站点植入暗链情况分布如下：
图2-2 非企业行业被植入暗链网站行业占比图
###  2.2. 影响我国政府、事业等行业
根据安恒数据大脑分析，统计数据中被植入暗链的政府机关网站有215个，事业单位有827个。通过对我国这两类重要单位的行政等级进行分析，发现有明显的行政级别区分，如下图所示：
图2-3 事业单位被植入暗链网站省市县分布图
图2-4 政府单位被植入暗链网站省市县分布图
通过上图，可以很明显看出基本都是县市区的网站被植入暗链较多，占比过半，主要原因是，县市区的小网站更新频率低，往往几个月不会更新一次，甚至没人维护，而且事业单位或者政府网站通常比较稳定，较少出现没几天就消失不见的情况。
地方县市区的业务系统通常由当地小公司开发和运维，忽视安全问题，导致系统存在大量安全漏洞，容易被植入暗链。
### 2.3. 暗链网站被黑客重复利用，隐患重重
我们通过将暗链地址与威胁情报数据关联分析后，发现大量的暗链地址同时也是C2、钓鱼地址、放马地址、扫描主机、漏洞利用等被恶意利用地址。
图2-5 暗链地址与威胁情报关联结果部分截图
虽然暗链对网站本身没有什么实质性威胁，但是暗链的存在往往标志着该网站存在安全漏洞，所以带有暗链的网站往往更容易被反复入侵，重复利用。
## 3\. 暗链的隐蔽性日趋多样化
### 3.1. 传统暗链形式较为单一
传统的暗链形式非常单一，暗链的实现原理很简单，如采用CSS样式设置以达到暗链不可见的目的，把黑链的display元素设置为none、把黑链的标签显示颜色调为和网页页面颜色一致、把黑链浮动或者定位在网页不可浏览到的位置等。
传统的黑客实施暗链的手法大同小异，此时暗链的“暗”在于它是隐藏在网页源代码中的，通过肉眼直接在页面上看不见的，但只要打开源码就可以看到链接内容。
### 3.2. 新型暗链植入与推广方式多样化
随着暗链的发展，搜索引擎也开始对传统暗链方法进行识别和打击，为了不被搜索引擎识别，各种花样植入方式也纷纷兴起：
1、搜索引擎识别：黑客通过在页面中加入搜索引擎判断，使得一般用户无法发现暗链。脚本能够识别是搜索引擎来访问网站还是用户来访问网站，当搜索引擎来访问网站的时候，就会跳转到暗链页面，当用户访问的时候又会跳转到另外一个页面。
图3-1 正常用户访问返回界面