资深Python程序员力作 带你快速掌握Python高效编程
PPyytthhoonn编编程程快快速速上上手手
Python
—— 让让繁繁琐琐工工作作自自动动化化
编
如果你曾经花几个小时重命名文件或更新数百个电子表格的单元格，就知道这样的任务有多繁琐了。但是，如果你
程
可以让计算机替你完成呢？
快
在本书中，你将学习利用Python编程，在几分钟内完成手工需要几小时的工作，而事先却无需具备编程经验。一 速
[美] Al Sweigart 著 王海鹏 译
旦掌握了编程的基础知识，你就可以毫不费力地创建Python程序，完成高效的自动化工作，包括： 上
手
● 在一个文件或多个文件中搜索文本；
● 创建、更新、移动和重命名文件和文件夹； —
● 搜索网页和下载的在线内容；
让
● 在任意大小的Excel电子表格中更新和格式化数据；
繁
● 拆分、合并PDF文件，以及如何加水印和加密； 琐
● 发送提醒邮件和文本通知； 工
● 填写在线表格。 作
自
本书一步一步地引导你完成每个程序，每章末尾的实践项目启发你来改进这些程序，并用你的新技能来让类似的任
动
务自动化。你不用再浪费时间去做任何可以自动化的工作。即使你从未写过一行代码，也可以让计算机来做繁重的工作，
化
本书告诉你如何做。
作者简介
Al Sweigart是一名软件开发者，还教小孩和成人编程。他为初学者写了几本Python书籍，包括《Python密码学
编程》、《Python游戏编程快速上手》和《Python和Pygame游戏开发指南》。
美术编辑：董志桢
分类建议：计算机／程序设计／Python
人民邮电出版社网址：www.ptpress.com.cn
FM42269Python编程快速上手——让繁琐工作自动化.indd 1-3 16-6-22 上午8:37
Python编程快速上手
— 让繁琐工作自动化
[美] Al Sweigart 著 王海鹏 译
人 民 邮 电 出 版 社
北 京
FM42269Python编程快速上手——让繁琐工作自动化.indd 4 16-6-21 上午8:10
版权声明
Simplified Chinese-language edition copyright © 2016 by Posts and Telecom Press.
Copyright © 2015 by Al Sweigart.Title of English-language original: Automate The Boring Stuff with
Python ISBN-13: 978-1-59327-599-0, published by No Starch Press.
All rights reserved.
本书中文简体字版由美国No Starch出版社授权人民邮电出版社出版。未经出版者书面许可，对本书
任何部分不得以任何方式复制或抄袭。
版权所有，侵权必究。
 著 [美] Al Sweigart
译 王海鹏
责任编辑 陈冀康
责任印制 焦志炜
 人民邮电出版社出版发行 北京市丰台区成寿寺路11号
邮编 100164 电子邮件 PI:EMAIL
网址 http://www.ptpress.com.cn
北京鑫正大印刷有限公司印刷
 开本：8001000 1/16
印张：26.25
字数：590千字 2016年7月第1版
印数：1 – 3 000册 2016年7月北京第1次印刷
著作权合同登记号 图字：01-2015-2962 号
定价：69.00元
读者服务热线：(010)81055410 印装质量热线：(010)81055316
反盗版热线：(010)81055315
内容提要
如今，人们面临的大多数任务都可以通过编写计算机软件来完成。Python是一
种解释型、面向对象、动态数据类型的高级程序设计语言。通过Python编程，我们
能够解决现实生活中的很多任务。
本书是一本面向实践的Python编程实用指南。本书的目的，不仅是介绍Python
语言的基础知识，而且还通过项目实践教会读者如何应用这些知识和技能。本书的
第一部分介绍了基本的Python编程概念，第二部分介绍了一些不同的任务，通过编
写Python程序，可以让计算机自动完成它们。第二部分的每一章都有一些项目程序，
供读者学习。每章的末尾还提供了一些习题和深入的实践项目，帮助读者巩固所学
的知识。附录部分提供了所有习题的解答。
本书适合任何想要通过Python学习编程的读者，尤其适合缺乏编程基础的初学
者。通过阅读本书，读者将能利用最强大的编程语言和工具，并且将体会到Python
编程的快乐。
作者简介
Al Sweigart是一名软件开发者和技术图书作者，居住在旧金山。Python是他最
喜欢的编程语言，他开发了几个开源模块。他的其他著作都在他的网站http://www.
inventwithpython.com/上。
技术评审者简介
Ari Lacenski是Android应用程序和Python软件开发者。她住在旧金山，她写了
一些关于 Android 编程的文章，放在 http://gradlewhy.ghost.io/上，并与 Women Who
Code合作提供指导。她还是一个民谣吉他手。
致谢
没有很多人的帮助，我不可能写出这样一本书。我想感谢Bill Pollock，我的编
辑Laurel Chun、Leslie Shen、Greg Poulos和Jennifer Griffith-Delgado，以及No Starch
Press的其他工作人员，感谢他们非常宝贵的帮助。感谢我的技术评审Ari Lacenski，
她提供了极好的建议、编辑和支持。
非常感谢Guido van Rossum，以及Python软件基金会的每个人，感谢他们了不
起的工作。Python社区是我在业界看到的最佳社区。
最后，我要感谢我的家人和朋友，以及在Shotwell的伙伴，他们不介意我在写
这本书时忙碌的生活。干杯！
译者序 会编程的人不一样
这是机器代替人的时代，也是人控制机器的时代。这是程序员的时代，也是非
程序员学编程的时代。这是算法的时代，也是编程语言的时代。翻译本书期间，深
度学习的人工智能程序AlphaGo以4:1击败了李世石九段。
每一个不会编程的年轻人都应该认真考虑：是不是应该开始学习编程？
学习一门新的语言，总是让人感到畏缩。这让我想起大学时英语老师教的学习
方法：听说领先，读写跟上。确实，学语言效果最好的方法就是“用”。本书就遵
循了这样的宗旨。本书是面对编程初学者的书，假定读者没有任何编程知识。在简
单介绍Python编程语言的基本知识后，就开始用一个接一个的例子，教我们如何用
Python 来完成一些日常工作，利用计算机这个强大的工具，节省工作时间，提高工
作效率，避免手工操作容易带来的错误。
真正的程序员，用编程来解决自己和别人的问题。俄罗斯有一个程序员编写了
一个程序，会给老婆发加班短信，会在宿醉不醒时给自己请假，会自动根据邮件恢
复客户的数据库，还可以一键远程煮咖啡。加拿大一名零编程基础的农场主，在学
习了一门编程课后，开发了一个程序，自动控制拖拉机，配合联合收割机收割谷物。
若是已经掌握了其他编程语言，想学习Python，本书也是不错的参考。每一种
编程语言，都会提供一种独特的视角，让你对编程有新的认识。我非常喜欢Python
没有花括号和分号，程序很“清爽”，符合奥卡姆剃刀原理：如无必要，勿增实体。
本书并没有深入介绍面向对象和函数式编程范式，如果想了解 Python 这方面的内
容，请参考其他书籍。
在本书的翻译过程，我自己也在项目中使用Python编程，从中得到许多启发。
因此，郑重向大家推荐。翻译中的错误，请不吝指出。
王海鹏
2016年春于上海
前 言
“你在 2 个小时里完成的事，我们 3 个人要做两天。”21
世纪早期，我的大学室友在一个电子产品零售商店工作。商店
偶尔会收到一份电子表格，其中包含竞争对手的数千种产品的
价格。由3个员工组成的团队，会将这个电子表格打印在一叠
厚厚的纸上，然后3个人分一下。针对每个产品价格，他们会
查看自己商店的价格，并记录竞争对手价格较低的所有产品。
这通常会花几天的时间。
“如果你有打印件的原始文件，我会写一个程序来做这件事。”我的室友告诉他
们，当时他看到他们坐在地板上，周围都是散落堆叠的纸张。
几个小时后，他写了一个简短的程序，从文件读取竞争对手的价格，在商店的
数据库中找到该产品，并记录竞争对手是否更便宜。他当时还是编程新手，花了许
多时间在一本编程书籍中查看文档。实际上程序只花了几秒钟运行。我的室友和他
的同事们那天享受了超长的午餐。
这就是计算机编程的威力。计算机就像瑞士军刀，可以用来完成数不清的任务。
许多人花上数小时点击鼠标和敲打键盘，执行重复的任务，却没有意识到，如果他
们给机器正确的指令，机器就能在几秒钟内完成他们的工作。
本书的读者对象
软件是我们今天使用的许多工具的核心：几乎每个人都使用社交网络来进行交
流，许多人的手机中都有连接因特网的计算机，大多数办公室工作都涉及操作计算
机来完成工作。因此，对编程人才的需求暴涨。无数的图书、交互式网络教程和开
发者新兵训练营，承诺将有雄心壮志的初学者变成软件工程师，获得6位数的薪水。
前 言
本书不是针对这些人的。它是针对所有其他的人。
就它本身来说，这本书不会让你变成一个职业软件开发者，就像几节吉他课程
不会让你变成一名摇滚巨星。但如果你是办公室职员、管理者、学术研究者，或使
用计算机来工作或娱乐的任何人，你将学到编程的基本知识，这样就能将下面这样
一些简单的任务自动化：
 移动并重命名几千个文件，将它们分类，放入文件夹；
 填写在线表单，不需要打字；
 在网站更新时，从网站下载文件或复制文本；
 让计算机向客户发出短信通知；
 更新或格式化Excel电子表格；
 检查电子邮件并发出预先写好的回复。
对人来说，这些任务简单，但很花时间。它们通常很琐碎、很特殊，没有现成
的软件可以完成。有一点编程知识，就可以让计算机为你完成这些任务。
编码规范
本书没有设计成参考手册，它是初学者指南。编码风格有时候违反最佳实践（例
如，有些程序使用全局变量），但这是一种折中，让代码更简单，以便学习。本书
的目的是让人们编写用完即抛弃的代码，所以没有太多时间来关注风格和优雅。复
杂的编程概念（如面向对象编程、列表推导和生成器），在本书中也没有介绍，因
为它们增加了复杂性。编程老手可能会指出，本书中的代码可以修改得更有效率，
但本书主要考虑的是用最少的工作量得到能工作的程序。
什么是编程
在电视剧和电影中，常常看到程序员在闪光的屏幕上迅速地输入密码般的一串 1
和 0，但现代编程没有这么神秘。编程只是输入指令让计算机来执行。这些指令可
能运算一些数字，修改文本，在文件中查找信息，或通过因特网与其他计算机通信。
所有程序都使用基本指令作为构件块。下面是一些常用的指令，用自然语言的
形式来表示：
“做这个，然后做那个。”
“如果这个条件为真，执行这个动作，否则，执行那个动作。”
“按照指定次数执行这个动作。”
“一直做这个，直到条件为真。”
也可以组合这些构件块，实现更复杂的决定。例如，这里有一些编程指令，称
为源代码，是用 Python 编程语言编写的一个简单程序。从头开始，Python 软件执
前 言
行每行代码（有些代码只有在特定条件为真时执行，否则Python会执行另外一些代
码），直到到达底部。
 passwordFile = open('SecretPasswordFile.txt')
 secretPassword = passwordFile.read()
 print('Enter your password.')
typedPassword = input()
 if typedPassword == secretPassword:
 print('Access granted')
 if typedPassword == '12345':
 print('That password is one that an idiot puts on their luggage.')
else:
 print('Access denied')
你可能对编程一无所知，但读了上面的代码，也许就能够合理地猜测它做的事。
首先，打开了文件SecretPasswordFile.txt，读取了其中的密码。然后，提示用户
（通过键盘）输入一个密码。比较这两个密码，如果它们一样，程序就在屏幕上
打印Access granted。接下来，程序检查密码是否为12345，提示说这可能并不
是最好的密码。如果密码不一样，程序就在屏幕上打印Access denied。
什么是 Python
Python 指的是 Python 编程语言（包括语法规则，用于编写被认为是有效的
Python 代码），以及 Python 解释器软件，它读取源代码（用python 语言编写），并
执行其中的指令。Python解释器可以从http://python.org/免费下载，有针对Linux、
OS X和Windows的版本。
Python的名字来自于英国超现实主义喜剧团体，而不是来自于蛇。Python程序
员被亲切地称为Pythonistas。Monty Python和与蛇相关的引用常常出现在Python的
指南和文档中。
程序员不需要知道太多数学
我听到的关于学习编程的最常见的顾虑，就是人们认为这需要很多数学知识。
其实，大多数编程需要的数学知识不超过基本算数。实际上，善于编程与善于解决
数独问题没有太大差别。
要解决数独问题，数字1到9必须填入9×9的棋盘上每一行、每一列，以及每
个3×3的内部方块。通过推导和起始数字的逻辑，你会找到一个答案。例如，在图 1
的数独问题中，既然5出现在了左上角，它就不能出现在顶行、最左列，或左上角
3×3 方块中的其他位置。每次解决一行、一列或一个方块，将为剩下的部分提供更