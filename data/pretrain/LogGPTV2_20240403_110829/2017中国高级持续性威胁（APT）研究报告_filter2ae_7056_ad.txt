#### APT28针对法国大选的攻击
2017年5月ESET发布报告称发现APT28干扰法国总统大选。一个名为Trump’s_Attack_on_Syria_English.docx的文档引起了研究人员的注意。
打开这份文档后首先会触发EPS漏洞CVE-2017-0262（Office的Encapsulated
PostScript图形文件漏洞）。多次解密后，Seduploader病毒释放器就会被加载并予以执行。为了部署Seduploader，Seduploader病毒释放器通过利用内核漏洞CVE-2017-0263获取了系统权限。对于这种“EPS漏洞＋内核漏洞”组合的利用值得关注。
#### APT28针对欧洲酒店行业的攻击
2017年8月FireEye发布报告称发现APT28使用NSA工具（例如Eternalblue漏洞利用工具）监听欧洲及中东地区的酒店。恶意文档Hotel_Reservation_Form.doc包含一个宏，该宏使用base64解码一个dropper，然后部署APT28的恶意软件GameFish，使用mvband.net和mvtband.net作为C2服务器。
APT28使用EternalBlue漏洞利用工具和开源工具Responder进行横向传播，并可能针对旅行者。一旦进入酒店公司的网络，APT28就找出了控制客人和内部WiFi网络的机器。在2016年秋季发生的一起单独事件中，APT28通过可能从酒店WiFi网络窃取的证书初步获取了受害者的网络。
在获得连接到酒店和访客WiFi网络的机器后，APT28部署了Responder，使得NetBIOS名称服务（NBT-NS）中毒。这种技术会侦听来自受害者计算机尝试连接到网络资源的NBT-NS（UDP
/137）广播。一旦收到，攻击者就会伪装成受害者正在寻找的资源，并使受害者计算机将用户名和散列密码发送给攻击者控制的机器。APT28使用这种技术来窃取用户名和散列的密码升级在受害者网络中的权限。
为了通过酒店公司的网络传播，APT28使用了EternalBlue
SMB漏洞的一个版本与大量使用py2exe编译的Python脚本相组合。这是APT28组织第一次被发现将这个漏洞利用到了他们的入侵中。
在2016年的事件中，受害人在连接酒店WiFi网络后受到攻击。受害者最初连接到公众可用的WiFi网络十二个小时之后，APT28以窃取的凭证登录到机器。这12个小时可能已经被用于离线破解密码。攻击者成功访问机器后，在机器上部署工具，通过受害者的网络横向传播，访问受害者的OWA（Outlook
Web App）帐户。登录来自同一子网上的计算机，这些攻击手法都表明攻击者机器在物理上距离受害者很近，并在同一 WiFi网络上。
#### APT28借“纽约恐袭事件”的攻击
2017年11月McAfee发布报告称在监控APT28的过程中发现其利用Microsoft
Office动态数据交换（DDE）技术的恶意文档，并且借10月份美国纽约恐怖袭击事件作为吸引受害者注意力的诱饵。比如本次攻击中发现的诱饵文档有一个文件名称直接命名为：IsisAttackInNewYork.docx。
在技术上，APT28通过将PowerShell与DDE结合使用，无论是否启用宏，攻击者都能够在受害者系统上执行任意代码。
报告显示，被发现的诱饵文档内容是空白的，它利用DDE技术通过Windows的命令行命令去执行PowerShell脚本，PowerShell脚本所下载的木马负载和被APT28用于CyCon安全大会的木马负载几乎是相同的。CyCon
是北约联合防御中心（CCDCOE）和西点军校网络研究所合办的安全会议，报告显示，10月初，APT28 对 CyCon的参会人员发动鱼叉攻击。
###  针对东亚地区的攻击
#### 海莲花针对东亚国家的攻击
2017年11月6日，国外安全公司发布了一篇据称海莲花APT团伙新活动的报告，360威胁情报中心对其进行了分析和影响面评估，并提供了处置建议。
攻击者通过水坑攻击将恶意JavaScript代码植入到合法网站，收集用户浏览器指纹信息，修改网页视图诱骗用户登陆钓鱼页面安装下载恶意软件。
我们通过关联分析定位到一个相关的恶意样本。执行该样本可以看到安装了Firefox浏览器，实际上它还偷偷执行了加载恶意代码的操作。ShellCode和后面的木马负载都加入了大量的垃圾代码和无用跳转。ShellCode主要是使用Windows一些加解密机制解密出三个如下图所示的文件落地到磁盘并创建相关的服务。
rastlsc.exe带有赛门铁克的签名，它会加载rastls.dll。rastls.dll如法炮制解密出SyLog.bin，从而执行管理相关注册表项，获取硬盘信息，获取系统版本，计算机名等恶意行为。C2服务器通信部分是通过获取计算机信息生成字符串与.harinarach.com、.maerferd.com和.eoneorbin.com拼接成一个完整的域名，连接其25123端口实现C2服务器通信。
#### Lazarus针对韩国三星手机用户的攻击
2017年11月McAfee和Palo Alto Networks的安全专家都表示Lazarus将黑手伸向了移动设备。一款名为“갓피플
성경통독”的应用程序被上传到了Google Play商店，模仿由GODpeople（一家位于韩国首尔的安卓应用程序开发商）开发的韩语版圣经应用程序。
该恶意程序实际上它包含了一个ELF后门文件，允许攻击者完全控制受感染的设备。这个文件与Lazarus在之前使用的几个文件十分相似。另外，它的C2服务器列表包括先前与Lazarus关联的IP地址。Palo
Alto Networks更是指出这起活动似乎针对了韩国的三星移动设备用户。
###  针对中东地区的攻击
####  APT34针对中东政府的攻击
2017年12月FireEye发布报告称发现APT34利用刚刚修复的CVE-2017-11882攻击中东政府。下图是专用木马中漏洞利用的部分，可以看到漏洞利用成功后，木马调用mshta.exe从下载恶意的脚本。
木马使用DGA算法与C2服务器通信，并且具有多种远控功能。
在过去几个月中，APT34已经能够迅速利用至少两个公开漏洞（CVE-2017-0199和CVE-2017-11882）针对中东的机构发起攻击。
#### BlackOasis针对中东地区的攻击
2017年10月Kaspersky发布报告称BlackOasis利用Adobe
0day漏洞CVE-2017-11292传播间谍软件FinSpy。攻击利用Office文档，以电子邮件作为载体发送，文档中嵌入包含 Flash
漏洞的ActiveX对象。
Flash对象中包含的ActionScript代码使用，和其它传播FinSpy的漏洞利用一样的自定义packer提取出exploit。漏洞利用成功后将在内存中获得任意读写操作权限，从而执行下一阶段的ShellCode。下一阶段的ShellCode下载FinSpy的最终木马负载和显示给受害者的诱饵文件，然后执行木马并显示诱饵文件。
#### 双尾蝎组织针对巴以两国的攻击
2017年3月，360威胁情报中心发布追日团队的研究报告《双尾蝎组织（APT-C-23）伸向巴以两国的毒针》。报告显示，2016年5月起至今，双尾蝎组织对巴勒斯坦教育机构、军事机构等重要领域展开了有组织、有计划、有针对性的长时间不间断攻击。攻击平台包括Windows与Android，攻击范围主要为中东地区。截至报告发布时，360威胁情报中心一共捕获了Android样本24个，Windows样本19个，涉及的C&C域名29个。
双尾蝎组织的专用木马主要伪装成文档、播放器、聊天软件以及一些特定领域常用软件，通过鱼叉或水坑等攻击方式配合社会工程学手段进行渗透，向特定目标人群进行攻击。入侵成功后攻击者开始窃取目标系统中的各类文档资料并且进行实时监控。
该组织的相关恶意可执行程序多为“.exe”和“.scr”扩展名，但是这些程序都伪装成doc、xls文档图标，并且文件中还包含一些用以迷惑用户的文档。
该组织在诱饵文档命名时也颇为讲究，如“الاجهزة الامنية”（安全服务）、“Egyptian Belly Dancer Dina Scandal,
Free Porn”（肚皮舞者Dina丑闻，色情），此类文件名容易诱惑用户点击。
该组织的Android端后门程序功能主要包括定位、短信拦截、电话录音等，并且还会收集文档、图片、联系人、短信等情报信息；PC端后门程序功能包括收集用户信息上传到指定服务器、远程下载文件以及远控。
360威胁情报中心将APT-C-23组织命名为双尾蝎，主要是考虑了以下几方面的因素：一是该组织同时攻击了巴勒斯坦和以色列这两个存在一定敌对关系的国家，这种情况在以往并不多见；二是该组织同时在Windows和Android两种平台上发动攻击。虽然以往我们截获的APT组织中也有一些进行多平台攻击的例子，如海莲花，但绝大多数APT组织攻击的重心仍然是
Windows平台。而同时注重两种平台，并且在Android平台上攻击如此活跃的APT组织，在以往并不多见。第三个原因就是蝎子在巴以地区是一种比较有代表性的动物。综上，根据360威胁情报中心对APT组织的命名规则（参见《2016年中国高级持续性威胁研究报告》），我们命名APT-C-23组织为“双尾蝎”。
#### 黄金鼠组织针对叙利亚的攻击
2018年1月，360威胁情报中心发布追日团队的研究报告《黄金鼠组织（APT-C-27）叙利亚地区的定向攻击活动》，报告显示，从2014年11月起至今，黄金鼠组织对叙利亚地区展开了有组织、有计划、有针对性的长时间不间断攻击。攻击平台从开始的Windows平台逐渐扩展至Android平台。截至报告发布时，一共捕获了Android平台攻击样本29个，Windows平台攻击样本55个，涉及的C2服务器域名9个。
黄金鼠组织的活动最早可以追溯到
2014年11月。研究显示，其Android和PC平台的恶意样本主要伪装成聊天软件及一些特定领域常用软件，通过水坑攻击方式配合社会工程学手段进行渗透。
2015年7月，叙利亚哈马市新闻媒体在Facebook上发布了一则消息，该条消息称带有“土耳其对叙利亚边界部署反导弹系统进行干预，详细信息为”的信息为恶意信息，并告诫大家不要打开信息中链接，该链接为黑客入侵链接，相关C2服务器IP地址为31.9.48.183。哈马市揭露的这次攻击行动，就是我们在
2016年6月发现的针对叙利亚地区的APT攻击。从新闻中我们确定了该行动的攻击目标至少包括叙利亚地区，其载荷投递方式至少包括水坑式攻击。
该组织在PC与Android端间谍软件主要伪装成Telegram等聊天软件，并通过水坑等攻击方式配合社会工程学手段进行渗透。相关恶意可执行程序多为“.exe”和“.scr”扩展名，但是这些程序都伪装成Word、聊天工具图标，并通过多种诱导方式诱导用户中招。
攻击者针对PC平台使用了大量的攻击载荷，包括Multi-stage
Dropper、njRAT、VBS脚本、JS脚本、Downloader等恶意程序，此类恶意程序多为远控，主要功能包括上传下载文件、执行Shell等。
Android端后门程序功能主要包括定位、短信拦截、电话录音等，并且还会收集文档、图片、联系人、短信等情报信息。
攻击者在诱饵文档命名时也颇为讲究，如“حمص تلبيسة قصف بالهاون”（炮击霍姆斯），此类文件名容易诱惑用户点击。
360威胁情报中心将APT-C-27组织命名为黄金鼠，主要是考虑了以下几方面的因素：一是该组织在攻击过程中使用了大量的资源，说明该攻击组织资源丰富，而黄金鼠有长期在野外囤积粮食的习惯，字面上也有丰富的含义；二、该攻击组织通常是间隔一段时间出来攻击一次，这跟鼠类的活动习性有相通的地方；三是黄金仓鼠是叙利亚地区一种比较有代表性的动物。因此，根据360威胁情报中心对APT组织的命名规则（参见《2016年中国高级持续性威胁研究报告》），我们命名APT-C-27组织为“黄金鼠”。
##  网络军火民用化
2017年5月份，永恒之蓝勒索蠕虫病毒（WannaCry）肆虐全球，导致150多个国家，30多万受害者遭遇勒索软件攻击，医疗、交通、能源、教育等行业领域遭受巨大损失。该勒索软件之所以有如此大的威力，主要是其借助了黑客组织Shadow
Brokers（影子经纪人）在网络上公开的，据称是美国国家安全局（NSA）旗下方程式组织（Equation
Group）所开发的网络武器，即军火级的网络漏洞利用工具。黑客分子拿着军用武器，冲入民用设施，扫荡所到之处，破坏与掠夺之惨烈可想而知。以永恒之蓝为代表的这一波漏洞利用武器库的大规模试水，标志着网络军火进入民用化的阶段，也使业界和公众进一步加深对APT攻击与威胁的认识和理解。
从公开资料看，2017年泄露的网络武器库的最终源头主要有两个，一个是据称是NSA旗下的方程式组织，另一个据称是美国中情局（CIA）直属的网络情报中心。下面我们通过介绍与NSA、CIA这两大情报机构相关的网络武器库外泄事件，具体分析网络军火民用化威胁与趋势。
###  疑似NSA网络武器工具外泄