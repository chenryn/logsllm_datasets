contemporary hardware (∼1050 with challenge-response authenti-
cation enabled). A single such P-Box can handle moderate sized
sites, but load-balancers will be needed for large sites.
In real-world settings, interaction with multi-homing, complex
access control policy, mid-ﬂow reconﬁgurations, and mobility will
make signaling more heavy-weight.
5. RELATED WORK
Several other Internet architectures have been proposed that wean
away from 5-tuple addressing. TRIAD [20], IPNL [15], HIP [35],
SHIM6 [38] and i3 [49] route datagrams based on URLs, FQDNs,
host keys, hashes and ﬂat identiﬁers respectively; these approaches
advocate end-only control and require protocol-stack modiﬁcations
at endhosts and middleboxes. NUTSS advocates control shared
by both the end and the middle and uses a separate name-routed
signaling phase that is strongly coupled to existing address-routed
stacks. GMPLS [31], which doesn’t involve endpoints, uses IP for
“name”-routed signaling to negotiate the layer-2 path. Selnet [52],
Plutarch [10], AVES [36], Metanet [60], SIP [44], UIA [13], and
DONA [28] all involve the middle in resolving endpoint names to
realm-speciﬁc addresses and routes. In order to provide complete
end-middle-end connectivity, however, we believe the middle must
play a yet larger role in blocking unwanted ﬂows, and instantiating
the address-routed path.
When it comes to blocking unwanted ﬂows, one weakness of
the E2E security model as mentioned is that not everyone who has
a stake in security is empowered to provide that security. In this
model, the middle has little say in what ﬂows are allowed and must
rely completely on the endpoints for the protection of the network
itself. In select scenarios, in an enterprise for example, the IT de-
partment can enforce this control over the ends through software
update and conﬁguration management tools like Marimba [6]. In
other cases, such as with DoA [58], endpoints can explicitly invoke
security services provided by the middle. Such solutions, however,
do not protect against malicious or compromised endpoints that
may preempt the IT department’s control and abuse the network.
An alternate solution is where the middle exerts direct control
on ﬂows with the help of a middlebox on the address-routed path.
While middleboxes protect the network against uncooperative end-
points, they face the aforementioned problems which we repeat
here: ﬁrewalls must infer malice based largely on the 5-tuple and
costly deep packet inspection, D-WARD [34] infers malice based
on deviations from a “normal trafﬁc model”, NATs protect only
against drive-by intrusions from the outside, and VPNs cannot au-
thenticate remote endpoints that are not VPN members. Ultimately,
such middle-only approaches that cannot explicitly negotiate the
intent of the endpoint rely on heuristics, which potentially block
unmalicious ﬂows.
When it comes to establishing the address-routed path, protocols
such as UPnP [33] and Midcom [48] allow the endpoint to create
state in the middle. A limitation in these approaches, however, is
that the middle cannot participate in ﬂow negotiation either to en-
force network policy or to indicate whether the address-routed path
and protocol stack chosen by the endpoints is even possible. Ses-
sion Border Controllers [24] combine name-routing and address-
routing in one box, but do so without endpoint knowledge or con-
sent creating authentication and authorization hurdles.
6. SUMMARY AND FUTURE WORK
In this paper, we propose NUTSS, a name-based “end-middle-
end” approach to establishing network ﬂows through middleboxes
like NATs and ﬁrewalls that takes into account policies of the ends
and the middle. NUTSS is unique in that it couples both off-path
and on-path signaling in order to overcome the weaknesses of ei-
ther. NUTSS has an incentivized incremental deployment path,
and enables a number of important features, including mobility,
multi-homing, NAT traversal, negotiation of different network lay-
ers, multicast, and anycast.
Although this paper shows NUTSS to be a promising approach,
the devil is in the details. Our partial proof-of-concept implemen-
tation notwithstanding, the most important next steps are to gain
experience with NUTSS and to do more security analysis. Towards
this end, we hope that the NAT traversal features of our implemen-
tation may serve as a “killer app” to drive deployment and experi-
mentation.
Beyond this, there are a number of interesting research direc-
tions that we hope to explore. Due to lack of space, we only brieﬂy
list them here. Foremost among these is to explore the use of self-
certifying identiﬁers with NUTSS, as discussed in Section 3.8. An-
other is the use of an alternative to DNS in the core, for instance
a DHT or gossip protocol, as a means of name-based routing be-
tween contact P-boxes, in particular to avoid latencies associated
with the DNS lookup. Finally, NUTSS appears to be a promis-
ing basis for advanced services at the sockets API such as Quality
of Service, auditing and billing, publish-subscribe, and store-and-
forward service for intermittently connected devices, for instance
in DTNs [12].
Acknowledgemnts
The authors would like to thank David Wetherall (our shepherd),
Melinda Shore, Scott Brim, Mark Baugher, and our anonymous
reviewers for valuable comments and discussion on earlier versions
of this document. Ariel Rabkin and Tyler Steele contributed to the
NUTSS library.
7. REFERENCES
[1] AKAMAI TECHNOLOGIES, INC. Akamai: How it works.
[2] ANDERSEN, D. Mayday: Distributed ﬁltering for internet services.
In Proceedings of the USITS ’03 (Seattle, WA, Mar. 2003).
[3] ANTISIP SARL. The eXtended osip library.
[4] ARGYRAKI, K., AND CHERITON, D. R. Active Internet Trafﬁc
Filtering: Real-Time Response to Denial-of-Service Attacks. In
Proceedings of the 2005 USENIX Annual Technical Conference
(Anaheim, CA, Apr. 2005).
[5] BALLANI, H., CHAWATHE, Y., RATNASAMY, S., ROSCOE, T.,
AND SHENKER, S. Off by Default! In Proceedings of the
HotNets’05 (College Park, MD, Nov. 2005).
[6] BMC SOFTWARE. Marimba Product Line.
[7] CALHOUN, P. R., LOUGHNEY, J., ARKKO, J., GUTTMAN, E.,
AND ZORN, G. RFC 3588: Diameter Base Protocol, Sept. 2003.
[8] CISCO SYSTEMS, I. Cisco IOS Security Conﬁguration Guide
(Release 12.4). Cisco Press, 2006, ch. Access Control Lists:
Overview and Guidelines, pp. 429–436.
[9] CISCO SYSTEMS, I. Cisco IOS Security Conﬁguration Guide
(Release 12.4). Cisco Press, 2006, ch. Firewall Support for SIP,
pp. 587–600.
[10] CROWCROFT, J., HAND, S., MORTIER, R., ROSCOE, T., AND
WARFIELD, A. Plutarch: An Argument for Network Pluralism. In
Proceedings of the SIGCOMM ’03 Workshops (Karlsruhe, Germany,
Aug. 2003).
[11] (ED.), R. B., ZHANG, L., BERSON, S., HERZOG, S., AND JAMIN,
S. RFC 2205: Resource ReSerVation Protocol (RSVP), Sept. 1997.
[12] FALL, K. A Delay-Tolerant Network Architecture for Challenged
Internets. In Proceedings of SIGCOMM ’03 (Karlsruhe, Germany,
Aug. 2003).
[13] FORD, B., STRAUSS, J., LESNIEWSKI-LAAS, C., RHEA, S.,
KAASHOEK, F., AND MORRIS, R. Persistent Personal Names for
Globally Connected Mobile Devices. In Proceedings of the OSDI
’06 (Seattle, WA, Nov. 2004).
[14] FRANCIS, P. Firebreak: An IP Perimeter Defense Architecture.
Tech. Rep. cul.cis/TR2006-2060, Cornell University, Ithaca, NY,
2006.
[15] FRANCIS, P., AND GUMMADI, R. IPNL: A NAT-extended internet
architecture. In Proceedings of the SIGCOMM ’01 (San Diego, CA,
Aug. 2001).
[16] FRAUNHOFER FOKUS. CPLEd - A CPL Editor.
[17] FRAUNHOFER FOKUS. SIP Express Router.
[18] FREEDMAN, M. J., LAKSHMINARAYANAN, K., AND MAZI `ERES,
D. OASIS: Anycast for Any Service. In Proceedings of NSDI’06
(San Jose, CA, May 2006).
[19] GENI PLANNING GROUP. GENI: Global Environment for Network
Innovations.
the Internet. In Proceedings of SIGCOMM’04 (Portland, OR, August
2004).
[41] RAMSDELL, B. RFC 3851: Secure/Multipurpose Internet Mail
Extensions (S/MIME) Version 3.1 Message Speciﬁcation, July 2004.
[42] ROSENBERG, J. RFC 3856: A Presence Event Package for the
Session Initiation Protocol (SIP), Aug. 2004.
[43] ROSENBERG, J., MAHY, R., AND HUITEMA, C. Internet draft:
TURN – Traversal Using Relay NAT, Mar. 2006. Work in progress.
[44] ROSENBERG, J., SCHULZRINNE, H., CAMARILLO, G.,
JOHNSTON, A., PETERSON, J., SPARKS, R., HANDLEY, M., AND
SCHOOLER, E. RFC 3261: SIP Session Initiation Protocol, June
2002.
[45] ROSENBERG, J., WEINBERGER, J., HUITEMA, C., AND MAHY, R.
RFC 3489: STUN – Simple Traversal of User Datagram Protocol
(UDP) Through Network Address Translators (NATs), Mar. 2003.
[20] GRITTER, M., AND CHERITON, D. R. An Architecture for Content
[46] SAILER, R., ZHANG, X., JAEGER, T., AND VAN DOORN, L.
Routing Support in the Internet. In Proceedings of the USITS ’01
(San Francisco, CA, Mar. 2001).
[21] GUHA, S., AND FRANCIS, P. Characterization and Measurement of
TCP Traversal through NATs and Firewalls. In Proceedings of the
2005 Internet Measurement Conference (New Orleans, LA, Oct.
2005).
[22] GUHA, S., AND FRANCIS, P. Identity Trail: Covert Surveillance
Using DNS. In Proceedings of 7th Workshop on Privacy Enhancing
Technologies (Ottawa, Canada, June 2007).
[23] HAIN, T. RFC 2993: Architectural Implications of NAT, Nov. 2000.
[24] HAUTAKORPI, J., CAMARILLO, G., PENFIELD, R. F.,
HAWRYLYSHEN, A., AND BHATIA, M. Internet draft:
Requirements from SIP (Session Initiation Protocol) Session Border
Control Deployments, Apr. 2007. Work in progress.
draft-ietf-sipping-sbc-funcs-03.txt.
[25] HUA CHU, Y., RAO, S. G., SESHAN, S., AND ZHANG, H. A case
for end system multicast. IEEE Journal on Selected Areas in
Communications 20, 8 (Oct. 2002), 1456–1471.
[26] HUICI, F., AND HANDLEY, M. An Edge-to-Edge Filtering
Architecture Against DoS. ACM SIGCOMM Computer
Communications Review 37, 2 (Apr. 2007), 41–50.
[27] KEROMYTIS, A. D., MISRA, V., AND RUBENSTEIN, D. SOS:
secure overlay services. SIGCOMM Comput. Commun. Rev. 32, 4
(2002), 61–72.
[28] KOPONEN, T., CHAWLA, M., CHUN, B.-G., ERMOLINSKIY, A.,
KIM, K. H., SHENKER, S., AND STOICA, I. A Data-Oriented (and
Beyond) Network Architecture. In Proceedings of SIGCOMM’07
(Kyoto, Japan, Aug. 2007).
[29] LENNOX, J., WU, X., AND SCHULZRINNE, H. RFC 3880: Call
Processing Language (CPL): A Language for User Control of
Internet Telephony Services, Oct. 2004.
[30] MAHAJAN, R., BELLOVIN, S. M., FLOYD, S., IOANNIDIS, J.,
PAXSON, V., AND SHENKER, S. Controlling High Bandwidth
Aggregates in the Network. ACM Computer Communications
Review 32, 3 (July 2002), 62–73.
[31] MANNIE, E. RFC 3945: Generalized Multi-Protocol Label
Switching (GMPLS) Architecture, Oct. 2004.
[32] MARSHALL, W. RFC 3133: Private Session Initiation Protocol
(SIP) Extensions for Media Authorization , Jan. 2003.
[33] MICROSOFT CORPORATION. UPnP – Universal Plug and Play
Internet Gateway Device v1.01, Nov. 2001.
[34] MIRKOVI ´C, J., PRIER, G., AND REIHER, P. Attacking DDoS at the
Source. In Proceedings of ICNP’02 (Paris, France, Nov. 2002).
[35] MOSKOWITZ, R., AND NIKANDER, P. RFC 4423: Host Identity
Protocol (HIP) Architecture, May 2006.
[36] NG, T. S. E., STOICA, I., AND ZHANG, H. A Waypoint Service
Approach to Connect Heterogeneous Internet Address Spaces. In
Proceedings of USENIX Annual Technical Conference (Monterey,
CA, June 2002).
[37] NISSENBAUM, H. Privacy as Contextual Integrity. Washington Law
Review 79, 1 (Feb. 2004), 119–158.
Design and Implementation of a TCG-based Integrity Measurement
Architecture. In Proceedings of 13th USENIX Security Symposium
(San Diego, CA, Aug. 2004), pp. 223–238.
[47] SAINT-ANDRE, P. RFC 3290: Extensible Messaging and Presence
Protocol (XMPP): Core, Oct. 2004.
[48] STIEMERLING, M., QUITTEK, J., AND TAYLOR, T. MIDCOM
Protocol Semantics, June 2004. Work in progress.
[49] STOICA, I., ADKINS, D., ZHUANG, S., SHENKER, S., AND
SURANA, S. Internet Indirection Infrastructure. In Proceedings of
the SIGCOMM ’02 (Pittsburgh, PA, Aug. 2002).
[50] TECHNICAL SPECIFICATION GROUP CORE NETWORK AND
TERMINALS. 3GPP TS 29.207: Policy control over Go interface,
Sept. 2005.
[51] TRUSTED COMPUTING GROUP. TPM Speciﬁcation Version 1.2.
[52] TSCHUDIN, C., AND GOLD, R. SelNet: A Translating Underlay
Network. Tech. Rep. 2003-020, Uppsala University, Uppsala,
Sweden, Nov. 2001.
[53] VENKATARAMAN, V., FRANCISY, P., AND CALANDRINO, J.
Chunkyspread: Multitree Unstructured Peer-to-Peer Multicast. In
Proceedings of the IPTPS ’06 (Santa Barbara, CA, Feb. 2006).
[54] VERISIGN INC. Security (SSL Certiﬁcates), Communications, and
Information Services.
[55] VIXIE, P., THOMSON, S., REKHTER, Y., AND BOUND, J. RFC
2136: Dynamic Updates in the Domain Name System, Dec. 1997.
[56] VON AHN, L., BLUM, M., HOPPER, N. J., AND LANGFORD, J.
CAPTCHA: Using Hard AI Problems For Security. In Proceedings
of EUROCRYPT’03 (Warsaw, Poland, May 2003).
[57] WALFISH, M., BALAKRISHNAN, H., AND SHENKER, S.
Untangling the Web from DNS. In Proceedings of the NSDI ’04 (San
Francisco, CA, Mar. 2004).
[58] WALFISH, M., STRIBLING, J., KROHN, M., BALAKRISHNAN, H.,
MORRIS, R., , AND SHENKER, S. Middleboxes No Longer
Considered Harmful. In Proceedings of the OSDI ’04 (San
Francisco, CA, Dec. 2004).
[59] WANG, X., AND REITER, M. K. Defending Against
Denial-of-Service Attacks with Puzzle Auctions. In SP ’03:
Proceedings of the 2003 IEEE Symposium on Security and Privacy
(Washington, DC, USA, 2003), IEEE Computer Society, p. 78.
[60] WROCLAWSKI, J. The MetaNet: White Paper. In Proceedings of
Workshop on Research Directions for the Next Generation Internet
(Vienna, VA, May 1997).
[61] YAAR, A., PERRIG, A., AND SONG, D. SIFF: A Stateless Internet
Flow Filter to Mitigate DDoS Flooding Attacks. In IEEE Symposium
on Security and Privacy (Pittsburgh, PA, May 2004), pp. 130– 143.
[62] YANG, X., WETHERALL, D., AND ANDERSON, T. A DoS-limiting
Network Architecture. In Proceedings of the SIGCOMM ’05
(Philadelphia, PA, Aug. 2005).
[63] ZHANG, B., WANG, W., JAMIN, S., MASSEY, D., AND ZHANG,
L. Universal IP multicast delivery. Computer Networks, special
issue on Overlay Distribution Structures and their Applications 50, 6
(Apr. 2006), 781–806.
[38] NORDMARK, E., AND BAGNULO, M. Internet draft: Level 3
[64] ZIMMERMANN, P. R. The ofﬁcial PGP user’s guide. MIT Press,
multihoming shim protocol, Nov. 2006.
draft-ietf-shim6-proto-07.txt. Work in progress.
[39] OPENSSL TEAM. The Open Source toolkit for SSL/TLS.
[40] RAMASUBRAMANIAN, V., AND SIRER, E. G. CoDoNS: The
Design and Implementation of a Next Generation Name Service for
Cambridge, MA, 1995.