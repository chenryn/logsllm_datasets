title:POSTER: X-Ray Your DNS
author:Amit Klein and
Vladimir Kravtsov and
Alon Perlmuter and
Haya Shulman and
Michael Waidner
Poster: X-Ray Your DNS
Amit Klein§, Vladimir Kravtsov§‡, Alon Perlmuter§‡, Haya Shulman§‡ and Michael Waidner§‡
§Fraunhofer Institute for Secure Information Technology SIT
‡The Hebrew University of Jerusalem
ABSTRACT
We design and develop DNS X-Ray which performs analyses of
DNS platforms on the networks where it is invoked. The analysis
identifies the caches and the IP addresses used by the DNS plat-
form, fingerprints the DNS software on the caches, and evaluates
vulnerabilities allowing injection of spoofed records into the caches.
DNS X-Ray is the first tool to perform an extensive analysis of the
caching component on the DNS platforms.
In addition, DNS X-Ray also provides statistics from previous
invocations, enabling networks to check which for popular DNS
software on the caches, the number of caches typically used on
DNS platforms and more.
We set up DNS X-Ray online, it can be accessed via a website
dns.xray.sit.fraunhofer.de.
1 INTRODUCTION
Domain Name System (DNS), [RFC1034, RFC1035], was conceived
in the 80s as a basic lookup functionality. Since then DNS evolved
into a complex ecosystem. It is increasingly utilised to facilitate a
wide range of applications and constitutes an important building
block in the design of scalable network architectures. Nowadays
DNS resolution platforms are typically composed of multiple IP
addresses and caches, which may be hosted on different networks
and operated by different entities. The configuration, software and
location of these components has direct impact on the security
and performance of networks. In practice, network operators often
have only a vague knowledge of the configuration of their DNS
platforms, on the devices that are connected, the number of caches
used, the operating systems (OSes) and DNS software (SW) that
they are running, in which networks and Internet Service Providers
(ISPs) the resolving machines are hosted, and more. Understanding
the inner workings of DNS is important also for design of defences
for DNS and mechanisms that utilise DNS, e.g., client subnet in
DNS queries [RFC7871].
Measuring DNS Platforms. Due to the significance of DNS
and its increasing complexity, the research and operational commu-
nities invest considerable efforts to study the DNS infrastructure;
see Related Work, Section 2. [9] measured the client side of the DNS
infrastructure of open resolvers, in order to identify the hosts that
communicate with the clients and nameservers in DNS lookups.
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the owner/author(s).
CCS ’17, October 30-November 3, 2017, Dallas, TX, USA
© 2017 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-4946-8/17/10.
https://doi.org/10.1145/3133956.3138821
Recently [6] studied vulnerabilities in caches to injection of spoofed
records. [5] devised approaches for measuring the internal compo-
nents of DNS infrastructure. We build upon the methodologies for
studying the DNS platforms presented in [5] to design and imple-
ment a tool we call DNS X-Ray for evaluation of DNS resolution
platforms. We create a webpage through which DNS X-Ray can be
accessed and invoked dns.xray.sit.fraunhofer.de, and upon invoca-
tion it analyses the DNS platform on the network on which it is run.
During the analysis, DNS X-Ray identifies different components
on the platform and discovers and characterises the DNS caches,
including the DNS software on the caches, and the vulnerabilities
in the caches that allow injection of DNS records.
DNS X-Ray also provides statistics of all the DNS platforms
on which it was evaluated. Therefore, clients obtain information
not only about the DNS platforms on their networks but can also
compare the results to the other platforms in the Internet.
The challenge with studying the caches is that the caches cannot
be directly accessed neither by the clients nor by the nameservers,
and all the communication with the caches is performed via the
ingress and egress resolvers on DNS platforms (see Figure 1). In
addition, there are also intermediate caches, such as those in the
operating systems or in browsers, we also explain how DNS X-Ray
bypasses the intermediate caches.
DNS X-Ray also identifies all the IP addresses used by the tested
DNS platform, which networks and ISPs host the DNS platform, and
also checks for adoption of best security practices, see [RFC5452],
such as whether the ports’ and transaction identifiers (TXIDs) are
securely selected, and if the caches are vulnerable to injection of
spoofed records. This enables security experts as well as non ex-
perts to learn about the misconfigurations or vulnerabilities on
their networks and allows network and security researchers to ob-
tain insights into DNS resolution platforms in different networks
and countries. We make the DNS X-Ray tool as well as the statis-
tics available at use dns.xray.sit.fraunhofer.de. Furthermore,
DNS X-Ray tool is the first to enable an in depth study of the caching
component on DNS platforms. It improves the current understand-
ing of the DNS resolution platforms and serves as a building block
for further research on DNS performance and security.
DNS Resolution Platforms. DNS X-Ray studies complex as
well as simple DNS platforms; a general model for DNS resolution
platforms is illustrated in Figure 1. The platform consists of a set
(232−x ) of ingress IP addresses which handle DNS queries from the
clients, a set of n caches, and a set (232−y) of egress IP addresses,
which communicate with the nameservers if the queries from the
clients cannot be satisfied from (one of) the caches.
This infrastructure corresponds to complex platforms such as
Google Public DNS, and it can also be abstracted to incorporate a
very simple version for a DNS resolution platforms with a single IP
PosterCCS’17, October 30-November 3, 2017, Dallas, TX, USA2519Figure 1: DNS X-Ray and DNS platforms.
address which performs both the ingress and egress functionalities
and uses a single cache.
2 RELATED WORK
Recently, Schomp et al [9], measured the client side of the DNS
infrastructure of open recursive resolvers, in order to identify the
different hosts that participate in DNS lookups. Their study fo-
cused only on IP addresses that communicate either with the name
servers or the clients and does not go deeper into the caching com-
ponents and the mapping between the IP addresses and the caches.
DNS X-Ray provides insights into the caching component and its
interaction with the other components in DNS platforms.
A number of other studies were conducted on open resolvers,
e.g., [7, 10], where the IPv4 address block is scanned for hosts
responding to requests on port 53. However, recently it was shown
by [2, 15] that most such open resolvers are either (misconfigured)
home routers and mismanaged (security oblivious) networks or
malicious networks operated by attackers (where the open DNS
resolver is set up for malware communication to the command
and control servers). Our study focuses on studying the internal
structures of DNS platform, fingerprinting the software of DNS
caches, evaluating vulnerabilities to cache injection (by overwriting
cached records with new values), and other properties of DNS
resolvers.
To optimise content distribution networks (CDNs) [11] ran a
study associating DNS resolvers with their clients, and also de-
signed approaches to fingerprint the DNS software passively (on
DNS traces). Their study was performed on a limited set of DNS
software (Bind9, Mac OS X and Microsoft) using nslookup and trac-
ing the queries’ pattern issued by the resolver in the lab. This work
was extended by [1], which fingerprinted a limited set of DNS soft-
ware (Bind, Unbound and Microsoft) but also without using active
fingerprinting methods in the wild. Both works [1, 11] use flags and
fields in DNS header (incl. CD, DO, to EDNS and CNAME chains),
and patterns in DNS queries to fingerprint DNS software; exam-
ple patterns include the maximal queried length of CNAME chains,
presence of requests for AAAA (following requests for A records).
Turning DNSSEC (DO bit in EDNS) and IPv6 off would prevent
them from distinguishing between different resolvers’ software.
Prior work, [14], also used server selection mechanism to per-
form an in lab fingerprint of resolver software of DNS software,
Bind, PowerDNS, Unbound, DNSCache, MicrosoftDNS. The name-
server selection allows to characterise the software used by the
egress DNS resolver. Server selection behaviour can be modified in
the configuration file by adjusting the target-fetch-policy to 0 0 0
0 0 in Unbound. This will cause the resolver not to fetch additional
nameservers and to use only one.
In contrast to previously proposed approaches DNS X-Ray allows
repetitive and evaluation of networks, identifies a wide range of
DNS software, and can detect vulnerabilities in caches it has not
modelled before.
A study by [8] suggested to remove the DNS resolution platforms,
and to leave the resolution to end hosts, arguing that the overhead
on the existing end hosts would not be significant. Our study can
be used for analysis of the complexity of the caching component
and the impact on the networks if it were removed.
DNS cache poisoning attacks exploit vulnerabilities in caches to
inject spoofed records [3, 4, 12].
Also relevant to our research are online tools for measuring the
zone configuration in the nameservers and tools for measuring