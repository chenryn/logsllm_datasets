User: 请解答这个和日志有关的问题SELINUX disturb PHP7 to work fine I am using a Server with Centos 7 and nginx, PHP5.4. I host Magento and everthing works well. And now I just remove the PHP5.4 which is installed and I install PHP7 and I also change everything what is needed

listen = /var/run/php-fpm/php-fpm.sock
listen.owner = nginx 
listen.group = nginx
user = nginx 
group = nginx


I also set the SELINUX with setenforce 0 to permissive. I have to note that when I install the PHP5.4 I have to follow that Tutorial https://www.cloudinsidr.com/content/troubleshooting-php-7-tcp-sockets-with-selinux-on-centos-7-rhelfedora/ to get php-fpm work otherwise I got a forbidden error.

Now after installing PHP7 and change everything what is needed I get an error if I run 

sudo  cat /var/log/nginx/error.log

2016/08/10 13:15:54 [alert] 2118#2118: setrlimit(RLIMIT_NOFILE, 100000) failed (1: Operation not permitted)


on Frontend is a 502 Bad Gateway.
So I thought that it could be the same problem like PHP5.4 so I do that Tutorial again. and nothing still the same problem.

Note

I don't changed any folder or file permissions. So where is the problem?

Thanks

Assistant: SELinux sucks hugely.

But unless you know exactly what you are doing I would not recommend disabling it / running as non-enforcing for any length of time. 


  where is the problem?


While you could take a few months out to learn how SELinux and the Redhat type enforcement policy is supposed to work (we'll skip over the fact it doesn't always work that way) I expect you're looking for a quicker solution.

Instead:


offer up a small blood sacrifice to the NSA and Redhat's SELinux maintainers
relabel everything (touch /.autorelabel ; reboot) 
Set it to non-enforcing via the command line (setenforcing 0)
try to regression test all the functionality of your system
create a policy for the exceptions with audit2allow
enable the policy
sent enforcing on again
repeat steps above at regular intervals


Or reformat your server, install OpenSuse or Ubuntu and use Apparmor instead.