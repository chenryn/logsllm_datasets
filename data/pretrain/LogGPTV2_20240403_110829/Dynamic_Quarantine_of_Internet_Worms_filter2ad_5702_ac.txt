within subnets at the edge router for local preferential
and random propagation worms.
Rate limiting (RL) for local preferential worms at end hosts and backbone
1
d
e
t
c
e
f
n
i
s
e
d
o
n
f
o
e
g
a
t
n
e
c
e
r
P
0.8
0.6
0.4
0.2
0
0
No RL random propagation
5% End Host RL
30% End Host RL
Backbone RL
5
10
15
20
25
Time
Figure 6. Simulation of rate limiting across subnets for
local preferential worms at the end hosts and backbone
routers.
yields a 50% slowdown. Clearly, edge router based rate lim-
iting is more effective in suppressing random propagation
worms as opposed to worms that propagate via local prefer-
ential connections. These results also conﬁrm our analytical
model described in Section 5.2. Figure 6 shows the simu-
lated propagation for local preferential worms for both host-
and backbone-router-based rate limiting across subnets. As
shown, even with a 30% deployment of rate limiting mech-
anisms at the end hosts there is negligible difference when
compared to no rate limiting. Deploying rate limiting ﬁlters
on the backbone routers, as shown in Figure 6, is substan-
tially more effective.
6. The effect of dynamic immunization
Thus far in our analysis we have ignored the effect of
patching and dynamic immunization. Clearly, the infection
progress will be hampered when the exploited vulnerabili-
ties are patched (immunized) dynamically. In this section,
we examine dynamic immunization and its effect on rate
limiting.
The immunization model we consider here assumes that
the immunization process starts at time d, after a certain per-
centage of hosts are infected. Thereafter, in each time inter-
val, each susceptible host will be patched with probability
µ. The following differential equations model the dynam-
ics of the worm propagation in the presence of immuniza-
tion:
dI
dt
= Iβ
N − I
N
N − I
, when t ≤ d
− Iµ, when t > d
dI
dt
= Iβ
N
= −µN, when t > d
Solving the above equations gives us,
dN
dt
= eβt
c + eβt when t ≤ d
I
N0
= e(β−µ)(t−d)
c0 + eβ(t−d)
, when t > d
I
N0
where N0 denotes the initial number of susceptible hosts.
Figure 7(a) shows a plot of the equations. We also con-
ducted simulations of delayed immunization on a synthetic
1000-node power-law graph with d = 20%, 50%, and 80%
infection (nodes infected) with β = 0.8 and µ = 0.1. The re-
sults are shown in Figure 8(a). Clearly, the earlier immu-
nization takes place, the more effective it is. In Figure 8(a),
immunization starting at 20% infection yielded a total in-
fected population of 80% of the nodes, as opposed to 90%
infected when immunizing at 50% and 98% infected at
80%.
We note that the assumption of a constant probability of
immunization, denoted by µ, is not completely realistic. In
reality, the probability of immunization may increase as the
worm spreads and as the vulnerability it exploits becomes
widely publicized. Similarly, the probability of immuniza-
tion may decrease as the infection becomes a rarer occur-
rence, i.e., on its way to extinction. We believe that the rate
of immunization observes a bell curve. However, the exact
shape of such a curve is not easily obtainable and we lack
data to conﬁrm the rate of immunization. Therefore in this
paper we use the simple assumption of immunization at a
constant rate.
6.2. Rate control with dynamic immunization
In this section we examine the effect of delayed immu-
nization with rate limiting. We focus on the case of rate
limiting at backbone routers (since that is the most effec-
tive strategy according to the analysis in Section 5). Assum-
ing the ﬁrst instance of immunization occurs at time d, the
Proceedings of the 2004 International Conference on Dependable Systems and Networks (DSN’04) 
0-7695-2052-9/04 $ 20.00 © 2004 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 10:03:30 UTC from IEEE Xplore.  Restrictions apply. 
Analytical Model for delayed immunization
Simulation for delayed immunization
No immunization
Immunization at 20%
Immunization at 50%
Immunization at 80%
1
0.8
0.6
0.4
0.2
d
e
t
c
e
n
f
i
s
e
d
o
n
f
t
o
e
g
a
n
e
c
r
e
P
0
0
10
20
30
40
Time
50
60
70
80
(a) Analytical model of infection evolution for delayed
immunization
Analytical Model for delayed immunization with rate limiting
No immunization
Immunization at 6th timetick
Immunization at 8th timetick
Immunization at 10th timetick
1
0.8
0.6
0.4
0.2
d
e
t
c
e
f
n
i
s
e
d
o
n
f
o
e
g
a
t
n
e
c
r
e
P
0
0
5
10
15
20
30
35
40
45
50
25
Time
d
e
t
c
e
f
n
i
r
e
v
e
s
e
d
o
n
f
o
e
g
a
t
n
e
c
r
e
p
l
a
t
o
T
d
e
t
c
e
f
n
i
r
e
v
e
s
e
d
o
n
f
o
e
g
a
t
n
e
c
r
e
p
l
t
a
o
T
1
0.8
0.6
0.4
0.2
0
0
5
10
15
20
No Immunization
Immunization at 20%
Immunization at 50%
Immunization at 80%
30
35
40
45
50
25
Time
(a) Simulated total infected population for delayed
immunization
Simulation for delayed immunization with rate limiting
1
0.8
0.6
0.4
0.2
0
0
No Immunization
Immunization at 6th timetick
Immunization at 8th timetick
Immunization at 10th timetick
5
10
15
20
25
Time
30
35
40
45
50
(b) Analytical model of infection evolution for delayed
(b) Simulated total infected population for delayed
immunization with rate limiting
immunization with rate limiting
Figure 7. Analytical Models (with and without rate lim-
iting) for delayed immunization on a 1000-node power-
law graph
Figure 8. Simulations of delayed immunization (with
and without rate limiting) on a 1000-node power-law
graph
growth of the infection with delayed immunization and rate
control at the backbone routers is as follows:
= Iβ(1 − α)(N − I)/N + δ(N − I)/N, when t ≤ d
= Iβ(1−α)(N−I)/N +δ(N−I)/N−µI, when t > d
dI
dt
dI
dt
dN
dt
= −µN, when t > d
where β is the contact rate of one infected host, δ =
min(Iβα, rN/232), r is the average overall allowable rate
of the routers with rate limiting control and α is the per-
centage of paths that have rate limited links. When r is rel-
atively small, the solution can be approximated as
I
N0
= e(γ−µ)(t−d)
c0 + eγ(t−d)
= eγt
c + eγt when t ≤ d,
, when t > d, where γ = β(1 − α)
I
N0
We also conducted simulations of delayed immuniza-
tion with rate limiting on a synthetic 1000-node power-law
graph with β = 0.8 and µ = 0.1. Since the goal here is
to identify the beneﬁts of rate limiting, the timeticks cho-
sen in both analytical and simulation are the timeticks at
which immunization started in our analytical model for de-
layed immunization without rate limiting (e.g. for immu-
nization starting at 20%, our analytical model shows that it
should happen around the 6th timetick). Figure 7(b) plots
the analytical model and Figure 8(b) plots the simulated re-
sults of delayed immunization with rate limiting. The plots
show exactly how immunization delays in combination with
rate limiting at the backbone affects the infection propaga-
tion. Recall that in Figure 8(a), immunization at 20% with
no rate limiting results in a total infected population of 80%.
Figure 8(b) shows a similar experiment with the same sim-