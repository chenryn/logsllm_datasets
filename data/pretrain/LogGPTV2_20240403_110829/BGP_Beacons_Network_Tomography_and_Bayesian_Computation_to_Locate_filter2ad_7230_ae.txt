Very little work in this large literature considers MCMC ap-
proaches. The only approach that has been trialled is Gibb’s sam-
pling, e.g., [14, 29] a special case of Metropolis Hastings. Both
[14, 29] applied the additional condition of sparsity, i.e., that the
network measurements should be explained by larger loss at a few
places, rather than small losses spread across the network. Both
[14, 29] only considered trees in detail (on trees the sparsity has the
nominally beneficial impact of forcing loss higher in the tree, aiding
in the diagnosis problem). In our setting, sparsity is not always true
(see AS origin validation) and we measure across general graphs
not just trees. It is worth noting that piecing together trees would
be a non-trivial component of the prior work, so a comparison
would not actually be against the prior approaches, and thus is out
of scope in this work.
Binary (or Boolean) Network Tomography aims to classify
links as “good” or “bad,” a simpler and more practical inference in
some cases [2, 3, 14, 28, 29]. More recently binary tomography was
applied to general networks to find censoring ASs by formulating
the problem using logical constraints as SAT [10]. This approach
has advantages: it can use the large body of work on solving SAT,
but it should be noted that the SAT problem so created can (i) have
many solutions, requiring some means to choose one, or (ii) can
have zero solutions in the case of measurement noise. Our approach
aims for a middle ground between earlier probabilistic approaches
with the large body of assumptions and limitations they brought,
and the more practical binary tomography. We aim to ascertain
if an AS has a particular property (though unlike typical binary
tomography having a property is not intrinsically bad or rare).
However, concomitant with that inference, we desire to allow for
the possibility of partial properties, and to provide a measure of
uncertainty of the inference. Binary tomography, by itself does not
typically allow such.
We did not compare to binary approaches as they cannot derive
meaningful results in scenarios of inconsistent deployment. SAT
would lead to zero valid solutions, based on our data. AS 701 is one
concrete example in the current Internet, which damps routes on
some paths and does not on others (see § 5.1).
Despite some limitations practical network tomography instan-
tiations have been built [20, 39] showing that methods such as that
proposed here can be scaled to create useful systems for networks
as a whole.
Heuristic Approaches: There have also been multiple studies
which attempted to pinpoint another behavior—the origin a routing
changes—using heuristics [7, 18]. These are tenuously related to
this work in the nature of the task being attempted. Closer is a
prototype [9], that tries to find the reason for a missing route.
However, their approach does not investigate the exact reasons for
the unreachability (they state that misconfigured RFD was one of
the possible explanations). Closer still is [27], which considers the
general problem of inferring AS properties. Other papers also aimed
at this, but most have presumed an atomic model of ASs, i.e., that
each AS has a deterministic behavior. A major difference between
our work and these is that we perform controlled experiments using
Beacons, rather than relying on natural churn.
BGP Beacons, Network Tomography, and Bayesian Computation
IMC ’20, October 27–29, 2020, Virtual Event, USA
Locating ASs that deploy route filtering based on RPKI attracted
recently attention. Gilad et al. [21] locate route divergences between
invalid and valid prefix announcements and infer RPKI deployment
based on that. Testart et al. [41] presented another heuristic assum-
ing that vantage points which provide a full feed export less invalid
announcements if they deploy filtering. Both approaches imple-
ment uncontrolled experiments and thus are prone to false positives,
e.g., because of traffic engineering and incorrectly configured RPKI
data. Reuter et al. [32] introduced controlled, active experiments to
precisely pinpoint ASs that deploy RPKI filtering. This, however,
requires a strict measurement setup, i.e., direct peering between
the experiment AS and vantage point.
9 CONCLUSION AND OUTLOOK
We presented BeCAUSe, an algorithmic framework to infer network
properties. In contrast to heuristic methods, which are commonly
applied to tackle this challenge, our proposal does neither make
restrictions on the topology setup nor does it require specific par-
ticipation of the network elements under investigation, except their
usual packet forwarding. The underlying features are two Bayesian
computation techniques, which allow for rigorous network tomog-
raphy.
We demonstrated BeCAUSe to pinpoint autonomous systems
that deploy route flap damping and route origin validation. To
the best of our knowledge, route flap damping was not measured
before on global scale. We uncovered that at least 9% measured
ASs use RFD, of which ≈ 60% rely on deprecated, harmful ven-
dor default configurations. We compared BeCAUSE with different
heuristics, which exhibit less precission and recall. Most impor-
tantly, in contrast to heuristics, BeCAUSe is not designed for a
specific pinpointing use case but a generic framework. BeCAUSe
can help researchers also measuring deployment of RPKI-based
filtering as we showed. Tracking down censorship or other similar
topics might be application scenarios in the future.
We believe that a better understanding of operational practices
can improve the Internet in the long term. We presented our results
to the operators at RIPE 80 to raise awareness about the surprising
usage of deprecated RFD parameters. Analyzing changes will be
part of our future work.
With the data set that we provide, verified by ground truth,
we hope to stimulate further discussions on the implications of
suppressed routes on Internet measurements.
A Note on Reproducibility. We explicitly support reproducible
research. All artifacts are available on https://rfd.rg.net.
ACKNOWLEDGMENTS
We would like to thank the anonymous reviewers and our shep-
herd Dave Choffnes for their valuable feedback. We also gratefully
acknowledge the operators and RIPE that provide us infrastructure
and Internet resources to conduct our experiments.
Caitlin Gray and Matthew Roughan were partially supported by
the ARC Centre of Excellence for Mathematical and Statistical Fron-
tiers (grant CE140100049). Caitlin Gray acknowledges the financial
support of Data to Decisions CRC and CSIRO’s Data61. Clemens
Mosig, Thomas Schmidt, and Matthias Wählisch were partially sup-
ported by the German Ministry of Education and Research (grant
X-Check).
504
7454. IETF.
REFERENCES
[1] Ruwaifa Anwar, Haseeb Niaz, David Choffnes, Ítalo Cunha, Phillipa Gill, and
Ethan Katz-Bassett. 2015. Investigating Interdomain Routing Policies in the Wild.
In Proc. of ACM IMC. ACM, New York, NY, USA, 71–77.
[2] P. Barford, N. Duffield, A. Ron, and J. Sommers. 2009. Network Performance
Anomaly Detection and Localization. In Prof. of IEEE INFOCOM. IEEE Press,
Piscataway, NJ, USA, 1377–1385.
[3] A. Batsakis, T. Malik, and A. Terzis. 2005. Practical Passive Lossy Link Inference.
In Proc. of PAM (LNCS, Vol. 3431). Springer–Verlag, Berlin, Heidelberg, 362–367.
[4] Steve Brooks, Andrew Gelman, Galin Jones, and Xiao-Li Meng (Eds.). 2011. Hand-
book of Markov Chain Monte Carlo. CRC Press, Boca Raton, FL, USA.
[5] Randy Bush, Cristel Pelsser, Mirjam Kuhne, Olaf Maennel, Pradosh Mohapatra,
Keyur Patel, and Rob Evans. 2013. RIPE Routing Working Group Recommendations
on Route Flap Damping. RIPE Document ripe-580. RIPE.
[6] R. Cáceres, N.G. Duffield, J. Horowitz, and D. Towsley. 1999. Multicast-based
inference of network-internal loss characteristics. IEEE Trans. in Information
Theory 45, 7 (1999), 2462–2480.
[7] Matthew Caesar, Lakshminarayanan Subramanian, and Randy H. Katz. 2003.
Towards Localizing Root Causes of BGP Dynamics. Technical Report UCB/CSD-
03-1292. EECS Department, University of California, Berkeley.
http://
www2.eecs.berkeley.edu/Pubs/TechRpts/2003/6364.html
[8] Rui Castro, Mark Coates, Gang Liang, Robert Nowak, and Bin Yu. 2004. Network
Tomography: Recent Developments. Statist. Sci. 19, 3 (2004), 499–517.
[9] Di-Fa Chang, Ramesh Govindan, and John Heidemann. 2004. Locating BGP
Missing Routes Using Multiple Perspectives. In Proc. of the ACM SIGCOMM
Workshop on Network Troubleshooting: Research, Theory and Operations Practice
Meet Malfunctioning Reality (NetT). ACM, New York, NY, USA, 301–306.
[10] Shinyoung Cho, Rishab Nithyanand, Abbas Razaghpanah, and Phillipa Gill. 2017.
A Churn for the Better: Localizing Censorship using Network-level Path Churn
and Network Tomography. In Proc. of ACM CoNext. ACM, New York, NY, USA,
81–87.
[11] Cloudflare. 2020. Is BGP safe yet? https://isbgpsafeyet.com/.
[12] M. Coates and R. Nowak. 2000. Network loss inference using unicast end-
to-end measurements. In Proc. of ITC Specialist Seminar on IP Traffic Mea-
surement, Modeling and Managemen. Monterey, CA, 28–1–28–9.
Preprint
https://hdl.handle.net/1911/19810.
[13] Simon Duane, A.D. Kennedy, Brian J. Pendleton, and Duncan Roweth. 1987.
Hybrid Monte Carlo. Physics Letters B 195, 2 (1987), 216 – 222.
[14] N. Duffield. 2006. Network Tomography of Binary Network Performance Char-
acteristics. IEEE Transactions on Information Theory 52, 12 (2006), 5373–5388.
[15] N.G. Duffield, J. Horowitz, F. Lo Presti, and D. Towsley. 2002. Multicast topology
inference from measured end-to-end loss. IEEE Transactions in Information Theory
48, 1 (2002), 26–45.
[16] N.G. Duffield, F. Lo Presti, V. Paxson, and D. Towsley. 2001. Inferring link loss
using striped unicast probes. In Proc. of IEEE Infocom. IEEE Press, Piscataway, NJ,
USA, 22–26.
[17] J. Durand, I. Pepelnjak, and G. Doering. 2015. BGP Operations and Security. RFC
[18] Anja Feldmann, Olaf Maennel, Z. Morley Mao, Arthur Berger, and Bruce Maggs.
2004. Locating Internet Routing Instabilities. In Proc. of ACM SIGCOMM. ACM,
New York, NY, USA, 205–218.
[19] Romain Fontugne, Esteban Bautista, Colin Petrie, Yutaro Nomura, Patrice Abry,
Paulo Gonçalves, Kensuke Fukuda, and Emile Aben. 2019. BGP Zombies: An
Analysis of Beacons Stuck Routes. In Proc. of PAM Conf. (LNCS, Vol. 11419).
Springer, Berlin Heidelberg, 197–209.
[20] D. Ghita, H. Nguyen, M. Kurant, K. Argyraki, and P. Thiran. 2010. Netscope:
Practical Network Loss Tomography. In Proc. of IEEE INFOCOM. IEEE Press,
Piscataway, NJ, USA, 1–9.
[21] Yossi Gilad, Avichai Cohen, Amir Herzberg, Michael Schapira, and Haya Shulman.
2017. Are We There Yet? On RPKI’s Deployment and Security. In Proc. of NDSS.
ISOC, Reston, USA, 15.
[22] W. K. Hastings. 1970. Monte Carlo Sampling Methods Using Markov Chains and
Their Applications. Biometrika 57, 1 (1970), 97–109.
[23] IIT-CNR. 2020. Isolario Project. https://www.isolario.it/.
[24] Zhuoqing Morley Mao, Ramesh Govindan, George Varghese, and Randy H. Katz.
2002. Route Flap Damping Exacerbates Internet Routing Convergence. In Proc.
of ACM SIGCOMM. ACM, New York, NY, USA, 221–233.
[25] Nicholas Metropolis and S. Ulam. 1949. The Monte Carlo Method. J. Amer. Statist.
Assoc. 44, 247 (1949), 335–341. http://www.jstor.org/stable/2280232
[26] P. Mohapatra, J. Scudder, D. Ward, R. Bush, and R. Austein. 2013. BGP Prefix
Origin Validation. RFC 6811. IETF.
[27] W. Mühlbauer, A. Feldmann, O. Maennel, M. Roughan, and S. Uhlig. 2006. Building
an AS-topology model that captures route diversity. In Proc. of ACM SIGCOMM.
ACM, New York, NY, USA, 195–206.
IMC ’20, October 27–29, 2020, Virtual Event, USA
C. Gray, C. Mosig et al.
4271. IETF.
rawdata.html
[28] H.X. Nguyen and P. Thiran. 2007. The Boolean Solution to the Congested IP Link
Location Problem: Theory and Practice. In Proc. of IEEE INFOCOM. IEEE Press,
Piscataway, NJ, USA, 2117–2125.
[29] Venkata N. Padmanabhan, Lili Qiu, and Helen J. Wang. 2002. Passive network
tomography using Bayesian inference. In Proc. of ACM Internet Measurement
Workshop. ACM, New York, NY, USA, 93–94.
[30] Cristel Pelsser, Olaf Maennel, Pradosh Mohapatra, Randy Bush, and Keyur Patel.
2011. Route Flap Damping Made Usable. In Proc. of PAM Conf. (LNCS, Vol. 6579).
Springer, Berlin Heidelberg, 143–152.
[31] Y. Rekhter, T. Li, and S. Hares. 2006. A Border Gateway Protocol 4 (BGP-4). RFC
[32] Andreas Reuter, Randy Bush, Italo Cunha, Ethan Katz-Bassett, Thomas C. Schmidt,
and Matthias Wählisch. 2018. Towards a Rigorous Methodology for Measuring
Adoption of RPKI Route Validation and Filtering. ACM Sigcomm Computer
Communication Review 48, 1 (January 2018), 19–27.
[33] RIPE 2020. Routing Information Service (RIS). http://www.ripe.net/projects/ris/
[34] RIPE NCC. 2020. Current RIS Routing Beacons. https://www.ripe.net/analyse/
internet-measurements/routing-information-service-ris/current-ris-routing-
beacons.
[35] Christian P. Robert and George Casella. 2005. Monte Carlo Statistical Methods
(Springer Texts in Statistics). Springer-Verlag New York, Inc., Secaucus, NJ, USA.
[36] Matthew Roughan, Walter Willinger, Olaf Maennel, Debbie Perouli, and Randy
Bush. 2011. 10 Lessons from 10 Years of Measuring and Modeling the Internet’s
Autonomous Systems. IEEE Journal on Selected Areas in Communications 29, 9
(2011), 1810–1821.
[37] Brandon Schlinker, Todd Arnold, Italo Cunha, and Ethan Katz-Bassett. 2019.
PEERING: Virtualizing BGP at the Edge for Research. In Proc. of ACM CoNEXT.
ACM, New York, NY, USA, 51–67.
[38] Philip Smith and Christian Panigl. 2006. RIPE Routing-WG Recommendation For
Coordinated Route-flap Damping Parameters. RIPE Document ripe-378. RIPE.
[39] Joel Sommers, Paul Barford, Nick Duffield, and Amos Ron. 2007. Accurate
and Efficient SLA Compliance Monitoring. In Proc. of ACM SIGCOMM (Kyoto,
Japan). Association for Computing Machinery, New York, NY, USA, 109–120.
https://doi.org/10.1145/1282380.1282394
[40] Florian Streibelt, Franziska Lichtblau, Robert Beverly, Anja Feldmann, Cristel
Pelsser, Georgios Smaragdakis, and Randy Bush. 2018. BGP Communities: Even
More Worms in the Routing Can. In Proceedings of the Internet Measurement
Conference 2018. ACM, New York, NY, USA, 279–292.
[41] Cecilia Testart, Philipp Richter, Alistair King, Alberto Dainotti, and David Clark.
2020. To Filter or Not to Filter: Measuring the Benefits of Registering in the
RPKI Today. In Proc. of PAM Conf. (LNCS, Vol. 12048). Springer, Berlin Heidelberg,
[42] University of Oregon. 2017. Route Views Project. http://www.routeviews.org/.
[43] C. Villamizar, R. Chandra, and R. Govindan. 1998. BGP Route Flap Damping. RFC
71–87.
2439. IETF.
A ETHICS
When performing active BGP measurements one needs to avoid
impacting real-world operations. As we are sending many BGP Up-
dates, especially when high update burst rates are active, we need
to make sure that our Beacons do not overwhelm other routers.
In the first measurement period, we caused 0.48% of all IPv4 con-
trol plane traffic seen in RIPE RIS, RouteViews, and Isolario data,
whereas in the second period our Beacon caused 0.54% of all IPv4
BGP updates. Interestingly, the prefixes oscillating every minute
were still causing a lot fewer updates than other prefixes on the
Internet. As an example, we picked March 1th and measured how
many announcements belonged to each prefix. We found ≈ 50 pre-
fixes causing 3 times as many updates as one of our Beacon prefixes
and 4 prefixes caused 17 times more updates individually than one
of our Beacon prefixes.
B RFD DEFAULT PARAMETERS
RFD parameter
Withdrawal penalty
Readvertisement penalty
Attributes change penalty
Suppress-threshold
Half-life (min)
Reuse-threshold
Max suppress time (min)
Cisco
1000
0
500
2000
15
750
60
Juniper RFC 7454
1000
1000
500
3000
15
750
60
1000
0/1000
500
6000
15
750
60
505