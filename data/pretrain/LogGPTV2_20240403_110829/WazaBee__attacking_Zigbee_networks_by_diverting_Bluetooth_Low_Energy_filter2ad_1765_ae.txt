company in order to carry out a complex attack when the
device is within range of the company’s Zigbee network.
Our attack was performed on a commercial BLE tracker
device, called Gablys Lite, which is based on a nRF51822
chip. It requires a physical access to the device, as we used
some unprotected debug pins providing a Serial Wire Debug
(SWD) to ﬂash a new ﬁrmware. Note that a similar attack
could be performed using BLE vulnerabilities such as OTA
updates abuse, which do not require this physical access.
The nRF51822 chip is similar to nRF52832, but it doesn’t
support LE 2M, which is a key requirement of WazaBee attack.
However, as the Enhanced ShockBurst protocol at 2 Mbits/s
is supported by the chip, it can be used as an alternative for
LE 2M physical layer. This solution has a direct impact on the
reception quality, but it is sufﬁcient to successfully conduct a
complex active attack.
The main goal of this attack is to perform a denial of service
targeting the sensor, in order to spoof it and inject fake data
into the display interface. We used an existing attack targeting
XBee nodes in order to perform a denial of service, allowing to
inject a new conﬁguration through remote AT commands [28].
The attack is divided into four main steps:
• Active scanning: the device transmits a Beacon Request
on a channel and waits for a Beacon from the coordinator.
If no Beacon is received before the timeout expires, the
device selects the next channel. If a Beacon is received,
the channel, the PanID and the coordinator’s address are
collected and saved,
• Eavesdropping:
the device sniffs the legitimate frames
in order to collect the sensor’s address,
• Remote AT command injection: the device forges a
remote AT command, using coordinator’s address as
source and sensor’s address as destination. It allows to
force the sensor to use another channel,
• Fake data injection: the device transmits fake data
frames, mimicking the sensor’s behaviour.
This attack was implemented successfully, as illustrated in
ﬁgure 5. This experiment shows that WazaBee’s primitives
can be combined to conduct complex attack scenarios, and
also that a legitimate commercial device can be modiﬁed and
used to perform this kind of offensive strategies.
Fig. 5: Complex attack workﬂow from a BLE tracker
D. Conclusion
The two attack scenarios illustrated in the previous sub-
sections are not exhaustive, but
they illustrate the critical
impact of WazaBee attack, and especially the considerable
number of legitimate devices that may be diverted in order to
attack 802.15.4 networks. Depending on the corrupted device
and the privilege level gained, an attacker may be able to
implement the two primitives or only a subset of WazaBee
attack. However, scenario A underlines the fact
that even
with a partial
implementation, an attacker would be able
to achieve interesting objectives, such as leaking sensitive
data or disrupting legitimate nodes. These offensive strategies
could also be combined in order to perform complex attack
scenarios. Finally, these two scenarios also underline that the
attack is easy to implement on various devices and may be
used easily in the wild.
VII. COUNTER-MEASURES
WazaBee attack is inherent to the wireless protocols and
their modulations, even if some conditions need to be fulﬁlled
to be implemented on some speciﬁc chips. As a consequence,
we should consider every BLE 5 device as potentially vulner-
able and the environments exposed to BLE devices should be
designed and monitored with the assumption that some attacks
could potentially be carried out through 802.15.4 networks.
Several counter-measures could be investigated either to limit
the impact of the attack, or to prevent or detect it.
As explained in section IV-D, the practical implementation
of WazaBee requires controlling some features of the BLE
chips. Making it difﬁcult or impossible for an attacker to
control these features (such as the deactivation of the CRC or
the setting of a precise channel frequency), by chip manufac-
turers, would complicate the task of the attacker, and especially
the implementation of the reception primitive. However, such
counter-measures should only be considered as a ﬁrst barrier
for an attacker and not as efﬁcient adequate solutions, as
illustrated in our scenario A which only uses an high level
API in order to implement the transmission primitive.
Some other common counter-measures, such as crypto-
graphic techniques, that most of the 802.15.4-based protocols
provide, should be systematically used. If these techniques
are implemented, even if the WazaBee attack is still possible,
the task of the attacker would be much more complicated.
Unfortunately, the correct implementation of these counter-
measures is not trivial and it highly depends on the protection
of the keys. Note that some known attacks [29] aiming at
breaking the 802.15.4 encryption can be performed using
WazaBee and also that the attacker can still perform denial
of service attacks [30].
Finally, some defensive solutions dedicated to the IoT con-
text, to monitor and detect in real time attacks targeting wire-
less protocols, can also be considered. Indeed, the existence of
such offensive strategies motivates the deployment of intrusion
and prevention detection systems based on the analysis of radio
communications. Such systems could simultaneously monitor
multiple wireless protocols (even those which are not deployed
in the legitimate environment) such as the solution proposed
in [31], or could be protocol agnostic, such as the intrusion
detection approaches proposed in [32], [33]. These intrusion
detection systems are designed to monitor the physical layers
of communication protocols (by monitoring signal strength
on different frequency bands) and are based on the modeling
of legitimate communications and therefore detect accidental
faults (in [33]) or malicious activities (in [32]) by identifying
deviations from legitimate behavior.
More generally, the wireless attacks investigated in this
paper may impact other protocols, depending on the compat-
ibility between their modulations and channel coding, along
with the programmability of the underlying hardware. Indeed,
if the frequencies overlap, while the modulations are similar
enough to be able to control what is received by one protocol
from an emission of the other, the two protocols are by design
vulnerable to pivoting techniques. Let us note that evaluating
accurately the similarities between two modulations is an open
challenge. We argue that such attacks should be included in
the threat assumptions when different wireless technologies
are deployed in connected environments. We also argue that
protocol designers should consider such possibilities of cross-
protocol interactions when creating new wireless standards,
to reduce the risks of pivoting attacks using their protocol as
basis.
VIII. CONCLUSION AND PROSPECTIVE WORK
In this paper, we have presented a new pivoting attack
strategy, called WazaBee, allowing the legitimate operation
of a chip intended to communicate via BLE to be diverted
in order to send and receive Zigbee communications (actu-
ally, our approach is compliant with all 802.15.4 frames).
A proof of concept is also presented by implementing the
attack on two chips with different architectures and from
different manufacturers. The performance results measured
during the two evaluations carried out for the transmission and
reception primitives were very stable and reliable. The direct
consequence is a considerable increase in the attack surface in
IoT environment, each system communicating via a protocol
based on the 802.15.4 standard (Zigbee, 6LoWPan ... ) being
potentially accessible from a component supporting BLE, a
particularly widespread technology in IoT environments. The
impact of WazaBee has been illustrated in two attack scenarios,
highlighting the variety of uses an attacker could make of it.
The study of this type of attacks has been seldom explored
and it is very important to develop suitable countermeasures.
We plan to focus our future work on formalizing this type of
attack and exploring its feasibility with other wireless commu-
nication protocols. In this way, we plan to further investigate
the similarities between different existing modulation tech-
niques that could be exploited to perform WazaBee like attacks.
Deﬁning a metric to measure such similarities could be useful
to anticipate, for example, which protocols based on amplitude
modulation could be diverted to other protocols based on
frequency modulation. From a more defensive perspective, the
existence of this type of attack argues in favor of protection
solutions capable of monitoring multiple protocols in real time,
and detecting potential illegitimate behaviours. Consequently,
we plan to study the design and implementation of a multi-
protocol and multi-layer intrusion detection and prevention
system that can cope with such attacks.
[23] Armis, “Blueborne Technical White Paper,” https://go.armis.com/hubfs/
BlueBorne%20Technical%20White%20Paper.pdf, 2017.
[24] ——, “BleedingBit Technical White Paper,” https://go.armis.com/hubfs/
BLEEDINGBIT%20-%20Technical%20White%20Paper.pdf, 2018.
[25] G. Vishwakarma and W. Lee, “Exploiting jtag and its mitigation in iot:
A survey,” Future Internet, vol. 10, p. 121, 12 2018.
[26] S. Pasupathy, “Minimum shift keying: A spectrally efﬁcient modulation,”
IEEE Communications Magazine, vol. 17, no. 4, pp. 14–22, July 1979.
[27] D. Mantz, J. Classen, M. Schulz, and M. Hollick, “Internalblue -
bluetooth binary patching and experimentation framework,” Proceedings
International Conference on Mobile Systems,
of
Applications, and Services,
[Online]. Available: http:
//dx.doi.org/10.1145/3307334.3326089
the 17th Annual
Jun 2019.
[28] I. Vaccari, E. Cambiaso, and M. Aiello, “Remotely exploiting at
command attacks on zigbee networks,” Security and Communication
Networks, vol. 2017, pp. 1–9, 10 2017.
[29] N. Vidgren, K. Haataja, J. L. Pati˜no-Andres, J. J. Ram´ırez-Sanchis, and
P. Toivanen, “Security threats in zigbee-enabled systems: Vulnerability
evaluation, practical experiments, countermeasures, and lessons learned,”
in 2013 46th Hawaii International Conference on System Sciences, 2013,
pp. 5132–5138.
[30] X. Cao, D. M. Shila, Y. Cheng, Z. Yang, Y. Zhou, and J. Chen, “Ghost-
in-zigbee: Energy depletion attack on zigbee-based wireless networks,”
IEEE Internet of Things Journal, vol. 3, no. 5, pp. 816–829, 2016.
[31] S. Siby, R. R. Maiti, and N. Tippenhauer, “Iotscanner: Detecting and
classifying privacy threats in iot neighborhoods,” 2017.
[32] J. Roux, E. Alata, G. Auriol, M. Kaˆaniche, V. Nicomette, and
R. Cayre, “RadIoT: Radio Communications Intrusion Detection for
IoT - A Protocol Independent Approach,” in 17th IEEE International
Symposium on Network Computing and Applications (NCA 2018),
Cambridge, Massachusetts, United States, Nov. 2018, p. 8p. [Online].
Available: https://hal.laas.fr/hal-01914981
[33] S. Rajendran, W. Meert, V. Lenders, and S. Pollin, “Unsupervised
wireless spectrum anomaly detection with interpretable features,” IEEE
Transactions on Cognitive Communications and Networking, vol. PP,
pp. 1–1, 04 2019.
REFERENCES
[1] T. Zillner and S. Strobl, “Zigbee Exploited : The Good, the Bad and the
https://www.blackhat.com/docs/us-15/materials/us-15-Zillner-
Ugly,”
ZigBee-Exploited-The-Good-The-Bad-And-The-Ugly.pdf, 2015.
[2] M. Ryan, “How Smart is Bluetooth Smart ?” 2013.
[3] ——, “Bluetooth: With Low Energy comes Low Security,” 2013.
[4] E. Ronen, A. Shamir, A. Weingarten, and C. O’Flynn, “Iot goes nuclear:
Creating a zigbee chain reaction,” in 2017 IEEE Symposium on Security
and Privacy (SP), May 2017, pp. 195–212.
[5] Y. Bachy, F. Basse, V. Nicomette, E. Alata, M. Kaˆaniche, J. Courr`ege,
and P. Lukjanenko, “Smart-tv security analysis: Practical experiments,”
in 2015 45th Annual IEEE/IFIP International Conference on Depend-
able Systems and Networks, June 2015, pp. 497–504.
[6] “B-L475E-IOT01A Data Brief,” ST Microelectronics, 2018, https://
www.st.com/resource/en/data brief/b-l475e-iot01a.pdf.
[7] “CC2652R Data Sheet,” Texas Instruments, 2019, http://www.ti.com/lit/
ds/symlink/cc2652r.pdf.
[8] K. Chebrolu and A. Dhekne, “Esense: Communication through energy
sensing,” in Proceedings of the 15th Annual International Conference
on Mobile Computing and Networking, ser. MobiCom ’09. New York,
NY, USA: Association for Computing Machinery, 2009, p. 85–96.
[Online]. Available: https://doi.org/10.1145/1614320.1614330
[9] S. M. Kim and T. He, “Freebee: Cross-technology communication via
free side-channel,” in Proceedings of the 21st Annual International
Conference on Mobile Computing and Networking, ser. MobiCom ’15.
New York, NY, USA: Association for Computing Machinery, 2015, p.
317–330. [Online]. Available: https://doi.org/10.1145/2789168.2790098
cross-technology
23rd
communication
and
Annual
Networking, ser. MobiCom ’17. New York, NY, USA: Association
for Computing Machinery, 2017, p. 2–14.
[Online]. Available:
https://doi.org/10.1145/3117811.3117816
the
on Mobile Computing
Physical-layer
in Proceedings
International Conference
“Webee:
emulation,”
and T. He,
via
of
[10] Z. Li
[11] W.
Jiang, Z. Yin, R. Liu, Z. Li, S. M. Kim, and T. He,
“Bluebee: A 10,000x faster cross-technology communication via phy
emulation,” in Proceedings of the 15th ACM Conference on Embedded
Network Sensor Systems, ser. SenSys ’17. New York, NY, USA:
Association for Computing Machinery, 2017.
[Online]. Available:
https://doi.org/10.1145/3131672.3131678
[12] W. Jiang, S. M. Kim, Z. Li, and T. He, “Achieving receiver-side
cross-technology communication with cross-decoding,” in Proceedings
of the 24th Annual International Conference on Mobile Computing and
Networking, ser. MobiCom ’18. New York, NY, USA: Association
for Computing Machinery, 2018, p. 639–652. [Online]. Available:
https://doi.org/10.1145/3241539.3241547
[13] T. Goodspeed, S. Bratus, R. Melgares, R. Shapiro, and R. Speers,
“Packets in packets: Orson welles’ in-band signaling attacks for modern
radios,” 08 2011, pp. 7–7.
[14] M. C. Millian and V. Yadav, “Packet-in-packet exploits on 802 . 15 .
4,” 2015.
[15] T.
Goodspeed,
duty,”
http://travisgoodspeed.blogspot.com/2011/02/promiscuity-is-nrf24l01s-
duty.html, 2011.
“Promiscuity
nrf24l01+’s
the
is
[16] M. Newlin,
“MouseJack : White Paper,” 2016, https://github.
com/BastilleResearch/mousejack/blob/master/doc/pdf/DEFCON-
24-Marc-Newlin-MouseJack-Injecting-Keystrokes-Into-Wireless-
Mice.whitepaper.pdf.
[17] D. Cauquil, “Snifﬁng btle with the micro:bit,” PoC or GTFO, vol. 17,
pp. 13–20, 2017.
[18] ——,
“Weaponizing
https:
//media.defcon.org/DEFCON25/DEFCON25presentations/DEFCON25-
Damien-Cauquil-Weaponizing-the-BBC-MicroBit-UPDATED.pdf.
BBC Micro:Bit,”
2017,
the
[19] ——, “Radiobit, a BBC Micro:Bit RF ﬁrmware,” 2017, https://github.
com/virtualabs/radiobit.
[20] Bluetooth Core Speciﬁcation, Bluetooth SIG, 12 2019.
[21] “Ieee standard for low-rate wireless networks,” IEEE Std 802.15.4-2015
(Revision of IEEE Std 802.15.4-2011), pp. 1–709, April 2016.
[22] M. Bettayeb, Q. Nasir, and M. A. Talib, “Firmware update attacks and
security for iot devices: Survey,” in Proceedings of the ArabWIC 6th
Annual International Conference Research Track, ser. ArabWIC 2019.
New York, NY, USA: Association for Computing Machinery, 2019.
[Online]. Available: https://doi.org/10.1145/3333165.3333169