### Introduction

To carry out a complex attack, an adversary must be within the range of the company’s Zigbee network. Our study focused on a commercial BLE (Bluetooth Low Energy) tracker device, the Gablys Lite, which is based on the nRF51822 chip. The attack requires physical access to the device, as we utilized unprotected debug pins to provide Serial Wire Debug (SWD) for flashing new firmware. It is important to note that similar attacks could be executed using BLE vulnerabilities, such as over-the-air (OTA) update abuse, which do not require physical access.

The nRF51822 chip, while similar to the nRF52832, does not support LE 2M, a key requirement for the WazaBee attack. However, the Enhanced ShockBurst protocol, supported at 2 Mbits/s by the nRF51822, can serve as an alternative for the LE 2M physical layer. This solution affects reception quality but is sufficient for conducting a complex active attack.

### Attack Objective and Methodology

The primary goal of this attack is to perform a denial of service (DoS) targeting the sensor, allowing the injection of fake data into the display interface. We leveraged an existing attack targeting XBee nodes to perform the DoS, enabling the injection of a new configuration through remote AT commands [28]. The attack consists of four main steps:

1. **Active Scanning**: The device transmits a Beacon Request on a channel and waits for a Beacon from the coordinator. If no Beacon is received before the timeout, the device selects the next channel. If a Beacon is received, the channel, PanID, and the coordinator’s address are collected and saved.
2. **Eavesdropping**: The device sniffs legitimate frames to collect the sensor’s address.
3. **Remote AT Command Injection**: The device forges a remote AT command, using the coordinator’s address as the source and the sensor’s address as the destination. This forces the sensor to use another channel.
4. **Fake Data Injection**: The device transmits fake data frames, mimicking the sensor’s behavior.

This attack was successfully implemented, as illustrated in Figure 5. This experiment demonstrates that WazaBee’s primitives can be combined to conduct complex attack scenarios and that a legitimate commercial device can be modified and used for such offensive strategies.

### Conclusion

The two attack scenarios presented are not exhaustive but illustrate the critical impact of the WazaBee attack, particularly the significant number of legitimate devices that can be repurposed to attack 802.15.4 networks. Depending on the compromised device and the privilege level gained, an attacker may implement all or a subset of WazaBee’s primitives. Even with a partial implementation, an attacker can achieve objectives such as leaking sensitive data or disrupting legitimate nodes. These strategies can be combined to perform complex attack scenarios. Finally, these scenarios highlight that the attack is easy to implement on various devices and can be readily deployed in real-world environments.

### Counter-Measures

WazaBee attacks are inherent to wireless protocols and their modulations, even if specific conditions must be met for implementation on certain chips. Therefore, every BLE 5 device should be considered potentially vulnerable, and environments with BLE devices should be designed and monitored under the assumption that attacks could be carried out through 802.15.4 networks. Several counter-measures can be explored to limit the impact, prevent, or detect such attacks.

As explained in Section IV-D, the practical implementation of WazaBee requires controlling certain features of BLE chips. Making it difficult or impossible for an attacker to control these features, such as deactivating the CRC or setting a precise channel frequency, would complicate the task of the attacker, especially in implementing the reception primitive. However, such counter-measures should only be considered as a first barrier, as illustrated in our scenario A, which uses a high-level API to implement the transmission primitive.

Other common counter-measures, such as cryptographic techniques, provided by most 802.15.4-based protocols, should be systematically used. Even if the WazaBee attack is still possible, the task of the attacker would be much more complicated with these measures in place. Unfortunately, the correct implementation of these counter-measures is not trivial and highly depends on key protection. Note that some known attacks [29] aiming to break 802.15.4 encryption can be performed using WazaBee, and the attacker can still perform DoS attacks [30].

Finally, defensive solutions dedicated to the IoT context, such as real-time monitoring and detection of attacks targeting wireless protocols, can also be considered. The existence of such offensive strategies motivates the deployment of intrusion and prevention detection systems based on the analysis of radio communications. These systems can simultaneously monitor multiple wireless protocols, even those not deployed in the legitimate environment, or be protocol-agnostic, such as the intrusion detection approaches proposed in [32], [33]. These systems are designed to monitor the physical layers of communication protocols by monitoring signal strength on different frequency bands and are based on modeling legitimate communications to detect accidental faults or malicious activities by identifying deviations from normal behavior.

### Future Work

In this paper, we have presented a new pivoting attack strategy called WazaBee, which allows the legitimate operation of a chip intended for BLE communication to be diverted to send and receive Zigbee communications. A proof of concept was implemented on two chips with different architectures and from different manufacturers. The performance results were stable and reliable, significantly increasing the attack surface in IoT environments. Each system communicating via a protocol based on the 802.15.4 standard (Zigbee, 6LoWPan, etc.) is potentially accessible from a component supporting BLE, a widely used technology in IoT environments. The impact of WazaBee has been illustrated in two attack scenarios, highlighting the variety of uses an attacker could make of it.

The study of this type of attack has been seldom explored, and it is crucial to develop suitable countermeasures. Our future work will focus on formalizing this type of attack and exploring its feasibility with other wireless communication protocols. We plan to further investigate the similarities between different existing modulation techniques that could be exploited to perform WazaBee-like attacks. Defining a metric to measure such similarities could help anticipate which protocols based on amplitude modulation could be diverted to other protocols based on frequency modulation. From a defensive perspective, the existence of this type of attack argues in favor of protection solutions capable of monitoring multiple protocols in real time and detecting potential illegitimate behaviors. Consequently, we plan to study the design and implementation of a multi-protocol and multi-layer intrusion detection and prevention system that can cope with such attacks.