the subject of further investigation. Flow splitting could be
one of the possible causes.
SYN-seq MLE estimates
BB-East-2 original flow size distribution
 0.35
 0.3
 0.25
 0.2
 0.15
 0.1
 0.05
i
e
z
i
s
h
t
i
w
s
w
o
l
f
f
o
n
o
i
t
c
a
r
F
 2
 4
 6
 8
 10
 12
 14
 16
 18
 20
Flow size i
Figure 7: Estimated ﬂow size distribution from the
BB-East-2 trace versus the original ﬂow size dis-
tribution. Packet sampling rate p = 0.01 using the
SYN-seq MLE.
In what follows we assess the value of sampling at multiple
monitors.
6. FLOW SIZE ESTIMATION ON MULTI-
PLE MONITORS
So far we have considered samples from a single moni-
tor. Flows crossing a backbone network will normally cross
multiple monitors in the network. In this section we study
the value of the information obtained from multiple moni-
tors and how to best use the collected samples at multiple
monitors.
(cid:2)
(cid:2)
˜(cid:2)θ
˜(cid:2)θ(1), . . . ,
˜(cid:2)θ(1), . . . ,
independently. Their goal is to ﬁnd a new estimate
The combination of sampled network measurements from
multiple monitors was considered in [4]. In [4] the authors fo-
˜(cid:2)θ(m),
cus on estimating (cid:2)θ, using local estimates of (cid:2)θ,
obtained at m monitors. It assumes all monitors will sample
of (cid:2)θ us-
˜(cid:2)θ(m)
ing a linear combination of the local estimates
such that the variance of ˆX
is the smallest among all linear
combinations. [4] applies this method to obtain reasonable,
although not optimal estimation on traﬃc matrix informa-
tion from combined samples. In this section, we focus on the
ﬂow size distribution. Our goal is to determine the informa-
tion loss from combining local estimates instead of combin-
ing all samples and then estimating the desired quantity.
This allows us to assess how close the method in [4] is to
optimal. In this section we focus on the SYN-seq estimator.
Assume there are u monitors sampling packets at rates
p1, . . . , pu respectively and that the same traﬃc is seen by
these u monitors, as in [4]. Let B be a matrix as deﬁned
in Section 2.2 for the TCP sequence number case, with the
only change being the sampling rate p = (1 − Q
z(1 − pz)).
)
M
S
(
σ
/
i
)
M
T
(
σ
i
r
o
)
M
S
(
σ
/
i
)
L
(
σ
i
 1.8
 1.7
 1.6
 1.5
 1.4
 1.3
 1.2
 1.1
 1
 0.9
Two monitors: Combining samples or combining independent estimates?
Combining independent estimates
Combining samples
 0
 10
 20
 30
 40
 50
 60
 70
 80
 90
 100
Flow size i
Figure 8: This graph uses the Cram´er-Rao bound to
show the advantage of making the estimation with
the combine samples taken at each monitor over
the combination of the two independent estimations
taken at each monitor. The evaluation is done over
distribution from trace BB-East-2.
This models the case where all packet samples are combined
at a single central server and the estimation is performed on
the combined samples.
of (2) and (3) in respect to (1). Let
The alternative is to form an estimate at each monitor and
then combine them into a single one. This approach was sug-
gested in [4]. Let W = 200 be the maximum ﬂow size and
p = 1/64 be the packet sampling rate when there is only one
monitor or p1 = p2 = 1/128 when there are two monitors.
Figure 8 compares the standard deviation of the estimation
error of the following three approaches: (1) Estimation us-
ing one monitor with sampling rate p, (2) estimation using
the combined samples of two monitors at rates p1 and p2
and (3) estimation using the combined estimates obtained
at each monitor. The results are presented by evaluation
(cid:2)(L) be the estimates
˜(cid:2)θ
˜(cid:2)θ(SM) be the es-
obtained by the approach described in [4];
timates obtained by the single monitor with sampling rate
˜(cid:2)θ(TM) be the estimates obtained in a central server
p; and
from the combined samples collected at the two monitors
)2],
with sampling rates p1 and p2. Let σ
(TM)
)2]
σ
i
obtained by the Cram´er-Rao bound. Figure 8 shows the
(L)
(SM)
graph of curve σ
i /σ
(“Combining independent esti-
i
/σ
mates”) against curve σ
(“Combining samples”).
The results show that combining the sample at a central
server is almost as good as sampling at one monitor with
double the rate. The results also shows that combining two
independent estimates increases the standard deviation er-
ror of the estimates in 50%. Using a central site comes with
the cost of transferring all data to the central site. One can
reduce this cost by sending summarized data.
√
E[(θi − ˜θ
√
(L)
i =
E[(θi − ˜θ
E[(θi − ˜θ
)2] and σ
(TM)
i
(TM)
i
(SM)
i
(SM)
i
√
=
(SM)
i
=
(L)
i
7. CONCLUSIONS AND FUTURE WORK
In this paper we have focused on a key issue that arises
when conducting measurements for the purpose of estimat-
ing network statistics such as the ﬂow size distribution, namely,
what are the values of diﬀerent types of information on the
quality of the estimate? Using ﬂow size distribution as an
example and packet sampling as the measurement technique,
we studied the values of diﬀerent types of information, such
as packet counts, SYN information, and sequence number
information. Using the Fisher information through its ap-
plication via the Cr´amer-Rao bound on mean squared error,
we found that TCP sequence number information is essen-
tial for accurate ﬂow size estimation. We also explored the
beneﬁt of including SYN ﬂag information, and determined
that the former is useful in reducing the errors associated
with estimating the fraction of small sized ﬂows. Using this
as a starting point, we presented MLEs based on the conju-
gate gradients method, which come close to the Cr´amer-Rao
bound, even for small sample set sizes. Last, we applied the
framework to determine the beneﬁts of combining observa-
tions from multiple monitoring sites. Our analysis shows
substantial beneﬁt in performing estimation on the com-
bined set of observations as opposed to combining the esti-
mates made on observations at individual monitoring sites.
To our knowledge this is the ﬁrst study of ﬂow size estima-
tion from samples collected at multiple monitors.
This is a ﬁrst step in an attempt to understand the value
of diﬀerent types of information for the purpose of estimat-
ing network statistics. Our future work will focus both on
applying our framework to other estimation problems and
more speciﬁcally to reﬁning the application to ﬂow size dis-
tribution estimation. For example, there is a need for a par-
simonious model of the ﬂow size distribution with a small
number of parameters. Another research direction is to ex-
tend the work on multiple monitors. For example, can one
use the Fisher information to derive an adaptive mechanism
for determining sampling rates at diﬀerent monitors so as to
minimize error subject to a resource constraint.
8. ACKNOWLEDGMENTS
We acknowledge the fundamental contribution of Darryl
Veitch on suggesting the TCP sequence number ﬁeld as a
high informational protocol ﬁeld for the ﬂow size estimation.
And also the fruitful discussions with George D. Konidaris
on MLEs. We also acknowledge the many anonymous re-
viewers for their comments and suggestions.
This work has been supported in part by NSF under grant
ANI-0325868, the CAPES Brazilian agency award 2165031
and the Sprint Advanced Technology Laboratories. The
equipment was supported in part by NFS RI infrastruc-
ture grant under award number EIA-0080119. Any opinions,
ﬁndings, and conclusions or recommendations expressed in
this material are those of the author(s) and do not necessar-
ily reﬂect the views of the National Science Foundation.
9. REFERENCES
[1] Weifeng Chen, Yong Huang, Bruno F. Ribeiro, Kyoungwon
Suh, Honggang Zhang, Edmundo de Souza e Silva, Jim Kurose,
and Don Towsley. Exploiting the IPID ﬁeld to infer network
path and end-system characteristics. In Proceeding of the 2005
Passive and Active Measurement (PAM’05) Workshop, March
2005.
[2] Thomas M. Cover and Joy A. Thomas. Elements of
Information Theory. John Wiley & sons, 1991.
[3] Nick Duﬃeld, Carsten Lund, and Mikkel Thorup. Estimating
ﬂow distributions from sampled ﬂow statistics. IEEE/ACM
Transactions on Networking, 13(5):933–946, 2005.
[4] Nick Duﬃeld, Carsten Lund, and Mikkel Thorup. Optimal
combination of sampled network measurements. In IMC ´05:
Proceeding of the 5th ACM/USENIX Internet Measurement
Conference, October 2005.
[5] Nick G. Duﬃeld, Carsten Lund, and Mikkel Thorup. Learn
more, sample less: control of volume and variance in network
measurement. 51(5):1756–1775, 2005.
[6] Cristian Estan, Stefan Savage, and George Varghese.
Automatically Inferring Patterns of Resource Consumption in
Network Traﬃc. In Proc. ACM SIGCOMM ’03, Karlsruhe,
Germany, Aug. 2003.
[7] C. Fraleigh, S. Moon, B. Lyles, C. Cotton, M. Khan, D. Moll,
R. Rockell, T. Seely, and C. Diot. Packet-level traﬃc
measurements from the sprint IP backbone. IEEE Network,
2003.
[8] John D. Gorman and Alfred O. Hero. Lower bounds for
parametric estimation with constraints. IEEE Transactions on
Information Theory, 36(6):1285–1301, Nov 1990.
[9] Nicolas Hohn and Darryl Veitch. Inverting sampled traﬃc. In
IMC ’03: Proceedings of the 3rd ACM SIGCOMM conference
on Internet measurement, pages 222–233, New York, NY,
USA, 2003. ACM Press.
[10] Steven M. Kay. Fundamentals of Statistical Signal Processing,
Volume I: Estimation Theory. Prentice Hall PTR, March 1993.
[11] Ramana Rao Kompella and Cristian Estan. The power of
slicing in internet ﬂow measuremet. In IMC ’05: Proceeding of
the 5th ACM/USENIX Internet Measurement Conference,
October 2005.
[12] S. Muthukrishnan. Data streams: algorithms and applications.
In Proc. of ACM SODA, invited talks, pages 413–413, 2003. A
complete version is available at
(http://athos.rutgers.edu/~muthu/stream-1-1.ps).
[13] William H. Press, Brian P. Flannery, Saul A. Teukolsky, and
William T. Vetterling. Numerical Recipes in C : The Art of
Scientiﬁc Computing. Cambridge University Press, October
1992.
[14] Richard A. Redner and Homer F. Walker. Mixture Densities,
Maximum Likelihood and the EM Algorithm. SIAM Review,
26(2):195–239, April 1984.
[15] RFC791. Internet protocol. September 1981. DARPA Internet
Program Protocol Speciﬁcation.
[16] M. J. Schervish. Theory of Statistics. Springer, 1995.
[17] Ram Zamir. A Proof of the Fisher Information Inequality via a
Data Processing Argument. IEEE Transactions on
Information Theory, 44(3):1246–1250, 1998.
[18] Qi Zhao, Abhishek Kumar, Jia Wang, and Jun Xu. Data
streaming algorithms for accurate and eﬃcient measurement of
traﬃc and ﬂow matrices. In Proc. of ACM SIGMETRICS,
June 2005. to appear.
[19] Cisco NetFlow. http://www.cisco.com/warp/public/732/-
Tech/nmp/netﬂow.
[20] IPFIX, IETF Working Group Charter IP Flow Information
Export.
http://www.ietf.org/html.charters/ipﬁxcharter.html.
[21] Packet Sampling, IETF Working Group Charter PSAMP.
http://www.ietf.org/html.charters/psampcharter.html.
[22] sFlow. http://www.sﬂow.org.
[23] Sprint packet trace analysis.
http://ipmon.sprint.com/packstat.