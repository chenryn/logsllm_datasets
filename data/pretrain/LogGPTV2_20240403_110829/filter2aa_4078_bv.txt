密钥分发是一个简单的过程。 希望加入非对称密码系统的用户 ， 只 需要使他们的公钥对于所有
与他们进行通信的人来说可用就可 以了。 目 前 尚无办法从公钥导 出私钥 。
不需要预先存在通信链接。 两个个体可以从通信一开始就进行安全的通信 。 非对称密码学并不
要求预先存在能够提供安全数据交换机制的关系 。
公钥密码学的主要弱点是运算速度'医。 因此， 很多需要安全传输大量数据的应用程序会使用公
钥密码学建立连接， 然后交换对称密钥。 会话任务的剩余部分随后来用对称密码学开始运作。 表 6.2
比较了对称和非对称密码学系统。 仔细查看这个表可以发现， 一种系统中 的弱 点恰好与另一种系统
中 的优点互补 。
表 6.2 对称和非对称密码学系统的比较
对称密码学系统 非对称密码学系统
单个共享的密钥 密钥对
带外交换 带内交换
不可扩展 可扩展
快速 慢速
批量加密 小块数据分组、 数字签名 、 数字封装 、 数字证书
机密性 完整性、 机密性、 身份认证、 不可否认性
注意 :
第 7 章提供了 现代公钥加密算法的技术细节及一些应用 。
6.3.4 散列算法
在上一节中 ， 你学习 了 公钥密码系统在与消息摘要一起使用时可以提供数字签名 的能力。 消息
摘要概述了经过散列算法处理的消息内容(与文件的校验和不同)。 如果可能的话， 从理想的散列函
数中派生出消息是非常困难的 ， 并且两条消息生成相 同散列值的可能性几乎是不存在的 。
下面列出了 目 前常用 的一些散列算法:
• 消息摘要 2(MD2)
• 消 息摘 要 5(MD5)
• 安全散列算法(SHA-O 、 SHA- l 和 SHA-2)
• 基于散列的消息身份认证代码(Hashed Message Authentication Code， HMAC)
第7章 " PKI 和密码学应用 " 提供了 这些当代的散列算法的细节， 并且解释了如何使用它们提
供数字签名 能力 ， 此能力可以帮助我们实现密码学的完整性和不可否认性 目 标。
6.4 对称密码
你 己经学习 了 对称密钥密码、 非对称密钥密码以及散列函数内在的基本概念。 在下面的 内 容中 ，
我们将深入讨论下列几种常见的对称密码系统: 数据加密标准ρES)、 三重数据加密算法(3DES)、
1 47
CISSP 官方学习指南(第 7 版)
国 际数据加密算法(IDEA)、 Blowfish 、 Skipjack 以及高级加密标准(AES)。
6.4. 1 数据加密标准
美国政府在 1 977 年公布了数据加密标准(DES)， 并且将之作为向所有政府通信而提议的标准密
码系统。 由于该算法中 的缺陷， 密码学界和政府不再认为 DES 是安全的。 大家普遍相信情报机构已
经能轻易破解 DES 加密的信息。 DES 在 2001 年 12 月 被高级加密标准取代。 了解 DES 仍然是重要
的 ， 因 为它是构成三重 DES(3DES)的基础， 该加密算法将在下一节进行阐述。
DES 是一个 64 位的分组密码， 具有 5 种操作模式: 电子代码本(Electronic CodeBook， ECB)模
式、 密码分组链接(Cipher Block Chaini吨， CBC)模式、 密码回馈(Cipher FeedBack， CFB)模式以及输
出 回馈(Output FeedBack， OFB)模式和计数(CounTeR， CTR)模式。 这些模式将在接下来的内容中进
行阐述。 所有 DES 模式每次处理 64 位的明文， 并且生成一个 64 位的密文分组。 DES 使用 的密钥
长度为 56 位 。
DES 利用长序列的异或(XOR)操作生成密文。 每个加密/解密操作都要重复 1 6 次这个过程， 每
次重复通常被称为 " 一轮 " 加密， 因 此 DES 要执行 1 6 轮加密。
注意 :
1 48
正如所提到的那样， DES 使用 一个 56 位的 密钥来进行为口密和解密操作。 然而， 某些文献可能
会说 DES 使用 一个 64 位的密钥。 这并不矛盾 ， 其中具有完美的逻辑解释。 DES 规范确 实有使用
64 位密钥的说法。 然 而在这 64 位中 ， 实际上只有 56 位 包含密钥信息， 其余 8 位包含奇偶信息， 从
而确保 56 位密钥是正确的。 然而， 这些奇偶住事实上很少使用 ， 只 需要牢牢记住这 56 位数字。
1 . 电子代码本模式
电子代码本但CB)模式是最容易 了解的模式， 但安全性最差。 这个算法每次处理一个 64 位分组，
它简单地使用所选择的密钥对这个分组进行加密。 这意味着如果算法多次遇到相同的分组， 那么将
产生完全相同的加密分组。 如果敌人正在对通信进行偷听， 那么就可以简单地建立起所有可能加密
值的 " 代码本飞 在收集到足够多的分组后， 就可 以使用密码分析技术对一些分组进行解密并破解加
密方式。
除了最短传输之外， 这个脆弱性使得通过 ECB 模式进行传输并不现实。 在日常使用 中 ， ECB
只 被用 于交换少量数据 ， 例如， 启 动其他 DES 模式的密钥和参数以 及数据库 中 的单元。
2. 密码分组链接模式
在密码分组链接(CBC)模式中 ， 未加密文本的每个分组在使用 DES 算法加密之前 ， 都与前一密
文分组进行异或操作。 解密过程简单地将密文解密 ， 并且反向执行异或操作。 CBC 创建了一个 IV，
并且将这个 IV 与消息的第一个分组相异或， 从而每次操作都生成独特的输出 。 IV 必须被发送给接
收方， 我们既可以将 W 以 明文形式置于完整的密文之前， 也可以使用与消息所用 的相同的密钥通
过 ECB 加密模式保护它 。 在使用 CBC 模式时， 需要考虑的一个重要问题是错误传播， 也就是如果
一个分组在传输中 被破坏 ， 那 么这个分组将无法解密 ， 并且下一个分组也是如此。
第6章 密码学与对称加密算法
3. 密码回馈模式
密码回馈(CFB)模式是流密码形式的 CBC。 换句话说， CFB 针对实时生成的数据进行操作。 不
过， CFB 并不将消息分为若干分组， 而是使用相 同分组大小的内存缓冲区 。 在缓冲区被填满时， 对
数据进行加密并发送给接收方。 接着， 系统等待下一个缓冲区被新生成的数据填满， 然后继续进行
加密和传输。 除了将先前存在的数据变化为实时数据 ， CFB 的操作方式与 CBC一样， 也使用 了 W
和链接。
4. 输出回馈模式
在输出 回馈(OFB)模式中 ， DES 的操作样式几乎与在 CFB 模式中 的操作样式完全相同 。 不过，
DES 并不将明文分组与前一个密文分组的加密版本相异或， 而是将明文与某个种子值相异或。 对于
第一个被加密的分组来说， 初始向量被用于创建种子值。 通过对先前的种子值运行 DES 算法， 就可
以派生出之后的种子值。 OFB 模式的主要优点是不存在链接功能， 并且传输错误不会通过传播影响
之后分组的解密 。
5 计数模式
在计数(CTR)模式中运行的 DES 使用的流密码， 类似于在 CFB 和 OFB 模式中使用的流密码。
不过， 这种模式并不根据前一个种子值的结果为每个加密/解密操作创建种子值， 而是使用一个简单
的 、 每次操作后都增加的计数。 与 OFB 模式一样， CTR 模式中 也不传播错误。
提示 :
CTR模式九许将一个加密或解密操作分解为 多 个独立的步骤 ， 这使得该模式特别适用 于并行
计算。
6.4.2 三重数据加密算法(3D ES)
正如前面几节中提到 的那样， 面对现代密码分析技术和超级计算能力， 数据加密标准的 56 位密
钥被认为己不再适用 。 然而， DES 的修改版本三重数据加密算法(3DES)能够使用相同的算法实现更
安全的加密。
3DES 具有 4 种版本。 第 1 种版本只 是使用三个不同 的密钥(K1 、 K2 和 K3)对明文加密三次。 它
被称为 DES-EEE3 模式(三个 E 表示存在三个加密操作 ， 而数字 3 表示使用三个不同的密钥)， 这种
模式可 以利用下面的符号来表示 ， 其 中 E(K， P)表示使用密钥 K 加密明文 P :
E(K1，E( K2
， E ( K3 ， P)))
DES-EEE3 具有的密钥 的有效长度为 1 68 位 。
第 2 种 3DES 版本 DES-EDE3 也使用三个密钥， 但是将第二个加密操作替换为解密操作， 如下
所示:
主(K1，D(K2，E ( K3 ， P)))
第3种 3DES 版本 DES-EEE2 只 使用两个密钥 Kl 和 K2
' 如下所示:
1 49
1 50
CISSP 官方学习指南(第 7 版)
E ( K 1 ' E ( K2 ， E ( K l' P) ) )
第4种 3DES 版本 DES-EDE2 也使用两个密钥， 但是在中间使用 一个解密操作 ， 如下所示:
E ( K1 'D(K2
， E ( K1 ' P )) )
第3种和第 4 种 3DES 版本具有的密钥的有效长度都为 1 1 2 位 。
注意 :
从技术上讲， 3DES 具有第 5 种形 式 DES-EDEl ， 这种形 式只使用 一个密钥。 不过， 这种形式
导致与 标准 DES 相同的算法(和强度)， 并且只 是为 了 向后兼容而提供。
由于若干密码研究人员提出 了 这样的理论: 一种形式比其他三种形式更安全， 因此这4种 3DES
己经经过了 多年发展。 然而 ， 目 前人们相信所有模式一样安全。
提示 :
请花费一些时间理解 3DES 的各种变化形式。 使用 纸笔进行运算， 确保理解每种变化形式如何
使用 两 个或三个密钥达到 强度史高的加密效果 。
注意 :
这个讨论 自 然会引 出 一个问题: 如果使用 双重 DES(Double DES， 2DES) ， 会有怎样的效果? 在
第 7 章 中你会看到 ， 人们尝试过 2DES， 但是在证明存在攻击使得 2DES 并不比标准 DES 安全时 ，
很快就放弃 了 这种算法。
6.4.3 国 际数据加密算法(IDEA)
国 际数据加密算法(IDEA)的分组密码是针对 DES 算法的密钥长度不够而开发的。 与 DEι斗芋，
IDEA 对 64 位的明文/密文分组进行操作。 然而， 国 际数据加密算法采用 1 28 位的密钥进行操作。 这
个密钥随后在一系列操作中被分解成 52 个 16 位的子密钥。 这些子密钥接着使用异或和模运算的组
合对输入的文本进行操作， 从而生成输入消息的加密/解密版本。 IDEA 能够在 DES 使用的 4 种模