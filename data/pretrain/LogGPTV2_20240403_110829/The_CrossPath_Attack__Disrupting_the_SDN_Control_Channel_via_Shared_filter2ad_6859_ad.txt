e
D
 0.2
DC1 DC2
IB
UNIV LAB
Background Traffic
 0
DC1 DC2
IB
UNIV LAB
Background Traffic
Figure 7: Probability distri-
bution of delay variations.
Figure 8: Accuracy of recon-
naissances with different pa-
rameters.
 1000
)
s
p
p
(
t
u
p
h
g
u
o
r
h
T
 800
 600
 400
 200
without attack
with attack
  105
  104
)
s
m
  103
(
y
a
e
D
l
  102
 0
 0
 20
 40
 60
Time (s)
 80
 100
  101
  100
without attack with attack
Figure 9: Throughput of
control packets.
Figure 10: Delays of control
packets.
between target data paths and non-target data paths can be
easily identiﬁed according to the delay variations.
We then calculate the accuracy of our reconnaissance by
conducting 1,000 repeated experiments with different set-
tings of η and α. Here, η denotes the number of measured
delays for each data path, which is also the size of each group
in the t-test used to identify a target path. α is the signif-
icance level used in the t-test. As shown in Figure 8, the
accuracy increases with the increase of η. Moreover, we
can observe that the accuracy increases with the increase of
α when η is smaller, e.g., 10 or 20. However, the accu-
racy tends to be stable when η becomes large. The reason
is that two different groups will statistically different from
each other and two similar groups will be statistically closer
to each other with more data. It is easier to distinguish the
two types of paths if we have enough data, which is not sig-
niﬁcantly impacted by the setting of α. The accuracy always
reaches more than 90% with different settings of α when η
is 40 or 50.
Effectiveness of the Attack. To evaluate the impact of the
attack on the control packets, we conﬁgure the controller
to generate 1,000 control packets per second2 to the switch
s2. Figure 9 shows the throughput of control packets. The
throughput can achieve 1,000 packets per second. However,
it almost drops to 0 under the attack though there are short-
term peaks of throughput. The reason is that our attack trig-
gers TCP of control ﬂows to periodically enter the phase of
retransmission timeout. In this case, no packets will be sent
within the retransmission timeout. Figure 10 shows the delay
2There can be thousands of control packets per second [29]. For sim-
plicity but without loss of generality, we choose a practical value, 1,000.
(a) Accuracy of Reconnaissances.
(b) Degradation Ratio of Control
Trafﬁc.
Figure 11: Robustness of the attack with different back-
ground trafﬁc.
of control packets. The median value of delays for control
packets under the attack is 687 ms, which is more than about
100 times higher than that in absence of the attack. More-
over, the delays under the attack vary within a large range
from below 10 ms and to more than 10,000 ms. Note that,
most delays without the attack are less than 10 ms. The re-
sults above demonstrate our attack can signiﬁcantly degrade
the throughput of control packets and incur high delays.
Robustness of the Attack. As background trafﬁc may affect
the reconnaissances and attack effects, we inject different
background trafﬁc into our network with TCPReplay [16]
in turn. Such trafﬁc traces comes from two Data Centers
(DC1 and DC2) [3], an Internet Backbone (IB) [8], a Uni-
versity (UNIV) [18] and our Laboratory (LAB). Moreover,
due to the limited ﬂow table capacity in switches, we ran-
domly choose ﬂows from the trace to ensure that the number
of rules generated by ﬂows do not exceed the table capacity.
Figure 11a shows the accuracy of reconnaissances with
different background trafﬁc. The parameters of reconnais-
sances α and η are set to 0.01 and 50, respectively, which
are the best parameters to get the highest accuracy ( 93% in
Figure 8) without background trafﬁc. When the background
trafﬁc is injected, the accuracy drops to below 90%, ranging
from 85% to 89%. However, such accuracy is still satisfac-
tory for an attacker to conduct reconnaissances. Figure 11b
shows the degradation ratio of control packets. The degrada-
tion ratio is the fraction of the control packets reduced by the
attack over the total control packets without the attack. We
can see that the attack always causes more than 90% degra-
dation ratio with different background trafﬁc. Above results
demonstrate that our attack achieves high robustness.
5 Attack Impacts on Network Functionalities
In this section, we perform a systematical study on the im-
pacts of the attack on various network functionalities. We
ﬁrst review the common core services enabled in SDN con-
trollers that generate different types of OpenFlow control
messages and are used by various SDN applications. We
then study four typical SDN applications, which use these
common core services, so that we measure the impacts of
USENIX Association
28th USENIX Security Symposium    27
SDN Controller
ARP Proxy
Learning 
Switch
Load Balancer
Reactive 
Routing
Other
Apps
App Layer
Service Layer
Packet
Service
Flow Rule
Service
Topology Service
Host 
Tracking
Link 
Discovery
Device 
Discovery
Flow 
Metrics
Service
packet_out
packet_in
flow_mod
packet_out
(LLDP payload)
handshake
stats_request 
& stats_reply
packet_in
(ARP\DHCP payload)
packet_in
(LLDP Payload)
echo_request
 & echo_reply
SDN Data Plane
Figure 12: The core services of SDN controllers.
the attack on SDN functionalities.
5.1 Core Services of SDN
SDN controllers can be abstracted as a two-layer architecture
though different controllers have different implementations.
Applications can be deployed in the top layer to enable dif-
ferent network functionalities, while the low layer provides
different core services that interact with switches and provide
basic functionalities for the top-tier applications. As shown
in Figure 12, there are four major core services:
Packet Service. The service manages packets exchanged be-
tween the control and data planes. It paraphrases packet in
messages containing data packets received from switches
and dispatch them to applications. Meanwhile, it sends data
packets back to switches via packet out messages.
Flow Rule Service. The service manages ﬂow rules. It in-
stalls or updates rules in switches via f low mod messages
according to the results computed by applications.
Topology Service. The service maintains the topology of
end hosts, links, and switches. It discoveries new hosts and
tracks their locations via packet in messages embedded with
an ARP or DHCP payload. It periodically sends and receives
LLDP packets encapsulated in packet in or packet out mes-
sages to maintain link information. Besides, it establishes
the control channel between switches and controllers via sev-
eral handshake messages. The liveness of switches is peri-
odically checked via echo request and echo reply messages.
Applications obtain network topologies through the service.
Flow Metrics Service. The subsystem is responsible for col-
lecting ﬂow statistics.
It periodically queries the ﬂows on
network devices via stats request and stats reply messages,
and then provides various statistics to applications.
We note that almost all applications enabling network
functionalities in SDN is built on at least one of the four
services. Our attack thus can affect various SDN functional-
ities by disrupting the transmission of control messages ex-
changed between these core services and switches. We will
choose four typical applications that are widely deployed in
 300
 250
 200
 150
 100
 50
 0
)
s
p
p
(
e
t
a
R
y
p
e
R
P
R
A
l
 0
without attack
with attack
 1
 0.8
F
D
C
 0.6
 0.4
 100  150  200  250  300
 50
ARP Request Rate (pps)
(a) ARP Throughput.
 0.2
 0
without attack
with attack
 10
 100
Delay (ms)
 1000
 10000
(b) CDF of ARP Query Delay.
Figure 13: Attack impacts on ARP Proxy.
SDN controllers to show the impacts of the attack on various
network functionalities. The implementations of the four ap-
plications [5, 6, 9, 7] are from Floodlight [12].
5.2 ARP Proxy
SDN enables Address Resolution Protocol (ARP) similar to
IP networks, which ﬁnds the association between a destina-
tion IP address and its corresponding hardware (MAC) ad-
dress so that hosts can correctly send and receive IP pack-
ets. In IP networks, layer two switches ﬂood an ARP request
sent from a host to get an ARP reply. If the target IP ad-
dress in the ARP request is not in the local network, a router
acts as an ARP proxy to send back an ARP reply with the
hardware address of its own interface. In SDN, ARP pack-
ets are handled by an ARP proxy application [5] in the SDN
controller. When an ARP request sent by a host arrives at
a switch, it will be sent to the controller via packet in mes-
sages. The packet service extracts the ARP request packet
from packet in messages and dispatches the packet to the
ARP proxy application. The application extracts the sender
IP address and the source MAC address to store them into
the ARP table. Meanwhile, it ﬁnds an entry that the IP ad-
dress matches the target IP address in the ARP request. A
corresponding ARP reply packet is created and will be sent
back to the ingress switch via packet out messages. Thus,
the original host obtains an ARP reply.
Our attack can completely disrupt the functionality of
ARP proxy by interfering with the exchange of the messages
between the packet service and switches. Figure 13a shows
the ARP throughput. The ARP reply rate is proportional to
the ARP request rate in absence of the attack. However, un-
der the attack, the ARP reply rate falls below 10 pps when
the ARP request rate exceeds 100 pps. The reason is that the
TCP ﬂows of control trafﬁc frequently enter the retransmis-
sion timeout phase under the attack due to the congestion.
Figure 13b shows the CDF of ARP delays. More than 90%
delays are less than 10 ms without the attack, while more
than 70% delays are higher than 10 ms and more than 50%
delays are higher than 1,000 ms with the attack. Delays un-
der attacks signiﬁcantly increase. Particularly, some delays
exceed 10,000 ms, which can cause connection failures be-
tween two hosts because hosts cannot get MAC addresses.
28    28th USENIX Security Symposium
USENIX Association
 1000
 1
 1000
)
s
p
b
M
(
t
u
p
h
g
u
o
r
h
T
 800
 600
 400
 200
 0.8
n
o
i
t
a
z
i
l
i
t
U
k
n
L
i
 0.6
 0.4
 0.2
without attack
with attack
without attack
with attack
)
s