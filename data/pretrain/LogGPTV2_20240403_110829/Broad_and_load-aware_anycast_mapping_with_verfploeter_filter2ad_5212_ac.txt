AS20473
Florida Int. Univ. AS20080
USC/ISI
AS1972
Florida Int. Univ. AS1251
AS39839
FR, Paris
JP, Tokyo
NL, Enschede
UK, London
US, Miami
US, Washington
BR, Sao Paulo
DK, Copenhagen DK Hostmaster
Table 3: List of anycast sites used in our measurements.
world: 5 sites in Europe, 2 in the USA, and 3 other sites spread
across Asia, Oceania and South America (Table 3). Tangled allows
us to study how a larger amount of sites interact, and to perform
experiments which we cannot do in an operational anycast service.
We use it to understand anycast instability and ASes that appear in
multiple catchments (§6).
Limitations: Three of the testbed sites share a common ISP,
which might impact the overall catchment. The anycast site in
São Paulo has all its tra(cid:28)c routed via the same link as the site in
Miami, which might cause announcements from São Paulo to be
hidden. Finally, the connectivity at the site in Japan is such that it
does not attract much tra(cid:28)c since announcements from other sites
are almost always preferred over it. Prior to the measurement, the
connectivity of each site was validated individually by announcing
our pre(cid:27)x from that location only. Such limitations are not particular
to our testbed as similar features can also be observed in public
anycast services [43].
Dataset: As shown in Table 1, we measured the catchment us-
ing both Verfploeter and Atlas on Wednesday, 2017-02-01 (UTC).
We also determined the catchment of Tangled, using only Verf-
ploeter, every 15 minutes during a 24 hour period starting 2017-03-
23 10:57 UTC, for a total of 96 measurements. In total we collected
342,604,759 ICMP replies, of which 324,675,876 remained after clean-
ing.
For each measurement we transmitted one ICMP packet to each
of the 6.4M IPs from the hitlist, at a rate of 10k/second to prevent
overloading networks or network equipment. Each measurement
round took approximately 10.5 minutes to complete. A unique
identi(cid:27)er in the ICMP header was used in every measurement
round to ensure data set separation.
5 ANALYSIS OF THE VERFPLOETER
MECHANISM
In this section we examine the Verfploeter measurement method.
We show the broader coverage of Verfploeter compared to RIPE
Atlas, and how catchment mapping from Verfploeter can be com-
bined to historic tra(cid:28)c load to accurately predict load at individual
anycast sites.
5.1 Utility: Operational Evaluation of Anycast
Catchments
A long-standing goal of anycast mapping is to assess load balancing
and routing problems [9, 43]. We next look at B-Root’s anycast
distribution. Deployed recently in May 2017, it has only two sites,
but we are able to deploy Verfploeter on it.
We have measured the geographic footprint of B-Root with RIPE
Atlas (Figure 2a) and Verfploeter (Figure 2b). These maps high-
light a couple of important di(cid:29)erences between these measurement
methods.
First, Verfploeter has much broader coverage: Atlas coverage is
good in Europe and reasonable in North America, but sparse else-
where and almost absent in China. Verfploeter provides good cover-
age for most of the populated globe. Second, even where coverage
is good, Verfploeter provides far more numerous observations—the
scale of Figure 2b is 1000× greater than Figure 2a.
These di(cid:29)erences are particularly important for examination of B-
Root catchments in South America and China. The broader coverage
is important to understand, for example, how a host in China might
select a B-Root site: Atlas cannot comment, but Verfploeter shows
most of China selects the MIA site.
The denser coverage in South America also helps highlighting
the impact of B-Root’s hosting ISPs. B-Root’s ISP in MIA (AMPATH)
is very well connected in Brazil and Argentina, but does not have
direct ties to the west coast of South America. This di(cid:29)erence shows
in the wider use of the MIA site in Brazil, and less use of it in Peru
and Chile.
Better coverage in locations like these that currently have poorer
coverage by RIPE Atlas are important, particularly since East and
South Asia are home to many Internet users but few Atlas VPs.
B-Root’s goal in measuring anycast is to understand routing
choices; we return to this question in §6.1.
5.2 Utility in Mapping Multi-Site Anycast
B-Root shows the bene(cid:27)ts of increased number of VPs with Verf-
ploeter, but we would like to understand how the di(cid:29)erent ap-
proaches work on anycast deployments with more sites. We there-
fore turn to Tangled: an anycast testbed designed and deployed by
us (§4.2).
Figure 3 maps the catchments of Tangled with Atlas and Verf-
ploeter. Again, outside of Europe, the greater density of coverage
of Verfploeter provides clear qualitative di(cid:29)erences between the
two maps. For example, the IAD site (dark yellow) shows up promi-
nently across North America with Verfploeter, but with Atlas, CDG
and ENS seem to serve that region. We also see very di(cid:29)erent mixes
of sites in Australia. And only Verfploeter provides coverage of
China.
The key result from these graphs is that Verfploeter coverage
tracks the Internet as a whole, not just where physical VPs can be
placed. We quantify this di(cid:29)erence in the next section.
5.3 Greater Coverage in Verfploeter
In §5.1 and §5.2 we showed how the greater coverage in Verfploeter
reveals aspects of B-Root and our testbed Tangled that would oth-
erwise be missed. This coverage is possible because Verfploeter’s
IMC ’17, November 1–3, 2017, London, United Kingdom
de Vries, Schmidt, Hardaker, Heidemann, de Boer, and Pras
(a) RIPE Atlas coverage of B-Root (Dataset: SBA-5-15)
(b) Verfploeter coverage of B-Root (Dataset: SBV-5-15).
Figure 2: Geographic coverage of vantage points for RIPE Atlas and Verfploeter for B-Root, in two-degree geographic bins. The
pie in each bin is colored by site (blue: LAX; yellow: MIA; red: other). Circle areas show number of address blocks (Verfploeter)
or VPs (Atlas) at di(cid:29)erent scales.
considered
non-responding
responding
no location
geolocatable
unique
RIPE Atlas
(/24s)
(VPs)
9083
9807
406
455
8677
9352
0
0
8677
9352
2079
Verfploeter
(/24s)
6,877,175
3,090,268
3,786,907
678
3,786,229
3606300
Table 4: Coverage of B-Root from the perspective of the
RIPE Atlas and Verfploeter measurement systems, mea-
sured in VPs (Atlas) or /24 blocks (both). (Datasets: SBA-5-15,
SBV-5-15)
passive VPs only require a computer that responds to ICMP, in-
stead of physically deployed devices (Figure 1); this way we can
cover millions of /24s.
To quantify the di(cid:29)erence in coverage that is visible in Fig-
ure 2, Table 4 compares how many blocks the two measurement
approaches see. For both systems we try to use all available VPs,
but some VPs are unavailable: for Atlas, 455 VPs do not respond
(within 406 blocks), presumably because they are temporarily down.
For Verfploeter, about 3M ping targets do not reply, presumably
because the target was temporarily down, or it was in a block of dy-
namic addresses and temporarily unused. If desired, both of these
non-response rates could be reduced by retrying later, or with ad-
ditional addresses for Verfploeter. All Atlas VPs have geolocation
(set when the VP is registered), but we discard a few Verfploeter
blocks (678) that we cannot geolocate.
The key result about coverage is that Verfploeter sees around
430× more blocks than Atlas. Although Atlas (cid:27)nds a few unique
blocks (presumably blocks that discard all pings), about 77% of Atlas
blocks are also seen by Verfploeter, and Verfploeter sees around
3.61M additional blocks.
5.4 From Observations to Load
We next look at how well di(cid:29)erent measurement systems relate to
actual load on an anycast service. It is well known that the distri-
bution of RIPE Atlas re(cid:30)ects more about who RIPE interacts with
than global Internet tra(cid:28)c—as an European project, and Europe
being the main region of RIPE NCC operation, Atlas’ deployment
is by far heavier in Europe than in other parts of the globe (and this
is a well known shortcoming [8]). Our goal here is to calibrate dif-
ferent measurement systems to best match actual tra(cid:28)c. We show
that, once calibrated, we can get very accurate predictions about
expected service load, but the calibration is necessary to account
for variation in load per block. Calibrated predictions are important
if Verfploeter is to be used for capacity planning.
Estimating Load: To estimate load on B-Root, we begin with
our prediction about anycast catchments from Verfploeter, then we
0306192123154184215246277+size (blocks)siteLAXMIAUNKCopyright (C) 2017 by University of Southern California020k41k61k82k103k123k144k164k185k+size (blocks)siteLAXMIACopyright (C) 2017 by University of Southern CaliforniaBroad and Load-Aware Anycast Mapping with Verfploeter
IMC ’17, November 1–3, 2017, London, United Kingdom
(a) RIPE Atlas coverage of Tangled (Dataset: STA-2-01).
(b) Verfploeter coverage of our nine-site testbed (Dataset: STV-2-01).
Figure 3: Catchments for Tangled from RIPE Atlas and Verfploeter. Circle areas show number of blocks (Verfploeter) or VPs
(Atlas) at di(cid:29)erent scales; each is a pie chart with colors showing each site.
weight each /24 block by our measurements of its known tra(cid:28)c
load (§3.2). There are blocks for which we do not have anycast
mapping, either because they do not reply to our probes, or because
the speci(cid:27)c address we chose to contact did not reply; these blocks
are mapped to “unknown”, indicating we cannot determine the
anycast mapping. (Although we assume their tra(cid:28)c will go to our
sites in similar proportion to blocks in known catchments.)
Figure 4a shows the result of this load prediction. It is useful to
compare this estimate to Figure 2b, which counts /24 blocks that
source tra(cid:28)c, and Figure 2a, which counts Atlas VPs.
The most striking operational di(cid:29)erence between measurements
of blocks and actual load estimates is that load seems to concentrate
tra(cid:28)c in fewer hotspots. This outcome should not be surprising:
DNS is a common service operated by most ISPs with a local re-
cursive resolver. Thus an ISP with users spread over a large region
may still send all DNS tra(cid:28)c through recursive resolvers housed at
a few data centers. Weighting coverage by load corrects for these
protocol-speci(cid:27)c e(cid:29)ects that are not seen directly in our ICMP-
based measurements.
Second, Verfploeter can only map blocks that respond to our
probes. Table 5 shows coverage as seen from B-Root’s tra(cid:28)c logs,
showing that there are a large number of blocks (about 12.9%) that
are not mapped. Figure 4a plots the load from these blocks in red,
showing that most are in Korea, with some in Japan and central
and southeast Asia. In §5.5 we show that these missing blocks do
not alter our predictions.
seen at B-Root
mapped by Verfploeter
not mappable
Blocks
/24s
1,388,338
986,605
401,733
Queries
%
% q/day
100% 2.19G
100%
87.1% 1.80G 82.4%
12.9%
384M 17.6%
Table 5: Coverage of Verfploeter from B-Root. (Dataset:
SBV-5-15, LB-5-15.)
Date
2017-04-21 Atlas
2017-05-15
2017-04-21 Verf-
2017-05-15
ploeter
2017-05-15 + load
2017-05-15 Act. Load
Method Measurement % LAX
68.8%
82.4%
82.4%
87.8%
81.6%
81.4%
967 VPs
9,682
4.069M /24s
3.923M
n/a q/day
2.188G q/day