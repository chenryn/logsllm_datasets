User: When nginx running by ordinary users listens to port 80/443, the service fails to start and the log output permission is denied. What is the reason and how to solve it?
Assistant: When ordinary users try to run Nginx on a Linux system and listen to port 80 or 443, the service fails to start and displays a permission denied error message, usually due to one of the following reasons: 1. Insufficient permissions: Ports 80 and 443 are low Privileged ports based on 1024, usually only specific system users (such as root) can listen to these ports. Normal users do not have sufficient privileges to bind these ports, thus causing a permission denied error. 2. Another process already occupies the port: If another process (such as another web server or Nginx instance) is already listening on port 80 or 443, ordinary users will not be able to bind the port. This also results in a permission denied error. To fix this, you can try one of the following workarounds: 1. Use root or sudo: Run Nginx as root or with the sudo command, which will grant sufficient permissions to listen on ports 80 and 443. Note that running Nginx as root can be a security risk, make sure to use it only when necessary. 2. Use an unprivileged port: Change the Nginx configuration to listen on an unprivileged port greater than 1024 (such as 8080 or 8443). These ports are not restricted by permissions, and normal users can use them to run Nginx. 3. Use a reverse proxy: If you want to configure Nginx to coexist with other web servers, you can consider using a reverse proxy. Configure Nginx to listen on an unprivileged port (such as 8080), and then forward traffic through a reverse proxy to port 80 or 443 that other web servers listen on. Note that each of these solutions has its own considerations and limitations. Choose the solution that works best for you based on your specific needs and security requirements.