title:You Can't Do Today's Security With Yesterday's Methods
author:Joe Sullivan
innova&ng	
  to	
  protect	
  the	
  graph	
NDSS	
  -­‐	
  2013	
innova&on	
  dis&nguishes	
  between	
  a	
  leader	
  and	
  a	
follower	
  -­‐	
  Steve	
  Jobs	
if	
  you’re	
  not	
  failing	
  every	
  now	
  and	
  again,	
  it’s	
  a	
  sign	
you’re	
  not	
  doing	
  anything	
  very	
  innova&ve	
  -­‐	
  Woody	
  Allen	
hack	
  =	
  a	
  usually	
  crea&ve	
  solu&on	
  to	
  a	
  programming	
  limita&on	
If	
  they	
  had	
  stopped	
  innova&ng	
If	
  they	
  had	
  stopped	
  innova&ng	
Facebook	
  Scale…	
•  Every	
  day:	
–  >2.5	
  billion	
  shares	
–  >2.7	
  billion	
  likes	
–  >300	
  million	
  photos	
–  >500	
  TB	
  new	
  data	
•  >100	
  PB	
  cluster	
•  Code	
  updated	
  twice	
daily	
Threats	
  Also	
  Constantly	
  Evolving	
•  Example	
  Areas	
  –	
  Product	
– User	
  Educa&on	
– Content	
  Screening	
– Event	
  Screening	
•  Example	
  Areas	
  –	
  Not	
  Product	
– Enforcement	
– Bug	
  Bounty	
– Drills	
– Employee	
  Educa&on	
– Corp	
  InfoSec	
Data	
  validates:	
  user	
  educa&on	
  works	
•  Proof:	
  contextual	
  messaging	
•  Proof:	
  social	
  repor&ng	
•  Proof:	
  HTTPS	
impact	
  of	
  Self	
  XSS	
  educa&on	
orange	
  =	
  spam	
  distro	
  /	
  blue	
  =	
  checkpoints	
social	
  repor&ng	
social	
  repor&ng	
  =	
  85%	
  of	
  &me	
  removal	
  or	
  conversa&on	
Security	
  se\ngs	
Login	
  approvals	
Link	
  Shim	
•  Intercept	
  oﬀ-­‐site	
  links	
•  Screen	
  against	
  classiﬁers	
  and	
  industry	
  lists	
•  Real-­‐&me	
  warnings	
•  Prevent	
  referrer	
  leakage	
•  Hashes	
  to	
  avoid	
  open	
  redirects	
•  Dynamically	
  rewrite	
  for	
  beaer	
  usability	
Photo DNA 
▪  Run	
  all	
  uploaded	
  photos	
  against	
hashes	
  provided	
  by	
  NCMEC.	
▪  Immediately	
  disable	
  users	
  who	
upload	
  an	
  image	
  on	
  the	
  hash	
  list	
and	
  send	
  image	
  and	
  User	
informa&on	
  to	
  NCMEC.	
▪  Inves&gate	
  users	
  caught	
  by	
Photo	
  DNA	
  to	
  locate	
  other	
images	
  and	
  poten&ally	
  escalate	
to	
  law	
  enforcement.	
Facebook	
  Immune	
  System	
•  Every	
  event	
  is	
  a	
  classiﬁca&on	
  problem	
•  Works	
  in	
  real	
  &me	
•  Combined	
  with	
  other	
  resources	
  and	
  inputs	
•  Random	
  Forests,	
  Logis&c	
  Regression,	
  SVMs,	
Naive	
  Bayes,	
  Boos&ng	
  Trees…	
Classifying	
  Spam	
•  User	
  reports	
•  Keywords	
•  Links	
•  IP	
  addresses	
•  And	
  more!	
Classifying	
  Compromised	
  Logins	
•  Number	
  of	
  recent	
  failures	
•  Geographic	
  loca&on	
•  Known	
  or	
  unknown	
  device	
•  And	
  more!	
Roadblocks	
•  Captchas	
•  Rate	
  limi&ng	
•  Disabling	
Malware	
  Checkpoint	
•  Detect	
  malware	
  behaviors?	
•  Prompt	
  for	
  free	
  an&-­‐virus	
  download	
•  Block	
  login	
  un&l	
  malware	
  is	
  cleared	
Social	
  Authen&ca&on	
•  Shown	
  photos	
  of	
  a	
  friend	
•  Required	
  to	
  iden&fy	
friend	
•  Easy	
  for	
  account	
  owner,	
diﬃcult	
  for	
  an	
  aaacker	
some&mes	
  the	
  best	
  defense	
  is	
  a	
  good	
  oﬀense	
Escalating Cases 
▪  Inves&ga&ons	
  into	
  high	
  value	
suspects	
▪  Suspects	
  &ed	
  to	
  real	
  Facebook	
accounts	
▪  Coordinate	
  with	
  Industry	
  on	
technical	
  takedowns	
▪  Work	
  with	
  Legal	
  on	
  lawsuits	
▪  Escalate	
  to	
  law	
  enforcement	
when	
  appropriate	
Bug	
  Bounty	
  Program	
•  Hack	
  Facebook	
•  Get	
  Paid	
•  Get	
  Press	
poli&cal	
  issues	
  security	
  ques&ons	
•  ﬁltering?	
•  forced	
  downgrades?	
•  MITM	
  aaacks?	
•  malicious	
  javascript?	
•  bogus	
  cer&ﬁcates?	
•  account	
  takeovers?	
corp	
  infosec	
•  Just	
  as	
  important	
– Expanded	
  bug	
  bounty	
– Teams	
  cover	
  both	
  and	
  think	
  about	
  both	
•  Products	
  disappoin&ng	
•  Endpoints	
  also	
  insecure	
•  “big	
  data”	
  investments	
  interes&ng	
•  Ridiculous	
  lack	
  of	
  talent	
  available	
  for	
hardening	
  work	
Watering	
  Hole	
  Aaack	
Research	
  happens…	
•  Just	
  announced	
  Michigan	
  partnership	
•  Regular	
  dialogue	
  with	
  Stanford	
  about	
  projects	
•  Founda&on	
  work	
  for	
  enterprise	
  anomalous	
behavior	
  detec&on	
  by	
  2012	
  intern	
•  MITM	
  detec&on	
  paper	
  forthcoming	
•  Social	
  Authen&ca&on	
  related	
  to	
  MSFT	
  paper	
•  User	
  Trust	
  work	
  ongoing	
•  innova&on	
  is	
  essen&al	
  on	
  the	
  internet	
•  security	
  teams	
  cannot	
  say	
  no	
  to	
  opportuni&es,	
must	
  show	
  how	
  to	
  do	
  it	
  safely,	
  and	
  constantly	
adapt	
•  a	
  culture	
  of	
  innova&on	
  starts	
  at	
  the	
  top	
•  any	
  team	
  can	
  be	
  innova&ve	
  if	
  everyone	
  feels	
broad	
  responsibility