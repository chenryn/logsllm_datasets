该工具可以在http://log2timeline.net/取得。
理服务器数据等）提取时间轴信息。这在怀疑数据或者日志已经被修改或者更新时可能有用。
sourceforge.net/loghound/
的行模式。这个工具的更多细节和研究论文可以在该工具的网站上找到：http://ristov.users.
仪表盘、可自定义报告和仪表盘以及有助于将Splunk集成到安全基础设施的供应商支持API。
15.6
一样，提出许多问题，尝试和供应商一起进行概念验证，然后购买适合你的解决方案。
样，我们建议对任何商业化产品进行完整的评估，确定它是否符合你的组织需求。和以往
免责声明
■免费版本每天最多处理500MB日志。虽然这听上去很多，但是大中型企业很快就会
Splunk（www.splunk.com）是一个商业化产品，提供许多我们在介绍OSSEC时提到的出
Splunk 的好处之一是它有免费和企业版本。你可以在 Splunk 网站上建立一个免费账户
安全业界领先企业有许多杰出的日志分析和留存解决方案，涵盖了从可以自行购买运行
Log2Timeline在取证分析中很有用。该工具从非传统来源（如回收站、Firefox历史、代
3.Log2Timeline
LogHound更像一个研究工具，它试图用广度优先算法挖掘日志文件，找出频繁出现
1.免费版与企业版的对比
2. LogHound
本书对本节中提到的商业化产品不做明确的提倡或者推荐。和环境中任何购买行为一
商业化日志工具
Splunk
---
## Page 224
提供的SIEM。QRader与众不同的特点之一是它可以为许多当前依从性框架对报告进行调整
能。和Qradar一起被收购的还有其他产品线，包括一个为需要完整安全信息管理工具的企业
用。和我们讨论过的许多产品一样，QRadar有广泛的日志源支持，以及广泛的搜索和报告功
2011年收购了qlLabs及其产品线。该产品本来有一个免费版本，但是从收购之后就不再可
15.6.3IBMq1Labs
户。超过以上限制的负载要求你购买Sentinel产品。该产品具有强大的搜索和报告功能。
速度限制在每秒25个事件。可以在http://www.novell.com/promo/slm/slm25.html创建一个账
Sentinel的企业版本可以为你的组织提供完整的安全信息管理工具。
信息，作为处理事故响应和事件取证的额外来源。如果你需要的不仅是日志管理，NetIQ
仅是日志管理和分析产品，而应该归人SIEM的类别。Sentinel包含了异常检测和身份管理
15.6.2NetlQSentinel
Splunk的这种特性显著地减少了从前面介绍的手工工具集中获得报告的时间。
许多自定义报告需求，或者需要为组织中不同利益相关方提供不同数据视图，它们会发现，
自定义，和我们讨论过的工具相比，这些功能对于某些组织来说是关键的差异。有些组织有
性能指标等。对于较不常见的输人，Splunk可以定义输入的细节，作为它处理和索引数据的
许多Web服务器日志。Spluk有丰富的“处方”，可以读取Web日志、J2EE日志、Windows
备“转发器”，可以从文件和目录读取信息，读取Windows事件和注册表信息，并支持读取
“处方”。
这个产品于2010年从Novell收购而来，免费版被限制为仅有日志管理功能，最大处理
QRadar（http://qllabs.com/products.aspx）是来自IBM的日志管理解决方案。IBM于
NetIQSentinel（https://www.netiq.com/products/sentinel/）和前面讨论的OSSIM类似，不
Splunk允许用户以仪表盘或者视图的形式，创建自己的数据视图。这些视图完全可以
3.仪表盘和视图
Splunk支持广泛的数据输人。它支持我们在本节中已经讨论过的许多输人源，如标准
■基于角色的身份认证只在企业版中可用。
■实时监控和警报只在Splunk企业版中可用，但是，你可以试用企业版60天来评估这
2.日志源支持
达到这个限值，几个真正繁忙的Web服务器就可能立刻超过这一限制。
一选项。
第15章日志分析和收集工具203
---
## Page 225
204
参考文献
提供了对于如何选择工具的一般指导原则。
15.7
组织。第21章中还有使用Loggly的Web界面发送和读取日志的示例。
升级你的日志系统。你可以研究第21章和该公司的网站，了解这个解决方案是否适合你的
求。Loggly的关键特征是为留存日志而在环境中安装的附加硬件有限，需要由其他人维护和
据。这个产品相对新颖，你应该评估其分析引擎的报告能力，确定它是否满足你的依从性需
已经介绍的许多数据源，以及通过RESTAPI编程发布数据，通过HTTP和HTTPS传递数
将在第21章中更详细地介绍它，以及在云中保存数据时需要考虑的因素。该产品支持我们
15.6.4Loggly
支持如下审计：
本章介绍了进行日志收集和分析的一些最常用工具，包括开源和商业化系统。而且，还
Loggly（http://loggly.com/）是一个云日志提供商，你的日志数据将被存储在云中。我们
■支付卡行业数据安全标准（PCIDSS）
■Sarbanes-Oxley（SOX）和联邦信息安全管理法案（FISMA）
Chuvakin,A.(2008).Howwouldyou do itSelecting alog management approach.http://www.
■健康保险隐私及责任法案（HIPAA）
Chuvakin,A.(201l）.Official pagefor critical log review checklist..
■北美电力可靠性公司（NERC）
Syslog.org.Syslog.orghome..
Rsyslog.com.Rsysloghome..
Ossec.net.Rules/decodersdocumentation..
GNU.org.GNUGrep2.13..
小结
com/2010/03/simple-log-review-checklist-released.html>.
source>.
slideshare.net/anton_chuvakin/choosing-your-log-management-approach-buy-build-or-out-
rp_data-breach-investigations-report-2012_en_xg.pdf>.
2012,
from
Verizon
Business:
---
## Page 226
来实现。这些主题在本书中已经作了介绍，本章将介绍日志数据审核、响应和升级。
些情况时进行评估、响应，并在必要时升级。SA部分通过启用日志数据收集、分析和留存
16.1概述
本章要点
录和管理的目标本质上是为你提供环境中的态势感知（SA），这样你就可以在网络中发生某
现在你已经熟悉了日志管理、日志分析、关联、过滤等主题，下一步是什么呢？日志记
你的组织很可能因为如下的某些原因而实施日志记录：
■定期运营任务附加信息
■假设、需求和预防措施
1）因为你想要保护公司的资产（知识产权、财务数据等）。
■管理报告
■
■
PCI依从性证据包
1常见角色和职责
日志簿—调查异常证据
审核、响应和升级规程以及日志审核的工作流验证
日志记录策略
PCI和日志数据
日志管理规程
■
第16章
司
厦
Chpptcr16
---
## Page 227
206
监管和运营日志需求。
和升级规程投入使用之前，假定如下需求已经得到满足。
能够按照需要实施这些过程。为了重申和解释这些要点，我们将提供支付卡行业（PCI）数据
络系统访问权限文档，到制作备份文档的报告（例如登录和注销记录）的一切事情。
情，还要求你能够证明自己真的遵循和维护你的策略和规程。这可能意味着从提供最新的网
16.2.1
16.2
安全标准（DSS）的例子。
内部威胁、数据丢失等。
本章中使用的方法是介绍可重复和可扩展的工作流，为你提供深入的领悟和理解，使你
1）创建日志记录策略（参见本章的16.5节），以编集PCIDSS日志相关需求，以及其他
必须有一组需求，本章描述的运营规程才能有效地使用：
这些关键项目对于日志记录、日志管理和日志审核的成功必不可少。在日志审核、响应
2）你所处行业（银行、医疗、信用卡处理等）要求监管依从性，确保你能够对抗外部和
警告
2）在范围内的系统上启用日志记录。
从现在开始，本章的余下部分将使用PCIDSS 的概念。
现在，第2种原因令人感兴趣。许多法规不仅从过程和规程的角度规定你必须做的事
3）你就是希望记录所有日志。
5）生成满足PCIDSS日志记录需求的日志。
3）日志记录的中断和终止本身必须记人日志、接受监控。
4）记录PCIDSS文档规定的事件。
假设、
本章中的素材只用于教育的目的。
作者不能保证实施本章中的规程和工作流程就能达到PCI依从性或者通过PCI验证。
不保证PCI依从性
SecurityAssessmentProcedures》，2010）。
是在全球采用这些需求。PCI的全部内容超出了本章的范围（《Requirements and
户、处理设备、发卡行和服务提供商在PCI中都有利害关系。该标准的终极目标
PCI
需求
DSS是一组技术和运营需求，意在保护信用卡持卡人数据免遭违规使用。商
DSS简介
需求和预防措施
---
## Page 228
第1条（日志记录策略）是最佳实践，无论如何应该遵循。
是因为你的组织很小，一人兼任多种角色。
16.3
已或者其他人踪迹的控制权。
运营需求：
16.2.2
事故响应人员
安全主管或者经理
安全分析人员
安全管理员
应用程序业务负责人
系统或者网络管理员
应用程序管理员
■关键预防措施：在特定系统上记录其操作的个人不能作为负责该系统日志审核的唯一
需要采取如下的预防措施，使日志可以用于PCIDSS 依从性、其他法规和安全、取证及
本章将介绍这些角色和职责，应该指出的是，你的组织可能没有定义所有角色，这可能
表16.1总结了本章中提到的涉及审核、升级和响应过程的常见角色。
这些预防措施的主要思路是确保系统完整性。本质上，没有一个人应该拥有能够掩盖自
■关键预防措施：PCIDSS强制实施日志安全措施，对日志的所有访问应该记录和监控
第2～7条可以适用于几乎每个环境，而第1条看起来相当特殊。
7）所有日志记录系统的时区已知并作记录，可以和日志一起审核。
6）范围内的系统时间和可靠的时间服务器（NTP等）同步。
识别终止或者影响日志存在和质量的企图。
当事人。
身兼多职可能导致利益冲突问题
角
为利益冲突，应该尽可能避免。
在日志数据审核、响应和升级中，
常见角色和职责
预防措施
色
用程序的安全控制
参与安全事故响应
监督安全策略、过程和运营
处理运营安全性过程
管理一个或者多个系统/应
负责应用程序的业务经理
管理底层操作系统或者网络
管理应用程序
职责
表16.1
常见角色和职责总结