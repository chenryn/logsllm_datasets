include email communication pattern and online activity data such
as web browsing patterns, and file and machine access patterns. In
company, features also incorporate login, printer and connect [46].
Another typical approach is transforming user’s behavior into
sequences or graphs and analyzing them [12, 35, 38, 40, 41, 47]. The
methods of this kind construct normal patterns of user behavior
and then compare them with new behavior or predict new one to
identify anomalies, while log2vec transforms relationships among
log entries into a graph and use graph embedding to mine anomalies
based on various relationships among log entries.
Provenance tracking systems are proposed to monitor and ana-
lyze activities of a system [17, 22, 26, 30, 55]. There exist two dif-
ferences between log2vec and them. First, a majority of them aim
for attack forensics instead of cyber threat detection. Second, these
systems utilize causal graphs to track operations and interactions of
processes (e.g. IPC syscalls operating on pipes and semaphores) in
the system-call level. Log2vec analyzes logs recording user’s behav-
ior in information system (e.g. connect a removable storage device
and browse a website). It mainly captures and represents multiple
relationships among logs that reflect user’s typical behavior.
HOLMES is an advanced approach to detect APT [34]. However,
it constructs high-level scenario graphs according to information
flows, only reflecting causal and sequential relationship among log
entries. Thereby, its detection results produced by these scored
graphs according to the severity levels of their components, cannot
achieve a satisfactory performance in our scenarios.
Graph Embedding. Graph analysis has been widely researched
and applied to diverse domains [8, 19, 53]. Among these methods,
graph embedding has risen great attention [44].
Recently, deep learning is used in graph embedding [28, 45]
probably due to its outstanding supervised learning ability. Xu et
al. utilize this kind of graph embedding to compute the similarity
of two binary functions from different platforms [59].
Word2vec-based graph embedding is another kind receiving high
concerns [14, 39, 42, 54]. In cybersecurity, Backes et al. use this
method to perform a social relation inference attack [3]. Inspired
by graph embedding and metapath [52], Dong et al. present a new
method processing heterogeneous graph that the above methods
cannot [11]. Log2vec improves this method and makes it applicable
to the heterogeneous graph in this paper.
9 CONCLUSIONS
We propose log2vec, a heterogeneous graph embedding based cyber
threat detection. To the best of our knowledge, log2vec involves
the first sophisticated and effective heterogeneous graph construc-
tion in this field. To analyze this graph, an improvement of graph
embedding is designed whose output is processed by a practical
detection algorithm. We implement a prototype of log2vec. The
evaluation demonstrates that log2vec outperforms other state-of-
the-art methods in log-level granularity. It can detect cyber threats
effectively in varied scenarios.
ACKNOWLEDGMENTS
We would like to thank the anonymous reviewers and Prof. Daphne
Yao for their constructive comments. We also thank Dr. Fangxiao
Ning’s technical help. This work was supported by the Strategic
Priority Research Program of CAS, Grant No.XDC02010300.
lllllllllllllll0.440.540.640.740.8413579Neighbor, neighAUCproportionlll1:1:1:11:1:1:31:1:1:6llllll0.520.610.700.790.88log2vec{e1,e4}{e2,e5}{e3,e6}{e7,e8}{e9,e10}Lack of the set of edge typeAUC0.000.250.500.751.000.000.250.500.751.00FPRTPRlog2veclog2vec−cosinelog2vec−euclideanSession 8C: Blockchain VICCS ’19, November 11–15, 2019, London, United Kingdom1789REFERENCES
[1] David Arthur and Sergei Vassilvitskii. 2007. K-means++: The Advantages of Care-
ful Seeding. In Proceedings of the Eighteenth Annual ACM-SIAM Symposium on
Discrete Algorithms (SODA ’07). Society for Industrial and Applied Mathematics,
Philadelphia, PA, USA, 1027–1035. http://dl.acm.org/citation.cfm?id=1283383.
1283494
[2] A. Azaria, A. Richardson, S. Kraus, and V. S. Subrahmanian. 2014. Behavioral
Analysis of Insider Threat: A Survey and Bootstrapped Prediction in Imbalanced
Data. IEEE Transactions on Computational Social Systems 1, 2 (June 2014), 135–155.
https://doi.org/10.1109/TCSS.2014.2377811
[3] Michael Backes, Mathias Humbert,
Jun Pang, and Yang Zhang. 2017.
Walk2Friends: Inferring Social Links from Mobility Profiles. In Proceedings of the
2017 ACM SIGSAC Conference on Computer and Communications Security (CCS ’17).
ACM, New York, NY, USA, 1943–1957. https://doi.org/10.1145/3133956.3133972
[4] A. Bohara, M. A. Noureddine, A. Fawaz, and W. H. Sanders. 2017. An Unsupervised
Multi-Detector Approach for Identifying Malicious Lateral Movement. In 2017
IEEE 36th Symposium on Reliable Distributed Systems (SRDS). 224–233. https:
//doi.org/10.1109/SRDS.2017.31
[5] Y. Chen, C. M. Poskitt, and J. Sun. 2018. Learning from Mutants: Using Code
Mutation to Learn and Monitor Invariants of a Cyber-Physical System. In 2018
IEEE Symposium on Security and Privacy (SP). 648–660. https://doi.org/10.1109/
SP.2018.00016
[6] Tobias Chyssler, Stefan Burschka, Michael Semling, Tomas Lingvall, and Kalle
Burbeck. 2004. Alarm Reduction and Correlation in Intrusion Detection Systems..
In DIMVA. 9–24.
[7] Matthew L. Collins, Michael C. Theis, Randall F. Trzeciak, Jeremy R. Strozer,
Jason W. Clark, Daniel L. Costa, Tracy Cassidy, Michael J. Albrethsen, and An-
drew Preston Moore. 2012. Common Sense Guide to Mitigating Insider Threats,
Fifth Edition. Common Sense Guide to Mitigating Insider Threats Edition (2012).
[8] Hanjun Dai, Bo Dai, and Le Song. 2016. Discriminative Embeddings of Latent
Variable Models for Structured Data. In Proceedings of the 33rd International
Conference on International Conference on Machine Learning - Volume 48 (ICML’16).
JMLR.org, 2702–2711.
[9] Songgaojun Deng, Huzefa Rangwala, and Yue Ning. 2019. Learning Dynamic
Context Graphs for Predicting Social Events. In Proceedings of the 25th ACM
SIGKDD International Conference on Knowledge Discovery & Data Mining (KDD
’19). ACM, New York, NY, USA, 1007–1016. https://doi.org/10.1145/3292500.
3330919
[10] The CERT Division. 2018. Insider Threat Tools. https://www.cert.org/insider-
[11] Yuxiao Dong, Nitesh V. Chawla, and Ananthram Swami. 2017. Metapath2Vec:
Scalable Representation Learning for Heterogeneous Networks. In Proceedings of
the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data
Mining (KDD ’17). ACM, New York, NY, USA, 135–144. https://doi.org/10.1145/
3097983.3098036
[12] Min Du, Feifei Li, Guineng Zheng, and Vivek Srikumar. 2017. DeepLog: Anom-
aly Detection and Diagnosis from System Logs Through Deep Learning. In
Proceedings of the 2017 ACM SIGSAC Conference on Computer and Commu-
nications Security (CCS ’17). ACM, New York, NY, USA, 1285–1298.
https:
//doi.org/10.1145/3133956.3134015
[13] Gaurang Gavai, Kumar Sricharan, Dave Gunning, Rob Rolleston, John Hanley,
and Mudita Singhal. 2015. Detecting Insider Threat from Enterprise Social and
Online Activity Data. In Proceedings of the 7th ACM CCS International Workshop
on Managing Insider Security Threats (MIST ’15). ACM, New York, NY, USA, 13–20.
https://doi.org/10.1145/2808783.2808784
[14] Aditya Grover and Jure Leskovec. 2016. Node2Vec: Scalable Feature Learning
for Networks. In Proceedings of the 22Nd ACM SIGKDD International Conference
on Knowledge Discovery and Data Mining (KDD ’16). ACM, New York, NY, USA,
855–864. https://doi.org/10.1145/2939672.2939754
[15] James A. Hanley. 1988. The Robustness of the "Binormal" Assumptions Used in
Fitting ROC Curves. Medical Decision Making 8, 3 (1988), 197–203. https://doi.org/
10.1177/0272989X8800800308 arXiv:https://doi.org/10.1177/0272989X8800800308
PMID: 3398748.
[16] Wajih Ul Hassan, Shengjian Guo, Ding Li, Zhengzhang Chen, Kangkook Jee,
Zhichun Li, and Adam Bates. 2019. NoDoze: Combatting Threat Alert Fatigue
with Automated Provenance Triage. Network and Distributed Systems Security
Symposium (Feb 2019). http://par.nsf.gov/biblio/10085663
[17] Md Nahid Hossain, Sadegh M Milajerdi, Junao Wang, Birhanu Eshete, Rigel
Gjomemo, R Sekar, Scott D Stoller, and VN Venkatakrishnan. 2017. SLEUTH:
Real-time attack scenario reconstruction from COTS audit data. In Proc. USENIX
Secur. 487–504.
[18] P. Hu, H. Li, H. Fu, D. Cansever, and P. Mohapatra. 2015. Dynamic defense
strategy against advanced persistent threat with insiders. In 2015 IEEE Conference
on Computer Communications (INFOCOM). 747–755. https://doi.org/10.1109/
INFOCOM.2015.7218444
[19] Zhipeng Huang, Yudian Zheng, Reynold Cheng, Yizhou Sun, Nikos Mamoulis, and
Xiang Li. 2016. Meta Structure: Computing Relevance in Large Heterogeneous
threat/tools/.
37–65 pages.
Information Networks. In Proceedings of the 22Nd ACM SIGKDD International
Conference on Knowledge Discovery and Data Mining (KDD ’16). ACM, New York,
NY, USA, 1595–1604. https://doi.org/10.1145/2939672.2939815
[20] Luca Invernizzi, Stanislav Miskovic, Ruben Torres, Christopher Kruegel,
Sabyasachi Saha, Giovanni Vigna, Sung-Ju Lee, and Marco Mellia. 2014. Nazca:
Detecting Malware Distribution in Large-Scale Networks.. In NDSS, Vol. 14. 23–
26.
[21] Alexander D. Kent. 2016. Cyber security data sources for dynamic network research.
[22] Samuel T. King and Peter M. Chen. 2003. Backtracking Intrusions. In Proceedings
of the Nineteenth ACM Symposium on Operating Systems Principles (SOSP ’03).
ACM, New York, NY, USA, 223–236. https://doi.org/10.1145/945445.945467
[23] Thomas N Kipf and Max Welling. 2016. Semi-supervised classification with graph
convolutional networks. arXiv preprint arXiv:1609.02907 (2016).
[24] Bum Jun Kwon, Jayanta Mondal, Jiyong Jang, Leyla Bilge, and Tudor Dumitraş.
2015. The Dropper Effect: Insights into Malware Distribution with Downloader
Graph Analytics. In Proceedings of the 22Nd ACM SIGSAC Conference on Computer
and Communications Security (CCS ’15). ACM, New York, NY, USA, 1118–1129.
https://doi.org/10.1145/2810103.2813724
[25] Aron Laszka, Jian Lou, and Yevgeniy Vorobeychik. 2016. Multi-defender strategic
filtering against spear-phishing attacks. In Thirtieth AAAI Conference on Artificial
Intelligence.
[26] Kyu Hyung Lee, Xiangyu Zhang, and Dongyan Xu. 2013. High Accuracy Attack
Provenance via Binary-based Execution Partition.. In NDSS. The Internet Society.
http://dblp.uni-trier.de/db/conf/ndss/ndss2013.html#LeeZX13
[27] P. A. Legg, O. Buckley, M. Goldsmith, and S. Creese. 2015. Caught in the act
of an insider attack: detection and assessment of insider threat. In 2015 IEEE
International Symposium on Technologies for Homeland Security (HST). 1–6. https:
//doi.org/10.1109/THS.2015.7446229
[28] Zemin Liu, Vincent W. Zheng, Zhou Zhao, Fanwei Zhu, Kevin Chen-Chuan
Chang, Minghui Wu, and Jing Ying. 2017. Semantic Proximity Search on Hetero-
geneous Graph by Proximity Embedding.
[29] Ponemon Institute LLC. 2016. Cost of Cyber Crime 2016: Reducing the Risk of
Business Innovation. https://saas.hpe.com/en-us/marketing/cyber-crime-risk-
to-business-Innovation. Accessed Augest 22, 2017.
[30] Shiqing Ma, Juan Zhai, Fei Wang, Kyu Hyung Lee, Xiangyu Zhang, and Dongyan
Xu. 2017. MPI: Multiple perspective attack investigation with semantics aware
execution partitioning. In USENIX Security.
[31] Emaad Manzoor, Sadegh M. Milajerdi, and Leman Akoglu. 2016. Fast Memory-
efficient Anomaly Detection in Streaming Heterogeneous Graphs. In Proceedings
of the 22Nd ACM SIGKDD International Conference on Knowledge Discovery and
Data Mining (KDD ’16). ACM, New York, NY, USA, 1035–1044. https://doi.org/
10.1145/2939672.2939783
[32] Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean. 2013. Efficient
Estimation of Word Representations in Vector Space. CoRR abs/1301.3781 (2013).
arXiv:1301.3781
[33] Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg S Corrado, and Jeff Dean. 2013.
Distributed Representations of Words and Phrases and their Compositionality. In
Advances in Neural Information Processing Systems 26, C. J. C. Burges, L. Bottou,
M. Welling, Z. Ghahramani, and K. Q. Weinberger (Eds.). Curran Associates, Inc.,
3111–3119.
[34] S. Momeni Milajerdi, R. Gjomemo, B. Eshete, R. Sekar, and V. Venkatakrishnan.
2019. HOLMES: Real-Time APT Detection through Correlation of Suspicious
Information Flows. In 2019 2019 IEEE Symposium on Security and Privacy (SP).
IEEE Computer Society, Los Alamitos, CA, USA, 447–462. https://doi.org/10.
1109/SP.2019.00026
[35] Pablo Moriano, Jared Pendleton, Steven Rich, and L Jean Camp. 2017. Insider
Threat Event Detection in User-System Interactions. In Proceedings of the 2017
International Workshop on Managing Insider Security Threats (MIST ’17). ACM,
New York, NY, USA, 1–12. https://doi.org/10.1145/3139923.3139928
[36] Mathias Niepert, Mohamed Ahmed, and Konstantin Kutzkov. 2016. Learning
convolutional neural networks for graphs. In International conference on machine
learning. 2014–2023.
[37] Namyong Park, Andrey Kan, Xin Luna Dong, Tong Zhao, and Christos Faloutsos.
2019. Estimating Node Importance in Knowledge Graphs Using Graph Neural
Networks. In Proceedings of the 25th ACM SIGKDD International Conference on
Knowledge Discovery & Data Mining (KDD ’19). ACM, New York, NY, USA, 596–
606. https://doi.org/10.1145/3292500.3330855
[38] P. Parveen, N. McDaniel, V. S. Hariharan, B. Thuraisingham, and L. Khan. 2012.
Unsupervised Ensemble Based Learning for Insider Threat Detection. In 2012
International Conference on Privacy, Security, Risk and Trust and 2012 International
Confernece on Social Computing. 718–727. https://doi.org/10.1109/SocialCom-
PASSAT.2012.106
[39] Bryan Perozzi, Rami Al-Rfou, and Steven Skiena. 2014. DeepWalk: Online Learn-
ing of Social Representations. In Proceedings of the 20th ACM SIGKDD Interna-
tional Conference on Knowledge Discovery and Data Mining (KDD ’14). ACM, New
York, NY, USA, 701–710. https://doi.org/10.1145/2623330.2623732
Session 8C: Blockchain VICCS ’19, November 11–15, 2019, London, United Kingdom1790[40] William Eberle PhD, Jeffrey Graves, and Lawrence Holder PhD. 2010. Insider
Threat Detection Using a Graph-Based Approach. Journal of Applied Secu-
rity Research 6, 1 (2010), 32–81. https://doi.org/10.1080/19361610.2011.529413
arXiv:https://doi.org/10.1080/19361610.2011.529413
[41] Tabish Rashid, Ioannis Agrafiotis, and Jason R.C. Nurse. 2016. A New Take
on Detecting Insider Threats: Exploring the Use of Hidden Markov Models. In
Proceedings of the 8th ACM CCS International Workshop on Managing Insider
Security Threats (MIST ’16). ACM, New York, NY, USA, 47–56. https://doi.org/10.
1145/2995959.2995964
[42] Leonardo F.R. Ribeiro, Pedro H.P. Saverese, and Daniel R. Figueiredo. 2017.
Struc2Vec: Learning Node Representations from Structural Identity. In Proceed-
ings of the 23rd ACM SIGKDD International Conference on Knowledge Discov-
ery and Data Mining (KDD ’17). ACM, New York, NY, USA, 385–394. https:
//doi.org/10.1145/3097983.3098061
[43] Peter J. Rousseeuw. 1987. Silhouettes: A graphical aid to the interpretation
and validation of cluster analysis. J. Comput. Appl. Math. 20 (1987), 53 – 65.
https://doi.org/10.1016/0377-0427(87)90125-7
[44] Sam T. Roweis and Lawrence K. Saul. 2000. Nonlinear Dimensionality Reduction
https:
by Locally Linear Embedding. Science 290, 5500 (2000), 2323–2326.
//doi.org/10.1126/science.290.5500.2323
[45] F. Scarselli, M. Gori, A. C. Tsoi, M. Hagenbuchner, and G. Monfardini. 2009. The
Graph Neural Network Model. IEEE Transactions on Neural Networks 20, 1 (Jan
2009), 61–80. https://doi.org/10.1109/TNN.2008.2005605
[46] Ted E. Senator, Henry G. Goldberg, Alex Memory, William T. Young, Brad Rees,
Robert Pierce, Daniel Huang, Matthew Reardon, David A. Bader, Edmond Chow,
Irfan Essa, Joshua Jones, Vinay Bettadapura, Duen Horng Chau, Oded Green,
Oguz Kaya, Anita Zakrzewska, Erica Briscoe, Rudolph IV L. Mappus, Robert
McColl, Lora Weiss, Thomas G. Dietterich, Alan Fern, Weng-Keen Wong, Shub-
homoy Das, Andrew Emmott, Jed Irvine, Jay-Yoon Lee, Danai Koutra, Christos
Faloutsos, Daniel Corkill, Lisa Friedland, Amanda Gentzel, and David Jensen.
2013. Detecting Insider Threats in a Real Corporate Database of Computer Usage
Activity. In Proceedings of the 19th ACM SIGKDD International Conference on
Knowledge Discovery and Data Mining (KDD ’13). ACM, New York, NY, USA,
1393–1401. https://doi.org/10.1145/2487575.2488213
[47] Yun Shen, Enrico Mariconti, Pierre Antoine Vervier, and Gianluca Stringhini. 2018.
Tiresias: Predicting Security Events Through Deep Learning. In Proceedings of the
2018 ACM SIGSAC Conference on Computer and Communications Security (CCS
’18). ACM, New York, NY, USA, 592–605. https://doi.org/10.1145/3243734.3243811
[48] Xiaokui Shu, Danfeng Yao, and Naren Ramakrishnan. 2015. Unearthing Stealthy
Program Attacks Buried in Extremely Long Execution Paths. In Proceedings of the
22Nd ACM SIGSAC Conference on Computer and Communications Security (CCS
’15). ACM, New York, NY, USA, 401–413. https://doi.org/10.1145/2810103.2813654
[49] Xiaokui Shu, Danfeng (Daphne) Yao, Naren Ramakrishnan, and Trent Jaeger.
2017. Long-Span Program Behavior Modeling and Attack Detection. ACM Trans.