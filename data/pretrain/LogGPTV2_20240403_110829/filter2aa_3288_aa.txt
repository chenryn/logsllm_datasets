Attacks from a New Front Door 
in 4G & 5G 
mobile networks
Dr. Altaf Shaik & Shinjo Park
TU Berlin
& FastIoT
Blackhat USA 2022
Attacks so far in mobile networks
●
Radio access network – IMSI catchers, False base stations
●
Signaling interconnect – SS7, Diameter interfaces
●
SIM attacks – authentication, sim jacker
●
SMS spam, smshing
●
Backdoors (Wiretapping)
New front door: exposure function
Core
Exposure 
Function
4G/5G
Core 
SS7/
Diameter
RAN
Network 
Partners
Vertical 
Industries
Third-party
Application 
developers
New 
Door
Devices/IoT
New front door: exposure function
Server from 
(MVNO, MNO,
IoT service Provider, 
platform provider)
Internet
Core
Vertical 
Industries
Third-party
Application 
developers
REST
APIs
Exposure 
Function
4G/5G
Core 
Northbound 
APIs
Service 
APIs
RAN
Enterprise 
domain
Applications 
domain
Exposure function: Drone use-case
Source: https://www.connectivity.technology/2021/01/cellular-connected-drones-to-form-part.html
Cellular-connected 
Drones to Form Part 
of Vodafone’s ‘Telco 
as a Service’ (‘TaaS’) 
Model 
Vodafone’s 5G Mobility Lab in Aldenhoven, Germany
Overview
●
Access to network exposure
●
Features and configurations
●
Security investigation
●
Design risks
●
Findings (vulnerabilities)
●
Responsible Disclosure
●
Takeaways
Control IoT with 4G and 5G networks
API Server (Provider)
IoT Service Platform
Backend 
IoT Connectivity
Management
Platform
API Portal
Service APIs
Internet
Cloud
Vertical 
Industries
Third-party
Application 
developers
REST
APIs
Exposure 
Function
4G/5G
Core 
Network
+
IoT 
SIM
Access to network exposure 
services via IoT service platforms
●
IoT SIM cards (with IP-data and SMS tariff)
–
e.g., 750MB, 250 SMS, 10 year lifetime, roaming free, 10 $$  
●
Radio connectivity: 4G networks (NB-IoT, LTE-M, 2G)
●
Contact service 
provider for IoT 
platform access 
Prove industry/
 company identity 
(e.g.,using Tax ID)
Subscribe to a business
 plan (including NB-IoT/
 LTE-M SIM cards 
Receive SIM cards 
(Mail) and API portal 
access (email)
SIM card and API
 user(s) activation:  
create credentials
Access service APIs 
and integrate into 
IoT application function
Flow diagram: obtaining access to exposure services
Access to network exposure 
services via IoT service platforms
After business agreement, access is granted to 
–
IoT connectivity management platform
●
User/SIM management web application
●
SIM status, activation and deactivation
IoT connectivity 
management 
platform 
Access to network exposure 
services via IoT service platforms
IoT service platform
●
Service APIs portal (swagger/OpenAPI interface)
●
30 – 100 APIs for IoT device connectivity status, tracking, SMS exchange, IP 
data exchange (e.g., ping)
●
Applications like smart factory, VR, fleet tracking, vehicle telematics
●
billing and data plan management, SIM & credential management, device IP 
address management, roaming policy control, etc.
●
API access roles: API administrator, API user, Developer
Example platforms and APIs
Service APIs 
inside IoT 
Service 
platform
API security for Network Exposure
3GPP Standard (recommended) fundamental security mechanisms for 
exposure services
–
Authentication & Authorization (OAuth 2.0)
–
Confidentiality and integrity protection (TLS)
–
Privacy
–
Rate limiting*
–
Logging and Monitoring*
–
Guidelines from GSMA1,2 
*additional security best-practices
1. GSM Association. Iot security guidelines for network operators version 2.2
https://www.gsma.com/iot/wp-content/uploads/2020/05/CLP.14-v2.2-GSMA-IoT-Security-Guidelines-for-Network-Operators.pdf
2. GSM Association.  IoT SECURITY GUIDELINES for IoT Service Ecosystems
https://www.gsma.com/iot/wp-content/uploads/2016/02/CLP.12-v1.0.pdf
How it works: Get device location
Submit credentials for Authentication
Receive access token for authorization
HTTPS (TLS) security establishment
API Request : Device connectivity and location status
API Response: Device connectivity and location status
API: /auth  (username, password)
←
"access_token": "AYjcyMzY3ZDhiNmJkNTY",
"expires_in": 14400,
GET https://1.2.3.4/api/sim/89**28**66**03**35*/status
Authorization: Token AYjcyMzY3ZDhiNmJkNTY
HTTP/2.0 200 OK
"location": {
    "country": {
        "latitude": "*", "longitude": "*",
        "mcc": "2**", "mnc": "*"
    },
    "iccid": "89**28**66**03**35*",
    "imsi": "2****63281***77",
    "msisdn": "*81*0*1*9*1*7",
    "organisation_id": "4977",
    "operator_name": "********",
    "sgsn_addr": "4*1.VS*PZ**.epc.mnc*.mcc*.3gpp.org"
},
"status": "ONLINE"
API user
API server
Device location updates from VLR and HSS
"pdp_context": {
    "ggsn_ip_addr": "10.70.4.17",
    "rat_type": { "description": "NB-IoT" },
    "sgsn_control_plane_ip_addr": "10.73.4.5",
    "ue_ip_address": "100.96.15.132"
},
Commercial IoT service platform 
features and configuration
- SP: Service platform
 Type of exposure: See document by NGMN
- Credentials: Username + Password
- Current network exposure using 4G core (SCEF)
HSTS:  HTTP Strict-Transport-Security
Attack model in service Platforms
●
Requirements
–
business relationship with the operator or service provider (can forge a tax ID)
●
authentication credentials to get authenticated and authorized  
●
access to all service APIs, platform and connectivity management platform
●
Goals: obtain data of arbitrary IoT service platform users (industries), compromise server and penetrate           
into mobile core network via the exposure function
●
Privileges: Web/API knowledge Internet, using HTTP(S), remotely-located, use VPN or tor.
Industries
 &
Attacker
HTTP(S)
Security problems with IoT platforms?
●
Standard security mechanisms. Are they sufficient
●
Business logic flaws targeting IoT applications
–
Require manual intensive testing
●
Web/API Firewalls or security-by-design
●
Security scanners and automated testing
●
Limited knowledge on attacks on IoT service platforms
Our interests in the platform
●
Dynamic API security analysis on 9 commercial IoT service platforms
–
To find vulnerabilities in
●
API configuration, input validation, business flow, authentication, access-control, and transport layer 
security such as encryption.
–
Select APIs that have high impact on business, reputation
●
Billing fraud, DoS, code execution, device hijacking 
●
Send SMS or IP messages to arbitrary IoT devices, Reset billing and charging counters, APN 
manipulation, location tracking, device blacklisting
–
Model a set of Attacks:
●
Inject Malicious payloads, strings, characters, files
●
Guidelines from OWASP web security testing, REST security cheat sheets
●
Tools: Burpsuite, ZAP and other well-known for API testing
Ethical considerations
●
Only access or manipulate API data corresponding to our own user/admin accounts. 
●
Only key API parameters (like IMSI,ICCID, APN, Tariff, topup, MSISDN, SMS) per platform are 
analyzed for vulnerabilities – to avoid traffic towards API platform
●
GET/POST/PUT operations are carried out into our own accounts
●