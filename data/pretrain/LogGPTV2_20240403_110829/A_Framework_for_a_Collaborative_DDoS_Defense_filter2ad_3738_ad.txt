Figure 4. Partial deployment experiments
(a) Throughput in ML1
(b) Throughput in ML2
Figure 5. Experiment with malicious classiﬁers, and rate limiters on routers R2.3 and R2.4
(a) Throughput in ML3
(b) Throughput in ML4
Figure 6. Experiment with malicious classiﬁers, and rate limiters on all level-2 routers
8
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:32:41 UTC from IEEE Xplore.  Restrictions apply. 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006If Net3 and Net4 had legitimate users, along with attack ma-
chines and a compromised classiﬁer, then their trafﬁc would
also be penalized. This is unfortunate, but ultimately a com-
promised classiﬁer is a problem that should be handled by
local security administrators.
Finally, we show how the protection changes if we de-
ploy rate limiters at level-2, at routers R2.3 and R2.4. In the
experiment ML3 we disable active testing, and we enable
it in the experiment ML4. The throughput is shown in the
Figure 6. Because attack trafﬁc passes through more Def-
COM nodes it is better controlled and competes less with
the legitimate trafﬁc. Even without active testing, the legit-
imate trafﬁc’s service is signiﬁcantly improved when com-
pared with experiment ML1. In ML4, malicious children
are quickly identiﬁed and legitimate trafﬁc is protected.
6.4. Deployment and operation cost
We measure the attack detection time from the start of
the attack to the issue of the ﬁrst ALRM message, and the
attack response time from the ﬁrst ALRM message to the
ﬁrst attack packet drop. For the experiments described in
this paper, attack detection time was 1.58—2.45 seconds
and the attack response time was 1.78—2.93 seconds. Note
again that these experiments used a very simple attack de-
tection mechanism.
The number of messages exchanged by a DefCOM node
depends on number of its peers, and the setting of DefCOM
parameters Tr, Tend, Trto, Tchange and pJOIN. In our large-
scale experiments we had around 5 messages per second
per node and this number did not grow during attacks. We
also tested robustness to message loss by deliberately drop-
ping a certain percentage of DefCOM control messages.
Our experiments indicate that DefCOM can tolerate <20%
message loss, and its performance quickly degrades with
higher loss rates. DefCOM’s packet processing time on 850
MHZ Pentium III was around 0.5 µs without the attack and
it grew to 1.3 µs in a rate limiter and a classiﬁer during
the attack. Additionally, the rate limiter’s packet processing
time should include WFSA cost. Our WFSA implementa-
tion took around 50 µs per packet, most of which was spent
running custom-written code for exponentiation (since this
function is not implemented in Linux kernel) needed for rate
estimation. In real-world implementation these operations
would be done through a much faster, hardware fair queue-
ing module in commercial routers.
7. Deployment Motivation
End-network defenses would beneﬁt from DefCOM by
achieving wider observation and policing perimeter. Dis-
tributed defenses would also beneﬁt, and we illustrate this
claim by discussing an integration of the distributed TVA
[18] defense with DefCOM. TVA uses server-issued capa-
bilities to differentiate between legitimate and suspicious
trafﬁc. Routers help create capabilities, rate limit new ca-
pability requests and give highest priority to capability-
carrying trafﬁc, then to request trafﬁc and ﬁnally to legacy
trafﬁc. TVA can handle all attacks as well as DefCOM
and should outperform DefCOM with ﬂash-crowd attacks.
However, TVA is always active and its processing and mem-
ory cost are high. DefCOM can lower TVA’s cost by: (1)
having attack alerts serve as power-on signals for TVA so
that processing cost is paid only during attacks and (2)
TVA senders would mark capability-carrying trafﬁc with a
HIGH-priority mark; DefCOM would pass legitimate pack-
ets over to TVA for ﬁner, more expensive checks only if
total HIGH-marked trafﬁc exceeds RLM.
DefCOM has a good economic model for all deploying
networks. Alert generators provide victim-end networks
with means to request help in handling DDoS attacks. Clas-
siﬁers guarantee good service to legitimate trafﬁc during
the attack, which directly beneﬁts the deploying network.
Rate limiters can be deployed by ISPs as a service they can
sell to their customers. As customers usually request their
ISP’s help when under a ﬂooding DDoS attack, deploying
a DefCOM rate limiter would streamline these requests and
make response faster and more accurate. Our experiments
indicate that DefCOM can be very effective in partial de-
ployment. Still, the robustness against malicious classiﬁers
and the ability to provide good service to legitimate trafﬁc
from legacy networks increases with wide deployment. We
believe that a strong economic model and the ability to inte-
grate diverse defense systems with DefCOM will naturally
motivate wide deployment of this framework.
8. Related Work
We review here only those approaches that provide some
form of cooperative defense between different nodes or
share other strong similarities to DefCOM. We omit TVA
[18] because we discussed it in the previous section.
SOS [6] uses access points (SOAPs) close to source net-
works to verify legitimate users and send their trafﬁc on the
overlay to secret servlets, that tunnel it to a distributed ﬁre-
wall protecting the victim. SOS offers good protection to
the server but the trafﬁc experiences a signiﬁcant delay be-
cause it is routed on the overlay. Mayday [1] generalizes
SOS approach with a variety of authentication and overlay
routing mechanisms and suffers from similar drawbacks.
Pushback [5] enables routers to identify high-bandwidth
aggregates that contribute to congestion rate limit them. If
the congested router cannot control the aggregate itself, it
requests its upstream neighbor’s help in rate limiting. The
performance of Pushback is good when attackers are collo-
cated on a path separate from the legitimate trafﬁc, other-
9
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:32:41 UTC from IEEE Xplore.  Restrictions apply. 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006wise it inﬂicts collateral damage. Further, Pushback cannot
work in non-contiguous deployment and cannot detect at-
tacks that do not congest core routers.
Active Security System (ASSYST) [3] supports dis-
tributed response with non-contiguous deployment, with
nodes equivalent to classiﬁers being deployed only at edge
networks. COSSACK [10] similarly forms a multicast
group of defense nodes that are deployed at source and vic-
tim networks and cooperate in ﬁltering the attack. Both [3]
and [10] cannot handle attacks from legacy networks that do
not deploy their defense mechanisms. Parameter Based De-
fense [14] constructs a multicast group at an ISP that rate
limits an attack originated from one of its customer net-
works. It requires wide deployment and does not perform
well in non-contiguous deployment. Yau et al. propose a
router throttle mechanism [19] installed at the routers that
are close to the victim.
In contrast to DefCOM, this de-
fense system incorporates only victim-end and core defense
mechanisms, and thus inﬂicts collateral damage to legiti-
mate trafﬁc. Like DefCOM, the router based solution [13]
consists of an overlay of routers with added functionality,
which helps them trace and stop the attacks close to the
source. Tracing is done using signatures assigned to each
source network, and inﬂicts collateral damage on legitimate
users that share a network with an attacker.
9. Conclusion
DefCOM is an innovative and scalable distributed de-
fense framework that facilitates collaboration among di-
verse DDoS defense systems through secure messages ex-
changed via an overlay network. DefCOM enables each
node to perform functions it can do best, while complement-
ing its weaknesses with the strengths of others. Victim net-
works are protected against DDoS attacks, source networks
are guaranteed that their legitimate trafﬁc will reach the vic-
tim and the Internet backbones can crucially contribute to
the war against DDoS attacks, by selling this extra service.
DefCOM provides a good economic model for all involved
parties, which should naturally lead to wide deployment.
We have extensively tested DefCOM covering a wide vari-
ety of network scenarios; in all cases, it offered excellent
protection to legitimate trafﬁc during a DDoS attack.
References
[1] D. G. Andersen. Mayday: Distributed Filtering for Internet
Services. In 4th Usenix Symposium on Internet Technologies
and Systems, Seattle, WA, March 2003.
[2] T. Benzel, B. Braden, D. Kim, C. Neuman, A. Joseph,
K. Sklower, R. Ostrenga, and S. Schwab. Experience with
DETER: A testbed for security research. In Proceedings of
TRIDENTCOM, March 2006.
10
[6] A. Keromytis, V. Misra, and D. Rubenstein. SOS: An Ar-
chitecture for Mitigating DDoS Attacks. IEEE Journal on
Selected Areas in Communications, 22(1), January 2004.
[7] J. Mirkovic. D-WARD: source-end defense against dis-
tributed denial-of-service attacks. PhD thesis, UCLA, 2003.
[8] J. Mirkovic, G. Prier, and P. L. Reiher. Attacking DDoS at
the Source. In Proceedings of the International Conference
on Network Protocols, pages 312–321, 2002.
[9] J. Mirkovic, M. Robinson, and P. Reiher. Alliance forma-
tion for DDoS defense. In Proceedings of the New Security
Paradigms Workshop, pages 11–18, New York, NY, USA,
2003. ACM Press.
[3] R. Canonico, D. Cotroneo, L. Peluso, S. P. Romano, and
G. Ventre. Programming routers to improve network secu-
rity. In OPENSIG 2001 Workshop Next Generation Network
Programming, September 2001.
[4] P. Ferguson and D. Senie. Network Ingress Filtering: De-
feating Denial of Service Attacks which employ IP Source
Address Spooﬁng. RFC 2267, 2000.
[5] J. Ioannidis and S. M. Bellovin.
Implementing Pushback:
In ISOC
Router Based Defense Against DDoS Attacks.
Symposium on Network and Distributed System Security,
February 2002.
[10] C. Papadopoulos, R. Lindell, J. Mehringer, A. Hussain, and
R. Govindan. COSSACK: Coordinated Suppression of Si-
multaneous Attacks. In Proceedings of DISCEX, pages 2–
13, 2003.
[11] S. Savage, D. Wetherall, A. Karlin, and T. Anderson. Practi-
cal network support for IP traceback. In Proceedings of the
ACM SIGCOMM, pages 295–306, 2000.
[12] S. Shin, K. Kim, and J. Jang. D-SAT: Detecting SYN Flood-
In SAINT
ing Attack by Two-Stage Statistical Approach.
Symposium, pages 430–436, 2005.
[13] Z. Shu and P. Dasgupta. Denying Denial-of-Service Attacks:
A Router Based Solution. In International Conference on
Internet Computing, pages 301–307, 2003.
[14] Q. Song. Perimeter-Based Defense against High Bandwidth
IEEE Transactions on Parallel and Dis-
DDoS Attacks.
tributed Systems, 16(6):526–537, 2005.
[15] I. Stoica, S. Shenker, and H. Zhang. Core-stateless fair
queueing: a scalable architecture to approximate fair band-
IEEE/ACM
width allocations in high-speed networks.
Transactions on Networking, 11(1):33–46, 2003.
[16] H. Wang and K. G. Shin. Transport-aware ip routers:
A built-in protection mechanism to counter ddos attacks.
IEEE Transactions on Parallel and Distributed Systems,
14(9):873–884, 2003.
[17] B. White, J. Lepreau, L. Stoller, R. Ricci, S. Guruprasad,
M. Newbold, M. Hibler, C. Barb, and A. Joglekar. An inte-
grated experimental environment for distributed systems and
networks. In Proceedings of the Operating System Design
and Implementation, pages 255–270, 2002.
[18] X. Yang, D. Wetherall, and T. Anderson. A DoS-limiting
network architecture. In Proceedings of ACM SIGCOMM,
pages 241–252, 2005.
[19] D. K. Y. Yau, J. C. S. Lui, F. Liang, and Y. Yam. Defending
against distributed denial-of-service attacks with max-min
fair server-centric router throttles. IEEE/ACM Transactions
on Networking, 13(1):29–42, 2005.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:32:41 UTC from IEEE Xplore.  Restrictions apply. 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006