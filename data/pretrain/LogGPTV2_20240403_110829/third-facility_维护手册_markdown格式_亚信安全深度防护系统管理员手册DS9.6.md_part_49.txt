"Quotes" "Quotes" HKLM\Software\Sample\"Quotes"
back\slash back\\slash HKLM\Software\Sample\back\\slash
trailing\ trailing\\ HKLM\Software\Sample\trailing\\
HKLM\Software\Sample\
@ @ HKLM\Software\Sample\@
子元素
• IInncclluuddee
• EExxcclluuddee
有关 include/exclude 的允许属性和子元素，请参阅 include/exclude 的一一般般说说明明((第第 221188页页))。
242
亚信安全服务器深度安全防护系统 9.6 管理员指南 ServiceSet
ServiceSet
ServiceSet 元素代表一组服务（仅限 Windows）。服务按“服务名称”标识，与服务管理工具中显示的“名称”列不同。服务名称可在
服务属性中看到，通常比“名称”列显示的值简短，“名称”列中实际上是服务的“显示名称”。例如，客户端的服务名称为
"ds_agent"，显示名称为“亚信安全服务器深度安全防护系统客户端”。
标记属性
相对于完整性监控规则所监控的实体的属性，以下属性是标记本身的 XML 属性。
属属性性 描描述述 必必需需 缺缺省省值值 允允许许值值
onChange 将受实时监控 否 false true、false
实体集属性
以下是可由完整性监控规则监控的实体的属性。
• PPeerrmmiissssiioonnss：：采用 SDDL 格式的服务的安全描述符。
• OOwwnneerr：：服务所有者的用户 ID
• GGrroouupp：：服务所有者的组 ID
• BBiinnaarryyPPaatthhNNaammee：：Windows 用于启动服务的路径和可选命令行自变量。
• DDiissppllaayyNNaammee：：服务“属性”面板中显示的服务的“显示名称”。
• DDeessccrriippttiioonn：：“服务”面板中显示的描述
• SSttaattee：：服务的当前状态。以下状态之一：已停止、正在启动、正在停止、正在运行、继续挂起、暂停挂起、已暂停
• SSttaarrttTTyyppee：：服务的启动方式。以下状态之一：自动、已禁用、手动。
• LLooggOOnnAAss：：服务进程运行时将登录的帐户名称。
• FFiirrssttFFaaiilluurree：：服务首次不成功时执行的操作。格式为 "delayInMsec,action"，操作为 None、Restart、Reboot、RunCommand
之一。
• SSeeccoonnddFFaaiilluurree：：服务第二次不成功时执行的操作。格式为 "delayInMsec,action"，操作为 None、Restart、Reboot、
RunCommand 之一。
• SSuubbsseeqquueennttFFaaiilluurreess：：服务第三次或随后几次不成功时执行的操作。格式为 "delayInMsec,action"，操作为 None、Restart、
Reboot、RunCommand 之一。
• RReesseettFFaaiillCCoouunnttAAfftteerr：：在无故障情况下将故障计数重置为 0 之前经过的时间（以秒为单位）。
• RReebboooottMMeessssaaggee：：重新启动以响应 "Reboot" 服务控制器操作之前广播至服务器用户的消息。
• RRuunnPPrrooggrraamm：：为响应 RunCommand 服务控制器操作要执行的进程的完整命令行。
• DDeeppeennddssOOnn：：服务所依赖的组件的逗号分隔列表
• LLooaaddOOrrddeerrGGrroouupp：：此服务所属的加载顺序组。系统启动程序使用加载顺序组按指定顺序（相对于其他组）加载服务的组。加载
顺序组列表包含在以下注册表值中：HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\ServiceGroupOrder
• PPrroocceessssIIdd：：这是托管服务的进程的数字 ID。单个 Windows 进程中可能存在多个服务，但对于在自身进程中运行的服务，监控
此属性将允许系统记录服务重新启动。
速记属性
以下是实体的速记属性及其要解析为的属性
243
亚信安全服务器深度安全防护系统 9.6 管理员指南 ServiceSet
• SSTTAANNDDAARRDD：Permissions、Owner、Group、BinaryPathName、Description、State、StartType、LogOnAs、FirstFailure、
SecondFailure、SubsequentFailures、ResetFailCountAfter、RunProgram、DependsOn、LoadOrderGroup、ProcessId
"Key" 的含义
Key 是服务的名称，未必与服务管理工具中显示的“名称”列相同（该工具显示服务的“显示名称”）。服务名称可在服务属性中看到，
通常比“名称”列显示的值简短。
注意： 这并不是层次结构实体集。模式仅适用于服务名称。因此，** 模式并不适用。
子元素
• IInncclluuddee
• EExxcclluuddee
请参阅 include 的概概述述((第第 221188页页))，了解其允许的属性和子元素。此处仅包含特定于与此实体集类相关的 include/exclude 的信息。
ServiceSets 的 Include/Exclude 的特殊属性：
状状态态
Include/exclude 可以基于任意服务的状态（已停止、正在启动、正在停止、正在运行、继续挂起、暂停挂起、已暂停）。以下示例将监
控正在运行的服务集中的更改：
244
亚信安全服务器深度安全防护系统 9.6 管理员指南 UserSet
UserSet
UserSet 元素代表一组用户。在 Windows 系统上，该元素在系统中的本地用户上工作―与“本地用户和组”MMC 嵌入式管理单元显示的用
户相同。请注意，只有当 DSA 在除域控制器外的设备上运行时，这些才是本地用户。在域控制器上，UserSet 元素将枚举所有域用户，这
可能不适用于极大型的域。
在 Unix 系统上，受监控的用户为 "getpwent_r()" 和 "getspnam_r()" API 已配置为要返回的用户。
标记属性
相对于完整性监控规则所监控的实体的属性，以下属性是标记本身的 XML 属性。
属属性性 描描述述 必必需需 缺缺省省值值 允允许许值值
onChange 将受实时监控 否 false true、false
实体集属性
以下是可监控的实体属性：
通用属性
• ccaannnnoottCChhaannggeePPaasssswwoorrdd：：True/false，表示是否允许用户更改其密码。
• ddiissaabblleedd：：True/false，表示是否已禁用帐户。在 Windows 系统上，这反映用户的“已禁用”复选框。在 Unix 系统上，如果
用户的帐户已过期，或密码过期且已超出更改密码的非活动宽限期，则该属性为 true。
• ffuullllNNaammee：：用户的显示名称。
• ggrroouuppss：：用户所属的组的逗号分隔列表。
• hhoommeeFFoollddeerr：：主文件夹或目录的路径。
• lloocckkeeddOOuutt：：True/false，表示用户是否已被锁定（明确锁定或由于密码尝试不成功次数过多）。
• ppaasssswwoorrddHHaassEExxppiirreedd：：True/false，表示用户密码是否已过期。请注意，在 Windows 上，此属性仅在 Windows XP 更高版本的
操作系统上可用。（不适用于 AIX）
• ppaasssswwoorrddLLaassttCChhaannggeedd：：上次更改用户密码的时间戳。此属性由 DSA 记录为 1970 年 1 月 1 日 (UTC) 以来的毫秒数 — 亚信
安全服务器深度安全防护系统管理中心基于该值按本地时间呈现时间戳。请注意，在 Unix 平台上，此属性解析为一天，因此
所呈现时间戳的时间部分没有意义。（在 AIX 中，N/A）
• ppaasssswwoorrddNNeevveerrEExxppiirreess：：True/false，表示密码是否不过期。
• uusseerr：：操作系统已知用户的名称。例如，"Administrator" 或 "root"。
仅限 Windows 的属性
• ddeessccrriippttiioonn：：用户所属的主组。
• hhoommeeDDrriivveeLLeetttteerr：：网络共享作为用户主文件夹映射到的驱动器盘符。
• llooggoonnSSccrriipptt：：用户每次登录时执行的脚本的路径。
• pprrooffiilleePPaatthh：：使用漫游或强制 Windows 用户配置文件时的网络路径。
245
亚信安全服务器深度安全防护系统 9.6 管理员指南 UserSet
仅限 Linux 的属性
• ggrroouupp：：用户所属的主组。
• llooggoonnSShheellll：：用户的 shell 进程的路径。
• ppaasssswwoorrddEExxppiirreeddDDaayyssBBeeffoorreeDDiissaabblleedd：：用户密码过期后到禁用帐户之间经过的天数。（在 AIX 中，N/A）
• ppaasssswwoorrddEExxppiirryy：：用户帐户过期且被禁用的日期。
• ppaasssswwoorrddEExxppiirryyIInnDDaayyss：：必须更改用户密码前经过的天数。
• ppaasssswwoorrddMMiinnDDaayyssBBeettwweeeennCChhaannggeess：：更改密码所允许的最小间隔天数。
• ppaasssswwoorrddWWaarrnniinnggDDaayyss：：用户密码过期之前开始警告用户的天数。
速记属性
• 标标准准型型：：cannotChangePassword、disabled、groups、homeFolder、passwordHasExpired、passwordLastChanged、
passwordNeverExpires、user、logonScript（仅限 Windows）、profilePath（仅限 Windows）、group（仅限 Linux）、
logonShell（仅限 Linux）、passwordExpiryInDays（仅限 Linux）、passwordMinDaysBetweenChanges（仅限 Linux）
"Key" 的含义
Key 代表用户名。这并不是层次结构实体集。模式仅适用于用户名。因此，"**" 模式并不适用。
以下示例监控所有用户创建或删除。（请注意，属性被明确排除，因此将不跟踪组成员集）：
以下示例将跟踪 "jsmith" 帐户的创建和删除，以及该帐户的 STANDARD 属性的更改（因为如果未包含特定属性列表，则自动包含此
EntitySet 的 STANDARD 集）：
子元素
Include 和 Exclude
请参阅 include 的概述，了解其允许的属性和子元素。
UserSets 的 Include/Exclude 的特殊属性
可将用户的各种其他属性用于 include/exclude 功能测试。这些测试将某个值与用户的属性值作比较；请注意各种属性的平台支持―在平
台（或甚至平台修订版）间并非所有属性均可用，因此在 include/exclude 元素中使用这些测试是受限制的。功能测试支持带有通配符 *
和 ? 的 Unix 全局样式，且不存在规范化的路径分隔符或其他字符—是与属性值的简单匹配。
• DDiissaabblleedd：：与用户的 disabled 属性进行 true/false 匹配。以下示例将监控主组为 "users" 或 "daemon" 的用户：
246
亚信安全服务器深度安全防护系统 9.6 管理员指南 UserSet
• GGrroouupp：：与用户的主组进行通配符匹配。此测试仅在 Unix 系统上可用。以下示例将监控主组为 "users" 或 "daemon" 的用
户。
• LLoocckkeeddOOuutt：：与用户的 lockedOut 属性进行 true/false 匹配。
• PPaasssswwoorrddHHaassEExxppiirreedd：：与用户的 passwordHasExpired 属性进行 true/false 匹配。
• PPaasssswwoorrddNNeevveerrEExxppiirreess：：与用户的 passwordNeverExpires 属性进行 true/false 匹配。
247
亚信安全服务器深度安全防护系统 9.6 管理员指南 WQLSet
WQLSet
WQLSet 元素描述了来自 Windows Management Instrumentation WQL 查询语句的结果集。通过 WQL，可以对多种不同的对象类进行类似于
SQL 的查询，查询结果将形成包含多行的表，其中每一行代表一个对象，每一列代表特定对象属性的值。
注意： 许多 WMI 查询占用大量时间和计算机资源。一不小心就会执行需要几分钟才能完成并返回数千行的查询。强烈建议在
WQLSet 中使用查询之前使用程序（如PowerShell或WMI Explorer）测试所有查询。
必必 缺缺省省
属属性性 描描述述 允允许许值值
需需 值值
设置 代表有效 WMI 命名空间的字符串值。
WMI 查
namespace 询的命 是 N/A "root\cimv2" 是查询 Windows 操作系统对象时最常用的命名空间，但也可使用其他命名空间，如 "root\directory\LDAP" 和
名空 "root\Microsoft\SqlServer\ComputerManagement"。请参阅此处，了解枚举给定主机上可用 WMI 命名空间的小脚本（名为
间。 GetNamespaces.vbs）。
一个有效的 WQL 字符串。
WQL 查
wql 询字符 是 N/A 查询必须包含每个返回的对象的 __Path 属性；客户端在存储和报告结果时将 __Path 属性用作实体键，因此每个返回的 WMI 对
串。 象都必须包含 __Path。如果使用诸如 "SELECT * FROM ..." 的查询字符串，将提供 __Path 属性；但是，如果使用更具选择性
的查询，如 "SELECT Name FROM ..."，您必须通过将查询编写为 "SELECT __Path,Name FROM ..." 明确包含 __Path。
是否应
当实时
onChange 监控返 否 false true、false
回的文
件。
RsopLoggingModeProvider
选择性 目前，只有组策略查询需要/支持此属性，且 "RsopLoggingModeProvider" 是唯一支持的值。组策略查询是特殊的查询，因为建
指定要 议使用 RsopLoggingModeProvider 创建计算机上的策略数据的快照。如果创建策略数据的快照，则可以在系统刷新策略期间覆盖
使用的 或删除一组一致性数据之前根据该数据执行查询。创建快照实际上创建了新的 WMI 命名空间，因此在 WQLSet 中使用
备用 provider="RsopLoggingModeProvider" 时，namespace 属性应指定要添加到所创建命名空间的后缀。例如，由
provider 否 无
WMI 命 RsopLoggingModeProvider 创建的典型的临时命名空间为 "\\.\Root\Rsop\NS71EF4AA3_FB96_465F_AC1C_DFCF9A3E9010"。指定
名空间 namespace="Computer" 以查询 "\\.\Root\Rsop\NS71EF4AA3_FB96_465F_AC1C_DFCF9A3E9010\Computer"。
提供程