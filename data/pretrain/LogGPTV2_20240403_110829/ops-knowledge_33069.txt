### 问题描述

我正在使用Arch Linux系统尝试连接到公司提供的Juniper SRX100H VPN。我使用的是Strongswan (版本5.5.3-3)，并且连接似乎成功了，但无法ping通任何目标地址，除了10.0.0.1。

以下是相关日志信息：

```
Starting strongSwan 5.5.3 IPsec [starter]...
generating QUICK_MODE request 2638887156 [ HASH SA No KE ID ID ]
sending packet: from 192.168.1.204[4500] to 10.0.0.1[4500] (396 bytes)
received packet: from 10.0.0.1[4500] to 192.168.1.204[4500] (364 bytes)
parsed QUICK_MODE response 2638887156 [ HASH SA No KE ID ID ]
CHILD_SA test{2} established with SPIs cad5681f_i 4015b7bd_o and TS 192.168.1.204/32 === 192.168.32.0/24
connection 'test' established successfully
```

尽管连接成功，但我只能ping通10.0.0.1，而无法访问192.168.32.0/24网段内的任何设备。

### 配置文件

我的`ipsec.conf`配置如下：

```plaintext
conn test
    left=%any
    leftid=test@SRX100-local.de
    leftauth=psk
    leftauth2=xauth
    rightsubnet=192.168.32.0/24
    rightid=10.0.0.1
    rightauth=psk
    auto=start
    xauth_identity=USER
    esp=aes256-sha1-modp1536
    ike=aes256-sha2_256-modp1536
    aggressive=yes
    type=tunnel
```

### 路由表

`ip route show`的输出为：

```plaintext
default via 192.168.1.1 dev wlp3s0 proto static metric 600 
192.168.1.0/24 dev wlp3s0 proto kernel scope link src 192.168.1.204 metric 600
```

### iptables 规则

`iptables-save`的输出为：

```plaintext
# Generated by iptables-save v1.6.1 on Tue Aug  8 11:24:43 2017
*filter
:INPUT ACCEPT [5:2010]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [7:999]
-A INPUT -s 192.168.32.0/24 -d 192.168.1.204/32 -i wlp3s0 -m policy --dir in --pol ipsec --reqid 1 --proto esp -j ACCEPT
-A OUTPUT -s 192.168.1.204/32 -d 192.168.32.0/24 -o wlp3s0 -m policy --dir out --pol ipsec --reqid 1 --proto esp -j ACCEPT
COMMIT
# Completed on Tue Aug  8 11:24:43 2017
```

### charon_debug.log

详细的调试日志见：[https://pastebin.com/jYiqpLip](https://pastebin.com/jYiqpLip)

### 解决方案

通过IRC上的帮助（感谢@ecdsa），我发现缺少了以下配置项：

- `leftsourceip=%config`
- `modeconfig=push`

因为Juniper SRX100H会推送必要的设置给客户端，所以需要这些配置来接收并应用这些设置。

希望以上信息对您有所帮助！如果您有其他问题，请随时联系我。