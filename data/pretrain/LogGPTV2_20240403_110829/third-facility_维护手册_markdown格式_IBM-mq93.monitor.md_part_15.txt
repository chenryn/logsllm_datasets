PutTime
Description: Time when message was put.
Data type: MQCHAR8.
Value: Set as normal.
ApplOriginData
Description: Application data relating to origin.
Data type: MQCHAR4.
Value: Set as normal..
128 Monitoring and Performance for IBM MQ
Trace-route message MQEPH (Embedded PCF header)
Use this page to view the values contained by the MQEPH structure for a trace-route message
The MQEPH structure contains a description of both the PCF information that accompanies the message
data of a trace-route message, and the application message data that follows it. An MQEPH structure is
used only if additional user message data follows the TraceRoute PCF group.
For a trace-route message, the MQEPH structure contains the following values:
StrucId
Description: Structure identifier.
Data type: MQCHAR4.
Value: MQEPH_STRUC_ID.
Version
Description: Structure version number.
Data type: MQLONG.
Values: MQEPH_VERSION_1.
StrucLength
Description: Structure length.
Data type: MQLONG.
Value: Total length of the structure including the PCF parameter structures that follow
it.
Encoding
Description: Numeric encoding of the message data that follows the last PCF parameter
structure.
Data type: MQLONG.
Value: The encoding of the message data.
CodedCharSetId
Description: Character set identifier of the message data that follows the last PCF parameter
structure.
Data type: MQLONG.
Value: The character set of the message data.
Format
Description: Format name of the message data that follows the last PCF parameter structure.
Data type: MQCHAR8.
Value: The format name of the message data.
Flags
Description: Flags that specify attributes of the structure or control its processing.
Data type: MQLONG.
IBM MQ Monitoring and performance 129
Value: MQEPH_NONE
No flags specified.
MQEPH_CCSID_EMBEDDED
Specifies that the character set of the parameters containing character data
is specified individually within the CodedCharSetId field in each structure.
PCFHeader
Description: Programmable Command Format Header
Data type: MQCFH.
Value: See “Trace-route message MQCFH (PCF header)” on page 130.
Trace-route message MQCFH (PCF header)
Use this page to view the PCF values contained by the MQCFH structure for a trace-route message
For a trace-route message, the MQCFH structure contains the following values:
Type
Description: Structure type that identifies the content of the message.
Data type: MQLONG.
Value: MQCFT_TRACE_ROUTE
Message is a trace-route message.
StrucLength
Description: Structure length.
Data type: MQLONG.
Value: MQCFH_STRUC_LENGTH
Length in bytes of MQCFH structure.
Version
Description: Structure version number.
Data type: MQLONG.
Values: MQCFH_VERSION_3
Command
Description: Command identifier. This identifies the category of the message.
Data type: MQLONG.
Values: MQCMD_TRACE_ROUTE
Trace-route message.
MsgSeqNumber
Description: Message sequence number. This is the sequence number of the message within
a group of related messages.
Data type: MQLONG.
Values: 1.
130 Monitoring and Performance for IBM MQ
Control
Description: Control options.
Data type: MQLONG.
Values: MQCFC_LAST.
CompCode
Description: Completion code.
Data type: MQLONG.
Values: MQCC_OK.
Reason
Description: Reason code qualifying completion code.
Data type: MQLONG.
Values: MQRC_NONE.
ParameterCount
Description: Count of parameter structures. This is the number of parameter structures that
follow the MQCFH structure. A group structure (MQCFGR), and its included
parameter structures, are counted as one structure only.
Data type: MQLONG.
Values: 1 or greater.
Trace-route message data
Use this page to view the parameters that make up the TraceRoute PCF group part of trace-route message
data
The content of trace-route message data depends on the Accumulate parameter from the TraceRoute PCF
group. Trace-route message data consists of the TraceRoute PCF group, and zero or more Activity PCF
groups. The TraceRoute PCF group is detailed in this topic. Refer to the related information for details of
the Activity PCF group.
Trace-route message data contains the following parameters:
TraceRoute
Description: Grouped parameters specifying attributes of the trace-route message. For a
trace-route message, some of these parameters can be altered to control how it
is processed.
Identifier: MQGACF_TRACE_ROUTE.
Data type: MQCFGR.
Contained in PCF None.
group:
IBM MQ Monitoring and performance 131
Parameters in Detail
group:
RecordedActivities
UnrecordedActivities
DiscontinuityCount
MaxActivities
Accumulate
Forward
Deliver
Detail
Description: The detail level that will be recorded for the activity.
Identifier: MQIACF_ROUTE_DETAIL.
Data type: MQCFIN.
Contained in PCF TraceRoute.
group:
Values: MQROUTE_DETAIL_LOW
Activities performed by user-written application are recorded.
MQROUTE_DETAIL_MEDIUM
Activities specified in MQROUTE_DETAIL_LOW are recorded. Additionally,
activities performed by MCAs are recorded.
MQROUTE_DETAIL_HIGH
Activities specified in MQROUTE_DETAIL_LOW, and
MQROUTE_DETAIL_MEDIUM are recorded. MCAs do not record any further
activity information at this level of detail. This option is only available to
user-written applications that are to record further activity information.
RecordedActivities
Description: The number of activities that the trace-route message has caused, where
information was recorded.
Identifier: MQIACF_RECORDED_ACTIVITIES.
Data type: MQCFIN.
Contained in PCF TraceRoute.
group:
UnrecordedActivities
Description: The number of activities that the trace-route message has caused, where
information was not recorded.
Identifier: MQIACF_UNRECORDED_ACTIVITIES.
Data type: MQCFIN.
Contained in PCF TraceRoute.
group:
DiscontinuityCount
Description: The number of times a trace-route message has been received from a queue
manager that does not support trace-route messaging.
Identifier: MQIACF_DISCONTINUITY_COUNT.
132 Monitoring and Performance for IBM MQ
Data type: MQCFIN.
Contained in PCF TraceRoute.
group:
MaxActivities
Description: The maximum number of activities the trace-route message can be involved in
before it stops being processed.
Identifier: MQIACF_MAX_ACTIVITIES.
Data type: MQCFIN.
Contained in PCF TraceRoute.
group:
Value: A positive integer
The maximum number of activities.
MQROUTE_UNLIMITED_ACTIVITIES
An unlimited number of activities.
Accumulate
Description: Specifies whether activity information is accumulated within the trace-route
message, and whether a reply message containing the accumulated activity
information is generated before the trace-route message is discarded or is put
on a non-transmission queue.
Identifier: MQIACF_ROUTE_ACCUMULATION.
Data type: MQCFIN.
Contained in PCF TraceRoute.
group:
Value: MQROUTE_ACCUMULATE_NONE
Activity information is not accumulated in the message data of the trace-
route message.
MQROUTE_ACCUMULATE_IN_MSG
Activity information is accumulated in the message data of the trace-route
message.
MQROUTE_ACCUMULATE_AND_REPLY
Activity information is accumulated in the message data of the trace-route
message, and a trace-route reply message will be generated.
Forward
Description: Specifies queue managers that the trace-route message can be forwarded to.
When determining whether to forward a message to a remote queue manager,
queue managers use the algorithm that is described in Forwarding.
Identifier: MQIACF_ROUTE_FORWARDING.
Data type: MQCFIN.
Contained in PCF TraceRoute.
group:
IBM MQ Monitoring and performance 133
Value: MQROUTE_FORWARD_IF_SUPPORTED
The trace-route message is only forwarded to queue managers that will
honor the value of the Deliver parameter from the TraceRoute group.
MQROUTE_FORWARD_ALL
The trace-route message is forwarded to any queue manager, regardless of
whether the value of the Deliver parameter will be honored.
Deliver
Description: Specifies the action to be taken if the trace-route message arrives at the
destination queue successfully.
Identifier: MQIACF_ROUTE_DELIVERY.
Data type: MQCFIN.
Contained in PCF TraceRoute.
group:
Value: MQROUTE_DELIVER_YES
On arrival, the trace-route message is put on the target queue. Any
application performing a destructive get on the target queue can receive
the trace-route message.
MQROUTE_DELIVER_NO
On arrival, the trace-route message is discarded.
Trace-route reply message reference
Use this page to obtain an overview of the trace-route reply message format. The trace-route reply
message data is a duplicate of the trace-route message data from the trace-route message for which it
was generated
Trace-route reply message format
Trace-route reply messages are standard IBM MQ messages containing a message descriptor and
message data. The message data contains information about the activities performed on a trace-route
message as it has been routed through a queue manager network.
Trace-route reply messages contain the following information:
A message descriptor
An MQMD structure
Message data
A PCF header (MQCFH) and trace-route reply message data
Trace-route reply message data consists of one or more Activity PCF groups.
When a trace-route message reaches its target queue, a trace-route reply message can be generated that
contains a copy of the activity information from the trace-route message. The trace-route reply message
will be delivered to a reply-to queue or to a system queue.
Table 21 on page 135 shows the structure of a trace-route reply message, including parameters that are
only returned under certain conditions.
134 Monitoring and Performance for IBM MQ
Table 21. Trace-route reply message format
MQMD structure PCF header MQCFH structure Trace-route reply message data
Structure identifier PCF header (MQCFH) Activity
Structure version Structure type Activity application name
Report options Structure length Activity application type
Message type Structure version Activity description
Expiration time Command identifier Operation
Feedback Message sequence number Operation type
Encoding Control options Operation date
Coded character set ID Completion code Operation time
Message format Reason code Message
Priority Parameter count Message length
Persistence MQMD
Message identifier EmbeddedMQMD
Correlation identifier Queue manager name
Backout count Queue sharing group name
Reply-to queue Queue name 1 2 3
Reply-to queue manager Resolved queue name 1 3
User identifier Remote queue name 3
Accounting token Remote queue manager-
Application identity data name 2 3 4 5
Application type Feedback 2
Application name Channel name 4 5
Put date Channel type 4 5
Put time Transmission queue name 5
Application origin data TraceRoute
Group identifier Detail
Message sequence number Recorded activities
Offset Unrecorded activities
Message flags Discontinuity count
Original length Max activities
Accumulate
Deliver
Note:
1.Returned for Get and Browse operations.
2.Returned for Discard operations.
3.Returned for Put, Put Reply, and Put Report operations.
4.Returned for Receive operations.
5.Returned for Send operations.
Trace-route reply message MQMD (message descriptor)
Use this page to view the values contained by the MQMD structure for a trace-route reply message
For a trace-route reply message, the MQMD structure contains the parameters described in Activity report
message descriptor. Some of the parameter values in a trace-route reply message descriptor are different
from those in an activity report message descriptor, as follows:
MsgType
Description: Type of message.
Data type: MQLONG.
IBM MQ Monitoring and performance 135
Value: MQMT_REPLY
Feedback
Description: Feedback or reason code.
Data type: MQLONG.
Value: MQFB_NONE
Encoding
Description: Numeric encoding of message data.
Data type: MQLONG.
Value: Copied from trace-route message descriptor.
CodedCharSetId
Description: Character set identifier of message data.
Data type: MQLONG.
Value: Copied from trace-route message descriptor.
Format
Description: Format name of message data
Data type: MQCHAR8.
Value: MQFMT_ADMIN
Admin message.
Trace-route reply message MQCFH (PCF header)
Use this page to view the PCF values contained by the MQCFH structure for a trace-route reply message
The PCF header (MQCFH) for a trace-route reply message is the same as for a trace-route message.
Trace-route reply message data
The trace-route reply message data is a duplicate of the trace-route message data from the trace-route
message for which it was generated
The trace-route reply message data contains one or more Activity groups. The parameters are described
in “Activity report message data” on page 107.
Accounting and statistics messages
Queue managers generate accounting and statistics messages to record information about the MQI
operations performed by IBM MQ applications, or to record information about the activities occurring in
an IBM MQ system.
Accounting messages
Accounting messages are used to record information about the MQI operations performed by IBM MQ
applications, see “Accounting messages” on page 137.
Statistics messages
Statistics messages are used to record information about the activities occurring in an IBM MQ
system, see “Statistics messages” on page 140. Some activity recorded in statistics messages relates
to internal queue manager operations.
136 Monitoring and Performance for IBM MQ
Accounting messages and statistics messages as described here are not available on IBM
MQ for z/OS, but equivalent functionality is available through the System Management Facility (SMF).
Accounting and statistics messages are delivered to one of two system queues. User applications can
retrieve the messages from these system queues and use the recorded information for various purposes:
• Account for application resource use.
• Record application activity.
• Capacity planning.
• Detect problems in your queue manager network.
• Assist in determining the causes of problems in your queue manager network.
• Improve the efficiency of your queue manager network.
• Familiarize yourself with the running of your queue manager network.
• Confirm that your queue manager network is running correctly.
Related concepts
“Using System Management Facility” on page 321
You can use SMF to collect statistics and accounting information. To use SMF, certain parameters must be
set in z/OS and in IBM MQ.
Accounting messages
Accounting messages record information about the MQI operations performed by IBM MQ applications.
An accounting message is a PCF message that contains a number of PCF structures.
When an application disconnects from a queue manager, an accounting message is generated and
delivered to the system accounting queue (SYSTEM.ADMIN.ACCOUNTING.QUEUE). For long running IBM
MQ applications, intermediate accounting messages are generated as follows:
• When the time since the connection was established exceeds the configured interval.
• When the time since the last intermediate accounting message exceeds the configured interval.
Accounting messages are in the following categories:
MQI accounting messages
MQI accounting messages contain information relating to the number of MQI calls made using a
connection to a queue manager.
Queue accounting messages
Queue accounting messages contain information relating to the number of MQI calls made using