### Title: Black Hat US-19: Monsters in the Middleboxes: Building Tools for Detecting HTTPS Interception

HTTPS interception is a widespread practice on the internet. In a standard HTTPS connection, a client (such as a web browser) establishes a TLS (Transport Layer Security) connection directly with the origin server to send requests and download content. However, many internet connections do not follow this direct path; instead, they pass through proxies or middleboxes, often referred to as "man-in-the-middle" (MITM) devices.

There are various reasons for the presence of MITMs, both benign and malicious. Previous research has shown that HTTPS interception is prevalent and can significantly degrade the security of internet connections. While a server that enforces strong cryptographic parameters may be protected from some risks, there are several reasons why a server operator might want to detect if HTTPS traffic from their clients has been intercepted.

Firstly, detecting HTTPS interception can help a server identify suspicious or potentially vulnerable clients. This knowledge can be used to alert legitimate users about potential security compromises, thereby enhancing overall network security. Additionally, HTTPS interception increases the attack surface, making it an attractive target for attackers who aim to compromise the integrity and confidentiality of data exchanged between clients and servers.

Secondly, the presence of content inspection systems can weaken the security of TLS connections and hinder the adoption of new TLS innovations and improvements. Users connecting through TLS-terminating middleboxes may experience downgraded connections to older, less secure versions of TLS, even if both the browser and server support newer, more secure versions. This can result in missed security, privacy, and performance benefits.

In this talk, we will provide an overview of the different forms of HTTPS interception, discuss the development of an open-source tool for detecting HTTPS interception, and share the insights we have gained. We invite you to explore the tool at: [https://github.com/cloudflare/mitmengine](https://github.com/cloudflare/mitmengine).