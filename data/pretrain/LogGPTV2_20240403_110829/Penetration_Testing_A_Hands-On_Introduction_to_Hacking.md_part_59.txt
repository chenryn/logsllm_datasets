Linksys WRT54G2, web interface, 340
J Linux. See also Kali Linux, Ubuntu 8.10
target machine
Java, signed Applet, 233–235
adding code to /tmp/run file,
Java 7 Update 6, installing, 52
290–291
Java Applet Attack Method, 250
copying and compiling exploit,
Java Runtime Environment (JRE), 230
289–290
java/meterpreter/reverse_http payload, 231
cracking passwords, 212
JMP ESP instruction, 392
filesystem, 56–57
finding in USER32.dll, 429
finding an exploit, 288–289
reliance on location, 440
finding a vulnerability, 287–288
John the Ripper tool, 210–211, 303
learning kernel version, 287
wordlists, 200, 212
stack-based buffer overflow in,
JRE (Java Runtime Environment), 230
361–378
udev privilege escalation, 287–291
K
VMware Player for, 9–10
Kali Linux, 55–73 listener
booting, 11 pushing command shell back to,
command line, 56 71–72
data manipulation in, 64–66 setup on Kali Linux, 290
GUI, 13 list_tokens command
opening virtual machine, 11 (Meterpreter), 301
repository of exploit code, 288 little-endian architecture, 377
running Android emulators, 27 LM (LAN manager) password
setup, 10–28 hashes, 208
starting Burp Suite in, 314 insecurity of, 209
testing Internet access for, 17 load command (Meterpreter), 301
user privileges, 58–61 local file inclusion, 324–327
kaliinstall script, 28 local information gathering, 291–296
keyscan_dump command local privilege escalation, 283–291
(Meterpreter), 292 for Windows, 284–285
keyscan_start command Local Security Authority Subsystem
(Meterpreter), 292 Service (LSASS)
key-scheduling algorithm, in WEP, 345 process, 214
keyspace brute-forcing, 201 local users, listing all, 294
kill command (Metasploit), 222 login screen
Kismet, 356 for Kali Linux, 12
of web application, SQL injection
L issues in, 319–320
LPORT option, 216
LAN manager (LM) password
ls command, 18, 56
hashes, 208
man page for, 57
insecurity of, 209
lateral movement, 296–304
484 Index
LSASS (Local Security Authority modules, 89, 281–283. See also
Subsystem Service), 214 specific modules
lsb_release command, 287 advanced parameters, 223–225
auxiliary, 107–108
M database, 90–91
finding, 90–94
MAC (Media Access Control) address,
MS08-067, 90
mapping IP address to, 161
post-exploitation, 281–283
MAC filtering, by access points, 350
scanner, 146–147
Mac OS, and VMware Fusion, 10, 16,
setting options, 94–96
31–32, 36
verifying format
mail servers
specifications, 438
for delivering attack email, 248–249
writing, 432–439
valid usernames for, 153
Msfconsole for, 89
main function, 84
payloads, 96–98
malicious code, asking users to
bypassing filters with, 216–218
allow, 233
port scanners in, 306
Maltego, 119–123
search function, 91–94
malware, techniques to avoid detection,
starting, 88–90
257–275
support for encoders, 263
man-in-the-middle attacks, 160–161
test run, 97–98
Ettercap for, 22, 171
updating, 108
man ls command, 57
Metasploit Browser Exploit Method, 250
man pages, 57–58
Meterpreter, 181–182
mandatory code signing, 219, 441–442
help for commands, 278
manual port scanning, 124
keylogger, 292
mapping IP address, to MAC
for post-exploitation, 278–280
address, 161
scripts, 280–281
mass email attacks, 253–255
searching for files with, 291–292
MD5 collision attack, 260
session, 98
MD5 hash
maintaining, 222
brute forcing, 212
placing in background, 311
checking for trojans with, 260
running scripts in, 223
md5sum program, 260
shell command for dropping out
MDM (Mobile Device
of, 287
Management), 466
upload command, 279
Media Access Control (MAC) address,
MIC (message integrity code), 353
mapping IP address to, 161
Michael, MAC algorithm, 350
memory
Microsoft Security Essentials, 261–262
content display options, 369
installing, 52
finding attack string in memory,
non-detection of malware, 270
408–411
Microsoft Windows. See Windows
theory of, 362–364
Ming C Compiler, installing, 20
memory address, byte order in, 376
Mingw32 cross compiler, 268
message integrity code (MIC), 353
Mitnick, Kevin, 243
Metasm utility, 398–399
mkdir command, 60, 207
Metasploit
mobile browser, attack for opening link
adding route in, 305–306
in, 455
auxiliary module and exploit
Mobile Device Management
database, 91
(MDM), 466
exploit check functions, 147–148
killing background job in, 222
Index 485
mobile hacking, 445–472 mv command, 60
client-side attacks, 454–457 MySQL
malicious apps, 458–463 database, for SPF, 447
near field communication (NFC), installing, 44
446–447 server, privileges, 186
pivoting through devices, 466–470
port scanning with Nmap, 467–468 N
privilege escalation, 471
nano (file editor), 62–63
remote attacks, 453–454
NAT (network address translation), 13
remote control, 465–466
National Institute of Standards and
with text messages, 446
Technology (NIST), 141
Mobile Safari, 219
near field communication (NFC),
Mode field in TFTP, 423
446–447
modules. See Metasploit: modules
negative feedback, 173–174
Mona
Nessus (Tenable Security), 134–142
finding pattern offsets in, 387–388
credentials in, 137
generating cyclical pattern in,
detailed information on
385–388, 405
vulnerability, 140
installing, 47
exporting results, 141–142
running SEH command in, 413
installing, 17–20
!mona findmsp command (Immunity
login screen, 20–22, 135
Debugger), output, 390
Policies tab, 134–138
mona pattern_create command (Immunity
rankings, 140–141
Debugger), 404–405
scanning with, 138–140
mona.py file, downloading, 46
starting, 18
moving files, 60
net command (Windows), 294–295
Mozilla Firefox, installing, 52
net localgroup command (Windows),
MS08-067 vulnerability, 180–182
295, 309
Msfcli (command line interface), 89,
net use command (Windows), 303
101–103
net user command (Windows), 309
showing options, 101–102
net users command (Windows),
SPF to interface with, 453
294–295
Msfconsole, 89
Netcat tool
handler for catching payload, 185
to check for listening port, 70
help command for, 89–90
connecting to port with, 152
setting up handler, 469
for file transfer, 72
Msftidy tool, 438
for SMTP port connection, 124
msfupdate command, 108, 225, 438
for TCP/IP connections, 69–72
Msfvenom, 258–259
Netcraft, 114–115
creating standalone payloads with,
netstat command, 69
103–107
network
encoders, 264
for capturing traffic, 156
generating shellcode, 273–274,
connecting virtual machine to,
396, 428
16–17
multiencoding with, 265
managing, 67–69
output format for, 104–105
viewing connections, 69
prebuilt templates for detection
network adapter
signatures, 266
changing settings, 15
serving payloads, 105, 183–185
configuring for Windows XP, 31
multi/handler module, 105–107, 227, 469
network address translation (NAT), 13
multi/ssh/sshexec module, 299
Network File System (NFS), 144–145
multipronged attacks, 255
exploitation of open shares, 194–196
486 Index
network interface, 67 OSVDB (Open Sourced Vulnerability
adding second, 52 Database), 149
network mask, 68 output format, for Msfvenom, 104–105
NFC (near field communication), overflowtest.c file, functions in, 375
446–447 OWASP (Open Web Application
NFS (Network File System), 144–145 Security Project), 335
exploitation of open shares, 194–196 owner, permissions for, 62
Nikto, 149
NIST (National Institute of Standards P
and Technology), 141
pack method (Ruby), 435
Nmap port scanning, 125–131
packages, managing installed, 66
for mobile devices, 467–468
Packet Storm Security, 88
running through ProxyChains, 308
pairwise master key (PMK), in WPA/
scanning a specific port, 130–131
WPA2, 352
SYN scan, 125–127
pairwise transient key (PTK), 352
UDP scan, 128–130
pass the hash technique, 298–299
version scan, 127–128
passphrase, for WPA or WPA2, 353
Nmap Scripting Engine (NSE),
password attacks, 197–214
142–144
offline, 203–213
default scripts output, 143–144
online, 198–203
running single script, 144–146
password hashes
nondisclosure agreement, 4