# Malware Slums: Measurement and Analysis of Malware on Traffic Exchanges

**Authors:**
- Salman Yousaf
- Umar Iqbal
- Shehroze Farooqi
- Raza Ahmad
- Muhammad Zubair Shafiq
- Fareed Zaffar

**Affiliations:**
- *Lahore University of Management Sciences (Salman Yousaf, Umar Iqbal, Raza Ahmad, Fareed Zaffar)*
- *The University of Iowa (Shehroze Farooqi, Muhammad Zubair Shafiq)*

**Conference:**
2016 46th Annual IEEE/IFIP International Conference on Dependable Systems and Networks

## Abstract
Auto-surf and manual-surf traffic exchanges are increasingly popular methods for artificially generating website traffic. Previous research has focused on the composition, usage, and monetization of these underground traffic exchanges. In this paper, we analyze the role of traffic exchanges as a vector for malware propagation. We conducted a measurement study of nine auto-surf and manual-surf traffic exchanges over several months. Our analysis provides a first-of-its-kind examination of the different types of malware propagated through these traffic exchanges. We found that more than 26% of the URLs surfed on traffic exchanges contain malicious content. We further categorized the encountered malware into blacklisted domains, malicious JavaScript, malicious Flash, and malicious shortened URLs.

## 1. Introduction
Online advertising has been a significant driver of the World Wide Web since its inception. Publishers are compensated based on impressions or clicks, making increased website traffic a key part of any web monetization strategy. Higher traffic directly translates to more revenue through advertisements. Content publishers invest heavily in search engine optimization (SEO) techniques to improve their rankings on search engines. However, SEO is complex and competitive.

Given the importance of traffic, there are strong incentives for publishers to artificially inflate traffic to their websites. Various legitimate and fraudulent SEO services aim to increase "organic" website traffic. Traffic exchange services have emerged as an alternative to SEO for fraudulently generating website traffic. These exchanges operate on a reciprocal basis, where members earn credits by viewing other members' websites, which can then be used to generate traffic for their own sites. Members can also purchase credits to boost their traffic.

A major challenge for attackers is achieving large-scale coverage. Unless malware is placed on a popular website, it is difficult to target a large number of users. Compromising a popular, reputable site is challenging, so attackers often exploit online advertisements to reach many victims quickly. Traffic exchanges provide a convenient and cost-effective platform for attackers to spread malware, such as drive-by downloads and social engineering attacks.

In this paper, we argue that traffic exchanges can be exploited by attackers to reach a large number of users globally. Our study reveals that traffic exchange services have become a prime target for attackers, with more than 26% of URLs on these exchanges exhibiting malicious behavior. Our findings have important implications for stakeholders and require a rethinking of traffic exchange networks.

### Key Contributions
1. **Data Collection:** We collected a dataset of 1,003,087 URLs from nine traffic exchanges, including both auto-surf and manual-surf types. Using well-known malware detection tools like VirusTotal and Quttera, we found that more than 26% of URLs on traffic exchanges are malicious.
2. **Malware Categorization:** We identified the major categories of malware on traffic exchanges, including blacklisted URLs, malicious JavaScript, malicious Flash, suspicious redirections, and malicious shortened URLs. Our analysis revealed that malware on traffic exchanges often deceives users into downloading malicious executables and clicking on advertisements. We conducted a detailed analysis of specific malware cases, finding instances of iframe injection, deceptive downloads, external interface calls, and redirections to malware hosting websites.

To our knowledge, this is the first comprehensive study on malware in traffic exchange services.

## 2. Background & Related Work

### A. Background
Traffic exchange services allow members to generate fraudulent traffic from a diverse pool of users. These exchanges can be divided into two categories: auto-surf and manual-surf. Auto-surf exchanges use automated procedures to browse target websites without user input, while manual-surf exchanges require frequent manual user input. Most traffic exchanges operate on the principle of reciprocity, where members visit other members' websites in exchange for visits to their own. Exchange credits can be purchased to generate traffic, with costs ranging from a few cents to a few dollars per thousand hits.

Traffic exchanges present an interface for members to surf other members' websites. Auto-surf exchanges automatically open new websites in iframes, while manual-surf exchanges require users to manually click and open websites, often after solving CAPTCHAs or puzzles. Each visited page requires a minimum surf time, typically ranging from 10 seconds to 10 minutes.

The primary goal of websites listed on traffic exchanges is to generate ad impressions from a diverse pool of IP addresses. To attract a large number of users, these exchanges often make claims such as "make easy money from home." Users from countries like India, Pakistan, Egypt, Russia, Mexico, and Brazil are common. To ensure a diverse IP pool, some traffic exchanges enforce the use of only one account per IP address, though some allow multiple logins using proxies and VPNs.

### B. Related Work
Traffic exchanges have not received much attention in prior literature. Javed et al. [34] conducted the first large-scale study of traffic exchange services, analyzing auto-surf and manual-surf exchanges in terms of composition, monetization, and usage patterns. They found that monetization is achieved through ad impressions from bogus ad exchanges and referrer spoofing on legitimate ad exchanges. Users on traffic exchanges generally lack technical sophistication.

Building on their work, we focus on the prevalence of malware on traffic exchanges. We find that users surfing on these exchanges are highly exposed to malware, with more than 22% of URLs being malicious. One traffic exchange in our study had over half of its URLs detected as malicious.

Detection and mitigation of malware attacks through infected, malformed, and malicious websites have been active areas of research. Several approaches, including program analysis, monitoring, and blacklisting, have been developed to combat these threats. Techniques like Zozzle [32], Rozzle [35], Cujo [36], and ADSandbox [33] use various methods to detect and block malicious behavior. Blacklists, such as those tracked by KÃ¼hrer et al. [37], identify websites known for illicit activities and malicious content. Online advertisement scams, as studied by Li et al. [38], Xing et al. [40], and Zarras et al. [41], contribute significantly to malware propagation.

## 3. Data Collection and Analysis Methodology

### A. Data Collection
To conduct a quantitative analysis of malware on traffic exchange services, we crawled several popular traffic exchanges and gathered URLs that appeared on them. We selected a total of nine exchanges, including four manual-surf services (Cash N Hits, Easyhits4u, Traffic Monsoon, Hit2Hit) and five auto-surf services (Otohits, ManyHit, SendSurf, Smiley Traffic, 10KHits). We registered new accounts for this purpose and used the Firebug add-on in Mozilla Firefox to capture HTTP and HTTPS traffic, along with the NetExport extension to collect data in the HAR format.

Overall, we collected 1,003,087 URLs, containing 306,895 distinct URLs from 17,448 domains. Table I provides detailed statistics of the collected data. We excluded self-referring and popular URLs, leaving us with 802,434 regular URLs for further analysis.

### B. Analysis Methodology
To test whether a web page contains malware, we used third-party malware analysis tools such as Wepawet, VirusTotal, Quttera, URLQuery, Bright Cloud, Site Check, Sender Base, and AVG Threat Lab. We vetted these tools using a gold standard dataset of malware identified by Xing et al. [40]. Based on their detection accuracy, we settled on VirusTotal and Quttera for our analysis. 

- **VirusTotal:** This tool aggregates results from multiple antivirus products, file characterization tools, and website scanning engines. We submitted our files and URLs using the VirusTotal API.
- **Quttera:** This tool detects malicious hidden iframe elements, malicious redirects, malvertising, and other forms of malware.

## 4. Analysis of Malware Categories
We identified the major categories of malware on traffic exchanges, including blacklisted URLs, malicious JavaScript, malicious Flash, suspicious redirections, and malicious shortened URLs. Our analysis revealed that malware on traffic exchanges often deceives users into downloading malicious executables and clicking on advertisements. We conducted a detailed analysis of specific malware cases, finding instances of iframe injection, deceptive downloads, external interface calls, and redirections to malware hosting websites.

## 5. Case Studies of Interesting Malware
We present case studies of interesting malware found on traffic exchanges, providing insights into the methods and techniques used by attackers. These case studies highlight the need for robust countermeasures to protect users from these threats.

## 6. Conclusion
Our study reveals that traffic exchange services have become a prime target for attackers, with more than 26% of URLs on these exchanges exhibiting malicious behavior. Our findings have important implications for stakeholders and require a rethinking of traffic exchange networks. We recommend implementing robust countermeasures, such as improved malware detection and user education, to mitigate the risks associated with these services.

**Table I: Statistics of Data from Traffic Exchanges**

| Type         | Exchange Name   | # URLs Crawled | # Self Referrals | # Popular Referrals | # Regular URLs | # Malicious URLs | % Malicious URLs |
|--------------|-----------------|----------------|------------------|---------------------|----------------|------------------|------------------|
| Auto-surf    | 10KHits         | 218,353        | 13,663           | 24,328              | 180,362        | 33.8%            |                  |
| Auto-surf    | ManyHits        | 178,939        | 10,860           | 20,890              | 147,189        | 14.6%            |                  |
| Auto-surf    | Smiley Traffic  | 244,677        | 15,789           | 12,847              | 216,041        | 8.7%             |                  |
| Auto-surf    | SendSurf        | 246,967        | 17,537           | 19,174              | 210,256        | 51.9%            |                  |
| Auto-surf    | Otohits         | 96,316         | 52,167           | 9,336               | 34,813         | 7.4%             |                  |
| Manual-surf  | Cash N Hits     | 4,795          | 416              | 298                 | 4,081          | 10.2%            |                  |
| Manual-surf  | Easyhits4u      | 4,638          | 703              | 694                 | 3,241          | 10.4%            |                  |
| Manual-surf  | Hit2Hit         | 3,355          | 651              | 211                 | 2,493          | 8.5%             |                  |
| Manual-surf  | Traffic Monsoon | 5,047          | 540              | 549                 | 3,958          | 12.2%            |                  |

**Note:** The table shows the detailed statistics of the collected data, including the number of URLs, self-referrals, popular referrals, regular URLs, and the percentage of malicious URLs for each traffic exchange.