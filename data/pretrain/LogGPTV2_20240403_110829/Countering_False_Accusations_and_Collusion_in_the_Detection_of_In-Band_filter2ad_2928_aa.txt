# Countering False Accusations and Collusion in the Detection of In-Band Wormholes

**Authors:**
- Daniel Sterne, SPARTA Inc.
- Geoffrey Lawler, SPARTA Inc.
- Richard Gopaul, U.S. Army Research Laboratory
- Brian Rivera, U.S. Army Research Laboratory
- Kelvin Marcus, U.S. Army Research Laboratory
- Peter Kruus, The Johns Hopkins University Applied Physics Laboratory

**23rd Annual Computer Security Applications Conference**

## Abstract

Cooperative intrusion detection for Mobile Ad-hoc Networks (MANETs) often utilizes ordinary computing hosts as network sensors. If compromised, these hosts can inject false data into the intrusion detection system to conceal their activities or falsely accuse well-behaved nodes. Byzantine fault tolerance techniques involving voting are potentially applicable but must address the challenge of determining which nodes, based on their topological locations at specific times, are qualified to vote on whether an attack has occurred.

We examine these issues in the context of a prototype distributed detector for self-contained, in-band wormholes in OLSR networks. We propose an opportunistic voting algorithm and present test results from a 48-node testbed, where colluding attackers generate corroborating false accusations against pairs of innocent nodes. Our results indicate that opportunistic voting can instantaneously suppress false accusations when the network topology and routes chosen by OLSR provide a sufficient number of nearby honest observers to outvote the attackers.

## 1. Introduction

Detecting certain types of attacks on MANETs, especially those related to routing protocols and packet forwarding, requires cooperative distributed intrusion detection techniques [17][23][24]. These techniques use ordinary computing hosts as network sensors. However, because these hosts run complex applications, they are more vulnerable to cyber penetration and compromise than dedicated network intrusion detection systems used for wired networks. If a host is compromised, it can inject false data into the cooperative intrusion detection system, which can be used to conceal malicious activities or to make false accusations. Such false accusations can lead to a self-inflicted denial of service by stimulating the intrusion response system to curtail the access of falsely accused victims.

This form of the Byzantine fault tolerance problem is a critical issue for any cooperative intrusion detection system. Traditional approaches to Byzantine fault tolerance involve some form of voting, where correctly executing replica processes outvote a smaller number of faulty processes, typically less than one-third of the total population [15]. Applying such approaches to MANETs faces several challenges. Each node in a MANET has a unique view of network activity due to the dispersed nature of traffic. Furthermore, only nodes in specific topological locations can observe the attack traffic or network symptoms and reliably attest to whether an attack occurred. The set of nodes eligible to vote depends on the network topology and the routes used or affected by the attack. Additionally, the dynamic nature of MANETs means that the set of eligible voters may change over time.

We examine these issues in the context of an in-band wormhole attack on the OLSR routing protocol [14]. In this attack, colluding attackers create the illusion of a single-hop "shortcut" (a layer 2 link) between two distant nodes by using a covert tunnel through other unsuspecting nodes. If well-positioned, this shortcut can attract significant traffic, diverting it from optimal routes and enabling the attacker to delay, discard, or corrupt the attracted traffic. This leads to suboptimal paths and wasted bandwidth, potentially causing increased congestion, packet loss, and delay. In contrast, out-of-band wormholes, which have received more attention, connect purported neighbors via a wireline network or additional RF channel, adding capacity to the network and thus being arguably less harmful.

Building on our prior research [14], we describe a prototype intrusion detection system that detects and localizes wormholes by measuring and analyzing roundtrip delay times on multi-hop paths. Before concluding that an attack is underway, the detector requires agreement, by a majority of independent pairs of nodes, that a common link in these paths exhibits anomalous delays. This majority rule instantaneously suppresses false accusations, even if corroborated by colluding attackers, as long as a sufficient number of honest nodes are appropriately positioned. We refer to this approach as opportunistic voting, as it utilizes whichever nodes are in the right place at the right time.

The use of voting to make end-to-end path measurements resilient to the injection of false data appears to be unique to our detector. This notion may have broader potential value for increasing the Byzantine resistance of network path measurement techniques used in other intrusion detection approaches [10][12], as well as in network fault localization [20] and network tomography [8].

Our paper makes the following contributions:
- We present an opportunistic voting algorithm for detecting and localizing in-band wormholes, where votes are based on roundtrip delay measurements reported by independent pairs of nodes. Voting is used for false accusation resistance.
- We describe a form of wormhole attack that includes coordinated false accusations by colluding pairs of nodes and actions by them to trick benign nodes into accusing other nodes.
- We present specialized tests and results showing the algorithm’s effectiveness against a real implementation of this attack running in a network emulation testbed. The results show that opportunistic voting provides substantial value by instantaneously suppressing false accusations in dynamic topologies and at varying network densities.
- We discuss the effects of topology and routing on the eligibility of nodes to vote on the innocence of an accused link.

This paper is organized as follows. Section 2 discusses related work. Section 3 provides background on the in-band wormhole attack. Section 4 presents the wormhole detection and Byzantine resilience strategies we propose and the prototype detector we have constructed. Sections 5 and 6 describe prototype testing and test results, which are discussed further in Section 7. Section 8, the conclusion, provides a summary and identifies future directions.

## 2. Related Work

Several researchers have developed intrusion detection techniques for wormhole attacks on MANETs. Their techniques generally differ from ours in that they do not address false accusations and focus on out-of-band rather than in-band wormholes.

Hu introduced the concept of an out-of-band wormhole in ad hoc networks and outlined temporal and geographic countermeasures designed to detect the remote forwarding of packets [9]. Hu describes packet leashes, which restrict the maximum transmission distance of a packet. In this scheme, wormhole paths cause neighbor-sensing and other packets to be received outside a tightly synchronized time window, making the packets invalid.

Lazos describes a different geographic-based distance bounding approach for defeating out-of-band wormhole attacks [16]. Essential nodes are aware of their geographic location relative to specialized guard nodes. Messages forwarded beyond their local reach, as determined by the guards, or detected as duplicates, are considered indicative of a wormhole. This approach may not provide adequate protection if the attackers are trusted insiders with access to the same node resources as other network nodes. Additionally, a highly mobile network may violate assumptions about node placement and density.

Adjih describes several approaches for countering out-of-band wormhole attacks on OLSR networks [3]. One approach is a geographic-based distance bounding method for containing the relaying of HELLO and TC messages. Another is a watchdog-like technique similar to [16] and [13], which monitors the number of packets sent and received by a given node.

Buttyán proposes techniques for detecting out-of-band wormholes based on statistical changes to neighbor hop counts and path lengths [7]. Local information is collected and reviewed by a central base station that detects changes in network behavior. These techniques are designed for static networks and do not identify the attackers.

Khalil describes MANET wormhole defensive countermeasures for routing protocols like DSR and AODV [13]. These are based on specialized guard nodes that promiscuously monitor all forwarding paths, resembling the distance-bound approach proposed by [16].

Our research builds on our prior work, which provided the first detailed description of in-band wormholes in OLSR networks [14] [11]. We introduced the terms "extended wormhole" for attacks in which a link appears between unsuspecting benign nodes and "self-contained wormhole" for attacks in which the wormhole link appears between two attacking nodes. This work provided initial evidence that in-band wormholes can be detected by measuring roundtrip loss and delay. It also defined metrics to characterize the impact of wormholes on the surrounding network [11].

Awerbuch proposes the On-Demand Secure Byzantine Routine (ODBSR) protocol, which defends against various attacks, including out-of-band wormholes [2]. Awerbuch's "Byzantine wormhole" is the out-of-band equivalent of our self-contained in-band wormhole. ODBSR is evaluated using simulations, including a rectangular mesh of interconnected links called a "superwormhole." ODBSR mechanisms do not detect wormholes per se; they detect packet dropping applied to traffic traveling through wormholes. If a wormhole is simply attracting traffic while waiting for an opportune time to disrupt it, or is already subjecting the traffic to delays or packet corruption, the wormhole will remain invisible to ODBSR.

Gorlatova describes the detection of out-of-band wormholes in OLSR networks using an approach based on the same underlying premise as ours [10]: the path characteristics of a wormhole link should have a measurable effect on the traffic flowing across it. Gorlatova applies signal processing techniques to periodic incoming messages having a known frequency, in this case, OLSR HELLO packets. Each node analyzes the distribution and power spectral density (PSD) of inter-HELLO arrival intervals from each of its neighbors. If the HELLOs have arrived via a wormhole tunnel, the associated delay, even if small, broadens or smears the HELLO message time series.

Ilsam proposes a system for suburban ad hoc networks that can detect violations of MAC and bandwidth reservation protocols, dropped packets, and delayed packets [12]. Although Ilsam does not discuss wormholes, two of his techniques are related to ours. The first monitors hop-by-hop transit times for flows to identify nodes responsible for unusual delays. The second measures roundtrip delays using probe packets, which are assumed to be stealthy and not modified by intermediate nodes.

Intrusion detection techniques for other kinds of attacks on MANETs have given more attention to false accusations than those for wormholes. For example, Buchegger proposes a reputation system for MANETs in which nodes collect first-hand information about other nodes by direct observation and share it with selected other nodes, such as their neighbors [5]. Each node maintains a rating (a continuous variable) for every other node it cares about. The system is designed to address two kinds of misbehavior: a) routing or forwarding misbehavior, and b) lies about the reputation of other nodes. Using second-hand information about both good and bad behavior of others accelerates the detection and isolation of malicious nodes but can endanger the integrity of the reputation system because nodes can use it to disseminate misinformation. This system improves upon Buchegger's earlier reputation system called CONFIDANT [4], which was susceptible to false accusations. To counter this problem, each node accepts second-hand information only if it is not too dissimilar from that node’s first-hand information.

In Buchegger's and most other reputation systems [4][5][25], each node can maintain its own rating of other nodes because it bases that rating on observations it can make independently. For example, if one node forwards a packet to another node, it may be able to...