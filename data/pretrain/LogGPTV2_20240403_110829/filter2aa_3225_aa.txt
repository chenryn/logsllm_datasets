Push	
  The	
  Stack	
  Consulting	
http://pushthestack.com	
Security When 
Nanoseconds Count 
a	
  whitepaper	
  on	
  the	
  security	
  issues	
  and	
challenges	
  with	
  next	
  generation	
  finance	
  and	
  trading	
  infrastructures	
Blackhat	
  USA	
  Briefings	
  2011	
Abstract 
There's	
  a	
  brave	
  new	
  frontier	
  for	
  IT	
  Security	
  -­‐	
  a	
  place	
  where	
  "best	
  practices"	
  do	
not	
  contemplate	
  the	
  inclusion	
  of	
  a	
  firewall	
  in	
  the	
  network.	
  This	
  frontier	
  is	
  found	
  in	
  the	
most	
  unlikely	
  of	
  places,	
  where	
  it	
  is	
  presumed	
  that	
  IT	
  Security	
  is	
  a	
  mature	
  practice.	
Banks,	
  Financial	
  Institutions	
  and	
  Insurance	
  Companies.	
  High	
  Speed	
  Trading,	
  High	
Frequency	
  Trading,	
  Low	
  Latency	
  Trading,	
  Algorithmic	
  Trading	
  -­‐-­‐	
  all	
  words	
  for	
electronic	
  trades	
  committed	
  in	
  microseconds	
  without	
  the	
  intervention	
  of	
  humans.	
There	
  are	
  no	
  firewalls,	
  everything	
  is	
  custom	
  and	
  none	
  of	
  it	
  is	
  secure.	
  It's	
  SkyNet	
  for	
Money	
  and	
  it's	
  happening	
  now.	
Introduction 
Throughout	
  the	
  course	
  of	
  modern	
  financial	
  times,	
  technology	
  has	
  influenced	
  the	
development	
  and	
  maturity	
  of	
  all	
  markets,	
  from	
  the	
  chalk	
  boards	
  and	
  runners	
  of	
  the	
  late	
1700s	
  to	
  the	
  current	
  trend	
  towards	
  incredibly	
  quick	
  trades	
  performed	
  entirely	
  within	
electronic	
  systems	
  without	
  any	
  human	
  intervention.	
The	
  communications	
  revolution	
  of	
  the	
  1800s	
  brought	
  about	
  swift	
  changes	
  from	
the	
  carrier	
  pigeons	
  used	
  by	
  Reuters	
  in	
  the	
  early	
  part	
  of	
  the	
  century	
  to	
  the	
  first	
  telegraph	
based	
  ticker	
  systems	
  of	
  the	
  1860s.	
  Advances	
  through	
  the	
  early	
  and	
  mid	
  20th	
  century	
lead	
  to	
  the	
  introduction	
  of	
  computers	
  as	
  the	
  trusted	
  stores	
  of	
  data	
  on	
  trade	
  pricing,	
volumes,	
  opening	
  and	
  closing	
  prices	
  and	
  more.	
The	
  electronic	
  nature	
  of	
  stock	
  markets	
  became	
  part	
  of	
  most	
  people’s	
  general	
awareness	
  with	
  the	
  opening	
  of	
  the	
  NASDAQ	
  exchange	
  in	
  the	
  early	
  1970s	
  and	
  the	
  move	
to	
  the	
  electronic	
  small	
  order	
  execution	
  system	
  in	
  the	
  late	
  1980s.	
Security	
  When	
  Nanoseconds	
  Count	
  -­‐	
  Blackhat	
  USA	
  Briefings	
  2011	
2011-­‐07-­‐13	
Page	
  2	
Arlen-­‐SecurityWhenNanosecondsCount-­‐Whitepaper-­‐v1.docx	
High	
  frequency	
  trading	
  likely	
  started	
  in	
  concert	
  with	
  changes	
  initiated	
  by	
  the	
  US	
Securities	
  and	
  Exchange	
  Commission	
  in	
  1998	
  to	
  permit	
  electronic	
  trading.	
  The	
  majority	
of	
  the	
  strategies	
  in	
  high	
  frequency	
  trading	
  are	
  related	
  to	
  time	
  arbitrage	
  –	
  the	
  ability	
  to	
make	
  (or	
  lose)	
  money	
  based	
  on	
  minute	
  differences	
  in	
  time	
  between	
  the	
  time	
information	
  is	
  available	
  and	
  the	
  time	
  it	
  is	
  widely	
  known.	
The	
  speed	
  of	
  trading,	
  and	
  therefore	
  the	
  available	
  time	
  in	
  which	
  to	
  complete	
  the	
calculations	
  necessary	
  for	
  time-­‐based	
  arbitrage,	
  has	
  been	
  shrinking	
  at	
  an	
  accelerated	
pace	
  over	
  the	
  last	
  50	
  years.	
  With	
  the	
  advent	
  of	
  rapid	
  communications,	
  stock	
  quotation	
systems	
  and	
  computer	
  mediated	
  order	
  management,	
  the	
  time	
  to	
  complete	
  a	
  trade	
  was	
brought	
  from	
  hours	
  to	
  minutes	
  to	
  seconds.	
  The	
  shift	
  from	
  seconds	
  to	
  100s	
  of	
microseconds	
  has	
  happened	
  relatively	
  quickly.	
  The	
  fact	
  that	
  a	
  dollar	
  value	
  can	
  be	
assigned	
  to	
  the	
  length	
  of	
  time	
  available	
  for	
  arbitrage	
  is	
  an	
  indication	
  that	
  we’re	
reaching	
  the	
  end-­‐game	
  on	
  time-­‐based	
  arbitrage.	
  Estimates	
  on	
  the	
  value	
  of	
  a	
millisecond	
  of	
  unnecessary	
  latency	
  range	
  wildly.	
  Simply	
  stated	
  –	
  never	
  before	
  in	
  the	
course	
  of	
  human	
  history	
  has	
  a	
  microsecond	
  been	
  worth	
  quite	
  as	
  many	
  millions	
  of	
dollars.	
Security	
  When	
  Nanoseconds	
  Count	
  -­‐	
  Blackhat	
  USA	
  Briefings	
  2011	
2011-­‐07-­‐13	
Page	
  3	
Arlen-­‐SecurityWhenNanosecondsCount-­‐Whitepaper-­‐v1.docx	
Low Latency Infrastructure Patterns  
Understanding	
  that	
  the	
  number	
  of	
  microseconds	
  to	
  complete	
  the	
  calculations	
necessary	
  to	
  take	
  a	
  position	
  in	
  the	
  market	
  with	
  the	
  intent	
  to	
  arbitrage	
  in	
  time	
  is	
  a	
  fact,	
grasping	
  what	
  that	
  means	
  literally	
  is	
  still	
  a	
  very	
  emotional	
  and	
  qualitative	
  discussion.	
‡ If	
  you	
  are	
  able	
  to	
  complete	
  trades	
  in	
  seconds,	
  you	
  have	
  no	
  position.	
‡ If	
  you	
  are	
  able	
  to	
  complete	
  trades	
  in	
  milliseconds,	
  you	
  lose	
  nearly	
  every	
  time.	
‡ If	
  you	
  are	
  able	
  to	
  complete	
  trades	
  in	
  100s	
  of	
  microseconds,	
  you’re	
  a	
  bit	
  player	
and	
  missing	
  a	
  lot	
  of	
  action.	
‡ If	
  you	
  are	
  able	
  to	
  complete	
  trades	
  in	
  10s	
  of	
  microseconds,	
  you’re	
  usually	
winning.	
The	
  predictability	
  of	
  the	
  connection	
  is	
  nearly	
  as	
  important	
  as	
  the	
  absolute	
latency	
  value.	
  If	
  the	
  connection	
  is	
  fast	
  enough	
  80%	
  of	
  the	
  time	
  but	
  too	
  slow	
  the	
  other	
20%	
  of	
  the	
  time,	
  you	
  cannot	
  ensure	
  that	
  your	
  trades	
  will	
  result	
  in	
  the	
  desired	
  outcome	
  –	
you	
  have	
  a	
  20%	
  chance	
  of	
  failing	
  on	
  every	
  single	
  trade.	
  This	
  indeterminism	
  is	
  usually	
composed	
  of	
  jitter,	
  packet-­‐loss,	
  and	
  inefficient	
  protocols	
  (such	
  as	
  TCP.)	
  Remember	
  that	
a	
  dropped	
  packet	
  is	
  dropped	
  cash.	
This	
  need	
  for	
  low	
  latency	
  and	
  predictable	
  performance	
  drives	
  a	
  certain	
  set	
  of	
infrastructure	
  design	
  choices.	
  These	
  choices	
  will	
  include	
  elements	
  such	
  as:	
‡ Extreme	
  systems	
  (in	
  2011:	
  16+	
  core,	
  128GB,	
  10G-­‐ether/Infiniband/PCIe	
interconnects)	
‡ Custom	
  hardware	
  and	
  software	
  solutions	
  which	
  place	
  the	
  decision	
  engine	
  into	
FPGA	
  processors	
‡ Custom	
  networking	
  interfaces	
  that	
  bypass	
  the	
  kernel	
‡ Extreme	
  networks	
  (cut	
  through	
  switching	
  at	
  10GB/s)	
‡ Proximity	
  (the	
  same	
  data-­‐centre	
  as	
  the	
  exchange)	
Many	
  of	
  these	
  choices	
  are	
  made	
  because	
  interconnect	
  technologies	
  designed	
for	
  wide	
  area	
  use	
  have	
  inherent	
  inefficiencies	
  and	
  also	
  because	
  one	
  of	
  the	
  increasingly	
popular	
  interconnect	
  technologies	
  (PCIe)	
  was	
  originally	
  intended	
  for	
  use	
  within	
  a	
  single	
system	
  and	
  not	
  as	
  a	
  data	
  transport	
  from	
  system	
  to	
  system.	
  The	
  key	
  issue	
  for	
  both	
latency	
  and	
  determinate	
  data	
  transport	
  remains	
  the	
  speed	
  of	
  light.	
Security	
  When	
  Nanoseconds	
  Count	
  -­‐	
  Blackhat	
  USA	
  Briefings	
  2011	
2011-­‐07-­‐13	
Page	
  4	
Arlen-­‐SecurityWhenNanosecondsCount-­‐Whitepaper-­‐v1.docx	
Consider	
  that	
  light	
  travels:	
~300km	
  (~186	
  miles)	
  in	
  1	
  millisecond	
  (1/1000th	
  of	
  a	
  second)	
~300m	
  (~328	
  yards)	
  in	
  1	
  microsecond	
  (1/1000th	
  of	
  a	
  millisecond)	
~30cm	
  (~1	
  foot)	
  in	
  1	
  nanosecond	
  (1/1000th	
  of	
  a	
  microsecond)	
These	
  values	
  start	
  to	
  place	
  absolute	
  limits	
  on	
  the	
  distance	
  between	
  processor	
nodes	
  (the	
  trading	
  engine	
  and	
  the	
  exchange)	
  in	
  order	
  to	
  stay	
  within	
  the	
  limits	
  necessary	
to	
  complete	
  a	
  time-­‐arbitrage	
  trade.	
  This	
  is	
  not	
  the	
  first	
  time	
  that	
  the	
  speed	
  of	
  light	
  has	
been	
  an	
  issue	
  in	
  data-­‐centre	
  design,	
  but	
  it	
  may	
  be	
  the	
  first	