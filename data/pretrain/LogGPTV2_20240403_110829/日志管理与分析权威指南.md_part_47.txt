，“每天至少一次审核所有系统组件的日志”，假定日志审核
异常候选
基本比较
图16.6
单独日志条目审核
选择异常候选者
前所未见的日志类型（对于特定用户）
前所未见的目志类型（新目志）
高级比较
第16章日志管理规程221
异常候选
频率更高
W
---
## Page 243
222
将进一步地介绍更多的细节)。
否严重，确定其对安全和PCI依从性状态的影响呢？（AntonChuvakin博士的博客，2011）。
可能是安全事故发生的早期指示。
16.6.5
在这一阶段，我们有了一条落在例行／正常运营之外的日志消息。我们该如何确定它是
不匹配正常配置的消息被标记为“异常”。
确切地说，这展示了一个使用日志调查检查列表的过程，
图16.7展示了对每个“异常”条目使用的调查过程（“初始调查”）的概要情况（本章还
1.初始调查
在消息被标记为异常之后，我们转入日常工作流的不同阶段一
遵循高级方法的同时，日志管理工具也可以使用其他比较算法。
1）查看同一时间的日志条目：这一技术涉及增加围绕所调查日志消息的时间范围。大
■记录的新用户活动（系统中前所未见的用户的任何日志）。
■
■
■
异常调查与分析
前所未见的日志类型(在工作日内)。
前所未见的日志类型(对于特定应用程序模块)。
前所未见的日志类型（对于特定用户)。
比基线中出现频率更低的日志类型
前所未见的日志类型(在周末)。
调条查查用
审核整个日志条目：
司
与用户活动相关关于这个用户知道些什公
访问外部信息源
表同
在基线之外：
到其他系统
影响：
（新类型）
的来姐
个
未知
图16.7
用
融
每个异常情况的调查
建
适模
志目
”。需要注意的是，异常不等同于安全事故，
下面将详细地介绍这个检查列表：
色典
一从每天审核转向调查和分析。
动关
用
系超活
级动
状被
态动真用日
名户志
但
---
## Page 244
（FIM）、补丁管理（PM）变更管理（CM）和其他系统（Chuvakin，2011）。
条目。常常发生这种情况，用户活动的特定日志事件只能在同一用户其他活动的上下文中解
部分日志管理产品能够审核或者搜索特定时间范围内的所有日志。例如：
从性的影响仍然未知。在这种情况下，我们必须从其他系统获得信息，例如文件完整性监控
可能很重要，但是审核来自相同组件的最近日志一般有助于揭示真实的情况。
应用程序模块或者组件的所有其他日志消息。同一时间范围的其他消息（见上面的第一条）
其他日志消息。
影响的线索。
系统上进行，以确定其影响。了解其他系统上何时产生相同的消息，
读。大部分日志管理产品允许你“下钻”或者搜索特定时间范围内的特定用户。
5）查看来自同一应用程序模块的条目（如果适用的话）：这种方法涉及审核来自同一个
在某种情况下，上述检查列表可能没有作用。也就是说，异常日志条目对安全和PCI依
4）查看来自同一源的条目（如果适用的话）：这种方法涉及审核来自网络相关源地址的
3）查看其他系统上的同类条目：这种方法包括搜索其他同类日志消息，但是在不同的
2）查看来自同一用户的其他条目：这一技术包括搜索同一用户的活动生成的其他日志
2.外部信息源调查
调查规程可以扩展，
c）最后，查看“可疑日志”前后1小时触发的其他日志。
a）首先，查看“可疑日志”前后1分钟触发的其他日志。
b）其次，
，查看“可疑日志”前后10分钟触发的其他日志。
授权变更未授权变更
，覆盖组织的其他可用信息源。图16.8展示了在调查中使用外部信息
触发事故响应
投权委理来授权变理
图16.8
在调查中使用外部信息
触发事故响应
具有未知影响
外部信息源
初步调查
故
，可以得到理解日志消息
第16章日志管理规程223
---
## Page 245
224
持合同)，所以应该审慎使用。（Chuvakin，日期不详）
确定事件的影响和必要的行动(如果有的话)。
如图16.9所示。
在这种情况下，触发协作工作流（Chuvakin博客，2011）。
条目确实是严重问题的征兆，会触发事故响应过程。
和必要的行动(如果有的话)。
源所遵循的规程。
细节。
在进入下一部分之前，我们需要讨论事故响应和升级，下一小节提供了这些主题的更多
最后的资源是咨询应用程序供应商，这种信息请求通常很费时，甚至很昂贵（取决于支
这一规程的主要思路是根据异常日志条目的类型来识别并查询信息源，然后识别其影响
但是，有时候初步分析和外部系统查询都不能得到结果，这样的“异常”日志很罕见
该规程粗略地确定日志条目的类型，然后查询相关的信息源。在某些情况下，这种日志
这一规程的主要思路是找出可能了解应用程序中发生的事件的合适人员，并与之面谈，
本规程可以利用组织中其他人的知识，这些人可能了解“异常”情况。调查和升级过程
3.升级到其他规程
这可能是什么意思？
1
（如果是内部开发）
应用程序开发人员
图16.9升级到其他规程
应用程序业务负责人
应用程序管理员
（不升级到事故响应）
外部信息源调查
影响仍然未知
初始调查
的日志条目
具有未知影响
升级到其他
用户调查
这可能是什么意思？
---
## Page 246
分辨这两者。
核了日志”是完全不同的概念，有时候，需要对安全和依从性计划进行多年的成熟化，才能
哪些文档，
16.7
改进。这一阶段也常称为后续阶段。
统可能受到的影响和损害，评估破坏范围。
“拔线”操作（也就是断开或者关闭系统）来说很重要。在这一阶段，我们还试图审核其他系
重启和维护窗口之外的配置更改等，都是说明发生了某些值得进一步注意的事件的信号。
现的各种信号的分析有关。例如，持续的CPU利用、系统
报有关（实际上这种情况也不太多），还与可能揭示事故出
略是关于合适的个人、团体之间沟通的。（AntonChuvakin，
及事故规程。这也是你开发升级规程／策略的时机。这一策
训练人员、收集和构建工具，到部署附加监控和创建过程
所发生的情况。
级呢？本节提供IR和升级如何融人本章介绍的整体过程的必要理解。你将能很好地理解这
一阶段还要规划网络的更改。
2011)。
一点。
16.6.6
我们首先讨论升级。在日志管理和IT的一般概念中，升级规程用于确定何时应该升级
，根除阶段中，我们评估可用备份，准备恢复或者重建系统，为回到正常状态做准备。这
首先，
控制阶段对于在文档中记录发生的情况、隔离受影响系统（甚至区域）以及进行著名的
识别阶段从事故的征兆被发现开始。这不仅和IDS警
迄今为止介绍的许多工作流依赖事故响应（IR）和升级。但是，什么是事故响应和升
日志审核最后的关键部分是确保有足够的证据，证明这一过程被真正严格地实施。好消
在跟踪阶段，你讨论和记录得到的教训，向管理层报告事故，并规划未来事故处理中的
恢复阶段是一切回到正常的阶段。在此阶段要起用额外的日志记录和监控。
准备阶段包括事故之前必须完成的任务：从组建团队
图16.10展示了SANS定义的IR过程。
我们来讨论这个过程的每一步。
日志审核的验证
事故响应和升级
，常见的错误概念是用实际的日志来提供这种证明。这并不正确：“有日志”和“审
，作为日志审核的证据。
[C]控制
①识别
[P]准备
图16.10SANSIR过程
[E]根除
第16章日志管理规程225
[R]恢复
[F]跟踪
---
## Page 247
226
证据的产生上，表16.5对此作了详细的介绍。
16.7.1
是日志审核的证据，因为后者依赖于前者：
计记录；这种审计跟踪应该涵盖，下面会介绍人工审核的情况），这个项目可以视为“日志审
16.7.2日志审核的证据
合的所有依从性证据的总列表。和其他小节不同，在此我们将包含日志记录的证据，而不只
ProceduresPart8,2011)。
16.7.3