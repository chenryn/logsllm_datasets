**作者：启明星辰ADLab  
公众号：**
### 一 概述
近期，启明星辰ADLab接连捕获到大量针对全球制造、运输、能源等行业及部分医疗机构发起的鱼叉式钓鱼邮件定向攻击。从邮件的分析结果来看，受害者大多遍布于美国、加拿大、德国、中国、英国、法国、西班牙等国家和地区。攻击者以“装船通知单”、“装箱交货价单”、“紧急运输文件”等主题邮件作为诱饵向攻击目标植入信息窃密木马（Agent
Tesla、Formbook、Lokibot）和远程控制程序（NanoCore、Remcos）。我们通过对收集到的攻击工具进行去重并做分析，最终发现此次攻击活动关联着1362个攻击样本。通过同源分析，我们发现这批样本中有近80%是同一款恶意软件，对其分析判定后确定这正是近期被大范围传播且极为活跃的新型下载者病毒Guloader。Guloader是一款免杀能力很强的病毒，近期全球各大厂商均对其进行了预警，其具备沙盒逃逸、代码混淆、反调试、C&C/URL加密和有效载荷加密等多种能力。由于Guloader具有较强的免杀能力和对抗机制，因而受到大量黑客的青睐。本批攻击中，攻击者就广泛地利用Guloader下载者病毒结合云服务来分发窃密工具或远程控制程序（RAT）。
我们通过溯源分析确定此次攻击活动来自尼日利亚，并且关联出了大批量的黑恶意域名（攻击者使用境外的Duck
DNS注册动态域名）和IP地址。通过对攻击者使用的网络基础设施，追踪分析发现此次攻击活动最早可追溯到2020年1月。进一步分析我们发现，这批攻击者的攻击动机、攻击目标、作业风格与SWEED黑客组织极为相似，他们还有着相似的攻击习惯，并使用相同窃密木马程序，以及同样风格的C&C地址。因此，我们推断这批攻击背后应该就是SWEED黑客组织。SWEED是一个来自尼日利亚的以获取经济利益为主要目的的黑客组织，其最早出现于2017年，常利用公开披露的漏洞，借助鱼叉式钓鱼邮件来传播木马程序，如Agent
Tesla、Formbook和Lokibot等。该组织曾在早期被披露的攻击活动中，通过窃取被攻击目标用户和企业敏感信息实施中间人攻击，诱使财务人员将款项转至指定账户，是一个典型的网络诈骗团伙。
启明星辰ADLab对本次攻击活动的攻击过程和攻击手法进行了详细地分析和溯源，并对其所使用的新型恶意软件和C&C基础设施进行了深入研究。提醒各大企业单位做好安全防范工作，谨防后续可能出现的攻击。
### 二 攻击目标和受害者分布
截止到2020年6月，我们发现攻击者的重点目标为从事对外贸易的中小型企业，其目的是通过植入特定的后门以实现对目标计算机进行信息收集和长期监控，并为接下来的横向移动攻击提供基础。
#### 2.1 地域分布
通过对已知的SWEED组织攻击行动中受害者的国家和地区分布情况进行统计（如图2-1），我们可以看到该组织发起的攻击活动覆盖了很多国家和地区，由此猜测，攻击者在攻击目标地理位置的选择上并没有特定的指向性。
![
](https://images.seebug.org/content/images/2020/07/3a6ac607-6b62-484d-926c-e92411ea54ef.png-w331s)
图2-1 受害者国家地域分布图
#### 2.2 行业分布
统计结果显示（如图2-2），此次SWEED组织在面向全球的攻击中，运输、制造业和能源行业依然是其重点针对的目标对象。
![
](https://images.seebug.org/content/images/2020/07/4c983d53-89bd-4295-b9c5-8f8cc6290e19.png-w331s)
图2-2 受害者行业分布图
### 三 攻击事件分析
本小节总结了该组织在近些年的攻击活动时间点、此次行动中使用的攻击手法以及攻击流程。
#### 3.1 攻击活动时间线
为了对黑客组织在此次攻击活动使用的策略和技术进行全面的了解，启明星辰ADLab研究人员将目前关联到的该组织近几年的主要活动做了梳理和总结，并绘制了“SWEED组织”活动时间轴（如图3-1）。从时间轴可以看出，该组织的大部分活动都具有一致性——借助带有恶意附件的鱼叉式钓鱼邮件分发远控木马程序（RAT），并且行动中使用的木马程序主要是以Agent
Tesla为主。
![
](https://images.seebug.org/content/images/2020/07/b773c1ca-9ba8-4b32-93b9-5df198cfe053.png-w331s)
图3-1 SWEED组织相关活动时间轴
#### 3.2 攻击手法和特点
SWEED组织在初始环节主要以投递钓鱼邮件开始展开攻击，攻击者在前期对目标用户进行深入调研，选取与目标用户所属行业或领域相关的内容来构造邮件和恶意文档。随后将精心制作的主题如”采购订单”、“紧急运输文件”、”装船通知单“等文档添加在邮件附件中发送给目标用户，诱使其下载附件，目标用户一旦打开带有漏洞的恶意文档，触发漏洞的恶意代码就将会在后台静默下载和执行恶意软件，从而窃取目标用户的敏感信息并对其主机进行控制。
##### 3.2.1 鱼叉邮件
启明星辰ADLab通过对SWEED组织年初至今的攻击行动进行监测和关联分析后，梳理出几十起定向目标的攻击钓鱼邮件。部分相关邮件信息见表3-1。
![
](https://images.seebug.org/content/images/2020/07/7c160a62-1085-46e1-b419-83faaf91705a.png-w331s)
表3-1 部分钓鱼邮件案例信息
通过分析这些邮箱发件人所属公司的注册信息以及其官网信息，我们发现多数公司网站均为合法网站，由此猜测攻击者使用的这些邮箱，有可能来自被入侵和盗用的合法实体或个人。虽然收件人的信息很多无法看到，但是从邮件的主题以及正文内容不难看出，攻击者企图利用运输货物清单、装箱交货价单、物品到货通知单、海上新订单等邮件向运输商、制造商及其合作商进行有针对性的攻击活动。下面我们从以上邮件中列举一个做简单分析。
在此案例中，攻击者试图使用“VSL: MV FORTUNE TRADER”主题冒充“MV Fortune Trader”。船舶FORTUNE
TRADER是一艘建于1994年的集装箱船，该船舶的注册国家为韩国。
![
](https://images.seebug.org/content/images/2020/07/9b8627ac-c6fa-44b7-a10c-4329600ed15e.png-w331s)
图3-2 船舶FORTUNE TRADER相关信息
邮件正文与主题保持一致，显示该邮件是来自超捷国际物流公司。该公司总部位于台湾台北，主要提供海运、空运和中港运输等业务。
![
](https://images.seebug.org/content/images/2020/07/c53b2799-c35f-42c2-a192-069085bac6dd.png-w331s)
图3-3 超捷国际物流公司主页
邮件正文如图3-4：
![
](https://images.seebug.org/content/images/2020/07/33d184e3-7d72-4739-80d1-a3792e7d7285.png-w331s)
图3-4 邮件正文信息
对邮件信息进行解析后如图 3-5所示，发件人的邮件地址是印度尼西亚一家名为“PT.INTI PERSADA
NUSANTARA”电机设备公司的合法域，而该邮件实际上是由托管在us10.rumahweb.com上的Roundcube
Web邮件服务器发送。这里收件人地址之所以显示为“Undisclosed-Recipient”（导致无法看到收件人信息），猜测攻击者是在使用Roundcube
Webmail/1.3.8软件群发邮件时，为了不让收件人看到其他接收邮件人的地址，故将此处设置为Undisclosed-Recipient。
![
](https://images.seebug.org/content/images/2020/07/d6796e60-732f-490c-bafc-d9988e0ef59e.png-w331s)
图3-5 部分邮件头部信息
##### 3.2.2 诱饵文件
通过对该批截获的邮件进行分析所得，攻击者使用的攻击载荷类型总共有四种。下面将列举典型的攻击载荷及其所对应的钓鱼邮件。
(1) 携带漏洞文档
图3-6是一封攻击者冒名航空货运公司发送给客户的预约请求回复邮件，附件伪装成船舶详细信息表单。该文档使用微软Office经典漏洞CVE-2017-11882，当用户打开恶意文档时，嵌入到文档中的恶意程序则会自动加载。该漏洞的特点是在整个过程中用户完全无感知，且在断网的情况下仍然可达到有效攻击，所以成为各大APT组织必用漏洞利用库之一。
![
](https://images.seebug.org/content/images/2020/07/3fc47012-4a09-4d1b-b264-f8ba7527f75b.png-w331s)
图3-6 携带漏洞文档案例1—邮件截图
（2）携带GZ格式的压缩文档
图3-7是攻击者发送给总部位于比利时的一家多元化的工业制造商的邮件，该邮件使用热门的COVID-19为主题，并通过正文描述谎称恶意附件GZ压缩文档中包含采购单，诱使受害者下载。
![
](https://images.seebug.org/content/images/2020/07/c07b3a0b-f48c-481f-b173-54d72a4a06b3.png-w331s)
图3-7 携带GZ文档案例2—邮件截图
附件里面是伪装成bat文件的Guloader下载器。
![
](https://images.seebug.org/content/images/2020/07/9415eef9-36a3-409a-9c86-2cd1c4abd372.png-w331s)
图3-8 GZ压缩包里的文件
（3）携带ISO格式的文档
由图
3-9可见，攻击者将邮件附件伪装成系统镜像ISO文件（使用ISO文件可用于绕过垃圾邮件过滤器），将其命名为“COVID-19解决方案宣布”诱骗用户点击。嵌入在ISO恶意附件中的可执行文件为Guloader下载器。
![
](https://images.seebug.org/content/images/2020/07/05083637-6eaf-4d3a-8e75-b5accb284595.png-w331s)
图3-9 ISO压缩包里的文件
（4）携带html格式的文件
图3-10是攻击者冒充DHL Express国际快递公司发送给德国一家光学组件制造商的钓鱼邮件，邮件附件被命名为装船通知单并以html形式诱骗受害者点击。
![
](https://images.seebug.org/content/images/2020/07/ec4a71e6-6f7d-4bd8-83d4-095822e9322a.png-w331s)
图3-10 携带html文件案例3—邮件截图
##### 3.2.3 恶意软件托管位置
在攻击活动中，攻击者经常利用远程配置来控制恶意软件，而安全人员通过研究分析不同的恶意软件配置（例如主机地理位置和DNS信息），可以深入的了解和追踪攻击者使用的基础设施。我们在研究过程中将收集到的大量样本数据进行提取和整合，发现SWEED组织此次实施攻击行动所使用的恶意软件配置，主要应用了Guloader下载器配置选项中的利用云服务分发恶意软件的功能。攻击者之所以使用正规的云存储平台来托管恶意软件，是因为这些云平台多数是受信任的且有助于绕过商业威胁检测产品。虽然Google
Drive等云平台通常也会执行防病毒检测，但如果有效载荷是被加密后再存储，就可以躲过此类限制，并能有效的阻止安全人员对黑客组织的基础设施进行追踪。图3-11为恶意载荷样本托管平台的使用占比率。根据图中显示的数值可得，Google
Drive为恶意软件主要使用的托管平台。除此之外，还有部分恶意软件会托管在已被攻陷的合法网站上。
![
](https://images.seebug.org/content/images/2020/07/64ff6e33-0e09-4673-957b-636c3d028c31.png-w331s)
图3-11有效载荷托管平台的使用率
除了Google Drive和OneDrive，下面我们列举出几个攻击者使用的其他云托管平台。
files.fm是国外一家提供文件云存储平台的信息技术公司。图3-12是保存在该平台的加密的恶意文件。
![
](https://images.seebug.org/content/images/2020/07/bd11e56d-cadf-4e0f-94e8-e68e623f4a28.png-w331s)
图3-12 云托管平台例1
sendspace是一家免费文件托管平台。图3-13是攻击者上传到该平台进行托管的恶意软件。
![
](https://images.seebug.org/content/images/2020/07/237d471f-ac21-49d2-83f6-16bef4604c59.png-w331s)
图 3-13 云托管平台例2
dmca.gripe是一个免费的文件托管平台，其主页如图3-14所示。
![