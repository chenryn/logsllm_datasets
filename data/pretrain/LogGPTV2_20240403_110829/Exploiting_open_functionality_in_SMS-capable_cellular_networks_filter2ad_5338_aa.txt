title:Exploiting open functionality in SMS-capable cellular networks
author:William Enck and
Patrick Traynor and
Patrick D. McDaniel and
Thomas F. La Porta
Exploiting Open Functionality in SMS-Capable Cellular
Networks
William Enck, Patrick Traynor, Patrick McDaniel, and Thomas La Porta
Systems and Internet Infrastructure Security Laboratory
Department of Computer Science and Engineering
The Pennsylvania State University
University Park, PA 16802
{enck, traynor, mcdaniel, tlp}@cse.psu.edu
ABSTRACT
Cellular networks are a critical component of the economic and
social infrastructures in which we live. In addition to voice ser-
vices, these networks deliver alphanumeric text messages to the
vast majority of wireless subscribers. To encourage the expansion
of this new service, telecommunications companies offer connec-
tions between their networks and the Internet. The ramiﬁcations
of such connections, however, have not been fully recognized. In
this paper, we evaluate the security impact of the SMS interface
on the availability of the cellular phone network. Speciﬁcally, we
demonstrate the ability to deny voice service to cities the size of
Washington D.C. and Manhattan with little more than a cable mo-
dem. Moreover, attacks targeting the entire United States are fea-
sible with resources available to medium-sized zombie networks.
This analysis begins with an exploration of the structure of cellu-
lar networks. We then characterize network behavior and explore
a number of reconnaissance techniques aimed at effectively target-
ing attacks on these systems. We conclude by discussing counter-
measures that mitigate or eliminate the threats introduced by these
attacks.
Categories and Subject Descriptors
C.2.0 [Computers-Communication Networks]: General—Secu-
rity and protection
General Terms
Security
Keywords
telecommunications, sms, denial-of-service, open-functionality
1.
INTRODUCTION
The majority of mobile phone subscribers are able to receive
both voice and alphanumeric text via Short Messaging Service (SMS)
transmissions. Text messaging allows users to interact with each
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
CCS’05, November 7–11, 2005, Alexandria, Virginia, USA.
Copyright 2005 ACM 1-59593-226-7/05/0011 ...$5.00.
other in situations where voice calls are not appropriate or possi-
ble. With countries such as the UK experiencing volumes of 69
million messages per day [16], this service is rapidly becoming as
ingrained into modern culture as its voice counterpart [13, 11].
Text messaging services are extremely popular with the telecom-
munications industry. Whereas voice trafﬁc typically yields a ﬁxed
amount of revenue per user, service providers earn up to US$0.10
per text message sent or received by a mobile device [45, 60, 19].
Seeing this tremendous potential for revenue, cellular providers
have opened their networks to a number of additional services de-
signed to increase SMS messaging volume. Through service provi-
der website interfaces, email, and a wide variety of applications
including instant messaging, users across the Internet can contact
mobile subscribers without the use of a cell phone. Such open func-
tionality, however, has serious negative consequences for these net-
works.
This paper evaluates the security impact of Internet-originated
text messages on cellular voice and SMS services. The connections
between the Internet and phone networks introduce open function-
ality that detrimentally affects the ﬁdelity of a cellular provider’s
service. Through the generation and use of large, highly accurate
phone hit-lists, we demonstrate the ability to deny voice service to
cities the size of Washington D.C. and Manhattan with little more
than a cable modem. Moreover, attacks targeting the entire United
States are feasible with resources available to medium-sized zom-
bie networks. Even with small hit-lists, we show that these cyber-
warfare attacks are sustainable for tens of minutes. These attacks
are especially threatening when compared to traditional signal jam-
ming in that they can be invoked from anywhere in the world, often
without physical involvement of the adversary.
There are many dangers of connecting digital and physical do-
mains. For example, a wide array of systems with varying degrees
of connectivity to the Internet were indirectly affected by the Slam-
mer worm. The trafﬁc generated by this worm was enough to ren-
der systems including Bank of America’s ATMs and emergency
911 services in Bellevue, Washington unresponsive [40].
There is nothing fundamentally different about the ways in which
these victimized systems and cellular networks are connected to the
Internet; all of the above systems were at one time both logically
and physically isolated from external networks, but have now at-
tached themselves to the largest open system on the planet. Ac-
cordingly, we show that mobile phone networks are equally as vul-
nerable to the inﬂuence of the Internet.
In evaluating Internet-originated SMS attacks on cellular net-
works, we make the following contributions:
• System Characterization: Through analysis of publicly avail-
able cellular standards and gray-box testing, we character-
ize the resilience of cellular networks to elevated messaging
loads.
• Reﬁning Target Search Space: We discuss a variety of tech-
niques that, when used in combination, result in an accurate
database of targets (“hit-lists”) for directed attacks on cellu-
lar networks. These lists are absolutely essential to mounting
effective attacks against these networks.
• SMS/Cellular Network Vulnerability Analysis: We illu-
minate the fragility of cellular phone networks in the pres-
ence of even low-bandwidth attacks. We demonstrate and
quantify the ability to incapacitate voice and SMS service
to neighborhoods, major metropolitan areas and entire conti-
nents.
The remainder of this paper is organized as follows: Section 2
gives a high-level overview of GSM network architecture and de-
scribes text message delivery; Section 3 investigates cellular net-
works from an attacker’s perspective and identiﬁes the mechanisms
necessary to launch Denial of Service (DoS) attacks; Section 4
models and quantiﬁes DoS attacks in multiple environments; Sec-
tion 5 discusses a number of attacks inherent to attaching general
purpose computing platforms to the Internet; Section 6 proposes
various solutions to help alleviate these problems; Section 7 dis-
cusses important related works; Section 8 presents concluding re-
marks.
2. SMS/CELLULAR NETWORK OVERVIEW
This section offers a simpliﬁed view of an SMS message travers-
ing a GSM-based system from submission to delivery. These pro-
cedures are similar in other cellular networks including CDMA.
2.1 Submitting a Message
There are two methods of sending a text message to a mobile
device - via another mobile device or through a variety of Exter-
nal Short Messaging Entities (ESMEs). ESMEs include a large
number of diverse devices and interfaces ranging from email and
web-based messaging portals at service provider websites to voice
mail services, paging systems and software applications. Whether
these systems connect to the mobile phone network via the Inter-
net or speciﬁc dedicated channels, messages are ﬁrst delivered to
a server that handles SMS trafﬁc known as the Short Messaging
Service Center (SMSC). A service provider supporting text mes-
saging must have at least one SMSC in their network. Due to the
rising popularity of this service, however, it is becoming increas-
ingly common for service providers to support multiple SMSCs in
order to increase capacity.
Upon receiving a message, the contents of incoming packets are
examined and, if necessary, converted and copied into SMS mes-
sage format. At this point in the system, messages from the Internet
become indistinguishable from those that originated from mobile
phones. Messages are then placed into an SMSC queue for for-
warding.
2.2 Routing a Message
The SMSC needs to determine how to route messages to their
targeted mobile devices. The SMSC queries a Home Location Reg-
ister (HLR) database, which serves as the permanent repository of
user data and includes subscriber information (e.g. call waiting and
text messaging), billing data, availability of the targeted user and
their current location. Through interaction with other network el-
ements, the HLR determines the routing information for the desti-
nation device. If the SMSC receives a reply stating that the current
(a) SMS Network
(b) SMS Flow
Figure 1: Simpliﬁed examples of an SMS Network and message
ﬂow
user is unavailable, it stores the text message for later delivery. Oth-
erwise, the response will contain the address of the Mobile Switch-
ing Center (MSC) currently providing service. In addition to call
routing, MSCs are responsible for facilitating mobile device au-
thentication, location management for attached base stations (BS),
performing handoffs and acting as gateways to the Public Switched
Telephone Network (PSTN).
When a text message arrives from the SMSC, the MSC fetches
information speciﬁc to the target device. The MSC queries a database
known as the Visitor Location Register, which returns a local copy
of the targeted device’s information when it is away from its HLR.
The MSC then forwards the text message on to the appropriate base
station for transmission over the air interface. A diagram of a mo-
bile phone network is depicted in Figure 1(a), followed by a sim-
pliﬁed SMS message ﬂow in Figure 1(b).
2.3 Wireless Delivery
The air interface is divided into two parts - the Control Chan-
nels (CCH) and Trafﬁc Channels (TCH). The CCH is further di-
vided into two types of channels - the Common CCH and Dedicated
CCHs. The Common CCH, which consists of logical channels in-
cluding the Paging Channel (PCH) and Random Access Channel
(RACH), is the mechanism used by the base station to initiate the
delivery of voice and SMS data. Accordingly, all connected mobile
devices are constantly listening to the Common CCH for voice and
SMS signaling.
The base station sends a message on the PCH containing the
NetworkHLRSMSCInternetMSCESMEVLRBSMSCVLRBSBSBSBSBSPSTNESMESMSCHLRMSCVLRBSMHSubmit SMObtainRoutingInformationForward SMObtainSubscriberInformationForward SMDeliver SMACKACKACKFigure 2: A simpliﬁed SMS air interface communication. The
base station notiﬁes two mobile hosts (MH1 and MH2) of new
messages. MH1 hears its identiﬁer and responds. After authen-
ticating and establishing an encrypted channel, the text mes-
sage is delivered over a dedicated control channel.
Temporary Mobile Subscriber ID (TMSI) associated with the end
destination. The network uses the TMSI instead of the targeted de-
vice’s phone number in order to thwart eavesdroppers attempting to
determine the identity of the receiving phone. When a device hears
its TMSI, it attempts to contact the base station over the RACH and
alerts the network of its availability to receive incoming call or text
data1. When the response arrives, the base station instructs the tar-
geted device to listen to a speciﬁc Standalone Dedicated Control
Channel (SDCCH). Using the SDCCH, the base station is able to
facilitate authentication of the destination device (via the subscriber
information at the MSC), enable encryption, deliver a fresh TMSI
and then deliver the SMS message itself. In order to reduce over-
head, if multiple SMS messages exist on the SMSC, more than one
message may be transmitted over an SDCCH session [5]. If a voice
call had been waiting at the base station instead of a text message,
all of the above channels would have been used in the same manner
to establish a connection on a trafﬁc channel.
An illustration of this ﬁnal stage of delivery over the air interface
is shown in Figure 2.
3. SMS/CELLULAR NETWORK
VULNERABILITY ANALYSIS
The majority of legitimate uses for SMS can often be character-
ized as nonessential, ranging from social interactions to low priority
business-related exchanges. The salient feature of these communi-
cations is that they can typically be accomplished through a num-
ber of other, albeit potentially less convenient channels. During the
terrorist attacks of September 11, 2001, however, the nature of text
messaging proved to be far more utilitarian.
With millions of people attempting to contact friends and fam-
ily, telecommunications companies witnessed tremendous spikes
in cellular voice service usage. Verizon Wireless, for example, re-
ported voice trafﬁc rate increases of up to 100% above typical lev-
els; Cingular Wireless recorded an increase of up to 1000% on calls
destined for the Washington D.C. area [44]. While these networks
are engineered to handle elevated amounts of trafﬁc, the sheer num-
ber of calls was far greater than capacity for voice communications
in the affected areas. However, with voice-based phone services be-
ing almost entirely unavailable due to TCH saturation, SMS mes-
sages were still successfully received in even the most congested
regions because the control channels responsible for their delivery
remained available.
Text messaging allowed the lines of communication to remain
open for many individuals in need in spite of their inability to com-
plete voice calls. Accordingly, SMS messaging is now viewed by
many as a reliable method of communication when all other means
appear unavailable.
1A high number of call initiations at a given base station slows
this response as the RACH is a shared access channel running the
Slotted Aloha protocol
Due to this proliferation of text messaging, we analyze Internet-
originated, SMS attacks and their effects on voice and other ser-
vices in cellular networks. We ﬁrst characterize these systems thro-
ugh an extensive study of the available standards documentation
and gray-box testing. From this data, we discuss a number of
attacks and the susceptibility of mobile phone networks to each.
Lastly, from gray-box testing, we assess the resilience of these net-
works to these attacks.
Before discussing the speciﬁcs of any attack on cellular net-
works, it is necessary to examine these systems from an adversary’s
perspective. In this section, we present simple methods of discov-
ering the most fragile portions of these networks by determining
system bottlenecks. We then investigate the creation of effective
targeting systems designed to exploit these choke points.
3.1 Determining Bottlenecks in Cellular
Networks
There is an inherent cost imbalance between injecting SMS mes-
sages into the phone network and delivering messages to a mobile
user. Such imbalances are the root of DoS attacks.
Recognizing these bottlenecks requires a thorough understand-
ing of the system. The cellular network standards documentation
provides the framework from which the system is built, but it lacks
implementation speciﬁc details. In an effort to bridge this gap, we
performed gray-box testing [7, 14].
We characterize these systems by delivery disciplines, delivery
rates, and interfaces. All tests were performed using our own phones.
At no time did we inject a damaging volume of packets into the sys-