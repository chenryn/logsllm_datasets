尽管商家具有大量动机保护这些信息，但它们对购买过程并没有足
够的控制，无法有效地实现目标。如前所述，这些数据必须通过多
个系统传递，其中包括商家无法直接控制的系统。我们还看到许多
商家在交易完成很久之后仍然保留其中一些数据，这就进一步增加
了风险。
服务供应商也受到PCI数据安全标准（DSS）的约束。根据PCI安全
委员会的说法，服务供应商的定义是：
2293
---
## Page 2295
服务供应商是一个业务实体，既不是支付卡品牌成员，也不是直接
参与处理、存储、传输以及交换业务数据和持卡人信息或两者的商
家。它还包括为商家、服务供应商、控制或影响持卡人数据安全性
的成员提供服务的公司。例如，提供托管防火墙、IDS和其他服务的
托管服务供应商、主机服务商和其他实体。仅提供通信链路而不能
访问通信链路的应用层的电信公司除外。
许多适用于商家的规则同样适用于服务供应商，后者具有类似的处
罚和责任。但是，它们的动机却颇不相同，因为它们并不直接与消
费者进行接触。也就是说，在业务对业务的空间中，对品牌的损害
仍然可能是一个很重要的因素。
收单银行和发行银行
收单（商家）银行和发行银行是受到严重约束的实体，它们对信息
保护的需求远远超出了支付卡行业的预期。发行银行还具有代表交
易中的消费者的额外动机。这通常意味着它不仅要关注数据的保
护，而且常常要向消费者倡导数据安全。商家银行受到许多金融法
规和交换的约束。它通常作为中间人或过手人，因此也牵涉到与商
家和服务供应商相关的处罚。当一位商家或它的其中一位服务供应
商相信发生了盗用事件时，收单银行将把银行卡协会所评估的任何
罚款递交给商家和服务供应商，因为收单银行直接管理与商家的关
系。
银行卡协会
银行卡协会预防欺诈的主要动机在于维护自己的品牌。简而言之，
如果一个特定品牌被过度盗用，会给自已的形象抹黑，从而降低它
在网络上的使用量。对银行卡协会而言，与银行卡盗用相关的经济
后果并不存在。银行卡协会主要是希望消费者在使用它们的银行卡
时能够感觉到安全。PCIDSS是由几家银行卡品牌组合了它们的安全
程序后形成的，目的是为了自律和保护它们的品牌。
谁是主导者呢
总之，交易的每个参与者都有一定的动机希望保护这些数据（具有
讽刺意味的是，消费者的动机反而最小）。但是，动机与控制力显
然并不平衡。也就是说，没有任何一方可以完全控制数据的保护，
也没有任何一方的动机与控制共享的秘密在流经各个环境时能够得
到保护方面相当。
2294
---
## Page 2296
简而言之，当前系统具有太多的参与方需要知道这些共享秘密，但
它们又没有足够的动机期待这些信息在它们的生命期内保持机密。
把图5-1所显示的每个交易的参与方数量乘以一张信用卡的生命期内
所经历的交易总数，可以看到共享秘密的接触方可以高达数千个。
5.3重塑电子商务：新的安全模型
回顾了电子商务交易的当前安全模型之后，我们对它的优点和弱点
有了充分的了解。现在，我建议用一种更优雅的方式观察电子商务
的安全，使银行卡账户信息对攻击者而言没有什么利用价值，从而
为消费者提供安全保障。
在不出示银行卡的情况下执行借记或贷记交易时，本质上共有7个基
本需求，以保证交易的安全性，同时不会影响消费者和商家对系统
的使用。
5.3.1需求1：消费者必须通过认证
第1个需求是对消费者进行身份认证，确认他们的合法身份。如果消
费者John被绑定到信用账户John123，首先需要确定他就是消费者
John本人。这种认证由谁来执行最为合适呢？最合适的认证方式文
是什么呢？
身份认证最好是由持卡人账户的管理者来执行，在大多数情况下是
发行银行。这样做的理由如下：发行方已经拥有这些信息，因此让
发行方存储这些信息并不会增加系统失败的风险。另外，发行方在
认证的专业知识和流程方面投资了大量的资源，能够正确地执行认
证。最后，发行者的数量要远远少于其他角色。
这种认证可以通过结合3个经典的认证因素来完成：
消费者所知道的东西，例如密码。
消费者所拥有的东西，例如令牌或证书。
消费者本身所代表的东西，例如生物统计数据。
稍后我们将会看到，后面两个因素可能会给海量的分布和管理增加
复杂性。
2295
---
## Page 2297
5.3.2需求2：商家必须通过认证
第2个需求是对商家进行认证。这可以使消费者相信商家是合法的，
能够提供消费者所订购的商品或服务。与第1个需求相似，对商家进
行认证的最适合的参与方是商家账户的管理者，在大多数情况下是
收单银行。
好了，我们已经完成了对消费者和商家的认证，现在又遇到了一个
滩题。发行方和收单方已经执行了认证，但交易是在消费者和商家
之间启动的。怎么才能共享认证信息，使交易中的两个主要角色能
够证实彼此的身份？这就需要发行方和收单方通过一种安全的方式
传递确认信息。当我详细解释自己所倡导的流程时，将会深入讨论
这个问题。
5.3.3需求3：交易必须经过授权
接下来就是第3个需求：交易本身必须经过授权。到目前为止，我们
已经确定了消费者John确实是本人，而且绑定到消费者John的账户。
我们已经证实了商家VencerCorp是一家合法的商家，并绑定到一家
收单银行。现在，我们需要知道消费者John是否被授权进行这次购
买。
幸运的是，在电子商务中，如果消费者已经正确地通过了认证，那
么第3个需求不会有什么问题。发行银行可以根据所有现有系统中的
账户状态、信用限制等状况确认交易。因此，如果需求1已经比较完
美（说得容易），就可以防止入侵者的欺诈（常常称为“恶意欺
诈”）。
必须承认，电子商务系统可能会遇到所谓的“友好欺诈”（这是一个
颇显矛盾的术语），就是说欺诈来自商家想与之进行交易的人。当
消费者在进行购买之后变卦了或者拒绝某些合法的收费时，就发生
了友好欺诈。在交易中检测友好欺诈要比检测恶意欺诈更为困难，
通过像数字签名这样的方式可以把发好欺诈控制在可以接受的程
度，不过这个话题已经超出了本章的范围。
5.3.4需求4：认证数据不应被认证方和被认证方之外的
其他各方所共享
2296
---
## Page 2298
安全电子商务交易的第4个需求是不能把认证数据泄露给被认证方
（消费者或商家）和负责执行认证的一方之外的其他各方。在一个
典型的不出示银行卡的交易中，共有4个不同的实体。消费者（1）
应该由发行银行（2）进行认证，而商家（3）由它的收单银行（4）
进行认证。这里的诀跨是所有各方所共享的是表示认证成功或失败
的证明，而不是共享实际的证书。
与当前广泛共享秘密的模型不同，这种新模型必须能够在不共享证
书的情况下共享消费者和商家的认证状态。如果实现了这个目标，
即使商家泄露了消费者的认证状态信息，对消费者的信用账户也不
会产生任何影响。消费者可以依赖发行银行系统的安全性，而不是
依赖每次购买所涉及商家的安全性。
商家一般是由一个供应商系统认证的，供应商是收单银行。由于收
单银行对商家进行认证，因此在这个模型中，消费者在交易之前共
享这个认证状态信息。我建议这个过程应该由收单方和发行方通过
银行卡网络进行处理，后面会给出解释。
5.3.5需求5：过程不能完全依赖共享秘密
第5个需求简单地重复了本章的中心思想。如果商家或服务供应商被
盗用，这个新模型也不应该遭到破坏。前面所讨论的虚拟卡账号是
满足这个需求的好方法，但它必须被统一使用。如果账号只是单次
有效或者只具有有限的用途，即使商家或服务供应商被盗用也不会
破坏整体的电子商务认证模型。
5.3.6需求6：认证应该是可移植的（不受硬件或协议所
限）
可移植性是必须实现的，因为当前存在太多的基础设施和太多的系
统，不可能进行如此巨量的重新部署或翻新。我们所创建的模型必
须允许消费者和商家在现有的支付框架和网络中进行认证。
尽管SET提供了一组健壮的安全控制，满足到目前为止所提及的大
多数需求，但这个领域仍然存在很大的短缺。对于当前的支付流程
而言，增加PKI基础设施和流程的额外开销显得过于庞大了。
2297
---
## Page 2299
5.3.7需求7：数据和交易的机密性和完整性必须得到维
护
第7个也是最后一个需求是维护数据和交易的机密性和完整性。这个
需求是众所周知的，这个新模型必须认真处理这个问题。它所涉及
的东西包括所有的认证数据、交易和订购数据。此外，它还维护这
些数据所需要的任何数据。这个需求必须得到满足，因为这些数据
是通过网络传输的，并且在系统中随时可能会被存储。
5.4新模型
考虑前面几节的需求，我提议在不出示银行卡的交易中使用下面这
个支付模型。
1）消费者通过一种公共的格式向商家和发行银行同时发送订购信
息。
2）当商家从消费者那里接收到订购信息时，商家通过它的收单银行
进行认证，并用一种单向的散列形式向银行发送订购信息。
3）成功通过认证之后，收单银行对表示订购信息的散列值进行签
名，并通过银行卡网络把这个值发送给发行银行。
4）发行银行验证收单银行的签名，并为消费者所发送的订购信息创
建一个单向的散列值。然后，它把这两个散列值进行比较，如果两
者匹配，就确认这次订购。
5）如果发行银行成功地验证了收单银行的签名和消费者的订单信
息，发行银行就向消费者发送一个限额与消费者的订购信息相符的
虚拟卡号。
6）消费者使用一个虚拟卡账户向商家提交支付信息。
图5-2描述了这些步骤。
2298
---
## Page 2300
图5-2信用交易的新模型
这个相对较为简单的六步骤过程满足上面所提到的所有需求，可以
防止处理交易的任何系统盗用消费者的账户。尽管上面这些概念对
于信息安全领域的人们而言并没有什么新意，但以前并没有协同使
用这些概念来保护现代的电子商务交易。我相信这种方法的简易性
使它成为一种美丽的方案，并且具备满足当前环境的可伸缩性。通
过结合一系列的现有安全特性和过程，我们可以从根本上改变整体
模型，创建一种简单、安全和美丽的混合体。
第6章捍卫在线广告：新狂野西
部的盗匪和警察
最新的计算机安全问题报告揭示了一个令人震惊的事实，那就是大
量的网络安全问题来源于在线广告。广告是网站生存的基石，它并
2299
---