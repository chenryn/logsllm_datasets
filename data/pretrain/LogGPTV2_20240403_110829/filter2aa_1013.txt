Computer Science / www.isec.utulsa.edu 
How to Hack Your Mini Cooper: 
Reverse Engineering CAN Messages 
on Passenger Automobiles  
Jason Staggs 
Computer Science / www.isec.utulsa.edu 
Who is this guy? 
• Jason Staggs 
– Graduate Research Assistant 
• Institute for Information Security (iSec) 
• Crash Reconstruction Research Consortium (TU-CRRC) 
– TRUE Digital Security 
• Cyber Security Analyst  
Computer Science / www.isec.utulsa.edu 
Why do we hack cars? 
• Related work 
– “Experimental Security Analysis of a Modern Automobile” 
– “Comprehensive Experimental Analyses of Automotive Attack 
Surfaces” 
• Understanding computer and network systems on cars 
– Underlying CAN protocol and components lack of 
authentication and verification of messages 
• Understanding potential points of vulnerability 
– Vehicle network security is in its infancy 
• But most importantly… 
Computer Science / www.isec.utulsa.edu 
To prevent this… 
Computer Science / www.isec.utulsa.edu 
From turning into this… 
Computer Science / www.isec.utulsa.edu 
Because of this... 
Computer Science / www.isec.utulsa.edu 
CAN Clock Project 
• Research project developed as a proof of concept 
– Manipulating CAN nodes via CAN network 
– Reverse engineering CAN messages 
– 2003 Mini Cooper 
Computer Science / www.isec.utulsa.edu 
Vehicle communication networks 
 • Common vehicle protocols 
– CAN (Most widely used among manufactures) 
– FlexRay 
– LIN 
– MOST 
– J1850 (GM/Chrysler) 
– J1939 (Heavy Trucks) 
– J1708/J1587 (Being phased out due to J1939) 
• 2008: All US cars use CAN for mandated EPA diag. 
Computer Science / www.isec.utulsa.edu 
Interconnected vehicle networks 
Computer Science / www.isec.utulsa.edu 
Controller Area Networks 
• Bosch CAN standard 
– Developed in the 80s  
– European automotive manufactures were early adopters 
– Multi-master broadcast message system 
– Standard Format 
• 11-bit message ID 
• 2^11 or 2048 possible message IDs 
• MFG. use of proprietary IDs for their ECUs 
– Extended Format 
• 29-bit message ID 
• 2^29 or 537 million message IDs 
• Used extensively by J1939 
Computer Science / www.isec.utulsa.edu 
CAN Frame 
– SOF – Start of Frame 
– Identifier – Unique identifier for message along with priority 
– RTR – Remote Transmission Request 
– IDE – Identifier extension (distinguishes between CAN standard and 
CAN extended) 
– DLC – Data Length Code (frames have up to 8 bytes of data) 
– CRC – Cyclic Redundant Check sum 
– ACK – Acknowledge 
– EOF – End of Frame 
– IFS – Intermission Frame Space 
Computer Science / www.isec.utulsa.edu 
Electronic Control Units (ECUs) 
• ECUs designed to control: 
– Vehicle safety systems 
• Engine control unit 
• ABS braking system 
• Door locks 
– Non safety critical systems 
• Radio deck 
• HVAC system 
– The list goes on… 
• Programmable ECUs 
– Allows MFGs to update firmware on ECUs 
• Average modern day car has ~70 ECUs 
Computer Science / www.isec.utulsa.edu 
Reverse Engineering CAN Messages 
• What we want to do: 
– Manipulate CAN enabled vehicle components (Instrument Cluster) 
• Problem: 
– Manufactures do not publish CAN message information about 
specific CAN components (ECUs) 
• Message IDs 
• Payload information (Byte offsets) 
• Solution: 
– A method for visually correlating physical system interactions 
with identifiable patterns. (Humans are good at this) 
– Fuzzing (DANGER WILL ROBINSON!!!) 
Computer Science / www.isec.utulsa.edu 
Reverse Engineering CAN Messages 
• Passively captured CAN traffic during a staged test run 
– In this case it was a staged automotive collision..   
– Mini Cooper vs. GMC Envoy (Check out TU-CRRC website for 
killer crash videos) 
– Data capture lasted for roughly 90 seconds 
• Data Log gives us ~106,000 data entries of CAN 
messages 
Computer Science / www.isec.utulsa.edu 
Computer Science / www.isec.utulsa.edu 
CAN Data Log 
• Contained ~106,000 data entries 
• Bash “cut –d. –f3 cooperheadion.txt | sort | uniq –c” 
– Only 15 Unique CAN IDs!? 
Message Frequency 
CAN IDs 
12706 
153 
12706 
1F0 
12706 
1F3 
9460 
1F5 
12707 
1F8 
8899 
316 
8899 
329 
Computer Science / www.isec.utulsa.edu 
Visually Identifying CAN Messages of Interest 
Message ID 0x153 Vehicle Speed 
Computer Science / www.isec.utulsa.edu 
` 
0 
5 
10 
15 
20 
25 
30 
0 
10 
20 
30 
40 
50 
60 
70 
80 
90 
100 
Vehicle Speed (MPH) 
Time (sec) 
0x153 Byte 2 CAN Message 
Computer Science / www.isec.utulsa.edu 
Reverse Engineering CAN Messages 
• Speedometer and Tachometer Message IDs 
– 2 methods 
• For each message ID, plot data values vs. timestamp in order to 
determine physical significance. 
• Given possible CAN IDs, fuzz data fields until needles start moving 
CAN Message ID Description 
0x153 Byte 2 
Speedometer (Vehicle Speed) 
0x316 Byte 3 
Tachometer (Engine Speed) 
0x329 
Various indicator lights 
0x61A 
Controls the messages being displayed on the tachometer 
LED screen 
0x61F 
Tachometer along with various indicator lights 
Computer Science / www.isec.utulsa.edu 
Building the CAN Clock and Network  
• CAN Bus 
– 18 gauge wire 
– 2 x 120 ohms terminating resistors 
– 12V DC power source 
– Arduino Uno microcontroller 
– CAN Bus Shield 
• MCP2515 CAN controller 
• MCP2551 CAN transceiver 
– Mini Cooper Instrument Cluster 
– Real time clock module RTC (for clock mode) 
Computer Science / www.isec.utulsa.edu 
Computer Science / www.isec.utulsa.edu 
Computer Science / www.isec.utulsa.edu 
CAN Clock Proof of Concept 
• Talking CAN with Arduino 
– Arduino and CAN Controller Libraries 
• MCP2515 (Communication with CAN transceiver) 
• SPI (Used for communications between Arduino and CAN shield) 
• 2 Modes of operation 
– Clock Mode 
– Demo Mode 
Computer Science / www.isec.utulsa.edu 
Demo 
Computer Science / www.isec.utulsa.edu 
Gaining Physical Access to CAN Bus 
• Via OBD2 
• Tapping the CAN bus (vampire tap) 
– Under the hood 
– Breaking a powered side view mirror 
– Etc. 
• 0 to pwned for less then $100 
– Rogue Arduino CAN node 
• Potential conspirators 
– Mechanics 
– Car Rentals 
– Coworkers/Family/Friends/Valets/Ex-girlfriends/etc. 
Computer Science / www.isec.utulsa.edu 
Conclusion / Future Work 
• Better access control between vehicle network 
components 
– ECU to ECU 
– OBD2 to ECU 
• Applying conventional NIPS & firewall methods to CAN 
– Message anomaly prevention depending on context? 
Computer Science / www.isec.utulsa.edu 
For more Information 
• TU Research 
– http://isec.utulsa.edu/ 
– http://tucrrc.utulsa.edu/ ← Check out our research and crash tests  
– http://tucrrc.utulsa.edu/canclock/ 
• CAN Standards/Docs 
– http://esd.cs.ucr.edu/webres/can20.pdf (CAN 2.0 Spec) 
– http://www.sae.org/standards/ 
Computer Science / www.isec.utulsa.edu 
Questions?? 
• PI:EMAIL