title:Formal Analysis of Security Procedures in LTE - A Feasibility
Study
author:Noomene Ben Henda and
Karl Norrman
Formal Analysis of Security Procedures in LTE -
A Feasibility Study
Noomene Ben Henda and Karl Norrman
Ericsson Research Stockholm, F¨ar¨ogatan 6 16480, Sweden
{noamen.ben.henda,karl.norrman}@ericsson.com
Abstract. The only part of the Long Term Evolution (LTE) security
standard that has been formally analyzed is the Authentication and Key
Agreement (AKA) procedure. It is not clear how well existing security
related veriﬁcation tools can handle other types of procedures. In this
work, we use ProVerif to analyze the procedures related to session man-
agement and mobility. Our analysis has shown that most of the secrecy
and agreement properties hold which was expected. However, we had
diﬃculties proving stronger injective agreement properties.
Keywords: Formal veriﬁcation, Telecom, LTE, security.
1
Introduction
Background. Long Term Evolution (LTE), a 4th Generation (4G) mobile com-
munication system, is the most recent standard developed by the 3rd Genera-
tion Partnership Project (3GPP) [1]. Among the objectives of LTE is to provide
higher data rates, enhanced quality of service and equal or better security com-
pared to previous generations [1] (TS 22.278). One such improvement is that
LTE introduces very granular key separation. LTE mandates the use of diﬀerent
session keys for speciﬁc protocols and purposes between the terminal and the
nodes in the network. Those keys are organized in a hierarchy (see Fig. 1b). At
the root of the hierarchy is a key that is shared between the Home Subscriber
Server (HSS) (see Fig. 1a) and the terminal, or User Equipment (UE) in the
3GPP speciﬁcations, where it is securely kept in a smartcard. During initial
attachment of the UE to the network, mutual authentication between them is
achieved by running the Authentication and Key Agreement protocol (AKA) [1]
(TS 33.401). The authentication is based on the root key. The other keys are
subsequently derived from keys that are closer to the root in the hierarchy than
themselves.
Each key in the hierarchy is shared between the UE and a particular node in
the network. For example the KASME key is shared with the Mobility Manage-
ment Entity (MME); the KeNB key is shared with the Evolved Node B (eNB).
The LTE standard deﬁnes speciﬁc procedures for the establishment of each key.
For instance, the KASME key is established by the AKA protocol which runs
between the UE and the HSS, and then provisioned to the target MME node.
A. Stavrou et al. (Eds.): RAID 2014, LNCS 8688, pp. 341–361, 2014.
c(cid:2) Springer International Publishing Switzerland 2014
342
N.B. Henda and K. Norrman
The KeNB is initially established by a combination of procedures involving the
MME, eNB, and the UE. The UE and MME use the KASME to agree on a KeNB.
The MME then provides this key to the eNB which ﬁnally activates the security
between the UE and the eNB based on the KeNB. Key establishment procedures
like these typically have to satisfy at least the following security properties: agree-
ment, secrecy and freshness. Agreement is the property that guarantees that the
involved parties obtain the same key at the end of the run; otherwise, the key
would be useless. Secrecy guarantees that no one, other that the involved parties
(who are assumed to not leak the key to outsiders), has the key. If secrecy is
not guaranteed, conﬁdentiality protection, among other cryptographically based
services, is not achievable. The last property of freshness prevents key re-use
and thus, for example, situations were a plain text is encrypted twice using the
same key.
HSS
MME
S1-MME
eNB
UE
INTERNET
S-GW/
PDN-GW
HSS and UE
K
CK, IK
KASME
MME and UE
X2
eNB
Trust domain
Control plane
User plane
eNB and UE
KeNB
KUPenc
KRRCenc KRRCint
KNASenc KNASint
(a) Simpliﬁed architecture of LTE
(b) Key hierarchy in LTE
Fig. 1. LTE overview
In a running system, the key establishment procedures and procedures making
use of the keys can be interleaved, repeated and run simultaneously by several
UEs and network nodes. They can as well be used as building blocks in more
complex compound procedures such as the ones handling mobility. The secu-
rity procedures are dependent on each other. For instance, the establishment
of a KeNB key requires the existence of a KASME key and thus any procedure
using the KeNB cannot be executed in a pure LTE system unless an AKA run
has taken place earlier. The procedures might also rely on other type of con-
text information, such as message counters and global parameters of the system.
State-based formal veriﬁcation tools like SPIN [18] can model this context infor-
mation and capture the eﬀect of reruns and interleaving. However state-based
approaches are not eﬀective to model cryptographic functions that usually rely
Formal Analysis of Security Procedures in LTE - A Feasibility Study
343
on advanced computations. Other symbolic approaches that abstract away the
implementation details of cryptographic primitives have been more eﬀective. In
general, formal analysis of security protocols is usually done against the symbolic
Dolev-Yao intruder (or attacker) model [16]. In this model, the attacker has full
control of the communication medium. In addition, cryptography is assumed
perfect so that the attacker cannot decrypt messages unless he has the required
key, hash functions are collision free, etc.
Contribution. In this paper, we present our work with ProVerif [8] which we
used to model and verify security properties of diﬀerent key establishment pro-
cedures in LTE. This work is part of a feasibility study whose aim is to bring
and put to use tools like ProVerif in an industrial context such as that of the
3GPP standardization process. Our main contribution consists in providing for-
mal models of the LTE protocols in the input language of the ProVerif. Our
implementation preserves the trust model of 3GPP. Furthermore, to the best of
our knowledge, the security procedures related to mobility and session manage-
ment have not been previously subject to formal analysis. Another contribution
consists in showing how to model and verify diﬀerent security properties. Our
analysis results conﬁrm all secrecy and most of the weak agreement properties.
However, stronger agreement properties are more challenging to prove, for several
reasons that we later discuss and explain. Our analysis approach using ProVerif
is simple and generic and thus can be easily adapted to other case studies.
Related Work. Although LTE security has received much scrutiny during the
design process, it has been less studied in the research community. In particular,
the research community has mainly focused on analyzing AKA [29,28,17,30],
which is largely the same authentication and key agreement protocol used for
Wideband Code Division Multiplex Access (WCDMA), a 3G access. AKA as
used in WCDMA was formally analyzed using BAN logic in [1] (TS 33.902).
AKA is re-used exactly as is in LTE to boot strap the key hierarchy. Therefore,
all analysis results on AKA as used in WCDMA carries over to LTE. A study
of privacy aspects of WCDMA is presented in [5]. Although it does not study
LTE, it looks at other procedures than AKA, namely the paging procedure. The
study in [24] contains an analysis of a proposed, but not standardized, system for
handovers between diﬀerent types of radio access systems. It does not provide
any analysis of LTE itself.
Research on formal veriﬁcation of security protocols has been ongoing for
two decades. Current state of the art tools like Scyther [13] and ProVerif can
verify protocols for unbounded number of sessions and agents. Case studies by
Scyther include the analysis of the Naxos protocol [14] and the IPsec exchange
protocols IKEv1 and IKEv2 [15]. Other applications include the analysis of the
privacy and key management protocol [27] and the handover schemes [26] in
WiMAX networks. Case studies by ProVerif include the analysis the Bluetooth
device pairing protocol [19], the just-fast-keying protocol [3], a secure ﬁle sharing
protocol [9], authentication in 3G where both GSM and WCDMA access is
used [28], and the privacy study on WCDMA mentioned earlier [5]. We note
344
N.B. Henda and K. Norrman
that [28] does not contain any analysis of mobility between radio access networks,
but rather considers the case of authentication over the GSM/EDGE access
network, when used to access a 3G network. There is a long list of similar tools
from which we cite the following ones: The Tamarin tool [23] has been used for
the veriﬁcation of group key agreement protocols [25]. The AVISPA [6] has been
used for the analysis of key management in hierarchical group protocols [12].
Other relevant tools are NRL [22], LySa [11] and Casper [21].
Outline. In the next section, we give an overview of the LTE architecture to put
in context the protocol models we provide. In Section 3, we describe ProVerif
and use AKA as an example illustrating our modeling approach. In Section 4,
we describe the security procedures related to session management, provide the
corresponding formal models and discuss the veriﬁcation results. In Section 5, we
present our work on security procedures in mobility events. Finally in Section 6,
we conclude by a summary discussions and future work. For shortage of space,
the full versions of the models that can be used to reproduce our results are
not included. They are available on demand. In the description of the LTE
procedures, many aspects not related to security have been omitted and thus we
refer to [1] for the detailed speciﬁcations.
2 Overview of LTE
LTE provides 4G mobile broadband access service to terminals. More precisely,
the service consists of providing a terminal with IP connectivity using a stable
IP address, while the terminal moves throughout the LTE network.
2.1 Architecture
LTE [1] (TS 23.401) consists of a Radio Access Network (RAN) and a core net-
work (see Fig. 1a). The radio access network consists of a set of base stations,
the eNBs. The terminals connect to the eNB via the radio air interface. The
eNB is connected to two nodes in the core network: the MME and the Serv-
ing Gateway (S-GW). The ﬁrst node (MME) handles the control plane traﬃc
for mobile terminals connected to the eNB. The control plane for a terminal is
used to manage the terminal sessions, mobility and security. The second node
(S-GW) handles the user plane traﬃc to and from the internet, and other opera-
tor services. Subscriber information such as authentication credentials, location,
subscription preferences, etc. is kept in the HSS.
2.2 Trust Model
During the security design in 3GPP a trust model for the network is assumed.
More precisely, the network is divided into two main types of trust domains:
the core network trust domain, and the RAN one. The standards have a more
Formal Analysis of Security Procedures in LTE - A Feasibility Study
345
granular concept of trust domains, but these two are suﬃcient for the proto-
cols considered in this paper. The data traﬃc ﬂows between nodes in diﬀerent
domains over an IP transport network.
The core network domain, which contains nodes like the HSS, MME, S-GW,
etc. is assumed to be a physically secure one. This means that attackers do not
have access to nodes in this domain other than what can be obtained remotely
via the network interfaces of the nodes.
The RAN trust domain contains only the eNBs. Since such nodes may be
deployed in physically insecure locations, such as on the wall of a shopping
mall, or in a hotel corridor, etc. the security model in LTE is built to handle the
situation where the eNBs are deployed in untrusted locations. In the standard [1]
(TS 33.401), it is required that each eNB implements its security processing
inside a secure environment. The purpose is to prevent attackers to gain access
to any data in the eNB by physically tampering with the device. Furthermore,
the IP transport network that connects nodes across diﬀerent domains is to be
protected using IPsec [1] (TS 33.210) unless it can be trusted.
2.3 Session and Mobility Management
The terminal maintains two control connections with the network, one with the
MME managed by the Non Access Stratum (NAS) protocol, and one with the
eNB managed using the Radio Resource Control (RRC) protocol. The MME
keeps track of the terminal location even when it is idle, i.e., it is not exchanging
user plane data. The location is deﬁned by an area served by possibly several
eNBs. The terminal keeps the MME updated of any area changes as it moves.
In case of incoming data, the MME pages the terminal on all eNBs in its last
known area. In response to the paging, the terminal requests a user plane data
connection from the MME. It is only then that the eNB, which the terminal uses
to access the network, becomes aware of the terminal presence. The MME pro-
vides the eNB with initial state information to communicate with the terminal.
The terminal can then become active sending and receiving data. Afterwards, it
can become idle again. In such case, the serving eNB releases all the associated
resources and is no longer aware of the terminal’s presence.
2.4 Key Hierarchy
Once security is activated, the NAS protocol between the terminal and the MME
becomes both integrity protected and encrypted. The same holds for the RRC
protocol between the terminal and the eNB. The user plane traﬃc is encrypted
in two hops. First the radio link between the terminal and the eNB is encrypted.
The eNB terminates the encryption of uplink traﬃc inside its secure environment
and forwards it to the S-GW through an IPsec tunnel. Downlink traﬃc is handled
in a similar manner.
Security for NAS, RRC and user plane traﬃc relies on separate encryption
and integrity session keys (see Fig. 1b). The keys for protecting RRC and user
346
N.B. Henda and K. Norrman
plane traﬃc are derived from the KeNB which in turn, is derived from the KASME.
The keys for the NAS protocol are also derived from the KASME key.
2.5 Initial Key Establishment
At start up, the terminal needs to register with the network. This is achieved by
the attach procedure. In connection to the attach procedure, the terminal and
network also run an AKA procedure. The outcome of AKA is the establishment
of the KASME session key between the terminal and the serving MME.
Figure 2 contains a simpliﬁed chart of the message exchange related to AKA
and that we brieﬂy explain as follows: First, the UE sends its identiﬁer IMSI and
security capabilities to the MME in an attach request. The MME then stores the
capabilities and forwards the IMSI to the HSS. The HSS uses the identiﬁer to
retrieve the secret subscriber key K, generates a nonce RAND and computes the
KASME key together with other authentication parameters. The authentication
data is then sent to the MME which uses it to authenticate the UE.
A
K
A
P
C
S
S
A
N
P
R
S
S
A
N
UE
eNB
MME
HSS
ATT: IMSI,UEalgs
ADQ: IMSI
ACH: RAND,AUTN
ADR: RAND,XRES,KASME,AUTN
ARE: RES
[NSM: eksi,UEalgs,NASalgs]
{[NSC]}