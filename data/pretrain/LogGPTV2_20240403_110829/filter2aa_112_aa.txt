PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Popping a Smart Gun 
DEF CON 25 
PI:EMAIL 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
What is a smart gun? 
• Gun that can be fired only by authorized parties 
• Various authorization/authentication approaches 
– Biometrics (e.g., fingerprint reader) 
– RFID ring 
– Etc. 
• See “A Review of Gun Safety Technologies” for a 
more thorough discussion (Greene 2013) 
– Greene gets some details wrong about the smart gun 
we will discuss today 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
In the movies 
Skyfall 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Smart guns 
• Examples that have been prototyped 
– iGun shotgun (RFID ring) 
– Kloepfer pistol (fingerprint) 
– Magna-Trigger/Magloc retrofit (magnets) 
– Safe Gun retrofit (fingerprint) 
• Only one model currently for sale in the US 
– Armatix iP1 (NFC/RF watch) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Why I care 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Armatix iP1: watch and pistol 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Design overview 
• Two system components 
– Pistol 
– Watch 
• Watch authorizes pistol to fire 
• Watch must be near the pistol (> Signal 
Signal strength 
Time 
= interfering signal 
= watch signal 
Slicer level 
Slicer level set based on interference peaks 
Slicer level too high 
No signal bits recovered 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Scenario 2: Interference ≈ Signal 
Signal strength 
Time 
= interfering signal 
= watch signal 
Slicer level 
Interference fills gaps in signal 
No edges where there should be edges 
Manchester decoding fails 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Scenario 3: Interference < Signal 
Signal strength 
Time 
= interfering signal 
= watch signal 
Slicer level 
Interference appears before byte start 
Byte sync incorrect 
Byte decode fails 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Custom test transmitter BOM 
• 916.5 MHz transmitter 
– Murata TR1000 (same module Armatix used) 
– Could have used a similar 916 MHz chip, e.g., SiLabs Si4430 
($5) or the ON Semi AX5243 ($1) 
• Antenna  
– Linx ANT-916-SP  
– Could have used a couple short pieces of wire ($0.05) 
• Generator for the modulation waveform 
– PIC16F18313 microcontroller ($1) 
• Stripboard breadboard ($1) 
• Total cost: $5 (optimal component choices) to $20 (as-
built) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Custom test transmitter 
(yes, I know that through-hole components usually go on the other side of a stripboard like this) 
Antenna 
MCU 
Transceiver 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Results 
• Gun does not fire while transmitter is active 
– 100% effective up to 3 m 
– Some effect even up to 10 m depending on pistol 
orientation 
– Higher TX power would increase range 
• For these tests, watch was on wrist of non-
shooting hand (about 10 cm from pistol) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Effective range 
916.5 MHz 
TX 
3+ m 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
(Demo of denial of service) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Defense 
• Use more transmitter power 
• Use error-correcting code 
• Use more-robust modulation 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
FIRE WITHOUT AUTHORIZATION 
Why have a smart gun in the first place? 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Unlocking mechanism 
Electromagnet 
MCU 
Ferrous material 
Cam 
Trigger 
Firing pin with 
blocking lugs 
Pin blocker 
Channel for pin 
to be unblocked 
(Looking longitudinally) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Trigger partially pulled 
MCU 
Cam moves up 
Trigger partially 
pulled, presses 
on cam 
Firing pin closer 
to being 
unblocked 
(Looking longitudinally) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Scenario 1: Firing NOT authorized 
Electromagnet 
NOT active 
MCU 
Firing pin remains 
blocked; 
Gun cannot fire 
(Looking longitudinally) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Scenario 2: Firing IS authorized 