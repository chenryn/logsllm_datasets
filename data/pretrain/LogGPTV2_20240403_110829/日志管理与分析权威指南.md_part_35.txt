12.1概述
本章要点
确实，总结和报告是日志分析的支柱：根据日志生成的按带宽排列的主要连接、按国家
总结很有效，并减少了你需要查看的数据量，但是在总结中我们杀死了数据，这有可能
任何必须查看日志数据的人都知道，只查看原始日志没有什么作用。但是，大部分日志
■关键错误和故障报告
■身份认证和授权报告
■定义最佳报告
■
恶意软件活动报告
资源访问报告
网络活动报告
更改报告
报告和总结
第12章
Chapter12
---
## Page 181
160
开源或者内部开发的日志管理及分析工具生成，也可以使用更高级的SIEM工具。
个类别都有适用于大部分组织的具体示例。它们的设计是与技术无关的，可以用于商业化、
列表，或者至少列出行业中适用性最广的报告。
与此同时，信息技术对企业和政府组织的重要性已经有了很大的提高，并将继续提高。
胁、云安全挑战等)。而且，怀有恶意的内部人员现在更有可能对企业造成损害或者欺诈。
本书其他章节中讨论过的许多其他框架）以及高级的威胁（恶意软件、邪恶的黑客、移动威
们的产品有“13000种报告”
大用户，不要忘记排名倒数前10的用户可能也很有趣。
丢失有用的信息；此外，数据可能因为我们选用的总结类型而被丢失。例如，如果你关注10
制，审核整个组织的身份认证活动是关键的安全性活动之一。
失败)，以及特定权限用户的活动，以及使用特权功能（授权）的企图。
12.3身份认证和授权报告
12.2
本章就是创建这一列表的一次尝试。报告被组织为6个宽泛的类别（或者报告类型），每
最后，报告通常相当多，选择哪一种报告是个挑战。举个例子，某个供应商曾经宣传他
这些报告识别以各种不同权限级别（身份认证）访问各种系统的企图（无论是成功还是
报告在日志分析中用途广泛，因此报告的可能种类很多，重要的是创建一个“最佳报告”
在此基础之上，许多组织苦于多种依从性框架（PCIDSS、HIPAA/HITECH、FISMA和
身份认证是控制现代系统访问权限的主要关卡和手段。从简单的密码到令牌以及加密机
重要性
6）故障和关键错误报告。
5）恶意软件活动报告
2）系统和数据变更报告。
最重要的报告类别如下：
这个类别的关键报告有：
在本章的其余部分，我们将用具体的例子介绍各个类别。
4）资源访问报告。
具体报告
3）
1）身份认证和授权报告。
网络活动报告。
定义最佳报告
一似乎这是一件好事..
---
## Page 182
统或者应用程序的其他组件。
核整个组织的身份认证摘要，安全分析人员可能在日常日志审核中使用这些报告，事故响应
证书（来源：http://chuvakin.blogspot.com/2010/08/updated-with-community-feedback-sans_06.html）。
生成，但是跟踪多次失败后的成功连接明显令人感兴趣，因为它几乎总是说明有人企图猜测登录
12.4
人员可能在事故调查时使用这些报告，而系统管理员可能在自己的系统上使用这些报告。
Mercury
这些报告识别各种系统和安全的关键变更一
Jupiter
Venus
表12.1展示了系统登录企图。
这些报告有很普遍的适用性，具体取决于系统的覆盖范围。首席安全官（CSO）可以审
系统
谁能使用这些报告
多次登录失败之后，同一个账户登录成功：这种报告需要基于规则（SIEM风格）的关联来
■VPN身份认证和其他远程访问登录（成功，失败）：所有登录企图在合适的场合下都
■按照用户、
！
般比常规用户严重得多。
使用以及其他平台和系统上的等价操作都必须加以考虑，因为特权用户造成的破坏-
特权账户访问（成功，失败）：根用户或者管理员登录、su命令的使用、RunAs命令
趣，应该小心跟踪。
是令人感兴趣的，而通过VPN或者其他远程连接方法进行的远程登录尝试就更为有
扫描”有些类似。
这种扫描中，单一机器检查许多系统上的同一个账户或者不同账户，和老式的“主机
用户在试图登录的不同系统中身份认证失败的计数：这种聚合报告检测账户扫描，在
令人感兴趣。但是，对这种事件必须加以调查，尤其是在系统管理员全天候工作的环境中。
下班时间／“休息”时间的所有登录：和上面的报告类似，这种活动通常在访问成功时特别
访问的账户和服务的访问企图。不管失败还是成功，对安全专业人士来说都是有趣的。
禁用/服务/不存在/默认/挂起账户的登录企图（成功，失败）：这种报告覆盖对不应该
值在于，它要求你不能仅仅记录成功或者失败的登录，而是对两者都要记录。
变更报告
不同系统、访问方法（本地或远程）和用户的成功及失败登录的报告。这种报告的价
、系统、业务单位列出的所有失败和成功登录：这可能是一个或者多个显示
anton
administrator
账户名称
表12.1
10.1.2.3
10.11.12.13
10.1.1.2
源IP
展示登录企图的报告示例
一配置文件、账户、监管和敏感数据以及系
状态
失败
成功
失败
方法
SSH
本地
本地
第12章报告和总结161
893765
1
计数
---
## Page 183
162
看整个组织的变更摘要，安全分析人员可能在日常日志审核中使用这些报告，事故响应人员
击者往往修改你的系统，以便在未来能够访问。勤勉地跟踪变更还将改进你的整体IT运营状况。
可能在事故调查时使用这些报告，而系统管理员可能在自己的系统上使用这些报告。
表12.2展示了Linux系统上的所有账户和组添加。
对信息系统的未授权变更导致许多代价沉重的崩溃、数据丢失和安全事故。除此之外，攻
这些报告有很普遍的适用性，具体取决于系统的覆盖范围。首席安全官（CSO）可以查
■管理员/特权组中账户的添加：
■用户和组的添加/变更/删除：
这个类别的关键报告有：
谁能使用这些报告
■
具体报告
重要性
■
■
1/10/1111:11AMPST
1/11/1111:11AMPST
1/10/1111:11AMPST
些活动应该在授权方式下进行。
程序安装和更新必须记录日志，至少，这些日志在事故响应中很有用。
系统、应用程序、用户进行的应用程序安装和更新（成功、失败）：各系统的所有应用
变更，它们可能造成敏感数据的丢失。
文件访问权限的变更：危险变更的变种之一是文件权限的变更；如果没有考虑到这种
同的关键文件，对这些文件的访问也要跟踪。
对其他关键文件的变更：除了二进制可执行文件和配置文件之外，各种系统可能有不
的变更，不管是偶然、计划还是恶意的，都需要小心跟踪。
对系统文件（二进制文件、配置）的变更：对系统文件（如二进制文件和配置文件)
对敏感文件的变更：或者对敏感文档的下载/复制。
络，它们常常是攻击者进行的。
网络服务的添加/变更／删除：允许网络连接的新服务可能向附加的攻击开放你的网
确定授权的密码变更是否按照策略的安排进行。
样重要。这些操作可以由用户进行，也可以由管理员进行。此外，这种报告可以用于
密码变更和重置—由用户进行以及由管理员进行：密码变更通常和新账户的创建一
的跟踪列表中排在首位。
日期
表12.2
系统
Venus
Jupiter
Venus
展示账户和组添加的报告示例
：攻击者常常添加新的账户，然后在访问之后删除。这
：对管理员账户和其他特权用户的变更应该在账户变更
账户名称
root
anton
root
添加账户
添加组
添加账户
操作
对象
rootl
sudoers
anton
状态
成功
失败
成功
---
## Page 184
12.5
■按照系统、连接数量、用户、带宽、独特目标计数列出的所有来自内部和DMZ系统
网络是信息资产威胁的主要来源。显然，网络也是从现代组织中窃取信息资产的主要途径。
这些报告识别各个系统的可疑和有潜在危险的网络活动，以及需要为常见法规跟踪的活动。
■一段时期内的日志容量趋势：虽然这严格上不能算是网络活动报告，但是审核网络产
■在下班时间内部和DMZ系统的所有出站连接：使用防火墙和Web代理日志，人们可
这一类别的关键报告有：
具体报告
重要性
无线网络活动：无限网络设备能够记录许多不同的事件，将它们作为前述的VPN和
据的另一个有用的报告包括流氓AP检测和流氓AP关联日志。
其他远程网络访问机制进行跟踪也很有用（包括用户名和Windows名）；有关无线数
内部系统使用P2P：虽然用户破坏AUP可能是这一工作的重点，但是P2P软件也涉
在上一小节中，我们重点介绍了跟踪VPN登录的必要性，但是VPN的使用情况也应
最常成为多种NIDS、NIPS 或者WAF警报源的内部系统：最有用的报告之一是跟踪
使用许多不同协议/端口的内部系统：虽然没有可靠的方法能够知道来自合法内部系
跟踪从Web进人环境的文件也很重要，可以通过跟踪不同协议和方法的文件来完成。
按照内容类型（exe、dll、scr、upx等）和协议（HTTP、IM等）分类的所有文件下载：
向外部网站上传Web文件：根据代理日志，人们可以跟踪被上传到外部网站的文件，
权限的用户）的方法。
跟踪从你的网络连接到外界的用户，是检测入侵和破坏以及恶意软件（还有滥用网络
的出站连接：对环境中的出站连接的信息有多种切片方式，但是主要的精华都一样：
网络活动报告
及意外和恶意的数据窃取和丢失。
该跟踪，以便找出VPN访问和流量中的异常状况。
按照用户名称、会话总字节数、会话计数、内部资源使用量分类的VPN网络活动：