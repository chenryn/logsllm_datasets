title:TrueClick: automatically distinguishing trick banners from genuine
download links
author:Sevtap Duman and
Kaan Onarlioglu and
Ali Osman Ulusoy and
William K. Robertson and
Engin Kirda
TrueClick: Automatically Distinguishing Trick Banners
from Genuine Download Links
Sevtap Duman
Northeastern University
Boston, MA
PI:EMAIL
Kaan Onarlioglu
Northeastern University
Boston, MA
PI:EMAIL
Ali Osman Ulusoy
Brown University
Providence, RI
PI:EMAIL
William Robertson
Northeastern University
Boston, MA
PI:EMAIL
Engin Kirda
Northeastern University
Boston, MA
PI:EMAIL
Abstract
The ubiquity of Internet advertising has made it a popular
target for attackers. One well-known instance of these at-
tacks is the widespread use of trick banners that use social
engineering techniques to lure victims into clicking on de-
ceptive fake links, potentially leading to a malicious domain
or malware. A recent and pervasive trend by attackers is
to imitate the “download” or “play” buttons in popular ﬁle
sharing sites (e.g., one-click hosters, video-streaming sites,
bittorrent sites) in an attempt to trick users into clicking on
these fake banners instead of the genuine link.
In this paper, we explore the problem of automatically
assisting Internet users in detecting malicious trick banners
and helping them identify the correct link. We present a
set of features to characterize trick banners based on their
visual properties such as image size, color, placement on
the enclosing webpage, whether they contain animation ef-
fects, and whether they consistently appear with the same
visual properties on consecutive loads of the same webpage.
We have implemented a tool called TrueClick, which uses
image processing and machine learning techniques to build
a classiﬁer based on these features to automatically detect
the trick banners on a webpage. Our approach automati-
cally classiﬁes trick banners, and requires no manual eﬀort
to compile blacklists as current approaches do. Our exper-
iments show that TrueClick results in a 3.55 factor im-
provement in correct link selection in the absence of other
ad blocking software, and that it can detect trick banners
missed by a popular ad detection tool, Adblock Plus.
1.
INTRODUCTION
Internet advertising, both in traditional forms such as web
banners and email campaigns, and more recent social media
and mobile marketing schemes, is a rapidly growing, lucra-
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are not
made or distributed for proﬁt or commercial advantage and that copies bear
this notice and the full citation on the ﬁrst page. Copyrights for components
of this work owned by others than ACM must be honored. Abstracting with
credit is permitted. To copy otherwise, or republish, to post on servers or to
redistribute to lists, requires prior speciﬁc permission and/or a fee. Request
permissions from Permissions@acm.org.
ACSAC ’14, December 08 – 12 2014, New Orleans, LA, USA
Copyright 2014 ACM 978-1-4503-3005-3/14/12 ...$15.00
http://dx.doi.org/10.1145/2664243.2664279
tive business [27]. Publishers and application developers ﬁnd
it increasingly easy to integrate advertising into their content
and, consequently, attackers have leveraged this channel as
an eﬃcient mechanism for distributing malware. Naturally,
the computer security community has shown an increasing
interest in this ﬁeld as well. Researchers have produced a
large body of work to address critical security issues sur-
rounding Internet advertising, such as sandboxing of adver-
tisements from the actual content, resolving user privacy
concerns, and preventing ad fraud.
While the security community has primarily focused on
ﬁnding solutions to the technical side of the problems around
Internet advertising so far, the human factor in Internet ad-
vertising and the class of attacks that attempt to exploit an
Internet user’s perception have largely been left unexplored.
One well-known instance of such an attack is the widespread
use of trick banners [32]. Trick banners are advertisement
banners that are crafted to deceive and mislead users into
clicking on them, potentially linking to a malicious domain
or a malware executable. While trick banners have tradi-
tionally come in the form of colorful and animated messages,
or as pop-ups imitating application messages, a more recent
and pervasive trend is to imitate the “download” or “play”
buttons in popular ﬁle sharing sites (e.g., one-click hosters,
video-streaming sites, bittorrent sites) in an attempt to trick
users into clicking on these fake banners instead of the gen-
uine download link.
Previous work has explored user behavior and security
awareness when browsing the Internet, and shown that trick
banners found in ﬁle sharing sites are eﬀective at tricking
even technically sophisticated users who had previous famil-
iarity with ﬁle sharing sites used in the study [37]. This
study concluded that trick banners pose a signiﬁcant secu-
rity risk to ordinary Internet users, and even to those with
a heightened security awareness. Indeed, abuse of advertise-
ment banners in this way (a practice that is also referred
to as “malvertising”) has been recognized as a current and
eﬀective attack vector [42, 45]. It has also been shown that
rather than using complex exploitation techniques, simply
buying ad space is an easy and eﬀective way for attackers
to spread malware and quickly victimize a large number of
Internet users [18]. Numerous attacks on high-proﬁle web-
sites and ad networks in recent years demonstrate that the
problem is real and is actively being exploited [36, 50].
In this paper, we explore the problem of automatically
(cid:23)(cid:24)(cid:25)
assisting Internet users in successfully detecting malicious
trick banners, focusing on distinguishing fake download but-
tons ubiquitously found in popular ﬁle sharing websites from
genuine download links. We ﬁrst identify a set of features
to characterize trick banners based on their visual proper-
ties such as banner size, color, placement on the webpage,
whether they contain animation eﬀects, and whether they
consistently appear with the same visual properties on mul-
tiple copies of the same webpage obtained with separate
requests. We then leverage these features in an approach
combining image processing and machine learning to auto-
matically detect trick banners on a webpage.
We implement our system in a prototype Firefox browser
extension called TrueClick, evaluate its eﬀectiveness on a
data set of 259 banners collected from 88 ﬁle sharing web-
sites, and demonstrate that TrueClick achieves a 96.97%
true positive rate given a false positive rate of 3.03%. Note
that unlike state-of-the-art ad blocking, our approach does
not require a priori blacklisting of advertising domains, or
any other manual classiﬁcation of known banners. After
an initial training phase, it operates in a completely auto-
mated manner by analyzing the visual properties of banners.
In other words, the approach we propose is complementary
to existing blacklisting approaches, and can support them
in identifying previously unknown trick banners. Moreover,
TrueClick does not rely on examination of the source code
of webpages or the structure of the DOM tree. Instead, it
utilizes image processing techniques to capture and analyze
webpages as the user sees them, and therefore is not aﬀected
by attempts to thwart detection through dynamic modiﬁca-
tions to the page.
In summary, we make the following contributions in this
work.
• We present ﬁve visual features that can be used to
characterize trick banners and experimentally demon-
strate that these features can be used in practice to
distinguish trick banners from genuine download links.
• We present a novel methodology for automatically and
reliably distinguishing trick banners from genuine down-
load links by using a combination of image processing
and machine learning.
• We describe a prototype implementation of our solu-
tion as a Firefox browser extension called TrueClick
that can eﬀectively guide users toward ﬁnding and
clicking on the genuine download link in a ﬁle shar-
ing website littered with trick banners.
• We evaluate the usability of TrueClick with a user-
study, and demonstrate a 3.55 factor improvement in
selection of benign links in the presence of trick ban-
ners. We also show that TrueClick is able to detect
trick banners missed by a popular ad detection tool,
Adblock Plus.
2. PROBLEM STATEMENT
A trick banner is generally deﬁned as any Internet adver-
tising banner with a deceptive visual appearance, crafted to
lure users into clicking on them [32]. They often do not con-
tain any indication of the identity of the advertiser or the
advertised service or product. Trick banners are known to
integrate well with the look and feel of the website they ap-
pear on, and often imitate popular applications, operating
system windows, and pop-up messages.
In this work, we focus on a speciﬁc pervasive class of
trick banners:
fake download buttons found on ﬁle shar-
ing websites, which have recently been shown to be eﬀective
at tricking even users with security expertise [37]. Figure 1
shows various examples obtained from popular ﬁle sharing
services. Note that the techniques we present in this pa-
per are suﬃciently generic to be applied to other kinds of
trick banners as well. We believe that fake download but-
tons represent an up-to-date manifestation of the more gen-
eral trick banner problem, and pose a challenging research
task because of their tight integration with the ﬁle shar-
ing sites they are displayed on. To illustrate, one of the
sample trick banners taken from The Pirate Bay (Figure 1,
lower left corner) displays identical replicas of the correct
download links (i.e., the links “GET THIS TORRENT” and
“ANONYMOUS DOWNLOAD”), making it an especially
diﬃcult trick banner to spot for an unsuspecting user.
Also note that banner design (and user interface design in
general) for attracting users and maximizing click-through
rates has been extensively studied in computer science and
other, non-technical ﬁelds [5, 8, 10]. Our use of the term
trick banner in this paper could refer to images with either
benign or malicious intent.
In other words, trick banners
we examine could be crafted with malicious intent, such as
directing a user to an attack site or downloading malware
to her computer. Or, they could simply be used as a device
for artiﬁcially inﬂating the number of visitors to a destina-
tion website, without explicit malicious intent. In this work,
we do not aim to verify whether the trick banners lead to
malicious destinations (other recent work has explored this
aspect of the problem [30]), nor do we visit the sites or down-
load the ﬁles they link to. Instead, our goal is to detect trick
banners regardless of their purpose, and distinguish them
from legitimate, genuine download links.
We divide the threat model we consider for this work into
In the ﬁrst scenario, an Internet user vis-
two scenarios.
its a ﬁle sharing website with the intention to download a
speciﬁc ﬁle. We do not make any assumptions about the
security expertise or awareness of the user. The pages on
the website can contain any number of trick banners and
regular advertisements, and one or more correct download
buttons deﬁned as the link to the content the user intends
and expects to download.
In cases where the website re-
quires the user to step through a number of diﬀerent pages
to complete the download, we take the links that lead the
user closer toward the ﬁnal download link as the correct one.
The second scenario is identical to the ﬁrst except that
the website in question does not actually contain any correct
download links. Such sites could be found on the Internet,
for example, as part of a well-known scam scheme in which a
scammer creates webpages that contain detailed descriptions
of various content despite not including any actual download
links, possibly in an attempt to trick search engines and steal
clicks from users for ad revenue.
In both of these cases, regardless of whether a correct link
exists or not, our system analyzes the webpage and deter-
mines the page regions that contain trick banners. If trick
banners are detected, they could be marked with warning
cues to alert the user or blocked entirely, depending on im-
plementation choices or user preferences.
Finally, we would like to point out that there exist other
types of attacks involving malicious modiﬁcations to web-
sites and browser user interfaces that aim to make users in-
(cid:23)(cid:24)(cid:26)
Figure 1: Four trick banner examples taken from popular ﬁle sharing sites The Pirate Bay, Rapidgator, and
FilesTube that imitate the look and feel of genuine download buttons to deceive users.
advertently click on incorrect or malicious links. For exam-
ple, various forms of clickjacking attacks compromise the vi-
sual and temporal integrity of the pointer cursor or browser’s
display to this end [24]. The problem we aim to address
in this work is separate from those attacks in that, in our
threat model, the system’s integrity is not compromised; in-
stead, trick banners exploit weaknesses in human perception
to trick users. In clickjacking attacks, the user’s system is
technically crippled, making her unable to click on the cor-
rect link even if she can identify it. However, in the attacks
we aim to address, the user willingly clicks on a trick banner,
thinking that it is a genuine download link. While defenses
against both types of attacks are necessary for secure brows-
ing, we only explore the latter problem in this work.
3. BACKGROUND & RELATED WORK
Before we explain our approach to trick banner detection,
we present related work and the state-of-the-art in this ﬁeld
in order to highlight the diﬀerences between our work and
current advertisement detection systems.
Internet Advertising and Trick Banners. There is
a large body of prior work on Internet advertising and the
technologies around it, both in computer science and other
non-technical ﬁelds. The eﬀectiveness of various types of ad
banners and ways to inﬂuence user click-through behavior
have been studied widely in marketing, ﬁnance, psychology,
and related ﬁelds [8, 12].
In a recent work, Onarlioglu et
al. [37] presented a study that investigates the computer
security implications of trick banners, and showed that trick
banners can mislead even technically sophisticated Internet
users and expose them to attacks.
Advertisement Blocking and Filtering. A simple
method of blocking trick banners, and advertisements in