### 物联网安全 - 侧信道攻击实战
**演讲人：KEVIN2600**
2019
@Kevin2600

#### 议程
- 侧信道攻击概述
- 侧信道攻击案例分析
- 侧信道功率分析

### 侧信道攻击概述
侧信道攻击是一种针对软件或硬件设计缺陷的非传统攻击方式。这类攻击通常通过被动监听或隐蔽数据信号传输来实现，其攻击点不在于暴力破解，而是利用功耗、时序和电磁泄漏等手段达到目的。即使在物理隔离的环境中，侧信道攻击也有可能取得成功。

### 侧信道防护措施
- 公钥签名验证
- 加固Bootloader（例如设置bootdelay = 0）
- 屏蔽调试端口（如UART、JTAG、SPI、I2C）
- 实施物理隔离（Air Gapping）

### 侧信道攻击案例分析
#### 被动式攻击
- **声波信号采集**：通过收集打印机发出的声音信号，还原打印内容。
- **电磁波监听 (TEMPEST)**：美国国家安全局使用电磁波监听技术进行信息窃取。
- **功耗分析**：通过分析功耗模式破解韩国公交卡的3DES密钥系统。
- **智能灯系统密钥获取**：利用功耗分析获取Philips Hue智能灯系统的AES密钥。

#### 主动式攻击
- **Xbox360 Glitch 攻击**：通过注入毛刺使设备运行未签名代码。
- **智能网关Hue NAND Glitch**：通过NAND闪存故障攻击获得Root权限。
- **硬件钱包Trezor**：通过毛刺注入获取敏感信息。
- **USBee**：以色列本古里安大学通过USB发送电磁信号实施攻击。

### 侧信道攻击案例简析
#### 时序分析
物联网设备网关（WinkHub）通过网页访问（set_dev_value.php）：
```bash
curl "192.168.01/set_dev_value.php" -d "nodeId=a&attrId=; uname -a;"
```

#### NAND-Glitch
- **NAND Flash**：通常存储固件、Bootloader、内核及根文件。
- **攻击方法**：在系统启动并读取NAND内核信息的瞬间，短接I/O引脚，阻止Bootloader正确读取内核数据，从而进入Shell模式。

### 侧信道功率分析
#### 功率分析
- **简单功率分析 (SPA) 和差分功率分析 (DPA)**：处理器执行不同指令时，功耗需求不同。
- **加密算法**：需要了解目标设备采用的加密算法。
- **信号采集**：必须在加密或解密过程中完成。

#### ChipWhisperer
- **简介**：由Colin O'Flynn设计，用于学习SCA功耗分析和毛刺注入。
- **特点**：基于Python的跨平台开源软硬件项目（支持Windows、Linux、MacOS）。
- **应用**：可用于时序或电压毛刺注入攻击测试，产生无限循环；寻找目标设备在特定时刻（加密/解密）的功耗差异。

#### 功率分析 (SPA)
#### 功率分析 (DPA)
- **目标设备**：测量方法与结果
- **AES-128**：具体案例分析

#### 电磁信号分析
- **电磁波**：可通过H探头和软件无线电设备远程获取。
- **密钥指纹**：芯片在0-1转换过程中产生的电磁波可能包含密钥信息。
- **GnuPG密钥**：特拉维夫大学研究人员通过测量分析电磁发射获取密钥信息。

### One More Thing...
#### 侧信道EMFI
- **电磁场干扰 (EMFI)**：详细介绍

### 总结
- 完全安全的系统不存在。
- 侧信道分析与防御是硬件安全的重要技能。
- 即使设计完美，在实施过程中也可能出现漏洞，导致系统崩溃。

谢谢观看！

**演讲人：KEVIN2600**