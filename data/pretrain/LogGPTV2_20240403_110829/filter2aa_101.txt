IOT安全 - 测信道实战
演讲人：KEVIN2600
2019
@Kevin2600
议程
. 测信道的那点事
. 测信道案例简析
. 测信道 Power Analysis
测信道的那点事
测信道攻击是一种针对软件或硬件设计缺陷, 剑走偏锋的攻击方式
攻击途径通常采用被动式监听, 或通过特殊渠道发送隐蔽数据信号
攻击点不在暴力破解, 而是通过功耗; 时序; 电磁泄漏等方式达到
破 解 目 的 .  在 很 多 物 理 隔 绝 的 环 境 中 , 往 往 也 能 出 奇 制 胜
测信道
测信道
. Public key signature check
. Bootloader 加固 (bootdelay = 0)
. 屏蔽调试端口 UART; JTAG; SPI; I2C  
. 电子设备全部物理隔离 (Air Gapping)
测信道 WordPress
测信道 Drupal
测信道门禁 
测信道门禁 
被动式:
: 声波信号采集还原打印机原文
: 美国 NSA 电磁波监听 (TEMPEST)  
: 功耗分析破解南韩公交卡密钥系统 (3DES)
: 功耗分析获取 Philipe Hue 智能灯系统密钥 (AES)
主动式:
: Xbox360 Glitch 攻击 (运行 unsigned code)
: 智能网关 Hue NAND Glitch (得到 Root 权限)
: 通过毛刺注入成功获取硬件钱包 Trezor 闪存敏感信息
: 以色列 Ben-Gurion 大学通过 USB 发送电磁信号 (USBee)
测信道案例简析
时耗分析
时耗分析
NAND-Glitch
NAND-Glitch
物联网设备网关 (WinkHub)
通过网页对其进行访问 (set_dev_value.php)
curl “192.168.01/set_dev_value.php” -d “nodeId=a&attrId=; uname -a;”
NAND-Glitch
. NAND Flash 通常存储固件; Bootloader; 内核以及root files
. 使用数据线在系统启动, 读取 NAND 内核信息瞬间, 短接 I/O pin 
. 在正确的时间点, 阻止 Bootloader 读取正确的内核数据从而进入
  shell 模式
NAND-Glitch
测信道 Power Analysis
功耗分析
. Power analysis (Simple & Differential)
. 处理器运行不同指令在功耗需求上也不近相同
. 需要了解目标设备所采用的加密算法
. 信号的采集必须在加密或解密的过程中完成
功耗分析
功耗分析 (ChipWhisperer)
. Colin O'Flynn 设计制作, 学习 SCA 功耗分析和毛刺注入神器
. 基于Python 跨平台开源软硬件项目 (Windows; Linux; MacOS)
. 可用于时序或电压毛刺注入攻击测试, 产生 无限循环)
. 寻找目标设备在特定时刻 (加密/解密) 功耗图形的差异
功耗分析 (SPA)
功耗分析 (DPA)
目标设备
测量方法
测量结果
功耗分析 (DPA)
功耗分析 (DPA)
功耗分析 (AES-128)
功耗分析 (DPA)
功耗分析 (电磁信号)
. 电磁波可通过 H 探头和软件无线电设备远程获取
. 芯片01转换产生电磁波从空气中泄漏, 其中包含密
  钥指纹信息
. Tel Aviv 大学科研人员通过测量分析电磁发射获取 
  GnuPG 密钥信息
功耗分析 (电磁信号)
功耗分析 (DPA)
One More Thing ..
测信道 EMFI
测信道 EMFI
测信道 EMFI
测信道 EMFI
测信道 EMFI
Summary
百分百安全的系统并不存在
边信道分析与防御, 硬件安全必备技能
完美的设计, 实施过程中百密⼀疏, 将导致系统完全崩溃
谢谢观看
演讲人：KEVIN2600