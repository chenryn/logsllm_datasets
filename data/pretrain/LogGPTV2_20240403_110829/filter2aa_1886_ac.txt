Acosta Gestion S.L.
Esteban Acosta
Calle Dr. Madrid 1
Madrid, Madrid 28220
ES
011916340101
PI:EMAIL
Domain created on 21-May-2001
Domain expires on 21-May-2003
Last updated on 29-Apr-2002
Domain servers in listed order:
DNS.COMTENIDOS.COM           62.37.225.56
DNS2.COMTENIDOS.COM          62.37.225.57
Extreme Backtrace
Still no answer?
Identify responsible AS
Lookup IP in BGP route tables to identify which 
Autonomous System is responsible for the route.   Then, 
identify the responsible domain by doing recursive 
Whois AS lookups.
Still no answer?
The Quality of AS data
Advanced Backtrace
The Quality of AS data contd…
Advanced Backtrace
Advanced Backtrace
The Quality of AS data contd…
Netbios enabled?
See if IP has Netbios enabled and can receive a 
Winpopup message
Example (From DOS)
C:\> nbtstat -A 24.24.24.24
If you get a response, then:
C:\> net send 24.24.24.24 "FYI, You've been 
hacked, .... instructions ..."
Still no answer?
Netbios Backtrace
D:\gdtest>nbtstat -A 208.254.151.185
Local Area Connection:
Node IpAddress: [172.16.1.169] Scope Id: []
NetBIOS Remote Machine Name Table
Name               Type         Status
---------------------------------------------
HLM              UNIQUE      Registered
ADDUCCI_DORF     GROUP       Registered
HLM              UNIQUE      Registered
HLM              UNIQUE      Registered
ADDUCCI_DORF     GROUP       Registered
MAC Address = 00-50-8B-6A-32-63
Still no answer?
Netbios Backtrace Contd…
D:\>tracert 208.254.151.185
Tracing route to HLM [208.254.151.185]
over a maximum of 30 hops:
1    10 ms    set type=mx
> intercompro.net
*** No mail exchange (MX) records available for intercompro.net
> set type=a
> intercompro.net
*** No address (A) records available for intercompro.net
>
Get as close as possible contd…
Tracing route to 62.220.111.241 over a maximum of 30 hops
1   <10 ms   <10 ms    10 ms  host121.mynetwatchman.com [64.238.113.121]
2   <10 ms   <10 ms    10 ms  172.16.41.165
3   <10 ms    10 ms   <10 ms  car00-s6-0-1.atlagabu.cbeyond.net [192.168.14.17]
4   <10 ms    10 ms   <10 ms  bgr00-g2-0.atlagabu.cbeyond.net [192.168.18.49]
5   <10 ms    10 ms   <10 ms  s1-0-0.ar1.ATL1.gblx.net [64.211.166.201]
6   <10 ms    10 ms    10 ms  pos2-0-155M.cr2.ATL1.gblx.net [206.132.115.121]
7    30 ms    30 ms    20 ms  pos1-0-622M.cr2.NYC2.gblx.net [206.132.249.170]
8    20 ms    30 ms    20 ms  pos1-0-2488M.br2.NYC2.gblx.net [208.48.234.214]
9    20 ms    30 ms    20 ms  ftna.br2.NYC2.gblx.net [208.51.134.22]
10    20 ms    30 ms    20 ms  P10-0.NYKCR3.NY.opentransit.net [193.251.241.245]
11    20 ms    30 ms    20 ms  P11-0.NYKCR2.NY.opentransit.net [193.251.241.217]
12   100 ms   101 ms   100 ms  P4-0.PASCR1.Pstrl.opentransit.net [193.251.241.133]
13   100 ms   100 ms   110 ms  P3-0.PASCR3.Pstrl.opentransit.net [193.251.241.126]
14   100 ms   100 ms   110 ms  P9-0.PASBB1.Pstrl.opentransit.net [193.251.241.161]
15   101 ms   100 ms   110 ms  P8-0-0.PASAR1.Pstrl.opentransit.net [193.251.128.70]
16   100 ms   100 ms   101 ms  GlobeCastSerte.GW.opentransit.net [193.251.248.122]
17   100 ms   100 ms   100 ms  10.30.0.14
18   621 ms   631 ms   621 ms  62.220.96.125
19   631 ms   631 ms   621 ms  62.220.96.2
20   631 ms   620 ms   631 ms  62.220.100.7
21   621 ms   621 ms   621 ms  62.220.101.131
22   621 ms   631 ms   621 ms  62.220.111.241
Trace complete.
Get as close as possible contd…
% This is the RIPE Whois server.
% The objects are in RPSL format.
% Please visit http://www.ripe.net/rpsl for more information.
% Rights restricted by copyright.
% See http://www.ripe.net/ripencc/pub-services/db/copyright.html
inetnum:      62.220.96.0 - 62.220.107.255
netname:      TAKTA-NET
descr:        Takta Co. Access Service Provider
country:      IR
admin-c:      TR47-RIPE
tech-c:       TR47-RIPE
status:       ASSIGNED PA
mnt-by:       TKT-MNT
mnt-lower:    TKT-MNT
mnt-routes:   TKT-MNT
changed:      PI:EMAIL 20011025
source:       RIPE
route:        62.220.96.0/19
descr:        Takta-Net
origin:       AS21341
mnt-by:       TKT-MNT
changed:      PI:EMAIL 20020107
source:       RIPE
Get as close as possible contd…
Conclusion
Are the calls coming 
from inside the house?
Unless you do Backtracing, you will never know the true 
source of an attack... or whether a packet was spoofed?  
However, even backtracing can't solve incorrect, non-
existent, or just plain stale data present in some of the 
databases.
Conclusion
You do read your logs, right?
If not, consider having a service do it for you 
automatically, or use your own open-source 
tools to do it.
• http://www.mynetwatchman.com
• http://www.dshield.org
• Swatch
• Logsentry
Conclusion
References
“Avoiding future denial-of-service attacks” by Denise Pappalardo. 
Posted on CNN.com February 23, 2000
http://www.cnn.com/2000/TECH/computing/02/23/isp.block.idg/index.html
Gan.ru.  The Nuclear Regulatory Agency in Russia.
http://www.gan.ru
http://www.mynetwatchman.com/LID.asp?IID=4875813
RFC 1812
http://www.faqs.org/rfcs/rfc1812.html
RFC 1918
http://www.faqs.org/rfcs/rfc1918.html
Solution to the Korean Spam Problem Example
http://www.merit.edu/mail.archives/nanog/2002-04/msg00029.html
http://www.merit.edu/mail.archives/nanog/2002-04/msg00044.html
“A Weakness in the 4.2BSD Unix† TCP/IP Software” by Robert T. Morris
http://www.pdos.lcs.mit.edu/rtm/papers/117.pdf
“NMAP: Decoy Analysis” by Max Vision
http://www.whitehats.com/library/nmap/index.html
Default TTL values.   
http://www.switch.ch/docs/ttl_default.html.
http://216.239.35.100/search?q=cache:ybcsLpJuwS0C:www.switch.ch/docs/ttl_default.html+NT+Default+TTL&hl=en&ie=UTF-8
References - Page 1
Traceroute Hop Count Difficulties Example
http://www.merit.edu/mail.archives/nanog/2000-12/msg00143.html
Looking Glass Sites
http://lg.above.net/
http://nitrous.digex.net/cgi-bin/looking_glass.pl
Spoofed IP Example
http://www.mynetwatchman.com/LID.asp?IID=5415491
Nslookup Example
http://www.mynetwatchman.com/LID.asp?IID=5942546
Nice contact info here… Example
http://www.mynetwatchman.com/LID.asp?IID=5412503
Regional NICs
http://www.arin.net
http://www.apnic.net
http://www.ripe.net
Geektools whois proxy.
http://www.geektools.com
Operational ICANN Accredited Domain Registrars
http://www.internic.net/alpha.html
References - Page 2
“NeuStar Response to SB1335- 01-Q- 0740”
http://www.ntia.doc.gov/ntiahome/domainname/usca/cafiles/SectionE.pdf
Abuse Net
http://www.abuse.net
Rwhois
http://www.rwhois.net/
Success with RR Example
http://www.mynetwatchman.com/LID.asp?IID=4171992
Gone Too Far? Example
http://www.mynetwatchman.com/LID.asp?IID=4162328
Netbios Backtrace Example
http://www.mynetwatchman.com/LID.asp?IID=6024235
Distributed IDSs
http://www.myNetWatchman.com
http://www.dshield.org
References - Page 3
Appendix A:
ISP Anti-spoof 
Techniques
Ingress Filtering
“If an ISP is aggregating routing 
announcements for multiple downstream 
networks, strict traffic filtering should be 
used to prohibit traffic which claims to have 
originated from outside of these aggregated 
announcements.”
RFC2267 - Network Ingress Filtering: Defeating Denial of Service 
Attacks which employ IP Source Address Spoofing
ISP Anti-Spoof Techniques
Input Debugging
Input Debugging allows an operator to filter particular 
packets on some egress port and determine which 
ingress port they arrived on. This reveals which 
upstream router originated the traffic.
The process is repeated recursively until the the ISP‟s 
border is reached.  From there, the upstream ISP must 
be contacted to continue the trace.
ISP Anti-Spoof Techniques
Backscatter
ISP Anti-Spoof Techniques
Backscatter Technique - “BGP implementations on 
Cisco and Juniper routers (possibly others) allow you to 
arbitrarily set the 'next-hop' to any IP address. This quirk 
can be used to your benefit when tracking spoofed traffic.  
By setting particular prefixes to a known and specially 
handled 'next-hop', we can get some unique traffic 
tracking information off the network.”