before beaming Alice the inappropriate content in the
ﬁrst place, Bob could scan his nearby community, ﬁnd
a nearby Zune named CharlieZune, and then name his
Zune CharlieZune. If Bob sends inappropriate content to
Alice and then turns off his wireless, he might trick Alice
into blocking the real CharlieZune.
Fake MAC addresses. Upon further investigation, we
ﬁnd that the Zune neighbor discovery process and block-
ing mechanism is based on 802.11 probe-responses and
MAC addresses. Bob could therefore use a Linux laptop
to fool Alice into thinking that she has blocked BobZune
when in fact she has not; unlike the observation in the
previous paragraph, our attack here works even when
there are no other nearby Zunes.
Building on the scenario above, where Bob sends in-
appropriate content to Alice, disables his Zune’s wire-
less, and changes his Zune’s name. Suppose Alice does
not like the content she received from Bob and navigates
to the nearby list on her Zune. Bob can use his laptop
to send out Zune 802.11 probe-responses with the same
USENIX Association
16th USENIX Security Symposium
67
name that his Zune was using but with a different MAC
address. Alice will then see the previous name of Bob’s
Zune in her nearby list and select the block command.
It will now appear to Alice that she has blocked Bob’s
Zune. Conversely, what has actually occurred is Alice
has blocked a different MAC address. The next time Bob
enables his Zune’s wireless and attempts to send inappro-
priate content to Alice, it will appear to Alice that Bob
is sending content from a third BobZune that Alice has
never seen before. We have implemented a C application
for Linux that uses the MadWiFi drivers and an Atheros
Chipset-based wireless card to listen to 802.11 probe-
requests from Zunes and send a Zune probe-response
with whatever name and MAC address the user desires.
Post-blocking privacy. Lastly, even when the blocking
mechanism is used successfully, it only stops Alice from
receiving new content pushes from BobZune; the mali-
cious user, Bob, can still detect Alice’s presence unless
she turns off her Zune’s wireless capability all together;
this has the negative side effect of preventing Alice from
sharing any media at all if she doesn’t want to be de-
tectable by Bob.
4.3 Improving User Control
Perhaps the most natural method for protecting against
such unsolicited content is to adopt what is now common
practice in other social applications, such as instant mes-
saging: create a “buddy list” and only accept connections
from known buddies. One might populate the buddy list
using some interactions that require two Zunes to be in
close proximity [2]. Such a buddy list is, however, in di-
rect conﬂict with the Zune’s intended goal of initiating
ad hoc interactions with total strangers.
Therefore, the goal is to improve the resistance of
the Zune blocking mechanisms to attacks like those we
present above. One simple solution to Bob’s blocking
circumvention is to record which Zune sent the speciﬁc
media and allow the user to block the sender of media
even if they are not currently nearby and active. We note,
however, that there are some subtleties that one must
consider. For example, since the Zune blocking mech-
anism described above seems to be based on the Zune’s
MAC address (recall that our C program in Section 4.2
created 802.11 probe-responses with forged MAC ad-
dresses to trick the Zune blocking feature) Bob might
still be able to circumvent this improved blocking mech-
anism by mounting a MAC-rewriting man-in-the-middle
attack between his Zune and Alice’s. Since the Zune’s
communicate using encryption, MAC rewriting of this
form will not, however, be successful if the Zunes’ MAC
addresses are used as input to the encryption key deriva-
tion process. We have currently not successfully deter-
mined whether or not this is actually the case, but argue
below that the use of MAC addresses for this purpose is
fundamentally problematic if one also wishes to protect
information about a user’s presence to outsiders (recall
Section 3).
4.4 Challenges
While there has been signiﬁcant research on providing
control over private information in social networks in
ubiquitous social applications, much of the work fo-
cuses on situations with hierarchical or other complex
relationships, such as boss/spouse/friend or buddies/non-
buddies [22]. While there is still much work to be done in
this space, the Zunes suggest another scenario in which a
key target application is to share content with strangers.
Blocking individuals in such a scenario can be very chal-
lenging when users have complete control over the infor-
mation that their devices present to others.
When all the devices are homogeneous and incorpo-
rate a secure hardware module, one possibility is to let
that secure hardware control what information is shared
with the user and other devices, and to ensure that some
information (such as a unique identiﬁer) is not mutable
by the user. The secure hardware might then use this non-
mutable information to control blocking. Coupled with
the discussion in Section 3, one must ensure that these
unique identiﬁers do not reveal private information about
a user’s presence. For example, this unique identiﬁer
should not be an 802.11 MAC address, which the Zunes
currently appear to use for blocking purposes. While
there might be approaches for addressing this problem in
the case of homogeneous devices with secure hardware
from the same manufacturer (e.g., restricted behavior on
the secure hardware and symmetric key agreement using
the exchange of anonymous public keys [3] signed using
a group signature scheme [9]), solving this problem in
the case of a heterogeneous environment appears to be a
challenge.
5 Conclusions
We technically explore privacy and security properties
of several commercial UbiComp products. We ﬁnd that
despite research and public awareness, these products do
not provide strong levels of privacy protection and do not
put the user in control of their private information.
Our analysis of the encrypted SlingBox stream sug-
gests that transmission characteristics from variable data
rate encoding can cause information leakage even when
such a stream is encrypted. This puts users privacy at
risk because one might assume encryption is enough to
thwart an eavesdropper from learning what media one is
watching. Our ﬁrst attempt at recognizing movies via
their variable throughput in a 26 movie database yielded
68
16th USENIX Security Symposium
USENIX Association
an overall accuracy of approximately 62% for the best
match and 73% for ranking in the top 5 matches when
a 10 minute query trace was used, and 77% and 89% re-
spectively when a 40 minute query trace was used; which
compared with the 4% and 21% respectively that one
can expect with random guessing, shows much informa-
tion leakage. For certain movies our accuracy rates are
signiﬁcantly higher; for example, for 15 out of our 26
movies, a 40-minute query trace will match with the cor-
rect movie over 98% of the time. When a variable data
rate encoding is used, a content provider could poten-
tially increase this accuracy by using a throughput-based
watermarking scheme.
Persistent identiﬁers in the Nike+iPod Sport Kit and
Zune potentially reveal presence and, in the Nike+iPod
case, we demonstrate how a tracking system can be built
using the Nike+iPod Sport Kit sensors and receivers. We
argue that these persistent identiﬁers should not be used
in future devices and should instead be replaced with
other privacy preserving mechanisms.
Finally, our evaluation of the Zune blocking scheme
shows that an interface design choice coupled with a
technology choice can take control away from the con-
sumer and put it in the hands of malicious users. To-
gether, the results from this paper demonstrate with new
classes of devices come new privacy and security chal-
lenges; privacy must be designed in at all levels of the
protocol stack.
Acknowledgments
We thank Yaw Anokwa, Kate Everitt, Kevin Fu, J.
Alex Halderman, Karl Koscher, Ed Lazowska, David
Molnar, Fabian Monrose, Lincoln Ritter, Avi Rubin,
Jason Schultz, Adam Stubbleﬁeld, Dan Wallach, and
David Wetherall. S. Agarwal was funded by NSF EIA-
0321235, University of Washington Animation Research
Labs, Washington Research Foundation, Adobe and Mi-
crosoft. T. Kohno thanks Cisco Systems Inc. for a gift
supporting his research on information leakage and the
interactions between compression and encryption.
References
[1] Apple ‘It’s Showtime!’
event – live coverage.
http://www.macworld.com/news/2006/
09/12/showtime/index.php.
[2] D. Balfanz, G. Durfee, R. Grinter, D. Smetters, and
P. Stewart. Network-in-a-Box: How to set up a secure
wireless network in under a minute. In 13th USENIX Se-
curity Symposium, 2004.
2248 of Lecture Notes in Computer Science, pages 566–
582. Springer-Verlag, Dec. 2001.
[4] M. Bellare, A. Desai, E. Jokipii, and P. Rogaway. A con-
crete security treatment of symmetric encryption. In Pro-
ceedings of the 38th Annual Symposium on Foundations
of Computer Science, pages 394–403. IEEE Computer
Society Press, 1997.
[5] A. Beresford and F. Stajano. Location privacy in perva-
sive computing. In IEEE Pervasive Computing, January
2003.
[6] BlueTags
to install world’s ﬁrst Bluetooth track-
ing system, 2003. http://www.geekzone.co.nz/
content.asp?contentid=1070.
[7] Bluetooth
Spam in
http:
//it.slashdot.org/it/07/01/28/2114253.
shtml.
Public
Places.
[8] Braces – A Bluetooth Tracking Utility. http://
braces.shmoo.com/.
[9] D. Chaum and E. van Heyst. Group signatures. In D. W.
Davies, editor, Advances in Cryptology – EUROCRYPT
’91, volume 547 of Lecture Notes in Computer Science,
pages 257–265, 1991.
[10] J. Collins.
Lost and Found in Legoland, RFID
Journal, 2004. http://www.rfidjournal.com/
article/articleview/921/1/1/.
[11] J. Cornwell, I. Fette, G. Hsieh, M. Prabaker, J. Rao,
K. Tang, K. Vaniea, L. Bauer, L. Cranor, J. Hong,
B. McLaren, M. Reiter, and N. Sadeh. User-controllable
security and privacy for pervsaive computing. In 8th IEEE
Workshop on Mobile Computing Systems and Applica-
tions (HotMobile 2007), 2007.
[12] Y. Duan and J. Canny. Protecting user data in ubiquitous
computing environments: Towards trustworthy environ-
ments. In Workshop on Privacy Enhancing Technology,
2004.
[13] C. Faloutsos, M. Ranganathan, and Y. Manolopoulos.
Fast subsequence matching in time-series databases.
ACM SIGMOD Record, 23(2):419–429, 1994.
[14] FT2232C Dual USB UARF/FIFO IC. http://www.
ftdichip.com/Products/FT2232C.htm.
[15] M. Gruteser and D. Grunwald. A methodological assess-
ment of location privacy risks in wireless hotspot net-
works. In First International Conference on Security in
Pervasive Computing, 2003.
[16] M. Gruteser and D. Grunwald. Enhancing location pri-
vacy in wireless LAN through disposable interface iden-
tiﬁers: A quantitative analysis. In ACM Mobile Networks
and Applications (MONET), volume 10, pages 315–325,
Hingham, MA, USA, 2005. Kluwer Academic Publish-
ers.
[3] M. Bellare, A. Boldyreva, A. Desai, and D. Pointcheval.
Key-privacy in public-key encryption. In C. Boyd, edi-
tor, Advances in Cryptology – ASIACRYPT 2001, volume
[17] M. Haase and M. Handy. BlueTrack – Imperceptible
In Ubicomp Poster Pro-
tracking of bluetooth devices.
ceedings, 2004.
USENIX Association
16th USENIX Security Symposium
69
[18] T. Hastie, R. Tibshirani, J. Friedman, et al. The elements
of statistical learning: data mining, inference, and pre-
diction. Springer, 2001.
[34] G. Myles, A. Friday, and N. Davies. Preserving privacy in
environments with location-based applications. In IEEE
Pervasive Computing, 2003.
[19] J. I. Hong and J. A. Landay. An architecture for privacy-
sensitive ubiquitous computing. In Second International
Conference on Mobile Systems, Applications, and Ser-
vices (Mobisys 2004), 2004.
[35] Nike and Apple Lanch Nike+iPod Sport Kit (for real).
http://www.engadget.com/2006/07/13/
nike-and-apple-launch-nike-ipod-sport-
kit-for-real/.
[36] Nike + iPod Frequently Asked Questions (Technical).
http://docs.info.apple.com/article.
html?artnum=303934. Last accessed on November
12, 2006.
[37] E. O’Neill, V. Kostakos, T. Kindberg, A. F. gen. Schieck,
A. Penn, D. S. Fraser, and T. Jones.
Instrumenting the
city: Developing methods for observing and understand-
ing the digital cityscape. In Ubicomp, 2006.
[38] S. Orfanidis.
Introduction to Signal Processing. Ingle-
wood Cliffs. NJ: Prentice-Hall, 1996.
[39] M. Pels,
J. Barhorst, M. Michels, R. Hobo, and
J. Barendse. Tracking people using bluetooth:
Impli-
cations of enabling bluetooth discoverable mode, 2005.
Manuscript.
[40] Sling Media Announces
SlingCatcher.
http:
//us.slingmedia.com/object/io_
1168286861787.html.
[41] Sling Media’s Newly-Released SlingBox Uses Microsoft
Windows Media and Texas Instruments Digital Me-
dia Technology to Deliver On-the-Go Entertainment.
http://us.slingmedia.com/object/io_
1157566629962.html.
[42] S. A. Weis, S. E. Sarma, R. L. Rivest, and D. W. En-
gels. Security and Privacy Aspects of Low-Cost Radio
Frequency Identiﬁcation Systems. In Security in Perva-
sive Computing, 2004.
[43] WireShark. http://www.wireshark.org.
[44] F.-L. Wong and F. Stajano. Location privacy in bluetooth.
In 2nd European Workshop on Security and Privacy in Ad
hoc and Sensor Networks, 2005.
[45] C. Wright, F. Monrose, and G. Masson. On Inferring Ap-
plication Protocol Behaviors in Encrypted Network Traf-
ﬁc. In Journal of Machine Learning Research (JMLR):
Special issue on Machine Learning for Computer Secu-
rity, 2006.
[46] C. V. Wright, L. Ballard, F. Monrose, and G. M. Masson.
Language identiﬁcation of encrypted VoIP trafﬁc: Alejan-
dra y Roberto or Alice and Bob? In 16th Usenix Security
Symposium, 2007.
[20] J. I. Hong and J. A. Landay. Privacy risk models for de-
signing privacy-sensitive ubiquitous computing systems.
In Designing Interactive Systems (DIS2004), 2004.
[21] Y.-C. Hu and H. J. Wang. A framework for location
privacy in wireless networks. In ACM SIGCOMM Asia
Workshop, 2005.
[22] G. Iachello,
I. Smith, S. Consolvo, M. chen, and
G. Abowd. Developing privacy guidelines for social loca-
tion disclosure applications and services. In Symposium
on Usable Privacy and Security, 2005.
[23] iPod Connector
Female
SMD.
http://www.
sparkfun.com/commerce/product_info.
php?products_id=8035.
[24] iPod
Linux.
Connector.
http://ipodlinux.org/Dock_
[25] A. Jacobs and G. Abowd. A framework for comparing
perspectives on privacy and pervasive technologies.
In
IEEE Pervasive Computing Magazine. Volume 2, Number
4, October-December, 2003.
[26] M. Jakobsson and S. Wetzel. Security weaknesses in
bluetooth. In 2001 Conference on Topics in Cryptogra-
phy, 2001.
[27] A. Juels. RFID security and privacy: A research survey.
In IEEE Journal on Selected Areas in Communications,
2006.
[28] A. Juels and S. Weis. Authenticating pervasive devices
In 25th Annual International
with human protocols.
Cryptography Conference, August 2005.
[29] A. LaMarca, Y. Chawathe, S. Consolvo, J. Hightower,
I. Smith, J. Scott, timothy Sohn, J. Howard, J. Hughes,
F. Potter, J. Tabert, P. Powledge, G. Borriello, and
B. Schilit. Place lab: Device positioning using radio bea-
cons in the wild.
In Third International Conference on
Pervasive Computing, 2005.
[30] M. Liberatore and B. N. Levine. Inferring the Source of
Encrypted HTTP Connections. In Proc. ACM conference
on Computer and Communications Security (CCS), Octo-
ber 2006.
[31] Loca – About Loca. http://www.loca-lab.org/.
[32] Microsofts Zune Delivers Connected Music and Enter-
tainment Experience. http://www.microsoft.
com/presspass/press/2006/sep06/
09-14ZuneUnveiling%PR.mspx.
[33] D. Molnar and D. Wagner. Privacy and security in library
RFID issues, practices, and architectures. In 11th ACM
Conference on Computer and Communications Security
(CCS 2004), 2004.
70
16th USENIX Security Symposium
USENIX Association