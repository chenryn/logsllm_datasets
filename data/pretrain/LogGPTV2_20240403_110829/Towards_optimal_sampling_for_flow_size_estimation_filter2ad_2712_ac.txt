...
p2
p
pqW−2
pqW−3
p
p
 .
 .
p
pqk−j
qp
pp
0
0
...
B =
for 2  W .
Packet Sampling with SYN Sampling (PS+SYN)
First PS with parameter pp is performed as above. A post-processing
phase then discards all packets belonging to sampled ﬂows which
lack a SYN packet (or more accurately, maps them to sampled
ﬂows with j = 0). This was introduced in [1] and called “SYN-
pktct” in [4].
p d1 + 3q4
pp−2
pp−4
The chief beneﬁt of PS+SYN is that the ﬂow length bias of PS is
averted by keeping ﬂows based on the presence of the SYN, which
is ﬂow length independent. The chief disadvantage is the fact that it
is wasteful: if pp = 0.01 then 99% of packets which were initially
sampled belong to ‘failed’ ﬂows and are subsequently discarded!
A ﬂow evaporates iff its SYN is not sampled, hence b0k = qp.
For j ≥ 1 the SYN must ﬁrst be sampled, which occurs with prob-
ability pp, and conditional on this j − 1 more packets must be
sampled from the remaining k − 1 using i.i.d. sampling. Hence
bjk = pp ·
for j ≥ 1, giving
pj−1
qk−j
(cid:195)
(cid:33)
p
p
k − 1
j − 1
B =
qp
pp
0
...
0
qp
ppqp
p2
p
...
0
qp
ppq2
p
2p2
pqp
...
0
···
···
···
...
···
pqW−2
p
p
qp
ppqW−1
(W − 1)p2
...
pW
p
 .
(cid:195)
(cid:33)
p
p
0
˜B
qk−j
−1 =
p−k
p , or
k − 1
j − 1
···
···
...
···
(−1)W−1qpp−W
The inverse of ˜B is b(cid:48)
1 −qpp−1
jk = (−1)k−j
···
···
...
···
W , b0 = qp1W , and ˜B−1 ˜d =
˜B−1 = 1T
By noting that pp1T
W
(cid:126)θ, where ˜d = [d1, d2, . . . dW ]T, the expression for J−1 given in
Proposition 2.2 can be readily simpliﬁed [9] to
p−1
...
p−W +1
1
pp
...
...
0
0
p
p
p
(cid:181)
(cid:182)
−1((cid:126)θ) = ˜J
−1((cid:126)θ) −
J
1 − 1
pp
(cid:126)θ(cid:126)θT.
(14)
Packet Sampling with SYN and SEQ (PS+SYN+SEQ)
First sampling is performed according to PS+SYN with parameter
pp, and then on each resulting sampled ﬂow the sequence number
post-processing is performed as per PS+SEQ. This is called “SYN-
seq” in [4]. PS+SYN+SEQ is a hybrid of PS+SYN and PS+SEQ
and combines the advantages and disadvantages of both.
for j > 1, giving
If j = 0, 1 then sequence numbers cannot help and bjk is as for
PS+SYN. Otherwise, by combining the arguments above, it is easy
to see that bjk = pp · ppqk−j
qp
ppq2
p
p2
pqp
p2
p
...
qp
ppqW−1
pqW−2
p2
pqW−3
p2
qp
ppqp
p2
p
0
qp
pp
0
0
(15)
B =
...
...
p
p
p
p
qp
ppq3
p
pq2
p2
p
p2
pqp
...
···
···
···
···
···
...
0
...
p2
p
p d2)2
0
The inverse of ˜B is
−1 =
˜B
1
pp
0
0
1 − qp
0
0
pp
1
pp
0
...
0
...
0
0
− qp
pp
1
pp
...
0
0
0
− qp