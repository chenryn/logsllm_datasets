S
e
t
a
d
p
U
l
a
t
o
T
300
250
200
150
100
50
0
5
10
15
20
25
30
Day in January 2003
Figure 8: BGP UPDATE trafﬁc during an attack. Late January
24th, 2003, the “SQL Slammer” worm was unleashed. Most of
the damage was seen on January 25th.
protocol SPV and S-BGP. We built our hash function based on the
Rijndael block cipher [14] with a 128-bit key and a 128-bit block
size in the Matyas, Meyer, and Oseas construction [36, 5]. We
evaluate S-BGP based on a 1024-bit RSA operation, as we discuss
above. In evaluating both protocols we assume that the certiﬁcate
signatures are cached. The CPU usage is based on our timings of a
Pentium III running at 1GHz. In both SPV and S-BGP, CPU usage
for verifying two streams is generally negligible; however, more
connected parts of the network, the overhead of veriﬁcation may
be much higher. In such areas of the network, SPV may be more
suitable because it is a factor of 22 faster.
The higher performance of SPV when implemented in hardware
makes it more suitable for deployment in the core of the Internet.
When an AS connects to many peers, the UPDATEs received over
one second often take BGP over 100 seconds to process in software.
When the Internet experiences attacks such as worms, the number
of UPDATEs may increase signiﬁcantly. Figure 8 shows the effects
of the “SQL Slammer” worm on BGP routing trafﬁc. Furthermore,
as the Internet continues to grow, the number of preﬁxes will rise,
thereby increasing the load caused by UPDATEs. Finally, SPV and
S-BGP both support UPDATE expiration to limit the impact of re-
play attacks. To support this, the network will send a larger num-
ber of UPDATE packets. Processing this UPDATE load with S-BGP
using general purpose CPUs is impractical. Because SPV is more
efﬁcient, it can authenticate routing for more sparsely connected
networks. In more densely connected networks, hardware acceler-
ation is required for both SPV and S-BGP, and a SPV accelerator
will be much cheaper and faster than an S-BGP accelerator.
Network Overhead We evaluated the overhead of SPV relative
to S-BGP. On the two days of our simulation, SPV incurred a factor
of 2.731 more overhead than S-BGP.
6 RELATED WORK
In this section, we review related work that was not previously de-
scribed in Section 3. A number of secure distance vector [1, 30, 35,
53] and link state protocols [9, 20, 30, 45, 59] have been proposed,
but we will focus our discussion on secure path vector routing pro-
tocols, since BGP is a path vector protocol.
In the wake of recent Internet attacks, many researchers focus
on securing Internet protocols. As BGP is one of the fundamental
Internet protocols, it is clear that securing BGP is a priority. The
IETF has chartered the RPSEC working group to establish the secu-
rity requirements for routing protocols [51]. In response to the for-
mation of this working group, a number of researchers have drafted
documents that outline BGP security requirements and BGP se-
curity vulnerabilities: Barbir, Murphy, and Yang describe attacks
against BGP [2], as do Nordstrom and Dovrolis [43], and Convery
et al. present a tree of possible attacks against BGP [11].
Pei, Zhang, and Massey present a framework for building re-
silient Internet routing protocols [44]. They present an analysis of
the tradeoffs of various techniques.
In our previous work, we developed several new cryptographic
mechanisms for securing ad hoc network routing protocols [22, 23],
but these techniques were not applicable to BGP.
Although anecdotal evidence suggests that BGP attacks occur
on a daily basis, so far misconﬁgurations account for the majority
of route disruptions. Mahajan et al. ﬁnd that each day, 200-1200
preﬁxes (0.2-1.0% of the BGP table size) are erroneous due to a
misconﬁguration each day, and that almost 3 in 4 of all new preﬁx
advertisements are results of misconﬁguration [34]. Secure routing
protocols should also ﬁlter out updates due to misconﬁgurations,
which will provide signiﬁcant beneﬁts.
7 CONCLUSIONS
Using purely symmetric cryptographic primitives to secure BGP
is appealing for many reasons: software implementations enjoy at
least a 20-fold speedup over digital signatures, and a hardware im-
plementation would provide an additional 2.4-fold speedup.
In this paper we develop the SPV protocol, a protocol leverag-
ing symmetric-key cryptography for securing against the truncation
and modiﬁcation attacks. SPV is conﬁgurable to allow tradeoffs
between security and CPU usage.
SPV introduces three novel concepts to the design space of se-
cure routing protocols: ﬁrst, it includes private keys within the
UPDATEs themselves; second, it does not authenticate the AS that
inserts itself onto the path, but relies instead on hop-by-hop authen-
tication to check this property; and ﬁnally, it provides security not
by requiring overwhelming computational complexity but instead
by limiting the number of options an attacker has for modifying
critical routing information.
SPV is much faster than S-BGP, so SPV would perform better in
periods of high BGP trafﬁc. SPV can also use a shorter epoch time
(or timeout) than can S-BGP, because it can more quickly authen-
ticate new routes. In addition, when replay attacks are considered
a threat, SPV allows for shorter timeouts than does S-BGP, and
therefore can more effectively secure against replay attacks. SPV
is an attractive alternative in the design space of secure interdomain
routing protocols.
8 ACKNOWLEDGMENTS
We gratefully acknowledge support, feedback, and fruitful discus-
sions with Markus Adhiwiyogo, Prachi Gupta, Jorjeta Jetcheva,
Steve Kent, Dave Maltz, David McGrew, Sandra Murphy,
Srinivasan Seshan, Damon Smith, Dawn Song,
Ion Stoica,
Lakshminarayanan Subramanian, Gene Tsudik, Nick Weaver,
Brian Weis, S. Felix Wu, Jibin Zhan, and Hui Zhang. We would
especially like to thank Jennifer Rexford for her excellent sugges-
tions on how to improve the paper, and the anonymous reviewers
for their insightful comments.
REFERENCES
[1] F. Baker and R. Atkinson. RIP-2 MD5 Authentication. Internet Re-
quest for Comment RFC 2082, Internet Engineering Task Force, Jan-
uary 1997.
[2] A. Barbir, S. Murphy, and Y. Yang. Generic Threats to Routing Proto-
cols. Internet-Draft draft-ietf-rpsec-routing-threats-06, April 2004.
[3] M. Bellare, A. Desai, E. Jokipii, and P. Rogaway. A Concrete Security
Treatment of Symmetric Encryption: Analysis of the DES Modes of
Operation. In Proceedings of the 38th Symposium on Foundations of
Computer Science (FOCS), 1997.
[4] S. Bellovin. Security Problems in the TCP/IP Protocol Suite. Com-
puter Communication Review, 19(2):32–48, April 1989.
[5] John Black, Phillip Rogaway, and Tom Shrimpton. Black-Box Anal-
ysis of the Block-Cipher-Based Hash-Functions Constructions from
PGV. In Advances in Cryptology (CRYPTO 2002), 2002.
[6] D. Boneh and M. Franklin. Identity-Based Encryption from the Weil
Pairing. In Advances in Cryptology — CRYPTO ’2001, pages 213–
229, 2001.
[7] K. A. Bradley, S. Cheung, N. Puketza, B. Mukherjee, and R. A. Ols-
son. Detecting Disruptive Routers: A Distributed Network Monitor-
ing Approach. In Proceedings of the IEEE Symposium on Research in
Security and Privacy, pages 115–124, May 1998.
[8] J. Byers, M. Luby, M. Mitzenmacher, and A. Rege. A Digital Fountain
Approach to Reliable Distribution of Bulk Data. In Proceedings of
ACM SIGCOMM ’98, pages 56–67, 1998.
[9] S. Cheung. An Efﬁcient Message Authentication Scheme for Link
State Routing. In 13th Annual Computer Security Applications Con-
ference, pages 90–98, 1997.
[10] S. Cheung and K. Levitt. Protecting Routing Infrastructures from De-
nial of Service Using Cooperative Intrusion Detection. In The 1997
New Security Paradigms Workshop, pages 94–106, September 1998.
[11] S. Convery, D. Cook, and M. Franz. An Attack Tree for the Bor-
der Gateway Protocol. Internet-Draft draft-ietf-rpsec-bgpattack-00,
February 2004.
[12] S. Crosby and D. Wallach. Denial of Service via Algorithmic Com-
plexity Attacks. In Proceedings of the 11th USENIX Security Sympo-
sium, pages 29–44, August 2003.
[13] Security of E-commerce threatened by 512-bit number factorization.
http://www.cwi.nl/˜kik/persb-UK.html, August 1999. CWI
press release.
[14] J. Daemen and V. Rijmen. AES Proposal: Rijndael, March 1999.
[15] A. Daly and W. Marnane. Efﬁcient architectures for implementing
montgomery modular multiplication and RSA modular exponentia-
tion on reconﬁgurable logic. In Tenth ACM International Symposium
on Field-Programmable Gate Arrays, pages 40–49, February 2002.
[16] S. Even, O. Goldreich, and S. Micali. On-line/off-line digital signa-
tures. In Advances in Cryptology — CRYPTO ’89, pages 263–277,
1990.
[17] N. Feamster and H. Balakrishnan. Verifying the Correctness of Wide-
Area Internet Routing. Technical Report MIT-LCS-TR-948, MIT,
May 2004.
[18] O. Goldreich, S. Goldwasser, and S. Micali. How to Construct Ran-
dom Functions. Journal of the ACM, 33(4):792–807, October 1986.
[19] G. Goodell, W. Aiello, T. Grifﬁn, J. Ioannidis, P. McDaniel, and
A. Rubin. Working around BGP: An Incremental Approach to Im-
proving Security and Accuracy in Interdomain Routing. In Proceed-
ings of NDSS 2003, February 2003.
[20] R. Hauser, A. Przygienda, and G. Tsudik. Reducing the Cost of Secu-
rity in Link State Routing. In Proceedings of NDSS ’97, pages 93–99,
February 1997.
[21] A. Heffernan. Protection of BGP Sessions via the TCP MD5 Signature
Option. RFC 2385, August 1998.
[22] Y.-C. Hu, D. B. Johnson, and A. Perrig. SEAD: Secure Efﬁcient Dis-
tance Vector Routing for Mobile Wireless Ad Hoc Networks. Ad Hoc
Networks, 1(1):175–192, 2003.
[23] Y.-C. Hu, A. Perrig, and D. B. Johnson. Efﬁcient Security Mecha-
nisms for Routing Protocols. In Proceedings of NDSS 2003, February
2003.
[24] Y.-C. Hu, A. Perrig, and D. B. Johnson. Packet Leashes: A Defense
against Wormhole Attacks in Wireless Ad Hoc Networks. In Proceed-
ings of the Twenty-Second Annual Joint Conference of the IEEE Com-
puter and Communications Societies (INFOCOM 2003), April 2003.
[25] S. Kent and R. Atkinson. IP Encapsulating Security Payload (ESP).
Internet Request for Comment RFC 2406, Internet Engineering Task
Force, November 1998.
[26] S. Kent and R. Atkinson. Security Architecture for the Internet Pro-
tocol. Internet Request for Comment RFC 2401, Internet Engineering
Task Force, November 1998.
[27] S. Kent, C. Lynn, J. Mikkelson, and K. Seo. Secure Border Gateway
Protocol (S-BGP) — Real World Performance and Deployment Is-
sues. In Proceedings of NDSS 2000, pages 103–116, February 2000.
[28] S. Kent, C. Lynn, and K. Seo. Secure Border Gateway Proto-
col (S-BGP). IEEE Journal on Selected Areas in Communications,
18(4):582–592, April 2000.
[29] C. Kruegel, D. Mutz, W. Robertson, and F. Valeur. Topology-based
Detection of Anomalous BGP Messages. In Proceedings of the Sym-
posium on Recent Advances in Intrusion Detection (RAID), September
2003.
[30] B. Kumar. Integration of Security in Network Routing Protocols.
SIGSAC Review, 11(2):18–25, 1993.
[31] B. Kumar and J. Crowcroft. Integrating security in inter domain rout-
ing protocols. Computer Communication Review, 23(5):36–51, Octo-
ber 1993. Dept. of Comput. Sci., Univ. Coll. London, UK.
[32] L. Lamport. Constructing Digital Signatures from a One-Way Func-
tion. Technical Report SRI-CSL-98, SRI International Computer Sci-
ence Laboratory, October 1979.
[33] A. Lenstra and E. Verheul. Selecting Cryptographic Key Sizes. Jour-
nal of Cryptology, 14(4):255–293, 2001.
[34] R. Mahajan, D. Wetherall, and T. Anderson. Understanding BGP Mis-
conﬁguration. In ACM Sigcomm 2002, August 2002.
[35] G. Malkin. RIP Version 2. Internet Request for Comment RFC 2453,
Internet Engineering Task Force, November 1998.
[36] S. Matyas, C. Meyer, and J. Oseas. Generating Strong One-Way Func-
tions with Cryptographic Algorithm. IBM Technical Disclosure Bul-
letin, 27:5658–5659, 1985.
[37] A. J. Menezes, P. C. van Oorschot, and S. A. Vanstone. Handbook
of Applied Cryptography. CRC Press Series on Discrete Mathematics
and its Applications. CRC Press, 1997.
[38] R. Merkle. Protocols for Public Key Cryptosystems. In 1980 IEEE
Symposium on Security and Privacy, 1980.
[39] R. Merkle. A Digital Signature Based on a Conventional Encryption
Function. In Advances in Cryptology — CRYPTO ’87, pages 369–378,
1988.
[40] D. Meyer. Route Views Project Page. http://www.routeviews.
org.
[41] S. A. Misel. Wow, AS7007! NANOG mail archives, http://
www. merit. edu/mail.archives/nanog/ 1997-04/msg00340.
html, 1997.
[42] S. Murphy. BGP Security Protections. Internet-Draft draft-murphy-
bgp-protect-01, October 2002.
[43] O. Nordstr¨om and C. Dovrolis. Beware of BGP Attacks. ACM Com-
puter Communications Review, 34(2):1–8, April 2004.
[44] D. Pei, D. Massey, and L. Zhang. A Framework for Resilient Internet
Routing Protocols. IEEE Network, 18(2):5–12, April 2004.
[45] R. Perlman. Interconnections: Bridges and Routers. Addison-Wesley,
1992.
[46] Y. Rekhter and T. Li. A Border Gateway Protocol 4 (BGP-4).
RFC 1771, March 1995.
[47] L. Reyzin and N. Reyzin. Better than Biba: Short One-Time Signa-
tures with Fast Signing and Verifying. In Information Security and
Privacy — 7th Australasian Conference (ACSIP 2002), July 2002.
[48] R. L. Rivest. The MD5 Message-Digest Algorithm. RFC 1321, April
1992.
[49] R. L. Rivest, A. Shamir, and L. M. Adleman. A Method for Obtaining
Digital Signatures and Public-Key Cryptosystems. Communications
of the ACM, 21(2):120–126, 1978.
[50] P. Rohatgi. A Compact and Fast Hybrid Signature Scheme for Mul-
ticast Packet Authentication. In Proceedings of ACM CCS ’99, pages
93–100. ACM Press, November 1999.
[51] Routing Protocol Security Requirements (rpsec). IETF working
group, http://www.ietf.org/html.charters/rpsec-charter.
html, 2004.
[52] B. R. Smith and J.J. Garcia-Luna-Aceves. Securing the Border Gate-
way Routing Protocol. In Global Internet’96, pages 81–85, November
1996.
[53] B. R. Smith, S. Murthy, and J.J. Garcia-Luna-Aceves. Securing Dis-
tance Vector Routing Protocols. In Proceedings of NDSS ’97, pages
85–92, February 1997.
[54] J. W. Stewart. BGP4: inter-domain routing in the Internet. Addison-
Wesley, 1999.
[55] L. Subramanian, V. Roth, I. Stoica, S. Shenker, and R. Katz. Listen
and Whisper: Security Mechanisms for BGP. In Proceedings of First
Symposium on Networked Systems Design and Implementation (NSDI
2004), March 2004.
[56] N. Weaver. The SFRA: A Fixed Frequency FPGA Architecture. Ph.D.
thesis, University of California, Berkeley, 2003.
[57] R. White. Deployment Considerations
(soBGP),
gin
BGP
01.txt. Draft,
Available
draft-white-sobgp-bgp-deployment-01.%txt.
Internet Engineering Task Force,
at
Secure Ori-
draft-white-sobgp-bgp-deployment-
June 2003.
http://www.watersprings.org/pub/id/
for
[58] A. Yaar, A. Perrig, and D. Song. SIFF: A Stateless Internet Flow Fil-
ter to Mitigate DDoS Flooding Attacks. In Proceedings of the IEEE
Symposium on Security and Privacy, May 2004.
[59] K. Zhang. Efﬁcient Protocols for Signing Routing Messages. In Pro-
ceedings of NDSS ’98, March 1998.