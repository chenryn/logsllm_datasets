these domains, the adversary will need to analyze and implement
infrastructure specific to each domain. Although we have shown
that it is likely for a third party to successfully identify the type of
service previously offered on an expired domain, it may be nontrivial
to reverse engineer the details necessary for its exploitation.
False Positives
Given the highly-specific nature of our trust filters, particularly for
HTTP(S) traffic, false positives are unlikely. We find domains with
significant trust traffic when filtering for requests to residual paths
(paths that used to exist on the domain on HTTP(S)). Residual paths
require knowledge of the service offered by the domain before it
expired. We consider all the possibilities for false positives from using
residual paths as unlikely for the following reasons. First, indexers
for search engines or archives are likely aware of residual paths, but
are easily identifiable from their User-Agent header and are filtered
out as bot traffic. Second, those who are unfamiliar with the previous
service offered on the domain are unlikely to specifically request (i.e.,
guess) a residual path given that they only include service-relevant
paths and exclude paths common to many domains. Also, because
our containers serve the same content to all requests, no additional
information is gained from multiple attempts. Last, we consider those
who are unfamiliar with the previous service, but gained knowledge
of it from third-party references (e.g., forum posts or search engine
results). We argue that this is a form of residual trust because they,
in effect, discovered a new service from third-party references and
proceeded to visit the domain.
Another filter that could introduce false positives is our use of
fingerprints, but we know from recent work that most bots and
crawlers do not support JavaScript [33]; of those that do, they do
not have full support or are still likely to fall for our bot traps.
A less obvious point that may have introduced more traffic
and false positives does not stem from an analysis technique, but
rather from obtaining a TLS certificate for each domain. Certificate
Transparency (CT) [76] is a key component of the public key
infrastructure ecosystem on the web that introduces publicly auditable
certificate transparency logs. Although we did not explicitly advertise
our domains anywhere, we indirectly advertised that our domains
were issued TLS certificates and may, as a result, have received traffic
from CT log monitors. However, we argue that these clients are still
bots and therefore will most likely exhibit the same types of behavior
that our bot-detection filters target. It is therefore unlikely that requests
from CT monitors were flagged as residual trust-related traffic
because of the nature of our HTTP(S) trust filters. Instead, it is more
likely for these clients to have been flagged as bot or neutral.
Going forward
Our residual trust traffic detection pipeline demonstrated a clear
and pressing potential abuse of residual trust in domains. Although
there were some configurable variables in our experiment and analysis
methodology that could be changed, such as the domain selection
strategy and the specific passive DNS database, it is unlikely to result
in contradictory findings. Attackers abusing residual trust can conduct
a number of different attacks, ranging from stealing PII, infecting de-
vices, reviving botnets, and even bypassing web security mechanisms.
Even though there exist countermeasures for some specific instances
of residual-trust abuse (such as the use of Subresource Integrity, or SRI,
that can protect remote first-party websites against malicious changes
in remote scripts [77]), there currently exist no recommended defense
mechanisms against the overall problem of residual trust abuse.
An ideal defense mechanism would need to systematically define
the integrity of a domain, accounting for features such as ownership
and domain content, and determine whether it has changed or was
compromised, such as the system proposed by Lever et al. [1]. In
this context, we observe that the relatively recent move to anonymize
WHOIS data may have increased the privacy of domain owners, but
it also took away information that could be used to detect when a
domain changed ownership.
Orthogonally to these types of change-detection systems, we argue
that increased monitoring and asset-management capabilities have the
potential to provide early warnings to developers and administrators.
Given the domain-expiration timeline defined by ICANN (Section II),
a domain will stop resolving for at least 30 days before it becomes
publicly available for re-registration. With the right monitoring
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:01:51 UTC from IEEE Xplore.  Restrictions apply. 
2142
infrastructure, this should enable everyone who depends on a domain
to discover the impending drop and make the necessary changes
before the domain changes hands.
In conclusion, in this paper we demonstrated that a top-down, target-
agnostic approach that relies on past resolution data to identify residual-
trust domains has the potential to offer attackers access to millions
of users and thousands of systems, for the cost of a few, well-chosen,
domain registrations. To characterize the potential of this attack, we re-
registered 201 domains, developed traffic analysis pipelines to detect
residual trust traffic, and successfully profiled 128 domains to develop
domain-specific indicators of residual trust derived from the type of
services they previously offered. We reported on the types of traffic
we received and detailed the process of differentiating traffic received
from bots and traffic due to residual trust via a number of filters
based on architectural elements, request characteristics, and external
IP blocklists. Even after our aggressive filtering, we showed how our
pool of domain names attracted requests from over 2.6M IP addresses,
which attempted to connect to torrent trackers, malware C&C servers,
email trackers, college-lab software, and online radio stations. We
hope that this paper rekindles the community’s interest in detecting
and protecting against cases of domain-name-based residual trust.
Acknowledgements: We thank our shepherd Kevin Borgolte and the
anonymous reviewers for their helpful feedback as well as Farsight for
giving us access to their passive DNS APIs. This work was supported
by the Office of Naval Research (ONR) under grant N00014-20-1-
2720, as well as by the National Science Foundation (NSF) under
grants CMMI-1842020, CNS-1813974, and CNS-1941617.
REFERENCES
[1] C. Lever, R. Walls, Y. Nadji, D. Dagon, P. McDaniel, and M. Antonakakis,
“Domain-z: 28 registrations later measuring the exploitation of residual trust
in domains,” in 2016 IEEE Symposium on Security and Privacy (SP).
IEEE,
2016, pp. 691–706.
[2] T. Lauinger, A. Chaabane, A. S. Buyukkayhan, K. Onarlioglu, and W. Robertson,
“Game of registrars: An empirical analysis of post-expiration domain name
takeovers,” in 26th {USENIX} Security Symposium ({USENIX} Security 17),
2017, pp. 865–880.
[3] T. Lauinger, A. S. Buyukkayhan, A. Chaabane, W. Robertson, and E. Kirda,
“From deletion to re-registration in zero seconds: Domain registrar behaviour
during the drop,” in Proceedings of the Internet Measurement Conference 2018,
2018, pp. 322–328.
[4] N. Miramirkhani, T. Barron, M. Ferdman, and N. Nikiforakis, “Panning for gold.
com: Understanding the dynamics of domain dropcatching,” in Proceedings
of the 2018 World Wide Web Conference, 2018, pp. 257–266.
[5] C. Lever, P. Kotzias, D. Balzarotti, J. Caballero, and M. Antonakakis, “A lustrum
of malware network communication: Evolution and insights,” in 2017 IEEE
Symposium on Security and Privacy (SP).
IEEE, 2017, pp. 788–804.
[6] E. Alowaisheq, P. Wang, S. Alrwais, X. Liao, X. Wang, T. Alowaisheq, X. Mi,
S. Tang, and B. Liu, “Cracking the wall of confinement: Understanding and
analyzing malicious domain.”
[7] N. Nikiforakis, L. Invernizzi, A. Kapravelos, S. Van Acker, W. Joosen, C. Kruegel,
F. Piessens, and G. Vigna, “You are what you include: large-scale evaluation
of remote javascript inclusions,” in Proceedings of the 2012 ACM conference
on Computer and communications security, 2012, pp. 736–747.
[8] S. Roth, T. Barron, S. Calzavara, N. Nikiforakis, and B. Stock, “Complex
security policy? a longitudinal analysis of deployed content security policies,”
in Proceedings of the 27th Network and Distributed System Security Symposium
(NDSS), 2020.
[9] “Domain name industry brief (dnib). https://www.verisign.com/en us/domain-
names/dnib/index.xhtml,” https://www.verisign.com/en US/domain-names/
dnib/index.xhtml.
[10] H. Hu, P. Peng, and G. Wang, “Characterizing pixel tracking through the lens
of disposable email services,” in 2019 IEEE Symposium on Security and Privacy
(SP).
IEEE, 2019, pp. 365–379.
[11] “Expired registration recovery policy. https://www.icann.org/resources/pages/errp-
2013-02-28-en,” https://www.icann.org/resources/pages/errp-2013-02-28-en.
[12] C. Evans, C. Palmer, and R. Sleevi, “Public key pinning extension for http,”
Internet Requests for Comments, RFC Editor, RFC 7469, 04 2015. [Online].
Available: https://tools.ietf.org/html/rfc7469
[13] M. Contributors, “Http public key pinning (hpkp),” https://developer.mozilla.org/
en-US/docs/Web/HTTP/Public Key Pinning.
[14] C. Palmer, “Intent
to deprecate and remove: Public key pinning,”
https://groups.google.com/a/chromium.org/g/blink-dev/c/he9tr7p3rZ8/m/
eNMwKPmUBAAJ?pli=1.
[15] F. Weimer, “Passive dns replication,” in FIRST conference on computer security
incident, vol. 98, 2005.
[16] “Passive
dns
historical
internet
database:
Farsight
dnsdb,”
https://www.farsightsecurity.com/solutions/dnsdb/.
[17] P. Agten, W. Joosen, F. Piessens, and N. Nikiforakis, “Seven months’ worth
of mistakes: A longitudinal study of typosquatting abuse,” in Proceedings of
the 22nd Network and Distributed System Security Symposium (NDSS 2015).
Internet Society, 2015.
[18] P. Kintis, N. Miramirkhani, C. Lever, Y. Chen, R. Romero-G´omez, N. Pitropakis,
N. Nikiforakis, and M. Antonakakis, “Hiding in plain sight: A longitudinal study
of combosquatting abuse,” in Proceedings of the 2017 ACM SIGSAC Conference
on Computer and Communications Security, 2017, pp. 569–586.
[19] N. Nikiforakis, M. Balduzzi, L. Desmet, F. Piessens, and W. Joosen,
“Soundsquatting: Uncovering the use of homophones in domain squatting,” in
International Conference on Information Security. Springer, 2014, pp. 291–308.
[20] N. Nikiforakis, S. Van Acker, W. Meert, L. Desmet, F. Piessens, and W. Joosen,
“Bitsquatting: Exploiting bit-flips for fun, or profit?” in Proceedings of the 22nd
international conference on World Wide Web, 2013, pp. 989–998.
[21] Y.-M. Wang, D. Beck, J. Wang, C. Verbowski, and B. Daniels, “Strider
typo-patrol: Discovery and analysis of systematic typo-squatting.” SRUTI, vol. 6,
no. 31-36, pp. 2–2, 2006.
[22] “Domainmonster,” https://www.domainmonster.com/contact/.
[23] “Dynadot,” https://www.dynadot.com/.
[24] “Namejet,” https://www.namejet.com/default.aspx.
[25] “Pool,” https://www.pool.com/.
[26] “Snapnames,” https://www.snapnames.com.
[27] “Let’s encrypt,” https://letsencrypt.org/.
[28] “Cowrie,
interaction
medium
high
to
a
https://github.com/lanjelot/twisted-honeypots,”
twisted-honeypots.
honeypot.
https://github.com/lanjelot/
ssh
[29] “Twisted
honeypots.
https://github.com/lanjelot/twisted-honeypots,”
https://github.com/lanjelot/twisted-honeypots.
[30] “Elasticsearch. https://www.elastic.co/,” https://www.elastic.co/.
[31] “Fingerprintjs.” https://github.com/fingerprintjs/fingerprintjs.
[32] K. Park, V. S. Pai, K.-W. Lee, and S. B. Calo, “Securing web service by
automatic robot detection.” in USENIX Annual Technical Conference, General
Track, 2006, pp. 255–260.
[33] X. Li, B. A. Azad, A. Rahmati, and N. Nikiforakis, “Good bot, bad bot:
Characterizing automated browsing activity,” in IEEE Symposium on Security
and Privacy, 2021.
[34] “Browser detection using the user agent,” https://developer.mozilla.org/en-US/
docs/Web/HTTP/Browser detection using the user agent#making the
best of user agent sniffing.
[35] “Path traversal,” https://owasp.org/www-community/attacks/Path Traversal.
[36] “Blindelephant
fingerprinter,”
application
web
http://
blindelephant.sourceforge.net/.
[37] “Diversified
sampler
aggregation: Elasticsearch
reference
[7.12],”
https://www.elastic.co/guide/en/elasticsearch/reference/current/search-
aggregations-bucket-diversified-sampler-aggregation.html.
[38] “Significant
text
aggregation:
Elasticsearch
reference
[master],”
https://www.elastic.co/guide/en/elasticsearch/reference/master/search-
aggregations-bucket-significanttext-aggregation.html.
[39] “Kali tools wordlists package,” https://tools.kali.org/password-attacks/wordlists,
Feb 2014.
[40] T. Mursch,
botnet,”
https://badpackets.net/engenius-routers-found-in-mirai-like-botnet/, Mar 2019.
[41] D. Piscitello and G. Aaron, “Icann blogs,” Nov 2017. [Online]. Available:
in mirai-like
“Engenius
routers
found
https://www.icann.org/en/blogs/details/reputation-block-lists-protecting-
users-everywhere-1-11-2017-en
[42] C. Tsaousis, http://iplists.firehol.org/.
[43] “Spamhaus,” https://www.spamhaus.org/faq/section/DNSBLUsage.
[44] “Spam and open-relay blocking system (sorbs),” http://www.sorbs.net/.
[45] “Barracuda reputation block list (brbl),” https://www.barracudacentral.org/rbl.
[46] “Nicecast 1.10.1 manual,” https://my.rockhost.com/dl.php?type=d&id=10.
[47] “Music player daemon 0.22.7 user’s manual,” https://www.musicpd.org/doc/
html/user.html.
[48] “Labstats,” https://labstats.com.
[49] S. Englehardt, J. Han, and A. Narayanan, “I never signed up for this! privacy
implications of email tracking,” Proceedings on Privacy Enhancing Technologies,
vol. 2018, no. 1, pp. 109–126, 2018.
[50] “Android apk: com.movinapp.dict.ensv.free.apk 2.1.1 (english swedish dict.),”
https://aapks.com/apk/english-swedish-dictionary-free/.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:01:51 UTC from IEEE Xplore.  Restrictions apply. 
2143
[51] “Android apk: com.movinapp.dict.essv.free.apk 3.9.6 (offline spanish swedish
dictionary),” https://aapks.com/apk/spanish-swedish-dict-free/.
(emoji
com.stevenschoen.emojiswitcher
[52] “Android
apk:
switcher),”
https://emoji-switcher.en.uptodown.com/android.
[53] “Avantmobile facebook profile,” https://www.facebook.com/avantmobile/.
[54] “Avantmobile instagram profile,” https://www.instagram.com/avantmobile/.
[55] “Maltivese scan of facecommute.com,” https://maltiverse.com/hostname/
facecommute.com.
[56] “Virustotal graph: gb-installer.gbox-data.net,” https://www.virustotal.com/graph/
gb-installer.gbox-data.net.
[57] R. Bolstridge October 31, “Dyn ddos attack: Wide-spread impact across the
financial services industry (part 1),” https://blogs.akamai.com/2016/10/dyn-
ddos-attack-wide-spread-impact-across-the-financial-services-industry-part-
1.html, Oct 2016.
[58] C. Matlack, “French websites knocked offline in cyber-attack on cedexis,”
https://www.bloomberg.com/news/articles/2017-05-10/french-websites-
knocked-offline-in-cyber-attack-on-cedexis, May 2017.
[59] “Arbor networks,” https://www.netscout.com/company.
[60] “Wayback machine: smartereum.com (11/10/2019),” http://web.archive.org/
Proceedings of the 2018 on Asia Conference on Computer and Communications
Security, 2018, pp. 147–158.
[67] K. Borgolte, T. Fiebig, S. Hao, C. Kruegel, and G. Vigna, “Cloud Strife:
Mitigating the Security Risks of Domain-Validated Certificates,” in Proceedings
of the 25th Network and Distributed System Security Symposium (NDSS).
[68] J. Ma, L. K. Saul, S. Savage, and G. M. Voelker, “Beyond blacklists: learning to
detect malicious web sites from suspicious urls,” in Proceedings of the 15th ACM
SIGKDD international conference on Knowledge discovery and data mining,
2009, pp. 1245–1254.
[69] D. Canali, M. Cova, G. Vigna, and C. Kruegel, “Prophiler: a fast filter for
the large-scale detection of malicious web pages,” in Proceedings of the 20th
international conference on World wide web, 2011, pp. 197–206.
[70] K. Sato, K. Ishibashi, T. Toyono, H. Hasegawa, and H. Yoshino, “Extending
black domain name list by using co-occurrence relation between dns queries,”
IEICE transactions on communications, vol. 95, no. 3, pp. 794–802, 2012.
[71] A. Ramachandran, N. Feamster, and D. Dagon, “Revealing botnet membership
using {DNSBL} counter-intelligence,” in 2nd Workshop on Steps to Reducing
Unwanted Traffic on the Internet ({SRUTI} 06), 2006.
[72] M. Felegyhazi, C. Kreibich, and V. Paxson, “On the potential of proactive
web/20191110090712/https://smartereum.com/.
domain blacklisting.” LEET, vol. 10, pp. 6–6, 2010.
[61] “Wayback machine: forklog.media (02/20/2020),” http://web.archive.org/web/
20200220011449/https://forklog.media/.
[62] “Wayback machine: profitgid.ru (08/22/2019),” http://web.archive.org/web/
20190822204341/profitgid.ru.
[63] “Telegram: Leonbets,” https://xn--r1a.website/s/bk leonbets?before=82.
[64] T. Moore and R. Clayton, “The ghosts of banking past: Empirical analysis of
closed bank websites,” in International Conference on Financial Cryptography
and Data Security. Springer, 2014, pp. 33–48.
[65] D. Gruss, M. Schwarz, M. W¨ubbeling, S. Guggi, T. Malderle, S. More, and
M. Lipp, “Use-after-freemail: Generalizing the use-after-free problem and
applying it to email services,” in Proceedings of the 2018 on Asia Conference
on Computer and Communications Security, 2018, pp. 297–311.
[66] E. Pariwono, D. Chiba, M. Akiyama, and T. Mori, “Don’t throw me away:
Threats caused by the abandoned internet resources used by android apps,” in
[73] S. Hao, M. Thomas, V. Paxson, N. Feamster, C. Kreibich, C. Grier, and S. Hollen-
beck, “Understanding the domain registration behavior of spammers,” in Proceed-
ings of the 2013 conference on Internet measurement conference, 2013, pp. 63–76.
[74] J. Spooren, T. Vissers, P. Janssen, W. Joosen, and L. Desmet, “Premadoma: An
operational solution for dns registries to prevent malicious domain registrations,”
in Proceedings of the 35th Annual Computer Security Applications Conference,
2019, pp. 557–567.
[75] A. G´omez-Boix, P. Laperdrix, and B. Baudry, “Hiding in the crowd: an analysis
of the effectiveness of browser fingerprinting at large scale,” in Proceedings
of the 2018 World Wide web Wonference, 2018, pp. 309–318.
[76] B. Laurie, A. Langley, and E. Kasper, “Certificate transparency,” Internet
Requests for Comments, RFC Editor, RFC 6962, 06 2013. [Online]. Available:
https://tools.ietf.org/html/rfc6962
[77] “Subresource integrity,” https://www.w3.org/TR/SRI/, Jun 2016.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:01:51 UTC from IEEE Xplore.  Restrictions apply. 
2144