券监管模式的改变也从传统依靠窗口指导、经验式、手工式、分散 业强隔离的特点。企业的防护边界也延伸到互联网，特别是证券企
式的传统监管手段过渡到采用自然语言处理、知识图谱、深度学习、 业所信赖进行数据交互的各种“专网”，由于互联网的间接引入，
人工智能、大数据手段加强数字化监管能力，强化监管渗透的深度 对于安全防护能力提出了更大挑战。部分防护不足的企业带来的木
和广度，这些新技术应用一方面带来对于传统IT架构的冲击和适 桶效应更加明显，甚至暗藏跨行业性传导风险，这也催化了当前零
配，同时新技术自身也会引入新的安全风险，需要安全运营持续的 信任应用的快速推进。
经验积累，降低使用风险。
（四）技术产品和服务同质化
（二）适应国际对抗新形势、构建可持续发展安全生态 随着技术的演进和头部科技企业的事实垄断，技术和产品的同质化
随着国际意识形态对抗的加剧，证券行业作为关键基础设施面临来 现象越来越明显，核心应用和产品掌握在少数厂商手中。头部科技
自境外国家层面的APT攻击风险会越来越大，而国内受到经济利 企业的通吃，形成事实上部分领域的技术垄断，也带来潜在的同质
益驱使，来自黑产的攻击呈高发态势，网络安全的对抗在广度和深 化问题，容易被黑客通过供应链的攻击从而影响整个行业安全运
度上都不断加强。随着攻防演练活动强度以及覆盖范围不断扩展， 行，而这在近年来国家的攻防演练中也得到了充分验证。如2020
2 3
行
业 新形势下证券行业网络安全建设思考
专
刊
年CNVD收录的通用型漏洞中，网络安全产品类漏洞数量达424 和商业化转变，高级持续性威胁攻击层出不穷，攻防的不对称趋势
个，攻防演练中很多失陷的企业正是由于所使用安全产品的自身的 持续扩大，只依赖传统的基于边界防御、规则检测等静态防护策略
漏洞引起的。证券行业对关键核心技术的依赖程度越来越高，一旦 和外挂式的安全难以适应新的安全实战需求。证券业亟需转变思
供应链某个环节出现安全隐患，将对我国证券安全造成重大影响。 路，以“动态防御、主动防御、纵深防御、精准防护、整体防护、
对证券机构来说，如果核心技术产品过分依赖单一供应商而又缺少 联防联控”为新举措构建新型防御体系。特别是合理的安全架构是
安全管控，就相当于自身发展的“命门”掌握在别人手上，这也是 体系化防护的关键，是整个防御的骨架，证券行业需要通过构建灵
证券科技安全监管面临的新挑战。Gartner调研报告指出，99%的 活的自适应的防御架构来适应证券业务的快速发展，并通过多种技
组织在系统中使用了开源软件，现代软件大多数是被“组装”出来 术手段进行安全有效性的验证，持续迭代更新。
的而不是被“开发”出来的。据Forrester统计，软件开发中80-
90%的代码来自于开源软件。这些开源软件的质量直接影响到整 三、安全建议
体系统的安全性,近期爆发的log4j等漏洞再一次让大家意识到对
于开源软件的治理和规范使用迫在眉睫。 （一）合理的安全体系架构：好的安全架构应该具备较高的容错性
和灵活性，能够持续优化和适配新的安全需求和业务需求。在整体
（五）攻防演练与实战化存在客观差距 架构层面，传统串葫芦的安全架构会带来很多问题，如设备故障时
近年来，各国都通过组织国家级的网络攻防演习行动来检验安全的 的bypass，waf、ips、fw等安全设备带来的吞吐性能问题、多次
综合防护能力。我国自2016年组织开展实战化安全演练，促进了 拆包组包的时延问题，目前通过流量牵引把不同风险的流量引入到
证券行业安全防御能力有效提升，但总体上不同证券机构发展速度 不同的安全检测池是比较通用和实际的做法，通过旁路检测分析后
各异，安全防护水平参差不齐，头部企业和中小证券的差距较大， 结合soar的联动处置是个大的趋势。同时，云计算、移动应用带
木桶效应明显。各家普遍存在安全保障人员缺少实操经验，员工的 来了各类新的敏态应用，安全防护的对象已经从传统的物理主机扩
安全意识不足，对于突发事件的快速响应能力较低，应急预案的实 展到虚机、docker，甚至更轻量化的serverless。这就要求我们在
战性、可操作性有所欠缺，跨行业领域的应急协调和信息共享机制 考虑安全架构时既要兼顾传统稳态的系统，也要适配新的敏态的
缺少体系支撑等情况，离对抗有组织的高级持续威胁还有较大差 业务。…SASE这个Gartner在2019年推出的一套新的企业网络安
距，安全风险的平均检测时间MTTD和平均响应时间MTTR离 全服务架构，通过将网络和网络安全的功能融合为统一服务的模
理想状态有较大的提升空间。 式，使分支机构人员和移动办公用户能够高效且安全的通过就近
接入安全节点，可以更好的解决各种端测的安全检测和集中管控，
（六）体系化的规划、建设和运营能力 适合云计算、移动应用这些新的体系架构。而在业务模式相对固
随着金融证券科技在证券行业的广泛应用，IT架构愈加复杂，各 定的稳态应用中通过传统安全域划分来隔离风险，形成纵深防御，
种技术栈带来的风险敞口加大，而黑客攻击逐渐向组织化、专业化 仍是最简单有效的手段，和稳态业务相匹配。在企业内部可以推广
4 5
行
业 新形势下证券行业网络安全建设思考
专
刊
更多的私有云的架构，云的架构带来的好处除了容易弹性扩展快速 如果每个环节有2%的概率被检出，那每个环节的可靠性98%，
部署外，从安全角度来说实现了标准化，通过统一各种操作系统、 10个步骤之后，可靠性降为81.7%，意味着有19.3%的概率被检出，
应用版本，采取加固的安全配置，有效收敛风险暴露面，构建一 20个步骤之后，可靠性降为66.7%，有33.3%会失败。假设检出
个稳定的可运营的安全基础环境。近年来业界对比较热门的零信任 率提高到5%，20个环节后，可靠性概率降低到35.8%，64.2%的
的讨论很多，但实际落地的还是少数。从企业角度来说，比较实际 概率红队会失败。如何不断提升安全检测的覆盖率和检测粒度最能
的是先从容易突破且最基础的身份认证IAM做起，而软件定义边 考验一个企业的实际安全能力，也是广大从业者不断努力的方向。
界SDP、微隔离MSG可能对于传统的业务适配和改造比较大，稳
妥的是选择重点保护区域和分阶段实施。另外，零信任的核心在于 （二）默认和内生安全：近年来安全趋势也逐步从依赖外挂安全更
策略决策层PDP和策略执行层PEP，这依赖采集大量的数据进行 多的转到默认和内生安全上。有效的安全更多应该是设计和规划出
决策分析，企业如果在信息收集和分析不全的现状下去推，很难短 来的，安全必须融于设计中，默认安全的基本原则就是，让安全一
期见效。正如要识别手里拿刀的人是好人还是坏人，如果没有使用 开始就成为内置的属性，形成企业的一种基因固化下来。在攻防能
场景，是很难判断的，如果是在厨房的厨师则大概率是好人，而如 力不对等的情况下，甲方应该充分发挥自身掌握的信息优势。甲方
果是在车站的无业人员则大概率是坏人。另外，通过运用主动防御 最清楚自身的正常业务需求，需要开启那些服务进程、开放那些端
手段，如通过部署蜜网（比蜜罐更通用更容易部署，部分哑终端设 口、流量分布等基线特征，构建这种类似白名单检测机制的防护才
备无法安装蜜罐agent），可以有效降低攻防的不对称，将应用和 是最高效准确的。目前总体的安全防护仍是外挂式的安全偏多，正
终端层面的对抗前移到最外侧，大幅降低对抗的技术要求，提升检 如一个刚出生的婴儿需要更多的外部呵护，而如果我们自身的应用
查响应时间。兜底的安全措施可以做好重要数据的加密，证券行业 能够足够强壮，那么对于这些外挂安全的依赖就会减少，架构也能
最重要的资产还是数据，而可落地的加密手段也很多，如应用内加 够更简洁清晰，运行和防护效率也会得以提升。如实时应用自保护
密（集成密码…SDK）、数据库加密网关、数据库外挂加密、TDE… RASP、动态防护应用等这些主动防御手段的出现，但这需要更多
透明数据加密、UDF…用户自定义函数加密、TFE…透明文件加密、 安全的协同和开发人员的安全培训，需要打通跨各个部门的堵点，
FDE全磁盘加密等技术手段，企业可以根据自身实际情况选择合 这也是目前很多企业推广应用的一个难点，安全往往缺少足够话语
适的加密机制加强自身数据防护。通过这几年的实战化攻防，大家 权和主导权，很多好的设想难以落地。默认安全需要大量基础的测
都认识到单一边界防护、简单堆砌式“纵深防御”难以取得好的安 试验证工作，但这些工作是值得的。设想一下，一个带有漏洞的容
全防护效果，攻击者可能绕过网络和主机层的“马奇诺防线”，直 器镜像发布出去，可能就意味着几千乃至几万的主机存在漏洞的副
接从…Web…应用层或者API接口打进来。所以有效的纵深防御和不 本。默认安全更应该成为一个企业的安全文化，能构建一个可信的
同层面的检测能力是基础，从2021年大型攻防演练来看，一共打 基础架构，企业默认安全有效的手段就是做好日常各种常用的基础
出了一百多个漏洞，大部分都是0day漏洞，而如果只依赖单点防御， 镜像和基础配置核查，建立自己的安全需求库和规划好各类典型场
可能很快就出局了。但一次成功的红队行动往往需要几十个环节， 景的安全防护架构，这也是性价比最高的一个措施。
6 7
行
业 新形势下证券行业网络安全建设思考
专
刊
（三）风险收敛：在减少风险面上，比较常见的如操作系统层面 软硬件产品选型时提供南北向的API接口，同时保证这些产品在
的白利用，如windows下powershell、wmic、netsh、winrm、 升级迭代中保持接口的稳定，再通过soar实现各种安全场景的自
certutil、csc等命令都是黑客最喜欢利用的，而大部分企业用户实 动预警和处置，各种playbook场景需要保证有回退的编排，防止
际很少会用到这些，具体这些白利用可以参考如下github的两个 出现问题无法回退。而在运维层面，可以把常规的日常高频检测和
项目： 操作以soar的方式落地，提高运维效率，人员解放出来从事更有
windows：https://lolbas-project.github.io 价值的分析和建模等工作。通过特征指标化、指标标准化、标准模
linux：https://gtfobins.github.io 型化，把最牛的安全技术做到普通技术人员也能运营。安全产品或
安全措施要像电视一样，80岁老人会开，2岁小朋友也会开。有
企业应该定制好内部所用各类软件的使用配置规范，这可以大幅度 强前置条件的安全措施是很难持续安全运营的。企业安全建设中，
减少风险敞口。通过构建自己的电脑安全基础镜像，这样即使有几 最头疼就是考验工程化能力的安全运营，没有闭环和流程保证的安
个熊孩子犯错也可以控制影响范围。而如果真有类似应用场景，通 全运营就是马奇诺防线，好看不顶用，接地气的“笨办法”往往最
过对于这些命令的系统日志监控也可以有效进行管控。在安全左移 有效。大部分犯错不一定是黑客有多牛，而是我们自己犯了低级错
的前提下，大家往往对于自身开发的代码都有相应的测试和管控， 误，或者基础工作没落实。
通过威胁建模、安全需求库、devsecops落地可以解决自身大部分
设计和代码安全。但正如前面所述，现在的应用架构99%都会用 （五）安全SRC团队：安全行业攻防实力不对等是个长期现象，
到开源软件，很多直接下载使用的开源软件并没有进行加固配置， 而且从目前甲乙方人员的待遇来看，这种趋势还在扩大，甲方安全
而一些安全功能，如TLS、审计、日志等，需要另外加固编译才 人员疲于应对各类内部事务、外部检查和合规填报，基本没有太多
能支持。企业除了做好自身开发软件的管理，对于开源软件和外部 精力用于实战对抗，而乙方可以心无旁骛的搞实战，并乐在其中。
合作方提供的软硬件也应该制定安全使用规范，并纳入到常态化监 从现在的攻防演练来看，红队的工作都细分为打点组、免杀组、
控。另外一个比较容易带来安全隐患的环节在于数据输入/输出的 攻城组、横向组、收获组、打扫组，越来越专业，工具也是以定
过程，很多数据交互中由于文件格式包含宏、javascript、shell脚 制的自动化框架为主，如开源的CALDERA、autosploit攻击框架
本带来很多常见的安全隐患，而从业务角度来说，很多可以选择纯 也能实现很多自动化的能力。以常见的隧道检测这个场景来看红队
文本的数据格式，如yaml、json、txt等来规避这类风险，这在实 可能利用的常见工具有proxychain、frp、lcx、ngrok、regrok、
战攻防场景下可以有效切断大部分攻击链条。 ew、FPipe、Portmap、Termite、socat、natbypass、iox、
abptts、Powercat、dnscat、reGeorg、tuna、reDuh、iodine、
（四）安全运营：目前大部分企业基本的安全防护设备都是齐全的， EarthWorm、sSocks、venom、s5.go这二十几种，更不用说经
面临主要问题是如何整合和用好已有的安全产品和安全软件，实现 过魔改的一些工具，而很多甲方人员可能都没有接触过，更别说识
1+1＞2的安全能力。API是这种能力整合的粘合剂，但需要各种 别和实战下的分析研判。依赖外部力量的支持毕竟不是长久之际，
8 9
行
业 新形势下证券行业网络安全建设思考
专
刊
企业从常态化运营来看，还是要建立自身的SRC团队，并通过外 1、不知道有什么资产，没有技术手段及时发现和更新；
部培训快速补齐能力短板。围绕ATT&CK…框架的二百多种攻击战 2、资产信息不全，无法支撑安全运营的需要；
术以及关联的Shield…、d3fend防御框架，不断打造和验证实战化 3、知道有了部分风险，但无法穷尽风险；