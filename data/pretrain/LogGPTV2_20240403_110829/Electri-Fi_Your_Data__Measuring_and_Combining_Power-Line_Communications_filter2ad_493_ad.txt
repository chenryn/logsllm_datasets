(
α
e
g
a
r
e
v
A
)
s
p
b
M
(
E
L
B
f
o
d
t
S
6
4
2
0
0
20 40 60 80 100120140
Average BLE (Mbps)
20 40 60 80 100 120 140
Average BLE (Mbps)
Figure 11: Cycle-scale variation of BLE with respect
to the link quality (links are sorted with increasing
average BLE order).
ation of throughput up to 4 Mbps. We now look at longer
timescales, i.e., in terms of minutes and hours, with two
goals: (i) to examine whether some links could be probed at
a slow rate, thus reducing overhead; (ii) to characterize the
variability of PLC performance in presence of high and low
electrical loads. To study the channel quality variation over
the random scale, we run tests over long periods, i.e., two
days and two weeks, for various links. During these tests we
measure the throughput, BLE, and P Berror every second.
We now denote by µ the mean of BLE = P6
s=1 BLEs/6,
and by σ its standard deviation.
Figures 12-14 show the results of our measurements. Our
observations are as follows.
Link Quality vs Time: The variation of µ is governed
by the electrical load. The larger the number of switched-on
devices is (e.g., at working hours) the larger the attenuation
is, and the lower µ is, as we have discussed in Section 5.
Link Quality vs Variability: Observe the diﬀerences in
the y-axis scales in Figures 13 and 14 that represent a good
332Link 15-16
Throughput
9PM
P Berr
)
s
p
b
M
(
t
u
p
h
g
u
o
r
h
T
40
20
3 P M
3 P M
6 P M
6 P M
9 P M
9 P M
12 A
12 A
M
M
M
M
3 A
3 A
6 A
6 A
M
M
9 A
9 A
M
M
12 P M
12 P M
3 P M
3 P M
6 P M
6 P M
9 P M
9 P M
12 A
12 A
Time of the day
Time of the day
M
M
M
M
3 A
3 A
6 A
6 A
M
M
9 A
9 A
M
M
12 P M
12 P M
3 P M
3 P M
6 P M
6 P M
BLE
130
)
s
p
b
M
(
E
L
B
120
110
Link 0-1
9PM-9AM
9PM-9AM
P Berr
)
s
p
b
M
(
c
i
r
t
e
M
60
50
40
30
20
Link 1-9
BLE
Throughput
0
50
100
150
200
Time (s)
)
s
p
b
M
(
E
L
B
e
g
a
r
e
v
A
150
100
50
0
0
BLE = 1.7T − 0.65
50
100
Throughput T (Mbps)
Figure 15: BLE and throughput averaged every 1 s,
vs time, for link 1-9 (left). Average BLE vs through-
put for all the links (right).
0.2
0.1
r
r
e
B
P
0.08
0.06
r
r
e
B
P
12PM 6PM 12AM 6AM 12PM 6PM 12AM 6AM 12PM
0.03
7. CAPACITY ESTIMATION PROCESS
Time of the day
Figure 12: Random-scale variation of PLC over a
total duration of 2 days. Metrics are averaged over
1 minute intervals. Every day at 9pm, all lights
are turned oﬀ in our building, leading to a channel
change for PLC.
)
s
p
b
M
(
E
L
B
96
94
92
90
88
)
s
p
b
M
(
E
L
B
96
94
92
90
88
12PM 6PM 12AM 6AM
Time of the day (weekends)
12PM 6PM 12AM 6AM
Time of the day (weekdays)
Figure 13: Random-scale variation of BLE for link
1-8 over 2 consecutive weeks. Lines represent the
BLE averaged over the same hour of the day and
error bars show standard deviation.
50
45
40
35
30
)
s
p
b
M
(
E
L
B
25
12PM 6PM 12AM 6AM
)
s
p
b
M
(
c
i
r
t
e
M
60
40
20
0
Weekend
BLE
Throughput
12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27
Time of the day (weekdays)
Date (ticks at 12am)
Figure 14: Random-scale variation of BLE for link
2-11 over 2 consecutive weeks in Nov. 2014.
and a bad link, respectively. For a given link, the random-
scale variation of σ strongly depends on the noise of the
electrical devices attached, and it is higher when µ is lower,
as this implies that more devices are switched on and there-
fore, more noise is produced, or that devices are switched
on/oﬀ more often, creating impulsive noise phenomena. σ
is very small for good links; it increases as the link quality,
i.e., µ, decreases.
Link Probing: Good links exhibit a negligible standard
We now explore a capacity estimation process for PLC.
As mentioned in Section 2.1, stations estimate a tone map
if and only if they have data to send. Thus, to estimate
link metrics, a few unicast probe packets have to be sent. In
Section 6, we discuss how fast the capacity changes given the
link quality by sending saturated traﬃc. Here, we examine
how capacity can be estimated with a few probe packets and
we explore the size and the frequency of these packets.
7.1 BLE as a Capacity Estimator
First, we show that BLE, which is included in the header
of every PLC frame, accurately estimates the capacity of any
PLC link. We repeat saturated tests for our 144 links and
with a duration of 4 min. Figure 15 presents the measured
throughput and BLE. We observe that BLE is an exact
estimation of the actual throughput received by the applica-
tion. Let T be the average throughput. Fitting a line to the
data points, we get BLE = 1.7T − 0.65. We veriﬁed that
the residuals are normally distributed.
We next discuss a capacity estimation technique that uses
BLE and probe packets. To conduct a capacity estimation
using BLE, a few packets per mains cycle and estimation
interval should be captured, given our temporal variation
study in Section 6.1. Here, we investigate an alternative
technique that uses MMs to request the instantaneous BLE.
The PLC devices provide statistics of the average BLE used
over all 6 tone map slots. Probe packets need not to be sent
at all sub-intervals of the mains cycle, because according to
1901 [6], the channel estimation process yields a BLE for all
slots when at least 1 packet is sent.
We explore whether the number of the probes aﬀects the
estimation. To this end, we reset the devices before every
run. We perform experiments to estimate the capacity, by
sending only a limited number of packets of size 1300B per
second (1- 200 packets per second)9. Figure 16 shows that
the estimated capacity converges to a value that does not
depend on the number of packets sent; however, the number
of packets sent per second aﬀects the convergence time to
the real estimation. We observe that the channel-estimation
algorithm can have a large convergence time to the optimal
allocation of bits per symbol for all the carriers, because it
needs many samples from many PBs to estimate the error for
every frequency, i.e., carrier. This convergence time depends
on the (vendor-speciﬁc) channel-estimation algorithm and
on the initial estimation (which was reset by us).
deviation, which implies that they can be probed every minute
or hour, depending on the time of the day.
9Note that the probe packets can be of any size. PLC always
transmits at least a PB (500B), using padding.
333Estimated capacity (Mbps)
vs Time (s) for link 1-11
1 packet/s
0
0
0
0
2000
4000
6000
8000
10 packet/s
2000
4000
6000
8000
50 packet/s
2000
4000
6000
8000
200 packet/s
2000
4000
6000
8000
120
100
80
120
100
80
120
100
80
120
100
80
Estimated capacity (Mbps)
vs Time (s) for link 1-5
60
40
20
60
40
20
10 packet/s
1 packet/s
6000
2000
4000
8000
2000
4000
6000
8000
50 packet/s
2000
4000
6000
8000
200 packet/s
2000
4000
6000
8000
0
0
0
0
60
40
20
60
40
20
Figure 16: Estimated capacity for two links and dif-
ferent number of packet-probes per second.
To evaluate the convergence time in realistic scenarios,