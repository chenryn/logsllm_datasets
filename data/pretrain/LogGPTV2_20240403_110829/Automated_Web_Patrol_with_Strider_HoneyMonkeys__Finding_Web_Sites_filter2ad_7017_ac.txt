exploit  search  sites.  Next,  we  describe  two  ranking 
algorithms  that help  prioritize  the  investigations  of  these 
hundreds of URLs and sites. 
Site ranking based on connection counts 
Figure 5 illustrates the top 15 exploit sites for SP1-UP 
according  to  their  connection  counts.  The  bar  height 
indicates  how  many  other  sites  a  given  site  has  direct 
traffic-redirection relationship with and likely reflects how 
entrenched  a  site  owner  is  with  the  exploit  community. 
The  bar  for  each  site  is  composed  of  three  segments  of 
different colors: a black segment represents the number of 
sites that redirect traffic here; a white segment represents 
the  number  of  sites  to  which  traffic  is  redirected; a  gray 
segment indicates the number of sites that have two-way 
traffic redirection relationship with the given site. 
For  example,  site  #15  corresponds  to  a  content 
provider who is selling traffic to multiple exploit providers 
and sharing traffic with a few other content providers. Site 
#7  corresponds  to  an  exploit  provider  that  is  receiving 
traffic  from  multiple  web  sites.  Sites  #4,  #5,  and  #9 
correspond  to  pornography  sites  that  play  a  complicated 
role:  they  redirect  traffic  to  many  exploit  providers  and 
receive traffic  from many  content providers. Their heavy 
involvement in exploit activities and the fact that they are 
registered to the same owner suggest that they may be set 
up primarily for exploit purposes.  
Site ranking, categorization, and grouping play a key 
role  in  the  anti-exploit  process  because  it  serves  as  the 
basis  for  deciding  the  most  effective  resource  allocation 
for monitoring, investigation, blocking, and legal actions. 
For example, high-ranked exploit sites in Figure 5 should 
be  heavily  monitored  because  a  zero-day  exploit  page 
connected  to  any  of  them  would  likely  affect  a  large 
number of web sites. Legal investigations should focus on 
top  exploit  providers,  rather  than  content  providers  that 
are  mere  traffic  redirectors  and  do  not  perform  exploits 
themselves. 
Site ranking based on number of hosted exploit-URLs 
Figure  6  illustrates  the  top  129  sites,  each  hosting 
more than one exploit URL. This ranking helps highlight 
those  web  sites  whose  internal  page  hierarchy  provides 
important  insights.  First,  some  web  sites  host  a  large 
number  of  exploit  pages  with  a  well-organized 
hierarchical  structure.  For  example,  the  #1  site  hosts  24 
exploit  pages  that  are  organized  by  what  look  likes 
account  names  for  affiliates;  many  others  organize  their 
exploit pages by affiliate IDs or referring site names; some 
even  organize 
the 
vulnerabilities  they  exploit  and  a  few  of  them  have  the 
word “exploit” as part of the URL names. 
their  pages  by 
the  names  of 
The  second  observation  is  that  some  sophisticated 
web sites use transient URLs that contain random strings. 
This  is  designed  to  make  investigations  more  difficult. 
Site ranking based on the number of hosted exploit-URLs 
helps  highlight  such  sites  so  that  they  are  prioritized 
higher  for  investigation. The  zero-day  exploits  discussed 
in the next sub-section provide a good example of this. 
4.2.  Zero-Day Exploit Detection 
In  early  July  2005,  a  Stage-3  HoneyMonkey 
discovered  our  first  zero-day  exploit.  The  javaprxy.dll 
vulnerability was known at that time without an available 
patch  [J105,J205],  and  whether  it  was  actually  being 
exploited  was  a  critical  piece  of  information  that  was 
previously  not  known.  The  HoneyMonkey  system 
detected the first exploit page within 2.5 hours of scanning 
and  it  was  confirmed  to  be  the  first  in-the-wild  exploit-
URL  of  the  vulnerability  reported  to  the  Microsoft 
Security  Response  Center.  A  second  exploit-URL  was 
s
e
t
i
s
d
e
t
c
e
n
n
o
c
y
l
t
c
e
r
i
d
f
o
r
e
b
m
u
N
60
50
40
30
20
10
0
Number of sites from which traffic is received
Number of sites with two-way redirection
Number of sites to which traffic is redirected
Site #1
Site #2
Site #3
Site #4
Site #5
Site #6
Site #7
Site #8
Site #9
Site #10
Site #11
Site #12
Site #13
Site #14
Site #15
Figure 5. Top 15 exploit sites ranked by connection counts, among the 268 SP1-UP exploit sites 
from the suspicious list  
l
t
i
o
p
x
e
d
e
t
s
o
h
f
o
r
e
b
m
u
N
s
L
R
U
30
25
20
15
10
5
0
0
20
40
60
80
100
120
Site ranking based on the number of hosted exploit URLs
Figure 6. Top 129 SP1-UP exploit sites ranked by the number of exploit-URLs hosted 
detected  in  the  next  hour.  These  two  occupy  positions 
#132 and #179, respectively, in our list of 752 monitored 
URLs.  This  information  enabled  the  response  center  to 
provide customers with a security advisory and a follow-
up security bulletin [SH, J205]. 
During  the  subsequent  five  days,  HoneyMonkey 
detected that 26 of the 752 exploit-URLs upgraded to the 
zero-day exploit. Redirection analysis further revealed that 
25  of  them  were  redirecting  traffic  to  a  previously 
unknown  exploit  provider  site  that  was  hosting  exploit-
URLs with names in the following form: 
http://[IP address]/[8 chars]/test2/iejp.htm 
where  [8  chars]  consists  of  8  random  characters  that 
appeared  to  change  gradually  over  time.  Takedown 
notices were sent after further investigation of the installed 
malware programs, and most of the 25 web pages stopped 
exploiting the javaprxy.dll vulnerability shortly after that. 
Latest-Patched-Vulnerability Exploit Monitoring 
One  day  after  the  patch  release,  HoneyMonkey 
detected another jump in the number of exploit-URLs for 
the vulnerability: 53 URLs from 12 sites were upgraded in 
the subsequent six days. Redirection analysis revealed that 
all of them were redirecting traffic to a previously known 
exploit  provider  (ranked  #1  in  Figure  6)  who  decided  to 
add  a  new  exploit  page  for  javaprxy.dll  to  increase  its 
infection base. A takedown notice was sent after malware 
investigation and all 53 URLs stopped exploiting within a 
couple of days. 
Important Observations 
This  experience  provides  concrete  evidence  that  the 
HoneyMonkey  system  can  potentially  evolve  into  a  full-
fledged,  systematic  and  automatic  zero-day  exploit 
monitoring  system  for  browser-based  attacks.  We  make 
the following observations from the initial success: 
(1)  Monitoring  easy-to-find  exploit-URLs 
is 
effective:  we  predicted  that  monitoring  the  752  exploit-
URLs  would  be  useful  for  detecting  zero-day  exploits 
because  the  fact  that  we  could  find  them  quickly  within 
the  first  month  implies  that  they  are  more  popular  and 
easier to reach. Although zero-day exploits are extremely 
powerful,  they  need  to  connect  to  popular  web  sites  in 
order to receive traffic to exploit. If they connect to any of 
the  monitored  URLs  in  our  list,  the  HoneyMonkey  can 
quickly  detect  the  exploits  and  identify  the  exploit 
providers  behind  the  scene  through  redirection  analysis. 
Our  zero-day  exploit  detection  experience  confirmed  the 
effectiveness of this approach. 
(2) Monitoring content providers with well-known 
URLs  is  effective:  we  predicted  that  monitoring  content 
providers  would  be  useful  for  tracking  the  potentially 
dynamic  behavior  of  exploit  providers.  Unlike  exploit 
providers who could easily move  from one IP address to 
another and use random URLs, content providers need to 
maintain  their  well-known  URLs  in  order  to  continue 
attracting  browser 
takes 
advantage  of  this  fundamental  weakness  in  the  browser-
based exploit model and utilizes the content providers as 
convenient  entry  points  into  the  exploit  network.  Again, 
our  zero-day  exploit  detection  experience  confirmed  the 
effectiveness of this approach. 
traffic.  The  HoneyMonkey 
(3) Monitoring highly ranked and advanced exploit-
URLs is effective: we predicted that the top exploit sites 
we  identified  are  more  likely  to  upgrade  their  exploits 
because  they  have  a  serious  investment  in  this  business. 
Also, web sites that appear in the SP2-PP graph are more 
likely to upgrade because they appeared to be more up-to-
date  exploiters.  Both  predictions  have  been  shown  to  be 
true:  the  first  detected  zero-day  exploit-URL  belongs  to 
the  #9  site  in  Figure  5  (which  is  registered  to  the  same 
email address that also owns the #4 and #5 sites) and 7 of 
the  top  10  sites  in  Figure  5  upgraded  to  the  javaprxy.dll 
exploit; nearly half of the SP2-PP exploit-URLs in Figure 
4 upgraded as well. 
4.3.  Scanning Popular URLs 
By  specifically  searching  for  potentially  malicious 
web sites, we were able to obtain a list of URLs that have 
1.28%  of  the  pages  performing  exploits.  A  natural 
question  that  most  web  users  will  ask  is:  if  I  never  visit 
those risky web sites that serve dangerous or questionable 
content, do  I  have  to  worry  about vulnerability  exploits? 
To answer this question, we gathered the most popular one 
million  URLs  as  measured  by  the  click-through  counts 
from  a  search  engine  and 
the 
HoneyMonkey  system.  We  also  compared  the  results  of 
this  popular-list  data  with  the  suspicious-list  data  in 
Section  4.1.  Figure  7  summarizes  the  comparison  of  key 
data. 
them  with 
tested 
Suspicious List 
Popular List 
16,190 
1,000,000 
207 (1.28%) 
710 (0.071%) 
# URLs scanned 
# Exploit URLs 
# Exploit URLs 
After Redirection 
(Expansion Factor) 
752  
(263%) 
1,036  
(46%) 
470 
# Exploit Sites 
288 
131/980 = 0.13 
204/688 = 0.30 
SP2-to-SP1 Ratio 
Figure  7.  Comparison  of  the  suspicious-list  and 
popular-list data. 
4.3.1.  Summary Statistics 
Before redirection analysis 
Of the one million URLs, HoneyMonkey determined 
that 710 were exploit pages. This translates into a density 
of  0.071%,  which  is  between  one  to  two  orders  of 
magnitude  lower  than  the  1.28%  number  from  the 
suspicious-list  data.  The  distribution  of  exploit-URLs 
among the ranked list is fairly uniform, which implies that 
the next million URLs likely exhibit a similar distribution 
and  so  there  are  likely  many  more  exploit  URLs  to  be 
discovered.  Eleven  of  the  710  exploit  pages  are  very 
popular: they are among the top 10,000 of the one million 
URLs  that  we  scanned.  This  demonstrates  the  need  for 
constant, automatic  web  patrol  of  popular  pages  in  order 
to protect the Internet from large-scale infections.   
After redirection analysis: 
The  Stage-2  HoneyMonkey  redirection  analysis 
expanded  the  list  of  710  exploit-URLs  to  1,036  URLs 
hosted by 470 sites. This (1,036-710)/710=46% expansion 
is much lower than the 263% expansion in the suspicious-
list  data,  suggesting  that  the  redirection  network  behind 
the former is less complex. The SP2-to-SP1 ratio of 0.13 
is lower than its counterpart of 0.30 from the suspicious-
list  data  (see  Figure  7).  This  suggests  that  overall  the 
exploit capabilities in the popular list are not as advanced 
as those in the suspicious list, which is consistent with the 
findings from our manual analysis.      
Intersecting  the  470  exploit  sites  with  the  288  sites 
from  Section  4.1  yields  only  17  sites.  These  numbers 
suggest that the degree of overlap between the suspicious 
list, generally with more powerful attacks, and the popular 
list is not alarmingly high at this point. But more and more 
exploit sites from the suspicious list may try to “infiltrate” 
the popular list to increase their infection base. In total, we 
have collected 1,780 exploit-URLs hosted by 741 sites.  
4.3.2.  Node ranking 
Site ranking based on connection counts 
the 
several 
counts.  There  are 
two  data  sets  behind 
Figure 8 illustrates the top 15 SP1-UP exploit sites by 
interesting 
connection 
differences  between 
the 