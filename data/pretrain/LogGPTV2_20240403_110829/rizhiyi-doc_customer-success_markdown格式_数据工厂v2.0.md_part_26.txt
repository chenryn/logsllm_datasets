|         |            | 阶段的统计信息。在指定选项卡上显示以下信息： |
|         |            |                                              |
|         |            | •摘要-管道或选定阶段的摘要统计。             |
|         |            |                                              |
|         |            | •错误-                                       |
|         |            | 所选阶段的管道错误或阶段错误和错误记录摘要。 |
|         |            |                                              |
|         |            | •信息-有关管道或选定阶段或链接的一般信息。   |
|         |            |                                              |
|         |            | •配置-管道或选定阶段的配置详细信息。         |
|         |            |                                              |
|         |            | •规则                                        |
|         |            | -警报的度量警报规则、数据规则和电子邮件ID。  |
|         |            |                                              |
|         |            | •历史-管道历史记录和运行摘要的链接。         |
|         |            |                                              |
|         |            | 可以显示有关管道或配置详细信息的信息。       |
+---------+------------+----------------------------------------------+
| 3       | 阶段列表   | 列出管道中的阶段。用于选择要查看的信息       |
+---------+------------+----------------------------------------------+
| ![IM    | 更多       | 为管道提供其他操作。用于暂停监视。           |
| G_265]( |            |                                              |
| media/i |            |                                              |
| mage111 |            |                                              |
| .png){w |            |                                              |
| idth="0 |            |                                              |
| .229814 |            |                                              |
| 0857392 |            |                                              |
| 8258in" |            |                                              |
| hei     |            |                                              |
| ght="0. |            |                                              |
| 1679407 |            |                                              |
| 2615923 |            |                                              |
| 009in"} |            |                                              |
+---------+------------+----------------------------------------------+
| ![I     | 查看日志   | 显示数据收集器日志。相当于选择管理\>日志。   |
| MG_266] |            |                                              |
| (media/ |            |                                              |
| image11 |            |                                              |
| 2.png){ |            |                                              |
| width=" |            |                                              |
| 0.19005 |            |                                              |
| 7961504 |            |                                              |
| 8119in" |            |                                              |
| hei     |            |                                              |
| ght="0. |            |                                              |
| 1663013 |            |                                              |
| 9982502 |            |                                              |
| 187in"} |            |                                              |
+---------+------------+----------------------------------------------+
注意：项目基于正在执行的任务和分配给用户帐户的角色进行展示，某些图标和选项可能无法显示。
### Pipeline Monitoring管道监控
当Data
Collector运行管道时，可以查看有关管道的实时统计信息，检查正在处理的数据样本、创建规则及警报。
当Data Collector运行管道时访问Data Collector
UI时，UI将以监控模式显示管道。在监控模式下，您可以执行以下任务：
-   查看实时阶段和管道统计信息
-   查看阶段和管道错误信息，包括每个阶段的错误记录
-   拍摄并查看数据快照
-   配置规则和警报
-   查看管道历史记录
![](media/image113.png){width="5.763194444444444in"
height="3.310416666666667in"}
#### 查看管道和阶段统计信息
监视管道时，可以查看管道和管道中各阶段的实时摘要和错误统计信息。
默认情况下，Data Collector
UI在运行管道时显示管道监视信息。您可以选择一个阶段来查看有关阶段的统计信息。同样，您可以查看管道及其阶段的错误信息。
"监视器"面板显示以下选项卡的统计信息：
-   摘要
对于管道，摘要显示管道的记录计数，记录和批处理吞吐量以及批处理统计信息。对于使用运行时参数启动的管道，显示管道当前正在使用的参数值。
对于阶段，摘要显示记录和批处理吞吐量以及批处理统计信息。
提示：您可以将鼠标悬停在图表的不同部分上以查看确切的数字。
请注意，记录和批量吞吐量图表是使用指数移动平均值计算的，对最近的值进行更大的权重并且指数地减少旧数据的影响。有关更多信息，请参阅https://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average。
-   错误
对于管道，显示五分钟衰减的错误记录数的直方图以及自管道启动以来的阶段错误记录数。
对于阶段，显示错误记录的数量和阶段错误的数量。
#### 监控错误
监视管道时，可以查看管道和每个阶段的错误统计信息，还可以查看错误记录的样本。
"监视器"面板中的"错误"选项卡默认显示管道错误：
![](media/image114.png){width="5.75625in" height="2.638888888888889in"}
#### 与阶段相关的错误
可以查看与每个阶段相关的错误，与阶段相关的错误包括阶段产生的错误记录以及阶段遇到的其他错误。
要查看与阶段相关的错误，需从阶段列表中选择阶段，或者单击画布中的阶段。"监视器"面板的"错误"选项卡显示以下选项卡：
![](media/image115.png){width="5.763888888888889in"
height="2.9433956692913386in"}
-   错误记录
显示包含相关错误消息的错误记录样本，以及计数和错误直方图。
您可以展开和查看每个错误记录中的数据。如果错误是由异常产生的，则可以单击"查看堆栈跟踪"以查看完整堆栈跟踪。
-   阶段错误
显示阶段错误列表以及计数和错误直方图。阶段错误是操作错误，例如由于源数据无效而无法创建记录。
![](media/image116.png){width="5.759027777777778in"
height="2.935416666666667in"}
1.  ## 性能调优
    1.  ### 性能优化技巧
可以使用以下技巧来提高性能：
**1、当为较大的批次配置来源时，为什么批次大小只有1000条记录？**
该数据收集器的最大批量大小覆盖在起源配置的最大批量大小。该数据采集器默认是1000条记录。
配置原始批处理大小时，可以请求最大Data
Collector的最大批处理大小，或者可以增加Data
Collector 配置文件中的production.maxBatchSize属性 。该属性的配置在\$SDC_CONF/sdc.properties文件中。
**2、如何减少从原始系统读取之间的延迟？**
当管道读取记录的速度快于处理记录或将记录写入目标系统的速度时，从源系统读取之间可能会出现较长的延迟。因为管道一次处理一个批次，所以管道必须等到将一个批次提交到目标系统后再读取下一个批次，以防止管道以稳定的速率读取数据。稳定读取数据的性能比偶尔读取要好。
如果您无法提高处理器或目标的吞吐量，请限制管道从原始系统读取记录的速率。配置管道的"速率限制"属性，以定义管道在一秒钟内可以读取的最大记录数。
**3、当我尝试启动一个或多个管道时，收到一个错误，提示没有足够的线程可用。**
默认情况下，Data
Collector可以同时运行大约22个独立管道。如果您同时运行大量独立管道，则可能会收到以下错误消息：
CONTAINER_0166 - Cannot start pipeline \'\\' as there
are not enough threads available
要解决此错误，请增加Data
Collector 配置文件中的Runner.thread.pool.size 属性的值。该属性的配置在\$SDC_CONF/sdc.properties文件中。
有关更多信息，请参阅下一小节中关于"[运行多个并发管道](https://streamsets.com/documentation/datacollector/latest/help/#datacollector/UserGuide/Configuration/DCConfig.html%23task_nkc_ydl_bw) "的描述。
**4、如何改善管道的总体性能？**
可以通过调整管道使用的批处理大小来提高性能。批处理大小决定一次有多少数据通过管道。默认情况下，批处理大小为1000条记录。
您可以根据记录的大小或到达的速度来调整批次大小。例如，如果您的记录非常大，则可以减小批大小以提高处理速度。或者，如果记录很小并且很快到达，则可以增加批处理的大小。
尝试批量大小并查看结果。
要更改批处理大小，请在Data
Collector 配置文件中配置production.maxBatchSize属性。该属性的配置在\$SDC_CONF/sdc.properties文件中。
### 针对整个SDC全局性能优化
针对整个SDC全局性能优化的原则是**运行多个并发管道**。
默认情况下，Data
Collector可以同时运行大约22个独立管道。如果计划同时运行大量管道，请增加线程池大小。
数据收集器配置文件中的正在运行的管道数runner.thread.pool.size属性确定线程池中可用于运行独立管道的线程数。一个正在运行的管道需要五个线程，并且管道在池中共享线程。
配置正在运行的管道数的顺序如下：
(1)使用文本编辑器打开\$SDC_CONF/sdc.properties文件，查看正在运行的管道数。
(2)通过将正在运行的管道数乘以2.2计算近似的流道线程池大小。
(3)将runner.thread.pool.size属性设置为您的计算值。
(4)重新启动Data Collector以启用更改。
![](media/image117.png){width="5.757638888888889in"
height="0.7284722222222222in"}
### 针对管道的性能优化
当数据工厂内运行了多个管道或多个管道进程时，性能调优实际上就是对多线程管道的调优。
多线程管道允许在一个Data
Collector的单个管道中处理大量数据，从而充分利用了Data
Collector 计算机上所有可用的CPU 。使用多线程管道时，请确保为管道和Data
Collector分配足够的资源。
多线程pipeline在每个批中保存记录的顺序，就像单线程管道一样。但是由于批是由不同的pipeline实例处理的，所以不能保证所有批被写入目的地的顺序。
为了优化管道性能和资源使用，可以调整多线程管道使用的线程和管道运行程序的数量。
#### 线程数
在源中配置最大线程数或并发数。
在指定多个线程之前，请考虑数据源如何使用线程。所有起源都使用线程连接到起源系统并创建一批数据，但是它们可以不同地执行此任务。
例如，JDBC Multitable
Consumer起源为每个表使用一个线程，因此将起源配置为使用比要查询的表数更多的线程毫无意义。
相比之下，HTTP
Server起源侦听HTTP端点。配置要使用的线程数时，应考虑与峰值峰值和可用管道运行器的数量相关的可行使用的最大线程数。
![](media/image118.png){width="5.763888888888889in"
height="4.7659722222222225in"}
请注意，空闲线程消耗的资源很少，因此配置额外的线程几乎不会带来任何危害。
#### 管道流道
使用"最大流道数"管道属性配置最大流道数。
管道运行程序即使在空闲时也会消耗资源。因此，在考虑要使用的运行程序的数量时，应该决定是否要针对性能，资源使用或两者进行优化。
管道流道处理由原始线程创建的批处理。处理速度可能会根据流道逻辑的复杂性，批处理大小等而有所不同。
因此，要确定要使用的流道数量，请在运行管道时监视可用的流道数量。如果发现有大量可用的运行器，则可以减少允许的运行器数量。相反，如果通常无可用流流道，增加流道的数量可以提高性能。
例如，假设您有一条管道，其Directory从5个分片读取数据。在原点中，将线程数设置为5。这将为线程创建匹配数量的管道流道在这种情况下为5。启动管道之后并让它运行一会儿，请您回来查看以下直方图：
![](media/image119.png){width="5.754861111111111in"
height="2.9006944444444445in"}
直方图显示平均值为3.9，这意味着在任何时候都可能有3.9个可用跑步者。
如果这是管道的峰值负载，则意味着您可以在不牺牲太多性能的情况下将管道中使用的管道运行器的数量减少到2个。如果其他地方需要Data
Collector资源，并且您不介意对管道性能造成轻微影响，则可以将管道运行程序的数量减少到1个。
#### 资源使用
由于每个管道运行器都在源之后执行与管道相关的所有处理，因此多线程管道中的每个线程都需要与在单个线程上运行的相同管道大致相同的资源。
使用多线程管道时，应监视Data Collector 资源使用情况，并在适当时增加Data
Collector Java堆大小。参考以下配置调整SDC的堆内存。该配置在sdc服务环境变量文件libexec/sdc-env.sh中。
![](media/image120.png){width="5.763194444444444in"
height="0.7541666666666667in"}
#### 目前支持多线程的Origins
您可以使用以下来源创建多线程管道：
-   Amazon S3-读取存储在Amazon S3中的对象。
-   Amazon SQS使用者 -从Amazon Simple Queue
    Services（SQS）中的队列读取数据。
-   Azure Data Lake Storage Gen1-从Microsoft Azure Data Lake Storage
    Gen1读取数据。
-   Azure Data Lake Storage Gen2-从Microsoft Azure Data Lake Storage
    Gen2读取数据。
-   Azure IoT /事件中心使用者 -从Microsoft Azure事件中心读取数据。
-   CoAP服务器 -侦听CoAP端点并处理所有授权的CoAP请求的内容。
-   目录 -从目录中读取完全写入的文件。
-   Elasticsearch-从Elasticsearch集群读取数据。
-   Google Pub / Sub订阅服务器 -消费来自Google Pub / Sub订阅的邮件。
-   Groovy脚本编制 -运行Groovy脚本以创建Data Collector 记录。
-   Hadoop FS Standalone-读取HDFS中的完全写入的文件。
-   HTTP服务器 -侦听HTTP端点并处理所有授权的HTTP POST和PUT请求的内容。
-   JavaScript脚本 -运行JavaScript脚本以创建数据收集器 记录。
-   JDBC多表使用者 -通过JDBC连接从多个表中读取数据库数据。
-   Jython脚本 -运行Jython脚本以创建Data Collector 记录。
-   Kafka Multitopic Consumer-从Kafka集群中的多个主题中读取数据。
-   Kinesis Consumer-从Kinesis集群读取数据。
-   MapR DB CDC-读取已更改的MapR DB数据，该数据已写入MapR流。
-   MapR FS Standalone-在MapR中读取完全写入的文件。
-   MapR Multitopic Streams使用者 -从MapR
    Streams集群中的多个主题读取数据。
-   Oracle Bulkload-从多个Oracle数据库表中读取数据，然后停止管道。
-   REST服务 - 侦听HTTP端点，解析所有授权请求的内容，并将响应发送回原始REST
    API。用作微服务管道的一部分。
-   SQL Server 2019 BDC多表使用者 -通过JDBC连接从Microsoft SQL Server
    2019大数据群集（BDC）读取数据。
-   SQL Server CDC客户端 -从Microsoft SQL Server CDC表读取数据。
-   SQL Server更改跟踪 -处理Microsoft SQL Server更改跟踪表中的数据。
-   TCP服务器 -侦听指定的端口并通过TCP / IP连接处理传入的数据。
-   Teradata使用者 -通过JDBC连接从多个表和多个模式中读取Teradata数据库数据。
-   UDP多线程源 -从一个或多个UDP端口读取消息。
-   WebSocket服务器 -侦听WebSocket端点并处理所有授权的WebSocket请求的内容。
-   开发数据生成器 -生成随机数据以进行开发和测试。