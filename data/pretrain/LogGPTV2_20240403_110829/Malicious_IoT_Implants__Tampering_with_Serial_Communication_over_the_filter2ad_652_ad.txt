of drone destabilizes and the drone hits the ground.
6 Discussion
The results of our evaluation underline two major threats: As a ﬁrst threat, the
emergence of IoT infrastructure provide novel attack vectors besides DoS attacks
on Internet infrastructure [3,20]. As we demonstrate, malicious IoT implants
connected to LPWANs can be leveraged to exﬁltrate secret information, manip-
ulate the functionality of target devices, and in worst case, might even pose a
threat to humans. Such attacks can be performed anonymously as one can reg-
ister an account and set up the application without any identiﬁcation at the
website of the LoRaWAN service provider TTN. Furthermore, the attacker can
control the implant from a remote location over the Internet. These attacks
are not speciﬁc to LoRaWAN and can also be performed using other compet-
ing LPWAN standards. We note that the usage of traditional mobile telephony
infrastructure (e.g., GSM and LTE) would not satisfy the design criteria given
in Sect. 4.1 since a GSM or LTE radio transceiver consumes more energy, the
attacker would have to pay for data transmissions, and in most countries a SIM
card registration requires an oﬃcial identiﬁcation document. The eﬀort of build-
ing such an implant is relatively low for experts since the hardware and software
design is based mainly on oﬀ-the-shelf components and open-source software,
respectively. Thus, the dissemination of LPWANs open up new attack vectors,
which did not exist before when traditional mobile telephony infrastructure was
the only wide-area connectivity provider.
As a second threat, serial communication on PCBs is vulnerable to mali-
cious hardware inserted during physical distribution in the supply chain. While
the presented malicious IoT implant is tailored to attack I2C buses, other serial
communication systems, such as UART and SPI, could be adapted with a rea-
sonable eﬀort. However, we might only be able to apply a subset of the presented
attacks to other bus systems due to diﬀerent approaches in the electronic design
of these systems. In contrast to other serial buses, I2C facilitates a communica-
tion protocol that allows multiple masters on the bus. Since the implant acts as
550
P. Morgner et al.
a master, the injection of own transactions in SPI and UART communication is
not easily possible. Nevertheless, we can eavesdrop the communication between
ICs to exﬁltrate information and perform DoS attacks through pulling all lines
of the communication system to a low voltage state. In our evaluation, both
attacks had a signiﬁcant impact on the target devices’ security and reliability.
One might ask why should attackers use malicious IoT implants when mali-
cious software (malware) could do the same job? Although we agree that the
eﬀort of facilitating malware might be lower, malware falls short in several sce-
narios. First, if the target device has no Internet connection, then malware has
usually no communication channel to the attacker. For this reason, neither of
our three evaluation devices could be remotely attacked using malware due to
missing network interfaces. Second, in case a direct interference with serial com-
munication on hardware level is desired, e.g., to circumvent software protection
mechanisms. Third, malware could be detected by other software, in contrast
to implants that are “invisible” at software level. During the evaluation, the
implant had no inﬂuence on the regular operation of the target device except if
the attacker performs an attack. Since the attacks directly inﬂuence the com-
munication on hardware level, an incident investigator is not able to ﬁnd digital
traces in the log ﬁles of the target device’s software. The only indications might
be exceptions triggered by the MCU and physical evidence, e.g., the presence of
an implant or traces on the PCB that indicate that an implant was attached.
6.1 Limitations
The threat of LPWAN-connected malicious IoT implants comes with a number
of limitations for attackers. Each implant needs to be inserted manually, which
renders this attack procedure unsuitable for large-scale operations in which thou-
sands of devices have to be modiﬁed. Furthermore, expert knowledge in electronic
engineering and programming of software is necessary for the preparation and
insertion of an implant. Moreover, a number of potential target devices, e.g.,
mobile phones and tablets, might not provide enough space within the enclo-
sure to carry an implant that is designed using mainly oﬀ-the-shelf components.
Also, the feasibility of utilizing an LPWAN-connected implant is limited through
the coverage of the selected service provider’s LPWAN infrastructure. Finally,
the amount of exﬁltrated data is restricted since LPWANs only provide low data
rates to achieve their low-power objectives. Nevertheless, the bandwidth between
implant and attacker is reasonable for most threat scenarios.
6.2 Countermeasures
We analyze a variety of potential approaches to encounter malicious IoT
implants, which we divide into detection and safeguard mechanisms. While detec-
tion mechanisms disclose the presence of a malicious IoT implant in a system,
safeguard mechanisms prohibit an implant from interfering with the serial com-
munication.
Malicious IoT Implants
551
Detection Mechanisms. A trivial approach to detect malicious IoT implants is
visual inspection of the PCBs. The advantage is that no expensive equipment is
required. On the other hand, this requires the removal of the enclosure for most
products, which could be quite a cumbersome task since many products are not
intended to be disassembled. Therefore, this approach becomes impractical if
large batches of products should be investigated. Also, future implant layouts
might become smaller and can be implemented into PCBs hidden as legitimate
ICs, which makes visual detection much harder and more time-consuming. In
addition, non-expert user might not be able to recognize malicious hardware
elements if the implant is camouﬂaged as a legitimate part of the PCB.
Since malicious IoT implants have a physical appearance, another detection
approach is to compare the weight of suspicious products with the weight of
an evidently unmodiﬁed product. The advantage of this approach is low costs
as only a precision scale is needed. The disadvantage is that an attacker can
potentially reduce the weight of a modiﬁed device by removing small pieces of
the enclosure. Also, this approach is not suitable for heavy devices since the
weight of the implant might be hidden within the measurement tolerance.
In anomaly detection, potential side-channel eﬀects resulting from the pres-
ence of an implant are observed. For instance, the implant consumes a certain
amount of power as evaluated in Sect. 5, which might be supplied from the host
system. Thus, the power consumption of manipulated products should show
anomalies compared to unaltered products. Also, malicious IoT implants pro-
vide a wireless interface that emits radio waves, which can be detected with
special equipment. The advantage of anomaly detection procedures is potential
large-scale automation. The disadvantage is the need for hardware extensions on
the products or special equipment in testing facilities.
Safeguard Mechanisms. Another way to protect against the insertion of malicious
IoT implants is the adding of tamper-evident features. For example, the packaging
of a product can be sealed in way that the attacker cannot access the product
without irreversibly destroying the sealing. Also, physical security measures,
such as a locked encasement or resin encapsulation, could be in place to protect
the PCB against tampering. Tamper resistance does not always prevent the
implementation of an implant but it increases the attacker’s eﬀort and makes
the detection of malicious actions much more likely.
The usage of cryptographic security measures can be a countermeasure to
circumvent malicious IoT implants to read and inject messages into the serial
buses. L´azaro et al. [23] proposed an authenticated encryption scheme for I2C
buses. In their proposal, the I2C data frames are encrypted and authenticated
using AES-GCM, while addressing frames are not protected. The calculation
of ciphertext and signature is directly implemented into the master and slave
ICs. The authors assume a pre-installed key on each IC that was installed in a
secure environment. The advantage of encryption is that it provides an eﬃcient
way to lock out non-authorized entities. As a disadvantage, all ICs on the bus
must implement the encryption mechanism and need to be equipped with key
material. Most probably, this requires a change of the I2C speciﬁcations.
552
P. Morgner et al.
7 Related Work
Previous research investigated the insertion of malicious hardware at three
stages: in the design phase, during fabrication phase, and in the post-fabrication
phase. Especially hardware trojans attracted a high amount of research in the
last decade. From a high level perspective, hardware trojans are malicious mod-
iﬁcations of the hardware during the design or fabrication process. In contrast,
malicious hardware implants are alien elements that are added to a system after
the fabrication process.
There exist diﬀerent approaches to insert malicious trojans into hardware.
A ﬁrst approach are modiﬁcations of the system design at hardware descrip-
tion language (HDL) level [8,12,13,18,24,41], which results in the adding of
additional logic to the IC. Prototypes of these trojans have been mainly imple-
mented and evaluated using FPGAs. A second approach of inserting malicious
hardware is the implementation of hardware trojans at gate level during fabrica-
tion [5,22,36]. In contrast to modiﬁcations at HDL level, this approach does not
add additional logic to the system but only modiﬁes existing hardware elements.
A third approach is the adding of analog circuits to the system [42].
The ﬁrst ICs that relate to hardware implants were called mod chips [35],
which modify functions of the target system, e.g., to circumvent copyright pro-
tection mechanisms in video playback devices or to enable restricted features in
game consoles. Compared to design and fabrication phase attacks, less atten-
tion was paid by the academic community to malicious hardware attacks in
post-fabrication phases. Shwartz et al. [37] demonstrated how aftermarket com-
ponents, e.g., third-party touchscreens used in repairs of broken mobile devices,
could be manipulated such that a malicious mobile phone app can get root access
to the device. In a non-academic context, Datko and Reed [7] implemented a
hardware implant inspired by the NSA Ant catalog [4]. Their proof-of-concept
features a GSM interface to ex-ﬁltrate data and connects to the target system
via a VGA display adapter using I2C communication. To relay data from the
computer, a malware on the target system is assumed that sends data via I2C to
the implant. In contrast to our work, this implant does not fulﬁll design criteria
1 and 6 . FitzPatrick [10] presented a number of proof-of-concepts for hard-
ware implants that connect to targeted systems via I/O pins or JTAG. Although
these implants fulﬁll most design criteria, they lack a communication interface
to an IoT or cellular infrastructure ( 2 ).
8 Conclusion
In this paper, we described the implementation and evaluation of the ﬁrst mali-
cious IoT implant showing that IoT infrastructure enables novel hardware-level
attack vectors. These threats grow with the expansion of LPWANs, which will
supersede mobile telephony networks in terms of providing M2M connectivity
in a few years. Future threat models for hardware security have to take these
threats into account.
Malicious IoT Implants
553
Acknowledgement. We thank Tobias Groß for helpful comments. This work was
supported by the Federal Ministry of Education and Research, Germany, as part of the
BMBF DINGfest project.
References
1. Adelantado, F., Vilajosana, X., Tuset-Peir´o, P., Mart´ınez, B., Meli`a-Segu´ı, J., Wat-
teyne, T.: Understanding the limits of LoRaWAN. IEEE Commun. Mag. 55(9)
(2017). https://doi.org/10.1109/MCOM.2017.1600613
2. Agrawal, D., Baktir, S., Karakoyunlu, D., Rohatgi, P., Sunar, B.: Trojan detection
using IC ﬁngerprinting. In: IEEE Symposium on Security and Privacy. S&P 2007
(2007)
3. Antonakakis, M., et al.: Understanding the Mirai botnet. In: 26th USENIX Security
Symposium. USENIX Security 2017 (2017)
4. Appelbaum, J., Horchert, J., St¨ocker, C.: Shopping for spy gear: catalog advertises
NSA toolbox. Spieg. Online Int. 29 (2013). http://www.spiegel.de/international/
world/catalog-reveals-nsa-has-back-doors-for-numerous-devices-a-940994.html
5. Becker, G.T., Regazzoni, F., Paar, C., Burleson, W.P.: Stealthy dopant-level hard-
ware trojans. In: Bertoni, G., Coron, J.-S. (eds.) CHES 2013. LNCS, vol. 8086, pp.
197–214. Springer, Heidelberg (2013). https://doi.org/10.1007/978-3-642-40349-
1 12
6. Boyens, J., Paulsen, C., Moorthy, R., Bartol, N., Shankles, S.A.: Supply
chain risk management practices for federal information systems and organiza-
tions. In: NIST SP, vol. 800, no. 161 (2015). https://nvlpubs.nist.gov/nistpubs/
SpecialPublications/NIST.SP.800-161.pdf
7. Datko, J., Reed, T.: NSA Playset: DIY hardware implant over I2C. In: DEF CON
22 (2014)
8. Fern, N., San, I., Ko¸c, C¸ .K., Cheng, K.: Hardware trojans in incompletely speciﬁed
on-chip bus systems. In: Design, Automation & Test in Europe Conference &
Exhibition (2016)
9. Fernandes, E., Jung, J., Prakash, A.: Security analysis of emerging smart home
applications. In: IEEE Symposium on Security and Privacy. S&P 2016 (2016)
10. FitzPatrick, J.: The Tao of hardware, the Te of implants. Black Hat, USA (2016)
11. Gartner: Gartner says 8.4 billion connected “things” will be in use in 2017,
up 31 percent from 2016, February 2017. http://www.gartner.com/newsroom/id/
3598917
12. Gomez-Bravo, F., Jim´enez Naharro, R., Medina Garc´ıa, J., G´omez Gal´an, J., Raya,
M.S.: Hardware attacks on mobile robots: I2C clock attacking. In: Reis, L., Moreira,
A., Lima, P., Montano, L., Mu˜noz-Martinez, V. (eds.) Robot 2015: Second Iberian
Robotics Conference. AISC, vol. 417, pp. 147–159. Springer, Cham (2016). https://
doi.org/10.1007/978-3-319-27146-0 12
13. Hicks, M., Finnicum, M., King, S.T., Martin, M.M.K., Smith, J.M.: Overcoming
an untrusted computing base: detecting and removing malicious hardware auto-
matically. In: IEEE Symposium on Security and Privacy. S&P 2010 (2010)
14. HopeRF Electronic: RFM95/96/97/98(W) - low power long range transceiver mod-
ule V1.0 datasheet. http://www.hoperf.com/upload/rf/RFM95 96 97 98W.pdf
15. Hunt, G., Letey, G., Nightingale, E.: The seven properties of highly secure devices.
Technical report, March 2017
16. IC Insights: NXP acquires Freescale, becomes top MCU supplier in 2016, April
2017
554
P. Morgner et al.
17. Kerlink: Kerlink continues global expansion with subsidiary in India for rollout of
world’s largest LoRaWAN IoT network, September 2017
18. King, S.T., Tucek, J., Cozzie, A., Grier, C., Jiang, W., Zhou, Y.: Designing and
implementing malicious hardware. In: USENIX Workshop on Large-Scale Exploits
and Emergent Threats. LEET 2008 (2008)
19. Kleber, S., N¨olscher, H.F., Kargl, F.: Automated PCB reverse engineering. In: 11th
USENIX Workshop on Oﬀensive Technologies. WOOT 2017 (2017)
20. Kolias, C., Kambourakis, G., Stavrou, A., Voas, J.M.: DDoS in the IoT: Mirai and
other botnets. IEEE Comput. 50(7), 80–84 (2017). https://doi.org/10.1109/MC.
2017.201
21. Kooijman, M.: Arduino LoraMAC-in-C (LMiC) library. https://github.com/
matthijskooijman/arduino-lmic
22. Kumar, R., Jovanovic, P., Burleson, W.P., Polian, I.: Parametric trojans for fault-
injection attacks on cryptographic hardware. In: Workshop on Fault Diagnosis and
Tolerance in Cryptography. FDTC 2014 (2014)
23. L´azaro, J., Astarloa, A., Zuloaga, A., Bidarte, U., Jimenez, J.: I2CSec: a secure
serial chip-to-chip communication protocol. J. Syst. Arch.-Embed. Syst. Des. 57(2),
206–213 (2011). https://doi.org/10.1016/j.sysarc.2010.12.001
24. Lin, L., Kasper, M., G¨uneysu, T., Paar, C., Burleson, W.: Trojan side-channels:
lightweight hardware trojans through side-channel engineering. In: Clavier, C., Gaj,
K. (eds.) CHES 2009. LNCS, vol. 5747, pp. 382–395. Springer, Heidelberg (2009).
https://doi.org/10.1007/978-3-642-04138-9 27
25. LoRa Alliance: LoRa Alliance surpasses 500 member mark and drives strong
LoRaWAN protocol deployments, June 2017
26. LoRa Alliance: LoRaWAN global networks - where are we today? October 2017
27. Machina Research: With 3 billion connections, LPWA will dominate wide area
wireless connectivity for M2M by 2023, February 2015
28. Margulies, J.: Garage door openers: an internet of things case study. IEEE Secur.
Priv. 13(4), 80–83 (2015). https://doi.org/10.1109/MSP.2015.80
29. Min, H., Zhou, G.: Supply chain modeling: past, present and future. Comput. Ind.
Eng. 43(1), 231–249 (2002). https://doi.org/10.1016/S0360-8352(02)00066-9
30. Morgner, P., Mattejat, S., Benenson, Z., M¨uller, C., Armknecht, F.: Insecure to the
touch: attacking ZigBee 3.0 via touchlink commissioning. In: Proceedings of the
10th ACM Conference on Security and Privacy in Wireless and Mobile Networks.
WiSec 2017 (2017)
31. NXP: The I2C-bus speciﬁcation and user manual - UM10204, April 2014
32. Reichert, C.: NNN Co and Actility announce LoRaWAN network rollout across
Australia, February 2017
33. Ronen, E., O’Flynn, C., Shamir, A., Weingarten, A.: IoT goes nuclear: creating a
ZigBee chain reaction. In: IEEE Symposium on Security and Privacy. S&P 2017
(2017)
34. Rostami, M., Koushanfar, F., Rajendran, J., Karri, R.: Hardware security: threat
models and metrics. In: The IEEE/ACM International Conference on Computer-
Aided Design (2013)
35. Safavi-Naini, R.: Digital Rights Management: Technologies, Issues, Challenges and
Systems, vol. 3919. Springer, Heidelberg (2006). https://doi.org/10.1007/11787952
36. Shiyanovskii, Y., Wolﬀ, F.G., Rajendran, A., Papachristou, C.A., Weyer, D.J.,
Clay, W.: Process reliability based trojans through NBTI and HCI eﬀects. In: 2010
NASA/ESA Conference on Adaptive Hardware and Systems. AHS 2010 (2010)
Malicious IoT Implants
555
37. Shwartz, O., Cohen, A., Shabtai, A., Oren, Y.: Shattered trust: when replacement
smartphone components attack. In: 11th USENIX Workshop on Oﬀensive Tech-
nologies. WOOT 2017 (2017)
38. Sigfox: SIGFOX expanding IoT network in 100 U.S. cities, February 2017
39. STMicroelectronics: STM32F303CB datasheet, May 2016
40. STMicroelectronics: STM32Cube initialization code generator datasheet, July 2017
41. Sturton, C., Hicks, M., Wagner, D.A., King, S.T.: Defeating UCI: building stealthy
and malicious hardware. In: IEEE Symposium on Security and Privacy. S&P 2011
(2011)
42. Yang, K., Hicks, M., Dong, Q., Austin, T.M., Sylvester, D.: A2: analog malicious
hardware. In: IEEE Symposium on Security and Privacy. S&P 2016 (2016)