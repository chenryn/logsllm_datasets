---
## Page 112
112
4.扩展的以太网
4.2在数据链路层扩展以太网
·工作在数据链路层。
网桥
·根据MAC帧的目的地址对收到的帧进行转发和过滤。
或者转发，或者丢弃。
·工作在数据链路层。
交换机
·多端口的网桥。
·可明显地提高以太网的性能。
河南中医药大学信息技术学院互联网技术教学团队／https://inter
net.hactcm.edu.cn
---
## Page 113
113
4.扩展的以太网
4.2在数据链路层扩展以太网
口以太网交换机的特点
■实质上是一个多接口网桥。
口通常有十几个或更多的接口。
■每个接口都直接与一个单台主机或另一个以太网交换机相连，并且一般都工
作在全双工方式。
以太网交换机具有并行性。
口能同时连通多对接口，使多对主机能同时通信。
口相互通信的主机都独占传输媒体，无碰撞地传输数据。
口每一个端口和连接到端口的主机构成了一个碰撞域。
n.edu.cr
---
## Page 114
114
4.扩展的以太网
4.2在数据链路层扩展以太网
以太网交换机的每个接口都是一个碰撞域
交换机
集线器
集线器
集线器
L
口.
部门A
部门B
部门C
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 115
115
4.扩展的以太网
4.2在数据链路层扩展以太网
口以太网交换机的特点
■接口有存储器。
■即插即用。
口其内部的帧交换表（又称为地址表）是通过自学习算法自动地逐渐建立起来的。
口这种交换表就是一个内容可寻址存储器CAM (Content addressable Memory)。
■使用专用的交换结构芯片，用硬件转发，其转发速率要比使用软件转发的网
桥快很多。
口以太网交换机的性能远远超过普通的集线器，而且价格并不贵。
■每个用户独享带宽，增加了总容量。
1.edu.c
---
## Page 116
116
4.扩展的以太网
4.2在数据链路层扩展以太网
口以太网交换机的交换方式
存储转发方式
■存储转发方式
口把整个数据帧先缓存，再进行处理
■直通（cut-through）方式
口接收数据帧的同时立即按数据帧的目的MAC 地址决定该帧的转发接口。
口缺点：不检查差错就直接将帧转发出去，有可能转发无效帧。
直通方式
n.edu.cr
---
## Page 117
117
4.扩展的以太网
4.2在数据链路层扩展以太网
1以太网交换机的自学习功能
以太网交换机
L.
1
MAC地址
接口
有效时间
2
B
33
D
开始时，交换表是空的
河南中医药大学信息技术学院互联网技术教学团队／https://int
actcm.edu.cn
---
## Page 118
118
4.扩展的以太网
4.2在数据链路层扩展以太网
以太网交换机的自学习功能
以太网帧
目的地址
源地址
类型
数据
FCS
以太网交换机
B
A
1+
A 先向 B 发送一帧。该帧从接口1进入
MAC地址
接口
有效时间
到交换机。
2
MAC-A
1
B
2.
交换机收到帧后，先查找交换表。没有
3于
查到应从哪个接口转发这个帧给B。
3. 
交换机把这个帧的源地址 A 和接口1写
4
D
入交换表中。
4. 
交换机向除接口1以外的所有的接口广
第1条记录
播这个帧。
5.
由于与该帧的目的地址不相符，C和D
将丢弃该帧。
cm.edu.cn
---
## Page 119
119
4.扩展的以太网
4.2在数据链路层扩展以太网
口以太网交换机的自学习功能
以太网交换机
1+
1．考虑到可能有时要在交换机的接口更换
MAC地址
接口
有效时间
主机，或者主机要更换其网络适配器
2
B
MAC-A
1
这就需要更改交换表中的项目。
2.
为此，在交换表中每个项目都设有一定
3
的有效时间。
4
3．过期的项目就自动被删除。
D
记录是有过期时间的
cm.edu.cn
---
## Page 120
120
4.扩展的以太网
4.2在数据链路层扩展以太网
口以太网交换机的自学习功能
以太网帧
目的地址
源地址
类型
数据
FCS
以太网交换机
A
B
L
1+
1.日
B 向 A 发送一帧。该帧从接口 3 进入到
MAC地址
接口
有效时间
交换机。
2
B
MAC-A
1
2.
交换机收到帧后，先查找交换表。发现
MAC-B
2
交换表中的 MAC 地址有 A，表明要发
3子
送给 A 的帧应从接口 1转发出去。于是
4
就把这个帧传送到接口1转发给A。
D
3.
交换机把这个顿的源地址B和接口3 写
入交换表中。
第2条记录
cm.edu.cn
---
## Page 121
121
交换机自学习和转发帧的步骤归纳
从接收的帧中取出
目的地址
开始
从接收的帧中取出
源地址
交换表中有
向所有其他接口转发
无
该地址吗？
(进入的接口除外)
将该地址加入交换表
交换表中有
无
(地址、接口和有效时间)
1
该地址吗？
有
个
有
其接口与帧
向指定接口
个
进入的接口
不同
转发
相同吗？
更新交换表中的该地址项
(接口和有效时间)
相同
个
丢弃
结束
---
## Page 122
122
4.扩展的以太网
4.2在数据链路层扩展以太网
口2台以太网交换机互连
以太网交换机SW-1
以太网交换机SW-2
5于
5
1
MAC地址
接口
有效时间
MAC地址
接口
有效时间
2.
B
3子
4子
4
假设：A向B 发送了一帧，C向E发送了一帧，E向A发送了一帧。
分析：以太网交换机SW-1和SW-2的交换表内容分别是什么？
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 123
123
4.扩展的以太网
4.2在数据链路层扩展以太网
口2台以太网交换机互连
以太网交换机SW-1
以太网交换机SW-2
5于
5于
19
13
MAC地址
接口
有效时间
MAC地址
接口
有效时间
2于
MAC-A
MAC-A
5
B
L.
MAC-C
3
MAC-C
5
3于
33
MAC-E
5
MAC-E
1
43
一
假设：A向B 发送了一帧，C向E发送了一帧，E向A发送了一帧。
分析：以太网交换机SW-1和SW-2的交换表内容分别是什么？
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 124
124
4.扩展的以太网
4.2在数据链路层扩展以太网
口2台以太网交换机互连存在的问题：回路
以太网交换机SW-1
以太网交换机SW-2
5于
5于
1于
MAC地址
接口
有效时间
MAC地址
接口
有效时间
2注
K
43
6汁
6于
假设：开始时，交换机S1和S2的交换表都是空的。
假定：主机A向主机E发送一帧。
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 125
125
4.扩展的以太网
4.2在数据链路层扩展以太网
消除回路：使用生成树协议 (SPT)
1不改变网络的实际拓扑，但在逻辑上则切断某些链路，使得从一台主机到所
有其他主机的路径是无环路的树状结构，从而消除了兜圈子现象。
m.edu.cn
---
## Page 126
126
4.扩展的以太网
4.2在数据链路层扩展以太网
口从总线以太网到星形以太网
早期
现在
采用无源的总线结
以太网交换机为中心的星形结构
构。
使用CSMA/CD 协
不使用共享总线，没有碰撞问题，不使用
议，以半双工方式
CSMA/CD协议，以全双工方式工作。
工作。
但仍然采用以太网的帧结构。
河南中医药大学信息技术学院互联网技术教学团队／https://inte
let.hactcm.edu.cn
---
## Page 127
127
4.扩展的以太网
4.3虚拟局域网VLAN
以太网存在的主要问题
广播
安全
管理
风暴
问题
困难
一个以太网是一
每个接口都处于一个
按照需求，每个
个广播域
独立的碰撞域
部门实现局域网
所有计算机都处于同
一个广播域
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 128
128
4.扩展的以太网
4.3虚拟局域网VLAN
口虚拟局域网√LAN
■利用以太网交换机可以很方便地实现虚拟局域网VLAN(Virtual LAN)。
1IEEE802.1Q对虚拟局域网VLAN的定义：
口虚拟局域网VLAN是由一些局域网网段构成的与物理位置无关的逻辑组，而这些
网段具有某些共同的需求。每一个VLAN 的帧都有一个明确的标识符，指明发送
这个帧的计算机是属于哪一个VLAN。
口虚拟局域网其实只是局域网给用户提供的一种服务，并不是一种新型局域网。
---
## Page 129
129
4.扩展的以太网
4.3虚拟局域网VLAN
案例:
以太网
√划分三个虚拟局域网：VLAN1，VLAN2和VLAN3。
交换机
?
每个虚拟局域网是一个广播域。
VLAN3
√VLAN，VLAN和VLAN是三个不同的广播域。
VLAN1
VLAN2
1
应用：
以太网
交换机
√B1向 VLAN2 内成员发送数据时，B2 和B3 将会收
到其广播的信息。
√B1 发送数据时，VLAN1和VLAN3 中的 A1，A2 和
C1 等都不会收到 B1 发出的广播信息。
以太网
交换机
优势：
虚拟局域网限制了接收广播信息的工作站数，使得
网络不会因传播过多的广播信息（即"广播风暴"）而
以太网
引起性能恶化。
交换机
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 130
130
4.扩展的以太网
4.3虚拟局域网VLAN