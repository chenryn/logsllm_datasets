indicate that the behavioral HMM models perform better than the 
Naïve  Bayes  model  no  matter  what  length  of  local  contexts  is 
considered. It reveals that contextual information is an important 
feature  for  category  prediction.  The  results  imply  that  longer 
context may lead to the better category prediction. Longer context 
can  be  explored  if  more  computational  resources  are  allowed.  
The 4-gram HMM model performs the best among all the models.  
It  achieves  accuracy  0.463  for  predicting  fine-grained  categories 
of a user’s next access. 
Table 1. The performance of category prediction models 
Model 
Naïve Bayes 
Accuracy 
0.3928 
Behavioral HMM 
2-gram 
0.4596 
3-gram 
0.4609 
4-gram 
0.4630 
In  the  second  set  of  experiments,  we  further  investigate  the 
blocking trend using our proposed 4-gram HMM model with the 
passage  of  time.  The  test  set  is  divided  into  several  subsets  for 
real-life filtering simulations, where the time period is set to one 
day. If the predicted result belongs to one of the 5 security-related 
categories, i.e., ”Spyware”, “Phishing”, “Botnet”, “Virus/Worm”, 
and  “Hacking”,  the  test  instance  is  determined  to  be  “Security 
Threat” for filtering decision and put its corresponding URL in the 
blacklist. Users’ accesses will be blocked in filtering simulations, 
if  their  URLs  are  included  in  the  generated  blacklist.  From  the 
filtering  point  of  view,  incorrect  blocking  will  cause  unfair 
penalties. In addition to achieving high blocking rate, which is the 
proportion  of  dangerous  accesses  that  is  correctly  blocked, 
reducing  the  over-blocking  rate,  which  is  the  ratio  of  normal 
accesses that are incorrectly predicted as dangerous ones, is also 
important.  
Empirical  results  show  that  our  approach  achieves  macro-
averaging blocking rate 0.4293 to detect those security threats that 
cannot  be  filtered  at  users’  access  time  by  the  original  filtering 
engine. We also analyze the shortened time intervals of dangerous 
accesses that can be correctly blocked by our proposed browsing-
behavior-based method in real-life simulations. In this experiment, 
our  proposed  approach  can  advance  average  8.4  hours  to 
efficiently  alert  users  for  avoiding  security  threats  and  reducing 
human  cost.  It  reveals  that  our  4-gram  HMM  model  is  cost-
effective  for  blocking  those  unknown  security  threats  at  early 
stage. In addition, our approach achieves a favorably low macro-
averaging  over-blocking  rate  0.0005  with  the  passage  of  time, 
which  reflecting  that  our  method  is  a  reliable  solution  by 
exploring users’ browsing behaviors only for real-time filtering. 
Besides, a dangerous page may be accessed many times and cause 
propagated  damages  due  to  its  popularity.  We  also  plot  the 
damage  distributions  across  the  countries  where  threat-affected 
victims are located for observing the threat diffusions. Figures 1 
and  2  show  the  victims’  country  distributions  without  and  with 
our  early  warning  mechanism,  respectively.  Significant  areas  in 
red  color  represent  more  located  victims.  Comparing  these  two 
figures, it reveals that our approach can effectively avoid severe 
diffusions  of  security  threats.  For  example,  there  were  28  USA 
victims falling into dangerous situation caused by security threats 
that cannot be successfully detected using the current techniques 
at  users’  access 
threat  prevention 
mechanism,  67.86%  of  users  can  avoid  security  threats  at  early 
stage, i.e., there were only 9 remaining victims in USA with the 
help of our early warning approach.  
time.  By  our  security 
993complementary to existing Internet security protection techniques 
for providing more secured web surfing. 
6.  ACKNOWLEDGEMENTS 
This research was partially supported by National Science Council, 
Taiwan under grant NSC99-2221-E-002-167-MY3, and the “Aim 
for  the  Top  University  Plan”  of  National  Taiwan  Normal 
University, sponsored by the Ministry of Education, Taiwan.  We 
are  also  grateful  to  Trend  Micro  research  laboratory  for  the 
support of click-through data.  
7.  REFERENCES 
[1]  Xiang, G., Hong, J., Rose, C. P., and Cranor, L. 2011. 
CANTINA+: a feature-rich machine learning framework for 
detecting phishing web sites. ACM T. Inform. Syst. Se. 14, 2 
(September. 2011), Article 21. DOI= 
http://doi.acm.org/10.1145/2019599.2019606. 
[2]  Canali, D., Cova, M., Vigna, G., and Kruegel, C. 2011. 
Prophiler: a fast filter for the large-scale detection of 
malicious web pages.  In Proceedings of the 20th 
International Conference on World Wide Web (Hyderabad, 
India, March 28 – April 1, 2011). WWW’11. ACM, New 
York, NY, 197-206. DOI= 
http://doi.acm.org/10.1145/1963405.1963436. 
[3]  Yu, F., Xie, Y., and Ke, Q. 2010. SBotMiner: large scale 
search bot detection. In Proceedings of the 3rd ACM 
International Conference on Web Search and Data Mining 
(New York City, USA, February 3 - 6, 2010). WSDM’10. 
ACM, New York, NY, 421-430. DOI= 
http://doi.acm.org/10.1145/1718487.1718540 
[4]  Ma. J., Saul, L. K., Savage, S., and Voelker, G. M. 2009. 
Beyond blacklists: learning to detect malicious web sites 
from suspicious URLs. In Proceedings of the 15th ACM 
SIGKDD International Conference on Knowledge Discovery 
and Data Mining (Paris, France, June 28 - July 1, 2009). 
KDD’09. ACM, New York, NY, 1245-1254. DOI= 
http://doi.acm.org/10.1145/1557019.1557153. 
[5]  Doupé, A., Boe, B., Kruegel, C., and Vigna, G. 2011. Fear 
the ear: discovering and mitigating execution after redirect 
vulnerabilities. In Proceedings of the 18th ACM Conference 
on Computer and Communications Security (Chicago, IL, 
USA, October 17 - 21, 2011). CCS’11. ACM, New York, 
NY, 251-262. DOI= 
http://doi.acm.org/10.1145/2046707.2046736. 
[6]  Borders, K., and Prakash, A. 2004. Web Tap: detecting 
covert web traffic. In Proceedings of the 11th ACM 
Conference on Computer and Communications Security 
(Washington, DC, USA, October 25 - 29, 2004). CCS’04. 
ACM, New York, NY, 110-120. DOI= 
http://doi.acm.org/10.1145/1030083.1030100. 
[7]  Invernizzi, L., Comparetti, P. M., Benvenuti, S., Kruegel, C., 
Cova, M., and Vigna, G. 2012. EVILSEED: a guided 
approach to finding malicious web pages.  In Proceedings of 
the 2012 IEEE Symposium on Security and Privacy (San 
Francisco, CA, USA, May 20 - 23, 2012). SP’12. IEEE, 
Piscataway, NJ, 428-442. 
DOI=http://doi.ieeecomputersociety.org/10.1109/SP.2012.33. 
[8]  Trend Micro URL Filtering Module, available online at 
http://la.trendmicro.com/imperia/md/content/us/pdf/products/
enterprise/interscanwebsecuritysuite/ds01urlf040913us.pdf 
Figure 1. Victims’ country distribution without our approach. 
Figure 2. Victims’ country distribution with our approach. 
4.  DISCUSSION 
The previous approaches formulate the anomalous patterns from 
attackers’ points of views, which are challenging to detect those 
threats  resulting  from  new  or  unknown  attacking  patterns.  By 
contrast,  we  study  the  context  in  which  users  will  fall  into 
dangerous  states 
from  users’  points  of  view.  Collective 
intelligence is explored from a large scale of users’ click-through 
trials to prevent web security threats at early stage. That will avoid 
damages caused by security threats to be propagated unlimitedly. 
Contextual  information  is  an  important  clue  for  security  threat 
prevention. We also analyze the data sets to understand the major 
categories of previous accesses that will result in security threats. 
Empirical findings indicate many users visiting web pages rating 
as “Pornography” or “Software Download” will usually confront 
dangerous states. It reveals that if users avoid visiting these kinds 
of  web  sites  or  they  are  more  careful  during  surfing,  their 
browsing behaviors on the Web will be more secured.     
Our  proposed  model  is  a  lightweight  process  that  only  explores 
collective  intelligence  embedded  in  browsing  behaviors  for 
alerting suspicious security threats at early stage. In practices, our 
behavioral HMM is complementary to the existing content-based 
dynamic rating for blocking unknown security threats as quickly 
as possible during web surfing. 
5.  CONCLUSIONS AND FUTURE WORK 
This  paper  proposes  an  effective  web  security  threat  prevention 
method based on users’ browsing behaviors rather than attackers’ 
patterns.  The  experiments  show  that  using  more  contextual 
information  achieves  better  results  for  category  prediction. 
Although  the  inclusion  of  other  information  such  as  attacking 
trails  may  further  improve  the  accuracy,  the  use  of  browsing 
behaviors 
and 
alone  keeps 
this 
approach 
competitive 
994