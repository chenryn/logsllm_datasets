â›â ğ‘›âˆ‘ï¸
1âˆ’âˆ‘ï¸€ğ‘—
(ğ‘ğ‘˜ )
(ğ‘ğ‘˜ )
1,Â·Â·Â·,ğ‘˜ğ›¼ğ‘
ğ‘–
ââ ,
(ğ‘ğ‘˜ )
1,Â·Â·Â· ,ğ‘˜ğ›¼
ğ‘–âˆï¸
(ğ‘ğ‘˜ )
ğ‘—+1 ğ›¼
ğ‘ğ‘–âˆˆğ’«ğ‘–
(ğ‘ğ‘— )
ğ‘—
ğ‘˜=1ğœ
(8)
ğ‘˜=2
ğ‘—=1
ğ‘–=0
ğ›¼
ğœ
Therefore, we derive the reward of an attacker when launch-
ing PAW attacks against ğ‘› pools by summing up Equation
(6), (7), and (8):
ğ‘›âˆ‘ï¸
ğ‘–=0
+
âˆ‘ï¸
ğ‘›âˆ‘ï¸
ğ‘ğ‘–âˆˆğ’«ğ‘–
ğ‘˜=2
(ï¸ƒ(ï¸
(1 âˆ’ ğ‘›âˆ‘ï¸
ğ‘˜=1
ğœ
(ğ‘ğ‘˜ )
ğ‘–+1 )ğ›¼ +
(1 âˆ’ ğ›¼ âˆ’ ğ›½)Â¯ğœ
ğ›½(ğ‘ğ‘˜ ) + Â¯ğœ
(ğ‘ğ‘˜ )
(ğ‘ğ‘˜ )
1,Â·Â·Â· ,ğ‘˜ğ›¼ğ‘
ğ‘–
(ğ‘ğ‘˜ )
1,Â·Â·Â· ,ğ‘˜ğ›¼
ğ‘›âˆ‘ï¸
)ï¸ ğ‘–âˆï¸
ğ‘˜=1
ğ‘—=1
ğ›½(ğ‘ğ‘˜ ) Â· Â¯ğœ
ğ›½(ğ‘ğ‘˜ ) + Â¯ğœ
1 âˆ’âˆ‘ï¸€ğ‘—
ğœ
(ğ‘ğ‘˜ )
1,Â·Â·Â· ,ğ‘˜ğ›¼
(ğ‘ğ‘˜ )
1,Â·Â·Â· ,ğ‘˜ğ›¼
(ğ‘ğ‘— )
ğ‘—
ğ›¼
ğ‘˜=1 ğœ
(ğ‘ğ‘˜ )
ğ‘—+1 ğ›¼
)ï¸ƒ
.
Quantitative analysis and simulation. We use a spe-
cific case to show the additional reward of the attacker who
launches PAW attacks against two pools. We make the two
assumptions to reduce the parameter dimensions: (1) the at-
tackerâ€™s computational power is 0.2; and (2) ğ‘(ğ‘ğ‘–)
ğ‘˜ = ğ‘/ğ‘˜ when
ğ‘˜ infiltration mining finds ğ‘˜ different FPoWs (0 (cid:54) ğ‘ (cid:54) 1).
Furthermore, we compare the attackerâ€™s RER (%) of PAW at-
tacks and FAW attacks according to ğ‘ in three scenarios: the
two victim pools with computational power (ğ›½1, ğ›½2) equals
to (0.1, 0.1), (0.2, 0.1), and (0.3, 0.1) respectively.
The attackerâ€™s RERs of the two attacks are depicted in
Fig. 4. Clearly, the PAW can always earn a higher reward
Figure 5: The extra reward of BTC.com (29.6%), Antpool
(12.9%), or Slush (9.9%) when one pool attacks the other two
with PAW or FAW.
than FAW. and the RER of PAW is up to 2.5 times as FAW
(when ğ‘ = 1 in (0.1, 0.1) scenario).
We consider the top three biggest Bitcoin mining pool
in a real-world scenario: BTC.com [27] with 29.6% mining
power, Antpool [23] with 12.9%, and Slush [33] with 9.9%
(mining power is collected by Jan. 2019). Suppose one of them
launch PAW or FAW attacks, which the other two remain in
honest mining. The extra reward in each attacking scenario
is depicted in Fig. 5. Antpool benefits the most with our
PAW. The maximum extra reward is nearly 9%, where its
extra reward with FAW is only 5.3%. For other pools, PAW
also always better than FAW regardless of ğ‘.
We further use a Monte Carlo simulator in Matlab to verify
our analysis. We show the attackerâ€™s average RER in three
cases over 109 rounds (same as the three cases above, which
ğ›¼ = 0.2 and the (ğ›½1, ğ›½2) equals to (0.1, 0.1), (0.2, 0.1), and
(0.3, 0.1) respectively). The result is presented in Table 3.
The attackerâ€™s RER is almost identical in simulation and
theoretical analysis.
5.4 â€œMinerâ€™s Dilemmaâ€ Analysis
Mining pools can also launch PAW attacks against each other
simultaneously. We prove that PAW can avoid the â€œminerâ€™s
dilemmaâ€ (similar to FAW), and the outcome becomes a size
game (i.e. the larger pool can win). In a two-pool PAW game
(Pool1 vs Pool2), each pool will propagate the result when its
innocent mining firstly finds an FPoW. If Pool1â€™s infiltration
mining discovers an FPoW first (and vice versa for Pool2), it
withholds the FPoW. After that, if Pool1â€™s innocent mining
discovers a new FPoW, it discards the withheld FPoW and
propagates the new one. If Pool2â€™s innocent mining finds a
new FPoW, it discards the withheld one. Otherwise, when
other miners broadcast a valid block, it propagates the with-
held FPoW to cause a fork. Notice that since Pool2 also uses
PAW attacks against Pool1 at the same time, the fork can
have three branches when both of the infiltration mining
in Pool1 and Pool2 discover an FPoW before other miners.
In this scenario, the manager of one pool will choose the
FPoW generated from the opponentâ€™s infiltration mining.
For instance, when Pool1â€™s infiltration mining finds FPoW1
(in Pool2), and Pool2â€™s infiltration mining finds FPoW2 (in
Pool1), Pool1â€™s manager will choose FPoW2 when other min-
ers find a valid block, and vice versa for Pool2. The blockchain
00.10.20.30.40.50.60.70.80.91Coefficient c12345678910Relative Extra Reward (%)PAW: Case 1PAW: Case 2 PAW: Case 3FAW: Case 1FAW: Case 2FAW: Case 300.10.20.30.40.50.60.70.80.91Coefficient c123456789Expected Relative Extra Reward (%)BTC.com: PAWAntpool: PAWSlush: PAWBTC.com: FAWAntpool: FAWSlush: FAW(a) Pool1â€™s pure RER and winning
condition.
(b) Pool2â€™s pure RER and winning
condition.
Figure 6: Results of a PAW game according to Pool2â€™s size
ğ›¼[2] and coefficient ğ‘ (ğ‘[1]
2 = ğ‘/2) when
ğ›¼[1] = 0.2.
1 = ğ‘ and ğ‘[1]
2 = ğ‘[2]
1 = ğ‘[2]
will have three branches caused by FPoW1, FPoW2, and the
valid block.
We define the winning condition as pool miners (not in-
cluding the opponentâ€™s infiltration power) earning an extra
reward.
Nash equilibrium point. We use the following param-
eters to analyze a PAW game between Pool1 and Pool2
(ğ‘– âˆˆ {1, 2}).
ğ›¼[ğ‘–]:Total computational power of Poolğ‘–;
ğ‘“ [ğ‘–]
1 :Poolğ‘–â€™s original infiltration mining power;
ğ‘“ [ğ‘–]
2 :Poolğ‘–â€™s reallocated infiltration mining power after
its infiltration mining finds an FPoW;
ğ‘[ğ‘–]
1 : Probability of the Poolğ‘–â€™s withheld FPoW is selected
as the main chain in two-branch cases;
ğ‘[ğ‘–]
2 : Probability of the Poolğ‘–â€™s withheld FPoW is selected
as the main chain in three-branch cases.
We present the detailed calculation of Poolğ‘–â€™s reward ğ‘…[ğ‘–]
in Appendix-D. Now we analyze the Nash equilibrium in a
two-pool PAW game. Under the Nash equilibrium point, one
pool may satisfy the winning condition (i.e. earning more
rewards than honest mining), which breaks the â€œminerâ€™s
dilemmaâ€ in BWH attacks.
2 )).
1 , ğ‘“ [1]
Theorem 5.3. The two-pool PAW game has a unique Nash
equilibrium (ğ‘“ [1], ğ‘“ [2]) which either satisfies âˆ‡ğ‘“ [1] ğ‘…[1] = 0,
and âˆ‡ğ‘“ [2] ğ‘…[2] = 0; or a point on a borderline which maximizes
ğ‘…[1] with ğ‘“ [1] and ğ‘…[2] with ğ‘“ [2] (ğ‘“ [1] = (ğ‘“ [1]
2 ) and ğ‘“ [2] =
(ğ‘“ [2]
1 , ğ‘“ [2]
Detailed proof is presented in Appendix-E.
Winning conditions. We quantitatively analyze the re-
ward in a two-pool PAW game under the Nash equilibrium
point. For simplicity, we assume ğ‘[1]
1 are symmetric,
as well as ğ‘[1]
1 = ğ‘[2]
2 = ğ‘/2,
where 0 (cid:54) ğ‘ (cid:54) 1 [13]). Before presenting the results, we de-
fine the pure reward of Poolğ‘–, which means the total reward
of Poolğ‘– miners not including the infiltration mining of the
opponent pool (PoolÂ¬ğ‘–). Therefore, the pure reward of Poolğ‘–
under honest mining is ğ›¼[ğ‘–], which can be used to calculate
its pure RER.
1 and ğ‘[2]
1 = ğ‘ and ğ‘[1]
2 and ğ‘[2]
2 = ğ‘[2]
(i.e. ğ‘[1]
2
Fig. 6 shows the results of a two-pool PAW game in terms
of ğ›¼[2] and ğ‘ when ğ›¼[1] = 0.2. The pure RERs of Pool1 and
Pool2 are presented in Fig. 6-a and Fig. 6-b respectively,
where the black lines represent the same pure RER as honest
Figure 7: Winning conditions of Pool1. The right side of each
line represents the winning range of Pool1 under the corre-
sponding ğ‘.
mining (i.e. Pool1â€™s pure RER = 0 in Fig. 6-a and Pool2â€™s
pure RER = 0 in Fig. 6-b). Each pool can earn an extra
reward above the black lines while taking a loss below the
lines. When ğ›¼[2] > 0.2, Pool2 may get more rewards under
the two-pool PAW game. However, when ğ›¼[2] < 0.2, Pool2
will always take a loss (same as the result in a two-pool FAW
game). Therefore, the PAW game becomes a pool size game,
and the â€œminerâ€™s dilemmaâ€ [7] (each pool will always take a
loss when its computational power is less than 0.5) may not
hold.
We further analyze the winning conditions. Pool1â€™s winning
conditions are depicted in Fig. 7 (Pool2â€™s winning conditions
can be found by swapping ğ›¼[1] and ğ›¼[2]). The nine lines
represent the same reward as honest mining when ğ‘ varies
from 0.2 to 1. The right side of each line represents the
winning range of Pool1 under the corresponding ğ‘. When
ğ‘ = 1, the borderlines are exactly same for Pool1 and Pool2
(ğ›¼[1] = ğ›¼[2]). Therefore, as we expected, the larger pool can
earn an extra reward, while the smaller pool will always take
a loss. Furthermore, even when the computational power of
each pool is less than 0.5 and ğ‘ is less than 1, there can still
be a winner, which can avoid the â€œminerâ€™s dilemmaâ€ [7]. In
summary, the winning condition is related to ğ›¼[1], ğ›¼[2], and
ğ‘. The larger pool can earn an extra reward (related to ğ‘),
while the smaller pool will always take a loss (regardless of
ğ‘).
6 BRIBERY SELFISH MINING
6.1 Overview
We introduce novel bribery selfish mining (BSM) attacks
which combines bribery racing strategy and selfish mining.
In our observation in bribery racing (Section 4.1), we point
out when â€œ0-leadâ€ racing occurs, an attacker can bribe other
miners to work on her branch to increase the probability of
winning in forks. Therefore, BSM can increase the attackerâ€™s
reward via including bribery transactions in the attackerâ€™s
branch. Furthermore, when bribery racing occurs, targets
(bribes) can encounter a â€œvenal minerâ€™s dilemmaâ€, which
all targets will choose to accept the attackerâ€™s branch for a
higher reward, but still suffer from a loss (comparing with
no one accepting).
We define three entities in BSM, attacker (ğ‘), the target
(venal miner, ğ‘), and other miners (ğ‘œ). In BSM, an attacker
ğ‘ will include bribes in each block of her private chain (ğ‘‡ ğ´
ğµ ).
After the attacker discovering a block, she withholds the
00.10.20.30.40.5,[2]00.20.40.60.81Coefficient c-20-15-10-505Pure RER of Pool1 (%)00.10.20.30.40.5,[2]00.20.40.60.81Coefficient c-30-25-20-15-10-505Pure RER of Pool2 (%)00.050.10.150.20.250.30.350.40.450.5[1]00.10.20.30.40.5[2]c=0.2c=0.3c=0.4c=0.5c=0.6c=0.7c=0.8c=0.9c=1block and broadcasts a transaction to spend the bribes on
ğ´â€² , where ğ´â€² can be another address of the
the public chain (ğ‘‡ ğ´
attacker). When another miner (ğ‘œ or ğ‘) finds a block on the
public chain, the attacker selectively publishes the withheld
blocks in the private branch to cause a fork. A target pool
(the venal pool) can choose either to extend the attackerâ€™s
branch or the public branch. When choosing to extend the
attackerâ€™s branch, the target can claim the bribes in ğµ. When
choosing the other one, the target cannot claim the bribes,
since the bribes have been transferred to ğ´â€² on the public
chain.
We consider â€œhonestâ€ opponents in our analysis. When
opponents are rational, it will become a bribery racing game
(Appendix-F). Besides, bribing can also be done via smart
contracts [17], out-of-band payment, or negative-fee mining
pool [2]. Here we only consider in-band payment since it is
the most practical method.
6.2 Modeling BSM
We first define the additional parameters in BSM:
ğ›½ğ‘: Computational power of the target pool (venal pool)
to be analyzed;
ğ›¾: The ratio of other miners that choose to mine on the
attackerâ€™s branch;
ğœ€: The fraction of reward in each round as bribes of
the attacker willing to pay per block when the target
pool chooses to accept bribes.
Notice that since the bribes are available to any miners
adopting the attackerâ€™s branch, there can be multiple targets
in our model. An attackerâ€™s reward will increase with more
targets (discussed latter). Here ğ›½ğ‘ only represents one target
since we analyze the optimal strategy of one target. Other
targets are determined by ğ›¾ (a larger ğ›¾ with more targets).
The relationship between ğ›¾ and ğ‘ (in Section 5.2) is ğ‘ =
ğ›¼ + ğ›¾(1 âˆ’ ğ›¼ âˆ’ ğ›½ğ‘).
State machine and probability. For simplicity, we use
the selfish mining strategy in [9] to analyze the BSM. The
same analysis can also be applied to other optimal selfish
mining strategies [22, 38]. We show the state machine of BSM
in Fig. 8. The states represent the â€œlead of the attackerâ€ (i.e.,
the difference between the length of attackerâ€™s private branch
and the public branch). State 0 means that there is no branch,
and state 0â€²
ğ‘¥ means â€œ0-leadâ€ racing: there are two branches of
length one (attackerâ€™s branch and ğ‘¥â€™s branch). Specifically, 0â€²
ğ‘
means the two branches are from the target pool and attacker,
and 0â€²
ğ‘œ means the two branches are from other miners and the
attacker. From state 0â€²
ğ‘¥, there are five possible transitions,
all leading to state 0: (1) other miners mine a block on ğ‘¥â€™s
branch (probability (1 âˆ’ ğ›¾)(1 âˆ’ ğ›¼ âˆ’ ğ›½)); (2) other miners
mine a block on attackerâ€™s branch (probability ğ›¾(1 âˆ’ ğ›¼ âˆ’ ğ›½));
(3) attacker mines a block on attackerâ€™s branch (probability
ğ›¼); (4) the target mines a block on ğ‘¥â€™s branch (probability
ğ›½); and (5) the target mines a block on attackerâ€™s branch
(probability ğ›½). At state 0â€²
ğ‘œ, the target can choose either (4)
or (5). Choosing (4) means the target denying the bribes, and
choosing (5) means accepting. While at state 0â€²
ğ‘, the target
must choose (4) to avoid the loss from the previously mined
block. Regardless of the targetâ€™s strategies, the probability