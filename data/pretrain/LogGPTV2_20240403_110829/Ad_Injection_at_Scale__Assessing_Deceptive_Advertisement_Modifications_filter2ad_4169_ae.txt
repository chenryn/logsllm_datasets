steady user base to drive revenue.
C. Afﬁliate Structure of Ad Injectors
When we manually reviewed the top injection libraries we
found that many were in fact organized as afﬁliate programs.
In this model, afﬁliates embed the injection library provided
by an afﬁliate program into a client’s browsing session—
using whatever mechanism available—which then handles ad
selection. The afﬁliate program in turn pays afﬁliates for
the volume of trafﬁc or installs they generate. For instance,
superﬁsh.com recently appeared at Afﬁliate Summit East (a
popular recruiting fair for afﬁliates), with one of the company’s
employees stating “Let’s meet up to monetize your toolbar or
add on” [4].
We manually reverse engineered the set of URL parameters
associated with afﬁliate tracking for each of the top ad injec-
tion afﬁliate programs and then scanned every record in our
dataset to pull out afﬁliate data. We provide a breakdown of
the total unique afﬁliates we identify in Table III. We ﬁnd that
afﬁliate market shares of each afﬁliate program’s total trafﬁc
follow a long tail distribution. The top 10% of afﬁliates control
47–96% of each afﬁliate programs’ market share, while the
158158
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:21 UTC from IEEE Xplore.  Restrictions apply. 
Ad Injection Library
superﬁsh.com
api.jollywallet.com
visadd.com
intext.nav-links.com
{crdrdpjs, rvzrjs, ...}.info
ads.tfxiq.com
clkmon.com
datafastguru.info
easyinline.com
# Afﬁliates
494
114,486
885
96
613
479
521
57,983
155
Top Afﬁliate
Crossrider
Shopperpro
Iwebar
Crossrider
TornTV V9.0
Sense
Plus-HD-9.4
Browser Shop
Netcrawl
Top Share
44%
8%
7%
42%
7%
8%
6%
10%
12%
Table III: Afﬁliate structure of the top ad injectors, the total number
of unique afﬁliates identiﬁed in client-side DOMs, the largest afﬁliate
by market share, and the market share the they control.
top 50% control 70–99%. This is particularly apparent for su-
perﬁsh.com and intext.nav-links.com where the top afﬁliate—
Crossrider—controls 42–44% of the market share. Crossrider
is a mobile, desktop, and extension development platform that
enables drop-in monetization via major ad injectors. Crossrider
provides its afﬁliate ID to ad injectors while separately track-
ing kick-backs to developers. The other top afﬁliates listed
in Table III are all cross-browser extensions and plugins that
impact Chrome, Firefox, and Internet Explorer.
D. Co-occuring Ad Injectors
The afﬁliate nature of ad injection creates an incentive for
software developers and network operators to laden impacted
clients with ads supplied from as many afﬁliate programs as
possible. We observe that 50% of tampered clients fetch at
least two injection libraries per page load and 30% of clients
at least four. To better understand the practice of bundling
multiple injection libraries per client, we calculate the Jaccard
similarity coefﬁcient between the pages impacted by distinct
injection libraries. We show our results in Figure 7. The most
popular program, superﬁsh.com, appears 49% of the time
with jollywallet.com, 33% with visadd.com, and 25% with
intext.nav-links.com. A similar pattern emerges between other
afﬁliate programs.
This practice maximizes the proﬁt that afﬁliates earn per
client. As we discuss in Section VII, each injection library has
varying advertising relationships that may or may not monetize
certain trafﬁc (e.g., pornographic content). Similarly, many of
the top injection libraries include a blacklist of properties they
abort tampering with, not all of which are consistent. Afﬁliates
overcome these gaps in coverage by contacting as many
afﬁliate programs as possible. We support
this conclusion
further in Section V where we observe binaries and extensions
simultaneously installing multiple injection libraries.
E. Understanding the Ad Injector User Base
Ad injection impacts users located around the globe inde-
pendent of the operating system they use. We ﬁnd that injectors
tamper with 5.11% of pages served to Windows machines and
3.43% of page views on Mac OSX. This indicates that ad
injection is not a Windows binary problem, but rather broadly
impacts diverse operating systems and browsers.
Figure 8 shows a breakdown of ad injection levels per
region, as determined by the geolocation of clients. We note
Figure 7: Overlap between ad injection libraries, as measured by the
Jaccard similarity between the sets of impacted clients.
Figure 8: Impact of ad injection around the globe. South America,
South Asia, and South East Asia have the highest concentration of
injection.
that regions in white either block access to Google (e.g.,
China) or are omitted due to a limited sample size (e.g.,
Central Africa). We observe that South America, South Asia,
and South East Asia are the most frequently affected regions
(8% of views). Conversely, ad injection impacts only 2.6% of
North American views, 3–4.5% of European views, and fewer
than 0.6% of Japanese and South Korean views.
F. Long Tail of Ad Injectors
Our methodology for detecting ad injectors concentrates
on the top 65 scripts used by ad injectors. As we discussed
in Section III,
in practice there are 19,315 rogue scripts
appearing in DOM content. We place an upper bound on the
fraction of views impacted by ad injectors in this long tail by
calculating the fraction of all page views that include any script
outside of the 35 in the top 100 we determined to be benign
(Section III-A). In the worst case, if all rogue scripts relate to
injection libraries, it would at most impact an additional 3%
of Google page views irrespective of the browser involved.
159159
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:21 UTC from IEEE Xplore.  Restrictions apply. 
V. DISTRIBUTION & INJECTION TECHNIQUES
Injected ads arrive on a client’s machine through multiple
vectors: binaries, extensions, and even network-level tamper-
ing. We correlate each of these distribution channels with
the most prominent ad injectors; delve into the technical
mechanisms that extensions and binaries use to modify client
DOM content; estimate the number of Chrome users impacted
speciﬁcally by ad injection extensions; and ﬁnally estimate our
coverage of ad injection software.
A. Ad Injector Distribution Channels
10000
1000
100
10
)
5
d
m
(
s
t
n
a
i
r
a
v
n
o
i
t
c
e
n
j
i
d
a
w
e
N
In total, WebEval, Hulk, and Safe Browsing identify 50,870
extensions and 34,407 binaries that perform ad injection. New
ad injection software is constantly emerging. Figure 9 shows
a log-scale timeline of new extension and binary variants
throughout October 2013–October 2014. In April 2013, over
1,000 new ad injection extensions were authored. Since that
period, new extensions have steadily declined to roughly 10
per day. Conversely, the arrival of new binaries deﬁes any
trend. The largest peak of over 10,000 new Windows installers
occurred around July 2014, with numbers dropping to roughly
100 per day in October 2014. Of the extensions we identify,
only 10% were ever present in the Chrome Web Store. The
remaining 90% originate from binaries or websites providing
off-market extensions which can no longer be installed on
Windows.7
We provide a breakdown of the most popular ad injec-
tion libraries used by software in Table IV. We ﬁnd that
49,127 (96%) different extension variants and 33,486 (97%)
distinct binaries contact superﬁsh.com,
the ﬁrst sample of
which appeared back in September 2012. As we observed
in client
the authors of these programs frequently
bundle multiple injection libraries at a time. Of extensions,
50% contact at least two injection libraries, while 30% contact
at least ﬁve. Similarly, 80% of binaries contact at least four
injection libraries. We were unable to identify any extensions
or binaries that contacted easyinline.com, likely due to incom-
plete coverage of software in the wild.
trafﬁc,
B. Dissecting Ad Injection Techniques
1) Extensions: Ad injection extensions rely on the Chrome
permission model [3] to request access to DOM content
and privileged browser resources. We statically analyze the
manifests embedded in each extension to determine which
permissions an extension requests, the details of which ap-
pear in Table V. Permissions consist of a scope as well as
a resource. Of the extensions in our dataset, 100% scope
their privileges to every page a client visits, indicated by
http(s)://*/* or the  scope. This behavior is also
typical of malicious browser extensions [18]. Within this broad
scope, 69% of extensions can potentially prevent uninstallation
7We note that extension side-loading can still occur if the extension is
simultaneously in the Chrome Web Store. The Chrome Web Store team,
however, recently implemented a policy to take action on any extensions that
beneﬁt from installation tactics that deceive the user or otherwise violate the
Unwanted Software Policy.
160160
Apr
Jul
Oct
binary  
extension  
Figure 9: Arrival rate of new extension and binary variants that
perform ad injection from October 2013–October 2014.
Ad Injection Library
superﬁsh.com
api.jollywallet.com
visadd.com
intext.nav-links.com
{crdrdpjs, rvzrjs, ...}.info
ads.tfxiq.com
noproblemppc.com
clkmon.com
datafastguru.info
easyinline.com
Total
Extensions
49,127
19,259
11,843
17,007
16,381
248
18,228
27
4,221
0
50,870
Earliest Trace
Binaries
Sep 09, 2012
33,486
Jul 12, 2013
28,557
Jan 29, 2014
13,763
4,881
Jul 26, 2013
28,574 Mar 04, 2013
1 Mar 16, 2014
Sep 15, 2012
Nov 20, 2013
Dec 16, 2013
–
–
28,972
1
6
0
34,407
Table IV: Breakdown of extensions and binaries performing ad
injection. We obtain tens of thousands of samples for 9 of the top 10
injectors. We denote the earliest date we identify either an extension
or binary contacting an injection library.
by auto-closing tabs directing to chrome://extensions;
54% can access a client’s cookie for any property; and another
52% can monitor the installation of other extensions.
From this list of permissions, we discern that ad injection
rarely occurs via in-browser network interception denoted by
the webRequest permission (5%) or plugin access to install
new DLLs (2%). Instead,
the extensions rely on content
scripts, which are JavaScript ﬁles loaded into a page’s context
after the browser renders a document. Independent of the
delivery mechanism, we ﬁnd that 100% of extensions request
to modify every HTTP and HTTPS page a client visits. With
these privileges, ad injectors add new  elements that
fetch remote copies of the most popular ad injection libraries
into every DOM a client renders. These scripts in turn supply
the logic for adding or replacing advertisements. Consequently,
ad injectors can tamper with any page a client visits.
Extensions performing ad injection have a range of other
behaviors. WebEval ﬂagged 24% for spamming a user’s social
network and 11% for hijacking a user’s search queries. Inde-
pendent of our ad injection analysis, WebEval ﬂagged 38%
as malware. These results highlight the tangled nature of ad
injection afﬁliate programs. Extension authors can bundle ad
injection with any number of other monetization strategies,
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:21 UTC from IEEE Xplore.  Restrictions apply. 
Permission
https://*/*
http://*/*
tabs
cookies
management
webRequest
webNavigation
plugin
Popularity
Description
88% Access all https pages
88% Access all http pages
12% Access all pages, including ftp, data
69% Create or modify tabs
54% Access cookies for permitted sites
52% Control removal of extensions
5% Intercept network requests
3% Notiﬁcations for when pages change
2% Install DLLs or other binary ﬁles
Table V: Sensitive permissions requested by extensions performing
ad injection. Injectors can manipulate any page a client visits, modify
cookies, and prevent uninstallation.
including those traditionally relied on by the malware ecosys-
tem.
2) Binaries: We observe two predominant strategies for
tampering with DOM content via binaries: intercepting net-
work requests and side-loading an extension. Of the binaries
we detect as ad injectors, 86% modify the Window’s registry
key for HKCU\software\microsoft\windows\currentve
rsion\internet\proxyserver to install a proxy. Without
additional support from DLL injection or installing a new
certiﬁcate, this proxy cannot tamper with HTTPS connections.
Regretfully, we cannot discern such granular information for
our current dataset. The remaining 14% of binaries silently
install an extension by modifying the user’s browser proﬁle
stored in google\chrome\userdata\default\preferenc
es.
This ratio is skewed in part by multiple binary versions
distributed by the same author. If we de-duplicate binaries
based on the website hosting the binary, we observe 615
distinct domains in the last year. Of these, 74% serve binaries
that install proxies, while 51% serve binaries that side-load
extensions. As such, we are cautious in drawing conclusions
on whether extension side-loading is secondary to installing
proxies in the wild.
Independent of these behavioral signals, we examine the
labels returned by VirusTotal and Safe Browsing. We ﬁnd that
AVG ﬂagged 62.5% of binaries for search engine hijacking,
while Sophos and Kaspersky ﬂagged 46% and 39% of binaries
respectively as major adware distributors. Not all binaries
restrict their actions to greyware. Safe Browsing ﬂagged 17%
of ad injection binaries for also installing malware. Like
extensions, our results show that ad injectors are often bundled
with a multitude of unwanted and even malicious software.
3) Networks: We have no mechanism to attribute in-transit
ad injection to the ISPs or the network routes involved.
However, we can compare the discrepancy between the level
of ad injection over HTTP versus HTTPS from our client
DOM reports in Section IV. We observe that 4.5% of Google
properties served to users over HTTPS contain traces of
ad injection, compared to 6.1% of HTTP connections. This
represents a 35% increase for unprotected trafﬁc. Two pos-
sible explanations exist for this discrepancy. Either binaries
restrict tampering to HTTP connections because they lack the
161161
technical components required to hook the network stack after
libraries remove encryption—or, alternatively, there is a large
amount of in-transit tampering.
C. Estimating Ad Injection Caused by Extensions
The Chrome Web Store tracks two metrics surrounding
extensions: (1) an extension’s active install base as determined
from update requests sent by Chrome clients (even for exten-
sions not in the ofﬁcial Web Store); and (2) an extension’s
organic installs—the total number of clients that ever installed
the extension directly from the Chrome Web Store or via
trusted UI elements that refer to the Web Store. We refer to all
active install bases with no organic origin as inorganic installs.
These can occur from binaries side loading extensions or users
installing extensions from third-party websites (now defunct
with the Chrome Web Store lockdown where all extensions
must be in the ofﬁcial Web Store). As these install values are
constantly in ﬂux, we measure both as the maximum value
over the lifetime of an extension.
Figure 10 provides a log-scale CDF of the historical max-
imum user base for every extension (many now defunct). We
ﬁnd that 50% of ad injectors never acquired more than 10
active users, while the largest user base for a single extension
totaled over 10.7 million users. If we consider the user base
of each extension to be unique, then a total of 103 million
Chrome users at one point had an ad injector installed. Some
of the most successful ad injection extensions are organic
(1.8% of total extensions); combined, they total 11.3 million
organic installs. The remaining 98.2% of extensions are fueled
by inorganic installs. Our results show that extensions play a
major role in the ad injection ecosystem, but that a secondary
delivery mechanism such as a binary is necessary for their
installation.
D. Taking Action on Live Extensions
If we restrict ourselves to extensions that are currently
active (e.g., not taken down from the Chrome Web Store),
there are 249 ad injection extensions in our dataset impacting
a combined 25 million users. We alerted the Chrome Web
Store to these extensions in the event any violated the Chrome
Web Store policy. Of the extensions, the Chrome Web Store
classiﬁed 192 as deceptive in nature (e.g., violating the Single
Purpose Policy [19]) that affected 14 million users; 6 were
ad injectors that did not violate the Web Store policies and
affected 28K users; 16 developers had since removed the
ad injection component of their extension; and 35 belonged
to developers now suspended for other reasons. Extensions
removed for Single Purpose Policy violations are not immedi-
ately uninstalled from a user’s machine.8 As such, we observe
no immediate impact from the Web Store’s actions on our
client-side measurement of ad injection levels.
8Client-side extensions that violate Single Purpose Policies may be disabled
on users’ machines if a developer fails to make her extension policy-compliant
within a certain time window.
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:02:21 UTC from IEEE Xplore.  Restrictions apply. 
s
n
o
s
n
e
i
t
x
e
f
o
t