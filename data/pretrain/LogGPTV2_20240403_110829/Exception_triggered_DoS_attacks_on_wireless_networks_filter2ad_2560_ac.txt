EAPisnotaspeci(cid:2)cauthenticationmechanism,butitpro-videsaseriesofcommonfunctionsandanegotiationprocessbasedonthedesiredauthenticationmechanism.Currentlyabout40suchmechanisms,calledEAPmethods,aresup-ported.Thosemethodsarede(cid:2)nedinvariousIETFRFCsin-cludingEAP-MD5[9],EAP-OTP[9],EAP-GTC[9],EAP-TLS[29],EAP-TTLS[15],PEAP[8],EAP-IKEv2[30],EAP-SIM[16],EAP-AKA[10],andadditionallyanumberofvendorspeci(cid:2)cmethods.Themostcommonlyusedmeth-odsthataresuitableforoperatinginwirelessnetworksare:PEAP[8],EAP-TLS[29],EAP-TTLS[15],EAP-FAST[12],EAP-SIM[16]andEAP-AKA[10].Figure1showshowthesetypicalEAPprotocolsworkwithotherlayers.EAP-TLS,EAP-TTLS,EAP-FASTandPEAParewidelyusedinWLAN,EAP-SIMisdesignedforGSMsystemsandEAP-AKAisadoptedinUMTS/CDMA2000.Amongthem,EAP-TLS,EAP-TTLS,EAP-FASTandPEAPalluseTLSastheirunderlyingauthenticationandcryptographicmethod.3.1.2TransportLayerSecurity(TLS)TransportLayerSecurity(TLS)[13]anditspredecessor,SecureSocketLayer(SSL)arecryptographicprotocolsthatprovidesecurecom-municationontheInternetforsecurewebbrowsing,e-mail,Internetfaxing,instantmessagingandotherdatatransfers.Theprotocolallowsclient/serverapplicationstocommuni-cateinawaythatisdesignedtopreventeavesdropping,tam-pering,ormessageforgery.Forexample,HTTPSprotocollayersontopofTLSprotocoltoprotectsensitivenetworktraf(cid:2)c.TLSisalayeredprotocol,andconsistsoftheRecordpro-tocol,theAlertprotocolandtheHandshakeprotocol.TheRecordprotocolisdesignedtoservetheHandshakeprotocolandAlertprotocol,andofferssymmetricencryption,dataau-thenticity,andoptionallycompression[13].TheAlertproto-colofferssomesignalingtotheotherprotocolsandbetweenpeers.Analertsignalincludesanalertlevelindication,andaFATALALERTalwaysterminatesthecurrentconnection.TheHandshakeprotocolisresponsiblefortheciphersuitenegotiation,theinitialkeyexchange,andtheauthenticationofthetwopeers.InourattackwemainlyattacktheHand-shakeprotocolbytriggeringthealertmessagesde(cid:2)nedintheAlertprotocol.Figure2showsthe(cid:3)owchartofasuccessfulTLShand-shakeprocess.Wedonotintroducethehandshakeprotocolindetailduetospacelimitation,butthedetailscanbefoundin[13].Generally,theTLSserverstartstheprocedureandtheclientrespondswithahellomessage.Theserverthensendsitscerti(cid:2)cate,selectedciphersuitandsoon.NotethatTLSprovidesanoptiontoauthenticatetheclientaswellbyrequestingtheclientcerti(cid:2)cate.Theclientreturnsselectedcipher,itscerti(cid:2)cate(optional)andothercryptographicin-formation.NoteinFigure2,weputsomemessagescloseasifbundledtogetherbecausetheymaybeembeddedinasingleEAPpacket,dependingonthemessagesizes.3.2VulnerabilityinTLSbasedEAPProtocolsThevulnerabilitywe(cid:2)ndisintheTLSprotocol,whichiswidelyusedinmanysecurityprotocolssuchasHTTPSandTLSbasedEAPprotocols.Therefore,alltheTLSbasedEAPprotocolssuchasPEAP,EAP-TLS,EAP-TTLSandEAP-FASTwillbevulnerabletoourattack.Itisworthmention-ingthatwealsoimplementedthesameattackapproachtar-getingHTTPSprotocolwhichalsoreliesonTLS,andtheat-tacksuccessfullystoppedtheGMailauthenticationusingtheHTTPSprotocol.However,thehardnessofsnif(cid:2)ngandde-cipheringapplicationlayerdatainwiredandencryptedwire-lessnetworksmakessuchapplicationlevelattacknotverypractical.HencewemainlyfocusontheTLSbasedEAPprotocols,whichareMAClayerauthenticationprotocolsforwirelessnetworks.Anattackersniffsthecommunicationbetweenthewire-lessclientandtheaccesspoint,inspectingtheauthentica-tionprocedurethroughtheHandshakeprotocolofTLS.NotebeforethehandshakeprotocolofTLSestablishesthekeystoencryptfollowingpackets,allthewirelesspacketsareinclear-textandunencrypted.Triggeredbysomemessages,theattackerspoofscorrespondingmessagestomaketheTLSau-thenticationfail.Inparticular,theattackerhavetwowaystotriggertheexceptionhandlinginTLS:1)ErrorMessagebasedAttack(cid:150)spoo(cid:2)ngtheFATALALERTmessagestodi-rectlyfooltheclientortheservertostoptheauthentication,2)MisleadingMessagebasedAttack(cid:150)spoo(cid:2)ngnegotiationmessageswithdifferentauthenticationparameterstoconfusethetwoparties.Nextwewilldiscussthedetailedattackap-proaches.3.2.1ErrorMessagebasedAttackSpoo(cid:2)ngServerTheattackercanspoofthemessagesasiftheywerecomingfromtheTLSserver1.ThereareatleasttwoattackpointsintheTLSauthenticationframework:oneisaftertheclientsendingtheCLIENTHELLOandtheotheristhepointafterthebundleofclientresponsemessages(in-cludingCLIENTCERTIFICATE,CLIENTKEYEXCHANGEandothermessages)(SeeFigure3).Ifthebundlesofmes-sagesarebrokenintomultipleEAPpackets,wehavemoreattackpointsaftereachEAPpacket.Theattackstodifferentpointsaresimilarandweusethe(cid:2)rstoneasanexample.Asshownin(cid:2)gure3,iftheat-tackersniffsaCLIENTHELLOmessage,hesimplyspoofsaFATALALERTmessage.TheSERVERHELLOandfurthermessagesfromtheserveraredropped.Theclientconsidersonlythealertmessage,andsendsafailuremessagetotheserver.SincetheTLStransactionhasfailed,theencapsu-latingEAPprotocolterminateswithanEAPFAILUREmes-sage.Animportantprobleminthisattackistosatisfythetimingrequirement.TheattackerneedshisspoofedmessagetoreachtheclientearlierthanthenormalSERVERHELLOmessagefromtheserver(SeeFigure3).Thistimegapcon-tains:1)themessagedeliverytimeinwirednetwork(bothfromtheAPtotheTLSserverandfromtheTLSservertotheAP),2)theserver’sprocessingtimeand3)themessagedeliverytimefromtheAPtotheclientinthewirelessnet-work.Thistimegapmayvaryindifferentsituations.Forexample,atthesecondattackpoint,theserverusuallyneedstoquerythedatabaseandthenverifytheuser’sidentityand1Todoso,weuseAP’sMACaddressasthesourceMACaddressofthespoofedmessagetospooftheAP.NoteEAPprotocolisdirectlyontopoftheMAClayer,andtheIPandhigherlayersarenotusedatthisstage.Therefore,attacksonIPlayersandabovesuchasTCPRSTattackarenotapplicableinthisscenarioatall.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
16
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:48 UTC from IEEE Xplore.  Restrictions apply. 
(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:5)(cid:6)(cid:2)(cid:7)(cid:8)(cid:2)(cid:9)(cid:10)(cid:11)(cid:3)(cid:12)(cid:2)(cid:13)(cid:10)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:20)(cid:2)(cid:21)(cid:22)(cid:2)(cid:23)(cid:18)(cid:24)(cid:19)(cid:13)(cid:25)(cid:2)(cid:5)(cid:26)(cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:12)(cid:4)(cid:13)(cid:5)(cid:6)(cid:2)(cid:7)(cid:8)(cid:2)(cid:9)(cid:10)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:5)(cid:27)(cid:4)(cid:13)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:11)(cid:3)(cid:12)(cid:2)(cid:13)(cid:10)(cid:5)(cid:20)(cid:2)(cid:21)(cid:22)(cid:2)(cid:23)(cid:18)(cid:24)(cid:19)(cid:13)(cid:25)(cid:2)(cid:5)(cid:26)(cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:5)(cid:28)(cid:2)(cid:15)(cid:12)(cid:17)(cid:21)(cid:29)(cid:12)(cid:13)(cid:12)(cid:9)(cid:24)(cid:2)(cid:30)(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:7)(cid:8)(cid:5)(cid:9)(cid:10)(cid:4)(cid:11)(cid:12)(cid:4)(cid:11)(cid:7)(cid:8)(cid:5)(cid:9)(cid:11)(cid:24)(cid:19)(cid:13)(cid:25)(cid:2)(cid:5)(cid:11)(cid:12)(cid:31)(cid:24)(cid:2)(cid:15)(cid:5)(cid:14)(cid:31)(cid:2)(cid:18)(cid:29)(cid:12)(cid:13)(cid:12)(cid:9)(cid:24)(cid:2)(cid:30) (cid:13)(cid:18)(cid:15)(cid:21)(cid:31)(cid:10)(cid:2)(cid:30)(cid:5)(cid:11)(cid:4)(cid:13)(cid:16)(cid:2)(cid:15)(cid:9)(cid:19)(cid:10)(cid:12)(cid:4)(cid:13)(cid:5)(cid:4)(cid:16)(cid:2)(cid:15)(cid:5)!"(cid:14)Figure2:TLSHandshake.(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:5)(cid:6)(cid:2)(cid:7)(cid:8)(cid:2)(cid:9)(cid:10)(cid:11)(cid:3)(cid:12)(cid:2)(cid:13)(cid:10)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:20)(cid:2)(cid:21)(cid:22)(cid:2)(cid:23)(cid:18)(cid:24)(cid:19)(cid:13)(cid:25)(cid:2)(cid:5)(cid:26)(cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:12)(cid:4)(cid:13)(cid:5)(cid:6)(cid:2)(cid:7)(cid:8)(cid:2)(cid:9)(cid:10)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:5)(cid:27)(cid:4)(cid:13)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:11)(cid:3)(cid:12)(cid:2)(cid:13)(cid:10)(cid:5)(cid:20)(cid:2)(cid:21)(cid:22)(cid:2)(cid:23)(cid:18)(cid:24)(cid:19)(cid:13)(cid:25)(cid:2)(cid:5)(cid:26)(cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:5)(cid:28)(cid:2)(cid:15)(cid:12)(cid:17)(cid:21)(cid:29)(cid:12)(cid:13)(cid:12)(cid:9)(cid:24)(cid:2)(cid:30)(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:7)(cid:8)(cid:5)(cid:9)(cid:10)(cid:4)(cid:11)(cid:12)(cid:4)(cid:11)(cid:7)(cid:8)(cid:5)(cid:9)(cid:31)(cid:15)(cid:15)(cid:4)(cid:15)(cid:5) (cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:31)(cid:15)(cid:15)(cid:4)(cid:15)(cid:5) (cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:29)(cid:19)(cid:12)(cid:3)(cid:8)(cid:15)(cid:2)(cid:29)(cid:19)(cid:12)(cid:3)(cid:8)(cid:15)(cid:2)!(cid:10)(cid:10)(cid:19)(cid:18)"(cid:5)#(cid:4)(cid:12)(cid:13)(cid:10)(cid:22)$!(cid:10)(cid:10)(cid:19)(cid:18)"(cid:5)#(cid:4)(cid:12)(cid:13)(cid:10)(cid:22)%Figure3:TLSHandshakefailed-Attackerspoo(cid:2)ngServer.password,andhencetheprocessingtimemaybelarge.Thebackgroundtraf(cid:2)caffectsthetransmittingtimeinbothwire-lessandwirednetworks.Meanwhile,theattacker’sspoo(cid:2)ngtimecontainstwoparts:1)thetimegeneratingthespoofedmessage,whichisnegligibleand2)thetransmittingtimeinthewirelessnetwork.Spoo(cid:2)ngClientSimilarly,theattackercanspooftobetheclient,andtherearealsoatleasttwoattackpointsaccord-ingtotheTLSauthenticationprotocol.AsshowninFig-ure4,the(cid:2)rstattackpointisrightaftertheclientsnif(cid:2)ngtheHELLOREQUESTandtheotherisafterreceivingtheSERVERHELLODONE.AsshowninFigure4,iftheattacker’sFATALALERTmes-sagereachestheserverbeforetheCLIENTHELLOmessage,thenfurthermessagesfromtheclientaredroppedsincetheserverconsidersonlythealertmessageandsendsafailuremessagetotheclientindicatingthedetectionofanerror.ThentheEAPprotocolterminateswithanEAPFAILUREmessage.Thesecondattackpointisquitesimilarandhencewedonotrepeatitsdetails.3.2.2MisleadingMessagebasedAttackBesidesdirectlyspoo(cid:2)ngandsendingerrormessagestode-stroytheTLScommunication,theattackerisalsoabletostealthilyspoofmisleadingmessagesthatintentionallytrig-gertheexceptionhandlingmechanismoftheTLSprotocol.WefoundoutthatusingaspoofedSERVERHELLOmessagewithvariousparametersettingwillcausetheclientsideau-tomaticallyrespondaFATALALERTmessagetotheserverside.ThemessageexchangeprocedureisshownintheFig-ure5.RegardingtotheTLSRFC,theclientsideshouldprovideavalidCLIENTHELLOmessagethatcontainsalistofsupportiveciphersuitesinthe(cid:2)rstplace.AfterthattheserverrespondstotheclientaSERVERHELLOmes-sagethatindicatesitschoiceoftheciphersuite.BesidestheSERVERHELLOmessage,clientsideneedstocollectotherrequiredmessagesbeforemovingforwardtothenextstate,e.g.,SERVERKEY-EXCHANGEmessage.Thereforewhentheattacktakesplace,theclientsidewillreceivetwoSERVERHELLOmessages.Inthatcase,theclientitselfisnotableto(cid:2)gureoutwhichoftheSERVERHELLOmessagesistheauthenticateonethatshouldbeusedinthefollowingpro-cess.ThustheclientsidehastonotifytheserversidethatthereisanerrorhappenedusingtheFATALALERTmessageandeventuallyterminatethewholeprocedure.3.2.3DiscussionComparisonbetweenErrorMessagebasedAttackandMisleadingMessagebasedAttackComparedtothedi-recterrormessagebasedattack,themisleadingmessagebasedattackismorestealthyandhardertodealwith.Iftheunprotectedmessageshavemultipleparameterstochooseorset,thespoofedmessageshavelotsoftrickstoplay.Evenifthereceivernoticestheattackandgetmultiple(cid:147)normal(cid:148)messageswithdifferentcontent,thereceivermaynotbeabletodifferentiatethelegitimatemessagewiththefakedones.Thisbringsthedif(cid:2)cultyincountermeasuresandwewillfur-therdiscussitinSection6.IncreasingtheAttackSuccessRateObviouslyourat-tacksonTLSbasedEAPprotocolssatisfythemediumandprotocolrequirements(seeSection2.1).Theonlypotentialproblemisthetimingrequirement,whichrequirestheattackpackettoreachthevictimearlierthanthelegitimatepacket.Tomaketheattacker’spacketsentouttoairfaster,weplayatrickdescribedbelow.WirelessLANusestheIEEE802.11’sDCF(DistributedCoordinationFunction)[7],whichisbasedonCSMA/CA(CarrierSenseMultipleAccesswithCollisionAvoid-ance).AccordingtothecollisionavoidancemechanismofCSMA/CA,astationperformsaback-offprocedurebeforeinitiatingthetransmissionofaframe.AfterdetectingthatthemediumisidleforaDIFS(DCFinter-framespacing)in-terval,thestationselectsarandombackoffperiodfrom[0,CW-1],whereCWisreferredtoascontentionwindow.Thestationwaitsforthechanneltobeidleforatotaltimeequaltothisback-offperiod,afterwhichitcantransmitadataframe.ThecontentionwindowCWhasaninitialvalueCWMin(31inthestandard),andisdoubledwhenacollisionoccurs,uptothemaximumvalueCWMax.Whenaframeissuccess-fullytransmitted,thecontentionwindowissettoitsinitialvalueCWMin.Tosendpacketfaster,asimplewayisto(cid:2)xtheCWMinandCWMaxtotheminimalnumber.Attackercansetits978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
17
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:48 UTC from IEEE Xplore.  Restrictions apply. 
(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:5)(cid:6)(cid:2)(cid:7)(cid:8)(cid:2)(cid:9)(cid:10)(cid:11)(cid:3)(cid:12)(cid:2)(cid:13)(cid:10)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:20)(cid:2)(cid:21)(cid:22)(cid:2)(cid:23)(cid:18)(cid:24)(cid:19)(cid:13)(cid:25)(cid:2)(cid:5)(cid:26)(cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:12)(cid:4)(cid:13)(cid:5)(cid:6)(cid:2)(cid:7)(cid:8)(cid:2)(cid:9)(cid:10)(cid:14)(cid:2)(cid:15)(cid:16)(cid:2)(cid:15)(cid:5)(cid:1)(cid:2)(cid:3)(cid:3)(cid:4)(cid:5)(cid:27)(cid:4)(cid:13)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:11)(cid:3)(cid:12)(cid:2)(cid:13)(cid:10)(cid:5)(cid:20)(cid:2)(cid:21)(cid:22)(cid:2)(cid:23)(cid:18)(cid:24)(cid:19)(cid:13)(cid:25)(cid:2)(cid:5)(cid:26)(cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:11)(cid:2)(cid:15)(cid:10)(cid:12)(cid:17)(cid:12)(cid:18)(cid:19)(cid:10)(cid:2)(cid:5)(cid:28)(cid:2)(cid:15)(cid:12)(cid:17)(cid:21)(cid:29)(cid:12)(cid:13)(cid:12)(cid:9)(cid:24)(cid:2)(cid:30)(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:7)(cid:8)(cid:5)(cid:9)(cid:10)(cid:4)(cid:11)(cid:12)(cid:4)(cid:11)(cid:7)(cid:8)(cid:5)(cid:9)(cid:31)(cid:15)(cid:15)(cid:4)(cid:15)(cid:5) (cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)!(cid:10)(cid:10)(cid:19)(cid:18)"(cid:5)#(cid:4)(cid:12)(cid:13)(cid:10)(cid:22)$!(cid:10)(cid:10)(cid:19)(cid:18)"(cid:5)#(cid:4)(cid:12)(cid:13)(cid:10)(cid:22)%(cid:31)(cid:15)(cid:15)(cid:4)(cid:15)(cid:5) (cid:2)(cid:9)(cid:9)(cid:19)(cid:25)(cid:2)(cid:29)(cid:19)(cid:12)(cid:3)(cid:8)(cid:15)(cid:2)(cid:29)(cid:19)(cid:12)(cid:3)(cid:8)(cid:15)(cid:2)Figure4:TLSHandshakefailed-Attackerspoo(cid:2)ngClient.Figure5:TLSHandshakefailed-AttackerTriggerExceptions.CWMintobeassmallas1,andinthiscasetheback-offtimeoftheattackerismuchsmallerthanthatofthenormalwirelessnodes.Inthiscase,thechanceofsendingtheattackpacketearlierthanthelegitimatepacketiscloseto1.Inourrealexperiments(SeeSection5.1.1),we(cid:2)ndthatMADWi(cid:2)driver[3]providescommandlineparameterstochangetheCWMinandCWMaxeasily.3.3GeneralizationtoOtherEAPprotocolsTheexceptiontriggeredvulnerabilitydoesnotonlylieinTLSbasedEAPprotocols.Analyzingtheauthenticationpro-tocolsin2Gand3Gcellularnetworks,EAP-SIMandEAP-AKA,wefoundtheyalsopotentiallyhaveasimilarvulnera-bility.InEAP-SIMandEAP-AKA,theEAPNOTIFICATIONmessageisusedtoindicatetheresultandexceptioncases,whichisnotprotectedthroughtheauthenticationprocedure.Thisprotocoldesignofferstheattackeranopportunitytoma-liciouslyusetheEAP-Response/SIM/Client-ErrormessageandEAP-Response/AKA/Client-Errormessagetointerrupttheprocessingbetweenclientsandtheauthenticationserverandfailtheauthenticationprocedure.NotethattheattackonEAP-SIMandEAP-AKAwillworkanalytically,anditwillbeourfutureworktostudyitspracticality.4CaseStudy2:MobileIPv6ReturnRoutabilityProcedureInthissection,wedescribeoursecondcasestudyonMo-bileIPv6ReturnRoutability(RR)procedure.We(cid:2)rstintro-duceMobileIPv6RRprocedure,andthendescribeindetailtheattackprocedure.4.1BackgroundMobileIPv6[18]isaprotocolwhichallowsnodestore-mainreachablewhilemovingaroundintheIPv6Internet.Eachmobilenode(orMNinshort)hasahomeaddress,re-gardlessofitscurrentlocation.Ifthemobilenoderoamstotheremotenetworkwhilecommunicatingwithothernodes(calledCorrespondentNodesorCN),thepacketsfromtheCorrespondentNodesgotothehomenetwork(cid:2)rst.ThesepacketswillbefurtherforwardedtotheMN’saddressintheremotenetwork(calledcare-ofaddress)bytheHomeAgent.ObviouslythistriangularroutingisnotoptimizedandhenceFigure6:MIPv6ReturnRoutabilityprocedure.theReturnRoutabilityprocedureisproposedinMobileIPv6toallowthedirectrouting.Basically,theMobileNodetellsitscare-ofaddresstotheCorrespondentNodes,andthefol-lowingtraf(cid:2)csfromCNsaresenttotheMN’scare-ofaddressdirectly.TheapplicationlayerisnotawareofthechangesoftheIPlayer.TosecuretheReturnRoutabilityprocedure,asimpleweakauthenticationprotocolisused,detailedinthefollowingparagraphs.Figure6showsthemessageexchangeintheReturnRoutabilityprocedure(RRprocedure).TheRRprocedurebeginswhentheMNsendsHOMETESTINIT(HOTI)mes-sagetoCNthroughHAandtheCARE-OFTESTINIT(COTI)messagedirectlytoCN.CNrespondswithaHoTsentthroughHAandaCoTsentdirectlytoMN.MNusestheinformationinHoTandCoTtogenerateakey,whichitusestosigntheBINDINGUPDATEmessagetoCN.Uponthere-ceiptoftheBINDINGUPDATE,CNaddsanentryfortheMNinitsbindingcacheandoptionallysendsBINDINGAC-KNOWLEDGEMENT.Oncethishappens,MNandCNwillbecapableofcommunicatingoveradirectroute.ThustheyneednothavetogothroughtheHAanymoreandhencetheroutebetweenMNandCNisoptimized.4.2VulnerabilitiesinMobileIPv6RRProcedureNowweintroducetwovulnerabilitiesintheMIPv6RRproceduretotheexceptiontriggeredattack:bindingerror978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
18