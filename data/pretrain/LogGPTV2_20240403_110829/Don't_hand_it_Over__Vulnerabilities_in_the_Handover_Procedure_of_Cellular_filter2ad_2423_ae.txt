and 3G (UMTS), and on the special handover cases described in
Section 2.1, since the former would result in a very complex and
unreliable Core Network interworking that includes 2G/3G, and
the latter is not supported by any software so far.
Next, we will present our experimental details for Intra- and
Inter-Base station cases. We assume that the attacker has completed
the reconnaissance and proceeds to the actual exploitation.
6.3 Executing the Attacks
For Intra-Base station cases we used eNodeB/gNodeB 1 cell 2 as a
target while the UE was stationed at eNodeB/gNodeB 1 cell 1 having
a normal connection. Once we configured the malicious station as
cell 2, we launched attacks based on the three distinct scenarios;
data transfer, IMS SIP call, and SMS messages. The callbox was
configured based on the Amarisoft software, while the attacker
used srsLTE and Amarisoft for LTE and only Amarisoft for 5G.
Using two different software whenever possible allowed us to have
a more accurate understanding about UE’s behavior during the
attack.
At the moment of the attack, we increased the signal power of
the false base station while the signal power of cell 1 was slightly
decreased to imitate a handover procedure. To achieve this we used
the command cell_gain. Immediately the UE, not been aware about
the presence of a false cell 2, informed cell 1 through MRs about
a strong signal coming from cell 2. Cell 1 wrongly accepted the
measurements believing that they are related to the legitimate cell 2
and processed them. Figures 9 and 10 show examples of a malicious
MR in LTE and 5G respectively containing false power measure-
ments. Since the attack may achieve a discontinuous transition
ACSAC’21,December6–10,2021,VirtualEvent,USAEvangelosBitsikasandChristinaPöpperanyServiceRequestssentbytheUE,eventhoughwedidnotdetectanysuchmessageduringourexperimentation,sinceanyservicehasbeendroppedbynow.Onthenetworkside,ahandoverfailureoccursbecausetherealtargetcelldidnotcompletetheintendedRACHprocedurewiththeUEandthesourcecelldidnotreceivetheUEContextReleasefromthetargetcell.Eventually,theCoreNetworkmaytransmitpagingmessagestolocatetheuserwhoismissing,hopingforanRLFreportthatwillmatchtheregisteredhandoverfailurebutnotuntiltheUEreconnectstoit.Thereafter,theUEbeginsanewRRCconnectionwiththeroguecellandsendsaNASAttachRequestinordertofreshlyregister(steps11and12).Onceagain,theUE’sfalsetrusthasconsequencesidenticaltoIntra-Basestationcases.Theattackercanforwardmes-sagestoestablishaMitMrelayorrejecttheattachmentforcingaDoSattack.Similarly,privacyissuesarestillpresentastheUEsendssensitiveinformationtotheattackerduringthewholeprocess.5.3SpecialHandoverCasesLikewise,specialhandovercasesaredesignedwiththesamese-curityflaws.InCU-DUhandovercases,theprincipalfactorforatransitionfromasourceCU/DUtoatargetCU/DUisonceagaintheMR[6].AsaDUmaycontroloneormorecellsandthehandoverprocedureremainsthesame,wesuspectthatIntra/Inter-CUandIntra/Inter-DUhandoverscanbeaffectedsimilartotheIntra-andInter-BaseStationhandoverspresentedabove.Conditionalhandovers[10]relyontheUEtomakethedecisiononwhichtargetcellitshouldattachto.ThesourcebasestationprovidesthetriggereventsandthresholdstotheUEviatheRRCReconfigurationmessagewhileitpreparesthecandidatetargetsforapotentialhandover.IftheUEdiscoversatriggereventandasuit-ablecellbasedonitsmeasurements,thenitinitiatestheexecutionphaseofthehandoverandestablishesaconnection.ThismeansthatthisprocessisstillbasedonMRsandsignalpower,thereforewebelievethattheattackscanbecarriedoutinthesamefashionaspreviously.ThedifferencehereistheUEwhichsendsanRRCReconfigurationCompletetothesourcecellrightafterreceivingtheRRCReconfigurationmessageandbeforedisconnection.6EXPERIMENTATION6.1TheSetupAsFigure4shows,oursetupconsistsofcomputer1whichistheAmarisoftCallboxClassic(equippedwithSDRs)[19]withtheEPC/5GCoreNetworkandtheeNodeB/gNodeBrepresentingthele-gitimatenetwork.Inaddition,wehavecomputer2withanotherlegitimateAmarisofteNodeB/gNodeBusingaLenovoThinkpadT580laptopwithUbuntu20.04andanEttusB210USRP[41].ThetwocomputersareconnectedinthesamenetworkviaEthernetandtheircellularinterfacesaresetaccordingtoAmarisoftdoc-umentation.FortheUE,weusedtheOneplus6,AppleiPhone5,SamsungS105GandHuaweiProP405GwithanAnritsusimcard.Furthermore,theattacker’smachinecomprisesaDellLatitudeE5450laptopwithUbuntu20.04andanEttusB210USRPwithatotalcostof2k€.Inoursetup,theattackercanusesrsLTEforLTEcasesandAmarisoftsoftwarefortheLTEand5GcaseswithaCoreNetworkandasingleeNodeB/gNodeB.MoredetailsaboutFigure4:OurexperimentalsetupourcellularnetworkconfigurationsarepresentedinSectionDoftheAppendix.6.2Requirements,Scenarios,TargetHandoversInourexperimentationweemulatedthreescenarioswheretheUEisinRRC-Connectedstateandinteractsnormallywiththenetwork.Thefirstonewasadatatransferthroughiperf[34]assuggestedbytheAmarisoftdocumentation,whilethesecondonewasaregularIPMultimediaSubsystem(IMS)SIPcallserviceandathirdonewastheShortMessageService(SMS).Foriperfwehadtoinitiateaserver/receiveronthenetworksideandaclient/senderontheUEsidewhilethemobiledatawereenabled.Moreover,IMScallswerepossiblethroughtheIMSterminalbycarryingoutthemt_callcommandandSMSmessagesthroughthesmscommand.WeappliedtheabovescenariostoLTE,5GNSAand5GSA,whileusingallfoursmartphonesforLTE,SamsungS10andHuaweiP40for5GNSA,andHuaweiP40for5GSA.Unfortunately,wewerenotabletoexperimentonInter-RATcasesthatinvolve2G(GSM)and3G(UMTS),andonthespecialhandovercasesdescribedinSection2.1,sincetheformerwouldresultinaverycomplexandunreliableCoreNetworkinterworkingthatincludes2G/3G,andthelatterisnotsupportedbyanysoftwaresofar.Next,wewillpresentourexperimentaldetailsforIntra-andInter-Basestationcases.Weassumethattheattackerhascompletedthereconnaissanceandproceedstotheactualexploitation.6.3ExecutingtheAttacksForIntra-BasestationcasesweusedeNodeB/gNodeB1cell2asatargetwhiletheUEwasstationedateNodeB/gNodeB1cell1havinganormalconnection.Onceweconfiguredthemaliciousstationascell2,welaunchedattacksbasedonthethreedistinctscenarios;datatransfer,IMSSIPcall,andSMSmessages.ThecallboxwasconfiguredbasedontheAmarisoftsoftware,whiletheattackerusedsrsLTEandAmarisoftforLTEandonlyAmarisoftfor5G.UsingtwodifferentsoftwarewheneverpossibleallowedustohaveamoreaccurateunderstandingaboutUE’sbehaviorduringtheattack.Atthemomentoftheattack,weincreasedthesignalpowerofthefalsebasestationwhilethesignalpowerofcell1wasslightlydecreasedtoimitateahandoverprocedure.Toachievethisweusedthecommandcell_gain.ImmediatelytheUE,notbeenawareaboutthepresenceofafalsecell2,informedcell1throughMRsaboutastrongsignalcomingfromcell2.Cell1wronglyacceptedthemeasurementsbelievingthattheyarerelatedtothelegitimatecell2ACSAC’21,December6–10,2021,VirtualEvent,USAEvangelosBitsikasandChristinaPöpperanyServiceRequestssentbytheUE,eventhoughwedidnotdetectanysuchmessageduringourexperimentation,sinceanyservicehasbeendroppedbynow.Onthenetworkside,ahandoverfailureoccursbecausetherealtargetcelldidnotcompletetheintendedRACHprocedurewiththeUEandthesourcecelldidnotreceivetheUEContextReleasefromthetargetcell.Eventually,theCoreNetworkmaytransmitpagingmessagestolocatetheuserwhoismissing,hopingforanRLFreportthatwillmatchtheregisteredhandoverfailurebutnotuntiltheUEreconnectstoit.Thereafter,theUEbeginsanewRRCconnectionwiththeroguecellandsendsaNASAttachRequestinordertofreshlyregister(steps11and12).Onceagain,theUE’sfalsetrusthasconsequencesidenticaltoIntra-Basestationcases.Theattackercanforwardmes-sagestoestablishaMitMrelayorrejecttheattachmentforcingaDoSattack.Similarly,privacyissuesarestillpresentastheUEsendssensitiveinformationtotheattackerduringthewholeprocess.5.3SpecialHandoverCasesLikewise,specialhandovercasesaredesignedwiththesamese-curityflaws.InCU-DUhandovercases,theprincipalfactorforatransitionfromasourceCU/DUtoatargetCU/DUisonceagaintheMR[6].AsaDUmaycontroloneormorecellsandthehandoverprocedureremainsthesame,wesuspectthatIntra/Inter-CUandIntra/Inter-DUhandoverscanbeaffectedsimilartotheIntra-andInter-BaseStationhandoverspresentedabove.Conditionalhandovers[10]relyontheUEtomakethedecisiononwhichtargetcellitshouldattachto.ThesourcebasestationprovidesthetriggereventsandthresholdstotheUEviatheRRCReconfigurationmessagewhileitpreparesthecandidatetargetsforapotentialhandover.IftheUEdiscoversatriggereventandasuit-ablecellbasedonitsmeasurements,thenitinitiatestheexecutionphaseofthehandoverandestablishesaconnection.ThismeansthatthisprocessisstillbasedonMRsandsignalpower,thereforewebelievethattheattackscanbecarriedoutinthesamefashionaspreviously.ThedifferencehereistheUEwhichsendsanRRCReconfigurationCompletetothesourcecellrightafterreceivingtheRRCReconfigurationmessageandbeforedisconnection.6EXPERIMENTATION6.1TheSetupAsFigure4shows,oursetupconsistsofcomputer1whichistheAmarisoftCallboxClassic(equippedwithSDRs)[19]withtheEPC/5GCoreNetworkandtheeNodeB/gNodeBrepresentingthele-gitimatenetwork.Inaddition,wehavecomputer2withanotherlegitimateAmarisofteNodeB/gNodeBusingaLenovoThinkpadT580laptopwithUbuntu20.04andanEttusB210USRP[41].ThetwocomputersareconnectedinthesamenetworkviaEthernetandtheircellularinterfacesaresetaccordingtoAmarisoftdoc-umentation.FortheUE,weusedtheOneplus6,AppleiPhone5,SamsungS105GandHuaweiProP405GwithanAnritsusimcard.Furthermore,theattacker’smachinecomprisesaDellLatitudeE5450laptopwithUbuntu20.04andanEttusB210USRPwithatotalcostof2k€.Inoursetup,theattackercanusesrsLTEforLTEcasesandAmarisoftsoftwarefortheLTEand5GcaseswithaCoreNetworkandasingleeNodeB/gNodeB.MoredetailsaboutFigure4:OurexperimentalsetupourcellularnetworkconfigurationsarepresentedinSectionDoftheAppendix.6.2Requirements,Scenarios,TargetHandoversInourexperimentationweemulatedthreescenarioswheretheUEisinRRC-Connectedstateandinteractsnormallywiththenetwork.Thefirstonewasadatatransferthroughiperf[34]assuggestedbytheAmarisoftdocumentation,whilethesecondonewasaregularIPMultimediaSubsystem(IMS)SIPcallserviceandathirdonewastheShortMessageService(SMS).Foriperfwehadtoinitiateaserver/receiveronthenetworksideandaclient/senderontheUEsidewhilethemobiledatawereenabled.Moreover,IMScallswerepossiblethroughtheIMSterminalbycarryingoutthemt_callcommandandSMSmessagesthroughthesmscommand.WeappliedtheabovescenariostoLTE,5GNSAand5GSA,whileusingallfoursmartphonesforLTE,SamsungS10andHuaweiP40for5GNSA,andHuaweiP40for5GSA.Unfortunately,wewerenotabletoexperimentonInter-RATcasesthatinvolve2G(GSM)and3G(UMTS),andonthespecialhandovercasesdescribedinSection2.1,sincetheformerwouldresultinaverycomplexandunreliableCoreNetworkinterworkingthatincludes2G/3G,andthelatterisnotsupportedbyanysoftwaresofar.Next,wewillpresentourexperimentaldetailsforIntra-andInter-Basestationcases.Weassumethattheattackerhascompletedthereconnaissanceandproceedstotheactualexploitation.6.3ExecutingtheAttacksForIntra-BasestationcasesweusedeNodeB/gNodeB1cell2asatargetwhiletheUEwasstationedateNodeB/gNodeB1cell1havinganormalconnection.Onceweconfiguredthemaliciousstationascell2,welaunchedattacksbasedonthethreedistinctscenarios;datatransfer,IMSSIPcall,andSMSmessages.ThecallboxwasconfiguredbasedontheAmarisoftsoftware,whiletheattackerusedsrsLTEandAmarisoftforLTEandonlyAmarisoftfor5G.UsingtwodifferentsoftwarewheneverpossibleallowedustohaveamoreaccurateunderstandingaboutUE’sbehaviorduringtheattack.Atthemomentoftheattack,weincreasedthesignalpowerofthefalsebasestationwhilethesignalpowerofcell1wasslightlydecreasedtoimitateahandoverprocedure.Toachievethisweusedthecommandcell_gain.ImmediatelytheUE,notbeenawareaboutthepresenceofafalsecell2,informedcell1throughMRsaboutastrongsignalcomingfromcell2.Cell1wronglyacceptedthemeasurementsbelievingthattheyarerelatedtothelegitimatecell2907Don’t hand it Over: Vulnerabilities in the Handover Procedure of Cellular Telecommunications
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
to the false cell in many cases, multiple MRs to the network with
bogus measurements, RRC Reestablishment and Reconfiguration
messages may be exchanged before the disconnection.
Eventually, the UE was forced to disconnect from the legitimate
base station station and attached to the attacker. We configured
the attacker to respond with reject messages whenever the UE was
sending RRC Reestablishment Requests, TAU Requests or Service
Requests, while allowing RRC Connection Setup Requests. Fur-
thermore, an RRC Connection Release was used to force the UE
into sending Attach Request without fully disconnecting from the
attacker.
In the end, the UE attempted to attach to the false base station
with an Attach Request. As a consequence, not only the UEs re-
vealed sensitive information, but also there were indications of
MitM attacks. Therefore, the attacker could establish a MitM relay
between the UE and the Core Network. The way to perform this
task is to have an SDR that emulates an eNodeB/gNodeB towards
the affected UE and another SDR that emulates the UE towards the
Core Network as presented in [44]. Alternatively, the attacker can
still DoS the UE in this scenario as well by responding with NAS
Attach Rejects. We observed that after a few NAS Attach Reject
messages the UE was completely deprived of services remaining in
a DoS state.
For Inter-Base station testing, we further separated this category
into Intra-RAT and Inter-RAT handovers according to our prior
classification in Section 2.1. The setup for Intra-RAT handovers,
which consist of X2, S1, Xn and N2 types, contained the source
and the target cell that were placed on different base stations, thus
different computers. The UE was stationed in cell 1 and tried to
transition from cell 1 to cell 3. Hence, the attacker tried to abuse the
handover by emulating cell 3. Whereas for Inter-RAT handovers,
Amarisoft software allowed us to run an LTE cell 1 and 5G NR cell 2
in computer
. These cells had
a separate virtual base station while an EPS fallback was possible
through handover. The attacks were executed in the same manner
as for Inter-Base station cases. Figure 11 shows the exploited EPS
fallback on the Core Network and RAN.
without the need for computer
6.4 Traffic Variations due to Service & UE
Model
We tested the handovers on data transfer, IMS call and SMS sce-
narios and we observed varied UE behaviors. In theory, services
with causes such as mo-VoiceCall, mo-Signaling, mo-Data, mo-SMS
belong equally to a zero Access Identity (AI) which is below the
Priority Access. However, an interrupted IMS SIP call was perceived
more important by the UEs, since they immediately tried to recover
the call by quickly attaching to the false base station. During the
first RRC Setup messages (step 7 in Figures 2 and 3) UEs sent many
RRC Setup Requests with cause mo-VoiceCall, while in other cases
like data transfer with a cause mo-Data and SMS exchange with
a cause mo-SMS a more relaxed behavior was observed. Figure 7
(Appendix) shows an RRC Setup Request with mo-VoiceCall as
cause during the attack.
Likewise, through experimentation we realized that not all smart-
phones behave the same. Therefore, the attacks may not only de-
pend on the service but also on the smartphone model. The next
Table 2: Device Specifications and Results. All devices have
IMS & Internet as configured APNs.
Chipset
Huawei
Device
Huawei
P40 Pro 5G Kirin 990 5G 10
One Plus 6
Model
OS
Android ELS-NX9
Samsung
Note 10 5G 845
Apple
iPhone 5
Apple A6
(32 nm)
Snapdragon Android One Plus
855
Snapdragon Android SM-N976Q
A6000
10
10
iOS 10
A1428
Release
2020
2019
2018
2012
MitM Sus-
ceptibility
DoS Sus-
ceptibility
High
High
Medium
Medium
High
High
High
High
sections describe our equipment more thoroughly and Table 2
shows the smartphone specifications. Huawei P40 had a tendency
to quickly establish a balanced connection during the attack (on
LTE and 5G), especially in case of a voice call. Therefore, a MitM
was more effective apart from an Attacker-initiated DoS. Oneplus 6
presented similar behavior, even though it produced a few unstable
connections that made it susceptible to a UE-initiated DoS. Finally,
Samsung S10 and iPhone 5 showed more instability since in every
scenario they were more adamant to hold the connection with the
source cell.
6.5 Countermeasures
There is a plethora of research works [23, 24, 36, 38–40, 51] that
investigate the detection capabilities of the network and UE trying
to determine the best indicators that when combined will reveal the
presence of a false base station. However, these conventional detec-
tion mechanisms as mobile application or network listeners cannot
prevent handover attacks, since the UE is not capable of enforcing
security measures against malicious base station by itself and since
the attack will probably be detected after its completion. On the
contrary, the attacker can leverage these applications with his/her
malicious UE to assist his/her network reconnaissance. On the other
hand, we believe that a combination of enriched measurement re-
ports [4, 8, 11, 37] by placing the detection at the preparation phase
of the handover, Public Key Infrastructure to sign the broadcast
messages [49] and encrypted system queries (they reveal if the
current base station possesses the AS Security Context proving its
legitimacy) [4] before every reconnection attempt constitute for a
resilient handover procedure.
6.6 Ethical Considerations
Our experiments were carried out in an isolated environment with-
out affecting other users, legitimate services, or real operators. Also
due to the pandemic, the surrounding areas were empty, while the
experimentation range was confined within 10 meters.
7 IMPACT OF THE ATTACK
The presented handover attacks can impact both the UE and the
network. We elaborate on their impact as follows.
ACSAC’21,December6–10,2021,VirtualEvent,USAEvangelosBitsikasandChristinaPöpperanyServiceRequestssentbytheUE,eventhoughwedidnotdetectanysuchmessageduringourexperimentation,sinceanyservicehasbeendroppedbynow.Onthenetworkside,ahandoverfailureoccursbecausetherealtargetcelldidnotcompletetheintendedRACHprocedurewiththeUEandthesourcecelldidnotreceivetheUEContextReleasefromthetargetcell.Eventually,theCoreNetworkmaytransmitpagingmessagestolocatetheuserwhoismissing,hopingforanRLFreportthatwillmatchtheregisteredhandoverfailurebutnotuntiltheUEreconnectstoit.Thereafter,theUEbeginsanewRRCconnectionwiththeroguecellandsendsaNASAttachRequestinordertofreshlyregister(steps11and12).Onceagain,theUE’sfalsetrusthasconsequencesidenticaltoIntra-Basestationcases.Theattackercanforwardmes-sagestoestablishaMitMrelayorrejecttheattachmentforcingaDoSattack.Similarly,privacyissuesarestillpresentastheUEsendssensitiveinformationtotheattackerduringthewholeprocess.5.3SpecialHandoverCasesLikewise,specialhandovercasesaredesignedwiththesamese-curityflaws.InCU-DUhandovercases,theprincipalfactorforatransitionfromasourceCU/DUtoatargetCU/DUisonceagaintheMR[6].AsaDUmaycontroloneormorecellsandthehandoverprocedureremainsthesame,wesuspectthatIntra/Inter-CUandIntra/Inter-DUhandoverscanbeaffectedsimilartotheIntra-andInter-BaseStationhandoverspresentedabove.Conditionalhandovers[10]relyontheUEtomakethedecisiononwhichtargetcellitshouldattachto.ThesourcebasestationprovidesthetriggereventsandthresholdstotheUEviatheRRCReconfigurationmessagewhileitpreparesthecandidatetargetsforapotentialhandover.IftheUEdiscoversatriggereventandasuit-ablecellbasedonitsmeasurements,thenitinitiatestheexecutionphaseofthehandoverandestablishesaconnection.ThismeansthatthisprocessisstillbasedonMRsandsignalpower,thereforewebelievethattheattackscanbecarriedoutinthesamefashionaspreviously.ThedifferencehereistheUEwhichsendsanRRCReconfigurationCompletetothesourcecellrightafterreceivingtheRRCReconfigurationmessageandbeforedisconnection.6EXPERIMENTATION6.1TheSetupAsFigure4shows,oursetupconsistsofcomputer1whichistheAmarisoftCallboxClassic(equippedwithSDRs)[19]withtheEPC/5GCoreNetworkandtheeNodeB/gNodeBrepresentingthele-gitimatenetwork.Inaddition,wehavecomputer2withanotherlegitimateAmarisofteNodeB/gNodeBusingaLenovoThinkpadT580laptopwithUbuntu20.04andanEttusB210USRP[41].ThetwocomputersareconnectedinthesamenetworkviaEthernetandtheircellularinterfacesaresetaccordingtoAmarisoftdoc-umentation.FortheUE,weusedtheOneplus6,AppleiPhone5,SamsungS105GandHuaweiProP405GwithanAnritsusimcard.Furthermore,theattacker’smachinecomprisesaDellLatitudeE5450laptopwithUbuntu20.04andanEttusB210USRPwithatotalcostof2k€.Inoursetup,theattackercanusesrsLTEforLTEcasesandAmarisoftsoftwarefortheLTEand5GcaseswithaCoreNetworkandasingleeNodeB/gNodeB.MoredetailsaboutFigure4:OurexperimentalsetupourcellularnetworkconfigurationsarepresentedinSectionDoftheAppendix.6.2Requirements,Scenarios,TargetHandoversInourexperimentationweemulatedthreescenarioswheretheUEisinRRC-Connectedstateandinteractsnormallywiththenetwork.Thefirstonewasadatatransferthroughiperf[34]assuggestedbytheAmarisoftdocumentation,whilethesecondonewasaregularIPMultimediaSubsystem(IMS)SIPcallserviceandathirdonewastheShortMessageService(SMS).Foriperfwehadtoinitiateaserver/receiveronthenetworksideandaclient/senderontheUEsidewhilethemobiledatawereenabled.Moreover,IMScallswerepossiblethroughtheIMSterminalbycarryingoutthemt_callcommandandSMSmessagesthroughthesmscommand.WeappliedtheabovescenariostoLTE,5GNSAand5GSA,whileusingallfoursmartphonesforLTE,SamsungS10andHuaweiP40for5GNSA,andHuaweiP40for5GSA.Unfortunately,wewerenotabletoexperimentonInter-RATcasesthatinvolve2G(GSM)and3G(UMTS),andonthespecialhandovercasesdescribedinSection2.1,sincetheformerwouldresultinaverycomplexandunreliableCoreNetworkinterworkingthatincludes2G/3G,andthelatterisnotsupportedbyanysoftwaresofar.Next,wewillpresentourexperimentaldetailsforIntra-andInter-Basestationcases.Weassumethattheattackerhascompletedthereconnaissanceandproceedstotheactualexploitation.6.3ExecutingtheAttacksForIntra-BasestationcasesweusedeNodeB/gNodeB1cell2asatargetwhiletheUEwasstationedateNodeB/gNodeB1cell1havinganormalconnection.Onceweconfiguredthemaliciousstationascell2,welaunchedattacksbasedonthethreedistinctscenarios;datatransfer,IMSSIPcall,andSMSmessages.ThecallboxwasconfiguredbasedontheAmarisoftsoftware,whiletheattackerusedsrsLTEandAmarisoftforLTEandonlyAmarisoftfor5G.UsingtwodifferentsoftwarewheneverpossibleallowedustohaveamoreaccurateunderstandingaboutUE’sbehaviorduringtheattack.Atthemomentoftheattack,weincreasedthesignalpowerofthefalsebasestationwhilethesignalpowerofcell1wasslightlydecreasedtoimitateahandoverprocedure.Toachievethisweusedthecommandcell_gain.ImmediatelytheUE,notbeenawareaboutthepresenceofafalsecell2,informedcell1throughMRsaboutastrongsignalcomingfromcell2.Cell1wronglyacceptedthemeasurementsbelievingthattheyarerelatedtothelegitimatecell2ACSAC’21,December6–10,2021,VirtualEvent,USAEvangelosBitsikasandChristinaPöpperanyServiceRequestssentbytheUE,eventhoughwedidnotdetectanysuchmessageduringourexperimentation,sinceanyservicehasbeendroppedbynow.Onthenetworkside,ahandoverfailureoccursbecausetherealtargetcelldidnotcompletetheintendedRACHprocedurewiththeUEandthesourcecelldidnotreceivetheUEContextReleasefromthetargetcell.Eventually,theCoreNetworkmaytransmitpagingmessagestolocatetheuserwhoismissing,hopingforanRLFreportthatwillmatchtheregisteredhandoverfailurebutnotuntiltheUEreconnectstoit.Thereafter,theUEbeginsanewRRCconnectionwiththeroguecellandsendsaNASAttachRequestinordertofreshlyregister(steps11and12).Onceagain,theUE’sfalsetrusthasconsequencesidenticaltoIntra-Basestationcases.Theattackercanforwardmes-sagestoestablishaMitMrelayorrejecttheattachmentforcingaDoSattack.Similarly,privacyissuesarestillpresentastheUEsendssensitiveinformationtotheattackerduringthewholeprocess.5.3SpecialHandoverCasesLikewise,specialhandovercasesaredesignedwiththesamese-curityflaws.InCU-DUhandovercases,theprincipalfactorforatransitionfromasourceCU/DUtoatargetCU/DUisonceagaintheMR[6].AsaDUmaycontroloneormorecellsandthehandoverprocedureremainsthesame,wesuspectthatIntra/Inter-CUandIntra/Inter-DUhandoverscanbeaffectedsimilartotheIntra-andInter-BaseStationhandoverspresentedabove.Conditionalhandovers[10]relyontheUEtomakethedecisiononwhichtargetcellitshouldattachto.ThesourcebasestationprovidesthetriggereventsandthresholdstotheUEviatheRRCReconfigurationmessagewhileitpreparesthecandidatetargetsforapotentialhandover.IftheUEdiscoversatriggereventandasuit-ablecellbasedonitsmeasurements,thenitinitiatestheexecutionphaseofthehandoverandestablishesaconnection.ThismeansthatthisprocessisstillbasedonMRsandsignalpower,thereforewebelievethattheattackscanbecarriedoutinthesamefashionaspreviously.ThedifferencehereistheUEwhichsendsanRRCReconfigurationCompletetothesourcecellrightafterreceivingtheRRCReconfigurationmessageandbeforedisconnection.6EXPERIMENTATION6.1TheSetupAsFigure4shows,oursetupconsistsofcomputer1whichistheAmarisoftCallboxClassic(equippedwithSDRs)[19]withtheEPC/5GCoreNetworkandtheeNodeB/gNodeBrepresentingthele-gitimatenetwork.Inaddition,wehavecomputer2withanotherlegitimateAmarisofteNodeB/gNodeBusingaLenovoThinkpadT580laptopwithUbuntu20.04andanEttusB210USRP[41].ThetwocomputersareconnectedinthesamenetworkviaEthernetandtheircellularinterfacesaresetaccordingtoAmarisoftdoc-umentation.FortheUE,weusedtheOneplus6,AppleiPhone5,SamsungS105GandHuaweiProP405GwithanAnritsusimcard.Furthermore,theattacker’smachinecomprisesaDellLatitudeE5450laptopwithUbuntu20.04andanEttusB210USRPwithatotalcostof2k€.Inoursetup,theattackercanusesrsLTEforLTEcasesandAmarisoftsoftwarefortheLTEand5GcaseswithaCoreNetworkandasingleeNodeB/gNodeB.MoredetailsaboutFigure4:OurexperimentalsetupourcellularnetworkconfigurationsarepresentedinSectionDoftheAppendix.6.2Requirements,Scenarios,TargetHandoversInourexperimentationweemulatedthreescenarioswheretheUEisinRRC-Connectedstateandinteractsnormallywiththenetwork.Thefirstonewasadatatransferthroughiperf[34]assuggestedbytheAmarisoftdocumentation,whilethesecondonewasaregularIPMultimediaSubsystem(IMS)SIPcallserviceandathirdonewastheShortMessageService(SMS).Foriperfwehadtoinitiateaserver/receiveronthenetworksideandaclient/senderontheUEsidewhilethemobiledatawereenabled.Moreover,IMScallswerepossiblethroughtheIMSterminalbycarryingoutthemt_callcommandandSMSmessagesthroughthesmscommand.WeappliedtheabovescenariostoLTE,5GNSAand5GSA,whileusingallfoursmartphonesforLTE,SamsungS10andHuaweiP40for5GNSA,andHuaweiP40for5GSA.Unfortunately,wewerenotabletoexperimentonInter-RATcasesthatinvolve2G(GSM)and3G(UMTS),andonthespecialhandovercasesdescribedinSection2.1,sincetheformerwouldresultinaverycomplexandunreliableCoreNetworkinterworkingthatincludes2G/3G,andthelatterisnotsupportedbyanysoftwaresofar.Next,wewillpresentourexperimentaldetailsforIntra-andInter-Basestationcases.Weassumethattheattackerhascompletedthereconnaissanceandproceedstotheactualexploitation.6.3ExecutingtheAttacksForIntra-BasestationcasesweusedeNodeB/gNodeB1cell2asatargetwhiletheUEwasstationedateNodeB/gNodeB1cell1havinganormalconnection.Onceweconfiguredthemaliciousstationascell2,welaunchedattacksbasedonthethreedistinctscenarios;datatransfer,IMSSIPcall,andSMSmessages.ThecallboxwasconfiguredbasedontheAmarisoftsoftware,whiletheattackerusedsrsLTEandAmarisoftforLTEandonlyAmarisoftfor5G.UsingtwodifferentsoftwarewheneverpossibleallowedustohaveamoreaccurateunderstandingaboutUE’sbehaviorduringtheattack.Atthemomentoftheattack,weincreasedthesignalpowerofthefalsebasestationwhilethesignalpowerofcell1wasslightlydecreasedtoimitateahandoverprocedure.Toachievethisweusedthecommandcell_gain.ImmediatelytheUE,notbeenawareaboutthepresenceofafalsecell2,informedcell1throughMRsaboutastrongsignalcomingfromcell2.Cell1wronglyacceptedthemeasurementsbelievingthattheyarerelatedtothelegitimatecell2908ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Evangelos Bitsikas and Christina Pöpper
7.1 Impact on the UE
UE’s inability to recognize a malicious from a genuine network,
insecure broadcast messages and the unverified MRs give the at-
tacker the chance to exploit the handover procedure. Taking this
into account, the attacker has two options; either let the messages
fail or respond with reject messages to DoS the user, or forward
the messages to the real network to establish a MitM relay.
In the former case, the attacker can lock the UE in a complete
DoS state while it will remain camped at the false cell. As a conse-
quence, the user will lose its connection to the network and any
available service (calls, internet connection, etc). Moreover, through
the several attempts to recover the connection and due to state
transitions (from Registered to Deregistered and vice versa, from
RRC-Connected to RRC-Idle/Inactive and vice versa), its battery
life will drain and its power consumption will increase.
On the other hand, the harmful effects of a MitM relay, in which
UE traffic could be monitored and altered, has already been ex-
amined by past works. A MitM can lead to loss of confidentiality,
integrity and to information leakage. For instance, an attacker may
launch additional attacks by downgrading to a vulnerable 2G/3G
connection or leveraging unprotected RRC and NAS messages to
get sensitive data (e. g., IMSI, IMEI) as in [31, 35, 42]. Furthermore,
modifying messages and manipulating the user-plane traffic [43, 44]
might also be possible after UE reattachment to the genuine net-
work. Of course, all these scenarios require the attacker to be able
to sufficiently reach the UE while it moves and to have sufficient
time to execute them.
It should also be noted that the attacker does not possess neither
the AS nor the NAS Security Context, thus he/she cannot repli-
cate legitimate services. Eventually, the UE will reattach to the
network as normal and send an RLF report including the spoofed
eNodeB/gNodeB IDs that caused the failure. Nevertheless, we con-
sider handover attacks a highly critical security concern that may