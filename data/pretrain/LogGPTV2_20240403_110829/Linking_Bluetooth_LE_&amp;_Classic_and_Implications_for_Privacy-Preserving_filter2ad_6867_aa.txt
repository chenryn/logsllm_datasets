title:Linking Bluetooth LE &amp; Classic and Implications for Privacy-Preserving
Bluetooth-Based Protocols
author:Norbert Ludant and
Tien Dang Vo-Huu and
Sashank Narain and
Guevara Noubir
2
0
1
0
0
.
1
2
0
2
.
1
0
0
0
4
P
S
/
9
0
1
1
.
0
1
:
I
O
D
|
E
E
E
I
1
2
0
2
©
0
0
.
1
3
$
/
1
2
/
5
-
4
3
9
8
-
1
8
2
7
-
1
-
8
7
9
|
)
P
S
(
y
c
a
v
i
r
P
d
n
a
y
t
i
r
u
c
e
S
n
o
m
u
i
s
o
p
m
y
S
E
E
E
I
1
2
0
2
2021 IEEE Symposium on Security and Privacy (SP)
Linking Bluetooth LE & Classic and Implications
for Privacy-Preserving Bluetooth-Based Protocols
Norbert Ludant
Tien D. Vo-Huu
Sashank Narain
Guevara Noubir
Northeastern University
Northeastern University
University of Massachusetts Lowell
Northeastern University
Boston, USA
Boston, USA
Lowell, USA
Boston, USA
PI:EMAIL
PI:EMAIL
sashank PI:EMAIL
PI:EMAIL
Abstract—Bluetooth Low Energy advertisements are increas-
ingly used for proximity privacy-preserving protocols. We in-
vestigate information leakage from BLE advertisements. Our
analysis, among other things, reveals that the design of today’s
Bluetooth chips enables the linking of BLE advertisements
to Bluetooth Classic (BTC) frames, and to a globally unique
identiﬁer (BDADDR). We demonstrate that the inference of the
BDADDR from BLE advertisements is robust achieving over 90%
reliability across apps, mobile devices, density of devices, and
tens of meters away from the victims. We discuss the impli-
cations of current chipsets vulnerability on privacy-preserving
protocols. The attack, for instance, reveals the BDADDR of
devices of infected users of contact-tracing apps. We also discuss
how the vulnerability can lead to de-anonymization of victims.
Furthermore, current mobile devices do not allow selective
disabling of BTC independently of BLE which renders simple
countermeasures impractical. We developed several mitigations
for the Android OS and the Bluetooth stack and demonstrate
their efﬁcacy.
Index Terms—Bluetooth, BLE, Privacy, Linkage attacks, Con-
tact Tracing, Exposure Notiﬁcation, Apple Find My
I. INTRODUCTION
Mobile and wireless systems have revolutionized how we
access and share information. However, this success has come
with increased concerns about user privacy. For instance, users
are increasingly aware and concerned about the implications of
disclosure of location information [1]. Similarly, governments
and legislators have increased their scrutiny as illustrated by
the US Congress Location Privacy Protection Act
[2].
Protecting users privacy is known to be challenging as
private information can leak through numerous channels [3]–
[7]. As such, protections should take into account a variety
of adversarial models. Today, most wireless communications
systems have adopted security protocols with encryption,
integrity protection, and even forward security features. How-
ever, the linkability of communications remains an important
challenge. Linkability of communications can not only enable
tracking, but also used as a crucial stepping stone for more
sophisticated attacks. For instance, once a single (linkable)
message reveals a private information about a user, it can
then be associated with the device, its mobility patterns, and
other linked-information collected or inferred by an adversary.
Over the years, wireless systems increased their defenses
against linkability. Cellular systems as early as GSM intro-
duced the Temporary Mobile Subscriber Identiﬁer (TMSI) to
minimize leakage of the globally unique and permanent Inter-
national Mobile Subscriber Identiﬁer (IMSI). Later generations
introduced further protections leading to the 5G design not
sending permanent identiﬁers in the clear and instead relying
on the Subscriber Concealed Identiﬁer (SUCI) consisting of
the permanent SUPI encrypted (IND-CPA) with the public key
of the cellular operator [8]. Mobile platforms also recognized
the risks associated with linkability and potential attacks.
For instance, Android, and iOS rely on Wi-Fi MAC address
randomization to prevent leakage and continue to improve
their security in light of discovered vulnerabilities [9].
We investigate and demonstrate the linkability of BLE
advertisements to a global identiﬁer (BDADDR) that permits
both the tracking of BLE users, and linking of their device to
any information learned directly or indirectly from advertise-
ments. In the context of contact tracing apps, the adversary
learns the BDADDR of infected user devices and the de-
anonymization of such users is possible in some scenarios. In
case of Apple Find My, it is possible to link transient public
keys generated by the protocol to user identiﬁers. Our analysis
reveals that the design of today’s Bluetooth chips enables
(1) the linking between BLE advertisement frames emanating
from a mobile device, and (2) more critically, the linking
of BLE advertisements to Bluetooth Classic (BTC) frames.
This Bluetooth stack vulnerability is fundamental because both
BLE and BTC are driven by the same clock with a timeslot
duration of 625µs. A detailed analysis enables us to develop
and demonstrate an inference technique that links BLE adver-
tisements to devices globally unique BDADDR with over 90%
reliability across apps and density of devices. We ﬁnd that the
inference is over 70% reliable even for distances of 40 meters
or higher and in mobility scenarios. Furthermore, the fact that
current mobile devices do not allow selective disabling of
BTC independently of BLE renders simple countermeasures
impractical. We developed several mitigations for Android
OS and Bluetooth stack and demonstrate their efﬁcacy. In
summary, we:
• Discovered a linking vulnerability in the design of Blue-
tooth chips, that leads to attacks on privacy-preserving
protocols relying on BLE advertisements.
• Analyze the performance of the attack on Android and
iOS devices, in terms of accuracy and speed considering
different apps, devices, density of neighboring devices,
© 2021, Norbert Ludant. Under license to IEEE.
DOI 10.1109/SP40001.2021.00102
1318
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:26:04 UTC from IEEE Xplore.  Restrictions apply. 
• Our analysis indicates that
distance to target, and types of existing Bluetooth trafﬁc.
the attack is robust. For
instance at a distance of 10 meters, an attacker can link
BLE advertisements to the globally unique BDADDR
with 77% probability within 1 second of snifﬁng and with
100% probability within 10 seconds of snifﬁng.
• We show the implications on privacy-preserving protocols
(e.g., linking transient public keys in Apple Find My to
BDADDR, or exposing the BDADDR of infected users
in contact tracing) and discuss scenarios that can lead to
de-anonymization.
• We devise and implement several mitigation techniques
for Android to limit the attack’s potential. We plan to
open source all of our code.
• We responsibly disclosed the attack and proposed mit-
igations to Google, Apple, and contact tracing systems
designers. Google assigned severity S2 to the vulnerabil-
ity, and Apple is evaluating the impact of this attack.
II. BACKGROUND: BLUETOOTH AND BLE
PRIVACY-PRESERVING PROTOCOLS
Bluetooth protocols were developed over two decades lead-
ing to several backward compatible standards. We focus
on the latest conﬁguration supported by a vast majority of
mobile devices, the Basic Rate (BR) and Low Energy (LE)
combined core conﬁguration [10]. A BR system includes
optional Enhanced Data Rate (EDR) and Alternate Media
Access Control and Physical (AMP) layer extensions. These
protocols are typically referred to as Bluetooth Classic (BTC).
Bluetooth Low Energy (BLE) on the other hand aims at
minimizing energy consumption. These modes serve unique
needs, optimising for energy, bit-rate, and range. However,
their physical and MAC layers share common characteristics
that prove key to the cross-mode side channel vulnerability. We
ﬁrst provide an overview of the two prominent modes, BTC
and BLE, focusing on the mechanisms enabling the attack.
A. Bluetooth Classic (BTC) Overview
BTC operates in the 2.4GHz ISM band, spanning 80MHz.
The physical layer uses a Gaussian Frequency Shift Keying
(GFSK) modulation (BR mode), and π/4-DQPSK or 8DPSK
(EDR mode). The modulated signal is transmitted at a symbol
rate of 1Msym/s, thus providing a bit-rate of 1Mbps (BR
mode) and 2Mbps or 3Mbps (EDR mode). Signals are trans-
mitted in 79 relatively narrow band channel spaced by 1MHz.
The center frequency ranges from 2.4GHz to 2.4835GHz.
The channels are determined by their center frequency fk =
(2402 + k) MHz, k ∈ [0, 78] where k is the channel index. A
channel is divided into slots of 625µs. BTC uses frequency
hopping to mitigate interference and selective fading. A BTC
packet might
last 1 to 5 timeslots but always starts in a
synchronized way with the 625µs period (see Figure 1).
BTC communicating devices form a network topology
called piconet, consisting of a master and up to seven slaves.
The master determines the channel hopping pattern and time
slots schedule. Therefore, time synchronization is required at
1: Bluetooth Classic
using TDD
Fig.
Scheme (src.
[10]). Packets can span multiple slots but
are always synchronized to a 625µs period set by the master.
transmissions
Fig. 2: BLE advertising events over multiple advertisement
channels (src. [10]).