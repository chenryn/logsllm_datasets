# Title: Linking Bluetooth LE & Classic and Implications for Privacy-Preserving Bluetooth-Based Protocols

## Authors:
- Norbert Ludant
- Tien D. Vo-Huu
- Sashank Narain
- Guevara Noubir

## Affiliations:
- Northeastern University, Boston, USA
- University of Massachusetts Lowell, Lowell, USA

## Abstract
Bluetooth Low Energy (BLE) advertisements are increasingly used in proximity privacy-preserving protocols. This paper investigates the information leakage from BLE advertisements. Our analysis reveals that the design of current Bluetooth chips enables the linking of BLE advertisements to Bluetooth Classic (BTC) frames and to a globally unique identifier (BDADDR). We demonstrate that inferring the BDADDR from BLE advertisements is highly reliable, achieving over 90% accuracy across various apps, mobile devices, and device densities, even at distances of tens of meters. We discuss the implications of this vulnerability on privacy-preserving protocols, such as the exposure of BDADDRs of infected users in contact-tracing apps and the de-anonymization of victims. Additionally, we highlight that current mobile devices do not allow selective disabling of BTC independently of BLE, making simple countermeasures impractical. We have developed several mitigations for the Android OS and the Bluetooth stack and demonstrated their efficacy.

## Index Terms
- Bluetooth
- BLE
- Privacy
- Linkage Attacks
- Contact Tracing
- Exposure Notification
- Apple Find My

## I. Introduction
Mobile and wireless systems have revolutionized how we access and share information, but this success has come with increased concerns about user privacy. For instance, users are increasingly aware and concerned about the implications of location information disclosure [1]. Similarly, governments and legislators have heightened their scrutiny, as illustrated by the US Congress Location Privacy Protection Act [2].

Protecting user privacy is challenging due to the numerous channels through which private information can leak [3]–[7]. Therefore, protections must consider a variety of adversarial models. While most wireless communication systems now adopt security protocols with encryption, integrity protection, and forward security features, the linkability of communications remains a significant challenge. Linkability can enable tracking and serve as a stepping stone for more sophisticated attacks. For example, once a single (linkable) message reveals private information about a user, it can be associated with the device, its mobility patterns, and other linked information collected or inferred by an adversary.

Over the years, wireless systems have enhanced their defenses against linkability. Cellular systems, starting with GSM, introduced the Temporary Mobile Subscriber Identifier (TMSI) to minimize the leakage of the globally unique and permanent International Mobile Subscriber Identifier (IMSI). Later generations further improved these protections, leading to the 5G design, which does not send permanent identifiers in the clear and instead relies on the Subscriber Concealed Identifier (SUCI), consisting of the permanent SUPI encrypted (IND-CPA) with the public key of the cellular operator [8]. Mobile platforms also recognize the risks associated with linkability and potential attacks. For example, Android and iOS use Wi-Fi MAC address randomization to prevent leakage and continue to improve their security in light of discovered vulnerabilities [9].

In this work, we investigate and demonstrate the linkability of BLE advertisements to a global identifier (BDADDR), which permits both the tracking of BLE users and the linking of their device to any information learned directly or indirectly from advertisements. In the context of contact tracing apps, an adversary can learn the BDADDR of infected user devices, enabling de-anonymization in some scenarios. For Apple's Find My feature, it is possible to link transient public keys generated by the protocol to user identifiers. Our analysis reveals that the design of today's Bluetooth chips enables (1) the linking between BLE advertisement frames emanating from a mobile device, and (2) more critically, the linking of BLE advertisements to Bluetooth Classic (BTC) frames. This Bluetooth stack vulnerability is fundamental because both BLE and BTC are driven by the same clock with a timeslot duration of 625µs. A detailed analysis enabled us to develop and demonstrate an inference technique that links BLE advertisements to devices' globally unique BDADDR with over 90% reliability across apps and device densities. The inference is over 70% reliable even at distances of 40 meters or higher and in mobility scenarios. Furthermore, the fact that current mobile devices do not allow selective disabling of BTC independently of BLE renders simple countermeasures impractical. We have developed several mitigations for the Android OS and Bluetooth stack and demonstrated their efficacy.

In summary, our contributions include:
- Discovering a linking vulnerability in the design of Bluetooth chips that leads to attacks on privacy-preserving protocols relying on BLE advertisements.
- Analyzing the performance of the attack on Android and iOS devices, considering different apps, devices, neighboring device densities, distance to target, and types of existing Bluetooth traffic.
- Demonstrating that the attack is robust, with a 77% probability of linking BLE advertisements to the globally unique BDADDR within 1 second of sniffing and 100% probability within 10 seconds at a distance of 10 meters.
- Showing the implications on privacy-preserving protocols, such as linking transient public keys in Apple Find My to BDADDR or exposing the BDADDR of infected users in contact tracing, and discussing scenarios that can lead to de-anonymization.
- Devising and implementing several mitigation techniques for Android to limit the attack's potential, with plans to open-source all of our code.
- Responsibly disclosing the attack and proposed mitigations to Google, Apple, and contact tracing system designers. Google assigned severity S2 to the vulnerability, and Apple is evaluating the impact of this attack.

## II. Background: Bluetooth and BLE Privacy-Preserving Protocols
Bluetooth protocols have been developed over two decades, leading to several backward-compatible standards. We focus on the latest configuration supported by a vast majority of mobile devices, the Basic Rate (BR) and Low Energy (LE) combined core configuration [10]. A BR system includes optional Enhanced Data Rate (EDR) and Alternate Media Access Control and Physical (AMP) layer extensions, typically referred to as Bluetooth Classic (BTC). Bluetooth Low Energy (BLE) aims to minimize energy consumption. These modes serve unique needs, optimizing for energy, bit-rate, and range. However, their physical and MAC layers share common characteristics that prove key to the cross-mode side-channel vulnerability. We first provide an overview of the two prominent modes, BTC and BLE, focusing on the mechanisms enabling the attack.

### A. Bluetooth Classic (BTC) Overview
BTC operates in the 2.4GHz ISM band, spanning 80MHz. The physical layer uses Gaussian Frequency Shift Keying (GFSK) modulation (BR mode) and π/4-DQPSK or 8DPSK (EDR mode). The modulated signal is transmitted at a symbol rate of 1Msym/s, providing a bit-rate of 1Mbps (BR mode) and 2Mbps or 3Mbps (EDR mode). Signals are transmitted in 79 relatively narrowband channels spaced by 1MHz. The center frequency ranges from 2.4GHz to 2.4835GHz. The channels are determined by their center frequency \( f_k = (2402 + k) \) MHz, where \( k \in [0, 78] \) is the channel index. A channel is divided into slots of 625µs. BTC uses frequency hopping to mitigate interference and selective fading. A BTC packet might last 1 to 5 timeslots but always starts in a synchronized way with the 625µs period (see Figure 1).

BTC communicating devices form a network topology called a piconet, consisting of a master and up to seven slaves. The master determines the channel hopping pattern and time slots schedule. Therefore, time synchronization is required at transmissions (Figure 1).

**Figure 1: Bluetooth Classic using TDD Scheme (src. [10]).** Packets can span multiple slots but are always synchronized to a 625µs period set by the master.

**Figure 2: BLE advertising events over multiple advertisement channels (src. [10]).**

---

This revised version provides a more structured and professional presentation of the research, with clear and concise language.