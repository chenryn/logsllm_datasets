All your family secrets belong to us -
Worrisome security issues in tracker apps
Siegfried Rasthofer | Fraunhofer SIT, Germany
Stephan Huber | Fraunhofer SIT, Germany 
DefCon26, August 11th 2018
Who are we?
§ Head of Department Secure Software 
Engineering
§ PhD, M.Sc., B.Sc. in computer science 
§ Static and Dynamic Code Analysis
§ Founder of @TeamSIK and @CodeInspect
§ Security Researcher @Testlab Mobile 
Security
§ Code Analysis Tool development 
§ IOT Stuff
§ Founder of @TeamSIK
Siegfried
Stephan
2
Who are we?
§ Head of Department Secure Software 
Engineering
§ PhD, M.Sc., B.Sc. in computer science 
§ Static and Dynamic Code Analysis
§ Founder of @TeamSIK and @CodeInspect
§ Security Researcher @Testlab Mobile 
Security
§ Code Analysis Tool development 
§ IOT Stuff
§ Founder of @TeamSIK
Siegfried
Stephan
(creds to: Alex, Daniel, Julien, Julius, Michael, Philipp, Steven, Kevin, Sebald, Ben)
3
Team
4
Beer Announcement
5
Agenda
6
§ Introduction/Motivation
§ Background Information
§ Bad Client-Side Checks with SharedPreferences
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
Agenda
7
§ Introduction/Motivation
§ Background Information
§ Bad Client-Side Checks with SharedPreferences
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
Surveillance - Then
1960: Radio receiver inside pipe
1960: Camera inside a pack of cigarettes
1970: Microphone inside a dragonfly
1990: Microphone inside a fake catfish
* Source: http://www.businessinsider.com/
8
Surveillance - Now
9
Sypware/RAT
Surveillance - Now
10
Benign Reasons?
Sypware/RAT
Surveillance - Now
11
Benign Reasons?
Family
Couple
Friends
Good vs. Bad
12
Family
Couple
Friends
Sypware/RAT
Surveillance - Apps
13
Google PlayStore
Android Security Report 2017
Surveillance - Apps
14
Google PlayStore
*Android Security Report 2017
15
How well are the tracking data protected?
16
App Name
GooglePlay Downloads
Couple1Tracker1App
5-101m
My1Family1GPS1Tracker
KidControll GPS1Tracker
Rastrear Celular Por el1Numero
Phone1Tracker1By1Number
Couple1Vow
Real1Time1GPS1Tracker
Ilocatemobile
1-5m
Family1Locator1(GPS)
Free1Cell1Tracker
Rastreador de1Novia
Phone1Tracker1Free
Phone1Tracker1Pro
Rastreador de1Celular Avanzado
100-500k
Rastreador de1Novia
Localiser un1Portable1avec1son1Numero
50-100k
Handy1Orten per1Handynr
10-50k
Track1My1Family
1k
17
App Name
GooglePlay Downloads
Couple1Tracker1App
5-101m
My1Family1GPS1Tracker
KidControll GPS1Tracker
Rastrear Celular Por el1Numero
Phone1Tracker1By1Number
Couple1Vow
Real1Time1GPS1Tracker
Ilocatemobile
1-5m
Family1Locator1(GPS)
Free1Cell1Tracker
Rastreador de1Novia
Phone1Tracker1Free
Phone1Tracker1Pro
Rastreador de1Celular Avanzado
100-500k
Rastreador de1Novia
Localiser un1Portable1avec1son1Numero
50-100k
Handy1Orten per1Handynr
10-50k
Track1My1Family
1k
Takeaways
18
It is very easy to…
§ Enable premium features without paying
§ Access highly sensitive data of a person
§ Perform mass surveillance in real-time
Agenda
19
§ Introduction/Motivation
§ Background Information
§ Bad Client-Side Checks with SharedPreferences
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
How does it work? – Very simple
20
push
Observer
Monitored Person
pull
Tracking Provider
(backend/cloud)
What kind of data?
21
push
Observer
Monitored Person
pull
What kind of data?
22
push
Observer
Monitored Person
pull
Attack Vectors
23
push
Observer
Monitored Person
pull
Attack Vectors
24
push
Observer
Monitored Person
pull
Attack Vectors
25
push
Observer
Monitored Person
pull
Agenda
26
§ Introduction/Motivation
§ Background Information
§ Bad Client-Side Checks with SharedPreferences
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
101
27
1. Authentication Request
2. Authorization Request
WTF?
28
1. Request Data
2. Client-Side “Authorization”
WTF 1/4 – Enable Premium Features
29
WTF 1/4 – Enable Premium Features
30
N = com.google.android.gms.ads.g;
if(!this.n.getBoolean("l_ads", false)) {
...
} else {
this.N.setVisibility(View.GONE);
}
WTF 1/4 – Enable Premium Features
31
/data/data/com.bettertomorrowapps.spyyourlovefree/
shared_prefs/loveMonitoring.xml
N = com.google.android.gms.ads.g;
if(!this.n.getBoolean("l_ads", false)) {
...
} else {
this.N.setVisibility(View.GONE);
}
SharedPreferences Backup/Restore
§ Rooted1device:
1. copy1loveMonitoring.xml from1app1folder1to1pc
2. modify1file,1set1false1to1true
3. copy1back1and1overwrite1orig.1file1with1modified1file
§ Unrooted1device:
adb backup
adb restore
convert *
modify file
*https://github.com/nelenkov/android-backup-extractor
adb tool
WTF 1/4 – Enable Premium Features
33
/data/data/com.bettertomorrowapps.spyyourlovefree/
shared_prefs/loveMonitoring.xml
WTF 1/4 – Enable Premium Features
34
/data/data/com.bettertomorrowapps.spyyourlovefree/
shared_prefs/loveMonitoring.xml
WTF 1/4 – Enable Premium Features
35
1. Give me all SMS messages
WTF 1/4 – Enable Premium Features
36
1. Give me all SMS messages
2. Ok: SMS1, SMS2, SMS3, …
WTF 1/4 – Enable Premium Features
37
1. Give me all SMS messages
3. Client “Authorization” Check
if(getBoolean(“l_sms_full”) == false) {
String[] sms = getAllSMS();
…
singleSMS = sms[i].substring(0, 50);
}
else {
//return complete sms
}
2. Ok: SMS1, SMS2, SMS3, …
WTF 1/4 – Enable Premium Features
38
1. Give me all SMS messages
2. Ok: SMS1, SMS2, SMS3, …
3. Client “Authorization” Check
if(getBoolean(“l_sms_full”) == false) {
String[] sms = getAllSMS();
…
singleSMS = sms[i].substring(0, 50);
}
else {
//return complete sms
}
WTF 2/4 – Admin Privileges
39
• App1supports1two1modes:
• parent1(controller/administration)1
• children1(monitored)
• Administrator1can1create1new1Administrators
• Administrator1can1monitor1all1children
WTF 2/4 – Admin Privileges
40
• App1supports1two1modes:
• parent1(controller/administration)1
• children1(monitored)
• Administrator1can1create1new1Administrators
• Administrator1can1monitor1all1children
????
WTF 2/4 – Admin Privileges
41
• App1supports1two1modes:
• parent1(controller/administration)1
• children1(monitored)
• Administrator1can1create1new1Administrators
• Administrator1can1monitor1all1children
WTF 3/4 - Remove Lockscreen
42
WTF 3/4 - Remove Lockscreen
43
§ After1app1start1the1lock1screen1asks1for1pin
????
Remove Lockscreen
44
§ After1app1start1the1lock1screen1asks1for1pin
§ To1remove1the1lock1screen,1change1SharedPreferencevalue1from1
true to1false
WTF 4/4 – Authentication Bypass
45
§ Same1works with login,1no password required
46
Do not use SharedPreferences for 
authorization checks!!
Agenda
47
§ Introduction/Motivation
§ Background Information
§ Bad Client-Side Checks with SharedPreferences
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
DATA
DATA
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
DATA
DATA
DATA
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
DATA
DATA
DATA
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
DATA
DATA
DATA
Mitm Attack 101
user/app
tracking provider
(backend/cloud)
DATA
DATA
DATA
Mitm Attack 101
user/app