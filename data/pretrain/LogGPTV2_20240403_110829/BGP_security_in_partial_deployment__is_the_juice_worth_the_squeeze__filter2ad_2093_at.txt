[43] A. Pilosov and T. Kapela. Stealing the Internet: An
Internet-scale man in the middle attack, 2008.
DEFCON’16.
[44] Reuters. Internet providers pledge anti-botnet eﬀort, March
22 2012.
[45] M. Roughan, W. Willinger, O. Maennel, D. Perouli, and
R. Bush. 10 lessons from 10 years of measuring and
modeling the internet’s autonomous systems. JSAC,
29(9):1810–1821, 2011.
[46] R. Sami, M. Schapira, and A. Zohar. Searching for stability
in interdomain routing. In INFOCOM’09, 2009.
[47] Sandvine. Fall 2012 global internet phenomena, 2012.
[48] K. Sriram. BGPSEC design choices and summary of
supporting discussions. Internet-Draft:
draft-sriram-bgpsec-design-choices-03, January 2013.
[49] R. White. Deployment considerations for secure origin BGP
(soBGP). draft-white-sobgp-bgp-deployment-01.txt, June
2003, expired.
[50] D. Wing and A. Yourtchenko. Happy eyeballs: Trending
towards success with dual-stack hosts. Internet draft:
draft-wing-v6ops-happy-eyeballs-ipv6-01, October 2010.
APPENDIX
A. MORE COLLATERAL DAMAGE
Figure 14 revealed that collateral damages can be caused
by secure ASes that choose long secure paths. When security
is 1st, collateral damages can also be caused by secure ASes
that choose expensive secure paths:
Figure 17. We show how AS 4805, Orange Business
in Oceania, suﬀers from collateral damage when security
is 1st. On the left, we show the network prior to S*BGP
deployment. Orange Business AS4805 learns two routes:
a legitimate route through its peer Optus Communications
AS 7474, and a bogus route through its provider AS 2647.
Since AS 4805 prefers peer routes over provider routes per
our LP rule, it will choose the legitimate route and avoid the
attack. On the right, we show what happens after S*BGP
deployment. Now, Optus Communications AS 7474 has
started using a secure route. However, this secure route
is through its provider AS 7473. Observe that AS 7474 is
no longer willing to announce a route to its peer AS 4805
as this would violate the export policy Ex. AS 4805 is now
left with the bogus provider route through AS 2647, and
becomes unhappy as collateral damage.
B. COMPUTING ROUTING OUTCOMES
Below we present algorithms for computing S*BGP rout-
ing outcomes in the presence of an attacker (per Section 3.1),
in each of our three S*BGP routing models. These algo-
rithms receive as input an attacker-destination pair (m, d)
and the set of secure ASes S and output the S*BGP rout-
ing outcome (in each of our three S*BGP routing mod-
els). We point out that our algorithms can also be used
to compute routes during normal conditions (when there
is no attacker m = ∅), and when no AS is secure S =
∅.
In these algorithms, which extend the algorithmic ap-
proach used in [19, 20, 22] to handle partial S*BGP deploy-
ment in the presence the adversary described in Section 3.1,
we carefully construct a partial two-rooted routing tree by
performing multi-stage breadth-ﬁrst-search (BFS) computa-
tions with d and m as the two roots. We prove the correct-
ness of our algorithms (that is, that they indeed compute
the desired S*BGP routing outcomes) in Appendix B.5. In
subsequent sections, we show how to use these algorithms
to partition ASes into doomed/immune/protectable nodes,
to determine which ASes are happy, or experience protocol
downgrade attacks for a given (m, d)-pair and deployment
S.
B.1 Notation and preliminaries.
Since BGP (and S*BGP) sets up routes to each destina-
tion independently, we focus on routing to a unique desti-
nation d. We say that a route is legitimate if it does not
contain the attacker m (either because there is no attacker
m = ∅ or because the attacker is not on the route). We
say that a route is attacked otherwise. Observe that in the
presence of an attacker m launching the attack of Section 3,
all attacked routes have m as the ﬁrst hop following d. We
use the following deﬁnition of “perceivable routes” from [36].
Figure 17: Collateral damages; security 1st.
NON MONTONICITY EXAMPLE, SECURITY FIRSTVictim 40426 Pandora,  Attacker Iranian ISP 12880, tokens:  t2_100_cp_stub4805“EQUANT‐OCEANIA Orange Business AS for Oceania region coveringand New‐Zealand countries “AS7474 ASN‐OPTUS‐NET Optus Communications ‐‐Jonesboro, Arkansas, 4805103104042610026747374741747715412m26477922NON MONTONICITY EXAMPLE, SECURITY FIRSTVictim 40426 Pandora,  Attacker Iranian ISP 12880, tokens:  t2_100_cp_stub4805“EQUANT‐OCEANIA Orange Business AS for Oceania region coveringand New‐Zealand countries “AS7474 ASN‐OPTUS‐NET Optus Communications ‐‐Jonesboro, Arkansas, 4805103104042610026747374741747715412m26477922XDefinition B.1
(Perceivable routes). A simple (loop-
free) route R = {vi−1, . . . , v1, d} is perceivable at AS vi if
one of the two following conditions holds:
1. R is legitimate (so v1 (cid:54)= m), and for every 0 < j < i it
follows that vj announcing the route (vj, . . . , d) to vj+1
does not violate Ex.