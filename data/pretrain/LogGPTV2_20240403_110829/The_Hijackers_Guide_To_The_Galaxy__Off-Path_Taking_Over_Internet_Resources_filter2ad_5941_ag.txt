tutes 93% of the address space assigned to the accounts in
our dataset. Even the weaker attack methodologies (FragDNS
and SadDNS), which do not require controlling a BGP router,
allow the adversaries to take over 59% of the address space.
Similarly, 74% of the ASNs are associated with the accounts
that can be hijacked via any of the DNS cache poisoning at-
tacks in Section 4 and 30% with the SadDNS or FragDNS
attack. The difference between the vulnerability volume for
IP addresses and ASNs is due to the fact that large parts of
the IPv4 address space is owned by a small number of ASes,
e.g., 21% of the assigned IPv4 address space is attributed to
the top 10 LIR accounts.
Domain resources. We use our domain-to-account map-
ping to determine user accounts at registrars. This includes
11% of the accounts for which we were able to extract cus-
tomer account information. We believe however that the frac-
tion of the vulnerable accounts is representative of all the
1M-top Alexa domains since the vulnerabilities only depend
on the nameservers of the customers’ domains. Our study
shows that 65% of the domains could be hijacked via any
of HijackDNS, SadDNS or FragDNS, while 35% could be
hijacked via SadDNS or FragDNS.
9These can be collected via a dictionary attack against the provider: the
adversary inputs usernames and checks for error messages. Such a study
however creates a signiﬁcant load on the infrastructure of the provider.
HijackDNS SadDNS FragDNS Any
SadDNS or
FragDNS
IP addresses
Domains
81%
47%
30%
10%
51%
27%
93%
65%
59%
35%
Table 6: Vulnerable resources mapped to accounts in our dataset.
Countermeasure
Layer
DNS
IP
DNS
IP
IP
2-FA TAN with out-of-band notif. Web portal
2-FA login
Web portal
IP-level account access restrictions Web portal
DNSSEC signing and validation
Disable/Patch ICMP rate-limit
Disable NS rate-limit
Disable PMTUD
Blocking Fragments
MTA-STS [RFC8461]
Hide public account details
Request rate-limiting
Captchas
Separate systems
Resolver hardening
Non-predictable IPID increment
Out-of-band notiﬁcations
Web portal
Web portal
Web portal
Email
General
Web portal
DNS
IP
S
N
D
k
c
a
j
i
S
N
D
D
a
S
S
N
D
g
a
r
F
Provider- /
Customer-
side
both
both
H
both1
  
provider   
  
  
provider
  
customer
  
customer   
provider   
  
  
provider   
provider   
provider   
provider   
customer   
provider   
both
both
Table 7: Countermeasures against different types of attackers. 1: requires the
user to verify the out-of-band delivered transaction details before entering
the TAN.
8 Recommendations for Countermeasures
The fundamental problem that our attacks outline is the
stealthiness and ease with which the adversaries can apply
changes and manipulations over the Internet resources of
providers of digital resources. Since Internet resources form
the foundations for the stability and security of democratic
societies, our work calls for a revision of the current prac-
tices of resource management and development of techniques
that would secure the transactions over the Internet resources.
For instance, selling Internet blocks should not happen im-
mediately, and should require more than merely a scanned
document over Email (which is easy to fake). In addition to
the standard recommendations for hardening the DNS caches
or blocking ICMP error messages, which we summarised in
Table 7, we also provide recommendations for best practices
for providers and customers.
Separate system for high privileged users. Currently,
any user can create an account with most of the providers. The
accounts can be used for managing Internet resources (high
privileged) as well as for registering for events or mailing lists
(low privileged). Low privileged accounts in the user manage-
ment system have access to the same infrastructure (Email
servers, DNS resolvers, etc) as the high privileged accounts,
such as those of network operators. This enables adversaries
to open low privileged accounts and use them to collect infor-
mation about the infrastructure of the provider. The providers
3162    30th USENIX Security Symposium
USENIX Association
Deploy captchas. Our study shows that most providers
do not use captchas, e.g., three out of ﬁve RIRs do not use
captchas. Although captchas do not prevent the attack, they
force the attacker to run manual tests making the attack more
expensive to launch. Resolving the captchas is tedious and
burdensome for the attacker (as well as for the researchers) to
carry out in contrast to automated study of the victims. For
instance, for studying vulnerabilities in DNS caches and for
performing cache poisoning attacks we needed to run multiple
password recovery procedures for triggering DNS requests to
our domain. This study could not be automated in RIRs that
use captchas.
Notiﬁcations of modiﬁcations. Changes performed over
the resources of providers either do not generate any notiﬁca-
tions or generate notiﬁcations to the Email conﬁgured in the
compromised account. First, the Email notiﬁcations will be re-
ceived by our adversary, since it hijacked the victim domains
in the resolver of the provider, and second, the adversary can
change the contact Email in the account, and even disable
notiﬁcations. The accounts with providers should be associ-
ated with contact Email which cannot be changed through the
account and which is different than the one used to access the
account.
should use separate user management systems and a separate
set of servers for users which own digital resources vs. users
that, e.g., are registered to mailing lists or events.
Two-factor authentication. Two factor authentication (2-
FA) systems must be enabled by default. The two authentica-
tion factors must be independent of each other and an attacker
should not be able to compromise both factors within a single
attack. This for instance, rules out Email-based 2-FA for pass-
word recovery which is available at some of the providers we
tested.
Email address masking. The Email addresses in the
whois records of the domains should be masked. Some of the
domain registrars are already following this practice.
Account level IP address access restriction. The regis-
trars should restrict account access to only few static IP ad-
dresses belonging to the domain’s owner.
Deploy DNSSEC. DNSSEC ([RFC4033] to [RFC4035])
would essentially make the attack methodologies in Section 4
practically impossible. Unfortunately, only 3.78% domains
of customers of RIRs and 5.88% domains of customers of
registrars are correctly signed. For instance, out of 1832 LIR
domains under AFRINIC, only 58 are signed, and 27 of these
domains are still vulnerable since the DNS resolvers cannot
establish a chain of trust to them from the root anchor. Fur-
ther, 12 use weak cryptographic keys (below 512 bits) and
12 use weak (vulnerable) hash functions. The remaining 95
domains out of those 1832 domains were not responsive. Un-
fortunately, even when the domain is signed and the resolver
validates DNSSEC, as long as the human factor is in the loop,
there is risk for vulnerabilities and misconﬁgurations, [12,42].
Hence we recommend that the providers and customers de-
ploy additional measures that we list in this section to harden
their infrastructure.
9 Conclusions
Each provider maintains a database that deﬁnes which cus-
tomer owns which Internet resources and offers tools for the
customers to manage their resources. We showed that these
databases are poorly protected - the adversaries can take over
the accounts for managing the Internet resources and can
manipulate the databases, e.g., creating new or removing ex-
isting objects - stealthily and causing immediate changes to
the customers’ resources.
For our attacks we used different DNS cache poisoning
methodologies and compared their applicability and effective-
ness for taking over accounts. Our work shows that while chal-
lenging, our attacks are practical and can be applied against
infrastructure of a large fraction of the resource providers
to hijack accounts. Our results demonstrate feasibility even
with weak off-path adversaries. Certainly, accounts asso-
ciated with Internet resources are an attractive target also
for stronger Man-in-the-Middle adversaries, such as cyber-
criminal groups or nation state attackers.
We described countermeasures for mitigating our off-path
attacks for taking over the accounts of customers. Addressing
the fundamental problem - easy manipulation of the Internet
resources - requires creating policies and revising the Internet
management infrastructure as well as techniques for securing
the transactions applied over Internet resources.
Acknowledgements
This work has been co-funded by the German Federal Min-
istry of Education and Research and the Hessen State Min-
istry for Higher Education, Research and Arts within their
joint support of the National Research Center for Applied
Cybersecurity ATHENE and by the Deutsche Forschungsge-
meinschaft (DFG, German Research Foundation) SFB 1119.
References
[1] ripe-720: Ipv4 address allocation and assignment policies for the ripe
ncc service region. https://www.ripe.net/publications/docs/ripe-720.
Accessed: 2019-6-13.
[2] BGPStream by CAIDA. https://bgpstream.caida.org/, July 2016.
[3] The CAIDA AS Relationships Dataset. http://www.caida.org/data/as-
relationships/, January 2016.
[4] Louis Poinsignon. BGP leaks and cryptocurrencies, 2018.
[5] F. Alharbi, J. Chang, Y. Zhou, F. Qian, Z. Qian, and N. Abu-Ghazaleh.
Collaborative client-side dns cache poisoning attack. In IEEE INFO-
COM 2019 - IEEE Conference on Computer Communications, 2019.
[6] Maria Apostolaki, Aviv Zohar, and Laurent Vanbever. Hijacking bitcoin:
Routing attacks on cryptocurrencies. In 2017 IEEE Symposium on
Security and Privacy (SP), pages 375–392. IEEE, 2017.
[7] Dan J. Bernstein. DNS Forgery. http://cr.yp.to/djbdns/forgery.html,
November 2002.
USENIX Association
30th USENIX Security Symposium    3163
[8] Henry Birge-Lee, Yixin Sun, Anne Edmundson, Jennifer Rexford, and
Prateek Mittal. Bamboozling certiﬁcate authorities with BGP. In 27th
USENIX Security Symposium (USENIX Security 18), 2018.
[9] Henry Birge-Lee, Liang Wang, Daniel McCarney, Roland Shoemaker,
Jennifer Rexford, and Prateek Mittal. Experiences deploying multi-
vantage-point domain validation at let’s encrypt. December 2020.
[10] Peter Boothe, James Hiebert, and Randy Bush. Short-lived preﬁx
hijacking on the internet. In Proc. of the NANOG, 36, 2006.
[11] Markus Brandt, Tianxiang Dai, Amit Klein, Haya Shulman, and
Michael Waidner. Domain Validation++ For MitM-Resilient PKI. In
Proceedings of the 2018 ACM SIGSAC Conference on Computer and
Communications Security, pages 2060–2076. ACM, 2018.
[12] Taejoong Chung, Roland van Rijswijk-Deij, Balakrishnan Chan-
drasekaran, David Choffnes, Dave Levin, Bruce M Maggs, Alan Mis-
love, and Christo Wilson. A longitudinal, end-to-end view of the dnssec
ecosystem. In USENIX Security, 2017.
[13] Taejoong Chung, Roland van Rijswijk-Deij, David Choffnes, Dave
Levin, Bruce M Maggs, Alan Mislove, and Christo Wilson. Under-
standing the role of registrars in dnssec deployment. In Proceedings of
the 2017 Internet Measurement Conference, pages 369–383, 2017.
[14] Tianxiang Dai, Philipp Jeitner, Haya Shulman, and Michael Waidner.
From IP to Transport and Beyond: Cross-Layer Attacks Against Appli-
cations. In SIGCOMM ’21: Proceedings of the 2021 Annual conference
of the ACM Special Interest Group on Data Communication on the
applications, technologies, architectures, and protocols for computer
communication, Virtual Event, USA, August, 2021. ACM, 2021.
[15] Chris C Demchak and Yuval Shavitt. China’s maxim–leave no access
point unexploited: The hidden story of china telecom’s bgp hijacking.
Military Cyber Affairs, 3(1):7, 2018.
[16] Doug Madory. Recent Routing Incidents: Using BGP to Hijack DNS
and more, 2018.
[17] Amir Herzberg and Haya Shulman. Security of Patched DNS.
In
Computer Security - ESORICS 2012 - 17th European Symposium on
Research in Computer Security, Pisa, Italy, September 10-12, 2012.
Proceedings, pages 271–288, 2012.
[18] Amir Herzberg and Haya Shulman. Fragmentation Considered Poi-
sonous: or one-domain-to-rule-them-all.org. In IEEE CNS 2013. The
Conference on Communications and Network Security, Washington,
D.C., U.S. IEEE, October 2013.
[19] Tomas Hlavacek, Italo Cunha, Yossi Gilad, Amir Herzberg, Ethan Katz-
Bassett, Michael Schapira, and Haya Shulman. Disco: Sidestepping
rpki’s deployment barriers. In Network and Distributed System Security
Symposium (NDSS), 2020.
[20] Tomas Hlavacek, Amir Herzberg, Haya Shulman, and Michael Waid-
ner. Practical experience: Methodologies for measuring route origin
validation. In 48th Annual IEEE/IFIP International Conference on
Dependable Systems and Networks, DSN 2018, Luxembourg City, Lux-
embourg, June 25-28, 2018, pages 634–641, 2018.
[21] P Hoffman and P McManus. Rfc 8484: Dns queries over https (doh),
2018.
[22] Z Hu, L Zhu, J Heidemann, A Mankin, D Wessels, and P Hoffman. Rfc
7858-speciﬁcation for dns over transport layer security (tls), 2016.
[23] P. Jeitner, H. Shulman, and M. Waidner. the impact of dns insecurity
on time. In 2020 50th Annual IEEE/IFIP International Conference on
Dependable Systems and Networks (DSN).
[24] Philipp Jeitner and Haya Shulman. Injection Attacks Reloaded: Tun-
nelling Malicious Payloads over DNS. In 30th USENIX Security Sym-
posium (USENIX Security 21). USENIX Association, August 2021.
[25] Josh Aas and Daniel McCarney and and Roland Shoemaker. Multi-
Perspective Validation Improves Domain Validation Security, 2020.
[26] Dan Kaminsky. It’s the End of the Cache As We Know It. Presentation
at Blackhat Brieﬁngs, 2008.
[27] Josh Karlin, Stephanie Forrest, and Jennifer Rexford. Autonomous
security for autonomous systems. Computer Networks, 52(15), 2008.
[28] Varun Khare, Qing Ju, and Beichuan Zhang. Concurrent preﬁx hi-
jacks: Occurrence and impacts. In Proceedings of the 2012 Internet
Measurement Conference, pages 29–36. ACM, 2012.
[29] Amit Klein. Bind 9 dns cache poisoning. Report, Trusteer, Ltd, 3, 2007.
[30] Amit Klein. Windows dns server cache poisoning,”, 2007.
[31] Amit Klein. Cross layer attacks and how to use them (for dns cache
poisoning, device tracking and more). arXiv:2012.07432, 2020.
[32] Aanchal Malhotra and Sharon Goldberg. Attacking NTP’s Authenti-
cated Broadcast Mode. ACM SIGCOMM Computer Communication
Review, 46(1):12–17, May 2016.
[33] Keyu Man, Zhiyun Qian, Zhongjie Wang, Xiaofeng Zheng, Youjun
Huang, and Haixin Duan. DNS Cache Poisoning Attack Reloaded:
Revolutions with Side Channels. In Proceedings of the 2020 ACM
SIGSAC Conference on Computer and Communications Security, 2020.
[34] Carolyn Duffy Marsan. Six worst internet routing attacks, 2009.
[35] Asya Mitseva, Andriy Panchenko, and Thomas Engel. The state of
affairs in bgp security: A survey of attacks and defenses. Computer
Communications, 124:45–60, 2018.
[36] Andreas Reuter, Randy Bush, Ítalo Cunha, Ethan Katz-Bassett,
Thomas C. Schmidt, and Matthias Wählisch. Towards a rigorous
methodology for measuring adoption of RPKI route validation and
ﬁltering. CoRR, abs/1706.04263, 2017.
[37] Jennifer Rexford, Jia Wang, Zhen Xiao, and Yin Zhang. Bgp routing
In Proceedings of the 2nd ACM
stability of popular destinations.
SIGCOMM Workshop on Internet measurment, pages 197–202. ACM,
2002.
[38] RIPE NCC. RIS Raw Data, 2021.
[39] Thomas Ristenpart, Eran Tromer, Hovav Shacham, and Stefan Savage.
Hey, you, get off of my cloud: exploring information leakage in third-
party compute clouds. In Proceedings of the 16th ACM conference on
Computer and communications security, pages 199–212, 2009.
[40] Haya Shulman. Pretty bad privacy: Pitfalls of dns encryption.
In
Proceedings of the 13th Workshop on Privacy in the Electronic Society,
pages 191–200, 2014.
[41] Haya Shulman and Michael Waidner. Towards security of internet nam-
ing infrastructure. In European Symposium on Research in Computer
Security, pages 3–22. Springer, 2015.
[42] Haya Shulman and Michael Waidner. One key to sign them all con-
In NSDI,
sidered vulnerable: Evaluation of dnssec in the internet.
2017.
[43] Sandra Siby, Marc Juarez, Claudia Diaz, Narseo Vallina-Rodriguez,
and Carmela Troncoso. Encrypted dns–> privacy? a trafﬁc analysis
perspective. arXiv preprint arXiv:1906.09682, 2019.
[44] University of Oregon. Route views project. http://bgplay.routeviews.
org/, 2012.
[45] Paul Vixie. DNS and BIND security issues. In Proceedings of the 5th
Symposium on UNIX Security, pages 209–216, Berkeley, CA, USA, jun
1995. USENIX Association.
[46] S Weiler and D Blacka. Rfc 6840: Clariﬁcations and implementation
notes for dns security (dnssec). IETF Standard, 2013.
[47] Xiaofeng Zheng, Chaoyi Lu, Jian Peng, Qiushi Yang, Dongjie Zhou,
Baojun Liu, Keyu Man, Shuang Hao, Haixin Duan, and Zhiyun Qian.
Poison over troubled forwarders: A cache poisoning attack target-
ing DNS forwarding devices. In 29th USENIX Security Symposium
(USENIX Security 20), pages 577–593, 2020.
3164    30th USENIX Security Symposium
USENIX Association