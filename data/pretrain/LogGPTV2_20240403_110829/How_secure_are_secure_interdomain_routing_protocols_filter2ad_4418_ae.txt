v
Prefix   
Figure 10: Exporting less.
Figure 10: The victim v is a stub serving a liberal arts
college in Illinois. The manipulator is a large ISP m, and is
competing with the victim’s other provider p1, a local ISP
in Illinois, to attract traﬃc destined for v.
Naive strategy. The “Shortest-Path Export-All” attack
strategy requires the manipulator to announce his path to all
his neighbors. On the left, when the manipulator announces
a path to his Tier 2 provider T 2, both T 2 and its two Tier 1
providers T 1a and T 1b will route through the manipulator.
As a result, T 1a and T 1b use four-hop paths to the victim,
and the manipulator attracts traﬃc from 40% of the ASes in
the internetwork, (13463 ASes), including 44% of the ASes
with at least 25 customers, and 32% of ASes with at least
250 customers.
Clever strategy. On the right, the manipulator in-
creases his traﬃc volume by almost 25%, by not exporting to
his Tier 2 provider T 2. Because T 2 no longer has a customer
path to the victim, he is forced to use a peer path through
T 1c. Because T 2 now uses a peer path, he will not export a
path to to the two Tier 1 T 1a and T 1b. The Tier 1s T 1a and
T 1b are now forced to choose shorter three-hop peer paths to
the victim through the manipulator. Because the T 1a and
T 1b now announce shorter paths to their customers, they
become more attractive to the rest of the internetwork, the
volume of traﬃc they send to the manipulator quadruples.
Thus, the manipulator attracts 50% of the ASes in the in-
ternetwork (16658 ASes), including 59% of the ASes with
at least 25 customers, and 29% of ASes with at least 250
customers.
Why it works. The manipulator’s strategy forces inﬂu-
ential ASes (i.e., Tier 1s) to choose shorter peer paths over
longer customer paths. He does this by suppressing an-
nouncements to certain providers, thus eliminating certain
customer paths from the internetwork.
When it works. This strategy only involves using a
clever export policy, rather than lying about paths, and
therefore succeeds against any protocol, including data-plane
veriﬁcation.
6.3 Attract more by gaming loop detection!
To show that the identity of the ASes on the announced
path can aﬀect the amount of attracted traﬃc, our last ex-
ample involves gaming BGP loop detection. (This contra-
dicts the optimality of the “Shortest-Path Export-All” at-
tack strategy, which suggests announcing any shortest path,
regardless of the identity of the ASes on that short path.)
While gaming loop detection was explored in other works,
e.g., [3–5], what is remarkable about this example is that it
96T1b
T1a
T1b
T1a
b3
b2
b1
v
Prefix   
a3
a2
b3
b2
b1
v
Prefix   
a1
m
a3
a2
a1
m
“m, a2, Prefix”
Figure 11: False loop preﬁx hijack.
proves that this attack strategy can attract more traﬃc than
an aggressive preﬁx hijack.
Figure 11: The manipulator m is a stub in Clifton, NJ
with two providers. This ﬁgure only depicts his NJ-area
provider, a1. The manipulator wants to blackhole traﬃc
destined for a preﬁx owned by the victim v, a stub in Al-
abama.
Standard preﬁx hijack. The manipulator announces
the path (m, Preﬁx) and attracts traﬃc from most of the
ASes in the internetwork, exactly 32010 ASes. Notice also
that because Tier 1 T 1a prefers customer paths, he will
choose to forward his traﬃc along the ﬁve-hop customer path
through the manipulator.
False loop preﬁx hijack. The manipulator claims that
innocent AS a2 originates the preﬁx, announcing (m, a2,
Preﬁx) to his provider a1. However, when this false loop
is announced to AS a2, BGP loop detection will cause a2
to reject the path through the manipulator’s provider a1.
As a result, the Tier 1 T 1a has no customer path to the
preﬁx, and instead chooses the shorter peer path. Now,
T 1a announces a shorter, four-hop path to his neighbors
(T 1a, a1, m, a2, Preﬁx), making him more attractive to the
rest of the internetwork, and attracting more traﬃc to the
manipulator. For this, and other reasons that are discussed
in the full version [1], the manipulator attracts 360 more
ASes than standard preﬁx hijack, i.e., 32370 ASes.
Why it works. The manipulator games BGP loop de-
tection, eﬀectively ‘removing edges’ from the network (i.e.,
the edge between a1 and a2), to force large ISPs to choose
shorter peer paths over longer customer paths.
When it works. This strategy involves lying about the
path announced by an innocent AS (i.e., AS a2). Because S-
BGP and data-plane veriﬁcation prevent lying about paths,
this strategy only works with BGP, origin authentication, or
soBGP.
6.4 How realistic are these examples?
While all the counterexamples we presented were found in
CAIDA’s AS graph, we encourage the reader to view these
examples as sample attack strategies that could succeed in
the wild, rather than predictions of what would occur if a
speciﬁc AS was to launch a given attack strategy. Indeed,
any missing edge or wrongly inferred business relationship
in CAIDA’s dataset introduces a gap between what happens
between the actual ASes depicted in each counterexample,
and what would really happen if these attack strategies were
launch by these speciﬁc ASes in practice on the Internet.
How common are these examples? Each of our coun-
terexamples is induced by a very particular AS graph topol-
ogy. Our objective in this section is not to argue that these
examples are common; indeed, we had to work hard to ﬁnd
them. Instead, our goal is to contradict the optimality of
the “Shortest-Path Export-All” attack strategy, and to ar-
gue that the attack strategies to contradict its optimality
could realistically occur in the wild.
Peering with indirect customers. Both Figures 10-11
rely on the existence a pair of ASes (p, c), such that c is both
a peer of p, and also an indirect customer of p (i.e., ASes
(T 1a, m) and (T 1b, m) in Figure 10 and ASes (T 1a, a1) in
Figure 11). While this topology may initially seem strange,
since it requires an AS p near the top of the customer-
provider hierarchy to peer with a smaller AS c lower down
in the hierarchy, this topology could occur in practice as a
result of business relationships that evolve over time, or due
to “open” peering policies facilitated by Internet Exchange
Points (IXPs) [13]. Indeed, we found about 2K instances of
this topologies in each of our datasets. More discussion is in
the full version [1].
7. FINDING OPTIMAL ATTACKS IS HARD
After all the bizarre attack strategies in Section 6, the
reader might not be surprised by the following:
Theorem 7.1. If ASes use the routing policies of Sec-
tion 2.2, then ﬁnding a manipulator’s optimal traﬃc attrac-
tion attack strategy on a general AS graph is NP-hard.
This theorem holds for (a) any of the secure protocols vari-
ants and (b) also covers interception attacks; our proof uses
a reduction to the standard NP-hard problem of ﬁnding the
maximum independent set of nodes in a graph. We also show
that it is hard to approximate the optimal attack within a
constant factor i.e., we cannot even design an algorithm that
gets “close” to the optimal attack on a general AS graph.
This suggests that a full characterization the manipulator’s
optimal attack strategy will remain elusive. See the full ver-
sion [1] for details.
8.
IMPLEMENTATION ISSUES
Many of our results compare the eﬃcacy of defensive ﬁl-
tering to that of soBGP and S-BGP. However, these mech-
anisms diﬀer greatly in (a) the number of ASes that use
them on the Internet today, as well as (b) the trust model
for which they were designed.
Origin authentication with RPKI/ROA. The oper-
ations community is currently working towards deploying
origin authentication, by developing a Resource Public Key
Infrastructure (RPKI) to issue cryptographic public keys to
ASes and routers, and Route Origin Authorizations (ROAs)
to map the IP address space to owner ASes [7]. This infras-
tructure is a ﬁrst step towards deploying soBGP or S-BGP.
Defensive ﬁltering in practice.
While defensive ﬁl-
tering is considered a best common practice on the Inter-
net today, and is anecdotally known to be used by several
large ISPs, its implementation is far from perfect. First, the
incentives to implement defensive ﬁltering are lopsided; in
some sense, the provider derives little local beneﬁt for itself
or its customers, and is instead altruistically protecting the
rest of the Internet from attacks. Secondly, the provider
has to manually maintain up-to-date “preﬁx lists” of the IP
addresses owned by each of its stub customers. To address
the second issue, we suggest that RPKI and ROAs are used
by each provider to automatically derive preﬁx lists for their
97stub customers. (Moreover, because it may not be realistic
to assume that every provider implements defensive ﬁlter-
ing, the full version [1] we considers what happens when only
the large ASes ﬁlter.)
Trust models. Moreover, we caution that defensive ﬁl-
tering operates in a problematic trust model. Because it
is a purely local mechanism at each provider, there is no
known way for an AS to validate that another AS has im-
plemented defensive ﬁltering properly. This trust model es-
sentially amounts to assuming that every provider is honest.
This is in contrast to the trust model used in S-BGP and
soBGP; S-BGP, for instance, ensures than even a malicious
AS may only announce available paths (as long as it does
not collude with, or comprise the keys of, some other AS),
and also allows any AS to validate the paths announced by
any other AS.
9. CONCLUSIONS
Because we work within a model of routing policies, we
caution against interpreting our results as hard numbers that
measure the impact of an attack launched by a speciﬁc ma-
nipulator in the wild. However, the trends uncovered by our
quantitative analysis do allow us to arrive at a number of
useful insights; indeed, many of these insights are obtained
by averaging over multiple possible (manipulator, victim)
pairs, and we suspect that they hold up even if some ASes
deviate from the policies in our model. Furthermore, the
trends we identiﬁed were remarkably consistent across mul-
tiple AS topology datasets [11–13]. That said, future work
might look into how our results hold up under diﬀerent rout-
ing policy models; e.g., assuming that some fraction of ASes
in the network use simple shortest path policies, while the
rest use those of Section 2.2, or assuming that some ASes
equally rank peer- and provider-paths.
While secure routing protocols can blunt traﬃc attraction
attacks, we found that export policies are a very eﬀective at-
tack vector that these protocols do not address. Thus, we
suggest that secure routing protocols (e.g., soBGP and S-
BGP) should be deployed in combination with mechanisms
that police export policies (e.g., defensive ﬁltering). We be-
lieve both are needed; defensive ﬁltering to eliminate at-
tacks by stub ASes, and secure routing protocols to blunt
attacks launched by larger ASes, (especially since we found
that large ASes can launch the most damaging attacks). We
note, however, that policing export policies is a signiﬁcant
challenge in practice. Defensive ﬁltering of stubs requires
voluntarily compliance from each provider, and it is diﬃ-
cult to check for proper implementation (as evidenced by
recent events [20]). Moreover, given the complexity of rout-
ing policies used in practice on the Internet, we lack even a
deﬁnition of what it means to deviate from normal export
policies. Thus, while anomaly-detection techniques that ﬂag
suspicious routes [17, 21] could help, understanding these is-
sues remains an important avenue for future research.
Acknowledgments
The authors thank Jeﬀ Lupien and Paul Oka for outstand-
ing research assistance, and Boaz Barak, Randy Bush, Kevin
Butler, Nick Feamster, Avinatan Hassidim, Elliott Karpilovky,
Arvind Krishnamurthy, Dave Ward, Dan Wendlandt, the
members of the MSR-New England Lab, and the anony-
mous SIGCOMM reviewers for comments and discussions.
10. REFERENCES
[1] S. Goldberg, M. Schapira, P. Hummon, and J. Rexford,
“How secure are secure interdomain routing protocols? Full
version,” tech. rep., Microsoft Research MSR-TR-2010-18,
June 2010.
[2] H. Ballani, P. Francis, and X. Zhang, “A study of preﬁx
hijacking and interception in the Internet,” in ACM
SIGCOMM, 2007.
[3] A. Pilosov and T. Kapela, “Stealing the Internet: An
Internet-scale man in the middle attack,” Aug. 2008.
Presentation at DefCon 16,
http://eng.5ninesdata.com/~tkapela/iphd-2.ppt.
[4] S. Goldberg, S. Halevi, A. D. Jaggard, V. Ramachandran,
and R. N. Wright, “Rationality and traﬃc attraction:
Incentives for honest path announcements in BGP,” in
ACM SIGCOMM, 2008.
[5] K. Butler, T. Farley, P. McDaniel, and J. Rexford, “A
survey of BGP security issues and solutions,” Proceedings
of the IEEE, January 2010.
[6] P. McDaniel, W. Aiello, K. Butler, and J. Ioannidis,
“Origin authentication in interdomain routing,” Computer
Networks, Nov. 2006.
[7] IETF, “Secure interdomain routing (SIDR) working group.”
http://datatracker.ietf.org/wg/sidr/charter/.
[8] R. White, “Deployment considerations for secure origin
BGP (soBGP).” draft-white-sobgp-bgp-deployment-01.txt,
June 2003, expired.
[9] S. Kent, C. Lynn, and K. Seo, “Secure border gateway
protocol (S-BGP),” J. Selected Areas in Communications,
vol. 18, pp. 582–592, April 2000.
[10] E. L. Wong, P. Balasubramanian, L. Alvisi, M. G. Gouda,
and V. Shmatikov, “Truth in advertising: Lightweight
veriﬁcation of route integrity,” in PODC, 2007.
[11] X. Dimitropoulos, D. Krioukov, M. Fomenkov, B. Huﬀaker,
Y. Hyun, and kc claﬀy, “AS relationships: Inference and
validation,” ACM SIGCOMM Computer Communication
Review, Jan. 2007.
[12] Y.-J. Chi, R. Oliveira, and L. Zhang, “Cyclops: The
Internet AS-level observatory,” ACM SIGCOMM Computer
Communication Review, Oct. 2008.
[13] B. Augustin, B. Krishnamurthy, and W. Willinger, “IXPs:
Mapped?,” in Proc. Internet Measurement Conference,
Nov. 2009.
[14] G. Huston, “Interconnection, peering, and settlements,” in
Internet Global Summit (INET), June 1999.
[15] L. Gao and J. Rexford, “Stable Internet routing without
global coordination,” IEEE/ACM Transactions on
Networking, 2001.
[16] L. Gao, “On inferring automonous system relationships in
the Internet,” IEEE/ACM Transactions on Networking,
vol. 9, pp. 733–745, Dec. 2001.
[17] J. Karlin, S. Forrest, and J. Rexford, “Autonomous security
for autonomous systems,” Computer Networks, Oct. 2008.
[18] T. Griﬃn, F. B. Shepherd, and G. Wilfong, “The stable
paths problem and interdomain routing,” IEEE/ACM
Transactions on Networking, Apr. 2002.
[19] H. Chang, D. Dash, A. Perrig, and H. Zhang, “Modeling
adoptability of secure BGP protocol,” in ACM SIGCOMM,
Sept. 2006.
[20] Rensys Blog, “Pakistan hijacks YouTube.”
http://www.renesys.com/blog/2008/02/pakistan_
hijacks_youtube_1.shtml.
[21] M. Lad, D. Massey, D. Pei, Y. Wu, B. Zhang, and
L. Zhang, “PHAS: A preﬁx hijack alert system,” in Proc.
USENIX Security Symposium, 2006.
98