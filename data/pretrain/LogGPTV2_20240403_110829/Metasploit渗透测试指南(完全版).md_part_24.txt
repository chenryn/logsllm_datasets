File Access
admin/backupexec/registry
normal
Veritas Backup Exec Server Registry
Access
admin/cisco/ios_http_auth_bypass
normal
Cisco IOS HTTP Unauthorized
Administrative Access
..SNIP..·
fuzzers/ssh/ssh_version_corrupt
normal
SSH Version Corruption
fuzzers/tds/tds_login_corrupt
TDS Protocol Login Request Corruption
Fuzzer
fuzzers/tds/tds_login_username
TDS Protocol Login Request Username
Fuzzer
fuzzers/wifi/fuzz_beacon
normal
Wireless Beacon Frame Fuzzer
fuzzers/wifi/fuzz_proberesp
normal
Wireless Probe Response Frame Fuzzer
124
---
## Page 152
第9章Metasploit辅助模块
gather/citrix_published_applicationsnormal
CitrixMetaFrame ICA Published
Applications Scanner
gather/citrix_published_bruteforce
normal
Citrix MetaFrame ICA Published
Applications Bruteforcer
gather/dns_enum
normal
DNS Enumeration Module
gather/search_email_collector
normal
Search Engine Domain Email Address
Collector
pdf/foxit/authbypass
normal
Foxit Reader Authorization Bypass
scanner/backdoor/energizer_duo_detectnormal
Energizer DUO Trojan Scanner
scanner/db2/db2_auth
normal
DB2 Authentication Brute Force Utility
scanner/db2/db2_version
normal
DB2 Probe Utility
从上面剪裁过的输出可以看出，辅助模块是按照类别进行组织的，按顺序你会看到DNS枚
举模块、Wi-FiFuzz测试模块，甚至一个可用来查找和利用劲量牌（Energize）USB电池充电器
木马后门的模块。
使用Metasploit的辅助模块和使用渗透攻击模块类似，只需简单地输入use命令并跟上模
块名字。举例来说，使用webday_scanner模块（在下一小节“使用辅助模块”中有详细介绍），
你应输入如下所示的usescanner/http/webdav_scanner命令：
提示：在辅助模块中，一些基本参数同其他模块有一些细微差别，如RHOST参数主要
用于定位多个目标主机，THIREAD参数用来微调扫描速度等。
0msf>use scanner/http/webdav_scanner
? msf auxiliary(webdav_scanner)> info
Name: HTTP WebDAV Scanner
Version:9179
License: Metasploit Framework License (BSD)
Rank:Normal
Provided by:
et
Basic options:
Name
Current Setting Required Description
Proxies
no
Use a proxy chain
③
RHOSTS
yes
The target address range or CIDR identifier
RPORT
80
yes
The target port
THREADS
yes
The number of concurrent threads
VHOST
no
HTTP server virtual host
Description:
DetectwebserverswithWebDAVenabled
msf auxiliary(webdav_scanner）>
125
---
## Page 153
Metasploit渗透测试指南
信息?，这些信息中包含了对各个参数的说明。在参数列表中我们看到仅有一个RHOST参数
③为必填且没有默认值，我们可以将RHOST设置为IP地址、IP地址列表、IP地址段或CIDR
地址块。
其他的参数会随着所使用的不同模块而有所差异。举例来说，THREAD（线程）·参数允
许在扫描中使用多线程支持，设置合适的线程参数，有时候能指显著地提高扫描速度。
9.1使用辅助模块
辅助模块可以在众多目标对象上有着非常多样化的用途，有时找到一个好用的模块会让你
兴奋不已。如果你无法找到一个理想的辅助模块，你也可以很容易地对现有模块进行修改，从
而满足你的特定需求。
设想一个很常见的场景，你正在进行一次远程渗透测试，对网络进行扫描后，除了发现一
些Web服务器外别无所获。这时你的攻击面非常窄，而你只能就现有条件展开工作。这时候
scanner/http中的辅助模块非常有用，它们能够帮助你找到唾手可得的漏洞，并有针对性地开展
渗透攻击。如下所示，可以使用searchscanner/http命令查找所有可用的HTTP扫描器。
msf auxiliary(webdav_scanner)> search scanner/http
Auxiliary
Name
RankDescription
scanner/http/backup_file
normalHTTP Backup File Scanner
scanner/http/blind_sql_query
normal HTTP Blind SQL Injection GET QUERY Scanner
scanner/http/brute_dirs
normal HTTP Directory Brute Force Scanner
scanner/http/cert
normalHTTP SSL Certificate Checker
scanner/http/copy_of_file
normal HTTP Copy File Scanner
scanner/http/dir_listing
normal HTTP Directory Listing Scanner
scanner/http/dir_scanner
normal HTTP Directory Scanner
Scanner/http/dir_webdav_unicode_bypass
normal MSog-020 IIS6 WebDAV Unicode Auth Bypass
Directory Scanner
scanner/http/enum_delicious
normalPull Del.icio.us Links(URLs)for a domain
scanner/http/enum_wayback
normal Pull Archive.org stored URLs for a domain
scanner/http/error_sql_injection
normal HTTP Error Based SQL Injection Scanner
Scanner/http/file_same_name_dir
normal HTTP File Same Name Directory Scanner
scanner/http/files_dir
normal HTTP Interesting File Scanner
Scanner/http/frontpage_login
normalFrontPage Server Extensions Login Utility
scanner/http/http_login
normal HTTP Login Utility
scanner/http/http_version
normalHTTPVersionDetection
scanner/http/lucky_punch
normal HTTP Microsoft SQL Injection Table XSS
Infection
126
---
## Page 154
第9章Metasploit辅助模块
scanner/http/ms09_o20_webdav_unicode_bypassnormal
MSO9-020 IIS6 webDAV Unicode Auth Bypass
scanner/http/options
normal
HTTP Options Detection
scanner/http/prev_dir_same_name_file
normal
HTTP Previous Directory File Scanner
scanner/http/replace_ext
normal
HTTP File Extension Scanner
scanner/http/robots_txt
HTTP Robots.txt Content Scanner
scanner/http/soap_xml
normal
HTTPSOAPVerb/NounBruteForceScanner
scanner/http/sqlmap
normal
SQLMAPSQLInjectionExternalModule
scanner/http/ssl
normal
HTTP SSL Certificate Information
scanner/http/svn_scanner
normal
HTTP Subversion Scanner
scanner/http/tomcat_mgr_login
normal
Tomcat Application Manager Login Utility
scanner/http/trace_axd
normal
HTTP trace.axd Content Scanner
scanner/http/verb_auth_bypass
normal
HTTP Verb Authentication Bypass Scanner
scanner/http/vhost_scanner
nomal
HTTPVirtualHost Brute ForceScanner
scanner/http/vmware_server_dir_trav
normal
VMware Server Directory Transversal
Vulnerability
scanner/http/web_vulndb
normal
HTTP Vuln scanner
scanner/http/webdav_internal_ip
normal
HTTP WebDAV Internal IP Scanner
scanner/http/webdav_scanner
normal
HTTP WebDAVScanner
scanner/http/webdav_website_content
normal
HTTP WebDAV website Content Scanner
③
scanner/http/writable
nommal
HTTPWritablePath PUT/DELETEFile Access
scanner/http/xpath
normal
HTTP Blind XPATH 1.0 Injector
这里有很多辅助模块可供我们选择，现在我们从中挑选一些更符合我们要求的。我们留意
到在·处显示的工具可以让我们从多个服务器上读取robots.txr文件，在·处列出了几个可与
WebDAV服务交互的模块，在③处提供了一个查找具有可写权限服务器的工具，此外还有很多
用于特定环境的辅助模块。
你很快会发现有许多模块适用于我们后续的信息探测。旧版微软IIS服务器的WebDAV功
能有-一个可用于远程攻击的漏洞，因此你可以对目标进行一次扫描，并期望能够发现一台启用
了WebDAV的服务器。
msf auxiliary(dir_webdav_unicode_bypass)>use scanner/http/webdav_scanner
msf auxiliary(webdav_scanner)>show options
Module options:
Name
Current Setting
Required Description
Proxies
no
Use a proxy chain
RHOSTS
yes
The target address range or CIDR identifier
RPORT
80
yes
The target port
THREADS1
yes
The number of concurrent threads
VHOST
ou
HTTP server virtual host
0 msf auxiliary(webdav_scanner) > set RH0STS 192.168.1.242, 192.168.13.242.252,
192.168.13.242.254,192.168.4.116,192.168.4.118,192.168.4.122,
192.168.13.242.251,192.168.13.242.234,192.168.8.67,192.68.8.113,
192.168.13.242.231,192.168.13.242.249,192.168.4.115，192.168.8.66,192.168.8.68,
192.168.6.62
127
---
## Page 155
Metasploit渗透测试指南
RHOSTS => 192.168.1.242，192.168.13.242.252,192.168.13.242.254，192.168.4.116,
192.168.4.118, 192.168.4.122,192.168.13.242.251, 192.168.13.242.234, 192.168.8.67,
192.168.6.113， 192.168.13.242.231，192.168.13.242.249, 192.168.4.115，192.168.8.66,
192.168.8.68，192.168.6.62
msf auxiliary(webdav_scanner)>run
[*] 192.168.1.242 (Microsoft-IIS/6.0) WebDAV disabled.
[*]192.168.13.242.252 (Apache/2.2.9 (Debian) proxy_html/3.0.0 mod_ss1/2.2.9
OpenSSL/0.9.8g) WebDAV disabled.
[*]Scanned 04 of 31 hosts(012% complete)
[*]Scanned 07 of 31 hosts (022% complete)
[*]192.168.4.116 (Apache/2.2.3 (Red Hat))WebDAV disabled.
[*]Scanned 10 of 31hosts(032% complete)