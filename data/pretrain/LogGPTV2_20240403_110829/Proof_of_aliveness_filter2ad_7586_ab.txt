F
2
x2
2
xN
Checkpoints  & Secret keys of 
OTS for Auto-replenishment
an 𝐎𝐖𝐅 instance
256
x0
F
256
x1
F
256
x2
256
xN
13
PRG
Multiple-chain PoA OWF
Tstart
Usage direction
Tend
ss0
G
ss1 G
ss2 G
ss255 G
ss256
1
Tend
n
o
i
t
c
e
r
i
d
e
g
a
s
U
1
Tstart=Tstart
1
x0
F
1
x1
F
1
x2
1
xN
T’start
2
x0
F
2
x1
F
2
x2
2
xN
Checkpoints  & Secret keys of 
OTS for Auto-replenishment
an 𝐎𝐖𝐅 instance
Verify-points
256
x0
F
256
x1
F
256
x2
256
xN
13
Security problems
• The effect of N on security is unclear in the standard model
° T/Key in the random oracle model [DMB17] 
° What is the security result without random oracles? 
• The security is unclear in the multiple-client setting 
° What input length of OWF should we use? 
OWF: security analysis
• New one-way function OWF → 𝐅
° 𝐅 : on input x0, outputs xW, for 2 ≤ W ≤ N and W is a variable
• Evaluate the entropy of xW generated by 𝐅 , and its entropy loss 
relevant to W
x0
F
x1
F
x2
F
xN-1
F
xW
OWF: security analysis
• New one-way function OWF → 𝐅
° 𝐅 : on input x0, outputs xW, for 2 ≤ W ≤ N and W is a variable
• Evaluate the entropy of xW generated by 𝐅 , and its entropy loss 
relevant to W
x0
F
x1
F
x2
𝐅
F
xN-1
F
xW
OWF: security analysis
• The security game of OWF
° One-wayness: hard to generate the pre-image of a OWF value – Adv𝐅
° Almost 1-1: each OWF value only has one pre-image with overwhelming 
OWF(k)
probability : 1 − ϵ𝐅
1−1 ≤ Adv𝐅
• Output a x’0 such that 𝐅 (x’0) = xW, Adv𝐅
1−1 , where ϵ𝐅
OWF(k)
OWF(k)?
OWF: security analysis
• The security game of OWF
° One-wayness: hard to generate the pre-image of a OWF value – Adv𝐅
° Almost 1-1: each OWF value only has one pre-image with overwhelming 
OWF(k)
probability : 1 − ϵ𝐅
1−1 ≤ Adv𝐅
• Output a x’0 such that 𝐅 (x’0) = xW, Adv𝐅
1−1 , where ϵ𝐅
OWF(k)
OWF(k)?
x’0
x’1
x’2 =F(F(x’’0)
x’N-1
x0
F
x1
F
x2
F
xW-1
F
xW
OWF: security analysis
• The security game of OWF
° One-wayness: hard to generate the pre-image of a OWF value – Adv𝐅
° Almost 1-1: each OWF value only has one pre-image with overwhelming 
OWF(k)
probability : 1 − ϵ𝐅
1−1 ≤ Adv𝐅
• Output a x’0 such that 𝐅 (x’0) = xW, Adv𝐅
1−1 , where ϵ𝐅
OWF(k)
OWF(k)?
x’0
x’1
x’2 =F(F(x’’0)
x0
F
x1
F
x2
F
xN-1
F
xW
OWF: security analysis
• The security game of OWF
° One-wayness: hard to generate the pre-image of a OWF value – Adv𝐅
° Almost 1-1: each OWF value only has one pre-image with overwhelming 
OWF(k)
probability : 1 − ϵ𝐅
1−1 ≤ Adv𝐅
• Output a x’0 such that 𝐅 (x’0) = xW, Adv𝐅
1−1 , where ϵ𝐅
OWF(k)
OWF(k)?
x’0
x’1
x0
F
x1
F
x2
F
xN-1
F
xW
OWF: security analysis
• The security game of OWF
° One-wayness: hard to generate the pre-image of a OWF value – Adv𝐅
° Almost 1-1: each OWF value only has one pre-image with overwhelming 
OWF(k)
probability : 1 − ϵ𝐅
1−1 ≤ Adv𝐅
• Output a x’0 such that 𝐅 (x’0) = xW, Adv𝐅
1−1 , where ϵ𝐅
OWF(k)
OWF(k)?
x’0
x0
F
x1
F
x2
F
xN-1
F
xW
OWF: security analysis
• The security game of OWF
° One-wayness: hard to generate the pre-image of a OWF value – Adv𝐅
° Almost 1-1: each OWF value only has one pre-image with overwhelming 
OWF(k)
probability : 1 − ϵ𝐅
1−1 ≤ Adv𝐅
• Output a x’0 such that 𝐅 (x’0) = xW, Adv𝐅
1−1 , where ϵ𝐅
OWF(k)
OWF(k)?
x’0
x0
F
x1
F
x2
𝐅
F
xN-1
F
xW
OWF: security results
• Lemma 1: Suppose that F is a secure almost 1-1 one-way 
function, 𝐅 is a secure almost 1-1 one-way function with N ≥ 
2 and Adv𝐅
OWF k ≤ 𝑁 + 1 Adv𝐅
OWF k + 𝑛𝑒𝑔𝑙(𝑘)
• Theorem 1: Suppose that there are 𝑙 parties, and the one-way 
function F is almost 1-1 and secure, then OWF is secure 
OWF k + 𝑛𝑒𝑔𝑙(𝑘)
with Adv
k ≤ 𝑙2 𝑁 + 1 2Adv𝐅
PoA
OWF
PRG : security analysis
OWF
𝐢
• Reduce the security to PRG → uniform random 𝐱𝟎
Uniform random
1
x0
F
1
x1
F
1
x2
1
xN
2
x0
F
2
x1
F
2
x2
2
xN
256
x0
F
256
x1
F
256
x2
256
xN
PRG : security analysis
OWF
• Reduce the security to OWF
1
x0
F
1
x1
F
1
x2
1
xN
2
x0
F
2
x1
F
2
x2
2
xN
The  𝐎𝐖𝐅 security
256
x0
F
256
x1
F
256
x2
256
xN
PRG : security results
OWF
• Theorem 2: Suppose that OWF is a secure PoA protocol, and 
G is a secure PRG. Then, for  𝑙 parties and 𝜂 sub-chains, 
PRG is secure with
OWF
PoA
k ≤ 𝑙2𝜂3AdvG
AdvOWF
𝑙2𝑁3
𝜂 AdvOWF
PRG k +
PRG
OWF k + 𝑛𝑒𝑔𝑙(𝑘)
PRG
Performance evaluation 
• Client – Raspberry Pi 3, server – laptop , N=222 (4 million)
• Random oracle (RO), OWF – SHA2, PRG – AES
• Standard model (STD), OWF – Subset-sum, PRG – [YLW13] 
Protocol
Setup
OWF RO
OWF STD
PRG RO
OWF
PRG STD
OWF
15.69 s
185.33 s 
17.11 s
192.48 s
Proof Generation
average/worst
3.74 s / 3.74 s
44.19 s / 44.19 s
5.50 s / 18.00 s
45.5 s / 10.46 ms
Verification
Replenishment
0.47 s
4.12 s
0.47 s
4.12 s
N/A
N/A
2.65 ms
5.28 s
Summary
Summary
• Cryptographic notion for Proof of Alievness
° Security model
• PoA schemes without secrets on the server
° Auto-replenishment
• New security bounds in the standard model
Thank you for listening!
References
• [DMB17] Kogan, Dmitry, Nathan Manohar, and Dan Boneh. "T/key: second-factor authentication 
from secure hash chains." CCS 2017
• [Lam81] Password Authentication with Insecure Communication. Comm ACM, 1981
• [Lam79] Leslie Lamport. Constructing digital signatures from a one-way function. Tech. Report, 
1979. 
• [YLW13] Yu Yu, Xiangxue Li, and JianWeng. Pseudorandom generators from regular one-way 
functions: New constructions with improved parameters. Asiacrypt 2013.