### Malicious Activities and Trustworthiness Scores

- **Trustworthiness Score**: Domain names with a trustworthiness score up to the "LOW" category, as defined by DNSWL [9], are considered. For more details, refer to: <http://www.dnswl.org/tech>.

### Discussion

- **Feature Combination for Detection**: While individual features may not be sufficient for Kopis to accurately distinguish between malware-related and legitimate domain names, combining the described features allows for a high detection rate with minimal false positives, as demonstrated in Section 5.
- **Novel Features**: The Requester Diversity and Requester Profile features computed by Kopis are novel and distinct from the statistical features proposed in Notos [3] and Exposure [4], which heavily rely on IP reputation information.
- **DNS Traffic Monitoring**: Unlike Notos and Exposure, which use RDNS-level DNS traffic monitoring, Kopis extracts specific statistical features to capture the "malware signal" from the upper DNS hierarchy, suitable for coarser-grained DNS traffic observed at the authoritative name server (AuthNS) and top-level domain (TLD) levels.
- **Detection Without IP Reputation**: Kopis can detect malware-related domains even in the absence of IP reputation information, as shown in Section 5.

### Evaluation

#### Datasets
- **Data Collection**: Our datasets were compiled from DNS traffic obtained from two major domain name registrars (January 1, 2010, to August 31, 2010) and a country code top-level domain (.ca) (August 26, 2010, to October 18, 2010).
- **Data Volume and Reduction**: The daily lookup volume averaged 321 million. A data reduction process was applied to maintain only query tuples, reducing the daily observations to an average of 12,583,723 unique query tuples. This reduction did not affect Kopis' ability to model benign and malware-related domains.
- **Diversity Analysis**: Only the first 100,000 domain names exhibited significant diversity in requesters. Statistical vectors were created for these diverse domains.

#### Ground Truth
- **Data Sources**: We collected DNS traffic from two DNS authorities and the .ca TLD, storing and indexing query tuples daily in a relational database.
- **IP Mapping and Blacklists**: Team CYMRUâ€™s IP-to-ASN mapping [28] was used to map IP addresses to CIDRs, AS numbers, and country codes. Malware information was gathered from multiple sources, including Malwaredomains [16] and Zeus tracker [31].
- **Labeling**: 225,429 unique resource records (RRs) corresponding to 28,915 unique domain names were labeled, with 1,598 domain names labeled as legitimate and 27,317 as malware-related.

#### Model Selection
- **Machine Learning Algorithm**: Kopis uses a machine learning algorithm to build a detector based on statistical profiles of resolution patterns.
- **Observation Window**: The optimal observation window for training was determined to be five days, using a random forest (RF) classifier, which achieved a true positive rate (TPR) of 98.4% and a false positive rate (FPR) of 0.3%.
- **Classifier Comparison**: Other classifiers, such as Naive Bayes, k-nearest neighbors (IBK), Support Vector Machines, and MLP Neural Network, were also tested, but the RF classifier provided the best results.

#### Overall Detection Performance
- **Long-term Experiment**: A five-month experiment using 150 datasets showed that Kopis has a very high TPR and very low FPR against new and previously unclassified malware-related domains.
- **Feature Combination**: The combination of Requester Diversity (RD) and Requester Profile (RP) features performed almost as well as IP reputation (IPR) features, and using all features together provided the best performance.

#### New and Previously Unclassified Domains
- **Training and Evaluation**: Kopis was trained on one month of labeled data, excluding 20% of both benign and malware-related domains. The evaluation dataset included the excluded domains and newly seen domains, demonstrating Kopis' ability to detect new and previously unclassified malware domains effectively.

This structured approach ensures clarity, coherence, and professional presentation of the information.