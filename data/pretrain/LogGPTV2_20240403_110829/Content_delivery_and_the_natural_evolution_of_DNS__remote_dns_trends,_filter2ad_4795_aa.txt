title:Content delivery and the natural evolution of DNS: remote dns trends,
performance issues and alternative solutions
author:John S. Otto and
Mario A. S&apos;anchez and
John P. Rula and
Fabi&apos;an E. Bustamante
Content Delivery and the Natural Evolution of DNS
Remote DNS Trends, Performance Issues and Alternative Solutions
John S. Otto Mario A. Sánchez
John P. Rula Fabián E. Bustamante
{jotto,msanchez,john.rula,fabianb}@eecs.northwestern.edu
Northwestern University
ABSTRACT
Content Delivery Networks (CDNs) rely on the Domain
Name System (DNS) for replica server selection. DNS-
based server selection builds on the assumption that,
in
the absence of information about the client’s actual network
location, the location of a client’s DNS resolver provides
a good approximation. The recent growth of remote DNS
services breaks this assumption and can negatively impact
client’s web performance.
In this paper, we assess the end-to-end impact of using
remote DNS services on CDN performance and present
the ﬁrst evaluation of an industry-proposed solution to the
problem. We ﬁnd that remote DNS usage can indeed
signiﬁcantly impact client’s web performance and that the
proposed solution, if available, can eﬀectively address the
problem for most clients. Considering the performance cost
of remote DNS usage and the limited adoption base of
the industry-proposed solution, we present and evaluate an
alternative approach, Direct Resolution, to readily obtain
comparable performance improvements without requiring
CDN or DNS participation.
Categories and Subject Descriptors
C.2.4 [Communication Networks]: Distributed Systems—
Distributed applications; C.2.5 [Communication Net-
works]: Local and Wide-Area Networks—Internet; C.4
[Performance of Systems]: Measurement techniques
General Terms
Experimentation, Measurement, Performance
Keywords
CDN, Content distribution, DNS, DNS extension, Internet,
measurement
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
IMC’12, November 14–16, 2012, Boston, Massachusetts, USA.
Copyright 2012 ACM 978-1-4503-1705-4/12/11 ...$15.00.
1.
INTRODUCTION
Content Delivery Networks (CDNs) replicate content
across geographically distributed sets of servers and redirect
clients to nearby replicas to reduce web access time. Since
ﬁrst emerging in the mid 1990s, CDNs have become the
primary vehicle for distributing content over the Inter-
net. Today, 74% of the top 1,000 sites and 89% of their
pageviews1 use CDNs to deliver content to clients (Fig. 2).
Over the last decade the CDN industry has grown to include
a large and diverse set of over 49 companies including
regional focused ones (e.g. Accelia) and global services such
as Akamai and Level3.2
CDNs rely on the Domain Name System (DNS) for both
dynamic request routing and replica server selection. For
server selection, CDNs base their decision on the IP address
of a client’s local DNS resolver. This approach builds on
the assumption that, in the absence of information about
the client’s actual network location, the location of its
resolver provides a good approximation. The recent growth
in remote DNS usage challenges this assumption.
This paper investigates the impact of recent DNS evo-
lution on the web experience of end users. Over the past
few years there has been a signiﬁcant increase in the use of
remote DNS services, including public DNS. Remote DNS
oﬀers a number of potential advantages to both service
providers and end users. For service providers, strategically
placed, remote DNS server clusters oﬀer economies of scale
and simpliﬁed management, among other beneﬁts. For
users, such services can yield better DNS performance,
availability and security. The relative importance of such
beneﬁts to end users partially explains the observed growth
in public DNS usage. OpenDNS has recently reported a 2×
increase in users of their service over 2010-2012 [20, 21]. In
our own survey (Fig. 3) based on data from the EdgeScope
project [5], we found that the public DNS user base has
grown by 27% annually over the last 21 months. As of
December 2011, 8.6% of users in this dataset relied on a
public DNS service.
While remote DNS services could indeed result in better
DNS performance for end users, by breaking the assumption
made by CDN mapping approaches they may yield worse
end-to-end web performance. To illustrate the scope and
extent of this eﬀect, we compare the minimum time to fetch
content from Akamai’s CDN when using local and remote
DNS servers from diﬀerent locations in North America. Fig-
1As ranked by Alexa.com, accounting for 48% of all Internet
pageviews.
2http://cdnlist.com; July 2011
523for the median case). However, in a survey of the top 1,000
most popular sites, we ﬁnd that only 9% of sites use CDNs
that support the extension.
We introduce Direct Resolution (DR) an alternative so-
lution (§5) that obtains comparable performance improve-
ments to the DNS extension. Our end-host solution enables
incremental adoption by aﬀected users, and does not rely
on support from either DNS services or CDNs. The
approach leverages the cache of an end host’s recursive
resolver to eﬃciently map a Canonical Name (CNAME)
to an authoritative name server, but directly contacts the
authoritative server to obtain a precise redirection for the
client. We have implemented DR as part of namehelp, a
tool based on a popular DNS benchmark utility [18] to
both provide a comparative evaluation of DNS service and
web performance and act as a DNS proxy that implements
DR to improve CDN mappings. Na¨ıvely using DR for
all CDN queries improves end-to-end performance for 49%
of locations. namehelp avoids this penalty and achieves
strictly better performance than recursive DNS alone by
only using DR when it has previously improved end-to-end
performance.
Contributions
Recent studies [1, 9, 12] have shown that the use of public
DNS services can complicate the mapping of clients to
replica servers or data centers done by CDNs and cloud
service providers, while Huang et al. [8] and Khosla et al.
[12] discuss possible approaches to mitigate the performance
penalty. Our work extends signiﬁcantly these previous
eﬀorts, contributing:
• The ﬁrst study of the end-to-end web performance im-
pact of remote DNS on CDNs from users’ perspectives
in access networks.
• The ﬁrst evaluation of the proposed edns-client-subnet
extension, its potential performance and level of adop-
tion.
• The design and experimental evaluation of a novel
end-system solution that provides comparable beneﬁts
to the extension and is readily available for users to
install.
After providing some background, we expand on each of
these contributions. We close the paper with a discussion
of closely related work in §6 and our concluding thoughts in
§7.
2. BACKGROUND
Since their emergence in the mid 1990s, CDNs have
become the primary vehicle for delivering content over the
Internet. To estimate the reliance of popular sites on CDNs,
we conducted a survey of the top 1,000 most popular sites, as
ranked by Alexa.com. For each site, we download its index
page and linked web objects. We used several techniques
to determine if a site uses CDNs,
including detection of
HTTP redirection to CDN domains or use of CNAME
entries in DNS resolutions. Since there are other methods
of redirecting to a CDN (e.g. domain delegation) that we
do not capture, these results are a lower bound on the use
of CDNs in popular sites.
Figure 1: For North America, minimum HTTP
latency to get Akamai content using near or far ISP
DNS, and Google DNS. 27% of locations have “far
away” ISP DNS (latency >50 ms). Median case’s
access latency is doubled for far-away and Google vs.
nearby ISP DNS.
ure 1 plots the minimum latency for the diﬀerent locations
using nearby (latency <50 ms) and faraway ISP DNS and
Google DNS.3 Web access latency is a signiﬁcant factor in
user satisfaction [7, 26]. As the ﬁgure shows, remote DNS—
both public DNS and far-away ISP DNS—has a major
impact on CDN access latency. Latency doubles in the
median case and triples for the worst 10% of locations. These
results extend and are consistent with those in Ager et al. [1];
we ﬁnd that a large fraction of ISPs’ DNS services, as much
as 27%, are distant from their users and therefore result in
signiﬁcant reductions in CDN performance.
In this paper, we present results from a large-scale study
of the end-to-end impact of remote DNS usage on CDN
performance (§ 4). Based on experiments conducted from
10,923 end-hosts across 99 countries, we show that for 90% of
the sampled locations, the set of CDN replicas selected based
on public DNS services has no overlap with those selected
based on the client location. This error results in a 60%
increase in end-to-end latency in the median case and up to
3× increase for 20% of the sampled location.
The potential negative impact of remote DNS usage on
web performance motivates the recently proposed edns-
client-subnet EDNS0 extension [3]. This extension, put
forward by a collaboration of several CDNs and DNS service
providers [28], allows DNS recursive resolvers to pass along
clients’ subnet information that could be used by CDNs to
improve replica server selection. A key challenge to this
approach is adoption, as it requires the commitment of both
CDN and DNS services to be eﬀective. We report on the
ﬁrst study of the adoption of the proposed edns-client-subnet
extension and its potential beneﬁts for public DNS service
users (§4.3). We ﬁnd that the proposed extension could
be eﬀective at reducing the impact of public DNS usage on
CDN performance. Our results show that, assuming wide
adoption, the proposed extension can reduce the impact of
public DNS usage to less than 80% for 80% of locations (30%
3To put this in context, the average network latency between
U. Washington in Seattle, WA and Georgetown U.
in
Washington, D.C. is ≈ 83 ms.
050100150200MinimumHTTPlatency(ms)0.00.20.40.60.81.0CDFoflocationsinNorthAmericaNearbyISPDNSFarawayISPDNSGoogleDNS524Figure 2: Fraction of the top N most popular sites
and their pageviews that use CDNs. Over 70% of
the top 1,000 sites and 89% of their pageviews utilize
CDNs.
Figure 3: % of users with public DNS conﬁgured
on their computer over the last 21 months. “Any”
shows the combined adoption percentage of these
services. Public DNS usage is growing by 27%
annually.
Figure 2 summarizes our ﬁndings. The ﬁgure plots
both the fraction of “Sites” (blue/dark) and “Pageviews”
(green/light) using CDNs in the top N most popular sites.
As the ﬁgure shows, all sites in the top 10 and over 70% of
those in the top 1,000 rely on CDNs. Weighting CDN use by
pageviews results in an even larger fraction of top sites using
CDNs. Across all views to the top 1,000 sites—accounting
for 48% of all pageviews—9 out of 10 require loading objects
from a CDN.
In general, for a web client to retrieve content for a web
page, the ﬁrst step is to use DNS to resolve the server-name
portion of the content’s URL into the address of a machine
hosting it. If the web site uses a CDN, the content will be
replicated at several hosts across the Internet. A popular
way to direct clients to those replicas dynamically is DNS
redirection. With DNS redirection, a client’s DNS request
is redirected to an authoritative DNS name server that is
controlled by the CDN, which then resolves the CDN server
name to the IP address of one or more replica servers [13].
DNS redirection can be used to deliver full or partial site
content. With the former, all DNS requests for the origin
server are redirected to the CDN. With partial site content
delivery, the origin site modiﬁes certain embedded URLs
so that requests for only those URLs are redirected to the
CDN. CDNs typically select a (set of) replica to serve the
request from based on the network and geographic region
of the local DNS server. While a reasonable approximation
when clients and their local DNS resolvers are topologically
close, the use of remote DNS services can yield less than
optimal redirections.
Over the past few years there has been a signiﬁcant
increase in the use of remote DNS services,4 including
public DNS. To analyze longitudinal trends in remote DNS
usage, we use 21 months of user DNS conﬁguration data
from the EdgeScope project (April 2010 through December
2011). EdgeScope [5] collects data from BitTorrent [32]
users, including host conﬁguration and host and network
measurement statistics. The dataset includes information
reported by 47,119 users located in 197 countries and
4While anecdotal, evidence of this trend can be seen in
reports of DNS service outages in national ISPs, typically
aﬀecting large geographic regions [34, 35].
4,613 ASes, giving us a diverse and global perspective on
DNS usage by BitTorrent users.
We quantify public DNS adoption by counting the users
having conﬁgured well-known IP addresses for these services
at diﬀerent points over the observed period. Figure 3
shows the observed trends in combined (labeled Any) and
individual public DNS service adoption for the three most
popular: Google, OpenDNS and Level3. Overall, we found