14443-3——初始化和零冲突
14443-4——传输协议
—157—
4.生物识别 Biometrics
生物识别属于第 3 类身份认证因素，即，你是什么？
①生理识别方法。包括指纹、面部扫描、视网膜扫描、虹膜扫描、手掌扫描、手形和语音
模式。
②行为识别方法。包括动态签名和击键模式(击键力学)，也称为你所做(something-you-do)
的身份认证。
指纹都很普通，主要讲下别的：
*视网膜扫描（Retinal Scanning）的是眼睛后方血管的图案，它会泄露个人健康状况。
视网膜没有虹膜那么多的生物多样性，也容易变化。
*虹膜扫描（Iris Patterns）是最精确的生物认证形式，扫描的是瞳孔周围的有色区域，
它一生都不会变。它可以区分同卵双胞胎的，甚至同一个人的左右眼。
*手掌扫描（手掌特征或手掌纹理)是用近红外光测量手掌的静脉。
*手部外形识别手部的物理尺寸，包括手掌和手指的宽度与长度，即手的轮廓，它不能捕
捉指纹细节或静脉模式。这种方法比较难识别出一个人的独特性。不好用。
*声音识别依靠一个人说话的声音特点，称为声纹。也不好用。
*签字力度识别主体如何书写字符串，依赖于用笔的压力、笔划方式、笔划长度以及提笔
时间点。
*击键模式(击键力度)通过分析抬指时间与按压时间来分析主体使用键盘的方式。误差比
较大。
生物识别的灵敏度极易产生 2 种错误：误报(false positive)或漏报(false negative)，
为了提高准确度，有几个重要的指标参数（一拒二收，开始是拒绝的，后来接受了）：
①一类错误/拒绝 Type 1 Error，即错误拒绝率(FRR) false rejection rate，正确的主
体被拒绝的概率，就是识别太敏感了，动不动就不认。
②二类错误/滥收 Type 2 Error，即错误接受率(FAR) false acceptance rate，错误的
主体被接受的概率，就是识别太模糊了，什么都认。
③交叉错误率(CER)/相等错误率(ERR)。就是两类错误相同时的概率指标，代表了系统经
调校后的综合识别能力水平，最低越好。
当然，根据组织的需求，可以让某一类错误多出些，另一类最好不出。
—158—
B.3 可追溯性 Accountability
可追溯性/可问责性/审计是能够确定谁或什么是负责的操作，并可以追究责任。强大的身
份识别，认证，审核和会话管理的背后最终驱动力之一就是问责制。
问责在很大程度上依赖于不可抵赖性，但它们还是有区别的。不可抵赖性是与信息保障密
切相关的一个话题；否定是否认一个动作，事件，影响或结果；不可抵赖性是确保用户不得否
认行动的一个过程。问责在很大程度上依赖于不可抵赖性，以确保对用户的流程和行动可以被
追究责任。
一、授权和可问责性 Authorization and Accountability
①授权。依据主体的证明身份授予其访问客体权利。
②可问责性/可追溯性。在执行审计时用户和其他主体要对自己的行为负责。
补充知识：
授权蠕动(authorization creep)
当雇员在一家公司长期工作时，他们会从一个部门调动到另一个部门，因此常常被赋予越
来越多的访问权限和许可。这种情况通常称为授权蠕动(authorization creep)。
擦洗(scrubbing)
攻击者经常会删除保存其犯罪活动信息的审计日志(删除审计日志中特定犯罪数据的行为
称为“擦洗(scrubbing)”。
二、AAA 协议
提供认证、授权和可问责性的协议叫做 AAA 协议。authentication, authorization, and
accounting(最后一个可问责性有的地方描述为“审计 Audit”,效果和意思都是一样的)。AAA
协议就是指功能完备的严格的访问控制协议。他们提供集中式访问控制，附带例如虚拟专用网
(VPN)和其他类型的网络访问服务器的远程访问系统。他们可以保护内部局域网认证系统和其
他服务器遭受远程攻击。当使用一个单独的系统进行远程访问时，对系统的成功攻击只会影响
远程访问用户。一些常见的 AAA 协议有 RADIUS、TACACS+ 以及 Diameter。上一章节“单点登
—159—
陆里”讲的 kerberos 也是 AAA 协议。
下面讲的是集中式“访问控制管理”centralized ACA,access contrl administration。
分散式 decentralized 的比较简单，不讲了。
1.RADIUS（Remote Authentication Dial-In User Service）
远程认证拨号用户服务器(RADIUS)主要用于远程连接的身份认证。RADIUS 服务器为多个
远程访问客户端提供 AAA 服务。许多互联网服务提供商(ISP)使用 RADIUS 进行身份认证。用户
可以在任何地方访问 ISP。RADIUS 采用用户数据报协议(UDP)，并只加密交换密码协议，不会
加密整个会话，但可以使用附加协议来对数据会话进行加密。RADIUS 是一个集中认证机制，
提供认证，授权和计费。使用 802.1x 是的一个改进形式，这是一个 EAP 和 RADIUS 的组合，
在发送用户标识是使用明文，但密码是加密的。
总的来说，RADIUS 有以下问题。它：
①己成为密码攻击的受害者，已经被重放攻击成功攻击。
②缺乏完整性保护。
③只有特定字段使用加密（仅密码加密）。
2.TACACS+（Terminal Access Controller Access Control System）
终端访问控制器访问控制系统(TACACS)是 RADIUS 的一种升级和替代，思科提出的商业协
议。后来推出了扩展 TACACS （XTACACS)，并将其作为一项专有协议。然而，TACACS 和 XTACACS
如今都不常用。后来，又推出了 TACACS+，并被作为一个开放的协议，成为了三个协议中最常
用的一个。
①TACACS 将它的身份验证和授权过程组合在一起。（使用固定密码）
②XTACACS 将身份验证、授权和审计过程分隔开。
③TACACS+则在 XTACACS 基础上采用双因素用户身份验证。（使用动态(一次性)密码）
TACACS+（网络设备查询服务器验证密码）将认证、授权以及可问责分为独立的流程，并
可以在三个独立的服务器上进行托管。TACACS+可以加密所有的认证信息，而不仅仅像 RADIUS
一样只是加密密码。TACACS 和 XTACACS 使用的是 UDP 端口 49，而 TACACS+使用的是传输控制
协议 TCP 端口 49，为数据包的传输提供了更高的可靠性。上面 2 个的区别：
RADIUS TACACS/XTACACS TACACS+
数据通信 UDP UDP：49 TCP：49
数据加密 仅加密传输的用户密码 唔知 加密客户端-服务器全部流量
AAA 功能 集中整合合认证和授权 前者整合/后者分离 验证、授权和审计过程分隔开
协议支持 仅 PPP 连接 唔知 还支持 IPX、AppleTalk、NETBIOS
挑战响应
对所有 AAA 活动仅执行
一次挑战响应认证（单） 唔知
对各项不同的 AAA 活动分别
执行挑战响应认证（多挑战）
3.Diameter
基于 RADIUS 和 TACACS+的成功应用，又开发出了一个名为 Diameter 的 RADIUS 的增强版
本。它支持多种协议，包括传统 IP、移动 IP、IP 传真和 IP 语音(VoIP)。因为其支持许多附
加的命令，尤其在支持漫游服务情况下特别受欢迎，例如无线设备和智能手机。虽然 Diameter
是 RADIUS 的升级版本，但是其并不兼容 RADIUS。
—160—
Diameter 使用的是 TCP 端口 3868，或流控制传输协议(SCTP)端口 3868，相比于 RADIUS
使用的 UDP 端口来说，提供了更好的可靠性。它也支持网际安全协议(IPsec)和传输层面安全
协议的加密。Diameter 这个名称也意味着 Diameter 要比 RADIUS 好两倍。
前面讲的 RADIUS 和 TACACS+都是客户端/服务器协议，服务器只能被动作出响应。而
Diameter 是一个对等协议，允许任何一端发起通信。只要考题里涉及了 VoIP 或者对等服务，
那一定是选 Diameter 集中访问控制系统了。
4.总结：
RADIUS：开放 C/S，仅 PPP 拨号，UDP，仅加密密码，AAA 整合，远程审计，单挑战，256AVP。
TACACS：身份验证+授权=》不分离，UPP。
X-TACACS：扩展的，AAA 分离即隔离=验证-授权-审计。
TACACS+：C/S，动态密码，多网络协议，TCP，全加密，AAA 分离，更多 AVP，多挑战。
Diameter：对等通信，TCP，移动 IP，VoIP，不兼容，2
32AVP，AVP 是指属性值对。
B.4 会话管理（例如：超时、屏保）
很简单。区分桌面会话（人面界面）和逻辑会话（后台通信）。
B.5 身份注册与证明
身份验证是收集和验证身份信息的过程，验证某人所请求的帐户或凭证确定是其本人。
1.电子认证
电子认证(E 认证)是建立在信任用户提交电子身份给信息系统的过程。
2.美国联邦机构之间的信任
在美国，联邦机构负责核实或验证个人身份的问题凭据，一旦某人或主体的信任被认可，
就会建立和绑定身份证明到个人身份验证(PIV)证书（相当于 kerberos 里的 TGT），有了证书，
就可以被整个联邦企业信赖和接受。
3.联合身份管理
在联合环境中，联盟中的每个组织应遵守的一套共同的政策，标准和程序，并配置和管理
用户身份标识，身份验证，授权信息。这样，用户可以实现跨平台的单点登陆。联合身份管理
系统使用两种方法来实现信任链：一是交叉认证，二是第三方认证。
4.交叉认证模式
每个组织都必须单独证明每一个其他参与组织都值得信任（任意两个之间都要确认可信）。
这样，一旦组织的数量达到几个以上，组织之间的信任关系会急剧增加（类似于对称密钥的管
理）。
5.可信的第三方模型
很多集中式的身份认证都是这样的。PKI 什么的。
B.6 联合身份管理（例如：SAML）
一、联合身份管理与 SSO
一个完整的体系可以用 Kerberos 来实现单点登陆，但如果在互联网上或者其它很多异构
集成的系统环境里，只能靠联合身份管理来实现单点登陆了。像使用 QQ、微信就可以登陆各
—161—
大论坛什么的，这里要重点讲各种系统间交互通信使用的语言了：
其中 SAML 主要用于单点登陆；XACML 主要用于软件定义网络。
①GML=>SGML=>HTML
超文本标记语言超文本标记语言(HTML)用于展示静态网页,它源自通用标记语言(GML) 和
标准通用标记语言（SGML)。
②XML=>SAML
可扩展标记语言(XML)不仅是对数据显示方式的描述，它实现了对数据本身的描述。安全
断言标记语言(SAML) Security Assertion Markup Language 是一种基于 XML 的语言，也称安
全声明标记语言。普遍用于联合组织之间交换认证和授权(AA)信息（提供身份验证信息给联合
身份管理系统，即以标准格式发送诸如密码、密钥或者数字证书等身份验证消息），为浏览器
访问提供单点登录(SSO)功能。SAML2.0 实现基于 Web 的认证和授权方案，包括单点登录(SSO)。
SAML 规范定义了三种角色：User 委托人 IDP 验证 SP 服务
*委托人(通常是用户) principal。
*身份提供者(IDP) identity provider。
*服务提供商(SP) service provider。
当使用 SAML，委托人请求来自服务提供商的服务。服务提供商请求并获取身份提供者的
身份声明。在此声明的基础上，服务提供商可以进行访问控制决策。
SAML 数据可以通过不同类型的协议传输，但常用的一个协议是简单对象访问协议(Simple
Object Access Protocol)。SOAP 是一个规范，规定了如何以结构化方式交换与 Web 服务有关
的信息。它提供了基本的消息框架，使得用户可以请求一个服务，同时，该服务也可以提供给
该用户。比如，你需要与你公司的顾客关系管理系统进行交互，假设该系统由供货商 A.com 托
管和维护。你登录公司的门户网站后点击 A.com 的链接，你公司的门户便会接受这个请求和你
的身份验证数据，然后以 SAML 形式打包，把数据封装进入一个 SOAP 消息。这个消息通过 HTTP
连接发送给 A.com 供应商网站，一旦你的身份得到验证，你便会看到公司顾客数据库的内容了。
以这种方式使用 Web 服务也使得组织可以提供面向服务体系结构 SOA(Service Oriented
Architecture)的环境。
③XML=>DSML=>SPML
服务供应标记语言(SPML) Service Provisioning Markup Language 是基于 XML 的新框架，
但是出于联合身份单点登录目的，专门设计用于用户信息交换（交换供应数据 ）。SPML 基于
目录服务标记语言(DSML) Directory Service Markup Language，而 DSML 可以 XML 格式显示
基于轻量级自录访问协议(LOAP)的目录服务信息。
SPML 由 3 个主要实体组成：RA 请求 PSP 响应 PST 供应
*请求机构 RA(Requesting Authority)：请求建立新账户或对己有账户进行修改的实体。
*供应服务提供者 PSP(provisioning Service Provider)：响应账户请求的软件。
*供应服务目标 PST(provisioning Service Target, PST)：在被请求要修改的目标系统
上执行配置活动的实体。
④XML=>XACML/EACML
扩展访问控制标记语言(XACML) Extensible Access Control Markup Langua 用于在 XML
—162—