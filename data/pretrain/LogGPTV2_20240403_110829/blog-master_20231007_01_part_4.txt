dis_by_srid_4326     | 0.00012205033392033374  
dis_by_srid_3857     | 15.018266874472049  
dist_within_5_meters | f  
-[ RECORD 10 ]-------+--------------------------------------------------------------------------  
uid                  | 1  
uid                  | 11  
m                    | 1696666719.784847  
ts                   | 2023-10-07 08:18:39.784847+00  
a                    | MULTIPOINT M ((121.01649247573907 30.253476133300673 1696666719.784847))  
b                    | MULTIPOINT M ((121.01654042665702 30.25344092913426 1696666719.784847))  
tra_meters           | 6.043744124177614  
line_meters          | 0.014478272570600022  
dis_by_srid_4326     | 5.948633343239396e-05  
dis_by_srid_3857     | 11.82060975306182  
dist_within_5_meters | f  
```  
得到了10月7日与受害人有过近距离接触(1米以内)的信息:   
- 谁? b.uid   
- 什么时间? ts   
- 什么地点? apos, bpos   
- 接触点距离多近? tra_meters   
PS: 如果使用ganos可以得到更多的信息, 当我们限定小于N米距离表示接触, 返回的是数组, 而不仅仅是一个点的信息.    
数组提供了更多的信息, 例如伴随路径,时间等.  有兴趣的同学请继续研究Ganos插件.  
```  
with   
-- a 受害人(ID=1) 10.7号轨迹  
a as (select uid, ST_MakeLine(pos order by ts) as tra from user_pos where uid=1 and ts >= '2023-10-07' and ts  1 and ts >= '2023-10-07' and ts < '2023-10-08' group by 1)   
select   
  a.uid,  
  b.uid,  
  -- 两条轨迹相隔最近时的M值, 这里M代表时间戳   
  ST_ClosestPointOfApproach(a.tra, b.tra) m,  
  -- 将M转换为时间戳  
  to_timestamp(ST_ClosestPointOfApproach(a.tra, b.tra)) ts,  
  -- 两条轨迹最近时轨迹a的位置   
  st_astext(ST_LocateAlong(a.tra, ST_ClosestPointOfApproach(a.tra, b.tra))) apos,  
  -- 两条轨迹最近时轨迹b的位置   
  st_astext(ST_LocateAlong(b.tra, ST_ClosestPointOfApproach(a.tra, b.tra))) bpos,  
  -- 使用球坐标计算两条轨迹最近时的距离, 单位米  
  ST_DistanceSpheroid(ST_LocateAlong(a.tra, ST_ClosestPointOfApproach(a.tra, b.tra)), ST_LocateAlong(b.tra, ST_ClosestPointOfApproach(a.tra, b.tra))) tra_meters,   
  -- 不管轨迹M值, 以纯线段的方式计算2条轨迹的距离, 单位米  
  ST_DistanceSpheroid(a.tra, b.tra) line_meters,   
  -- 由于轨迹使用4326坐标系, 不转换坐标系, 使用ST_DistanceCPA计算两条轨迹最近时的距离得到的是degree单位的值  
  ST_DistanceCPA(a.tra, b.tra) dis_by_srid_4326,   
  -- 将几何对象转换为适用于米的投影坐标参考系统  
  -- 转换为BD-09（百度坐标系）的EPSG代码是EPSG：3857, GCJ-02和BD-09是非标准的坐标系，其转换结果可能存在一定的误差。  
  ST_DistanceCPA(ST_Transform(a.tra,3857), ST_Transform(b.tra,3857)) dis_by_srid_3857,   
  -- 接触点距离是否在1米以内?    
  ST_DistanceSpheroid(ST_LocateAlong(a.tra, ST_ClosestPointOfApproach(a.tra, b.tra)), ST_LocateAlong(b.tra, ST_ClosestPointOfApproach(a.tra, b.tra))) < 1 dist_within_1_meters   
from a,b   
where   
  -- 接触点距离在1米以内    
  ST_DistanceSpheroid(ST_LocateAlong(a.tra, ST_ClosestPointOfApproach(a.tra, b.tra)), ST_LocateAlong(b.tra, ST_ClosestPointOfApproach(a.tra, b.tra))) < 1   
;    
```  
```  
 uid |  uid  |         m          |              ts               |                                   apos                                    |                                   bpos                      
                |      tra_meters      |     line_meters      |    dis_by_srid_4326    |  dis_by_srid_3857   | dist_within_1_meters   
-----+-------+--------------------+-------------------------------+---------------------------------------------------------------------------+-----------------------------------------------------------  
----------------+----------------------+----------------------+------------------------+---------------------+----------------------  
   1 |    16 | 1696711287.0637639 | 2023-10-07 20:41:27.063764+00 | MULTIPOINT M ((121.179514921611 30.202250277204946 1696711287.0637639))   | MULTIPOINT M ((121.17951589281729 30.202247724543867 16967  
11287.0637639)) |  0.29802977629678595 | 0.017088185140647746 | 2.7311756121174723e-06 |   9.851859586106789 | t  
   1 |    23 | 1696673079.4389594 | 2023-10-07 10:04:39.438959+00 | MULTIPOINT M ((121.19259837793997 30.102287001200715 1696673079.4389594)) | MULTIPOINT M ((121.19259184264052 30.1022845365676 1696673  
079.4389594))   |   0.6866180882664799 |                    0 |  6.984594030331777e-06 |   0.331713166532339 | t  
   1 |    24 | 1696694100.1699324 | 2023-10-07 15:55:00.169932+00 | MULTIPOINT M ((121.31577521460606 30.12400778947977 1696694100.1699324))  | MULTIPOINT M ((121.31577443009843 30.124007099270315 16966  
94100.1699324)) |  0.10756191927499771 |  0.00909950209249224 | 1.0449105905812406e-06 |  0.5964301291912145 | t  
   1 |    52 |  1696687781.956004 | 2023-10-07 14:09:41.956004+00 | MULTIPOINT M ((121.32612384229635 30.38429201588597 1696687781.956004))   | MULTIPOINT M ((121.32612636452372 30.38429238351746 169668  
7781.956004))   |  0.24581924311992584 | 0.045892882767090054 | 2.5488788815666763e-06 |   0.641131518765304 | t  
   1 |    66 | 1696710449.2383232 | 2023-10-07 20:27:29.238323+00 | MULTIPOINT M ((121.19927072257184 30.224691424142552 1696710449.2383232)) | MULTIPOINT M ((121.1992771364212 30.22468591556549 1696710  
449.2383232))   |   0.8684180012921737 | 0.002397637444492437 |  8.454696012053516e-06 |  0.3008637252343871 | t  
   1 |    86 |  1696718794.016806 | 2023-10-07 22:46:34.016806+00 | MULTIPOINT M ((121.14680299750056 30.3187883438485 1696718794.016806))    | MULTIPOINT M ((121.14679871755352 30.318787521913755 16967  
18794.016806))  |   0.4215941825998081 | 0.011436598849449354 |  4.358155945315723e-06 |  1.9039684461333242 | t  
   1 |   274 | 1696663952.4315116 | 2023-10-07 07:32:32.431512+00 | MULTIPOINT M ((121.5712085725069 28.75975077080727 1696663952.4315116))   | MULTIPOINT M ((121.57121841057288 28.75975119167405 169666  
3952.4315116))  |   0.9619502356195184 |   0.7167056969789865 |  9.844668142077385e-06 |   87.66814056462134 | t  
   1 |   952 | 1696704013.8419132 | 2023-10-07 18:40:13.841913+00 | MULTIPOINT M ((121.02689413772583 29.755560576553346 1696704013.8419132)) | MULTIPOINT M ((121.02689975697152 29.755556990628868 16967  
04013.8419132)) |   0.6733482055635507 |    2.346209489731119 |  6.665941503573243e-06 |  488.70467529515736 | t  
   1 |  1327 |  1696700397.318303 | 2023-10-07 17:39:57.318303+00 | MULTIPOINT M ((119.1528412981224 29.633691846618653 1696700397.318303))   | MULTIPOINT M ((119.15284157641521 29.633690893539352 16967  
00397.318303))  |  0.10902846597912982 |   1.2128953826930036 |  9.928781387071022e-07 |  1309.0723316207764 | t  
   1 |  2695 | 1696647326.8443363 | 2023-10-07 02:55:26.844336+00 | MULTIPOINT M ((121.92014894145804 27.304754500296355 1696647326.8443363)) | MULTIPOINT M ((121.92015071659038 27.304754978416668 16966  
47326.8443363)) |  0.18352642902869487 |   0.9494438906882574 | 1.8383937871086966e-06 |   7.784088226800597 | t  
   1 |  3364 | 1696641956.2189903 | 2023-10-07 01:25:56.21899+00  | MULTIPOINT M ((121.41641340264665 30.021485305571048 1696641956.2189903)) | MULTIPOINT M ((121.41641216383304 30.02148641679296 169664  
1956.2189903))  |  0.17162380732232013 |   2.3485449598985473 | 1.6641733275123874e-06 |    550.393623662213 | t  
   1 |  3789 | 1696663613.1192298 | 2023-10-07 07:26:53.11923+00  | MULTIPOINT M ((121.40490159148867 30.200234662606675 1696663613.1192298)) | MULTIPOINT M ((121.40489893844436 30.20023209944578 169666  
3613.1192298))  |  0.38209898283152377 |    3.872682948316315 |  3.688961601972608e-06 |  46.000064987674314 | t  
   1 |  4068 | 1696682013.1714096 | 2023-10-07 12:33:33.17141+00  | MULTIPOINT M ((119.93563328628541 28.850422898067126 1696682013.1714096)) | MULTIPOINT M ((119.93562673342112 28.850428047415246 16966  
82013.1714096)) |   0.8570762232397039 |   1.8629634196314546 |  8.334010286706677e-06 |   735.0353589180091 | t  
   1 |  4099 | 1696669913.0897362 | 2023-10-07 09:11:53.089736+00 | MULTIPOINT M ((120.29306461217404 29.688800785332756 1696669913.0897362)) | MULTIPOINT M ((120.29306242512594 29.688803564647078 16966  
69913.0897362)) |  0.37379045863241284 |   0.6226158277989603 | 3.5366321082731683e-06 |   1.136634126525745 | t  
   1 |  4528 | 1696663512.3624809 | 2023-10-07 07:25:12.362481+00 | MULTIPOINT M ((121.18744072338018 30.055323946348103 1696663512.3624809)) | MULTIPOINT M ((121.18744373676509 30.055320590695686 16966  
63512.3624809)) |  0.47203288535668314 |   0.0796265326726013 |  4.510087007300477e-06 |   63.61717791178923 | t  
   1 |  5023 | 1696660785.0599978 | 2023-10-07 06:39:45.059998+00 | MULTIPOINT M ((120.31567452233169 30.33319997797012 1696660785.0599978))  | MULTIPOINT M ((120.31567394096454 30.333205461349326 16966  
60785.0599978)) |   0.6104422435811728 |    6.606695991314753 |   5.51411236933417e-06 |   18.08601410579314 | t  
   1 |  7206 |  1696668790.211112 | 2023-10-07 08:53:10.211112+00 | MULTIPOINT M ((120.34997429162875 28.534545109640586 1696668790.211112))  | MULTIPOINT M ((120.34996892932537 28.534548239535944 16966  
68790.211112))  |   0.6290966371161706 |  0.12981873625900192 |  6.208903406239915e-06 |  112.07658805087544 | t  
   1 |  8632 | 1696650655.8955953 | 2023-10-07 03:50:55.895595+00 | MULTIPOINT M ((121.30070905862821 30.16942004348692 1696650655.8955953))  | MULTIPOINT M ((121.30070950977675 30.16941753082198 169665  
0655.8955953))  |   0.2819116116153599 |   0.3913363732213239 |   2.55284548387773e-06 |   632.2620269064657 | t  
   1 |  9696 |  1696642867.062975 | 2023-10-07 01:41:07.062975+00 | MULTIPOINT M ((119.40510418914995 29.055729341015063 1696642867.062975))  | MULTIPOINT M ((119.40510654029482 29.055725577834817 16966  
42867.062975))  |  0.47581336309293903 |    3.893366703063385 |  4.437269238523562e-06 |   5.288463000900437 | t  
   1 | 11896 | 1696721585.6198063 | 2023-10-07 23:33:05.619806+00 | MULTIPOINT M ((121.07395726798376 29.878972859509787 1696721585.6198063)) | MULTIPOINT M ((121.07395331916851 29.87898024074505 169672  
1585.6198063))  |   0.9027680653917985 |   0.6255647656136949 |  8.371127345071201e-06 |    64.6081576523878 | t  
   1 | 13063 | 1696649954.7468536 | 2023-10-07 03:39:14.746854+00 | MULTIPOINT M ((121.20000680392235 30.105817676956953 1696649954.7468536)) | MULTIPOINT M ((121.2000091227254 30.10581209936282 1696649  
954.7468536))   |   0.6574532265314424 |   1.9329580861436884 |  6.040397579310141e-06 |   531.6967470710825 | t  
   1 | 13587 |  1696711803.128927 | 2023-10-07 20:50:03.128927+00 | MULTIPOINT M ((119.07367600150013 29.85209721119952 1696711803.128927))   | MULTIPOINT M ((119.07367828417577 29.852101037245045 16967  
11803.128927))  |    0.478045538186566 |    2.090900002113868 |  4.455247558710363e-06 |   305.4389715213877 | t  
   1 | 14041 | 1696658132.7981834 | 2023-10-07 05:55:32.798184+00 | MULTIPOINT M ((121.11449072455301 30.032905229462518 1696658132.7981834)) | MULTIPOINT M ((121.11448320610805 30.03290622711798 169665  
8132.7981834))  |   0.7335717485850729 |   0.3177401891905778 |  7.584347753932764e-06 |  0.6588516977908566 | t  
   1 | 14622 |  1696674662.383303 | 2023-10-07 10:31:02.383303+00 | MULTIPOINT M ((121.07033762680425 29.952296948501136 1696674662.383303))  | MULTIPOINT M ((121.07033441427465 29.95229793209586 169667  
4662.383303))   |    0.328722362310889 |    3.086186293730716 | 3.3597306224091628e-06 |   44.01831471657201 | t  
   1 | 15953 | 1696663955.8399303 | 2023-10-07 07:32:35.83993+00  | MULTIPOINT M ((121.6488664509217 27.19355037475692 1696663955.8399303))   | MULTIPOINT M ((121.64886419408023 27.193550105075076 16966  
63955.8399303)) |  0.22560556491183936 |    2.491284217827418 | 2.2728894996621646e-06 |   74.97603981523513 | t  
   1 | 16797 |  1696718896.481428 | 2023-10-07 22:48:16.481428+00 | MULTIPOINT M ((121.17288679807335 30.311123260317743 1696718896.481428))  | MULTIPOINT M ((121.17288692095798 30.311125603308906 16967  
18896.481428))  |   0.2600074038834392 |    1.210765255876662 | 2.3462112896858327e-06 |   70.09228534239557 | t  
   1 | 18097 | 1696659096.7449162 | 2023-10-07 06:11:36.744916+00 | MULTIPOINT M ((120.53668731952148 29.7592912382516 1696659096.7449162))   | MULTIPOINT M ((120.53668838062474 29.759289984552908 16966  
59096.7449162)) |  0.17275798154757635 |   1.9498709588371512 |  1.642464899633402e-06 |  36.233765093536924 | t  
   1 | 18882 | 1696639805.7521462 | 2023-10-07 00:50:05.752146+00 | MULTIPOINT M ((119.6124845246315 28.64298624162674 1696639805.7521462))   | MULTIPOINT M ((119.61248300951765 28.642988010927912 16966  
39805.7521462)) |  0.24575593461307804 |    5.802797653265205 |  2.322357829352477e-06 |  143.61260299577694 | t  
   1 | 19457 | 1696656978.8593462 | 2023-10-07 05:36:18.859346+00 | MULTIPOINT M ((121.10964313701689 30.402930613937972 1696656978.8593462)) | MULTIPOINT M ((121.10963806079896 30.40293190715813 169665  
6978.8593462))  |   0.5084262779846881 |    3.807638967543638 |  5.238359074282207e-06 |   42.12943050167923 | t  
   1 | 19678 | 1696650788.7621696 | 2023-10-07 03:53:08.76217+00  | MULTIPOINT M ((120.84112391397 30.047119638786313 1696650788.7621696))    | MULTIPOINT M ((120.84112381650385 30.047125125868476 16966  
50788.7621696)) |   0.6083334446277675 |    8.728381673141044 | 5.4879466491573395e-06 |  60.861701682359524 | t  
   1 | 21128 | 1696708386.1945717 | 2023-10-07 19:53:06.194572+00 | MULTIPOINT M ((120.9928735683901 29.87562772511755 1696708386.1945717))   | MULTIPOINT M ((120.99286666991779 29.875633057211466 16967  
08386.1945717)) |   0.8907831312494247 |   1.0357927351704053 |   8.71894615022157e-06 |   73.75950712682116 | t  
   1 | 21551 | 1696698455.0804508 | 2023-10-07 17:07:35.080451+00 | MULTIPOINT M ((119.88332710919182 28.654636776875787 1696698455.0804508)) | MULTIPOINT M ((119.88333363973983 28.65463173629246 169669  
8455.0804508))  |   0.8483423712009329 |   2.9175268316100946 |  8.249572975777566e-06 |   4.501173204575792 | t  
   1 | 23654 | 1696699004.4357011 | 2023-10-07 17:16:44.435701+00 | MULTIPOINT M ((120.32586305058003 28.224965540361406 1696699004.4357011)) | MULTIPOINT M ((120.32585392021389 28.224969466135896 16966  
99004.4357011)) |   0.9962285275669108 |    0.661942929711958 |  9.938375337237118e-06 |  279.42689827781703 | t  
   1 | 23675 |  1696669082.721245 | 2023-10-07 08:58:02.721245+00 | MULTIPOINT M ((121.33878123431359 30.225555129353545 1696669082.721245))  | MULTIPOINT M ((121.33878206818201 30.225553685528325 1696669082.721245))  |   0.1790592710016045 |   0.4590342533974994 | 1.6673235008993733e-06 |   5.607515229442826 | t  
   1 | 23748 |  1696701785.699044 | 2023-10-07 18:03:05.699044+00 | MULTIPOINT M ((121.1557328856501 30.311444374110813 1696701785.699044))   | MULTIPOINT M ((121.15573356432371 30.3114430549314 1696701785.699044))    |  0.16014871340427175 |    6.178921128890516 | 1.4835174577443446e-06 |  112.76922786042378 | t  
   1 | 25113 | 1696638867.9027693 | 2023-10-07 00:34:27.902769+00 | MULTIPOINT M ((120.43506771830249 29.41975734770522 1696638867.9027693))  | MULTIPOINT M ((120.43507174377926 29.419752871159407 1696638867.9027693)) |    0.631513163631407 |    9.127728575333236 |  6.020292719404112e-06 |  466.17290199731866 | t  
   1 | 26233 | 1696655643.9096806 | 2023-10-07 05:14:03.909681+00 | MULTIPOINT M ((121.44488671377087 30.262630868972778 1696655643.9096806)) | MULTIPOINT M ((121.44488465822698 30.262627062319194 1696655643.9096806)) |   0.4660541982066187 |    4.130090572881211 |  4.326184475629882e-06 |  1003.0412364550547 | t  
   1 | 27030 | 1696658261.5684383 | 2023-10-07 05:57:41.568438+00 | MULTIPOINT M ((120.38403054710031 28.780095603967563 1696658261.5684383)) | MULTIPOINT M ((120.38402775609217 28.78009681124826 1696658261.5684383))  |   0.3036026084604519 |   2.6057327750869943 |   3.04092088004529e-06 |  141.69170818971094 | t  