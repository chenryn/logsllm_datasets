Security Information Event
Management (SIEM): Email Logs
SIEM | Forcepoint Email Security | Updated: 29-Apr-2022
Applies To: Forcepoint Email Security v8.5.x
Third-party security information and event management (SIEM) tools allow the
logging and analysis of internal operations and activities generated by network
devices and software. Integration of Forcepoint Email Security with SIEM technology
allows the transfer of message traffic events to a third-party SIEM system for analysis
and reporting. The following email protection system logs can send data to a SIEM
server:
● Connection
● Message
● Policy
● Delivery
● Hybrid
● Audit
● Console
Third-party SIEM providers may not support FIPS 140-2 Level 1 certified
cryptography. Contact your SIEM provider for more information if FIPS-certified
cryptography is required.
Contents:
● Enabling SIEM in Forcepoint Email Security
● SIEM integration formats
● SIEM log format reference
● CEF key-value table
● LEEF key-value table
● Splunk key-value table
● Log format reference
© 2022 Forcepoint
Enabling SIEM in Forcepoint Email Security
SIEM | Forcepoint Email Security | Updated: 29-Apr-2022
Applies To: Forcepoint Email Security v8.5.x
Access SIEM integration settings on the SIEM Integration page of the Forcepoint
Security Manager Email Security module to enable SIEM integration and configure
the SIEM server and transport protocol.
Enable SIEM integration
1. From the Forcepoint Security Manager, navigate to the page Settings>
General> SIEM Integration.
The SIEM Integration page displays.
2. Mark the check box Enable SIEM integration for all email appliances.
SIEM configuration settings are enabled for editing.
3. Configure SIEM settings and click OK.
SIEM integration functions are activated. Following activation, configure SIEM
settings as detailed below.
Configure SIEM integration
1. In the entry field IP address or hostname, enter the IP address or hostname for
the SIEM integration server.
2. In the entry field Port, enter the port number for the SIEM integration server.
The default is 514.
3. From the section Transport protocol, select the protocol used for data transport,
either UDP or TCP.
User datagram protocol (UDP) is a transport layer protocol in the Internet protocol
suite. UDP is stateless and therefore faster than transmission control protocol
(TCP), but it can be unreliable. Like UDP, TCP is a transport layer protocol, but it
provides reliable, ordered data delivery at the expense of transport speed.
Tip
When using TCP, it is recommended to end all logs with
%.
From the pull-down menu SIEM format, select the format to be used in SIEM
logs.
The format determines the syntax of the string used to pass log data to the
integration.
■ The available formats are syslog/CEF (ArcSight), syslog/key-value pairs
(Splunk and others), syslog/LEEF (QRadar), and Custom.
SIEM: Email Logs  2
■ The text boxes populate with CEF format when Custom is selected, and can
be edited as needed. The maximum size for each format is 2048 characters.
Logs are not saved to the SIEM server for any log fields left blank. Selection
of a new template returns any edited custom format to the default.
■ Sample formats display for non-custom options.
4. Confirm that the SIEM product is properly configured and can receive messages
from the email software; click Send Test Message.
5. Configure additional SIEM settings and click OK.
The SIEM configuration settings are saved.
SIEM integration formats
SIEM | Forcepoint Email Security | Updated: 29-Apr-2022
Applies To: Forcepoint Email Security v8.5.x
Enabling SIEM integration in Forcepoint Email Security allows log data to be saved
to the SIEM server using several predefined formats: syslog/common event format
(CEF) (for ArcSight), syslog/key-value pairs (Splunk), and syslog log event extended
format (LEEF) (QRadar).
The following should be considered when working with CEF and LEEF formats,
which use UTF-8 character encoding:
● Spaces used in header fields or extension values are valid. The encoding 
is not used.
● A vertical bar, or pipe, (|) used in a CEF header must be escaped with a backslash
(\). However, a vertical bar in an extension section does not need an escape
character.
● A backslash (\) used in the header or the extension must be escaped with a second
backslash (\).
● An equals sign (=) used in an extension must be escaped with a backslash (\).
Equals signs in the header do not need an escape character.
● Multi-line fields can be sent by CEF by encoding the newline character \n or \r.
Multiple lines are allowed only in the value part of the key-value extensions.
SIEM log format reference
The following details the basic syntax of a SIEM record in CEF, LEEF, and Splunk
formats.
CEF:
● Header
SIEM: Email Logs  3
% % CEF:0|Device
Vendor|Device Product|Product Version|Log Type|LogReason|5|
● Data
key1=value1 key2=value2
Key value pairs are separated by a space.
LEEF:
● Header
% % LEEF:1.0|Device
Vendor|Device Product|Product Version|Log Type|Log Reason|5|
● Data
key1=value1%key2=value2
Key value pairs are separated by a tab.
Splunk:
● Header
% %
● Data
key1=value1 key2=value2 key3="value 3"
Splunk format includes a syslog protocol prefix, a header, and a set of extensions
comprising key-value pairs. CEF and LEEF formats include a syslog protocol prefix,
a header, and a set of extensions comprising key-value pairs:
PRI SP HEADER SP CEF:Version|Device_Vendor|Device_Product
|Device_Version|Signature_ID|Name|Severity|Extension
● PRI (priority value) is a combination of (Facility Level value*8) + Severity
Level. The default values are:
Facility Level (user-level messages) = 1
Severity Level (Notice: Normal but significant condition) = 5
● Header includes a timestamp (format MMM-dd hh:mm:ss) and the appliance
hostname, separated by a space (SP).
● CEF or LEEF indicates the common event or long event extended format portion
of the data record and contains the following fields:
■ Version identifies the current CEF or LEEF format version.
■ The Device_Vendor field is a unique identifier. Along with Device_Product,
it identifies the device. In this case, Device_Vendor is Forcepoint.
■ The Device_Product field is a unique identifier. Along with Device_Vendor,
it identifies the device sending the data to SIEM. In this case,
Device_Product is Email Security.
■ The Device_Version field indicates the Device_Product version.
SIEM: Email Logs  4
■ The Signature_ID field is a unique event-type indicator. In this case, the field
identifies the type of email protection system log that is generating the record:
Connection, Message, Policy, Delivery, Audit, Console, or Hybrid (for email
hybrid service traffic).
■ The Name component is the event description. For the policy log, this field
contains the message analysis result. For the other email protection logs, this
field contains the log type.
■ Severity is a value between 0 and 10 that indicates the importance of an
event. A higher severity value indicates increased event importance. Default
value is 5.
■ The Extension field contains a set of pre-defined key-value pairs separated by
spaces. See CEF key-value table, page 5, for details about these entries for
Forcepoint Email Security.
CEF key-value table
The following table contains a list of all the CEF key names used to log data from
these Forcepoint Email Security logs:
● Connection
● Message
● Policy
● Delivery
● Hybrid
● Audit
● Console
See Log format reference, page 12, for details about the specific format of each log.
CEF Key Name Full Name Key Value Forcepoint
Email
Security
Log
act deviceAction Policy action result Policy
Message delivery status Delivery,
Hybrid,
Audit
app applicationProtocol Transport protocol Connection,
Delivery
cat deviceEventCategory Antispam tool name Policy
cc cc Message header “Cc” Message
cs1 deviceCustomString1 Virus name Policy
SIEM: Email Logs  5
CEF Key Name Full Name Key Value Forcepoint
Email
Security
Log
deliveryCode n/a Delivery status code Delivery
deliveryCodeInfo n/a Delivery status Delivery
information
deviceDirection deviceDirection Email direction: Policy
inbound/internal = 0
outbound = 1
deviceFacility deviceFacility Policy name Policy
deviceProcessName deviceProcessName Policy rule name Policy
dst destinationAddress Email destination IP Delivery
address
duser destinationUserName Destination (recipient) Message,
user name Policy,
Delivery,
Hybrid
dvc deviceAddress Email appliance IP Connection,
address Message,
Policy,
Delivery,
Hybrid,
Audit
dvchost deviceHostName Email appliance fully Connection,
qualified domain name Message,
(FQDN) Policy,
Delivery,
Hybrid
element n/a Element on the page to Audit
which the change was
applied
encryptedDelivery n/a Encryption type Delivery
exceptionReason n/a Reason for exception Policy
(e.g., DLP policy, file
sandbox, antivirus or
antispam analysis)
externalID externalID Connection ID Connection,
Message,
Delivery
fnameAndHash n/a Message attachments in Policy
the format:
||
from from Message header “from” Message,
Policy
SIEM: Email Logs  6
CEF Key Name Full Name Key Value Forcepoint
Email
Security
Log
hybridSpamScore n/a Email hybrid service Policy
spam score
in bytesIn Inbound email size Message,
Policy,
Hybrid
localSpamScore n/a On-premises email spam Policy
score
messageID n/a Message ID number Message,
Policy,
Delivery,
Hybrid
msg message Message subject Audit
page n/a Page to which a change Audit
was made
reason reason Connection status details Connection
Hybrid analysis result Hybrid
replyTo n/a Message header Policy
“replyTo”
rt deviceReceiptTime Time of event receipt Connection,
(format is MMM dd yyyy Message,
HH:mm:ss) Policy,
Delivery,
Hybrid,
Audit
spamScore n/a Email hybrid service Hybrid
spam score
spfResult n/a Relay control SPF check Connection
result
spriv n/a Role of the user that Audit
made a change
src sourceAddress Email source IP address Connection,
Delivery,
Hybrid,
Audit
suser sourceUserName User that made a change Audit
suser sourceUserName Envelope sender Message
Policy,
Hybrid
to n/a Message header “to” Message
trueSrc n/a True source IP address Message,
Policy
SIEM: Email Logs  7
CEF Key Name Full Name Key Value Forcepoint
Email
Security
Log
url n/a Message embedded Policy
URLs in the format:
||
x-mailer n/a Email client Message
LEEF key-value table
The following table contains a list of all the LEEF key names used to log data from
these Forcepoint Email Security logs:
● Connection
● Message
● Policy
● Delivery
● Hybrid
● Audit
● Console
See Log format reference, page 12, for details about the specific format of each log.
LEEF Key Name Key Value Forcepoint Email
Security Log
accountName User that made a change Audit
act Policy action result Policy
Message delivery status Delivery, Hybrid,
Audit
cat Antispam tool name Policy
cc Message header “Cc” Message
connectionID Connection ID Connection,
Message, Delivery
deliveryCode Delivery status code Delivery
deliveryCodeInfo Delivery status information Delivery
devTime Time of event receipt (format is MMM dd Connection,
yyyy HH:mm:ss) Message, Policy,
Delivery, Hybrid,
Audit
SIEM: Email Logs  8
LEEF Key Name Key Value Forcepoint Email
Security Log
deviceDirection Email direction: Policy
inbound/internal = 0 outbound = 1
deviceFacility Policy name Policy
deviceProcessName Policy rule name Policy
dst Email destination IP address Delivery
dvc Email appliance IP address Connection,
Message, Policy,
Delivery, Hybrid,
Audit