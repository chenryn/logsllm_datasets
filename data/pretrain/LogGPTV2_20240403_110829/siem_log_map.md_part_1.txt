### Security Information and Event Management (SIEM): Email Logs
**Forcepoint Email Security | Updated: 29-Apr-2022**
**Applies To: Forcepoint Email Security v8.5.x**

Third-party Security Information and Event Management (SIEM) tools facilitate the logging and analysis of internal operations and activities generated by network devices and software. Integrating Forcepoint Email Security with SIEM technology allows the transfer of message traffic events to a third-party SIEM system for analysis and reporting. The following email protection system logs can send data to a SIEM server:

- Connection
- Message
- Policy
- Delivery
- Hybrid
- Audit
- Console

**Note:** Third-party SIEM providers may not support FIPS 140-2 Level 1 certified cryptography. Contact your SIEM provider for more information if FIPS-certified cryptography is required.

#### Contents:
- Enabling SIEM in Forcepoint Email Security
- SIEM Integration Formats
- SIEM Log Format Reference
- CEF Key-Value Table
- LEEF Key-Value Table
- Splunk Key-Value Table
- Log Format Reference

---

### Enabling SIEM in Forcepoint Email Security
**Forcepoint Email Security | Updated: 29-Apr-2022**
**Applies To: Forcepoint Email Security v8.5.x**

To enable SIEM integration, access the SIEM Integration settings in the Forcepoint Security Manager Email Security module. This will allow you to configure the SIEM server and transport protocol.

#### Enable SIEM Integration
1. **Navigate to the SIEM Integration Page:**
   - From the Forcepoint Security Manager, go to **Settings > General > SIEM Integration**.
   - The SIEM Integration page will be displayed.

2. **Enable SIEM Integration:**
   - Check the box labeled **Enable SIEM integration for all email appliances**.
   - This will enable the SIEM configuration settings for editing.

3. **Configure SIEM Settings:**
   - Click **OK** to activate SIEM integration.
   - After activation, proceed to configure the SIEM settings as detailed below.

#### Configure SIEM Integration
1. **Enter SIEM Server Details:**
   - In the **IP address or hostname** field, enter the IP address or hostname of the SIEM integration server.
   - In the **Port** field, enter the port number for the SIEM integration server. The default is 514.

2. **Select Transport Protocol:**
   - From the **Transport protocol** section, select either **UDP** or **TCP**.
   - **UDP** is stateless and faster but less reliable compared to **TCP**, which provides reliable, ordered data delivery at the expense of speed.
   - **Tip:** When using TCP, it is recommended to end all logs with `%`.

3. **Select SIEM Format:**
   - From the **SIEM format** pull-down menu, select the format to be used in SIEM logs.
   - Available formats include **syslog/CEF (ArcSight)**, **syslog/key-value pairs (Splunk and others)**, **syslog/LEEF (QRadar)**, and **Custom**.
   - If **Custom** is selected, the text boxes will populate with CEF format, which can be edited as needed. The maximum size for each format is 2048 characters.
   - Logs are not saved to the SIEM server for any log fields left blank. Selecting a new template will reset any edited custom format to the default.
   - Sample formats are displayed for non-custom options.

4. **Test SIEM Configuration:**
   - Click **Send Test Message** to confirm that the SIEM product is properly configured and can receive messages from the email software.

5. **Save Configuration:**
   - Configure any additional SIEM settings and click **OK** to save the SIEM configuration settings.

---

### SIEM Integration Formats
**Forcepoint Email Security | Updated: 29-Apr-2022**
**Applies To: Forcepoint Email Security v8.5.x**

Enabling SIEM integration in Forcepoint Email Security allows log data to be saved to the SIEM server using several predefined formats: **syslog/CEF (ArcSight)**, **syslog/key-value pairs (Splunk)**, and **syslog/LEEF (QRadar)**.

#### Considerations for CEF and LEEF Formats
- **Character Encoding:** CEF and LEEF formats use UTF-8 character encoding.
- **Header Fields and Extension Values:**
  - Spaces in header fields or extension values are valid.
  - A vertical bar (`|`) in a CEF header must be escaped with a backslash (`\`), but not in an extension section.
  - A backslash (`\`) in the header or extension must be escaped with a second backslash (`\\`).
  - An equals sign (`=`) in an extension must be escaped with a backslash (`\`), but not in the header.
  - Multi-line fields can be sent by CEF by encoding the newline character `\n` or `\r`. Multiple lines are allowed only in the value part of the key-value extensions.

---

### SIEM Log Format Reference
The following details the basic syntax of a SIEM record in CEF, LEEF, and Splunk formats.

#### CEF Format
- **Header:**
  - `%% CEF:0|Device Vendor|Device Product|Product Version|Log Type|Log Reason|5|`
- **Data:**
  - `key1=value1 key2=value2`
  - Key-value pairs are separated by a space.

#### LEEF Format
- **Header:**
  - `%% LEEF:1.0|Device Vendor|Device Product|Product Version|Log Type|Log Reason|5|`
- **Data:**
  - `key1=value1%key2=value2`
  - Key-value pairs are separated by a tab.

#### Splunk Format
- **Header:**
  - `%%`
- **Data:**
  - `key1=value1 key2=value2 key3="value 3"`
  - Splunk format includes a syslog protocol prefix, a header, and a set of extensions comprising key-value pairs.

#### Common Elements in CEF and LEEF Formats
- **PRI (Priority Value):** A combination of (Facility Level value * 8) + Severity Level.
  - Default values:
    - Facility Level (user-level messages) = 1
    - Severity Level (Notice: Normal but significant condition) = 5
- **Header:** Includes a timestamp (format `MMM-dd hh:mm:ss`) and the appliance hostname, separated by a space.
- **CEF or LEEF Fields:**
  - **Version:** Identifies the current CEF or LEEF format version.
  - **Device_Vendor:** Unique identifier. For Forcepoint, this is `Forcepoint`.
  - **Device_Product:** Unique identifier. For Forcepoint, this is `Email Security`.
  - **Device_Version:** Indicates the Device_Product version.
  - **Signature_ID:** Unique event-type indicator. For email protection system logs, this identifies the type of log (e.g., Connection, Message, Policy, Delivery, Audit, Console, or Hybrid).
  - **Name:** Event description. For policy logs, this contains the message analysis result. For other logs, it contains the log type.
  - **Severity:** A value between 0 and 10 indicating the importance of an event. Default value is 5.
  - **Extension:** Set of pre-defined key-value pairs separated by spaces.

---

### CEF Key-Value Table
The following table lists all the CEF key names used to log data from Forcepoint Email Security logs:

| CEF Key Name | Full Name | Key Value | Forcepoint Email Security Log |
|--------------|-----------|-----------|-------------------------------|
| act          | deviceAction | Policy action result | Policy |
| act          | Message delivery status | Delivery, Hybrid, Audit |
| app          | applicationProtocol | Transport protocol | Connection, Delivery |
| cat          | deviceEventCategory | Antispam tool name | Policy |
| cc           | cc | Message header “Cc” | Message |
| cs1          | deviceCustomString1 | Virus name | Policy |
| deliveryCode | n/a | Delivery status code | Delivery |
| deliveryCodeInfo | n/a | Delivery status information | Delivery |
| deviceDirection | deviceDirection | Email direction: inbound/internal = 0, outbound = 1 | Policy |
| deviceFacility | deviceFacility | Policy name | Policy |
| deviceProcessName | deviceProcessName | Policy rule name | Policy |
| dst          | destinationAddress | Email destination IP address | Delivery |
| duser        | destinationUserName | Destination (recipient) user name | Message, Policy, Delivery, Hybrid |
| dvc          | deviceAddress | Email appliance IP address | Connection, Message, Policy, Delivery, Hybrid, Audit |
| dvchost      | deviceHostName | Email appliance fully qualified domain name (FQDN) | Connection, Message, Policy, Delivery, Hybrid |
| element      | n/a | Element on the page to which the change was applied | Audit |
| encryptedDelivery | n/a | Encryption type | Delivery |
| exceptionReason | n/a | Reason for exception (e.g., DLP policy, file sandbox, antivirus or antispam analysis) | Policy |
| externalID   | externalID | Connection ID | Connection, Message, Delivery |
| fnameAndHash | n/a | Message attachments in the format: `||` | Policy |
| from         | from | Message header “from” | Message, Policy |
| hybridSpamScore | n/a | Email hybrid service spam score | Policy |
| in           | bytesIn | Inbound email size | Message, Policy, Hybrid |
| localSpamScore | n/a | On-premises email spam score | Policy |
| messageID    | n/a | Message ID number | Message, Policy, Delivery, Hybrid |
| msg          | message | Message subject | Audit |
| page         | n/a | Page to which a change was made | Audit |
| reason       | reason | Connection status details | Connection |
| reason       | Hybrid analysis result | Hybrid |
| replyTo      | n/a | Message header “replyTo” | Policy |
| rt           | deviceReceiptTime | Time of event receipt (format is MMM dd yyyy HH:mm:ss) | Connection, Message, Policy, Delivery, Hybrid, Audit |
| spamScore    | n/a | Email hybrid service spam score | Hybrid |
| spfResult    | n/a | Relay control SPF check result | Connection |
| spriv        | n/a | Role of the user that made a change | Audit |
| src          | sourceAddress | Email source IP address | Connection, Delivery, Hybrid, Audit |
| suser        | sourceUserName | User that made a change | Audit |
| suser        | sourceUserName | Envelope sender | Message, Policy, Hybrid |
| to           | n/a | Message header “to” | Message |
| trueSrc      | n/a | True source IP address | Message, Policy |
| url          | n/a | Message embedded URLs in the format: `||` | Policy |
| x-mailer     | n/a | Email client | Message |

---

### LEEF Key-Value Table
The following table lists all the LEEF key names used to log data from Forcepoint Email Security logs:

| LEEF Key Name | Key Value | Forcepoint Email Security Log |
|---------------|-----------|-------------------------------|
| accountName   | User that made a change | Audit |
| act           | Policy action result | Policy |
| act           | Message delivery status | Delivery, Hybrid, Audit |
| cat           | Antispam tool name | Policy |
| cc            | Message header “Cc” | Message |
| connectionID  | Connection ID | Connection, Message, Delivery |
| deliveryCode  | Delivery status code | Delivery |
| deliveryCodeInfo | Delivery status information | Delivery |
| devTime       | Time of event receipt (format is MMM dd yyyy HH:mm:ss) | Connection, Message, Policy, Delivery, Hybrid, Audit |
| deviceDirection | Email direction: inbound/internal = 0, outbound = 1 | Policy |
| deviceFacility | Policy name | Policy |
| deviceProcessName | Policy rule name | Policy |
| dst           | Email destination IP address | Delivery |
| dvc           | Email appliance IP address | Connection, Message, Policy, Delivery, Hybrid, Audit |

For more detailed information about the specific format of each log, refer to the **Log Format Reference** on page 12.

---

© 2022 Forcepoint