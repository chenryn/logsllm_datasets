driver on a Capture Hub. Capture also provides strong isola-
tion and security protections across devices and their drivers.
Our evaluation results show that several example IoT devices
can be modiﬁed to use Capture using one of our three integra-
tion approaches to get the security beneﬁts of Capture with
acceptable performance overheads.
Acknowledgement. We thank Jeremy Erickson, Haojian
Jin and the members of the Synergy Labs for helpful discus-
sions and feedback. Moreover, we greatly appreciate anony-
mous reviewers and our shepherd, Adwait Nadkarni, for their
valuable comments and feedback. This work was partially
supported by NSF Awards 1564009 and 1801472, Air Force
Research Laboratory agreement number FA8750-15-2-0281,
ONR Award N000141812618, and the Carnegie Mellon Cy-
Lab Security and Privacy Institute.
References
[2] Alasdair Allan.
Teardown of a smart plug (or
two). https://www.hackster.io/news/teardown-
of-a-smart-plug-or-two-6462bd2f275b, 2020.
[3] Omar Alrawi, Chaz Lever, Manos Antonakakis, and
Fabian Monrose. SoK: Security evaluation of home-
based IoT deployments. In 2019 IEEE Symposium on
Security and Privacy, 2019.
[4] Amazon Web Services. AWS IoT Greengrass. https:
//aws.amazon.com/greengrass/, 2020.
[5] Manos Antonakakis, Tim April, Michael Bailey, Matt
Bernhard, Elie Bursztein, Jaime Cochran, Zakir Du-
rumeric, J. Alex Halderman, Luca Invernizzi, Michalis
Kallitsis, Deepak Kumar, Chaz Lever, Zane Ma, Joshua
Mason, Damian Menscher, Chad Seaman, Nick Sullivan,
Kurt Thomas, and Yi Zhou. Understanding the mirai
botnet. In 26th USENIX Security Symposium, 2017.
[6] Apache JMeter.
https://jmeter.apache.org/,
2020.
[7] Andrew D Birrell and Bruce Jay Nelson. Implementing
remote procedure calls. ACM Transactions on Computer
Systems (TOCS), 1984.
[8] Sudershan Boovaraghavan, Anurag Maravi, Prahaladha
Mallela, and Yuvraj Agarwal. MLIoT: An end-to-end
machine learning system for the Internet-of-Things. In
6th ACM/IEEE Conference on Internet of Things Design
and Implementation, IoTDI, 2021.
[9] Sven Bugiel, Lucas Davi, Alexandra Dmitrienko,
Thomas Fischer, Ahmad-Reza Sadeghi, and Bhargava
Shastry. Towards taming privilege-escalation attacks on
Android. In NDSS, 2012.
[10] Daming D. Chen, Maverick Woo, David Brumley, and
Manuel Egele. Towards automated dynamic analysis
for Linux-based embedded ﬁrmware. In NDSS, 2016.
[11] CNET. Search engine shodan knows where your toaster
https://www.cnet.com/how-to/shodan-
lives.
dyn-botnet-searches-all-your-iot-devices/,
2015.
[12] Computer Weekly. Third-party code bug left instagram
https://www.
users at risk of account takeovers.
computerweekly.com/news/252489542/Third-
party-code-bug-left-Instagram-users-at-
risk-of-account-takeover, 2020.
[1] Alasdair Allan. The problem with throwing away a
https://www.hackster.io/news/
smart device.
the-problem-with-throwing-away-a-smart-
device-75c8b35ee3c7, 2020.
[13] Lucas Davi, Alexandra Dmitrienko, Ahmad-Reza
Sadeghi, and Marcel Winandy. Privilege escalation
attacks on Android.
In International Conference on
Information Security, 2010.
USENIX Association
30th USENIX Security Symposium    4201
[14] Alexandre Decan, Tom Mens, and Eleni Constantinou.
On the impact of security vulnerabilities in the npm
package dependency network.
In 15th International
Conference on Mining Software Repositories, MSR,
2018.
[15] Soteris Demetriou, Nan Zhang, Yeonjoon Lee, Xi-
aoFeng Wang, Carl A. Gunter, Xiaoyong Zhou, and
Michael Grace. HanGuard: SDN-driven protection of
smart home WiFi devices from malicious mobile apps.
In 10th ACM Conference on Security and Privacy in
Wireless and Mobile Networks, WiSec, 2017.
[16] Erik Derr, Sven Bugiel, Sascha Fahl, Yasemin Acar, and
Michael Backes. Keep me updated: An empirical study
of third-party library updatability on Android. In 2017
ACM SIGSAC Conference on Computer and Communi-
cations Security, CCS, 2017.
[17] Brian Dipert. Teardown: A WiFi smart plug for home au-
tomation. https://www.edn.com/teardown-a-wi-
fi-smart-plug-for-home-automation/, 2020.
[18] Brian Dipert. Teardown: WeMo switch is highly in-
https://www.edn.com/teardown-wemo-
tegrated.
switch-is-highly-integrated/, 2020.
[19] Colin Dixon, Ratul Mahajan, Sharad Agarwal, A.J.
Brush, Bongshin Lee, Stefan Saroiu, and Paramvir Bahl.
An operating system for the home.
In 9th USENIX
Symposium on Networked Systems Design and Imple-
mentation, NSDI, 2012.
[20] Ruian Duan, Ashish Bijlani, Meng Xu, Taesoo Kim, and
Wenke Lee. Identifying open-source license violation
and 1-day security risk at large scale. In 2017 ACM
SIGSAC Conference on Computer and Communications
Security, CCS, 2017.
[21] Zakir Durumeric, David Adrian, Ariana Mirian, Michael
Bailey, and J. Alex Halderman. A search engine backed
by Internet-wide scanning. In 2015 ACM SIGSAC Con-
ference on Computer and Communications Security,
CCS, 2015.
[22] Jeremy Erickson, Qi Alfred Chen, Xiaochen Yu, Erinjen
Lin, Robert Levy, and Z. Morley Mao. No one in the
middle: Enabling network access control via transparent
attribution. In 2018 ACM ASIA Conference on Computer
and Communications Security, AsiaCCS, 2018.
[23] ESP32.NET. The internet of things with ESP32. http:
[25] Espressif. We just hit a new major milestone.
https://www.espressif.com/en/media_
overview/news/espressif-achieves-100-
million-target-iot-chip-shipments, 2018.
[26] Espressif.
ESP32 series datasheet.
https:
//www.espressif.com/sites/default/files/
documentation/esp32_datasheet_en.pdf, 2020.
[27] Espressif. WolfSSL for ESP-IDF. https://github.
com/espressif/esp-wolfssl, 2020.
[28] Google.
Protocol buffers.
https://developers.
google.com/protocol-buffers, 2020.
[29] gRPC — a high-performance, open source universal rpc
framework. https://grpc.io/, 2020.
[30] Hang Guo and John Heidemann. Detecting IoT devices
in the internet (extended). Technical Report ISI-TR-
726B, USC/Information Sciences Institute, 2018.
[31] Hackaday.io. 382 projects tagged with "ESP32". https:
//hackaday.io/projects?tag=ESP32, 2020.
[32] Jun Han, Albert Jin Chung, Manal Kumar Sinha, Mad-
humitha Harishankar, Shijia Pan, Hae Young Noh, Pei
Zhang, and Patrick Tague. Do you feel what I hear?
enabling autonomous IoT device pairing using different
sensor types. In 2018 IEEE Symposium on Security and
Privacy, 2018.
[33] Armijn Hemel, Karl Trygve Kalleberg, Rob Vermaas,
and Eelco Dolstra. Finding software license violations
through binary code clone detection. In 8th Working
Conference on Mining Software Repositories, MSR,
2011.
[34] Tejun Heo. Control group v2. https://www.kernel.
org/doc/Documentation/cgroup-v2.txt, 2015.
[35] David Hodson. Nest learning thermostat 2nd generation
https://www.ifixit.com/Teardown/
teardown.
Nest+Learning+Thermostat+2nd+Generation+
Teardown/13818, 2020.
[36] James Hong, Amit Levy, Laurynas Riliskis, and Philip
Levis. Don’t talk unless i say so! securing the Internet
of things with default-off networking. In 3rd ACM/IEEE
International Conference on Internet-of-Things Design
and Implementation, IoTDI, 2018.
[37] hostapd. https://w1.fi/hostapd/, 2020.
//esp32.net/, 2020.
[38] IFTTT. https://www.ifttt.com, 2020.
[24] Espressif. [SDK release] esp8266-nonos-sdk-v1.5.0-15-
https://bbs.espressif.com/viewtopic.
11-27.
php?f=46&t=1442, 2015.
[39] Ronny Ko and James Mickens. DeadBolt: Securing IoT
deployments. In Applied Networking Research Work-
shop, ANRW, 2018.
4202    30th USENIX Security Symposium
USENIX Association
[40] Deepak Kumar, Kelly Shen, Benton Case, Deepali Garg,
Galina Alperovich, Dmitry Kuznetsov, Rajarshi Gupta,
and Zakir Durumeric. All things considered: An analysis
of IoT devices on home networks.
In 28th USENIX
Security Symposium, 2019.
[41] Tobias Lauinger, Chaabane Abdelberi, Sajjad Arshad,
William Robertson, Christo Wilson, and Engin Kirda.
Thou shalt not depend on me: Analysing the use of
outdated JavaScript libraries on the web. In NDSS, 2017.
[42] The Security Ledger.
Devices’ UPnP service
emerges as key threat
to home IoT networks.
https://securityledger.com/2019/03/devices-
upnp-service-emerges-as-key-threat-to-
home-iot-networks/, 2020.
[43] Xinyu Lei, Guan-Hua Tu, Chi-Yu Li, Tian Xie, and
Mi Zhang. SecWIR: Securing smart home IoT commu-
nications via wi-ﬁ routers with embedded intelligence.
In 18th International Conference on Mobile Systems,
Applications, and Services, MobiSys, 2020.
[44] Chieh-Jan Mike Liang, Börje F. Karlsson, Nicholas D.
Lane, Feng Zhao, Junbei Zhang, Zheyi Pan, Zhao Li,
and Yong Yu. SIFT: Building an internet of safe things.
In 14th International Conference on Information Pro-
cessing in Sensor Networks, IPSN, 2015.
[45] Linux containers. https://linuxcontainers.org/,
2020.
[46] Xianghang Mi, Feng Qian, Ying Zhang, and XiaoFeng
Wang. An empirical characterization of IFTTT: ecosys-
tem, usage, and performance. In 2017 Internet Measure-
ment Conference, IMC, 2017.
[47] MichMich. MagicMirror.
https://github.com/
MichMich/MagicMirror, 2020.
[51] OpenSSL. Release strategy. https://www.openssl.
org/policies/releasestrat.html, 2020.
[52] OpenSSL changelog. https://www.openssl.org/
news/changelog.html, 2020.
[53] Particle device OS.
https://www.particle.io/
device-os/, 2020.
[54] phodal/awesome-iot. A collaborative list of great
resources about IoT framework, library, OS, plat-
form. https://github.com/phodal/awesome-iot#
library, 2020.
[55] Raspberry Pi. Issue: cpuset disabled #1950. https:
//github.com/raspberrypi/linux/issues/1950,
2020.
[56] Raspberry Pi 4 speciﬁcation.
https://www.
raspberrypi.org/products/raspberry-pi-4-
model-b/specifications/, 2020.
[57] Dark Reading.
Over 80% of medical
imag-
ing devices run on outdated operating systems.
https://www.darkreading.com/iot/over-
80--of-medical-imaging-devices-run-on-
outdated-operating-systems/d/d-id/1337273,
2020.
[58] Red Hat. What is the maximum number of interface
aliases supported in Red Hat Enterprise Linux? https:
//access.redhat.com/solutions/40500, 2020.
[59] Muzammil Abdul Rehman and Paul Grosu. RPC
is not dead: Rise, fall and the rise of remote proce-
dure calls. http://dist-prog-book.com/chapter/
1/rpc.html, 2017.
[60] RTInsights. IoT devices still exposed, vast majority of
trafﬁc unencrypted. https://www.rtinsights.com/
iot-security-remains-lacklustre/, 2020.
[48] Microsoft Azure. Azure Sphere. https://azure.
microsoft.com/en-us/services/azure-sphere/,
2020.
[61] RTInsights. Malware attacks IoT devices running win-
dows 7. https://www.rtinsights.com/malware-
iot-windows-7/, 2020.
[49] Asuka Nakajima, Takuya Watanabe, Eitaro Shioji, Mit-
suaki Akiyama, and Maverick Woo. A pilot study on
consumer IoT device vulnerability disclosure and patch
release in japan and the united states. In 2019 ACM Asia
Conference on Computer and Communications Security,
AsiaCCS, 2019.
[50] Hung Nguyen, Radoslav Ivanov, Linh T.X. Phan, Oleg
Sokolsky, James Weimer, and Insup Lee. LogSafe:
Secure and scalable data logger for IoT devices.
In
3rd ACM/IEEE International Conference on Internet-of-
Things Design and Implementation, IoTDI, 2018.
[62] Samsung SmartThings.
Direct-connected de-
https://smartthings.developer.
vice SDK.
samsung.com/docs/devices/direct-connected-
devices/overview.html, 2020.
[63] Samsung SmartThings.
SmartThings device SDK.
https://github.com/SmartThingsCommunity/st-
device-sdk-c, 2020.
[64] Senrio.
400,000 publicly available IoT devices
vulnerable to single ﬂaw. https://blog.senr.io/
blog/400000-publicly-available-iot-devices-
vulnerable-to-single-flaw, 2016.
USENIX Association
30th USENIX Security Symposium    4203
[65] Mohit Sethi, Elena Oat, Mario Di Francesco, and Tuo-
mas Aura. Secure bootstrapping of cloud-managed
ubiquitous displays. In 2014 ACM International Joint
Conference on Pervasive and Ubiquitous Computing,
UbiComp, 2014.
[66] Anna Kornfeld Simpson, Franziska Roesner, and Ta-
dayoshi Kohno. Securing vulnerable home IoT devices
with an in-hub security manager.
In 2017 IEEE In-
ternational Conference on Pervasive Computing and
Communications Workshops, PerCom, 2017.
[67] Andrew Stuart Tanenbaum and Robbert Van Renesse. A
critique of the remote procedure call paradigm. 1987.
[79] Miguel G. Xavier, Marcelo V. Neves, Fabio D. Rossi,
Tiago C. Ferreto, Timoteo Lange, and Cesar A. F.
De Rose. Performance evaluation of container-based
virtualization for high performance computing environ-
ments. In 2013 21st Euromicro International Confer-
ence on Parallel, Distributed, and Network-Based Pro-
cessing, 2013.
[80] Tianlong Yu, Vyas Sekar, Srinivasan Seshan, Yuvraj
Agarwal, and Chenren Xu. Handling a trillion (unﬁx-
able) ﬂaws on a billion devices: Rethinking network
security for the internet-of-things. In 14th ACM Work-
shop on Hot Topics in Networks, HotNets, 2015.
[68] TOMOYO linux. https://tomoyo.osdn.jp/index.
html.en, 2020.
[81] ZDNet.
[69] smem(8) - linux man page. https://linux.die.net/
man/8/smem, 2020.
[70] Rahmadi Trimananda, Ali Younis, Bojun Wang, Bin Xu,
Brian Demsky, and Guoqing Xu. Vigilia: Securing smart
home edge computing. In 2018 IEEE/ACM Symposium
on Edge Computing, SEC, 2018.
[71] Random Nerd Tutorials.
tutorials and guides with Arduino IDE.
//randomnerdtutorials.com/projects-esp32/,
2020.
70+ ESP32 projects,
https:
[72] Maarten Van Steen and Andrew S Tanenbaum. Dis-
tributed systems, chapter 4.2. 2017.
[73] Steve Vinoski. Convenience over correctness. IEEE
Internet Computing, 12(4):89–92, 2008.
[74] Jim Waldo, Geoff Wyant, Ann Wollrath, and Sam
Kendall. A note on distributed computing. In Inter-
national Workshop on Mobile Object Systems, pages
49–64, 1996.
[75] Wikipedia.
IEEE 802.11i-2004.
https://en.
wikipedia.org/wiki/IEEE_802.11i-2004, 2020.
[76] Wikipedia.
OpenSSL - major version releases.
https://en.wikipedia.org/wiki/OpenSSL#
Major_version_releases, 2020.
[77] Ann Wollrath, Roger Riggs, and Jim Waldo. A dis-
tributed object model for the Java system. 1996.
[78] Rich Wolski, Chandra Krintz, Fatih Bakir, Gareth
George, and Wei-Tsung Lin. CSPOT: Portable, multi-
scale functions-as-a-service for IoT. In 4th ACM/IEEE
Symposium on Edge Computing, SEC, 2019.
kids
Shodan: The IoT search engine for
sleeping
and bedroom antics.
watching
https://www.zdnet.com/article/shodan-the-
iot-search-engine-which-shows-us-sleeping-
kids-and-how-we-throw-away-our-privacy/,
2016.
[82] ZDNet.
CallStranger vulnerability lets
at-
tacks bypass
security systems and scan LANs.
https://www.zdnet.com/article/callstranger-
vulnerability-lets-attacks-bypass-security-
systems-and-scan-lans/, 2020.
[83] ZDNet.
Hacker
leaks passwords
for more
than 500,000 servers, routers, and IoT devices.
https://www.zdnet.com/article/hacker-leaks-
passwords-for-more-than-500000-servers-
routers-and-iot-devices/, 2020.
[84] ZDNet. Ripple20 vulnerabilities will haunt the IoT
landscape for years to come. https://www.zdnet.
com/article/ripple20-vulnerabilities-will-
haunt-the-iot-landscape-for-years-to-come/,
2020.
[85] Wei Zhang, Yan Meng, Yugeng Liu, Xiaokuan Zhang,
Yinqian Zhang, and Haojin Zhu. HoMonit: Monitoring
smart home apps from encrypted trafﬁc. In 2018 ACM
SIGSAC Conference on Computer and Communications
Security, CCS, 2018.
[86] Yaowen Zheng, Ali Davanian, Heng Yin, Chengyu Song,
Hongsong Zhu, and Limin Sun. FIRM-AFL: high-
throughput greybox fuzzing of IoT ﬁrmware via aug-
mented process emulation. In 28th USENIX Security
Symposium, 2019.
4204    30th USENIX Security Symposium
USENIX Association