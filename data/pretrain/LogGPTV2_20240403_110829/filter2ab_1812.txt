### Title: Blackhat Asia-23: Nakatomi Space - Lateral Movement in L1 Post-Exploitation in OT

In Operational Technology (OT) networks, it is widely recognized that Purdue Reference Model Level 1 (L1) devices, such as Programmable Logic Controllers (PLCs) and Remote Terminal Units (RTUs), are often insecure. Despite this, L1 devices that sit at the intersection of multiple, mixed networks (Ethernet, Industrial Wireless, Fieldbus, etc.) are frequently treated as security perimeters without the necessary hardening and risk assessments that would be applied to multi-homed workstations in similar positions.

In this talk, we will explore *deep lateral movement* within OT networks, examining various Tactics, Techniques, and Procedures (TTPs) that attackers can use to navigate through the networks of embedded devices at the lowest levels. Our focus is on two key aspects:
1. **Crossing Underexamined Security Perimeters**: Understanding how attackers can exploit these perimeters.
2. **Achieving Granular Control over OT Systems**: Enabling complex attacks by gaining detailed control over OT systems.

Even with full control over central Supervisory Control and Data Acquisition (SCADA) systems, attackers do not immediately have the ability to deliver arbitrary cyber-physical impacts. Control systems are designed to be robust and resilient, and they do not provide easy "blow me up" buttons on the Human-Machine Interface (HMI). To achieve specific impacts, attackers must inhibit Safety Instrumented System (SIS) response functions and overcome functional and safety limitations in controllers and field devices.

To accomplish these goals, attackers may need to move *through* L1 devices and deeply into nested device networks or across restricted interfaces between the Basic Process Control System (BPCS) and SIS, or third-party package units (PUs). These interfaces include non-routable, point-to-point links and certain gateways. Contrary to common misconceptions and some vendor and standards guidance, we will demonstrate that these restricted links do not provide sufficient segmentation on their own.

We will also show that, with deep lateral movement, an attacker can achieve effects such as bypassing firmware safety limits on setpoint interfaces, which can significantly alter an asset owner's view of risk and consequences.

To illustrate our points, we will present a Proof-of-Concept (PoC) multi-stage attack chain against a demo setup modeled after a real-world movable bridge control system. In this demo, achieving physical damage to the bridge requires gaining full access to both control and safety systems across a restricted gateway and point-to-point link architecture. The attack chain incorporates several N-day vulnerabilities (NUCLEUS:13 and Urgent/11) tailored against Wago and Allen-Bradley systems, as well as two 0-day vulnerabilities that allow for authentication bypass and subsequent stealthy Remote Code Execution (RCE) on Schneider Electric Modicon PLCs.

In addition to outlining the target system firmware internals and describing the implants we developed to establish footholds for lateral movement, we will provide mitigation and Digital Forensics and Incident Response (DFIR) practitioner advice for defensive purposes.