e
e
r
r
e
e
w
w
s
s
n
n
A
A
s
s
e
e
i
i
r
r
e
e
u
u
Q
Q
f
f
o
o
n
n
o
o
i
i
t
t
c
c
a
a
r
r
F
F
1
1
2
2
5
5
3
3
Stale Cache Size (days)
Stale Cache Size (days)
10
10
7
7
14
14
 1
 1
 0.998
 0.998
 0.996
 0.996
 0.994
 0.994
 0.992
 0.992
 0.99
 0.99
 0.988
 0.988
 0.986
 0.986
 0.984
 0.984
s
s
d
d
r
r
o
o
c
c
e
e
R
R
e
e
t
t
a
a
r
r
u
u
c
c
c
c
A
A
f
f
o
o
n
n
o
o
i
i
t
t
c
c
a
a
r
r
F
F
21
21
30
30
Figure 6: Fraction of Queries (for two-level names) Answered
and Accurate Records when using a stale cache during an 3-
hour attack on the TLD nameservers.
d
d
e
e
r
r
e
e
w
w
s
s
n
n
A
A
s
s
e
e
i
i
r
r
e
e
u
u
Q
Q
f
f
o
o
n
n
o
o
i
i
t
t
c
c
a
a
r
r
F
F
Queries Answered
Queries Answered
Accurate Records
Accurate Records
 1
 1
 0.9
 0.9
 0.8
 0.8
 0.7
 0.7
 0.6
 0.6
 0.5
 0.5
 0.4
 0.4
1
1
2
2
5
5
3
3
Stale Cache Size (days)
Stale Cache Size (days)
10
10
7
7
14
14
 1
 1
 0.998
 0.998
 0.996
 0.996
 0.994
 0.994
 0.992
 0.992
 0.99
 0.99
 0.988
 0.988
 0.986
 0.986
 0.984
 0.984
21
21
30
30
s
s
d
d
r
r
o
o
c
c
e
e
R
R
e
e
a
a
r
r
u
u
c
c
c
c
A
A
t
t
f
f
o
o
n
n
o
o
i
i
t
t
c
c
a
a
r
r
F
F
Figure 7: Fraction of Queries (for three-level names) Answered
and Accurate Records when using a stale cache during an 3-
hour attack on second-level nameservers.
names would still resolve and hence, would effectively shield the
network from an attack on the root-servers.
The second attack involves clients not being able to access TLD
nameservers. Today, this would cause queries for any records cor-
responding to two-level names such as a.com to fail. Further, any
queries for longer names that rely on the resolution of two-level
names would fail too. Here we restrict ourselves to the queries
for two-level names that cannot be answered based on the resolver
cache. Figure 6 plots both the fraction of such queries that the stale
cache can answer and the fraction of records in these responses
that are accurate in case of a 3-hour attack. The trends for longer
duration attacks are similar. The fraction of queries answered in-
creases with an increasing stale cache size though it tapers off for a
stale cache of more than 14 days. A 14-day stale cache can answer
75% of the queries for two-level names. The reason for the lower
fraction of queries answered is that clients typically access the NS
records for names such as a.com and these records tend to have a
high TTL-value. As explained earlier, this implies that most such
queries are answered based on the resolver cache and if a record is
not cached, there is a higher probability that it has not been queried
at all and hence, is not present in the stale cache too. Of course,
the fraction of total client queries that succeed when using the stale
cache is much higher. The graph also shows that records from a
14-day stale cache are 99.4% accurate and accuracy increases with
the stale cache size too.
Similarly, the last attack scenario involves second-level name-
servers being inaccessible. This would cause queries for any records
corresponding to a three-level name such as b.a.com to fail. We
focus on such queries that are not cached by the networkâ€™s re-
i
i
e
e
z
z
S
S
e
e
h
h
c
c
a
a
C
C
e
e
a
a
S
S
t
t
l
l
t
t
n
n
i
i
s
s
d
d
r
r
o
o
c
c
e
e
r
r
f
f
)
)
s
s
d
d
n
n
a
a
s
s
u
u
o
o
h
h
o
o
#
#
(
(
# of records
# of records
MB
MB
 3000
 3000
 2500
 2500
 2000
 2000
 1500
 1500
 1000
 1000
 500
 500
 0
 0
1
1
5
5
15
15
10
10
Stale Cache Size (days)
Stale Cache Size (days)
20
20
 350
 350
 300
 300
 250
 250
 200
 200
 150
 150
 100
 100
 50
 50
 0
 0
25
25
30
30
)
)
B
B
M
M
(
(
i
i
e
e
z
z
S
S
e
e
h
h
c
c
a
a
C
C
e
e
a
a
S
S
t
t
l
l
Figure 8: Stale cache memory footprint
solvers. Figure 7 plots the fraction of such queries answered using
stale records during a 3-hour attack and the accuracy of these stale
records. As before, the fraction of queries answered increases with
an increasing stale cache size. However, in this case, the returns
from increasing the stale cache size are diminished much sooner
that the previous attack scenario. A 14-day stale cache can answer
85% of the queries for three-level names. Both A and NS records
for names such as b.a.com are accessed by clients and these tend to
have lower TTL-values than the records for two-level names. This
explains the higher percentage of queries answered. The graph also