常规攻击的
实时检测 ( WEB APP ) 
amxku
携程安全   //   sec.ctrip.com
# About me
- Security Architect at Ctrip 
- @amxku
- sebug.net  //  sec.ctrip.com
OWASP  Top10
• Scanner(vul/info) 
• Spam(info/login/register) 
• Trojan(gh0st RAT) 
• On-line/Off-line
On-line
WEB  APP  LOG
Real-time // Analysis // Dashboard
任务I度 
applog 
    Slog 
userlog 
logstash 
ElasticSearch 
任务添加 
E果展示 
任务队列 
Elasticsearch client 
搜索 
逻辑引擎 
二次  析 
自动化
验证 
E果 
响应 
ESlog 
规则平台 
事件管理 
Log 
IIS Log 
Gateway 
  SPer 
Hbase 
Rule 
IPS 
dashboard 
White List 
IP Nslookup 
Login log 
alerting 
Storm Cluster 
搜索引擎检C 
IPHG库 
………… 
FE 
IISFilter 
响应 
Off-line
APT  ?
# Trojan
- ⽊木⾺马⼼心跳是与C&C服务器保持连接的主要⽅方式，通过对⽊木⾺马⼼心跳⾏行
为的特征检测，可以识别⼀一些可疑的⽊木⾺马通信⾏行为 
-
周期性 / 持续性 / 简洁性 / 特定性
#变异系数（Coefﬁcient of Variation）
- V = ( SD/MN ) % 100       SD：标准差	 ,MN：平均值
3001,2998,9990,2999 
3000,3004,2996,3001 
2997,      0,2999,3003
3001,2998,2999 
3000,3004,2996,3001 
2997,2999,3003
MN = 
SD = 
CV = 
Moloch 
filter
Cuckoo
Cuckoo
• PCDA 
• Closed Loop
THANK YOU
@amxku