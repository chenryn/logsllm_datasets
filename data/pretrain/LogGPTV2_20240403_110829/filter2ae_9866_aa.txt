IP地址的所有研究，其实可以归到三个问题上：
1、这个IP在哪儿?  
2、这个IP是什么?  
**3、这个IP干了什么?**
本篇是关于IP地址研究的最后一篇文章，我们来聊一聊：如何分析一个IP地址做了什么?
上一篇中，我们提到了通过每个IP下的用户行为，判断用户群体的类型，进而给出IP地址的分类结果。那些，其实都只是最简单，最基础的一些分类方法。通过特定的指标计算、聚类算法，就可以得出结果。
然而，同盾的IP画像，是围绕反欺诈展开的，我们希望能够准确的评估一个IP地址的风险性，进而在风控策略中进行调控。
在IP画像设计初期，我们设计了一个风险评分，用于总体评价这个IP地址风险。风险分数中，IP是否有代理行为、是否命中已知的威胁情报、是否发生过风险行为，都作为评估的依据。但是这样的一个笼统的评分，在实际使用中却有诸多不便。
比如，我们曾经发现过一个IP地址，由于频繁的发生盗卡行为，最终我们给出的风险评分达到了94分(0~100，分数越高风险越高)，然而这个IP下其他行为都是正常的，大量的正常用户通过这个IP进行登录、交易、支付等活动。
于是，我们萌生了一个想法，能否准确地定性一个IP到底做过什么样的坏事儿?
#### **什么是坏事儿？**
反欺诈中，涉及到的业务风险其实非常非常多。不同的行业、不同的平台都会有各自独有的一些风险。
就拿“黄牛”来说，随着互联网的发展，黄牛也从最早的票贩子，演变出了很多很多的花样。
**案例1:**
在各大航空公司的网上订票渠道中，存在很多“占座黄牛”，他们通过特定的渠道，订购了一定数量的廉价机票，然后加价转售，甚至会高出这张机票原有的价格。如果不能及时出手，黄牛就会选择退票，导致飞机上出现很多空座位，各大航空公司对此也很头疼。转手的过程很简单，只需要修改乘机人即可，这个行为可以通过线上的数据分析发现出来。
**案例2:**
一些票务网站(专指演唱会、赛事门票)，黄牛会注册大量账号，抢购演唱会门票，拿到门票后，加价出手。由于黄牛拿到了实体票，转手过程是在线下进行的，通过线上行为就无法进行监控。但是，在抢票过程中，黄牛为了增加自己抢到票的几率，会使用很多个账号重复下单，大量订单中的收获地址都是同一个或者具有极高的相似度。
**案例3**
:美团、猫眼、格瓦拉等购买电影票的平台中，也存在很大数量的黄牛。尤其是一些热门大片儿的首映票，价格可以炒到很高。电影票的黄牛，往往以代购的形式操作，他们拥有很高折扣的会员卡，可以低价购买到电影票，然后适当加价转手。黄牛完成支付后，拿到取票二维码，然后把二维码发送给买家。这个过程，也是很难通过线上的行为来进行检测的。
如果我们需要分析一个IP到底做了什么坏事，就必须要先给出明确的定义，到底什么样的行为算是坏事。然后把这些行为分解为非常详细的特征指标，进行建模。
这个过程是漫长的，就像上面举的例子，同样是“黄牛”，由于不同的平台，不通过的行业类型，中间存在着非常巨大的差异。每一种行为都要做这样的深入分析和研究，其实我们一开始是拒绝的......
在后来的一段时间里，我们团队接到了越来越多的提问，客户希望知道，这个IP到底干了什么?到底有没有风险?我们只能硬着头皮，去提取这个IP在过去半年里的行为数据，然后逐一分析。说到底，单凭一个IP地址的类型和地理位置，远远无法满足风控的需求。最终，我们决定要做这么件事儿。于是好几个月就这么过去了。
首先，我们梳理了一份反欺诈的词表，用来给出各种欺诈行为的明确定义。
**特征提取**
篇幅有限，这里就简单介绍一下我们对黄牛(票务行业)做行为分析和建模的过程。
上图中，是我们抽取到的一份较为典型的黄牛抢票记录。
从这些记录里，能获取到怎样的信息呢?
1、这批账号都在同一天注册，并且注册时间较为集中，注册时间间隔大约为30秒;
2、每个账户只下一个订单，但是多个订单产生的时间非常接近，时间间隔仅为毫秒级;
3、多个订单中的收货人姓名很相似，直观判断，不太可能是真实的姓名;
4、多个订单中的收货地址有明显的异常，在末尾添加了无用的字符串;
5、收获地址末尾的字符串为11位的数字，比较像手机号，多个订单中的这个字符串相同;
6、账号注册和风险发生，中间存在较长的时间，可以定义为休眠账号或养号行为。
如果对这个地址做检查，我们会发现：广东省佛山市均安镇均榄路天连大道是真实存在的。