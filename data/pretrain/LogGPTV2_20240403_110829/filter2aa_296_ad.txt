Important:  Be careful if there is more than one NetBoot server on your network. The 
client may restart from a disk image on a server other than the one you’re working on.
If you’re using Macintosh Manager with NetBoot client computers, each time you start 
or restart the client computer, you need to log in as a Macintosh Manager 
administrator who belongs to the System Access workgroup. 
To install software or change the Mac OS 9 disk image:
1 Log in to the server volume as a user with read/write access (for example, as an 
administrator).
2 Using the Chooser, log in to all the server volumes on the client.
3 Copy the NetBoot Desktop Admin application to a local volume on the client, then 
open the application.
NetBoot Desktop Admin is supplied on the NetBoot for Mac OS 9 CD (available 
separately). 
LL2348.Book  Page 25  Thursday, August 21, 2003  10:58 AM
26
Chapter 2    Creating Boot and Install Images
4 Click Make Private Copy.
NetBoot Desktop Admin creates a copy of the disk image. This may take several 
minutes, and you should not interrupt the process. When it finishes, your NetBoot client 
computer restarts automatically.
Important:  Because the copy of a disk image is associated with the NetBoot client 
computer you used to create it, you must make the changes to the image using the 
same computer. If you change computers, you won’t be able to see the changes you 
have made and your changes won’t be available to users. In addition, you increase the 
risk of unauthorized users making changes to the disk image.
5 If you’re installing a new version of the Mac OS or adding system extensions, you may 
need to increase the size of the disk image.
Make sure the disk image is large enough to accommodate the size of the new system 
and extensions you’re installing. You can’t reduce the size of an image without 
reverting to a smaller backup copy.
6 If you’re installing new application software, you may need to increase the size of the 
application disk image.
Be sure the disk image has enough space for the software you want to install. However, 
increase the size of an image only as much as needed. You can’t reduce the size of an 
image without reverting to a smaller backup copy.
7 Install the software or make changes to the system configuration.
Make sure to install the latest updates for the system software.
If you’re installing software, follow the installation instructions that came with the 
software. If necessary, restart the computer.
After installing an application, open it. Doing so lets you enter a registration number, if 
necessary. If you don’t enter the number now, every time users open the application 
they will need to enter the registration number. In addition, most applications create a 
preferences file in the System Folder. If you don’t open the application, users may not 
be able to open the application because the preferences won’t exist.
8 Be sure there aren’t any files in the Trash that you want to save. (The Trash is emptied 
automatically after the next step.)
Note:  If you can’t empty the Trash because it contains files that are in use, you may 
need to restart the computer.
9 If necessary, use the Chooser to log back in to all the server volumes. 
10 Open the NetBoot Desktop Admin application, then click Save. The computer restarts 
automatically.
If you need to make other changes, click Quit and return to Step 7.
Clicking Discard removes the changes you’ve made to the disk image.
LL2348.Book  Page 26  Thursday, August 21, 2003  10:58 AM
Chapter 2    Creating Boot and Install Images
27
11 Start the NetBoot client computer again, and log back in to all the server volumes.
12 Open NetBoot Desktop Admin.
If you want to keep a backup copy of the old disk image, leave the “Keep previous disks 
as backup” option selected. Backup copies are stored in the Backup Images folder in 
the Shared Images folder on the NetBoot server. 
Note:  Because there is only one backup folder, the backup image saved at this time will 
overwrite any backup image in the folder from a previous session.
13 If you clicked Save in Step 10, click Restart. Otherwise, click OK.
If you click Restart, NetBoot Desktop Admin saves your changes, deletes the old disk 
image, and then restarts the computer. Changes are available the next time a NetBoot 
client computer restarts. If you click OK, NetBoot Desktop Admin deletes the old disk 
image. 
Setting Up Multiple Mac OS 9 Images
To create more than one Mac OS 9 disk image, make copies of the preconfigured 
disk image you installed from the NetBoot for Mac OS 9 CD into the directory 
/Library/NetBoot/NetBootSPn on any server volume. Then use NetBoot Desktop Admin 
to modify the Mac OS 9 disk images as desired.
Use Server Admin to enable disk images and select the default disk image. See 
“Enabling Images” on page 34 and “Specifying the Default Image” on page 37.
Unlocking an Image
If an image is locked, you’ll need to unlock it before you can make any changes to it.
To unlock a Network Install image:
1 Log in as the root user.
2 Select the image file and choose File > Show Info.
3 Uncheck the Locked checkbox.
LL2348.Book  Page 27  Thursday, August 21, 2003  10:58 AM
28
Chapter 2    Creating Boot and Install Images
Creating Install Images
The following sections show how to create images you can use to install software on 
client computers over the network.
Creating an OS Install Image
To create an image that will install the OS software on a client computer, use the 
Network Image Utility. You can find this application in the folder /Applications/Server/.
To create an OS install image:
1 Log in to the server as an administrative user.
2 Open Network Image Utility and click New Install.
3 In the General pane, type a name for the image you’re creating.
4 Type an Image ID.
Choose a number in the range 1–4095 for an image that will be available on a single 
server, or 4096–65535 for an image that you plan to make available on multiple servers 
but want to list only once in the client computer Startup Disk preferences.
5 (CD source only) Choose the default language for the software. (Available only if you 
have already inserted the CD and chosen it as the source.)
Note:  This is the language used by the installed software only. The installer that runs 
always appears in English (if this is not an automated install).
6 Choose whether the image is to be delivered using NFS or HTTP.
If you’re not sure which to choose, choose NFS.
7 On the Contents pane, choose the source for the image.
You can choose an install CD, a mounted boot volume, or an existing disk image.
8 (Optional) Click the Add (+) button below the list to add applications or post-install 
scripts to the image.
9 In the Installation Options pane, enable “Checksum destination after installing” to have 
the installer verify the integrity of the image after it is transferred to the client but 
before it is installed. (For images from volume source only.)
10 To have the software install with limited or no interaction at the client computer, select 
“Enable automated installation,” then click Options.
11 Click Create Image.
If the Create button is not enabled, make sure you have entered an image name and 
ID, and have chosen an image source.
12 In the Save As dialog, choose where to save the image.
If you don’t want to use the image name you typed earlier, you can change it now by 
typing a new name in the Save As field.
LL2348.Book  Page 28  Thursday, August 21, 2003  10:58 AM
Chapter 2    Creating Boot and Install Images
29
If you’re creating the image on the same server that will serve it, choose a volume from 
the “Serve from NetBoot share point on” pop-up menu.
To save the image somewhere else, choose a location from the Where pop-up menu or 
click the triangle next to the Save As field and navigate to a folder.
13 Click Save.
To check progress, look in the lower-left corner of the window. If you need to insert 
another CD, you’ll be prompted there. To create the image without including the 
contents of a subsequent CD, click Finish when you are prompted to insert it.
Adding Software to Boot and Install Images
There are two basic approaches to including additional software in an image:
• Add additional applications and files to an existing system before creating an image 
using that system as the source (see “Creating a Mac OS X Boot Image From an 
Existing System” on page 22)
• Add packages containing the additional applications and files to an existing image 
(see “Creating an Application-Only Install Image” on page 30)
About Packages
If you plan to add application software or other files to an image at creation time 
(instead of installing the applications or files on the image source volume before you 
create the image), you need to group the applications or files into a special file called a 
package.
A package is a collection of compressed files and related information used to install 
software onto a computer. The contents of a package are contained within a single file, 
which has the extension “.pkg.” The following table lists the components of a package. 
File in Package
Description
product.pax.gz
The files to be installed, compressed with gzip and archived with 
pax. (See man pages for more information about gzip and pax.)
product.bom
Bill of Materials:  a record of where files are to be installed. This is 
used in the verification and uninstall processes.
product.info
Contains information to be displayed during installation.
product.sizes
Text file; contains the number of files in the package.
product.tiff
Contains custom icon for the package.
product.status
Created during the installation, this file will either say “installed” or 
“compressed.”
product.location
Shows location where the package will be installed.
software_version
(Optional) Contains the version of the package to be installed.
LL2348.Book  Page 29  Thursday, August 21, 2003  10:58 AM
30
Chapter 2    Creating Boot and Install Images
Creating Packages
To add applications or other files to an image (instead of installing them first on the 
image source volume before creating the image), use PackageMaker to create 
packages containing the application or files. PackageMaker is in the Utilities folder on 
the Mac OS X Server Administration Tools CD that comes with Mac OS X Server.
For more information on creating packages, open PackageMaker and choose 
PackageMaker Help, PackageMaker Release Notes, or Package Format Notes from the 
Help menu.
After creating the packages, add them to your boot or install image using the Network 
Image Utility. See “Creating an Application-Only Install Image” on page 30 or “Adding 
Packages to a Boot or Install Image” on page 30.
Adding Packages to a Boot or Install Image
To include additional application or file packages in an image, add the packages to the 
image using the Network Image Utility.
You can add packages at the time you create an image or add packages to an existing 
image.
To add packages to a new image you’re creating using Network Image Utility, click the 
Add (+) button after you select the image source in the Contents pane.
To add packages to an existing image, open Network Image Utility, click Images, and 
select the image in the list. Then click Edit, and click the Add (+) button in the Contents 
pane.
In either case, you can drag package icons from the Finder to the Other Items list in the 
Contents tab instead of using the Add (+) button.
Note:  You can’t add metapackages to an image using the Network Image Utility.
From the Command Line
You can also add packages to a boot or install image by modifying the image and its 
associated rc.cdrom.packagePath or minstallconfig.xml file in Terminal. For more 
information, see the system image chapter of the command-line administration guide.
Creating an Application-Only Install Image
To create an install image that contains application software but no OS software, 
deselect the Include Mac OS X option in the Contents pane in the Network Image 
Utility.
Note:  You can’t use the Network Image Utility to create an automated install image 
that contains a metapackage or more than one regular package. You can do this using 
commands in Terminal. For more information, see the system image chapter of the 
command-line administration guide.
LL2348.Book  Page 30  Thursday, August 21, 2003  10:58 AM
Chapter 2    Creating Boot and Install Images
31
To add packages to a new image you’re creating using Network Image Utility, click the 
Add (+) button after you select the image source in the Contents pane.
You can drag package icons from the Finder to the Other Items list in the Contents tab 
instead of using the Add (+) button.
Automating Installation of an Image
To install Mac OS software (along with any packages you add) with limited or no 
interaction from anyone at the client computer, use the Network Image Utility to create 
an automated install image. Otherwise, a user at the client computer will have to 
respond to questions from the installer.
To set up an OS image for automated installation:
1 Open Network Image Utility and click New Install.
2 Provide information in the General and Contents panes as usual.
3 In the Installation Options pane, select “Enable automated installation.”
4 Click the Options button.
5 For unattended installation, choose “Install on volume” next to Target Volume and type 
the name of the volume on the client computer where the software will be installed.
To allow the user at the client computer to select the volume on which to install, 
choose “User selects.”
6 To install the software on a clean drive, enable “Erase the target volume before 
installing.”
7 To install without requiring user confirmation at the client computer, disable “Require 
client user to respond to a confirmation dialog.”
8 If the installed software requires a restart, enable “Restart the client computer after 
installing.”
If the name you provide for the install volume does not match the name of a volume 
on the client computer, a user at the client computer must respond to an installer 
prompt for another target volume.
From the Command Line
You can also set up an image for automated install by modifying the associated 
minstallconfig.xml file using Terminal. For more information, see the system image 
chapter of the command-line administration guide.
LL2348.Book  Page 31  Thursday, August 21, 2003  10:58 AM
32
Chapter 2    Creating Boot and Install Images
Viewing the Contents of a Package
To view the contents of a package, hold down the Control key as you click the package 
in a Finder window and choose Show Package Contents from the menu that appears.
You use PackageMaker (in the Utilities folder on the Mac OS X Server Administration 
Tools CD) to create application software packages to use with Network Install.
From the Command Line
You can also list the contents of a package using commands in Terminal. For more 
information, see the system image chapter of the command-line administration guide.
Installing Mac OS Updates
To use Network Install to install operating system updates on client computers, add the 
system update package to an installer image in the same way you would add any other 
package. See “Creating an Application-Only Install Image” on page 30.
You can download Mac OS updates from www.apple.com/support.
LL2348.Book  Page 32  Thursday, August 21, 2003  10:58 AM
3
33
3 Setting Up NetBoot Service
This chapter describes how to set up NetBoot service to 
make boot and install images available to clients.
Setting Up NetBoot
Follow the instructions in the following sections to set up your NetBoot server.
Configuring NetBoot Service
You use Server Admin to configure the Mac OS X Server NetBoot service.
To configure NetBoot:
1 Open Server Admin and select NetBoot in the Computers & Services list.
2 Click the Settings button, then click General.
3 Click Enable next to the network ports you want to use for serving images.
4 Click in the Images column of the Volume list to choose where to store images.
5 Click in the Client Data column of the Volume list for each local disk volume on which 
you want to store shadow files used by Mac OS 9 clients and Mac OS X diskless clients.
6 Click Save, then click Images.
7 Click in the Default column of the Image list to select the default image.
8 Enable the images you want your clients to use, specify if they are available for diskless 
clients, and choose the protocol for delivering them. 
If you’re not sure which protocol to use, choose NFS.
9 Click Save.
10 (Optional) Click the Filters tab to restrict clients to a known group. For more 
information, see “Restricting NetBoot Clients by Filtering Addresses” on page 38.
From the Command Line
You can also configure NetBoot service using the serveradmin command in Terminal. 
See the system image chapter of the command-line administration guide.
LL2348.Book  Page 33  Thursday, August 21, 2003  10:58 AM
34
Chapter 3    Setting Up NetBoot Service
Starting NetBoot and Related Services
NetBoot service uses AFP, NFS, DHCP, Web, and TFTP services, depending on the types 
of clients you’re trying to boot (see “Network Service Requirements” on page 15). You 
can use Server Admin to start AFP, DHCP, Web, and NetBoot. NFS and TFTP start 
automatically.
Note:  NetBoot does not start automatically after server restart when you enable 
NetBoot service in the Setup Assistant when you first install the server software. Only 
the required share points are set up.
To start NetBoot service:
1 Open Server Admin.
2 If you’ll be booting Mac OS 9 clients or diskless Mac OS X clients, start AFP service.
Select AFP in the Computers & Services list and click Start Service.
3 If your server is providing DHCP service, make sure the DHCP service is configured and 
running. Otherwise, DHCP service must be supplied by another server on your network.
If your NetBoot server is also supplying DHCP service, you might get better 
performance if you configure your server as a gateway. That is, configure your subnets 
to use the server’s IP address as the router IP address.
4 Make sure NetBoot is enabled on a network port.
Open Server Admin, select NetBoot in the Computers & Services list, and click Settings.
5 Start NetBoot service.
Select NetBoot in the Computers & Services list and click Start Service.
From the Command Line
You can also start NetBoot and supporting services using commands in Terminal. For 
more information, see the system image chapter of the command-line administration 
guide.
Enabling Images
You must enable one or more disk images on your server to make the images available 
to client computers for NetBoot startups.
To enable disk images:
1 Open Server Admin and select NetBoot in the Computers & Services list.
2 Click Settings, then click Images.
3 Click in the Enable column for each image you want your clients to see.
4 Click Save.
LL2348.Book  Page 34  Thursday, August 21, 2003  10:58 AM
Chapter 3    Setting Up NetBoot Service
35
Choosing Where Images Are Stored
You can use Server Admin to choose the volumes on your server you want to use for 
storing boot and install images.
To choose volumes for storing image files:
1 Open Server Admin and select NetBoot in the Computers & Services list.
2 Click Settings, then click General.
3 In the list of volumes in the lower half of the window, click the checkbox in the Images 
column for each volume you want to use to store image files.
4 Click Save.
From the Command Line
You can also specify that a volume should be used to store image files using the 
serveradmin command in Terminal. For more information, see the system image 
chapter of the command-line administration guide.
Choosing Where Shadow Files Are Stored