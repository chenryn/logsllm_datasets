once, the practical impact of this 9x slowdown is not
especially signiﬁcant for most applications. Also, we
believe that with a little effort,
the performance of
our un-optimized implementation could be improved
substantially.
Query Runtime. We performed two variations of each
SPARTA-generated query. The ﬁrst variation takes the
form SELECT ID from main where .... Since column
ID is the primary key, these queries only require that
the DBMS scan the indexes to ﬁnd the list of matching
records. The second variation takes the form SELECT
* from main where .... This selects the entire record,
and thus requires retrieving the encrypted records from
storage and transferring them across the network. The
time shown for each query includes the time to compute
the encrypted query.
Since caching can have a big impact on database
performance, we ran each set of queries under two
scenarios. In the ﬁrst scenario we cleared the caches in
the OS and in the Postgres database before running each
query. To clear the Postgres cache, we restarted Postgres.
To clear the OS cache, we ran the following:
echo 3 > /proc/sys/vm/drop_caches
In the other scenario, the cache was left alone.
Figures 4 and 5 display tests run with a cold cache.
Figures 6 and 7 have the results of the warm cache tests.
The results of these experiments show that the WRE
schemes achieve query response times with our Poisson
Random Frequency construction within 27% of plain-
text database response times on equality queries. As
expected, as the number of unique search tags increases,
so does the query response time. Across all of our
experimental conﬁgurations, the Fixed Salt scheme with
1000 salts is slower than the Poisson construction with
λ = 1000, and similarly, the Poisson with λ = 1000
performs slightly slower than Poisson with λ = 100.
This result is not surprising, since the Fixed Salt tech-
nique generates 1000 tags for each plaintext, while the
λ = 1000 results in λ + |M| tags for the entire column.
In section V-C1,
we mentioned that the Bucketized Poisson algorithm
may result in false positives in the search result. Figures
8 and 9 show the false positives introduced on the
SPARTA queries used in our performance evaluation.
The X axis shows the number of records returned for
each query with Poisson salt allocation, which does
not
introduce false positives. The Y axis shows the
number of records returned for the same queries with
the bucketized version of the algorithm.
Bucketized Poisson False Positives.
With lower values of λ, the Bucketized Poisson algo-
rithm appears to mask the true number of return results.
In Figure 9, with λ = 10, 000, we see some correlation
between the number of matching records in the database
and the number of ciphertext records that match the
bucketized query. However, in Figure 8 with λ = 1000,
the relationship is much weaker. In the future,
this
masking might be leveraged to prevent reconstruction
attacks [35], [38], where an adversary uses access pattern
leakage to recover the contents of the database.
VII. ACKNOWLEDGEMENTS
This material is based upon work supported by the
Defense Advanced Research Projects Agency (DARPA)
and Space and Naval Warfare Systems Center, Paciﬁc
(SSC Paciﬁc) under Contract No. N66001-15-C-4070.
Any opinions, ﬁndings and conclusions or recommenda-
tions expressed in this material are those of the author(s)
and do not necessarily reﬂect the views of DARPA or
SSC Paciﬁc.
526
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:57:27 UTC from IEEE Xplore.  Restrictions apply. 
Reset Cache Before Each Query
Fig. 4: “SELECT ID” Equality
Fig. 5: “SELECT *” Equality
Warm Cache - No Cache Reset
Fig. 6: “SELECT ID” Equality
Fig. 7: “SELECT *” Equality
Fig. 8: Bucketized Poisson False Positive
(λ = 1000)
Fig. 9: Bucketized Poisson False Positive
(λ = 10, 000)
527
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:57:27 UTC from IEEE Xplore.  Restrictions apply. 
REFERENCES
[1] “Always encrypted (database engine),” https://docs.microsoft.
com/en-us/sql/relational-databases/security/encryption/
always-encrypted-database-engine, accessed: 2017-10-31.
[2] “A graduate
course
in applied cryptography,” http://toc.
cryptobook.us/, accessed: 2018-5-1.
[3] R. Agrawal, J. Kiernan, R. Srikant, and Y. Xu, “Order preserving
encryption for numeric data,” in SIGMOD, 2004, pp. 563–574.
[4] G. Amanatidis, A. Boldyreva, and A. O’Neill, “Provably-Secure
Schemes for Basic Query Support in Outsourced Databases.”
in DBSec, ser. Lecture Notes in Computer Science, S. Barker
and G.-J. Ahn, Eds., vol. 4602.
Springer, 2007, pp.
14–30.
http://dblp.uni-trier.de/db/conf/
dbsec/dbsec2007.html#AmanatidisBO07;http://dx.doi.org/10.
1007/978-3-540-73538-0 2;http://www.bibsonomy.org/bibtex/
294c62ccd6e81c58c00817ce4cb858e60/dblp
[Online]. Available:
[5] G. Asharov, M. Naor, G. Segev, and I. Shahaf, “Searchable
symmetric encryption: Optimal locality in linear space via two-
dimensional balanced allocations,” in Proceedings of the forty-
eighth annual ACM symposium on Theory of Computing. ACM,
2016, pp. 1101–1114.
[6] M. Bellare, A. Boldyreva, and A. O’Neill, “Deterministic and
Efﬁciently Searchable Encryption,” in CRYPTO, 2007, pp. 535–
552.
[7] T. Boelter, R. Poddar, and R. A. Popa, “A secure one-roundtrip
index for range queries,” Cryptology ePrint Archive, Report
2016/568, 2016, https://eprint.iacr.org/2016/568.
[8] A. Boldyreva, N. Chenette, Y. Lee, and A. O’neill, “Order-
preserving symmetric encryption,” in EUROCRYPT, 2009, pp.
224–241.
[9] A. Boldyreva, N. Chenette, and A. O’Neill, “Order-preserving
encryption revisited: improved security analysis and alternative
solutions,” in CRYPTO, 2011, pp. 578–595.
[10] D. Boneh, K. Lewi, M. Raykova, A. Sahai, M. Zhandry, and
J. Zimmerman, “Semantically secure order-revealing encryption:
Multi-input
functional encryption without obfuscation.” in
EUROCRYPT (2), ser. Lecture Notes in Computer Science,
E. Oswald and M. Fischlin, Eds., vol. 9057. Springer, 2015,
pp. 563–594. [Online]. Available: http://dblp.uni-trier.de/db/conf/
eurocrypt/eurocrypt2015-2.html#BonehL0SZZ15
[11] D. Cash, P. Grubbs, J. Perry, and T. Ristenpart, “Leakage-Abuse
Attacks Against Searchable Encryption.” in ACM Conference
on Computer and Communications Security, I. Ray, N. Li, and
C. Kruegel, Eds. ACM, 2015, pp. 668–679. [Online]. Available:
http://dblp.uni-trier.de/db/conf/ccs/ccs2015.html#CashGPR15
[12] D. Cash, J. Jaeger, S. Jarecki, C. S. Jutla, H. Krawczyk,
M.-C. Rosu, and M. Steiner, “Dynamic Searchable Encryption
in Very-Large Databases: Data Structures and Implementation.”
in NDSS. The Internet Society, 2014. [Online]. Available: http:
//dblp.uni-trier.de/db/conf/ndss/ndss2014.html#CashJJJKRS14
[13] C. Chekuri and S. Khanna, “A polynomial time approximation
scheme for the multiple knapsack problem,” SIAM Journal on
Computing, vol. 35, no. 3, pp. 713–728, 2005.
[14] N. Chenette, K. Lewi, S. A. Weis, and D. J. Wu, “Practical
order-revealing encryption with limited leakage,” in International
Conference on Fast Software Encryption.
Springer, 2016, pp.
474–493.
[15] R. Curtmola, J. Garay, S. Kamara, and R. Ostrovsky, “Search-
able Symmetric Encryption: Improved Deﬁnitions and Efﬁcient
Constructions,” in CCS, 2006, pp. 79–88.
[16] I. Demertzis, S. Papadopoulos, O. Papapetrou, A. Deligiannakis,
and M. Garofalakis, “Practical private range search revisited,” in
Proceedings of the 2016 International Conference on Manage-
ment of Data. ACM, 2016, pp. 185–198.
[17] I. Demertzis and C. Papamanthou, “Fast searchable encryption
with tunable locality,” in Proceedings of the 2017 ACM Interna-
tional Conference on Management of Data. ACM, 2017, pp.
1053–1067.
[18] F. B. Durak, T. M. DuBuisson, and D. Cash, “What else
is revealed by order-revealing encryption?” in Proceedings
of
the 2016 ACM SIGSAC Conference on Computer and
Communications Security, ser. CCS ’16. New York, NY,
USA: ACM, 2016, pp. 1155–1166.
[Online]. Available:
http://doi.acm.org/10.1145/2976749.2978379
[19] S. Faber, S. Jarecki, H. Krawczyk, Q. Nguyen, M.-C. Rosu,
and M. Steiner, “Rich queries on encrypted data: Beyond exact
matches,” 2015, pp. 123–145.
[20] B. Fuhry, R. Bahmani, F. Brasser, F. Hahn, F. Kerschbaum, and
A.-R. Sadeghi, “Hardidx: practical and secure index with sgx,”
in IFIP Annual Conference on Data and Applications Security
and Privacy. Springer, 2017, pp. 386–408.
[21] C. Gentry, “Fully homomorphic encryption using ideal lattices,”
in STOC, 2009, pp. 169–169.
[22] E.-J. Goh,
“Secure
Indexes.”
Archive, vol. 2003, p. 216, 2003.
http://dblp.uni-trier.de/db/journals/iacr/iacr2003.html#Goh03;
http://eprint.iacr.org/2003/216;http://www.bibsonomy.org/bibtex/
235b9c14f05f89b78a4e03253222c786b/dblp
IACR Cryptology
ePrint
[Online]. Available:
[23] O. Goldreich, “Towards a theory of
software protection
and simulation by oblivious rams,” in STOC, A. V. Aho,
Ed. ACM, 1987, pp. 182–194.
[Online]. Available: http:
//dblp.uni-trier.de/db/conf/stoc/stoc87.html#Goldreich87
[24] S. Goldwasser and S. Micali, “Probabilistic encryption,” Journal
of computer and system sciences, vol. 28, no. 2, pp. 270–299,
1984.
[25] P. Groﬁg, M. Hrterich, I. Hang, F. Kerschbaum, M. Kohler,
A. Schaad, A. Schrpfer, and W. Tighzert, “Experiences and
observations on the industrial implementation of a system to
search over outsourced encrypted data.” in Sicherheit, ser. LNI,
S. Katzenbeisser, V. Lotz, and E. R. Weippl, Eds., vol. 228.
GI, 2014, pp. 115–125. [Online]. Available: http://dblp.uni-trier.
de/db/conf/sicherheit/sicherheit2014.html#GroﬁgHHKKSST14
[26] P. Grubbs, “On deploying property-preserving encryption,” 2016,
[Online]. Available: https://drive.
real World Cryptography.
google.com/ﬁle/d/0Bzm 4XrWnl5zWndfZTVsRkpyWm8/view
[27] P. Grubbs, R. McPherson, M. Naveed, T. Ristenpart, and
V. Shmatikov, “Breaking web applications built on top of
encrypted data.” IACR Cryptology ePrint Archive, vol. 2016,
p. 920, 2016.
[Online]. Available: http://dblp.uni-trier.de/db/
journals/iacr/iacr2016.html#GrubbsMNRS16
[28] P. Grubbs, T. Ristenpart, and V. Shmatikov, “Why your encrypted
database is not secure,” Cryptology ePrint Archive, Report
2017/468, 2017, http://eprint.iacr.org/2017/468.
[29] P. Grubbs, K. Sekniqi, V. Bindschaedler, M. Naveed, and
T. Ristenpart, “Leakage-abuse attacks against order-revealing
encryption,” in 2017 IEEE Symposium on Security and Privacy,
SP 2017, San Jose, CA, USA, May 22-26, 2017, 2017, pp.
655–672. [Online]. Available: https://doi.org/10.1109/SP.2017.44
[30] F. Hahn and F. Kerschbaum, “Poly-logarithmic range queries on
encrypted data with small leakage,” in Proceedings of the 2016
ACM on Cloud Computing Security Workshop. ACM, 2016, pp.
23–34.
[31] W. He, D. Akhawe, S. Jain, E. Shi, and D. X. Song,
“ShadowCrypt: Encrypted Web Applications for Everyone.” in
ACM Conference on Computer and Communications Security,
G.-J. Ahn, M. Yung, and N. Li, Eds. ACM, 2014, pp.
1028–1039. [Online]. Available: http://dblp.uni-trier.de/db/conf/
ccs/ccs2014.html#HeAJSS14
[32] B. Hore, S. Mehrotra, M. Canim, and M. Kantarcioglu, “Secure
multidimensional range queries over outsourced data,” The VLDB
JournalThe International Journal on Very Large Data Bases,
vol. 21, no. 3, pp. 333–358, 2012.
528
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:57:27 UTC from IEEE Xplore.  Restrictions apply. 
[48] M. Varia, B. Price, N. Hwang, A. Hamlin, J. Herzog, J. Poland,
M. Reschly, S. Yakoubov, and R. K. Cunningham, “Automated
Assessment of Secure Search Systems,” SIGOPS Oper. Syst.
Rev., vol. 49, no. 1, pp. 22–30, Jan. 2015. [Online]. Available:
http://doi.acm.org/10.1145/2723872.2723877
[49] J. Wang and X. Du, “A secure multi-dimensional partition
based index in das.” in APWeb, ser. Lecture Notes in Computer
Science, Y. Zhang, G. Yu, E. Bertino, and G. Xu, Eds., vol.
4976. Springer, 2008, pp. 319–330. [Online]. Available: http:
//dblp.uni-trier.de/db/conf/apweb/apweb2008.html#WangD08
[50] L. Wang, P. Grubbs,
J. Lu, V. Bindschaedler, D. Cash,
and T. Ristenpart, “Side-channel attacks on shared search
indexes.” in IEEE Symposium on Security and Privacy.
IEEE
Computer Society, 2017, pp. 673–692.
[Online]. Available:
http://dblp.uni-trier.de/db/conf/sp/sp2017.html#WangGLBCR17
[51] C. V. Wright and D. Pouliot, “Early detection and analysis of
leakage abuse vulnerabilities,” Cryptology ePrint Archive, Report
2017/1052, 2017, http://eprint.iacr.org/2017/1052.
[33] B. Hore, S. Mehrotra, and G. Tsudik, “A privacy-preserving index
for range queries,” in Proceedings of the Thirtieth international
conference on Very large data bases-Volume 30. VLDB Endow-
ment, 2004, pp. 720–731.
[34] S. Kamara, “Encrypted search.” ACM Crossroads, vol. 21, no. 3,
pp. 30–34, 2015. [Online]. Available: http://dblp.uni-trier.de/db/
journals/crossroads/crossroads21.html#Kamara15
[35] G. Kellaris, G. Kollios, K. Nissim, and A. O’Neill, “Generic
Attacks on Secure Outsourced Databases.” in ACM Conference
on Computer and Communications Security, E. R. Weippl,
S. Katzenbeisser, C. Kruegel, A. C. Myers, and S. Halevi,
Eds.
[Online]. Available:
http://dblp.uni-trier.de/db/conf/ccs/ccs2016.html#KellarisKNO16
[36] F. Kerschbaum and A. Tueno, “An efﬁciently searchable
range queries,” arXiv preprint
ACM, 2016, pp. 1329–1340.
encrypted data structure for
arXiv:1709.09314, 2017.
[37] M.-S. Lacharite and K. G. Paterson, “Frequency-smoothing
encryption: preventing snapshot attacks on deterministically-
encrypted data,” Cryptology ePrint Archive, Report 2017/1068,
2017, https://eprint.iacr.org/2017/1068.
[38] M. Lacharit, B. Minaud, and K. G. Paterson, “Improved recon-
struction attacks on encrypted data using range query leakage,”
in 2018 IEEE Symposium on Security and Privacy (SP), May
2018, pp. 297–314.
[39] B. Lau, S. P. Chung, C. Song, Y.
Jang, W. Lee, and
A. Boldyreva, “Mimesis Aegis: A Mimicry Privacy Shield-
A System’s Approach to Data Privacy on Public Cloud.”
in USENIX Security Symposium, K. Fu and J. Jung, Eds.
USENIX Association, 2014, pp. 33–48. [Online]. Available:
http://dblp.uni-trier.de/db/conf/uss/uss2014.html#LauCSJLB14
[40] K. Lewi and D. J. Wu, “Order-Revealing Encryption: New
Constructions, Applications, and Lower Bounds.” in ACM
Conference on Computer and Communications Security, E. R.
Weippl, S. Katzenbeisser, C. Kruegel, A. C. Myers, and
S. Halevi, Eds. ACM, 2016, pp. 1167–1178. [Online]. Available:
http://dblp.uni-trier.de/db/conf/ccs/ccs2016.html#LewiW16
[41] M. Naveed, S. Kamara, and C. V. Wright, “Inference Attacks on
Property-Preserving Encrypted Databases.” in ACM Conference
on Computer and Communications Security, I. Ray, N. Li, and
C. Kruegel, Eds. ACM, 2015, pp. 644–655. [Online]. Available:
http://dblp.uni-trier.de/db/conf/ccs/ccs2015.html#NaveedKW15
[42] O. Pandey and Y. Rouselakis, “Property preserving symmetric
encryption.” in EUROCRYPT, ser. Lecture Notes in Computer
Science, D. Pointcheval and T. Johansson, Eds., vol. 7237.
Springer, 2012, pp. 375–391. [Online]. Available: http://dblp.
uni-trier.de/db/conf/eurocrypt/eurocrypt2012.html#PandeyR12
[43] K. Paterson and M.-S. Lacharit´e, Personal communication, De-
cember 2017.
[44] R. A. Popa, C. M. S. Redﬁeld, N. Zeldovich,
[45] D. Pouliot
in SOSP, T. Wobber
and
H. Balakrishnan, “CryptDB: protecting conﬁdentiality with
encrypted query processing.”
and
P. Druschel, Eds. ACM, 2011, pp. 85–100. [Online]. Available:
http://dblp.uni-trier.de/db/conf/sosp/sosp2011.html#PopaRZB11
“The Shadow Nemesis:
Inference Attacks
on Efﬁciently Deployable, Efﬁciently
Searchable Encryption.” in ACM Conference on Computer
and Communications Security, E. R. Weippl, S. Katzen-
beisser, C. Kruegel, A. C. Myers,
S. Halevi,
Eds.
[Online]. Available:
http://dblp.uni-trier.de/db/conf/ccs/ccs2016.html#PouliotW16
ACM, 2016, pp. 1341–1352.
and C. V. Wright,
and
[46] D. Song, D. Wagner, and A. Perrig, “Practical Techniques for
Searching on Encrypted Data,” in S&P, 2000, pp. 44–55.
[47] E. Stefanov and E. Shi, “Oblivistore: High performance oblivious
cloud storage.” in IEEE Symposium on Security and Privacy.
IEEE Computer Society, 2013, pp. 253–267. [Online]. Available:
http://dblp.uni-trier.de/db/conf/sp/sp2013.html#StefanovS13
529
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:57:27 UTC from IEEE Xplore.  Restrictions apply.