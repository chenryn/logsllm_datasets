title:bdrmap: Inference of Borders Between IP Networks
author:Matthew J. Luckie and
Amogh Dhamdhere and
Bradley Huffaker and
David D. Clark and
kc claffy
bdrmap: Inference of Borders Between IP Networks
Matthew Luckie
University of Waikato
PI:EMAIL
Amogh Dhamdhere
CAIDA / UC San Diego
PI:EMAIL
Bradley Huffaker
CAIDA / UC San Diego
PI:EMAIL
David Clark
MIT
PI:EMAIL
kc claffy
CAIDA / UC San Diego
PI:EMAIL
ABSTRACT
We tackle the tedious and unsolved problem of auto-
matically and correctly inferring network boundaries in
traceroute. We explain why such a conceptually sim-
ple task is so hard in the real world, and how lack of
progress has impeded a wide range of research and de-
velopment eﬀorts for decades. We develop and validate
a method that uses targeted traceroutes, knowledge of
traceroute idiosyncrasies, and codiﬁcation of topologi-
cal constraints in a structured set of heuristics, to cor-
rectly identify interdomain links at the granularity of
individual border routers. In this study we focus on the
network boundaries we have most conﬁdence we can
accurately infer in the presence of sampling bias:
in-
terdomain links attached to the network launching the
traceroute. We develop a scalable implementation of
our algorithm and validate it against ground truth infor-
mation provided by four networks on 3,277 links, which
showed 96.3% – 98.9% of our inferences were correct.
With 19 vantage points (VPs) distributed across a
large U.S. broadband provider, we use our method to re-
veal the tremendous density of router-level interconnec-
tion between some ASes. In January 2016, the broad-
band provider had 45 router-level links with a Tier-1
peer. We also quantify the VP deployment required
to observe this ISP’s interdomain connectivity, with 17
VPs required to observe all 45 links. Our method forms
the cornerstone of the system we are building to map
interdomain performance, and we release our code.
Keywords
Internet topology; Router ownership
Permission to make digital or hard copies of all or part of this work for personal
or classroom use is granted without fee provided that copies are not made or
distributed for proﬁt or commercial advantage and that copies bear this notice
and the full citation on the ﬁrst page. Copyrights for components of this work
owned by others than ACM must be honored. Abstracting with credit is per-
mitted. To copy otherwise, or republish, to post on servers or to redistribute to
lists, requires prior speciﬁc permission and/or a fee. Request permissions from
permissions@acm.org.
IMC 2016, November 14–16, Santa Monica, CA, USA.
c(cid:13) 2016 ACM. ISBN 978-1-4503-4526-2/16/11. . . $15.00
DOI: http://dx.doi.org/10.1145/2987443.2987467
1.
INTRODUCTION
Every Internet researcher and operator is familiar
with traceroute, but not everyone is aware of the infer-
ential challenges in interpreting traceroute output, the
diverse barriers to developing a more accurate Inter-
net path inference capability, and the resulting imped-
iments to a range of research and development eﬀorts.
Despite these impediments, researchers have relied on
traceroute to support measurement and analysis of In-
ternet router-level topologies for two decades.
Internet router-level topology discovery and inference
is tedious and error-prone for at least ﬁve classes of rea-
sons. Most obviously, the TCP/IP architecture has no
notion of interdomain boundaries at the network layer.
In fact, the architecture does not even have any mecha-
nism to identify a complete router – an IP address iden-
tiﬁes only a single interface on a router, and routers may
have hundreds of (or thousands of virtual) interfaces.
Second, the measurement tool used for IP topology
discovery implements a 30-year old clever hack in which
an end host sends customized probe packets along a for-
ward path toward a destination to trick each router into
revealing one of their interface IP addresses to the end
host. Constructing an Internet-scale topology requires
superimposing millions of such measurements from mul-
tiple sources, onto an interface topology graph, and
then applying heuristic techniques to infer which IP
addresses are interfaces on the same physical router,
i.e., alias resolution. Failure to accurately resolve such
aliases for the same router will result in an inﬂated in-
ference of the number of links between networks.
Third, operator address assignment and router imple-
mentation practices limit the accuracy of the canonical
approach of mapping an IP address observed in tracer-
oute to the organization that announces the longest
matching preﬁx for that IP address in BGP [44]. Fourth,
traceroute measurements repeatedly sample links close
to the vantage point [22], resulting in topologies where
links farther from the network are less likely to be ob-
served. This sampling bias can reduce the accuracy
of router ownership inferences because there are fewer
topological constraints available.
381Finally, operators could overcome all of these issues
by assigning hostnames to router interfaces that identify
the router itself, but concerns about revealing network
topology information to competitors, or to prospective
attackers, align operator incentives away from trans-
parency about their internal network topologies.
These challenges impede many Internet research and
development eﬀorts, from realistic network modeling,
protocol design, to assessment of real-world network
properties such as interdomain congestion, infrastruc-
ture resiliency, and identifying vulnerabilities due to in-
adequate security policies. In light of these challenges,
this paper makes the following ﬁve contributions:
(1) We introduce a scalable method for accu-
rately inferring the boundaries of a given net-
work, and the other networks attached at each
boundary. Our approach eﬃciently infers forward IP
paths from traceroute measurements, resolves IP aliases
to construct a router-level topology [15, 40, 21], and
then uses this topology as well as topological constraints
inferred from BGP data [25] to narrow the possible set
of links and associated IP addresses that represent bor-
ders between networks. Our approach builds on gen-
erally accepted assumptions about industry practices,
such as numbering border router interfaces with IP ad-
dresses that belong to an upstream provider’s network.
Our method explicitly accommodates known limitations
of traceroute, e.g., sometimes a border router responds
to a traceroute probe using a source address belonging
to a third-party AS, i.e., one that maps to neither net-
work constituting the border. Even when a neighbor
network does not respond to our probes, our algorithm
can still pinpoint where they interconnect.
(2) We develop an eﬃcient system to allow
deployment of our method on resource-limited
devices. We show that the probing our algorithm uses
obtains a complete and accurate router-level interdo-
main map, but the densest measurement infrastructure
deployments use resource-limited devices that cannot
maintain state for the entire map themselves. We ex-
tend our measurement tools to support low-resource
devices by interactively oﬄoading data and state to a
centrally-operated system.
(3) We validate our algorithm’s correctness us-
ing ground truth from four network operators
as well as databases of IXP address use. We used
ground truth provided by a research and education net-
work, a large access network, a Tier-1 network, and a
small access network. For these networks, our algorithm
correctly identiﬁed interdomain links and corresponding
ASes for 96.3% – 98.9% of the 3,277 links inferred, ﬁnds
nearly all (92% – 99%) AS neighbors observed in pub-
lic BGP data, and correctly identiﬁes interdomain links
not observed in public BGP data.
(4) We demonstrate the utility of our algo-
rithm by analyzing the topology of a large ac-
cess ISP to understand modern interconnection
agreements. Data we collected in January 2016 shows
the presence of an astounding 45 interdomain links with
one of the ISP’s Tier-1 peers, geographically distributed
throughout the ISP’s network, with 25 of these links
only visible from a vantage point (VP) in speciﬁc re-
gions. For 73% of measured preﬁxes, we observed 5 –
15 distinct border routers carrying probe traﬃc.
(5) We publicly release the source code imple-
mentation. To promote further validation and use of
our network border mapping measurement and analy-
sis algorithm, which we call bdrmap, we publicly release
our source code implementation as part of scamper [23].
Our method infers all interdomain links directly con-
nected to and visible from the network hosting a single
VP. Accurately inferring the parties involved in all inter-
domain links observed in traceroute requires overcoming
the natural sample bias in traceroute [22], i.e., poorer
visibility into distant networks, which limits our abil-
ity to assemble constraints. We build on years of prior
work in topology discovery (e.g. [10, 2]), alias resolution
(e.g. [15, 40, 5, 21]), AS relationship inference [25], and
active probing systems (e.g. [23]). Our contributions are
a scalable system that synthesizes this prior work, and
a set of novel heuristics that correctly infer router-level
interdomain links and the involved parties.
2. MOTIVATION
Network Modeling and Resilience: Early models
of Internet topology considered each AS a node, and an
interdomain link an edge between two ASes [43]. While
this simplistic model does not reﬂect the complexity of
Internet interconnection, it has reﬂected the inferential
capabilities of the research community [43]. Our work
enables the construction of a router-level map of in-
terdomain connectivity, which will empirically ground
eﬀorts to accurately model AS topology evolution.
The capability to correctly identify the interdomain
links of a network also enables analysis of network re-
siliency and robustness in a way not previously possi-
ble. For instance, we can use comprehensive traceroutes
(from archives or targeted) to estimate which routers,
links, and interconnection facilities carry traﬃc to a sig-
niﬁcant fraction of the Internet [37], and the potential
of an attack or outage to disrupt connectivity.
Interdomain congestion: Exploding demand for
high-bandwidth content (e.g., streaming video) has fu-
eled recent peering disputes, creating tension among
ISPs. Although in the past such disputes have some-
times led to de-peering, the Internet’s critical role today
inhibits such behavior by networks. Instead, stalled ne-
gotiation about who should pay to upgrade interdomain
links may lead to congestion as traﬃc grows beyond ca-
pacity, aﬀecting not just the networks in dispute but the
sources and destinations of all traﬃc crossing the link.
The public policy community has growing interest in
identifying persistent congestion on interdomain links,
and its potential harms to consumers. In 2015, the U.S.
Federal Communications Commission (FCC) attached
382conditions to the AT&T-DirectTV merger [12] that re-
quire AT&T report to the FCC performance measure-
ments of its interconnections.
Recent work has explored various methods to identify
interdomain congestion: sending a time series of probes
to the near and far side of an interdomain link [24];
network tomography [36]; and crowd-sourced through-
put measurements [27]. Remarkably, with each of these
techniques, the greatest measurement challenge is not
detecting the presence of congestion, but identifying in-
terdomain links to probe, and associating observed evi-
dence of congestion to speciﬁc interdomain links [24].
Further, placing any isolated signal of congestion in
an appropriate context requires a more comprehensive
network-wide view of interdomain links and their con-
gestion state – ideally, some kind of weather map of
congestion. The surprisingly primitive state of Internet
measurement tools renders such an ambition a grand
challenge in our ﬁeld. Accurate identiﬁcation of net-
work borders is essential to progress on this goal.
3. RELATED WORK
Measurement and analysis of the Internet topology
has been an active area of research for over two decades.
The literature spans the AS, router, and physical topol-
ogy, with recent focus on the rich connectivity at IXPs
(e.g., [3, 1, 14]) and understanding physical infrastruc-
ture facilitating connectivity (e.g., [11, 13]). While our
work overlaps with research seeking to understand how
interconnection is facilitated, our objective is to infer in-
terconnection topology details that enable accurate in-
terpretation of routing and performance measurements.
Techniques for resolving IP addresses to com-
mon routers. The process of mapping IP addresses to
routers is known as alias resolution; it is a critical step
in counting and characterizing interdomain connections
between networks. Although researchers have made sig-
niﬁcant progress, this problem is not entirely solved. A
survey of existing alias resolution techniques and im-
plementations, including utilizing reverse DNS informa-
tion, record route data, and IGMP (multicast) protocol
messages, is available in [19]. Early techniques [31, 15,
20] probe unused ports on routers and collect the result-
ing error messages. Probing one interface and getting
an error response from a diﬀerent interface is evidence
that the two interfaces belong to the same router.
In 2002, Spring et al. developed a method and tools
to map individual ISP networks using focused tracer-
outes and BGP routing tables [40]. Their Ally tool was
the ﬁrst to infer that two addresses are aliases if probe
packets sent to them produce responses with increasing
but appropriately proximate IP ID values, since the IP
ID ﬁeld increments with each packet sent from some
routers. RadarGun [5] reﬁned this method by looking
for similarities in IP ID time series collected from mul-
tiple addresses. More recently, Sherwood et al. de-
veloped Discarte [39] which uses the IP record-route
option, traceroute, and disjunctive logic programming
to accurately derive a router-level topology from the
IP-interface topology. APAR [16] and kapar [19] used
sophisticated graph analysis techniques to infer subnets
linking routers, and from that, aliases. Sherry [38] de-
scribes iPlane’s use of the IP prespeciﬁed timestamp op-
tion to infer aliases. MIDAR [21] expanded on the IP ve-
locity techniques of RadarGun by implementing an ex-
tremely precise ID comparison test based on monotonic-
ity rather than proximity, integrating multiple probing
methods from multiple VPs, and using a probe schedul-
ing algorithm that scales to millions of IP addresses.
While these eﬀorts have contributed great progress to
the ﬁeld of router-level topology inference, they have
focused on structural properties of individual ASes; our
work here focuses on the accurate inference of router-
level interdomain connectivity between ASes.
Inference of AS-level connectivity. Despite its
limitations, traceroute can provide a source of AS-level
connectivity information, and compensate for a funda-
mental limitation of interdomain routing (BGP) data.
Speciﬁcally, BGP routers usually propagate to other
routers only their best path to a given destination, leav-
ing a rich database of connectivity knowledge available
only to the network’s operator. A dense deployment of
traceroute VPs does not rely on cooperation of network
operators, allowing each VP to observe the best path
to a given destination. However, deriving AS-level con-
nectivity from traceroute requires some level of heuristic
inference, and caution when applying it. The canoni-
cal approach to convert IP-level traceroute output to an
AS-level path is to map each observed IP address to the
AS originating a BGP announcement of the longest pre-
ﬁx containing that address. But this approach can in-
duce substantial false AS-link inferences, because some