The key information in this chapter is the following: 
NetBIOS is a standard API at the Session layer for user applications to utilize the services of installed 
network protocol stacks and a session management and data transport protocol. 
A NetBIOS name is a 16-byte name that identifies a unique or group NetBIOS application on a network. 
NetBIOS name management includes processes for NetBIOS name registration, resolution, and 
release. 
NetBT provides NetBIOS session, name management, and datagram services for NetBIOS applications 
running on an IPv4 network. NetBT is required for computers running Windows Vista, Windows XP, 
Windows Server 2008, or Windows Server 2003 only when running NetBIOS applications. 
NetBT in Windows can use the NetBIOS name cache, an NBNS, broadcasts, the Lmhosts file, the local 
host name, the DNS client resolver cache, and DNS servers to resolve NetBIOS names. 
NetBT uses the Microsoft enhanced B-node NetBIOS node type (if no WINS servers are configured) or 
the H-node NetBIOS node type (if at least one WINS server is configured). 
The Lmhosts file is a static text file of NetBIOS names and IPv4 addresses that NetBT uses to resolve 
the NetBIOS names for NetBIOS applications running on remote computers. 
The Nbtstat tool is the primary tool for collecting NetBT information when troubleshooting NetBIOS 
name issues. 
Chapter 11 – NetBIOS over TCP/IP 
TCP/IP Fundamentals for Microsoft Windows  
Page: 336 
Chapter Glossary 
DNS – See Domain Name System (DNS). 
DNS client resolver cache – A RAM-based table that contains both the entries in the Hosts file and the 
results of recent DNS name queries. 
DNS server – A server that maintains a database of mappings of DNS domain names to various types 
of data, such as IP addresses. 
Domain Name System (DNS) – A hierarchical, distributed database that contains mappings of DNS 
domain names to various types of data, such as IP addresses. With DNS, users can specify computers 
and services by friendly names. DNS also enables the discovery of other information stored in its 
database. 
Host name – The name of a computer or device on a network. Users specify computers on the network 
by their host names. For another computer to be found, its host name must either appear in the Hosts 
file or be known by a DNS server. For most computers running Windows, the host name and the 
computer name are the same.  
Host name resolution – The process of resolving a host name to a destination IP address. 
Hosts file – A local text file in the same format as the 4.3 Berkeley Software Distribution (BSD) UNIX 
/etc/hosts file. This file maps host names to IP addresses, and it is stored in the 
systemroot\System32\Drivers\Etc folder. 
Lmhosts file – A local text file that maps NetBIOS names to IP addresses for hosts that are located on 
remote subnets. For computers running Windows, this file is stored in the 
systemroot\System32\Drivers\Etc folder. 
NBNS – See NetBIOS name server (NBNS). 
NetBIOS – See network basic input/output system (NetBIOS). 
NetBIOS name - A 16-byte name for an application that uses the network basic input/output system 
(NetBIOS). 
NetBIOS name cache – A dynamically maintained table that stores recently resolved NetBIOS names 
and their associated IPv4 addresses. 
NetBIOS name resolution – The process of resolving a NetBIOS name to an IPv4 address. 
NetBIOS name server (NBNS) – A server that stores NetBIOS name-to-IPv4 address mappings and 
that resolves NetBIOS names for NetBIOS-enabled hosts. The WINS Server service is the Microsoft 
implementation of an NBNS. 
NetBIOS node type – A designation of the specific way that NetBIOS nodes resolve NetBIOS names. 
NetBIOS over TCP/IP (NetBT) – The implementation of the NetBIOS session protocol over TCP/IP 
(IPv4 only) that provides network name registration and verification, session establishment and 
termination, and data transfer services for reliable connection-oriented sessions and unreliable 
connectionless datagrams. 
NetBT – See NetBIOS over TCP/IP (NetBT). 
Chapter 11 – NetBIOS over TCP/IP 
TCP/IP Fundamentals for Microsoft Windows  
Page: 337 
Network basic input/output system (NetBIOS) – A standard API for user applications to submit network 
I/O and control directives to underlying network protocol software and a protocol that functions at the 
Session layer. 
Windows Internet Name Service (WINS) – The Microsoft implementation of an NBNS. 
WINS – See Windows Internet Name Service (WINS). 
Chapter 11 – NetBIOS over TCP/IP 
TCP/IP Fundamentals for Microsoft Windows  
Page: 338 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 339 
Chapter 12 – Windows Internet Name Service Overview 
Abstract 
This chapter describes the use of Windows Internet Name Service (WINS) in Microsoft Windows operating systems to 
provide network basic input/output system (NetBIOS) name resolution on a TCP/IP network. A network administrator 
must understand the role and configuration of WINS clients, WINS servers, and WINS proxies to successfully deploy a 
NetBIOS name resolution infrastructure and to troubleshoot issues with NetBIOS name resolution. 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 340 
Chapter Objectives 
After completing this chapter, you will be able to: 
Describe the function of Windows Internet Name Service (WINS). 
Explain how WINS clients perform name registration, name renewal, name refresh, and name 
resolution. 
Configure a WINS client to use primary and secondary WINS servers. 
Install a WINS server and configure it for static mappings and to replicate its database with other WINS 
servers. 
Describe the function and configuration of a WINS proxy. 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 341 
Introduction to WINS 
Windows Internet Name Service (WINS) is the Windows implementation of a NetBIOS name server 
(NBNS), which provides a distributed database for registering and querying dynamic mappings of 
NetBIOS names to IPv4 addresses used on your network. WINS is designed to provide NetBIOS name 
resolution in routed TCP/IP networks with multiple subnets. Without WINS, you must maintain Lmhosts 
files. 
Before two hosts that use NetBIOS over TCP/IP (NetBT) can communicate, the destination NetBIOS 
name must be resolved to an IPv4 address. TCP/IP cannot establish communication using a NetBIOS 
computer name. The basic procedure for WINS-based NetBIOS name resolution is the following: 
1. Each time a WINS client starts, it registers its NetBIOS name-to-IPv4 address mappings with a 
configured WINS server. 
2. When a NetBIOS application running on a WINS client initiates communication with another host, 
NetBT sends a NetBIOS Name Query Request message with the destination NetBIOS name directly 
to the WINS server, instead of broadcasting it on the local network. 
3. If the WINS server finds a NetBIOS name-to-IPv4 address mapping for the queried name in its 
database, it returns the corresponding IPv4 address to the WINS client. 
Using WINS provides the following advantages: 
Client requests for name resolution are sent directly to a WINS server. If the WINS server can resolve 
the name, it sends the IPv4 address directly to the client. As a result, a broadcast is not needed and 
broadcast traffic is reduced. However, if the WINS server is unavailable or does not have the 
appropriate mapping, the WINS client can still use a broadcast in an attempt to resolve the name. 
The WINS database is updated dynamically so that it is always current. This process allows NetBIOS 
name resolution on networks using DHCP and eliminates the need for local or centralized Lmhosts 
files. 
WINS provides computer browsing capabilities across subnets and domains. Computer browsing 
provides the list of computers in My Network Places. For more information, see Appendix C, "Computer 
Browser Service." 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 342 
How WINS Works 
The WINS Server service in Windows Server 2003 is an implementation of an NBNS as described in 
Requests for Comments (RFCs) 1001 and 1002. WINS clients use a combination of the following 
processes: 
Name registration 
Each WINS client is configured with the IPv4 address of a WINS server. When a WINS client starts, 
it registers its NetBIOS names and their corresponding IPv4 addresses with its WINS server. The 
WINS server stores the client’s NetBIOS name-to-IPv4 address mappings in its database. 
Name renewal 
All NetBIOS names are registered on a temporary basis so that if the original owner stops using a 
name, a different host can use it later. At defined intervals, the WINS client renews the registration 
for its NetBIOS names with the WINS server. 
Name resolution 
A WINS client can obtain the IPv4 addresses for NetBIOS names by querying the WINS server. 
Name release 
When a NetBIOS application no longer needs a NetBIOS name, such as when a NetBIOS-based 
service is shut down, the WINS client sends a message to the WINS server to release the name. 
These processes are described in greater detail in the following sections. 
All WINS communications between WINS clients and WINS servers use unicast NetBIOS name 
management messages over User Datagram Protocol (UDP) port 137, the reserved port for the 
NetBIOS Name Service. 
Name Registration 
When a WINS client initializes, it registers its NetBIOS names by sending a NetBIOS Name 
Registration Request message directly to its configured WINS server. NetBIOS names are registered 
when NetBIOS services or applications start, such as the Workstation, Server, and Messenger 
services. 
If the NetBIOS name is unique and another WINS client has not already registered the name, the WINS 
server sends a positive Name Registration Response message to the WINS client. This message 
contains the amount of time, known as the Time to Live (TTL), that the NetBIOS name is registered to 
the WINS client. The TTL is configured on the WINS server. 
When a Duplicate Name Is Found 
If a duplicate unique name is registered in the WINS database, the WINS server sends a challenge to 
the currently registered owner of the name as a unicast NetBIOS Name Query Request message. The 
WINS server sends the challenge three times at 500-millisecond intervals.  
If the current registered owner responds to the challenge successfully, the WINS server sends a 
negative Name Registration Response message to the WINS client that is attempting to register the 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 343 
duplicate name. If the current registered owner does not respond to the WINS server, the server sends 
a positive Name Registration Response message to the WINS client that is attempting to register the 
name and updates its database with the new owner. 
When WINS Servers are Unavailable 
A typical WINS client is configured with a primary and a secondary WINS server, although you can 
configure more than two WINS servers. A WINS client makes three attempts to register its names with 
its primary WINS server. If the third attempt gets no response, the WINS client sends name registration 
requests to its secondary WINS server (if configured) and any additional servers that have been 
configured. If none of the WINS servers are available, the WINS client uses local broadcasts to register 
its NetBIOS names. 
Name Renewal 
To continue using the same NetBIOS name, a client must renew its registration before the TTL it 
received in the last positive Name Registration Response message expires. If the client does not renew 
the registration, the WINS server removes the NetBIOS name from its database. After that point, other 
computers cannot resolve the NetBIOS name to the address of the former owner and another client can 
register the name for itself. 
Name Refresh Request 
Every WINS client attempts to renew its NetBIOS names with its primary WINS server by sending a 
NetBIOS Name Refresh message when half of the TTL has elapsed or when the computer or the 
service restarts. If the WINS client does not receive a NetBIOS Name Registration Response message, 
the client sends another refresh message to its primary WINS server every 10 minutes for one hour. If 
none of these attempts is successful, the client then tries the secondary WINS server every 10 minutes 
for one hour. The client continues to send refresh messages to the primary server for an hour and then 
to the secondary server for an hour until either the name expires or a WINS server responds and 
renews the name. 
If the WINS client succeeds in refreshing its name, the WINS server that responds to the NetBIOS 
Name Refresh message resets the renewal interval. If the WINS client fails to refresh the name on 
either the primary or secondary WINS server during the renewal interval, the name is released. 
Name Refresh Response 
When a WINS server receives the NetBIOS Name Refresh message, the server sends the client a 
positive Name Registration Response message with a new TTL. 
Name Release 
When a NetBIOS application running on a WINS client is closed, NetBT instructs the WINS server to 
release the unique NetBIOS name used by the application. The WINS server then removes the 
NetBIOS name mapping from its database. 
The name release process uses the following types of messages: 
Name Release Request 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 344 
The Name Release Request message includes the client’s IPv4 address and the NetBIOS name to 
be removed from the WINS database. 
Name Release Response 
When the WINS server receives the Name Release Request message, the server checks its 
database for the specified name. If the WINS server encounters a database error or if a different 
IPv4 address maps to the registered name, the server sends a negative Name Release Response 
message to NetBT on the WINS client.  
Otherwise, the WINS server sends a positive Name Release Response message and then 
designates the specified name as inactive in its database. The positive Name Release Response 
message contains the released NetBIOS name and a TTL value of 0. 
Name Resolution 
Computers that are running Windows Server 2003 or Windows XP and that are configured with the 
IPv4 addresses of WINS servers by default use the H-node NetBIOS node type. NetBT always checks 
the WINS server for a NetBIOS name-to-IPv4 address mapping before sending a broadcast. The 
NetBIOS name resolution process is the following: 
1. NetBT checks the NetBIOS name cache for the NetBIOS name-to-IPv4 address mapping of the 
destination. 
2. If the name is not resolved from the NetBIOS name cache, NetBT sends a unicast NetBIOS Name 
Query Request message to the configured primary WINS server.  
If the primary WINS server can resolve the name, the server responds with a positive NetBIOS Name 
Query Response message that contains the IPv4 address for the requested NetBIOS name.  
If the primary WINS server does not respond after three separate attempts or responds with a 
negative Name Query Response message, the client sends a NetBIOS Name Query Request 
message to its configured secondary WINS server. 
If additional WINS servers are configured and the secondary WINS server does not respond after 
three separate attempts or responds with a negative Name Query Response message, the client 
sends a NetBIOS Name Query Request message to the additional configured WINS server or 
servers in configuration order. 
3. If none of the servers respond with a positive Name Query Response message, the WINS client 
broadcasts up to three Name Query Request messages on the local subnet. 
If the name is not resolved from these methods, the WINS client might still resolve the name by parsing 
the Lmhosts file; converting the NetBIOS name to a single-label, unqualified domain name; and 
checking it against the local host name, the Domain Name System (DNS) client resolver cache, and 
DNS. For more information, see Chapter 11, "NetBIOS Over TCP/IP." 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 345 
The WINS Client 
You can configure the WINS client, known as the TCP/IP NetBIOS Helper service in the Services snap-
in, in the following ways: 
Automatically, using the Dynamic Host Configuration Protocol (DHCP) and DHCP options 
Manually, using either the Netsh tool or the properties of the Internet Protocol Version 4 (TCP/IPv4) or 
Internet Protocol (TCP/IP) component in Network Connections. 
Automatically, for Point-to-Point Protocol (PPP) connections. 
To determine the IPv4 addresses of the WINS servers that are assigned to the connections of your 
computer running Windows Server 2003 or Windows XP, do one of the following: 
Use the ipconfig /all command. 
Use the netsh interface ip show wins command. 
Open the Network Connections folder, right-click a connection, and click Status. Click the Support tab, 
and then click Details. 
DHCP Configuration of a WINS Client 
You can assign WINS servers to DHCP clients by configuring the WINS/NBNS Servers DHCP option 
(option 44) on your DHCP server. If WINS servers are manually configured in the properties of the 
Internet Protocol Version 4 (TCP/IPv4) or Internet Protocol (TCP/IP) component, the WINS client 
ignores the DHCP-based WINS server settings.  
WINS clients running Windows Server 2003 or Windows XP automatically use the H-node NetBIOS 
node type when it is assigned IPv4 addresses of WINS servers. Because of this behavior, you do not 
also need to configure the 046 WINS/NBT Node Type DHCP option (option 46) with a value of 0x8 (H-
node) on your DHCP server. 
Manual Configuration of the WINS Client Using Network Connections 
To manually configure the WINS client using Network Connections, you must obtain properties of the 
Internet Protocol Version 4 (TCP/IPv4) or Internet Protocol (TCP/IP) component for your LAN 
connection. You can then manually configure the IPv4 addresses of WINS servers in two ways: 