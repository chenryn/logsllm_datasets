single initial TTL per ampliﬁer.
Worse, an attacker may try to provoke a false attribution
result. Luckily, though, it is virtually impossible for an at-
Figure 10: TTL distance thresholds (y-axis) depend-
ing on the receiver set sizes (x-axis)
average TTL value measured at a honeypot. Moreover, to
stay consistent with the parameters of our Atlas-based mea-
surements, we also limited the analysis to attacks that took
place within 24 hours before or after a scan. Although this
might sound like a strict limit, it excludes only six out of
the 286 scanners (2%) we identiﬁed.
Under the assumption that the true distribution of scan
and attack infrastructure is somewhat similar to the distri-
bution of our Atlas probes1, the thresholds found in the pre-
vious section are still applicable here. Using those thresholds
we ﬁnd that with conﬁdence of 95% or more, 44 of the 286
scanners are presumably also launching attacks, 34 of them
even with a conﬁdence of 98% or higher. Furthermore, since
these 34 scanners have been found responsible for 293,478
of the attacks with a conﬁdence of 99.9% or higher, we con-
clude that our methodology successfully uncovered the true
attack infrastructure behind over a third of the attacks for
which we could ﬁnd a scanner with 99.9% conﬁdence, which
equates to a ﬁfth of all attacks observed at our honeypots.
7. DISCUSSION
Our novel methodologies help to identify infrastructures of
current state-of-the-art attacks, which is signiﬁcant progress
in terms of ﬁnding the origin of ampliﬁcation attacks. Hav-
ing said this, we will now discuss some of the assumptions of
our methodology and discuss how adversaries might be able
to evade our attribution process in the future.
1The Atlas probes were chosen at random from a globally-
distributed set of systems. Lacking any ground truth on
true attack sources, we had no sound methodology to further
verify or invalidate this assumption.
0.51.02.04.08.0threshold0.0%20.0%40.0%60.0%80.0%100.0%ratereceiversetsize=70.51.02.04.08.0thresholdreceiversetsize=90.51.02.04.08.0thresholdreceiversetsize=11TPRmax(FPR)avg(FPR)567891011#honeypots012345678distancethresholdconf.>95%conf.>98%1435tacker to choose its initial TTL values such that we would
falsely accuse a scanner of also being an attack source, as
this would require exact knowledge of the locations of and
hop counts to all honeypots.
7.3 Honeypot-Driven Observations
Our selective response methodology assumes that attack-
ers leverage suﬃciently many ampliﬁers in an attack to allow
for the attribution process. Related studies have shown that
literally thousands of ampliﬁers are involved in attacks [29],
supporting this assumption. However, an attacker may se-
lect ampliﬁers such that only a few honeypots see any attack
traﬃc. For example, in our current deployment, an attacker
could limit the number of ampliﬁers per subnet. Note that
our methodology does not actually require that honeypots
are located in the same subnet. The same scheme could be
applied to honeypots scattered among various providers and
in disjoint subnets, mitigating this problem.
Finally, attackers could aim to identify honeypots run-
ning AmpPot by its behavior and avoid their use.
In its
current operational mode, AmpPot can be identiﬁed, as
it emulates certain protocols, usually even with a ﬁxed re-
sponse. However, as a countermeasure, one could conﬁgure
AmpPot to run in a “proxy mode” that intermediates traﬃc
between actual service implementations with ampliﬁcation
vulnerabilities (such as NTP servers). This would make the
honeypot indistinguishable from other ampliﬁers. Note that
such a stealth mode may also have implications on the rate-
limiting functionality of honeypots, as limiting the traﬃc
may potentially be another way to identify the honeypot.
8. RELATED WORK
In this section, we discuss existing works in the area of am-
pliﬁcation attacks and traceback mechanisms. We refer to
general surveys [23, 37] for an overview of DDoS in general.
Ampliﬁcation DDoS and Booter Analysis: Our work
was motivated by the research ﬁeld that discusses and mon-
itors ampliﬁcation attacks. Rossow has identiﬁed ampliﬁca-
tion vulnerabilities in 14 UDP-based protocols [26]. Since
then, several other researchers have analyzed booter ser-
vices, which are suspected to be a major source for am-
pliﬁcation attacks. For example, Santanna et al. analyzed
14 booter services and the attack types they oﬀer [29]. They
also investigated booter “infrastructures”, but focused on the
web front-ends of the booter services—which are decoupled
from the booter attack infrastructure and much easier to re-
place than the infrastructure that we aimed to trace back.
In another paper, Santanna et al. obtained and studied at-
tack logs from 15 booter services [28], revealing insights into
the distribution of attack victims and the booter website
hosters. While ﬁngerprinting the web front-end infrastruc-
tures (up to the CDN) is straightforward, we investigated
the hidden infrastructures that are used to actually per-
form ampliﬁcation attacks. Karami et al. document this
clear separation between websites and back-end servers [18].
They study the ecosystem of three booter services, show the
diﬃculty and costs for renting such back-end servers, and
analyze two “spooﬁng-friendly” hosting providers. However,
none of these studies have investigated ways to identify the
scan and attack infrastructures. In addition, our work is not
limited to booter services, and captures all attack sources.
Closest to our work, K¨uhrer et al. have developed Amp-
Pot, an ampliﬁcation honeypot that can emulate Internet
services to attract attacks. In their further analysis, the au-
thors also describe early attempts to attribute the scanners
that helped to prepare the attacks. However, their attri-
bution is limited to the scan software (e.g., Zmap [13] or
masscan), while our goal is to track the scan origin. Fur-
thermore, we have signiﬁcantly extended the AmpPot de-
sign with a novel idea of a probabilistic response scheme,
which is a fundamental enhancement to foster tracebacks.
IP Traceback: Orthogonal to our work, IP traceback
methods have been proposed to ﬁnd the origin of IP pack-
ets [17]. One approach is to analyze ﬂow telemetry collected
by routers to trace the packet origin [35, 34, 39, 19]. How-
ever, these methods follow the assumption that ISPs collect
and even share ﬂow data—an unlikely scenario in practice.
Another idea is to mark packets, i.e., record the path of
packets as metadata in each IP packet [31, 11]. A na¨ıve
packet marking implementation could add the IP address
of each router on the path to the IP packet (e.g., as an IP
header option). This additional 4B overhead per hop can
be reduced with better encoding schemes [36, 41, 15, 12,
14], by overloading unused IP header ﬁelds [31, 36, 10, 40,
7], using probabilistic packet marking schemes [31, 30, 33],
or marking only the attack traﬃc [22, 6]. If deployed on a
global scale, a combination of ampliﬁcation honeypots and
IP traceback could perfectly track the origin of spoofed traf-
ﬁc. However, the last two decades have demonstrated that
traceback mechanisms are simply not adopted by providers,
presumably as all schemes require changes to protocols or at
least to router implementations. Furthermore, our method-
ology does not require cooperation between the providers,
nor require changes to IP or router implementations.
Spooﬁng Detection: A few works tried to identify net-
works that—in general—allow for IP address spooﬁng [21,
4]. Our follow complementary goals in that we ﬁnd network
that actually perform spooﬁng for malicious purposes, and
we propose ﬁrst steps to attribute attacks back to networks.
9. CONCLUSION
Our novel methodology links scan infrastructures to am-
pliﬁcation attacks, which is a major breakthrough in the
process to identify the origin of ampliﬁcation attacks, one of
the major threats on the Internet. We found cases where the
scan infrastructures are also used for attacks, i.e., we could
even pinpoint the attacker down to the infrastructure that
she used to perform the attacks. We have shared our ﬁnd-
ings with law enforcement agencies (in particular, Europol
and the FBI) and a closed circle of tier-1 network providers
that use our insights on an operational basis. Our output
can be used as forensic evidence both in legal complaints
and in ways to add social pressure against spooﬁng sources.
Such pressure has led to successful interruptions of other
malicious activities in the past, such as the signiﬁcant drop
of spam volume after the McColo shutdown in 2008 [8].
Admittedly, attackers may attempt to evade some parts
of our methodology to ﬂy under the radar. We acknowledge
the possibilities for evasion, but still believe that our work is
of great help to resolve the current situation of ampliﬁcation
sources. In the long run, we will have to seek more concep-
tual solutions to the problem, such as an Internet archi-
tectures that guarantee address authenticity by design (and
thus prevent spooﬁng) [42], schemes that guarantee band-
width reservations regardless of DDoS attacks [5], or eﬀorts
to close ampliﬁcation vectors in Internet protocols [21, 9].
143610. ACKNOWLEDGEMENTS
This work was supported by the German Federal Ministry
of Education and Research (BMBF) through funding for the
Center for IT-Security, Privacy and Accountability (CISPA)
(FKZ: 16KIS0656).
11. REFERENCES
[1] GeoLite2 Free Downloadable Databases.
https://dev.maxmind.com/geoip/geoip2/geolite2/.
[2] IP to ASN mapping.
https://www.team-cymru.org/IP-ASN-mapping.html.
[3] RIPE Atlas. https://atlas.ripe.net.
[4] The Spoofer Project. http://spoofer.cmand.org.
[5] Basescu, C., Reischuk, R. M., Szalachowski, P.,
Perrig, A., Zhang, Y., Hsiao, H.-C., Kubota, A.,
and Urakawa, J. SIBRA: Scalable Internet
Bandwidth Reservation Architecture. In NDSS ’16.
[6] Belenky, A., and Ansari, N. On Deterministic
Packet Marking. Comput. Netw. 51, 10 (2007).
[7] Chen, R., Park, J.-M., and Marchany, R. A
Divide-and-Conquer Strategy for Thwarting
Distributed Denial-of-Service Attacks. Parallel and
Distributed Systems, IEEE Transactions on 18, 5
(May 2007), 577–588.
[8] Clayton, R. How Much Did Shutting Down McColo
Help? CEAS ’09 .
[9] Czyz, J., Kallitsis, M., Gharaibeh, M.,
Papadopoulos, C., Bailey, M., and Karir, M.
Taming the 800 Pound Gorilla: The Rise and Decline
of NTP DDoS Attacks. In ACM IMC ’14.
[10] Dean, D., Franklin, M. K., and Stubblefield, A.
An Algebraic Approach to IP traceback. ACM Trans.
Inf. Syst. Secur. 5, 2 (2002).
[11] Doeppner, T. W., Klein, P. N., and Koyfman, A.
Using Router Stamping to Identify the Source of IP
Packets. In ACM CCS ’00.
[12] Dong, Q., Adler, M., Banerjee, S., and Hirata,
K. Eﬃcient Probabilistic Packet Marking. In IEEE
ICNP ’05.
[13] Durumeric, Z., Wustrow, E., and Halderman,
J. A. ZMap: Fast Internet-wide scanning and its
security applications. In USENIX Sec ’13.
[14] Duwairi, B., Chakrabarti, A., and Manimaran,
G. An Eﬃcient Probabilistic Packet Marking Scheme
for IP Traceback, 2004.
[15] Gao, Z., and Ansari, N. A Practical and Robust
Inter-domain Marking Scheme for IP Traceback.
Computer Networks 51, 3 (2007).
[16] Graham, R. D. Masscan: Mass ip port scanner.
https:// github.com/ robertdavidgraham/ masscan
(2014).
[17] John, A., and Sivakumar, T. DDoS: Survey of
Traceback Methods. International Journal of Recent
Trends in Engineering 1, 2 (2009).
[18] Karami, M., Park, Y., and McCoy, D. Stress
Testing the Booters: Understanding and Undermining
the Business of DDoS Services. In ACM WWW ’16.
[19] Korkmaz, T., Gong, C., Sara ˜A˘g, K., and Dykes,
S. G. Single Packet IP Traceback in AS-level Partial
Deployment Scenario. IJSN (2007), 95–108.
[20] Kr¨amer, L., Krupp, J., Makita, D., Nishizoe, T.,
Koide, T., Yoshioka, K., and Rossow, C.
Amppot: Monitoring and defending against
ampliﬁcation ddos attacks. In RAID ’15.
[21] K¨uhrer, M., Hupperich, T., Rossow, C., and
Holz, T. Exit from Hell? Reducing the Impact of
Ampliﬁcation DDoS Attacks. In USENIX Sec ’14.
[22] Li, Y., Wang, Q., Yang, F., and Su, S. Traceback
DRDoS Attacks. Journal of Information &
Computational Science 8 (2011).
[23] Mirkovic, J., and Reiher, P. A Taxonomy of DDoS
Attack and DDoS Defense Mechanisms. ACM
SIGCOMM Comput. Commun. Rev. 34, 2 (2004).
[24] P. Ferguson, D. Senie. BCP 38 on Network Ingress
Filtering: Defeating Denial of Service Attacks which
employ IP Source Address Spooﬁng.
http://tools.ietf.org/html/bcp38, 2000.
[25] Prince, M. The DDoS That Almost Broke the
Internet. https://blog.cloudﬂare.com/
the-ddos-that-almost-broke-the-internet/, 2013.
[26] Rossow, C. Ampliﬁcation Hell: Revisiting Network
Protocols for DDoS Abuse. In NDSS ’14 (2014).
[27] Salvatore Sanfilippo. New TCP Scan Method.
http://seclists.org/bugtraq/1998/Dec/79.
[28] Santanna, J., Durban, R., Sperotto, A., and
Pras, A. Inside Booters: An Analysis on Operational
Databases. In IFIP/IEEE IM ’15 (2015).
[29] Santanna, J. J., van Rijswijk-Deij, R., Hofstede,
R., Sperotto, A., Wierbosch, M., Granville,
L. Z., and Pras, A. Booters - An Analysis of
DDoS-As-a-Service Attacks. In IFIP/IEEE IM ’15.
[30] Savage, S., Wetherall, D., Karlin, A., and
Anderson, T. Network Support for IP Traceback.
IEEE/ACM Trans. Netw. 9, 3 (2001).
[31] Savage, S., Wetherall, D., Karlin, A. R., and
Anderson, T. E. Practical Network Support for IP
Traceback. In ACM SIGCOMM ’00.
[32] Schwarz, M. J. DDoS Attack Hits 400 Gbit/s,
Breaks Record.
http://www.darkreading.com/attacks-and-breaches/
ddos-attack-hits-400-gbit-s-breaks-record/d/d-id/
1113787, 2014.
[33] Shokri, R., Varshovi, A., Mohammadi, H., and
Yazdani, N. DDPM: Dynamic Deterministic Packet
Marking for IP Traceback. In IEEE ICON ’06, vol. 2.
[34] Snoeren, A. C., Partridge, C., Sanchez, L. A.,
Jones, C. E., Tchakountio, F., Kent, S. T., and
Strayer, W. T. Hash-based IP Traceback. ACM
SIGCOMM Comput. Commun. Rev. 31, 4 (2001).
[35] Snoeren, A. C., Partridge, C., Sanchez, L. A.,
Jones, C. E., Tchakountio, F., Schwartz, B.,
Kent, S. T., and Strayer, W. T. Single-packet IP
traceback. IEEE/ACM Trans. Netw. 10, 6 (2002).
[36] Song, D. X., and Perrig, A. Advanced and
Authenticated Marking Schemes for IP Traceback. In
Proc. of IEEE INFOCOM (2001), vol. 2.
[37] Specht, S. M., and Lee, R. B. Distributed Denial of
Service: Taxonomies of Attacks, Tools and
Countermeasures. In International Workshop on
Security in Parallel and Distributed Systems (2004).
[38] Stadje, W. The collector’s problem with group
drawings. Advances in Applied Probability 22, 4 (1990).
[39] Sung, M., Xu, J., Li, J., and Li, L. Large-scale IP
Traceback in High-speed Internet: Practical
Techniques and Information-theoretic Foundation.
IEEE/ACM Trans. Netw. 16, 6 (2008).
[40] Yaar, A., Perrig, A., and Song, D. StackPi: New
Packet Marking and Filtering Mechanisms for DDoS
and IP Spooﬁng Defense. IEEE Journal on Selected
Areas in Communications 24, 10 (2006).
[41] Yaar, A., Perrig, A., and Song, D. X. Pi: A Path
Identiﬁcation Mechanism to Defend against DDoS
Attack. In IEEE S&P ’03.
[42] Zhang, X., Hsiao, H.-C., Hasker, G., Chan, H.,
Perrig, A., and Andersen, D. G. SCION:
Scalability, Control, and Isolation on Next-Generation
Networks. In IEEE S&P ’11.
1437