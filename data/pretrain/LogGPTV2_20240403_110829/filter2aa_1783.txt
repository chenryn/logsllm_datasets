TenProtect))Conficential,)Copyright)@Tencent,)2019)
游戏安全的攻防艺术 
PI:EMAIL)
2019.02)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
个⼈人简介 
•  2013⾄至今，腾讯游戏业务安全部技术专家)
•  2005-2012，趋势科技架构师)
•  2005-2008,))开发和设计)PE病毒沙箱)
•  2008-2012,)开发和设计脚本漏漏洞洞分析引擎)
•  2013)to)now,)开发和设计游戏安全通⽤用⽅方案)
•  2011.8)Defcon讲演 “Chinese)phishing)at)Defcon19”,)Las)Vegas 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
1.)外挂是什什么 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
多少秒扫雷雷能够完成 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
CrossFire透视外挂 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
注:"为了了适应⼿手游屏幕特点，⼿手游上的外挂增加了了射线 
CrossFire)⼿手游透视外挂 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
外挂的发展史 
•  单机游戏，CheatEngine/FPE)
•  ⽹网络游戏)
– 脱机挂 (WPE/WireShark))
– 加速/倍攻 (数值异常))
– 透视/⾃自瞄 )(Hook,)驱动))
– 炸房/强登)
•  打⾦金金⼯工作室/代充/代练)
•  ⼿手游模拟器器 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
⽬目前中国的外挂⾏行行业运作模式 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
中国⽹网游作弊⽤用户分布 
•  越热⻔门的游戏作弊越多)
•  ⼀一些作弊软件卖的很贵)
•  绝⼤大作弊者都是新进玩家)
•  60%)作弊发⽣生在⽹网吧)
•  由于PUBG的影响，fps作弊
现在⾮非常流⾏行行)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
FPS游戏作弊的爆发 
• PUBG)
•  在2108年年，超过2700款外挂被监控到)
•  ⾼高峰期每天超过100款外挂进⾏行行更更新)
• FPS)
•  2018年年⼤大约有60款以上的FPS⽣生存游戏 
•  所有的游戏都发现有外挂的存在))
• APEX)
•  ⾃自02-05发布以来，72⼩小时超过1000万玩家)
•  已经发现超过60外挂在售卖)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
⽉月⼊入宝⻢马不不是梦 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
2.)外挂技术原理理的讨论 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
安全领域的⼤大讨论 
•  软件漏漏洞洞)
–  游戏bug，复制⾦金金币)
–  客户端逻辑没有服务器器验证)
–  盗版问题)
•  ⽹网络安全)
–  报⽂文篡改)
–  DDOS攻击)
•  服务器器、数据安全)
–  服务器器⼊入侵)
–  SQL注⼊入/回档)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
暗⿊黑3漏漏洞洞)-)⾦金金币复制 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
内存修改型 
•  游戏对象属性 
– ⾎血量量，攻击⼒力力，怪物等等 
•  修改或调⽤用游戏逻辑 
– 碰撞检测，⾃自动瞄准 
•  游戏资源⽂文件 
– ⼿手游/弱联⽹网 
– 本地效果 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
LOL)改模型 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
堡垒之夜/⼈人物透视 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
脱机挂/协议模拟 
•  端游)
– UnReal)Engine(开源))
– 外挂⼯工作室)
•  ⻚页游)
– Fiddle)
•  ⼿手游 )
– 离线)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
针对腾讯游戏的DDOS 
•  LOL:))
– 当对局要输时DDOS导致服务端崩溃)
•  QQCart:))
– 海海量量数据包导致安全包解析失败)
•  灰⾊色产业:))
– 中⼩小⼚厂商相互攻击)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
模拟按键 
•  技术点)
–  SendMessage/SendInput/KdbClass)
–  图像识别)
–  简单的状态机/深度学习AI)
•  ⽤用途)
–  ⾃自动瞄准/⾃自动开枪)
–  挂机脚本)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
同步器器硬件)
dnf⼯工作室 
注:)可以在淘宝上买到 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
3.)游戏保护与安全对抗 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
游戏安全的特殊性 
•  玩家)
–  要求打击)
–  侥幸⼼心理理/协助外挂)
•  游戏开发运营)
–  KPI考核，活跃和营收)
•  ⼯工作室)
–  靠量量取胜)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
外挂对抗之产品侧 
•  举报)
– 视频举报)
– 恶意挂机)
•  处罚⼿手段)
– 封号/封禁机器器)
– 踢⼈人)
– 限制收益)
– 禁闭、禁⾔言)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
外挂对抗之技术侧 
•  通⽤用检测)
– 基础保护)
– 样本 )
– 举例例:)EAC()Easy)Anti-Cheat),)BattleEye)(at)PUBG))))))))))))           )
•  ⾏行行为检测)
– 收益)
– 伤害)
– 坐标)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
基础保护 
•  反调试/加壳/代码混淆)
– VMP)
•  完整性检测)
•  驱动)
– 基于VT的保护（腾讯）)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
基于样本的保护 
•  样本收集渠道 
– 量量少 
•  分析系统的容量量 
– 依赖⼈人⼯工 
•  样本⾃自身的加密变形 
– 特征难于提取 
•  外⽹网特征运营的安全性 
– ⻛风险不不可控 
可疑样本 
收集 
外挂识别 
特征提取 
⽩白名单   
测试 
对抗监控 
特征发布 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
基于⾏行行为的保护 
•  游戏数据)
– 通关时间/⼈人物属性)
– 坐标)
)
•  数据挖掘)
– 修改点，样本)
– 历史战绩)
TenProtect))Conficential,)Copyright)@Tencent,)2019)
LOL)⼯工作室 
•  LOL坐标)
•  CNN)
– 160*160,)ResNet)
•  LSTM)坐标序列列 
TenProtect))Conficential,)Copyright)@Tencent,)2019)
图像识别检测透视 
TenProtect))Conficential,)Copyright)@Tencent,)2019)?
gslab.qq.com