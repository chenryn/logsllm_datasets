视频演⽰示: Reset
视频演⽰示: Relay
但是 …
短接 Reset 键, 回复到默认设置. 但是容易暴露.
短接 Relay 键, ⼏几乎毫⽆无痕迹. 但是通常需要多⼈人配合.
每次都需卸螺丝 —> 短接 Reset 键 —> 恢复原样 (过程繁琐)
好戏才刚刚开始 …
RTFM .. 
经典 EEPROM 24C02, 存储⽤用户密码 (l2C 协议)
使⽤用 em78p156e 作为系统微处理器
I2C 仅需 2条总线⽤用于交互数据: SCL (时钟频率)  + SDA (数据总线)
⼯工欲善其事, 必先利其器 (BusPirate)
⽀支持 Windows / Linux / Mac 
⽀支持 I2C / SPI / UART / 1-Wire / JTAG
拥有丰富的帮助⽂文档. 嵌⼊入式研究必备神器！
The Hack 
密码输⼊入流程: 起始码 (0) + 正确密码 + 结束确认(#)
结束确认(#)后, 处理器向 EEPROM 验证正确密码请求
EEPROM 发送正确密码, 以便处理器查证密码 (Plain-Text ⽆无加密)
 开锁@物联⺴⽹网时代 I
某编辑对智能锁的评价 …
 智能锁— August
August 智能锁可以通过蓝⽛牙, 及移设备上的App来管理房⻔门的开关
房⼦子主⼈人也可以通过⺴⽹网络, 对房客设置临时访问权限 (朋友; ⽗父⺟母; ⽔水电⼯工?)
August 智能锁安装简单⽅方便, 对已有⻔门锁本⾝身⽆无需过多改动
August 隐患1: 明⽂文密钥
分析其⼿手机APP发现使⽤用的是AES-ECB的⽅方式对本地配置⽂文件进⾏行加密
AES密钥则是明⽂文存储在程序当中: ⼿手机号, ⽤用户 E-mail, 锁 UUID (32bits hex)
August 隐患2:  明⽂文 log ⽂文件
. 可以对房客(UserID)设置临时访问权限, 但没有验证机制
. 仅需要提供正确的 锁UUID; UserID 便可得到临时的访问权限
. ⽽而这⼀一切都以明⽂文的形式存储在⼿手机APP 的本地 log ⽂文件当中.
. 锁UUID 可以通过⼿手机APP 扫描附近的August ⻔门锁获得
  已被⼚厂家打了补丁…..  :(
 智能锁⺴⽹网关 — WinkHub
. 物联⺴⽹网设备的All IN ONE 神器 WinkHub (ARM CPU; RAM; NAND)
. 同时⽀支持 WIFI/Bluetooth/Zigbee (2.4G); 915Mhz (Zwave); 433Mhz (RF)
. 完美的将不同产品以不同的⽅方式连接在⼀一起 (GE; Nest; Dropcam; Philips)
Debug 接⼝口 — UART 
. 使⽤用标准连接配置 (8 data bits, no parity bits and 1 stop bit)
. 波特率参数需要额外设置: 300; 9600; 115200 还是 230400 ?  
. 可使⽤用 Bus-Pirate 或者 Shikra (传输速度快) 作为设备间的串⼝口连接器
. 确定未知串⾏行设备波特率程序 (https://code.google.com/p/baudrate/)
Got ROOT? Command Execution 
WinkHub ⺴⽹网关可以通过⺴⽹网⻚页的形式对其进⾏行访问 (set_dev_value.php)
curl “192.168.01/set_dev_value.php” -d “nodeId=a&attrId=; uname -a;”
  已被⼚厂家打了补丁…..  :(
 边信道 101
不直接对⺫⽬目标(算法)进⾏行攻击, ⽽而通过测量⾳音频,热量,电压等⽅方式获取密码
可通过错误注⼊入(Glitch) 的⽅方式来打乱程序的正常流程, 从⽽而绕过密码检测
错误注⼊入(Glitch) 具有结果难于预测特性 (激光,电压,时钟频率).
 边信道 — NAND Glitch
NAND Glitch 通过在正确的时间点, 阻⽌止 bootloader 读取正确的数据地址. 从
⽽而得到root shell. 
仅仅需要在正确的时间点, 将数据出⼝口 I/0 pin 同GND 短接 …
正确的时间点
NAND Glitch 可打乱系统正常流程, 但何时开始 & 何时停⽌止呢？
错误时间点的意外收获....
 开锁@物联⺴⽹网时代 II
任何提供安全防护的设备, 都可以理解为锁体系的分⽀支
物理安全防护分⽀支
. 传统物理安全的器件包罗万象, 缆线绑带, 密封贴条 ..
. 通常和⻔门锁⼀一起出现的监视器, 警报器，⻔门磁等等 ..
绕过缆线绑带 - Shim
. 可使⽤用可乐罐, ⼩小铁⽚片, 甚⾄至⼩小针, 打开所谓卡死的缆线绑带
绕过密封贴条 - 丙酮
. ⽆无⾊色透明液体, 能溶解油, 树脂, 橡胶. 经常⽤用于擦洗塑胶污垢
通过 ZoomEye 可以发现不少暴露在公⺴⽹网的⽤用于安防的系统设备.
熟练使⽤用ZoomEye 或 Shodan 这类搜索引擎, 可使研究⼯工作事半功倍.
听说贡献 dorks 有免费 T-Shirt ;)
通过 Zmap 或 Masscan 进⾏行全⺴⽹网段扫描. 给所有 IPv4 来个体检. 
在条件允许的情况下, 完成扫描全⺴⽹网是分分钟的事. 所有设备都将⽆无所遁形. 
 暴露在公⺴⽹网的安防设备
强⼤大的钟馗之眼 — Envisalink
默认密码隐患
但默认⽤用户&密码却被忽略了!!！
EnvisaLink 是具有TCP/IP功能的模块. ⽤用户可
通过⺴⽹网⻚页, ⼿手机来控制警报系统. 
(user: user)
强⼤大的钟馗之眼 — P372
默认配置隐患
ANPR: 北美⻋车牌监控⾃自动识别系统.
⽀支持 Web, Telnet, FTP 等对其远程控制.
貌似再不⽤用担⼼心闯红灯了!? 安全第⼀一 !!!
强⼤大的钟馗之眼 — Echelon PLC
可通过 Ethernet 管控楼宇间⻔门禁, 照明, 排⽓气等系统  
⾃自带 WEB-Server 和⼈人尽皆知的默认⽤用户名&密码  (ilon)
推荐检查清单列表 ics.zoomeye.org  (i.LON 600, i.LON SmartServer)
视频演⽰示: Echelon PLC
强⼤大的钟馗之眼 — S2 NetBox
默认密码隐患
S2 NetBox 默认⽤用户&密码 admin /admin & IEIeMerge/eMerge
S2 NetBox ⻔门禁控制器默认开放端⼝口 WEB(80)
强⼤大的SHODAN — HID ⻔门禁控制器 
默认密码隐患
HID ⻔门禁控制器默认开放端⼝口 FTP(21), TELNET(23), WEB(80)
HID ⻔门禁控制器默认⽤用户&密码 root / pass
全⺴⽹网扫描 — Masscan
全⺴⽹网的 IPv4 地址有 40 亿之多 (4294967295). 包括 Class D, 某些特殊⺴⽹网段.
采⽤用⽆无状态连接, IP 地址分组扫描.  在软硬件环境允许情况下, 3 分钟扫完全⺴⽹网.
Masscan 号称世界上最快的扫描软件. 需要根据实际⺴⽹网速控制发包率 (DoS ⾃自⼰己?) 
https://github.com/robertdavidgraham/masscan
Masscan 案例 — VNC 5900
⺫⽬目前有多少 VNC 远程连接时是不需要密码认证,⽽而直接登陆呢？ 
通过 VNC 服务可以直接远程对主机或服务器进⾏行监控和操作 
masscan  0.0.0.0/0 —exclude 255.255.255.255 -p 5900 
nmap —script openvnc.nse -n -Pn -iL vnc.txt -p 5900 > /dev/null 
VNC 5900 — 图例
VNC 5900 — 图例
VNC 5900 — 图例
VNC 5900 — 图例
VNC 5900 — 图例
VNC 5900 — 图例
总结：
@KEVIN2600
Kein System ist Sicher：100% 安全的系统并不存在.
⽆无论多么完美的加密算法,实施过程中的百密⼀一疏，就会导
致系统的安全性完全崩溃. 
物理安全不能仅仅寄希望于某套⻔门锁来实现，⽽而是需要⼀一
套完整的安全系统. 如⻔门禁, 警报器等相互配合.