### ESP 定律法要点
ESP定律的原理在于利用程序中堆栈平衡来快速找到OEP.
由于在程序自解密或者自解压过程中, 不少壳会先将当前寄存器状态压栈, 如使用`pushad`, 在解压结束后, 会将之前的寄存器值出栈, 如使用`popad`. 因此在寄存器出栈时, 往往程序代码被恢复, 此时硬件断点触发. 然后在程序当前位置, 只需要少许单步操作, 就很容易到达正确的OEP位置.
1. 程序刚载入开始pushad/pushfd
2. 将全部寄存器压栈后就设对ESP寄存器设硬件断点
3. 运行程序, 触发断点
4. 删除硬件断点开始分析