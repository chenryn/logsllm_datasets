dsniff and arpspoof 193
[ iii ]
www.it-ebooks.info
Table of Contents
Ettercap 196
Driftnet 198
SQL Injection 200
sqlmap 203
Cross-site scripting (XSS) 204
Testing cross-site scripting 205
XSS cookie stealing / Authentication hijacking 206
Other tools 208
urlsnarf 208
acccheck 209
hexinject 209
Patator 210
DBPwAudit 210
Summary 210
Chapter 6: Web Attacks 211
Browser Exploitation Framework – BeEF 211
FoxyProxy – Firefox plugin 216
BURP Proxy 218
OWASP – ZAP 225
SET password harvesting 230
Fimap 234
Denial of Services (DoS) 235
THC-SSL-DOS 236
Scapy 238
Slowloris 240
Low Orbit Ion Cannon 242
Other tools 245
DNSCHEF 245
SniffJoke 246
Siege 247
Inundator 248
TCPReplay 248
Summary 249
Chapter 7: Defensive Countermeasures 251
Testing your defenses 252
Baseline security 253
STIG 254
Patch management 254
Password policies 256
[ iv ]
www.it-ebooks.info
Table of Contents
Mirror your environment 257
HTTrack 257
Other cloning tools 259
Man-in-the-middle defense 259
SSL strip defense 261
Denial of Service defense 262
Cookie defense 263
Clickjacking defense 264
Digital forensics 265
Kali Forensics Boot 266
Filesystem analysis with Kali 267
dc3dd 269
Other forensics tools in Kali 271
chkrootkit 271
Autopsy 271
Binwalk 274
pdf-parser 275
Foremost 275
Pasco 275
Scalpel 276
bulk_extractor 276
Summary 276
Chapter 8: Penetration Test Executive Report 277
Compliance 278
Industry standards 279
Professional services 280
Documentation 282
Report format 282
Cover page 283
Confidentiality statement 283
Document control 284
Timeline 284
Executive summary 285
Methodology 286
Detailed testing procedures 288
Summary of findings 289
Vulnerabilities 290
Network considerations and recommendations 292
Appendices 294
Glossary 294
[ v ]
www.it-ebooks.info
Table of Contents
Statement of Work (SOW) 295
External Penetration Testing 296
Additional SOW material 298
Kali reporting tools 300
Dradis 300
KeepNote 301
Maltego CaseFile 301
MagicTree 301
CutyCapt 302
Sample reports 302
Summary 311
Index 313
[ vi ]
www.it-ebooks.info
Preface
Kali is a Debian Linux based Penetration Testing arsenal used by security
professionals (and others) to perform security assessments. Kali offers a
range of toolsets customized for identifying and exploiting vulnerabilities in
systems. This book is written leveraging tools available in Kali Linux released
March 13th, 2013 as well as other open source applications.
Web Penetration Testing with Kali Linux is designed to be a guide for professional
Penetration Testers looking to include Kali in a web application penetration
engagement. Our goal is to identify the best Kali tool(s) for a specific assignment,
provide details on using the application(s), and offer examples of what information
could be obtained for reporting purposes based on expert field experience. Kali has
various programs and utilities; however, this book will focus on the strongest tool(s)
for a specific task at the time of publishing.
The chapters in this book are divided into tasks used in real world web application
Penetration Testing. Chapter 1, Penetration Testing and Setup, provides an overview
of Penetration Testing basic concepts, professional service strategies, background
on the Kali Linux environment, and setting up Kali for topics presented in this book.
Chapters 2-6, cover various web application Penetration Testing concepts including
configuration and reporting examples designed to highlight if topics covered can
accomplish your desired objective.
Chapter 7, Defensive Countermeasures, serves as a remediation source on systems
vulnerable to attacks presented in previous chapters. Chapter 8, Penetration Test
Executive Report, offers reporting best practices and samples that can serve as
templates for building executive level reports. The purpose of designing the book in
this fashion is to give the reader a guide for engaging a web application penetration
with the best possible tool(s) available in Kali, offer steps to remediate a vulnerability
and provide how data captured could be presented in a professional manner.
www.it-ebooks.info
Preface
What this book covers
Chapter 1, Penetration Testing and Setup, covers fundamentals of building a
professional Penetration Testing practice. Topics include differentiating a
Penetration Test from other services, methodology overview, and targeting
web applications. This chapter also provides steps used to set up a Kali
Linux environment for tasks covered in this book.
Chapter 2, Reconnaissance, provides various ways to gather information about a
target. Topics include highlighting popular free tools available on the Internet as
well as Information Gathering utilities available in Kali Linux.
Chapter 3, Server Side Attacks, focuses on identifying and exploiting vulnerabilities
in web servers and applications. Tools covered are available in Kali or other open
source utilities.
Chapter 4, Client Side Attacks, targets hosts systems. Topics include social engineering,
exploiting host system vulnerabilities, and attacking passwords, as they are the most
common means to secure host systems.
Chapter 5, Attacking Authentication, looks at how users and devices authenticate to web
applications. Topics include targeting the process of managing authentication sessions,
compromising how data is stored on host systems, and man-in-the-middle attack
techniques. This chapter also briefly touches on SQL and Cross-Site Scripting attacks.
Chapter 6, Web Attacks, explores how to take advantage of web servers and
compromise web applications using exploits such as browser exploitation, proxy
attacks, and password harvesting. This chapter also covers methods to interrupt
services using denial of service techniques.
Chapter 7, Defensive Countermeasures, provides best practices for hardening your
web applications and servers. Topics include security baselines, patch management,
password policies, and defending against attack methods covered in previous
chapters. This chapter also includes a focused forensics section, as it is important
to properly investigate a compromised asset to avoid additional negative impact.
Chapter 8, Penetration Test Executive Report, covers best practices for developing
professional post Penetration Testing service reports. Topics include an overview
of methods to add value to your deliverable, document formatting, and templates
that can be used to build professional reports.
[ 2 ]
www.it-ebooks.info
Preface
What you need for this book
Readers should have a basic understanding of web applications, networking
concepts, and Penetration Testing methodology. This book will include detailed
examples of how to execute an attack using tools offered in Kali Linux as well as
other open source applications. It is not required but beneficial to have experience
using previous versions of Backtrack or similar programs.
Hardware requirements for building a lab environment and setting up the Kali
Linux arsenal are covered in Chapter 1, Penetration Testing and Setup.
Who this book is for
The target audience for this book are professional Penetration Testers or others
looking to maximize Kali Linux for a web server or application Penetration Testing
exercise. If you are looking to identify how to perform a Penetration Test against
web applications and present findings to a customer is a professional manner then
this book is for you.
Conventions
In this book, you will find a number of styles of text that distinguish between
different kinds of information. Here are some examples of these styles, and an
explanation of their meaning.
Code words in text are shown as follows: " For example, you can call the profile
My First Scan or anything else you would like."
A block of code is set as follows:
document.write("")
Any command-line input or output is written as follows:
sqlmap -u http://www.drchaous.com/article.php?id=5 -T tablesnamehere -U
test --dump
-U test –dump
[ 3 ]
www.it-ebooks.info
Preface
New terms and important words are shown in bold. Words that you see on the
screen, in menus or dialog boxes for example, appear in the text like this: "Soon
as we click on the Execute button, we receive a SQL injection".
Warnings or important notes appear in a box like this.
Tips and tricks appear like this.
Reader feedback
Feedback from our readers is always welcome. Let us know what you think about
this book—what you liked or may have disliked. Reader feedback is important for
us to develop titles that you really get the most out of.
To send us general feedback, simply send an e-mail to PI:EMAIL,
and mention the book title via the subject of your message.
If there is a topic that you have expertise in and you are interested in either writing
or contributing to a book, see our author guide on www.packtpub.com/authors.
Customer support
Now that you are the proud owner of a Packt book, we have a number of things to
help you to get the most from your purchase.
Errata
Although we have taken every care to ensure the accuracy of our content, mistakes
do happen. If you find a mistake in one of our books—maybe a mistake in the text or
the code—we would be grateful if you would report this to us. By doing so, you can
save other readers from frustration and help us improve subsequent versions of this
book. If you find any errata, please report them by visiting http://www.packtpub.
com/submit-errata, selecting your book, clicking on the errata submission form link,
and entering the details of your errata. Once your errata are verified, your submission
will be accepted and the errata will be uploaded on our website, or added to any list of
existing errata, under the Errata section of that title. Any existing errata can be viewed
by selecting your title from http://www.packtpub.com/support.
[ 4 ]
www.it-ebooks.info
Preface
Piracy
Piracy of copyright material on the Internet is an ongoing problem across all media.
At Packt, we take the protection of our copyright and licenses very seriously. If you
come across any illegal copies of our works, in any form, on the Internet, please
provide us with the location address or website name immediately so that we can
pursue a remedy.
Please contact us at PI:EMAIL with a link to the suspected
pirated material.
We appreciate your help in protecting our authors, and our ability to bring
you valuable content.
Questions
You can contact us at PI:EMAIL if you are having a problem
with any aspect of the book, and we will do our best to address it.
[ 5 ]
www.it-ebooks.info
www.it-ebooks.info
Penetration Testing
and Setup
Many organizations offer security services and use terms such as security audit,
network or risk assessment, and Penetration Test with overlapping meanings.
By definition, an audit is a measurable technical assessment of a system(s) or
application(s). Security assessments are evaluations of risk, meaning services
used to identify vulnerabilities in systems, applications, and processes.
Penetration Testing goes beyond an assessment by evaluating identified
vulnerabilities to verify if the vulnerability is real or a false positive. For example,
an audit or an assessment may utilize scanning tools that provide a few hundred
possible vulnerabilities on multiple systems. A Penetration Test would attempt
to attack those vulnerabilities in the same manner as a malicious hacker to verify
which vulnerabilities are genuine reducing the real list of system vulnerabilities to
a handful of security weaknesses. The most effective Penetration Tests are the ones
that target a very specific system with a very specific goal. Quality over quantity is
the true test of a successful Penetration Test. Enumerating a single system during
a targeted attack reveals more about system security and response time to handle
incidents than wide spectrum attack. By carefully choosing valuable targets, a
Penetration Tester can determine the entire security infrastructure and associated
risk for a valuable asset.
Penetration Testing does not make networks more secure!
www.it-ebooks.info
Penetration Testing and Setup
This is a common misinterpretation and should be clearly explained to all potential
customers. Penetration Testing evaluates the effectiveness of existing security. If
a customer does not have strong security then they will receive little value from
Penetration Testing services. As a consultant, it is recommended that Penetration
Testing services are offered as a means to verify security for existing systems once
a customer believes they have exhausted all efforts to secure those systems and are
ready to evaluate if there are any existing gaps in securing those systems.
Positioning a proper scope of work is critical when selling Penetration Testing services.
The scope of work defines what systems and applications are being targeted as well as
what toolsets may be used to compromise vulnerabilities that are found. Best practice
is working with your customer during a design session to develop an acceptable scope
of work that doesn't impact the value of the results.
Web Penetration Testing with Kali Linux—the next generation of BackTrack—is a
hands-on guide that will provide you step-by-step methods for finding vulnerabilities
and exploiting web applications. This book will cover researching targets, identifying
and exploiting vulnerabilities in web applications as well as clients using web
application services, defending web applications against common attacks, and
building Penetration Testing deliverables for professional services practice. We
believe this book is great for anyone who is interested in learning how to become a
Penetration Tester, users who are new to Kali Linux and want to learn the features
and differences in Kali versus BackTrack, and seasoned Penetration Testers who may
need a refresher or reference on new tools and techniques.
This chapter will break down the fundamental concepts behind various security
services as well as guidelines for building a professional Penetration Testing practice.
Concepts include differentiating a Penetration Test from other services, methodology
overview, and targeting web applications. This chapter also provides a brief
overview of setting up a Kali Linux testing or real environment.
Web application Penetration Testing
concepts
A web application is any application that uses a web browser as a client. This can
be a simple message board or a very complex spreadsheet. Web applications are
popular based on ease of access to services and centralized management of a system
used by multiple parties. Requirements for accessing a web application can follow
industry web browser client standards simplifying expectations from both the
service providers as well as the hosts accessing the application.
[ 8 ]
www.it-ebooks.info
Chapter 1
Web applications are the most widely used type of applications within any
organization. They are the standard for most Internet-based applications. If you look
at smartphones and tablets, you will find that most applications on these devices
are also web applications. This has created a new and large target-rich surface for
security professionals as well as attackers exploiting those systems.
Penetration Testing web applications can vary in scope since there is a vast number
of system types and business use cases for web application services. The core web
application tiers which are hosting servers, accessing devices, and data depository
should be tested along with communication between the tiers during a web
application Penetration Testing exercise.
An example for developing a scope for a web application Penetration Test is testing
a Linux server hosting applications for mobile devices. The scope of work at a
minimum should include evaluating the Linux server (operating system, network
configuration, and so on), applications hosted from the server, how systems and
users authenticate, client devices accessing the server and communication between
all three tiers. Additional areas of evaluation that could be included in the scope of
work are how devices are obtained by employees, how devices are used outside of
accessing the application, the surrounding network(s), maintenance of the systems,
and the users of the systems. Some examples of why these other areas of scope
matter are having the Linux server compromised by permitting connection from a
mobile device infected by other means or obtaining an authorized mobile device
through social media to capture confidential information.
We have included templates for scoping a web application penetration in Chapter
8, Penetration Test Executive Report. Some deliverable examples in this chapter offer
checkbox surveys that can assist with walking a customer through possible targets