title:Cost-effective capacity provisioning in wide area networks with Shoofly
author:Rachee Singh and
Nikolaj Bjørner and
Sharon Shoham and
Yawei Yin and
John Arnold and
Jamie Gaudette
Cost-eective capacity provisioning in wide area networks with
S
Rachee Singh
Microsoft
Nikolaj Bjørner
Microsoft
Sharon Shoham
Tel Aviv
University
Yawei Yin
Microsoft
John Arnold
Microsoft
Jamie Gaudette
Microsoft
ABSTRACT
In this work we propose S, a network design tool that mini-
mizes hardware costs of provisioning long-haul capacity by optically
bypassing network hops where conversion of signals from optical
to electrical domain is unnecessary and uneconomical. S
leverages optical signal quality and trac demand telemetry from a
large commercial cloud provider to identify optical bypasses in the
cloud WAN that reduce the hardware cost of long-haul capacity by
40%. A key challenge is that optical bypasses cause signals to travel
longer distances on ber before re-generation, potentially reducing
link capacities and resilience to optical link failures. Despite these
challenges, S provisions bypass-enabled topologies that can
meet 8X the present-day demands using existing network hardware.
These topologies save 32% of the cost of long-haul capacity while
incorporating resilience to aggressive stochastic and deterministic
link failure scenarios.1
CCS CONCEPTS
• Networks ! Wide area networks; Physical links; Network
design and planning algorithms.
KEYWORDS
Optical Bypass, Backbone Design, Trac Engineering.
ACM Reference Format:
Rachee Singh, Nikolaj Bjørner, Sharon Shoham, Yawei Yin, John Arnold,
and Jamie Gaudette. 2021. Cost-eective capacity provisioning in wide area
networks with S. In ACM SIGCOMM 2021 Conference (SIGCOMM ’21),
August 23–27, 2021, Virtual Event, USA. ACM, New York, NY, USA, 13 pages.
https://doi.org/10.1145/3452296.3472895
1 INTRODUCTION
Trac demands on cloud wide area networks (WANs) are growing
rapidly, driven by new workloads like real-time video and cloud
gaming. Cloud providers respond to increase in trac demands by
provisioning additional WAN capacity. However, long-haul network
capacity is expensive – the median annual cost of 100 Gbps of long-
haul capacity is over $100,000 in N. America as per TeleGeography
(Figure 1) [32]. Fiber, routers and equipment in the optical line
1Code and experiments at http://shooy.network.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for prot or commercial advantage and that copies bear this notice and the full citation
on the rst page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specic permission
and/or a fee. Request permissions from permissions@acm.org.
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
© 2021 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 978-1-4503-8383-7/21/08...$15.00
https://doi.org/10.1145/3452296.3472895
F
D
C
1.00
0.75
0.50
0.25
0.00
Annual WAN capacity cost
250k 500k 750k 1M
($/100 Gbps)
0
t
n
e
n
o
p
m
o
C
Routers
OLS
Fiber
0
50
25
75 100
Percentage of cost (%)
Figure 1: Capacity cost.
Figure 2: Cost breakdown.
Figure 3: Optical terminals consist of wavelength selective
switches (WSS), multiplexers/demultiplexers. They connect light
channels to router ports. Transponders plugged into router ports
convert the optical signals to electrical signals.
system (OLS) [19] are the key contributors to the cost of capacity in
the cloud WAN (Figure 2). Large cloud providers have existing ber
deployments, acquired through purchase or long-term leases. Thus,
the marginal cost of provisioning capacity in the cloud is dominated
by the additional hardware resources used in the process: router
and optical ports.
Cloud providers operate point-to-point inter-regional networks –
where optical signals are converted to electrical signals and back at
every geographical region [12]. Thus, inter-regional trac under-
goes optical-to-electrical-to-optical (OEO) conversion at all inter-
mediate regions on the path towards its destination. For example,
in Figure 3, wavelength _1 originates at US-East, terminates at US-
West but undergoes an OEO conversion at US-central. Once the sig-
nals are converted from the optical to electrical domain, centralized
trac engineering systems take control of routing them [18, 20].
This design provides control and exibility at the network layer,
keeping the optical layer uncomplicated and easy to manage. How-
ever, the conventional design does not keep in view the nature
of trac demands and the corresponding trac ow imposed by
them. We analyze inter-regional trac patterns in the backbone
of a large commercial cloud provider and nd that 60% of trac
traversing through 30% of geographical regions in the WAN is pass-
ing through – neither originating nor terminating at the region. The
pass-through or transit trac undergoes wasteful OEO conversions
at all intermediate regions in point-to-point networks, occupying
scarce optical line- and router ports. These ports contribute a ma-
jority of the cost of provisioning capacity in cloud networks with
existing ber deployments (Figure 2).
534
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
X.et al., Rachee Singh, Nikolaj Bjørner, Sharon Shoham, Yawei Yin, John Arnold, and Jamie Gaudee
In this work, we propose to minimize the hardware cost of provi-
sioning long-haul capacity by removing wasteful OEO conversions
in the WAN. We refer to the elimination of an OEO conversion
at a region as optically bypassing the region e.g., wavelength _2
optically bypasses US-Central in Figure 3. Our analysis shows that
60% of the transit trac through a region is exchanged between
only two neighbors of the region – highlighting the potential of
reaping most cost savings with very few optical bypasses.
While optically bypassing regions in cloud backbone networks
can oer signicant reduction in capacity cost, it also introduces
new operational challenges. First, wavelengths of light in point-
to-point regional networks undergo regeneration at every hop,
correcting errors caused by signal attenuation and dispersion during
transmission on the ber. By optically bypassing regions, signals
are forced to travel longer ber paths before regeneration e.g., _2
in Figure 3 travels from US-East to US-West without regeneration
whereas _1 undergoes regeneration at US-Central. Longer distances
can necessitate lower data rates for error-free transmission e.g., _2
faces more attenuation than _1 since it travels a longer ber path
without regeneration and can only sustain data rates lower than
_1’s. Thus, optical bypass can lower the achievable capacity over
a channel, in turn hampering the network’s ability to meet trac
demands. Second, IP links resulting from signals that optically
bypass regions are susceptible to failure if any constituent ber link
fails. This expansion of shared risk link groups (SRLGs) can reduce
the network’s resilience to physical link failures [22].
We tackle these challenges by analyzing the optical signal quality
on ber of a commercial cloud provider and nd that the signal
quality of 75% of optical channels on ber is suciently high to
sustain transmission over longer distances. The remaining optical
channels must downgrade their data rates to traverse longer ber
paths without regeneration (§2). We leverage these empirical in-
sights to make the following key contributions towards the design
of a bypass-enabled cloud backbone with resilience to link failures:
Optimal optical bypass in cloud WANs. We develop S,
an optical backbone design tool that formulates the problem of
identifying optical bypass opportunities in a cloud network with
the goal of minimizing the hardware costs of long-haul capacity.
S-proposed backbone topology can reduce the hardware
cost of long-haul capacity by 40% while continuing to meet up
to 8X the present-day demands using existing hardware and ber
deployments (§3, §4).
Failure resilience with optical bypass. We extend S to
incorporate the goals of failure resilience while identifying bypass
opportunities in the WAN. We show that S can provision
bypass-enabled topologies resilient to both stochastic [5] and de-
terministic [25] link failures by sacricing at most 20% of hardware
cost savings (§5).
Low logistical burden of enabling optical bypass. We quan-
tify the logistical burden of provisioning the S proposed
bypasses on cloud operators. We show that the bypass-enabled
topology can keep up with demand growth over time, up to 8X the
present-day demands. Implementing bypasses requires modica-
tions to the physical connections between optical terminals and
routers. We show that a small number of such changes are needed
since 25% of optical bypasses achieve 80% of the cost savings (§??).
The design of optical networks has been well studied by service
and content providers [2, 3, 9, 16]. In contrast, cloud WANs with
centralized software-dened trac engineering present a unique
opportunity to rethink conventional backbone designs due to the
predictability [33] of intra-WAN trac in cloud networks.
Ethics Statement. This work does not raise any ethical issues.
2 QUANTIFYING THE OPPORTUNITY
Cloud providers lease or purchase optical ber across the world
to provision their WAN. This ber is connected to optical equip-
ment, namely, optical terminals and optical ampliers to transmit
optical signals over hundreds of kilometers. Signals can originate,
terminate or pass through an optical terminal. Signals that termi-
nate undergo a conversion from the optical to electrical domain.
The corresponding electrical signals are then de-multiplexed onto
ports of a router or switch. Similarly, electrical signals from router
ports are converted to optical signals and multiplexed onto wave-
lengths of light that traverse the ber. In contrast, signals can pass
through an optical terminal without originating or terminating at it.
These signals are said to optically bypass a router (e.g., US-Central
is bypassed by wavelength _2 in Figure 3).
2.1 Point-to-point regional backbones
The commercial cloud provider we study has provisioned their wide
area backbone in a point-to-point regional topology. In this design,
optical signals undergo regeneration at all regional hops. As per
conventional wisdom, this design oers two main benets:
Fine-grained control via Layer-3 trac engineering. Optical
signals are converted to the electrical domain at all regional hops
in this design, allowing the Layer-3 trac engineering algorithms
hop-by-hop autonomy to route trac to suitable next-hops. These
algorithms can leverage ne-grained, cross-layer telemetry from the
network to make on-the-y decisions that achieve network-wide
goals, e.g., minimum end-to-end latency and maximum throughput.
Flexibility to meet new demands. Since wavelengths undergo
conversion to electrical signals at every region in a point-to-point
WAN, trac from one region can be IP routed to any other region
in the network. This exibility allows the network to meet new
and emerging trac demands between regions without requiring
any changes to the optical backbone. In this design, the optical and
IP topology of the network bear close resemblance. Each optical
terminal maps to an IP router and ber connections between neigh-
boring regions underpin the IP links between the corresponding
routers (Figure 4). Enabling optical bypass can hamper the ability
of certain regions from being the origin or destination of trac. In
an extreme case, a region could be bypassed entirely by all optical
wavelengths (e.g., region B in Figure 4).
Despite the exibility and control oered by point-to-point wide
area backbones, we propose to rethink this design in the context of
trac ow patterns in the network. In this section, we demonstrate
that the nature of inter-regional trac ow enables a signicant
potential to save hardware costs of capacity provisioning in point-
to-point backbones.
535
Cost-eective capacity provisioning in wide area networks with S
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
ingress-egress region pairs will achieve most of the cost savings of
optical bypass in WANs.
While the exibility of point-to-point backbones (§2.1) is an
important feature, our analysis of an inter-regional cloud WAN
over ve months shows that the trac ow between geographical
regions of the cloud WAN is suitable for a bypass enabled design.
Despite the seasonality of demands, predictable trac engineering
algorithms have imparted stability to trac patterns – few regions
are responsible for most of the transit trac. We propose to leverage
this stability to design a cost-ecient optical backbone.
3 OPTICAL BYPASS WITH SHOOFLY
We propose to leverage insights from inter-regional trac patterns
in the WAN to enable optical bypass in the network. Our goal is to
reduce the cost of long-haul capacity by preventing wasteful OEO
conversions while using existing network hardware and software.
Cost of long-haul capacity. Large cloud providers either pur-
chase ber or acquire it through long-term leases that span decades,
making ber an infrequent capital investment. Cloud providers also
purchase optical (e.g., ampliers, terminals, transceivers) and electri-
cal equipment (e.g., routers) to provision capacity between dierent
regions of their wide-area backbone. Over time, wavelengths are lit
on the ber to meet growing trac demands. In steady state, the
cloud provider has existing ber deployments. Thus, provisioning
additional capacity requires lighting a new wavelength or signal
on the ber that originates and terminates at the target source and
destination regions. The marginal cost of provisioning the wave-
length is determined by the router and optical line ports it uses. The
combined cost of a router and optical port can be as high as tens of
thousands of dollars. In point-to-point networks, each wavelength
uses at least one router and optical line port at every intermediate
regional hop in addition to the source and destination regions.
How does bypass save cost? Optical bypass of a region by a
wavelength of light saves two router ports and up to two line ports
in an industry standard deployment of routers and optical terminals,
allowing a signicant reduction in the $/Gbps cost of long-haul
capacity. However, the ability to bypass a region is conditional on
physical constraints on the network topology and signal quality on
ber. We elaborate on these constraints in the next section.
3.1 Physical constraints on optical bypass
Optical bypass of geographical regions forces the signals to travel
longer distances on ber before they can be regenerated. Signals
traveling longer distances undergo more attenuation leading to
lower optical signal quality. Signal quality, measured through opti-
cal signal-to-noise ratio (OSNR), ultimately decides the data rate of
the optical signal – higher the OSNR, higher the signal data rate.
State-of-the-art optical transponders support three data rates per
wavelength of light: 200 Gbps, 150 Gbps and 100 Gbps by modulat-
ing the signals in 16-QAM, 8-QAM and QPSK formats respectively.
Thus, optical bypass by some wavelengths in the WAN can lower
their achievable data rates due to increased transmission distance.
In this section we explore the constraint posed by distance on po-
tential optical bypasses in the cloud network. Table 1 shows the
relationship between modulation formats, their OSNR thresholds
and data rates.
Figure 4: (1) shows the physical topology of a network with 4 op-
tical terminals (0, 1, 2, 3) and the ber between them. (2) shows the
IP layer topology of the same physical network in a point-to-point
design – each terminal maps to a router ( , ⌫, ⇠, ⇡). (3) shows the
IP layer topology of the physical network in (1) where all signals
optically bypass router B.
2.2 Wasteful OEO Conversions
We study the trac ow between geographical regions of a large
commercial cloud provider. The cloud provider has datacenters in
approximately 100 geographical regions in the world, connected
by a dedicated optical backbone. Demands between regions are
routed through a centralized software-dened trac engineering
(TE) controller [18, 20]. At a high level, the TE controller solves a k-
shortest path formulation of the multi-commodity ow problem [1].
Demands are denoted by their source and destination regions. For
every demand pair, there exist pre-computed : paths across which
ow is distributed. We measure hourly demands between regions
in the WAN and the corresponding : paths over which they are
routed from August 1, 2020 to December 31, 2020.
All trac transits at least one geographical region. For every
demand source and destination pair, we measure the fraction of traf-