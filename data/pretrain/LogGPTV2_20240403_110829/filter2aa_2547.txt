Backdooring the Frontdoor
Hacking a "perfectly secure" smart lock.
About me
●
Software Engineer by trade
●
Hacker by passion
●
Lock picker for fun
●
The best puzzles are not meant to be solved
●
Twitter: @jmaxxz
August Smart Lock
August's marketing 
team
Source: august.com (August 17th, 2015)
"Unlike physical keys which can 
be duplicated and distributed 
without your knowledge, an 
August lock..."
Source: august.com (September 14th, 2015)
"Safer than … codes that can be 
copied."
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
Mapping out the
API
WiFi | HTTPS
BLE
MitM proxy
Certificate pinning
…crap...
Solution
1.
Use iOS SSL Kill Switch
(https://github.com/iSECPartners/ios-ssl-kill-switch)
Disabling SSL/TLS 
system wide at Defcon?
Better solution
No Jailbreak
Certificate Pinned!!!
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
After mapping out api
Postman collection created (see github repo)
Not anonymized
Creepy
Let's fix this
MiTM can modify traffic
Fix
Don't forward log data to August, and tell app logs were received
What else can we do?
Guest to admin?
User Types
Guest = user
Owner = superuser
Replace "user"
with "superuser"
Guests can change lock settings!
Guests can not use Auto-Unlock
Guests can not control lock settings
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
Mapping out the
BLE API
WiFi | HTTPS
BLE
Enumerate BLE services
Intercepting BLE
Solution: Ubertooth
Better solution
Tap
Replace
Plaintext BLE traffic in log 
files!
No Jailbreak
SEC write/indicate 
1.
Communicates with TI chip
2.
Establish session key
3.
Manage lock's key store [add, delete]
MCU write/indicate 
1.
Communicates with ST chip
2.
Control lock
3.
Manage lock settings
4.
Firmware updates
Lock security model
●
BLE + Just Works pairing
●
256 offline key slots (0-255)
●
AES-128-CBC (null IV)
Key slot 0 is special
"Safer than … codes that can 
be copied."
"Unlike physical keys which can 
be duplicated and distributed 
without your knowledge, an 
August lock..."
Requesting firmware as a 
guest
This is weird
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
70F4F853E330BAEC27BF2724F39D1471
Firmware key 'can not' be 
changed
Key material in logs
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
Security claims
●
Perfectly secure
●
Guest access can be revoked at any time
●
Guest permission can be limited to a schedule
●
Guest can not
○
Use auto unlock
○
Invite or remove guests or owners
○
View activity feed
○
View Guest List
○
Change lock settings
●
Keys can not be duplicated or distributed
Don't give guest access to 
someone you would not 
give a key to.
Code on github
●
SDK for August lock
●
Postman Collection
Demo
1.
Unlock without a trace 
2.
Change Settings 
3.
Backdooring a lock 
Mistakes made
●
Mobile app logs include key material
●
Lock does not differentiate between guest and owner
●
Firmware not signed
●
No apparent way to discover backdoor keys
●
Guest users can download key material
●
Access entry log can be erased by guest users
●
Confusing two factor with two step
●
No rate limiting of password reset attempts (fixed)
●
Mobile apps include bypass for certificate pinning
●
SecureRandom not used for nonce or session key generation (fixed)
●
Key material not stored on iOS keychain
What was done correctly
●
Mobile apps attempt to use certificate pinning
●
Protocol makes use of nonces CBC
●
August has been very responsive
●
Not reliant solely on BLE's just works security model
Hackers needed
Consumers are not able to evaluate security claims made by companies
●
We need more researchers investigating security claims made by companies 
on behalf of consumers.
●
What can be asserted without evidence can be dismissed without evidence.