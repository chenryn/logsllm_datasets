G Suite, 304
PLAINTEXT oauth_signature_method, 340
Principle of psychological acceptability, 53
Principle of separation of privilege  
states, 51
Principles of least privilege, 45, 46
Profiles
chain grant type, 216–218
dynamic client registration  
profile, 220–224
token introspection (see Token 
introspection profile)
token revocation, 225, 226
Proof key for code exchange  
(PKCE), 253, 293
authorization code, 235, 236
code_challenge, 236
code_verifier, 236, 237
defined, 235
login flow, 235
Proof of possession, 247–249
Protection API, 395
Protection API token (PAT), 387
ProtectServe protocol, 377, 378
Index
446
Public Key Cryptography Standards 
(PKCS), 74
Pushed Authorization Requests  
(PAR), 99, 100
R
Recipe API, 412, 413
Reference token, 121
Referred token binding, 251
Refresh grant type, 92
Refresh token, 88
Requesting party token (RPT), 283, 285
@RequestMapping, 72
Resource owner, 331
Resource owner password credentials 
grant type, 90, 91
Resource security token service (STS), 
316–318
@RestController, 72
RFC 2617, 406, 410
RFC 7523, 267, 270
Role of APIs
Netflix, 32
SOA, 28
vs. service, 25, 26
RPT endpoint, 391
RSA-OAEP and AES
JSON payload, 203–205
non-JSON payload, 206, 207
RSA-SHA256, JSON payload, 181, 182
S
SAML grant type
brokered authentication, 265, 266
OAuth Introspection specification, 267
out of band, 266
POST message, 266
trust broker, 265
SAML 2.0 client authentication
client_assertion parameter, 264
client_assertion_type, 261
SAML assertion, 262, 263
SAML 2.0 identity provider, 309
scope, 84
Sec-Token-Binding, 248
Secure Sockets Layer (SSL), 47
Security assertion markup language 
(SAML), 98, 261
Security assertion markup language 
(SAML) 2.0, 306
Security token service (STS)
OAuth 2.0 authorization
setting up, 110–112
testing, 112–114
Zuul API Gateway, 114–116
Self-contained token, 94, 121
Service-oriented architecture (SOA), 17, 28
SFSafariViewController, 232
Simple Web Token (SWT), 158
Single-page application (SPA), 295
Single Sign-On
delegated access control, 306–308
IWA, 308
Spring-boot-starter-actuator  
dependency, 71
Spring initializer, 70
Spring tool suite (STS), 70
SYN ACK packet, 360, 361
T
TCP ACK packet, 361
TLS termination, 254, 255
Token-based authentication, 331
Index
447
Token binding, 248
key generation phase, 245
message, 248
negotiation phase, 244
OAuth 2.0 Authorization code/access 
token, 251–254
OAuth 2.0 refresh tokens, 249–251
phases, 244
proof of possession phase, 245
TLS, 244
Token Binding Protocol specification 
(RFC 8471), 248
Token Binding TLS extension, 246
token_endpoint_auth_method, 221
Token exchange
IETF working group, 217
JSON response, 220
parameters, 218, 219
Token introspection profile, 212, 226
HTTP authentication, 212
JSON response, 212
validation, 215
Token leakage/export, 296, 298
Token reuse
access token, 294
OAuth 2.0 client application, 294
OpenID Connect, 295
resource server, 294
security checks, 295
SPA, 295
Token revocation profile, 225, 226
Transmission control protocol  
(TCP), 358–363
Transport Layer Security (TLS), 35, 47, 90, 
107, 243, 406
Apache Tomcat, 420, 421
deploying order API, 71–73
directory, 70
Handshake (see Handshake protocol)
microservices development 
framework, 69
mutual authentication, 376
Netscape communications, 356–358
online resources, 70
protecting order API, 76–78
role, 355
securing order API, 74–76
spring boot, 70
TCP, 358
HTTP, 358
IP functions, 359
layers, 359, 360
SYN ACK packet, 360, 361
TCP packet, 361, 362
working
application data transfer, 374, 375
layers, 365
Trinity of trouble, 34
extensibility, 36
system design, 37
TLS, 35
Trusted master access delegation
access token, 316
centralized Active Directory, 315
SSO, 316
web applications, 315
XACML, 316
Trusted platform module (TPM), 247
U
UMA 1.0
architecture, 384
phases
authorization, getting,  
388–390, 392–394
Index
448
resources, accessing, 394
resources, protecting, 385, 387, 388
UMA 2.0, bank use case
cURL command, 280
introspection, 283
OpenID Connect, 282
PFM, 281, 282, 284
RPT, 283
UMA authorization server, 280
Uniform resource name (URN), 294
Universal 2nd Factor (U2F), 61
Universal description, discovery, and 
integration (UDDI), 23
Unmanaged API, 20
User-Managed Access (UMA)
APIs
authorization, 396
protection, 395
Protection API, 394
authorization server, 279
OAuth, 384
bank accounts, 277, 278
defined, 277
Google Doc, 278, 279
ProtectServe protocol
authorization manager, 377
consumer, 380–383
flow, 378
service provider, 377
steps, 378
roles, 279
UMA 2.0 Grant, 280
V
Validity argument, 74
Virtual private cloud (VPC), 52
W
Web application description language 
(WADL), 23
Web application firewall  
(WAF), 125, 126
Web resource authorization profiles 
(WRAP), 347
autonomous client  
profiles, 348
Assertion profile, 350
client account profile, 349
Password profile, 349
grant types, 84, 354
authorization code, 85
client credentials, 92
implicit code, 89
resource owner, 90
protected resource, 354
token types, 94, 354
Bearer token profile, 94
MAC token profile, 94
user delegation profiles, 348
Rich APP profile, 353
username and password  
profile, 350, 351
Web APP profile, 352
Web services description language 
(WSDL), 17
Web services interoperability  
(WS-I), 17
WebView, 229
WS-Trust, 262, 264
X
XACML, 64, 166
XML signature, 178
UMA 1.0 (cont.)
Index
449
Y
Yahoo! Browser–Based Authentication 
(BBAuth), 327
Z
Zero-trust network pattern, 306
Zuul API gateway, 103
cURL client, 105
enable TLS, 107–109
JWT, 124, 125
OAuth 2.0 token  
validation, 109
run, 105, 106
STS over TLS, 117–120
Index