# OCR Output
## Page 1
Nu1L Team
Handbook for
CTFers
中国工信出版集团
全子工学出装社
Springer
T
---
## Page 2
Handbook for CTFers
---
## Page 3
NulL Team
Handbookfor CTFers
Springer
国中国工信出版集团社
---
## Page 4
NulL Team
Shanghai, China
Nu1L Team
ISBN 978-981-19-0335-9
ISBN 978-981-19-0336-6 (eBook)
hbttps:/doi.org/10.1007/978-981-19-40336-6
Joimtly published with, Publishing House of Electronics Industry, Beijing. P.R.China
print book from: Publishing House of Electronics Industry.
The print edition is not for sale in China (Mainland). Customers from China (Mainland) please order the
C Publishing House of Electronics Industry 2022
This work is subject to copyright. Allrights are solely and eclusively licensed by the Publishet, whether
recitation, beoadcasting, reproduction on microfilms or in amy other physical way, and tramsmission
the whole or part of te material is concemed, specifically the rights of reprinting, reuse of ilstrations,
or infoemation storage and retrieval. electronic adaptation, compufer software, or by similar or
dissimilar methodology now known or hereafler developed.
The use of gemeral escriptive names, registered names, trademarks, service marks, etc n this publiation
does not imply even in the absence of aspecific statement, that such names are xempt from the relevant
protective laws and regulations and therefore free for general use.
a au sqsnd aq aa eqnd jo ap a e ame pue ann aq o poaaq ane pooq
The publishers, the authors, and the editors are safe to assume that the advice and infomation in this
herein or for any errors or omissions that may have been made. The publishers remain neutral with
authors or the editoes give a warranty, express or implied, with respect to the material contained
regard to jurisdictional claims in published maps and institutional affliuties.
This Springer imprint is published by the registered company Springer Nature Singapore Pte Lid.
The registered company address is: 152 Beach Road, #21-01/04 Gateway East, Singapoe 189721,
Singapore
---
## Page 5
Preface
In 2017, we had the idea of writing a book for CTF beginners, but the idea was put
on hold because of the limited number of team members at the time. By the end of
2018, our team Nu1L had grown to nearly 40 members, and the idea of writing a
book was rekindled. After asking many team members and reaching a consensus, we
started writing the book.
After preliminary discussions, we decided to incorporate as many aspects of the
CTF competition as possible, as we wanted the book to be a systematic textbook for
CTF beginners. At the same time, in order to avoid the book becoming a system
security fundamentals book that only lists professional knowledge, we also inter-
spersed the problem-solving tricks and personal experiences to allow the reader to
better integrate, in addition to a large number of CTF-related techniques.
The purpose of this book is to let more people enjoy CTF competitions, have a
better understanding of CTF competitions, and then improve their own techniques
through this book.
---
## Page 6
StructureoftheBook
This book is divided into two parts: the online jeopardy-style CTF and CTF finals. In
addition to the content related to CTF competitions, we also share some real-world
vulnerability mining experiences with the readers.
The online jeopardy-style CTF part consists of ten chapters, covering Web, PWN,
Reverse, APK, Misc, Crypto, blockchain, and code auditing. These chapters cover
most of the CTF topic categories, with corresponding example challenges and
solutions, which enable readers to fully understand and learn the corresponding
techniques. At the same time, the content of this book can also be used as a reference
during CTF competitions.
The CTF finals part consists of two chapters, namely AWD and penetration test.
The AWD chapter provides an in-depth introduction to related tricks and flow
analysis; the penetration chapter is closer to the real world, so readers can combine 
it with actual practice and gain something from it.
---
## Page 7
Description
As we all know, CTF involves a wide variety of professional knowledges, so
29 members of Nu1L team contributed to this book, and each person was responsible
for writing different chapters. I have tried to standardize as much as possible before
writing, but everyone’s writing style is not exactly the same, so some of the chapters
differ greatly in writing style.
The Nu1L team members who contributed to this book are first-time writers, so
there is no guarantee that this book will be exhaustive, but it will cover the
appropriate aspects of CTF competition in as much detail as possible. This book is
mainly for CTF beginners, and if written in detail, each part would be enough to fill a
book, so we have also filtered the content of each part to cover the common
techniques of CTF. For example, the SQL injection section in the Web chapter
NoSQL, etc.
We hope the readers can understand us.
---
## Page 8
AbouttheNuiLTeam
Nu1L is a CTF team founded in 2015, whose name is derived from the word
“NULL" Nu1L is one of the top CTF teams in China, with more than 70 members,
and the official website is https://nu1l.com.
Nu1L has competed in a lot CTF competitions around the world with excellent
results, such as,
·DEFCON CHINA & BCTF2018 Champion
• Ranked 1st locally, 4th globally in the 0CTF/TCTF 2018 Finals
Ranked 1st globally in the LCTF&:SCTF for 3 years
• 2019 XCTF Finals Champion
•Ranked 7th in the DEFCON CTF 2021 Finals
• N1CTF(https:/ctftime.org/ctf/240) Intermnational CTF Organizer
Some of the team members are speakers at Blackhat, HITCON, KCON, and other
security conferences, and participate in professional hacking competitions such as
PWN2OWN and GEEKPWN. Some of the core team members also work for Tea
Deliverers and eee teams.
---
## Page 9
Acknowledgments
Since CTF involves many professional knowledges, the preparation of this book has
gathered articles from many security researchers as well as some published books
and research works.
Thanks to the 29 members of the Nu1L team who contributed to this book.
Finally, I would like to thank all of you who have believed in, supported, and
helped Nu1L throughout the years.
August 2020
Nu1L Team
---
## Page 10
Contents
Introduetion to the Web............
1°
Significant *Information Gathering
The Importance of Information Gathering .
1.1.1
Classification of Information Colletion . . .
1
1.1.2
2
1.2
SQL Injection in CTF . . .
10
1.2.1
SQL Injection Basics . .
10
1.2.2
Injection Points .
25
1.2.3
Injection and Defense . .
31
1.2.4
Impacts of Injection .  .
37
1.2.5
SQL Injection Summary.
38
1.3
Arbitrary File Read Vulnerability.
38
1''1
Common Trigger Points for File Read
Vulnerabilities..
39
1.3.2
Common Read Paths for File Read Vulnerabilities.
45
1.3.3
File Read Vulnerability Example.
49
1.4
Summary. .
82
AdvancedWeb
83
2.1
SSRF Vulnerabilities..........
83
2.1.1
SSRF Principle Analysis....
84
2.1.2
SSRF Vulnerability Finding and Testing .
85
2.1.3
SSRF Vulnerability Attack Mode .
86
2.1.4
98
2.1.5
SSRF in the CTF....
107
2.2
Command Execution Vulnerabilities .
112
2.2.1
Principles of Command Execution and Test
Methods . - .
112
2.2.2
Command Execution Bypasses and Tricks .
116
2.2.3
Real-life Command Execution Challenges and
Answers. .
122
---
## Page 11
XVi
Contents
2.3
The Magic of XSS.
127
2.3.1
XSS Types.
127
2.3.2
XSS Tricks....
133
2.3.3
XSS Fitering and Bypass..... .
137
2.3.4
XSS Bypass Case.
145
2.4
File Upload Vulnerability ... . .
151
2.4.1
Basic File Upload Vulnerability - . .
151
2.4.2
Truncate to Bypass Upload Restrictions .
152
2.4.3
File Suffix Blacklist Verifieation Bypass.
157
2.4.4
File Suffix Whitelist Verification Bypass.
162
2.4.5
File Access Forbidden Bypass . -
165
2.4.6
Bypass Image Check to Achieve Code Execution .
171
2.4.7
Exploit with Upload the Generated Temporary File
174
2.4.8
Use File_put_contents to Upload Files. ..........
177
2.4.9
Uplkoad Problems Caused by ZIP File Upload .
182
195
3.1
Deserialization Vulnerabilities .
195
3.1.1
195
3.1.2
Case Studies .
213
3.2
215
3.2.1
215
3.2.2
219
3.2.3
Python Template Injection . .
221
3.2.4
222
3.2.5
Deserialization in Python . - .
224
3.2.6
Python XXE
225
3.2.7
sys.audit.
228
3.2.8
CTF Python Cases..........
228
3.3
Cryptography and Reverse Knowledge . .
230
3.3.1
Cryptography Knowledge .
233
3.3.2
Reverse Engineering in the Web .
254
260
3.4.1
Common Logic Flaws. 
266
261
3.4.2
Logic Flaws in CTFs. .
3.4.3
Summary of Logical Flaws . 
268
3.5
Summary - .
268
APK
269
4.1
Fundamentals of Android Development .
269
4.1.1
The Four Android Components .. .-. 
269
4.1.2
APK File Structure ... .
270
4.1.3
DEX File Format... .- .
271
4.1.4
Android API.
272
4.1.5
Android Sample Code.
273
---
## Page 12
Coetents
xvi
4.2
APK Reverse Tool.
274
4.2.1
JEB.
274
4.2.2
IDA.
276
4.2.3
Xposed Hook.
279
4.2.4
Frida Hook.
282
4.3
APK Unpacking....
APK Anti-debugging - .
283
4.4
4.4.1
Injecting Process and Dumping Memory 
4.4.2
Modifying the Source . .
285
4.4.3
Class Overloading and DEX Reconstruction . .
287
4.5
APK in CTFs .... - .
4.5.1
OLLVM Obfuscated Native App Reverse
(NJCTF2017).
288
4.5.2
Anti-debuging and Anti-VM (XDCTF 2016) .
291
4.6
Summary - 
293
Reverse Engineering.
295
5.1
Basics of Reverse Engineering......... .
295