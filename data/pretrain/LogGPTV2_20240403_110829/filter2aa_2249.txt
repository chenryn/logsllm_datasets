边信道攻击实战
Kevin2600
 . Kevin2600
 . 专注无线电; 嵌入式设备安全研究
 . NewSky 安全研究员 + 安全培训讲师 
 . 坚信黑客精神就是不断探索未知领域
边信道的传说?
边信道的传说?
. Side-Channel 必须掌握很深的数学知识?
. Side-Channel 必须使用昂贵的硬件设备?
. Side-Channel 都有哪些实战中的运用？
. Side-Channel 作为小白该如何开始？
Contents:
• 边信道的那点事
• 边信道案例 – EM Leaking 
• 边信道案例 – Timing Attack
• 边信道案例 – Fault Injection Attack
• 边信道案例 – Power Analysis & Glitch Attack
边信道的那点事
二战期间盟军的一名研究人员发现他的示波器经常有莫名
的噪音. 调查发现信号来源于隔壁房间的某台加密机. 在深
入研究后, 这名研究员成功地将被加密前的明文信息从噪
音中提取出来.
故事起源:
WHAT ?
边信道攻击是一种针对软件或硬件设计缺陷, 剑走偏锋的攻击方式
攻击途径通常采用被动式监听, 或通过特殊渠道发送隐蔽数据信号
攻击点不在暴力破解或算法分析, 而是通过功耗; 时序; 电磁泄漏等方
式达到破解目的. 在很多物理隔绝的环境中, 往往也能出奇制胜 
WHY ?
. Public key signature check
. Bootloader 加固 (bootdelay = 0)
. 屏蔽调试端口 UART; JTAG; SPI; I2C  
. 电子设备全部物理隔离 (Air Gapping)
HOW ?
. 简单功耗分析 (Simple power analysis)
. 差分功耗分析 (Differential power analysis)
. 需要通过明文或密文触发加密机制运行
. 需要知道用何种加密方式 (AES128; RSA; 3DES)
. 功耗数据提取必须在目标加解密的过程中
: 声波信号采集还原打印机原文
: 美国 NSA 电磁波监听 (TEMPEST)  
: 功耗分析破解南韩公交卡密钥系统 (3DES)
: 功耗分析获取 Philipe Hue 智能灯系统密钥 (AES)
: 通过测量分析电磁发射获取 GnuPG 密钥信息 (RSA)
: 通过声波远程获取物理隔离网络中的数据 (Funtenna)
被动式:   
: Xbox360 Glitch 攻击 (运行 unsigned code)
: 智能网关 Hue NAND Glitch (得到 Root 权限)
: 腾讯玄武激光发指令到二维码读取器 (Bad Barcode)
: 浙江 & Michigan 大学通过声波干扰视频监控硬盘存储
: 以色列 Ben-Gurion 大学通过 USB 发送电磁信号 (USBee)
: Osmo-fl2k 软件无线电发送 FM; GSM; UMTS 与 GPS 信号
主动式: 
边信道案例 – EM leaking 
电磁波 101
• 电磁波是电磁场的运动形态, 属于能量的一种 
• 自身温度大于绝对零度物体, 都可以发射电磁波
• 电磁波应用广泛微波炉; 移动通信; 无线卫星通信
• 电子设备产生电磁波, 对无线电设备造成信号干扰
视频演示
电磁泄漏隐患
. 电子设备利用电磁波信号, 发射信息内容从而
泄漏机密 (Soft-Tempest)
. 电子设备电磁信号可被解码并还原, 达到远程
监控目的 (Hard-Tempest)
. 美国NSA 和北约组织制定安全标准, 要求对涉
密设备进行电磁屏蔽, 并严格限制泄漏电磁辐
射的强度
视频演示
电磁信号分析
. Tel Aviv 大学科研人员通过测量分析电磁发
射获取 GnuPG 密钥信息
. 电磁波可通过H探头和便宜的软件无线电
设备远程获取
. 芯片解密过程中执行的计算量不同, 所需电
量也不同 
. 芯片01转换产生电磁波从空气中泄漏, 其
中包含密钥指纹信息
电磁注入
. EMP-Jammer 高能电磁场发射器 (危险!!!)
. 瞬间大量电流通过导体将产生高能电磁场
. 电磁注入将造成电子设备故障或意外惊喜 ;)
. 将设备放入塑料袋或铝箔包裹可防止电磁攻击
视频演示
边信道案例 – Timing Attack
密码比对
时序攻击
. 仅需普通示波仪即可完成攻击
. 密码位输错给予相对反应 (LED 灯亮）
. 不安全的函数 memcmp() (单字节比对)
. 密码位比对的时间越久, 猜中可能性越大
. 降低猜测空间  (6*6*6*6*6*6 = 46656 ) --> (6+6+6+6+6+6 = 36) 
时序攻击
视频演示
边信道案例 – Fault Injection 
Got Root?
网关 (WinkHub)
. 物联网设备网关 WinkHub (ARM; RAM; NAND)
. 完美的将不同产品连接在一起 (GE; Nest; Dropcam; Philips)
. 支持 Zwave (915Mhz); RF (433Mhz); WIFI/Bluetooth/Zigbee (2.4G)
已被厂家打了补丁 :(
通过网页对其进行访问 (set_dev_value.php)
curl “192.168.01/set_dev_value.php” -d “nodeId=a&attrId=; uname -a;”
Got Root ?
. NAND Flash 通常存储固件; Bootloader; 内
核以及root files
. 使用数据线在系统启动, 读取 NAND 内核
信息瞬间, 短接 I/O pin 以达到数据阻断目的
. 在正确的时间点, 阻止 Bootloader 读取正
确的内核数据从而进入 shell 模式
NAND-Glitch
Got Root !
视频演示
网关 (Philips Hue)
. 飞利浦 Hue 系列智能家居灯控解决方案
. 采用 Zigbee 作为 Hue 与灯泡的无线通讯协议
. 案例 1: Hue 网关可通过 NAND Glitch 方式 Rooting 
. 案例 2: 通过功耗分析提取硬编码 AES 密钥, 绕过固件升级认证
Got Root !
. setenv bootdelay 3 
. setenv security '$1$3vGNd7Q3$ISqFeo1VkmQV6nyriUV0V/'
. saveenv & reset
. HUE 默认 bootdelay 为 0, 且 root 哈希值都不同
. 在 U-Boot 启动读取内核信息瞬间短接 NAND SPI
视频演示
边信道案例 – Power Analysis & Glitch Attack
SPA - 简单功耗分析
. 1998年 Paul Kocher 等将功耗分析带入民众视野
. 处理器运行不同指令在功耗需求上也不近相同
. 寻找目标设备在特定时刻 (解密) 功耗图形的差异
. 安全 Bootloader-TinySafeBoot (密码错误 -->无限循环) 
. RSA 进行平方和乘法运算时的功耗表现可被识别
DPA - 差分功耗分析
目标设备
测量方法
测量结果
DPA - 差分功耗分析
DPA - 差分功耗分析
DPA - 差分功耗分析
DPA - 差分功耗分析 AES-128
DPA - 差分功耗分析
Glitch - 毛刺注入
. Glitch 注入目的在于改变目标设备的设计初衷
. 通过打乱程序的正常流程, 绕过密码安全认证机制
. 使用EM; 激光; 热能; 噪音; 时钟; 电压等作为注⼊源
. 精确的Glitch注入时间点至关重要 (手动; SAD; 模式)
. Glitch 结果具有不可预测性, 错误可能导致设备 Reset
源代码 Linux-util-2.24
CTF 送分题  
RHME 2016
视频演示
ChipWhisperer-Lite
. 由 Colin O'Flynn 设计制作, 学习 SCA 功耗分析
和毛刺注入神器
. 基于Python 跨平台开源软硬件项目 (Windows; 
Linux; MacOS)
. 可用于时序或电压毛刺注入攻击测试, 产生 
<2nS 的脉冲信号
. 通过 DPA 差分功耗分析破解诸如 RSA; AES; 
3DES 等加密算法
总结:
• Kein System ist Sicher: 100% 安全的系统并不存在
• 剑走偏锋的边信道攻击威力无比, 硬件安全必备技能
• 无论多完美的加密算法, 实施过程中的百密⼀疏, 就会
  导致系统安全完全崩溃 
@Kevin2600
问题 ?