### 边信道攻击实战
#### 作者：Kevin2600
- **专注领域**：无线电与嵌入式设备安全研究
- **职位**：NewSky 安全研究员及安全培训讲师
- **理念**：黑客精神在于不断探索未知领域

### 边信道的传说？
- **需要深厚的数学知识吗？**
- **必须使用昂贵的硬件设备吗？**
- **边信道在实战中有哪些应用？**
- **作为初学者如何开始学习？**

### 目录
- 边信道的基础知识
- 案例分析：电磁泄漏（EM Leaking）
- 案例分析：时序攻击（Timing Attack）
- 案例分析：故障注入攻击（Fault Injection Attack）
- 案例分析：功耗分析与毛刺攻击（Power Analysis & Glitch Attack）

### 边信道的基础知识
在二战期间，盟军的一名研究人员发现他的示波器经常出现不明噪音。经过调查，他发现这些信号来自隔壁房间的一台加密机。通过深入研究，这名研究员成功地从噪音中提取出了被加密前的明文信息。

#### 什么是边信道攻击？
- **定义**：边信道攻击是一种利用软件或硬件设计缺陷进行的非传统攻击方式。
- **途径**：通常采用被动监听或通过特殊渠道发送隐蔽数据信号。
- **目标**：不在暴力破解或算法分析上，而是通过功耗、时序、电磁泄漏等方式达到破解目的。
- **应用场景**：即使在物理隔绝的环境中，也能出奇制胜。

#### 为什么需要边信道攻击？
- **公钥签名验证**
- **Bootloader 加固**（例如 `bootdelay = 0`）
- **屏蔽调试端口**（如 UART、JTAG、SPI、I2C）
- **电子设备的物理隔离**（如 Air Gapping）

#### 如何实施边信道攻击？
- **简单功耗分析**（Simple Power Analysis, SPA）
- **差分功耗分析**（Differential Power Analysis, DPA）
- **触发加密机制**：需要通过明文或密文触发加密过程
- **了解加密方式**：需要知道使用的加密算法（如 AES128、RSA、3DES）
- **功耗数据采集**：必须在加解密过程中采集功耗数据

### 案例分析
#### 电磁泄漏（EM Leaking）
- **电磁波基础知识**：
  - 电磁波是电磁场的一种运动形态，属于能量的一种。
  - 温度高于绝对零度的物体都能发射电磁波。
  - 电磁波广泛应用于微波炉、移动通信和无线卫星通信等领域。
  - 电子设备产生的电磁波会对无线电设备造成干扰。

- **电磁泄漏隐患**：
  - 电子设备可能通过电磁波泄露信息内容（Soft-Tempest）。
  - 电磁信号可以被解码并还原，实现远程监控（Hard-Tempest）。
  - NSA 和北约组织制定了安全标准，要求对涉密设备进行电磁屏蔽，并限制电磁辐射强度。

- **案例演示**：
  - Tel Aviv 大学的研究人员通过测量电磁发射获取了 GnuPG 密钥信息。
  - 使用 H 探头和廉价的软件无线电设备可以远程获取电磁信号。
  - 芯片在执行不同计算时的功耗差异可以通过电磁波泄露出来。

- **电磁注入**：
  - EMP-Jammer 高能电磁场发射器（危险！）。
  - 瞬间大量电流通过导体产生高能电磁场。
  - 电磁注入可能导致电子设备故障或意外行为。
  - 将设备放入塑料袋或铝箔包裹可防止电磁攻击。

#### 时序攻击（Timing Attack）
- **密码比对**：
  - 仅需普通示波仪即可完成攻击。
  - 密码位输错会给出相对反应（如 LED 灯亮）。
  - 不安全的函数 `memcmp()` 用于单字节比对。
  - 密码位比对的时间越长，猜中的可能性越大。
  - 降低猜测空间（例如从 `6*6*6*6*6*6 = 46656` 降到 `6+6+6+6+6+6 = 36`）。

- **案例演示**：
  - 通过视频演示展示时序攻击的过程。

#### 故障注入攻击（Fault Injection Attack）
- **WinkHub 案例**：
  - 物联网设备网关 WinkHub（ARM、RAM、NAND）。
  - 支持多种无线通讯协议（Zwave、RF、WIFI/Bluetooth/Zigbee）。
  - 通过网页访问特定接口（如 `set_dev_value.php`）。
  - 使用数据线在系统启动时短接 I/O 引脚以阻断数据读取。
  - 在正确的时间点阻止 Bootloader 读取正确的内核数据，从而进入 shell 模式。

- **Philips Hue 案例**：
  - 采用 Zigbee 作为无线通讯协议。
  - 通过 NAND Glitch 方式进行 Rooting。
  - 通过功耗分析提取硬编码 AES 密钥，绕过固件升级认证。

- **案例演示**：
  - 通过视频演示展示故障注入攻击的过程。

#### 功耗分析与毛刺攻击（Power Analysis & Glitch Attack）
- **简单功耗分析（SPA）**：
  - 1998 年 Paul Kocher 等人将功耗分析带入公众视野。
  - 处理器运行不同指令时功耗需求不同。
  - 寻找目标设备在特定时刻（如解密）的功耗图形差异。
  - 例如，TinySafeBoot 的密码错误会导致无限循环。
  - RSA 进行平方和乘法运算时的功耗表现可被识别。

- **差分功耗分析（DPA）**：
  - 通过测量目标设备在特定操作下的功耗变化来提取密钥。
  - 适用于多种加密算法（如 AES-128、RSA、3DES）。

- **毛刺注入（Glitch Injection）**：
  - 目的是改变目标设备的设计初衷。
  - 通过打乱程序的正常流程，绕过密码安全认证机制。
  - 可以使用电磁波、激光、热能、噪音、时钟、电压等作为注入源。
  - 精确的毛刺注入时间点至关重要。
  - 毛刺结果具有不可预测性，错误可能导致设备复位。

- **案例演示**：
  - 通过视频演示展示功耗分析与毛刺攻击的过程。

### 总结
- **Kein System ist Sicher**：100% 安全的系统并不存在。
- **边信道攻击威力巨大**：是硬件安全必备技能。
- **百密一疏**：无论多完美的加密算法，实施过程中的任何小失误都可能导致系统安全完全崩溃。

@Kevin2600
如有问题，请随时提问。