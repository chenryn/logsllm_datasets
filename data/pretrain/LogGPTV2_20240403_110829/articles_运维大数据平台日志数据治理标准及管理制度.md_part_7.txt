9)  打印日志的代码任何情况下都不允许失败：一定要确保不会因为Log语句的问题而抛出异常造成中断，比如空指针异常。
10) 异常：
```{=html}
```
a.  catch中的异常记录必须打印堆栈信息，不要使用e.pringStackTrace()。
b.  不要记录日志后又抛出异常。抛出去的异常，一般外层会处理。
c.  无论是否发生异常，都不要在不同地方重复记录针对同一事件的日志消息。
d.  输出异常全部的Throwable信息，而不是仅仅e.getMessage()。
数据的接入必须满足平台要求，如：输出方式、内容格式。
应用日志输出要符合《联盟应用日志规范-V1.1》
全局跟踪日志输出符合《交易路径跟踪全局统一流水号和日志规范V2.1》
### 自定义格式日志规范
针对难以满足上述规范建议，或由于特定产品契合度高软件输出的日志，建议满足如下字段要求：
分隔符建议为："#"或"\|"，除分隔符本身外，日志数据中不可包含与分隔符相同的字符。在同种日志类型中，不建议使用多种分隔符进行数据分割。
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **字段**                   **字段释义**           **备注**
  -------------------------- ---------------------- ----------------------------------------------------------------------------------------------------------------
  timestamp                  时间戳                 精确到毫秒级
  hostname                   主机名                 标记日志来源或者关联节点信息
  ip                         IP                     
  level                      日志级别               即日志包含DEBUG，INFO，WARN，ERROR，FATAL且可配置
  processeid/threaded/xxid   进程号/线程号/xxid号   便于基于进程和线程服务对日志聚合分析
  line                       行号                   日志输出所在程序代码逻辑中的行号
  message                    日志信息主体           日志内容主体，技术类日志输出应将事件、动作、错误内容输出，业务类日志输出应将业务类型、关联事件id、错误内容输出
  file                       日志文件               建议将正常日志out、错误异常err分开输出
  encoding                   编码                   统一日志文件内容编码格式
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------
## 数据治理规则(检查易)
根据数据接入及相关命名规范，当时新业务接入上线或者系统变更导致数据在结构、内容等方面等变化，或新需求内容等，需要通过数据治理规则检查，提升数据质量，满足技术和业务方面的需求。
+--------+---------+--------------------------------------------------+
| **数   | **字段  | **检查规范**                                     |
| 据类** | 问题**  |                                                  |
+========+=========+==================================================+
| 数据   | 文      | /var/log/{应用用户名}                            |
| 源信息 | 件路径  |                                                  |
|        |         | /home/{应用用户名}/logs                          |
|        |         |                                                  |
|        |         | 文件路径存在性、可读性检查                       |
+--------+---------+--------------------------------------------------+
|        | 文件名  | Componen                                         |
|        |         | tCode.SubComponentCode.Node.err.log.yyyy-mm-dd.n |
|        |         |                                                  |
|        |         | Componen                                         |
|        |         | tCode.SubComponentCode.Node.out.log.yyyy-mm-dd.n |
|        |         |                                                  |
|        |         | 文件存在性、文件名、个数、可读性、无日志内容检查 |
+--------+---------+--------------------------------------------------+
|        | 数据库  | 数据库类型、个数及数据库连通性检查               |
+--------+---------+--------------------------------------------------+
|        | 网络安  | 设备类型、个数及数据库连通性检查                 |
|        | 全设备  |                                                  |
+--------+---------+--------------------------------------------------+
|        | 字符集  | 文本日志文件字符集检查                           |
+--------+---------+--------------------------------------------------+
|        | 属      | appname/tag/数据集检查                           |
|        | 性/标签 |                                                  |
+--------+---------+--------------------------------------------------+
| 基础   | 时间戳  | yyyy-mm-dd hh:MM:ss.SSS                          |
| 类信息 |         |                                                  |
+--------+---------+--------------------------------------------------+
|        | 日      | DEBUG/INFO/WARN/ERROR/FATAL                      |
|        | 志级别  |                                                  |
+--------+---------+--------------------------------------------------+
|        | 服务    | 服务进程检查                                     |
|        | 进行号  |                                                  |
|        | /线程号 |                                                  |
+--------+---------+--------------------------------------------------+
|        | IP      | 主机节点数检查                                   |
|        | /主机名 |                                                  |
+--------+---------+--------------------------------------------------+
| 拓展   | 全局流  | 长度/构成检查                                    |
| 类信息 | 水号ID  |                                                  |
+--------+---------+--------------------------------------------------+
|        | 关联    | 长度/构成检查                                    |
|        | 外部ID  |                                                  |
+--------+---------+--------------------------------------------------+
|        | 状态    | 技术状态/业务成功失败等检查                      |
+--------+---------+--------------------------------------------------+
|        | 错      | 数据字典检查                                     |
|        | 误码/错 |                                                  |
|        | 误原因  |                                                  |
+--------+---------+--------------------------------------------------+
|        | 时间类  | 开始/结束时间或者耗时检查                        |
+--------+---------+--------------------------------------------------+
|        | 动作类  | 请求/应答动作检查                                |
+--------+---------+--------------------------------------------------+
| 噪     | 接入    | 采集时过滤噪声日志                               |
| 声数据 | 采集时  |                                                  |
+--------+---------+--------------------------------------------------+
|        | 配置时  | 字段提取时过滤噪声日志                           |
+--------+---------+--------------------------------------------------+
|        | 展示    | 应用展示配置时过滤噪声日志                       |
|        | 应用时  |                                                  |
+--------+---------+--------------------------------------------------+
| 其它   | 字      | 补默认值或者开发改造                             |
|        | 段缺失  |                                                  |
+--------+---------+--------------------------------------------------+
|        | 字段格  | 通过字段提取规则完善                             |
|        | 式问题  |                                                  |
|        |         |                                                  |
|        | (       |                                                  |
|        | 空/空格 |                                                  |
|        | /大小写 |                                                  |
|        | /逻辑计 |                                                  |
|        | 算/字典 |                                                  |
|        | 映射/字 |                                                  |
|        | 段组合  |                                                  |
|        | /特殊字 |                                                  |
|        | 符/特定 |                                                  |
|        | 判断/日 |                                                  |
|        | 期时间  |                                                  |
|        | 数值等) |                                                  |
+--------+---------+--------------------------------------------------+
|        | 字段逻  | 去重/去除不合理值/修正矛盾值                     |
|        | 辑错误  |                                                  |
+--------+---------+--------------------------------------------------+
增强型检查核对操作：业务分析检查、变更检查、关联分析检查、前后台检查等。
增强型数据核对操作：内部核对(逆向工程倒推&正向流程推进)、外部核对。
## 数据生命周期管理
当前运维大数据平台作为运维数据（包含日志）的管理平台，其资源是有限的特别是当前数据急剧膨胀的时代，存储资源尤为紧张，而且运维数据绝大部分都为时间序列数据，数据的价值会随时间流逝而稀释，因此我们需要制定严格的数据生命周期管理制度，使有限的资源能够合理的应对运维数据应用的需求。
### 数据生命周期设计
![](media/image11.emf){width="5.736111111111111in" height="2.75in"}
### 数据生命周期规划标准
  --------------------------------------------------------------------------------------------------------------
  **序号**   **数据分类**                                   **在线（月）**   **离线（天）**   **归档（天）前**
  ---------- ---------------------------------------------- ---------------- ---------------- ------------------
  1          网络、安全设备日志                             90               180              365
  2          操作系统运行日志主要为messages                 90               180              365
  3          中间件运行日志（was、tomcat、cics、httpd等）   90               180              365
  4          数据库运行日志（db2、mysql、oracle等）         90               180              365
  5          应用日志\--一类系统                            90               90               90
  6          应用日志\--二类系统                            60               60               60
  7          应用日志\--三类系统                            30               30               30
  8          应用日志\--行方系统                            0                0                0
  9          业务日志\--一类系统                            90               180              365
  10         业务日志\--二/三类系统                         90               180              180
  11         业务日志\--行方系统                            90               180              0
  12         全局跟踪日志                                   60               60               90
  13         性能数据\--联盟                                60               60               60
  14         性能数据\--行方系统                            0                0                0
  15         运维过程数据（4a、itsm、集中监控等）           90               180              360
  16         加工计算后数据                                 \>360            \>360            \>360
  --------------------------------------------------------------------------------------------------------------
### 资源生命周期规划标准
  -----------------------------------------------------------------------
  **数据阶段**            **命令**                **备注**
  ----------------------- ----------------------- -----------------------
  测试                    资源名称_t              t代表test
  预发布                  资源名称_s              s代表staging
  上线试运行              资源名称_o              o代表 online
  运行维护                资源名称                无后缀，稳定运行
  -----------------------------------------------------------------------
### 资源操作规划标准
+----------------------+----------------------+-----------------------+
| **操作**             | **命名**             | **备注**              |
+======================+======================+=======================+
| 新建/增加            | 资源名称_t\_c        | 对                    |
|                      | 资源名称_s\_c        | 于临时测试/试运行发布 |
|                      |                      | 的配置，以资源的生命  |
|                      |                      | 周期标记+操作标记，健 |
|                      |                      | 全完整的生命周期管理  |
|                      |                      |                       |
|                      |                      | c-reate r-retrieve    |
|                      |                      |                       |
|                      |                      | u-update d-delete     |
|                      |                      |                       |
|                      |                      | 其中，当各资          |
|                      |                      | 源在运行2周左右正常无 |
|                      |                      | 误后，可以将资源尾缀  |
|                      |                      | 去除，特别地，对于要  |
|                      |                      | 删除的资源，可删除。  |
+----------------------+----------------------+-----------------------+
| 查询                 | 资源名称_t\_r        |                       |
|                      | 资源名称_s\_r        |                       |
+----------------------+----------------------+-----------------------+
| 修改                 | 资源名称_t\_u        |                       |
|                      | 资源名称_s\_u        |                       |
+----------------------+----------------------+-----------------------+
| 删除                 | 资源名称_t\_d        |                       |
|                      | 资源名称_s\_d        |                       |
+----------------------+----------------------+-----------------------+
## 参考附件
《交易路径跟踪全局统一流水号和日志规范V2.1》
![](media/image12.emf){width="1.0555555555555556in"
height="0.7361111111111112in"}
《联盟应用日志规范-V1.1》
![](media/image13.emf){width="1.0555555555555556in"
height="0.7361111111111112in"}
《系统简称》