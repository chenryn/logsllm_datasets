### 问题描述
我们在IIS 6.0中使用了一个COM+ DLL来支持一个经典的ASP应用程序。经过调试，我们已经确定该DLL导致了工作进程中的挂起问题（即对对象的调用从未返回）。

### 解决方案
我们发现的一个解决方案是限制COM+允许调用运行的时间，并在超时后终止该调用。

### 事件日志分析
我们在事件日志中发现了以下条目，这为我们提供了线索：

```
平均调用持续时间已超过10分钟。如果这不是预期的行为，请参阅Microsoft知识库文章910904 (http://support.microsoft.com/kb/910904)，以了解如何使用COM+ AutoDump功能自动生成转储文件和/或在问题再次发生时终止进程。
服务器应用程序ID: {20D49551-DF30-4A60-B553-CAD7B97F2153}
服务器应用程序实例ID: {45DB1F97-8995-481C-94EE-CA891E446202}
服务器应用程序名称: &lt;-REDACTED-&gt;
```

### 配置修改
根据上述知识库文章，我们修改了以下注册表设置：
```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\COM3\AutoDump
```

### 结果
尽管问题仍然存在，但现在的状况是只影响单个用户，而不再导致整个服务器挂起。