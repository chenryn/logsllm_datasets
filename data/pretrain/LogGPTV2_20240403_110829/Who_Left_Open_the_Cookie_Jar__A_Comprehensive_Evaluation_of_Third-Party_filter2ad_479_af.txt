chromestatus.com/feature/4672634709082112, 2017.
[51] WEST, M., AND GOODWIN, M. Same-site cookies. Internet-
IETF Secretariat,
Draft draft-ietf-httpbis-cookie-same-site-00,
June 2016.
[52] YEN, T.-F., XIE, Y., YU, F., YU, R. P., AND ABADI, M. Host
ﬁngerprinting and tracking on the web:privacy and security im-
plications. In The 19th Annual Network and Distributed System
Security Symposium (NDSS) 2012 (February 2012), Internet So-
ciety.
[53] YU, Z., MACBETH, S., MODI, K., AND PUJOL, J. M. Tracking
the trackers. In Proceedings of the 25th International Conference
on World Wide Web (Republic and Canton of Geneva, Switzer-
land, 2016), WWW ’16, International World Wide Web Confer-
ences Steering Committee, pp. 121–132.
[54] ZELLER, W. P., AND FELTEN, E. W. Cross-site request forg-
eries: Exploitation and prevention.
[55] ZHENG, X., JIANG, J., LIANG, J., DUAN, H., CHEN, S., WAN,
T., AND WEAVER, N. Cookies lack integrity: Real-world impli-
cations. In 24th USENIX Security Symposium (USENIX Security
15) (Washington, D.C., 2015), USENIX Association, pp. 707–
721.
Appendix
A Test compositions
In this section, we explicate the various test compositions
that we have integrated in our framework. These compo-
sitions are shown in Table 5, together with the illustrated
domains.
B Extension set population
In this section, we present the extension set popula-
tions. For the ad tracking protection extensions, these
are shown in Table 6 and for the ad blocking extensions
in Table 7. All extensions for Chrome, Opera and Fire-
fox were selected based on relevant search criteria and
USENIX Association
27th USENIX Security Symposium    165
Test composition
includes (cid:32)
includes (cid:32)
includes (cid:32)
includes (cid:32) −−−−→
includes (cid:32)
ID
1
(cid:32)
(cid:32) −−−−→
2
(cid:32) −−−−→
3
(cid:32) −−−−→
4
(cid:32) −−−−→
5
6
(cid:32)
∗ (cid:32)
7
(cid:32) −−−−→
8
∗ Iframe constructed through data:text/html.
−−−−→
(cid:32)
includes
−−−−→
(cid:32)
includes
−−−−→
(cid:32)
includes
−−−−→
(cid:32)
includes
−−−−→
(cid:32)
includes
ﬁle:// −−−−→
includes
−−−−→
(cid:32)
includes
−−−−→
(cid:32)
includes
includes (cid:32) −−−−→
includes (cid:32) −−−−→
includes (cid:32)
Table 5: Test compositions supported by our framework.
a minimum number of users or downloads (whichever
was available). Due to the unavailability of both num-
bers for Edge extensions, we selected Edge extensions
based on the popularity of their counterparts for the other
browsers. The extension “AdBlocker Lite” takes up two
entries in Table 2 and 7 because we tested its two modes.
C Bug reports and responses
In this section, we address the bug reports that we ﬁled
and their subsequent responses. Bugs were reported
to both browsers (Section C.1) and extensions (Sec-
tion C.2). In order to not inspire any attackers or trackers,
we decided to only ﬁle private bug reports. Note that bug
threads mights still be private when visiting the associ-
ated link.
C.1 Built-in browser protection
[bug1] The bug that can be leveraged to bypass
Chrome’s and Opera’s third-party cookie policy has been
conﬁrmed and is scheduled to be ﬁxed at the time of writ-
ing. 13
[bug2] We reported that Safari 10 does not block all
third-party cookies when this option is enabled. At the
time of writing, this bug has not yet been conﬁrmed.14
[bug3] The bug that nulliﬁes Edge’s option to block
third-party cookies has been conﬁrmed.15
13https://bugs.chromium.org/p/chromium/issues/
detail?id=836746
14https://bugs.webkit.org/show_bug.cgi?id=186589
15https://developer.microsoft.com/en-us/microsoft-
[bug4] The bypasses for Opera’s ad blocker have been
reported, however, we were not given access to the bug
thread. Instead, we were given an email address through
which we can inquire about the process.
[bug5]
In the bug thread that we have started for by-
passes concerning Firefox’ tracking protection, refer-
ences have been made to previously reported similar
bugs that are related to Firefox’ Safe Browsing fea-
ture [37].16 For example, the AppCache API had al-
ready been reported to bypass the URL classiﬁer used
by Safe Browsing to signal websites known for phishing
or malware. Although the bug has not yet been ofﬁcially
ﬂagged as conﬁrmed at the time of writing, there was an
intention to ﬁx.
C.2 Extensions
[bug6] This bug permitted cross-site requests, initiated
by JavaScript embedded in a PDF, to bypass the WebEx-
tension API in Chromium-based browsers. This made
it impossible for extensions (e.g. ad blockers and anti-
tracking extensions) to implement a thorough third-party
cookie and request policy. Unfortunately, our bug thread
was closed as WontFix,17 because this functionality was
working as intended; requests initiated by an extension
(PDFium) shouldn’t be interceptable by other extensions.
Thread responses showed reluctance to treating PDFium
differently because it would be costly and difﬁcult to im-
plement. We mentioned that Opera - a Chromium-based
browser - actually managed to mitigate these requests
16https://bugzilla.mozilla.org/show_bug.cgi?id=
1447935
17https://bugs.chromium.org/p/chromium/issues/
edge/platform/issues/16512847
detail?id=824705
166    27th USENIX Security Symposium
USENIX Association
Set
Extension name
Version Number of users/downloads
Chrome Tracking Protection Extensions
SET B1
SET B2
SET B3
SET B4
SET B5
SET B6
SET B7
Blur
ScriptSafe
Ghostery
Privacy Badger
Disconnect
uMatrix
7.7.2390
1.0.9.1
7.4.1.4
2017.11.20
5.18.23
1.1.12
248,825 users
286,512 users
2,787,473 users
711,102 users
918,877 users
121,618 users
Opera Tracking Protection Extensions
Blur: Protect your passwords, payments & privacy
Disconnect
Privacy Badger
Ghostery
7.7.2393
5.17.5
2017.11.20
7.4.3.1
154,817 downloads
564,628 downloads
140,381 downloads
4,865,900 downloads
Firefox Tracking Protection Extensions
DuckDuckGo Plus∗
Privacy Badger
SET B8
SET B9
SET B10 Ghostery Privacy Ad Blocker
SET B11 Cliqz - Schnellsuche und Trackingschutz
2017.11.30
2017.11.20
7.4.1.4
2.21.3
419,351 users
411,406 users
1,048,907 users
94,361 users
SET B12 Ghostery
∗ Recently changed its name to “DuckDuckGo Privacy Essentials”.
7.5.0.0
N/A
Edge Tracking Protection Extensions
Table 6: Population of the tracking protection extension sets.
with its built-in ad blocker, but also proposed an alter-
native solution like providing a setting to block execu-
tion of JavaScript embedded in PDFs. Response to our
proposition was supportive, however we are not aware
of any progress on the matter. In the same bug report,
we also explained the difﬁculties for extensions to dis-
tinct between requests initiated through the AppCache
or ServiceWorker API, and requests initiated by browser
functionality. However, no responses have been made in
regard to this.
[bug7] We reported that requests for fetching the favi-
cons are not interceptable through Firefox’ WebExten-
sion API and that requests initiated through the App-
Cache API are not easily distinguishable in Firefox. The
bug thread was closed as WontFix,18 because the ﬁrst is-
sue had already been reported and no additional effort
will be made to ﬁx the deprecated AppCache API.
[bug8]
In addition to the aforementioned bugs caused
through the AppCache and WebSocket API, we identi-
ﬁed a wide variety of bugs inherent to the implementa-
tion of ad blocking and privacy protection extensions.
18https://bugzilla.mozilla.org/show_bug.cgi?id=
1447933
Because of the large number of affected extensions,
many without a dedicated bug tracker, we only contacted
a selection of them. This selection involved the 11 most
popular and recently updated extensions, most of them
supported by multiple browsers, to which we reached out
through a private channel. Unfortunately, only 5 exten-
sion developers responded, of which only 2 pro-actively
tried and succeeded to ﬁx the issue.
C.3 Same-site cookie
[bug9] The prerender bug that we found in Chrome
and Opera has been ﬁled through the Chromium project,
where it was conﬁrmed and scheduled to be ﬁxed.19
[bug10] We have reported the several bypasses that we
found for Edge’s implementation of the same-site cookie
policy. This bug report has been conﬁrmed.20
19https://bugs.chromium.org/p/chromium/issues/
detail?id=709946
20https://developer.microsoft.com/en-us/microsoft-
edge/platform/issues/18054323/
USENIX Association
27th USENIX Security Symposium    167
Set
Extension name
Version Number of users/downloads
SET A1
SET A2
SET A3
SET A4
SET A5
SET A6
SET A7
SET A8
AdRemover for Google Chrome
Windscribe - Free VPN and Ad Blocker
uBlock
AdBlocker Ultimate
Ads Killer
Hola ad blocker
Fair AdBlocker
AdGuard AdBlocker
AdBlock Pro
uBlock Adblocker Plus
uBlock Origin
uBlock Plus Adblocker
AdBlock
Adblock Plus
Chrome Ad Blocking Extensions
1.1.1.0
2.3.4
0.9.5.0
2.26
0.99.70
1.21.624
1.404
2.7.2
4.3
2.3
1.14.22
1.5.2
3.22.1
1.13.4
Opera Ad Blocking Extensions
0.4.0
2.57
2.23
1.2.0
0.4.0
2.7.2
10.2.0
1.14.16
1.13.4
Firefox Ad Blocking Extensions
3.8.0
2.28
2.7.3
1.14.18
3.0.1
Edge Ad Blocking Extensions
2.4.0.0
0.9.9.0
2.8.4
1.14.24
AdBlocker Lite (Lite mode)
AdBlock
AdBlocker Ultimate
SET A9
SET A10 Adblock Fast
AdBlocker Lite (Full mode)
SET A11 Adguard
SET A12 ContentBlockHelper
SET A13
uBlock origin
SET A14 Adblock Plus
SET A15 AdBlock for Firefox
AdBlocker Ultimate
SET A16 Adguard AdBlocker
SET A17
uBlock Origin
SET A18 Adblock Plus
SET A19 AdBlock
SET A20 Adblock Plus
SET A21 Adguard Adblocker
SET A22
uBlock origin
9,463,986 users
553,466 users
519,056 users
628,321 users
2,262,911 users
143,790 users
1,808,682 users
4,650,713 users
2,134,631 users
332,645 users
10,000,000+ users
521,915 users
10,000,000+ users
10,000,000+ users
164,309 downloads
11,199,416 downloads
1,209,271 downloads
465,483 downloads
164,309 downloads
5,649,827 downloads
371,330 downloads
3,738,666 downloads
33,802,382 downloads
865,131 users
448,458 users
299,462 users
5,216,321 users
13,574,386 users
N/A
N/A
N/A
N/A
Table 7: Population of the ad blocking extension sets.
168    27th USENIX Security Symposium
USENIX Association