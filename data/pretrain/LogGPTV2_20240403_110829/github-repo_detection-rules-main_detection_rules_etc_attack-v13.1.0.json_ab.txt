{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service binary target path locations. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses. (Citation: Powersploit)\n\nIdentify and block potentially malicious software that may be executed through abuse of file, directory, and service permissions by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) that are capable of auditing and/or blocking unknown programs. Deny execution from user directories such as file download directories and temp directories where able. (Citation: Seclists Kanthak 7zip Installer)\n\nTurn off UAC's privilege elevation for standard users [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System]to automatically deny elevation requests, add: \"ConsentPromptBehaviorUser\"=dword:00000000 (Citation: Seclists Kanthak 7zip Installer). Consider enabling installer detection for all users by adding: \"EnableInstallerDetection\"=dword:00000001. This will prompt for a password for installation and also log the attempt. To disable installer detection, instead add: \"EnableInstallerDetection\"=dword:00000000. This may prevent potential elevation of privileges through exploitation during the process of UAC detecting the installer, but will allow the installation process to continue without being logged.", "external_references": [{"external_id": "T1044", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1044"}, {"description": "PowerSploit. (n.d.). Retrieved December 4, 2014.", "source_name": "Powersploit", "url": "https://github.com/mattifestation/PowerSploit"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Kanthak, S. (2015, December 8). Executable installers are vulnerable^WEVIL (case 7): 7z*.exe\tallows remote code execution with escalation of privilege. Retrieved March 10, 2017.", "source_name": "Seclists Kanthak 7zip Installer", "url": "http://seclists.org/fulldisclosure/2015/Dec/34"}], "id": "course-of-", "modified": "2021-08-23T20:25:21.486Z", "name": "File System Permissions Weakness Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Upgrade to Windows 8 or later and enable secure boot.\n\nIdentify and block potentially malicious software that may be executed through AppInit DLLs by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) that are capable of auditing and/or blocking unknown DLLs.", "external_references": [{"external_id": "T1103", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1103"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}], "id": "course-of-", "modified": "2020-01-17T16:45:23.250Z", "name": "AppInit DLLs Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Restrict user's abilities to create Launch Agents with group policy.", "external_references": [{"external_id": "T1159", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1159"}], "id": "course-of-", "modified": "2019-07-24T19:47:59.038Z", "name": "Launch Agent Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2019-06-10T20:46:02.263Z", "created_by_ref": "", "description": "Use intrusion detection signatures to block traffic at network boundaries.", "external_references": [{"external_id": "M1031", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1031"}], "id": "course-of-", "modified": "2019-06-10T20:46:02.263Z", "name": "Network Intrusion Prevention", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block regsvr32.exe from being used to bypass whitelisting. (Citation: Secure Host Baseline EMET)", "external_references": [{"external_id": "T1117", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1117"}, {"description": "National Security Agency. (2016, May 4). Secure Host Baseline EMET. Retrieved June 22, 2016.", "source_name": "Secure Host Baseline EMET", "url": "https://github.com/iadgov/Secure-Host-Baseline/tree/master/EMET"}], "id": "course-of-", "modified": "2019-07-25T11:32:22.755Z", "name": "Regsvr32 Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "If the computer is domain joined, then group policy can help restrict the ability to create or hide users. Similarly, preventing the modification of the /Library/Preferences/com.apple.loginwindow Hide500Users value will force all users to be visible.", "external_references": [{"external_id": "T1147", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1147"}], "id": "course-of-", "modified": "2019-07-24T19:36:24.202Z", "name": "Hidden Users Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "To mitigate adversary access to information repositories for collection:\n\n* Develop and publish policies that define acceptable information to be stored\n* Appropriate implementation of access control mechanisms that include both authentication and appropriate authorization\n* Enforce the principle of least-privilege\n* Periodic privilege review of accounts\n* Mitigate access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) that may be used to access repositories", "external_references": [{"external_id": "T1213", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1213"}], "id": "course-of-", "modified": "2019-07-24T19:06:19.932Z", "name": "Data from Information Repositories Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods. Minimize available services to only those that are necessary. Regularly scan the internal network for available services to identify new and potentially vulnerable services. Minimize permissions and access for service accounts to limit impact of exploitation.\n\nUpdate software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for all software or services targeted.", "external_references": [{"external_id": "T1210", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1210"}, {"description": "Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.", "source_name": "Ars Technica Pwn2Own 2017 VM Escape", "url": "https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/"}, {"description": "Nunez, N. (2017, August 9). Moving Beyond EMET II \u2013 Windows Defender Exploit Guard. Retrieved March 12, 2018.", "source_name": "TechNet Moving Beyond EMET", "url": "https://blogs.technet.microsoft.com/srd/2017/08/09/moving-beyond-emet-ii-windows-defender-exploit-guard/"}, {"description": "Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.", "source_name": "Wikipedia Control Flow Integrity", "url": "https://en.wikipedia.org/wiki/Control-flow_integrity"}], "id": "course-of-", "modified": "2019-07-24T19:26:53.547Z", "name": "Exploitation of Remote Services Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2019-06-06T16:47:30.700Z", "created_by_ref": "", "description": "Vulnerability scanning is used to find potentially exploitable software vulnerabilities to remediate them.", "external_references": [{"external_id": "M1016", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1016"}], "id": "course-of-", "modified": "2020-07-14T22:22:06.356Z", "name": "Vulnerability Scanning", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.1"}
{"created": "2019-02-15T13:04:25.150Z", "created_by_ref": "", "description": "Map the trusts within existing domains/forests and keep trust relationships to a minimum. Employ network segmentation for sensitive domains.(Citation: Harmj0y Domain Trusts)", "external_references": [{"external_id": "T1482", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1482"}, {"description": "Schroeder, W. (2017, October 30). A Guide to Attacking Domain Trusts. Retrieved February 14, 2019.", "source_name": "Harmj0y Domain Trusts", "url": "http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/"}], "id": "course-of-", "modified": "2020-09-17T18:26:17.815Z", "name": "Domain Trust Discovery Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Evaluate the security of third-party software that could be used in the enterprise environment. Ensure that access to management systems for third-party systems is limited, monitored, and secure. Have a strict approval policy for use of third-party systems.\n\nGrant access to Third-party systems only to a limited number of authorized administrators. Ensure proper system and access isolation for critical network systems through use of firewalls, account privilege separation, group policy, and multi-factor authentication. Verify that account credentials that may be used to access third-party systems are unique and not used throughout the enterprise network. Ensure that any accounts used by third-party providers to access these systems are traceable to the third-party and are not used throughout the network or used by other third-party providers in the same environment. Ensure third-party systems are regularly patched by users or the provider to prevent potential remote access through [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068). \n\nEnsure there are regular reviews of accounts provisioned to these systems to verify continued business need, and ensure there is governance to trace de-provisioning of access that is no longer required.\n\nWhere the third-party system is used for deployment services, ensure that it can be configured to deploy only signed binaries, then ensure that the trusted signing certificates are not co-located with the third-party system and are instead located on a system that cannot be accessed remotely or to which remote access is tightly controlled.", "external_references": [{"external_id": "T1072", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1072"}], "id": "course-of-", "modified": "2019-07-25T12:27:40.782Z", "name": "Third-party Software Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Identify potentially malicious software that may be executed from a padded or otherwise obfuscated binary, and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1009", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1009"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2021-08-23T20:25:18.699Z", "name": "Binary Padding Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}