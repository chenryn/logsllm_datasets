CPU Output 
Input 
Non-
Volatile  
Memory 
Relay 
Lock motor 
Lock solenoid 
Interlock  
Panel switch 
Lock sensor 
Door sensor 
Limit switch 
Door control 
(+)  Power 
supply 
Programming 
device 
Communications 
  There are from 40 to 50 manufacturers.  The 
PLCs most commonly used in corrections 
are: 
›  Allen-Bradley 
›  GE Fanuc 
›  Hitachi 
›  Mitsubishi 
›  Panasonic 
›  Rockwell Automation 
›  Samsung 
›  Siemens 
›  Square-D 
  Usually 9-pin RS-232 or EIA-485 or Ethernet 
  Protocols 
›  Modbus 
›  LonWorks (Most common) 
›  BACnet 
›  DF1 
›  others 
  Programming 
›  Ladder Logic 
  Most common, esp. for older systems 
  Weak 
›  FBD (Function block diagram) 
›  SFC (Sequential function chart) 
›  ST (Structured text; viz. Pascal) 
›  IL (Instruction list) 
›  BASIC 
›  C++ 
  In large facilities PLCs monitor many 
thousands of points (mostly contact 
closures) and control hundreds of 
devices (mostly motors and solenoids) 
This one door could have as many as 34 points to 
monitor 
Note 
Perimeter gate operators are controlled by 
PLCs 
  Open doors and gates 
›  Especially in a.m. hours when controls may have 
shifted to Central Control because of staffing 
shortages. 
  Cause phased locks (sliders) to go out of 
phase 
  Prevent doors or gates from opening 
›  Especially during a fire evacuation when “slam-
lock” doors (without remote latch holdback) 
can only be unlocked manually with a key.  
Guards may not have the key. 
  Emergency release of entire cell blocks or 
entire facility 
›  Prevent “cascading release” and massive power 
in-rush may cause severe damage 
  Activate door motors and solenoids 
›  Accelerating high-speed activation of solenoids 
›  Make them fire off like machine guns 
  Radio signal-linked graphic panels in patrol 
vehicles 
›  Weak encryption or no encryption 
  Perimeter fence intrusion detection 
systems (FIDS) often have high rates of 
nuisance (NAR) and false (FAR) alarm 
rates 
›  Rates can be elevated until zones are shut 
down by Central Control 
›  Exception would be “taut-wire” systems, but 
those systems are infrequent 
  Belief that PLCs are invulnerable 
because they are not connected to the 
Internet 
›  Operating system software requires installing 
patches and updates 
›  Correctional facilities need to send and 
receive information to and from federal, 
state, or local data bases 
›  Facility operations often require off-site 
support from vendors and suppliers (i.e. food 
service) 
  Belief that PLCs are invulnerable because 
they are not connected to the Internet 
›  Some facilities provide Internet access for 
inmates 
  Granted, they aren’t connected to facility 
networks 
  But, Charles Manson smuggled a cell phone into 
his cell twice in two years 
›  Perimeter patrol vehicles have wireless 
connections to the fence intrusion detection 
system 
›  Prison intercom systems often have a “patch” to 
connect to public telephone (PBX) system 
  Belief that PLCs are invulnerable 
because they are not connected to the 
Internet 
›  After a correctional facility’s electronic 
security systems have been designed and 
installed, the owner’s IT people show up to 
add network connections 
›  AND…corrections officers sometimes “break 
the rules” 
  You could wreak widespread 
pandemonium by severely damaging door 
systems and shutting down security, 
communications, and video surveillance 
›  As only one example, a very large prison cannot 
instantly, simultaneously open or close all doors.  
The power in-rush would be massive, destroying 
the electronics and possibly physically 
damaging door components.  Doors are 
gradually “cascaded” open or closed, group-
by-group.  You could override the “cascade” 
program. 
  Technicians access the 
Equipment Room 
›  We were there when 
techs were in Equipment 
room; with permission, 
we followed them down 
under Central Control 
  Central Control infected 
with a USB drive 
  Internet access being 
used by guards for 
personal usage 
›  Policies against this exist, 
but we witnessed this 
being abused 
  Software updates 
  Straight-forward 
malicious attacks from 
outside the facility 
  Malicious attacks from 
outside the “sanitized” 
zone, but at a point at 
which the Internet 
connects to the outside 
From Within 
From Without 
  Prison design shows that there may be 
multiple places where internet access 
from the control computers in Central 
Control touch buildings in which there is 
Internet access reachable from the 
outside 
›  An example is the Commissary  
›  Where there are financial exchanges, we 
traced some connections shared with 
Central Control 
What kind of badness is 
possible? 
›  Goal is to open doors 
  To either cause chaos for a murder, bring an 
item into the prison or release someone from 
the facility 
  Potential to open: 
  All cell doors 
  Doors to the yard 
  Gates into/out of the facility 
  Most doors, in event of fire, have own separate 
controls 
  But emergency controls for those gates that are wired 
into the Central Control over-ride 
  Unlikely…yes, but in the past 30 years 
helicopters have been used for a prison 
escape 8 times, of which 6 were initially 
successful.  Which event is more unlikely? 
  Attack via Internet Access  
  Devices do updates via the Internet  
  Unsigned software manufacturer/vendor updates? 
  The guards in Central Control  and Housing Control 
are not  supposed to use computers for personal 
usage 
  We witnessed guards in Central Control on personal 
Gmail accounts 
  Had discussion with guards; they admitted a lot of 
malware on control computer because of viewing of 
images and movies  
›  Prisoners sometimes want to target someone 
within the prison. 
›  Example: During a fire evacuation 
  Prisoners in high security prisons often do not 
evacuate into the yard, but use horizontal 
exiting, such as through a one-hour rated 
partition  
  In process, prisoners have slammed doors 
(called “slam locks”) shut behind them, 
trapping those behind in areas that cannot be 
manually re-opened once the fire alarm 
activated. Those behind the door have died.  
›  Lock a Housing Unit Down 
  A gang in one Housing Unit wants to eliminate 
members of another gang in a separate 
Housing Unit. 
  Lock down a Housing Unit, no manual over-rides 
  Set a mattress fire  
  Result is everyone, including guards, in locked down 
housing unit, perish 
  It cost us only $2500 (mostly in legit licenses) 
  Bought  licensed products from the vendor  
  Wrote exploits for the Siemens  S7-300, the same one 
exploited by Stuxnet 
  There are exploits that are simple-to-write 
Buffer overflow on a stack, about 30 lines of code  
  Programming 
PLCs is easy 
  Ladder Logic 
  In <3 hours & no 
prior ladder 
logic 
experience, we 
simulated jail’s 
system 
   Logic AND 
  In Ladder Logic 
  Logic OR 
  In Ladder Logic 
  There exist many publically available 
exploits… 
  Luigi Auriemma 
›  34 exploits released in  1 day (Mar 21, 2011) 
›  http://aluigi.org/adv.htm 
  Metasploit 
  Exploit-DB 
  Similar to Stuxnet 
  Directly call PLC functions 
  Suppress alarms/notifications 
  Video on YouTube 
  Use a device for its intended purpose 
  Proper network segmentation 
  Restrict physical media 
  Restrict physical access 
  Follow acceptable use policies 
regarding accessing the Internet from 
locations like the Control or Equipment 
Rooms 
  Many modern prisons/jails were designed 
10 years ago before these attacks were 
known 
  Improved communication/interaction 
between IT and physical security 
  Enforcing and updating procedures and 
policies regarding acceptable use of facility 
computers 
  Patch PLC and controlling computer’s 
software 
  When PLCs are in use in secured areas, use 
heightened security procedures 
  The CISO of a State in the U.S. who is 
cognizant about computer security and 
is working to improve security in 
correctional facilities 
  The Feds who invited us for a briefing on 
our research  
  Law Enforcement Officers who provided 
us with a tour and discussed their 
concerns about the current state of the 
correctional system 
CORE Security Technologies for publishing 
our work and teaming with us for 
correctional facility pen test projects 
  Tiffany Rad 
›  PI:EMAIL 
  Teague Newman 
›  PI:EMAIL 
  John Strauchs 
›  PI:EMAIL 
For questions or inquiries about penetration tests of 
correctional facilities, contact us or 
PI:EMAIL