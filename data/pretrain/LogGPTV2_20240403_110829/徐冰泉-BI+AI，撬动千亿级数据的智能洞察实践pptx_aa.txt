BI+AI 撬动千亿级数据 的智能洞察实践
火山引擎 VeDI DataWind 研发负责人 / 徐冰泉
BI 平台演进：全面进入智能化 
火山引擎高性能数据分析架构方案 BI + AI 实现智能数据洞察 
总结与展望
BI 平台演进：全面进入智能化 	BI + AI
BI平台演进 - 全面进入智能化
|  |  |  |  |  |  |  |
|---|---|---|---|---|---|---|
| 演进 |基于经营目标，制作数据仪表盘 |基于经营目标，制作数据仪表盘 |日常数据分析、业务指标跟踪 |日常数据分析、业务指标跟踪 |数据智能洞察、指导业务决策 |数据智能洞察、指导业务决策 |
|   |  |  |  |  |  |  |
|  |  |  |  |  |  |  |
| 演进 |报表制作与查看工具 |报表制作与查看工具 |数据准备与自助分析平台 |数据准备与自助分析平台 |数据分析与洞察决策平台 |数据分析与洞察决策平台 ||  |  |  |  |  |  |  |
| 核心 |  |  |数据准备 | 自助分析 | 看板制作 | 数据协同 |数据准备 | 自助分析 | 看板制作 | 数据协同 |异动检测 | 归因分析 | 洞察决策 | 智能助手 |异动检测 | 归因分析 | 洞察决策 | 智能助手 |
| 场景 |  |  |数据准备 | 自助分析 | 看板制作 | 数据协同 |数据准备 | 自助分析 | 看板制作 | 数据协同 |异动检测 | 归因分析 | 洞察决策 | 智能助手 |异动检测 | 归因分析 | 洞察决策 | 智能助手 |
| 用户 | | | | | | |
|  |  |  |  |  |  |  |
| 群体 |  |  |  |  |  |  |
|   |  |  |大数据 |大数据 |人工智能 |人工智能 |
| 基础 |  |  |大数据 |大数据 |人工智能 |人工智能 || 基础 |  |  |大数据 |大数据 |人工智能 |人工智能 |
火山引擎企业级 BI 平台建设历程
| 01 | 夯实基础 | 02 | 丰富能力 | 03 | 持续探索 |
|---|---|---|---|---|---|
| SQL查询 |SQL查询 |02 |丰富能力 |03 |持续探索 |
20+min/query
Feb 2018
可视化查询
May2018
| 仪表盘 | 项目中心 | 可视化建模 |
|---|---|---|
| 仪表盘 |Apr 2020 |Apr 2021 |
| 多图表展示分享 |Apr 2020 |Apr 2021 |
| Aug 2018 |智能归因 |洞察决策/AI |
| 数据协同 |智能归因 |洞察决策/AI |
| 数据协同 |智能归因 |Apr 2021 |
| 数据协同 |Apr 2020 |Apr 2021 || 数据协同 |Apr 2020 |Apr 2021 |
| May 2019 |Apr 2020 |Apr 2021 |
| 数据集 |移动端 |Copilot |
| 数据集 |Aug 2020 |Apr 2023 |
| Oct 2019 |Aug 2020 |Apr 2023 |
产品能力矩阵
|  |  |  |  |
|---|---|---|---|
| 数据管理 |数据分析 |展示协调 |企业管控 |
| 数据连接 | 可视化图表 | 仪表盘&大屏&移动端 | 多项目空间 |
|---|---|---|---|
| BI+AI 可视化建模 |可视化分析 |指标监控订阅 |权限管控 |
| 业务数据集 |AI 智能归因 |办公协同&多产品联动 |运营分析 |
| 高性能存储计算引擎 |AI 洞察决策 |嵌入式分析 |运维监控 || 高性能存储计算引擎 |AI 洞察决策 |嵌入式分析 |运维监控 |
|      |     |功能亮点  BI +AI 洞察决策、交互式分析  智能归因预警、数据协同办公 |功能亮点  BI +AI 洞察决策、交互式分析  智能归因预警、数据协同办公 |
抖音集团内部用户量最大的数据产品 	DataWind 全员自助分析体系
| 用户角色 | 团队管理者 | 产品研发 | 产品研发 | 商业化 | 运营 | 运营 | 运营 | 项目管理 | 仪表盘总量 | 分析项目数 |
|---|---|---|---|---|---|---|---|---|---|---|
| 飞书协同 |产品经理 |研发经理 |市场营销 |业务运营 |产品运营 |产品运营 |用户运营 |IT/运维 |仪表盘总量 |分析项目数 || 飞书协同 |图表看板嵌出 |图表看板嵌出 |权限管控 |仪表盘评论 |仪表盘评论 |仪表盘评论 |仪表盘评论 |订阅&预警 |仪表盘总量 |分析项目数 |
| 飞书协同 |直播交易转化 客服数据分析体系 商业化过程提效 |直播交易转化 客服数据分析体系 商业化过程提效 |直播交易转化 客服数据分析体系 商业化过程提效 |直播交易转化 客服数据分析体系 商业化过程提效 |直播交易转化 客服数据分析体系 商业化过程提效 |风险规避 |风险规避 |精细化运营 |仪表盘总量 |分析项目数 |
业务场景
| 数据整合 | ETL | DataWind | DataWind | DataWind | DataWind | 无效值纠正 | 缺失值替代 | 数据集总量 | 业务团队 |
|---|---|---|---|---|---|---|---|---|---|| 数据整合 |ETL |数据去重 |无效数据剔除 |无效数据剔除 |一致性检验 |无效值纠正 |缺失值替代 |数据集总量 |业务团队 |
| 数据接入 |ETL |线上数据 |线上数据 |线上数据 |线上数据 |线下数据 |线下数据 |单日查询量 |业务团队 |
| 数据接入 |数据库 |线上数据 |线上数据 |线上数据 |线上数据 |线下数据 |线下数据 |单日查询量 |业务团队 |
| 数据接入 |数据库 |抖音集团生态数据 |抖音集团生态数据 |业务系统数据 |业务系统数据 |本地文件 |飞书表格 |单日查询量 |业务团队 |
火山引擎 
高性能数据分析架构方案
技术架构：分布式、可扩展、大数据、高可用
| 应用层 | 仪表盘 | 仪表盘 | 自助分析 | 自助分析 | 自助分析 | 大屏 | 大屏 | 大屏 | 移动端/H5 | 移动端/H5 | 数据集 | 数据集 | 系统服务 ||---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 服务层 |元数据服务 MetaService |元数据服务 MetaService |数据准备服务 PrepService |数据准备服务 PrepService |数据准备服务 PrepService |数据准备服务 PrepService |数据准备服务 PrepService |数据准备服务 PrepService |查询服务 VQS |查询服务 VQS |缓存服务 Redis |缓存服务 Redis |数据监控订阅 |
| OLAP |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |实时数据 |平台数据 |Subscription || OLAP |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |实时数据 |平台数据 |数据预警推送 |
| OLAP |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |实时数据 |平台数据 |Push || OLAP |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |分析型数据库 ByteHouse |实时数据 |平台数据 |权限控制与审计 |
| OLAP |批计算  |批计算  |流计算  |流计算  |数据抽取  |数据抽取  |数据抽取  |数据抽取  |数据导入 |数据导入 |实时数据 |平台数据 |权限控制与审计 |
| 计算层 |批计算  |批计算  |流计算  |流计算  |数据抽取  |数据抽取  |数据抽取  |数据抽取  |数据导入 |数据导入 |实时数据 |平台数据 |权限控制与审计 || 计算层 |批计算  |批计算  |流计算  |流计算  |数据抽取  |数据抽取  |数据抽取  |数据抽取  |数据导入 |数据导入 |实时数据 |平台数据 |Auth |
| 计算层 |Spark |Spark |Flink |Flink |ByteX |ByteX |ByteX |ByteX |Hive2CH |Hive2CH |实时数据 |平台数据 |Auth |
| 计算层 |Spark |Spark |Flink |Flink |ByteX |ByteX |ByteX |ByteX |Hive2CH |Hive2CH |实时数据 |平台数据 |服务发现系统 |
| 计算层 |资源管理 Yarn |资源管理 Yarn |K8s |K8s |K8s |K8s |K8s |K8s |K8s |K8s |实时数据 |平台数据 |服务发现系统 || 计算层 |资源管理 Yarn |资源管理 Yarn |K8s |K8s |K8s |K8s |K8s |K8s |K8s |K8s |实时数据 |平台数据 |Consul |
| 存储层 |资源管理 Yarn |资源管理 Yarn |K8s |K8s |K8s |K8s |K8s |K8s |K8s |K8s |实时数据 |平台数据 |Consul |
| 存储层 |资源管理 Yarn |资源管理 Yarn |K8s |K8s |K8s |K8s |K8s |K8s |K8s |K8s |实时数据 |平台数据 |分布式调度系统 |
| 存储层 |分布式文件存储 HDFS |分布式文件存储 HDFS |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式消息服务 Kafka |分布式消息服务 Kafka |分布式消息服务 Kafka |分布式消息服务 Kafka |实时数据 |平台数据 |分布式调度系统 || 存储层 |分布式文件存储 HDFS |分布式文件存储 HDFS |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式消息服务 Kafka |分布式消息服务 Kafka |分布式消息服务 Kafka |分布式消息服务 Kafka |实时数据 |平台数据 |Dorado |
| 存储层 |分布式文件存储 HDFS |分布式文件存储 HDFS |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式对象存储 MinIO |分布式消息服务 Kafka |分布式消息服务 Kafka |分布式消息服务 Kafka |分布式消息服务 Kafka |实时数据 |平台数据 |部署与集群系统 |
| 源数据 |文件数据 |关系数据库 |非关系数据库 |数据仓库 |数据仓库 |数据仓库 |数据仓库 |大数据平台 |大数据平台 |API |实时数据 |平台数据 |部署与集群系统 || 源数据 |文件数据 |关系数据库 |非关系数据库 |数据仓库 |数据仓库 |数据仓库 |数据仓库 |大数据平台 |大数据平台 |API |实时数据 |平台数据 |Kubernetes |
ByteHouse — 自研高性能OLAP数据库 	执行优化器
| 自研引擎 | 2 | 1 |  自研ClickHouse优化器方案 |  自研ClickHouse优化器方案 |
|---|---|---|---|---|
| 自研引擎 |2 |1 | 四大优化方向，提供极致优化能力 | 四大优化方向，提供极致优化能力 |
|  HaMergeTree |2 |1 | 四大优化方向，提供极致优化能力 | 四大优化方向，提供极致优化能力 |
|  HaMergeTree |2 |1 | RBO：基于规则优化能力 | RBO：基于规则优化能力 ||  支持高吞吐写入，高并发查询 |2 |1 | RBO：基于规则优化能力 | RBO：基于规则优化能力 |
|  支持高吞吐写入，高并发查询 |2 |1 | CBO：基于代价优化能力 | CBO：基于代价优化能力 |
|  HaUniqueMergeTree |3 |1 | CBO：基于代价优化能力 | CBO：基于代价优化能力 |