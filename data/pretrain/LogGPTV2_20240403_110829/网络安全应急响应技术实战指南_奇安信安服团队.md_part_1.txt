网络空间安全系列规划教材
网络安全应急响应
技术实战指南
奇安信安服团队 著
Publishing House of Electronics Industry
北京·BEIJING
网络安全应急响应技术实战指南
内 容 简 介
2019年，奇安信安服团队出版了《应急响应—网络安全的预防、发现、处置和恢复》科
普图书，旨在提高机构、企业在网络安全应急响应方面的组织建设能力。2020年，我们撰写本
书，旨在借助奇安信安服团队多年来积累的上千起网络安全应急响应事件处置的实战经验，帮
助一线安全人员更加高效、高质量地处置网络安全应急响应事件。本书共10章，第1～3章为
网络安全应急响应工程师需要掌握的基础理论、基础技能和常用工具，第4～10章为当前网络
安全应急响应常见的七大处置场景，分别是勒索病毒、挖矿木马、Webshell、网页篡改、DDoS
攻击、数据泄露和流量劫持网络安全应急响应。通过本书的学习，一线网络安全应急响应工程
师可掌握网络安全应急响应处置思路、技能，以及相关工具的使用，以便实现快速响应的新安
全要求。
本书适合机构、企业的安全运营人员使用，也可作为高校网络安全相关专业学生的培训教材。
未经许可，不得以任何方式复制或抄袭本书之部分或全部内容。
版权所有，侵权必究。
图书在版编目（CIP）数据
网络安全应急响应技术实战指南 / 奇安信安服团队著. —北京：电子工业出版社，2020.11
ISBN 978-7-121-39881-0
Ⅰ. ①网… Ⅱ. ①奇… Ⅲ. ①网络安全－安全技术－指南 Ⅳ. ①TN915.08-62
中国版本图书馆CIP数据核字（2020）第214751号
责任编辑：戴晨辰
印 刷：
装 订：
出版发行：电子工业出版社
北京市海淀区万寿路173信箱 邮编：100036
开 本：720×1 000 1/16 印张：21.75 字数：378千字
版 次：2020年11月第1版
印 次：2020年11月第1次印刷
定 价：89.00元
凡所购买电子工业出版社图书有缺损问题，请向购买书店调换。若书店售缺，请与本社发
行部联系，联系及邮购电话：（010）88254888，88258888。
质量投诉请发邮件至PI:EMAIL，盗版侵权举报请发邮件至PI:EMAIL。
本书咨询联系方式：PI:EMAIL。
I I
第1章
网络安全简史
编委会
顾 问 张翀斌
主 任 张永印 刘 洋
副主任 贾璐璐 裴智勇
编 委
第1章 刘 洋
第2章 苑博林
第3章 苑博林
第4章 李 明 赵 依
第5章 宋 伟 杨 镇
第6章 程 洋 方镇江 王晗潇
第7章 邹基亮 徐金燕
第8章 郭勇智 夏 阳
第9章 李永杰 刘 衡
第10章 钱 昊 黄 伟
III
网络安全应急响应技术实战指南
奇安信安服团队简介
奇安信集团是北京 2022 年冬奥会和冬残奥会官方网络安全服务和杀毒软件
赞助商。作为中国领先的网络安全品牌，奇安信集团多次承担国家级重大活动的
网络安全保障工作，创建了稳定可靠的网络安全服务体系—全维度管控、全网
络防护、全天候运行、全领域覆盖、全兵种协同、全线索闭环。
奇安信安服团队以攻防技术为核心，聚焦威胁检测和响应，通过提供咨询规
划、威胁检测、攻防演习、持续响应、预警通告、安全运营等一系列实战化的服
务，在云端安全大数据的支撑下，为用户提供全周期的安全保障服务。
奇安信安服团队提供的网络安全应急响应服务致力于成为“网络安全120”。
2016 年以来，奇安信安服团队已具备了丰富的网络安全应急响应实践经验，业
务覆盖全国 31 个省（自治区、直辖市），处置机构、企业网络安全应急响应事
件2500多起，累计投入工时30000多小时，为全国超千家机构、企业解决了网
络安全问题。
奇安信安服团队推出网络安全应急响应训练营服务，面向广大机构、企业，
将团队在一线积累的实践经验进行网络安全培训和赋能，帮助机构、企业的安全
管理者、安全运营人员、工程师等不同岗位工作者提高网络安全应急响应能力和
技术水平。奇安信安服团队正在用专业的技术能力保障着用户的网络安全，尽可
能地减少安全事件对用户造成的经济损失，以及对社会造成的恶劣影响。
I V
第1章
网络安全简史
前言
当前，网络空间安全形势日益严峻，国内政府机构、大中型企业的门户网站
和重要核心业务系统常成为攻击者的主要攻击目标。为妥善处置和应对政府机构、
大中型企业关键信息基础设施可能发生的突发事件，确保关键信息基础设施的安
全、稳定、持续运行，防止对相关部门造成重大声誉影响和经济损失，我们需进
一步加强网络安全与信息化应急保障能力。网络安全应急响应服务是安全防护的
最后一道防线，巩固应急防线对安全能力建设至关重要。
2019年，奇安信安服团队出版了《应急响应—网络安全的预防、发现、处
置和恢复》科普图书，旨在提高机构、企业在网络安全应急响应方面的组织建设
能力。2020年，我们撰写本书，旨在借助奇安信安服团队多年来积累的上千起网
络安全应急响应事件处置的实战经验，帮助一线安全人员更加高效、高质量地处
置网络安全应急响应事件。
本书共10章，第1～3章为网络安全应急响应工程师需要掌握的基础理论、
基础技能和常用工具。第1章主要介绍网络安全应急响应基本概念，机构、企业
应具备的网络安全应急响应能力，网络安全应急响应现场处置流程等；第2章主
要介绍网络安全应急响应工程师应具备的基础技能，如进程、服务、文件、日志、
V
网络安全应急响应技术实战指南
流量等的排查方法，通过大量的案例介绍及详细的步骤说明，使初学者也能基本
掌握网络安全应急响应处置工作；第3章主要介绍网络安全应急响应工作中的常
用工具，这些工具可以帮助网络安全应急响应工程师更加高效、全面地查找线索，
确定攻击类型等。
第4～10章为当前网络安全应急响应常见的七大处置场景，分别是勒索病毒、
挖矿木马、Webshell、网页篡改、DDoS攻击、数据泄露和流量劫持网络安全应急
响应。各章首先会介绍场景的攻击原理、技术手法等，使读者初步了解攻击背景；
然后介绍常规处置方法，为网络安全应急响应工作提供一个整体思路；之后再介
绍常用工具和详细技术操作方法，包括确定攻击类型、重点排查内容、排查方法
等；最后通过一些典型处置案例还原处置过程，以便让读者从真实案例中理解、
巩固所学。
在实际的网络安全应急响应处置工作中，我们常会遇到各种各样的问题，上
述的处置方法可以解决绝大多数问题，但也需要具体场景具体分析。例如，在存
在多个攻击团伙、多种攻击形式的场景中，就需要我们综合应用各种方案进行应
急响应。当然，即便是一个单一的安全事件，其处理的思路、排查的先后顺序也
可能有所不同，都需要结合场景的具体业务系统、网络环境、安全设备部署、企
业内部解决目标等多种因素进行处置。因此，一名优秀的网络安全应急响应工程
师需要不断学习、实践、思考、总结，每次事件的处置都将是一次历练。我们希
望通过本书，为广大读者提供一种思路、方法，也希望广大读者能够与我们交流，
共同提高网络安全应急响应能力。
本书的出版要感谢奇安信安服团队张翀斌、张永印、刘洋、贾璐璐、裴智勇、
苑博林、李明、赵依、宋伟、杨镇、程洋、方镇江、王晗潇、邹基亮、徐金燕、
郭勇智、夏阳、李永杰、刘衡、钱昊、黄伟等，还要感谢电子工业出版社戴晨辰
编辑的大力支持，以及其他工作人员的辛勤付出。由于作者水平所限，不妥之处
在所难免，恳请广大网络安全专家、读者朋友批评指正。
作 者
V I
目录
第1章 网络安全应急响应概述··············································································1
1.1 应急响应基本概念···················································································1
1.2 网络安全应急响应基本概念·······································································1
1.3 网络安全应急响应的能力与方法·································································3
1.3.1 机构、企业网络安全应急响应应具备的能力·······································3
1.3.2 PDCERF（6阶段）方法·································································4
1.4 网络安全应急响应现场处置流程·································································6
第2章 网络安全应急响应工程师基础技能·······························································8
2.1 系统排查·······························································································8
2.1.1 系统基本信息···············································································8
2.1.2 用户信息····················································································13
2.1.3 启动项·······················································································20
2.1.4 任务计划····················································································23
2.1.5 其他··························································································26
2.2 进程排查······························································································28
网络安全应急响应技术实战指南
2.3 服务排查······························································································39
2.4 文件痕迹排查························································································41
2.5 日志分析······························································································53
2.6 内存分析······························································································70
2.7 流量分析······························································································77
2.8 威胁情报······························································································83
第3章 常用工具介绍·························································································86
3.1 SysinternalsSuite·····················································································86
3.2 PCHunter/火绒剑/PowerTool······································································87
3.3 Process Monitor······················································································88
3.4 Event Log Explorer··················································································88
3.5 FullEventLogView··················································································89
3.6 Log Parser····························································································90
3.7 ThreatHunting························································································90
3.8 WinPrefetchView····················································································91
3.9 WifiHistoryView·····················································································91
3.10 奇安信应急响应工具箱··········································································92
第4章 勒索病毒网络安全应急响应·······································································95
4.1 勒索病毒概述························································································95
4.1.1 勒索病毒简介··············································································95
4.1.2 常见的勒索病毒···········································································95
4.1.3 勒索病毒利用的常见漏洞····························································103
4.1.4 勒索病毒的解密方法···································································104
4.1.5 勒索病毒的传播方法···································································105
4.1.6 勒索病毒的攻击特点···································································106
4.1.7 勒索病毒的防御方法···································································107
4.2 常规处置方法······················································································110
V III
目 录
4.2.1 隔离被感染的服务器/主机····························································110
4.2.2 排查业务系统············································································111
4.2.3 确定勒索病毒种类，进行溯源分析················································111
4.2.4 恢复数据和业务·········································································111
4.2.5 后续防护建议············································································112
4.3 错误处置方法······················································································112