August 2015
Remote Access, the APT // Ian Latter
51
clientlessTGXf (New, Xmas '14!)
clientlessTGXf (New, Xmas '14!)
• Making good on the ASCII threat
Making good on the ASCII threat
– TGXf is a Transport Protocol at Layer 4
TGXf is a Transport Protocol at Layer 4
– Datagram Protocols at Layer 3 could be;
Datagram Protocols at Layer 3 could be;
• Graphic: Pixels, Images (i.e. F500 logos)
Graphic: Pixels, Images (i.e. F500 logos)
• Text: Letters, Words, Phrases
Text: Letters, Words, Phrases
– clientlessTGXf PoC (published December)
clientlessTGXf PoC (published December)
• Use text letters to enable clientless
Use text letters to enable clientless
• Minimal server side IOCs
Minimal server side IOCs
• Demos futility of QR code detection
Demos futility of QR code detection
August 2015
Remote Access, the APT // Ian Latter
52
clientlessTGXf from BASH
clientlessTGXf from BASH
• POC was tested on this terminal setup;
POC was tested on this terminal setup;
– Monospace Bold font at 16pt, black text on white BG
Monospace Bold font at 16pt, black text on white BG
• About 300 bytes of script (counter+data, FD3)
About 300 bytes of script (counter+data, FD3)
IFS="" ; LANG=C ; c=0 ; while read -s -u 3 -d '' -r -n 1 
IFS="" ; LANG=C ; c=0 ; while read -s -u 3 -d '' -r -n 1 
i ; do  printf -v b "%i" "'$i" ;  echo " $((($c&128)>>7))$
i ; do  printf -v b "%i" "'$i" ;  echo " $((($c&128)>>7))$
((($c&64)>>6))$((($c&32)>>5))$((($c&16)>>4))$
((($c&64)>>6))$((($c&32)>>5))$((($c&16)>>4))$
((($c&8)>>3))$((($c&4)>>2))$((($c&2)>>1))$(($c&1))  $
((($c&8)>>3))$((($c&4)>>2))$((($c&2)>>1))$(($c&1))  $
((($b&128)>>7))$((($b&64)>>6))$((($b&32)>>5))$
((($b&128)>>7))$((($b&64)>>6))$((($b&32)>>5))$
((($b&16)>>4))$((($b&8)>>3))$((($b&4)>>2))$
((($b&16)>>4))$((($b&8)>>3))$((($b&4)>>2))$
((($b&2)>>1))$(($b&1))" ;  ((c++)) ;  (($c==256)) && 
((($b&2)>>1))$(($b&1))" ;  ((c++)) ;  (($c==256)) && 
c=0 ;  sleep 0.005 ; done
c=0 ;  sleep 0.005 ; done
August 2015
Remote Access, the APT // Ian Latter
53
clientlessTGXf & HDMI Capture
clientlessTGXf & HDMI Capture
• Capture (1kbps)
Capture (1kbps)
– HDMI MITM
HDMI MITM
• AverMedia Game 
AverMedia Game 
Capture II (with remote!)
Capture II (with remote!)
• Up to 1920x1080x30fps 
Up to 1920x1080x30fps 
captured to MP4 on 
captured to MP4 on 
USB Mass Storage
USB Mass Storage
• Recovery (100bps)
Recovery (100bps)
– Video Processing
Video Processing
• Data recovered from 
Data recovered from 
MP4 file by Linux 
MP4 file by Linux 
application
application
August 2015
Remote Access, the APT // Ian Latter
54
clientlessTGXf in the Red Room
clientlessTGXf in the Red Room
• USB HDD and Red Room Protocols
USB HDD and Red Room Protocols
– A device can enter
A device can enter
• Must be blanked (except for firmware)
Must be blanked (except for firmware)
• Shouldn't have a problem getting capture 
Shouldn't have a problem getting capture 
equipment into the Red Room
equipment into the Red Room
– A device can leave
A device can leave
• Must be blanked (except for firmware)
Must be blanked (except for firmware)
• Will have a problem bringing back the USB mass 
Will have a problem bringing back the USB mass 
storage with MP4 ..?
storage with MP4 ..?
August 2015
Remote Access, the APT // Ian Latter
55
Hiding USB keys?
Hiding USB keys?
                   Captain Koons says “be creative” ..
Captain Koons says “be creative” ..
August 2015
Remote Access, the APT // Ian Latter
56
clientlessTGXf upload
clientlessTGXf upload
Native 1920x1080 HDMI capture with clientlessTGXf BASH upload
Native 1920x1080 HDMI capture with clientlessTGXf BASH upload
August 2015
Remote Access, the APT // Ian Latter
57
clientlessTGXf download
clientlessTGXf download
Decoding TGXf video stream to disk as original file
Decoding TGXf video stream to disk as original file
August 2015
Remote Access, the APT // Ian Latter
58
TECHNOLOGY SOLUTION 3
TECHNOLOGY SOLUTION 3
Engineering a faster Proof of Concept
Engineering a faster Proof of Concept
August 2015
Remote Access, the APT // Ian Latter
59
highspeedTGXf (New, Today!)
highspeedTGXf (New, Today!)
• Making good on the PIXEL threat
Making good on the PIXEL threat
– TGXf updated Transport Protocol at Layer 4
TGXf updated Transport Protocol at Layer 4
• CRC32 per Frame/Packet
CRC32 per Frame/Packet
– Datagram Protocol at Layer 3 is pixels;
Datagram Protocol at Layer 3 is pixels;
• HTML5 canvas and Javascript
HTML5 canvas and Javascript
– hsTGXf PoC (published today)
hsTGXf PoC (published today)
• Use ~20k of Javascript to enable clientless
Use ~20k of Javascript to enable clientless
• Again, minimal server side IOCs
Again, minimal server side IOCs
• Again, demos futility of targeting a specific 
Again, demos futility of targeting a specific 
implementation
implementation
August 2015
Remote Access, the APT // Ian Latter
60
hsTGXf & HDMI Capture
hsTGXf & HDMI Capture
– HDMI MITM
HDMI MITM
• AverMedia Game Capture II 
AverMedia Game Capture II 
(with remote!)
(with remote!)
• Up to 1280x720x60fps 
Up to 1280x720x60fps 
captured to MP4 on USB 
captured to MP4 on USB 
Mass Storage
Mass Storage
• Demo 1240x650x2fps
Demo 1240x650x2fps
(100,750 bytes per frame)
(100,750 bytes per frame)
• Recovery (per before)
Recovery (per before)
– Video Processing
Video Processing
• Data recovered from MP4 
Data recovered from MP4 
file by Linux application
file by Linux application
• Capture (1.3Mbps @ 2FPS, 1BPP)
Capture (1.3Mbps @ 2FPS, 1BPP)
August 2015
Remote Access, the APT // Ian Latter
61
highspeedTGXf “client”
highspeedTGXf “client”
Uploading the HTML5 and Javascript client via keyboard
Uploading the HTML5 and Javascript client via keyboard
August 2015
Remote Access, the APT // Ian Latter
62
highspeedTGXf upload
highspeedTGXf upload
Native 1280x720 HDMI capture with web browser upload
Native 1280x720 HDMI capture with web browser upload
August 2015
Remote Access, the APT // Ian Latter
63
hsTGXf download
hsTGXf download
Decoding 1.3Mbps TGXf video stream to disk as original file
Decoding 1.3Mbps TGXf video stream to disk as original file
August 2015
Remote Access, the APT // Ian Latter
64
hsTGXf & HDMI Capture
hsTGXf & HDMI Capture
– HDMI MITM
HDMI MITM
• Black Magic Design 
Black Magic Design 
DeckLink Mini Recorder
DeckLink Mini Recorder
• Up to 1280x720x60fps 
Up to 1280x720x60fps 
captured to local SATA 
captured to local SATA 
HDD
HDD
• Demo 1240x650x8fps
Demo 1240x650x8fps
(100,750 bytes per frame)
(100,750 bytes per frame)
• Recovery (per before)
Recovery (per before)
– Video Processing
Video Processing
• Data recovered from AVI file 
Data recovered from AVI file 
(YUV) by Linux application
(YUV) by Linux application
• Capture (4.7Mbps @ 8FPS, 1BPP)
Capture (4.7Mbps @ 8FPS, 1BPP)
August 2015
Remote Access, the APT // Ian Latter
65
hsTGXf download
hsTGXf download
Decoding 4.7Mbps TGXf video stream to disk as original file
Decoding 4.7Mbps TGXf video stream to disk as original file
August 2015
Remote Access, the APT // Ian Latter
66
Architecture
Architecture
Back to the impact on Enterprise Architecture
Back to the impact on Enterprise Architecture
August 2015
Remote Access, the APT // Ian Latter
67
Architectural Analysis
Architectural Analysis
• Human versus Machine?
Human versus Machine?
– Leaving out the PPP example, no variation in 
Leaving out the PPP example, no variation in 
access was granted to the user.
access was granted to the user.
• TCXf can only type and read what the user can.
TCXf can only type and read what the user can.
– The distinct properties of delta seem to be;
The distinct properties of delta seem to be;
• Volume
Volume: transfer rate in bits per second or number 
: transfer rate in bits per second or number 
of bits at rest, and;
of bits at rest, and;
• Accuracy
Accuracy: of data transferred or stored, and;
: of data transferred or stored, and;
• Structure
Structure: of the data transferred, and;
: of the data transferred, and;
• Utility
Utility: of the over-arching capability.
: of the over-arching capability.
August 2015
Remote Access, the APT // Ian Latter
68
The Problem? Legal ..
The Problem? Legal ..
• Use -v- Disclosure, Off-shore (Australian Privacy Act)
Use -v- Disclosure, Off-shore (Australian Privacy Act)
• An Australian organisation (APP entity) that holds personal 
An Australian organisation (APP entity) that holds personal 
information 
information 6.6
6.6, and makes that personal information available for 
, and makes that personal information available for 
use 
use 6.8
6.8 but not disclosure 
 but not disclosure 6.11(b)
6.11(b) to an overseas recipient 
 to an overseas recipient 8.5
8.5 is 
 is 
accountable 
accountable 8.1
8.1 for ensuring that the overseas recipient does not 
 for ensuring that the overseas recipient does not 
breach the Australian Privacy Principles 
breach the Australian Privacy Principles 8.2
8.2. . Personal information is 
Personal information is 
disclosed when the Australian organisation releases the 
disclosed when the Australian organisation releases the 
subsequent handling of the information from its effective control 
subsequent handling of the information from its effective control 8.8
8.8, , 
which includes disclosure through unauthorised access, if it did not 
which includes disclosure through unauthorised access, if it did not 
take reasonable steps to protect the personal information from 
take reasonable steps to protect the personal information from 
unauthorised access 
unauthorised access 8.10
8.10.. The reasonable steps include 
 The reasonable steps include 
implementing strategies to manage, amongst other things, ICT 
implementing strategies to manage, amongst other things, ICT 
Security, data breaches and regular monitoring and review 
Security, data breaches and regular monitoring and review 11.8
11.8..
• But what's a reasonable monitoring step?
But what's a reasonable monitoring step?
August 2015
Remote Access, the APT // Ian Latter
69
History – Lampson, 1973
History – Lampson, 1973
• ““A note on the Confinement Problem”
A note on the Confinement Problem”
• Enforcement: The supervisor must ensure that a 
Enforcement: The supervisor must ensure that a 
confined program's input to covert channels 
confined program's input to covert channels 
conforms to the caller's specifications. This may 
conforms to the caller's specifications. This may 
require slowing the program down, generating 
require slowing the program down, generating 
spurious disk references, or whatever, but it is 
spurious disk references, or whatever, but it is 
conceptually straightforward. The cost of 
conceptually straightforward. The cost of 
enforcement may be high. 
enforcement may be high. A cheaper alternative (if 
A cheaper alternative (if 
the customer is willing to accept some amount of 
the customer is willing to accept some amount of 
leakage) is to bound the capacity of the covert 
leakage) is to bound the capacity of the covert 
channels.
channels.
August 2015
Remote Access, the APT // Ian Latter
70
History – DoD 1983-2002 (1/4)
History – DoD 1983-2002 (1/4)
• ““Trusted Computer Security Evaluation 
Trusted Computer Security Evaluation 
Criteria (TCSEC)”
Criteria (TCSEC)”
– Covert storage channels and Covert timing 
Covert storage channels and Covert timing 
channels in B2 and B3
channels in B2 and B3
• Content comes almost directly from Lampson
Content comes almost directly from Lampson
• Two key points – performance and the acceptable 
Two key points – performance and the acceptable 
thresh-holds (“not permissible” versus “auditable”)
thresh-holds (“not permissible” versus “auditable”)
August 2015
Remote Access, the APT // Ian Latter
71
History – DoD 1983-2002 (2/4)
History – DoD 1983-2002 (2/4)
• Performance
Performance
• A covert channel bandwidth that exceeds a rate of one 
A covert channel bandwidth that exceeds a rate of one 
hundred (100) bits per second is 
hundred (100) bits per second is considered “high” 
considered “high” 
because 100 bits per second is the approximate rate at 
because 100 bits per second is the approximate rate at 
which many computer terminals are run
which many computer terminals are run. It does not seem 
. It does not seem 
appropriate to call a computer system “secure” if 
appropriate to call a computer system “secure” if 
information can be compromised at a rate equal to the 
information can be compromised at a rate equal to the 
normal output rate of some commonly used device.
normal output rate of some commonly used device.
– Take note!
Take note!
• TGXf v1f1 = 80bps; TGXf v1f2 = 160bps;
TGXf v1f1 = 80bps; TGXf v1f2 = 160bps;
BASH TGXf example = v1f5
BASH TGXf example = v1f5
• HDMI = 1080 x 1920 x 24bit x 24fps 
HDMI = 1080 x 1920 x 24bit x 24fps 
= 150MBps (> 1Gbps)
= 150MBps (> 1Gbps)
August 2015
Remote Access, the APT // Ian Latter
72
History – DoD 1983-2002 (3/4)
History – DoD 1983-2002 (3/4)
• Acceptability
Acceptability
• In any multilevel computer system there are a number of 
In any multilevel computer system there are a number of 
relatively low-bandwidth covert channels whose existence 
relatively low-bandwidth covert channels whose existence 
is deeply ingrained in the system design. Faced with the 
is deeply ingrained in the system design. Faced with the 
large potential cost of reducing the bandwidths of such 
large potential cost of reducing the bandwidths of such 
covert channels, it is felt that those with 
covert channels, it is felt that those with maximum 
maximum 
bandwidths of less than one (1) bit per second are 
bandwidths of less than one (1) bit per second are 
acceptable
acceptable in most application environments. Though 
 in most application environments. Though 
maintaining acceptable performance in some systems 
maintaining acceptable performance in some systems 
may make it 
may make it impractical to eliminate all covert channels 
impractical to eliminate all covert channels 
with bandwidths of 1 or more bits per second
with bandwidths of 1 or more bits per second, it is 
, it is 
possible to 
possible to audit their use
audit their use without adversely affecting 
 without adversely affecting 
systems performance.
systems performance.
August 2015
Remote Access, the APT // Ian Latter
73
History – DoD 1983-2002 (4/4)
History – DoD 1983-2002 (4/4)
• Acceptability (cont)
Acceptability (cont)
• This audit capability provides the system 
This audit capability provides the system 
administration with a means of detecting – and 
administration with a means of detecting – and 
procedurally correcting – significant compromise. 
procedurally correcting – significant compromise. 
Therefore, a Trusted Computing Base should 
Therefore, a Trusted Computing Base should 
provide, wherever possible, the 
provide, wherever possible, the capability to audit 
capability to audit 
the use of covert channel mechanisms with 
the use of covert channel mechanisms with 
bandwidths that may exceed a rate of one (1) bit in 
bandwidths that may exceed a rate of one (1) bit in 
ten (10) seconds.
ten (10) seconds.
August 2015
Remote Access, the APT // Ian Latter
74
Punch-line – Use and Off-shore
Punch-line – Use and Off-shore
• The new equilibrium ..
The new equilibrium ..
– Use –v– Disclosure (HIPAA, FISMA, etc)
Use –v– Disclosure (HIPAA, FISMA, etc)
• Are functionally identical (Display = Upload)
Are functionally identical (Display = Upload)
• There is no pragmatic difference
There is no pragmatic difference
– Off-shoring / Right-Sourcing / Best-shoring
Off-shoring / Right-Sourcing / Best-shoring
• .. as the short-form for “remote access for un/semi-
.. as the short-form for “remote access for un/semi-
trusted users to access sensitive data on shore” ..
trusted users to access sensitive data on shore” ..
• .. if you like your data to be yours alone ..
.. if you like your data to be yours alone ..
• Is not currently, and is unlikely to ever be, “safe”
Is not currently, and is unlikely to ever be, “safe”
– How many bps data loss is "too many" to accept?
How many bps data loss is "too many" to accept?
August 2015
Remote Access, the APT // Ian Latter
75
Thank-you!
Thank-you!
– Thanks to DefCon
Thanks to DefCon
– Thanks to my wife and daughter
Thanks to my wife and daughter
– ThruGlassXfer
ThruGlassXfer
– Information site:
Information site:
http://thruglassxfer.com/
http://thruglassxfer.com/
– Project site:
Project site:
http://midnightcode.org/projects/TGXf/
http://midnightcode.org/projects/TGXf/
– Contact me:
Contact me:
PI:EMAIL
PI:EMAIL
(If you’re talking to me on social media, it’s not me)
(If you’re talking to me on social media, it’s not me)