netpackage,24–25,197
Netcat,40–44
net.Conn,35
net/httpstandardpackage,46,48
New()helperfunction,53–54
NewProperties()function,72–73
NewRequest()function,48
Nmap,225
nonconcurrentscanning,25–26
NoSQLdatabases,154,158
NTLANManager(NTLM)authentication,150–151
NTLMSecuritySupportProvider(NTLMSSP),133–135
NTOWFv2,148
numtransform,214
O
obfuscation,307
OfficeOpenXMLdocuments,69
offsetfieldtag,140
offsetvalues,300
omitempty,62
openports,22
OPSEC,329
OptionalHeader,284–285
Oracle,154
ospackage,197
os/execpackage,41
P
packages,2,8–9
packetcapturingandfiltering,175–180
panic()function,107,112
parseTags()function,140–142
passivereconnaissance,51,59
pass-the-hashauthentication,147–150
passwords,146–151,222–224
PATCHrequests,47
payloads,101,302–307
pcap,175
PDFfiles,69
PE(PortableExecutable)format,279–289
PipeReader,43
PipeWriter,43
PKCS(PublicKeyCryptographyStandards),242.Seealso
public-keycryptography
pkgdirectory,2–3
placeholders,83,89
Plan9operatingsystem,216
plug-ins
Lua,225–232
native,218–224
pluginpackage,219
PNGformat,296–307
pointers,12
PortableExecutable(PE)format,279–289
PortableNetworkGraphics(PNG)images,296–307
ports
availability,24–25
handshakeprocess,22
portforwarding,23,39–40
portscanners,180–185,222–224
scanning,23–32.Seealsoscanners
Post()function,46–47
PostForm()function,47
Postgresdatabases,156–157,160–161
PostgreSQLdatabases,156–157,160–161
PreProcessImage()function,298
primitivedatatypes,10–11
process()function,72–73
ProcessHacker,278
processinjection,268–269
ProcessMonitor,278
ProcessImage()method,302–303
procselfmem()function,205
projectstructure,52–53,60
promiscvariable,177
ProtocolBuffers(Protobuf),316
PsExec,131
public-keycryptography,242,245.Seealsoencryption
PUTrequests,47–48
Python,197–201
Q
queryparameters,73–76
R
raceconditionfunctions,206
Rapid7,60
RATs(remoteaccessTrojans),315–329
rawtransform,215
RC2,252–261
ReadString()function,38
reconnaissance,51,59
redirectors,98
referentialfields,138–139
reflectpackage,139
reflection,132,139
regularexpression(regex)values,163
remoteaccessTrojans(RATs),315–329
remoteprocedurecalls(RPCs),59,64–67,316
request/responsecycles,46,62–64
responsehandling,48–51
Rivest,Ron,252
RLock,129
Roundcube,90
routers,79–80,84–85
rstpackets,22
S
salts,234
scannerpackage,220,223
scanners,23–32,180–185,217,222–224.Seealsoports
schema-lessdatabases,154
scrapingmetadata,68–76
Search()function,163
searchquerytemplates,73–76
SectionTable,287–289
securitytokens,133–134
send()method,65
serveFile()function,97
ServerMessageBlock(SMB),132–147
servermultiplexers,78–79
ServerMux,78–79
SessionList()method,66,68
setcommand,3
SHA-256hashes,236–237
shellcode,203–204,213–216
Shodan,51–59
signaturevalidation,245–248
sitefilter,73
slices,11,106,126,144–145
SQLinjectionfuzzing,192–196
SQLitedatabases,328
srcdirectory,3
statelessprotocols,46
staticfiles,93
Statusstruct,50–51
steganography
overview,295
PNGformat,296–307
XOR,307–312
strconvpackage,25
strlen()function,17
strToInt()method,304
structs
APIInfostruct,55
Clientstruct,53–54
encoding,135
Foostruct,19
handling,142–143
Msgstruct,106–107
Statusstruct,50–51
typesof,12–13,19,133–135
structureddata,18–19,50–51
Stub,281
subdirectories,2–3
subdomains,107–117
switchstatements,14,129,143
switchednetworks,178
symmetricalgorithms,234
symmetric-keyencryption,242–245.Seealsoencryption
SYNcookies,180–185
synpackets,22
syn-acks,22
SYN-floodprotections,180–185
syscallpackage,197,266–269
Syscall6()function,210
T
tabwriterpackage,113–114
Targetbreach,154
TCPflags,180–181
tcpdump,102,105,175–178
TCP/IPGuide(Kozierok),22
teamservers,121
Telegram,280
Telnet,41
templates,88–90
Tenable,217
third-partypackages,8–9
tokens,61–63,271
“toofast”scanner,26–27
TourofGotutorial,10
TransmissionControlProtocol(TCP)
handshakeprocess,22–23
portscanners,23–32
proxies,32–44
U
UbuntuVM,118–120
uint16datatypes,143–144
uintptrtype,266
unicodepackage,197
unmarshal()function,141–142
Unmarshal()method,19
unmarshalinginterfaces,136
unsafepackage,197
unsafe.Pointertype,266–267
USERproperty,190
utilityprograms,67–68
V
{{variable-name}}convention,89
verbs,47
Vimtexteditor,3–4
vim-goplug-in,3
virtualmachines(VMs),118–120
virtualmemory,273–274
VirtualAllocEx,273–274
VirtualFreeEx()Windowsfunction,277–278
VMWareWorkstation,118–120
VSCode,5
vulnerabilityfuzzers,188–196
W
WaitforSingleObject()Windowsfunction,276–277
waitForWrite()function,206
WaitGroup,27–28
walkFn()function,171
WebSocketAPI(WebSockets),93–98
whileloops,15
WindowsAPIs,263–265
WindowsDLL,218–219
WindowsVM,127
winmodsfiles,270
WINNT.Hheader,285–286
Wireshark,102,225
workerfunctions,28–30,111–112
wrapperfunctions,136–137
WriteData()function,305–307,311
WriteProcessMemory()function,274–275
writer.Flush()function,38
WriteString()function,38
X
XML,19–20,69
XOR,307–312
BlackHatGoissetinNewBaskerville,Futura,Dogma,and
TheSansMonoCondensed.
UPDATES
Visithttps://nostarch.com/blackhatgo/forupdates,errata,
andotherinformation.
Moreno-nonsensebooksfrom
NOSTARCH
PRESS
REAL-WORLDBUGHUNTING
AFieldGuidetoWebHacking
byPETERYAWORSKI
JULY2019,264PP.,$39.95
ISBN978-1-59327-861-8
MALWAREDATASCIENCE
AttackDetectionandAttribution
byJOSHUASAXE
withHILLARYSANDERS
SEPTEMBER2018,272PP.,$49.95
ISBN978-1-59327-859-5
LINUXBASICSFORHACKERS
GettingStartedwithNetworking,Scripting,and
SecurityinKali
byOCCUPYTHEWEB
DECEMBER2018,248PP.,$34.95
ISBN978-1-59327-855-7
SERIOUSCRYPTOGRAPHY
APracticalIntroductiontoModernEncryption
byJEAN-PHILIPPEAUMASSON
NOVEMBER2017,312PP.,$49.95
ISBN978-1-59327-826-7
GRAYHATC#
AHacker’sGuidetoCreatingandAutomating
SecurityTools
byBRANDONPERRY
JUNE2017,304PP.,$39.95
ISBN978-1-59327-759-8
PENTESTINGAZUREAPPLICATIONS
TheDefinitiveGuidetoTestingandSecuring
Deployments
byMATTBURROUGH
JULY2018,216PP.,$39.95
ISBN978-1-59327-863-2
PHONE:
1.800.420.7240OR
1.415.863.9900
EMAIL:
PI:EMAIL
WEB:
WWW.NOSTARCH.COM
“Everythingnecessarytogetstartedwith
Godevelopmentinthesecurityspace”
—HDMoore,FounderoftheMetasploit
ProjectandtheCriticalResearch
Corporation
BlackHatGoexploresthedarkersideofGo,thepopular
programminglanguagereveredbyhackersforitssimplicity,
efficiency,andreliability.Itprovidesanarsenalofpractical
tacticsfromtheperspectiveofsecuritypractitionersand
hackerstohelpyoutestyoursystems,buildandautomate
toolstofityourneeds,andimproveyouroffensivesecurity
skillset,allusingthepowerofGo.
You’llbeginyourjourneywithabasicoverviewofGo’s
syntaxandphilosophyandstarttoexploreexamplesthatyou
canleveragefortooldevelopment,includingcommonnetwork
protocolslikeHTTP,DNS,andSMB.You’llthendiginto
varioustacticsandproblemsthatpenetrationtestersencounter,
addressingthingslikedatapilfering,packetsniffing,and
exploitdevelopment.You’llcreatedynamic,pluggabletools
beforedivingintocryptography,attackingMicrosoft
Windows,andimplementingsteganography.
You’lllearnhowto:
Makeperformanttoolsthatcanbeusedforyourown
securityprojects
CreateusabletoolsthatinteractwithremoteAPIs
ScrapearbitraryHTMLdata
UseGo’sstandardpackage,net/http,forbuildingHTTP
servers
WriteyourownDNSserverandproxy
UseDNStunnelingtoestablishaC2channeloutofa
restrictivenetwork
Createavulnerabilityfuzzertodiscoveranapplication’s
securityweaknesses
Useplug-insandextensionstofuture-proofproducts
BuildanRC2symmetric-keybrute-forcer
ImplantdatawithinaPortableNetworkGraphics(PNG)
image.
Areyoureadytoaddtoyourarsenalofsecuritytools?Then
let’sGo!
ABOUTTHEAUTHORS
TomSteele,ChrisPatten,andDanKottmannshareover30
yearsinpenetrationtestingandoffensivesecurityexperience,
andhavedeliveredmultipleGotraininganddevelopment
sessions.(Seeinsideformoredetails.)
THEFINESTINGEEKENTERTAINMENT™
www.nostarch.com
FOOTNOTES
CHAPTER2.TCP,SCANNERS,AND
PROXIES
CHAPTER3.HTTPCLIENTSAND
REMOTEINTERACTIONWITH
TOOLS
CHAPTER5.EXPLOITINGDNS
CHAPTER9.WRITINGAND
PORTINGEXPLOITCODE
CHAPTER11.IMPLEMENTINGAND
ATTACKINGCRYPTOGRAPHY
1.ThisisafreeserviceprovidedbyFyodor,thecreatorofNmap,butwhenyou’rescanning,bepolite.
Herequests,“Trynottohammerontheservertoohard.Afewscansinadayisfine,butdon’tscan100
timesaday.”
1.Forassistanceandpracticewithexploitation,considerdownloadingandrunningtheMetasploitable
virtualimage,whichcontainsseveralexploitableflawsusefulfortrainingpurposes.
1.Goversions1.9andnewercontainaconcurrent-safetype,sync.Map,thatmaybeusedtosimplify
yourcode.
1.Formoredetailedinformationaboutthisvulnerability,referto
https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-
application-have-in-common-this-vulnerability/#jboss.
1.Someoperatingmodes,suchasGalois/CounterMode(GCM),provideintegrityassurance.