In this approach, we ﬁrst partition all signals into disjoint,
contiguous time windows. Then we perform the KL anal-
ysis for each window by ﬁnding the eigenvectors of the
process-noise using only the non-Trojan signals. Then we
project the non-Trojan signals on to these eigenvectors and
determine the mean µ and the standard deviation σ of the
spectrum for each eigenvector. To check whether any given
signal belongs to a genuine IC or an IC with Trojan, we
ﬁnd its eigenvalue spectrum by projecting it on the process-
noise eigenvectors. If the eigenvalue spectrum is outside the
µ ± 4σ envelope for any eigenvector and for any time win-
dow, then we make the assertion that the signal is coming
from an IC with Trojan. Likewise, if the whole spectrum
stays inside the µ ± 4σ envelope for all time windows, then
we make the assertion that the signal is coming from a gen-
uine IC (see Figure 14).
Using this statistical approach, we tested 49 ICs with
Trojan using 70 time windows and achieved 100% success
rate in detecting them as Trojan. We also tested 49 genuine
ICs using the same 70 time windows and only one of them
l
i
)
s
a
n
g
s
9
4
r
e
v
o
%
j
n
a
o
r
T
e
s
a
F
/
e
u
r
T
l
(
e
t
a
R
n
o
i
t
c
e
t
e
D
100
90
80
70
60
50
40
30
20
10
0
True Positive Rate
False Positive Rate
10
20
30
40
Window
50
60
70
Figure 15. Percentage rates of true (blue or
black) and false (green or grey) Trojan de-
tection over adjacent time-windows, Experi-
ment 4: Approach 1.
Figure 16. Experiment 4, Approach 2: Filter-
ing and using only the data in low process
noise regions.
5.4.2 Approach 2. Filtering the Signals and Focusing
on Low Noise Regions
Another idea for Trojan detection for such high process-
noise is to go back to the original KL analysis and focus on
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007x 10−7
+4 sigma
2
1.5
1
0.5
0
−0.5
−1
−1.5
−2
Eigenvalues
x 10−7
1.5
1
0.5
0
−0.5
−1
−1.5
− 4 sigma
False Positive
32
34
36
38
40
42
44
46
48
36
38
40
42
44
46
48
Figure 14. Eigenvalue spectrums of genuine (green or grey) and Trojan (red or dark grey) ICs with µ+
i × σ envelopes in black (left ﬁgure). False Trojan detection (right ﬁgure). Experiment 4: Approach 1.
the regions that have lower process-noise (see Figures 16
and 17). Note that unlike the earlier case described in
Section 2.1, where in low noise regions the Trojan over-
whelmed the process noise, in this case, it is the other way
around—process noise is overwhelming. However, in the
KL analysis, we are able to obtain a clear separation be-
tween the eigenvalue spectrums of the signals from the gen-
uine and Trojan ICs at multiple eigenvectors.
In particu-
lar, Figure 18 shows that for our experiments the eigenvalue
spectrums of the genuine ICs and ICs with Trojans stand
apart on the eigenvectors 43, 46 and 48.
x 10−4
1.5
1
0.5
)
W
0
(
r
e
w
o
P
−0.5
−1
−1.5
0
10
20
30
Selected Sample Points
40
50
60
Figure 17. Process noise (green or grey) and
Trojan signal (blue or black) observed in low
noise regions, Experiment 4: Approach 2.
x 10−6
s
n
o
i
t
c
e
o
r
P
j
r
e
w
o
P
6
4
2
0
−2
−4
−6
−8
Trojans
Genuine
32
34
36
38
40
42
44
46
48
Eigenvectors
Figure 18. KL Analysis at low noise regions,
Experiment 4: Approach 2.
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 20076. Conclusions
References
In this paper, we demonstrated the feasibility of building
effective ﬁngerprints for an IC family to detect Trojan ICs.
We designed and synthesized an RSA circuit and three dif-
ferent Trojan circuits. We used the power traces obtained
from the simulations of these circuits to built the IC ﬁnger-
prints. We modeled three sets of process variations by creat-
ing random variations (up to ±2%, ±5% and ±7.5%) in the
cell libraries that were used to synthesize the designs. In all
cases, fairly simple analysis of the power signals could dis-
tinguish genuine ICs from those containing Trojan circuits
down to 0.01% of the size of the main circuit.
We showed that in general it is difﬁcult to hide signal
distortions introduced by a Trojan circuit as a Trojan cir-
cuit leaks signal in signal subspaces that are not present in
genuine ICs. For many Trojans, these subspaces are easy
to ﬁnd, for example, the signal from a Trojan circuit may
leak when the rest of the circuit is not active. We showed
that even when Trojan signal is well-hidden within the vari-
ations of the signals generated by the process-noise, it can
be detected by signal processing techniques.
As discussed in the introduction, we believe that even
an adversary with general knowledge of this ﬁngerprinting
technique will incur great difﬁculty and cost in manufactur-
ing a Trojan that can survive these tests since, apriori, the
adversary doesn’t know the side-channels or the parame-
ters of the testing process (e.g. clock frequency) being con-
sidered. Furthermore, side-channels such as EM, consist
of multiple sub-channels due to spatial and non-linear ef-
fects [22, 11, 3], and the full characterization of the Trojan
signal and the process noise can only become clear when
the ICs get manufactured. Thus the adversary has a difﬁcult
task of designing a Trojan circuit that would not leak in any
of the side channels for any of the test parameters.
For our future work, we would like to make two improve-
ments to the methodology presented in this paper. First, in-
stead of working with simulated ICs, we would like to work
with real fabricated ICs. Second, we would like to work
with much larger ICs to cover general purpose micropro-
cessor architectures. Both of these improvements require
a signiﬁcant investment of capital. A goal of this research
work was to convince ourselves (and our sponsors) that the
approach of using signal processing techniques has a po-
tential to detect minute Trojan circuits without resorting to
destructive testing.
We also plan to widen the scope of our study to include
more side-channels, speciﬁcally EM emissions, to pick up
the localized spatial distortions introduced by a Trojan cir-
cuit and also explore other signal processing techniques to
evaluate their relative efﬁcacy in detecting Trojan ICs.
[1] Website.
DARPA BAA06-40, TRUST for
In-
tegrated Circuits. http://www.darpa.mil/BAA/
BAA06-40mod1.html.
[2] Advanced encryption standard (AES). Website, Nov
2001. http://csrc.nist.gov/publications/
fips/fips197/fips-197.pdf.
[3] Dakshi Agrawal, Bruce Archambeault, Josyula R.
Rao, and Pankaj Rohatgi. The EM side-channel(s).
In B. S. Kaliski Jr., C¸ . K. Koc¸, and C. Paar, edi-
tors, Cryptographic Hardware and Embedded Systems
- CHES 2002, volume 2523 of Lecture Notes in Com-
puter Science, pages 29–45. Springer Verlag.
[4] Boaz Barak, Oded Goldreich, Russell Impagliazzo,
Steven Rudich, Amit Sahai, Salil P. Vadhan, and
Ke Yang. On the (im)possibility of obfuscating pro-
grams.
In J. Kilian, editor, CRYPTO 2001, volume
2139 of Lecture Notes in Computer Science, pages 1–
18. Springer.
[5] I. Baturone, J. Huertas, S. S´anchez-Solano, and
A. Richardson. Supply current monitoring for test-
ing CMOS analog circuits.
In Proc. XI Conference
on Design of Circuits and Integrated Systems (DCIS),
Sitges, pages 231–236, 1996.
[6] Dan Boneh, Richard A. DeMillo, and Richard J. Lip-
ton. On the importance of checking cryptographic
protocols for faults.
In W. Fumy, editor, Advances
in Cryptology - EUROCRYPT ’97, volume 1233 of
Lecture Notes in Computer Science, pages 37–51.
Springer Verlag, 1997.
[7] Suresh Chari, Josyula R. Rao, and Pankaj Rohatgi.
Template attacks. In B. S. Kaliski Jr., C¸ . K. Koc¸, and
C. Paar, editors, Cryptographic Hardware and Embed-
ded Systems - CHES 2002, volume 2523 of Lecture
Notes in Computer Science, pages 12–28. Springer
Verlag, 2002.
[8] S. Devadas and S. Malik. A survey of optimization
techniques targeting low power VLSI circuits. In Pro-
ceedings of the 32nd ACM/IEEE Conference on De-
sign Automation, pages 242–247, 1995.
[9] Defense Science Board Task Force.
High per-
formance microchip supply. Website, Feburary
2005. http://www.acq.osd.mil/dsb/reports/
2005-02-HPMS_Report_Final.pdf.
[10] K. Fukunaga.
Introduction to Statistical Pattern
Recognition. Academic, New York, 1990.
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007[11] Karine Gandolﬁ, Christophe Mourtel, and Francis
Olivier. Electromagnetic analysis: Concrete results. In
C¸ . K. Koc¸, D. Naccache, and C. Paar, editors, CHES
2001, volume 2162 of Lecture Notes in Computer Sci-
ence, pages 251–261. Springer.
[12] Blaise Gassend, Dwaine E. Clarke, Marten van Dijk,
and Srinivas Devadas. Silicon physical random func-
tions. In V. Atluri, editor, ACM Conference on Com-
puter and Communications Security, pages 148–160.
ACM, 2002.
[13] Amy Germida, Zheng Yan, James F. Plusquellic, and
Fidel Muradali. Defect detection using power supply
transient signal analysis. In International Test Confer-
ence, pages 67–76, September 1999.
[14] Shaﬁ Goldwasser and Yael Tauman Kalai. On the
impossibility of obfuscation with auxiliary input. In
FOCS, pages 553–562. IEEE Computer Society, 2005.
[15] C. F. Hawkins, J. M. Soden, R. R. Fritzemeter, and
L. K. Horning. Quiescent power supply current mea-
surement for CMOS IC defect detection. In Proceed-
ings of IEEE Transactions On Industrial Electronics,
pages 211–218, 1989.
[16] Paul C. Kocher.
Timing attacks on implementa-
tions of difﬁe-hellman, rsa, dss, and other systems.
In N. Koblitz, editor, CRYPTO 1996, volume 1109
of Lecture Notes in Computer Science, pp 104–113.
Springer.
[17] Paul C. Kocher, Joshua Jaffe, and Benjamin Jun. Dif-
ferential power analysis.
In M. J. Wiener, editor,
CRYPTO 1999, volume 1666 of Lecture Notes in
Computer Science, pages 388–397. Springer.
[18] Jung Youp Lee, Seok Won Jung, and Jongin Lim.
Detecting trapdoors in smart cards using timing and
power analysis.
In F. Khendek and R. Dssouli, edi-
tors, Proceedings of TestCom 2005, volume 3502 of
Lecture Notes in Computer Science, pages 275–288.
Springer Verlag.
[19] Joseph I. Lieberman. White paper: National se-
curity aspects of the global migration of the U.S.
semiconductor
June 2003.
http://lieberman.senate.gov/documents/
whitepapers/semiconductor.pdf.
industry.
Website,
[22] Jean-Jacques Quisquater and David Samyde. Elec-
tromagnetic analysis (EMA): Measures and counter-
measures for smart cards. In I. Attali and T. P. Jensen,
editors, E-smart 2001, Proceedings, volume 2140 of
Lecture Notes in Computer Science, pages 200–210.
Springer Verlag.
[23] Christian Rechberger and Elisabeth Oswald. Practical
template attacks. In C. H. Lim and M. Yung, editors,
Information Security Applications, 5th International
Workshop, WISA 2004, Revised Papers, volume 3325
of Lecture Notes in Computer Science, pages 443–
457. Springer Verlag.
[24] R. L. Rivest, A. Shamir, and L. Adleman.
A
Method for Obtaining Digital Signatures and Public-
Key Cryptosystems. Communications of the ACM,
21(2):120–126, February 1978.
[25] Synopsys Inc. Design Compiler User Guide, version
2002.05 edition, Jun 2002.
[26] Synopsys Inc. Prime Power Manual, version 2002.05
edition, Sep 2002.
[27] Synopsys Inc. Library Compiler Reference Manual:
Technology and Symbol Libraries, version x-2005.09
edition, December 2005. This volume provides infor-
mation on synthesis, test, and power tools.
[28] H. L. Van Trees. Detection, Estimation, and Modula-
tion Theory, Part I. John Wiley & Sons, New York,
1968.
[29] Hoeteck Wee. On obfuscating point functions.
In
Harold N. Gabow and Ronald Fagin, editors, STOC,
pages 523–532. ACM, 2005.
A. RSA circuit block diagram
OPERAND
MEMORY
MODULUS
MEMORY
EXPONENT
MEMORY
B{i]
A{i]
  

  

  

  

  

  

 
