基于机器学习与大数据的
智能运维平台
表一：项目基本情况表
表二：项目完成情况表
2020 年9 月28 日星期一
1
证券期货科学技术奖励推荐书
表 1：项目基本情况表
一、项目基本情况
中 文 基于机器学习与大数据的智能运维平台
项
目
名
称
英 文 AIOps Platform based on machine learning and big data
AIOps；机器学习；大数据；
主 题 词 成果类别 技术推广应用
搜索存储引擎
任务来源 自选项目
计划(基金)
名称和编号
项目起止时间 起始：2017年12月5 日 完成：2018年8月23日
2
二、项目简介
1、项目名称：基于机器学习与大数据的智能运维平台
2、项目所属科学技术领域：AIOps、机器学习、大数据、搜索存储引擎
3、主要内容简介：
2016年Gartner 提出AIOps，即通过 AI以及大数据来提升运维水平，我司经过与多家
券商、银行、互联网机构进行访谈交流，发现在 2017 年互联网已经有多家机构开始实践
AIOps，而在券商行业仍然停留在探索阶段，鲜有成熟的落地案例。
2017 年我们完成了统一监控平台、大数据平台、云平台等平台的优化建设，为实施
AIOps 提供了必要条件，同年，我们启动了智能运维平台建设项目，该项目建设的核心目
的是通过对运行、运维数据的深度挖掘来提升现有的运维水平，同时探索实践智能运维在
证券行业落地实施路径、实施方案、实施场景。
针对证券行业系统可用性、连续性要求极高的特点，我们选取了实时异常监测、故障
定位以及可能原因分析作为建设方向，在项目建设中我们通过与顶尖高校以及一流数据处
理厂商进行深度合作，共同攻坚，完成了我司智能运维平台的建设上线。
该平台以应用为视角通过对应用系统业务数据、运行数据、工单数据进行深度挖掘形
成关键运行指标以及系统画像，结合无监督智能算法对应用的健康状态、运行状况进行深
度实时监测；在发现异常之后会自动触发相关多指标的异常定位以及日志的异常分析,整个
过程在分钟级别可以完成，有效得帮助运维人员分析深度发现系统潜在问题，及时修复，
而在故障之后可以大幅度缩短故障定位以及原因分析时间，从而提升系统的可用性以及
RTO水平。
平台的核心技术为数据的处理、搜索存储以及智能运维算法，通过对比国内外相关典
型产品与技术并结合我们落地的实际效果检验，该平台在这几项技术上均处于领先地位。
在2018年我司智能运维平台参与了上海证券交易所“基于大数据与机器学习的证券行业智
能运维体系建设”研究课题。我们以该课题为抓手，通过与行业交流，不断引入新的合作
伙伴，打磨优化平台，使得我司智能运维平台的架构和功能日趋完善。最终，我司在同类
课题中评分排名第一，被评选为优秀课题，为 AIOps 在证券行业的落地提供了很强的参考
以及推广价值。
（纸面不敷，可另增页）
3
三、 项目详细内容
1、 立项背景
券商作为最先实现电子化的金融机构之一，通过 30 多年的发展，已经积累了大量稳
态业务系统软硬件基础架构运维的数据及经验，而随着市场竞争加剧，要求券商响应业务
快速迭代发展的需要，在双态 IT 运维环境中，如何持续保证业务系统的安全稳定高效地
运行，给券商 IT 运维团队带来了极大挑战。2016 年 Gartner 提出 AIOps，即运用机器学
习算法深度挖掘分析运行数据价值赋能监管控运维体系，这为提升运维水平提供了新的思
路、新的方法。
经过与多家券商、银行、互联网机构进行了访谈交流，我们发现金融行业仍然停留在
探索阶段，鲜有成熟的落地案例，分析原因主要有两个：首先是基础平台特别是监管控以
及大数据平台建设不完善，而这些是实施 AIOps的必要基础；另外一个原因是缺少力量或
者环境进行算法研究以及落地运用，金融 IT 行业中鲜有算法人才，而科研机构往往缺少
运维数据以及运维经验。我司 2017 年完成了云平台、监控平台、大数据等平台的优化升
级，具备了实施 AIOPs 的必要条件，在 2017 年初我们开始自己研究相关算法在指标异常
检测以及容量预测方面的运用，并且取得了一些效果，同年我们引进了合作伙伴，国内一
家顶级高校与一家一流数据处理厂商，针对证券行业系统可用性、连续性要求极高的特点，
我们选取了实时异常监测、故障定位以及可能原因分析作为建设方向，目的是通过智能运
维平台的建设，一方面赋能监管控运维体系提升运维效率以及系统可用性、RTO 水平；另
外一方面探索金融行业可以落地、可以复制的智能运维体系建设实施路径。
经过与合作伙伴近一年的努力攻关，在 2018 年上线了以业务健康状态全链路实时监
测与异常诊断为核心的智能运维平台，该平台的上线大幅度提升了运维团队保障系统安全
稳定性的能力，同时我们也将实际的建设经验以及建设成果通过会议交流以及科技期刊发
表的形式进行了分享，为推动 AIOps在金融行业的落地发展贡献了我们自己的力量。
（纸面不敷，可另增页）
4
2、 详细科学技术内容
本次项目涉及到的科技内容主要分为两大部分：
AIOps 智能运维全景化应用
 基于无监督学习技术的单指标异常检测技术
 海量机器指标智能异常定位技术
 基于自然语言处理技术的日志聚类和日志异常定位
 智能运维知识图谱
运维数据工厂
 海量全种类运维数据集中收集与存储
 运维指标数据的实时分析与计算
 可编程式检索与分析
 数据安全设计
2.1 AIOps 智能运维全景化应用
2.1.1 基于无监督学习技术的单指标异常检测技术
基于无监督学习技术的单指标异常检测技术是指通过对业务日志统计数据、抓包统
计数据或者机器指标数据等数据的采集，对时间间隔固定，具有时序特征或周期特征的
时间数据进行检测。此检测技术首先对其曲线特征进行描述, 对不同特征的指标进行训
练并形成模型,其中关注的特征包括：
 时间序列周期
 向上或者向下的趋势特性
 周期偏移情况等再通过以下变分自编码器
 渐进梯度回归树
 差分指数滑动平均等算法
5
2.1.2 海量机器指标智能异常定位技术
指标的异常定位算法是通过上述的单指标异常检测触发，利用 PageRank算法，快速
定位出目前产生的大面积业务系统故障中的根因系统，并且将所有系统按照根因疑似率
进行排序。能够帮助运维人员快速定位需要排查的真正故障系统，加快排障时间。从实
时调用关系和时序指标数据出发，并结合报警数据分析构造出故障传播图并找出根因。
2.1.3 基于自然语言处理技术的日志聚类和日志异常定位技术
构建可动态添加分支的频繁项前缀树结构，准确从日志消息中提取日志所代表的事
件，支持增量式学习，高效地将日志消息映射到模板上，从而应对日志规模巨大、设备
变更后产生新类型日志、日志结构复杂且多样带来的挑战。
通过日志异常检测机制，能够准确、高效地解析日志，且自动、准确地检测数据中
心各种型号设备或应用的多语法语义的单条异常日志和异常日志序列，主动发现设备或
应用的异常以及时采取应对措施，从而提高数据中心的稳定性，针对基于监控指标时序
数据的异常检测无法获知异常根因的问题，本系统基于日志自动、准确地对数据中心设
备或应用进行异常检测，以便于后续的异常定位和根因分析。
6
2.1.4 智能运维知识图谱
以指标异常检测和指标异常定位技术为基础，构建专注于运维领域的知识图谱，将
故障领域内的知识通过 CMDB 技术和一些机器学习的技术抽象化，构建成图谱。有效的
实现不同系统、层级相互之间的数据调度、算法编排、模型管理等，使系统更具平台性
及扩展性。
2.2 运维数据工厂
运维数据工厂负责数据的接入，处理，存储，明细数据流如下图所示：
从左至右依次为数据接入、数据总线、数据计算以及数据的存储。
数据接入，提供的数据采集，根据数据来源的不同进行有代理和无代理方式采集。
在该层建设采集中心，需要实现采集策略的定制下发、采集代理的管理、采集延迟、补
采的处理。数据总线层，该层主要提供数据的缓存与处理，数据进入到消息总线（例如
Kafka）之后，进行数据的 ETL处理，过滤、切分、扩展等操作，处理之后的数据进入再
一次进入 Kafka 集群进行流式计算,实时计算采用 SparkStream 架，离线运算采用 Spark
跑批处理。
数据计算层，实时计算例如指标的异常、日志关键字等实时告警功能，离线数据例
如数据的基线、预测等，而离线计算主要是定期进行跑批训练数据模型，如日志提取模
式，单指标异常检测模型等。
数据存储层，是根据运用场景和数据的不同进行不同的存储方式，日志数据会存储
到Beaver，性能数据存储到时序数据库 InfluxDB，关系存储到关系型数据库(如MySQL)，
复杂的关系，图形等存储到图形数据库（如 Neo4j），历史数据等存储到 HDFS，计算模
型存储到MongoDB 等。
基于每个模块都可横向扩展的架构设计，整体吞吐量以及性能都可以随着节点增多
而线性提升。
7
2.2.1 海量全种类运维数据集中收集与存储
日志采集模块采用高可用、高可靠、分布式的海量日志采集、聚合和传输的架构，
支持在日志系统中定制各类数据发送方，用于收集数据，同时提供对数据进行简单处理
功能。完成对证券信息系统的日志整体对接，支持对业务系统、数据库、中间件、服务
器、网络设备、安全设备日志采集，并支持各种格式的数据（文本、XML、数据、事件、
消息、专有格式等任何数据）。采集模块满足数据的真实性、安全性及完整性，防篡改、
支持加密传输，限制日志上报占用带宽、指定时间传输数据、压缩传输、采集频率等，