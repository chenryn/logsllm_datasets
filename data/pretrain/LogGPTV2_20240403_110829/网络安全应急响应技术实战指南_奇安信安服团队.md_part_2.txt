4.4 常用工具····························································································113
4.4.1 勒索病毒查询工具······································································113
4.4.2 日志分析工具············································································117
4.5 技术操作指南······················································································119
4.5.1 初步预判··················································································120
4.5.2 临时处置··················································································126
4.5.3 系统排查··················································································127
4.5.4 日志排查··················································································135
4.5.5 网络流量排查············································································139
4.5.6 清除加固··················································································139
4.6 典型处置案例······················································································140
4.6.1 服务器感染GlobeImposter 勒索病毒··············································140
4.6.2 服务器感染Crysis勒索病毒·························································145
第5章 挖矿木马网络安全应急响应·····································································150
5.1 挖矿木马概述······················································································150
5.1.1 挖矿木马简介············································································150
5.1.2 常见的挖矿木马·········································································150
5.1.3 挖矿木马的传播方法···································································153
5.1.4 挖矿木马利用的常见漏洞····························································154
5.2 常规处置方法······················································································155
5.2.1 隔离被感染的服务器/主机····························································155
IX
网络安全应急响应技术实战指南
5.2.2 确认挖矿进程············································································156
5.2.3 挖矿木马清除············································································156
5.2.4 挖矿木马防范············································································157
5.3 常用工具····························································································158
5.3.1 ProcessExplorer··········································································158
5.3.2 PCHunter··················································································160
5.4 技术操作指南······················································································162
5.4.1 初步预判··················································································162
5.4.2 系统排查··················································································165
5.4.3 日志排查··················································································176
5.4.4 清除加固··················································································178
5.5 典型处置案例······················································································179
5.5.1 Windows服务器感染挖矿木马······················································179
5.5.2 Linux服务器感染挖矿木马···························································183
第6章 Webshell网络安全应急响应·····································································188
6.1 Webshell概述·····················································································188
6.1.1 Webshell分类···········································································188
6.1.2 Webshell用途···········································································189
6.1.3 Webshell检测方法·····································································190
6.1.4 Webshell防御方法·····································································190
6.2 常规处置方法······················································································191
6.2.1 入侵时间确定············································································191
6.2.2 Web日志分析···········································································192
6.2.3 漏洞分析··················································································192
6.2.4 漏洞复现··················································································192
6.2.5 漏洞修复··················································································193
6.3 常用工具····························································································194
X
目 录
6.3.1 扫描工具··················································································194
6.3.2 抓包工具··················································································195
6.4 技术操作指南······················································································195
6.4.1 初步预判··················································································196
6.4.2 Webshell排查···········································································198
6.4.3 Web日志分析···········································································199
6.4.4 系统排查··················································································202
6.4.5 日志排查··················································································218
6.4.6 网络流量排查············································································221
6.4.7 清除加固··················································································223
6.5 典型处置案例······················································································224
6.5.1 网站后台登录页面被篡改····························································224
6.5.2 Linux系统网站服务器被植入Webshell···········································229
6.5.3 Windows系统网站服务器被植入Webshell·······································235
第7章 网页篡改网络安全应急响应·····································································238
7.1 网页篡改概述······················································································238
7.1.1 网页篡改事件分类······································································238
7.1.2 网页篡改原因············································································239
7.1.3 网页篡改攻击手法······································································240
7.1.4 网页篡改检测技术······································································240
7.1.5 网页篡改防御方法······································································241
7.1.6 网页篡改管理制度······································································241
7.2 常规处置方法······················································································242
7.2.1 隔离被感染的服务器/主机····························································242
7.2.2 排查业务系统············································································242
7.2.3 确定漏洞源头、溯源分析····························································243
7.2.4 恢复数据和业务·········································································243
XI
网络安全应急响应技术实战指南
7.2.5 后续防护建议············································································243
7.3 错误处置方法······················································································243
7.4 常用工具····························································································244
7.5 技术操作指南······················································································244
7.5.1 初步预判··················································································244
7.5.2 系统排查··················································································245
7.5.3 日志排查··················································································247
7.5.4 网络流量排查············································································249
7.5.5 清除加固··················································································249
7.6 典型处置案例······················································································249
7.6.1 内部系统主页被篡改···································································249
7.6.2 网站首页被植入暗链···································································252
第8章 DDoS攻击网络安全应急响应··································································257
8.1 DDOS攻击概述···················································································257
8.1.1 DDoS攻击简介·········································································257
8.1.2 DDoS攻击目的·········································································257
8.1.3 常见DDoS攻击方法···································································258
8.1.4 DDoS攻击中的一些误区·····························································266
8.1.5 DDoS攻击防御方法···································································267
8.2 常规处置方法······················································································268
8.2.1 判断DDoS攻击的类型································································268
8.2.2 采取措施缓解············································································269
8.2.3 溯源分析··················································································269
8.2.4 后续防护建议············································································269
8.3 技术操作指南······················································································269
8.3.1 初步预判··················································································269
8.3.2 问题排查··················································································272
X II
目 录
8.3.3 临时处置方法············································································272
8.3.4 研判溯源··················································································273
8.3.5 清除加固··················································································273
8.4 典型处置案例······················································································273
第9章 数据泄露网络安全应急响应·····································································275
9.1 数据泄露概述······················································································275
9.1.1 数据泄露简介············································································275
9.1.2 数据泄露途径············································································275
9.1.3 数据泄露防范············································································277
9.2 常规处置方法······················································································277
9.2.1 发现数据泄露············································································277
9.2.2 梳理基本情况············································································278
9.2.3 判断泄露途径············································································278
9.2.4 数据泄露处置············································································278
9.3 常用工具····························································································279
9.3.1 Hawkeye··················································································279
9.3.2 Sysmon····················································································283
9.4 技术操作指南······················································································287
9.4.1 初步研判··················································································287
9.4.2 确定排查范围和目标···································································288
9.4.3 建立策略··················································································289
9.4.4 系统排查··················································································290
9.5 典型处置案例······················································································291
9.5.1 Web服务器数据泄露··································································291
9.5.2 Web应用系统数据泄露·······························································295
第10章 流量劫持网络安全应急响应···································································303
10.1 流量劫持概述····················································································303
XIII
网络安全应急响应技术实战指南
10.1.1 流量劫持简介...................................................................................................303
10.1.2 常见流量劫持...................................................................................................303
10.1.3 常见攻击场景...................................................................................................311
10.1.4 流量劫持防御方法...........................................................................................313
10.2 常规处置方法····················································································313
10.2.1 DNS劫持处置..................................................................................................313
10.2.2 HTTP劫持处置................................................................................................314
10.2.3 链路层劫持处置...............................................................................................314
10.3 常用命令及工具·················································································315
10.3.1 nslookup命令...................................................................................................315
10.3.2 dig命令............................................................................................................317
10.3.3 traceroute命令..................................................................................................319
10.3.4 Wireshark工具.................................................................................................319
10.3.5 流量嗅探工具...................................................................................................320
10.4 技术操作指南····················································································321
10.4.1 初步预判...........................................................................................................321
10.4.2 DNS劫持排查..................................................................................................322
10.4.3 HTTP劫持排查................................................................................................327
10.4.4 TCP劫持排查..................................................................................................328
10.4.5 ARP劫持排查..................................................................................................329
10.5 典型处置案例····················································································330
10.5.1 网络恶意流量劫持...........................................................................................330
10.5.2 网站恶意跳转...................................................................................................331
10.5.3 网站搜索引擎劫持····································································332
X IV
第 1 章
网络安全应急响应概述
1.1 应急响应基本概念
应急响应，其英文是Incident Response或Emergency Response，通常是指一
个组织为了应对各种意外事件的发生所做的准备，以及在事件发生后所采取的措
施。其目的是减少突发事件造成的损失，包括人民群众的生命、财产损失，国家
和企业的经济损失，以及相应的社会不良影响等。
应急响应所处理的问题，通常为突发公共事件或突发的重大安全事件。通过
执行由政府或组织推出的针对各种突发公共事件而设立的应急方案，使损失降到
最低。应急方案是一项复杂而体系化的突发事件处置方案，包括预案管理、应急
行动方案、组织管理、信息管理等环节。其相关执行主体包括应急响应相关责任
单位、应急响应指挥人员、应急响应工作实施组织、事件发生当事人。
为防范化解重特大安全风险，健全公共安全体系，整合优化应急响应力量和资
源，推动形成统一指挥、专常兼备、反应灵敏、上下联动、平战结合的中国特色应
急响应管理体制，提高防灾、减灾、救灾能力，确保人民群众生命财产安全和社会
稳定，2018年3月，中华人民共和国应急管理部正式设立，其主要职责包括：组织