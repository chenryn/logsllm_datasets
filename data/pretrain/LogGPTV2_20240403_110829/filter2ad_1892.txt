title:Traffic Behaviour Characterization Using NetMate
author:Annie De Montigny-Leboeuf and
Mathieu Couture and
Fr&apos;ed&apos;eric Massicotte
Traffic Behaviour Characterization Using NetMate 
Annie De Montigny-Leboeuf, Mathieu Couture, and Frederic Massicotte 
Communications Research Centre Canada (CRC) , Ottawa, ON, Canada 
{annie.demontigny-leboeuf, mathieu.couture, 
frederic.massicotte}@crc.gc.ca 
Abstract. Previous studies have shown the feasibility of deriving simple indica-
tors of file transfers, human-interactivity, and other important behavioural char-
acteristics. We are proposing a practical implementation and use of such indica-
tors with NetMate. In its current state as a work in progress, our extended ver-
sion  of  NetMate  will  already  be  of  interest  to  network  security  practitioners 
conducting incident analysis.  The tool can be used to post-process traffic traces 
containing suspicious flows in order to obtain a behavioural description of the 
incident  and  surrounding  traffic  activities.  With  further  development,  the  ap-
proach has great potential for other use cases such as intrusion detection, insider 
threat detection, and traffic classification.   
The majority of current network  monitoring tools rely on  well-known port numbers 
and/or payload analysis to identify the network applications. While payload analysis 
is more reliable than port numbers, decoding is not always possible due to encryption 
or obfuscation, for instance. 
Previous research studies have shown that classifying network traffic according to 
flow  behaviour  is  feasible  and  promising  [1][2][3][4].    Despite  relevant  studies,  we 
are not aware of traffic characterization solutions of this type being used in practice 
by network security professionals.  
Our  proposed  implementation  is  designed  with  practitioners  in  mind.  Installation 
and  use  are  simple  and  similar  to  other  common  packet  processing  tools  such  as 
tcpdump and snort. The output is intuitive and can shed light on traffic activities un-
der investigation. 
This implementation is based on [4], in which the flow features (metrics) have dis-
criminative power and also provide insight into the traffic behaviour. The set of flow 
features, inspired by the the  work of Paxson [5], includes indicators of  interactivity 
(human  control),  conversation,  transaction,  data  transfer,  and  many  other  important 
behavioural  characteristics.  The  analysis  is  confined  to  headers  at  the  network  and 
transport layers and thereby does not depend on access to payload. 
We are extending NetMate [6], an existing open-source packet processing frame-
work. NetMate includes two types of modules: Packet Processing Modules designed 
to implement different metrics, and Export  Modules that implement different output 
formats. Our flow features are being implemented in Packet Processing Modules, and 
our  rule  engine  that  describes  and  recognizes  the  flows  is  being  implemented  as  an 
Export Module. 
E. Kirda, S. Jha, and D. Balzarotti (Eds.): RAID 2009, LNCS 5758, pp. 367–368, 2009. 
© Springer-Verlag Berlin Heidelberg 2009 
368 
A. De Montigny-Leboeuf, M. Couture, and F. Massicotte 
Our Export Module compares the measured flow metrics against a configurable set 
of rules, which are stored in files. When NetMate is configured to use our new mod-
ules and set of rules, the output file it produces consists of one line per flow (i.e. per 
TCP/UDP 5-tuple session).  Here is a sample output: 
yyyy-mm-dd hh:mm:ss, 4, 6, xx.xx.xx.xx, yy.yy.yy.yy, 
35573, 22, directional-bkwd, persistent, human-
keystroke-fwd, no-bulk-transfer, free-transmitrate, 
blockcipher-encrypted, , , , , , ssh, , , , , , , , ,  
Two  different  types  of  rules  are  used  to  produce  the  output:  description  rules  and 
recognition rules. In the example above, the description rules produce the portion of 
the output in underlined characters, while the text in italics is due to the recognition 
rules. In this example, one and only one of the protocol-profiles, ssh, matched.  The 
first portion of the output is simply composed of the date, time, and the flow key (IP 
version, proto ID, IP addresses, and port numbers). 
Current  State  and  Future  Work.  We  need  to  evaluate  performance  on  streaming 
traffic.  We  also  need  to  evaluate  the  detection  rates  and  false  positive  rates  of  the 
rules  implemented  to  date.  These  rules  come  from  [4]  and  have  been  implemented 
following their original specifications, which were derived manually. The use of ma-
chine-learning techniques [1][2][3] to derive recognition and description rules will be 
considered in future work. The description rules currently implemented provide sen-
sible and insightful overview of the traffic activities.  We believe that the description 
capability  provides  in  itself  much  added  value.  While  the  implemented  recognition 
rules attempt to identify protocols, these rules can also be defined to recognize gen-
eral types of traffic of interest to an analyst.  
Despite its early development stage, we believe that our current version, as is, can 
be useful to security analysts in the context of supporting network incident analysis.  
We  are  therefore  working  on  the  first  release  of  our  extended  NetMate,  which  we 
expect will be available by September 2009.   
References 
1.  Kim,  H.,  Claffy,  K.,  Fomenkov,  M.,  Barman,  D.,  Faloutos,  M.,  Lee,  K.:  Internet  Traffic 
Classification Demystified: Myths, Caveats, and Best Practices. In: ACM CoNEXT (2008) 
2.  Alshammari,  R.,  Zincir-Heywood,  A.N.:  A  preliminary  Performance  Comparison  of  Two 
Feature Sets for Encrypted Traffic Classification. In: IEEE CISIS (2008) 
3.  Williams,  N.,  Zander,  S.,  Anmitage,  G.:  A  preliminary  Performance  comparison  of  Five 
Machine  Learning  Algorithms  for  Practical  IP  Traffic  Flow  Classification.  ACM  SIG-
COMM CCR 36(5) (2006) 
4.  De Montigny-Leboeuf, A.: Flow Attributes for Use in Traffic Characterization., CRC Tech-
nical Note CRC-TN-2005-003 (2005) 
5.  Zhang, Y., Paxson, V.: Detecting Backdoors. In: USENIX Security Symposium (2000) 
6.  NetMate,  http://www.ip-measurement.org/tools/netmate/  (last  accessed 
June 2009)