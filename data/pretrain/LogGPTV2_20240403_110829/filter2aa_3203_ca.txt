of RADIUS attributes in the connection request. Based on a set of authorization rules and the 
information in the user account database, the RADIUS server either authenticates and authorizes the 
connection and sends back a RADIUS Access-Accept message or, if either authentication or 
authorization fails, sends back a RADIUS Access-Reject message. The RADIUS Access-Accept 
message can contain connection restrictions that the access server enforces for the duration of the 
connection. 
The Network Policy Server (NPS) component of Windows Server 2008 and the Internet Authentication 
Service (IAS) component of Windows Server 2003 are industry-standard RADIUS servers. 
User Account Databases 
A user account database is a list of user accounts and their properties that a RADIUS server can check 
to verify authentication credentials and to obtain user account properties that contain information about 
authorization and connection parameters. 
NPS and IAS can use the local Security Accounts Manager (SAM), a domain based on Microsoft 
Windows NT 4.0 operating systems, or Active Directory as a user account database. For Active 
Directory, NPS and IAS can provide authentication and authorization for user or computer accounts in 
the domain of which the IAS server is a member, two-way trusted domains, and trusted forests with 
domain controllers running Windows Server 2008 or Windows Server 2003. 
If the user accounts for authentication reside in a different type of database, you can use a RADIUS 
proxy to forward the authentication request to a RADIUS server that does have access to the user 
account database.  
Chapter 14 – Virtual Private Networking 
TCP/IP Fundamentals for Microsoft Windows  
Page: 427 
RADIUS Proxies 
A RADIUS proxy routes RADIUS connection requests and accounting messages between RADIUS 
clients (or other RADIUS proxies) and RADIUS servers (or other RADIUS proxies). A RADIUS proxy 
uses information within the RADIUS message to route it to the appropriate RADIUS client or server. 
You can use a RADIUS proxy as a forwarding point for RADIUS messages when AAA must occur at 
multiple RADIUS servers in different organizations. 
With the RADIUS proxy, the definition of RADIUS client and RADIUS server becomes blurred. A 
RADIUS client to a RADIUS proxy can be an access server (that originates connection request or 
accounting messages) or another RADIUS proxy. There can be multiple RADIUS proxies between the 
originating RADIUS client and the final RADIUS server using chained RADIUS proxies. In a similar way, 
a RADIUS server to a RADIUS proxy can be the final RADIUS server (which performs the 
authentication and authorization evaluation) or another RADIUS proxy. Therefore, from a RADIUS 
proxy perspective, a RADIUS client is the RADIUS entity from which the proxy receives RADIUS 
request messages, and a RADIUS server is the RADIUS entity to which the proxy forwards RADIUS 
request messages. 
The NPS component of Windows Server 2008 and the IAS component of Windows Server 2003 are 
industry-standard RADIUS proxies. 
NPS or IAS as a RADIUS Server 
You can use NPS or IAS as a RADIUS server to perform AAA for RADIUS clients. A RADIUS client can 
be either an access server or a RADIUS proxy. Figure 14-11 shows NPS or IAS as a RADIUS server. 
Figure 14-11  NPS or IAS as a RADIUS server 
Chapter 14 – Virtual Private Networking 
TCP/IP Fundamentals for Microsoft Windows  
Page: 428 
The access server and the RADIUS proxy exchange RADIUS messages with the NPS or IAS server. 
NPS or IAS uses a secure communications channel to communicate with an Active Directory domain 
controller. 
When NPS or IAS is used as a RADIUS server, it provides the following: 
A central authentication and authorization service for all access requests that RADIUS clients and 
RADIUS proxies send. 
NPS or IAS uses an Active Directory–based domain or the local SAM to authenticate user 
credentials for a connection attempt. NPS uses the dial-in properties of the account and network 
policies to authorize a connection and enforce connection constraints. IAS uses the dial-in 
properties of the account and remote access policies to authorize a connection and enforce 
connection constraints. 
A central accounting recording service for all accounting requests that RADIUS clients send. 
For Windows Server 2008 or Windows Server 2003, accounting requests are stored in a local log 
file or sent to a structured query language (SQL) server database for analysis. 
You can use NPS or IAS as a RADIUS server in the following circumstances: 
You use a Active Directory–based domain or the local SAM as your user account database for access 
clients.  
You use Routing and Remote Access in Windows Server 2008 or Windows Server 2003 on multiple 
dial-up servers, VPN servers, or site-to-site routers and you want to centralize both the configuration of 
remote access policies and the accounting of connection information.  
You outsource your dial-up, VPN, or wireless access to a service provider. The access servers use 
RADIUS to authenticate and authorize connections that members of your organization make.  
You want to centralize AAA for a heterogeneous set of access servers.  
To send RADIUS messages to an NPS or IAS-based RADIUS server, you must configure your access 
servers or RADIUS proxies to use the NPS or IAS server as their RADIUS server. To receive RADIUS 
messages from access servers or RADIUS proxies, you must configure the NPS or IAS server with 
RADIUS clients. For example, if your VPN server is using NPS or IAS servers for RADIUS 
authentication or accounting, you must do the following:  
Configure the VPN server with RADIUS servers that correspond to the NPS or IAS servers. 
Configure the NPS or IAS servers with a RADIUS client that corresponds to the VPN server. 
To install NPS on a computer running Windows Server 2008, do the following: 
1. Click Start, point to Programs, point to Administrative Tools, and then click Server Manager. 
2. In the console tree, right-click Roles, click Add Roles, and then click Next. 
3. On the Select Server Roles page, select the Network Policy and Access Services check box, and 
then click Next. 
4. Follow the pages of the Add Roles wizard. 
To install IAS on a computer running Windows Server 2003, do the following: 
Chapter 14 – Virtual Private Networking 
TCP/IP Fundamentals for Microsoft Windows  
Page: 429 
1. Click Start, click Control Panel, and then double-click Add or Remove Programs. 
2. Click Add/Remove Windows Components. 
3. In the Windows Components Wizard dialog box, click Networking Services, and then click 
Details. 
4. In the Networking Services dialog box, select the Internet Authentication Service check box, click 
OK, and then click Next. 
5. If prompted, insert the Windows Server 2003 product disk. 
6. After IAS is installed, click Finish, and then click Close. 
To create a RADIUS client on an NPS server, do the following: 
1. Click Start, click Control Panel, double-click Administrative Tools, and then double-click Network 
Policy Server.  
2. In the tree, open RADIUS Clients and Server, right-click RADIUS Clients, and then click New 
RADIUS Client.  
To create a RADIUS client on an IAS server, do the following: 
3. Click Start, click Control Panel, double-click Administrative Tools, and then double-click Internet 
Authentication Service.  
4. In the tree, right-click RADIUS Clients, and then click New RADIUS Client.  
The New RADIUS Client Wizard will guide you through creating and configuring a RADIUS client.  
Network and Remote Access Policies 
For a connection attempt to be accepted, it must be both authenticated and authorized. Authentication 
verifies the credentials of the access client. Authorization verifies that the connection attempt is allowed 
and is granted on the basis of account dial-in properties and either network policies (for NPS) or remote 
access policies (for IAS). Network and remote access policies are an ordered set of rules that define 
how connections are either authorized or rejected. Each rule has one or more conditions, a set of profile 
settings, and a setting for network or remote access permission. 
When a connection is authorized, the settings of the network or remote access policy can specify a set 
of connection restrictions. The dial-in properties of the account also provide a set of restrictions. Where 
applicable, connection restrictions from the account properties override those from the network or 
remote access policy. 
Network or Remote Access Policy Conditions and Restrictions 
Before authorizing the connection, network or remote access policies can validate a number of 
connection settings, including the following: 
Group membership  
Type of connection  
Time of day  
Authentication method  
Chapter 14 – Virtual Private Networking 
TCP/IP Fundamentals for Microsoft Windows  
Page: 430 
Identity of the access server  
After authorizing the connection, network or remote access policies can specify connection restrictions, 
including the following: 
Idle timeout time  
Maximum session time  
Encryption strength  
Authentication method 
IPv4 packet filters  
For example, you can have policies that specify different maximum session times for different types of 
connections or groups. Additionally, you can have policies that specify restricted access for business 
partners or vendors. 
You can configure network or remote access policies either from the VPN server computer, if it is not 
configured to use RADIUS, or from the NPS or IAS server computer.  
NPS or IAS as a RADIUS Proxy 
You can use NPS or IAS as a RADIUS proxy to route RADIUS messages between RADIUS clients 
(access servers) and RADIUS servers that perform AAA for the connection attempt. When you use 
NPA or IAS as a RADIUS proxy, NPS or IAS acts as a central switching or routing point through which 
RADIUS access and accounting messages flow. NPS or IAS records information in an accounting log 
about the messages that it forwards. Figure 14-12 shows NPS or IAS as a RADIUS proxy. 
Chapter 14 – Virtual Private Networking 
TCP/IP Fundamentals for Microsoft Windows  
Page: 431 
Figure 14-12  NPS or IAS as a RADIUS proxy 
Connection Request Processing 
To determine whether a RADIUS client message should be processed locally or forwarded to another 
RADIUS server, an NPS server running Windows Server 2008 or an IAS server running Windows 
Server 2003 uses the following: 
Connection request policies  
For any incoming RADIUS request message, connection request policies determine whether the 
NPS or IAS server processes the message locally or forwards it to another RADIUS server. 
Connection request policies are rules that specify conditions and profile settings, which give you 
flexibility to configure how the NPS or IAS server handles incoming authentication and accounting 
request messages. With connection request policies, you can create a series of policies so that an 
NPS or IAS server processes some RADIUS request messages locally (acting as a RADIUS 
server) and forwards other types of messages to another RADIUS server (acting as a RADIUS 
proxy). 
Remote RADIUS server groups  
When an NPS or IAS server forwards RADIUS messages, remote RADIUS server groups specify 
the set of RADIUS servers to which the server forwards the messages. A remote RADIUS server 
group is a named group that contains one or more RADIUS servers. When you configure a 
connection request policy to forward RADIUS traffic, you must specify a remote RADIUS server 
group. This group facilitates the common configuration of both a primary and a secondary RADIUS 
server. You can specify various settings either to determine the order in which the servers are used 
or to distribute the RADIUS messages across all servers in the group. 
In Windows Server 2008, you can configure connection request policies from the Policies node and 
remote RADIUS server groups from the RADIUS Clients and Servers folder in the Network Policy 
Server snap-in. 
In Windows Server 2003, you can configure connection request policies and remote RADIUS server 
groups from the Connection Request Processing folder in the Internet Authentication Service snap-in. 
Chapter 14 – Virtual Private Networking 
TCP/IP Fundamentals for Microsoft Windows  
Page: 432 
Chapter Summary 
The chapter includes the following pieces of key information: 
A virtual private network (VPN) extends a private network to encompass links across shared or public 
networks like the Internet. With authentication, encapsulation, and encryption, you can use a VPN 
connection to send data between two computers across a shared or public internetwork in a manner 
that emulates the properties of a point-to-point private link. 
A remote access VPN connection connects a single client computer to a private network across a 
public or shared network. Either a default route or a set of routes that summarize the addresses of the 
private intranet facilitates routing for remote access VPN connections. 
A site-to-site VPN connection connects two portions of a private network across a public or shared 
network. A set of routes associated with the demand-dial interfaces that represent the point-to-point 
VPN connection facilitates routing for site-to-site VPN connections. 
Windows Vista, Windows XP, Windows Server 2008, and Windows Server 2003 support both a VPN 
client and a VPN server for remote access VPN connections. A computer running Windows Server 
2008 or Windows Server 2003 can act as a calling or answering router in a site-to-site VPN connection. 
RADIUS is a standard protocol that you can use for authorization, authentication, and accounting of 
network access, including VPN connections. NPS in Windows Server 2008 and IAS in Windows 
Server 2003 are the Microsoft implementations of a RADIUS server and proxy. 
NPS uses network policies and IAS uses remote access policies to determine authorization of network 
access. 
Both NPS and IAS use connection request policies to determine whether the server should process an 
incoming RADIUS request message locally or forward it to another RADIUS server. 
Chapter 14 – Virtual Private Networking 
TCP/IP Fundamentals for Microsoft Windows  
Page: 433 
Chapter Glossary 
access client – A network device that requires access to a network or another part of the network. 
access server – A network device that provides access to a network. An access server that uses a 
RADIUS server for authentication, authorization, and accounting is also a RADIUS client. 
answering router – The router that answers the demand-dial connection attempt (the VPN server). 
calling router – The router that initiates the demand-dial connection (the VPN client). 
Layer Two Tunneling Protocol (L2TP) – A VPN tunneling protocol that uses UDP and an L2TP header 
to encapsulate PPP frames sent across an IPv4 network. 
Point-to-Point Protocol (PPP) – An industry standard suite of protocols for the use of point-to-point links 
to transport multiprotocol packets. 
Point-to-Point Tunneling Protocol (PPTP) – A VPN tunneling protocol that uses a TCP connection for 
tunnel maintenance and a Generic Routing Encapsulation (GRE) header to encapsulate PPP frames. 
RADIUS – See Remote Authentication Dial-In User Service (RADIUS). 
RADIUS proxy – A RADIUS-capable device that routes RADIUS connection requests and accounting 
messages between RADIUS clients (and RADIUS proxies) and RADIUS servers (and RADIUS 
proxies). 
RADIUS server – A server that receives and processes connection requests or accounting messages 
sent by RADIUS clients or RADIUS proxies. 
remote access VPN connection – A VPN connection that connects a single client computer to a private 
network across a public or shared network. 
Remote Authentication Dial-In User Service (RADIUS) – An industry standard protocol that you can use 
to send messages between access servers, RADIUS servers, and RADIUS proxies to provide 
authentication, authorization, and accounting (AAA) of network access. 
Secure Socket Tunneling Protocol (SSTP) – A VPN tunneling protocol that uses a HyperText Transfer 
Protocol (HTTP) over Secure Sockets Layer (SSL) session and an SSTP header to encapsulate PPP 
frames. 
site-to-site VPN connection – A VPN connection that connects two portions of a private network 
together across a public or shared network. 
user account database – A list of user accounts and their properties that a RADIUS server can check to 
verify authentication credentials and obtain user account properties that contain information about 
authorization and connection parameters. 
virtual private network (VPN) – The extension of a private network that encompasses encapsulated, 
encrypted, and authenticated links across shared or public networks. VPN connections can provide 
remote access and routed connections to private networks over a public or shared network, such as the 
Internet. 
VPN – See virtual private network (VPN). 
VPN client – A computer that initiates a connection to a VPN server. 
Chapter 14 – Virtual Private Networking 
TCP/IP Fundamentals for Microsoft Windows  
Page: 434 
VPN server – A computer that accepts virtual private network (VPN) connections from VPN clients. A 
VPN server can provide a remote access or a site-to-site VPN connection. 
Chapter 15 – IPv6 Transition Technologies 
TCP/IP Fundamentals for Microsoft Windows  
Page: 435 
Chapter 15 – IPv6 Transition Technologies 
Abstract 
This chapter describes the mechanisms that aid in the transition of Internet Protocol version 4 (IPv4) to Internet Protocol 
version 6 (IPv6) and the set of IPv6 transition technologies that are included with Microsoft Windows. Because the 
deployment of IPv6-only environments will not replace IPv4-only environments in the near future, network 
administrators must understand transition technologies that allow the concurrent use of IPv6 and IPv4 in a mixed 
environment. 
Chapter 15 – IPv6 Transition Technologies 
TCP/IP Fundamentals for Microsoft Windows  
Page: 436 
Chapter Objectives 
After completing this chapter, you will be able to: 
List and describe the different types of IPv4 and IPv6 nodes. 
Describe the mechanisms for IPv4 to IPv6 transition. 