### 文件系统路径与恶意软件检测

#### 一、文件系统路径访问统计
下表列出了被恶意软件频繁访问的文件系统路径及其访问样本数和百分比。

**表XIII：系统配置文件访问情况**
| 路径 | 样本数 | 百分比 |
| --- | --- | --- |
| /sys/devices/system/cpu/online | 338 | 4.34% |
| /sys/devices/system/node/node0/meminfo | 26 | 0.33% |
| /sys/module/x_tables/initstate | 22 | 0.28% |
| /sys/module/ip_tables/initstate | 22 | 0.28% |
| /sys/class/dmi/id/sys_vendor | 18 | 0.23% |
| /sys/class/dmi/id/product_name | 18 | 0.23% |
| /sys/class/net/tx_queue_len | 9 | 0.12% |
| /sys/firmware/efi/systab | 3 | 0.04% |
| /sys/devices/pci0000:00/ | 3 | 0.04% |
| /sys/bus/usb/devices/ | 2 | 0.03% |

#### 二、恶意软件逃避技术
下表展示了不同类型的逃避技术及其在数据集中的出现频率。

**表XIV：逃避技术统计**
| 逃避类型 | 样本数 | 百分比 |
| --- | --- | --- |
| 沙箱检测 | 19 | 0.24% |
| 进程枚举 | 259 | 3.32% |
| 反调试 | 63 | 0.81% |
| 反执行 | 3 | 0.04% |
| 延迟代码 | 0 | - |

*注：进程枚举主要用于防止重复执行或识别其他相关程序，而不是用于逃避。*

#### 三、沙箱检测路径
下表列出了用于沙箱检测的文件系统路径及其访问样本数和百分比。

**表XV：沙箱检测路径**
| 路径 | 样本数 | 百分比 |
| --- | --- | --- |
| /etc/rc.d/rc.local | 1393 | 17.88% |
| /etc/rc.conf | 1236 | 15.86% |
| /etc/resolv.conf | 641 | 8.23% |
| /etc/nsswitch.conf | 453 | 5.81% |
| /etc/hosts | 423 | 5.43% |
| /etc/passwd | 244 | 3.13% |
| /etc/host.conf | 201 | 2.58% |
| /etc/rc.local | 170 | 2.18% |
| /etc/localtime | 165 | 2.12% |
| /etc/cron.deny | 101 | 1.30% |

### 四、Proc 和 Sysfs 文件系统
Proc 和 Sysfs 虚拟文件系统分别包含运行时系统信息、系统和硬件配置以及内核子系统、硬件设备和内核驱动的信息。我们将恶意软件收集的信息分为以下几类：系统配置、进程信息和网络配置。

- **网络配置**：最常见的类别，超过3000个样本访问了 `/proc/net/route`（系统路由表）以获取活动网络接口及其配置。
- **系统配置**：数百个样本提取了安装内存数量、可用CPU核心数等信息。还包括用于沙箱检测和逃避的文件，如 `/proc/cmdline` 以获取运行内核镜像的名称。
- **进程枚举**：131个样本执行了 `ps` 命令以获取运行进程列表，例如 BitcoinMiner 家族的样本会尝试杀死其他加密货币挖矿进程。

### 五、配置文件
系统配置文件通常位于 `/etc/` 目录中。下表列出了访问次数最多的配置文件。

**表XVI：配置文件访问情况**
| 路径 | 样本数 | 百分比 |
| --- | --- | --- |
| /etc/rc.d/rc.local | 1393 | 17.88% |
| /etc/rc.conf | 1236 | 15.86% |
| /etc/resolv.conf | 641 | 8.23% |
| /etc/nsswitch.conf | 453 | 5.81% |
| /etc/hosts | 423 | 5.43% |
| /etc/passwd | 244 | 3.13% |
| /etc/host.conf | 201 | 2.58% |
| /etc/rc.local | 170 | 2.18% |
| /etc/localtime | 165 | 2.12% |
| /etc/cron.deny | 101 | 1.30% |

### 六、动态链接库
下表列出了恶意软件最常导入的动态库及其使用百分比。

**表XVII：常用动态库**
| 库 | 百分比 |
| --- | --- |
| glibc | 74.21% |
| uclibc | 24.24% |
| libgcc | 9.74% |
| libstdc++ | 7.12% |
| libz | 5.24% |
| libcurl | 3.64% |
| libssl | 2.35% |
| libxml2 | 1.44% |
| libjansson | 1.39% |
| libncurses | 1.28% |

通过这些分析，我们可以更好地了解恶意软件的行为模式，并为安全分析师提供监控新恶意软件株系的重要路径。