title:ZOE: Content-Based Anomaly Detection for Industrial Control Systems
author:Christian Wressnegger and
Ansgar Kellner and
Konrad Rieck
2018 48th Annual IEEE/IFIP International Conference on Dependable Systems and Networks
ZOE: Content-based Anomaly Detection for
Industrial Control Systems
Christian Wressnegger
Institute of System Security
TU Braunschweig
Ansgar Kellner
Konrad Rieck
Institute of System Security
Institute of System Security
TU Braunschweig
TU Braunschweig
Abstract—Due its complexity and a multitude of proprietary
components, industrial control systems are an immanently dif-
ﬁcult ﬁeld of application for intrusion detection. Proprietary
binary protocols and the lack of public speciﬁcations have
forced the research community to move away from content-based
detection to more abstract concepts. In this paper, we show that in
contrast to prior belief the content of unknown binary protocols
can very well be modeled. ZOE derives prototype models that are
speciﬁc to individual types of messages in order to capture the
characteristics of arbitrary binary protocols and enable detecting
different forms of attacks as anomalies. In an evaluation based
on 6 days of network trafﬁc recorded at a large power plant
(1,900 MW) with over 92,000 unique devices, we demonstrate
that ZOE improves upon related approaches by up to an order
of magnitude in detection performance, but also signiﬁcantly
decreases false positives.
Index Terms—Industrial networks, SCADA, Attack Detection
I. INTRODUCTION
The protection of critical infrastructures is of utmost impor-
tance for society. Industrial facilities, such as power stations
and water supply systems, are high-value targets for terrorists
and nation-state attackers. The progressing automatization of
industrial processes and the interconnection between devices,
facilities and control centers signiﬁcantly increases their attack
surface and imposes new challenges for security solutions. A
power plant, for instance, consists of a plethora of proprietary
software and hardware components from various manufacturers.
Many of these components use non-standardized protocols that
are speciﬁc to manufactures or even to a particular type of
device. Consequently, operators of an industrial facility usually
do not know about implementation details of the (computer)
systems they run. This renders the use of traditional intrusion
detection approaches for industrial control systems (ICS)
extremely difﬁcult. As a result, the networks in industrial
control systems have been increasingly targeted by attacks in
the last years [e.g., 7, 15, 33, 47].
Without
the availability of protocol speciﬁcations that
assist in preprocessing network data, an in-depth analysis
of communication content is difﬁcult to accomplish. The
research community has thus moved towards approaches
that model the appearance of network trafﬁc rather than its
content [28, 42, 52, 60] or even the underlying physical process
itself [24, 29, 61] in order to detect deviations from the
expected process states. This more abstract perspective allows
for the detection of speciﬁc classes of attacks, such as ﬂooding
or incremental attacks, but also restricts defense more than
necessary. Stuxnet, for instance, has sabotaged the overall
production process by making small, infrequent changes to the
motor speed of centrifuges [15]. While only subtle changes
have been made, these operations happened out of the ordinary
and posed anomalies among the usual bus communication with
respect to used input values. Thus, given a precise model of
normality such anomalies can be detected—both on a process-
as well as the network-level.
Constructing these models however is inherently difﬁcult.
Industrial facilities are subject to changes in hardware (e.g., sen-
sors, PLCs, etc.) and adaptations of the process itself. On the
one hand, using an expert model of the physical process for
detection, implies that this model has to be manually updated at
every change in order to prevent divergence from reality that in
turn may result in loopholes for an attacker. On the other hand,
machine learning has been used to automatically learn and
update models of communication contents instead. Previous
research has demonstrated the effectiveness of anomaly detec-
tion for network-based intrusion detection for various ﬁelds
of application and protocols [63, 65–67, 71, 72]. However,
the prevalent use of proprietary binary protocols in industrial
networks signiﬁcantly complicates the use of content-based
approaches for the detection of intrusions and often renders
existing approaches ineffective [23].
In this paper we attempt to bridge this gap and present ZOE, a
framework that effectively and efﬁciently makes use of content-
based anomaly detection for proprietary binary protocols. We
show that content models are very well usable for environments
that rely on undocumented protocols with high-entropy data.
To this end, we introduce the concept of prototype models,
that is, prototypical representations speciﬁc to individual types
of messages. These models not only characterize the structure
of message types but also the data they typically contain.
Moreover, we present a linear-time algorithm for learning and
applying these models based on Count-Min Sketches [9], that
breaks up the separation of traditional clustering methods and
anomaly detection.
For the evaluation of our approach we have recorded
roughly 210 GiB of network trafﬁc from two industrial
facilities, a large power plant producing about 1,900 MW
and a coal mining facility. During 6 days of operation we
have gathered data from 92,700 unique devices on control
level and ﬁeld level of the facilities. As recordings of attacks
in industrial environments are particularly rare, we have
2158-3927/18/$31.00 ©2018 IEEE
DOI 10.1109/DSN.2018.00025
127
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:26:43 UTC from IEEE Xplore.  Restrictions apply. 
additionally developed a tool that automatically generates
abnormal network messages based on authentic communication.
This enables us to calibrate our detector with varying difﬁculty.
We empirically evaluate our approach based on the six most
prominent protocols in the recorded data and show that ZOE
not only improves over related approaches by up to an order
of magnitude in detection performance, but also signiﬁcantly
decreases false-positives.
In summary we make the following contributions:
• Prototype Models for Network Messages. We introduce
the concept of prototype models and present a linear-time
algorithm for constructing these based on large amounts
of network trafﬁc. These models not only characterize the
structure of individual message types but also the data
they typically contain.
• Noise-resilient Anomaly Detection. We demonstrate how
protocol models can be used to prune out irrelevant, noisy
features that arise from the intermingling of structure
and data in binary protocols. This enables us to further
enhance the expressiveness of the models and thus allows
for robust anomaly detection in environments with high-
entropy data.
• Large-scale evaluation using authentic SCADA data. We
conduct a large-scale evaluation with authentic data from
two different industrial facilities for coal mining and power
generation. This includes PROFINET IO trafﬁc at the ﬁeld
level as well as ﬁve entirely undocumented protocols at
control level with more than 210 GiB of data involving
92,700 unique devices.
The rest of the paper is organized as follows: The problem
statement is outlined in Section II. Section III then describes
our method ZOE and how prototype models are used for attack
detection in proprietary protocols. Section IV describes the
data that has been gathered for the evaluation presented in
Section V. Related work is discussed in Section VI before
Section VII concludes the paper.
II. PROBLEM STATEMENT AND SCOPE
Protecting industrial computer networks, such as ICS and
SCADA systems, from attacks is a daunting task. While
networks in industrial facilities are much more homogeneous
than general-purpose computer networks, they often employ
proprietary systems and protocols. In many cases, only few
technical details are known about these protocols and even
the operators do not have access to the underlying protocol
speciﬁcations. One reason for this situation is that industrial
networks often comprise components of specialized manufac-
turers, each employing proprietary technology, for example, for
controlling turbines and chemical reactors. As a consequence,
conventional security techniques, such as intrusion detection
systems, are faced with an opaque network environment and
few to no information about the exchanged message formats
and protocol state machines.
The analysis of communication in industrial networks is
further obstructed by the use of binary protocols that rest
on compact binary structures for minimizing communication
overhead and delay. On the ﬁeld level this frequently is the
case due to the limited resources of devices and legacy reasons.
Modbus messages, for instance, are limited to 256 bytes
as the ﬁrst
implementation has been designed for serial
communication over RS485 [39]. Similarly, modern protocols
on the control level also frequently rely on compact binary
structures. For example, ﬁve out of the six proprietary protocols
considered in our evaluation make use of binary ﬁelds and
structures.
In the absence of appropriate protocol dissectors and parsers,
an analysis of network trafﬁc is only feasible if abstract
representations of the exchanged data are developed that are
capable of reﬂecting content and structure in a generic manner.
To tackle this problem, we model the communication between
two parties in a network as a sequence of incoming and
outgoing binary messages or more formally application-level
data units (ADUs). For stateful transport protocols, such as
TCP, these messages can be extracted using regular stream
reassembly [11]; for stateless protocols, such as UDP, these
messages simply refer to the application-level payloads. In the
following, we thus focus on techniques for analyzing binary
messages and identifying anomalous content.
An advantage of industrial environments over general-
purpose computer networks is that the scope of application is
often narrow and clearly deﬁned. The industrial process itself
has precisely speciﬁed terms of operation and clear expectations
with respect to its outcome. This is predestinated for the use
of anomaly detection, where a model of normality is inferred
using machine learning techniques and deviations from the
model are ﬂagged as anomalies. In order to apply machine
learning successfully in this context, however, a few things
have to be particularly considered [22, 54]:
High costs of error. Wrong classiﬁcations are particularly
critical in a security context. False-negatives may potentially
cause devastating harm to the attacked network, while a high
number of false-positives may render an intrusion detection
system useless [3]. An effective detector must therefore strive
for extremely low false-positive rates and simultaneously detect
attacks with high accuracy to keep the overall number of
misclassiﬁcations and the associated costs low.
Lack of training data. For a learning based detector it is of
tremendous importance to operate on sufﬁciently large training
datasets. Anomaly detection attempts to build a model of
normality to detect deviations thereof as attacks. This can
only succeed if most—preferably all—aspects of the network
protocol in question have been considered. Gathering enough
training data, however, is a major challenge and not always
possible. Next to benign data also malicious samples are
quintessential for calibrating and evaluating anomaly detection
methods in practice. A fact that is frequently overlooked.
128
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:26:43 UTC from IEEE Xplore.  Restrictions apply. 
Semantic gap. Anomaly detection does not discriminate be-
tween benign and malicious content, but reports deviations
from what has been learned as normal content. Any raised
alarm hence requires interpretation. To tighten the assumption
of anomalies being attacks, periodic retraining of the underlying
model is necessary as the notation of normality might change
over time. In practice, a linear-time approach for training thus
is highly beneﬁcial.
Large variability of input data. Network trafﬁc exhibits great
variability in its data and structure. An effective anomaly
detection system hence is required to carefully aggregate
information from large amounts of data over several days
or even weeks to model regular variance and ﬁlter out network
chaff. For industrial environments this aspect is less severe due
to the narrow scope and application of the networks.
III. ATTACK DETECTION IN PROPRIETARY PROTOCOLS
A large body of research on content-based intrusion detection
has shown that considering the mere presence of features in
network trafﬁc often is superior over counting their occur-
rences [23, 63, 68, 71]. For example, particular strings might
already be indicative to spot network attacks at the application
layer. However, ignoring the frequency of features prematurely
discards valuable information. While this kind of data may
not be mandatory for the pure detection of attacks, we show
that it plays a key role in modeling normality and constructing
corresponding detection models, in particular, in proprietary
network environments.
Based on this observation, we develop a content-based
anomaly detector, ZOE, that in contrast to previous work is
capable of robustly handling binary and text-based protocols
likewise, without requiring any knowledge of the underlying
speciﬁcation. To this end, we learn a model of normality from
observed network trafﬁc and detect attacks as deviations thereof.
The important difference to related approaches is the use of
adequate ways of modeling unknown protocols. To achieve
this goal we rely on two key components, that seamlessly
intertwine:
A. Building Prototype Models. For constructing a model
of normality we automatically partition network trafﬁc
into k groups of messages with similar content, thereby
approximating states of the underlying protocol. This
procedure is designed to not only separate message types
but also, to derive one prototype model per message type
in the process, which makes a classical separation of
clustering and subsequent learning of content models
unnecessary.
B. Reducing Noise. One of the main obstacles for analyzing
unknown protocols is “noise”, that is, seemingly random
data that hinders inferring suitable content models [see 23].
We address this problem by analyzing the occurrences of
features in each prototype model and carefully ﬁltering
rare features using a frequency threshold t.
These two components form the basis of our detector, which