+Pl,lh2rl)+ 
w2"l(piFl,lrl 
-Pl,lh2ri)+ 
+ piFl,lr2 
-pihlr2 
w2"l (-2Pi Fl,l rl 
r2 + pi hI rl r2 + pi Fl,l 
rir2) 
3)-1 (29) 
q2,1 = -(Yl + Y2 + Y3 + Y4Pi Li!l Xi)(Pl W
-Fl,l + h2rl)Ul 
q2,2 = Pl(rlr2 
-r2 + l)(hl 
where the Yi, Xl, and Ul are given in the appendix. 
0 :::; qi,j :::; 1 
to Fl,l and Pl,l. Recall 
that Pl is always feasible, 
point (Fl,l' Pl,l) closest 
norm to (Fl,l,Pl,l)' This point can be obtained 
the norm of  = [Fl.lPl.l], with 
Fl,l), 
Fl.l = Pl(Fl,l -
P", = (Pl,l -Pl,
d 
2 
Bl,lrlr
W4 = Bl,l - hI 
+ hlr2 - h2rl + 
-Bl,lr2 
-1)w4 
W5 = rl(h2 
-hlr2)(r2 
-r2 + l)(Bl,l - hI 
_  Pl(rlr2 
-h2 + hlr2) 
qll --,  (h2 -hlr2)(rl 
-1)(r2 
-1) 
norm to (Bl,l' Pl,l) by solving 
order AMMAP[2] with positive 
•  If rl = 
[q/h], Dl,2 = [(1 -q)/h]. The 
Do = [-l/h], 
Dl,l = 
of the first class is PI = q. 
•  If h2 -hI r2 = 0 the AMAP(2) is also exponential. 
even ifthe matrix Dl = Dl
,l + Dl,2 
of ql,l, 
ql,2, and q2,2 becomes 
•  If rl = 1 and r2 i- 0 the underlying 
of ql, 1 in Dl,2 is null. In this case, 
Pl = q2,1 -r2q2,1 + r2q2,2  (34) 
Fll = h2 - hlq2,1(r2 -1) (35) 
,  r2q2,2 -q2,1(r2 -1) 
Bl,l = hI 
+ h2 -hlr2. (36) 
for fitting PI and Fl,l 
adjustment 
can be always matched 
moments and class transition 
we fit the feasible 
•  If r2 = 0, the underlying 
into an APH(2) renewal 
the AMMAP[2] loses one degree of freedom, 
the coefficient 
expressions 
to 
case is interesting: 
has three non-zero 
fitted, 
Feasible 
obtained 
expression 
degenerates 
Therefore, 
the AMPH 
jitting. Constraints 
to the explicit 
parameter 
the AMMAP[2] cannot 
of the expressions 
and the arrival 
exactly. When 
of the two classes 
forward 
the provided 
probabilities 
a nonlinearly 
minimize 
process. 
defined in Section 
case, we can only fit a marked Poisson 
(28), (29), (30), which are nonlinear 
backward 
of notation 
The parameters 
are then computed 
null. Hence, like in the previous 
moments and class probabilities: 
(37) 
(38) 
since the denominator 
constrained 
least squares 
problem 
Inverting 
this formulas 
convenience 
we define 
AMAP(2) 
because 
in Euclidean 
by solving 
fitting 
approach 
IV-A applies. 
are unfeasible, 
elements, 
be 
with respect 
hence no 
region and approximate 
are 
(28) 
(30) 
3) Fitting 
For 
is necessary 
as follows 
(31) 
This 
process. 
MAP process 
in which we 
we obtain: 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:41:16 UTC from IEEE Xplore.  Restrictions apply. 
2. Feasible 
decay. 
Figure 
autocorrelation 
feasible 
regions for the multi-class 
Each figure refers to a differe nt value of the probabi
conditional 
values of the 
first-order moments. 
moments of AMMAP[2] processes 
lity of arrivals of class one. The regions shaded in different colors 
based on four AMAP(2) with the same first three moments and 
the 
represent 
decay 
autocorrelation 
Feasible 
tive, there are at most two feasible 
autocorrelation 
with negative 
AMAP(2). 
tion decay, 
feasible 
as shown in Figure 
Similarly 
the choice 
of the first forward 
region 
(39) 
3. 
fits for the underlying 
autocorrela­
to the case with positive 
of the underlying 
APH(2) impacts 
the 
region. When the autocorrelation 
decay is nega­
and backward 
moments, 
Approximate 
of FI,1 or PI,1 are infeasible, 
jitting. Similarly 
to Section 
IV-B, when the 
we find the closest 
When multiple 
underlying 
AMAP(2) are 
the one which leads to the smallest 
error. 
correlation 
decay 
for the AMAP(2) with negative 
values. 
we select 
values 
feasible 
feasible 
However, 
only two forms, 
instead 
of four, exist. 
of the second-order 
For 
2) Fitting 
we define 
formulas 
convenience 
forward moments and class probabilities: 
of notation 
for the parameters 
+ h2 -hl1'2 + FI,I(1'1 + 1'2 -1'11'2 -2) 
The explicit 
AMMAP[2] as a function 
W6 = hI 
h2 + h21'1)W6 
W7 = 1'2(hl -
of PI, FI,1 and PI,1 are: 
Ql,l = (PI(1'1 -1)W6)-1 L;=l x;' 
_  PI(FI,1 -h2)(1'1 + 1'2 -1'11'2 
Q2,1 - (1'2 -1) (hI 
-h2 + h21'1) 
[PI (L=l y;' - hI L;=7 y;,) 
Q2,2 = wil 
where the y;' and u;' definitions 
u;,] 
+ PII L;=l 
are given in the appendix. 
-2) 
Feasible 
region and approximate 
jitting. Similarly 
decay discussed 
to 
in 
IV-B4, the feasible 
autocorrelation 
When (FI,I,PI,I) is unfeasible, 
the case with positive 
Section 
inequalities. 
closest 
constrained 
point in the feasible 
problem. 
region, 
solving 
region 
we find the 
a nonlinearly 
is defined by nonlinear 
least squares 
backward 
3) Fitting 
moments and class probabilities: 
For 
the sake of compactness 
we define 
2 
-h2 - hl1'
+ h2 - hl1'
l + hl1'l1'
Ws = hI 
2 + BI,I(1'1 + 1'2 -1'11'2 -2) 
Wg = hI 
WlO = BI,1 -h2 - hl1'l + hl1'l1'2 
Wn = Pl1'2WSW9 
c. AMMAP{2} with negative 
The AMMAP[2] process 
decay is: [-O, 
Do = l ] -h2 
DI,1 = [
q2.'(-T2) Q':fh,)] 
[ 0  (l-Ql,,)(l-T,)] 
h2 h2 
DI,2 = (I-Q2,,)(I-T2) (1-:2',2)T2 
h2  h2 
(40) 
(41) 
moments and class probabilities 
of the 
Multi-class 
AMMAP[2] are as follows: 
qi 1 -q2 1 + T2q2 1 -T2q2.2 
, . 
,  Ti (T2 - 1) -T2 + 2 
Pi  =qi 1 -'  , 
Pi,i  =2qi,lq2,1 + T2q,1 -q5,1-
(2q2,1 - T2q2,1 + T2q2,2)(qi,1 -q2,1 + T2q2,1 - T2q2,2) 
Ti(T2 - 1
) -T2 + 2 
T2Qi,lq2,1 + T2Qi,lQ2,2 -T2Q2,lQ2,2 
h  (T2,1 - T2Q2,1 + T2Q2,2)(hi -h2 - hiTi + hiTiT2) 
.:.::..:...'---=- ,..-=---=-
+ T2 -TiT2 - 1) 
Q2,1 - T2Q2
- -'--"=--=-==--=-=
-=-----'=-=--=. 
,1 + T2Q2,2 -Qi,l(Ti 
Q2,1(T2 - l)(hi -h2 + h2Td 
-= .:.:...0.-=- _ '-'--"- ---;'=----= -=..: __ 
h 
Fi 1 =  2 
,  Q2,1 -T2Q2,1 + T2Q2,2 -Qi,l(Ti + T2 -TiT2 -1) 
- ___ 
--,-,-
B 1 1 =  1 
, 
for the first canonicaJ 
form 
closed analytical 
IV-B, we provide 
to the results 
Analogously 
discussed 
formulas 
in Section 
for fitting: 
• PI, BI,
1 and FI,1 in Section 
• PI, FI,1 and PI,1 in Section 
• PI, BI,
1 and PI,1 in Section 
IV-C1; 
IV-C2; 
IV-C3. 
explicit 
the closed 
IV-C4 we discuss 
For each of this case we provide 
to be used for fitting. 
In Section 
cases that require 
two degrees 
Do and DI of the underlying 
1) Fitting PI, BI,1 and Fi,l: Solving 
PI, BI,
1 and FI,1 for the parameters ql,l, ql,2, Q2,2 yields 
due to the loss of one or 
of zeros appearing 
in the 
attention 
because 
of freedom 
AMAP(2). 
special 
formulas 
the expressions 
of 
degenerate 
_  Pi(Bi,l - h2 -hiTi + hiTiT2)(Ti + T2 -TiT2 - 2) 
(Ti - 1)(T2 - l)(hi - h2 - hiTi 
+ hiTiT2) 
Qi,i --
Q2,1  (T2 - l)(hi -h2 + h2Td 
Pi(Fi,l - h2)(Ti + T2 -TiT2 - 2) 
Pi(Bi,l - hd(Ti + T2 -TiT2 - 2) Pi(Ti + T2 -TiT2 - 2) 
T2(hi -hz - hiTi + hiTiT2)  T2(Ti - 1) 
Pi (hi -Fi,i + Fi,lTi)(Ti + T2 -TiT2 - 2) 
+ 
T2(hi + h2h -l»h - 1) 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:41:16 UTC from IEEE Xplore.  Restrictions apply. 
Figure 3. Feasible 
autocorrelation 
decay. 
feasible 
regions for the multi-class 
Each figure refers to a differe nt value of the probabi
conditional 
values of the 
first-order moments. 
moments of AMMAP[2] processes 
lity of arrivals of class one. The regions shaded in different colors 
based on four AMAP(2) with the same first three moments and 
the 
represent 
V. MMAP[m] S EQ UENTIAL FITTING 
(Xi, Ci), i :::: 1, we 
sequence 
Given a marked arrival 
sequence 
(Xi, Cn, where C = 1 if Ci = 
In a MMAP[m] of order n, the 
define the aggregated 
marked arrival 
sequence 
c, and C = 2 otherwise. 
aggregated 
of order n with representation 
c is defined as the MMAP[2] 
process 
for class 
for class 
c as a two-class 
the aggregation 
(Do, Df,l' Df,2) = (Do, Dl,e, Lk#e Dl,k) 
methods 
to exploit 
second-order 
for fitting 
We now investigate 
a 
Recall 
canonical 
number of classes. 
for the second-order 
AMMAP[2] that fits two classes. 
AMMAP[m] with an 
that the fitting 
process 
AMMAP[2] starts 
with a 
AMAP(2) and successively 
obtains 
The method 
AMMAP[m] is similar: 
m fitting 
mechanism 
arbitrary 
we have defined for a second-order 
single-class 
second-order 
we propose 
start with a single 
steps, 
sequence 
sented 
in the previous 
(Do, Dll' D12) subject 
store Dr 1 and increase 
(Do, Di,, Di,l' ... ,Dr'\) which is obtained 
all the matrices 
for class i using any of the fitting 
pre­
to Dll + Dt 2 = Dl. We then 
i. Finally, we ;eturn the AMMAP 
class AMAP(2) and perform 
in the sequential 
one for each class. 
Dl,e obtained 
Notice that in this approach 
algorithms 
we exploit 
and obtain 
fitting. 
section 
we 
At step i, we fit the aggregated 
by assembling 
the important 
process 
immediately 
Thus, for an-order 
and backward 
This follows 
of the forward 
to aggregation. 
and in the aggregated 
is particularly 
moments to be 
by (4)­
in the formulas 
are not 
MMAP[m], 
in both the aggregated 
marked 
c. Thus, this 
property 
insensitive 
(5), since all the terms appearing 
affected 
by aggregation. 
Fj,e and Bj,e are preserved 
sequence 
approach 
AMMAP[m] where we have shown that first-order 
and backward 
Approximate 
i.e. L;;'=l Dl,k i= 
the Dl,j for j :::: c are set as follows 
moments are infeasible, 
class might lead to an invalid 
Dl. To avoid, 
this problem, 
we check if L=l Dl,k is greater 
happens 
adjustments 
for each 
MMAP[m], 
after fitting Dl,e (i.e., Di,l)' 
moments uniquely 
jitting. When some of the first and backward 
forward 
the process. 
independent 
detennine 
appealing 
AMPH[m] and 
for fitting 
than Dl. If this condition 
for class 
the representation 
of the AMMAP[2] 
for the parameters 
P1WlO(1'l 
+ 1'2 -1'11'2 
The explicit 
are obtained 
expression 
as a function 
of PI, Bl,l and Pl,l as follows: 
-2) 
ql 1  =-,  (1'1 -1)(1'2 -l)ws 
= WIll [L=l yt + PI (L!7 yt + h2 L!16 yt) ] 
where xt and yt are defined in the final appendix. 
Q2,1 = -pIlwgl (x' +x' +x' +Pl,lhl1'l1'
Q2,2 
Feasible region and approximate jitting. When 
2) 
is unfeasible, 
(Bl,l,Pl,l) 
case, we find the closest 
solving 
a nonlinearly 
analogously 
point in the feasible 
to the previous 
region, 
4) Degenerate cases: The following 
constrained 
least squares 
problem. 
degenerate 
cases 
arise when fitting 
autocorrelation 
decay. 