        an = 3/Rpn*(1-en-efn)
        sigmap = sigmp*(1-ep-efp)
        sigman = sigmn*(1-en-efn)
        D2pos = ep^brugp*Dbulk
        D2sep = es^brugs*Dbulk
        D2neg = en^brugn*Dbulk
        dy[1] = 1/ep*(64.*D2pos/lp^2*(y[60]-2.*y[1]+y[2])+2.*ap*(1.-1.*t1)*kp*(y[1]*c0)^.5*(-1.*y[110]*ctp+ctp)^.5*(y[110]*ctp)^.5*sinh(.5*F/R/Tr*(y[86]-1.*y[65]-1.*ocp_cathode(y[110],up)))/c0)
        dy[2] = 1/ep*(64.*D2pos/lp^2*(y[1]-2.*y[2]+y[3])+2.*ap*(1.-1.*t1)*kp*(y[2]*c0)^.5*(-1.*y[111]*ctp+ctp)^.5*(y[111]*ctp)^.5*sinh(.5*F/R/Tr*(y[87]-1.*y[66]-1.*ocp_cathode(y[111],up)))/c0)
        dy[3] = 1/ep*(64.*D2pos/lp^2*(y[2]-2.*y[3]+y[4])+2.*ap*(1.-1.*t1)*kp*(y[3]*c0)^.5*(-1.*y[112]*ctp+ctp)^.5*(y[112]*ctp)^.5*sinh(.5*F/R/Tr*(y[88]-1.*y[67]-1.*ocp_cathode(y[112],up)))/c0)
        dy[4] = 1/ep*(64.*D2pos/lp^2*(y[3]-2.*y[4]+y[5])+2.*ap*(1.-1.*t1)*kp*(y[4]*c0)^.5*(-1.*y[113]*ctp+ctp)^.5*(y[113]*ctp)^.5*sinh(.5*F/R/Tr*(y[89]-1.*y[68]-1.*ocp_cathode(y[113],up)))/c0)
        dy[5] = 1/ep*(64.*D2pos/lp^2*(y[4]-2.*y[5]+y[6])+2.*ap*(1.-1.*t1)*kp*(y[5]*c0)^.5*(-1.*y[114]*ctp+ctp)^.5*(y[114]*ctp)^.5*sinh(.5*F/R/Tr*(y[90]-1.*y[69]-1.*ocp_cathode(y[114],up)))/c0)
        dy[6] = 1/ep*(64.*D2pos/lp^2*(y[5]-2.*y[6]+y[7])+2.*ap*(1.-1.*t1)*kp*(y[6]*c0)^.5*(-1.*y[115]*ctp+ctp)^.5*(y[115]*ctp)^.5*sinh(.5*F/R/Tr*(y[91]-1.*y[70]-1.*ocp_cathode(y[115],up)))/c0)
        dy[7] = 1/ep*(64.*D2pos/lp^2*(y[6]-2.*y[7]+y[61])+2.*ap*(1.-1.*t1)*kp*(y[7]*c0)^.5*(-1.*y[116]*ctp+ctp)^.5*(y[116]*ctp)^.5*sinh(.5*F/R/Tr*(y[92]-1.*y[71]-1.*ocp_cathode(y[116],up)))/c0)
        dy[8] = 16./es*D2sep/ls^2*(y[61]-2.*y[8]+y[9])
        dy[9] = 16./es*D2sep/ls^2*(y[8]-2.*y[9]+y[10])
        dy[10] = 16./es*D2sep/ls^2*(y[9]-2.*y[10]+y[62])
        dy[11] = 1/en*(64.*D2neg/ln1^2*(y[62]-2.*y[11]+y[12])+2.*an*(1.-1.*t1)*kn*(y[11]*c0)^.5*(-1.*y[124]*ctn+ctn)^.5*(y[124]*ctn)^.5*sinh(.5*F/R/Tr*(y[95]-1.*y[77]+.5e-1-2.325*exp(-100.*y[124]^1.15)+.1721*tanh(20.000000*y[124]-21.000000)+.25e-2*tanh(39.347962*y[124]-37.241379)+.34e-1*tanh(89.411765*y[124]-6.0294118)+.2e-2*tanh(7.0422535*y[124]-1.3661972)+.155e-1*tanh(77.519380*y[124]-8.1395349)))/c0)
        dy[12] = 1/en*(64.*D2neg/ln1^2*(y[11]-2.*y[12]+y[13])+2.*an*(1.-1.*t1)*kn*(y[12]*c0)^.5*(-1.*y[125]*ctn+ctn)^.5*(y[125]*ctn)^.5*sinh(.5*F/R/Tr*(y[96]-1.*y[78]+.5e-1-2.325*exp(-100.*y[125]^1.15)+.1721*tanh(20.000000*y[125]-21.000000)+.25e-2*tanh(39.347962*y[125]-37.241379)+.34e-1*tanh(89.411765*y[125]-6.0294118)+.2e-2*tanh(7.0422535*y[125]-1.3661972)+.155e-1*tanh(77.519380*y[125]-8.1395349)))/c0)
        dy[13] = 1/en*(64.*D2neg/ln1^2*(y[12]-2.*y[13]+y[14])+2.*an*(1.-1.*t1)*kn*(y[13]*c0)^.5*(-1.*y[126]*ctn+ctn)^.5*(y[126]*ctn)^.5*sinh(.5*F/R/Tr*(y[97]-1.*y[79]+.5e-1-2.325*exp(-100.*y[126]^1.15)+.1721*tanh(20.000000*y[126]-21.000000)+.25e-2*tanh(39.347962*y[126]-37.241379)+.34e-1*tanh(89.411765*y[126]-6.0294118)+.2e-2*tanh(7.0422535*y[126]-1.3661972)+.155e-1*tanh(77.519380*y[126]-8.1395349)))/c0)
        dy[14] = 1/en*(64.*D2neg/ln1^2*(y[13]-2.*y[14]+y[15])+2.*an*(1.-1.*t1)*kn*(y[14]*c0)^.5*(-1.*y[127]*ctn+ctn)^.5*(y[127]*ctn)^.5*sinh(.5*F/R/Tr*(y[98]-1.*y[80]+.5e-1-2.325*exp(-100.*y[127]^1.15)+.1721*tanh(20.000000*y[127]-21.000000)+.25e-2*tanh(39.347962*y[127]-37.241379)+.34e-1*tanh(89.411765*y[127]-6.0294118)+.2e-2*tanh(7.0422535*y[127]-1.3661972)+.155e-1*tanh(77.519380*y[127]-8.1395349)))/c0)
        dy[15] = 1/en*(64.*D2neg/ln1^2*(y[14]-2.*y[15]+y[16])+2.*an*(1.-1.*t1)*kn*(y[15]*c0)^.5*(-1.*y[128]*ctn+ctn)^.5*(y[128]*ctn)^.5*sinh(.5*F/R/Tr*(y[99]-1.*y[81]+.5e-1-2.325*exp(-100.*y[128]^1.15)+.1721*tanh(20.000000*y[128]-21.000000)+.25e-2*tanh(39.347962*y[128]-37.241379)+.34e-1*tanh(89.411765*y[128]-6.0294118)+.2e-2*tanh(7.0422535*y[128]-1.3661972)+.155e-1*tanh(77.519380*y[128]-8.1395349)))/c0)
        dy[16] = 1/en*(64.*D2neg/ln1^2*(y[15]-2.*y[16]+y[17])+2.*an*(1.-1.*t1)*kn*(y[16]*c0)^.5*(-1.*y[129]*ctn+ctn)^.5*(y[129]*ctn)^.5*sinh(.5*F/R/Tr*(y[100]-1.*y[82]+.5e-1-2.325*exp(-100.*y[129]^1.15)+.1721*tanh(20.000000*y[129]-21.000000)+.25e-2*tanh(39.347962*y[129]-37.241379)+.34e-1*tanh(89.411765*y[129]-6.0294118)+.2e-2*tanh(7.0422535*y[129]-1.3661972)+.155e-1*tanh(77.519380*y[129]-8.1395349)))/c0)
        dy[17] = 1/en*(64.*D2neg/ln1^2*(y[16]-2.*y[17]+y[63])+2.*an*(1.-1.*t1)*kn*(y[17]*c0)^.5*(-1.*y[130]*ctn+ctn)^.5*(y[130]*ctn)^.5*sinh(.5*F/R/Tr*(y[101]-1.*y[83]+.5e-1-2.325*exp(-100.*y[130]^1.15)+.1721*tanh(20.000000*y[130]-21.000000)+.25e-2*tanh(39.347962*y[130]-37.241379)+.34e-1*tanh(89.411765*y[130]-6.0294118)+.2e-2*tanh(7.0422535*y[130]-1.3661972)+.155e-1*tanh(77.519380*y[130]-8.1395349)))/c0)
        dy[18] = 16.*(Dsp*(y[25]-1.*y[103])+Dsp*(y[103]-2.*y[18]+y[25]))/Rpp^2
        dy[19] = 16.*(Dsp*(y[26]-1.*y[104])+Dsp*(y[104]-2.*y[19]+y[26]))/Rpp^2
        dy[20] = 16.*(Dsp*(y[27]-1.*y[105])+Dsp*(y[105]-2.*y[20]+y[27]))/Rpp^2
        dy[21] = 16.*(Dsp*(y[28]-1.*y[106])+Dsp*(y[106]-2.*y[21]+y[28]))/Rpp^2
        dy[22] = 16.*(Dsp*(y[29]-1.*y[107])+Dsp*(y[107]-2.*y[22]+y[29]))/Rpp^2
        dy[23] = 16.*(Dsp*(y[30]-1.*y[108])+Dsp*(y[108]-2.*y[23]+y[30]))/Rpp^2
        dy[24] = 16.*(Dsp*(y[31]-1.*y[109])+Dsp*(y[109]-2.*y[24]+y[31]))/Rpp^2
        dy[25] = 4.*(2.*Dsp*(y[32]-1.*y[18])+4.*Dsp*(y[18]-2.*y[25]+y[32]))/Rpp^2
        dy[26] = 4.*(2.*Dsp*(y[33]-1.*y[19])+4.*Dsp*(y[19]-2.*y[26]+y[33]))/Rpp^2
        dy[27] = 4.*(2.*Dsp*(y[34]-1.*y[20])+4.*Dsp*(y[20]-2.*y[27]+y[34]))/Rpp^2
        dy[28] = 4.*(2.*Dsp*(y[35]-1.*y[21])+4.*Dsp*(y[21]-2.*y[28]+y[35]))/Rpp^2
        dy[29] = 4.*(2.*Dsp*(y[36]-1.*y[22])+4.*Dsp*(y[22]-2.*y[29]+y[36]))/Rpp^2
        dy[30] = 4.*(2.*Dsp*(y[37]-1.*y[23])+4.*Dsp*(y[23]-2.*y[30]+y[37]))/Rpp^2
        dy[31] = 4.*(2.*Dsp*(y[38]-1.*y[24])+4.*Dsp*(y[24]-2.*y[31]+y[38]))/Rpp^2
        dy[32] = 1.777777778*(3.*Dsp*(y[110]-1.*y[25])+9.*Dsp*(y[25]-2.*y[32]+y[110]))/Rpp^2
        dy[33] = 1.777777778*(3.*Dsp*(y[111]-1.*y[26])+9.*Dsp*(y[26]-2.*y[33]+y[111]))/Rpp^2