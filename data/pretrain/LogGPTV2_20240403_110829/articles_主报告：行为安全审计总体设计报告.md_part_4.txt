[]{#_Toc422355555 .anchor}图 4‑5行为安全审计全生命周期管理
（1）在制度要求上，由信息化管理部门组织建设信息系统一级管理制度，涉及系统管理、行为规范和安全审计等，从总体上对信息系统运行管理、行为安全提出具体监管要求；
（2）在策略控制上，信息化管理部门根据一级管理制度细化信息系统安全控制策略，形成并建立有效的符合涉密信息系统管理要求的安全技术防护体系，相关业务部门根据业务实际情况制定部门二级管理制度落实和补充一级管理制度要求，形成补充信息系统安全控制策略，保证信息系统行为监管全面、有效；
（3）在落实监管规范时，信息系统管理人员根据安全控制策略的要求，配置信息系统具体的安全监管防护产品，执行安全控制措施，确保相关安全产品功能有效、监管到位；
（4）在检查分析阶段，信息系统的审计人员根据行为安全审计支撑应用的相关分析功能有针对性地对用户行为实施审计，对突发事件进行快速定位与行为追溯，日常管理形成月度审计报告;
（5）最后，在整改闭环阶段，针对审计中发现的异常行为和安全隐患，系统管理人员对其进行督促整改并调整相应的技术和管理措施，进而从制度、策略和控制上进行补充、优化和完善。
从规范制定、用户执行和监管审计到规范再完善、用户再学习和监管审计再补充的动态管理过程，真正实现了对行为审计工作全生命周期的分段实施、统一管理，确保了审计工作的针对性、全面性和长效性。信息系统行为审计过程的动态调整和完善，也有利于信息系统安全审计管理水平的不断提高。
# 应用架构设计
行为安全审计支撑应用基于B/S结构设计，通过在终端计算机中植入代理程序实现桌面管理功能，记录用户行为，存入日志中心、日志中心到大数据平台做数据对接进行离线分析。应用前台使用Web浏览器方式进行操作配置管理和客户端注册，后台通过关系数据库对用户数据加以统计和存储。在不考虑现有采集分析类应用的情况下，独立目标架构图如图7-1所示。
![](media/image8.png){width="5.743055555555555in"
height="3.157638888888889in"}
[]{#_Toc445218183 .anchor}图 4‑8行为安全审计独立目标架构
## 采集层设计
（1）安全产品（D1）：接入公司其他安全产品采集的安全信息。通过统一的接口，将安全产品采集的信息进行标准化后接入行为日志中心库。
（2）用户终端代理程序（D2），采集客户端计算机资产信息，检测客户端设备状态行为等信息，执行安全策略管理模块分发的各种管理策略，并将客户端设备违规信息报送给安全策略管理模块。在具体实现的应用功能上，行为审计支撑应用应提供完整的用户行为日志记录功能，包括对用户终端的网络访问、应用系统访问、安全策略设置及执行、系统安全漏洞、违规软件及进程、病毒情况、文档操作、文档打印输出、光驱读写、移动硬盘使用和违规外联等情况进行实时的记录和监控。
## 存储层设计
（1）行为大数据库(C1)：依托大数据存储组件和技术，存储信息系统和IT基础设施中获取的用户行为日志历史数据，包括结构化日志数据和视频、文本、图片等非结构化数据，用于离线行为数据分析及事后审计。
（2）行为日志中心库（C2）：一个实时数据库，用于存储安全产品及用户终端代理实时采集的信息行为数据，为实时行为数据分析提供数据支撑。
（3）中央身份权限库（C3）：中央身份权限库中存放着公司所有信息系统用户的身份权限信息、应用资源信息，通过中央身份权限库与行为数据进行关联、对比，可以更加精准判断用户行为的合规性。同时通过中央身份权限库，对本应用的进行权限管控，实时行为数据分析时需要确定该操作有相应的权限才可以对行为日志中心库进行读取操作。
（4）基础设施资源库（C4），用于存放所有基础设施的基本信息，包括资产属性、运行属性和安全属性。采用关系型数据库。
（5）管理信息库（C5），用于存放和管理各种策略、系统组件运行参数配置、网络客户端设备信息、补丁及相关信息、报警和日志等各种信息。采用关系型数据库。
## 组件层设计
（1）分析算法组件（B1）：采用挖掘工具R语言、Mahout等大数据分析挖掘工具，并融合、优化传统数据挖掘算法与分布式挖掘算法构建分布式数据挖掘算法库，支撑处理行为日志历史数据分析挖掘和建模。
（2）搜索组件（B2）：采用全文搜索引擎，实现高效搜索，能根据搜索关键字及搜索条件等快速从海量的数据中发现所要查找的内容，提供丰富的查询语法，支撑实时行为数据分析应用。
（3）代理管理器与扫描器（B3、B4），作为应用数据处理中心，从管理信息库获取来自控制台的各种策略和命令操作，发送到客户端和扫描器后执行。代理管理器接收扫描器的信息和客户端程序提供的各类状态和报警信息，发送至管理信息库，管理人员可通过安全策略管理模块查阅。上级区域和下级区域之间的命令和数据均通过上下级区域管理器传达。设备扫描器用于扫描网络中主机状态，查看是否已经安装注册程序，巡检网络设备状态变化信息，及时通知客户端驻留程序更新应用参数。对终端计算机违规行为的阻断也是由扫描器在接收控制台命令后执行。
（4）应用平台组件（B5）：应用平台组件是构建应用的基础支撑，包括但不局限于流程服务能力、即插即用服务、多数据源服务、数据交换服务等。
## 应用层设计
（1）离线行为数据分析应用（A1）：基于大数据分析技术，对海量的用户行为数据进行离线分析，分析用户操作流程，发现盗用、越权访问、违规操作、恶意破坏和篡改等不安全的用户行为，为事后审计提供依据
。
（2）实时行为数据分析应用（A2）：基于大数据分析及高效搜索技术，实现对用户行为数据的实时分析，及时发现违规的用户行为，实现信息系统行为安全实时预警。
（3）数据模型管理工具（A3）：根据信息通信业务应用的数据特性，充分借鉴CIM、ITIL
V3、PAS55、COBIT、ISO
2000、OSA-CBM等成熟模型，为各种采集及业务应用提供数据模型管理工具，实现数据模型的新建、编辑、删除等操作。
（4）安全策略管理模块（A4）：作为应用的管理配置中心，基于Web浏览器方式工作，用于系统应用策略制订、配置系统组件运行参数以及维护系统等操作，并显示网络设备和该系统组件状态信息、报警信息和各种日志记录等。在安全策略管理模块进行的所有操作和结果数据均存储在管理信息库中。
（5）应用平台配置（A5）：应用平台维护人员对应用平台进行相关的配置。
# 数据架构设计
## 账号权限资源数据模型
账号权限资源数据模型是进行信息系统行为安全审计工作源头数据，通过建立科学的实名账号管理、授权管理体系是保障信息系统行为能够追溯到自然人的基础条件。
![](media/image9.png){width="6.256944444444445in"
height="3.1180555555555554in"} []{#_Toc422355559 .anchor}图
4‑9账号授权数据模型设计
**（1）人力资源体系**
人资组织（A1）：由人力资源部门维护的组织机构数据。
人资岗位（A2）:由人力资源部门维护的岗位数据。
员工（A3）：由人力资源部门维护的员工信息。
**（2）统一授权体系**
自然人与主帐号（B1、B2）：自然人是在自然状态之下作为民事主体存在的人，主帐号是自然人在信息系统中的身份识别标识。
企业组织（B3）：以人资组织为权威数据源，信息系统中使用的组织机构信息。
业务组织（B4）:各业务部门在各专业信息系统中使用的组织机构信息。当某个企业组织与业务组织产生托管关系后及进行数据联动。
从帐号（B5）:从帐号是对信息系统资源的身份识别标识。不允许自然人直接通过从帐号使用信息系统资源。
功能角色（B6）：以工作项命名的角色，以应用模块为边界。业务授权部门用采用这种角色来达到控制细粒度功能权限的目的。
岗位角色（B7）：以工作职责命名的角色，以应用模块为边界。业务授权部门用采用这种角色来达到快速授权的目的。
策略（B8）：数据权限控制策略。通过定义数据管理策略实现业务数据与数据权限控制代码的解耦，达到灵活调整数据权限的目的。
企业角色（B9）:站在公司全局角度命名的角色，跨应用模块。与人资岗位有参考关系，包含在此岗位上应含有的全部信息系统角色权限。
3.  **信息资源体系**
基础设施资源（C1）：信息化基础设施资源，包括网络、存储、中间件、数据库等。
数据资源（C2）：业务数据资源，归各个业务部门所有。
应用资源（C3）：应用软件资源，如应用信息、应用菜单、功能等。
## 用户行为证据数据
信息系统行为安全可信研究中，对用户历史的信任评估是研究用户行为可信的重要方面。用户行为证据又是研究用户行为信任的基础，用户行为证据是指在信息系统用户和服务提供者交互过程中，服务提供者可直接根据软硬件检测获得的用来定量评估用户总体行为的信任的基础数值。用户行为信任属性是与某一类应用服务相关的所有行为证据的有机组合。例如，安全行为属性是安全有关的所有行为证据的有机组合。
目前我们先将证据数据分成三种行为属性，即安全行为属性、可靠性行为属性、性能行为属性，后续根据需要可进一步扩展。
1.  **安全属性的基本证据**
  ---------------------------------------- --------------------------------------------------------
  证据名称                                 信任基本含义
  IP地址                                   看IP地址是否在有效地址范围内
  用户类型                                 看用户名是否在合法用户组里
  访问敏感服务次数                         访问敏感服务次数是否超过预警范围
  存取"根"的次数                           存取"根"的次数是否超过预警范围
  扫描端口的次数                           扫描端口的次数是否超过预警范围
  猜测密码的次数                           猜测密码的次数是否超过预警范围
  用户名                                   看用户名是否正确
  密码                                     看用户密码是否正确
  用户名或密码输入错误的总次数             用户名或密码输入错误的总次数是否超过预警范围
  用户访问的具体时间                       用户访问的具体时间是否超过预警范围
  企图超出其授权范围访问的次数             企图超出其授权范围访问的次数是否超过预警范围
  猜测用户名的次数                         猜测用户名的次数是否超过预警范围
  建立文件操作的次数                       建立文件操作的次数是否超过预警范围
  修改文件操作的次数                       修改文件操作的次数是否超过预警范围
  访问系统的持续时间                       访问系统的持续时间是否超过预警范围
  上传文件的次数                           上传文件的次数是否超过预警范围
  下载文件的次数                           下载文件的次数是否超过预警范围
  符合DoS攻击的条件数占总条件数的比例      符合DoS攻击的条件数占总条件数的比例是否超过预警范围
  符合缓冲区溢出的条件数占总条件数的比例   符合缓冲区溢出的条件数占总条件数的比例是否超过预警范围
  符合写FTP条件数站总条件数的比例          符合写FTP条件数站总条件数的比例是否超过预警范围
  用户登录的角色                           用户登录时的角色是否与身份符合
  为用户所创建的线程数                     为用户所创建的线程数是否超过预警范围