The problem can be solved by modifying and deploying recursive
resolvers (ğ2), but it takes considerable time. However, operators
of an authoritative DNS service can at least protect their servers by
ensuring that no sub-domain’s of theirs have cyclic dependencies.
In the long run, both resolver and domain fixes should be in place,
since either new recursive software or new domains with cyclic
dependencies can always recreate the problem.
To address these problems, we notified and worked with Google,
whose public DNS service represents the largest recursive resolver
traffic we see. After notification, they solved this problem in their
GDNS (ğ4.5). We followed best practices for these disclosures, allow-
ing operators at least 90 days to address problems. This threshold is
consistent with cert.org’s 45-day notification policy [9] and Google
Project Zero’s 90-day policy [16]. We also notified Cisco OpenDNS,
another large public DNS provider, which also fixed their resolver
software.
In addition to Google we also notified operators of the other
ASes that generated the greatest amount of recursive traffic in our
experiments from ğ4. Three of these ten responded to us. Of those,
two reported running old recursive resolver software. One was
using a PowerDNS resolver (3.6.2-2, from 2014 [41]), and the other
was using Windows 2008R2 (ğ4.4). Both planned to update these
resolvers.
6.1 Private and Public Disclosure
We made early, limited disclosure to specific operators, and broader
but limited disclosure to the operator and vendor community in
February 2021 [29].
Developer reaction. Upon our private disclose, Google and Cisco
have fixed their public DNS software. Moreover, the developers of
three popular resolver software ś BIND, Unbound, and PowerDNS
have released public statements about how they mitigate or planned
 0 10 20 30 40 50 60 70 8001/0301/0401/0501/0601/0701/0801/0901/1001/1101/12 Cyclic DependencyDaily Queries (million)Day/Month (2020)TotalGoogleIMC ’21, November 2–4, 2021, Virtual Event, USA
G. C. M. Moura et al.
resolver), supporting that our experiments will not harm end users
or their resolvers. In addition, we monitored the experiment for
potential surges. Aggregate traffic during the experiment can harm
the authoritative servers, but we monitor and can manage any self-
inflicted threat. We see reached at most 5.6k q/s in the sinkhole
experiment, well within our capacity.
Secondly, we limit the duration of these experiments (at most
11 hours) to reduce the traffic generated from the tested recursive
resolvers to a limited period of repeated queries. Our goal is to re-
produce the problem, confirm which resolvers are affected and how
they behave ś not to evaluate how long they will loop. Finally, we
design our experiment to weigh experiment benefit against costs
(value-sensitive design [14, 17]). Our benefits are understanding
potential harm, allowing us to notify operators, avert future prob-
lems by removing the vulnerability. These benefits greatly exceed
the carefully managed, modest experimental risks. Changes made
by Google and OpenDNS show evidence of our success.
Our sinkhole experiment (ğ4.2) temporarily introduced cyclic de-
pendencies in the domains, preventing bots from receiving answers
related to their C&C sinkholed domain. (We obtained permission
from the operator to run this experiment). This change does not
impact bots or regular users, but it may cause vulnerable resolvers
to query more often than normal, but no more than 1 q/s ś a very
safe value that is very unlikely to disrupt any resolver’s operation.
Given our goal is to evaluate the extent of vulnerable resolvers, we
reverted the domain to its original configuration after the experi-
ment ended.
Although we often release datasets publicly, in this case we are
unable to do so. Disclosure of IP address of vulnerable resolvers and
cyclic zones could enable abuse by others, and provide little lasting
benefit if problems are resolved. We have provided information
privately to operators and developers, with at least 60 days prior to
the public disclosure (Appendix G).
8 RELATED WORK
DNS misconfiguration: There have long been reports of many types
of DNS misconfiguration [2, 8, 12, 39, 60]. Our work focuses on
the problem of cyclic dependencies, first described as loops on
RFC1536 [25], and the term was coined by Pappas et al. [39]. Our
work goes beyond that work to show how this misconfiguration
interacts in real networks resulting in some recursive resolvers
greatly amplifying traffic, and we provide the first scan for these
cyclic dependencies.
DDoS attacks against DNS: Given their role in DNS resolution,
loss of authoritative DNS servers due to denial-of-service can have
catastrophic consequences. The Mirai Attack against DYN harmed
many prominent web services due to loss of DNS [40]. The root
DNS has suffered a number of DDoS attacks [32] although no prior
attack has affected enough root DNS instances to cause a user-
visible outage, in part due to heavy caching [33].
DDoS attacks using DNS: The DNS protocol itself has been ex-
ploited to carry out attacks on others. With spoofed queries, DNSSEC
provides a vector for attack amplification [23, 59]. Long CNAME
chains have also been exploited to carry amplification attacks
against authoritative servers [7]: by carefully crafting CNAME
chains where each element points to the same authoritative servers,
Figure 14: TsuNAME event at an Anonymous EU-based
ccTLD operator. Each color represents the traffic to one of
the ccTLD authoritative servers.
to mitigate TsuNAMEś with PowerDNS and Unbound explicitly
deploying negative caching of cyclic dependent records [6, 37, 42].
Operator reaction: After our February disclosure, two ccTLD
operators reported to us that they experienced TsuNAME events.
A European ccTLD kindly shared their experience with us. Around
19:00 UTC one day in 2019, two domains in their zones were mis-
configured with cyclic dependencies. Given these domain names
were particularly popular in their country, they created 10x their
normal traffic. Figure 14 shows a timeseries of queries from this
event (y axis anonymized by the operator, each color denoting one
authoritative server). The ccTLD operator contacted the domain
owner, who fixed it around 11:00 UTC on the following day. Simi-
larly to the .nz event, after fixing an immediate drop is seen in the
traffic.
A second large anycast operator confirmed that Google had at
least on one occasion sent a surge of queries to their authoritative
servers, following a cyclic dependency misconfiguration. Their
experience was worse than ours: they received a surge in UDP traffic,
to which they responded with response rate limiting (RRL [56]).
However, because these queries were from legitimate clients (not
spoofed), the clients then retried with TCP, further amplifying the
problem.
Public Disclosure: On 2021-05-06 we public disclosed TsuNAME
with a website, security advisory, and technical report. This paper
documents the problem in more detail and enables peer review of
the analysis.
7 ETHICS AND PRIVACY
Our paper poses three ethical concerns: avoiding negative conse-
quences in our evaluation, the availability of our collected data, and
proper disclosure to impacted operators.
Our evaluation to identify, reproduce, and confirm solutions to
TsuNAME placed traffic on both networks and servers. We designed
our experiments to minimize this impact. First, our experiments
in ğ4 use third-level domain names, isolating the amplification
to authoritative servers under our control. This step ensures that
the authoritative servers for TLDs are not affected by the extra
traffic from our experiments. The .nz event (ğ3) shows that indi-
vidual resolvers send safe query volumes (fewer than 10 q/s per
409
TsuNAME
IMC ’21, November 2–4, 2021, Virtual Event, USA
an attacker can amplify query volumes. We analyze short CNAME
loops and show that resolvers can detect them.
Shared infrastructure and collateral damage: Previous studies have
shown where shared infrastructure in DNS [3, 24] has increased
the odds of collateral damage: once a zone is attacked, other zones
hosted in the same infrastructure may suffer together ś for example,
this happened to .nl when parts of the Root DNS was attacked [32].
Similar behavior was observed when the Dyn DNS provider was
attacked and multiple zones hosted by it had connectivity prob-
lems [40]. Using the DNS to protect origin servers behind CDNs has
been thwarted by simultaneous connecting through IP addresses
only and by using carefully crafted URLs [58].
Recursive and Public Resolvers: Studies have examined the re-
cursive DNS resolution infrastructure, and inferred the internals
of Google’s public DNS service, both as a subject of study [53],
to understand end-user behavior [13], and to better understand
caches [44]. Google DNS has been found to be one of the most
popular public DNS resolvers [30]. In the same study, the authors
showed one of the benefits of centralization: when Google adopted
the privacy protecting query-name minimization technique, it ben-
efited many users at the same time. Our study shows another nega-
tive side of this coin, showing that when something breaks in large
DNS providers, it can be exploited to cause significant harm.
9 CONCLUSIONS
The risk of DNS cycles has been documented for more than 30 years,
but this threat has been underestimated. Large traffic increases at
.nz (ğ3) prompted us to carefully investigate this problem through
controlled experiments (ğ4). Although the exact amplification factor
varies, we showed factors ranging from 120× and 526×, explaining
two weeks of 50% growth at .nz and a 10× increase in a European
ccTLD.
Our contribution is to document the cause and threat of the
problem (ğ2), and to disclose this information to the vendor and
operation community (ğ6). We also provide a tool to detect existing
cyclic dependencies (ğ5). We hope that these steps will defuse this
problem, and we are happy that multiple vendors have confirmed
current software mitigates the problem (and identified old versions
at risk), and important operators such as Google Public DNS have
taken steps to manage the challenge.
Acknowledgments
We thank the anonymous IMC reviewers and particularly the shep-
herd for their time detailed suggestions.
We would like to thank Marco Davids for his suppport and help
in this research. We also would like to thank Puneet Sood, War-
ren Kumari, Brian Dickson, Barry Greene, Keith Mitchell, Denesh
Bhabuta, Benno Overeinder, Dario Ciccarone, Ralph Weber and the
DNS-OARC community for their feedback and support in handling
this vulnerability disclosure. We thank the Anonymous European
ccTLD operator for kindly sharing their experience and their traffic
graph when they experienced a TsuNAME event (Figure 14).
We thank all contributors to CycleHunter on Github: https:
We also thank the Ripe Atlas measurement platform [47, 48],
which we used extensively in the characterization of this vulnera-
bility in [31].
The work of Giovane C. M. Moura is partially funded by the Euro-
pean Union’s Horizon 2020 CONCORDIA project (Grant Agreement
830927) and by the Plannning for Anycast as Anti-DDoS research
project (PAADDoS), under the research programme Cyber Secu-
rity (project number 628.001.029), which is funded by the Dutch
Research Council (NWO).
Wes Hardaker and John Heidemann are partially supporte par-
tially supported by the project łCICI: RSARC: DDoS Defense In
Depth for DNSž (NSF OAC-1739034) and łDNS, Identity, and In-
ternet Naming for Experimentation and Research (DIINER)ž (NSF
CNS-1925737).
REFERENCES
[1] 1.1.1.1. 2018. The Internet’s Fastest, Privacy-First DNS Resolver. https://1.1.1.1/.
https://1.1.1.1/
[2] Gautam Akiwate, Mattijs Jonker, Raffaele Sommese, Ian Foster, Geoffrey M.
Voelker, Stefan Savage, and KC Claffy. 2020. Unresolved Issues: Prevalence, Persis-
tence, and Perils of Lame Delegations. In Proceedings of the ACM Internet Measure-
ment Conference (Virtual Event, USA) (IMC ’20). Association for Computing Ma-
chinery, New York, NY, USA, 281ś294. https://doi.org/10.1145/3419394.3423623
[3] Mark Allman. 2018. Comments on DNS Robustness. In Proceedings of the Internet
Measurement Conference 2018 (Boston, MA, USA) (IMC ’18). Association for
Computing Machinery, New York, NY, USA, 84ś90. https://doi.org/10.1145/
3278532.3278541
[4] M. Andrews. 1998. Negative Caching of DNS Queries (DNS NCACHE). RFC 2308.
IETF. http://tools.ietf.org/rfc/rfc2308.txt
[5] Manos Antonakakis, Tim April, Michael Bailey, Matt Bernhard, Elie Bursztein,
Jaime Cochran, Zakir Durumeric, J. Alex Halderman, Luca Invernizzi, Michalis
Kallitsis, Deepak Kumar, Chaz Lever, Zane Ma, Joshua Mason, Damian Menscher,
Chad Seaman, Nick Sullivan, Kurt Thomas, and Yi Zhou. 2017. Understanding
the Mirai Botnet. In Proceedings of the 26th USENIX Security Symposium. USENIX,
Vancouver, BC, Canada, 1093ś1110. https://www.usenix.org/system/files/conf
erence/usenixsecurity17/sec17-antonakakis.pdf
[6] ISC BIND. 2021. TsuNAME DNS Vulnerability and BIND 9. https://www.isc.org
/blogs/2021_tsuname_vulnerability/.
[7] Jonas Bushart and Christian Rossow. 2018. DNS Unchained: Amplified
Application-Layer DoS Attacks Against DNS Authoritatives. In Research in At-
tacks, Intrusions, and Defenses, Michael Bailey, Thorsten Holz, Manolis Stamato-
giannakis, and Sotiris Ioannidis (Eds.). Springer International Publishing, Cham,
139ś160.
[8] Sebastian Castro, Duane Wessels, Marina Fomenkov, and Kimberly Claffy. 2008.
A day at the root of the Internet. ACM Computer Communication Review 38, 5
(Oct. 2008), 41ś46. https://doi.org/10.1145/1452335.1452341
[9] cert.gov. 2021. Vulnerability Disclosure Policy. https://vuls.cert.org/confluence/
display/Wiki/Vulnerability+Disclosure+Policy.
[10] CycleHunter. 2021. GitHub - SIDN/CycleHunter: Python software that reads
zone files, extract NS records, and detect cyclic dependencies. https://github.c
om/SIDN/CycleHunter.
[11] CZ-NIC. 2021. Knot DNS. https://www.knot-dns.cz/
[12] Peter B. Danzig, Katia Obraczka, and Anant Kumar. 1992. An Analysis of Wide-
Area Name Server Traffic: A study of the Domain Name System. In Proceedings of
the ACM SIGCOMM Conference (johnh: folder: networking/dns). ACM, Baltimore,
Mayrland, USA, 281ś292. https://doi.org/10.1145/144191.144301
[13] Wouter B. De Vries, Roland Van Rijswijk-Deij, Pieter Tjerk De Boer, and Aiko
Pras. 2018. Passive Observations of a Large DNS Service: 2.5 Years in the Life
of Google. In 2018 Network Traffic Measurement and Analysis Conference (TMA).
IEEE, United States. https://doi.org/10.23919/TMA.2018.8506536
[14] Batya Friedman, David G. Hendry, and Alan Borning. 2017. A Survey of Value Sen-
sitive Design Methods. Foundations and Trends® in HumanśComputer Interaction
11, 2 (2017), 63ś125. https://doi.org/10.1561/1100000015
[15] Google. 2020. Public DNS. https://developers.google.com/speed/public-dns/.
https://developers.google.com/speed/public-dns/
[16] Google Project Zero. 2021. Vulnerability Disclosure FAQ. https://googleprojectz
ero.blogspot.com/p/vulnerability-disclosure-faq.html.
[17] Kenneth Einar Himma, Herman T Tavani, et al. 2008. The handbook of information
and computer ethics. Wiley Online Library.
[18] P. Hoffman, A. Sullivan, and K. Fujiwara. 2018. DNS Terminology. RFC 8499. IETF.
http://tools.ietf.org/rfc/rfc8499.txt
//github.com/SIDN/CycleHunter/graphs/contributors
[19] ICANN. 2020. Centralized Zone Data Service. https://czds.icann.org/.
410
IMC ’21, November 2–4, 2021, Virtual Event, USA
G. C. M. Moura et al.
[20] Internet Assigned Numbers Authority (IANA). 2020. Root Files. https://www.ia
na.org/domains/root/files.
[21] Internetstiftelsen. 2020. Zone Data. https://zonedata.iis.se/.
[22] ISC . 2021. BIND 9 . https://www.isc.org/bind/.
[23] Georgios Kambourakis, Tassos Moschos, Dimitris Geneiatakis, and Stefanos
Gritzalis. 2007. A Fair Solution to DNS Amplification Attacks. In Proceedings of
the Second IEEE International Workshop on Digital Forensics and Incident Analysis
(WDFIA). IEEE, 38ś47. https://doi.org/10.1109/WDFIA.2007.4299371
[24] Aqsa Kashaf, Vyas Sekar, and Yuvraj Agarwal. 2020. Analyzing Third Party
Service Dependencies in Modern Web Services: Have We Learned from the
Mirai-Dyn Incident?. In Proceedings of the ACM Internet Measurement Conference
(Virtual Event, USA) (IMC ’20). Association for Computing Machinery, New York,
NY, USA, 634ś647. https://doi.org/10.1145/3419394.3423664
[25] A. Kumar, J. Postel, C. Neuman, P. Danzig, and S. Miller. 1993. Common DNS
Implementation Errors and Suggested Fixes. RFC 1536. IETF. http://tools.ietf.org
/rfc/rfc1536.txt
[26] M. Larson and P. Barber. 2006. Observed DNS Resolution Misbehavior. RFC 4697.
IETF. http://tools.ietf.org/rfc/rfc4697.txt
[27] P.V. Mockapetris. 1987. Domain names - concepts and facilities. RFC 1034. IETF.
http://tools.ietf.org/rfc/rfc1034.txt
[28] P.V. Mockapetris. 1987. Domain names - implementation and specification. RFC
1035. IETF. http://tools.ietf.org/rfc/rfc1035.txt
[29] Giovane C. M. Moura. 2021. OARC Members Only Session: Vulnerability Dis-
closure (DDoS). https://indico.dns-oarc.net/event/37/contributions/821/. https:
//indico.dns-oarc.net/event/37/contributions/821/
[30] Giovane C. M. Moura, Sebastian Castro, Wes Hardaker, Maarten Wullink, and
Cristian Hesselman. 2020. Clouding up the Internet: How Centralized is DNS
Traffic Becoming?. In Proceedings of the ACM Internet Measurement Conference
(Virtual Event, USA) (IMC ’20). Association for Computing Machinery, New York,
NY, USA, 42ś49.
[31] Giovane C. M. Moura, Sebastian Castro, John Heidemann, and Wes Hardaker.
2021.
tsuNAME: exploiting misconfiguration and vulnerability to DDoS DNS.
Technical Report 2021-01. SIDN Labs. https://tsuname.io/tech_report.pdf. https:
//doi.org/paper.pdf
[32] Giovane C. M. Moura, Ricardo de O. Schmidt, John Heidemann, Wouter B. de
Vries, Moritz Müller, Lan Wei, and Christian Hesselman. 2016. Anycast vs. DDoS:
Evaluating the November 2015 Root DNS Event. In Proceedings of the ACM
Internet Measurement Conference. ACM, Santa Monica, California, USA, 255ś270.
https://doi.org/10.1145/2987443.2987446
[33] Giovane C. M. Moura, John Heidemann, Ricardo de O. Schmidt, and Wes Hardaker.
2019. Cache Me If You Can: Effects of DNS Time-to-Live. In Proceedings of the
ACM Internet Measurement Conference. ACM, Amsterdam, the Netherlands, 101ś
115. https://doi.org/10.1145/3355369.3355568
[34] Giovane C. M. Moura, John Heidemann, Moritz Müller, Ricardo de O. Schmidt,
and Marco Davids. 2018. When the Dike Breaks: Dissecting DNS Defenses During
DDoS. In Proceedings of the ACM Internet Measurement Conference. ACM, Boston,
MA, USA, 8ś21. https://doi.org/10.1145/3278532.3278534
[35] Giovane C. M. Moura, John Heidemann, Moritz Müller, Ricardo de O. Schmidt, and
Marco Davids. 2018. When the Dike Breaks: Dissecting DNS Defenses During DDoS
(extended). Technical Report ISI-TR-725. USC/Information Sciences Institute.
https://www.isi.edu/%7ejohnh/PAPERS/Moura18a.html
[36] NL Netlabs. 2021. UNBOUND. https://www.nlnetlabs.nl/projects/unbound/abou
t/.
[37] NLnetLabs. 2021. tsuNAME vulnerability and Unbound. https://nlnetlabs.nl/ne
ws/2021/May/10/tsuname-vulnerability-and-unbound/.
[38] OpenDNS. 2021. Setup Guide: OpenDNS. https://www.opendns.com/. https:
//www.opendns.com/
[39] Vasileios Pappas, Zhiguo Xu, Songwu Lu, Daniel Massey, Andreas Terzis, and
Lixia Zhang. 2004. Impact of Configuration Errors on DNS Robustness. SIGCOMM
Comput. Commun. Rev. 34, 4 (Aug. 2004), 319ś330. https://doi.org/10.1145/
1030194.1015503
[40] Nicole Perlroth. 2016. Hackers Used New Weapons to Disrupt Major Websites
Across U.S. New York Times (Oct. 22 2016), A1. http://www.nytimes.com/2016/
10/22/business/internet-problems-attack.html
[41] PowerDNS. 2021. Changelogs for all pre 4.0 releases. https://doc.powerdns.com/
recursor/changelog/pre-4.0.html.
[42] PowerDNS. 2021. TsuNAME vulnerability and PowerDNS Recursor. https://blog
.powerdns.com/2021/05/10/tsuname-vulnerability-and-powerdns-recursor/.
[43] Quad9. 2018. Quad9 | Internet Security & Privacy In a Few Easy Steps. https:
//quad9.net.
[44] Audrey Randall, Enze Liu, Gautam Akiwate, Ramakrishna Padmanabhan, Ge-
offrey M. Voelker, Stefan Savage, and Aaron Schulman. 2020. Trufflehunter:
Cache Snooping Rare Domains at Large Public DNS Resolvers. In Proceedings
of the ACM Internet Measurement Conference (Virtual Event, USA) (IMC ’20).
Association for Computing Machinery, New York, NY, USA, 50ś64.
https:
//doi.org/10.1145/3419394.3423640
[45] Y. Rekhter, B. Moskowitz, D. Karrenberg, G. J. de Groot, and E. Lear. 1996. Address
Allocation for Private Internets. RFC 1918. IETF. http://tools.ietf.org/rfc/rfc1918.