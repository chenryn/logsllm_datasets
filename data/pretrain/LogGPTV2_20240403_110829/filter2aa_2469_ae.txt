本并强制所有客户端迁移到最新版本。
API9:2019 资产管理不当
可利用性 ：3
普遍性：3
可检测性 ：2
技术：2
旧的API版本通常是未打补丁的，这是
一种不需要对抗最先进的安全机制就
可以轻松入侵系统的方法，这种做法
通常可能是为了保护最新的API版本。
资产文档的更新不及时使查找或修复漏洞变
得更加困难。缺乏资产盘点和下线策略，导
致运行着未修补的系统，最终致使敏感数据
外泄。由于微服务等先进技术概念使得应用
程序易于部署和独立运作(如云计算、k8s)，
所以经常会发现不必要的公开API主机。
攻击者可以访问敏感数据，甚至可
以通过旧的、未打补丁的API版本
连接到同一数据库从而控制服务器。
API详情
业务详情
16
影响
威胁
来源
攻击向量
安全弱点
攻击案例场景
场景#1：管理API的访问密钥泄漏到公共存储库中。存储库
所有者收到了关于潜在泄漏的电子邮件通知，但在事件发
生后花费了48个小时采取行动，那么访问密钥暴露就可能
导致敏感数据被访问。由于日志记录不足，公司无法评估
恶意访问者访问了哪些数据。
场景#2：一个视频共享平台遭到了“大规模”的凭据填充
攻击。尽管登录失败，但在攻击期间没有触发警报。作为
对用户投诉的回应，我们分析了API日志并检测到了攻击。
该公司不得不发布公告，要求用户重置密码，并向监管部
门报告此事。
API脆弱吗？
如果API含有以下项，则存在风险:
• 没有生成任何日志、日志级别没有正确设置、或日志消息
缺失足够的细节信息；
• 不能保证日志的完整性（如，日志注入）；
• 没有对日志进行持续监视；
• API基础设施没有被持续监视。
参考资料
OWASP资料
• OWASP Logging Cheat Sheet
• OWASP Proactive Controls: Implement Logging and 
Intrusion Detection
• OWASP Application Security Verification Standard: V7: 
Error Handling and
外部资料
• CWE-223: Omission of Security-relevant Information
• CWE-778: Insufficient Logging
如何防止？
• 记录所有失败的身份验证尝试、拒绝访问和输入验证错误；
• 日志应该使用适合日志管理解决方案的格式来编写，并且
应该包含足够详细的信息来识别恶意的行动者；
• 日志应作为敏感数据处理，其完整性应在空闲和传输时得
到保证；
• 配置一个监控系统，以持续监视基础设施、网络和API功
能；
• 使用安全信息和事件管理系统（SIEM）来整合和管理来
自API和主机的所有组件的日志；
• 配置自定义仪表板和警报，能够更早地检测和响应可疑活
动。
API10:2019 日志和监视不足
可利用性 ：2
普遍性：3
可检测性 ：1
技术：2
攻击者利用缺乏日志记录和监视的机
遇，在未被注意的情况下滥用系统。
如果没有日志和监视，或者日志和监视不足，
那么就几乎不可能跟踪可疑活动并及时响应。
由于无法发现正在进行的恶意活动，
攻击者有足够的时间来完全破坏系
统。
17
创建和维护安全软件或修复现有软件的任务可能很困难，API 也一样。
我们相信教育和意识是编写安全软件的关键因素。为实现这一目标需要的其他所有事务，
都有赖于建立和使用可重复的安全流程和标准安全控制。
从OWASP项目开始以来，OWASP就提供了大量免费和开放的资源来解决安全问题。欢迎
访问 OWASP 项目页面了解可用项目的综合清单。
+D
开发人员下一步做什么？
教育
您可以根据您的专业和兴趣开始阅读OWASP教育项目材料。对于实践学习，
我们在路线图上添加了“Completely Ridiculous API（crAPI）项目” 。同时，
您可以使用OWASP DevSlop Pixi模块实践WebAppSec，这是一个易受攻击
的WebApp和API服务，目的是教用户如何测试现代web应用程序和API的安
全问题，以及如何在将来编写更安全的API。您还可以参加OWASP AppSec
大会的培训环节，或加入您当地的OWASP分部。
安全要求
从一开始，安全就应该是每个项目的一部分。在获取需求时，定义“安全”
对该项目意味着什么是很重要的。OWASP建议您使用OWASP应用程序安
全性验证标准（ASVS）作为设定安全要求的指南。如果您是外包，请考虑
OWASP安全软件合同附件，该附件应根据当地法律法规进行调整。
安全架构
在项目的所有阶段，安全都应该是一个关注点。OWASP Prevention Cheat 
Sheet是指导如何在架构阶段设计安全性的良好起点。而其他内容，您将
找到REST Security Cheat Sheet和REST Assessment Cheat Sheet。
标准的安全控件
采用标准的安全控件减少了在编写自有逻辑时引入安全弱点的风险。尽管
许多现代框架现在都带有内置的标准有效控件，但是OWASP Proactive 
Controls为您提供了一个很好的概述，让您了解应该在项目中包含哪些安
全控件。OWASP还提供了一些您可能会发现有价值的库和工具，例如验证
控件。
软件安全开发
生命周期
在构建API时，可以使用OWASP软件保障成熟度模型（SAMM）来改进流
程。在不同的API开发阶段可以使用其他OWASP项目（如，OWASP代码审
计项目），来帮助您。
18
由于API在现代应用程序架构中的重要性，构建安全的API至关重要。安全不能被忽视，
它应该是整个开发生命周期的一部分。每年的扫描和渗透测试已经不够了。
DevSecOps应该加入到开发工作中，促进整个系统的持续安全测试。他们的目标是在不
影响开发进度的情况下，通过安全自动化来增强开发管道。
如有疑问，请随时了解并经常查阅《DevSecOps宣言》。
+DSO
DevSecOps下一步做什么？
了解威胁模型
测试优先级来自威胁模型。如果您还没有，请考虑参考OWASP应用程
序安全验证标准（ASVS）和OWASP测试指南。让开发团队参与进来可
能有助于提高他们的安全意识。
了解SDLC
加入开发团队以更好地了解软件开发生命周期。您贡献的持续安全测
试需配置有合适的人员、流程和工具方面。每个人都应该同意这个过
程，这样就不会有不必要的摩擦或阻力。
测试策略
由于您的工作不应该影响开发进度，所以您应该明智地选择最佳（简
单、最快、最准确）技术来验证安全需求。OWASP安全知识框架与
OWASP应用程序安全验证标准可以是功能性和非功能性安全需求的重
要来源，其中重要来源还包括其他类似于DevSecOps社区提供的项目和
工具。
实现覆盖范围和准确
性
您是开发人员和运维团队之间的桥梁。要实现覆盖，不仅要关注功能，
还要关注编排。从开始就和开发团队和运维团队紧密合作，您就可以
优化您的时间和效率。您应该追求一个基本安全性不断得到验证的状
态。
清晰地沟通调查结果
贡献价值少或没有摩擦。在开发团队正在使用的工具（不是PDF文件）
中及时交付结果。加入开发团队解决问题。抓住机会指导他们，清楚
地描述漏洞以及如何利用，包括利用漏洞进行的情景。
19
+DAT
方法和数据
概述
由于 AppSec 行业并没有特别关注最近的的应用程序架构（其中 API 发挥着重要作用），
因此，基于公开征集的数据，编制一份包含十大最关键 API 安全风险的列表是一项艰巨的
任务。尽管没有征集公开的数据，但由此产生的十大API安全风险仍然是基于可用的公开
数据、安全专家的贡献、以及与安全社区的公开讨论。
方法和数据
在第一个阶段，由一组安全专家收集、 审查和分类有关 API 安全事件的公开数据。这
样的数据是在一年的时间内从bug赏金平台和漏洞数据库收集的，最终被用于统计。
在下一个阶段，具有渗透测试经验的安全人员被要求编制他们自己的Top 10列表。
采用OWASP 风险评级方法进行风险分析。评分是由安全从业人员进行讨论和审查。有
关这些问题的考虑，请参阅 本文API 安全风险部分。
《OWASP API 安全 Top 10 2019》的初稿是第一阶段统计结果与安全从业人员的列表达
成一致的结果。该草案随后提交给另一组在API安全领域具有相关经验的安全从业人员，
供其参考和审阅。
《OWASP API 安全 Top 10 2019》首次在OWASP Global AppSec Tel Aviv活动上发布
（2019年5月）。从那时起，它就在GitHub上供公众讨论和建议。
本文的贡献者列表请见本文致谢部分。
20
感谢以下人员的贡献
我们要感谢以下在GitHub上或通过其他方式的贡献者:
• 007divyachawla
• Abid Khan
• Adam Fisher
• anotherik
• bkimminich
• caseysoftware
• Chris Westphal
• dsopas
• DSotnikov
• emilva
• ErezYalon
• flascelles
• Guillaume Benats
• IgorSasovets
• Inonshk
• JonnySchnittger
• jmanico
• jmdx
• Keith Casey
• kozmic
• LauraRosePorter
• Matthieu Estrade
• nathanawmk
• PauloASilva
• pentagramz
• philippederyck
• pleothaud
• r00ter
• Raj kumar
• Sagar Popat
• Stephen Gates
• thomaskonrad
• xycloops123
感谢以下参与本中文版本《OWASP API 安全 Top 10 2019》的OWASP中国成员。
•
组长：肖文棣
•
翻译：陈毓灵、黄鹏华、黄圣超、任博伦、张晓鲁（排名不分先后，按姓氏拼音排列）
•
审查：王颉
由于项目组成员水平有限，存在的错误敬请指正。如有任何意见或建议，可联系我们。邮箱：
PI:EMAIL
+ACK
致谢
扫一扫
关注OWASP中国