模型，从而通过模型识别出异常行为。
接口内容敏感识别：数据接口种类繁多，如何正确高效、识别
敏感数据接口并进行行为分析，俨然成为工作难题。本次实践应用
中通过流量探针，在下行流量数据中依赖命名实体识别、规则识别
敏感数据，并对识别的敏感数据接口进行监控，精准管理敏感数据
接口。
应用程序接口（API）数据安全蓝皮报告（2020 年）
40
用户行为异常分析：关注用户对关键业务系统、敏感数据、敏
感文件的操作行为，通过规则、基线等分析手段识别异常行为。
（3）成效
实践中完成 3 个业务风险场景建设，构建 2 套分析模型，日均
处理 200G 数据，共监测识别异常事件 72 起、真实有效事件 67 起。
来源：上海观安信息技术股份有限公司
4.发展趋势
当前，API 安全保护日渐成为网络应用的主要技术需求之一。人
工智能和机械学习作为高效智能化的工具，已经被应用到了协议栈
的各个层面上，以实现 API 的全栈安全防护。就下一步发展趋势来
看，开发人员需要进一步加大对于 API 业务模型、分析能力、技术
蓝图、以及合规性与标准化的深入研究与开发。API 安全实践的发展
趋势包括：DNS 安全、安全设计、人工智能、机械学习驱动等。
应用程序接口（API）数据安全蓝皮报告（2020 年）
41
（三）爱加密 API 安全实践
1.安全方案
爱加密移动应用 API 安全防护方案秉持“分段保护，技术验证”
的思路，在保障 APP 业务功能的前提下，对其调用或集成的 API 进
行事前、事中、事后的全过程安全管理与防护。及时发现潜在的源
码漏洞、破解盗用、异常调用等安全问题，并提供业务、数据、源
码各层面的安全防护。
来源：北京智游网安科技有限公司（爱加密）
爱加密自动化安全扫描工具可针对 API 的源代码安全性、数据
安全性与传输安全性等多方面进行检测，并对缺少源码保护、明文
存储数据、非加密协议传输数据等问题进行重点侦测。
（1）源代码防护检测
源码反编译安全：检测 Java 文件是否进行加壳保护，未加壳可
能面临被反编译的风险。
应用程序接口（API）数据安全蓝皮报告（2020 年）
42
源码混淆检测：检测 API 源代码是否进行混淆处理，代码未进
行混淆会在代码被反编译后导致核心代码可能被窃取，存在逆向代
码还原到源码的风险。
so 文件保护检测：检测 so 文件是否为了实现不同软件之间的数
据共享，设置内部文件为全局可读或全局可写，使得其他应用可以
读取和修改该文件。
H5 代码安全检测：分析 API 中的 html5 文件是否经过混淆/加密
操作。
密钥硬编码检测：检测 API 是否存在将加密算法密钥设定为固
定值，导致不法分子可能通过反编译硬编码密钥破解接口加密机制
情况。
（2）API 安全性检测
敏感信息获取检测：检测 API 中是否存在获取用户敏感信息的
操作。
API 本地数据存储安全检测：检测 API 是否会将用户敏感数据明
文存放在本地缓存目录，私有目录等。
日志数据安全检测：Log 日志是 APP 运行期间自身产生的，是对
程序运行情况的记录和监控，通过 Log 日志可以详细了解 APP 内部
的运行状况。
证书文件明文存储检测：查看 API 资源中是否包含明文的证书
文件。
应用程序接口（API）数据安全蓝皮报告（2020 年）
43
（3）API 数据传输检测
HTTP 协议检测：由于 HTTP 数据传输是明文传输的，导致 HTTP
数据容易被抓取、篡改，泄露用户密码等敏感数据，甚至通过中间
人劫持将原有信息替换成恶意链接或恶意代码程序，以达到远程控
制、恶意扣费等攻击意图。通过使用抓包工具在网络节点设置代理，
侦听抓取 API 业务请求数据包，分析数据报文检查是否使用 http 协
议传输数据。
业务接口漏洞测试：检查 API 是否存在与业务功能无关的服务
器交互接口，通过侦听通信数据中的网络端口类型查看 API 是否存
在可能的越权访问与脚本注入风险。
2.技术手段
自动化业务检测：将 API 恶意代码的行为特征具体化分析，创
造行为自动化检测脚本，通过对真实运行环境的仿真模拟来诱导发
现第三方 API 是否隐藏恶意行为与违规行为，将行为检测技术运用
到检测方法当中，包括：
 检测 API 读取隐私数据，如手机通讯录、通话记录、短信内
容、IMEI、IMSI 等相关行为事件。
 检测 API 完整的网络通讯事件，获取远程服务器 IP（包含地
理区域）、端口号、域名、完整 URL。
 检测 API 隐藏图标动作、执行系统高威胁设置等行为事件。
 检测 API 运行过程隐蔽安装插件安装包行为事件。
应用程序接口（API）数据安全蓝皮报告（2020 年）
44
 检测 API 在运行生命周期内新建文件、编辑文件、删除文件
等所有行为事件。
VMP 高强度代码加固：市面上普遍对 256 个 OpCode，进行了自
定义指令替换，具体的操作数语法组合并不做处理。爱加密 VMP 对
OpCode 指令以及操作数都同时进行了指令转换处理，涉及操作数语
法组合大概 541 种，在加密细粒度和强度方面具有显著优势。
API 探针技术：API 威胁感知可以进行自定义埋点探针数据采集，
在后台对 APP 进行流程位置埋点探针，收集该埋点探针数据，在应
用上线后埋点探针可进行远程操作，而后埋点下发。爱加密威胁感
知系统支持多种响应形式的自定义下发，包括自定义弹窗，退出，
提示，悬浮球，打开链接，启动应用，toast 提示，通知栏，预下载，
下载并安装，跳转指定页面等。
3.实践应用
（1）运营商计费类 API 公开共享场景应用
某运营商开发自有计费 API 用于提供 App 内计费系统交易结算。
由于缺少代码层面安全防护，API 接口遭到恶意破解，计费逻辑与关
键文件被窃取，计费流程的完整性遭到破坏，导致交易破解与恶意
计费事件发生。此外，遭破解的计费 API 可能被二次打包为携带违
法广告、木马程序等内容的盗版 API，成为违法违规内容传播的载体。
应用程序接口（API）数据安全蓝皮报告（2020 年）
45
来源：北京智游网安科技有限公司（爱加密）
爱加密通过技术手段对运营商计费类 API 进行源码保护，提高
源码复杂度与完整性校验，防止被黑客破解分析，探知核心业务流
程。同时对关键业务流程进行过程监控，对关键交易进行二次验证。
此应用场景下采取如下保护措施：
 对 API 源代码进行加固处理，防止非法破解。API 加固保护包
括对 jar 文件代码的虚拟化处理、so 库文件的安全防护等安全加固
内容。同时防止 so 库被非法调用，对 App 的使用进行权限管理。
 增加威胁感知探针，对 API 业务运行时的状态进行感知。在
计费 API 运行时对关键核心步骤进行二次校验，对关键业务核心点
进行完整性验证，出现的异常行为及时预警或阻断。
（2）互联网企业认证 API 对外开放场景应用
某互联网企业为推广业务吸引流量，向第三方开发企业与个人
开放了自身 APP 的认证 API，实现便捷登录功能。由于未对 API 进行
安全检测，被黑客通过 API 中的通讯录匹配功能暴力匹配用户姓名
和密码，将海量黑产数据转化为有价值的用户账号数据在黑市兜售，
应用程序接口（API）数据安全蓝皮报告（2020 年）
46
给企业带来极大的经济和社会信誉损失。
来源：北京智游网安科技有限公司（爱加密）
互联网企业在向社会公开自己的 API 时，需要对 API 做全面的
安全检测，及时发现代码层面、数据层面与接口传输层面的安全漏
洞，与 App 业务功能无关的接口应及时注销关闭，防止其被破解后
形成潜在业务隐患。
此应用场景下采取如下保护措施：
 检测 API 源代码是否进行混淆，加固等安全技术处理。防止
攻击者通过反编译工具得到 API 的代码后直接可读可定位等风险。
 检测是否含有遗留日志数据，防止黑客通过 Log 日志详细了
解 API 内部的运行流程。防止通过对日志搜索进行程序代码定位，
从而找到 API 中关键代码进行分析修改。
 增加威胁感知探针，对 API 运行时的业务请求频率进行监控。
在出现高频率、涉及敏感数据的业务时向服务后台进行预警与客户
端的防御响应。
应用程序接口（API）数据安全蓝皮报告（2020 年）
47
4.产品研发
目前 API 接口根据不同 APP 的开发场景被广泛集成到海量 SDK
中进行使用。爱加密结合其移动应用 SDK 领域安全积累，建立移动
SDK/API 资产互联网监控平台，通过大数据分析模型，提升相关风险
预警的准确性和防护策略的有效性。
来源：北京智游网安科技有限公司（爱加密）
该平台依托于爱加密移动安全大数据平台的监管能力，针对数
百万 APP 使用的 SDK/API 进行专向分类管理，当企业需要使用第三
方 SDK/API 时，可通过爱加密安全大数据平台获取详细的状态与使
用范围信息。
此外，平台提供针对企业自研 SDK/API 登记备案和管理功能，
可对企业自研 SDK/API 是否遭违法违规调用进行快速查询和验证。
平台提供的 API 全质量常态监测服务可对重大、突发安全漏洞实现
第一时间检测与记录回馈，配合移动威胁感知系统的前端响应能力，
应用程序接口（API）数据安全蓝皮报告（2020 年）
48
阻断风险扩散，精确划分影响范围，最大限度减小由于安全原因带
来的负面影响。
中国信息通信研究院 安全研究所
地址：北京市海淀区花园北路 52 号
邮政编码：100191
联系电话：010-62308590
010-62308790
传真：010-62300264
网址：www.caict.ac.cn