primitiveonly.Thesplitbetweenjumpandremote-execgivesyouflexibilitytodecidehowto
weaponizeanexecute-onlyprimitive.
AggressorScripthasanAPItoaddnewmodulestojumpandremote-exec.SeetheAggressor
Scriptdocumentation(theBeaconchapter,specifically)formoreinformation.
Lateral Movement GUI
CobaltStrikealsoprovidesaGUItomakelateralmovementeasier.SwitchtotheTargets
VisualizationorgotoView->Targets.Navigateto[target]->Jumpandchooseyourdesired
lateralmovementoption.
Thefollowingdialogwillopen:
UserGuide www.helpsystems.com page:82
PostExploitation/OtherCommands
Figure39.LateralMovementDialog
Tousethisdialog:
First,decidewhichtrustyouwanttouseforlateralmovement.Ifyouwanttousethetokenin
oneofyourBeacons,checktheUsesession’scurrentaccesstokenbox.Ifyouwanttouse
credentialsorhashesforlateralmovement—that’sOKtoo.Selectcredentialsfromthe
credentialstoreorpopulatetheUser,Password,andDomainfields.Beaconwillusethis
informationtogenerateanaccesstokenforyou.Keepinmind,youneedtooperatefromahigh
integritycontext[administrator]forthistowork.
Next,choosethelistenertouseforlateralmovement.TheSMBBeaconisusuallyagood
candidatehere.
Last,selectwhichsessionyouwanttoperformthelateralmovementattackfrom.CobaltStrike’s
asynchronousmodelofoffenserequireseachattacktoexecutefromacompromisedsystem.
ThereisnooptiontoperformthisattackwithoutaBeaconsessiontoattackfrom.Ifyou’reon
aninternalengagement,considerhookingaWindowssystemthatyoucontrolandusethatas
yourstartingpointtoattackothersystemswithcredentialsorhashes.
PressLaunch.CobaltStrikewillactivatethetabfortheselectedBeaconandissuecommandsto
it.FeedbackfromtheattackwillshowupintheBeaconconsole.
Other Commands
Beaconhasafewothercommandsnotcoveredabove.
TheclearcommandwillclearBeacon'stasklist.Usethisifyoumakeamistake.
TypeexittoaskBeacontoexit.
Usekill[pid]toterminateaprocess.
UserGuide www.helpsystems.com page:83
BrowserPivoting/Overview
UsetimestomptomatchtheModified,Accessed,andCreatedtimesofonefiletothoseof
anotherfile.
Browser Pivoting
MalwarelikeZeusanditsvariantsinjectthemselvesintoauser’sbrowsertostealbanking
information.Thisisaman-in-the-browserattack.So-called,becausetheattackerisinjecting
malwareintothetarget’sbrowser.
Overview
Man-in-the-browsermalwareusestwoapproachestostealbankinginformation.Theyeither
captureformdataasit’ssenttoaserver.Forexample,malwaremighthookPR_WriteinFirefox
tointerceptHTTPPOSTdatasentbyFirefox.Or,theyinjectJavaScriptontocertainwebpages
tomaketheuserthinkthesiteisrequestinginformationthattheattackerneeds.
CobaltStrikeoffersathirdapproachforman-in-the-browserattacks.Itletstheattackerhijack
authenticatedwebsessions—allofthem.Onceauserlogsontoasite,anattackermayaskthe
user’sbrowsertomakerequestsontheirbehalf.Sincetheuser’sbrowserismakingtherequest,
itwillautomaticallyre-authenticatetoanysitetheuserisalreadyloggedonto.Icallthisa
browserpivot—becausetheattackerispivotingtheirbrowserthroughthecompromiseduser’s
browser.
Figure40.BrowserPivotinginAction
CobaltStrike’simplementationofbrowserpivotingforInternetExplorerinjectsanHTTPproxy
serverintothecompromiseduser’sbrowser.Donotconfusethiswithchangingtheuser’sproxy
settings.Thisproxyserverdoesnotaffecthowtheusergetstoasite.Rather,thisproxyserver
isavailabletotheattacker.Allrequeststhatcomethroughitarefulfilledbytheuser’sbrowser.
UserGuide www.helpsystems.com page:84
BrowserPivoting/Setup
Setup
TosetupBrowserpivoting,goto[beacon]->Explore->BrowserPivot.ChoosetheInternet
Explorerinstancethatyouwanttoinjectinto.Youmayalsodecidewhichporttobindthe
browserpivotingproxyservertoaswell.
Figure41.StartaBrowserPivot
Bewarethattheprocessyouinjectintomattersagreatdeal.InjectintoInternetExplorerto
inheritauser’sauthenticatedwebsessions.ModernversionsofInternetExplorerspawneach
tabinitsownprocess.IfyourtargetusesamodernversionofInternetExplorer,youmustinject
aprocessassociatedwithanopentabtoinheritsessionstate.Whichtabprocessdoesn’tmatter
(childtabssharesessionstate).
IdentifyInternetExplorertabprocessesbylookingatthePPIDvalueintheBrowserPivoting
setupdialog.IfthePPIDreferencesexplorer.exe,theprocessisnotassociatedwithatab.Ifthe
PPIDreferencesiexplore.exe,theprocessisassociatedwithatab.CobaltStrikewillshowa
checkmarknexttotheprocessesitthinksyoushouldinjectinto.
OnceBrowserPivotingissetup,setupyourwebbrowsertousetheBrowserPivotProxyserver.
Remember,CobaltStrike’sBrowserPivotserverisanHTTPproxyserver.
UserGuide www.helpsystems.com page:85
BrowserPivoting/Use
Figure42.ConfigureBrowserSettings
Use
Youmaybrowsethewebasyourtargetuseroncebrowserpivotingisstarted.Bewarethatthe
browserpivotingproxyserverwillpresentitsSSLcertificateforSSL-enabledwebsitesyouvisit.
Thisisnecessaryforthetechnologytowork.
Thebrowserpivotingproxyserverwillaskyoutoaddahosttoyourbrowser’struststorewhen
itdetectsanSSLerror.AddthesehoststothetruststoreandpressrefreshtomakeSSL
protectedsitesloadproperly.
Ifyourbrowserpinsthecertificateofatargetsite,youmayfinditsimpossibletogetyour
browsertoacceptthebrowserpivotingproxyserver’sSSLcertificate.Thisisapain.Oneoption
istouseadifferentbrowser.TheopensourceChromiumbrowserhasacommand-lineoptionto
ignoreallcertificateerrors.Thisisidealforbrowserpivotinguse:
chromium --ignore-certificate-errors --proxy-server=[host]:[port]
TheabovecommandisavailablefromView->ProxyPivots.HighlighttheBrowserPivotHTTP
ProxyentryandpressTunnel.
TostoptheBrowserPivotproxyserver,typebrowserpivotstopinitsBeaconconsole.
Youwillneedtoreinjectthebrowserpivotproxyserveriftheuserclosesthetabyou’reworking
from.TheBrowserPivottabwillwarnyouwhenitcan’tconnecttothebrowserpivotproxy
serverinthebrowser.
UserGuide www.helpsystems.com page:86
Pivoting/HowBrowserPivotingWorks
NOTE:
OpenJDK11hasaTLSimplementationbugthatcausesERR_SSL_PROTOCOL_ERROR
(Chrome/Chromium)andSSL_ERROR_RX_RECORD_TOO_LONG(Firefox)wheninteracting
withhttps://sites.Ifyouencountertheseerrors--downgradeyourteamservertoOracle
Java1.8orOpenJDK10.
How Browser Pivoting Works
InternetExplorerdelegatesallofitscommunicationtoalibrarycalledWinINet.Thislibrary,
whichanyprogrammayuse,managescookies,SSLsessions,andserverauthenticationforits
consumers.CobaltStrike’sBrowserPivotingtakesadvantageofthefactthatWinINet
transparentlymanagesauthenticationandreauthenticationonaperprocessbasis.
ByinjectingCobaltStrike’sBrowserPivotingtechnologyintoauser’sInternetExplorerinstance,
yougetthistransparentreauthenticationforfree.
Pivoting
What is Pivoting
Pivoting,forthesakeofthismanual,isturningacompromisedsystemintoahoppointforother
attacksandtools.CobaltStrike’sBeaconprovidesseveralpivotingoptions.Foreachofthese
options,youwillwanttomakesureyourBeaconisininteractivemode.Interactivemodeis
whenaBeaconchecksinmultipletimeseachsecond.Usethesleep0commandtoputyour
Beaconintointeractivemode.
SOCKS Proxy
Goto[beacon]->Pivoting->SOCKSServertosetupaSOCKS4aproxyserveronyourteam
server.Or,usesocks8080tosetupaSOCKS4aproxyserveronport8080(oranyotherport
youchoose).
AllconnectionsthatgothroughtheseSOCKSserversturnintoconnect,read,write,andclose
tasksfortheassociatedBeacontoexecute.YoumaytunnelviaSOCKSthroughanytypeof
Beacon(evenanSMBBeacon).
Beacon’sHTTPdatachannelisthemostresponsiveforpivotingpurposes.Ifyou’dliketopivot
trafficoverDNS,usetheDNSTXTrecordcommunicationmode.
ToseetheSOCKSserversthatarecurrentlysetup,gotoView->ProxyPivots.
UsesocksstoptodisabletheSOCKSproxyserver.
UserGuide www.helpsystems.com page:87
Pivoting/ReversePortForward
Proxychains
TheproxychainstoolwillforceanexternalprogramtouseaSOCKSproxyserverthatyou
designate.Youmayuseproxychainstoforcethird-partytoolsthroughCobaltStrike’sSOCKS
server.Tolearnmoreaboutproxychains,visit:http://proxychains.sourceforge.net/
Metasploit
YoumayalsotunnelMetasploitFrameworkexploitsandmodulesthroughBeacon.Createa
BeaconSOCKSproxyserver[asdescribedabove]andpastethefollowingintoyourMetasploit
Frameworkconsole:
setg Proxies socks4:team server IP:proxy port
setg ReverseAllowProxy true
ThesecommandswillinstructtheMetasploitFrameworktoapplyyourProxiesoptiontoall
modulesexecutedfromthispointforward.Onceyou’redonepivotingthroughBeaconinthis
way,useunsetgProxiestostopthisbehavior.
Ifyoufindtheabovetoughtoremember,gotoView->ProxyPivots.Highlighttheproxypivot
yousetupandpressTunnel.ThisbuttonwillprovidethesetgProxiessyntaxneededtotunnel
theMetasploitFrameworkthroughyourBeacon.
Reverse Port Forward
Thefollowingcommandsareavailable:
NOTE:
TypehelpintheBeaconconsoletoseeavailablecommands.Typehelpfollowedbya
commandnametoseedetailedhelp.
rportfwd-UsethiscommandtosetupareversepivotthroughBeacon.Therportfwdcommand
willbindaportonthecompromisedtarget.Anyconnectionstothisportwillcauseyour
CobaltStrikeservertoinitiateaconnectiontoanotherhostandportandrelaytraffic
betweenthesetwoconnections.CobaltStriketunnelsthistrafficthroughBeacon.
Thesyntaxforrportfwdis:rportfwd[bindport][forwardhost][forwardport].
rportfwd_local-UsethiscommandtosetupareversepivotthroughBeaconwithonevariation.
Thisfeatureinitiatesaconnectiontotheforwardhost/portfromyourCobaltStrikeclient.
TheforwardedtrafficiscommunicatedthroughtheconnectionyourCobaltStrikeclient
hastoitsteamserver.
rportfwdstop[bindport]-Usetodisablethereverseportforward.
UserGuide www.helpsystems.com page:88
Pivoting/SpawnandTunnel
Spawn and Tunnel
Usethespunnelcommandtospawnathird-partytoolinatemporaryprocessandcreatea
reverseportforwardforit.Thesyntaxisspunnel[x86orx64][controllerhost][controllerport]
[/path/to/agent.bin].Thiscommandexpectsthattheagentfileisposition-independentshellcode
(usuallytherawoutputfromanotheroffenseplatform).Thespunnel_localcommandisthesame
asspunnel,exceptitinitiatesthecontrollerconnectionfromyourCobaltStrikeclient.The
spunnel_localtrafficiscommunicatedthroughtheconnectionyourCobaltStrikeclienthastoits
teamserver.
Agent Deployed: Interoperability with Core
Impact
ThespunnelcommandsweredesignedspecificallytotunnelCoreImpact'sagentthroughCobalt
Strike'sBeacon.CoreImpactisapenetrationtestingtoolandexploitframeworkalsoavailable
forlicensefromHelpSystemsathttps://www.coresecurity.com/products/core-impact
ToexportarawagentfilefromCoreImpact:
1. ClicktheModulestabintheCoreImpactuserinterface
2. SearchforPackageandRegisterAgent
3. Double-clickthismodule
4. ChangePlatformtoWindows
5. ChangeArchitecturetox86-64
6. ChangeBinaryTypetoraw
7. ClickTargetFileandpress...todecidewheretosavetheoutput.
8. GotoAdvanced
9. ChangeEncryptCodetofalse
10. GotoAgentConnection
11. ChangeConnectionMethodtoConnectfromTarget
12. ChangeConnectBackHostnameto127.0.0.1
13. ChangePorttosomevalue(e.g.,9000)andrememberit.
14. PressOK.
TheabovewillgenerateaCoreImpactagentasarawfile.Youmayusespunnelx64orspunnel_
localx64torunthisagentandtunnelitbacktoCoreImpact.
WeoftenuseCobaltStrikeonaninternetreachableinfrastructureandCoreImpactisoftenon
alocalWindowsvirtualmachine.It'sforthisreasonwehavespunnel_local.Werecommendthat
yourunaCobaltStrikeclientfromthesameWindowssystemthatCoreImpactisinstalledonto.
Inthissetup,youcanrunspunnel_localx64127.0.0.19000c:\path\to\agent.bin.Oncethe
connectionismade,youwillhearthefamous"AgentDeployed"wavfile.
UserGuide www.helpsystems.com page:89
Pivoting/PivotListeners
WithanImpactagentontarget,youhavetoolstoescalateprivileges,scanandinformation
gatherviamanymodules,launchremoteexploits,andchainotherImpactagentsthroughyour
Beaconconnection.
Pivot Listeners
It’sgoodtradecrafttolimitthenumberofdirectconnectionsfromyourtarget’snetworktoyour
commandandcontrolinfrastructure.Apivotlistenerallowsyoutocreatealistenerthatis
boundtoaBeaconorSSHsession.Inthisway,youcancreatenewreversesessionswithout
moredirectconnectionstoyourcommandandcontrolinfrastructure.
Tosetupapivotlistener,goto[beacon]->Pivoting->Listener….Thiswillopenadialogwhere
youmaydefineanewpivotlistener.
Figure43.ConfigureaPivotListener
ApivotlistenerwillbindtoListenPortonthespecifiedSession.TheListenHostvalue
configurestheaddressyourreverseTCPpayloadwillusetoconnecttothislistener.
Rightnow,theonlypayloadoptioniswindows/beacon_reverse_tcp.Thisisalistenerwithouta
stager.Thismeansyoucan’tembedthispayloadintocommandsandautomationthatexpect
stagers.Youdohavetheoptiontoexportastagelesspayloadartifactandrunittodelivera
reverseTCPpayload.
PivotListenersdonotchangethepivothost’sfirewallconfiguration.Ifapivothosthasahost-
basedfirewall,thismayinterferewithyourlistener.You,theoperator,areresponsiblefor
anticipatingthissituationandtakingtherightstepsforit.
Toremoveapivotlistener,gotoCobaltStrike->Listenersandremovethelistenerthere.
CobaltStrikewillsendatasktoteardownthelisteningsocket,ifthesessionisstillreachable.
UserGuide www.helpsystems.com page:90
Pivoting/CovertVPN
Covert VPN
VPNpivotingisaflexiblewaytotunneltrafficwithoutthelimitationsofaproxypivot.Cobalt
StrikeoffersVPNpivotingthroughitsCovertVPNfeature.CovertVPNcreatesanetwork
interfaceontheCobaltStrikesystemandbridgesthisinterfaceintothetarget’snetwork.
How to Deploy
ToactivateCovertVPN,right-clickacompromisedhost,goto[beacon]->Pivoting->Deploy
VPN.SelecttheremoteinterfaceyouwouldlikeCovertVPNtobindto.Ifnolocalinterfaceis
present,pressAddtocreateone.
Figure44.DeployCovertVPN
CheckClonehostMACaddresstomakeyourlocalinterfacehavethesameMACaddressasthe
remoteinterface.It’ssafesttoleavethisoptionchecked.
PressDeploytostarttheCovertVPNclientonthetarget.CovertVPNrequiresAdministrator
accesstodeploy.
OnceaCovertVPNinterfaceisactive,youmayuseitlikeanyphysicalinterfaceonyoursystem.
UseifconfigtoconfigureitsIPaddress.IfyourtargetnetworkhasaDHCPserver,youmay
requestanIPaddressfromitusingyouroperatingsystemsbuilt-intools.
Manage Interfaces
TomanageyourCovertVPNinterfaces,gotoCobaltStrike->VPNInterfaces.Here,Cobalt
StrikewillshowtheCovertVPNinterfaces,howthey’reconfigured,andhowmanybyteswere
transmittedandreceivedthrougheachinterface.
HighlightaninterfaceandpressRemovetodestroytheinterfaceandclosetheremoteCovert
VPNclient.CovertVPNwillremoveitstemporaryfilesonrebootanditautomaticallyundoes
anysystemchangesrightaway.
PressAddtoconfigureanewCovertVPNinterface.
UserGuide www.helpsystems.com page:91
SSHSessions/TheSSHClient
Figure45.SetupaCovertVPNInterface
Configure an Interface
CovertVPNinterfacesconsistofanetworktapandachanneltocommunicateethernetframes
through.Toconfiguretheinterface,chooseanInterfacename(thisiswhatyouwillmanipulate
throughifconfiglater)andaMACaddress.
YoumustalsoconfiguretheCovertVPNcommunicationchannelforyourinterface.CovertVPN
maycommunicateEthernetframesoveraUDPconnection,TCPconnection,ICMP,orusingthe
HTTPprotocol.TheTCP(Reverse)channelhasthetargetconnecttoyourCobaltStrike
instance.TheTCP(Bind)channelhasCobaltStriketunneltheVPNthroughBeacon.
CobaltStrikewillsetupandmanagecommunicationwiththeCovertVPNclientbasedonthe
LocalPortandChannelyouselect.
TheCovertVPNHTTPchannelmakesuseoftheCobaltStrikewebserver.Youmayhostother
CobaltStrikewebapplicationsandmultipleCovertVPNHTTPchannelsonthesameport.
Forbestperformance,usetheUDPchannel.TheUDPchannelhastheleastamountofoverhead
comparedtotheTCPandHTTPchannels.UsetheICMP,HTTP,orTCP(Bind)channelsifyou
needtogetpastarestrictivefirewall.
WhileCovertVPNhasaflexibilityadvantage,youruseofaVPNpivotoveraproxypivotwill
dependonthesituation.CovertVPNrequiresAdministratoraccess.Aproxypivotdoesnot.
CovertVPNcreatesanewcommunicationchannel.Aproxypivotdoesnot.Youshouldusea
proxypivotinitiallyandmovetoaVPNpivotwhenit’sneeded.
SSH Sessions
The SSH Client
CobaltStrikecontrolsUNIXtargetswithabuilt-inSSHclient.ThisSSHclientreceivestasks
fromandroutesitsoutputthroughaparentBeacon.
UserGuide www.helpsystems.com page:92
SSHSessions/RunningCommands
Right-clickatargetandgotoLogin->sshtoauthenticatewithausernameandpassword.Goto
Login->ssh(key)toauthenticatewithakey.
FromaBeaconconsole,usessh[pid][arch][target][user][password]toinjectintothespecified
processtorunanSSHclientandattempttologintothespecifiedtarget.Usessh[target][user]
[password] (without[pid]and[arch]arguments)tospawnatemporaryprocesstorunanSSH
clientandattempttologintothespecifiedtarget.
Youmayalsousessh-key[pid][arch][target:port][user][/path/to/key.pem]toinjectintothe
specifiedprocesstorunanSSHclientandattempttologintothespecifiedtarget.Usessh-key
[target:port][user][/path/to/key.pem](without[pid]and[arch]arguments)tospawna
temporaryprocesstorunanSSHclientandattempttologintothespecifiedtarget.
NOTE:
ThekeyfileneedstobeinthePEMformat.IfthefileisnotinthePEMformatthenmakea
copyofthefileandconvertthecopywiththefollowingcommand:/usr/bin/ssh-keygen
-f [/path/to/copy] -e -m pem -p.
ThesecommandsrunCobaltStrike’sSSHclient.Theclientwillreportanyconnectionor
authenticationissuestotheparentBeacon.Iftheconnectionsucceeds,youwillseeanew
sessioninCobaltStrike’sdisplay.ThisisanSSHsession.Right-clickonthissessionandpress
InteracttoopentheSSHconsole.
TypehelptoseealistofcommandstheSSHsessionsupports.Typehelpfollowedbyacommand
namefordetailsonthatcommand.
Running Commands
Theshellcommandwillrunthecommandandargumentsyouprovide.Runningcommandsblock
theSSHsessionforupto20sbeforeCobaltStrikeputsthecommandinthebackground.Cobalt
Strikewillreportoutputfromtheselongrunningcommandsasitbecomesavailable.
Usesudo[password][command+arguments]toattempttorunacommandviasudo.Thisalias
requiresthetarget’ssudotoacceptthe–Sflag.
ThecdcommandwillchangethecurrentworkingdirectoryfortheSSHsession.Thepwd
commandreportsthecurrentworkingdirectory.
Upload and Download Files
Thefollowingcommandsareavailable:
NOTE:
TypehelpintheBeaconconsoletoseeavailablecommands.Typehelpfollowedbya
commandnametoseedetailedhelp.
UserGuide www.helpsystems.com page:93
SSHSessions/Peer-to-peerC2
download-Thiscommanddownloadstherequestedfile.Youdonotneedtoprovidequotes
aroundafilenamewithspacesinit.Beaconisbuiltforlowandslowexfiltrationofdata.
Duringeachcheck-in,Beaconwilldownloadafixedchunkofeachfileitstaskedtoget.
ThesizeofthischunkdependsonBeacon’scurrentdatachannel.TheHTTPandHTTPS
channelspulldatain512KBchunks.
downloads-UsetoseealistoffiledownloadsinprogressforthecurrentBeacon.
cancel-Issuethiscommand,followedbyafilename,tocanceladownloadthat’sinprogress.You
mayusewildcardswithyourcancelcommandtocancelmultiplefiledownloadsatonce.
upload-Thiscommanduploadsafiletothehost.
timestomp-Whenyouuploadafile,youwillsometimeswanttoupdateitstimestampstomake
itblendinwithotherfilesinthesamefolder.Thiscommandwilldothis.Thetimestomp
commandmatchestheModified,Accessed,andCreatedtimesofonefiletoanotherfile.
GotoView->DownloadsinCobaltStriketoseethefilesthatyourteamhasdownloadedsofar.
Onlycompleteddownloadsshowupinthistab.
Downloadedfilesarestoredontheteamserver.Tobringfilesbacktoyoursystem,highlight
themhere,andpressSyncFiles.CobaltStrikethendownloadstheselectedfilestoafolderof
yourchoosingonyoursystem.
Peer-to-peer C2
SSHsessionscancontrolTCPBeacons.UsetheconnectcommandtoassumecontrolofaTCP
Beaconwaitingforaconnection.UseunlinktodisconnectaTCPBeaconsession.
Goto[session]->Listeners->PivotListener…tosetupapivotlistenertiedtothisSSHsession.
ThiswillallowthiscompromisedUNIXtargettoreceivereverseTCPBeaconsessions.This
optiondoesrequirethattheSSHdaemon’sGatewayPortsoptionissettoyesorClientSpecified.
SOCKS Pivoting and Reverse Port
Forwards
Thefollowingcommandsareavailable:
NOTE:
TypehelpintheBeaconconsoletoseeavailablecommands.Typehelpfollowedbya
commandnametoseedetailedhelp.
socks-UsethiscommandtocreateaSOCKSserveronyourteamserverthatforwardstraffic
throughtheSSHsession.Therportfwdcommandwillalsocreateareverseportforward
thatroutestrafficthroughtheSSHsessionandyourBeaconchain.
Thereisonecaveattorportfwd:therportfwdcommandaskstheSSHdaemontobindtoall
interfaces.It’squitelikelytheSSHdaemonwilloverridethisandforcetheporttobindto
localhost.YouneedtochangetheGatewayPortsoptionfortheSSHdaemontoyesor
clientspecified.
UserGuide www.helpsystems.com page:94
MalleableCommandandControl/Overview
Malleable Command and Control
Overview
Beacon'sHTTPindicatorsarecontrolledbyaMalleableCommandandControl(MalleableC2)
profile.AMalleableC2profileisasimpleprogramthatspecifieshowtotransformdataand
storeitinatransaction.Thesameprofilethattransformsandstoresdata,interpreted
backwards,alsoextractsandrecoversdatafromatransaction.
Touseacustomprofile,youmuststartaCobaltStriketeamserverandspecifyyourprofileat
thattime.
./teamserver [external IP] [password] [/path/to/my.profile]
YoumayonlyloadoneprofileperCobaltStrikeinstance.
Viewing the Loaded Profile
ToviewtheC2profilethatwasloadedwhentheTeamServerwasstartedselectHelp\
MalleableC2Profileonthemenu.Thisdisplaystheprofileforthecurrentlyselected
TeamServerwhenmultipleTeamServersareconnected.Thedialogisread-only.
Toclosethedialogusethe'x'intheupperrightcornerofthedialog.
TIP:
ThissectioncoverstheMalleableC2featuresrelatedtoflexiblenetworkcommunications.
SeeMalleablePE,ProcessInjection,andPostExploitationonpage111forinformationon
MalleableC2'sstage,process-inject,andpost-exblocks.
Checking for Errors
CobaltStrike’sLinuxpackageincludesac2lintprogram.Thisprogramwillcheckthesyntaxofa
communicationprofile,applyafewextrachecks,andevenunittestyourprofilewithrandom
data.It’shighlyrecommendedthatyoucheckyourprofileswiththistoolbeforeyouloadthem
intoCobaltStrike.