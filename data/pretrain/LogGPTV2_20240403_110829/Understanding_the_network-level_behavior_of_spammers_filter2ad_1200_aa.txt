# Understanding the Network-Level Behavior of Spammers

**Authors:**
Anirudh Ramachandran and Nick Feamster  
College of Computing, Georgia Tech  
{avr, feamster}@cc.gatech.edu

## Abstract
This paper examines the network-level behavior of spammers, including the IP address ranges that generate the most spam, common spamming methods (e.g., BGP route hijacking, botnets), the persistence of spamming hosts over time, and the characteristics of spamming botnets. We analyze a 17-month trace of over 10 million spam messages collected at an Internet "spam sinkhole" and correlate this data with IP-based blacklist lookups, passive TCP fingerprinting information, routing data, and botnet command-and-control traces.

Our findings indicate that most spam originates from a few specific regions of IP address space, and spammers often use transient bots that send only a few emails over very short periods. Additionally, a small but significant amount of spam comes from IP addresses associated with short-lived BGP routes, typically for hijacked prefixes. These trends suggest that developing algorithms to identify botnet membership, filtering email based on network-level properties (which are less variable than email content), and improving the security of the Internet routing infrastructure may be highly effective in combating spam.

## Categories and Subject Descriptors
C.2.0 [Computer Communication Networks]: Security and protection; C.2.3 [Computer Communication Networks]: Network operations â€“ network management

## General Terms
Design, Management, Reliability, Security

## Keywords
Spam, Botnet, BGP, Network Management, Security

## 1. Introduction
This paper presents a study of the network-level characteristics of unsolicited commercial email ("spam"). While much attention has been devoted to the content of spam, comparatively little focus has been given to its network-level properties. Conventional wisdom suggests that most spam is generated by botnets and that a large fraction originates from Asia. However, there is limited quantitative data to support these claims.

The primary goal of this paper is to shed light on several relatively unstudied questions, such as the distribution of spam across different techniques (e.g., botnets, short-lived route announcements, open relays), the geographic and topological distribution of spam origins, the extent to which different spammers use the same network resources, and the stationarity of these properties over time.

Understanding the network-level behavior of spammers can be a valuable asset in designing more robust spam filters. Spammers have the flexibility to alter the content of emails to evade filters, but they have far less flexibility when it comes to altering network-level properties such as IP addresses or ISP usage. This paper characterizes the network-level behavior of spammers using a 17-month trace of over 10 million spam messages collected at a large spam sinkhole. We also analyze BGP route advertisements, botnet command-and-control traces, and legitimate email logs from a major email service provider.

Our key findings include:
- The majority of spam originates from a few concentrated portions of IP address space.
- Most received spam is sent from Windows hosts, each sending a relatively small volume of spam.
- A small set of sophisticated spammers use short-lived BGP route announcements to remain untraceable.

These findings provide a unique insight into the interplay between spam, botnets, and the Internet routing infrastructure. While our dataset represents a single vantage point, it offers a comprehensive view of spamming behavior that can inform the development of more effective spam mitigation techniques.

## 2. Background and Related Work
### 2.1 Spam: Methods and Mitigation
#### 2.1.1 Spamming Methods
Spammers use various techniques to send large volumes of mail while remaining untraceable. These methods range from conventional approaches to more sophisticated ones:
- **Direct Spamming:** Spammers purchase connectivity from "spam-friendly ISPs" or use pools of disposable dial-up IP addresses to spoof their origin.
- **Open Relays and Proxies:** Exploiting open relays and proxies for anonymity and amplification.
- **Botnets:** Using collections of compromised machines (e.g., Bobax, Agobot, SDBot) to send spam.
- **BGP Spectrum Agility:** Briefly announcing (often hijacked) IP address space to send spam and then withdrawing the routes.

#### 2.1.2 Mitigation Techniques
Common spam mitigation techniques include:
- **Content-Based Filtering:** Classifying emails based on their content, though spammers can easily alter content to evade these filters.
- **Blacklists:** Using lists of known spammers, open relays, and open proxies, but these can become less effective as spammers adopt more sophisticated techniques.

### 2.2 Related Work
Previous studies have examined spamming and spam-mitigation techniques, as well as the behavior of worms and botnets. Our study is the first to perform a joint analysis of spamming behavior, botnet characteristics, and Internet routing to better understand the network-level behavior of spammers.

## 3. Data Collection
Our primary dataset consists of spam email messages collected at a large spam sinkhole. We augment this with three additional data sources:
- **Legitimate Email Logs:** To compare network-level characteristics of spam with those of legitimate email.
- **Bobax Botnet Traces:** To identify IP addresses infected with the Bobax worm.
- **BGP Routing Data:** To monitor the routing activity for IP prefixes corresponding to spam-sending IP addresses.

## 4. Distribution of Spammers, Botnets, and Legitimate Mail Senders
We find that the vast majority of spam originates from a few concentrated portions of IP address space. Most legitimate email also comes from these regions, suggesting that effective filtering based on network-level properties may require identifying second-order characteristics, such as botnet membership.

## 5. Relationship Between Spam and Known Spamming Bots
Most received spam is sent from Windows hosts, each sending a relatively small volume of spam. Most bots send a small number of spam messages and are active for short periods, indicating the transient nature of spamming activities.

## 6. Use of Unreachable IP Addresses
A small set of sophisticated spammers use short-lived BGP route announcements to send spam untraceably. This new class of attack involves hijacking large IP address blocks and sending spam from widely dispersed "dark" IP addresses within this space.

## 7. Recommendations for More Effective Mitigation Techniques
Based on our findings, we offer the following recommendations:
- **Securing the Routing Infrastructure:** To prevent spammers from using BGP spectrum agility.
- **Monitoring Network-Wide Spam Patterns:** To attribute higher suspicion to networks with high spam activity.
- **Incorporating Network-Level Properties into Filters:** To improve robustness and stop spam closer to its source.

## 8. Conclusion
This paper provides a comprehensive analysis of the network-level behavior of spammers, highlighting the importance of understanding and addressing these behaviors in the design of more effective spam mitigation techniques.