title:Clustering and the Weekend Effect: Recommendations for the Use of
Top Domain Lists in Security Research
author:Walter Rweyemamu and
Tobias Lauinger and
Christo Wilson and
William K. Robertson and
Engin Kirda
Clustering and the Weekend Eﬀect:
Recommendations for the Use of Top
Domain Lists in Security Research
Walter Rweyemamu(B), Tobias Lauinger, Christo Wilson, William Robertson,
and Engin Kirda
Northeastern University, Boston, MA, USA
PI:EMAIL
Abstract. Top domain rankings (e.g., Alexa) are commonly used in
security research, such as to survey security features or vulnerabilities
of “relevant” websites. Due to their central role in selecting a sample of
sites to study, an inappropriate choice or use of such domain rankings can
introduce unwanted biases into research results. We quantify various char-
acteristics of three top domain lists that have not been reported before.
For example, the weekend eﬀect in Alexa and Umbrella causes these
rankings to change their geographical diversity between the workweek
and the weekend. Furthermore, up to 91% of ranked domains appear
in alphabetically sorted clusters containing up to 87k domains of pre-
sumably equivalent popularity. We discuss the practical implications of
these ﬁndings, and propose novel best practices regarding the use of top
domain lists in the security community.
1 Introduction
In recent years, security research has seen the emergence of Internet measure-
ments as a subdiscipline aiming to quantify the prevalence of security risks or
vulnerabilities in practice. Since many types of security assessments do not easily
scale to the entire Internet, researchers typically consider only a subset of regis-
tered domains. Often, they decide to cover the most popular domains, that is,
those receiving the most visitors [14,18,27,32]. In doing so, they rely on “top site”
rankings such as the lists compiled by Alexa [2], Majestic [6], Quantcast [7] and
Umbrella [4]. Consequently, these top site lists play a central role in many studies;
they decide which domain will or will not be included in the measured sample.
Alexa’s list in particular has become nearly ubiquitous, with multiple papers
using it at any major security and Internet measurement conference [20,30].
Many authors have commented individually on shortcomings of Alexa’s rank-
ing (e.g., lack of reliability in the bottom ranks [29], presence of malicious
domains [23,24,28]) and devised their own ad-hoc mitigations to make their
research results more robust against these issues (e.g., using only a list pre-
ﬁx [9,22], using multiple domain lists [13,19], and using only domains that have
been present on the list for a longer time period [9,22]). Yet, researchers are
c(cid:2) Springer Nature Switzerland AG 2019
D. Choﬀnes and M. Barcellos (Eds.): PAM 2019, LNCS 11419, pp. 161–177, 2019.
https://doi.org/10.1007/978-3-030-15986-3_11
162
W. Rweyemamu et al.
just beginning to investigate these issues in a more systematic way. In 2018,
Scheitle et al. [30] and Le Pochat et al. [20] performed rigourous analyses on
the nature of top lists. These works aim to understand the construction of these
lists, including: how they model popularity, what their data sources are, how
fast they change, and how resilient they are to manipulation attempts. While
these papers have shed light on many important characteristics of top domain
lists, several aspects have gone unnoticed, or have received less attention than
they deserve.
Speciﬁcally, Scheitle et al. mention a periodic weekend eﬀect in Alexa’s and
Umbrella’s lists [30], becoming manifest in a higher degree of change each week-
end. We conduct a more in-depth analysis of the weekend eﬀect by studying the
content categories of the respective websites, conﬁrming the authors’ cursory
ﬁnding that the weekend eﬀect is likely due to a dominance of leisure traﬃc dur-
ing the weekend, and oﬃce traﬃc during the workweek. In addition, we show that
the weekend eﬀect causes changes even among the highest ranked domains in
Umbrella, whereas these domains tend to be more stable in Alexa. The weekend
eﬀect also aﬀects country representation in the lists. These phenomena highlight
the need for a more robust and stable domain selection process.
Beyond the brief reference by Le Pochat et al. [20], we are the ﬁrst to quantify
in detail how Alexa and Umbrella cluster domain names of equivalent popularity,
while assigning them individual ranks. In fact, more than 54% of domains in
Alexa, and 91% in Umbrella, appear in such alphabetically ordered clusters that
can reach a size of up to 87k domains. If not accounted for, the alphabetic
ordering caused by clustering can cause anomalies when correlating a domain’s
rank with a measured property.
By characterising clustering and the weekend eﬀect, we contribute to a better
understanding of the limitations of top domain lists. We distill our ﬁndings
into concrete recommendations by proposing novel best practices for the use of
domain lists.
Overall, this paper makes the following contributions:
– We provide a detailed look at weekend changes in Alexa and Umbrella, the
extent of these changes in diﬀerent parts of the list, and the implications on
the content categories and geographical diversity of listed domains.
– We are the ﬁrst to quantify and explain the presence of alphabetically sorted
clusters of domains in Alexa’s and Umbrella’s rankings.
– We discuss the implications of these phenomena for researchers using the
lists in their measurements, and propose novel best practices to minimise
unwanted biases.
2 Background and Related Work
In this paper, we often refer to entries of rankings or lists, but language can be
confusingly ambiguous as to a “high” rank being good or bad. As a convention,
when we write that a rank is higher, we mean that it is a better rank, numerically
lower, towards the top of the list with the most popular entries.
Recommendations for the Use of Top Domain Lists in Security Research
163
Table 1. Data sources of common top site lists.
Table 2. Hidden entries in
quantcast (2018-06-17).
Ranking Data source
List contents
Alexa
Browser toolbar
Typed-in website domains
Majestic Web crawl
Linked website domains
Quantcast Website instrumentation Measured website domains
Umbrella DNS resolver
Resolved (sub)domains
Alexa and Umbrella data from 2018-02-01 to 2018-05-31
Majestic data from 2018-02-28 to 2018-05-31
2.1 Use of Top Lists in Security Research
0
15
List preﬁx Hidden # %
1 − 10
1 − 100
1 − 1, 000
1 − 10, 000
1 − 100, 000 1, 892
1 − 511, 804 5, 045
0.0
15.0
13.6
5.9
1.9
1.0
136
594
Top domain lists such as the Alexa Top Sites are frequently used in security
research. Le Pochat et al. [20] found 102 papers using the Alexa ranking at the
four main security conferences from 2015 to 2017/2018, and Scheitle et al. [30]
found 68 studies using Alexa published at the top measurement, security, and
systems conferences in 2017.
Researchers can use top domain lists in diﬀerent ways. In this paper, we
focus on measurement studies that use these lists to select a “representative”
sample of domains to analyse, in the sense that these lists designate the “largest”
or “most popular” domains (e.g., [14,18,27,32]). When measurement studies
compute aggregates over the domains on these lists, their results depend on how
the lists select and rank domains [20,30].
A less frequent, but common use of domain lists in security research is to
obtain samples of “benign” domains. In this context, domain lists are sometimes
used to train models or evaluate proposed security systems (e.g., [9,10,15,22]).
In a few cases, any ranked domain is whitelisted to improve classiﬁer perfor-
mance [21,26]. This use is most sensitive to malicious domains not appearing in
the ranking, and other list properties such as stability or ordering are less crit-
ical. Maliciousness of ranked domains has been studied before [23,24,28], and
this scenario is beyond the scope of this paper.
2.2 List Compilation Methodology
We are aware of four major measurement-based top site lists: Amazon Alexa
Top Sites [2], The Majestic Million [6], Quantcast Top Websites [7], and Cisco
Umbrella Top 1 Million [4]. Table 1 summarises the data source and popularity
model of each ranking.
Alexa. The data for the ranking originates primarily from “millions of users” [3]
who have installed the Alexa toolbar and share their browsing history with
Alexa. Its website documents Alexa’s methodology as follows: The toolbar only
collects URLs that appear in the address bar of the browser window or tab.
Sudomains are not ranked separately from the main domain, unless they can be
164
W. Rweyemamu et al.
determined to be blogs or personal homepages. Domains are ranked according to
a combination of the number of users visiting the site, and the unique URLs on
that site visited by each user. Ranks below 100k are not statistically meaningful
because the data collected about those domains is too scarce [3,5]. The ranking is
updated daily. Our work uses the ranking from the ﬁle download [1]. In contrast
to the API and website, ranks in the ﬁle do not appear to be smoothed.
Majestic. Majestic’s ranking is based on the link graph built from a continu-
ously updated, proprietary web crawl comprising over 528 B URLs as of June
2018 [6]. Domains are ranked by the number of unique /24 IP networks hosting
inbound links [17].
Quantcast. Ranks are based on direct traﬃc measurements through client-
side tracking code embedded by Quantcast’s customers into their websites and
mobile applications, as well as estimated traﬃc (from unspeciﬁed sources) for
non-customer websites [7]. Quantcast customers can choose to hide their identity
in the ranking. Table 2 shows that around 1% of all list entries are hidden, but
for some list preﬁxes the percentage can be much higher, such as 15% in the
top 100. These censored entries make it challenging to compare this ranking to
others. Therefore, we do not consider it further in this paper.
Umbrella. The ranking is computed from incoming DNS lookups observed in
Cisco’s Umbrella Global Network and the OpenDNS service, which amount to
over 100 B daily requests from 65 M users in 165 countries [4]. Consequently, the
list reﬂects the popularity of domains used in any Internet protocol, not only
web traﬃc. According to Umbrella, ranks are based on the unique client IPs
looking up a domain [16].
2.3 Related Work
In 2006, Lo and Sharma Sedhain compared the lists available at that time to
determine how similar and reliable they were [25]. Out of the lists we initially
considered relevant for this study, they included only Alexa. Given the long
time that has passed since then, it is likely that the ranking methodology and
list composition have changed.
Scheitle et al. [30,31] study the domains on the lists compiled by Alexa,
Umbrella and Majestic, how these lists diﬀer, how they evolve over time, how
they are being used in research studies, how list parameters inﬂuence the out-
come of research studies, and how the rankings could be manipulated. The
authors describe a weekend eﬀect in Alexa and Umbrella, a periodic change in
list composition between weekday and weekend rankings. While the authors con-
vey an intuition as to why this eﬀect exists, we provide a more detailed analysis
of the reasons and implications of this phenomenon. We describe an additional
phenomenon, clustering of equivalent domains in Alexa and Umbrella, which is
not mentioned by Scheitle et al. and discuss potential implications.
Recommendations for the Use of Top Domain Lists in Security Research
165
Le Pochat et al. [20] also quantify several properties of domain lists and
reproduce prior studies using diﬀerent lists, but the focus of their work is on
attacks to inﬂuence the rankings. While the weekend eﬀect is visible in one
of the ﬁgures, it is not further mentioned or analysed. The authors do mention
clustering, but only in an attack context, and without discussing the implications
for research studies relying on these lists.
When discussing their results, both papers make high-level recommendations
how other researchers should use domain lists in their studies. We believe that
this topic warrants more discussion and conclude our paper with several addi-
tional recommendations.
3 List Analysis
In the following, we study weekend eﬀects and clustering in the top 1 M rankings
of Alexa, Majestic, and Umbrella. We downloaded the respective ranking ﬁle
every day. We label the data with the date one day prior to downloading, as a
list updated and downloaded on Monday, for instance, appears to contain the
ranks computed from Sunday data.
3.1 List Stability
We begin our analysis with a look at how much and how fast the rankings change.
In contrast to prior work [20,30], we divide each ranking into non-overlapping
intervals of exponentially increasing length 1–10, 11–100, 101–1,000, etc. This
provides a better view on which parts of the ranking change. The exact order of
domains within each interval does not matter for many uses in security research,
thus we allow for reordering or minor rank changes by calculating set inter-
sections. We pick a single reference day, 2018-02-07 for Alexa and Umbrella,
2018-03-28 for Majestic, and compare all subsequent days upto 2018-05-31 to
this day. This allows us to visually distinguish long-term drift from transient
changes. Figure 1 uses a Wednesday as a representative of the workweek; similar
heatmaps using a Sunday for the weekend can be seen in Fig. 6 in the appendix.
At a high level, the heatmaps show that the top ranked domains exhibit
less change than the lower intervals of the ranking. This is in line with Scheitle
et al. [30], who showed that longer list preﬁxes tend to exhibit lower stability.
In contrast to prior work, our representation reveals that the higher ranks in
Alexa are more stable than in Umbrella, where changes occur within the top 10
domains on a regular basis. The bottom 900k domains, however, are considerably
less stable in Alexa than they are in Umbrella. In the bottom of the plot, most
intervals get lighter in color, corresponding to long-term drift.
Scheitle et al. [30] describe a weekend eﬀect in Alexa and Umbrella, a weekly
pattern where change is highest on the weekend. This pattern appears in the
heatmaps as regular horizontal bands. While only implied by Scheitle et al. the
heatmaps in Fig. 1 conﬁrm that the change is indeed transient, that is, the rank-
ing tends to revert back to the original domains after the weekend. Furthermore,
166
W. Rweyemamu et al.
)
d
d
-
m
m
-
8
1
0
2
(
e
t
a
D
02-07
02-21
03-07
03-21
04-04
04-18
05-02
05-16
05-30
10
100
1 k
List interval
10 k
100 k
1 M
(a) Alexa (Wednesday)
02-07
02-21
03-07
03-21
04-04
04-18
05-02
05-16
05-30
10
100
10 k
1 k
List interval
100 k
1 M
(b) Umbrella (Wednesday)
90
e
c
n
e
r
e
e
r
h
f
75
t
i
w
n
o
m
m
o
c
n
i
i
s
n
a
m
o
D
%
60
45
Fig. 1. Heatmaps showing the set intersection of ranked domains with the reference
day, Wed. 7 February, in exponentially increasing list intervals 1–10, 11–100, 101–1,000,
etc. Horizontal lines correspond to the weekend eﬀect, which is stronger in Umbrella,
whereas Alexa has stronger long-term drift. For Majestic, see Fig. 7 in the appendix.
com
83.5 +0.0
58.8 -2.5
61.9 -0.4
52.4 +0.3
48.3 +0.4
46.8 +1.2
org
ru
de
net
com.br
co.uk
i
n
o
s
n
e
t
x
e
i
n
a
m
o
D
it
ir
pl
10.0 +0.0
1.4 +0.3
2.9 -0.2
3.4 +0.0
4.3 -0.2
5.0 +0.0
4.4 +0.0
2.7 +0.5
3.5 +0.1
3.9 +0.4
4.2 +0.4
2.2 +0.0
1.0 +0.0
1.4 +0.0
1.8 +0.0
4.1 -0.5
4.8 -0.1
4.4 +0.3
4.9 +0.4
5.5 +0.3
4.1 +0.0
1.1 +0.0
0.7 -0.3
1.1 -0.1
1.1 -0.1
2.1 -0.4
2.7 -0.3
0.9 +0.1
0.7 +0.0
0.8 +0.0
2.0 -0.4