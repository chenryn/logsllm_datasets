（3）钓鱼素材和沟通话术准备
选定钓鱼目标后，就要有针对性地准备钓鱼素材和沟通话术。钓
鱼素材的选择取决于钓鱼目标人员的性质，比如：
·对客服人员可以选择服务投诉或问题咨询；
·对人事部门人员可以选择人员岗位应聘或最新人事变动动态；
·对财务人员可以选择目标业务财报或行业投资资讯；
·对商务人员可以选择业务合作或产品推广等。
钓鱼沟通话术准备主要围绕素材开展，比如：
·对客服人员可以用比较强硬的口气，要求问题马上得到解决，
用客户至上的要求给予客服人员压力；
·对人事部门人员则以友好沟通的口气，通过沟通需求建立信
任，伺机发送诱骗文档；
·对财务人员假装进行咨询和评估，用比较专业的口气进行分析
与研讨；
·对商务人员则诱其以利，若即若离，让其主动上当。
（4）进行钓鱼
实战攻防演练中，被攻击目标常常会在演练前向内部人员发出防
范钓鱼攻击的通知或提出相关要求，这就给钓鱼攻击增加了不小的难
度，而蓝队常常通过对钓鱼攻击时机和钓鱼目标心理的把握来提高成
功率。攻击时机最好选择被攻击目标可能心理懈怠而毫无防备之时，
比如：沟通过程比较顺畅，逐渐取得信任的时候；工作日人员容易懈
怠的时候，如周一至周四临近下班时间、周五下午等。对被攻击目标
心理的把握则主要采取换位思考的方式，在沟通交流中提前判断对方
可能采取的下一步动作，及时变换沟通技巧和方法，从而全面掌握主
动，达到“愿者上钩”的最佳钓鱼效果。
3.3.2 内网钓鱼
蓝队内网钓鱼的主要目的是实现在内网中的定向攻击，主要针对
目标网络运维管理人员、重要业务人员或部门领导，因为这些人往往
掌握目标网络或业务比较核心的资源信息，突破这些重要人员的主机
并获取重要的目标网络信息，会给渗透拓展带来很大的便利。内网钓
鱼攻击在攻击目标的选择上具有较强的针对性，并且钓鱼途径也相对
灵活，比如：可以通过内网OA、内网邮件服务器、内网业务文件共
享、内网办公软件更新或内网Web应用水坑钓鱼等途径。同时，因为内
网钓鱼具有较大的信任优势，成功率也会高很多（见图3-11）。
图3-11 实战攻防演练中的内网钓鱼案例
内网钓鱼攻击包括以下几个步骤。
（1）钓鱼目标选定
内网钓鱼主要是为了对内网重点网络或业务系统进行定点渗透拓
展，所以对目标的选择主要根据实际任务的进展需求开展，比如：若
是为了实现对内网重要网络节点进行拓展控制，则主要选择网络运维
管理人员作为钓鱼目标；若是为了对主要核心业务应用进行拓展控
制，则主要选择目标核心业务人员作为钓鱼目标。
（2）钓鱼工具准备
内网钓鱼工具的准备和外网钓鱼工具的准备一样，也需要综合考
虑内网钓鱼途径的选择和钓鱼目标的内网安全防护、杀毒软件类型、
个人办公环境等因素，以确保钓鱼成功。
（3）钓鱼素材和钓鱼话术准备
可根据钓鱼途径灵活选择内网钓鱼素材。通过内网OA、邮件服务
器钓鱼则选择钓鱼目标人员比较感兴趣的素材，比如：
·针对网络运维管理人员，选择与网络安全动态、网络安全建设
有关的素材；
·针对重要业务人员和领导，则选择与目标业务内容或业务系统
应用相关的话题。
另外，所有人员比较关心的薪资、福利问题也是内网不错的钓鱼
素材。如果要通过文件共享、软件更新或内网Web应用挂马途径，则选
择定期业务报告、应用软件升级包或业务动态等与业务密切相关而容
易让人感兴趣的内容作为钓鱼素材。
内网钓鱼的话术选择也相对灵活，因为有信任关系，往往可以开
门见山，用内部领导或同事的口气进行交流，比如：以网络安全通
知、内网软件需要更新、同事问题求助或其他内部关注话题等作为话
题，利用内网信任关系诱导内网目标人员点击中招。
（4）进行钓鱼
实施钓鱼时，内网钓鱼不必像外网钓鱼那样，需要准确把握被攻
击目标的心理和合理时机抛出诱饵，而可以用开门见山的方式直接抛
出话题诱饵。因为内网钓鱼利用的就是信任关系，实施钓鱼时过多的
铺垫反而容易引起对方怀疑，直接抛出诱饵成功率会更高。实施内网
业务文件共享、内网办公软件更新或内网Web应用水坑钓鱼，则要利用
通过目标信息搜集所掌握的情况，充分把握目标内网人员的办公习惯
直接进行文件替换或木马植入。
3.3.3 钓鱼应急措施
蓝队在钓鱼攻击过程中，经常会碰到被质疑或被发现的情况，钓
鱼攻击前就需要做好应急预案，以防引起被攻击目标的警觉或被反向
追踪溯源。采取的常见措施有以下几种。
（1）即使诱骗成功也要适当掩饰
利用诱骗文档钓鱼时，诱骗文档常常不包含诱骗素材的真正内
容，需要在已经触发木马钓鱼成功的情况下，再次发送一份相同素材
主题的正常文档进行掩饰，以免引起对方怀疑。
（2）钓鱼文档异常应对
针对钓鱼文档异常（如文档无法正常打开、目标的杀毒软件报
警）导致对方提出疑问的情况，或假装不知（如在我的电脑上正常，
可能是软件版本、系统环境导致的异常），或用一些专业性的话题蒙
混过关（如文档采用了不常用模板，模板格式问题导致异常），同时
抛出正常文档进行掩饰，再伺机套出对方的杀毒软件类型、系统环
境，然后尽快处理免杀或规避，以备后续改进攻击方式。
（3）反溯源应对
针对被对方发现并有可能被对方分析溯源的情况，需要对钓鱼文
档或木马做好反溯源处理，具体方法如下：
·彻底清除文档或木马编译生成时自动搜集和集成到文档内部的
操作系统、文件路径或计算机用户名信息；
·对木马可执行文件进行加壳或代码混淆处理，增加逆向分析难
度；
·编译木马时对其反弹回连所需的域名、IP地址和端口等关键字
段信息进行加密处理，防止泄露，防止此类敏感信息被分析到；
·木马回连域名、IP地址和端口使用备份机制，每个木马中集成2
个以上回连选择，在1个域名IP地址被封的情况下，备用域名IP地址可
能会发挥作用。
3.4 供应链攻击
供应链攻击也叫第三方攻击，是蓝队在实战攻防演练中采取的一
种迂回攻击手段。目标网络建设所需各项关键基础设施和重要资源严
重依赖第三方产品和服务提供商，并且大多数目标用户对第三方提供
商的产品和服务是信任的，这就为攻击者开展供应链攻击提供了条
件。供应链攻击在外网纵向突破和内网横向拓展中均有运用，外网主
要围绕目标互联网侧的产品漏洞或服务安全入口薄弱点开展，内网则
主要围绕第三方产品或自主开发应用的漏洞开展。供应链攻击具有迂
回隐蔽不易被发现、产品或服务利用环节多样、攻击影响面较大的特
点，成为蓝队越来越依仗的攻击手段。供应链攻击的途径主要有三
种，如图3-12所示。
图3-12 供应链攻击的三种途径
3.4.1 网络或平台提供商
网络或平台提供商是指提供通信基础网络、应用托管平台或服务
器的第三方提供商，主要包括网络提供商、Web应用或服务器托管平
台、云网络平台提供商等。目标网络往往需要借助这些第三方提供商
来接入互联网，提供网络服务平台支撑。对此类第三方提供商开展供
应链攻击，可以接触到目标基础网络或平台底层服务，容易实现对目
标的全面渗透和控制。对于不同的提供商，渗透和控制的实现路径具
体如下。
（1）网络提供商
渗透进入目标网络提供商的网络，在提供商内通过目标网络IP分
配或服务提供的信息定位目标网络接入点（主要是路由网关），利用
该路由网关的信任通联关系或对目标网络的边界路由网关开展渗透，
通过漏洞利用或网络数据劫持，获取目标网络的边界网关或路由控制
权，进一步向目标内网渗透拓展。常见的例子有在APT攻击中，直接对
目标国家/地区的网络基础运营商开展攻击控制，再以此为跳板向受害
目标网络进行渗透拓展。
（2）应用平台提供商
渗透进入目标网络云托管平台、服务器资源提供商网络，根据托
管服务定位目标托管业务的所在位置，渗透获取托管业务的控制权
限，在托管业务中植入恶意代码对目标人员开展水坑攻击，或通过托
管业务寻找托管业务与目标本地网络的接口（主要是托管业务管理接
口），利用漏洞利用或仿冒接入等手段进一步渗透拓展本地网络，获
取目标本地网络的接入控制支点。目前常见的例子有对目标云托管平
台提供商进行渗透，通过获取目标业务托管接入认证信息，并进一步
利用这些认证信息进行接入控制。
此类供应链攻击虽然危害比较大，但是攻击难度大，花费时间
长，所以在实战攻防演练中使用得不多。此类供应链攻击在APT攻击中
使用得较多，因为APT攻击多是针对国家或政府的核心职能部门开展的
网络攻击和渗透。这些核心职能部门的网络往往对外接口非常少，并
且隔离防护非常严，对其开展正面攻击往往难度非常大；但是这些网
络还必须借助基础网络建设或联网，APT攻击就通过这些第三方网络或
平台实现对核心目标网络的迂回渗透。
3.4.2 安全服务提供商
此类供应链攻击主要针对的是将网络安全服务外包的目标网络。
目标网络受限于自身网络安全运维管理的人力或技术水平，常常会将
自身网络建设和安全运维工作交由第三方提供商来完成，第三方提供
商手里就会掌握有关目标网络的重要入口控制信息或大量的网络安全
信息，这在受到供应链攻击时就会带来相当大的安全隐患。攻击者可
以通过攻击第三方安全运维人员，获取运维人员管理目标网络的权
限，并借助其管理权限接入目标网络。这种攻击具有很大的隐蔽性，
因为目标网络无法准确判断通过第三方运维服务进行接入连接的是运