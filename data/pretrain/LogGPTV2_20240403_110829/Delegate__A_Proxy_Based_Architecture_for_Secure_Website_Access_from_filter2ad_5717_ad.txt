More time spent training the proxy may signiﬁcantly reduce
the number of attempts to contact the user via the cell phone
for request validation. Thus, the better the proxy is trained
the easier it should be to use Delegate because false posi-
tives and false negatives are reduced.
5 Security Analysis
The use of a completely untrusted machine provides lim-
itless possibilities for attack. As such, browsing and access-
ing web services from an untrusted device will never be as
secure as using a trusted device. Delegate signiﬁcantly re-
duces the attack surface in order to achieve an acceptable
level of risk.
Using a keystroke logger or by shoulder surﬁng, an at-
tacker cannot acquire secrets belonging to the user because
they are never entered into the untrusted machine. Also, an
attacker cannot sniff for passwords or other secrets on the
local network since the secrets never traverse the network
used by the untrusted machines. An attacker will, however,
be successful in procuring any information entered at the
untrusted machine.
The cell phone is an attractive target for attack because it
has the ability to receive the one-time PINs from the proxy.
If the cell phone is lost or stolen, any previously received
PINs that remain on the phone are worthless. However an
attacker could successfully receive one-time PINs until the
proxy is informed that the phone has been compromised.
The proxy contains user secrets. To mitigate the effects
of a compromise, the proxy should: 1) Run in its own user
space; 2) Keep an audit log; 3) Refuse connections/requests
from any machine other than the one that has supplied the
one-time PIN; and 4) Only allow one active connection.
Web servers also store user secrets which may be acces-
sible to the untrusted machine through two methods. First,
the web server may disclose this information on a web page
sent to the user, either visibly (e.g., the page the user sees
has the info on it) or hidden (e.g., a hidden form value). Sec-
ond, if an attacker asks a web site to send an email-based
password reminder the password, or a link to change it, will
be exposed to the untrusted machine when the user access
her email account. Filtering at the proxy should be able to
counter both these attacks, provided the attack relies com-
pletely on the proxy for information on the user.
Without a successful active attack on the cell phone,
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:32:31 UTC from IEEE Xplore.  Restrictions apply. 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006proxy, or web server, the untrusted machine only has access
to the information that the proxy releases and what it can
glean from publicly available information on the Internet.
Communication Links No security is guaranteed for
communication between the untrusted machine and the
proxy because it is in complete control of the untrusted de-
vice. No assumptions as to the integrity or conﬁdentiality of
the messages passed in either direction of this link should be
made. Even though it provides no guarantees, a TLS con-
nection should be used on this link to avoid passive eaves-
dropping by others on the network. The presentation of a
valid one-time PIN means that the user has given authoriza-
tion to the possessor to forward HTTP requests to the proxy
and that the cell phone is ready to participate in the autho-
rization of those requests. All that attackers should be able
to gain by acquiring a valid PIN is that they can make HTTP
requests to a speciﬁc website via the proxy.
The unidirectional link between the proxy and the cell
phone should provide integrity, conﬁdentiality, and authen-
tication. However this is not a feasible requirement to en-
force for all mobile devices, especially low-end cell phones.
The short-lived nature of the one-time PINS removes some
of the risks of using an insecure connection in this link.
The link between the web server and proxy is controlled
by the proxy. It has the same assurances as any link can
between a trusted machine and a known web server.
The untrusted machine can communicating directly with
the web server, but by withholding the necessary authen-
tication credentials from the untrusted machine prevents it
from impersonating the user.
The untrusted device could attempt to make a communi-
cate directly with the cell phone. These attempts cannot be
prevented, but the user should be alerted if they occur.
Although accessing the website directly through the cell
phone offers great protection to the user’s personal data, the
user loses out on the large screen, full-sized keyboard, band-
width, and processing offered by the untrusted device.
Other Considerations This system is designed so that all
messages must funnel through the proxy, providing a cen-
tral location to audit all activity. The only way to bypass this
auditing system is for malware on the untrusted computer to
establish a direct link with a web service. This should only
be feasible if an attacker has obtained the required authen-
tication credentials. Auditing information recorded after a
compromise of the proxy cannot be trusted.
The security of this system relies on the ability to a user
to recognize invalid requests and not authorize those re-
quests. Messages sent to the cell phone should be clear and
understandable because the user must be able to make an
informed decision based on their contents.
Blocking all outgoing trafﬁc on the untrusted machine
causes a denial of service. A user may interpret this as a
normal technology failure and not an attack, and could sim-
ply access a website directly and disclose sensitive infor-
mation simply to complete a task. Preventing this type of
denial of service is outside of scope of this paper, however
users must be educated in order to avoid this scenario.
By making superﬂuous requests, an attacker could force
the proxy to send a large amount of validation messages to
the user’s cell phone. In Delegate, the user may disable the
current proxy session via the cell phone to end this frustrat-
ing attack. However, the threat of an attacker bombarding
a cell phone with messages remains as there are web and
email interfaces for sending text messages to a cell phone at
no cost to the attacker.
6 Experimental Results
This section describes several experiments we conducted
with the Delegate prototype to measure the overhead intro-
duced by the Delegate system and the beneﬁt of using a
policy based approach to control session hijacking. A full
version of the paper provides more details[11]. The Java-
based proxy was running on a Pentium 4 machine with 512
MB ram and Windows XP. The cell phone used is a Sony
Ericsson w800i capable of running J2ME applications.
In the ﬁrst experiment we measured the delay in mean re-
sponse time for an HTTP request made from the untrusted
public machine that uses Delegate. Delays are due to a) The
proxy intercepting the HTTP requests and ﬁlling in the se-
crets; b) Message transfer between the proxy and the cell
phone; and c) The validation process by the user. It took
less than 1 msec for the proxy to intercept HTTP requests
and ﬁll in the relevant secrets. This time includes the pars-
ing of the HTTP request, secret retrieving and reconstruc-
tion of the HTTP request. Since the proxy runs on a fairly
powerful workstation, the secret ﬁlling time is negligible.
Transferring of a message of 200 bytes using the special-
ized software installed in the cell phone took on an average
420 msecs. Since most messages are less than 200 bytes,
420 msecs could be regarded as the average transfer time of
messages from the proxy to the cell phone. When the same
message was transferred via SMS text messaging, the aver-
age delay was 4 secs. The biggest delay is caused when the
user validates a messages sent from the proxy. The user has
to carefully read the messages and understand them, before
validating them. Since the user’s mind is occupied in this
process, he/she is unlikely to notice this delay.
In the second experiment we measured the beneﬁt of a
policy based approach to control session hijacking. In this
method, requests known to be dangerous are identiﬁed in a
policy. Since PIR requests do not have any distinguishing
characteristics, we assume requests accessing images, mul-
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:32:31 UTC from IEEE Xplore.  Restrictions apply. 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006timedia objects, etc., are not PIR requests. Without a policy,
the proxy considers all SCR and PIR requests as dangerous.
The two important lessons learned from this experiment
are a) a policy based approach signiﬁcantly reduces the val-
idation requirements when compared with automatic ap-
proaches, and b) the average number of validation messages
per session for a typical user is 3.7. In contrast, when no
policy ﬁle is present the average number of validation mes-
sages per session is 23.1. These preliminary results illus-
trate that a trained proxy with site-speciﬁc policies can sig-
niﬁcantly reduce the validation burden on the user. This
is important because it is unlikely that user’s will tolerate
excessive message validation via the cell phone. An open
problem is to identify characteristics that might allow an un-
trained proxy to better automatically identify requests that
users consider dangerous, which would reduce the need for
users or experts to generate policies in advance.
7 Related Work
Ross et al.
[8] created a composable framework for
multi-modal access to content using both trusted and un-
trusted devices. Their system speciﬁes a proxy-based ap-
proach for inserting secrets into requests, scrubbing sensi-
tive data from responses, and validating dangerous requests
through a trusted device. The framework is broad, general-
purpose, and extensible. No low-level details were given
for the rule language used to identify dangerous requests
and not all of the proposed features were implemented.
Wu et al. [9, 10] present a high-level overview of the
proxy-based architecture similar to the one used in this pa-
per. They also provide valuable insights into how actual
users interact with such a system. They do not provide a
solution for session hijacking.
Opera et al. [5] created a system that uses VNC [7] to
connect an untrusted machine to a trusted machine. The
untrusted machine receives short-lived, read-only access to
the trusted machine. This system is not vulnerable to ses-
sion hijacking because all input events must originate from
a trusted mobile device and must arrive via a separate, se-
cure communications channel. Due to the constraints of the
mobile device it may be difﬁcult and tedious to use it as the
sole means of input.
SpyBlock [3] and Vault [4] use virtual machines to pro-
vide a sandbox for potential untrustworthy software, e.g.,
a web browser. Although the trusted and untrusted com-
ponents operate on the same machine, these projects cover
many of the same topics addressed by this paper. SpyBlock
can prompt the user to validate potentially harmful requests
and provides an API for servers to identify potentially dan-
gerous actions.
8 Conclusions
This paper presented Delegate, a proxy-based architec-
ture that allows users to access web services from an un-
trusted machine without revealing their sensitive informa-
tion to that untrusted platform. The proxy acts as a middle-
man and ﬁlters all the trafﬁc between the untrusted machine
and the web service provider to insert secrets on the user’s
behalf. Delegate does not require any changes to the web
server’s authentication protocol. Delegate also permits the
user to deﬁne a rule base that speciﬁes whether requests are
dangerous or not, and the proxy can contact the user via
a cell phone to gain approval to submit requests that pose
risks if exploited by malware.
The ideas in the Delegate design can be incorporated
into Web sites directly, which would make them suitable for
users on trusted and untrusted machines. Our design is tar-
geted at cell phone users with text messaging capabilities,
so the pool of potential users is very high.
The primary contribution of the paper is the speciﬁca-
tion of a policy language for establishing rules to classify
dangerous Web requests and the appropriate action. This
methodology has similarities to ﬁrewall rules that dictate
Internet trafﬁc that can pass through a ﬁrewall and trafﬁc
that should be blocked. The Delegate proxy is a type of re-
mote personal ﬁrewall that inspects trafﬁc and determines
whether it is permitted to ﬂow to or from a Web site and
provides a layer of defense between the untrusted machine
and a website.
References
[1] http://www.securityfocus.com/news/6447
[2] http://news.com.com/2100-1023-983717.html
[3] C.
Jackson, D. Boneh,
sistant Web Authentication
http://crypto.stanford.edu/spyblock/spyblock.pdf, 2006.
and J. Mitchell. Spyware Re-
using Virtual Machines.
[4] P. Kwan and G. Durfee. Vault: Practical Uses of Virtual Machines
for Protection of Sensitive User Data. PARC Technical Report.
[5] Oprea, D. Balfanz, G. Durfee, and D. K. Smetters. Securing a
Remote Terminal Application with a Mobile Trusted Device. In
proceedings Annual Computer Security Applications Conference
(ACSAC 2004), Tucson, AZ, December 2004.
[6] http://deseretnews.com/dn/view/0,1249,600154978,00.html
[7] T. Richardson, Q. Stafford-Fraser, K. R. Wood, and A. Hopper.
Virtual network computing. IEEE Internet Computing, 1998.
[8] S. Ross, J. Hill, M. Chen, A. Joseph, D. Culler, E. Brewer. A
Composable Framework for Secure Multi-Modal Access to Inter-
net Services from Post-PC Devices, IEEE Workshop on Mobile
Computing Systems and Applications, December 2000.
[9] M.Wu, S.L.Garﬁnkel, R.Miller (2003) Secure Web Authentication
with Mobile Phones MIT Student Oxygen Workshop.
[10] M.Wu, S.L. Garﬁnkel, R.Miller. Short talk: Secure Web Authenti-
cation with Mobile Phones DIMACS Workshop on Usable Privacy
and Security Software, 2004.
[11] R.Jammalamadaka, T. van der Horst, S.Mehrotra, K.Seamons,
N.Venkatasubramanian. Delegate: A Proxy Based Architecture
for Secure Website Access from an Untrusted Machine. Techni-
cal Report No: TR-Rescue-06-13.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:32:31 UTC from IEEE Xplore.  Restrictions apply. 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006