title:Greystar: Fast and Accurate Detection of SMS Spam Numbers in Large
Cellular Networks Using Gray Phone Space
author:Nan Jiang and
Yu Jin and
Ann Skudlark and
Zhi-Li Zhang
Greystar: Fast and Accurate Detection of 
SMS Spam Numbers in Large Cellular Networks  
using Grey Phone Space
Nan Jiang, University of Minnesota; Yu Jin and Ann Skudlark, AT&T Labs; 
Zhi-Li Zhang, University of Minnesota
Open access to the Proceedings of the 22nd USENIX Security Symposium is sponsored by USENIXThis paper is included in the Proceedings of the 22nd USENIX Security Symposium.August 14–16, 2013 • Washington, D.C., USAISBN 978-1-931971-03-4Greystar: Fast and Accurate Detection of SMS Spam Numbers in Large
Cellular Networks using Grey Phone Space
Nan Jiang
University of Minnesota
Yu Jin
AT&T Labs
Ann Skudlark
AT&T Labs
Zhi-Li Zhang
University of Minnesota
Abstract
In this paper, we present the design of Greystar, an inno-
vative defense system for combating the growing SMS
spam trafﬁc in cellular networks. By exploiting the fact
that most SMS spammers select targets randomly from
the ﬁnite phone number space, Greystar monitors phone
numbers from the grey phone space (which are associ-
ated with data only devices like laptop data cards and
machine-to-machine communication devices like elec-
tricity meters) and employs a novel statistical model to
detect spam numbers based on their footprints on the
grey phone space. Evaluation using ﬁve month SMS
call detail records from a large US cellular carrier shows
that Greystar can detect thousands of spam numbers each
month with very few false alarms and 15% of the de-
tected spam numbers have never been reported by spam
recipients. Moreover, Greystar is much faster in detect-
ing SMS spam than existing victim spam reports, reduc-
ing spam trafﬁc by 75% during peak hours.
1 Introduction
The explosion of mobile devices in the past decade has
brought with it an onslaught of unwanted SMS (Short
Message Service) spam [1].
It has been reported that
the number of spam messages in the US has risen 45%
in 2011 to 4.5 billion messages [2].
In 2012, there
were 350K variants of SMS spam messages accounted
for globally [3] and more than 69% of the mobile users
claimed to have received text spam [4]. The sheer vol-
ume of spam messages not only inﬂicts an annoying user
experience, but also incur signiﬁcant costs to both cel-
lular service providers and customers alike. In contrast
to email spam where the number of possible email ad-
dresses is unlimited - and therefore the spammer gener-
ally needs a seed list beforehand, SMS spammers can
more easily reach victims by, e.g., simply enumerating
all numbers from the ﬁnite phone number space. This,
combined with wide adoption of mobile phones, makes
SMS a medium of choice among spammers. Further-
more, the increasingly rich functionality provided by
smart mobile devices also enables spammers to carry out
more sophisticated attacks through both voice and data
channels, for example, using SMS spam to entice users to
visit certain websites for product advertisement or other
illicit activities.
Because SMS spam inﬂicts ﬁnancial loss to mobile
users and adverse impact to cellular network perfor-
mance, the objective of defense techniques is to restrict
spam numbers quickly before they reach too many vic-
tims. To this end, instead of applyingpopular solutionsin
controlling email spam (e.g., ﬁltering based on sending
patterns), which can cause a high false alarm rate, cellu-
lar carriers often seek help from their customers to alert
them of emerging spamming activities. More speciﬁ-
cally, cellular carriers deploy reporting mechanism for
spam victims to report received spam messages and then
examine and restrict these reported spam numbers ac-
cordingly. Such spam detection techniques using victim
spam reports are very accurate, thanks to the human in-
telligence added while submitting these reports. How-
ever, these methods can suffer from signiﬁcant delay due
to the low report rate and slow user responses, rendering
them inefﬁcient in controlling SMS spam.
To address the issues in existing solutions, in this pa-
per, we carry out extensive analysis of SMS spamming
activities using ﬁve months of SMS call detail records
collected from a large cellular network in the US and the
SMS spam messages reported from the spam recipients
to that cellular carrier. We ﬁnd that a majority of spam-
mers choose targets randomly from a few area codes or
the entire phone number space, and initiate spam trafﬁc
at high rates. To detect such aggressive random spam-
mers, we advance a novel notion of grey phone space.
Grey phone space comprises a collection of grey phone
numbers (or grey numbers in short). Grey numbers are
associated with two types of mobile devices: data only
USENIX Association  
22nd USENIX Security Symposium  1
devices (e.g., many laptop data cards and data modems,
etc.) and machine-to-machine (M2M) communication
devices (e.g., utility meters and medical devices, etc.).
These grey numbers usually do not participate actively in
SMS communication as other mobile numbers do (e.g.,
those associated with smartphones), they thereby form
a grey territory that legitimate mobile users rarely enter.
In the mean time, the wide dispersion of grey numbers
makes them hard to be evaded by spammers who choose
targets randomly.
On top of grey phone space, we propose the design
of Greystar. Greystar employs a novel statistical model
to detect spam numbers based on their interactions with
grey numbers and other non-grey phone numbers. We
evaluate Greystar using ﬁve months of SMS call records.
Experimental results indicate that Greystar is superior to
the existing SMS spam detection algorithms, which rely
heavily on victim spam reports, in terms of both accuracy
and detection speed. In particular, Greystar detected over
34K spam numbers in ﬁve months while only generating
two false positives. In addition, more than 15% of the de-
tected spam numbers have never been reported by mobile
users. Moreover, Greystar reacts fast to emerging spam-
ming activities, with a median detection time of 1.2 hours
after spamming activities occur.
In 50% of the cases,
Greystar is at least 1 day ahead of victim spam reports.
The high accuracy and fast response time allow us to re-
strict more spam numbers soon after spamming activities
emerge, and hence to reduce a majority of the spam mes-
sages in the network. We demonstrate through simula-
tion on real network data that, after deploying Greystar,
we can reduce 75% of the spam messages during peak
hours. In this way, Greystar can greatly beneﬁt the cellu-
lar carriers by alleviating the load from aggressive SMS
spam messages on network resources as well as limiting
their adverse impact on legitimate mobile users.
The remainder of this paper is organized as follows.
We introduce the SMS architecture and the datasets used
in our study in Section 2. We then motivate the design of
Greystar in Section 3. In Section 4 we study the SMS ac-
tivities of spammers and legitimate users. The deﬁnition
of grey numbers is presented in Section 5. In Section 6,
we explain in detail the design of Greystar. Evaluation
results are presented in Section 7. Section 8 discusses
the related work and Section 9 concludes the paper.
2 Background and Datasets
In this section, we brieﬂy describe the cellular network
focused in our study. We then introduce the datasets and
our ground truth for identifying spam phone numbers.
2
2.1 SMS Architecture in UMTS
The cellular network under study utilizes primarily
UMTS (Universal Mobile Telecommunication System),
a popular 3G mobile communication technology adopted
by many mobile carriers across the globe. Here we intro-
duce the architecture for delivering SMS messages inside
UMTS networks (for other aspects regarding UMTS net-
works, e.g., mobile data channels, see [5]). Fig. 1 de-
picts a schematic view of the architecture. When send-
ing an SMS message, an end user equipment (UEA)
directly communicates with a cell tower (or node-B),
which forwards the message to a Radio Network Con-
troller (RNC). The RNC then delivers the message to a
Mobile Switching Center (MSC) server, where the mes-
sage enters the Signaling System 7 (SS7) network and
is stored temporarily at a Short Message Service Center
(SMSC). From the SMSC, the message will be routed to
the serving MSC of the recipient (UEB), then to the serv-
ing RNC and Node-B, and ﬁnally reaches UEB. Sim-
ilarly, messages originated from other carrier networks
(e.g., from UEC) will also traverse the SS7 network and
bypass the serving MSC before arriving at UEB1.
Figure 1: SMS architecture in UMTS networks.
2.2 Datasets
In this paper, we use two different datasets for our study.
SMS Call Detail Records (CDRs) are used for under-
standing SMS user/spammer activities and evaluating the
performance of the proposed Greystar system. These
records were collected at the serving MSC’s of SMS re-
cipients (see Fig. 1). This means that CDR records rep-
resent SMS messages targeting registered mobile cus-
tomers of the UMTS network under study2 and have been
1Note that similar SMS architecture is also adopted in other types
of 3G/4G cellular networks. Additionally, in this paper, we only focus
on SMS through the voice control channel. Short message services
through mobile data channels, such as iMessage, Tweets and MMS,
etc., are out of the scope of this paper (though defenses for ﬁghting
email spam can be applied to detect short message spam through data
channels, which we shall discuss in Section 8).
2SMS messages targeting mobile users in other carrier networks and
landline numbers are not seen at the serving MSCs and hence are not
2  22nd USENIX Security Symposium 
USENIX Association
successfully routed through the SS7 network. The CDR
dataset spans 5 monthsfrom Jan 2012 to May 2012. Each
record contains the SMS receiving time, the originating
number, the terminating number and the International
Mobile Equipment Identity (IMEI) for the device asso-
ciated with the terminating number3. We note that CDR
records do not contain text content of the original SMS
messages.
Victim spam reports contain spam messages reported
by spam recipients to the carrier. The said cellular car-
rier deploys an SMS spam reporting service for its users:
when a user receives an SMS text and deems it as a spam
message, s/he can forward the message to a spam report
number designated by the cellular service provider. Once
the spam is forwarded, an acknowledgment message is
returned, which asks the user to reply with the spam-
mer’s phone number (referred to as the spam number
hereafter). Once the above two-stage process is com-
pleted within a predeﬁned time interval, a spam report
is created, which includes the reporter’s phone number,
the spam number, the reporting time and the text content
of the reported spam message. We employ six months
of spam reports from Jan 2012 to June 2012 in order to
cover spam numbers observed between Jan and May but
are reported after May due to the delay of the spam re-
ports (see Section 3.2).
We emphasize that no customer personal information
was collected or used for our study. All customer identi-
ﬁes were anonymized before any analysis was conducted.
In particular, for phone numbers, only the area code (i.e.,
the ﬁrst 3 digits of the 10 digit North American num-
bers) was used and the remaining digits were hashed.
Similarly we only retain the ﬁrst 8-digit Type Alloca-
tion Code (TAC) of the IMEI to identify device types and
anonymize the remaining 8-digit to preserve customers’
privacy. In addition, to adhere to the conﬁdentiality un-
der which we have access to the data, in places we only
present normalized views of our results while retaining
the scientiﬁcally relevant magnitudes.
2.3 Obtaining Ground Truth
Although victim spam reports provide us with ground
truth for some spam numbers, they are by no means com-
prehensive and can be noisy (see Section 3.2). Therefore,
included in CDR records.
3IMEI’s are stored at MSC’s and are updated every time users con-
nect to the network. Although we have observed that spammers some-
times modify the IMEIs of their spamming devices (e.g., through spe-
cial equipment like SIM boxes), IMEI spooﬁng among legitimate users
is rare. Therefore we can reliably identify the types of user devices
based on their corresponding IMEIs. Meanwhile, since all the CDRs
are collected at MSCs, we can identify the original phone numbers that
initiate the SMS messages. Hence our approach is not affected even
when spammers employ spooﬁng techniques to change their caller IDs.
in this paper, we employ a more reliable source of ground
truth. In particular, we request the fraud agents from the
said UMTS carrier to manually verify spam number can-
didates detected by us. These fraud agents are exposed
to much richer (and more expensive) sources of informa-
tion. For example, fraud agents can investigate the own-
ership and the price plan information of the candidates,
examine their SMS sending patterns and correlate them
with known spam numbers in terms of their network lo-
cations and active times, etc. The ﬁnal decision is made
conservatively by corroborating different evidence.
Admittedly, fraud agents can make mistakes during
their investigation. Meanwhile, their breadth may be
limited by not being able to inspect all mobile numbers
in the network. Nevertheless, fraud agents provide us
with the most authoritative ground truth available for our
study. It is worth mentioning that such investigation by
fraud agents has been deployed independently for SMS
spam number detection and restriction for more than one
year and no false alarm has yet been observed (e.g., no
user complaint is observed so far regarding incorrectly
restricted phone numbers). Therefore, in our study, we
will treat fraud agents as a black box authority, i.e., we
submit a list of spam number candidates to fraud agents
and they return a list of conﬁrmed spam numbers.
3 Objectives and Existing Solutions
In this section, we discuss the objectives of developing
an effective defense against SMS spam by comparing
the difference between SMS spam and traditional email
spam. We then review the most widely adopted SMS
spam detection method based on crowdsourcing victim
spam reports and point out its inefﬁcacy. In the end, we
present the rationale of the proposed Greystar system.
3.1 SMS Spam Defense Objectives
In a conventional SMS spamming scenario, an SMS
spammer (note that we refer to an SMS spammer as the
person who employs a set of spam numbers to launch
SMS spam campaigns) ﬁrst invests in a set of phone
numbers and special high-speed devices, such as 3G
modems and SIM boxes [6]. Using these devices, s/he
then initiates unsolicited SMS messages to a large num-
ber of mobile phone numbers. Akin to traditional email
spam, the objective of SMS spam is to advertise certain
information to entice further actions from the message
recipients, e.g., calling a fraud number or clicking on a
URL link embedded in the message which points to a
malicious site. However, SMS spamming activities ex-
hibit unique characteristics which shift the focus of the
defense mechanisms and hence render inapplicable or
USENIX Association  
22nd USENIX Security Symposium  3
3
inefﬁcient existing solutions for defending against tradi-
tional email spam.
Email service providers usually detect and ﬁlter email
spam at their mail servers, to which they have full access.
There they can build accurate spam ﬁlters by exploiting
rich features in emails including the text content. Spam
ﬁlters at end user devices are also a common choice,
where email clients (apps) ﬁlter spam while retrieving
emails from remote mail servers. Though blacklist of
email spammers are sometimes used to assist spam clas-
siﬁcation [7–9], restricting email spam senders is usually
not the main focus of the defense, since it requires close
collaboration between email providers and network car-
riers. Moreover, it is observed that many spam emails
are originated from legitimate hosts due to botnet activ-
ities [10], which makes restricting spam originators an
inapplicable solution.
In comparison to emails which are generally stored on
servers and wait for users to retrieve them, SMS mes-
sages are delivered instantly to the recipients through the
SS7 network. Along the path, SMS messages are only
cached temporarily at SMSC (only when the recipients
are ofﬂine), leaving little time for cellular carriers to re-
act to them. The task becomes even more challenging es-
pecially when the SMS trafﬁc volume peaks during busy
hours. Filtering SMS spam at end user devices (e.g., us-
ing mobile apps) is also not applicable given many SMS
capable devices (e.g., feature phones) do not support run-
ning such apps. In addition, for a user with a pay-per-
use SMS plan, she is already charged for the spam mes-
sage once it arrives at her device. More importantly, even
when SMS spam ﬁlters are deployed at SMSC’s and end
user devices, SMS spammers can still inﬂict signiﬁcant
loss to the carrier and other mobile users. This is because
the huge number of spam messages can lead to a signif-
icant increase in the SMS trafﬁc volume at the cell tow-
ers serving the spam senders, possibly causing conges-
tion and hence deteriorating voice/data usage experience
of nearby users. For example, we have found the SMS
trafﬁc volume at cell towers can easily get multiplied by
more than 10 times due to the activities of spammers.
Therefore, the focus of the SMS spam defense is to con-
trol spam numbers as soon as possible before they reach
a large number of victims.
An efﬁcient SMS spam detection algorithm is hence
expected to react quickly to emerging spamming activi-
ties. Meanwhile, the focus on restricting spam numbers
places a strong emphasis on the accuracy of the algo-
rithm. First, it requires a spam detection algorithm to
limit false alarms, because false alarms can lead to incor-
rect restriction of legitimate users from accessing SMS
services. Second, it demands the algorithm detect as
many spam numbers as possible so as to minimize the
impact of SMS spam activities on the network. Such
high accuracy requirements are hard to achieve solely
based on the SMS sending patterns of the spammers.
For example, it is difﬁcult to separate spam campaigns
from legitimate SMS campaigns, such as a school send-
ing messages to its students to alert adverse weather con-
ditions. These legitimate senders can exhibit character-
istics that are common to SMS spammers4. Spammers
may also alter their sending patterns to mimic legitimate
users to avoid detection. As a result, cellular carriers of-
ten seek the assistance from their customers to alert them
of emerging SMS spam activities.
3.2 Spam Detection by Crowdsourcing
Victim Spam Reports
The emphasis on high accuracy gives rise to the wide
adoption of spam detection methods based on victim
spam reports which were introduced in Section 2. Victim
spam reports represent a more reliable and cleaner source
of SMS spam samples, as all the spam messages con-
tained in the reports have been vetted and classiﬁed by
mobile users (using human intelligence). To further mit-
igate the possible errors caused during the two-step re-
porting process, cellular carriers often crowdsource spam
reports from different users. For example, a simple yet