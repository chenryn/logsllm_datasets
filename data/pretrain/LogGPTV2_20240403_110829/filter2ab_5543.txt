titleblackhat:asia-21 A General Approach to Bypassing Many Kernel Protections and its Mitigation
In the beginning, we will analyze an anecdotal exploit that bypasses KASLR using a flexible object in the Linux kernel implementation. In this talk, we extend the definition of flexible objects to elastic objects and demonstrate that this exploit trick is a general exploitation approach. This approach can be applied to not only the Linux kernel but also FreeBSD and XNU, bypass many protections except KASLR. First, we show that the adversaries could use the elastic objects to easily obtain a leaking primitive for nearly any kernel vulnerabilities with a limited overwriting capability. Second, we demonstrate that this leaking primitive enables the adversaries to bypass heap cookie protector, KASLR, stack canary, and even realize an arbitrary read attack. Third, we design a static analysis technique to identify all such elastic structures/objects in the kernel codebase. Based on this result, finally, we propose an isolation-based defense in the talk as a part of kernel hardening. We quantify its security improvement and measure its performance overhead from different granularities.