i
t
r
o
p
o
r
p
 0.6
 0.4
 0.2
 0
 1
 1.2
 1.4
 1.6
 1.8
score
 2
 2.2
 2.4
We run each detection test 100 times for 2,000 packet
samples of both legitimate traﬃc and JitterBug traﬃc. The
mean and standard deviation of the test scores are shown in
Table 5. The test scores for JitterBug and legitimate traﬃc
are close to each other for all the tests except the entropy
test. If we look at the distribution of entropy test scores for
JitterBug and legitimate traﬃc, as illustrated in Figure 5,
we can see that the distributions of JitterBug and legitimate
test scores are quite distinct. The detection rates for Jitter-
Bug shown in Table 6, are very low (0.04 or less) for all the
detection tests except the entropy test, which has a detec-
tion rate of 1.0. Note that the other tests do detect some
diﬀerence between JitterBug and legitimate traﬃc, but the
diﬀerences are so small that it is impossible for these tests
to diﬀerentiate JitterBug from legitimate traﬃc without a
much higher false positive rate.
In contrast, the entropy test is able to detect JitterBug.
The entropy test uses a large number of bins, with bin widths
determined by the distribution of legitimate traﬃc. The en-
tropy test measures how uniformly the inter-packet delays
are distributed with respect to the bins, and how uniformly
the inter-packet delays ﬁt the legitimate traﬃc distribution.
JitterBug creates small changes throughout the distribution.
Since these changes fall within the variance that is typical
of legitimate traﬃc, the tests that measure the maximum
distance, like the Kolmogorov-Smirnov test, fail to detect
the changes. However, the entropy test is sensitive to such
changes throughout the distribution. JitterBug increases the
inter-packet delays and, due to the rotating window, redis-
tributes the inter-packet delays in an Equilikely distribution.
However, the increases are not uniform with respect to the
legitimate distribution, leading to increases or decreases in
the proportion of inter-packet delays for each bin. The en-
tropy test measures how uniformly the inter-packet delays
are distributed with respect to the bins, with the legitimate
traﬃc distribution being the most uniform or maximum en-
. Therefore, the entropy test score for JitterBug is
tropy
lower than that for legitimate traﬃc, which can be easily
detected.
2
2
In absolute terms, the uniform distribution is the maximum
entropy distribution of all continuous distributions [9], but
the entropy test, due to the bins, is a relative measure.
Table 5: JitterBug test scores
Figure 6: EN test scores for JitterBug
test
KST EST
regularity
EN
CCE
JitterBug
LEGIT-SSH
mean
.270
6.230
19.422
1.779
stdev mean
.273
.133
6.038
5.847
1.856
9.432
1.837
0.261
stdev
.123
5.624
1.253
0.220
Table 6: JitterBug detection rates
test
KST EST ≥ 0.63
regularity ≤ 0.08
EN ≤ 21.20
CCE ≥ 2.17
LEGIT-SSH
false positive
JitterBug
true positive
.01
.01
.01
.01
.01
.02
1.00
.04
4.3 Discussion
The detection tests that we present are all able to de-
tect some covert timing channels under certain conditions.
However, the previous methods fail for detecting most of
the tested covert timing channels. One major reason lies
in the high variation of legitimate traﬃc. For example, the
regularity test exhibits obvious weakness in this regard. In-
terestingly, the regularity test is the only test, other than
the corrected conditional entropy test, that achieves lower
average scores for all the covert timing channels. However,
due to the high standard deviation of the regularity test
in measuring legitimate traﬃc, the regularity test is not an
eﬀective detection method.
The other main reason lies in the properties of covert traf-
ﬁc. For example, while the Kolmogorov-Smirnov test is bet-
ter able to deal with legitimate traﬃc variation, it has prob-
lems with covert timing channels whose distribution is very
close to that of legitimate traﬃc. The Kolmogorov-Smirnov
test measures the maximum distance between the two dis-
tributions, rather than measuring diﬀerences throughout the
distribution. Thus, when the distribution of covert traﬃc is
very close to that of legitimate traﬃc, the variance of the
test scores is suﬃciently large so that the test cannot diﬀer-
entiate covert traﬃc from legitimate traﬃc.
Our entropy-based approach proves more eﬀective than
previous schemes. Based on the advantages of diﬀerent
binning strategies, we make use of both entropy and cor-
rected conditional entropy for detecting covert timing chan-
nels. The entropy test is sensitive to small changes through-
out the distribution. However, for a covert timing channel
whose distribution is nearly identical to that of legitimate
traﬃc, the entropy test fails. By contrast, the corrected con-
ditional entropy test measures the regularity or complexity
of the traﬃc, rather than the distribution. Thus, it is eﬀec-
tive to detect such a covert timing channel. However, if the
original correlations of traﬃc are retained and the distribu-
tion is changed, then the conditional entropy test fails; but
the entropy test works in this scenario by detecting slight
changes in the distribution. Therefore, in combination of
both, our entropy-based approach is eﬀective in detecting
all the tested covert timing channels.
LEGIT
JitterBug
 0.5
 0.4
n
o
i
t
r
o
p
o
r
p
 0.3
 0.2
 0.1
 0
 5
 10
 15
score
 20
 25
5. POTENTIAL COUNTERMEASURES
In this section, we discuss possible countermeasures that
could be used to harden covert timing channels against our
entropy-based approach. Our discussion focuses on TRCTC
and JitterBug. TRCTC is detected by the corrected condi-
tional entropy test and JitterBug is detected by the entropy
test.
To evade the corrected conditional entropy test, TRCTC
could be redesigned to replay longer correlated sequences of
inter-packet delays. The corrected conditional entropy test
could counter this technique for short sequences by increas-
ing the minimum pattern length. Of course, with increas-
ing sequence length, the corrected conditional entropy test
would lose its ability to measure regularity, because of the
issues discussed in Section 3, unless the sample size were
increased. However, this is not a signiﬁcant threat, because
replaying long correlated sequences of inter-packet delays
would greatly reduce the capacity of TRCTC.
To evade the entropy test, JitterBug could be reconﬁgured
to use a smaller timing-window w. Eventually, as w becomes
smaller, the entropy test would need a larger sample to de-
tect the JitterBug. However, using a smaller timing-window
would, similar to our discussion of TRCTC, reduce the ca-
pacity of JitterBug. It remains an open question whether or
not these countermeasures would be practical.
6. CONCLUSION AND FUTURE WORK
We introduced an entropy-based approach to detecting
covert timing channels, which makes use of entropy and cor-
rected conditional entropy. We designed and implemented
the entropy-based detection tool. The development of this
tool addresses a number of non-trivial design issues, includ-
ing eﬃcient use of data structures, data partition, bin gran-
ularity, and pattern length. We observed that as bin gran-
ularity increases, entropy estimates become more precise,
whereas corrected conditional entropy estimates become less
precise. Therefore, based on this observation, we utilized
the ﬁne-binned entropy estimation and the coarse-binned
corrected conditional entropy estimation for covert timing
channel detection.
We then applied our entropy-based techniques for detect-
ing covert timing channels. The corrected conditional en-
tropy test is able to detect the covert timing channels with
abnormal regularity, while the entropy test is able to de-
tect the covert timing channels with abnormal shape. Our
experimental results show that the combination of entropy
and corrected conditional entropy is capable of detecting a
variety of covert timing channels. In contrast, for a covert
timing channel whose distribution is close to that of legiti-
mate traﬃc, all the previous detection methods fail.
There are a number of possible directions for our future
work. We plan to further investigate the possible counter-
measures that could be used by attackers to evade entropy-
based detection. We also plan to explore the connection
between our entropy-based detection methods and the en-
tropy that relates to covert timing channel capacity. We
believe that the exploration could lead to better detection
methods or lower overall bounds on the capacity of covert
timing channels.
Acknowledgments
This work was partially supported by NSF grants CNS-
0627339 and CNS-0627340. We thank the DiRT Group at
the University of North Carolina at Chapel Hill for provid-
ing packet header traces, and the Information Technology
Department at the College of William and Mary for provid-
ing a testing environment. We also thank the anonymous
reviewers for their insightful comments.
7. REFERENCES
[1] Agat, J. Transforming out timing leaks. In
Proceedings of the 2000 SIGPLAN/SIGACT
Symposium on Principles of Programming Languages
(January 2000).
[2] Arimoto, S. An algorithm for computing the
capacity of arbitrary discrete memoryless channels.
IEEE Transactions on Information Theory Vol. 18,
No. 1 (January 1972).
[3] Berk, V., Giani, A., and Cybenko, G. Covert
channel detection using process query systems. In
Proceedings of FLOCON 2005 (September 2005).
[4] Berk, V., Giani, A., and Cybenko, G. Detection of
covert channel encoding in network packet delays.
Tech. Rep. TR2005-536, Dartmouth College,
Computer Science, Hanover, NH., USA, August 2005.
[5] Blahut, R. E. Computation of channel capacity and
rate-distortion functions. IEEE Transactions on
Information Theory Vol. 18, No. 4 (July 1972).
[6] Cabuk, S. Network Covert Channels: Design,
Analysis, Detection, and Elimination. PhD thesis,
Purdue University, West Lafayette, IN., USA,
December 2006.
[7] Cabuk, S., Brodley, C., and Shields, C. IP covert
timing channels: Design and detection. In Proceedings
of the 2004 ACM Conference on Computer and
Communications Security (October 2004).
[8] Cachin, C. An information-theoretic model for
steganography. Information and Computation Vol.
192, No. 1 (2004).
[9] Cover, T. M., and Thomas, J. A. Elements of
information theory. Wiley-Interscience, New York,
NY., USA, 1991.
[10] Giffin, J., Greenstadt, R., Litwack, P., and
Tibbetts, R. Covert messaging through TCP
timestamps. In Proceedings of the 2002 International
Workshop on Privacy Enhancing Technologies (April
2002).
[11] Giles, J., and Hajek, B. An information-theoretic
and game-theoretic study of timing channels. IEEE
Transactions on Information Theory Vol. 48, No. 9
(September 2002).
[12] Hu, W.-M. Reducing timing channels with fuzzy
time. In Proceedings of the 1991 IEEE Symposium on
Security and Privacy (May 1991).
[13] Kang, M. H., and Moskowitz, I. S. A pump for
rapid, reliable, secure communication. In Proceedings
of the 1993 ACM Conference on Computer and
Communications Security (November 1993).
[14] Kang, M. H., Moskowitz, I. S., and Chincheck,
S. The pump: A decade of covert fun. In Proceedings
of the 2005 Annual Computer Security Applications
Conference (December 2005).
[15] Kemmerer, R. A. A practical approach to identifying
storage and timing channels. In Proceedings of the
1982 IEEE Symposium on Security and Privacy (April
1982).
[16] Kemmerer, R. A. A practical approach to identifying
storage and timing channels: Twenty years later. In
Proceedings of the 2002 Annual Computer Security
Applications Conference (December 2002).
[17] Peng, P., Ning, P., and Reeves, D. On the secrecy
of timing-based active watermarking trace-back
techniques. In Proceedings of the 2006 IEEE
Symposium on Security and Privacy (May 2006).
[18] Porta, A., Baselli, G., Liberati, D., Montano,
N., Cogliati, C., Gnecchi-Ruscone, T., Malliani,
A., and Cerutti, S. Measuring regularity by means
of a corrected conditional entropy in sympathetic
outﬂow. Biological Cybernetics Vol. 78, No. 1 (January
1998).
[19] Rosipal, R. Kernel-Based Regression and Objective
Nonlinear Measures to Assess Brain Functioning. PhD
thesis, University of Paisley, Paisley, Scotland, UK,
September 2001.
[20] Shah, G., Molina, A., and Blaze, M. Keyboards
and covert channels. In Proceedings of the 2006
USENIX Security Symposium (July–August 2006).
[21] Shannon, C. A mathematical theory of
communication. Bell System Technical Journal Vol. 27
(July and October 1948).
[22] Wang, X., Chen, S., and Jajodia, S. Tracking
anonymous peer-to-peer voip calls on the internet. In
Proceedings of the 2005 ACM Conference on Computer
and Communications Security (November 2005).
[23] Wang, X., and Reeves, D. S. Robust correlation of
encrypted attack traﬃc through stepping stones by
manipulation of interpacket delays. In Proceedings of
the 2003 ACM Conference on Computer and
Communications Security (October 2003).