### 通过量扩展性测试

在图9中，我们展示了在一个小型拓扑（10个交换机，100个主机）下测量的通过量扩展性。

#### 拓扑结构对控制平面容量的影响

在这次测试中，如图11所示，我们模拟了一个更大的拓扑，包含30个交换机和300个主机，并测量了ONOS在处理从1,000到7,000请求/秒时的性能。结果显示，在较大的拓扑结构下，性能显著下降（与图9(a)-(d)中使用的10个交换机的拓扑相比）。增加更多的控制器实例并没有提供预期的好处，且没有任何分析通过了验收测试（即，99%的请求在95%的时间内执行）。

在这一系列实验中，控制器实例经历了高内存和CPU利用率，最终导致实例崩溃。通过SCP-CLUB收集的数据，我们发现交换机数量和主机数量超过某个阈值后，整体通过量会降低，原因如下：
1. 与SDN交换机通过南向接口（SBI）进行I/O处理的开销增加。
2. 在ONOS核心中，任务队列和其他共享资源的竞争增加。

SCP-CLUB分析发现的最大限制是，交换机和主机数量的增加会导致ONOS意图内部开销非线性增长。编译一批意图需要更长的时间来完成，尤其是在较大的拓扑结构中。由于这是一个单线程操作，它会导致系统中积累更多的意图请求队列，最终可能导致某个实例不稳定（参见图8中的示例）。此外，较大的拓扑结构需要安装更多的流以配置意图。在ONOS中，流规则和意图相关数据在节点之间最终一致地共享。每当一个意图被编译并创建了流规则时，这些流会被编译意图的节点复制到分布式数据存储中，该存储由所有实例共享。最终，每个节点都会同步这些流规则。

#### 改进后的ONOS版本的扩展点

表V显示了改进后的ONOS版本的扩展点和开销变化。可以看到，LARGE和EXTRA-LARGE部署的吞吐量显著提高，与图9中的原始结果相比。使用异步请求协议减少了北向接口（NBI）的瓶颈，并允许更有效地利用大量核心和大内存占用。与原始版本不同，改进后的NBI能够服务最大请求速率7,000请求/秒（5节点和7节点集群，EXTRA-LARGE部署 - 图6(c)和(d)）。总体而言，我们测量到的开销改善范围从4%（相对于ONOS-1-VM-XL在表V中）到98%（对于ONOS-3-VMs-XL）。

#### 讨论

在进行的增强中，SMALL和MEDIUM部署的吞吐量有所下降，这是由于线程池引起的额外内存占用和CPU开销。为了克服这一限制，我们在ONOS的NBI中实现了一个简单的REST控制器模块，可以根据传入请求的速度和意图安装失败率动态切换同步和异步方法。REST控制器接受外部切换阈值，例如来自SCP-CLUB生产测试的结果。

---

### 图像说明

**图9.** 通过量扩展性测试结果（小型拓扑：10个交换机，100个主机）

**图10.** 实现异步接口后ONOS的通过量分析

**图11.** 大型拓扑下的性能测试结果（30个交换机，300个主机）

**表V.** 改进后的ONOS版本的扩展点和开销变化

---

通过上述优化，文本更加清晰、连贯和专业，便于读者理解和参考。