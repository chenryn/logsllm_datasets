search engines like Google could be used to uncover critical information, vulnerabilities, and
misconfigured websites.
At the heart of this technique is using clever search strings and operators217 for the creative
refinement of search queries, most of which work with a variety of search engines. The process is
iterative, beginning with a broad search, which is narrowed using operators to sift out irrelevant or
uninteresting results.
We’ll start by introducing several of these operators to learn how they can be used.
The site operator limits searches to a single domain. We can use this operator to gather a rough
idea of an organization’s web presence.
y
k
s
o
n
i
z
D
Figure 14: Searching with a Site Operator
The image above shows how the site operator limited the search to the megacorpone.com
domain we have specified.
We can then use further operators to narrow these results. For example, the filetype (or ext)
operator limits search results to the specified file type.
In the example below, we combine operators to locate TXT files (filetype:txt) on
www.megacorpone.com (site:megacorpone.com):
217 (Google, 2022), https://support.google.com/websearch/answer/2466433?hl=en
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 116
Made in Morocco
Penetration Testing with Kali Linux
y
k
Figure 15: Searching with a Filetype Operator
s
We receive an interesting result. Our query found the robots.txt file, containing following content.
User-agent: * o
Allow: /
Allow: /nanites.php
Listinng 37 - robots.txt file
The robots.txt file instructs web crawlers, such as Google’s search engine crawler, to allow or
disallow specific resources. In this ciase, it revealed a specific PHP page (/nanities.php) that was
otherwise hidden from the regularz search, despite being listed allowed by the policy.
The ext operator could also be helpful to discern which programming languages might be used
D
on a web site. Searches like ext:php, ext:xml, and ext:py will find indexed PHP Pages, XML, and
Python pages, respectively.
We can also modify an operator using - to exclude particular items from a search, narrowing the
results.
For example, to find interesting non-HTML pages, we can use site:megacorpone.com to limit the
search to megacorpone.com and subdomains, followed by -filetype:html to exclude HTML pages
from the results.
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 117
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
n
Figure 1i6: Searching with the Exclude Operator
z
In this case, we found several interesting pages, including web directories indices.
In another example, we canD use a search for intitle:“index of” “parent directory” to find pages that
contain “index of” in the title and the words “parent directory” on the page.
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 118
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
n
i
z
Figure 17: Using Google to Find Directory Listings
The output refers to directoDry listing218 pages that list the file contents of the directories without
index pages. Misconfigurations like this can reveal interesting files and sensitive information.
These basic examples only scratch the surface of what we can do with search operators. The
Google Hacking Database (GHDB)219 contains multitudes of creative searches that demonstrate
the power of leveraging combined operators.
218 (MITRE, 2022), https://cwe.mitre.org/data/definitions/548.html
219 (OffSec, 2023), https://www.exploit-db.com/google-hacking-database
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 119
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
Figure 18: The Google Hacking Database (GHDB)
n
Another way of experimenting with Google Dorks is through the DorkSearch220 portal, which
provides a pre-built subset of queries and a builder tool to facilitate the search.
i
Mastery of these operators, combzined with a keen sense of deduction, are key skills for effective
search engine “hacking”.
D
6.2.3 Netcraft
Netcraft221 is an internet service company, based in England, offering a free web portal that
performs various information gathering functions such as discovering which technologies are
running on a given website and finding which other hosts share the same IP netblock.
Using services such as Netcraft is considered a passive technique, since we never directly
interact with our target.
Let’s review some of Netcraft’s capabilities. For example, we can use Netcraft’s DNS search page
(https://searchdns.netcraft.com) to gather information about the megacorpone.com domain:
220 (DorkSearch, 2022), https://dorksearch.com/
221 (Netcraft, 2022), https://www.netcraft.com/
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 120
Made in Morocco
Penetration Testing with Kali Linux
y
Figure 19: Netcraft Results for *.megacorponek.com Search
For each server found, we can view a “site report” that provides additional information and history
about the server by clicking on the file icon next to each ssite URL.
o
n
i
z
D
Figure 20: Netcraft Site Report for www.megacorpone.com
The start of the report covers registration information. However, if we scroll down, we discover
various “site technology” entries.
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 121
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
Figure 21: Site Technology for www.megacorpone.com
o
This list of subdomains and technologies will prove useful as we move on to active information
gathering and exploitation. For now, we will add it to our notes.
n
6.2.4 Open-Source Code
In the following sections, we’ll explorie various online tools and resources we can use to passively
gather information. This includezs open-source projects and online code repositories such as
GitHub,222, GitHub Gist,223 GitLab,224 and SourceForge.225
D
Code stored online can provide a glimpse into the programming languages and frameworks used
by an organization. On a few rare occasions, developers have even accidentally committed
sensitive data and credentials to public repos.
The search tools for some of these platforms will support the Google search operators that we
discussed earlier in this Module.
GitHub’s search,226 for example, is very flexible. We can use GitHub to search a user’s or
organization’s repos; however, we need an account if we want to search across all public repos.
To perform any Github search, we first need to register a basic account, which is free for
individuals and organizations.
Once we’ve logged in to our Github account, we can search MegaCorp One’s repos for interesting
information. Let’s use filename:users to search for any files with the word “users” in the name.
222 (GitHub, 2022), https://github.com/
223 (GitHub Inc, 2022), https://gist.github.com/
224 (GitLab, 2022), https://about.gitlab.com/
225 (Slashdot Media, 2022), https://sourceforge.net/
226 (GitHub, 2022), https://help.github.com/en/github/searching-for-information-on-github/searching-code
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 122
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
n
Figure 22: File Operator in GitHub Search
Our search only found one file - xamipp.users. This is nevertheless interesting because XAMPP227
is a web application developmentz environment. Let’s check the contents of the file.
D
227 (Apache Friends, 2022), https://www.apachefriends.org/index.html
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 123
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
n
Figure 23: GitHub Search Results
This file appears to contain a usernaime and password hash,228 which could be very useful when
we begin our active attack phase.z Let’s add it to our notes.
D
228 (Wikipedia, 2022) https://en.wikipedia.org/wiki/Cryptographic_hash_function#Password_verification
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 124
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
n
Figure 24: xampp.users File Content
This manual approach will work besit on small repos. For larger repos, we can use several tools to
help automate some of the seazrching, such as Gitrob229 and Gitleaks.230. Most of these tools
require an access token231 to use the source code-hosting provider’s API.
D
The following screenshot shows an example of Gitleaks finding an AWS access key ID232 in a file.
229 (Michael Henriksen, 2018), https://github.com/michenriksen/gitrob
230 (Zachary Rice, 2022), https://github.com/zricethezav/gitleaks
231 (GitHub, 2022), https://help.github.com/en/articles/creating-a-personal-access-token-for-the-command-line
232 (Amazon Web Services, 2022), https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-
access-keys
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 125
Made in Morocco
Penetration Testing with Kali Linux
y
k
Figure 25: Example Gitleaks Output
Obtaining these credentials allows us unlimited access tso the same AWS account and could lead
to a compromise of any cloud service managed by this identity.
o
Tools that search through source code for secrets, like Gitrob or Gitleaks,
generally rely on regular expressionns or entropy233-based detections to identify
potentially useful information. Entropy-based detection attempts to find strings
that are randomly generated. The idea is that a long string of random characters
i
and numbers is probably a password. No matter how a tool searches for secrets,
z
no tool is perfect and they will miss things that a manual inspection might find.
D
6.2.5 Shodan
As we gather information on our target, it is important to remember that traditional websites are
just one part of the internet.
Shodan234 is a search engine that crawls devices connected to the internet, including the servers
that run websites, but also devices like routers and IoT235 devices.
To put it another way, Google and other search engines search for web server content, while
Shodan searches for internet-connected devices, interacts with them, and displays information
about them.
Although Shodan is not required to complete any material in this Module or the labs, it’s worth
exploring a bit. Before using Shodan we must register a free account, which provides limited
access.
233 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Password_strength#Random_passwords
234 (Shodan, 2022), https://www.shodan.io/
235 (Wikipedia, 2022) https://en.wikipedia.org/wiki/Internet_of_things
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 126
Made in Morocco
Penetration Testing with Kali Linux
Let’s start by using Shodan to search for hostname:megacorpone.com.
y
k
s
o
n
Figure 26: Searching MegaCorp One’s domain with Shodan
In this case, Shodan lists the IPsi, services, and banner information. All of this is gathered
passively, avoiding interacting witzh the client’s web site.
This information gives us a snapshot of our target’s internet footprint. For example, there are four
D
servers running SSH. We can drill down to refine our results by clicking on SSH under Top Ports
on the left pane.
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 127
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
Figure 27: MeganCorp One servers running SSH
Based on Shodan’s results, we know exactly which version of OpenSSH is running on each server.
If we click on an IP address, we can rietrieve a summary of the host.
z
D
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 128
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
n
i
z
Figure 28: Shodan Host Summary
We can review the ports, seDrvices, and technologies used by the server on this page. Shodan will
also reveal if there are any published vulnerabilities for any of the identified services or
technologies running on the same host. This information is invaluable when determining where to
start when we move to active testing.
6.2.6 Security Headers and SSL/TLS
There are several other specialty websites that we can use to gather information about a website
or domain’s security posture. Some of these sites blur the line between passive and active
information gathering, but the key point for our purposes is that a third-party is initiating any
scans or checks.
One such site, Security Headers,236 will analyze HTTP response headers and provide basic
analysis of the target site’s security posture. We can use this to get an idea of an organization’s
coding and security practices based on the results.
Let’s scan www.megacorpone.com and check the results.
236 (Scott Helme, 2022), https://securityheaders.com/
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 129
Made in Morocco
Penetration Testing with Kali Linux
y
k
s
o
Figure 29: Scan results for www.megacorpone.com
The site is missing several defensive headers, such as Content-Security-Policy237 and X-Frame-
Options.238 These missing headers are non t necessarily vulnerabilities in and of themselves, but