title:Herd: A Scalable, Traffic Analysis Resistant Anonymity Network for
VoIP Systems
author:Stevens Le Blond and
David R. Choffnes and
William Caldwell and
Peter Druschel and
Nicholas Merritt
Herd: A Scalable, Trafﬁc Analysis Resistant
Anonymity Network for VoIP Systems
Stevens Le Blond
MPI-SWS
David Choffnes
Northeastern University
William Caldwell
MPI-SWS
Peter Druschel
MPI-SWS
Nicholas Merritt
MPI-SWS
ABSTRACT
Effectively anonymizing Voice-over-IP (VoIP) calls requires
a scalable anonymity network that is resilient to trafﬁc analy-
sis and has sufﬁciently low delay for high-quality voice calls.
The popular Tor anonymity network, for instance, is not de-
signed for the former and cannot typically achieve the latter.
In this paper, we present the design, implementation, and ex-
perimental evaluation of Herd, an anonymity network where
a set of dedicated, fully interconnected cloud-based prox-
ies yield suitably low-delay circuits, while untrusted super-
peers add scalability. Herd provides caller/callee anonymity
among the clients within a trust zone (e.g., jurisdiction) and
under a strong adversarial model. Simulations based on a
trace of 370 million mobile phone calls among 10.8 million
users indicate that Herd achieves anonymity among millions
of clients with low bandwidth requirements, and that super-
peers decrease the bandwidth and CPU requirements of the
trusted infrastructure by an order of magnitude. Finally, ex-
periments using a prototype deployment on Amazon EC2
show that Herd has a delay low enough for high-quality calls
in most cases.
CCS Concepts
•Networks → Network privacy and anonymity;
Keywords
Anonymity networks; Voice-over-IP; Intersection attacks;
Strong anonymity
Permission to make digital or hard copies of part or all of this work for personal
or classroom use is granted without fee provided that copies are not made or
distributed for proﬁt or commercial advantage and that copies bear this notice
and the full citation on the ﬁrst page. Copyrights for third-party components of
this work must be honored.
SIGCOMM ’15 August 17-21, 2015, London, United Kingdom
c(cid:2) 2015 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-3542-3/15/08.
DOI: http://dx.doi.org/10.1145/2785956.2787491
639
1.
INTRODUCTION
Voice-over-IP (VoIP) systems are popular and their sup-
port for pseudonymous identities and strong encryption
makes them appealing to users concerned about communi-
cation privacy. However, many nation states use Internet
surveillance to monitor and repress critics [18, 14], and even
western democracies conduct mass surveillance [9, 10, 8, 4].
In this environment, VoIP systems are not sufﬁcient to ensure
the anonymity of Internet users, nor the safety of political ac-
tivists and whistleblowers, as illustrated, for example, by the
NSA’s ability to intercept Skype conversations [13].
Further, existing anonymity networks are not designed for
latency sufﬁciently low to support VoIP, or scalability to mil-
lions of users under a strong adversarial model. For example,
Tor [28] scales to large numbers of users but is vulnerable to
an adversary who can eavesdrop on the ingress and egress
paths of Tor circuits. Recent revelations indicate that the
UK’s GCHQ is pursuing this to deanonymize Tor users [1].
We demonstrate in Section 4 that a simple attack using
only the start and end times would trace 98.3% of the calls of
a large, real voice workload, if they had been made over Tor.
(A more sophisticated attack that also considers the time se-
ries of encrypted packets would likely trace even more calls.)
In addition, Tor typically incurs round trip delays between
2–4 seconds on established, sender-anonymous circuits be-
cause of random proxy selection and high-latency connec-
tions [43, 15], which is prohibitive for VoIP.
Other anonymity systems resist trafﬁc analysis at the cost
of performance or scalability [37, 47, 26, 30, 45]. For exam-
ple, Dissent, the state-of-the-art Dining Cryptographers net-
work (DC-Net), is resilient under a strong threat model but
requires one broadcast channel per anonymity set, impact-
ing anonymity and scalability, as well as several round-trip
times, yielding delays signiﬁcantly higher than Tor [47].
In this paper, we present the design, implementation, and
evaluation of Herd, a scalable anonymity network that com-
bines delays suitable for VoIP with anonymity under a strong
adversarial model. Herd achieves these properties using a
novel design tailored to the speciﬁc requirements and trafﬁc
characteristics of VoIP. In particular, (1) Herd leverages the
multitude of jurisdictions in the Internet with a design that
ensures a user’s anonymity depends only on mixes located
in jurisdictions that (s)he trusts, independent of her commu-
nication partners’ choices; (2) it exploits the constant-rate,
low-bandwidth nature of VoIP trafﬁc to resist trafﬁc analy-
sis while achieving low delay; (3) it employs a novel design
based on network coding to hide clients’ activity patterns,
which enables Herd to ofﬂoad its trusted infrastructure with
the help of untrusted peers.
At its core, Herd relies on a set of dedicated mixes (prox-
ies that relay VoIP data packets) operated by independent or-
ganizations in different jurisdictions around the world. The
underlying insight is that no adversary has access to mix lo-
cations everywhere in the world. Herd exploits this by allow-
ing clients to choose a mix within a trust zone, i.e., a juris-
diction/provider that is friendly to their cause, and by guar-
anteeing that client anonymity depends only on this choice.
Because the set of mixes is fully connected, a Herd cir-
cuit involves at most three intercontinental links (usually
one), which keeps delays low enough for acceptable VoIP
quality. To increase scalability, Herd can optionally use un-
trusted superpeers that forward trafﬁc between clients and a
mix. Superpeers reduce the CPU and bandwidth demands
on trusted infrastructure without sacriﬁcing anonymity. Bit-
wise unlinkablity (i.e., decorrelating the content of packets
arriving and departing a mix) and trafﬁc-analysis resistance
is achieved via encrypted connections padded using artiﬁcial
trafﬁc (chaff ), where rate adjustments are correlated within
large anonymity sets.
This paper makes the following contributions:
• We present the design of Herd, a scalable anonymity net-
work with latency sufﬁciently low to carry VoIP calls,
and anonymity under a strong adversarial model.
• A trace-based evaluation of Herd’s overheads and per-
formance using a trace of 370 million mobile phone
calls among 10.8 million users, and a comparison with
Drac [26], an existing low-delay anonymity network.
• An open-source implementation of Herd.
• An experimental evaluation of Herd’s perceived call
quality based on VoIP calls made by volunteers using a
Herd deployment on Amazon EC2.
Our key results are as follows. First, using trace-based
simulations we show that Herd achieves anonymity with
low bandwidth requirements for millions of clients. Sec-
ond, we ﬁnd that superpeers decrease the bandwidth and
CPU demands on trusted infrastructure by an order of mag-
nitude, because they allow Herd to take advantage of re-
source contributions by untrusted parties without affecting
anonymity. We estimate that untrusted superpeers that con-
tribute resources for free or in exchange for free calls would
reduce Herd’s operational costs from $10-100 to $0.10-1.14
per user/month for this workload. Third, experiments with
an implementation and a prototype deployment on 4 Ama-
zon EC2 data centers show that Herd incurs modest addi-
tional latency as compared to direct communication. The
Herd source code is available under a BSD license [19].
We discuss background and related work on private voice
640
communication in Section 2. We then present the design and
implementation of Herd in Section 3 and compare its perfor-
mance with alternative low-latency anonymity networks in
Section 4. We conclude in Section 5.
2. BACKGROUND & RELATED WORK
2.1 Context
Providing anonymous communication is challenging from
a technical, legal and political standpoint. Recent revelations
about state-sponsored mass surveillance suggest that govern-
ment agencies analyze large-scale data collected at Internet
exchange points [1, 4] and request customer data from ser-
vice providers [10, 9]. In this environment, achieving effec-
tive and practical anonymity is difﬁcult.
Even in the presence of such powerful attackers, however,
we posit that there exist free havens supporting private com-
munication, even if those free havens differ depending on
the communication partners and their topic.
We believe this is the case for two reasons. First, no single
adversary has access to all parts of the Internet and jurisdic-
tion over all service providers. This is true despite the fact
that countries like the US and the UK have access to a dis-
proportionate amount of Internet trafﬁc today. Moreover, in
the wake of the recent revelations, there is some indication
that more countries may seek to establish national Cloud and
Web service providers and independent Internet routes that
do not needlessly cross other countries or continents [17].
Second, for any worthy cause that a group of users pursue
under the cloak of anonymity, there is likely a country that
is friendly or at least indifferent to that cause. Combined
with the ﬁrst point, we believe that users can ﬁnd a jurisdic-
tion that avoids legal and political challenges to anonymous
communication, leaving only technical challenges.
The design of Herd seeks to exploit these circumstances,
by allowing callers and callees to independently choose a
provider within a jurisdiction they deem friendly to their
cause, and through a trust model where a user’s anonymity
depends only on their own choice of provider. Before we
describe the design of Herd in the next section, we review
existing work in anonymous voice services.
2.2 Existing techniques
Burner phones. A simple method for anonymous voice
calling is to use pre-paid SIM cards and cheap cellular
phones purchased with cash and discarded after a period of
use. To receive calls, a user must disseminate her current
phone number to callers using an out-of-band mechanism.
Using burner phones may not be appropriate in all cases due
to its monetary cost, relative inconvenience, and the unavail-
ability of unregistered, pre-paid SIM cards in some coun-
tries. Further, using a burner phone does not guarantee that
calls made using the phone will not be tapped or otherwise
logged.
VoIP services. In principle, VoIP services are an alternative
for anonymous voice calling. While VoIP signaling proto-
cols such as SIP and P2PSIP were not designed for anony-
mous call setup, it is possible, for instance, to create a Skype
or Google Voice account under a pseudonym and contact the
service through a VPN, which obscures the user’s IP address.
However, VPNs can be compelled by authorities to release
the IP addresses of their customers. For instance, a UK-
based VPN recently complied with a US subpoena to trace
one of its users [3]. Also, it is widely assumed that Skype
complies with requests for call metadata by government au-
thorities [7], and that the NSA has the ability to intercept the
contents of Skype calls [13].
Private VoIP services like RedPhone [16] and Silent Cir-
cle [12] offer end-to-end encrypted voice calls (strong en-
cryption and at least partially open source), and advertise
that no call metadata is stored. However, the services rely
on rendezvous and relaying services that can be compelled
by local authorities to capture and release call metadata. A
subpoena against the operator of a server involved in a call
may reveal the IP addresses of caller and callee.
None of the existing VoIP services are designed to resist
trafﬁc analysis, where a passive network observer can de-
termine the caller and callee by matching the time series of
encrypted trafﬁc at different points in the network.
Anonymity networks.
Users can improve protection
against de-anonymization by accessing a VoIP service via
an anonymity network like Tor [15]. Unfortunately, the typ-
ical delays incurred by Tor circuits are too high for adequate
VoIP call quality. More generally, a measurement study in-
dicates that achieving acceptable VoIP call quality using an
Tor-like (onion routing) anonymity network based on volun-
teered resources (PlanetLab) is challenging [39].
LAP [33] is a light-weight anonymity network with near-
optimal delay and low routing overhead. However, it as-
sumes a weaker threat model than Tor and requires network
support that is not deployed today.
Trafﬁc analysis resistant anonymity. Trafﬁc analysis con-
sists of statistical attacks that reveal communication part-
ners, by considering the time series of packets and user ac-
tivity. Tor, like most other medium-delay anonymity net-
works [33, 21, 20], is not designed to withstand trafﬁc anal-
ysis, and we empirically show the effectiveness of such at-
tacks against Tor in Section 4.1.4.
Anonymity networks can batch messages to hide the cor-
relation between input and output messages, as originally
done in Chaumian mix-nets [24]. Batching prevents an at-
tacker from tracing messages based on their arrival and de-
parture times, but without chaff it requires delaying mes-
sages for substantial periods. As a result, mix-nets are suit-
able only for delay-tolerant communications such as e-mails
[32, 40, 27].
ISDN-MIXes [44, 35] combine mixing of time-sliced
channels with chaff trafﬁc and broadcast of incoming calls
on subscriber links to achieve anonymous telephony on an
ISDN network. Herd instead provides anonymous VoIP calls
over the Internet, under a threat model that considers today’s
powerful adversaries.
Finding the right tradeoff between delaying messages and
adding chaff trafﬁc is an open research challenge. For ex-
ample, both the Java Anonymous Proxy (JAP) [21] and the
Freedom Network [46] abandoned chafﬁng due to its high
bandwidth overhead. Below, we discuss designs that com-
bine batching with chafﬁng to reduce mix-net delays, as well
as Dissent, a system based on DC-nets.
Aqua [37] provides k-anonymity for BitTorrent-like traf-
ﬁc in the presence of trafﬁc analysis. While the designs of
Herd and Aqua share several ideas, they support different
applications and trafﬁc types, and differ in other ways: First,
Herd uses a hybrid architecture with trusted mixes and un-
trusted superpeers (SPs), where SPs improve scalability us-
ing a novel design based on network coding. Second, Herd
leverages (a) the constant-rate nature of VoIP trafﬁc and (b)
the jurisdictional diversity of the Internet to achieve paths
that require less than half the number of hops as Aqua (at
most 3 versus 7 intercontinental hops) without loss of resis-
tance against trafﬁc analysis. Whereas Aqua requires multi-
path between two pairs of mixes to disperse hotspots in ﬁle-
sharing trafﬁc, constant-rate trafﬁc does not have this con-
straint, enabling Herd to achieve latencies appropriate for
VoIP calls. By organizing its infrastructure into disjoint trust
zones and coupling rate adjustments both within and across
them, Herd decouples the anonymity of users of different
zones, while Aqua does not consider mixes’ jurisdiction.
P 5[45] and Tarzan [30] are P2P anonymity networks that
use broadcast channels and chafﬁng, respectively, to defend
against trafﬁc analysis. Because they use a P2P model, their
security depends on forwarding trafﬁc via a series of proxies
hosted on endpoints, affecting their latency and reliability.
Dissent [47] is an infrastructure-based anonymity service
with a very strong adversarial model, where a single honest
proxy is sufﬁcient to ensure anonymity, even in the face of
trafﬁc analysis attacks. The system relies on DC-nets and
veriﬁable shufﬂes, and its infrastructure-based architecture
scales to hundreds of clients with modest delay and band-
width sufﬁcient for web browsing. However, the system’s
capacity, scalability, and latency are subject to DC-net scal-
ing limits with respect to the number of proxies, overhead
per payload bit for cryptographic processing, and delay.
Drac [26] is a trafﬁc-analysis resistant anonymity network
for VoIP and IM that relies on a social network to provide
anonymous communication among strangers and unobserv-
able communication among friends. An important differ-
ence with Herd is that Drac exposes users’ social network to
an adversary. Drac also routes calls in a peer-to-peer fashion
over the social network, which can cause impractically long
latency for calls between users who are several hops apart in
the social graph. Whereas Herd clients maintain a handful of
chafﬁng links (e.g., 2 or 3), Drac may require substantially
more (e.g., Twitter and Facebook users have on average 45
and 190 contacts, respectively [31, 29]). We provide a quan-
titative comparison of Drac and Herd, in terms of anonymity,
scalability, and perceived call quality in Section 4.
2.3 Our system: Herd
Herd is designed speciﬁcally for VoIP trafﬁc and the ano-
nymity needs of voice callers. Herd takes advantage of VoIP
calling patterns and trafﬁc characteristics to provide ano-
nymity under a strong adversarial model with reasonable
overhead and delay low enough for high-quality voice calls.
641
maintain a fully connected network of links between each
other. Second, the clients and SPs served by a particular mix
form a two-level, hierarchical network, with SPs as the inte-
rior nodes. SPs are highly available clients with low-latency
access to the Internet and a public IP address.
All links connecting mixes, SPs and clients carry bi-direc-
tional encrypted trafﬁc, which is padded to a uniform rate.
The links connecting clients to an SP or a mix carry trafﬁc
at a small multiple of the unit rate u (the payload rate of a