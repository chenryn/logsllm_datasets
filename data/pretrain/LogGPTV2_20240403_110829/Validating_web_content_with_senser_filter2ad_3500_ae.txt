0.00 (0%)
0.00 (0%)
any
0.00 (4%)
0.04 (10%)
0.05 (6%)
0.01 (1%)
0.00 (0%)
any but
top-tier
0.00 (2%)
0.03 (11%)
0.07 (10%)
0.02 (2%)
0.00 (0%)
transit only
0.00 (5%)
0.03 (15%)
0.07 (12%)
0.04 (5%)
0.02 (2%)
Proxies
1
5
9
13
17
top-tier
only
0.01 (1%)
0.02 (2%)
0.02 (2%)
0.02 (3%)
-0.01 (-2%)
any
0.03 (6%)
0.05 (11%)
0.04 (10%)
0.03 (7%)
-0.01 (-4%)
any but
top-tier
0.04 (8%)
0.05 (14%)
0.03 (13%)
0.02 (8%)
-0.01 (-4%)
transit only
0.04 (11%)
0.05 (19%)
0.03 (17%)
0.02 (14%)
-0.02 (-12%)
when only top-tier ASes can be malicious, because the max-ﬂow
based proxy selection algorithm is inclined to select top-tier ASes
that have high degrees. We vary the types of ASes that are mali-
cious to observe how effective Senser is against different types of
adversaries. Table 2 highlights the difference between the random
algorithm’s and the AS-disjoint algorithm’s failure rates and the
AS-disjoint algorithm’s percent improvement over the random al-
gorithm. The difference is highest with the “transit only” AS types
with the AS-disjoint algorithm performing up to 15% better. This
is due to the fact that the AS-disjoint algorithm is able to avoid
having a transit AS (unlike a top tier AS that is more difﬁcult to
avoid) appear in multiple paths, which would otherwise be shared
by paths from multiple proxies if chosen randomly.
To see how the number of nodes affects the failure rate, we set
n = 11 (which roughly corresponds to a 40% failure rate with the
AS-disjoint algorithm when only transit ASes can be malicious)
and vary k, the number of proxies used. Figure 10 shows the effect
on the randomized algorithm; the effect on the AS-disjoint algo-
rithm is similar and is omitted for brevity. As the number of prox-
ies used increases, the failure rate for most AS types decreases until
about 13 or 15 proxies are used. The failure rate increases slighty
when only top-tier ASes are malicious, because the additional ma-
licious top-tier ASes have a high probability of routing the addi-
tional proxies’ trafﬁc. Table 3 shows the difference between the
random algorithm’s and the AS-disjoint algorithm’s failure rate and
the AS-disjoint algorithm’s percent improvement over the random
algorithm. The AS-disjoint algorithm performs worse with only
top-tier ASes when k = 17, but performs the same or better in all
other cases, up to a 19% improvement for only transit ASes.
Weighted randomized selection algorithm.
Section 4.4 ex-
plains an attack in which a knowledgeable adversary can use the
AS-disjoint proxy selection algorithm to increase his or her chances
of controlling a majority of the proxies selected. The weighted ran-
domized selection algorithm helps mitigate this attack by choos-
ing (cid:10)αk(cid:11) proxies using the AS-disjoint proxy selection algorithm
and (cid:12)k(1 − α)(cid:13) proxies using the random proxy selection algo-
rithm. Figure 11 shows how various α values perform when tran-
sit and endpoint ASes are malicious (α = 1 reduces to the pure
AS-disjoint proxy selection algorithm and α = 0 reduces to the
pure randomized proxy selection algorithm). An α as low as 0.3
shows a clear improvement over the randomized proxy selection
algorithm when k ≥ 11 and the improvement increases as α does.
A higher α is not always better, however, because the proxy se-
lection algorithm becomes more predictable as α increases. An α
of 0.5 prevents the majority of proxies from being chosen by the
potentially vulnerable AS-disjoint proxy selection algorithm while
reducing the random algorithm’s failure rate for k ≥ 11.
5.5 Evaluation Summary
We demonstrated the effectiveness and efﬁciency of Senser through
a combination of actual deployment on Amazon EC2 nodes and
simulations using a dataset of PlanetLab proxies. In our evaluation
using the Alexa top 1,000 websites, Senser was able to accurately
detect censorship in many scenarios for a majority of sites.
In addition, under several likely attack scenarios, our AS-disjoint
proxy selection effectively reduced the potential impact of mali-
cious ASes. Our studies also showed that increasing the number of
proxies hedges the risk in the presence of malicious ASes.
6. CONCLUSION
This paper introduces a system for validating retrieved web con-
tent in the presence of AS-level adversaries. Senser operates by
forming a consensus of the requested web content using multiple
proxies located at diverse vantage points in the network. By us-
ing an AS-aware proxy selection algorithm, Senser achieves good
network diversity, and in many instances, prevents even large au-
tonomous systems from undetectably altering requested web con-
tent. We validate our approach by using both simulations and a test
bed deployment to show our system accurately detects the mali-
cious modiﬁcation of retrieved web content for a majority of sites
in many conservative attacker conﬁgurations. Senser’s practical
approach improves the ability to detect censorship on the web over
the current status quo, with no service or software modiﬁcation re-
quired on end host providers. We show this to be essential, as 75%
of the Alexa Top 1,000 sites do not provide SSL/TLS.
347
1.0
0.8
0.6
0.4
e
t
a
R
e
r
u
l
i
a
F
0.2
0.0
0
alpha = 0
alpha = 0.3
alpha = 0.5
alpha = 0.7
alpha = 0.9
alpha = 1
5
Malicious ASes (any but top-tier)
10
15
20
Figure 11: Weighted random. selection simulation (varying n).
Acknowledgments
We thank the anonymous reviewers for their insightful comments
and suggestions. This work is partially supported by the National
Science Foundation through grants CNS-1149832, CNS-1064986,
CNS-1204347, and CNS-1223825. This material is based upon
work supported by the Defense Advanced Research Project Agency
(DARPA) and Space and Naval Warfare Systems Center Paciﬁc
under Contract No. N66001-11-C-4020. Any opinions, ﬁndings
and conclusions or recommendations expressed in this material are
those of the author(s) and do not necessarily reﬂect the views of the
Defense Advanced Research Project Agency and Space and Naval
Warfare Systems Center Paciﬁc.
References
[1] R. J. Bayardo and J. Sorensen. Merkle Tree Authentication of HTTP Responses.
In World Wide Web Conference (WWW), 2005.
[2] S. Burnett, N. Feamster, and S. Vempala. Chipping Away at Censorship Firewalls
with User-Generated Content. In USENIX Security Symposium (USENIX), 2010.
[3] H. Carrillo and D. Lipman. The Multiple Sequence Alignment Problem in Biol-
ogy. SIAM J. Appl. Math., 48(5):1073–1082, Oct. 1988.
ery. In World Wide Web Conference (WWW), 2001.
[5] P. Devanbu, M. Gertz, A. Kwong, C. Martel, G. Nuckolls, and S. G. Stubblebine.
Flexible Authentication of XML Documents. In ACM Conference on Computer
and Communications Security (CCS), 2001.
[6] P. Devanbu, M. Gertz, C. Martel, and S. G. Stubblebine. Authentic Data Pub-
lication over the Internet. J. Comput. Secur., 11(3):291–314, April 2003. ISSN
0926-227X.
[7] R. Dingledine, N. Mathewson, and P. Syverson. Tor: The Second-Generation
Onion Router. In USENIX Security Symposium (USENIX), 2004.
[8] C. Ellison and B. Schneier. Ten Risks of PKI: What You’re Not Being Told About
Public Key Infrastructure. Journal of Computer Security, 16(1):1–7, 2000.
[9] N. Feamster, M. Balazinska, G. Harfst, H. Balakrishnan, and D. Karger.
In-
franet: Circumventing Web Censorship and Surveillance. In USENIX Security
Symposium (USENIX), 2002.
[10] M. Gertz, A. Kwong, C. U. Martel, and G. Nuckolls. Databases that tell the
Truth: Authentic Data Publication. IEEE Data Eng. Bull., 27(1):26–33, 2004.
[11] G. H. Gonnet, R. A. Baeza-Yates, and T. Snider. Information Retrieval. Chapter
on New Indices for Text: PAT Trees and PAT Arrays. Prentice-Hall, Inc., 1992.
[12] R. Holz, L. Braun, N. Kammenhuber, and G. Carle. The SSL Landscape: A
Thorough Analysis of the X.509 PKI Using Active and Passive Measurements.
In ACM SIGCOMM Conference on Internet Measurement (IMC), 2011.
[13] A. Houmansadr, G. Nguyen, M. Caesar, and N. Borisov. Cirripede: Circumven-
tion Infrastructure using Router Redirection with Plausible Deniability. In ACM
Conference on Computer and Communications Security (CCS), 2011.
[14] S. D. Kamvar, M. T. Schlosser, and H. Garcia-Molina. The Eigentrust Algorithm
for Reputation Management in P2P Networks. In World Wide Web Conference
(WWW), 2003.
[15] J. Karlin, D. Ellard, A. W. Jackson, C. E. Jones, G. Lauer, D. P. Mankins, and
W. T. Strayer. Decoy Routing: Toward Unblockable Internet Communication. In
USENIX Workshop on Free and Open Communications on the Internet (FOCI),
2011.
[16] S. Katti, J. Cohen, and D. Katabi. Information Slicing: Anonymity using Unre-
liable Overlays. In USENIX Conference on Networked Systems Design & Imple-
mentation (NSDI), 2007.
[17] C. Kreibich, N. Weaver, B. Nechaev, and V. Paxson. Netalyzr: Illuminating
[4] C. Chang and S. Lui. IEPAD: Information Extraction Based on Pattern Discov-
gatech.edu/.
the Edge Network. In ACM SIGCOMM Conference on Internet Measurement
(IMC), 2010.
[18] H. Madhyastha, E. Katz-Bassett, T. Anderson, A. Krishnamurthy, and
A. Venkataramani.
iPlane Nano: Path Prediction for Peer-to-Peer Applica-
tions. In USENIX Symposium on Networked Systems Design and Implementation
(NSDI), 2009.
[19] H. V. Madhyastha, T. Isdal, M. Piatek, C. Dixon, T. Anderson, A. Krishnamurthy,
and A. Venkataramani. iPlane: An Information Plane for Distributed Services. In
USENIX Symposium on Operating System Design and Implementation (OSDI),
2006.
[20] S. Ramachandran.
Size and Number of Resources.
Available at https://developers.google.com/speed/articles/
web-metrics.
Web Metrics:
[21] M. Schuchard, J. Geddes, C. Thompson, and N. Hopper. Routing Around De-
coys. In ACM Conference on Computer and Communications Security (CCS),
2012.
[22] A. Sfakianakis, E. Athanasopoulos, and S. Ioannidis. CensMon: A Web Censor-
ship Monitor. In USENIX Workshop on Free and Open Communication on the
Internet (FOCI), 2011.
[23] Snakes on a Tor Exit Scanner.
Snakes on a Tor Exit Scanner.
https://gitweb.torproject.org/torflow.git/tree/HEAD:
/NetworkScanners/ExitAuthority.
[24] J. Sunshine, S. Egelman, H. Almuhimedi, N. Atri, and L. F. Cranor. Crying
Wolf: An Empirical Study of SSL Warning Effectiveness. In USENIX Security
Symposium (USENIX), 2009.
[25] K.-C. Tai. The Tree-to-Tree Correction Problem. J. ACM, 26(3):422–433, July
1979.
[26] The Associated
Press.
Internet Giants,
Aim at
http://www.nytimes.com/2011/09/06/technology/
hacking-in-the-netherlands-broadens-in-scope.html.
Available
2011.
[27] Tor Bridges. Tor: Bridges. https://www.torproject.org/docs/
Hacking
September
in
5
the Netherlands
Took
at
bridges.
[28] J. T. L. Wang, B. A. Shapiro, D. Shasha, K. Zhang, and K. M. Currey. An Al-
gorithm for Finding the Largest Approximately Common Substructures of Two
Trees. IEEE Trans. Pattern Anal. Mach. Intell., 20(8):889–895, Aug. 1998.
[29] Q. Wang, X. Gong, G. T. K. Nguyen, A. Houmansadr, and N. Borisov. Cen-
sorSpoofer: Asymmetric Communication using IP Spooﬁng for Censorship-
Resistant Web Browsing. In ACM Conference on Computer and Communica-
tions Security (CCS), 2012.
[30] D. Wendlandt, D. G. Andersen, and A. Perrig. Perspectives: Improving SSH-
style Host Authentication with Multi-path Probing. In USENIX Annual Technical
Conference (USENIX-ATC), 2008.
[31] E. Wustrow, S. Wolchok, I. Goldberg, and J. A. Halderman. Telex: Anticensor-
ship in the Network Infrastructure. In USENIX Security Symposium (USENIX),
2011.
[32] X. Xing. The Filter Bubble Chrome Extension. http://bobble.gtisc.
A. A SURVEY OF SSL SUPPORT
In order to quantify the level of SSL adoption of popular web-
sites, we tested the ability of Alexa top-100, 1k, 10k, and 100k sites
to support TLS/SSL (HTTPS) connections. Table 4 reports our re-
sults. “No page found” errors reﬂect cases in which an HTTPS
connection could be established, but the server returned a 404 error.
In several cases, there was a 301 or 302 redirect from the HTTPS
page to the HTTP page. To err on the side of inclusion, we con-
sider “successes” (i.e., SSL to be supported) as any case in which
an SSL certiﬁcate existed, even if the certiﬁcate was misconﬁgured
(i.e., did not report the correct domain name). The total successes
and failures for each Alexa dataset are reported in the Table. As
can be seen, a vast majority of the top websites on the web do not
offer proper SSL connections.
Table 4: SSL support on the web.
Status
Connection refused
No page found
Redirect to HTTP
Total Success
Total Failure
Top 100
42 (42%)
2 (2%)
15 (15%)
41 (41%)
59 (59%)
Top 1k
512 (51%)
15 (2%)
195 (20%)
278 (28%)
722 (72%)
Top 10k
5679 (57%)
122 (1%)
1740 (17%)
2459 (25%)
7541 (75%)
Top 100k
59362 (60%)
1185 (1%)
12305 (12%)
27148 (27%)
72852 (73%)
348