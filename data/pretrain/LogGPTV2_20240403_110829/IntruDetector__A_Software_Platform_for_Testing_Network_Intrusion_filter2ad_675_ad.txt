It  is  probably  a  mas-
querader  since it  is unlikely  that  a user  will  login
at  midnight 
from  the  outside  in  our  environment.
This  session  is  generated  by  virtual  simulation.
Actually,  it  is very  difficult  to  be produced  by real
simulation  since it  requires us to  have access to  the
outside  machine.
.Case  3.  SYN-flooding  denial-of-service  attack  on
the  server.  To  avoid  being  detected,  the  source of
SYN  messages is  set  to  the  local  machine.  The
service  is set  to  the  most  commonly  used service,
XII.  This  attack  is  simulated  by  virtual  simula-
tion. 
It  is  possible  but  dangerous  to  emulate  the
attack  by  real  simulation.
Figure  4:  Distribution  of  the  Services from  Client  C1
to  Server  51
The  Results  of  statistical  analysis  are  presented
4.4 Statistical  Analysis  Results
as follows:
We  collected  three  weeks worth  of  data  from  the  ex-
perimental  environment.  The  data  consist  of  16922
TCP  connections.  Figure  3 shows the  features  of  sev-
eral  common  TCP  services in  the  historical  data.  We
can see the  number  of HTTP  connections  is the  great-
est.  From  the  perspective  of the  amount  of data  trans-
mitted  over a connection,  XII  consumes more network
bandwidth 
than  others  as the  average number  of pack-
ets or bytes  of data  transmitted  over a XII  connection
is the  greatest.
The  distribution  of  the  services used by  machine
C1 to  communicate  with  Server  51 is depicted  in  Fig-
ure  4.  We  can  see that  XII 
is  used most  often.  FTP
is  also frequently  used.
7
.Case  1.  This  session is  not  flagged  as suspicious
since the  probability  of  the  occurrence  of  the  ses-
sion is higher  than  the predefined  threshold.  How-
ever,  the  session  is  actually  very  suspicious. 
It
downloaded  sensitive  system  files,  and  might  use
them  to  crack  user  passwords.  Since  the  session
was  initiated 
from  a  local  machine,  it  could  be
done  by  an  internal  user.  It  is  also possible  that
machine  was cracked  and  being  used as the  basis
to  launch  attacks  against  others.  The  failure  to
identify 
this  suspicious  activity  shows  the  weak-
ness of statistical  analysis for  detecting  inside  mis-
user.
.Case  2.  This  session is flagged  as anomalous  be-
cause it  did  not  occur  before.  Although 
this  ses-
sion  is  suspicious,  it  is  also possible  that  the  ses-
sion  was initiated  by  an internal  user who  was on
out-of-town  business  at  that  time.  Flagging  this
session as intrusive  indicates  that  statistical  anal-
ysis  may  trigger  many  false  alarms.  This  is  due
to  the  immaturity  of  the  detection  algorithm  we
implemented. 
If  the  algorithm  can  adapt  to  the
change of  user behaviors,  false  alarms  may  be re-
duced.
is  the  most  often  used  protocol 
.Case  3.  This  session is  not  flagged  as suspicious
since  HTTP 
in
the  experimental  network.  Figure  5  shows  that
63 percent  of connections  are HTTP  connections.
to  identify  SYN-flooding  attack  is
The  inability 
due  to  the  simplicity  of  the  history  profile. 
If
the  profile  contains  more  information,  such as the
intensity  of  connections,  it  would  be  possible  to
detect  denial  of service  attacks  like  SYN-flooding
attack.
BO.6
1061.3
(
"
~
m 1.2
Figure  5:  Distribution  of  Common  Network  Service
4.5 Signature  Analysis  Results
To  perform  signature  analysis,  security  rules  should  be
defined.  Security  rules  are  site  dependent.  They  are
defined  by  a  security  officer  according  to  the  organi-
zation  policies  of how  the  computing  resources should
be  used.  In  our  experiments,  we define  the  following
security  rules.  Any  violation  of  these  rules  is  deemed
as intrusive.
.Access 
to  the  server  is restricted  to  the  inside.
.The  maximum  number  of  concurrent  connections
to  the  server  is  1000.
The  results  of  signature  analysis  are  presented  as
follows:
.Case  1.  The  FTP  session is  not  flagged  as an  in-
trusion  since it  does not  violate  any security  rules.
Although  downloading  sensitive  files  is  abnormal,
it  can not  be detected.  This  is due to  the  simplic-
ity  of the  sensor in  that  only  the  information  con-
tained  in  packet  headers are utilized. 
It  is impos-
sible  to  tell  which  files have been accessed without
parsing  the  data  part  of packets.
.Case  2.  The  telnet  session is  flagged  as intrusive
as it  explicitly  violate  rule  1.
.Case  3.  Some  of  TCP  SYN  events  are  flagged
as  intrusions.  Signature  analysis  only  checks  if
the  security  rules  are violated.  When  we began to
emulate  SYN-flooding  attack,  the  total  number  of
current  connections  was less than  1000.  When  the
limit  was reached, all  of the newly  established  con-
nections  were flagged  as intrusive.  Although  some
malicious  connections  were  found,  many  normal
activities  were  also  flagged  as intrusions.  There
were many  false alarms.  To  effectively  detect  this
type  of  attacks,  a simple  rule  is  insufficient,  and
sophisticated  techniques  must  be applied
5
Conclusion 
and  Future 
Work
information 
Intrusion  Detection  Systems  (IDSs)  play  an important
role  in  protecting 
infrastructure.  Most  of
the  current  detection  algorithms  are  not  sufficiently
mature  and  extensive  test  and  further 
improvement
are required.  We have developed  a testbed  for  network
intrusion  detection  algorithms. 
It  allows  for  tests  to
be done in  a real  environment  with  a wide  range of in-
trusive  cases but  without  any  danger  of compromising
normal  system  operations.  Our  future  work  will  focus
on  the  development  of  new  intrusive  simulators.  We
also plan  to  redesign  our  system  to  make it  conform  to
the  standards  when  they  are finalized  by  IDWG 
[10].
References
[1]  "Yahoo! 
Under  Attack: 
A  Coordinated  At-
tack  Shuts  Down  Leading  Web  Site  for  Three
Hours"  .http:/ 
/www  .abcnews.go.com/sections/
tech/DailyNews/yahooOOO207.html
[2]  http:/  /www  .cert.org/advisories/
[3]  "White  House:  Hackers  hit  our  Web  site" .
http:/  /www  .cnn.com/TECH/computing/9905/12/
[4]  http:/  /www  .l1.mit.edu/IST  /ideval/index.html
[5]  R.  Anderson  and  A.  Khattak. 
"The  Use  of  In-
formation  Retrieval  Techniques  for  Intrusion  De-
tection"  ,  In  Proceedings  of  RAID'98,  Louvain-Ia-
Neuve,  Belgium,  September  1998.
8
[6]  Nirupama  Bulusu,  Jeremy  Elson,  Deborah  Estrin,
Ramesh  Govindan,  John  Heidemann,  Chalermek
Intanagonwiwat,  Nader  Salehi,  Kun-chan  Lan,  Ya
Xu,  and  Wei  Ye. 
in  Wireless
Network  Simulation"  , USC/ISI  TR-20000-523.
"Effects  of  Detail 
[7]  M.  Crosbie  and  E.  Spafford. 
"Defending  a  Com-
puter  System  using  Autonomous  Agents"  ,  Techni-
cal  Report  No.95-022,  COAST  Laboratory,  De-
partment  of  Computer  Sciences,  Purdue  Univer-
sity,  March  1994.
[8]  H.  Debar,  M.  Dacier,  A.  Wespi,  and  S.  Lampart.
"An  Experimentation  Workbench  for  Intrusion  De-
tection  Systems" , Research Report  RZ  2998,  IBM
Research  Division,  Zurich  Research  Laboratory,
8803 Ruschlikon,  Switzerland,  March  1998.
[9]  R.  Durst,  T.  Champion,  B.  Wit  ten,  E.  Miller,  and
L.  Spagnuolo.  "Testing  and  Evaluating  Computer
Intrusion  Detection  Systems" ,  Communications  of
the  ACM,  July  1999.
[10]  M.  Erlinger  and  S.  Chen. 
"Intrusion  De-
tection  Exchange  Format"  ,  http:/  /www  .ietf.org/
html.charters/ 
idwg-charter  .html
[11]  J.  Frank.  "Artificial 
Intelligence  and  Intrusion  De-
tection:  Current  and  Future  Directions"  ,  In  Pro-
ceedings of  the  17th  National  Computer  Security
Conference,  October  1994.
[12]  A.  Ghosh and A.  Schwartzbard.  "A  Study  in  Using
Neural  Networks  for  Anomaly  and  Misuse  Detec-
tion"  , In  Proceedings of  the  8th  USENIX  Security
Symposium,  Washington,  D.C.,  USA,  August  23-
26,1999.
[13]  T.  Heberlein,  G.  Dias,  K.  Levit,  B.  Mukherjee,  J.
Wood,  and  D.  Wolber.  "A  Network  Security  Mon-
itor"  , In  Proceedings of  the  1990 IEEE  Symposium
on  Research  in  Security  and  Privacy,  pages  296-
304.
[14]  K.  Jackson,  D.  Dubois,  and  C.  Stallings.  "An  Ex-
pert  System Application 
for  Network  Intrusion  De-
tection"  , In  Proceedings of  the  14th  National  Com-
puter  Security  Conference,  pages  215-225,  Wash-
ington,  D.C.,  October  1-4,  1991.
[15]  W.  Jansen, P. Mell,  T.  Karygiannis,  and  D.  Marks.
"Applying  Mobile  Agents  to  Intrusion  Detection
and  Response" ,  Interim  Report-6416,  Computer
Security  Division,  National 
Institute  of  Standards
and  Technology,  October  1999.
"Neural  Networks  Applied 
[16]  J.  Bonifacio,  A.  Cansian,  A.  Carvalho,  and  E.
Moreira. 
in  Intrusion
Detection  Systems" ,  In  Proceedings  of  the  IEEE
World  Congress  on  Computational 
WCCI'98,  Anchorage,  USA.
[17]  S.  Kumar  and  E.  Spafford. 
"An  Application  of
Pattern  Matching  in  Intrusion  Detection"  ,  Techni-
cal  Report  CSD- TR-94-013,  The  COAST  Project,
Department  of  Computer  Sciences, Purdue  Univer-
sity,  West  Lafayette,  IN,  USA,  June  171994.
Intelligence 
,
[18]  W.  Lee.  "A  Datamining  Framework  for  Building
Intrusion  Detection  Models"  , In  IEEE  Symposium
on  Security  and  Privacy,  pages 120-132, Berkeley,
California,  May  1999.
[19]  R.  Lippmann,  and  I.  Graf. 
"Evaluating 
Intrusion
Detection  Systems:  The  1998 DARPA  Off-line  In-
trusion  Detection  Evaluation"  ,  In  Proceedings  of
DARPA 
Information  Survivability  Conference  and
Exposition,  DISCEX'OO,  Jan  25-27,  Hilton  Head,
SC,  2000.
[20]  S.  McCanne,  C.  Leres,  and  V.  Jacobson. 
"Libp-
cap" , available  via  anonymous  ftp  to  ftp.ee.lbl.gov,
1994.
[21]  B.  Mukherjee, 
L.  Heberlein,  and  K.  Levitt.
Intrusion  Detection"  ,  IEEE  Network,
"Network 
May /June  1994.
[22]  N.  Puketza,  K.  Zhang,  M.  Chung,  B.  Mukherjee,
for  Testing  In-
" A  Methodology 
and  R.  Olsson. 
trusion  Detection  Systems" , IEEE  Tmnsactions  on
Software  Engineering,  Vol  22,  No.10,  Oct  1996,
pp.  719 -729.
[23]  N.  Puketza,  K.  Zhang,  M.  Chung,  B.  Mukherjee,
and  R.  Olsson. 
for  Test-
ing  Intrusion  Detection  Systems" , IEEE  Software,
1997.
"  A  software  Platform 
[24]  C. Schuba, I.  Krsul,  M.  Kuhn,  E. Spafford,  A.  Sun-
daram,  and  D.  Zamboni.  "  Analysis  of  a Denial  of
Service  Attack  on  TCP  " ,  In  Proceedings  of  the
1997  IEEE  Symposium  on  Security  and  Privacy,
pages 208-223,  May  1997.
9