User: 请回答以下安全问题如何对抗图像远程文件包含，例如使用.gif文件的RFI（Apache/PHP）？为了防御攻击者试图滥用图像文件的远程文件包含，我通常建议永远不要使用包含将图像文件包含到PHP代码中。
然而，有时，避免图像包含可能根本不可能（无论出于何种原因，都无关紧要）。
在这种情况下，我通常会在上传过程中的某个地方拾取图像，并将其转换为另一种图像格式（有时与有损压缩相结合），以摧毁原始图像中可能包含的任何恶意代码。
这是可行的，但我对此不太满意。主要是因为这样的处理会产生额外的服务器负载，有时可能会导致图像质量下降。
在这方面有什么更聪明的方法或最佳实践吗？
编辑
澄清一下：我说的是一种情况，攻击者将PHP代码注入图像文件，以便在上传图像后在服务器端执行注入的代码。例如，论坛允许用户上传头像（小图像文件）进行个性化。

Assistant: 您的PHP代码永远不应该评估数据文件。它可以打印出图像文件的内容，但包含（）图像文件是对代码的疯狂使用。我强烈认为您所做的是使用PHP代码来提供图像，并且由于PHP不会评估任何不在“&lt；？？&gt；”标记之间的内容，因此这在大多数情况下都有效。这绝对是错误的做法。
您可能正在查找readfile（）函数。
除此之外，不要编写接受外部输入的include语句。