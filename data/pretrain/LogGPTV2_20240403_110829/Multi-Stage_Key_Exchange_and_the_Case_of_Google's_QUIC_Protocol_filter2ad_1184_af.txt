{·},C , times the probability ns for
predicting the client session.
We conclude that we can from now on reject any attempt in which the key-exchange adversary sends to
an honest client a new ciphertext which has not been created by an honest server. The adversary can thus
only relay the second messages between an honest client and an honest server. In such an execution we can
again inject the GapDH challenge X, Y into the client’s ephemeral public key and the server’s temporary
public key. Only this time, we have to guess one session and the right temporary key used by the server,
instead of one session and the right (long-term secret of a) user, yielding a factor ns · nt instead of ns · nu.
Note that Corrupt queries for the server only disclose the long-term secret, but not the temporary key by
convention. Hence, we can carry out the same reduction to the GapDH problem as above.
The ﬁnal step, as in the stage-1 case, is now to argue that there cannot be another session with identiﬁer
1, C(cid:48)) (cid:54)= sid2 = (info1, C) such that the inputs to the derivation function KDFexp are identical.
2 = (info(cid:48)
sid(cid:48)
Recall that each info1 contains the client’s ephemeral public key and that it corresponds uniquely to some
2 (cid:54)= info2 to KDFexp
info2. Hence, a diﬀerence in info(cid:48)
in the protocol. If, on the other hand, info(cid:48)
1 = info1 then the two ciphertexts must diﬀer. Because of the
strike registers on the server’s side the ciphertexts can only diﬀer if one has been created by the adversary
for the same stage-1 key.
In this case, however, we would have rightfully rejected the ciphertext such
that the client would not have derived the session key K2. It follows that only the partnered sessions can
have the same input DH(epkC, tpkS) and info2 to KDFexp, implying that the key in the test session is
independent of all other keys (except for the keys of partnered sessions).
(cid:3)
1 (cid:54)= info1 would immediately yield diﬀerent inputs info(cid:48)
The claim now follows.
4.3 QUICi — A Key-i ndependent Version
Recall that our composition theorem (in the unilateral version) only applies to key-independent schemes,
where QUIC, as is, does not satisfy this property. It is, however, quite easy to change QUIC into a key-
independent version. With the modiﬁcation to QUICi we can then argue security of, say, the composition
of QUICi with a secure channel protocol for the second stage.
Recall that, in the key-independent case, the adversary is allowed to Reveal the session key of a stage,
before the session key of the next stage has been established. The idea for QUIC is similar to TLS, where
the resumption key is derived from the established master secret (from which the previous session keys
have been computed). For QUICi , one would simply derive two secret values K1 and preK2 in the KDFexp
step of the key derivation in the ﬁrst stage, where K1 is still the ﬁrst stage’s session key and preK2 is kept
secret and subsequently input to the key derivation in the second stage. Any Reveal query would then
disclose the session keys, but not preK2. It should thus be hard to compute the second-stage session keys
given only the previous session keys.12 We stress that this change does not impose additional expensive
state to be kept by the server: As apparent from Figure 3, the server computes K2 immediately after
deriving K1 and must anyway keep a small state between the two KDF invocations.
4.4 A Note on 0-RTT Security
We highlight a speciﬁc security aspect of QUIC’s approach to establish secure connections in 0-RTT which
is, by its nature, not coverable in our model. Remember that, for a 0-RTT connection establishment to be
12Note that, if we allow session state reveals, then the key PRK could still be disclosed, of course. The idea here therefore
protects against bad usage of the session keys in the channel (modeled through Reveal queries), but not against disclosure of
ephemeral randomness.
23
achievable, the client has to speculate that the server still uses a previously known public key. If this is not
the case then the server will reply with an updated server conﬁguration (and key), allowing the client to
retry the connection establishment. Note however that, in order to beneﬁt from the 0-RTT key exchange,
the QUIC speciﬁcation states that the client indeed “must start sending before waiting for the server’s
reply” [LC13] and rekeying with K2 takes place. In such a scenario, it therefore has to be assumed that
some data will be sent under a (non-forward-secret) key K1 computed using the outdated server public
key.
So far, this is not surprising and, as our model treats non–forward secrecy including corruptions, it
accurately indicates that no security guarantees can be given for the data encrypted under that K1 if the
adversary learns the outdated server public key (i.e., corrupts this server identity). What we however
cannot model in a precise cryptographic sense is the following attack: Assume that an active adversary
learns a server’s static secret key, and that this security breach is discovered, leading this server to generate
a new conﬁguration and key pair. In the scenario depicted above, the client aiming to talk to the server
(referring to the server as a real instance, not as the identity behind a public key) will use the outdated
public key for connection establishment. Therefore, an active adversary will be able to impersonate the
server (in the real-world sense) using the corrupted static key, which the client believes still belongs to this
server.
We stress that the fact that our model cannot represent this attack, although it constitutes a potential
vulnerability, is not a weakness of our model, but rather reﬂects a mismatch between the real-world entity
a client aims to communicate with and the outdated cryptographic identity employed for this purpose.
This attack obviously can be mitigated by employing strong binding between real-world and cryptographic
identities using, e.g., timely certiﬁcate revocation. However, such means would naturally inﬂuence the low-
latency timing properties QUIC speciﬁcally aims for with 0-RTT connections. At this point, we leave it
open to discussion whether or not the outlined potential vulnerability is a fair price to pay to achieve this
goal.
5 Conclusion
Our work introduces a model to reason about the security of multi-stage key exchange protocols. The
notion enables us to assess Google’s new QUIC protocol and to conﬁrm its intended security properties as
a key exchange protocol. This, in itself, is already a useful result to support the faith in the cryptographic
strength of QUIC. We continue to argue about compositional security of multi-stage protocols in general,
pointing out the importance of the new notion of (session-)key independence, and how this could be easily
integrated into QUIC.
Clearly, one of the next steps would be to analyze SSL/TLS with resumption as a multi-stage protocol.
This, however, would require to adapt the model ﬁrst, because, as discussed earlier, SSL/TLS cannot even
be shown to be secure as a single-stage protocol in the Bellare–Rogaway sense. Another interesting aspect
would be to weaken the requirements for our compositional theorem, or to prove that the requirements
are indeed necessary.
Acknowledgments
We thank Hugo Krawczyk for proposing an improvement to our modiﬁcation of QUIC for key independence,
Christina Brzuska for helpful discussions on the composition results, and the anonymous reviewers for
valuable comments. Marc Fischlin is supported by the Heisenberg grants Fi 940/3-1 and Fi 940/3-2 of
the German Research Foundation (DFG). Felix G¨unther is supported by the German Federal Ministry of
24
Education and Research (BMBF) within EC SPRIDE. This work has been funded by the DFG as part of
project S4 within the CRC 1119 CROSSING.
References
[BCF+13] Colin Boyd, Cas Cremers, Michele Feltz, Kenneth G. Paterson, Bertram Poettering, and Dou-
glas Stebila. ASICS: Authenticated key exchange security incorporating certiﬁcation systems.
In Jason Crampton, Sushil Jajodia, and Keith Mayes, editors, ESORICS 2013: 18th European
Symposium on Research in Computer Security, volume 8134 of Lecture Notes in Computer
Science, pages 381–399, Egham, UK, September 9–13, 2013. Springer, Heidelberg, Germany.
(Cited on page 18.)
[BFPW07] Alexandra Boldyreva, Marc Fischlin, Adriana Palacio, and Bogdan Warinschi. A closer look
at PKI: Security and eﬃciency. In Tatsuaki Okamoto and Xiaoyun Wang, editors, PKC 2007:
10th International Conference on Theory and Practice of Public Key Cryptography, volume
4450 of Lecture Notes in Computer Science, pages 458–475, Beijing, China, April 16–20, 2007.
Springer, Heidelberg, Germany. (Cited on page 18.)
[BFS+13] Christina Brzuska, Marc Fischlin, Nigel P. Smart, Bogdan Warinschi, and Stephen C.
Int.
Williams. Less is more: relaxed yet composable security notions for key exchange.
J. Inf. Sec., 12(4):267–297, 2013. (Cited on page 4.)
[BFWW11] Christina Brzuska, Marc Fischlin, Bogdan Warinschi, and Stephen C. Williams. Composabil-
ity of Bellare-Rogaway key exchange protocols. In Yan Chen, George Danezis, and Vitaly
Shmatikov, editors, ACM CCS 11: 18th Conference on Computer and Communications Secu-
rity, pages 51–62, Chicago, Illinois, USA, October 17–21, 2011. ACM Press. (Cited on pages 3,
4, 5, 6, 10, 12, 13, and 14.)
[BLNR14] Alexandra Boldyreva, Robert Lychev, and Cristina Nita-Rotaru. How Secure and Quick is
(Cited on
QUIC in Presence of Malice? Communicated through one of the authors, 2014.
page 4.)
[BR94]
[Brz13]
[Che11]
[CK01]
Mihir Bellare and Phillip Rogaway. Entity authentication and key distribution.
In Dou-
glas R. Stinson, editor, Advances in Cryptology – CRYPTO’93, volume 773 of Lecture Notes
in Computer Science, pages 232–249, Santa Barbara, CA, USA, August 22–26, 1994. Springer,
Heidelberg, Germany. (Cited on pages 3 and 5.)
Christina Brzuska. On the Foundations of Key Exchange. PhD thesis, Technische Universit¨at
Darmstadt, Darmstadt, Germany, 2013. http://tuprints.ulb.tu-darmstadt.de/3414/,
retrieved on 2014-05-14. (Cited on pages 3, 5, 6, 10, and 12.)
Lily Chen. Recommendation for Key Derivation through Extraction-then-Expansion. National
Institute of Standards and Technology, November 2011. (Cited on page 18.)
Ran Canetti and Hugo Krawczyk. Analysis of key-exchange protocols and their use for building
secure channels. In Birgit Pﬁtzmann, editor, Advances in Cryptology – EUROCRYPT 2001,
volume 2045 of Lecture Notes in Computer Science, pages 453–474, Innsbruck, Austria, May 6–
10, 2001. Springer, Heidelberg, Germany. (Cited on page 5.)
[DF11]
¨Ozg¨ur Dagdelen and Marc Fischlin. Security analysis of the extended access control pro-
tocol for machine readable travel documents. In Mike Burmester, Gene Tsudik, Spyros S.
25
[DR08]
[FW09]
[GKS13]
[JKSS12]
[JP02]
[KP05]
Magliveras, and Ivana Ilic, editors, ISC 2010: 13th International Conference on Information
Security, volume 6531 of Lecture Notes in Computer Science, pages 54–68, Boca Raton, FL,
USA, October 25–28, 2011. Springer, Heidelberg, Germany. (Cited on pages 19 and 20.)
T. Dierks and E. Rescorla. The Transport Layer Security (TLS) Protocol Version 1.2. RFC
5246 (Proposed Standard), August 2008. Updated by RFCs 5746, 5878, 6176. (Cited on page 3.)
Pooya Farshim and Bogdan Warinschi. Certiﬁed encryption revisited. In Bart Preneel, editor,
AFRICACRYPT 09: 2nd International Conference on Cryptology in Africa, volume 5580 of
Lecture Notes in Computer Science, pages 179–197, Gammarth, Tunisia, June 21–25, 2009.
Springer, Heidelberg, Germany. (Cited on page 18.)
Florian Giesen, Florian Kohlar, and Douglas Stebila. On the security of TLS renegotiation.
In Ahmad-Reza Sadeghi, Virgil D. Gligor, and Moti Yung, editors, ACM CCS 13: 20th
Conference on Computer and Communications Security, pages 387–398, Berlin, Germany,
November 4–8, 2013. ACM Press. (Cited on page 3.)
Tibor Jager, Florian Kohlar, Sven Sch¨age, and J¨org Schwenk. On the security of TLS-DHE
in the standard model.
In Reihaneh Safavi-Naini and Ran Canetti, editors, Advances in
Cryptology – CRYPTO 2012, volume 7417 of Lecture Notes in Computer Science, pages 273–
293, Santa Barbara, CA, USA, August 19–23, 2012. Springer, Heidelberg, Germany. (Cited on
page 4.)
Markus Jakobsson and David Pointcheval. Mutual authentication for low-power mobile de-
vices.
In Paul F. Syverson, editor, FC 2001: 5th International Conference on Financial
Cryptography, volume 2339 of Lecture Notes in Computer Science, pages 178–195, Grand
Cayman, British West Indies, February 19–22, 2002. Springer, Heidelberg, Germany. (Cited on
pages 19 and 20.)
Caroline Kudla and Kenneth G. Paterson. Modular security proofs for key agreement pro-
tocols. In Bimal K. Roy, editor, Advances in Cryptology – ASIACRYPT 2005, volume 3788
of Lecture Notes in Computer Science, pages 549–565, Chennai, India, December 4–8, 2005.
Springer, Heidelberg, Germany. (Cited on pages 19 and 20.)
[KPW13] Hugo Krawczyk, Kenneth G. Paterson, and Hoeteck Wee. On the security of the TLS protocol:
A systematic analysis. In Ran Canetti and Juan A. Garay, editors, Advances in Cryptology
– CRYPTO 2013, Part I, volume 8042 of Lecture Notes in Computer Science, pages 429–
448, Santa Barbara, CA, USA, August 18–22, 2013. Springer, Heidelberg, Germany. (Cited on
page 4.)
[LC13]
Adam Langley and Wan-Teh Chang. QUIC Crypto. https://docs.google.com/document/
d/1g5nIXAIkN_Y-7XJW5K45IblHd_L2f5LTaDUDwvZ5L6g/, June 2013. retrieved on 2014-04-16.
(Cited on pages 5, 18, and 24.)
[LJBN15] Robert Lychev, Samuel Jero, Alexandra Boldyreva, and Cristina Nita-Rotaru. How secure
and quick is QUIC? Provable security and performance analyses. In 2015 IEEE Symposium
on Security and Privacy, pages 214–231, San Jose, California, USA, May 17–21, 2015. IEEE
Computer Society Press. (Cited on page 4.)
[LLM07]
Brian A. LaMacchia, Kristin Lauter, and Anton Mityagin. Stronger security of authenticated
key exchange. In Willy Susilo, Joseph K. Liu, and Yi Mu, editors, ProvSec 2007: 1st Interna-
tional Conference on Provable Security, volume 4784 of Lecture Notes in Computer Science,
26
[LM06]
[OP01]
pages 1–16, Wollongong, Australia, November 1–2, 2007. Springer, Heidelberg, Germany.
(Cited on page 5.)
Kristin Lauter and Anton Mityagin. Security analysis of KEA authenticated key exchange
protocol. In Moti Yung, Yevgeniy Dodis, Aggelos Kiayias, and Tal Malkin, editors, PKC 2006:
9th International Conference on Theory and Practice of Public Key Cryptography, volume 3958
of Lecture Notes in Computer Science, pages 378–394, New York, NY, USA, April 24–26, 2006.
Springer, Heidelberg, Germany. (Cited on pages 19 and 20.)
Tatsuaki Okamoto and David Pointcheval. The gap-problems: A new class of problems for
the security of cryptographic schemes.
In Kwangjo Kim, editor, PKC 2001: 4th Interna-
tional Workshop on Theory and Practice in Public Key Cryptography, volume 1992 of Lecture
Notes in Computer Science, pages 104–118, Cheju Island, South Korea, February 13–15, 2001.
Springer, Heidelberg, Germany. (Cited on pages 4 and 19.)
[Ros13]
Jim Roskind. QUIC (Quick UDP Internet Connections): Multiplexed Stream Transport
Over UDP. https://docs.google.com/document/d/1RNHkx_VvKWyWg6Lr8SZ-saqsQx7rFV-
ev2jRFUoVD34/, December 2013. retrieved on 2014-04-16. (Cited on pages 3 and 18.)
27