Program errors
Program errors might be associated with user application program code or IBM MQ code, and fall into two
categories:
• User detected errors
• Subsystem detected errors
User detected errors
User detected errors are detected by the user (or a user-written application program) when the results
of a service request are not as expected (for example, a nonzero completion code). The collection of
problem determination data cannot be automated because detection occurs after the IBM MQ function
has completed. Rerunning the application with the IBM MQ user parameter trace facility activated can
provide the data needed to analyze the problem. The output from this trace is directed to the generalized
trace facility (GTF).
You can turn the trace on and off using an operator command. See “Tracing on z/OS” on page 395 for
more information.
Queue manager detected errors
The queue manager detects errors such as:
• A program check
• A data set filling up
• An internal consistency error
IBM MQ analyzes the error and takes the following actions:
• If the problem was caused by a user or application error (such as an invalid address being used), the
error is reflected back to the application by completion and reason codes.
• If the problem was not caused by a user or application error (for example, all available DASD has been
used, or the system detected an internal inconsistency), IBM MQ recovers if possible, either by sending
completion and reason codes to the application, or if this is not possible, by stopping the application.
• If IBM MQ cannot recover, it terminates with a specific reason code. An SVC dump is typically taken
recording information in the system diagnostic work area (SDWA) and variable recording area (VRA)
portions of the dump, and an entry is made in SYS1.LOGREC.
IBM MQ for z/OS abends
Abends can occur in WebSphere for z/OS or other z/OS systems. Use this topic to understand the IBM MQ
system abend codes and how to investigate abends which occur in CICS, IMS, and z/OS.
IBM MQ for z/OS uses two system abend completion codes, X'5C6' and X'6C6'. These codes identify:
• Internal errors encountered during operation
• Diagnostic information for problem determination
250 Troubleshooting and Support for IBM MQ
• Actions initiated by the component involved in the error
X'5C6'
An X'5C6' abend completion code indicates that IBM MQ has detected an internal error and has
terminated an internal task (TCB) or a user-connected task abnormally. Errors associated with an
X'5C6' abend completion code might be preceded by a z/OS system code, or by internal errors.
Examine the diagnostic material generated by the X'5C6' abend to determine the source of the error
that actually resulted in a subsequent task or subsystem termination.
X'6C6'
An X'6C6' abend completion code indicates that IBM MQ has detected a severe error and has
terminated the queue manager abnormally. When an X'6C6' is issued, IBM MQ has determined that
continued operation could result in the loss of data integrity. Errors associated with an X'6C6' abend
completion code might be preceded by a z/OS system error, one or more X'5C6' abend completion
codes, or by error message CSQV086E indicating abnormal termination of IBM MQ.
Table 8 on page 251 summarizes the actions and diagnostic information available to IBM MQ for z/OS
when these abend completion codes are issued. Different pieces of this information are relevant in
different error situations. The information produced for a particular error depends upon the specific
problem. For more information about the z/OS services that provide diagnostic information, see
“Diagnostic information produced on IBM MQ for z/OS” on page 253.
Table 8. Abend completion codes
X'5C6' X'6C6'
Explanation • Error during IBM MQ normal operation • Severe error; continued operation
might jeopardize data integrity
System action • Internal IBM MQ task is abended • The entire IBM MQ subsystem is
abended
• Connected user task is abended
• User task with an active IBM MQ
connection might be abnormally
terminated with an X'6C6' code
• Possible MEMTERM (memory
termination) of connected allied
address space
Diagnostic • SVC dump • SYS1.LOGREC
information
• SYS1.LOGREC entry • VRA data entries
• VRA data entries
Associated reason • IBM MQ abend reason code • Subsystem termination reason code
codes
• Associated z/OS system codes • z/OS system completion codes and
X'5C6' codes that precede the
X'6C6' abend
Location of • SVC dump title • SYS1.LOGREC
accompanying
• Message CSQW050I • VRA data entries
codes
• Register 15 of SDWA section General • Message CSQV086E, which is sent to
Purpose Registers at Time of Error z/OS system operator
• SYS1.LOGREC entries
• VRA data entries
IBM MQ troubleshooting and support 251
Related concepts
“Dealing with abends on IBM MQ for z/OS” on page 252
Abends can occur with applications and other z/OS systems. Use this topic to investigate program abends,
batch abends, CICS transaction abends, and IMS transaction abends.
“CICS, IMS, and z/OS abends” on page 253
Use this topic to investigate abends from CICS, IMS, and z/OS.
“Diagnostic information produced on IBM MQ for z/OS” on page 253
Use this topic to investigate some of the diagnostic information produced by z/OS that can be useful
in problem determination and understand how to investigate error messages, dumps, console logs, job
output, symptom strings, and queue output.
“IBM MQ for z/OS dumps” on page 267
Use this topic for information about the use of dumps in problem determination. It describes the steps
you should take when looking at a dump produced by an IBM MQ for z/OS address space.
Dealing with abends on IBM MQ for z/OS
Abends can occur with applications and other z/OS systems. Use this topic to investigate program abends,
batch abends, CICS transaction abends, and IMS transaction abends.
Types of abend
Program abends can be caused by applications failing to check, and respond to, reason codes from IBM
MQ. For example, if a message has not been received, using fields that would have been set up in the
message for calculation might cause X'0C4' or X'0C7' abends (ASRA abends in CICS ).
The following pieces of information indicate a program abend:
• Error messages from IBM MQ in the console log
• CICS error messages
• CICS transaction dumps
• IMS region dumps
• IMS messages on user or master terminal
• Program dump information in batch or TSO output
• Abend messages in batch job output
• Abend messages on the TSO screen
If you have an abend code, see one of the following documentation for an explanation of the cause of the
abend:
• For IBM MQ for z/OS abends (abend codes X'5C6' and X'6C6'), see IBM MQ for z/OS messages,
completion, and reason codes
• For batch abends, the z/OS MVS System Codes manual
• For CICS abends, CICS Messages
• For IMS abends, IMS Messages and Codes
• For Db2 abends, Db2 Messages
• For RRS abends, z/OS MVS System Messages, Volume 3
• For XES abends, z/OS MVS System Messages, Volume 10
Batch abends
Batch abends cause an error message containing information about the contents of registers to be
displayed in the syslog. TSO abends cause an error message containing similar information to be
produced on the TSO screen. A SYSUDUMP is taken if there is a SYSUDUMP DD statement for the step
(see “IBM MQ for z/OS dumps” on page 267 ).
252 Troubleshooting and Support for IBM MQ
CICS transaction abends
CICS transaction abends are recorded in the CICS CSMT log, and a message is produced at the terminal (if
there is one). A CICS AICA abend indicates a possible loop. See “Dealing with loops on z/OS” on page 292
for more information. If you have a CICS abend, using CEDF and the CICS trace might help you to find the
cause of the problem. See CICS Troubleshooting, formerly the CICS Problem Determination Guide for more
information.
IMS transaction abends
IMS transaction abends are recorded on the IMS master terminal, and an error message is produced at
the terminal (if there is one). If you have an IMS abend, see Troubleshooting for IMS.
CICS, IMS, and z/OS abends
Use this topic to investigate abends from CICS, IMS, and z/OS.
CICS abends
A CICS abend message is sent to the terminal, if the application is attached to one, or to the CSMT log.
CICS abend codes are explained in the CICS Messages and Codes manual.
The CICS adapter issues abend reason codes beginning with the letter Q (for example, QDCL). These
codes are documented in IBM MQ for z/OS messages, completion, and reason codes
IMS abends
An IMS application might abend in one of the following circumstances:
• A normal abend.
• An IMS pseudo abend, with an abend code such as U3044 resulting from an error in an ESAF exit
program.
• Abend 3051 or 3047, when the REO (region error option) has been specified as "Q" or "A", and an
IMS application attempts to reference a non-operational external subsystem, or when resources are
unavailable at the time when a thread is created.
An IMS message is sent to the user terminal or job output, and the IMS master terminal. The abend might
be accompanied by a region dump.
z/OS abends
During IBM MQ operation, an abend might occur with a z/OS system completion code. If you receive a
z/OS abend, see the appropriate z/OS publication.
Diagnostic information produced on IBM MQ for z/OS
Use this topic to investigate some of the diagnostic information produced by z/OS that can be useful
in problem determination and understand how to investigate error messages, dumps, console logs, job
output, symptom strings, and queue output.
IBM MQ for z/OS functional recovery routines use z/OS services to provide diagnostic information to help
you in problem determination.
The following z/OS services provide diagnostic information:
IBM MQ troubleshooting and support 253
SVC dumps
The IBM MQ abend completion code X'5C6' uses the z/OS SDUMP service to create SVC dumps. The
content and storage areas associated with these dumps vary, depending on the specific error and the
state of the queue manager at the time the error occurred.
SYS1.LOGREC
Entries are requested in the SYS1.LOGREC data set at the time of the error using the z/OS SETRP
service. The following information is also recorded in SYS1.LOGREC:
• Subsystem abnormal terminations
• Secondary abends occurring in a recovery routine
• Requests from the recovery termination manager
Variable recording area (VRA) data
Data entries are added to the VRA of the SDWA by using a z/OS VRA defined key. VRA data includes a
series of diagnostic data entries common to all IBM MQ for z/OS abend completion codes. Additional
information is provided during initial error processing by the invoking component recovery routine, or
by the recovery termination manager.
IBM MQ for z/OS provides unique messages that, together with the output of dumps, are aimed at
providing sufficient data to allow diagnosis of the problem without having to try to reproduce it. This is
known as first failure data capture.
Error messages
IBM MQ produces an error message when a problem is detected. IBM MQ diagnostic messages begin with
the prefix CSQ. Each error message generated by IBM MQ is unique; that is, it is generated for one and
only one error. Information about the error can be found in IBM MQ for z/OS messages, completion, and
reason codes.
The first three characters of the names of IBM MQ modules are also usually CSQ. The exceptions to
this are modules for C++ (IMQ), and the header files (CMQ). The fourth character uniquely identifies
the component. Characters five through eight are unique within the group identified by the first four
characters.
Make sure that you have some documentation on application messages and codes for programs that were
written at your installation, as well as viewing IBM MQ for z/OS messages, completion, and reason codes
There might be some instances when no message is produced, or, if one is produced, it cannot be
communicated. In these circumstances, you might have to analyze a dump to isolate the error to a
particular module. For more information about the use of dumps, see “IBM MQ for z/OS dumps” on page
267.
Dumps
Dumps are an important source of detailed information about problems. Whether they are as the result of
an abend or a user request, they allow you to see a snapshot of what was happening at the moment the
dump was taken. “IBM MQ for z/OS dumps” on page 267 contains guidance about using dumps to locate
problems in your IBM MQ system. However, because they only provide a snapshot, you might need to use
them with other sources of information that cover a longer period of time, such as logs.
Snap dumps are also produced for specific types of error in handling MQI calls. The dumps are written to
the CSQSNAP DD.
Console logs and job output
You can copy console logs into a permanent data set, or print them as required. If you are only interested
in specific events, you can select which parts of the console log to print.
254 Troubleshooting and Support for IBM MQ
Job output includes output produced from running the job, as well as that from the console. You can
copy this output into permanent data sets, or print it as required. You might need to collect output for all
associated jobs, for example CICS, IMS, and IBM MQ.
Symptom strings
Symptom strings display important diagnostic information in a structured format. When a symptom string
is produced, it is available in one or more of the following places:
• On the z/OS system console
• In SYS1.LOGREC
• In any dump taken
Figure 15 on page 255 shows an example of a symptom string.
PIDS/ 5655R3600 RIDS/CSQMAIN1 AB/S6C6 PRCS/0E30003
Figure 15. Sample symptom string
The symptom string provides a number of keywords that IBM Support can use to search the software
support database. If you report a problem, you are often asked to quote the symptom string.
Although the symptom string is designed to provide keywords for searching the database, it can also give
you a lot of information about what was happening at the time the error occurred, and it might suggest an
obvious cause or a promising area to start your investigation.
Queue information
You can display information about the status of queues by using the operations and control panels.
Alternatively you can enter the DISPLAY QUEUE and DISPLAY QSTATUS commands from the z/OS
console.
Note: If the command was issued from the console, the response is copied to the console log, allowing
the documentation to be kept together compactly.
Related concepts
“Other sources of problem determination information for IBM MQ for z/OS” on page 256
Use this topic to investigate other sources of information for IBM MQ for z/OS problem determination.
“Diagnostic aids for CICS” on page 257
You can use the CICS diagnostic transactions to display information about queue manager tasks, and MQI
calls. Use this topic to investigate these facilities.
“Diagnostic aids for IMS” on page 267
Use this topic to investigate IMS diagnostic facilities.
“Diagnostic aids for Db2” on page 267
Use this topic to investigate references for Db2 diagnostic tools.
Related tasks
“Tracing on z/OS” on page 395
IBM MQ troubleshooting and support 255
There are different trace options that can be used for problem determination with IBM MQ. Use this topic
to understand the different options and how to control trace.
Other sources of problem determination information for IBM MQ for
z/OS
Use this topic to investigate other sources of information for IBM MQ for z/OS problem determination.
You might find the following items of documentation useful when solving problems with IBM MQ for z/OS.
• Your own documentation
• Documentation for the products you are using
• Source listings and link-edit maps
• Change log
• System configuration charts
• Information from the DISPLAY CONN command
Your own documentation
Your own documentation is the collection of information produced by your organization about what your
system and applications should do, and how they are supposed to do it. How much of this information you
need depends on how familiar you are with the system or application in question, and could include:
• Program descriptions or functional specifications
• Flowcharts or other descriptions of the flow of activity in a system
• Change history of a program
• Change history of your installation
• Statistical and monitoring profile showing average inputs, outputs, and response times
Documentation for the products you are using
The documentation for the product you are using are the InfoCenters in the IBM MQ library, and in the
libraries for any other products you use with your application.
Make sure that the level of any documentation you refer to matches the level of the system you are using.
Problems often arise through using either obsolete information, or information about a level of a product
that is not yet installed.
Source listings and link-edit maps
Include the source listings of any applications written at your installation with your set of documentation.
(They can often be the largest single element of documentation. ) Make sure that you include the relevant
output from the linkage editor with your source listings to avoid wasting time trying to find your way
through a load module with an out-of-date link map. Be sure to include the JCL at the beginning of your
listings, to show the libraries that were used and the load library the load module was placed in.
Change log
The information in the change log can tell you of changes made in the data processing environment that
might have caused problems with your application program. To get the most out of your change log,
include the data concerning hardware changes, system software (such as z/OS and IBM MQ) changes,
application changes, and any modifications made to operating procedures.
256 Troubleshooting and Support for IBM MQ
System configuration charts
System configuration charts show what systems are running, where they are running, and how the
systems are connected to each other. They also show which IBM MQ, CICS, or IMS systems are test
systems and which are production systems.