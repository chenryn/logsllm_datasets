0.15
1.28
2.00
0.30
1.28
1.28
0.15
0.10
0.87
3.84
0.45
3.84
6.00
0.90
3.84
3.84
0.45
0.30
2.61
INT
CFO
RSSI
Overall
FP
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
FN
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
FP
0.80
1.38
0.56
0.64
1.12
0.77
0.98
0.60
0.88
0.86
FN
0.00
17.74
4.46
0.00
4.85
8.17
1.41
1.67
14.28
5.84
FP
0.97
3.59
1.43
1.32
1.26
1.64
1.18
0.85
1.48
1.52
FN
5.84
21.15
5.22
22.94
1.60
1.46
3.00
1.55
15.73
8.72
FP
1.76
4.92
1.98
1.95
2.37
2.40
2.15
1.44
2.35
2.37
FN
0.00
3.69
0.23
0.00
0.08
0.12
0.04
0.03
2.25
0.72
6.2 Overall Effectiveness
The detection performance of BlueShield is evaluated in terms
of two metrics: false positive (FP) and false negative (FN)
misclassiﬁcations. A false positive refers to the error in which
BlueShield generates a false alarm for a spooﬁng attack after
inspecting benign advertising packets generated by the benign
BLE device. A false negative refers to the error in which
BlueShield fails to detect a spooﬁng attack after analyzing
spoofed advertising packets from the attacker.
We highlight that the INT inspection, and the CFO and
RSSI inspection are exclusively employed to detect spooﬁng
attacks under different scenarios (Figure 6). The INT inspec-
tion readily uncovers an attack in which the attacker transmits
spoofed advertising packets while the BLE device is broad-
casting benign advertising packets. In such a scenario, the INT
inspection does not introduce any FP and causes negligible FN
in detecting attacks (Appendix C). However, the INT inspec-
tion cannot be used to detect an advanced attack where the
attacker ﬁrst suppresses the broadcast of benign advertising
packets by connecting to the BLE device whose advertising
pattern is intermittent, and then transmits spoofed advertising
packets with the same advertising period. BlueShield employs
the CFO and RSSI inspection to detect this type of attack.
Since BlueShield raises an alarm for a spooﬁng attack when
either CFO inspection or RSSI inspection detects an anomaly,
BlueShield signiﬁcantly reduces FN at the cost of a slight in-
crease in FP. Theoretically, since these inspection mechanisms
employ independent features, the overall FN of BlueShield
can be calculated as FNBlueShield = FNCFO × FNRSSI. Also,
the overall FP generated by BlueShield can be calculated as
FPBlueShield = FPCFO + FPRSSI − FPCFO × FPRSSI.
6.2.1 Summary
As shown in Table 2, BlueShield achieves an average of 2.37%
FP rate and 0.72% FN rate on our tested BLE devices. The
results are obtained when the inspection thresholds τc and τr
in the CFO and RSSI inspection are set to 3 and 5 respectively.
The numbers of advertising packets in the lookback window
(Nl) and observation window (No) are set to 100 and 3, re-
spectively. This means BlueShield is set to report a potential
spooﬁng attack within three advertising periods, resulting in
an average detection time of 2.61s based on the correspond-
ing advertising period (see columns 3 and 4 in Table 2). Note
that, we present our results with these reasonable values of
parameters to illustrate a setting where BlueShield provides
low FP values while detecting spooﬁng attacks against all
nine BLE devices. BlueShield can also be employed with
device-speciﬁc parameters with minimal effort to achieve
an appropriate trade-off between FP and FN in a real-world
deployment. For example, as shown in the receiver operat-
ing characteristic (ROC) curve in Figure 12, when the true
positive decreases (i.e., FN increases), FP also decreases.
False Positive. As shown in Table 2, while the INT inspec-
tion does not introduce any FP, the average FP triggered by the
CFO and RSSI inspection are 0.86% and 1.52% respectively.
Overall, BlueShield achieves an average FP of 2.37%. To bet-
ter illustrate the real-world impact of the FP rate, we consider
a user device that makes ﬁve connections per day with the
light bulb with Device ID = 9. We note that this is already a
heavy usage scenario based on an IoT device usage frequency
report [44]. As shown in Table 2, BlueShield achieves an av-
erage FP of 2.35% for this BLE device within an observation
window of 0.3s. Hence, BlueShield will only cause an average
of 5× 2.35/100 = 0.1175 false alarm per day, which implies
that there will be less than one false alarm during a one-week
deployment. However, we point out that if we ceaselessly
monitor the physical features of all packets transmitted by the
BLE device, we would encounter 60×60×24×2.35/100
= 6768
false alarms per day. Fortunately, BlueShield employs the
selective inspection mechanism so that the CFO and RSSI
inspection are triggered only when the BLE device makes an
advertising-to-connection state transition. This mechanism
drastically reduces such false alarms. Figure 11 further illus-
trates the impact of the selective inspection mechanism on
the number of false alarms at different FP rates.
0.3
In Table 2, we observe that while the INT in-
False Negative.
spection detects spooﬁng attacks quite robustly, the CFO and
RSSI inspection achieve an average FN of 5.84% and 8.72%
in detecting spooﬁng attacks. Overall, BlueShield achieves
404    23rd International Symposium on Research in Attacks, Intrusions and Defenses
USENIX Association
104
102
100
y
a
d
r
e
p
s
m
r
a
a
l
l
e
s
a
F
10-2
0
 Without selective inspection
 With selective inspection
2
4
6
8
10
False postive (%)
Figure 11: Number of false alarms per day with and without
selective inspection mechanism in BlueShield.
an average FN of 0.72% which implies a detection rate of
99.28%. Further, we point out that most BLE devices force
a disconnection after a certain time-out (e.g., 30 s). There-
fore, to incessantly suppress benign advertising packets and
replace them with spoofed advertising packets, an attacker
may need to trigger multiple connections with the BLE de-
vice. As a result, the attacker is exposed to multiple CFO
and RSSI inspections by BlueShield. For instance, if the at-
tacker triggers three connections during a spooﬁng attack,
BlueShield can fail to detect the attack with an average FN of
only 3.7× 10−7% (= 0.00723).
6.2.2 Robustness against Advanced Attacker
3−1 (cid:1) = Nc! (Nc−1)(Nc−2)
As mentioned earlier, BlueShield’s randomized channel
switching (Section 4.3.1) ensures that even for an advanced
attacker which can precisely mimic the values of all physical
features, there is barely any chance to evade detection. We
evaluate the detection performance of BlueShield against such
attacks as follows: In the randomized channel switching mech-
anism, the number of ways in which the monitor can assign Nc
collectors the task to record and cover all the three advertising
channels is given by Nc!(cid:0)Nc−1
. Hence, the
probability with which an attacker can correctly guess the
channel assignments over No advertising intervals within the
Nc! (Nc−1)(Nc−2) )No . For the
observation window is given by (
three collectors (i.e., Nc = 3) recording the feature values over
three advertising intervals (i.e., No = 3 as shown in Table 2),
the probability of correct guesses by the attacker can be calcu-
lated as ( 1
6 )3 ≈ 0.46%. As a result, the average detection rate
of a spooﬁng attack launched by this type of attack over one
observation window can be calculated as 99.54%. To this end,
we conclude that the randomized channel switching enables
BlueShield to effectively detect attackers that try to mimic all
physical features used for detection.
2
2
6.3 Effectiveness of Individual Features
In the INT inspection, an anomaly is detected
INT Feature.
when the observed INT is less than the lower bound of INT.
Since each of the benign BLE device’s INT is always larger
Table 3: Effectiveness of the CFO inspection in differentiating
packets transmitted by different platforms.
Device
ID
1
2
3
4
5
6
7
8
9
FP
0.80
1.38
0.56
0.64
1.12
0.77
0.98
0.60
0.88
Average 0.86
Dev-11 Dev-22 Dongle3 Laptop4 Average
FN
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
5.41
0.00
0.00
18.97
15.17
0.00
0.02
50.80
10.04
0.00
64.46
17.84
0.00
0.41
17.50
5.64
6.67
0.00
12.50
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00
6.33
0.70
0.00
17.74
4.46
0.00
4.85
8.17
1.41
1.67
14.28
5.84
1. HM-10 Bluetooth chip with expansion shield.
2. CYW920735Q60EVB-01 evaluation kit.
3. CSR 4.0 Bluetooth USB adapter.
4. Dell Latitude 5480 with built-in Qualcomm Bluetooth chip.
Table 4: CFO inspection results while using different copies
of Nest Protect smoke detector as the BLE device and attacker.
FP
0.00
3.85
0.96
Copy-1
N/A
12.32
0.00
FN
Copy-2
16.41
N/A
0.00
Copy-3
0.00
0.06
N/A
Copy-1
Copy-2
Copy-3
than the calculated lower bound of INT, by deﬁnition, there
cannot be any FP in the INT inspection. Regarding the FN,
recall that every broadcast of a spoofed advertising packet by
the attacker results in an observed INT value that is smaller
than the lower bound of INT. Hence, by noticing such an
anomaly, the INT inspection detects the spooﬁng attack with
negligible FN. Due to space limitation, we leave the detailed
theoretical analysis about the FN in Appendix C.
CFO Feature. Through our extensive experiments, we val-
idate two critical characteristics of the CFO feature. (1) The
CFO value of a BLE device is not affected by changing its
relative location to collectors. This is because CFO is a device-
speciﬁc feature, i.e., it is related to the device’s RF circuit.
(2) The CFO value is robust against interference from hu-
man movements as it only depends on RF signals’ frequency
values rather than their amplitude values. Table 3 shows the re-
sults obtained by launching spooﬁng attacks on the nine BLE
devices by the four attacker platforms. We observe that spoof-
ing attacks can be robustly detected using the CFO inspection
in most cases. Moreover, Table 4 shows the performance of
CFO inspection when using different copies of the same BLE
device as the benign BLE device and the attack device. We
observe that even though the different copies have the same
Bluetooth chip from the same manufacturer with the same
version, the copy used as the BLE device can be readily dif-
ferentiated from the copy used as the attacker.
In a few cases, BlueShield has relatively high FN values