What	
  the	
  Watchers	
  See	
Weaknesses	
  in	
  Municipal	
  Mesh	
Network	
  Deployments	
Dus8n	
  Hoﬀman	
  &	
  Thomas	
  (TK)	
  Kinsey	
DEF	
  CON	
  22	
Dus8n	
  Hoﬀman	
the	
  researcher,	
  not	
  the	
  actor	
  :’(	
•  Senior	
  Engineer	
  @	
  Exigent	
  Systems	
•  Principal	
  @	
  various	
  other	
  concerns	
Thomas	
  (TK)	
  Kinsey	
•  Senior	
  Engineer	
  @	
  Exigent	
  Systems	
•  Principal	
  @	
  3Kappa	
  Research	
What	
  The	
  Watchers	
  See	
How	
  it	
  started	
…	
  open	
  wiﬁ	
  network(s)	
  available	
What	
  The	
  Watchers	
  See	
The	
  Transparent	
  Society	
  by	
  David	
  Brin	
hRp://archive.wired.com/wired/archive/4.12/Wransparent_pr.html	
What	
  The	
  Watchers	
  See	
Why	
  are	
  municipali8es	
  deploying	
these	
  networks?	
City	
  services:	
  police,	
  traﬃc,	
  2-­‐way	
audio,	
  site	
  monitoring,	
  force	
mul8plier,	
  shrinking	
  budgets	
  :(	
What	
  The	
  Watchers	
  See	
Network	
  implementa8on	
Wireless	
  mesh	
Mo8va8ons:	
  lower	
  cost,	
  shorten	
  install	
  8me,	
  no	
trenching,	
  permi]ng	
What	
  The	
  Watchers	
  See	
Project	
  /	
  Integra8on	
  Vendors	
E.g.,	
  LeverageIS	
hRp://www.leverageis.com/	
What	
  The	
  Watchers	
  See	
What	
  The	
  Watchers	
  See	
Implementa8on	
  Hardware	
Common	
  oﬀ-­‐the-­‐shelf	
  hardware	
e.g.	
  Fire8de/UNICOM,	
  Bosh	
  cameras,	
DVR/NVRs	
What	
  The	
  Watchers	
  See	
Our	
  Lab	
What	
  The	
  Watchers	
  See	
What	
  The	
  Watchers	
  See	
Fire8de	
  speciﬁc	
  info:	
ﬁlesystem	
reverse	
  engineering	
etc.	
What	
  The	
  Watchers	
  See	
Implementa8on	
  Protocols	
802.11	
  2.4Ghz,	
  5Ghz,	
  &	
  900Mhz	
Mesh:	
  Open	
  standards	
  vs	
  AutoMesh	
Interes8ngly,	
  2.4Ghz	
  is	
  in	
  use,	
  not	
  men8oned	
hRp://www.cityofredlands.org/sites/default/ﬁles/Purchasing/Public
%20Safety%20Camera%20System%20Admin%202014%20RFP
%205.5.14.pdf	
What	
  The	
  Watchers	
  See	
Mesh	
  in	
  general:	
• 
Mul8ple	
  wireless	
  paths	
• 
Nodes	
  aren’t	
  guaranteed	
  a	
  reliable	
  connec8on	
to	
  the	
  backhaul	
• 
Protocol	
  provides	
  node	
  IDs,	
  mesh	
  health	
  info,	
etc.	
What	
  The	
  Watchers	
  See	
Wired	
Mesh	
What	
  The	
  Watchers	
  See	
Mesh	
  in	
Our	
Speciﬁc	
Case	
hRp://www.cityofredlands.org/sites/default/ﬁles/Purchasing/Public%20Safety%20Camera%20System%20Admin%202014%20RFP%205.5.14.pdf	
What	
  The	
  Watchers	
  See	
AutoMesh	
  Speciﬁcs	
•  Proprietary	
  &	
  details	
  not	
  published	
•  19	
  patents	
  to	
  date	
What	
  The	
  Watchers	
  See	
AutoMesh	
  Speciﬁcs	
External	
  headers	
  look	
  normal	
What	
  The	
  Watchers	
  See	
AutoMesh	
  Speciﬁcs	
Header	
  part	
  1	
  of	
  2	
What	
  The	
  Watchers	
  See	
AutoMesh	
  Speciﬁcs	
Header	
  part	
  1	
  of	
  2	
  (broadcast)	
What	
  The	
  Watchers	
  See	
AutoMesh	
  Speciﬁcs	
Header	
  part	
  2	
  of	
  2	
  (broadcast	
  again)	
What	
  The	
  Watchers	
  See	
AutoMesh	
  Speciﬁcs	
Enclosed	
  header	
  looks	
  normal	
This	
  one’s	
  a	
  CDP	
  packet.	
What	
  The	
  Watchers	
  See	
Speciﬁc	
  case	
hRps://mapsengine.google.com/map/edit?mid=zLPNQqdIZ4w4.klDGLs4MNr3w	
Open	
  before,	
  now	
  with	
  WEP!!	
What	
  The	
  Watchers	
  See	
Speciﬁc	
  case	
hRp://www.cityofredlands.org/sites/default/ﬁles/Purchasing/Public%20Safety%20Camera%20System%20Admin%202014%20RFP%205.5.14.pdf	
hRp://www.cityofredlands.org/sites/default/ﬁles/pdfs/Under_the_Watchful_Eye.pdf	
hRp://www.cityofredlands.org/sites/default/ﬁles/pdfs/Video_surveillance_guidelines.pdf	
hRp://www.leverageis.com/pdfs/Yucaipa%20to%20install%20city-­‐wide.pdf	
What	
  The	
  Watchers	
  See	
What	
  The	
  Watchers	
  See	
What	
  The	
  Watchers	
  See	
What	
  The	
  Watchers	
  See	
What	
  The	
  Watchers	
  See	
What	
  The	
  Watchers	
  See	
What	
  The	
  Watchers	
  See	
This	
  sign	
makes	
  it	
  all	
OK….	
What	
  The	
  Watchers	
  See	
Security	
•  Access	
  to	
  transmission	
  medium	
•  node	
  authen8ca8on	
  (bank	
  calling/GSM)	
•  link	
  encryp8on	
What	
  The	
  Watchers	
  See	
Security	
•  Direc8on	
  antennae	
  to	
  “secure”	
  medium	
What	
  The	
  Watchers	
  See	
Security	
• 
Content	
  encryp8on	
• 
Node	
  authen8ca8on	
  via	
  PKI,	
  not	
  turned	
  on	
• 
AutoMesh	
  as	
  security	
  /	
  obscura8on	
What	
  The	
  Watchers	
  See	
Security	
• 
Sloppy	
  integrators	
• 
No	
  in-­‐house	
  exper8se	
  or	
  on-­‐going	
  tes8ng	
  /	
pen-­‐tes8ng,	
  ‘cuz	
  $$$	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
• 
!!	
  Federal	
  &	
  State	
  wiretapping	
  laws,	
  or	
  more,	
may	
  be	
  applicable	
  in	
  your	
  research.	
  Please	
contact	
  a	
  legal	
  professional	
• 
IANAL	
• 
info@eﬀ.org	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
•  Observing	
  video	
  streams	
•  Mul8cast:	
  subscribe	
  yourself	
  to	
  arbitrary	
  feeds	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
Denial	
  of	
  service	
  via:	
• 
ﬂood	
• 
crude	
  jamming	
• 
oversubscribe	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
•  ARP	
  spoof:	
  become	
  a	
  node	
  or	
  the	
  NVR/DVR	
…	
  so	
  dirty.	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
Or	
  easier:	
•  Join	
  the	
  mesh	
  “legi8mately”	
•  There	
  are	
  only	
  256	
  “mesh	
  IDs”	
…	
  so	
  dir8er.	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
•  Access	
  to	
  internal	
  municipal	
  network	
  /	
  PD	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
• 
Video	
  manipula8on/injec8on	
  “all’s	
  well”	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
•  UDP	
  increment	
  aRack	
What	
  The	
  Watchers	
  See	
UDP	
  increment	
  aRack	
  (1)	
What	
  The	
  Watchers	
  See	
UDP	
  increment	
  aRack	
  (2)	
DC22	
  ORIGINAL	
  ILLUS	
  0`	
What	
  The	
  Watchers	
  See	
UDP	
  increment	
  aRack	
  (3)	
DC22	
  ORIGINAL	
  ILLUS	
  0`	
What	
  The	
  Watchers	
  See	
UDP	
  increment	
  aRack	
  (4)	
DC22	
  ORIGINAL	
  ILLUS	
  0`	
What	
  The	
  Watchers	
  See	
Poten8al	
  Threats	
•  Non-­‐video	
  manipula8on:	
  infrared	
  tripwires	
  &	
area	
  sensors	
  to	
  direct	
  police	
  resource	
  or	
  draw	
aRen8on	
What	
  The	
  Watchers	
  See	
Privacy	
  Abuse	
  &	
  Misuse	
•  Long-­‐term	
  Archival	
•  General	
  shenanigans	
  (VZ	
  tech,	
  NSA	
  20	
  yr	
  olds)	
What	
  The	
  Watchers	
  See	
Demo	
  is	
  Sad	
  ‘cuz	
  WEP	
  L	
What	
  The	
  Watchers	
  See	
THANK	
  YOU!