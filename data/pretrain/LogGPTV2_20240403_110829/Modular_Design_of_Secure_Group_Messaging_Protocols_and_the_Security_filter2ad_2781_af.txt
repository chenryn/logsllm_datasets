// Store Key Bundle of a Contact
Get-KB(IDâ€², kb)
(wpk, spk, sig) â† kb
req spk âˆˆ CL-S[IDâ€²]
req S-Ver(spk, wpk, sig)
CL-KB[IDâ€²].enq((wpk, spk))
// Set Callerâ€™s ID
ME â† ID
// Stored Sig. Keys
SK-sk[.] â† ğœ€
// Stored Wel. Keys
WK-wk[.] â† ğœ€
// Contact List
CL-KB[.] â† ğœ€
//
â€“ Group Specific State â€“
// Buffered Props
s.Props[.] â† ğœ€
// Roster
s.G â† [.]
// CGKA State
s.ğ›¾ â† ğœ€
// PRF-PRG State
s.ğœ â† ğœ€
// FS-GAEAD States
s.ğ‘£[.] â† ğœ€
// Current Epoch ID
s.C-epid â† ğœ€
// My Sig. Key
s.C-ssk â† ğœ€
// Verif. Keys
s.Ep-SPK[., .] â† ğœ€
s.km â† ğœ€
// MAC Key
Figure 6: The SGM Construction : Initialization and PKI Algo-
rithms.
Session 5C: Messaging and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1474// Determines if authenticity of epoch vid compromised
*auth-compr(vid)
return Â¬*PP-secure(vid, *Proj-PP(SGM-Data))
// Determines if IDâ€™s signature key is compromised in epoch vid
*SK-compr(vid, ID)
chk HG.getSKIDs(vid, ID) âˆ© SK-Lk = âˆ…
// Privacy Predicate
*AM-sec (vid, S, ğ‘–)
if *PP-secure(vid, *Proj-PP(SGM-Data))
return *FS-sec((S, ğ‘–), *Proj-FS(SGM-Data, vid))
return false
// Project History Graph to PRF-PRNG Game
*Proj-PP (SGM-Data = (V, P, V-Lk, AM-Lk, BR, WK-Lk))
for (vid, orig, data, pid) âˆˆ V
for vid âˆˆ Vâ€²
return (Vâ€², V-Lk, BI)
Vâ€² +â† vid
BI[vid] â† Â¬*CGKA-priv(vidâ€², *Proj-CGKA(SGM-Data))
// Project History Graph to CGKA Game
*Proj-CGKA (SGM-Data = (V, P, V-Lk, AM-Lk, BR, WK-Lk))
for (vid, orig, data, pid) âˆˆ V
Vâ€² +â† (vid, orig, pid)
for ğ‘ = (pid, vid, orig, op, data) âˆˆ V
if op = add
let data = (IDâ€², wkidâ€², skidâ€²)
dataâ€² â† (IDâ€², wkidâ€²)
ğ‘â€² â† (pid, vid, op, orig, dataâ€²)
if op = rem
ğ‘â€² â† ğ‘
if op = upd
ğ‘â€² â† âŠ¥
Pâ€² +â† ğ‘â€²
return (Vâ€², Pâ€², V-Lk, BR, WK-Lk)
// Project History Graph to FS-GAEAD Game
*Proj-FS (SGM-Data = (V, P, V-Lk, AM-Lk, BR, WK-Lk), vid)
for (vid, ID, AM-Rcvd[ID], AM-Tr[ID]) âˆˆ AM-Lk
AM-Lkâ€² +â† (ID, AM-Rcvd[ID], AM-Tr[ID])
return AM-Lkâ€²
Figure 8: Safety oracles and safety predicate of the security
game for SGM schemes.
// Process a proposal
Proc-PM(P)
(Pâ€², ğ‘¡, sig) â† P
(., epid, ID, ., .) â† Pâ€²
req epid = s.C-epid
spk â† s.Ep-SPK[epid, ID]
req M-Ver(s.km, Pâ€², ğ‘¡)
req S-Ver(spk, (Pâ€², ğ‘¡), sig)
s.Props +â† Pâ€²
return *get-propInfo(Pâ€²)
// Send A Message
Send(ğ‘, ğ‘š)
ğ¸ â† s.C-epid
(s.ğ‘£[ğ¸], Â¯ğ‘’) â† F-Send(s.ğ‘£[ğ¸], (ğ¸, ğ‘), ğ‘š)
ğ‘’â€² â† (ğ¸, ğ‘, Â¯ğ‘’)
sig â† S-Sign(s.C-ssk, ğ‘’â€²)
return (ğ‘’â€², sig)
// Process Commit Message
Proc-CM(T)
// Call CGKA
(Tâ€², ğ‘¡, sig) â† T
(., epid, ID, h, Â¯T) â† Tâ€²
// Matching Epochs?
req epid = s.C-epid
spk â† s.Ep-SPK[epid, ID]
req S-Ver(spk, (Tâ€², ğ‘¡), sig)
P â† s.Props[h]
(s.ğ›¾, GI, ğ¼) â† K-Proc-Com(s.ğ›¾, Â¯T)
(s.ğœ, ğ‘˜ğ‘’ , s.km, s.C-epid) â† PP(s.ğœ, ğ¼ , H(Tâ€²))
req M-Ver(s.km, Tâ€², ğ‘¡)
s.G â† GI.G
ğ‘ğ‘œğ‘  â† *roster-pos(ME, s.G)
s.ğ‘£[s.C-epid] â† F-Init(ğ‘˜ğ‘’ , |s.G| , ğ‘ğ‘œğ‘ )
s.Ep-SPK[s.C-epid, .] â†
*new-spks(s.Ep-SPK[epid, Â·], P)
spk â† s.Ep-SPK[s.C-epid, ME]
s.C-ssk â† SK-sk[spk]
return GI
// Join a Group
Proc-WM(W)
// Start FS-GAEAD
(Wâ€², ğ‘¡, sig) â† W
(., IDğ‘  , ., v,ğ‘Špub,ğ‘Špriv, ğ‘’, wpk, spk) â†
Wâ€²
spk â† spk[IDğ‘  ]
req
spk âˆˆ CL-S[IDğ‘  ] âˆ§ S-Ver(spk, Wâ€², sig)
(esk, isk) â† WK-wk[wpk]
s.ğœ â† E-Dec(esk, ğ‘’)
(s.ğ›¾, GI, ğ¼) â† K-Join(ME, IDğ‘  ,ğ‘Špub,ğ‘Špriv, isk)
(s.ğœ, ğ‘˜ğ‘’ , s.km, s.C-epid) â† PP(s.ğœ, ğ¼ , v)
req M-Ver(s.km, (Wâ€², s.C-epid), ğ‘¡)
s.G â† GI.G
ğ‘ğ‘œğ‘  â† *roster-pos(ME, s.G)
s.ğ‘£[s.C-epid] â† F-Init(ğ‘˜ğ‘’ , |s.G| , ğ‘ğ‘œğ‘ )
s.Ep-SPK[s.C-epid, .] â† spk
spk â† s.Ep-SPK[s.C-epid, ME]
s.C-ssk â† SK-sk[spk]
s.Props â† ğœ€
// Create a group
Create(spk, wpk; ğ‘Ÿ)
s.G â† [ME]
wsk â† WK-wk[wpk]
(Â·, isk) â† wsk
(s.ğ›¾, ğ¼) â† K-Create(ME, isk; ğ‘Ÿ)
(s.ğœ, ğ‘˜ğ‘’ , s.km, s.C-epid) â† PP(0, ğ¼ , 0)
s.Ep-SPK[s.C-epid, ME] â† spk
s.ğ‘£[s.C-epid] â† F-Init(ğ‘˜ğ‘’ , 1, ME)
// Add proposal
Add(IDğ‘)
kbâ€² â† CL-KB[IDğ‘]
((epk, ipk), spk) â† kbâ€²
(s.ğ›¾, Â¯P) â† K-Add(s.ğ›¾, IDğ‘, ipk)
Pâ€² â† ("add", s.C-epid, ME, (IDğ‘, kbâ€²), Â¯P)
ğ‘¡ â† M-Tag(s.km, Pâ€²)
sig â† S-Sign(s.C-ssk, (Pâ€², ğ‘¡))
return (Pâ€², ğ‘¡, sig)
// Remove proposal
Remove(IDğ‘Ÿ )
(s.ğ›¾, Â¯P) â† K-Remove(s.ğ›¾, IDğ‘Ÿ )
Pâ€² â† ("rem", s.C-epid, ME, IDğ‘Ÿ , Â¯P)
ğ‘¡ â† M-Tag(s.km, Pâ€²)
sig â† S-Sign(s.C-ssk, (Pâ€², ğ‘¡))
return (Pâ€², ğ‘¡, sig)
// Update proposal
Update(spk; ğ‘Ÿ)
req SK-sk[spk] Ì¸= ğœ€
(s.ğ›¾, Â¯P) â† K-Update(s.ğ›¾; ğ‘Ÿ)
Pâ€² â† ("upd", s.C-epid, ME, spk, Â¯P)
ğ‘¡ â† M-Tag(s.km, Pâ€²)
sig â† S-Sign(s.C-ssk, (Pâ€², ğ‘¡))
return (Pâ€², ğ‘¡, sig)
// Receive A Message
Rcv(ğ‘, ğ‘’)
(ğ‘’â€², sig) â† ğ‘’
(epid, ğ‘, Â¯ğ‘’) â† ğ‘’â€²
(s.ğ‘£[epid], IDğ‘  , ğ‘–, ğ‘š) â† F-Rcv(s.ğ‘£[epid], (epid, ğ‘), Â¯ğ‘’)
req IDğ‘  Ì¸= âŠ¥
spk â† s.Ep-SPK[epid, IDğ‘  ]
req S-Ver(spk, ğ‘’â€², sig)
return (epid, IDğ‘  , ğ‘–, ğ‘š)
// Commit
Commit(P; ğ‘Ÿ)
//
// Commit Message
// Get CGKA Proposals
// New MAC Key & Epoch ID
â€“ Prepare Commit Message â€“
req P âŠ† s.Props
Â¯P â† P.Â¯P
(s.ğ›¾,ğ‘Špub, WPrv, Â¯T, ğ¼) â† K-Commit(s.ğ›¾, Â¯P; ğ‘Ÿ)
Tâ€² â† ("com", s.C-epid, ME, H(P), Â¯T)
v â† H(Tâ€²)
(., ., ğ‘˜ğ‘š, epid) â† PP(s.ğœ, ğ¼ , v)
ğ‘¡ â† M-Tag(ğ‘˜ğ‘š, Tâ€²)
sig â† S-Sign(s.C-ssk, (Tâ€², ğ‘¡))
T â† (Tâ€², ğ‘¡, sig)
(ID, wpk) â† *added(P)
spk â†
*new-spks(s.Ep-SPK[s.C-epid, Â·], P)
for ğ‘– âˆˆ ID
ğ‘’ â† E-Enc(wpk[ğ‘–].epk, s.ğœ)
Wâ€² â†
("wel", ME, ID[ğ‘–], v,ğ‘Špub, . . .
. . . , WPrv[ğ‘–], ğ‘’, wpk[ğ‘–], spk)
ğ‘¡ â† M-Tag(ğ‘˜ğ‘š, (Wâ€², epid))
sig â† S-Sign(spk[ME], (Wâ€², ğ‘¡))
W[ğ‘–] â† (Wâ€², ğ‘¡, sig)
â€“ Prepare Welcome Messages â€“
// Welcome Message
//
return (epid, W, T)
Figure 7: The SGM Construction: main algorithms.
Session 5C: Messaging and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1475REFERENCES
[1] J. Alwen, M. Capretto, M. Cueto, C. Kamath, K. Klein, G. Pascual-Perez, K. Pietrzak,
and M. Walter. Keep the dirt: Tainted treekem, an efficient and provably secure
continuous group key agreement protocol. IACR Cryptol. ePrint Arch., 2019:1489,
2019.
[2] J. Alwen, S. Coretti, and Y. Dodis. The double ratchet: Security notions, proofs,
and modularization for the Signal protocol. In Y. Ishai and V. Rijmen, editors,
EUROCRYPT 2019, Part I, volume 11476 of LNCS, pages 129â€“158. Springer, Hei-
delberg, May 2019.
[3] J. Alwen, S. Coretti, Y. Dodis, and Y. Tselekounis. Security analysis and improve-
ments for the IETF MLS standard for group messaging. In D. Micciancio and
T. Ristenpart, editors, CRYPTO 2020, Part I, volume 12170 of LNCS, pages 248â€“277.
Springer, Heidelberg, Aug. 2020.
[4] J. Alwen, S. Coretti, Y. Dodis, and Y. Tselekounis. Modular design of secure group
messaging protocols and the security of mls. Cryptology ePrint Archive, Report
2021/1083, 2021. https://ia.cr/2021/1083.
[5] J. Alwen, S. Coretti, D. Jost, and M. Mularczyk. Continuous group key agreement
[6] J. Alwen, D. Jost, and M. Mularczyk. On the insider security of MLS. IACR Cryptol.
[7] R. Barnes. Subject: [MLS] Remove without double-join (in TreeKEM), 2018.
with active security. In R. Pass and K. Pietrzak, editors, TCC 2020, 2020.
ePrint Arch., 2020:1327, 2020.
https://mailarchive.ietf.org/arch/msg/mls/Zzw2tqZC1FCbVZA9LKERsMIQXik.
[8] R. Barnes, B. Beurdouche, J. Millican, E. Omara, K. Cohn-Gordon, and R. Robert.
Internet-Draft draft-ietf-mls-
The Messaging Layer Security (MLS) Protocol.
protocol-11, Internet Engineering Task Force, Dec. 2020. Work in Progress.
[9] K. Bhargavan, B. Beurdouche, and P. Naldurg. Formal Models and Verified
Protocols for Group Messaging: Attacks and Proofs for IETF MLS. Research
report, Inria Paris, Dec. 2019.
[10] A. Bienstock, Y. Dodis, and P. RÃ¶sler. On the price of concurrency in group
[11] C. Brzuska, E. Cornelissen, and K. Kohbrok. Cryptographic security of the mls
ratcheting protocols. In R. Pass and K. Pietrzak, editors, TCC, 2020.
rfc, draft 11. Cryptology ePrint Archive, Report 2021/137, 2021.
[12] R. Canetti, J. A. Garay, G. Itkis, D. Micciancio, M. Naor, and B. Pinkas. Multicast
security: A taxonomy and some efficient constructions. In IEEE INFOCOMâ€™99,
pages 708â€“716, New York, NY, USA, Mar. 21â€“25, 1999.
[13] K. Cohn-Gordon, C. Cremers, L. Garratt, J. Millican, and K. Milner. On ends-to-
ends encryption: Asynchronous group messaging with strong security guarantees.
In D. Lie, M. Mannan, M. Backes, and X. Wang, editors, ACM CCS 2018, pages
1802â€“1819. ACM Press, Oct. 2018.
[14] K. Cohn-Gordon, C. J. F. Cremers, B. Dowling, L. Garratt, and D. Stebila. A
formal security analysis of the signal messaging protocol. In 2017 IEEE European
Symposium on Security and Privacy, EuroS&P 2017, pages 451â€“466, 2017.
[15] C. Cremers, B. Hale, and K. Kohbrok. Revisiting post-compromise security
guarantees in group messaging. IACR Cryptol. ePrint Arch., 2019:477, 2019.
[16] Y. Dodis and N. Fazio. Public key broadcast encryption for stateless receivers. In
J. Feigenbaum, editor, Digital Rights Management, pages 61â€“80, Berlin, Heidelberg,
2002. Springer Berlin Heidelberg.
[17] E. Eaton, D. Jao, , and C. Komlo. Towards post-quantum updatable public-key
encryption via supersingular isogenies. Cryptology ePrint Archive, Report
2020/1593, 2020. https://eprint.iacr.org/2020/1593.
[18] A. Fiat and M. Naor. Broadcast encryption. In D. R. Stinson, editor, CRYPTOâ€™93,
volume 773 of LNCS, pages 480â€“491. Springer, Heidelberg, Aug. 1994.
[19] Z. Jafargholi, C. Kamath, K. Klein, I. Komargodski, K. Pietrzak, and D. Wichs. Be
adaptive, avoid overcommitting. In J. Katz and H. Shacham, editors, CRYPTO 2017,
Part I, volume 10401 of LNCS, pages 133â€“163. Springer, Heidelberg, Aug. 2017.
[20] D. Jost, U. Maurer, and M. Mularczyk. Efficient ratcheting: Almost-optimal guar-
antees for secure messaging. In Y. Ishai and V. Rijmen, editors, EUROCRYPT 2019,
Part I, volume 11476 of LNCS, pages 159â€“188. Springer, Heidelberg, May 2019.
[21] Y. Kim, A. Perrig, and G. Tsudik. Group key agreement efficient in communication.
IEEE Trans. Computers, 53(7):905â€“921, 2004.
[22] H. Krawczyk. Cryptographic extraction and key derivation: The HKDF scheme.
In T. Rabin, editor, CRYPTO 2010, volume 6223 of LNCS, pages 631â€“648. Springer,
Heidelberg, Aug. 2010.
[23] Matthew A. Weidner. Group Messaging for Secure Asynchronous Collaboration.
Dissertation, 2019. https://mattweidner.com/acs-dissertation.pdf.
[30] C. K. Wong, M. Gouda, and S. S. Lam. Secure group communications using key
graphs. IEEE/ACM Transactions on Networking, 8(1):16â€“30, Feb. 2000.
Masterâ€™s thesis, University of Cambridge, June 2019.
[24] S. Mittra. Iolus: A framework for scalable secure multicasting. In Proceedings of
ACM SIGCOMM, pages 277â€“288, Cannes, France, Sept. 14â€“18, 1997.
[25] S. Panjwani. Tackling adaptive corruptions in multicast encryption protocols.
In S. P. Vadhan, editor, TCC 2007, volume 4392 of LNCS, pages 21â€“40. Springer,