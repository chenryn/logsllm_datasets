tion 5.5). For instance, ASes can allow paths that deviate from
the valley-freeness policy to increase the anonymity set size of end
hosts. This enables a trade-off between path length and anonymity,
as described by Sankey and Wright [44].
In addition, upper-layer anonymity protocols can be used in con-
junction with HORNET to provide stronger anonymity guarantees.
For example, to entirely remove the concerns of topology-based at-
tacks, a single-hop proxy or virtual private network (VPN) could be
used to increase the size of the anonymity sets of end hosts. Similar
solutions could also protect against upper-layer de-anonymization
attacks, in particular ﬁngerprinting attacks on the transport proto-
col [46].
At lower layers, HORNET is also compatible with link-layer
protection such as link-level encryption. The role of link-level en-
cryption in HORNET is comparable to SSL/TLS in Tor. Link en-
cryption prevents an adversary eavesdropping on a link from being
able to distinguish individual sessions from each other, therefore
making conﬁrmation attacks much harder for this type of adver-
sary.
7.3 Limitations
Targeted conﬁrmation attacks. When for a certain session an
adversary controls both the node closest to the source and the node
closest to the destination (or the destination itself), it can launch
conﬁrmation attacks by analyzing ﬂow dynamics.These attacks can
be made more effective by replaying packets.
HORNET, like other low-latency onion routing schemes [25],
cannot prevent such conﬁrmation attacks targeting a small number
of speciﬁc users [45, 33]. However, HORNET raises the bar of
deploying such attacks at scale: the adversary must be capable of
468101214NumberofAShops0123456Goodput[Gbps]IPLAPDovetailTorHORNET468101214NumberofAShops2345678910Goodput[Gbps]IPLAPDovetailTorHORNET1452controlling a signiﬁcant percentage of ISPs often residing in multi-
ple geopolitical areas. In addition, the packet obfuscation measures
built into HORNET (discussed in Section 5) make it non-trivial
to link two ﬂows, since it is not possible to simply match packets
through bit patterns. Timing intervals for packet sequences need
to be stored and compared, thus performing such operations for a
large fraction of the observed ﬂows is expensive. Furthermore, it
is difﬁcult for attackers to perform active attacks (e.g., packet re-
play) at scale while remaining undetected. For instance, a down-
stream benign AS can detect replayed packets by a compromised
upstream AS; end hosts can also detect and report packet tagging
attacks when (a threshold number of) end-to-end MACs do not suc-
cessfully verify.
Perfect forward secrecy. A drawback of HORNET’s efﬁciency-
driven design is that it does not provide perfect forward secrecy for
the link between communicating parties. This means that an adver-
sary could record the observed trafﬁc (the setup phases, in partic-
ular), and if it later compromises a node, it learns which node was
next on the path for each recorded session. This is an unavoidable
limitation of having a setup that consists of a single round-trip.
Other systems (e.g., Tor) use a telescopic setup9, which achieves
perfect forward secrecy at the cost of diminished performance (in
particular higher latency, and also an additional asymmetric crypto-
graphic operation per node). Using a telescopic setup is also possi-
ble for HORNET, but in addition to the performance cost it also re-
quires that all paths be reversible. However, this requirement does
not hold in today’s Internet, where a signiﬁcant fraction of AS-level
paths are asymmetric [31].
It is important to note that in HORNET it is still possible to
achieve perfect forward secrecy for the contents of the communica-
tion, i.e., for the data exchanged between sources and destinations.
The destination needs to generate an ephemeral Difﬁe-Hellman key
pair, and derive an additional shared key from it.10 Destinations
also need to generate a new local secret SV frequently, so in the
event of a destination being compromised it is not possible for the
adversary to decrypt FSes used in expired sessions.
8. RELATED WORK
Anonymity systems as overlays. The study of anonymous com-
munication began with Chaum’s proposal for mix networks [18].
A number of message-based mix systems have been proposed and
deployed since [30, 38, 21, 22]. These systems can withstand an
active adversary and a large fraction of compromised relays, but
rely on expensive asymmetric primitives, and message batching
and mixing. Thus, they suffer from large computational overhead
and high latency.
Onion routing systems [43, 14, 15, 25] were proposed to efﬁ-
ciently support interactive trafﬁc.
In general, low-latency onion
routing systems are vulnerable to end-to-end conﬁrmation at-
tacks [34], and may fail to provide relationship anonymity when
two routers on the path are compromised [29, 33]. HORNET shares
these limitations.
One speciﬁc onion routing system, Tor, has a number of security
advantages over HORNET. Tor can prevent replays and has perfect
forward secrecy for its sessions. Additionally, due to its overlay
9In the telescopic setup, a source iteratively sets up a shared key
with each AS: the source sets up a shared key with the ﬁrst-hop
AS; the source sets up a shared key with the nth-hop AS through
the channel through 1st-hop AS to (n− 1)th-hop AS.
10This feature, though omitted in Section 4 for simplicity, is part of
our implementation. It is done in such a way that the forward se-
cret shared key is included in the destination’s FS during the setup,
without any additional packet being required.
design which uses global redirection, Tor is not constrained by the
underlying network topology. However, global redirection enables
the attack vector that allows even single compromised ASes to per-
form conﬁrmation attacks [40, 13], as one AS can be traversed mul-
tiple times. This attack is not possible in HORNET since packets
traverse each AS on the path only once.
In addition, HORNET’s performance also distinguishes it from
all existing schemes based on overlay networks: ﬁrst, HORNET
can directly use short paths provided by underlying network ar-
chitectures, reducing propagation latency; second, HORNET re-
quires only a single round trip to establish a session, reducing the
setup delay; third, HORNET eliminates the processing and queu-
ing delays both on relay nodes and in the kernel’s network stack;
ﬁnally, edge routers in HORNET offer higher throughput compared
to voluntarily-contributed end hosts, increasing the total throughput
of anonymous trafﬁc.
Anonymity systems in FIAs. Hsiao et al. [32] explored the de-
sign space of efﬁcient anonymous systems with a relaxed adversary
model. In their scheme, LAP, the adversary can compromise only
a single node, and the ﬁrst hop must always be honest. Sankey
and Wright proposed Dovetail [44] (based on Pathlets [28] and
SCION [51, 12]) which has the same attacker model as LAP, ex-
cept it allows the ﬁrst hop to be compromised. Moreover, neither
LAP nor Dovetail can support asymmetric paths where packets tra-
verse different sets of nodes in different directions. HORNET of-
fers three improvements over LAP and Dovetail: 1) HORNET fully
hides path information, i.e., total path length and nodes’ positions,
in packet headers; 2) HORNET protects and obfuscates packet con-
tents by onion-encryption/decryption, thwarting correlating pack-
ets of the same ﬂow by selectors; 3) HORNET supports asymmet-
ric paths and allows the ﬁrst hop ASes to be compromised. Though
HORNET introduces additional overhead in comparison with LAP
and Dovetail, our evaluation results show that HORNET can still
support high-speed packet forwarding at nearly 80% of line rate.
The research community has also explored applying onion rout-
ing to FIAs. Liu et al. [35] proposed Tor instead of IP as an FIA
that regards anonymity as the principal requirement for the network
architecture. However, details on how to scale Tor’s current design
(requiring per-circuit state) to Internet scale were not addressed.
DiBenedetto et al. [24] proposed ANDaNA, to enable onion rout-
ing in Named Data Networking (NDN) [50]. NDN focuses on con-
tent delivery and thus inherently different from the FIAs we con-
sidered.
9. CONCLUSION
In this paper, we address the question of “what minimal mecha-
nism can we use to frustrate pervasive surveillance?” and study the
design of a high-speed anonymity system supported by the network
architecture. We propose HORNET, a scalable and high-speed
onion routing scheme for future Internet architectures. HORNET
nodes can process anonymous trafﬁc at over 93 Gb/s and require
no per-ﬂow state, paving the path for Internet-scale anonymity. Our
experiments show that small trade-offs in packet header size greatly
beneﬁt security, while retaining high performance.
10. ACKNOWLEDGMENTS
We would like to thank our shepherd Prateek Mittal, and the
anonymous CCS reviewers for their suggestions for improving the
paper. We also grateful for insightful discussions with Ian Gold-
berg and the members of the ETH Zürich Network Security group
for their discussions and feedback.
The research leading to these results received funding from the
European Research Council under the European Union’s Seventh
1453Framework Programme (FP7/2007-2013) / ERC grant agreement
617605. George Danezis is supported by the EU H2020 Project
PANORAMIX (653497) and EPSRC Project on “Strengthening an-
onymity in messaging systems” (EP/M013286/1). We also grate-
fully acknowledge support by ETH Zürich, and by Intel for their
equipment donation that enabled the high-performance experiments.
11. REFERENCES
[1] Cisco ASR-1000.
http://www.cisco.com/c/en/us/products/routers/.
Retrieved on 2015.04.28.
[2] Cisco routers.
http://www.cisco.com/c/en/us/products/routers. Retrieved
on 2015.08.05.
[3] curve25519-donna.
https://code.google.com/p/curve25519-donna/. Retrieved
on 2014.12.13.
[4] DPDK: Data plane development kit. http://dpdk.org/. Retrieved
on 2014.12.23.
[5] Intel AESNI sample library. https://software.intel.com/en-
us/articles/download-the-intel-aesni-sample-library.
Retrieved on 2014.12.13.
[6] iPlane dataset.
http://iplane.cs.washington.edu/data/data.html.
Traceroute data was generated on October 12, 2014.
[7] NSA targets the privacy-conscious.
http://daserste.ndr.de/panorama/aktuell/NSA-targets-
the-privacy-conscious,nsa230.html. Retrieved on
2015.05.13.
[8] PolarSSL. https://polarssl.org/. Retrieved on 2014.12.13.
[9] Segment routing architecture (IETF draft).
https://datatracker.ietf.org/doc/draft-ietf-spring-
segment-routing/. Retrieved on 2015.05.13.
[10] Spirent TestCenter. http://www.spirent.com/
Ethernet_Testing/Software/TestCenter. Retrieved on
2014.12.23.
[11] Tor metrics. https://metrics.torproject.org. Retrieved on
2015.05.13.
[12] David Barrera, Raphael M. Reischuk, Pawel Szalachowski, and
Adrian Perrig. SCION Five Years Later: Revisiting Scalability,
Control, and Isolation on Next-Generation Networks.
arXiv/1508.01651, August 2015.
[13] Kevin Bauer, Damon McCoy, Dirk Grunwald, Tadayoshi Kohno, and
Douglas Sicker. Low-resource routing attacks against tor. In ACM
WPES, 2007.
[14] Philippe Boucher, Adam Shostack, and Ian Goldberg. Freedom
systems 2.0 architecture, 2000. White paper, Zero Knowledge
Systems, Inc.
[15] Zach Brown. Cebolla: Pragmatic IP anonymity. In Ottawa Linux
Symposium, 2002.
[16] R. Bush and R. Austein. The resource public key infrastructure
(RPKI) to router protocol. IETF RFC 6810.
[17] Jan Camenisch and Anna Lysyanskaya. A formal treatment of onion
routing. In CRYPTO, 2005.
[18] David L. Chaum. Untraceable electronic mail, return addresses, and
digital pseudonyms. Communications of the ACM, 24(2), 1981.
[19] Chen Chen, Daniele Enrico Asoni, David Barrera, George Danezis,
and Adrian Perrig. HORNET: High-speed Onion Routing at the
Network Layer. arXiv/1507.05724, July 2015.
[20] Benny Chor, Oded Goldreich, Eyal Kushilevitz, and Madhu Sudan.
Private information retrieval. Journal of the ACM, 45(6), 1998.
[21] George Danezis, Roger Dingledine, and Nick Mathewson.
Mixminion: Design of a type III anonymous remailer protocol. In
IEEE S&P, 2003.
[22] George Danezis and Ian Goldberg. Sphinx: A compact and provably
secure mix format. In IEEE S&P, 2009.
[23] Drew Dean and Adam Stubbleﬁeld. Using client puzzles to protect
TLS. In USENIX Security, 2001.
[24] Steven DiBenedetto, Paolo Gasti, Gene Tsudik, and Ersin Uzun.
ANDaNA : Anonymous named data networking application. In
NDSS, 2011.
[25] Roger Dingledine, Nick Mathewson, and Paul Syverson. Tor: The
second-generation onion router. In USENIX Security, 2004.
[26] S. Farrell and H. Tschofenig. Pervasive monitoring is an attack. IETF
RFC 7258.
[27] Michael J. Freedman, Kobbi Nissim, and Benny Pinkas. Efﬁcient
private matching and set intersection. In EUROCRYPT, 2004.
[28] P. Brighten Godfrey, Igor Ganichev, Scott Shenker, and Ion Stoica.
Pathlet routing. ACM SIGCOMM, 2009.
[29] David M. Goldschlag, Michael G. Reed, and Paul F. Syverson.
Hiding routing information. In ACM Information Hiding (IH)
Conference, 1996.
[30] Ceki Gülcü and Gene Tsudik. Mixing email with Babel. In NDSS,
1996.
[31] Yihua He, Michalis Faloutsos, Srikanth Krishnamurthy, and Bradley
Huffaker. On routing asymmetry in the Internet. In IEEE
GLOBECOM, 2005.
[32] Hsu Chun Hsiao, Tiffany Hyun Jin Kim, Adrian Perrig, Akira
Yamada, Samuel C. Nelson, Marco Gruteser, and Wei Meng. LAP:
Lightweight anonymity and privacy. In IEEE S&P, 2012.
[33] Aaron Johnson, Chris Wacek, Rob Jansen, Micah Sherr, and Paul F.
Syverson. Users get routed: trafﬁc correlation on Tor by realistic
adversaries. In ACM CCS, 2013.
[34] Brian N. Levine, Michael K. Reiter, Chenxi Wang, and Matthew K.
Wright. Timing attacks in low-latency mix-based systems. In FC,
2004.
[35] Vincent Liu, Seungyeop Han, Arvind Krishnamurthy, and Thomas
Anderson. Tor instead of IP. In ACM HotNets, 2011.
[36] P. Mahadevan, D. Krioukov, M. Fomenkov, B. Huffaker,
X. Dimitropoulos, K. Claffy, and A. Vahdat. The Internet AS-level
topology: Three data sources and one deﬁnitive metric. In ACM
SIGCOMM, 2006.
[37] Prateek Mittal, Femi Olumoﬁn, Carmela Troncoso, Nikita Borisov,
and Ian Goldberg. PIR-Tor: Scalable anonymous communication
using private information retrieval. In USENIX Security, 2011.
[38] Ulf Möller, Lance Cottrell, Peter Palfrader, and Len Sassaman.
Mixmaster protocol v. 2. IETF Draft, 2003.
[39] R. Moskowitz and P. Nikander. Host identity protocol (HIP)
architecture. IETF RFC 4423.
[40] Steven J. Murdoch and Piotr Zieli´nski. Sampled trafﬁc analysis by
Internet-Exchange-level adversaries. In PETS, 2007.
[41] Andreas Pﬁtzmann and Marit Köhntopp. Anonymity,
unobservability, and pseudonymity - a proposal for terminology. In
Designing Privacy Enhancing Technologies, 2001.
[42] Jean-François Raymond. Trafﬁc analysis: Protocols, attacks, design
issues, and open problems. In Designing Privacy Enhancing
Technologies, 2001.
[43] Michael G. Reed, Paul F. Syverson, and M. Goldschlag David.
Anonymous connections and onion routing. IEEE JSAC, 1998.
[44] Jody Sankey and Matthew Wright. Dovetail: Stronger anonymity in
next-generation internet routing. In PETS, 2014.
[45] Andrei Serjantov and Peter Sewell. Passive attack analysis for
connection-based anonymity systems. In ESORICS, 2003.
[46] Matthew Smart, G. Robert Malan, and Farnam Jahanian. Defeating
TCP/IP stack ﬁngerprinting. In USENIX Security, 2000.
[47] Wei Wang, Mehul Motani, and Vikram Srinivasan. Dependent link
padding algorithms for low latency anonymity systems. In ACM
CCS, 2008.
[48] Xiaowei Yang, David Clark, and Arthur W Berger. NIRA: a new
inter-domain routing architecture. IEEE/ACM Transactions on
Networking, 2007.
[49] Bassam Zantout and Ramzi Haraty. I2P data communication system.
In ICN, 2011.
[50] Lixia Zhang, Alexander Afanasyev, Jeffrey Burke, Van Jacobson,
Kimberley Claffy, Patrick Crowley, Christos Papadopoulos, Lan
Wang, and Beichuan Zhang. Named data networking. In ACM
SIGCOMM, 2014.
[51] Xin Zhang, Hsu-Chun Hsiao, Geoffrey Hasker, Haowen Chan,
Adrian Perrig, and David G. Andersen. SCION: Scalability, control,
and isolation on next-generation networks. In IEEE S&P, 2011.
1454