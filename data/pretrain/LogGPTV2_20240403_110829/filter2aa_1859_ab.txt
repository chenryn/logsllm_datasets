Payload Testing
Payload Design
Payload 
Developement
Payload Testing
Payload Design
STARE
@
 BINARY 
BLOB
Payload 
Developement
Payload Testing
Payload Design
STARE
@
 BINARY 
BLOB
THIS PART 
 L	
7.27.2012	
frak.redballoonsecurity.com	
PI:EMAIL	
Payload Design
Payload 
Developement
Payload Design
Payload 
Developement
Payload Testing
Payload Design
Payload 
Developement
Payload Testing
Payload Design
STARE
@
 BINARY 
BLOB
7.27.2012	
frak.redballoonsecurity.com	
This part 
Is  
IMPORTANT 
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
[Better Living Through Software Engineering] 
7.27.2012	
frak.redballoonsecurity.com	
PI:EMAIL	
Payload Design
Payload 
Developement
Payload Design
Payload 
Developement
Payload Testing
Payload Design
Payload 
Developement
Payload Testing
Payload Design
STARE
@
 BINARY 
BLOB
Payload 
Developement
Payload Testing
Payload Design
STARE
@
 BINARY 
BLOB
THIS PART 
 L	
7.27.2012	
frak.redballoonsecurity.com	
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
UNPACKING
ENGINE
REPACKING
ENGINE
PI:EMAIL	
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
UNPACKING
ENGINE
REPACKING
ENGINE
UNPACKING
ENGINE
REPACKING
ENGINE
HP-RFU
Module
Cisco IOS
Module
Cisco-CNU
Module
XYZ-Format
Module
HP-RFU
Module
Cisco IOS
Module
Cisco-CNU
Module
XYZ-Format
Module
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Agnostic
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Agnostic
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
Device/Vendor Agnostic
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Agnostic
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
Device/Vendor Agnostic
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Agnostic
Cisco IOS
Module
F  R  A  K 
irmware
everse
nalysis
onsole
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Agnostic
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
Device/Vendor Agnostic
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
Device/Vendor Agnostic
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Agnostic
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
Device/Vendor Agnostic
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
Device/Vendor Agnostic
Device/Vendor Dependent
Analysis
Engine  
Modification
Engine  
UNPACKING
ENGINE
REPACKING
ENGINE
Device/Vendor Agnostic
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
F  R  A  K 
irmware
everse
nalysis
onsole
[Better Living Through Software Integration] 
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
F  R  A  K 
irmware
everse
nalysis
onsole
[Better Living Through Software Integration] 
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
F  R  A  K 
irmware
everse
nalysis
onsole
[Better Living Through Software Integration] 
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
F  R  A  K 
irmware
everse
nalysis
onsole
[Better Living Through Software Integration] 
More integration 
on the way 
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
F  R  A  K 
irmware
everse
nalysis
onsole
7.27.2012	
frak.redballoonsecurity.com	
PI:EMAIL	
F  R  A  K 
irmware
everse
nalysis
onsole
Unpack, Analyze, Modify, Repack: Cisco IOS 
7.27.2012	
frak.redballoonsecurity.com	
PI:EMAIL	
Payload 
Developement
Payload Testing
Payload Design
STARE
@
 BINARY 
BLOB
7.27.2012	
frak.redballoonsecurity.com	
Without FRAK! 
PI:EMAIL	
With FRAK! 
7.27.2012	
frak.redballoonsecurity.com	
Payload 
Developement
Payload Testing
Payload Design
STARE @ BINARY 
BLOB
PI:EMAIL	
E N O U G H  T A L K 
D E M O  
T I M E 
7.27.2012	
frak.redballoonsecurity.com	
• 
Packer/Repacker for Cisco IOS, HP-RFU 
• 
Automagic Binary Analysis 
• 
IDA-Pro Integration 
• 
Entropy-related Analysis 
• 
Automated IOS/RFU Rootkit Injection 
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
Entropy	
  map	
  of	
  ﬁrmware	
image.	
White:	
  high	
  entropy	
  data	
Black:	
  low	
  entropy	
  data	
Small	
  low	
  random	
  header	
and	
  footer.	
Large	
  amount	
  of	
  random	
data.	
Hmm!	
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
Entropy	
  map	
  of	
  header.	
Look	
  familiar?	
Let’s	
  unpack	
  the	
  middle	
pkzip	
  record.	
cmd:	
  unpack	
  /1	
  generic-­‐unzip	
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
Entropy	
  map	
  of	
unzipped	
  record.	
Does	
  the	
  structure	
look	
  familiar?	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
I wonder what the johnface 
file contained. Hrm… 
Let’s fire up dynamips and 
find out. 
7.27.2012	
frak.redballoonsecurity.com	
7.27.2012	
frak.redballoonsecurity.com	
-­‐)	
PI:EMAIL	
Frak unpacking A HP-RFU Image 
7.27.2012	
frak.redballoonsecurity.com	
FRAK is still WIP. For Early Access 
Contact 
PI:EMAIL 
7.27.2012	
frak.redballoonsecurity.com	
PI:EMAIL	
7.27.2012	
frak.redballoonsecurity.com	
FRAK Page: http://frak.redballoonsecurity.com 
PI:EMAIL	
FRAK is still WIP. For Early Access 
Contact 
PI:EMAIL 
7.27.2012	
frak.redballoonsecurity.com	
FRAK Page: http://frak.redballoonsecurity.com 
Thank you DARPA Cyber Fast Track! 
PI:EMAIL	
FRAK is still WIP. For Early Access 
Contact 
PI:EMAIL 
7.27.2012	
frak.redballoonsecurity.com	
{ Ang Cui | PI:EMAIL } 
www.redballoonsecurity.com