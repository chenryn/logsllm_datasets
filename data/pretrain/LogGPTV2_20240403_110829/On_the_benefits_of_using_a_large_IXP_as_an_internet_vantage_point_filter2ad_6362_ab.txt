10.1%
1.0%
67.3%
52.9%
17.2%
2.2%
82.6%
g
n
i
r
e
e
P
c
Ô¨Å
f
a
r
T
r
e
v
r
e
S
c
Ô¨Å
f
a
r
T
IPs
PreÔ¨Åxes
ASes
TrafÔ¨Åc
IPs
PreÔ¨Åxes
ASes
TrafÔ¨Åc
Table 3: IXP as local yet global player‚Äîweek 45
others in the sense that they are responsible for more trafÔ¨Åc that is
exchanged over the public switching fabric of the IXP. In particu-
lar, we would like to know whether the importance of the local role
that this IXP plays for the larger geographic region within which it
is situated is more or less recovered when considering the peering
or server-related trafÔ¨Åc that the IPs or server IPs are responsible
for, respectively. To this end, we show in Table 2 the top-10 coun-
tries in terms of percentage of IP addresses (and associated trafÔ¨Åc)
and percentage of server IPs (and associated trafÔ¨Åc). In addition,
we show the top-10 networks. While the role of the IXP for the
European region becomes more dominant when we change from
peering to server-related trafÔ¨Åc, there are still prominent signs of
the IXP‚Äôs global role, even with respect to the commercial Internet,
and they reÔ¨Çect the relative importance of this IXP for countries
such as USA, Russia, and China or ASes such as 20940 (Akamai),
15169 (Google), and 47541 (VKontakte).
For a somewhat simpliÔ¨Åed illustration of the IXP‚Äôs dual role as a
local as well as global player, we divide the set of all actively routed
ASes into three disjoint sets, A(L), A(M ), and A(G). A(L) con-
sists of the member ASes of the IXP; A(M ) consists of all ASes
that are distance 1 (measured in AS-hops) from a member AS; and
A(G) is the complement of A(L) ‚à™ A(M ) and contains those
ASes that are distance 2 or more from the member ASes.
Intu-
itively, the set A(L) captures the importance of the local role of the
IXP, whereas the set A(G) is more a reÔ¨Çection of the IXP‚Äôs global
role, with A(M) covering some middle ground. Table 3 shows the
breakdown of the IPs, preÔ¨Åxes, and ASes for peering trafÔ¨Åc and
Web server-related trafÔ¨Åc, respectively, for the three sets. It basi-
cally conÔ¨Årms our above observation that there is a general trend
towards the set A(L) as we move from IPs and the peering trafÔ¨Åc
they are responsible for to server IPs and their trafÔ¨Åc. Note, while
the relative importance of the IXP‚Äôs local role over its global role
with respect to the commercial Internet (i.e., server-related trafÔ¨Åc)
makes economic sense and is well-captured by this cartoon pic-
ture, in reality, there is potentially signiÔ¨Åcant overlap between the
sets A(L), A(M ), and A(G), e. g., due to remote peerings, IXP
resellers, and non-European networks joining the IXP for purely
economic reasons. But this is unlikely to invalidate our basic Ô¨Ånd-
ings concerning the IXP‚Äôs dual role.
3.3 On the IXP‚Äôs ‚Äúblind spots‚Äù
While the IXP ‚Äúsees‚Äù trafÔ¨Åc from much of the Internet, taking
measurements exclusively at this single vantage point can tell us
only so much about the network as a whole or its individual con-
stituents. Hence, knowing what we can discern about the network
with what sort of accuracy is as important as understanding what
we cannot discern about it, and why.
We show in Section 3.1 how the use of an essentially orthogonal
IXP-external dataset (i. e., the HTTP and DNS logs from the large
European Tier-1 ISP) enables us to indirectly assess how the ap-
proximately 1.5M server IPs seen at the IXP in a given week com-
pare to the unknown number of server IPs network-wide. In the
following, we discuss additional examples where the use of IXP-
external data, either in the form publicly available measurements,
active or passive measurements, or proprietary information, enables
us to check, validate, or reÔ¨Åne what we can say with certainty when
relying solely on IXP measurements.
To examine in more detail how the approximately 1.5M server
IPs seen at the IXP in a given week compare to all server IPs in the
Internet, we now use a more extensive combination of IXP-external
measurements. To start, using the list of the top-1M Web sites avail-
able from www.alexa.com and based on the URIs retrieved from
the limited payload part of the sampled frames at the IXP, we re-
cover about 20% of all the second-level domains on Alexa‚Äôs top-1M
list of sites; this percentage increases to 63% if we consider only the
top-10K list and to 80% for the top-1K. Note that many hostnames
on these lists are dynamic and/or ephemeral. Next, to assess how
many additional server IPs we can identify using the approximately
80% of domains we cannot recover using the URIs seen at the IXP,
we rely on active measurements in the form of DNS queries to those
uncovered domains using our set of 25K DNS resolvers across 12K
ASes (see Section 2.3). From this pool of resolvers, we assign 100
randomly-selected resolvers to each URI. This results in approxi-
mately 600K server IPs, of which more then 360K are already seen
at the IXP and identiÔ¨Åed as servers.
To provide insight into the remaining 240K server IPs that are
not seen as a server at the IXP, we classify them into four distinct
categories. First, there are servers of CDNs that are hosted inside
an AS and serve exclusively clients in that AS (‚Äúprivate clusters‚Äù).
These servers reply only to resolvers of that AS for content that is
delivered by the global footprint of those CDNs. TrafÔ¨Åc to these
servers should not be observable at the IXP as it should stay inter-
nal to the AS. Second, there are servers of CDNs or cloud/hosting
providers that are located geographically far away from the IXP. If
338these networks have a global footprint and distribute content in a
region-aware manner, it is unlikely that these server IPs are seen
at the IXP. The third group includes servers that some ASes oper-
ate for the sole purpose of handling invalid URIs. Finally, the last
category contains those servers of small organizations and/or uni-
versities in parts of the world that are geographically far away from
the IXP. These IPs are typically not visible at the IXP. In terms of
importance, the Ô¨Årst two categories account for more than 40% of
the 240K servers not seen at the IXP.
For a concrete example for illustrating ‚Äúwhat we know we don‚Äôt
know‚Äù, we consider Akamai. In our week-long IXP dataset, we
observe some 28K server IPs for Akamai in 278 ASes (for details,
see Section 5). However, Akamai publicly states that it operates
some 100K servers in more than 1K ASes [15]. The reasons why
we cannot see this ground truth relying solely on our IXP-internal
data are twofold and mentioned above. First Akamai is known to
operate ‚Äúprivate clusters‚Äù in many third-party networks which are
generally not visible outside those ASes and therefore cannot be
detected at the IXP. Second, we cannot expect to uncover Akamai‚Äôs
footprint in regions that are geographically far away from the IXP,
mainly because Akamai uses sophisticated mechanisms to localize
trafÔ¨Åc [42, 46]. Akamai‚Äôs large footprint makes discovering all of
its servers difÔ¨Åcult, but by performing our own diligently chosen
IXP-external active measurements [39] that utilize the URIs col-
lected in the IXP and the open resolvers discussed in Section 2.3,
we were able to discover about 100K servers in 700 ASes. Thus,
even for a challenging case like Akamai, knowing what our IXP-
internal data can and cannot tell us about its many servers and un-
derstanding the underlying reasons is feasible.
Regarding our assumption that server-related trafÔ¨Åc is a good
proxy for the commercial portion of Internet trafÔ¨Åc, there are clearly
components of this commercial trafÔ¨Åc that are not visible at the IXP.
For example, the recently introduced hybrid CDNs (e. g., Akamai‚Äôs
NetSession [12]) serve content by servers as well as by end users
that have already downloaded part of the content. Since the con-
nections between users are not based on a HTTP/HTTPS server-
client architecture but are P2P-based, we may not see them at the
IXP. However, while the trafÔ¨Åc of these hybrid CDNs is increas-
ing (e. g., the service is mainly used for large Ô¨Åles such as software
downloads), the overall volume is still very low [31].
Lastly, by the very deÔ¨Ånition of an IXP, any trafÔ¨Åc that does not
pass through the IXP via its public-facing switching infrastructure
remains entirely invisible to us. For example, this includes all traf-
Ô¨Åc that traverses the IXP over private peering links. IXPs keep the
private peering infrastructure separate from its public peering plat-
form, and we are not aware of any kind of estimates of the amount
of private peering trafÔ¨Åc handled by the IXPs.
Summary: By analyzing in detail the trafÔ¨Åc that traverses the phys-
ical infrastructure of one of the largest IXPs in Europe, we provide
evidence that the large European IXPs such as AMS-IX, DE-CIX,
and LINX represent global Internet vantage points that ‚Äúsee‚Äù week-
in and week-out trafÔ¨Åc from hundreds of millions of IPs, from al-
most all routed preÔ¨Åxes and from all routed ASes, and from es-
sentially every country around the world. We also illustrate these
IXPs‚Äô dual role as a global and a local player within the Internet‚Äôs
ecosystem and caution that despite their outstanding visibility into
the Internet, their use as global Internet vantage points comes with
caveats (e. g., having ‚Äúblind spots‚Äù).
4. STABLE YET CHANGING
In this section, we report on a longitudinal analysis that covers
17 consecutive weeks and describes what using our large IXP as
a vantage point through time enables us to say about the network
as whole, about some of its constituents, and about the trafÔ¨Åc that
these constituents are responsible for.
4.1 Stability in the face of constant growth
Publicly available data shows that during 2012, this IXP has ex-
perienced signiÔ¨Åcant growth, increasing the number of member
ASes by 75 and seeing the average daily trafÔ¨Åc volume grow by
0.1%. In terms of absolute numbers, we see in week 35 a total of
443 IXP member ASes sending an average daily trafÔ¨Åc volume of
11.9 PB over the IXP‚Äôs public-facing switching infrastructure. By
week 51, the member count stood at 457, and the average trafÔ¨Åc
volume went up to 14.5 PB/day. For what follows, it is impor-
tant to note that these newly added member ASes are typically re-
gional and local ISPs or organizations and small companies outside
of central Europe for which membership at this IXP makes eco-
nomic sense. To contrast, all the major content providers, CDNs,
Web hosting companies, eyeball ASes, and Tier-1 ISPs have been
members at this IXP for some time, but may have seen upgrades to
higher port speeds since the time they joined.
Given our interest in the commercial Internet and knowing (see
Section 2) that the server-related trafÔ¨Åc is more than 70% of the
peering trafÔ¨Åc seen at the IXP, we focus in the rest of this paper
on the server-related portion of the IXP trafÔ¨Åc. The initial set of
Ô¨Åndings from our longitudinal analysis paints an intriguingly stable
picture of the commercial Internet as seen from our vantage point.
In particular, analyzing in detail each of the 17 weekly snapshots
shows that during every week, we see server-related trafÔ¨Åc at this
IXP from about 20K (i. e., about half of all) actively routed ASes,
some 75K or approximately 15% of all actively routed preÔ¨Åxes,
and from a pool of server IPs whose absolute size changes only so
slightly but tends to increase in the long term.
This last property is illustrated in Figure 4(a) when focusing only
on the absolute heights of the different bars that represent the to-
tal number of server IPs seen in a given week. When considering
the full version of this Ô¨Ågure, including the within-bar details, Fig-
ure 4(a) visualizes the weekly churn that is inherent in the server
IPs seen at the IXPs. To explain, the Ô¨Årst bar in Figure 4(a) shows
the approximately 1.4M unique server IPs that we see in week 35.
The next bar shows that same quantity for week 36, but splits it
into two pieces. While the lower (white) piece reÔ¨Çects the portion
of all week 36 server IPs that were already seen during week 35,
the upper (black) piece represents the set of server IPs that were
seen for the Ô¨Årst time during week 36. Starting with week 37, we
show for each week n ‚àà {37, 38, . . . ,51} snapshot a bar that has
three pieces stacked on top of one another. While the Ô¨Årst (bottom,
white) piece represents the server IPs that were seen at the IXP in
each one of the week k snapshot (k = 35, 36, . . . , n), the second
(grey-shaded) piece shows the server IPs that were seen at the IXP
in at least one previous week k snapshot (k = 35, 36, . . . , n ‚àí 1),
but not in all; the third (top black) piece represents all server IPs
that were seen at the IXP for the Ô¨Årst time in week n.
A key take-away from Figure 4(a) is that there is a sizable pool
of server IPs that is seen at the IXP during each and every week
throughout the 17-week long measurement period. In fact, this sta-
ble portion of server IPs that is seen at the IXP week-in and week-
out is about 30% as can be seen by looking at the bottom (white)
portion of the week 51 bar. Instead of requiring for a server IP to
be seen in each and every week, we also consider a more relaxed
notion of stability called recurrence. This recurrent pool of server
IPs consists of all server IPs that, by week 51, have been seen at the
IXP during at least one previous week (but not in each and every
previous week), is represented by the grey-shaded portion of the
week 51 bar, and consists of about 60% of all server IPs seen in
339





 
 

 

	 




















 
 
 














 


 


 


 


 
	

        
        
(a) Churn of server IPs


























































































(b) Churn of server IPs per region




 
 
























 
	 

 

        
        
(c) Churn of ASes with servers
Figure 4: Churn of server IPs and ASes that host servers‚Äî
weeks 35-51
week 51. Note that the number of server IPs seen for the Ô¨Årst time
in week n (top black portion) decreases over time and makes up
just about 10% of all server IPs seen in week 51.
To look in more detail at the stable and recurrent pools of server
IPs and examine their churn or evolution during the 17-week long
measurement period, we rely on the GeoLite Country database [44]
to geo-locate the server IPs to the country level and group them by
geographic ‚Äúregion‚Äù as follows: DE, US, RU, CN, RoW (rest of
world). Figure 4(b) is similar to Figure 4(a), but shows for each
week the portions of IPs for each of these Ô¨Åve regions and visu-
alizes the make-up of these server IPs in the same way as we did
in Figure 4(a). Note that the shown region-speciÔ¨Åc stable portions
in week 51 add up to the 30% number observed in Figure 4(a),
and similarly for the region-speciÔ¨Åc recurrent portions in week 51
(their sum adds up to the roughly 60% portion of the recurrent pool
shown in Figure 4(a)). Interestingly, while the stable pool for DE is
consistently about half of the overall stable pool of server IPs seen
at the IXP, that pool is vanishing small for CN, slightly larger for
RU. This is yet another indication of the important role that this
IXP plays for the European part of the Internet.
An even more intriguing aspect of stability is seen when we con-
sider the server-related trafÔ¨Åc that the server IPs that we see at the
IXP are responsible for. For one, we Ô¨Ånd that the stable pool of
server IPs is consistently contributing more than 60% of the server-
related trafÔ¨Åc. That is, of the server IPs that this IXP ‚Äúsees‚Äù on
a weekly basis, more than 30% of them are not only seen week
after week, but they are also responsible for most of the server-
related trafÔ¨Åc that traverses the IXP each week. When consider-
ing the weekly recurrent pools of server IP (grey-shaded segments
in Figure 4(a)), their trafÔ¨Åc portions keep increasing, but only to
less than 30% of all server trafÔ¨Åc. To examine the make-up of the
server-related trafÔ¨Åc attributed to the stable and recurrent pools of
server IPs, respectively, Figure 5 shows for each week n three bars,
each with Ô¨Åve segments corresponding to the Ô¨Åve regions consid-
ered earlier. The Ô¨Årst bar is for the server-related trafÔ¨Åc portion of
all peering trafÔ¨Åc that all server IPs see at the IXP in week n; the
second bar reÔ¨Çects the server-related trafÔ¨Åc portion in week n at-
tributed to the recurrent pool of server IPs in that week, while the
third bar shows the server-related trafÔ¨Åc portion in week n that the
stable pool of server IPs is responsible for. From Figure 5, we see
that while the stable and recurrent pools of server IPs from China
are basically invisible at the IXP in terms of their trafÔ¨Åc, both US
and Russia have the property that the stable pool of server IPs is
responsible for much all the server-related trafÔ¨Åc seen from those
regions at the IXP.
In addition to examining the churn and evolution of the server IPs
seen at the IXP, it is also instructive to study the temporal behavior
of the subnets and ASes that the encountered server IPs map into.
To illustrate, we only consider the ASes and show in Figure 4(c)
for ASes what we depicted in Figure 4(b) for server IPs. The key
difference between server IPs and ASes is that the stable pool of
ASes represented by the white portion of the week 51 bar is about
70% compared to the 30% for the stable pool of server IPs. Thus,
a majority of ASes with server IPs is seen at the IXP during each
and every week, and the number of ASes that are seen for the Ô¨Årst
time becomes miniscule over time. In summary, the stable pool of
server IPs (about 1/3 of all server IPs seen at the IXP) gives rise to
a stable pool of ASes (about 2/3 of all ASes seen at the IXP and
have server IPs) and is responsible for much of the server-related
trafÔ¨Åc seen at the IXP.
4.2 Changes in face of signiÔ¨Åcant stability
One beneÔ¨Åt of observing a signiÔ¨Åcant amount of stability with
respect to the server-related portion of the overall peering trafÔ¨Åc
seen at the IXP is that any weekly snapshot provides more or less
the same information. At the same time, subsequent weekly snap-
340




























		

	














Figure 5: Churn of server trafÔ¨Åc by region‚Äîweeks 35-51
shots that differ noticeably may be an indication of some change.
Next, we brieÔ¨Çy discuss a few examples of such changes that we
can discern about the Internet as a whole and some of its individual
constituents when we have the luxury to observe and measure the
network at this IXP for a number of consecutive weeks.
The Ô¨Årst example is motivated primarily by our ability described
in Section 2.2.2 to speciÔ¨Åcally look for and identify HTTPS server
IPs, but also by anecdotal evidence or company blogs [21, 22] that
suggest that due to widespread security and privacy concerns, the
use of HTTPS is steadily increasing. To examine this purported
increase, we extract for each weekly snapshot all HTTPS server
IPs and the trafÔ¨Åc that they contribute. When comparing for each
week the number of HTTPS server IPs relative to all server IPs
seen in that week and the weekly trafÔ¨Åc associated with HTTPS
server IPs relative to all peering trafÔ¨Åc, we indeed observe a small,
yet steady increase, which conÔ¨Årms that the Internet landscape is
gradually changing as far as the use of HTTPS is concerned.
For a different kind of example for using our IXP vantage point,
we are interested in tracking the recently announced expansion of
NetÔ¨Çix using Amazon‚Äôs EC2 cloud service [10] into a number of
Scandinavian countries [23]. To this end, we relied on publicly
available data to obtain Amazon EC2‚Äôs data center locations [16]
and the corresponding IP ranges [17]. We then mined our 17 weeks
worth of IXP data and observed for weeks 49, 50, and 51 a pro-
nounced increase in the number of server IPs at Amazon EC2‚Äôs
Ireland location, the only data center of Amazon EC2 in Europe.
This was accompanied by a signiÔ¨Åcant (but still small in absolute
terms) increase in Amazon EC2‚Äôs trafÔ¨Åc. All this suggests that it
may be interesting to watch this trafÔ¨Åc in the future, especially if
the observed changes are in any way related to NetÔ¨Çix becoming
available in Northern Europe towards the end of 2012.
Yet another example concerns the detection of regional or na-
tional events at this IXP. For example, considering in more detail
week 44, which shows up as a clear dip in, say, Figure 4(a), we
notice that this week coincides with Hurricane Sandy that had a
major impact on the US East Coast region. To examine its impact,
we use the IXP vantage point to discern this natural disaster from
trafÔ¨Åc that we see at the IXP from a particular Internet constituent,
a major cloud provider. Using publicly available information about
the cloud platform‚Äôs data centers and corresponding IP ranges, we
look in our data for the corresponding server IPs and Ô¨Ånd a total of
about 14K. A detailed breakdown by data center location for weeks
43-45 shows a drastic reduction in the number of server IPs seen at
the IXP from the US East Coast region, indicating that the platform
of this major cloud provider faced serious problems in week 44,
with trafÔ¨Åc dropping close to zero. These problems made the news,
and the example highlights how a geographical distant event such
as a hurricane can be discerned from trafÔ¨Åc measurements taken at
this geographically distant IXP.
Lastly, we also mention that an IXP is an ideal location to mon-
itor new players such as ‚Äúresellers‚Äù. Resellers are IXP member
ASes, and their main business is to provide and facilitate access
to the IXP for smaller companies that are typically far away geo-
graphically from the IXP. For IXPs, the emergence of resellers is
beneÔ¨Åcial as they extend the reach of the IXP into geographically
distant regions and thereby the potential membership base. For ex-
ample, for a particular reseller at our IXP, we observed a doubling
of the server IPs from 50K to 100K in four months, suggesting that
this reseller has been quite successful in attracting new networks
with signiÔ¨Åcant server-based infrastructures as its customers.
Summary: When concentrating on the Web server-related portion
of the IXP trafÔ¨Åc and performing a longitudinal analysis over a 17-
week long period, we observe signiÔ¨Åcant stability ‚Äì of all the server
IPs for which trafÔ¨Åc is observed at the IXP during this 17-week pe-
riod, some 30% are seen at the IXP week-in and week-out and are
responsible for around 60% of all server-related trafÔ¨Åc in each and
every week. At the same time, the trafÔ¨Åc seen at the IXP does ex-
hibit differences from one week to the next, and we illustrate with
some examples what different types of changes enable us to say
about the network as a whole or some of its individual constituents.
In this sense, the trafÔ¨Åc seen at these global Internet vantage points
can be used as complementary source of information for recent ef-
341forts analyzing Internet events such as large-scale outages due to
censorship [32], natural disasters [29], etc.
5. BEYOND THE AS-LEVEL VIEW
To illustrate the beneÔ¨Åts and new opportunities for Internet mea-
surements that arise from being able to use our IXP as a vantage
point with very good visibility into the Internet, we describe in
this section an approach for identifying server-based network in-
frastructures and classifying them by ownership. In the process,
we report on a clear trend towards more heterogeneous networks
and network interconnections, provide concrete examples, and dis-
cuss why and how this observed network heterogenization requires
moving beyond the traditional AS-level view of the Internet.
5.1 Alternative grouping of server IPs
To this point, we have followed a very traditional approach for
looking at our IXP data in the sense that we measured the IXP‚Äôs
visibility into the Internet in terms of the number of actively routed
ASes or subnets seen at the IXP. However, there exist Internet play-
ers (e. g., CDN77, a recently launched low-cost no-commitment
CDN; Rapidshare, a one-click hosting service; or certain meta-
hosters that utilize multiple hosters) that are not ASes in the sense
that they do not have an assigned ASN. Thus, as far as the tra-
ditional AS-level view of the Internet is concerned, these players
are invisible, and the trafÔ¨Åc that they are responsible for goes un-
noticed, or worse misattributed to other Internet players. Yet, be-
ing commercial entities, these companies actively advertise their
services, and in the process often publish the locations and IP ad-
dresses of their servers. This then suggests an alternative approach
to assessing the IXP‚Äôs ability to ‚Äúsee‚Äù the Internet as a whole‚Äî
group servers according to the organization or company that has
the administrative control over the servers and is responsible for
distributing the content. While this approach is easy and works to
perfection for companies like CDN77 that publish all their server
IPs, the question is what to do if the server IPs are not known.
Accordingly, our primary goal is to start with the server IPs seen
at the IXP and cluster them so that the servers in one and the same
cluster are provably under the administrative control of the same or-
ganization or company. To this end, we rely in parts on methods de-
scribed by Plonka et al. [48] for trafÔ¨Åc and host proÔ¨Åling, Bermudez
et al. [20] for discerning content and services, and Ager et al. [14]
for inferring hosting infrastructures from the content they deliver.
We also take advantage of different sets of meta-data obtained from
assorted active measurement efforts or available by other means as
discussed in Section 2.4. Recall that this meta-data includes for
every server IP seen in the IXP data the corresponding URIs, the
DNS information from active measurements, and, where available,
the list of X.509 certiÔ¨Åcates retrieved via active measurements. In
the rest of this section the reported numbers are for week 45.
The clustering proceeds in three steps. First, we focus on those
server IPs for which we have a SOA resource record and consider
a Ô¨Årst category of clusters that have the property that all server IPs
assigned to a given cluster have the IP and the content managed
by the same authority. We identify those clusters by grouping all
server IPs where the SOA of the hostname and the authority of the
URI lead to the same entry. Prominent organizations that fall into
this Ô¨Årst category are Amazon and big players like Akamai and
Google when they are located in their own ASes or when they are
in third-party ASes but have assigned names to their own servers.
78.7 % of all our server IPs are clustered in this Ô¨Årst step.
In a second step, we consider clusters with the property that for
the server IPs in a given cluster, most of the server IPs and most of
the content are managed by the same authority. This can happen
if the SOA is outsourced (e. g., to a third-party DNS provider) and
is common property among hosters and domains served by virtual
servers. In these cases, to group server IPs, we rely on a majority
vote among the SOA resource records, where the majority vote is
by (i) the number of IPs and (ii) the size of the network footprint.
This heuristic enables us to group some server IPs together with
organizations inferred in the previous step and also applies to meta-
hosters such as Hostica. 17.4 % of all our server IPs are clustered in
this second step. Lastly, for the remaining 3.9 % of server IPs that
have been seen in our IXP data and have not yet been clustered, we
only have partial SOA information. This situation is quite common
for parts of the server infrastructure of some large content providers
and CDNs such as Akamai that have servers deployed deep inside
ISPs. In this case, we apply the same heuristic as in the second
step, but only rely on the available subset of information.
To validate our clustering that results from this three-step pro-
cess, we manually compare the results by (1) checking against the
coverage of the public IP ranges that some organizations advertise
(see Section 4.2), (2) utilizing the information of certiÔ¨Åcates that
point to applications and services, and (3) actively downloading ei-
ther the front page (e. g., in the case of Google, it is always the
search engine front page) or requested content that is delivered by
a CDN (e. g., in the case of Akamai, any content is delivered by any
of its servers [53]). Our method manages to correctly identify and
group the servers of organizations with a small false-positive rate
of less than 3%. Moreover, we observe that the false-positive rate
decreases with increasing size of the network footprint. However,
there are false-negatives in the sense that our methodology misses
some servers due to the ‚Äúblind spots‚Äù discussed in Section 3.3.
5.2 New reality (I): ASes are heterogeneous
Equipped with an approach for grouping server IPs by organiza-
tions, we examine next to what extent this grouping is orthogonal
to the prevailing AS-level view of the Internet. The issues are suc-
cinctly illustrated in Figure 6(a) where we augment the traditional
AS-level view (i. e., a number of different ASes exchanging trafÔ¨Åc
over (public) peering links at an IXP) with new features in the form
of AS-internal details (i. e., the third-party servers that the ASes
host). Note that while the traditional view that makes a tacit ho-
mogeneity assumption by abstracting away any AS-internal details
may have been an adequate model for understanding some aspects
of the Internet and the trafÔ¨Åc it carries at some point in the past,
things have changed, and we assert that the cartoon picture in Fig-
ure 6(a) captures more accurately the current Internet reality; that
is, a trend towards distributed network infrastructures that are de-
ployed and operated by today‚Äôs commercial Internet players.
To quantify how much closer the cartoon Figure 6(a) is to re-
ality than the traditional AS-level view, we apply our clustering
approach to the 1.5M server IPs seen in our week 45 IXP data and
obtain some 21K clusters, henceforth referred to organizations or
companies. Among them are the well-known big players like Aka-
mai with 28K active server IPs, Google with 11.5K server IPs, and
several large hosters, each with more than 50K server IPs (e. g.,
AS92572 with 90K+ server IPs; AS56740 and AS50099, both with
more than 50K server IPs). Indeed, of the 21K identiÔ¨Åed organi-
zations, a total of 143 organizations are associated with more than
1000 server IPs and more than 6K organizations have more than
10 servers IPs. For the latter, Figure 6(b) shows a scatter plot of
the number of server IPs per organization vs. the number of ASes
that they cover. More precisely, every dot in the plot is an orga-
nization, and for a given organization, we show the number of its
server IPs (x-axis) and the number of ASes that host servers from
342Akamai AS ‚àí AS1 
SSS
IXP
AS4
S
AS2
S
S
AS3
S
S
S  : Akamai server
S
 : Google cache
 : User
(a) Heterogeneity of ASes and AS links
‚óè
‚óè Organization
Organization
Akamai
Akamai
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè