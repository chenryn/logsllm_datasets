title:Robust full duplex radio link
author:Dinesh Bharadia and
Kiran Raj Joshi and
Sachin Katti
Robust Full Duplex Radio Link
Dinesh Bharadia
Stanford University
PI:EMAIL
Kiran Raj Joshi
Stanford University
PI:EMAIL
Sachin Katti
Stanford University
PI:EMAIL
ABSTRACT
This paper presents demonstration of a real-time full duplex point-
to-point link, where transmission and reception occurs in the same
spectrum band simultaneously between a pair of full-duplex radios.
This demo ﬁrst builds a full duplex radio by implementing self-
interference cancellation technique on top of a traditional half duplex
radio architecture. We then establish a point-to-point link using a
pair of these radios that can transmit and receive OFDM packets. By
changing the environmental conditions around the full-duplex radios
we then demonstrate the robustness of the self-interference cancella-
tion to adapt to the changing environment.
Categories and Subject Descriptors
C.2.1 [Computer Communication Networks]: Network Architec-
ture and Design—Wireless communication
Keywords: Full Duplex; Interference Cancellation; Non-linear Can-
cellation
1.
INTRODUCTION
Full duplex radios have huge advantage over their half duplex
counterparts. Several work on full duplex radios [5, 3, 7, 6, 4, 8] have
proposed various hardware and algorithmic techniques to achieve
different level of self-interference cancellation required for realiza-
tion of full duplex radios. Yet, these works have failed to reduce the
ingrained skepticism of both academia and industry alike regarding
the feasibility of implementing these techniques and their adaptabil-
ity to dynamic environmental conditions. This demo has two fold
objectives; ﬁrst, we implement a working full duplex radio using the
architecture proposed in [5]. We then build full duplex radio link by
using a pair of these full duplex radios and demonstrate that they can
adapt to the changing environmental conditions around them [5].
In [5] they have shown that in order to achieve full duplex commu-
nication with regulatory power limit of existing half duplex WiFi ra-
dios, 110dB of self-interference cancellation is required. They have
achieved this level of cancellation in two stages by designing analog
cancellation and digital cancellation ﬁlters. After applying these two
cancellations, the residue of the self-interference signal goes below
the noise ﬂoor which enables the receiver to listen to the weak re-
ceived signal. We demonstrate the cancellation of self-interference
all the way to the noise ﬂoor by implementing analog and digital
cancellation on WARP software radios and a host PC.
Using two such full duplex radios we build a full duplex point-
to-point link, where each full duplex radio transmits data to and re-
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage, and that copies bear this notice and the full ci-
tation on the ﬁrst page. Copyrights for third-party components of this work must be
honored. For all other uses, contact the owner/author(s). Copyright is held by the
author/owner(s).
SIGCOMM’14, August 17–22, 2014, Chicago, IL, USA.
ACM 978-1-4503-2836-4/14/08.
http://dx.doi.org/10.1145/2619239.2631425.
ceives data from the other full duplex radio via the established link.
In order to achieve stable full duplex link, it is necessary to achieve
cancellation which adapts quickly to the changing environment. This
paper demonstrates dynamically adaptive cancellation system, which
achieves robust full duplex link even when the environmental condi-
tion changes frequently. In the rest of this paper, we ﬁrst describe the
implementation of the cancellation techniques used in our full duplex
radio prototype. We then describe the full duplex point-to-point link.
2. ADAPTIVE CANCELLATION
Let us see what are the major constituents of the self-interference
signals that needs to be canceled to enable full duplex communica-
tion. In Figure 1a, T is the signal that is fed to the antenna for trans-
mission, part of this signal is reﬂected back from the environment
and a part is reﬂected from the antenna itself, and part of this signal
leaks directly to the receive path via spurious path in the circulators.
These reﬂected and leaked transmitted signal denoted by aT in ﬁg-
ure 1a are typically 15dB smaller that the signal T , therefore we still
have to cancel 95 dB of the self-interference signal. The signal T
itself is composed of three parts as given in [5], ﬁrst is linear form
of the transmitted digital data that can be modeled, and the second
is the non-linear distortion of the transmitted digital data that can be
modeled, third is the transmitter noise which cannot be modeled (as
noise is random). Since the transmit noise cannot be modeled in dig-
ital, the only way to cancel its effect is to take a copy of it and then
cancel it from the received signal. This is best done in analog do-
main, and as given in [5] we need cancellation of the order of 70dB
to eliminate all the self-interference due to the transmitter noise.
In addition to canceling the effect of the transmitter noise, the ana-
log cancellation also cancels the effect of the environmental reﬂec-
tion from the near-ﬁeld region of the antenna, as well as the reﬂection
from the antenna itself arising due to impedance mismatch. After the
analog cancellation, we are left with the residual signal iT , which
consists of contribution from the linear and non-linear distortions
due to power ampliﬁer, mixer, and other analog components in the
transmit chain as well as the contribution from the reﬂections com-
ing from the far-ﬁeld region of the antenna. This residual component
is modeled adaptively using WiFi preamble to train the digital taps,
which can then eliminate this residual signal.
In a typical radio operation, the environmental conditions in the
near-ﬁeld of the antenna is usually stable and does not vary that
much over time. Whereas the far ﬁeld region can experience very
rapid changes, mainly due to the movement of persons in the sur-
rounding. Because of this the taps used in analog cancellation of
the full-duplex radio remains fairly constant for a given environment
in which the radio is located, and consequently slower adaptation
of these taps is sufﬁcient. Since the far-ﬁeld region of the antenna
changes frequently, the taps used in the digital cancellation needs to
be adjusted more frequently.
In order to demonstrate a dynamic robust full duplex radio, we
have build the analog cancellation circuits and digital cancellation
using WARP radios [2] as shown in ﬁgure 1b. We have accompa-
147(a) Full duplex radio architecture
(b) Full duplex radio implementation
(c) User interface showing performance metric of full
duplex link
Figure 1: Demo of robust full duplex Link
nied video of this demonstration in [1]. We see that even when the
environment around the full duplex radio is not changing, the taps
of the digital cancellation ﬁlters are frequently changing, to adapt to
the changing condition in the far-ﬁeld due to movement of people.
The taps for analog cancellation remains fairly ﬁxed, because the
near ﬁeld region and the reﬂection due to the mismatch are not vary-
ing over time. To demonstrate that the analog cancellation adapts
to the changes in the near-ﬁeld region, we introduce a metallic re-
ﬂector very close to the antenna. This reﬂection adds strong self-
interference in the near-ﬁeld region which is then compensated for
by adjusting the analog taps. We then move the reﬂector away, which
will again cause the change in the near-ﬁeld region of the antenna and
the taps used for the analog cancellation adjusts back to the values
that were there before the introduction of the metallic reﬂector.
3. POINT TO POINT FULL DUPLEX LINK
In this section we demonstrate the application of the full duplex
radios by creating a full duplex point-to-point communication link.
The setup for this link consists of two full-duplex radios that are try-
ing to communicate with each other at the same time on the same
spectrum (band). We implement standard 802.11n PHY based WiFi
Modem for this demonstration. Figure 1c shows the user interface
of the demo with various signals and evaluation metric for one of
the radios.
In order to compare the performance of the full du-
plex link to that of the half-duplex link, we alternate the operation
between the full-duplex and half-duplex mode for every alternate
packet and show the results together. First column in 1c shows the
self-interference signals at different stages of the cancellation and the
weak received signal after the self-interference cancellation. In the
full-duplex mode after the self-interference cancellation, we want the
received signal (black) to look exactly like the signal you would have
received in the half duplex mode (green). The similarity of these two
signals in the attached video indicates that the full-duplex link is op-
erational.
The quality of a link can be visually evaluated by plotting the con-
stellation of the received signal after demodulation. The second col-
umn of ﬁgure 1c shows the constellation at various stages of the full
duplex link as well as that of the half duplex link. The top plot shows
the constellation after only analog cancellation, here the constella-
tion appears as a single blob instead of the 16 constellation points
that was used for this demo. The middle plot shows the constellation
after both the analog and the digital cancellations and we can clearly
see that all the constellation points are tightly grouped around the
true points, this tightness indicates the quality of the link. The bot-
tom plot shows the constellation for the half duplex link and it looks
very close to the full-duplex constellation points, which is yet an-
other conﬁrmation that the full-duplex link is operational.
A more quantitative metric to gauge the quality of a link is to mea-
sure % Error Vector Magnitude (EVM) of the constellation after de-
modulation. EVM measures the deviation of the constellation points
in the received signals from the true constellation points. Therefore
smaller the % EVM for a link higher is the quality of that link. The
third column of the user interface shown in ﬁgure 1c plots the EVM
of the links. As we can see the full-duplex link is slightly degraded
compared to the half-duplex link, there is about 2% difference be-
tween the EVM of these two links. As reported in [5], the noise
ﬂoor after the self-interference cancellation is roughly 1 dB more
than the noise ﬂoor of a half-duplex radio, the difference in EVM
is due to this marginal increase in the noise ﬂoor of the full duplex
radio. The top plot show the EVM for each of the subcarriers and the
middle plot shows the EVM of each packet for the last 100 packets.
The occasional increase in EVM for full duplex link is due to sudden
introduction of a reﬂector close to the radio 1. The taps in analog can-
cellation takes some time to adapt to this new change and hence the
EVM increases momentarily, but once the taps have adapted the link
quality increases again. This momentary degradation is an artifact of
the current implementation and can be improved upon by perform-
ing adaptation using faster hardware support. Finally, the bottom
plot shows the near doubling of the throughput via full-duplex link
compared to its half-duplex counterpart.
4. REFERENCES
[1] Robust Full-duplex Radio link. https://vimeo.com/98308615.
[2] WARP Project. http://warpproject.org.
[3] E. Aryafar, M. A. Khojastepour, K. Sundaresan, S. Rangarajan, and M. Chiang.
Midu: enabling mimo full duplex. In Proceedings of the 18th annual international
conference on Mobile computing and networking, Mobicom ’12, pages 257–268,
New York, NY, USA, 2012. ACM.
[4] D. Bharadia and S. Katti. Full duplex mimo radios. In 11th USENIX Symposium on
Networked Systems Design and Implementation (NSDI 14), pages 359–372,
Seattle, WA, Apr. 2014. USENIX Association.
[5] D. Bharadia, E. McMilin, and S. Katti. Full duplex radios. In Proceedings of the
ACM SIGCOMM 2013 conference on SIGCOMM, SIGCOMM ’13, pages
375–386, New York, NY, USA, 2013. ACM.
[6] M. Duarte, C. Dick, and A. Sabharwal. Experiment-driven characterization of
full-duplex wireless systems. CoRR, abs/1107.1276, 2011.
[7] Y. Hua, P. Liang, Y. Ma, A. Cirik, and Q. Gao. A method for broadband full-duplex
mimo radio. Signal Processing Letters, IEEE, 19(12):793 –796, dec. 2012.
[8] M. Knox. Single antenna full duplex communications using a common carrier. In
Wireless and Microwave Technology Conference (WAMICON), 2012 IEEE 13th
Annual, pages 1–6, 2012.
RX&123d1&dN&ﬁxed&&delays&Analog&Cancella<on&Circuit&control&algorithm&Digital Cancellation  Eliminates all linear and  non-linear distortion  Σ&T R+aT R+iT R Circulator&!!ADC#X&LNA&a1&aN&variable&aZen&Juators&Tb Σ&Σ&X&PA&DAC#TX&C 148