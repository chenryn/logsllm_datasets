to establish an obstruction-free optical path. To ensure that the FSO
devices do not obstruct each other, we use ceiling mirrors [52] as
shown in Figure 1. The requirements of such mirrors are quite
minimal so long as they reﬂect IR and many conventional mirrors
work sufﬁciently well (§3). The ceiling mirror need not be a single
piece, and small unevenness in the mirrors is unlikely to be an issue
due to the misalignment tolerance of the FSO links (§3.1).
Network Provisioning. In the limit, we would like to have a very
large number of FSO devices per ToR. In practice, however, there
are physical and geometric constraints. For instance, FSO devices
will have a ﬁnite size that constrains the number of such devices
per ToR. Thus, we need to provision or preconﬁgure the network
so that it is robust to future (and unforeseen) trafﬁc patterns.
Network Management. The FireFly controller dynamically se-
lects the runtime topology and conﬁgures forwarding paths, based
on prevailing trafﬁc demands and events. Following prior work, we
leverage software-deﬁned networking (SDN) capabilities for data
plane reconﬁguration [12, 17, 38]. Each SDN-capable ToR switch
also reports observed trafﬁc demands to the controller. FireFly can
use other demand estimation algorithms; e.g., host buffer sizes [12]
or new switch features [17]. Since our focus is on FireFly-speciﬁc
aspects, we do not discuss these extensions.
In the following sections, we describe the design of a viable
steerable FSO link, network preconﬁguration, and run-time net-
work management.
3 Practical Steerable FSO Design
In order for the FireFly vision to deployed in a DC, the FSO devices
must ideally have a small form factor (e.g., so we can pack several
devices on each ToR), be low-cost commodity devices (e.g., as we
envision thousands of these in a DC), with low power footprint rel-
ative to switches, and be steerable to enable ﬂexibility.
At ﬁrst glance, these requirements are at odds with the trajec-
tory of today’s commercial FSO devices—they are bulky, expen-
4In effect, we need RF beams with angular divergence ≈ 1 millira-
dian to create a small interference footprint at 50-100m range.
5TeraHertz wireless technology may be a good alternative, but it is
much less mature at this time.
sive, and power-intensive [5]. The main challenge is that achieving
robust links at high data-rates and long ranges (a requirement in
both traditional deployments and FireFly) is hard. It has typically
required powerful lasers and expensive mechanisms for dynamic
alignment for outdoor use. Furthermore, conventional FSO de-
ployments provide ﬁxed point-to-point links and do not focus on
steerability.
In this section, we demonstrate (perhaps surprisingly) that (a) it
is viable to repurpose commodity DC-centric optical networking
gear to establish robust and sufﬁciently long FSO links in a DC,
and (b) we can leverage existing commodity optical technologies
to steer the FSO beam with high precision and low latency.
3.1 FSO Link Engineering
As a ﬁrst step, we demonstrate that it is possible to engineer an
FSO optical link using commodity DC-grade optical networking
equipment that can achieve high data rates, at ranges sufﬁcient
for DC-scale deployment, and with sufﬁcient (mis)alignment tol-
erance.
In particular, we can avoid the additional overheads in
commercial FSO devices as concerns about outdoor environmental
factors largely disappear in the indoor controlled DC setting. How-
ever, we do need to carefully design the optical path to balance
the tradeoff between the laser beam divergence and misalignment
tolerance, as we discuss below.
We engineer the FSO system by coupling two optical ﬁber end
points directly with a free-space link without any opto-electric con-
version thus saving on both power and cost. This Fiber–FSO–Fiber
link connects to standard optical interconnect technology widely
used in DCs (e.g., 10GBASE-SR). A typical example of this in-
terface is optical SFP (small form-factor pluggable) or its variants
such as SFP+.
This approach requires optical designs on both ends: (i) on the
transmit side, where the ﬁber ‘launches’ the laser beam in free
space, and (ii) on the receive side, where the laser beam is received
into the ﬁber (Figure 3(a)). Normally, when the laser beam comes
out of the ﬁber into free space it diverges with a signiﬁcantly large
angle. To minimize divergence, we collimate the beam using a suit-
ably designed lens located at its focal length from the transmitting
ﬁber endpoint.6 A similar lens near the receiving ﬁber end point
focuses the beam back to the ﬁber.
The above optical design is done carefully to ensure that the laser
beam maintains a sufﬁcient width [46] so that it can tolerate minor
misalignments due to rack vibrations and other effects. However,
this presents a tradeoff: wider beams can tolerate misalignments
better, but suffer from a poorer power density at the receiving end.
The design we develop shows that a good balance is indeed pos-
sible using optical SFPs used for long range ﬁber communications
(e.g., 10GBASE-LR can go up to 10 km). They use highly sensitive
detectors that can work with very little received power. Our current
prototype has been tested for 20m. (20m is a limitation of our lab
set up; the general design can extend to 100 m [27].)
This approach satisﬁes all the design requirements except steer-
ing. The lens is small (about 3 cm diameter) with focal length about
the same. Even considering additional hardware (e.g., mounts or
adapters), the footprint of the assembly is only 5 cm across. The
costs are also modest when procured in volume: ≈ $50 for the lens
and $50 for the assembly. We acknowledge that there might be an
additional cost of using optical SFP (≈$100), if optical wired links
are not already used. Finally, there is no additional power burden
6For brevity, we skip the details of the optical design. We only
state the basic approach and relevant tradeoffs. We refer readers to
a similar approach that has been used in a different context [51].
321(a) FSO link design
(b) DC set up
(c) TCP throughput
alignment. The reader can view these mirrors as proxies for mirrors
to be used in steering (next subsection). Alignment is done manu-
ally with the help of an infra-red viewer (more on this in §9). The
TCP transfer experiment is run continuously over several days as
before. The statistics of per-sec TCP throughput is almost identical
again to the optical bench and wired cases (Figure 3(c)). This es-
tablishes the potential of our design. The average TCP throughput
is ≈ 9.3 Gbps — note that no commodity RF technology exists in
small-form factor that can deliver such throughput at 20 m range.
Figure 3: FSO link design, prototype and performance. (a) Optical path and networking gear (not drawn to scale). (b) One end point
of the 10 Gbps link prototype running in a DC over ≈ 20m); the inset shows a zoomed in version. The FSO link connects to a similar
set up on the other end. (c) Distribution of per-sec TCP throughputs on a 10 Gbps FSO link over ≈ 20m on optical bench (Lab) and
DC racks (DC), over days of continuous runs. Throughput distribution on wired optical ﬁber is used for comparison.
beyond the SFP power consumption as the design does not add any
new opto-electronic conversion.
Prototype. We have developed a proof-of-concept prototype fol-
lowing the above design. We have successfully used both 1 Gbps
and 10 Gbps links with very similar optical setups. The proto-
type links use 1000BASE-LX (1GBASE-LR) SFP (SFP+) for the
1 Gbps (10 Gbps) case and multi-mode ﬁbers for their larger diame-
ter. We ﬁrst use standard optical bench set up to validate the design
using controlled experiments and then test the link in a production
DC. Figure 3(a) shows the general setup.7 For the current design
the collimated laser beam maintains a ≈4 mm diameter after it con-
verges. To get up to a 20 m length on a small optical bench, we use
a standard technique used in optics: the beam path is reﬂected mul-
tiple times via mirrors. This also validates use of mirrors on the
optical path and shows that optical loss due to reﬂections is low.
Link Performance. We test the link by running continuous TCP
transfers over the FSO link for several days at a time for several se-
lected link lengths with the set up on the optical bench. The results
are very similar for different lengths. For brevity we only report
the results for the longest tested case (≈20m) for the 10 Gbps link.
See Figure 3(c). Note that the distribution of TCP throughputs is
almost identical to that observed over regular ﬁber links, demon-
strating no additional loss in the FSO links. To study misalignment
tolerance, we shift the transmit side set up in tiny incremental steps
(using a translating mount) perpendicular to the beam axis keeping
the receive side ﬁxed. We see no throughput loss until 6 mm shift,
beyond which the link becomes unstable. As we will see below, this
6 mm tolerance is sufﬁcient to handle minor misalignments due to
rack vibrations and environmental issues in a DC.
The above design provides a basis for a low-cost, commoditiz-
able, and small-form factor FSO link at high data rates over ranges
sufﬁcient for DC scale. Our experiments suggest that the link is
likely robust to realistic (mis)alignment concerns due to environ-
mental effects in DCs.
3.2 Developing Steering Mechanisms
Having established the viability of a point-to-point FSO link using
commodity optics, next we focus on making the beam steerable to
enable ﬂexibility. Our goal is to establish a design roadmap that
is commoditizable. We explore two promising solutions: switch-
able mirrors and Galvo mirrors. We do not claim these are optimal
in any sense or that these are the only alternatives. Our choice is
pragmatic in that we want to establish a feasible roadmap using off-
the-shelf components. (There are a variety of other beam steering
approaches [35], but they are not off-the-shelf technologies.) Both
solutions offer different tradeoffs w.r.t. latency, degree of ﬂexibility,
and cost/power, and at this time, no one solution is strictly better.
Thus, we believe it is instructive to understand and evaluate the
promise of both alternatives and the tradeoffs they offer.
Switchable Mirrors (SMs). Switchable mirrors (SM) are made
from a special liquid crystal material that can be electrically con-
trolled to rapidly switch between reﬂection (mirror) and transparent
(glass) states at millisecond timescales [4]. While the intended use
cases are different (e.g., rear-view mirrors that switch between a
regular mirror and a back-up camera display), we can use them for
beam steering as shown Figure 4(a).
To understand the link performance “in the wild,” we set up the
link in a production (university run) DC environment. Unlike the
optical bench, this real environment has several key differences
that can produce mis-alignments: (1) racks experience vibrations
due to several factors (e.g., server fans, discs, HVAC and UPS
units [47]) and (2) the beam could ‘wander’ due to ﬂuctuating air
density caused by temperature variations. We set up the FSO link
with the optical components placed on top of the rack using mag-
netic bases. Two racks are used at ≈20 m apart. See Figure 3(b).
We use mirrors on the beam path - one on each end - for ease of
7Note that typical optical SFPs require two ﬁbers and thus two
optical paths for duplex communication. However, single ﬁber
SFPs [9] that use WDM principles to multiplex both links on a sin-
gle ﬁber are beginning to be available. For 1 Gbps experiments we
use such SFPs. Due to unavailability of such devices for 10 Gbps,
we use ﬁber for the return path for the 10 Gbps experiments; all
reported performance measurements are from the FSO path.
Each FSO device has multiple SMs, with each SM aligned (dur-
ing a pre-conﬁguration step as discussed in §4) to target a point on
a ceiling mirror and thus, a receiving FSO. The link is established
by switching one of the SMs to the mirror state, while leaving the
rest in the transparent state. (This is done at both ends, but we only
show transmit side for clarity.)
SMs directly satisfy our design requirements. It can be minia-
turized as it only needs to be slightly larger than the beam diame-
ter: 1 cm2 is sufﬁcient. A SM of this size is expected to have low
cost (< $5) at volume [33]. Power consumption is also low: only
40 mW for the stated size [4]. We have evaluated the reconﬁgu-
ToR	
  switch	
  with	
  SFP	
  ports	
  SFP	
  connector	
  Collima6ng	
  lens	
  (diam.	
  =	
  ~3cm)	
  Op6cal	
  ﬁber	
  (short)	
  Laser	
  beam	
  diverges	
  in	
  free	
  space	
  ~4mm	
  Link	
  length	
  (	
  up	
  to	
  20m	
  tested)	
  Focal	
  length	
  =	
  ~3cm	
  Laser	
  beam	
  focused	
  back	
  on	
  ﬁber	
  Mirror	
  Fiber	
  Beam	
  path	
  Lens	
   0 0.2 0.4 0.6 0.8 1 8400 8600 8800 9000 9200 9400CDFThroughput (Mbps)WiredLabDC322(a) Switchable mirror operation
(b) Galvo mirror operation
Experimental set up
Response time
(c) Galvo mirror response
Figure 5: A PCFT with candidate links (solid and dashed).
The set of solid links represents one possible realizable topol-
ogy (τ1), and the set of dashed lines represents another (τ2).
4 Network Preconﬁguration
At a high level, there are two network design problems in FireFly
that occur at different timescales:
• First, we need to provision the network hardware (e.g., how
many FSOs) and also pre-align/pre-orient the SMs/GM at each
FSO. This is done ofﬂine in a pre-conﬁguration phase.
• Second, given a pre-conﬁgured network, we need to recon-
ﬁgure the network in near real-time to implement a runtime
topology suited for the current trafﬁc.
Figure 4: (a) Using switchable mirrors (SMs) with FSOs: (i) 2nd SM is in mirror mode to steer the beam to RX-1; (ii) 3rd SM is in