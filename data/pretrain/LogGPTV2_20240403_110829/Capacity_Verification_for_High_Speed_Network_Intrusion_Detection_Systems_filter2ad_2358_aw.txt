able IDS. As the we are currently limited to topologically-able HIDS, potentially
reactive IDS is also limited to potentially reactive HIDS. The corresponding
relation is in ﬁgure 17.
3.4 Discussion
M2D2 provides an expressive tool to build complex correlation methods. For
example, the reduction of false positives described in section 3.3 could have
been hardly designed without such a rich and formal model. Moreover, the three
aggregations presented above have all illustrated how powerful and easy it is
to compose relations. Aggregations themselves could be composed further. For
example, the ﬁrst two aggregations can be composed to create another relevant
aggregation relation (harmful−1; common target). Indeed, applying harmful−1
to a given host gives alerts whose related attacks may be successful. When used
in conjunction with the common target function, we know which attacks may
work on a given host.
The formal speciﬁcation also helps detect a number of problems. For example,
the relation sub conﬁg ﬁgure 11 has been introduced to ensure type consistency
between the composed relations. This has a practical impact on the implemen-
tation: either an intermediate table has to be created or, at correlation time, the
sub-conﬁguration will have to be checked.
4 Related Work
Formal models. As already mentioned in the introduction, the closest related
work are the NetStat Network Fact Base (NNFB) of Vigna and Kemmerer [4,5]
and the Intrusion Reference Model (IRM) of Goldman et al. [6]. Both the NetStat
Network Fact Base and the Network Entity Relationship Database (NERD) of
IRM are based on Vigna’s network formal model [7], and so are the topolopy
and network events of M2D2. The concept of product in M2D2 is similar to the
concept of services in NNFB and NERD. The security tools formalized in M2D2
are mentioned in NNFB and IRM but they are not precisely speciﬁed. As far as
M2D2: A Formal Data Model for IDS Alert Correlation
135
we know, no model includes the vulnerability and alert parts of M2D2. On the
other hand, IRM includes a security goals database. It captures security policies
set by the administrators. Evidence about violations of the security policy are
then aggregated. This feature, not yet formalized, could be added in M2D2 in
the future. Finally, as mentioned in section 2.5, there are no system level events
modeled in M2D2. We are currently working on the addition of such events.
Another piece of work related to ours is the one of the IETF Intrusion Detec-
tion Working Group (IDWG) [12]. The Intrusion Detection Message Exchange
Format (IDMEF) has been proposed to provide a common format of alerts [12].
The alert speciﬁcation in M2D2 is compatible with IDMEF, IDMEF-compliant
alerts can be received and processed within the M2D2 framework without loss
of semantical information. The scope of M2D2 is larger than IDMEF, to take
into account all sources of information relevant to information security, and as
such simpliﬁes the IDMEF model through the removal of classes with similar
semantic content while conveying the same information through aggregation re-
lationships. This is in particular the case of the source and target classes,
replaced by the notion of node while the source and target information are car-
ried by aggregation relationships.
Implicit models for correlation. Another aspect of the related work is cor-
relation. In order to perform fusion or correlation, researchers in the ﬁeld have
worked out implicit models dedicated to their correlation algorithms. The ob-
jective of M2D2 is to have a solid modeling foundation that allows multiple
correlation tools and algorithms to be implemented and tested.
In [15,16], Cuppens and Mi`ege base their work on fusion on the IDMEF
data model [12], implemented as Prolog predicates. As such, their model is sim-
pler than M2D2, which means that less information is available for correlation
purposes. The sole reliance on intrusion-detection alerts makes it impossible to
assess the relevance of these alerts with respect to the monitored information
system.
Cuppens and Mi`ege suggest in [16] to correlate alerts by using attack scenar-
ios speciﬁed in the Lambda language [17]. Such a language allows correlations
between events belonging to a same attack scenario to be expressed, and could
be used on top of M2D2.
The Tivoli RiskManager tool [13] is a correlation platform for security events
provided by information systems. Originally developed for the correlation of
intrusion-detection alerts, it now also correlates information from ﬁrewalls and
antivirus systems. The data model used by Tivoli RiskManager was the source
for the ﬁrst version of IDMEF, but IDMEF has evolved since and the con-
straints of the Tivoli environment are such that it would be extremely diﬃcult
to implement the exact IDMEF model. Also, events from the three information
sources (intrusion-detection systems, ﬁrewalls and antivirus systems) are not re-
lated together as is the case in M2D2. As such, the correlation algorithm used
in RiskManager has to develop hypotheses concerning the relationships between
events, creating relationships based on superﬁcial characteristics of the events.
136
B. Morin et al.
5 Conclusion
In this paper, we introduced M2D2, a formal information model designed for
security information representation and correlation. The model includes the four
types of information we think crucial to allow rich alert correlations: information
system characteristics, vulnerabilities, security tools, and events and alerts. The
model is a platform to provide answers to three important issues in intrusion-
detection today, the sheer number of alerts provided, the quality of these alerts
and the precision of the ﬁnal diagnosis proposed to operators.
As far as possible, M2D2 reuses models proposed by others, for instance the
Vigna’s topological model. The ﬁrst contribution of M2D2 is thus the integration
of multiple interesting and relevant concepts into a uniﬁed framework. When
needed, we extended these reused model to encompass the four types of useful
information.
Moreover, M2D2 is formally deﬁned, following Mc Hugh’s suggestion that
further intrusion detection signiﬁcant progress will depend on the development
of an underlying theoretical basis for the ﬁeld. This formalism is the second
contribution of M2D2, ensuring that processing of security information and in
particular alert correlation is anchored on a rigorous model representing the
information being processed. This formalism does lend itself to extensions, as
we believe that progress on this path will lead us to incorporate additional
information sources and components.
In order to illustrate how M2D2 could be used, we also presented three ex-
amples of correlation (actually of aggregation) methods. These examples are
rigorously speciﬁed using the formal deﬁnition of M2D2. As opposed to already
published correlation methods, these examples use more than the events gener-
ated by security tools; they make use of many concepts formalized in M2D2.
References
1. G. Jakobson and M. D. Weissman. Alarm correlation. IEEE Network Magazine,
pages 52–60, 1993.
2. J. McHugh. Intrusion and intrusion detection. International Journal of Informa-
tion Security, July 2001.
3. Icat vulnerabilities database. http://icat.nist.gov/icat.cfm.
4. G. Vigna and R. A. Kemmerer. Netstat: A network-based intrusion detection
approach. In Proceedings of the 14th Annual Computer Security Application Con-
ference, December 1998.
5. G. Vigna and R. A. Kemmerer. Netstat: A network-based intrusion detection
system. Journal of Computer Security, February 1999.
6. R. P. Goldman, W. Heimerdinger, S. A. Harp, C. W. Geib, V. Thomas, and R. L.
Carter. Information modeling for intrusion report aggregation. In Proceedings of
the DARPA Information Survivability Conference and Exposition, June 2001.
7. G. Vigna. A topological characterization of tcp/ip security. Technical Report
TR-96.156, Politecnico di Milano, 1996.
8. J.-R. Abrial. The B Book: Assigning programs to meanings. Cambridge University
Press, 1996.
M2D2: A Formal Data Model for IDS Alert Correlation
137
9. R. Shirey. Internet security glossary. RFC2828, 2000.
10. J. Arlat, J.P. Blanquart, A. Costes, Y. Crouzet, Y. Deswarte, J.C. Fabre,
H. Guillermain, M. Kaaniche, K.Kanoun, J.C. Laprie, C. Mazet, D. Powell,
C. Rabejac, and P. Th´evenod. Guide de la suret´e de fonctionnement. Cepadues
editions, 1995.
11. D. E. Mann and S. M. Christey. Towards a common enumeration of vulnerabili-
ties. In Proceedings of the 2nd Workshop on Research with Security Vulnerability
Databases, January 1999.
12. Dave Curry and Herv´e Debar. Intrusion detection message exchange format data
model and extensible markup language (xml) document type deﬁnition.
Inter-
net Draft (work in progress), December 2001. http://search.ietf.org/internet-
drafts/draft-ietf-idwg-idmef-xml-06.txt.
13. Herv´e Debar and Andreas Wespi. Aggregation and correlation of intrusion-
In Wenke Lee, Ludovic M´e, and Andreas Wespi, editors, Pro-
detection alerts.
ceedings of the 4th International Symposium on Recent Advances in Intrusion De-
tection (RAID 2001), number 2212 in Lecture Notes in Computer Science, pages
85–103, Davis, CA, USA, October 2001. Springer.
14. J. D. Howard and T. A. Longstaﬀ. A common language for computer security
incidents. CERT - SAND98-8667,
http://www.cert.org/research/taxonomy 988667.pdf, 1998.
15. F. Cuppens. Managing alerts in multi-intrusion detection environment. In Proceed-
ings of the 17th Annual Computer Security Applications Conference (ACSAC’01),
2001.
16. F. Cuppens and A. Miege. Alert correlation in a cooperative intrusion detection
framework. In Proccedings of the IEEE Symposium on Security and Privacy, 2002.
17. Fr´ed´eric Cuppens and Rodolphe Ortalo. Lambda: A language to model a database
for detection of attacks. In H. Debar, L. M´e, and S. F. Wu, editors, Proceedings of
the Third International Workshop on the Recent Advances in Intrusion Detection
(RAID’2000), number 1907 in LNCS, pages 197–216, October 2000.
Development of a Legal Framework for Intrusion
Detection
Steven R. Johnston, CISSP
Communications Security Establishment
P.O. Box 9703
Terminal 
Ottawa, Canada K1G 3Z4
PI:EMAIL
Abstract.  To  meet  demands  for  increased  interconnectivity,  efficiency  or
competitiveness,  organizations  increasingly  rely  on  technology.    This  trend
creates significant opportunities to improve  service  delivery  and  to  move  into
new areas of endeavour.  But reliance on an inherently insecure infrastructure
exposes  organizations  to  a  constantly  evolving  threat  environment.    Not  only
has  the  nature  of  the  threat  changed,  so  too  has  the  scope  of  the  protection
problem.    Protection  of  information  systems  is  now  seen  as  a  component  of
national  security.    As  organizational  assets  move  online,  so  does  the  threat.
Key sources of threat information are now online, including within the network
communications themselves.  This puts organizations in a position where they
must  monitor  network  communications  in  order  to  obtain  intelligence,
indications  and  warnings  of  intrusions  and  evidence  to  support  criminal
prosecution  as  appropriate.    One  method  of  performing  this  monitoring  is
through  the  use  of  intrusion  detection  systems  (IDS).    However,  this  may
involve the monitoring of private communications, which introduces a number
of  legal  (privacy  and  criminal  law)  concerns.    While  existing  legislation
adequately addresses interception by S&I and law enforcement agencies, they
generally  fail  to  address  interception  of  network  traffic  by  other  public  or
private sector organizations.  This paper seeks to identify and discuss some of
the key legal issues affecting the development of a general legal framework for
intrusion detection for network protection.
Keywords:  Anti-terrorism  law,  criminal  law,  interception, intrusion  detection,
privacy, private communications, wiretap
© Her Majesty the Queen as represented by the Minister of National Defence,
acting on behalf of the Communications Security Establishment, Canada, 2002
1   Introduction
Organizations  of  all  types,  in  both  the  public  and  private  sectors,  are  increasingly
dependent  on  information  technology.    This  dependency  results  from  demands  for
increased  interconnectivity,  efficiency  or  competitiveness  –  on  the  part  of  the
organizations themselves and/or their clients.  These organizations have increasingly 
A. Wespi, G. Vigna, and L. Deri (Eds.): RAID 2002, LNCS 2516, pp. 138-157, 2002.
© Springer-Verlag Berlin Heidelberg 2002
Development of a Legal Framework for Intrusion Detection         139
been turning to information system technology for a variety of purposes: e-commerce,
e-government,  and  improvements  in  information  access  and  sharing  among  others.
Reliance on an inherently insecure infrastructure exposes organizations to a variety of
new threats.  They must now contend with new cyber-threats such as fast-spreading
malicious code and criminal hacking.
The scope of the protection problem has also dramatically increased over the past
few years.  Protection of computer systems and networks has been an issue of concern
for some time.  In the last few years, however, the protection of these same systems
and networks has come to be viewed as a component of national security.  This is due
in  large  part  to  the  work  of  the  President’s  Commission  on  Critical  Infrastructure
Protection  (PCCIP),  which  broadened  the  definition  of  national  security  to  include
protection of critical infrastructures1, one of which is the telecommunications sector.
Arguably, the telecommunications sector is the most important of the sectors, as all of
the  others  are  dependent  in  some  way  or  another  (many  of  which  may  not  be  well
understood) on telecommunications.
Traditionally,  the  emphasis  of  the  protection  effort  has  been  on  the  use  of
cryptography, firewalls, anti-virus applications and so on.  Although this is still very
important,  greater  emphasis  is  being  placed  on  detection  of  and  response  to
anomalous events – in recognition of the fact that perfect protection is impossible to
achieve.  A key element of this strategy is the use of intrusion detection systems IDS),
which  examine  network  or  host  activity  to  detect  indications  of  malicious  activity.
However, this may involve the interception of personal or private information, which
introduces a number of legal (privacy and criminal law) concerns.
2   Aim
The ability to copy, save and/or log personal information transmitted over a network
exists in technologies that  are  already  in  widespread use,  such  as  firewalls,  servers,
and  anti-virus  software.  Indeed,  logging  of  personal  information  is  a  far  easier
proposition in the context of these network infrastructure and security administration
tools.  The implications of criminal and anti-terrorism legislation are thus not limited
to IDS alone, however, this paper will focus on their application to intrusion detection
systems.
It  is  the  intent  of  this  paper  to  examine  key  provisions  of  criminal  and  anti-
terrorism  legislation,  and  examine  some  of  the  implications  for  the  use  of  IDS  in
protecting  computers  and  networks.    Reference  will  be  made  to  legislation  from
Australia, Canada, the United Kingdom and the United States in order to demonstrate
that these are issues of general interest. It is not the intent of this paper to substitute
1  Critical  infrastructures  have  been  defined  as  “  infrastructures  which  are  so  vital  that  their
incapacitation  or  destruction  would  have  a  debilitating  impact  on  defense  or  economic
security.”  Anonymous,  “Critical  Foundations:  Protecting  America’s  Infrastructures”,  The
President’s  Commission  on  Critical  Infrastructure  Protection,  October  1997,  page  19.
Although  the  actual  delineation  of  these  infrastructures  varies  somewhat  from  country  to
country,  it  is  generally  agreed  that  critical  infrastructures  include  energy,  banking  and
finance,  transportation,  water  and  sewage,  government  services,  emergency  services  and
telecommunications. 
140         S.R. Johnston
for considered legal advice.  The opinions expressed in this paper are strictly those of
the  author  and  do  not  reflect  the  position  of  the  Communications  Security
Establishment (CSE) or of the Government of Canada (GoC).
3   Interception Requirements
The  manner  in  which  public  and  private  sector  organizations  conduct  business  and
offer services to their clients has changed dramatically over the past several years, as
organizations move to e-business, e-government or any other form of online activity.
An increasing percentage of organizational assets are moving online, stored in file and
mail  servers,  data  warehouses  and  storage  area  networks.    These  assets  include
financial,  medical  or  personnel  records,  strategic  plans,  and  trade  secrets  –  all  of
which represent some of the organization’s most valuable assets.  Similarly, business
communications are increasingly carried by networks of one form or another.
Individuals  and  organizations  that  pose  a  threat  to  these  assets  are  also  moving
online.  This is partly because this is “where the money is”.  It is also partly because
the  use  of  these  technologies  confers  flexibility,  speed  and  anonymity  on  their
activities.    Cyber-threats  are  difficult  to  anticipate  (other  than  in  a  generic  way),
detect, verify and trace. As the threat is increasingly cyber-based, information about
the  threat  can  also  be  found  online.    Hacker  websites,  e-zines,  Internet  Relay  Chat
channels and e-mail can be important sources of threat information, as is the network
traffic  itself.    A  number  of  functions  performed  by  public  and  private  sector
organizations  depend  upon  access  to  and  analysis  of  that  information,  including
intelligence, evidence, and indications and warnings to name a few.
Intelligence is defined as information and knowledge about an adversary obtained
through  observation,  investigation,  analysis,  or  understanding.  2    The  collection,
analysis and reporting of timely, accurate intelligence on threats to national security is
generally  the  responsibility  of  security  and  intelligence  (S&I)  agencies  such  as  the
National  Security  Agency  (NSA)  or  the  Central  Intelligence  Agency  (CIA).3    The
intelligence function is no longer the exclusive domain of ‘national security’ agencies
–  private  sector  organizations  need  to  generate  competitive  business  intelligence.
They may also receive intelligence from law enforcement and S&I agencies under the
auspices of programs such as the FBI’s Infragard)4.
2  From  the  Joint  Doctrine  Encyclopedia, dated  16  July 1997.    Part  of  the  US  Department  of
Defense Joint Electronic Library.
3 The CIA, for example, is mandated to “provide accurate, evidence-based, comprehensive and
timely  foreign  intelligence  related  to  national  security”.    Extracted  from  “About  the  CIA:
CIA  Vision,  Mission,  and  Values”,  posted  to  the  CIA  Website.    See  also:  the  Canadian
Security Intelligence Service – “The Service shall collect and analyze and retain information
and  intelligence  respecting  activities  that  may  on  reasonable  grounds  be  suspected  or
constituting threats to the security of Canada”, taken from (Canada (CA)) An Act to establish
the Canadian Security Intelligence Service (R.S. 1985, c.C-23), updated to 31 August 2001
(CSIS Act), Section 12. 
4  Infragard  was  developed  by  FBI  Cleveland  in  1996  to  promote  protection  of  critical
information  systems.    It  provides  formal  and  informal  channels  for  the  exchange  of
information about infrastructure threats and vulnerabilities.  Taken from the Infragard FAQ.
Development of a Legal Framework for Intrusion Detection         141
Intelligence includes identifying and monitoring groups or individuals  deemed  to
pose a national  security  threat.   Intelligence  may  be gathered  in  a number  of  ways,
ranging  from  sophisticated  technical  means  (e.g.  satellites  and  signals  intelligence
efforts) to human intelligence sources (e.g. spies, defectors and informants).  In order
to  fulfill  their  mandates,  these  agencies  now  undoubtedly  include  intercept  and
analysis  (of  both  traffic  and  content)  of  open  (i.e.  public)  information  sources  and
network  traffic  as  sources  of  intelligence  about  both  conventional  and  cyber-based