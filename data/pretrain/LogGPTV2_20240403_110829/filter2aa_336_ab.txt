• 订票助手因为特殊需要，必须增加自动更新功能
。早期的升级是用自己服务器的，并且每次返回
的信息量很小（大约100-200字节）
• 12306网站用的是HTTPS协议，而新版本的Chrome
和Firefox有些安全限制，要求引用的内容必须也
是HTTPS协议的服务器
• 作者没有HTTPS协议的服务器，看到之前部分类似
脚本引用资源是利用GitHub的服务器，在没有对
GitHub的服务器仔细了解的情况下，便采用了此
方案
订票助手和GitHub
• 16日下午GitHub的OPS团队成员Jesse 
Newland在GitHub上的助手主页Fire了一个
Issue，指出订票助手在12306网站上引用了
部分GitHub上的资源，导致对GitHub的服务
产生了负面的影响，请求移除。
• 其实早在10日的时候，新版本的助手就已
经将这些引用GitHub的资源移除。
订票助手和GitHub
• 为什么还会导致此类事情的发生？因为最
初要移除的原因是GitHub的服务在请求量高
的情况下是不可靠的，经常会返回403错误
• 而助手作者对GitHub不够了解，为了尽快让
用户升级，早期版本的助手对GitHub的请求
采取了轮询的策略，在没有得到响应的情
况下，五秒钟后自动重试
订票助手和GitHub
• 而GitHub的限制比较严格，在403错误返回后，如
果继续，会连续返回403错误。因此，当渐入订票
高峰期的时候，请求量会随着人数的增加很快暴
增，导致GitHub方面注意到哪怕仅仅返回403而不
是正常响应的影响
• 由于返回数据不正常，老版本的助手得不到更新
，所以无法从开发者的层次去解决问题
• 后期与OPS团队沟通后，将相关的文件转移到新浪
SAE上（重定向请求），解决了这个问题。
订票助手和GitHub
• 在SAE上订票助手产生了多少流量？
订票助手和GitHub
• 后来传说GitHub被大陆的长城防火墙（GFW
）封锁。因为之前的12306事件，外界普遍
认为是因为订票助手的关系，铁道部要求
封的
• 李开复发表声明抗议被封
• 此外也有人提出建议是因为有人在GitHub上
搭建了政治敏感类话题导致GitHub被封锁
• 在几天后GitHub服务恢复。此次事件被媒体
定义为一例春运影响世界的事例。
订票助手和GitHub
• 在此次事件中得到的总结：
• GitHub作为一个托管网站，负载能力是很低
的，在需要请求量的情况下，应避免引用
或使用GH Pages
• 在任何时候，重试型的操作都应该遵循有
穷原则，而不能无限操作
订票助手和铁道部
• 因为一定程度上来说，铁道部是政府机构
，而民间和政府机构素来容易产生恩怨
• 在春运时，寄予重大期望的铁道部总是让
人失望，因此容易积怨。尤其在春运时刻
，铁道部是媒体和舆论的中心地带
• 订票助手的用户在春运时暴增并广为传播
，因此媒体和网民注意。
• 在GitHub事件发酵之后，订票助手同时引起
了铁道部注意
订票助手和铁道部
• 订票助手提供的强大功能和12306本身的功
能引起反差，导致网民和媒体吐槽网站本
身难用
• 而买不到票的大量人群同时发起了对订票
助手类工具导致他们更难买的争论
• 铁道部在各种事件的压力之下，决定封杀
订票助手
订票助手和铁道部
• 最初封杀订票助手主要依赖于约谈手段
• 17日夜间，铁道部下属铁路公安共三人找
到订票助手作者住处，要求作者停止开发
订票助手，并移除所有下载
• 针对市场上曝光度最高的猎豹浏览器抢票
办，铁道部也约谈企业负责人要求停止下
载
订票助手和铁道部
• 在媒体和社交界，争论的焦点在于公平性
，有人认为此类工具提供的方便功能会导
致不会用的人失去更多的买票机会。
• 但基本舆论导向是铁道部自身的问题
• 后期政府媒体偏向逐渐偏移，从挺12306转
变为对铁道部提出批评
• 工信部后期否认发文要求各公司停止提供
软件下载，并声明鼓励创新
订票助手和铁道部
• 铁道部对铁道部的封杀从政策上转变为技
术上
• 订票助手和铁道部的对抗转变为技术上的
对抗。
• 截止春节前的二十天内，订票助手升级四
十多个版本，最高一日升级四次
订票助手和铁道部
铁道部对订票助手主要的反制手段包括：
1.浏览器限制
2.页面请求来源限制
3.行为限制
4.修改页面结构或函数签名等
订票助手和铁道部
浏览器限制。
有段时间针对猎豹浏览器UA检测，是猎豹浏
览器的返回空白响应，从而直接阻止用户使
用猎豹浏览器买票。
由于此方式过于粗暴，因此广受批评。猎豹
紧急升级浏览器，伪装成IE，后铁道部取消了
这个屏蔽方案。
订票助手和铁道部
页面请求来源限制
在助手的运行过程中，为了综合完成功能的
实现，可能会跨页面调用功能接口函数。这
就给铁道部的检测留下了空间。
检测到当前函数的调用不是在他们预期的页
订票助手和铁道部
行为限制
铁道部还会通过相关的用户行为检测助手的存在。检测手段的基本思路是，‘用户不会这
样做’，以及‘用户的动作不会这样快’。
‘用户不会这样做’是指通过第三方加入的新的快捷操作，比如登录后原系统是要先进入
欢迎页的，而助手则允许用户直接进入查票页面。此时如果助手再直接跳转，那么铁道部
会通过检测Referrer来判断不是用户手动操作的，然后将用户强行退出登录，以让用户莫名
其妙的方式来阻止用户使用助手。
‘用户的动作不会这样快’的经典案例是验证码。助手引入的一些自动化功能能显著提高
用户点击预定后的提交速度，为了限制，铁道部会检测在点击预订后多少时间内用户便提
交订单，短于指定时间则直接判断为非法操作。
订票助手和铁道部
修改页面结构或函数签名等
铁道部会通过一些简单的修改来阻止用户用
助手，主要为修改助手会要调用的函数名，
从而阻止助手的正常运行。
修改的方式比较简单，往往是在名字中加个
别单词做修饰，或者只是把命名换一下。
订票助手和铁道部
总结说来，铁道部在对抗时期使用的手段是
比较简单的，短时间内的效果也比较显著，
但也很容易用技术手段绕过。
典型的例子是，当发现铁道部修改之后，一
般半小时内就可以有新版本的助手放出来。
但总结而言，铁道部这些限制最大的问题是
订票助手和铁道部
在后期，为了应对铁道部的限制措施，尤其是为了在铁道部限制的情况
下不因为助手本身让用户蒙受损失，助手在这方面下了很大的精力，这
些主要包括：
•自动检测网站的版本，当检测到版本变更的时候提醒用户可能会有损失
，提醒先测试；
•修改一些处理方式，加强对函数名、地址修改等简单修改的自动检测能
力；
•引入后台请求拦截技术，对助手发出的请求进行伪装，防止被铁道部限
制；
订票助手的未来
其实对抗不是目的，用自己掌握的技术让更
多的人买票更方便更简洁才是最终的目的。
唯一遗憾的是票总是那么多，总会有那么多
人买不到。
所以寄希望大陆发展会越来越好，让人们不
再背井离乡。那么这个问题，也就不复存在
了。
谢 谢 ！