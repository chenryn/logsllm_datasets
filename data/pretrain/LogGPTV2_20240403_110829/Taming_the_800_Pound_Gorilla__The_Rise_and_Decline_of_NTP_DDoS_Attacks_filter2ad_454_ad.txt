Table 3 shows two truncated examples of tables returned by an
NTP server in response to a monlist query with IPs obfuscated. We
have also eliminated three unrelated columns for clarity (the local
address, client version, and restricted ﬁeld). Thus, the columns of
interest to us are: (i.) remote address (client or victim IP); (ii.) client
source port; (iii.) count of packets; (iv.) client request mode; (v.)
average inter-arrival time; and (vi.) last seen time (seconds ago).
In monlist table 3a. we ﬁrst observe that the ONP scanning IP
appears as the topmost address in the table. This is typically but
not always the case, perhaps because some implementations may
only update the table after replying to the probe. The last seen for
the ONP IP is thus 0, and the inter-arrival time is typically around
600 thousand, since ONP probes IPs once a week. Second, we note
that the count ﬁeld for our probe is in the single digits, and that the
mode column shows 7, which, along with mode 6, are the special
NTP modes that include commands such as monlist and version. In
Table 3: Partial monlist table examples, showing the ONP
probe, normal clients, as well as apparent NTP DDoS victims
and the ﬁelds used to identify each.
(a) monlist Table A
Address
ONP-IP
client.a1
client.a2
client.a3
client.a4
Src. Port
57915
10151
123
54660
36008
Count
6
19
3281
2
1
Mode
7
6
4
7
3
Inter-arrival
526929
154503
1024
823
0
Last Seen
0
310
345
20795
104063
(b) monlist Table B
Address
ONP-IP
client-b1
client-b2
client-b3
client.b4
Src. Port
47188
59436
43395
50231
80
Count
1
3358227026
25361312
158163232
2189
Mode
7
7
7
7
7
Inter-arrival
0
0
0
0
0
Last Seen
0
0
0
0
2
addition to the ONP IP, we see four other clients, with request modes
3,4,6 and 7, that have also communicated with this server between
29 hours and ﬁve minutes ago (last seen). Client 1a sent 19 packets
up to this point, about once every 43 hours, using mode 6; so, it is
likely another probe. Checking the hostname of that IP conﬁrms
that it is indeed a research project. Client a3 is also a benign Internet
survey host. Clients a2 and a4 appear to be normal NTP clients,
contacting the server over mode 3 and 4 (normal operational modes)
and using expected source ports and inter-arrival times (the time for
a4 is 0, because it only sent one packet).
Moving to the second example table, 3b (assembled from entries
in two actual tables for illustration), we again see the ONP probe
packet. We also see four client IPs, each using mode seven, some
with average inter-arrival times of 0 seconds and last seen within
the last second. Further, the packet count sent by some clients is
very high, with the largest of the four clients showing a count of
over 3 billion packets. These all appear to be victims of the example
ampliﬁer. What is more, one of the clients is using source port 80,
which, for UDP, is not a well-known service port but, as our victim
port analysis (section 4.3.2) reveals, is commonly targeted.
4.2 monlist Table Analysis
For each of the weeks of ONP data, we parsed the responses to
ONP monlist probes from each ampliﬁer, 5M ampliﬁer-week pairs.
We applied the protocol logic found in the NTP ntpdc tool to rebuild
the monlist tables present in the packets captured for each probed
ampliﬁer. If an ampliﬁer sent repeated copies of the table (i.e., was a
“mega-ampliﬁer” discussed in § 3.4) we used the ﬁnal table received
that sample day. For each client IP in each table parsed, we use a
ﬁlter we describe next to bin each client into one of three categories:
a non-victim, a scanner/low-volume victim, or an actual apparent
victim of that ampliﬁer.
Identifying Victims: While the normal NTP modes could conceiv-
ably be used for reﬂection, there is little reason for attackers to do
so, as no ampliﬁcation is provided. Thus, if the mode value was less
than 6, we classiﬁed the client as a non-victim. For clients that were
using modes 6 or 7, we applied the following thresholds: if a client
sent less than three packets to this ampliﬁer (via the count ﬁeld) or
the average inter-arrival time was greater than 3600, indicating that
it had received no more than one packet per hour from the ampli-
ﬁer, on average, we categorized the client as a scanner/low-volume
victim, otherwise it was labeled a victim. We only report results
for victims. This limits our reporting of victims to those above a
low threshold of packets. Again, when a client received more than
440three packets from an ampliﬁer and averaged more than one packet
per hour, we labeled it a victim of that ampliﬁer. While this may
seem like a low threshold, note that no legitimate NTP client would
send these mode packets in the course of normal operation, and that
individual researchers scanning the IP address space are not likely
to re-scan a given IP more than once per hour.
For each victim seen by an ampliﬁer, we extracted the count of
packets it received, the average inter-arrival time, and the last seen
time that the ampliﬁer saw the victim, which is the attack end time
for that ampliﬁer/victim pair. We also estimated the duration of
attacks, using simply the packet count multiplied by the average
inter-arrival time. As the start time is not part of the monlist table,
we estimate it using the duration and last seen time values, via
similarly simple arithmetic including this calculated duration and
time the table was received by the ONP scanner.
View Provided By Tables: Across all ONP weekly samples, the
median largest last seen time in the monlist tables is about 44 hours.
Thus, the median window within which we see attacks is approx-
imately the previous two days. Arguably, this suggests that our
samples will underestimate the number of victims, packets, or at-
tacks by roughly a factor of 3.8 (i.e. there are 168 hours per week
and we see 44). We don’t show a plot, but, as expected, the largest
last seen time in tables shrinks between the ﬁrst sample in January
and the peak of attacks in mid-February as the volume of attacks
increases (thus shrinking the view of the 600-entry-capped monlist
tables), and then increases again; following the same pattern seen in
our other measurements (e.g., Internet NTP trafﬁc). For this reason,
our February peaks are likely underestimating attacks more than in
the lower-volume months before or since.
4.3 Victims and Attacks
We next seek to understand who is the target of NTP DDoS
attacks, when attacks occurred, how long the attacks lasted, and
whether we see evidence for any of the public attacks.
4.3.1 Victim Locations and Networks
Our victim list includes victims from 184 countries in six conti-
nents, and, as Table 1 shows, the victim population in our samples
spans up to 33K routed blocks and 6700 ASes at peak. We ﬁnd that
about half of victims are end host IPs, though this has grown from
31% on January 10th. The average number of IPs attacked in routed
blocks is between 3–5, suggesting most attacks target a very small
number of selected hosts in targeted organizations. Together with
the fraction of target hosts that are end-hosts, this adds evidence to
the idea that many DDoS attacks are launched against individuals.
We plot a CDF of the contribution of victim packets by au-
tonomous system in Figure 5 for both ampliﬁer and victim ASes.
Just 100 ampliﬁer ASes are responsible for 60% of the victim packets
measured. Victim ASes are even more concentrated, with the top
100 ASes receiving three quarters of all attack packets. In examin-
ing top ASes with victims, we note that, out of the top ten ASes,
eight are hosting providers and two are telecom companies. The top
attacked AS is French hosting ﬁrm OVH, the purported target of
large NTP DDoS attacks in mid-February (see § 4.4).
4.3.2 Attacked Ports
We were interested in seeing what services or ports were being
attacked at these victim networks. For each victim seen at each
ampliﬁer, we tallied the source port used. Table 4 shows the top
twenty attacked ports, along with the count of ampliﬁer/victim pairs
and fraction of all. We also include a column describing common
use of each port, where known.
Figure 5: CDF of aggregate victim packets sent or received by
autonomous systems. Just 100 ampliﬁer ASes are responsible
for 60% of the victim packets measured. Victims are even more
concentrated, with 75% in the top 100 ASes.
Table 4: Top 20 ports seen in victims at ampliﬁers. Note preva-
lence of ports known to be associated with games, marked with
(g), which add up to at least 15% of the victim ports attacked
in the top 20 (we did not manually label ports above rank 20).
Port 80 is also used by game systems, though over TCP.
Rank
Attacked Port
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
80
123
3074
50557
53
25565
19
22
5223
27015
43594
9987
8080
6005
7777
2052
1025
1026
88
90
Common UDP Use
None. via TCP:HTTP (g)
NTP server port
XBox Live (g)
Unknown
DNS; XBox Live (g)
Fraction
0.362
0.238
0.079
0.062
0.025
0.021 Minecraft (g)
0.012
0.011
0.007
0.006
0.004
0.004
0.004
0.003
0.003
0.003
0.002 Win RPC; other
0.002 Win RPC; other
XBox Live (g)
0.002
DNSIX (military)
0.002
chargen protocol
None. via TCP:SSH