In Proceedings on Privacy Enhancing Technologies
tured encryption.
(Po/PETS ’19), 2019.
[6] Johes Bater, Gregory Elliott, Craig Eggen, Satyender Goel, Abel Kho,
and Jennie Rogers. SMCQL: secure querying for federated databases.
Proceedings of the VLDB Endowment, 10(6):673–684, February 2017.
[7] M. Bellare, A. Desai, E. Jokipii, and P. Rogaway. A concrete security
In Symposium on Foundations of
treatment of symmetric encryption.
Computer Science (FOCS ’97), pages 394–405. IEEE Computer Society,
1997.
[8] Laura Blackstone, Seny Kamara, and Tarik Moataz. Revisiting leakage
abuse attacks. In Network and Distributed System Security Symposium
(NDSS ’20), 2020.
[9] Bolt Labs. emp-sh2pc, January 2020.
[10] R. Bost. Sophos - forward secure searchable encryption.
In ACM
Conference on Computer and Communications Security (CCS ’16),
20016.
[11] R. Bost, B. Minaud, and O. Ohrimenko. Forward and backward private
searchable encryption from constrained cryptographic primitives.
In
ACM Conference on Computer and Communications Security (CCS ’17),
2017.
[12] Bureau of Alcohol, Tobacco, Firearms and Explosives. ATF Form 4473
- Firearms Transaction Record Revisions, August 2020.
[13] R. Canetti.
Security and composition of multi-party cryptographic
protocols. Journal of Cryptology, 13(1), 2000.
[14] R. Canetti. Universally composable security: A new paradigm for
In IEEE 42nd Annual Symposium on the
cryptographic protocols.
Foundations of Computer Science (FOCS 2001), pages 111–126. IEEE,
2001.
[15] D. Cash, S. Jarecki, C. Jutla, H. Krawczyk, M. Rosu, and M. Steiner.
Highly-scalable searchable symmetric encryption with support
for
boolean queries. In Advances in Cryptology - CRYPTO ’13. Springer,
2013.
[16] D. Cash and S. Tessaro. The locality of searchable symmetric encryption.
In Advances in Cryptology - EUROCRYPT 2014, 2014.
[17] David Cash, Joseph Jaeger, Stanislaw Jarecki, Charanjit Jutla, Hugo
Krawczyk, Marcel Rosu, and Michael Steiner. Dynamic searchable
encryption in very-large databases: Data structures and implementation.
In Network and Distributed System Security Symposium (NDSS ’14),
2014.
[18] Giffords Law Center. Giffords law center to prevent gun violence, 2018.
[19] Giffords Law Center. Registration, 2018.
[20] M. Chase and S. Kamara. Structured encryption and controlled disclo-
In Advances in Cryptology - ASIACRYPT ’10, volume 6477 of
sure.
Lecture Notes in Computer Science, pages 577–594. Springer, 2010.
[21] Clare Garvie, Alvaro M. Bedoya, and Jonathan Frankle. The Perpetual
Line-Up. Technical report, Center on Privacy & Technology at Geor-
getwon Law, Georgetown, Washington D.C., October 2016.
[22] R. Curtmola, J. Garay, S. Kamara, and R. Ostrovsky.
Searchable
symmetric encryption: Improved deﬁnitions and efﬁcient constructions.
In ACM Conference on Computer and Communications Security (CCS
’06), pages 79–88. ACM, 2006.
[23] Kinan Dak Albab, Rawane Issa, Andrei Lapets, Peter Flockhart, Lucy
Qin, and Ira Globus-Harris. Tutorial: Deploying Secure Multi-Party
In 2019 IEEE Cybersecurity
Computation on the Web Using JIFF.
Development (SecDev), pages 3–3, Tysons Corner, VA, USA, September
2019. IEEE.
[24] Mohammad Etemad, Alptekin K¨upc¸ ¨u, Charalampos Papamanthou, and
David Evans. Efﬁcient dynamic searchable encryption with forward
privacy. PoPETs, 2018(1):5–20, 2018.
[25] David Evans, Vladimir Kolesnikov, and Mike Rosulek. A pragmatic
introduction to secure multi-party computation, volume 2. Foundations
and Trends in Privacy and Security, 2017.
[26] Dan Friedman. The ATF’s Nonsensical Non-Searchable Gun Databases,
Explained. The Trace, August 2016.
[27] S. Garg, P. Mohassel, and C. Papamanthou. TWORAM: efﬁcient
oblivious RAM in two rounds with applications to searchable encryption.
In Advances in Cryptology - CRYPTO 2016, pages 563–592, 2016.
[28] O. Goldreich, S. Micali, and A. Wigderson. How to play ANY mental
game. In ACM Symposium on the Theory of Computation (STOC ’87),
pages 218–229. ACM, 1987.
[29] S. Jarecki, C. Jutla, H. Krawczyk, M. Rosu, and M. Steiner. Outsourced
symmetric private information retrieval. In ACM Conference on Com-
puter and Communications Security (CCS ’13), pages 875–888, 2013.
[30] S. Kamara and T. Moataz. Boolean searchable symmetric encryption
In Advances in Cryptology -
with worst-case sub-linear complexity.
EUROCRYPT ’17, 2017.
[31] S. Kamara and T. Moataz. Computationally volume-hiding structured
encryption. In Advances in Cryptology - Eurocrypt’ 19, 2019.
[32] S. Kamara and C. Papamanthou.
Parallel and dynamic searchable
In Financial Cryptography and Data Security
symmetric encryption.
(FC ’13), 2013.
[33] S. Kamara, C. Papamanthou, and T. Roeder. Dynamic searchable
In ACM Conference on Computer and Com-
symmetric encryption.
munications Security (CCS ’12). ACM Press, 2012.
[34] Seny Kamara, Tarik Moataz, and Olya Ohrimenko. Structured encryp-
tion and leakae suppression. In Advances in Cryptology - CRYPTO ’18,
2018.
[35] J. Katz and Y. Lindell. Introduction to Modern Cryptography. Chapman
[36] Jeanne Laskas. Inside the Federal Bureau Of Way Too Many Guns. GQ,
& Hall/CRC, 2008.
August 2016.
[37] James McClure. Firearms Owners’ Protection Act, May 1986.
[38] McKenzie Funk. How ICE Picks Its Targets in the Surveillance Age.
New York Times Magazine, October 2019.
[39] Metropolitan Police Department. Application for Firearms Registration
Certiﬁcate (PD-219), August 2020.
[40] T.
Moataz
and
S.
Kamara.
https://github.com/encryptedsystems/Clusion.
Clusion.
[41] New York State Police. Pistol Revolver License Recertiﬁcation.
[42] V. Pappas, F. Krell, B. Vo, V. Kolesnikov, T. Malkin, S.-G. Choi,
W. George, A. Keromytis, and S. Bellovin. Blind seer: A scalable private
dbms. In Security and Privacy (SP), 2014 IEEE Symposium on, pages
359–374. IEEE, 2014.
[43] S. Patel, G. Persiano, and K. Yeo. Symmetric searchable encryption with
sharing and unsharing. Cryptology ePrint Archive, Report 2017/973,
2017. http://eprint.iacr.org/2017/973.
[44] Sarvar Patel, Giuseppe Persiano, Kevin Yeo, and Moti Yung. Mitigating
leakage in secure cloud-hosted data structures: Volume-hiding for multi-
maps via hashing.
In Lorenzo Cavallaro, Johannes Kinder, XiaoFeng
Wang, and Jonathan Katz, editors, Proceedings of
the 2019 ACM
SIGSAC Conference on Computer and Communications Security, CCS
2019, London, UK, November 11-15, 2019, pages 79–93. ACM, 2019.
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:16:24 UTC from IEEE Xplore.  Restrictions apply. 
1533
[45] A. Shamir. How to share a secret. Communications of the ACM,
22(11):612–613, 1979.
[46] D. Song, D. Wagner, and A. Perrig. Practical techniques for searching
In IEEE Symposium on Research in Security and
on encrypted data.
Privacy, pages 44–55. IEEE Computer Society, 2000.
[47] E. Stefanov, C. Papamanthou, and E. Shi. Practical dynamic searchable
In Network and Distributed System
encryption with small leakage.
Security Symposium (NDSS ’14), 2014.
[48] United States Census Bureau.
2019 National and State Population
Estimates, December 2019.
[49] Nikolaj Volgushev, Malte Schwarzkopf, Ben Getchell, Mayank Varia,
Andrei Lapets, and Azer Bestavros. Conclave: secure multi-party
In Proceedings of the Fourteenth EuroSys
computation on big data.
Conference 2019 - EuroSys ’19, pages 1–18, Dresden, Germany, 2019.
ACM Press.
[50] Xiao Wang, Alex J. Malozemoff, and Jonathan Katz. EMP-toolkit:
Efﬁcient MultiParty computation toolkit, 2016.
[51] A. Yao. Protocols for secure computations.
In IEEE Symposium on
Foundations of Computer Science (FOCS ’82), pages 160–164. IEEE
Computer Society, 1982.
[52] A. Yao. How to generate and exchange secrets. In IEEE Symposium on
Foundations of Computer Science (FOCS ’86), pages 162–167. IEEE
Computer Society, 1986.
APPENDIX A
ENCRYPTED DOCUMENT DATABASES
We recall
the standard approach to designing an en-
crypted document database from a symmetric key encryption
SKE = (Gen, Enc, Dec) and a multi-map encryption scheme
ΣMM = (Init, Token, Query, AddToken, Add, Resolve). This is
equivalent to the index-based approach to desiogning SSE
schemes from Curtmola et al. [22]. Let Index be an algorithm
that
takes as input a record and outputs label/tuple pairs
and ΣDB = (Init, Token, Query, AddToken, Add, Resolve) be a
(document) database encryption scheme that works as follows:
takes as input a security parameter 1k and
computes (K1, EMM) ← ΣMM.Init(1k) and K2 ←
SKE.Gen(1k). It sets K = (K1, K2) and EDB = EMM
and outputs (K, EDB).
• Init(1k):
• Token(K, q):
It parses K as
q.
ΣMM.Token(K1, q).
takes as input a key K and a query
tk ←
(K1, K2) and outputs
• Query(EDB, tk):
EDB
(EMM, ct1, . . . , ctn),
database
EDB as
computes
ΣMM.Query(EMM, tk) and outputs {cti}i∈I.
takes
and
an
tk.
token
input
as
a
encrypted
It
parses
I ←
• AddToken(K, r):
It parses K as
takes as input a secret key K and
a record r.
(K1, K2) and com-
putes {((cid:96)1, v1), . . . , ((cid:96)m, vm)} ← Index(r). Then,
for all 1 ≤ i ≤ m,
it computes atki ←
ΣMM.AddToken(K1, ((cid:96)i, vi)). Finally, it outputs atk =
(atk1, . . . , atkm, ct), where ct ← SKE.Enc(K2, r).
takes
input
an
encrypted
database EDB and an add token atk.
It parses
and
as
EDB
atk
(atk1, . . . , atkm, ct). For all 1 ≤ i ≤ m, it computes
EMMi ← ΣMM.Add(EDBi−1, atki).
outputs
EDB = (EMMm, ct1, . . . , ctn, ct).
(EMM0, ct1, . . . , ctn)
as
as
It
• Add(EDB, atk):
• Resolve(K, ct): takes as input a secret key K and a
set of ciphertexts ct. It parses K as (K1, K2) and
ct as (ct1, . . . , ctt). For all 1 ≤ i ≤ t, it computes
ri ← SKE.Dec(K2, cti).
Concrete instantiations. In this work, we instantiate ΣMM
with the BIEX-2Lev construction of [30]. The indexing algo-
rithm we use takes a record r as input and, for every ﬁeld/value
pair f:v in r, outputs a label/value pair (f(cid:107)v, r.id). To search
for all records with f = v, it then sufﬁces to query for
q = f(cid:107)v.
We now describe the leakage proﬁle of BIEX-2Lev. Let
(cid:18)(cid:0)w1,1 ∨ ··· ∨ w1,q
(cid:1) ∧ ··· ∧(cid:0)w(cid:96),1 ∨ ··· ∨ w(cid:96),q
(cid:1)(cid:19)
ϕ =
def
= fi,j(cid:107)vi,j. Then the query leakage of BIEX-2Lev
where wi,j
is
Lbiex
Q (DB, ϕ) =
(cid:18)(cid:18)
(cid:18)
qeqg(w1,i), trsize(LMM1,i), qeqd(w1,i),
qeq1,i(w1,i+1), . . . , qeq1,i(w1,q), tag1,i(w1,1, . . . , w1,q)
(cid:19)
,
1≤i≤q−1
(cid:19)
qeq1,1(wj,i), . . . , qeq1,q(wj,i),
tagj,i(w1,i,··· , w1,q)
(cid:19)
2≤j≤(cid:96),1≤i≤q
where tagi,j(w1, . . . , wq) = (fi,j(w1), . . . , fi,j(w1)) with fi,j
a random function, trsize(MM) is a stateful leakage pattern
that reveals the size of the multi-map MM, and qeqX (w) is
a stateful leakage pattern that reveals if and when w was
queried in the past. Note that qeqX and qeqY for X (cid:54)= Y
are not correlated in the sense that given qeqX (w) and
qeqY (w) one cannot tell that the leakages are for the same
w. The leakage proﬁle of BIEX-2Lev is complex and can be
difﬁcult to understand but we note that, currently, BIEX is the
boolean scheme with the smallest leakage proﬁle. To achieve
a better leakage proﬁle, one could use the leakage suppression
techniques of [34].
APPENDIX B
SEMI-DYNAMIC ENCRYPTED MULTI-MAPS
As described in Section V, our protocol relies on a semi-
dynamic database encryption scheme. Using the approach de-
scribed in Appendix A one can construct such a scheme from
a semi-dynamic multi-map encryption scheme and symmetric
key encryption. Since, in our setting, we want support for
boolean queries, we need the multi-map encryption scheme to
also support boolean queries. As far as we know, there are
three sub-linear boolean multi-map encryption schemes: the
scheme that underlies the Blind Seer construction [42], the
boolean variant of OXT [15] and the BIEX construction of
[30]. The latter is the most efﬁcient but is only static so we
describe here how to make it semi-dynamic using a technique
described in [22]. More precisely, given a static multi-map en-
cryption scheme ΣMM = (Setup, Token, Query), we deﬁne a
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:16:24 UTC from IEEE Xplore.  Restrictions apply. 
1534
2PC
send
it
to
EDB
and p2
InitGlobal)
• (simulating
simulate F f
and com-