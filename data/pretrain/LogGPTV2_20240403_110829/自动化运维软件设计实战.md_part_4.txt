它由NSA编写并设计成内核模块包含到内核中，相应的某些安全相关的应用也被打了
1)SELinux是一种基于域-类型模型（domain-type）的强制访问控制（MAC）安全系统，
自动化运维软件设计实战
文件复制的模块常用于做集中下发的动作，假如远端主机装有SELinux，
2.文件复制模块一
delimiter
backup
参
assemble 模块参数及说明如表2.3所示。
dest
例：将/root/demo下的片段文件组装后放到/root/target目录下。
others
src
数
ansible all -m assemble -a'dest=/root/target src=/root/demo'
192.168.41.136
必
是
否
否
否
copy
配置文件B
配置文件A
表2.3assemble模块参数及说明
默认值
图2.2
no
一
copy
组装的方式
选项
yes/no
目标配置文件
192.168.41.139
配置文件片段之间的分隔符
是否创建一份备份文件
片段文件夹路径
文件模块参数
生成路径
说
那么还需要
---
## Page 35
理节点的文件批量地复制到服务器上，可以看作一个文件上传的动作。
validate
others
content
backup
参
src
force
dest
fetch模块参数及说明如表2.5所示。
例：将远端机器的/etc/salt/minion文件收集回服务器的/rot/demo目录下。
fetch 模块和 copy 模块很类似，都是对文件进行复制，但是 fetch 模块的作用是把被管
3.
copy模块参数及说明如表2.4所示。
fail_on_missing
例：
数
文件拉取模块
ansible all -m fetch -a'dest=/root/demo src=/etc/salt/minion
将/root/demo/copydemo.txt复制到所有机器的/root目录下。
dest
数
必
192.168.41.136
否
否
否
否
是
否
否
是
fetch
否
默认值
填
#
1
no
表2.5
表2.4
默认值
fetch模块参数及说明
copy模块参数及说明
no
fetch
选
yes-no
yes/no
项
选
yse/no
项
当用content代替src参数时，可以把文档的内
复制前是否检验需要复制目的地的路径
目标主机名是host，那么就会被存为
/backup，复制的源文件为/etc/profilc，
集中化运维利器一
假如找不到目标文件则标记为失败
文件存放路径，假如存放路径是
192.168.41.139
/backup/host/etc/profilc下
文件复制的目的地
容设置为特定的值
是否备份原始文件
复制的源文件
文件模块参数
是否覆盖
说
说
明
明
Ansible
---
## Page 36
文件，这些都是我们平常需要使用的功能，而fle模块就是为完成上述这些功能而准备的。
自动化运维软件设计实战
ini文件是十分常见的一种配置文件，Ansible内置了ini配置文件的管理模块，用于对
5.ini文件管理模块
参
setype
selevel
recurse
owner
force
file模块参数及说明如表2.6所示。
例：删除所有服务器下的/root/copydemo.txt文件。
文件自身有许多属性，例如修改文件所属的用户组、文件所属的用户、是否需要删除
seuser
serole
path
mode
group
4.
state
src
validate_md5
数
文件管理模块
参
ansible all -m file -a'path=/root/copydemo.txt state=absent
flat
src
数
必
否
否
否
否
否
否
是
否
否
填
-file
是
否
表2.6file模块参数及说明
默认值
no
no
默认值
no
选
选
directory
yse/no
yse/no
yse/no
absent
touch
hard
link
file
一
一
一
项
项
如果是directory，那么则会创建文件夹
如果是touch，则会创建一份文件
如果是是hard，则创建硬链接
是否用md5进行文件的校验
用于覆写原有的dest存放规则
如果是absent，则会删除文件
如果是link，则会创建链接
如果是file，则会创建文件
是否递归设置属性
文件的属于的用户
文件的读/写权限
文件属于的用户组
是否覆盖原有文件
文件链接路径
selinux的级别
目标文件路径
selinux用户
selinux类型
selinux角色
文件路径
说
说
明
（续表）
---
## Page 37
上也是不能使用的。
令是获取不到SHOME这样的环境变量的，
option=crontime value=10'
的值修改为10。
ini文件进行配置项的管理。
）imi文件由节（section）参数（name=value）和注释所组成，格式如下：
command模块用于在给定的主机上执行命令。值得留意的是，command模块执行的命
backup
参
command模块参数及说明如表2.8所示。
2.4.2
section
others
option
ini模块参数及说明如表2.7所示。
例：修改/root/demo.ini配置文件，
1.命令执行模块
value
dest
creates
chdir
name=value
[section]
数
ansible
命令执行模块
this is comment
必
all
否
必
是
否
否
否
填
否
command
填
-m
表2.8command模块参数及说明
ini_file
表2.7ini模块参数及说明
默认值
默认值
selection为cron的选项组的crontime选项，把cron
一些运算符，例如“>”、“>Spath
echo
echo
echo
echo
echo
echo
echo
echo
echo
echo
echo
echo
echo-e"">$path
path=inspection.txt
day03='date+%d
day02='date+%m
day01='date+%Y
mem_total='grep MemTotal
"Size|Locator"|grep-v Bank'
{print $2}'lawk'(print $1)'
system_load='cat /proc/loadavg'
system_uptime='uptime'
disk_usage='df -h'
mem_free='grep MemFree/proc/meminfo'
system_envirement_variables='env Igrep PATH'
system_hostname='hostname'
system_version='head -n 1 /etc/issue
system_core='uname -r
cpu_freq='cat/proc/cpuinfo|grep MHz|uniq 1awk-F:'(print $2}
cpu_core_num='cat/proc/cpuinfo 1grep"cores"|uniqlawk-F:(print $2)'
#!/bin/bash
-e
-e
#
-e牛