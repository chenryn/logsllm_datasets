自动化攻击背景下的过去、现在与未来
@ringzero
2
关于我
• 网名：猪猪侠
• 8年信息安全从业经历
• 信息安全领域爱好者
• 安全测试
• 数据挖掘
• 微博：@ringzero
我的安全观：互联网的本质
3
互联网的本质就两个字：信息
信息只做一个用处就是：交换
我的安全观：互联网下信息安全的本质
4
互联网：
连接彼此，交换信息。
信息安全：
保护信息在交换(传递)过程
中的完整性、可用性、保密
性。
我的安全观：连接彼此 交换信息
 与目标系统进行信息交换
 可以发起交换的请求
 耦合度高被攻击可能性越大
 涟漪效应
信息传递的客体对象、社会信息背
后的属性，都和人有关
人们的愚蠢没有补丁可打
八大典型APT：越来越趋向针对个人 （最容易成功）
6
APT
RSA 
SecurID
被窃
夜龙攻击
Stuxnet
震网
Google
极光攻击
Luckycat
攻击
Nitro攻击
Lurid
攻击
暗鼠攻击
诱骗员工点击
恶意链接附件
Web服务器
被作为跳板
定向钓鱼
恶意邮件
定向钓鱼
恶意邮件
定向钓鱼
恶意邮件
定向钓鱼
恶意邮件
定向钓鱼
恶意邮件
军火级别
政治武器
DUQU 
FLAME
•
利用已知漏洞寻找目标
•
重度依赖搜索引擎
•
工具交互模式固定不可扩展(多以Windows为主)
•
流程化的利用模式
过去发起的攻击方式
7
回顾过去的攻击方式：三字经
8
进谷歌 找记录
没记录 就旁注
没旁注 猜目录
没目录 就嗅探
找后台 穷枚举
传小马 放大马
偷密码 挂页面
提权限 扫内网
•
模块化高可扩展(脚本Python)
•
系统、服务、组件指纹标准化入库
•
高覆盖率（分布式全球节点）
•
重新定义网络边界(Socks5代理、隧道)
现在 (脚本套脚本，一键完成)
9
1、深度扫描流程
11
WOOYUN
扫描目标
添加
自动分析
分解目标
深度信息
采集
指纹识别
入库
漏洞脚本库
队列执行
漏洞验证
返回结果
2、添加扫描任务
12
WOOYUN
2、添加扫描任务 (指定域名)
13
WOOYUN
① DNS 域传送漏洞
② DNS 二级域名穷举
③ GOOGLE 搜索域名
① 域名IP C段加入队列
② MX记录C段加入队列
③ 爱站反查已添加的IP
开始扫描任务
3、信息收集（IP 信息）
14
WOOYUN
3、信息收集（服务端口指纹信息）
15
WOOYUN
爬取首页，记录HTTP头
3、信息收集（域名信息 通过爱站、BING反查域名 入库）
16
WEB指纹识别
4、WEB指纹识别条件库
17
4、WEB指纹识别 返回网页内容中是否包含特定 HTTP头
18
4、WEB指纹识别 文件MD5对比 存在特定文件?）
19
5、WEB漏洞库管理模块
20
6、WEB漏洞测试方法 正则匹配特定变量
21
7、脚本管理 定义好传入参数 URL & IP:端口）
22
7、深度扫描（为漏洞扫描脚本 分配目标 填充参数）
23
7、深度扫描（脚本依据SQL条件分配扫描参数）
24
8、指纹识别入库、扫描结果入库
25
WOOYUN
添加目标
自动分解
自动采集
自动入库
队列下发
等待结果
未来可强化的地方
26
 信息收集效率(更丰富的收集规则)
 资源整合能力（第三方数据整合）
 覆盖率
 误报率
 漏洞规则库（更多的漏洞模块化）
信息收集效率 (1467项 Google Hacking Database)
27
GHDB
Files containing juicy info ( 225 )
Web Server Detection ( 75 )
Error Messages ( 67 )
Files containing usernames ( 14 )
Files containing passwords ( 138 )
Sensitive Directories ( 60 )
Vulnerable Servers ( 48 )
Footholds ( 21 )
Advisories and Vulnerabilities ( 223 )
Miscellaneous ( 12 )
Pages containing network or vulnerability data ( 60 )
Pages containing login portals ( 233 )
Various Online Devices ( 195 )
Sensitive Online Shopping Info ( 9 )
Vulnerable Files ( 56 )
Technology profile ( 32 )
漏洞规则库（330个通用漏洞利用脚本）
28
Apache Geronimo Default Administrative Credentials.script
Pending
Apache httpOnly Cookie Disclosure.script
Pending
Apache mod negotiation Filename Bruteforcing.script
Pending
Apache Proxy CONNECT Enabled.script
Pending
Apache Roller Audit.script
Pending
Apache Running As Proxy.script
Pending
Apache Server Information.script
Pending
Apache Solr Exposed.script
Pending
Apache Unfiltered Expect Header Injection.script
Pending
Apache XSS via Malformed Method.script
Pending
ASP NET Error Message.script
Pending
ASP NET Forms Authentication Bypass.script
Pending
ASP NET Oracle Padding.script
Pending
Clickjacking X Frame Options.script
Pending
ClientAccessPolicy XML.script
Pending
ColdFusion Audit.script
Pending
ColdFusion User Agent XSS.script
Pending
ColdFusion v8 File Upload.script
Pending
ColdFusion v9 Solr Exposed.script
Pending
Crossdomain XML.script
Pending
Django Admin Weak Password.script
Pending
elasticsearch Audit.script
Pending
elmah Information Disclosure.script
Pending
Error Page Path Disclosure.script
Pending
Fantastico Filelist.script
Pending
漏洞规则库（330个通用漏洞利用脚本）
29
Flask Debug Mode.script
Pending
Frontpage authors pwd.script
Pending
Frontpage Extensions Enabled.script
Pending
Frontpage Information.script
Pending
GlassFish Audit.script
Pending
Heartbleed Bug.script
Pending
Horde IMP Webmail Exploit.script
Pending
IIS Global Asa.script
Pending
IIS Internal IP Address.script
Pending
IIS service cnf.script
Pending
IIS Unicode Directory Traversal.script
Pending
IIS v5 NTML Basic Auth Bypass.script
Pending
Ioncube Loader Wizard.script
Pending
JBoss Audit.script
Pending
Jenkins Audit.script
Pending
lighttpd v1434 Sql Injection.script
Pending
Lotus Domino crlf xss.script
Pending
MongoDB Audit.script
Pending
Movable Type 4 RCE.script
Pending
ms12-050.script
Pending
Nginx PHP FastCGI Code Execution File Upload.script
Pending
Options Server Method.script
Pending
Oracle Reports Audit.script
Pending
Flask Debug Mode.script
Pending
Frontpage authors pwd.script
Pending
漏洞规则库（330个通用漏洞利用脚本）
30
PHP CGI RCE Force Redirect.script
Pending
PHP Hash Collision Denial Of Service.script
Pending
Plesk Agent SQL Injection.script
Pending
Plesk SSO XXE.script
Pending
Plone&Zope Remote Command Execution.script
Pending
Rails XML YAML.script
Pending
Reverse Proxy Bypass.script
Pending
RubyOnRails Database File.script
Pending
Same Site Scripting.script
Pending
SSL Audit.script
Pending
Tomcat Audit.script
Pending
Tomcat Default Credentials.script
Pending
Tomcat Examples.script
Pending
Tomcat Hello JSP XSS.script
Pending
Tomcat Status Page.script
Pending
Track Trace Server Methods.script
Pending
Umbraco CMS Remote Code Execution.script
Pending
Unprotected phpMyAdmin Interface.script
Pending
Version Check.script
Pending
VirtualHost Audit.script
Pending
VMWare Directory Traversal.script
Pending
WAF Detection.script
Pending
WebInfWebXML Audit.script
Pending
WEBrick Directory Traversal.script
Pending
Web Server Default Welcome Page.script
Pending
扫描成本
31
10台机器
2核心 4GB内存 5M 带宽
7 天一个 A 段
255 * 7 = 1785 / 30 = 60 个月
10台 * 60个月 * 270/月 = 162000 RMB
当摩尔定律成为灾难
32
个人超算 GPU
廉价的云计算
僵尸网络—肉鸡
一些用心优化的细节 （成功率提升匪夷所思）
33
 用户常用口令设置规则
 常用特定URL目录字典库积累
 等等……
互联网泄密事件 10亿多条明文密码
34
3175万
1828万
1833万
1389万
907万
828万
642万
444万
15000万
10000万
4200万
60000万
WeakPassword Top 100 (中国特色)
35
1
123456
16
1234
31
qwertyuiop
46
abc123
61
asdasd
76
qwe123
2
123456789
17
1314520
32
woaini
47
100200
62
741852963
77
456123
3
111111
18
wetrsvqw1e123
33
password
48
1111111111
63
iloveyou
78
aaaaaaaa
4
123123
19
123123123
34
00000000
49
123qwe
64
asdfgh
79
111111111
5
000000
20
654321
35
88888888
50
qq123456
65
123456789a
80
asd123
6
12345678
21
147258369
36
asdfghjkl
51
123456789
66
555555
81
0000000000
7
1234567890 22
zxcvbnm
37
520520
52
7758258
67
1qaz2wsx
82
456789
8
5201314
23
888888
38
12345
53
110110
68
1314521
83
abc123456
9
1234567
24
7758521
39
147258
54
159357
69
521521
84
163.com
10
123321
25
123
40
5211314
55
222222
70
12345678910
85
333333
11
a123456
26
112233
41
qwerty
56
789456
71
123654789
86
q123456
12
11111111
27
aaaaaa
42
1111111
57
qazwsx
72
qqqqqq
87
201314
13
12341234
28
123456a
43
789456123
58
0123456789
73
woaini1314
88
qazwsxedc
14
666666
29
123654
44
121212
59
159753
74
1111
89
5651468
15
33333333
30
987654321
45
a123456789
60
999999
75
111222
90
密码统计 ( TOP 100 密码使用数量统计 )
36
总排行
CSDN
天涯
口令
数量
口令
数量
口令
数量
123456
42611564
123456789
470024
123456
2456830
123456789
18851830
12345678