m.edu.c
---
## Page 65
65
3.便用广播信道的数据链路层
3.4CSMA/CD协议
准备发送
等待随机时间
载波侦听
是，信道忙
CSMA/CD
侦听到
载波？
协议工作流程
否
开始发送，
同时进行碰撞检测
+
检测到
停止发送
碰撞？
否
发送，直到完毕
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 66
66
3.便用广播信道的数据链路层
3.4CSMA/CD协议
口尽管使用了"碰撞检测"机制，但是在以太网上还是会发生碰撞的情况。
■A需要单程传播时延的 2倍的时间，才能检测到与B 的发送产生了冲突。
碰撞
1 km
A
B
0=1
B发送数据
t=－8（德尔塔)
A 检测到发生碰撞
t= π(套)
单程端到端
t= 2t -8
B检测到发生碰撞
传播时延记为t
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 67
67
3.便用广播信道的数据链路层
3.4 CSMA/CD 协议
碰撞
1 km
A
B
B发送数据
t=0
t=-8
A检测到发生碰撞
=1
t= 2t-8
单程端到端传播时延记为t
B检测到发生碰撞
t=0
B
A 检测到信道空闲，发送数据
t=t-8
B检测到信道空闲，发送数据
t=t-8/2
3
发生碰撞
t=t
STOP
B 检测到发生碰撞，停止发送
STOP
t= 2t -8
A 检测到发生碰撞
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 68
68
3.使用广播信道的数据链路层
3.4CSMA/CD协议
最先发送数据帧的站，在发送数据帧后至多经过时间2t（两倍的端到端
往返时延）就可知道发送的数据帧是否遭受了碰撞。
以太网的端到端往返时延2t称为争用期，或碰撞窗口。
■经过争用期这段时间还没有检测到碰撞，才能肯定这次发送不会发生碰撞。
河南中医药大学信息技
---
## Page 69
69
3.使用广播信道的数据链路层
3.4CSMA/CD协议
发生碰撞的站在停止发送数据后，要推迟（退避）一个随机时间才能再
发送数据。
口以太网使用二进制指数类型退避算法来确定碰撞后重传的时机
■基本退避时间取值为争用期 2t
■从整数集合[0,1,.，（2k-1)]中随机地取出一个数，记为r。重传所需的时延就是r倍的基
本退避时间。
■参数k按下面的公式计算：k=Min[重传次数，10]
■当k不大于10时，参数k等于重传次数；当k大于10时，参数k等于10。
1当重传达16次仍不能成功时即去弃该倾，并向高层报告。
---
## Page 70
70
3.使用广播信道的数据链路层
3.4 CSMA/CD 协议
口以太网取51.2μs为争用期的长度。（这是经验值）
对于10Mbps以太网，在争用期内可发送512bit，即64字节。
■以太网在发送数据时，若前64字节没有发生冲突，则后续的数据就不会发生
冲突。
■如果发生冲突，就一定是在发送的前64字节之内。
节。
以太网规定了最短有效帧长为64字节，凡长度小于64字节的帧都是由于冲突
而异常中止的无效帧。
m.edu.cr
---
## Page 71
71
3.使用广播信道的数据链路层
3.4 CSMA/CD 协议
当发送数据的站一旦发现发生了碰撞时：
立即停止发送数据
■继续发送若干比特的人为干扰信号（jamming signal)，以便让所有用户都知
道现在已经发生了碰撞
口这样的机制叫做"强化碰撞”。
河南中医药大学信息技
---
## Page 72
72
3.便用广播信道的数据链路层
3.4CSMA/CD协议
冲突
A
B
A发送数据
B发送数据
发生冲突
g
信道占用时间
A发给B的数据帧
A检测到冲突
T
32或48比特干扰信号
T
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 73
73
3.使用广播信道的数据链路层
3.4CSMA/CD协议
口使用CSMA/CD协议的以太网不能进行全双工通信，而只能进行双向交
替通信（半双工通信）。
■每个站在发送数据之后的一小段时间内，存在着遭遇碰撞的可能性。
■这种发送的不确定性使整个以太网的平均通信量远小于以太网的最高数据率。
河南中医药大学信息技
---
## Page 74
74
3.便用广播信道的数据链路层
3.4 CSMA/CD 协议
等待随机时间
准备发送
截断二进制指数算法
载波侦听，检测信道
CSMA/CD
侦听到载波
是，信道忙
协议的要点
否
96bit时间内仍然空闲，开始发送
发送人为干扰信号
同时进行碰撞检测
是，发送失败
检测到碰撞？
停止发送数据
否
发送，直到完毕
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 75
75
3.便用广播信道的数据链路层
3.5使用集线器的以太网
传统以太网传输媒体：粗同轴电缆→细同轴电缆→双绞线
采用双绞线的以太网采用星形拓扑。
在星形的中心则增加了一种可靠性非常高的设备，叫做集线器
 (hub)。
工作站（节点）
一终端电阻器
Z型连接器
同轴电缆总线
---
## Page 76
76
3.便用广播信道的数据链路层
3.5使用集线器的以太网
口1990年，TEEE制定出星形以太网10BASE-T的标准802.3i。
10BASE
T
T
双绞线
基带
速率为10Mbit/s
口由于使用双绞线和集线器的网络，其可靠性和易用性大大提升，并且使
用双绞线电缆的以太网价格便宜，因此粗同轴电缆和细同轴电缆的以太
网就逐步从市场上消失了。
m.edu.c1
---
## Page 77
77
3.使用广播信道的数据链路层
3.5使用集线器的以太网
送和接收。
口10BASE-T以太网的通信距离稍短，每个站到集线器的距离不超过100m。
1OBASE-T双绞线以太网的出现，是局域网发展史上的一个非常重要的里程碑
它为以太网在局域网中的统治地位奠定了牢固的基础。
河南中医药大学信息技
---
## Page 78
78
3.使用广播信道的数据链路层
3.5使用集线器的以太网
集线器是使用电子器件来模拟实际电缆线的工作，因此整个系统仍然像
一个传统的以太网那样运行。
使用集线器的以太网在逻辑上仍是一个总线网，各工作站使用的还是
CSMA/CD协议，并共享逻辑上的总线。
集线器很像一个多接口的转发器，工作在物理层。
口集线器采用了专门的芯片，进行自适应串音回波抵消，减少了近端串音。
---
## Page 79
79
3.便用广播信道的数据链路层
3.5使用集线器的以太网
具有三个接口的集线器的逻辑结构
双绞线
网卡
网卡
网卡
工作站
工作站
工作站
河南中医药大学信息技术学院互联网技术教学团队／https://internet.hactcm.edu.cn
---
## Page 80
80
3.使用广播信道的数据链路层
3.6以太网的信道利用率
口以太网信道被占用的场景：
■发送数据的时间。
■发送数据结束后，等待最后一个bit传送到接收方的等待时间。
■发生碰撞的争用期。
■没有数据传送的空闲时间。
口发送数据的时间在总时间的占用率，就是通俗意义上的信道利用率
---
## Page 81
81
3.便用广播信道的数据链路层
3.6以太网的信道利用率
发生碰撞
占用期
争用期
争用期
争用期
发送成功
2T-
2T
-2T
发送一帧所需的平均时间
个站在发送帧时出现了碰撞。经过一个争用期2后，可能又出现了碰撞。
这样经过若干个争用期后，一个站发送成功了。
假定发送帧需要的时间是T
cm.edu.cn
---
## Page 82
82
3.便用广播信道的数据链路层
3.6以太网的信道利用率
口要提高以太网的信道利用率，就必须减小与“。之比
■在以太网中定义了参数a，它是以太网单程端到端时延与帧的发送时间To
之比:
T
a=
a→〇表示一发生碰撞就立即可以检测出来，并立即停止发送。
·因而信道利用率很高。
口a越大，表明争用期所占的比例增大
·每发生一次碰撞就浪费许多信道资源，使得信道利用率明显降低。
河南中医药大学信息技术
1.edu.c
---
## Page 83
83
3.使用广播信道的数据链路层
3.6以太网的信道利用率
口要提高以太网的信道利用率，就必须减小与T。之比
■在以太网中定义了参数a，它是以太网单程端到端时延与帧的发送时间To
之比:
2
a=
为提高利用率，以太网的参数a的值应当尽可能小些。
当数据率一定时，以太网的连线的长度受到限制，否则的数值会太大。
■以太网的帧长不能太短，否则T。的值会太小，使 a值太大。
---
## Page 84
84
3.使用广播信道的数据链路层
3.6以太网的信道利用率
理想化的情况下，以太网上的各站发送数据都不会产生碰撞，总线一旦
空闲就有某一个站立即发送数据。
发送一帧占用线路的时间是To+T，而帧本身的发送时间是To。
■可计算出理想情况下的极限信道利用率Smax为：
占用期
T
1
发送成功
max
2+L
1+a
To
发送一帧所需时间
---
## Page 85
85
3.便用广播信道的数据链路层
3.6以太网的信道利用率
极限信道利用率Smax为：
不
T
max
2+L
1+a
■结论：
口只有当参数a 远小于1才能得到尽可能高的极限信道利用率。
口若参数 a 远大于1，极限信道利用率就远小于 1，实际信道利用率就更低。
口据统计，当以太网的利用率达到30%时就已经处于重载的情况。
河南中医药大学信息技术学院互联网技术教学团队
n.edu.cr
---
## Page 86
86
3.便用广播信道的数据链路层
3.7以太网的MAC层
口在局域网中，硬件地址又称为物理地址，或MAC地址。
802标准所说的"地址"严格地讲应当是每一个站的"名字"或标识符。
1大家都早已习惯了将这种48位的"名字"称为"地址”，所以我们也采用这种习惯
用法，尽管这种说法并不太严格。
口MAC地址就是计算机系统中的一种标识系统（identificationSystem）。
■著名文献【SHOC78】对标识系统的定义：
口名字指出我们所要寻找的那个资源。
口地址指出那个资源在何处
口路由告诉我们如何到达该处
---
## Page 87
87
3.便用广播信道的数据链路层
3.7以太网的MAC层
口MAC层讨论两个问题：
1.
MAC地址
2.
MAC帧格式
河南中医药大学信息技术学院互联网技术教学团队
cm.edu.cn
---
## Page 88
88
3.便用广播信道的数据链路层
3.7以太网的MAC层
MAC地址：
■IEEE802规定，MAC地址字段可以使用6字节（48位）或者2字节（16位)
两种表示方式。
随着以太网的迅猛发展，6字节的表示方法可以使得全世界所有的局域网都
使用不相同的地址，因此目前主要使用6字节的方式来表示MAC地址。
3字节 (24位)
3字节 (24位)
组织唯一标识符
扩展唯一标识符
48位的MAC地址（EUI-48）
n.edu.cr
---
## Page 89
89
3.使用广播信道的数据链路层
3.7以太网的MAC层
口MAC地址:
IEEE注册管理机构RA 负责向厂家分配前3个字节（即高 24 位)，称为组织
唯一标识符 OUl (Organizationally Unique ldentifier)。
厂家自行指派后3个字节（即低 24位)，称为扩展标识符(extended
identifier)。
■必须保证生产出的适配器没有重复地址。
■地址被固化在适配器的 ROM 中。
---
## Page 90
90
3.便用广播信道的数据链路层
3.7以太网的MAC层
口MAC地址：
■IEEE规定地址字段的第一个字节的最低位为I/G位。
口单站地址：I/G位=0。
口组地址：I/G位=1。组地址用来进行多播。
口广播地址：所有48位都为1（全 1)。只能作为目的地址使用。
■IEEE规定地址字段的第一个字节的最低第二位为G/L位。
全球管理：G/L 位=O。厂商向IEEE购买的○UI都属于全球管理
口本地管理：G/儿位=1。用户可任意分配网络上的地址。
n.edu.cr
---