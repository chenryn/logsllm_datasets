Botnet and Malware 
behavior analysis
蔡一郎
2010/07/17
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 蔡一郎 Steven
 学历：国立成功大学电机工程研究所硕士
 现任：国家高速网路与计算中心 副工程师
 重要经历：
 国立成功大学研究发展基金会助理研究员
 昆山科技大学兼任讲师
 台南科学园区产学协会理事
 Honeynet Project Taiwan Chapter负责人
 自由作家
 电脑图书著作33本
 Information Security(资安人)、Linux Guide、NetAdmin专栏，计60余篇
 专业证照：
 RHCE、CCNA、CCAI、CEH、CHFI、ACIA、ITIL Foundation、ISO 27001 
LAC、ISO 20000 LAC
2
Google Me.
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
Outline
 Honeynet and Botnet
 Honeynet Project introduction
 Taiwan Chapter introduction
 What is Honeypot and Honeynet
 Honeynet Project Tools
 TWMAN
3
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 Where can find Malware sample?
 User、provider、Honeynet…
 What is the behavior about Botnet?
 Network connection、system modify…
 Multi Function
 bots
4
Honeynet and Botnet
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 Non-profit (501c3) organization with Board of Directors.
 Funded by sponsors
 Global set of diverse skills and experiences.
 Open Source, share all of our research and findings at no 
cost to the public.
 Deploy networks around the world to be hacked.
 Everything we capture is happening in the wild.
 We have nothing to sell.
5
Honeynet Project introduction
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 A community of organizations actively researching, 
developing and deploying Honeynets and sharing the 
lessons learned.
 Awareness: 增进企业与组织对存在于现行网路上的威胁与
弱点之了解，进一步思考如何去减轻威胁的方法
 Information: 除了提供基本的攻击活动外，进一步提供更关
键性的资料，如: 攻击动机，骇客间如何联络，骇客攻破主机
后下一步的攻击动作
 Tools: Honeynet Project 致力于发展 Open Source Tools，藉
由这些Tools，我们可以更有效率的布建诱捕系统了解网路环
境攻击威胁现况
6
Honeynet Project Mission
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
7
Honeynet Project 全球支会分布
Taiwan Chapter
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 What is a Honeynet ?
 High-interaction Honeypot
 It is an architecture, not a product or software
 Populate with live systems
 Once compromised, data is collected to learn the tools, tactics, and 
motives of the Blackhat community 
 Value of Honeynet 
 Research : Identify new tools and new tactics, Profiling Blackhats
 Early warning and prediction 
 Incident Response / Forensics
 Self-defense
8
Honeypot/Honeynet Technology 
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 Hundreds of scans a day.
 Fastest time honeypot manually compromised, 15 minutes 
(worm, under 60 seconds).
 Life expectancies: vulnerable Win32 system is under three 
hours, vulnerable Linux system is three months.
 Primarily cyber-crime, focus on Win32 systems and their 
users.
 Attackers can control thousands of systems (Botnets).
9
The Threat
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 Large networks of hacked systems.
 Often thousands, if not tens of thousands, of hacked 
systems under the control of a single user.
 Automated commands used to control the ‘zombies’.
10
Botnets
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 After successful exploitation, a bot uses TFTP, FTP, or 
HTTP to download itself to the compromised host. 
 The binary is started, and connects to the hard-coded 
master IRC server. 
 Often a dynamic DNS name is provided rather than a 
hard coded IP address, so the bot can be easily 
relocated. 
 Using a special crafted nickname like USA|743634
the bot joins the master's channel, sometimes using a 
password to keep strangers out of the channel
11
How They Work
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
12
Bots
ddos.synflood [host] [time] [delay] [port]
starts an SYN flood
ddos.httpflood [url] [number] [referrer] [recursive = true||false]
starts a HTTP flood
scan.listnetranges
list scanned netranges
scan.start
starts all enabled scanners
scan.stop
stops all scanners
http.download
download a file via HTTP
http.execute
updates the bot via the given HTTP URL
http.update
executes a file from a given HTTP URL
cvar.set spam_aol_channel [channel]
AOL Spam - Channel name
cvar.set spam_aol_enabled [1/0]
AOL Spam - Enabled?
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
13
IRC BOT
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 Botnets sold or for rent.
 Saw Botnets being stolen from each other.
 Observed harvesting of information from all  compromised 
machines. For example, the operator of the botnet can 
request a list of CD-keys (e.g. for Windows or games) 
from all bots. These CD-keys can be sold or used for other 
purposes since they  are considered valuable information. 
14
Botnet  Economy
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
A highly controlled network where every packet entering or 
leaving is monitored, captured, and analyzed.
 Data Control
 Data Capture
 Data Analysis
15
How it works
http://www.honeynet.org/papers/honeynet/
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
Honeynet Project Tools
 Capture BAT
 Capture-HPC
 Google Hack Honeypot
 HIHAT(High Interaction 
Honeypot Analysis Toolkit
 HoneyBow
 HoneyC
 Honeyd
16
 Honeymole
 Honeysnap
 Honeystick
 Honeytrap
 Honeywall CDROM
 nepenthes
 Pehunter
 Sebek
 Tracker
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
17
Honeynet Project Tools
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 Virtual Machine Honeynet
 Advanced Server(128GB Memory)
 Blade Server(SAS or SSD HDD)
 VMWare ESX/vSphare
 1200+ Servers, Windows XP/Vista, Linux, FreeBSD
 High Interaction and Low Interaction Honeypots
 Distribution Honeynet/Honeypot
 Taiwan Education Network 
 Taiwan Chapter members 
 GDH Project
18
Our Environment
Honeynet Project Taiwan Chapter                                                       www.honeynet.org.tw
 Large-Scale VM-based Honeynet 
Deployment