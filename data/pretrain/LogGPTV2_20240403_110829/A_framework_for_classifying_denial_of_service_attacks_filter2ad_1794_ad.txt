periment with each source at different locations around the Inter-
net. Figure 10(a) shows the spectrum of a single synthetic attacker
located at UMass. The spectrum lacks the distinct peaks of Fig-
ure 9(a). We believe this smoothing is due to a larger amount of
cross trafﬁc and more variation in transit time than with a single at-
tacker in the clustered topology. The normalized cumulative spec-
trum is robust to this effect, with both single-source attacks show-
ing nearly linear trends.
Comparing Figure 10(a) to Figures 10(b) and 10(c), we see a
shift in the spectrum to lower frequencies, with F (60%) at 43Hz
and 35Hz for 2 and 3 sources, as compared to 328Hz for a single-
source. Again, we believe this is due to the presence of multiple,
unsynchronized sources.
Figure 11 summarizes the F (60%) results for 30 experiments
conducted at different times of the day. The experiments show a
localization of power in lower frequencies as the number of sources
increase from 1–5 in both clustered and the distributed topologies.
As seen in Figure 11, the F (60%) is close to 300Hz during single-
source experiments, but reduces to 100Hz when more sources are
introduced. The experiments indicate that although the absolute
value of F (60%) differs from one experiment to the next, the multi-
source attacks always have a lower F (60%) in both topologies,
qualitatively conﬁrming our attack observations at Los Nettos.
To conﬁrm the above results are not due to characteristics unique
to the synthetic attack trafﬁc generated by Iperf, we conducted ex-
periments with real DoS attack tools on a dumbbell-shaped topol-
ogy consisting of 12 hosts, four hubs and two Cisco routers (we
could not deploy the attack tools on the clustered and distributed
topologies due to signature-based IDS monitoring tools). The testbed
provides a low latency (less than 1ms), high bandwidth (100Mbits/s)
connection between the attackers and the victim. We generated at-
tack trafﬁc using three DoS tools: punk, stream, and synful, and
web-based background trafﬁc with WebStone [37]. All three attack
tools produced spectral characteristics similar to Figure 11, in both
single- and multi-source experiments.
These experiments conﬁrm the presence of multiple attackers
changes the attack spectrum, and that the F (60%) is a reason-
ably robust discriminator between single- and multi-source attacks.
They do not completely explain, however, the reasons why multiple
attackers shift the spectrum; we consider that next.
6.3 Understanding Multi-Source Effects
Although Section 6.2 conﬁrms the validity of using spectral anal-
ysis to discriminate between single- and multiple-sources, it does
not explain why spectral content is a good discriminator. To un-
derstand the physical meaning behind the shift in F (60%) to lower
frequencies, we considered three hypotheses:
)
f
(
S
)
f
(
C
)
f
(
S
)
f
(
C
 120
 100
 80
 60
 40
 20
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
Frequency (Hz)
 450
 400
 350
 300
 250
 200
 150
 100
 50
 0
 1
 0.8
 0.6
 0.4
 0.2
)
f
(
S
)
f
(
C
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
Frequency (Hz)
 500
 450
 400
 350
 300
 250
 200
 150
 100
 50
 0
 1
 0.8
 0.6
 0.4
 0.2
)
f
(
S
)
f
(
C
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
Frequency (Hz)
 0
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
 0
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
 0
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
Frequency (Hz)
Frequency (Hz)
Frequency (Hz)
(a) One Source
(b) Two Sources
(c) Three Sources
Figure 9: WAN experiments using a clustered topology.
 2
 1.8
 1.6
 1.4
 1.2
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
Frequency (Hz)
 2000
 1800
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
 1
 0.8
 0.6
 0.4
 0.2
)
f
(
S
)
f
(
C
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
Frequency (Hz)
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
 1
 0.8
 0.6
 0.4
 0.2
)
f
(
S
)
f
(
C
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
Frequency (Hz)
 0
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
 0
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
 0
 0
 50
 100
 150
 200
 250
 300
 350
 400
 450
 500
Frequency (Hz)
Frequency (Hz)
Frequency (Hz)
(a) One Source
(b) Two Sources
(c) Three Sources
Figure 10: WAN experiments using a distributed topology.
Clustered
Distributed
by a scaling factor s, with artiﬁcial added jitter denoted by , to
generate a scaled trace. Therefore the aggregate trace is given by:
a1(t) = a(t) + a((s + )t)
(7)
We use the packet trace from the single-source clustered experi-
ment (Figure 9(a)) and vary the scaling factor from 0.5 to 2 repre-
senting attackers with rates varying from twice to half the original
attack rate respectively ( is uniformly distributed between 1–5µs).
The scaled trace is then aggregated with the original attack trace us-
ing the approach deﬁned by Kamath et al. [18]. If Hypothesis 1 is
true, then a change in the attack rate should cause a corresponding
change in F (60%). However, we observe F (60%) remains nearly
constant even when aggregated with an attacker with dissimilar at-
tack rates. Hence we reject Hypothesis 1.
To test Hypothesis 2 we capture a packet arrival sequence on the
attacker host and ﬁlter the arrival sequence to delay transmission
until p packets (p varies from 5–15) have arrived, sending out all
the packets at once. The spectra created by this process has a clus-
ter of prominent frequencies around 320Hz with very little power
(less than 15%) in the lower frequency band. The normalized cu-
mulative spectrum has a sharp rise between 300–320Hz which is
unlike spectra we have observed earlier. We therefore discarded
Hypothesis 2.
To test Hypothesis 3, we aggregate a shifted attack trace with the
original attack trace to simulate aggregation of attackers at different
phases. If a(t) represents the packet arrival sequence in the original
trace, we add a phase φ, with jitter , to generate a shifted trace.
Therefore the aggregate trace is given by:
a3(t) = a(t) + a(t + φ + )
(8)
 500
 450
 400
 350
 300
 250
 200
 150
 100
 50
)
z
H
(
)
%
0
6
(
F
 0
 0
 1
 2
Number of Sources
 3
 4
 5
Figure 11: Localization of power as the number of sources in-
crease in both clustered and distributed topologies. The error
bars show 95% conﬁdence intervals for the experiment.
1. Aggregation of multiple sources at either slightly, or very dif-
ferent rates.
2. Bunching of trafﬁc due to queuing behavior (analogous to
ACK compression [23], but for data).
3. Aggregation of multiple sources, each at different phase.
To investigate these hypotheses we perform simple numerical
simulations. Due to space constraints we omit plots support our
rejected hypotheses; interested readers are referred to a companion
technical report [15]. To test Hypothesis 1, we aggregate a scaled
attack trace with the original attack trace to simulate aggregation
of multiple attackers at different rates. If a(t) represents the packet
arrival sequence in the original trace, we multiply the time-stamp