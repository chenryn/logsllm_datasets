–  实际上⽆无需测试，请遵守法律律法规 
–  通过修改开源BTS，增⼤大C2 
•  另外实现GPRS流量量控制 
软件⽆无线电介绍 
•  ⼀一种可以接收（发送）⼴广泛频率的⽆无线电信号的
设备 
•  并且把模拟信号转换成数字信号 交给计算机处理理 
开源GSM BTS 
•  软件： 
–  OpenBTS（难安装） 
–  YateBTS（基于OpenBTS代码，可视化，容易易安装） 
–  OpenBSC(包含BTS，代码重写，规范，庞⼤大，难安装) 
•  硬件： 
–  USRP系列列（B系列列偏频⽐比较严重） 
–  Bladerf x40（频率精准） 
•  So 我们选择YateBTS+Bladerf x40 
如何实现 
•  BTS中⼩小区重选参数C2⽆无法
设置或失效 
–  ⼲干脆代码⾥里里写死，最⾼高值 
•  基站配置参数 
–  MMC、MNC需要与sim卡中⼀一
样 
•  *#0011# 
–  获取较弱的频点 
•  使⽤用⼯工程机、GSM模块at指令 
•  SDR扫描⼯工具，例例如kalibrate-rtl 
其他配置 
•  基础配置 
–  选择频段与频点 
–  配置MCC、
MNC 
–  配置功率参数 
其他配置 
•  ⽹网络配置 
–  关闭防⽕火墙 
–  添加ip转发 
–  添加iptables
策略略 
其他配置 
•  IMSI匹配 
–  配置具有哪些IMSI的sim卡可以⼊入⽹网 
最⼩小化影响 
•  这套理理论已经实践过，具有攻击场景，谨慎测试 
–  MCC/MNC/频点的设置会影响周边设备通讯 
•  推荐做法（快速附着）： 
–  ⽆无线信号屏蔽盒中测试 
–  有wifi/有线的 地下室中测试，例例如⼩小区地库 
–  重启下设备 
万事具备，开始攻击 
•  意义：拥有了了控制现⽹网GPRS流量量的能⼒力力 
•  ⽅方法： 
–  开启wireshark，记录分析流量量 
–  使⽤用burpsuite开启http/https代理理，替换流量量 
•  替换升级服务器器 
•  注⼊入浏览器器漏漏洞洞 
–  直接访问ip端⼝口 
•  Exp 
•  管理理⼯工具（ADB、telnet、ssh、私有端⼝口） 
搭建LTE测试基站 
•  当我们只需要获取流量量做分析，不不需要现场控制 
•  简化搭建步骤 
•  快速测试（例例如快速扫描端⼝口） 
•  LTE采⽤用双向认证，不不存在假基站 
•  为了了附着到⽹网络，我们还需要解决认证问题 
LTE系统介绍 
•  UE、EPC、
eNodeB（ENB） 
•  双向认证 
•  开源SDR LTE： 
–  OAI（过于复杂、安
装困难） 
–  srsLTE（安装使⽤用简
单，推荐） 
SDR实现LTE测试基站 
•  srsLTE ENB、 EPC编译安装 
•  SDR硬件选择： 
–  USRP B200/B210/B200 mini 
–  Bladerf x40 xa4 
–  LimeSDR 
•  写卡 
–  可读写空⽩白LTE sim 测试卡（仅限于测试使⽤用） 
–  读卡器器 
配置参数 
•  PLMN （MCC、MNC） 
•  apn 
•  频点（注意配置为设备⽀支持的，例例如Bind1、3、
7) 
•  Ip转发、路路由 
•  写卡 
–  IMSI  Ki  op/opc  
如何写卡 
•  根据运营商填⼊入IMSI 
•  填⼊入usr.csv中的KI、
OP/OPC,替换IMSI 
•  选择正确的算法 
–  Mi or xor 
•  现在，可以⽤用⼿手机主动
搜索并且加⼊入⽹网络 
解决⼿手动搜⽹网、漫游、apn的问题 
•  每次需要点⼿手动搜⽹网，且IOT设备很多⽆无法⼿手动搜 
–  配置和IMSI前5位⼀一致的PLMN，且真实存在（这个同
时会解决漫游状态问题） 
–  写卡配置HPLMN、EHPLMN、FPLMN等参数 
•  apn不不匹配，导致⽆无法建⽴立IP链路路 
•  配置为PLMN对应的apn，例例如中国联通 46001，其通⽤用apn为
3gnet 
Run！ 
•  Start EPC 
•  Start ENB 
各种带SIM卡的物联⽹网设备 
两款⼿手表 信息泄露露及配置修改 
 Subtitle (if needed) 
云端登录过程泄露密钥 
云端交互过程中MITM修改配置 
某共享⻋车锁  信息泄露露及解密 
与云端加密传输 
分析固件，获取密钥及升级协议 
某⻋车载设备存在命令注⼊入 
视频演示：LTE基站端⼝口访问攻击 
利利⽤用运营商内⽹网 
•  利利⽤用运营商内⽹网进⾏行行端⼝口间测试 
–  买两张同类型的4G卡，⼤大概率会分配到⼀一个内⽹网 
–  如果是私有ANP，肯定会分配到同⼀一内⽹网 
–  如果实在条件限制，或者只做23、80等端⼝口访问 
•  扫描⼀一台开放5555等端⼝口，从对⽅方进⾏行行访问（未授权攻击，
不不推荐） 
•  在可控的私有APN内⽹网中，这种⽅方法OK 
视频演示：利利⽤用运营商内⽹网进⾏行行测试 
其他 
•  研究基带漏漏洞洞 
–  Fuzz协议，调试基带 
•  研究LTE 标准漏漏洞洞 
–  Review、添加代码 
–  实际测试 
Q&A