    1602550       0x1873F6      gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
    1606645       0x1883F5      gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1608110       0x1889AE      gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1608851       0x188C93      gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
    1616048       0x18A8B0      gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1618053       0x18B085      gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1619884       0x18B7AC      gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1620434       0x18B9D2      gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1621256       0x18BD08      gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1622020       0x18C004      gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
    1635437       0x18F46D      gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
    1639557       0x190485      gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1640989       0x190A1D      gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1641705       0x190CE9      gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
    1648936       0x192928      gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1650918       0x1930E6      gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1652676       0x1937C4      gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1653245       0x1939FD      gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1654035       0x193D13      gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1654781       0x193FFD      gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
    1668039       0x1973C7      gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
    1672113       0x1983B1      gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1673513       0x198929      gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1674220       0x198BEC      gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:23 2009
    1681271       0x19A777      gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1683281       0x19AF51      gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1685025       0x19B621      gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1685594       0x19B85A      gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1686372       0x19BB64      gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1687111       0x19BE47      gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
    1699948       0x19F06C      gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
    1703937       0x1A0001      gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1705425       0x1A05D1      gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1706169       0x1A08B9      gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
    1713196       0x1A242C      gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1715253       0x1A2C35      gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1717098       0x1A336A      gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1717679       0x1A35AF      gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1718519       0x1A38F7      gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1719332       0x1A3C24      gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
    1732356       0x1A6F04      gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
    1736429       0x1A7EED      gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1737865       0x1A8489      gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
    1738572       0x1A874C      gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
    1745822       0x1AA39E      gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1747816       0x1AAB68      gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1749609       0x1AB269      gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
    1750156       0x1AB48C      gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1750922       0x1AB78A      gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
    1751669       0x1ABA75      gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
    1765090       0x1AEEE2      gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
可以看到binwalk识别了很多的gzip压缩过的web文件、一些LZMA签名、一个ELF头以及一个JFFS文件系统。
那个JFFS文件系统大概率是一个误报，所以我忽略了它。
通过十六进制查看该镜像，发现经过gzip压缩的web文件看起来像是简单文件系统的一部分，类似于[之前](http://www.devttys0.com/2011/06/mystery-file-system/)讨论过的OW文件系统。但是，Web文件与本文的目的不是特别相关，因此我放弃对该文件系统的分析；如果有必要，可以比较容易地从固件映像中提取这些文件并进行gzip解压。
总共发现了四个`LZMA`签名，可以看到，除了一个签名以外，其他三个签名都有很大的size（每个有几百MB），所以那三个可能是误报。第一个签名偏移是0x194f0的大小只有3.5MB，这个大小是合理的，所以我们将该文件提取出来并解压缩：
    embedded@ubuntu:~/WRT54Gv8$ dd if=FW_WRT54Gv8_8.00.8.001_US_20091005.bin skip=0x1 bs=103664 of=lzma_data.7z
    16+1 records in
    16+1 records out
    1665240 bytes (1.7 MB) copied, 0.00559597 s, 298 MB/s
    embedded@ubuntu:~/WRT54Gv8$ p7zip -d lzma_data.7z 
    7-Zip (A) 9.04 beta  Copyright (c) 1999-2009 Igor Pavlov  2009-05-30
    p7zip Version 9.04 (locale=en_US.utf8,Utf16=on,HugeFiles=on,1 CPU)
    Processing archive: lzma_data.7z
    Extracting  lzma_data
    Everything is Ok
    Size:       3680864
    Compressed: 1665240
看起来解压的很成功，让我们使用strings以及hexdump来看一下在解压缩的数据里能够找到什么：
    embedded@ubuntu:~/WRT54Gv8$ strings lzma_data | less
    NORMAL_CODE_DATA
    5VGW$LANGPACK_CODE_DATA=
    $MODEL_NAME=WRT54G
    $OEM_NAME=LINKSYS
    Copyright 2004-2005 CyberTAN Limited
    ...
    GetConnectedDevices
    GetRouterLanSettings2
    GetWanInfo
    GetWanSettings
    GetMACFilters2
    GetPortMappings
    GetDeviceSettings
    HTTP/1.1 307 Temporary Redirect
    Location: https://%s%s/HNAP1/
    HTTP/1.1 500 Internal Server Error
    Server: httpd
    embedded@ubuntu:~/WRT54Gv8$ hexdump -C lzma_data | head