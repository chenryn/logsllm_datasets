require longer than 18 rounds, for the few times when Trinocular is slow to
detect large changes in ˆA because it thinks the block may be down.
The light green solid line in the middle Fig. 5 shows how long full rounds last
for outages that pass FBS. Of 5.1M events, we see that 60% are approved in
less than one hour (ﬁve or fewer TRs). About 8% of events take longer than our
expected maximum of 18 TRs. We examined these cases and determined these
are cases where Trinocular has such conﬁdence the block should be up it does
not probe all 15 tries. We conﬁrm this result examining 50 random blocks within
the tail.
Use of FBS on old Trinocular data requires the 2FR variant of FBS, with
more TRs per FR (see Sect. 3.1). Dashed lines in Fig. 5 show 2FR analysis. We
see almost no change in temporal precision of repaired events (nearly all the
range of the solid and dashed red lines overlap). Accepted outages take roughly
twice as long as with 1FR FBS, and the number drops to roughly one half (3.1M
Improving Coverage of Internet Outage Detection in Sparse Blocks
31
accepted down events); fortunately only 0.13% of all 4M blocks require 2FR and
have actual outages in 2017q4.
We currently use FBS in batch processing, and we plan to implement it in our
near-realtime (NRT) outage pipeline soon. For NRT processing one can either
delay results while FBS is considered, or report preliminary results and then
change them if FBS corrects.
4.5 Increasing Coverage
Sparse blocks limit coverage. If historical information suggests they are sparse,
they may be discarded from probing as untrackable. Blocks that become sparse
during measurement can create false outages and are discarded during post-
processing. We next show how FBS and LABR allow us to increase coverage by
correctly handling sparse blocks.
Correctly Tracking Sparse Blocks. We ﬁrst look at how the accuracy
improvements with our algorithms increase coverage. Three thresholds have been
used to identify (and discard) sparse blocks: a low response probability (A < 0.2,
quarter average, from [12]), low up time (up time < 0.8, from [13]), and high
number of down events (5 or more down events, from [14]).
We use these three thresholds over one quarter of Trinocular data (2017q4-
A30W), reporting on coverage with each ﬁlter in Table 4. With 5.9M responsible
blocks, but only 4M of those (67%) are considered trackable by Trinocular. Fil-
tering removes another 0.2M to 0.9M blocks, leaving an average of 53 to 64%.
Trinocular with FBS gets larger coverage than other methods of ﬁltering or
detection. FBS repairs 1.2M blocks, most sparse: of 0.9M sparse blocks, we ﬁnd
that FBS ﬁxes 0.8M. The remaining 100k correspond to either good blocks that
went dark due to usage change and therefore pushing the quarterly average of
A down, or sparse blocks with few active addresses (for example, |E(b)| < 100)
where Trinocular can make a better job inferring the correct state.
Can FBS+LABR Expand Baseline Coverage? Finally, we examine the
number of blocks discarded as untrackable from historical data, and are not
tracked for outages. For instance, Trinocular looks at the last 16 surveys [7], and
ﬁlter all blocks with |E(b)| < 15 and A < 0.1, left with its baseline of 4M blocks.
In a similar approach, we use the 2017-04-27 survey as our upper bound of
the responsive Internet [8]. As Table 4 shows, we ﬁnd 5.9M responsive blocks, of
which 5.7M had at least three active addresses during the measured period. That
is 1.7M (43%) more blocks than the baseline become trackable. When adding
1.7M with the number of FBS-repaired blocks (1.2M), our eﬀective coverage
increment adds to 2.9M blocks.
5 Related Work
Several groups have methods to detect outages at the Internet’s edge: Thun-
derPing ﬁrst used active measurements to track weather-related outages on the
32
G. Baltra and J. Heidemann
Internet [11,15]. Dainotti et al. use passive observations at network telescope
to detect disasters and government censorship [4], providing the ﬁrst view into
ﬁrewalled networks. Chocolatine provides the ﬁrst published algorithm using pas-
sive network telescope data [6], with a 5 min detection delay, but it requires AS
or country level granularity, much more data than /24s. Trinocular uses active
probes to study about 4M, /24-block level outages [12] every 11 min, the largest
active coverage. Disco observes connectivity from devices at home [16], providing
strong ground truth, but limited coverage. Richter et al. detect outages that last
at least one hour with CDN-traﬃc, conﬁrming with software at the edge [14].
They deﬁne disruptions, showing renumbering and frequent disagreements in a
few blocks are false down events in prior work. Finally, recent work has looked
at dynamic addressing, one source of sparsity [10]. Our work builds on prior
active probing systems and the Trinocular data and algorithms, and addresses
problems identiﬁed by Richter, ultimately due to sparsity and dynamics.
6 Conclusions
This paper deﬁnes two algorithms: Full Block Scanning (FBS), to address false
outages seen in active measurements of sparse blocks, and Lone Address Block
Recovery (LABR), to handle blocks with one or two responsive addresses. We
show that these algorithms increase coverage, from a nominal 67% (and as low
as 53% after ﬁltering) of responsive blocks before to 5.7M blocks, 96% of respon-
sive blocks. We showed these algorithms work well using multiple datasets and
natural experiments; they can improve existing and future outage datasets.
Acknowledgments. We thank Yuri Pradkin for his input on the algorithms and
paper.
We thank Philipp Richter and Arthur Berger for discussions about their work, and
Philipp for re-running his comparison with CDN data.
The work is supported in part by the National Science Foundation, CISE Direc-
torate, award CNS-1806785; by the Department of Homeland Security (DHS) Science
and Technology Directorate, Cyber Security Division (DHS S&T/CSD) via contract
number 70RSAT18CB0000014; and by Air Force Research Laboratory under agree-
ment number FA8750-18-2-0280. The U.S. Government is authorized to reproduce and
distribute reprints for Governmental purposes notwithstanding any copyright notation
thereon.
A Other Block Examples
Section 2.1 described the problem of sparse blocks and why FBS is needed. Here
we provide examples of other blocks where sparsity changes to illustrate when
FBS is required.
The block in the left part of Fig. 6 has no activity for three weeks, then
sparse use for a week, then moderate use, and back to sparse use for the last
two weeks. Reverse DNS suggests this block uses DHCP, and gradual changes in
use suggest the ISP is migrating users. The block was provably reachable after
Improving Coverage of Internet Outage Detection in Sparse Blocks
33
Fig. 6. Sample blocks over time (columns). The bottom (d) shows individual address
as rows, with colored dots when the address responds to Trinocular. Bar (c) shows
Trinocular status (up, unknown, and down), bar (b) is Full Block Scanning, and the
top bar (a), Lone Address Block Recovery. (Color ﬁgure online)
the ﬁrst three weeks. Before then it may have been reachable but unused, a false
outage because the block is inactive.
The third bar from the top (c) of the left of Fig. 6 we show that Trinocular
often marks the block unknown (in red) for the week starting 2017-10-30, and
again for weeks after 2017-12-12. Every address in this block has responded in the
past. But for these two periods, only a few are actually used, making the block
temporarily sparse. Figure 6 (left, bar b) shows how FBS is able to accurately ﬁx
Trinocular’s pitfalls in such a DHCP scenario.
Figure 6 (right) shows a block example with a lone address. This block has
three phases of use: before 2017-02-16, many addresses are in use; then for about
9 days, nothing replies; then, starting on 2017-02-25 only the .1 address replies.
During the last phase, Trinocular (Fig. 6 (right, bar c)) completely ignores that
there is one address responding, while FBS (Fig. 6 (right, bar b)) sets block sta-
tus depending on responses of this lone-address. However, LABR (Fig. 6 (right,
bar a)) changes all the FBS detected down events to unknown, as there is not
information to claim a down event, in contrast to what the end of phase one
shows.
B Block Usage Change
As mentioned in Sect. 2.1, when blocks become temporarily sparse (showing a
small A(E(b))), the number of false outages increases. On the other hand, denser
blocks oﬀer higher inference correctness.
Our prior work dynamically estimated A [13], but Richter et al. showed that
block usage changes dramatically, so blocks can become overly sparse even with
tracking [14].
34
G. Baltra and J. Heidemann
Fig. 7. Blocks distributed according to the number of outages versus their A(E(b))
(left), and cumulative distribution function of the A value per block (right) as collected
during 2017q4 for the whole responsive IPv4 address scope. Dataset A30. (Color ﬁgure
online)
We ﬁrst show that sparse blocks cause the majority of outage events. In
Fig. 7 (left) we compare the number of outages in all 4M responsive blocks with
their measured A(E(b)) value during 2017q4. Blocks with a higher number of
outages tend to have a lower A(E(b)) value. In particular those closer to the
lower bound. Trinocular does not track blocks with long term A(E(B)) < 0.1,
however as blocks sparseness changes, this value does change during measure
time.
The correlation between sparse blocks and frequent outage events is clearer
when we look at a cumulative distribution. Figure 7 (right) shows the cumulative
distribution of A for all 4M responsive blocks (light green, the lower line), and
for blocks with 10 or more down events (the red, upper line) as measured during
2017q4. These lines are after merging observations obtained from six Trinocular
vantage points. We ﬁnd that 80% of blocks with 10 or more down events have an
A < 0.2, at around the knee of the curve, and yet these sparse blocks represent
only 22% of all blocks. The ﬁgure suggests a correlation between high number
of down events and low A(E(b)) per block due to the faster convergence of the
line representing blocks with multiple down events. (It conﬁrms the heuristic of
“more than 5 events” that was used to ﬁlter sparse Trinocular blocks in the 2017
CDN comparison [14].)
Although we observe from multiple locations, merging results from diﬀerent
vantage points is not suﬃcient to deal with sparse blocks, because these multiple
sites all face the same problem of sparseness leading to inconsistent results.
Addressing this problem is a goal of FBS, and it also allows us to grow coverage.
C Comparing Trinocular and FBS
In Sect. 4.2 we discuss how often FBS changes outages when compared to Trinoc-
ular. We examine two diﬀerent metrics: total block down time and number of
down events. Here we provide further information distribution about the distri-
bution of these metrics.
Improving Coverage of Internet Outage Detection in Sparse Blocks
35
Fig. 8. Cumulative distribution of down fraction diﬀerence (left) and number of down
events diﬀerence (right) between Trinocular and FBS for 2017q4. Dataset A30.
In Fig. 8 (left) we show block distribution of Trinocular and FBS down time
fraction diﬀerence. The majority of blocks (91%) have little or no change. Blocks
on the left side of the ﬁgure representing 9% of the total, have a higher down
time fraction when processed only with Trinocular than when processed with
FBS. For example, a −1 shows a block that was down for Trinocular during
the whole quarter, while FBS was able to completely recover it. This outcome
occurs when a historically high |E(b)| block has temporarily dropped to just a
few stable addresses.
We also see a small percentage (0.5%) where FBS has a higher down fraction
than Trinocular. This increase in outages fraction happens when Trinocular erro-
neously marks a block as UP. With more information, FBS is able to correctly
change block state and more accurately reﬂect truth.
In Fig. 8 (right) we look to the distribution of blocks when compared by the
number of down events observed in FBS and Trinocular. Similarly, the num-
ber of down events remains mostly unchanged for the majority of blocks (94%).
Trinocular has more down events for 6% of blocks, and FBS shows more events
for 0.1%. FBS can increase the absolute number of events in a block when break-
ing long events into shorter pieces.
References
1. IODA: Internet outage detection & analysis. https://ioda.caida.org
2. Baltra, G., Heidemann, J.:
Improving the optics of active outage detec-
tion (extended). Technical report ISI-TR-733, May 2019. https://www.isi.edu/
%7ejohnh/PAPERS/Baltra19a.html
3. Dainotti, A., et al.: Lost in space: improving inference of IPv4 address space uti-
lization. IEEE J. Sel. Areas Commun. (JSAC) 34(6), 1862–1876 (2016)
4. Dainotti, A., et al.: Analysis of country-wide Internet outages caused by censorship.
In: Proceedings of the ACM Internet Measurement Conference, Berlin, Germany,
pp. 1–18. ACM, November 2011. https://doi.org/10.1145/2068816.2068818
5. Madory, D.: Iraq downs internet to combat cheating...again! (2017). https://dyn.
com/blog/iraq-downs-internet-to-combat-cheating-again/. Accessed 01 Aug 2019
36
G. Baltra and J. Heidemann
6. Guillot, A., et al.: Chocolatine: outage detection for internet background radiation.
In: Proceedings of the IFIP International Workshop on Traﬃc Monitoring and
Analysis. IFIP, Paris, France, June 2019. https://clarinet.u-strasbg.fr/∼pelsser/
publications/Guillot-chocolatine-TMA2019.pdf
7. Heidemann, J., Pradkin, Y., Govindan, R., Papadopoulos, C., Bartlett, G., Ban-
nister, J.: Census and survey of the visible Internet. In: Proceedings of the ACM
Internet Measurement Conference, Vouliagmeni, Greece, pp. 169–182. ACM, Octo-
ber 2008. https://doi.org/10.1145/1452520.1452542
8. Internet Addresses Survey dataset, PREDICT ID: USC-LANDER/internet-
address-survey-reprobing-it75w-20170427
9. MaxMind: GeoIP Geolocation Products (2017). http://www.maxmind.com/en/
city
10. Padmanabhan, R., Dhamdhere, A., Aben, E., Claﬀy, K.C., Spring, N.: Reasons
dynamic addresses change. In: Proceedings of the ACM Internet Measurement
Conference, Santa Monica, CA, USA. ACM, November 2016. https://doi.org/10.
1145/2987443.2987461
11. Padmanabhan, R., Schulman, A., Levin, D., Spring, N.: Residential links under
the weather. In: Proceedings of the ACM Special Interest Group on Data Commu-
nication, pp. 145–158. ACM (2019)
12. Quan, L., Heidemann, J., Pradkin, Y.: Trinocular: understanding Internet relia-
bility through adaptive probing. In: Proceedings of the ACM SIGCOMM Con-
ference, Hong Kong, China, pp. 255–266. ACM, August 2013. https://doi.org/10.
1145/2486001.2486017
13. Quan, L., Heidemann, J., Pradkin, Y.: When the Internet sleeps: correlating diurnal
networks with external factors. In: Proceedings of the ACM Internet Measurement
Conference, Vancouver, BC, Canada, pp. 87–100. ACM, November 2014. https://
doi.org/10.1145/2663716.2663721
14. Richter, P., Padmanabhan, R., Spring, N., Berger, A., Clark, D.: Advancing the
art of Internet edge outage detection. In: Proceedings of the ACM Internet Mea-
surement Conference, Boston, Massachusetts, USA. ACM, October 2018. https://
doi.org/10.1145/3278532.3278563
15. Schulman, A., Spring, N.: Pingin’ in the rain. In: Proceedings of the ACM Inter-
net Measurement Conference, pp. 19–25. Berlin, Germany. ACM, November 2011.
https://doi.org/10.1145/2068816.2068819
16. Shah, A., Fontugne, R., Aben, E., Pelsser, C., Bush, R.: Disco: fast, good, and cheap
outage detection. In: Proceedings of the IEEE International Conference on Traﬃc
Monitoring and Analysis, Dublin, Ireland, pp. 1–9. IEEE, June 2017. https://doi.
org/10.23919/TMA.2017.8002902
17. USC/ISI ANT Project. https://ant.isi.edu/datasets/outage/index.html