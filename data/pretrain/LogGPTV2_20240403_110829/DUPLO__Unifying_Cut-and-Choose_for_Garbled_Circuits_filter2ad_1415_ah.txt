Proof. We can directly apply the proof of Lemma 7 except
for the base case when ğ¶â€² = ğğ€ğ§ğ:
if all
âˆ™ ğ¶â€² = ğğ€ğ§ğ: The label in ğ‘£ is (ğ–¡â„, (ğ–ª0
â„)). The expres-
â„
, ğ–ª1
â„ are the following
sions in ğğšğ«ğ­ğ¬(ğ‘“) that contain ğ–ª0
and their sub-expressions:
, ğ–ª1
â„
â„)â¦„ğ‘˜0
â¦ƒâ¦ƒ(ğ–¡â„, ğ–ª0
â„)â¦„ğ‘˜1
â¦ƒâ¦ƒ(ğ–¡â„, ğ–ª0
ğ‘—
ğ‘—
â¦„ğ‘˜0
â¦„ğ‘˜0
ğ‘–
ğ‘–
,â¦ƒâ¦ƒ(ğ–¡â„, ğ–ª0
â„)â¦„ğ‘˜0
,â¦ƒâ¦ƒ(ğ–¡â„, ğ–ª0
â„)â¦„ğ‘˜1
ğ‘—
ğ‘—
â¦„ğ‘˜1
â¦„ğ‘˜1
ğ‘–
ğ‘–
,
,
ğ‘–
where ((ğ‘ğ‘–, (ğ‘˜0
, ğ‘˜1
assumption, ğ‘˜0
, ğ‘˜0
ğ‘‡ and ğ‘˜1âˆ’ Ì„ğ‘§ = ğ–ª1
(ğ–¡â„, (ğ–ª0
, ğ–ª1
ğ‘–
â„
ğ‘—
ğ‘– )), (ğ‘ğ‘—, (ğ‘˜0
, ğ‘˜1
Ì„ğ‘§ = 0. By
ğ‘— âˆˆ ğ‘‡ and ğ‘˜1
â„ âˆˆ
â„ âˆ‰ ğ‘‡ , and Condition 1 holds for
ğ‘—))) = ğ‘¢. Let
, ğ‘˜1
ğ‘— âˆ‰ ğ‘‡ . So ğ‘˜ Ì„ğ‘§ = ğ–ª0
ğ‘–
â„)) with actual value 0.
For the rest of the cases, the proof of Lemma 7 applies with
actual value 0.
Now we are ready to prove our main result that the patterns
of the real garbled circuit and the simulated garbled circuit are
equivalent up to renaming.
Theorem 5. For any circuit ğ¶ âˆˆ Circuit(ğ‘ , ğ‘¡) and any
boolean vector ğ‘¥ âˆˆ {0, 1}ğ‘›, where ğ‘  is a shape of ğ‘› wires,
ğğšğ­ğ­ğğ«ğ§(ğ™¶ğšŠğš›ğš‹ğš•ğš(ğ¶, ğ‘¥)) â‰ˆ ğğšğ­ğ­ğğ«ğ§(ğš‚ğš’ğš–ğšğš•ğšŠğšğš(ğ¶, ğ¶(ğ‘¥))).
Proof. Let ğ‘¢ = ((ğ–¡1, (ğ–ª0
, ğ–ª1
1)), â€¦ , (ğ–¡ğ‘›, (ğ–ª0
ğ‘›))) be the label
1
expression in ğ™¶ğšŠğš›ğš‹ğš•ğš. Let
Ìƒğ¶, ğ‘£ = ğ™¶ğš‹(ğ¶, ğ‘¢). One can check
Ìƒğ¶â€², ğ‘£â€² = ğ™¶ğš‹(ğ¶â€², ğ‘¢â€²)
that, for any sub-circuit ğ¶â€² of ğ¶,
Ì‚ğ¶â€², ğ‘¤â€² = ğš‚ğš’ğš–(ğ¶â€², ğ‘¢â€²) for any label expression ğ‘¢â€² of an
and
appropriate shape, then ğ‘£â€² = ğ‘¤â€². Since ğš‚ğš’ğš– is also applied on
ğ¶ and ğ‘¢ in ğš‚ğš’ğš–ğšğš•ğšŠğšğš, we can write
Ì‚ğ¶, ğ‘£ = ğš‚ğš’ğš–(ğ¶, ğ‘¢).
Let ğ‘’ = ( Ìƒğ¶, Ìƒğ‘¥) = ğ™¶ğšŠğš›ğš‹ğš•ğš(ğ¶, ğ‘¥), ğ‘“ = ( Ì‚ğ¶, Ì‚ğ‘¥) =
ğš‚ğš’ğš–ğšğš•ğšŠğšğš(ğ¶, ğ¶(ğ‘¥)), ğ‘† = Fix(ğ‘’), and ğ‘‡ = Fix(ğ‘“ ). We
Ì‚ğ¶ = ( Ì‚ğ¶1, â€¦ , Ì‚ğ¶ğ‘), where
can write
Ì‚ğ¶ğ‘–, ğ‘£ğ‘– = ğš‚ğš’ğš–(ğ¶ğ‘–, ğ‘¢ğ‘–) for some atomic
Ìƒğ¶ğ‘–, ğ‘£ğ‘– = ğ™¶ğš‹(ğ¶ğ‘–, ğ‘¢ğ‘–) and
Ìƒğ¶ = ( Ìƒğ¶1, â€¦ , Ìƒğ¶ğ‘) and
ğ‘›, ğ–ª1
if
157
sub-circuit ğ¶ğ‘– of ğ¶ and some label expression ğ‘¢ğ‘–. To show
ğğšğ­ğ­ğğ«ğ§(ğ‘’) = ğ©(ğ‘’, ğ‘†) â‰ˆ ğ©(ğ‘“ , ğ‘‡ ) = ğğšğ­ğ­ğğ«ğ§(ğ‘“), we ï¬rst
show (ğ©( Ìƒğ¶1, ğ‘†), â€¦ , ğ©( Ìƒğ¶ğ‘, ğ‘†)) â‰ˆ (ğ©( Ì‚ğ¶1, ğ‘‡ ), â€¦ , ğ©( Ì‚ğ¶ğ‘, ğ‘‡ )) with
respect to a pseudorandom renaming ğ›¼ = (ğ›¼ğµ, ğ›¼ğ¾), and then
we show ğ©( Ìƒğ‘¥, ğ‘†) â‰ˆğ›¼ ğ©( Ì‚ğ‘¥, ğ‘‡ ).
ğ‘–
ğ‘–
, ğ–ª1
ğ‘– ) = ğ–ª0
For the ï¬rst part,
for all ğ–¡ğ‘– âˆˆ ğ, where ğ‘§ğ‘–
ğ‘– and ğ›¼ğ¾(ğ–ª1âˆ’ğ‘§ğ‘–
let ğ›¼ğµ be the random bit renaming
ğ›¼ğµ(ğ–¡ğ‘–) = ğ–¡âŠ•ğ‘§ğ‘–
is the actual
value of the label that contains ğ–¡ğ‘–. Let ğ›¼ğ¾ be the bijection
on ğŠ such that ğ›¼ğ¾(ğ–ªğ‘§ğ‘–
for
each ğ–ª0
ğ‘– . We claim that, for any sub-circuit ğ¶â€² of ğ¶
Ìƒğ¶â€², ğ‘£â€² = ğ™¶ğš‹(ğ¶â€², ğ‘¢â€²) and
and for any label expression ğ‘¢â€², if
Ì‚ğ¶â€², ğ‘£â€² = ğš‚ğš’ğš–(ğ¶â€², ğ‘¢â€²), then Condition 1 holds for all labels in
ğ‘£â€² and ğ©( Ìƒğ¶â€², ğ‘†) â‰ˆğ›¼ ğ©( Ì‚ğ¶â€², ğ‘‡ ).
Proof of claim: Notice that all labels in ğ‘¢ satisfy Condi-
tion 1. By Lemma 7, all labels in ğ‘£â€² also satisfy Condition 1.
We use induction on the structure of ğ¶â€² to show ğ©( Ìƒğ¶â€², ğ‘†) â‰ˆğ›¼
) = ğ–ª1
ğ©( Ì‚ğ¶â€², ğ‘‡ ). For the base case, ğ¶â€² is an atomic circuit:
ğ‘–
ğ‘–
Ìƒğ¶â€² and
âˆ™ ğ¶â€² = ğ’ğ°ğšğ©, ğ€ğ¬ğ¬ğ¨ğœ, ğ”ğ§ğšğ¬ğ¬ğ¨ğœ, or ğƒğ®ğ©: Both
âˆ™ ğ¶â€² = ğğ€ğ§ğ: Suppose ğ‘¢â€² = ((ğ‘ğ‘–, (ğ‘˜0
Ì‚ğ¶â€²
are the empty garbled circuit ğœ–, so ğ©( Ìƒğ¶â€², ğ‘†) = ğ©( Ì‚ğ¶â€², ğ‘‡ ).
, ğ‘˜1
ğ‘—)))
and ğ‘£â€² = (ğ–¡â„, (ğ–ª0
â„)). Let ğ‘§ğ‘–, ğ‘§ğ‘— and ğ‘§â„ be the ac-
tual values of the labels (ğ‘ğ‘–, (ğ‘˜0
ğ‘—)) and
(ğ–¡â„, (ğ–ª0
â„)), respectively. We know from the proof of
Lemma 7 that ğ‘§â„ = ğ‘§ğ‘– â†‘ ğ‘§ğ‘— . So we can apply ğ›¼ğ¾ and get
ğ‘– )), (ğ‘ğ‘—, (ğ‘˜0
ğ‘– )), (ğ‘ğ‘—, (ğ‘˜0
, ğ–ª1
, ğ–ª1
, ğ‘˜1
, ğ‘˜1
, ğ‘˜1
â„
â„
ğ‘—
ğ‘—
ğ‘–
ğ‘–
Ìƒğ¶â€²= ğœ‹[ğµğ‘–](ğœ‹[ğµğ‘—](â¦ƒâ¦ƒ(ğ–¡âŠ•(0â†‘0)
â¦ƒâ¦ƒ(ğ–¡âŠ•(0â†‘1)
ğœ‹[ğµğ‘—](â¦ƒâ¦ƒ(ğ–¡âŠ•(1â†‘0)
â¦ƒâ¦ƒ(ğ–¡âŠ•(1â†‘1)
â„
â„
â‰ˆğ›¼ ğœ‹[ğµâŠ•ğ‘§ğ‘–
ğ‘–
](ğœ‹[ğµ
âŠ•ğ‘§ğ‘—
ğ‘—
ğœ‹[ğµ
âŠ•ğ‘§ğ‘—
ğ‘—
ğ‘–
â¦„ğ‘˜0
â¦„ğ‘˜0
â¦„ğ‘˜1
â¦„ğ‘˜1
ğ‘–
ğ‘–
ğ‘–
,
),
,
))
ğ‘—
ğ‘—
â„
, ğ–ª0â†‘0
, ğ–ª0â†‘1
, ğ–ª1â†‘0
, ğ–ª1â†‘1
â„ )â¦„ğ‘˜0
â„ )â¦„ğ‘˜1
â„ )â¦„ğ‘˜0
â„ )â¦„ğ‘˜1
](â¦ƒâ¦ƒ(ğ–¡âŠ•(0â†‘0)âŠ•ğ‘§â„
â¦ƒâ¦ƒ(ğ–¡âŠ•(0â†‘1)âŠ•ğ‘§â„
](â¦ƒâ¦ƒ(ğ–¡âŠ•(1â†‘0)âŠ•ğ‘§â„
â¦ƒâ¦ƒ(ğ–¡âŠ•(1â†‘1)âŠ•ğ‘§â„
â„
â„
â„
â„
ğ‘—
ğ‘—
â„
â„
, ğ–ª(0â†‘0)âŠ•ğ‘§â„
, ğ–ª(0â†‘1)âŠ•ğ‘§â„
, ğ–ª(1â†‘0)âŠ•ğ‘§â„
, ğ–ª(1â†‘1)âŠ•ğ‘§â„