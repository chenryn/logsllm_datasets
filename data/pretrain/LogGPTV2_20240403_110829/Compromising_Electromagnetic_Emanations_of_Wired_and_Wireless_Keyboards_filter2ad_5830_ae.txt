s
i
D
 12
 10
 8
 6
 4
 2
 0
Maximum Distance
FETT
GTT
MT
MST
Figure 18: Maximum distance ranges, from the least vul-
nerable keyboard to the most vulnerable keyboard, to
successfully recover 95% of the keystroke according to
the techniques (in the ofﬁce with the biconical antenna).
13
Setup 4: The Building. We notice some unexpected re-
sults in this setup. Indeed, we are able to capture the sig-
nal and successfully recover the keystroke with a proba-
bility higher than 95% 20 meters away from the keyboard
(i.e. the largest distance inside the building). Sometimes
the environment can be extremely favorable to the eaves-
dropping process. For example, metallic structures such
as pipes or electric wires may act as antennas and sig-
niﬁcantly improve the eavesdropping range. In this case,
the compromising emanations are carried by the shared
ground of the electric line. Thus, the range is deﬁned by
the distance between the keyboard and the shared ground
and the distance between the shared ground and the an-
tenna. Note that the Matrix Scan Technique is easily dis-
rupted by a noisy shared ground, since the trigger model
is more complicated and the emanations weaker. For
this technique, we were only able to successfully capture
compromising emanations when the keyboard is at less
than one meter away from the shared ground. This setup
is interesting because it corresponds to a practical sce-
nario where the eavesdropper is placed in the basement
of a building and tries to recover the keystrokes of a key-
board at the ﬁfth ﬂoor. Unfortunately, it was impossible
to provide stable measurements since they highly depend
on the environment. We noticed that the main (metallic)
water pipe of the building acts as an antenna as well and
can be used in place of the shared ground. Furthermore,
this antenna is less polluted by electronic devices.
Perfect Trigger. We tried the same experiment in the of-
ﬁce, but the background noise was too strong. Indeed, we
were not able to successfully detect the compromising
emissions. However, with a probe physically connected
to the data wire, we correctly triggered the emanations.
Indeed, the electromagnetic compromising emissions are
present in the shared ground. The limitation concerns
only the trigger. All the techniques were applicable on
the whole ﬂoor (about 20 meters) with the keyboard one
meter away from the shared ground.
Obviously, you can directly connect the oscilloscope
to the shared ground of the building to eavesdrop the
keystrokes. Note that an old PC tower used to supply
tested keyboards carries the compromising emanations
directly through the shared ground. But, this is out of
the scope of this paper since we focused our research on
electromagnetic emanations only. To avoid such conduc-
tive coupling through power supply, we performed our
measurements with the keyboards connected to a battery
powered laptop.
7 Countermeasures
In this Section, we suggest some possible countermea-
sures to protect keyboards against the four attacks.
The ﬁrst solution to avoid the compromising emana-
tions seems trivial. We should shield the keyboard to
signiﬁcantly reduce all electromagnetic radiations. Many
elements inside the keyboard may generate emanations:
the internal electronic components of the keyboard, the
communication cable, and the components of the moth-
erboard inside the computer. Thus, to eliminate these
emanations, we have to shield the whole keyboard, the
cable, and a part of the motherboard of the computer. We
discussed with a manufacturer and he pointed out that the
price to shield the entire keyboard will at least double the
price of the device. This solution may not be applica-
ble for cost reasons. One can ﬁnd on the market some
keyboards which respect the NATO SDIP-27 standard.
All these documents remain classiﬁed and no informa-
tion is available on the actual emission limit or detailed
measurement procedures. Another solution is to protect
the room where vulnerable keyboards are used. For ex-
ample, the room can be shielded or a secure physical
perimeter can be deﬁned around the room, for instance
100 meters. Attacks 1, 2 and 3 are directly related to the
PS/2 protocol. One solution to avoid unintended infor-
mation leaks is to encrypt the bi-directional serial com-
munication, see [3]. In modern keyboards, one chip con-
tains the controller, the driver, the detector, and the com-
munication interface. So, the encryption may be com-
puted in this chip and no direct compromising emana-
tions related to the serial communication will appear. At-
tack 4 is related to the scan matrix loop. A solution could
be to design a new scanning process algorithm. Even if
keyboards still use scan matrix loop routine, there exists
some applicable solutions. As described by Anderson
and Kuhn [3], the loop routine can be randomized. Actu-
ally columns are scanned in the incremental order 1, 2, 3,
. . ., 23, 24, but it seems possible to change the order ran-
domly. Moreover, we can add some random delays dur-
ing the scanning loop process to obfuscate the execution
of the subroutine. Both solutions do not avoid electro-
magnetic emanations, but makes the keystrokes recovery
process theoretically impossible. Paavilainen [27] also
proposed a solution. It consists in high-frequency ﬁlter-
ing matrix signals before they are fed into the keyboard.
This will signiﬁcantly limits compromising electromag-
netic emanations.
8 Extensions
Our study has shown that electromagnetic emanations of
modern wired and wireless keyboards may be exploited
from a distance to passively recover keystrokes. In this
section, we detail some extensions and remarks.
The main limitation of these attacks concerns the trig-
ger of the data acquisition. This can be improved with an
independent process, using speciﬁc ﬁlters between the
antenna and the ADC. Additionally, other compromising
emanations such as the sound of the pressed key could be
used as trigger. Furthermore, modern techniques such as
beamforming could signiﬁcantly improve the noise ﬁl-
tering.
Another improvement would be to simultaneously
leverage multiple techniques. For keyboards that are vul-
nerable to more than one technique, we could correlate
the results of the different techniques to reduce uncer-
tainty in our guesses.
Another extension would be to accelerate these attacks
Indeed, the acquisition time
with dedicated hardware.
(i.e.
the transfer of the data to a computer), the ﬁlter-
ing and decoding processes take time (about two seconds
per keystroke). With dedicated system and hardware-
based computation such as FPGAs, the acquisition, ﬁl-
tering and decoding processes can obviously be instan-
taneous (e.g. less than the minimum time between two
keystrokes). However, the keystrokes distinguishing pro-
cess when multiple keyboards are radiating is still difﬁ-
cult to implement especially for the Matrix Scan Tech-
nique, since the acquisition process should be continu-
ous.
We spend time experimenting with different types of
antennas and analog-to-digital converters. In particular,
we used the USRP and the GNU Radio library to avoid
the need of an oscilloscope and to obtain a portable ver-
sion of the Modulation Technique. Indeed, we can hide
the USRP with battery and a laptop in a bag, the antenna
can be replaced by a simple wire of copper (one meter
long) which is taped on the attacker’s body hidden under
his clothes. With this transportable setup, we are able to
recover keystrokes from vulnerable keyboards stealthily.
However the eavesdropping range is less than two me-
ters.
9 Conclusion
We have provided evidence that modern keyboards ra-
diate compromising electromagnetic emanations. The
four techniques presented in this paper prove that these
inexpensive devices are generally not sufﬁciently pro-
tected against compromising emanations. Additionally,
we show that these emanations can be captured with rel-
atively inexpensive equipment and keystrokes are recov-
ered not only in the semi-anechoic chamber but in some
practical environments as well.
The consequences of these attacks is that compromis-
ing electromagnetic emanations of keyboards still rep-
resent a security risk. PS/2, USB laptop and wireless
14
keyboards are vulnerable. Moreover, there is no soft-
ware patch to avoid these attacks. We have to replace the
hardware to obtain safe devices. Due to cost pressure in
the design, manufacturers may not systematically protect
keyboards. However, some (expensive) secure keyboards
already exist but they are mainly bought by military or-
ganizations or governments.
The discovery of these attacks was directly related to
our method based on the analysis of the entire spectrum
and the computation of Short Time Fourier Transform.
This technique has some pros such as the human-based
visual detection of compromising emanations, the large
spectrum bandwidth, the use of the raw signal without
RF front-ends and the post-demodulation using software
libraries. The cons are the limited memory and the difﬁ-
culty to obtain efﬁcient triggers. However, for short data
bursts, this solution seems relevant.
Future works should consider similar devices, such as
keypads used in cash dispensers (ATM), mobile phone
keypads, digicodes, printers, wireless routers etc. An-
other major point is to avoid the use of a peak detec-
tion algorithm since it is the main limitation of these at-
tacks. The algorithms of the feature extractions could
be improved as well. The correlation of these attacks
with non-electromagnetic compromising emanation at-
tacks such as optical, acoustic or time attacks could sig-
niﬁcantly improve the keystroke recovery process.
We discussed with a few agencies interested by our
videos [36]. They conﬁrmed that this kind of attack
has been practically done since the 1980’s on old com-
puter keyboards, with sharp transitions and high volt-
ages. However, they were not aware on the feasibility
of these attacks on modern keyboards. Some of these
attacks were not known to them.
Acknowledgments
We gratefully thank Pierre Zweiacker and Farhad
Rachidi from the Power Systems Laboratory (EPFL) for
the semi-anechoic chamber and their precious advices.
We also thank Eric Aug´e, Lucas Ballard, David Jilli,
Markus Kuhn, Eric Olson and the anonymous review-
ers for their extremely constructive suggestions and com-
ments.
References
[2] ANDERSON, R. J., AND KUHN, M. G. Soft Tem-
pest – An Opportunity for NATO. Protecting NATO
Information Systems in the 21st Century, Washing-
ton, DC, Oct 25-26 (1999).
[3] ANDERSON, R. J., AND KUHN, M. G. Lost Cost
Countermeasures Against Compromising Electro-
magnetic Computer Emanations. United States
Patent US 6,721,324 B1, 2004.
[4] ASONOV, D., AND AGRAWAL, R. Keyboard
Acoustic Emanations. In IEEE Symposium on Se-
curity and Privacy (2004), IEEE Computer Society,
pp. 3–11.
[5] BACKES, M., D ¨URMUTH, M., AND UNRUH, D.
Compromising reﬂections-or-how to read lcd mon-
itors around the corner. In IEEE Symposium on Se-
curity and Privacy (2008), P. McDaniel and A. Ru-
bin, Eds., IEEE Computer Society, pp. 158–169.
[6] BALZAROTTI, D., COVA, M., AND VIGNA, G.
Clearshot: Eavesdropping on keyboard input from
video.
In IEEE Symposium on Security and Pri-
vacy (2008), P. McDaniel and A. Rubin, Eds., IEEE
Computer Society, pp. 170–183.
[7] BERGER, Y., WOOL, A., AND YEREDOR, A.
Dictionary attacks using keyboard acoustic ema-
nations.
In ACM Conference on Computer and
Communications Security (2006), A. Juels, R. N.
Wright, and S. D. C. di Vimercati, Eds., ACM,
pp. 245–254.
[8] BRANDT, A.
Privacy Watch:
less Keyboards
http://www.pcworld.com/article/108712/
privacy watch wireless keyboards that blab.html.
that Blab,
January
Wire-
2003.
[9] CHAPWESKE, A. The PS/2 Mouse/Keyboard Pro-
tocol. http://www.computer-engineering.org/.
[10] CISPR.
Commitee
cial
http://www.iec.ch/zone/emc/emc cis.htm.
The
on
International
Radio
Spe-
Interference.
[11] CORRELL, J. T. Igloo White - Air Force Magazine
Online 87, 2004.
[12] DYNAMIC
SCIENCES
R-1550a
INC.
http://www.dynamicsciences.com/client/
show product/33.
tempest
INTERNATIONAL,
receiver,
2008.
[1] AGRAWAL, D., ARCHAMBEAULT, B., RAO, J. R.,
In
AND ROHATGI, P. The EM Side-Channel(s).
CHES (2002), B. S. K. Jr., C¸ etin Kaya Koc¸, and
C. Paar, Eds., vol. 2523 of Lecture Notes in Com-
puter Science, Springer, pp. 29–45.
[13] EATSON,
J.
GNU Octave,
2008.
http://www.gnu.org/software/octave/.
[14] ETTUS, M. The Universal Software Radio Periph-
eral or USRP, 2008. http://www.ettus.com/.
15
[15] FCC.
Federal Communications Commission.
http://www.fcc.gov.
[16] GANDOLFI, K., MOURTEL, C., AND OLIVIER,
F. Electromagnetic analysis: Concrete results. In
CHES (2001), C¸ etin Kaya Koc¸, D. Naccache, and
C. Paar, Eds., vol. 2162 of Lecture Notes in Com-
puter Science, Springer, pp. 251–261.
[17] KUHN, M. G. Compromising Emanations: Eaves-
dropping risks of Computer Displays. Technical
Report UCAM-CL-TR-577 (2003).
Security limits for compromis-
[18] KUHN, M. G.
ing emanations.
In CHES (2005), J. R. Rao and
B. Sunar, Eds., vol. 3659 of Lecture Notes in Com-
puter Science, Springer, pp. 265–279.
[19] KUHN, M. G. Dynamic Sciences R-1250 Receiver,
2008. http://www.cl.cam.ac.uk/ mgk25/r1250/.
[27] PAAVILAINEN, R. Method and device for signal
protection. United States Patent US 7,356,626 B2,
2008.
[28] QUISQUATER, J.-J., AND SAMYDE, D. Electro-
magnetic analysis (ema): Measures and counter-
measures for smart cards. In E-smart (2001), I. At-
tali and T. P. Jensen, Eds., vol. 2140 of Lecture
Notes in Computer Science, Springer, pp. 200–210.
[29] SIGBLIPS DSP ENGINEERING. Baudline, 2008.
http://www.baudline.com.
[30] SMULDERS, P. The Threat of Information Theft by
Reception of Electromagnetic Radiation from RS-
232 Cables. Computers and Security 9, 1 (1990),
53–58.
[31] SONDERMAN, E. L., AND DAVIS, W. Z. Scan-
controlled keyboard. United States Patent US
4,277,780, 1981.
[20] KUHN, M. G., AND ANDERSON, R. J.
Soft
Tempest: Hidden Data Transmission Using Elec-
tromagnetic Emanations.
In Information Hiding
(1998), D. Aucsmith, Ed., vol. 1525 of Lecture
Notes in Computer Science, Springer, pp. 124–142.
[32] SONG, D. X., WAGNER, D., AND TIAN, X. Tim-
ing analysis of keystrokes and timing attacks on
ssh.
In SSYM’01: Proceedings of the 10th con-
ference on USENIX Security Symposium (Berkeley,
CA, USA, 2001), USENIX Association, pp. 25–25.
[21] LOUGHRY, J., AND UMPHRESS, D. A. Informa-
tion leakage from optical emanations. ACM Trans.
Inf. Syst. Secur. 5, 3 (2002), 262–289.
[22] MIL-STD-461.
Electromagnetic Interference
for Equipment.
Characteristics Requirements
https://acc.dau.mil/
CommunityBrowser.aspx?id=122817.
[23] MOSER, M., AND SCHRODEL, P.
27MHz
Wireless Keyboard Analaysis Report,
2005.
http://www.blackhat.com/presentations/bh-dc-08/
Moser/Whitepaper/bh-dc-08-moser-WP.pdf.
[24] MULDER, E. D., ¨ORS, S. B., PRENEEL, B., AND
VERBAUWHEDE, I. Differential power and elec-
tromagnetic attacks on a FPGA implementation of
elliptic curve cryptosystems. Computers & Electri-
cal Engineering 33, 5-6 (2007), 367–382.
[25] NALTY, B. C. The war against trucks: aerial in-
terdiction in southern Laos, 1968-1972. Air Force
History and Museums Program, United States Air
Force, 2005.
[26] NATIONAL SECURITY AGENCY.
A
PEST:
Problem,
http://www.nsa.gov/public info/ ﬁles/
cryptologic spectrum/tempest.pdf.
Signal
TEM-
2007.
16
[33] TANAKA, H. Information leakage via electromag-
netic emanations and evaluation of tempest coun-
termeasures. In ICISS (2007), P. D. McDaniel and
S. K. Gupta, Eds., vol. 4812 of Lecture Notes in
Computer Science, Springer, pp. 167–179.
[34] VAN ECK, W. Electromagnetic radiation from
video display units: an eavesdropping risk? Com-
put. Secur. 4, 4 (1985), 269–286.
[35] VARIOUS AUTHORS. The GNU Software Radio,
2008. http://www.gnuradio.org/.
[36] VUAGNOUX, M., AND PASINI, S.
Videos
of
the Compromising Electromagnetic Ema-
nations of Wired Keyboards, October 2008.
http://lasecwww.epﬂ.ch/keyboard/.
[37] YOUNG, J. NSA Tempest Documents, 2008.
http://cryptome.info/0001/nsa-tempest.htm.
[38] ZHUANG, L., ZHOU, F., AND TYGAR, J. D. Key-
board acoustic emanations revisited. In ACM Con-
ference on Computer and Communications Security
(2005), V. Atluri, C. Meadows, and A. Juels, Eds.,
ACM, pp. 373–382.