5582431
5454833
345479
0.94
14184460
74619
190.09
5389560
274920
19.60
2127664
134751
15.79
7494383
2157676
3.47
3800612
3597613
1.06
10666
3509
3.04
Root
TLD
1562
1535
27
0.97
2019-02-13
7289
4169
4145
3188
3740
2951
88
35
–
–
–
–
Table 5: Datasets and RR counts (child authoritative)
a large number of static domains with relatively little use that use
low-cost shared hosting.)
Figure 9 shows the CDFs of TTLs of authoritative answers for
each record type. There are no A or AAAA records for TLDs in
root zone, so there we report the A and AAAA records of their
respective NS servers. For other lists of SLDs or full names, we
do not do this indirection and report only A records for the given
name. Our first observation is that TTLs show a large variation in
values, from 1 minute to 48 hours, for all lists and record types.
Second, we see some trends in different lists. In general, the times
reflect human-chosen values (10 minutes and 1, 24, or 48 hours).
In the root, about 80% of records have TTLs of 1 or 2 days. For
Umbrella, on the other hand, 25% of its domains with NS records
are under 1 minute. This difference reflects the list populations—the
root is slowly changing, and changes are carefully monitored and
managed. Umbrella instead reflects many cloud and CDN names,
that are often transient and changing as load comes and goes and
cloud instances are created and discarded.
We also see variation across record type. NS and DNSKEY records
tend to be the longest-lived (Figure 9a), while IP addresses are the
shortest (Figure 9b and Figure 9c). These reflect service dynamics:
changing authoritative servers is an administrative action with
careful planning, while server addresses are often dynamic with
automated creation in clouds and CDNs.
This diversity in TTL choices of major domains suggests some
combination of differing needs and lack of consensus in TTL choice.
5.1.1 TTLs and content type. Besides using our DNS crawler on
the .nl zone, we use data collected using DMap [56], an open-source
multi-application crawler for domain names (it crawls HTTP, DNS,
SMTP, TLS, among other applications). We focus on (i) domains
that have a web page (that is, when the IP address also responds
on port 80 or 443), and (ii) that can were classified by DMap into
one of its categories. In total, on 2019-01-25, there were 58310209
Figure 8: Responses from new server for matched VPs.
For out-of-bailiwick servers, the resolver must explicitly fetch
the address of the authoritative servers. This difference affects who
provides that information: for in-bailiwick, it comes from the parent
based on the glue records, while for out-of-bailiwick it is from NS’s
authoritative server. Resolvers therefore get different TTLs because
parent and child provide different TTLs.
5 TTLS IN THE WILD
While there is limited guidance for setting TTLs, we can look at
how TTLs are set in the wild to see if there is consensus. We look
both at top-level and popular second-level domains, and report on
our discussion of these results with operators.
5.1 Crawling TLDs and Popular Domains
To evaluate how TTL values are used in the wild, we study five data
sources; the root zone, the country-level domain of the Netherlands,
and “top” lists from Alexa [3], Majestic [32], and Umbrella [52]. We
use root data from 2019-02-13, and all other data from 2019-02-
06. While it is known that top lists show considerable churn [46],
our results provide a snapshot of one instant, and the diversity of
sources allows us to evaluate trends.
Methodology: For each list, we retrieve TTLs of several DNS
records (NS, A, AAAA, MX, and DNSKEY) directly from both the
parent and child authoritative servers, measuring from Amazon
EC2 in Frankfurt, querying the parent or the child authoritative
server directly for the measurement (without using shared recursive
resolvers). Here we report results only for the child zone, since that
reflects the operator’s intent, and most recursives are child-centric
(§3).
These results are necessarily incomplete. A full comparison of
parent and child is future work, but we know that the TTL of .nl
is 1 hour, so we know that about 40% of .nl children have shorter
TTLs, as can be seen in Figure 9a. In addition, we study only one
third-level zone for each domain, although actual services may
employ many internal names with different TTLs.
Results: Table 5 shows the sizes of each crawl, and how many
replies we see each record and list. Most lists have high response
rates, with Umbrella as an exception with only 78% responding. The
Umbrella list includes many transient names that point to CDNs or
cloud instances (for example, wp-0f21050000000000.id.cdn.upcbroa
dband.com). We report the number of unique records, and higher
ratios of unique records show greater levels of shared hosting. (The
top lists reflect diverse users and diverse hosting, while .nl reflects
108
 0 100 200 300 400 500 600 700 0 0.2 0.4 0.6 0.8 1VPsresponses from new server (ratio)Cache Me If You Can
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Categories
Placeholder
E-commerce
Parking
Total
#
1199152
148564
127551
1475267
Meaning
Landing page
Shop cart presence
Example
k-man.nl
monsfietsen.nl
coffeebar.nl
Table 6: .nl classified domains by DMap
(a) NS-TTL
(b) A-TTL
(c) AAAA-TTL
(d) MX-TTL
(e) DNSKEY-TTL
Figure 9: CDF of TTLs per record type, for each list.
109
NS
A
AAAA
MX
DNSKEY
Ecommerce
4.0
1.0
0.1
1.0
1.0
Parking
24.0
1.0
1.0
1.0
24.0
Placeholder
4.0
1.0
4.0
1.0
4.0
Table 7: Median TTL values (hours) for .nl domains
NS
A
AAAA
MX
DNSKEY
unique
Alexa Majestic Umbrella
1365
529
116
211
12
1955
4524
896
244
506
0
5385
4187
575
1549
374
2
6202
.nl Root
3414
0
0
673
0
45
0
266
0
15
4047
0
Table 8: Domains with TTL=0 s, per Record Type
domain names in .nl zone. Out of these, 4846496 (83.1%) had both
an A record and an web page.
Table 6 shows the results of DMap classifications for the .nl zone.
We only consider domains that do not redirect to other domains,
either using CNAME records or HTTP redirects. The reason for that
is redirection implies the use of other domains – which therefore
have their own DNS records.
We see that about 1.1M pages are placeholders (domains with
their hosting provider default web page), followed by e-commerce
(148k, which are domains that have webpages with shopping carts
in it), next to parked domains (127k) [53].
Table 7 shows the median TTL value (in hours) per each type
of page, and type of DNS records. We see that Parking has the the
longest median TTL for NS records (24 h), while e-commerce and
placeholders share the same median value (4 h). Their median A
record TTL is the same (1 h).
5.1.2 TTL 0 s. TTL values may range from 0 s to years [34], but
in practice most TTLs measured in-the-wild are under two days
(Figure 9).
While not an error per se, a TTL of 0 s effectively undermines
caching at the resolvers. We show in Table 8 the counts of domains
with TTL equal zero. We see that few domains are configured with
0 s TTLs. We recommend against eliminating caching by setting
TTL values to zero, since it increases latency to users and reduces
resilience (such in cases against DDoS attacks [36]).
5.1.3 Bailiwick configuration in the wild. We have seen in §4
how bailiwick affects the choice of TTLs for a given record. We
now investigate how many domains in-the-wild are in-bailiwick.
Table 9 summarizes the results. We start with the responsive
domains (obtained from Table 5), which are domains that responded
to at least one of our queries (in regardless of query type). To
 0 0.2 0.4 0.6 0.8 1102103104105106107CDFanswers TTL (s)AlexaMajesticUmbrella.nlroot1min10min1h24h48h 0 0.2 0.4 0.6 0.8 1102103104105106107CDFanswers TTL (s)AlexaMajesticUmbrella.nlroot1min10min1h24h48h 0 0.2 0.4 0.6 0.8 110210310410510610710minCDFanswers TTL (s)AlexaMajesticUmbrella.nlroot1min1h24h48h 0 0.2 0.4 0.6 0.8 1102103104105106107CDFanswers TTL (s)AlexaMajesticUmbrella.nl1min10min1h24h48h 0 0.2 0.4 0.6 0.8 1102103104105106107CDFanswers TTL (s)AlexaMajesticUmbrella.nl1min10min1h24h48hIMC ’19, October 21–23, 2019, Amsterdam, Netherlands
G. C. M. Moura et al.
responsive
CNAME
SOA
respond NS
Out only
percent out
In only
Mixed
Table 9: Bailiwick distribution in the wild.
Alexa Majestic Umbre.
783343
988654
452711
50981
59083
12741
271549
924932
878402
244656
90.1
95.0
20070
37552
8978
6823
928299
7017
8352
912930
873447
95.7
28577
10906
.nl Root
1535
0
0
1535
748
48.7
654
133
5454833
9436
12268
5433129
5417599
99.7
12586
2941
evaluate how domains are configured, we consider only NS queries
that had NS records in the answers (we disregard domains that
either returned a CNAME or SOA records to NS queries). We see
that the majority of domain names remain (the “respond NS” row),
for all datasets except the Umbrella list, which uses long FQDNs,
often from clouds and CDNs.
We next evaluate what baliwick these domains use. For the pop-
ular lists, we see that the nearly all (more than 90%) are configured
with out-of-bailiwick NSes only. The exception to that is the list
of TLDs (Roots), which roughly half are out-of-bailiwick and the
other half are either only in-bailiwick or mixed.
5.2 Discussions with Operators
Our crawl of the root zone (§5.1) showed 34 TLDs (including 8
country-code) with NS TTLs less than 30 minutes, and 122 TLDs
with NS TTLs under 120 minutes. These short TTLs are only par-
tially effective because of parent-centric resolvers (§3), and they