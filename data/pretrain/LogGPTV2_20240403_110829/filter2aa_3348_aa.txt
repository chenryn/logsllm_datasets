### 国产智能网联汽车漏洞挖掘中的几个突破点

**演讲者简介**

- **姓名**: 马良
- **职位**: 安全研究员
- **单位**: 绿盟科技 格物实验室
- **背景**: 拥有十多年的嵌入式软硬件开发经验，热爱DIY项目。在多个安全会议上分享过研究成果，包括Xpwn、看雪开发者大会、极棒等。

**个人成就**
- 2016年 Xpwn：展示西门子PLC蠕虫攻击
- 2018年 看雪开发者大会：介绍智能设备固件提取的十种方法
- 2018年 极棒：机器特工挑战赛中，展示了关闭激光报警器电源、窃听器放置及气球遮挡摄像头等技巧
- 2018年 JD-HITB：讨论Vocore2模块在安全研究中的应用，并提出了一种针对工业控制设备的攻击模型
- 2021年 极棒《我是极客》：演示了如何通过改装电源插座并利用4G和电力猫的安全缺陷远程控制内网设备

---

### 目录

1. 概述
2. 常用工具介绍
3. 汽车工程模式与固件提取
4. 典型案例分析

---

### 1. 概述

本节将概述国产智能网联汽车安全研究领域的一些关键概念和技术手段。

### 2. 常用工具介绍

进行车辆测试时，通常需要携带以下工具：
- 各类USB线缆
- USB转TTL模块（支持5V/3.3V/1.8V电压）
- 不同容量的TF卡及其读卡器、U盘
- 用于网络抓包的HUB及车载以太网转换装置
- Wi-Fi与蓝牙抓包环境搭建所需设备
- CAN总线相关的软件和硬件工具，如Fuzz模块
- HarkRF One with Portapack H2或其他软件定义无线电（SDR）设备
- 调试用途的安卓手机（已Root且安装了多种调试软件），以及APK分析工具

#### CAN总线收发和Fuzz工具 - USBtin
- 开源项目网址: [www.fischl.de/usbtin](http://www.fischl.de/usbtin)
- 功能:
  - 探测CAN协议 (USBtinViewer)
  - Fuzzing工具 (CanToolz)

#### 快速Wi-Fi抓包环境设置
- 使用随身Wi-Fi创建一个可控热点，适用于各类智能设备的测试。
- 硬件需求: 随身Wi-Fi + 笔记本电脑 + 手机（开启数据共享功能）
- 分析工具: Wireshark/Fiddler4，支持流量嗅探、重放及解密操作

#### SDR在智能设备无线测试中的应用
- 设备: HarkRF One with Portapack H2
- 应用场景:
  - 无线信号频段监测
  - 流量捕获与重放
  - GPS模拟
- 软件推荐: Universal Radio Hacker (URH)

---

### 3. 汽车工程模式与固件提取

#### 内容摘要
- 在有限预算下开展车联网研究的方法
- 如何识别未知电路板上的电源引脚、CAN接口及以太网端口
- 汽车制造商对系统开发、调试和维护的过程
- 安全研究人员进入车辆内部系统的途径
- 获取特定车型固件更新包的方式
- 当进入工程模式需要密码时的应对策略
- 固件可能存在的常见安全隐患

#### 寻找研究对象
- 整车购买
- 租赁服务
- 参观广州陈田村市场
- 二手交易平台如闲鱼
- 后装或改装市场
- 从4S店获取信息
- 报废或事故车辆来源

#### 示例：某车型IVI接口定义
- **电源**: 5V输入
- **保护措施**: D1防止电源反接；C01, C02为输入滤波电容；C03, C04为输出滤波电容
- **输出电压**: VDD3.3提供3.3V供电

#### 缺乏官方文档时确定电源引脚的方法
- 一般情况下，电源电压为12V，但最好向供应商确认具体数值
- 利用万用表寻找“地”(GND)连接点
  - “地”通常与大面积铜箔相连
  - CPU附近的小电容往往有一端接地
  - 每个集成电路都需要连接至“地”
- 电源电路区域往往集中布置大量电容器
- “地”线与VCC走线较粗
- VCC可能会经过防反接二极管后再经由稳压芯片转换成其他电压等级

#### 无官方资料条件下查找通信接口位置
- CAN总线引脚通常通过电感与控制器局域网(CAN)芯片相连接
- 以太网接口则直接与物理层(PHY)芯片相连
- 查阅相关芯片的技术手册来了解其功能
- 若难以辨认芯片型号，可借助手机微距镜头辅助观察

---

### 4. 典型案例分析

这部分将详细探讨几个具体的案例研究，涵盖IVI（车载信息娱乐系统）和ADAS（高级驾驶辅助系统）等方面。