国 产 智 能 网 联 汽 车 漏 洞 挖 掘 中 的 几 个 突 破 点  
马良  绿盟科技  格物实验室 安全研究员 
自我介绍 
马良  绿盟科技  格物实验室  安全研究员 
十多年嵌入式软、硬件开发经验, 喜欢DIY一些东西 
 2016 - Xpwn：西门子PLC蠕虫演示 
 2018 - 看雪开发者大会：智能设备固件提取的十种方法 
 2018 - 极棒：机器特工挑战赛，关闭激光报警器电源、窃听器放置、气球遮挡摄像头等 
 2018 - JD-HITB：介绍Vocore2模块在安全研究中的应用，提出一种工控设备攻击模型 
 2021 - 极棒《我是极客》：改装电源插座,  通过4G用电力猫安全缺陷远程控制内网设备 
1 
  概   述 
2 
3 
4 
  常用的几个小工具 
  汽车工程模式与固件提取 
目  录 
  典型案例分享  
概  述 
 常用软硬件 
 固件提取 
 工程模式 
 案例 
 IVI(车载信息娱乐系统) 
 ADAS(辅助驾驶) 
1 
  概   述 
2 
3 
4 
  常用的几个小工具 
  汽车工程模式与固件提取 
目  录 
  典型案例分享  
测车常用工具 
出去测试车，一般要带一些工具，例如： 
 各种接口的USB线 
 USB转TTL模块(各种常见电压:、5V/3.3V/1.8V) 
 各种容量的tf卡和读卡器、U盘 
 网络抓包的HUB，车载以太网转换器 
 Wi-Fi抓包环境、蓝牙抓包环境 
 CAN总线抓包、分析和重放的软件和硬件 
 CAN总线Fuzz模块 
 HarkRF One with Portapack H2 或 其它SDR 
 调试用的安卓手机(Root、装好各种调试软件)，各种APK分析工具 
CAN总线收发和Fuzz工具 
USBTin 
 软硬件开源(www.fischl.de/usbtin) 
 CAN协议探测(USBtinViewer) 
 Fuzz工具:CanToolz 
Wi-Fi快速抓包环境搭建 
受控的可抓包热点，用于各种智能设备测试 
 硬件: 随身Wi-Fi 
 笔记本电脑+手机USB口共享流量 
 Wireshark/Fiddler4嗅探、重放、解密 
笔记本电脑 
USB1            USB2  
手机 
开网络流量共享 
随身Wi-Fi 
被测设备 
HarkRF One with Portapack H2(SDR） 
用于智能设备无线测试 
 无线流量的频段嗅探 
 无线流量的抓取和重放 
 GPS的模拟 
 软件: Universal Radio Hacker(URH) 
1 
  概   述 
2 
3 
4 
  常用的几个小工具 
  汽车工程模式与固件提取 
目  录 
  典型案例分享  
工程模式与固件提取：内容摘要 
 经费预算少，研究车联网，去哪里买车联网部件？ 
 如何确定未知电路板的电源引脚、CAN引脚、以太网引脚? 
 车厂是怎么开发、调试和维护的汽车系统的？ 
 安全研究员一般怎么进入系统内部？ 
 怎么搞到对应车型的固件升级包？ 
 进入工程模式有密码，怎么办? 
 固件有哪些常见的风险点？ 
找研究目标 
 买整车 
 租车 
 广州陈田村一日游 
 咸鱼 
 后装/改装市场 
 4S店 
 报废车、事故车渠道 
某车 IVI 接口定义 
 电源 
 USB 
 CAN 
智能设备的电源原理图 
 输入是5V电源 
 D1作用是防止电源反接。 
 C01、C02是电源输入滤波电容； 
 C03、C04是输出滤波电容。 
 VDD3.3是3.3V电源 
没官方资料，找电源引脚的办法 
 电源电压一般是12V，也可向卖家确认 
 万用表先找到“地”--- GND 
     电路板上的“地”一般都是连在一起的 
   “地”一般和大块铜皮相连 
     CPU旁边的小电容一般有一端接“地” 
     每个芯片都要接“地” 
 一般有大电容且集中的地方是电源电路 
 “地”和VCC一般走线比较粗 
 VCC可能经过一个大的二极管（防接反） 
 VCC经过稳压等芯片转换成其它电压(可查手册确认) 
 金属外壳的接插件一般外壳焊在板子上的一般都是GND 
GND 
VCC 
没官方资料，找电路通信引脚的办法 
 CAN管脚一般通过电感和CAN控制芯片连接 
 以太网引脚一般和以太网PHY芯片连接 
 查找对应芯片的手册，知道芯片功能 
 如果看不清芯片型号，可以用手机微距镜头拍摄 