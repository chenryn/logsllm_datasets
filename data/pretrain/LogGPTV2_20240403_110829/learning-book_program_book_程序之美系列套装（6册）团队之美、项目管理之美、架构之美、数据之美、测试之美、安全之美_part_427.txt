## Page 2475
那么家长们又如何来访问这种日程表？由保姆来选择哪些人有访问
的权限，这是通过计算SHA256（家长的姓名+家长的密码）来实现
的。然后他们会在一张类似于图15-4所示的访问表中添加一条记
录。
2474
---
## Page 2476
家长们可以通过输入他们的姓名和密码来登录以生成他们的别名。
然后他们可以查询这个访问表来找出保姆姓名的别名。这就使得他
们能够查询日程表以查看是否有合适的保姆。如果保姆没有将某位
家长的别名放到第二张表中，那么这位家长就是被拒之门外了。如
此，保姆的信息就处理控制之中。
家长们怎样知道到底是哪个保姆？第三列中包含了使用家长的姓名
与密码进行加密的保姆姓名。这样的话，每一行保姆的真实姓名就
可以由该行中相应的家长的姓名与密码进行解密。在这种情况下，
得出，之前也说过，密钥的计算稍有不同，即SHA256（家长的密码
+家长的姓名）。如此，家长们只需要有一对信息（姓名和密码）来
计算他们的别名和密钥，但是没人能够从公开的别名中猜测出秘密
密钥。
2475
---
## Page 2477
15.3为便利而存储的个人数据
我的系统最大的好处在于保护了商店为了方便而记录的数据。许多
商店，不管是实体店还是在线商城，都会将顾客的送货地址、信用
这些信息的麻烦。
保护这些信息的一种方案是把传统的加密技术和单向散列函数组合
起来使用，然后利用单向散列函数对姓名和密码进行计算以得出密
钥。即对地址和信用卡号用SHA256（密码+姓名+填充字符）计算得
到的密钥进行加密，其中填充字符是某种额外添加的随机值，以确
保生成的密钥不同于用来替代姓名的数字别名SHA256（密码+姓
名）。
在商品货物离开商场之前，商家需要一直保持跟踪顾客的送货地
址。然后他们就可以将该数据删除，只保留加密的版本，直到顾客
再次光顾。
15.4如何权衡
将数据库转换成一堆难以理解的二进制数据究竞有没有意义？以下
是我所认为的这种方法所具有的几点优势：
更低的安全成本
这些二进制数据应该对任何拥有管理权限的人都没有用处。这种系
统甚至更易于将整个数据库都分发给几个网站，因为每个单独的网
站所拥有的信息较少。如果数据是不可理解的，那么泄密就不再是
问题。
更低的计算成本
服务器不需要对数据进行加密或者使用SSL会话协议。而客户端却拥
有足够多的计算周期来消耗，所以使用客户端来代替。
更有效的数据库操作
这也许是一种次要的效果，但是一个好的单向散列函数应该让数据
库密钥均匀分布于散列空间。如果你使用一些类似于姓名之类的字
2476
---
## Page 2478
符串，那么你将会被那些常见的单词和姓名所纠缠，以至于让数据
库索引变得更慢。
但是，使用这种方法也需要付出一些代价：
没有负责恢复的超级用户
如果服务器管理员没有权限来读取数据，那么他也没有修改数据的
权限。中心不能主动为之使用半透明化数据库的商店无法给用户提
供服务，除非用户提供了他的别名才能启动服务。商店是不可能发
出像这样的电子邮件通知的，“你曾买了A、B和C，所以我们想你也
许会喜欢correlation_function（A,B.C）。"但有些人认为这恰恰是它
的一种功能，它能减少垃圾邮件。
客户端变成了目标
如果服务器是中立的，那么黑客就会转而攻击客户端，他们会利用
强大的密钥噢探器，社会工程和其他的恶意软件等手段。这时候用
户也许就不是一名好的系统管理员，他们可能不擅长阻正这种行
为。但是，攻击一个单独的客户端所产生的危害要远小于攻击一个
中央服务器。
加密了的数据更加脆弱
对于姓名来讲，一个简单的拼写错误是可以恢复的，但是对于
SHA256（x）来说，一位的变化都会使结果产生巨大的不同1。
这些考虑说明这种办法最适合于保护那些比较温和的敏感数据，即
使这些数据去失了也不会产生真正的后果。一位去失了访问某家商
店购物历史权限的顾客也不会产生多么严重的不便。但是，一位不
能访病历的病人可能就比较麻烦了。
这种方法的最好的用途之一是用于多层次数据库。医院可以把病人
的记录原封不动的保存在一个中英服务器中，同时也可以使用半透
明化的方法将数据发送给研究人员以做统计分析。研究人员仍然能
够使用真实的数据而不必担心隐私保护的问题（Schneier2007）。
[1]在《TranslucentDatabases》中介绍了几种比较好的减少这种危险
的方法，在某些情况下，还能消除这种危险。
2477
---
## Page 2479
15.5进一步深入
单向散列函数只是解决数据保护问题的开始。由密码学家发明的其
他传统的数学工具都能够以同样的方法用于隐私保护。例如，隐写
术的应用能够将一个隐藏的数据层和真正的层相混合，有效地创建
了一种双重数据库。只有拥有正确的隐写层解密密钥的用户才能提
取第二层的数据。公钥加密方案也能够创建一种单向函数，但是只
要拥有私钥的人都可以对数据库进行解密。在《Translucent
Databases》（参见15.6节）中对这些方案都一一作了详述。
数字堡垒是传统的存储敏感信息的方法。那些最好的数据库公司里
有很多天才，他们给数据加上了层层坚固无比的保护层，有访问级
别、安全模型和许多其他的角色管理方案以允许正确查询，并阻止
可疑的行为。这些“不可攻破的”系统有它们的地位，但它们一般都
比较复杂，昂贵而脆弱。最好的方法就是不保存任何真实的数据，
而让用户自己去掌握他们的信息的命运。
15.6参考资料
佚名，"BetrayingOne'sPassengers，“《纽约时报》，2003年9月23
日。
David Brin,《The Transparent Society》，New York:Basic Books，
1998.
Fox Butterfield,"Theft of Painkiller Reflects Its Popularity on the
Street，”《纽约时报》，2001年7月7日。
AmitaiEtzioni，"PrivacyAin'tDeadYet，”《纽约时报》，1999年4月6
日。
时报》，2004年11月15日。
Barry Meier，"3 Executives Spared Prison in OxyContin Case，"《纽约
时报》，2007年7月21日。
EricPfanner，"DataLeakinBritainAffects 25Million，”《纽约时
报》，2007年7月22日。
2478
---
## Page 2480
Philip Shenon、 John Schwartz,"JetBlue Target Of Inquiries By 2
Agencies，”《纽约时报》，2003年9月23日。
Bruce Schneier，"Why'Anonymous'Data Sometimes Isn't，"《在线》，
2007年12月13日。
12/securitymatters_1213
Matthew L.Wald，"U.S.Calls Release of JetBlue Data Improper，"《纽
约时报》，2004年2月21日。
Matthew L.Wald，"Randi A.J.v.Long Is.Surgi-Center,No.2005-04976."纽
约中级上诉法院，2007年9月25日。
Peter Wayner，《Translucent Databases》，Flyzone，2003。
http://www.wayner.org/books/td/.
Tom Zeller,Jr."U.S.Settles With Company on Leak of Consumers
Data，”《纽约时报》，2006年1月27日。
第16章铸造新词：PC安全剧场
天空中阴云密布，大地上笼罩着不安的气氛。盗贼们在大路上肆无
忌惮地游荡，路边的每棵大树后面都隐藏着张牙舞爪的怪兽，巫师
一边念着咒语一边把护身符交给行人，声称能够向他们提供保护。
我们的主角相信灵符具有强大的威力，能够神奇地使自己变成金刚
不坏之身，战胜前进路上的一切艰难险阻。
但是，我们的主角受到了欺骗。目不识丁的农民们在他身边不
休地重复着护身符小贩的胡扯。但他很快将会发现，这些咒语和魔
法完全不能代替铠甲利剑以及头脑里的良好计划。
尽管这看上去像是鬼怪小说的开头，但它却反映了计算机安全的现
状。
问题并不在于我们用于保护自己的计算机的解决方案的质量。实事
求是地说，当前的许多安全解决方案是非常出色的，是由具有奉献
精神、经验丰富并且关赋非凡的人们所创建的。但是，当我们观察
2479
---
## Page 2481
安全的总体状态时，目前这些成果更像是错误的方向和魔法师的符
咒，而不是负责的有效策略。
我们需要的是一种新的安全策略，能够更好地利用当前的工具，并
指导开发新的工具。古代的炼金士和药剂师在化学和医学上留下了
许多有价值的发现，但他们的深刻见解只有在现代科学观得到发展
之后才被证实是有效的。对于当前大量的反病毒和反间谍软件产
品、防火墙、沙盒等工具，情况也是这样的。除非我们采用了一种
新的安全方法，否则这些常见的工具在不远的将来会变以无能为
力，从长远来说也是偏离了方向（对于大部分而言）。我们的研究
和开发通过虚拟和现实（持续的）系统的管理，通过使用人工智能
（AI）检测反常行为，通过加速的反病毒产品的开发，开启了新的
保证安全的可能性。本章讨论了一些驱使我们转向这种解决方案的
问题，并介绍了我们当前在一个称为Returnil的产品上所做的工作。
16.1攻击不断增加，防御不断倒退
为了理解我们现在处于什么位置上，我们必须回顾安全市场的主体
是在什么地方偏离轨道的。我们并不需要追溯到20世纪70年代第一
个真正的病毒出现的时候，也不需要回望80年代针对日益流行的
IBM兼容PC所设计的新的恶意软件的时候，而只需要回顾90年代末
期Internet泡沫繁盛的年代。当时有大量的专业知识投入到网络防御
的开发之中，但是战争的天平还是向垃圾邮件发送者和间课软件发
行者倾斜。
16.1.1在Internet的传送带上
链条的第一个环节是反病毒厂商之间的区别的消失。直到20世纪90
年代中期之前，恶意软件的传播主要通过在一起工作或者相互熟悉
的人们之间交换被感染的文件。因此，它在不同的地理位置之间的
传播不会非常快速，这就导致了许多小型的、区域特定的解决方案
供应商的出现。
随着Intermnet的不断普及以及恶意软件通过电子邮件地址的传播不断
增加，显然反病毒厂商需要扩展它们的视野，处理“其他人的问
题”。虽然许多大型供应商仍然抵制这种变化，但是那些率先改变思
维的厂商由于大肆宣传它们的检测功能而收获了丰硕的成果。这个
转变导致了一段时期的联合，较大的公司开始合并或者收购竞争对
2480
---
## Page 2482