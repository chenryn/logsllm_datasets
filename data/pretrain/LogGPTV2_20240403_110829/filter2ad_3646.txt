# Proofs of Remote Execution and Mitigation of TOCTOU Attacks

**Author: Gene Tsudik  
University of California, Irvine (UCI)  
Irvine, CA, USA  
Email: [Your Email Address]**

## ABSTRACT

### Part I: Introduction to VAPE
Modern society is increasingly reliant on a wide range of Cyber-Physical Systems (CPS), Internet-of-Things (IoT) devices, and smart devices. These systems often perform safety-critical functions in various settings, including homes, offices, medical facilities, automotive, and industrial environments. Some of these devices are small, inexpensive, and specialized, such as sensors and actuators. They typically have limited resources and run simple software, sometimes directly on the hardware. If left unprotected, the consequences of forged sensor readings or ignored actuation commands can be catastrophic, especially in safety-critical contexts.

This raises three key questions:
1. How can we trust data produced by a simple remote embedded device?
2. How can we ensure that this data was generated by the expected software?
3. Is it possible to achieve (1) and (2) under the assumption that all software on the remote device could be modified or compromised?

In the first part of this talk, we address these questions by introducing VAPE: Verified Architecture for Proofs of Execution. This is the first of its kind solution for low-end embedded systems. VAPE has a wide range of applications, particularly in authenticated sensing and trustworthy actuation, which are increasingly important in safety-critical systems. The VAPE architecture is publicly available and incurs minimal overhead, making it feasible even for the lowest-end embedded devices.

### Part II: Addressing the TOCTOU Problem in Remote Attestation
Significant attention has been given to verifying the software integrity of remote embedded (IoT) devices. Various techniques, with different assumptions and security guarantees, have been proposed under the umbrella of Remote Attestation (RA). RA serves as the foundation for many security services, including proofs of memory erasure, system reset, software update, and runtime verification.

However, all prior RA techniques verify the remote device’s state at the time when the RA functionality is executed, providing no information about the device’s state before or between consecutive RA executions. This means that transient malware may go undetected. Specifically, if transient malware infects a device, performs malicious tasks, and leaves before the next attestation, its temporary presence will not be detected.

This problem, known as Time-Of-Check-Time-Of-Use (TOCTOU), is well-documented in the research literature but remains unaddressed in the context of RA. In the second part of this talk, we discuss Remote Attestation with TOCTOU Avoidance (RATA): a provably secure approach to address the RA TOCTOU problem. With RATA, even malware that erases itself before the next RA execution cannot hide its ephemeral presence.

RATA targets hybrid RA architectures for low-end embedded devices and comes in two versions: RATA-A and RATA-B, suitable for devices with and without real-time clocks, respectively. Both versions are shown to be secure and are accompanied by a publicly available and formally verified implementation. These techniques incur low hardware overhead and significantly reduce the computational costs of RA execution.

## CCS Concepts/ACM Classifiers
- **Security & Privacy**: Network Security, Security Protocols
- **Security in Hardware**: Embedded Systems Security, Hardware Security Implementation

## Keywords
- CPS Security
- Embedded Systems Security
- Remote Attestation
- Denial of Service
- Software/Hardware Co-Design

## BIOGRAPHY
**Gene Tsudik** is a Distinguished Professor of Computer Science at the University of California, Irvine (UCI). He received his PhD in Computer Science from the University of Southern California (USC) in 1991. Before joining UCI in 2000, he worked at the IBM Zurich Research Laboratory (1991-1996) and USC/ISI (1996-2000). His research interests include security, privacy, and applied cryptography. Gene Tsudik is a Fulbright Scholar, Fulbright Specialist (twice), and a fellow of ACM, IEEE, AAAS, IFIP, and a foreign member of Academia Europaea. From 2009 to 2015, he served as Editor-in-Chief of ACM Transactions on Information and Systems Security (TISSEC, renamed TOPS in 2016). He received the 2017 ACM SIGSAC Outstanding Contribution Award and is the author of the first crypto-poem published as a refereed paper.

## REFERENCES
1. I. De Oliveira Nunes, K. Eldefrawy, N. Rattanavipanon, and G. Tsudik, "APEX: A Verified Architecture for Proofs of Execution on Remote Devices under Full Software Compromise," USENIX Security Symposium 2020.
2. I. De Oliveira Nunes, S. Jakkamsetti, N. Rattanavipanon, and G. Tsudik, "On the TOCTOU Problem in Remote Attestation," arXiv:2005.03873.

**Keynote Talk ASIA CCS '20, October 5–9, 2020, Taipei, Taiwan**