librt
libpcre
libc
libattr
libgmp
libgcc
libcap
(39.94%)
(75.41%)
(53.13%)
(69.99%)
(71.64%)
(10.15%)
(28.28%)
(38.17%)
(46.43%)
(92.26%)
(49.97%)
MySQL
libm
libpthread
libz
libc
libgcc
libstdc++
libdl
libcrypt
(44.25%)
(34.33%)
(29.37%)
(34.23%)
(56.10%)
(45.04%)
(26.70%)
(4.30%)
Nginx
libpthread
libz
libc
libdl
libpcre
libcrypt
libcrypto
(47.75%)
(60.91%)
(40.78%)
(26.70%)
(10.09%)
(6.42%)
(83.56%)
51.5%
46.5% 53.1% 50.1%
50.4%
44.1% 59.8% 44.6%
85.5% 100.0% 100.0% 92.3% 88.9% 100.0% 90.0% 85.2%
80.7% 84.7% 65.2%
67.3%
52.9% 62.0% 63.2%
70.4%
69.2% 57.1% 52.7%
74.4% 80.0% 65.9%
40.0% 79.7% 62.6%
70.3%
85.2% 70.3% 77.2%
16.7% 21.2% 11.5%
12.1%
10.2% 15.2%
7.9%
33.4% 31.0% 44.5%
38.6%
21.8% 49.0% 45.9%
0.0% 22.2% 37.9%
32.4%
50.0% 10.0% 71.1%
42.6% 48.3% 66.0%
57.3%
49.2% 65.7% 60.0%
98.2%
92.8% 98.0% 97.6%
99.6% 99.0% 99.0%
60.0% 75.9% 54.1% 100.0% 78.6% 50.8%
56.8%
64.7%
60.0%
80.8%
22.6%
45.0%
68.4%
61.9%
95.9%
62.5%
49.9%
44.4%
47.8%
42.5%
61.1%
59.0%
38.6%
7.3%
49.3%
69.5%
49.2%
38.6%
11.5%
11.1%
89.2%
29.9%
47.0%
38.9%
55.5%
44.6%
60.5%
0.0%
14.3%
48.5%
63.9%
64.0%
0.0%
22.6%
25.0%
90.8%
45.4% 54.7% 32.4%
37.8% 48.6% 45.6%
22.6% 63.6% 40.7%
26.1% 53.2% 54.3%
59.9% 60.9% 40.1%
39.1% 54.4% 62.2%
0.0% 35.9% 27.8%
5.0%
9.5%
6.2%
75.6% 41.8% 55.8%
44.1% 50.4% 39.9%
79.8% 57.8% 57.3%
30.4% 30.7% 45.3%
22.7% 46.9% 72.1%
46.9% 64.8% 68.9%
78.3% 43.3% 37.0%
25.0%
0.0% 10.9%
49.4% 47.2% 49.7%
53.8% 80.3% 60.7%
32.3% 58.2% 64.0%
0.0% 35.9% 27.8%
10.2% 14.2%
7.9%
7.1%
6.2% 13.9%
80.7% 87.7% 92.3%
42.6% 54.1% 43.2%
87.9% 67.5% 81.1%
38.1% 36.1% 51.9%
78.3% 43.3% 37.0%
16.2% 17.6% 11.1%
25.0%
0.0% 10.9%
87.1% 85.8% 90.5%
49.9% 56.9%
93.3% 91.3%
64.2% 84.1%
86.5% 78.2%
59.7% 66.7%
11.3% 22.6%
35.2% 47.3%
25.7% 18.2%
55.6% 55.0%
99.3% 99.2%
29.2% 50.0%
47.9% 71.9%
41.4% 50.5%
43.3% 66.0%
38.0% 48.9%
53.6% 81.2%
63.4% 64.4%
68.3% 56.5%
4.0%
0.0%
51.5% 55.1%
62.2% 78.7%
44.5% 56.5%
68.3% 56.5%
10.3% 19.2%
6.0% 25.0%
79.3% 87.6%
43.2% 48.8%
0.0%
50.0% 76.9% 80.0%
79.9% 62.2% 91.8%
73.5% 73.9% 91.4%
73.7% 81.0% 50.0%
12.9%
8.1% 12.8%
43.7% 28.5% 50.1%
25.0% 16.7%
0.0%
63.2% 52.2% 48.2%
98.0% 98.7% 85.7%
50.0% 54.5% 20.0%
46.4% 51.6% 55.9%
43.9% 38.7%
0.0%
27.3% 39.6% 59.3%
45.3% 34.3% 44.5%
62.0% 73.3% 14.3%
64.9% 53.2% 49.7%
0.0% 46.2% 33.3%
8.7%
0.0%
0.0%
47.0% 52.5%
0.0%
78.2% 66.7% 70.4%
58.0% 39.3% 58.0%
0.0% 46.2% 33.3%
7.9% 12.8%
12.2%
8.7%
0.0%
0.0%
88.3% 90.3% 83.3%
44.2% 55.2%
N/A 77.3%
N/A 63.8%
N/A 67.6%
66.7% 69.3%
0.0% 16.0%
49.1% 36.2%
N/A 46.1%
N/A 55.1%
100.0% 97.5%
100.0% 51.9%
71.4% 42.4%
40.7% 46.6%
N/A 51.6%
57.0% 41.0%
0.0% 63.7%
50.0% 63.6%
N/A 33.3%
0.0%
5.7%
43.0% 53.5%
N/A 74.3%
59.4% 46.7%
N/A 33.3%
0.0% 15.0%
0.0% 10.6%
91.7% 89.3%
Table 7: Per-library debloating in Nginx with Nibbler, static
linking, and LTO.
Code in Scope
easily modify their exploits to use gadgets, or whole functions, from
the residual code. The purpose of this experiment, however, was
to demonstrate that Nibbler can thwart canned exploits with no
additional run-time overhead.
libcrypto
libc
libpthread
libz
libpcre
libcrypt
libdl
Total (Lib.)
# of Functions (Size in KB)
Static
33
(22.14)
1025
(697.08)
55
(6.01)
66
(40.01)
48
(122.57)
37
(30.38)
9
(0.06)
1270
(911.24)
Dynamic Nibbler
317
(105.76)
921
(683.24)
142
(25.69)
46
(31.83)
45
(115.56)
28
(19.29)
16
(1.69)
1581
(990.07)
5085
(1155.25)
2889
(1172.84)
297
(49.43)
140
(84.55)
74
(158.82)
39
(20.45)
24
(2.54)
8548
(2643.89)
Static+LTO
33
(22.14)
1025
(697.08)
55
(6.01)
41
(28.35)
22
(108.49)
37
(30.38)
9
(0.06)
1222
(892.51)