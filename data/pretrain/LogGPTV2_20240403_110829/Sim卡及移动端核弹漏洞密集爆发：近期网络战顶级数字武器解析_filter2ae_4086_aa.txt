# Sim卡及移动端核弹漏洞密集爆发：近期网络战顶级数字武器解析
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
2019年下半年以来，伴随着两个核弹级Sim卡漏洞披露，多个Android和IOS漏洞的曝光，关于对应漏洞的移动设备武器又将纳入各国网络武器库，而需要注意的是，其中有多个漏洞已经被武器化且被利用。
奇安信威胁情报中心红雨滴安全团队在对这几起曝光的漏洞事件进行分析后，综合得出以下结论：网络战争将携移动设备武器，针对随身携带设备对目标进行监听和攻击。
为了更好理解事态的严重性，我们将这几起漏洞事件进行简单分析后，公布于此，以供参考。
## Simjacker漏洞与SS7攻击
首先是曝光的第一个Sim卡漏洞，在此之前，先介绍一下现代SIM卡，
现代SIM卡是一个软件和硬件的组合产品，如下图[1]所示，具有系统、文件、指令、业务四层结构。其中需要过多谈及软件部分，COS也就是SIM卡的操作系统。
而这里的卡，指的是USIM卡，也就是通用用户识别模块，其中UICC(通用集成电路卡)上便搭载着S@T 浏览器。
而Simjacker漏洞触发的原因主要由于，部分运营商发行的SIM卡中S@T
浏览器对收到的消息有效性所对应的安全配置存在校验错误，由于S@T浏览器通常使用短信与S@T网关进行交互，因此如果Sim卡的网关侧不过滤构造的漏洞利用数据包，并可成功将载荷发送到目标的S@T浏览器，即可满足第一个攻击条件。而第二条件则需要确定目标的SIM卡确实安装了S@T浏览器。
满足条件后，则实现对目标进行远程攻击，例如：
1、发送虚假信息（例如通过发送带有攻击者控制内容的SMS / MMS消息）
2、欺诈（例如通过拨打额外费率号码），
3、间谍活动（以及通过拨打号码来检索攻击设备的位置，充当窃听设备），
4、恶意软件传播（通过强制浏览器打开包含恶意软件的网页）
5、拒绝服务攻击（例如禁用SIM卡）
6、信息检索（检索语言，无线电类型，电池电量等其他信息）
其中，需要注意的是，Simjacker已经被国家网军所使用至少两年之久，在野攻击中所使用的Simjacker消息具有以下结构
而根据Adaptive的白皮书显示，网军的攻击目标绝大多数目标移动用户来自墨西哥，而这些特定的攻击者偶尔会针对来自哥伦比亚和秘鲁的移动用户，但与针对墨西哥的目标设备相比，这些用户量要小的多。
而在这其中，有45%的用户仅被攻击了一次，而少数用户被攻击了数千次。
需要注意的是，发起Simjacker攻击消息的绝大多数来源均为真实设备，在这里有需要提及一个概念。
7号信令，又称为公共信道信令。即以时分方式在一条高速数据链路上传送一群话路信令的信令方式，通常用于局间。SS7网络是一个带外数据通信网，它叠加在运营者的交换网之上，是支撑网的重要组成部分。
这里提到的SS7，就是攻击者接入用于攻击的网络，Adaptive记录了多个SS7地址，发现其遍布全球，并试图向墨西哥移动用户发送带有Simjacker
Attack的SMS(短信)消息。
通过这些地址，还发现网军除了使用Simjacker发起攻击外，还会使用经典的SS7攻击，即通过老旧的SS7漏洞进行电话窃听。因为平时根本用不到SS7，算是电信骨干网中用于在特定时候维护通信的存在，目前被用于设置漫游，以便能在在所属运营商范围之外也能拨打电话收发短信。域外运营商会通过SS7向所属运营商发送获取手机唯一ID的请求以便跟踪手机，还会请求手机通信被重定向到它的网络以便投递呼叫和短信。这是一种确保跨网络通信的手段。
因此，任何能登入SS7网络服务器或网关的人，都可以向电信公司发送位置漫游和重定向请求，而电信公司多半会遵从请求，即使漫游请求是从圣彼得堡或孟买发出而你的手机却在纽约。这就使得攻击者可以远程窃听立法者、公司高管、军方人员、激进分子和其他人士。[2]值得注意的是，通过劫持你的短信和通话，攻击者也就能够获取Gmail和其他服务通过短信发送的双因子身份验证登录码。已经知道用户名和密码的攻击者就能在你收到之前拦截验证码，登录你的账户。目前这类漏洞已经得到缓解，但是仍然存在。
这也说明为什么，能登入SS7网络发起攻击的黑客，很大概率具备国家背景的原因。
最后，除了SS7来源外，网军还会通过VASP短代码发送的SMS
Simjacker攻击，该代码直接将这些消息提交给目标运营商SMSC。这样做是为了避免过滤设置，因为这样做可以使得目标认为来自VASP源的消息是安全可信的。
最后，白皮书提到了一点，这个负责进行监视的攻击者，实际上是一个监视公司，然后其会将SS7攻击的访问权出售给众多国家，因此造成了攻击目标的不同，目前他们不便透露具体的监视公司。
目前有以下范围的国家使用了未设置安全级别的S@T浏览器的SIM卡。
更多细节请见文末的白皮书[3]
## WIBattack漏洞
上面提到的Simjacker漏洞被披露后不久，Ginno安全实验室介绍了一个名为WIBattack的漏洞，而这也在Adaptive白皮书中记录了：S@T浏览器不是唯一可以被利用的SIM卡应用程序，从理论上讲，任何SIM卡应用程序也可能受到类似SimJacker的攻击，WIB也是。
WIB，无线因特网浏览器，他可以使移动运营商能够提供先进的动态更新和下载机制，下载应用和插件（浏览器功能的延伸）到SIM卡。这是一种SmartTrust公司提出的集成在SIM卡中的浏览引擎标准，能解释WML（Wireless
Markup Language）无线标识语言。
此外，WIB起着菜单驱动器的作用，并会预先驻留在手机SIM卡中，负责解释并处理已经转换为WML的下载请求和菜单数据。
Ginno称，他们发现该漏洞在2015年对全球数亿电信用户造成了严重损害，并且该漏洞尚未发布。
通过向受害人的电话号码发送恶意短信，攻击者可以使用WIB
sim浏览器中的漏洞来远程控制受害人的手机以执行有害操作，例如：发送短信，打电话，获取受害人的位置，启动其他浏览器（例如WAP浏览器），获取受害者的IMEI等。
攻击场景如下所示，首先攻击者向受害人的电话号码发送了恶意的OTA SMS，也就是空中下载短信，OTA
SMS中包含了WIB命令，当受害者受到信息后，其会立即使用Envelop命令(一条在手机和SIM卡之间进行通信的应用协议数据单元APDU命令)将OTA
SMS的传送协议数据单元转发到受害者Sim卡中的WIB浏览器。
需要注意的是，OTA SMS的接收过程是静默处理，不会有任何提醒。
紧接着，WIB浏览器遵循OTA SMS的TPDU中的WIB命令，并将上面提及到的例如要求发送短信的命令发送到受害者手机上。这样受害者就会按照命令执行。
下图未几个敏感的WIB命令。
如果SIM卡开启了关键安全功能，那么攻击者无法通过短信的形式实现攻击，由于装载了无线互联网浏览器功能WIB的SIM卡理论上都会面临威胁，初步估算影响数量达到上亿级。
更多细节请见文末链接[4]
## IOS越狱漏洞
在讨论完SIM卡的威胁后，我们把注意力放回到移动端操作系统层面，下面将搬出日前沸沸扬扬的IOS硬件越狱漏洞，由iOS安全研究者@axi0mX披露，存在于iOS设备上的BootROM漏洞，他将其命名为checkm8，读作checkmate，也就是国际象棋术语中的“将死”。