年之前,Hook007家族,还是原始版本的Gh0st远控,启动参数带有Hook007,fuck360,fuck007等,通过不同的启动参数,决定木马执行安装流程还是远控流程。
2012年中旬,基于开源远控协议,大约每两三天发一批新域名的木马。IP由域名解析得到。
2012年底,基于开源协议进行小幅度变种。大约每两三天发一批新域名的木马。IP由域名解析得到。
2013年中旬,基于开源协议进行大幅度变种,需通过大数据分析捕获协议特征。大约每天发一到两批新域名的木马。IP由域名解析得到。
2013年中下旬,基于开源协议,针对360监控模式,加入混淆数据,大约每天发三到四批新域名的木马,IP由域名解析得到。
2014年初,基于开源协议加入迷惑性数据,伪造成其他常见数据协议,难与主流协议区分。无新域名,采用直接访问IP,大约每天发七到八批新IP的木马。
2014年中旬,网络协议为自定义协议,同时伪造成其他常见数据协议,通过第三方平台网站的自定义内容跳转到制定IP,大约每天发六到七批新木马。
2015年初,网络协议为自定义协议,直接请求IP,如果无法上线,再通过第三方平台网站的自定义页面查找新IP,约每半小时一批新IP木马。
2015年中下旬,更新自定义协议,直接请求IP,如果无法上线,再通过第三方平台网站的自定义页面查找新IP,约每半小时一批新IP、新协议木马。
第三章该组织使用的C&C
一、C&C分类
该组织出现使用的C&C(Command and
control,通信控制)非常多,相关域名、IP也是分工明确。我们大概从C&C功能的角度分析出相关C&C的种类:
1)直接连IP
2)连攻击者所持有的域名,进一步解析域名指向IP
3)连接腾讯微博,解析页面中IP
4)连接永硕E盘,解析页面中IP
5)验证或更新的IP:专用于后门更新的服务器。
6)伪造游戏平台网站的域名和IP
另外在本报告“第三章
攻击手法分析”中“三、持续对抗”章节,我们已经介绍了攻击者在网络层面是如何进行持续对抗的,也就是下图可以看出攻击者在选择C&C的变化趋势。
图 33恶意代码与服务器通信变化趋势
二、依托第三方平台中转
下面两个图是永硕E盘和腾讯微博获得上线IP的具体截图:
图 34利用永硕E盘获得上线IP
图 35利用腾讯微博获得上线IP
下面两个截图是攻击者用来解析腾讯微博上线IP地址的工具,和该工具相关代码截图。
图 36解析微博、网盘工具
图 37微博IP查询器相关代码截图
第四章幕后始作俑者
007组织相关成员分工明确,从制作恶意代码到最终获利组成了一条完整的地下产业链。主要包含制作恶意代码、传播、更新、获利等环节。
从目前我们已知的数据来看,该组织相关成员主要分布在湖北、山东和广东三个地区。
图 38 007组织架构
007组织主要以Hook007(嫌疑人01)为主,Hook007和另一名嫌疑人02是主要开发人员,开发的恶意软件以Hook007远控(给力远控)为主。另外Hook007与黑友(又名黑色经济,嫌疑人08)在早期就有相关业务合作,黑友的角色与广东熊二(嫌疑人06)相似。相关更新维护工作主要围绕Hook007远控展开。以Hook007远控为主的恶意软件会提供给山东相关同伙和广东同伙,其中以广东的熊二为主。以广东熊二为例,熊二作为代理商的角色会将相关远控工具在提供给其他下级买家。
进一步后续会有专人负责传播恶意代码和相关窃取用户数据、恶意推广。由于相关传播过程需要社会工程学欺骗受害者,以及需要与受害者多次交互,所以我们推测相关传播恶意代码的人员和窃取用户数据的人员会有重叠的情况。最后相关人员将窃取的数据信息通过第三方网络游戏交易平台或其他渠道进行交易,最终达到获利。
另外值得我们注意的是广东相关同伙的上家除了Hook007,还有其他组织提供大量的恶意程序。另外山东同伙涉及Android木马(以短信拦截马为主)的相关业务。
1 Hook007家族样本分析报告
具体请参看:
1、“罪恶家族——Hook007木马”,[http://blogs.360.cn/blog/Hook007_trojan/](http://blogs.360.cn/blog/hook007_trojan/)
2、“罪恶家族Hook007之潜伏篇”,
2 007组织涉案金额估算
007组织核心成员涉案金额(单对Hook007生成器估算)  
---  
估算方法
|
单价:300元
生成器数量(三个月):120个
拥有生成器的人数:1个生成器对应10个人  
结论
|
一年估算:300*120*10*4=144万元  
受害用户损失金额(单对受Hook007家族影响的估算)  
---  
估算方法
|
近一年受影响用户约:50万左右
真正被窃取装备的用户估算为受影响的1/100:5000
根据专业反诈骗平台猎网平台的统计数字显示,因游戏帐号被盗而导致的用户损失人均为:2338元  
结论
|
一年估算:5000*2338=1169万元  
3 C&C
涉及到的部分域名和IP:
0710yx.aliapp.com
0710yx.asia
0710yx.xmwwy.com
0710yx.yksyx.org
07l0.gamr89.com
07l0yx.co
106.111.140.16
106.226.228.105
106.80.54.138
106.80.56.59
111.195.244.20
14.119.236.212
14.119.237.103
14.119.239.174
14.119.241.1
654004572.ys168.com
983830035.ys168.com
a594250576.ys168.com
a6601251.ys168.com
bobo.haoyue1688.com
ccl0579.com
cng.minsun.cc
dioeopp.org
ewq889966.ys168.com
t.qq.com/a_739377521
t.qq.com/a1005561469
t.qq.com/a1156573029
t.qq.com/a125245585
t.qq.com/a12d132
t.qq.com/a136410138  
---  
4 MD5值
部分恶意代码的MD5值:
5d8d0fd05af1264abb1d22cdb0406f83
f4f56532dea762d1be186bbe0f9e616e
12e71fc967f54fe989d500d38925eceb
4df813d38430d5ca988cb8d42cdf8e0b
7a005b7b22abc69b247e1c031688fe7e
f9ccb246b6b86c7f0d92c86c4560a17a
bfcc17fb2d5662b0b08727eb1ac243c0
1e657ebc26731ee8655eeeeed179bb62
efca9a583e86aa4ca2da424498799583
09b78b16f5c54093cc658c21fb028802
e30cd3b3d3bd4702d179858d0a0143fb
4991f063a1119a682ac82964303fd8cd
6132d5867eef96b69f67ee25a46b70da
8da89564a0259b29d7f9455443427e6f
8e21131ce2b38e1b000fc7ff980e40c2
17643d8a6e5982bce1e5647450f8365e
7ee1e4a7e61d5df97c52563d7a2838e7
ded24dc5158a3bd57546e02af0419317
70fa304c459d280d5b506d54362762a2
8c5d4c868b61d0e1d26fc5bc31369181
8e46b65ff218bc4e7d116c3bf5fddc61
3b3fd6e9ebd9e47bb221693f5aa3a770
557d573cccf1e71d43ce9f49b3bc116c
42cfc7c9bcb595e5eb3a857974605cd0
73be41e111bb5598ec14b13e6472099f
041536acfd00fe9f10b51c3fefdb9798
31e8889d79aad982323faef454e59f6e
71b7b652330c94cb7c9d42197b04a600
448e84bbdb9721d80b65c27a0278644c
353264b562660a940d5d761bfa2e1ced  
---