signiﬁcant rise for our victim. This indicates that the widely
used single-day detection methodology may not be able to
identify the attacks. In contrast, with long-term deviation
pattern embedded in behavioral matrices, the waveforms rise
after the attack day. Based on the above, we argue that long-
term signals and group correlations are very effective in
signaling abnormal users.
VII. DISCUSSION AND FUTURE WORK
A. Challenges with Filtering Benign Anomalies
One may be concerned about the importance of group
correlation by questioning “why can’t we just ﬁlter out
common benign anomalies during a speciﬁc period?” We
argue that it may not be easy. Indeed, sometimes a security
analyst is explicitly informed about certain common benign
anomalies (e.g., environmental changes), and thus ﬁltering is
sometimes feasible. However, such information is often not
readily available (as indicated by the security analysts of a
large enterprise that we interacted with). To manually ﬁlter
out FPs, we need to ﬁrst investigate what happened during a
speciﬁc period, and why/how the anomalies are benign. For
example, before concluding that the cause of an anomaly is
a new service, we need to ﬁrst deduce that (1) several users
accessed this service, and (2) this service did not appear
in the audit history. After having the cause, we need to
know what behaviors are affected (e.g., does it incur just
new HTTP sessions, or does it incur an executable?). Only
after then, we know what common behaviors can be safely
excluded without incurring FNs. This procedure may not be
timely affordable, and this is why we intend to leverage deep
learning techniques to efﬁciently bypass this procedure.
B. A More Flexible Detection Critic
The anomaly detection critic in ACOBE is simple.We do
not incorporate a fancy critic, as we only want to show-
case the fundamental idea: an autoencoder-based anomaly-
detection approach based on compound behaviors. Never-
theless, our future work includes an advanced detection
critic, which may be capable of robustly ﬁltering out some
benign anomalies. This future critic shall considers more
factors, including but not limited to the followings. First,
from Figure 5, we can see that the anomaly score raises
signiﬁcantly once abnormal activities has happened; hence,
we could examine “whether the anomaly score has a recent
spike”. Second, we could examine “whether the abnormal
raise demonstrate a particular waveform”, as different be-
havioral changes demonstrate different characteristics upon
the anomaly score. For example, a developer starting a
new project can incur a bursting raise with long-lasting but
smooth decrease, whereas a cyberattack may not show the
decrease but chaotic signals, as the malicious behaviors may
not be consistent over time. These additional factors could be
useful in anomaly detection judgement in our future work.
C. More Evaluations in the Future Work
While Yuan et. al [33] addressed that most recent deep
learning-based studies adopt the CERT dataset [15] to eval-
uate their proposed approaches, we are eager to know how
well ACOBE can work on different datasets. Moreover, we
would like to compare ACOBE with more related work (not
necessarily deep learning-based) in the literature, including
but not limited to, for example, Log2Vec [16]. However, we
could not do so by the time we wrote this paper because (1)
we do not have the essential prior knowledge about speciﬁc
target domains, and (2) we do not have detailed parameters
for re-implementation (if not open-sourced). We need time
to study different datasets and different approaches, hence
we leave more evaluations in our future work.
VIII. CONCLUSION
The fundamental limitation of the widely-used anomaly-
detection methodology is that it overlooks the importance of
long-term cyber threats and behavioral correlation within a
group. To this end, we propose a behavioral representation
which we refer to as a compound behavioral deviation
matrix. Having such matrices, we then propose ACOBE,
an autoencder-based anomaly detection for compromises.
Our evaluation and case studies show that, ACOBE not only
outperforms prior related work by a large margin in terms
of precision and recall, but also is applicable in practice for
discovery of realistic cyber threats.
Authorized licensed use limited to: Tsinghua University. Downloaded on October 11,2021 at 09:23:27 UTC from IEEE Xplore.  Restrictions apply. 
260
REFERENCES
[1] G. Belani, “5 cybersecurity threats to be aware of in 2020,”
https://www.computer.org/publications/tech-news/trends/5-
cybersecurity-threats-to-be-aware-of-in-2020.
[13] A. Sundararajan, T. Khan, A. Moghadasi, and A. I. Sarwat,
“Survey on synchrophasor data quality and cybersecurity
challenges, and evaluation of their interdependencies,” Jour-
nal of Modern Power Systems and Clean Energy, vol. 7, no. 3,
pp. 449–467, 2019.
[2] D. Rafter, “Cyberthreat
trends: 15 cybersecurity threats
for 2020,” https://us.norton.com/internetsecurity-emerging-
threats-cyberthreat-trends-cybersecurity-threat-review.html.
[14] J. Glasser and B. Lindauer, “Bridging the gap: A pragmatic
approach to generating insider threat data,” in 2013 IEEE
Security and Privacy Workshops, 2013, pp. 98–104.
[3] T. Kenaza, K. Bennaceur,
and A.
“An
efﬁcient hybrid svdd/clustering approach for anomaly-
based intrusion detection,” in Proceedings of
the 33rd
ser.
Annual ACM Symposium on Applied Computing,
SAC 18.
New York, NY, USA: Association
for
Computing Machinery, 2018, p. 435443. [Online]. Available:
https://doi.org/10.1145/3167132.3167180
Labed,
[4] Z. Liu, T. Qin, X. Guan, H. Jiang, and C. Wang, “An
integrated method for anomaly detection from massive system
logs,” IEEE Access, vol. 6, pp. 30 602–30 611, 2018.
[5] Y. Mirsky, T. Doitshman, Y. Elovici, and A. Shabtai, “Kitsune:
An ensemble of autoencoders for online network intrusion
detection,” 2018.
[6] L. Liu, O. De Vel, C. Chen, J. Zhang, and Y. Xiang,
“Anomaly-based insider threat detection using deep autoen-
coders,” in 2018 IEEE International Conference on Data
Mining Workshops (ICDMW), Nov 2018, pp. 39–48.
[7] L. Liu, C. Chen, J. Zhang, O. De Vel, and Y. Xiang, “Un-
supervised insider detection through neural feature learning
and model optimisation,” in Network and System Security,
J. K. Liu and X. Huang, Eds. Cham: Springer International
Publishing, 2019, pp. 18–36.
[8] Q. Hu, B. Tang, and D. Lin, “Anomalous user activity
detection in enterprise multi-source logs,” in 2017 IEEE Inter-
national Conference on Data Mining Workshops (ICDMW),
Nov 2017, pp. 797–803.
[9] M. A. Maloof and G. D. Stephens, “Elicit: A system for
detecting insiders who violate need-to-know,” in Proceedings
of the 10th International Conference on Recent Advances
in Intrusion Detection, ser. RAID07.
Berlin, Heidelberg:
Springer-Verlag, 2007, p. 146166.
[10] A. Aldweesh, A. Derhab, and A. Z. Emam, “Deep learning
approaches for anomaly-based intrusion detection systems:
A survey,
taxonomy, and open issues,” Knowledge-Based
Systems, vol. 189, p. 105124, 2020.
[11] R. Chalapathy and S. Chawla, “Deep learning for anomaly
detection: A survey,” CoRR, 2019.
[12] F. Falc˜ao, T. Zoppi, C. B. V. Silva, A. Santos,
B. Fonseca, A. Ceccarelli, and A. Bondavalli, “Quantitative
comparison of unsupervised anomaly detection algorithms
for
the 34th
ser.
ACM/SIGAPP Symposium on Applied Computing,
SAC 19.
New York, NY, USA: Association
for
Computing Machinery, 2019, p. 318327. [Online]. Available:
https://doi.org/10.1145/3297280.3297314
intrusion detection,”
in Proceedings of
[15] “Insider
test
https://resources.sei.cmu.edu/library/asset-
view.cfm?assetid=508099.
threat
dataset,”
[16] F. Liu, Y. Wen, D. Zhang, X. Jiang, X. Xing, and D. Meng,
“Log2vec: A heterogeneous graph embedding based approach
for detecting cyber threats within enterprise,” in Proceedings
of the 2019 ACM SIGSAC Conference on Computer and Com-
munications Security, ser. CCS 19. New York, NY, USA:
Association for Computing Machinery, 2019, p. 17771794.
[17] A. Oprea, Z. Li, T. Yen, S. H. Chin, and S. Alrwais,
“Detection of early-stage enterprise infection by mining large-
scale log data,” in 2015 45th Annual IEEE/IFIP International
Conference on Dependable Systems and Networks, June 2015,
pp. 45–56.
anomaly
detection
[18] M. Du, Z. Chen, C. Liu, R. Oak,
through
and D. Song,
unlearning,”
in
“Lifelong
the 2019 ACM SIGSAC Conference
Proceedings of
on Computer and Communications Security,
ser. CCS
19. New York, NY, USA: Association for Computing
Machinery,
[Online]. Available:
https://doi.org/10.1145/3319535.3363226
12831297.
2019,
p.
[19] B. Zong, Q. Song, M. R. Min, W. Cheng, C. Lumezanu,
D. Cho, and H. Chen, “Deep autoencoding gaussian mixture
model for unsupervised anomaly detection,” in International
Conference on Learning Representations, 2018. [Online].
Available: https://openreview.net/forum?id=BJJLHbb0-
[20] Z. Chiba, N. Abghour, K. Moussaid, A. E. Omri, and M. Rida,
“A novel architecture combined with optimal parameters for
back propagation neural networks applied to anomaly network
intrusion detection,” Computers & Security, vol. 75, pp. 36 –
58, 2018.
[21] M. Sakurada and T. Yairi, “Anomaly detection using
autoencoders with nonlinear dimensionality reduction,”
in Proceedings of
the MLSDA 2014 2nd Workshop
on Machine Learning for Sensory Data Analysis, ser.
MLSDA14.
New York, NY, USA: Association for
Computing Machinery, 2014, p. 411. [Online]. Available:
https://doi.org/10.1145/2689746.2689747
[22] X. Lu, W. Zhang, and J. Huang, “Exploiting embedding
manifold of autoencoders for hyperspectral anomaly detec-
tion,” IEEE Transactions on Geoscience and Remote Sensing,
vol. 58, no. 3, pp. 1527–1537, March 2020.
[23] Q. P. Nguyen, K. W. Lim, D. M. Divakaran, K. H. Low, and
M. C. Chan, “Gee: A gradient-based explainable variational
autoencoder for network anomaly detection,” in 2019 IEEE
Conference on Communications and Network Security (CNS),
June 2019, pp. 91–99.
Authorized licensed use limited to: Tsinghua University. Downloaded on October 11,2021 at 09:23:27 UTC from IEEE Xplore.  Restrictions apply. 
261
[37] J. Bacher, “Domain generation algorithms,”
https://github.com/baderj/domain generation
algorithms.
[38] “Zeus,” https://github.com/Visgean/Zeus.
[39] “thezoo aka malware db - a live malwarerepository,”
https://thezoo.morirt.com/.
[40] M. Du, F. Li, G. Zheng, and V. Srikumar, “Deeplog: Anomaly
detection and diagnosis from system logs through deep learn-
ing,” in Proceedings of the 2017 ACM SIGSAC Conference
on Computer and Communications Security, ser. CCS ’17.
New York, NY, USA: ACM, 2017, pp. 1285–1298.
[41] H. Siadati and N. Memon, “Detecting structurally anomalous
logins within enterprise networks,” in Proceedings of
the 2017 ACM SIGSAC Conference on Computer and
Communications Security, ser. CCS ’17. New York, NY,
USA: ACM, 2017, pp. 1273–1284.
[Online]. Available:
http://doi.acm.org/10.1145/3133956.3134003
[24] X. Wang, Y. Du, S. Lin, P. Cui, Y. Shen, and Y. Yang, “ad-
vae: A self-adversarial variational autoencoder with gaussian
anomaly prior knowledge for anomaly detection,” Knowledge-
Based Systems, vol. 190, p. 105187, 2020.
[25] M. Alam, J. Gottschlich, N. Tatbul, J. Turek, T. Mattson,
and A. Muzahid, “A zero-positive learning approach for
diagnosing software performance regressions,” 2017.
[26] R. Chalapathy, A. K. Menon, and S. Chawla, “Robust, deep
and inductive anomaly detection,” in Machine Learning and
Knowledge Discovery in Databases, M. Ceci, J. Hollm´en,
L. Todorovski, C. Vens, and S. Dˇzeroski, Eds.
Cham:
Springer International Publishing, 2017, pp. 36–51.
[27] C. Zhou and R. C. Paffenroth, “Anomaly detection with
robust deep autoencoders,” in Proceedings of the 23rd ACM
SIGKDD International Conference on Knowledge Discovery
and Data Mining, ser. KDD 17. New York, NY, USA:
Association for Computing Machinery, 2017, p. 665674.
[Online]. Available: https://doi.org/10.1145/3097983.3098052
[28] V. Chandola, A. Banerjee, and V. Kumar, “Anomaly detection
for discrete sequences: A survey,” IEEE Transactions on
Knowledge and Data Engineering, vol. 24, no. 5, pp. 823–
839, May 2012.
[29] A. L. Buczak and E. Guven, “A survey of data mining
and machine learning methods for cyber security intrusion
detection,” IEEE Communications Surveys Tutorials, vol. 18,
no. 2, pp. 1153–1176, Secondquarter 2016.
in
systems
detection
J.-G. Lou, Y. Wang, and J. Li, “Execution
[30] Q. Fu,
anomaly
through
unstructured log analysis,” in International conference
IEEE, December
on Data Mining
2009.
[Online]. Available: https://www.microsoft.com/en-
us/research/publication/execution-anomaly-detection-in-
distributed-systems-through-unstructured-log-analysis/
distributed
(full
paper).
[31] S. He, J. Zhu, P. He, and M. R. Lyu, “Experience report: Sys-
tem log analysis for anomaly detection,” in 2016 IEEE 27th
International Symposium on Software Reliability Engineering
(ISSRE), Oct 2016, pp. 207–218.
[32] A. Oprea, Z. Li, R. Norris, and K. Bowers, “Made: Security
analytics for enterprise threat detection,” in Proceedings of
the 34th Annual Computer Security Applications Conference,
2018, pp. 124–136.
[33] S. Yuan and X. Wu, “Deep learning for insider threat de-
tection: Review, challenges and opportunities,” Computers &
Security, p. 102221, 2021.
[34] S. Ioffe and C. Szegedy, “Batch normalization: Accelerating
deep network training by reducing internal covariate shift,”
2015.
[35] T. Saito and M. Rehmsmeier, “The precision-recall plot
is more informative than the roc plot when evaluating
binary classiﬁers on imbalanced datasets,” PLOS ONE,
vol. 10, no. 3, pp. 1–21, 03 2015. [Online]. Available:
https://doi.org/10.1371/journal.pone.0118432
[36] “Elasticsearch: Restful, distributed search and analytics,”
https://www.elastic.co/.
Authorized licensed use limited to: Tsinghua University. Downloaded on October 11,2021 at 09:23:27 UTC from IEEE Xplore.  Restrictions apply. 
262