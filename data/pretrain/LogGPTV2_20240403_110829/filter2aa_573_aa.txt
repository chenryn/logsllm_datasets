Kim Jong
Kim Jong--il and me:
il and me: 
How to build a cyber army to attack the 
How to build a cyber army to attack the 
U.S.
U.S.
Charlie Miller
Charlie Miller
Independent Security Evaluators
Independent Security Evaluators
PI:EMAIL
PI:EMAIL
Overview
Overview
About me
About me
Some background material
Some background material
Key strategies
Key strategies
Cyberwar potential attacks
Cyberwar potential attacks
Cyberarmy tasks
Cyberarmy tasks
Possible defenses
Possible defenses
Layout of army
Layout of army
Timeline of preparation and attack
Timeline of preparation and attack
Conclusions and lessons learned
Conclusions and lessons learned
About this talk
About this talk
Originally given at Conference for Cyber Conflict, at 
Originally given at Conference for Cyber Conflict, at 
the NATO Cooperative Cyber Defense Centre of 
the NATO Cooperative Cyber Defense Centre of 
Excellence
Excellence
The audience was some technical, some policy types
The audience was some technical, some policy types
This version is a little more technical (and hopefully 
This version is a little more technical (and hopefully 
funny)
funny)
Who I am
Who I am
PhD in Mathematics, University of Notre Dame
PhD in Mathematics, University of Notre Dame
1 year, Security Architect, a Financial Services firm
1 year, Security Architect, a Financial Services firm
5 years, NSA Global Network Exploitation Analyst
5 years, NSA Global Network Exploitation Analyst
4 years, consultant for Independent Security Evaluators
4 years, consultant for Independent Security Evaluators
Application and network penetration testing
Application and network penetration testing
Project planning and scoping
Project planning and scoping
First remote exploits against iPhone, G1 Android phone
First remote exploits against iPhone, G1 Android phone
3 time winner Pwn2Own competition
3 time winner Pwn2Own competition
My career as a govie
My career as a govie
Bullets from my NSA approved resume
Bullets from my NSA approved resume
Computer Network Exploitation
Computer Network Exploitation
Performed computer network scanning and 
Performed computer network scanning and 
reconnaissance
reconnaissance
Executed numerous computer network exploitations 
Executed numerous computer network exploitations 
against foreign targets
against foreign targets
Network Intrusion Analysis
Network Intrusion Analysis
Designed and developed network intrusion detection tools 
Designed and developed network intrusion detection tools 
to find and stop exploitation of NIPRNET hosts, as well as 
to find and stop exploitation of NIPRNET hosts, as well as 
locate already compromised hosts
locate already compromised hosts
Why I gave this talk
Why I gave this talk
Those in charge of 
Those in charge of ““cyber
cyber”” policy don
policy don’’t understand 
t understand 
technical details
technical details
Sometimes the details matter
Sometimes the details matter
Clarke
Clarke’’s 
s ““Cyberwar
Cyberwar”” was clearly written by 
was clearly written by 
someone who knows nothing about the 
someone who knows nothing about the 
technological details
technological details
To help those capable of making decisions 
To help those capable of making decisions 
concerning cyberwar to discern fact from fiction
concerning cyberwar to discern fact from fiction
Basics
Basics
For comparison
For comparison
US Annual military spending: $708 Billion
US Annual military spending: $708 Billion
US Cyber Command: $105 Million
US Cyber Command: $105 Million
North Korea military spending: $5 Billion
North Korea military spending: $5 Billion
North Korean cyber warfare spending: $56 Million
North Korean cyber warfare spending: $56 Million
Iran cyber warfare spending: $76 Million
Iran cyber warfare spending: $76 Million
My hypothetical cyber army is a bargain at $49 
My hypothetical cyber army is a bargain at $49 
Million!
Million!
Aspects of Cyberwarfare
Aspects of Cyberwarfare
Collect intelligence
Collect intelligence
Control systems
Control systems
Deny or disable systems
Deny or disable systems
Cause harm on the level of 
Cause harm on the level of ““kinetic
kinetic”” attacks
attacks
Some statistics
Some statistics
# IP addresses: ~3.7 bil
# IP addresses: ~3.7 bil
# personal computers: ~2 bil
# personal computers: ~2 bil
# iphones worldwide: ~41 mil
# iphones worldwide: ~41 mil
Botnets size:
Botnets size:
Zeus: 3.6 mil (.1% of personal computers)
Zeus: 3.6 mil (.1% of personal computers)
Koobface: 2.9 mil
Koobface: 2.9 mil
TidServ: 1.5 mil
TidServ: 1.5 mil
Conficker: 10 mil+
Conficker: 10 mil+
Botnet
Botnet
A distributed set of software programs which run 
A distributed set of software programs which run 
autonomously and automatically
autonomously and automatically
Group can be controlled to perform tasks
Group can be controlled to perform tasks
Individual software running on each system is called a 
Individual software running on each system is called a 
bot
bot
Remote access tool
Remote access tool
Abbreviated RAT
Abbreviated RAT
Program which allows remote control of a 
Program which allows remote control of a 
device/computer
device/computer
Allows attacker to search/monitor host, 
Allows attacker to search/monitor host, 
search/monitor local network, attack other hosts, etc
search/monitor local network, attack other hosts, etc
Should be hard to detect
Should be hard to detect
00--day, the known unknowns
day, the known unknowns
A vulnerability or exploit that exists in software for 
A vulnerability or exploit that exists in software for 
which there is no available patch or fix
which there is no available patch or fix
Oftentimes, the existence of this exploit is unknown 
Oftentimes, the existence of this exploit is unknown 
by the community at large, even the vendor
by the community at large, even the vendor
Difficult to defend against the attack you don
Difficult to defend against the attack you don’’t know 
t know 
about
about
00--days exist
days exist
I found a bug in Samba in Aug 2005.  Sold in Aug 
I found a bug in Samba in Aug 2005.  Sold in Aug 
2006, Fixed in May 2007
2006, Fixed in May 2007
Adobe JBIG2 vulnerability.  Discovered in 2008, Sold 
Adobe JBIG2 vulnerability.  Discovered in 2008, Sold 
in Jan 2009, Discussed in Feb 2009, Patch March 
in Jan 2009, Discussed in Feb 2009, Patch March 
2009
2009
Found a bug preparing for Pwn2Own 2008.  Used it in 
Found a bug preparing for Pwn2Own 2008.  Used it in 
Pwn2Own 2009.  Fixed 2 months later
Pwn2Own 2009.  Fixed 2 months later
00--day lifespan
day lifespan
Average lifespan of zero
Average lifespan of zero--day bugs is 348 days
day bugs is 348 days
The shortest
The shortest--lived bugs have been made public within 
lived bugs have been made public within 
99 days
99 days
The longest lifespan was 1080 days
The longest lifespan was 1080 days
nearly three years.
nearly three years.
From: Justine Aitel, CEO Immunity (from 2007)
From: Justine Aitel, CEO Immunity (from 2007)
00--day detection
day detection
Possible but extremely difficult
Possible but extremely difficult
Tend to lead to false positives
Tend to lead to false positives
Can be circumvented if defenses are known
Can be circumvented if defenses are known
Overall Strategies
Overall Strategies
Dominate cyberspace
Dominate cyberspace
Infiltrate key systems in advance
Infiltrate key systems in advance
Rely on research and intelligence 
Rely on research and intelligence 
gathering
gathering
Use known exploits when possible, 
Use known exploits when possible, 
00--days when necessary
days when necessary
Hack the Planet
Hack the Planet
““Dominate cyberspace
Dominate cyberspace””, i.e. control as many devices 
, i.e. control as many devices 
around the world as possible
around the world as possible
In a cyberwar, portions of the Internet will be degraded.  
In a cyberwar, portions of the Internet will be degraded.  
Controlling lots of devices increases ability to still act
Controlling lots of devices increases ability to still act
Makes attribution easier for your side, harder for 
Makes attribution easier for your side, harder for 
opponent
opponent
Sometimes you find yourself inside hard targets by luck
Sometimes you find yourself inside hard targets by luck
Many basic attacks work by using many hosts and are 
Many basic attacks work by using many hosts and are 
more effective with more hosts
more effective with more hosts
Advance Planning
Advance Planning
Attacking well secured networks requires research 
Attacking well secured networks requires research 
and planning, it cannot be done overnight
and planning, it cannot be done overnight
Many offensive capabilities (communication, 
Many offensive capabilities (communication, 
scanning, etc) are easily detected if performed 
scanning, etc) are easily detected if performed 
quickly, not if performed slowly
quickly, not if performed slowly
Can be prepared to disable/destroy key systems 
Can be prepared to disable/destroy key systems 
when needed
when needed
Research and Intelligence
Research and Intelligence
How are key financial and SCADA systems and 
How are key financial and SCADA systems and 
networks constructed?
networks constructed?
What hardware/software do core Internet routers, 
What hardware/software do core Internet routers, 
DNS servers utilize?
DNS servers utilize?
What defenses and monitoring systems are in place?
What defenses and monitoring systems are in place?
To 0
To 0--day or not
day or not
Sometimes, especially during early stages, it makes 
Sometimes, especially during early stages, it makes 
sense to look like an average attacker
sense to look like an average attacker
Use known vulnerabilities, known tools
Use known vulnerabilities, known tools
Harder to attribute to military
Harder to attribute to military
inexpensive if caught
inexpensive if caught
00--day exploits and custom tools are harder to detect, 
day exploits and custom tools are harder to detect, 
but if found, are expensive and time consuming to 
but if found, are expensive and time consuming to 
replace
replace
Other strategies to consider
Other strategies to consider
Clarke
Clarke’’s logic bombs
s logic bombs
Stealing from/paying cyber criminals for access
Stealing from/paying cyber criminals for access
Insider backdoors, i.e. employees at MS, Cisco, etc
Insider backdoors, i.e. employees at MS, Cisco, etc
Potential Cyberwar Attacks
Potential Cyberwar Attacks
Potential Cyberwar Attacks
Potential Cyberwar Attacks
Shut down the Internet
Shut down the Internet
Take financial markets offline, corrupt or destroy 
Take financial markets offline, corrupt or destroy 
financial data
financial data
Disrupt shipping, air transportation
Disrupt shipping, air transportation
Blackouts
Blackouts
Disable communication within military
Disable communication within military
Disable cell phone networks
Disable cell phone networks
Cyberarmy tasks
Cyberarmy tasks
Cyberarmy tasks
Cyberarmy tasks
Communication redundancy
Communication redundancy
Distributed Denial of Service
Distributed Denial of Service
Hard targets
Hard targets
Core infrastructure
Core infrastructure
Attacking air gapped networks
Attacking air gapped networks
Communication 
Communication 
redundancy
redundancy
Operators will be geographically distributed
Operators will be geographically distributed
Offices throughout the world
Offices throughout the world
Multiple offices in target country
Multiple offices in target country
Direct, redundant communication possible to command
Direct, redundant communication possible to command
Modems over phone lines, satellite phones
Modems over phone lines, satellite phones
Even without the Internet, attacks against the 
Even without the Internet, attacks against the 
Internet can be commanded and controlled
Internet can be commanded and controlled
DDOS
DDOS
Flood target with too much traffic
Flood target with too much traffic
Deny DNS, bandwidth to server, server(s) themselves
Deny DNS, bandwidth to server, server(s) themselves
Need to control (and coordinate) a large number of 
Need to control (and coordinate) a large number of 
hosts to perform this attack
hosts to perform this attack
BTW, North Korea functions just fine if the Internet 
BTW, North Korea functions just fine if the Internet 
goes away
goes away
Collecting hosts
Collecting hosts
Assume ownership of existing botnets
Assume ownership of existing botnets
Use client side vulnerabilities
Use client side vulnerabilities
Browsers, Flash, Reader, Java, etc
Browsers, Flash, Reader, Java, etc
Make some effort to clean up existing malware, patch 
Make some effort to clean up existing malware, patch 
systems
systems
Other botnet masters may try to take your bots
Other botnet masters may try to take your bots
Use only known vulnerabilities
Use only known vulnerabilities
Don
Don’’t waste the 0
t waste the 0--days, unless you have extras
days, unless you have extras
The N. Korean Botnets
The N. Korean Botnets
Want to avoid 
Want to avoid ““string which unravels all
string which unravels all””
Develop a large number of different varieties of bot 
Develop a large number of different varieties of bot 
software
software
Avoid central control
Avoid central control
Bots should be geographically diverse
Bots should be geographically diverse
Saturated in target country
Saturated in target country
Regionally diverse in target country
Regionally diverse in target country
at least 100x bigger than largest botnet seen
at least 100x bigger than largest botnet seen
Multiple botnets with 
Multiple botnets with 