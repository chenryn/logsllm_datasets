可以找到全局高潮、低谷  
可以找到平滑变化的拐点(设置10，或者更大，越大，越能找出平滑变化的拐点)  
缺陷  
无法找到平滑变化后正式进入平滑高潮或低谷期(>10)的点。  
无法找到在平滑高潮或低谷期中的小波峰和波谷(即局部高潮或低谷)。  
#### query 2  
```
select * from 
(
  select id, 
    val, 
    min(val) over(order by id rows between 10 preceding and current row) as left_min,  -- 左边相邻10个点的最小值（包括当前点）, 辐射半径的左边 
    max(val) over(order by id rows between 10 preceding and current row) as left_max,  -- 左边相邻10个点的最大值（包括当前点）, 辐射半径的左边 
    min(val) over(order by id rows between current row and 10 following) as right_min,  -- 右边相邻10个点的最小值（包括当前点）, 辐射半径的右边 
    max(val) over(order by id rows between current row and 10 following) as right_max,  -- 右边相邻10个点的最大值（包括当前点）, 辐射半径的右边 
    min(val) over(order by id rows between 10 preceding and 10 following) as range_min,  -- 左边相邻10个点的最小值（包括当前点）, 辐射半径两边全部 
    max(val) over(order by id rows between 10 preceding and 10 following) as range_max,  -- 右边相邻10个点的最大值（包括当前点）, 辐射半径两边全部 
    min(val) over() as global_min, -- 全局的最小值（包括当前点） 
    max(val) over() as global_max  -- 全局的最大值（包括当前点） 
  from wind
) t
where 
(  -- 找越过低水位后的局部低谷开始
 (
 left_max - val > ((range_max-range_min)*0.5)   -- 左边相邻10个点的最大值 - 当前值 > 局部落差的50%
 and 
 val = left_min  -- 拐点 
 )
 and
 (
 right_max - val > ((range_max-range_min)*0.5)   -- 右边相邻10个点的最大值 - 当前值 > 局部落差的50%
 and 
 val = right_min  -- 拐点
 )
 and 
 (val - global_min)::numeric/(global_max-global_min+0.0000001)  ((range_max-range_min)*0.5)   -- 当前值 - 左边相邻10个点的最小值 > 局部落差的50%
 and 
 val = left_max  -- 拐点
 )
 and
 (
 val - right_min > ((range_max-range_min)*0.5)   -- 当前值 - 右边相邻10个点的最小值 > 局部落差的50%
 and 
 val = right_max  -- 拐点
 )
 and 
 (global_max - val)::numeric/(global_max-global_min+0.0000001)  ((global_max-global_min)*0.5)  -- 左边相邻10个点的最大值 - 当前值 > 全局落差的50% 
and 
val = left_min  -- 拐点
)
and
(
(right_max-right_min)/(range_max-range_min+0.00000001)  ((global_max-global_min)*0.5)  -- 右边相邻10个点的最大值 - 当前值 > 全局落差的50% 
and 
val = right_min  -- 拐点
)
and
(
(left_max-left_min)/(range_max-range_min+0.00000001)  ((global_max-global_min)*0.5)  -- 当前值 - 左边相邻10个点的最小值 > 全局落差的50% 
and 
val = left_max  -- 拐点
)
and
(
(right_max-right_min)/(range_max-range_min+0.00000001)  ((global_max-global_min)*0.5)  -- 左边相邻10个点的最大值 - 当前值 > 全局落差的50% 
and 
val = right_max  -- 拐点
)
and
(
(left_max-left_min)/(range_max-range_min+0.00000001) < 0.05  -- 要求越平缓，设置0.05的值越低。
)
)  -- 结束 找出单边，右陡左平缓，高潮
;
  id   | val | left_min | left_max | right_min | right_max | range_min | range_max | global_min | global_max 
-------+-----+----------+----------+-----------+-----------+-----------+-----------+------------+------------
 10001 |   1 |        1 |   726.31 |         1 |         8 |         1 |    726.31 |          1 |     996.57
(1 row)
```
功能  
可以找到单边骤变的点。    
缺陷  