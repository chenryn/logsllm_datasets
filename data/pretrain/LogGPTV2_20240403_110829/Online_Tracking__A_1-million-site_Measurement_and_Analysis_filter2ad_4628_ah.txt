Harry  Kalodner,  and  Matthew  Salganik  at  Princeton,  Fer­
nando Diaz and many others at Microsoft Research, Franziska 
Roesner at UW, Marc Juarez at KU Leuven, Nikolaos Laoutaris 
at  Telefonia  Research,  Vincent  Toubiana  at  CNIL,  France, 
Lukasz Olejnik at INRIA, France, Nick Nikiforakis at Stony 
Brook, Tanvi Vyas at Mozilla, Chameleon developer Alexei 
Miagkov, Joel Reidenberg at Fordham, Andrea Matwyshyn 
at Northeastern, and the participants of the Princeton Web 
Privacy  and  Transparency  workshop.  Finally,  we’d  like  to 
thank the anonymous reviewers of this paper. 
This  work  was  supported  by  NSF  Grant  CNS  1526353, 
a  grant  from  the  Data  Transparency  Lab,  and  by  Amazon 
AWS Cloud Credits for Research. 
9.  REFERENCES 
[1]  G.  Acar, 
C.  Eubank,  S.  Englehardt,  M.  Juarez,  A.  Narayanan, 
and  C.  Diaz.  The  web  never  forgets:  Persistent  tracking 
mechanisms  in  the  wild.  In  Proceedings  of  CCS,  2014. 
10−610−510−410−310−2ProminenceofScript(log)0.00.20.40.60.81.0FractionofScriptsBlocked[2]  G.  Acar,  M.  Juarez,  N.  Nikiforakis,  C.  Diaz,  S.  G¨urses, 
F.  Piessens,  and  B.  Preneel.  FPDetective:  dusting  the 
web  for  ﬁngerprinters.  In  Proceedings  of  CCS.  ACM,  2013. 
[3]	  L.  A.  Adamic  and  B.  A.  Huberman.  Zipf’s
law  and  the  internet.  Glottometrics,  3(1):143–150,  2002.
[4]	  H.  C.  Altaweel  I,
Good  N. Web  privacy  census.  Technology  Science,  2015.
[5]	  J.  Angwin. What  they
know.  The Wall  Street  Journal.  http://online.wsj.com/
public/page/what-they-know-digital-privacy.html,  2012.
[6]  M.  Ayenson,  D.  J. Wambach,  A.  Soltani, 
N.  Good,  and  C.  J.  Hoofnagle.  Flash  cookies  and 
privacy  II:  Now  with  HTML5  and  ETag  respawning. World 
Wide  Web  Internet  And  Web  Information  Systems,  2011. 
[7]	  P.  E.  Black.  Ratcliﬀ/Obershelp  pattern  recognition. 
http://xlinux.nist.gov/dads/HTML/ratcliﬀObershelp.html, 
Dec.  2004. 
[8]  Bugzilla. WebRTC  Internal  IP  Address  Leakage.
https://bugzilla.mozilla.org/show  bug.cgi?id=959893.
[9]  A.  Datta, 
M.  C.  Tschantz,  and  A.  Datta.  Automated  experiments  on 
ad  privacy  settings.  Privacy  Enhancing  Technologies,  2015. 
[10]	  W.  Davis.  KISSmetrics  Finalizes  Supercookies  Settlement. 
http://www.mediapost.com/publications/article/ 
191409/kissmetrics-ﬁnalizes-supercookies-settlement.html, 
2013.  [Online;  accessed  12-May-2014]. 
[11]	  Disconnect.  Tracking 
Protection  Lists.  https://disconnect.me/trackerprotection. 
[12]	  P.  Eckersley.  How  unique  is  your  web  browser? 
In  Privacy  Enhancing  Technologies.  Springer,  2010. 
[13]	  Electronic  Frontier  Foundation. 
Encrypting the Web. https://www.eﬀ.org/encrypt-the-web. 
[14]  S.  Englehardt,  D.  Reisman,  C.  Eubank, 
P.  Zimmerman,  J.  Mayer,  A.  Narayanan,  and  E. W.  Felten. 
Cookies  that  give  you  away:  The  surveillance  implications 
of  web  tracking.  In  24th  International  Conference 
on  World  Wide  Web,  pages  289–299.  International 
World Wide Web  Conferences  Steering  Committee,  2015. 
[15]	  Federal  Trade  Commission.  Google  will  pay  $22.5  million 
to  settle  FTC  charges  it  misrepresented  privacy  assurances 
to  users  of  Apple’s  Safari  internet  browser.  https://www. 
ftc.gov/news-events/press-releases/2012/08/google-will­
pay-225-million-settle-ftc-charges-it-misrepresented,  2012. 
[16]	  D.  Fiﬁeld  and  S.  Egelman.  Fingerprinting 
web  users  through  font  metrics.  In  Financial  Cryptography 
and  Data  Security,  pages  107–124.  Springer,  2015. 
[17]	  N.  Fruchter,  H.  Miao,  S.  Stevenson, 
and  R.  Balebako.  Variations  in  tracking  in  relation 
to  geographic  location.  In  Proceedings  of  W2SP,  2015. 
[18]	  S.  Gorman 
and  J.  Valentino-Devries.  New  Details  Show  Broader 
NSA Surveillance Reach. http://on.wsj.com/1zcVv78, 2013. 
[19]	  A. Hannak, G. Soeller, D. Lazer, A. Mislove, and C. Wilson. 
Measuring  price  discrimination  and  steering  on  e-commerce 
web  sites.  In  14th  Internet  Measurement  Conference,  2014. 
[20]	  C.  J.  Hoofnagle  and  N.  Good. 
Web  privacy  census.  Available  at  SSRN  2460547,  2012. 
[21]  M.  Kranch  and 
J.  Bonneau.  Upgrading  HTTPS  in  midair:  HSTS  and  key 
pinning  in  practice.  In  NDSS  ’15:  The  2015  Network  and 
Distributed  System  Security  Symposium,  February  2015. 
[22]	  S.  A.  Krashakov,  A.  B.  Teslyuk,  and  L.  N. 
Shchur.  On  the  universality  of  rank  distributions  of  website 
popularity.  Computer  Networks,  50(11):1769–1780,  2006. 
[23]	  B.  Krishnamurthy,  K.  Naryshkin,  and  C. Wills. 
Privacy  leakage  vs.  protection  measures:  the  growing 
disconnect.  In  Proceedings  of  W2SP,  volume  2,  2011. 
[24]	  B.  Krishnamurthy  and  C. Wills. 
Privacy  diﬀusion  on  the  web:  a  longitudinal  perspective. 
In  Conference  on  World  Wide  Web.  ACM,  2009. 
[25]  B.  Krishnamurthy  and  C.  E. Wills.  On  the  leakage  of  per­
sonally identiﬁable information via online social networks. In 
2nd  ACM  workshop  on  Online  social  networks. ACM, 2009. 
[26]	  P.  Laperdrix, W.  Rudametkin,  and  B.  Baudry. 
Beauty  and  the  beast:  Diverting  modern  web  browsers 
to  build  unique  browser  ﬁngerprints.  In  37th  IEEE 
Symposium  on  Security  and  Privacy  (S&P  2016),  2016. 
[27]  M.  L´ecuyer,  G.  Ducoﬀe,  F.  Lan,  A.  Papancea, 
T.  Petsios,  R.  Spahn,  A.  Chaintreau,  and  R.  Geambasu. 
Xray:  Enhancing  the  web’s  transparency  with  diﬀerential 
correlation.  In  USENIX  Security  Symposium,  2014. 
[28]  M.  Lecuyer,  R.  Spahn, 
Y.  Spiliopolous,  A.  Chaintreau,  R.  Geambasu,  and  D.  Hsu. 
Sunlight:  Fine-grained  targeting  detection  at  scale  with 
statistical  conﬁdence.  In  Proceedings  of  CCS.  ACM,  2015. 
[29]	  A.  Lerner,  A.  K.  Simpson,  T.  Kohno, 
and  F.  Roesner.  Internet  jones  and  the  raiders  of  the 
lost  trackers:  An  archaeological  study  of  web  tracking  from 
1996  to  2016.  In  Proceedings  of  USENIX  Security),  2016. 
[30]	  J.  Leyden.  Sites  pulling  sneaky  ﬂash  cookie-snoop.  http: 
//www.theregister.co.uk/2009/08/19/ﬂash  cookies/,  2009. 
[31]	  T.  Libert.  Exposing  the  invisible  web:  An 
analysis  of  third-party  http  requests  on  1  million  websites. 
International  Journal  of  Communication,  9(0),  2015. 
[32]	  D.  Mattioli.  On  Orbitz,  Mac  users  steered 
to  pricier  hotels.  http://online.wsj.com/news/articles/ 
SB10001424052702304458604577488822667325882,  2012. 
[33]	  J.  R.  Mayer 
and  J.  C.  Mitchell.  Third-party  web  tracking:  Policy  and 
technology.  In  Security  and  Privacy  (S&P).  IEEE,  2012. 
[34]	  A.  M.  McDonald  and  L.  F. 
Cranor.  Survey  of  the  use  of  Adobe  Flash  Local  Shared 
Objects  to  respawn  HTTP  cookies,  a.  ISJLP,  7,  2011. 
[35]	  J.  Mikians,  L.  Gyarmati,  V.  Erramilli,  and  N.  Laoutaris. 
Detecting  price  and  search  discrimination  on  the  internet. 
In Workshop  on  Hot  Topics  in  Networks.  ACM,  2012. 
[36]	  N.  Mohamed. 
You  deleted  your  cookies?  think  again.  http://www.wired. 
com/2009/08/you-deleted-your-cookies-think-again/,  2009. 
[37]	  K.  Mowery  and  H.  Shacham.  Pixel  perfect:  Fingerprinting 
canvas  in  html5.  Proceedings  of  W2SP,  2012. 
[38]	  Mozilla 
Developer  Network.  Mixed  content  - Security.  https:// 
developer.mozilla.org/en-US/docs/Security/Mixed  content. 
[39]  C.  Neasbitt,  B.  Li,  R.  Perdisci,  L.  Lu,  K.  Singh,  and 
K.  Li. Webcapsule:  Towards  a  lightweight  forensic  engine 
for  web  browsers.  In  Proceedings  of  CCS.  ACM,  2015. 
[40]  N.  Nikiforakis,  L.  Invernizzi,  A.  Kapravelos,  S.  Van  Acker, 
W.  Joosen,  C.  Kruegel,  F.  Piessens,  and  G.  Vigna.
You  are  what  you  include:  Large-scale  evaluation  of  remote
javascript  inclusions.  In  Proceedings  of  CCS.  ACM,  2012.
[41]  N.  Nikiforakis,  A.  Kapravelos, W.  Joosen, 
C.  Kruegel,  F.  Piessens,  and  G.  Vigna.  Cookieless 
monster:  Exploring  the  ecosystem  of  web-based  device 
ﬁngerprinting.  In  Security  and  Privacy  (S&P).  IEEE,  2013. 
[42]  F.  Ocariza,  K.  Pattabiraman,  and 
B.  Zorn.  Javascript  errors  in  the  wild:  An  empirical  study.
In  Software  Reliability  Engineering  (ISSRE).  IEEE,  2011.
[43]  L.  Olejnik, 
G.  Acar,  C.  Castelluccia,  and  C.  Diaz.  The  leaking
battery.  Cryptology  ePrint  Archive,  Report  2015/616,  2015.
[44]	  L.  Olejnik,  C.  Castelluccia,  et  al.  Selling 
oﬀ  privacy  at  auction.  In  NDSS  ’14:  The  2014  Network 
and  Distributed  System  Security  Symposium,  2014. 
[45]	  Phantom  JS.  Supported  web 
standards.  http://www.webcitation.org/6hI3iptm5,  2016. 
[46]  M.  Z.  Raﬁque,  T.  Van  Goethem, W.  Joosen, 
C.  Huygens,  and  N.  Nikiforakis.  It’s  free  for  a  reason:
Exploring  the  ecosystem  of  free  live  streaming  services.
In  Network  and  Distributed  System  Security  (NDSS),  2016.
[47]  N.  Robinson  and  J.  Bonneau.  Cognitive  disconnect: 
Understanding  Facebook  Connect  login  permissions.  In  2nd 
ACM  conference  on  Online  social  networks.  ACM,  2014. 
study  of  insecure  javascript  practices  on  the  web. 
ACM  Transactions  on  the  Web  (TWEB),  7(2):7,  2013. 
[48]	  F.  Roesner,  T.  Kohno,  and  D. Wetherall. 
Detecting  and  Defending  Against  Third-Party 
Tracking  on  the Web.  In  Symposium  on  Networking 
Systems  Design  and  Implementation.  USENIX,  2012. 
[49]	  S.  Schelter  and  J.  Kunegis.  On 
the  ubiquity  of  web  tracking:  Insights  from  a  billion-page 
web  crawl.  arXiv  preprint  arXiv:1607.07403,  2016. 
[50]	  Selenium 
Browser  Automation.  Selenium  faq.  https://code.google. 
com/p/selenium/wiki/FrequentlyAskedQuestions,  2014. 
[51]	  R.  Singel.  Online  Tracking 
Firm  Settles  Suit  Over  Undeletable  Cookies.  http:// 
www.wired.com/2010/12/zombie-cookie-settlement/,  2010. 
[52]	  K.  Singh,  A.  Moshchuk,  H.  J. 
Wang,  and W.  Lee.  On  the  incoherencies  in  web  browser 
access  control  policies.  In  Proceedings  of  S&P.  IEEE,  2010. 
[53]	  A. Soltani, S. Canty, Q. Mayo, L. Thomas, and C. J. Hoofna­
gle. Flash cookies and privacy. In AAAI  Spring  Symposium: 
Intelligent  Information  Privacy  Management,  2010. 
[54]  A.  Soltani, 
A.  Peterson,  and  B.  Gellman.  NSA  uses  Google  cookies  to 
pinpoint  targets  for  hacking.  http://www.washingtonpost. 
com/blogs/the-switch/wp/2013/12/10/nsa-uses-google­
cookies-to-pinpoint-targets-for-hacking,  December  2013. 
[55]  O.  Starov,  J.  Dahse, 
S.  S.  Ahmad,  T.  Holz,  and  N.  Nikiforakis.  No  honor  among 
thieves:  A  large-scale  analysis  of  malicious  web  shells. 
In  International  Conference  on  World  Wide  Web,  2016. 
[68]  A.  Zarras,  A.  Kapravelos,  G.  Stringhini, 
T.  Holz,  C.  Kruegel,  and  G.  Vigna.  The  dark  alleys  of 
madison  avenue:  Understanding  malicious  advertisements. 
In  Internet  Measurement  Conference.  ACM,  2014. 
APPENDIX 
Figure  11:  Third-party  trackers  on  the  top  55k  sites  with 
Ghostery  enabled.  The  majority  of  the  top  third-party 
domains  not  blocked  are  CDNs  or  provide  embedded 
content (such as Google Maps). 
[56]	  The  Guardian. 
‘Tor  Stinks’  presentation  - read  the  full  document. 
http://www.theguardian.com/world/interactive/2013/oct/ 
04/tor-stinks-nsa-presentation-document,  October  2013. 
[57]	  Z.  Tollman. We’re  Going  HTTPS:  Here’s  How WIRED  Is 
Tackling a Huge Security Upgrade. https://www.wired.com/ 
2016/04/wired-launching-https-security-upgrade/,  2016. 
[58]	  J.  Uberti.  New  proposal 
for  IP  address  handling  in WebRTC.  https://www. 
ietf.org/mail-archive/web/rtcweb/current/msg14494.html. 
[59]	  J.  Uberti  and  G.  wei  Shieh. 
WebRTC  IP  Address  Handling  Recommendations.  https: 
//datatracker.ietf.org/doc/draft-ietf-rtcweb-ip-handling/. 
[60]	  S.  Van  Acker,  D.  Hausknecht, W.  Joosen,  and  A.  Sabelfeld. 
Password  meters  and  generators  on  the  web:  From 
large-scale empirical study to getting it right. In Conference 
on  Data  and  Application  Security  and  Privacy. ACM, 2015. 
[61]  S.  Van  Acker,  N.  Nikiforakis,  L.  Desmet, 
W.  Joosen,  and  F.  Piessens.  Flashover:  Automated 
discovery  of  cross-site  scripting  vulnerabilities  in  rich 
internet  applications.  In  Proceedings  of  CCS.  ACM,  2012. 
[62]	  T. Van Goethem, F. Piessens, W. Joosen, and N. Nikiforakis. 
Clubbing  seals:  Exploring  the  ecosystem  of  third-party 
security  seals.  In  Proceedings  of  CCS.  ACM,  2014. 
[63]  T.  Vissers,  N.  Nikiforakis, 
N.  Bielova,  and W.  Joosen.  Crying  wolf?  on  the  price 
discrimination  of  online  airline  tickets.  HotPETS,  2014. 
[64]	  W.  V. Wazer.  Moving  the Washington  Post  to  HTTPS. 
https://developer.washingtonpost.com/pb/blog/post/ 
2015/12/10/moving-the-washington-post-to-https/,  2015. 
[65]  X.  Xing, W.  Meng,  D.  Doozan, 
N.  Feamster, W.  Lee,  and  A.  C.  Snoeren.  Exposing 
inconsistent  web  search  results  with  bobble.  In  Passive 
and  Active  Measurement,  pages  131–140.  Springer,  2014. 
[66]  X.  Xing, W.  Meng,  B.  Lee,  U. Weinsberg,  A.  Sheth, 
R.  Perdisci,  and W.  Lee.  Understanding  malvertising 
through  ad-injecting  browser  extensions.  In  24th 
International Conference on World Wide Web. International 
World Wide Web  Conferences  Steering  Committee,  2015. 
[67]  C.  Yue  and  H. Wang.  A  measurement 
Figure  12:  Three  sample  canvas  ﬁngerprinting  images 
created  by  ﬁngerprinting  scripts,  which  are  subsequently 
hashed and used to identify the device. 
10.  MIXED CONTENT CLASSIFICATION 
To  classify  URLs  in  the  HTTPS  mixed  content  analysis, 
we used the block lists described in Section 4.  Additionally, 