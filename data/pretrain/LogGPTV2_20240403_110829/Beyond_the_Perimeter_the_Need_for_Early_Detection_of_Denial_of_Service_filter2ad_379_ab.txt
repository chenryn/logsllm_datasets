of positives versus false positives that were recorded by
the
system. A positive is when the recorded attack
equates to an actual EOI, whereas a false positive is
when an event is recorded as an attack but is not. Over a
four-week period, a total of 1493 attacks were recorded
against the control computer by the IDS. Of these, 409
attacks were positives and 1084 attacks were false
positives.
The 409 positives were caused by a large number of
Hyper Text Transfer Protocol (HTTP) port scans caused
by an infection within the network perimeter by the
Code Red worm. The Code Red worm [4] is a self-
propagating malicious code that exploits vulnerabilities
in Microsoft Web servers. An upsurge in internal
network traffic illustrated by the bottom line in figure 1
is accounted for by the worm attempting to infect other
servers by sending a crafted HTTP GET request. This
exploits a buffer overflow vulnerability in computers
across the network. During the research period, two
infections were detected by the upsurge in network
traffic activity within the network.  
Proceedings of the 18th Annual Computer Security Applications Conference (ACSAC(cid:146)02) 
1063-9527/02 $17.00 ' 2002 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:28:53 UTC from IEEE Xplore.  Restrictions apply. 
network and associated sub-nets ground to a halt. As the
original infected machine attempted to connect to the
Internet, all attack traffic was routed to the firewall as
the main perimeter conduit to external networks. The
firewall
logged all attempts by the attack traffic to
connect to the external address as suspicious and did not
forward the traffic. However, the number of suspicious
requests for external connection caused the firewall's
hard disks to fill with audit information, until the point
at which the entire hard disk became full and the firewall
crashed. This ensured that no traffic, whether valid or
invalid requests, could pass through it in either direction.
The firewall was unable to provide external users access
to key internal servers, such as the main organisational
Web server or e-mail servers. Internal users were also
unable to connect to external services. This lasted for a
further 5 days due to a lack of a timely back-up plan and
the resulting system reconfiguration.
5. Early detection of DoS attacks beyond the
perimeter
As discussed previously, within the perimeter model,
firewalls enforce network security policies and IDS
detect misuses of the system. However, both types of
security device have distinct disadvantages in the face of
a DoS attack because they are located on the target
system or network. First, all traffic is required to pass in
either direction through the firewall for the security
policies to be enforced. When faced with a large amount
of traffic, a bottleneck can be formed. This bottleneck
then prevents legitimate traffic from passing through the
firewall. Second, whilst DoS is a misuse of systems, it
will already have achieved its objective of flooding the
target system with packets by the time it has been
detected. 
Analysis of the case study demonstrates that there is a
very real requirement for an approach that detects and
responds to DoS attacks prior to their reaching the
target's perimeter. In this way, we can prevent the attack
from succeeding. In order to achieve this, we must focus
on the communications medium beyond the perimeter of
the trusted networks. However, an advantage of the
perimeter model architecture is that we are able to
clearly define normal versus abnormal
traffic in the
organisational security policies. In this way, control over
behaviour within the trusted domain is maintained and
monitored. We are not afforded this distinction in early
detection as we have no such control over behaviour.
Therefore, we need to provide a definition of DoS that
facilitates a distinction between normal and abnormal
traffic beyond the perimeter.
The classifications of DoS attacks presented in
section 2 have in common the issue that
they are
descriptive rather than prescriptive in their approach to
Figure 1. Recorded network traffic by the IDS during
the first period of infection by the Code Red Worm.
The top line shows the number of attacks against
the system, with a proliferation of attacks as the
worm is launched. 
The first infection by the worm had little or no effect
on the principal perimeter model device of the network;
the firewall. During the first period of
infection, 8
infected machines were identified and patches were then
applied by system administrators to remove the infection
in accordance with security alerts pertaining to the
problem. In total, 219 Code Red HTTP GET requests
were received and logged by the control machine IDS.
With approximately 330 machines on this network, we
can see that a large amount of traffic was generated by
requests made to each and every machine. However,
services on the network were not seen to be greatly
degraded.  
A second period of infection by the worm occurred
two weeks after the first. A machine that had been
infected during the first period of infection had been
identified, but patched unsuccessfully. When the Code
Red worm was triggered, it attempted to infect other
machines both within and beyond the network perimeter.
In total, 190 Code Red HTTP connection requests
originating from 4 machines were observed against the
control machine IDS. This was significantly fewer
machines due to earlier successful patching of
the
system, and resulted in less infection traffic being
generated. The infected machines were quickly identified
by network traffic monitoring and again taken off-line
until patches could be applied.
This second infection resulted in severe internal
the attack traffic levels
network disruption. Whilst
observed were less than the first infection, the entire
Proceedings of the 18th Annual Computer Security Applications Conference (ACSAC(cid:146)02) 
1063-9527/02 $17.00 ' 2002 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:28:53 UTC from IEEE Xplore.  Restrictions apply. 
the DoS problem. Whilst they go some way in providing
a description of the attack objective,
they are vague
terms when looking for solutions to the problem. They
provide neither the power nor flexibility with which to
achieve effective detection in the communications
medium beyond the perimeter as they do not facilitate the
distinction between normal traffic and abnormal traffic
[14] required for early detection. To redress this, we
define a DoS attack as:
x distinct packets matching s signature in y seconds to 
h host
Figure 2 demonstrates
the relationship between
elements of the DoS definition for early detection. This
diagram provides us with an intuitive illustration of the
relationship between the x, y, and s on the target host h,
when using a single signature. The precise relationship
between x, y, and s, and in particular the precise value of
s, requires further study. Host h refers to the target of the
DoS attack. Packets x are the total number of packets
directed at h. This is the total of all packets, so includes
both normal and abnormal packets. The DoS attack
packets s are those packets that match a particular
signature of this type of attack. These signatures are
different from those used in perimeter model devices as
we no longer have the clear-cut distinctions that an
organisational policy allows. Time y is the total period
that packets are directed to h. 
are
therefore
able
are twofold. First, we do not focus on the effect of the
attack, but look at the constituent elements of the attack
itself. We
to focus on the
communications-level behaviour of DoS attacks for
early detection purposes. We can see that key to
detection is that packets which match a signature can be
defined as DoS attack packets. Second,
figure 2
demonstrates the main problem caused by these attacks
to perimeter model devices such as firewalls and IDS.
Over a period of time,
the DoS attack sends more
packets to the target. As perimeter model devices log all
packets
as
intrusion attempts or attacks for audit purposes, valuable
processing time and system resources are taken up.
Thus, the longer the duration of the attack, the more
signatures are recorded, which take up even more system
resources on the security device. This may then lead to
the unavailability of these devices.
trusted domain policies
contravening
Within a DoS attack, traffic directed at the victim can
build up very quickly and be sustained for a period of
time. This volume of traffic is the means by which the
attacker wishes to cause the target system to become
unavailable. We can see the impact of DoS attack traffic
on the network within a 2-dimensional view of network
activity in figure 3 below. This 2-dimensional view
observes traffic in terms of time and number of packets
and shows a UDP attack from a single attacker on a
small traffic volume LAN for a total duration of two
minutes. The sharp increase of traffic at 360 seconds
indicates the start of the attack and within a matter of
seconds, the attack reaches a plateau of approximately
1300 packets per 5 seconds. This volume of traffic
continues for the duration of the attack. In total, over
30,000 attack packets are sent to the target. The yield of
the attack will be increased if multiple attacking
machines are used. However, this 2-dimensional view
only allows us to see a build up of traffic or traffic by
protocol. It is therefore insufficient to satisfy us that an
attack is underway rather than a “flash crowd” as there is
no facility to distinguish normal from abnormal traffic.
Figure 2.
Illustration of the relationship between
elements in the DoS definition for a single attack on
a particular host.
The advantages of using this definition of DoS attacks
Proceedings of the 18th Annual Computer Security Applications Conference (ACSAC(cid:146)02) 
1063-9527/02 $17.00 ' 2002 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:28:53 UTC from IEEE Xplore.  Restrictions apply. 
that subvert UDP or ICMP require a large amount of
data to be sent
to the victim to consume available
bandwidth and prevent legitimate users from accessing
resources [5]. Third, related to rate of transfer, we have a
characteristic of time. A DoS attack differs from other
types of attack as a DoS attack is more successful the
longer it affects the victim. Therefore, we will see a high
rate of data transfer over a period of time.
When we apply our approach to the same traffic as
seen in figure 3, and therefore add the third dimension of
our early detection signatures to the traffic view, we can
see that the build up of traffic is in effect an attack. As
discussed above, the signatures used in early detection
will differ from those used in the perimeter model; they
are more generic and combine various factors. A
combination of features in an attack prove to have a
greater distinctive power than any one feature by itself
[28]. In figure 4 below, we have the characteristics
discussed above; a victim, a high rate of data transfer,
and the traffic is sustained at a high level for a period of
time. S relates to a number of features determining an
attack rather than just one single observed signature.
Within this attack, in addition to the other characteristics
mentioned earlier, we see a fixed packet size, single
source IP address, and all
to a single
destination port, that combined form our signature. This
port did not relate to a service on the victim. Therefore,
the victim machine responded to the UDP attack packets
with ICMP messages to inform the attacking machine
that the requested service was not available. Although
not shown, we observed a large amount of ICMP traffic
coming from the victim and directed at the attacker. As
we can see in the figure below, these signatures were
observed from the start of the attack at 360 seconds,
until the attack was terminated at 500 seconds. We can
see that the virtually all of the traffic traversing the
network (represented by the x axis) matches our
signature (represented by the s axis).    
traffic sent
Figure 3. 2-dimensional view of network traffic
during a UDP flood attack showing number of
packets on the network/5 seconds. 
Figure 3 represents an important distinction between
DoS attacks and other attacks, for example, those that
attempt to execute malicious code on their victim, which
can be used for early detection. Often (but not always), a
DoS attack requires a large amount of data to be sent to
the victim. It is the mass of all packets directed at a
victim that poses the threat, rather than the packets
themselves [9]. For example, it takes 500 packets/second
to successfully bring down an Internet server during a
SYN flood [27]. Therefore, the focus of our detection
shifts from one based on content to one based on volume
of packets with corresponding features.
An approach that sifts information in potentially high
volumes of
traffic can require a great amount of
processing power. In work on detecting backdoors [28],
it was observed that the more traffic that can be discarded
based on information in the TCP/IP headers, the better, as
this can reduce the processing load on the monitor.
Therefore, our approach looks at the content of packet
headers, and the information that they yield, to provide
our signatures. 
Three characteristics that are present in packet headers
aid us in the signature process. First, there is the victim,
represented by the destination IP address. Whilst
the
source IP address of an attack packet may be forged, such
as is required by TCP SYN flooding, the destination
address
the
destination address is not a factor as the attack has
already reached its destination by the time the attack is
detected. However, for an approach that focuses on
traffic en route, this is an important factor as it allows us
to identify the target of an attack. Second, there is a rate
of transfer of particular data types. For example, attacks
cannot. Within the perimeter model,
Proceedings of the 18th Annual Computer Security Applications Conference (ACSAC(cid:146)02) 
1063-9527/02 $17.00 ' 2002 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:28:53 UTC from IEEE Xplore.  Restrictions apply. 
packets on the s axis. In the case of a “flash crowd”,
connections are established, but not enough to satisfy
demand. Therefore, we would expect
to see a more
gradual increase in TCP traffic rather than a sudden co-
ordinated traffic spike. We would also expect a more
gradual decrease in TCP traffic as connections are made
and then ended. In addition, within this particular attack,
we are aided by a flaw in the attacker's program that
verifies that this is in fact an attack. The sequence
number used in the initial SYN packet was constant in
all attack packets; 674719801. It is highly unlikely that
2000 individual hosts would have identical sequence
numbers.
Figure 5. View of network traffic during a TCP SYN
flood attack. By applying the signature axis to
determine that connections are not established we
can distinguish attack traffic from “flash crowd”
traffic.
The question remains of how we can detect an attack
of only a small number of packets, or where the total
traffic throughput outweighs the DoS attack traffic. For
example, the DoS traffic traversing the Internet may not
travel by the same route as other packets of the attack. It
is only when they reach the final destination that we may
see the upsurge in attack traffic as shown in figure 3. To
test our approach's ability to detect abnormal traffic in
such situations, we ran tests with a DoS attack, nuke ,