1
The Tor Project
Our mission is to be the global resource for 
technology, advocacy, research and 
education in the ongoing pursuit of freedom 
of speech, privacy rights online, and 
censorship circumvention. 
2
● Online Anonymity
– Open Source
– Open Network
● Community of 
researchers, 
developers, users and 
relay operators.
● U.S. 501(c)(3) non-
pro%t organization
3
Estimated 2,000,000+
 daily Tor users
4
Threat model:
what can the attacker do?
Alice
Anonymity network
Bob
watch (or be!) Bob!
watch Alice!
Control part of the network!
5
Anonymity isn't encryption: 
Encryption just protects contents.
Alice
Bob
“Hi, Bob!”
“Hi, Bob!”
attacker
6
Anonymity serves different 
interests for different user groups.
Anonymity
“It's privacy!” Private citizens
7
Anonymity serves different 
interests for different user groups.
Anonymity
Private citizens
Businesses
“It's network security!”
“It's privacy!”
8
Anonymity serves different 
interests for different user groups.
Anonymity
Private citizens
Governments
Businesses
“It's traffic-analysis
resistance!”
“It's network security!”
“It's privacy!”
9
Anonymity serves different 
interests for different user groups.
Anonymity
Private citizens
Governments
Businesses
“It's traffic-analysis
resistance!”
“It's network security!”
“It's privacy!”
Human rights
activists
“It's reachability!”
10
The simplest designs use a single 
relay to hide connections.
Bob2
Bob1
Bob3
Alice2
Alice1
Alice3
Relay
E(Bob3,“X”)
E(Bob1, “Y”)
E(Bob2, “Z”)
“Y”
“Z”
“X”
(example: some commercial proxy providers)
11
But a central relay is
a single point of failure.
Bob2
Bob1
Bob3
Alice2
Alice1
Alice3
Evil
Relay
E(Bob3,“X”)
E(Bob1, “Y”)
E(Bob2, “Z”)
“Y”
“Z”
“X”
12
... or a single point of bypass.
Bob2
Bob1
Bob3
Alice2
Alice1
Alice3
Irrelevant
Relay
E(Bob3,“X”)
E(Bob1, “Y”)
E(Bob2, “Z”)
“Y”
“Z”
“X”
Timing analysis bridges all connections 
through relay  
⇒ An attractive fat target
13
14
15
16
Tor's safety comes from diversity
● #1: Diversity of relays. The more relays 
we have and the more diverse they are, 
the fewer attackers are in a position to do 
traffic confirmation. (Research problem: 
measuring diversity over time)
● #2: Diversity of users and reasons to use 
it. 50000 users in Iran means almost all of 
them are normal citizens.
17
Transparency for Tor is key
● Open source / free software
● Public design documents and 
specifications
● Publicly identified developers
● Not a contradiction:                    
privacy is about choice!
18
But what about bad people?
● Remember the millions of daily users.
● Still a two-edged sword?
● Good people need Tor much more 
than bad guys need it. 
19
Myth #1
● “I heard the Navy wrote Tor 
originally, so how can I trust it?” 
20
Myth #2
● “I heard the NSA runs half the 
relays.”
21
Myth #3
● “I heard Tor is slow.”
22
Myth #4
● “I heard Tor gets most of its money 
from the US government.”
23
Myth #5
● “I heard 80% of Tor is bad people.”
24
Myth #6
● “I shouldn't use Tor, because if I do 
the NSA will watch me.”
25
Myth #7
● “I heard Tor is broken.”
26
Onion Service
27
Onion service properties
● Self authenticated
● End-to-end encrypted
● Built-in NAT punching
● Limit surface area
● No need to “exit” from Tor
28
29
About 3%
●  – 
onion services are still in the 
“neat toy” stage
● Terbium labs (and others) found 
about 7000 useful onion sites 
30
31
SecureDrop
https://securedrop.org/directory
Today, 30+ organizations use SecureDrop
32
Ricochet
33
OnionShare
34
Services and Tools
https://help.riseup.net/en/tor#riseups-tor-hidden-services
All Riseup.net services are 
available using hidden service
... and many others
Package repository
apt-get install apt-tor-transport
http://vwakviie2ienjx6t.onion/
...
35
Anonymous updates are awesome
● Evil package repository can't 
target you with a bad update, 
because they don't know it's you
● Local observer can't learn what 
you're updating, so they can't 
target you for being out of date
36
37
38
39
40
41
42
43
HS Directory
Hashring
HSDirn
Desc IDrep0
Desc IDrep1
HSDirn+1
HSDirn+2
HSDirn
HSDirn+1
HSDirn+2
Desc ID = H(onion-address | H(time-period | descriptor-cookie | replica))
44
New keys => longer onion addresses
nzh3fv6jc6jskki3.onion
From 16 characters:
... to 52 characters:
a1uik0w1gmfq3i5ievxdm9ceu27e88g6o7pe0r,dw9jmntwkdsd.onion
(ed25519 public key base32 encoded)
45
Network-wide shared random value
● The six HSDirs for a given onion address 
are predictable into the future
● So bad guys can run six relays with just 
the right keys to target a specific future 
day...to censor it or to measure popularity
● People – we don't know who – were doing 
this attack in practice
46
Network-wide shared random value
● The solution: make the HSDir mapping 
include a communal random value that 
everybody agrees about but that nobody 
can predict
● The directory authorities pick this value 
each day as part of their consensus voting 
process
47
HSDirs get to learn onion addresses
● The onion service descriptor (which gets 
uploaded to the HSDir) includes the 
public key for the service (so everybody 
can check the signature)
● So you can run relays and discover 
otherwise-unpublished onion addresses
● “Threat intelligence” companies have 
been trying to do just that
48
HSDirs get to learn onion addresses
● The solution: the new cryptosystem has a 
cool feature where you can sign the onion 
descriptor with a subkey
● So everybody can check the signature but 
nobody can learn the main key from the 
subkey
● Should finally kill the arms race with 
jerks running relays to gather onions
49
Rendezvous Single Onion Services
Rendezvous Point
Proposal 260
50
OnionBalance
https://onionbalance.readthedocs.org
51
Vanguards (Tor proposal 271)
● Tor clients use a single relay (called a 
Guard) for the first hop in all their paths, 
to limit exposed surface area
● But there are relatively easy attacks to 
learn a user's guard, and for onion 
services that can be especially bad.
● Multiple layers of guards protect better 
against Sybil+compromise attacks
52
Deployment timeline
● HSDir side:
● Client side:
● Service side:
Try it at: 
53
Tor isn't foolproof
● Opsec mistakes
● Browser metadata fingerprints
● Browser exploits
● Traffic analysis
54
“Still the King of high secure,
low latency Internet Anonymity”
“There are no contenders for the throne”