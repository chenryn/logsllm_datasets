and Marceau et. al. [26] propose building n-gram based detection
methods by sequential modeling of process actions and identifying
anomalies that deviate from the expected behavior. In our work,
we focus on single command-line events to determine malicious
intent, which is more challenging. Rai et. al [36] study anomaly
detection methods based on parent-child process relationships for
Living-Off-The-Land detection using a limited dataset. Our active
learning approach incorporates command-line text with parent
process information to discover new attacks and capture known
patterns effectively. Considering the nature of multi-stage attacks,
our work could be expanded to include sequential modeling to
detect more sophisticated attack campaigns.
Active learning for security. Active learning has been proposed
in a variety of applications where efficient human labeling process
is beneficial [1, 25, 55]. With the omnipresence of large-scale detec-
tion systems in security, active learning has been studied as many
of these systems rely on valuable human expert time to investigate
detected samples. Pelleg and Moore [33] proposed an active anom-
aly detection method that selects the most anomalous samples to be
labeled in order to find rare classes and samples as quickly as possi-
ble. Almgren and Jonsson [2] use an active learning method based
on uncertainty sampling using SVM. Stokes et. al [51] proposed AL-
ADIN, an active learning framework to classify network traffic that
incorporates an active anomaly detector and a linear multi-class
classifier. Siddiqui et. al [47] use an active anomaly detector based
on Isolation Forests, incorporating explanations to guide the ex-
pert’s investigation. Several works studied the application of active
learning in adversarial scenarios [5, 15, 18, 31, 43, 44, 54, 56, 59].
Gornitz et. al [19] propose a method that selects samples based on
both the proximity to the decision boundary and the clustering
coefficient using k-nearest neighbors. Beaugnon et. al. introduce
ILAB [7] as an active learning method for intrusion detection. Our
work differs in using active learning guided by a boosting classifier
and a naïve bayes anomaly detector, applied to command embed-
ding representation, with the goal of detecting LOL attacks that
leverage existing Windows tools. An orthogonal problem studied
in previous work [11] is training data reduction, while our work
addresses the challenge of limited malicious samples.
7 CONCLUSION
We present a new active learning framework LOLAL designed to
detect Living-Off-The-Land attacks on target systems. We introduce
a novel command-line vectorization method (cmd2vec) using NLP
RAID ’21, October 6–8, 2021, San Sebastian, Spain
techniques, which could be instrumental in representing command
lines for a variety of security applications. The active learning mod-
ule uses a non-linear boosting classifier and a naïve bayes anomaly
detector, together with an adaptive sampling strategy, to select
anomalous and uncertain samples for labeling by a human analyst
iteratively. We show that LOLAL is effective when a limited num-
ber of labeled samples are available for training machine learning
models by leveraging novel methods to represent command-line
text based on word-embedding techniques and token scores. Our
results demonstrate that LOLAL converges in less than 30 iterations,
reaching precision and recall above 0.97 for almost all attack classes.
Our proposed sampling strategy based on both anomalous and un-
certain samples performs better than sampling only one of these
types, and improves significantly compared to random sampling.
We use a unique real-world dataset for this problem, and show
the effectiveness of active learning. We believe active learning for
security is underutilized, and should be explored more in settings
where the availability of labeled instances is limited.
ACKNOWLEDGMENTS
We thank our shephard, Kevin Roundy, and the anonymous review-
ers for their valuable suggestions. The work done at Northeastern
University was partly sponsored by the contract number W911NF-
18-C0019 with the U.S. Army Contracting Command - Aberdeen
Proving Ground (ACC-APG) and the Defense Advanced Research
Projects Agency (DARPA), and by the U.S. Army Combat Capa-
bilities Development Command Army Research Laboratory under
Cooperative Agreement Number W911NF-13-2-0045 (ARL Cyber
Security CRA). The views and conclusions contained in this doc-
ument are those of the authors and should not be interpreted as
representing the official policies, either expressed or implied, of
the ACC-APG, DARPA, Combat Capabilities Development Com-
mand Army Research Laboratory or the U.S. Government. The U.S.
Government is authorized to reproduce and distribute reprints for
Government purposes notwithstanding any copyright notation here
on. This project was also funded by NSF under grant CNS-171763.
REFERENCES
[1] Mohamad Mahmoud Al Rahhal, Yakoub Bazi, Haikel AlHichri, Naif Alajlan,
Farid Melgani, and Ronald R Yager. 2016. Deep learning approach for active
classification of electrocardiogram signals. Information Sciences 345 (2016), 340–
354.
[2] M. Almgren and E. Jonsson. 2004. Using active learning in intrusion detection.
In Proc. IEEE Computer Security Foundations Workshop. 88–98.
[3] Dana Angluin. 1988. Queries and concept learning. Machine learning 2, 4 (1988),
319–342.
net/
[4] AppArmor. 2021. AppArmor: Linux kernel security module. https://apparmor.
[5] Ignacio Arnaldo, Kalyan Veeramachaneni, and Mei Lam. 2019. eX2: a framework
for interactive anomaly detection.. In IUI Workshops.
[6] Les Atlas, David Cohn, and Richard Ladner. 1989. Training connectionist net-
works with queries and selective sampling. Advances in neural information
processing systems 2 (1989), 566–573.
[7] Anaël Beaugnon, Pierre Chifflier, and Francis Bach. 2017. Ilab: An interactive
labelling strategy for intrusion detection. In International Symposium on Research
in Attacks, Intrusions, and Defenses. Springer, 120–140.
[8] Battista Biggio, Blaine Nelson, and Pavel Laskov. 2012. Poisoning attacks against
[9] Daniel Bohannon and Lee Holmes. 2017. Revoke-obfuscation: powershell obfus-
support vector machines. In ICML.
cation detection using science.
[10] Leo Breiman. 2001. Random forests. Machine learning 45, 1 (2001), 5–32.
[11] Varin Chouvatut, Wattana Jindaluang, and Ekkarat Boonchieng. 2015. Training
set size reduction in large dataset problems. In 2015 International Computer Science
454RAID ’21, October 6–8, 2021, San Sebastian, Spain
Ongun, et al.
and Engineering Conference (ICSEC). IEEE, 1–5.
[13] Crowdstrike. 2019.
[12] David A Cohn, Zoubin Ghahramani, and Michael I Jordan. 1996. Active learning
with statistical models. Journal of artificial intelligence research 4 (1996), 129–145.
The Rise of “Living off the Land” Attacks | Crowd-
Strike. https://www.crowdstrike.com/blog/going-beyond-malware-the-rise-of-
living-off-the-land-attacks
[14] Cytomic. 2019. Living-off-the-Land attacks: what are they and why should they
worry you? | Cytomic . https://www.cytomicmodel.com/news/living-off-the-
land-attacks
[15] Alessandra De Paola, Salvatore Gaglio, Giuseppe Lo Re, and Marco Morana. 2018.
A hybrid system for malware detection on big data. In IEEE INFOCOM 2018-IEEE
Conference on Computer Communications Workshops (INFOCOM WKSHPS). IEEE,
45–50.
[16] Hervé Debar, Marc Dacier, Mehdi Nassehi, and Andreas Wespi. 1998. Fixed vs.
variable-length patterns for detecting suspicious process behavior. In European
Symposium on Research in Computer Security. Springer, 1–15.
[17] Benoît Frénay and Michel Verleysen. 2013. Classification in the presence of label
noise: a survey. IEEE transactions on neural networks and learning systems 25, 5
(2013), 845–869.
[18] Nico Görnitz, Marius Kloft, Konrad Rieck, and Ulf Brefeld. 2009. Active learning
for network intrusion detection. In Proceedings of the 2nd ACM workshop on
Security and artificial intelligence. ACM, 47–54.
[19] Nico Görnitz, Marius Kloft, Konrad Rieck, and Ulf Brefeld. 2013. Toward su-
pervised anomaly detection. Journal of Artificial Intelligence Research 46 (2013),
235–262.
[20] Tianyu Gu, Brendan Dolan-Gavitt, and Siddharth Garg. 2017. Badnets: Identifying
vulnerabilities in the machine learning model supply chain. arXiv preprint
arXiv:1708.06733 (2017).
[21] M. Jagielski, A. Oprea, B. Biggio, C. Liu, C. Nita-Rotaru, and B. Li. 2018. Ma-
nipulating Machine Learning: Poisoning Attacks and Countermeasures for Re-
gression Learning. In 2018 IEEE Symposium on Security and Privacy (SP). 19–35.
https://doi.org/10.1109/SP.2018.00057
[22] Thorsten Joachims. 1998. Text categorization with support vector machines:
Learning with many relevant features. In European conference on machine learning.
Springer, 137–142.
[23] Armand Joulin, Edouard Grave, Piotr Bojanowski, and Tomas Mikolov. 2016. Bag
of tricks for efficient text classification. arXiv preprint arXiv:1607.01759 (2016).
[24] David D Lewis and William A Gale. 1994. A sequential algorithm for training
text classifiers. In SIGIR’94. Springer, 3–12.
[25] Tong Luo, Kurt Kramer, Dmitry B Goldgof, Lawrence O Hall, Scott Samson,
Andrew Remsen, Thomas Hopkins, and David Cohn. 2005. Active learning to
recognize multiple types of plankton. Journal of Machine Learning Research 6, 4
(2005).
[26] Carla Marceau. 2001. Characterizing the behavior of a program using multiple-
length n-grams. In Proceedings of the 2000 workshop on New security paradigms.
101–110.
[27] Tren Micro. 2021. Tracking, Detecting, and Thwarting PowerShell-based
Malware and Attacks - Security News. https://www.trendmicro.com/vinfo/hk-
en/security/news/cybercrime-and-digital-threats/tracking-detecting-and-
thwarting-powershell-based-malware-and-attacks
[28] Microsoft. 2018. Out of sight but not invisible: Defeating fileless malware with
behavior monitoring, AMSI, and next-gen AV - Microsoft Security.
https:
//www.microsoft.com/security/blog/2018/09/27/out-of-sight-but-not-invisible-
defeating-fileless-malware-with-behavior-monitoring-amsi-and-next-gen-av
| Microsoft Secu-
https://www.microsoft.com/en-us/security/business/threat-protection/
Microsoft Defender for Endpoint
[29] Microsoft. 2021.
rity.
endpoint-defender
[30] Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg S Corrado, and Jeff Dean. 2013.
Distributed representations of words and phrases and their compositionality. In
Advances in neural information processing systems. 3111–3119.
[31] Brad Miller, Alex Kantchelian, Sadia Afroz, Rekha Bachwani, Edwin Dauber,
Ling Huang, Michael Carl Tschantz, Anthony D Joseph, and J Doug Tygar. 2014.
Adversarial active learning. In Proceedings of the 2014 Workshop on Artificial
Intelligent and Security Workshop. ACM, 3–14.
[32] Palo Alto Networks. 2020. What Are Fileless Malware Attacks and “Living Off the
Land”? Unit 42 Explains. https://www.paloaltonetworks.com/cyberpedia/what-
are-fileless-malware-attacks
[33] D. Pelleg and A. Moore. 2004. Active Learning for Anomaly and Rare-Category
Detection. In Proc. Advances in Neural Information Processing Systems. 1073–1080.
Living Off The Land Binaries for UNIX.
[34] GTFOBins Project. 2021.
https://gtfobins.github.io/.
[35] LOLBAS Project. 2021. Living Off The Land Binaries and Scripts (and also
Libraries). https://lolbas-project.github.io/.
[36] Shubham Rai. 2020. Behavioral Threat Detection: detecting Living of Land Tech-
niques. Master’s thesis. University of Twente.
[37] Juan Ramos et al. 2003. Using tf-idf to determine word relevance in document
queries. In Proceedings of the first instructional conference on machine learning,
Vol. 242. Piscataway, NJ, 133–142.
[38] Korlakai Vinayak Rashmi and Ran Gilad-Bachrach. 2015. DART: Dropouts meet
Multiple Additive Regression Trees.. In AISTATS. 489–497.
[39] N Roy and A McCallum. 2001. Toward optimal active learning through sampling
estimation of error reduction. Int. Conf. on Machine Learning.
[40] Amir Rubin, Shay Kels, and Danny Hendler. 2019. Detecting Malicious PowerShell
Scripts Using Contextual Embeddings. arXiv preprint arXiv:1905.09538 (2019).
[41] Gili Rusak, Abdullah Al-Dujaili, and Una-May O’Reilly. 2018. Ast-based deep
learning for detecting malicious powershell. In Proceedings of the 2018 ACM
SIGSAC Conference on Computer and Communications Security. ACM, 2276–2278.
[42] Andrew I Schein and Lyle H Ungar. 2007. Active learning for logistic regression:
an evaluation. Machine Learning 68, 3 (2007), 235–265.
[43] D Sculley. 2007. Online active learning methods for fast label-efficient spam
filtering.. In CEAS, Vol. 7. 143.
[44] D Sculley, Matthew Eric Otey, Michael Pohl, Bridget Spitznagel, John Hainsworth,
and Yunkai Zhou. 2011. Detecting adversarial advertisements in the wild. In
Proceedings of the 17th ACM SIGKDD international conference on Knowledge
discovery and data mining. ACM, 274–282.
[45] Burr Settles. 2009. Active Learning Literature Survey. Computer Sciences Technical
Report 1648. University of Wisconsin–Madison.
[46] H Sebastian Seung, Manfred Opper, and Haim Sompolinsky. 1992. Query by
committee. In Proceedings of the fifth annual workshop on Computational learning
theory. 287–294.
[47] Md Amran Siddiqui, Jack W Stokes, Christian Seifert, Evan Argyle, Robert Mc-
Cann, Joshua Neil, and Justin Carroll. 2019. Detecting Cyber Attacks Using
Anomaly Detection with Explanations and Expert Feedback. In ICASSP 2019-2019
IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP).
IEEE, 2872–2876.
[48] Robin Sommer and Vern Paxson. 2010. Outside the Closed World: On Using
Machine Learning for Network Intrusion Detection. In 2010 IEEE Symposium on
Security and Privacy. 305–316. https://doi.org/10.1109/SP.2010.25
Let’s dig deeper on how cybercriminals use ‘Liv-
ing off the land’ attack tactics | Cyware Hacker News.
Cyware (Mar
2019). https://cyware.com/news/lets-dig-deeper-on-how-cybercriminals-use-
living-off-the-land-attack-tactics-cac5c132
[49] Ryan Stewart. 2019.
[50] Jack W Stokes, Ashish Kapoor, and Debajyoti Ray. 2016. Asking for a second opin-
ion: Re-querying of noisy multi-class labels. In 2016 IEEE International Conference
on Acoustics, Speech and Signal Processing (ICASSP). IEEE, 2329–2333.
[51] Jack W Stokes, John Platt, Joseph Kravis, and Michael Shilman. 2008. Aladin:
Active learning of anomalies to detect intrusions. (2008).
[52] Symantec. 2017. Living off the land and fileless attack techniques. Technical
Report.
[53] Symantec. 2021. PowerShell threats surge - Symantec Enterprise.
https:
//community.broadcom.com/symantecenterprise/communities/community-
home/librarydocuments/viewdocument?DocumentKey=cbd24b89-1022-
4fe8-800d-a362f3d4cf06&CommunityKey=1ecf5f55-9545-44d6-b0f4-
4e4a7f5f5e68&tab=librarydocuments
[54] Jorge L Guerra Torres, Carlos A Catania, and Eduardo Veas. 2019. Active learning
approach to label network traffic datasets. Journal of information security and
applications 49 (2019), 102388.
[55] Devis Tuia, Frédéric Ratle, Fabio Pacifici, Mikhail F Kanevski, and William J
Emery. 2009. Active learning methods for remote sensing image classification.
IEEE Transactions on Geoscience and Remote Sensing 47, 7 (2009), 2218–2232.
[56] Kalyan Veeramachaneni, Ignacio Arnaldo, Vamsi Korrapati, Constantinos Bassias,
and Ke Li. 2016. AIˆ 2: training a big data machine to defend. In 2016 IEEE 2nd
International Conference on Big Data Security on Cloud (BigDataSecurity), IEEE
International Conference on High Performance and Smart Computing (HPSC), and
IEEE International Conference on Intelligent Data and Security (IDS). IEEE, 49–54.
[57] Venafi. 2020. Beware of Cyber Attackers “Living off the Land” | Venafi. https:
[58] Qi Wang, Wajih Ul Hassan, Ding Li, Kangkook Jee, Xiao Yu, Kexuan Zou, Jungh-
wan Rhee, Zhengzhang Chen, Wei Cheng, C Gunter, et al. 2020. You are what
you do: Hunting stealthy malware via data provenance analysis. In Proc. of the
Symposium on Network and Distributed System Security (NDSS).
//www.venafi.com/blog/beware-cyber-attackers-living-land
[59] Colin Whittaker, Brian Ryner, and Marria Nazif. 2010. Large-scale automatic
classification of phishing pages. (2010).
[60] Muhammd Mudassar Yamin and Basel Katt. 2018. Detecting Malicious Windows
Commands Using Natural Language Processing Techniques. In International
Conference on Security for Information Technology and Communications. Springer,
157–169.
455