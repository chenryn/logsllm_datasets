914C
7D4A
9984 8969
.LV.L.V.L.V.L.I.L.V.L
1649
C056
914C
5269
0000
0000
0000
0F010R010600001002000070000000000000014
pere Reeuts
.Source
Cort
.Tergr.
Court
youSpeuDs
23117
dShort 23117
DeteInspector人_SruchureWower
AO
人nd人B
fset
163939by
图1.3.9HexWorkshop编辑界面
WinHex与上述两款十六进制编辑软件相比，有一个更加强大的特性，就是可以充许您透
过文件系统直接对磁盘的扇区、进行操作。专业的数据恢复专家更喜欢使用这种工具，它的
界面如图1.3.10所示。
除此以外，有些人还会偏好没有GUI界面的H-viwe等工具。不管什么工具，只要根据您
的个人喜好拥有其中之一就行。本书中将始终使用UltraEdit作为十六进制文本编辑器。
除以上几款二进制编辑器之外，在分析具有复杂数据结构的文件时，我们往往会采用010
editor。这个二进制编辑器与传统编辑器有很大不同，它支持解析脚本的运行，可以将复杂的
文件格式中有意义的数据结构注意提取出来。我们将在第17章讨论复杂文件格式的时候详细
介绍010editor下的文件解析与脚本编程。
1.3.6VMware简介
在研究Windows漏洞时，我们往往要实验Windows2000、WindowsXP、Windows2003、
Windowsvista、Windows7等多种平台，有时还要对比补丁前后系统的变化。如果为每套操
21
---
## Page 47
0
day
作系统、每款补丁都分配一台计算机的话这将是一件非常烧钱的事，而虚拟机的出现将解决
安
这个问题。
全
winttex-[server.exe]
：
软
件漏
Case Data
seve.6
FijeEgn
offset
01234567
040cC1Docuents nd Beinge
8
00000000
D,5A900003000000
server.ecs
洞
分析
00000010
8800000000000000
400C
00000020
0000000000000000
000C
File siz8.
48.0KB
00000030
0000000000000000
00
OC
49,152byes
技术
00000040
OE 1F BA 0E 00 B4 09 CD
21
BE
Default Edit Mode
00000050
69 73 20 70 72 6F 67 72
616L
eujbuo
00000060
74 20 62 65 20 72 75 6E
590Z
Undolevel
0
00000070
6D 6F 64 65 2E 0D 0D 0A
240C
Undorverses
n/a
（第
DataInterp
x080
9A FC
Creione.
72 EF 51 B1 AA F0 SB B1
08/08/2007
8B(7:7)
060
19 EC
13:00:30
2
32B(7:9460301
16 Bit(?:23117
OAO
F8 EF 48 B19F F05BB1
9A FC
Last wte tme:08/08/2007
080
72 EF 50 B1 88 F0 SB B1
59ZS
14:10:58
版
000OOOCO
0000000000000000
5045
Atnbutes:
00000000
F23CE24600000000
3000
Icons:
0
03000000
0B01060000700000
005C
0000000
4026000000100000
00BC
Character set ANBIABCH
Mode:
hexadecimal
00000100
0010000000100000
040C
Ofsets:
hexadecimel
00000110040000000000000000DCBg18x18288
Pag1of171
Offset
0
77Block
eBe
n/e
图1.3.10WinHex编辑界面
与平时所说的Java虚拟机不同，这里所说的虚拟机是指通过软件来模拟具有完整硬件系统
功能的、运行在一个完全隔离环境中的完整计算机系统。通过虚拟机软件，您可以在一台物理
计算机上模拟出一台或多台虚拟的计算机，这些虚拟机完全就像真正的计算机那样进行工作，
例如您可以安装操作系统、安装应用程序、访问网络资源等等。对于您而言，它只是运行在物
理计算机上的一个应用程序，但是对于在虚拟机中运行的应用程序而言，它就像是在真正的计
算机中进行工作。
除了节约资金外，虚拟机还有以下两点优势让安全工作者们不忍抛弃。
（1）虚拟机具有出色的快照功能。我们可以通过创建快照，可以将虚拟机中的操作系统快
速的恢复到某一状态。例如，调试病毒样本后，需要将操作系统恢复到干净的状态：Patch过
补丁后，又希望把系统恢复到有漏洞的状态等。
（2）可以防止漏洞分析中对操作系统和资料的破坏。由于漏洞测试过程是在虚拟机当中进
行的，绝大多数的情况下不会对宿主机产生影响。
在Windows系统下，自前流行的虚拟机软件有VMware和VirtualPC，它们都能在Windows
系统上虚拟出多个计算机，用于安装Linux、OS/2、FreeBSD等其他操作系统。本书将使用
VMware作为虚拟机软件，接下来我们来看看VMware的使用方法。
这里演示安装的是VMware6.5.3版本，软件的安装过程与一般的应用软件安装没有什么区
别，输入正确序列号后就可以使用。其使用界面如图1.3.11所示。
22
---
## Page 48
第
1
LileZ4itYie
lidebur
HomeX
Porersd Oa
Territes
VMwareWorkstation
基
础
VMnare Wgrtstatonalows mutple standard operatng syst
withhigh perf
知
识
banel.Inbe
rOv wouid e standard FC
图1.3.11VMware的使用界面
用鼠标选择图标，会出现VMware新建虚拟机向导，如图1.3.12的画面。
Wizard
Welcome to the New Virtual
Machine Wizard
What type of conhiguration do you want?
 Typical (recommended)
Create o Workstetion 6.5 virtusl machine
In a few easy steps.
Custom (advanced)
Create a vrtual machine with advanced
VMware
Workstation6.5
Heip
Cancel
图1.3.12新建虚拟机类型选择画面
VMware首先会让您选择要建立什么类型的虚拟机，“Typical”指的是传统硬件环境的虚拟
机，也就是一般使用的基于Intelx86结构的计算机系统，这也是VMware所推荐的虚拟机系统
安装环境。“Custom”是用来建立有特殊硬件结构需要的虚拟机，例如建立支持SCSI控制器的
虚拟机系统环境，您可以理解“Custom”类型属于高级配置模式，一般情况下，我们选择“Typical”
来建立虚拟机环境。单击“Next”按钮后，如图1.3.13所示。
23
---
## Page 49
0
day
New Virtual Machine Wizard
安全
Guest Operating System Installation
Avirtual machine s lla aphyskalcomputer;tnoeds an operating
system.Howwyouinstaltheguetoperating system
：
Instalfrom:
软件漏
Olnalerdsc:
ovoyCD-RwDe()
洞分析技术
Instalr dscmago fle (iso):
C:Setup Fles|O5|wINP_CN_SP3.so
Browe..
wndowsxPProfessonal detected.
This opering sytem w use Easy Instal.(at'sh)
OIwinstallthe operating sysmlater
The vitumachne wibe croeted wtha blankharddsk
Cancel
2
版
图1.3.13选择预安装操作系统来源
利用VMware安装操作系统首先第一步就是选择操作系统源文件的来源，VMware支持传
统的利用光驱安装操作系统，同时也支持利用光盘镜像文件iso来安装操作系统。我们这里选
择使用iso文件作为安装操作系统的来源之后，单击“Next”按钮，如果虚拟机能够自动识别
要安装的操作系统就会显示图1.3.16的界面，如果虚拟机不能够自动识别要安装的操作系统，
就会显示图1.3.14的界面。
Select a Guest Operating System
Whichoperating system wll be Instaled on this virtualmachine
sudo
OMcrosoftwindows
OUuX
Osun Solars
ONovelNetware
Oober
Version
Windows XP Professiona
Hep
Cancol
图1.3.14选择预安装操作系统类型
当VMware不能够自动识别要安装的系统时，我们需要手工选择要安装的操作系统类型。
VMware支持Windows、Linux、NovellNetWare、SunSolaris等操作系统。同时，VMware还
对每一种类型的操作系统有着更加具体的支持，如图1.3.15所示。
24
---
## Page 50
第
w Virtual Marchine Wizard
1
Select a Guest Operating System
章
Which operating system wdl be installed on this virtual machine?
Guntoperating system
基
OMorosaft Wndows
础
Ounx
ONovel NerWare
知
OsunSolars
识
Oother
Wnd
XP Proh
Wndows98
vsMe
Windows 2000Professional
SNT
windows 2000 Advanced Serves
Windows 2000 Server
5 XP Professional x64 Edtion
windowsVist&x54 Edtion
Windows Vists
windowsServer2003webEdRion
AndowsServer 2003Sandard Edition
ssngpco
Windows Server 2003 Enterprise Edition
Windows Server 2003 Standard x64 Edktion
Windows5erver 2008x64Edition
wndowsServer2008
图1.3.15选择操作系统具体版本
在图1.3.15的下拉列表中选择好我们即将安装的具体操作系统版本型号后（这里选择的是
微软的WindowsXPProfessional操作系统），单击“Next”按钮，如图1.3.16所示。
Easy Install Inlormation
This i used to Instal windows >P Professional
Windows product kay
PersonalzeWindows
odminisbrator
Confirm:
Hep
<>
图1.3.16填写待安装操作系统序列号以及管理员密码
新版本的VMware比较以前VMware5的版本在细节方面有了较大改变，在安装操作系统
之前提供了设置待安装操作系统序列号和设置管理员用户密码的功能，这样做的目的是为了能
25
---
## Page 51
day
够完成自动化操作系统安装，不需要人工干预。设置完毕后，单击“Next”按钮，进入下一步
安
设置，如图1.3.17所示。
全
[区]
：
软件漏
  a 
What name would you lke to use for this virtual machine?
洞
ordre 'D boterrens
分析
C:Documents and Settingsladministrator(yMey DocumontsyMty Wirt|Browse
技
The dofok locaton can be hangod at Edt>Preferonces
术
（第
2
版
p
图1.3.17设置虚拟机操作系统保存路径
图1.3.17将设置虚拟机操作系统的文件保存位置以及新虚拟机的名字，此时要注意选择的
虚拟机文件保存位置一定要有足够的硬盘空间，根据所安装的操作系统不一样，VMware虚拟
机需要的保存空间也不一样，对于像WindowsXPProfessional这样的系统来说保存空间最好保
持在40GB大小。对于新虚拟机名则可以不做修改，单击“Next”按钮，如图1.3.18所示。
New Virtual Machine Wizard
[×
Specify Disk Capacity
How large do you want this dsk to be?
Mamm dkse（GB)40.0