the adversary’s capability, we add a 80 kHz sinusoidal wave with a
20 V peak-to-peak voltage on the adversarial coil, and we observe
that the primary coil voltage is increased up to 3 V, which is much
greater than 200 mV. By switching off the signal, the primary coil
voltage returns to its original level. Thus, to inject manipulated Qi
Glass Table0.4 cmOak Table2.4 cmFiltered waveform on an oak tableFiltered Waveform on an Oak TableFiltered Waveform on a Glass Table01110000000110011100000001Adversarial CoilAdversarial CoilWireless ChargerWireless ChargerSmartphoneSignalGeneratorAdversarial CoilAdversarial CoilOscilloscopeWireless ChargerWireless ChargerSmartphoneInjected “0101” Signal001Primary Coil Voltage1Normal Qi MessageRectified VoltageRectified VoltagePrimary Coil VoltageEnd of  SignalNormal Qi Message921Security and Privacy Vulnerability Analysis of Qi Wireless Charging
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
(a) Experimental setup
(b) Upward view
(a) Receiving a SMS msg.
(b) Receiving a Wechat msg.
Figure 9: Experimental setup for eavesdropping attack: the
adversarial coil is stuck underneath the table.
messages, the adversary can follow the bi-phase encoding mecha-
nism to regulate the voltage of the adversarial coil (i.e., switching
between LOW and HIGH states): When the signal is added on the
adversarial coil, it’s a LOW to HIGH switch, while it’s a HIGH to
LOW switch when it’s removed from the adversarial coil. Figure 8
shows the primary coil voltage and rectified voltage when we inject
“0101" signals in intervals into the normal Qi messages. Note that the
rectified voltage is measured using the test point provided by the
wireless charger board, which can better visualize pre-demodulated
Qi messages to verify whether the signal is successfully injected.
We can observe the bi-phase encoded “0101" signal (the following
High voltage represents the end of the injected bit sequence that
was intentionally added by us) from the rectified coil voltage clearly,
which confirms our hypothesis that the adversary can inject any
malicious communication packets to control the charging process
by just using a tiny adversarial coil.
5.2 Eavesdropping via Inductive Voltage
Our attack is built on the hypothesis that the inductive voltage of
a nearby hidden adversarial coil and its derived Qi Control Error
messages carry rich information of the phone activities while being
charged. This is because when an activity is triggered while charg-
ing, the battery will charge at a slower rate than inactive to allow
enough power for the ongoing usage [38]. As a consequence, the
charging device will adjust its desired operating point and further
transmit corresponding Control Error messages to the charger to ad-
just the transmit power density. Different activities usually rely on
different sets of hardware modules, thus they have different initial
power consumptions while being triggered. This would cause the
charging device to skew from the operating point at different scales,
leading to an identifiable pattern on the control error sequences
as well as the inductive voltage. We experimentally validate our
hypothesis by addressing the following questions: (1) Does the oc-
currence of an activity have an impact on the control error sequence
& the nearby hidden coil’s inductive voltage? (2) Do different kinds
of activities (i.e., receiving a phone call, a notification message, and
manually turning on the screen by the user) generate unique pat-
terns on the control error values and the inductive voltage? (3) For
the same kind of activity, do different apps (e.g., receiving a SMS
message or a WeChat message) still have distinguishable patterns?
The experimental setup is shown in Figure 9. Specifically, we use
the EVALSTWBC-EP board [31] (Figure 5(a)) and a smartphone (i.e.,
LG G7) as the wireless charger and charging device, respectively.
The adversarial coil is hidden underneath the surface on which the
Figure 10: Examples of the control error sequences with dif-
ferent activities.
(a) Manually turn on. vs. cellular phone
call
(b) Cellular phone call. vs. WhatsApp
phone call
Figure 11: Normalized moving abs-mean voltage of the cap-
tured adversarial coil among different activities & apps.
charger is placed. The coil is connected to the probe of a Tektronix
TBS2102 digital oscilloscope, which serves as the data logging back-
end. The surface is a wooden table which has a thickness of 3.2
cm. Figure 10 shows the extracted control error sequences and its
moving variance when the smartphone receives a SMS message
and a WeChat message respectively, while being charged. As these
activities trigger various actions on the smartphone (e.g., turning
on the screen, popping up a notification, and running necessary
background services), we observe that the values of the control
error messages, which are for power density adjustment, change
greatly while the moving variance is approximately zero when there
is no activity. In addition, we find that the received control error
sequence exhibits different patterns of these two activities, which
confirms that control error messages carry information that can be
used to distinguish different phone activities. To further verify the
distinguishability of the inductive voltage on the adversarial coil
during phone activities, we measure the inductive voltage while the
smartphone receives a cellular phone call, a WhatsApp phone call,
and is unlocked manually (twice for each activity) as shown in Fig-
ure 11. To better visualize the voltage pattern, we perform Z-score
normalization [22] on the measured voltage. We can see the voltage
curves of the same activity have a very similar pattern, while the
curves of different activities exhibit distinguishable patterns.
To further confirm our hypothesis, we collect the inductive volt-
age on the adversarial coil and the decoded control error sequences
when the smartphone (i.e., LG G7) is triggered by (1) three types
of activities: receiving a cellular phone call, a SMS message, and
manually turning on the screen (50 times for each activity); and
SmartphoneHidden Adversarial CoilWireless ChargerSmartphoneHidden Adversarial CoilSmartphoneHidden Adversarial CoilWireless ChargerSmartphoneHidden Adversarial CoilControl ErrorMoving VarianceControl ErrorMoving VarianceActivity StartsActivity EndsActivity StartsActivity EndsControl ErrorMoving VarianceControl ErrorMoving VarianceActivity StartsActivity EndsActivity StartsActivity EndsManually Turn OnCellular Phone CallWhatsApp Phone CallCellular Phone CallManually Turn OnCellular Phone CallWhatsApp Phone CallCellular Phone Call922ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Yi Wu, Zhuohang Li, Nicholas Van Nostrand, and Jian Liu
(a) Three types of activities
(b) Three types of phone calls
Figure 12: Illustration of the extracted features of inductive
coil voltage and control error sequence to distinguish differ-
ent activities.
(2) three apps of the same activity (i.e., receiving phone calls): cellu-
lar phone call, WeChat phone call, and WhatsApp phone call (50
times for each activity). We then extract 14 time-domain features
(i.e., length, minium, maximum, median, variance, std, abs-mean,
cv, skewness, kurtosis, first quartiles, second quartiles, third quar-
tiles, inter quartile-range) from both the voltage signal and the
decoded control error sequence on each activity segment (using
the segmentation method introduced in Section 7.1). We also calcu-
late the FFT of the voltage signal for each segment and divide the
frequency range into 100 equal-size frequency bins. The average
amplitude in each bin is used, resulting in a total of 100 frequency-
domain features. We apply linear discriminant analysis (LDA) [12]
for dimensionality reduction and plot the extracted features in a
2-dimensional domain as shown in Figure 12. We observe that differ-
ent activities and apps can be easily distinguished and the collected
samples of each activity are densely clustered. These findings have
addressed the three questions we raised and validate the hypothesis
of our proposed attacks.
6 ATTACK DESIGN AND EVALUATION:
HIJACKING VIA ADVERSARIAL MESSAGE
INJECTION
6.1 Malicious Qi Packet Generation
As described in Section 5.1, through the stealthy placement of an
adversarial coil, the adversary is capable of injecting manipulated
Qi messages. To achieve this, we generate the following two types
of Qi messages: (1) End Power Transfer (EPT) Packet: After the EPT
packet has been received, the charger will terminate the power
transfer immediately. To be specific, the EPT packet has a header
value of 2, and the data in the message byte indicates the reason
for the power transfer end (e.g., overheating, logic error, battery
failure). (2) Control Error Packet: The control error packet carries the
information about the difference between the charging device’s de-
sired transmit power density and the actual density. This is used by
the charger to adaptively control its power transfer. The adversary
thus can manipulate the values of control error messages to control
the power transfer. A positive control error value indicates that
an increase in transmit power density will be triggered and vice
versa. By controlling the power transfer, the adversary can cause
overcharging or undercharging, leading to a reduction in charging
Figure 13: Terminate charging process via injecting end
power transfer packets.
efficiency and significant damage to the battery (e.g., overheating,
reducing battery life, or even an explosion).
6.2 Experimental Methodology
The experimental setup is similar to the setup shown in Figure 7. An
ultra thin adversarial coil (i.e., 0.7 mm) [10] is placed between the
charger and the charging device (i.e., a smartphone), with the alter-
nating signal being generated by a wave generator. We validate our
attack under three scenarios in order to terminate the charging pro-
cess, reduce charging efficiency and transfer excess power (causing
overheating, battery life reduction, or even an explosion). The ex-
periments are conducted using 5 different commodity smartphones
(i.e., Samsung Galaxy Note 5, Samsung Galaxy S7, LG G7, Google
Pixel 3, and iPhone 8) and two chargers (i.e., an EVALSTWBC-EP
board [31] and a commercial Yootech charger [2], which has more
than 106,034 customer ratings on Amazon by May, 2021). Our attack
has been successful on attacking all these devices. To illustrate the
attack’s success, we use the experiment with an EVALSTWBC-EP
charger [31] due to its convenience for monitoring the charging
process and a Samsung Galaxy Note 5 as an example in the rest of
this section.
6.3 Attack Effectiveness
Charging Process Termination. In order to terminate the charg-
ing process, the adversary can modulate an EPT packet in the
communication channel with an arbitrary value in the message
byte. In our experiment, we set the value to 3, which indicates
the charging device is overheating (but actually not). As shown
in Figure 13, as soon as the malicious EPT packet is injected, the
charging process is terminated instantly (i.e., in 0.05 seconds). If
an end power event occurs, both the power transmitter and the
receiver will move back to the selection phase, trying to restart
the power transfer again. Therefore, in order to stop the charging
process permanently, the adversary has to continuously (repeat-
edly) inject EPT packets, in turn generating an inductive voltage
on the primary coil, as shown in Figure 13, and disturbing the ACK
signal sent to the power receiver to make the charging process
unable to restart. Our experiment validates the effectiveness of this
type of attack, which can make wireless chargers stop working and
cause great inconvenience to their users. Additionally, although
we show the feasibility of such denial-of-service (DOS) attack in
Qi wireless charging, we believe this threat could be extended to
other wireless-charging-enabled devices as well, making the device
incapable of operating, such as an EV failing to start, or cause a
wireless cardiac pacemaker to stop working.
Charging Efficiency Reduction. To reduce charging efficiency,
the adversary can flood a bunch of manipulated control error packets
WhatsApp Phone CallWeChat Phone CallSMS MessageCellular Phone CallCellular Phone CallManually Turn OnsWhatsApp Phone CallWeChat Phone CallSMS MessageCellular Phone CallCellular Phone CallManually Turn OnsInjected End Power PacketInjected End Power PacketCharging TerminatedCharging TerminatedInductive VoltageInductive Voltage923Security and Privacy Vulnerability Analysis of Qi Wireless Charging
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
charging device will send an EPT packet to the charger to request
“stop charging” if it is overheating, however such a packet will be
dropped under this attack due to the collision with the continuously
injected malicious control error packets. During the experiment, we
could obviously feel the excessive heat of the smartphone and even
heard an electric hum when the primary voltage was increased
to 25 V. Due to safety concerns, each round of experiments was
only performed for a short time, yet we successfully demonstrated
the attack’s potential to make the charger transfer excess power
through the manipulated Control Error packets. Existing studies
have empirically demonstrated the serious consequences in more
safety-controlled lab environments when the battery undergoes
overcharging. For instance, when a lithium-ion battery keeps being
overcharged, thermal runaway would ensue, inducing the battery
to vent with smoke, fire, or an explosion [8, 11, 13, 20]. All these
results show that this type of attack poses a very serious threat
to public safety, and we believe that the potential threat may be
more serious in other wireless charging systems, such as medical
implants, electrical vehicles, etc.
7 ATTACK DESIGN AND EVALUATION:
EAVESDROPPING VIA INDUCTIVE COIL
VOLTAGE
7.1 Activity Detection & Segmentation
As mentioned in Section 5.2, when an activity is triggered on the
phone, the values of the transmitted control error messages will be
changed accordingly. To detect and segment the initialized control
error pattern associated with each activity, we first apply a sliding
window on the control error sequence and calculate the variance
of each window. The window length is set to 5 as the receiving rate
of Qi messages is approximately 6-7 packets per second. Similar to
Equation 2, we detect the start time and end time of each segment
using two pre-defined thresholds (i.e., minimum and maximum
segment lengths). We empirically set these two thresholds to 1
second and 4 seconds, which can filter out most of the unexpected
instantaneous fluctuations on the control error when there is no
activity occurred. Moreover, after a period of inactivity, the screen
of the smartphone will automatically turn off, which also leads to
some fluctuations on the control error. However, compared with
the segment when an activity is triggered, the sum of control error
values is always a negative value, while we find that the segment as-
sociated with the screen turned off is a positive value. We therefore
restrict that the sum of all the control error values in an activity
segment has to be a negative value.
7.2 Activity Classification
Time-frequency Feature Extraction. Once we have obtained
each activity segment, we need to extract its representative feature
set. To be specific, we use time-frequency domain features con-
sisting of 14 statistical time-domain features (i.e., length, minium,
maximum, median, variance, std, abs-mean, cv, skewness, kurtosis,
first quartiles, second quartiles, third quartiles, inter quartile-range)
extracted from both the control error sequence and the adversar-
ial coil voltage. Frequency domain features are calculated using
the Fast Fourier Transform (FFT) on the adversarial coil voltage of
each segment. We divide the frequency range into 100 equal-size
(a) Charging efficiency reduction
(b) Excess power transfer
Figure 14: Injecting malicious Qi control error messages to
take control of the wireless charging.
with a negative value in the communication channel. Since these
fake packets will cause an unexpected primary coil voltage, the
receiver will try to make the voltage back to normal via sending
legitimate control error messages. To prevent the charging sys-
tem from completing self-calibration and to take full control of the
charging process, we inject the malicious Qi messages at a nearly
maximum frequency (i.e., approximately 40 packets per second, as
each packet lasts for around 25 ms), which is much higher than
legitimate Qi communication (i.e., 6-7 messages per second). This
ensures each legitimate Qi packet may have an overlap with our
injected packets, which can break the integrity of the legitimate Qi
packets so as to make them lose effectiveness.
Figure 14(a) shows the experimental result of injecting a set of
control error packets with a value of -10 in the communication
channel. We can clearly observe that, during the normal power
transfer phase (before injecting malicious Qi packets), the primary
coil voltage is maintained at a very stable stage with all the control
errors equal to 0. However, after we start injecting malicious pack-
ets, the demodulated control errors become −10 and the primary
coil voltage starts to linearly decrease and is reduced to only half of
its original amplitude within 2 seconds. Some of the peaks during
the decrease are caused by the alternating signal of the adversarial
coil, as the signal itself also has an impact on the amplitude, but
it won’t influence the overall trend. This example validates the
effectiveness of the injected malicious Qi messages, significantly
reducing the charging efficiency. In other words, the adversary can
control the charger and transmit any amount of power they want,
such as transmitting a very low amount of power per cycle. Outside
of increasing the amount of time it takes to charge a device, existing
studies [15, 17] demonstrate that undercharging can damage the
chemical properties of the battery and shorten the life of battery
cells.
Excess Power Transfer. To transfer excess power, we periodi-
cally inject malicious control error packets with a positive value in
the communication channel. Similarly, we inject these malicious
packets at a high frequency (i.e., approximately 40 packets per
second). For safety concerns, we set the value of the control error
messages to a relatively small number (i.e., 6). With a larger value of
the control error messages, the transmit power density will increase
more quickly. As shown in Figure 14(b), after the malicious control
errors 6 starts being injected, the primary coil begins increasing and
can nearly reach twice its original peak-to-peak voltage within 2
seconds with all of the demodulated control errors from the charger
are equal to 6. In the normal operation of Qi wireless charging, the
Note5 -10 6Primary Coil VoltageControl Error SequenceOriginal Qi MessageInjected Qi MessageStart Injecting Control Error -10Start Injecting Control Error +6Primary Coil VoltageControl Error SequenceNote5 -10 6Primary Coil VoltageControl Error SequenceOriginal Qi MessageInjected Qi MessageStart Injecting Control Error -10Start Injecting Control Error +6Primary Coil VoltageControl Error Sequence924ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Yi Wu, Zhuohang Li, Nicholas Van Nostrand, and Jian Liu
frequency bins and use the average amplitudes in each bin as fre-
quency domain features. Therefore, we can obtain a total of 128