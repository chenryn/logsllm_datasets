were extracted. The largest fractions of category changes were
observed between personal/business ! free download, and news !
personal/business.
more often as landing pages for malicious QR codes. We were
particularly interested in finding QR attacks in which a web
category change could occur. We calculated this by analyzing
how many malicious QR codes are used to interconnect web
categories. We examined whether scanning a malicious QR
code extracted from a certain web category brings the victim
to a landing page in another web category resulting in an
outgoing category change during the course of an attack.
Figure 7 represents the outgoing web category changes
based on extracted malicious QR codes. Our analysis shows
that for 53% of malicious QR codes, the category of the
extracted URL differed from the category where the QR codes
were originally extracted. For each category, we calculated
the fraction of malicious QR codes that resulted in a category
change. The personal/business category, with approximately
14% category changes, interacted with all other categories.
We found some malicious QR codes posted by attackers in
websites where people typically share posts or links that
attempted to lure the readers visit download pages for certain
web resources hosted in the free download category.
Our analysis also shows that miscreants use QR codes in
distinct attack scenarios. In particular, we identified five main
attack strategies used by attackers. Malicious QR codes can be
designed to deliver malware, both for Windows and for mobile
platforms, via direct download links, or to direct victims to
phishing sites, intermediate sites, or exploit sites. We define
intermediate sites as those with known vulnerabilities that are
exploited by attackers to host malicious dynamic scripts. These
sites are typically used to redirect users to phishing or exploit
sites. Exploit sites are those that host exploit kits that are
designed to automatically detect and compromise vulnerable
applications on victim devices.
Fig. 8: Distribution of malicious QR codes across web categories. The
free download and personal/business categories hosted the highest
number of malicious QR codes. Phishing and exploits were the most
prevalent attack types overall.
In all scenarios that we encountered, attackers employed
QR codes to facilitate interactions with end users and abuse
trust in known brands or websites. In phishing scenarios, the
attackers leveraged QR codes to direct victims to fake versions
of popular websites requiring the input of authentication
credentials or payment information.
In the following, we provide more details on the types of
malicious QR codes that were designed to launch phishing
attacks or distribute malware.
B. Distributing Malware
1) Directing Users to Exploit or Intermediate Sites: Mis-
creants can deliver malware by directing users to exploit
or intermediate sites. Attackers can inject malicious codes
into intermediate websites to redirect the victim’s browser to
landing pages designed to initiate drive-by download attacks.
We classified malicious QR codes by identifying the types
of actions they were intended to perform after extracting
their corresponding URLs. In scenarios where extracted URLs
ended in htm, html, or php, we compared the URLs with our
archive of malicious URLs (Section III-A3). We employed
the original classification of the Malware Domain List which
determined the type of malicious activity that the URL was
designed to perform. We also performed manual inspection of
the identified websites to determine how they redirect requests
to exploit pages.
Figure 8 summarizes the attack scenarios that we observed
in the wild. Directing users to intermediate sites accounts for
8.8% of all the attacks. These websites were mainly observed
in the free download category. These websites provide a rich
source of opportunity for attackers since they can be compro-
mised to redirect traffic to exploit or phishing websites. The
extracted URLs were typically websites running outdated ver-
sions of WordPress or plugins with known vulnerabilities. The
198198198
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 08:28:03 UTC from IEEE Xplore.  Restrictions apply. 
Free DlGamesAdultMusicNewsPersonal/BizWeb Categories0246810121416Interconnection Through Malicious QR Codes(%)Free DLGamesAdultMusicNewsPersonal/BizFree DlGamesAdultsMusicNewsPersonal/BizWeb Categories051015202530Percentage of Malicious QR Codes(%)PhishingExploitIntermediateMobile-MalWin-Malattackers compromised these websites and typically injected
hidden iframes with obfuscated JavaScript that redirected the
user to an exploit site (Figure 9). When a user visits such a web
page, the malicious code included in the page silently redirects
the browser to the exploit site. The malicious code is silently
loaded into the victim’s device, giving the attacker a foothold
on the victim’s system. We also identified three malicious QR
codes that used intermediate websites to redirect victims to
phishing sites.
Our results show that some attack strategies are more preva-
lent than others, in particular that miscreants mainly redirect
users to phishing sites and exploit sites in QR code attacks.
As depicted in Figure 8, while these two attack strategies are
common in all categories, they mainly occur within the free
download and personal/business categories rather than being
uniformly distributed amongst all categories. We found that
32% of total QR codes directed users to exploit websites.
We observed that the lifetime of this class of malicious QR
codes was very short, and the corresponding URLs failed to be
resolved after a short period of time. Only five of the extracted
URLs were successfully resolved at
the time of writing.
Although the identified QR codes in this category were unique
and contained different domain names, they all resolved to two
IP addresses. This dynamic address generation characteristic
can be considered as a strategy to prevent automatic systems
from downloading exploits, and we hypothesize that they are
part of the same malware campaign.
In a typical scenario, the web request to the site is directed
to attack.php that serves up the payload containing the
exploit kits. The page is valid only once and refuses incoming
connections when a unique user sends multiple requests to
visit the site in order to avoid multiple downloads of the
malware being served. This makes downloading the malware
for analysis more difficult as the malicious code cannot be
obtained from a known malicious URL or one that has been
visited twice. Figure 8 also provides an approximate view of
the types of QR codes attacks that are more likely to occur in
each web category.
We also identified some interest in distributing Windows
malware. Our analysis shows that about 66% of Windows
malware spread via QR codes was found again in the free
download and personal/business categories.
We investigated whether the relationship between the attack
strategies and web categories is statistically significant by
again performing a chi-square test with (cid:11) = 0:05. The result
of the test confirmed that
the relationship between attack
strategies and web categories holds ((cid:31)2 = 52:6, df = 20,
p-value ");
1 if (document.getElementsByTagName('body')[0]) {
2
3 } else {
4
5
6
7
8
9 }
10
11 function iframer() {
12
13
14
15
16
17
18
19
20
21 }
var f = document.createElement('iframe');
f.setAttribute('src', 'http://exploit.com/links/column.php');
f.style.visibility = 'hidden';
f.style.position = 'absolute';
f.style.left = '0';
f.style.top = '0';
f.setAttribute('width', '10');
f.setAttribute('height', '10');
document.getElementsByTagName('body')[0].appendChild(f);
Fig. 9: A sample of malicious JavaScript code in an intermediate
website that includes a hidden iframe.
Fig. 10: Distribution of malicious web objects spread via QR codes
across different categories. Distributing malicious websites via QR
codes was observed as the top malicious activity across all categories.
(based on Kaspersky’s malware labels).
Figure 11 lists the malware families distributed via QR
codes. For each family, the number of samples and types of
web resources that delivered the samples are provided. We did
not observe a high diversity of malware families compared
to the number of files we acquired during our experiments.
However, it shows that QR codes are a possible attack vector
that
is used by some malware owners. We observed that
distributing malicious EXE files via QR codes turned out
to be more frequent than other malware types. As expected,
scanning a QR code found on a website that can potentially
redirect users to download a malicious EXE file requires
special social engineering techniques. One scenario that we ob-
served during our analysis was that the web page which hosted
the malicious QR code was used to download copyrighted
materials. The website attempted to trick unsophisticated users
by first requiring them to prove they were not automated
199199199
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 08:28:03 UTC from IEEE Xplore.  Restrictions apply. 
Free DlGamesAdultsMusicNewsPersonal/BizWeb Categories051015202530Percentage of Malicious Web Objects(%)APKEXEArchiveWebImagesPDFFig. 11: Malware families distributed via QR codes across different
web objects. Distributing malicious EXE files via QR codes turned
out to be significantly higher than other malware types. To download
copyrighted materials, victims had to scan malicious QR codes in
order to prove they were not automated machines.
machines by scanning the QR code to be able to download
the copyrighted materials. The victims had to resolve the QR
code to reach the download link. We also observed similar
scenarios where attackers tried to deliver malicious APK files
to victims.
As depicted in Figure 11, 50% of the identified mal-
ware samples distributed via QR codes belong to the
Trojan.Win32.Generic family that is primarily known for
injecting malware into clean processes (e.g., Explorer.exe). QR
codes were also used by the Trojan.Win32.FakeAV family
to distribute fake antivirus programs. Once installed, the trojan
prompts the victim to make a purchase from sites under the
control of the attacker. We also found a few malicious QR
codes that delivered the Trojan-SMS.AndroidOS.FakeInst
family that is mainly used to send SMSs to premium rate
numbers without the owner’s knowledge or consent.
C. Phishing
1) Fake Business Websites: Fake business websites are
categorized as a special type of phishing attack that can also
be used to distribute malware. We identified 11 malicious QR
codes that led users to fake versions of Google Play that of-
fered malicious Android apps. In four cases, the corresponding
URLs were designed to impersonate Google Play by prefixing
the legitimate name at the beginning of the URLs, and by
being long enough to prevent displaying the full URL on
smartphone browsers.
Figure 12a presents a website from the free downloads
category that we observed in our experiments. The website
hosted a malicious QR code that contained a spoofed Google
Play URL. This type of attack can be considered as a strategy
to increase the chances of distributing malware or trojanised
versions of popular apps by directly targeting unsophisticated
users rather than compromising vulnerable websites.
(a) A real-world malicious QR code that encourages users to
download an app from a fake Google Play site.
(b) A typical scenario abusing “liking” a page. A user first scans
the QR code which redirects his browser to a fake Facebook
page. If the user likes it, the browser is redirected to a fake
login page to enter his credentials.
Fig. 12: Examples of QR code-based attack scenarios.
2) Fake Password-protected or Payment-related Websites:
37 QR codes redirected users to fake password-protected or
payment-related websites aimed at obtaining user credentials
or payment information. In these scenarios, attackers launch
attacks by mimicking the appearance and behavior of le-
gitimate sites. Consequently,
inattentive users will not be
suspicious when they are requested to enter their password.
Facebook was identified as one of the most abused brands for
phishing attacks among the attacks we observed. In particular,
linking users to fake versions of Facebook accounts for 48%
of total phishing attacks.
In order to launch a phishing attack, attackers typically
encourage victims to like a page on Facebook via a QR
code and invoke a fake Facebook web page that requests
200200200
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 08:28:03 UTC from IEEE Xplore.  Restrictions apply. 
APKZIPPDFJPEGEXEWeb Objects01020304050607080Percentage of Malware FamiliesTrojan-SMS.AndroidOS.FakeInstBackdoor.AndroidOS.KungFuAdware.Win32.DownloadwareTrojan.Win32.FakeAVTrojan.Win32.FakeAVUser scans the QR code to visit http://mfacebookcom.site88.net/PopSugar12TLD
com
net
org
biz
ru
br
info
Others
Incidence
61
17
11
9
19
13
2
13
Percentage
42.1
11.7
7.60
6.21
13.1
8.96
1.38
8.97
Country Code
US
Russia
Netherlands
China
Brazil
Germany
France
Vietnam
Incidence
49
21
19
16
14
12
10
4
Percentage
33.8
14.9
13.1
11.0
9.66
8.28
6.90
2.76
TABLE VI: Top seven TLDs and countries originating QR code attacks. US websites hosted 33% of malicious QR codes in our experiments.
In line with other malware measurement studies, we speculate that the disproportionately large US presence is due to the attacker’s reliance
on its relatively robust Internet infrastructure.
users to enter their password. Figure 12b shows a typical
scenario where users are encouraged to “like” a page on a
fake Facebook page reached from a QR code and, in a second
step, are required to enter their credentials.
Our system recognized seven malicious QR codes in this