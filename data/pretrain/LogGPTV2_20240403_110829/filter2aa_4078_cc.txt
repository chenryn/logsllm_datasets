信任才能开始使用该系统。 随后， 接受他们的关于额外用户 有效性的判断， 扩展开来， 你要信任来
自 初始信任判断的多级用户的 " Web"。
PGP 在广泛使用的最初遇到很多障碍。 最困难的障碍是美国政府的出 口 法令， 它将加密技术视
为军需品， 并且禁止向美国 以外的国家出 口 强加密技术。 幸运的是， 这项限制后来被取消了， 并且
PGP 可以 自 由地出 口 到大多数国家。
PGP有两个可用的版本。 商业版本使用RSAJ挂行密钥交换， 使用IDEAJ挂行加密/解密， 使用扎在D5
生成消息摘要。 免费版本则使用Diffie-Helhnan密钥交换、 Carlisle Adams/Stafford Tavares(CAST)1 28
位的加密/解密算法 以及SHA- 1散列函数。
许多商业机构也提供基于 PGP 的 电子邮件服务作为基于 Web 的云端邮件服务、 移动设备应用
程序或 Web 邮件插件。 这些服务通过可管理的邮件安全服务消除了复杂的加密证书配置和维护， 并
以此吸引 了 管理员和最终用户。 这一类 中的产品包括 S阳削ail、 Mai1velope、 SafeGmail 和 Hushmail。
2. S/MIME
安全多用途互联网邮件扩展(Secure Multipurpose Intemet Mail Extensions， S岛也伍)协议很可能
成为未来电子邮件加密工作的标准。 S岛也伍使用 RSA 加密算法， 并且己经得到包括 RSA 安全公
司在内 的业界主要机构的 支持 。 S/MIME 己经被合并到大量的商业产品中， 这些产品包括:
• Microsoft Outlook 丰日 Outlook Web Access
• Mozilla Thunderbird
• Mac OS X Mail
S瓜但h在E 依靠 X.509 证书交换密码系统密钥。 这些证书包含的公钥被用于数字签名和较长通信
会话中使用的对称密钥交换。 邸A 是 SIMIME支持的唯一一个公钥密码学协议， 这个协议支持 AES
和 3DES 对称加密算法。
尽管对 S岛也伍标准有强有力的产业支撑， 但技术的局限性阻碍了 它的广泛应用 。 虽然主要的
桌面邮件应用程序均支持 S岛皿在E 电子邮件， 但主流的基于 Web 的电子邮件系统不支持它(因为需
要扩展浏览器的使用)。
7.5.3 Web 应用
加密被广泛用于保护 Web 传输， 其主要原因在于电子商务发展的趋势以及电子商务供应商和用
户对通过 Web 安全交换财务信息。口信用 卡信息)的强烈愿望。 接下来， 我们将会介绍两种在 Web 浏
览器底部显示小锁图标的技术: 安全套接字(SSL)和安全传输层(TLS)协议。
第 7 章 PKI 和密码学应用
SSL 协议由 Netscape 公司开发， 提供对客户布ν服务器之间的网站流量进行加密的服务。 安全套
接宇层上的超文本传输协议但πPS)使用 443 端口在 Web 服务器和客户端浏览器之间协商加密通信
会话。 虽然 SSL 最初是 Netscape 为其浏览器开发的标准， 但是后来微软将其吸收并使其成为 Intemet
Exp10r巳r 浏览器的安全标准。 SSL 协议与这些产品 的集成使它成为事实上的 国 际标准。
SSL 依赖在浏览器与 Web 服务器之间交换数字证书以协商加密/解密参数。 SSL 协议的 目 标是
建立安全的通信通道， 使整个 Web 浏览器会话保持开放。 它取决于对称和非对称加密的组合。 具体
过程涉及 以下步骤:
(1) 当用户访问一个网站时， 浏览器检索 W出 服务器的证书， 并从中提取服务器的公共密钥。
(2) 然后， 浏览器创建一个随机的对称密钥， 使用服务器的公钥来加密， 然后将加密的对称密
钥 发送到服务器上。
(3) 随后， 服务器使用 自 己的私钥解密对称密钥， 这两个系统使用对称加密密钥来交换未来的
交 互信息。
这种方法允许 SSL 利用非对称加密技术的先进功能， 在大多数数据交换的加密和解密中使用 更
快 的对称算法。
1 999 年 ， 安全工程师在发布 SSL 第三版时 ， 提出 了 将 TLS 作为 SSL 标准的替换。 与 SSL 一样，
TLS 使用 TCP 端 口 443。基于 SSL 技术， TLS 包含了 许多安全增强功能并最终被大多数应用所采用 ，
替代了 SSL。 早期版本的 TLS 在通信双方都不支持 TLS 时可以降级支持 SSL V3.0。 然而， 在 2011
年 TLS v1.2 不再支持向 后兼容性。
20 14 年 ， 被称为 " 贵宾犬" (POODLE)的攻击表明在 TLS 的 SSL 3.0 反馈机制中存在重大缺陷。
为 了修复这个漏洞 ， 很多机构完全放弃对 SSL 的支持， 并且现在唯 一依靠 TLS 的 安全性。
提示 :
尽管 TLS 已经存在 了 1 0 多 年， 许多人仍将其误称为 SSL. 由 于这个原 因 ， TLS 也获得了 SSL 3.l
的 昵称。
隐写术和水印
隐写术(steganography)是使用密码学技术在另 一条消息内嵌入秘密泊'息的方法。这种算法是通过
修改组成图像文件的数据中最不重要的数据位进行工作的。 变化非常微小， 以至于对图像的浏览没
有明显的影响。 这种技术允许通信双方以简单的方式隐藏消息， 例如在其他人毫无察觉的情况下，
在 Web 页面的插图里嵌入秘密的消息。
隐写术通常在图像或 WAV 文件内 嵌入秘密消息。 这些文件往往很大 ， 因此即使最认真的检查
人员也难 以发现秘密的消息。 隐写术通常用于非法或可疑活动 ， 例如商业间谍和儿童色情 。
然而隐写术也能用于合法用途。 将数字水印加入到文档中 ， 以保护知识产权就是通过隐写术完
成的。 只 有文件的创建者知道隐藏的信息。 如果有人创建了 内容的非法拷贝， 水印就可以用来检测
拷 贝并且(如通过独特的水印文件提供给原始收件人)跟踪拷贝来源 。
隐写术是一个非常简单的技术， 可 以使用 网上公开免费的工具。 图 7.2 显示了一个这样的工具
一一iSteg。 只 需要指定一个包含秘密信息的文本文件和希望用来隐藏信息的图像文件。 图 7.3 显示
了 一张嵌入了秘密消息的图片， 该 消息是不可能用人眼检测到的。
1 73
CISSP 官方学习指南(第 7 版)
000 iSteg
pa臼word: ( Sasd77zn#as 飞 1 + 1
@I 弘ωde:
sωm 阳u川le: ( IUsers/r峭的apple/Piclur()已匕j
SoUla Text File: (f叫mìkech
JPEC Output Q时ality:
Max Keys:
Iterator S曹ed lImit:
95
Oefau1t Oefault
Oefault Oefault
Enor CoI'J时tlor在
街时elVe St就Istlu
fxtellded Feedback
V hanyn叽佣附 --
n
mMM
m
h g
m jj
n白血， 、{}
m
吨，. 、EJ
V 1.6.1
图 7.2 隐写术工具
图 7.3 嵌入了秘密消息的图像
7.5.4 数字版权管理(DRM)
数字版权管理(Digital Rights Management， DR岛。软件使用加密来加强对数字媒体版权的限制 。
在过去 1 0 年中 ， 出版商试图在各种媒体类型， 包括音乐、 电影和书籍中部署 D邸4 方案。 在许多情
况下， 尤其是音乐 ， 反对者遇到 DRM 部署都会激烈反对， 并认为 DRM 的使用侵犯了他们 自 由地
享受合法授权媒体文件和制作备份的权利 。
1 74
第 7 章 PKI 和密码学应用
注意 :
在你学习这些 内容时， 许多 商业机构正试图部署基本上普遍失败的 DRM， 因 为用 户 拒绝该技
术并把它看成一种入侵和/或 阻塞。
1 . 音乐 DRM
多年来音乐界一直在与盗版斗争， 时间可以追溯到 自制的磁带拷贝、 压缩光盘和数字格式的 日
子 。 音乐发行公司试 图利用各种 DRM 方案， 但在消 费者 的压 力下 ， 大 多数技术都取消 了 。
对于使用 D邸f 技术的音乐作品销量急剧下降这种情况， 苹果公司收回了他们通过 iTlll1es 商店
出售的使用 FairPlay DRM 的音乐作品 。 苹果联合创始人史蒂夫 · 乔布斯的这一举动为后面的事情埋
下 了伏笔。 2007 年， 他发表了 一封公开信， 呼吁音乐公司允许苹果公司销售免费的 DRM音乐作品。
那封信的部分内容如下:
第三个选择就是完全地废弃 D邸4 技术。 想象一下， 世界上的每个在线商店销售 着开放格式编
码的免 费 DRM 音乐 。 在这样一个世界里， 任何使用 者能够播放从任何商店 购 买 的音乐， 任何商店
都 出 售可以在任何播放器上播放的音乐。 这显然是消 费者最好的选择， 苹果公司 会在 内 心拥抱这一
时代。 如果 4 大唱 片 公司 投权苹果公司 他们的不受 D邸4保护的音乐作品， 我们将在 iTlll1es 上只销
售免费 的 DRM 音乐。 每一个 iPod 将只 能播放这种免费的 DRM 音 乐 。
那封信 的 完整版在苹果公司 的网站上 己 经看不到 了 ， 不 过可 以从以下 网 址获得完整版:
http://bit.ly/l TyBm5e 。
目前， DRM在音乐中 的主要应用是对于基于订阅 的服务， 例如 Napster 和 Kazaa， 当用户订阅
期结束时 ， 用 DRM 取消用 户 访 问和下载音乐。
注意 :
对 DRM 技术的描述在这段文字 中似乎看起来有点模糊? 这里有一个原因: 厂 商通常不会透露
他们 DRM 功能的细节 ， 因 为 担心盗版者会利用 这些信息使 DRM 方案失效。
2. 电影 DRM
电影业多年来已经使用各种 DRM 方案来解决电影盗版的全球性问题。 用 于保护大众传播媒体
的 主要技术有 以下两种:
内容混乱系统(Content Scrambling System， CSS) 限制 DVD 的 回放以及对使用 区域的限制。
这种加密方案是用一个叫作 DeCSS 的工具， 在 Linux 系统中 启 用 CSS 来保护内容的回放。
高级内容访问系统(Advanced Access Content System， AACS) 保护存储在蓝光HD DVD 上