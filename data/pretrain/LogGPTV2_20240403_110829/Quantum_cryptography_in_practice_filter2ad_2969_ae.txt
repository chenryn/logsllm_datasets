fiber  while  others  are  freespace.  Thus  in  theory  such  a 
network  could  provide  fully  global  coverage.  Second,  they 
lessen  the  chance  that  an  adversary  could  disable  the  key 
distribution  process,  whether  by  active  eavesdropping  or 
simply by cutting a fiber. A QKD network can be engineered 
with as much redundancy as desired simply by adding more 
links  and  relays  to  the  mesh.  Third,  QKD  networks  can 
greatly  reduce  the  cost  of  large-scale  interconnectivity  of 
private enclaves by reducing the required (N x N-1) / 2 point-
to-point links to as few as N links in the case of a simple star 
topology for the key distribution network. 
Such  QKD  networks  do  have  drawbacks,  however.  Their 
prime  weakness  is  that  the  relays  must  be  trusted.  Since 
keying material and – directly or indirectly – message traffic 
are available in the clear in the relays’ memories, these relays 
must not  fall into an  adversary’s  hands. They need to be in 
physically secured locations and perhaps guarded if the traffic 
is  truly  important.  In  addition,  all  users  in  the  system  must 
trust the network (and the network’s operators) with all keys 
to their message traffic. Thus a pair of users with unusually 
sensitive traffic  must expand the circle of those  who can be 
privy to it to include all machines, and probably all operators, 
of the QKD network used to transport keys for this sensitive 
traffic. 
As in classical cryptography, an end-to-end approach is likely 
to provide the most satisfactory architecture for disentangling 
the users’ keying material for secured traffic flows from the 
network  that  transports  such  flows.  Hence  we  are  building 
unamplified  photonic  switches  into  our  QKD  network 
architecture  in  order  to  provide  end-to-end  key  distribution 
via a novel mesh of untrusted switches.  
Untrusted QKD switches do not participate in QKD protocols 
at all. Instead they set up all-optical paths through the network 
mesh of fibers, switches, and endpoints. Thus a photon from 
its  source  QKD  endpoint  proceeds,  without  measurement, 
from switch to switch across the optical QKD network until it 
reaches the destination endpoint at which point it is detected. 
We  currently  anticipate that the QKD switches  will be built 
from  MEMS  mirror  arrays,  or  equivalents,  together  with 
novel distributed protocols and algorithms that allow end-to-
end path setup across the network, and that (as in untrusted 
networks)  provide  a  robust  means  for  routing  around 
eavesdropping or failed links. 
Untrusted  QKD  networks  have  different  strengths  and 
weaknesses than trusted QKD networks. Their main strength 
is  that  support  truly  end-to-end  key  distribution;  QKD 
endpoints need not share any secrets with the key distribution 
network  or  its  operators.  This  feature  may  be  extremely 
important  for  highly  secure  networks.  Their  weaknesses 
appear  significant,  however.  Unlike  trusted  relays,  untrusted 
switches  cannot  extend  the  geographic  reach  of  a  QKD 
network. In fact, they may significantly reduce it since each 
switch  adds  at  least  a  fractional  dB  insertion  loss  along  the 
photonic  path.  In  addition,  it  will  also  prove  difficult  in 
practice to employ a variety of transmission media within an 
untrusted  network,  since  a  single  frequency  may  not  work 
well  along  a  composite  path  that  includes  both  fiber  and 
freespace links. Untrusted networks may also introduce new 
vulnerabilities to traffic analysis.  
Looking to the later years of the DARPA Quantum Network, 
the principal weakness in untrusted QKD networks – limited 
geographic  reach  –  may  perhaps  be  countered  by  quantum 
repeaters. There is now a great deal of active research aiming 
towards  such  repeaters,  and  if  practical  devices  are  ever 
achieved, they should slide neatly into the overall architecture 
of  untrusted  QKD  networks  to  enable  seamless  QKD 
operations  over  much  greater  distances 
than  currently 
feasible. 
theory 
photon 
9.  CONCLUSIONS 
The  DARPA  Quantum  Network  demonstrates  that  quantum 
cryptography  may  indeed  be  used,  in  practice,  to  provide 
continuous  key  distribution  for  Internet  virtual  private 
networks.  However  certain  critical  aspects  of  the  theory  of 
quantum cryptography are still very murky. These include the 
variety  of  possible  attacks  and 
the  detailed  quantum 
mechanical 
underlying 
production, 
propagation, detection, and so forth. In short, it is now clear 
that  quantum  cryptography  is  feasible  in  practice  –  but  the 
question  still  remains  as  to  whether  it’s  feasible  in  theory. 
Thus our network  manifestly  works, but it may not truly be 
secure! 
Accordingly, we believe that future work should proceed on 
two  tracks.  First,  detailed  security  analyses  must  be  carried 
out – ranging all the way from quantum mechanical analyses 
to more traditional network security analyses. Second,  work 
should proceed at full speed on building out the next portions 
of  the  network  –  its  next  kinds  of  QKD  links  (based  on 
entangled photon pairs), and its highly specialized switches.  
10. ACKNOWLEDGEMENTS 
We are deeply indebted to Dr. Mike Foster (DARPA) and Dr. 
Don Nicholson (Air Force Research Laboratory) who are the 
sponsor  and  agent,  respectively,  for  this  project.  This  paper 
reflects highly collaborative work within the project team. Of 
these,  particular  credit  is  due  to  Alexander  Sergienko  and 
Gregg  Jaeger  (Boston  University),  John  Myers  and  Tai  Wu 
(Harvard), and Alex Colvin, William Nelson, Oleksiy Pikalo, 
John Schlafer, and Henry  Yeh (BBN). Our interest in QKD 
networks was sparked by the prior work of, and discussions 
with, the quantum cryptography groups  at IBM Almaden and 
Los Alamos, and by the kind hospitality of Dr. David Murley 
several years ago. 
REFERENCES 
[1] 
C. Bennett and G. Brassard, “Quantum Cryptography: 
Public  Key  Distribution  and  Coin  Tossing,” 
International Conference on Computers, Systems, and 
Signal Processing, Bangalore, India, 1984. 
C. Bennett, F. Bessette, G. Brassard, L. Salvail, and J. 
Smolin,  “Experimental  quantum  cryptography,”  J. 
Cryptology, vol. 5, no. 1, 1992, pp. 3 – 28. 
[2] 
[3] 
[4] 
[5] 
[6] 
[7] 
[8] 
R.  Hughes  et  al,  “Quantum  cryptography  over 
underground  optical  fibers,”  in  N  Koblitz,  editor, 
Advances in Cryptology -- CRYPTO '96, volume 1109 
of  Lecture  Notes  in  Computer  Science,  pages  329-
342, 18-22 August 1996. Springer-Verlag. 
D. Stucki, N. Gisin, O. Guinnard, G. Ribordy and H. 
Zbinden, “Quantum key distribution over 67 km with 
a plug&play system,” New J. Phys. 4 (July 2002) 41. 
D.  Bethune  and  W.  Risk,  “Autocompensating 
quantum  cryptography,”  New  J.  Phys.  4  (July  2002) 
42. 
R. Hughes, J. Nordholt, D. Derkacs and C. Peterson, 
“Practical free-space quantum key distribution over 10 
km  in  daylight  and  at  night,”  New  J.  Phys.  4  (July 
2002) 43. 
J.  Rarity,  P.  Tapster,  P.  Gorman  and  P.  Knight, 
“Ground  to  satellite  secure  key  exchange  using 
quantum  cryptography,”  New  J.  Phys.  4  (October 
2002) 82. 
G. Ribordy, J. Brendel, J-D. Gautier, N. Gisin, and H. 
Zbinden, 
entanglement-based 
quantum  key  distribution,”  Phys.  Rev.  A,  v.  63, 
012309 (13 December 2000). 
“Long-distance 
[9]  W. Tittel, J. Brendel, H. Zbinden, and N. Gisin, Phys. 
Rev. Lett. 84, 4737 (2000). 
[10]  A.  Ekert,  “Quantum  Cryptography  Based  on  Bell’s 
Theorem,” Phys. Rev. Lett. 67, 661 (5 August 1991). 
[11]  C. Bennett, 1992, “Quantum cryptography using any 
two nonorthogonal states,” Phys. Rev. Lett. 68, 3121-
3124. 
J.  Franson,  “Bell  Inequality  for  Position  and  Time,” 
Phys. Rev. Lett., 62, 2205 (8 May 1989). 
[13]  G.  Brassard,  T.  Mor,  and  B.  Sanders,  “Quantum 
crypto-graphy  via  parametric  downconversion,” 
quant-ph/9906074. 
[14]   D. Naik, C. Peterson,  A.  White,  A. Berglund, and P. 
[12] 
Kwiat, Phys. Rev. Lett. 84, 4733 (2000). 
[15]  T. Jennewin, C. Simon, G. Weihs, H. Weinfurter, and 
A. Zeilinger, Phys. Rev. Lett. 84, 4729 (2000). 
[16]  D.  Enzer,  P.  Hadley,  R.  Hughes,  C.  Peterson  and P. 
quantum 
Kwiat, 
cryptography,” New J. Phys. 4 (July 2002) 45. 
“Entangled-photon 
six-state 
[17]  N.  Gisin  et  al,  “Quantum  cryptography,”  Rev.  Mod. 
Phys., Vol. 74, No. 1, January 2002. 
[18]  C.  Elliott,  “Building  the  quantum  network,”  New  J. 
Phys. 4 (July 2002) 46. 
[19]  G. Brassard and L. Salvail, “Secret key reconciliation 
by  public  discussion,”  Lect.  Notes  in  Computer 
Science 765, 410. (1994). 
[20]  M. Wegman and L. Carter, “New Hash Functions and 
their  Use  in  Authentication  and  Set  Equality,”  J. 
Comp. Sys. Sci., 22, 265-279 (1981). 
[21]  B.  Slutsky,  R.  Rao,  P.  Sun,  L.  Tancevski,  and  S. 
Fainman,  “Defense  frontier  analysis  of  quantum 
cryptographic  systems,”  Applied  Optics,  vol.  37,  no. 
14, 1998, pp. 2869 – 2878. 
QKD 
Sub-Function 
Authentication 
Specific Techniques in the 
DARPA Quantum Network 
Universal Hash Function 
[Not yet implemented] 
Hybrid Public Key / 
Universal Hash Function 
Estimation of 
Eve’s Knowledge 
Bennett Estimate 
Slutsky Estimate 
Resultant Entropy 
APPENDIX 
Description 
Preposition a “small” shared secret key at Alice and Bob, and use 
this key as input to a Universal Hash function along with the refined 
bits obtained by QKD protocols. Use the result as a cryptographic 
checksum to verify Alice or Bob’s identify. 
Combine  the  Universal  Hash  Function  approach  with  Public  Key 
Cryptography, i.e., digital signatures. While this approach does not 
satisfy  the  purist  quantum  cryptographic  community,  it  may  be  a 
good engineering approach for communities that believe that public 
key techniques are still useful. 
4e
2
e)224( +
. See Bennet et al [1] 
, std. deviation 
+
2
2
=
t
)
1
′−
e
′−
e
log
(
−
eb
)0,31max(
11
−
2
 See Slutsky et al  [21] 
For both Bennett and Slutsky estimates: 
+
rb
scbmnmt
−−−−
,
−
d
−
1
1
2
=
s
b
   where
+=′
e
e
b
c
b
bmnm
2
1
+
2
Privacy 
Amplification 
Universal Hash Function 
based on Rényi Entropy 
Error Correction 
Parity Checks 
Cascade 
Sifting 
Run-Length Encoding 
Use  a  hash  function  to  reduce  the  size  of  a  batch  of  error-
corrected,  shared  secret  bits  by  an  amount  sufficient  to  reduce 
Eve’s  possible  knowledge  of  the  resultant  bits’  contents  to  a 
sufficiently small amount (e.g. far less than 1 bit’s worth). 
A  conventional  parity-checking  scheme  as  widely  employed  in 
telecommunications systems. 
Select  random  subsets  of  the  sifted  bits,  compute  and  exchange 
parity bits on a subset to detect errors, and then use a divide-and-
conquer scheme to correct any detected errors.  
Encode  the  sifting  messages,  as  sent  between  Bob  and  Alice, 
efficiently so that runs of identical values (and in particular of “no 
detection” values) are compressed to take very little space.