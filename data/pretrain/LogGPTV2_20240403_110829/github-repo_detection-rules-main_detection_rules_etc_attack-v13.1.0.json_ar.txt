{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about network connections, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1049", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1049"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2021-08-23T20:25:18.609Z", "name": "System Network Connections Discovery Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Limit privileges of user accounts so only authorized users can edit the rc.common file.", "external_references": [{"external_id": "T1163", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1163"}], "id": "course-of-", "modified": "2019-07-25T11:29:48.385Z", "name": "Rc.common Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized users can create scheduled jobs. Identify and block unnecessary system utilities or potentially malicious software that may be used to schedule jobs using whitelisting tools.", "external_references": [{"external_id": "T1168", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1168"}], "id": "course-of-", "modified": "2019-08-17T12:10:09.748Z", "name": "Local Job Scheduling Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2019-02-01T14:35:39.565Z", "created_by_ref": "", "description": "This technique likely should not be mitigated with preventative controls because it may protect unintended targets from being compromised. If targeted, efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior if compromised.", "external_references": [{"external_id": "T1480", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1480"}], "id": "course-of-", "modified": "2019-07-24T19:17:09.258Z", "name": "Environmental Keying Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Access tokens are an integral part of the security system within Windows and cannot be turned off. However, an attacker must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require to do their job.\n\nAny user can also spoof access tokens if they have legitimate credentials. Follow mitigation guidelines for preventing adversary use of [Valid Accounts](https://attack.mitre.org/techniques/T1078). Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object. (Citation: Microsoft Create Token) Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token. (Citation: Microsoft Replace Process Token)\n\nAlso limit opportunities for adversaries to increase privileges by limiting Privilege Escalation opportunities.", "external_references": [{"external_id": "T1134", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1134"}, {"description": "Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.", "source_name": "Microsoft Create Token", "url": "https://docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object"}, {"description": "Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.", "source_name": "Microsoft Replace Process Token", "url": "https://docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token"}], "id": "course-of-", "modified": "2019-07-24T14:29:27.367Z", "name": "Access Token Manipulation Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about the operating system and underlying hardware, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1082", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1082"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2020-01-17T16:45:24.235Z", "name": "System Information Discovery Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Consider disabling Microsoft Office macros/active content to prevent the execution of malicious payloads in documents (Citation: Microsoft Disable Macros), though this setting may not mitigate the [Forced Authentication](https://attack.mitre.org/techniques/T1187) use for this technique.\n\nBecause this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations including training users to identify social engineering techniques and spearphishing emails. Network/Host intrusion prevention systems, antivirus, and detonation chambers can be employed to prevent documents from fetching and/or executing malicious payloads. (Citation: Anomali Template Injection MAR 2018)", "external_references": [{"external_id": "T1221", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1221"}, {"description": "Microsoft. (n.d.). Enable or disable macros in Office files. Retrieved September 13, 2018.", "source_name": "Microsoft Disable Macros", "url": "https://support.office.com/article/enable-or-disable-macros-in-office-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6"}, {"description": "Intel_Acquisition_Team. (2018, March 1). Credential Harvesting and Malicious File Delivery using Microsoft Office Template Injection. Retrieved July 20, 2018.", "source_name": "Anomali Template Injection MAR 2018", "url": "https://forum.anomali.com/t/credential-harvesting-and-malicious-file-delivery-using-microsoft-office-template-injection/2104"}], "id": "course-of-", "modified": "2019-07-25T12:27:19.577Z", "name": "Template Injection Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Determine if certain social media sites, personal webmail services, or other service that can be used for spearphishing is necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.\n\nBecause this technique involves use of legitimate services and user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails with malicious links. To prevent the downloads from executing, application whitelisting can be used. Anti-virus can also automatically quarantine suspicious files.", "external_references": [{"external_id": "T1194", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1194"}], "id": "course-of-", "modified": "2019-07-25T12:00:12.285Z", "name": "Spearphishing via Service Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Grant access to application deployment systems only to a limited number of authorized administrators. Ensure proper system and access isolation for critical network systems through use of firewalls, account privilege separation, group policy, and multifactor authentication. Verify that account credentials that may be used to access deployment systems are unique and not used throughout the enterprise network. Patch deployment systems regularly to prevent potential remote access through [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068). \n\nIf the application deployment system can be configured to deploy only signed binaries, then ensure that the trusted signing certificates are not co-located with the application deployment system and are instead located on a system that cannot be accessed remotely or to which remote access is tightly controlled.", "external_references": [{"external_id": "T1017", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1017"}], "id": "course-of-", "modified": "2019-07-24T14:05:33.227Z", "name": "Application Deployment Software Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Ensure updated virus definitions. Create custom signatures for observed malware. Employ heuristic-based malware detection.\n\nIdentify and prevent execution of potentially malicious software that may have been packed by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1045", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1045"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2020-01-17T16:45:24.233Z", "name": "Software Packing Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of operating system design features. For example, disabling all BITS functionality will likely have unintended side effects, such as preventing legitimate software patching and updating. Efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identification of subsequent malicious behavior. (Citation: Mondok Windows PiggyBack BITS May 2007)\n\nModify network and/or host firewall rules, as well as other network controls, to only allow legitimate BITS traffic.\n\nConsider limiting access to the BITS interface to specific users or groups. (Citation: Symantec BITS May 2007)\n\nConsider reducing the default BITS job lifetime in Group Policy or by editing the JobInactivityTimeout and MaxDownloadTime Registry values in  HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\BITS. (Citation: Microsoft BITS)", "external_references": [{"external_id": "T1197", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1197"}, {"description": "Mondok, M. (2007, May 11). Malware piggybacks on Windows\u2019 Background Intelligent Transfer Service. Retrieved January 12, 2018.", "source_name": "Mondok Windows PiggyBack BITS May 2007", "url": "https://arstechnica.com/information-technology/2007/05/malware-piggybacks-on-windows-background-intelligent-transfer-service/"}, {"description": "Florio, E. (2007, May 9). Malware Update with Windows Update. Retrieved January 12, 2018.", "source_name": "Symantec BITS May 2007", "url": "https://www.symantec.com/connect/blogs/malware-update-windows-update"}, {"description": "Microsoft. (n.d.). Background Intelligent Transfer Service. Retrieved January 12, 2018.", "source_name": "Microsoft BITS", "url": "https://msdn.microsoft.com/library/windows/desktop/bb968799.aspx"}], "id": "course-of-", "modified": "2019-07-24T14:08:16.317Z", "name": "BITS Jobs Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of operating system design features. For example, mitigating specific API calls will likely have unintended side effects, such as preventing legitimate software (i.e., security products) from operating properly. Efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior.\n\nAlthough EWM injection may be used to evade certain types of defenses, it is still good practice to identify potentially malicious software that may be used to perform adversarial actions and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1181", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1181"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2021-08-23T20:25:19.367Z", "name": "Extra Window Memory Injection Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}