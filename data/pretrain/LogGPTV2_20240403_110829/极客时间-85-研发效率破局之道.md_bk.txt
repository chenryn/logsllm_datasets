## 这里我认真填写 B2 的 Commit Message    
## 查看提交历史    * 68d813f (HEAD -> master) [DO NOT PUSH] Add documentation for getRandom endpoint    * 7d43442 Add getRandom endpoint    * 0825c0b readme    * 7b6ea30 (origin/master) Add a new endpoint to return timestamp现在，提交链上有 A1、B1''、B2三个提交。 请注意，在这里我把功能实现和文档分为两个原子性提交，只是为了帮助说明我需要把B1'进行原子性拆分而已，在实际工作中，很可能功能实现和文档就应该放在一个提交当中。![](Images/8f185598d5e3956bfcca3245726d4e89.png)savepage-src="https://static001.geekbang.org/resource/image/1a/9d/1abf304f8b1de6fcd4a1487243e4409d.png"}图 4 提交链状态第 4 步slate-object="mark"}提交 B1'拆开之后，为了把 B1'' 推送到 origin/master 上去，我需要要把B1'' 挪到 A1 的前面。首先，运行 git rebase -iorigin/master。    > git rebase -i origin/master    
## 下面是弹出的编辑器    pick 0825c0b readme                   
## 这个是 A1    pick 7d43442 Add getRandom endpoint   
## 这个是 B1''    pick 68d813f [DO NOT PUSH] Add documentation for getRandom endpoint    
# Rebase 7b6ea30..68d813f onto 7b6ea30 (3 commands)    ...然后，我把针对 B1''的那一行挪到第一行，保存退出。    pick 7d43442 Add getRandom endpoint  
## 这个是 B1''    pick 0825c0b readme                  
## 这个是 A1       pick 68d813f [DO NOT PUSH] Add documentation for getRandom endpoint    
# Rebase 7b6ea30..68d813f onto 7b6ea30 (3 commands)    ...git rebase -i 命令会显示运行成功，使用 git log命令可以看到我成功改变了提交的顺序。    > git rebase -i origin/master    Successfully rebased and updated refs/heads/master.    > git log --oneline --graph    * 86126f7 (HEAD -> master) [DO NOT PUSH] Add documentation for getRandom endpoint    * 7113c16 readme    * 4d37768 Add getRandom endpoint    * 7b6ea30 (origin/master) Add a new endpoint to return timestamp现在，提交链上有B1'''、A1'、B2'三个提交了。请注意，B2'也是一个新的提交。虽然我只是交换了B1'' 和 A 的顺序，但 git rebase的操作是重新应用，产生出了三个新提交。![](Images/2f254c2e5aeb2d8f56b834a9bf807c6a.png)savepage-src="https://static001.geekbang.org/resource/image/2a/a8/2af308dacc801197e5248b49f8cc83a8.png"}图 5 提交链状态第 5 步slate-object="mark"}现在，我可以把 B1'''发送给质量检查系统了。首先，产生一个临时分支 temp 指向 B2'，确保能回到原来的代码；然后，用git reset \--hard 命令把 master 和 HEAD 指向B1'''。     > git branch temp    > git reset --hard 4d37768    HEAD is now at 4d37768 Add getRandom endpoint    
## 检查提交链    > git log --oneline --graph    * 4d37768 (HEAD -> master) Add getRandom endpoint    * 7b6ea30 (origin/master) Add a new endpoint to return timestamp    ...这时，提交链中只有 B1'''。当然，A1'和B2'仍然存在，只是不在提交链里了而已。![](Images/28905d13461b06b07c1f077ed8fb47af.png)savepage-src="https://static001.geekbang.org/resource/image/71/91/71b4dba396681ffcec08e912edb7b691.png"}图 6 提交链状态第 6 步slate-object="mark"}最后，运行命令把 B1''' 提交到 Phabricator 上，结束后使用 git reset\--hard temp 命令重新把 HEAD 指向B2'。     