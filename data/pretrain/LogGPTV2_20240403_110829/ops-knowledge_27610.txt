User: How to write a Python script to scan ports on a server and output the opened ports to a log file?
Assistant: The following is a simple Python script that can scan all ports of the specified IP address and output the open ports to the specified log file: ``` import socket # Define the IP address and port range to be scanned target_host = "127.0.0.1 " target_ports = range(1, 100) # Create a log file and open logfile = open("portscan.log", "w") # Start scanning for port in target_ports: try: # Create a socket object s = socket.socket( socket.AF_INET, socket.SOCK_STREAM) # Set the connection timeout to 1 second s.settimeout(1) # Try to connect to the port result = s.connect_ex((target_host, port)) # If the connection is successful (return 0), it means the port Open if result == 0: logfile.write(f"{target_host}:{port} is open\n") except: pass finally: # Close the socket connection s.close() # Close the log file logfile.close() ` `` This script uses the socket module to create a TCP connection and tries to connect to the specified port. If the connection is successful, the port information is output to the log file. You can modify the IP address and port range to be scanned according to the actual situation, and replace the log file name with the name you want to use. When running the script, you can enter the following command in the terminal: ``` python portscan.py ``` The script will start the scan and output the results to the specified log file.