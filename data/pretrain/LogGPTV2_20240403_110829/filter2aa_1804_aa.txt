Robots with lasers and cameras (but no security):  
Liberating your vacuum from the cloud 
DEFCON 29 – Dennis Giese
(08.08.2021)  DEFCON 29 – Dennis Giese
2
About me
• PhD student at Northeastern University, USA 
– Working with Prof. Guevara Noubir @Khoury 
– Research field: Wireless and embedded security&privacy 
• Interests: Reverse engineering of interesting devices 
– Smart Home Devices, mostly vacuum cleaning robots 
– Current research: Smart Speakers
(08.08.2021)  DEFCON 29 – Dennis Giese
3
Most recent work
• “Amazon Echo Dot or the reverberating secrets of IoT devices” 
• Authors: Dennis Giese and Guevara Noubir 
• Published: ACM WiSec 2021
https://dontvacuum.me/papers/ACMWisec-2021/ 
(08.08.2021)  DEFCON 29 – Dennis Giese
4
Goals
• Get an overview over the development of vacuum robots 
– Focus: Roborock and Dreame 
• Learn about vulnerabilities and backdoors 
• Understand methods to root current robots
https://www.dreame-technology.com/ 
https://www.roborock.com
Side note: Generally, a 
friendly relationship with 
vendors is maintained
(08.08.2021)  DEFCON 29 – Dennis Giese
5
MOTIVATION
(08.08.2021)  DEFCON 29 – Dennis Giese
6
Why do we want to root devices?
• Play with cool hardware 
• Stop devices from constantly phoning home 
• Use custom Smart Home Software 
• Verification of privacy claims
(08.08.2021)  DEFCON 29 – Dennis Giese
7
Why do we not trust IoT?
• Devices are connected to the home network 
• Communication to the cloud is encrypted, content unclear 
• Developing secure hardware and software is hard 
• Vendor claims contradict each other
(08.08.2021)  DEFCON 29 – Dennis Giese
8
“Nothing is sent to the cloud”?
https://global.roborock.com/pages/roborock-s6-maxv 
(08.08.2021)  DEFCON 29 – Dennis Giese
9
… but you can access the camera?
https://global.roborock.com/pages/roborock-s6-maxv 
(08.08.2021)  DEFCON 29 – Dennis Giese
10
Problem of used devices
• Used devices might be problematic 
– Previous owner installed rootkit 
– New owner cannot verify software 
– Result: Device might behave maliciously in your network 
• Rooting is the only way to verify that a device is „clean“
(08.08.2021)  DEFCON 29 – Dennis Giese
11
A LOOK IN THE PAST:  
THE GOOD OLD TIMES
(08.08.2021)  DEFCON 29 – Dennis Giese
12
First work in 2017
•
Work together with Daniel Wegemer 
•
Xiaomi Vacuum Robot / Roborock S5 
•
Findings: 
– Firmware images: unsigned and encrypted with weak key 
– Custom firmware could be pushed from local network 
•
Result: 
– Rooting without disassembly 
– Development of custom Software and Voice packages 
•
Publication: 34C3 (2017) and DEF CON 26 (2018)
rockrobo.vacuum.v1 (End of 2016), roborock.vacuum.s5 (End of 2017)
https://dontvacuum.me/talks/DEFCON26/DEFCON26-Having_fun_with_IoT-Xiaomi.html 
(08.08.2021)  DEFCON 29 – Dennis Giese
13
Recap Hardware V1 / S5
•
Quadcore ARM 
•
512 Mbyte RAM 
•
4 GByte eMMC Flash 
•
Sensors: 
– LiDAR 
– IR 
– Ultrasonic 
•
Debug ports: 
– USB 
– UART
512 MB RAM
Quadcore 
SOC 
4GB 
eMMC 
Flash
WiFi Module
STM32 MCU
(08.08.2021)  DEFCON 29 – Dennis Giese
14
Recap Software V1 / S5
•
Ubuntu 14.04.3 LTS (Kernel 3.4.xxx) 
–
Mostly untouched 
–
Obfuscated “root” password 
•
Player 3.10-svn 
–
Open-Source Cross-platform robot device interface & server 
•
Proprietary software (/opt/rockrobo) 
–
Custom adbd-version 
–
Watchdog (enforces copy protection) 
–
Logging tool (uploading a lot of data to the cloud) 
•
iptables firewall enabled (IPv4!) 
–
Blocks Port 22 (SSHd) + Port 6665 (player) 
–
Fail: IPv6 not blocked at all
(08.08.2021)  DEFCON 29 – Dennis Giese
15
THE FORCE STRIKES BACK:  
LOCKING DOWN THE DEVICES
(08.08.2021)  DEFCON 29 – Dennis Giese
16
First steps in locking down
• Newer Roborock S5 firmware: local updates blocked 
• With introduction of Roborock S6 (2019): 
– Signed firmware and voice packages 
– Each model uses different encryption keys 
– Signed configuration files to enforce region locks 
– However: Hardware remains mostly the same 
• Disassembly of devices was required
(08.08.2021)  DEFCON 29 – Dennis Giese
17
Keeping rooting methods secret
• Roborock S6 rooted in the first 2 weeks after release 
• Developed methods: 
– Extraction of obfuscated root password via UART 
– Single user boot via U-Boot 
• Methods were not published for some time 
• Assumption: Roborock would lock them down in newer 
devices
(08.08.2021)  DEFCON 29 – Dennis Giese
18
Getting access via UART
(08.08.2021)  DEFCON 29 – Dennis Giese
19
Observations
• Every time we publish a method, it gets blocked 
• Examples for blocking: 
– Local updates (2017):  
• Blocked via firmware updates in 2018 
– Root password method (2019): 
• Blocked for newly produced devices in 2019 
– U-Boot bypass (2020):  
• Blocked for new models in 2020
All currently public 
methods are blocked ☹
(08.08.2021)  DEFCON 29 – Dennis Giese
20
DEVELOPMENT OF ROBOROCK MODELS
(08.08.2021)  DEFCON 29 – Dennis Giese
21
Roborock device development
2016
2017
2019
2020
2021
2018
512 
MB 
RAM
256 
MB 
RAM
>= 4 
GB 
Flash
= 4 
GB 
Flash
= 4 
GB 
Flash
= 4 
GB 
Flash
= 4 
GB 
Flash
<= 512 
Mbyte 
Flash
1GB 
RAM
Contains only global models
Roborock 
S5
Roborock  
S6
Xiaomi 
M1S
Roborock 
S6 Pure
Roborock 
S6 MaxV
Roborock 
S7
Roborock 
S4 Max
Roborock 
S4
Roborock 
S5 Max
Images: Xiaomi
Hardware gets weaker, 
despite devices getting more 
expensive
Conclusion
(08.08.2021)  DEFCON 29 – Dennis Giese
26
ROBOROCK CAMERA ROBOTS
(08.08.2021)  DEFCON 29 – Dennis Giese
27
Xiaomi M1S
•
Released Q2/2019 
•
SoC: Rockchip RK3326 (64-Bit ARM Quadcore) 
•
RAM: 512 Mbyte 
•
Flash: 4GByte eMMC 
•
Sensors: 
– LiDAR 
– Up-facing B/W Camera 
– Ultrasonic distance sensor 
– IR sensors
Find more teardown pictures here: 
https://dontvacuum.me/teardowns/roborock.vacuum.m1s/ 
(08.08.2021)  DEFCON 29 – Dennis Giese
28
Video perspective of M1S robot
Recorded with GStreamer on robot (/dev/video1)
(08.08.2021)  DEFCON 29 – Dennis Giese
29
Roborock S6 MaxV Hardware
•
Released Q2/2020 
•
SoC: Qualcomm APQ8053 (64-Bit ARM Octocore) 
•
RAM: 1 GByte 
•
Flash: 4GByte eMMC 
•
Sensors: 
– LiDAR 
– 2x FullHD color front cameras (with IR) 
– IR sensors 
•
Water Tank + Pump
Find more teardown pictures here: 
https://dontvacuum.me/teardowns/roborock.vacuum.a10/ 
SoC
eMCP
(08.08.2021)  DEFCON 29 – Dennis Giese
30
Roborock S6 MaxV Cameras
Stereo Camera
Infrared 
Illumination
Screenshots from the Roborock app
(08.08.2021)  DEFCON 29 – Dennis Giese
31
Xiaomi M1S/Roborock S6 MaxV Software
• OS: Android 
• Similar software as previous models 
• Cameras can be accessed via video4linux subsystem 
• Used libraries 
– OpenCV 
– OpenCL 
– Tensorflow Lite
(08.08.2021)  DEFCON 29 – Dennis Giese
32
Security measures
• Secure boot 
– Replay-Protected-Memory-Block (RPMB) enabled 
• DM-Verity 
– System partition integrity protected 
• SELinux enabled and enforced 
• LUKS encrypted partitions 