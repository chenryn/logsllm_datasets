100902.32
14495.52
6617.87
8926.51
6373.18
8672.56
8675.94
5675.82
5765.41
5419.67
5641.58
8088.24
4472.72
7105.98
14234.50
129159.73
6804.63
7171.63
7179.88
4485.14
6217.96
21548.54
42
112
51
17
17
17
178
203
40
144
5
81
87
25
174
180
201
241
81
91
81
76842.48
23995.28
28307.96
20200.59
28883.78
27638.94
17990.56
18273.75
17139.82
17851.33
25137.46
15263.72
25137.46
48857.82
571411.21
23153.98
44305.60
26033.04
13015.93
17715.63
107037.17
Fig. 14. RRP 1 timings obtained from the Proxmark and from inside the
replay program.
time bounds to be imposed.
CORRELATION COEFFICIENT AND PROBABILITIES FOR REPLY TIME
MEASUREMENTS FOR VISA AND MASTERCARD CARDS.
TABLE III
Mastercard-RRP
wupa
anticoll
select uid
rats
Select 2Pay
Select AID
GPO 1
rrp 1
rrp 2
rrp 3
read record: 01, SFI: 2
read record: 01, SFI: 3
read record: 01, SFI: 4
read record: 02, SFI: 5
checksum
restore
Mastercard
wupa
anticoll
select uid
rats
Select 2Pay
Select AID
GPO 1
GPO 2
read record: 01, SFI: 2
read record: 01, SFI: 4
read record: 02, SFI: 4
Visa
wupa
anticoll
select uid
rats
Select 2Pay
Select AID
GPO 1
restore
Corr coef
p-value
-0.08
-0.03
-0.03
0.82
0.80
0.83
0.80
0.82
0.85
0.85
0.82
0.82
0.82
0.82
0.82
0.88
0.02
-0.16
0.06
0.74
0.72
0.72
0.74
0.73
0.73
0.72
0.73
-0.01
-0.28
-0.06
0.69
0.81
0.82
0.81
0.78
0.06
0.47
0.41
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
0.62
< 0.05
0.14
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
0.70
< 0.05
0.12
< 0.05
< 0.05
< 0.05
< 0.05
< 0.05
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:59:17 UTC from IEEE Xplore.  Restrictions apply. 
1755
APPENDIX D
EMV ACRONYMS & MODELS DIFFERENCES
TABLE IV
EMV ACRONYMS USED IN THIS PAPER.
AC
AFL
AID
AIP
ATC
Application Cryptogram
Application File Locator
Application Identiﬁer
Application Interchange Proﬁle
Application Transaction Counter
CARD
Card Authentication Related Data
CDA
Combined DDA and AC
CDCVM Consumer Device CVM
CDOL
Card Risk Management Data Object
List
Cryptogram Information Data
CID
CTQ
CV
CVM
CVR
DDA
Card Transaction Qualiﬁer
Cardholder Veriﬁcation
Cardholder Veriﬁcation Method
Card Veriﬁcation Results
Dynamic Data Authentication
ERRD
Exchange Relay Resistance Data
FCI
File Control Information
GEN AC
GPO
Generate AC
Get Processing Options
IAC
IAD
ICC
MCC
MNL
ODA
PAR
PDOL
SDA
SDAD
Track 2
TRID
TRM
TTQ
TVR
Issuer Action Code
Issuer Application Data
Issuer Country Code
Merchant Category Code
Merchant Name and Location
Ofﬂine Data Authentication
Payment Account Reference
Processing options Data Object List
Static Data Authentication
Signed Dynamic Application Data
User’s account information on the card
Token Requestor ID
Terminal Risk Management
Terminal Transaction Qualiﬁer
Terminal Veriﬁcation Results
UN
Unpredictable Number
A cryptogram generated by the card and used by the Issuer to conﬁrm the legitimacy of the
transaction.
A list of application data records stored on the card. This is used to indicate to the terminal what
data should be used when processing the transaction.
An Application Identiﬁer uniquely labels an EMV application. A card reports to a reader the AIDs
programmed into it, and the reader will select a supported one to process a transaction.
This indicates to the terminal what processing should be done for the transaction.
A counter stored on the card and incremented for each transaction. The Issuer monitors this value
which should always increase.
Authentication data that may be returned as part of the transaction data. If returned it includes a
card nonce and the authorised payment amount.
This is one method used for ofﬂine card authentication and the signed data and application
cryptogram are generated together.
The authentication method used on the consumer’s own device for cardholder veriﬁcation.
This list speciﬁes the data to be used when generating the AC.
This data is returned by the card as part of the response to the Generate AC command. It is used
to indicate the type of cryptogram and the actions to be taken by the terminal.
This is set on the card when it is issued and is used to control what actions the terminal should
take during a transaction.
Verifying that it is the legitimate cardholder who is making the transaction.
This is used to verify that it is the legitimate cardholder that is presenting the card for payment.
There are different veriﬁcation methods and they have different payment limits applied to them.
Data returned to the Issuer as part of the IAD.
Used to authenticated the card, but unlike SDA the card is required to sign a nonce from the terminal.
This is more secure and is designed to stop replay attacks.
The EMV command used by the Mastercard protocol for providing relay resistance for contactless
cards.
This is a template that gives information about the data ﬁelds that follow. The FCI is not speciﬁc
to EMV, it is part of the Level 2 speciﬁcation (ISO/IEC 7816-4 [56]).
The instruction to generate the application cryptogram.
A command sent to the card with the requested PDOL data to retrieve transaction speciﬁc application
data (AFL and IAD).
This speciﬁes what action the Issuer wants to be taken based on the TVR. Possible actions are:
default, denial and online.
Proprietary application data to be used in the transaction.
Indicates the country of the card issuer.
A standard code (ISO 18245) used for retail ﬁnancial transactions to classify the business type.
Just what it says, although it is not always correctly initialised. For TfL it contains the station name.
Mode of authenticating the card when the terminal is ofﬂine. This may be done using DDA, or
SDA.
A non-ﬁnancial reference assigned to each unique Payment Account Number (PAN) and used to
link a Payment Account represented by that PAN to an afﬁliated Payment Token.
A list of data sent to the card for it to use when processing the transaction.
Allows the card to be authenticated when in ofﬂine mode using ﬁxed data.
A digital signature on the data used for DDA, or SDA.
The location of the user’s data on the card.
ID which uniquely identiﬁes the pairing of Token Requester with the Token Service Provider.
The processes carried out on the terminal to protect from fraud.
Data ﬁxed on the terminal detailing its abilities and requirements.
This 5 byte result contains ﬂags that show the result of the different processing functions that have
been carried out as part of the transaction.
A nonce used as part of a transaction. Both the terminal and the card may generate and use nonces.
EMV DATA DIFFERENCES BETWEEN BASIN ET. AL. MODELS AND MODELS PRESENTED IN THIS PAPER.
TABLE V
EMV data
IAD
Basin et. al. [2]
Format 0/1/3
Our models
Format 4
CVR (part of IAD)
MCC




Comments
IAD format is given by the IAD length (1st byte) and, for Format 2 & 4, the left nibble
of the CVN (2nd byte); cross-checking IAD with transaction amount would prevent
limit-bypass attack presented in [2].
Format 4 contains a CDCVM bit; checking this would prevent limit-bypass attack
presented in [2].
Sent to payment network, even if not present in transaction APDUs; cross-checking
MCC with IAD would prevent limit-bypass attacks.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:59:17 UTC from IEEE Xplore.  Restrictions apply. 
1756