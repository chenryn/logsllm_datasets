addresses is less than twice of number of preﬁxes in DB.
After we identify persistent forwarding loops and shad-
owed preﬁxes from DB, we further examine the forwarding
consistency to multiple IP addresses in shadowed preﬁxes,
and the observability of persistent forwarding loops from
different locations. For these purposes, we collect two ad-
USENIX Association
Internet Measurement Conference 2005  
387
ditional data sets, DC and DD. In DC, we trace to about
35% of the shadowed preﬁxes and select 50 random IP ad-
dresses in each preﬁx. We collect data DD from four hosts
in PlanetLab [9] that are located in Asia, Europe, US east
coast and US west coast. We denote data sets from four
hosts as DD1, DD2, DD3, and DD4 respectively. For each
of them, we trace to about 46% of shadowed preﬁxes and
select 4 random IP addresses in each preﬁx. Table 1 sum-
marizes our measurement design and data sets.
preﬁxes in DC conﬁrm that all additional sampled hosts
have forwarding loops. We further investigate the reason
that not all additional sampled hosts have forwarding loops
in shadowed preﬁxes. We ﬁnd that 73.41% of them are
caused by the fact that infrastructure addresses (deployed
for router interfaces) are sampled. For example in Fig. 1,
although there is a forwarding loop when tracing to host
Y , there is no forwarding loop if we trace to the interface
address of Rc. It suggests that multiple IP addresses in the
shadowed preﬁxes experience forwarding loops.
4 CHARACTERIZING
FORWARDING LOOPS
PERSISTENT
4.1.2 Imperiled Preﬁxes
A trace of traceroute normally contains a sequence of router
interface addresses. However, some traces may contain “*”
or “!” when routers do not send back ICMP packets, replies
get lost or ﬁltered, or destinations cannot be reached. To re-
duce ambiguity, we ﬁlter out the traces that contain “*” or
“!” between two appearances of a same address. We also
ﬁlter out the traces where the same address appears contin-
uously because forwarding loops could not be constructed
by a single router interface.
4.1 Prevalence of Shadowed Preﬁxes and Im-
periled Preﬁxes
4.1.1 Shadowed Preﬁxes
In our measurement, we identify the candidate preﬁxes
from DA and perform traceroute to these candidate preﬁxes
to collect DB. We then analyze DB to identify persistent
forwarding loops and shadowed preﬁxes.
Among 5.24 million preﬁxes traced in DA, 139, 278 of
them are identiﬁed as candidate preﬁxes.
If we convert
them into IP addresses, they cover about 2.66% of routable
IP addresses.
From data DB that traces to 10% of candidate preﬁxes,
we obtain 9, 630 persistent forwarding loops, and identify
10, 569 preﬁxes as shadowed preﬁxes. If we convert shad-
owed preﬁxes into IP addresses, we ﬁnd that 81.39% of
IP addresses in our sampled space have persistent forward-
ing loops. This number constitutes 0.2% of all routable IP
addresses. Shadowed preﬁxes are located in 2, 950 ASes,
which suggests that IP addresses experiencing forwarding
loops are originated from a large number of ASes. We be-
lieve that shadowed addresses in the Internet could be much
more than what we have found in DB because we trace to
only 10% of candidate preﬁxes.
Note that we trace a limited number of IP addresses in
each ﬁne-grained preﬁx to collect forwarding paths. In or-
der to conﬁrm that, not only the selected IP addresses in
shadowed preﬁxes experience forwarding loops, but other
IP addresses in shadowed preﬁxes also experience forward-
ing loops, we use DC for this study. 67.96% of shadowed
As mentioned in Section 2, the vulnerability of persistent
forwarding loops does not come from the shadowed ad-
dresses themselves. Rather, it comes from the shared links
between persistent forwarding loops and the forwarding
paths to imperiled addresses. To understand the extent of
this vulnerability, we estimate the prevalence of imperiled
addresses in the Internet.
The basic idea on identifying imperiled addresses is to
ﬁnd those IP addresses that are reachable and their forward-
ing paths share one or more links with persistent forward-
ing loops. It is not easy to fully identify the imperiled ad-
dresses in the Internet without a global view of forwarding
paths from a source to a destination. In our experiment, we
estimate the number of imperiled addresses/preﬁxes from
DA. Any reachable address in DA that uses one or more
links in a persistent forwarding loop is marked as an im-
periled address. The ﬁne-grained preﬁxes containing any
imperiled address are marked as imperiled preﬁxes. Based
on the persistent forwarding loops found in Section 4.1.1
and the traces in DA, 10, 828 of ﬁne-grained preﬁxes are
identiﬁed as imperiled preﬁxes.
If we convert them into
IP addresses, about 0.21% of all routable IP addresses are
imperiled addresses. These imperiled addresses could be
the potential victims when the vulnerability on persistent
forwarding loops is exploited. These imperiled preﬁxes
are originated from 1, 516 ASes, so the potential victims
widely spread in various domains. We show an imperiled
address discovered in our measurement in Fig. 2.
Note that not all persistent forwarding loops share their
links with forwarding paths to imperiled preﬁxes. Among
9, 630 persistent forwarding loops, only 6.33% of them
share links with forwarding paths to imperiled addresses.
We call those shadowed addresses (preﬁxes) that can be
exploited for attacking imperiled addresses dark addresses
(preﬁxes). Among 10, 569 shadowed preﬁxes, only 5.64%
of them are dark preﬁxes. With the growth and evolution
of the Internet, some shadowed preﬁxes may become dark
preﬁxes. Generally, a persistent forwarding loop shares
one or more links with forwarding paths to only up to two
imperiled preﬁxes. However, some persistent forwarding
loops may share one or more links with forwarding paths to
388
Internet Measurement Conference 2005 
USENIX Association
as many as 1, 000 imperiled preﬁxes. Flooding such shared
links can result in denial of service to a large number of
imperiled addresses.
4.2 Properties of Persistent Forwarding
Loops
4.2.1 Location of Persistent Forwarding Loops
Identifying the location of persistent forwarding loops is
helpful for us to understand where they occur. Persis-
tent forwarding loops may occur within the destination do-
mains, or across one or more other domains. It is difﬁcult
to accurately map infrastructure IP addresses to AS num-
bers [7]. However, because the most serious inaccuracies
occur at AS boundaries, the accuracy may not be a problem
if we only identify persistent forwarding loops that occur
within destination domains. We consider that a persistent
forwarding loop occurs within the destination domain if all
interface addresses that appear in the loop are originated
from the same AS as the shadowed address.
Among 91, 090 traces with persistent forwarding loops,
85.16% of them occur in destination domains. It suggests
that most persistent forwarding loops are close to the shad-
owed addresses rather than in the core of Internet. When
persistent forwarding loops occur in destination domains,
we conjecture that trafﬁc to the shadowed addresses from
different locations will most likely fall into these loops al-
though they may traverse different paths in the core of In-
ternet.
To conﬁrm our conjecture, we collect additional traces,
DD1, DD2, DD3 and DD4 on various hosts to verify the
observability of persistent forwarding loops from differ-
ent locations. We ﬁnd that, persistent forwarding loops
to about 90% of shadowed preﬁxes can still be observed
from all four locations. Given that most persistent forward-
ing loops happen in destination domains, it is not surprising
that they can be observed from various locations. However,
comparing with the result that 85.16% of traces with per-
sistent forwarding loops occur in destination domains, we
conclude that although some persistent forwarding loops
may not occur in destination domains, they can still be ob-
served from different locations. It suggests that attackers
are able to exploit persistent forwarding loops from differ-
ent locations, which make this vulnerability more critical.
4.2.2 Length of Persistent Forwarding Loops
The length of persistent forwarding loops is important for
us to understand trafﬁc ampliﬁcation factor in the links that
appear in the persistent forwarding loops. When a packet
enters a persistent forwarding loop, it may traverse the links
in the loop multiple times before its TTL expires. The
shorter the length of a persistent forwarding loop is, the
s
p
o
o
L
g
n
d
r
a
w
r
o
F
i
t
n
e
t
s
s
r
e
P
i
f
o
r
e
b
m
u
N
 9000
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
 0
 1
 2
 3
 4
 5
 6
 7
 8
 9
 10  >10
Length of Persistent Forwarding Loops
Figure 3: Distribution of Length of Persistent Forwarding
Loops
more times a packet traverses the links in the loop. We
ﬁnd that, among 9, 630 persistent forwarding loops, over
88.82% of them have a length of 2, which can signiﬁcantly
amplify the amount of trafﬁc to shadowed addresses in the
links that appear in the loops. About 8.71% of them have a
length of 3 to 10. The rest of them have a length of 11 or
longer. Several persistent forwarding loops have a length
as long as 20. The distribution of length of persistent for-
warding loops is shown in Fig. 3.
4.3 Possible Causes of Persistent Forwarding
Loops
It is hard to identify the root causes of persistent forwarding
loops without information about conﬁgurations on the in-
volved routers. We conjecture that, the most possible cause
of persistent forwarding loops is misconﬁguration of the
common usages of default routes and static routes. Several
examples in [2] have shown that forwarding loops can hap-
pen if BGP or static routes are incorrectly conﬁgured. BGP
misconﬁgurations are common today in the Internet [6].
To understand how misconﬁgurations can easily lead to
persistent forwarding loops, we show an example that a net-
work administrator neglects to conﬁgure a “pull-up route”
at a border route to his upstream provider. Provider P
owns 18.0.0.0/8 and delegates 18.1.0.0/16 to its customer
C. The provider’s border router might have a static route
directing trafﬁc for 18.1.0.0/16 to the customer’s border
router. The customer’s border router, in turn, might have
routes for some subnets of 18.1.0.0/16, such as 18.1.1.0/24
and 18.1.2.0/24, but not for others. The customer’s border
router may also have a default route (e.g., 0.0.0.0/0) point-
ing to the link back to the provider’s router, for access to
the Internet. That would cause a persistent forwarding loop
for all trafﬁc destined to addresses in the range of 18.1.3.0
to 18.1.255.255.
In the above case, the forwarding loop is two hops long
and near the destination domain. However, when the cus-
tomer C is multi-homed, the same misconﬁguration may
USENIX Association
Internet Measurement Conference 2005  
389
also lead to a persistent forwarding loop that occurs across
multiple domains. For example, if the customer C has an-
other provider B and prefers to use its link to provider B
for outbound trafﬁc. Therefore, the customer C’s border
router has a default route 0.0.0.0/0 to provider B. The cus-
tomer C also prefers to use the link from provider P for
inbound trafﬁc. In this case, when the customer C receives
any trafﬁc destined to addresses in the range of 18.1.3.0
to 18.1.255.255, it will forward the trafﬁc to its provider
B. The provider B will forward the trafﬁc to its own
provider or neighbors. Eventually the trafﬁc will return
to the provider P and reach the customer C again. That
would cause a persistent forwarding loop occurring across
multiple domains and has a loop length longer than 2.
To prevent this, the customer needs to conﬁgure a “null
route” for 18.1.0.0/16 to discard packets to any destinations
in 18.1.0.0/16 that do not have a more speciﬁc route.
5 FLOODING ATTACKS USING PERSIS-
TENT FORWARDING LOOPS
In this section, we analyze the impact on the bandwidth
consumption of the links in persistent forwarding loops and
the effort that an attacker requires in order to launch such
ﬂooding attacks.
When a packet is sent to a shadowed address, it will fall
into the persistent forwarding loop. It traverses the links
in the loop and will be dropped only when its TTL ex-
pires. Therefore such a packet may traverse the links in the
loop multiple times before being dropped and will consume
more bandwidth. We deﬁne trafﬁc ampliﬁcation factor as
the average number of times that a packet traverses a link in
a persistent forwarding loop. Typically, a packet has a TTL
value with 64 when created at its origin. From our mea-
surement, we ﬁnd that persistent forwarding loops occur on
average 14 ∼ 15 hops away from the source. Without los-
ing generality, we consider that a packet traverses about 14
routers to fall into persistent forwarding loops. The persis-
tent forwarding loops typically have a length of 2 as shown
in Section 4.2.2. With this statistics, the trafﬁc ampliﬁca-
tion factor can be estimated to be 64−14
2 = 25. It means
that a packet will traverse the links in forwarding loops 25
times of what is expected. So the persistent forwarding
loops can induce much more trafﬁc than expected.
Due to the ampliﬁcation on the trafﬁc by persistent for-
warding loops, attackers are expected to take much less ef-
fort to launch ﬂooding attacks on imperiled addresses. For
example in Fig. 1, if the available bandwidth for the link
Lbc is 50Mbps, and trafﬁc ampliﬁcation factor is 25, then
an attacker needs to send trafﬁc at the rate of 2Mbps to
ﬂood Lbc. If an attacker has compromised 100 computers
in the Internet and launches such an attack, the average traf-
ﬁc rate on each machine is only 20Kbps. Such a rate can be
easily performed by most users and be hard to detect from
the source.
6 SUMMARY
In this paper we investigate the vulnerability on ﬂooding
attacks by exploiting persistent forwarding loops. We em-
phasize that such vulnerability can be exploited from vari-
ous locations, and can severely affect the Internet connec-
tivity to a signiﬁcant number of network addresses. These
ﬁndings suggest that this vulnerability could be a critical
threat to the Internet security. In our future work, we plan
to study the causes of persistent forwarding loops and how
to eliminate these hidden troubles.
7 ACKNOWLEDGMENTS
The authors would like to thank our shepherd Jennifer Rex-
ford for helpful suggestions and anonymous reviewers for
valuable comments on the paper. This work was supported
in part by NSF grant ANI-0208116, ANI-0085848, and the
Alfred P. Sloan fellowship.
References
[1] FRANCOIS, P., AND BONAVENTURE, O. Avoiding Transient Loops
during IGP Convergence in IP Networks. In Proc. IEEE INFOCOM
(March 2005).
[2] HALABI, B. Internet Routing Architectures. Cisco Press, 1997.
[3] HENGARTNER, U., MOON, S., MORTIER, R., AND DIOT, C. De-
tection and Analysis of Routing Loops in Packet Traces. In ACM
Sigcomm Internet Measurement Workshop (November 2002).
[4] HTTP://WWW.ARIN.NET/WHOIS/ARINWHOIS.HTML.
[5] INTERNET
ADDRESS
PROTOCOL
http://www.iana.org/assignments/ipv4-address-space.
V4
SPACE.
[6] MAHAJAN, R., WETHERALL, D., AND ANDERSON, T. Under-
standing BGP Misconﬁguration. In Proc. ACM SIGCOMM (August
2002).
[7] MAO, Z. M., REXFORD, J., WANG, J., AND KATZ, R. Towards
an Accurate AS-Level Traceroute Tool. In Proc. ACM SIGCOMM
(August 2003).
[8] PAXSON, V. End-to-End Routing Behavior in the Internet.
IEEE/ACM Trans. Networking (October 1997).
In
[9] PLANETLAB. http://www.planet-lab.org/.
[10] ROUTE VIEWS PROJECT.
http://www.antc.uoregon.edu/route-
views/.
[11] SRIDHARAN, A., MOON, S., AND DIOT, C. On The Correlation
Between Route Dynamics and Routing Loops. In Proc. ACM Sig-
comm Internet Measurement Conference (October 2003).
[12] ZHANG, M., ZHANG, C., PAI, V., PETERSON, L., AND WANG, R.
PlanetSeer: Internet Path Failure Monitoring and Characterization
in Wide-Area Services.
In 6th Symposium on Operating Systems
Design and Implementation (OSDI’04) (December 2004).
390
Internet Measurement Conference 2005 
USENIX Association