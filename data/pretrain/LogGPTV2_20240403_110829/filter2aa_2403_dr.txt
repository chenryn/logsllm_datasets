《Modern Operating Systems (4th Edition)》作者
“... 引人入胜，值得一读!”
—— Michael Sikorski
《Practical Malware Analysis》的作者
作者简介
Dennis Yurichev，乌克兰程序员，安全技术专家。读者可以
通过https://yurichev.com/联系他，并获取和本书相关的更多
学习资料。
R e v e r s e  E n g i n e e r i n g  f o r  B e g i n n e r s
权威指南
上册
[乌克兰] Dennis Yurichev◎著 
Archer  安天安全研究与应急处理中心◎译
逆向工程
Reverse Engineering for Beginners
Reverse 
Engineering
Windows 
ARM iOS 
Linux
Reversing
美术编辑：董志桢
● 了解逆向工程的权威指南
● 初学者必备的大百科全书
● 安天网络安全工程师培训必读书目
FM43445逆向工程权威指南 上.indd   1-3
17-3-6   上午11:19
异步社区会员 dearfuture(15918834820) 专享 尊重版权
分类建议： 计算机／软件开发／安全
人民邮电出版社网址：www.ptpress.com.cn
下册
下册
逆向工程权威指南
逆
向
工
程
权
威
指
南
逆向工程是一种分析目标系统的过程。
本书专注于软件逆向工程，即研究编译后的可执行程序。本书是写给初学者
的一本权威指南。全书共分为12个部分，共102章，涉及软件逆向工程相关
的众多技术话题，堪称是逆向工程技术百科全书。全书讲解详细，附带丰富
的代码示例，还给出了很多习题来帮助读者巩固所学的知识，附录部分给出
了习题的解答。
本书适合对逆向工程技术、操作系统底层技术、程序分析技术感兴趣的读者
阅读，也适合专业的程序开发人员参考。
“... 谨向这本出色的教程致以个人的敬意!”
—— Herbert Bos，阿姆斯特丹自由大学教授
《Modern Operating Systems (4th Edition)》作者
“... 引人入胜，值得一读!”
—— Michael Sikorski
《Practical Malware Analysis》的作者
作者简介
Dennis Yurichev，乌克兰程序员，安全技术专家。读者可以
通过https://yurichev.com/联系他，并获取和本书相关的更多
学习资料。
R e v e r s e  E n g i n e e r i n g  f o r  B e g i n n e r s
权威指南
下册
[乌克兰] Dennis Yurichev◎著 
Archer  安天安全研究与应急处理中心◎译
逆向工程
Reverse Engineering for Beginners
Reverse 
Engineering
Windows 
ARM iOS 
Linux
Reversing
美术编辑：董志桢
● 了解逆向工程的权威指南
● 初学者必备的大百科全书
● 安天网络安全工程师培训必读书目
FM43445逆向工程权威指南 下.indd   1-3
17-3-6   上午11:19
异步社区会员 dearfuture(15918834820) 专享 尊重版权
目
目    录
录  
第 47 章 字符串剪切 .................................... 485 
47.1 x64 下的 MSVC 2013 优化 ................ 486 
47.2 x64 下采用编辑器 GCC 4.9.1 进行非 
优化操作 ............................................. 487 
47.3 x64 下的 GCC 4.9.1 优化 ................... 488 
47.4 ARM64：非优化的 
GCC（Linaro）4.9 ............................. 489 
47.5 ARM64:优化 GCC（Linaro）4.9 ....... 490 
47.6 ARM: Keil 6/2013 优化 
（ARM 模式） ...................................... 491 
47.7 ARM:Keil 6/2013（Thumb 模式） 
优化 ..................................................... 492 
47.8 MIPS .................................................... 493 
第 48 章 toupper()函数 .............................. 495 
48.1 x64 ....................................................... 495 
48.1.1 两个比较操作 .......................... 495 
48.1.2 一个比较操作 .......................... 496 
48.2 ARM .................................................... 497 
48.2.1 ARM64 下的 GCC ................... 497 
48.3 总结 ..................................................... 498 
第 49 章 不正确的反汇编代码 ................. 499 
49.1 x86 环境下的从一开始错误的 
反汇编 ................................................. 499 
49.2 随机噪音，怎么看起来像反汇编 
指令？ ................................................. 500 
第 50 章 混淆技术 ........................................ 505 
50.1 字符串变换 ......................................... 505 
50.2 可执行代码 ......................................... 506 
50.2.1 插入垃圾代码 .......................... 506 
50.2.2 用多个指令组合代替原来的 
一个指令 .................................. 506 
50.2.3 始终执行或者从来不会执行的 
代码 .......................................... 506 
50.2.4 把指令序列搞乱 ...................... 507 
50.2.5 使用间接指针 .......................... 507 
50.3 虚拟机以及伪代码 ............................. 507 
50.4 一些其他的事情 ................................. 507 
50.5 练习题 ................................................. 508 
50.5.1 练习 1 ........................................ 508 
第 51 章 C++ .................................................. 509 
51.1 类 ......................................................... 509 
51.1.1 一个简单的例子 ....................... 509 
51.1.2 类继承 ....................................... 515 
51.1.3 封装 ........................................... 518 
51.1.4 多重继承 ................................... 520 
51.1.5 虚拟方法 ................................... 523 
51.2 ostream 输出流 .................................... 526 
51.3 引用 ..................................................... 527 
51.4 STL/标准模板库（Standard Template  
Library） ............................................. 528 
51.4.1 std::string（字符串） ............... 528 
51.4.2 std::list ....................................... 535 
51.4.3 std::vector 标准向量 ................. 545 
51.4.4 std::map()和 std::set()................ 552 
第 52 章 数组与负数索引 ........................... 563 
第 53 章 16 位的 Windows 程序 .............. 566 
53.1 例子#1.................................................. 566 
53.2 例子#2.................................................. 566 
53.3 例子#3.................................................. 567 
53.4 例子#4.................................................. 568 
53.5 例子#5.................................................. 571 
53.6 例子#6.................................................. 574 
53.6.1 全局变量 ................................... 576 
第四部分 Java 
第 54 章 Java .................................................. 581 
54.1 简介 ..................................................... 581 
54.2 返回一个值 .......................................... 581 
54.3 简单的计算函数 .................................. 586 
54.4 JVM 的内存模型 ................................. 588 
54.5 简单的函数调用 .................................. 588 
54.6 调用函数 beep()（蜂鸣器） ............... 590 
54.7 线性同余随机数产生器（PRNG） ... 591 
54.8 条件转移 .............................................. 592 
54.9 传递参数 .............................................. 594 
54.10 位操作................................................ 595 
异步社区会员 dearfuture(15918834820) 专享 尊重版权
2 
逆向工程权威指南（下册） 
54.11 循环 ................................................... 596 
54.12 switch()语句 ...................................... 598 
54.13 数组 ................................................... 599 
54.13.1 简单的例子 ............................ 599 
54.13.2 数组元素求和 ........................ 601 
54.13.3 输入变量为数组的主函数 
main() ...................................... 601 
54.13.4 预设初始值的的数组 ............. 602 
54.13.5 可变参数函数 ........................ 604 
54.13.6 二维数组 ................................ 606 
54.13.7 三维数组 ................................ 606 
54.13.8 小结 ........................................ 607 
54.14 字符串 ............................................... 607 
54.14.1 第一个例子 ............................ 607 
54.14.2 第二个例子 ............................ 608 
54.15 异常处理 ........................................... 609 
54.16 类 ....................................................... 612 
54.17 简单的补丁 ....................................... 614 
54.17.1 第一个例子 ............................ 614 
54.17.2 第二个例子 ............................ 616 
54.18 总结 ................................................... 618 
第五部分 在代码中发现重要而有趣的内容 
第 55 章 编译器产生的文件特征 ............. 621 
55.1 Microsoft Visual C++ .......................... 621 
55.1.1 命名规则 .................................. 621 
55.2 GCC 编译器 ........................................ 621 
55.2.1 命名规则 .................................. 621 
55.2.2 Cygwin ...................................... 621 
55.2.3 MinGW ..................................... 621 
55.3 Intel FORTRAN................................... 621 
55.4 Watcom 以及 OpenWatcom ................ 622 
55.4.1 命名规则 .................................. 622 
55.5 Borland 编译器 ................................... 622 
55.5.1 Dephi 编程语言 ........................ 622 
55.6 其他的已知 DLL 文件 ........................ 623 
第 56 章 Win32 环境下与外部通信 ....... 624 
56.1 在 Windows API 中最经常使用的 
函数 ..................................................... 624 
56.2 tracer:解析指定模块的所有函数 ....... 624 
第 57 章 字符串 ............................................. 626 
57.1 字符串 ................................................. 626 
57.1.1 C/C++中的字符串 .................... 626 
57.1.2 Borland Delphi .......................... 626 
57.1.3 Unicode 编码 ............................ 626 
57.1.4 Base64 ....................................... 628 
57.2 错误/调试信息 ..................................... 629 
57.3 可疑的魔数字符串 .............................. 629 
第 58 章 调用宏 assert()（中文称为 
断言） ............................................. 630 
第 59 章 常数 .................................................. 631 
59.1 魔数 ..................................................... 631 
59.1.1 动态主机配置协议（Dynamic Host  
Configuration Protocol，DHCP） .. 632 
59.2 寻找常数 .............................................. 632 
第 60 章 检索关键指令 ............................... 633 
第 61 章 可疑的代码模型 ........................... 635 
61.1 XOR 异或指令 .................................... 635 
61.2 手写汇编代码 ...................................... 635 
第 62 章 魔数与程序调试 ........................... 637 
第 63 章 其他的事情 .................................... 638 
63.1 总则 ..................................................... 638 
63.2 C++ ...................................................... 638 
63.3 部分二进制文件的特征 ...................... 638 
63.4 内存“快照”对比 .............................. 638 
63.4.1 Windows 注册表 ....................... 639 
63.4.2 瞬变比较器 Blink-comparator .... 639 
第六部分 操作系统相关 
第 64 章 参数的传递方法（调用规范） .... 643 
64.1 cdecl [C Declaration 的缩写]............... 643 
64.2 stdcall [Standard Call 的缩写] ............. 643 
64.2.1 带有可变参数的函数 ............... 644 
64.3 fastcall .................................................. 644 
64.3.1 GCC regparm ............................ 645 
64.3.2 Watcom/OpenWatcom ............... 645 
64.4 thiscall .................................................. 645 
64.5 64 位下的 x86 ...................................... 646 
64.5.1 Windows x64 ............................. 646 
64.5.2 64 位下的 Linux ....................... 648 
异步社区会员 dearfuture(15918834820) 专享 尊重版权
目    录 
3 
64.6 单/双精度数型返回值 ........................ 649 
64.7 修改参数 ............................................. 649 
64.8 指针型函数参数 ................................. 649 
第 65 章 线程本地存储 TLS ..................... 652 
65.1 线性同余发生器（改） ..................... 652 
65.1.1 Win32 系统 ............................... 652 
65.1.2 Linux 系统 ................................ 656 
第 66 章 系统调用（syscall-s）............... 658 
66.1 Linux.................................................... 658 
66.2 Windows .............................................. 659 
第 67 章 Linux ............................................... 660 
67.1 位置无关的代码 ................................. 660 
67.1.1 Windows ................................... 662 
67.2 在 Linux 下的 LD_PRELOAD ........... 662 
第 68 章 Windows NT ................................ 666 
68.1 CRT (Win32) ....................................... 666 
68.2 Win32 PE 文件 .................................... 669 
68.2.1 术语 .......................................... 670 
68.2.2 基地址 ...................................... 670 
68.2.3 子系统 ...................................... 670 
68.2.4 操作系统版本 .......................... 670 
68.2.5 段 .............................................. 671 
68.2.6 重定向段 Relocations(relocs) .... 672 
68.2.7 导出段和导入段 ...................... 672 
68.2.8 资源段 ...................................... 674 
68.2.9 .NET ......................................... 675 
68.2.10 TLS 段 .................................... 675 
68.2.11 工具 ........................................ 675 
68.2.12 更进一步 ................................ 675 
68.3 Windows SEH...................................... 675 
68.3.1 让我们暂时把 MSVC 放在 
一边 .......................................... 675 
68.3.2 让我们重新回到 MSVC .......... 680 
68.3.3 Windows x64 ............................ 693 
68.3.4 关于 SEH 的更多信息 ............. 697 
68.4 Windows NT：临界区段 .................... 697 
第七部分 常用工具 
第 69 章 反汇编工具 .................................... 703 
69.1 IDA ...................................................... 703 
第 70 章 调试工具 ......................................... 704 
70.1 tracer .................................................... 704 
70.2 OllyDbg................................................ 704 
70.3 GDB ..................................................... 704 
第 71 章 系统调用的跟踪工具 .................. 705 
71.1 strace/dtruss .......................................... 705 
第 72 章 反编译工具 .................................... 706 
第 73 章 其他工具 ......................................... 707 
第八部分 更多范例 
第 74 章 修改任务管理器（Vista） ....... 711 
74.1 使用 LEA 指令赋值 ............................ 713 
第 75 章 修改彩球游戏 ............................... 715 
第 76 章 扫雷（Windows XP） .............. 717 
76.1 练习题.................................................. 721 
第 77 章 人工反编译与Z3 SMT 求解法 .... 722 
77.1 人工反编译 .......................................... 722 
77.2 Z3 SMT 求解法 ................................... 725 
第 78 章 加密狗 ............................................. 730 
78.1 例 1：PowerPC 平台的 MacOS Classic 
程序 ..................................................... 730 
78.2 例 2: SCO OpenServer ......................... 737 
解密错误信息 ......................................... 745 
78.3 例 3: MS-DOS ..................................... 747 
第 79 章 “QR9”：魔方态加密模型 ........ 753 
第 80 章 SAP .................................................. 782 
80.1 关闭客户端的网络数据包压缩功能 ..... 782 
80.2 SAP 6.0 的密码验证函数 .................... 793 
第 81 章 Oracle RDBMS .......................... 797 
81.1 V$VERSION 表 .................................. 797 
81.2 X$KSMLRU 表 ................................... 805 
81.3 V$TIMER 表 ....................................... 806 
异步社区会员 dearfuture(15918834820) 专享 尊重版权
4 
逆向工程权威指南（下册） 
第 82 章 汇编指令与屏显字符 ................. 811 
82.1 EICAR ................................................. 811 
第 83 章 实例演示 ........................................ 813 
83.1 10PRINT CHR$(205.5+RND(1));: 
GOTO 10 ............................................. 813 