message stream, including the mentioned verification failures, the
average security level can represent the schemes performance much
better. The usually used notation of minimum security would al-
ways give 0 𝑏𝑖𝑡 as result in this setting and thus allow little insight.
6.4 Computation, Energy, Storage and Latency
We finally assess computational and storage overhead and theoreti-
cal gains.
Computation. Since Whips uses two separate PRFs for the calcu-
lation of the state update and the tag generation, it inherently adds
computational overhead. Consider the aforementioned HMAC as
underlying PRF, the usage of Whips adds another call this primitive.
By taking the additional state to be hashed into account, the
computation changes as follows: The internal state of 168 Bytes
(cmp. Sec. 5.4) in the robot control scenario is assumed to be larger
than payload messages. Thus, we measured execution of the HMAC-
SHA256 for the 15 Byte messages compared to HMAC-SHA512
needed for Whips Further, we measured the execution time of the
second PRF call on the state, i.e. HMAC-SHA512 of the 168 Bytes
substate. All experiments were repeated 1.000.000 times on current
hardware (Intel i5 at 2.3GHz).
By employing a modern hash function, SHA3-512, the execution
of the first call was equal for SHA3-512 and SHA3-256, with 5.2 𝜇𝑠
(𝜎 = 0.33 𝜇𝑠). The subsequent PRF call generating the final tag took
6.1 𝜇𝑠 (𝜎 = 0.31 𝜇𝑠).
Hence, we conclude that although we are adding a second PRF
call, the absolute computational overhead in terms of computation
time for the proposed scheme can be considered negligible.
Storage. In terms of required storage, our solution is lightweight
and very easy to integrate into the intended use cases. Assuming the
aforementioned state of 168 𝐵𝑦𝑡𝑒𝑠 and a large Area of Dependency
of 20, Whips requires 3.4 𝑘𝐵 state storage. This can be handled very
well, even by constrained LoRaWAN sensors which, controlled by
STM32L4 chips usually, have 40 to 320 𝑘𝐵 RAM available [1].
Energy. Energy overhead is especially relevant for battery-powered
devices. Considering the Tmote Sky, the radio unit consumes an
order of magnitude more power than the micro controller, at around
4.762 𝑚𝐽 for PHY access and ≈ 1 𝜇 𝐽 for each transmitted Byte [16].
Potential energy savings of Whips due to reduced transmission
cost range between 21% for 128-bit tags, 31% for 64-bit tags, and
as much as 37% for 32-bit tags in the robot use case, as described
above. Such gains and the avoidance of retransmissions through
resynchronization would directly reduce battery drain, and hence
extend the lifetime of motes.
Latency. Considering the robot control use case, even transmis-
sion of a normal 20 Byte MAC at 250kbps yields a payload size
of only 10 Bytes, ignoring all headers, to achieve the 1𝑚𝑠 delay
requirement with 802.15.4. Applying Whips, this payload size is al-
most tripled to 27 Bytes, or: considering a message size of 15 Bytes,
a 32-bit tag size allows transmission within .6 𝑚𝑠, at the same or
higher level of security.
Finally, we note that Whips can be used as drop in replacements
for existing MAC schemes.
7 SUMMARY
In this paper we tackle the challenge of improving the performance
of integrity checking streamed messages, directly upon reception.
We introduce the concept of progressive MACs, or ProMACs, to
provide security for drone and robot control, distributed control
loops in Tactile Internet applications, as well as communication and
storage in resource restricted environments. ProMACs integrate the
concepts of truncation for performance and state-chaining for in-
creased security while simultaneously exposing inherent resynchro-
nization capabilities. We introduce a unique state update function
that facilitates progressive verification of a message upon reception
of subsequent tags. The combination allows to significantly reduce
overhead while maintaining high levels of security and offering
resynchronization.
We present a new construction that realizes ProMACs. Within
the messages stream, this scheme constructs a tightly bound trust
chain over the internal states while only transmitting a short tag,
which allows for efficient transmission like truncated MACs, but
guarantees security at the same level as full length MACs. By intro-
ducing flexibility regarding the number of incorporated previous
states through the Area of Dependency, we allow for the resyn-
chronization after verification errors or packet loss. Here, the Area
of Dependency 𝑢 does not cover all preceding messages, but only
those that fall into a sliding window over the stream, as defined
by a system parameter. This facilitates resynchronization after 𝑢
messages have been verified subsequent to an error.
The presented ProMAC construction is suitable to directly re-
place current MAC schemes. Especially as replacement for short-
ened tag systems, this delivers the same performance with signifi-
cantly increased security.
We formally define the construction and prove its respective
security and the security levels it can guarantee.
It is worth noting that the formalization of ProMACs extends
the current MAC notion by compromising between the different
types of statefulness: Our notion covers classical MACs as well as
the tight statefulness of duplex based constructions by setting the
Area of Dependency respectively.
Finally, we conducted an extensive empirical evaluation demon-
strating the applicability of the construction, the performance gains
for realistic scenarios, and the effective security levels that are
achieved under various packet error probabilities. Thus we show
that the ProMACs satisfy all requirements of the described use cases.
In continuation of this work, we currently incorporate the Pro-
MAC design in its presented realization into existing systems as a
drop in replacement. Thereby, the impact of ProMACs on the re-
spective use cases can be further evaluated and the corresponding
applications can be provided with effective integrity protection.
We also plan further studies on the inherent semantics of the
realized security levels, ultimately providing interpretations in var-
ious contexts. This will give a more concise meaning to the current
confidence into the integrity of received packets and allow for the
development of suitable reactions.
ACKNOWLEDGMENTS
This work is partly supported by the German Research Foundation
(DFG) in the EXC 2050/1 “CeTI” – ID 390696704. We thank Yannic
Ahrens for extensive support with our experimental setup and
implementation. We further like to thank the reviewers for their
helpful and constructive feedback.
REFERENCES
[1] [n.d.]. STM32L4 - ARM Cortex-M4 ultra-low-power MCUs - STMicroelectronics.
https://www.st.com/en/microcontrollers-microprocessors/stm32l4-series.html
[2] Ferran Adelantado, Xavier Vilajosana, Pere Tuset-Peiro, Borja Martinez, Joan
Melia-Segui, and Thomas Watteyne. 2017. Understanding the limits of LoRaWAN.
IEEE Communications Magazine 55, 9 (2017).
[3] C. Bachhuber, E. Steinbach, M. Freundl, and M. Reisslein. 2018. On the minimiza-
tion of glass-to-glass and glass-to-algorithm delay in video communication. IEEE
Transactions on Multimedia (2018).
[4] M. Bellare, R. Canetti, and H. Krawczyk. 1996. Keying Hash Functions for Message
Authentication. In CRYPTO. 1–15.
[5] Mihir Bellare, Oded Goldreich, and Anton Mityagin. 2004. The Power of Verifica-
tion Queries in Message Authentication and Authenticated Encryption. Cryptol-
ogy ePrint Archive, Report 2004/309. https://eprint.iacr.org/2004/309.
[6] M. Bellare, R. Guérin, and P. Rogaway. 1995. XOR MACs: New Methods for
Message Authentication Using Finite Pseudorandom Functions. In CRYPT0.
[7] Mihir Bellare, Joe Kilian, and Phillip Rogaway. 2000. The Security of the Cipher
Block Chaining Message Authentication Code. J. Comput. System Sci. 61, 3 (Dec.
2000), 362–399. https://doi.org/10.1006/jcss.1999.1694
[8] Guido Bertoni, Joan Daemen, Michaël Peeters, and Gilles Van Assche. 2011. Du-
plexing the sponge: single-pass authenticated encryption and other applications.
In International Workshop on Selected Areas in Cryptography. Springer, 320–337.
[9] Guido Bertoni, Joan Daemen, Michaël Peeters, and Gilles Van Assche. 2013.
Keccak. In Annual international conference on the theory and applications of
cryptographic techniques. Springer, 313–314.
[10] J. Black, S. Halevi, H. Krawczyk, T. Krovetz, and P. Rogaway. 1999. UMAC: Fast
and Secure Message Authentication. In CRYPTO. 216–233.
able Message Authentication. In EUROCRYPT.
[11] J. Black and P. Rogaway. 2002. A Block-Cipher Mode of Operation for Paralleliz-
[12] Colin Boyd, Britta Hale, Stig Frode Mjølsnes, and Douglas Stebila. 2015. From
Stateless to Stateful: Generic Authentication and Authenticated Encryption Con-
structions with Application to TLS. Technical Report 1150. https://eprint.iacr.org/
2015/1150
[13] Ran Canetti and Hugo Krawczyk. 2001. Analysis of Key-Exchange Protocols and
Their Use for Building Secure Channels. In Advances in Cryptology — EUROCRYPT
2001 (Lecture Notes in Computer Science), Birgit Pfitzmann (Ed.). Springer Berlin
Heidelberg, 453–474.
[14] Y. Challal, H. Bettahar, and A. Bouabdallah. 2004. A2 Cast: An Adaptive Source
Authentication Protocol for Multicast Streams. In Proceedings of the ISCC.
[15] Y. Challal, A. Bouabdallah, and Y. Hinard. 2005. RLH: Receiver Driven Layered
Hash Chaining for Multicast Data Origin Authentification. Computer Communi-
cations (2005).
[16] Salar Chamanian, Sajjad Baghaee, Hasan Ulusan, Özge Zorlu, Haluk Külah,
and Elif Uysal-Biyikoglu. 2014. Powering-up wireless sensor nodes utilizing
rechargeable batteries and an electromagnetic vibration energy harvesting sys-
tem. Energies 7, 10 (2014), 6323–6339.
Xoodoo and Xoofff. (2018).
[17] Joan Daemen, Seth Hoffert, G Van Assche, and R Van Keer. 2018. The design of
[18] Oliver Eikemeier, Marc Fischlin, Jens-Fabian Götzmann, Anja Lehmann, Do-
minique Schröder, Peter Schröder, and Daniel Wagner. 2010. History-free aggre-
gate message authentication codes. In International Conference on Security and
Cryptography for Networks. Springer, 309–328.
[19] ETSI Technical Committee on Electromagnetic compatibility and Radio spectrum
Matters. 2011. Technical characteristics for SRD equipment for wireless industrial
applications using technologies different from Ultra-Wide Band (UWB). Technical
Report 102 889-2.
[20] Marc Fischlin, Felix Günther, Giorgia Azzurra Marson, and Kenneth G. Paterson.
2015. Data Is a Stream: Security of Stream-Based Channels. In Advances in
Cryptology – CRYPTO 2015 (LNCS). Springer, 545–564.
[21] S. Frankel and H. Herbert. 2003. The AES-XCBC-MAC-96 Algorithm and Its Use
With IPsec. RFC 3566.
[22] A. Frotzscher et al. 2014. Requirements and current solutions of wireless com-
munication in industrial automation. In IEEE International Conference on Com-
munications (ICC).
[23] R. Gennaro and P. Rohatgi. 1997. How to Sign Digital Streams. In Advances in
Cryptology — CRYPTO. 180–197.
[24] Wireless Personal Area Network Working Group. 2016. 802.15.4 - Standard for
Low-Rate Wireless Networks. IEEE.
[25] Shay Gueron. 2016. Memory encryption for general-purpose processors. IEEE
Security & Privacy 14, 6 (2016).
[26] Mike Hamburg. 2017. The STROBE protocol framework. IACR Cryptology ePrint
Archive 2017 (2017).
[27] T. Iwata and K. Kurosawa. 2003. Stronger Security Bounds for OMAC, TMAC,
and XCBC. In INDOCRYPT. 402–415.
[28] Tibor Jager, Florian Kohlar, Sven Schäge, and Jörg Schwenk. 2011. On the Security
of TLS-DHE in the Standard Model. Technical Report 219. https://eprint.iacr.org/
2011/219
[29] Jonathan Katz and Andrew Y Lindell. 2008. Aggregate message authentication
codes. In Topics in Cryptology–CT-RSA 2008. Springer, 155–169.
[30] Jonathan Katz and Yehuda Lindell. 2007. Introduction to Modern Cryptography
(Chapman & Hall/Crc Cryptography and Network Security Series). Chapman &
Hall/CRC.
[31] J. Kelsey, S-J Change, and R. Perlner. 2016. SHA-3 Derived Functions: cSHAKE,
KMAC, TupleHash and ParallelHash. Number NIST SP 800-185. National Institute
of Standards and Technology.
[32] Tadayoshi Kohno, Adriana Palacio, and John Black. 2003. Building Secure
Cryptographic Transforms, or How to Encrypt and MAC. Technical Report 177.
https://eprint.iacr.org/2003/177
[33] Vladimir Kolesnikov, Wonsuck Lee, and Junhee Hong. 2011. MAC aggregation
resilient to DoS attacks. In 2011 IEEE International Conference on Smart Grid
Communications (SmartGridComm). IEEE, 226–231.
[34] A. Konstantinos, X. Xu, E. Steinbach, T. Mahmoodi, and M. Dohler. 2018. Towards
haptic communications over the 5G Tactile Internet.
IEEE Communications
Surveys and Tutorials (2018).
[35] H. Krawczyk, M. Bellare, and R. Canetti. 1997. HMAC: Keyed-Hashing for
Message Authentication. RFC 2104. Updated by RFC 6151.
[36] C. Madson and R. Glenn. 1998. The Use of HMAC-MD5-96 within ESP and AH.
[37] C. Madson and R. Glenn. 1998. The Use of HMAC-SHA-1-96 within ESP and AH.
RFC 2403.
RFC 2404.
[38] D. McGrew and E. Rescorla. 2010. Datagram Transport Layer Security (DTLS)
Extension to Establish Keys for the Secure Real-time Transport Protocol (SRTP).
RFC 5764.
[39] S. Moriam, E. Franz, P. Walther, A. Kumar, T. Strufe, and G Fettweis. 2018. Pro-
tecting Communication in Many-Core Systems against Active Attackers. In
Proceedings of the Great Lakes Symposium on VLSI. 45–50.
tion. In IEEE Consumer Communications and Networking Conference.
[40] S. Myneni and D. Huang. 2010. IEEE 802.11 Wireless LAN Control Frame Protec-
[41] National Institute of Standards and Technology. 2005. NIST special publication
800-38B, Recommendation for block cipher modes of operation: The CMAC mode
for authentication. US Dept. of Commerce.
[42] National Institute of Standards and Technology. 2008. FIPS 186-4, Digital Signature
Standard (DSS). US Dept. of Commerce.
[43] National Institute of Standards and Technology. 2008. FIPS 198-1, The Keyed-Hash
Message Authentication Code (HMAC). US Dept. of Commerce.
[44] A. Perrig, R. Canetti, J. D. Tygar, and D. Song. 2000. Efficient Authentication
and Signing of Multicast Streams over Lossy Channels. In Proceedings of IEEE
Security and Privacy. 56–73.
[45] D. E. Phillips, M. M. Moazzami, G. Xing, and J. M. Lees. 2017. A Sensor Network for
Real-Time Volcano Tomography: System Design and Deployment. In International
Conference on Computer Communication and Networks (ICCCN). 1–9.
[46] Phillip Rogaway and Yusi Zhang. 2018. Simplifying Game-Based Definitions. In
Advances in Cryptology – CRYPTO 2018 (Lecture Notes in Computer Science), Hovav
Shacham and Alexandra Boldyreva (Eds.). Springer International Publishing, 3–
32.
[47] Markku-Juhani O Saarinen. 2014. Beyond modes: Building a secure record
protocol from a cryptographic sponge permutation. In Cryptographers’ Track at
the RSA Conference. Springer, 270–285.
[48] Guntram Scheible, Dacfey Dzung, Jan Endresen, and Jan Erik Frey. 2007. Un-
plugged But Connected Design and Implementation of a Truly Wireless Real-Time
Sensor/Actuator Interface. Industrial Electronics Magazine, IEEE 1 (02 2007), 25 –
34. https://doi.org/10.1109/MIE.2007.901481
[49] J. Schmandt, A. T. Sherman, and N. Banerjee. 2017. Mini-MAC: Raising the bar for
vehicular security with a lightweight message authentication protocol. Vehicular
Communications (2017), 188 – 196.
[50] H. Schweppe, Y. Roudier, B. Weyl, L. Apvrille, and D. Scheuermann. 2011. Car2X
Communication: Securing the Last Meter - A Cost-Effective Approach for Ensur-
ing Trust in Car2X Applications Using In-Vehicle Symmetric Cryptography. In
2011 IEEE Vehicular Technology Conference ( VTC). 1–5.
Use with IPsec. RFC 4494.
[51] JH. Song, R. Poovendran, and J. Lee. 2006. The AES-CMAC-96 Algorithm and Its
[52] E. Steinbach, S. Hirche, M. Ernst, F. Brandi, R. Chaudhari, J. Kammerl, and I.
Vittorias. 2012. Haptic Communications. Proc. IEEE (2012).
[53] JTC 1/SC 27 IT Security techniques. 2011.
Information technology- Security
techniques - Message Authentication Codes (MACs)- Part 1: Mechanisms using a
block cipher. ISO/IEC.
[54] JTC 1/SC 27 IT Security techniques. 2011.
Information technology- Security
techniques - Message Authentication Codes (MACs)- Part 2: Mechanisms using a
dedicated hash function. ISO/IEC.
[55] Gilles Thonet, Patrick Allard-Jacquin, and Pierre Colle. 2008. Zigbee-wifi coexis-
tence. Schneider Electric White Paper and Test Report (2008).
[56] Yi-Hung Wei, Quan Leng, Song Han, Aloysius K Mok, Wenlong Zhang, and
Masayoshi Tomizuka. 2013. RT-WiFi: Real-time high-speed communication
protocol for wireless cyber-physical control applications. In 2013 IEEE 34th Real-
Time Systems Symposium.