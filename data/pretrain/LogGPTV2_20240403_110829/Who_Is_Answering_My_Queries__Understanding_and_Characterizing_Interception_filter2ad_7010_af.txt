### 4. 影响 DNS 功能的因素

DNSIntercept 可能会影响 DNS 的某些功能，特别是当替代解析器不提供相关支持时。例如，EDNS 客户端子网 (ECS) 请求允许在 DNS 查询中包含发起查询的地址，从而根据客户端的位置返回不同的响应。然而，通过对 205 个公开的替代解析器进行检查，我们发现只有 45 个（占 22%）接受 ECS 请求。

### 7. 缓解措施讨论

目前，几乎所有 DNS 数据包都是以明文形式发送的，这使得它们容易被窥探和篡改。DNS 社区已经注意到这个问题，并发布了 RFC7858 [39] 来解决这一问题，该文件描述了 DNS over Transport Layer Security (TLS) 的规范。不幸的是，DNS over TLS 的部署相当复杂，需要客户端进行更改。因此，这一举措的大规模部署可能需要很长时间。

基于我们的观察，我们开发了一个在线检测工具 [25]，帮助互联网用户检测 DNSIntercept。该工具通过我们自己运营的权威域名服务器来工作。访问我们检测网站的用户会向我们的域名发出 DNS 请求，请求会被我们的权威域名服务器捕获。通过将联系我们域名服务器的解析器与其指定的解析器进行比较，互联网用户能够识别出 DNSIntercept。目前，我们仍在完善这个网站，旨在为用户提供更多关于 DNSIntercept 的信息。然而，现有的解决方案和缓解措施远远不够。安全社区需要提出新的解决方案来应对 DNSIntercept 带来的问题。

### 8. 相关工作

**恶意 DNS 解析器**：攻击者可以构建恶意 DNS 解析器，对 DNS 查找返回错误的响应，从而任意操纵用户的流量。先前的研究表明，动机包括恶意软件分发、审查和广告注入 [38,42]。本文研究了另一种类型的 DNS 流量操纵。

**透明 DNS 代理**：透明 DNS 代理可能会操纵经过的 DNS 流量。首先，网络运营商可以通过将 DNS 查找错误流量重定向到广告来获利 [55,56]。类似地，Chung 等人利用住宅代理网络研究了本地 DNS 服务器上的端到端透明性违规情况，结果显示 4.8% 的 NXDOMAIN 响应被重写为广告服务器地址 [36]。此外，先前的研究表明，18% 的蜂窝网络 DNS 会话通过透明 DNS 代理 [53]，并且生存时间值 (TTL) 被不同对待 [49]。此外，技术博客报道了一些互联网服务提供商使用透明 DNS 代理劫持 DNS 流量的情况 [1, 13, 17, 18]。相比之下，我们的研究集中在路径上的隐藏拦截行为，而不是恶意解析器或 DNS 代理。

**互联网审查**：DNS 协议缺乏认证和完整性检查，因此 DNS 流量操纵已成为一种常见的审查机制，阻止用户访问某些网站。许多国家都部署了 DNS 审查能力，包括中国、巴基斯坦、埃及、伊朗和叙利亚 [28,29,30,31,32,44,45,58]。从全球视角来看，Pearce 等人发现了广泛的 DNS 操纵 [48]，而 Scott 等人在 117 个国家发现了 DNS 劫持 [50]。相比之下，我们在研究中使用的域名是专门注册和使用的，并且避免了任何敏感关键词。因此，我们的研究与审查机制没有重叠。

**其他互联网资源操纵**：此外，研究人员还发现了其他操纵 DNS 流量的方法，包括滥用 DNS 命名空间（即“名称冲突”[34, 35]）、利用配置错误和硬件问题（如拼写错误 [47] 和位翻转 [54]），以及“幽灵域名”[40]。作为与我们最接近的工作，Allman 等人展示了如何检测未经授权的 DNS 根服务器 [27]。然而，只考虑了一种流量操纵类型，并且只发现了有限的案例。我们的研究是对这些现有工作的补充，有助于更好地理解 DNS 生态系统中的安全问题。

与以往的研究相比，我们的工作对 DNSIntercept 进行了系统性和大规模的研究，这是一种尚未得到充分研究的 DNS 行为，并强调了其在安全、隐私和性能方面的问题。

### 9. 结论

本文提出了对 DNSIntercept 的大规模研究，揭示了其带来的安全、隐私和性能问题。我们开发了一系列技术来检测这种隐藏行为，利用两个具有众多观测点的独特平台。基于我们的数据集，我们发现 DNSIntercept 存在于某些自治系统和网络中。此外，我们进一步分析了 DNSIntercept 的拦截特征及其动机。我们的结果表明，隐藏的 DNSIntercept 可能会在 DNS 生态系统中引入新的威胁，需要新的解决方案来应对这一威胁。

### 致谢

感谢我们才华横溢的团队成员 Zihao Jin 在数据处理方面的宝贵工作。感谢 Vern Paxson 教授提供的详细指导和深刻见解。感谢 Xiaofeng Wang、Sumayah Alrwais、Sadia Afroz、Michael C Tschantz 和 Xianghang Mi 提供的有价值的讨论。感谢 Fengpei Li、Zaifeng Zhang、Jinjin Liang、Zhou Pang、Jianjun Chen、Yiming Zhang 和 Jia Zhang 的反馈和帮助。同时感谢我们的牧羊人 Nick Nikiforakis 和所有匿名审稿人的有益建议和评论，以改进本文。

本研究得到了国家重点基础研究计划（资助号 2017YFB0803202）、国家自然科学基金（资助号 61772307, 61472215, U1636204）和 CERNET 创新项目 NGII20160403 的支持。复旦大学作者部分得到了国家自然科学基金（资助号 U1636204）和国家重点基础研究计划（资助号 2015CB358800）的支持。

本文所表达的观点、意见、发现、建议或结论仅代表作者个人，并不一定反映中国政府或奇虎 360 的立场、官方政策或认可。

### 参考文献

[此处列出参考文献]

---

希望以上优化后的文本更加清晰、连贯和专业。如果有进一步的需求或修改，请随时告诉我！