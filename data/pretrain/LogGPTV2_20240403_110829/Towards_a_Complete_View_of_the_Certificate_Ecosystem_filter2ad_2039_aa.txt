title:Towards a Complete View of the Certificate Ecosystem
author:Benjamin VanderSloot and
Johanna Amann and
Matthew Bernhard and
Zakir Durumeric and
Michael Bailey and
J. Alex Halderman
Towards a Complete View of the
Certiﬁcate Ecosystem
Benjamin VanderSloot†
Johanna Amann‡
Matthew Bernhard†
Zakir Durumeric†‡
Michael Bailey§
J. Alex Halderman‡
†University of Michigan ‡International Computer Science Inst.
§ Univ. of Illinois Urbana-Champaign
{benvds, matber, zakir, jhalderm}@umich.edu, PI:EMAIL, PI:EMAIL
ABSTRACT
The HTTPS certiﬁcate ecosystem has been of great inter-
est to the measurement and security communities. Without
any ground truth, researchers have attempted to study this
PKI from a variety of fragmented perspectives, including
passively monitored networks, scans of the popular domains
or the IPv4 address space, search engines such as Censys,
and Certiﬁcate Transparency (CT) logs. In this work, we
comparatively analyze all these perspectives. We ﬁnd that
aggregated CT logs and Censys snapshots have many prop-
erties that complement each other, and that together they
encompass over 99% of all certiﬁcates found by any of these
techniques. However, they still miss 1.5% of certiﬁcates ob-
served in a crawl of all domains in .com, .net, and .org.
We go on to illustrate how this combined perspective affects
results from previous studies. In light of these ﬁndings, we
have worked with the operators of Censys to incorporate CT
log data into its results going forward, and we recommend
that future HTTPS measurement adopt this new vantage.
1.
INTRODUCTION
Nearly all secure web communication takes place over
HTTPS. Both the underlying TLS protocol and the sup-
porting certiﬁcate public key infrastructure (PKI) have been
studied extensively over the past ﬁve years, with questions
ranging from understanding the behavior of certiﬁcate au-
thorities [11, 14] to detecting server-side vulnerabilities and
tracking how quickly they are mitigated [7, 10, 28].
Such measurements are difﬁcult to conduct well, since
there is no comprehensive set of trusted certiﬁcates or of
HTTPS websites—no ground truth for studying this ecosys-
Permission to make digital or hard copies of part or all of this work for personal
or classroom use is granted without fee provided that copies are not made or
distributed for proﬁt or commercial advantage and that copies bear this notice
and the full citation on the ﬁrst page. Copyrights for third-party components of
this work must be honored.
IMC 2016 November 14–16, 2016, Santa Monica, CA, USA
c(cid:13) 2016 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-4526-2/16/11.
DOI: http://dx.doi.org/10.1145/2987443.2987462
tem. Instead, researchers have attempted to gain visibility into
it using various fragmentary perspectives—such as scanning
the IPv4 address space [12], querying popular Alexa domains,
passively monitoring network trafﬁc [3], and querying Cer-
tiﬁcate Transparency (CT) logs [20, 21]. Each methodology
provides an imperfect view of the world, yet there has been
little work to analyze how they differ or how they might be
combined to piece together a more comprehensive picture.
Consider, for example, the different perspectives provided
by CT logs and the Censys search engine [8], two widely
used sources of certiﬁcate data. CT is designed to enable
auditing of trusted certiﬁcates by recording them in publicly
veriﬁable logs. While this may someday provide a complete
view of the certiﬁcate ecosystem, at present, publishing cer-
tiﬁcates to CT logs is voluntary in most cases. In contrast,
Censys provides a public database of certiﬁcates collected
by actively scanning the IPv4 address space and Alexa Top
Million domains. Although IPv4 scanning might seem to
promise an exhaustive view of certiﬁcates in use on the pub-
lic Internet, it misses several important cases, including those
served exclusively over IPv6. IP-based scanning also cannot
provide the TLS Server Name Indication (SNI) header [13],
which speciﬁes the requested domain name and is necessary
when a server hosts multiple sites from a single IP address.
In this work, we comparatively analyze the certiﬁcates seen
by eight measurement perspectives: (1) a Censys certiﬁcate
snapshot, (2) an exhaustive IPv4 scan on TCP/443, (3) a scan
of Alexa Top Million domains, (4) a snapshot of public CT
Logs, (5) a scan of domains contained in these CT logs, (6) a
scan of domains contained in the .com, .net, and .org zone
ﬁles [30], (7) a scan of domains from the Common Crawl
dataset [6], and (8) certiﬁcates passively observed by the ICSI
SSL Notary using passive network monitoring [3].
Combining these datasets, we observe nearly 17 million
unique browser-trusted certiﬁcates that were valid during our
measurement interval, August 29 to September 8, 2016. Of
these, 90.5% appeared in public CT logs and 38.0% were
seen by Censys. To understand this difference, we investigate
the impact of SNI by attempting connections to 30 million
domains extracted from certiﬁcates in CT logs. Only 35%
of domains that accepted a connection with SNI offered the
same certiﬁcate when SNI was not used. This places an
543Perspective
CT Logs
Censys Snapshot
CT Scan
IPv4 HTTPS Scan
.com, .net, .org zones
Common Crawl
Alexa Top 1M
ICSI Notary
“Universe”
Valid
Certiﬁcates
15,374,936
6,448,588
6,419,584
3,760,360
2,436,425
1,258,886
288,670
256,869
16,989,236
Exclusive
Certiﬁcates
6,830,849
609,773
54,225
637
31,195
1,154
0
3,805
29,967,065
14,495,436
20,967,351
8,209,465
11,892,649
6,177,985
1,907,256
2,040,138
— 32,454,062
FQDNs
Sites Description
Scan of all FQDNs in CT logs
Certiﬁcates in the well known CT logs
12,202,712
4,817,530 Database of IPv4 and Alexa Top 1M scan results
9,153,162
2,926,766 HTTPS scan of all IPv4 addresses
5,669,024 Root and www. names in .com, .net, and .org
2,885,466
Scan of domains crawled by Common Crawl
917,259 HTTPS scan of Alexa Top Million domains
916,612 Observed in passive network trafﬁc inspection
12,673,515
Certiﬁcates in any of the perspectives above
Table 1: Certiﬁcate Perspectives—We compare eight distinct perspectives on the universe of valid certiﬁcates, spanning six
measurement techniques. Certiﬁcate Transparency (CT) is the largest perspective, including many certiﬁcates only seen in CT.
upper bound on the certiﬁcates observable by IP-based scan-
ning. Combining data from Censys and CT covers 99.4%
of all trusted certiﬁcates seen by any perspective we studied,
and may closely approximate the public HTTPS ecosystem.
However, as the vast majority of the certiﬁcates in our data
originate from these two sources, this number is suspect. To
better validate the fraction of certiﬁcates visible with these
perspectives, we consider certiﬁcates seen by scanning do-
mains from the .com, .net, and .org zone ﬁles, and ﬁnd
that the union of CT logs and Censys contains 98.5% of them.
Based on these results, we recommend that researchers
performing future HTTPS measurements use a combination
of data published in CT logs and Censys-style IPv4 scanning.
To facilitate this, we are working with the operators of Censys
to implement synchronization between Censys and CT logs.
Going forward, Censys will continuously incorporate certiﬁ-
cate data from public CT logs in its results and publish newly
discovered certiﬁcates back to Google CT logs, making either
data source a strong foundation for studying the certiﬁcate
ecosystem.
2. CERTIFICATE PERSPECTIVES
In order to compare techniques for measuring certiﬁcates,
we conducted six kinds of scans and analyzed two existing
datasets. Table 1 summarizes these perspectives, which we
describe in detail below.
Certiﬁcate Transparency Logs.
Certiﬁcate Transparency (CT) aims to allow public audit-
ing of trusted certiﬁcates [21]. Anyone can submit valid
certiﬁcates to CT log servers, which record them in cryp-
tographically veriﬁable public ledgers. Although there is
no universal requirement for submission, Google records
all certiﬁcates seen in its web crawls to CT logs. Chrome
requires all issuers submit extended validation (EV) certiﬁ-
cates to at least two logs [5]. Chrome recently mandated
that Symantec certiﬁcates signed after June 1, 2016, be sub-
mitted to be trusted as well [26]. Several CAs voluntarily
log all certiﬁcates they issue, notably Let’s Encrypt [23] and
StartCom [27].
We retrieved the certiﬁcates stored in twelve well-known
CT logs on September 8, 2016. These logs are operated by
Google (“Pilot”, “Aviator”, “Rocketeer”, and “Submariner”),
Digicert, StartCom, Izenpe, Symantec, Venaﬁ, WoSign, CN-
NIC, and Shengnan GDCA.
Censys Certiﬁcate Snapshot.
The Censys search engine [8] publishes daily snapshots of
all the certiﬁcates it indexes. Censys collects certiﬁcates by
exhaustively scanning the IPv4 address space without SNI,
and by connecting to all Alexa Top Million domains with SNI.
Our perspective is based on the September 8, 2016 snapshot.
Scan of FQDNs from CT.
We extracted the fully qualiﬁed domain names (FQDNs)
from all certiﬁcates in our CT log snapshots, covering the
common name (CN) and subject alternative name (SAN)
ﬁelds. We then used ZGrab [8] to attempt an HTTPS connec-
tion to each domain, with SNI enabled. The scan ran from
the University of Michigan on August 29 and September 6
and 8, 2016.
IPv4 HTTPS Scan.
We used the ZMap suite [12] to scan the IPv4 address
space for HTTPS servers listening on TCP/443. The scan
took place on August 29, 2016, from the University of Michi-
gan. For each listening host, we attempted a TLS handshake
and recorded the presented certiﬁcate chain. Since these
connections were based on IP addresses rather than domain
names, they did not include the SNI header.
Authoritative Zone Files.
We attempted HTTPS handshakes with all domains in the
authoritative zone ﬁle [30] for .com, .net, and .org do-
mains, for both the base domain and the www subdomain.
(Since the TLD zone ﬁles contain only the name server en-
tries for each domain, we learn only the base domain name.)
We ran these scans using ZGrab on August 29 and Septem-
ber 2, 2016, from the University of Michigan. There were
153 million unique domains in these zone ﬁles, and we com-
pleted 42 million successful HTTPS handshakes to the base
domains, and 40 million successful HTTPS handshakes to
the www subdomains. While we connected to many domains,
the certiﬁcates served were often only valid for the hosting
provider’s domain name and not the scanned domain.
544Common Crawl.
The Common Crawl project [6] aims to perform a regular,
complete crawl of public websites. We processed the January
2016 crawl and extracted 28.9 million unique domains. We
used ZGrab to attempt an HTTPS connection to every domain
on September 3, 2016, from the University of Michigan.
Alexa Top Million HTTPS Scan.
We used the ZMap suite to attempt connections to the
Alexa Top Million domains. The scan took place on Septem-
ber 3, 2016, from the University of Michigan. For each listen-
ing host, we attempted a TLS handshake with SNI enabled
and recorded the presented certiﬁcate chain.
ICSI SSL Notary.
The SSL Notary dataset consists of daily Internet trafﬁc
from approximately 180,000 users at ﬁve North American
academic or research institutions [3]. We analyzed 2.2 billion
TLS connections on TCP/443 from July 29 to August 29,
2016, extracting a total of 635,314 certiﬁcates. We excluded
incomplete connections as well as HPC, Grid, and Tor cer-
tiﬁcates, resulting in 386,051 certiﬁcates, of which 256,869
were trusted by the Mozilla NSS root store.
Due to a nondisclosure agreement that limited our internal
data sharing, Notary certiﬁcates are not included in cases
where we consider the union of all perspectives. This reduces
the size of the union by 0.02%.
In total across all these perspectives, we discovered 17 mil-
lion unique certiﬁcates that were valid and trusted by the
Mozilla NSS root store. Since the different datasets contain
somewhat different temporal perspectives, we consider cer-
tiﬁcates to be valid only if their date ranges cover our entire
collection period, August 29 to September 8. By constraining
our data in this way, we ensure that no data source contains
certiﬁcates that would be invalid in another data source due
to the time when the certiﬁcates were validated.
2.1 Ethical Considerations
For our active scanning, we honored the University of
Michigan’s institutional blacklist to exclude endpoints that
previously requested not to be scanned. We also followed the
best practices deﬁned by Durumeric et al. [12]; we refer to
that work for more discussion of the ethics of active scanning.
Passive data collection was cleared by the responsible parties
at each contributing institution. The ICSI SSL Notary stores
connection metadata (e.g., certiﬁcate and cipher information)
without collecting any connection payload.
3. RESULTS