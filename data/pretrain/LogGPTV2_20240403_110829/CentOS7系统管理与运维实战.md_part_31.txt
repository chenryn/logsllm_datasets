include_once("connect.php"):
该页面主要负责获取更新后的数据并更新到数据库中，详细代码如【示
数据库连接成功
用户信息修改
地址
用户名
地址
海霞
图7.8修改记录页面
type="submit"
第7章搭建LNMP服务
name
value
211
---
## Page 224
CentOS7系统管理与运维实战
212
链接应该将当前记录的主键传到更新页面users_delete.php。完整的代码如【示例7-25】所示。
节代码在7.4.4节中的users_page.php 基础上进行修改，主要是添加删除记录需要的超链接，
7.4.7
失败”，可根据此信息判断修改结果。
如果要删除数据库中的记录，首先获取当前记录的主键，然后在数据库中查找并删除。
【示例7-25】
此页面如果更新记录成功，则显示“记录修改成功”；如果修改失败，则显示“记录修改
13
删除记录
26
25
22
20
19
18
17
2
13
4
用户信息查询
else
include once("connect.php"):
str>
return false;
else
ifconfirm(”真的要删除当前记录吗？
/tr>
用户信息查询
size="40#
return
return false;
form. txt keyword.focus();
deleteCh
操作
地址
用户名
用户ID
true;
&id=没有查询到符合条件的记录!";
where
uname
96
95
93
8
8
71
9
9
99
G
8
8
a.uname like
stxt _keyword' order by id asc limit Soffset, Spage_size"）
sj=soffset+l;
Scount=mysql num_rows( Srs):
Stotal count=mysql result(srs
Squery="select count(*) as c from
while(
if(scount=
Si=l;
if ($page=
Snum=0;
exit;
echo
Spage=l;
stxt
?>
Ka href=users_delete.php?page= onclick="return deleteCheck()">删除
?>>修改&nbsp;
Srow
ecno
mysqI
sj++ ?>
id,uname,address from BBs.users
?>
count,O,"c");
&nbsp;";
，总记录条
运行效果如图7.9所示，地址栏显示了超链接的内容。
118
115
113
112
111
110
109
108
106
120
119
105
104
102
101
100
99
strs
当前第2页，总共4页，总记录11条
用户信息查询
序号
if(spage当前第页，总共首页&nbsp;";
内蒙古
深圳
北京
地址
首页上一页下一页尾页
修改删除
修改
操作
删除
删除
第7章搭建LNMP服务
keyword>
215
---
## Page 228
216
除操作，删除相关的代码如【示例7-26】所示。
出“确认”对话框要用户确认是否真的删除，如图7.10所示。
Centos7系统管理与运维实战
【示例7-26】
经过以上步骤删除记录需要的主键ID已经加入到超链接中，点击对应的超链接后，会弹
[rooteCentOs BBS]# cat
N
#
include("users_page.php");
else
//获取当前记录的ID
echo"";
<?php
else
if(squery)
echo“ID不能为空!"：
echo”记录删除失败”
echo”记录删除成功”
-nusers_delete.php
图7.10记录删除确认对话框
ierosoft Internet Explorer 
确定
真的要册除当前记录吗？
取消
---
## Page 229
Nginx+PHP+MySQL的应用。
和PHP的两种集成方式，最后通过实现数据库表的增、删、改、查功能，介绍了
绍LNMP涉及的相关软件的安装与管理，然后介绍了Nginx的虚拟主机配置，接着介绍Nginx
LNMP（Linux+Nginx+MySQL+PHP）是一种应用比较广泛的Web服务架构。本章首先介
小小结
第7章搭建LNMP服务
217
---
## Page 230
器负载过高。同时负载均衡是一种动态均衡，可以通过一些工具或软件实时地分析数据包，掌
花费的经济成本相对可以承受。
而提供24小时不间断的服务。相对于高端服务器的昂贵成本，使用廉价的设备组成集群，所
用，响应依然快速。集群可以允许部分硬件或软件发生故障，通过集群管理软件将故障屏蔽从
高可用性集群和高性能集群。
量数据中找出有价值的信息，时间是必须考虑的因素。集群技术的出现顺利解决了这两种问题：
不断增强，随着用户量的增长需要更强的CPU和IO处理能力。在数据挖掘领域，需要在大
间断服务，如发生硬件损坏导致服务中断将造成不可挽回的经济损失。越来越多的网站交互性
#示
Server）的负载调度算法，并结合各种调度算法给出实际案例。
单台计算机难以达到用户的需求。为了满足急剧增长的需求，使用集群技术负载均衡迫在眉睫。
挑战，网络带宽的增长远高于处理器速度和内存访问速度的增长，急剧膨胀的用户请求已经使
发展，单台计算机的性能和可靠性越来越高，网络的飞速发展给网络带宽和服务器带来巨大的
高可用性集群可以提供负载均衡，通过把任务轮流分给多台服务器完成，以避免某台服务
集群通过一组相对廉价的设备实现服务的可伸缩性，当服务请求急剧增长时，服务依然可
如今互联网应用尤其是Web 服务已经越来越广泛。电子商务网站需要提供每天24小时不
本章首先介绍什么是集群技术及集群的体系结构，然后介绍集群软件LVS（LinuxVirtual
本章主要涉及的知识点有：
电子商务已经成为生活中不可缺少的一部分，给用户带来方便和效率。随着计算机硬件的
LVS负载均衡的安装与设置
LVS负载均衡调度算法
Linux集群体系结构
本章介绍的LVS负载均衡管理主要针对Linux系统下的负载均衡，在Windows 领域软件
层面尚没有匹配的开源软件支持负载均衡。
集群技术简介
集群
8章
---
## Page 231
8.2.13种负载均衡技术
服务器称作real server，简称rs，从而使得服务器集群的结构对应用是透明的。应用访问集群
的体系结构如图8.1所示。
中国的章文嵩博士给出了基于IP层和基于内容请求分发的负载平衡调度解决方案，并在Linux
8.2
除故障的节点，从而使系统达到高可用性。
务集群中动态地加入和删除服务器节点完成。通过定期检测节点或服务进程状态可以动态地剔
系统提供的网络服务就像访问一台高性能、高可用的服务器一样。集群的扩展性可以通过在服
内核实现，将一组服务器构成一个实现可伸缩的、高可用网络服务的虚拟服务器。虚拟服务器
握网络中的数据流量状况，合理分配任务。
（LoadBalancer），有时简称为LD。负载均衡器负责将网络请求调度到真实服务器上，真实的
在LVS 框架中，提供了IP虚拟服务器软件（IPVS），包含3种IP负载均衡技术，通过此
一组服务器通过高速的局域网或地理分布的广域网相互连接，前端有一个负载均衡器
均衡算法。
子商务网站，IP读写频繁的数据库应用，网络传输量大的视频服务则各自有对应的负载
IP地址的分配方式将数据分配到多个节点。对于不同的应用环境，如计算负荷较大的电
比如在数据链路层可以根据数据包的MAC地址选择不同的路径。网络层则可以利用基于
LVS集群介绍
互联网/企业网
虚拟服务
图8.1虚拟服务器体系结构
用户
均衡
第8章集群