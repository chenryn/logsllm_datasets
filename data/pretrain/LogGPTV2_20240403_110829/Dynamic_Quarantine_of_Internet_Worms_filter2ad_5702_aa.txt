title:Dynamic Quarantine of Internet Worms
author:Cynthia Wong and
Chenxi Wang and
Dawn Xiaodong Song and
Stan Bielski and
Gregory R. Ganger
Dynamic Quarantine of Internet Worms
Cynthia Wong, Chenxi Wang
∗
†
, Dawn Song, Stan Bielski, Gregory R. Ganger
{cindywon, chenxi, dawnsong, bielski, ganger}@cmu.edu
Carnegie Mellon University
Abstract
If we limit the contact rate of worm trafﬁc, can we al-
leviate and ultimately contain Internet worms? This paper
sets out to answer this question. Speciﬁcally, we are inter-
ested in analyzing different deployment strategies of rate
control mechanisms and the effect thereof on suppressing
the spread of worm code. We use both analytical models
and simulation experiments. We ﬁnd that rate control at in-
dividual hosts or edge routers yields a slowdown that is lin-
ear in the number of hosts (or routers) with the rate lim-
iting ﬁlters. Limiting contact rate at the backbone routers,
however, is substantially more effective—it renders a slow-
down comparable to deploying rate limiting ﬁlters at every
individual host that is covered. This result holds true even
when susceptible and infected hosts are patched and immu-
nized dynamically. To provide context for our analysis, we
examine real trafﬁc traces obtained from a campus comput-
ing network. We observe that rate throttling could be en-
forced with minimal impact on legitimate communications.
Two worms observed in the traces, however, would be sig-
niﬁcantly slowed down.
1. Introduction
Since the original “Internet worm” [3] in 1988, computer
worms continue to wreak havoc on the Internet. The recent
SQL Slammer worm infected over 90% of the vulnerable
hosts on the Internet within ten minutes [10]. With such
voracity, the manual patch-’em-as-they-go approach simply
does not work. We need automated detection and response
to defend against worm outbreaks.
One class of techniques that seems promising is rate
control—schemes that aim to limit the contact rate of worm
trafﬁc [5, 17]. Since worms typically spread at a rapid speed
∗
†
This work was partially supported by the National Science Foundation
under Grant No. CCR-0208853 and ANI-0326472.
This research is partially sponsored by the Air Force Research Labo-
ratory, under agreement number F49620-01-1-0433.
from host to host, restricting the contact rate of a worm con-
strains how fast the infection can spread in the network.
Previous proposals of rate control consider deploying such
mechanisms primarily at the individual host level. In this
paper, we investigate rate control at individual end hosts and
at the edge and backbone routers, for both random propaga-
tion and local-preferential connection worms. Our analysis
shows that both host and edge-router based rate control re-
sult in a slowdown (in the spreading rate of the worm) that
is linear to the number of hosts (routers) implementing the
rate limiting ﬁlter. In particular, host-based rate control has
very little beneﬁt unless rate limiting ﬁlters are universally
deployed. Rate control at the backbone routers, however, is
substantially more effective. Our results hold true for both
random propagation worms (e.g., Code Red I) and worms
that spread via a preferential connection algorithm such as
those that target local hosts within a subnet.
Results are similar when dynamic immunization is taken
into account. As the worm spreads and the knowledge of
the worm disseminates, an increasing number of hosts (both
infected and susceptible) will be patched, immunized and
consequently removed from the susceptible population. In
an effort to study realistic worm attacks, the models in this
paper incorporate dynamically changing the immunization
rates. This is in contrast to the traditional models for which
the rate of immunization remains constant throughout the
infection outbreak [7, 16, 2, 6, 15].
To provide context for the models, we examine trafﬁc
traces obtained from a sizable campus computing network.
We observe that limiting the rate of unique IP addresses
contacted (as in [17]) from the edge of the departmental net-
work to no more than 16 (total contacts) per ﬁve-second pe-
riod would almost never affect legitimate trafﬁc. Individual
host rates can be kept to under four per ﬁve-second period.
Limiting only non-DNS-translated IP address contacts [5]
can reduce the contact rate by another factor of 2 – 4. Our
traces also captured the behavior of machines infected by
two worms: Welchia and Blaster. The results conﬁrm that
infected machines exhibit much higher contact rates and
could be dramatically slowed by rate limiting.
Combining practical rate limits with our models allows
us to estimate how well such approaches might work in
Proceedings of the 2004 International Conference on Dependable Systems and Networks (DSN’04) 
0-7695-2052-9/04 $ 20.00 © 2004 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 10:03:30 UTC from IEEE Xplore.  Restrictions apply. 
practice. For instance, to secure an enterprise network from
worms that propagate using a local-preferential connection
algorithm, our study shows that unless rate limiting ﬁlters
are deployed at both the edge routers and a certain percent-
age of the end hosts, little beneﬁt will be gained.
The remainder of this paper is organized as follows. Sec-
tion 2 describes related work. Section 3 gives a brief back-
ground in epidemiological models. Sections 4 and 5 study
deployment strategies of rate limiting schemes. Section 6
incorporates dynamic immunization with rate control, and
Section 7 presents a case study of real network traces. We
summarize in section 8.
2. Related work
Several documented studies
investigated computer
worms and the ways in which they propagate. Stani-
ford et al. presented a study of different types of worms
and how they can cause damage on the Internet [13].
Zou et al. [19] analyzed the propagation of the Code Red
worm and presented an analytic model for worm propa-
gation; Moore et al. [10] analyzed the propagation of the
Slammer worm and its effect on the Internet. These stud-
ies have not analyzed defense mechanisms in great depth.
Moore et al. [11] explored the design space for worm
containment systems. They studied the efﬁcacy of address
blacklisting and content ﬁltering with various deployment
scenarios. They concluded that detection and containment
must be initiated within minutes for such systems to be ef-
fective. Singh et al. [12] proposed a system for real-time de-
tection of unknown worms using trafﬁc analysis and content
signatures. Zou et al. [18] proposed to monitor unused ad-
dress space on ingress and egress routers to detect worms at
their early propagation stage.
Our work differs from previous works in that we focus
on analysis of rate control. As we demonstrate in Sections 5
and 6, rate control mechanisms can be extremely effective
in curtailing worm spread if deployed correctly.
The primary contribution of our work is the analysis
of different deployment strategies for rate control mecha-
nisms. Williamson [17] proposed the idea of host-based rate
limiting by restricting the number of new outgoing connec-
tions. Ganger et al. [5] proposed a scheme that analyzes and
limits network trafﬁc based on abnormal DNS lookup pat-
terns. Both of these schemes are host based and did not ex-
plore other deployment options.
3. Background—epidemiological models
In this section we brieﬂy introduce one class of epidemi-
ological models, namely homogeneous models. Homoge-
neous models are widely used in the studies of human infec-
tions. A homogeneous model assumes homogeneous mix-
ing among the individuals in the population [1, 8]; that is,
every individual has equal contact to every one else in the
population. This assumption is similar to the ways in which
random propagation worms spread in computer networks.
This model is described in more detail in [1]. A homoge-
neous model assumes a connected network with N nodes. It
also assumes an average infection rate β across all links. If
we represent total number of infected nodes at time t as It, a
deterministic time evolution of I (infected hosts) can be ob-
tained as below,
dIt
dt
= βIt(N − It/N )
(1)
The solution to Equation (1) is I/N = eβt
c+eβt , where c
is a constant. c is determined by the initial infection level.
c → N − 1 when the initial infection level is low, since the
fraction of infected hosts will be small.
From this we can see that the infection grows exponen-
tially initially and reaches saturation after a certain point.
The time takes to reach a certain infection level α is
.
= lnα/β
t
(2)
The analytical models described in the later parts of this
paper are derived from the basic homogeneous model and
share the same assumptions.
4. Rate Limiting
In this section, we present a study on rate limiting mech-
anisms as a defense to combat the propagation of Inter-
net worms. Rate limiting is a mechanism by which an el-
ement in the network can restrict the rate of communication
with other elements. Since worms spread rapidly via fast
connections to uninfected machines, rate limiting can help
suppress the propagation of the worm. A number of rate
limiting schemes have been proposed in the literature, in-
cluding Williamson’s virus throttle [17] and Ganger’s DNS
based scheme [5]. However, it is not known precisely how
and where rate control mechanisms should be deployed in a
network. Clearly, instrumenting rate control on every indi-
vidual node in a network is expensive administratively and
hence not feasible. The question then becomes: are there al-
ternative deployment strategies that can yield a more desir-
able effect than others?
We believe that the answer to this question is yes. In
this section we illustrate the effect of different deployment
strategies using a star graph topology. Consider a star graph
where a central hub node is connected to all the leaf nodes.
We analyze two deployment scenarios: a) rate control at a
certain percentage of the leaf nodes, and b) rate control at
the center hub node only. Note that a star topology is very
different from the Internet’s topology and the study of a star
topology is mainly for demonstration of the difference from
deployment at leaf and hub nodes.
Deployment at leaf nodes: Assume we deploy rate lim-
iting ﬁlters at q percent of the leaf nodes. Let x1 = I(1− q)
Proceedings of the 2004 International Conference on Dependable Systems and Networks (DSN’04) 
0-7695-2052-9/04 $ 20.00 © 2004 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 10:03:30 UTC from IEEE Xplore.  Restrictions apply. 
d
e
t
c
e
n
f
i
s
e
d
o
n
f
t
o
e
g
a
n
e
c
r
e
P
1
0.8
0.6
0.4
0.2
0
0
Analytical Model for rate limiting (RL) on a Star Graph
No RL
10% Leaf Nodes RL
30% Leaf Nodes RL
Hub Node RL
5
10
15
20
25
30
35
40
45
50
(a) Analytical model of infection evolution
Time
Rate Limiting (RL) on a 200 node Star Graph (simulation)
1
0.8
0.6
0.4
0.2
d
e
t
c
e
f
n
i
s
e
d
o
n
f
o
t
e
g
a
n
e
c
e
r
P
0
0
No RL
10% Leaf Nodes RL
30% Leaf Nodes RL
Hub Node RL
5
10
15
20
25
30
35
40
45
50
(b) Simulated infection evolution
Time
Figure 1. Plots showing the differences between vari-
ous rate-limiting deployment mechanisms on a 200-node
star topology
be the number of infected nodes that are not conﬁned by
the ﬁltering mechanism, x2 = Iq the number of infected
nodes with the ﬁlter mechanism, β1 the contact rate of the
infected host without the ﬁlter, and β2 the contact rate al-
lowed by the ﬁlter, with β1 >> β2.
We obtain the time evolution of the infection as below,
= x1β1(N − I)/N + x2β2(N − I)/N
dI
dt
(3)
Solving Equation (3) gives us I/N = eλt
c+eλt , where λ =
qβ2 + (1 − q)β1. When β1 >> β2 and eλt is small,
.= β1(1 − q). From this, we can derive that the time t
λ
to reach a certain infection level α is t = lnα/(β1(1 − q)).
That is, the rate of infection is proportional to 1− q, the per-
centage of nodes that do not have rate limiting ﬁlters. Com-
paring to Equation (2), we can see that deploying rate lim-
iting ﬁlters at the leaf nodes yields a linear slowdown that
is proportional to the number of nodes that have rate con-
trol.
Deployment at hub: When deploying rate control at the
center hub node, we need to consider both node-level and
link-level rate limiting. Assume we deploy rate limiting at
the hub node with rate β and link rate limiting with rate γ.
When β ≥ γI — the contact rate at the hub node is greater
than the combined contact rate of infected leaf nodes —
then γI is the primary limiting factor for infection propaga-
tion. Otherwise, the propagation is limited by the hub node
contact rate, β.
For link-level rate limiting (this is when the contact rate
at the hub node is higher than the combined contact rates of
all the infected leaf nodes), we have
= γI(N − I)/N, when γI ≤ β
dI
dt
(4)
Solving Equation (4) gives us
I/N = eγt
c + eγt
, when γI ≤ β
For node rate limiting (this is when the combined contact
rates of the infected leaf nodes exceeds the hub node con-
tact rate), we have
= β(N − I)/N, when γI > β
dI
dt
(5)
Solving Equation (5) gives us
I/N = 1 − ce−βt/N , when γI > β
From the solution to Equation (4), we can derive that the
.= N(ln(α))/β.
time t to reach an infection level α is t
Compared to rate control at the leaf nodes, this suggests a
slowdown that is comparable to installing rate control ﬁlters
at all of the leaf nodes — in which case t = ln(α)/β2. In-
deed, the graph in Figure 1(a), which plots both leaf-node
and hub-node rate control on a 200-node star topology, in-
dicates exactly that. Figure 1(b) shows simulated propaga-
tions on the same topology.
In our simulation, we limited the links to 10 packets per
second with the hub rate limit β = 0.01. The simulation re-
sults are an average of ten simulation runs. For leaf-node
rate control, we simulated rate limiting at 10% and 30% of
the leaf nodes. As shown in Figure 1(b), rate limiting at 10%
of the leaf nodes has neligible impact. Rate limiting at 30%
of the leaf nodes results in a slight slowdown of the infec-
tion rate. Rate control at the hub node is signiﬁcantly more
effective. For instance, reaching a level of 60% infection
with rate limiting at 30% of the leaf nodes is approximately
three times quicker than rate limiting at the hub. These re-
sults conﬁrm our analytical model.
This simple but illustrative example shows that deploy-
ment strategies have a signiﬁcant impact on the effective-
ness of rate control schemes. On the Internet, we can de-
ploy rate control at end hosts, edge routers, and backbone
routers. In the next section we investigate each of these de-
ployment cases.
Proceedings of the 2004 International Conference on Dependable Systems and Networks (DSN’04) 
0-7695-2052-9/04 $ 20.00 © 2004 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 10:03:30 UTC from IEEE Xplore.  Restrictions apply. 
5. Deploying rate control on the Internet
5.2. Rate limiting at edge routers
In this section we investigate three different ways of de-
ploying rate limiting schemes on the Internet: on individual