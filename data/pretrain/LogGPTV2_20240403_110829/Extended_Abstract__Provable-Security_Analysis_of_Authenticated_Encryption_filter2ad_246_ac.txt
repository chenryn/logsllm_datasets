Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:53:14 UTC from IEEE Xplore.  Restrictions apply. 
plaintextciphertextzerostagpadconfounderplaintextconfounderpadplaintextENCRYPTCHECKSUMENCODE2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007that decoding is unambiguous), picks a random confounder
$← {0, 1}n, computes Me ← conf k M and
of n bits conf
Mt ← conf k 0l k M and returns (Me, Mt). Dec on input
Me parses it as confkM, computes Mt ← confk0lkM
and returns (M, Mt). Then Construction 3.1 describes the
general proﬁle of authenticated encryption in Kerberos7.
As we noted in the Introduction the recommended instantia-
tions with DES and MD4 or MD5 are not good choices. But
we point out that using AES and a collision-resistant hash
function will not necessarily solve the problem. The rea-
son is that the underlying Encode-then-MAC-then-Encrypt
construction does not provide integrity in general, even if it
is based on secure primitives.
Theorem 3.3 Let EC = (E nc, Dec) be the encoding
scheme from Construction 3.2.
There exists an IND-
CPA secure secure encryption scheme and a collision-
resistant hash function so that
the authenticated en-
cryption obtained via Encode-then-MAC-then-Encrypt
(Construction 3.1) does not provide integrity (is not INT-
CTXT secure.)
The proof is in the full version of this paper [15] . In fact, the
proof also shows that the general construction is insecure
even when a secure MAC is used, but in this case the attack
makes use of a rather artiﬁcial IND-CPA scheme. We note
that the attacks we provide in the proof does not translate
into an attack on any of the recommended options. It just
shows a limitation in the general design.
We now look at a more speciﬁc Construction 3.2 and
show that it can nevertheless provide security in the strong
sense, if a modiﬁcation that does not require signiﬁcant
changes to the protocol is made. Namely we suggest to use
a secure MAC in place of the hash function and show that
the resulting authenticated encryption scheme is secure.
Construction 3.4 [Modiﬁed general proﬁle] The con-
struction is like Construction 3.2, except that MAC =
(Km,T ) is a message authentication code.
Theorem 3.5 The authenticated encryption scheme de-
scribed by the modiﬁed general proﬁle (Construction 3.4)
is IND-CCA and INT-CTXT secure if the underlying block
cipher is a PRF and the MAC is UF-CMA secure.
The proof with concrete security results is in [15] . AES
that is believed to be a PRF, and HMAC that is proven to be
UF-CMA secure if its underlying hash function is collision
resistant [8], constitute good instantiations for the above de-
sign.
SIMPLIFIED PROFILE. Designers of Kerberos had the right
intuition that the general proﬁle’s design is not particularly
7Our analysis does not take into account stateful approaches for key
derivation used in few options of general proﬁle.
strong and proposed a new design that they call “simpliﬁed
proﬁle” (cf. Section 5 in [22] and [21]). Again we start with
a more general construction that outlines the design.
Construction 3.6 [Encode-then-Encrypt&MAC]
Let
SE = (Ke,E,D), MAC = (Km,T ), EC = (E nc, Dec)
be an encryption scheme, a MAC and an encoding
scheme such that
the outputs of the encoding scheme
are compatible with inputs to E,T . The corresponding
Encode-then-Encrypt&MAC scheme SE0 = (K0,E0,D0) is
deﬁned as follows.
• K0 runs Ke,Km and returns their outputs Ke k Km.
• E0 on inputs Ke k Km and M ﬁrst gets the encodings
It then computes C $←
via (Me, Mt)
EKe(Me), σ ← TKm(Mt) and returns C k σ.
• D0 on inputs Ke k Km and C k σ computes Me ←
DKe(C), decodes (M, Mt) ← Dec(Me), computes
σ0 ← TKm(Mt) and returns M if σ = σ0, and ⊥ oth-
erwise.
$← E nc(M).
The next construction deﬁnes the simpliﬁed proﬁle in more
detail and Figure 2 depicts the design.
Figure 2. Simpliﬁed proﬁle.
Construction 3.7 [Authenicated encryption in Ker-
beros. Simpliﬁed proﬁle] Let E : {0, 1}k × {0, 1}n →
{0, 1}n be a block cipher (e.g. AES). Let SE = (Ke,E,D)
be the CBC encryption mode with IV = 0n.
Let
MAC = (Km,T ) be a MAC, let EC = (E nc, Dec) be
an encoding scheme such that E nc on input M pads M
to make its length multiple of n bits (while permitting
unambiguous decoding), picks a random confounder of
$← {0, 1}n, computes Me ← conf k M and
n bits conf
Mt ← conf k M and returns (Me, Mt). Dec on input Me
parses it as confkM, computes Mt ← Me and returns
(M, Mt). Then Construction 3.6 describes the simpliﬁed
proﬁle of authenticated encryption in Kerberos.
We now formally conﬁrm that the simpliﬁed proﬁle pro-
vides strong security guarantees.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:53:14 UTC from IEEE Xplore.  Restrictions apply. 
tagintermediate ciphertextplaintextplaintextpadconfounderciphertextENCRYPTMACENCODE2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007Theorem 3.8 The authenticated encryption scheme de-
scribed by the simpliﬁed proﬁle (Construction 3.7) is IND-
CCA and INT-CTXT secure if the underlying block cipher
is a PRF and the MAC is a PRF.
The proof with concrete security results is in [15]. AES is
believed to be a PRF and HMAC was proven to be a PRF
[7], therefore they are the right choices of instantiations for
the simpliﬁed proﬁle.
4 Acknowledgments
We thank Ken Raeburn and Sam Hartman for clariﬁca-
tions on Kerberos speciﬁcations, Bogdan Warinschi for use-
ful discussions, the anonymous reviewers for their helpful
comments, and Anupam Datta for comments on the prelim-
inary draft. Alexandra Boldyreva is supported in part by
NSF CAREER award 0545659.
References
[1] M. Backes, I. Cervesato, A. D. Jaggard, A. Scedrov, and J.-
K. Tsay. Cryptographically sound security proofs for basic
and public-key Kerberos. In ESORICS ’06. Springer, 2006.
[2] M. Backes and B. Pﬁtzmann. Symmetric encryption in a
simulatable Dolev-Yao style cryptographic library. In CSFW
’04. IEEE, 2004.
[3] M. Backes, B. Pﬁtzmann, and M. Waidner. A composable
In CCS ’03.
cryptographic library with nested operations.
ACM, 2003.
[4] M. Backes, B. Pﬁtzmann, and M. Waidner. Symmetric au-
In
thentication within a simulatable cryptographic library.
ESORICS ’03. Springer, 2003.
[5] G. Bella and L. C. Paulson. Kerberos version 4: Inductive
In ESORICS ’98. Springer,
analysis of the secrecy goals.
1998.
[6] G. Bella and E. Riccobene. Formal analysis of the Kerberos
authentication system. Journal of Universal Computer Sci-
ence, 3(12):1337–1381, 1997.
[7] M. Bellare. New proofs for NMAC and HMAC: Security
without collision-resistance. In CRYPTO, 2006.
[8] M. Bellare, R. Canetti, and H. Krawczyk. Keying hash func-
tions for message authentication. In CRYPTO ’96. Springer,
1996.
[9] M. Bellare, A. Desai, E. Jokipii, and P. Rogaway. A concrete
security treatment of symmetric encryption. In FOCS ’97.
IEEE, 1997.
[10] M. Bellare, J. Kilian, and P. Rogaway. The security of
the cipher block chaining message authentication code. In
CRYPTO ’04. Springer, 2004.
[11] M. Bellare, T. Kohno, and C. Namprempre. Authenticated
encryption in SSH: provably ﬁxing the SSH binary packet
protocol. In CCS ’02. ACM, 2002.
[12] M. Bellare and C. Namprempre. Authenticated encryption:
Relations among notions and analysis of the generic compo-
sition paradigm. In ASIACRYPT ’00. Springer, 2000.
[13] M. Bellare and P. Rogaway. Encode-then-encipher encryp-
tion: How to exploit nonces or redundancy in plaintexts for
efﬁcient cryptography. In ASIACRYPT ’00. Springer, 2000.
[14] S. M. Bellovin and M. Merritt. Limitations of the Kerberos
authentication system. SIGCOMM Comput. Commun. Rev.,
20(5):119–132, 1990.
[15] A. Boldyreva and V. Kumar. Provable-security analysis of
authenticated encryption in Kerberos. Full version of this pa-
per. Available at http://www-static.cc.gatech.
edu/∼aboldyre/publications.html, 2007.
[16] F. Butler, I. Cervesato, A. D. Jaggard, and A. Scedrov. A
Formal Analysis of Some Properties of Kerberos 5 Using
MSR. In CSFW ’02. IEEE, 2002.
[17] F. Butler, I. Cervesato, A. D. Jaggard, A. Scedrov, and
C. Walstad. Formal Analysis of Kerberos 5 Using. In Theo-
retical Computer Science, 2006.
[18] J. T. Kohl. The use of encryption in Kerberos for network
authentication (invited). In CRYPTO ’89. Springer, 1989.
[19] T. Kohno.
Searchable symmetric encryption:
Improved
deﬁnitions and efﬁcient constructions. UCSD Dissertation,
2006.
[20] C. Neuman, T. Yu, S. Hartman, and K. Raeburn. The Ker-
beros network authentication service (v5). Network Working
Group. Request for Comments: 4120. Available at http:
//www.ietf.org/rfc/rfc4120.txt, 2005.
[21] K. Raeburn. Advanced encryption standard (AES) encryp-
tion for Kerberos 5. Network Working Group. Request
for Comments: 3962. Available at http://www.ietf.
org/rfc/rfc3962.txt, 2005.
[22] K. Raeburn. Encryption and checksum speciﬁcations for
Kerberos 5. Network Working Group. Request for Com-
ments: 3961. Available at http://www.ietf.org/
rfc/rfc3961.txt, 2005.
[23] S. G. Stubblebine and V. D. Gligor. On message integrity
in cryptographic protocols. In Symposium on Security and
Privacy ’92. IEEE, 1992.
[24] X. Wang, D. Feng, X. Lai, and H. Yu. Collisions for hash
functions MD4, MD5, HAVAL-128 and RIPEMD. ePrint
Archive: Report 2004/199, 2004. Available at http://
eprint.iacr.org/.
[25] T. D. Wu. A real-world analysis of Kerberos password secu-
rity. In NDSS ’99. The Internet Society, 1999.
[26] T. Yu. The Kerberos network authentication service (version
5). IETF Internet draft. Request for Comments: 1510, 2006.
[27] T. Yu, S. Hartman, and K. Raeburn. The perils of unauthen-
ticated encryption: Kerberos version 4. In NDSS ’04. The
Internet Society, 2004.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:53:14 UTC from IEEE Xplore.  Restrictions apply. 
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007