I got weird problem with Celery. Shortly after start each pool worker dies
with one of these two exception traces:
    [2012-09-03 16:11:42,326: WARNING/MainProcess] Process PoolWorker-6:
    [2012-09-03 16:11:42,326: WARNING/MainProcess] Traceback (most recent call last):
    [2012-09-03 16:11:42,327: WARNING/MainProcess] File "/mnt/nimble/eggs/billiard-2.7.3.12-py2.7-linux-x86_64.egg/billiard/process.py", line 273, in _bootstrap
    [2012-09-03 16:11:42,327: WARNING/MainProcess] self.run()
    [2012-09-03 16:11:42,327: WARNING/MainProcess] File "/mnt/nimble/eggs/billiard-2.7.3.12-py2.7-linux-x86_64.egg/billiard/process.py", line 122, in run
    [2012-09-03 16:11:42,327: WARNING/MainProcess] self._target(*self._args, **self._kwargs)
    [2012-09-03 16:11:42,327: WARNING/MainProcess] File "/mnt/nimble/eggs/billiard-2.7.3.12-py2.7-linux-x86_64.egg/billiard/pool.py", line 302, in worker
    [2012-09-03 16:11:42,328: WARNING/MainProcess] put((ACK, (job, i, time.time(), pid)))
    [2012-09-03 16:11:42,328: WARNING/MainProcess] File "/mnt/nimble/eggs/billiard-2.7.3.12-py2.7-linux-x86_64.egg/billiard/queues.py", line 377, in put
    [2012-09-03 16:11:42,329: WARNING/MainProcess] return send(obj)
    [2012-09-03 16:11:42,329: WARNING/MainProcess] IOError: [Errno 32] Broken pipe
or
    [2012-09-03 15:21:45,071: WARNING/MainProcess] Process PoolWorker-11:
    [2012-09-03 15:21:45,072: WARNING/MainProcess] Traceback (most recent call last):
    [2012-09-03 15:21:45,072: WARNING/MainProcess] File "/mnt/nimble/eggs/billiard-2.7.3.12-py2.7-linux-x86_64.egg/billiard/process.py", line 273, in _bootstrap
    [2012-09-03 15:21:45,072: WARNING/MainProcess] self.run()
    [2012-09-03 15:21:45,072: WARNING/MainProcess] File "/mnt/nimble/eggs/billiard-2.7.3.12-py2.7-linux-x86_64.egg/billiard/process.py", line 122, in run
    [2012-09-03 15:21:45,072: WARNING/MainProcess] self._target(*self._args, **self._kwargs)
    [2012-09-03 15:21:45,073: WARNING/MainProcess] File "/mnt/nimble/eggs/billiard-2.7.3.12-py2.7-linux-x86_64.egg/billiard/pool.py", line 314, in worker
    [2012-09-03 15:21:45,073: WARNING/MainProcess] put((READY, (job, i, (False, einfo))))
    [2012-09-03 15:21:45,073: WARNING/MainProcess] File "/mnt/nimble/eggs/billiard-2.7.3.12-py2.7-linux-x86_64.egg/billiard/queues.py", line 377, in put
    [2012-09-03 15:21:45,073: WARNING/MainProcess] return send(obj)
    [2012-09-03 15:21:45,073: WARNING/MainProcess] IOError: [Errno 32] Broken pipe
This problem disappears when launching Celery with --concurrency=1, but that's
kind of poor workaround.  
Celery report for my machine looks like this:
    software -> celery:3.0.9 (Chiastic Slide) kombu:2.4.5 py:2.7.3
                billiard:2.7.3.12 pymongo:2.1.1
    platform -> system:Linux arch:64bit, ELF imp:CPython
    loader   -> celery.loaders.default.Loader
    settings -> transport:mongodb results:mongodb
I was able to track the problem down to CELERYD_MAX_TASKS_PER_CHILD option in
configuration file. After removing it Celery started working as expected.
Looks like some multiprocessing issue with main process loosing track of
rotating workers.