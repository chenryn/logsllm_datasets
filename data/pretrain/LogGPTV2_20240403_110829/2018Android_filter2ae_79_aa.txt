# 2018年Android恶意软件专题报告
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
## 摘要
  * 2018年全年，360互联网安全中心共截获移动端新增恶意软件样本约434.2万个，平均每天新增约1.2万个。全年相比2017年（757.3万个）下降了约42.7%。
  * 2018全年移动端新增恶意软件类型主要为资费消耗，占比高达63.2%；其次为隐私窃取（33.7%）、恶意扣费（1.6%）、流氓行为（1.2%）、远程控制（0.3%）。
  * 2018全年，360互联网安全中心累计监测移动端恶意软件感染量约为1.1亿人次，相比2017年（2.14亿人次）感染量下降48.6%，平均每日恶意软件感染量约为29.2万人次。
  * 2018全年从地域分布来看，恶意软件感染量最多的省份为广东省，占全国感染量的8.2%；其次为北京（7.2%）、山东（6.5%）、河南（6.4%）江苏（6.1%）等。感染量最多的城市为北京，占全国城市的7.2%；其次是重庆（2.2%）、广州（1.6%）、成都（1.3%）、南京（1.3%）。位居Top10的城市还有东莞、呼和浩特、石家庄、上海、哈尔滨。
  * 2018年恶意软件使用了多种新技术，分别是利用调试接口感染传播，首次出现Kotlin语言开发的恶意软件，劫持路由器设置，篡改剪切板内容，滥用Telegram软件协议，恶意软件适配高版本系统以及针对企业和家庭的网络代理攻击。
  * 2018年移动高级威胁方面，360烽火实验室监测到的公开披露的APT报告中，涉及移动相关的APT报告23篇。被提及次数最多的被攻击国家依次是韩国、以色列、巴基斯坦、巴勒斯坦、伊朗、叙利亚和印度。
  * 2018年移动高级威胁主要围绕在亚太和中东地区，涉及朝韩半岛、克什米尔地区，巴以冲突地区。除此以外，还体现了部分国家内部动荡的政治局势。
  * 2018年移动平台黑灰产业生态，根据结构划分为流量获取分发、流量变现盈利和数据信息安全三个方面。
  * 2018年度CVE Details报告显示，Android系统以611个漏洞位居产品漏洞数量榜前列，与2017年842个相比略有减小，下降27.4%，与2016年相比增加16.6%
  * 截止2018年10月，Google发布的Android系统版本分布统计，Android Nougat（Android 7.0/7.1）达到28.2%，占比第二的是Android Oreo（Android 8.0/8.1）总占比已达21.5%，而最新系统版本Android 9 Pie不足0.1%。
  * 系统厂商自律定期更新开发者策略，政府监管处置各类违法违规应用，警企协同打击网络犯罪，共建大安全生态环境。
  * 从移动威胁趋势上看，5G时代到来物联网安全问题凸显，基于内容的诈骗活动将越来越活跃，虚拟货币价格虽然降低但攻击仍将继续，社交网络下的新型传播方式以及数据泄露推动隐私全球立法，这五个方面将成为未来的主要趋势。
关键词：移动安全、恶意软件、高级威胁、黑灰产业、威胁趋势
## 总体态势
###  一、恶意软件新增量与类型分布
2018年全年，360互联网安全中心共截获移动端新增恶意软件样本约434.2万个，平均每天新增约1.2万个。全年相比2017年（757.3万）下降了约42.7%。自2015年起，恶意软件新增样本量呈逐年下降趋势。
图1.1 2012-2018年移动端新增恶意软件数量情况
2018年新增恶意软件整体呈现上半年、下半年较低的态势。其中3月份新增量最多，约50.0万个恶意软件，第四季度中新增样本量均较低。
图1.2 2018年移动端各月新增恶意移动端样本数分布情况
2018全年移动端新增恶意软件类型主要为资费消耗，占比高达63.2%；其次为隐私窃取（33.7%）、恶意扣费（1.6%）、流氓行为（1.2%）、远程控制（0.3%）。
图1.3 2018年移动端新增恶意软件类型分布情况
###  二、恶意软件感染量分析
2018全年，360互联网安全中心累计监测移动端恶意软件感染量约为1.1亿人次，相比2017年（2.14亿人次）感染量下降48.6%，平均每日恶意软件感染量约为29.2万人次。
从七年的移动端恶意软件感染量对比看，经过2012-2015年的高速增长期，2016年起呈现逐年下降趋势，恶意软件发展逐渐平稳。
图1.4 2012-2018年移动端恶意软件感染量对比情况
2018年移动端新增恶意软件感染量的按季度对比情况来看，总体呈下降趋势。四季度新增量最低，仅约52.4万个。
全年来看，2018年四个季度的感染量总体呈下降趋势；其中一季度最高约为3437.3万人次，四季度感染量最少，仅约2057.1万人次。
图1.5 2018年移动端新增恶意软件感染量按季度对比情况
###  三、恶意软件感染量地域分析
2018全年从地域分布来看，恶意软件感染量最多的省份为广东省，占全国感染量的8.2%；其次为北京（7.2%）、山东（6.5%）、河南（6.4%）和江苏（6.1%）。此外河北、浙江、四川、黑龙江、江西的恶意软件感染量也排在前列。
图1.6 2018年恶意软件感染量TOP10省级分布情况
恶意软件感染量最多的城市为北京，占全国城市的7.2%；其次是重庆（2.2%）、广州（1.6%）、成都（1.3%）、南京（1.3%）。位居Top10的城市还有东莞、呼和浩特、石家庄、上海、哈尔滨。
图1.7 2018年恶意软件感染量TOP10城市分布情况
## 盘点恶意软件的新技术
###  一、利用调试接口传播
adb是连接Android设备与PC端的桥梁，可以让用户在电脑上对设备进行全面的操作，是Android系统为方便软件开发者提供的一种调试接口，一般情况下软件开发人员是通过启用USB调试选项来使用这种接口的。但事实上，这种接口可以直接绑定到网络端口上。一旦被绑定到网络端口，攻击者就可以在不借助物理接触的前提下，远程操作Android设备。
今年2月，360安全团队监测到全球首个Android平台挖矿蠕虫ADB.Miner[1]。ADB.Miner利用了Android设备上的5555
端口，5555 端口是Android设备上adb调试接口的工作端口，正常状态下应该处于关闭状态，但未知原因导致部分设备错误打开了该端口。
ADB.Miner蠕虫摆脱了通过短信、垃圾邮件等社交诱骗的传播方式，而是直接从adb接口感染和传播。另外，adb接口功能相当丰富，其中文件上传功能及Shell指令为蠕虫的繁殖和运行提供了便利。在传播中，ADB.Miner复制了MIRAI中SYN扫描模块的代码，试图加速对5555端口开放情况的探测过程，以便提高传播速度。
图2.1 端口5555上的扫描流量正在快速增长
###  二、Kotlin语言开发的恶意软件首现
Kotlin[2]是一个用于现代多平台应用的静态编程语言, 2017年5月Google宣布Kotlin正式成为Android官方支持开发语言。
Kotlin特点简洁，大大减少了样板代码的数量；安全，因为它避免了诸如空指针异常之类的整个类错误；互操作性，充分利用JVM，Android和浏览器的现有库；并且工具友好，可用任何
Java IDE 或者使用命令行构建。
2018年1月，安全厂商发现首个以Kotlin编程语言开发的恶意软件[3]，该恶意软件不仅能够执行远程命令，窃取信息，模拟点击广告，它还可以在未经许可的情况下为用户订阅付费短信业务。
图片来自https://blog.trendmicro.com/trendlabs-security-intelligence/first-kotlin-developed-malicious-app-signs-users-premium-sms-services/
图2.2 使用Kotlin开发的恶意软件的包结构
###  三、劫持路由器设置
路由器被入侵的可能性大致分为两种。一种是使用路由器本身的漏洞攻击，另一种是通过路由器管理功能所设置的弱认证信息非法登录。
早在2016年12月，就曾出现了劫持路由器DNS设置的Switcher[4]恶意软件家族，恶意软件即会利用一份预置好的包含25种默认登录名与密码的列表，在路由器的管理员Web界面中执行密码暴力破解。如果破解尝试成功后，木马会导航至WAN设置选项并设置不法犯罪分子控制的流氓DNS作为主DNS服务器。
2018年3月，日本媒体报道了大量日本用户的路由器DNS设置被劫持，将用户重定向到恶意IP地址，导致用户手机下载安装了伪装成Facebook和Chrome更新的XLoader[5]恶意软件，恶意行为包括窃取隐私、网站钓鱼、挖矿等。截至目前，攻击者已经将目标语言从4种扩展到27种，包括欧洲和中东语言，平台也从Android覆盖到iOS、PC平台。
图片来自https://blog.trendmicro.com/trendlabs-security-intelligence/xloader-android-spyware-and-banking-trojan-distributed-via-dns-spoofing/
图2.3 XLoader感染链
###  四、篡改剪切板内容
在使用手机时经常会用到剪切板功能，通过小小的剪贴板在各种APP之间传递和共享信息。我们发现由于剪切板功能简单，使用时也不需要申请额外的权限，导致被恶意利用，在复制粘贴过程中暗藏玄机。
2018年伊始，我们发现羊毛党篡改剪贴板以非正常方式传播支付宝的吱口令，通过支付宝的红包活动赚取红包赏金。我们将信息及时反馈给支付宝，在新一期的赚取赏金活动中支付宝调整了策略，限制了邀请方式和邀请次数。
10月，我们监控到利用剪切板盗取比特币（Bitcoin）钱包的恶意软件[6]。通过监控用户手机剪贴板中的内容来判断是否是加密数字货币的钱包地址，如果是钱包地址则替换成从服务器得到的攻击者的钱包地址。当用户把复制的钱包地址粘贴到转账地址栏的时候，原先的钱包地址已经被木马替换成了攻击者的钱包地址，造成用户的财产损失。
图2.4 2018年移动端篡改剪切板恶意软件每月新增数量
###  五、滥用Telegram软件协议
从去年开始出现利用Telegram软件协议的木马，今年有更多的恶意软件作者开始滥用Telegram软件协议。滥用Telegram软件协议的IRRAT和TeleRAT[7]恶意软件家族接连被曝光，并且还出现了与之前使用Telegram
Bot API方式不同的HeroRat[8]恶意软件家族，它使用了名为Telesharp[9]的开源项目，它可以使用C#语言创建Telegram
Bot，目前这个开源项目已经不再维护。
图2.5 TeleSharp开源项目功能介绍
###  六、恶意软件适配高版本系统
在2016年年度报告中，我们提到界面劫持技术被大量用在钓鱼软件和勒索软件。虽然Google在Android
5.0系统及以上版本限制了获取栈顶Activity的获取方法，减弱了这种攻击方式。但当时由于Android
5.0以下版本仍然有一定的市场占有率，低版本手机仍然可能遭受到这种威胁。
2018年Google已经发布了Android 9 Pie，经过两年的发展Android
5.0以上系统已经占据主导地位。纵观Google在Android系统安全方面的更新，每一版本都在遏制恶意软件方面做出了积极应对，这使得界面劫持技术变得更加困难。
2018年6月，我们发现MysteryBot[10]恶意软件家族开始适配高版本系统，它通过诱导用户授予APP Device
Administrator和AccessibilityService权限，而后滥用Usage Access权限。Usage
Access权限可以获取一个时间段内的应用统计信息，按照使用时间排列后，即可获取当前最顶层的APP。
图片来自https://www.threatfabric.com/blogs/mysterybot__a_new_android_banking_trojan_ready_for_android_7_and_8.html
图2.6 MysteryBot请求Usage Access权限
###  七、企业和家庭网络攻击进阶
针对企业和家庭内网的攻击，继DressCode[11]、MilkyDoor[12]恶意软件家族后，今年又出现了利用移动设备攻击内网的新的恶意软件家族TimpDoor[13]。TimpDoor通过短信进行网络钓鱼，诱导用户下载安装虚假APP，将受感染的Android设备转变为移动网络代理，允许不法分子加密访问内部网络，给企业和家庭内部网络带来巨大安全风险。
家族名称
|
DressCode
|
MilkyDoor
|
TimpDoor  
---|---|---|---  
曝光时间
|
2016年8月
|
2017年4月
|
2018年10月  
传播方式
|