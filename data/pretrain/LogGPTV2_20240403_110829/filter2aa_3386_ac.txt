AcRons	
  on	
  Ads	
  (clicks/purchases)	
• 
IP	
  address	
• 
Browser	
  informaRon	
Google	
  Takeout	
  does	
  NOT	
  work	
  with	
  history	
Google	
  Chrome:	
  search	
  &	
  browsing	
  history	
What	
  Google	
  knows	
  about	
  you	
Page 26 
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Android	
  device	
  backups	
What	
  Google	
  knows	
  about	
  you	
Page 27 
• 
Google	
  Calendar	
  sedngs	
• 
Wi-­‐Fi	
  networks	
  &	
  password	
• 
Home	
  screen	
  wallpapers	
• 
Gmail	
  sedngs	
• 
Apps	
  installed	
  through	
  Google	
  Play	
• 
Display	
  sedngs	
• 
Language	
  &	
  Input	
  sedngs	
• 
Date	
  &	
  Time	
• 
3rd	
  party	
  app	
  sedngs	
  &	
  data	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Google	
  Photos	
  (aka	
  PicasaWeb,	
  aka	
  Google+	
  Photos)	
What	
  Google	
  knows	
  about	
  you	
Page 28 
•  Albums/events	
•  Commants	
•  Geo	
  tags	
•  SubscripRons	
•  View	
  counters	
•  People	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Android	
  device	
  backups	
  -­‐	
  downloading	
What	
  Google	
  knows	
  about	
  you	
Page 29 
IBackupTransport	
  (com.android.internal.backup	
  in	
  GoogleBackupTransport.apk)	
No	
  source	
  code	
  provided;	
  works	
  with	
  hPps://android.googleapis.com/backup	
Authen;ca;on:	
  h\ps://android.clients.google.com/auth	
• 
Get	
  refresh	
  token	
  (input:	
  email,	
  password)	
• 
Get	
  authenRcaRon	
  token	
  (input:	
  refresh	
  token)	
Get	
  info	
  on	
  backups	
  available:	
  h\ps://android.googleapis.com/backup	
• 
Input:	
  android_id,	
  authenRcaRon	
  token)	
• 
Output	
  (array)	
• 
Android_id	
• 
Backup	
  creaRon	
  date/Rme	
• 
Date/Rme	
  of	
  device	
  registraRon	
  on	
  account	
• 
Device	
  name	
  or	
  model	
• 
SDK	
  version	
• 
Last	
  acRvity	
  date/Rme	
Download	
  backup:	
  h\ps://android.clients.google.com/backup	
•  Input:	
  android_id,	
  package	
  to	
  restore	
  (download),	
  Auth	
•  Output	
  (array	
  of	
  strings):	
•  pm	
  (general	
  info	
  on	
  applicaRons)	
•  android	
  (wallpaper:	
  xml	
  +	
  picture)	
•  com.android.nfc	
•  com.android.providers.sedngs	
  (including	
  Wi-­‐Fi	
  passwords!)	
•  com.android.vending	
•  com.google.android.talk	
•  com.google.android.googlequicksearchbox	
•  com.google.android.calendar	
•  com.google.android.inputmethod.laRn	
•  com.google.android.gm	
Android	
  M	
•  Get	
  system	
  backup	
  (@pm@):	
  hbps://android.clients.google.com/googlefood/backup	
•  Get	
  backups	
  on	
  parRcular	
  apps:	
  returns	
  package	
  name,	
  download	
  URL	
  (on	
  Google	
  Drive)	
•  AuthenRcate	
  on	
  Google	
  Drive:	
  hbps://android.clients.google.com/auth	
New	
  auto-­‐backups	
  for	
  applica,on	
  data;	
  stored	
  on	
  Google	
  Drive	
  as	
  .tar	
  archives	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Google	
  Hangouts	
What	
  Google	
  knows	
  about	
  you	
Page 30 
h\ps://accounts.google.com/ServiceLogin?hl=en-­‐US&Email={email}	
Set-­‐Cookie:	
  GAPS=1:iv-­‐YjJ,lF-­‐coJ0RpCZhlmMBj97IRA:RKppYacKUG4PUMNX	
Set-­‐Cookie:	
  GALX=mItW3iafLoo;Path=/;Secure	
h\ps://accounts.google.com/ServiceLoginAuth	
  HTTP/1.1	
Cookie:	
  GoogleAccountsLocale_session=en;	
  GAPS=[…];	
  GALX=[…]&Email={email}&Passwd={password}	
Set-­‐Cookie:	
  NID=[...]	
  SetCookie:	
  SID=[...]	
  Set-­‐Cookie:	
  LSID=[...]	
Set-­‐Cookie:	
  HSID=[...]	
  Set-­‐Cookie:	
  SSID=[...]	
  Set-­‐Cookie:	
  APISID=[...]	
  Set-­‐Cookie:	
  SAPISID=[...]	
GET	
  h\ps://talkgadget.google.com/u/0/talkgadget/_/chat?{parameters}	
Cookie:	
  NID=[...];	
  HSID=[...];	
  SSID=[...];	
  SID=[...];	
  APISID=[...];	
  SAPISID=[...]	
Set-­‐Cookie:	
  S=talkgadget=VlFAZCxwB-­‐G_h53WWt_g6Q	
To	
  get	
  conversaRon	
  (dialog):	
h\ps://clients6.google.com/chat/v1/conversa;ons/getconversa;on?alt=protojson&key=API_KEY	
Cookie:	
  NID=[...];	
HSID=[...];	
  SSID=[...];	
  SID=[...];	
APISID=[...];	
  [...]	
AuthorizaRon:SAPISIDHASH	
  {hash}	
(SAPISIDHASH:	
  SHA-­‐1(Rmestamp+SAPISID+URL)	
•  Dialog	
  data	
  (id,	
  inviteTime,	
  acRvatedTime)	
•  ParRcipants'	
  data	
  (id,	
  name,	
  avatarUrl)	
•  Events	
  (Message,	
  AddUser,	
  RemoveUser,	
  SentPhoto,	
  VideoCall,	
  LocaRon)	
•  Date/Rme	
•  Info	
  on	
  video	
  call:	
  date/Rme	
  (start+end)	
•  Text	
•  LocaRons	
  (address,	
  mapUrl,	
  laRtude,	
  longRtude)	
•  Picture	
  (photoUrl,	
  width,	
  height,	
  album_name)	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
POST	
  hbps://history.google.com/history/?jspb=1&max=1435697999999999	
  HTTP/1.1	
max=1435697999999999	
  (in	
  milliseconds	
  since	
  01.01.1970)	
Headers:	
  Accept:	
  */*	
  Accept-­‐Language:	
  ru,en-­‐US;q=0.8,en;q=0.6	
  ConnecRon:	
  keep-­‐alive	
  Host:	
  history.google.com	
  Cookie:	
  cookie	
  (obtained	
  a0er	
  auth-­‐n,	
  includes	
  auth.	
  token)	
To	
  get	
  results	
  in	
  English,	
  add	
  to	
  the	
  Cookie:	
  PREF=ID=1111111111111111:FF=0:LD=en;	
YouTube	
  watch	
  history	
hbps://history.google.com/history/youtube/watch?jspb=1&max=1394034083520660	
Or	
Use	
  YouTube	
  API	
hbps://developers.google.com/youtube/v3/docs/	
YouTube	
  search	
  history	
hbps://history.google.com/history/youtube/search?jspb=1&max=1422545631282456	
Obtaining	
  Google	
  Chrome	
  history	
What	
  Google	
  knows	
  about	
  you	
Page 31 
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
AuthenRcate:	
hbps://www.googleapis.com/auth/drive	
Get	
  ﬁle	
  list:	
GET	
  hbps://www.googleapis.com/drive/v2/ﬁles?key={YOUR_API_KEY}	
(pretend	
  to	
  be	
  Chromium)	
Returns:	
•  Download	
  URL	
•  ID	
•  Parent	
  ID	
•  If	
  “Shared	
  with	
  me”	
•  Owner	
•  Access	
  rights	
•  File	
  name	
•  File	
  size	
•  DescripRon	
•  ProperRes	
Google	
  Drive	
What	
  Google	
  knows	
  about	
  you	
Page 32 
Detailed	
  ‘list’	
  request:	
GET	
  hbps://www.googleapis.com/drive/v2/ﬁles?	
maxResults={MAX_RESULT}&pageToken={PAGE_TOKEN}&ﬁelds={FIELDS}&key={YOUR_API_KEY}	
{PAGE_TOKEN}	
  –	
  page	
  token	
{MAX_RESULT}	
  number	
  of	
  ﬁles	
  in	
  response	
{FIELDS}	
  ﬁelds	
  to	
  return	
To	
  get	
  info	
  on	
  parRcular	
  ﬁle,	
  set	
  its	
  ID	
  in	
  the	
  request,	
  provide	
  parameters:	
hbps://developers.google.com/drive/v2/reference/ﬁles/get	
Get	
  ﬁle	
  meta	
  data:	
GET	
  hbps://www.googleapis.com/drive/v2/ﬁles/ﬁleID?key={YOUR_API_KEY}	
Download	
  ﬁle:	
GET	
  hbps://www.googleapis.com/drive/v2/ﬁles/ﬁleID?alt=media	
Search	
  by	
  ﬁle	
  owner:	
hbps://www.googleapis.com/drive/v2/ﬁles?q=not+'{your_email_address}'+in+owners	
hbps://www.googleapis.com/drive/v2/ﬁles?q='{your_email_address}'+in+owners	
Academia	
  Sinica,	
  Nankang,	
  Taipei	
  AUG	
  28-­‐29,	
  2015	
www.elcomso0.com	
Picasa	
  Web	
  Albums	
  Data	
  API	
(use	
  Oauth2	
  to	
  get	
  token)	
hbps://developers.google.com/picasa-­‐web/docs/2.0/developers_guide_protocol	
Get	
  albums	
  list:	
GET	
  hbps://picasaweb.google.com/data/feed/api/user/{userId}	
(userId	
  =	
  default	
  to	
  get	
  own	
  photos;	
  AuthorizaRon:	
  token)	
Get	
  own	
  album(s):	
GET	
  hbps://picasaweb.google.com/data/feed/api/user/{USER_ID}/albumid/{ALBUM_ID}?kind=photo&[..]	
(returns	
  full	
  properRes	
  of	
  every	
  album)	
Get	
  circles:	
POST	
  hbps://clients6.google.com/rpc/plusi?key=[..]	
(returns	
  circles,	
  friends:	
  email,	
  contactId,	
  obfuscatedGaiaId,	
  displayName)	
GET	
  hbps://picasaweb.google.com/data/feed/api/user/{USER_ID}/albumid/{ALBUM_ID}?kind=comment&[..]	
Returns:	
•  gphoto:id	
  (own	
  id)	
•  gphoto:photoid	
•  authorId	
•  published	
•  updated	
•  Rtle	
•  content	
Google	
  Photos	
What	
  Google	
  knows	
  about	
  you	