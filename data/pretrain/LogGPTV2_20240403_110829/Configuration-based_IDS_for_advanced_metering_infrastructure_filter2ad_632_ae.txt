and fourth order markov chain is shown in Figure 8(c) and
(d), respectively. It can be clearly observed that both the
markovian orders increase the state space exponentially with
the increase in number of meters. More speciﬁcally, the third
and fourth order markov chains can work up to 108 and 16
meters, respectively.
Since many vendors (including our smart grid provider
collaborator) use 8−16 smart meters per collector, we found
that using the fourth order markov chain is the optimal
choice to maximize accuracy. We also found that many ma-
jor vendors use similar limited number of meters per col-
lector due to limited bandwidth or coverage, in power line
communication and WiFi, respectively [1, 7]. However, ven-
dors might support diﬀerent models of the AMI technologies
that oﬀer diﬀerent capacity of handling meters. For exam-
ple, some smart grid providers/vendors plan to use other
technologies that can support hundreds of meters per col-
lector [7].
For this reason, we discuss two approaches that oﬀer much
more scalable solution but with reasonable accuracy sacri-
ﬁcing. First, third order markov chain can be used since
it also incurs a low conditional entropy as shown in Figure
2(b). Moreover, it shows acceptable prediction accuracy,
with slightly more false predictions as compared to fourth
order as shown in Figure 6(b). Second, we alternatively ex-
tend the fourth order markov chain approach to handle more
meters by state compression. Moreover, logs can also be di-
vided based on the group of meters (16 in each) to conduct
the analysis.
460i
t
t
s
e
a
S
n
a
h
C
v
o
k
r
a
M
4
x 10
2
1.8
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0
0
200
400
600
800
1000
Meters
(a) First Order
i
t
t
s
e
a
S
n
a
h
C
v
o
k
r
a
M
9
x 10
10
9
8
7
6
5
4
3
2
1
0
0
1000
2000
3000
4000
5000
Meters
i
t
t
s
e
a
S
n
a
h
C
v
o
k
r
a
M
9
x 10
11
10
9
8
7
6
5
4
3
2
1
0
0
20
40
60
Meters
80
100
(b) Second Order
(c) Third Order
Figure 8: Meters vs Number of States
i
t
t
s
e
a
S
n
a
h
C
v
o
k
r
a
M
12
10
8
6
4
2
0
9
x 10
2
4
6
8
10
12
14
16
Meters
(d) Fourth Order
It can be seen from Figure 3(d) that very few (only tens of)
states are highly likely (high probability) out of 1000. Thus,
eventually less than 10% states are seen more frequently
than others. Therefore, once the graph is made using Al-
gorithm 1, we run a compression algorithm to remove the
nodes having lower probability. We run the detection ac-
curacy using the compressed model and note that it incurs
an increase in the false positive rate i.e., from 0.2% to 0.3%
while maintaining the same detection accuracy. However,
the compressed state model can easily scale to more than
1000 meters per collector. Choosing the appropriate alter-
native approach depends on the AMI network technology
under consideration.
7.5 Limitations
In this section we discuss the limitations of the proposed
approach
• The original fourth order markov chain based approach
only scales up to 16 meters per collector.
In actual,
a smart collector may have higher number of meters
associated with it. To combat this, we discussed an al-
ternative in the scalability section which supports up-
to 1000 meters per collector while incurring a slight
increase in false alarm rate. Moreover, the original
approach can also be used by dividing a smart collec-
tor’s log into multiple chunks based on the groups of
smart meters. Each chunk may have up to 16 meters
grouped into it. This can easily be done by ﬁltering
the log based on the meter id.
• Attacks which do not involve communication with a
smart collector will not be detected. However, we be-
lieve that the eﬀect of such attacks would be limited
to a particular area i.e., not large scale.
• Evasion robustness relies on the key used for interval
randomization. We assume that the key is secured
and attacker can not access it. However, if the key is
compromised, attacker can evade the detection algo-
rithm by generating traﬃc at the expected time inter-
vals (calculated by key) using the conﬁgurations known
to the attacker.
• Since AMI uses static conﬁgurations with limited pro-
tocols and applications, communication patterns do
not change. Therefore, re-training is not required.
However, if the re-training data, for any reason such as
concept-drifting, includes malicious activities, attack-
ers may evade the proposed technique. We see this is
unlikely to happen if the retraining is performed on
large number of smart collectors.
• The technique provides robustness against evasion, how-
ever, an attacker that has full access to and complete
knowledge of the AMI may still be able to evade it.
8. CONCLUSION
In this work, we present a fourth order markov chain based
model for intrusion detection since it incurs lower condi-
tional entropy and higher prediction accuracy. Moreover, it
ﬁts the state space requirement of the AMI network un-
der consideration. The novelty of the model lies in the
conﬁguration-based stochastic modeling of the AMI using
the logs collected at smart collector and device conﬁgura-
tion. Moreover, considering the challenges of AMI network,
the proposed approach is practical since it does not require
high computation power and memory in the ﬁeld. However,
it can also work oﬄine in the substation by pulling the smart
collector logs from the area. Therefore, it is ﬂexible and in-
curs low cost. However, if smart collectors provide enough
computation and memory, it can be deployed in parallel. It
also does not need to be trained, unlike traditional intrusion
detectors. The model provides acceptable detection accu-
racy of more than 95% with false alarm rate close to 0.2%.
The model can be easily extended and customized based on
the AMI network under consideration using other informa-
tion in the logs and conﬁgurations. Therefore, the scope is
not limited to what is presented here.
Acknowledgments
This work is a result of joint collaborative eﬀort with a lead-
ing smart grid based utility provider. The work was done as
part of the urban city project initiated by the utility provider
which monitors several buildings for data analysis. We ap-
preciate their expertise, eﬀort in creating an AMI testbed in
our university for testing, and sharing the data.
9. REFERENCES
[1] Ambient communication nodes.
http://www.ambientcorp.com/prod-nodes/.
[2] Baier, C., and Katoen, J. P. Principles of Model
Checking. The MIT Press, 2008.
[3] Baumeister, T. Literature review on smart grid
cyber security. Tech. rep., Department of Information
and Computer Sciences, University of Hawaii, 2010.
[4] Berthier, R., and Sanders, W. Speciﬁcation-based
intrusion detection for advanced metering
infrastructures. In IEEE 17th Paciﬁc Rim
International Symposium on Dependable Computing
(PRDC) (2011).
461[5] Berthier, R., Sanders, W., and Khurana, H.
Intrusion detection for advanced metering
infrastructures: Requirements and architectural
directions. In First IEEE International Conference on
Smart Grid Communications (SmartGridComm)
(2010).
[6] Cleveland, F. M. Cyber security issues for advanced
metering infrasttructure (AMI). In IEEE Power and
Energy Society General Meeting - Conversion and
Delivery of Electrical Energy in the 21st Century
(2008).
[7] Echelon data concentrator.
http://www.echelon.com/products/controllers/
meter-data-concentrator/default.htm.
[8] Faisal, M. A., Aung, Z., Williams, J., and
Sanchez, A. Securing advanced metering
infrastructure using intrusion detection system with
data stream mining. In Proceedings of Paciﬁc Asia
Workshop on Intelligence and Security Informatics
(PAISI) (2012).
[9] Garcia-Teodoro, P., D´ıaz-Verdejo, J. E.,
Maci´a-Fern´andez, G., and V´azquez, E.
Anomaly-based network intrusion detection:
Techniques, systems and challenges. Computers &
Security (2009).
[10] Gu, Y., McCullum, A., and Towsley, D.
Detecting anomalies in network traﬃc using maximum
entropy estimation. In Proceedings of the ACM
SIGCOMM Conference on Internet Measurement
(IMC) (2005).
[11] HPROF: A heap/CPU proﬁling tool.
http://docs.oracle.com/javase/7/docs/
technotes/samples/hprof.html.
[12] Idaho National Laboratory (INL). NSTB assessments
summary report: Common industrial control system
cyber security weaknesses, May 2010.
[13] Jung, J., Paxson, V., Berger, A. W., and
Balakrishnan, H. Fast portscan detection using
sequential hypothesis testing. In Proceedings of the
IEEE Symposium on Security and Privacy (2004).
[14] Kwiatkowska, M., and Parker, D. Advances in
probabilistic model checking. In Proceedings 2011
Marktoberdorf Summer School: Tools for Analysis and
Veriﬁcation of Software Safety and Security (2012).
[15] Mashima, D., and C´ardenas, A. A. Evaluating
electricity theft detectors in smart grid networks. In
Research in Attacks, Intrusions, and Defenses (2012).
[16] McLaughlin, S., Podkuiko, D., and McDaniel, P.
Energy theft in the advanced metering infrastructure.
Critical Information Infrastructures Security (2010).
[17] McLaughlin, S., Podkuiko, D., Miadzvezhanka,
S., Delozier, A., and McDaniel, P. Multi-vendor
penetration testing in the advanced metering
infrastructure. In Proceedings of the 26th Annual
Computer Security Applications Conference, (ACSAC)
(2010).
[18] Merhav, M., Gutman, M., and Ziv, J. On the
estimation of the order of a markov chain and
universal data compression. IEEE Transactions on
Information Theory (1989).
[19] Perdisci, R., Ariu, D., Fogla, P., Giacinto, G.,
and Lee, W. McPAD: A multiple classiﬁer system for
accurate payload-based anomaly detection. Computer
Networks (2009).
[20] Probabilistic symbolic model checker PRISM.
http://www.prismmodelchecker.org/.
[21] Smart grid news. http://www.smartgridnews.com.
[22] Smart meter - ARM. http:
//www.arm.com/markets/embedded/smart-meter.php.
[23] Ten, C., Hong, J., and Liu, C. Anomaly detection
for cybersecurity of the substations. IEEE
Transactions on Smart Grid (2011).
[24] The White House. Homeland Security Presidential
Directive 7: Critical infrastructure identiﬁcation,
prioritization and protection, December 2003.
[25] U.S. Government Accountability oﬃce (GAO).
information security: TVA needs to address
weaknesses in control systems and networks, 2008.
[26] Wang, K., and Stolfo, S. J. Anomalous
payload-based network intrusion detection. In Recent
Advances in Intrusion Detection (RAID) (2004).
[27] Zhang, Y., Wang, L., Sun, W., Green, R., and
Alam, M. Distributed intrusion detection system in a
multi-layer network architecture of smart grids. IEEE
Transactions on Smart Grid (2011).
[28] Zhu, B., and Sastry, S. SCADA-speciﬁc intrusion
detection/prevention systems: A survey and
taxonomy. In First Workshop on Secure Control
Systems (SCS) (2010).
APPENDIX
A. BACKGROUND
Smart grids have two major networks i.e., power distribu-
tion and communication network. Power distribution net-
work is intuitively the same as the legacy power network
which is responsible for power generation, transmission and
distribution to the consumers. However, communication
network is responsible for monitoring diﬀerent devices in
the smart grid, thus providing the ease of management and
eﬃcient energy consumption. AMI is a core component of a
smart grid responsible for the bi-directional communication
between the headend and the meter. Basic architecture of an
AMI is shown in Figure 1. AMI has three main components
i.e., Home Area Network (HAN), Neighborhood Area Net-
work (NAN), and Wide Area Network (WAN). HAN can be
realized as the customer home network which is connected
with the smart meter. Therefore, the smart meter acts as
an interface for a HAN as it connects AMI and HAN in
the bi-directional communication mode. NAN is responsi-
ble for the communication between the smart collectors and
the smart meters. NAN scales from hundreds to thousands
of nodes including the smart meters and the smart collec-
tors. Lastly, WAN is mainly responsible for the backhaul
connectivity of the NAN to the headend system.
Diﬀerent communication channels can be used by the AMI
for diﬀerent components. For example, NAN may use wire-
less or power line communication in order to interact among
nodes. Moreover, WAN uses the high range and bandwidth
technologies for the purpose of connecting NAN to the head-
end. It can use cellular technologies or other dedicated com-
munication medium. Usually utility providers utilize the
existing network from a third party in order to connect the
NAN to the headend.
462