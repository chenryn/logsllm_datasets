First step in the quest for manufacturing 
cyber-resilient IoT devices
Panasonic Corporation
Jun Sato
Chih-Hsiang
HITCON 2020@TAIPEI
About me
・佐藤 淳
・Jun Sato
・Past experience in system development and operation
・Joined Panasonic in 2019 and involved in IoT security 
・CISSP, GCFA
Background
サイバーセキュリティ戦略本部
サイバーセキュリティ２０１９
（别添５
サイバーセキュリティ関连データ集
NICTER観测结果より）
https://www.nisc.go.jp/active/kihon/pdf/cs2019.pdf
Number of Attacks Observed by NICTER Darknet Sensors
Breakdown of Observed Attacks by NICTER Darknet Sensors (2018)
Number of cyber attacks continue to increase
About half of observed attacks targeting IoT devices
No. Packets (ten billion)
Other
Attacks targeting IoT devices
(Web Camera, Routers, etc.)
Cybersecurity Research Institute - Cyber Security 2019
Appending 5 - Cyber Security Related Data - NICTER Observation 
Results
Increasing attacks targeting IoT
Sudden Increase in IoT Malware
“New trends in the world of IoT threats”,  Kaspersky Lab, September 18, 2018
https://securelist.com/new-trends-in-the-world-of-iot-threats/87991/
The number of IoT malware has more than 
tripled from 2017 in just the first half of 2018
https://www.securityweek.com/hide-%E2%80%98n-seek-botnet-targets-smart-homes
https://www.ithome.com.tw/news/132271
https://arstechnica.com/information-technology/2018/05/hackers-infect-500000-
consumer-routers-all-over-the-world-with-malware/?amp=1
https://www.securityweek.com/over-500000-iot-devices-vulnerable-mirai-botnet
https://www.ithome.com.tw/news/123708
https://www.ithome.com.tw/news/129449
Number of IoT malware 
infections rising rapidly, 
with no end in sight
IoT Malware Wreaking Havoc
Infect
Spread
Cyber Attacks
Infect, Spread and leverage for use in attacks
Victims unknowingly become attackers
IoT Malware Infections and Associated Damages
Regulations by Government
・2019 Order of the Ministry of Internal Affairs and Communications No. 12
・Partial revision to “Telecommunications Business Act” and “Act on 
the National Institute of Information and Communications Technology, 
Independent Administrative Agency”
・2017 Notification of the Ministry of Economy, Trade and Industry No. 19
・Oregon HB 2395 amending ORS 646.607
・Cyber Shield Act of 2019 (S. 2664)
・SB-327 Information Privacy: Connected Devices
・IoT Cybersecurity Improvement Act of 2019 
・Executive Order on Securing the Information and Communications Technology 
and Services Supply Chain (Executive Order 13873)
・EU Sales of Goods Directive (SGD)
・EU Digital Content Directive (DCD)
・UK legislation for consumer IoT devices by design
・Germany IT security law 2.0
・Finland Cybersecurity Label
・Cybersecurity Law of the People's Republic of China 
- 中华人民共和国网络安全法
・Public Comments on the Provisions on the Administration of 
Cybersecurity Vulnerabilities
- 网络安全漏洞管理规定 (征求意见稿)
・Data Security Law of the People’s Republic of China 
- 中华人民共和国数据安全法
United States
Europe
People's Republic of China
Japan
New laws being  enacted globally
govern IoT security
Users
Retail 
Security 
Organizations / 
Researchers
Governments
Parts Supplier
Security for shipped products
Product updates after shipment
Procurement of secure parts / 
components
(Chips, software, etc.)
Discovery of vulnerabilities
Development / selling security 
products
Alerts to users
Guidance to Manufacturers
Proper explanation and initial 
configuration of products
Proper configuration and usage of 
products
Manufac
turer
Expectations for "Manufacturers to ensure product security"
Existing Panasonic Activities on Product Security
As A Corporate Risk
https://www.panasonic.com/global/corporate/sustainability/management/riskmanagement.html
https://www.panasonic.com/global/corporate/sustainability/pdf/sdb2019e.pdf
Cyberattacks are a major corporate risk in Panasonic
1
2
Essential knowledge (Awareness / Technical)
Minimize 
Risk
Incident 
Response
Product Security
Supporting Panasonic Brand
Threat Analysis
Secure Design
Secure Coding
Static Analysis
Vulnerability 
Testing
(Security Testing)
Incident 
Response
Minimize Risk
Incident 
Containment
Plan
Shipment
Discard
Design
Implement
Test
In-Use
Product Lifecycle
Panasonic Product Security Activities
Cyber Security in Panasonic
IT Security
Information System
Web-site, PC, Server, 
Network, Data and 
Application
CSIRT
Info. Systems related 
department
Product Security
Product
Product and Services 
provided by Panasonic
PSIRT
Product Security Center
Manufacturing System 
Security
Factory, 
Manufacturing
Manufacturing system 
and Production 
Machine in Panasonic
FSIRT
Manufacturing related 
department
Cyber Security Activities in Panasonic
Planning
Design
Implement Verity(Test) On market
Incident Coordinators
FIRST, IPA(JP), CERT(US), JPCERT/CC(JP)
Panasonic PSIRT
Security Institution
ISPs, Vendors, Academics, Individuals
Panasonic
AP-IRT
LS-IRT
IS-IRT
CNS-IRT
AM-IRT
Incident Response Framework at Panasonic
Panasonic IoT Threat Intelligence Project
Challenges in Product Security
Requires trigger
• Incident response requires trigger (internal/external notification)
• Not relying on external organization to collect threat information 
Proactively analyze / utilize threat information
New threat 
New vulnerability
New threat 
New vulnerability
More secure products
Collect malware targeting home electronics
Through the platform, goal is to strengthen overall IoT security
Analysis of malware characteristics
IoT Threats
Collection
IoT Threats
Analysis
IoT Device
Protection
Panasonic IoT Threat Intelligence Platform Concept
Real time collection using IoT home electronics
Ability to collect attacks against products in 
development
Increase global coverage of observation points
On-going
On-going
On-going
IoT Threat Collection - Malware targeting home electronics
IoT Malware
Analysis Results
Statistical Analysis
Collect Malware
(Honeypot)
Process this flow automatically
Behavior Analysis (IoT Sandbox)
Collect Malware Targeting 
IoT Home Electronics
Behavior analysis specialized for IoT malware
Auto-processing from collection to 
analysis/statistics
On-going
On-going
On-going
IoT Threat Analysis – Analyze Characteristics of IoT Malware
IoT Device Protection – Feedback to Product Developer 
•
Categorize attack against product in development with 
standard framework (e.g. MITRE ATT&CK)
•
Analyze targeted vulnerabilities to assess 
countermeasures for products
•
Product specific characteristics
 Vulnerability
 Impact
Collect threat
(Honeypot)
Threat Analysis (Statics app, elasticsearch)
Malware Analysis
Share attack overview / IoT malware analysis 
to product developer  
On-going
Risk analysis for products in development
Coming Soon
※The home appliance was not infected and there were no damages
Attacks Collected
603,589,498
Malware Collected
56,426
IoT Malware Collected
12,634
Home electronics with
malicious files placed※
2 types
IoT Threat Collection
IoT Threat Analysis (Malaware Analysis)
Of the top 10 destination IP addresses, besides DNS (8.8.8.8),
all are malware distribution sites (malicious sites)
Top 3 destination countries are USA, China, Japan
(Followed by Germany, England, S. Korea, S. Africa, Brazil , France, Egypt.)
Accomplishments – November 2017 – Jun 2020
・张智翔
・Jimmy
・Panasonic Cyber Security Lab
・Past experience in software / system development
・Joined Panasonic in 2018 and involved in IoT security
About me
Analysis example of Collected Threat Information
•
Peak in Dec 2019
•
Peak in June 2020
•
Total attack number decreasing since Feb, 2020
2019/12
Attack trend
2020/06
•
Peak in Dec 2019
•
Remote attacks against Microsoft SQL, targeting servers with weak password
•
Peak in June 2020
•
UPnP vulnerability “Call Stranger” was disclosed
2019/12
MsSQL
2020/06
UPnP
Top 10 Attacked Protocols
Decrease from 600 mil to 0.25 mil
•
Attacks to MSSQL dropped in May 
•
Attacks to UPnP from China and US 
soared in June. 
•
telnet, ssh, UPnP are targets 
constantly in the Top5 
2020/4
2020/5
2020/6
Top 5 Attacked Protocols 
•
Peak in Dec 2019
•
Attack Source by Country: China and Taiwan
•
Peak in June 2020
•
Attack Source by Country: China and the USA
Top 10 Attack Sources by Country
•
China is constantly Top1 since this April.
•
Observed many attacks against 1900 (UPnP), 1433 (MSSQL).
Top 5 Attack Sources by Country
2020/4
2020/5
2020/6
•
Devices being attacked have ports open such as Web, UPnP, SMB, etc.
#2 Home camera
#4 Intercom
#3 BD recoder
#1 Security camera
0
50
100
150
200
250
300
2018Q1
2018Q2
2018Q3
2018Q4
2019Q1
2019Q2
2019Q3
2019Q4
2020Q1
Attacks [K]
Attack Trend Against Physical Honeypots
Dehumidifier
Refrigerator
Home camera
Intercom
BD recoder
TV
Wash machine
Security camera
Air condinctioner
Attack trends against Home IoT Appliances
•
Top 2 China, the USA
•
Almost all attacks are against 1900 (UPnP), 80 (http)
•
Observed a lot of  “M-SEARCH” messages. Probably:
- Search for vulnerable devices to use in SSDP reflection attacks
Attacks against security cameras
Trends in Collected IoT Malware
•
66% Known malware ; 34 % Unknown malware (using VirusTotal)
•
Between a couple to 150-170 samples collected daily
•
No direct correlation between number of attacks and number of collected 
malware samples
•
Likely due to most attack attempts being scans
Analysis of Collected Malware
・Most Linux based malware 
target PC/Servers (i386 and amd64)
・30% of total attacks against 
IoT architecture
・ARM and MIPS are the main 
targets for IoT malware
・Most IoT malware collected 
are gafgyt and mirai family
Malware was placed in a shared folder that did not have any authentication
・5 malware samples placed
・CVE-2017-7494(SambaCry - Attack was not successful)
・4 suspicious files
・1 malware sample
・W32/Tenga
Observed on June, 2018
Observed between October – December, 2018
Observed between January – March, 2019
Attacked Home IoT Appliances -Suspicious Files-
Listing of shared folders
Upload malware
Malware exploits 
CVE-2017-7494 (SambaCry)
Attempts to load malware onto Samba 
server
Fails to specify full path for malware. Attack 
attempt unsuccessful.
Delete malware
Not deleted entirely, some parts remain
Attacked Home IoT Appliances -Suspicious Files-
IoT Malware Analysis (Case 1) - EchoBot
 Mirai variant
 After intrusion, process name is disguised
 Scanner depends on environment
 Only vulnerabilities scanner (1 CPU)
 Vulnerabilities scanners and Telnet/SSH 
scanner (More than 1 CPU)
 Targets vulnerability (command injection) 
in IoT device
(Observed between April - June 2019）
IoT Malware Analysis (Case 1) - EchoBot
 Encrypts password list used during Telnet 
scan
 Original Key “DEADBEEF”
 XOR Key ”DFDAACFD”
 C&C Server
 IP addresses from China
 DoS Functions
 Typical mirai DDoS functions
 ARM, MIPS, PPC, SH4, SPC, x86, etc.
(Observed between June - July 2019）
IoT Malware Analysis (Case 2) - LiquorBot
 Mirai variant
 Rewritten in golang
 Scan vulnerabilities for many IoT devices
 Linksys
 Dlink
 …
 SSH scanner
 Brute force attack for SSH
 Recognized as nonmalicious by VirusTotal
 Coin Miner functions
 MIPS
(Observed between Jan - Feb 2020）
Tsunami variant
Packed by UPX
Infection through telnet
 Drop telnet connection after infection
Mapping table for encryption/decryption
Support command to deploy bot as C2
 Deploy “ngircd” IRC server
ARM
IoT Malware Analysis (Case 3) - Sandbot
(Observed between July - September 2019）
Next Steps
Future Vision - Strengthen B2C Security
Collaborate with industry to see if global 
trends match attacks against our products
Categorize attack against product in development with 
standard framework (e.g. MITRE ATT&CK, etc.)
Proactively Collect / Analyze incoming threats
The goal is to strengthen overall IoT security