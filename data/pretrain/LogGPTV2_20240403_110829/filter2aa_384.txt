An#$Forensics,AF,
@dualcoremusic,
mov$eax,$0x6b;$int$0x80$
•  Rapper,
•  Some,other,stuﬀ,idk,
Overview,
•  Memory,Forensics,vs,SMC*,
– Windows,
– Linux,
•  Android,(An#$)Forensics,
•  Fun,with,SD,cards,
Disclaimers,
•  !Professional,
•  TROLOLOLOL,
•  !Expert,/,YMMV,
•  DO,ILLEGAL,THINGS,
,
Memory,Forensics,
•  Focus,on,soSware,protec#on,(malware),
•  Persist,,thwart,detec#on,
•  Inhibit,acquisi#on,and,analysis,
,
Memory,Forensics,
•  All,the,cool,stuﬀ,happens,in,memory,
•  Loading,from,disk,
•  Why,can’t,I,hold,all,these,sec#ons?,
,
Memory,Forensics,
•  No,longer,referenced,,no,longer,needed,
•  Analysis,tools,madbro,
•  Lots,of,fun,to,be,had,
,
Memory,Forensics,
•  Demo,
– thekeysarelikerightnexZoeachother.exe,
•  Rekall,(winpmem),
,
 YOU ALL SUCK DICK 
 er. 
 hi. 
 A common typo. 
 the keys are like right next to each other. 
Memory,Forensics,
•  PE,header,not,needed,aSer,loading,
•  Zero,the,header,(RtlZeroMemory),
•  Process,con#nues,to,run,
•  Analysis,tools,fail,
•  Win:,,XP,,,,,,10,
,
Memory,Forensics,
•  Completeness:,
,
winpmem92.1.post4.exe$9o$lol.aff4$
$
"C:\Program$Files\Rekall\rekal.exe"$9f$lol.aff4$
$
>$procdump$proc_regex="thekeys",$$
$$$$dump_dir="C:/Users/int0x80/Desktop/"$
Memory,Forensics,
•  Demo,
– thekeysarelikerightnexZoeachother$linux,
•  LiME,
•  Vola#lity,
,
Memory,Forensics,
•  ELF,header,not,needed,aSer,loading,
•  Zero,the,header,(memset),
•  Process,con#nues,to,run,
•  Analysis,tools,fail,
,
Memory,Forensics,
•  Completeness:,
,
git$clone$https://github.com/504ensicsLabs/LiME$
$
cd$LiME/src/$
$
make$
$
sudo$insmod$./lime9$(uname$–r).ko$\$
$$"path=/tmp/lol.lime$format=lime"$
Memory,Forensics,
•  Completeness:,
,
git$clone$https://github.com/
volatilityfoundation/volatility$
$
cd$volatility/$
$
sudo$python$setup.py$install$
Memory,Forensics,
•  Completeness:,
,
cd$tools/linux/$
$
make$
$
head$module.dwarf$
$
.debug_info$
...$
Memory,Forensics,
•  Completeness:,
,
sudo$zip$\$$
$$volatility/plugins/overlays/linux/Ubuntu1604.zip$\$
$$tools/linux/module.dwarf$\$
$$/boot/System.map9$(uname$9r)$
$
python$vol.py$99info$|$grep$^Linux$
Volatility$Foundation$Volatility$Framework$2.5$
LinuxUbuntu1604x64$9$A$Profile$for$Linux$Ubuntu1604$
x64$
Memory,Forensics,
•  Completeness:,
,
python$vol.py$–f$/tmp/lol.lime$\$
$$99profile=LinuxUbuntu1604x64$linux_pslist$
$
python$vol.py$–f$/tmp/lol.lime$\$
$$99profile=LinuxUbuntu1604x64$linux_procdump$\$
$$9D$/tmp$9p$$
Android,(An#$)Forensics,
•  Use,Encryp#on$
Android,(An#$)Forensics,
•  Use,Encryp#on,
•  Also,"Use,Tor,,Use,Signal",
Android,(An#$)Forensics,
•  Use,Encryp#on,
•  Also,"Use,Tor,,Use,Signal",
Android,(An#$)Forensics,
•  Use,Encryp#on,
•  Also,"Use,Tor,,Use,Signal",
Android,(An#$)Forensics,
•  Use,Encryp#on,
•  Also,"Use,Tor,,Use,Signal",
Android,(An#$)Forensics,
•  Use,Encryp#on,
•  Also,"Use,Tor,,Use,Signal",
Android,(An#$)Forensics,
•  Use,Encryp#on,
•  But,ﬁrst,,a,word,about,Android,forensics,
Android,Forensics,
•  Not,the,easiest,
•  Acquisi#on/Imaging,is,a,pain,
– Numerous,caveats,
– CONFIG_MODULES=y$
– Cross$compile,nc$
– Diﬀerent,interfaces,
Android,Forensics,
•  Acquisi#on/Imaging,caveats:,
– Power,
– Decrypted,
– Unlocked$
– Rooted,
– USB,Debugging,
Android,Forensics,
•  Memory,acquisi#on/imaging,caveats:,
– Power,
– Decrypted,
– Unlocked$
– Rooted,
– USB,Debugging,
– CONFIG_MODULES=y,
Android,Forensics,
•  NAND,acquisi#on,done,with,nc$
,
adb$devices$
adb$push$./nc$/sdcard/nc$
adb$forward$tcp:4444$tcp:4444$
adb$shell$
su$
cp$/sdcard/nc$/dev/nc$$
chmod$777$/dev/nc$
Android,Forensics,
•  NAND,acquisi#on,done,with,nc$
,
dd$if=/dev/block/mmcblk0$bs=65535$|$\$
/dev/nc$9nvlp$4444,,
nc$9nv$127.0.0.1$4444$>$image.nand$
sha256sum$image.nand$
cp$9a$image.nand$image.nand.copy,,
sha256sum$image.nand*$
$
Android,Forensics,
•  NAND,exposed,via,diﬀerent,interfaces,
•  Check,/proc/partitions$
– /dev/block/mmcblk*,
– /dev/mtd/mtd*,
– /dev/mtdblock*$
– /dev/emmc*,
– /*/*/*/*$no,$comment,
Android,Forensics,
•  Logical,acquisi#on,is,easier,
– adb$pull$/$./dump$
– adb$shell$dumpsys$&>$./dumpsys.log,
– adb$backup$9apk$9obb$9shared$$
$9all$9system$
$
java$9jar$abe.jar$unpack$
$$$$$$[pin]$
,
Android,Forensics,
•  Logical,acquisi#on,is,easier,
– adb$shell$dumpstate$\$
$$&>$./dumpstate.log,
– adb$bugreport$&>$./bugreport.log$
– aflogical9ose$
Android,Forensics,
•  Complete,forensic,acquisi#on/analysis,sucks,
•  Likely,violate,tradi#onal,methodology,
•  Easy,to,disrupt,:),
Android,An#$Forensics,
•  Use,Encryp#on,
•  Example,scenarios:,,
– Raided,by,LE,
– Deploying,hardware,implant,
– e\_()_/e,
Android,An#$Forensics,
•  Use,Encryp#on,
•  Easiest,solu#on:,
– Power,down,device,
– Everything,encrypted,
– Lawyer,up,
Android,An#$Forensics,
•  Power,down,if,tampering,detected,
•  Leverage,device,sensors,
– Bluetooth,
– Cellular,
– GPS,
– Mo#on,
– Power,
– WiFi,
Android,An#$Forensics,
•  Android,app:,Duck,The,Police,
•  Device,asser#ons:,
– Encrypted,
– Rooted,
– Magnets,
– Sensors,
,
•  DEMO,
Android,An#$Forensics,
•  Use,Encryp#on,
•  Example,scenarios:,,
– Raided,by,LE,
– Deploying,hardware,implant,
– e\_()_/e,
•  WIN,
SD,Cards,
•  CTF,Time!,
SD,Cards,
•  [SPOILER,PREVENTION,INTENSIFIES],
SD,Cards,
•  sdtool$
•  Lock/Unlock,device,
•  Physical,lock,disengaged,
•  Writes,happen,in,memory,
•  Nothing,wriZen,to,device,
•  NO,LOGS,,NO,CRIME,
SD,Cards,
•  sdtool,caveats:,
– Direct,access,to,MMC,device,required,
– Some,USB,hubs,only,expose,mass,storage,
•  WON'T,WORK,
,
SD,Cards,
•  Example,scenarios:,
– Hardware,implant,
– PORTAL,of,Pi,(@thegrugq),
•  hZps://github.com/int0x80/notes/wiki/Linux:$PORTAL$of$Pi,,
– AZack,VM,
,
SD,Cards,
•  sdtool:,hZp://www.bertold.org/sdtool/,
•  Edit,Makeﬁle,to,use,clang,instead,of,gcc,
,
sudo$./sdtool$/dev/mmcblk0$status$
sudo$./sdtool$/dev/mmcblk0$lock$
sudo$./sdtool$/dev/mmcblk0$unlock$
Ques#ons?,
@dualcoremusic,
PI:EMAIL,