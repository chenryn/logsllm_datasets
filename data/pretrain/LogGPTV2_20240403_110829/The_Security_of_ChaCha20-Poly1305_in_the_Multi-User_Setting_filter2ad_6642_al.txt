done by A, there are at most one other encryption query
Enc(ğ‘–, ğ‘ , ğ´ğ·â€², ğ‘€â€²) with answer ğ¶â€²âˆ¥ğ‘‡ â€² and the same (ğ‘–, ğ‘) done
by him. Thus there are at most ğ‘ğ‘£ possible pairs of such queries
done by A. When querying Reveal, for each of these pairs, the
value ğ‘‰ â€²
0 associated to the encryption query is computed as (ğ‘Ÿâˆ¥(ğ‘‡ â€² (ğ‘¡)âˆ’
ğ»ğ‘Ÿ (ğ´ğ·â€², ğ¶â€²))âˆ¥ğ‘Š ) with ğ‘Ÿ being sampled uniformly at random and
independently from any previous queries. Hence, as (ğ´ğ·, ğ¶) â‰ 
(ğ´ğ·â€², ğ¶â€²) and ğ» is a ğ‘-almost Î”-universal hash function, the prob-
ability that ğ‘‡ (ğ‘¡)âˆ’ ğ»ğ‘Ÿ (ğ´ğ·, ğ¶) = ğ‘‡ â€² (ğ‘¡)âˆ’ ğ»ğ‘Ÿ (ğ´ğ·â€², ğ¶â€²) is bounded by
ğ‘Â·max(|ğ´ğ·|ğ‘¡+|ğ¶|ğ‘¡ ,|ğ´ğ·â€²|ğ‘¡+|ğ¶â€²|ğ‘¡)
0 being
the associated value to the encryption query. Therefore, using a
union bound, the probability that for at least one of these pairs
0]ğ‘Ÿ , is at most ğ‘ğ‘£Â·ğ‘Â·â„“ğ‘š2ğ‘¡
ğ‘‡ (ğ‘¡)âˆ’ ğ»ğ‘Ÿ (ğ´ğ·, ğ¶) = ğ‘‡ â€² (ğ‘¡)âˆ’ ğ»ğ‘Ÿ (ğ´ğ·â€², ğ¶â€²) for ğ‘Ÿ = [ğ‘‰ â€²
.
(21)
Pr[Tideal âˆˆ Bad6-1] â‰¤ ğ‘ğ‘£
, for ğ‘Ÿ = [ğ‘‰ â€²
0]ğ‘Ÿ and ğ‘‰ â€²
â‰¤ ğ‘Â·â„“ğ‘š2ğ‘¡
2ğ‘¡ + ğ‘ğ‘£ Â· ğ‘ Â· â„“ğ‘š
2ğ‘¡
2ğ‘¡
.
Bad6-2: case ğ‘– â‰  ğ‘—.
The probability calculation for this case will follow the same outline
as for Bad2.
Let ğ¸8 be the event that there exist ğ´ğ·âˆ—, ğ¶âˆ— âˆˆ {0, 1}âˆ— and
(ğ‘âˆ—,ğ‘‡âˆ—, ğ‘Ÿâˆ—) âˆˆ {0, 1}ğ‘ Ã— {0, 1}ğ‘¡ Ã— {0, 1}ğ‘¡ such that, the number of
encryption queries Enc(Â·, ğ‘âˆ—, Â·, Â·) with nonce ğ‘âˆ— and associated
ğ‘‰ â€²
0 verifying [ğ‘‰ â€²
0]ğ‘Ÿ , is greater
or equal to ğ‘š8 =
0]ğ‘  (ğ‘¡)+ ğ»ğ‘Ÿâˆ—(ğ´ğ·âˆ—, ğ¶âˆ—) = ğ‘‡âˆ— and ğ‘Ÿâˆ— = [ğ‘‰ â€²
(cid:108)
4ğ‘¡
(cid:109). Then,
(cid:105) + Pr[Tideal âˆˆ Bad6-2 âˆ§ ğ¸8]
(cid:105) + Pr[ğ¸8].
max(1,2ğ‘¡âˆ’log2(ğ‘‘))
Pr[Tideal âˆˆ Bad6-2]
= Pr(cid:104)Tideal âˆˆ Bad6-2 âˆ§ ğ¸8
(cid:12)(cid:12)(cid:12) ğ¸8
â‰¤ Pr(cid:104)Tideal âˆˆ Bad6-2
We will now bound the probability of ğ¸8, so that we only have to
consider the event Tideal âˆˆ Bad6-2 conditioned by ğ¸8 afterward.
For any ğ´ğ·, ğ¶ âˆˆ {0, 1}âˆ— and nonce ğ‘ , let Throw(ğ´ğ·, ğ¶, ğ‘) be
the throwing experiment, where we view each encryption query
Enc(Â·, ğ‘ , Â·, Â·) with nonce ğ‘ and associated ğ‘‰ â€²
0 , as throwing a ball
0]ğ‘Ÿ âˆ¥([ğ‘‰ â€²
[ğ‘‰ â€²
0]ğ‘Ÿ into 22ğ‘¡ possible bins.
For any bin ğ‘Ÿâˆ¥ğ‘‡ âˆˆ {0, 1}2ğ‘¡, each throw has a conditional probability
0]ğ‘  (ğ‘¡)+ ğ»ğ‘Ÿ (ğ´ğ·, ğ¶)) where ğ‘Ÿ = [ğ‘‰ â€²
(cid:104)[ğ‘‰ â€²
of at most
0 â†$ Enc(Â·,ğ‘ ,Â·,Â·)
Prğ‘‰ â€²
= Pr(cid:104)[ğ‘‰ â€²
0]ğ‘Ÿ âˆ¥[ğ‘‰ â€²
0]ğ‘  = ğ‘‡ (ğ‘¡)âˆ’ ğ»ğ‘Ÿ (ğ´ğ·, ğ¶)(cid:12)(cid:12)(cid:12) [ğ‘‰ â€²
0]ğ‘  = ğ‘Ÿâˆ¥ğ‘‡ (ğ‘¡)âˆ’ ğ»ğ‘Ÿ (ğ´ğ·, ğ¶)(cid:105)
0]ğ‘Ÿ = ğ‘Ÿ(cid:105) Â· Pr(cid:2)[ğ‘‰ â€²
0]ğ‘Ÿ = ğ‘Ÿ(cid:3) =
1
22ğ‘¡
.
If we consider all encryption queries with the nonce ğ‘ , we throw at
most ğ‘‘ balls uniformly at random into 22ğ‘¡ bins. Using Lemma B.1,
with ğ‘„ = ğ‘‘ and ğµ = 2âˆ’2ğ‘¡, the probability that the heaviest bin
of Throw(ğ´ğ·, ğ¶, ğ‘) contains ğ‘š8 or more balls is at most 2âˆ’2ğ‘¡. If
ğ¸8 happens, then the bin ğ‘Ÿâˆ—âˆ¥ğ‘‡âˆ— in experiment Throw(ğ´ğ·âˆ—, ğ¶âˆ—, ğ‘âˆ—)
contains ğ‘š8 or more balls, therefore, the number of balls in the heav-
iest bin of Throw(ğ´ğ·âˆ—, ğ¶âˆ—, ğ‘âˆ—) contains ğ‘š8 or more balls. Thus,
the probability of ğ¸8 is also bounded by 2âˆ’2ğ‘¡. Hence,
Pr[Tideal âˆˆ Bad6-2] â‰¤ Pr(cid:104)Tideal âˆˆ Bad6-2
(cid:105) + 2âˆ’2ğ‘¡ .
(22)
(cid:12)(cid:12)(cid:12) ğ¸8
0 verifying [ğ‘‰ â€²
The unionVf,Enc and sumVfEnc are over all verification
Note that ğ¸8 is the event that for any ğ´ğ·, ğ¶ âˆˆ {0, 1}âˆ— and (ğ‘ ,ğ‘‡) âˆˆ
{0, 1}ğ‘ Ã— {0, 1}ğ‘¡, the number of encryption queries Enc(Â·, ğ‘ , Â·, Â·)
with nonce ğ‘ and associated ğ‘‰ â€²
0]ğ‘  (ğ‘¡)+ ğ»ğ‘Ÿ (ğ´ğ·, ğ¶) = ğ‘‡
where ğ‘Ÿ = [ğ‘‰ â€²
0]ğ‘Ÿ , is strictly less than ğ‘š8. To bound the remaining
term, we now consider the case where A is querying the Reveal
oracle and all parameters ğ‘Ÿ have already been sampled, but no user
keys have been sampled yet. In the following, we mean by Enc
and Vf, an encryption and verification query already done by A.
queries already done by A and all encryption queries with the same
nonce as the verification query.
Vf(ğ‘–, ğ‘ , ğ´ğ·, ğ¶âˆ¥ğ‘‡) and an encryption query Enc( ğ‘—, ğ‘ , ğ´ğ·â€², ğ‘€â€²)
with the same nonce ğ‘ and an associated ğ‘‰ â€²
0]ğ‘  (ğ‘¡)+
ğ»ğ‘Ÿ (ğ´ğ·, ğ¶) = ğ‘‡ where ğ‘Ÿ = [ğ‘‰ â€²
0]ğ‘Ÿ , and ğ¾ğ‘— = ğ¾ğ‘–. To bound the
probability of this event, we split it into two, one for the event
that the keys are equals and a second one for the rest of the event
that doesnâ€™t depend on the key. Let ğ¸9(Vf, Enc) be the event
that the key ğ¾ğ‘– of the verification query Vf is equal to the key
ğ¾ğ‘— of the encryption query Enc, and ğ¸10(Vf, Enc) be the event
that [ğ‘‰ â€²
0]ğ‘Ÿ , (ğ´ğ·, ğ¶,ğ‘‡) are the
values associated to the verification query Vf, and ğ‘‰ â€²
0 is the value
associated to the encryption query Enc. Then, using a union bound,
A transcript is in Bad6-2, if there exists a verification query
0 such that [ğ‘‰ â€²
0]ğ‘  (ğ‘¡)+ ğ»ğ‘Ÿ (ğ´ğ·, ğ¶) = ğ‘‡ , where ğ‘Ÿ = [ğ‘‰ â€²
(cid:105)
â‰¤ Pr
(cid:12)(cid:12)(cid:12) ğ¸8
Pr(cid:104)Tideal âˆˆ Bad6-2
â‰¤âˆ‘ï¸
ğ¸9(Vf, Enc) âˆ§ ğ¸10(Vf, Enc)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ğ¸8

Pr(cid:104)ğ¸9(Vf, Enc)(cid:12)(cid:12)(cid:12) ğ¸8 âˆ§ ğ¸10(Vf, Enc)(cid:105)
âˆ‘ï¸
Â· Pr(cid:104)ğ¸10(Vf, Enc)(cid:12)(cid:12)(cid:12) ğ¸8
(cid:105) .
Vf,Enc
Enc
Vf
(23)
When querying Reveal, the usersâ€™ keys are uniformly sampled,
independently from any previous queries and parameters. Thus, for
any pair Vf, Enc, the probability that ğ¾ğ‘– = ğ¾ğ‘— is 1
2ğ‘˜ . This event is
also independent from ğ¸8 and ğ¸10(Vf, Enc), which both depend
only on parameters already fixed before sampling the usersâ€™ keys.
Session 6D: Authentication and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea2000Thus
Pr(cid:104)ğ¸9(Vf, Enc)(cid:12)(cid:12)(cid:12) ğ¸8 âˆ§ ğ¸10(Vf, Enc)(cid:105)
= Pr[ğ¸9(Vf, Enc)]
1
2ğ‘˜
.
=
(24)
Note that conditioned on event ğ¸8, for any verification query Vf
there are strictly less than ğ‘š8 encryption queries Enc with the
same nonce ğ‘ and an associated ğ‘‰ â€²
0]ğ‘  (ğ‘¡)+ğ»ğ‘Ÿ (ğ´ğ·, ğ¶) = ğ‘‡ ,
where ğ‘Ÿ = [ğ‘‰ â€²
0]ğ‘Ÿ , (ğ´ğ·, ğ¶,ğ‘‡) are the values associated to Vf, and ğ‘‰ â€²
0
is the value associated to Enc. Hence, for a fix verification query
Vf, there are strictly less than ğ‘š8 encryption queries Enc such
0 such that [ğ‘‰ â€²
that Pr(cid:104)ğ¸10(Vf, Enc)(cid:12)(cid:12)(cid:12) ğ¸8
âˆ‘ï¸
(cid:105) is not zero. Thus
Pr(cid:104)ğ¸10(Vf, Enc)(cid:12)(cid:12)(cid:12) ğ¸8
<âˆ‘ï¸
(cid:25)
(cid:24)
âˆ‘ï¸
(cid:24)
Moreover,
(cid:105)
Enc
Vf
Vf
ğ‘š8 â‰¤ ğ‘ğ‘£ Â· ğ‘š8.
2ğ‘¡
4ğ‘¡
ğ‘š8 =
max(1, 2ğ‘¡ âˆ’ log2(ğ‘‘))
max(1, 2ğ‘¡ âˆ’ log2(2ğ‘‘))
â‰¤ 2 Â·
= 2 Â· 2ğ‘¡ ğ‘‘
and in combination with (22), (23), (24) and (25), we obtain
Pr[Tideal âˆˆ Bad6-2] â‰¤ ğ‘ğ‘£ Â· 2 Â· 2ğ‘¡ ğ‘‘
2ğ‘˜
+ 1
22ğ‘¡
.
(25)
(cid:25)
(26)
Combining the two cases (21) and (26) using a union bound, we
obtain the following result:
Pr[Tideal âˆˆ Bad6] â‰¤ ğ‘ğ‘£
+ ğ‘ğ‘£ Â· 2 Â· 2ğ‘¡ ğ‘‘
C ATTACKS AND PROOFS OF LOWER
2ğ‘¡ + ğ‘ğ‘£ Â· ğ‘ Â· â„“ğ‘š
2ğ‘˜
2ğ‘¡
+ 1
22ğ‘¡
.
â–¡
BOUNDS
In this section, we give the details of the two most interesting attacks
against ChaCha20-Poly1305 among the ones briefly described in
Section 7.1.
C.1 Proof of Proposition 7.1 (Forgery Attack)
We refer to [22] for an introduction to lattices and the terms used in
the following proof. We also note that the complexity of this attack
may be exponential when using deterministic SVP algorithms (or
slightly better when using SVP approximation algorithms), making
the attack impractical, especially for large â„“ğ‘š, but still valid in
the model we use here, where the adversary is computationally
unbounded.
We define an adversary A that makes one encryption query
and ğ‘ğ‘£ verification queries, attempting each time a forgery. If a
verification query returns true, then it outputs 1. As a forgery is
impossible in the ideal world, then
(cid:20)
Pr
Thus
AğºIdeal-muAE
ChaCha20-Poly1305[ğœ‹] â‡’ 1
= 0.
Adv
ChaCha20-Poly1305[ğœ‹](A) = Pr
muAE
AğºReal-muAE
ChaCha20-Poly1305[ğœ‹] â‡’ 1
(cid:21)
.
(cid:21)
(cid:20)
be a polynomial with the set R ğ‘— as roots and where ğ‘”(ğ‘¥) is a non
(ğ‘¥ âˆ’ ğ‘Ÿ) mod ğ‘
(cid:107) âˆ’ 1 defined such that
Let A be an adversary against ChaCha20-Poly1305 and ğ‘ = 2130âˆ’5.
3
Note that ğ‘
4 < 2ğ‘¡ < ğ‘. In the following, we will use the integer
representation for ğ‘¡-bit strings. The adversary A makes as its first
query an encryption query Enc(ğ‘–, ğ‘ , ğ´ğ·, ğ‘€) with nonce ğ‘ and
inputs of exactly â„“ğ‘š blocks, where ğ‘€ = ğœ€ is an empty string and