# P2P僵尸网络深度追踪——Mozi（三）
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
> 间谍菜鸟如何一步步成为一位优秀的间谍。
Mozi（一）传送带：  
Mozi（二）传送带：
炎炎夏日，空调房和冰西瓜是打工人最大的安慰，上一篇的瓜各位吃得开心吗？
再大的瓜田也会有无瓜可吃的一天，Mozi节点数量多、增长快，如果只在一个指定范围内的二叉树中顺藤摸瓜，不免是冰山一角。为了解决这个问题，需要在上篇提到的技术方法的基础上结合本篇文章介绍的探测技术，两种方法相互支持。  
本文首先由一个故事趣味引入诱捕探测器的工作流程，然后展开讲解探测器的工作原理，最后利用loT蜜罐测试探测器的覆盖率，并将两种探测技术进行对比。  
PS：截止6月30日，我们探测到的历史感染Mozi节点数量为162万，其中中国有92万，占比约为57%。知微实验室致力于物联网安全研究，希望与各位安全同行一起交流合作，助力物联网安全。
## 一、墨子任务
作为间谍学院2020届优秀毕业生的你被选拔进入国家情报局，但是整日打杂做琐事，满怀壮志却始终没有机会施展，眼看着同一批加入的同事一个个被外派任务不免有些泄气。某日，局长突然把你叫进办公室，递给你寥寥无几的几页资料，只见第一页上写着——“墨子任务”。  
局长：“这是去年底新发现的犯罪组织，目前还处于初期发展同伙阶段，但是他们扩展速度极快，威胁性不可估量，我知道你一直想有个机会证明自己，现在机会来了，但是相关资料很少，需要你自己去收集情报，此次任务代号是‘墨子’。”  
你抑制住上扬的嘴角，答道：“收到，保证完成任务！”  
回到局里给新人安排的简陋工位，你开始认真研究这几页资料，连呼吸仿佛都变得沉重……
资料显示，这个组织隐匿性极强，仅从表面无法分辨出来，且有一套完整的发展同伙流程：  
组织内部没有上下级关系，每个人都做着相同的事  
每个成员只对自己附近的特定人士洗脑  
新人入伙后会立刻向一个指定的地点汇报新人信息，然后与附近同伙交换信息  
新人会等待组织里的其他人暗中传递核心文件，至此完成一次完整的发展同伙流程。  
组织里的人口流动性很大，里面的人随时都可以被清除记忆后被组织抛弃，为了隐藏身份，同伙之间都会使用暗号与握手动作掩人耳目完成接头。
###  1.1 伪造身份
局长提供的资料实在是太少了，怎么获取更多情报？有了！不入虎穴焉得虎子，得想办法混进去。间谍学院最基本的一堂课就是“身份伪造”，在情报局的身份库中选取“打工人”身份，这样的角色在生活中是最常见、最辛苦、精神力量大多脆弱，很容易被感染。  
你迅速给自己伪造了几个他们“熟悉”的身份。
###  1.2 故意试探
既然这个组织发展同伙范围是每个人自己附近的区域，如果提前得知一些他们同伙的具体位置信息，主动出击接近他们，岂不是可以更快接近他们？你突然想到局长资料的最后一页提供了一些当时发现这个犯罪组织时侦察到的一些他们同伙的信息，决定分别使用一个新身份接近其中一个罪犯。  
c0rpse？竟然是他！看着这熟悉的名字，你想起几天前小区“八卦的阿姨们”说22楼新搬来了个戴黑框眼镜看起来有些孤僻高冷的住户就叫这个名字，当时你还笑这名字奇怪。看来，从他身上入手是个好方法。  
“嗨，你是新搬来的吗，好像以前没见过你？”这搭话实在是太尴尬，但是你辛苦蹲了三天终于蹲到和c0rpse两人单独乘电梯的机会不能错过了。  
果然，他看了你一眼，点了下头就当是回答。  
“我叫j4m1e，是24楼的……”果然又尬住了，“你最近是在忙什么吗？这么晚才回来，真辛苦啊！呃……挺羡慕你的，你们公司还缺人吗，我也想找些事做……看我种话痨性格估计只能找那种chuan｜xiao之类的专门给人洗脑哈哈哈，噢抱歉我不该说这种话，实在是最近犯罪小说看多了暂时还没缓过来。但是这种很有趣啊，不是吗？”  
他又看了你一眼，这次是带有些许考究意味的眼神。难道……上钩了？  
“你……lWXy4CygN4M/w8sCsNHkXg==？”电梯上升到20楼时他终于开口了。  
“123456-01。是的，我和你一样。”试探成功！你收敛笑容，朝他伸出右手，“那现在我们可以握手了吗？”
###  1.3 守株待兔
看着锅里开水“咕噜咕噜”煮着泡面，回想起刚才电梯里的场景，你心情大好，从冰箱里拿出两个鸡蛋打进锅里。接下来就等着c0rpse和他同伙通信，把你的位置信息扩散出去，让更多隐藏着的同伙知道你的存在从而主动联系你，这样，获取信息岂不易如反掌？虽然目前不知那传递的核心文件是什么，一切很快会水落石出。
###  1.4 初见成效
距离那次与c0rpse电梯接头成功已经过去半年，听说之后没过多久他就搬走了。在这半年中，每天都有很多同伙“送上门来”，核心文件也早就备份给局里交给同事研究了，你就专心混迹在组织中，不断套取同伙的信息悉数记录。虽然记录的同伙越多越有利于一网打尽，但这组织影响过的普通百姓数量日益剧增，必须要尽快找到办法控制住它。  
根据这段时间的观察，这个犯罪组织好似新冠病毒，易感人群集中在某几类上，感染时可能没有任何征兆，也有很大概率可以恢复正常，但是如果任其肆虐，后果不堪设想。想到这里，你决定立刻回局里找局长……
## 二、诱捕探测技术（绝密间谍任务）
恭喜你完成本实验设计的“间谍养成游戏1.0”，对第二种探测技术的过程是否大致了解了呢？接下来是该探测技术的原理介绍。  
我们提出的是一种类似间谍的诱捕探测技术来对Mozi P2P
型僵尸网络进行分析的方法，批量获取活跃Mozi节点信息、数据库保存所有探测数据等。该方法可极大地提升P2P型僵尸网络的扫描速率，同时结合loT蜜罐技术互相验证扫描结果的准确性。
图1为扫描器整体框架示意图，整个Mozi 扫描框架分为诱捕探测器、已知Mozi网络和未知Mozi网络。