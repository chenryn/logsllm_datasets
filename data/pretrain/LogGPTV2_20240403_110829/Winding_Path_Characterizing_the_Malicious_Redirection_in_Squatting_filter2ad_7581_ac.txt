the proportions of ‘o-script’ and ‘i-script’, we can ﬁnd that the JavaScript-based
method accounts for 35.3% of the total. Moreover, in terms of the usage of
redirection snippets, adversaries are obviously more inclined to import them
from external ﬁles (i.e., o-script), rather than directly hard-coding them into the
HTML content (i.e., i-script). In this way, adversaries can circumvent the static
analysis of HTML content by security personnel to some extent.
4.2 Intermediary Sharing
We have presented in the previous subsection that there are some malicious
samples that end up pointing to the same URL. That is, some samples start at
diﬀerent points but end at the same point. For instance, an adversary manages
multiple squatting domain names, and forces them to navigate the visitors to an
illegal gambling site under his control. Inspired by this, we speculated that there
were certain samples that not only had the same destination, but also shared the
same intermediary. To verify this conjecture, we aggregated all redirection chains
in malicious samples to investigate whether there were common relay nodes.
Table 6. Measurements of the commonly used URL, domain names, and eﬀective 2LDs
in the malicious redirection chains.
Total Commonly used Involved sample
#
%
#
%
URL
72,538 4,117 5.68%
15,593 57.48%
Domain name 40,525 3,634 8.97%
16,899 62.29%
eﬀective 2LD 33,532 3,558 10.61% 17,060 62.89%
We ﬁrst measured the URLs that appeared in multiple redirection chains.
It should be noted that what we did here was an exact match of URL, includ-
ing complete parameters and fragments. The second row in Table 6 shows the
statistics of the commonly used URLs. In this case, we got a total of 72,538
104
Y. Zeng et al.
distinct URLs, where 4,117 URLs appeared in at least two redirection chains,
accounting for about 5.68% of the total. In addition, these commonly used URLs
involved 15,593 malicious samples. That is to say, 57.48% of the malicious squat-
ting domain names have business sharing among them, which is indeed a large
proportion.
Next, we turn our attention to the commonly used domain names in malicious
redirections. Compared with the commonly used URLs, commonly used domain
names obviously own much higher coverage. Because in this case, we no longer
need to match various URL parameters and URL fragments as before. Also, we
ignored the port ﬁeld when extracting domain names from URLs. Table 6 lists
the corresponding measurement results in the third row. We obtained 40,525
distinct domain names from the redirection chain of malicious samples, of which
3,634 domain names were leveraged by more than one sample, accounting for
8.97% of the total. Moreover, there were about 62.29% of the malicious samples
shared these intermediary domain names in common.
However, we found during the measurement process that although some relay
nodes have diﬀerent domain names, the diﬀerence only exists in their subdo-
main names. In other words, these relay nodes have the same eﬀective 2LD
(e2LD). Based on this, we further digged deep into the e2LD level and found
that 10.61% of e2LDs appeared in multiple malicious redirection chains. How-
ever, compared with the commonly used domain names, the coverage of the
commonly used e2LDs has not increased signiﬁcantly. In general, there were
only 161 more involved samples in this case.
4.3
Infrastructure Sharing
This part focuses on our investigation on the Internet infrastructures holding
such intermediary domain names. Concretely, we will discuss the abuse of Inter-
net infrastructures by malicious redirections from the bottom up in terms of
three aspects, namely IP, BGP, and AS.
We have introduced the sharing of e2LDs in malicious redirections in
Sect. 4.2. Here, we matched the associated IP addresses of those 33,532 e2LDs
from the built pDNS database, which yielded 27,396 distinct IP addresses. This
result indicates that numerous e2LDs are being resolved to the same IP address.
We then found out these IP addresses that supported multiple e2LDs from the
pDNS database. The second row of Table 7 lists the relevant statistics, from
which we can see that 8.38% of these IP addresses are responsible for the resolu-
tion of multiple malicious intermediaries at the same time. Furthermore, 41.93%
of the malicious samples involved the sharing of IP addresses during their redi-
rections.
With these matched IP addresses, we moved our attention to their BGP
preﬁxes. Here, we resorted to a third-party Python extension module, called
‘pyasn’ [9], to lookup the BGP preﬁx of an IP address based on a daily updated
public BGP archive [6]. Ultimately, we got a total of 8,932 BGP preﬁxes, of
which 4,817 were abused by at least two malicious intermediaries. Moreover,
it is shocking that these BGPs have provided resolution services for 92.54% of
Table 7. Measurements of the commonly used IP addresses, BGP preﬁxes, and ASes
in the malicious redirection chains.
Winding Path
105
Total Commonly used Involved sample
#
%
#
%
IP
27,396 2,296 8.38%
11,375 41.93%
BGP 8,932
4,817 53.93% 25,104 92.54%
AS
754
424
56.23% 26,608 98.08%
the malicious squatting domain names, directly or indirectly. In addition to the
lookup of BGP preﬁx, ‘pyasn’ also provides the lookup of AS number. In this
way, we further measured the AS that claimed the ownership of those abused
BGPs. The fourth row of Table 7 shows the statistics of AS. We can see that the
8,932 BGPs are eventually aggregated into 754 ASes, and 424 of them have been
exploited by more than one malicious intermediaries, accounting for 56.23% of
the total. More importantly, 98.08% of the malicious samples involved the abuse
of these 424 ASes during their redirections.
The above measurements reveal an important role that the Internet Infras-
tructure playing in malicious redirection activities. Because diﬀerent countries
(or regions) have diﬀerent attitudes towards the grey Internet services, adver-
saries tend to select such ISP with weaker Internet supervision to set up their
network services. This leads to the measurement results in this subsection, that
is, the vast majority of malicious intermediary domain names aggregate in the
same Internet infrastructure.
5 Limitation
This paper focuses on the malicious redirections that stem from squatting
domain names, but the domain types employing such malicious services in the
wild are far more than just squatting domain names. Besides, we only considered
the domain rankings when selecting target brands, but missed some hot terms
at that time, making the squatting domain names we generated lack timeli-
ness to some extent. For example, a large number of pandemic-related squatting
domain names have emerged in early 2020. In addition to the sharing of Inter-
net infrastructures, we found that many malicious domain names also exhibit
obvious aggregation in the requested web resources. That is, we can leverage
this sharing phenomenon to mine more suspicious domain names involving such
malicious sharing resources. Moreover, we have not shed much light on the spe-
ciﬁc working mechanism of the malicious redirection in this paper, especially the
JavaScript-based method. In terms of the experiment background, our measure-
ments are all conducted in the Chinese network environment, which makes us
unclear about the abuse URL redirections in other regions. Solving the above
problems plays an important role in understanding the target victims, working
mechanism, and monetization of malicious redirection, and we will leave them
for future work.
106
Y. Zeng et al.
6 Conclusion
In this paper, we give the ﬁrst insight into the malicious redirections which start
with squatting domain names. By crawling these domain names and analyzing
their performance logs, we identiﬁed 20,079 squatting domain names leveraged
URL redirection to navigate visitors to malicious sites. The investigation of cor-
responding redirection chains shows that adversaries prefer to perform malicious
redirections via imported JavaScript codes or iframes. More importantly, our fur-
ther measurements reveal that there is a very common phenomenon of resource
sharing among various malicious redirection chains.
Acknowledgment. We thank the anonymous reviewers for their comments on this
paper. We would also like to thank Ignacio Castro for shepherding this paper. This work
was partially supported by the National Key Research and Development Program of
China under grant No. 2016QY05X1002 and the Strategic Priority Research Program
of Chinese Academy of Sciences under grant No. XDC02030100.
References
1. Alexa Top 1M Sites. https://www.alexa.com/topsites
2. Alexa Top 1M Sites Archive. https://toplists.net.in.tum.de/archive/alexa/
3. Alexa Top Category Sites. https://www.alexa.com/topsites/category
4. CN Top Sites. http://www.alexa.cn/siterank/
5. Selenium. https://www.selenium.dev/
6. University of Oregon Route Views Archive Project. http://archive.routeviews.org/
7. Agten, P., Joosen, W., Piessens, F., Nikiforakis, N.: Seven months’ worth of mis-
takes: a longitudinal study of typosquatting abuse. In: Proceedings of the 22nd Net-
work and Distributed System Security Symposium (NDSS 2015). Internet Society
(2015)
8. Alrwais, S., Yuan, K., Alowaisheq, E., Li, Z., Wang, X.: Understanding the dark
side of domain parking. In: 23rd {USENIX} Security Symposium ({USENIX} Secu-
rity 2014), pp. 207–222 (2014)
9. Asghari, H.: pyasn. https://github.com/hadiasghari/pyasn
10. Du, K., et al.: TL;DR hazard: a comprehensive study of levelsquatting scams. In:
Chen, S., Choo, K.-K.R., Fu, X., Lou, W., Mohaisen, A. (eds.) SecureComm 2019.
LNICST, vol. 305, pp. 3–25. Springer, Cham (2019). https://doi.org/10.1007/978-
3-030-37231-6 1
11. Holgers, T., Watson, D.E., Gribble, S.D.: Cutting through the confusion: a mea-
surement study of homograph attacks. In: USENIX Annual Technical Conference,
General Track, pp. 261–266 (2006)
12. Huang, L.S., Moshchuk, A., Wang, H.J., Schecter, S., Jackson, C.: Clickjacking:
attacks and defenses. In: Presented as part of the 21st {USENIX} Security Sym-
posium ({USENIX} Security 2012), pp. 413–428 (2012)
13. Invernizzi, L., Thomas, K., Kapravelos, A., Comanescu, O., Picod, J.M., Bursztein,
E.: Cloak of visibility: detecting when machines browse a diﬀerent web. In: 2016
IEEE Symposium on Security and Privacy (SP), pp. 743–758. IEEE (2016)
14. Khan, M.T., Huo, X., Li, Z., Kanich, C.: Every second counts: quantifying the
negative externalities of cybercrime via typosquatting. In: 2015 IEEE Symposium
on Security and Privacy, pp. 135–150. IEEE (2015)
Winding Path
107
15. Kintis, P., et al.: Hiding in plain sight: a longitudinal study of combosquatting
abuse. In: Proceedings of the 2017 ACM SIGSAC Conference on Computer and
Communications Security, pp. 569–586 (2017)
16. Li, Z., Alrwais, S., Wang, X., Alowaisheq, E.: Hunting the red fox online: under-
standing and detection of mass redirect-script injections. In: 2014 IEEE Symposium
on Security and Privacy, pp. 3–18. IEEE (2014)
17. Mavrommatis, N.P.P., Monrose, M.: All your iframes point to us. In: USENIX
Security Symposium, pp. 1–16. USENIX Association (2008)
18. Mekky, H., Torres, R., Zhang, Z.L., Saha, S., Nucci, A.: Detecting malicious http
redirections using trees of user browsing activity. In: IEEE INFOCOM 2014-IEEE
Conference on Computer Communications, pp. 1159–1167. IEEE (2014)
19. Nikiforakis, N., et al.: You are what you include: large-scale evaluation of remote
javascript inclusions. In: Proceedings of the 2012 ACM Conference on Computer
and Communications Security, pp. 736–747 (2012)
20. Nikiforakis, N., Van Acker, S., Meert, W., Desmet, L., Piessens, F., Joosen, W.:
Bitsquatting: exploiting bit-ﬂips for fun, or proﬁt? In: Proceedings of the 22nd
International Conference on World Wide Web, pp. 989–998 (2013)
21. Scheitle, Q., et al.: A long way to the top: signiﬁcance, structure, and stability of
internet top lists. In: Proceedings of the Internet Measurement Conference 2018,
pp. 478–493 (2018)
22. Szurdi, J., Kocso, B., Cseh, G., Spring, J., Felegyhazi, M., Kanich, C.: The long
“taile” of typosquatting domain names. In: 23rd {USENIX} Security Symposium
({USENIX} Security 2014), pp. 191–206 (2014)
23. Tian, K., Jan, S.T., Hu, H., Yao, D., Wang, G.: Needle in a haystack: tracking down
elite phishing domains in the wild. In: Proceedings of the Internet Measurement
Conference 2018, pp. 429–442 (2018)
24. Vissers, T., Joosen, W., Nikiforakis, N.: Parking sensors: analyzing and detecting
parked domains. In: Proceedings of the 22nd Network and Distributed System
Security Symposium (NDSS 2015), pp. 53–53. Internet Society (2015)
25. Wang, D.Y., Savage, S., Voelker, G.M.: Cloak and dagger: dynamics of web search
cloaking. In: Proceedings of the 18th ACM Conference on Computer and Commu-
nications Security, pp. 477–490 (2011)
26. Yang, G., Huang, J., Gu, G.: Iframes/popups are dangerous in mobile webview:
studying and mitigating diﬀerential context vulnerabilities. In: 28th {USENIX}
Security Symposium ({USENIX} Security 2019), pp. 977–994 (2019)
27. Zeng, Y., Zang, T., Zhang, Y., Chen, X., Wang, Y.: A comprehensive measurement
study of domain-squatting abuse. In: ICC 2019–2019 IEEE International Confer-
ence on Communications (ICC), pp. 1–6. IEEE (2019)
28. Zhou, Y., Evans, D.: Understanding and monitoring embedded web scripts. In:
2015 IEEE Symposium on Security and Privacy, pp. 850–865. IEEE (2015)