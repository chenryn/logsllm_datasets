title:blackhat:eu-22 LCDPwn: Breaking Enterprise-Things with Layer 2 Discovery Protocol Vulnerabilities Again
When targeting enterprise devices, compared to higher layer protocols, the attack surface exposed by layer 2 protocols is often neglected. The recent research CDPwn, conducted by the Armis labs, sheds light on the severe impact of attack surface exposed by a proprietary layer-2 protocol called CDP (Cisco Discovery Protocol). It has gained lots of attention from the security research community, however, enterprise device vendors seem to pay little attention to it, including Cisco itself and this is where our work started.While learning CDPwn research, several questions came to our minds. Were these vulnerabilities well fixed? Was there any variant? What about other vendors, or it's just Cisco's own business? To answer these questions, firstly we started by analyzing the vulnerabilities covered in CDPwn, then conducted an in-depth analysis against the code to parse CDP packets again. Furtherly, since CDP is a Cisco proprietary protocol used in Cisco-manufactured devices, another vendor-neutral link layer protocol called LLDP (Link Layer Discovery Protocol) is used by other vendors. Based on the knowledge learned in this process, we continued to investigate the implementations for parsing LLDP packets in devices from common vendors. As a result, approximately 60 new bugs were found in CDP/LLDP packet parser, and affected nearly 70 kinds of devices from 30 well-known vendors, such as Cisco, Ubiquiti, TRENDnet, Zyxel, NETGEAR and so on.In this presentation, we will show our attempts to discover these new bugs in enterprise devices from well-known vendors. We will depict the format of CDP and LLDP protocol as well as their differences. We will discuss our research methodology. We will present a quantitative and qualitative study into vulnerabilities related to CDP/LLDP, showing several common lldp-components found in firmware from a wide variety of enterprise devices and the vulnerability patterns inside them. Finally, we will give a glimpse of the IEEE Standard 802.1AB and see how these vulnerabilities violate the standard.