speciﬁcation [47] PML is "an object-oriented request-reply
printer management protocol". PML is embedded within
PJL and can be used to read and set SNMP values on a
printer device. This is especially interesting if a ﬁrewall
blocks access to SNMP services (161/udp), but an attacker
is still able to print. The use of PML within a print job is
demonstrated in Listing 3.
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:27:18 UTC from IEEE Xplore.  Restrictions apply. 
M IB
(cid:2)(cid:3)(cid:4)(cid:5)
03
" . . . 6870204c617365724a65742034323530
(cid:3)
1 @PJL DMINFO ASCIIHEX="
2
len.
(cid:2)(cid:3)(cid:4)(cid:5)
06
get
(cid:2) (cid:3)(cid:4) (cid:5)
0000
(cid:5)(cid:2)
(cid:4)
OID
(cid:3)(cid:4)
(cid:2)
(cid:5)
0302010301"
"
hpLaserJet4250 (hexdecimal)
Listing 3: PML request to read the device description.
As one can see, with the help of PML it is possible to
invoke SNMP commands embedded in PJL. In this work,
PML is used to reset the printer to the factory-defaults.
2.4. Page Description Language (PDL)
A PDL speciﬁes the appearance of the actual document.
It must be, however, pointed out that some PDLs offer
limited job control, so a clear demarcation between page
description and printer/job control language is not always
possible. The function of a printer driver is to translate
the ﬁle to be printed into a PDL that is understood by
the printer model. There are various proprietary page de-
scription languages like Kyocera’s PRESCRIBE, Samsung
Printer Language (SPL), Xerox Escape Sequence (XES),
Canon Printing System Language (CaPSL), Ricoh Reﬁned
Printing Command Stream (RPCS), Epson Standard Code
for Printers (ESC/P), which is mostly used in dot matrix
printers or Hewlett-Packard Graphics Language (HP-GL),
and HP-GL/2, which have been designed for plotters. Sup-
port for direct Portable Document Format (PDF) and XML
Paper Speciﬁcation (XPS) printing is also common on newer
printers. The most common ‘standard’ page description lan-
guages, however, are the Printer Command Language (PCL)
(which is hard to exploit from a security perspective due to
its limited capabilities) and PostScript.
PostScript. The PostScript language was invented by Adobe
Systems between 1982 and 1984. It has been standard-
ized as PostScript Level 1 [50], PostScript Level 2 [61],
PostScript 3 [8], and in various language supplements.
While PostScript has lost popularity in desktop publishing
and as a document exchange format to PDF, it is still the
preferred page description language for laser printers.
PostScript is a stack-based, turing-complete, program-
ming language consisting of about 400 operators for arith-
metics, stack and graphic manipulation, and various data
types such as arrays or dictionaries. From a theoretical com-
puter science perspective, access to a PostScript interpreter
can already be classiﬁed as code execution because any
algorithmic function can theoretically be implemented in
PostScript.
Example code to print to stdout is given in Listing 4.
1 %!
2
( H e l l o world ) p r i n t
Listing 4: Example PostScript document.
In this work, PostScript is used for a variety of attacks,
such as DoS caused by inﬁnite loops, print job manipulation
and retention, as well as access to the printer’s ﬁle system.
216
3. Methodology
In this section, we introduce our methodology to collect,
analyze, and attack printers.
Acquiring the printers. Test printer devices were collected
as donations by various university chairs and facilities.
While our actual goal was to assemble a pool of printers
containing at least one model for each of the top ten manu-
facturers, we practically took what we could get. If available,
the latest ﬁrmware was installed prior to any tests to ensure
that any vulnerabilities had not already been patched in the
meantime. The assembled devices were not brand–new, nor
did the pool of test units contain models for all the top
vendors. It should, however, represent a good mixture of
printers and MFPs used in a typical university or ofﬁce
environment.
Analyzing approach. We surveyed which security sensitive
features exist in the PostScript and PJL standards, along with
their propriety extensions. We created a list of all potential
attacks, which can be carried out with these standards, and
classiﬁed them accordingly. Besides DoS attacks, bypassing
protection mechanisms, and print job manipulation, we were
especially interested in job retention and access to the ﬁle
system, which is a legitimate feature of both languages.
To facilitate the analysis, we implemented a Python 2
application – PRET – providing semi-automated tests. We
evaluated each attack and examined the impact, for example,
if stored print jobs could be read by an attacker.
Deployment channels. For detected weaknesses, we eval-
uated which attacker models are sufﬁcient to carry out the
presented attacks. Therefore, we researched which channels
exist to deploy malicious print jobs. Apart from direct or
network access to the device, we focused especially on
extending known cross-site printing techniques.
4. Attacker Model
Based on the existing deployment channels, we provide
an attacker model, which reﬂects the threat models we
extracted during our research. Our default attacker is an
attacker with a network access (AMnet), meaning anyone
who can access the targeted printer via TCP/IP, for example
an employee. However, most attacks described in this work
can also be carried out by a weaker web attacker (AMweb).
Physical Access (AMphy). A local attacker is the strongest
attacker. She has physical access to the printer device for a
limited amount of time. Her capabilities include: (1) plug-
ging in external storage media like memory cards or USB
sticks, (2) temporarily connecting to the printer device via
USB or parallel cable, (3) changing control panel settings
and pressing certain key combinations.
AMphy is a very strong attacker model but it is realistic
for most institutions and companies. Gaining physical access
to printer devices can generally be considered easier than for
other network components such as servers or workstations.
This is because printers are often shared by and accessible to
a whole department. Sneaking into an unlocked copy room
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:27:18 UTC from IEEE Xplore.  Restrictions apply. 
and launching a malicious print job from USB stick is only
a matter of seconds.
Network Access (AMnet). An active network participant
can connect
to a printer device via a TCP/IP network.
Speciﬁcally, she is capable of: (1) accessing all network
services offered by the device, including but not limited to
web, SMB, SNMP, LPD, IPP, or raw port 9100 printing,
(2) establishing various connections over a longer period.
(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:2)
(cid:7)(cid:8)(cid:9)
(cid:10)(cid:11)(cid:12)
(cid:13)(cid:1)(cid:1)
(cid:14)(cid:1)(cid:15)
(cid:8)(cid:16)(cid:9)
(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:4)(cid:6)(cid:7)(cid:8)
(cid:9)(cid:10)(cid:4)(cid:11)(cid:12)(cid:13)(cid:14)(cid:6)(cid:15)
(cid:11)(cid:17)(cid:17)
Figure 3: The attacker can send malicious print jobs by
accessing the printer via a TCP/IP network.
While it is uncommon to make printing devices directly
reachable from the Internet, a security incident in February
2017 showed that 150.000 printers could be accessed by
anyone over the Internet.1 Furthermore, intranet printers are
attractive targets for an insider whose goal is to obtain the
payroll print jobs of the department manager, or colleagues,
from a shared device.
It is also worth mentioning that many new printers bring
their own wireless access point (unencrypted by default) to
allow for easy printing, for example, via AirPrint compatible
mobile apps [10], or they automatically connect to an access
point provided by the attacker with a "default" SSID. While
communicating with a printer through Wi-Fi requires the
attacker to stay physically close to the device, it may be
feasible to perform her attack from outside of the targeted
institution, depending on the signal strength.
Web Attacker (AMweb) – Cross-site printing. AMweb is
the weakest attacker model and thus requires less resources
on the attacker’s side. The so called cross-site printing
technique [62] is directly related to this attacker model and
enables the execution of different attacks, even outside the
network where the printer is located. Cross-site printing is
used as a carrier for the attack payload.
(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:4)(cid:6)(cid:7)(cid:8)
(cid:9)(cid:10)(cid:4)(cid:11)(cid:12)(cid:13)(cid:14)(cid:6)(cid:15)
(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:2)
(cid:7)(cid:8)(cid:9)
(cid:10)(cid:11)(cid:12)
(cid:13)(cid:1)(cid:1)
(cid:14)(cid:1)(cid:15)
(cid:8)(cid:16)(cid:9)
(cid:9)(cid:2)(cid:17)(cid:18)(cid:19)(cid:6)(cid:2)
(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:4)(cid:6)(cid:7)(cid:8)
(cid:9)(cid:10)(cid:4)(cid:11)(cid:12)(cid:13)(cid:14)(cid:6)(cid:15)
(cid:16)(cid:20)(cid:21)(cid:3)(cid:22)(cid:3)(cid:17)(cid:23)(cid:19)(cid:24)
(cid:12)(cid:6)(cid:25)(cid:19)(cid:3)(cid:5)(cid:6)
Figure 4: The attacker can send malicious print jobs through
the end-user’s browser.
The only requirement in this attacker model is that a web
attacker controls the content of a website and is able to lure
a victim to this website. By visiting the website, the attacker
1. BBC News, Hacker brieﬂy hijacks insecure printers, http://www.bbc.
com/news/technology-38879671, Mar. 2017
can deploy JavaScript code to be processed by the victim’s
web browser. Thus, the attacker initiates AJAX requests to
port 9100 of the victim’s intranet printer and sends raw
PostScript or PJL commands. Consequentially, the printer
executes the malicious code. This way, the attacker can reach
even printers which are not directly visible from the Internet.
An important limitation of this attacker model is the
missing backchannel. In other words, the attacker can send
malicious commands to the printer but cannot get the result.
The reason for this limitation is the same-origin policy
within the browser disabling the cross-site access.
5. Attacks
In the following we collect the attacks from the literature
and propose new approaches. At the end of each section we
summarize the attack goals and its applicability in different
attacker models.
5.1. Denial-of-Service (DoS)
The goal of the DoS attack is to keep the printer busy by
processing malicious ﬁles, to disable printing functionality,
or even to cause long-term storage damage. It is applicable
in all attacker models.
Any network resource can be slowed down or even made
completely unavailable to a legitimate end-user by consum-
ing its resources in terms of CPU/memory or bandwidth. In
our work, we concentrate on DoS attacks based on print job
content. Therefore, we do not consider classical attacks like
SYN ﬂooding [15] or more advanced Slowloris attacks [30].
Trivial attacks like sending a lot of print jobs or blocking the
transmission channel (port 9100/tcp) are also out of scope.
Document processing. Page description languages allow-
ing inﬁnite loops or calculations, which require a lot of
computing time, can be abused to keep the printer’s Raster
Image Processor (RIP) busy. Examples of this are PostScript
programs or complex HP-GL calculations. Malicious PJL or
PostScript commands embedded in a document can further
be used to completely disable printing functionality.
Physical damage. Long-term settings for printers and other
embedded devices are stored in Non-Volatile Random-
Access Memory (NVRAM) which is traditionally imple-
mented either as Electrically Erasable Programmable Read-
Only Memory (EEPROM) or as ﬂash memory. Both compo-
nents have a limited lifetime. On early HP LaserJets ‘ﬂash
chips would only sustain about 1000-2000 cycles of re-
writing’ [24]. Today, vendors of ﬂash memory guarantee
about 100,000 rewrites before any write errors may occur.
This number sounds large, but PJL and PostScript print
jobs themselves can change long-term settings like default
paper tray media sizes or even passwords. Doing this many
times can be a realistic attack scenario leading to physical
destruction of the NVRAM. Such ideas are not new. The
ﬁrst PostScript malware in the wild, which appeared in 1990
[31], applied the setpassword operator multiple times which
quickly led to the password becoming unchangeable because
217
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:27:18 UTC from IEEE Xplore.  Restrictions apply. 
of very limited EPROM write cycles on early LaserWriter
printers. Note that printing functionality itself is not affected
by this attack, but ﬁxed settings like a high default number
of copies can make the device practically unusable.
AM
App.
AMphy
AMnet
AMweb
Description
The attacker can sneak into the copy room and
disable printing functionality to others via USB.
The attacker can send malicious print jobs via port
9100 and physically destroy the device’s NVRAM.
The attacker can cause an endless loop by cross-
site printing a malicious PostScript document to
make intranet printers of her victim unavailable.
TABLE 1: Applicability and examples of DoS attacks re-
garding the deﬁned attacker models.
5.2. Protection bypass
The idea of the attack described in this section is to
circumvent protection mechanisms.
Access to printers can be restricted based on different
policies. A formal policy-based security model for access
control on MFPs has recently been proposed by Lukusa et
al.[42]. Typically, security-critical management capabilities
are granted to an administrator and document printing can
be executed by a certain group of end-users. However, these
security measures can be bypassed if the device is reset to
factory defaults, or if backdoors are deployed.
Factory defaults. Resetting a device to factory defaults is
a security-critical functionality as it overwrites protection
mechanisms like user-set passwords. This can usually be
done by pressing a special key combination on the printer’s
control panel. However, physical access to the device is
not always an option. Interestingly, via SNMP, PML and
PostScript commands a reset can also be done.
Backdoors. Another way to bypass protection mechanisms
on printer devices are backdoors. There exist several CVEs
describing backdoors in printers. For example, Kyocera
3830 printers contained a backdoor that allowed remote
attackers to read and modify conﬁgurations via strings
that started with "!R!SIOP0" [2]. Samsung (and some
DELL) printers enabled a remote attacker to execute ac-
tions with administrator privileges using hardcoded SNMP
commands [4]. This was possible even if SNMP had been
disabled on the affected printers.
AM
App.
AMphy
AMnet
AMweb
Description
An attacker without a valid PIN can press certain
control panel keys to restore factory defaults.
The attacker can restore factory defaults via SNMP
and bypass the embedded web servers password.
The attacker can send PML commands to disable
protection mechanisms using cross-site printing.