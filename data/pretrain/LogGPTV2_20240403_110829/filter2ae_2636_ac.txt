                Public Key Algorithm: rsaEncryption
                    Public-Key: (2048 bit)
                    Modulus:
                        00:da:ce:77:ab:d9:e2:99:25:28:c1:4c:8e:15:ac:
                        22:5a:8a:31:80:0f:20:3b:1d:a9:a6:d2:76:71:25:
                        a0:8b:08:41:31:7a:7f:b9:d3:12:f4:c0:d6:d5:03:
                        bf:7b:e7:56:f2:f0:5b:c4:69:ca:6f:aa:d5:eb:86:
                        a7:06:2f:67:2b:93:d2:70:33:45:40:f7:18:48:68:
                        d4:4f:65:5c:91:7c:aa:64:d4:e2:37:7b:7e:66:83:
                        fe:b3:be:69:20:9b:20:5d:dd:1a:02:0d:53:e8:2a:
                        91:7a:84:c5:12:66:bb:51:6c:c0:40:4a:9d:b5:19:
                        39:35:3a:1d:80:55:7f:b0:85:61:8e:a5:87:24:7c:
                        32:59:35:0d:2c:2e:80:6d:f1:a4:96:1d:12:aa:c9:
                        a6:88:90:15:18:b3:c6:93:8e:49:36:53:20:d7:23:
                        6c:5c:40:4e:23:87:8b:9f:6b:41:d2:52:ac:18:65:
                        d8:6f:d9:a0:43:e6:e9:45:a2:81:e2:7e:f5:8b:0d:
                        91:d2:c0:93:9b:8c:65:18:93:c1:de:1f:f2:82:0c:
                        43:54:17:e9:79:7d:3d:d3:6b:bf:2b:d2:02:8a:93:
                        7c:13:8f:1f:4f:62:81:58:54:81:4f:70:83:57:b0:
                        47:62:1b:81:00:76:3c:46:6d:e7:07:1d:aa:35:5a:
                        c8:f9
                    Exponent: 65537 (0x10001)
            X509v3 extensions:
                X509v3 Key Usage: critical
                    Digital Signature, Key Encipherment
                Authority Information Access:
                    CA Issuers - URI:http://secure.globalsign.com/cacert/gsorganizationvalsha2g2r1.crt
                    OCSP - URI:http://ocsp2.globalsign.com/gsorganizationvalsha2g2
                X509v3 Certificate Policies:
                    Policy: 1.3.6.1.4.1.4146.1.20
                      CPS: https://www.globalsign.com/repository/
                    Policy: 2.23.140.1.2.2
                X509v3 Basic Constraints:
                    CA:FALSE
                X509v3 Subject Alternative Name:
                    DNS:*.bilibili.com, DNS:bilibili.com
                X509v3 Extended Key Usage:
                    TLS Web Server Authentication, TLS Web Client Authentication
                X509v3 Subject Key Identifier:
                    0D:DB:87:B5:F7:C5:57:18:2B:1F:71:56:19:64:1A:DE:C3:C9:12:06
                X509v3 Authority Key Identifier:
                    keyid:96:DE:61:F1:BD:1C:16:29:53:1C:C0:CC:7D:3B:83:00:40:E6:1A:7C
                1.3.6.1.4.1.11129.2.4.2:
                    ...i.g.u..u..Y|..C._..n.V.GV6.J.`....^......e.........F0D. ^.R..~AV|..A.....@..c.......u ... A$MqBP..iY1Jl]c......}..o.p.(.t..v.......X......gp
    .....e.........G0E. s.2...-.*+..!......+Ui..2....j;..!..v..v$-m.R..Z#J. TB....3...7x..Y.v.oSv.1.1.....Q..w.......).....7.....e.........G0E.!....v]W....'.\G.]....B..Hn.c....u. ..Cb.....l0L.-.......O....7.....
        Signature Algorithm: sha256WithRSAEncryption
             35:13:01:e0:20:2c:84:ce:76:c9:91:9f:8e:74:f1:5e:49:0d:
             b9:2d:25:96:ae:e6:87:02:52:ce:0e:d7:64:71:81:8f:30:90:
             85:24:e1:2c:17:9c:78:31:97:c7:e8:c2:b2:3d:fd:b7:b1:41:
             25:94:1b:45:79:d4:33:8c:c0:1b:0c:0d:85:3b:8d:41:eb:0c:
             34:51:54:26:80:e6:a0:d4:ac:75:b3:c9:e9:16:8b:ae:9d:bd:
             2f:9a:2c:a2:29:49:20:aa:53:88:c7:70:64:ea:d6:67:a3:e7:
             c4:48:f1:16:64:a5:7a:6b:93:b0:af:00:ee:1c:5f:8d:d2:07:
             b7:ec:b7:da:1a:d8:e2:07:01:37:e0:78:6a:1c:d7:0d:9b:91:
             f0:7c:36:c6:8e:f2:59:d0:0a:f0:54:a8:db:a3:f5:c3:1a:24:
             03:38:86:b0:37:da:89:c1:70:35:c0:1e:02:a2:65:2a:95:68:
             b1:0e:40:56:0c:82:00:5d:8a:9f:f1:50:d9:ed:4b:43:d9:59:
             c8:70:75:ab:85:37:13:89:09:07:08:81:ca:b2:0a:bd:b9:57:
             52:d0:8d:4e:9c:64:06:4a:87:e3:71:3d:b5:47:91:a1:2d:0f:
             75:46:55:81:ea:a1:31:64:ce:27:c5:59:2e:bf:b5:2c:82:07:
             a2:32:b9:91
可以看到实际中的公钥指数 _e_ 为65537，这里的Modulus即为 _n_
，使用冒号分隔十六进制的方式表示，转换为整数是`0x00dace77d9e2...`，另外如名字所言，X509第三版(v3)包含了可选的拓展选项，对于HTTPS而言最重要的是`Subject
Alternative
Name`，即所认证的域名。其他拓展选项详细说明可以参考[RFC5280](https://tools.ietf.org/html/rfc5280
"RFC5280")的介绍。
# 秘钥分析
最后再来分析几个实际落到我们磁盘上的秘钥结构。
## ssh
对于开发者而言ssh都不会陌生，其除了可以使用密码登录远程服务器，也可以通过私钥登录。使用`ssh-keygen`工具可以直接生成私钥`id_rsa`和公钥`id_rsa.pub`，格式为RSA-2048。先看公钥：
    ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDEkBTUATNtj5xzF8S+CXzh+8A3LzTXeHyIZams0g37hAFi1SmYK82QAANxUzypUSZSHTY+WnMjOmNEpqgEmE5MWg3tYp4hK7tSyI2/UYUQu8y9KUPa7dnwYA+gkPWxM4sEu3u3bh6dP6bf/t8u6I1fca4tmiEcIqlq3DRz9YQXwIHr27ld5gHFiyEO6vi1ECtddnz6DKuzpQ6Dj1QNVmCF6N81DXfpmTRmVIZV+vZbfD35f1/iw116jQ5lW5VVF00fz7NqYgdK3KH9TiSexJduXjMczyamrTjotNpWZo98JcltkxJF1vYRPIDgX7rTbOzIV/DiCzgROU3JmacI9lmf evilpan
其中重要的中间的base64，解码后hexdump出来如下：
    00000000: 0000 0007 7373 682d 7273 6100 0000 0301  ....ssh-rsa.....
    00000010: 0001 0000 0101 00c4 9014 d401 336d 8f9c  ............3m..
    00000020: 7317 c4be 097c e1fb c037 2f34 d778 7c88  s....|...7/4.x|.
    00000030: 65a9 acd2 0dfb 8401 62d5 2998 2bcd 9000  e.......b.).+...
    00000040: 0371 533c a951 2652 1d36 3e5a 7323 3a63  .qSZs#:c
    00000050: 44a6 a804 984e 4c5a 0ded 629e 212b bb52  D....NLZ..b.!+.R
    00000060: c88d bf51 8510 bbcc bd29 43da edd9 f060  ...Q.....)C....`
    00000070: 0fa0 90f5 b133 8b04 bb7b b76e 1e9d 3fa6  .....3...{.n..?.
    00000080: dffe df2e e88d 5f71 ae2d 9a21 1c22 a96a  ......_q.-.!.".j
    00000090: dc34 73f5 8417 c081 ebdb b95d e601 c58b  .4s........]....
    000000a0: 210e eaf8 b510 2b5d 767c fa0c abb3 a50e  !.....+]v|......
    000000b0: 838f 540d 5660 85e8 df35 0d77 e999 3466  ..T.V`...5.w..4f
    000000c0: 5486 55fa f65b 7c3d f97f 5fe2 c35d 7a8d  T.U..[|=.._..]z.
    000000d0: 0e65 5b95 5517 4d1f cfb3 6a62 074a dca1  .e[.U.M...jb.J..
    000000e0: fd4e 249e c497 6e5e 331c cf26 a6ad 38e8  .N$...n^3..&..8.
    000000f0: b4da 5666 8f7c 25c9 6d93 1245 d6f6 113c  ..Vf.|%.m..E...<
    00000100: 80e0 5fba d36c ecc8 57f0 e20b 3811 394d  .._..l..W...8.9M
    00000110: c999 a708 f659 9f                        .....Y.
这些数据怎么解析呢？查阅`RFC4253`我们可以发现ssh公钥的定义如下：
    The "ssh-rsa" key format has the following specific encoding:
          string    "ssh-rsa"
          mpint     e
          mpint     n
而在`RFC4251`中包含了string和mprint类型的定义：
    string
        [...] They are stored as a uint32 containing its length
        (number of bytes that follow) and zero (= empty string) or more
        bytes that are the value of the string.  Terminating null
        characters are not used. [...]
    mpint
        Represents multiple precision integers in two's complement format,
        stored as a string, 8 bits per byte, MSB first. [...]
说白了三个字段都是Length-Value格式，转换如下：
    (4 bytes)   00 00 00 07          = 7
    (7 bytes)   73 73 68 2d 72 73 61 = "ssh-rsa" 字符串
    (4 bytes)   00 00 00 03          = 3
    (3 bytes)   01 00 01             = 65537 (公钥指数e)
    (4 bytes)   00 00 01 01          = 257
    (257 bytes) 00 c4 .. f6 59 9f    = 模n
再看私钥：
    -----BEGIN OPENSSH PRIVATE KEY-----    b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
    NhAAAAAwEAAQAAAQEAxJAU1AEzbY+ccxfEvgl84fvANy8013h8iGWprNIN+4QBYtUpmCvN
    kAADcVM8qVEmUh02PlpzIzpjRKaoBJhOTFoN7WKeISu7UsiNv1GFELvMvSlD2u3Z8GAPoJ
    ...