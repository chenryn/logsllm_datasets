title:Improving robustness of DNS to software vulnerabilities
author:Ahmed Khurshid and
Firat Kiyak and
Matthew Caesar
IMPROVING ROBUSTNESS OF DNS GRAPH CLUSTERING AGAINST NOISE
A Dissertation
Presented to
The Academic Faculty
By
Yizheng Chen
In Partial Fulﬁllment
of the Requirements for the Degree
Doctor of Philosophy in the
School of Computer Science
Georgia Institute of Technology
December 2017
Copyright c(cid:13) Yizheng Chen 2017
IMPROVING ROBUSTNESS OF DNS GRAPH CLUSTERING AGAINST NOISE
Approved by:
Dr. Manos Antonakakis, Advisor
School of Electrical and Computer
Engineering
Georgia Institute of Technology
Dr. Wenke Lee
School of Computer Science
Georgia Institute of Technology
Dr. Roberto Perdisci
Department of Computer Science
University of Georgia
Dr. Mustaque Ahamad
School of Computer Science
Georgia Institute of Technology
Dr. Raheem Beyah
School of Electrical and Computer
Engineering
Georgia Institute of Technology
Date Approved: October 13, 2017
To my parents,
for all the support and love.
ACKNOWLEDGEMENTS
First of all, I am deeply grateful for my advisors Dr. Manos Antonakakis and Dr. Wenke
Lee. Dr. Manos Antonakakis showed me the best quality a great researcher could have:
never get disappointed. He believed in me when I did not believe in myself. The guidance
and support from Dr. Wenke Lee taught me critical thinking and broader views of making
a contribution to the security research community.
I would like to thank my thesis committee members Dr. Roberto Perdisci, Dr. Mustaque
Ahamad, and Dr. Raheem Beyah for taking time to serve on my thesis committee. Their
insightful feedback has helped me improve this thesis tremendously.
I have been fortunate to work with some brilliant people during my Ph.D. study. Dr.
Yacin Nadji is always available for brainstorming ideas, even by sacriﬁcing his own time.
I cannot thank him enough for his help. Panagiotis Kintis has helped with many important
experiments of research projects, and he is the most reliable teammate one can ﬁnd. This
dissertation would not be possible without the help from Dr. Nikolaos Vasiloglou, Dr.
Fabian Monrose, and David Dagon. In addition, I would like to thank Astrolavos colleagues
Chaz Lever, Athanasios Kountouras, Rosa Romero-G´omez, and Omar Alrawi.
I am grateful for the inspiring collaborators and colleagues: Dr. Tielei Wang, Dr. Si-
mon P. Chung, Dr. Yeongjin Jang, and Billy Lau; my internship mentors, Dr. Vinod
Yegneswaran and Dr. Nektarios Leontiadis for helping me become a better researcher.
My friends have helped me survive the most difﬁcult times in the Ph.D. program. Spe-
cial thanks to Qiaoyi Xu, Dr. Wei Meng, Dr. Byoungyoung Lee; my cooking night crew:
Dr. Adrian Lam, Tiffany Tse, Dr. Samantha Lo, Dr. Brian Gestner, Dr. Samson Lai, Dr.
Elaine Tang, Dr. Jeff Wong, Wenny Liu, Dr. Leung Kin Chiu, Wesley and others.
Last but not least, I must thank my parents for their unconditional love and support to
pursue my dream.
i
TABLE OF CONTENTS
Acknowledgments .
.
.
List of Tables . .
. .
. .
List of Figures
.
. .
. .
.
.
.
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
i
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . vii
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
ix
Chapter 1: Introduction .
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.1 Thesis Contributions
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
.
.
1.1.1
Financial Lower Bounds of Online Advertising Abuse
. . . . . . .
1.1.2 Measuring Network Reputation in the Ad-Bidding Process . . . . .
1.1.3 Adversarial Analysis of Graph-based Detection System . . . . . . .
1.2 Dissertation Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . .
.
Chapter 2: Background .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1 Graph Clustering Methods
. . . . . . . . . . . . . . . . . . . . . . . . .
.
2.1.1 Connected Component
. . . . . . . . . . . . . . . . . . . . . . . .
1
3
4
5
6
7
9
9
9
2.1.2 Community Detection . . . . . . . . . . . . . . . . . . . . . . . . 10
2.1.3
Spectral Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.1.4
node2vec .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
2.2 Online Advertising Ecosystem . . . . . . . . . . . . . . . . . . . . . . . . 12
ii
Chapter 3: Financial Lower Bounds of Online Advertising Abuse
. . . . . . . . 15
3.1 Motivation .
.
.
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
3.2 Background . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
3.2.1 Botnets and Sinkholes
. . . . . . . . . . . . . . . . . . . . . . . . 16
3.2.2 Observing Ad-abuse In Local Networks . . . . . . . . . . . . . . . 18
3.3 Ad-abuse Analysis System . . . . . . . . . . . . . . . . . . . . . . . . . . 19
3.3.1
System Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
3.3.2 Datasets to Study Ad-abuse . . . . . . . . . . . . . . . . . . . . . . 21
3.3.3 DNS Ad-abuse Rate Module . . . . . . . . . . . . . . . . . . . . . 22
3.3.4
Spectral Expansion Module . . . . . . . . . . . . . . . . . . . . . . 23
3.3.5 Reports On Ad-abuse And Financial Models . . . . . . . . . . . . . 27
3.4 Dataset Collection .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
3.4.1
Sinkhole Datasets . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
3.4.2
Passive DNS Datasets . . . . . . . . . . . . . . . . . . . . . . . . . 31
3.5 Analysis and Measurements . . . . . . . . . . . . . . . . . . . . . . . . . . 32
3.5.1 Computing the DNS Ad-abuse Rate . . . . . . . . . . . . . . . . . 32
3.5.2
Spectral Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
3.6 Ad-abuse Reports .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
3.6.1 C&C Infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . 39
3.6.2
Financial Analysis
. . . . . . . . . . . . . . . . . . . . . . . . . . 41
3.7 Discussion .
. .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
3.7.1 Ground Truth Behind The Financial Loss
. . . . . . . . . . . . . . 45
3.7.2 Ground Truth Behind TDSS/TDL4 . . . . . . . . . . . . . . . . . . 46
iii
3.7.3
Smart Pricing Data For Impressions and Clicks . . . . . . . . . . . 46
3.8 Related Work . .
3.9 Summary . .
. .
.
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Chapter 4: Measuring Network Reputation in the Ad-Bidding Process . . . . . . 50
4.1 Motivation .
.
.
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
4.2 Real-Time Bidding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
4.3 Datasets . .
. .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
4.3.1 DSP Trafﬁc . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
4.3.2 Other Datasets
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
4.4 Fraudulent Publisher Domains
. . . . . . . . . . . . . . . . . . . . . . . . 57
4.4.1 Case 1: PUP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
4.4.2 Case 2: Afﬁliate Marketing . . . . . . . . . . . . . . . . . . . . . . 57
4.5 Measurement
. .
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
4.5.1
Summary of Findings . . . . . . . . . . . . . . . . . . . . . . . . . 58
4.5.2 Client Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
4.5.3 Reputation Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . 60
4.6
Infrastructure Tracking . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
4.6.1 Constructing Infrastructure Graphs . . . . . . . . . . . . . . . . . . 67
4.6.2
Identifying Suspicious Components
. . . . . . . . . . . . . . . . . 69
4.6.3 Tracking Campaigns Over Time . . . . . . . . . . . . . . . . . . . 71
4.7 Case Studies .
.
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
4.7.1 Case 1: PUP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
iv
4.7.2 Case 2: Algorithm Generated Domains
. . . . . . . . . . . . . . . 73
4.7.3 Case 3: Malware Site . . . . . . . . . . . . . . . . . . . . . . . .
. 74
4.8 Related Work . .
4.9 Summary . .
. .
.
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
Chapter 5: Practical Attacks Against Graph-based Clustering . . . . . . . . . . 76
5.1 Motivation .
.
.
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
5.2 Related Work .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
5.3 Threat Model & Attacks
. . . . . . . . . . . . . . . . . . . . . . . . . . . 79
5.3.1 Notation .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
5.3.2 Threat Model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
5.3.3 Attacks
.
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
5.4 Attacks in Practice
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
5.4.1
Pleiades .
5.4.2 Attacks