Electromagnet 
active; pulls on 
ferrous material 
MCU 
(Looking longitudinally) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Scenario 2, cont.: Gun can fire 
Electromagnet 
rotates pin 
block 
remainder of 
distance 
MCU 
Firing pin matches hole; 
Pin is unblocked; 
Gun can fire 
(Looking longitudinally) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
US patent 8,966,803 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Actual weapon 
Electromagnet 
Top view of receiver 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Mechanism in slide 
Ferrous material 
Cam presses here 
Profile view of slide 
Bottom view of slide 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Mechanical attack 
• Use a Big-Ass™ Magnet 
• Put the magnet next to the pistol so that it will 
fill in for the electromagnet 
• Needs to be strong, but not too strong 
– Too strong will stop everything from moving 
• A stack of three 1.25” diameter, 0.2” height 
N52 neodymium magnets works well 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Magnet attack 
MCU 
(Looking longitudinally) 
Electromagnet 
not active 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Magnet attack 
MCU 
(Looking longitudinally) 
External magnet pulls 
ferrous material; 
Pin unblocked; 
Gun can fire 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Magnets 
• N52 neodymium magnets 
• 32 mm  5 mm 
• $19 on Amazon for a four-
pack (only three are 
required) 
• Cost 
– $14.75 magnets 
– $0.20 scrap dowel 
– $0.05 stainless screw 
– Total: $15 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Completed magnet tool 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Magnet alignment 
Align magnet 
here 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Magnets on pistol 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Magnet attack results 
• Works great! 
– Fire the pistol without the watch 
– Fire the pistol even without any batteries 
• Caveats: 
– Magnet can prevent trigger from resetting 
– Occasional issue with light primer strikes 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
(Demo of magnet attack) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Defense 
• Don’t use magnets, solenoids, etc. 
– Nothing involving a DC magnetic field 
– Consider motor-driven mechanism 
• Detect external field and activate secondary 
lock 
– Kind of like a relocker in a safe 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Lessons for future guns 
• Lock is only as good as its weakest link 
• Robust, secure electronics don’t matter if they 
can be defeated with a magnet 
– The “Sentry Safe” lesson 
• More secure unlocking mechanisms are 
contemplated in the Armatix patents 
– Why didn’t they use them? 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
THANKS! 
Updated slides will be available on DEF CON web site within a few weeks 
PI:EMAIL 
@_plore 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
BACKUP SLIDES 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Armatix iP1 
• Custom semi-auto pistol design 
• Fires .22 LR cartridge 
• Hammer fired 
• Introduced ca. 2015 
• “Smart” authorization via paired wristwatch 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Armatix iP1: pistol field strip 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Size comparison 
Glock 17 
Armatix iP1 
Ruger SR22 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Design internals 
• MSP430 microcontroller 
• Murata TR1000  
– 916.5 MHz transceiver 
– OOK modulation 
• Ferrite-core coil for NFC 
• FCC equipment cert database is amazing 
– Interior photos, EMC test results, etc. 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Unlock sequence 
• Pistol sends 5.35 kHz CW chirp for 1.5 ms 
– No data; just carrier 
– Range of about 25 cm 
• Watch receives chirp and sends unlock response on 
916.5 MHz 
• Pistol ACKs 100 ms later on 916.5 MHz 
• If watch sent correct code, pistol enables firing 
• Watch retries once after 400 ms if no ACK 
• LED on pistol grip 
– Green = auth token, can fire 
– Red = no token, cannot fire 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Operation overview 
• Pair watch and pistol 
– Long PIN to do this (only needed once) 
• Sync watch and pistol 
– Auth tokens are time-dependent 
– Clock drifts badly, so need to do this often 
• Enable firing on watch 
– 5-digit PIN (4 values per digit; 1024 possibilities) 
– Activates watch for 2-8 hours (selectable) 
• Squeeze pistol backstrap 
• Pistol sends 5.35 kHz chirp to watch 
• Watch sends auth code to pistol via RF 
• Pistol enables firing by unblocking firing pin 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Watch/pistol comms 
• OOK, Manchester coding 
• 30 kbit/s raw, 2 kbytes/s net 
• 8-bit checksum 
• 8 data bits plus one start bit 
– Least-significant bit first 
• 19-byte frame from watch to pistol 
• 13-byte frame from pistol to watch 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Watch and Pistol on 916.5 MHz 
Watch 
sends token 
Pistol ACKs 
token 
100 ms 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Watch and pistol on spectrum analyzer 
Pistol 
Watch 
-40 dBm 
0 Hz span – 100 ms/div 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
How to defeat proximity 
• Relay 5.35 kHz burst 
– First device: 
• Listen for 5.35 kHz chirp 
• Send indication that chirp occurred over backhaul 
– Second device: 
• Listen for trigger on backhaul about chirp 
• Generate 5.35 kHz chirp near watch 
• Watch thinks it’s hearing from pistol, sends auth token at 916.5 
MHz 
• 916.5 MHz reply strong enough for at least 3 m 
– TX power from watch roughly -20 dBm 
– Could be similarly proxied over backhaul for limitless range 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Proximity-defeat results 
• Works reliably to at least 3 m 
– 12x range improvement 
• Limit now is 916.5 MHz radio link 
– Could work arbitrarily far with a 916.5 MHz relay 
• Relay adds about 630 us latency 
– System tolerates it 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Proximity-defeat HW 
• Custom hardware, pulse listener: 
– Tuned coil placed near pistol 
– 5.35 kHz bandpass filter/amplifier 
– Microcontroller (PIC16F) sampling and watching for burst 
from pistol 
– 2.4 GHz transmitter (nRF24) to trigger generator 
• Custom hardware, pulse generator: 
– Tuned coil placed near watch  
– Microcontroller generating 5.35 kHz chirp 
– Simple Class C amp driving coil (MOSFET connected to 
GPIO) 
– 2.4 GHz receiver to receive trigger signal 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Latency of relay 
Radio TX start 
Slave NFC start 
400 us latency  
due to radio, SPI, etc 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Latency of relay 
Pistol NFC start 
Slave NFC start 
630 us overall latency 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
How sensitive to interference? 
• OOK modulation is highly susceptible to interference 
– 916.5 MHz module datasheet used in iP1 warns that slicer 
will be “blinded” by strong noise pulses1 
– Slicer will also be fooled by lone pulses in bit timeslot that 
are less than 6 dB down from the normal bit peaks 
• Signal from watch measured at -40 dBm @ 10 cm 
– Typical distance between pistol and watch 
– Implies actual TX power of about -20 dBm 
• Ballpark: interference signal at least -50 dBm at pistol 
will prevent reception of signal from watch 
– …even when pistol is very close to watch 
1 http://wireless.murata.com/media/products/apnotes/ook.pdf 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Theory 
• Constant carrier has effect only up to about 1 m 
• Why pulsed carrier? 
– Short range: our pulse is stronger than normal 
pulses, so slicer level is set too high 
– Mid range: our pulse about the same strength as 
normal pulses, so bit interference high (edges 
missing, so bits can’t be decoded) 
– Long range: our pulse comes before packet/byte 
sync, prevents packet/byte sync, corrupting packet 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Transmitter output 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Unmodulated carrier spectrum 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Modulated transmitter spectrum 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Transmitter over watch signal 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Electronic attack 
• Impersonate watch? 
• Replay attack? 
– Perhaps including forcing pistol/watch time to 
specific moment 
• Some other exploit? 
• Investigated, but then… 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Mechanical operation 
• Hammer always falls 
• Firing pin blocked unless authorized 
• If authorized, electromagnet is energized as long 
as backstrap remains pulled 
• Half-pull of trigger moves cam in receiver that 
moves linkage in slide 
– Partially unblocks firing pin 
• The half-pull moves a ferrous material within 
range of the electromagnet 
– Electromagnet pulls linkage the remainder of the way, 
unblocking the firing pin 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
You can do this 
without even taking 
the magnets out of 
their retail packaging 
Magnet axis at angle 
relative to grip 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Firing pin visible through “loaded chamber” 
inspection port when dry-fired after 
successfully bypassed with magnet or 
authorized normally. 
(Firing pin not visible after 
unauthorized/unbypassed attempt to fire, 
indicating it was blocked) 
PRELIMINARY SLIDES 
FINAL DECK AVAILABLE AFTER DEF CON 
Tools for reverse engineering 
• Wealth of information on government sites 
– Patents 
• Detailed drawings and explanations of mechanical 
design 
• Search not just on company name but also on names of 
inventors for the company’s principal patents 
– FCC certification database 
• Interior photos 
• RF emissions 
• https://www.fcc.gov/oet/ea/fccid