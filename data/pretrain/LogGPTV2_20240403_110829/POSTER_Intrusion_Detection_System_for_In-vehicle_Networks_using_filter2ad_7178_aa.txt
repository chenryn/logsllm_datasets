title:POSTER: Intrusion Detection System for In-vehicle Networks using
Sensor Correlation and Integration
author:Huaxin Li and
Li Zhao and
Marcio Juliato and
Shabbir Ahmed and
Manoj R. Sastry and
Lily L. Yang
Intrusion Detection System for In-Vehicle Networks
Yoshihiro HAMADA*,  Masayuki INOUE,  Naoki ADACHI,  Hiroshi UEDA,  
Yukihiro MIYASHITA,  and  Yoichi HATA
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
In  light  of  the  security  incident  of  the  Jeep  Cherokee  in  2015,  where  a  vehicle  was  illegally  controlled  remotely  using  spoofing 
messages inserted via a public mobile network, security measures have become one of the most crucial issues in the realization 
of autonomous driving and connected cars. Taking security measures for each unknown cyberattack requires quick detection of 
attacks that happen throughout the life cycle of the vehicles. This paper introduces an intrusion detection system (IDS) to detect 
spoofing messages at the central gateway. Additionally, we report on the detection performance of the system using messages 
from an actual in-vehicle network. 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Keywords: intrusion detection system, in-vehicle network, unknown cyberattack, central gateway, security
1. Introduction
Modern vehicles have 70 to 100 embedded controllers 
known  as  electronic  control  units  (ECUs)  connected  via 
in-vehicle  networks.  These  ECUs  achieve  safety  driving 
and  convenience  by  sharing  control  data  with  external 
services  via  networks  in  and  outside  of  the  vehicle. 
Meanwhile, the possibility of cyberattacks has been pointed 
out, in which the vehicle’s communications with the afore-
mentioned  external  services  are  abused  for  unauthorized 
remote  control  over  the  vehicle.  Countering  cyberattacks 
has  become  an  urgent  issue.(1)  In  order  to  take  suitable 
security measures to protect vehicles from cyberattacks, it 
is necessary to detect attacks on the vehicles. An intrusion 
detection system  (IDS)  is  known  as  a means  to  serve  for 
this purpose. The product life of a general vehicle model is 
more than 10 years. This implies that the vehicle would be 
subject  to  cyberattacks  that  are  unknown  at  the  time  of 
development. Consequently, it is critical for an in-vehicle 
IDS  to  detect  unknown  cyberattacks.  To  detect  unknown 
cyberattacks, an anomaly-based IDS is effective, detecting 
attacks based on the degree of deviation from the normal 
state  of  the  monitored  subject.  However,  research  on 
conventional  anomaly-based  IDSs  has  revealed  that  they 
do not do well in identifying spoofing messages that cyber 
attackers send and insert in in-vehicle networks. By identi-
fying  inserted  spoofing  messages,  it  becomes  possible  to 
reduce the time taken before implementing concrete coun-
termeasures  and  to  delimit  the  scope  of  the  countermea-
sures.  Therefore,  this  paper  proposes  an  anomaly-based 
detection system with a high detection capability for moni-
toring  control  data  contained  in  the  payload.  In  addition, 
the detection performance of this detection system is also 
reported,  being  evaluated  with  traffic  data  under  the 
Controller Area Network (CAN) protocol commonly used 
by in-vehicle networks.
2. CAN Protocol and Security Threats
2-1  Features of CAN
The CAN  protocol and the CAN  with Flexible Data 
Rate  (CAN  FD)  protocol  exist.  The  CAN  protocol  was 
76  ·  Intrusion Detection System for In-Vehicle Networks
standardized  by  ISO  11898-1  (2003).(2)  The  CAN  FD 
protocol  was  standardized  by  ISO  11898-1  (2015)(3)  as  a 
revision to ISO 11898-1 (2003). These protocols use a bus 
topology with multiple nodes (ECUs). Of these nodes, one 
that has obtained the transmission right through bus arbi-
tration  broadcasts  a  payload  comprised  of  up  to  8  bytes 
(CAN) or 64 bytes (CAN FD) to communicate low-latency 
messages for control systems.
2-2  Communication characteristics
Over  CAN,  messages  are  sent  in  the  CAN  frame 
format provided with a CAN-ID, which is a unique identi-
fier over an in-vehicle network, in two patterns. One is a 
transmission  pattern  used  to  send  CAN  frames  cyclically 
for the notification of key control information, such as the 
vehicle speed, engine speed, and accelerator position. The 
other  is  a  transmission  pattern  intended  for  noncyclic 
messages for the notification of events, such as unlocking 
and locking of the doors.
2-3  Network configuration
The CAN protocols use a bus topology. The maximum 
number  of  connected  ECUs  per  bus  is  limited.  For  this 
reason, systems that use many ECUs make up a network by 
incorporating gateways to relay from one bus to another, as 
shown  in  Fig.  1  (a).  With  these  systems,  the  presence  of 
multiple  gateways  between  buses  results  in  an  increasing 
communication  delay.  Figure  1  (b)  illustrates  a  network 
that incorporates a central gateway, in which the network 
consists  of  sub-networks  assigned  to  different  functional 
lines. Connecting these sub-networks with a single gateway 
reduces communication delay.
ECU
ECU
ECU
ECU
ECU
ECU
Gateway
Central 
gateway
Sub-network
ECU
ECU
ECU
ECU
ECU
ECU
ECU
Gateway
ECU
ECU
ECU
ECU
ECU
a) Connection via gateways
b) Connection via a central gateway
Fig. 1.  Network configuration
FEATURED TOPIC2-4  Security threats
Koscher et al. pointed out the following three vulnera-
bilities of the CAN protocols(4): (1) control information on a 
network can be easily analyzed; (2) spoofing messages can 
be easily inserted into the network; and (3) the CAN proto-
cols  are  vulnerable  to  denial-of-service  (DoS)  attacks.  In 
this regard, spoofing messages are inserted or DoS attacks 
are made via an attacker ECU connected to the CAN bus, 
as  represented  in  Fig.  2.  The  attacker  ECU  is  a  normal 
ECU until its firmware is tampered with or an unauthorized 
ECU connected to the network.
increasing overall number of subjects. Consequently, in an 
on-board environment, which is subject to memory capacity 
and  CPU  speed  limitations,  it  is  difficult  for  a  high-level 
monitoring system to monitor the entire in-vehicle network 
if no other monitoring system is used. Sumitomo Electric’s 
system  combines  the  above-mentioned  three  monitoring 
levels  to  apply  a  low-level  system  to  monitor  the  entire 
in-vehicle  network  and  a  high-level  system  to  monitor 
specific critical subjects in the vehicle.
Monitored subjects
Diﬃcult
Few
ECU
ECU
ECU
Attacker
ECU
CAN bus
Inserts spooﬁng messages.
Fig. 2.  Spoofing messages inserted by an attacker ECU
Monitoring level 1
Buses
Monitoring level 2
Messages
Monitoring level 3
Payloads
f
o
n
o
i
t
a
c
ﬁ
i
t
n
e
d
I
t
c
e
j
b
u
s
d
e
k
c
a
t
t
a
s
t
c
e
j
b
u
s
f
o
r
e
b
m
u
N
d
e
r
o
t
i
n
o
m
3. In-Vehicle Network Security Measures
3-1  Conventional technology
Studies on security measures for in-vehicle networks 
are divided into the following two classes. Vehicles with a 
long product life require an IDS to ensure continued secu-
rity  measures  even  when  its  secure  communications  are 
nullified by an unknown cyberattack.
(A) Secure communications
(B) IDS
Security measures at the level of network protocol
 Designed to operate at a higher level than the network 
protocol to detect dubious operations of applications or 
networks
3-2  IDS
Two types of IDSs exist: signature-based and anom-
aly-based. These systems detect an intrusion by detecting 
dubious behaviors of the monitored subject. The signature-
based system defines examples of anomalous usage of the 
monitored subject and detects operations that coincide with 
the  definition  of  dubious.  The  anomaly-based  system 
defines  normal  operations  of  the  monitored  subject  and 
detects  those  that  depart  from  the  definition  of  dubious. 
Unknown cyberattacks can only be detected by the anom-
aly-based detection system.
4. In-Vehicle IDS
4-1  Newly developed system
Sumitomo  Electric  Industries,  Ltd.  is  developing  an 
anomaly-based in-vehicle IDS, which has three monitoring 
levels distinguished according to the constituent elements of 
the in-vehicle network, as shown in Fig. 3. At higher moni-
toring levels, the system monitors splintered subjects, facili-
tating the identification of the attacked subject. As a result, it 
becomes easier to develop specific measures to counter the 
attack.  However,  this  requires  the  system  to  monitor  an 
Simple
Many
Fig. 3.  Anomaly-based in-vehicle IDS
4-2  Shortcomings of conventional in-vehicle IDSs
One challenge facing conventional in-vehicle IDSs is 
their  low  capability  to  detect  spoofing  messages.  Of 
conventional  systems,  those  which  monitor  message 
communication characteristics(5) are unlikely to detect and 
distinguish spoofing messages from normal messages when 
a  cyberattack  occurs.  Detection  systems  that  monitor 
sensor-based control data,(6) in which the value contained in 
the  payload  shifts  smoothly,  fail  to  detect  spoofing 
messages  if  the  monitored  control  data  is  slightly  and 
repeatedly tampered with.
5. Proposed System
5-1  CDEC
As a solution to the low performance of conventional 
in-vehicle  IDSs  to  detect  spoofing  messages,  this  paper 
proposes  Control  Data  Estimation  for  anomaly  detection 
with  Correlation  data  (CDEC),(7)  which  monitors  sensor-
based  control  data  contained  in  the  message  payload,  as 
discussed in Section 5-2 “Application model.” To monitor 
control data, CDEC uses a group of control data correlated 
with the monitored control data. As such, if many sets of 
correlated  control  data  are  obtained  within  the  vehicle, 
CDEC  exhibits  improved  performance  to  detect  spoofing 
messages.  For  this  reason,  for  this  proposed  system,  it  is 
desirable to monitor control data at a location suitable for 
accessing  many  sub-networks  of  the  in-vehicle  network, 
such as in the central gateway.
5-2  Application model
The  proposed  system  consists  of  three  functions,  as 
shown in Fig. 4. The divider, when a message that contains 
control data correlated with the monitored control data is 
received, memorizes the correlated control data contained 
SEI TECHNICAL REVIEW  ·  NUMBER 88  ·  APRIL  2019  ·  77
in the payload. The estimator, when a message that contains 
the  monitored  control  data  is  received,  calculates  an  esti-
mate of the monitored control data based on the groups of 
correlated  control  data  stored  in  memory,  via  the  vehicle 
data model described in Section 5-3. When the estimate of 
the monitored control data has been calculated, the evalu-
ator compares, with a threshold, the difference between the 
current  value  of  the  monitored  control  data  and  the  esti-
mate. If the difference is below the threshold, the evaluator 
determines the monitored control data to be normal. If the 
threshold is exceeded, the evaluator determines the moni-
tored control data to be anomalous.
Vehicle data 
model
Threshold
Message
Estimator
Evaluator
Normal
Anomalous
Divider
Control
data
Fig. 4.  CDEC application model
5-3  Vehicle data model
A vehicle data model is used to calculate estimates of 
the  monitored  control  data  based  on  groups  of  correlated 
control data. Learning for the vehicle data model proceeds 
in two stages. The first stage is correlation analysis,*1 which 
extracts  groups  of  control  data  correlated  with  the  moni-
tored  control  data  from  the  traffic  data  on  the  in-vehicle 
network. In the second stage, learning for the vehicle data 
model takes place, determining vehicle data model parame-
ters by using the monitored control data and the groups of 
correlated control data. The proposed system uses a regres-
sion model*2 as the vehicle data model. For the regression 
model, references (8) and (9) provide detailed explanations.
6. Evaluation
6-1  Learning for vehicle data model and estimation 
accuracy
Eight types of sensor-based control data that indicate 
vehicle  driving  characteristics  were  used  to  evaluate 
learning feasibility for the vehicle data model required for 
the proposed system and the model’s estimation accuracy. 
The traffic data of the in-vehicle network was used to learn 
each  set  of  control  data  for  the  vehicle  data  model,  as 
described in Section 5-3 “Vehicle data model.” The propor-
tion of the root mean square (RMS) of the estimated differ-
ence to the variable range of each set of control data was 
used as an evaluation index of estimation accuracy.
Figure 5 represents the evaluation results. First, it was 
confirmed  that  learning  for  the  vehicle  data  model  was 
possible using the traffic data of the in-vehicle network for 
78  ·  Intrusion Detection System for In-Vehicle Networks
all of the eight types of sensor-based control data that indi-
cated  the  driving  characteristics  of  the  test  vehicle. 
Estimation accuracy for the B-torque was 11.9%. For the 
other seven types, the estimation accuracy was below 3%.
d
e
t
a
m
i
t
s
e
f
o
n
o
i
t
r
o
p
o
r
P
l
f
o
e
g
a
r
e
b