title:Exploiting Determinism in Lattice-based Signatures: Practical Fault
Attacks on pqm4 Implementations of NIST Candidates
author:Prasanna Ravi and
Mahabir Prasad Jhanwar and
James Howe and
Anupam Chattopadhyay and
Shivam Bhasin
Exploiting Determinism in Lattice-based Signatures
Practical Fault Attacks on pqm4 Implementations of NIST candidates
Prasanna Ravi
PI:EMAIL
Temasek Labs and School of
Computer Science and Engineering,
NTU Singapore
Mahabir Prasad Jhanwar
PI:EMAIL
Department of Computer Science,
Ashoka University, Delhi
James Howe∗∗
PI:EMAIL
PQShield, Ltd.
Oxford, UK.
Anupam Chattopadhyay
PI:EMAIL
School of Computer Science and
Engineering, NTU Singapore
ABSTRACT
In this paper, we analyze the implementation level fault vulnerabil-
ities of deterministic lattice-based signature schemes. In particular,
we extend the practicality of skip-addition fault attacks through
exploitation of determinism in Dilithium and qTESLA signature
schemes, which are two leading candidates for the NIST standardiza-
tion of post-quantum cryptography. We show that single targeted
faults injected in the signing procedure allow to recover an impor-
tant portion of the secret key. Though faults injected in the signing
procedure do not recover all the secret key elements, we propose a
novel forgery algorithm that allows the attacker to sign any given
message with only the extracted portion of the secret key. We per-
form experimental validation of our attack using Electromagnetic
fault injection on reference implementations taken from the pqm4
library, a benchmarking and testing framework for post quantum
cryptographic implementations for the ARM Cortex-M4 micro-
controller. We also show that our attacks break two well known
countermeasures known to protect against skip-addition fault at-
tacks. We further propose an efficient mitigation strategy against
our attack that exponentially increases the attacker’s complexity at
almost zero increase in computational complexity.
CCS CONCEPTS
• Security and privacy → Digital signatures; Hardware at-
tacks and countermeasures; Side-channel analysis and coun-
termeasures; Embedded systems security.
∗Most of this research was completed while the author was at the University of Bristol,
supported by EPSRC via grant EP/N011635/1.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
AsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand
© 2019 Association for Computing Machinery.
ACM ISBN 978-1-4503-6752-3/19/07...$15.00
https://doi.org/10.1145/3321705.3329821
Shivam Bhasin
PI:EMAIL
Temasek Labs, NTU Singapore
KEYWORDS
Deterministic Lattice Signatures, pqm4, Fault Attack, Lattice-based
Cryptography
ACM Reference Format:
Prasanna Ravi, Mahabir Prasad Jhanwar, James Howe, Anupam Chattopad-
hyay, and Shivam Bhasin. 2019. Exploiting Determinism in Lattice-based
Signatures: Practical Fault Attacks on pqm4 Implementations of NIST can-
didates. In ACM Asia Conference on Computer and Communications Security
(AsiaCCS ’19), July 9–12, 2019, Auckland, New Zealand. ACM, New York, NY,
USA, 14 pages. https://doi.org/10.1145/3321705.3329821
1 INTRODUCTION
Recently, NIST has called for proposals for standardization of post-
quantum cryptographic schemes for public-key encryption, digital
signatures, and key establishment protocols [22]. This initiative
is partly driven by the onset of the era of practical and scalable
quantum computers [4], which has motivated the community to
develop cryptographic schemes that are immune to cryptanalytic
efforts using quantum algorithms. Amongst the initial candidates
from different types of post-quantum cryptography, lattice-based
cryptography has emerged as the largest category with 28 of 80
submissions. NIST [24] state that “schemes that can be made resis-
tant to side-channel attacks at minimal cost are more desirable than
those whose performance is severely hampered by any attempt to
resist side-channel attacks”. Thus, it has become essential to the
standardization process to analyze the implementation security of
these proposals against active and passive side-channel attacks.
Over the years, significant research has been done with respect
to development of lattice-based cryptographic algorithms and in
particular, initial proposals for lattice-based signature schemes such
as GLP [16], BLISS [12] and the Bai-Galbraith (BG) [3] signature
schemes attracted a lot of attention from the cryptographic com-
munity, owing to its security and efficiency guarantees. One of the
noticeable characteristics of the aforementioned schemes is the use
of ephemeral nonces during signature generation, similar to ellip-
tic curve signature schemes such as DSA and ECDSA. While the
initial lattice-based signature schemes [12, 16] utilized randomly
generated nonces, some variants of the current lattice-based sig-
nature schemes such as Dilithium [19] and qTESLA [7] which are
candidates in the NIST standardization process used deterministic
procedures for nonce generation, thus making the signature scheme
Session 5B: Fault Attacks and Side Channel AnalysisAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand427in itself completely deterministic. Determinism ensures that the
signing procedure always outputs a unique signature for a given
message. The same transition from non-deterministic to determin-
istic signature schemes was also previously witnessed in the case of
elliptic curve signatures with the onset of deterministic ECDSA [27]
and EdDSA [6] signature schemes. But, the determinism property
came under heavy scrutiny and subsequently became a target and
an enabler for a number of fault and side channel attacks [2, 5].
This naturally leads to critical questions about the introduction
of similar implementation-level vulnerabilities due to determinism
in lattice-based signature schemes. As the first and only work in ex-
ploiting determinism through implementation attacks, Bruinderink
and Pessl [11] proposed the first differential style fault attacks on
the Dilithium and qTESLA signature schemes. Another pertinent
question to be answered is whether the introduced determinism
can be exploited to increase the practicality or strengthen existing
theoretical implementation attacks against lattice-based signature
schemes.
As a first step towards answering this question, we extend the
applicability and practicality of skip-addition fault attacks to deter-
ministic variants of lattice-based signature schemes, Dilithium and
qTESLA1. Theoretical skip-addition fault attack was first reported
by Bindel et al. [8] over three non-deterministic lattice-based signa-
ture schemes GLP, BLISS and Ring-TESLA, but the attack requires
a very high number of precisely targeted faults (≈ 1000 for typi-
cal parameters) to be injected within a single run of the signing
procedure. Their attack in practice will also be plagued by more
pressing practical concerns, such as attacker’s synchronization or
fault detectability, which have been overlooked. These aspects thus
make their attack highly impractical in practice. On the contrary,
our proposed attack works with a single-fault injection model, that
is only one fault injected in any given run of the algorithm. This
single fault model is relaxed both for the equipment and underly-
ing analysis for key recovery. Our attack also works against two
well known implementation level countermeasures used to protect
against skip-addition fault attacks. Thus, the efficacy of our attack
has been further enhanced to practical limits through exploitation
of determinism in lattice-based signature schemes.
1.1 Contribution
The contribution of this work is as follows:
• We extend the applicability and practicality of skip-addition
fault attacks to deterministic lattice-based signature schemes.
We show that the deterministic nature of Dilithium and
qTESLA signature schemes can be exploited to extract the
primary component of the secret key with only single tar-
geted faults injected in the signing procedure.
• We further propose an alternate signature forgery algorithm
for Dilithium through which one can generate valid signa-
tures with only the extracted primary component of the
1In light of recent attacks against deterministic signature schemes [2, 11], Dilithium
recently updated its specifications as part of the second round of the standardization
process to allow for a probablistic variant based on the designer’s choice, while qTESLA
was modified into a probabilistic scheme [23]. While our attack still works against
the deterministic variant of Dilithium, it is rendered ineffective on the probabilistic
qTESLA signature scheme. We henceforth refer to the original first round submissions
of Dilithium [19] and qTESLA [7] for the remainder of this paper and discuss the
implications of the aforementioned updates on our attack in Sec.7.
secret key from the fault attack. Our forgery algorithm in-
volves lesser computations compared to the original signing
procedure albeit accompanied with a certain non-negligible
failure probability.
• The fault vulnerabilities are validated using electromagnetic
fault injection on the ARM Cortex-M4 microcontroller [17].
We performed practical fault attacks on the reference im-
plementations taken from the pqm4 library, a testing and
benchmarking framework for post quantum cryptographic
schemes for the ARM Cortex-M4 microcontroller.
• Given that our attack requires to inject precisely targeted
faults, we propose a systematic approach towards identifying
our target operations to fault through a two-order pattern
matching technique over the Electromagnetic Emanation
traces collected through the EM side channel.
• We also demonstrate practical attacks against two well known
implementation level countermeasures proposed to protect
against skip-addition fault attacks [8, 9], again made possible
owing to the deterministic nature of Dilithium.
• Finally, we propose a zero-cost mitigation technique against
our skip-addition fault attack which exponentially increases
the attacker’s complexity through simple re-ordering of op-
erations within the signing procedure.
0≤i ≤n−1∥ai∥∞, where ∥ai∥∞ = |ai
2 PRELIMINARIES
Notation: Let q ∈ N be a prime. Elements in ring Z or Zq are
denoted by regular font letters viz. a, b ∈ Z or Zq. For an integer
r and an even positive integer α, we define centered reduction
modulo q denoted as r (mod ± α ), to be the unique integer r0
such that, r ≡ r0 (mod α ) and − α2  1 (as opposed to Rq for their ring variants) and also provide
better security guarantees compared to their corresponding ring
variants. Any change in the security of a scheme (based on either
MLWE or MSIS) only requires changes in the value of the module
parameters (k, ℓ) while keeping the underlying structure of the
ring fixed, thus warranting very minimal changes from a designer’s
perspective.
= Zk×ℓ
q
q
2.1 Dilithium
Dilithium is a deterministic lattice-based signature scheme whose
security is based on MLWE and MSIS problems. In particular, secu-
rity against key-recovery attack under the classical random oracle
model is based on the hardness assumption of the MLWE problem;
and the security against existential signature forgery is based on the
MSIS hardness assumption. The scheme’s security against strong
signature forgery attack, under the quantum random oracle model,
is also discussed by the authors [19].
2.1.1 Rounding Algorithms. This section starts off by briefly de-
scribing the various rounding procedures used in Dilithium. The
purpose of them is to provide better compression of Dilithium’s
public-key and signatures. For non-negative integers r , α, the proce-
dure r (mod ± α ) outputs a unique integer r0 in −α/2 < r0 ≤ α/2
such that r ≡ r0 (mod α ). The procedure Decompose : Dq (r , α )
decomposes r into a pair of integers (r1, r0) and the procedures
HighBits : HBq (r , α ) and LowBits : LBq (r , α ) extract r1 and r0
from Dq (r , α ) respectively. The procedure MakeHint : MHq (u, r , α )
produces a bit h ∈ {0, 1} and subsequently the procedure UseHint :
UHq (h, r , α ) shows how to use the bit h as a hint to derive HBq (u +
r , α ). The relation between the procedures MHq (u, r , α ) and
UHq (h, r , α ) is stated in the following lemma.
Lemma 2.1 ([19]). For r , z ∈ Zq with ||z||∞ ≤ α/2, we have
UHq
= HBq (r + z, α )
MHq (z, r , α ), r , α
(1)
The exact details of these algorithms are provided in Algorithm
4 in Appendix A. All these algorithms naturally extend to higher
abstractions like matrices, vectors, rings and modules by simply
performing the same computations over their individual elements.
2.1.2 Description of Dilithium. In the following, we recall the de-
tails of the Dilithium signature scheme [19]. The underlying ap-
proach of the scheme is based on the “Fiat-Shamir with Aborts”
framework [18] while the scheme in itself is an improved vari-
ant of the lattice-based signature scheme proposed by Bai and
Galbraith[3]. The scheme operates over the base ring Rq with
n, q = (256, 8380417) while offering flexibility with the module pa-
rameters (k, ℓ) allowing to operate over varying dimensions (k × ℓ)
for different security levels. Since all/most of our analysis deals with
the signing procedure of Dilithium, we present the details of the