malicious  one)  possibly  because  of  the  mix  of  normal  flows  and 
malicious flows on the normal cluster. 
Table 6. Description of application community over three days  
Total 
Flows 
Known  
Flows 
32693K  
20596K 
35409K 
23724K 
29538K  
18313K  
Flows         
Days 
1 
2 
3 
Flows in  
Botnet  
Communities  
264 IRC  
{21 normal} 
408 IRC  
{363 normal} 
1010 Web  
{1002 normal} 
Table 7. Detection performance over three days 
Performance  
Days 
Normal  
IRC  
Flows 
Bot  
C&C  
Flows 
Correctly  
detected  
Bot C&C  
Flows 
1 
2 
3 
21 
363 
1002 
243 
45 
8 
243 
45 
3 
Number  
of Falsely  
Identified  
Bot C&C  
Flows 
4 
19 
0 
Table 8. Standard deviation of byte frequency over 256 ASCII 
characters for normal and botnet clusters  
Average Standard  
Days 
1 
2 
3 
Normal  
Clusters 
Botnet  
Clusters 
0.0213 
0.0005 
0.0136 
0.0032 
0.0064 
0.0026 
6.  CONCLUSIONS 
Before the work reported by Rajab et al. in [6], very little has been 
done  to  study  the  botnet  behavior  theoretically.  The  first 
workshop  on  botnets  was  hold  in  2007  and  since  then  many 
detection approaches have been  proposed  and also some real  bot 
detection  systems  have  been  implemented  (e.g.  BotHunterTM  by 
Gu et al. [38]). In this paper we attempt to conduct a taxonomy on 
8all  existing  botnet  detection  approaches  and  classify  them  into 
three  categories,  namely  honeypots  based,  passive  anomaly 
analysis based and traffic  classification based.  As  claimed  by Gu 
et  al.,  anomaly  based  botnet  detection  approaches  have  the 
potential to find different types of botnets, while current existing 
traffic  classification  approaches  focus  only  on  differentiating 
malicious  IRC 
is 
considered as its biggest limitation. 
traffic  from  normal  IRC 
traffic,  which 
In  this  paper,  we  address  this  limitation  by  presenting  a  novel 
generic  application  classification  approach.  Through 
this, 
unknown  applications  on  the  current  network  are  classified  into 
different application communities, such as Chat (or more specific 
IRC)  community,  P2P  community,  Web  community,  to  name  a 
few.  Since  botnets  are  usually  exploring  existing  application 
protocols, detection can be conducted in each specific community. 
As a result, our  approach  can be  extended  to find different types 
of  botnets  and  has  the  potential  to  find  the  new  botnets  when 
exploring specifically the traffic on the "unknown" community. In 
particular,  we  evaluate  our  framework  on  IRC  and  WEB 
community and evaluation results show that our approach obtains 
a very high detection rate (approaching 100% for IRC bot) with a 
low false alarm rate when detecting IRC botnet traffic. Moreover, 
we  formalize  the  botnet  behavior  by  using  an  average  standard 
deviation  of  byte  frequency  over  256  ASCII  characters  on  the 
traffic  payload,  and  conclude  an  important  bot  identification 
strategy, that is the higher the value of the average deviation, the 
more  likely  the  traffic  is  generated  by  human  beings.  This 
indication  strategy 
important  when  using  unsupervised 
clustering algorithm for botnet detection in the later research. 
is 
In the immediate future, we will evaluate our approach on the P2P 
community  and  measure  its  performance  on  P2P  based  botnets. 
Until  the  deadline  of  the  paper  we  have  not  received  any  P2P 
botnet traffic from the honeypot and we  also  attempted to  search 
the  source  code  of  some  well-known  P2P  bots  (e.g.  Rustock, 
Nugache and Peacomm) from the public malware sharing website 
so that we can run it and  collect  P2P  botnet traffic traces on our 
testbed network (fortunately we will get the storm P2P .pcap data 
from the German Honeynet Chapter  [46]).  Also some  novel  P2P 
botnets  construction  methods  have  been  proposed  and 
investigated  in  [44,  45],  and  in  summary,  we  will  focus  on  the 
detection  of  existing  and  new  appeared  P2P  botnets  in  the  near 
future. 
7.  REFERENCES 
[1]  http://www.symantec.com/business/theme.jsp?themeid=threa
treport,  Symantec  Internet  Security  Threat  Report,  Volume 
XIII: April, 2008 
[2]  P. Barford and V. Yegneswaran, "An inside look at Botnets," 
Special  Workshop  on  Malware  Detection,  Advances  in 
Information Security, Springer Verlag, ISBN: 0-387-32720-7, 
2006. 
[3]  Sinit, available on and assessed in December 2008 
http://www.secureworks.com/research/threats/sinit/ 
[4]  Phatbot, available on and assessed in December 2008 
http://www.secureworks.com/research/threats/phatbot/ 
[5]  Nugache, available on and assessed in December 2008 
http://www.securityfocus.com/news/11390/ 
[6]  http://www.secureworks.com/research/blog/index.php/2007/
09/12/analysis-of-storm-worm-ddos-traffic/ 
[7]  E.  Athanasopoulos,  A.  Makridakis,  S.  Antonatos,  D. 
Antoniades, S. Ioannidis, K. Anagnostakis, and E. Markatos, 
"Antisocial  networks:  turning  a  social  network  into  a 
Botnet,"  In  Proceedings  of  the  11th  Information  Security 
Conference, Taipei, Taiwan, 2008. 
[8]  M.A.  Rajab,  J.  Zarfoss,  F.  Monrose,  and  A.  Terzis,  "A 
multifaceted 
the  botnet 
phenomenon,"  In  Proceedings  of  the  6th  ACM  SIGCOMM 
Conference on Internet measurement, pp. 41-52, 2006. 
to  understanding 
approach 
[9]  P. Baecher, M. Koetter, T. Holz, M. Dornseif, and F. Freiling, 
"The  nepenthes  platform:  an  efficient  approach  to  collect 
malware,"  In  Proceedings  of  Recent  Advances  in  Intrusion 
Detection, LNCS 4219, Springer-Verlag, 2006, pp. 165-184, 
Hamburg, 2006. 
[10] V.  Yegneswaran,  P.  Barford,  and  V.  Paxson,  "Using 
honeynets for internet situational awareness," In Proceedings 
of the 4th Workshop on Hot Topics in Networks, College Park, 
MD, 2005. 
[11] Z.H.  Li,  A.  Goyal,  and  Y.  Chen,  "Honeynet-based  botnet 
scan  traffic  analysis,"  Botnet  Detection:  Countering  the 
Largest  Security  Threat,  in  Series:  Advances  in  Information 
Security,  Vol.  36,  W.K.Lee,  C.  Wang,  D.  Dagon,  (Eds.), 
Springer, ISBN: 978-0-387-68766-7, 2008. 
[12] F.  Freiling,  T.  Holz,  and  G.  Wicherski.  "Botnet  tracking: 
exploring  a  root-cause  methodology  to  prevent  Denial  of 
Service attacks. In Proceedings of 10th European Symposium 
on Research in Computer Security (ESORICS’05), 2005. 
[13] T.  Holz,  M.  Steiner,  F.  Dahl,  E.  Biersack  and  F.  Freiling, 
"Measurements and mitigation of peer-to-peer-based botnets: 
a  case  study  on  storm  worm",  In  Proceedings  of  the  1st 
Usenix  Workshop  on  Large-Scale  Exploits  and  Emergent 
Threats, San Francisco, California, 2008. 
[14] T.  Strayer,  R.  Walsh,  C.  Livadas,  D.  Lapsley,  "Detecting 
botnets with tight command and control," Proceedings 2006 
31st  IEEE  Conference  on  Local  Computer  Networks,  pp. 
195-202, 2006. 
[15] T.  Strayer,  D.  Lapsley,  R.  Walsh,  and  C.  Livadas,  "Botnet 
detection  based  on  network  behavior,"  Botnet  Detection: 
Countering the Largest Security Threat, in Series: Advances 
in  Information  Security,  Vol.  36,  W.  K.  Lee,  C.  Wang,  D. 
Dagon, (Eds.), Springer, 2008. 
[16] C.  Livadas,  R.  Walsh,  D.  Lapsley,  T.  Strayer,  "Using 
machine  learning  techniques  to  identify  botnet  traffic,"  In 
Proceedings 2006 31st IEEE Conference on Local Computer 
Networks, pp. 967-974, Nov. 2006. 
[17] J.  Goebel  and  T.  Holz,  "Rishi:  Identify  bot  contaminated 
hosts  by  irc  nickname  evaluation,"  In  Proceedings  of 
USENIX HotBots’07, 2007. 
[18] A.  Karasaridis,  B.  Rexroad,  and  D.  Hoeflin,  "Wide-scale 
botnet detection and characterization," In Proceedings of the 
1st  Conference  on  1st  Workshop  on  Hot  Topics 
in 
Understanding Botnets, Cambridge, MA, 2007. 
[19] J. R. Binkley and S. Singh, "An algorithm for anomaly-based 
botnet detection," USENIX SRUTI: 2nd Workshop on Steps to 
9Reducing Unwanted Traffic on the Internet, 2006. 
[20] G.F.  Gu,  J.J.  Zhang,  and  W.K.  Lee,  "BotSniffer:  detecting 
botnet command and control channels in network traffic," In 
Proceedings  of  the  15th  Annual  Network  and  Distributed 
System Security Symposium, San Diego, CA, February 2008. 
[21] G.F. Gu, R. Perdisci, J.J. Zhang, and W.K. Lee. "BotMiner: 
clustering  analysis  of  network  traffic  for  protocol-  and 
structure-independent  Botnet  detection,"  In  Proceedings  of 
the 17th USENIX Security Symposium (Security'08), San Jose, 
CA, 2008. 
[22] A.  W.  Moore  and  K.  Papagiannaki,  "Toward  the  accurate 
identification of network applications," In Proceedings of 6th 
International  Workshop  on  Passive  and  Active  Network 
Measurement, pp. 41-54, Boston, MA, 2005. 
[23] N.  Williams,  S.  Zander  and  G.  Armitage,  "A  preliminary 
performance comparison of five machine learning algorithms 
for practical IP traffic flow classification,"  ACM SIGCOMM 
Computer Communication Review, Vol. 36, Issue 5, pp. 5-16, 
2006. 
[24] A.  McGregor,  M.  Hall,  P.  Lorier,  and  J.  Brunskill,  "Flow 
clustering  using  machine  learning  techniques,"  Proceedings 
of  5th  International  Workshop  on  Passive  and  Active 
Network  Measurement,  pp.  205-214,  Antibes  Juan-les-Pins, 
France, 2004. 
[25] S.  Zander,  T.  Nguyen,  G.  Armitage,  "Automated  traffic 
classification  and  application  identification  using  machine 
learning,"  In  Proceedings  of  the  IEEE  Conference  on  Local 
Computer Networks. 30th Anniversary, pp. 250-257, 2005. 
[26] L.  Bernaille,  R.  Teixeira,  K.  Salamatian,  "Early  application 
identification," 
International 
Conference  On  Emerging  Networking  Experiments  And 
Technologies (CONEXT 06), Lisboa, Portugal, 2006. 
In  Proceedings  of  ACM 
[27] A.  Moore,  D.  Zuev,  "Internet  traffic  classification  using 
Bayesian 
SIGMETRICS 
Performance Evaluation Review, Vol. 30, Issue 1, pp. 50-60, 
2005. 
techniques,"  ACM 
analysis 
[28] M.  Crotti,  M.  Dusi,  F.  Gringoli,  L.  Salgarelli,  "Traffic 
classification through simple statistical fingerprinting," ACM 
SIGCOMM  Computer  Communication  Review,  Vol.  37, 
Issue 1, 5-16, 2007. 
[29] M.  Roughan,S.  Sen,  O.  Spatscheck,  and  N.G.  Duffield, 
"Class  of  service  mapping  for  QoS:  a  statistical  signature 
based approach to IP traffic classification," In Proceedings of 
the  4th  ACM  SIGCOMM  Conference  on 
Internet 
Measurement, Taormina, Sicily, Italy, October 25-27, 2004. 
[30] H.  Dahmouni,  H.,  S.  Vaton,  D.  Rosse,  "A  Markovian 
signature-based  approach  to  IP  traffic  classification",  In 
Proceedings  of  the  3rd  Annual  ACM  Workshop  on  Mining 
Network Data, San Diego, California, USA, pp. 29-34, 2007. 
[31] C. Park, Y. Won, M. Kim and J. Hong, "Towards automated 
application signature generation for traffic identification," In 
Proceedings  of  the  IEEE/IFIP  Network  Operations  and 
Management  Symposium  (NOMS  2008),  Salvador,  Brazil, 
160-167, 2008. 
[32] T. Karagiannis, K. Papagiannaki, and M. Faloutsos, "BLINC: 
multilevel  traffic  classification  in  the  dark,"  In  Proceedings 
of  the  2005  Conference  on  Applications,  Technologies, 
Architectures, and Protocols for Computer Communications, 
pp. 229-240, Philadelphia, Pennsylvania, 2005. 
[33] L.  Bernaille,  R.  Teixeira,  I.  Akodkenou,  A.  Soule,  and  K. 
Salamatian,  "Traffic  classification  on 
fly,"  ACM 
SIGCOMM  Computer  Communication  Review,  Vol.  36, 
Issue 2, pp. 23-26, 2006. 
the 
[34] Fred-eZone  WiFi  ISP,  available  on  and  assessed 
in 
December 2008 http://www.fred-ezone.ca/ 
[35] D.  Chakrabarti,  S.  Papadimitriou,  D.  Modha,  and  C. 
Faloutsos, 
In 
the  10th  ACM  SIGKDD  International 
Proceedings  of 
Conference  on  Knowledge  Discovery  and  Data  Mining,  pp. 
79-88, Seattle, Washington, 2004. 
cross-associations," 
automatic 
"Fully 
[36] K.Wang  and  S.  Stolfo.  "Anomalous  payload-based  network 
intrusion  detection,"  In  Proceedings  of  the  7th  International 
Symposium  on  Recent  Advances  in  Intrusion  Detection 
(RAID), Sophia Antipolis, France, 2004. 
[37] K.  Wang  and  S.  Stolfo,  "Anomalous  payload-based  worm 
detection and signature generation," In Proceedings of the 8th 
International  Symposium  on  Recent  Advances  in  Intrusion 
Detection (RAID), Seattle, WA, 2005. 
[38] G.  F.  Gu,  P.  Porras,  V.  Yegneswaran,  M.  Fong,  and  W.K. 
Lee,  "BotHunter:  detecting  malware  infection  through  IDS-
Driven dialog correlation," Proceedings  of  the  16th  USENIX 
Security Symposium, Boston, MA, 2007. 
[39] M. Akiyama, T. Kawamoto, M. Shimamura, T. Yokoyama, Y. 
Kadobayashi, and S. Yamaguchi, "A proposal of metrics for 
botnet  detection  based  on  its  cooperative  behavior,"  In 
Proceedings  of  the  2007  International  Symposium  on 
Applications and the Internet Workshops, pp. 82-85, 2007. 
[40] E. Eskin, "Anomaly detection over noisy data  using  learned 
17th 
probability 
International Conference on Machine Learning, pp. 255-262, 
Palo Alto, 2000. 
In  Proceedings 
distributions," 
of 
[41] Kaiten, available on and assessed in December 2008 
http://packetstormsecurity.org/distributed/indexsize.html 
[42] BlackEnergy, available on and assessed in December 2008 
http://atlas-public.ec2.arbor.net/docs/BlackEnergy+DDoS+ 
Bot+Analysis.pdf 
[43] L.  Salgarelli,  F.  Gringoli,  and  T.  Karagiannis,  "Comparing 
traffic 
Computer 
Communication  Review,  Volume  37,  Issue  3,  pp.  65-68, 
2008. 
classifiers", 
SIGCOMM 
ACM 
[44] P. Wang, S. Sparks, and C. Zou "An advanced hybrid peer-
to-peer  botnet,"  In  Proceedings  of  the  1st  conference  on  1st 
in  Understanding  Botnets, 
Workshop  on  Hot  Topics 
Cambridge, MA, 2007. 
[45] C.  Zou  and  R.  Cunningham,  "Honeypot-aware  advanced 
botnet  construction  and  maintenance,"  In  Proceedings  of 
International  Conference  on  Dependable  Systems  and 
Networks, 2006. 
[46] German  Honeynet  Project,  assessed 
in  Dec  2008  
http://pi1.informatik.uni-mannheim.de/index.php? 
pagecontent=site/Research.menu/ Honeynet.page 
10