### 3.16. "Packet Details"面板

**"Packet Details/包详情"面板** 显示当前选中包（在包列表面板中）的详细信息列表。请参阅图 3.14。

- **协议及字段展示**：该面板以树状结构组织并展示包的协议及其相关字段。用户可以展开或折叠这些字段，以便更详细地查看所需信息。
- **上下文菜单**：右键单击任何字段将显示一个上下文菜单，提供更多操作选项。更多细节见第 6.4 节“建立显示过滤表达式”。

**特殊显示规则**：
- **Generated fields/衍生字段**：Wireshark 自动生成的附加协议字段会用括号标出。例如，在对 TCP 流进行应答序列分析时，Wireshark 会在 TCP 协议下添加 `[SEQ/ACK analysis]` 字段。
- **Links/链接**：如果 Wireshark 检测到当前包与其他包之间存在关联，则会生成指向这些包的链接。链接文本将以蓝色字体和下划线的形式呈现；双击该链接可直接跳转至对应的包。

### 3.17. "Packet Bytes"面板

**"Packet Byte/包字节"面板** 采用十六进制格式展示所选包的数据内容。如图 3.15 所示。

- **数据展示格式**：通常情况下，左侧栏显示数据偏移量，中间部分以十六进制形式展示数据，而右侧则显示相应的 ASCII 字符表示。
- **多页面支持**：根据数据的不同，有时可能需要多个页面来完全展示一个包的内容。例如，当 Wireshark 将多个分片重组为单一包时（参考第 7.5 节“合并包”），底部会出现额外按钮供用户切换查看不同页面。
- **注意事项**：附加页面中的内容可能源自多个不同的包。通过右键点击选项按钮，可以访问包含所有可用页的上下文菜单，这对于屏幕空间有限的情况特别有用。

### 3.18. 状态栏

状态栏用于提供实时信息反馈。

- **基本信息**：默认状态下，左侧显示相关的上下文信息，而右侧则显示当前加载文件中的包总数。
- **特定状态显示**：当有文件被加载后，左侧会更新为捕捉文件的相关信息（如名称、大小等），右侧则继续反映包的数量统计（P: 总数, D: 显示数量, M: 标记数量）。
- **协议字段选择**：若用户已在"Packet Detail/包详情"面板中选择了某个协议字段，状态栏还会额外显示该字段名作为过滤条件使用提示（如 `app.opcode`）。

### 第 4 章 实时捕捉数据包

#### 4.1. 介绍

实时数据包捕捉是 Wireshark 的核心功能之一，其捕捉引擎具备以下特点：

- 支持多种网络接口（以太网、令牌环网等）；
- 可设置多种停止条件（基于文件大小、时间或包数量）；
- 在捕捉过程中即时解码并显示包信息；
- 允许设置过滤规则以减少不必要的数据量；
- 对于长时间运行的任务，能够自动分割成多个文件，并保留最新的 N 个文件。

然而，也存在一些限制，比如不支持从多个网络接口同时捕捉（但可以通过启动多个实例实现）以及无法根据具体数据触发动作。

#### 4.2. 准备工作

首次配置 Wireshark 进行数据包捕捉可能会遇到一些挑战。建议拥有管理员权限，确保选择正确的网络接口，并考虑好捕捉点的位置等因素。更多详细指南可在官方 Wiki 上找到 (http://wiki.wireshark.org/CaptureSetup)。

#### 4.3. 开始捕捉

可通过如下方式之一启动数据包捕捉：
- 使用"打开捕捉接口"对话框选择本地网络接口；
- 通过"捕捉选项"按钮开启相应对话框；
- 直接点击"开始捕捉"按钮或菜单项快速启动；
- 命令行模式下输入 `wireshark -i eth0 -k` 来指定特定接口。

#### 4.4. 捕捉接口对话框

此对话框列出所有可用的本地网络接口，并允许用户从中挑选目标接口。请注意，保持此窗口打开会对系统性能造成一定影响，因此建议尽快完成选择操作。

#### 4.5. 捕捉选项对话框

"Capture Options/捕捉选项"对话框提供了丰富的配置选项，包括但不限于接口选择、IP 地址确认、缓冲区大小调整、混杂模式开关等。合理设置这些参数有助于提高捕捉效率与准确性。