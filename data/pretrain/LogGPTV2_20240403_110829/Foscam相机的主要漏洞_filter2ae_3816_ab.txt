•
未能对正常输入的校验，是导致CVE-2018-6831漏洞产生的成因，主要原因是代码作者未能使用合适的方法对输入进行校验，而开发者依赖gethostbyname库调用
– 更确切的说是由此导致该漏洞的形成。防止不良输入的一种更好的方法是使用白名单 – 只允许在输入字段中找到特定的字符范围。  
•
在实践中，供应商固件文件使用短可猜测的模式作为openssl命令的关键字加上aes-128-cbc的事实使我们能够快速掌握固件内容。然后我们可以立即开始分析固件的安全问题。此外，该设备包含具有函数名称之类的符号未经剥离的二进制文件。这有助于我们理解代码如何工作。另一方面，值得注意的是，固件内容的隐匿方式的安全性可能会导致存在问题但由于固件被正确加密而未被发现和修复的情况。供应商应仔细考虑这种权衡。
## 感谢
我们要感谢Foscam的安全团队高效，及时地处理这个安全问题。
## 荣誉
Or Peles（[@peles_o](https://github.com/peles_o "@peles_o")），VDOO
## FAQ部分
### Q1。我如何知道我的设备是否易受攻击？
您需要检查您的相机固件是否至少是下面“表I”中出现的版本以及相关的安全补丁。要查看相机使用的固件版本，可以执行以下操作：  
方法1
  1. 使用网络浏览器访问您的相机。地址线通常如下所示：192.168.0.1:88（用相机的实际地址替换“192.168.0.1”）。
  2. 输入你的用户名与密码
  3. 点击“设置”，然后点击“设备信息”
  4. 在右侧窗格中，查找“应用程序固件版本”。  
方法2  
如果您有多个设备，则可能需要通过发出以下命令以编程方式检索固件：  
 **curl“ ：88 / cgi-bin / CGIProxy.fcgi？cmd = getDevInfo＆usr
= admin＆pwd = **  
例如：  
 **curl“192.168.0.200:88/cgi-bin/CGIProxy.fcgi?cmd=getDevInfo
&usr=admin&pwd=abc1234**  
响应如下所示：  
 **  
0  
FI9816P+V3  
0000000000000001  
Acme  
00626E860232  
2018  
5  
25  
19  
40  
19  
0  
2.81.2.29  
1.12.5.2  
2017-06-15_17%3A21%3A35  
**  
Look for the line with “firmwareVer”.  
 **表I – 最新的易受攻击固件版本。**  
这些是最新的易受攻击的固件版本。添加相应的补丁可缓解这些漏洞。
相机型号 | 应用程序固件版本  
---|---  
C1 Lite V3 | 2.82.2.33  
C1 V3 | 2.82.2.33  
FI9800P V3 | 2.84.2.33  
FI9803P V4 | 2.84.2.33  
FI9816P V3 | 2.81.2.33  
FI9821EP V2 | 2.81.2.33  
FI9821P V3 | 2.81.2.33  
FI9826P V3 | 2.81.2.33  
FI9831P V3 | 2.81.2.33  
FI9851P V3 | 2.84.2.33  
FI9853EP V2 | 2.84.2.33  
C1 | 2.52.2.47  
C1 V2 | 2.52.2.47  
C1 Lite | 2.52.2.47  
C1 Lite V2 | 2.52.2.47  
FI9800P | 2.54.2.47  
FI9800P V2 | 2.54.2.47  
FI9803P V2 | 2.54.2.47  
FI9803P V3 | 2.54.2.47  
FI9815P | 2.51.2.47  
FI9815P V2 | 2.51.2.47  
FI9816P | 2.51.2.47  
FI9816P V2 | 2.51.2.47  
FI9851P V2 | 2.54.2.47  
R2 | 2.71.1.59  
C2 | 2.72.1.59  
R4 | 2.71.1.59  
FI9900EP | 2.74.1.59  
FI9900P | 2.74.1.59  
FI9901EP | 2.74.1.59  
FI9961EP | 2.72.1.59  
FI9928P | 2.74.1.58  
FI9803EP | 2.22.2.31  
FI9803P | 2.24.2.31  
FI9853EP | 2.22.2.31  
FI9851P | 2.24.2.31  
FI9821P V2 | 2.21.2.31  
FI9826P V2 | 2.21.2.31  
FI9831P V2 | 2.21.2.31  
FI9821EP | 2.21.2.31  
FI9821W V2 | 2.11.1.120  
FI9818W V2 | 2.13.2.120  
FI9831W | 2.11.1.120  
FI9826W | 2.11.1.120  
FI9821P | 2.11.1.120  
FI9831P | 2.11.1.120  
FI9826P | 2.11.1.120  
FI9805W | 2.14.1.120  
FI9804W | 2.14.1.120  
FI9804P | 2.14.1.120  
FI9805E | 2.14.1.120  
FI9805P | 2.14.1.120  
FI9828P | 2.13.1.120  
FI9828W | 2.13.1.120  
FI9828P V2 | 2.11.1.133  
### Q2。如何判断我的设备是否被破坏？
由于僵尸网络恶意软件通常被制造为不被发现，因此没有简单的方法可以确切知道。对设备的任何可疑更改都可能表示设备上存在僵尸网络恶意软件。  
几种检查方法：
  1. **您的密码不再生效** （而不是因为您忘记了） – 这强烈表示设备已被他人接管。
  2. **您的设备设置已被修改** – 例如，视频现在被发送到不同的服务器。
  3. **网络流量中的峰值** – 如果可能，请检查您的路由器网络统计信息。僵尸网络可能会增加摄像头发起的网络流量。任何峰值都应该值得引起你的注意，因为除非你从摄像机传输视频，否则这个数字应该相对较低。
### Q3。如果违规，我的设备是否有补救措施？
在发布时，我们不知道有任何恶意软件在滥用此问题。如果您怀疑设备被破坏，请将相机恢复到出厂设置。这样做会将配置恢复到默认设置，允许您连接和升级固件。请记住，如果您使用的是易受VDOO检测到的漏洞的固件，则该设备可能成为攻击目标，并可能很快再次受到感染。因此，在重置设备之后，请确保在将相机直接连接到互联网之前立即执行固件升级。
### Q4。如果我无法更新相机的固件，如何减轻风险？
为了减少相机的暴露和远程管理的能力，建议将设备置于防火墙阻挡端口88和443（或相机配置中指定的端口）后面，并考虑不允许相机启动任何出站连接（请记住，这可能会影响Foscam云服务）。另一种选择是将设备置于反向代理之后，该代理将阻止我们用于漏洞利用的URL（请参阅上面的其他详细信息）。如果需要额外的帮助，请联系[PI:EMAIL](mailto:PI:EMAIL)。
### Q5。如何升级相机中的固件？
[点击此处查看](https://www.foscam.com/general-statement-for-firmware-update.html)
供应商的固件更新说明。