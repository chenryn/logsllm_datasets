1
Your Bank’s Digital Side Door
@sdanndev
2
“Because that’s where the money is.”
Willie Sutton, Bank Robber
3
Why does my bank website 
require my 2-factor token, but 
pulling my transactions into 
Quicken does not?
4
Personal Financial Management
PFM
5
Personal Financial Management (PFM)
7
8
9
10
11
12
13
Quicken/Quickbooks Connection Types
Web Connect
• Unidirectional
• Manual
• Download a file
• OFX file format
Express Web 
Connect
• Unidirectional
• Programmatic
• Screen scrape
• Private web 
service
Direct Connect
• Bidirectional
• Programmatic
• Structured query
• OFX protocol
14
Web Connect
Express
Web Connect
Direct Connect
Desktop Application
Middle-Man
Financial Institution
OFX
15
Account Aggregation Service / API
16
Web Application
Middle-Man
Financial Institution
OFX
17
Personal Threat Model
• Assets
• Checking account
• Brokerage account
• Threats
• Credentials are stolen
• Accounts are accessible without credentials
@mrvaughan: https://youtu.be/PIwvxSZj5e8
18
Lack of Least Privilege
• Users have 1 set of bank credentials
• Full read / write access to all accounts at financial institution
• Plain text password is shared with and stored by aggregators
• Tokenized application-based access control (OAuth) is needed
19
Open Financial Exchange (OFX)
aka Direct Connect
20
Banking
• Checking
• Savings
• CDs
• Loans
Investment
• IRA
• 401k
• Holdings
• Equity 
Prices
Credit Cards
• Transactions
Transfers
• Bill Pay
• Intrabank
• Interbank
• Wire Funds
OFX Functionality - Financial
21
OFX Functionality - Miscellaneous
• Enrollment
• Setup online access
• Password Reset
• FI Profile
• Like a homepage
• Email
• Messages and Notifications
• Synchronization
• Ensure multiple clients receive 
1-time messages.
• Image download
• JPEG, TIFF, PNG, PDF
• Bill Presentment
• For 3rd parties
22
www.ofx.org
POST /cgi/ofx HTTP/1.1
Accept: */* 
Content-Type: application/x-ofx
Date: Fri, 16 Jun 2018 21:12:27 GMT
User-Agent: InetClntApp/3.0
Content-Length: 570
Connection: close
OFXHEADER:100
DATA:OFXSGML
VERSION:103
SECURITY:NONE
ENCODING:USASCII
20060321083010
12345
MyPassword
ENG
ABC
000111222
MyApp
... 
HTTP/1.1 200 OK
Date: Fri, 16 Jun 2018 21:12:30 GMT
Content-Type: application/x-ofx
Connection: Keep-Alive
Content-Length: 2399
OFXHEADER:100
DATA:OFXSGML
VERSION:103
SECURITY:NONE
ENCODING:USASCII
0
INFO
Success
20060321083445
ENG
ABC
000111222
... 
Request
Response
OFXHEADER:100
DATA:OFXSGML
VERSION:103
SECURITY:NONE
ENCODING:USASCII
20060321083010
12345
MyPassword
ENG
ABC
000111222
MyApp
... 
OFXHEADER:100
DATA:OFXSGML
VERSION:103
SECURITY:NONE
ENCODING:USASCII
0
INFO
Success
20060321083445
ENG
ABC
000111222
... 
Request
Response
25
OFX
26
OFXHEADER:100
DATA:OFXSGML
VERSION:103
SECURITY:NONE
ENCODING:USASCII
... 
5A59A330-7CEC-1000-A761 
MSGSET
19900101
OFXHEADER:100
DATA:OFXSGML
VERSION:103
SECURITY:NONE
ENCODING:USASCII
... 
https://o.bank.org/ofx.asp
ENG
Corillian Corp
235959[0:GMT]
Y
N
N
Request
Response
27
OFXHEADER:100
DATA:OFXSGML
VERSION:103
SECURITY:NONE
ENCODING:USASCII
... 
5A59A330-7CEC-1000-A761 
MSGSET
19900101
OFXHEADER:100
DATA:OFXSGML
VERSION:103
SECURITY:NONE
ENCODING:USASCII
... 
Bank
123 Muholland Drive
Las Vegas
NV
89109
USA
206-439-5700
http://www.bank.org
PI:EMAIL
Request
Response
28
OFX Protocol Specification
29
OFX 1.0.x
1.0.2 - 1997
• BASIC authentication
• User:Pass sent plaintext
• Over HTTPS
• Suggests SSN for username
• SGML
1.0.3 - 2006
• Added “MFA”
30
OFX 2.x.x
2.0.3 - 2006
• BASIC authentication
• User:Pass sent plaintext
• Over HTTPS
• Added “MFA”
• XML
• Taxes (1099, W2)
2.2.0 - 2017
• Token-based Authentication
• OAuth
31
Multi-Factor Authentication (MFA)
Know
• Password
• PIN
• Security 
Question
Have
• Token
• Hardware
• Software
• PKI Certificate
• Smart Card
Are
• Biometric
• Behavior
32
2-Step Authentication
• Password + out-of-band mechanism
• 6 digit string
• SMS
• Push notification
• Software token
33
OFX “MFA”
Security Question
• 
• Free form field required by server
• Server defines label
• Ex: “Mother’s maiden name.”
• 
• Security questions
• Hard coded list
• Ex: “Favorite color.”
35
OFX “MFA”
Static String
• 
• Client generated ID
• Checked by Server 
• TOFU
• Static
• 
• Server generated
• Provided to client out-of-band
• Implied static
• Could be used for 2-step auth
36
76%
20%
4%
0%
Frequency of OFX Header: Version
102
103
202
203
37
Financial Institutions
FIs
38
The Big Names
39
The Smaller Names
41
There Are A Lot of Banks!
7,000 
OFX FIs 
2,000 
Public 
OFX FIs
400
Public 
Server
15,000 FIs
7,000
Commercial 
Banks
(USA & Canada)
42
Investigation
43
OFX Survey
• What FI’s are running an OFX server?
• Find them and talk to them.
• What software is providing this service?
• Ask them simple questions.
44
Recon
ENUM HOSTS
TLS PING
WEB SERVER