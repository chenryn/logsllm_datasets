### Zabbix 拓扑图配置与 IT 服务监控

#### 图标配置
- **图标上方**：选择图标的位置。
- **Host**：如果当前元素类型为 Host，可以选择相应的主机，并支持搜索功能。
- **Map**：如果当前元素类型为 Map，可以选择相应的地图。
- **Trigger**：如果当前元素类型为 Trigger，可以选择相应的触发器。
- **Host Group**：如果当前元素类型为 Host Group，可以选择相应的组，并支持搜索功能。
- **默认图标**：使用系统提供的默认图标。
- **自动图标选择**：通过 Icon Mapping 决定使用哪个图标。
- **不同状态下的图标**：根据元素的不同状态（如 default, problem, maintenance, disabled）显示不同的图标。

#### 坐标配置
- **Coordinate X**：设置 Map 元素的横坐标。
- **Coordinate Y**：设置 Map 元素的纵坐标。

#### URL 配置
- **URLs**：在 Monitoring - Map - 你的地图中，点击元素会出现一个菜单。如果指定了 URLs，这些 URL 将出现在菜单中，点击可跳转到具体页面。支持的宏变量包括 `{MAP.ID}`, `{HOSTGROUP.ID}`, `{HOST.ID}`, `{TRIGGER.ID}`。

#### 注意事项
- **保存更改**：务必点击“Save”按钮保存所有更改，否则未保存的修改将丢失。Zabbix 不会自动保存更改，建议在离开页面前确认已保存。

#### 批量修改 Map 元素
- **批量选择**：按住 Ctrl 键并用鼠标选中多个 Map 元素。
- **批量修改**：可以批量修改元素名称，例如使用宏 `{HOST.IP}`，并将标签名称设置在元素左侧。

#### 连接 Map 元素
- **连接设备**：在网络拓扑图上，可以通过连接服务器、交换机和路由器来表示它们之间的链路。
- **添加链路**：按住 Ctrl 键并选中两个设备，点击上方的 “LINK” 后的 “+” 号，在弹出的属性框中编辑相关信息。
- **链路属性**：
  - **Label**：线路名称，支持宏变量。
  - **Connect to**：指定当前元素与哪个元素连接。
  - **Type**：连接线风格（细线、粗线、点线、虚线）。
  - **Colour**：线条颜色。
  - **Link Indicators**：链路状态指示器，触发器有故障时会在链路上显示。

#### Link Indicators 配置
- **配置步骤**：首先连接两个设备，在弹出的链路属性框中点击 “Edit”，然后在 “Trigger” 处添加用于判断链路状态的触发器。例如，选择 “Zabbix agent on webserver_forttlsa is unreachable for 5 minutes”，当 Zabbix agent 无法连接时，链路颜色会变为红色。

#### IT 服务 (IT Services)
- **定义**：IT 服务用于展示服务器或某项服务、业务的可用率。领导通常关注的是整体结果，如服务器故障率或 API 的响应率。
- **结构示例**：
  ```
  IT Service
  |
  |-XXX网站API
  | |
  | |-天气API
  | |
  | |-新闻API
  | |
  | |-用户API
  |
  |-Servers
  ```

- **配置步骤**：
  1. 在 Configuration -> IT Services 中单击 Root 添加服务。
  2. 创建服务器在线率服务，配置相关属性如名称、上级节点、计算方法、可接受的 SLA 百分比和触发器。
  3. 添加子服务，配置依赖关系和服务时间。

- **依赖关系**：
  - **硬依赖**：直接将整个服务挪过来。
  - **软依赖**：灰色标识，可以直接删除。

- **Web 监控**：
  - **配置 Web 监控项**：在 Host 列表中配置 Web 监控项，Zabbix 会定时执行性能监控。
  - **数据收集**：收集下载速度、错误次数、最后一个错误消息等。
  - **监控项**：
    - `web.test.in[Scenario,,bps]`：整个阶段中的下载速度。
    - `web.test.fail[Scenario]`：整个检测阶段失败的阶段个数。
    - `web.test.error[Scenario]`：返回最后一个错误信息。

- **创建 Web 场景**：
  1. 在 Configuration -> Host -> 你的主机 -> Web 中创建场景。
  2. 配置各个阶段的属性，如名称、URL、POST 数据、超时时间、必需字符串和状态码。
  3. 查看结果：在 Monitoring -> Web 中查看各阶段的响应时间、速度和状态码。

#### 结论
通过以上配置，你可以有效地管理和监控网络拓扑图中的各种元素和 IT 服务，确保系统的高可用性和性能。