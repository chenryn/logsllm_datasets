###  Nuzzle
就功能而言，Nuzzle和之前的追踪器一样：也是使用SIM卡传输宠物的GPS坐标，并可以通过BLE直接连接到智能手机。但就直接连接而言，Nuzzle的表现不如Link
AKC：缺乏授权和访问控制意味着该设备可以连接任何智能手机。这让攻击者可以像设备所有者一样控制设备。例如，通过它可以打开灯泡（只有一个属性的值需要更改）来快速耗电。  
一旦建立连接，攻击者就可以从设备接收数据。数据有两个Characteristics：一个包含遥测信息，包括设备的位置，另一个提供设备的状态信息（特别是温度和电池电量）。  
更糟糕的是，连续读取遥测特性的数据会导致设备“被丢失”：为了节省电池电量，如果设备的数据信息已经通过BLE发送，则不会通过移动网络传输坐标。因此，仅通过使用智能手机连接到跟踪器就可以隐藏宠物的位置。  
我们在更新设备固件的过程中发现了另一个安全漏洞。发现完整性控制很容易绕过。基本上这个固件由两个扩展名为DAT和BIN的文件组成。第一个包含有关固件的信息，包括完整性控制中使用的校验和（[CRC16](https://en.wikipedia.org/wiki/Cyclic_redundancy_check)），第二个包含固件本身。只需更改DAT文件中的校验和就可以在跟踪器上安装篡改后的软件。  
 _在Nuzzle固件中的AT命令_  
为了使设备瘫痪，我们甚至不需要分析固件，因为它并没有加密或者打包，所以我们只需要在十六进制编辑器中打开它，我们就可以找到[AT命令](https://en.wikipedia.org/wiki/Hayes_command_set)和用于发送数据的主机和SIM卡。在主机中更改了几个字节后，更新了固件校验和，并将其上传到设备，就可以使跟踪器停止工作。  
与Link AKC的情况一样，Android的Nuzzle应用程序不检查服务器证书，而且授权接口和用户电子邮件地址以未加密的形式存储在应用程序文件夹中。  
 _未加密的授权令牌和用户电子邮件地址_  
 **Registered CVE** ： CVE-2018-7043 CVE-2018-7042 CVE-2018-7045 CVE-2018-7044
###  TrackR
这次研究中使用了两个TrackR设备：Bravo和Pixel。这些“小玩意儿”不同于以前的设备，因为它们的追踪范围限制在100米以内（如果它们的目的是追踪宠物的话），与其他模型不同，它们没有GPS模块或SIM卡，唯一的连接是通过BLE。他们主要被用来定位公寓周围的钥匙或者遥控器等。但是，开发者已经为这些设备配备了一个可选项，可以让他们跟踪某些物品的移动轨迹：跟踪器的位置可以通过其他带TrackR应用的用户智能手机进行传输。如果应用程序在智能手机上运行，它会将附近检测到的所有“小玩意儿”的数据和智能手机坐标一起传输到服务上。这其中存在的第一个缺陷：任何人都可以登录到移动应用程序并发送一个假坐标。  
我们试图找出更多的问题，但事实证明，其中大部分问题已经被[Rapid7](https://blog.rapid7.com/2016/10/25/multiple-bluetooth-low-energy-ble-tracker-vulnerabilities/)的同事发现。虽然他们的研究是在一年多前发布的，但在撰写本文时，一些漏洞仍未修复。  
因为这些设备在通过BLE连接时没有进行身份验证，所以它们也可对入侵者开放。例如，攻击者只需更改一个Characteristics的值即可轻松地连接和打开音频信号。这可以让攻击者在其拥有者执行或损坏跟踪器电池之前找到该宠物。  
 _TrackR服务和属性结构_  
此外，Android上的TrackR应用程序不验证服务器证书，这意味着MITM攻击可能窃听密码，授权接口，用户电子邮件地址和设备坐标。  
 _TrackR Android应用程序请求包含授权接口_  
好的一面是，TrackR不会将授权接口或密码存储在其自己的文件夹中，这是防护使用超级用户权限窃取数据的木马的有效方法。  
 **Registered CVE** : CVE-2018-7040 CVE-2016-6541
###  Tractive
与我们研究的大多数设备不同，Tractive跟踪器不通过自己的服务器直接与智能手机进行通信，这种方法足够安全，但我们在Android应用程序中仍检测到了一些小问题。首先，与其他情况一样，它不验证可用于MITM攻击的服务器证书。更重要的是，应用程序以未加密的形式存储授权接口：  
以及宠物的移动数据：  
###  Weenect WE301
这是另一个不直接与所有者的智能手机进行连接的跟踪器，它通过内置的SIM卡将宠物坐标传输到服务器。我们没有发现此跟踪器的任何安全问题，但在Android版本的应用程序中检测到类似于Tractive中的问题。  
首先，它不防护MITM攻击，允许攻击者访问用户帐户或拦截地理信息。其次，身份验证数据以未加密的形式存储在应用程序文件夹中，这会将其暴露给设备上具有超级用户权限的木马。
###  Whistle 3
这是该研究中技术上最有意思的追踪者之一。它可以通过其内置的SIM或者Wi-Fi将GPS坐标传输到服务器（如果设备拥有者提供Wi-Fi网络密码），或者通过BLE直接传输到所有者的智能手机。  
我们首先查看了Wi-Fi，并发现开发者已经注意到了连接的安全性：设备通过HTTPS传输小部分数据（即以加密形式）。  
 _Wi-Fi数据传输使用HTTPS进行保护_  
接下来，我们检查了BLE连接并在其中发现了很多安全问题。首先是缺乏适当的身份验证。连接之后，设备等待执行一系列的动作（可以被描述为身份预认证），但这一系列的动作非常简单，第三方可以很容易地复制它。复制过程所需要的只是连接到设备；将两个Characteristics传输到WRITE_TYPE_NO_RESPONSE模式；请求更改传输数据（MTU）的大小；打开一个Characteristics的通知，并将某个数字传输到另一个Characteristics。  
现在，跟踪器已准备好接收和执行不带有用户ID的命令，这意味着任何人都可以发送它们。例如，可以发送一个initiateSession命令，并且作为响应，该设备将发送未加密的一组数据，包括设备坐标。更重要的是，如果连续发送此命令，小工具将不会通过SIM卡发送位置数据，因为它会假定这些数据已通过BLE被“直接”接收到。因此，可以将跟踪器对其所有者隐藏起来。  
还有一个问题：跟踪器在没有任何身份验证的情况下将数据传输到服务器。这意味着任何人都可以替代它，并改变其中的坐标。  
 _该应用程序通过BLE传输从追踪器接收到的数据_  
Android上的Whistle 3应用程序使用HTTPS协议（这很好），但不验证服务器证书。  
 _MITM攻击可以拦截用户数据_  
不仅如此，Whistle
3将用户数据以未加密的形式存储在自己的文件夹中，可通过具有超级用户权限的特洛伊木马将其泄露给盗用者。只有带身份验证的数据存储方法安全。  
 _跟踪器从应用数据库中调整坐标_  
请注意，Whistle
3将数据写入logcat。如上所述，尽管某些具有超级用户权限的系统程序或应用程序才能读取其他应用程序的日志，但也无需将重要数据写入日志中。  
 _Android应用程序可以记录用户和宠物数据（活动，电子邮件地址，姓名，所有者的电话号码）以及一个被使用的接口_  
 **Registered CVE** : CVE-2018-8760 CVE-2018-8757 CVE-2018-8759 CVE-2018-9917
## 结论
GPS追踪器早已在很多领域得到成功应用，但使用追踪器追踪宠物的位置远远超出了传统的应用范围，因此需要升级新的“用户通信接口”和“训练”才能工作和提供云服务等。如果安全措施得不到妥善解决，用户数据可被入侵者访问，这将危害到用户和宠物。  
研究结果：四个追踪器使用BLE技术与所有者的智能手机进行通信，但只有一个安全。其余的追踪器可以接收并执行任何人的命令。此外，只需要靠近跟踪器。就可以将它们禁用或隐藏  
这次测试中只有一个的Android应用程序会验证其服务器的证书，而不是仅仅依赖系统。因此，他们很容易受到MITM攻击——入侵者可以通过“说服”受害者安装证书来拦截传输的数据。