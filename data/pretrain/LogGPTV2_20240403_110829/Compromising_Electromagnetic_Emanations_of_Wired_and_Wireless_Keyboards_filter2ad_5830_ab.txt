boards (Keyboard C1-C2) and 1 wireless keyboard (Key-
board D1). They were all bought between 2001 and
2008. We also collected measurements with the key-
board connected to a laptop with battery to avoid pos-
sible conductive coupling through the power supply. For
obvious security reasons, we do not give the brand name
and the model of the tested keyboards.
5 Discovering and Exploiting Emanations
To discover compromising emanations, we placed Key-
board A1 in the semi-anechoic chamber and we used the
biconical antenna. A diagram of the experiment is de-
picted in Figure 1. We acquired the raw signal with the
oscilloscope as explained above. Since the memory of
the oscilloscope is limited, we have to precisely trigger
data acquisition. First, we used the earliest falling edge
of the data signal sent when a key is pressed . We phys-
ically connected a probe on the data wire of the cable
between the keyboard and the computer.
Figure 2 gives the STFT of the captured raw signal
when the key E is pressed on an American keyboard.
With only one capture we are able to represent the entire
spectrum along the full acquisition time. In addition, we
have a visual description of all electromagnetic emana-
tions. In particular we clearly see some carriers (vertical
lines) and broadband impulses (horizontal lines). The
three ﬁrst techniques are based on these compromising
emanations and are detailed in the following sections.
Our objective is to use an electromagnetic trigger,
since we normally do not have access to the data wire.
The discovered broadband impulses (horizontal lines)
can be used as a trigger. Thus, with only an antenna,
we are able to trigger the acquisition of the compromis-
ing electromagnetic emanations. More details are given
below.
Some keyboards do not emit electromagnetic emana-
tions when a key is pressed. But with a different trigger
model, based on peak detector as well, we discovered an-
other kind of emission, continuously generated (even if
no key is pressed). This is the last technique, detailed in
Section 5.4.
5.1 The Falling Edge Transition Technique
To understand how direct compromising emanations
may be generated by keyboards, we need to brieﬂy de-
scribe the PS/2 communication protocol. According
to [9], when a key is pressed, released or held down,
the keyboard sends a packet of information known as a
scan code to the computer. In the default scan code set1,
most of the keys are one-byte long encoded. Some ex-
tended keys are two or more bytes long. These codes
can be identiﬁed by the fact that their ﬁrst byte is 0xE0.
The protocol used to transmit these scan codes is a bi-
directional serial communication, based on four wires:
Vcc (5 volts), ground, data and clock. For each byte of
the scan code, the keyboard pulls down the clock sig-
nal at a frequency between 10 KHz and 16.7 KHz for
11 clock cycles. When the clock is low, the state of the
signal data is read by the computer. The 11 bits sent
correspond to a start bit (0), 8 bits for the scan code of
the pressed key (least signiﬁcant bit ﬁrst), an odd parity
check bit on the byte of the scan code (the bit is set if
there is an even number of 1’s), and ﬁnally a stop bit (1).
Figure 3 represents both data and clock signals when the
key E is pressed. Note that the scan code is binded to
]
V
[
]
V
[
]
V
m
[
 6
 5
 4
 3
 2
 1
 0
-1
-2
 6
 5
 4
 3
 2
 1
 0
-1
-2
 4
 2
 0
-2
-4
 0
 0
 0
 0.5
 0.5
 0.5
 1
 1
 1
Time in [ms]
Data
Clock
Antenna
 1.5
 1.5
 1.5
 2
 2
 2
Figure 3: Data, clock and the compromising emanation
captured (semi-anechoic chamber, Keyboard A1) with
the loop antenna at 5 meters (a wire of copper, one me-
ter long) when the key E (0x24) is pressed. Data signal
sends the message: 0 00100100 1 1.
a physical button on the keyboard, it does not represent
the character printed on that key. For instance, the scan
code of E is 0x24 if we consider the American layout
keyboard.
Logic states given by data and clock signals in the key-
board are usually generated by an open collector coupled
to a pull-up resistor. The particularity of this system is
that the duration of the rising edge is signiﬁcantly longer
(2 µs) than the duration of the falling edge (200 ns).
Thus, the compromising emanation of a falling edge
should be much more powerful (and with a higher max-
imum frequency) than the rising edge. This property is
known and has been already noticed by Kuhn [17, p.35].
Clock and data signals are identically generated. Hence,
1There are three different scan code sets, but the second one is com-
monly used by default.
5
Oscilloscope
Peak
trigger
STFT
Figure 2
Figure 6
Figure 7
Wired/wireless
keyboard
Antenna
A/D
Memory
Filtering
Features
extraction
Keystroke
Figure 1: Diagram of our equipment for the experiments.
Figure 2: Short Time Fourier Transform (STFT) of the raw signal depicted in Figure 6 (Kaiser windowing of 40,
65536 points)
the compromising emanation detected is the combination
of both signals. However (see Figure 3), the edges of the
data and the clock lines are not superposed. Thus, they
can be easily separated to obtain independent signals.
Since the falling edges of clock signal will always be
at the same place, contrary to the falling edges of data
signal, we can use them to improve our trigger model.
Indeed we consider the detection of a signal based on 11
equidistant falling edges.
Indirect Emanations. If we compare the data signal and
the compromising emanation (see Figure 4) we clearly
see that the electromagnetic signal is not directly related
to the falling edge, as described by Smulders. Indeed, the
durations are not equivalent. Thus, the peaks acquired by
our antenna seem to be indirectly generated by the falling
edges of the combination of clock and data signals. They
are probably generated by a peak of current when the
transistor is switched. Nevertheless, these emanations,
represented by 14 peaks, 11 for the clock signal and 3
for the data signal (see the horizontal lines in Figure 2 or
the peaks in Figure 3) partially describe the logic state of
the data signal and can be exploited.
Collisions. Because only the falling edges are detected,
eventually collisions occur during the keystroke recov-
ery process. For instance, both E (0x24) and G (0x34)
Data
 0
 0.1
 0.2
 0.3
 0.4
 0.5
 0.6
 0.7
 0.8
Antenna
 5
 4
 3
 2
 1
 0
-1
-2
 4
 2
 0
-2
-4
]
V
[
]
V
m
[
 0
 0.1
 0.2
 0.3
 0.4
 0.5
 0.6
 0.7
 0.8
Time in [ms]
Figure 4: A falling edge of the data signal (upper
graph) and the electromagnetic emanation of the key-
board (lower graph). The compromising emission is not
directly generated by the data signal such as described by
Smulders in [30].
share the same trace if we consider only falling edges.
We deﬁne the falling edge trace as ‘2’ when both data and
clock peaks are detected and ‘1’ when only a clock peak
is captured. The letters E (see lower graph in Figure 3)
and G may be described by the string 21112112111.
6
In Figure 5 we grouped every one byte-long scan code,
according to their shared falling edge-based traces.
Trace
21111111111
21111111121
21111111211
21111112111
21111121111
21111121211
21111211111
21111211211
21111212111
21112111111
21112111121
21112111211
21112112111
21112121111
21112121211
21121111111
21121111211
21121112111
21121121111
21121121211
21121211111
21121211211
21121212111
21211111111
21211111211
21211112111
21211121111
21211121211
21211211111
21211211211
21211212111
21212111111
21212111211
21212112111
21212121111
21212121211
Possible Keys
F11 KP KP0 SL
8 u
2 a
Caps Lock
F4 ‘
- ; KP7
5 t
F12 F2 F3
Alt+SysRq
9 Bksp Esc KP6 NL o
3 6 e g
1 CTRL L
[
F5 F7
KP- KP2 KP3 KP5 i k
b d h j m x
SHIFT L s y
’ ENTER ]
F6 F8
/ KP4 l
f v
F9
, KP+ KP. KP9
7 c n
Alt L w
SHIFT R \
F10 Tab
.
KP1 p
Space r
F1
0 KP8
4 y
q
=
Figure 5: The one byte-long scan codes classiﬁcation,
according to the falling edges trace for an American key-
board layout.
Even if collisions appear, falling edge traces may be
used to reduce the subset of possible transmitted scan
codes. Indeed, the average number of potential charac-
ters for a falling edge trace is 2.4222 (2.0556 if we con-
sider only alpha-numeric characters and a uniform dis-
tribution). For example, an attacker who captured the
falling edge-based trace of the word password obtains
a subset of 3 ·2 ·3 ·3 ·2 ·6 ·2 ·6 = 7776 potential words, ac-
cording to Figure 5. Thus, if the objective of the attacker
is to recover a secret password, he has signiﬁcantly re-
duced the test space (the initial set of 368
≈ 241 is low-
ered to 213). Moreover, if the eavesdropped information
concerns an e-mail or a text in English, the plaintext re-
covery process can be improved by selecting only words
contained in a dictionary.
Feature Extraction. The recovery procedure is ﬁrstly
based on a trigger model, able to detect 11 equidistant
peaks transmitted in less than 1 ms. Then, we com-
pute the number of peaks, using a peak-detection algo-
rithm and the GNU Radio library. The feature extraction
is based on the number of peaks correlated to the most
probable value of the table depicted in Figure 5. The
main limitation of the recovery procedure is the ability
to trigger this kind of signal.
5.2 The Generalized Transition Technique
The previously described attack is limited to a partial re-
covery of the keystrokes. This is a signiﬁcant limitation.
We know that between two ’2’ traces, there is exactly one
data rising edge. If we are able to detect this transition
we can fully recover the keystrokes.
To highlight potential compromising emanations on
the data rising edge, we use a software band-pass ﬁlter to
isolate the frequencies of the broadband impulses (e.g.
105 MHz to 165 MHz of the raw signal in Figure 2).
Figure 7 corresponds to the ﬁltered version of the raw
time-domain signal represented in Figure 6. We remark
]
V
m
[
n
i
e
g
a
t
l
o
V
 8
 6
 4
 2
 0
-2
-4
-6
-8
 0
Keyboard A1 in Setup 1 at 5 meters
 0.2
 0.4
 0.6
 0.8
 1
Time in [ms]
Figure 6: Raw signal (Keyboard A1, Setup 1 at 5 meters
with the biconical antenna) when the key E is pressed.
that the ﬁltering process signiﬁcantly improves the SNR.
Thus, the peak detection algorithm is much more efﬁ-
cient.
Furthermore, we notice that the energy of the peaks
of the clock falling edges is not constant. Empirically,
clock peaks have more energy when the state of data sig-
nal is high.
Indeed, the data signal pull-up resistor is
open. When the clock signal is pulled down, the sur-
plus of energy creates a stronger peak. Hence, the peaks
generated by the falling edge of the clock signal intrinsi-
cally encode the logic state of the data signal. Because
7
]
V
m
[
n