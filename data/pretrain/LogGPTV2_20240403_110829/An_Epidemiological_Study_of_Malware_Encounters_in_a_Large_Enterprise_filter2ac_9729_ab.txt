tamp, the destination URL and domain, the source IP address, the
web referer, user-agent string, the website reputation and category,
and the ﬁltering policy applied to that connection.
2.5 VPN Logs
One focus of our study is on where McAfee detection occurred,
i.e., whether “inside” the corporate network (in which case the mal-
ware penetrated the network’s security perimeter to arrive on the
victim host) or “outside.” As part of that investigation, we use Vir-
tual Private Network (VPN) logs to examine employees’ accesses
to corporate resources while physically outside the company.
A VPN allows remote employees to establish a secure communi-
cation channel to the enterprise network. For each VPN session, the
Cisco VPN server records the username that logged in, the fully-
qualiﬁed domain name of the host used to log in, the time of login,
the duration of the VPN session, the number of bytes sent and re-
ceived during the session, and the external IP address from which
the login was made. This gives us an approximation of how often
a corporate laptop is brought outside of the enterprise network, and
how it is used while outside.
2.6 Ethical and Privacy Considerations
As a matter of enterprise policy, employees are notiﬁed that they
must consent to logging / monitoring of their activities by the en-
terprise IT security department in order to use enterprise networks
and computers. The supervisors of the enterprise IT security de-
partment consented to the use of all of the datasets described above
for the purposes of this study and also speciﬁcally to release of
the summary data contained in this paper. Authors were granted
access to the data only while on site at the enterprise, and not per-
mitted to handle any data outside the enterprise network beyond
the summary results presented here. Authors under the jurisdiction
of Institutional Review Boards were not provided identiﬁable data
and so did not require IRB approval.
3. MALWARE ENCOUNTER STATISTICS
Among enterprise-managed hosts whose primary user could be
identiﬁed (see Section 2.3), 15.31% encountered malware over our
four-month observation period. The hosts that generated McAfee
reports, however, are not spread uniformly across the enterprise, as
previous works have also observed in different datasets and types
of entities (e.g., the geographic locations of spamming bots [16]).
Figure 1 shows the number (and fraction) of hosts in each coun-
try from which McAfee reports were received, where the country
was determined by the corresponding employee’s ofﬁce location, as
described in Section 2.2. Only the top 20 countries with the high-
est number of employees are plotted. The encounter rate (on the
right Y-axis) is deﬁned as the fraction of enterprise managed hosts
in that country (for which the primary user could be identiﬁed, see
Section 2.3) that generated McAfee reports. The encounter rate
varies widely across geographic locations — the average encounter
rate by country is 25.68%, with a standard deviation of 27.26%.
In this section, we attempt to understand better the threat land-
scape in enterprise environments and to expand upon differences
between victims affected by malware. First, we examine the ﬁle
system location of detected malicious ﬁles to identify potential
methods by which malware arrived on victim hosts. Second, by
observing the time difference between malware detection and re-
porting, we quantify the relative frequency of malware encounters
taking place within and outside the enterprise network. Third, we
study demographic characteristics of users whose hosts encoun-
tered malware. Finally, we correlate McAfee reports with web
1119categorized or has low reputation. As a result, known web attacks
(such as those detected by anti-virus like McAfee) are prevented,
and other infection vectors (e.g., external drives) dominate.
Figure 3: Distribution of malware locations by country. The shad-
ing of a box represents, out of the hosts in that country, the fraction
where malware was found at that ﬁle system location.
Figure 3 shows, for each location category, the fraction of hosts
in each country on which malware was found at that ﬁle system
location. Rows (and columns) are sorted according to a hierarchical
clustering algorithm to minimize the Euclidean distance between
adjacent rows (and columns). It is clear that India and Egypt stand
out as having a high fraction of hosts encountering malware on
external drives (23.79% and 17.86%, respectively). Also obvious is
the dominance of malware under the web browser cache for hosts in
South Korea, perhaps due to the high number of phishing, malware
hosting, and drive-by-download sites in the country (80, 172, and
54 times higher than that in the U.S.3).
Figure 4: The rate at which malware of different ﬁle system loca-
tion categories are encountered across cities.
We also examine the temporal and spatial locality of malware en-
counters in each ﬁle system location category. The intuition is that,
even though ﬁle system location is only a rough indicator of how
malware propagates, certain ﬁle system locations commonly asso-
ciated with human-driven activities should show a “slower” mal-
ware spread across geographic regions than those associated with
automated events.
To measure this behavior, we ﬁrst identiﬁed each distinct mal-
ware (as identiﬁed by McAfee) that is primarily found in one ﬁle
system location category (i.e., accounting for over 95% of its en-
counters), and that is encountered more than 10 times within our
dataset and in multiple cities (inferred from the ofﬁce location
of the employee associated with the reporting host). For each
such malware, we computed its rate of geographic spread or, more
3http://blogs.technet.com/b/
security/archive/2011/07/18/
a-very-active-place-the-threat-landscape-in-
the-republic-of-korea.aspx.
Figure 1: The number of hosts, and the malware encounter rate, in
each country.
Figure 2: The ﬁle system location where malware was found.
proxy logs to understand the browsing behavior underlying web-
based malware encounters. In Appendix A, we report the preva-
lence of various malware types identiﬁed by the McAfee agent.
Results in this section focus on the ten countries in our dataset
with the most hosts that encountered malware: U.S., India, China,
Ireland, Egypt, the U.K., Brazil, Israel, South Korea, and Germany.
3.1 Malware Location
In this section we investigate where the detected malicious ﬁle
was found on the victim’s ﬁle system. Lacking the ability to mon-
itor host-level activities and to collect additional information at the
time of detection, we instead leverage the directory structure of the
Windows operating system to infer how (or why) a ﬁle ended up
at that location. Appendix B describes the malware locations and
how we categorize them.
Figure 2 shows the fraction of hosts reporting malware at a loca-
tion indicated on the horizontal axis, out of all hosts instrumented
with McAfee and whose primary user could be identiﬁed (see Sec-
tion 2.3). External drives are by far the most prevalent location
for malicious ﬁles, associated with 4.92% of all hosts (one-third of
the hosts that encountered malware). Temporary folders and the
browser cache follow, which likely correspond to secondary mal-
ware downloads by an initial exploit and web drive-by downloads.
This result is somewhat surprising. According to the Symantec
Internet Security Threat Report from 2012 [19], web attacks are
the favorite method for malware authors to gain access to victim
hosts. The 2011 Microsoft Security Intelligence report [11] also
found that most of the malware infections analyzed (45%) required
user interactions to compromise the host, i.e., by visiting malicious
webpages or installing malicious software, much higher than those
accounted for by infected USB or removable drives (26%). By
contrast, the detected malicious ﬁles are most commonly found on
external drives in our dataset. This discrepancy can perhaps be
partially attributed to the enforcement of web ﬁltering policies on
outbound requests (apparently motivated by the prevalence of web
attacks). As described in Section 2.4, connections are blocked if
they are destined for a blacklisted site, or if the remote site is non-
USIndiaIrelandChinaUKGermanyJapanAustraliaIsraelCanadaSingaporeFranceEgyptBrazilItalyRussiaS.KoreaSpainMexicoNetherlands05000100001500020000250003000035000TotalNumberofHosts0.000.050.100.150.200.250.300.350.40EncounterRateExternalDriveTemporaryFilesWebUnknownDownloadApplicationJavaSystemFilesProgramFilesRecycleBinBackupNetDrive0.000.010.020.030.040.05FractionofAllHostsExternalDriveDownloadApplicationProgramFilesJavaSystemFilesWebTemporaryFilesUnknownIndiaEgyptIsraelUSUKIrelandGermanyS.KoreaChinaBrazil0.0250.0500.0750.1000.1250.1500.1750.2000.225ExternalDriveWebJavaTemporaryFilesApplicationSystemFilesUnknownRecycleBinMalwareLocation0.00.20.40.60.81.0Cities/Encounter1120speciﬁcally, the number of cities in which it is encountered, divided
by the number of encounters for that malware. So, a smaller value
for a particular malware indicates that its encounters are concen-
trated in fewer cities. We then grouped the malware by their ﬁle
system location categories and summarized each group’s rates of
geographic spread using a boxplot, as shown in Figure 4. As ex-
pected, malware found on external drives spread the slowest, likely
due to them involving human interactions to move across geo-
graphic locations. Malware under the browser cache (also likely as-
sociated with human activities) and temporary folders (potentially
secondary downloads caused by web drive-bys) are slightly faster,
while those under the system or application directories spread the
fastest.
Findings: Malware on external drives are found on 4.92% of the
hosts instrumented with the McAfee client, while malware under
temporary folders are found on 3.34% of the hosts, followed by the
web cache on 3.11% of the hosts. Compared to consumer contexts,
hosts in the enterprise seem to be less exposed to web attacks (as
seen by the relative dominance of external drives and temporary
folders to the web cache). This is likely due to the enforcement of
web ﬁltering policies at the enterprise network border.
There is a geographic difference in the malware locations on the
ﬁle system — hosts in India and Egypt are more likely to encounter
malware on external drives, while a high fraction of hosts in South
Korea encounter web malware. This suggests that targeted user
education may be helpful in reducing speciﬁc risk factors in certain
regions.
3.2
Inside vs. Outside Enterprise Network
As mentioned in Section 2.1, a McAfee agent attempts to com-
municate with the centralized data collector immediately upon re-
port generation, i.e., at detection time. When the host is connected
to the enterprise network (either over VPN or on the LAN), we ex-
pect the difference between reporting time and detection time to be
small, e.g., on the order of seconds or minutes. By contrast, if the
host is outside the enterprise network when a report is generated,
the reporting time is delayed until the host is brought back inside,
which is likely to be much later (e.g., hours or days).
To estimate the fraction of McAfee reports that are generated
on the corporate network — which means that the host would po-
tentially become infected inside the enterprise, even with the de-
ployment of various security products on the enterprise network —
we examine the difference between reporting time and detection
time. Figure 5 plots the cumulative distribution of this time differ-
ence across all McAfee reports, as well as for reports generated by
hosts in the ﬁve countries where the most hosts encountered mal-
ware. Overall, only 19.13% of the reports are received by the data
collector within ﬁve minutes of generation, and 23.06% within 10
minutes. This suggests that the large majority of reports were gen-
erated when the host was outside the corporate network.
However, we do observe that the fraction of McAfee reports
generated inside (or outside) the corporate network varies widely
across countries. As shown in Figure 5, 52.46% of the McAfee
reports from hosts in Ireland are collected within 10 minutes of de-
tection, while this is true for only 10.91% of the reports from hosts
in India. Rather than suggesting that hosts in Ireland are exhibiting
more risky behaviors “inside,” we believe this reﬂects differences
in culture and working style across regions. For example, some
employees only access company resources during regular working
hours, while others bring corporate laptops home for both work and
personal use.
To investigate this diversity further, we examine VPN logs col-
lected from the enterprise VPN servers (see Section 2.5). Speciﬁ-
Figure 5: The cumulative distribution of the difference between
reporting time and detection time, for the top ﬁve countries with
the most number of malware-encountering hosts.
cally, the VPN logs allow us to infer: (1) the frequency at which
corporate machines are being taken outside, and (2) how those
hosts are used while outside. Figure 6 shows the cumulative dis-
tribution of the number of VPN logins per user and the duration of
VPN sessions for the ﬁve countries in Figure 5.
Figure 6: Cumulative distribution of the number of VPN logins per
user and the duration of VPN sessions, for the top ﬁve countries
with the most number of malware-encountering hosts.
We can make several observations by looking at the two extreme
countries in Figure 5, Ireland and India. First, users in Ireland lo-
gin to VPN less frequently than other countries. Half of the users
logged in less than 15 times during our four-month observation pe-
riod, while this number is 31 for India, and 93 for the U.S. This
perhaps indicates that employees in Ireland are less likely to bring
corporate machines outside of the enterprise network, hence the
higher fraction of “inside” McAfee reports in Figure 5. Secondly,
while users in India also have a relatively low number of VPN lo-
gins, they logon for much shorter durations (e.g., half of the users
logged off after 1.5 hours, compared to 7 hours for users in Ireland).
Relating this to the fact that around 89% of the McAfee detections
in India likely occurred “outside,” we conjecture that these employ-
ees tend to bring corporate laptops outside the enterprise, though
for personal use. Another explanation for the relatively short VPN
duration of users in India may be that home Internet connections are
less stable, and so employees who bring their laptops home tend to
work ofﬂine.
0102030405060Minutes0.00.10.20.30.40.50.6FractionofHosts(CDF)USIndiaChinaIrelandEgyptAll050100150200250NumberofVPNLogins0.00.20.40.60.81.0FractionofHosts(CDF)USIndiaChinaIrelandEgypt0100200300400500600700800DurationofVPNSessions(min)0.00.20.40.60.81.0FractionofSessions(CDF)USIndiaChinaIrelandEgypt1121In addition to the fraction of McAfee reports generated “inside”
and “outside,” we are also interested in whether there is a difference
between the ﬁle system location of the detected malicious ﬁle in the
two cases. Figure 5 shows a sharp knee in the curves at around ﬁve
minutes. To be conservative, we use 10 minutes as a threshold;
we treat reports whose difference between reporting time and de-
tection time is within 10 minutes as “inside,” and the remainder
as “outside.” Figure 7 shows the distribution of malware locations
separately for the “inside” and “outside” cases. The fractions are
computed as the number of hosts that reported malware at that ﬁle
system location while “inside” (or “outside”) over all hosts instru-
mented with McAfee and whose primary user was identiﬁed.
Section 2.2, the enterprise employee database allows us to infer the
user’s level in the organizational tree and job type.
Figure 8 shows the fraction of hosts (i.e., whose corresponding
user is) at each level in the organizational tree that encountered mal-
ware, for all hosts as well as for each country. The company CEO is
assigned the root of the tree (level 0), hence the larger the level, the
lower down the user is in the management hierarchy. Levels with
fewer than ﬁve hosts are crossed out. The countries are ordered by
the number of hosts in the country.
Figure 7: Malware locations for the “inside” and “outside” cases.
The fractions are computed as the number of hosts that reported
malware at that ﬁle system location while “inside” (or “outside”)
over all hosts instrumented with McAfee and whose primary user
was identiﬁed.
External drives are the most prevalent malware location in both
“inside” and “outside” cases. The fact that the fraction for “out-
side” is higher, in addition to a non-trivial fraction (around 8%) of
those ﬁles being multimedia ﬁles (based on the ﬁle extension, e.g.,
mp3, avi, jpg), suggests that users do bring corporate laptops home
for personal use, as noted above. If true, this result further high-
lights the risks of mobile devices being physically brought out and
back into the enterprise network.
The following two popular malware locations, web browser
cache and temporary ﬁles, also affected more hosts “outside” than
“inside.” Since they are commonly associated with drive-by or sec-
ondary downloads by initial infections, their relative popularity out-
side the corporate network is likely caused by the enforcement of
strict ﬁltering policies when the host is on the enterprise network.
More signiﬁcant “inside” than “outside” is malware found under
“System Files” and “Unknown” (the fallback category for ﬁle paths
that match no other location categories). These locations suggest
that these McAfee reports are a result of intentional user actions,
e.g., to install custom software. Security policies may thus be in-
sufﬁcient in preventing such malware, and targeted user education
a more promising approach.
Findings: The large majority of McAfee reports were generated
when the host was outside the enterprise network. However, the
fraction of “outside” reports varies widely by geographic location,
possibly caused by differences in culture and working style. The
dominant malware locations on the ﬁle system are different be-
tween the “inside” and “outside” cases, which might be attributed
to both user behavior (i.e., bringing corporate laptops home) and
the enforcement of security policies on the enterprise network.
3.3 User Demographics
In addition to the malware location and place of detection, we
also examine the relationship between user demographics and the
likelihood of a host being affected by malware. As described in
Figure 8: Malware encounter rate by level in the organizational
tree, both for all hosts (the ﬁrst column) and per country. The
countries are ordered by the number of hosts in that country. The
company CEO is assigned the root of the tree (level 0).
In general, the shading of the boxes becomes darker with the or-
ganizational level, particularly for several countries (India, China,
South Korea, and except for one outlier at the top of the column,
Brazil). We conjecture that a reason for this phenomenon is that
employees higher up the organizational tree (i.e., smaller levels)
are likely to assume managerial roles and hence exhibit less inten-