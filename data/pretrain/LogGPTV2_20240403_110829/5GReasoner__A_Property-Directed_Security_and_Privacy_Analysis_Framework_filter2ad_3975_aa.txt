title:5GReasoner: A Property-Directed Security and Privacy Analysis Framework
for 5G Cellular Network Protocol
author:Syed Rafiul Hussain and
Mitziu Echeverria and
Imtiaz Karim and
Omar Chowdhury and
Elisa Bertino
5GReasoner: A Property-Directed Security and Privacy Analysis
Framework for 5G Cellular Network Protocol
Syed Rafiul Hussain
Purdue University
PI:EMAIL
Mitziu Echeverria
University of Iowa
PI:EMAIL
Imtiaz Karim
Purdue University
PI:EMAIL
Omar Chowdhury
University of Iowa
PI:EMAIL
Elisa Bertino
Purdue University
PI:EMAIL
ABSTRACT
The paper proposes 5GReasoner, a framework for property-guided
formal verification of control-plane protocols spanning across mul-
tiple layers of the 5G protocol stack. The underlying analysis carried
out by 5GReasoner can be viewed as an instance of the model check-
ing problem with respect to an adversarial environment. Due to
an effective use of behavior-specific abstraction in our manually
extracted 5G protocol, 5GReasoner’s analysis generalizes prior anal-
yses of cellular protocols by reasoning about properties not only
regarding packet payload but also multi-layer protocol interactions.
We instantiated 5GReasoner with two model checkers and a cryp-
tographic protocol verifier, lazily combining them through the use
of abstraction-refinement principle. Our analysis of the extracted
5G protocol model covering 6 key control-layer protocols spanning
across two layers of the 5G protocol stack with 5GReasoner has
identified 11 design weaknesses resulting in attacks having both
security and privacy implications. Our analysis also discovered 5
previous design weaknesses that 5G inherits from 4G, and can be
exploited to violate its security and privacy guarantees.
CCS CONCEPTS
• Security and privacy → Formal security models; Security
protocols; Denial-of-service attacks; Mobile and wireless secu-
rity.
KEYWORDS
Cellular Network, 5G, Model Checking, Vulnerabilities, Attacks
ACM Reference Format:
Syed Rafiul Hussain, Mitziu Echeverria, Imtiaz Karim, Omar Chowdhury,
and Elisa Bertino. 2019. 5GReasoner: A Property-Directed Security and
Privacy Analysis Framework for 5G Cellular Network Protocol. In 2019
ACM SIGSAC Conference on Computer and Communications Security (CCS
’19), November 11–15, 2019, London, United Kingdom. ACM, New York, NY,
USA, 16 pages. https://doi.org/10.1145/3319535.3354263
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
CCS ’19, November 11–15, 2019, London, United Kingdom
© 2019 Association for Computing Machinery.
ACM ISBN 978-1-4503-6747-9/19/11...$15.00
https://doi.org/10.1145/3319535.3354263
1 INTRODUCTION
The imminent deployment of the fifth generation (5G) cellular net-
work has created a lot of enthusiasm in both industry and academia
particularly due to its promise of enabling new applications such as
smart vehicles and remote robotic surgery. 5G is not only envisioned
as a replacement of home broadband Internet but also is expected
to have impact in the military battlefield and emergency manage-
ment by improving situational awareness. All these potential novel
and critical applications of 5G can be attributed to its following
enhancements over 4G LTE: (1) Improvements in the physical-layer
technologies enabling the support of large numbers of devices with
substantially improved bandwidth; (2) Robust security posture due
to the introduction of security measures in the upper-layer of the
5G protocol stack. The 5G standard, however, has opened the door
to a wide array of new security challenges stemming from: (i) New
security policies that are not formally verified against adversarial
assumptions; (ii) Retaining security mechanisms from 4G Long
Term Evolution (LTE) and its predecessors. This paper thus aims
to develop highly automated approaches enabling property-guided
formal verification of control-plane protocols of the 5G protocol stack.
Scope and Problem. The 5G control-plane consists of a number of
critical procedures (e.g., initial registration, deregistration, paging)
which are leveraged by fundamental cellular services, such as, voice
call, SMS, data and billing. For example, vulnerabilities in the initial
registration procedure may have serious consequences on those
services, such as man-in-the-middle attacks [10, 39] and spurious
mobile billing [34]. In this paper, we, therefore, address the follow-
ing concrete research question: Is it possible to formally verify six
5G NAS layer procedures— initial registration, deregistration, paging,
configuration update, handover, and service request procedures and
the corresponding five RRC layer procedures— spanning across two
control-plane layers against relevant security and privacy properties?
Challenges. To achieve our goal, however, we need to address the
following challenges. (C1) Specification: The 5G protocol lacks a for-
mal specification [4–6] and hence is prone to ambiguity and under-
specification. (C2) Protocol Complexity: 5G comprises of multiple
sub-protocols across multiple layers that are inter-dependent and
stateful in nature [49]. Multiple types of protocol participants and
messages containing data with a large domain further contribute
to the complexity. (C3) Obtaining Requirements: The standard [4–
6] often states security and privacy requirements in an abstract
way and thus careful considerations and complex assumptions are
required to formulate formal properties from such implicit require-
ments. Particularly, the conformance test suites [7] prescribed by
Session 3D: Formal Analysis ICCS ’19, November 11–15, 2019, London, United Kingdom669the 3GPP standard encompass only primitive security requirements
lacking both completeness and the consideration of adversarial
environments. Finally, the current 5G test suites do not include
conformance requirements of the core network components.
Existing Efforts on 5G formal verification. Only two previous
efforts have formally analyzed the 5G protocol [14, 22]. These anal-
yses [14, 22], however, focus only on a small part of the protocol,
i.e., authentication and key agreement (AKA) protocol of the initial
registration procedure. Also, the analyses are performed in isolation
without considering their interaction with other procedures.
Approach. The most relevant to our approach is the effort by
Hussain et al. [28] that proposed a framework called LTEInspec-
tor for adversarially testing three 4G LTE control-plane protocols.
LTEInspector lazily combines a symbolic model checker and a
cryptographic protocol verifier using an abstract-refinement prin-
ciple. Their instantiation of the LTEInspector framework, however,
suffers from the following limitations: (1) They consider only a
single layer of the protocol stack in isolation and thus LTEInspector
misses critical interactions with protocols of other layers; (2) For
the sake of scalability, they only model packet type and do not
model critical data or packet payload, missing out on interesting
data-/payload-dependent protocol behavior; (3) Their adversary
instantiation cannot handle protocols spanning across different
layers of the stack. The coverage issues of LTEInspector instantia-
tion by Hussain et al. [28] can be attributed to their coarse-grained
abstraction during protocol modeling.
Our 5GReasoner can be viewed as an alternative instantiation
of the general LTEInspector framework but with a different proto-
col modeling discipline. In our 5G protocol model covering six 5G
procedures (i.e., initial registration, deregistration, paging, configu-
ration update, handover, service request, and radio bearer establish-
ment procedures), each protocol layer (Network Access Stratum
or NAS [4] and Radio Resource Control or RRC [5]) contributes a
single state machine. The NAS layer and RRC layer state machines
of the same entity communicate with each other through a private
channel. The RRC layer state machines residing on different entities
(i.e., cellular device and the base station), however, communicate
through a public, adversary-controlled channel. The adversary is
also modeled as a state machine. The adversary’s state machine sits
in the middle of the communicating RRC layer state machines. It
mimics a Dolev-Yao adversary by non-deterministically dropping,
modifying, or injecting messages/payloads while respecting certain
well-formedness conditions. These conditions guide the adversary’s
state machine to perturb message types/payloads while avoiding
parsing errors. Our 5G protocol model has a total of 27 states and
238 transitions.
In our 5G protocol model, the NAS layer protocol packets are
considered as payloads of RRC layer protocol packets. It is thus
essential for us to model packet payloads. Directly capturing all
packet payloads in our model, however, impedes the scalability of
our analysis. To address this, our model only captures those packet
payloads that impact the security- and privacy-specific behavior of
the NAS and RRC layer protocols mentioned above. For address-
ing the state-explosion problem of the model checking step due
to payloads, we use behavior-specific predicate abstraction. In this
approach, rather than directly modeling data we model predicates
over data which are sufficient to reason about the protocol behavior.
In addition to packet payloads, there are some other data, such as
wrapping link counters, which we model faithfully. Some of these
counters are also included in the protocol packet for performing
well-formedness check. Our model also includes different timers
that are missing from the LTEInspector framework.
We instantiate 5GReasoner with two infinite-state model check-
ers (i.e., Kind 2 [19] and nuXmv [18]) and a cryptographic protocol
verifier (i.e., ProVerif). The reason for using two model checkers is
that different model checkers are more effective in reasoning about
different types of temporal properties (e.g., safety and liveness prop-
erties). For gathering properties, we first use the conformance test
suite suggested by the standard. We augment these properties with
other properties that are implicit in the standard. For our evalua-
tion, in total we gather and verify 187 properties of the 5G protocol
model. For each observed counterexample provided by the model
checker while verifying properties, we confirm its feasibility with
ProVerif before reporting it as a design weakness.
Findings. Significant among our findings is the Exposing the De-
vice’s TMSI and Paging Occasion attack which enables an adversary
to track a victim device’s location, hijack the paging channel, and
learn the TMSI which further enables other attacks. Another sig-
nificant finding is the Installing Null Ciphering and Null Integrity
attack which can lead to a UE in the limited service mode to expose
its SUPI which breaks one of the critical security requirements.
Contributions. In summary, the paper has the following technical
contributions.
(1) We propose the 5GReasoner framework for property-guided
formal verification of 5G control-plane protocols.
(2) We construct a formal model of the 5G protocol covering six
5G NAS layer procedures and five RRC layer procedures. Our
model contains sufficient information to allow one to reason
about temporal properties referring to both packet payload,
data, and timer behavior. Our 5G protocol model is of indepen-
dent interest as it can be used to test 5G-enabled devices.
(3) Our evaluation of the 5G protocol model against 187 properties
with 5GReasoner revealed 11 new exploitable protocol design
weaknesses. It has also discovered 5 prior attacks which 5G
inherits from 4G LTE. Our findings have severe security and
privacy implications including downgrade and SUPI catching.
2 BACKGROUND
We now discuss the basics of 5G NR (New Radio). We first discuss
the 5G network architecture and its components followed by the
relevant 5G control-plane procedures needed for this paper.
2.1 5G System Architecture
The 5G architecture can be partitioned into the following three main
components: User Equipment (UE), the 5G radio access network
(5G-RAN) and the 5G core network (5G-CN).
UE: The "User Equipment" is a device (e.g., a smartphone) equipped
with a USIM (Universal Subscriber Identity Module). Each USIM is
uniquely identified by its SUPI (SUbscription Permanent Identifier),
similarly to how previous generations (3G and 4G) USIMs were
identified by their IMSI (International Mobile Subscriber Identity). A
significant difference between 4G and 5G USIMs is that the new 5G
USIMs are capable of generating random nonces.
Session 3D: Formal Analysis ICCS ’19, November 11–15, 2019, London, United Kingdom670Figure 1: Simplified 5G Architecture
5G-RAN: In 5G, a geographical area is partitioned into hexagonal
cells, where each cell is serviced by a gNB (5G base-station). A key
difference between 4G and 5G cells is that the latter are powered by
low-power base stations which cover smaller geographical areas
while providing extremely fast coverage with low latency. The 5G-
RAN can be seen as the network between a UE and a gNB and also
between communicating gNBs.
5G-CN: The 5G core network (5G-CN) can be considered as a mesh
of interconnected services (see Figure 1). The Access and Mobility
Management Function (AMF) manages registration, detach proce-
dures, paging and services related to registration, connection, and
mobility. The authentication and key agreement for registration pro-
cedure is completed with the help of AUSF (Authentication Server
Function)–which stores the UE’s identities, keys and subscription
data and UDM (Unified Data Management) –responsible for gener-
ating Authentication and Key Agreement (AKA) credentials. Other
nodes of 5G-CN are not relevant to our discussion.
2.2 NAS Layer Procedures
We now briefly discuss the NAS layer procedures that are the most
relevant in the context of our paper.
Initial Registration. After rebooting, a UE performs a radio setup
procedure through which it gets assigned a C-RNTI (Cell Radio
Network Temporary Identifier). After the radio setup, the UE estab-
lishes communication through the RRC layer following the RRC
Setup procedure (discussed in Section 2.3). After completing the
RRC setup, the UE starts the NAS registration procedure by sending
the reg_request message. The reg_request message includes its SUCI
(SUbscription Concealed Identifier)– an encryption of its identifier
(SUPI) with a random nonce. The AMF completes the authentication
procedure with the help of AUSF. After successful authentication,
AMF initiates negotiation of ciphering and integrity algorithms
through the security mode procedure. At this point, the NAS level
security context is established between the UE and AMF, and the
selected encryption and integrity protection algorithms will be
applied to the subsequent NAS messages. The AMF concludes the
registration procedure by sending the reg_accept message contain-
ing UE’s TMSI and the UE responds with reg_complete message.
Deregistration. To disconnect from the network, the UE can initi-
ate this procedure by sending a ue_dereg_request message to which
the network is expected to respond with a dereg_accept message.
Configuration Update. Due to tracking area update or a success-
ful service request procedure invoked as a response to a paging
request, the network can initiate a configuration update procedure
to update the UE configuration, e.g., assign a new TMSI. To initi-
ate this procedure, the AMF sends a config_update_command message
which the UE acknowledges with a config_update_complete message.
Figure 2: Important UE procedures
Service request. The UE invokes this procedure when it receives a
paging request from the network or the UE has pending uplink data
and it is in idle mode. The UE initiates this procedure by sending the
service_request messages to the AMF and network responds with
service_accept marking the completion of the procedure.
2.3 RRC Layer Procedures
We discuss the relevant RRC procedures for the sake of easy expo-
sition of our findings.
RRC Setup. RRC setup procedure is the backdrop for NAS reg-
istration. The purpose of this procedure is to establish an RRC
connection and to transfer the initial NAS dedicated information/
message from the UE to the network.
RRC Security Activation. The purpose of this procedure is to
activate security upon RRC connection establishment.
RRC Release. This procedure is used by the network to release
the established radio bearers as well as all radio resources or to
suspend the RRC connection, which includes the suspension of the
established radio bearers. When it suspends the radio bearers it
assigns a I-RNTI (Inactive-Radio Network Temporary Identifier) to
the UE.
RRC Connection Reconfiguration. The purpose of this proce-
dure is to modify a RRC connection, e.g. to establish/modify/release
radio bearers (RBs). As part of the procedure, NAS dedicated in-
formation may be transferred from the network to the UE. After
this RRC procedure the UE completes the initial registration. To
begin this procedure, the network sends a rrc_reconfiguration mes-
sage to which the UE replies with rrc_reconfiguration_complete to
acknowledge the reconfiguration.
RRC Connection Resume. A significant difference in the RRC
layer between 4G LTE and 5G NR is–apart form RRC connected and
RRC idle states, that 5G NR has introduced a new RRC state named
RRC inactive. When a UE is powered up it is in disconnected/idle
Session 3D: Formal Analysis ICCS ’19, November 11–15, 2019, London, United Kingdom671state; it can move to RRC connected with an initial RRC setup or
with connection establishment. If there is no activity from UE for a
short time, it can suspend its session by moving to the RRC inactive
state. The motivation for this state is to reduce system access, save
power and optimize mobility. For a UE to transition from RRC