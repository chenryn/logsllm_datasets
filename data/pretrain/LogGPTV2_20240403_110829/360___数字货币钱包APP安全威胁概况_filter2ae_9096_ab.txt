如下为某未使用复杂口令的数字货币钱包，直接使用六位数字当作交易密码，且没有设置尝试次数，可以直接被暴力破解出来，进行交易。
建议在APP开发过程中，对于用户输入的交易密码进行弱口令的检测，同时加上字母或特殊符号来增加复杂程度，保障口令安全。
### 4.钱包APP伪造漏洞
钱包APP被黑客逆向后加入恶意代码，回传敏感信息如助记词，修改交易收款方地址等，对用户会造成直接钱财损失。所以在使用钱包的时候，一定需要在官方渠道进行下载，同时APP本身如果对软件完整性未做严格的校验，同样可以导致相关事件发生。
在2017年底出现的Janus签名漏洞可以直接应用在此场景下，在修改安卓应用后，利用Janus漏洞对其进行特殊处理，可以绕过安卓系统的签名校验对原应用进行更新操作。安卓系统一直以来都是使用V1签名校验，当系统已经安装了一个应用，当对其更行时，会校验是否是同一个签名，而在签名校验的过程中，系统会默认读取的是一个ZIP文件，并且直接从更新包的尾部进行读取数据，当执行更新文件的时候，是从头部开始读取，如果是Dex就直接执行操作，那么我们就可以获取到最新版本的数字货币钱包安装包做如下修改：
  1. 取出Dex文件，植入恶意代码
  2. 原安装包拼接到修改后的Dex后面
  3. 对拼接后的Dex文件做文件头修复操作
那么当更新的时候，从尾部读取数据，读到的是原APK，可以通过系统对其进行的签名校验，当执行的时候，读取的是我们插入恶意代码后的Dex文件，如果数字货币钱包被修改，植入恶意代码，比如将转账的地址全部替换成攻击者的收款地址，如果用户使用伪造的数字货币钱包进行更新并且进行转账操作，会造成不可估量的损失和后果。
在我们的分析过程中，发现部分数字货币钱包依旧使用V1签名，我们进行模拟攻击，生成加入恶意代码的APP。
虽然谷歌在收到漏洞后就对其做了补丁，但是并非所有手机厂商会及时推送补丁给用户，建议使用V1+V2签名的方式对发布的应用签名，可以抵抗APP伪造漏洞的攻击。
### 5\. 核心功能代码未加固
安卓应用由于其使用Java语言开发，在未使用加固的情况下十分容易被反编译出近似源码的效果。
而其使用的Smali语言也相对容易掌握，所以在不加固的情况下，数字货币钱包十分容易被重打包，重打包的效果如上面提到的伪造漏洞一样，给用户使用上造成直接的损失。同时，关键信息的泄露也会让黑客更加容易分析代码逻辑，将于助记词使用相关的算法进行提取，逆向分析出加解密流程，利用其它漏洞进行盗取助记词等信息。
建议采用加固方案对钱包APP中关键功能代码进行加固处理，防止被黑客进行逆向分析，提高安全性。
### 6\. 钱包敏感信息不正确存储
我们知道，在数字货币世界中，最关键的就是私钥，那么对于用户，数字货币钱包最关键的就是助记词，有了助记词我们可以推导出私钥。所以，如果数字货币钱包对助记词或者私钥进行了不恰当的本地存储，将会是一个非常高危的风险。我们在分析一款钱包的时候，发现钱包APP会自动为当前客户端创建一个钱包，该钱包使用错误的方式保存在了本地，使得在Root设备上攻击者可以对该钱包文件进行解码并获取用户的助记词，钱包私钥等钱包数据，如下图是我们的模拟攻击过程，其中对随机生成的助记词进行了部分打码。
我们在逆向后，编写相关代码进行数据解密恢复：
建议在开发过程中，对待本地保存数据一定要做好加密处理，防止数据泄露，直接对用户的钱财造成损失。
### 7\. 网络数据交互被劫持篡改
当用户通过数字货币钱包进行交易，是否使用合适的加密算法对交易数据进行加密是衡量网络连接安全很重要的一个维度，不仅仅需要注意其是否对数据进行加密，还要注意是否将助记词，私钥等数据传输回服务器，当助记词等数据被传输回服务器，相当于除用户之外，还有其他人知道用户自己的助记词，当存储助记词的服务器被黑客入侵，极有可能导致账户被盗。
另外当钱包存在交易功能之后，对于当前货币价格的展示，在网络数据交互过程中可以进行劫持篡改数据，如下图我们修改的BTC，ETH和XRP的实时价格，展示到用户手机上。
这样，对用户展示页面也就是黑客希望用户看到的货币价格，间接地诱导用户对该货币进行交易，炒作某一货币的兑换价值，在短时间内的大量买卖，间接控制相关价格了。
在此过程，建议厂商对网络交互数据采用严格校验，如使用https，则对证书信息进行强校验，防止数据在传输过程被篡改。
## 总结
现阶段，市面上有大量良莠不齐的数字货币钱包存在，而不少开发团队在以业务优先的原则下，暂时对自身钱包产品的安全性并未做到足够的防护，一旦出现安全性问题会导致大量用户出现账户货币被盗，而由于数字货币实现的特殊性，被盗资产非常难以追回。
希望钱包厂商可以更加在业务功能上更加注重安全，一方面保护厂商利益不受损失，另一方面也保护用户钱财不受损失，关于此文档中我们针对钱包厂商安全审计的相关技术点，已发布相关数字货币钱包安全白皮书文档供大家参考。
## 团队介绍
360威派克团队（Vulpecker Team）隶属于360信息安全部,
360信息安全部致力于保护内部安全和业务安全，抵御外部恶意网络攻击，并逐步形成了一套自己的安全防御体系，积累了丰富的安全运营和对突发安全事件应急处理经验，建立起了完善的安全应急响应系统，对安全威胁做到早发现，早解决，为安全保驾护航。技术能力处于业内领先水平，培养出了较多明星安全团队及研究员，研究成果多次受国内外厂商官方致谢，如微软、谷歌、苹果等，多次受邀参加国内外安全大会议题演讲。目前主要研究方向有区块链安全、WEB安全、移动安全（Android、iOS）、网络安全、云安全、IOT安全、等多个方向，基本覆盖互联网安全主要领域。
**附录：**
360数字货币钱包安全白皮书地址：
区块链生态安全解决方案，了解更多请点击——360区块链安全：