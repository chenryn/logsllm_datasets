title:Sonar: Detecting SS7 Redirection Attacks with Audio-Based Distance
Bounding
author:Christian Peeters and
Hadi Abdullah and
Nolen Scaife and
Jasmine Bowers and
Patrick Traynor and
Bradley Reaves and
Kevin R. B. Butler
2018 IEEE Symposium on Security and Privacy
Sonar: Detecting SS7 Redirection Attacks With
Audio-Based Distance Bounding
Christian Peeters∗, Hadi Abdullah∗, Nolen Scaife∗, Jasmine Bowers∗,
Patrick Traynor∗, Bradley Reaves†, Kevin Butler∗
∗University of Florida
{cpeeters, hadi10102, scaife, jdbowers}@uﬂ.edu,
{traynor, butler}@cise.uﬂ.edu
†North Carolina State University
PI:EMAIL
Abstract—The global telephone network is relied upon by
billions every day. Central to its operation is the Signaling
System 7 (SS7) protocol, which is used for setting up calls,
managing mobility, and facilitating many other network services.
This protocol was originally built on the assumption that only
a small number of trusted parties would be able to directly
communicate with its core infrastructure. As a result, SS7 —
as a feature — allows all parties with core access to redirect
and intercept calls for any subscriber anywhere in the world.
Unfortunately, increased interconnectivity with the SS7 network
has led to a growing number of illicit call redirection attacks.
We address such attacks with Sonar, a system that detects the
presence of SS7 redirection attacks by securely measuring call
audio round-trip times between telephony devices. This approach
works because redirection attacks force calls to travel longer
physical distances than usual, thereby creating longer end-to-end
delay. We design and implement a distance bounding-inspired
protocol that allows us to securely characterize the round-trip
time between the two endpoints. We then use custom hardware
deployed in 10 locations across the United States and a redirection
testbed to characterize how distance affects round trip time in
phone networks. We develop a model using this testbed and
show Sonar is able to detect 70.9% of redirected calls between
call endpoints of varying attacker proximity (300–7100 miles)
with low false positive rates (0.3%). Finally, we ethically perform
actual SS7 redirection attacks on our own devices with the help
of an industry partner to demonstrate that Sonar detects 100%
of such redirections in a real network (with no false positives).
As such, we demonstrate that telephone users can reliably detect
SS7 redirection attacks and protect the integrity of their calls.
I.
INTRODUCTION
Telephony systems represent the most ubiquitous and trusted
communications infrastructure in the world. In both the devel-
oped and developing worlds, these networks offer reliable au-
dio connections that allow their subscribers to chat with distant
family members, perform important business transactions and
even exchange highly sensitive information. Many sectors of
the global economy, especially ﬁnance and infrastructure, rely
on telephony systems as a critical fallback to ensure that high
value transactions or signiﬁcant changes to operation indeed
originate from an authorized party.
The content of calls over telephone networks has been
viewed as secure from most adversaries solely due to limited
access to core networks. Only a small number of providers
and governments have historically been able to access the
underlying Signaling System 7 (SS7) network, which is used
for providing translations between cellular networks. SS7 was
designed on a foundation of implicit trust — that is, anyone
with access is authorized to make any request. This assumption
is convenient, especially in a mobile context, where providers
other than a users’ home network may legitimately need to
quickly redirect trafﬁc to a roaming client. Such features could
also be used to maliciously redirect
trafﬁc intended for a
speciﬁc user, to ensure that its delivery path included a system
controlled by an adversarial party interested in intercepting
such trafﬁc. Such SS7 redirection attacks were long assumed
to be rare; however, deregulation in the 1990s [1] and the
increased diversity of access technologies to these networks
have eliminated this assumption. The impact of these changes
has been obvious. As recent media coverage demonstrates,
SS7 redirection attacks have become increasingly common
and are rumored to be a favorite means of eavesdropping by
intelligence agencies [2], [3].
We develop Sonar,1 a mechanism for detecting SS7 redirec-
tion attacks at call endpoints. Sonar relies on the key insight
that SS7 redirection attacks increase the distance that call audio
travels, thereby increasing audio latency. Sonar detects SS7
redirection attacks by expanding on techniques developed for
line-of-sight distance bounding from the wireless community
and uses the audio channel between two endpoints to transmit
challenge/response messages to securely estimate the round
trip time (RTT) over a multi-hop network.
This paper makes the following contributions:
• Acoustic Distance Bounding: We design and implement
a distance bounding-inspired protocol that we refer to as
Rapid Audio Exchange (RAE). This protocol relies on a
series of audio tones to implement a challenge-response
protocol based on the work by Hancke and Kuhn [4].
Unlike traditional wireless distance bounding protocols,
RAE is designed to operate in a multihop adversarial
telephony network in which the endpoints are honest. To
1Traditionally, Sonar is used to map locations that are inaccessible or opaque
to the eye (e.g., underwater). Like real sonar systems, we rely on short bursts
of audio to map connections.
© 2018, Christian Peeters. Under license to IEEE.
DOI 10.1109/SP.2018.00006
567
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:30:21 UTC from IEEE Xplore.  Restrictions apply. 
our knowledge, this is the ﬁrst technique to detect SS7
redirection attacks in an end-to-end fashion.
• Distance vs “Mouth to Ear” RTT Time: Intuitively,
the time to traverse a network is dependent upon the
speed of light/propagation and the distance between the
two endpoints. This relationship has not previously been
characterized in a security context for telephony networks.
We examine the impact of distance on RTT by building
custom hardware to measure RTT at ten locations across
the United States.
• Demonstrate Attack Detection Capabilities: We emu-
late SS7 redirection attacks by implementing a testbed
that
intercepts our calls and redirects them via VPN
to locations across the world before delivering them to
their intended cellular endpoints. We show that Sonar has
a 70.9% true positive rate (0.3% FP) for calls varying
attacker proximity (300–7100 miles), and a 97.0% true
positive rate (0.3% FP) for all US calls redirected outside
of North/Central America. These tests allow us to develop
a conservative model before performing real attacks.
• Validate detection with real SS7 rerouting attacks: We
validate our testbed by legally conducting SS7 attacks
with an industry partner. We ﬁnd that our testbed mea-
surements are conservative, and demonstrate the ability to
identify 100% of our own redirection attacks with a 0%
false positive rate. We believe these results are indicative
of expected performance when deployed.
While many are calling for SS7 to be “made secure” [5], it
is unlikely that this global infrastructure will be fundamentally
redesigned and redeployed in the foreseeable future. As such,
the most practical solution in the short and medium terms is the
development of tools that allow end users to be made aware of
when their calls are likely experiencing malicious redirection.
The remainder of this paper is organized as follows: Sec-
tion II provides background information on telephony systems
and their weaknesses; Section III formally describes our hy-
pothesis; Section IV details our threat model; Section V details
our acoustic distance bounding protocol; Section VI explains
our experimental setup; Section VII presents our results that
both conﬁrm our hypothesis about additive delay caused by
such attacks and that our proposed can detect them; Section IX
discusses additional concerns related to Sonar; Section VIII
provides detail on our execution of actual SS7 rerouting attacks
and how they compare to our simulation; Section X covers
related work and Section XI provides concluding remarks.
II. BACKGROUND
This section provides background on how the SS7 protocol
uniﬁes the global telephone network and how network-based
redirection attacks using SS7 can affect call routing.
A. Signaling System 7
The Public Switched Telephone Network (PSTN) is a di-
verse system connecting a variety of technologies including
traditional landline, cellular, and VoIP. Each of these technolo-
gies deﬁne their own protocols to connect end devices (e.g.,
Cellular
Landline
PSTN
(SS7)
Internet
Skype
VoIP Phone
Smart Phone
VoIP 
ITSP
Fig. 1: SS7 connects individual telephone networks to form
the global PSTN.
phones) as well as protocols for delivering calls, text messages,
data, and other value added services. These interconnections
are shown in Figure 1.
While access protocols vary substantially at the network
edge, call signaling, mobility management, and many other
network features are provided by a protocol suite known as
Signaling System Number 7 (SS7). SS7 forms an all-digital
communications network that
is used for communications
between telephone switches, important databases2, and other
core network entities. SS7 is used to set up and tear down
phone calls and manage the location of mobile phones facilitate
delivery of calls, messages, data, and roaming. Note that SS7
does not carry call content — only signaling information. SS7
is not only important for the many core network features that
it facilitates; it is also important because it acts as a “lingua
franca” between carriers, who may support different access
technologies (e.g., landline and cellular).
SS7 Security Unfortunately, SS7 has many critical security
vulnerabilities. The primary design ﬂaw is that SS7 has
no mechanisms for authenticating messages or determining
whether a particular network endpoint is authorized to send
that message. As a result, any participant in the SS7 core
network can claim to send messages on behalf of another
network entity and can claim to be authoritative for a given
subscriber. A consequence of this is that any SS7 network node
can send a query to locate any mobile subscriber – trivially
enabling powerful, high-resolution tracking of a user [6]. Ad-
ditionally, SS7 provides facilities to completely deny service to
the endpoint. These issues are not simply bugs or oversights,
but rather the result of intentional design decisions. The ability
for any network to speak on behalf of any subscriber is
essential to support mobility (especially roaming) and number
portability. For example, a roaming subscriber may wish to
forward calls to a landline; the roaming network must establish
call forwarding for that subscriber. These vulnerabilities allow
any SS7 core entity to track and control the ﬂow of calls and
2These databases include caller ID names (CNAM), mappings of toll-
free numbers (e.g. 1-800-XXX-XXXX) to canonical numbers, and mobile
subscriber registries like the HLR in mobile networks.
568
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:30:21 UTC from IEEE Xplore.  Restrictions apply. 
text messages of any subscriber worldwide.
Some carriers attempt
to block clearly malicious attack
messages at the network edge using GFW ﬁrewalls, but many
still do no ﬁltering at all. For example, carriers in the United
States do not block attack messages and provide no protection
against SS7 redirection attacks [7]. While solutions to this
problem exist, they require carriers to implement them, which
they are either unable or unwilling to do. Our solution can
be implemented by users without cooperation from carriers.
The problem is not easy to solve: many “attack” messages are
simply abuses of functionality. These network messages exist
because a carrier intending to deliver a call to a mobile phone
needs to know to which carrier to send the call. While ingress
ﬁltering of sensitive SS7 messages (like those that redirect
calls) is an important ﬁrst step, the design of the phone network
requires faith in call routing and provides zero guarantees.
E-Model User Satisﬁcation
Mouth-to-ear-delay/ms
Users Very Satisﬁed
Users Satisﬁed
Some Users Dissatisﬁed
Many Users Dissatisﬁed
Nearly All Users Dissatisﬁed
0 - 200
200 - 290
290 - 390
390 - 550
>550
TABLE I: The ITU E-Model User Satisfaction for Speech
Applications correlates one-way transmission times with user-
perceived audio quality. Testing by the ITU demonstrates that
mouth to ear delay of less than 400ms provides satisfactory
audio quality to the majority of users.
CAMEL server. When calls are placed, the attacker modiﬁes
the number dialed to one under the attacker’s control. The
attacker can then answer and forward the call audio in a
manner similar to the other attacks.
B. SS7 Redirection Attacks
C. The Role of Convergence
The openness of the SS7 network, combined with limited
controls for authentication and authorization, means that sev-
eral legitimate network functions can be abused to redirect
calls. These attacks are stealthy, and while it is difﬁcult to
know how often they occur, there is evidence that these attacks
are increasingly common [2], [8], [9].
The idea behind these redirection attacks is to cause a call
to or from the victim to be sent to the attacker instead. The
attacker can then forward the call to another destination or
simply answer the call. If the attacker answers the call, the
attacker can also place a call
to the other legitimate call
party and patch the audio between the two calls, allowing
interception and eavesdropping of the apparently legitimate
call. There are several network functions that facilitate this.
The ﬁrst mechanism is the simplest: spooﬁng a call forward-
ing request. In this attack, the attacker spoofs a call forwarding
registration message from the victim to the victim’s home
network. This message forwards the call from the victim to an