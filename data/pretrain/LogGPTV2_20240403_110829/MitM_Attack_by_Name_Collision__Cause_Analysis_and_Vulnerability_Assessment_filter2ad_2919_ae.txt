1566 (95.9%)
426 (97.0%)
224 (95.3%)
227 (95.0%)
7447 (93.5%)
73 (91.3%)
Registration status (as of 2015/09/26)
Reg. #
# of TLDs
129 (10.9%)
49 (10.1%)
68 (9.1%)
284 (7.8%)
67 (9.5%)
66 (9.4%)
123 (7.0%)
43 (9.4%)
28 (11.0%)
33 (12.9%)
w/ reg.
56 (27.5%)
28 (23.0%)
34 (22.1%)
79 (23.9%)
35 (24.0%)
31 (21.5%)
55 (23.9%)
27 (23.9%)
17 (23.3%)
19 (27.1%)
589 (6.6%)
14 (15.6%)
123 (30.3%)
9 (27.3%)
# of TLDs
w/ full reg.
18 (8.8%)
10 (8.2%)
16 (10.4%)
8 (2.4%)
15 (10.3%)
9 (6.3%)
17 (7.4%)
12 (10.7%)
8 (11.0%)
14 (20.0%)
16 (3.9%)
7 (21.2%)
TABLE V: Attack surface domain characteristics and registration status (as of 2015/09/26).
TLD %
TLD WPAD query %
)
%
(
F
D
C
 100
 90
 80
 70
 60
 50
 40
 30
 20
 10
 0
 0.5  0.55  0.6  0.65  0.7  0.75  0.8  0.85  0.9  0.95
 1
Attack surface query ratio
Fig. 9: CDF of attack surface query ratio in TLD percentage
and TLD leaked WPAD query trafﬁc percentage.
)
%
(
F
D
C
 100
 90
 80
 70
 60
 50
 40
 30
 20
 10
 0
 0
 50
TLD %
TLD WPAD query %
 100
 150
 200
Persistence period # (n/p)
 250
 300
Fig. 10: CDF of attack surface period number in TLD per-
centage and TLD leaked WPAD query trafﬁc percentage.
VI. ATTACK SURFACE AND EXPLOIT STATUS
CHARACTERIZATION
With attack surface successfully computed, in this section
we characterize their properties in the victim ASes, and also
study their registration and exploit status in the wild.
A. Attack Surface Characterization
Finding 1. Among the 10 top vulnerable victim ASes,
ASes operating open resolvers expose the largest attack
surfaces. Column 2, 4, and 6 in Table V show the number
of attack surface domains, distinct attack surface TLDs and
SLDs for the 10 highly-vulnerable ASes discussed in §IV.
As shown, A4 and A7, which both run open resolvers as
discussed in §IV-B1, have signiﬁcantly more attack surface
domains, TLDs and SLDs than other victim ASes, even
684684
though their leaked WPAD query trafﬁc is much less than
some home access network ASes such as A1. This is likely
because these popular open resolvers are used in all kinds
of network environments and the exposed sufﬁxes are more
diverse compared to a single home access network AS (also
shown in Fig. 6). This suggests that ASes running popular
open resolvers should be the ﬁrst priority for deploying AS-
level defense.
Finding 2. In victim ASes,
large fractions of leaked
WPAD queries are for new gTLD domains deﬁned to have
high vulnerability (using our attack surface deﬁnition).
Column 3 of Table V lists the percentage of leaked WPAD
queries for the attack surface domains during their persistence
periods in the 10 highly-vulnerable victim ASes. As shown,
for all of these ASes, on average 96.7% of the leaked queries
are in the HVDs, showing a high ratio of exploitability in the
wild if these domains are registered.
Finding 3. For most of the new gTLDs, only very few
SLDs are highly vulnerable. Fig. 11 shows the attack surface
size distribution for new gTLDs with leaked queries from
A1. In the ﬁgure, even though some new gTLDs can have
very large attack surface, e.g., over 250 for .office, 184
(90.2%) of the 204 new gTLDs have fewer than 10 domains
in their attack surface. This uneven distribution also holds for
other highly-vulnerable victim ASes. As shown in column 5
of Table V, for 9 of the 10 ASes, more than half of the new
gTLDs only have one domain in their attack surface. This
indicates that for most new gTLD strings, the attack surface
size is actually very small, and thus only a few domains need
to be treated more carefully in registration.
Finding 4. Most SLD strings only appear in one new
gTLD’s attack surface. We then measure the popular SLD
strings shown across the new gTLD attack surface in A1. From
the result, the 5 most popular SLD strings are us, corp,
local, home, and net, which are mostly generic ones. Out
of the 204 distinct new gTLD string in A1, we ﬁnd that
the most popular SLD string, .us, is only shared by 7 new
gTLDs’ attack surface. As shown in column 7 of Table V, for
all the 10 highly-vulnerable victim ASes, more than 90% SLD
strings only appear in one new gTLD’s attack surface in the
victim AS. This suggests that if applying SLD reservation as
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:18:12 UTC from IEEE Xplore.  Restrictions apply. 
e
z
s
i
e
c
a
f
r
u
s
k
c
a
t
t
A
 300
 250
 200
 150
 100
 50
 0
 100
 10
 1
 0.1
5
0
1
0
0
1
5
0
2
0
0
.
.
.
.
.
.
.
.
.
o
a
n
d
g
p
g
s
c
c
.
l
.
.
f
.
i
.
a
l
a
b
w
.
f
.
li
a
o
o
.
.
.
.
t
.
c
h
h
v
o
s
h
w
e
d
il
y
r
e
r
k
m
u
b
u
o
c
r
l
h
s
c
e
d
r
c
h
f
f
i
c
e
d
e
e
s
t
o
v
l
r
r
c
i
t
o
o
h
y
w
m
m
w
b
d
u
o
u
o
r
k
a
l
p
o
l
New gTLDs ranked by attack surface size
r
e
v
o
t
f
e
l
n
i
%
D
L
T
 140
 120
 100
 80
 60
 40
 20
 0
No data
No recent data
Lack periodicity
Borderline
A10 A1
A2 A1
A10 A2
Fig. 11: Attack surface size distribution for new gTLDs
delegated as of 2015/08/25.
Fig. 12: Breakdown of new gTLDs in the leftover part in cross
AS attack surface comparison.
a defense strategy, each new gTLD registry needs to identify
its own SLD reservation list based on its WPAD query trafﬁc
patterns.
Finding 5. A large portion of the attack surface domains
are victim AS unique. As shown in Table V, 8918 domains
across 406 new gTLDs are in the union set of the attack surface
of the 10 highly-vulnerable victim ASes, but only 90 (1%) of
these domains are in the intersection set. Thus, very few attack
surface domains are in common among different victim ASes.
Moreover, 3689 (41.4%) of these domains are included in only
1 AS’s attack surface. These results indicate that most attack
surface domains are actually victim AS unique.
To understand why large numbers of domains are AS
unique, we pick 3 home access network ASes in the highly-
vulnerable AS set, and pair-wisely compare their attack surface
domains. More speciﬁcally, for comparison between AS Ax’s
attack surface, SAx , and AS Ay’s attack surface, SAy , we study
− SAy and
the leaked query trafﬁc in Ay for domains in SAx
− SAx .
also leaked query trafﬁc in Ax for domains in SAy
We classify the reason why these domains are not left out in
the other AS’s attack surface into 4 categories: No data, No
recent data, Lack periodicity, Borderline. Category No data
means that none of the domains’ leaked queries are observed
in the other AS in our 2-year root NXD WPAD dataset, and
No recent data means none of such queries are observed in one
month before the delegation of the corresponding new gTLDs.
Category Lack periodicity means that the domain’s queries
appear in less than 50% of the days in 3 months before the
delegation of the corresponding new gTLDs, which indicates
that they are left out due to low persistence according to our
attack surface deﬁnition. Category Borderline means that we
could include them in the other AS’s attack surface, but we
left them out due to the balancing of persistence level and
query ratio as discussed in §V-A.
The breakdown analysis result of the AS-unique attack
surface domains is shown in Fig. 12. In the ﬁgure, we ﬁnd that
more than 80% of these domains are left out because they have
no leaked queries for at least a month before the delegation
of the corresponding new gTLDs, which can thus hardly be
eligible to be considered as highly vulnerable according to
our attack surface deﬁnition. For the other 20% domains,
almost all of them lack periodicity, and only at most 3%
of the domains are left out due to the balancing process in
our quantiﬁcation method. Thus, each victim AS indeed has a
large portion of HVDs that are unique to it. This suggests that
to deploy effective defense at the AS level, each victim AS,
especially those highly-vulnerable ones, should customize its
own domain ﬁltering list.
B. Registration Status
Once these HVDs are registered, the actual exploitation can
start at any time. Next, we use new gTLD zone ﬁles and
WHOIS data to characterize the current registration status of
these HVDs.
Finding 6. While for some new gTLDs their highly-
vulnerable domains have already been fully registered, the
overall registration status is still in the early stage. The
last 3 columns in Table V include statistics of the registered
HVDs as of 2015/09/26 for the 10 highly-vulnerable victim
ASes, along with the intersection and union sets. As shown,
all 10 victim ASes have some of these HVDs registered, but
the registration percentages are in the range of 7% to 13%,
which is not high. On the TLD level, approximately 22% to
28% of new gTLDs with attack surface in a victim AS have
at least 1 attack surface domain already registered. For most
victim ASes, around 10% of them have already had all of their
attack surface domains registered, indicating that their attack
windows are fully open. Recall that once an HVD is registered,
the management of the underlying zones is delegated from
the new gTLD registries to the domain registrants, and thus