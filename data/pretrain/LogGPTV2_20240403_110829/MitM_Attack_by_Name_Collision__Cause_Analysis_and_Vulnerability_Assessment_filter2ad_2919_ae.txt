### Table V: Attack Surface Domain Characteristics and Registration Status (as of 2015/09/26)

| AS | # of Attack Surface Domains | % of Leaked WPAD Queries | # of TLDs | # of SLDs | % of TLDs with Full Reg. | % of TLDs w/ reg. | % of TLDs w/ full reg. |
|---|-----------------------------|---------------------------|------------|------------|--------------------------|--------------------|------------------------|
| A1 | 1566 (95.9%) | 129 (10.9%) | 56 (27.5%) | 18 (8.8%) | 14 (15.6%) | 123 (30.3%) | 9 (27.3%) |
| A2 | 426 (97.0%) | 49 (10.1%) | 28 (23.0%) | 10 (8.2%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |
| A3 | 224 (95.3%) | 68 (9.1%) | 34 (22.1%) | 16 (10.4%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |
| A4 | 227 (95.0%) | 284 (7.8%) | 79 (23.9%) | 8 (2.4%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |
| A5 | 7447 (93.5%) | 67 (9.5%) | 35 (24.0%) | 15 (10.3%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |
| A6 | 73 (91.3%) | 66 (9.4%) | 31 (21.5%) | 9 (6.3%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |
| A7 | 123 (7.0%) | 55 (23.9%) | 17 (7.4%) | 12 (10.7%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |
| A8 | 43 (9.4%) | 27 (23.9%) | 12 (10.7%) | 12 (10.7%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |
| A9 | 28 (11.0%) | 17 (23.3%) | 8 (11.0%) | 12 (10.7%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |
| A10 | 33 (12.9%) | 19 (27.1%) | 14 (20.0%) | 12 (10.7%) | 12 (10.7%) | 123 (30.3%) | 9 (27.3%) |

### Figures

**Figure 9: CDF of Attack Surface Query Ratio in TLD Percentage and TLD Leaked WPAD Query Traffic Percentage**

- X-axis: Attack surface query ratio
- Y-axis: Cumulative distribution function (CDF)
- Data points: 0.5, 0.55, 00.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1

**Figure 10: CDF of Attack Surface Period Number in TLD Percentage and TLD Leaked WPAD Query Traffic Percentage**

- X-axis: Persistence period number (n/p)
- Y-axis: Cumulative distribution function (CDF)
- Data points: 0, 50, 100, 150, 200, 250, 300

### Section VI: Attack Surface and Exploit Status Characterization

#### A. Attack Surface Characterization

**Finding 1:**
Among the top 10 most vulnerable victim ASes, ASes operating open resolvers expose the largest attack surfaces. As shown in Table V, ASes A4 and A7, which run open resolvers, have significantly more attack surface domains, TLDs, and SLDs compared to other victim ASes. This is likely due to the diverse network environments where these popular open resolvers are used, leading to a broader range of exposed suffixes.

**Finding 2:**
In victim ASes, a large fraction of leaked WPAD queries are for new gTLD domains defined as highly vulnerable. On average, 96.7% of the leaked queries are in the HVDs, indicating a high potential for exploitation if these domains are registered.

**Finding 3:**
For most new gTLDs, only a few SLDs are highly vulnerable. Figure 11 shows the attack surface size distribution for new gTLDs with leaked queries from A1. Despite some new gTLDs having large attack surfaces, 184 (90.2%) of the 204 new gTLDs have fewer than 10 domains in their attack surface. This uneven distribution holds for other highly-vulnerable victim ASes. For 9 out of the 10 ASes, more than half of the new gTLDs have only one domain in their attack surface.

**Finding 4:**
Most SLD strings appear in only one new gTLD's attack surface. The 5 most popular SLD strings in A1 are us, corp, local, home, and net. The most popular SLD string, .us, is shared by only 7 new gTLDs' attack surfaces. For all 10 highly-vulnerable victim ASes, more than 90% of SLD strings appear in only one new gTLD's attack surface. This suggests that SLD reservation as a defense strategy should be customized for each new gTLD registry based on its WPAD query traffic patterns.

**Finding 5:**
A large portion of the attack surface domains are unique to the victim AS. Out of 8918 domains across 406 new gTLDs in the union set of the attack surface of the 10 highly-vulnerable victim ASes, only 90 (1%) are in the intersection set. Additionally, 3689 (41.4%) of these domains are included in only one AS's attack surface. This indicates that most attack surface domains are unique to each victim AS.

To understand why many domains are AS-unique, we compared the attack surface domains of 3 home access network ASes. We classified the reasons for AS-unique domains into four categories: No data, No recent data, Lack periodicity, and Borderline. Figure 12 shows the breakdown analysis, with over 80% of these domains left out due to no leaked queries for at least a month before the delegation of the corresponding new gTLDs. This suggests that each victim AS should customize its own domain filtering list for effective defense.

#### B. Registration Status

**Finding 6:**
While some new gTLDs have fully registered their highly-vulnerable domains, the overall registration status is still in the early stage. As of 2015/09/26, the registration percentages for the 10 highly-vulnerable victim ASes range from 7% to 13%. On the TLD level, approximately 22% to 28% of new gTLDs with attack surfaces in a victim AS have at least one attack surface domain registered. For most victim ASes, around 10% have already had all of their attack surface domains registered, indicating that their attack windows are fully open. Once an HVD is registered, the management of the underlying zones is delegated from the new gTLD registries to the domain registrants, increasing the risk of exploitation.