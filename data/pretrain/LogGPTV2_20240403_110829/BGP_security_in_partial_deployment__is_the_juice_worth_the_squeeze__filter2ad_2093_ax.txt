Rvi .
Proof. As in proof of Lemma B.2, this lemma is proved
via induction on the FCR iteration. Consider the ﬁrst itera-
tion. Let vi be the AS chosen at this iteration and let vj be
a next-hop on a route in vi’s BPR set. Observe that it must
be that either vj = d or vj’s route was ﬁxed in FSCR (for
otherwise, vj would have been selected in FCR before vi).
Hence, Lemma B.5 (and the fact that d’s route is trivially
ﬁxed) implies that under S*BGP convergence each such vj’s
route will stabilize at some point and from that point on-
wards vi will repeatedly select Rvi (see similar argument in
Lemma B.2). Now, let us assume that for every AS chosen
in iterations 1, . . . , r the statement of the lemma holds. Let
vi be the AS chosen at iteration r + 1 of FCR. Consider vi’s
BPR set at that time and consider again an AS vj that is
vi’s next-hop on some route in vi’s BPR set. Notice that vj’s
route must either have been ﬁxed in FCR at some iteration
in {1, . . . , r} (if vj has a shorter perceivable customer route
than vi) or in FSCR (if vj has a secure customer route to
d). Hence, by the induction hypothesis, at some point in the
S*BGP convergence process, vj’s route converges to Rvj for
every such AS vj. As before, from that point in time onward
vi will repeatedly select Rvi .
Lemma B.7. Under S*BGP routing, the route of every
AS added to I in FPeeR is guaranteed to stabilize to the
route Rvi .
Proof. The proof is identical to that of Lemma B.3.
Proof. The proof is essentially the proof of Lemma B.4
(where now all routes must be secure).
Lemma B.9. Under S*BGP routing, the route of every
AS added to I in FPrvR is guaranteed to stabilize to the
route Rvi .
Proof. As in the proof of Lemma B.2, we prove this
lemma by induction on the number of FPrvR iterations.
Consider the ﬁrst iteration. Let vi be the AS chosen at this
iteration, let vj be a next-hop of vi on some route R in vi’s
BPR set, and let Q be the suﬃx of R at vj. Observe that
either Q is a customer/peer route, in which case vj’s route
was ﬁxed before F SP rvR or Q is a secure provider route, in
which case vj’s route was ﬁxed in F SP rvR. We can now use
Lemma B.8 and an argument similar to that in the proof of
Lemma B.2 to conclude that vi’s route will indeed converge
to Rvi at some point in the S*BGP routing process.
Now, let us assume that for every AS chosen in iterations
1, ..., r the statement of the lemma holds. Let vi be the AS
chosen at iteration r + 1 of FPrvR and consider vi’s BPR set
at this time. Let vj again be a next-hop of of vi on some
route R in vi’s BPR set, and let Q be the suﬃx of R at vj.
Observe that if Q is a provider route then vj’s route must
have been ﬁxed in either FSPrvR or in FPrvR at some point
in iterations {1, . . . , r}. If, however, Q is either a customer
route or a peer route vj’s route must have been ﬁxed in
either FCR or FPeeR. Hence, by the previous lemmas and
the induction hypothesis, under S*BGP convergence, every
such vj’s route will eventually converge to Rvj . Again, we
can conclude that vi’s route too will converge to Rvi .
B.5.3 Correctness of algorithm for security 1st.
The proof that our algorithm for the security 1st model
outputs the S*BGP routing outcome in this model follows
from the combination of the lemmas below (whose proofs is
almost identical to the proof for the other two models and
is therefore omitted). Again, let Rvi be the route from vi
induced by the algorithm’s computed next-hops.
Lemma B.10. Under S*BGP routing, the route of every
AS added to I in FSCR is guaranteed to stabilize to the route
Rvi .
Lemma B.11. Under S*BGP routing, the route of every
AS added to I in FSPeeR is guaranteed to stabilize to the
route Rvi .
Lemma B.12. Under S*BGP routing, the route of every
AS added to I in FSPrvR is guaranteed to stabilize to the
route Rvi .
Lemma B.13. Under S*BGP routing, the route of every
AS added to I in FCR is guaranteed to stabilize to the route
Rvi .
Lemma B.14. Under S*BGP routing, the route of every
AS added to I in FPeeR is guaranteed to stabilize to the
route Rvi .
Lemma B.8. Under S*BGP routing, the route of every
AS added to I in FSPrvR is guaranteed to stabilize to the
route Rvi .
Lemma B.15. Under S*BGP routing, the route of every
AS added to I in FPrvR is guaranteed to stabilize to the
route Rvi .
C. BOUNDS ON HAPPY ASES.