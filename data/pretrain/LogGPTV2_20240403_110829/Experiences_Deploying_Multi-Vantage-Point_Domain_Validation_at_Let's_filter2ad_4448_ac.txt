before multiVA was fully enforced. Upon the removal
of the list, we did not observe any issues or higher error
rates from customers that had previously been on the list.
• Full production deployment: Finally, Let’s Encrypt has
a complete deployment of multiVA in June 2020 and all
certiﬁcate requests are now validated by multiple VAs.
5This need for a conﬁgurable quorum policy that varies based on use case
is also supported by previous research on remote vantage point use in TOFU
applications [55].
6An early stage of multiVA was deployed in the staging environment for
testing in 2017 [37].
4316    30th USENIX Security Symposium
USENIX Association
·106
2
1
)
s
n
o
i
l
l
i
M
(
s
t
r
e
C
#
0
Feb2020
Mar2020
April2020
May2020
June2020
July2020
Aug2020
Sep2020
Oct2020
Nov2020
Dec2020
Jan2021
Figure 6: Let’s Encrypt certiﬁcates issued per day since
multiVA has been deployed with domain exception list. The
vertical line indicates when full enforcement was enabled.
Phased deployment minimizes the impact on the ongoing
operations of the CA, while allowing us to gradually improve
the performance and reliability of the system.
As shown in Figure 5, the multiVA deployment has
issued over half a billion certiﬁcates between the production
deployment in February 2020 and February 2021. Our work
thus demonstrates the feasibility of the multiVA approach at
Internet scale.
4 Real-world Deployment Evaluation
We obtained and analyzed log data for performance and
certiﬁcate validation from Let’s Encrypt’s production
deployment of multiVA. Our analysis demonstrates the
viability of multiVA at scale with respect to both performance
and benign failures.
4.1 Domain Validation Performance
Latency. In the k-n quorum validation scheme that Let’s
Encrypt adopted, we do not expect performance to degrade
signiﬁcantly because remote validations are performed in
parallel using the same timeout as the local validation by the
primary VAs. The only additional latency come from the RPC
round trip between the primary and remote VAs.
Total validation latency is bounded by the (n− k)th slowest
remote VAs in the quorum majority. For instance, when only
two of three remote VAs are required to succeed (i.e., with a 2-
3 quorum policy), one slow remote VA would not increase the
overall latency. When choosing a quorum threshold for remote
VAs, some consideration must be given to how many slow, or
entirely unresponsive, remote VAs the system can tolerate. If
the number of slow VAs makes up a quorum majority then
the system performance would degrade.
When the CA chooses remote VAs that have similar
performance characteristics as their primary VAs, there should
be little change in validation performance. This is seen in
Figure 7: Let’s Encrypt validation latency in milliseconds,
with y-axis on log scale. Remote latency is the time it takes
to complete a validation request at the remote VA (once it is
sent with gRPC); local latency is the time taken to complete
the request at the primary VA; and total latency is the time
taken to complete the remote validation requests with the
gRPC overhead. Since total latency is comparable to the local
latency, the overhead for multiVA is minimal.
the performance data from the Let’s Encrypt deployment
between 2 June and 31 Aug 2020 (see Figure 7). In this
deployment we see that the remote VAs provide somewhat
better performance than the primary VA. This is likely due
to the fact that primary VAs are located in the data centers
of a colocated hosting provider, while the remote VAs are in
AWS that has richer peering relationships that provide more
performant routing paths. We also see that the RPC overhead
contributes minimally to the total latency. So, for the Let’s
Encrypt deployment, latency is typically determined by the
primary VA (as it would be in the absence of multiVA).
Bandwidth overhead. The multiVA RPC scheme does
introduce a small amount of trafﬁc for each validation request.
For an issuance rate of about 20 certiﬁcates per second, the
RPC trafﬁc amounts to around 0.5 Mbps per remote VA.
This allows for using a rather large number of remote VAs
before the trafﬁc overhead would come anywhere near the
saturation point for most network uplinks, which typically
have a minimum bandwidth of 100 Mbps.
Certiﬁcate issuance rate. Figure 6 shows the daily certiﬁcate
issuance rate for the Let’s Encrypt multiVA deployment.
The vertical orange line indicates when full enforcement of
multiVA without the domain exception list was enabled. We
can see that the multiVA deployment is able to handle the
load of the world’s largest CA and scales to millions of daily
certiﬁcates. The issuance rate also shows a stable trend over
several months, including after the removal of the domain
exception list and the transition to the full enforcement mode
(June 2020).
USENIX Association
30th USENIX Security Symposium    4317
10-1100101102103104105102030405075909599Latency (ms)PercentileRemoteLocal101102103104105x102030405075909599Latency (ms)PercentileTotalCategory %Diff
DNS
52.6
Connection
24.3
Unauthorized 21.1
Top 3 reasons
%Diff
18.6
Query Timeout
12.7
No Valid IP for [Dm]
9.8
Network Error
22.2
Conn Timeout
0.78
Fail Get Validation Data
0.59
Conn Reset
Invalid Response from [URL]
18.5
Incorrect TXT Record for [Dm] 1.45
0.8
No TXT Record for [Dm]
2.0
—
—
ServerInternal 2.0 RPC Failed
Total
100
Table 8: Differentials by reasons for validation failure. We
show the top three errors (as reported in the server logs) for a
given type of differentials.
4.2 Benign Failure Rate
In this section, we study the impact of multiVA on benign
failures, i.e., the domain validation failures that are caused by
uncontrollable external factors,
Certiﬁcate validation dataset. We obtained a certiﬁcate
validation dataset from Let’s Encrypt to analyze benign
failures. This dataset includes the information of 451 M
certiﬁcate validations collected from the primary VA (which
records the remote validation responses) of Let’s Encrypt
over a 20-day period (Sep 3-22, 2020), with detailed runtime
data on each validation, including the domain name (e.g.,
www.example.com) being validated, the challenge type in use
(HTTP-01, TLS-ALPN-01, or DNS-01), the ACME account
ID that initiated the domain validation, the reason for the
failure, and the validation result of each remote VA.
Benign failures caused by multiVA. The data from Let’s
Encrypt shows that the primary VAs have a validation failure
rate of more than 65% even in the absence of multiVA. This
high failure rate is due mainly to repeated failed requests for a
small portion of the domains. If the primary VA succeeds and
any remote VA fails (e.g., returning no/incorrect/inconsistent
responses), we say there is a domain validation differential or
differential for short. Only 1.2% of the validations caused
differentials (i.e., having one or more remote validation
failures) in the 20-day period. As we will see later in this
section, many of these validations containing differentials
still succeeded due to the quorum policy.
Causes of differentials. Let’s Encrypt has contacted certain
domain owners based on the ACME account information,
including hosting providers serving millions of customer
domains whose certiﬁcates have caused differentials, to
understand the potential causes. Some issues may cause
validation failures in both the primary and remote VAs (e.g.,
misconﬁguration of web servers). We only focus on those
issues speciﬁc to multiVA in this section.
Based on the certiﬁcate validation dataset, the causes of
differentials fall into four categories: DNS-related issues,
connection-related issues, HTTP unauthorized errors, and
server internal errors, as summarized in Table 8.
• DNS. For 52.6% of the differentials, the remote VAs failed
to resolve the validated domain names to IP addresses. Most
commonly we saw that the multiple authoritative DNS servers
responsible for a domain were not synchronized to serve
the same content, causing different VAs to receive different
answers. A domain owner cannot always determine the
synchronization state of their DNS zone globally (e.g., if the
DNS provider uses anycast routing and does not provide an
API to query the state of a zone across all DNS servers). Thus,
when the owner requests a domain name for a new website
around the same time as asking the CA for a certiﬁcate, the
VAs may perform validations before the DNS synchronization
has completed, and thus see a different DNS zone state from
what the ACME client sees.
•Connection. We ﬁnd that 24.3% of the differentials
were caused by connection-related issues (i.e., the HTTP
connection for validation gets blocked or dropped). We found
that one cause is overly sensitive DDoS mitigation. By its
nature multiVA generates a burst of trafﬁc from multiple
distinct sources—similar to a small-scale DDoS attack. If a
domain owner uses a web hosting or DNS hosting service that
employs DDoS mitigation tuned at a low threshold, multiVA
trafﬁc could be classiﬁed as a DDoS attack and dropped.
If the number of dropped requests exceeded our conﬁgured
threshold, our quorum policy would report a validation failure.
Similarly we found that some domain owners employed
ﬁrewall policies that block trafﬁc not sent by the Let’s Encrypt
data center’s IP address block. Thus, validation requests
from the remote VAs were blocked, affecting the quorum
and preventing domain issuance. Let’s Encrypt has never
published a list of source IP addresses for use in ﬁrewall
policies, to avoid constraining operational agility and the roll-
out of new features. Despite consistent advice from Let’s
Encrypt to prefer DNS-based challenges in environments
that require strict source IP address ﬁltering for inbound
HTTP/HTTPS, some domain owners have assembled their
own (incomplete) static lists of Let’s Encrypt IP addresses.
We also saw that increasing the number of validation
requests would increase domain validation failure rates for
some domains hosted on underprovisioned, low-end shared
hosting platforms. In these cases even making several
concurrent challenge requests could overwhelm the servers
responsible for replying to the requests. This would frequently
manifest as the ﬁrst one or two validation requests completing
successfully, with subsequent requests resulting in a timeout
or error page response.
• HTTP unauthorized. For about 20.9% of the differentials,
the remote VAs successfully communicated with the target
web/DNS server but did not receive the expected response
(e.g., the validation document had not been uploaded). One
4318    30th USENIX Security Symposium
USENIX Association
e
g
a
t
n
e
c
r
e
P
50
40
30
20
2020-09-21
2020-09-20
2020-09-19
2020-09-18
2020-09-17
2020-09-16
2020-09-15
2020-09-14
2020-09-13
2020-09-12
2020-09-11
2020-09-10
2020-09-09
2020-09-08
2020-09-07
2020-09-06
2020-09-05
2020-09-04
2020-09-03
2020-09-22
Figure 10: The fraction of the certiﬁcates that have been
rejected on 2020-09-03 but eventually got signed after retry
by the end of a given date. About 50% of the certiﬁcates
rejected on 2020-09-03 were signed by the end of 2020-09-
22.
the remote VAs have minor impact on the benign failure
rate. Most of the failures caused by the remote VAs can be
resolved by retrying or having domain owners whitelist the
IP addresses of remote VAs.
5 Evaluating the Let’s Encrypt MultiVA De-
ployment Against Real-World BGP Attacks