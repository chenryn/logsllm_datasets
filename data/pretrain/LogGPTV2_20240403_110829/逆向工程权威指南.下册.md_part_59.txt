edx,
edx,
eax, 2
[edx+ecx*4]=[Etx+ECx*4]=0xc98c938
crp
 EAX=1
BOV
eax,
[ebp+arg_8][EBP+10h]=0xcdfe554
1oe_2cE1288
BOV
[ebp+var_4], edi  EDI=0xc98c938
ecx,[eax]
}[EAX]=0..5
nOv
loc_2cB10F6:
: CODE xREE: _kqgvrow_+10A
cnp
_kqvrow_+1A9
loc_56c11c7
ecx, 5
: ECX=0..5
Ja
nov
edi, [ebp+arg_18]: [BP+20h]=0
nov
[ebp+var_14], edx : EDx=0xc98c938
nov
nov
[ebp+var_8], ebx : EBx=0
[ebp+var_C], esi : sSI=0xcdfe248
ebx, eax
:EAK=0xcdfe554
mov
loc_2CE110D: : C0DE x3EF: _kqvxou_+29E0086
,0x2ce11f6,0x2ce1236, 0x2ce127a
mov
edx, ds:off_628809C[ecx*4] : [Ecx*4+628809ch]- 0x2oe1116, 0x2oe11ac, 0x2ce11dV
inp
edx
EDx=0x2oe1116, 0x2oe11ac, 0x2ce11db, 0x2ce1116, 0x2ce1236, 
0x2ce127a
1oc_2CE1116: ; DATA xGEF:
-rdata:off_628B09C
push
offset aXKqvvsnBuffer : *xSkqvrsn buffer*
A0W
ecx,
[ebp+arg_C] : [E8P+14h]=0x8a172b4
xor
edx,
esi,
[ebp+var_14]=[88P14h]=0xc98c938
edx
push
AOW
push
edx
edx
EDK-0
push
50h
E0x=0
push
dvord ptr [e8i+10494h]: [8SI+10494h]=0xc98cd58
ecx
 BCx-0xla172b4
push
ca11
_kgha1f
2 tracing nested naximun leve1 (1) reached, skipping this /
+ CALI
esi, ds:_ixp_vsnnun ;[59771A8h]=0x61bc49e0
nov
[ebp+Dest],eax:EAx=0xce2ffb0
nov
[ebx+8], eax
[ebx+4]， eax
: EAX-0xce2ffb0
nov
:EAX=0xce2ffb0
noV
ed1,[esi]
[EST]=0xb200100
es1,
ds:_isp_vsnstr [59706D4h] =0x65852148, *- Production*
push
ebx,
es1
ed1
;EDI=0xb200100
JESI=0x65852148,
"- Production*
sht
8018
ebx,
18h
:EBK=0xb200100
mov
shr
ecx,
ed1
14h
: ECx-0xb200100
 EDI=0xb200100
and
ecx,
ecx,
:BCx-0xb2
nov
edx,
ed1
:EDI=0xb200100
shr
edx,
0Ch
d1
JEDK-0xb200100
Bov2x
edx,
 DL=0
s0/
cax,
ed1
EDI=0xb200100
shr
'xea
:EAX=0xb200100
and
and
edi,
eax,
0FFh
OFh
00T000103
1 EAX=0xb2001
Pusb
edi
[ebp+arg_18] :[EBP+20h]=0
: EDI=0
nov
ed1,
push
esx
ds:_inp_vsnbas : [5970608h] =0x65852100, *0racle Database 11g /
: EAX=1
nor
eax,
---
## Page 327
第81章Oracle RDBMS
803
 Enterprise Edition Release id.sd.id.td.td 1s*
push
edx
ecx
EDX=0
Puah
push
[ebp+arg_8]:[EBP+10h]-0xcdfe554
: EBX=0xb
m0V
ebx,
Release
Push
td.1d.1d.1d.1d 1s*
eax
: EAX=0x65852100, *0racle Database 11g Enterprise Edition 
sov
eax,
[ebp+Dest]:[EBP-10h]0xce2ffb0
Push
eax
ca11
ds1_
_inp_sprintf : opl=MsvcR80,dl1isprintf tracing nested maximun level (1) 
→ reached,
skipping this CALL
add
esp,38h
S0V
dvord ptr [ebx], 1
1oc_2C81192: = C00E XREF: _kqvrov_+FB
test
_kqvrow_+128
edi, edi
: EDI=0
 Jnz
_VInfreq_kqvrow
mov
es1,
[ebp+var_C][EBP-0ch]=0xcdfe248
mov
ed1,
[ebp+var_4]1[EBP-4]=0xc98c938
AOE
ebx,[ebp+var_8] [2BP-8]=0.
'xeo
ebx
1ea
AOE
*,Oracle Database 11g Enterpriae Edition Release 11.2.0.1.0 - Production*, "PL/SQL 
[+xeo] *xro
: [EAX+4]=0xce2ffb0, "NLSRTL Version 11.2.0.1,0 - Prodoctioe
 Belease 11.2.0.1.0 - Production*, *TNs for 32-bit windows: Version 11.2.0.1.0 - 2
↓ Production*
1oc_2CB11A8: ; CoDE XREF: _kqvrow_+29E00F6
M0V
pop
esp， ebp
retn
dga
JEAX=0xcdfe558
1oc_2CE11AC: / DATA XREF: -rdata10628B0A0
Release 11.2.0.1.0-Production*
moV
edx, [ebx+8]  [E8x+8]=0xce2ffrb0, *0racle Database 11g Enterprise Edition 
mov
dword ptr [ebx], 2
mov
[ebx+4]。 edx
 EDx=0xce2rfb0, *0racle Database 11g Enterprise Edition /
 Release 11.2.0.1.0 - Productiona
 Release 11.2.0.1.0 - Production*
push
edx
 EDx=0xoe2ffb0, *0racle Database 1lg Enterprise Edition 
 CALL
ca11
_kkxrsn
: tracing nested maxinum level (1) resched, skipping this 
pop
ecx
3oy
edx,
[ebx+4]
-[EBx+4]=0xce2ffb0, *FL/sQL Release 11.2.0.1.0 - Productioe*
MOV2X
ecx,
byte ptr [edx] = [epx]=0x50
test
short 1oc_2ce1192
1 ECX=0x50
nz
AOE
es1,
edx,
[ebp+rar_14]
AOE
[ebp+var_C]
eax,
ebx
ecx, [eax]
ebx,
1g"xe+dqa]
)np
1oc_2CE10F6
1oc_2CE110B:  DWTA XREF: -.rdata:0628B0A4
push
pu8h
50h
nov
edx, [ebx*8]
[ebx+4], edx
:[E8x+8]=0xce2ffb0, "PL/SQL Release 11.2.0.1,0 - Production*
push
nov
 EDX=0xce2ffb0, *PL/SQL Release 11.2.0.1.0 - Production*
ca11
edx
: EDX=xce2ffb0, *PL/SQL Release 11.2.0.1.0 - Product1on*
_1nxver
 tracing sested maxiaun leve1 (1) reached, skipping thi8 /
 CALL
add
nov
dvord ptr [ebx], 3
esp, 0ch
J=p
short 1oc_2c81192
---
## Page 328
804
逆向工程权威指南（下册）
loc_2CE11F61 : DATA XBEF: ,rdata:062880NB
mov
edx, [ebx+8]
[EBK+8]=(xce2ffb0
mov
[ebp+var_18], 50h
mov
[ebx+4], edx
: EDK=0xce2ffb0
Push
ca11
_npin11
0
 CALL
J traclng nested saximun leve] (1)reached, skipping this /
pop
test
eax, eax
ecx
1 EAX=0
)nz
A0W
ecx,
[ebp+var_14][EBP-14h]=0xc9Bc938
1ea
edx,
[ebp+var_18]: [E8-18b]=0x50
push
dord ptr [ebx+8][88x*8]0xce2ffb0
edx
: EDK=0xd76c93c
push
push
dvord ptx [ecx+13278h]=[Ecx+13278h]=0xacce190
ca11
_nrtssvrs
 tracing nested naximun level (1) reached, skipping this 2
↓ CALL
add
esp, 0Ch
1oc_2CE122B:  0DE X8EF: _kqvrov_+29E0118
soV
@vord ptr [ebx]。 4
jmp
1oe_2C81192
loc_2CE1236: 1 DATA XGEF: -rdata:0628B0NC
lea
edx,
[ebp+var_7C] J[EBP-7Ch]=1
push
push
edx
0
: SDK-0xd76c8d8
 11.2.0.1.0 - Production*
mOY
es1, [ebx+8]
1 [EBX+8]-0xce2rrb0, *TNs for 32-bit Windovs: Version /
[ebx+4], es1
: ESI=0xce2ffb0, "TNS for 32-bit Windows: Version 11.2.0.1.0 /
↓ - Production*
50%
ecx, 50h
nov
[ebp+var_18], ecx : ECX-0x50
push
push
ESI=0xce2ffb0, *TNs for 32bit Windous: Version 11.2.0.1.0 /
1 ECx=0x50
↓ = Production*
↓ CALL
ca11
_1xrers
 tracing neated naximun leve1 (1)reached, skipping this /
add
*sp, 10h
nov
edx, [ebp+var_18 : [ESP-18h]=0x50
nov
dvord ptr [ebx], 5
test
1oc_2081192
edx, edx
: EDX=0x50
Jnz
nov
["xe+dqa] *rsa
edx,
[ebp+var_14]
nov
nov
mov
ebx,
edx,
[e"aes+dq]
mov
1oc_2CE10F6
ecx, 5 
Jp
1oc_2Cg127A: 
DRTA XREF: -rdata:062830B0
mov
es1, [ebp+var_C]J [EBP-0Ch]=0xcdfe248
edx,
[ebp+var_14]: [E82-14h]=0xc98c938
mov
mov
A0B
ed1,
[ebp+var_4][EBP~4]=0xc98c938
ebx, [ebp+var_6] [EBP-8]=0
eax, (
ebx
: 88K-0xodfe554
mOv
1oc_2C81288: : C00g xREF: _kqvrow_+1F
AOW
eax, [eax+8]
 [EAX+8]=0xce2ffb0, "NLSRTL Version 11.2,0.1.0 - Production"
test
eax, e8x
: EAx=Dxce2ffb0, *NLSRTL Version 11.2.0.1.0 - Production*
j=
short loc_2c812A7
pusb
push
offset aXKqvvsnBuffer : *xSkqvsn buffer*
eax
: SAx=0xce2ffb0, *NLsRTL Version 11.2.0.1.0 - Production*
mor
eax, [ebp+arg_C] : [EBP+14h]=0x8a172b4
---
## Page 329
第81章Oracle RDBMS
805
push
edx
dvord ptr [edx+10494h]J[EDk+10494h]=0xc98cd5B
 EAX=0x8a172b4
ca11
gend
_kghfrf 
tracing nested naximun level (1) reached, skipping this /
 CALL
add
esp, 10h
1oe_2CE12A7: : CoDE XREF: _kqrrow_+1C1
xor
80V
esp, ebp
eaK, eax
potn
ebp
KAX=0
kqrrou_endp
不难看出，该函数从外部获取行号信息，然后按照下述顺序组装、返回字符串。
String 1
Opuuds fut saqeytx pqo uequs unuss nsuss Sus1
String 2
Calling lmxver().