preferably more).
Users of DNS-based load balancing or DDoS-prevention may re-
quire short TTLs: TTLs may be as short as 5 minutes, although 15
minutes may provide sufficient agility for many operators. Shorter
TTLs here help agility; they are an exception to our first recom-
mendation for longer TTLs.
Use A/AAAA and NS records: TTLs of A/AAAA records should
be equal (or optionally shorter) to the TTL for NS records for in-
bailiwick DNS servers (§4.2). Our reasoning is they will be treated
that way by many resolvers, so the configuration should reflect
what will happen in practice.
For out-of-bailiwick servers, A and NS records are usually cached
independently, so different TTLs, if desired, will be effective.
In either case, short A and AAAA records may be desired if
DDoS-mitigation services are an option.
Who is in control: Given that most resolvers are child-centric,
one can directly control used TTLs within the zone itself (§3). How-
ever, one should recognize that a fraction of resolvers will use TTLs
from glue records stored served by a zone’s parents, so operators
should either configure both in-zone and glue TTLs identically,
or recognize some users will use one or the other. (Unfortunately
EPP [23, 24], the standard protocol for domain registration, does
not support setting TTLs.)
We recommend that developers of resolver software move to child-
centric resolution, even if it means additional queries. DNSSEC veri-
fication requires evaluation of queries from the child zone, and it
seems preferable to favor the actual domain owner’s choice of TTL
over the parent zone operator. In the meantime, we recommend that
resolver developers document their resolver behavior as parent- or
child-centric, and if they trust or discard the additional section of
DNS responses (§4).
7 RELATED WORK
DNS performance and caching efficiency: Prior work has studied
client-side caching through recursive resolvers from several per-
spectives. First, Jung et al. [27], in 2002, carried out simulations
based on university traces to estimate the DNS cache hit rate given
TTL. They showed that longer TTLs improves caching, but TTLS
shorter than 1000 s were sufficient to reap most of the benefits. In
their subsequent study [26], they modeled DNS caches as a function
of TTL to explain their earlier results. Ager et al. [2] compare local
DNS resolvers against Google and OpenDNS public ones. While
they cover query response time, they do not cover its relation to
DNS records TTLs as we do.
Second, researchers at CWRU have explored client-side DNS [11,
48], showing how TTLs are used by clients in the wild, and that
short TTLs are generally honored. Other researchers examined
mobile clients, showing most TTLs are short [4]. Our work instead
focuses on provider-side configuration, to make sure providers get
the times they desire, and how those times influence response times
and query volume.
Third, several groups evaluated DNS performance at the root.
Danzig et al. showed that there was a significant number of misbe-
having resolvers [14]. Fomenkov et al. examined Root DNS latency
before anycast was widespread [16], and then Liu et al. reexamined
performance with anycast [31]. Thomas and Wessels showed how
complicated caching is as seen from the Roots DNS servers [51].
Finally, recently Moura et al. [36] evaluated caching hit rates
with datasets from production networks and experiments with
RIPE Atlas, finding cache hit rates of around 70% for TTLs ranging
from 1800–86400 s. While this prior work measured caching and
its effects, our work instead focuses on how TTLs set in different
places interact to create an effective TTL.
Resolver Centricity and Stickiness: Guðmunsson [18] previously
studied router stickiness, and both he and Qiao [42] studied resolver
centricity. We extend their prior studies to examine how centricity
and stickiness affects caching, and how they behave today.
TTL and DNS resilience: Pappas et al. proposed changes two
strategies to improve DNS resilience to DDoS with NS-record
caching [40]. They proposed refreshing TTLs in some circum-
stances, and renewing (pre-fetching before expiration) NS records
for popular domains.
In addition to considering caching efficiency, Moura et al. also
examined the relationship between TTLs in DNS and resilience
to DDoS attacks [36]. They simulated a series of scenarios with
various degrees and packet loss and showed that, together with
retries, caching is a key component of DNS resilience. They showed
that, to be most effective, TTLs must be longer than the DDoS
attack. They recommend long TTLs where possible, but refrain
from suggesting specific values.
Unlike these two papers, we focus on DNS under normal op-
eration. We examine how different records create ambiguity in
the effective TTL, and make recommendations for TTL values and
where they must be set.
Ripe Atlas: It is well known that the global distribution of RIPE
Atlas probes is uneven, skewed towards Europe [8, 9, 47]. Although
quantitative data analysis might be generally affected by this distri-
bution bias, our qualitative analysis, contributions and conclusions
do not depend on the geographical location of probes.
8 CONCLUSION
This paper examined DNS TTLs, showing that the effective DNS
TTL is often different from what is configured because TTLs appear
in multiple locations and resolvers make different choices in which
TTL they prefer. We use controlled experiments to demonstrate
how these factors interact, and that one must control TTL in both
parent and child zones. We showed that longer TTLs have important
performance benefits, since caching greatly reduces latency, even
more than anycast, as well as reducing traffic. Our scans of deployed
DNS show that operators today have little consensus on typical
TTLs. Initial discussions with selected operators suggest interest in
longer TTLs, and changes at Uruguay’s .uy, after our discussions,
result in much lower median latency to users, as did two other
ccTLDs. We list the issues operators should consider when selecting
TTLs, and suggest while those using DNS-based load-balancing or
DDoS-mitigation may require short TTLs (5 or 15 minutes), others
may benefit from longer TTLs (of a few hours).
ACKNOWLEDGMENTS
We thank Paul Ebersman, Warren Kumari, Stefan Ubbink, Marc
Groeneweg, Niek Willems, Jelte Jansen, for their comments on
113
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
G. C. M. Moura et al.
drafts of this paper. We also thank Sergio Ramirez (.uy) for his
responsiveness and cooperation in this research.
This work uses measurements from RIPE Atlas (https://atlas.ri
pe.net/), an open measurements platform operated by RIPE NCC.
Giovane C. M. Moura’s work on this project is part of the SAND
project (http://www.sand-project.nl), a research project between
SIDN Labs, the University of Twente, and NL Netlabs.
John Heidemann’s work is based in part on research sponsored by
the U.S. Department of Homeland Security Science and Technology
Directorate, Cyber Security Division (DHS S&T/CSD) via contract
number HSHQDC-17-R-B0004-TTA.02-0006-I, by the Air Force Re-
search Laboratory under agreement number FA8750-18-2-0280, by
the DHS S&T/CSD via contract number 70RSAT18CB0000014. John
Heidemann and Wes Hardaker’s work is partially supported by NSF
OAC-1739034, “CICI: RSARC: DDoS Defense In Depth for DNS”.
The U.S. Government is authorized to reproduce and distribute
reprints for Governmental purposes notwithstanding any copy-
right notation thereon.
Wes Hardaker’s work in this paper is partially supported by USC
as part of B-Root research activity.
REFERENCES
[1] J. Abley and K. Lindqvist. 2006. Operation of Anycast Services. RFC 4786. IETF.
http://tools.ietf.org/rfc/rfc4786.txt
[2] Bernhard Ager, Wolfgang Mühlbauer, Georgios Smaragdakis, and Steve Uhlig.
2010. Comparing DNS Resolvers in the Wild. In Proceedings of the 10th ACM
SIGCOMM Conference on Internet Measurement (IMC ’10). ACM, New York, NY,
USA, 15–21.
[3] Alexa. 2019. Alexa: Keyword Research, Competitive Analysis & Website Ranking.
https://www.alexa.com/
[4] Mario Almeida, Alessandro Finamore, Diego Perino, Narseo Vallina-Rodriguez,
and Matteo Varvello. 2017. Dissecting DNS Stakeholders in Mobile Networks.
In Proceedings of the 13th International Conference on Emerging Networking EX-
periments and Technologies (CoNEXT ’17). ACM, New York, NY, USA, 28–34.
https://doi.org/10.1145/3143361.3143375
[5] Amazon AWS. 2019. Route 53 pricing. https://aws.amazon.com/route53/pricing/.
[6] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose. 2005. Protocol Modifica-
tions for the DNS Security Extensions. RFC 4035. IETF. http://tools.ietf.org/rfc/rfc
4035.txt
[7] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose. 2005. Resource Records for
the DNS Security Extensions. RFC 4034. IETF. http://tools.ietf.org/rfc/rfc4034.txt
[8] Vaibhav Bajpai, Steffie Eravuchira, Jürgen Schönwälder, Robert Kisteleki, and
Emile Aben. 2017. Vantage Point Selection for IPv6 Measurements: Benefits
and Limitations of RIPE Atlas Tags. In IFIP/IEEE International Symposium on
Integrated Network Management (IM 2017). IFIP, Lisbon, Portugal.
[9] Vaibhav Bajpai, Steffie Jacob Eravuchira, and Jürgen Schönwälder. 2015. Lessons
Learned from using the RIPE Atlas Platform for Measurement Research. SIG-
COMM Comput. Commun. Rev. 45, 3 (July 2015), 35–42. http://www.sigcomm.or
g/sites/default/files/ccr/papers/2015/July/0000000-0000005.pdf
[10] Matt Calder, Ashley Flavel, Ethan Katz-Bassett, Ratul Mahajan, and Jitendra
Padhye. 2015. Analyzing the Performance of an Anycast CDN. In Proceedings of
the ACM Internet Measurement Conference. ACM, Tokyo, Japan, 531–537. https:
//doi.org/10.1145/2815675.2815717
[11] Thomas Callahan, Mark Allman, and Michael Rabinovich. 2013. On Modern DNS
Behavior and Properties. SIGCOMM Compututer Communnication Review 43, 3
(July 2013), 7–15. https://doi.org/10.1145/2500098.2500100
[12] Fangfei Chen, Ramesh K. Sitaraman, and Marcelo Torres. 2015. End-User Mapping:
Next Generation Request Routing for Content Delivery. In Proceedings of the
ACM SIGCOMM Conference. ACM, London, UK, 167–181. https://doi.org/10.
1145/2785956.2787500
[13] CZ-NIC. 2016. Cache prefers parent-side TTL to authoritative. https://github.c
om/CZ-NIC/knot-resolver/issues/34
[14] Peter B. Danzig, Katia Obraczka, and Anant Kumar. 1992. An Analysis of Wide-
Area Name Server Traffic: A study of the Domain Name System. In Proceedings
of the ACM SIGCOMM Conference. ACM, Baltimore, Mayrland, USA, 281–292.
https://doi.org/10.1145/144191.144301
[15] R. Elz and R. Bush. 1997. Clarifications to the DNS Specification. RFC 2181. IETF.
http://tools.ietf.org/rfc/rfc2181.txt
[16] Marina Fomenkov, k. c. claffy, Bradley Huffaker, and David Moore. 2001. Macro-
scopic Internet Topology and Performance Measurements From the DNS Root
114
[23] S. Hollenbeck. 2009. Extensible Provisioning Protocol (EPP). RFC 5730. IETF.
http://tools.ietf.org/rfc/rfc8499.txt
http://tools.ietf.org/rfc/rfc5730.txt
Name Servers. In Proceedings of the USENIX Large Installation Systems Adminis-
tration Conference. USENIX, San Diego, CA, USA, 221–230. http://www.caida.or
g/publications/papers/2001/Rssac2001a/rssac_lisa.pdf
[17] K. Fujiwara. 2017. Updating Resolver Algorithm. Internet Draft. https://tools.ie
tf.org/html/draft-fujiwara-dnsop-resolver-update-00
[18] Ólafur Guðmundsson. 2011. Looking at DNS traces: What do we know about
resolvers? https://archive.icann.org/en/meetings/siliconvalley2011/node/22001.
html.
[19] Shuai Hao and Haining Wang. 2017. Exploring Domain Name Based Features on
the Effectiveness of DNS Caching. SIGCOMM Comput. Commun. Rev. 47, 1 (Jan.
2017), 36–42. https://doi.org/10.1145/3041027.3041032
[20] Wes Hardaker. 2018. Analyzing and Mitigating Privacy with the DNS Root
Service. In Proceedings of the ISOC NDSS Workshop on DNS Privacy. The Internet
Society, San Diego, California, USA.
[21] Scott Hilton. 2016. Dyn Analysis Summary Of Friday October 21 Attack. Dyn blog
https://dyn.com/blog/dyn-analysis-summary-of-friday-october-21-attack/.
[22] P. Hoffman, A. Sullivan, and K. Fujiwara. 2018. DNS Terminology. RFC 8499. IETF.
[24] S. Hollenbeck. 2009. Extensible Provisioning Protocol (EPP) Domain Name Mapping.
RFC 5731. IETF. http://tools.ietf.org/rfc/rfc5731.txt
[25] ISC BIND. 2018. Chapter 6. BIND 9 Configuration Reference. https://ftp.isc.org/
www/bind/arm95/Bv9ARM.ch06.html.
[26] Jaeyeon Jung, Arthur W. Berger, and Hari Balakrishnan. 2003. Modeling TTL-
based Internet Caches. In Proceedings of the IEEE Infocom. IEEE, San Francisco,
CA, USA, 417–426. http://www.ieee-infocom.org/2003/papers/11_01.PDF
[27] Jaeyeon Jung, E. Sit, H. Balakrishnan, and R. Morris. 2002. DNS performance and
the effectiveness of caching. IEEE/ACM Transactions on Networking 10, 5 (Oct
2002), 589–603. https://doi.org/10.1109/TNET.2002.803905
[28] Brian Krebs. 2019. A Deep Dive on the Recent Widespread DNS Hijacking Attacks.
Krebs-on-Security blog at https://krebsonsecurity.com/2019/02/a-deep-dive-o
n-the-recent-widespread-dns-hijacking-attacks/. https://krebsonsecurity.com/
2019/02/a-deep-dive-on-the-recent-widespread-dns-hijacking-attacks/
[29] W. Kumari and P. Hoffman. 2015. Decreasing Access Time to Root Servers by
Running One on Loopback. RFC 7706. IETF. http://tools.ietf.org/rfc/rfc7706.txt
[30] D. Lawrence and W. Kumari. 2018. Serving Stale Data to Improve DNS Resiliency.
Internet Draft. https://tools.ietf.org/html/draft-ietf-dnsop-serve-stale-02
[31] Ziqian Liu, Bradley Huffaker, Marina Fomenkov, Nevil Brownlee, and kc claffy.
2007. Two Days in the Life of the DNS Anycast Root Servers. In Proceedings of the
Passive and Active Measurement Workshop. Springer-Verlag, Louvain-la-neuve,
Belgium, 125–134. https://www.caida.org/publications/papers/2007/dns_anycas
t/dns_anycast.pdf
[32] Majestic. 2019. Majestic Million. https://majestic.com/reports/majestic-million
[33] P.V. Mockapetris. 1987. Domain names - concepts and facilities. RFC 1034. IETF.
http://tools.ietf.org/rfc/rfc1034.txt
[34] P.V. Mockapetris. 1987. Domain names - implementation and specification. RFC
1035. IETF. http://tools.ietf.org/rfc/rfc1035.txt
[35] Giovane C. M. Moura, Ricardo de O. Schmidt, John Heidemann, Wouter B. de
Vries, Moritz Müller, Lan Wei, and Christian Hesselman. 2016. Anycast vs. DDoS:
Evaluating the November 2015 Root DNS Event. In Proceedings of the ACM
Internet Measurement Conference. ACM, Santa Monica, California, USA, 255–270.
https://doi.org/10.1145/2987443.2987446
[36] Giovane C. M. Moura, John Heidemann, Moritz Müller, Ricardo de O. Schmidt,
and Marco Davids. 2018. When the Dike Breaks: Dissecting DNS Defenses During
DDoS. In Proceedings of the ACM Internet Measurement Conference. Boston, MA,
USA, 8–21. https://doi.org/10.1145/3278532.3278534
[37] Moritz Müller, Giovane C. M. Moura, Ricardo de O. Schmidt, and John Heide-
mann. 2017. Recursives in the Wild: Engineering Authoritative DNS Servers.
In Proceedings of the ACM Internet Measurement Conference. ACM, London, UK,
489–495. https://doi.org/10.1145/3131365.3131366
[38] Neustar. 2019. DDoS Prevention & Protection FAQs. https://www.home.neustar
/resources/faqs/ddos-faqs.
[39] OpenDNS. 2019. Setup Guide: OpenDNS. https://www.opendns.com/setupguide/.
https://www.opendns.com/setupguide
[40] Vasileios Pappas, Dan Massey, and Lixia Zhang. 2007. Enhancing DNS Resilience
against Denial of Service Attacks. In Proceedings of the 37th International Con-
ference on Dependable Systems and Networks. IEEE, Edinburgh, UK, 450–459.
https://doi.org/10.1109/DSN.2007.42
[41] Nicole Perlroth. 2016. Hackers Used New Weapons to Disrupt Major Websites
Across U.S. New York Times (Oct. 22 2016), A1. http://www.nytimes.com/2016/
10/22/business/internet-problems-attack.html
[42] Jing Qiao. 2017. Resolver centricity experiment. https://blog.nzrs.net.nz/resolve
rs-centricity-detection/.
[43] RIPE NCC. 2019. RIPE Atlas Measurement IDs. https://atlas.ripe.net/measureme
nts/ID. ID is the experiment ID: uy-NS: 19544918, a.nic.uy-A: 19581585, google.co-
NS: 19927577, mapache-de-madrid.co-NS: 19584842, in-bailiwick: 20199814,
Cache Me If You Can
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
[51] Matthew Thomas and Duane Wessels. 2015. A study of caching behavior with
respect to root server TTLs. DNS-OARC. https://indico.dns-oarc.net/event/24/
contributions/374/
[52] Umbrella. 2019. Umbrella Popularity List. https://s3-us-west-1.amazonaws.co
m/umbrella-static/index.html
[53] Thomas Vissers, Wouter Joosen, and Nick Nikiforakis. 2015. Parking sensors:
Analyzing and detecting parked domains. In Proceedings of the 22nd Network and
Distributed System Security Symposium (NDSS 2015). Internet Society, 53–53.
[54] Lan Wei and John Heidemann. 2017. Does Anycast Hang Up On You?. In IEEE
Network Traffic Monitoring and Analysis Conference. IEEE, Dublin, Ireland, 9.
https://doi.org/10.23919/TMA.2017.8002905
[55] Maarten Wullink. 2016. ENTRADA: The Impact of a TTL Change at the TLD
Level. DNS-OARC. https://indico.dns-oarc.net/event/22/contributions/314/
[56] Maarten Wullink, Giovane CM Moura, and Cristian Hesselman. 2018. Dmap:
Automating Domain Name Ecosystem Measurements and Applications. In Pro-
ceedings of the IEEE Network Traffic Monitoring and Analysis Conference. IEEE,
Vienna, Austria, 1–8. https://doi.org/10.23919/TMA.2018.8506521
[57] Maarten Wullink, Giovane CM Moura, Moritz Müller, and Cristian Hesselman.
2016. ENTRADA: A high-performance network traffic data streaming warehouse.
In Network Operations and Management Symposium (NOMS), 2016 IEEE/IFIP. IEEE,
913–918.
out-of-bailiwick: 20181892, TTL60-u:19862830, TTL86400-u:19863763, TTL60-
s:19871393, TTL86400-s:19871498, TTL60-s-anycast:19875360, uy-NS2: 19925152,
zurrundeddu-offline: 22483308.
[44] RIPE NCC Staff. 2015. RIPE Atlas: A Global Internet Measurement Network.
Internet Protocol Journal (IPJ) 18, 3 (Sep 2015), 2–26.
[45] RIPE Network Coordination Centre. 2015. RIPE Atlas. https://atlas.ripe.net.
[46] Quirin Scheitle, Oliver Hohlfeld, Julien Gamba, Jonas Jelten, Torsten Zimmer-
mann, Stephen D. Strowes, and Narseo Vallina-Rodriguez. 2018. A Long Way to
the Top: Significance, Structure, and Stability of Internet Top Lists. In Proceedings
of the Internet Measurement Conference 2018 (IMC ’18). ACM, New York, NY, USA,
478–493. https://doi.org/10.1145/3278532.3278574
[47] Ricardo de O. Schmidt, John Heidemann, and Jan Harm Kuipers. 2017. Anycast
Latency: How Many Sites Are Enough?. In Proceedings of the Passive and Active
Measurement Workshop. Springer, Sydney, Australia, 188–200. http://www.isi.ed
u/%7ejohnh/PAPERS/Schmidt17a.html
[48] Kyle Schomp, Tom Callahan, Michael Rabinovich, and Mark Allman. 2013. On
measuring the client-side DNS infrastructure. In Proceedings of the 2015 ACM
Conference on Internet Measurement Conference. ACM, 77–90.
[49] SIDN Labs. 2019. .nl stats and data. http://stats.sidnlabs.nl.
[50] Steve Souders. 2008. High-Performance Web Sites. Commun. ACM 51, 12 (Dec.
2008), 36–41. https://doi.org/10.1145/1409360.1409374
115