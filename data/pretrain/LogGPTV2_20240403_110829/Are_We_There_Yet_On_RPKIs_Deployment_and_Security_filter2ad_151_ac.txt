be forwarded to AS 2 and then, after being matched to the
BGP path for 1.1.1/24 at AS 2, forwarded to the attacker.
This phenomenon results from an attack-induced inconsistency
between AS 3’s perceived path to IP addresses in 1.1/16 (in
the control plane) and AS 2’s actual forwarding path to IP
addresses in 1.1.1/24 (in the data plane).
B. Security Evaluation
We next quantify,
through extensive simulations on
empirically-derived datasets, the impact of collateral beneﬁt
and damage, as described above, on global routing security.
Simulation framework. Our simulations apply the BGP route-
computation method presented in [23], [24], [26] to the CAIDA
AS-connectivity graph from July 2016. Our results average
over 106 combinations of attacker and victim (i.e., the legit-
imate owner of IP preﬁx) ASes, both selected uniformly at
random from the set of all ASes, as in [23], [26].
from the set of x
p top ISPs (i.e., the ISPs with the highest
number of customer ASes). All other ASes do not enforce
ROV. The results presented are averaged values after repeating
the experiment 20 times for each possible number of adopters
x ∈ {0, 10, ..., 100}.
We ﬁnd that, on the one hand, when all of the top 100
ISPs enforce ROV, hijack success rates diminish rapidly (as
a function of the number of deploying ISPs). Speciﬁcally,
the success rate of preﬁx hijacks is below 10% when the
50 largest ISPs enforce ROV and below 5% when the 100
largest ISPs enforce ROV (see Figure 7a). For the subpreﬁx
hijack attack, the attacker’s success rate falls from almost
complete success to about 22% when the 100 top ISPs enforce
ROV (see Figure 7b). On the other hand, we ﬁnd that when
adoption rate is low (as it is today), the attacker’s success
rates diminish much more slowly. For example, the subpreﬁx
hijacker’s success rate remains as high as 90% even when 25%
of the 400 top ISPs perform ROV (i.e., for x = 100 adopters).
For preﬁx-hijacking, success rates are lower, but still high, e.g.,
about 40% even when 25% of the top 400 ISPs adopt.
Impact of collateral beneﬁt and damage. The results in
Figure 7 quantify the extent to which partial enforcement
of ROV at the core of the Internet can mitigate preﬁx and
subpreﬁx hijacks, for preﬁxes covered by ROAs. We consider
different probabilities of adoption p, and different numbers
of expected adopters x (between 0 to 100), chosen randomly
Beneﬁt from ROV adoption not at the core. We next quantify
the beneﬁt that an AS not at the core can derive from adopting
ROV. Our results in Figure 8 show the attacker’s success rate
in harming (disconnect or hijack) ASes that enforce ROV for
different rates of partial ROV adoption at the core of the
Internet. Our results show that enforcing ROV does not beneﬁt
6
00.10.20.30.40.50102030405060708090100Attacker’s Success RateExpected Deployment (top ISPs)1. ROV adoption prob. 12. ROV adoption prob. 0.753. ROV adoption prob. 0.504. ROV adoption prob. 0.2500.20.40.60.810102030405060708090100Attacker’s Success RateExpected Deployment (top ISPs)1. ROV adoption prob. 12. ROV adoption prob. 0.753. ROV adoption prob. 0.504. ROV adoption prob. 0.2500.10.20.30.40.50102030405060708090100Adopter Disconnection RateExpected Deployment (top ISPs)1. ROV adoption prob. 12. ROV adoption prob. 0.753. ROV adoption prob. 0.504. ROV adoption prob. 0.2500.20.40.60.810102030405060708090100Attacker’s Success RateExpected Deployment (top ISPs)1. ROV adoption prob. 12. ROV adoption prob. 0.753. ROV adoption prob. 0.504. ROV adoption prob. 0.25(a) Preﬁx hijack success rate
(b) Subpreﬁx hijack success rate
Fig. 9: Comparing the beneﬁt of RPKI under (1) today’s ROV deployment, and (2) when the top ISPs perform ROV
such an AS much over the beneﬁts gained by only deploying
at the core, especially against subpreﬁx-hijacking (observe the
similarities between Figure 7a and 8a for preﬁx hijack, and
Figure 7b and 8b for subpreﬁx hijacks). We conclude that the
beneﬁt that an AS not at the core derives from ROV adoption
at the core of the Internet is essentially invariant (on average)
to whether or not that AS adopts ROV itself. Put differently,
global routing security is primarily affected by the collateral
beneﬁt (and damage) from ROV enforcement at the core of
the Internet.
Today’s status. We explore the security beneﬁts provided by
today’s ROV enforcement at the Internet’s core. We compare
two cases: (1) ROV’s current deployment state, at the top
100 ISPs as presented in Section III-A, and (2) when all of
the top 100 ISPs enforce ROV. Figure 9 contrasts these two
scenarios (compare the green and red lines). We measure the
attacker’s success rate when performing preﬁx and subpreﬁx
hijacks for different ROV adoption probabilities of all other
ASes on the Internet, i.e., ASes that are not in the 100 largest
ISPs, and/or ASes that were classiﬁed in “unknown” ROV-
enforcement status in Section III-A. We observe that if all
top 100 ISPs enforce ROV, the security beneﬁts of RPKI are
dramatically improved. In contrast, under today’s enforcement
of ROV at the Internet’s core, preﬁx hijack attacks are likely
to succeed, and subpreﬁx hijacks would remain very effective
even if all other ASes on the Internet enforce ROV (about 60%
success rate, see Figure 9b).
Conclusion. Put together, all our simulation results give rise to
the following conclusion. Enforcement of ROV at the core of
the Internet, by the top ISPs, appears to be both necessary
and sufﬁcient for gaining substantial beneﬁts from RPKI.
Consequently, until a large fraction of these ISPs enforce ROV,
other ASes have limited incentive to issue ROAs for their
preﬁxes (since they will remain largely unprotected).
V.
INSECURE ROAS
We expose below a new vulnerability of RPKI that renders
about a third of IP preﬁxes covered by ROAs insecure from
trafﬁc hijacking attacks even if ROV is ubiquitously adopted.
We say that a ROA is loose, when not all subpreﬁxes of
the maximum length allowed by the ROA are advertised in
BGP, e.g., if the max-length is set to /24, but only a /20
subpreﬁx is advertised in BGP by the legitimate origin AS.
We found that almost 30% of the IP preﬁxes covered by
ROAs fall in this category. Indeed, our analysis reveals that
network administrators often specify very relaxed restrictions
on the maximum length. Speciﬁcally, over 85% of loose ROAs
allowed maximum length of /24 (for IPv4 preﬁxes) or /48
(for IPv6 preﬁxes), the most speciﬁc preﬁx lengths typically
accepted [21]. Our interactions with network administrators
reveal confusion regarding the max-length ﬁeld and the percep-
tion is that specifying high values provides ﬂexibility in future
changes to BGP advertisements, namely, enables advertising
more speciﬁc IP preﬁxes without revisiting the ROA. We
show, however, that IP preﬁxes covered by loose ROAs are
vulnerable to the following attack vector, which allows trafﬁc
hijacking even if all ASes on the Internet perform ROV.
Attacking IP preﬁxes in loose ROAs. Suppose that a certain
ROA speciﬁes that an IP preﬁx p may be advertised in BGP
only by the (legitimate) origin AS a and that AS a advertises
preﬁx p in BGP. Suppose further that
this ROA is loose
according to the above deﬁnition. Then,
the attacker may
advertise the BGP announcement 666 − a − ¯p, where 666
represents an AS controlled by the attacker and ¯p is a permitted
subpreﬁx of p. Observe that since ¯p is a subpreﬁx of p, all
trafﬁc destined for IP addresses in ¯p will be forwarded to the
attacker due to IP’s longest-preﬁx matching. Observe also that
this attack cannot be detected by ROV, as the attacker’s BGP
advertisement speciﬁes the legitimate origin, AS a. We point
out that this attack is a hybrid of two well-studied attacks:
subpreﬁx hijacking, e.g., the attacker advertising the route
666− ¯p, and the “next-hop attack”, i.e., the attacker advertises
the route 666 − a − p. The former is detectable by ROV but
guarantees that all trafﬁc from victims ﬂow to the attacker (as
IP lookup prioritizes more speciﬁc preﬁxes), whereas the latter
is undetectable by ROV but typically much less effective [16]
since the attacker’s success is a function of its location, the
BGP routing policies of others, etc. Through the exploitation
of loose ROAs and BGP path-manipulation, the attacker can
enjoy the best of both worlds: attract all trafﬁc to the victim
and going unnoticed by ROV.
Real-world example. Swisscom, a large Swiss ISP, issued a
ROA for the preﬁx 81.62.0.0/15, with origin AS 3303. Swiss-
7
00.10.20.30.40.500.10.20.30.40.50.60.70.80.91Attacker’s Success RateDeployment Probability of other ASes1. Today’s status2. Top ISPs perform ROV00.20.40.60.8100.10.20.30.40.50.60.70.80.91Attacker’s Success RateDeployment Probability of other ASes1. Today’s status2. Top ISPs perform ROVFig. 10: Swisscom issued a ROA authorizing up to /24 preﬁxes,
yet only announces two /16 subpreﬁxes
Fig. 12: BGP advertisement status according to RPKI
real-world example in Figure 11, identiﬁed by our empirical
analyses of ROAs and BGP advertisements. Orange (previ-
ously France Telecom), a large French ISP, issued a ROA
for IP preﬁx 194.2.0.0/15 specifying the origin AS number
as 3215 (its own AS number). Orange has several customer
ASes that advertise in BGP subpreﬁxes of 194.2.0.0/15 under
different AS numbers. E.g., Danone advertises the (sub)preﬁx
194.2.35.0/24 from its own AS, numbered 1272. Most of
Orange’s customers,
including Danone and Ubisoft shown
in the ﬁgure, did not issue a ROA. Consequently, the BGP
advertisement of these customers are viewed as invalid ac-
cording to RPKI (since they appear like subpreﬁx hijacks, see
discussion on the decision process in Section II-B). Thus, any
AS enforcing ROV will discard all BGP route-advertisements
to these destination IP preﬁxes. Not only that, Orange’s ROA
permits /24 advertisements, yet Orange and its customers
only advertise 23 of the 512 /24 subpreﬁxes in Orange’s
address space, rendering the rest vulnerable to our attack
from Section V. Other mistakes in ROAs include inadvertently
specifying the wrong AS number and advertising in BGP IP
preﬁxes that are more speciﬁc (longer) than the maximum
length speciﬁed in the ROA.
Badly issued ROAs render the BGP route-advertisements
of the covered IP preﬁxes “invalid” to ROV-enforcing ASes.
Thus, an ROV-enforcer may not be able to reach the IP preﬁxes
of the issuers of such “bad ROAs” or even the IP preﬁxes
of other organizations (as illustrated in the Orange example
above)5. Figure 12 presents the results of our measurement of
the status of ROAs available in the RPKI database (in July
2016), and the corresponding BGP advertisements observed
in Route Views (6.5% of IP preﬁxes advertised in BGP are
covered by ROAs). Beyond invalid IP preﬁxes, as described
above, the ﬁgure also shows the large fraction (almost 30%)
of valid but unprotected IP preﬁxes (due to loose ROAs,
as discussed in Section V). As evidenced by Figure 12, a
signiﬁcant number of IP preﬁxes covered by ROAs are invalid
(over 8%), matching the results in [34]. A few of these may
be actual preﬁx or subpreﬁx hijacking attacks, yet the majority
is likely a result of conﬁguration errors.
Our survey of network operators validates that being dis-
connected from legitimate destinations due to badly issued
Fig. 11: Orange (formally France Telecom) issued ROA inval-
idating customer announcements
com also advertises this preﬁx and its two /16 subpreﬁxes in
BGP. See illustration in Figure 10. However, Swisscom’s ROA
speciﬁes a max-length of 24, exposing it to the above attack.
E.g., in order to hijack all trafﬁc to the preﬁx 81.63.0.0/16, the
attacker can announce through BGP its two /17 subpreﬁxes
81.63.0.0/17 and 81.63.128.0/17 with AS-path 666-3303. To
mitigate the attack, Swisscom should simply change the max-
length in their ROA to 16.
VI. OBSTACLES TO DEPLOYMENT
We investigate the root causes for RPKI and ROV’s low
adoption. Our measurements in Section III revealed that only
few of the top ISPs enforce ROV, i.e., ﬁlter routes according to
the ROAs in RPKI. Thus, not surprisingly, RPKI suffers from a
circular dependency between issuing ROAs and adopting ROV:
ASes do not gain sufﬁcient beneﬁts from adopting ROV so
long as so many IP preﬁxes are unprotected by ROAs, yet
there is little incentive to issue a ROA so long as so few ASes
enforce ROV. We turn our attention to two other main factors
contributing to non-deployment: unreliability of RPKI due
to badly issued ROAs, and inter-organization dependencies.
Unlike past studies of RPKI [19], [33], [34], our analysis
relies on a breakdown of ROAs by organizations, thus yielding
important new insights into RPKI and ROV’s deployability.
A. Mistakes in ROAs
Operators should specify in ROAs the IP preﬁxes adver-
tised by their organizations through 3 ﬁelds: the AS number,
IP preﬁx, and maximum length (see Section II) [39]. Unfortu-
nately, mistakes commonly occur when issuing ROAs [34]. To
illustrate the dire implications of such mistakes consider the
5Note that 38% of the invalid announcements are for a subpreﬁx of some
valid announcement by the same origin AS. In this case, trafﬁc from the ROV-
enforcer to addresses in the subpreﬁx will reach the origin AS, although the
ROV-enforcer discarded the invalid subpreﬁx advertisement. However, ROV-
enforcer will not publish the invalid subpreﬁx announcement and hence may
‘lose’ trafﬁc to this subpreﬁx from multi-home customers.
8
Fig. 13: Survey. What are your main concerns regarding
executing RPKI-based origin authentication in your network?
Fig. 15: Level 3 Communications did not obtain an RC. As a
result, all its customers that own subpreﬁxes cannot obtain an
RC.
Fig. 14: Organizations responsible for bad ROAs
Fig. 16: Upward dependency histogram
ROAs is a major concern. Indeed, fear from being disconnected
from other ASes (due to invalid ROAs) was the most common
reason speciﬁed for not performing ROV (over 30%), even
more common than no demand from customers and insufﬁcient
value; see Figure 13.
We aim to gain deeper insights into the human error factor
in RPKI deployment in practice. To this end, we associate
badly issued ROAs and the corresponding BGP advertisements
with organizations. (This turns out to be nontrivial; we explain
how it is done in Appendix B.)
We attribute each IP preﬁx rendered invalid by ROV to the
organization responsible for that error. Our analysis reveals