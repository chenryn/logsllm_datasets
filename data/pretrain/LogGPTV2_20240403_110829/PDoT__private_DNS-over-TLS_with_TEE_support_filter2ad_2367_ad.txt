### 优化后的文本

#### 域名查询与ANS分析
我们从Majestic Million域名列表[26]中选取了多个域名，并收集了可能提供这些域名解析服务的权威名称服务器（ANS）的相关信息。通过收集潜在ANS的数据，我们可以将域名映射到每个ANS上，从而估算每个ANS持有的记录数量。根据《互联网测量活动指南》[8]，我们在查询过程中限制了查询速率，以避免对任何服务器造成过大的负载。

如图7所示，只有5.7%的查询域名由非隐私保护的ANS提供服务，即那些仅持有一个记录的ANS。例如，tinyurl.com、bing.com、nginx.org、news.bbc.co.uk和cloudflare.com等域名就由这类ANS提供服务。另一方面，90%的查询是由隐私保护的ANS提供的，其中65.7%的查询由持有超过100条记录的ANS提供。

这些结果仍然是近似值。由于我们没有Majestic Million列表之外的域名数据，因此无法确定这些域名是否也由隐私保护的ANS提供服务。我们假设绝大多数ANS是隐私保护的，因为分摊ANS运行成本到多个域名上更为经济。然而，对于Majestic Million中的域名，我们可以肯定地说，这些结果是隐私水平的严格下限，因为这些ANS也可能为列表之外的其他域名提供服务。要得到更准确的估计，可以通过分析所有（或至少大部分）ANS的区域文件来实现。但实际上，几乎所有ANS都禁用了下载区域文件的接口，因为这可能会被用于发起DoS攻击。因此，这种类型的分析需要一个拥有特权访问权限的组织来进行。

4. 尽管tinyurl.com是一个URL缩短服务，但由于攻击者无法得知哪个短URL被查询，因此它实际上仍然是隐私保护的。

#### 相关工作
许多先前的工作旨在保护DNS查询的隐私[7, 15, 16, 25, 33, 37, 38]。例如，Lu等人[25]提出了一种使用分布式哈希表、不同命名方案和计算私有信息检索方法的隐私保护DNS。Federrath等人[16]引入了一个专门的DNS匿名服务，通过广播顶级域名并使用低延迟混合网络请求剩余域名来保护DNS查询。这些方案都假设所有参与方不会恶意行事。

在互联网标准社区中，也有一些关注DNS安全性和隐私的活动。DNS安全扩展（DNSSEC）[3]通过公钥加密提供了数据来源认证和完整性保护，但不提供隐私保护。Bortzmeyer[5]提出了一个方案。尽管不是互联网标准，但也有一些协议被提出，用于加密客户端与递归解析器（RecRes）之间的DNS数据包（DNSCrypt [30]）以及递归解析器与名称服务器之间的数据包（DNSCurve [1]）。此外，最初的DNS-over-TLS论文已被转化为一份互联网标准草案[19]。所有这些方法都假设递归解析器运营商是可信的，并且不会试图从DNS查询中获取任何信息。

此外，还有一些研究通过TEE建立信任，以保护网络功能的机密性和完整性。特别是，SGX已被用于保护网络功能，尤其是中间盒。例如，Endbox[17]旨在将中间盒分布到客户端边缘：客户端通过VPN连接以确保其流量的机密性，同时保持可维护性。LightBox[14]是另一种在隔离区运行的中间盒，其目标是在保持适当性能的同时，保护客户端流量不受第三方中间盒服务提供商的影响。最后，ShieldBox[35]旨在保护流经不可信商品服务器的机密网络流量，并提供易于部署的通用接口。这些努力主要集中在保护网络中的机密数据，而不是针对DNS查询。

#### 结论与未来工作
本文提出了PDoT，这是一种在TEE内运行的新型DNS递归解析器设计，即使面对恶意的递归解析器运营商也能保护DNS查询的隐私。在查询吞吐量方面，我们的未优化概念验证实现与最先进的DNS-over-TLS递归解析器Unbound相匹配，同时由于使用了TEE而增加了可接受的延迟。为了量化通过流量分析导致的隐私泄露潜力，我们进行了一项互联网测量研究，结果显示，在前1,000,000个域名中，94.7%可以由至少服务于两个不同域名的隐私保护ANS提供服务，而65.7%可以由服务于100多个域名的ANS提供服务。作为未来的工作，我们计划将Unbound递归解析器移植到Intel SGX，并与PDoT进行性能比较，同时探索使用缓存提高PDoT性能的方法，同时保持客户端隐私。

#### 缓存与时间攻击
在递归解析器中引入缓存会使对手能够发动时间攻击，并帮助猜测用户查询的域名。我们考虑了两种类型的时间攻击：
- **查询与响应之间的时间测量**：这是最简单的攻击方式，对手监视客户端与递归解析器之间的网络，并记录递归解析器响应客户端所需的时间。如果响应时间较短（与其他查询相比），则很可能来自缓存。这种攻击可以由第3.1节中描述的两种对手类型发起。一种明显的对策是人为延迟响应，使其与名称服务器响应的延迟相匹配。
- **客户端与递归解析器请求的相关性**：为了应对上述对策，对手可能会尝试将客户端发送给递归解析器的DNS请求与递归解析器发送给名称服务器的DNS请求相关联，例如通过记录发送数据包的时间。如果成功，对手可以区分涉及联系名称服务器的请求和来自缓存的请求。这种攻击也可以由恶意递归解析器或网络嗅探器发起。一种对策是始终向一个名称服务器发送查询（尽管不一定是最正确的名称服务器）。这会降低缓存的好处，但仍减少了名称服务器查询的数量，因为实际答案可能需要多次名称服务器查询。另一种方法是批量随机化发送给名称服务器的请求顺序，创建一种DNS混合网络。

对于这两种类型的时间攻击，信息泄露的程度取决于对手是被动还是主动。被动对手最多只能猜测域名。如果缓存策略是最近最少使用（MRU），那么域名必须是流行域名之一。主动对手可以生成大量域名的DNS查询，并记录导致缓存命中的域名，从而提高推断用户查询目标的可能性。

#### 致谢
感谢Geonhee Cho为我们提供了第7.1节中关于隐私保护ANS分析的初始数据收集。我们也非常感谢论文的指导人Roberto Perdisci以及ACSAC’19的匿名评审者们的宝贵意见。第一作者和第三作者部分得到了NSF奖编号1840197的支持，该奖项名为“CICI: SSC: Horizon: 安全的大规模科学云计算”。第一作者还得到了Nakajima基金会的支持。第二作者获得了美英富布赖特网络安全学者奖的支持。

#### 参考文献
[略]

希望以上优化后的文本更加清晰、连贯和专业。如果有任何进一步的修改需求，请随时告知。