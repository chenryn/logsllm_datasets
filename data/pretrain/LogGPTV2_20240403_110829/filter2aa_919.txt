一次诡异的弱口令
0x01 背景
某次客户授权渗透碰到的问题，比较有趣，分享一下。
项目开始没多久，一起的小姐妹说存在弱口令admin/admin，让我试试。然而在我尝试登录的时候，返
回消息为“密码错误，失败次数为1”。这没法登录，密码不对阿，还有账号锁定机制。
继续测试，发现登录页面验证码在使用后未作失效处理，正常操作，爆破一下。
burp的结果显示四五个账号存在弱口令，手动验证下，只有两个账号使用密码正常登录了，其他账号都
返回密码错误的消息。
弱口令登录不能复现，非常诡异，讲给客户估计会被客户加开发一起喷死，于是我就请教了一下我大
哥。
大哥如此清新脱俗的解释，一直喊666的我，灵魂在吹牛逼的过程中莫然得到了一丝的愉悦。然而作为
打工人，想了想午饭的馒头还没有着落，只能埋头继续肝！
0x01 剥茧抽丝
shell手法，平平无奇，标准操作过了下WAF的内容检测，此处不做赘述，直奔登录模块拿到对应class文
件。
class文件导入jd-gui，好了，可以下打死开发了。
bingo，破案！
浏览器启动，admin账户到位，输入若干次口令直到账号锁定，等待一段时间，待锁定时间过后输入
admin、任意密码成功登陆了系统。
0x02 修复方式
显然，开发小哥写的代码太绕了，把自己绕进去了。
针对上述的写法，在state为2后，锁定一段时间。再次登录账户解锁之后，还需要再校验密码，而不是
直接返回true。
0x03 总结
账户锁定的情况也可以多试几次，既然是账号锁定功能，时间也应该是测试参数。正如老话说，时间是
最好的解药。