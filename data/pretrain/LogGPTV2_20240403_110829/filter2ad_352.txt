title:Detection, Alert and Response to Malicious Behavior in Mobile Devices:
Knowledge-Based Approach
author:Asaf Shabtai and
Uri Kanonov and
Yuval Elovici
Detection, Alert and Response to Malicious Behavior in 
Mobile Devices: Knowledge-Based Approach 
Asaf Shabtai, Uri Kanonov, and Yuval Elovici 
Deutsche Telekom Laboratories at Ben-Gurion University and 
Department of Information Systems Engineering, Ben-Gurion University, Israel 
{shabtaia,kanonov,elovici}@bgu.ac.il 
Abstract. In this research, we evaluate a knowledge-based approach for detect-
ing instances of known classes of mobile devices malware based on their tem-
poral  behavior.  The  framework  relies  on  lightweight  agent  that  continuously 
monitors  time-stamped  security  data  within  the  mobile  device  and  then  
processes the data using a light version of the Knowledge-Based Temporal Ab-
straction  (KBTA)  methodology.  The  new  approach  was  applied  for  detecting 
malware on Google Android powered-devices. Evaluation results demonstrated 
the effectiveness of the proposed approach. 
Keywords: KBTA, Host-Based Intrusion Detection Systems, Mobile Devices. 
Smartphones have evolved from simple mobile phones into sophisticated yet compact 
minicomputers. Mobile devices become susceptible to various new threats such as vi-
ruses, Trojans and worms, all of which are well-known from the desktop computers. In 
this research we examine the applicability of detecting malware instances using a light 
version  of  the  KBTA  method  [1]  that  can  be  activated  on  resource-limited  devices. 
Using  KBTA,  continuously  measured  data  (e.g.,  number  of  running  processes)  and 
events (e.g., software installation) are integrated with a temporal-abstraction knowledge-
base;  i.e.,  a  security  ontology  for  abstracting  higher-level,  meaningful  concepts  and 
patterns  from  raw,  time-oriented  security  data,  also  known  as  temporal  abstractions 
(Fig.  1).  Automatically-generated  temporal  abstractions  can  be  monitored  to  detect 
suspicious temporal patterns and to invoke the proper response. These patterns are com-
patible with a set of predefined classes of malware as defined by a security expert em-
ploying a set of time and value constraints. Derived patterns are also context-aware, thus 
the same data may be interpreted differently within different contexts. 
SD Card Information Leakage
Post Access to SD Card.Context
Sent Packets.Trend=[Increasing]
Access to SD Card.Event
Sent 
Packets 
((cid:83))
Fig. 1. The KBTA process 
Fig. 2. SD-Card information leakage pattern 
T1
T2
T3
T5
T6
T7
T4
Time
E. Kirda, S. Jha, and D. Balzarotti (Eds.): RAID 2009, LNCS 5758, pp. 357–358, 2009. 
© Springer-Verlag Berlin Heidelberg 2009 
358 
A. Shabtai, U. Kanonov, and Y. Elovici 
For example, the “SD-card Information Leakage” pattern is derived when an “Access 
to  SD-card”  event  is  detected  and  generates  the  “Post  Access  to  SD-card”  Context. 
Then,  within  the  “Post  Access  to  SD-card”  context,  an  increasing  number  of  “Sent 
Packets” (Trend) is derived which may be a result of a malicious software sending the 
content  stored  on  the  SD-card  to  a  remote  server  (Fig.  2).  Following  is  the  pattern 
definition in CAPSUL language [2]: 
Linear Pattern: SD-card Information Leakage pattern 
Context: Post Access to SD-Card 
Linear Components: 
Output Value of Pattern: 
Parameter Component: 
Sent Packets Trend 
Abstracted From: 
Local Constraints: 
Sent Packets 
value = INCREASING 
duration > 3sec 
Value Function: value = SD-Card Information Leakage 
For our evaluation, we used a host-based intrusion detection system (HIDS) that was 
developed for Google Android powered-devices and  which monitors  more than 100 
raw parameters and events, including some that were used to define basic abstractions 
and complex patterns. The HIDS employs a light-weight Incremental KBTA detector. 
A smartphone security ontology for detecting the malware was defined. The ontology 
includes five different temporal patterns of potentially malicious behavior: Denial of 
Service (overloading the system CPU and memory), abuse of SMS messages, abuse 
of the device camera, injecting malware via USB connection and theft of confidential 
information  stored  on  the  SD-Card.  We  have  developed  five  different  smartphone 
malware  and  later  deliberately  infected  a  G1  Android  device.  Evaluation  results 
showed the ability to detect the malware while reducing false alarms using context-
based interpretations. When an alert is detected, in addition to displaying a notifica-
tion,  the  Android  HIDS  is  capable  of  employing  effective  countermeasures  tailored 
for the alert (e.g., all network transports can be disconnected when information leak-
age is detected or the malicious application can be terminated). 
The HIDS can quickly be adapted to new malware classes by simply modifying the 
knowledge-base.  In  addition,  KBTA  defines  patterns  in  a  fuzzy  fashion  as  a  set  of 
constraints, rather than as a hard-coded signature for each and every known malware. 
Consequently, it facilitates detection of instances of malware even when they have not 
been  encountered  before.  The  system  can  also  help  in  integrating  alerts  from  other 
sensors  as  primitive  parameters.  Meshing  alerts  from  multiple  sensors  reduces  the 
amounts of false alarms and isolates solid and reliable alerts, such that persist  for a 
substantial time interval. 
References 
1.  Shabtai,  A.,  Fledel,  Y.,  Elovici,  Y.,  Shahar,  Y.:  Using  the  KBTA  Method  for  Inferring 
Computer and Network Security Alerts from Time-stamped, Raw System Metrics. Journal 
in Computer Virology (2009), doi:10.1007/s11416-009-0125-5 
2.  Chakravarty, S., Shahar, Y.: CAPSUL -  A  constraint-based specification of repeating pat-
terns in time-oriented data. Annals of Mathematics and AI 30(1-4), 3–22 (2000)