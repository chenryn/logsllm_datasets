### IMC '17, November 1–3, 2017, London, United Kingdom
**Authors:** Amann, Gasser, Scheitle, Brent, Carle, Holz

**Institutions:**
- TUM (Technical University of Munich)
- USyd (University of Sydney)

### Table 1: Overview of DNS Resolutions and Active Scans
**Conducted from April 11 through April 16, 2017.**

| Metric | IPv4 (TUM) | IPv4 (USyd) | IPv6 (TUM) |
|--------|------------|-------------|------------|
| Total Input Domains | 192.9M | 152.9M | 8.9M |
| Domains with ≥ 1 RR1 | 153.5M | 153.5M | 8.8M |
| IP Addresses | 3.2M | 4.0M | - |
| TCP443 SYN-ACKs | 79.2M | 80.4M | - |
| Successful TLS SNI2 | 58.0M | 55.7M | - |
| HTTP Response 200 SNIs | 28.1M | 28.4M | - |

**Notes:**
1. Domains that serve one or more Resource Records of A or AAAA type.
2. Tuples with successful TLS SNI connections.

### Table 2: Overview of Passive Monitoring Data
**UC Berkeley is not filtered for port 443. Many autogenerated certificates, such as for WebRTC, drive certificate count for non-443.**

| Location | Time | TLS Connections | Certificates | Valid Certificates |
|----------|------|-----------------|--------------|--------------------|
| Berkeley | 2.4.–2.5. | 1.5M | 366.2k | 364.2k |
| Berkeley | 2.4.–2.5. | 1.5M | 366.2k | 364.2k |
| Berkeley | 2.6G | 2.5G | 729.1k | 729.1k |
| Berkeley | 286.7M | 178.7k | 196.2M | 115.8k |
| Munich | 12.5.–16.5. | - | - | - |
| Sydney | 12.5.–16.5. | - | - | - |

### 4.2 Passive Monitoring
Our passive measurements use two data sources:
1. To measure the current use of Certificate Transparency in the Internet, we passively monitor the Internet uplinks of the University of California at Berkeley (UCB) for several weeks. We also validate our results by monitoring the Internet uplinks at the University of Sydney (Australia) and the Technical University of Munich (Germany), about two weeks after the first monitoring run.
2. For our TLS version evolution study, we use data from the ICSI SSL Notary, which contains connection-level information from select research institutions and universities starting in 2012.

We use the Bro Network Security Monitor for our passive data analysis. For this work, we extend Bro to support TLS version 1.3, improve the OCSP support, and implement support for parsing and live-validation of CT information from certificates, TLS extensions, and OCSP replies. The code is merged into Bro and will be part of Bro 2.6.

In all environments, we only analyze outgoing connections to prevent bias from our internal server population. Table 2 shows details on the number of TLS handshakes and unique hosts seen at our three passive monitoring vantage points.

**University of Sydney:**
- 10GE Internet uplink.
- Port 443 traffic is mirrored to a 64-core Linux machine using PF_Ring for traffic distribution (4 AMD Opteron 6276 2.6GHz CPUs, 64GB RAM, Ubuntu 14.04.5).
- Only traffic from the Internet to the University network is mirrored to the analysis machine.
- Bro's TLS analyzer correctly parses one-sided TLS traffic.

**Technical University of Munich:**
- Monitors the Munich Scientific Network’s 2x10GE Internet uplink.
- Port 443 traffic is mirrored to a 24-core machine using PF_Ring (2 Intel Xeon E5-2630v2 2.6GHz, 256GB RAM, SLES12).
- Packet loss occurs during peak times but does not significantly impact our analysis.

**UCB:**
- 10GE Internet uplink.
- Traffic is split up to 28 independent machines, each with 4 Intel Xeon 5430 CPUs at 2.66GHz and 12GB of RAM (FreeBSD 11.0).
- Traffic is distributed to 2 processes per machine using netmap and lb.
- Traffic is not filtered for port 443.

### 4.3 Ethical Considerations
For active scans, we minimize interference by following best scanning practices, maintaining a blacklist, and using dedicated servers with informative rDNS names, websites, and abuse contacts. We assess whether data collection can harm individuals or reveal private information. Our passive data collection was cleared by the responsible parties at each contributing institution, including those contributing data to the ICSI SSL Notary. Note that our passive data collection specifically excludes or anonymizes sensitive information, such as client IP addresses.

### 5. Certificate Transparency
To evaluate the use of Certificate Transparency, we extract and validate SCTs from both active scans and passive observations using our extended version of Bro (see Section 4). SCTs can be retrieved via three different ways:
1. TLS extension
2. OCSP stapling
3. Embedded in an X.509 certificate

SCTs received via the TLS extension or OCSP stapling are directly validated using the server certificate and the log public key. For SCTs embedded in an X.509 certificate, the reconstructed precertificate is used in place of the end-entity certificate, as specified in [44] (see Section 2). The verification step also requires information from the CA certificate issuing the end host certificate.

We determine the issuer CA certificate needed for SCT validation in a multi-step process. First, validation of the presented chain is attempted against Mozilla’s root store. If this step fails, SCT validation is attempted using each certificate present in the connection.

### 5.1 Measurement Results
Table 3 gives an overview of the CT data obtained in our active scans. We count a domain as supporting CT if at least one connection to one of its IP addresses transported SCTs.

| Metric | IPv4 (Sydney) | IPv4 (Munich) | IPv6 (Munich) |
|--------|---------------|---------------|---------------|
| Total Connections | 6.8M | 6.8M | 357k |
| Connections with SCT | 7.0M | 7.0M | 344k |
| SCT in X.509 | 6.9M | 6.9M | 12.9k |
| SCT in TLS | 27.8k | 27.2k | 12.9k |
| SCT in OCSP | 191 | 188 | 3 |
| Operator Diversity1 | 594.98k | 835.3k | 800.5k |
| Certificates with SCT | 194.2k | 834.5k | 868.5k |
| Certificates without SCT | 193.9k | 759 | 867.6k |
| Valid EV Certs with SCT | 62.9k | 62.5k | 631 |
| Valid EV Certs without SCT | 63.6k | 65.6k | 885 |
| IPs with SCT | 6.8M | 6.7M | 349k |
| IPs with X.509 SCT | 27.6k | 27.6k | 12.9k |
| IPs with TLS SCT | 180 | 180 | 3 |
| IPs with OCSP SCT | 49 | 43 | 3 |
| Total SNIs | 11.69M | 10.62M | 10.62M |
| SNIs with SCT | 6.8M | 6.7M | 349k |
| SNIs with X.509 SCT | 27.6k | 27.6k | 12.9k |
| SNIs with TLS SCT | 180 | 180 | 3 |
| SNIs with OCSP SCT | 49 | 43 | 3 |

**Note:**
1. Certificates logged in at least one Google and one non-Google operated log.

### Figure 1: Embedded SCTs on Domains
- Blue bar represents domains using SCT via TLS extensions that did not already serve SCT via X.509.

### Observation Period
- **Total Connections:** 286.7M (Berkeley), 196.2M (Munich), 2.6G (Berkeley)
- **Connections with SCT:** 778.7M (Berkeley), 72.7M (Munich), 57.5M (Sydney)
- **SCT in Cert:** 43.9M (Berkeley), 43.9M (Munich), 43.9M (Sydney)

This structured and detailed approach provides a clear and comprehensive overview of the data and methodologies used in the study.