higher efﬁciency in locating malware, our main focus will be
obtaining a high toxicity.
A. Effectiveness of EVILSEED
EVILSEED is meant to complement a traditional crawler-
based approach, so we ran our system in parallel with a
traditional crawler. In this setting, both the crawler and
EVILSEED submit URLs to the oracles, as shown in Figure 1.
Whenever a malicious URL is found by the crawler, it is
included in the seed used by EVILSEED. The oracles that we
use for evaluation are Wepawet, Google Safe Browsing, and a
custom fake AV detector (see Section II). We ran this setup for
25 days, using all gadgets except the DNS queries (for which
we did not have access to a trace dataset during this time)
and the domain registration gadget (which was developed at
a later stage). To assess the performance of EVILSEED, we
evaluated our approach against two reference approaches for
ﬁnding malicious URLs: a traditional crawler coupled with a
fast preﬁlter, and random searches.
436
Crawler & preﬁlter: In this approach, we use a traditional web
crawler to traverse the web and use a fast preﬁlter to select
the pages to analyze with our oracles. The crawler is seeded
with “trending” terms from Google Trends and Twitter terms,
which are known to be often abused by attackers. The fast
ﬁlter uses static characteristics of a page to quickly identify
and discard pages that are likely to be benign, in a vein
similar to Prophiler [21]. This setup allows us to compare
EVILSEED with a traditional, crawler-based infrastructure for
ﬁnding malicious web pages.
Web searches: In this approach, we send a variety of queries
to search engines, and submit the results to our oracles. The
rationale for comparing with web searches is to contrast
the toxicity of the URLs found by EVILSEED with the
intrinsic toxicity of search engine results. The toxicity of
search engine results is affected by two competing forces:
criminals using search engine optimization, and search engines
pruning malicious results.
To generate web queries, we use the following strategies:
• Random alphabetic phrases, composed of 1 to 5 words,
of length from 3 to 10 characters (e.g., “asdf qwerou”);
• Random phrases with words taken from the English
dictionary, from 1 to 5 words (e.g., “happy cat”);
• Trending topics taken from Twitter and Google Hot Trends
(e.g., “black friday 2011”);
• Manually-generated Google dorks, taken from an online
repository (e.g., “allinurl:forcedownload.php?ﬁle=”, which
locates vulnerable WordPress sites) [19].
Table II shows an overview of the results of the experiments.
EVILSEED submitted 226,140 URLs to the oracles, of which
3,036 were found to be malicious, for a toxicity of 1.34%.
The Crawler & preﬁlter setup discovered 604 malicious URLs
(these are the URLs we use as seeds for EVILSEED). The
stream of URLs generated by this approach had a toxicity of
0.14%, which is an order of magnitude less than EVILSEED.
The web search setup found 219 malicious URLs for a total
toxicity of 0.34% (Table II shows results for individual search
strategies). Interestingly, the toxicity of search engine results
is 2–3 times higher than a random crawl, likely indicating that
search engines are heavily targeted by attackers.
The seed expansion (the ratio between the number of
malicious pages that were identiﬁed and the initial evil seed)
shows that the gadgets can generate a stream of malicious
URLs of a magnitude comparable to (or larger than) the number
of seeds. The only exception is the SEO gadget, which during
the time of this experiment, found only 16 malicious URLs
(using 604 evil seeds). We explain this result by noticing that,
during this time, the gadget was not able to identify a live SEO
campaign, which it requires to produce its feed. We will show
later the performance of this gadget when SEO campaigns are
active.
Overall, this experiment shows that EVILSEED clearly
outperforms in toxicity both crawling (1.34% vs. 0.14%) and
web searching (1.34% vs. 0.34%). These results also show
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:48:16 UTC from IEEE Xplore.  Restrictions apply. 
Source
EVILSEED
Links
SEO
Content Dorks (keywords)
Content Dorks (ngrams)
Total
Crawler w/ Preﬁlter
Web Search
Random Strings
Random Dictionary
Trending Topics
Manual Dorks
Seed
URLs Visited
Queries
URLs analyzed Malicious URLs
Toxicity
Expansion
604
604
604
604
82,391
312
13,896
140,660
237,259
3,057,697
24,137
27,242
8,051
4,506
5,470
-
1,432
7,277
14,179
-
504
599
370
87
71,272
312
13,896
140,660
226,140
437,251
24,137
27,242
8,051
4,506
1.81
0.02
0.78
2.39
5.02
1,097
16
477
1,446
3,036
604
68
107
27
17
1.53%
5.12%
3.43%
1.02%
1.34%
0.14%
0.28%
0.39%
0.33%
0.37%
Seed
Domains visited
Queries
Domains analyzed Malicious domains
Toxicity
Expansion
Source
EVILSEED
Links
SEO
Content Dorks (keywords)
Content Dorks (ngrams)
Total
Crawler w/ Preﬁlter
Web Search
Random Strings
Random Dictionary
Trending Topics
Manual Dorks
98
98
98
98
9,882
7
3,245
33,510
46,644
407,692
4,227
9,285
1,768
3,032
5,470
-
1,432
7,277
14,179
-
504
599
370
87
Table II
7,664
7
3,245
33,510
44,426
53,445
4,227
9,285
1,768
3,032
1.09
0.07
1.22
2.68
5.04
107
5
119
263
494
98
16
35
8
13
1.39%
71.42%
3.66%
0.78%
1.12%
0.18%
0.37%
0.37%
0.45%
0.42%
EVILSEED EVALUATION: URLS AND DOMAINS.
that adding even relatively few new pages to the set of evil
seeds enables EVILSEED to locate signiﬁcant numbers of
additional malicious pages. More precisely, during these 25
days, EVILSEED discovered over ﬁve times more malicious
URLs than the crawler (the expansion is 5.2), visiting 92%
less pages.
What is the cost of querying search engines? Our gadgets
query search engines to identify pages that are likely malicious.
Clearly, if EVILSEED required disproportionately many queries
to perform its guided search, then its advantages (increased
toxicity and expansion) would be outweighed by the cost of
querying search engines. This is not the case with the gadgets
we have implemented. Table II reports the number of queries
executed by each gadget: as it can be seen, the number of
search engine queries generated by EVILSEED scales linearly
with the number of malicious URLs discovered: approximately
1 every 4 queries leads EVILSEED to such an URL.
Does EVILSEED ﬁnd malicious URLs on different domains?
A search procedure that ﬁnds malicious content on different
domains is more valuable than one that only discovers it on a
few domains: different malicious domains may be indicative of
different attack campaigns, and more domains can be added to
domain blacklists. Table II shows the results of our evaluation
at the domain level (subdomains are not considered as different
domains). We observe that, on average, the crawler ﬁnds 6.16
malicious pages per domain. These results show that EVILSEED
maintains the same domain coverage as the crawler, ﬁnding
an average of 6.14 malicious pages per domain.
Does EVILSEED sustain its production of malicious URLs
over time? Figure 3 shows the number of malicious pages
found by EVILSEED each day over a period of 25 days. We
observe that the number of detections per day is consistent
over time.
Figure 3. EVILSEED detections over time.
B. SEO Gadget
As we have seen, the SEO gadget performed poorly during
our initial experiment. This is because its seed, comprising
the malicious URLs found by the crawler during that time,
did not contain URLs belonging to a live SEO campaign. We
speculate that this may be due to a change in the Twitter API
that occurred during our experiment, which may have reduced
the maliciousness of seeds based on Twitter trending topics.
To better evaluate the SEO gadget, we ran a successive
experiment, in which we fetched hourly the top trends for
Twitter and Google Hot Trends, searched for them on Google,
437
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:48:16 UTC from IEEE Xplore.  Restrictions apply. 
detectionsdays300150225  75    0and analyzed the results with our cloaking detection heuristic
(Section III-C). Out of the 110,894 URLs that we collected,
248 were detected to be cloaking (at the domain level, 46
out of 54,944). We then seeded the SEO gadget with these
cloaking URLs. The results of this experiment are shown in
Table III. Note that, to use the oracle’s resources efﬁciently, the
SEO gadget submits only one URL per each distinct domain.
The high detection rate on these URLs indicates that our
cloaking detection technique is effective and that redirection-
based cloaking provides a strong indication that a website is
malicious. Note that the toxicity does not take into account the
number of visited pages, since the most expensive operation