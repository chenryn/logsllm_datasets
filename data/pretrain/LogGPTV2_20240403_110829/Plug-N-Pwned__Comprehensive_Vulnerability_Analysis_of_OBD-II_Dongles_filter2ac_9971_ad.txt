### Special Message
**V4**  
**V5**  
- y z  
- y z  
- y z  
- y  
- z  

### Table 3: Vulnerability Analysis Results and Special Messages of 77 OBD-II Dongles
(Note: x = Non-diagnostic CAN bus message, y = Private command, z = Firmware image of dongle, (cid:71)(cid:35) = Vulnerable but with tight constraint for exploitation)

---

### 956 29th USENIX Security Symposium
USENIX Association

### BlueDriver, Carly for Toyota, and FIXD
These applications provide advanced diagnostic and even remote-control functions. However, the most popular apps (e.g., Torque Lite) are developed by third parties for ELM327-based dongles, making them compatible with most of the dongles we purchased.

### 5.2 Experiment Setup
Our dynamic analysis was conducted on a 2015 Honda Civic in an empty parking lot to avoid unpredictable accidents. The car has a standard OBD-II port located under the steering wheel, allowing us to plug in an OBD-II dongle for testing. The dynamic analysis part of DONGLESCOPE was implemented and deployed on a MacBook Pro laptop with six Intel Core i7-8850H CPUs (2.6 GHz) and 16 GB RAM, running macOS Mojave 10.14.5. Our static companion app analysis was performed on a Linux server running Ubuntu 16.04, equipped with twelve Intel Core i7-8700 CPUs (3.2 GHz) and 32 GB RAM.

### 5.3 Vulnerability Analysis Results
After setting up our experiment environment, we applied DONGLESCOPE to 77 OBD-II dongles and 21 companion mobile apps. Although previous security analyses on OBD-II dongles have revealed insufficient application-layer authentication vulnerabilities and security holes in message filtering [3], our analysis is more comprehensive, as it not only discovers new vulnerabilities but also quantifies them among the dongles on the market. The complete assessment results for all the dongles and companion apps are presented in Tables 3 and 4. In summary, we discovered five types of general vulnerabilities (with four being newly discovered) across broadcast, connection, and communication stages. We found that all the dongles are vulnerable to at least two of these vulnerabilities, indicating widespread vulnerability exposure in this new over-the-air vehicle attack surface today. Below, we present the detailed results based on each stage of the analysis.

### 5.3.1 Connection Stage
**V1. Lack of Authentication:**
- **Connection-Layer and Application-Layer Authentication:** The majority (84.16%) of the dongles lack both connection-layer and application-layer authentication. Our experiment results show that the lack of authentication at the connection stage is widespread among OBD-II dongles. This can be further classified into the lack of authentication at the connection layer and the application layer. The former allows arbitrary nearby connections since no credentials are required. Based on the established connection, the latter enables unauthorized users to communicate with the dongle, effectively allowing unauthorized access to the CAN bus. In summary, 84.16% of the dongles lack both connection-layer and application-layer authentication, providing an attacker with arbitrary access to the CAN bus once the dongle is discovered in the broadcast stage.

**V1.1. No Connection-Layer Authentication:**
- **Default Setting:** Nearly all (92.21%) dongles have no connection-layer authentication by default. At the connection stage, our tool reported that 71 (92.21%) dongles can be arbitrarily connected by nearby devices, while only 6 (7.79%) dongles require authentication before connection, indicating weak protections on the connection layer. With this vulnerability, an attacker can perform a denial-of-service attack by simply keeping the target dongle connected. We further discovered two ways for these 6 dongles to implement connection-layer authentication, summarized in Table 5. For example, OBDLink MX uses WPA2-PSK to authenticate connections, requiring users to enter a password. The entered credential generates a cryptographic key to establish a secure communication channel, preventing eavesdropping attacks. Another method involves using a physical button on the dongle to enter a discoverable mode, allowing external devices to scan and connect. This mode lasts for a few minutes, providing a narrow time window for connection. Among the 6 dongles, 5 use this implementation. Interestingly, the BlueDriver dongle forces itself to sleep after 60 seconds if no connection is established, significantly narrowing the attack window.

**V1.2. No Application-Layer Authentication:**
- **Default Setting:** Only 1 out of 77 dongles has application-layer authentication by default. After establishing a connection, DONGLESCOPE attempted to inject CAN bus messages directly to communicate with the dongle and successfully queried the VIN from 71 (92.21%) dongles, indicating they lack application-layer authentication by default. We manually investigated the companion apps of the remaining 6 dongles to understand the root cause of the injection failure. Surprisingly, only 1 dongle (Automatic Pro) implemented application-layer authentication. The other 5 dongles, including BlueDriver, HaulGauge, Innova, DODYMPS, and OHP Forscan, lack application-layer authentication because they are not ELM327-based and only accept private manufacturer-specific commands for vehicle diagnosis. In this paper, we call these commands "private commands," which can be found in the results of predefined message generation from their companion apps. Interestingly, the developers of Automatic Pro defined private commands to query the VIN or read parameters from the vehicle. The detailed content of these commands is presented in Table 6. Our results reveal that these private commands are usually human-readable strings or numbers, as shown in the last column of the table. These commands are interpreted by the dongles into CAN bus messages and relayed to the CAN bus. Note that these 5 dongles also lack connection-layer authentication, allowing nearby attackers to exploit this vulnerability.

### Table: Companion Apps and Categories
| App Name | Category | Downloads | Dongle-Specific? |
|----------|----------|-----------|------------------|
| Torque Lite (OBD2 & Car) | Communication | 5,000,000 | Yes |
| DashCommand (OBD ELM App) | Communication | 1,000,000 | Yes |
| EOBD Facile - OBD 2 Car Diagstic for elm327 Wi-Fi | Auto & Vehicles | 1,000,000 | Yes |
| ScanMaster for ELM327 OBD-2 ScanTool | Communication | 1,000,000 | Yes |
| Car Scanner ELM OBD2 | Auto & Vehicles | 1,000,000 | Yes |
| OBDLink (OBD car diagnostics) | Communication | 1,000,000 | Yes |
| BlueDriver OBD2 Scan Tool | Auto & Vehicles | 500,000 | Yes |
| OBD Auto Doctor | Auto & Vehicles | 500,000 | Yes |
| Carly for Toyota | Auto & Vehicles | 100,000 | Yes |
| FIXD - Vehicle Health Monitor | Auto & Vehicles | 100,000 | Yes |
| Carista OBD2 | Auto & Vehicles | 100,000 | Yes |
| ZUS - Smart Driving Assistant | Lifestyle | 100,000 | No |
| Automatic | Lifestyle | 100,000 | No |
| RepairSolutions | Auto & Vehicles | 100,000 | No |
| OBD Fusion | Auto & Vehicles | 100,000 | No |
| Kiwi OBD | Tools | 100,000 | No |
| Automate | Tools | 100,000 | No |
| HaulGauge | Tools | 100,000 | No |
| ArtiBox | Tools | 100,000 | No |
| JDiag FasLink M2 | Auto & Vehicles | 100,000 | No |
| DODYMPS | Tools | 100,000 | No |

---

This revised version aims to improve clarity, coherence, and professionalism in the text.