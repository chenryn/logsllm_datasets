cache deception attacks [42].
Unlike previous researches, our work explores threats in
CDN forwarding behaviors that have not yet been well studied,
providing a complement to existing CDN security research.
HTTP-Related DoS Attacks. The HTTP DoS attack can be
launched simply, when legitimate HTTP requests are initi-
ated in large numbers [36]. Furthermore, conﬁgurations and
functions related to the HTTP service can introduce new DoS
attacking vectors [39]. The HTTP DoS attack is an application-
layer attack, posing challenges for detection because the attack-
ing requests appear similar to normal end-user requests [27],
[54], [62]. In this paper, we present issues in the request-
forwarding process of the CDN. Whereas the CDN is normally
considered as an effective anti-DDoS solution for websites, our
study shows that the CDN itself can be abused to launch the
attack, breaking the CDN DoS protection.
In the HTTP/1.1 era, slow HTTP attacks are already well
known [29], [48], [56], but the advent of HTTP/2 introduces
new attacking vectors. Beckett et al. has reported that HTTP/2
helps to scale up the magnitude of HTTP ﬂood DDoS at-
tacks [6], [7]. We further extend their study on CDNs and
analyze the impact of the HPACK mechanism, e.g., Huffman
encoding and :path header ﬁeld, on the ampliﬁcation ratio.
Meanwhile, botnets have historically been used to launch
DDoS attacks [1], [43], [51]. Since the emergence of IoT
devices, the costs required for these attacks have been de-
creasing, whereas trafﬁc generated by these attacks has been
increasing [2], [38]. Although attacks from botnets can be
mitigated by IP blocking, the HTTP DoS attacks described
in this paper are initiated from the CDN itself, making the
attacks stealthier and more difﬁcult to detect. Even worse, a
CDN-powered website cannot apply IP blocking to mitigate
the attacks, because blocking CDN IPs will make the website
totally inaccessible for all clients.
Issues on IP Assignment Strategy. The IP assignment, which
concerns how a network service assigns IP addresses, of a
DHCP server is vulnerable to DHCP starvation attacks [44].
Borgolte et al. has revealed the IP use-after-free vulnerability
in the cloud, which can be exploited by attackers to deceive
domain-based certiﬁcate issuance [9]. In CDN, the egress IP
assignment, which is related to how a CDN assigns an egress
IP to forward requests to an origin, was also studied by Jin et
al.
[34], and they observed the same results that we did.
VIII. CONCLUSIONS
The CDN has become an indispensable part of the Internet,
providing, among other beneﬁts, anti-DoS services for its
CDN-powered websites. However, through the exploitation of
its architectural, implementation, or operational weaknesses,
the CDN itself can also be leveraged to break the CDN DoS
protection.
By revealing three relevant threats and presenting real-
world measurements across six CDNs, this paper reveals the
ﬂawed trade-offs made by CDN vendors between security
and usability. We report that, because of protocol or imple-
mentation weaknesses, full-featured HTTP forwarding support
in CDNs can be abused to launch an efﬁcient DoS attack
against website origins. We envision our work being able to
urge CDNs to raise their security standards, and inspire more
researchers to explore CDN-related security.
ACKNOWLEDGMENT
We thank the anonymous reviewers for their insightful
comments that helped improve the quality of the paper. We
are grateful to our shepherd Ben Stock for his guidance on im-
proving our work. This work is supported by the NSFC (Grant
No. U1836213, U1636204), BNRist Network and Software
Security Research Program (Grant No. BNR2019TD01004).
This work is supported in part by the Ofﬁce of Naval Research
under ONR award number N00014-20-1-2738. Any opinions,
ﬁndings, and conclusions or recommendations expressed in
this material are those of the authors and do not necessarily
reﬂect the views of the sponsors.
REFERENCES
[1] E. Alomari, S. Manickam, B. B. Gupta, S. Karuppayah, and R. Alfaris,
“Botnet-based Distributed Denial of Service (DDoS) Attacks on Web
Servers: Classiﬁcation and Art,” International Journal of Computer
Applications, 2012.
[2] M. Antonakakis, T. April, M. Bailey, M. Bernhard, E. Bursztein,
J. Cochran, Z. Durumeric, J. A. Halderman, L. Invernizzi, M. Kallitsis,
D. Kumar, C. Lever, Z. Ma, J. Mason, D. Menscher, C. Seaman,
N. Sullivan, K. Thomas, and Y. Zhou, “Understanding the mirai botnet,”
in USENIX Security ’17, 2017.
[3] Apache, “Apache doc,” https://httpd.apache.org/docs/, [Accessed Feb.
2019].
[4] S. Aryan, H. Aryan, and J. A. Halderman, “Internet censorship in iran:
A ﬁrst look,” USENIX FOCI ’13, 2013.
13
[5]
Barr,
“Http/2
J.
https://aws.amazon.com/blogs/aws/new-http2-support-for-cloudfront/,
[Accessed Aug. 2018].
amazon
support
cloudfront,”
for
[6] D. Beckett and S. Sezer, “Http/2 cannon: Experimental analysis on
http/1 and http/2 request ﬂood ddos attacks,” Seventh International
Conference on Emerging Security Technologies (EST), 2017.
[7] D. Beckett and S. Sezer, “Http/2 tsunami: Investigating http/2 proxy
ampliﬁcation ddos attacks,” 17th International Conference on Emerging
Security Technologies (EST), 2017.
[8] M. Belshe, R. Peon, and E. M. Thomson, “Hypertext Transfer Protocol
Version 2 (HTTP/2),” RFC 7540.
[9] K. Borgolte, T. Fiebig, S. Hao, C. Kruegel, and G. Vigna, “Cloud strife:
Mitigating the security risks of domain-validated certiﬁcates,” NDSS
’18, 2018.
[36]
[11]
[12]
[10] F. Cangialosi, T. Chung, D. Choffnes, D. Levin, B. M. Maggs, A. Mis-
love, and C. Wilson, “Measurement and analysis of private key sharing
in the https ecosystem,” CCS ’16, 2016.
censys, “censys.io,” https://censys.io/, [Accessed Aug. 2018].
J. Chen, J. Jiang, H. Duan, N. Weaver, T. Wan, and V. Paxson, “Host
of troubles: Multiple host ambiguities in http implementations,” CCS
’16, 2016.
J. Chen, J. Jiang, X. Zheng, and H. Duan, “Forwarding-Loop Attacks
in Content Delivery Networks,” NDSS ’16, 2016.
[13]
[14] Cloudﬂare,
address
https://www.cloudﬂare.com/ips/, [Accessed Nov. 2019].
“Cloudﬂare
ip
ranges,”
[15] CloudFront,
“Cloudfront
ip
address
ranges,”
https://ip-
ranges.amazonaws.com/ip-ranges.json, [Accessed Nov. 2019].
J. Cowie, “Egypt
leaves-the-internet/, Jan. 2011.
leaves the internet,” https://dyn.com/blog/egypt-
[16]
[18]
[17] A. Dabrowski, G. Merzdovnik, J. Ullrich, G. Sendera, and E. R. Weippl,
“Measuring cookies and web privacy in a post-gdpr world,” in PAM,
2019.
datanyze.com,
share,”
https://www.marketsandmarkets.com/Market-Reports/content-delivery-
networks-cdn-market-657.html, [Accessed Nov. 2019].
datanyze.com, “Cdn market share,” https://www.datanyze.com/market-
share/cdn, [Accessed Nov. 2019].
market
“Cdn
[19]
[20] DynResearch,
“Cdn
adoption
by
the
numbers,”
https://dyn.com/blog/dyn-research-cdn-adoption-by-the-numbers/,
[Accessed Aug. 2018].
[21] Fastly, “Fastly ip address ranges,” https://api.fastly.com/public-ip-list,
[Accessed Nov. 2019].
[22] S. K. Fayaz, Y. Tobioka, V. Sekar, and M. Bailey, “Bohatei: Flexible
and elastic ddos defense,” 24th USENIX Security Symposium, 2015.
[23] R. Fielding, J. Reschke, and Ed., “Hypertext transfer protocol (http/1.1):
Message syntax and routing,” 2014.
[24] Y. Gilad, M. Goberman, A. Herzberg, and M. Sudkovitch, “Cdn-on-
demand: An affordable ddos defense via untrusted clouds,” NDSS, 2016.
[25] M. Gonlag, “Are the http/2 or spdy protocols supported between
cloudﬂare and the origin server?” https://support.cloudﬂare.com/hc/en-
us/articles/214534978, [Accessed Aug. 2018].
[26] R. Guo, J. Chen, B. Liu, J. Zhang, C. Zhang, H.-X. Duan, T. Wan,
J. Jiang, S. Hao, and Y. Jia, “Abusing cdns for fun and proﬁt: Security
issues in cdns’ origin validation,” 2018 IEEE 37th Symposium on
Reliable Distributed Systems (SRDS), 2018.
[27] G. D. Hakem Beitollahi, “Analyzing well-known countermeasures
against distributed denial of service attacks,” Computer Communica-
tions, 2012.
[28] S. Hao, C. Uc, S. Diego, and H. Wang, “End Users Get Maneuvered
: Empirical Analysis of Redirection Hijacking in Content Delivery
Networks,” USENIX Security ’18, 2018.
[29] T. Hirakawa, K. Ogura, B. B. Bista, and T. Takata, “A defense method
against distributed slow http dos attack,” 19th International Conference
on Network-Based Information Systems (NBiS), 2016.
J. Holowczak and A. Houmansadr, “CacheBrowser : Bypassing Chinese
Censorship without Proxies Using Cached Content,” CCS ’15, 2015.
[30]
[31] C. Huang, A. Wang, J. Li, and K. W. Ross, “Measuring and evaluating
large-scale cdns,” IMC ’08, 2008.
[32] S. Huang, F. Cuadrado, and S. Uhlig, “Middleboxes in the internet: A
http perspective,” Network Trafﬁc Measurement and Analysis Confer-
ence (TMA), 2017.
[33] hubspot.net,
“2019
cdn
https://cdn2.hubspot.net/hubfs/4238862/2019
20Market 20Report.pdf, [Accessed Nov. 2019].
market
20Intricately
report,”
20CDN
[34] L. Jin, S. Hao, H. Wang, and C. Cotton, “Unveil the hidden presence:
Characterizing the backend interface of content delivery networks,”
in 2019 IEEE 27th International Conference on Network Protocols
(ICNP), Oct 2019.
[35] L. Jin, S. Hao, H. Wang, and C. Cotton, “Your Remnant Tells Secret :
Residual Resolution in DDoS Protection Services,” DSN ’18, 2018.
Jin Wang, Min Zhang, X. Yang, Keping Long, and Chimin Zhou, “Http-
scan: Detecting http-ﬂooding attack by modeling multi-features of web
browsing behavior from noisy dataset,” 19th Asia-Paciﬁc Conference
on Communications (APCC), Aug 2013.
[37] M. S. Kang, S. B. Lee, and V. D. Gligor, “The crossﬁre attack,” IEEE
Symposium S&P, 2013.
[38] M. Karami and D. McCoy, “Understanding the emerging threat of
ddos-as-a-service,” in USENIX Workshop on Large-Scale Exploits and
Emergent Threats. USENIX, 2013.
[39] K. K. Karanpreet Singh, Paramvir Singha, “Application layer http-get
ﬂood ddos attacks: Research landscape and challenges,” Computers and
Security, 2017.
[40] KeyCDN,
“Origin
shield
-
extra
cdn
caching
layer,”
[41]
https://www.keycdn.com/support/origin-shield, [Accessed Oct. 2018].
J. Liang, J. Jiang, H. Duan, K. Li, T. Wan, and J. Wu, “When https
meets cdn: A case of authentication in delegated service,” IEEE S&P
’14, 2014.
[42] S. A. Mirheidari, S. Arshad, K. Onarlioglu, B. Crispo, E. Kirda, and
W. Robertson, “Cached and confused: Web cache deception in the wild,”
USENIX Security, 2020.
J. Mirkovic and P. Reiher, “A taxonomy of ddos attack and ddos defense
mechanisms,” SIGCOMM ’04., 2004.
[43]
[44] H. Mukhtar, K. Salah, and Y. Iraqi, “Mitigation of dhcp starvation
attack,” Comput. Electr. Eng., 2012.
[45] Z. Nabi, “The anatomy of web censorship in pakistan,” USENIX
Workshop on Free and Open Communications on the Internet, 2013.
[46] H. V. Nguyen, L. L. Iacono, and H. Federrath, “Your cache has fallen:
Cache-poisoned denial-of-service attack,” CCS ’19, 2019.
[47] A. G. Oleg Kupreev, Ekaterina Badovskaya, “Ddos attacks in q4 2018,”
https://securelist.com/ddos-attacks-in-q4-2018/89565/, [Accessed Feb.
2019].
J. Park, K. Iwai, H. Tanaka, and T. Kurokawa, “Analysis of slow read
dos attack,” International Symposium on Information Theory and its
Applications, 2014.
[48]
[49] R. Peon and H. Ruellan, “Hpack: Header compression for http/2,” 2015.
[50] RouteViews,
project,”
route
http://www.routeviews.org/, [Accessed Aug. 2018].
“University
oregon
views
of
[51] S. M. Specht and R. B. Lee, “Distributed Denial of Service: Taxonomies
of Attacks, Tools and Countermeasures,” International Workshop on
Security in Parallel and Distributed Systems, no. 9, pp. 543–550, 2004.
[52] StackPath, “Origin shield: Protect your origin from trafﬁc spikes,”
https://www.stackpath.com/products/cdn/origin-shield/, [Accessed Oct.
2018].
[53] Stackpath,
“Maxcdn
is
now
stackpath,”
https://www.stackpath.com/maxcdn/, [Accessed Oct. 2019].
[54] K. Subramanian, P. Gunasekaran, and M. Selvaraj, “Two layer defend-
ing mechanism against ddos attacks,” International Arab Journal of
Information Technology, 2015.
[55] S. Systems, O. Spatscheck, A. Barbir, and R. Nair, “Known Content
Network (CN) Request-Routing Mechanisms,” RFC 3568, Oct. 2015.
[56] N. Tripathi, N. Hubballi, and Y. Singh, “How secure are web servers?
an empirical study of slow http dos attacks and detection,” 11th Inter-
national Conference on Availability, Reliability and Security (ARES),
2016.
[57] S. Triukose, Z. Al-qudah, and M. Rabinovich, “Content Delivery
Networks : Protection or Threat,” ESORICS ’09, 2009.
14
[58] T. Vissers, T. V. Goethem, W. Joosen, and N. Nikiforakis, “Maneuvering
Around Clouds : Bypassing Cloud-based Security Providers,” CCS ’15,
2015.
[59] Z. Wang, Y. Cao, Z. Qian, C. Song, and S. V. Krishnamurthy, “Your
state is not mine: A closer look at evading stateful internet censorship,”
IMC ’17, 2017.
[60] Wikipedia, “Http/2,” https://en.wikipedia.org/wiki/HTTP/2, [Accessed
Aug. 2018].
[61] Wikipedia,
“Internet
regulation
in
turkey,”
Nov.
https://en.wikipedia.org/wiki/Internet regulation in Turkey,
2019.
[62] X. Yuan, C. Li, and X. Li, “Deepdefense: Identifying ddos attack via
deep learning,” IEEE International Conference on Smart Computing
(SMARTCOMP), 2017.
[63] H. Zolfaghari and A. Houmansadr, “Practical Censorship Evasion
Leveraging Content Delivery Networks,” CCS ’16, 2016.
15