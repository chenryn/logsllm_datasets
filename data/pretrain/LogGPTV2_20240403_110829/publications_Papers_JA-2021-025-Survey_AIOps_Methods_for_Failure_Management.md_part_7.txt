Althoughinthemajorityofcasesreallabeledsamplesarenotavailable,itmaybepossibleto
obtain behavioral set of rules or an execution model for the system. The model information be-
comesalsoveryrelevantwhenfailuresneedtobediagnosed(seeSection4.4.2).Withtheuseof
a behavioral model, different pattern-matching approaches can be developed. For example, hav-
ing access to a probabilistic context-free grammar (PCFG), which defines the likelihood of
event chains to occur in sequential input, allows an anomaly detection algorithm to single out
unlikelystructuresanddetectanomalies.Magpie[11]alreadyproposestheuseofPCFGstomodel
eventsequencesanddetectanomalousrequests.AsimilarapproachisusedinReference[26]to
detectfailuresbysearchingforanomaliesinexecutionpaths(i.e.,traces).Thispathinformation
is especially valuable to localize and diagnose failures (see also discussion of Reference [26] in
Section4.4.2).
More often, a behavioral model of the system is inferred from the past execution history, of-
ten expressed in the form of logs. An example of such a model is constituted by Finite State
Machines(FSM)[12,45].InaworkbyFuetal.[45],logentriesarefirstmappedtotheircorre-
spondingtemplateversion,calledlogkey.Similarlogentries,usedtoidentifylinetemplates,are
groupedviaclustering.Then,FSMsarelearnedtomodelprogramworkflowsfromlogevidence.
The model so obtained can be later used to verify the correct execution of programs and detect
softwareproblems.Theentireapproachpipelineistestedonlogfilesfromtwodistributedcom-
putingframeworks,achieving95%accuracyonlogkeyextractionduringthedetectionofdifferent
typesoffailuresmanuallyinserted.Beschastnikhetal.adoptasimilarapproachwiththeirsystem
CSight[12].Asthemaingoaloffailuredetectionistoenableroot-causeanalysis,theauthorsalso
performedauserstudyontheusefulnessofFSMdiagramscomparedtoothergraphicaldebugging
toolsforidentifyingexecutionerrors.FSMdiagramsenabledstudysubjectstoidentifyproblems
moreoften(+11%)comparedtosubjectswhowereshown6/8time-spacediagrams,consideredless
understandable by them. In Reference [29], a causal model of request executions is constructed
fromtheavailablecomponent-leveltracelogs.Themodel,calledTheMysteryMachine,identifies
different types of predefined causal relationships between components via iterative refinement,
ACMTransactionsonIntelligentSystemsandTechnology,Vol.12,No.6,Article81.Publicationdate:November2021.
ASurveyofAIOpsMethodsforFailureManagement 81:25
Table6. SummaryofDescribedAnomalyDetectionMethods,CategorizedbyDataSourcesandAlgorithm,
withCorrespondingAdvantagesandDisadvantages
DataSources
Paper(s) KPIs&Metrics Algorithm Advantages/Disadvantages
sgoL secarT srehtO
etairavinU etairavitluM
[31] • TAN interpretability,applicabilityto
othertasks/requiressupervision
[86] • Random highaccuracy,onlinere-training/
Forest requiressuperviseddata
[110] • Markov unsupervised,onlinelearning/
Chain black-boxmonitoring
[127,150] • Unsupervised generalpurpose,nolabelsrequired/
Learning univariateanalysisonly
[7,131,159] • Autoencoder multi-dimensionalanalysis,no
labelsrequired/trainingstep
[12,45] • FSM enablesRCA/requirestemplate
discoverystep
[18,41,92,162] • RNN robust,accurate,unsupervised/
requiresparsing,trainingstep
simple,unsupervisedmethodfor
[151] • • PCA free-textdata/requiresparsing,low
interpretability
[11,26] • Clustering/ enablesmultipleAIOpstasks/
PCFG requiresend-to-endtracing
interpretability,enablesRCA/
[29] • Causal applicableinsequentialsystems
Inference
only
[87] • SVM high-level,largeapplicability/
requiressuperviseddata,tracing
[72,73] • PCA/Feature specific/exclusivefor
Distribution network-trafficanomalydetection
supportedbythepasttracehistory.Accordingtotheauthors,TheMysteryMachinecanbeused
to conduct an anomaly analysis of service requests based on segment features. In particular, it
can used to aggregate similar requests by structure and latency via comparison of the segment
structure of anomalous requests. Thanks to this inspection, it was possible to identify unneces-
sarydebuggingcomponentsreturnedoccasionallyinuserrequests.InaworkbyXuetal.[151],
textanalysisandinformationretrievaltechniquesareappliedonconsolelogsandsourcecodeto
findabnormalpatternsduringtheoperationoflarge-scaledatacenters.Inparticular,statevariables
andobjectidentifiersareextractedautomaticallyfromparsedlogs,andtheirfrequencyindiffer-
entdocuments(expressedinterminverse-documentfrequency,TF-IDF)isanalyzedwithPCAto
detectanomalieswithathreshold-basedruleonthereconstructionerror,similartoReference[72].
AnomaliesdetectedwiththePCAapproacharealsousedtotrainsuperviseddecisiontrees,useful
foroperatorstointerpretanomaliesandacceleratetheidentificationofproblems.
In recent years, RNN have been applied for log-based anomaly detection [18, 41, 92, 162]. Du
et al.’s DeepLog [41] uses RNNs based on LSTM layers to learn patterns from logs and detect
anomalies.AsinFuetal.[45],logentriesareinitiallymappedtocorrespondinglogkeys.Then,
DeepLogpredictstheprobabilitydistributionofthenextlogkeyfromtheobservationofprevious
ACMTransactionsonIntelligentSystemsandTechnology,Vol.12,No.6,Article81.Publicationdate:November2021.
81:26 P.Notaroetal.
log keys, similar to a natural language model that predicts the next token from the observation
of the rest of the sentence. A log key is considered abnormal if it does not appear in the topk
keys ranked by probability. The paper also proposes an online learning strategy based on user
feedback.Theapproachisvalidatedonself-generateddatasetsfromHDFSandOpenStack,where
itiscomparedtoothermethodsforthesametask.At100%recall,DeepLogdramaticallyreduces
thefalse-alarmrate(from38.2–40.1%to1.1–1.7%)usingonlyasmallfractionofdatafortraining
(1–10%).Brownetal.[18]alsoworkonlog-basedanomalydetection,presentinganword-token
RNN language model for raw logs based on five attention mechanisms (reaching AUCROC ≥
0.963). The paper also proposes to analyze attention weights to provide statistical insights, un-
derstand global behavior and improve decision making. Although their work is tested for intru-
sion detection tasks, it can be used for other detection tasks, e.g., detect failures at the request
andserverlevel.Thesameauthorsalsorecognizeitspotentialtopredicthardwarefailuresonline.
LogAnomaly [92], while adopting the language model approach, proposes the use of template
embeddings(template2vec)tobetterextractsemanticinformation,bywhichsimilarlogkeyscan
be matched and merged automatically, without requiring human feedback. Thanks to template
vectors,OmniAnomalycanalsolearnquantitativepatternsinadditiontosequentialpatterns.All
theseimprovementsenabletofurtherreducefalsealarmratecomparedtoDeepLog(F1=0.8632).
LogRobust[162]dealswiththeproblemofloginstability,causedbythechanginglogstatements
overtimeandnoiseinlogprocessing.Toaddressthis,LogRobustalsoemploysLSTMlayers,se-
manticvectorsandattention,butdifferentlyfromlanguagemodelapproaches,itdirectlypredicts
anomaliesbycomputingananomalyscore.Theapproachisvalidatedonindustrialandsynthetic
HDFSdata,withanaverageF1-scoreof0.81(+0.29)onunstablelogdata.
Whileunsupervisedlearningapproachesaregenerallymoreapplicable,supervisedlearningap-
proachesforanomalydetectionareviableinscenarioswherelabelsareavailableforbothnormal
andanomaloussamples.Moreover,alltypesofanomaliesneedtobeknownbeforehandandsuffi-
cientsamplesforeachtypemustarenecessary.Loetal.[87]investigatethedetectionoffailures
insoftwareasaclassificationproblem.Theirapproachminessetsofdiscriminativefeaturesfrom
executiontracesandusethemtotrainaSVMforclassifyingsoftwarebehaviorintonormaland
abnormal.Theapproachisvalidatedbyperformingseveralcontrolledexperimentswithrealtrace
data,obtainedfromprogramsoftheSiemenstestsuite[59]andMySQLdatabaseserver.Inboth
scenarios,faultsareinjectedartificiallywithdifferenttechniques.Theapproachshowsveryhigh
levelsofdetection,withAUCROCrangingfrom0.82to1.00.
AnothersupervisedclassificationapproachisproposedwithOpprentice[86].Opprenticeana-
lyzes KPI time series with Machine Learning to automatically detect anomalies online. Random
ForestsareappliedtoclassifyKPIpointobservations(composedofthreevariables)innormaland
abnormal behavior classes, with the possibility to set up a sensitivity threshold online. The ap-
proachalsoincludesanofflinealgorithmtoselecttheoptimalthresholdsatisfyingcustomlinear
constraints on the Precision-Recall plane. Finally, to overcome the labeling effort required by a
supervisedapproach,alabelingtoolforKPItimeseriesliketheonesobservedinthepaper.
AnotherinstanceofsupervisedanomalydetectionistheTANapproachofCohenetal.[31](the
algorithmandexperimentalsetuparediscussedinSection4.4.2).SLOcompliancyinWebserversis
usedassupervisiondatatolearnasystembehavioralmodelfromcombinationsofmetrics,applica-
bletoperformforecasting,detection,anddiagnosis.Whenusedforonlinedetectiononsynthetic
workloads,theTANapproachwasabletodetect91.9%–93%offailureswithafalsealarmrateof
6.4–16.9%.
Inconclusion,wereporttheworkofNguyenetal.[110],laterdescribedinSection4.4.1.While
designedforblack-boxfaultlocalization,theproposedsystemisdeeplyintegratedwithanabnor-
malchangepointdetectionalgorithmforsubsequentroot-causeanalysis.Thisdetectionapproach
ACMTransactionsonIntelligentSystemsandTechnology,Vol.12,No.6,Article81.Publicationdate:November2021.
ASurveyofAIOpsMethodsforFailureManagement 81:27
is based on Markov chains with dynamic thresholding and operates at the component level to
pinpointirregularsystemmetricvalues.TheMarkovmodelisalsoaninstanceofonlinelearning
andsoitisindicatedforapplicationscenarioswithvariabletimecharacteristics.
4.3.2 InternetTrafficClassification(ITC). AtaskconnectedtonetworkfailuredetectionisIn-
ternet Traffic Classification (ITC). ITC allows categorizing packets exchanged by a network
systemtoidentifynetworkproblems,tooptimizeresourceprovisioningandimproveQuality-of-
Service[43,97].Itcanbeappliedtoanalyzethelocalnetworkflow,theincomingserverrequests
from the outside, or the outgoing response. ITC is also widely used for cybersecurity purposes,
suchasintrusiondetection[97,142].Allthesesupportedareasareconnectedtotheappearance
offailuresandthisfactmotivatesthediscussionofITCaspartoffailuremanagement.ITCcanbe
seenasaparticularinstanceofnetworkanomalydetection.However,inpractice,thedifferences
inmethodology(emblematicofaclassificationproblemratherthanadetectionproblem)anddata
sources(networktrafficratherthanKPIsandmetrics)justifyaseparatediscussion.
Moore et al. [97] propose to use Supervised Machine Learning to classify the observed Inter-
net traffic. Their work selects relevant features from a set of 248 discriminative variables (such
aspayloadsize,TCPport,etc.)totrainaNaïveBayesclassifierandseparatetrafficaccordingto
differentcategorysets(e.g.,application-wise,maliciousnessvs.legitimacy,etc.).Theapproachis
lateraugmentedwithkernelestimationtoovercomethelimitationsoftheGaussianassumption
introduced.Inafollowingwork[8],theBayesianframeworkisextendedtoBayesianNeuralNet-
works,inthearchitecturalformofMultilayerPerceptrons,reaching95–99%accuracy,depending
onthespecifictestcase.
Este et al. [43] develop a framework based on SVM models for TCP traffic classification. TCP
communication is analyzed at the flow level rather than at the individual packet level: single-
direction traffic flows between nodes are classified with multi-class kernel SVMs, depending on
theapplication-levelprotocoltheyutilize.Single-class(oneversusall)modelsarealsotrainedto
obtaindecisionboundariesandsetapartoutlierpackets.Themodelsurpassescorrectprediction
ratesof90%onthreedatasetsundertest.
Wang et al. [142] propose an end-to-end classification method for encrypted traffic based on
1DCNN.TheinputoftheCNNisrepresentedbyrawpacketdatagroupedaccordingtodifferent
conventions,suchasflowandsession.Theapproachisevaluatedonapublicdataset(ISCX)con-
tainingbothVPNandnon-VPNdata,whereitisusedtoassigntheobservedtrafficinoneofthe14
categories,definedbasedontheapplication(e.g.,E-mail,streaming,chat,etc.).The1DCNNmodel
improvesthestateoftheartonthedescribeddatasetbyapproximately10%intermsofprecision
and8%intermsofrecall.
4.3.3 Log Enhancement. Another task connected to failure detection is log enhancement. Its
goal is to improve the quality and expressiveness of system logs, which are frequently used for
detectionanddiagnosistasksbyIToperatorsandAIOpsalgorithms.
Zhuetal.[168]proposealoggingsuggestiontool,calledLogAdvisor,tolearnpracticallogging
suggestionsfromexistingloginstances.Incodesnippets,severalstructural,syntactical,andtextual
featuresareextractedandfilteredbasedoninformationgain,fromwhichadecisiontreeislater
trainedtosuggestloggingofsnippetsasabinaryclassificationproblem.Theapproachiscompared
to several other baselines, including a random 50% predictor, a previous algorithmic approach
calledErrLog[155],andotherMachineLearningmodels.LogAdvisorisshowntoreducelogging
overheadcomparedtoErrLogwhenloggingisnotrequired,eventhoughitislesspreciseandit
mayoccasionallynotplacesomeinformativeprintstatementscomparedtothemoreconservative
ErrLog.
ACMTransactionsonIntelligentSystemsandTechnology,Vol.12,No.6,Article81.Publicationdate:November2021.
81:28 P.Notaroetal.
In Reference [163], an approach for automated placement of log printing statements (Log20)
basedoninformationtheoryisproposed.First,entropyisshowntobeaninformativemeasurefor
theplacementofprintingstatements.Then,agreedydynamicprogrammingalgorithmforplacing
printingstatementsisimplemented.Theoverallapproachistestedonfourpopulardistributedsys-
tems,whereLog20canbeasinformativeasdifferentlog-levelpolicies,whilesignificantlyreducing
theprintoverhead(from1.58entriesperrequestdownto0.08fortheINFOloglevel).
4.4 Root-causeAnalysis(RCA)
Failuredetectionistheprocessofcollectionofsymptoms,i.e.,observationsthatareindicativeof
failures.Root-causeanalysisis,instead,theprocessofinferringthesetoffaultsthatgenerateda
givensetofsymptoms[130].Inacomplexanddistributedsystem,itisfirstrequiredtoisolateto
restricttheanalysistotheresponsiblecomponentorfunctionalsubsystem,ataskthatwecallfault