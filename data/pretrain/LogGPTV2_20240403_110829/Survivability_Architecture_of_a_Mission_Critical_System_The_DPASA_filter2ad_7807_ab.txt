Zone 
Zone 
Zone 
Operations 
Operations 
Operations 
Zone 
Zone 
Zone 
Crumple 
Crumple 
Crumple 
Zone 
Zone 
Zone 
Client 
Client 
Quad B 
Quad B 
Quad 2 
Executive 
Executive 
Executive 
Zone 
Zone 
Zone 
Operations 
Operations 
Operations 
Zone 
Zone 
Zone 
Crumple 
Crumple 
Crumple 
Zone 
Zone 
Zone 
Core 
Core 
Quad C 
Quad C 
Quad 3 
Executive 
Executive 
Executive 
Zone 
Zone 
Zone 
Operations 
Operations 
Operations 
Zone 
Zone 
Zone 
Crumple 
Crumple 
Crumple 
Zone 
Zone 
Zone 
Quad D
Quad D
Quad 4
Executive
Executive
Executive
Zone
Zone
Zone
Operations
Operations
Operations
Zone
Zone
Zone
Crumple
Crumple
Crumple
Zone
Zone
Zone
WAN 
WAN WAN 
Client 
Client 
Zone 
Zone 
Client 
Client 
(cid:127) (cid:127) (cid:127) 
• (cid:127) (cid:127) 
(cid:127) (cid:127) (cid:127) 
(cid:127) (cid:127) (cid:127) 
Figure 2 Quads and Zones 
Client 
Client 
Client
Client
  The  crumple  zone  consists  of  the  Access  Proxy  (AP) 
host. The AP host acts as the entry point for all traffic be-
tween the Core from the clients.  For each process running 
on Core hosts that the clients need to interact with, there is 
a  corresponding  proxy  running  on  the  AP  host  that  per-
forms rate limiting, size-checking, application level checks 
without  violating  the  end-to-end  authentication,  and  en-
cryption before forwarding traffic to the Core. 
The  operations  zone  contains  five  hosts:  the  Network 
Intrusion Detection System (NIDS), the PSQ host, the Pol-
icy Server (PS) host, the Correlator (CORR) host, and the 
Downstream  Controller  (DC)  host.  The  NIDSes  are  de-
ployed in each quad. Each NIDS sniffs ingress and egress 
traffic  on  the  LAN  and  sends  alerts  to  the  CORR.    The 
PSQ  host  runs  the  PSQ  server.    Guardians  augment  the 
PSQ server to check the size, the frequency, and the rate 
of the requests exchanged and report anomalies to the Sys-
tem Manager (SM). The PS host runs processes that man-
age the ADF NICs in the system, and interfaces with the 
SM for mounting adaptive responses that make use of the 
ADF  NICs.  The  CORR  host  runs  processes  that  receive 
alerts,  generate  advice  about  a  host,  and  correlate  the 
alerts.    The  correlated  alerts  are  ranked,  aggregated,  and 
displayed  on  a  visual  interface  running  on  the  SM  host. 
The DC host runs the DC component, which processes the 
heartbeat messages, and acts as an operations zone proxy 
for the SM  so that the SM is not directly exposed to the 
crumple zone.  
The executive zone contains the SM host.  The SM host 
runs  the  System  Manager  component  that  manages  the 
Core components running in the quad, and presents a user 
interface for the security operators.  
On most hosts, there is a set of Local Controllers (LCs) 
running to monitor the host and to carry out proactive and 
reactive actions against suspicious activities on the host.  
Communication  among  elements  within  a  zone  and 
across zones is strictly controlled to limit attack progres-
sion from compromised parts. Furthermore, quads can be 
isolated,  stopped  and  restarted.  Communication  between 
clients and the processes running on different core zones 
uses different application level protocols  
3.2.2 
Protection Domains 
In order to implement a barrier to entry and to impede 
attack  propagation,  we  use  protection  domains.    DPASA 
uses three protection domains: network, system, and proc-
ess. 
The  Network  Protection  Domain  protects  network 
traffic, restricts network attack points, and prevents misuse 
of the network. The System Protection Domain protects 
the  host’s  integrity  by  preventing  modification  to  critical 
system files and protects application integrity by prevent-
ing  modification  of  critical  application  resources.  It  en-
forces least-privilege at the host level and is deployed on 
all hosts. Each host process is granted privileges based on 
the  requirements  of  the  system  and  any  attempt  to  carry 
out an action (such as accessing the file-system or contact-
ing the network) that is not in the granted privilege is de-
nied and logged. The Process Domain enforces additional 
constraints such as restricting the system calls an applica-
tion can make.  
3.2.3 
Protocols 
The  components  described  in  section  3.2.1  use  proto-
cols to communicate with other pertinent components. The 
major  protocols  in  DPASA  are  the  registration  protocol, 
alert protocols, PSQ protocol, heartbeat protocol, and SM 
protocols. 
A client uses the registration protocol when it is ready 
to join the JBI. To do so, the SM authenticates itself to the 
client and the client authenticates itself to the SM. The cli-
ents and the Core use alert protocols to alert the Core of 
possible  issues.    The  PSQ  protocol  implements  publish, 
subscribe, and query in a fault-tolerant way. When all four 
quads are participating in the protocol, clients see correct 
behavior from the Core even if any one of the PSQ servers 
is  corrupt  and  behaving  in  an  arbitrarily  malicious  way.  
To detect the failure of the DPASA survivability compo-
nents, the heartbeat protocol is used. Heartbeat messages 
are  sent  to  the  Core  where  the  SMs  use  the  messages  to 
display the status of the system.    The SM uses the SM 
protocols to control ADF NICs, to interact with the PSQ 
servers  to  perform  quorum  group  management  and  other 
published  data  management,  to  take  an  action  on  an  ac-
cused host, or to gather status of components.   
4 
Proceedings of the 21st Annual Computer Security Applications Conference (ACSAC 2005) 
1063-9527/05 $20.00 © 2005 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:05:31 UTC from IEEE Xplore.  Restrictions apply. 
3.3 
The Defense-Enabled System: The JBI Exem-
plar Instantiated in the Survivability Architec-
ture 
Executive Zone
Executive Zone
Operations Zone
Operations Zone
QUAD 1
QUAD 1
Q1SM
Q1SM
Q1PS
Q1PS
Q1CORR
Q1CORR
Q1PSQ
Q1PSQ
Q1DC
Q1DC
Q1NIDS
Q1NIDS
QUAD 2
QUAD 2
QUAD 3
QUAD 3
QUAD 4
QUAD 4
Q2SM
Q2SM
Q2PS
Q2PS
Q2CORR
Q2CORR
Q2PSQ
Q2PSQ
Q2DC
Q2DC
Q2NIDS
Q2NIDS
Q3SM
Q3SM
Q3PS
Q3PS
Q3CORR
Q3CORR
Q3PSQ
Q3PSQ
Q3DC
Q3DC
Q3NIDS
Q3NIDS
Q4SM
Q4SM
Q4PS
Q4PS
Q4CORR
Q4CORR
Q4PSQ
Q4PSQ
Q4DC
Q4DC
Q4NIDS
Q4NIDS
Crumple Zone
Crumple Zone
Q1AP
Q1AP
Q2AP
Q2AP
Q3AP
Q3AP
Q4AP
Q4AP
VPN Router
VPN Router
VPN Router
VPN Router
VPN Router
VPN Router
VPN Router
VPN Router
SELinux
SELinux
Solaris
Solaris
Windows
Windows
ADF NIC
ADF NIC
Bump in the wire
Bump in the wire
Managed Switch
Managed Switch
SPAN Port
SPAN Port
Layer 3 Switch
Layer 3 Switch
VPN Router
VPN Router
NIDS
NIDS
Client 1
Client 1
Client N
Client N
Client LAN 1..4
Client LAN 1..4
Figure 3 Defense-enabled JBI 
Figure 3 shows the defense-enabled JBI. First note that 
rather  than  one  JBI  core  LAN,  it  has  four  Core  LANs 
(quads). The Core uses redundant service providers. These 
services perform the same  function but are hosted on re-
dundant hardware using three different operating systems 
(Security Enhanced  Linux (SELinux), Windows, and So-
laris).  
The  crumple  zone  and  the  executive  zone  each  have 
one host (denoted by QXAP and QXSM respectively in the 
figure) in every quad. The operations zone has five hosts 
(the QXNIDS, the QXDC, the QXPSQ, the QXCORR, and 
the  QXPS)  in  each  quad.  The  clients  are  organized  into 
four LANS and the configuration of the client LAN is not 
changed except for the addition of a NIDS in each LAN.  
  The network topology of the defense-enabled JBI pro-
vides defense-in-depth using multiple layers of protection. 
There is a VPN router in front of each LAN, establishing a 
VPN  trunk  from  each  client  LAN  to  each  of  the  Core 
LANs. All hosts are equipped with ADF NICs, as shown 
by  the  small  solid  rectangles.  Hosts  in  the  crumple  zone 
have two ADF NICs since each crumple zone host has two 
network  interfaces:  one  client  facing  and  the  other  Core 
facing. A device driver for the ADF card was not available 
for  the  Solaris  operating  system,  therefore  the  Solaris 
hosts had an ADF equipped Linux host acting as a bump 
in  the  wire  (indicated  by  the  small  diamond  attached  to 
Solaris hosts). Each core LAN has a managed switch that 
controls the communication between quads as well as in-
ter-zone  communication  within  its  own  quad.  Each  man-
aged switch is further controlled via a Quadrant Isolation 
Switch  (QIS)  by  the  four  SMs  (System  Managers).  The 
QIS allows security operators to isolate an entire quad if 
necessary by cutting off the power to the managed switch. 
A quorum of three SMs is required to isolate a quad. The 
public IP network is simulated by a layer 3 switch and in-
stead  of  implementing  each  client  and  core  LAN  as  a 
physical  LAN,  they  are  implemented  as  VLANs  off  the 
layer 3 switch. 
Host protection domain policies on hosts tightly define 
how processes can be started, and limit the capabilities a 
process  should  have.  In  addition  to  SELinux  (on  Linux 
hosts) and Cisco Security Agent (on Solaris and Windows 
hosts)  policy  enforcement,  the  Java  application  compo-
nents  were  further  sandboxed  by  JVM  security  policies. 
Each  host  runs  a  Local  Controller  (LC)  component  that 
periodically checks the  file  system integrity, CPU,  mem-
ory and disk usage of the host, and acts as the aggregator 
and  reporter  of  local  host  based  policy  violation  reports. 
The  clients  run  three  instances  of  LCs  that  monitor  each 
other and can take over if one crashes.  
The  undefended  JBI  had  only  one  data  flow,  namely 
the data flow associated with the PSQ (Publish, Subscribe, 
Query)  operation.  The  DPASA  architecture  introduced 
four new types of data and control flows in the defended 
system:  1) Each software component sends heartbeats to 
the Core, 2) NIDS, Host Intrusion Detection System, LCs 
and  software  components  all  send  alerts  to  the  Core,  3) 
SMs  send  coordination  and  command  messages  among 
themselves  and  to  other  components,  sometime  via  the 
DCs  (Downstream  Controllers),  and  4)  the  PS  (Policy 
Server)  talks  to  ADF  (Autonomic  Distributed  Firewall) 
NICs for status/heartbeats and key renewal and audit mes-
sages.  
All  communications  between  a  client  LAN  and  the 
Core,  which  were  routed  in  the  undefined  JBI,  are  now 