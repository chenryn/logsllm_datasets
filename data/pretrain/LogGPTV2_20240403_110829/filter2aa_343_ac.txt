Processes no longer need to know how and where administrative data is stored. Open 
Directory gets the data for them. If a process needs the location of a user’s home 
directory, the process simply has Open Directory retrieve the information. Open 
Directory finds the requested information and then returns it, insulating the process 
from the details of how the information is stored. If you set up Open Directory to 
access administrative data in several directory domains, Open Directory automatically 
consults them as needed. 
Some of the data stored in a directory domain is identical to data stored in UNIX 
configuration files. For example, the crypt password, home directory location, real 
name, user ID, and group ID—all stored in the user records of a directory domain—
have corresponding entries in the standard /etc/passwd file. However, a directory 
domain stores much additional data to support functions that are unique to Mac OS X, 
such as support for managing Mac OS X client computers.
Data Distribution
Another characteristic of UNIX configuration files is that the administrative data they 
contain is available only to the computer on which they are stored. Each computer has 
its own UNIX configuration files. With UNIX configuration files, each computer that 
someone wants to use must have that person’s user account settings stored on it, and 
each computer must store the account settings for every person who can use the 
computer. To set up a computer’s network settings, the administrator needs to go to 
the computer and directly enter the IP address and other information that identifies the 
computer on the network. 
Similarly, when user or network information needs to be changed in UNIX 
configuration files, the administrator must make the changes on the computer where 
the files reside. Some changes, such as network settings, require the administrator to 
make the same changes on multiple computers. This approach becomes unwieldy as 
networks grow in size and complexity.
Directory 
domain
Mac OS X processes
Directory 
domain
Open
Directory
LL2352.Book  Page 18  Friday, August 22, 2003  3:12 PM
Chapter 1    Directory Service Concepts
19
Open Directory solves this problem by letting you store administrative data in a 
directory domain that can be managed by a network administrator from one location. 
Open Directory lets you distribute the information so that it is visible on a network to 
the computers that need it and the administrator who manages it.
Uses of Directory Data
Open Directory makes it possible to consolidate and maintain network information 
easily in a directory domain, but this information has value only if application and 
system software processes running on network computers actually access the 
information.
Here are some of the ways in which Mac OS X system and application software use 
directory data:
• Login:  As mentioned already, Workgroup Manager can create user records in a 
directory domain, and these records can be used to authenticate users who log in to 
Mac OS X computers and Windows computers. When a user specifies a name and a 
password in the Mac OS X login window, the login process asks Open Directory to 
authenticate the name and password. Open Directory uses the name to find the 
user’s account record in a directory domain and uses additional data in the user 
record to validate the password.
System
administrator
Users
Directory 
domain
Open
Directory
LL2352.Book  Page 19  Friday, August 22, 2003  3:12 PM
20
Chapter 1    Directory Service Concepts
• Folder and file access:  After logging in successfully, a user can access files and 
folders. Mac OS X uses another data item from the user record—the user ID (UID)—
to determine the user’s access privileges for a file or folder that the user wants to 
access. When a user accesses a folder or file, the file system compares this user’s UID 
to the UID assigned to the folder or file. If the UIDs are the same, the file system 
grants owner privileges (usually read and write privileges) to the user. If the UIDs are 
different, the user doesn’t get owner privileges.
• Home directories:  Each user record in a directory domain stores the location of the 
user’s home directory, which is also known as the user’s home folder. This is where 
the user keeps personal files, folders, and preferences. A user’s home directory can be 
located on a particular computer that the user always uses or on a network file 
server.
• Automount share points:  Share points can be configured to automount (appear 
automatically) in the /Network folder (the Network globe) in the Finder windows of 
client computers. Information about these automount share points is stored in a 
directory domain. Share points are folders, disks, or disk partitions that you have 
made accessible over the network. 
• Mail account settings:  Each user’s record in a directory domain specifies whether 
the user has mail service, which mail protocols to use, how to present incoming mail, 
whether to alert the user when mail arrives, and more.
• Resource usage:  Disk, print, and mail quotas can be stored in each user record of a 
directory domain.
• Managed client information:  The administrator can manage the Mac OS X 
environment of users whose account records are stored in a directory domain. The 
administrator makes mandatory preference settings that are stored in the directory 
domain and override users’ personal preferences.
• Group management:  In addition to user records, a directory domain also stores 
group records. Each group record affects all users who are in the group. Information 
in group records specifies preferences settings for group members. Group records 
also determine access to files, folders, and computers.
LL2352.Book  Page 20  Friday, August 22, 2003  3:12 PM
Chapter 1    Directory Service Concepts
21
Inside a Directory Domain
Information in a directory domain is organized into record types, which are specific 
categories of records, such as users, computers, and mounts. For each record type, a 
directory domain may contain any number of records. Each record is a collection of 
attributes, and each attribute has one or more values. If you think of each record type 
as a spreadsheet that contains a category of information, then records are like the rows 
of the spreadsheet, attributes are like spreadsheet columns, and each spreadsheet cell 
contains one or more values.
For example, when you define a user by using Workgroup Manager, you are creating a 
user record (a record of the user’s record type). The settings that you configure for the 
user—short name, full name, home directory location, and so on—become values of 
attributes in the user record. The user record and the values of its attributes reside in a 
directory domain.
In some directory services, such as LDAP and Active Directory, record types are called 
object classes or simply classes, and records are called objects. Each class (record type) is 
a set of rules that define similar objects (records) by specifying certain attributes that 
each object must have and certain other attributes that each object may have. For 
example, the inetOrgPerson class defines objects that contain user attributes. The 
inetOrgPerson class is a standard LDAP class defined by RFC 2798. Other standard LDAP 
classes and attributes are defined by RFC 2307.
A collection of attributes and record types or object classes provides a blueprint for the 
information in a directory domain. This blueprint is called the schema of the directory 
domain.
Local and Shared Directory Domains
Where you store your server’s user information and other administrative data is 
determined by whether the data needs to be shared. This information may be stored in 
the server’s local directory domain or in a shared directory domain.
About the Local Directory Domain
Every Mac OS X computer has a local directory domain. A local domain’s administrative 
data is visible only to applications and system software running on the computer 
where the domain resides. It is the first domain consulted when a user logs in or 
performs some other operation that requires data stored in a directory domain.
When the user logs in to a Mac OS X computer, Open Directory searches the 
computer’s local directory domain for the user’s record. If the local directory domain 
contains the user’s record (and the user typed the correct password), the login process 
proceeds and the user gets access to the computer. 
LL2352.Book  Page 21  Friday, August 22, 2003  3:12 PM
22
Chapter 1    Directory Service Concepts
After login, the user could choose “Connect to Server” from the Go menu and connect 
to Mac OS X Server for file service. In this case, Open Directory on the server searches 
for the user’s record in the server’s local directory domain. If the server’s local directory 
domain has a record for the user (and the user types the correct password), the server 
grants the user access to the file services.
When you first set up a Mac OS X computer, its local directory domain is automatically 
created and populated with records. For example, a user record is created for the user 
who performed the installation. It contains the user name and password entered 
during setup, as well as other information, such as a unique ID for the user and the 
location of the user’s home directory. 
About Shared Directory Domains
While Open Directory on any Mac OS X computer can store administrative data in the 
computer’s local directory domain, the real power of Open Directory is that it lets 
multiple Mac OS X computers share administrative data by storing the data in shared 
directory domains. When a computer is configured to use a shared domain, any 
administrative data in the shared domain is also visible to applications and system 
software running on that computer.
If Open Directory does not find a user’s record in the local domain of a Mac OS X 
computer, Open Directory can search for the user’s record in any shared domains to 
which the computer has access. In the following example, the user can access both 
computers because the shared domain accessible from both computers contains a 
record for the user.
Local
directory
domain
Local
directory
domain
Log in to
Mac OS X
Connect to Mac OS X 
Server for file service
Shared
directory
domain
Local
directory
domain
Local
directory
domain
Log in to
Mac OS X
Connect to Mac OS X 
Server for file service
LL2352.Book  Page 22  Friday, August 22, 2003  3:12 PM
Chapter 1    Directory Service Concepts
23
Shared domains generally reside on servers because directory domains store extremely 
important data, such as the data for authenticating users. Access to servers is usually 
tightly restricted to protect the data on them. In addition, directory data must always 
be available. Servers often have extra hardware features that enhance their reliability, 
and servers can be connected to uninterruptible power sources.
Shared directories can also be used to isolate network resources from some users. For 
example, graphic artists in a company might need to work on high-performance 
computers, while copy center personnel can work on computers with standard 
equipment. You could restrict access to the two kinds of computers by setting up user 
records in two shared directory domains. One shared domain would contain records for 
users who work on the high-performance computers. The other shared domain would 
contain records for users who work on the standard computers. Rather than 
configuring user access on each computer individually, you would use Workgroup 
Manager to create all the user records in the two shared domains:  Graphics and Repro. 
When users log in to high-performance computers, user records in the Graphics 
directory domain will be used to authenticate them. Likewise when users log in to 
standard computers, user records in the Repro directory domain will be used to 
authenticate them. A user whose record is in the Repro directory can’t log in to a high-
performance computer. A user whose record in the Graphics directory domain can’t log 
in to a standard computer.
Repro
directory
domain
Graphics
directory
domain
Graphic artists
Copy center personnel
LL2352.Book  Page 23  Friday, August 22, 2003  3:12 PM
24
Chapter 1    Directory Service Concepts
If you wanted some users to be able to log in to any computer, you could create their 
user records in another shared directory domain that all computers can access. 
Shared Data in Existing Directory Domains
Some organizations—such as universities and worldwide corporations—maintain user 
information and other administrative data in directory domains on UNIX or Windows 
servers. Open Directory can be configured to search these non-Apple domains as well 
as shared Open Directory domains of Mac OS X Server systems.
Repro
directory
domain
Company
directory
domain
Graphics
directory
domain
Graphic artists
Copy center personnel
Mac OS 9 user
Mac OS X user
Windows user
Local
directory
Mac OS X Server
Shared
directory
Windows server
Local
directory
Active
Directory
domain
LL2352.Book  Page 24  Friday, August 22, 2003  3:12 PM
Chapter 1    Directory Service Concepts
25
The order in which Mac OS X searches directory domains is configurable. A search 
policy determines the order in which Mac OS X searches directory domains. The next 
chapter discusses search policies.
Access to Directory Services
Open Directory can access directory domains in the following kinds of directory 
services:
• Lightweight Directory Access Protocol (LDAP), an open standard commonly used in 
mixed environments and the native directory service for shared directories in 
Mac OS X Server version 10.3
• NetInfo, the legacy directory service of Mac OS X and Mac OS X Server
• Active Directory, the directory service of Microsoft Windows 2000 and 2003 servers
• Network Information System (NIS), a directory service of many UNIX servers
• BSD flat files, the legacy directory service of UNIX systems
Discovery of Network Services
Open Directory can provide more than administrative data from directories. Open 
Directory can also provide information about services that are available on the 
network. For example, Open Directory can provide information about file servers that 
are currently available.
Open Directory can discover network services that make their existence and 
whereabouts known. Services make themselves known by means of standard 
protocols. Open Directory supports the following service discovery protocols:
• Rendezvous, the Apple protocol that uses multicast DNS for discovering file, print, 
chat, music sharing, and other network services
• AppleTalk, the legacy protocol for discovering file, print, and other network services
File server
File server
Open
Directory
LL2352.Book  Page 25  Friday, August 22, 2003  3:12 PM
26
Chapter 1
    Directory Service Concepts
•
Service Location Protocol (SLP), an open standard for discovering file and print 
services
•
Server Message Block (SMB), the protocol used by Microsoft Windows for file, print, 
and other services
In fact, Open Directory can provide information about network services both from 
service discovery protocols and from directory domains. To accomplish this, Open 
Directory simply asks all its sources of information for the type of information 
requested by a Mac OS X process. The sources that have the requested type of 
information provide it to Open Directory, which collects all the provided information 
and hands it over to the Mac OS X process that requested it.
For example, if Open Directory requests information about file servers, the file servers 
on the network respond via service discovery protocols with their information. A 
directory domain that contains relatively static information about some file servers also 
responds to the request. Open Directory collects the information from the service 
discovery protocols and the directory domains.
When Open Directory requests information about a user, service discovery protocols 
don’t respond because they don’t have user information. (Theoretically, AppleTalk, 
Rendezvous, SMB, and SLP could provide user information, but in practice they don’t 
have any user information to provide.) The user information that Open Directory 
collects comes from whatever sources have it—from directory domains.
File server
File server
Directory 
domain
Open
Directory
LL2352Ov  Page 26  Friday, August 22, 2003  3:23 PM
2
27
2 Open Directory Search Policies
Each computer has a search policy that specifies one or 
more directory domains and the sequence in which 
Open Directory searches them.
Every Mac OS X computer has a local directory domain and can also access shared 
directory domains. Nothing prevents the directory domains from having 
interchangeable records. For example, two directory domains could have user records 
with the same name but other differences. Therefore, each Mac OS X computer needs a 
policy for resolving potential conflicts between equivalent but not identical records.
Each Mac OS X computer has a search policy that specifies which directory domains 
Open Directory can access, such as the computer’s local directory and a particular 
shared directory. The search policy also specifies the order in which Open Directory 
accesses directory domains. Open Directory searches each directory domain in turn 
and stops searching when it finds a match. For example, Open Directory stops 
searching for a user record when it finds a record whose user name matches the name 
it’s looking for.
Search Policy Levels
A search policy can include the local directory alone, the local directory and a shared 
directory, or the local directory and multiple shared directories. On a network with a 
shared directory, several computers generally access the shared directory. This 
arrangement can be depicted as a tree-like structure with the shared directory at the 
top and local directories at the bottom. 
LL2352.Book  Page 27  Friday, August 22, 2003  3:12 PM
28
Chapter 2    Open Directory Search Policies
Local Directory Search Policy
The simplest search policy consists only of a computer’s local directory. In this case, 
Open Directory looks for user information and other administrative data only in the 
local directory domain of each computer. If a server on the network hosts a shared 
directory, Open Directory does not look there for user information or administrative 
data because the shared directory is not part of the computer’s search policy.
Two-Level Search Policies
If one of the servers on the network hosts a shared directory, all the computers on the 
network can include the shared directory in their search policies. In this case, Open 
Directory looks for user information and other administrative data first in the local 
directory. If Open Directory doesn’t find the information it needs in the local directory, 
it looks in the shared directory.
Here’s a scenario in which a two-level search policy might be used:
Local directory domain
Local directory domain
1
Search Policy
Local directory domain
Local directory domain
Shared directory domain
1
2
Search Policy
English class computer
Math class computer
Science class computer
Local directory domain
Local directory domain
Local directory domain
Shared directory domain
1
2
Search Policy
LL2352.Book  Page 28  Friday, August 22, 2003  3:12 PM
Chapter 2    Open Directory Search Policies
29
Each class (English, math, science) has its own computer. The students in each class are 
defined as users in the local domain of that class’s computer. All three of these local 
domains have the same shared domain, in which all the instructors are defined. 