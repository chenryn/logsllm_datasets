In this section, we demonstrate the ability of multiVA to
mitigate ethically launched real-world BGP attacks. This
methodology allows us to understand how multiVA interacts
with real Internet routing. Since we can only launch BGP
attacks from limited number of locations, we complement
this methodology with simulated attacks in Section 6.3 which
yield concurring results.
First, we verify that multiVA properly distinguishes
between the primary and remote VAs, ensuring that all
certiﬁcates signed under multiVA are a subset of what
would be signed without multiVA in place. Second, these
measurements show that an AWS-only deployment detects the
vast majority of attacks (up to 94% of attacks) even though all
remote vantage points are hosted by the same cloud provider.
The security improvements are more signiﬁcant for certain
domains. Furthermore, the small number of BGP attacks that
are able to fool many vantage points are highly visible and,
as such, can be mitigated by other BGP attack-prevention
methods. We discuss how to further enhance security by
adding more vantage points (see §6.3).
5.1 Launching Ethical Attacks
We launched attacks using the PEERING platform [44], which
allows us to make real-world BGP announcements. Our
experimental setup consisted of one adversary server and
one victim server. Each server was connected to a PEERING
Figure 9: The fractions of certiﬁcates that were associated
with differentials and certiﬁcate validation failures over time.
commonly occurring explanation is some customers may
migrate to a new hosting provider that has the proper content
for validation but, once again because of DNS propagation
delay, the remote VAs are given DNS records for the old
hosting provider where the domain control validation content
has not been uploaded.
• Server internal errors. A small fraction (2.0%) of the
differentials were caused by RPC call failures between the
primary and remote VAs.
Effectiveness of quorum policy on reducing certiﬁcate
validation failures. We further study the certiﬁcates that
caused the differentials at remote VAs. Due to the use
of quorum policy, differentials may not necessarily cause
a certiﬁcate validation failure (i.e., certiﬁcate rejection).
For instance, when employing the 2-3 quorum policy as
Let’s Encrypt, even if one remote VA fails to validate
every domain belonging to a certiﬁcate, multiVA would
still consider the certiﬁcate validation a success (if the
primary VA and the other two remote VAs have completed
the validation successfully) and issue the certiﬁcate. To
demonstrate the effectiveness of quorum policy on reducing
certiﬁcate validation failures, we show the fractions of the
validated certiﬁcates that were associated with differentials
and certiﬁcate validation failures on each day in Figure 9.
The quorum policy has reduced the daily certiﬁcate validation
failure rate by 50% on average.
Though each day about 1% of certiﬁcates were temporarily
rejected due to differentials, many domain owners have retried
validation and eventually had their certiﬁcates signed by Let’s
Encrypt after retrying by the end of Sep 22, 2020. As shown
in Figure 10, about 50% of the certiﬁcates rejected on Sep 03,
2020 have been issued successfully gradually over time. Of
all certiﬁcates that have been validated in 20 days (36.8 M),
only 0.65% failed to get signed because of differentials.
Overall, multiVA has little impact on validation latency and
introduces low bandwidth overhead. Considering the high
failure rate of the primary VAs (over 65% without multiVA),
USENIX Association
30th USENIX Security Symposium    4319
2020-09-032020-09-042020-09-052020-09-062020-09-072020-09-082020-09-092020-09-102020-09-112020-09-122020-09-132020-09-142020-09-152020-09-162020-09-172020-09-182020-09-192020-09-202020-09-212020-09-220123Percentage(%)WithvalidationfailuresWithdiﬀerentialsUniversity (neu01) mux as the adversary, as shown in
Figure 11. We started by making a BGP announcement
from the victim’s server for an IP preﬁx we controlled. We
then had the adversary server hijack the victim’s IP preﬁx
by announcing it to neu01 in an equally-speciﬁc preﬁx
hijack attack. Then, we used the adversary server to request
a certiﬁcate for the victim’s domain. Let’s Encrypt did
not authorize the certiﬁcate because the remote vantage
points caught the attack. Additionally, system logs from
the adversary server indicated that the primary data centers
were routing data to the adversary and this attack would
have succeeded without multi-vantage-point domain control
validation.
5.3 Characterization of Attack Mitigation
Considering other potential adversaries. To expand
beyond a single (victim, adversary) pair, we considered
the set of all possible adversaries (i.e., other PEERING
muxes) attacking the victim domain hosted by wisc01 to
ﬁnd how many attacks were prevented by multiVA. When
Let’s Encrypt only uses a single data center (i.e., without
the multiVA approach), the victim’s domain was only
resilient to one in six attacks (17%) we launched against
it. With multiVA in place, the victim’s domain was
resilient to ﬁve of the six attacks (85%). These additional
attacks were detected by Let’s Encrypt’s AWS-hosted remote
vantage points using the k-n quorum policy.
Considering a broader set of domains. Next, we further
varied our attacks by selecting different available PEERING
muxes for the victim and the adversary. Overall, we launched
attacks from 62 different experiment conﬁgurations, and
analyzed multiVA security with different quorum policies.
With Let’s Encrypt’s quorum policy, 67% of the attacks
we launched failed to obtain certiﬁcates (i.e., the domain
was resilient to attack). This is signiﬁcantly higher than
the 48% of attacks mitigated using Let’s Encrypt’s previous
single-data-center conﬁguration. We note that the multiVA
deployment has a larger impact on some of the weakest
domains which are most vulnerable to BGP attacks (like the
victim domain in wisc01 explored above that saw a ﬁvefold
improvement). In fact, ten of the attacks detected by multiVA
under Let’s Encrypt’s quorum policy were against three highly
impacted victim domains that on average saw fraction of
attacks mitigated increase from 20% to 72%. We explore this
trend in greater depth in Section 6.3.
While Let’s Encrypt’s current quorum policy offers
substantial improvement for the most vulnerable domains,
a full quorum policy is more effective at protecting the
average domain. 58 out of 62 attacks (94%) were detected
by multiVA with full quorum policy of k=3. This result
demonstrates that, even if a single cloud provider is used to
Figure 11: The experimental setup with the PEERING testbed.
The victim makes BGP announcements via the University
of Wisconsin - Madison (wisc01) mux, while the adversary
hijacks the preﬁx using the North Eastern University (neu01)
mux. With this setup, we measured that the Salt Lake City
and Denver data centers (along with the Frankfurt remote
vantage point) routed validation requests to the adversary,
but the Oregon and Ohio remote vantage points were able to
reach the legitimate domain and, hence, thwart the attack.
mux [44] through a VPN tunnel which it used to forward
packets and make BGP announcements. Our experiments
consisted of ﬁrst the victim announcing its preﬁx through a
designated PEERING mux. Next, the adversary subsequently
hijacks that preﬁx from a different PEERING mux (see
Figure 11) and requests a certiﬁcate from Let’s Encrypt for the
victim’s domain (that has an A DNS record within the victim’s
preﬁx). Our experiments focus on BGP attacks with equally-
speciﬁc preﬁxes (where the victim and adversary announce
the same IP preﬁx) because sub-preﬁx attacks are not viable
against all domains (like those running on a /24), are easily
noticed by route monitors due to global distribution [11, 13],
and are mitigated by deployed BGP security proposals [24].
Ethical considerations. We took several steps to ensure our
attacks were ethical. The domains we used had no real users
and were pointed to IP addresses in the preﬁxes allocated to
us by the PEERING framework (that similarly ran no network
services other than those needed for the experiment). We only
requested certiﬁcates for these domains that were registered
for the express purpose of conducting our experiments.
We also followed all of the policies and guidelines of the
PEERING framework including not announcing any preﬁxes
other than the preﬁxes allocated to us and not spooﬁng packets
from IP preﬁxes outside of the PEERING framework range.
5.2 Example of Successful Attack Mitigation
To demonstrate how multiVA mitigates real-world BGP
attacks, we used the University of Wisconsin - Madison
(wisc01) mux for the victim’s domain and North Eastern
4320    30th USENIX Security Symposium
USENIX Association
Adversary ServerVictim Server neu01wisc01SLC/DenverFrankfurtOregonOhioVPNVPNhost all remote VAs for ease of management, multiVA can
signiﬁcantly reduce the attack surface of BGP attacks.
The four attacks where the Let’s Encrypt vantage points
were unable to reach the victim were attacks where the
adversary signiﬁcantly overpowered the victim from the
perspective of network connectivity. For example, two of
these attacks used the PEERING mux in Amsterdam as the
adversary. This location has substantially richer connectivity
than any other PEERING mux (it is the only mux with two
providers and it has substantially more peers than any other
mux). While these results shed light on the limits of multiVA,
in that certain AS-level adversaries may still succeed, overall,
our approach signiﬁcantly reduces the number of viable BGP
attacks against domain validation. Furthermore, the number of
attacks that still succeed can be reduced by simply deploying
a small number of additional vantage points (as discussed in
Section 6.3).
6 Quantifying the Security of multiVA
While our evaluation in Section §5 used real-world BGP
attacks, we were limited to considering PEERING muxes
as target domains and adversary locations (which may not be
representative). In this section we evaluate the security of the
multiVA deployment with respect to (i) real-world domains
served by Let’s Encrypt and (ii) any AS-level adversary. We
use a combination of Internet-scale traceroutes and Internet
topology simulations to evaluate system security. We focus
our security analysis on the following questions:
• How effective is Let’s Encrypt’s current quorum policy
and set of vantage points at catching localized BGP
attacks on domain control validation?
• How many more attacks would be caught under a
full/strict quorum policy that uses results from all three
remote VAs?
• How much would additional vantage points enhance
security, and where should these remote VAs be located?
6.1 Evaluation Methodology
We ﬁrst introduce the primary dataset we collected to facilitate
our analysis, and discuss the analysis techniques we used.
Domain dataset. By parsing log data shared with us by
Let’s Encrypt, we collected 47 million domains seen in the
Subject Alternative Name (SAN) ﬁeld of certiﬁcates issued by
Let’s Encrypt between April 13th and May 13th, 2018. For
each domain, we also collected the IP address Let’s Encrypt
used for HTTP and TLS-based domain control validation. 43
million domains used HTTP and TLS-based domain control
validation to IPv4 and were used in our ﬁnal data set.
An overview of evaluation methodology. To strike a bal-
ance between capturing the dynamics of real Internet routing
and the ﬂexibility of simulations, we used two different
techniques, traceroutes and Internet-topology simulations, to
evaluate the security (i.e., the fraction of attacks detected by
the system) provided by Let’s Encrypt’s vantage points:
• Traceroutes: We ran traceroutes to the IP addresses of
the domains in the data set from the three AWS locations
used by Let’s Encrypt. We recorded the percentage of
AS-level paths that were identical across the data centers.
These measurements allow us to study the routes to real
domains and weigh our results based on the number of
domains that are reached via a given route.
• Internet-topology simulations: We ran simulations of
BGP hijacks against domains on an inferred Internet
topology, augmented with information about differences
in connectivity across AWS data centers. This allowed
us to better understand the location of Let’s Encrypt’s
vantage points relative to both the locations of domains
using the PKI and potential sources of BGP attacks.
The traceroute experiments allow us to study real Internet
routing to real domains (albeit in the absence of BGP attacks),
while the simulation experiments allow us to study the effects
of BGP attacks (albeit under an inferred Internet topology).
Together, these results help us understand the effectiveness
of multiVA across a diverse set of source vantage points,
destination victim domains, and possible adversaries.
6.2 Traceroute Path Diversity of Remote VAs
Next, we assess the path diversity of vantage points with
respect to the real-world distribution of domains. We perform
traceroutes from Let’s Encrypt’s vantage points towards the
domains in the dataset and use traceroute similarity across
vantage points as a metric for path diversity.
Of the 43M domains in our domain dataset, we performed
traceroutes to a randomly chosen 250K (0.6%) sample. For a
given domain, we traced the route to the domain’s IP address
used by Let’s Encrypt. There were 67K unique IP addresses
in total. We performed these traceroutes from the three Let’s
Encrypt remote vantage points (Oregon, Ohio, and Frankfurt).
We resolved each IP address seen in the traceroute results to
an ASN using 1) the originating AS of that IP address in the
current global BGP routing table (compiled from RIPE NCC
RIS [11] and Routeviews [13]), followed by 2) the originating
AS listed in the whois record for that IP address (for IP
addresses that were not currently routeable). We ﬁltered the
traceroute results to exclude any traceroute that did not have
any IP addresses resolve to an ASN other than the ASN
of Let’s Encrypt’s vantage points. We were left with valid
traceroutes to 192K domains.
USENIX Association
30th USENIX Security Symposium    4321
197,054
191,653
VP comb. #Valid domain Distinct paths Same path
All three
153,048 (80%) 38,605 (20%)
Ohio-
Oregon
Oregon-
Frankfurt
Ohio-
Frankfurt
119,914 (61%) 77,140 (39%)
138,202 (70%) 58,374 (30%)
140,815 (72%) 55,554 (28%)
196,576
196,369
Table 12: The number of domains with different levels of
traceroute similarities for each pair/trio of vantage points.
Percentages are taken in comparison to number of domains
with full traceroute info (i.e., “Valid domain” in the table).
For each domain, we measured traceroute similarity
between the different vantage points by seeing if the
traceroutes from the different vantage points had the same
AS-level forwarding path. We classiﬁed each domain as either
having similar or different AS-level paths.
A single cloud provider can offer path diversity. Table 12
outlines our results. We ﬁnd that for 80% of domains with
traceroute information were reached via different AS-level
forwarding paths from different vantage points. Even for
the 20% of domains that have the same paths, intra-AS
routing differences might still allow vantage points to route
independently in the event of a BGP hijack.
Ohio and Oregon had signiﬁcantly more domains using
similar paths than Ohio and Frankfurt or Oregon and
Frankfurt. This result supports the importance of geographic
diversity in vantage points and explains the security
improvements seen in §5.3 for the full quorum policy. We
expect other cloud providers to have similarly diverse routing,