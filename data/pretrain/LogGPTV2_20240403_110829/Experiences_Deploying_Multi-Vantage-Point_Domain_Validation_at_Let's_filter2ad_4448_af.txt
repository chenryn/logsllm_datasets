by Brandt et al. [23] and the use of multiple vantage points
to validate keys for Trust On First Use (TOFU) applications
was investigated by Wendlandt et al. [55]. Concurrent with
our efforts, CloudFlare has also released an experimental API
for performing domain validation using multiple CloudFlare
vantage points [33]. To the best of our knowledge, their API is
not in use by any CA, and our work is the ﬁrst to demonstrate
the feasibility of multi-vantage-point domain validation at
Internet scale with successful issuance of over half a billion
TLS certiﬁcates. Another thread of research has focused on
transparency frameworks like Certiﬁcate Transparency [35]
which aim to provide global visibility into TLS certiﬁcates
issued by CAs. Certiﬁcate Transparency logs allow domain
owners to detect that fraudulent TLS certiﬁcates were issued
for their domain, but user communications remain vulnerable
until those certiﬁcates are revoked (a process that is itself
error prone). In contrast, our approach of multi-vantage-point
validation aims to prevent the issuance of bogus certiﬁcates.
8 Conclusion
We explored the design space of multi-vantage-point domain
validation and showed the feasibility of balancing multiple
objectives such as security, manageability, performance, and
benign failures. Our deployment at Let’s Encrypt, which has
secured the issuance of over half a billion TLS certiﬁcates,
demonstrates the viability of multi-vantage-point domain
validation at Internet scale. We make the following concluding
recommendations:
• Testing multiVA deployments. As other CAs start
to adopt this technology, we recommend using our
evaluation methodology (such as our open-source
BGP simulation framework) to guide the selection
of sufﬁciently diverse vantage points and validate the
overall deployment.
Acknowledgments
We would like to thank Let’s Encrypt for their extensive
collaboration in this project. We are particularly grateful to the
Let’s Encrypt site reliability engineering team for facilitating
our data collection, the engineers that worked to integrate
multiVA, and Josh Aas for his feedback on the paper and
collaboration on our Open Technology Fund and International
Republican Institute grants. Additionally, we want to thank
Amogh Dhamdhere for his assistance with the bdrmap tool
and the PEERING testbed team for helping to facilitate our
ethical BGP attacks. We are also grateful for support from
the Open Technology Fund and International Republican
Institute through their Securing Domain Validation project,
the National Science Foundation under grant CNS-1553437
and CNS-1704105, and DARPA under grant FA8750-19-C-
007. Finally, we would like to thank the USENIX Security
reviewers for their feedback and Paul Pearce for shepherding
our paper.
References
[1] China will
block VPN access
for
individuals,
Government.
the
register with
companies must
https://www.neowin.net/news/china-will-block-
vpn-access-for-individuals-companies-must-
register-with-the-government, Jul 2017.
[2] Amazon PeeringDB. https://www.peeringdb.com/net/
1418, Feb 2021.
[3] Boulder.
Feb 2021.
https://github.com/letsencrypt/boulder,
[4] The CAIDA AS relationships dataset (March) 2020. http:
//www.caida.org/data/as-relationships/, 2021.
[5] Certbot. https://certbot.eff.org/, Feb 2021.
[6] GitHub letsencrypt/boulder va/va.go. https://github.com/
letsencrypt/boulder/blob/main/va/va.go, 2021.
[7] gRPC: A high-performance, open source universal RPC
framework. https://grpc.io/, Feb 2021.
[8] Let’s Encrypt Certiﬁcates Issued Per Day.
https://
letsencrypt.org/stats/#daily-issuance, 2021.
[9] MANRS Project Homepage.
https://www.manrs.org/,
2021.
• Industry-wide adoption. All certiﬁcate authorities should
consider adopting multi-vantage-point domain validation
to secure TLS certiﬁcate issuance, and we would like to
approach more CAs to discuss potential deployment.
[10] Merkle town. https://ct.cloudflare.com, 2021.
[11] RIS raw data – RIPE network coordination centre. https:
//www.ripe.net/analyse/internet-measurements/
routing-information-service-ris/ris-raw-data,
2021.
USENIX Association
30th USENIX Security Symposium    4325
[12] ThousandEyes: Network intelligence software. https://www.
thousandeyes.com/, 2021.
[13] University of Oregon Route Views Project. http://www.
[28] L. Gao and J. Rexford.
Stable Internet routing without
global coordination. IEEE/ACM Transactions on Networking,
9(6):681–692, Dec 2001.
routeviews.org/routeviews/, 2021.
[29] A. Gavrichenkov. Breaking HTTPS with BGP hijacking. Black
[14] Use BGPmon to monitor your preﬁxes and assess the risks to
your network. https://bgpmon.net/, 2021.
[15] J. Aas, R. Barnes, B. Case, Z. Durumeric, P. Eckersley,
A. Flores-López, J. A. Halderman, J. Hoffman-Andrews,
J. Kasten, E. Rescorla, et al. Let’s Encrypt: An automated
certiﬁcate authority to encrypt the entire web. In ACM SIGSAC
Conference on Computer and Communications Security, pages
2473–2487, 2019.
[16] M. Alicherry and A. D. Keromytis. DoubleCheck: Multi-
path veriﬁcation against man-in-the-middle attacks. In IEEE
Symposium on Computers and Communications, pages 557–
563. IEEE, 2009.
[17] M. Apostolaki, A. Zohar, and L. Vanbever. Hijacking Bitcoin:
Routing attacks on cryptocurrencies. In IEEE Symposium on
Security and Privacy. IEEE, 2017.
[18] H. Ballani, P. Francis, and X. Zhang. A study of preﬁx
hijacking and interception in the internet. In ACM SIGCOMM,
pages 265–276, 2007.
[19] R. Barnes, J. Hoffman-Andrews, D. McCarney, and J. Kasten.
Automatic certiﬁcate management environment (ACME). RFC
8555, RFC Editor, March 2019.
[20] D. Basin, C. Cremers, T. H.-J. Kim, A. Perrig, R. Sasse,
and P. Szalachowski. Design, analysis, and implementation
of ARPKI: An attack-resilient public-key infrastructure.
IEEE Transactions on Dependable and Secure Computing,
15(3):393–408, 2016.
[21] H. Birge-Lee, Y. Sun, A. Edmundson, J. Rexford, and P. Mittal.
Bamboozling certiﬁcate authorities with BGP. In USENIX
Security Symposium, pages 833–849, Baltimore, MD, 2018.
USENIX Association.
[22] R. Brandom. Hackers emptied Ethereum wallets by breaking
https://www.
the basic infrastructure of the internet.
theverge.com/2018/4/24/17275982/myetherwallet-
hack-bgp-dns-hijacking-stolen-ethereum, Apr. 2018.
[23] M. Brandt, T. Dai, A. Klein, H. Shulman, and M. Waidner.
Domain validation++ for MitM-resilient PKI. In ACM SIGSAC
Conference on Computer and Communications Security, pages
2060–2076, 2018.
[24] R. Bush and R. Austein. The resource public key infrastructure
(RPKI) to router protocol. RFC 6810, RFC Editor, January
2013.
[25] CA/Browser Forum. Baseline Requirements for the Issuance
and Management of Publicly-Trusted Certiﬁcates, v.1.5.4, Oct
2017.
[26] C. C. Demchak and Y. Shavitt. China’s maxim – leave no
access point unexploited: The hidden story of China Telecom’s
BGP hijacking. Military Cyber Affairs, 3, 2018.
[27] J. Durand, I. Pepelnjak, and G. Doering. BGP operations and
security. IETF RFC 7454-Best Current Practice, 2015.
Hat USA Brieﬁngs, 2015.
[30] Y. Gilad, A. Herzberg, and H. Shulman. Off-path hacking: The
illusion of challenge-response authentication. IEEE Security
Privacy, 12(5):68–77, 2014.
[31] S. Goldberg, M. Schapira, P. Hummon, and J. Rexford. How
secure are secure interdomain routing protocols? In ACM
SIGCOMM, pages 87–98, 2010.
[32] T. Hlavacek, I. Cunha, Y. Gilad, A. Herzberg, E. Katz-Bassett,
M. Schapira, and H. Shulman. DISCO: Sidestepping RPKI’s
In Network and Distributed Systems
deployment barriers.
Security Symposium (NDSS), 2020.
[33] D. Kozlov and G. Fisher.
Securing Certiﬁcate
Issuance using Multipath Domain Control Validation.
https://blog.cloudflare.com/secure-certificate-
issuance/, 2019.
[34] M. Lad, R. Oliveira, B. Zhang, and L. Zhang. Understanding
resiliency of Internet topology against preﬁx hijack attacks. In
IEEE/IFIP International Conference on Dependable Systems
and Networks, pages 368–377, 2007.
[35] B. Laurie. Certiﬁcate transparency. Communications of the
ACM, 57(10):40–46, 2014.
[36] M. Lepinski and K. Sriram. BGPsec protocol speciﬁcation.
RFC 8205, RFC Editor, September 2017.
[37] Let’s Encrypt. Validating challenges from multiple network
vantage points. https://community.letsencrypt.org/
t/validating-challenges-from-multiple-network-
vantage-points/40955, 2017.
[39] D. Madory.
[38] M. Luckie, A. Dhamdhere, B. Huffaker, D. Clark, and k. claffy.
bdrmap: Inference of Borders Between IP Networks. In ACM
Internet Measurement Conference, pages 381–396, Nov 2016.
Excessive BGP AS Path prepending is a
Oracle Internet Intelligence,
self-inﬂicted vulnerability.
https://blogs.oracle.com/internetintelligence/
excessive-as-path-prepending-is-a-self-
inflicted-vulnerability, Jul 2019.
[40] O. Nordström and C. Dovrolis. Beware of BGP attacks.
ACM SIGCOMM Computer Communication Review, 34(2):1–
8, 2004.
[41] Proton. Statement regarding BGP hijacking on September
https://protonmail.com/blog/bgp-hijacking-
29.
september-2020/, 2020.
[42] A. Robachevsky.
14,000 Incidents: A 2017 Routing
Security Year in Review. https://www.internetsociety.
org/blog/2018/01/14000-incidents-2017-routing-
security-year-review/, 2018.
[43] F. Rochet, R. Wails, A. Johnson, P. Mittal, and O. Pereira.
CLAPS: Client-location-aware path selection in Tor.
In
ACM SIGSAC Conference on Computer and Communications
Security, pages 17–34, 2020.
4326    30th USENIX Security Symposium
USENIX Association
[44] B. Schlinker, T. Arnold, I. Cunha, and E. Katz-Bassett.
In
PEERING: Virtualizing BGP at the edge for research.
ACM SIGCOMM CoNEXT Conference, 2019.
[45] P. Sermpezis, V. Kotronis, P. Gigis, X. Dimitropoulos,
D. Cicalese, A. King, and A. Dainotti. ARTEMIS: Neutralizing
BGP Hijacking within a Minute. IEEE/ACM Transactions on
Networking, 26(6):2471–2486, Dec 2018.
[46] R. Shoemaker. ACME TLS ALPN challenge extension.
Internet-Draft draft-ietf-acme-tls-alpn-01, IETF Secretariat,
May 2018.
http://www.ietf.org/internet-drafts/
draft-ietf-acme-tls-alpn-01.txt.
[47] R. Shoemaker. Automated Certiﬁcate Management Environ-
ment (ACME) TLS Application-Layer Protocol Negotiation
(ALPN) Challenge Extension.
RFC 8737, RFC Editor,
February 2020.
[48] A. Siddiqui. Not just another BGP Hijack. https://www.
manrs.org/2020/04/not-just-another-bgp-hijack/,
2020.
[49] J. Snijders. Practical everyday BGP ﬁltering with AS_PATH
ﬁlters: Peer locking. NANOG-67, 2016.
[50] Y. Sun, A. Edmundson, N. Feamster, M. Chiang, and P. Mittal.
Counter-RAPTOR: Safeguarding Tor against active routing
attacks. In IEEE Symposium on Security and Privacy (SP),
pages 977–992, May 2017.
[51] Y. Sun, A. Edmundson, N. Feamster, M. Chiang, and P. Mittal.
Counter-RAPTOR: Safeguarding Tor against active routing
attacks. In IEEE Symposium on Security and Privacy (SP),
pages 977–992. IEEE, 2017.
[52] Y. Sun, A. Edmundson, L. Vanbever, O. Li, J. Rexford,
M. Chiang, and P. Mittal. RAPTOR: Routing attacks on privacy
in Tor. In USENIX Security Symposium, pages 271–286, 2015.
[53] E. Syta, I. Tamas, D. Visher, D. I. Wolinsky, and B. Ford. De-
centralizing authorities into scalable strongest-link cothorities.
CoRR, abs/1503.08768, 2015.
[54] P. Szalachowski, S. Matsumoto, and A. Perrig. PoliCert: Secure
and ﬂexible TLS certiﬁcate management. In ACM SIGSAC
Conference on Computer and Communications Security, pages
406–417, 2014.
[55] D. Wendlandt, D. G. Andersen, and A. Perrig. Perspectives:
Improving SSH-style host authentication with multi-path
probing. In USENIX Annual Technical Conference, volume 8,
pages 321–334, 2008.
[56] X. Zhang, H. C. Hsiao, G. Hasker, H. Chan, A. Perrig, and
D. G. Andersen. SCION: Scalability, control, and isolation on
next-generation networks. In IEEE Symposium on Security
and Privacy, pages 212–227, May 2011.
A Appendix
A.1 Details of API Calls in multiVA
MultiVA is implemented in the source code of the Validation
Authority (VA) module (see [6]) in Boulder and does not
require any changes to other modules (e.g., the Registration
Authority that handles interactions with customers or the Web
Front End that serves the publicly-accessible API endpoints).
All API calls between different components (including
both co-located components in the same data center and
remote components like the remote VAs) go through gRPC
which offers conﬁdentiality and integrity via mutually-
authenticated TLS streams as well as load balancing through
DNS-based component discovery. MultiVA is initiated when
the Registration Authority (RA) requests validation be
performed and calls the PerformValidation method at the
VA (via gRPC) which takes the domain being validated
and the challenge information as arguments and returns if
the validation is successful. Then, using gRPC, the primary
VA asynchronously calls the same “PerformValidation”
method at all of the remote VAs. Subsequently it begins
its own validation. After the primary validation completes
successfully, the primary VA counts the number of successful
remote validations and blocks until either quorum is reached
or enough errors occur such that quorum cannot be achieved.
Then, depending on the results and the quorum policy, the
primary VA returns the validation result to the RA.
By using this model, only the VA needs to be changed and
the already-existing gRPC layer can be easily extended to
allow for secure communication with the remote VAs.
USENIX Association
30th USENIX Security Symposium    4327