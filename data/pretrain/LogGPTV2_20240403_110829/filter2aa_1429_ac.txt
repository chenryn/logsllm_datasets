More than 90% of the web applications (including online banking sites) 
were designed in a way that will reset their cookie/session timeout 
counter whenever there is user activity
•
When attackers employ MITM together this method to online banking 
Sunday, 10 August, 2008 Page 25
sites, they are able to maintain the session for a very long time (hours, 
days, weeks or even months!)
•
Logic flaw or convenience feature? You decide ☺
How to reduce the chances of LSR attack?
•
Financial related web applications must be designed in a way that 
users are only allowed to perform transaction in a fixed amount of time 
in each login. NEVER RESET THE SESSION TIMEOUT VALUE!
Existing phishing identification techniques
•
Domain name age checking
•
Registrar information from WHOIS
•
Hostname resolved IP address (comparison with real site)
•
Suspicious IFRAME with tiny width and height
Sunday, 10 August, 2008 Page 26
•
Suspicious IFRAME with tiny width and height
•
Suspicious URL or encodings used in URL
•
Similar HTML / Javascript source with legitimate website
•
SSL certificate validation
Approach used by website blocker / filter
Blacklisting - Identify the bad sites with blacklisted URL database
•
Receive phishing reports from public (Eg. PhishTank)
•
Automated crawler to find suspicious domain names and websites
•
Exchange phishing URLs with security vendor partners
Sunday, 10 August, 2008 Page 27
•
Exchange phishing URLs with security vendor partners
•
Block blacklisted URLs with tools installed on client machine
Disadvantages of blacklisting approach
•
Unable to identify unreported phishing websites in the wild
•
Client side has to keep updated with latest blacklisted URL DB
•
Efficiency issue as the amount of blacklisted URL grows
Sunday, 10 August, 2008 Page 28
How can we improve it better?
Step 1: Identify the 
visual similarity of 
rendered website 
with legitimate  
banking websites
IF SIMILAR, 
CONTINUE TO 
STEP 2
Step 6: Compare the 
data obtained from 
Step 2-5 with the 
pre-analyzed 
information of 
original 
banking/financial 
website
1.Identify the visual similarity of rendered website
with legitimate website
2.Check target web server/site characteristics for
identification (WEBSITE FINGERPRINTING!)
3.Check target URL’s domain name age
4.Check target URL’s similarity with legitimate URL
Whitelisting approach
Sunday, 10 August, 2008 Page 29
Step 2: Target web 
server/site 
characteristics for 
identification 
(WEBSITE 
FINGERPRINTING!)
Step 3: Target URL’s 
domain name age 
checking
Step 4: Target URL 
similarity and 
encoding
Step 5: Target 
website content 
analysis for 
suspicious 
characteristics
4.Check target URL’s similarity with legitimate URL
and suspicious encoding
5.Check target website’s content for suspicious
characteristics
6.Compare the data obtained from Step 2-5 with
the
pre-analyzed
information
of
original
banking/financial website
Website Finger Printing… Uhmm…
•
Collect information about target web server / site
•
Get geolocation of target website from IP address
•
Nmap does OS fingerprinting from TCP/IP stack characteristics, we do it from 
HTTP response characteristics
•
Collect information about original web server / site as well
Sunday, 10 August, 2008 Page 30
•
Get geolocation of the real website from IP address
•
Now what? Compare!
When any of the server or website characteristics such server type, server 
version, server date / time, last modified date, etc. mismatch, it smells…
PHISHY!
Identifying visual similarity of a website
Simple approach to create signature for web appearance
1.
Take screenshot image of a rendered website
2.
Calculate the mean values for red, green and blue of the image
3.
Use the RGB mean values as ‘website appearance signature’
paypal.png - Screenshot of the real PayPal website
messed.png – Messed up image modified from paypal.png
Sunday, 10 August, 2008 Page 31
paypal.png - Screenshot of the real PayPal website
messed.png – Messed up image modified from paypal.png
Red: 226.26349166666665
Green: 232.64016333333333
Blue: 236.67534166666667
Red: 226.26936333333333
Green: 232.64310833333334
Blue: 236.67663166666668
[MEAN VALUES]
[MEAN VALUES]
Identifying visual similarity of a website
fake.png – Screenshot of fake PayPal website
[with contrast and brightness level purposely tweaked]
2checkout.png – Screenshot of the real 2Checkout.com website
Sunday, 10 August, 2008 Page 32
Red: 225.603835
Green: 231.98625166666667
Blue: 236.01825500000001
Red: 207.40960000000001
Green: 220.19798166666666
Blue: 213.34901500000001
[MEAN VALUES]
[MEAN VALUES]
r1 – Red color mean value of image-1,
r2 – Red color mean value of image-2
g1 – Green color mean value of image-1,
g2 – Green color mean value of image-2
b1 – Blue color mean value of image-1,
b2 – Blue color mean value of image-2
rDiff = | ( ( r1 – r2 ) / 256 ) |
gDiff = | ( ( r1 – r2 ) / 256 ) |
bDiff = | ( ( r1 – r2 ) / 256 ) |
Therefore,
100 – ((rDiff + gDiff + bDiff) * 100) = % of similarity
Example calculation:
Identifying visual similarity of a website
Sunday, 10 August, 2008 Page 33
Difference of paypal.png and messed.png
rDiff = |((226.26349166666665 - 226.26936333333333) / 256)| = 0.00002293619791671875
gDiff = |((232.64016333333333 - 232.64310833333334) / 256)| = 0.0000115039062500390625
bDiff = |((236.67534166666667 - 236.67663166666668) / 256)| = 0.0000050390625000390625
100 – (0.000039479166666796875 * 100) = 99.9960520833333203125 % similar
Difference of paypal.png and fake.png
rDiff = |((226.26349166666665 - 225.603835) / 256)| = 0.0025767838541666015625
gDiff = |((232.64016333333333 - 231.98625166666667) / 256)| = 0.002554342447916640625
bDiff = |((236.67534166666667 - 236.01825500000001) / 256)| = 0.002566744791666640625
100 – (0.0076978710937498828125 * 100) = 99.23021289062501171875 % similar
Difference of paypal.png and 2checkout.png
rDiff = |((226.26349166666665 - 207.40960000000001) / 256)| = 0.0736480143229165625
gDiff = |((232.64016333333333 - 220.19798166666666) / 256)| = 0.0486022721354166796875
bDiff = |((236.67534166666667 - 213.34901500000001) / 256)| = 0.091118463541666640625
100 – (0.2133687499999998828125 * 100) = 78.66312500000001171875 % similar
Example of a basic anti-phishing system
Sunday, 10 August, 2008 Page 34
Advantages of ‘web appearance signature’
•
Easier to obtain signatures of legitimate sites
•
Able to detect unknown or “zero-day” phishing websites
Sunday, 10 August, 2008 Page 35
Demo
Sunday, 10 August, 2008 Page 37