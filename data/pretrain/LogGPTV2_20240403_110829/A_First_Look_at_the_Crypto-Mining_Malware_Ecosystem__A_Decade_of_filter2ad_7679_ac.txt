### Operators and the Spread of Malware

Operators often use various tactics to distribute their malware [33]. The commoditization of cybercrime services has made it relatively simple for individuals with minimal technical skills to purchase a botnet for malware distribution, often through underground markets [34].

During our analysis, we identified samples from several commonly used botnets, such as Virut and Nitol, which are frequently employed in pay-per-install (PPI) services. Since these are well-known third-party infrastructures, samples using these services may not be directly related to each other and are therefore not aggregated.

### Stock Mining Software

Our exploratory analysis revealed that many campaigns utilize stock mining software. This means that the hash of a file dropped by the malware matches one of the hashes in our collection of known mining tools. In some cases, the malware fetches the executable directly from an official GitHub repository. However, we also observed instances where malicious actors fork these projects and make minor modifications, such as removing donation capabilities.

To detect these modifications, we employ Fuzzy Hashing (FH), a similarity-preserving hash function that allows for the comparison of binary files. FH computes a fingerprint of each binary in such a way that nearly identical binaries map to similar hash values. Fuzzy hashing has been shown to be effective in comparing malware [35]. In our pipeline, we use context-triggered piecewise hashing [36] and compute the distance between the FH of all samples in a campaign and the FH of all known mining tools. We set a conservative distance threshold of 0.1, which is suitable for comparing malware [35]. Samples with a distance lower than 0.1 are considered to be stock mining tools.

### Data Extracted for Each Sample

| **Field** | **Description** |
| --- | --- |
| **Name** | SHA256 hash value of the sample |
| **POOL** | Normalized name of the mining pool |
| **URLPOOL** | URL to which the sample mines |
| **USER** | Identifier used to mine in the pool |
| **PASS** | Password used to authenticate in the pool |
| **NTHREADS** | Number of CPU threads used for mining |
| **AGENT** | User agent used for mining |
| **DSTIP** | IP to which the sample mines |
| **DSTPORT** | Port used for mining |
| **DNSRR** | DNS resolutions |
| **SOURCE** | Data feeds from which the data was obtained |
| **FS** | Date when the sample was first seen |
| **ITW URL** | URLs hosting or contacted by the sample |
| **PACKER** | Associated packer used for obfuscation, if any |
| **POSITIVES** | Number of positive detections by antivirus* |
| **TYPE** | Either Miner or Ancillary |

*Note: The number of AV detecting this malware might increase over time. The released dataset contains the number of positives as of April 2019.

### Data Extracted for Each Wallet

| **Field** | **Description** |
| --- | --- |
| **Name** | Mining pool |
| **POOL** | Wallet identifier |
| **HASHES** | Number of hashes shared |
| **HASHRATE** | Last hash rate |
| **LAST SHARE** | Date of the last hash |
| **BALANCE** | Total balance (not paid) |
| **TOTAL PAID** | Total XMR paid |
| **NUM PAYMENTS** | Number of payments |
| **DATE QUERY** | Date of last query |
| **USD** | Estimated total paid value in USD |

In addition to this, for each wallet, we also account for the payments and timestamps extracted from all transparent pools. For the minexmr pool, we track the historical hash rate of the wallets.

### Summary of Data Extracted

- **Table I**: Summarizes the data extracted from each sample.
- **Table II**: Summarizes the data extracted for each XMR wallet and each mining pool.

### Binary-Based Mining Threat Analysis

#### A. Dataset

Our study is based on the collection of 4.5 million malware samples from various sources described in §III-A. After applying sanity checks, we narrowed down the dataset to:

- **Miner Binaries**: 1,017,110 samples
- **Ancillary Binaries**: 212,923 samples

The miner binaries include samples with observed mining capabilities, associated wallets, and pool addresses. The ancillary binaries are used by miners to support the mining operation (e.g., bot clients or loaders). In total, our study leverages over 1.2 million crypto-mining malware samples. Table III provides a summary of our dataset, including the breakdown of data sources and the types of resources used.

#### B. Longitudinal Analysis

We extracted 16,050 different crypto-mining identifiers from 103,894 samples. These identifiers primarily consist of wallet addresses from various cryptocurrencies, but also include emails and other identifiers used for authentication in mining pools. We used regular expressions to detect the associated currency for wallet addresses. For emails, we found that 97% are used as identifiers for one of the most popular mining pools, Minergate.

Overall, we aggregated the samples into 11,387 different campaigns. Figure 4 shows the Cumulative Distribution Function (CDF) for the number of samples and identifiers in all campaigns, along with an overview of earnings from pools that provide public statistics for wallets. Table IV provides a breakdown of the number of campaigns per type of identifier (wallets and other identifiers).

- **Monero (XMR)**: Most frequently used cryptocurrency
- **Bitcoin (BTC)**: Second most frequently used

There are at least 18 campaigns using two or more currencies. While most campaigns involve one or a few wallets, some have up to 304 different identifiers.

#### C. Mining Pools

There are two main strategies for mining: joining a pool or solo-mining. Using publicly available third-party servers, such as GitHub, Amazon Web Services (AWS), and Google, provides an economical advantage compared to dedicated infrastructure like bullet-proof servers, which are more resilient against takedowns.

Our longitudinal analysis confirms previous reports that Monero is the preferred currency for crypto-mining malware [16]. Therefore, the rest of the paper focuses on campaigns using Monero.

### Popular Domains Hosting Crypto-Mining Malware

| **Domain** | **#Samples** | **#URLs** |
| --- | --- | --- |
| **github.com** | 163 | 388 |
| ***.amazonaws.com** | 85 | 396 |
| **www.weebly.com** | 80 | 96 |
| ***.google.com** | 38 | 74 |
| **hrtests.ru** | 37 | 1 |
| **cdn.discordapp.com** | 34 | 55 |
| **a.cuntﬂaps.me** | 32 | 48 |
| **ﬁle-5.ru** | 30 | 52 |
| **TOTAL #: 2755 (# domains)** | **3420** | **6949** |

This table provides an excerpt of the most popular domains hosting known mining malware, the number of samples hosted under each domain, and the number of URLs hosting those samples.