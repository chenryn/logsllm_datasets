operators in order to spread their malware [33]. Due to
commodization of cybercrime services, purchasing a botnet
to spread malware is simple and open to anyone with few
technical skills, e.g.: by leveraging underground markets [34].
During our analysis, we have observed samples belonging to
various botnets that are commonly used as PPI services, such
as Virut or Nitol. Since these are known third-party infras-
tructures, two samples using these services are not necessarily
related to each other and thus are not aggregated together.
Stock Mining Software: During our exploratory analysis, we
have observed that many campaigns use stock mining soft-
ware. This is, the hash of a ﬁle dropped by the malware
matches with one of the hashes in our collection of mining
tools. Actually, we have observed that some crypto-mining
malware fetch this executable directly from the ofﬁcial Git-
Hub repository. However, we have also observed that some
miscreants fork these projects and make minor modiﬁcations
to the mining tool, e.g. to remove donation capabilities.
We use Fuzzy Hashing (FH) to pick up on the aforemen-
tioned modiﬁcations and to relate these samples with known
mining tools. FH is a similarity preserving hash function that
allows to compare binary ﬁles. Speciﬁcally, FH computes
a ﬁngerprint of each binary in such a way that any two
binaries that are almost identical map to a “similar” hash
value. Fuzzy hashing has been shown to be an effective
way of comparing malware [35]. In our pipeline, we use
context triggered piecewise hashing [36] and compute the
distance between the FH of all samples in a campaign and
the FH of all known mining tools. We choose a conservative
distance threshold of 0.1 as it performs well when comparing
malware [35]. Thus, samples with a distance lower than 0.1
are considered as stock mining tools.
Name
SHA256
POOL
URLPOOL
USER
PASS
NTHREADS
AGENT
DSTIP
DSTPORT
DNSRR
SOURCE
FS
ITW URL
PACKER
POSITIVES
TYPE
Description
Hash value of the sample
Normalized name of the mining pool
URL to which the sample mines
Identiﬁer used to mine in the pool
Password used to authenticate in the pool
Number of CPU threads used for mining
User agent used for mining
IP to which the sample mines
Port used for mining
DNS resolutions
Data feeds from which the data was obtained
Date when the sample was ﬁrst seen
URLs hosting or contacted by the sample
If any, associated packer used for obfuscation
Number of positive detections by antivirus*
Either Miner or Ancilliary
TABLE I: Data extracted for each sample. *Note that the
number of AV detecting this malware might increase over
time. Thus, the released dataset contain number of positives
by April’19.
Name
POOL
USER
HASHES
HASHRATE
LAST SHARE
BALANCE
TOTAL PAID
NUM PAYMENTS
DATE QUERY
USD
Description
Mining pool
Wallet Identiﬁer
Number of hashes shared
Last hash rate
Date of the last hash
Total balance (not paid)
Total XMR paid
Number of payments
Date of last query
Estimated total paid value in USD
TABLE II: Data extracted for each wallet. In addition to this,
for each wallet we also account for the payments and the
timestamps extracted from all transparent pools. Furthermore,
for the minexmr pool, we account for the historical hash rate
of the wallets.
F. Summary of data extracted
Table I summarize the data extracted from each sample.
Table II summarize the data extracted for each XMR wallet
and each mining pool.
IV. THE BINARY-BASED MINING THREAT
In this section, we present the analysis of our measurement.
We ﬁrst present our dataset (§IV-A), which contains malware
seen for over a decade. Next, we perform a longitudinal
analysis through the lens of our dataset (§IV-B). Then, we
characterize the type of mining pools and currencies we have
seen (§IV-C) and study the earnings of the campaigns in the
most prevalent cypto-currency, i.e.: Monero (§IV-D).
A. Dataset
Our study results from the collection of 4.5 million malware
samples from the range of sources described in §III-A. We then
apply sanity checks to tailor our analysis to crypto-mining
malware only, resulting in a total of: (i) 1,017,110 miner
binaries, and (ii) 212,923 ancillary binaries.
The samples in (i) are samples where we have observed
mining capabilities together with an associated wallet and a
8
Category
Summary
Sources
Resources
Type
ALL EXECUTABLES
Miner Binaries
Ancillary Binaries
Virus Total
Palo Alto Networks
Hybrid Analysis
Virus Share
Sandbox Analysis
Network Analysis
Binary Analysis
#Samples
1,230,033
1,017,110
212,923
956,252
628,915
857
519
1,143,384
258,564
10,204
TABLE III: Our dataset of miners and ancillaries, with the
collection sources and the number of resources.
pool address. The samples in (ii) are samples used by the
miners to run the mining operation (e.g., bot clients or loaders).
In total, our study leverages over 1.2 million crypto-mining
malware samples. Table III shows a summary of our dataset,
together with the breakdown of data sources and the type
of resources we resort from.10 Our largest source of miners
is Virus Total and the smallest is Virus Share. As for the
resources, we collect the largest number of wallets and pools
through dynamic analysis (sandbox and network analysis). The
data collection dates to March 2007 to capture the structure of
the third party infrastructure from their early stages. However,
malicious mining activity starts getting traction in 2011.
B. Longitudinal Analysis
We extract 16,050 different crypto-mining identiﬁers from a
total of 103,894 samples. As mentioned, these mostly include
addresses of wallets from various cryptocurrencies, but we also
ﬁnd emails and other identiﬁers used to authenticate the miner
in the pool to later pay them the corresponding reward. In
the case of wallets, we use regular expressions to detect the
associated currency. Regarding the emails, we observe that
the majority (97%) are used as identiﬁers of one of the most
popular mining pools, i.e.: minergate.11
Overall, we aggregate samples into 11,387 different cam-
paigns. Figure 4 depicts the Cumulative Distribution Function
(CDF) for the number of samples, and identiﬁers in all the
campaigns. It also shows an overview of the earnings made in
pools that provide public statistics for wallets. Leftmost side
of Table IV shows the breakdown of the number of campaigns
per type of identiﬁer (i.e., wallets and other identiﬁers).
Recall that wallet addresses represent the public key of an
electronic wallet in a given cryptocurrency. Thus, we show
the breakdown for the different cryptocurrencies for which
we have wallets. Note that two or more identiﬁers can be
used in the same campaign, for example due to a change of
a previous wallet address after being banned [17]. Monero is
the cryptocurrency most frequently used, followed by Bitcoin.
There are at least 18 campaigns using two or more currencies.
While most of the campaigns are composed by one or few
wallets (see Figure 4), we observe campaigns having up to
304 different identiﬁers.
2,449
1,535
178
150
132
Aeon
Sumokoin
Intensecoin
Turtlecoin
Bytecoin
# campaigns with wallet addresses for:
Monero
Bitcoin
zCash
Electroneum
Ethereum
Mixed
Sub-total
With other identiﬁers:
Email
Unknown
TOTAL
57
18
8
3
1
17
4,548
5,008
2,195
11,751
# samples seen in:
Year
2012
2013
2014
2015
2016
2017
2018
2019
∼19?
ALL
BTC
9
23
223
115
461
3.8K
1.3K
1*
1.7K
7.6K
XMR
1
3
281
1.6K
8.7K
31K
6.2K
49*
14K
62K
TABLE IV: Leftmost side of the table: number of campaigns
per currency, amount of e-mails and unknown identiﬁers (i.e.,
not associated with a known currency). Rightmost: number of
samples (*partial data) seen in a given year for Bitcoin (BTC)
and Monero (XMR).
Fig. 4: Cumulative distribution number of samples, wallets and
earnings observed per campaign.
Out of all the samples with wallets, we rely on the ﬁrst seen
value (obtained from the metadata of the samples provided by
Virus Total) to analyse the evolution of number of samples
mining Bitcoin and Monero. Rightmost side of Table IV shows
the number of samples with wallets by year for the most
prevalent cryptocurrencies, i.e.: Monero (XMR) and Bitcoin
(BTC). Overall, the dataset contains 7.6K BTC and 62K XMR
malware samples.12 Judging by the number of samples and
the distribution across time, we can conﬁrm the decreasing
interest in Bitcoin in favour of Monero. Moreover, we have
queried available Bitcoin pools with the BTC addresses, and
observed negligible earnings (i.e., less than 5K USD). Note
that the data collection ended in early 2019 and thus data
from this year is partial. Also, due to constraints in the Virus
Total rate limit we could not retrieve the ﬁrst seen entry for
some of the most recently discovered samples. However, we
attribute this samples to 2019 (denoted as ∼19? in Table IV).
As it can be observed, there are 4 samples that were seen in
2012 and in 2013 and that have later been mining Monero,
which was released in 2014. This is due to malware reuse,
i.e., malware samples that dynamically update their code
and execute components downloaded at a later stage (after
10See Appendix C for details about other sources crawled.
11For a detailed analysis, see Table XV from Appendix D.
12These are samples with embedded wallets and does not include ancillar-
ies.
9
10-2100102104Value0.40.60.81Campaigns (%)WalletsSamplesEarnings (XMR)installation time), namely droppers. For the curious reader,
and to foster malware analysis, Table V show data related to
these 4 samples, including hash value and associated wallets.
Note that two samples are linked to the same XMR wallet.
MD5
8b15eb749457b601495c87f465c525f4
2e2ca457803bc6203ddbb5ee4e8855e6
24f08ad6e827f7029141df20f799d6a4
80c30914f32b732868370de6a745bab3
Year
2012
2013
2013
2013
XMR wallet
46G5yoqAPP...
46G5yoqAPP...
4BrL51JCc9...
4JUdGzvrMF...
TABLE V: Malware samples observed in the wild before 2014
that have later been updated to mine Monero.
Table VI shows an excerpt of the most popular URL
domains hosting crypto-miners.13 We observe that GitHub is
the chosen site used to host the crypto-mining malware. This
is because GitHub hosts most of the mining tools, which
are directly downloaded — for malicious purposes — by
droppers as discussed before. Additionally, GitHub is also used
to host modiﬁed versions of the miners (e.g., by removing
the donation capabilities or adding further capabilities). It
is also used to host ancillary malicious tools [37]. We also
observe that there are other public repositories and ﬁle sharing
sites such as Bitbucket or 4sync, and web hosting sites such
as Amazon (AWS), Google, or Dropbox. One can also ﬁnd
mining malware hosted through torrent sites (b-tor.ru), enter-
tainment sites (telekomtv-internet.ro), or hosted as attachments
in the Discord app, a voice and text chat (cdn.discordapp.com).
There are also URL-shortener sites (goo.gl). This altogether
shows that crypto-miners largely rely on publicly available
third-party servers. The use of these services provides an
economical incentive when compared to other approaches that
use dedicated infrastructure such as bullet-proof servers — that
are more resilient against take-downs.
Our longitudinal analysis conﬁrms previous reports positioning
Monero as the preferred currency used by miscreants for
crypto-mining malware [16]. Thus, in the rest of the paper
we focus our attention on campaigns using Monero.
Domains
github.com
*.amazonaws.com
www.weebly.com
*.google.com
hrtests.ru
cdn.discordapp.com
a.cuntﬂaps.me
ﬁle-5.ru
TOTAL #: 2755(# domains)
#Samples
163
85
80
38
37
34
32
30
3420
#URLs
388
396
96
74
1
55
48
52
6949
TABLE VI: Excerpt of domains hosting known mining mal-
ware, number of samples hosted under each domain and
number of URLs hosting those samples.
C. Mining Pools
There are two possible strategies for mining:
joining a
pool or mining alone (which we call solo-mining). Using
13For a complete list ordered by prevalence, see Table XIII in Appendix D.