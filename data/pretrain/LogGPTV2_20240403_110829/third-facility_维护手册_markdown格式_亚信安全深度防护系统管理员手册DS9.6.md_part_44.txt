310 密钥交换错误 服务器正在尝试使用临时生成的密钥建立 SSL 会话。
生成预主请求时出
311 尝试对预主密钥进行排队以解密时出现错误。
错
312 密钥太大 主密钥大于协议标识符所指定的大小。
313 握手中的参数无效 尝试解码握手协议时遇到无效或不合理的值。
314 超出可用会话数
315 压缩方法不受支持
应用程序层协议不
316 请求的 SSL 应用程序层协议未知或不受支持。
受支持
已超过 URI 路径深
500 “/”分隔符过多。最大路径深度：100。
度
501 遍历无效 已尝试在 root 上使用“../”。
502 URI 中的字符非法 URI 中使用了非法字符。
503 UTF8 序列不完整 URI 在 UTF8 序列中间结束。
504 UTF8 编码无效 无效/非规范的编码尝试。
505 十六进制编码无效 %nn，其中 nn 不是十六进制数字。
506 URI 路径长度太大 路径长度大于 512 个字符。
507 字符使用无效 使用了已禁用的字符
508 利用了双重解码 尝试利用双重解码（%25xx、%25%xxd 等）。
700 Base64 内容无效 预期以 Base64 格式编码的数据包内容未正确编码。
压缩/GZIP 内容已
710 预期以 Base64 格式编码的数据包内容未正确编码。
损坏
压缩/GZIP 内容不
711 压缩/GZIP 内容不完整
完整
214
亚信安全服务器深度安全防护系统 9.6 管理员指南 防火墙事件
IIDD 事事件件 注注释释
压缩/GZIP 校验和
712 压缩/GZIP 校验和错误。
错误
不支持的压缩/GZIP
713 不支持的压缩/GZIP 词典。
词典
不支持的 GZIP 标
714 不支持的 GZIP 标头格式/方法。
头格式/方法
已超过协议解码搜
801 协议解码规则定义了搜索或 pdu 对象的限制，但达到限制前未找到对象。
索限制
802 协议解码约束错误 协议解码规则已解码不符合协议内容约束的数据。
协议解码引擎内部
803
错误
804 协议解码结构太深 协议解码规则已遇到导致超过最大类型嵌套深度 (16) 的类型定义和数据包内容。
805 协议解码堆栈错误 规则编程错误尝试引起递归或用于多嵌套过程调用。
806 无限数据循环错误
215
亚信安全服务器深度安全防护系统 9.6 管理员指南 完整性监控事件
完整性监控事件
严严
IIDD 重重 事事件件 注注释释
性性
信 当已请求客户端生成基线，或者完整性监控规则的数量从 0 到 n（将生成基线）时创建。此事件包含扫描时间（毫秒）和已编
8000 已创建完整基线
息 录实体数的相关信息。
信 当客户端的安全配置中有一个或多个完整性监控规则发生更改时创建。此事件包含扫描时间（毫秒）和已编录实体数的相关信
8001 已创建部分基线
息 息。
信 当请求客户端执行完整或部分按需扫描时创建。此事件包含扫描时间（毫秒）和已编录更改次数的相关信息。（正在进行的针对
8002 已完成更改扫描
息 文件系统驱动程序或通知的更改扫描不会生成 8002 事件。）
错 完整性监控规则中存 当规则使用 ${env.EnvironmentVar} 且 "EnvironmentVar" 为未知环境变量时创建。此事件包含出现该问题的完整性监控规则
8003
误 在未知环境变量 的 ID、名称以及未知环境变量的名称。
错 完整性监控规则中存 当规则包含的基本目录/密钥无效时创建。例如，指定包含基准 "c:\foo\d:\bar" 的 FileSet 将生成此事件，或者产生错误值
8004
误 在错误的基准 的环境变量替换会导致值无效。此事件包含出现该问题的完整性监控规则的 ID、名称以及错误基准值。
错 完整性监控规则中存 当完整性监控规则中遇到未知实体集时创建。此事件包含出现该问题的完整性监控规则的 ID、名称以及遇到的未知实体集名称
8005
误 在未知实体 列表（以逗号分隔）。
错 完整性监控规则中存 当完整性监控规则中遇到已知但不受支持的实体集时创建。此事件包含有问题的完整性监控规则的 ID、完整性监控规则的名称
8006
误 在不支持的实体 以及出现的不支持的实体集名称的逗号分隔列表。某些实体集类型（如 RegistryKeySet）是特定于平台的。
当完整性监控规则中遇到未知功能时创建。此事件包含有问题的完整性监控规则的 ID、完整性监控规则的名称、实体集类型
错 完整性监控规则中存
8007 （例如 FileSet）以及遇到的未知功能名称的逗号分隔列表。有效的功能值示例包括 "whereBaseInOtherSet"、"status" 和
误 在未知功能
"executable"。
当完整性监控规则中遇到已知但不受支持的功能时创建。此事件包含有问题的完整性监控规则的 ID、完整性监控规则的名称、
错 完整性监控规则中存
8008 实体集类型（例如 FileSet）以及遇到的但不受支持的功能名称的逗号分隔列表。某些功能值（例如用于 Windows 服务状态的
误 在不支持的功能
"status"）是特定于平台的。
当完整性监控规则中遇到未知属性时创建。此事件包含有问题的完整性监控规则的 ID、完整性监控规则的名称、实体集类型
错 完整性监控规则中存
8009 （例如 FileSet）以及遇到的未知属性名称的逗号分隔列表。有效的属性值示例包括 "created"、"lastModified" 和
误 在未知属性
"inodeNumber"。
当完整性监控规则中遇到已知但不受支持的属性时创建。此事件包含有问题的完整性监控规则的 ID、完整性监控规则的名称、
错 完整性监控规则中存
8010 实体集类型（例如 FileSet）以及遇到的但不受支持的属性名称的逗号分隔列表。某些属性值（例如 "inodeNumber"）是特定于
误 在不支持的属性
平台的。
当完整性监控规则中遇到未知实体集 XML 属性时创建。此事件包含有问题的完整性监控规则的 ID、完整性监控规则的名称、实
错 完整性监控规则的实
8011 体集类型（例如 FileSet）以及遇到的未知实体集属性名称的逗号分隔列表。如果您编写的是 ，而非
误 体集中存在未知属性
，将出现此事件
错 完整性监控规则中存
8012 当规则引用的注册表项不存在时创建。此事件包含出现该问题的完整性监控规则的 ID、名称以及未知注册表字符串的名称。
误 在未知注册表字符串
使用了无效的
错 表示 WQL 查询缺少命名空间，因为完整性规则 XML 的格式不正确。只有在包含使用和监控 WQL 查询的定制完整性规则的高级
8013 WQLSet。缺少命名空
误 情形中才会出现。
间或 WQL 查询。
使用了无效的
错
8014 WQLSet。使用了未知
误
的提供程序值。
警 完整性监控规则不适
8015 可能由多种原因导致，例如平台不匹配、目标目录或文件不存在或者功能不受支持。
告 用
警 已检测到非最优的完
8016
告 整性规则
无法编译正则表达
错
8050 式。使用了无效通配
误
符。
216
亚信安全服务器深度安全防护系统 9.6 管理员指南 日志审查事件
日志审查事件
IIDD 严严重重性性 事事件件 注注释释
8100 错误 日志审查引擎错误
8101 警告 日志审查引擎警告
8102 信息 日志审查引擎已初始化
217
亚信安全服务器深度安全防护系统 9.6 管理员指南 完整性监控规则语言
完整性监控规则语言
完整性监控规则语言是一种基于 XML 的声明性语言，用于描述应该受亚信安全服务器深度安全防护系统监控的系统组件和关联属性。此语
言还提供一种方法来指定一组数量较大的组件中应免于监控的组件。
创建新完整性监控规则的方式有两种：如果只是希望监控文件中是否发生未授权更改，则可以使用“基本规则”模板。有关使用“基本规
则”模板的说明，可以在““完完整整性性监监控控规规则则属属性性””窗窗口口的文档中找到。
如果要创建用来监控计算机上其他实体（目录、注册表值、服务等）的规则，则必须使用完整性监控规则语言来编写规则。（要使用完整
性监控规则语言创建新的完整性监控规则，请转至策策略略 >> 通通用用对对象象 >> 规规则则 >> 完完整整性性监监控控规规则则 >> 新新建建 >> 新新建建完完整整性性监监控控规规则则 >> 内内容容并选
择“定制 (XML)”。）
实体集
完整性监控规则中包括的系统组件称为“实体”。每种类型的组件便是一个实体类。例如，文件、注册表项和进程分别是不同的实体类。
完整性监控规则语言为每种实体类提供一种标记，用于描述该组实体（实体集）。以下实实体体集集类型可用于规则中：
• DDiirreeccttoorryySSeett：规则将扫描目录的完整性
• FFiilleeSSeett：规则将扫描文件的完整性
• GGrroouuppSSeett：：规则将扫描组的完整性
• IInnssttaalllleeddSSooffttwwaarreeSSeett：规则将扫描已安装软件的完整性
• PPoorrttSSeett：：规则将扫描侦听端口的完整性
• PPrroocceessssSSeett：规则将扫描进程的完整性
• RReeggiissttrryyKKeeyySSeett：规则将扫描注册表项
• RReeggiissttrryyVVaalluueeSSeett：规则将扫描注册表值
• SSeerrvviicceeSSeett：规则将扫描服务的完整性
• UUsseerrSSeett：：规则将扫描用户的完整性
• WWQQLLSSeett：：规则将监控 Windows Management Instrumentation WQL 查询语句结果的完整性
单个完整性规则可以包含多个实体集。例如，这允许您使用单个规则监控多个文件和注册表项来保护应用程序。
（本节概括介绍了实体集。有关各实体集的详细信息，请参阅其各自页面：DDiirreeccttoorryySSeett ((第第 222266页页))、FFiilleeSSeett ((第第 222288页页))、GGrroouuppSSeett
((第第 223311页页))、IInnssttaalllleeddSSooffttwwaarreeSSeett ((第第 223322页页))、PPoorrttSSeett ((第第 223344页页))、PPrroocceessssSSeett ((第第 223377页页))、RReeggiissttrryyKKeeyySSeett ((第第 223399页页))、
RReeggiissttrryyVVaalluueeSSeett((第第 224411页页))、SSeerrvviicceeSSeett((第第 224433页页))、UUsseerrSSeett((第第 224455页页))和 WWQQLLSSeett((第第 224488页页))。）
层次结构和通配符
对于代表层次结构数据类型（如 FileSet 和 RegistryKeySet）的实体集，支持基于部分的特征码匹配：
• / （（正正斜斜杠杠））：划分要应用于层次结构各级别的特征码部分
• ** （（两两个个星星号号））：匹配零个或多个部分
支持以下通配符：
• ? （（问问号号））：匹配一个字符
• * （（一一个个星星号号））：匹配零个或多个字符
还支持“转义”字符：
218
亚信安全服务器深度安全防护系统 9.6 管理员指南 完整性监控规则语言
• \（（反反斜斜杠杠））：转义下一个字符
使用 "/" 字符可以将特征码分成几个部分，只要每部分特征码连续匹配，便可以将其应用于层次结构的多个连续级别。例如，如果将特
征码：
/a?c/123/*.java
应用到以下路径：
/abc/123/test.java
则：
• "a?c" 匹配 "abc"
• "123" 匹配 "123"