Certainly! Below is the optimized and more professional version of your text, with improved clarity, coherence, and formatting:

---

### References

1. **I. Ray, N. Li, and C. Kruegel (Eds.)**. *ACM CCS 15*, pages 1156–1168. ACM Press, October 2015.

2. **A. Beimel**. *Secure Schemes for Secret Sharing and Key Distribution*. Ph.D. Thesis, Technion - Israel Institute of Technology, 1996.

3. **D. Boneh and X. Boyen**. Efficient selective-ID secure identity-based encryption without random oracles. In *EUROCRYPT 2004* (C. Cachin and J. Camenisch, Eds.), LNCS 3027, pages 223–238. Springer, Heidelberg, May 2004.

4. **D. Boneh and X. Boyen**. Secure identity-based encryption without random oracles. In *CRYPTO 2004* (M. Franklin, Ed.), LNCS 3152, pages 443–459. Springer, Heidelberg, August 2004.

5. **D. Boneh, X. Boyen, and E.-J. Goh**. Hierarchical identity-based encryption with constant size ciphertext. In *EUROCRYPT 2005* (R. Cramer, Ed.), LNCS 3494, pages 440–456. Springer, Heidelberg, May 2005.

6. **D. Boneh and M. K. Franklin**. Identity-based encryption from the Weil pairing. In *CRYPTO 2001* (J. Kilian, Ed.), LNCS 2139, pages 213–229. Springer, Heidelberg, August 2001.

7. **D. Boneh and M. K. Franklin**. Identity-based encryption from the Weil pairing. *SIAM Journal on Computing*, 32(3):586–615, 2003.

8. **X. Boyen**. Miniature CCA2 PK encryption: Tight security without redundancy. In *ASIACRYPT 2007* (K. Kurosawa, Ed.), LNCS 4833, pages 485–501. Springer, Heidelberg, December 2007.

9. **X. Boyen**. The Uber-assumption family (invited talk). In *PAIRING 2008* (S. D. Galbraith and K. G. Paterson, Eds.), LNCS 5209, pages 39–56. Springer, Heidelberg, September 2008.

10. **E. Brier, J.-S. Coron, T. Icart, D. Madore, H. Randriam, and M. Tibouchi**. Efficient indifferentiable hashing into ordinary elliptic curves. In *CRYPTO 2010* (T. Rabin, Ed.), LNCS 6223, pages 237–254. Springer, Heidelberg, August 2010.

11. **M. Chase and S. Meiklejohn**. Déjà Q: Using dual systems to revisit q-type assumptions. In *EUROCRYPT 2014* (P. Q. Nguyen and E. Oswald, Eds.), LNCS 8441, pages 622–639. Springer, Heidelberg, May 2014.

12. **S. Chatterjee and A. Menezes**. Type 2 structure-preserving signature schemes revisited. In *ASIACRYPT 2015, Part I* (T. Iwata and J. H. Cheon, Eds.), LNCS 9452, pages 286–310. Springer, Heidelberg, November/December 2015.

13. **J. Chen, R. Gay, and H. Wee**. Improved dual system ABE in prime-order groups via predicate encodings. In *EUROCRYPT 2015, Part II* (E. Oswald and M. Fischlin, Eds.), LNCS 9057, pages 595–624. Springer, Heidelberg, April 2015.

14. **J. Chen and H. Wee**. Fully, (almost) tightly secure IBE and dual system groups. In *CRYPTO 2013, Part II* (R. Canetti and J. A. Garay, Eds.), LNCS 8043, pages 435–460. Springer, Heidelberg, August 2013.

15. **J. Chen and H. Wee**. Dual system groups and its applications — compact HIBE and more. *Cryptology ePrint Archive*, Report 2014/265, 2014. Available at: <http://eprint.iacr.org/2014/265>.

16. **C. Cocks**. An identity based encryption scheme based on quadratic residues. In *Cryptography and Coding, 8th IMA International Conference* (B. Honary, Ed.), LNCS 2260, pages 360–363. Springer, Heidelberg, December 17–19, 2001.

17. **C. Gentry**. Practical identity-based encryption without random oracles. In *EUROCRYPT 2006* (S. Vaudenay, Ed.), LNCS 4004, pages 445–464. Springer, Heidelberg, May/June 2006.

18. **V. Goyal, O. Pandey, A. Sahai, and B. Waters**. Attribute-based encryption for fine-grained access control of encrypted data. In *ACM CCS 06* (A. Juels, R. N. Wright, and S. Vimercati, Eds.), pages 89–98. ACM Press, October/November 2006. Available as Cryptology ePrint Archive Report 2006/309.

19. **A. Guillevic**. Comparing the pairing efficiency over composite-order and prime-order elliptic curves. In *ACNS 13* (M. J. Jacobson Jr., M. E. Locasto, P. Mohassel, and R. Safavi-Naini, Eds.), LNCS 7954, pages 357–372. Springer, Heidelberg, June 2013.

20. **M. Hamburg**. Spatial Encryption. Ph.D. Thesis, Stanford University, California, 2011.

21. **M. Ion, J. Zhang, and E. M. Schooler**. Toward content-centric privacy in ICN: attribute-based encryption and routing. In *ICN’13, Proceedings of the 3rd, 2013 ACM SIGCOMM Workshop on Information-Centric Networking* (B. Ohlman, G. C. Polyzos, and L. Zhang, Eds.), pages 39–40. ACM, 2013.

22. **M. Karchmer and A. Wigderson**. On span programs. In *Structure in Complexity Theory Conference, 1993.*, Proceedings of the Eighth Annual, pages 102–111, May 1993.

23. **J. Katz, A. Sahai, and B. Waters**. Predicate encryption supporting disjunctions, polynomial equations, and inner products. In *EUROCRYPT 2008* (N. P. Smart, Ed.), LNCS 4965, pages 146–162. Springer, Heidelberg, April 2008.

24. **A. B. Lewko, T. Okamoto, A. Sahai, K. Takashima, and B. Waters**. Fully secure functional encryption: Attribute-based encryption and (hierarchical) inner product encryption. In *EUROCRYPT 2010* (H. Gilbert, Ed.), LNCS 6110, pages 62–91. Springer, Heidelberg, May 2010.

25. **A. B. Lewko and B. Waters**. New techniques for dual system encryption and fully secure HIBE with short ciphertexts. In *TCC 2010* (D. Micciancio, Ed.), LNCS 5978, pages 455–479. Springer, Heidelberg, February 2010.

26. **A. B. Lewko and B. Waters**. Unbounded HIBE and attribute-based encryption. In *EUROCRYPT 2011* (K. G. Paterson, Ed.), LNCS 6632, pages 547–567. Springer, Heidelberg, May 2011.

27. **J. Li, M. H. Au, W. Susilo, D. Xie, and K. Ren**. Attribute-based signature and its applications. In *ASIACCS 10* (D. Feng, D. A. Basin, and P. Liu, Eds.), pages 60–69. ACM Press, April 2010.

28. **U. M. Maurer**. Abstract models of computation in cryptography (invited paper). In *10th IMA International Conference on Cryptography and Coding* (N. P. Smart, Ed.), LNCS 3796, pages 1–12. Springer, Heidelberg, December 2005.

29. **A. Miyaji, M. Nakabayashi, and S. Takano**. New explicit conditions of elliptic curve traces for FR-reduction, 2001.

30. **V. I. Nechaev**. Complexity of a determinate algorithm for the discrete logarithm. *Mathematical Notes*, 55(2):165–172, 1994.

31. **T. Okamoto and K. Takashima**. Hierarchical predicate encryption for inner-products. In *ASIACRYPT 2009* (M. Matsui, Ed.), LNCS 5912, pages 214–231. Springer, Heidelberg, December 2009.

32. **T. Okamoto and K. Takashima**. Fully secure functional encryption with general relations from the decisional linear assumption. In *CRYPTO 2010* (T. Rabin, Ed.), LNCS 6223, pages 191–208. Springer, Heidelberg, August 2010.

33. **T. Okamoto and K. Takashima**. Adaptively attribute-hiding (hierarchical) inner product encryption. In *EUROCRYPT 2012* (D. Pointcheval and T. Johansson, Eds.), LNCS 7237, pages 591–608. Springer, Heidelberg, April 2012.

34. **Y. Rouselakis and B. Waters**. Practical constructions and new proof methods for large universe attribute-based encryption. In *ACM CCS 13* (A.-R. Sadeghi, V. D. Gligor, and M. Yung, Eds.), pages 463–474. ACM Press, November 2013.

35. **A. Sahai and B. R. Waters**. Fuzzy identity-based encryption. In *EUROCRYPT 2005* (R. Cramer, Ed.), LNCS 3494, pages 457–473. Springer, Heidelberg, May 2005.

36. **A. Shamir**. Identity-based cryptosystems and signature schemes. In *CRYPTO’84* (G. R. Blakley and D. Chaum, Eds.), LNCS 196, pages 47–53. Springer, Heidelberg, August 1984.

37. **V. Shoup**. Lower bounds for discrete logarithms and related problems. In *EUROCRYPT’97* (W. Fumy, Ed.), LNCS 1233, pages 256–266. Springer, Heidelberg, May 1997.

38. **B. Waters**. Dual system encryption: Realizing fully secure IBE and HIBE under simple assumptions. In *CRYPTO 2009* (S. Halevi, Ed.), LNCS 5677, pages 619–636. Springer, Heidelberg, August 2009.

39. **B. Waters**. Ciphertext-policy attribute-based encryption: An expressive, efficient, and provably secure realization. In *PKC 2011* (D. Catalano, N. Fazio, R. Gennaro, and A. Nicolosi, Eds.), LNCS 6571, pages 53–70. Springer, Heidelberg, March 2011.

40. **H. Wee**. Dual system encryption via predicate encodings. In *TCC 2014* (Y. Lindell, Ed.), LNCS 8349, pages 616–637. Springer, Heidelberg, February 2014.

41. **H. Wee**. Déjà Q: Encore! Un petit IBE. In *TCC 2016-A, Part II* (E. Kushilevitz and T. Malkin, Eds.), LNCS 9563, pages 237–258. Springer, Heidelberg, January 2016.

### Proofs of the Main Body

#### Proof of Theorem 3.1

**Proof.** For all \( x \in X \) and \( y \in Y \) such that \( P(x, y) = 1 \), we have:
\[ f /❕ \sim_{rf} AS_0, \]
where \( c := s_E(x) \), \( k := r_E(y) \), \( E := Pair(x, y) \), and \( f /❕ := c^T E k \).

In particular, for all \( \alpha \in \mathbb{Z}_p \), \( b \in \mathbb{Z}_n \), and \( r \in \mathbb{Z}_{m_1} \) such that \( ❕(\alpha, b, r) \neq 0 \), we have:
\[ f(\alpha, b, s, r) / ❕(\alpha, b, r) = \alpha s_0, \]
and the key computed by Dec corresponds to the key computed by Enc on \( x \).

Thus, we simply have to bound the probability that \( ❕ \) evaluates to 0 on a random point. To do so, we use the fact that \( \deg(❕) \leq d |sky| \), where \( d \) is the degree of ABE. Therefore, by Lemma 2.1 (Schwartz-Zippel), the probability of a failed decryption is bounded by:
\[ \leq \frac{d |sky|}{p}. \]

#### Proof of Lemma 3.2

**Proof.** Suppose there is \( x \in X \) and \( \gamma \in \mathbb{Z}_p \) such that:
\[ \sum_{y \in Y_x} k_y(R_y, B, A) + \gamma A \sim_{rf} AS_0. \]

By evaluating the formal variable \( S_i \) for \( i \in [0, w] \) to 0, we obtain:
\[ \sum_{y \in Y_x} k_y(R_y, B, A) + \gamma A \sim_{rf} 0. \]

Thus,
\[ \sum_{y \in Y_x} k_y(R_y, B, A) \sim_{rf} AS_0. \]

The matrices \( \{E^*_y\}_{y \in Y_x} \), which comprise the lower rows of \( \{E^*_y\}_{y \in Y_x} \), are such that:
\[ \sum_{y \in Y_x} k_y(R_y, B, A) \sim_{rf} AS_0, \]
which contradicts the symbolic security of ABE.

#### Proof of Theorem 3.3

**Proof.** The proof of Theorem 3.3 proceeds in two steps. First, it shows that the advantages \( \text{Adv}_{\text{GGM}}^{\text{ABE}, A}(\lambda) \) and \( \text{Adv}_{\text{SM}}^{\text{ABE}, A}(\lambda) \) are negligibly different. Then, it shows that \( \text{Adv}_{\text{SM}}^{\text{ABE}, A}(\lambda) = 0 \), using the symbolic security of ABE.

We proceed via a hybrid argument, using Game\( _i \) for \( i \in [0, Q_{eq}] \), defined in Figure 8, and we denote by \( \text{Adv}_i \) the advantage of \( A \) in Game\( _i \). It is clear that Game\( _0 \) is the same as \( \text{Exp}_{\text{GGM}}^{\text{ABE}}(1^\lambda, A) \), and Game\( _{Q_{eq}} \) is the same as \( \text{Exp}_{\text{SM}}^{\text{ABE}}(1^\lambda, A) \). We show how to transition from Game\( _i \) to Game\( _{i+1} \) for all \( i \in [0, Q_{eq} - 1] \) in the following lemma.

**Lemma A.1.** For all \( i \in [0, Q_{eq}] \),
\[ |\text{Adv}_{i+1} - \text{Adv}_i| \leq 6d(2 + (n + |ct|)Q_{sk}|sk|). \]

**Lemma A.2.** For all \( s \in \{1, 2, T\} \) and \( f /❕ \in L^{\sim}_s \),
\[ \deg(f /❕) \leq d(2 + (n + |ct|)Q_{sk}|sk|). \]

**Proof of Lemma A.1.** First, in Lemma A.2, we give a bound on the degree of the rational fractions in the lists \( L^{\sim}_s \) for \( s \in \{1, 2, T\} \). Then, we apply Lemma 2.1 (Schwartz-Zippel) to bound \( |\text{Adv}_{i+1} - \text{Adv}_i| \).

**Proof of Lemma A.2.** First, note that for all \( s \in \{1, 2, T\} \) and \( f /❕ \in L^{\sim}_s \),
\[ \deg(f /❕) \leq d \cdot |L_s|. \]

We conclude the proof using the fact that:
- \( |L_1| \leq n + |ct| \),
- \( |L_2| \leq Q_{sk}|sk| \),
- \( |L_T| \leq 2 + |L_1| \cdot |L_2| \).

Thus, for all \( s \in \{1, 2, T\} \) and \( f /❕ \in L^{\sim}_s \),
\[ \deg(f /❕) \leq d(2 + (n + |ct|)Q_{sk}|sk|). \]

Now, we bound \( |\text{Adv}_{i+1} - \text{Adv}_i| \), using the fact that Game\( _{i+1} \) and Game\( _i \) only differ on the \( i+1 \)'st query to \( O_{eq} \). In particular, the output of \( O_{eq}(s, i', j') \) is different in these two games if:
1. \( L^{\sim}_s[i'] = L^{\sim}_s[j'] \) but \( L^{\sim}_s[i'] \not\sim_{rf} L^{\sim}_s[j'] \), or
2. \( L^{\sim}_s[i'] \sim_{rf} L^{\sim}_s[j'] \) but \( L^{\sim}_s[i'] \neq L^{\sim}_s[j'] \).

Let's consider the event (1). We write \( L^{\sim}_s[i'] = f /❕ \) and \( L^{\sim}_s[j'] = f' /❕' \). Since \( f /❕ \sim_{rf} f' /❕' \), we have for all points \( x \):
\[ f(x) \cdot ❕'(x) = f'(x) \cdot ❕(x). \]

Moreover, if \( ❕(x), ❕'(x) \neq 0 \), then:
\[ f /❕(x) = f' /❕'(x), \]
that is, \( L^{\sim}_s[i'] = L^{\sim}_s[j'] \). Therefore, it suffices to bound the probability of the event: \( ❕ \) or \( ❕' \) evaluates to 0 on a random point.

---

This version should be more coherent and easier to read. Let me know if you need any further adjustments!