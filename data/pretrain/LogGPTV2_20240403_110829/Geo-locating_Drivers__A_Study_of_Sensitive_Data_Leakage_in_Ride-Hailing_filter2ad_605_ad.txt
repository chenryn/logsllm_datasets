sensitive date. SUPOR [19] and UiRef [4] have been designed
to detect these leakages. Finally, data leakage can be the result
of exploitations of code vulnerabilities such as code injection
vulnerabilities [20] or improper certiﬁcate validation [14], or
library vulnerabilities [28].
There are also efforts of identifying the privacy leakage of
the server response data from mobile apps. For instance, Kock
et. al. [22] proposed using both static analysis and dynamic
analysis to semi-automatically discover server-based informa-
tion oversharing vulnerabilities, where privacy sensitive cus-
tomer information was unexpectedly sent to the mobile apps.
Improper implementation of access control mechanism at the
server side can also lead to sensitive data leakage from mobile
apps, as shown in AuthScope [43] and LeakScope [41]. Our
work is inspired by these server side data leakage problems,
but we focus on a new context particularly in the ride-hailing
service that has not been explored before.
Web API and Protocol Reverse Engineering. To conduct
our study, we developed a lightweight dynamic analysis tool
to reverse engineer the remote server web APIs for privacy
sensitive data analysis. In fact, there is also a large body of
13
research focusing on reverse engineering of network protocols
from both network traces and application binary executions. In
particular, Discoverer [9] and Protocol Informatics [2] extract
protocol format from the collected network traces, whereas
Polyglot [7], AutoFormat [24], Dispatcher [6], Reformat [36]
instead extract protocol format based on how network message
is processed by the application binary. Inferring the protocol
format
the primary goal of our analysis. Recently,
WARDroid [27] introduces a static-analysis based method to
extract web APIs, but it focuses on the implementation logic,
which is not the objective of our analysis. However, our tech-
nique can certainly integrate these techniques to recognize the
message format in addition to the discovery of the web APIs.
is not
Dynamic Analysis of Mobile Apps. Our approach is based
on dynamic analysis to identify web APIs and dependencies.
Similarly, dynamic approaches have been used in the past to
study speciﬁc security problems. For instance, TaintDroid [13]
has been used to detect whether user’s privacy sensitive infor-
mation can be leaked outside the phone; AppsPlayground [32]
recognizes the user interfaces of mobile apps and gener-
ates corresponding inputs to expose more app behaviors;
DECAF [25] navigates various activities of mobile apps to
discover potential Ads ﬂaws; SmartGen [40] executes a mobile
app with selective concolic execution to expose malicious
URLs; so on and so forth.
Our approach differs from these existing techniques as
follows. First, we solve the problem of extracting web APIs
including the parameter roles from mobile apps. Second, each
work has their own unique challenges. For instance, we do
not face the issues of executing all the possible program paths
of a mobile app, and instead we rely on security analysts
to execute the app. Certainly, we can integrate existing
efforts such as SmartGen [40] to expose the web APIs more
efﬁciently and automated.
VIII. CONCLUSION
We have presented a large-scale study of the privacy-
sensitive data leakage of drivers in the ride-hailing services. We
focus on one particular feature, namely the nearby cars feature,
which retrieves nearby car’s information from the server when
a rider opens the mobile app. Surprisingly, our study with 20
ride-hailing services including both Uber and Lyft has revealed
that the data harvesting attacks are feasible. In particular, our
study showed that these attacks are a real threat to the safety
of drivers: attackers can determine the locations of drivers
with high-precision, including but not limited to the home
address, and detect driver’s daily behaviors. Moreover, some
of the services also leak other conﬁdential information such
as the social security numbers of drivers. Furthermore, the
aggregated business information about the ride-hailing services
can also be learned by attacks such as the number of rides,
utilization of cars, and presence on the territory. In addition
to evaluating the current countermeasures and reporting the
attacks we conducted, we have also discussed more robust
countermeasures the service providers could use to defeat the
attacks presented in this paper.
ACKNOWLEDGMENT
We would like to thank our shepherd Nick Nikiforakis
and the anonymous reviewers for their very helpful feed-
backs. This research was supported in part by AFOSR under
grant FA9550-14-1-0119, NSF awards 1834213, 1834215, and
1834216, and the German Federal Ministry of Education and
Research (BMBF) through funding for the CISPA-Stanford
Center for Cybersecurity (FKZ:13N1S0762). Any opinions,
ﬁndings, conclusions, or recommendations expressed are those
of the authors and not necessarily of the AFOSR, BMBF, and
NSF.
REFERENCES
[1]
[2]
[3]
“Hypertext
rfc2616.html.
transfer protocol,” https://www.w3.org/Protocols/rfc2616/
“The Protocol Informatics Project,” http://www.baselineresearch.net/PI/.
“Xposed module repository,” http://repo.xposed.info/.
[4] B. Andow, A. Acharya, D. Li, W. Enck, K. Singh, and T. Xie,
“Uiref: Analysis of sensitive user inputs in android applications,”
in Proceedings of
the 10th ACM Conference on Security and
Privacy in Wireless and Mobile Networks, ser. WiSec ’17. New
York, NY, USA: ACM, 2017, pp. 23–34.
[Online]. Available:
http://doi.acm.org/10.1145/3098243.3098247
[5] BBC News, “Uber sues Indian rival Ola over
’fake accounts’,”
https://www.bbc.com/news/business-35888352, March 2016, [Online;
accessed 08-May-2018].
[6]
[7]
[8]
J. Caballero, P. Poosankam, C. Kreibich, and D. Song, “Dispatcher:
Enabling active botnet inﬁltration using automatic protocol reverse-
engineering,” in Proceedings of the 16th ACM Conference on Computer
and and Communications Security (CCS’09), Chicago, Illinois, USA,
2009, pp. 621–634.
J. Caballero and D. Song, “Polyglot: Automatic extraction of protocol
format using dynamic binary analysis,” in Proceedings of the 14th ACM
Conference on Computer and and Communications Security (CCS’07),
Alexandria, Virginia, USA, 2007, pp. 317–329.
J. Constine, “Former employees say Lyft staffers spied on passengers,”
https://techcrunch.com/2018/01/25/lyft-god-view/, January 2018, [On-
line; accessed 07-May-2018].
[9] W. Cui, J. Kannan, and H. J. Wang, “Discoverer: Automatic protocol
reverse engineering from network traces,” in Proceedings of the 16th
USENIX Security Symposium (Security’07), Boston, MA, August 2007.
[10] R.
Dillet,
Taxi
“Protesting
Paris,”
Near
angry-taxi-drivers-attack-uber-cars-in-paris, January 2014,
accessed 08-May-2018].
Car
https://www.fastcompany.com/3024798/
[Online;
Drivers
Attack
Uber
[11] A. Efrati,
“Uber’s Top
Vulnerability,”
Lyft’s
ubers-top-secret-hell-program-exploited-lyfts-vulnerability,
2017, [Online; accessed 07-May-2018].
Program Exploited
https://www.theinformation.com/articles/
April
"Hell"
Secret
[12] M. Egele, C. Kruegel, E. Kirda, and G. Vigna, “PiOS : Detecting
privacy leaks in iOS applications,” in NDSS 2011, 18th Annual
Network and Distributed System Security Symposium, 6-9 February
2011, San Diego, CA, USA, San Diego, UNITED STATES, 02 2011.
[Online]. Available: http://www.eurecom.fr/publication/3282
[13] W. Enck, P. Gilbert, B.-G. Chun, L. P. Cox, J. Jung, P. McDaniel,
and A. N. Sheth, “Taintdroid: An information-ﬂow tracking system for
realtime privacy monitoring on smartphones,” in Proceedings of the 9th
USENIX Conference on Operating Systems Design and Implementation,
ser. OSDI’10. Berkeley, CA, USA: USENIX Association, 2010,
pp. 393–407.
[Online]. Available: http://dl.acm.org/citation.cfm?id=
1924943.1924971
[14] S. Fahl, M. Harbach, T. Muders, L. Baumgärtner, B. Freisleben,
and M. Smith, “Why eve and mallory love android: An analysis
of android ssl
the 2012 ACM
Conference on Computer and Communications Security, ser. CCS ’12.
New York, NY, USA: ACM, 2012, pp. 50–61. [Online]. Available:
http://doi.acm.org/10.1145/2382196.2382205
(in)security,” in Proceedings of
14
ride-hailing service,” in 26th USENIX Security Symposium (USENIX
Security 17). Vancouver, BC: USENIX Association, 2017, pp.
1235–1252.
[Online]. Available: https://www.usenix.org/conference/
usenixsecurity17/technical-sessions/presentation/pham
[30] A. Pham, I. Dacosta, B. Jacot-Guillarmod, K. Huguenin, T. Hajar,
F. Tramèr, V. D. Gligor, and J. Hubaux, “Privateride: A privacy-
enhanced ride-hailing service,” PoPETs, vol. 2017, no. 2, pp. 38–56,
2017. [Online]. Available: https://doi.org/10.1515/popets-2017-0015
[31] L. Prinsloo, “South Africa Meter-Taxi Operators Attacking Uber
https://www.bloomberg.com/news/articles/2017-07-17/
July 2017,
Drivers,”
south-africa-meter-taxi-operators-attacking-uber-drivers,
[Online; accessed 08-May-2018].
[32] V. Rastogi, Y. Chen, and W. Enck, “Appsplayground: Automatic
security analysis of smartphone applications,” in Proceedings of the
Third ACM Conference on Data and Application Security and Privacy,
ser. CODASPY ’13. New York, NY, USA: ACM, 2013, pp. 209–220.
[Online]. Available: http://doi.acm.org/10.1145/2435349.2435379
[33] SimilarWeb, “SimilarWeb - Trafﬁc Overview of Lyft.com,” https:
//www.similarweb.com/website/lyft.com, 2018, [Online; accessed 07-
May-2018].
[34] ——, “SimilarWeb - Trafﬁc Overview of Uber.com,” https://www.
similarweb.com/website/uber.com, 2018, [Online; accessed 07-May-
2018].
[35] B. Stock, G. Pellegrino, C. Rossow, M. Johns, and M. Backes,
“Hey, you have a problem: On the feasibility of large-scale web
vulnerability notiﬁcation,” in 25th USENIX Security Symposium
(USENIX Security 16). Austin, TX: USENIX Association, 2016, pp.
[Online]. Available: https://www.usenix.org/conference/
1015–1032.
usenixsecurity16/technical-sessions/presentation/stock
[36] Z. Wang, X. Jiang, W. Cui, X. Wang, and M. Grace, “Reformat:
Automatic reverse engineering of encrypted messages,” in Proceedings
of 14th European Symposium on Research in Computer Security (ES-
ORICS’09). Saint Malo, France: LNCS, September 2009.
[37] Z. Yang, M. Yang, Y. Zhang, G. Gu, P. Ning, and X. S. Wang,
“Appintent: Analyzing sensitive data transmission in android for privacy
leakage detection,” in Proceedings of the 20th ACM Conference on
Computer and Communications Security (CCS’13), November 2013.
[38] Z. Zhu and G. Cao, “Applaus: A privacy-preserving location proof
updating system for location-based services,” in INFOCOM, 2011
Proceedings IEEE, April 2011, pp. 1889–1897.
[39] G. Zoroya and A. Waters, “Uber under assault around the world as taxi
drivers ﬁght back,” https://www.usatoday.com/story/news/world/2015/
07/07/uber-protests-global-germany-france-taxi/29500747/, July 2015,
[Online; accessed 08-May-2018].
[40] C. Zuo and Z. Lin, “Exposing server urls of mobile apps with selective
the 26th World Wide Web
symbolic execution,” in Proceedings of
Conference (WWW’17), Perth, Australia, April 2017.
[41] C. Zuo, Z. Lin, and Y. Zhang, “Why does your data leak? uncovering
the data leakage in cloud from mobile apps,” in Proceedings of the
2019 IEEE Symposium on Security and Privacy, San Francisco, CA,
May 2019.
[42] C. Zuo, W. Wang, R. Wang, and Z. Lin, “Automatic forgery of cryp-
tographically consistent messages to identify security vulnerabilities
in mobile services,” in Proceedings of the 21st Annual Network and
Distributed System Security Symposium (NDSS’16), San Diego, CA,
February 2016.
[43] C. Zuo, Q. Zhao, and Z. Lin, “Authscope: Towards automatic discovery
of vulnerable authorizations in online services,” in Proceedings of the
24th ACM Conference on Computer and Communications Security
(CCS’17), Dallas, TX, November 2017.
“Uber’s dirty tricks quantiﬁed: Rival
[15] E. Fink,
canceled
uber-fake-ride-requests-lyft/index.html,
accessed 08-May-2018].
counts 5,560
http://money.cnn.com/2014/08/11/technology/
[Online;
August
rides,”
2014,
[16] S. Ghosh,
“Taxify
out
kicked
taxify-launched-paris-kicked-out-of-london-2017-10,
[Online; accessed 07-May-2018].
of
launched
has
London,”
in
Paris
being
http://www.businessinsider.com/
2017,
after
Oct
[17] W. He, X. Liu, and M. Ren, “Location cheating: A security challenge
to location-based social network services,” in Distributed Computing
Systems (ICDCS), 2011 31st International Conference on, June 2011,
pp. 740–749.
[18] K.
Hill,
“God
Party-Goers’
View’:
Uber
Allegedly
Stalked
(Updated),”
For
Users
https://www.forbes.com/sites/kashmirhill/2014/10/03/
god-view-uber-allegedly-stalked-users-for-party-goers-viewing-pleasure,
October 2014, [Online; accessed 07-May-2018].
Pleasure
Viewing
[19]
J. Huang, Z. Li, X. Xiao, Z. Wu, K. Lu, X. Zhang, and G. Jiang, “Supor:
Precise and scalable sensitive user input detection for android apps.” in
USENIX Security Symposium, 2015, pp. 977–992.
[20] X.
Jin, X. Hu, K. Ying, W. Du, H. Yin, and G. N. Peri,
“Code injection attacks on html5-based mobile apps: Characterization,
detection and mitigation,” in Proceedings of the 2014 ACM SIGSAC
Conference on Computer and Communications Security, ser. CCS ’14.
New York, NY, USA: ACM, 2014, pp. 66–77. [Online]. Available:
http://doi.acm.org/10.1145/2660267.2660275
[21] Keep Talking Greece, “Angry taxi drivers on strike attack Uber Taxis in
downtown Athens (videos),” http://www.keeptalkinggreece.com/2018/
03/06/uber-taxi-attacks-strike/, March 2018, [Online; accessed 08-May-
2018].
[22] W. Koch, A. Chaabane, M. Egele, W. Robertson, and E. Kirda,
“Semi-automated discovery of server-based information oversharing
vulnerabilities in android applications,” in Proceedings of the 26th ACM
SIGSOFT International Symposium on Software Testing and Analysis.
ACM, 2017, pp. 147–157.
[23] V. Lenders, E. Koukoumidis, P. Zhang, and M. Martonosi, “Location-
based trust for mobile user-generated content: Applications, challenges
and implementations,” in Proceedings of
the 9th Workshop on
Mobile Computing Systems and Applications, ser. HotMobile ’08.
New York, NY, USA: ACM, 2008, pp. 60–64. [Online]. Available:
http://doi.acm.org/10.1145/1411759.1411775
[24] Z. Lin, X. Jiang, D. Xu, and X. Zhang, “Automatic protocol format
reverse engineering through context-aware monitored execution,” in
Proceedings of the 15th Annual Network and Distributed System Se-
curity Symposium (NDSS’08), San Diego, CA, February 2008.
[25] B. Liu, S. Nath, R. Govindan, and J. Liu, “Decaf: Detecting
and characterizing ad fraud in mobile apps,” in Proceedings of
the 11th USENIX Conference on Networked Systems Design and
Implementation,
Berkeley, CA, USA: USENIX
Association, 2014, pp. 57–70. [Online]. Available: http://dl.acm.org/
citation.cfm?id=2616448.2616455
ser. NSDI’14.
[26] W. Luo and U. Hengartner, “Veriplace: A privacy-aware location proof
architecture,” in Proceedings of the 18th SIGSPATIAL International
Conference on Advances in Geographic Information Systems, ser.
GIS ’10. New York, NY, USA: ACM, 2010, pp. 23–32. [Online].
Available: http://doi.acm.org/10.1145/1869790.1869797
[27] A. Mendoza and G. Gu, “Mobile application web api reconnaissance:
Web-to-mobile inconsistencies and vulnerabilities,” in Proceedings of
the 39th IEEE Symposium on Security and Privacy (SP’18), May 2018.
[28] P. Mutchler, A. Doupé, J. Mitchell, C. Kruegel, and G. Vigna, “A large-
scale study of mobile web app security,” in Proceedings of the Mobile
Security Technologies Workshop (MoST), 2015.
[29] A. Pham, I. Dacosta, G. Endignoux, J. R. T. Pastoriza, K. Huguenin,
and J.-P. Hubaux, “Oride: A privacy-preserving yet accountable
15