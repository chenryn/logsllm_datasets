titleblackhat:eu-22 Fuzzing and Breaking Security Functions of SIMATIC PLCs
Siemens SIMATIC PLC is widely used in the world and accounts for a high proportion of the PLC market share, these PLCs are often used in critical infrastructure control scenarios, such as energy, water, power, oil and gas industries. More and more attacks are targeting critical infrastructures. In May 2021, Siemens launched the latest version of the TIA V17, it is important to note that starting from this version there will be a lot of new design features regarding security such as enhanced TLS communication protocols, the configuration of data encryption protection, requiring the use of access protection level to prevent an unauthorized attack, etc. But are there weaknesses in such security design and can it be breached?In this presentation, I will take Siemens S7-1500/S7-1200 PLC with enhanced security design as the target, and elaborate on the following aspects: cracking TLS secure communication protocol, security protocol Fuzzing testing, high risk vulnerability analysis, and access protection authorization authentication.-Explain the workflow of TLS secure communication protocol, certificate usage and storage, and the relationship with S7CommPlus protocol. On this basis, make a rogue engineer station which will have control over S7-1500 with the latest firmware version, achieving the S7-1500 run, stop, upload project, modify control logic and other sensitive operations;-Explain how to design and implement Fuzzing for TLS secure communication protocol, and use the Fuzzing tool to discover S7+: Crash vulnerabilities. At present, only 3 of these vulnerabilities have been addressed, and more (at least 5) vulnerabilities are being investigated and will soon be patched.-The password level protection mechanism is designed to prevent unauthorized operations, but even if s7-1500 /S7-1200 has access protection function enabled, it is still affected by vulnerabilities CVE-2021-37185 and CVE-2021-37205. I will analyze the causes of UAF type vulnerability (CVE-2021-37205) in detail.-In TIA version â‰¤V16, S7-1200 access protection level password can be bypassed with the pass the hash method. Is it possible to bypass access protection in VERSION TIA V17? The authorization process of TIA V17 with access protection level will be explained in detail.Finally, I will give corresponding defending strategies and suggestions for the risks mentioned in the presentation, and how PLC users can protect their equipment from such attacks.