0x13 | 启动在线键盘记录器  
0x14 | 停止在线键盘记录器  
0x15, 0x16 | 读取指定的文件并将其发送到C&C服务器  
0x17 | 删除指定的文件或路径  
0x18 | 清除IE、Firefox、Chrome等浏览器的登陆信息和cookie信息  
0x1B | 控制受感染设备摄像头  
0x1D | 记录受感染主机周围的声音信息并发送到C&C服务器  
0x1E | 停止记录受感染主机周围声音信息  
0x20 | 删除指定文件  
0x21 | 结束木马自身进程  
0x22 | 卸载自身，同时会移除木马产生的相关文件  
0x23 | 执行vbs脚本“restart.vbs”来重启自身  
0x24, 0x25 | 更新木马，该命令会从指定的URL下载文件并执行  
0x26 | 在受感染主机显示信息  
0x27 | 注销用户，关闭系统或重启感染主机  
0x28 | 获取受感染主机剪切板数据  
0x29, 0x2A | 清空受感染主机剪切板  
0x2B | 创建一个共享内存来共享数据  
0x2C | 从指定的URL下载数据并将数据共享到创建的共享内存中  
0x30 | 连接给定的服务器并与之通信  
0x31 | 在注册表中保存用户名  
0x32 | 设置代理  
0x34 | 执行服务控制，包括更改指定服务配置，启动、暂停、终止指定服务，将指定的服务状态返回给C&C服务器  
0x8F | 枚举指定路径的文件，并将文件列表发送给C&C服务器  
0x92 | 设置受感染主机桌面图片风格  
0x94 | 修改指定窗口标题  
0x95 | 获取实时物理内存状态并报告给C&C服务器  
0x98 | 向C&C服务器上传文件或从C&C服务器下载文件  
0x9E, 0xA2 | 在感染主机播放警告声音  
0xA3 | 控制受感染主机播放或者停止音频文件  
0xAB | 在受感染主机上提权，并将结果返回到C&C服务器  
0xAC | 在受感染主机显示弹出菜单  
表4 C&C服务器的控制命令和功能描述
可见，一旦Remcos RAT被成功植入到目标主机，其背后的黑客便可完全控制这台主机，对其进行监控、数据窃取甚至是破坏活动。
### 四、总结
本文中，我们对“海毒蛇”组织使用的基础设施、攻击武器、活动历史等信息进行了全面而深入的分析，并结合活动时间分析以及时区分析等方法对该组织的成员及其所属国家进行溯源追踪，发现了其中的六名黑客成员并分析了该组织与“Gorgon”APT组织之间的关系，最后我们对最近出现的一次攻击进行了详细的逆向分析。
从我们分析的结果来看，“海毒蛇”组织持有大量恶意域名和用于托管恶意文件的虚拟主机等网络基础设施，同时还利用物联网僵尸控制大量的物联网设备，其同时具备APT攻击和物联网攻击的特性。在最近的这次攻击活动中，黑客还定制了大量的具有迷惑性的诱饵文档来捕获目标。“海毒蛇”组织善于使用加密和变形的恶意脚本来躲避Web应用防火墙、入侵检测系统等网络安全设备的检测，其恶意脚本通过多阶段的嵌套下载和解密执行，以从远程服务器下载更多的恶意程序执行。
鱼叉式钓鱼具有定制化、精准化的特性，且具有很强的迷惑性，一旦员工不慎点击了钓鱼邮件，就可能会对企业带来严重的后果。黑客可以将窃取到的数据转售谋利，或者利用这些数据进行更进一步的攻击活动。除此之外，攻击者还可以使用鱼叉式钓鱼攻击部署恶意软件来劫持计算机，将目标计算机所在的网络变成可用于DoS攻击的庞大僵尸网络。建议企事业单位不定期为员工举办安全教育培训，提升员工的安全防范意识。务必注意不要随意打开未知来源的电子邮件，特别是带有附件的电子邮件。如有需要，可通过打开office文档中的：文件-选项-信任中心-信任中心设置-宏设置，来禁用一切宏代码执行。并做好邮件系统的防护工作，督促员工及时更新系统和office应用补丁。如果发现系统或服务器出现异常，应当及时报告并请专业人员进行排查，以消除安全隐患。
### 五、IOC
部分IOC列举如下：
Hash | 说明  
---|---  
c1ad13e65ca16578fe507339eb92ee40 | 诱饵文档  
b687bbc1c9ab0d3b2313766d38b3db61 | vbs脚本  
f2dbb624c007f0d041f6646638f4976d | Powershell  
71ebdb4ebcef964c45193e2df0968ade | 注入器  
31539c9ae3f23ef851ca6e9a3c59227e | Remcos RAT  
d77e6878fe18848abd4264ed7641ad33 | 诱饵文档  
085f0912018f137fc35173a2f118712b | Remcos RAT  
2f0126e9145e12a1e9b498ca55d3a245 | 诱饵文档  
c8fdf886ae4301918b79995330634a37 | vbs脚本  
e5a478872b61c8b4ff309d38954874b9 | Powershell  
143c76586eb02d515ae68046c34849fe | 注入器  
dc295718025e3cc7013db7df026ad3ad | Remcos RAT  
6da083f6d4ddda45cc06b257ea43e6de | 下载器  
95dac87cec4a40d4626ee710402c1d70 | Powershell  
3da5021331de7a4593219b93fe9ac5ba | Masslogger  
0a4fa8c861ed733b116ce6ed790629d0 | Powershell  
4f00af0f16b5010ba7a0c4ecca7312b0 | Powershell  
eb1ac927ff3f3a9f2230cb4138389fe7 | Mirai  
db23c3dbb5d21d6daab22c548a3b6522 | Mirai  
4703788977bd0d98d41531766fa91e98 | Gafgyt  
f63a7d569c019de1f0ff401c4cc22b41 | Gafgyt  
…… |  
IP和域名 | 说明  
---|---  
185.172.110.214 | 恶意文件托管服务器  
185.172.110.210 | 恶意文件托管服务器  
185.244.30.243 | C&C服务器  
79.134.225.32 | C&C服务器  
boyflourish.myq-see.com | C&C服务器  
rapture666.myq-see.com | C&C服务器  
plaitt.com | 恶意文件托管服务器  
…… |  
* * *