**Title: Finding a Needle in an Encrypted Haystack: Leveraging Cryptographic Abilities to Detect the Most Prevalent Attacks on Active Directory**

Active Directory (AD) has long been a prime target for attackers, with a continuous rise in the number and sophistication of tools designed to compromise and exploit the organization's central repository of secrets. While defensive security products have made strides in mitigating certain attack techniques through methods such as log collection and raw traffic inspection, many common offensive tactics remain inadequately addressed. One such technique is the NTLM Relay, a well-known and frequently exploited method that continues to pose significant risks.

Recently, the NTLM Relay was once again highlighted in the PrivExchange vulnerability, which was discovered earlier this year. In this presentation, we will explore several new ways to abuse this notorious authentication protocol, including a critical zero-day vulnerability we have identified. This vulnerability allows attackers to exploit NTLM Relay and gain control over any machine in the domain, even those with the most stringent security configurations, including server signing. Additionally, we will discuss another vulnerability we have uncovered in the way NTLM implements channel binding, which could potentially put your cloud resources at risk.

To counter these threats, we will introduce a novel defensive approach that leverages cryptographic operations to enhance detection and mitigation capabilities. Specifically, we will explain how this method led us to develop the first known deterministic algorithm for detecting NTLM Relay attacks, providing a robust defense against one of the most prevalent and challenging attack vectors today.