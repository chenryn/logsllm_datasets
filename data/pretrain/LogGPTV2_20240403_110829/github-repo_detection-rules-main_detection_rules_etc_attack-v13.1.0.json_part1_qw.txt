{"created": "2022-03-30T14:26:51.832Z", "created_by_ref": "", "description": "Monitor newly executed processes that may establish persistence and/or elevate privileges by executing malicious content triggered by accessibility features.\n\n Implementation 1 : Command Launched from Winlogon \n\nDetection Pseudocode \n processes = filter process where ((event_id == \"1\" OR event_id=\"4688\") AND (parent_exe == \"winlogon.exe\" and exe == \"cmd.exe\") AND command_line=\"*(sethc.exe OR utilman.exe OR osk.exe OR narrator.exe OR magnify.exe)*\"\n\n Detection Notes \n\n- Pseudocode Event IDs are for Sysmon (Event ID 1 - process create) and Windows Security Log (Event ID 4688 - a new process has been created). \n- The Detection Pseudocode example looks for any creation of common accessibility processes such as sethc.exe but does no other filtering, which may result in false positives. Therefore, we recommend tuning any such analytics by including additional logic (e.g., testing the name of the parent process) that helps reduce false positives.\n\nAn adversary can use accessibility features (Ease of Access), such as StickyKeys or Utilman, to launch a command shell from the logon screen and gain SYSTEM access. Since an adversary does not have physical access to the machine, this technique must be run within Remote Desktop. To prevent an adversary from getting to the login screen without first authenticating, Network-Level Authentication (NLA) must be enabled. If a debugger is set up for one of the accessibility features, then it will intercept the process launch of the feature and instead execute a new command line. This analytic looks for instances of cmd.exe or powershell.exe launched directly from the logon process, winlogon.exe. \n\nSeveral accessibility programs can be run using the Ease of Access center\n\n- sethc.exe handles StickyKeys\n- utilman.exe is the Ease of Access menu\n- osk.exe runs the On-Screen Keyboard\n- narrator.exe reads screen text over audio\n- magnify.exe magnifies the view of the screen near the cursor\n\n Implementation 2 : Debuggers for Accessibility Applications \n\nDetection Pseudocode \n debuggers = filter process where (command_line match \"$.* .*(sethcutilmanosknarratormagnify)\\.exe\")\n\n Detection Notes \n\n- One simple way to implement this technique is to note that in a default Windows configuration there are no spaces in the path to the system32 folder. If the accessibility programs are ever run with a Debugger set, then Windows will launch the Debugger process and append the command line to the accessibility program. As a result, a space is inserted in the command line before the path. Looking for any instances of a space in the command line before the name of an accessibility program will help identify when Debuggers are set.\n- The Windows Registry location HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options allows for parameters to be set for applications during execution. One feature used by malicious actors is the \u201cDebugger\u201d option. When a key has this value enabled, a Debugging command line can be specified. Windows will launch the Debugging command line, and pass the original command line in as an argument. Adversaries can set a Debugger for Accessibility Applications. The analytic looks for the original command line as an argument to the Debugger. When the strings \u201csethc.exe\u201d, \u201cutilman.exe\u201d, \u201cosk.exe\u201d, \u201cnarrator.exe\u201d, and \u201cMagnify.exe\u201d are detected in the arguments, but not as the main executable, it is very likely that a Debugger is set.\n\nThis analytic could depend on the possibility of the known strings used as arguments for other applications used in the day-to-day environment. Although the chance of the string \u201csethc.exe\u201d being used as an argument for another application is unlikely, it still is a possibility.", "id": "", "modified": "2023-03-29T21:50:10.548Z", "object_marking_refs": ["marking-"], "relationship_type": "detects", "revoked": false, "source_ref": "x-mitre-data-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "3.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "0.1"}
{"created": "2021-06-03T22:26:00.781Z", "created_by_ref": "", "description": "[Bandook](https://attack.mitre.org/software/S0234) can support commands to execute Python-based payloads.(Citation: CheckPoint Bandook Nov 2020)", "external_references": [{"description": "Check Point. (2020, November 26). Bandook: Signed & Delivered. Retrieved May 31, 2021.", "source_name": "CheckPoint Bandook Nov 2020", "url": "https://research.checkpoint.com/2020/bandook-signed-delivered/"}], "id": "", "modified": "2021-06-03T22:26:00.781Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2020-07-16T15:51:25.693Z", "created_by_ref": "", "description": "[InvisiMole](https://attack.mitre.org/software/S0260) can replace legitimate software or documents in the compromised network with their trojanized versions, in an attempt to propagate itself within the network.(Citation: ESET InvisiMole June 2020)", "external_references": [{"description": "Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.", "source_name": "ESET InvisiMole June 2020", "url": "https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_InvisiMole.pdf"}], "id": "", "modified": "2020-08-17T14:49:07.976Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2022-03-30T14:26:51.834Z", "created_by_ref": "", "description": "Monitor the use of application access tokens to interact with resources or services that do not fit the organization baseline. For example, an application that is not meant to read emails accessing users\u2019 mail boxes and potentially exfiltrating sensitive data, or a token associated with a cloud service account being used to make API calls from an IP address outside of the cloud environment.(Citation: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022)", "external_references": [{"description": "Dror Alon. (2022, December 8). Compromised Cloud Compute Credentials: Case Studies From the Wild. Retrieved March 9, 2023.", "source_name": "Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022", "url": "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/"}], "id": "", "modified": "2023-04-15T00:28:29.194Z", "object_marking_refs": ["marking-"], "relationship_type": "detects", "revoked": false, "source_ref": "x-mitre-data-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "3.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "0.1"}
{"created": "2019-08-26T15:27:12.987Z", "created_by_ref": "", "description": "[Kimsuky](https://attack.mitre.org/groups/G0094) has used a PowerShell-based keylogger as well as a tool called MECHANICAL to log keystrokes.(Citation: EST Kimsuky April 2019)(Citation: Securelist Kimsuky Sept 2013)(Citation: CISA AA20-301A Kimsuky)(Citation: Netscout Stolen Pencil Dec 2018)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi)", "external_references": [{"description": "Alyac. (2019, April 3). Kimsuky Organization Steals Operation Stealth Power. Retrieved August 13, 2019.", "source_name": "EST Kimsuky April 2019", "url": "https://blog.alyac.co.kr/2234"}, {"description": "An, J and Malhotra, A. (2021, November 10). North Korean attackers use malicious blogs to deliver malware to high-profile South Korean targets. Retrieved December 29, 2021.", "source_name": "Talos Kimsuky Nov 2021", "url": "https://blog.talosintelligence.com/2021/11/kimsuky-abuses-blogs-delivers-malware.html"}, {"description": "ASERT team. (2018, December 5). STOLEN PENCIL Campaign Targets Academia. Retrieved February 5, 2019.", "source_name": "Netscout Stolen Pencil Dec 2018", "url": "https://asert.arbornetworks.com/stolen-pencil-campaign-targets-academia/"}, {"description": "CISA, FBI, CNMF. (2020, October 27). https://us-cert.cisa.gov/ncas/alerts/aa20-301a. Retrieved November 4, 2020.", "source_name": "CISA AA20-301A Kimsuky", "url": "https://us-cert.cisa.gov/ncas/alerts/aa20-301a"}, {"description": "KISA. (n.d.). Phishing Target Reconnaissance and Attack Resource Analysis Operation Muzabi. Retrieved March 7, 2022.", "source_name": "KISA Operation Muzabi", "url": "https://www.boho.or.kr/krcert/publicationView.do?bulletin_writing_sequence=35936"}, {"description": "Tarakanov , D.. (2013, September 11). The \u201cKimsuky\u201d Operation: A North Korean APT?. Retrieved August 13, 2019.", "source_name": "Securelist Kimsuky Sept 2013", "url": "https://securelist.com/the-kimsuky-operation-a-north-korean-apt/57915/"}], "id": "", "modified": "2022-04-12T18:23:04.595Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "revoked": false, "source_ref": "intrusion-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "2.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2017-12-14T16:46:06.044Z", "created_by_ref": "", "description": "The discovery modules used with [Duqu](https://attack.mitre.org/software/S0038) can collect information on open windows.(Citation: Symantec W32.Duqu)", "external_references": [{"description": "Symantec Security Response. (2011, November). W32.Duqu: The precursor to the next Stuxnet. Retrieved September 17, 2015.", "source_name": "Symantec W32.Duqu", "url": "https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_duqu_the_precursor_to_the_next_stuxnet.pdf"}], "id": "", "modified": "2019-04-24T23:18:53.152Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2022-03-30T14:26:51.871Z", "created_by_ref": "", "description": "Monitor for unexpected processes interacting with lsass.exe.(Citation: Medium Detecting Attempts to Steal Passwords from Memory) Common credential dumpers such as  [Mimikatz](https://attack.mitre.org/software/S0002) access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details, including Kerberos tickets, are stored. Monitor for unusual processes accessing\u00a0secrets.ldb and .secrets.mkey located in /var/lib/sss/secrets/.", "external_references": [{"description": "French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.", "source_name": "Medium Detecting Attempts to Steal Passwords from Memory", "url": "https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea"}], "id": "", "modified": "2022-04-20T01:40:12.952Z", "object_marking_refs": ["marking-"], "relationship_type": "detects", "revoked": false, "source_ref": "x-mitre-data-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "2.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "0.1"}
{"created": "2017-05-31T21:33:27.072Z", "created_by_ref": "", "description": "[FIN6](https://attack.mitre.org/groups/G0037) used the Plink command-line utility to create SSH tunnels to C2 servers.(Citation: FireEye FIN6 April 2016)", "external_references": [{"description": "FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.", "source_name": "FireEye FIN6 April 2016", "url": "https://www2.fireeye.com/rs/848-DID-242/images/rpt-fin6.pdf"}], "id": "", "modified": "2020-03-20T23:51:21.195Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "intrusion-", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2021-04-13T20:27:51.717Z", "created_by_ref": "", "description": "[Mustang Panda](https://attack.mitre.org/groups/G0129) has searched the entire target system for DOC, DOCX, PPT, PPTX, XLS, XLSX, and PDF files.(Citation: Avira Mustang Panda January 2020)", "external_references": [{"description": "Hamzeloofard, S. (2020, January 31). New wave of PlugX targets Hong Kong | Avira Blog. Retrieved April 13, 2021.", "source_name": "Avira Mustang Panda January 2020", "url": "https://www.avira.com/en/blog/new-wave-of-plugx-targets-hong-kong"}], "id": "", "modified": "2021-04-13T20:27:51.717Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "intrusion-", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2021-02-18T18:57:50.045Z", "created_by_ref": "", "description": "[Conti](https://attack.mitre.org/software/S0575) can stop up to 146 Windows services related to security, backup, database, and email solutions through the use of net stop.(Citation: CarbonBlack Conti July 2020)", "external_references": [{"description": "Baskin, B. (2020, July 8). TAU Threat Discovery: Conti Ransomware. Retrieved February 17, 2021.", "source_name": "CarbonBlack Conti July 2020", "url": "https://www.carbonblack.com/blog/tau-threat-discovery-conti-ransomware/"}], "id": "", "modified": "2021-04-13T19:18:37.319Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "[Ke3chang](https://attack.mitre.org/groups/G0004) has used compromised credentials and a .NET tool to dump data from Microsoft Exchange mailboxes.(Citation: NCC Group APT15 Alive and Strong)(Citation: Microsoft NICKEL December 2021)", "external_references": [{"description": "Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.", "source_name": "NCC Group APT15 Alive and Strong", "url": "https://research.nccgroup.com/2018/03/10/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/"}, {"description": "MSTIC. (2021, December 6). NICKEL targeting government organizations across Latin America and Europe. Retrieved March 18, 2022.", "source_name": "Microsoft NICKEL December 2021", "url": "https://www.microsoft.com/security/blog/2021/12/06/nickel-targeting-government-organizations-across-latin-america-and-europe"}], "id": "", "modified": "2022-03-22T15:05:00.616Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "intrusion-", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2023-02-10T18:44:17.945Z", "created_by_ref": "", "description": "[SVCReady](https://attack.mitre.org/software/S1064) can send collected data in JSON format to its C2 server.(Citation: HP SVCReady Jun 2022) ", "external_references": [{"description": "Schlapfer, Patrick. (2022, June 6). A New Loader Gets Ready. Retrieved December 13, 2022.", "source_name": "HP SVCReady Jun 2022", "url": "https://threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/"}], "id": "", "modified": "2023-04-12T15:17:39.261Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "revoked": false, "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "3.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "0.1"}