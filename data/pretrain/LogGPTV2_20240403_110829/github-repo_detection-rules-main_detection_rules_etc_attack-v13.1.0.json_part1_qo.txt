{"created": "2022-03-30T14:26:51.866Z", "created_by_ref": "", "description": "Monitor for newly constructed files that may abuse resource forks to hide malicious code or executables to evade detection and bypass security applications.", "id": "", "modified": "2022-03-30T14:26:51.866Z", "object_marking_refs": ["marking-"], "relationship_type": "detects", "source_ref": "x-mitre-data-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "2.1.0", "x_mitre_modified_by_ref": ""}, {"created": "2017-12-14T16:46:06.044Z", "created_by_ref": "", "description": "[Remsec](https://attack.mitre.org/software/S0125) is capable of deleting files on the victim. It also securely removes itself after collecting and exfiltrating data.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Full Report)(Citation: Kaspersky ProjectSauron Technical Analysis)", "external_references": [{"description": "Symantec Security Response. (2016, August 8). Backdoor.Remsec indicators of compromise. Retrieved August 17, 2016.", "source_name": "Symantec Remsec IOCs", "url": "http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Symantec_Remsec_IOCs.pdf"}, {"description": "Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Retrieved August 17, 2016.", "source_name": "Kaspersky ProjectSauron Full Report", "url": "https://securelist.com/files/2016/07/The-ProjectSauron-APT_research_KL.pdf"}, {"description": "Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.", "source_name": "Kaspersky ProjectSauron Technical Analysis", "url": "https://securelist.com/files/2016/07/The-ProjectSauron-APT_Technical_Analysis_KL.pdf"}], "id": "", "modified": "2020-03-11T17:45:33.570Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2022-03-30T14:26:51.876Z", "created_by_ref": "", "description": "Monitor network traffic for WMI connections for potential use to remotely edit configuration, start services, or query files. When remote WMI requests are over RPC it connects to a DCOM interface within the RPC group netsvcs. To detect this activity, a sensor is needed at the network level that can decode RPC traffic or on the host where the communication can be detected more natively, such as\u00a0Event Tracing for Windows. Using wireshark/tshark decoders, the WMI interfaces can be extracted so that WMI activity over RPC can be detected. Although the description details how to detect remote WMI precisely, a decent estimate has been to look for the string RPCSS within the initial RPC connection on 135/tcp. It returns a superset of this activity, and will trigger on all DCOM-related services running within RPC, which is likely to also be activity that should be detected between hosts. More about RPCSS at :\u00a0rpcss_dcom_interfaces.html\n\nAfter the WMI connection has been initialized, a process can be remotely launched using the command:\u00a0wmic /node:\"\" process call create \"\", which is detected in the third Detection Pseudocode. \n\nThis leaves artifacts at both a network (RPC) and process (command line) level. When wmic.exe (or the schtasks API) is used to remotely create processes, Windows uses RPC (135/tcp) to communicate with the the remote machine.\n\nAfter RPC authenticates, the RPC endpoint mapper opens a high port connection, through which the schtasks Remote Procedure Call is actually implemented. With the right packet decoders, or by looking for certain byte streams in raw data, these functions can be identified.\n\nWhen the command line is executed, it has the parent process of\u00a0C:\\windows\\system32\\wbem\\WmiPrvSE.exe. This analytic looks for these two events happening in sequence, so that the network connection and target process are output.\n\nCertain strings can be identifiers of the WMI by looking up the interface UUID for IRemUnknown2 in different formats\n- UUID\u00a000000143-0000-0000-c000-000000000046\u00a0(decoded)\n- Hex\u00a043 01 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\u00a0(raw)\n- ASCII\u00a0CF\u00a0(printable text only)\n\nThis identifier is present three times during the RPC request phase. Any sensor that has access to the byte code as raw, decoded, or ASCII could implement this analytic. The transfer syntax is\n- UUID\u00a08a885d04-1ceb-11c9-9fe8-08002b104860\u00a0(decoded)\n- Hex\u00a004 5d 88 8a eb 1c c9 11 9f e8 08 00 2b 10 48 60\u00a0(raw)\n- ASCII `]+H`` (printable text only)\n\nThus, a great ASCII based signature is\n- *CF*]+H*CF*CF*host*\"\n\n Implementation 1 : Remote WMI over RPC\n\nDetection Pseudocode\nwmi_flow = filter network_flow where (dest_port == 135 and proto_info.rpc_interface == \"IRemUnknown2\")\n\nDetection Notes\n\n- To detect WMI over RPC (using DCOM), a sensor needs to exist that has the insight into individual connections and can actually decode and make sense of RPC traffic. Specifically, WMI can be detected by looking at RPC traffic where the target interface matches that of WMI, which is IRemUnknown2.\n\n\n Implementation 2 : Remotely Launched Executables via WMI\nDetection Pseudocode\nwmi_children = filter processes where (parent_process == \u201cwmiprvse.exe\u201d)\nwmi_flow = filter network flow where (src_port \u2265 49152 and dest_port \u2265 49152 and proto_info.rpc_interface == \u201cIRemUnknown2\u201d)\nremote_wmi_process = join wmi_children, wmi_flow where (wmi_flow.time \n\nDetection Notes\n\n-Look for instances of the WMI querying in network traffic, and find the cases where a process is launched immediately after a connection is seen. This essentially merges the request to start a remote process via WMI with the process execution. If other processes are spawned from\u00a0wmiprvse.exe in this time frame, it is possible for race conditions to occur, and the wrong process may be merged. If this is the case, it may be useful to look deeper into the network traffic to see if the desired command can be extracted.\n", "id": "", "modified": "2023-03-21T00:13:48.117Z", "object_marking_refs": ["marking-"], "relationship_type": "detects", "revoked": false, "source_ref": "x-mitre-data-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "3.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "0.1"}
{"created": "2019-09-23T23:08:25.407Z", "created_by_ref": "", "description": "[APT41](https://attack.mitre.org/groups/G0096) used cmd.exe /c to execute commands on remote machines.(Citation: FireEye APT41 Aug 2019)\n[APT41](https://attack.mitre.org/groups/G0096) used a batch file to install persistence for the [Cobalt Strike](https://attack.mitre.org/software/S0154) BEACON loader.(Citation: FireEye APT41 March 2020)", "external_references": [{"description": "Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.", "source_name": "FireEye APT41 Aug 2019", "url": "https://www.mandiant.com/sites/default/files/2022-02/rt-apt41-dual-operation.pdf"}, {"description": "Glyer, C, et al. (2020, March). This Is Not a Test: APT41 Initiates Global Intrusion Campaign Using Multiple Exploits. Retrieved April 28, 2020.", "source_name": "FireEye APT41 March 2020", "url": "https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html"}], "id": "", "modified": "2023-03-23T15:27:10.532Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "revoked": false, "source_ref": "intrusion-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "3.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2020-06-25T18:24:00.644Z", "created_by_ref": "", "description": "[WindTail](https://attack.mitre.org/software/S0466) can instruct the OS to execute an application without a dock icon or menu.(Citation: objective-see windtail1 dec 2018)", "external_references": [{"description": "Wardle, Patrick. (2018, December 20). Middle East Cyber-Espionage analyzing WindShift's implant: OSX.WindTail (part 1). Retrieved October 3, 2019.", "source_name": "objective-see windtail1 dec 2018", "url": "https://objective-see.com/blog/blog_0x3B.html"}], "id": "", "modified": "2020-06-25T18:24:00.644Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2022-03-30T14:26:51.850Z", "created_by_ref": "", "description": "Monitor for contextual data about an account, which may include a username, user ID, environmental data that may mask the presence of user accounts they create or modify. On macOS, identify users with an userID under 500 and the Hide500Users key value in the /Library/Preferences/com.apple.loginwindow plist file set to TRUE.(Citation: Cybereason OSX Pirrit)", "external_references": [{"description": "Amit Serper. (2016). Cybereason Lab Analysis OSX.Pirrit. Retrieved December 10, 2021.", "source_name": "Cybereason OSX Pirrit", "url": "https://cdn2.hubspot.net/hubfs/3354902/Content%20PDFs/Cybereason-Lab-Analysis-OSX-Pirrit-4-6-16.pdf"}], "id": "", "modified": "2022-03-30T14:26:51.850Z", "object_marking_refs": ["marking-"], "relationship_type": "detects", "source_ref": "x-mitre-data-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "2.1.0", "x_mitre_modified_by_ref": ""}, {"created": "2020-05-21T21:31:34.273Z", "created_by_ref": "", "description": "[Pony](https://attack.mitre.org/software/S0453) has collected the Service Pack, language, and region information to send to the C2.(Citation: Malwarebytes Pony April 2016)\t", "external_references": [{"description": "hasherezade. (2016, April 11). No money, but Pony! From a mail to a trojan horse. Retrieved May 21, 2020.", "source_name": "Malwarebytes Pony April 2016", "url": "https://blog.malwarebytes.com/threat-analysis/2015/11/no-money-but-pony-from-a-mail-to-a-trojan-horse/"}], "id": "", "modified": "2020-06-15T21:31:38.116Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2022-04-11T15:03:28.684Z", "created_by_ref": "", "description": "[Clambling](https://attack.mitre.org/software/S0660) has the ability to capture screenshots.(Citation: Trend Micro DRBControl February 2020)", "external_references": [{"description": "Lunghi, D. et al. (2020, February). Uncovering DRBControl. Retrieved November 12, 2021.", "source_name": "Trend Micro DRBControl February 2020", "url": "https://documents.trendmicro.com/assets/white_papers/wp-uncovering-DRBcontrol.pdf"}], "id": "", "modified": "2022-04-11T15:03:28.684Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "revoked": false, "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "2.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "0.1"}
{"created": "2022-06-01T18:50:24.411Z", "created_by_ref": "", "description": "[Tarrask](https://attack.mitre.org/software/S1011) is able to delete the Security Descriptor (`SD`) registry subkey in order to \u201chide\u201d scheduled tasks.(Citation: Tarrask scheduled task)", "external_references": [{"description": "Microsoft Threat Intelligence Team & Detection and Response Team . (2022, April 12). Tarrask malware uses scheduled tasks for defense evasion. Retrieved June 1, 2022.", "source_name": "Tarrask scheduled task", "url": "https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/"}], "id": "", "modified": "2022-10-18T14:52:50.824Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "revoked": false, "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "2.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "0.1"}
{"created": "2020-06-10T21:56:40.245Z", "created_by_ref": "", "description": "[Sandworm Team](https://attack.mitre.org/groups/G0034) has created VBScripts to run an SSH server.(Citation: ESET BlackEnergy Jan 2016)(Citation: ESET Telebots Dec 2016)(Citation: ESET Telebots June 2017)(Citation: Dragos Crashoverride 2018) ", "external_references": [{"description": "Cherepanov, A.. (2016, December 13). The rise of TeleBots: Analyzing disruptive KillDisk attacks. Retrieved June 10, 2020.", "source_name": "ESET Telebots Dec 2016", "url": "https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/"}, {"description": "Cherepanov, A.. (2016, January 3). BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric industry . Retrieved June 10, 2020.", "source_name": "ESET BlackEnergy Jan 2016", "url": "https://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/"}, {"description": "Cherepanov, A.. (2017, June 30). TeleBots are back: Supply chain attacks against Ukraine. Retrieved June 11, 2020.", "source_name": "ESET Telebots June 2017", "url": "https://www.welivesecurity.com/2017/06/30/telebots-back-supply-chain-attacks-against-ukraine/"}, {"description": "Joe Slowik. (2018, October 12). Anatomy of an Attack: Detecting and Defeating CRASHOVERRIDE. Retrieved December 18, 2020.", "source_name": "Dragos Crashoverride 2018", "url": "https://www.dragos.com/wp-content/uploads/CRASHOVERRIDE2018.pdf"}], "id": "", "modified": "2022-06-30T20:19:13.583Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "revoked": false, "source_ref": "intrusion-", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "2.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2019-06-28T20:48:52.460Z", "created_by_ref": "", "description": "[PUNCHBUGGY](https://attack.mitre.org/software/S0196) has saved information to a random temp file before exfil.(Citation: Morphisec ShellTea June 2019)", "external_references": [{"description": "Gorelik, M.. (2019, June 10). SECURITY ALERT: FIN8 IS BACK IN BUSINESS, TARGETING THE HOSPITALITY INDUSTRY. Retrieved June 13, 2019.", "source_name": "Morphisec ShellTea June 2019", "url": "http://blog.morphisec.com/security-alert-fin8-is-back"}], "id": "", "modified": "2020-03-17T14:47:59.945Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2021-04-27T01:47:15.612Z", "created_by_ref": "", "description": "[Caterpillar WebShell](https://attack.mitre.org/software/S0572) can upload files over the C2 channel.(Citation: ClearSky Lebanese Cedar Jan 2021) ", "external_references": [{"description": "ClearSky Cyber Security. (2021, January). \u201cLebanese Cedar\u201d APT Global Lebanese Espionage Campaign Leveraging Web Servers. Retrieved February 10, 2021.", "source_name": "ClearSky Lebanese Cedar Jan 2021", "url": "https://www.clearskysec.com/wp-content/uploads/2021/01/Lebanese-Cedar-APT.pdf"}], "id": "", "modified": "2021-04-27T01:47:15.612Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-04-18T17:59:24.739Z", "created_by_ref": "", "description": "[POWERSTATS](https://attack.mitre.org/software/S0223) can delete all files on the C:\\, D:\\, E:\\ and, F:\\ drives using [PowerShell](https://attack.mitre.org/techniques/T1059/001) Remove-Item commands.(Citation: FireEye MuddyWater Mar 2018)", "external_references": [{"description": "Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018.", "source_name": "FireEye MuddyWater Mar 2018", "url": "https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html"}], "id": "", "modified": "2020-03-31T22:21:47.653Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2022-09-22T00:34:44.821Z", "created_by_ref": "", "description": "During [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors used dynamic DNS services for C2.(Citation: McAfee Night Dragon)", "external_references": [{"description": "McAfee\u00ae Foundstone\u00ae Professional Services and McAfee Labs\u2122. (2011, February 10). Global Energy Cyberattacks: \u201cNight Dragon\u201d. Retrieved February 19, 2018.", "source_name": "McAfee Night Dragon", "url": "https://scadahacker.com/library/Documents/Cyber_Events/McAfee%20-%20Night%20Dragon%20-%20Global%20Energy%20Cyberattacks.pdf"}], "id": "", "modified": "2022-09-22T00:34:44.821Z", "object_marking_refs": ["marking-"], "relationship_type": "uses", "revoked": false, "source_ref": "", "target_ref": "attack-", "type": "relationship", "x_mitre_attack_spec_version": "2.1.0", "x_mitre_deprecated": false, "x_mitre_modified_by_ref": "", "x_mitre_version": "0.1"}