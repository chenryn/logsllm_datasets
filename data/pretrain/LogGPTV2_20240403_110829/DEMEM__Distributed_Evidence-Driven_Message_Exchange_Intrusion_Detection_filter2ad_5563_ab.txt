may  take  advantage  of  this  characteristic  to  launch  various  routing  attacks.  These 
attacks, shown in the attack model, can be new attacks in MANET and are difficult to 
be  detected.  A  new  intrusion  detection  mechanism  must  be  developed  in  order  to 
detect these new attacks. 
Second,  since  MANET  is  a  fully  distributed  environment  without  a  centralized 
point,  IDS  cannot  detect  these  routing  attacks  if  each  distributed  detector  does  not 
have  monitoring  information  from  others.  Therefore,  IDS  needs  a  practical  and 
scalable  architecture  to  gather  sufficient  evidence  in  order  to  detect  the  attacks 
effectively. 
Third, because  of  mobility,  the  network  topology  in  MANET  is  highly  dynamic, 
and  the  changes  are  unpredictable.  Detectors  must  have  sufficient,  up-to-date 
evidence in real time to detect the attacks with low false positives and negatives. In 
addition, wireless links between mobile nodes in MANET are much more unreliable 
than  those  in  a  wired  network,  so  the  detection  mechanism  must  be  capable  of 
tolerating  message  loss  in  order  to  have  sufficient  data  in  time  and  to  maintain 
detection accuracy. 
Furthermore,  mobile  nodes  in  MANET  usually  have  limited  bandwidth  and 
computation power. MANET is very sensitive to message overhead generated by IDS. 
High computation  mechanisms, such as the public key  system,  may cause denial of 
service  attacks  and  are  not  suitable  in  MANET.  For performance  consideration,  the 
detectors are required to generate low message and computation overhead. 
Finally, nodes in MANET do not have trust management between them, such that 
attacks  may  propagate  and  paralyze  the  network  quickly.  Detectors  should 
automatically  terminate  the  attacks  and  recover  the  routing  topology  in  real  time  in 
order to minimize the attack damage in time. To design a practical and effective IDS, 
we  conclude  the  essential  requirements  for  satisfying  these  unique  challenges  in 
MANET(see Fig 1).  
254 
C.H. Tseng et al. 
Challenge 
New routing attacks 
Fully distributed environment 
Dynamic and unpredictable topology 
Requirement 
Capable of precisely detecting new attacks  
Practical and scalable detection architecture  
Sufficient, up-to-date evidence for detection  
Unreliable wireless link 
Tolerant of message loss 
Limited bandwidth and computation power
Low message and computation overhead 
No trust management 
Automatic real time routing recovery 
Fig. 1. Challenges vs. Requirements of IDS in MANET 
4   Distributed Evidence-Driven Message Exchange Intrusion 
Detection Model 
DEMEM is a solid, scalable, and low message exchange overhead intrusion detection 
model for MANET. DEMEM is proposed to overcome the challenges mentioned in 
3.3  through  the  following  three  main  features:  distributed  architecture,  intrusion 
detection layer, and evidence-driven message exchange technique.  
4.1   Distributed IDS Architecture 
DEMEM is developed to adapt to the distributed and cooperative nature of MANET. 
In DEMEM, each node acts as a detector to monitor its 1-hop neighbors by validating 
routing  messages  that  it  receives  for  intrusion  detection  purposes.  In  other  words, 
while a node sends a routing message, all of its neighbors validate the correctness of 
this message. As seen in Fig. 2, node A acts as a detector to monitor nodes B, C, and 
S  while  nodes  B,  C,  and  S  are  also  detectors  of  monitor  node  A’s  activities.  In 
addition to monitoring activities between 1-hop neighbors, 2-hop neighbors may have 
to exchange their observed information by tailored Intrusion Detection (ID) Messages 
to  gather  enough  evidence  for  detection  purposes.  Obviously,  different  MANET 
routing  protocols  require  different  ID  messages  and  exchange  these  ID  messages 
differently.  This  approach  eliminates  complicated 
topology  maintenance  and 
expensive  unreliable  promiscuous  monitoring  required  by  hierarchical  cooperative 
intrusion detection [10].  
4.2   Intrusion Detection Layer 
Many  works have been done on secured routing protocols in MANET [1,2,3,13] by 
modifying  protocols.  However,  it  takes  a  long  time  for  these  modified  protocols  to 
become mature in order to be accepted as standards by authorized organizations, such 
as IETF. Therefore, we propose an Intrusion Detection (ID) Layer concept that does 
not depend on any changes of protocols but achieves security goals. As seen in Fig. 2, 
the detector acts as an Intrusion Detection layer between the routing protocol and the 
IP  layer  within  a  node.  The  detector  intercepts  all  incoming  and  outgoing  routing 
messages  from  the  IP  layer  and  to  the  IP  layer.    Although  DEMEM  have  new 
proposed  ID  messages,  the  ID  layer  handles  these  ID  messages  so  that  the  routing 
layer  is  unaware  of  their  existence.  Therefore,  DEMEM  does  not  require  changing 
routing protocols but achieves the same protection as other secured protocols. 
DEMEM: Distributed Evidence-Driven Message Exchange Intrusion Detection 
255 
C
S
ID Message 
for local 
neighbors 
B
A
Detectors 
validate routing 
messages from 
neighbors  
Detector acts as 
ID layer 
processing 
ingoing & 
outgoing 
routing 
messages 
Routing 
Outgoing 
Message 
Intrusion Detection 
ID Message
Incoming 
Message
Authentication 
IP
Fig. 2. Distributed detectors and Intrusion Detection layer in DEMEM 
integrates  cryptographic 
In  addition,  DEMEM  also 
techniques  (such  as 
TESLA[22])  residing  in  the  authentication  layer  between  the  IP  layer  and  the  ID 
layer. The authentication layer has two major tasks. First, the layer signs the sender’s 
address in outgoing messages. If the node is the message originator and the message 
will be forwarded by its neighbors, then the layer signs the whole message to protect 
message  integrity.  Second,  while  receiving  incoming  messages  (including  ID 
messages) from neighbors, the authentication layer authenticates the sender’s address. 
If the sender is not the originator, the layer authenticates the whole message to ensure 
message  integrity.  Thus,  the  authentication  layer  protects  the  integrity  of  forwarded 
messages and prevents impersonation. 
4.3   Evidence-Driven Message Exchange  
A  main  contribution  of  DEMEM  is  that  it  adds  ID  messages  to  assist  intrusion 
detection.  Sending ID  messages effectively and efficiently among detectors is  very 
critical,  because  message  overhead  introduced  by  ID  messages  must  be  low  in  a 
resource-limited MANET. In order to minimize ID message overhead, we propose an 
evidence-driven  approach  that  has  better  performance  than  the  periodic-update 
approach.  
Evidence is the critical message content of the protecting protocol to validate the 
correctness  of  protocol  messages.  For  example,  in  OLSR,  evidence  is  the  1-hop 
neighbor,  Multi-Point  Relay  (MPR)  and  MPR  selector.  In  AODV,  evidence  is  the 
sequence  number  and  hop  count.  New  Evidence  means  any  update  between  the 
current and the old evidence observed by a detector. For example, assume that node 
A’s  1-hop  neighbor  list  is  {B,  C}  at  time  t1.  At  time  t2,  node  A’s  neighbor  list 
becomes  {B,  C,  D}  so  that  node  A’s  new  evidence  at  time  t2  is  D.  In  conclusion, 
sending  New  Evidence  guarantees  each  detector’s  Evidence  is  up-to-date.  In 
DEMEM,  detectors  send  ID  messages  only  when  they  observe  or  require  new 
Evidence. 
256 
C.H. Tseng et al. 
Monitor 
Manager 
Routing Msg  
ID Msg 
Evidence 
Manager 
Validate    
Msg
Validation 
Manager 
New 
Evidence
Forwarding 
Manager 
Send ID 
Msg 
No 
Alarm 
Violation 
Detected
Response 
Manager 
Attack 
Recovery
Fig. 3. DEMEM Finite State Machine (FSM) within a detector 
Fig.  3  illustrates  how  this  event-driven  message  exchange  task  works  with  the 
detection task. DEMEM consists of the  five components, called ID  Managers, that 
are  present  at  every  node.  In  the  beginning,  the  Monitor  manager  intercepts 
incoming  and  outgoing  routing  messages  and  handles  ID  messages.  The  Evidence 
manager  records  Evidence  in  the  routing  and  ID  messages.  While  the  Evidence 
manager observes New Evidence from outgoing routing  messages,  the  Forwarding 
manager  sends ID messages to trigger or to deliver this observed New Evidence to 
nodes  who  require  it.  After  receiving  an  incoming  routing  message,  the  Evidence 
manager will pass this incoming message and the related Evidence to the Validation 
manager  to  validate  the  message’s  correctness  by  the  security  policies.  Once  the 
Validation  manager  detects  violations  of  security  policies,  the  Response  manager 
analyzes  the  violations  and  performs  proper  attack  recovery.  Finally,  the  task  goes 
back to the Monitor manager for the next message. 
We  have  implemented  DEMEM  in  OLSR  as  demonstrated  in  sections  5  and  6. 
Discussion on applying DEMEM to two popular reactive protocols, AODV and DSR, 
and to another famous proactive protocol, TBRPF, is presented in section 7. 
5   DEMEM in OLSR 
5.1   Routing Attack Methods in OLSR 
OLSR is a link-state, proactive routing protocol in MANET. OLSR utilizes periodical 
Hello and Topology Control (TC) messages to establish a complete network topology 
among nodes and reduces message flooding overhead with MPRs, a minimum subset 
of  1-hop  neighbors  connecting  all  2-hop  neighbors.  OLSR  provides  a  robust  and 
complete routing topology as well as tolerates message loss caused by mobility and 
noise such that OLSR has more complete and reliable routing data than others (such 
as reactive protocols) in MANET.  
In OLSR, the computation of routing tables depends on three critical fields in Hello 
and  TC  messages:  1-hop  neighbors  and  MPRs  in  Hello  message  as  well  as  MPR 
selectors  in  TC  messages.  A  node  can  send  three  types  of  basic  OLSR  messages: 
Hello,  initiated  TC,  and  forward  TC  messages.  Thus,  an  attacker  has  four  attack 
methods against OLSR routing:  
DEMEM: Distributed Evidence-Driven Message Exchange Intrusion Detection 
257 
1.  Forging 1-hop neighbors in an initiated Hello; 
2.  Forging MPRs in an initiated Hello;  
3.  Forging MPR selectors in an initiated TC; and  
4.  Forging MPR selectors in a forwarded TC.  
The first three attack methods belong to the first type of attack model described in 
3.2,  and  the  fourth  one  belongs  to  the  second  type  of  attack  model.  These  attack 
methods can be used to add or to delete links in OLSR topology. A single attacker can 
utilize these attack methods to launch various novel and sophisticated routing attacks 
against  OLSR  severely,  such  as  man-in-the-middle  attacks  and  denial  of  service 
attacks.  
In section 5.3, we demonstrate how to apply DEMEM in OLSR to precisely detect 
and recover attacks using the first three attack methods. The example scenario in 6.1 
illustrates an example attack and detecting mechanism in detail. The ongoing work in 
7.1 can prevent attacks using the last attack method. 
5.2   Specification-Based Intrusion Detection 
In  MANET,  nodes  sharing  partial  topology  information  and  overlapped  topology 
information  of  their  routing  packets  must  be  consistent.  Although  it  is  difficult  to 
detect attacks launched by forging initiated routing packets, contents of these forged 
packets  will  not  be  consistent  with  genuine  routing  packets  that  have  overlapped 
routing  information.  Therefore,  the  detector  can  detect  these  forged  packets  by 
validating  consistency  among  related  routing  messages.  The  specification-based 
intrusion detection  model [14] describes four constraints (see Fig. 4) to validate the 
correctness of Hello and TC messages in OLSR.  