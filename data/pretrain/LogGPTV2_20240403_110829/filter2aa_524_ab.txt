CDMA Terminology 
• No SIM Cards needed here 
• Unlike the IMSI, the MIN is just a 10 digit phone number, 
sometimes the same as your actual phone number 
GSM 
CDMA 
Device ID 
IMEI 
ESN (Now MEID) 
Subscriber ID 
IMSI 
MIN 
User Phone # 
MSISDN 
MDN 
49 
• ESN (Electronic Serial Number) 
• CDMA-specific ID number: “11 EE 4B 55” 
• MEID (Mobile Equipment Identifier) 
• ESNs ran out! MEID is successor 
• Pseudo ESN used for backwards compatibility with 
handsets using MEIDs: “80 11 EE 4B” 
• (Phones often ALSO have an IMEI for global or 4G) 
CDMA Terminology 
50 
• Every time you make a call, MIN and MEID or ESN sent 
unencrypted to the tower to identify you 
• That used to be it, and cloning was rampant 
Cloning basics – Real Towers 
MIN, MEID/ESN 
51 
• CAVE (Cellular Authentication and Voice Encryption) 
• Every phone has a secret A-Key, which generates two 
derivative keys used to authenticate every call and message, 
as well as encrypt voice traffic over the air 
• The A-Key is never shared over the network, but the 
derivative keys are used for every call 
Enter the CAVE 
52 
• The femtocell acts just like any other tower, except it 
doesn’t actually require the MEID 
• ESN is used with older devices, and pESN is used instead 
of MEID on newer devices 
Connecting to a Femtocell 
(p)ESN, MIN 
53 
• The femtocell does not use MEIDs for authentication at all, 
only the (p)ESN and MIN 
• And most importantly, the femtocell didn’t require CAVE! 
• This means that a  “classic” clone with just the (p)ESN and 
MIN would work - as long as the attacker’s clone is connected 
to a femtocell 
• We just need the (p)ESN and MIN of our victim 
Remember Your Failure At The CAVE… 
(p)ESN, MIN 
54 
• (p)ESN/MIN values are passed through the femtocell in a 
registration packet whenever ANY phone comes within 
range 
• This allows cloning without physical access to phone 
The Perfect Clone 
55 
The Perfect Clone 
Step 1: Victim phone falls in range of 
rooted femtocell with sniffer 
Step 2: MIN and ESN are collected and 
cloned to a target device 
0x80123456 
(201) 555 - 1234 
Step 3: Target device is associated with 
a stock femtocell 
Step 4: Clone attained; calls and SMS 
can be made on behalf of original phone 
56 
Cloning Implications 
• Cloning can be flakey 
• Voice 
• The elusive 2.5-way call 
• SMS 
• Data 
• Not yet…. 
• Helpful definitions for our discussion: 
• Victim phone – the phone of a legitimate subscriber 
whose keys have been captured by a rogue femtocell 
• Target phone – the phone of an attacker that has been 
modified (cloned) to the legitimate victim phone 
57 
Cloning Scenario 0 
When the VICTIM phone is turned off or jammed  
• Everything works 
• Incoming Call 
• Outgoing Call 
• SMS 
58 
Cloning Scenario 1 
When both the TARGET and VICTIM phones are 
associated with the femtocell.  
• Outgoing Call 
• Forced drop 
• SMS 
• Incoming 
59 
Cloning Scenario 1 
When both the TARGET and VICTIM phones are 
associated with the femtocell.  
60 
• Incoming Call 
• Only one phone rings 
• Situation normal 
• Both phones ring 
• The race is on 
• “Two-and-a-half”-way call 
 Third Party Caller’s Voice 
 Target’s Voice 
 Victim’s Voice 
 Passive Association 
Carrier 
Cloning Scenario 2 
When only the TARGET phone is associated to the femtocell and 
the VICTIM phone is on an actual Verizon tower  
61 
• Outgoing Call 
• TARGET call is dropped 
• Two for one!  
• Incoming Call and SMS 
• Most recent carrier contact 
Carrier 
Cloning Data 
• Much more difficult 
• Need more keys 
• Valid NAI 
• HA 
• AAA 
62 
63 
Cloning Video 
http://www.youtube.com/watch?v=Ydo19YOzpzU 
Cloning: Patched 
The requirement for CAVE Authentication to be enabled 
takes place on the Carrier Network (not the femtocell). 
Accordingly, it was patched without requiring any 
software updates to the femtocell. 
64 
Femtocells are a Bad Idea 
65 
Major US Carrier Comparison 
Carrier 
Technology 
Femtocell? 
Verizon 
CDMA 
Yes 
Sprint 
CDMA 
Yes 
AT&T 
GSM 
Yes 
T-Mobile 
GSM 
No 
66 
• Harden the femtocell hardware and software 
• That might help except… 
Short Term Mitigations 
67 
“If an attacker has physical control over your computer… 
it’s not your computer anymore.” 
Root is always possible 
68 
• We got in through a serial port 
• JTAG / UART ports? 
• Reflash firmware? 
• Glitching Attacks? 
Root is always possible 
69 
Require phone registration 
• Capability currently 
exists 
Short Term Mitigations 
70 
Femtocell Handset Registration 
Vendor 
Tech 
Femtocell 
Requires Registration 
Verizon 
CDMA 
Yes 
No 
Optional per Femtocell 
Sprint 
CDMA 
Yes 
No 
Optional per Femtocell 
AT&T 
GSM 
Yes 
Yes! 
T-Mobile 
GSM 
No!  
Wi-Fi Calling 
N/A 
71 
Require phone registration 
• Capability currently 
exists 
• Protects against 
untargeted dragnets 
• Does not protect against 
isolation attacks 
Short Term Mitigations 
72 
• Get rid of ‘em 
• WiFi Calling 
• IPSec or SSL Tunnel 
• End-to-End encryption 
• OSTel & CSipSimple/Groundwire 
• RedPhone 
• ZRTP 
Long Term Mitigations 
73 
Fixes & Bandaids 
74 
• Short Term 
• Harden femtocell 
• Require registration 
• Long Term 
• No femtocells 
• Move to WiFi Calling 
• End-to-end Encryption 
Mitigation Summary 
75 
• How do I know if I’m connected to a femtocell? 
• Android - some phones display an icon when connected 
to a femtocell 
• Phones that Verizon modified 
• Not Stock Android, Not Third Party ROMs 
• iPhone – No visual indicator 
• All - Short beep at beginning of phone call (easy to miss) 
• But somewhere, there’s code written to detect them 
What Can I Do? 
76 
• Detects femtocells and 
puts you in airplane 
mode 
• http://github.com/isecp
artners/femtocatcher 
• Thanks immensely to 
Mira Thambireddy 
77 
Announcing FemtoCatcher 
• End-To-End Encryption 
• Voice 
• RedPhone 
• OSTel 
• SMS / Chat 
• TextSecure 
• Gibberbot 
• Silent Circle 
• Wickr 
• Browsing 
• VPN 
• Tor (Android: Orbot+Orweb       iOS:Onion  Browser) 
What Else Can I Do? 
78 
Future Work 
79 
• Custom Protocols 
• Heavily Proxied 
• Forced gzip 
• Chunked Encoding 
• SSL Middling 
• Advertised… 
• …or not (Nokia) 
WAP (Wireless Application Protocol) 
80 
WAP 
81 
Fuzzaaaaaaaaaaaaaaaaaing 
• What happens when you fuzz the baseband? 
82 
Internal Femtocell Network 
• Femtocell -> Femtocell (rsaxvc/BH2011) 
• Femtocell -> Internal Carrier Network (BH2011) 
83 
•
Doug DePerry 
• Senior Security Engineer at iSEC Partners 
• @dugdep 
• PI:EMAIL  
•
Tom Ritter 
• Principal Security Engineer at iSEC Partners 
• @TomRittervg 
• PI:EMAIL 
•
Thanks to 
•
RSAXVC & Doug Kelly 
•
Andrew Rahimi, Davis Gallinghouse, Tim Newsham 
• These guys did much of the hard work 
•
Mira, Michael, Pratik, Peter Oehlert, Joel Wallenstrom, and really all of iSEC  
Thank You & Questions? 
84