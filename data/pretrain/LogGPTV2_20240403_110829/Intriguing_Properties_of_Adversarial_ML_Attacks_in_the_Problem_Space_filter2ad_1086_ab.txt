whose deﬁnition is reached. Finally, we extract v, containing
all statements needed to construct the parameters at the entry
point. To do this, we compute a backward slice by traversing
the SDG in reverse. Note that while there is only one organ,
there are usually multiple veins to choose from, but only one
is necessary for the transplantation. When traversing the SDG,
class deﬁnitions that will certainly be already present in the
host are excluded (e.g., system packages such as android and
java). For example, for an Activity feature where the variable
intent references the target Activity of interest, we might
extract the invocation startActivity(intent) (entry point
Lo), the class implementation of the Activity itself along with
1Our approach is generic and it would be immediate to do the opposite,
i.e., transplant malicious code into a benign app. However, this would require
a dataset with annotated lines of malicious code. For this practical reason and
for the sake of clarity of this section, we consider only the scenario of adding
benign code parts to a malicious app.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 09:16:38 UTC from IEEE Xplore.  Restrictions apply. 
1338
OTHER
PROBLEM-SPACE CONSTRAINTS
THREAT MODEL
f
e
a
t
u
r
e
s
η
S
i
d
e
-
e
f
f
e
c
t
S
e
a
r
c
h
S
t
r
a
t
e
g
y
Π
P
l
a
u
s
i
b
i
l
i
t
y
Λ
P
r
e
p
r
o
c
e
s
s
i
n
g
R
o
b
u
s
t
n
e
s
s
t
o
c
o
n
s
i
d
e
r
e
d
.
N
o
n
e
e
x
p
l
i
c
i
t
l
y
c
a
m
e
r
a
.
o
r
d
i
s
t
a
n
c
e
o
f
t
h
e
s
p
e
c
i
ﬁ
c
i
l
l
u
m
i
n
a
t
i
o
n
r
o
b
u
s
t
t
o
:
D
i
s
c
u
s
s
e
d
t
h
e
b
u
t
u
s
e
n
o
t
o
f
Υ
S
e
m
a
n
t
i
c
s
P
r
e
s
e
r
v
e
d
i
s
c
o
n
s
t
r
a
i
n
e
d
|
|
δ
|
|
p
≤
δ
m
a
x
.
c
l
a
s
s
,
i
m
a
g
e
o
f
a
n
o
t
h
e
r
s
o
p
e
r
t
u
r
b
a
t
i
o
n
t
r
i
v
i
a
l
l
y
b
e
c
o
m
e
a
n
A
n
i
m
a
g
e
s
h
o
u
l
d
n
o
t
(
c
o
m
p
a
r
e
d
t
o
o
t
h
e
r
h
u
m
a
n
s
d
i
s
g
u
i
s
e
s
,
e
t
c
)
.
f
u
l
l
f
a
c
e
m
a
s
k
s
,
u
s
i
n
g
r
e
c
o
g
n
i
z
a
b
i
l
i
t
y
t
o
i
d
e
n
t
i
t
y
a
n
d
t
h
e
i
r
H
u
m
a
n
s
u
b
j
e
c
t
s
r
e
t
a
i
n
t
h
e
i
r
o
r
i
g
i
n
a
l
h
u
m
a
n
.
c
o
n
s
t
r
a
i
n
e
d
P
e
r
t
u
r
b
a
t
i
o
n
(
|
|
δ
|
|
p
≤
δ
m
a
x
)
,
a
r
e
i
m
p
e
r
c
e
p
t
i
b
l
e
t
o
a
t
o
e
n
s
u
r
e
t
h
e
c
h
a
n
g
e
s
l
e
g
i
t
i
m
a
t
e
w
i
t
h
e
y
e
g
l
a
s
s
f
r
a
m
e
s
t
r
a
n
s
i
t
i
o
n
s
s
o
t
h
e
(
i
i
)
S
m
o
o
t
h
p
i
x
e
l
(
i
)
P
e
r
t
u
r
b
a
t
i
o
n
c
o
n
s
t
r
a
i
n
e
d
(
|
|
δ
|
|
p
≤
δ
m
a
x
)
,
l
o
o
k
p
l
a
u
s
i
b
l
e
d
e
n
i
a
b
i
l
i
t
y
.
t
o
a
h
u
m
a
n
.
r
e
s
e
m
b
l
e
s
w
h
i
t
e
b
a
c
k
g
r
o
u
n
d
n
o
i
s
e
s
o
t
h
a
t
a
d
d
e
d
n
o
i
s
e
l
a
r
g
e
l
y
i
m
p
e
r
c
e
p
t
i
b
l
e
(
d
B
x
(
δ
)
c
o
n
s
t
r
a
i
n
e
d
P
e
r
t
u
r
b
a
t
i
o
n
≤
d
B
m
a
x
)
,
r
o
b
u
s
t
t
o
:
D
i
s
c
u
s
s
e
d
b
u
t
n
o
t
R
o
b
u
s
t
t
o
:
c
o
m
p
r
e
s
s
i
o
n
.
(
i
)
A
d
d
i
t
i
o
n
o
f
n
o
i
s
e
(
i
i
)
p
o
i
n
t
w
i
s