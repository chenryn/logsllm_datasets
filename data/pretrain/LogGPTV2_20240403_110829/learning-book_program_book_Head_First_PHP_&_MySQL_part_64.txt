explode（），可以将一个串分解为单独的子串数组。以下是一个例子：
explode(）面数根据一个公共分限符（也称为
定界符）将一个串分解为一个子串数组。
这个参数是我们希望“分解”
的文本。
$search_words=explode（''，'Tipper Cow'）;
_Ssearch_words变量现在存健了推索
这个参数告诉explode（）由什么符号分隔事中的子串，在
项数组，这些搜索项将输入到一
这里就是一个空格。这个分隔得可以指定一个或多个字
个SQL奎询中。
符，也称为定界符。
explode（）函数需要两个参数。第一个参数是定界符，这可以是一
个或多个字符，指示在哪里分解串。我们使用了一个空格符作为定界
符，这说明搜索串会在出现空格处进行分解。定界符本身不会包含在
最后得到的子串中。第二个参数是要分解的串。
每个子串存储为一个
空格定界衍控制了
单独的数组元素。
如何对事进行分解。
explode()
$search_words
为了把搜索项数组结合到RiskyJobs中，对RiskyJobs数据库运行查询之
前需要增加一行代码。现在如果有人在搜索域中输入“TipperCow”，
这个代码会把它分解为两个单词，并将各个单词存储在一个数组中
($search_words)。
explode(）面数将Suse_seatch中的各个单词存储
$user_search = S_GET['usersearch'];
在一个名为Ssearch_words的数组中。
$search_words =explode(',Suser_search);
510
第9章
---
## Page 547
串与定制函数
为了将分解后的搜索项结合到RiskyJobs应用中，必须把各个搜索项插人到一个使用
ExeRciSe
LIKE和OR的SQLSELECT查询中。例如，对于Ernesto之前关于“BullFighterMatador”
的搜索，查询可能如下所示：
现在搜索职位描述而不是职位名，因为描
述中有更多可以匹配的信息。
SELECT * FROM riskyjobs
description LIKE 'sMatador'
现在假设使用了以下PHP代码，希望由用户在RiskyJobs搜索表单中输入的搜索数据来
组装这个查询：
$where clause ='';
$user_search=$_GET['usersearch'];
$search_words =explode('',$user_search);
foreach ($search_words as $word)(
if (!empty($where_clause)){
000
Risky
$search_query.= " WHERE $where_clause";
J
Doye
Risky Jobs-Search
请写出Ernesto输入“BullFighterMatador”作
Find your risky job
uFete atio
为搜索项时这个代码生成的SQL查询，你认为
Sbma)
可能存在什么问题，请做出标注。
你现在的位置
511
---
## Page 548
练习答案
为了将分解后的搜索项结合到RiskyJobs应用中，必须把各个搜索项插入到一个使用
xeRciSe
LIKE和OR的SQLSELECT查询中。例如，对于Ernesto之前关于“BullFighterMatador
的搜索，查询可能如下所示：
现在搜索职位描述而不是职位名，因为
描述中有更多可以匹配的信息。
SELECT * FROM riskyjobs
description LIKE '%Matador'
现在假设使用了以下PHP代码，希望由用户在RiskyJobs搜索表单中输入的搜索数据来
组装这个查询：
$where clause ='';
$user_search=$_GET['usersearch'];
每个LKE子句都以一个OR结
Ssearch_words =explode('',$user_search);
尾来连接下一个LIKE，这遥用
于除最后一项以外的所有其
foreach (Ssearch_words as $word){
他各项。
$where_clause.=
"description LIKE'SSword%'OR";
追加到搜索壹询之前确保WHERE子句
不为室。
if (!empty($where_clause))(
Risky Jubs
$search_query
’WHERE $where_clause";
这个操作符将一个串联提到另一个串
aer nofog
的末属。
Risky Jobs-Search
请写出Ernesto输人“BullFighterMatador”作
Find your risky job:
Bu figher Matador
为搜索项时这个代码生成的SQL查询，你认为
hona)
可能存在什么问题，请做出标注。
SELECT * FROM tiskyjo6s
WHERE descriptionLKE‘%Bull%ORdesctiptionLKE‘%Fishter%'OR
desctiptionCKE‘%Matador%'
COR
这里在壹询的最后多了一个OR，这会导
致叠询失败！
512
第9章
---
## Page 549
串与定制函数
implode()由子串构造一个串
我们只需要在WHERE子句的LIKE之间加人OR，但不应在最后一个
LIKE后加OR。到底该怎么做呢？能不能在循环中增加一个特殊情
况，查看是否在处理最后一个搜索项，对于这一项则不加OR，这样可
将各个串合并为一个串
以吗？这是可行的，不过有些麻烦。一种更简捷的方法是使用一个与
时，各事之间金增加这个
explode（）函数作用正好相反的函数，即implode（）函数。它取
定界符。
个串数组，并由这些串构造单独的一个串。
$where_clause =implode('OR'，$where_list);
不
implode()函数返回一个串。
这必须是希望合并的一
个串数组。
是这样的，implode（）允许指定一个定界符，将各个串合并在一起时
会把这个定界符放在各个串之间。如果使用、OR作为定界符，就可
以构造一个合适的WHERE子句，其中只是各个LIKE子句之间有OR。
Sharpenyourpencil
重写生成RiskyJobs SELECT查询的PHP代码，使用implode（）函
数修正存在多余OR的问题。
你现在的位置
513
---
## Page 550
Sharpenyourpencil答案
Sharpenyourpencil
Solution
重写生成RiskyJobsSELECT查询的PHP代码，使用implode（）
函数修正多余OR的问题。
Sseatch_quety="SELECT*FROM tiskyjobs"
Swhete_list 二artay）
由于implode(）要接收一个待
Suset_seatch =S_CET[usetseatch]
连接串的数组，所以创建一
个LKE子句数组。
cripti
foreach (Sseatch_words as Sword){
采用这种方式时，目概作符与
Swhere_list]=“desctiptionLKE‘%Sword%"
amay_push）品数作用相它.
金
把新元素增加到数组末尾。
Swhere_clause =implodeCOR‘
Swhere_list)
传入implode(）的定界符是
"OR"
右两边分别有一个空格。
i（!empty(Swhete_clause)）{
WHERE Swhere_clause
合并结果将多个LKE
子句用OR连接在一起。
P
要使用implode（）面数
个LKE子句数组
首先
创建一
将它们存储在Swhere_list
并
%
数组中
好
implode(）
uo
$where_list
Swhere_clause
514
第9章
---
## Page 551
串与定制函数
运行测试
下面来测试RiskyJobs搜索表单。
从Head First Labs网站（www.headfirstlabs.com/books/hfphp)
下载RiskyJobs应用。search.php脚本包含了刚才分析的查询生成代码，
用于处理在search.html表单中输人的搜索数据。
将这个脚本和其他RiskyJobs文件上传到你的Web服务器，然后在一个Web
浏览器中打开搜索表单（search.html）。尝试几个不同的搜索，看看
你的查询生成代码表现如何。一定要试试Ernesto的“BullFighterMatador”
搜索，这可以很好地测试前面使用implode（）函数新写的代码。
000
RiskyJobs-Search
Risky
JObs
Dangert Your dream job is out there.
Do you have the guts to go find it?
Risky Jobs-Search Results
Job Tiie
Description
State
Date
Up and coming super rly geat weiglt1 boser needs se  MO
20K
有这么多职位可以选择！我想我可能没有能
Prize Fighter
1Z
力参与职业拳击，也不会修“电动公牛”
sloppy hads, and a glast jaw are prefened. No
cxpedeece mquired. This is not a fell-time salaried
不过我相信在这里能够找到理想的职位
positioe Well meet yoe in the alley belhed the rink
to shere the porsc.Let Run King make yuu 
总会找到的。
chempionship fighler, or et leest help you lose to
Lovely hovines wniting for your superior noE
ofe
Torecdor
2008-11·14
violent cape waving skils. Mu puss basic bul
21:49:31
fightieg aptitude test.
Electrie Bull
Hack's Honky Tunk needs at expecrieneed eleetric
NI
2008-11-14
Repairer
bullepaiser. Free rides (after you Gix it) and halfof
11:22.28
个
hot wings ace some of the benefits
Ernesto未能易上找到他理想的高
风险职位，不过确实有很大进步
因为提素脚本现在会分别壹找各
个捷索项。
515
---
## Page 552
搜索还能改进吗？
我是走钢丝的演员。我访问了你
的网站，不过尽管我准确输入了
正确的搜索项，却没有找到好的
职位。
Dangerl Your dream job is out there.
Do you have the guts to go find it?
Risky Jobs - Search
Find your isky job:
dgfrope, wz/leet, circes
SubmA
走钢丝演员Selma使用
搜索项显然表明爱推索岛戏团
Riskyobs援索表单时
运气不太好。
的走钢丝演员职位，但是结果
并不完全医配。
A00
RiskyJo
searcr
Risky
Jubs
Danger! Your dream job is out there
Do you have the guts to go find it?
Risky Jobs-Search Results
Job Titie
Descriptinn
State
Datc Posted
Master Cat Jug.gler
Are yot a prstitiuner of the lost at of cat juggling?
AZ.
21:13:35
2008-1114
Banned in fony couetries,only the Jim Ruiz Circus
the modem eudience. Ply yoer trede with premiere cat
tas refined cet juggling forthe sophisticated tastes of
jugglers at our cireus. the otily place or: eantht to master
synchmtized cet juggiing. B's trae, gugelieg thomis
opportueity employer,and look forwand to adding you
cven hander than herdirg them. We are an equa)
to our tcam.Picase be prepered to undcrgo a thoroegh
battery of tesis to prove your def hoedling of felines.
Master Cet Juggler progmm.
Only the cream ofthe crop wil be sceepted inte our
是搜索项不对，还
Tightrope Tester
If the thought of dengling for lhours on end from great MT
2008 11·14
是确实没有走钢丝
rmay he fur yuu. Every ote of uurtiglhuropes goes
teights is yoer iden of a good tirme, then this job just
21:17:16
演员的职位？
through rigonogs a 43 point test, culminating in a real
wgo pod ped  8equ 
That eould be yoe! W'e do provide safety rets but
youll nced to brieg your orwn helmet and gleves. Here
Mantana, we offer an inerudible employment package
at our manufacturing anc testirg favility in Big Top.
Wcek and Foi Fridays. We will need thre
with benefits ranging from Bring Your Pet to Work
references, ineluding yeur verified maximm ltang
time und number of past falls, Were the cinus hehind
the eircus!
516
第9章
---
## Page 553
串与定制函数
 Sharpen your pencil
如果输入“tightrope，walker，circus”作为搜索项，请写出此
时搜索生成的SQL查询，你认为可能存在什么问题，并做出
标注。
PDG
你现在的位置
517
---
## Page 554
预处理搜索串
Solution
如果输入“tightrope，walker,circus”作为搜索项，请写出此
时搜索生成的SQL查询，你认为可能存在什么问题，并做出
标注。
SELECT * FROM tiskyjo6s
WHERE descriptionLKE%tightrope，%OR description LJKE%walker,%OR
desctiptionLKE%citcus%
个
explode(）函数使
道号被认为是推索项的一部分
用空格作为定界
而没有作为搜索项之间的分隔符。
符.不过漏掉了
适号。
唯一能真正匹配职位的
搜索项是“cincus”，因
explode()
为它后面恰好没有加
适号。
$search_words
我不觉得这有什么大不了的。只需要调用两
次explodel函数，第一次去除空格，然后再
调用一次去除运号。
。
explode（）函数可以将一个串分解为子串，但是在这里，我们
已经有子串。
第一个explode（）函数调用会把多个串存储在一个数组中，所
以再没有一个串可供分解。如果试图进一步分解这个数组中的各
个串，可能只会带来更多的问题。我们不会使用多个explode（）
调用来解决定界符问题，而只需对搜索串进行预处理，调用
explode（）之前将搜索串调整为只有一个定界符。然后就可以
做它最擅长的事情了，用一个定界符分解这个串。
518
第9章
---
## Page 555
串与定制函数
预处理搜索串
我们希望向explode（）函数传入一个可以一步分解到位的串。如何
通过预处理数据，
做到呢？只需确保explode（）只考虑一个定界符，如一个空格符。
可以删除我们不
这说明，我们需要对搜索串进行预处理，使得各个搜索项均由一个空
格分隔（即使用户输入了逗号）。
想要的字符，使
数据更易于处理。
需要将它转换为.·
tightrope，walker，circus
..…使explode(）可以给出
tightrope
walker
circus
这个结果。
没有通号了！
$search_words
thereareno