σ during any of the transfers. One can
1381/k is a forged modiﬁed Boneh-
see that in this case s = K
Boyen signature (described in section 3.3) on record Rσ(cid:2).
The diﬀerence between Game-2 and Game-3 is bounded
by the following claim; we postpone the proof of the claim
until later.
G1
(κ) .
Claim 5.6. We have that
HybridE,Sim2(κ) − HybridE,Sim3(κ) ≤ Adv(N+1)SDH
Game-4 : Simulator Sim4, at the ﬁrst transfer query dic-
tated by E, runs the simulated proof of knowledge PK{(h) :
H = e(g, h)} The value L returned in each transfer query
is computed as L ← (Fσ/Rσ)k, and the ﬁnal P K in the
transfer phase is replaced by a simulated proof.
Note that now the simulation of the transfer phase no longer
requires knowledge of h. However, all of the simulated proofs
are proofs of true statements and the change in the com-
putation of L is purely conceptional. Thus by the perfect
zero-knowledge property, we have that
HybridE,Sim4(κ) = HybridE,Sim3(κ) .
Game-5 : Simulator Sim5 replaces the values F1, . . . , FN
sent to A during DBSetup phase with random elements from
GT. Now at this point, the second proof in the previous
game is a simulated proof of a false statement. Intuitively,
if these changes enable an environment E to separate the
experiments, then one can solve an instance of the BDHE
problem. This is captured in the following claim, that we
will prove later:
Claim 5.7. We have that
HybridE,Sim4(κ) − HybridE,Sim5(κ) ≤
(κ) .
(N + 1) · Adv(N+2)BDHE
G1,GT
We now construct, based on the real-world adversary A,
(cid:3)
an ideal-world adversary A
that plays the role of the cheat-
ing user and performs all of the changes to the experiments
described in the previous games except that at the time of
the transfer, after having extracted the value of σ from A,
it queries credentials from the trusted third party T for all
(cid:3)
categories in ACLσ. Next, A
queries T to obtain record Rσ.
Then he uses this record to compute L ← (Fσ/Rσ)k, and
the ﬁnal P K is replaced by a simulated proof.
(cid:3)
One can see that A
provides A with exactly the same
environment as Sim5 did, so we have
IdealE,A(cid:2)(κ) = HybridE,Sim5(κ) .
(cid:3)
The running time of A
2)
exponentiations, l extractions and l proof simulations, so is
polynomial in the security parameter.
is that of A plus that of O(N
Summing up all the above equations yields the lemma
statement. We have left to prove the claims used above.
Proof of Claim 5.6. We prove the claim by construct-
ing an adversary B that breaks the unforgeability under
weak chosen-message attack of the modiﬁed Boneh-Boyen
signature scheme. By the security proof given in the full
version [9], this directly gives rise to an expected polynomial-
time adversary with non-negligible advantage in solving the
(N + 1)-SDH problem.
Given an adversary A for that distinguishes between
Game-1 and Game-2, consider the forger B that outputs
tuples
message
(1, c1,1, . . . , c1,(cid:4)), . . . , (N, cN,1, . . . , cN,(cid:4)).
When given public key (yDB, y1, . . . , y(cid:4)) and signatures
E1, . . . , EN it creates an encrypted database using these val-
$← G. At the i-th
ues E1, . . . , EN and a self-chosen value h
transfer it extracts from A values (σ, k,{ci}) such that
(cid:4)(cid:14)
e(K, yDB)e(K, g)σ
e(K, yj)ci,j = e(g, g)k
j=1
(This extraction is guaranteed to succeed since we already
eliminated failed extractions in the transition from Game-0
to Game-1.) When σ (cid:7)∈ {1, . . . , N} or cσ,j (cid:7)∈ ACLσ for
some j then B outputs s ← K
1/k as its forgery on message
tuple (σ, cσ,1, . . . , cσ,(cid:4)).
N+1
advantage
On input g, gx, . . . , gx
Proof of Claim 5.7. Given algorithms E, A with non-
in distinguishing Game-4 and
negligible
Game-5, consider the following algorithm B solving the
(N + 1)-PDDH problem. The claim follows by the reduction
from the PDDH to the BDHE problem in Theorem 3.4.
, H0, H1, . . . , HN+1, B runs E
and A as Sim4 does until E instructs to create database DB =
((R1, ACL1), . . . , (RN , ACLN )). At this point B chooses x1,
$← Zp and computes di = i + x1ci,1 + . . . + x(cid:4)ci,(cid:4)
. . . , x(cid:4)
(cid:7)
i=0 αiX i
for i = 1, . . . , N. Let f(X) =
N−1
(cid:6)
j=0 βi,jX j for i =
and let fi(X) = f(X)/(X + di) =
, yDB ←
(cid:3) ← gf(x) =
(cid:6)
i=0 (gx
1, . . . , N. B computes g
, and yi ← g
(cid:3)xi for i = 1, . . . , (cid:6). For
(cid:6)
αi
gxf(x) =
)
i = 1, . . . , N, it computes Ei ← g
(cid:2)
and Fi ← (cid:6)
N−1
(cid:3)
x+di =
)βi,j
j=0 (gx
(cid:3)
N−1
j=0 (Hj)βi,j . Algorithm B feeds
pk DB =
(cid:3)
(g
as
the
encrypted database to A, and continues running E and A
If E outputs a bit b, then B outputs the
as under Sim4.
same bit b.
, H0, yDB, y1, . . . , y(cid:4)), (E1, F1), . . . , (EN , FN )
i=1(X + di) =
i=0 (gx
(cid:7)
(cid:6)
i
αi
)
i+1
N
N
1
i
It is clear that if Hi = H x
0
then the database is distribut-
ed exactly as in Game-4, while if H1, . . . , HN are random
it is distributed exactly as in Game-5. The advantage of B
in breaking the (N + 1)-PDDH assumption is the same as
E’s advantage in distinguishing Game-4 from Game-5.
N
N
j
The proof of the following lemma is very similar to that
of Lemma 5.4, except that Game 2 is no longer needed. A
full proof is given in the full version [9].
Lemma 5.8. For all environments E and all real-world
adversaries A controlling the issuer and one or more users,
(cid:3)
there exists an ideal-world adversary A
such that
RealE,A(κ) − IdealE,A(cid:2)(κ) ≤ 2
+ Adv(N+1)SDH
(κ) + (N + 1) · Adv(N+2)BDHE
where q is the total number of transfer protocols.
G1,GT
G1
−κ · q +
(κ) ,
Acknowledgements
This work was supported in part by the European Communi-
ty through the Seventh Framework Programme (FP7/2007-
2013) project PrimeLife (grant agreement no. 216483) and
through the ICT programme project ECRYPT II (contract
ICT-2007-216676).
1396. REFERENCES
[1] W. Aiello, Y. Ishai, O. Reingold. Priced oblivious
transfer: How to sell digital goods. In
EUROCRYPT 2001, LNCS vol. 2045, 119–135.
Springer, 2001.
[2] M. H. Au, W. Susilo, Y. Mu. Constant-size dynamic
k-TAA. In SCN 06, LNCS vol. 4116, 111–125.
Springer, 2006.
[3] M. Bellare, O. Goldreich. On deﬁning proofs of
knowledge. In CRYPTO ’92, LNCS vol. 740, 390–420.
Springer, 1993.
[4] D. Boneh, X. Boyen. Short signatures without random
oracles. In EUROCRYPT 2004, LNCS vol. 3027,
56–73. Springer, 2004.
[5] D. Boneh, X. Boyen, H. Shacham. Short group
signatures. In CRYPTO 2004, LNCS vol. 3152,
41–55. Springer, 2004.
[6] D. Boneh, C. Gentry, B. Waters. Collusion resistant
broadcast encryption with short ciphertexts and
private keys. In CRYPTO 2005, LNCS vol. 3621,
258–275. Springer, 2005.
[7] S. Brands. Rapid demonstration of linear relations
connected by boolean operators. In EUROCRYPT
’97, LNCS vol. 1233, 318–333. Springer, 1997.
[8] S. Brands. Rethinking Public Key Infrastructure and
Digital Certiﬁcates— Building in Privacy. Ph.D.
thesis, Eindhoven Institute of Technology, Eindhoven,
The Netherlands, 1999.
[9] J. Camenisch, M. Dubovitskaya, G. Neven. Oblivious
transfer with access control. Cryptology ePrint
Archive, 2009.
[10] J. Camenisch, A. Kiayias, M. Yung. On the portability
of generalized Schnorr proofs. In EUROCRYPT 2009,
LNCS vol. 5479, 425–442. Springer, 2009.
[11] J. Camenisch, A. Lysyanskaya. Eﬃcient
non-transferable anonymous multi-show credential
system with optional anonymity revocation. In
EUROCRYPT 2001, LNCS vol. 2045, 93–118.
Springer, 2001.
[12] J. Camenisch, A. Lysyanskaya. Signature schemes and
anonymous credentials from bilinear maps. In
CRYPTO 2004, LNCS vol. 3152, 56–72. Springer,
2004.
[13] J. Camenisch, M. Michels. Proving in zero-knowledge
that a number n is the product of two safe primes. In
EUROCRYPT ’99, LNCS vol. 1592, 107–122.
Springer, 1999.
[14] J. Camenisch, G. Neven, abhi shelat. Simulatable
adaptive oblivious transfer. In EUROCRYPT 2007,
LNCS vol. 4515, 573–590. Springer, 2007.
[15] J. Camenisch, M. Stadler. Eﬃcient group signature
schemes for large groups. In CRYPTO ’97, LNCS vol.
1296, 410–424. Springer, 1997.
[16] J. L. Camenisch. Group Signature Schemes and
Payment Systems Based on the Discrete Logarithm
Problem. Ph.D. thesis, ETH Z¨urich, 1998. Diss. ETH
No. 12520, Hartung Gorre Verlag, Konstanz.
[17] R. Canetti. Studies in Secure Multiparty Computation
and Applications. Ph.D. thesis, Weizmann Institute of
Science, Rehovot 76100, Israel, 1995.
[18] R. Canetti. Security and composition of multi-party
cryptographic protocols. Journal of Cryptology,
13(1):143–202, 2000.
[19] D. Chaum. Security without identiﬁcation:
transaction systems to make big brother obsolete.
Communications of the ACM, 28(10):1030–1044, 1985.
[20] D. Chaum, J.-H. Evertse. A secure and
privacy-protecting protocol for transmitting personal
information between organizations. In CRYPTO ’86,
LNCS vol. 263, 118–167. Springer, 1987.
[21] D. Chaum, T. P. Pedersen. Wallet databases with
observers. In CRYPTO ’92, LNCS vol. 740, 89–105.
Springer-Verlag, 1993.
[22] L. Chen. Access with pseudonyms. In Proceedings of
the International Conference on Cryptography: Policy
and Algorithms, 232–243. Springer, 1995.
[23] S. Coull, M. Green, S. Hohenberger. Controlling access
to an oblivious database using stateful anonymous
credentials. Cryptology ePrint Archive, Report
2008/474, 2008.
[24] R. Cramer, I. Damg˚ard, P. D. MacKenzie. Eﬃcient
zero-knowledge proofs of knowledge without
intractability assumptions. In PKC 2000, LNCS vol.
1751, 354–372. Springer, 2000.
[25] R. Cramer, I. Damg˚ard, B. Schoenmakers. Proofs of
partial knowledge and simpliﬁed design of witness
hiding protocols. In CRYPTO ’94, LNCS vol. 839,
174–187. Springer, 1994.
[26] I. Damg˚ard. Payment systems and credential
mechanisms with provable security against abuse by
individuals. In CRYPTO ’88, LNCS vol. 403, 328–335.
Springer, 1990.
[27] G. Di Crescenzo, R. Ostrovsky, S. Rajagopalan.
Conditional oblivious transfer and timed-release
encryption. In EUROCRYPT ’99, LNCS vol. 1592,
74–89. Springer, 1999.
[28] Y. Dodis, A. Yampolskiy. A veriﬁable random
function with short proofs and keys. In Public Key
Cryptography – PKC 2005, LNCS vol. 3386, 416–431.
Springer, 2005.
[29] T. ElGamal. A public key cryptosystem and a
signature scheme based on discrete logarithms. IEEE
Transactions on Information Theory, 31(4):469–472,
1985.
[30] J. Herranz. Restricted adaptive oblivious transfer.
Cryptology ePrint Archive, Report 2008/182, 2008.
[31] A. Lysyanskaya, R. Rivest, A. Sahai, S. Wolf.
Pseudonym systems. In Selected Areas in
Cryptography, LNCS vol. 1758. Springer, 1999.
[32] B. Pﬁtzmann, M. Waidner. Composition and integrity
preservation of secure reactive systems. In Proc. 7th
ACM Conference on Computer and Communications
Security, 245–254. ACM press, 2000.
[33] B. Pﬁtzmann, M. Waidner. A model for asynchronous
reactive systems and its application to secure message
transmission. In Proceedings of the IEEE Symposium
on Research in Security and Privacy, 184–200. IEEE
Computer Society, IEEE Computer Society Press,
2001.
[34] C. P. Schnorr. Eﬃcient signature generation for smart
cards. Journal of Cryptology, 4(3):239–252, 1991.
140