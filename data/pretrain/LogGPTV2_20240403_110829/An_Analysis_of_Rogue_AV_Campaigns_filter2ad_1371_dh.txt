### Daily Basis Information Gathering

- **Security State of a Domain:**
  - **Norton Safeweb Information:** For each domain, we have queried its security status using the Norton Safeweb website reputation service. This allows us to retrieve information on a variety of threats, including browser exploits, malware samples, and phishing sites.
    - _Source:_ [Norton Safeweb](http://safeweb.norton.com)
  - **Google Safe Browsing Information:** We have utilized the Google Safe Browsing API to detect the presence of threats within a given domain.
    - _Source:_ [Google Safe Browsing API](http://code.google.com/apis/safebrowsing/)

- **Domain Information:**
  - **Registration Information:** We have parsed the registration data obtained via the WHOIS protocol to gather information on the identity of the registrant, the provided contact email address, and the name of the registrar.
    - _Note:_ The WHOIS specification requires records to be human-readable but does not specify their syntax or semantics. As a result, the data stored by different registrars is often in different formats. We have built a generic parser that handles a vast number of registrars and 17 specific parsers for common registrars. However, registration information is not available for all domains.
  - **DNS Relations:** By performing DNS queries, we have retrieved the associated NS records and all A records for hostnames known to belong to each domain. If only one domain name was available and no information on associated hostnames was present, we considered the domain name itself and the hostname generated by prepending the standard "www" as hostnames.
  - **Geolocation and AS Information:** For each web server associated with the rogue domain through a DNS A record, we have collected information on its geographical location and its associated Autonomous System (AS) number.
  - **Server Uptime and Version String:** Using HTTP HEAD packets, we have tested the responsiveness of the discovered servers and collected information on the server configuration by examining the advertised server version string.

- **Information on the Servers:**

### Limitations

Despite our efforts to maximize threat coverage by aggregating multiple information sources, we acknowledge the limitations of our dataset. Due to the nature of our observational capabilities and the way the rogue AV ecosystem operates, it is impossible to determine with certainty what fraction of the total rogue AV providers across the entire Internet we have observed. For example, we have noticed a predominance of servers physically located in the US. This result might be skewed by the heuristics used for identifying rogue AV sites, which could overlook rogue AV servers primarily marketed in non-English languages. Additionally, the identification of rogue domains is a potential source of bias, as our analysis relies on third-party sources without providing any guarantees regarding the precision of classification. Through manual inspection of our feeds, we identified a limited number of domains that did not seem to be related to the rogue AV threat type. However, the number of such misclassifications is negligible relative to the size of the dataset. Any possible pollution of the dataset has been implicitly filtered out by our clustering techniques.

### Multi-criteria Decision Analysis

To analyze the campaigns through which rogue AV software is distributed, we have used an attack attribution method based on a multi-criteria fusion algorithm. This method has proven to bring several advantages over traditional clustering methods. Rogue AV domains are automatically grouped together based on common elements likely due to the same root cause, i.e., the same rogue campaign. The method combines a graph-based clustering technique with a data aggregation method inspired by multi-criteria decision analysis (MCDA).

#### Components of the Attribution Method:

1. **Feature Selection:**
   - We determine which relevant features to include in the overall analysis and characterize each element of the dataset according to each extracted feature.
   - Selected features include:
     - **Registrant Email Address (FReg):** The email address provided upon domain registration.
     - **Web Server IP Addresses (FIP), Class C (FCl.C), and Class B (FCL.B) Subnets:** To identify servers belonging to the same infrastructure, we consider the full IP address, /24, and /16 network prefixes.
     - **Nameserver IP Address (FN S):** The IP address of the authoritative nameserver(s).
     - **Registered Domain Name (FDom):** The domain name itself to detect common naming schemes.

2. **Graph-based Clustering:**
   - An undirected edge-weighted similarity graph is created for each selected feature, based on an appropriate distance for measuring pairwise similarities.
   - For FIP, FCl.C, FCl.B, and FN S, the Jaccard similarity coefficient is used to calculate the similarity between sets of IP addresses or subnets.
   - For FReg, maximum similarity scores are given to identical email addresses, and non-null scores are given to email addresses sharing the same username, domain, or containing popular AV keywords.
   - For FDom, the Levenshtein distance is used to measure the similarity between domain names, normalized to a similarity score within the interval [0, 1].

3. **Multi-criteria Aggregation:**
   - An aggregation function defines how the criteria (i.e., site features) must be combined to group rogue domains based on their common elements.
   - We use Yager’s Ordered Weighted Averaging (OWA) to model complex requirements, such as “most of” or “at least two” criteria being satisfied in the overall decision function.
   - The weighting vector w gives lower weights to the two highest scores, ensuring that at least three strong correlations are needed to achieve a global score above 0.3 or 0.4, which is used as a decision threshold to link two domains.

### Insights on the Rogue Security Software Threat Economy

We will now delve into the details of the dataset and infer information about the modus operandi of the individuals behind these businesses.

#### High-Level Overview

- **Dataset:** The dataset consists of 6,500 DNS entries, collected between June and August 2009, pointing to 4,305 distinct IP addresses hosting rogue AV servers. At least 45% (2,935) of all domains were registered through only 29 registrars.
- **DNS Information:** We used DNS information to distinguish generic hosting services from servers specifically deployed for hosting rogue AV content. A total of 2,677 IP addresses (web servers) host only domains known to serve rogue AV software. An additional 118 IPs provide services for both rogue-AV and other malware-serving domains. The remaining 1,510 IP addresses host both malicious and benign domains, likely associated with hosting services unaware of the illicit use of their infrastructure.
- **Rogue AV Servers Localization:** Mapping the 2,677 IPs hosting only rogue AV software to AS numbers, we identified 509 ASes. Approximately 37% (984 servers) are hosted by only 10 particularly popular ASes. The geographical distribution is heavily skewed towards US locations, with approximately 53% (1,072 servers) hosted in the USA.
- **Rogue AV Server Versions:** Apache (in various configurations) is used in well over 40% of the rogue AV servers. Table 1 reports some of the most popular observed version strings.
- **Rogue AV Domain Registrations:** We analyzed the email addresses provided by all registrants of rogue AV domains. Table 2 shows the most popular domains, including anonymous domain registration services and ISPs that are lax in verifying registrant identities.
- **Rogue AV Domains and Browser Exploits:** We found that 814 of the rogue AV domains were serving malware, 417 attempted to use browser exploits, 12 led to the installation of spyware, and 19 caused the installation of a trojan. This highlights the use of more aggressive strategies for monetization in a minority of cases.

#### Towards the Big Picture

Given the size of the dataset, it is beyond the scope of this work to describe all the relationships discovered. We have generated a "big picture" of the landscape by plotting the relationships between servers hosting rogue AV content and all the domains known to be hosted on them, a total of 235,086 domains. Figure 1 simplifies the visualization by omitting all IPs associated with fewer than 100 different domains. Darker nodes represent rogue AV domains, while lighter nodes indicate benign domains.

The subset represented in Figure 1 consists of 174 servers hosting a total of 30,632 distinct domain names. In this set, 15% of the total hosted rogue security software, while 9% hosted other types of threats. Most domain names are linked to a single web server, but some rogue AV domains were associated with several distinct IP addresses over time, creating complex subgraphs.

Figure 1 highlights the complexity of identifying malicious domains and the challenges of protecting web clients from potentially dangerous sites through IP-based blacklisting methods. The coexistence of both rogue and legitimate domains on the same server IP undermines the applicability of such approaches, as it would be detrimental to perfectly benign sites.

### The Campaigns

To better understand the modus operandi of rogue AV operators, we used the multi-criteria decision analysis (MCDA) described in Section 3.4 to mine the dataset and identify separate campaigns likely generated by the action of a single individual or group.

- **Campaign Identification:** The application of the method led to the identification of 127 separate campaigns, grouping a total of 4,549 domains. The identified campaigns have an average size of 35.8 domains, with significant variance. Specifically, 4,049 domains are associated with the 39 largest campaigns, with the largest comprising 1,529 domains.

In the rest of this section, we will closely examine three of these campaigns and show how the MCDA provides insights into the dynamics of the rogue AV threat landscape.

- **Large-Scale Campaigns:** Some campaigns consisted of several hundred domains. One such example is represented graphically in Figure 2, showing the relationship between domains, subnets of their hosting servers, and registrant email addresses. The nodes at the bottom of the graph represent domain registration dates.

Figure 2 groups about 750 rogue domains registered in the .cn TLD, resolving to 135 IP addresses in 14 subnets, on eight specific dates over eight months. Despite the apparent link to China, the majority of the IP addresses of the hosting servers were hosted in the United States.