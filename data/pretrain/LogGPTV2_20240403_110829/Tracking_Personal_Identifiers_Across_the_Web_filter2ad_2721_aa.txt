title:Tracking Personal Identifiers Across the Web
author:Marjan Falahrastegar and
Hamed Haddadi and
Steve Uhlig and
Richard Mortier
Tracking Personal Identiﬁers Across the Web
Marjan Falahrastegar1(B), Hamed Haddadi1, Steve Uhlig1,
and Richard Mortier2
1 Queen Mary University of London, London, UK
PI:EMAIL
2 University of Cambridge, Cambridge, UK
Abstract. User tracking has become de facto practice of the Web,
however, our understanding of the scale and nature of this practice
remains rudimentary. In this paper, we explore the connections amongst
all parties of the Web, especially focusing on how trackers share user IDs.
Using data collected from both browsing histories of 129 users and active
experiments, we identify user-speciﬁc IDs that we suspect are used to
track users. We ﬁnd a signiﬁcant amount of ID-sharing practices across
diﬀerent organisations providing various service categories. Our obser-
vations reveal that ID-sharing happens in a large scale regardless of the
user proﬁle size and proﬁle condition such as logged-in and logged-out.
We unexpectedly observe a higher number of ID-sharing domains when
user is logged-out. We believe that our work reveals the huge gap between
what is known about user tracking and what is done by this complex and
important ecosystem.
1 Introduction
The rise in the use of personal data and the application of sophisticated algo-
rithms to track and analyse our online browsing behaviour have caused an
increase in the number of diﬀerent tracking services. These services include
third-party advertising and analytics services on the Internet and the mobile
web [1–3]. User tracking services build a user proﬁle by collecting, aggregating,
and correlating an individual’s browsing behaviour, demographics and interests.
While these services are vital for the online economy, there are complex debates
over privacy issues that are caused directly or indirectly by such services (e.g.,
misusing ad tracker cookies to identify individuals [4]).
These services are not only growing steadily in number [2], but are also
evolving in terms of mechanisms and technologies. An example of this trend is
the emergence of various user tracking mechanisms such as Flash cookies, ETags
re-spawning [5] and canvas ﬁngerprinting [6] in a relatively short period of time.
One of the very important phenomena of the Web ecosystem that has been
less explored is the practice of sharing user-speciﬁc identiﬁers (IDs). A few works
have highlighted the presence of this practice [2,7]. Moreover, the authors in [6]
introduced a method to identify user-speciﬁc IDs. Although we are aware of
the existence of this phenomenon, our understanding about the extent of this
c(cid:2) Springer International Publishing Switzerland 2016
T. Karagiannis and X. Dimitropoulos (Eds.): PAM 2016, LNCS 9631, pp. 30–41, 2016.
DOI: 10.1007/978-3-319-30505-9 3
Tracking Personal Identiﬁers Across the Web
31
practice and the nature of the parties involved in user-speciﬁc ID sharing is
rudimentary.
In the rest of this paper, we explore the characteristics of user ID-sharing
groups by analysing the organisational and categorical relation amongst the
members of ID-sharing groups (Sect. 2). We then investigate the eﬀect of user
proﬁle on the presence of ID-sharing groups. We show that users are being
tracked regardless of their proﬁle size (e.g., amount of their browsing history)
and proﬁle condition (logged-in or logged-out) (Sect. 3). After discussing the
related work (Sect. 4), we provide our conclusions (Sect. 5).
2 User Tracking
We start our analysis by exploring the connections between domains when they
are aimed to track users. User tracking is a practice by which a domain, either
being directly visited by a user or indirectly through third-party trackers, assigns
a unique identiﬁer to the user, and shares this identiﬁer with other domains. The
parties participating in user tracking are able to aggregate the data collected by
other parties in order to construct a comprehensive proﬁle of users. In the rest
of this section, we ﬁrst describe our methodology and dataset, and subsequently
explore the size and nature of a user ID-sharing group.
2.1 Methodology and Data Collection
We extended the Lightbeam Firefox plug-in to log all headers of HTTP requests
and responses. The plug-in additionally records the country where the user is
located (our modiﬁed version is available in [8]). The recorded data is delivered
automatically to our server using an encrypted connection. While there are var-
ious Firefox plug-ins to visualize and block third-party trackers, we chose Light-
beam (Fig. 1) because of its interactive and easily understandable user interface.
We asked our colleagues and friends to install our plug-in and use Firefox as
their main browser for the minimum duration of two weeks. In order to preserve
users’ privacy we did not record any identiﬁable information such as the IP
address, name or contact information. Additionally, we obtained ethics approval
from QMUL ethics committee (code QMREC1416a) before performing our user
studies. All our data were obtained between 20 February 2015 until 1 April 2015.
In total we had 129 participants from 22 countries across the globe. Our partic-
ipants have visited 4951 unique websites which include 6568 unique third-party
trackers. Table 1 lists the number of our participants in each geographical region.
2.2 Nature of ID-Sharing Groups
To explore user tracking via sharing user-speciﬁc identiﬁers, we ﬁrst need to
determine the identiﬁers that are likely to be used as user-speciﬁc IDs: a unique
identiﬁer stored in a cookie or embedded as a parameter in a URL. For this
purpose, we apply the following rules inspired by Acar et al. [6] on all items
stored in the cookies and the URL parameters.
32
M. Falahrastegar et al.
Fig. 1. Lightbeam presents the connection between websites with an interactive and
easily understandable user interface.
Table 1. Number of participants per geographical location.
Country
No. P
BE, CH, FE, DE, DK, ES, GB, GR, NL, FI 97
Region
Europe
Middle East
America
BD, IR, QA
CA, MX, US
Oceania-East Asia AU, CN, MY
Africa
SG, MR
11
9
8
3
– Extract (key,value) pairs using delimiters such as ampersand ( &) and semi-
colon ( ;). For instance, this string id=ece53b2e-ea5c-4433-ad3d&ssid=
02ba238451cec44ba88 contains two (key,value) pairs: (id,ece53b2e-ea5c-4433-
ad3d) and (ssid,02ba238451cec44ba88).
– Exclude (key,value) pairs that are inconsistent: a (key,value) pair is inconsis-
tent if there are multiple values for the same key belonging to a certain domain.
For example these pairs (id,ece53b2e-ea5c-4433) and (id,ﬀc87j3o-gh11-3278)
observed from bbc.co.uk are excluded.
– Exclude those value strings that are shared by multiple users.
– Only include those value strings that their length is longer than 7 characters.
After applying the aforementioned rules on our dataset, we found that 96 %
of user-speciﬁc IDs have a minimum length of 7 characters.
We applied the above-described method for each user. Table 2 shows sample
URLs and their identiﬁed user-speciﬁc IDs with their associated keys. The iden-
tiﬁed IDs appear in various formats of which the most common are { xx..x},
{ x-x-..-x} and { x|x|..|x} where x can be any combination of characters
and numbers. We ﬁnd 3,224 unique user IDs from 806 domains. To our sur-
prise, the vast majority of these IDs (96 %) are being shared between at least
two domains. We identify 769 domains that share unique user IDs with other
domains. Extracting the user-speciﬁc IDs enables us to identify user ID-sharing
groups: a set of domains that share user-speciﬁc IDs. We identify 660 unique
Tracking Personal Identiﬁers Across the Web
33
Table 2. Example of URLs and the identiﬁed user-speciﬁc IDs with their associated
keys.
URL
User-Speciﬁc IDs
Key
http://ads.rubiconproject.com/ad/11078.js 65d39451-1f73-435a-bf39 put 2760
http://apex.go.sonobi.com/trinity.js
http://cm.adform.net/pixel
i736hcjtwb05natk
d4848|VOzy0|N1xas
uin bw
adform pc
s
p
u
o
r
G
f
O
.
o
N
465
100
50
10
5
1
420
100
50
10
5
s
p
u
o
r
G
f
o
.
o
N
4 5
2 3
Domain Tracking Group Size
6
7
8
9 10 11
2 3
1
Organisational Tracking Group Size
4 5
6
7
8
Fig. 2. Size of ID sharing groups based on number of (a) domains and (b) organisations
(Y-axis in both ﬁgures uses a logarithmic scale).
ID-sharing groups containing two to more than eight domains. Figure 2a pro-
vides the distribution of the number of diﬀerent sharing groups (y-axis uses a
logarithmic scale) across their group size (x-axis). From Fig. 2a, we observe that
user IDs are mainly shared between two (467 unique groups, 2742 occurrences)
or three (86 unique groups, 201 occurrences) domains. Moreover, the number of
unique groups and their occurrences drop steadily as group size increases.
Organisational Sharing. User ID-sharing groups consist of multiple domains
that may actually belong to the same organisation. Therefore, we broaden our app-
roach from domains to organisations, resulting in organisational sharing groups.
For example, the organisational sharing group for {google.com, youtube.com} is
{Google}, and for this group: {youtube.com, scorecardresearch.com} is {Google,
comScore}.
To identify the organisation behind a set of domains, we applied a combina-
tion of three methods. First, we used Collusion’s dataset1 to detect ID-sharing
domains belonging to the same company. We manually inspected this dataset
for any changes using websites and wiki pages of the companies involved. Sec-
ond, we used the e-mail addresses of domains obtained by querying their SOA
(Start of Authority) record. The email address, however, is unhelpful if it is
a general account from a cloud, CDN or DNS service. For example, awsdns-
1 http://collusion.toolness.org/.
34
M. Falahrastegar et al.
PI:EMAIL is the email address of all third-parties hosted on Ama-
zon Web Services, and PI:EMAIL is assigned to all services hosted
on Google App Engine. We identiﬁed the unhelpful email addresses by their
email domain name belonging to the known CDN and DNS services, or contain-
ing keywords indicating such services. For these cases we used the organization
indicated in their whois records if available, or else we assumed the domain has
no parent company. We are aware that there can be some cases with an outdated
whois record or email addresses but we believe this is the best approach that
can be executed automatically.
Figure 2b provides the distribution of the number of organisational sharing
groups (again using a logarithmic y-axis) across their sizes (x-axis). We observe
that the number of within-organisational sharing groups (sharing within a single
organisation) is considerably lower than those with more than one organisation
(sharing across diﬀerent organisations). Moreover, the most cross-organisational
sharing appears between only two organisations. The majority of these two-
organisation groups contain a member organisation that appears only once (306).
On the other hand, dominant organisations such as Google, Rubicon Project and
Optimizely (a user targeting company) appear in 43, 40 and 33 two-organisation
groups respectively.
In general, we ﬁnd some organisations such as Rubicon Project (an ad
exchange company) appears strongly in the cross-organisational sharing groups
(112 groups) while large organisations such as Google appears in both cross-
organisational and within-organisational sharing groups. Table 3 shows the top
15 most popular organisational sharing groups (in their frequency of occurrence)
and the nature of their user-speciﬁc ID-sharing within the group, i.e., within an
organisation (w-org) or cross organisations (c-org).
Cross Categories Sharing. To gain more insight into the nature of user
ID-sharing, we analysed the ID-sharing groups with a diﬀerent approach. We
examined the categories of domains in each group. We ﬁrst identiﬁed domain
categories using the Trend Micro Site Safety Center categorization service2. The
Trend Micro service contains 85 diﬀerent interest categories. Moreover, we man-
ually inspected those that were not available on Trend Micro. We ﬁnd categories
related to the ad ecosystem (e.g., ad networks, analytics, ad exchanges) have,
expectedly, the highest presence. This strong presence is due to the employed
advertising mechanisms (e.g., real-time bidding) that share user-speciﬁc IDs
across diﬀerent entities of the ad ecosystem.
We then compared the categories of domains in each group. For instance,
in the following ID-sharing group {getclicky.com,ibtimes.co.uk} the categories
of domains in the group are {Analytics, News}. Table 4 shows the top 15 cat-
egories of the sharing groups (in their frequency of occurrence) and the nature
of their domain categories in the group, i.e., within a category (w-cat.) or cross
categories (c-cat). We observe that the majority of ID-sharing in the groups hap-
pens across diﬀerent categories. We ﬁnd only 28 ID-sharing groups of which their
2 http://global.sitesafety.trendmicro.com.
Tracking Personal Identiﬁers Across the Web
35
Table 3. Top 15 user ID-sharing groups ordered based on their frequency of occur-
rence. The Type column indicates the nature of organisational sharing within the group
(within-organisation=w-org versus cross-organisation=c-org).
Sharing group
google.com, googleadservices.com
google.com, youtube.com
Type
w-org
w-org
ﬂickr.com, yahoo.com, yahooapis.com w-org
bbc.com, eﬀectivemeasure.net
yahoo.com, www.yimg.com
bing.com, live.com
adxcore.com,cherryssp.net
rubiconproject.com, wtp101.com
rubiconproject.com, tapad.com
bing.com, live.com, msn.com
c-org
w-org
w-org
c-org
c-org
c-org
w-org
eyeviewads.com, rubiconproject.com c-org
everesttech.net, rubiconproject.com c-org
rubiconproject.com, w55c.net
sina.com.cn, weibo.com
rubiconproject.com, rundsp.com
c-org
w-org
c-org
members belong to the same category (within-category sharing). This number
is considerably lower than 110 groups with members belonging to diﬀerent cat-
egories (cross-categories sharing). We have also observed that sensitive domain
categories such as health related ones participate in the ID-sharing with domains
related to advertisement trackers and search engines (7 groups). For instance,
webmd.com (a health information website) has shared user-speciﬁc IDs with
gravity.com (an advertisement tracker). Looking at a sample HTTP request from
webmd.com to gravity.com in Table 5, shows that gravity.com logs users’ visited
pages via referrer URL-parameter. This information enables gravity.com to cre-
ate users’ proﬁles based on their visited pages and searched terms on webmd.com.
The presence of such domain categories within sharing groups raises serious pri-
vacy concerns since users’ sensitive information can be exposed within sharing
groups.
3 Eﬀect of User Proﬁle
In the previous section, we observed strong presence of user ID-sharing based
on two-weeks online activities’ logs of over 100 users. In this section, we further
examine the potential intentions behind the ID-sharing by studying the eﬀect of
user proﬁle on the presence of ID-sharing domains. For this purpose we run mul-
tiple crawls on sets of trained user proﬁles. In order to create the user proﬁles, we
36
M. Falahrastegar et al.
Table 4. Top 15 categories of the sharing groups ordered based on their frequency
of occurrence. The Type column indicates the nature of domain categories within the
sharing group (within category=w-cat. versus cross category=c-cat.).
Sharing group
Search engines, Web advertisements
Search engines, Streaming media
Ad-tracker
Search engines
Ad-tracker, Web advertisements
Ad-tracker, Internet infrastructure
Type
c-cat
c-cat
w-cat
w-cat
c-cat
c-cat
Ad tracker, Photo searches, Search engines
c-cat
Media, News
Ad tracker, News
Web advertisements
Ad-tracker, Business
Health
c-cat
c-cat
w-cat
c-cat
w-cat
Internet infrastructure, Web advertisements c-cat
Ad tracker, Search engines
c-cat
ﬁrst created ﬁve artiﬁcial users with separate accounts on Google, Amazon, eBay
and Twitter. We assigned three diﬀerent proﬁle sizes, in terms of the browsing
histories, to our users: (1) Two users were given a browsing history consisting of
Alexa’s top 500 websites (Proﬁle-500 ); (2) Two other users with smaller size of
browsing history including Alexa’s top 200 websites (Proﬁle-200 ); (3) One user
with an empty browsing history (Proﬁle-0 ). To explore the eﬀect of not having
a user proﬁle, we considered a user with an empty browsing history and with-
out any accounts on the aforementioned websites (noAcount). We created the
browsing history by crawling the corresponding Alexa’s list of websites for ﬁve
consecutive times while users were logged-in. The proﬁle-training step was done
on the Firefox browser installed on a separate Linux machine per user. After
creating the user proﬁles, we installed the Firefox extension from the Sect. 2.1
on the Firefox browsers. Then, we executed the main step of the experiment by
visiting Alexa’s top 1000 websites for each user. We repeated this step for 20
iterations to expose as many as possible ID-sharing domains. We performed the
main step identically under two conditions: user logged-in and user logged-out.
We applied the same rules as described in Sect. 2.2 to identify user-speciﬁc
IDs. Consequently, we identiﬁed 4,104 unique user-speciﬁc IDs shared by 787
domains. Figure 3 illustrates the accumulated number of unique ID-sharing
domains across the iterations per user and proﬁle condition. We observe that
the highest rise occurs between the ﬁrst and second iteration (approximately
40 %), in comparison with subsequent iterations (Fig. 3). Moreover, we explored
Tracking Personal Identiﬁers Across the Web
37
Table 5. A sample HTTP request from webmd.com (a health information website)
to gravity.com (an advertisement tracker). Gravity.com logs users’ visited pages via
referrer URL-parameter. Consequently, the searched terms by users on webmd.com
are exposed to gravity.com (e.g. query=breast-cancer)
RequestURL: http://rma-api.gravity.com/v1/beacons/log?action=beacon&user
guid=21737bfabd4416779f6&referrer=
http://www.webmd.com/search/search results/default.aspx?
query=breast-cancer
Host:
Referer:
rma-api.gravity.com
http://www.webmd.com/breast-cancer/default.htm
i
s
n
a
m
o
D
g
n
i
r
a
h
s
−
D
I
.
o
N
0
0
6