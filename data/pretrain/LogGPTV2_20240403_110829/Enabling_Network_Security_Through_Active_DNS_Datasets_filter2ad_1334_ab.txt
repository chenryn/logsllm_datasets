updates.
A diﬀerent list of data that we utilize in our domain seed is a feed of inter-
esting domains that have been provided to us by a security company. This feed
provides us with domains that have been observed to engage in forms of poten-
tially malicious Internet activity. Because the feed provides us with new domain
names constantly, we gather all new information and append it to the already
existing list of interesting domains. We push the updated list to our collection
infrastructure daily. The feed provides us with tens of thousands of new domains
each day, making this list one of the fastest growing lists we use.
Finally we use a collection of public blacklist data in order to provide our data
with interesting hand curated domains that originate from malicious activity.
194
A. Kountouras et al.
More speciﬁcally the public blacklists we employ are: Abuse.ch [2], Malware
DL [9], Blackhole DNS [8], sagadc [10], hphosts [6], SANS [11] and itmate [1]. We
aggregate these lists daily and we input them into our domain seed by replacing
the old list.
2.3 Measurements
Thales has been collecting data for a little less than six months. For the purpose
of this paper we are focusing on analyzing all data in this section and then limit
in depth analysis to the last 12 days of March (the last full week forth) for
more speciﬁc measurements, unless a diﬀerent window is explicitly stated. Over
six months, Thales identiﬁed approximately 10,714,784 unique IP addresses,
199,110,841 unique domain names and 662,319,389 unique RRs per day. Figure 4
shows the distribution of IP addresses, domain names and RRs on average per
day from October 5th to March 3rd 2016.
Fig. 4. Volumes of IPs, resource records and domains observed with Thales. March
7th was the day when we started querying for the QTYPEs: SOA, AAAA, TXT and
MX. There have been two full outages on October 25, 2015 and January 23, 2016. On
December 6, 2015 we had an outage that lasted for most of the day but we were able
to recover the system later in the day.
During these months, we experienced two outages. The ﬁrst was when the
system was initially setup because of an update which was not rolled out correctly
and caused the system to go oﬀ-line. Therefore, there is no data available for
October 25, 2015, and policy has been updated to avoid future interruption since
then. On January 23, 2016, our campus data center was undergoing maintenance
for the cooling infrastructure, which caused a temporary shutdown of all our
systems. Such cases can now be mitigated by Thales. We have made the system
portable, which gives us the ability to move it to another location within a day’s
prior notice. Also on December 6, 2015 early in the day we had a hardware
failure on our system that was detected early in the morning. We were able to
recover the system and perform a check of the system by the same afternoon.
Enabling Network Security Through Active DNS Datasets
195
After the system check, we immediately restarted the collection, but there was
not enough time in the day to go through the entirety of data in our seed list.
This is depicted by the signiﬁcant dip in the data. This incident was not a full
outage since we were able to collect some data for the day.
3 Comparing Active and Passive DNS Datasets
Passive DNS has been an invaluable weapon in the community’s arsenal for
research combatting malware, botnets, and malicious actors [12–14,22,28]. Pas-
sive DNS, though, is rare, diﬃcult to obtain, and often comes with restrictive
legal clauses (i.e., Non Disclosure Agreements). At the same time, laws and reg-
ulations against personal identiﬁable information (PII), the signiﬁcant ﬁnancial
cost of the passive collection, and storage infrastructure are some of several rea-
sons that make passive DNS cumbersome. The primary goal for the active
DNS dataset is to reduce the barrier for (repeatable) security research on DNS.
In this section, we show how active DNS relates and contrasts to passive DNS.
We will see that, while not a true replacement for passive DNS, Thales is able
to create active DNS datasets that in many cases contain an order of magnitude
more domain names and IP addresses.
3.1 Datasets
We ﬁrst discuss how we obtain our passive DNS datasets. Our passive DNS
dataset consists of traﬃc collected at our university network. The collection
point is both below and above the recursive. This means that we collect the
responses on the both paths; (1) between the (anonymized) clients and the local
recursives and (2) between the local recursives and the upper layers of the DNS
hierarchy (i.e., name servers, top level domains, etc.). For the active and passive
DNS comparison, we decided to utilize datasets collected during the entire month
of March 2016.
Figures 5 and 6 show eight detailed plots of the distribution of records in both
our active and passive DNS datasets. Note that all plots are log-scale for the
y-axis. As we can see, the active DNS dataset does not ﬂuctuate a lot, compared
to the passive DNS one. This is primarily an artifact of the collection technique,
since the daily changes in the domain name seed we are using is minimal. On
the other hand, the passive DNS dataset, is primarily driven by the behavior of
the users on the local network, which may ﬂuctuate on weekends, holidays, and
during certain periods such as exams. This also explains the sudden increase
in traﬃc for passive DNS, since our campus network experienced a reduction
in traﬃc from March 21st until March 25th during spring break. Therefore,
Fig. 6c shows an increase to more than double the unique resource records (RRs)
identiﬁed per day after Monday, March 28th, when the spring break ended.
Table 1 shows a breakdown of the datasets over the last 12 days of March, in
much greater detail.
196
A. Kountouras et al.
Fig. 5. The distribution of diﬀerent query types (QTYPE) in the active (left) and
passive (right) DNS datasets. The active DNS dataset is almost sustaining the same
volume of records per day, whereas the passive DNS dataset is ﬂuctuating more over
time. Note the growth after March 28, when the Spring Break was over and the Institute
was operating at full capacity again.
It is worth noting that Thales is able to generate an order of magnitude more
unique domain names, IP addresses and RDATA in the active DNS dataset (see
Fig. 6, subﬁgures a to e), in comparison to the passive DNS data collected in a
large university. This means that in actual DNS records, the active DNS dataset
is more than comparable to the passive DNS that someone can collect in a
large university. Now, as we can see from Fig. 6(f), active DNS is not able to
create as dense graphs of resource records, as someone would expect to ﬁnd in
passive DNS data. This is somewhat to be expected, as in active DNS, Thales
is scanning all possible domain names that can be seen in our public sources.
This inevitably will include domain names that are rare, and in the context of
a graph compiled by RRs, they will form islands. While not necessarily bad, we
would advise researchers to take cautionary sanity steps when they utilize the
active DNS data for spectral processes.
The diversity of the diﬀerent query record types (QTYPEs) we are able to
identify, in the two diﬀerent datasets compared can been seen in Figs. 5a and b.
Although there is a big diﬀerence regarding the volume of the records available,
on average the visibility is very similar, since we are collecting the most popular
QTYPEs when querying for the active DNS datasets Table 2.
4 Case Studies
To this point, we exposed several of the data properties from the active DNS
datasets. In this section, we demonstrate the security value of these new active
DNS datasets. We should clarify that our goal is not to claim as a contribution
any of the following abuse detection processes. All of them have been discussed
by previous work in the ﬁeld. Rather, our goal is to practically demonstrate,
using the actual active DNS datasets, the security merit that active DNS data
can oﬀer to the research and operational communities.
Enabling Network Security Through Active DNS Datasets
197
Fig. 6. The distribution of diﬀerent records in our active and passive DNS datasets.
The plots show that Thales is able to generate orders of magnitude more data than
the passive DNS collection engine (Figures a to e) and much more diverse (Figure f).
198
A. Kountouras et al.
Table 1. Number of data points collected over the last 12 days of March 2016. Values
are in thousands (×103).
Date Domains
IPv4/IPv6
RDATA
RR
e2LD
Active
Passive Active Passive Active
Passive Active
Passive Active
Passive
3/20 258,702 6,759
41,360 1, 130
150,629 3,356
1,350,118
92,218 219,009
831
3/21 259,305 6,056
43,333 1, 292
162,366 3,845
1,360,660 110,379 219,009 1, 072
3/22 260,676 7,535
44,090 1, 180
164,685 4,364
1,400,427 109,896 219,985 1, 028
3/23 260,420 8,267
43,538 1, 255
147,190 4,338
1,352,019 111,247 221,466 1, 105
3/24 259,389 7,635
41,273 1, 206
137,491 4,024
1,367,554 112,513 222,464 1, 037
3/25 261,883 8,008
44,769 1, 197
155,830 4,125
1,399,724 114,518 228,119 1, 024
3/26 260,011 7,479
41,830 1, 127
152,918 3,616
1,362,978 111,646 226,030 1, 009
3/27 260,506 6,727
42,556 1, 190
148,728 3,871
1,382,096 120,624 223,313 1, 043
3/28 261,551 9,100
44,216 1, 340
144,365 4,499
1,375,399 199,023 223,345 1, 208
3/29 261,171 9,145
42,189
3/30 261,513 8,200
42,992
3/31 261,766 9,195
42,651
948
921
956
140,225 3,658
1,369,100 204,017 225,513
157,477 4,030
1,370,090 202,702 225,642
161,387 3,798
1,399,218 202,511 225,128
789
754
809
Table 2. The distribution of QTYPEs for the active and passive DNS in our datasets.
QTYPE Aggregate (×10
3
)
Mean
Passive
Median
Active
Passive
A
AAAA
CNAME
MX
NS
SOA
TXT
Other
Active
3, 082, 960
292, 278
174, 881
2, 222, 465
5, 822, 874
3, 498, 172
701, 689
694, 067
Passive Active
813, 485
81, 992
136, 901
24,356,555.67
14,573,484.5
256,913,375.92 67,790,485.33 257,181,439.5 54,989,441.0
6,832,692.33
23,918,026.5
5,920,971.5
11,408,450.0
14,582,732.0