to its front-end. It is important to note that SecSpider’s
data is cryptographically signed and veriﬁed by its various
components starting when its pollers receive answers from
name servers until a user downloads it. The DNS messages
(including queries from the coordinator and responses sent
by the pollers back to the coordinator) use TSIG cryptogra-
phy, the coordinator makes a local secure connection to the
backend database, DNSKEY data served through web site
is signed by SecSpider’s operational GPG key, and all DLV
records are signed and veriﬁable by the dlv.secspider.cs.ucla.
edu DNSKEY. Thus, the security between each component of
SecSpider speaks to the general principle that as components
become loosely coupled, it becomes increasingly important
to secure their communications against any intervention
Figure 6. The ERD of SecSpider’s database.
(such as insider threats or compromised components).
After SecSpider performs internal veriﬁcation of the re-
trieved data, it creates a drill-down page for each monitored
DNSSEC zone that lists many monitoring statistics, among
those are the list of the zone’s DNSKEY records and its DS
record(s). These are presented in HTML, but also in separate
ﬂat ﬁles. These ﬁles include the actual RRSIG values, and
a list of which pollers observed the values. The purpose of
these ﬁles is to let operators and scripts easily download
the records for any given zone, and easily see whether any
discrepancy exists among the records observed by all the
pollers. If an adversary spoofs the results for a subset of
pollers, the discrepancy will reveal the attacks. Even if an
adversary manages to spoof the results of all the SecSpider
pollers, given the data and values are all publicly available,
vigilant zone owner can still notice the attacks by looking
up SecSpider results periodically.
Furthermore, all of the keys that are seen consistently
across SecSpider’s pollers and across long enough time
periods are then entered into SecSpider’s global
trust-
anchors ﬁle. This is one of SecSpider’s main contributions.
The implications of SecSpider’s distributed framework, and
cryptographic checks are that it can furnish resolvers with
veriﬁed DNSKEY records in a readily usable form of trust-
anchors today. Furthermore, SecSpider uses its GPG key
to cryptographically sign each of these ﬂat ﬁles so that if
someone is interested in verifying the origin authenticity
they can do so.
C. Database
SecSpider stores all of its data in a MySQL relational
database. The schema is split into two major types of table: i)
DNS tables and ii) statistics tables. The Entity Relationship
Diagram is seen in Figure 6.
DNS tables are designed so that all of the DNS RRsets
and RRs that SecSpider tracks are categorized as either being
435
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 13:11:53 UTC from IEEE Xplore.  Restrictions apply. 
SS_ZONESS_RRSETSS_NAMESERVERSS_NAMESERVER_STATSSS_POLLERSS_ZONE_STATSSS_SET_STATSSS_PMTU_STATSSS_DNSKEYSS_RRSIGSS_RRSS_DSSS_DS_STATSSubmission Source
User Submissions
DNS Monitors
Web Crawling
NSEC Walking
Percent
30.79%
51.28%
10.75%
7.18%
THIS TABLE SHOWS THAT THE LARGEST CONTRIBUTOR TO
SECSPIDER’S CORPUS HAS BEEN PASSIVE MONITORS OF DNS. NEXT
HAS BEEN USER SUBMISSIONS, FOLLOWED BY WEB CRAWLING AND
Table I
NSEC WALKING.
veriﬁable DNSSEC records or not. Veriﬁable records are
those with valid (i.e. not expired) RRSIG records attached.
These are records that SecSpider uses to maintain the state
of DNSSEC-enabled zones. Other records are considered as
un-veriﬁed and are only used for historical measurements
and analysis.
Statistic tables track various types of data that are
observed during each run. A good example is
the
SS_NAMESERVER_STATS table in which each row has
an observation date and tracks what a name server reports
as its version number2, and statistics such as whether it is
DNSSEC-enabled. These tables are all transactional (mean-
ing they only grow over time).
D. Implementation Summary
As of this writing, SecSpider has been an operational
tool for the DNSSEC community for over 3 years. Our
website [1] has already become a useful part of many
operators’ practices as evidenced by the fact that it served
over 2.3 million page views in 2008 alone. We currently
track approximately 18,000 DNS zones in our database.
SecSpider pollers operate at NL Net Labs (Netherlands),
Colorado State University (US - Central), Tsinghua Uni-
versity (China), Cable Modem in Los Angeles (US - West),
Toshiba Corporation (Japan), Switch (Switzerland), and Telx
(US - East). SecSpider’s backend database currently uses
several
the
statistics describing the name servers of zones, the avail-
ability of DNSKEY RRsets, and the transitions that zones
make between DNSSEC-enabled and not have generated
tables with 17 million, 15 million and 17 million records
respectively.
tables with multi-millions of rows. To date,
V. SECSPIDER MONITORING RESULTS
SecSpider has an increasingly long history of providing
operational insights into DNSSEC’s behavior [2], [27], [4].
In addition to that, SecSpider’s data has also demonstrated
its usefulness to academic research [21], [19], [20], [15].
Recent events such as [12] have served as timely forcing-
functions for DNSSEC’s deployment. As of this writing we
2Users can query name servers for a record called VERSION.BIND of
type CH, and by convention many name servers will report their software
name and version number.
Figure 8. This Figure shows that as the number of secure delegations has
grown (the upper curve), so too has the incidence of misconﬁgured secure
delegations (the lower curve).
have begun to see an unprecedented level of adoption for
DNSSEC. Table I shows the break down of how SecSpider
has learned of DNSSEC zones through its different discov-
ery channels. However, more interesting is Figure 7 which
shows that after the summer of 2008 (when the [12] security
advisory was issued), the adoption rate of DNSSEC has
signiﬁcantly increased. This makes it a critical time for tools
and observations to inform operators and augment DNSSEC
in places where its design is failing. One such place is in the
context of how resolvers securely learn the correct DNSKEYs
for the zones they encounter.
SecSpider’s data set has also proven useful
in track-
ing operational practices surrounding the secure delegation
hierarchy. This was discussed during a recent operation
presentation [3]. Figure 8 shows that recent increases in
the number of secure delegations have corresponded with
increases in misconﬁgured secure delegations (the lower
curve) as well.
Perhaps one of the most signiﬁcant ﬁndings from SecSpi-
der’s measurement apparatus to date is the quantiﬁcation and
demonstration of the previously unobserved PMTU problem
that DNSSEC faces. When a timeout occurs for a DNSKEY
query, SecSpider presumes a large message size resulted in
a PMTU problem3. A recent study [13] done at one of the
DNS root servers found roughly half of the global DNS
trafﬁc observed requested message sizes of 4,096 bytes.
Therefore, SecSpider begins with this same value. If that
value causes a failure, SecSpider then retries the query
(from the same poller) with half the message size. SecSpider
uses this process to increase and decrease message sizes
(following a binary search, depicted in Figure 9) until it
determines what the proper request size should be in order
to get an un-truncated message in one try.
While our pollers now have logic added to resolve a
PMTU issue, a typical resolver does not. If the resolver uses
3Note, SecSpider checks name servers to ensure they are online and
reachable before querying for any DNS data.
436
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 13:11:53 UTC from IEEE Xplore.  Restrictions apply. 
Figure 7. Here we see that the adoption rate of DNSSEC has dramatically increased since the summer of 2008.
a maximum message size that the path between it and server
will not support it does not know that it is falsely advertising
the network path cannot
a maximum message size that
support. This is further complicated because the maximum
message varies depending on both which server the resolver
is querying and which path routing provides to that server.
During a PMTU failure, a resolver receives no response and
therefore will not fallback to TCP and generally will not try
a different message size. Thus, some resolver/server pairs
effective DoS themselves and the corresponding DNSSEC
zones appear unreachable. Without an external monitoring
project such as SecSpider, the problem is hard to detect.
Zone administrators cannot control the PMTU and the
PMTU varies depending on the resolver location. However,
the zone administrator can learn that PMTU issues are
occurring with SecSpider pollers. A response to a DNSKEY
query message is often the most problematic response. Some
zones will create responses that contain 4 public keys and 4
signatures. Contrast this with the response for a typically IP
address query whose answer would contain a small number
of A (IPv4) or AAAA (IPv6) records and signatures. The
net result is that selecting a large key set may simplify
some key rollover operations and selecting large key sizes
may increase cryptographic security, but the cost is message
size and if the message is too large some portions of
the Internet will be unable to resolve data from the zone.
Figure 9. Here one can see how the message size begins at 4,096 when
the PMTU is actually 1,500. After a failure, 4,096 is halved to 2,048 which
also fails. The next unit is 1,024, which succeeds. The binary search then
continues to search for the exact value and increases the message size until
the exact size is found.
SecSpider illustrates this on zone drill-down pages so that
administrators can be aware of the problem and consider
the trade-offs between the beneﬁts of large key sets and the
beneﬁts of global reachability.
We feel
VI. CONCLUSIONS AND IMPLICATIONS FOR OPERATORS
that operational evidence supports our view
that a distributed global monitoring has been, and will
continue to be, a pivotal part of ensuring the success of
the DNSSEC deployment. The above results are just a
437
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 13:11:53 UTC from IEEE Xplore.  Restrictions apply. 
 0 10 20 30 40 50 60 70 80 90 100Jul 05Jan 06Jul 06Jan 07Jul 07Jan 08Jul 08Jan 09Jul 09% of ZonesDateCDF of DNSSEC zonesAll ZonesUser SubmissionsCrawledNSEC walked1,500SecSpiderPollerAuthNameServer4,0962,0481,0241,536[18] A. Ntoulas, G. Chao, and J. Cho. The infocious web search
engine: improving web searching through linguistic analysis.
In WWW ’05: Special interest tracks and posters of the 14th
international conference on World Wide Web, pages 840–849,
2005.
[19] Eric Osterweil, Daniel Massey, and Lixia Zhang. Observa-
tions from the DNSSEC Deployment. In The 3rd workshop
on Secure Network Protocols (NPSec), 2007.
[20] Eric Osterweil, Vasilis Pappas, Dan Massey, and Lixia Zhang.
Zone state revocation for dnssec. In LSAD ’07: Proceedings
of ACM Sigcomm Workshop on Large Scale Attack Defenses,
2007.
[21] Eric Osterweil, Michael Ryan, Dan Massey, and Lixia Zhang.
Quantifying the operational status of the dnssec deployment.
In IMC ’08: Proceedings of the 8th ACM SIGCOMM confer-
ence on Internet measurement. ACM, 2008.
[22] Eric Osterweil and Lixia Zhang.
lenges in managing dnskeys.
7(5):44–51, 2009.
Interadministrative chal-
IEEE Security & Privacy,
[23] Scott Rose.
Revised nist guidance
for
zsk sizes.
http://mail.shinkuro.com:8100/Lists/dnssec-deployment/
Message/2328.html?Language=.
[24] NetSec Colorado State.
rdnsd polling. https://www.netsec.
colostate.edu/dnsmonitor/secure.html.
[25] P. Vixie, O. Gudmundsson, D. Eastlake 3rd, and B. Welling-
ton. Secret Key Transaction Authentication for DNS (TSIG).
RFC 2845, May 2000.
[26] S. Weiler. DNSSEC lookaside validation (DLV). RFC 5074,
SPARTA Inc., November 2007.
[27] Duane Wessels. Kaminsky vulnerabilty leads to increased
dnssec adoption. https://www.dns-oarc.net/node/156.
sample of the how monitoring plays an essential role in the
deployment of DNSSEC. The data is freely available and
widely used in the DNSSEC operational community. The
data from SecSpider is inﬂuencing operational practices and
helping inform the larger DNS operation community by both
identifying challenges and highlighting successes. Individual
zones interested in deploying DNSSEC are encouraged to
track their progress on SecSpider. Drill-down pages provide
a site with a snapshot of how their zone is viewed from
multiple location around the world. SecSpider also provides
one with a view of secure sites that your resolvers may be
accessing. If a site is having trouble obtaining secure records
a particular zone, SecSpider can be used to determine how
other resolvers view the same data.
REFERENCES
[1] SecSpider. http://secspider.cs.ucla.edu/.
[2] Secspider: Distributed dnssec monitoring.
In NANOG 44
Tools BoF, 2008. http://www.nanog.org/meetings/nanog44/
abstracts.php?pt=ODg1Jm5hbm9nNDQ=\&nm=nanog44.
[3] The state and challenges of the dnssec deployment.
In
NANOG 44 DNSSEC BoF, 2008. http://nanog.org/meetings/
nanog44/presentations/Sunday/Osterweil DNSSEC N44.pdf.
In RIPE
58, 2009. http://www.ripe.net/ripe/meetings/ripe-58/content/
presentations/dnssec-deployment-problems.pdf.
[4] Availability problems in the dnssec deployment.
secure domain name
system (dns) deployment
In NIST Computer Security Division, 2009.
[5] Draft
guide.
http://csrc.nist.gov/publications/drafts/800-81-rev1/nist
draft sp800-81r1-round2.pdf.
[6] Network path problems in dnssec’s deployment.
In IETF
75 - dnsext, 2009. http://www.ietf.org/proceedings/75/slides/
dnsext-3.pdf.
[7] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose.
DNS Security Introduction and Requirement. RFC 4033,
March 2005.
[8] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose.
Protocol Modiﬁcations for the DNS Security Extensions. RFC
4035, March 2005.
[9] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose.
Resource Records for the DNS Security Extensions. RFC
4034, March 2005.
[10] D. Atkins and D. Austein. Threat Analysis of the Domain
Name System (DNS). RFC 3833, August 2004.
[11] Steven M. Bellovin. Using the domain name system for
In Proceedings of the Fifth Usenix Unix
system break-ins.
Security Symposium, pages 199–208, 1995.
[12] CERT. Cert vulnerability note vu#800113, 2008.
[13] The Measurement Factory. Dns survey: October 2007, 2007.
http://dns.measurement-factory.com/surveys/200710.html.
[14] P. Hope. Using Jails in FreeBSD for Fun and Proﬁt. Login:
The Magazine of Usenix & Sage.
[15] Andrew J. Kalafut, Craig A. Shue, and Minaxi Gupta. Un-
In IMC
derstanding implications of dns zone provisioning.
’08: Proceedings of the 8th ACM SIGCOMM conference on
Internet measurement, pages 211–216, New York, NY, USA,
2008. ACM.
[16] B. Laurie, G. Sisson, R. Arends, and D. Blacka. DNS Security
(DNSSEC) Hashed Authenticated Denial of Existence. RFC
5155, February 2008.
[17] P. Mockapetris and K. J. Dunlap. Development of the domain
name system. In SIGCOMM ’88, pages 123–133, 1988.
438
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 13:11:53 UTC from IEEE Xplore.  Restrictions apply.