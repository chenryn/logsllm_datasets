2001:db8:1234:5678::/64
WAN (IPv6) Address
2001:db8:1234:5678:IID
NX WAN (IPv6) Address
2001:db8:1234:5678:IIDnx
LAN (IPv6) Prefix
2001:db8:4321:8760::/60
Subnet (IPv6) Prefix
2001:db8:4321:8765::/64
NX Host (IPv6) Address
2001:db8:4321:876x:IIDnx
We aim to discover the IPv6 network periphery, a crucial in-
frastructure within end-user networks, whose network security
issues with IPv6 have not been studied well formerly.
As described in Section II, the IPv6 periphery is not any
server and client device, but the last hop routed infrastructure
connecting end-hosts or nothing except itself, e.g., a CPE like
a home router and a UE like a smartphone. As a provisioning
system [78], it not only forwards packets and provides network
access services between the Internet and its LAN network but
also serves as a security gateway for packet ﬁltering and access
control. And it has become one determining device in the home
networks. Especially, a UE can turn into the periphery by being
assigned an IPv6 preﬁx from mobile networks [19], [47], [48].
Figure 1 illustrates two topology models of the IPv6 periph-
ery we aim to discover, covering the broadband network (CPE
model) and the mobile network (UE model). We describe these
two models detailedly in the following.
Customer Premises Edge (CPE) model. In the case of the
CPE router model [78], one ISP router connects with a number
of CPE routers. There are two primary network interfaces in
every CPE router, including the WAN interface and the LAN
interface. Each of these interfaces is assigned or delegated an
IPv6 preﬁx (being used to form a subnet) from the ISP’s IPv6
block (ISP (IPv6) Preﬁx), such as 2001:db8::/32 in Figure 1.
In general, the subnet between the ISP router and the CPE
router is assigned a public IPv6 preﬁx as the router’s WAN in-
terface preﬁx, such as 2001:db8:1234:5678::/64, named WAN
(IPv6) Preﬁx in the rest of this paper. And the customer subnet
inside the CPE router’s LAN is also delegated one globally ad-
dressable preﬁx different from WAN Preﬁx commonly, named
LAN (IPv6) Preﬁx. Speciﬁcally, LAN Preﬁx is instantiated as
2001:db8:4321:8760::/60 in Figure 1. In practice, a sub-preﬁx
of LAN Preﬁx is advertised to more than one node on an inside
link and shared by the subnet, termed Subnet (IPv6) Preﬁx.
After obtaining a preﬁx, a CPE often uses Stateless Address
Autoconﬁguration (SLAAC) [84] algorithm to create the glob-
ally unique 128-bit addresses. For instance, the CPE router’s
WAN Interface (IPv6) Address is initiated by appending IID
to WAN Preﬁx, whereas Subnet Preﬁx and IID assemble LAN
Interface (IPv6) Address and Host (IPv6) Address.
User Equipment (UE) model. As for the UE model [19], [47],
[48], a UE is attached to its provider’s radio access network
and is assigned one publicly-routed preﬁx, entitled UE (IPv6)
(a) CPE routers linked to the ISP router
Base Station
Radio 
Access
Internet
IPv6 Network 
Periphery
User 
Equipments
UE (IPv6) Prefix
2001:db8:abcd:ef12::/64
UE (IPv6) Address
2001:db8:abcd:ef12:IID
NX UE (IPv6) Address
2001:db8:abcd:ef12:IIDnx
(b) UE devices attached to the ratio access network
Fig. 1. The IPv6 Network Periphery Models
Preﬁx, e.g., 2001:db8:abcd:ef12::/64 in Figure 1. A UE creates
UE (IPv6) Address by combining UE Preﬁx with IID.
These two models are commonly applied to residential and
mobile IPv6 networks, according to [19], [47], [48], [78]. And
the broadband and mobile network are widely deployed [46],
[65]. Similarly, the CPE model exists in enterprise networks.
B. Periphery Discovery Strategy
For IPv4, the most straightforward strategy to discover alive
devices is to probe the whole network space. Current scanning
techniques enable a single host to scan the entire 32-bit IPv4
address space in <1h [29]. However, it will take 40,000+ years
to scan just the 64-bit IPv6 IID space in this fashion, which
is prohibitively impracticable and impossible.
However, owing to the characteristic of the global address-
ability, IPv6 allows direct end-to-end communication between
the LAN hosts and devices from the Internet. Depending on the
new address allocation principles, the IPv6 network periphery
functions as a routing gateway device, forwarding packets and
providing network access service for itself and LAN hosts. All
the changes aforementioned make IPv6 different from IPv4 on
the behaviors of the periphery.
For example, as claimed by RFC 4443 [24], when a packet
can not be delivered to the destination address, one ICMPv6
Destination Unreachable message should be generated by the
router or by the IPv6 layer in the originating node. Regarding
the IPv4 router using NAT, all downstream devices are repre-
sented by a public address. Generally speaking, there is no way
to send a packet directly to an internal address from outside.
However, in the IPv6 network, almost all devices can obtain
a public-routed preﬁx managed by peripheries. Therefore, the
IPv6 periphery would generate one unreachable message for
a packet with a nonexistent destination towards such a preﬁx.
Authorized licensed use limited to: Tsinghua University. Downloaded on October 11,2021 at 09:24:27 UTC from IEEE Xplore.  Restrictions apply. 
90
INFERRED IPV6 SUB-PREFIX LENGTH FOR END-USERS OF TARGET ISPS
Country
Network
Length
ISP
TABLE I
India
America
China
Broadband
Mobile
Broadband
Mobile
Enterprise
Broadband
Mobile
Reliance Jio
BSNL
Bharti Airtel
CenturyLink
Vadafone
Comcast
AT&T
Charter
AT&T
Mediacom
Telecom
Unicom
Mobile
Unicom
Mobile
ASN
55836
9829
45609
38266
7922
7018
20115
209
20057
30036
4134
4837
9808
4837
9808
Block
/32
/32
/32
/32
/24
/24
/24
/24
/24
/28
/24
/24
/24
/24
/24
64
64
64
64
56
60
56
56
64
56
60
60
60
64
64
Leveraging the above mechanism, we could craft one packet
with a nonexistent IPv6 destination address, such as NX WAN
Address, NX Host Address or NX UE Address, which would be
transmitted to the IPv6 network periphery, respectively. Due to
large 64-bit IID space, it is nearly impossible to hit an existent
128-bit address. As a result, the periphery will respond with a
destination unreachable error message for that crafted packet,
exposing its address, such as WAN Address or UE Address.
Applying this delicate strategy, we could discover the crucial
IPv6 network periphery infrastructure, instead of a single com-
mon end-host. This method is not curbed by any address seeds
diversity or algorithm complexity. What is more important, this
technique devotes such a tremendous progress that the search
times is extremely reduced from 2128−64 or larger to 1, to ﬁnd
a periphery, more effective than existing tools or works [77].
Scanning Feasibility Analysis. In spite of the fact that it is
impossible to scan the entire IPv6 address space or just 64-bit
IID space, we shift the search target from 128-bit addresses to
less-bit sub-preﬁxes within each ISP. As shown in Section II
and Table I, ISPs tend to allocate preﬁxes with length at most
64 to their customers, such as /64 for WAN Preﬁx, /60 or short
for LAN Preﬁx, and /64 for UE Preﬁx (from Section IV-E).
If a researcher obtains one preﬁx assigned to any periphery,
e.g., a LAN Preﬁx or a UE Preﬁx, with the above strategy, he
can ﬁnd WAN Address or UE Address of the periphery through
sending one packet destined for any nonexistent address within
that preﬁx merely. Further, if the researcher acquires one IPv6
block allocated to any ISP, e.g., a /24 ISP Preﬁx, one 1 Gbps
scanner [29], could probe all /64 sub-preﬁxes (240) in 8 days
and all the /60 sub-preﬁxes (236) in 14 hours with each sub-
preﬁx being probed for once, which is totally practical.
In this section, we introduce a novel IPv6 scanning tech-
nique to discover the critical IPv6 network periphery. We show
it is powerful to expose vast peripheries by feasible scanning,
targeting the sub-preﬁx within each ISP Preﬁx, and leveraging
the extensively implemented IPv6 address allocation principle.
IV. EVALUATION AND MEASUREMENT
In this section, we evaluate the fast IPv6 periphery scanning
approach on 15 IPv6 blocks within 12 popular ISPs from India,
America, and China, shown in Table I and select preﬁx targets
91
based on the WHOIS databases maintained by APNIC [6] and
ARIN [9]. These three countries hold a signiﬁcant number of
IPv6 users, and the 12 ISPs (13 ASes) have large IPv6 users
within each country as well, according to the statistics [7], [8]
from APNIC Labs. We design and implement an IPv6 network
scanner, XMap. As a result, leveraging XMap, we harvest 52M
IPv6 peripheries under our experiment setup with <15 Mbps
network uplink bandwidth. Besides, we analyze their security
properties with IID analysis and application-level information.
A. Scanning Targets
IPv6 Subnet Discovery. A prerequisite is to deduce the length
of the sub-preﬁx assigned to a periphery (the subnet boundary)
within an ISP Preﬁx. We develop a very efﬁcient technique to
extrapolate it, emanated from the periphery discovery strategy.
We begin with a preliminary scanning to gain one periphery
address. This scanning probes a small number of the IPv6 sub-
preﬁxes within one ISP Preﬁx, e.g., 2001:db8::/32 in Figure 1,
by combining different /64 preﬁxes with random IIDs as the
target scanning addresses, e.g., 2001:db8:0:1:IIDtarget. If we
receive an unreachable packet from a periphery-like address,
such as 2001:db8:1:1:IIDreply of EUI-64 format, we consider
it as one valid periphery address and stop this ﬁrst scanning.
Furthermore, we modify the bits of 2001:db8:0:1:IIDtarget
from the 64th to 32nd bit in reverse order to create new target
addresses, e.g., 2001:db8:0:8:IID and 2001:db8:0:10:IID, and
probe them respectively. If any responded address is different
from the former address or does not exist, we conclude that the
changed bit position is the subnet boundary. For instance, if we
also receive one packet from 2001:db8:1:1:IIDreply responding
for the packet destined for 2001:db8:0:8:IID and no response
for 2001:db8:0:10:IID, the sub-preﬁx length probably is 60.
We replicate the test several times to ensure the correctness
of the inference. If multiplex sub-preﬁx lengths are found, we
choose one primary length for our measurements. Besides, we
take /64 as the longest preﬁx assigned to peripheries depending
on the far-ranging address assignment practices described in
Section II. The inferred sub-preﬁx length of the 15 IPv6 blocks
is listed in Table I, and all these 12 ISPs assign preﬁxes with
length at most 64 to their customers.
Target Lists. To demonstrate the scanning feasibility, instead
of searching the whole ISP Preﬁx space (though it is feasible),
we select the 32-bit sub-preﬁx space per block for evaluation.
For example, the address space between the 32nd and 64th bit
(/32-64) within a Reliance Jio’s IPv6 block will be one of our
probe targets. The entire scanning ranges are listed in Table II.
B. XMap: The IPv6 Network Periphery Scanner
Currently, we are lacking tools that have the ability to scan
the IPv6 preﬁx space. So, we introduce XMap for performing
the Internet-wide IPv6 network research scanning. XMap is re-
implemented and improved thoroughly from ZMap [29]. We
equip it with modular design, address random generation and
exclusion, fast packet processing, and various probe modules.
The key module is the address generation module, providing
an all address space random permutation. Unlike ZMap, which
Authorized licensed use limited to: Tsinghua University. Downloaded on October 11,2021 at 09:24:27 UTC from IEEE Xplore.  Restrictions apply. 
RESULTS OF PERIPHERY SCANNING FOR ONE SAMPLE IPV6 BLOCK WITHIN EACH ISP
TABLE II
Cty
Network
Internet
Provider
Last Hops (128-bit addr)
# uniq
3,365,175
% same % diff
/64 preﬁx
Scan
Range
/32-64
/32-64
/32-64
/32-64
/24-56
/28-60
/24-56
/24-56
/32-64
/28-56
/28-60
/28-60
/28-60
/32-64
/32-64
Reliance Jio
BSNL
Bharti Airtel
CenturyLink
Vadafone
Comcast
AT&T
Charter
AT&T
Mediacom
Telecom
Unicom
Mobile
Unicom
Mobile
Total
2,404
22,542,690
2,307,784
87,308
740,141
13,027
249,835
1,734,506
38,399
2,122,292
1,273,075
7,316,861
3,696,275
7,193,972
52,478,703
99.8
34.4
98.9
99.8
0.0
0.0
1.6
0.0
94.5
0.0
0.2
3.0
2.4
97.9
98.4
77.2
# uniq
3,363,513
2,276
22,340,370
2,307,672
5,694
735,958
1,573
233,298
1,730,125
516
2,100,034
1,272,540
7,315,713
3,693,605
7,188,311
52,086,849
%
100.0
94.7
99.1
100.0
6.5
99.4
12.1
93.4
99.7
1.3
99.0
100.0
100.0
99.9
99.9
99.3
0.2
65.6
1.1
0.2
100.0
100.0
98.4
100.0
5.5
100.0
99.8
97.0
97.6
2.1