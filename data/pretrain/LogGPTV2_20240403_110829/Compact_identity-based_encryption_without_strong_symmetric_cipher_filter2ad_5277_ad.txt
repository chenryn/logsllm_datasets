previously deﬁned value is returned. Otherwise, B checks if the auxiliary list
2 contains an entry of the form (U, V1, . . . , Vt,L, ?, κ, γ, QIDi) for some pair
L(cid:3)
(κ, γ) ∈ {0, 1}λ × G2 and some QIDi
∈ G1.
Identity Based Encryption Without Redundancy
297
• If it does, B checks if ODBDH(P, QIDi
, U, Ppub, γ/ω) = 1 for each one of
such triples (κ, γ, QIDi). If the decision oracle positively answers for one
of them, the corresponding κ is returned as a hash value.
• Otherwise, B returns a randomly sampled string κ R← {0, 1}λ
In both case, B stores the information (U, V1, . . . , Vt,L, ω, κ) in L2.
1
1
t = l∗
1(cP ), . . . , V ∗
1 = l∗
t ∈ Z
q are ﬁnite ﬁeld elements for which H1(ID∗
∗
In the challenge step, A produces messages M0, M1 ∈ {0, 1}n. The simulator
B computes U∗ = cP, V ∗
t (cP ) and the corresponding
label L∗ where l∗
, . . . , l∗
j ) =
j P − Q for j ∈ {1, . . . , t}. It then chooses a random κ∗ R← {0, 1}λ and com-
l∗
putes W ∗ = Eκ∗(Md) for d R← {0, 1}. The challenge ciphertext is set to C∗ =
t , W ∗,L∗(cid:5). In the unlikely event (its probability is less than qD/2k)
(cid:4)U∗, V ∗
that C∗ was queried to the decryption oracle at the ﬁnd stage, B aborts.
All queries of the guess stage are processed as in the ﬁnd stage and A even-
tually produces a bit d(cid:3). From a similar analysis to the one of theorem 1, we
t ,L∗, ω∗), where ω∗ = e(P, P )abc
ﬁnd that the relevant query H2(U∗, V ∗
is very likely to be made by A during the simulation. The Gap-BDH solution
(cid:14)(cid:15)
can thus be detected when handling H2(.) queries.
, . . . , V ∗
, . . . , V ∗
1
5 Another Way to Avoid the Re-encryption in IBE
This section presents an alternative method to achieve the chosen-ciphertext
security in the original IBE system [10] without requiring a re-encryption for
validity checking upon decryption and without having to encode of piece of ci-
phertext as a long G2 element. This method introduces a minimal amount of
redundancies in ciphertexts (only 160 additional bits are needed w.r.t to Ba-
sicIdent) and is actually an extension of a construction originally designed by
Bellare and Rogaway [6] for trapdoor permutations. Recall that this construc-
tion produces ciphertexts of the form E(m, r) = (cid:4)f(r), m⊕G(r), H(m, r)(cid:5), where
r denotes a random coin, f is a trapdoor permutation and G, H are random or-
acles. Actually, this construction (that was previously generalized into a generic
conversion in [29]) can be instantiated with more general number theoretic prim-
itives. For example, it can be applied to the El Gamal [19] cryptosystem and
to the Boneh-Franklin identity based encryption scheme. The resulting scheme
is called XBR-IBE (as a shorthand for eXtended Bellare-Rogaway like IBE) and
depicted on ﬁgure 3.
As for the schemes described in the previous sections, the security relies on
the Gap-BDH assumption. The security proof is omitted here because of space
limitation but will be given in the full version of this paper.
Theorem 3. If an IND-ID-CCA2 adversary A has advantage  against XBR-
IBE in a time τ when asking qhi queries to oracles hi (i = 1, 2, 3), qD decryption
queries and qKE private key queries, then a PPT algorithm B can solve the
Gap-BDH problem with an advantage (cid:3) ≥ (e(qKE + 1))−1(− qD
2k−1 ) within time
τ(cid:3) ≤ τ + (qh1 + qKE)τmult + 2(qh2 + qh3)Φ where τmult is the cost of a scalar
298
Benoˆıt Libert and Jean-Jacques Quisquater
Setup: is the same as in Hybrid-IBE except that no cipher is needed and hash func-
tions are H1 : {0, 1}∗ → G1, H2 : {0, 1}∗ → {0, 1}k1 and H3 : G2 → {0, 1}n
where n still denotes the size of plaintexts and k1 is a security parameter
which is polynomial in k = log(|G1|).
Keygen is the same as in Hybrid-IBE and Hybrid-IBE2.
Encrypt: to encrypt a message M using an identity ID ∈ {0, 1}∗
H1(ID) ∈ G1, pick a random r R← Z
∗
q and output the ciphertext
ID), H2(m||rP||ID||g
rP, m ⊕ H3(g
C =
(cid:4)
r
ID)
(cid:3)
r
, compute QID =
Decrypt: given C = (cid:4)U, V, W(cid:5), compute ω = e(U, dID) and m = V ⊕ H3(ω) ∈
where gID = e(Ppub, QID) ∈ G2.
{0, 1}n. Output m ∈ {0, 1}n if W = H2(m||U||ID||ω) and ⊥ otherwise.
Fig. 3. XBR-IBE
multiplication in G1, Φ denotes the cost of a call to the DBDH oralce and e is
the base of the natural logarithm.
Interestingly, a similar method also applies to Baek et al.’s multiple-receiver
scheme [5] and yields shorter ciphertexts (about 1024 bits are spared) which
have the form (cid:4)rP, V1, . . . , Vt, m ⊕ H3(ω), H2(m, rP, V1, . . . , Vt,L, ω),L(cid:5) where
Vi = rH1(IDi) + rQ for i = 1, . . . , t, ω = e(Ppub, Q)r and the label L contains
receivers’identities ID1, . . . , IDt. The security of this second multiple-receiver
scheme still relies the Gap-BDH assumption.
6 Conclusion
We presented two methods to avoid the re-encryption in chosen-ciphertext se-
cure IBE systems. Among those methods, the hybrid construction yields more
compact ciphertexts thanks to the absence of redundancies. We also explained
how to shorten ciphertexts produced by a multiple-receiver IBE scheme. We
ﬁnally gave an example of secure public key encryption scheme for which no
validity checking is needed at decryption although the encryption mapping is
not surjective.
Acknowledgements
Thanks to Damien Vergnaud for his helpful comments and to the anonymous
referees for their useful feedback.
References
1. M. Abdalla, M. Bellare, P. Rogaway, The Oracle Diﬃe-Hellman Assumptions and
an Analysis of DHIES, in Topics in Cryptology – CT-RSA’01, LNCS 2020, pp.
143–158, Springer, 2001.
Identity Based Encryption Without Redundancy
299
2. M. Abe, Combining Encryption and Proof of Knowledge in the Random Oracle
Model, Topics in Cryptology – CT-RSA’02, LNCS 2271, Springer, pp. 277–289,
2002.
3. S.-S. Al-Riyami , K.G. Paterson, Certiﬁcateless Public Key Cryptography, in Ad-
vances in Cryptology – Asiacrypt’03, LNCS 2894, pp. 452–473, 2003.
4. S.S. Al-Riyami , K.G. Paterson, CBE from CL-PKE: A Generic Construction and
Eﬃcient Schemes , in proc. of PKC’05, LNCS 3386, pp. 398–415, Springer, 2005.
5. J. Baek, R. Safavi-Naini, W. Susilo, Eﬃcient Mutli-Receiver Identity-Based En-
cryption and Its Application to Broadcast Encryption, in proc. of PKC’05, LNCS
3386, pp. 380–397, Springer, 2005.
6. M. Bellare, P. Rogaway, Random oracles are practical: A paradigm for designing
eﬃcient protocols, in proc. of the 1st ACM Conference on Computer and Commu-
nications Security, pp. 62-73, 1993.
7. M. Bellare, P. Rogaway, Optimal asymmetric encryption – How to encrypt with
RSA, in Advances in Cryptology – Eurocrypt 94, LNCS 950, Springer, pp. 92–111,
1995.
8. K. Bentahar, P. Farshim, J. Malone-Lee, N.P. Smart, Generic Constructions of
Identity-Based and Certiﬁcateless KEMs, Cryptology ePrint Archive Report, avail-
able from http://eprint.iacr.org/2005/058.
9. D. Boneh, X. Boyen, Eﬃcient Selective-ID Secure Identity Based Encryption With-
out Random Oracles, in Advances in Cryptology – Eurocrypt’04, LNCS 3027,
Springer,pp. 223–238, 2004.
10. D. Boneh, M. Franklin, Identity Based Encryption From the Weil Pairing, in Ad-
vances in Cryptology – Crypto’01, LNCS 2139, pp. 213–229, Springer, 2001.
11. D. Boneh, B. Lynn, H. Shacham, Short signatures from the Weil pairing, in Ad-
vances in Cryptology – Asiacrypt’01, LNCS 2248, pp. 514–532. Springer, 2001.
12. R. Canetti, S. Halevi, J. Katz, A Forward Secure Public Key Encryption Scheme,
in Advances in Cryptology – Eurocrypt’03, LNCS 2656, pp. 254–271, Springer,
2003.
13. Y. Chui, K. Kobara, H. Imai, A Generic Conversion with Optimal Redundancy, in
Topics in Cryptology – CT-RSA’05, LNCS 3376, Springer, pp. 104–117, 2005.
14. C. Cocks, An Identity Based Encryption Scheme Based on Quadratic Residues, 8th
IMA International Conference, LNCS 2260, Springer, pp. 360-363, 2001.
15. J.-S. Coron. On the Exact Security of Full Domain Hash, in Advances in Cryptology
– Crypto’00, LNCS 1880, pp. 229–235, 2000.
16. J.-S. Coron, H. Handschuh, M. Joye, P. Paillier, D. Pointcheval, C. Tymen, GEM:
a Generic Chosen-Ciphertext Secure Encryption Method, in Topics in Cryptology
– CT-RSA’02, LNCS 2271, pp. 263–276, Springer, 2002.
17. R. Cramer, V. Shoup, Design and analysis of practical public-key encryption
schemes secure against adaptive chosen ciphertext attack, in SIAM Journal of Com-
puting 33:167-226, 2003.
18. A. Dent, A Designer’s Guide to KEMs, in Cryptography and Coding, 9th IMA
International Conference, pp. 133–151, Springer, 2003.
19. T. El Gamal, A Public Key Cryptosystem and a Signature Scheme Based on Dis-
crete Logarithms , Advances in Cryptology – Crypto’84, LNCS 0196, pp. 10–18,
Springer, 1984.
20. P.A. Fouque, D. Pointcheval, Threshold Cryptosystems Secure against Chosen-
Ciphertext Attacks, Advances in Cryptology – Asiacrypt’01, LNCS 2248, Springer,
pp. 351–368, 2001.
21. E. Fujisaki, Plaintext Simulatability, Cryptology ePrint Archive Report, available
from http://eprint.iacr.org/2004/218.
300
Benoˆıt Libert and Jean-Jacques Quisquater
22. E. Fujisaki, T. Okamoto, How to Enhance the Security of Public-Key Encryption
at Minimum Cost, in proc. of PKC’99, LNCS 1560, pp. 53–68. Springer, 1999.
23. E. Fujisaki and T. Okamoto, Secure integration of asymmetric and symmetric en-
cryption schemes, in Advances in Cryptology – Crypto’99, LNCS 1666, pp. 537–
554. Springer, 1999.
24. D. Galindo, The Exact Security of Pairing Based Encryption and Signature
Schemes, talk at INRIA Workshop on Provable Security, 2004.
25. S. Halevi, P. Rogaway, A tweakable enciphering mode, in Advances in Cryptology
– Crypto’03, LNCS 2729, pp. 482–499, Springer, 2003.
26. S. Halevi, P. Rogaway, A parallelizable enciphering mode, in Topics in Cryptology
– CT-RSA’04, LNCS 2964, pp. 292–304, Springer, 2004
27. J. Katz, N. Wang, Eﬃciency improvements for signature schemes with tight se-
curity reductions, in 10th ACM Conference on Computer and Communications
Security, pp. 155–164, 2003.
28. K. Kurosawa, T. Matsuo, How to Remove MAC from DHIES, in proc. of ACISP
2004, LNCS 3108, pp. 236–247, Springer, 2004.
29. T. Okamoto, D. Pointcheval, REACT: Rapid Enhanced-Security Asymmetric Cryp-
tosystem Transform, in Topics in Cryptology – CT-RSA’01, LNCS 2020, pp. 159–
174, Springer, 2001.
30. T. Okamoto, D. Pointcheval, The Gap-Problems: A New Class of Problems for the
Security of Cryptographic Schemes, in proc. of PKC’01, LNCS 1992, pp. 104–118,
Springer, 2001.
31. D.H. Phan, D. Pointcheval, Chosen-Ciphertext Security without Redundancy, in
Advances in Cryptology – Asiacrypt’03, LNCS 2894, pp. 1–18, Springer, 2003.
32. D.H. Phan, D. Pointcheval, About the Security of Ciphers (Semantic Security and
Pseudo-Random Permutations), Selected Areas in Cryptography (SAC’04), pp.
185–200, LNCS 3357, Springer, 2005.
33. D.H. Phan, D. Pointcheval, OAEP 3-Round: A Generic and Secure Asymmetric
Encryption Padding, in Advances in Cryptology – Asiacrypt’04, LNCS 3329, pp.
63–78, Springer, 2004.
34. C. Rackoﬀ, D. Simon, Non-interactive zero-knowledge proof of knowledge and cho-
sen ciphertext attack, in Advances in Cryptology – Crypto’91, LNCS 576, Springer,
pp. 433–444, 1991.
35. A. Shamir, Identity Based Cryptosystems and Signature Schemes, in Advances in
Cryptology – Crypto’ 84, LNCS 196, pp. 47-53, Springer, 1984.
36. V. Shoup, A proposal for the ISO standard for public-key encryption (version 2.1),
manuscript available from http://shoup.net/, 2001.