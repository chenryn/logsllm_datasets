Entry point to all systems connected to V2X infrastructure
Manipulation of traﬃc control systems: lights, bridges
Public transportation
Tolling and ﬁnancial systems
DSRC interface acts as entry point to onboard systems
Wireless access to vehicle control BUS
Transport malware across traﬃcked borders
Privilege escalation in PKI
Hijacking emergency vehicle authority
Certiﬁcate revocation via RSU
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
26 / 48
Understanding the Adversary: Passive
Determine trajectory of cars within some radius
Few stations required to monitor a typical highway
Enumerate services provided by peers
Characterize network traﬃc patterns within regions
Uniquely ﬁngerprint network participants independent of PKI
RF signature
Probe responses
Behavior patterns
Perform arbitrage on economic markets
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
27 / 48
Understanding the Adversary: Active
Denial of service, MITM
Impersonate infrastructure point
Manipulate misbehavior reports
Disrupt vehicle traﬃc
Target speciﬁc platforms and individuals
Economic warfare: manipulation of supply/distribution networks
Behavior modeling and manipulation
Privilege escalation in VANET
Parade as an emergency vehicle or moving toll station
Ad hoc PKI for application-layer services
Assume vehicle control via platooning service
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
28 / 48
V2X Threat Model: Applied
Network traﬃc can be corrupted over-the-air
Ad hoc PKI can allow certiﬁcate hijacking
Diagnostic services in DSRC implementation expose vehicle control
network
Valid DSRC messages can pass malicious instructions to infotainment
BUS
Fingerprinting possible regardless of PKI pseudonym scheme
Trust management services vulnerable to manipulation
Misbehavior reporting
Certiﬁcate revocation
Denial of P2P certiﬁcate distribution
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
29 / 48
Our Solution: Just Use Linux
Platform-independent* V2X stack integrated in mainline Linux kernel
No proprietary DSRC hardware/software required - uses COTS hw
Extensible in generic Linux environment
*Currently supports ath9k
Implements 802.11p, IEEE 1609.{3,4} in Linux networking subsystem
mac80211, cfg80211, nl80211
1609 module to route WSMP frames
Underlying 802.11 architecture compatible with Linux networking
subsystem
Mainline kernel integration leads to immediate global deployment
This enables rapid driver integration
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
30 / 48
SocketV2V: Implementing 802.11p in Linux Kernel
Add driver support for
ITS 5.825-5.925GHz
band
Deﬁne ITS 5.8-5.9GHz
channels
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
31 / 48
SocketV2V: Implementing 802.11p in Linux Kernel
Modify kernel
and userspace
local regulatory
domain
Force use of
user-speciﬁed regulatory
domain
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
32 / 48
SocketV2V: Implementing 802.11p in Linux Kernel
Enable ﬁltering
for 802.11p
frames
Require use of
wildcard BSSID
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
33 / 48
SocketV2V: Userspace Utility Modiﬁcations for 802.11p
Add iw command
for joining 5GHz
ITS channels
using OCB
Add iw
deﬁnitions for
5/10MHz-width
channels in OCB
Use iw to join
ITS spectrum
with COTS WiFi
hardware!
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
34 / 48
SocketV2V: Implementing WAVE in Linux
Functions to pack, parse, and broadcast messages
Relevant data structures
WSM, WSA, WRA, SII, CII, IEX
Full control of ﬁelds
subtype, TPID, PSID, chan, tx power, data rate, location, etc.
Operating modes for setting degree of compliance to standard (strict,
lax, loose)
Channel switching, dispatch
Netlink socket interface to userspace
Userspace link to the 802.11p kernel routines
Manage channel switching using iw
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
35 / 48
WAVE Usage
Message ﬁelds set in struct wsmp wsm
WSMs encoded to bitstream through wsmp wsm encode
WSM bitstream decoded through wsmp wsm decode
Functions for generating random WSMP frames to speciﬁed
compliance
Opens socket to 802.11p wireless interface
Inject WSMs with preﬁx EtherType 0x86DC
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
36 / 48
WAVE Structs: WSM
WAVE Short
Message:
message
encapsulation
and forwarding
parameters
(N-hop, ﬂooding)
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
37 / 48
WAVE Structs: IEX
Information
Element
Extension:
optional ﬁelds for
RF, routing, and
services
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
38 / 48
(More) WAVE Structs
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
39 / 48
SocketV2V: Implementing J2735
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
40 / 48
SocketV2V: Implementing J2735
Generate WSM
Pack J2735 msg in
WSM data element
Serialize WSM
Tx using
pcap inject!
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
41 / 48
SocketV2V: Implementing J2735
Wireshark WSMP plugin incomplete per current 1609 encoding
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
42 / 48
SocketV2V: Implementing J2735
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
43 / 48
Future Pwning of ITS: You Wanna be a Master?
Level 1: Denial of Service
Single-antenna DSRC systems susceptible to collision attack
Level 2: DSRC spectrum sweep, enumerate proprietary (custom)
services available per participant
Level 3: Impersonate an emergency vehicle
Level 4: Become mobile tollbooth
Level 1337: Remotely execute platooning service
Assume direct control
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
44 / 48
Additional Forms of Pwning
Pandora’s box:
Mass dissemination of malware
Passive surveillance with
minimal e↵ort
Extract RF parameters for
imaging
Reverse engineer system
architectures given enough data
Epidemic propagation model
Built in protocol switching
Exﬁltration over comm
bridges!
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
45 / 48
Developing Connected Vehicle Technologies
Widespread access enables engagement of security (1337) community
in standards development
Interact with existing V2X infrastructure
Pressure manufacturers and OEMs to implement functional V2V
Deploy ahead of market - experimental platforms
UAS, maritime, orbital, heavy vehicles
Opportunity for empirical research: See what you can break
Straightforward to wardrive
Hook DIY radio (Pi Zero with 5GHz USB adapter) into CANBUS (for
science ONLY)
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
46 / 48
Acknowledgments
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
47 / 48
References
Check me out on GitHub: https://github.com/p3n3troot0r/socketV2V
Estimated Beneﬁts of Connected Vehicle Applications – Dynamic Mobility
Applications, AERIS, V2I Safety, and Road Weather Management Applications –
U.S. Department of Transportation, 2015
Vehicle-to-Vehicle Communications: Readiness of V2V Technology for Application
– U.S. Department of Transportation, National Highway Traﬃc Safety
Administration, 2014
William Whyte, Jonathan Petit, Virendra Kumar, John Moring and Richard Roy,
”Threat and Countermeasures Analysis for WAVE Service Advertisement,” IEEE
18th International Conference on Intelligent Transportation Systems, 2015
E. Donato, E. Madeira and L. Villas, ”Impact of desynchronization problem in
1609.4/WAVE multi-channel operation,” 2015 7th International Conference on
New Technologies, Mobility and Security (NTMS), Paris, 2015, pp. 1-5.
Papernot, Nicolas, et al. ”Practical black-box attacks against deep learning systems
using adversarial examples.”
p3n3troot0r, ginsback
DEFCON: V2X
DEFCON 25: July 29, 2017
48 / 48