MEATPISTOL
A Modular Malware Implant Framework
Presened by: @ceyxies and @fzzynop
Biographical Summary:
?
HERE TO TALK ABOUT—
A GUN MADE OF MEAT 
...THAT SHOOTS MALWARE BULLETS?
This is a tool for...
RED TEAM
You mean "Pentesting?"
"Fundamentally a framework for creating, 
managing, and interacting with stealth implants 
that support persistent adversarial operations" 
Red Team Operating Paradigm
Scope: any sysems, hmans, or processes employed by he company #Yoloscope
We choose he arges, se he rles of engagemen, we se as mch ime as necessary  
#NoScopeBias
Seal sff for real, inciden responders rea s like we are real, ry no o ge cagh, ry o 
win by any means necessary 
Read o or resls o large adiences, branded operaions, craf propaganda
Have an impac.
Origin Story.
New Job, who dis?
“Hey go hack sff”
“case an impac”
“Don’ ge cagh”
“Go shell ye?”
fine.
Js ge some malware and SE my arge o rn i.
Ooops.
 All the decent 
malware was for 
windows.
my_first_malware.jpg
Snail—
 Pyhon Based Reverse SSH Tnneling Tool
 Used wier for C2 resolion based on a lexicon
 Cronab or LanchDaemon persisence
 Random schedling
 Obfscaed
 Generaor scrip
Worked Good
For like a year.
Problems
Ble Team—
does no like geing wrecked by pyhon
Problems
Ble Team wries specific deecions for Red Team
Problems
Aribion of Red Team ges really good.
Problems
Abiliy o be a good Boogeyman goes down.
Problems
And we have a bnch of spaghei code.
Time to iterate, write new malware
Trles: 
Flly implemened SSH clien and server wrien in java
Rio:
Anoher SSH reverse nneling ool wrien flly in bash
So great!
New malware, 
new tricks
DJ KHALED WE 
DA BESSSSS
But, the status quo was...
We ended p rewriing malware each ime we waned somehing new
We had o sand p all or own C2 each ime
We had o manage and configre all or C2 
We had o manage all or keys and cerificaes for or C2
I ook ime and effor, and a lo of i 
AND...
I’s prone o errors:
Accidenally resed a C2… which go s aribed
Accidenally conneced o C2 from he wrong place
Broken shells and broken dreams
Shell dies and never comes back
Used he same cer across mliple C2s
THIS WAS PAINFUL
Unreliable
Impossible o mainain
Impossible o rly ierae
Really hard o add feares
Plus we still have spaghetti code
Wouldn’t it be nice if...
You didn't have to write things 
from scratch every time...
And cutting a new malware implant 
took seconds?
And you could pick the features 
you wanted for that implant...
and C2 server infrastructure 
spinup happened automagically...
...and each sample was unique...
...and each C2 endpoint was unique
...and you didn’t have to manage 
keys for each C2 server...
Wouldn’t it be nice if the malware 
was just super fugging awesome!
So that's what we built.
Core
Core
Essentially a Microkernel
Core
Core
Event 
Loop
Execution
Core
Event 
Loop
Scheduler 
Loop
Execution
Execution
Core
Event 
Loop
Scheduler 
Loop
Execution
Execution
Job: Provide he mechanism o commnicae o he C2
I’m Mr. C2 Module
Core
Event 
Loop
Scheduler 
Loop
Execution
Execution
Modles regiser wih he core on sarp.
LOOK AT MEEEE!!!
Core
Event 
Loop
Scheduler 
Loop
Execution
Execution
I’ll lisen for C2_CONNECT and C2_DISCONNECT evens.
If yo wan o change he sae of connecion o he 
meapisol nework hen rigger he relevan even.
CAAAN DOO!
Core
Event 
Loop
Scheduler 
Loop
Execution
Execution
C2
Core
Event 
Loop
Scheduler 
Loop
Execution
Execution
C2
Persistence
Core
Event 
Loop
Scheduler 
Loop
Execution
Execution
File
C2
Persistence
Core
C2
Loot
Event 
Loop
Scheduler 
Loop
Execution
Execution
File
Persistence
Core
Exec
C2
Loot
Event 
Loop
Scheduler 
Loop
Execution
Execution
File
Persistence
Core
Exec
C2
Hide
Loot
Event 
Loop
Scheduler 
Loop
Execution
Execution
File
Persistence
Core
Event 
Loop
Scheduler 
Loop
Execution
Execution
How does 
everything 
communicate?
Client to Client
Uni-directional
Persistent
Many Reader
Many Writer
Read()
Write()
Attach()
Detach()
Close()
CHANNEL
NETWORK 
ARCHITECTURE
DEMO TIME
AND POST.
ALPHA AF
Malware implant creation used to take days. 
Now it takes seconds.
Weeks off our operation time.
 ... once you get locked into a serious malware 
collection, the tendency is to push it as far as you can.
The best way to increase the arsenal?
Share it.
… or not.
Ok. you are probably wondering 
about the name.  
Meapisol
Enhralls
A ngry
Tyrans
P roposing
I nimae
Sexy-imes
Teasing
Oligarch
Llamas
Marginally
Erec
A lpacas
Tacically
P rsing
I nernaional
Slave
Trading
Oligarch
Llamas
Modlar
Embedded
A dversary
Tooling
P
I
S
T
O
L
laform
It's natural to want to compare...
PEOPLE ASK US:
How's this different than metasploit?
PEOPLE ASK US:
Is this the same as Cobalt Strike?
PEOPLE ASK US:
But did you hear about Empire Project?
PEOPLE ASK US:
They dumped fuzzbunch isn't that the same?
MEATPISTOL is not an exploit database.   
MEATPISTOL is not click to win.
MEATPISTOL is not a post exploitation agent.
MEATPISTOL is not a bag of cool tricks.
MEATPISTOL is a MEAT CANNON THAT SHOOTS 
OUT MALWARE IMPLANTS
MEATPISTOL is a framework for Red Teams to 
create better implants.
MEATPISTOL is multi-user implant 
management and interaction portal
MEATPISTOL is 
an offensive infrastructure automation tool
MEATPISTOL is something that has saved us a 
lot of time and pain.
Now it’s yours.
#SOON
THANK YOU
Questions?
SKURRT SKURRRT Good Sir.