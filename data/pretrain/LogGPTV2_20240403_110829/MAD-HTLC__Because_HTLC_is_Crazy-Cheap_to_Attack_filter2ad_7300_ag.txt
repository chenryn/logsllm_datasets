University, 2014.
[54] B. D. Bernheim, “Rationalizable strategic behavior,” Econometrica:
Journal of the Econometric Society, 1984.
[55] M. Khabbazian, T. Nadahalli, and R. Wattenhofer, “Timelocked brib-
ing.”
[56] D. Robinson and G. Konstantopoulos.
(2020) Ethereum is a
dark forest. [Online]. Available: https://medium.com/@danrobinson/
ethereum-is-a-dark-forest-ecc5f0505dff
[57] K. Malinova and A. Park, “Market design with blockchain technology,”
Available at SSRN 2785626, 2017.
[58] Y. Doweck and I. Eyal, “Multi-party timed commitments,” 2020.
[59] S. Eskandari, S. Moosavi, and J. Clark, “Sok: Transparent dishonesty:
front-running attacks on blockchain,” 2019.
[60] L. Zhou, K. Qin, C. F. Torres, D. V. Le, and A. Gervais, “High-
frequency trading on decentralized on-chain exchanges,” arXiv preprint
arXiv:2009.14021, 2020.
[61] A. Munro.
r1
as
[Online]. Avail-
https://www.ﬁnder.com.au/fomo3d-ethereum-ponzi-game-r1-
Fomo3d
outmaneuvers
ethereum ponzi
ends
able:
ends-as-hot-play-outmaneuvers-bots
(2018)
play
game
bots.
hot
[62] I. Bentov, Y. Ji, F. Zhang, L. Breidenbach, P. Daian, and A. Juels,
“Tesseract: Real-time cryptocurrency exchange using trusted hard-
ware,” in Proceedings of the 2019 ACM CCS, 2019.
[63] J. Prestwich, “Miners aren’t your friends,” 2018. [Online]. Available:
https://blog.keep.network/miners-arent-your-friends-cde9b6e0e9ac
[64] I. Tsabary and I. Eyal, “The gap game,” in ACM CCS, 2018.
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:31:06 UTC from IEEE Xplore.  Restrictions apply. 
1244
[65] J. Sliwinski and R. Wattenhofer, “Blockchains cannot rely on honesty.”
[66] M. Carlsten, H. Kalodner, S. M. Weinberg, and A. Narayanan, “On the
instability of bitcoin without the block reward,” in Proceedings of the
2016 ACM CCS, 2016.
[67] I. Tsabary, A. Spiegelman, and I. Eyal, “Heb: Hybrid expenditure
blockchain,” arXiv, 2019.
[68] D. Easley, M. O’Hara, and S. Basu, “From mining to markets: The
evolution of bitcoin transaction fees,” Journal of Financial Economics,
2019.
[69] R. Khalil and A. Gervais, “Revive: Rebalancing off-blockchain pay-
ment networks,” in Proceedings of the 2017 ACM CCS, 2017.
[70] L. Gudgeon, P. Moreno-Sanchez, S. Roos, P. McCorry, and A. Gervais,
“Sok: Off the chain transactions.” IACR ePrint, 2019.
[71] L. Aumayr, O. Ersoy, A. Erwig, S. Faust, K. Host´akov´a, M. Maffei,
P. Moreno-Sanchez, and S. Riahi, “Generalized bitcoin-compatible
channels.”
[72] Blockstream. (2020) Blockstream lightning implementation. [Online].
Available: https://blockstream.com/lightning/
[73] L. Labs. (2020) Lightning labs lightning implementation. [Online].
Available: https://lightning.engineering/
[74] ——. (2020) Acinq lightning implementation. [Online]. Available:
[75] Raiden.
(2020) Raiden
network.
[Online]. Available:
https:
https://acinq.co/
//raiden.network/
[76] O. Network, “Omg network blockchain design.” [Online]. Available:
https://docs.omg.network/blockchain-design
[77] G. Avarikioti, O. S. T. Litos, and R. Wattenhofer, “Cerberus channels:
Incentivizing watchtowers for bitcoin,” Financial Cryptography and
Data Security (FC), 2020.
[78] P. McCorry, S. Bakshi, I. Bentov, S. Meiklejohn, and A. Miller, “Pisa:
Arbitration outsourcing for state channels,” in Proceedings of ACM
AFT, 2019.
[79] M. Khabbazian, T. Nadahalli, and R. Wattenhofer, “Outpost: A respon-
sive lightweight watchtower,” in Proceedings of ACM AFT, 2019.
[80] E. Wagner, A. V¨olker, F. Fuhrmann, R. Matzutt, and K. Wehrle,
“Dispute resolution for smart contract-based two-party protocols,” in
IEEE ICBC, 2019.
[81] C. Badertscher, U. Maurer, D. Tschudi, and V. Zikas, “Bitcoin as a
transaction ledger: A composable treatment,” in Annual International
Cryptology Conference, 2017.
[82] S. Goldwasser, S. Micali, and R. L. Rivest, “A digital signature scheme
secure against adaptive chosen-message attacks,” SIAM Journal on
computing, 1988.
[83] P. Rogaway and T. Shrimpton, “Cryptographic hash-function basics:
Deﬁnitions,
implications, and separations for preimage resistance,
second-preimage resistance, and collision resistance,” in International
workshop on fast software encryption, 2004.
[84] S. Dziembowski, L. Eckey, and S. Faust, “Fairswap: How to fairly
exchange digital goods,” in ACM CCS, 2018.
[85] I. Eyal and E. G. Sirer, “Majority is not enough: Bitcoin mining is
vulnerable,” in Financial Cryptography and Data Security, 2014.
[86] A. Sapirshtein, Y. Sompolinsky, and A. Zohar, “Optimal selﬁsh mining
strategies in Bitcoin,” in FC, 2016.
[87] blockchain.info, “Bitcoin mining pools.” [Online]. Available: https:
//blockchain.info/pools
[88] andes, “Bitcoin’s kryptonite: The 51% attack.” June 2011. [Online].
Available: https://bitcointalk.org/index.php?topic=12435
[89] M. Mirkin, Y. Ji, J. Pang, A. Klages-Mundt, I. Eyal, and A. Juels,
“Bdos: Blockchain denial-of-service,” in ACM CCS, 2020.
[90] J. A. Garay, A. Kiayias, and N. Leonardos, “The Bitcoin backbone
protocol: Analysis and applications,” in Advances in Cryptology -
EUROCRYPT 2015 - 34th Annual International Conference on the
Theory and Applications of Cryptographic Techniques, 2015.
[91] R. Pass, L. Seeman, and A. Shelat, “Analysis of the blockchain protocol
in asynchronous networks,” in Annual International Conference on the
Theory and Applications of Cryptographic Techniques, 2017.
[92] L. Kiffer, R. Rajaraman, and A. Shelat, “A better method to analyze
blockchain consistency,” in Proceedings of the 2018 ACM CCS, 2018.
transaction count.” [Online]. Available:
[93] blockchain.info, “Mempool
https://blockchain.info/charts/mempool-count
[94] R. Lavi, O. Sattath, and A. Zohar, “Redesigning bitcoin’s fee market,”
in The World Wide Web Conference, 2019.
[95] I. Tsabary, M. Yechieli, and I. Eyal, “Mad-htlc: because htlc is crazy-
cheap to attack (extended version),” arXiv:2006.12031, 2020.
[96] A. Kiayias, H.-S. Zhou, and V. Zikas, “Fair and robust multi-party
computation using a global transaction ledger,” in Annual Interna-
tional Conference on the Theory and Applications of Cryptographic
Techniques, 2016.
[97] R. Cheng, F. Zhang, J. Kos, W. He, N. Hynes, N. Johnson, A. Juels,
A. Miller, and D. Song, “Ekiden: A platform for conﬁdentiality-
preserving, trustworthy, and performant smart contracts,” in 2019 IEEE
EuroS&P, 2019.
[98] A. Kiayias and O. S. T. Litos, “A composable security treatment of the
lightning network,” in 2020 IEEE 33rd Computer Security Foundations
Symposium (CSF), 2020.
[99] L. Luu, D.-H. Chu, H. Olickel, P. Saxena, and A. Hobor, “Making
smart contracts smarter,” in Proceedings of the 2016 ACM CCS, 2016.
[100] M. Wohrer and U. Zdun, “Smart contracts: security patterns in the
ethereum ecosystem and solidity,” in 2018 International Workshop on
Blockchain Oriented Software Engineering (IWBOSE), 2018.
[101] Y. Huang, Y. Bian, R. Li, J. L. Zhao, and P. Shi, “Smart contract
security: A software lifecycle perspective,” IEEE Access, 2019.
[102] E. Zhou, S. Hua, B. Pi, J. Sun, Y. Nomura, K. Yamashita, and
H. Kurihara, “Security assurance for smart contract,” in 2018 9th IFIP
International Conference on New Technologies, Mobility and Security
(NTMS), 2018.
[103] K. Delmolino, M. Arnett, A. Kosba, A. Miller, and E. Shi, “Step
by step towards creating a safe smart contract: Lessons and insights
from a cryptocurrency lab,” in International conference on ﬁnancial
cryptography and data security, 2016.
[104] N. Atzei, M. Bartoletti, and T. Cimoli, “A survey of attacks on ethereum
smart contracts (sok),” in International conference on principles of
security and trust, 2017.
[105] I. Nikoli´c, A. Kolluri, I. Sergey, P. Saxena, and A. Hobor, “Finding the
greedy, prodigal, and suicidal contracts at scale,” in Proceedings of the
34th Annual Computer Security Applications Conference, 2018.
[106] L. Breidenbach, P. Daian, A. Jules, and E. G. Sirer, “An in-
the parity multisig bug,” 2017. [Online]. Available:
depth look at
https://hackingdistributed.com/2017/07/22/deep-dive-parity-bug/
[107] K. Bhargavan, A. Delignat-Lavaud, C. Fournet, A. Gollamudi,
G. Gonthier, N. Kobeissi, N. Kulatova, A. Rastogi, T. Sibut-Pinote,
N. Swamy et al., “Formal veriﬁcation of smart contracts: Short
paper,” in Proceedings of the 2016 ACM Workshop on Programming
Languages and Analysis for Security, 2016.
[108] R. Canetti, A. Jain, and A. Scafuro, “Practical uc security with a global
random oracle,” in Proceedings of the 2014 ACM CCS, 2014.
[109] J. Camenisch, M. Drijvers, T. Gagliardoni, A. Lehmann, and G. Neven,
“The wonderful world of global random oracles,” in Annual Interna-
tional Conference on the Theory and Applications of Cryptographic
Techniques, 2018.
[110] J.-F. Mertens and A. Neyman, “Stochastic games,” International Jour-
nal of Game Theory, 1981.
[111] Y. Shoham and K. Leyton-Brown, Multiagent systems: Algorithmic,
game-theoretic, and logical foundations, 2008.
[112] M. J. Osborne and A. Rubinstein, A course in game theory, 1994.
[113] E. Zermelo, “ ¨Uber eine anwendung der mengenlehre auf die theorie
des schachspiels,” in Proceedings of the ﬁfth international congress of
mathematicians, 1913.
[114] R. J. Aumann, “Backward induction and common knowledge of
rationality,” Games and Economic Behavior, 1995.
[115] M. M. Kami´nski, “Backward induction: Merits and ﬂaws,” Studies in
Logic, Grammar and Rhetoric, 2017.
[116] B. Core, “Bitcoin core.” [Online]. Available: https://bitcoin.org/en/
bitcoin-core/
[117] G. Ethereum, “Geth.” [Online]. Available: https://geth.ethereum.org/
[118] P. Wallet, “Parity.” [Online]. Available: https://www.parity.io/ethereum/
[119] E. S. Exchange, “Ethereum client
transaction ordering.” [Online].
https://ethereum.stackexchange.com/questions/6107/what-
Available:
is-the-default-ordering-of-transactions-during-mining-in-e-g-geth/
[120] G. Andresen. (2013) Bip 16 : Pay to script hash. [Online]. Available:
https://github.com/bitcoin/bips/blob/master/bip-0016.mediawiki
[121] P. W. Eric Lombrozo, Johnson Lau. (2017) Bip 141 : Segregated
[Online]. Available: https://github.com/
witness (consensus layer).
bitcoin/bips/blob/master/bip-0141.mediawiki
[122] blockchain.info, “Bitcoin transaction fees,” 2020. [Online]. Available:
https://www.blockchain.com/charts/mempool-state-by-fee-level
[Online]. Available:
(2020) Bitcoin
price.
[123] CoinDesk.
https:
//www.coindesk.com/price/bitcoin
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:31:06 UTC from IEEE Xplore.  Restrictions apply. 
1245
[124] E.
developer
[Online]. Available:
contracts/libraries/
documents.
(2020)
libraries.
https://ethereum.org/en/developers/docs/smart-
contract
Smart
[125] Liquality. (2020) Liquality btc-eth atomic swap, ethereum transaction.
[Online]. Available: shorturl.at/lpDP7
[126] N. Arnosti and S. M. Weinberg, “Bitcoin: A natural oligopoly,” arXiv
preprint arXiv:1811.08572, 2018.
[127] 1ml. (2020) Lightning top capacity channel. [Online]. Available:
https://1ml.com/channel/684407505443356673
[128] Blockstream.
capacity
transaction. [Online]. Available: shorturl.at/jwNO7
(2020) Lightning
top
channel
closing
[129] insight.litecore.
spend.
6c27cffab8a86f1b3be1ebe7acfbbbdcb82542c5cfe7880fcca60eab36747037
Available:
[Online].
Litecoin
swap
https://insight.litecore.io/tx/
atomic
(2017)
[130] Liquality.
(2020) Liquality atomic
swaps.
[Online]. Available:
https://liquality.io/swap/
[131] ——.
(2020)
Liquality
transaction.
bc1qhmjx0mk3p2trxe829lxgc9hwqjdzv0ueshmmgl7yfqdlnje45q4st7q9q8
[Online]. Available:
btc-eth
atomic
bitcoin
https://blockstream.info/address/
swap,
[132] S. Tikhomirov, P. Moreno-Sanchez, and M. Maffei, “A quantitative
analysis of security, anonymity and scalability for the lightning net-
work.” IACR Cryptol. ePrint Arch., 2020.
[133] A. Mizrahi and A. Zohar, “Congestion attacks in payment channel
networks,” arXiv preprint arXiv:2002.06564, 2020.
APPENDIX A
MAD-HTLC INCENTIVE COMPATIBILITY LEMMA PROOFS
This section presents the proofs for Lemma 4, Lemma 5
b
if
txdep
a
the game,
and either txdep
b
In the last round of
and Lemma 6. We recall the lemmas for readability.
Lemma (4).
i.e. sub-
game ΓMH (T,·),
are
published then miners’ best-response strategy is not to include
any of A’s or B’s transactions in this round.
Proof. Since A and B published their transactions, both prea
and preb are available to all miners. Therefore, any miner can
create a transaction redeeming MH-Dep and MH-Col herself.
If MH-Dep is irredeemable (cid:0)ΓMH (T, irred)(cid:1), then miners
or txdep+col
can create txcol
getting vcol tokens as reward. Alternatively, if txcol
b
they can include it in a block, getting a fee of f col
b
As f col
including txcol
as the MH-Dep is irredeemable.
m and redeem MH-Col themselves in round T ,
is published
tokens.
is strictly dominated by
m . In this case miners can also not include txdep
If MH-Dep is redeemable(cid:0)ΓMH (T, red)(cid:1), miners can also
including txcol
b
b < vcol,
create txdep+col
, include it in a block, and get vdep + vcol in
reward. Alternatively, they can include either txdep
, txcol
b
or txdep+col
(whichever was published). However, any of these
offers fees lower than vdep + vcol, making them strictly-
dominated by including txdep+col
a , txdep
m
a
.
b
b
m
Either way, including any of A’s or B’s transactions results
with a strictly lower reward, hence miners avoid doing so.
Lemma (5). In ΓMH (1, red), A cannot increase her utility by
deviating from the prescribed strategy.
Proof. First, if A does not know prea, she can take no action,
hence trivially complies with the prescribed strategy.
If A does know prea, then her possible deviations are not
at all, or publishing it only in the last round T .
Not publishing txdep
at all is strictly dominated — she gets
no tokens; if she instead abides by the prescribed strategy then
publishing txdep
a
a
b
b
a
a
dep
a
or txdep+col
she cannot get a lower revenue but can get more, e.g., if B
also follows the prescribed strategy (Lemma 2).
The inclusion of txdep
in the last block depends on what
transactions B publishes throughout the game (Lemma 4).
That is, if B published either txdep
then miners’
best-response is not to include txdep
a , and A gets no tokens.
Otherwise, miners’ best response is to include the transaction
that offers the highest fee, which can be either txdep
or
another, resulting with A receiving vdep − f
and 0 tokens,
respectively.
So, A cannot gain, and in several scenarios strictly lose, by
deviating from her prescribed strategy.
Lemma (6). In ΓMH (1, red), B cannot increase his utility by
deviating from the prescribed strategy.
Proof. Consider all of B’s possible actions. His potential
maximal utility is from having txdep+col
included, which he
obtains by following the prescribed strategy in the scenario
where A does not know prea (Lemma 3). So, he has no
incentive to deviate in this case.
Now, consider the case where A knows prea, hence accord-
ing to Lemma 5 publishes txdep