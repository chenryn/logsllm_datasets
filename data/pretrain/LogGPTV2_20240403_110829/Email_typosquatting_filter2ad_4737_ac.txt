ten in our corpus. The insight here is that true typo emails ought to
be unique, rare instances. We selected thresholds for these frequen-
cies based on the distribution of these features to include the most
common frequencies and to exclude outliers. We set the receiver
address frequency threshold to be 20, and both the sender address
and content thresholds to 10. Details of these distributions (which
motivate these thresholds) can be found in our online appendix.
Performance analysis. To ensure that our spam filtering performs
decently, we conducted small manual analysis of receiver typo
emails. We randomly selected 5 emails (collected between June 6 and
September 16, 2016) for each domain name where we expected to
423
IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
J. Szurdi and N. Christin
Figure 3: The number of receiver typo emails received daily
during our data collection. Emails are in three categories:
spam, auto and frequency filtered emails, and true typo
emails. The plot is not stacked, and is in logarithmic scale
on the y-axis.
Figure 4: The number of SMTP typo emails received daily
during our data collection. Emails are in three categories:
spam, auto and frequency filtered emails, and true typo
emails. The plot is not stacked, and is in logarithmic scale
on the y-axis.
receive receiver typo emails. One researcher analyzed the emails to
decide whether they are spam emails or not. In total, the researcher
labeled 77 emails and found that 80% of them were not spam emails.
(Detailed, per domain results can be found in the online Appendix.)
We additionally analyzed 26 emails that arrived by domains where
we did not expect to receive anything but SMTP typos, yet, were
classified as receiver typos by our system. 25 of these 26 emails
turned out to have been correctly identified as receiver typos.
4.4 Analysis
We next turn to the analysis of the emails our infrastructure col-
lected over more than seven months. In this entire discussion, we
report numbers projected over a full year. Indeed, there were minor
differences in data collection period for each domain (due, e.g., to
the infrastructure being partially overwhelmed on certain days), so
that we need to normalize all numbers to a common scale. Given
that the study was over seven months, we hypothesize that any
daily, weekly, monthly, and most seasonal effects are accounted
for in our collection. In short, when collect x emails, we report the
number y = x · 365/d where d is the number of days we actually
collected data for that domain.
4.4.1 Email volume. Figure 3 and 4 represent the total email
count, per day, we received during our collection, broken down
between receiver typos (Figure 3) and SMTP typos (Figure 4). Col-
lection gaps correspond to times during which our infrastructure
was malfunctioning (in particular due to being overwhelmed with
spam, and crashing as a result, with little hopes of recovering two
months worth of data). We receive SMTP typo emails sparsely
in small batches which perfectly characterizes what we expected.
Users rarely make SMTP typo mistakes and when they do, then
they quickly recognize the error and correct it. On the other hand,
receiver typos occur with a near-constant rate.
Projecting from the seven months of data collection, our infras-
tructure receives 118,894,960 emails per year. Based on the email
header, 16,233,730 are candidates to be receiver or reflection typo
emails and 102,661,230 are candidates to be SMTP typo emails.
However, most of these emails turn out to be spam—only 7,260
emails per year pass all of our filters. Correcting, based on our
manual analysis, would bring that number further down to 6,041
emails/year being either receiver or reflection typos.
For SMTP typo candidates we found that 5,147 emails/year are
sent to us by automated agents; 5,555 of the candidate SMTP ty-
pos emails per year are frequency filtered and 415 are not. How-
ever SMTP typos, by their very nature, may lead a single user to
send large amounts of email (if only for a short time), which could
lead frequency filtering to produce false positives. Hence we esti-
mate our infrastructure receives between 415 and 5,970 SMTP typo
emails/year.
Surprisingly to us, we received a non-negligible number of re-
ceiver typo emails (over 700 emails/year) to domains that we had
specifically designed to catch SMTP typing mistakes (for instance,
mx4hotmail.com). These emails do not appear to be spam (as dis-
cussed above, we looked into 26 of them), but we are not sure what
is causing this behavior.
4.4.2 Per-domain analysis. We next turn to discussing whether
some domains receive more typos than others, and why.
A small fraction of domains received most of the receiver
typos. Out of the 31 domains registered to collect receiver typo
emails, 27 domains targeted email providers, excluding temporarily
email address providers (10minutemail.com and yopmail.com) or
bulk email sending services (sendgrid.com and mailchimp.com).
Figure 5 shows that out of these 27 domains only two domains re-
ceived the majority of the total receiver typo emails and 12 domains
received 99% of all emails. This finding reinforces our intuition that
some typosquatting domains are orders of magnitude better than
others.
SMTP typos are infrequent compared to receiver typos. We
receive an order of magnitude less SMTP typo emails than receiver
424
10010110210310410516/06/0116/07/0116/08/0116/09/0116/10/0116/11/0116/12/0117/01/01Date (y/m/d)Log Number of emails received on a given dayFiltering stepsSpam filteredReflecion and frequency filteredReal email typos10010210410616/06/0116/07/0116/08/0116/09/0116/10/0116/11/0116/12/0117/01/01Date (y/m/d)Log Number of emails received on a given dayFiltering stepsSpam filteredReflecion and frequency filteredReal email typosEmail Typosquatting
IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
Figure 5: Cumulative sum of emails received by our ty-
posquatting domains.
typo emails. So, SMTP typosquatting has questionable profitability,
compared to what receiver and reflection typo mistakes could offer.
However, there is no harm, to the typosquatter, in simply collecting
these emails on domains they would have already registered.
We define as the persistence of an SMTP typo for a given user the
time difference between the first and last email received from that
particular user. For 70% of our users, we received only one email due
to a SMTP typo mistake, so that the persistence is undefined (i.e.,
taken to be equal to zero by convention). 83% of SMTP typos lasted
less than a day and 90% less than a week. The maximum persistence
was 209 days. When an SMTP typo persisted for this long it can
be for one of two reasons: the same user made the same mistake
several times, or these emails were spam our filtering system did
not catch. 90% of SMTP mistakes caused the users to send four
or less emails to our servers. As discussed earlier, emails filtered
out during the frequency filtering step might include SMTP typo
mistakes; however without manual inspection of their content, we
cannot draw conclusions about these emails.
Visual distance, target popularity, and keyboard distances
are important features. Typosquatting domains targeting more
popular target domains (gmail.com, outlook.com, hotmail.com),
unsurprisingly receive significantly more receiver and reflection
typo emails. More interestingly, for a given target domain, FF-1
domains always receive the most emails if the typing mistake is not
totally obvious (evrizon.com, ohtlook.com and outlo0k.com). In
other words, visual distance seems more important than keyboard
distance. Figure 5 confirms that the top two domains are DL-1 and
FF-1 typos of two of the three most popular email providers, with
low visual distance from the real domain.
We only found a statistically significant correlation between the
popularity of the target domain and the number of reflection and
receiver typo domains received. This is not surprising since the
popularity of the target domain outweighs the other attributes, and
without an explanatory variable we cannot expect to see significant
correlation with other attributes of the target domain.
Figure 6: Heatmap of sensitive information of real typo
emails. The heatmap shows the frequency of a sensitive in-
formation type for a given typosquatting domain.
4.4.3 What does a typosquatter receive? Figure 6 shows among
the true typo emails which ones received what kind of sensitive
information. Unsurprisingly, yopmail.com typo domains to receive
a fair amount of usernames and password since their emails are
often used for temporary registration.
Figure 7: Frequency of extensions among true typo emails.
Attachment analysis. Figure 7 shows the attachment extensions’
distribution for all receiver typo emails we received. The distri-
butions of extensions for spam emails and true typo emails sig-
nificantly differ. Without filtering the emails we received have a
significantly higher proportion of file types that are easier to exploit
such as .doc, .docm, avi, .xls and .xlsm. (Recall we discard ZIP
and RAR files during our filtering process.)
Out of a randomly selected 109,151 unique file hashes we found
323 in the VirusTotal database [29]. 304 of the hashes were found
to be malicious and 17 were benign. All emails containing these
malicious attachments were categorized as spam by our filtering
system. (The benign hashes likely do not contain personal, sensitive
information since they have already been observed elsewhere in
the VirusTotal database.)
The dangers of reflection typos. We found that one particular
email address at zohomil.com received a lot of emails with CVs
and work search related subjects and attachments. It turns out
that somebody included a mistyped email address in various job
postings on multiple pages—a nasty variant of a reflection typo.
425
0.20.40.60.81.0ohtlook.comoutlo0k.comhovmail.comgmaiql.comoutmook.comho6mail.comouulook.comoetlook.comouvlook.como7tlook.comzohomil.comverizo0n.comcomcasu.comcomcas5.comcomaast.comcoicast.comou6look.comverhzon.comcomcawst.comcomca3t.comevrizon.comgmai−l.comve5izon.comvebizon.comvepizon.comvermzon.comzohomial.comSelected typosquatting domainsCumulative sum of receiver typo emails11831421128211131416dinersclubeinjcbmastercardpasswordusernamevingmaiql.como7tlook.comohtlook.comoutlo0k.comoutmook.comouulook.comyopail.comTypo domain namesSensitive information types51015value19980105211131833530711146964571161765100101102103104txtjpgpdfpngdocxxmlgifdocjpegxlsxxlsicshtmlpdf__docx__docmpptxrtfFile extensionsCounts (log10 scale)IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
J. Szurdi and N. Christin
Table 4: SMTP support of typosquatting domains
Support status
No MX or A record found
No info
No email supp.
Supp. email, no STARTTLS
Supp. STARTTLS with errors
Supp. STARTTLS w/o errors
Count
651,439
144,1725
28,3636
1,693
257,952
155,6773
% total % analyzed
23.7
10.3
0.1
9.4
56.6
-
15.5
34.4
6.8
0.0
6.2
37.1
5.2 Analysis
SMTP support for typosquatting domains . Table 4 shows SMTP
support for typosquatting domains. 22.3% of typosquatting domains
are not capable of receiving emails, 34.4% did not yield any infor-
mation, and 43.3% support SMTP.
5 THE EMAIL TYPOSQUATTING ECOSYSTEM
We complement the results from our experiment playing the role of
a typosquatter with a more “passive” analysis, in which we attempt
to estimate whether email typosquatting does occur in the wild,
and who the actors are.
5.1 Methodology
To gain an better understanding of the typosquatting ecosystem we
first looked at the set of ctypo domains registered in the wild. We
generated all possible DL-1 variations of Alexa’s top one million
domain on November 5, 2016 [1]. We considered the set of ctypo
domains, i.e., the domains that are actually registered, and collected
the MX and A records of these ctypo domain names, on November
7, 2016. The SMTP protocol specifies that, in absence of an MX
record, the A record of the domain name should be used as the
mail server’s address [23]. We clustered ctypos together based on
their DNS settings to see any evidence of concentration in the
typosquatters’ infrastructure. If there was no MX record found for
a domain name we used the corresponding IP address for clustering.
We further analyze whether these domains actually run an SMTP
server using data downloaded from zmap.io [10] on October 29,
2016. We checked the IP addresses obtained from requesting the
A record for those domains for which an MX record was found. If
there was no MX record, we used the A record directly.
We also attempted to collect WHOIS information for all ctypo
domains between December 22 2016 and January 24 2017. We used
PyWhois [4], and Ruby Whois [5] for querying and parsing WHOIS
information. While a lot of the information is probably fake, it
can nevertheless be useful in clustering domains by owners (e.g.,
while Mickey Mouse is unlikely to register typosquatting domains,
repeatedly seeing the name Mickey Mouse as a technical contact for
typosquatting domains might be evidence of common ownership).
More precisely, to cluster registrants of typosquatting domains
we use an approach similar to Halvorson et al. [20]. We use six
fields of the WHOIS record: registrant name, organization, email
address, phone number, fax number and mail address. We consider
two domain names to be registered by the same entity or group
of entities, if four of the six fields match. Naturally, this means we
cluster only domains for which at least four WHOIS fields were
available. Using a .com zone file, we find domain name servers that
serve a significantly higher proportion of typosquatting domains
than should be expected.
Figure 8: Cumulative sum of typosquatting domains by mail
servers and registrants. Mail servers and registrants are or-
dered by the number of domains served/owned, in decreas-
ing order.
Typosquatting registrants. Using the clustering technique de-
scribed above, Figure 8 shows the concentration among registrants
(excluding those protected by WHOIS proxy services) who filled
out at least four of their WHOIS registration fields. The x-axis is
the fraction of all registrants. The top 14 registrants own 20% of
typosquatting domains. A mere 2.3% of all of the registrants in
appear to own the majority of typosquatting domains. At the same
time, there is a heavy long tail for the ownership of the rest of the
domains.
Most of the registrants that operate a large number of typosquat-
ting domains have SMTP servers active on most of their domains.
The top three registrants are actually companies whose business
appears to be holding domain names for sale. While questionable,
this practice is not evidence of active malice. On the other hand,
many of the other registrants do not seem to focus on domain re-
sale, but do operate SMTP servers, which is suspicious. The online
appendix contains a list of the top typosquatting registrants.
Suspicious name servers. A number of name servers are used
by a significantly higher ratio of typosquatting domains compared
to benign domains. In general, the average ratio of typosquatting
domains over benign domains is about 4% – par for the course for
large organizations that may not be able to check very carefully
the activities of all of their customers. However, a number of name
servers far exceed that ratio, and can be viewed as catering to ty-
posquatters. The candidate typosquatting ratio of all .com domains
is as high as 89% for one such name server. Further adding to the
426
0.000.250.500.751.0010−610−510−410−310−210−1100Registrants/MX records (log scale)Cumulative Sum of Typo DomainsMail ServersRegistrantsEmail Typosquatting
IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
suspicion, half of these name servers are registered behind privacy
proxies, and a majority of their domains have active SMTP servers.
Full details can be found in the online appendix.
MX record concentration. As Figure 8 shows, not only do a lot
of typosquatting domains support mail, but many of them point to
only a few MX records. The top eleven SMTP servers handle mail
for more than one third of typosquatting domains and 51 for the
majority. Less than one percent of the SMTP servers supports more
than 74% of domains. In other words, a few providers might have
the chance to defend against (or be held responsible for, in case
they are colluding with the miscreants) potentially dangerous and
privacy invasive email typosquatting.