they are a reseller (.se). In an email discussion with a TransIP
 0 20 40 60 80 10005/1508/1511/1502/1605/1608/1611/16Percent of domains withDS and DNSKEY recordDate.com.net.org.nl 0 10000 20000 30000 40000 50000 60000 70000# of domains.com.net.org.nl 0 20 40 60 80 10005/1508/1511/1502/1605/1608/1611/16Percent of domains withDS and DNSKEY recordDate.com.net.org.se 0 20000 40000 60000 80000 100000 120000 140000# of domains.com.net.org.se 0 20 40 60 80 10005/1508/1511/1502/1605/1608/1611/16TransIP (*.transip.nl, *.transip.net)Percent of domainswith DNSKEY and DS recordDate.com.net.org.se.nl 0 20 40 60 80 100PCExtreme (*.pcextreme.nl).com.net.org.nlIMC ’17, November 1–3, 2017, London, United Kingdom
T. Chung et al.
administrator [6], we were informed that this is due to its registrar
for .se, KeySystems, which “enabled DNSSEC at a later date22.”
We suspect that the enabling of DNSSEC is only happening upon
domain renewal, similar to Antagonist above. Overall, these results
highlight the challenges for applying consistent DNSSEC policies
for registrars who are also resellers for some TLDs.
DS record validation
6.4
As we did in Section 5.3 for the popular registrars that support the
domain owner as the DNS operator, we tested whether the registrars
that have the largest number of DNSSEC domains validate uploaded
records. Surprisingly, we find that even among them only two (OVH
and PCExtreme) checked the correctness of our uploaded DS records.
In fact, we observe that PCExtreme takes a unique approach: a
domain owner can request to publish a DS record without sending
them a DNSKEY nor a DS record. Instead, PCExtreme then fetches
the DNSKEY records themselves from the authoritative nameserver
and generates the DS records. This approach represents a trade-off
between usability and security: it is less error-prone (to avoid the
owner having to generate and transmit the DS record), but opens
a window for an attacker to give PCExtreme an incorrect DNSKEY
record. Moreover, this approach only works when publishing the
first DS record. When a domain owner generates a new DNSKEY,
PCExtreme requests the new DNSKEY by email [30] (with similar
implications as for other registrars that use email-based DS uploads).
Of the four registrars that only use email to transmit DS records,
we found that only one of them verified the email (by asking for a
security “code” bound to the account). Two of the registrars did
not verify the email was authentic and simply uploaded the DS
record. Even worse, we found one registrar that accepted an up-
dated DS record for our test domain from a different email address
than the one we used to register the domain.23 We have reported
these vulnerabilities to the respective registrars with the hope that
they will change their internal processes to properly validate up-
dated DNSSEC records. Regardless, these examples demonstrate
the challenges that registrars face when trying to properly deploy
DNSSEC.
6.5 Summary
In summary, we observed that customers wishing to deploy DNSSEC
face challenges even when using the registrars that have the best
historic support for DNSSEC. Of the top 10 such registrars, most
support DNSSEC by default when they are the DNS operator, but
many only partially deploy DNSSEC (i.e., fail to upload DS records).
Worse, most of the registrars do not validate DS records uploaded
by the user, and fail to verify emails that request a new DS record
be published. Overall, these registrars should be lauded for their
support of DNSSEC, but could still improve their customer support
and processes to make it easier and more secure for customers to
support DNSSEC.
22Because KeySystems acts as a registrar and TransIP as a reseller
for .se domain, the financial incentive that the .se registry awards
will go to KeySystems.
23We used an address that was completely different from the name
we listed in the WHOIS information to send the DS record.
Figure 8: The percentage of Cloudflare-operated domains that
enabled DNSSEC (bottom) and the percentage of these domains
with DNSKEY that have a DS record as well (top). Roughly 40% of
Cloudflare-operated domains that attempt to deploy DNSSEC
fail to successfully do so. Note that the range of y-axis of the
bottom graph is between 0 to 1.2.
7 THIRD-PARTY DNS OPERATORS
Finally, we examine the two most popular third-party DNS operators:
DNSPod and Cloudflare, which are the DNS operators for 2,309,215
and 1,561,687 .com, .net, and .org domains, respectively. Recall
that the third-party operators are not registrars; instead the owner of
a domain contracts with these third-party operators to outsource the
management of their domain.
After setting up an account with both services, we find that only
Cloudflare supports DNSSEC. Cloudflare initially announced sup-
port for DNSSEC on November 11th, 2015 [5], but the domain
owners must opt-in to use DNSSEC. If the owner does so, Cloud-
flare will generate DNSKEYs and RRSIGs, and will provide the domain
owner with the DS record; the domain owner is responsible for com-
municating the DS record to their registrar for addition to the registry
(as Cloudflare does not have the authority to do so). As a result, if
a domain owner fails to properly convey the DS record, or if their
registrar does not support DNSSEC, they will fail to properly deploy
DNSSEC for their domain.
We find that only 29,537 (1.9%) of domains using Cloudflare
have a DNSKEY record in our latest snapshot (December 31st, 2016).
Interestingly, we also observe that 11,626 (39.3%) of these domains
do not have a DS record, suggesting that they failed to upload the
Cloudflare-provided DS record to their registrar.
To explore this further, Figure 8 shows the number of Cloudflare-
hosted domains with DNSKEYs (bottom) and the fraction of those that
also have DS records (top). We can immediately see the how this com-
plex procedure leads to poor overall deployment of DNSSEC. We
are able to observe a rapid increase in the percentage of Cloudflare
domains that have DNSKEYs once Cloudflare announced universal
DNSSEC. However, even today, 40% of the domain owners who
 0 0.2 0.4 0.6 0.8 1 1.205/1508/1511/1502/1605/1608/1611/16Percent of domainswith DNSKEY recordDate 0 20 40 60 80 100Cloudflare announceduniversal DNSSEC Percent of domainswith DS recordUnderstanding the Role of Registrars in DNSSEC Deployment
IMC ’17, November 1–3, 2017, London, United Kingdom
enabled DNSSEC at Cloudflare did not upload their DS record to
their registrar. Even worse, this portion has remained remarkably
stagnant as the number of domains with DNSKEYs has increased; we
observe that 38.7% of domains with DNSKEYs still do not have a DS
record in our latest snapshot (December 31st, 2016).
To help remedy this situation, Cloudflare supports the CDS and
CDNSKEY proposals [26, 46], which would enable Cloudfare to con-
vey the DS record to the registry themselves (i.e., avoiding the need
for the user to relay the DS record to the registrar, who relays it to the
registry). However, this proposal has seen very slow uptake, and we
know of only one registry (.cz) that has deployed it and one registry
(.ca) that is considering deploying it.
8 CONCLUDING DISCUSSION
We began this paper noting that the low level of adoption of DNSSEC
has been widely bemoaned, but relatively little appears to be chang-
ing. DNSSEC was originally proposed almost two decades ago, and
today most TLD registries support it. Unfortunately, less than 1% of
.com, .net, and .org second-level domains do, meaning very few
DNS responses provide the authenticity and integrity that DNSSEC
could in theory provide. Given the powerful attacks [25, 38], the
critical role that DNS plays, and society’s increasing reliance on
computing infrastructure, the poor deployment of DNSSEC remains
as a significant problem.
In this paper, our goal was to shed light on why DNSSEC adoption
remains so low. To do so, we took the perspective of a customer
and attempted to buy domains and deploy DNSSEC through 30
different registrars. We found the level of support for DNSSEC to be
highly skewed: only three of the top 20 registrars support DNSSEC
when they are the DNS operator, which is unfortunate as this is the
easiest situation for DNSSEC support. Moreover, only 11 of the 20
supported DNSSEC when the owner was the DNS operator, and the
processes for uploading DS records were error-prone (very few of the
registrars did any validation of uploaded data) and opened the door
to security attacks (most registrars that use email for transmittal of
DS records did not actually validate the email, and one even accepted
an email from a different address). Taken together, our results shine
a light on the difficulties that domain owners face when trying to
deploy DNSSEC.
Ethical Considerations Our measurements of the (in)security of
uploading DS records brings up a few ethical issues, and we wish
to discuss them explicitly before concluding. At all points, we took
steps to ensure our measurements met community ethical standards.
First, we note that we only tested uploading incorrect DS records for
the test domains that we bought from each registrar, thus our exper-
iment did not impact any other domains. Second, we responsibly
disclosed our findings to all of the registrars that have potential secu-
rity vulnerabilities that we found (e.g., not validating the authenticity
of incoming email or accepting different email address than the one
that registered) in order to help them mitigate the issues.
Recommendations Stepping back, our results indicate there are a
number of steps that the various DNS entities can take to spur greater
adoption of DNSSEC.
(1) Registrars play a critical role in supporting DNSSEC today,
but most do so poorly. Registrars should allow all customers
to enable DNSSEC if they wish, and should move towards a
standard of DNSSEC-by-default. Today, only one registrar
among the top 20 had this policy, and only did so for some of
their domains.
(2) Registries largely support DNSSEC, but we know that only
the .cz registry has recently announced support for CDS and
CDNSKEY [? ]. These proposals completely remove the friction
that customers face when trying to deploy DS records, as they
can effectively communicate directly with the registry. Un-
fortunately, we know of no other registries that support CDS
and CDNSKEY today, which is unfortunate given how many do-
mains we find have DNSKEYs deployed but fail to successfully
deploy a DS record.
(3) Until CDS and CDNSKEY are fully supported, registries should
work to make the process of uploading DS records easier and
more secure. Of the registrars we studied, PCExtreme has
the easiest and most secure approach, allowing a customer
to log in and request that the registrar fetch the customer’s
DNSKEYs and generate and deploy a DS record. This process
is much less error-prone than web-based uploads or emails,
but PCExtreme can further improve this by (a) showing the
customer the fetched DNSKEY so the customer can verify this
process was secure, and (b) allowing customers to switch to a
new key in a similar fashion as well.
(4) Certain TLD registries have employed small financial incen-
tives for registrars to deploy DNSSEC; these same TLDs have
seen dramatically higher levels of DNSSEC deployment. We
encourage other registries to do the same. For example, .se
offered a e0.28 discount per year off of the e3.40 price (an
8.2% discount); the .se registry observed that when they orig-
inally raised their discount from 2.5% to 5%, the number of
DNSSEC-signed domains jumped “literally overnight” [32].
Even this modest discount becomes significant at the scale
that many registrars operate; since a small number of reg-
istrars own much of the market, even changing just a few
registrars’ policies to support DNSSEC may lead to much
higher adoption.
9 ACKNOWLEDGEMENTS
We thank the anonymous reviewers and our shepherd, Mark Allman,
for their helpful comments. This research was supported in part by
NSF grants CNS-1564143 and CNS-1563320, and made possible by
OpenINTEL (https://www.openintel.nl/), a joint project of SURFnet,
the University of Twente, and SIDN.
REFERENCES
[1] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose.
DNS Security Introduction and Requirements. RFC 4033,
IETF, 2005. http://www.ietf.org/rfc/rfc4033.txt.
[2] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose.
Protocol Modifications for the DNS Security Extensions. RFC
4035, IETF, 2005. http://www.ietf.org/rfc/rfc4035.txt.
[3] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose.
Resource Records for the DNS Security Extensions. RFC 4034,
IETF, 2005. http://www.ietf.org/rfc/rfc4034.txt.
[4] APNIC DNSSEC validation rate. https://stats.labs.apnic.net/
dnssec.
IMC ’17, November 1–3, 2017, London, United Kingdom
T. Chung et al.
[30] Loek Geleijn, PCExtreme System Operations. Personal Com-
munication.
[31] P. Mockapetris. Domain Names - Concepts and Facilities. RFC
1034, IETF, 1987.
[32] R. Mohan.
ICANN 43.
at
slowly-cracking-dnssec-code-icann-43.
Slowly cracking the DNSSEC code
https://afilias.info/blogs/ram-mohan/
[33] Nameservers
and
DNSSEC.
by
support/knowledgebase/article.aspx/9718/2232/
nameservers-and-tlds-supportedunsupported-by-dnssec.
TLDs
supported/unsupported
https://www.namecheap.com/
[34] E. Osterweil, D. Massey, and L. Zhang. Deploying and mon-
itoring DNS security (DNSSEC). ACSAC, IEEE Computer
Society, 2009.
[35] E. Osterweil, M. Ryan, D. Massey, and L. Zhang. Quantifying
the operational status of the DNSSEC deployment. IMC, 2008.
[36] OpenINTEL. https://www.openintel.nl/.
[37] Report from the IAB workshop on Internet Technology
https://tools.ietf.org/id/
Adoption and Transition (ITAT).
draft-iab-itat-report-01.xml#rfc.section.3.3.
[38] S. Son and V. Shmatikov. The hitchhiker’s guide to DNS cache
poisoning. Security and Privacy in Communication Networks,
Springer, 2010.
[39] Z. Shelby. Constrained RESTful Environments (CoRE) Link
Format. RFC 6690, IETF, 2012.
[5] Announcing
Universal
Every Domain.
for
introducing-universal-dnssec.
DNSSEC:
DNS
https://blog.cloudflare.com/
Secure
[6] Arjan van den Berg, TransIP BV. Personal Communication.
[7] T. Chung, D. Choffnes, and A. Mislove. Tunneling for Trans-
parency: A Large-Scale Analysis of End-to-End Violations in
the Internet. IMC, 2016.
[8] T. Chung, R. van Rijswijk-Deij, B. Chandrasekaran, D.
Choffnes, D. Levin, B. M. Maggs, A. Mislove, and C. Wilson.
A Longitudinal, End-to-End View of the DNSSEC Ecosystem.
USENIX Security, 2017.
[9] M. Davids. DNSSEC in .nl. 2016. https://www.sidnlabs.nl/
downloads/presentations/SIDN-Labs-InternetNL-20160316.
pdf.
[10] T. Dai, H. Shulman, and M. Waidner. DNSSEC Misconfigura-
tions in Popular Domains. CANS, 2016.
[11] DNSSEC Debugger. http://dnssec-debugger.verisignlabs.com.
[12] DNSSEC Deployment Report. https://rick.eng.br/dnssecstat/.
[13] DNSSEC for Registrars.
https://www.cloudflare.com/dns/
dnssec/dnssec-for-registrars.
[14] DNSSEC signzone manual pages. https://ftp.isc.org/isc/bind9/
cur/9.9/doc/arm/man.dnssec-signzone.html.
[15] DNSViz. http://dnsviz.net.
[16] D. Eastlake. Domain Name System Security Extensions. IETF
RFC 2535, IETF, 1999.
Extensions. RFC 2065, IETF, 1997.
[18] A.-M. Eklund-Lowinder.
Sweden: How Do We Do It?
https://london50.icann.org/en/schedule/wed-dnssec/
presentation-dnssec-deployment-sweden-25jun14-en.pdf.
DNSSEC Deployment
in
ICANN50, 2014.
[19] A. Fant-Eldh and M. Kirvesniemi. Economical and Political
Implications of DNSSEC Deployment. Ph.D. Thesis, KTH
Information and Communication Technology, 2010.
and
[20] Getting
ben-
https://www.powerdns.com/resources/
efits.
BringingDNSSECtotheaccessproviders.pdf.
deployed:
DNSSEC
[21] Google DNS: DNSSEC Available to Test on Cloud DNS.
https://groups.google.com/forum/#!topic/cloud-dns-discuss/
WXNHtB9W0bg.
costs
[22] How to Sign and Secure Your Domain with DNSSEC Using
Domain Registrars. http://www.internetsociety.org/deploy360/
resources/dnssec-registrars/.
[23] ICANN TLD DNSSEC Report. http://stats.research.icann.org/
dns/tld report.
[24] Joris de Leeuw, Antagonist. Personal Communication.
[25] D. Kaminsky.
It’s the End of
Black Hat, 2008.
Know It.
com/presentations/bh-jp-08/bh-jp-08-Kaminsky/
BlackHat-Japan-08-Kaminsky-DNS08-BlackOps.pdf.
the Cache as We
https://www.blackhat.
[26] W. Kumari, O. Gudmundsson, and G. Barwood. Automating
DNSSEC Delegation Trust Maintenance. RFC 7344, IETF,
2014.
[27] J. Latour, O. Gudmundsson, P. Wouters, and M. Pounsett. Third
Party DNS operator to Registrars/Registries Protocol. IETF,
2017.
[28] S. Liu, I. Foster, S. Savage, G. M. Voelker, and L. K. Saul. Who
is. com? Learning to Parse WHOIS Records. IMC, 2015.
[29] W. Lian, E. Rescorla, H. Shacham, and Stefan. Measuring the
Practical Impact of DNSSEC Deploymenta. USENIX Security,
2013.
[17] D. Eastlake and C. Kaufman. Domain Name System Security
[40] State
of DNSSEC Deployment
2016.
https:
//www.internetsociety.org/sites/default/files/
ISOC-State-of-DNSSEC-Deployment-2016-v1.pdf.
[41] The DNS-Based Authentication of Named Entities (DANE)
Transport Layer Security (TLS) Protocol: TLSA. RFC 6698,
IETF, 2012. https://tools.ietf.org/html/rfc6698.
[42] A. Veenman.
SIDN extends DNSSEC discount until
July 1, 2018. 2014. https://www.ispam.nl/archives/38957/
sidn-verlengt-dnssec-kortingsregeling-tot-1-juli-2018/.
[43] N. L. M. van Adrichem, N. Blenn, A. R. Lua, X. Wang, M.
Wasif, F. Fatturrahman, and F. A. Kuipers. A measurement
study of DNSSEC misconfigurations. Sec. Info., 4(8), 2015.
[44] R. van Rijswijk-Deij, M. Jonker, and A. Sperotto. On the
Adoption of the Elliptic Curve Digital Signature Algorithm
(ECDSA) in DNSSEC. CNSM, 2016.
[45] R. van Rijswijk-Deij, M. Jonker, A. Sperotto, and A. Pras.
A High-Performance, Scalable Infrastructure for Large-Scale
Active DNS Measurements. IEEE Journal on Selected Areas
in Communications, 34(6), 2016.
[46] P. Wouters and O. Gudmundsson. Managing DS Records from
the Parent via CDS/CDNSKEY. RFC 8078, IETF, 2017.
[47] D. York. Challenges and Opportunities in Deploying DNSSEC:
A progress report on an investigation into DNSSEC deploy-
ment. SATIN, 2012.
[48] H. Yang, E. Osterweil, D. Massey, S. Lu, and L. Zhang. De-
ploying cryptography in Internet-scale systems: A case study
on DNSSEC. IEEE Transactions on Dependable and Secure
Computing, 8(5), 2011.
[49] Y. Yu, D. Wessels, M. Larson, and L. Zhang. Check-Repeat:
A New Method of Measuring DNSSEC Validating Resolvers.
TMA, 2013.