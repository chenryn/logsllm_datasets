User: 请回答以下安全问题防火墙阻止ICMP是个坏主意吗？这个问题的灵感来源于这个答案，该答案部分指出：
通用防火墙清单文件最后删除了我不允许的所有内容（除了ICMP。不要关闭ICMP）。
但是，防火墙允许ICMP真的是一个好的做法吗？有什么安全隐患？是否存在应该关闭ICMP的情况？

Assistant: 与其他IP协议相比，ICMP相当小，但它确实提供了大量不同的功能。其核心ICMP被设计为IP的调试、故障排除和错误报告机制。这让它变得非常有价值，所以需要花很多心思来关闭它。这将有点像跟踪&gt/dev/null2&gt&amp；1到所有cron条目的末尾。
大多数时候，当我和人们谈论阻止ICMP时，他们实际上是在谈论ping和traceroute。这转化为3种类型
0-回显答复（ping响应）
8-回显请求（ping请求）
11-超过时间
这是16种类型中的3种。让我们看看其他几种可用的ICMP类型。
4-源终止（由路由器发送，要求主机放慢传输速度）
3-目标无法访问（由16种不同类型的消息组成，从报告碎片问题到防火墙报告端口关闭）
这两者对于保持非恶意主机在网络上正常运行都是非常宝贵的。事实上，有两种（可能更多，但对我来说这是最明显的）非常好的情况，你不想限制ICMP。
路径MTU发现-我们使用Don't Fragment标志和类型3代码4（Destination Unreachable-Fragmentation required，and DF flag set）的组合来确定主机之间路径上的最小MTU。这样我们就避免了传输过程中的碎片化。
Active Directory要求客户端ping域控制器，以便删除GPO。他们使用ping来确定“最近的”控制器，如果没有响应，则认为没有足够近的控制器。因此，政策更新不会发生。
这并不是说我们一定要让世界看到一切。ICMP可以进行侦察，这通常是阻止的原因。可以使用ping来确定主机是否真的在上，或者使用Time Exceeds（作为跟踪路由的一部分）来映射网络架构，或者使用Rory禁止重定向（类型5代码0）来更改主机的默认路由。
考虑到这一切，我的建议是，一如既往地，采取慎重和深思熟虑的方法来保护你。完整地阻止ICMP可能不是最好的主意，但挑选和选择你阻止的内容以及去往/从哪里可能会得到你想要的。