[2] ANDROULAKI, E., RAYKOVA, M., SRIVATSAN, S., STAVROU,
A., AND BELLOVIN, S. M. PAR: Payment for Anonymous Rout-
ing. In Privacy Enhancing Technologies, 8th International Sym-
posium, PETS 2008, Leuven, Belgium, July 23-25, 2008, Pro-
ceedings (2008), pp. 219–236.
[3] BACKES, M., KATE, A., MANOHARAN, P., MEISER, S., AND
MOHAMMADI, E. AnoA: A Framework for Analyzing Anony-
mous Communication Protocols. In Computer Security Founda-
tions Symposium (CSF), 2013 IEEE 26th (2013), IEEE, pp. 163–
178.
[4] BALLANI, H., FRANCIS, P., AND ZHANG, X. A study of
In ACM SIG-
preﬁx hijacking and interception in the Internet.
COMM Computer Communication Review (2007), vol. 37, ACM,
pp. 265–276.
[5] BOLCH, G., GREINER, S., DE MEER, H., AND TRIVEDI, K. S.
Queueing networks and Markov chains: modeling and perfor-
mance evaluation with computer science applications. John Wi-
ley & Sons, 2006.
[6] BORISOV, N., DANEZIS, G., AND GOLDBERG, I. DP5: A pri-
vate presence service. Proceedings on Privacy Enhancing Tech-
nologies 2015, 2 (2015), 4–24.
[7] CAI, X., ZHANG, X. C., JOSHI, B., AND JOHNSON, R. Touch-
ing from a distance: Website ﬁngerprinting attacks and defenses.
In Proceedings of the 2012 ACM conference on Computer and
communications security (2012), ACM, pp. 605–616.
[8] CHAUM, D. Untraceable Electronic Mail, Return Addresses, and
Digital Pseudonyms. Commun. ACM 24, 2 (1981), 84–88.
[9] CHAUM, D. The dining cryptographers problem: Unconditional
sender and recipient untraceability. Journal of cryptology 1, 1
(1988), 65–75.
USENIX Association
26th USENIX Security Symposium    1213
[10] CHEN, C., ASONI, D. E., BARRERA, D., DANEZIS, G., AND
PERRIG, A. HORNET: High-speed Onion Routing at the Net-
work Layer. In Proceedings of the 22nd ACM SIGSAC Confer-
ence on Computer and Communications Security, Denver, CO,
USA, October 12-6, 2015 (2015), pp. 1441–1454.
[11] CORRIGAN-GIBBS, H., BONEH, D., AND MAZIÈRES, D. Ri-
poste: An anonymous messaging system handling millions of
users. In 2015 IEEE Symposium on Security and Privacy (2015),
IEEE, pp. 321–338.
[12] DANEZIS, G. The Trafﬁc Analysis of Continuous-Time Mixes.
In Privacy Enhancing Technologies, 4th International Workshop,
PET 2004, Toronto, Canada, May 26-28, 2004, pp. 35–50.
[13] DANEZIS, G. Mix-networks with restricted routes.
In Inter-
national Workshop on Privacy Enhancing Technologies (2003),
Springer, pp. 1–17.
[14] DANEZIS, G. Statistical disclosure attacks. In Security and Pri-
vacy in the Age of Uncertainty. Springer, 2003, pp. 421–426.
[15] DANEZIS, G., DINGLEDINE, R., AND MATHEWSON, N.
Mixminion: Design of a type III anonymous remailer protocol.
In Security and Privacy, 2003. Proceedings. 2003 Symposium on
(2003), IEEE, pp. 2–15.
[16] DANEZIS, G., AND GOLDBERG, I. Sphinx: A compact and
provably secure mix format. In Security and Privacy, 2009 30th
IEEE Symposium on (2009), IEEE, pp. 269–282.
[17] DANEZIS, G., AND SASSAMAN, L. Heartbeat trafﬁc to counter
(n-1) attacks: red-green-black mixes. In Proceedings of the 2003
ACM workshop on Privacy in the electronic society (2003), ACM,
pp. 89–93.
[18] DIAZ, C., SEYS, S., CLAESSENS, J., AND PRENEEL, B. To-
wards measuring anonymity. In International Workshop on Pri-
vacy Enhancing Technologies (2002), Springer, pp. 54–68.
[19] DINGLEDINE, R., AND MATHEWSON, N. June 2006. anonymity
loves company: Usability and the network effect. In Proceedings
of the Fifth Workshop on the Economics of Information Security
(WEIS 2006).
[20] DINGLEDINE, R., MATHEWSON, N., AND SYVERSON, P. Tor:
The second-generation onion router. In Proceedings of the 13th
conference on USENIX Security Symposium-Volume (2004).
[21] DINGLEDINE, R., SHMATIKOV, V., AND SYVERSON, P. Syn-
chronous batching: From cascades to free routes. In International
Workshop on Privacy Enhancing Technologies (2004), Springer,
pp. 186–206.
[22] DOUCEUR, J. R. The sybil attack. In International Workshop on
Peer-to-Peer Systems (2002), Springer, pp. 251–260.
[23] ELAHI, T., DANEZIS, G., AND GOLDBERG, I. PrivEx: Private
Collection of Trafﬁc Statistics for Anonymous Communication
Networks. In Proceedings of the 2014 ACM SIGSAC Conference
on Computer and Communications Security, Scottsdale, Arizona,
November 3-7, 2014 (2016), pp. 1068–1079.
[24] GELERNTER, N., HERZBERG, A., AND LEIBOWITZ, H. Two
cents for strong anonymity: The anonymous post-ofﬁce protocol.
Proceedings on Privacy Enhancing Technologies 2 (2016), 1–20.
[25] GILAD, Y., AND HERZBERG, A. Spying in the dark: TCP and
Tor trafﬁc analysis. In International Symposium on Privacy En-
hancing Technologies Symposium (2012), Springer, pp. 100–119.
[26] GOLDSCHLAG, D., REED, M., AND SYVERSON, P. Onion rout-
ing. Communications of the ACM 42, 2 (1999), 39–41.
[27] HENRY, R., AND GOLDBERG, I. Thinking inside the BLAC box:
smarter protocols for faster anonymous blacklisting. In Proceed-
ings of the 12th ACM workshop on Workshop on privacy in the
electronic society (2013), ACM, pp. 71–82.
[28] JANSEN, R., AND JOHNSON, A. Safely Measuring Tor. In Pro-
ceedings of the 2016 ACM SIGSAC Conference on Computer and
Communications Security, Vienna, Austria, October 24-28, 2016
(2016), pp. 1553–1567.
[29] KESDOGAN, D., EGNER, J., AND BÜSCHKES, R. Stop-and-go-
mixes providing probabilistic anonymity in an open system. In
International Workshop on Information Hiding (1998), Springer,
pp. 83–98.
[30] KWON, A., CORRIGAN-GIBBS, H., DEVADAS, S., AND FORD,
B. Atom: Scalable Anonymity Resistant to Trafﬁc Analysis.
CoRR abs/1612.07841 (2016).
[31] KWON, Y. H. Rifﬂe: An efﬁcient communication system with
strong anonymity. PhD thesis, Massachusetts Institute of Tech-
nology, 2015.
[32] LAZAR, D., AND ZELDOVICH, N. Alpenhorn: Bootstrapping
secure communication without leaking metadata. In Proceedings
of the 12th Symposium on Operating Systems Design and Imple-
mentation (OSDI), Savannah, GA (2016).
[33] LE BLOND, S., CHOFFNES, D., CALDWELL, W., DRUSCHEL,
P., AND MERRITT, N. Herd: A Scalable, Trafﬁc Analysis Re-
In ACM SIG-
sistant Anonymity Network for VoIP Systems.
COMM Computer Communication Review (2015), vol. 45, ACM,
pp. 639–652.
[34] MITZENMACHER, M., AND UPFAL, E. Probability and com-
puting: Randomized algorithms and probabilistic analysis. Cam-
bridge university press, 2005.
[35] MÖLLER, U., COTTRELL, L., PALFRADER, P., AND SAS-
SAMAN, L. Mixmaster Protocol-Version 2. Draft. July, available
at: www. abditum. com/mixmaster-spec. txt (2003).
[36] NIPANE, N., DACOSTA, I., AND TRAYNOR, P. Mix-in-place
anonymous networking using secure function evaluation.
In
Proceedings of the 27th Annual Computer Security Applications
Conference (2011), ACM, pp. 63–72.
[37] PARHI, R., SCHLIEP, M., AND HOPPER, N. MP3: A More Efﬁ-
cient Private Presence Protocol. arXiv preprint arXiv:1609.02987
(2016).
[38] REBOLLO-MONEDERO, D., PARRA-ARNAU, J., FORNÉ, J.,
AND DIAZ, C. Optimizing the design parameters of threshold
pool mixes for anonymity and delay. Computer networks 67
(2014), 180–200.
[39] SALTZER, J. H., REED, D. P., AND CLARK, D. D. End-to-end
arguments in system design. ACM Transactions on Computer
Systems (TOCS) 2, 4 (1984), 277–288.
[40] SERJANTOV, A., AND DANEZIS, G. Towards an information
In International Workshop on
theoretic metric for anonymity.
Privacy Enhancing Technologies (2002), Springer, pp. 41–53.
[41] SERJANTOV, A., DINGLEDINE, R., AND SYVERSON, P. From
a trickle to a ﬂood: Active attacks on several mix types. In In-
ternational Workshop on Information Hiding (2002), Springer,
pp. 36–52.
[42] SERJANTOV, A., AND NEWMAN, R. E. On the anonymity of
timed pool mixes. In Security and Privacy in the Age of Uncer-
tainty. Springer, 2003, pp. 427–434.
[43] SHANNON, C. E. A mathematical theory of communication.
ACM SIGMOBILE Mobile Computing and Communications Re-
view 5, 1 (2001), 3–55.
[44] SHMATIKOV, V., AND WANG, M.-H. Timing analysis in low-
latency mix networks: Attacks and defenses. Computer Security–
ESORICS 2006 (2006), 18–33.
[45] TYAGI, N., GILAD, Y., ZAHARIA, M., AND ZELDOVICH,
N. Stadium: A Distributed Metadata-Private Messaging Sys-
tem. Cryptology ePrint Archive, Report 2016/943, 2016. http:
//eprint.iacr.org/2016/943.
1214    26th USENIX Security Symposium
USENIX Association
[46] VAN DEN HOOFF, J., LAZAR, D., ZAHARIA, M., AND ZEL-
DOVICH, N. Vuvuzela: Scalable private messaging resistant to
trafﬁc analysis. In Proceedings of the 25th Symposium on Oper-
ating Systems Principles (2015), ACM, pp. 137–152.
[47] WOLINSKY, D. I., CORRIGAN-GIBBS, H., FORD, B., AND
JOHNSON, A. Dissent in numbers: Making strong anonymity
In Presented as part of the 10th USENIX Symposium
scale.
on Operating Systems Design and Implementation (OSDI 12)
(2012), pp. 179–182.
[48] ZHU, Y., FU, X., BETTATI, R., AND ZHAO, W. Anonymity
In
analysis of mix networks against ﬂow-correlation attacks.
Global Telecommunications Conference, 2005. GLOBECOM’05.
IEEE, vol. 3, IEEE, pp. 5–pp.
A Appendix
A.1
Incremental Computation of the En-
tropy Metric
Let X be a discrete random variable over the ﬁnite set X
with probability mass function p(x) = Pr(X = x). The
Shannon entropy H(X) [43] of a discrete random vari-
able X is deﬁned as
H(X) = − ∑
x∈X
p(x)log p(x).
(4)
Let on,k,l be an observation as deﬁned in Section 4.1.3
for a pool at time t. We note that any outgoing message
will have a distribution over being linked with past input
messages, and the entropy Ht of this distribution is our
anonymity metric. Ht can be computed incrementally
given the size of the pool l (from previous mix rounds)
and the entropy Ht−1 of the messages in this previous
pool, and the number of messages k received since a mes-
sage was last sent:
(cid:18)(cid:26) k
(cid:27)(cid:19)
Ht =H
,
l
k + l
k + l
+
k
k + l
logk +
l
k + l
Ht−1,
(5)
for any t > 0 and H0 = 0. Thus for sequential obser-
vations we can incrementally compute the entropy met-
ric for each outgoing message, without remembering the
full history of the arrivals and departures at the Poisson
mix. We use this method to compute the entropy metric
illustrated in Figure 5.
A.2 Proof of Theorem 2
Let us assume, that in mix node Mi there are n(cid:48) mes-
sages at a given moment, among which is a target mes-
sage mt. Each message has a delay di drawn from the ex-
ponential distribution with parameter µ. The mix node
generates loops with distribution Pois(λM). The adver-
sary observes an outgoing message m and wants to quan-
tify whether this outgoing message is her target message.
The adversary knows, that the output of the mix node can
be either one of the messages inside the mix or its loop
cover message. Thus, for any message mt, the following
holds
Pr [m = mt ] = Pr [m (cid:54)= loop]· Pr [m = mt|m (cid:54)= loop] (6)
We note that the next message m is a loop if and only if
the next loop message is sent before any of the messages
within the mix, i.e., if the sampled time for the next loop
message is smaller than any of the remaining delays of all
messages within the mix. We now leverage the memory-
less property of the exponential distribution to model the
remaining delays of all n(cid:48) messages in the mix as fresh
random samples from the same exponential distribution.
Pr [m (cid:54)= loop] = 1− Pr [m = loop]
= 1− Pr [X < d1 ∧ X < d2 ∧ . . .∧ X < dn(cid:48)]
= 1− Pr [X < min{d1,d2, . . .dn(cid:48)}]
(7)
We know, that di ∼ Exp(µ) for all i ∈ {1, . . .,n(cid:48)} and
X ∼ Exp(λM). Moreover, we know that the minimum
of n independent exponential random variables with rate
µ is an exponential random variable with parameter
∑n(cid:48)
i µ. Since all the delays di are independent expo-
nential variables with the same parameter, we have for
Y = min{d1,d2, . . .dn(cid:48)}, Y ∼ Exp(n(cid:48)µ). Thus, we obtain
the following continuation of Equation (7).
0
(cid:90) ∞
Pr [m (cid:54)= loop] = 1− Pr [X < Y ]
(cid:90) ∞
= 1−
(cid:90) ∞
= 1−
= 1−
= 1− λM
Pr [X < Y|X = x]Pr [X = x]dx
Pr [x < Y ]λMe−λMxdx
e−n(cid:48)µxλMe−λMxdx
0
0
λM + nµ
n(cid:48)µ
=
n(cid:48)µ + λM
(8)
Since the probability to send a loop depends only on the
number of messages in a mix, but not on which messages
are in the mix, this probability is independent of the prob-
ability from Theorem 1. Theorem 2 follows directly by
combining Theorem 1 and Equation (8), with n(cid:48) = k + l.
We get for messages m1 that previously were in the mix,
Pr [m = m1] = Pr [m (cid:54)= loop]· Pr [m = m1|m (cid:54)= loop]
·
k
n(k + l)
(k + l)µ
=
=
(k + l)µ + λM
k
·
n
(k + l)µ + λM
µ
.
USENIX Association
26th USENIX Security Symposium    1215
Analogously, we get for m2,
Pr [m = m2] = Pr [m (cid:54)= loop]· Pr [m = m2|m (cid:54)= loop]
=
=
(k + l)µ
(k + l)µ + λM
µ
(k + l)µ + λM
· 1
k + l
.
This concludes the proof.
1216    26th USENIX Security Symposium
USENIX Association