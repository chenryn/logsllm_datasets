advertising sub-preﬁxes of a preﬁx P to different upstream routers
all belonging to the same ISP, relying on that ISP to aggregate the
sub-preﬁxes to prevent them from reaching the “global” routing
tables. With AIP as presented thus far, accomplishing such trafﬁc
engineering does not seem possible without increasing the number
of globally visible AD entries.
We believe, however, that splitting and then aggregating preﬁxes
for trafﬁc engineering is not widely practiced today. We conducted
a measurement study by obtaining a /17 and advertising various
sub-preﬁxes of size /18 and /19 via BGP. Each sub-preﬁx had the
same AS path and IP layer path, so an upstream AS could easily
aggregate these sub-preﬁx advertisements into a single one. We
found by examining BGP routing tables at many Internet vantage
points that no aggregation occurred, despite many different ISPs
having had the opportunity to do so. Private conversations with
some ISP operators conﬁrmed our ﬁnding: such explicit aggregation
is almost never done today.
To explain why, we conducted a related experiment. We an-
nounced a /18 via two large Tier-1 ISPs, A and B, and the containing
/17 from just one of them (B) to emulate the case where an upstream
(the /17) owns a larger chunk and a stub is punching a hole to multi-
home. The /18 announced to the two upstream ISPs was seen by
all of the many BGP vantage points we checked. Using traceroute,
we found that some nodes in the Internet reached the /18 via A and
some via B. If A had aggregated the /18s into a single /17, then
longest-preﬁx matching would likely cause all of the trafﬁc to arrive
via B. Such unilateral ﬁltering and aggregation could be harmful and
violate the stub network’s trafﬁc engineering goals.
We then withdrew the /18 through B, simulating the case when
the link between the stub and its primary fails. If some AS had
ﬁltered the /18s earlier, it would not have seen the withdrawal of
the /18 through B, and hence continued to use that route to get
to destinations in the withdrawn /18. We found instead that all
subsequent traceroutes took the valid route through A. This result
suggests that ISPs today do not arbitrarily ﬁlter route advertisements
even when they might be redundant; one reason might be to avoid
failing in situations like the one just described. Thus, it appears
that a stub network’s BGP announcements remain invariant as they
propagate across the Internet. The simple approach of making each
of today’s preﬁxes an AD might well be adequate for interdomain
trafﬁc engineering.
If, however, operators wish to use such load balancing in the
future, one can make use of the AIP address interface bits to sub-
divide an AD, so an operator could announce different routes for each
AD:interface bits combination. In particular, an administrator could
partition the EIDs belonging to the different subnetworks of an AD
to one of 255 possible “paths” (in practice, we expect the number of
paths to be a lot smaller) by setting a different value of the interface
ﬁeld for each partition. Any upstream network can choose to zero
the interface bits in its wide-area advertisements as a way to reduce
the amount of global routing table state, in much the same way that it
aggregates preﬁxes today. Thus, most wide-area routers will forward
using AD lookups as before, but those near the destination that might
be obligated to pay attention to the interface bits of an AD address.
It is important to note here that BGP messages are still signed using
the AD’s private key, and that there remains only one key pair for the
entire AD. Finally, we note that AIP leaves unchanged an operator’s
ability to perform equal-cost multipath routing by hashing packet
header ﬁelds to direct trafﬁc to one of k links.
DNS-based load balancing: Another component of trafﬁc engi-
neering is a service-centric view: How to load balance trafﬁc des-
tined for a particular service across machines in a cluster or across
data centers. In general, the move to AIP has only a small, positive
effect on this ability. DNS-based load balancing can still change the
AIP-record corresponding to a host or service name. AIP’s interface
bits might simplify cluster-based load-balancing by representing a
service as a single “host” connected to the network multiple times;
we leave the design of such speciﬁc mechanisms to future work.
7 Related Work
Many features of AIP have similar forerunners in the literature. We
do not have space to discuss each predecessor individually, but below
we list some of the major ideas that AIP draws upon.
Self-certifying names: Some forms of addressing are already self-
certifying: CGA [5] derives the “interface” portion of an IP address
from a public key, and HIP [29] derives a host identiﬁer (EID) from
the hash of a public key. AIP extends self-certiﬁcation to the entire
network-level address.
Separating identiﬁers and locators: Ever since the GSE/8+8 [30]
proposal, it has been widely acknowledged that addressing should
separate identiﬁcation from location. The more recent LISP proposal
also suggests forwarding trafﬁc based on routing locators that are sep-
arate from endpoint identiﬁers [9]. AIP provides a similar separation
of function: The AD provides location information, while the EID
is purely an identiﬁer. Unlike LISP, AIP does not require tunneling
to route on locators, and AIP’s addresses are self-certifying.
Scalability: The scalability of Internet routing has been a long-
standing concern. CIDR has helped sustain the routing table and
control trafﬁc load growth until increases in peering, but site-
multihoming, and preference for provider independent addresses
have combined to reduce CIDR’s effectiveness. A number of recent
proposals have tried to re-establish aggregation by introducing ad-
dress aggregates in the control plane to reduce its load (e.g., [17])
or in both the control and forwarding planes [41, 46] to limit the
growth of routing tables. The challenge of ﬁnding a mechanism for
aggregation in Internet has sparked theoretical interest as well [21].
Source accountability: Several mechanisms have been proposed to
improve source accountability. The simplest mechanism is to install
ﬁlters on the border routers of an AS [10, 20]: routers can prohibit
outbound trafﬁc originating from source addresses that do not exist
on the local network (egress ﬁltering) and can prohibit inbound trafﬁc
from source addresses that should only exist inside the local network
(ingress ﬁltering). To be effective, ﬁltering requires near-complete
deployment by stub networks. Installing these ﬁlters in the middle
of the network is fundamentally difﬁcult [8, 31]. Passport [25] uses
cryptography to prevent spooﬁng; it veriﬁes each packet but only
at the domain granularity. Whereas AIP is based on a challenge-
response for an initial packet and operates on a per-host granularity,
As mentioned earlier, AIP’s shut-off packet is based on a sim-
ilar idea proposed by Shaw [35]. It also bears some similarity to
AITF [4]. Thus, we don’t claim credit for the basic idea, but merely
observe that AIP’s address structure facilitates its implementation.
Control-plane accountability: Various proposals augment the
routing protocol with cryptographic mechanisms to prevent routers
from originating false routes; the two most notable are S-BGP [19]
and secure origin BGP (soBGP) [44]. One of the major drawbacks
to these proposals is that they require the existence of a global PKI.
Although work is afoot to institute such a framework [15, 14, 3],
it may be difﬁcult to maintain in practice, as has been the case
with routing registries [13, 36]. Other mechanisms for securing
BGP include online monitoring at global BGP routing repositories
to detect suspicious routing announcements [16, 22, 24, 34]. Al-
though detecting “suspicious” routing announcements in real-time
is operationally useful and is attractive due to its low deployment
barrier, these approaches are more effective for detecting accidental
misconﬁguration than for preventing malicious attacks.
8 Conclusion
AIP is our attempt to answer the question: “what might the Internet’s
network layer look like if accountability were a ﬁrst-order goal?” By
using a simple hierarchical addressing scheme with self-certifying
components, AIP enables simple solutions to source spooﬁng, shut-
ting off certain kinds of DoS trafﬁc, and securing BGP. The move
away from preﬁxes to ﬂat addresses brings up concerns about route
scalability and trafﬁc engineering, while the use of self-certiﬁcation
raises questions of key management and compromise. Our discus-
sion of these issues leads us to conclude that, while hoping for a
near-term replacement to IP might be like building castles in the
air, these important concerns are not a show-stopper for AIP (or the
ideas contained therein) to be widely adopted.
Acknowledgments
We thank Mythili Vutukuru for conducting the trafﬁc engineering
experiments reported in Section 6. We thank Mythili and Michael
Walﬁsh for participating in the early stages of the AIP project and
contributing to its design. Jakob Eriksson, Lewis Girod, Ramakr-
ishna Gummadi, Adrian Perrig, Amar Phanishayee, Anirudh Ra-
machandran, Vijay Vasudevan, the attendees of the 6th HotNets
workshop, and the anonymous reviewers provided helpful com-
ments that improved the paper. This work was funded in part by
the National Science Foundation under awards CNS-0716273 and
CNS-0520241.
References
[1] ITRS international technology roadmap for semiconductors, 2006.
[2] D. Andersen, H. Balakrishnan, N. Feamster, T. Koponen, D. Moon, and S. Shenker.
Holding the Internet accountable. In Proc. 6th ACM Workshop on Hot Topics in
Networks (Hotnets-VI), Nov. 2007.
[3] APNIC. The APNIC Resource Certiﬁcation Page. http://mirin.apnic.
net/resourcecerts/.
[4] K. Argyraki and D. R. Cheriton. Active Internet trafﬁc ﬁltering: Real-time
response to denial-of-service attacks. In Proc. USENIX Annual Technical Confer-
ence, Apr. 2005.
[5] T. Aura. Cryptographically Generated Addresses (CGA). Internet Engineering
Task Force, Mar. 2005. RFC 3972.
[6] R. Beverly and S. Bauer. The Spoofer project: Inferring the extent of source
address ﬁltering on the Internet. In Proc. SRUTI Workshop, July 2005.
[7] CNET News.com. Router Glitch Cuts Net Access. http://news.com.com/
2100-1033-279235.html, Apr. 1997.
[8] Z. Duan, X. Yuan, and J. Chandrashekar. Constructing Inter-Domain Packet
Filters to Control IP Spooﬁng Based on BGP Updates. In Proc. IEEE INFOCOM,
Mar. 2006.
[9] D. Farinacci, V. Fuller, D. Oran, and D. Meyer. Locator/ID Separation Protocol
(LISP).
Internet Draft (http:
//tools.ietf.org/html/draft-farinacci-lisp-07). Work in
progress, expires October 2008.
Internet Engineering Task Force, Apr. 2008.
[10] P. Ferguson and D. Senie. Network Ingress Filtering: Defeating Denial of Service
Attacks which employ IP Source Address Spooﬁng. Internet Engineering Task
Force, Jan. 1998. RFC 2267.
[11] P. Ferguson and D. Senie. Network Ingress Filtering. Internet Engineering Task
Force, May 2000. BCP 38, RFC 2827.
[12] V. Fuller. Scaling issues with routing+multihoming, Feb. 2007. Plenary session
at APRICOT, the Asia Paciﬁc Regional Internet Conference on Operational
Technologies.
[13] G. Goodell, W. Aiello, T. Grifﬁn, J. Ioannidis, P. McDaniel, and A. Rubin. Work-
ing around BGP: An incremental approach to improving security and accuracy in
interdomain routing. In Proc. NDSS, Feb. 2003.
[14] G. Huston, G. Michaelson,
source Certiﬁcate Repository Structure.
Force,
project-notes/draft-ietf-sidr-repos-struct-00.html.
A Proﬁle for Re-
Internet Engineering Task
http://mirin.apnic.net/resourcecerts/
and R. Loomans.
June 2006.
[15] G. Huston, G. Michaelson, and R. Loomans. A Proﬁle for X.509 PKIX
July 2006.
Internet Engineering Task Force,
Resource Certiﬁcates.
http://mirin.apnic.net/resourcecerts/project-notes/
draft-ietf-sidr-res-certs-02.html.
[16] J. Karlin, S. Forrest, and J. Rexford. Pretty Good BGP: Protecting BGP by
cautiously selecting routes. Technical report, University of New Mexico, Oct.
2005. TR-CS-2005-37.
[17] F. Kastenholz. ISLAY: A New Routing and Addressing Architecture. Internet
Engineering Task Force, May 2002. http://ietfreport.isoc.org/
idref/draft-irtf-routing-islay/.
[18] S. Kent and R. Atkinson. Security Architecture for the Internet Protocol. Internet
Engineering Task Force, Nov. 1998. RFC 2401.
[19] S. Kent, C. Lynn, and K. Seo. Secure border gateway protocol (S-BGP). IEEE
JSAC, 18(4):582–592, Apr. 2000.
[20] T. Killalea. Internet Service Provider Security Services and Procedures. Internet
Engineering Task Force, Nov. 2000. RFC 3013.
[21] D. Krioukov, kc claffy, K. Fall, and A. Brady. On Compact Routing for the
Internet. ACM Computer Communications Review, 37(3):41–52, July 2007.
[22] M. Lad, D. Massey, D. Pei, Y. Wu, B. Zhang, and L. Zhang. PHAS: A preﬁx
hijack alert system. In Proc. 15th USENIX Security Symposium, Aug. 2006.
[23] J. Leskovec, J. Kleinberg, and C. Faloutsos. Graphs over time: Densiﬁcation
laws, shrinking diameters and possible explanations. In Proc. 11th ACM SIGKDD
International Conference on Knowledge Discovery and Data Mining, Aug. 2005.
[24] J. Li, R. Bush, Z. M. Mao, T. Grifﬁn, M. Roughan, D. Stutzbach, and E. Pur-
pus. Watching data streams toward a multi-homed sink under routing changes
introduced by a BGP beacon. In Passive & Active Measurement (PAM), Mar.
2006.
[25] X. Liu, X. Yang, D. Wetherall, and A. Li. Passport: Secure and Adoptable Source
Authentication. In Proc. 5th USENIX NSDI, Apr. 2008.
[26] D. Mazi`eres, M. Kaminsky, M. F. Kaashoek, and E. Witchel. Separating key man-
agement from ﬁle system security. In Proc. 17th ACM Symposium on Operating
Systems Principles (SOSP), pages 124–139, Dec. 1999.
[27] D. McCullagh. How Pakistan knocked YouTube ofﬂine. http://news.cnet.
com/8301-10784 3-9878655-7.html, Feb. 2008.
[28] D. Meyer, L. Zhang, and K. Fall. Report from the IAB Workshop on Routing and
Addressing. Internet Engineering Task Force, Sept. 2007. RFC 4984.
[29] R. Moskowitz and P. Nikander. Host Identity Protocol (HIP) Architecture. Internet
Engineering Task Force, May 2006. RFC 4423.
[30] M. Ohta. 8+8 Addressing for IPv6 End to End Multihoming, Jan. 2004. draft-
ohta-multi6-8plus8-00 (Expired IETF Draft).
[31] K. Park and H. Lee. On the effectiveness of route-based packet ﬁltering for dis-
tributed DoS attack prevention in power-law Internets. In Proc. ACM SIGCOMM,
Aug. 2001.
[32] A. Ramachandran and N. Feamster. Understanding the Network-Level Behavior
of Spammers. In Proc. ACM SIGCOMM, Aug. 2006. An earlier version appeared
as Georgia Tech TR GT-CSS-2006-001.
[33] A. Ramachandran and N. Feamster. Understanding the network-level behavior of
spammers. In Proc. ACM SIGCOMM, Aug. 2006.
[34] Renesys. Renesys Routing Intelligence. http://www.renesys.com/
products services/routing intelligence.shtml.
[35] M. Shaw. Leveraging good intentions to reduce unwanted network trafﬁc. In Proc.
USENIX Steps to Reduce Unwanted Trafﬁc on the Internet workshop, July 2006.
[36] G. Siganos and M. Faloutsos. Analyzing BGP Policies: Methodology and Tool.
In Proc. IEEE INFOCOM, Mar. 2004.
[37] T. L. Simon. oof. panix sidelined by incompetence... again. http://merit.
edu/mail.archives/nanog/2006-01/msg00483.html, Jan. 2006.
[38] A. C. Snoeren and H. Balakrishnan. An end-to-end approach to host mobility. In
Proc. ACM Mobicom, pages 155–166, Aug. 2000.
[39] Spammer-X. Inside the SPAM Cartel. Syngress, 2004. Page 40.
[40] G. Varghese. Network Algorithmics. Morgan Kaufmann, 2007.
[41] P. Verkaik, A. Broido, kc claffy, R. Gao, Y. Hyun, and R. van der Pol. Beyond
CIDR aggregation. Technical Report TR-2004-01, CAIDA, Feb. 2004.
[42] Q. Vohra and E. Chen. BGP Support for Four-octet AS Number Space. Internet
Engineering Task Force, May 2007. RFC 4893.
[43] M. Walﬁsh, J. Stribling, M. Krohn, H. Balakrishnan, R. Morris, and S. Shenker.
Middleboxes no longer considered harmful. In Proc. 6th USENIX OSDI, Dec.
2004.
[44] R. White. Securing BGP through secure origin BGP. The Internet Protocol Jour-
nal, 6(3), Sept. 2003. http://www.cisco.com/web/about/ac123/
ac147/archived issues/ipj 6-3/ipj 6-3.pdf.
[45] Q. Wu, Y. Liao, T. Wolf, and L. Gao. Benchmarking BGP routers. In Proc. IEEE
International Symposium on Workload Characterization (IISWC), Sept. 2007.
[46] X. Zhang, P. Francis, J. Wang, and K. Yoshida. Scaling IP routing with the core
router-integrated overlay. In IEEE International Conference on Network Protocols
(ICNP), Nov. 2006.