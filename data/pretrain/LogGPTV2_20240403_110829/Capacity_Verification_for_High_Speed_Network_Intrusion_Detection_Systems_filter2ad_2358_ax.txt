threat activity.5
Technological  advances  and  the  Internet  provide  expanded  opportunities  for
criminal  activity. As  a  result,  law  enforcement  agencies  face  many  new  challenges,
notably  building  the  knowledge  and  skills  necessary  to  effectively  combat  cyber
crimes.    Part  of  this  knowledge  may  derive  from  an  examination  of  open  sources,
including  intercept  and  examination  of  network  communications  as  a  source  of
criminal intelligence.  Interception activity is also undertaken to collect evidence of an
(criminal) offense to support prosecution efforts.6  The use of cyber-based evidence is
becoming  more  important,  and  there  is  no  reason  to  suppose  that  law  enforcement
agencies would not consider IDS logs as a potential source of cyber-based evidence.7
While  the  collection  of  evidence  to  support  criminal  prosecution  has  traditionally
been a law enforcement responsibility, S&I agencies are increasingly being tasked to
support  law  enforcement  in  this  regard,  particularly  in  support  of  anti-terrorism
efforts.8
Specific  legislation  exists  to  govern  interception  activities  of  S&I  and  law
enforcement  agencies.    A number  of  conditions  must  be  met  before  an  interception
authorization  can  be  granted,  and  certain  conditions  must  be  also  be  met  while
conducting  the  interception.    These  conditions  may  be  spelled  out  in  the  relevant
5 European Parliament Report on the existence of a global system for the interception of private
communications  (ECHELON  interception  system)  (2001/2098(INI)),  report  reference  A5-
0264/2001, dated 11 July 2001.  The report refers to claims that ECHELON has ‘the ability
to intercept any telephone, fax, Internet or e-mail message sent by any individual and thus to
inspect  its  contents’  (Section  1.6,  page  23)  while  acknowledging  that  limitations  on
interception  and  analysis  make  this  kind  of  global  surveillance  ‘impossible  in  practice’
(Preamble, page 11, Item D).
6 Gellman, B., Washington Post Staff Reporter, “Cyber-Attacks by Al Qaeda Feared”, dated 27
June 2002.  In this case, FBI review of network audit and monitoring logs revealed that al
Qaeda  operatives  were  spending  time  on  sites  dealing  with  supervisory  control  and  data
acquisition  (SCADA)  systems  –  the  systems  that  control  power,  water,  transport  and
communications  grids.    See  also:  Pruitt,  S.,  IDG  News  Service,  “FBI  gets  new  Web
searching powers”, dated 31 May 2002. 
7 While the admissibility of electronic records has been the subject of past case law, it is not
clear  if  IDS  logs  have  been  included.    For  issues  associated  with  the  use  of  IDS  logs  as
evidence, see: Sommers, P., “Intrusion Detection Systems as Evidence”, First International
Workshop  on  the  Recent  Advances  in  Intrusion  Detection,  14  –  16  September  1998,
Louvain-le-Neuve,  Belgium;  and  Stephenson,  P.,  “The  Application  of  Intrusion  Detection
Systems in  a  Forensic  Environment”  (extended  abstract),  Third  International  Workshop  on
the Recent Advances in Intrusion Detection, 2 – 4 October 2000, Toulouse, France.
8 See e.g.: (UK) An Act to give the Security Service the function of acting in support of  the
prevention and detection of serious crime, and for connected purposes (1996 Chapter 35), 18
July 1996 (Security Service Act 1996), Section 1(1).
142         S.R. Johnston
governing  legislation  (e.g.  CSIS  Act)  or  other  legislation  (e.g.  criminal  or  anti-
terrorism law).9 
Other public and private sector organizations also have a requirement to intercept
and  examine  network  traffic.    While  these  organizations  may  need  to  do  this  for
intelligence  or  evidentiary  purposes,  most  such  interception  would  likely  be
conducted by law enforcement or S&I agencies.  Instead, interception performed by
these organizations is more commonly done in order to identify an attempted or actual
intrusion  into  a  protected  system  or  network,  and  to  initiate  an  incident  response
process  (of  course,  this  also  applies  to  law  enforcement  and  S&I  agencies).    While
existing legal regimes adequately address  interception by  S&I  and  law  enforcement
agencies, they generally do not adequately address interception of network traffic by
other organizations.
4  What Is a Private Communication?
What constitutes a private communication, particularly those over a network, for the
purposes  of  criminal  or  anti-terrorism  law?    The  only  definition  of  private
communications that could be found in the selected legislation is that in the Criminal
Code of Canada.  A private communication is defined as “any oral communication or
any telecommunication, … that is made under circumstances in which it is reasonable
for the originator to expect that it will not be intercepted by any person other than the
person  intended  by  the  originator  to  receive  it.”10  Telecommunications  is  further
defined as “the emission, transmission or reception of signs, signals, writing, images,
sounds  or  intelligence  of  any  nature  by  any  wire,  cable,  radio,  optical  or  other
  Network
electromagnetic  system,  or  by  any  similar 
communications,  although  not  explicitly  mentioned  anywhere  in  the  legislation,
would almost certainly fall within this definition. Note that it is the expectation of the
9  See  e.g.  (AU)  An  Act  to  prohibit  the  interception  of  telecommunications  except  where
authorized in special circumstances or for the purposes of tracing the location of callers in
emergencies,  and  for  related  purposes,  Act  No.  114  of  1979  as  amended  (the
Telecommunications (Interception) Act of 1979), Part III, Sections 9 – 11; (CA) CSIS Act,
Section 21; (CA) An Act respecting the  Criminal  Law  (R.S.,  C-34),  updated  to  31  August
2001 (Criminal Code), Section 184.2(3); (UK) Regulation of Investigatory Powers Act 2000
(2000 Chapter 23), dated 28 July 2000 ((UK) RIPA 2000), Part I, Sections 6 – 11; (US) US
Code,  Title  18,  Part  I,  Chapter  119,  Section  2516  (Authorization  for  interception  of  wire,
oral, or electronic communications (in criminal cases)); and (US) US Code, Title 50, Chapter
36,  Subchapter  I,  Section  1804  (Applications  for  court  orders  (for  Foreign  Intelligence
Surveillance Act interceptions)).
technical  system”.11 
10 (CA) Criminal Code, Section 183.  Other legislation defines private communication services,
but not private communication.  See also: (UK) RIPA 2000, Part I, Section 2(1); (US) US
Code, Title 26, Subtitle D, Chapter 33, Subchapter A, Section 4241 to 4243, Subchapter B,
Section 4252(d).
11 (CA) An Act respecting the interpretation of statutes and regulations, updated to 31 August
2001 (Interpretation Act), Section 35(1).    The  Interpretation  Act  provides  the  authoritative
basis  for  the  definition  and  interpretation  of  selected  terms  that  appear  in  other  Canadian
legislation.  See also: (AU) Telecommunications (Interception) Act 1979, Section 5(1); (US)
US  Code,  Title  18,  Part  I,  Chapter  119,  Section  2510(14);  and  (UK)  RIPA  2000,  Part  I,
Section 2(1).
Development of a Legal Framework for Intrusion Detection         143
originator of the message that no one other than the intended recipient will intercept
the  message  that  matters  to  the  determination  of  whether  the  communications  is  a
‘private communication’.
It might be useful at this point to try to distinguish between personal information
that  is  public  and  that  which  is  private12.    Personal  information  is  defined  as
information about an identifiable individual that is recorded in any form including any
identifying  number,  symbol  or  other  particular  assigned  to  the  individual,  or  the
address  of  the  individual.13    Personal  information  has  been  construed  as  being  very
broad  and  probably  includes  Internet  Protocol  (IP)  addresses.    Some  personal
information  should  be  considered  private  (e.g.  financial  or  medical  information).
Some  personal  information,  on  the other  hand,  clearly  resides  in  the  public  domain
(e.g. name, street address and phone number in a phone book) and would likely not be
considered private, although there are exceptions (e.g. unlisted phone number).  In a
network context, the equivalent information would be user name and domain (e-mail)
and the corresponding addressing information as published, for instance, in a public
key certificate.  Although personal, this would likely constitute public information.
Is  the  issue  one  of  keeping  the  content  of  a  particular  communication  private?
There  is  little  argument  that  the  user-entered portion  of  a  communication  would  be
considered personal and private.  If the originator does not want the contents of the
message to be read by anyone other than the intended recipient, then he/she can take
steps to protect the message content through the use of encryption.  In fact, criminal
law specifically refers to electronic or other treatment of radio-based communication
for  the  purpose  of  preventing  intelligible  reception  by  any  person  other  than  the
intended  recipient.14    There  is  no  mention  of  similar  treatment  for  other  forms  of
telecommunication  (i.e.  network  communications).    However,  should  an  individual
consciously  take  steps  to  protect  the  communication  against  intercept,  given  the
generally inclusive definition of telecommunications, it is the author’s opinion that a
reasonable  expectation  of  privacy  would  be  created  for  the  content  of  network
communications.15
The situation is not quite so clear when it comes to packet header information.  Are
headers an integral part of the communication (i.e. part of the content of a message)? 
12  Public  is defined  as  “open  to or  shared  by  all  the  public”,  or  “reveal  previously  unknown
information.”  Private is defined as “confidential; not to be disclosed  to others”, or  as  that
which is “kept or removed from public knowledge or observation”.  The Canadian Oxford
Dictionary, Oxford University Press, 1998.
13 (CA) An Act to extend the present laws of Canada that protect the privacy of individuals and
that provide individuals with a right of access to personal information about themselves (R.S.
1985, c.P-21), updated to 31 August 2001 (Privacy Act), Section 3.  The identification of the
individual  may  also  include  one  or  more  factors  relating  to  his  physical,  physiological,
mental, economic, cultural or social identity and includes any expression of opinion about the
individual.
14 (CA) Criminal Code, section 183.  See also: (US) US Code, Title 18, Part I, Chapter 119,
Section 2510(16).
15  However, provisions for the mandatory disclosure of encryption keys are being enacted into
law.    See  e.g.:  (UK)  RIPA  2000,  Part  III,  Section  50.    In  light  of  this,  some  authors  are
advocating measures intended to circumvent the provisions of this Act.  See: Brown, I. and
Gladman, B., “The Regulation of Investigatory Powers Bill – Technically inept: ineffective
against criminals while undermining the privacy, safety and security of honest citizens and
businesses”, undated.
144         S.R. Johnston
An argument could be made in favour of this position as at least part of the header
(e.g.  the destination  address  in  an  e-mail, or  the  URL  of  a  website)  is  generated  in
response to user input.  Intuitively, one would consider this to be private information
– individuals may not want anyone else to know with whom they are communicating.
On  the  other  hand,  there  is  a  certain  amount  of  information  in  network
communications  that  must  be  public.    This,  of  course,  is  the  routing  and  handling
information contained in the packet header.  If one considers conventional mail, the
header  information  would  be  analogous  to  the  addressing  on  the  outside  of  an
envelope.  The majority of this information is generally available to the public (other
than on the envelope itself, which is afforded some privacy by virtue of being handled
within  the  postal  system)  and  would  therefore  be  considered  public,  not  private,
information.
Is  the  issue  then  one  of  keeping  the  fact  that  a  particular  communication  has
occurred private?  Simply intercepting the fact of a communication (i.e. traffic data)
can lead to the development of a detailed user profile (through traffic analysis) that
could reveal personal, private  information  (e.g.  web  surfing  habits)  even  if  the data
from which the profile is constructed is all considered to be public.16  Traffic data is
defined as any computer data  relating  to  a  communication  by means  of  a  computer
system,  generated  by  a  computer  system  that  formed  a  part  in  the  chain  of
communication, indicating the communication’s origin, destination, route, time, date,
size, duration, or type of underlying service.17  In a telephone context, traffic data is
generally  considered  to  be  a  list  of  telephone  numbers  dialed  to  or  from  a  specific
telephone line.  It is straightforward to separate the dialed number from the content of
the telephone conversation.
In  a  network  context,  there  is  a  difference  of  opinion  as  to  what  constitutes  the
equivalent  of  the  dialed  number  list.    The  range  of  possibilities  extends  from  the
header (or addressing) portion of network traffic to the address and subject lines of an
e-mail  and  Web  URLs.18    The  only  thing  that  seems  to  be  consistent  across  the
differing views is that traffic data will contain IP addresses.  Given the nature of the
information  that  can be  logged by  an  IDS,  it  would  almost  certainly  fall  within  the
16 This will increasingly be an issue now that data  retention legislation  is being  passed.    See
e.g.:  (UK)  An  Act  to  amend  the  Terrorism  Act  2000;  …;  to  provide  for  the  retention  of
communications data; …; and for connected purposes (2001 Chapter 24), 14 December 2001
(Anti-terrorism,  Crime  and  Security  Act  2001),  part  11;  and  Reuters,  “Spain  passes  law  to
regulate Internet content”, dated 27 June 2002.  This article makes mention of the Law on the
Information Society and Electronic Commerce (LSSI), which includes provisions for ISPs to
keep details on users for over a year.
17  (Council of  Europe(COE))  Convention  on  Cybercrime  (ETS  185),  opened  for  signature  at
Budapest,  23  November  2001,  Chapter  I,  Article  1(d).    “Origin”  refers  to  a  telephone
number, Internet Protocol (IP) address, or similar identification of a communications facility
to which a service provider renders services. “Destination” refers to a comparable indication
of  a  communications  facility  to  which  communications  are  transmitted  (from  Explanatory
Memorandum  to  the  Convention,  article  30).    See  also:  (US)  US  Code,  Title  18,  Part  II,
Chapter  206,  Section  3127(3),  as  amended  by  the  USA  PATRIOT  Act;  and  (UK)  RIPA
2000, Part I, Section 2(9).
18  Black,  J.,  “Uncle  Sam  Needs  Watching,  Too”,  published  in  Business  Week  Online,  29
November  2001.    See  also:  Weinstein,  L.  and  Neumann,  P.G.,  “PFIR  Statement  on
Government Interception of Internet Data”, published by People for Internet Responsibility
(PFIR), dated 7 September 2000. 
Development of a Legal Framework for Intrusion Detection         145
definitions of traffic data, which has potentially significant implications with respect
to  data  retention.    The  difficulty  comes  in  separating  addressing  information  from
content, given that both travel together in network packets.  Even configuring IDS to
log  only  the  header  portion  of  the  packets  does  not  adequately  address  this
shortcoming  –  IDS  must  still  ‘intercept’  the  entire  packet  in  order  to  scan  it  for
indications of malicious traffic.
There  seems  to  be,  at  least  in  certain  legislation,  a  definite  effort  to  distinguish
between  ‘traffic’  data  and  content.    For  example,  the  Council  of  Europe  (COE)
Convention on Cybercrime refers to interception and real-time access to traffic data.19
United States Code (criminal law) contains provisions for the use of pen registers and
trap and trace devices.  These devices are capable of monitoring and identifying the
specific phone numbers dialed from a particular telephone line - they do not capture
or  record  the  content  of  any  such  communication.20  That  certain  legislation
distinguishes  between  traffic  data  and  content  implies  that  traffic  data  is  not
considered to be private communications.21 
If the originator wants to disguise the fact that they initiated a particular message
(e.g. a web session), then he/she has the option of using pseudonymizing techniques.
At the very least, the use of these techniques would increase the expectation on the
part of the originator that his/her communication will be private, and therefore would
be subject to the relevant provisions of criminal or anti-terrorism law.  However, even
this is not definitive as many of these techniques provide a mechanism for associating
the  pseudonymized  communication  with  a  particular 
in  certain
circumstances.22  Even the use of anonymizing techniques might not be sufficient to
address this issue – if the disclosure of encryption keys can be forced, could providers
of anonymizing services be forced by law to retain sufficient records to re-associate
anonymized traffic with the originator?
individual 
19 (COE) Convention on Cybercrime (ETS 185), Title 5, Article 20.  Article 21 deals separately
with the interception of content data.
20 (US) US Code, Title 18, Part II, Chapter 206, Sections 3127(3) and (4).  Pen registers  are
devices  that  identify  the  numbers  dialed  or  otherwise  transmitted  on  the  telephone  line  to
which  such  device  is  attached.    Trap  and  trace  devices  are  devices  which  identify  the
originating  number  of  an  instrument  or  device  from  which  a  wire  or  electronic
communication was transmitted.  See also: (US) An Act to deter and punish terrorist acts in
the United States and around the world, to enhance law enforcement investigatory tools, and
for other purposes, dated 26 October 2001 (Uniting and Strengthening America by Providing
Appropriate Tools Required to Intercept and Obstruct Terrorism (USA PATRIOT ACT) Act
of 2001) (hereinafter USA PATRIOT Act).  The USA PATRIOT Act amends US Code Title
18, Part II, Chapter 206, Section 3127(3) and (4) to refer to recording or decoding dialing,
routing,  addressing  or  signaling  information,  but  not  including  the  contents  of  such
communication. 
21 Lee, S.C. and Shields, C., “Tracing the Source of Network Attack: A Technical, Legal and
Societal Problem”, published in the proceedings of the 2001 IEEE Workshop on Information
Assurance and Security, pages 239 – 246.  This is at least the case in the U.S.  In their paper,
the authors state “legally, there is no expectation of privacy for packet headers” (page 245). 
22  For  a discussion  of  the use  of pseudonymization  techniques  to  enhance  the  expectation  of
privacy  in  network  communications,  see  Johnston,  Steven  R.,    “The  Impact  of  Recent
Privacy and Data Protection Legislation on the Sharing of Intrusion Detection Information”.
In W. Lee, L. Me, A. Wespi (Eds.), Proceedings of Recent Advances in Intrusion Detection
2001 (RAID 2001), pgs. 150 – 171, Springer-Verlag, Berlin Heidelberg, 2001.
146         S.R. Johnston
What expectation of privacy does an individual involved in malicious activity have
–  do  they  forfeit  any  expectation  of  privacy  with  respect  to  those  activities?
According  to  provisions  in  the  USA  PATRIOT  Act,  a  computer  trespasser  is  “a
person  who  accesses  a  protected  computer  without  authorization  and  thus  has  no
reasonable  expectation  of  privacy  in  any  communication  transmitted  to,  through  or
from the protected computer.”23  In any event, expectations of  privacy are  probably
considerably  different  in  each  case.    Whatever  the  expectations,  IDS  are  not
sufficiently discriminating to distinguish between malicious activity (which should be
monitored and logged) and benign activity (the privacy of which should be respected).
If the above analysis is correct, then the header portions of communications over
the Internet would probably not be considered private. This distinction may prove to
be important when interpreting the legislation in particular, and in configuring IDS to
conform  to  the  law.    What  exactly  are  the  relevant  provisions  of  criminal  and  anti-
terrorism? How do organizations use IDS in a lawful manner?
5   Criminal Law
Criminal  law  generally  prohibits  the  intercept  of  private  communications.  For
example,  the  Criminal  Code  states:  “every  one  who,  by  means  of  any  electro-
magnetic,  acoustic,  mechanical  or  other  device,  willfully  intercepts  a  private
communication  is  guilty  of  an  indictable  offence”.24    Electro-magnetic,  acoustic,
mechanical or other device includes any device or apparatus that is used or is capable
of  being  used  to  intercept  a  private  communication.25    Intercept  includes  “listen  to,
record  or  acquire  a  communication  or  acquire  the  substance,  meaning  or  purport
thereof”.26
It is important to note that an IDS is a computer in its own right, with a processor,
primary and secondary storage, and input/output elements.  The input element is the
interface to the network, typically a network interface card (NIC) designed to IEEE
802.x standards.  This interface operates in promiscuous mode, and it ‘captures’ every
well-formed link-level frame – the format for the transmission of IP datagrams across
a network.  Once they have been ‘captured’ by the NIC, a copy of the frames and their
contents (i.e. the information they contain) are placed in the sensor’s primary memory
for  analysis.  Even  if  the  IP  datagrams  are  eventually  discarded  (because  they  are
deemed to be legitimate traffic), the IDS is in fact copying all of the network traffic.
23 (US) USA PATRIOT Act of 2001, dated 26 October 2001, section 217.  This section amends
US Code, Title 18, Part I, Chapter 119, Section 2510 by adding a new subsection 2510(21)
containing the definition of a computer trespasser.  None of the other legislation contains a
statement of this nature.
24  (CA)  Criminal  Code,  section  184(1). 
  Similar  offences  exist  under:  (AU)  The
Telecommunications (Interception) Act 1979), Section 7(1); (US) US Code Title 18, Part I,
Chapter 119, Section 2511(1); and (UK) RIPA 2000, Part I, Sections 1(1) and 1(2). 
25 (CA) Criminal Code, section 183.  See also: (AU) Telecommunications (Interception) Act of
1979, Section 5(1); (US) US Code, Title 18, Part I, Chapter 119, Section 2510(5); and (UK)
RIPA 2000, Part V, Section 81(1)
26 (CA)  Criminal  Code, section  183.    See  also:  (AU)  Telecommunications  (Interception)  Act
1979,  Section  6;  (US)  US  Code  Title  18,  Part  I,  Chapter  119,  Section  2510(4);  and  (UK)
RIPA 2000, Part I, Section 2(2).
Development of a Legal Framework for Intrusion Detection         147
For the purposes of criminal law, is it essential that packet contents be intercepted,