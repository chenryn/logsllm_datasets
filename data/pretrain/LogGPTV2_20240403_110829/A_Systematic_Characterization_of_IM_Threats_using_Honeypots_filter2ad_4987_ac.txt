while 26% were collected the same day they
entered the VirusTotal database.
Figure 7. Cumulative distribution function of
detection rate for collected samples based
on VirusTotal reports. 42% of the samples
were detected by 50% of the anti(cid:173)virus en(cid:173)
gines.
detected the same day as VirusTotal while the top bar
shows the number of samples not included in the Virus-
Total database. Five samples (26%) were collected the
same day they entered the VirusTotal database, while the
maximum detection delay was ﬁve days.
We also checked the VirusTotal analysis reports for
the collected samples. 42% of the samples were detected
by half of the anti-virus engines, while the maximum de-
tection rate was 77%. However, the dates of the analysis
reports were one month after the collection date as we
did not submit the samples the day they were captured.
The one month delay means higher detection rates for
the anti-virus engines as they update their signature ﬁles
daily. Even in that case, it can be observed that there are
samples that are recognized by only one third of the anti-
virus products. The cumulative distribution function of
detection rates can be seen in Figure 7.
5.3 Mailbox analysis
In this section we present an analysis of the emails
we found in the mailboxes of our decoy accounts. Our
analysis focuses on two aspects of the incoming emails.
First, whether the body of the email contains any URLs
and, second, whether the email contains any attach-
ments. The decoy accounts received a total of 4,209
emails, 403 of which contained a total of 1,136 at-
tachments. The emails contained 5,581 URLs which
were passed to our classiﬁer. The goal of the classiﬁ-
cation was to only identify phishing URLs and URLs
that downloaded malware. 26 of the received URLs be-
longed to phishing domains while 7 downloaded mal-
ware samples.
While the majority of the attachments were pictures,
several were windows media ﬁles and ofﬁce documents.
We checked the VirusTotal database for the MD5 hashes
of the ﬁles but found no matches. This was expected,
since hotmail scans incoming emails for malware and
blocks executables. The most interesting attachments
were two “.zip” ﬁles. Once extracted, the zip ﬁles re-
turned a “.lnk” ﬁle. Upon inspection, we found that the
ﬁles were command line scripts that connect to an FTP
site and download and execute malicious software. For
a more detailed analysis of the ﬁle refer to this report by
F-Secure [9].
5.4 Comparison to email spam
An important aspect of IM based attacks that we
wanted to explore was whether they are scams that
use other commmunication channels as well or if they
are unique to this attack medium.
In particular, we
wanted to explore similarities between the campaigns
collected by HoneyBuddy and scams that propagate
through emails that are collected by spam traps. We ob-
tained 458,615 spam emails collected by Spam Archive
[19] from the 27th of February to the 16th of September
2009. From these emails we extracted 467,211 unique
URLs that belonged to 52,000 unique TLDs. We com-
pared them to our 6,966 unique URLs and found only
one common instance of a well-known benign website.
This result was expected since URLs in IM attacks usu-
i
s
n
a
m
o
d
/
s
e
s
s
e
r
d
d
a
P
I
f
o
#
130
110
90
70
50
30
20
10
21
26
31
05
10
20
25
30
04
09
15
AUG
Date
i
s
n
a
m
o
d
/
s
e
s
s
e
r
d
d
a
P
I
f
o
#
23
22
21
20
19
18
17
16
15
21
26
31
05
10
20
25
30
04
09
15
AUG
Date
Domains
IP addresses
Domains
IP addresses
Figure 8. Number of distinct phishing do(cid:173)
mains and the IP addresses they resolve to
over time.
Figure 9. Number of distinct malware(cid:173)
distributing domains and the IP addresses
they resolve to over time.
ally contain the target’s username. Next, we compared
the unique TLDs and found 21 common domains, 9 of
which were popular and benign domains. From the 12
suspicious domains, 3 were classiﬁed as porn, 3 hosted
malware, 2 were for dating, 1 was for adware and 3 were
not assigned to a known category. None of the common
TLDs hosted msn phishing scams, the prevalent threat of
IM networks. Therefore, we can conclude that attackers
have crafted scams speciﬁc to this new attack medium
that are fundamentally different to existing email spam
campaigns.
The results of this comparison are a strong indication
that scams that propagate through IM networks are new
campaigns and not email spam campaigns that utilized
a new attack channel. They present their own unique
properties that differentiate them from traditional scams
that propagate through spam emails.
5.5 Comparison to commercial anti(cid:173)phishing
product
Multiple anti-virus vendors provide software prod-
ucts designed to protect users from malicious sites. To
verify whether the URLs we collect have already been
seen by large vendors that offer anti-phishing products,
we evaluated our URLs using such a service. We used
the Norton Safe Web service [13] provided by Symantec
[23], where users can submit a URL and receive a re-
port that contains information regarding possible threats
from the speciﬁc website. We submitted the 2,010
phishing and malware URLs collected by our infrastruc-
ture after the collection period. Submitting the URLs af-
ter the collection period and not each URL individually
upon collection, results in a potentially higher detection
rate for the Norton Safe Web service. Even so, Nor-
ton Safe Web ﬂagged only 13% of the submitted URLs
as dangerous or suspicious. Speciﬁcally, 246 phishing
and 10 malware-distributing URLs were reported as ma-
licious while all other pages were characterized as safe.
That means that over 87% of the malicious URLs col-
lected by HoneyBuddy had not been properly catego-
rized as dangerous by one of the largest security ven-
dors.
6 Hosting analysis
The fact that all the top-level domains of the URLs
collected from our initial experiment translated to a very
small number of IP addresses, urged us to conduct a
new experiment that might reveal more information. For
a period of 50 days during July and August of 2009,
we periodically ran nslookup[14] for each of the unique
top level domains our system had collected up to that
moment, in order to gather more information regarding
how and where attackers host phishing and malware-
distributing domains. Here we present the results for
each category of domains separately and highlight their
particular behaviour.
The experiment gave us further insight in regards to
the small number of IP addresses that host a multitude of
phishing campaigns. All top level domains translated to
one or two IP addresses, while 98% of them translated
to only one. Furthermore, ten of the top level domains
belonged to fast-ﬂux networks and translated to a differ-
CA
(4.0%)
CN
(13.0%)
CA
(4.76%)
DE
(4.76%)
NL
(4.76%)
US
(22.5%)
PA
(13.0%)
FR
(13.0%)
GB
(8.5%)
HK
(26.0%)
US
(85.72%)
Figure 10. Breakdown of countries that host
the phishing domains.
Figure 11. Breakdown of countries that host
the malware(cid:173)distributing domains.
ent set of IP addresses each time. In Figure 8 we can
see that during the ﬁrst days of the experiment, all 101
top-level domains translated to only 14 different IP ad-
dresses. The TLDs that belonged to fast-ﬂux networks
are excluded from the graphs. This behaviour is con-
sistent throughout the duration of the experiment and as
new domains were added only a small number of new
unique IP addresses appeared.
Next we wanted to track down the country where the
domains were hosted. We used the MaxMind 4 database.
In Figure 10 we can see the breakdown of the percent-
ages of the countries that hosted the top level domains.
Honk Kong ranks ﬁrst hosting 26% of the domains,
while the United states follow with 22%. A surprising
result is that only 13% of the domains were hosted in
China, which is quite lower than what we would expect
based on reports [21].
Next we present the results from the experiment re-
garding domains that distribute malware. Our initial
goal was to investigate whether the top level domains of
the malware-distributing websites also translate to only
a small number of IP addresses.
In Figure 9 we present the results from this exper-
iment. We can see that in the case of the URLs that
contain malware, the top level domains translated to dif-
ferent IP addresses. Unlike the phishing domains, here
each top level domain translated to a different IP ad-
dress, and only one to three IP addresses overlapped at
4http://www.maxmind.com/app/geolitecity
each moment in time. The IP address that hosted three
malware-distributing domains also hosted one of the
phishing domains and was located in the United States.
None of the other IP addresses hosted both a malware-
distributing and a phishing domain. The nslookup oper-
ation for all the top level domains returned only one IP
address, and only one of the domains belonged to a fast-
ﬂux network pointing to a different address each time.
Since the IP addresses that host phishing domains are
more likely to be blacklisted, this result is not surpris-
ing. Another interesting fact is that none of the top level
domains is in both of the sets, meaning that none of the
domains hosted a phishing site and simultaneously dis-
tributed malware.
Similarly to the phishing domains, we wanted to trace
the country where the malware-distributing domains
were hosted. In Figure 11 we can see the breakdown
of the percentages of the countries. The United States
were responsible for hosting the majority of the domains
that distribute malware through IM trafﬁc, reaching al-
most 86%. The remaining three countries, Canada Ger-
many and the Netherlands, hosted an equal amount of
domains. Once again, it is surprising that China did not
host any of the domains caught by our infrastructure.
7 Attacker proﬁle
In this section we present statistics and observations
in an effort to outline the behaviour of IM attackers and
recognize different strategy patterns.
600
500
s
t
n
u
o
c
c
a
d
e
s
m
o
r
p
m
o
c
f
i
400
300
200
o
#
100
0
Mar−01−2009 Apr−01−2009 May−01−2009 Jun−01−2009 Jul−01−2009
s
t
n
u
o
c
c
a
i
d
e
s
m
o
r
p
m
o
c
f
o
%
100
90
80
70
60
50
40
30
20
10
0
1
2
4 5
10
20
50
100
200
300
1000
Date
Number of URLs sent
Figure 12. Number of compromised accounts
that contacted our decoy accounts over time.
Figure 13. CDF of the number of URLs sent
by compromised accounts to our decoy ac(cid:173)
counts.
First of all, in Figure 12 we present the number of
unique compromised accounts that had sent URLs to
our decoy accounts over time. We can see that the plot
line follows a sub-linear curve, with almost 100 new ac-
counts contacting us each month. This indicates that
over time legitimate users still follow malicious URLs
sent by compromised “buddies” and in turn get infected
too.
In Figure 13 we can see the CDF plot of the number
of URLs sent by each compromised account to our in-
frastructure throughout the duration of the experiment.
One should note that approximatelly 25% of the com-
promised accounts sent only one URL and 40% up to
two URLS. Based on the numbers we can identify one
possible strategy that attackers choose to follow.
Eventhough some of these accounts/hosts may have
been dis-infected before sending us another URL, it is