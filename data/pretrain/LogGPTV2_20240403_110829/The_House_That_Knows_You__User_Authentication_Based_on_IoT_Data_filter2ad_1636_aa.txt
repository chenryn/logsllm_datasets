title:The House That Knows You: User Authentication Based on IoT Data
author:Talha Ongun and
Alina Oprea and
Cristina Nita-Rotaru and
Mihai Christodorescu and
Negin Salajegheh
9
1
0
2
g
u
A
7
]
R
C
.
s
c
[
3
v
2
9
5
0
0
.
8
0
9
1
:
v
i
X
r
a
The House That Knows You:
User Authentication Based on IoT Data
Talha Ongun
Northeastern University
PI:EMAIL
Cristina Nita-Rotaru
Northeastern University
PI:EMAIL
Oliver Spohngellert
Northeastern University
PI:EMAIL
Mihai Christodorescu
Visa Research
PI:EMAIL
Alina Oprea
Northeastern University
PI:EMAIL
Negin Salajegheh
Visa Research
PI:EMAIL
ABSTRACT
Home-based Internet of Things (IoT) devices have gained
in popularity and many households became “smart” by us-
ing devices such as smart sensors, locks, and voice-based
assistants. Given the limitations of existing authentication
techniques, we explore new opportunities for user authenti-
cation in smart home environments. Specifically, we design a
novel authentication method based on behavioral features ex-
tracted from user interactions with IoT devices. We perform
an IRB-approved user study in the IoT lab at our university
over a period of three weeks. We collect network traffic from
multiple users interacting with 15 IoT devices in our lab and
extract a large number of features to capture user activity.
We experiment with multiple classification algorithms and
also design an ensemble classifier with two models using
disjoint set of features. We demonstrate that our ensemble
model can classify six users with 86% accuracy, and five users
with 97% accuracy.
1 INTRODUCTION
User authentication is one of the major challenges in se-
curity, and while a diverse set of solutions have been pro-
posed, the quest for the perfect solution continues. Tradi-
tional user authentication methods include passwords, hard-
ware tokens, and biometrics. Given the limitations of pass-
words [13, 19, 29] several well-known techniques are used in
practice to augment them such as multi-factor authentication
based on either a hardware token or a different channel (e.g.
email, SMS). These methods impede the usability of authenti-
cation, and introduce additional latency [10, 26]. Biometrics-
based authentication has been extensively used in various
forms (facial recognition, fingerprints, or retina scans), but
revocation and user impersonations are well-recognized lim-
itations of these methods.
The omnipresence of IoT devices such as sensors, locks,
entertainment devices, and voice-based personal assistants,
has made authentication in smart households more complex,
bringing new challenges. IoT devices are fundamentally dif-
ferent from personal devices and traditional authentication
methods are either not applicable or break the natural flow
of interaction with these devices. Deploying a screen or in-
put pad for each of these devices is either not practical or
costly. Some devices such as Amazon Echo Dot can perform
voice-based biometric authentication as an optional feature.
However, this feature can be circumvented as voice can be
spoofed and users might not be comfortable with their voices
being recognized due to privacy concerns [21]. Therefore,
better authentication methods are needed in the context of
smart homes.
One of the opportunities in solving this problem in smart
home environments is the relatively small number of users
for which authentication must be provided. Most American
households range in size from two to six members. Multi-
class classification algorithms can be trained for such small
sets and with minimal effort it can be ensured that adver-
saries do not interfere at training time. However, there are
several challenges in designing user authentication methods
for household IoT devices including: supporting a diverse set
of devices with minimal changes in their operation, main-
taining user privacy, and supporting a diverse set of policies.
Data that captures detailed user behavior (such as device
logs) tend to be device-specific and more invasive in terms
of privacy.
Our approach addresses these challenges by using the
IoT devices’ network traffic from the home router as data
source. In order to preserve user privacy we collect and
leverage the information in the headers of HTTPS packets
for our authentication system. This data includes minimal
information (timing, ports, bytes sent and received) with low
risk on user privacy. Additionally, to protect user privacy we
make the design choice of performing the model training
and testing locally in the user’s home, rather than remotely,
in the cloud. This implies that the authentication module
needs to reside in the smart home. To address the mis-match
between user-level semantics and network-level semantics
we observe the network traffic for a continuous time window
and design a machine learning (ML) model that uses features
aggregated over a recent time window to predict the user in
the room. Finally, we train a multi-class classifier to predict
the likelihood that a certain user is in the room. The model
is trained based on historical data obtained in controlled
settings (knowing which user is in the room) and then used
at testing time to classify users by generating in real time
an authentication score based on the most recent observed
activity.
We leverage the IoT lab at our institution set up as a stu-
dio apartment and purchase a set of 15 IoT devices from
different categories, including voice assistants, smart kitchen
appliances, and entertainment devices. We make use of the
existing monitoring infrastructure in the lab to collect net-
work packets (pcap files) from all these devices. We design
an IRB-approved user study with multiple users participat-
ing in data collection over a period of three weeks. During
the training period, we use labeled data of user sessions and
extract features from HTTPS headers that capture user inter-
action with the IoT devices over a continuous time window.
We design and test several ML classification algorithms for
predicting the likelihood that a certain user is in the room.
During the regular user interaction with the IoT devices, the
authentication module continuously receives data extracted
from the most recent observation window and computes an
authentication score for each user. The score is made avail-
able to upper-level authorization systems that can implement
flexible policies according to the level of risk tolerated. For
example, these policies can be used for local services such
as log in to a laptop, to perform operations on IoT devices,
or to access cloud services, such as performing financial
transactions.
Our experimental evaluation shows that a Gradient Boost-
ing classifier achieves 81% precision and 80% recall at classi-
fying six users, based on IoT device features. For five users
the precision and recall are both 92%, for a 25-minute obser-
vation window. We also design a high-confidence ensemble
classifier with two models trained on disjoint set of features
(one on 420 device features and the second on 2910 domain
features). The ensemble generates an authentication score
only when the two models agree on the prediction. An en-
semble of two Gradient Boosting models achieves an F1 score
of 0.86 for six users and 0.97 for five users (at the cost of not
generating scores in 16 out of 91 sessions).
The rest of the paper is organized as follows. We define our
problem and adversarial model in Section 2. We describe our
system design in Section 3 and our user study and data collec-
tion in Section 4. We present the evaluation in Section 5 and
related work in Section 6. We conclude the paper in Section
7 and include some additional results in the Appendix.
2 PRELIMINARIES AND BACKGROUND
In this section we provide an overview of methods for user
authentication, we define the problem we are solving, and
describe the adversarial model we consider in this work.
2.1 User Authentication
User authentication is a fundamental security process that
has been studied extensively throughout the years. Tradi-
tional user authentication methods are based on what users
know (e.g. passwords), what they have (e.g. hardware token),
or what they are (e.g. biometrics). Even though extensive
research shows password limitations [13, 19, 29], passwords
are still the de-facto standard for authentication in corporate
and home environments. Users are shown to pick weak pass-
words and they tend to reuse them across different services
[3]. Critical services do not always deploy proper password
data protection techniques, resulting in increased risk for
users in face of data breaches [1]. Several well-known tech-
niques are used in practice to augment passwords. Multi-
factor authentication methods use either a hardware token
or a different channel (e.g. email, SMS) for increasing the
confidence of authenticating users. These methods impede
the usability of authentication, and introduce additional la-
tency [10, 26]. Biometrics-based authentication such as key-
stroke dynamics, fingerprints, facial recognition, and voice
recognition, provide a convenient and reliable way to iden-
tify users [7, 20, 30]. However, revocation and user imper-
sonation are well-known challenge for these methods, in
addition to privacy implications on users [31].
Behavior-based authentication provides a safer and more
convenient way to identify users, based on their behavior,
how they behave. Such methods build behavioral models
based on the unique way the users interact with devices like
smartphones, tablets or touch screens. In the context of mo-
bile devices, several systems for continuous authentication
have been designed, for instance [23, 25]. They leverage a
number of behavior features extracted from user interaction
with their mobile devices, such as call logs, browser history,
application usage, and location. User authentication based
on WiFi signal of IoT devices has been also investigated
recently [24]. These systems can be used in a multi-factor
authentication system to additionally increase confidence of
user authentication.
2.2 Problem Definition
With the widespread usage of IoT devices in many house-
holds, new challenges and opportunities emerge. We pose for
the first time the problem of designing usable, behavioral-based
authentication models based on users naturally interacting
with IoT devices in their homes or familiar environments. We
2
are interested in designing a lightweight authentication mod-
ule for smart homes that uses information extracted from
monitoring the user interaction with IoT devices. The system
should be able to identify with high accuracy each user from
a fixed set of known users based on their behavioral char-
acteristics. With user privacy as the premiere consideration
in our design, we intend to leverage a minimum number of
attributes that are universally applicable to a range of IoT de-
vices from different manufacturers. We consider here mainly
authentication based on behavioral features extracted from
network traffic generated by IoT devices in a smart home.
We envision such a system would learn from historical ob-
servations and create user profiles during a training phase.
At testing time, the authentication module generates an au-
thentication score mapped to the likelihood that a certain
user is in the room based on the most recent observation
of IoT device activity. The authentication module needs to
observe users during a contiguous observation window to
capture a sequence of user actions. The authentication scores
can be used by higher-level applications to create flexible
authorization policies that support various levels of risk.
2.3 Adversarial Model
We consider two main classes of adversaries:
Local adversaries. This adversary might be in close proxim-
ity or even inside the home environment, and interact with
some of the IoT devices in the home. This model captures
visitors, neighbors, kids, or roommates sharing the home. We
would like to prevent such an adversary to perform actions
like changing smart lock settings or making purchases on
Alexa on behalf of real users.
Remote adversaries. Remote adversaries might not directly
have access to IoT devices, but they could compromise user
machines and accounts leveraging potential vulnerabilities
in the user devices. This adversary is motivated to imper-
sonate the real user to gain access to sensitive devices in
the home or perform more harmful actions. Remote attack-
ers can also inject network traffic in the smart home. This
is possible by a malicious app installed on a user’s smart
phone, or an adversary sending traffic to the home router.
The adversary is aware of standard network protocols and
applications, but he does not have full knowledge on the
exact user behavior.
We assume that adversaries are not in the system when
ML training is performed. A training-time attack against ML
models is called a poisoning attack (e.g., [6, 27, 32]) and pro-
tecting against it is orthogonal to our work. This guarantees
that the trained ML models for user authentication are trust-
worthy. Both types of adversaries might act at testing time
with the goal of influencing the decision of the ML model. We
assume that adversaries have relatively limited interaction
3
with the IoT home devices and they cannot perfectly imitate
users in their behavior.
We envision that data collection and the authentication
module reside in a trusted device, like the home router or a
server. Compromising the authentication system by physi-
cally accessing it or by intercepting the communications is
not within our scope.
3 SYSTEM DESIGN
In this section we describe the goals motivating the design
of our system and then give an overview of our approach.
3.1 Design Goals
In designing our system for user authentication in smart
homes, we set forward the following design goals:
Operate in a smart home environment with multiple
users. We intend our system to be used in a smart home
environment with several users actively interacting with
diverse IoT devices. The average American household size in
2018 was 2.53, with most households (98.66%) having size at
most 6. Our system should provide good accuracy at the task
of classifying users from a small set of previously seen users.
Multi-class classifiers can be trained to predict the likelihood
that a certain user is in the room.
Support multiple heterogenous IoT devices. Compared
to traditional computing platforms, IoT devices are extremely
heterogeneous and diverse. This raises the challenge of de-
signing a flexible, general monitoring platform that can sup-
port devices from different manufacturers and can be easily
extended as new devices become available. Data available
usually consists of event logs and network traffic. We ob-
serve that network traffic is much more general and more
likely to support the diversity of IoT devices.
Maintain user privacy. User privacy is an important design
consideration, given the nature of the applications and the
environment where users perform their actions. We intend
our system to work without access to user personal identifi-
able information (PII). Most network traffic of IoT devices
is over HTTPS, with encrypted payloads in the transmitted
packets.
Capture user actions for behavioral modeling. User be-
havior is defined by their interaction with the devices and
the applications. User (and application) behavior results in
several packets disseminated over the network. An approach
based on more general information, like network traffic,
needs to map low-level information from network pack-
ets to higher-level user actions (for instance, brew a coffee
or change the smart lock settings) in order to capture user
behavior. This creates a challenge as a single action could
generate many packets addressed to different external desti-
nations.
Measure authentication confidence. Most systems for ac-
cess control and authorization need to make an ultimate
decision whether a user is allowed to access a critical re-
source or not. Our goal is to create an authentication service
that generates authentication scores on a continuous basis.
These scores should provide a measure of authentication
confidence, which is leveraged by higher-level authorization
systems. For instance, to perform a high-value financial trans-
action, the authorization system could set the authentication
score threshold at 0.95 and require another authentication
factor (such as SMS). We believe that reliable authentica-
tion measures as we aim to design can greatly augment the
flexibility of current authorization systems.
3.2 System Overview
Our Approach. We address the challenges raised by our
design goals by using the IoT devices’ network traffic from
the home router. In order to preserve user privacy we collect
the headers of the HTTPS packets that include minimal in-
formation such as timing, ports, destination address, bytes
sent and received, posing low risk on user privacy. Addi-
tionally, to protect user privacy we make the design choice
of performing the model training and testing locally in the
user’s home, rather than remotely, in the cloud. This implies
that the authentication module needs to reside in the smart
home. To address the mis-match between user-level seman-
tics and network-level data we observe the network traffic for
a continuous time window and design an ML model that uses
features aggregated over a recent time window to predict
the user in the room. Finally, we train a multi-class classifier
to predict the likelihood that a certain user is in the room
based on the most recent activities.
Figure 1 gives an overview of our system architecture. We
installed 15 IoT devices in the IoT lab at our institution. We
make use of the existing monitoring infrastructure in the
lab to collect pcap files from all these devices. We design an
IRB-approved user study with multiple users participating
in data collection over a period of three weeks. During the
training period, we use labeled data of user sessions and
extract features from HTTP headers over a continuous time
window (with varying length). We design and test multiple
ML classification algorithms with the aim of obtaining good
accuracy at identifying users. During the regular user in-