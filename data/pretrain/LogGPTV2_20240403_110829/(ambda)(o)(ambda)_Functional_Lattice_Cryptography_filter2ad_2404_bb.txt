2In brief: the fastest known quantum algorithms for the poly(ğ‘›)-approx-SVP problems underlying many
cryptographic constructions, in any class of rings covered by the hardness theorems, perform essentially no
better than algorithms for arbitrary lattices of the same dimension ğ‘›, and take at least exponential 2Î©(ğ‘›) time.
Under plausible number-theoretic conjectures, 2ğ‘‚(
ğ‘› log ğ‘›)-approx-SVP is solvable in quantum polynomial
time in certain rings, such as prime-power cyclotomics and their maximal totally real subrings [Cra+16;
CDW17]; however, the main algorithmic technique used in these works meets a barrier at 2Î©(
ğ‘›/ log ğ‘›)-factor
approximations [Cra+16, Section 6].
âˆš
âˆš
201
of parameterizations and conjectured security levels, ranging from â€œtoyâ€ to â€œvery hardâ€
(see subsection 7.1.1 for details). We hope that these challenges will provide a focal point
for theoretical and practical cryptanalytic effort on Ring-LWE/LWR, and will help to more
precisely quantify the concrete security of their instantiations.3
A central issue in the creation of challenges for problems like (Ring-)LWE is that a
dishonest challenger can publish instances that are much harder to solve than honestly
generated onesâ€”or even impossible. This is because (properly instantiated) Ring-LWE
is conjectured to be pseudorandom, so it is difï¬cult to distinguish between a correctly
generated challenge and a harder one with much larger errors, or even a uniformly random
one, which has no solution. A dishonest challenger could therefore publish unsolvable
challenges, and point to the absence of breaks as bogus evidence of hardness.4
To deal with this issue, we design and implement a simple, non-interactive, and publicly
veriï¬able â€œcut-and-chooseâ€ protocol that gives reasonably convincing evidence that the
challenge instances are properly distributed, or at least not much harder than claimed. In
short, for each Ring-LWE/LWR instantiation the challenger announces many timestamped
instances. At a later time, the challenger reveals the secrets for all but a random one of the
instances, as determined by a publicly veriï¬able source of randomness. (Concretely, we use
the NIST randomness beacon [11].) Anyone can then verify that all the revealed instances
look â€œproper,â€ which makes it likely that the remaining instance is proper as well. Otherwise,
the challenger would have had been caught with rather larger probabilityâ€”assuming, of
course, that it cannot predict or inï¬‚uence the randomness source. See section 7.2 for further
details and discussion of some potential alternatives, which turn out not to give the kind
3The challenges and their parameters can be obtained via the Ring-LWE challenges website [16]. The
archive rlwe-challenges-v1.tar.gz contains challenges for 516 different instantiations, and has a SHA-
256 hash value 07cd f744 5c9d 178c 8b13 5a42 47ca a143 5320 c104 8ee8 c634 8914 a915 5757
dcef. All our challenge-related archives are digitally signed under the PGP/GPG public key having ID b8b2
45f5, which has ï¬ngerprint 8126 1e02 fc1a 11c9 631a 65be b5b3 1682 b8b2 45f5.
4This appears qualitatively different from problems like integer factorization and discrete logarithms, where
deviating from the prescribed distributions seems like it can only make challenges easier to solve, or at least
no harder.
202
of guarantees we desire. See subsection 7.1.2 for discussion of a recent approach to LWE
challenges that aims for different goals.
Search versus decision. We stress that our challenges are for search versions of Ring-
LWE/LWR, whereas many cryptographic applications rely on the conjectured hardness of
solving decision with noticeable advantage. Unfortunately, it appears impractical to give
meaningful challenges for the latter regime. This is because detecting a tiny advantage
requires a very large number of instances, and a corresponding increase in effort by the
attacker. And even for relatively large advantages, the naÃ¯ve method of conï¬rming the
solutions would require the challenger to retain the correct answers and honestly compare
them to the attackerâ€™s, because the attacker cannot conï¬rm its own answers (unlike with the
search problem, where it can).5
Nevertheless, we gain conï¬dence in the usefulness of search challenges from the fact that
the known classes of attack against decision either proceed by directly solving search, or can
be adapted to do so with relatively little or no extra overhead. (See [LP11; LN13; Alk+16].)
In addition, there are search-to-decision reductions [LPR13b, Section 5] which provide
evidence that decision cannot be much easier than search (though the known reductions
incur some as-yet unoptimized overhead). Finally, we note that practical constructions of,
e.g., key exchange as in [Bos+16a] can use â€œhashedâ€ variants, for which hardness of search
can be sufï¬cient for a reductionist security analysis in the random oracle model.
Implementation. Our free and open-source challenge generator and veriï¬er are imple-
mented using Î›âˆ˜ğœ†. We rely on its support for arbitrary cyclotomics and sampling from the
theory-recommended Ring-LWE distributions that are needed for our instantiations (see
subsection 7.1.1 for details). To encourage participation, we stress that all the challenge
5We considered more sophisticated non-interactive methods for conï¬rming answers, like using a â€œfuzzy
extractorâ€ [Dod+08] to encrypt a secret that can only be recovered by solving a large enough fraction of
decision challenges. Such methods seem tantalizing, but are complex to implement and bandwidth-intensive
in our setting, so we leave this direction to future work.
203
data is formatted using Googleâ€™s platform- and language-neutral protocol buffers (protobuf)
framework [Goo08]. This allows the challenges to be read using most popular program-
ming languages, via parsers that are automatically generated from our protobuf message
speciï¬cations. The Ring-LWE challenges website [16] contains auto-generated parsers, and
simple examples demonstrating their use, in C++, Java, Python, and Haskell. (The protobuf
speciï¬cations can be found in [CP16a], and with the challenges themselves.) In addition,
Î›âˆ˜ğœ† includes C++ code for cyclotomic ring operations, which can be used by alternative
implementations written in other languages.
7.1.1 Challenge Instantiations
Our challenge instantiations cover a wide range of parameters for several aspects of the
Ring-LWE/LWR problems, including: size and form of the cyclotomic index and corre-
sponding dimension; width of the error distribution; size and arithmetic form of the modulus;
and number of samples. Each of these parameters has some degree of inï¬‚uence on the
conjectured hardness of a Ring-LWE instantiation, as we discuss below.
For each challenge instantiation we give a qualitative hardness estimate, ranging from
â€œtoyâ€ and â€œeasyâ€ to â€œvery hard,â€ along with an approximate block size that should allow the
Block Korkin-Zolotarev (BKZ) basis-reduction algorithm to solve the instantiation. (See
section 7.4.) We intentionally do not estimate concrete â€œbits of securityâ€ (though BKZ block
size is a useful proxy), since any such estimates would necessarily be very imprecise. We
hope that real-world efforts to break the challenges will provide more precision.
The easier categories represent instantiations that should be breakable using standard
lattice algorithms on desktop-class machines in somewhere between a few minutes and
a few months, whereas the hardest category should be out of reach even for nation-state
adversariesâ€”based on the current state of public cryptanalysis, at least. We deduce our
hardness estimates by approximating the Hermite factors and BKZ block sizes needed to
204
solve the instantiations via lattice attacks, which usually represent the most practically
efï¬cient attacks against Ring-LWE/LWR. See section 7.4 for further details.
Cyclotomic Ring
A primary parameter inï¬‚uencing Ring-LWEâ€™s conjectured hardness is the degree (or di-
mension) of the ring ğ‘…, which in the cyclotomic case is the totient ğ‘› = ğœ™(ğ‘š) of the index
(or conductor) ğ‘š. Thus far, most implementations have used two-power cyclotomic rings,
because they have the computationally and analytically simplest form ğ‘… âˆ¼= Z[ğ‘‹]/(ğ‘‹ ğ‘› + 1),
where ğ‘› is a power of two. Moreover, sampling from a spherical Gaussian in their â€œcanonicalâ€
geometry is equivalent to sampling independent identically distributed Gaussian coefï¬cients
for the powers of ğ‘‹.
We believe that Ring-LWE over non-two-power cyclotomics is deserving of more
cryptanalytic effort. First, powers of two are rather sparse, especially in the relevant range
of ğ‘› in the several hundreds or more. In addition, two-power cyclotomics are incompatible
with some advanced features of homomorphic encryption schemes, such as â€œplaintext
packingâ€ [SV14] and asymptotically efï¬cient â€œbootstrappingâ€ algorithms [GHS12a; AP13]
for characteristic-two plaintext rings like F2ğ‘˜. Finally, non-two-power cyclotomic rings
lack orthogonal bases (in the canonical geometry), so sampling from recommended error
distributions and error management are more subtle [LPR13a], and it is interesting to
consider what effect (if any) this has on concrete hardness.
Our challenges are weighted toward the popular two-power case, but they also include
indices of a variety of other forms, including powers of other small primes, those that are
divisible by many small primes, and moderately large primes. We are particularly interested
in whether there are any cryptanalytic attacks that can take special advantage of any of these
forms. Our choices of indices ğ‘š correspond to dimensions ğ‘› ranging from 128 to 4,096 for
Ring-LWE, and from 16 to 162 for Ring-LWR.
205
Error Width
The absolute error of a (Ring-)LWE instantiation is, very informally, the â€œwidthâ€ of the
coefï¬cients of the error distribution, with respect to an appropriate choice of basis. The main
worst-case hardness theorems for (Ring-)LWE (e.g., [Reg09; Pei09; LPR13b]) apply to
âˆš
Gaussian-like error distributions whose widths exceed certain â„¦(
ğ‘›) bounds. Conversely,
there are algebraic attacks that can exploit signiï¬cantly narrower errors, if enough samples
are available (see, e.g., [AG11; Alb+14; EHL14; CLS15; CLS16; Pei16]). However, there is
still a poorly understood gap between the theoretical bounds and parameters that plausibly
fall to such attacks, especially in the low-sample regime (see Figure 7.1.1 below for further
details).
Following the original deï¬nition and recommended usage of Ring-LWE [LPR13b;
LPR13a], our challenge instantiations use the â€œdualâ€ form involving the fractional ideal ğ‘…âˆ¨
of the ring ğ‘…, with Gaussian error that is spherical in the canonical embedding. More
speciï¬cally, the products ğ‘ Â· ğ‘ğ‘– reside in the quotient group ğ‘…âˆ¨/ğ‘ğ‘…âˆ¨, and we add error whose
canonical embedding is distributed as a continuous Gaussian ğ·ğ‘Ÿ of some parameter ğ‘Ÿ > 0
(with optional discretization to ğ‘…âˆ¨). In comparison to plain LWE, we emphasize that ğ‘…âˆ¨
in the canonical embedding is a much denser lattice than Zğ‘›; in particular, errors drawn
âˆš
from ğ·ğ‘Ÿ have (not necessarily independent) Gaussian coefï¬cients of width ğ‘Ÿ
ğ‘› with respect
to the so-called â€œdecodingâ€ Z-basis of ğ‘…âˆ¨ [LPR13a]. (See Figure 7.1 and section 2.2 for
further details.) Therefore, our parameterization is closely analogous to plain LWE with
Gaussian error of parameter ğ‘Ÿ
ğ‘›.
âˆš
Our challenge instantiations use four qualitative categories of error parameter ğ‘Ÿ:
Trenta corresponds to a bound from the main â€œworst-case hardness of decision-Ring-
LWEâ€ theorem [LPR13b, Theorem 3.6], namely, ğ‘Ÿ â‰¥ (ğ‘›â„“/ ln(ğ‘›â„“))1/4 Â·âˆšï¸€ln(2ğ‘›/ğœ€)/ğœ‹,
where â„“ is the number of revealed samples and (say) ğœ€ â‰ˆ 2âˆ’80 is a bound on the
206
ğ‘…âˆ¨
ğ‘‘0
ğ‘‘1
Figure 7.1: The canonical embedding of: (in dark blue) the dual ideal ğ‘…âˆ¨ of the 3rd
cyclotomic ring ğ‘… = Z[ğœ3], (in light blue) its â€œdecodingâ€ Z-basis {ğ‘‘0, ğ‘‘1}, and (in red) the
continuous spherical Gaussian ğ·ğ‘Ÿ of parameter ğ‘Ÿ =
âˆš
2.
statistical distance in the reduction.6 We pose this class of challenges to give some
insight into instantiations that conform to the error bounds from known worst-case
hardness theorems (though not necessarily for large enough dimensions ğ‘› to obtain
meaningful hardness guarantees via the reductions alone).
Grande corresponds to some ğ‘Ÿ â‰¥ ğ‘ = Î˜(1) (i.e., coefï¬cients of width ğ‘
âˆš
ğ‘›) that satisï¬es
the lower bound from Regevâ€™s worst-case hardness theorem [Reg09] for plain LWE,
and that also sufï¬ces for provable immunity to the class of â€œring homomorphismâ€
attacks deï¬ned in [EHL14; Eli+15; CLS15; CLS16], as shown in [Pei16, Section 5].
We note that while the theorems from [Reg09] and [Pei16] are stated for ğ‘ = 2, an
inspection of the proofs and tighter analysis reveal that the constant can be improved
ğœ‹) â‰ˆ 0.282 in the former case [Reg16], and to ğ‘ =âˆšï¸€8/(ğœ‹ğ‘’) â‰ˆ 0.968
âˆš
to nearly 1/(2
or better in the latter case, depending on the dimension and desired time/advantage
lower bound (see subsection 7.3.1 for details). We pose this class of challenges to give
instantiations which might someday conform to signiï¬cantly improved worst-case
6It is very likely that the bound can be improved by a small constant factor within the same proof framework;
in addition, the (ğ‘›â„“/ ln(ğ‘›â„“))1/4 factor might be an artifact of the proof. However, we use the bound as stated
for our challenges.
207
hardness theorems for Ring-LWE, and which in any case satisfy the bounds from
known hardness theorems in the absence of ring structure.
âˆš
Tall corresponds to ğ‘Ÿ âˆˆ {6, 9}/
ğ‘›, i.e., error coefï¬cients of width 6 or 9. Errors of roughly
this size have been used in prior concrete analyses of LWE instantiations (e.g., [MR09;
LP11]) and in practical implementations of (Ring-)LWE cryptography (e.g., [Alk+16;
Bos+16a]).
âˆš
Short corresponds to ğ‘Ÿ âˆˆ {1, 2}/
ğ‘›, i.e., error coefï¬cients of width 1 or 2. In light
of the above-mentioned small-error and homomorphism attacks, we consider such
parameters to be riskier, at least when a large number of Ring-LWE samples are
available. But at present it is unclear whether the attacks are feasible when only a
small or moderate number of samples are available, as is the case in our challenges
and in many applications (see Figure 7.1.1 below for further discussion).
Finally, for each setting of the error parameter we give challenges for both continuous
error and its corresponding discretized version, where each real coefï¬cient (with respect to
the decoding basis) is rounded off to the nearest integer. Cryptographic applications almost
always use discrete forms of Ring-LWE, but continuous forms are also cryptanalytically
interesting. In particular, rounding yields a tight reduction from any continuous form to its
corresponding discrete form, i.e., the latter is at least as hard as the former.
Modulus
Another main quantity that strongly inï¬‚uences Ring-LWEâ€™s apparent hardness is the error
rate, which is, informally, the ratio of the (absolute) error width to the modulus ğ‘. There is
much theoretical and practical cryptanalytic evidence that, all else being equal, Ring-LWE
becomes harder as the error rate increases. E.g., there are tight reductions from smaller to
larger rates; worst-case hardness theorems yield stronger conclusions for larger error rates;
and lattice-based attacks perform worse in practice. Therefore, cryptographic applications
208
typically aim to use the smallest possible modulus that can accomodate the accumulated error
terms without mod-ğ‘ â€œwraparoundâ€ (so as to avoid, e.g., incorrect decryption). However,
other considerations can introduce additional subtleties in the choice of modulus.
The initial worst-case hardness theorem for search-Ring-LWE [LPR13b, Theorem 4.1]
applies to any sufï¬ciently large modulus ğ‘ and absolute error. However, the search-to-
decision reduction [LPR13b, Theorems 5.1 and 5.2] requires ğ‘ to be a prime integer that
â€œsplits wellâ€ in ğ‘…, i.e., the ideal ğ‘ğ‘… factors into distinct prime ideals of small norm.7
Subsequent work [BV14a; Bra+13] used the â€œmodulus switchingâ€ technique to obtain a
reduction for essentially any modulus, at the cost of an increase in the error rate. Finally,
recent work [PRS17] gave a worst-case hardness theorem for decision-Ring-LWE for
any modulus, which either matches or improves upon the just-described results in terms
of parameters. On the cryptanalytic side, the above-mentioned homomorphism attacks
of [EHL14; Eli+15; CLS15; CLS16] can take advantage of moduli ğ‘ for which the ideal ğ‘ğ‘…
has small-norm ideal divisors, but only when the error is insufï¬ciently â€œwell spreadâ€ relative
to those ideals. (See [Pei16] for further details.)
With these considerations in mind, our challenge instantiations include moduli of a
variety of sizes and arithmetic forms. We include moduli that split completely, others
that split very poorly, and some that â€œramifyâ€ (e.g., two-power moduli for two-power
cyclotomics). Each instantiation uses a modulus that is large enough, relative to the absolute
error, to yield correct decryption with high probability in public-key encryption and key-
exchange protocols following the template from [LPR13b; Pei14]. See subsection 7.3.2 for
further details.
Number of Samples
Finally, each of our challenge instantiations consist of either a small or moderate number
of samples (speciï¬cally, three or 100) for Ring-LWE, and 500 samples for Ring-LWR.
7Such moduli also enable FFT-like algorithms over Zğ‘, also called Chinese Remainder Transforms, which
yield fast multiplication algorithms for ğ‘…/ğ‘ğ‘… using just Zğ‘ operations.
209