nal degradations found in the traversed telephony network are also
generated and tested (e.g., packet loss in iLBC, multi-path fading
in GSM). We also append the codec multi-label for each generated
sample. We aggregate all possible resulting speech samples into a
corpus. The number of samples for each of the traversal scenarios
is shown in Table 2.
We run the feature extraction algorithms described in Section
3.3 on each of the speech samples and then train and test a multi-
label classiﬁer on the resulting feature vector and label. We use
Mulan [51], an open source Java library for multi-label learning, to
create our machine learning classiﬁer.
4.2 Classiﬁcation Results
Multi-label classiﬁers can use a variety of reduction techniques
including Binary Relevance (BR), Label Power (LP) set and Ran-
dom k-Labelsets (RAkEL) [53] to convert the multi-label into a sin-
gle label. The resulting labels can then be classiﬁed by any of the
traditional single-label classiﬁers. We use C4.5 decision trees as the
underlying single-label classiﬁer as it outperforms other classiﬁers
that we considered including Naive Bayes and Neural Networks.
2Recall that VoIP calls can cross multiple autonomous systems
throughout the Internet without being transcoded.
Metric
Hamming
Loss
Accuracy
Precision
Recall
i=1
1|D| ·(cid:80)|D|
1|D| ·(cid:80)|D|
1|D| ·(cid:80)|D|
1|D| ·(cid:80)|D|
i=1
i=1
i=1
Deﬁnition
|Yi(cid:52)Pi|
|L|
BR
.09
LP RAkEL
.1
.05
|Yi∩Pi|
|Yi∪Pi|
|Yi∩Pi|
|Yi∩Pi|
|Pi|
|Yi|
83.7% 83.7%
91.5% 89.3%
90.3% 89.3%
91.6%
93.7%
97%
Table 3: Accuracy of multi-label classiﬁer using C 4.5 decision
trees. RAkEL outperforms the simpler binary relevance and
label power set reduction techniques.
Using the corpus described above, we use 10-fold cross validation
to measure the accuracy of the multi-label classiﬁer under the three
reduction techniques. Our results are described in Table 3. We
deﬁne the metrics as speciﬁed in the multi-label classiﬁcation lit-
erature [52]. Let the multi-label dataset consist of |L| labels (ﬁve
in our case) and |D| instances in the test set, with each instance
i represented by feature vector fi and label Yi. The classiﬁer C
makes label predictions Pi = C(fi) for each instance fi. For a
test instance with known path traversal signature, the classiﬁer pre-
dicts a label using only the feature vector. The metrics deﬁned help
quantify the difference between the predicted and actual labels.
We ﬁnd that RAkEL has the lowest Hamming loss and the high-
est accuracy of 91.6%. The results show that we are able to predict
which networks a call traversed with high accuracy. We also ﬁnd
that the majority of misclassiﬁcations occur for samples that tra-
versed a VoIP network with 0% packet loss rate. We plan to study
how to distinguish VoIP, PSTN and cellular codecs when there are
virtually no degradations as part of future work.
5. REAL-WORLD TESTING
The complete provenance ﬁngerprint of a call consists of the path
traversal signature, and proﬁles for packet loss, concealment, noise
and quality. If this ﬁngerprint remains consistent for a call source, it
provides valuable metadata that can be used to identify and distin-
guish different calls purely from the received audio. We asked dif-
ferent users to make a set of 10 live calls to our testbed in Atlanta,
GA from 16 different locations around the world, including Aus-
tralia, India, United Arab Emirates, United Kingdom and France.
The complete list of locations is shown in Figure 11.
Each call lasts approximately 20 seconds. We extract features
and proﬁles from the received audio and then label all calls from
a call source with the same unique label. We then train a neural
network classiﬁer for N sets of the 10 call sets (set = one call from
each source). We vary N from one to ﬁve and then test with ﬁve
new call sets. This represents the scenario that a user labels a set
of calls and expects subsequent calls coming from the same source
to be labeled correctly by our algorithm. Our experiment evaluates
the tradeoff between labeling effort and accuracy.
The results show that even if a single set of 16 calls is labeled,
the remaining ﬁve sets of calls from the 16 different locations are
identiﬁed with the correct call source label with 90% accuracy. The
accuracy increases quickly to 96.25% for two, 97.5% for three,
97.5% for four and 100% for ﬁve labeled sets. Figure 12 shows the
confusion matrix for 1, 3 and 5 training sets.
Even with a singly labeled training set (Fig 12(a)) we ﬁnd that
all VoIP calls are correctly identiﬁed as they are easily distinguish-
able from the other networks. They are also distinguishable among
themselves as they are geographically spread across Atlanta, Mary-
land, Dubai, Pune and Australia and each has a different packet loss
concealment proﬁle. In some cases we were pleasantly surprised by
116Figure 11: We tested our system using multiple sources from four continents: North America, Europe, Asia and Australia. Specif-
ically, we recorded incoming calls from ﬁve different PSTN phones in Atlanta, GA, Dallas, TX, and France; four different mobile
phones in Atlanta, GA, New York City, NY, San Jose, CA and London, UK; six VoIP phones in Atlanta, GA (Skype and Vonage),
Baltimore, MD(MajicJack), Pune, India(MagicJack), Dubai, UAE(Vonage) and Melbourne, Australia (MyNetPhone).
Figure 12: The confusion matrix for the live-captured call data trained with labels for (a) one set of calls, (b) three sets of calls and
(c) ﬁve sets of calls from all call sources. The accuracy on even a singly labeled training set is 90% and quickly jumps to 100% with
5 labeled training sets.
the actual differentiator. We found that Vonage calls from Atlanta
were distinguishable from all the other VoIP calls based on its high
spectral level range (noise proﬁle) rather than the packet loss pro-
ﬁle. We suspect that this is due to the fact that Vonage calls almost
immediately transfer to the PSTN backbone for quality of service,
while other services predominantly use VoIP. However, we did not
observe this in the international Vonage call from Dubai where the
call path would be predominantly VoIP, instead, to make the call
affordable.
Figure 12(a) shows that even with a singly labeled training set we
are able to distinguish between the three landlines from Atlanta, in-
cluding the two from within the Georgia Tech campus, demonstrat-
ing that even for similar call sources the characteristics can be sig-
niﬁcantly different. We also see that three of the ﬁve calls from the
London mobile phone are misclassiﬁed as a mobile phone call from
New York and one call was misclassiﬁed as a landline call from
France. The provenance of the call from London seems to be mis-
classiﬁed based on either the distance similarity (both coming from
Europe) or the same origin network (cell). The number of misclas-
siﬁcations for the test set containing 80 calls (16locations × 5)
drops signiﬁcantly from 10 to 3 and then to 2 with increasing the
number of training sets. With ﬁve labeled call sets being trained
we have no misclassiﬁcation showing that with each extra label the
classiﬁer becomes increasingly accurate.
The proﬁles that we capture for each source are consistent for the
same call source but have enough variability to allow us to distin-
guish different call sources. Although we still require 15 seconds of
call audio before being able to identify the provenance, we believe
that an attempt to steal sensitive information (e.g., bank account
numbers) from a potential victim requires signiﬁcantly more time.
Accordingly, users should be sure to wait at least this amount of
time before disclosing such information. We plan to investigate the
uniqueness of a larger number of call sources as part of future work.
6. DISCUSSION
In this section, we investigate some of the limitations of our cur-
rent infrastructure and discuss a number of future extensions that
will both improve the accuracy of our detection and its resistance
to more active adversaries.
6.1 Limitations
Our call provenance infrastructure is designed to detect codecs
and path characteristics associated with a given source. In spite of
its relative strength, there exist a number of limitations associated
AtlantaPSTN OriginCellular OriginMagicJack OriginSkype OriginVonage OriginMyNetPhone OriginAccuracy = 90%ATL-CellDAL-LLNYC-CellATL-SkypeATL-LLPUN-MJackATL-GT1ATL-VonATL-SkypeATL-GT2DUB-VonBAL-MJackMEL-NFoneFRA-LLLON-CellSJC-Cell(a)ATL-CellDAL-LLNYC-CellATL-SkypeATL-LLPUN-MJackATL-GT1ATL-VonATL-SkypeATL-GT2DUB-VonBAL-MJackMEL-NFoneFRA-LLLON-CellSJC-CellAccuracy = 97.5%ATL-CellDAL-LLNYC-CellATL-SkypeATL-LLPUN-MJackATL-GT1ATL-VonATL-SkypeATL-GT2DUB-VonBAL-MJackMEL-NFoneFRA-LLLON-CellSJC-Cell(b)ATL-CellDAL-LLNYC-CellATL-SkypeATL-LLPUN-MJackATL-GT1ATL-VonATL-SkypeATL-GT2DUB-VonBAL-MJackMEL-NFoneFRA-LLLON-CellSJC-CellAccuracy = 100%ATL-CellDAL-LLNYC-CellATL-SkypeATL-LLPUN-MJackATL-GT1ATL-VonATL-SkypeATL-GT2DUB-VonBAL-MJackMEL-NFoneFRA-LLLON-CellSJC-Cell(c)ATL-CellDAL-LLNYC-CellATL-SkypeATL-LLPUN-MJackATL-GT1ATL-VonATL-SkypeATL-GT2DUB-VonBAL-MJackMEL-NFoneFRA-LLLON-CellSJC-Cell117with our current system. For instance, unlike Caller-ID systems,
our call provenance infrastructure requires that the receiver answer
the call before its source can be veriﬁed. This may not be useful
to those using Caller-ID as a means of deciding whether or not
to take a call. This shortcoming could potentially be addressed
by pushing our mechanism into the cloud. Incoming calls could
potentially be forced to ﬁrst interact with a recording, which could
collect sufﬁcient audio for analysis, before reaching the intended
target. We leave the details of such a system to future work.
We currently rely heavily on packet loss characteristics of the
path between sources and our testbed to differentiate VoIP ﬁnger-
prints. While instantaneous packet loss rates certainly ﬂuctuate,
paths and their corresponding loss patterns are relatively stable in
the Internet [37]. However, we recognize that our packet loss pro-
ﬁles may need to be more accepting of diurnal cycles and tem-
porary anomalies and plan to study such issues as we continue to
extend the PinDr0p infrastructure.
As an implementation decision, we currently associate a source
with a single ﬁngerprint. This assumption is appropriate when deal-
ing with an immobile source such as a corporate calling center.
However, individual users may take advantage of the mobility al-
lowed by VoIP software such as Skype to legitimately place calls
from a number of different locations. The advantage in such a sce-
nario is that the receiver is likely to recognize the caller’s voice and
can therefore manually associate new ﬁngerprints to a particular
source.
Lastly, we have attempted to analyze the most widely used codecs
in our study. However, other less widely use codecs were not con-
sidered in this initial study. For instance, the Adaptive Multi-Rate
(AMR) codec, which provides higher audio quality and is begin-
ning to compete with GSM on mobile devices, and a handful of oth-
ers such as the Enhanced Variable Rate Codec (EVRC) for CDMA
networks will be considered as part of our future work.
6.2 Proposed Extensions and Future Work
We intend to continue improving the robustness of PinDr0p through
a number of extensions. While admittedly difﬁcult, an adversary
capable of replicating all of the codecs and path characteristics as-
sociated with the path between a legitimate source and target re-
ceiver would potentially be able to be identiﬁed as the proﬁled
source. This process not only implies that the adversary has cor-
rectly guessed all of the codecs applied by intermediary hops, but
that they can ensure that their trafﬁc exhibits similar packet loss,
bit error and noise characteristics as a legitimate connection. This
is exceptionally difﬁcult as an adversary, for example, can not de-
crease the packet loss characteristics of an intermediary network
that they do not control. Our approach therefore represents a sig-
niﬁcant improvement over the current state of the art.
While we currently detect the presence of as many as three dif-
ferent codecs applied to audio, our mechanisms do not uncover the
order in which the codecs were applied. Determining codec order
is an extremely difﬁcult problem on the surface. Knowledge of this
ordering will make spooﬁng attempts by an adversary located off
the path more difﬁcult.
Finally, we are interested in extending our analysis to include
a larger number of intermediary networks. While highly uncom-
mon, it is possible that some international calls may be transcoded
by as many as ﬁve different codecs while in ﬂight between their
source and destination. The repeated decoding and encoding of au-
dio information drastically reduces its quality at the receiver end
of the call and may also obscure the presence of the intermediary
networks given the elevated noise levels present in the sample.
6.3 Additional Applications
We have focused the work in this paper on using call prove-
nance to address Caller-ID spooﬁng attacks. However, the utility
of PinDr0p is not limited to this task. While stories of VoIP-based
phishing (vishing) have become popular in the media [57, 45], the
extent to which such calls are occurring compared to traditional
telephony fraud is unknown. The deployment of our infrastruc-
ture in a distributed fashion may help to answer this question. In
particular, the use of call provenance in this space can assist in de-
termining the prevalence and potentially the identity of individual
vishing campaigns. While we leave the details of such an infras-
tructure to future work, we hope to be able to provide the security
community with a tool for better understanding such attacks.
PinDr0p may also be useful as a means of authenticating chan-
nels. For instance, credit card and home security companies of-
ten use Caller-ID information as a second factor of authentication
when customers call with account questions. Such organizations
could increase the number and difﬁculty of questions asked of the
caller based on the measured provenance of the incoming call. In
multi-factor authentication analysis, PinDr0p can be used to deter-
mine if information exchange through a website and a phone call
are truly independent. Finally, PinDr0p could also be used by law
enforcement agencies for call forensics.
7. RELATED WORK