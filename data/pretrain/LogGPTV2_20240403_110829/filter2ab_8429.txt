### Title: Efail: Exploiting S/MIME and OpenPGP Email Encryption via Exfiltration Channels

OpenPGP and S/MIME are the two primary standards for providing end-to-end encryption for emails. However, from a contemporary perspective, it is surprising that both standards rely on outdated cryptographic primitives, which have been responsible for vulnerabilities in major cryptographic protocols. The confidence in email security likely stems from the non-interactive nature of email, leading to the assumption that attackers cannot exploit vulnerabilities in the same way they do with interactive protocols like TLS, SSH, or IPsec. We demonstrate that this assumption is incorrect.

We introduce a novel attack technique called "malleability gadgets" to inject malicious plaintext snippets into encrypted emails through malleable encryption. These snippets exploit existing and standard-compliant backchannels, such as those found in HTML, CSS, or x509 functionality, to exfiltrate the full plaintext after decryption. The attack is triggered when the victim decrypts a single maliciously crafted email from the attacker.

Our research develops working malleability gadgets for both OpenPGP and S/MIME encryption. We tested 35 S/MIME email clients and found that 25 were vulnerable to exfiltration. Similarly, out of 28 OpenPGP email clients tested, 10 were susceptible. While it is necessary to update the OpenPGP and S/MIME standards to address these vulnerabilities, some clients also exhibited more severe implementation flaws, allowing straightforward exfiltration of the plaintext.