l 如果不是，请执行步骤3。
步骤2 此种情况，不会打出此Trap信息，所以请执行步骤5。
步骤3 检查华为设备配置情况：进入MPLS-LDP视图，执行display this命令，查看MPLS LDP
视图下是否存在其他配置。
l 如果是，请执行步骤4。
l 如果不是，请执行步骤6。
步骤4 即便存在基本上也不会影响会话建立，将配置信息保存并执行步骤5。
步骤5 请收集该设备的告警信息、日志信息和配置信息，并联系技术支持人员。
步骤6 基本上可以肯定由于对端的配置导致，请求对端其他厂商设备的服务人员确认并执行
步骤7。
步骤7 结束。
----结束
33.2 LDP_1.3.6.1.2.1.10.166.4.0.3 mplsLdpSessionUp
Trap Buffer 信息解释
The LDP session status changes. (PeerLsrId=[PeerLsrId], VrfName=[VrfName],
SessionType=[SessionType], IfName=[IfName], SubReason=[SubReason],
Reason=[Reason])
LDP会话状态为Up，由该会话维护的LSP也全部建立。
Trap 属性
Trap属性 描述
Alarm or Event Alarm
Trap Severity Alert
文档版本 06 (2017-09-12) 华为专有和保密信息 452
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 33 LDPP2P
Trap属性 描述
Mnemonic Code Session-Up-MIB
Trap OID 1.3.6.1.2.1.10.166.4.0.3
Alarm ID 0x09020000
Alarm Type communicationsAlarm
Raise or Clear Clear
Match trap 33.3 LDP_1.3.6.1.2.1.10.166.4.0.4 mplsLdpSessionDown
Trap Buffer 信息参数
参数名称 参数含义
PeerLsrId LDP会话标识。
VrfName LDP会话所在的VRF名称。
SessionType LDP会话的类型，包括：
l 本地会话。
l 远端会话。
l 本地和远端会话。
IfName 发现邻居的接口名称。
SubReason 告警详细原因。
Reason 告警原因。
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.2.1.10.166.4.1.3.3.1. mplsLdpSessionState mplsLdpEntityLdpId
2
mplsLdpEntityIndex
mplsLdpPeerLdpId
1.3.6.1.2.1.10.166.4.1.3.3.1. mplsLdpSessionDiscontinuit mplsLdpEntityLdpId
8 yTime
mplsLdpEntityIndex
mplsLdpPeerLdpId
1.3.6.1.2.1.10.166.4.1.3.4.1. mplsLdpSessionStatsUnkno mplsLdpEntityLdpId
1 wnMesTypeErrors
mplsLdpEntityIndex
mplsLdpPeerLdpId
文档版本 06 (2017-09-12) 华为专有和保密信息 453
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 33 LDPP2P
VB OID VB Name VB Index
1.3.6.1.2.1.10.166.4.1.3.4.1. mplsLdpSessionStatsUnkno mplsLdpEntityLdpId
2 wnTlvErrors
mplsLdpEntityIndex
mplsLdpPeerLdpId
对系统的影响
无影响。
可能原因
原因1：配置了新的LDP会话。
原因2：有新增路由。
原因3：链路状态恢复。
处理步骤
步骤1 正常运行信息，无需处理。
----结束
33.3 LDP_1.3.6.1.2.1.10.166.4.0.4 mplsLdpSessionDown
Trap Buffer 信息解释
The LDP session status is Down. (PeerLsrId=[PeerLsrId], VrfName=[VrfName],
SessionType=[SessionType], IfName=[IfName], SubReason=[SubReason],
Reason=[Reason])
LDP会话状态为Down，由该会话维护的LSP也全部删除。
Trap 属性
Trap属性 描述
Alarm or Event Alarm
Trap Severity Alert
Mnemonic Code Session-Down-MIB
Trap OID 1.3.6.1.2.1.10.166.4.0.4
Alarm ID 0x09020000
Alarm Type communicationsAlarm
Raise or Clear Raise
文档版本 06 (2017-09-12) 华为专有和保密信息 454
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 33 LDPP2P
Trap属性 描述
Match trap 33.2 LDP_1.3.6.1.2.1.10.166.4.0.3 mplsLdpSessionUp
Trap Buffer 信息参数
参数名称 参数含义
PeerLsrId LDP会话标识。
VrfName LDP会话所在的VRF名称。
SessionType LDP会话的类型，包括：
l 本地会话。
l 远端会话。
l 本地和远端会话。
IfName 发现邻居的接口名称。
SubReason 告警详细原因。
当LDP会话Down的原因是接收到错误报
文时，会给出详细的错误类型；当LDP
会话Down的原因是接收到Notify消息
时，会给出详细的Notify类型； 典型枚举
值例举：
l 1、收到错误LDP ID的报文。
l 2、收到错误版本号的报文。
l 3、收到错误PDU长度的报文。
l 5、收到错误消息长度的报文。
l 7、收到错误TLV的报文。
l 9、收到Hello超时的通告消息。
l 10、收到Shutdown通告消息。
l 20、收到Keepalive超时的通告消息，
当LDP会话Down的原因是接收到
Socket的错误时，会给出详细的错误
码。
LDP会话Down为其它原因时，此字段为
0。
Reason 告警原因。
文档版本 06 (2017-09-12) 华为专有和保密信息 455
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 33 LDPP2P
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.2.1.10.166.4.1.3.3.1. mplsLdpSessionState mplsLdpEntityLdpId
2
mplsLdpEntityIndex
mplsLdpPeerLdpId
1.3.6.1.2.1.10.166.4.1.3.3.1. mplsLdpSessionDiscontinuit mplsLdpEntityLdpId
8 yTime
mplsLdpEntityIndex
mplsLdpPeerLdpId
1.3.6.1.2.1.10.166.4.1.3.4.1. mplsLdpSessionStatsUnkno mplsLdpEntityLdpId
1 wnMesTypeErrors
mplsLdpEntityIndex
mplsLdpPeerLdpId
1.3.6.1.2.1.10.166.4.1.3.4.1. mplsLdpSessionStatsUnkno mplsLdpEntityLdpId
2 wnTlvErrors
mplsLdpEntityIndex
mplsLdpPeerLdpId
对系统的影响
基于LDP会话的所有业务中断。
可能原因
1. LDP会话的Hello保持定时器超时。
2. LDP会话的KeepAlive保持定时器超时。
3. 用户配置了重启LDP的命令。
4. 用户配置了会话的GR属性。
5. 用户修改了会话的KeepAlive保持定时器的时间。
6. 用户修改了会话使用的传输地址。
7. 用户修改了会话的LSR ID。
8. 接收到邻居发送的Notify协议消息，要求本端重新建立LDP会话。
9. LDP长时间无法建立会话。
10. 邻居发送的协议报文错误。
11. LDP接收到socket错误。
12. 用户删除了LDP会话。
13. 用户修改了Capability的配置。
14. MPLS LDP的配置被删除。
15. MPLS LDP Remote配置被删除。
16. 用户修改了会话的标签发布模式。
文档版本 06 (2017-09-12) 华为专有和保密信息 456
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 33 LDPP2P
处理步骤
步骤1 执行display mpls ldp session peer-id命令检查会话状态。其中参数peer-id和告警信息中
PeerLdpId字段的内容保持一致。
l 会话的Status字段为Operational状态请执行步骤2。
l 没有任何信息或者会话的Status字段为非Operational请执行步骤3。
步骤2 表示会话已经重新建立，可能属于会话闪断，有可能已经造成业务中断。需要根据log
信息进一步分析原因请执行步骤19。
步骤3 执行display mpls ldp peer peer-id命令检查是否有相关Peer信息。其中参数peer-id和告
警信息中PeerLdpId字段的内容保持一致。
l 有显示信息请执行步骤4。
l 没有任何信息，查看告警信息中的IfName字段是否为空。
– 如果是，请执行步骤7。
– 如果不是，请执行步骤13。
步骤4 多次执行display mpls ldp session peer-id命令，检查会话是否在振荡。其中参数peer-id
和告警信息中PeerLdpId字段的内容保持一致。如果显示信息中的Status字段有时显示
为Operational，有时显示为Nonexistent，或者没有任何显示信息，则表示会话在振
荡。
l 如果是，请执行步骤5。
l 如果不是，请执行步骤7。
步骤5 会话振荡，请确定是否存在频繁修改配置操作：
l 如果是，请执行步骤6。
l 如果不是，请执行步骤7。
步骤6 请停止此类操作，过2分钟后请执行步骤18。
步骤7 执行display mpls ldp peer peer-id命令，其中参数peer-id和告警信息中PeerLdpId字段的
内容保持一致。查看显示信息中的TransportAddress字段。执行display ip routing-table
ip-address命令，其中参数ip-address要和display mpls ldp peer peer-id命令的显示信息中
TransportAddress字段的内容保持一致，检查是否存在到对端路由信息:
l 如果是，请执行步骤10。
l 如果不是，请执行步骤8。
步骤8 检查IGP路由配置是否正确。
l 如果使用的IGP协议是OSPF，在OSPF视图下，执行display current-configuration
configuration ospf命令查看是否使用OSPF发布了Loopback口和对应的接口地址路
由。
– 如果是，请执行步骤11。
– 如果不是，请执行步骤9。
l 如果使用的IGP协议是IS-IS，在Loopback口以及对应的接口下执行display this命令
查看是否使能了IS-IS。
– 如果是，请执行步骤11。
– 如果不是，请执行步骤9。
步骤9 恢复路由协议配置，并参照步骤8检查配置是否正常：
文档版本 06 (2017-09-12) 华为专有和保密信息 457
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 33 LDPP2P
l 如果是，请执行步骤7。
l 如果不是，请执行步骤19。
步骤10 查看TCP状态是否正常。执行display mpls ldp peer peer-id命令，其中参数peer-id和告
警信息中PeerLdpId字段的内容保持一致，查看显示信息中的Peer Transport Address
字段（记为S）及Peer Discovery Source字段，执行display mpls ldp interface interface-
type interface-number命令，其中参数interface-type interface-number和前面的Peer
Discovery Source字段的内容保持一致，查看Transport Address字段（记为D）。执行
display tcp status命令，查看Local Add:port字段是否为D，且Foreign Add:port字段是
否为S，如果均符合，则表示TCP状态正常。
l 如果是，请执行步骤18。
l 如果不是，请执行步骤11。
步骤11 执行ping -a source-ip -c destination-address命令100次以上，其中参数source-ip和步骤10
中的S保持一致，参数destination-address和步骤10中的D保持一致，检查是否出现丢
包：
l 如果是，请执行步骤12。
l 如果不是，请执行步骤19。
步骤12 链路不稳，线路存在问题或流量超大，请检查链路使链路稳定请执行步骤18。
步骤13 在两端执行display mpls ldp interface interface-type interface-number命令，其中参数
interface-type interface-number和步骤10中的Peer Discovery Source字段的内容保持一
致，检查接口状态：
l 有对应接口，但是Status字段显示为Inactive请执行步骤16。
l 没有对应接口请执行步骤14。
步骤14 在接口下执行display this命令检查是否使能了LDP：
l 显示信息中有mpls ldp请执行步骤19。
l 显示信息中没有mpls ldp请执行步骤15。
步骤15 接口下执行mpls ldp命令请执行步骤18。
步骤16 在接口下执行display this命令，检查接口是否已经被shutdown：
l 显示信息中有shutdow请执行步骤17。
l 显示信息中没有shutdow请执行步骤19。
步骤17 在接口下执行undo shutdown命令请执行步骤18。
步骤18 如果出现LDP_1.3.6.1.2.1.10.166.4.0.3 mplsLdpSessionUp告警，表示此告警已经消除请
执行步骤20。
步骤19 联系技术支持人员。
步骤20 结束。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 458
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 33 LDPP2P
33.4 LDP_1.3.6.1.4.1.2011.5.25.182.1.54.1
hwmplsldpvirtualtunnelup
Trap Buffer 信息解释
The LDP virtual tunnel went Up. (LdpVirtualTunnelFEC=[LdpVirtualTunnelFEC])
当LDP虚隧道进入Up状态时发送此告警。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Notice
Mnemonic Code hwmplsldpvirtualtunnelup
Trap OID 1.3.6.1.4.1.2011.5.25.182.1.54.1
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
LdpVirtualTunnelFEC FEC for a virtual LDP tunnel.