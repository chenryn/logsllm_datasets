### 文件系统支持特性比较

- **多文件所有者**：仅Pesos [27] 支持多文件所有者 (F7)。
- **多组所有者**：没有系统支持多组所有者。
- **认证与授权分离**：NEXUS [26] 和 Pesos [27] 将认证和授权分开 (F8)。
- **加密文件的重复数据删除**：仅REED [22] 支持加密文件的重复数据删除 (F9)。
- **权限继承**：没有任何系统支持权限继承 (F10)。
- **基于组的权限定义**：几乎所有密码保护的文件共享系统都不支持基于组的权限定义 (P2)。因此，与组相关的每个目标都不是其设计的一部分。
- **不同组访问同一加密文件**：只有Garrison等人 [23] 和Pesos [27] 支持不同组访问同一加密文件 (P5)，这可以显著减少与不同组共享文件所需的存储空间。
- **文件系统的机密性和完整性保护**：仅NEXUS [26] 保护文件系统的机密性和完整性 (S1 和 S2)。
- **即时撤销**：一半的系统执行即时撤销 (S4)，而其他系统则采用延迟撤销，即重新加密推迟到下次文件更新。这为安全漏洞提供了机会，因为被撤销的用户仍然可以访问未更新的所有文件。
- **回滚保护**：没有任何相关工作提供针对单个文件和整个文件系统的回滚保护，并在任何时候都强制执行 (S5)。

### SeGShare 设计

在本节中，我们将基于图1所示的组件讨论SeGShare的设计。该设计满足了表II中的大多数目标，其余目标将通过下一节讨论的扩展来实现。我们首先介绍设置阶段，在此阶段用户与云提供商之间建立信任关系，然后是运行时阶段，在此阶段处理用户请求。

#### A. 设置阶段：建立用户与Enclave之间的信任

SeGShare的设置阶段在每个用户 \( u \in U \) 和在云提供商处运行的Enclave之间建立双边信任。此阶段仅执行一次，所建立的信任是用户文件端到端安全性的基础。

1. **建立用户对Enclave的信任**：
   - CA的证书服务组件连接到SeGShare的一个外部接口（不受信任的认证组件），以执行远程验证Enclave（见第II-A节）。
   - CA的公钥硬编码在Enclave中。因此，如果CA收到预期的测量值，则确保与专门为该CA构建的Enclave通信。
   - 在远程验证过程中，CA建立一个安全通道，该通道终止于受信任的认证组件。该通道用于以下消息交换：
     1. CA请求证书签名请求 (CSR)。
     2. Enclave生成临时密钥对，并向CA提供包含临时密钥对公钥的CSR。
     3. CA生成并签署服务器证书，并将其提供给Enclave。
     4. Enclave检查证书的有效性。成功后，它将服务器证书持久化在不受信任的内存中，密封密钥对（见第II-A节），并触发受信任的TLS接口更新其服务器证书。
   - CA可以在任何时候请求新的CSR并替换服务器证书。
   - 在运行时，用户在每次连接时都会收到服务器证书。由于CA检查了Enclave的有效性并且用户信任CA，用户只需使用CA的公钥验证服务器证书即可确信与可信的SeGShare Enclave通信。值得注意的是，不需要进行远程验证。

2. **建立Enclave对用户的信任**：
   - 对于每个用户 \( u \in U \)，CA验证u的身份并向u提供客户端证书。
   - 该证书包含身份信息，例如用户ID、电子邮件地址和/或全名。
   - 用户u可以检查证书是否由受信任的CA签名，因为u知道CA的公钥。
   - 在TLS握手期间，u的应用程序向Enclave呈现u的客户端证书，Enclave使用CA的公钥验证证书。成功后，Enclave可以确信它正在与系统的有效用户通信。

#### B. 运行时阶段：请求和响应

每个请求始于用户应用程序，每个响应终于用户应用程序。因此，我们首先介绍SeGShare的这一组件，然后解释其他组件如何处理请求。

1. **用户应用程序**：
   - 用户应用程序将用户的本地文件系统链接到云提供商处的远程文件系统。
   - 为此，它建立了与SeGShare的第二个外部接口（不受信任的TLS接口）的连接。此接口用于直接与受信任的TLS接口建立安全的TLS连接。
   - TLS握手后，用户应用程序可以向Enclave发送请求。在设计部分，我们详细讨论以下请求：创建目录；创建/更新文件；获取文件内容或目录列表；为组设置文件/目录权限；添加/移除用户到/从组。请注意，每个用户都是其默认组的一部分，因此权限请求也适用于单个用户。用于定义文件应继承其权限的请求将在第V-B节中描述。为了简洁起见，我们不讨论以下请求，但其实现是直接的：删除文件/目录；移动文件/目录；更新文件/目录的所有权；更新组所有权；删除组。
   - 值得注意的是，用户应用程序不需要任何特殊硬件 (F5)，只需要存储客户端证书及其对应的私钥，独立于云存储文件、权限或组成员资格 (P1)。

2. **TLS接口**：
   - TLS接口分为不受信任的部分（在Enclave之外）和受信任的部分（在Enclave内）。
   - 不受信任的TLS接口终止网络连接（例如TCP），因为Enclave不能执行I/O操作。所有TLS记录都被转发到受信任的TLS接口，后者首先使用最新的服务器证书执行TLS握手，然后解密/加密所有传入/传出的TLS记录。
   - 因此，受信任的TLS接口是从用户应用程序到Enclave的安全通道的终点。

3. **请求处理器**：
   - 请求处理器组件解析每个传入的请求，检查语法，并使用身份信息进行进一步处理。

希望这些改进使文本更加清晰、连贯和专业。