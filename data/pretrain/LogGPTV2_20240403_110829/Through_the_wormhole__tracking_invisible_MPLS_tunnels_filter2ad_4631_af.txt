67
2
17
2
77
1
1
1
4
1
0
40
7
0
0
24
0
0
4
1
-3
4
4
3
0
5
4
4
-
-
-
2
3
2
0
4
4
2
2
1
1
2
2
4
1
5
4
4
Table 5: MPLS deployment per AS. The percentage for TTL signatures is rounded (the total may exceed 100%). “DPR or BRPR”
refers to hops revealed by either DPR or BRPR (when only one IP address is discovered in a tunnel, there is no diﬀerence
between the two methods). “Others” refers to a mix of discovery techniques (a tunnel might be, in some case, revealed by DPR
and, in another trace, by BRPR).
0.10
0.08
0.06
0.04
0.02
F
D
P
0.00
0
5
Invisible
Visible
15
10
Path Length
20
25
30
Figure 11: Eﬀects of invisible MPLS tunnels on path length
distribution for all ASes.
two ASes in particular: the peak at 23 is caused by invisible tun-
nels in AS3320 (Deutsche Telekom – see Fig. 10b), while the other
one is due to AS3549 (Level3 – not shown here due to space limi-
tations). Focusing on a given AS (as in Fig. 10b) provides very in-
sightful results: for AS3320, we identify a kind of full-mesh made
of 23 routers (a representative sample of the real network) that
we are able to turn into a more general graph where the shape of
the degree distribution becomes standard. This is conﬁrmed by the
graph density analysis for AS3320, as provided by Table 4. Indeed,
its density is divided by a factor of ten once invisible tunnels are
revealed.
The path length (i.e., the number of hops between two devices
in the network) is an important metric for modeling the Internet
topology as it takes part into the shortest path (i.e., the path of-
fering the minimum distance between a given pair of nodes), the
average path length (i.e., the average length of shortest paths for all
pairs of networking devices), or the graph diameter (i.e., the longest
shortest path) [33]. Obviously, if many nodes are hidden by long
invisible MPLS tunnels, the path length distribution will be biased
and the resulting inferred model (such as small world) biased.
Fig. 11 shows the eﬀects of invisible MPLS tunnels on path length
distribution (blue dashed line) and the shift when hidden routers
are revealed by our methods (black plain line). This has been com-
puted on the data we collected (see Sec. 4). If both distributions
(invisible and visible) more or less display the familiar bell-shaped
curve typical of Internet distance distributions, it is clear that, by re-
vealing hidden hops, we can observe a shift towards longer routes.
In particular, the mean is at 10 with invisible tunnels, while it is
at 12 when one lifts the curtain on MPLS tunnels. In addition, it
is worth noticing that it is still an underestimation because, when
a trace goes through several invisible tunnels, our current set of
techniques only reveal the last one. Thus, as a signiﬁcant share
of routing traces is likely to traverse up to two invisible MPLS net-
works, one may conclude that the actual length shift may be higher.
Finally, as most of our targets are Egress LERs belonging to Tier-
1 networks, one may multiply by almost a factor two our results
about path length to infer the typical length of routes in the Inter-
net (we did not take into account the descending route from the
Tier-1 to another Stub network).
Obviously the results presented in this section are only illustra-
tions of the eﬀect of invisible tunnels on basic graph characteristics
as seen with our dataset. Much more extensive measurement cam-
paigns and analyses are required as far as the whole Internet is
concerned.
8 CONCLUSION
In this paper, we presented and evaluated several kinds of tech-
niques for revealing IP level information hidden by invisible MPLS
tunnels. Our set of active and analytical mechanisms allowed us to
provide insights about standard MPLS practices of ISPs. Besides,
we revisited some basic Internet graph characteristics that are bi-
ased by invisible MPLS tunnels.
We validated our set of active techniques through emulation,
cross-validation and a survey of operators and, then, implemented
them on PlanetLab. We also propose and validate two analytical
techniques. To summarize, we distinguished between a set of tech-
niques (FRPLA and RTLA) able to provide the length distribution
of invisible tunnels, and others (DPR and BRPR) that indeed re-
veal the IP hops hidden by invisible tunnels. In particular, FRPLA
has the advantage of being scalable (as it is a pure analytical tech-
nique) and to work with any IP level dataset, as it only relies on
Through the Wormhole: Tracking Invisible MPLS Tunnels
IMC ’17, November 1–3, 2017, London, United Kingdom
Brand
Cisco
Juniper
MPLS
Trigger
Revelation
[9] R. Bonica, D. Gan, D. Tappan, and C. Pignataro. 2007. ICMP Extensions for Mul-
LDP
all preﬁxes
loopback
Popping
FRPLA RTLA DPR BRPR
PHP
PHP
(cid:8)
((cid:8))
–
(cid:8)
–
(cid:8)
(cid:8)
((cid:8))
tiprotocol Label Switching. RFC 4950. Internet Engineering Task Force.
[10] Center
for Applied Data Analysis.
UCSD Internet Topology Data Kit.
http://www.caida.org/data/internet-topology-data-kit.
2016.
(March 2016).
The
CAIDA
See
Table 6: Measurement techniques applicability.
standard traceroute campaigns. RTLA is based on a similar analy-
sis as FRPLA that studies the return path of replies, but it requires
an additional echo-request per IP address. In practice, for tun-
nels endpoints being Juniper routers, it provides a more accurate
estimation of the invisible tunnels length than FRPLA. Those two
techniques are enough to determine whether an AS hides an invis-
ible MPLS cloud. They are also suﬃcient to evaluate the stretch in
terms of Internet path length caused by invisible MPLS tunnels.
The DPR and BRPR techniques imply a more speciﬁc and com-
plex measurement campaign since route tracing is aimed at dynam-
ically revealing IP addresses originally hidden by MPLS tunnels.
This additional IP level information allows us to gain knowledge
on the internal architecture of opaque MPLS ASes. More generally
the Internet graph and its node degree distribution in particular
can be corrected. Finally, we identiﬁed a few ASes where our tech-
niques did not succeed, while they claim to deploy MPLS features
(according to their websites). This is probably because they use
MPLS only with UHP, for VPN and/or traﬃc engineering, leaving
tunnels truly invisible for the time being.
In this work, the measurement campaign has been driven by
the presence of abnormal high degree nodes in the router level
topology. Those nodes were a trigger for performing dedicated in-
visible MPLS tunnel discovery. However, in this paper, we have
shown that FRPLA and RTLA techniques are able to infer the pres-
ence of invisible tunnels. We could then envision a modiﬁcation
of traceroute, using FRPLA and RTLA as triggers for the pres-
ence of invisible tunnels, and BRPR and DPR to reveal the internal
nodes on the ﬂy, as suggested by Table 6.
ACKNOWLEDGMENTS
We would like to thank operators for taking time to answer to
their survey. We are also grateful to the IMC reviewers and our
shepherd, Rob Beverly, for their useful feedback on the paper.
REFERENCES
[1] P. Agarwal and B. Akyol. 2003. Time-to-Live (TTL) Processing in Multiprotocol
Label Switching (MPLS) Networks. RFC 3443. Internet Engineering Task Force.
[2] Z. Al-Qudah, M. Alsarayreh, I. Jomhawy, and M. Rabinovich. 2016.
Internet
Path Stability: Exploring the Impact of MPLS Deployment. In Proc. IEEE Global
Communication Conference (GLOBECOM).
[3] L. Andersson and R. Asati. 2009. Multiprotocol Label Switching (MPLS) Label
Stack Entry: EXP Field Renamed to Traﬃc Class Field. RFC 5462. Internet Engi-
neering Task Force.
[4] L. Andersson, I. Minei, and T. Thomas. 2007. LDP Speciﬁcation. RFC 5036. Inter-
net Engineering Task Force.
[5] B. Augustin, X. Cuvellier, B. Orgogozo, F. Viger, T. Friedman, M. Latapy, C. Mag-
nien, and R. Teixeira. 2006. Avoiding Traceroute Anomalies with Paris Trace-
route. In Proc. ACM Internet Measurement Conference (IMC).
[6] B. Augustin, R. Teixeira, and T. Friedman. 2007. Measuring Load-Balanced Paths
in the Internet. In Proc. ACM Internet Measurement Conference (IMC).
[7] D. Awduche, L. Berger, D. Gan, T. Li, V. Srinivasan, and G. Swallow. 2001. RSVP-
TE: Extensions to RSVP for LSP Tunnels. RFC 3209. Internet Engineering Task
Force.
[8] D. Aydin. 2014.
CISCO vs.
Juniper MPLS.
(June 2014).
See
http://monsterdark.com/cisco-vs-juniper-mpls/.
[11] CISCO. [n. d.]. CISCO ASR9922 Router. see https://goo.gl/KYyfbr.
[12] CISCO. [n. d.]. CISCO Line Cards. see https://goo.gl/XqUN3q.
[13] Cisco. 2013. MPLS Label Distribution Protocol Conﬁguration Guide, Cisco IOS
Release 15S. Cisco, Chapter MPLS LDP Local Label Allocation Filtering. See
https://goo.gl/rF975K.
[14] Cisco. 2017. Segment Routing Conﬁguration Guide, Cisco IOS XE Release 3S. Cisco
Press.
[15] kc claﬀy, Y. Hyun, K. Keys, M. Fomenkov, and D. Krioukov. 2009. Internet Map-
ping: from Art to Science. In Proc. IEEE Cybersecurity Applications and Technolo-
gies Conference for Homeland Security (CATCH).
[16] A. Clauset and C. Moore. 2004. Traceroute Sampling Makes Random Graphs Ap-
pear to Have Power Law Degree Distributions. cond-mat 0312674. arXiv.
[17] L. De Ghein. 2006. MPLS Fundamental: A Comprehensive Introduction to MPLS
(Theory and Practice). CISCO Press.
[18] B. Donnet and T. Friedman. 2007. Internet Topology Discovery: a Survey. IEEE
Communications Surveys and Tutorials 9, 4 (December 2007), 2–15.
[19] B. Donnet, M. Luckie, P. Mérindol, and J.-J. Pansiot. 2012. Revealing MPLS Tun-
nels Obscured from Traceroute. ACM SIGCOMM Computer Communication Re-
view 42, 2 (April 2012), 87–93.
[20] P. Erdös and A. Rényi. 1960. On the Evolution of Random Graphs. Publ. Math.
Inst. Hung. Acad. Sci. 5 (1960), 17–61.
[21] M. Faloutsos, P. Faloutsos, and C. Faloutsos. 1999. On Power-Law Relationships
of the Internet Topology. In Proc. ACM SIGCOMM.
[22] T. Flach, E. Katz-Bassett, and R. Govindan. 2012. Quantifying Violations of
Destination-Based Forwarding on the Internet. In Proc. ACM Internet Measure-
ment Conference (IMC).
[23] R. Fontugne, E. Aben, C. Pelsser, and R. Bush. 2017. Pinpointing Delay and For-
warding Anomalies Using Large-Scale Traceroute Measurements. In Proc. ACM
Internet Measurement Conference (IMC).
[24] G. Geshev. 2015. Warranty Void if Label Removed: Attacking MPLS Networks.
In Proc. Zero Nights. see http://2015.zeronights.org/assets/ﬁles/02-Geshev.pdf.
[25] J.-L. Guillaume, M. Latapy, and C. Magnien. 2004. Comparison of Failures and
Attacks on Random and Scale-Free Networks. In Proc. 8th International Confer-
ence on Principles of Distributed Systems (OPODIS).
[26] H. Haddadi, G. Iannaccone, A. Moore, R. Mortier, and M. Rio. 2008. Network
Topologies: Inference, Modeling and Generation. IEEE Communications Surveys
and Tutorials 10, 2 (April 2008), 48–69.
[27] Juniper. 2014. Conﬁguring the Preﬁxes Advertised into LDP from the Routing
Table. (December 2014). See https://goo.gl/jwdr4Q.
[28] A. Lakhina, J. Byers, M. Crovella, and P. Xie. 2003. Sampling Biases in IP Topol-
ogy Measurements. In Proc. IEEE INFOCOM.
[29] M. Luckie. 2010. Scamper: a Scalable and Extensible Packet Prober for Active
Measurement of the Internet. In Proc. ACM Internet Measurement Conference
(IMC).
[30] M. Luckie, A. Dhamdhere, B. Huﬀaker, D. Clark, and k claﬀy. 2016. bdrmap:
Inference of Borders Between IP Networks. In Proc. ACM Internet Measurement
Conference (IMC).
[31] P. Mérindol, B. Donnet, O. Bonaventure, and J.-J. Pansiot. 2010. On the Impact of
Layer-2 on Node Degree Distribution. In Proc. ACM Internet Measurement Con-
ference (IMC).
[32] K. Muthukrishnan and A. Malis. 2000. A Core MPLS IP VPN Architecture. RFC
2917. Internet Engineering Task Force.
[33] R. Pastor-Satorras and A. Vespignani. 2004. Evolution and Structure of the Inter-
net: A Statistical Physics Approach. Cambridge University Press.
[34] E. Rosen, D. Tappan, G. Fedorkow, Y. Rekhter, D. Farinacci, T. Li, and A. Conta.
2001. MPLS Label Stack Encoding. RFC 3032. Internet Engineering Task Force.
[35] E. Rosen, A. Viswanathan, and R. Callon. 2001. Multiprotocol Label Switching
Architecture. RFC 3031. Internet Engineering Task Force.
[36] J. Sommers, B. Eriksson, and P. Barford. 2011. On the Prevalence and Char-
acteristics of MPLS Deployments in the Open Internet. In Proc. ACM Internet
Measurement Conference (IMC).
[37] C. Srinivasa, L. P. Bloomberg, A. Viswanathan, and T. Nadeau. 2004. Multiprocol
Label Switching (MPLS) Traﬃc Engineering (TE) Management Information Base
(MIB). RFC 3812. Internet Engineering Task Force.
[38] Y. Vanaubel, P. Mérindol, J.-J. Pansiot, and B. Donnet. 2015. MPLS Under the
Microscope: Revealing Actual Transit Path Diversity. In Proc. ACM Internet Mea-
surement Conference (IMC).
[39] Y. Vanaubel, P. Mérindol, J.-J. Pansiot, and B. Donnet. 2016. A Brief History of
MPLS Usage in IPv6. In Proc. Passive and Activement Measurement Conference
(PAM).
[40] Y. Vanaubel, J.-J. Pansiot, P. Mérindol, and B. Donnet. 2013. Network Fingerprint-
ing: TTL-Based Router Signature. In Proc. ACM Internet Measurement Conference
(IMC).
IMC ’17, November 1–3, 2017, London, United Kingdom
Y. Vanaubel et al.
[41] N. Wang, K. Ho, G. Pavlou, and M. Howarth. 2008. An Overview of Routing
Optimization for Internet Traﬃc Engineering. IEEE Communications and Surveys
Tutorials 10, 1 (April 2008), 36–56.
[42] W. Willinger, D. Alderson, and J. C. Doyle. 2009. Mathematics and the Internet:
a Source of Enormous Confusion and Great Potential. Notices of the American
Mathematical Society 56, 5 (May 2009), 586–599.