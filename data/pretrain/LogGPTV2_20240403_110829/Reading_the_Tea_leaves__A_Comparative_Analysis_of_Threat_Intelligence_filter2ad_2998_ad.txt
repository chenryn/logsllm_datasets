and the unroutable fraction shown in Unrt is with respect to
this number.
Alexa. Blocking access to popular Internet sites or triggering
alarms any time such sites are accessed would be disruptive
to an enterprise. For our analysis, we periodically collected
the Alexa top 25 thousand domains (3–4 times a month)
over the course of the measurement period [2]. To address
the challenge that such lists can have signiﬁcant churn [33],
we restrict our whitelist to hold the intersection of all these
top 25K lists (i.e., domains that were in the top 25K every
time we polled Alexa over our 8-month measurement period),
which left us with 12,009 domains. We then queried DNS for
the A records, NS records and MX records of each domain,
and collected the corresponding IP addresses. In total, we
collected 42,436 IP addresses associated with these domains.
We compute the intersection of these IPs with TI feeds and
show the results in column Alexa in Table 2.
CDNs. CDN providers serve hundreds of thousands of sites.
Although these CDN services can (and are) abused to conduct
malicious activities [9], their IP addresses are not actionable.
Because these are fundamentally shared services, blocking
such IP addresses will also disrupt access to benign sites
served by these IPs. We collected the IP ranges used by 5 pop-
ular CDN providers: AWS CloudFron [12], Cloudﬂare [11],
Fastly [18], EdgeCast [16] and MaxCDN [25]. We then check
how many IPs in TI feeds fall into these ranges. Column
CDNs in Table 2 shows the result.
! Finding: Among the 47 feeds in the table, 33 feeds have
at least one unroutable IP, and for 13 of them, over 1% of the
addresses they contain are unrouteable. Notably, the Paid IP
Reputation feed in the spam category has an unroutable rate
over 78%. Although it is not documented, a likely explanation
is that this feed may include unroutable IPs intentionally, as
this is a known practice among certain spam feeds. For exam-
ple, the Spamhaus DROP List [41] includes IP address ranges
known to be owned or operated by malicious actors, whether
currently advertised or not. Thus, for feeds that explicitly do
include unroutable IPs, their presence in the feeds should not
necessarily be interpreted as a problem with quality control.
We further checked feeds for the presence of any “reserved
IPs” which, as documented in RFC 8190, are not globally
routable (e.g., private address ranges, test networks, loopback
and multicast). Indeed, 12 feeds reported at least one reserved
IP, including four of the Paid IP Reputation feeds (excepting
the spam category), six of the Badips feeds, and the FB Mali-
cious IPs and DShield IPs feeds. Worse, the Paid IP Reputa-
tion feeds together reported over 100 reserved IPs. Since such
addresses should never appear on a public network, reporting
such IPs indicates that a feed provider fails to incorporate
some basic sanity checks on its data.
There are 21 feeds that include IPs from top Alexa do-
mains, as shown in column Alexa in Table 2. Among these
IPs there are 533 A records, 333 IPs of MX records and 63
IPs of NS records. The overlapped IPs include multiple in-
stances from notable domains. For example, the IP addresses
of www.github.com are included by Malc0de IP Blacklist.
Paid IP Reputation in the malware category contains the
IP address for www.dropbox.com. Alienvault IP Reputation
contains the MX record of groupon.com, and Badips SSH
also contains the IP addresses of popular websites such as
www.bing.com.
Most of the feeds we evaluated do not contain IPs in CDN
ranges, yet there are a few (including multiple Paid IP Repu-
tation feeds, Badips feeds and Alienvault IP Reputation) that
have signiﬁcant intersection with CDN IPs. Alienvault IP Rep-
utation and Badips feeds primarily intersect with Cloudﬂare
CDN, while most of the overlap in the Paid IP Reputation
malware category overlaps with AWS CloudFront.
Overall, the rate of false positives in a feed is not strongly
correlated with its volume. Moreover, certain classes of false
positives (e.g., the presence of Top Alex IPs or CDN IPs)
seem to be byproducts of how distinct feeds are collected
(e.g., Badips feeds tend to contain such IPs, irrespective of
volume). Unsurprisingly, we also could ﬁnd not correlation
between a feed’s latency and its accuracy.
3.7 Coverage
The coverage metric provides a quantitative measure of how
well a feed captures the intended threat. A feed with perfect
coverage would include all indicators that belong in a category.
Unfortunately, as discussed above, there is no systematic way
for evaluating the exact accuracy or coverage of a feed since
it is unrealistic to obtain ground truth of all threat activities
on the Internet.
However, there are some large-scale threat activities that
are well-collected and well-studied. One example is Inter-
net scanning. Researchers have long been using “Internet
telescopes” to observe and measure network scanning activi-
ties [6, 15, 29]. With a large telescope and well-deﬁned scan
ﬁltering logic, one can obtain a comprehensive view of global
scanning activities on the Internet.
To this end, we collected three months of trafﬁc (from
January 1st to March 31st 2018) using the UCSD network
telescope [38], which monitors a largely quiescent /8 network
comprising over 16 million IP addresses. We then used the de-
fault parameters of the Bro IDS [7] to identify likely scanning
trafﬁc, namely ﬂows in which the same source IP address
is used to contact 25 unique destination IP addresses on the
same destination port/protocol within 5 minutes. Given the
large number of addressed being monitored, any indiscrimi-
nate scanner observed by TI feeds will likely also be seen in
our data. Indeed, by intersecting against this telescope data we
are able to partially quantify the coverage of each TI scanning
feed.
The scanners we collected from the telescope consist of
20,674,149 IP addresses. The total number of IPs in all the
scan feeds during this period is 425,286, which covers only
1.7% (363,799 shared IPs) of all the telescope scan IPs. On the
these feeds can be used to ensure malicious ﬁles do not appear
in a customer’s whitelist. In this section we present our analy-
sis on eight ﬁle hash feeds, also collected from December 1st,
2017 to July 20th, 2018. We use the same metrics deﬁned in
Section 2.3.
The ﬁle hash feeds we collected use a range of different
hash functions to specify malicious ﬁles, including MD5,
SHA1, SHA256 and SHA512 (and some feeds provided val-
ues for multiple different hash functions to support interoper-
ability). Since most indicators in our dataset are MD5s, we
have normalized to this representation by using other feeds
and the VirusTotal service to identify hash aliases for known
malicious ﬁles (i.e., which MD5 corresponds to a particualr
SHA256 value).
4.1 Volume
File hashes, unlike IP threat data, are not transient—a ﬁle
does not change from malicious to benign—and thus a far
simpler volume analysis is appropriate. We report volume as
the number of new hashes that are added to each feed during
our measurement period.
Intersection and Exclusive Contribution
As seen in Table 3, we examine each feed’s volume and
average daily rate. Like IP feeds, ﬁle hash feeds also vary
dramatically in volume. The majority of the hashes are con-
centrated in three feeds: FB Malware, PA Malware Indicators,
and PA Analyst, which also exhibit the highest daily rates.
The other feeds are multiple order of magnitude smaller com-
paratively.
4.2
As we mentioned earlier, to conduct intersection and exclu-
sive analysis of ﬁle hash feeds, we need to convert indicators
into the same hash type. Here we convert non-MD5 hashes
into MD5s, using either metadata in the indicator itself (i.e.,
if it reports values for multiple hash functions) or by querying
the source hash from VirusTotal [45] which reports the full
suite of hashes for all ﬁles in its dataset. However, for a small
fraction of hashes we are unable to ﬁnd aliases to conver
them to the MD5 representation and must exclude them from
the analysis in this section. This ﬁltering is reﬂected in Ta-
ble 3, in which the Volume column represents the number of
unique hashes found in each feed and the Converted column
is the subset that we have been able to normalize to a MD5
representation.
! Finding: The intersections between hash feeds are mini-
mal, even among the feeds that have multiple orders of magni-
tude differences in size. Across all feeds, only PA Analyst has
relatively high intersections: PA Analyst shares 27% of PA
OSINT’s MD5s and 13% of PA Twitter Emotet’s MD5s. PA
Malware Indicators has a small intersection also with these
two feeds. All other intersections are around or less than 1%.
Consequently, the vast majority of MD5s are unique to one
feed, as recorded in column Exclusive in Table 3. The “lowest”
exclusivity belongs to PA Twitter Emotet and PA OSINT (still
Figure 3. The coverage of each feed on different sizes of scanners. Y axis is
the proportion of scanners of a given size or larger that are covered by each
feed.
other hand, telescope scanners intersect with 85% of all IPs
in scan feeds. When looking at each feed, PA AlienVault IPs,
DShield IPs Packetmail IPs, PA Lab Scan and PA Packetmail
ramnode all have over 85% of their data intersected with
telescope scanners; the other four, though, have less than 65%
of their data shared (and the rate for PA Snort BlockList is
only 8%).
To further understand how well each scan feed detects scan-
ning activities, we measure how different sizes of scanners
in the telescope are covered by each feed. Here, scanner size
means how many IPs a scanner has scanned in the telescope
within a day. Figure 3 shows the coverage rate of each feed
over different sizes of scanners, ranging from 1,000 to 1 mil-
lion. (There are 7,212,218 scanners from the telescope whose
sizes are over 1K, 271,888 that are over 100K and 17,579 are
over 1 million.)
! Finding: The union of all the scan IPs in the feeds covers
less than 2% of the scanners collected by the telescope. Even
if we only look at the scanners with sizes larger than 10,000,
the overall coverage is still around 10%, suggesting the cover-
age capability of scan feeds is very limited. The graph shows
that, as the scanner size increases, the coverage of each feed
over the datasets also increases, and large feeds cover more
percent of telescope scanners than small feeds. This trend
aligns with the intuition that scan feeds tend to capture more
extensive scanners.
It is surprising that the small scan feeds in our collection
have a smaller percentage of their IPs shared with telescope
scanners. This contradicts the idea that small feeds would
contain a larger percentage of extensive scanners (that would
most likely also be observed by the telescope).
4 File Hash Threat Intelligence
File hashes in a threat intelligence feed are indicators for ma-
licious ﬁles. It is one of the most lightweight ways to mark
ﬁles as suspicious. One can incorporate this data to block ma-
licious downloads, malicious email attachments, and malware.
Likewise, ﬁle hashes can be used to whitelist applications and
1K10K100K1MScanner Size10%20%30%40%50%CoveragePA AlienVault IPsDShield IPsPA Packetmail ram*Packetmail IPsPaid IP ReputationPA Lab ScanPA Snort BlockListFB Aggregator_1PA AnalystTable 3. File hash feeds overview. The second column group presents feed volume, average daily rate, the number of converted MD5s (Section 4.2) and exclusive
proportion. Not in VT is fraction of hashes that are not found in VirusTotal, Not det. the fraction of hashes that are found in VirusTotal but are not labeled as
malicious by any products, and Detected the fraction that are found in VirusTotal and are labeled malicious by at least one product. Column Not in SD shows
the fraction of hashes in a feed that are not in Shadowserver Bin Check. In NSRL and In AppInfo show the absolute number of hashes found in Shadowserver
(Section 4.3). Exclusive is based on the MD5-normalized hashes counted under Converted. All the other percentages in the table are based on Volume.
Feed
FB Malware
PA Malware Indicators
PA Analyst
PA Twitter Emotet
PA OSINT
PA Sandbox
PA Abuse.ch
PA Zeus Tracker
Volume Avg. Rate Converted Exclusive Not in VT Not det. Detected Not in SD In NSRL In AppInfo
706
944,257
0
39,702
19
38,586
1,031
2
0
829
0
298
0
267
17
0
37.41% 50.50% 12.09%
99.89%
0.02% 0.04% 99.94% >99.99%
99.95%
4.26% 2.82% 92.92%
11.74% 0.78% 87.49%
99.81%
99.88%
19.06% 0.84% 80.10%
100%
72.81% 0.34% 26.85%
100%
0.37%
98.88% 0.75%
88.24% 5.88%
5.88%
100%
944,257 >99.99%
98.73%
39,702
97.97%
37,665
960
77.29%
71.65%
783
95.65%
115
100%
3
17
100%
4,070
171
166
4.44
3.57
1.28
1.15
0.07
442
2
8
0
1
0
0
0
77.29% and 71.65%, respectively). All other feeds showcase
an over 95% exclusive percentage, demonstrating that most
ﬁle hash feeds are distinct from each other.
Due to the different sources of malware between feeds, a
low intersection is to be expected in some cases. For exam-
ple, PA Twitter Emotet and PA Zeus Tracker should have no
intersection, since they are tracking different malware strains.
The other, more general feeds could expect some overlap, but
mostly exhibit little to no intersection. Considering the sheer
volume of the FB Malware feed, one might expect it would
encapsulate many of the smaller feeds or at least parts of them.
This is not the case, however, as FB Malware has a negligible
intersection with all other feeds.
Due to the lack of intersection among the feeds, we omit
the latency analysis of the hash feeds, as there is simply not
enough intersecting data to conclude which feeds perform
better with regards to latency.
4.3 Accuracy
Assessing the accuracy of ﬁle hash feeds presents a problem:
there is no universal ground truth to determine if a ﬁle is mali-
cious or benign. Thus, to gauge the accuracy of the feeds, we
use two metrics: a check for malicious hashes against Virus-
Total, and a check for benign hashes against Shadowserver’s
Bin Check service. Note that all the percentages discussed
below are based on the Volume of each feed.
4.3.1 VirusTotal
VirusTotal is a service that is often used when analyzing
malware to get a base of information about a suspected ﬁle.
Anyone can upload a ﬁle to be scanned. Upon submission,
these ﬁles will be scanned by more than 70 antivirus scanners,
which creates a report on how many antivirus scanners mark
it malicious, among other information. In this analysis, we
query VirusTotal for the hashes in each ﬁle hash feed and then
inspect the percent of hashes that are marked as malicious
and how many AV scanners have recorded them. Due to the
high volume of the FB Malware feed and the query rate limit
of VirusTotal, we randomly sampled 80,000 hashes from the
Figure 4. VirusTotal detection distribution. Each point means the proportion
of indicators (Y value) in a feed that is detected by over X number of AV
scanners in VirusTotal.
feed for this analysis.
Table 3 shows a breakdown of the base detection rates
for each feed from VirusTotal. As the PA feeds decrease in
volume, the rates at which they are found in VirusTotal also
decreases. The larger PA feeds have a much higher detection
rate than their smaller counterparts. On the other hand, FB
Malware only has 37% of its data detected by antivirus scan-
ners and 50% in VirusTotal with no detection despite being
the largest feed. This could indicate that FB Malware focuses
on threats that speciﬁcally target Facebook and that are not as
relevant to most VirusTotal users, such as malicious browser
extensions [14,20,22]. This might undermine the limited cov-
erage of VirusTotal as an oracle to detect targeted threats that
are not of broader interest.
To further understand how the scanners in VirusTotal report
the feed’s data, we plot a graph of what percentage of hashes
in each feed are detected by how many VirusTotal scanners.
As seen in Figure 4, four feeds have more than 50% of their
samples detected by over 20 scanners. PA Malware Indicators
and PA Twitter Emotet did not experience a large detection
drop before 35 scanners, indicating that most indicators in the
0102030405060Number of VirusTotal Scanner10%20%30%40%50%60%70%80%90%100%Percent of HashesPA AnalystPA Zeus TrackerPA Twitter EmotetFB MalwarePA Malware IndicatorsPA OSINTPA SandboxPA Abuse.chtwo feeds are popular malicious ﬁles recognized by many AV
vendors. While PA Sandbox has a large percent of its hashes
not presented in VirusTotal, over 70% of its samples that are
detected are marked by over 20 AV scanners, showcasing a
high conﬁdence detection.
4.3.2 Shadowserver
To more fully gauge the accuracy of the ﬁle hash feeds,
we also examined how each feed measured against Shad-
owserver’s Bin Check Service [34]. The service checks
ﬁle hashes against NIST’s National Software Registry List
(NSRL) in addition to Shadowserver’s own repository of
known software. Table 3 details how each feed compares with
Shadowserver’s Bin Check service.
It might be expected that there would be no hash found with
Shadowserver’s Bin Check service, but it is not the case. Some
of the samples from the feeds that appear in Shadowserver
are well known binaries such as versions of Microsoft Ofﬁce
products, Window’s Service Packs, calc.exe, etc. In the event
malware injects itself into a running process, it remains plau-
sible that some of these well-known binaries ﬁnd their way
into TI feeds from users wrongly attributing maliciousness.
While FB Malware has over one thousand hashes in Shad-
owserver, this is not a widespread issue, as all feeds have <1%
of their hashes contained within Shadowserver’s Bin Check
service. This showcases that while there are a few exceptions,
the feeds mostly do not contain well-known, benign ﬁles.
! Finding: Each PA feed has a negligible rate of occurrence
within Shadowserver regardless of their VirusTotal detection,
showing they do not contain generic false positives. Larger
feeds exhibit high VirusTotal detection rates except for FB
Malware, while small feeds have relatively low detection
rates. This suggests that small hash feeds might focus more
on speciﬁc malicious ﬁles that are not widely known. FB
Malware has a low VirusTotal occurrence despite its size and
has over one thousand hashes in Shadowserver, but its overall
low percentage of hashes within Shadowserver indicates that
it does not contain many known ﬁles and might have threats
not typically recognized by VirusTotal’s scanners.
5 Longitudinal Comparison
In addition to the measurement period considered so far (De-
cember 1, 2017 to July 20, 2018), we also analyzed data from
the same IP feeds from January 1, 2016 to August 31, 2016.
These two measurement periods, 23 months apart, allow us
to measure how these IP feeds have changed in two years.
Table 4 summarizes the differences between these two mea-
surement periods. In the table, 2018 represents the current
measurement period and 2016 the period January 1, 2016 to
August 31, 2016.
Volume. As shown in Table 4, feed volume has deﬁnitely
changed after two years. Among 43 IP feeds that overlap
both time periods, 21 have a higher daily rate compared with
2 years ago, 15 feeds have a lower rate, and 7 feeds do not
Table 4. Data changes in IP feeds compared against the ones in 2016, Avg.
Rate shows the percentage of daily rate changed over the old feeds. The two
columns under Unrt show the unroutable rates of feeds in 2016 and 2018
separately. The two columns under CDN present the number of IPs fall in
CDN IP ranges in old and new data.
Feed
Scan Feeds
PA AlienVault IPs
PA Packetmail ram*
Packetmail IPs