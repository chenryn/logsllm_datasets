### Unroutable Fraction and Alexa Top 25,000 Domains
The unroutable fraction (Unrt) is calculated relative to the total number of IP addresses. Blocking access to popular Internet sites or triggering alarms whenever such sites are accessed would be highly disruptive for an enterprise. For our analysis, we periodically collected the top 25,000 domains from Alexa (3-4 times a month) over the course of the measurement period [2]. To address the high turnover in these lists [33], we restricted our whitelist to include only those domains that appeared in the top 25,000 every time we polled Alexa over our 8-month measurement period. This left us with 12,009 domains. We then queried DNS for the A, NS, and MX records of each domain, collecting the corresponding IP addresses. In total, we gathered 42,436 IP addresses associated with these domains. We computed the intersection of these IPs with Threat Intelligence (TI) feeds and presented the results in the "Alexa" column of Table 2.

### Content Delivery Networks (CDNs)
CDN providers serve hundreds of thousands of sites. Although these services can be (and are) abused for malicious activities [9], their IP addresses are not actionable because they are shared services. Blocking such IP addresses would disrupt access to benign sites served by these IPs. We collected the IP ranges used by five popular CDN providers: AWS CloudFront [12], Cloudflare [11], Fastly [18], EdgeCast [16], and MaxCDN [25]. We then checked how many IPs in TI feeds fall into these ranges. The results are shown in the "CDNs" column of Table 2.

### Finding: Unroutable IPs in TI Feeds
Among the 47 feeds in the table, 33 feeds have at least one unroutable IP, and for 13 of them, over 1% of the addresses are unroutable. Notably, the Paid IP Reputation feed in the spam category has an unroutable rate over 78%. Although it is not documented, a likely explanation is that this feed may intentionally include unroutable IPs, a known practice among certain spam feeds. For example, the Spamhaus DROP List [41] includes IP address ranges known to be owned or operated by malicious actors, whether currently advertised or not. Thus, for feeds that explicitly include unroutable IPs, their presence should not necessarily be interpreted as a quality control issue.

We further checked feeds for the presence of any "reserved IPs," which, as documented in RFC 8190, are not globally routable (e.g., private address ranges, test networks, loopback, and multicast). Indeed, 12 feeds reported at least one reserved IP, including four of the Paid IP Reputation feeds (excepting the spam category), six of the Badips feeds, and the FB Malicious IPs and DShield IPs feeds. Worse, the Paid IP Reputation feeds together reported over 100 reserved IPs. Since such addresses should never appear on a public network, reporting such IPs indicates that a feed provider fails to incorporate some basic sanity checks on its data.

### Intersection with Alexa Top Domains
There are 21 feeds that include IPs from top Alexa domains, as shown in the "Alexa" column of Table 2. Among these IPs, there are 533 A records, 333 IPs of MX records, and 63 IPs of NS records. The overlapping IPs include multiple instances from notable domains. For example, the IP addresses of www.github.com are included in the Malc0de IP Blacklist. The Paid IP Reputation feed in the malware category contains the IP address for www.dropbox.com. Alienvault IP Reputation contains the MX record of groupon.com, and Badips SSH also contains the IP addresses of popular websites such as www.bing.com.

### Intersection with CDNs
Most of the feeds we evaluated do not contain IPs in CDN ranges, yet there are a few (including multiple Paid IP Reputation feeds, Badips feeds, and Alienvault IP Reputation) that have significant intersections with CDN IPs. Alienvault IP Reputation and Badips feeds primarily intersect with Cloudflare CDN, while most of the overlap in the Paid IP Reputation malware category overlaps with AWS CloudFront.

### False Positives and Feed Volume
Overall, the rate of false positives in a feed is not strongly correlated with its volume. Certain classes of false positives (e.g., the presence of Top Alexa IPs or CDN IPs) seem to be byproducts of how distinct feeds are collected (e.g., Badips feeds tend to contain such IPs, irrespective of volume). We found no correlation between a feed’s latency and its accuracy.

### Coverage
The coverage metric provides a quantitative measure of how well a feed captures the intended threat. A feed with perfect coverage would include all indicators that belong in a category. Unfortunately, there is no systematic way to evaluate the exact accuracy or coverage of a feed since obtaining ground truth for all threat activities on the Internet is unrealistic.

However, some large-scale threat activities are well-collected and well-studied. One example is Internet scanning. Researchers have long been using "Internet telescopes" to observe and measure network scanning activities [6, 15, 29]. With a large telescope and well-defined scan filtering logic, one can obtain a comprehensive view of global scanning activities on the Internet.

To this end, we collected three months of traffic (from January 1st to March 31st, 2018) using the UCSD network telescope [38], which monitors a largely quiescent /8 network comprising over 16 million IP addresses. We then used the default parameters of the Bro IDS [7] to identify likely scanning traffic, namely flows in which the same source IP address is used to contact 25 unique destination IP addresses on the same destination port/protocol within 5 minutes. Given the large number of addresses being monitored, any indiscriminate scanner observed by TI feeds will likely also be seen in our data. By intersecting against this telescope data, we were able to partially quantify the coverage of each TI scanning feed.

The scanners we collected from the telescope consist of 20,674,149 IP addresses. The total number of IPs in all the scan feeds during this period is 425,286, which covers only 1.7% (363,799 shared IPs) of all the telescope scan IPs.

### File Hash Threat Intelligence
File hashes in a threat intelligence feed are indicators for malicious files. It is one of the lightest ways to mark files as suspicious. One can incorporate this data to block malicious downloads, malicious email attachments, and malware. Likewise, file hashes can be used to whitelist applications and ensure malicious files do not appear in a customer’s whitelist. In this section, we present our analysis on eight file hash feeds, also collected from December 1st, 2017, to July 20th, 2018. We use the same metrics defined in Section 2.3.

#### Volume
File hashes, unlike IP threat data, are not transient—a file does not change from malicious to benign—and thus a simpler volume analysis is appropriate. We report volume as the number of new hashes added to each feed during our measurement period.

#### Intersection and Exclusive Contribution
As seen in Table 3, we examine each feed’s volume and average daily rate. Like IP feeds, file hash feeds also vary dramatically in volume. The majority of the hashes are concentrated in three feeds: FB Malware, PA Malware Indicators, and PA Analyst, which also exhibit the highest daily rates. The other feeds are multiple orders of magnitude smaller comparatively.

#### Conversion and Exclusion
To conduct intersection and exclusive analysis of file hash feeds, we need to convert indicators into the same hash type. Here, we convert non-MD5 hashes into MD5s, using either metadata in the indicator itself (i.e., if it reports values for multiple hash functions) or by querying the source hash from VirusTotal [45], which reports the full suite of hashes for all files in its dataset. However, for a small fraction of hashes, we are unable to find aliases to convert them to the MD5 representation and must exclude them from the analysis in this section. This filtering is reflected in Table 3, where the "Volume" column represents the number of unique hashes found in each feed, and the "Converted" column is the subset that we have been able to normalize to an MD5 representation.

#### Finding: Minimal Intersections
The intersections between hash feeds are minimal, even among the feeds that have multiple orders of magnitude differences in size. Across all feeds, only PA Analyst has relatively high intersections: PA Analyst shares 27% of PA OSINT’s MD5s and 13% of PA Twitter Emotet’s MD5s. PA Malware Indicators has a small intersection also with these two feeds. All other intersections are around or less than 1%. Consequently, the vast majority of MD5s are unique to one feed, as recorded in the "Exclusive" column of Table 3. The "lowest" exclusivity belongs to PA Twitter Emotet and PA OSINT (still 77.29% and 71.65%, respectively). All other feeds showcase an over 95% exclusive percentage, demonstrating that most file hash feeds are distinct from each other.

Due to the different sources of malware between feeds, a low intersection is expected in some cases. For example, PA Twitter Emotet and PA Zeus Tracker should have no intersection, as they track different malware strains. The more general feeds could expect some overlap but mostly exhibit little to no intersection. Considering the sheer volume of the FB Malware feed, one might expect it to encapsulate many of the smaller feeds or at least parts of them. This is not the case, however, as FB Malware has a negligible intersection with all other feeds.

#### Accuracy
Assessing the accuracy of file hash feeds presents a problem: there is no universal ground truth to determine if a file is malicious or benign. Thus, to gauge the accuracy of the feeds, we use two metrics: a check for malicious hashes against VirusTotal and a check for benign hashes against Shadowserver’s Bin Check service. Note that all the percentages discussed below are based on the volume of each feed.

##### VirusTotal
VirusTotal is a service often used when analyzing malware to get a base of information about a suspected file. Anyone can upload a file to be scanned. Upon submission, these files will be scanned by more than 70 antivirus scanners, which creates a report on how many antivirus scanners mark it malicious, among other information. In this analysis, we query VirusTotal for the hashes in each file hash feed and then inspect the percent of hashes that are marked as malicious and how many AV scanners have recorded them. Due to the high volume of the FB Malware feed and the query rate limit of VirusTotal, we randomly sampled 80,000 hashes from the feed for this analysis.

Table 3 shows a breakdown of the base detection rates for each feed from VirusTotal. As the PA feeds decrease in volume, the rates at which they are found in VirusTotal also decrease. The larger PA feeds have a much higher detection rate than their smaller counterparts. On the other hand, FB Malware only has 37% of its data detected by antivirus scanners and 50% in VirusTotal with no detection despite being the largest feed. This could indicate that FB Malware focuses on threats that specifically target Facebook and are not as relevant to most VirusTotal users, such as malicious browser extensions [14, 20, 22]. This might undermine the limited coverage of VirusTotal as an oracle to detect targeted threats that are not of broader interest.

To further understand how the scanners in VirusTotal report the feed’s data, we plot a graph of what percentage of hashes in each feed are detected by how many VirusTotal scanners. As seen in Figure 4, four feeds have more than 50% of their samples detected by over 20 scanners. PA Malware Indicators and PA Twitter Emotet did not experience a large detection drop before 35 scanners, indicating that most indicators in the two feeds are popular malicious files recognized by many AV vendors. While PA Sandbox has a large percent of its hashes not presented in VirusTotal, over 70% of its samples that are detected are marked by over 20 AV scanners, showcasing a high confidence detection.

##### Shadowserver
To more fully gauge the accuracy of the file hash feeds, we also examined how each feed measured against Shadowserver’s Bin Check Service [34]. The service checks file hashes against NIST’s National Software Registry List (NSRL) in addition to Shadowserver’s own repository of known software. Table 3 details how each feed compares with Shadowserver’s Bin Check service.

It might be expected that there would be no hash found with Shadowserver’s Bin Check service, but this is not the case. Some of the samples from the feeds that appear in Shadowserver are well-known binaries such as versions of Microsoft Office products, Windows’ Service Packs, calc.exe, etc. In the event malware injects itself into a running process, it remains plausible that some of these well-known binaries find their way into TI feeds from users wrongly attributing maliciousness.

While FB Malware has over one thousand hashes in Shadowserver, this is not a widespread issue, as all feeds have <1% of their hashes contained within Shadowserver’s Bin Check service. This showcases that while there are a few exceptions, the feeds mostly do not contain well-known, benign files.

#### Finding: Accuracy and Detection Rates
Each PA feed has a negligible rate of occurrence within Shadowserver regardless of their VirusTotal detection, showing they do not contain generic false positives. Larger feeds exhibit high VirusTotal detection rates except for FB Malware, while small feeds have relatively low detection rates. This suggests that small hash feeds might focus more on specific malicious files that are not widely known. FB Malware has a low VirusTotal occurrence despite its size and has over one thousand hashes in Shadowserver, but its overall low percentage of hashes within Shadowserver indicates that it does not contain many known files and might have threats not typically recognized by VirusTotal’s scanners.

### Longitudinal Comparison
In addition to the measurement period considered so far (December 1, 2017, to July 20, 2018), we also analyzed data from the same IP feeds from January 1, 2016, to August 31, 2016. These two measurement periods, 23 months apart, allow us to measure how these IP feeds have changed in two years. Table 4 summarizes the differences between these two measurement periods. In the table, 2018 represents the current measurement period and 2016 the period from January 1, 2016, to August 31, 2016.

#### Volume
As shown in Table 4, feed volume has definitely changed after two years. Among 43 IP feeds that overlap both time periods, 21 have a higher daily rate compared with two years ago, 15 feeds have a lower rate, and 7 feeds do not show a significant change.