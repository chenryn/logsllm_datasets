法找到产生这些异常行为的原因，最后就要重新安装系统了。好在，有 InstallShield 在，这
使得重装一个系统变得非常之简单。 Macrovision 公司标准化了安装和卸载软件的过程，对
于常见的 Windows 软件可以在几分钟内卸载和重装完成。因为在新安装的 Windows 操作系
统里没有内核钩子，隐藏的注册表项或者隐藏的目录的存在，卸载软件最终使得异常行为消
失。
在卸载软件或者重装系统之前，还有一些可选的做法。首先就是恢复你的内核系统调用
表，然后检查一下识别不了的目录，注册表项，服务和进程。不幸的是，这需要你对你的操
作系统非常的熟悉，但如果所有异常的地方都已经排除掉了，那么花费一些时间去熟悉一下
自己的操作系统是非常值得的。
我推荐你使用 Rootkit Unhooker 来恢复内核系统调用表，如图 13-11 所示。这个软件可
以用来检测内核钩子和恢复系统调用表里的单个函数。也可以用这个软件来查找的进程、设
备、文件和代码钩子。和 Unlike Rootkit Hook Analyzer 、IceSword 不同，Rootkit Unhooker 明
确地显示了钩子所属的模块，这使得移除 rookit 变得非常简单。
图 13－11
通过比较在恢复内核系统调用表前后的服务列表（控制面板－>管理工具－>服务）可
以检测隐藏服务，通过这个服务可以找到它相关的注册表项和文件。注册表项可以通过在注
册表搜索（通常是在 HKEY_LOCAL_MACHINE\ SYSTEM\CurrentControlSet\Services）显示
在服务属性的常规标签页里的服务名找到。文件可能通过在注册表项的 ImageKey 的值找到。
一但把这个注册表项和文件删除了，通过重新启动计算机就可以把检测到的异常给清除掉。
通过比较在恢复内核系统调用表前后的进程列表（任务管理器－>进程标签页）也可以
找到隐藏的进程映像名，可以通过这个名字找到相关的注册项和文件。
通过比较在恢复内核系统调用表前后导出的注册部分可以找出隐藏的注册表条目，通过
这个条目可以找到相关的文件。要导出一部分注册表可以点击 开始－运行，然后输入
Regedt32 。 从 打 开 的 注 册 表 编 辑 器 里 选 择 一 个 可 能 包 含 有 隐 藏 项 的 项 （ 通 常 是
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services，然后选择 文件－导出。恢
复内核系统调用表前后导出的文件可能通过 WinDiff 东或者其它文件比较工具来进行比较。
通过找出这些导出文件的不同之处可以找到隐藏的注册表项，然后通过注册表项找到 rootkit
文件。
通过比较在恢复内核系统调用表前后的文件系统的其中一部分可以得到一个直观的文
件路径。通过比较目录列表，使用一个命令行窗口（开始－运行，输入 cmd）来把目录列表
重定向输出到文件里（“dir > comparisonFile.txt”）。然后使用 WinDiff 或者一个类似的文件比
较工具来检查不同的地方。
做完这些工作之后，会发现许多检测到的异常实际上是由你计算机上的安全软件所引起
的。如果删除了这些钩子、注册表条目和文件会导致你的计算机完全暴露在 rootkit 的面前，
这刚好是和你的愿望相反的。
安全模式
如果你在启动 windows 的时候按下 F8 键，就会出现一个带有一些启动选项的文本菜单
界面。如果要定位 rookit，带命令行的安全模式是最好的选择。这会使得 windows 只加载一
些基本的驱动和服务并且提供一个命令行来操作文件和执行个别的 windows 程序。要在一
个命令行里排除异常，你需要懂得下面的几个基本命令：
cd xxx － 改变当前目录到 xxx（例如 cd c:\wndows\system32）
dir － 列出当前目录的文件
xxx － 执行程序 （例如 NotePad）
type xxx － 显示文件 xxx 的内容 （例如 type autoexec.bat）
regedt32 － 启动注册表编辑器
你还需要知道如何去启动查找异常的检测工具。如果你还不知道这个工具的位置，请查
看一下快捷方式的属性。一旦你进入到了安全模式你就需要手动地去操作目录和执行程序。
之所以说在带命令行的安全模式里定位 rootkit 是一个非常好的说一环境是因为在这个
环境下 rookit 不会被加载也不能能够保护它自己。在这个模式下你可以查看系统的每一个地
方而不会受到 rootkit 的影响，并且删除文件和注册表项会受到其它的保护。当然，这都是
在假定 rootkit 没有加载的情况下，所以记得检查异常的地方。如果异常仍然存在，那么即
使是在安全模式下也不会有太大帮助了。
有很多方式可以使得软件在 Windows 启动时进行加载和运行。Rootkit 可以和系统文件
捆绑在一起，这样在系统文件被加载时就会和 rootkit 一起加载了。Rootkit 可以替换掉普通
的程序，在加载后再调用原来的程序（经过重命名）。Rootkit 可以作为一个安全模式下所必
须的驱动被加载。这些都是对抗安全模式下检测 rootkt 的方法。幸运的是，很多 rootkit 都
使用了这些技术来抢得系统的控制权，这使得这些加载方法几乎不可能成功。就像文件、进
程和注册表项的隐藏一样，rootkit 在使用了一些特殊的技术后就很容易被检测到。这使得标
准的设备驱动加载方法成为 rootkit 初始化的首先方法，而这种方法在安全模式是可以检测
到的。
如果你不喜欢在一个命令行窗口里进行操作，安全模式（不带网络连接或者命令行）会
加载 windows 资源管理器，在这个环境里和标准启动的环境是非常相似的，但要记住 rootkit
可能会作为一个 windows 资源管理器的扩展随着资源管理器的启动的而启动。如果在标准
的安全模式下无法排除异常，那就尝试在命令行里试一下。
总结
本章里所描述的 rootkit 检测方法可以让 rootkit 设计都了解到检测技术对 rootkit 的
限制。你精心布置的环境可能一须要反检测功能，但是很多 rootkit 需要有一些反检测功能，
即使不是在本章里所描述的所有防检测技术都需要。特别地，本章讲述了下面的内容：
内核系统调用表钩子检测的对抗
内核跳转钩子检测的对抗
用户层钩子检测的对抗
进程检测的对抗
文件和注册表项隐藏检测的对抗
交换数据流检测的对抗
下一章我们将会通过把反 rootkit 技术加进来进一步地扩展 rootkit 设计所要注意的问题。
和对已插入的 rootkt 的检测相反，这是用来阻止 rootkit 初始化加载和运行的。
笫十四章 Rootkit
Rootkit
Rootkit
Rootkit 的防护
概述
前一章我们讲了 rootkit 的检测和移除方法，不过，对抗 rookit 的一个更好的方法就是
在它控制你的计算机之前阻止它进行安装，一旦 rootkt 安装到了系统中，一个成功的 rootkit
会使得移除它变得非常的困难，所以这就要“预防为主，治疗为辅”。
本章里所讲的防护技术大部分都同时适用于 rootkit 和其它软件的通用安全技术，但是
也有一些是专门针对 rootkit 的防护技术。在大多数情况下，rootkit 的安装方法和其它的恶
意软件一样：通过利用操作系统或者操作系统组件的漏洞来进行安装。因此，很多时候 rootkit
的防护和一般的保护并没有什么区别。不过，专门针对 rootkit 的防护方法也可以对付一些
rootkit。
清楚如何去防止 rootkit 进行安装对于 rootkit 设计者来说那是非常有用的。不管你是作
为攻击的一方还是防护的一方，你都应该弄明白当前的 rootkit 防护技术。
本章包括下面的内容：
操作系统更新
自动更新
个人防为墙
基于主机的入侵防护系统
Rootkit 防护技术
操作系统更新
到目前为止，你能做的最好的安全措施就是让你的计算机保持现状。微软有一些由非常
技术非常高的工程师组成的小组在日以继夜的寻找操作系统的漏洞并修复它们，这些漏洞的
修复通常是通过打补丁的形式来进行的，这些补丁既可以修复大量的问题也可以只是简单地
改变一个文件的权限，不管这些补丁的作用是否是非常重要的，去更新你的操作系统就一定
是非常重要的，所以你必须要定期的进行检查更新。
好，现在你的操作系统已经更新过了，那么请花一点时间来检查一下反病毒软件的特征
库，特征库是用来识别所有已知的漏洞的，如果没有最新的特征库，你的反病毒软件的作用
就大大地减小了，所以你最好花一点时间来对你的反病毒软件进行检查更新。
当一个新的病毒或者漏洞被发现时，在补丁公布了但你还没有进行更新的这段时间是一
个非常关键的时期，在这段时间里，一些聪明的黑客有可能会对补丁进行反汇编来找出补丁
对操作系统做了什么，这样就可以找出漏洞的所在，然后利用这些漏洞来对还未打上补丁的
系统进行攻击，新的漏洞攻击要在这些系统上进行扩散并不需要很长的时间，所以保证你的
操作系统为已更新状态是非常重要的。
自动更新
自动更新看起来是一个能让你的操作系统操持最新状态的一个非常好的方法。然而，有
一些入侵技术会利用自动更新功能来做一些坏事。
这些入侵技术的其中之一叫“ARP 缓存中毒攻击”（ARP cache poisoning），这种技术利
用了地址解析协议（ARP）的开放体系结构来使计算机认为一台指定的计算机在一个修改过
的 IP 上，如果你的更新软件使用一台特定的计算机而其 IP 地址被修改成了别的地址，那么
你就会从一台恶意的计算机接收到更新信息。
另一种入侵技术是先控制在从你的计算机到提供更新的服务器的路由所经过的任一台
计算机，通过把这台计算机的网卡设置成混杂模式，如果信号是加密的，恶意软件就可以截
获所有经过的网络数据，如果信号是加密的，这使得恶意机器伪装成目标服务器，如果信号
没有加密，恶意机器就可以通过简单地修改返回的数据包来达到目的，不管是哪一种，这个
更新都不会是你所期望的那样。
要防护自动更新的漏洞，你可以定期的进行手动更新，如果你在 Internet 浏览器里输入
更新网页的地址并且网页显示正常，在点击立即更新后很有可能会进行预期的更新操作，记
住在你把鼠标移动到更新链接上的时候在浏览器的状态栏会显示链接的地址，如果所显示的
链接地址不是正确的，在点击链接之前你可能要进行进一步的了解或者加强一下安全防护。
因为自动更新是加密并且有签名的，所以被恶意篡改的可能性比较小，而浏览器比较容
易产生浏览和文件传输漏洞，所以被恶意篡改的可能性比较高。所以，把自动更新改成手动
更新只有在对恶意篡改的意识比较高时才适用。
个人防火墙
在笫 6 章里建立的 TDI 连接例子可能会让人认为防火墙在对底层的 rootkit 防护上的作
用比较小，甚至是不起作用，这种想法是错误的，因为 rootkit 只有在被安装到了系统里后
才能创建底层连接，因此阻止 rootkit 的安装更来得实际一点，这就是个人防火墙所做的：
防止来意软件的安装。
在讲述各种个人防为墙之前，我必须先指明，Windows XP 自从 2001 年 11 月起就自带
了一个免费的个人防为墙，下面是微软的描述：
Tip 微软 Internet 连接防火墙（ICF）是作为一个 Windows XP 的特性自带的，如果你
需要防火墙的保护你应该启用它，（如果你使用系统里的向导来设置 Internet 连接
并且选择了直接或者拨号方式连接到因特网，IFC 可能已经自动启用了。）
在运行 Windows XP 的时候，如果你访问一些服务，IFC 会动态地打开和关闭许多
端口，但有几个是例外的。由于 ICF 仅仅提供数据流入保护，因此如果你想要对流出
数据进行控制的话，你可能需要使用笫三方的防火墙。
如果你对使用这个个人防为墙感兴趣，又或者你无法保证你是否已经使用了这个防火
墙，请这样做：
1.点击开始菜单（通常是在显示器的左下角）
2.选择控制面板
3.选择网络连接
4.选择本地连接
5.点击常规选项卡里的属性按钮
6.点击高级选项卡
7.点击 Windows 防火墙里的设置按钮
然后系统可能会询问是否要打开 Windows 防火墙/ICS 服务，如果你想要使用此防为墙
就点是，如果你的 Windows 系统有 ICS 服务，它会被启动来支持防为墙的运行。
在 Windows 防火墙对话框的常规选项卡里，选择“启用”单选按钮然后点击确定就会
激活 Winodws 防火墙，这样做以后，你的机器就变得安全多了，以后只有在一个程序被拦
截的时候才会打扰到你，这大概是最简单的安全软件了。
如果你需要更多一点的保护，又或者你的系统比 Winodows XP 还要旧，你就需要看一
下下面一节所列出的防火墙列表了，我把它们分成了免费和收费的两种以帮助你决定选择哪
一个来使用。
免费个人防火墙
本书的许多地方都验证了这样一句话：“一分钱一分货”，免费的个人防火墙也不例外。
不幸的是，个人防火墙产业已经发展到了这样一个地步：尽可能地防止非正式用户找到免费
的防为墙。以前的免费防火墙已经变成收费了，并且尽可能地删除网络上的免费版本。幸运
的是，在 OldVersion.com 上还有一些好心人继续提供世界上曾经“比较好”的软件。
Tiny 个人防火墙
因为 Tiny 已经重新修改过架构并且不再免费了，所以现在比较难找到它，但 Tiny 是一
个功能全面，底层的带有许多由顶级产品提供的附带功能的防火墙，这个软件强有力地证明
了新的并不是最好的，所以请在 www.oldversion.com 查找最终的免费版本（2.0.15A).
Zone Alarm 防火墙
这是一个带有基本功能的防为墙，它的唯一目的是想让你购买 Zone Alarm Pro，幸运的
是，一个带有基本功能的防火墙已经足够对付到当今的这些威胁，现在还可以 在
www.zonelabs.com 找到这个防火墙。
Sysgate 个人防火墙
这个防火墙和 Tiny 一样，是重构后的牺牲者。由 Symantec 提供的新版防火墙不再免费
了 ， 但 在
www.oldversion.com 里 仍 然 可 以 找 到
Sygate 个 人 防 火 墙 的 最 终 免 费 版
（5.6.2808）。
其它个人防火墙
如果你已经考虑过了刚才所讲的免费个人防火墙，但是你要找一些更好的以供长期使用
的防火墙，那么请看下面，下面列出的防火墙提供了只有在专业的商业软件才有的功能和维
护上的选择。
Kerio 个人防火墙
这个软件的前身就是 Tiny 个人防火墙，你可以花一点钱来获得改商标后的版本，也可
以花更多的钱来获得 McAfee 反病毒软件，如果你对 Kerio 企业级防火墙所提供的保护感兴
趣，我建议你先下载 Tiny 个人防火墙的试用版，如果你喜欢它的话，你可以在 www.kerio.com
购买 Kerio 个人防火墙。
Symantec/Norton 防火墙
这个软件的前身是 Sygate 个人防火墙，你可以通过花费一点钱来获得这个升级版和一
年的自动更新。如果你对长期的保护比较感兴趣，Norton 防火墙是一个不错的选择，Norton
是反病毒软件中比较受欢迎的，并且它的反后门功能也比较强。Symantec/Norton 防火墙可
以从 www.symantec.com 购买。
Zone Alarm 专业防火墙
如果你不喜欢 Zone Alarm 仅仅是让你购买 Zone Alarm Pro 的一个诱饵，你可以先等一
下，直到你发现你真的需要 Zone Alarm 网络安全套装来获得反病毒和反后门保护，查看
www.zonelabs.com 来获得 Zone Alarm 系列产品的销售指标。
基于主机的入侵防护系统
如果你曾经读过这本书，你就知道一个写得好的 rootkit 不会被反病毒软件检测到，如
果在看过笫 11 章的浏览器漏洞利用的例子，你就知道通过一个网页把 rootkit 插入到一台机
器里是多么的容易，综合上面这两个例子可以得出，rootkit 的防护需要对一般的安全软件所
没有的方面进行增强。幸运的是，基于主机的入侵防护系统，或者 HIPS 作为正在发展的一
个领域，可以通过强化，虚拟化或者阻止意外操作来防护入侵。
强化
强化（Hardening）是防护所有可能的威胁的行为，这和阻止所有“已知”的漏洞利用
不同，阻止“未知”的漏洞利用同样很重要。阻止“未知”的漏洞利用似乎是一个不太可能
的事情，但是有一个解决方案，办法就是修改主机的配置来防止所有类型的漏洞，举个例子，
修复 msasn1.dll 里的 ASN1BERDecCheck 溢出漏洞能够防护所有使用 ASN.1 BER 比特流编
码漏洞的变种攻击，但是反病毒软件只能防住少数的一些公开的 ASN.1 BER 比特流解码漏
洞攻击。
这种思想可以扩展到对容易受到攻击的服务进行保护，对关键文件的修改进行保护，对
敏感数据的查看进行保护，对注册表项的修改进行保护，对不安全组件的执行进行保护等等。
还可以采取一些措施来保证通信信号、网络服务、用户账号等等的安全。
强化一个系统能够防护一种已知的或者能够意料到的漏洞的所有形式的攻击。这种保护
方式实际上可以利用先前的漏洞来防护所有的变种攻击，而基于特征码的反病毒软件只能依
赖于每个新变种的特征码。要更好地理解强化的概念，我推荐大家看下 Samurai，这是一个
免费实用的强化工具，可以用来强化所有的 Windows 操作系统，从 http://turbotramp.fre3.com
可以下载到，Samurai HIPS 如图 14-1 所示。
图 14-1
这个工具到目前有 30 多个强化可以单独选择的选项可以选择来提供自定义的保护，你
可以随意下载（从网站上）并且测试 Samuai 里提供的各种强化技术，并且不用担心：每一
种配置对系统更改后都可以撤消掉，无论是注册表修改，文件权限修改，服务修改甚至是删
除文件，在没有选择任何一个强化选项或者卸载了 Samurai 后你的机器就会恢复到原始的
状态。然而，要注意：Samurai 已经有一年多没有更新过了，所以有很多比较新的漏洞的防
护并没有添加进来，所以，现在的 Samurai 并不适用于那些定期地上网冲浪的用户。
在撰写本文的时候，Samurai 包含了下面的强化技术：
禁用已知的不安全 ActiveX 控件
禁用 AIM URL 协议处理例程
保护匿名会话
禁止 Explorer 自动打开文件
停止后台智能传输服务
禁用危险的 URL 协议
防护拒绝服务攻击
禁用不安全的工作图标处理例程
设置并提高“我的电脑”的安全性
禁用危险的 .grp 文件转换
禁用来宾账户
禁用 HTML 程序里的 MIME 类型文件
提高 HTTP 设置参数的安全性
停止 Windows 索引服务
禁用空会话许可证记录功能
防护 LSASS（基于震荡波）漏洞
停止 Windows 消息服务
停止 Net DDE 服务
禁用私人通信传输功能
禁用远程数据服务 DataFactory
停止远程注册表服务
停止基于 RPC 的 DCOM
删除密码备份文件
禁用 Shell URL 协议处理例程
禁用通用即插即用服务
阻止未经过请求进入的网络通信
禁用分布式网页创作（Distributed Web Authoring）
禁用 Windows 因特网命名服务
检查 FRAME/IFRAME NAME 域
检查图像文件的正确性
阻止 IE 弹窗
防护 rootkit 的加载
禁用所有已经的后门软件
至少，这个列表应该足够来表明 rootkit 安装软件成功的机会有多大，这些漏洞并没有
被反病毒软件，反后门软件，操作系统更新，浏览器安全加强软件，或者个人防火墙所覆盖，
在今天的安全防护方案里只把基于主机的入侵防护系统作为最后的一道防线。
虚拟化
虚拟化是指从一个虚拟机里执行操作，这允许你获得许多 rootkit、蠕虫、木马、后门和
其它有害的软件，而不用担心它会永久地存在你的电脑里，因为你随时都可以启动一个新的
虚拟机。
虚拟入侵防护的问题是它允许执行文件操作，这样后门程序就可以电子邮件作为目标并
且可以共享系统中的持久性文件。另外，如果你不经意地把别的机器给感染了，那么在你意
识到不对劲之前是无法通过重启虚拟机的来移后门程序的。
阻止意外的操作
阻止意外的操作需要一个启发式的基准以精确地定义什么才是合法的操作。一旦定义了
一组合法的操作，一个启发式入侵防护系统就可以终止意外的的保管并且把异常的行为报告
给用户。通过这种方式可以制作一个非常棒的 rootkit 检测器，但是对于一种惨不预防工具
是否有价值是值得怀疑的。启发式保护和亡羊补牢的做很相似，它根本没有提供一个可行的
解决方案。
Rootkit
Rootkit
Rootkit
Rootkit 防护技术
在这部分会讲述一些用来防护 rootkit 的技术
内核钩子的防护
如果一个防护系统不断地监视内核系统调用表，并且在发现被修改后马上更新系统调用
表，这样就可在 rootkit 有机会进行破解前阻止它们继续下去。这种功能应该带有在检测到
修改后能够报告给用户的功能，在上网冲浪的时候，这种带有报告功能的 rootkit 检测器是
检测恶意网页的一种非常好的方式。
不幸的是，许多 rookit 初始化安装时仅仅修改一些文件和启动配置，而把实际的感染操
作留在下次重启时进行。如果 rookit 是在钩子防护软件之前加载的，那么有可能钩子防护系
统做的只是给用户造成一种虚假的安全感。
服务加载的防护
大多数操作系统使用的服务都在系统启动初始化时开启。监视并报告在启动初始化后启动的
服务可以防护基于服务的后门程序。除非操作者意识到，否则服务通常是不会启动的，例如，
启动一个程序或者安装一个新的软件是加载一个新服务的很好的原因，而上浏览网页却不
会。这些情况都是有清楚的描述的，一个简单的对话框来询问用户是否允许加载一个服务可
以以最少的交互性来达到最大的保护。这种保护技术应该带有一个白名单，当用户指定为“总
是允许”的时候就对它进行更新。
不幸的是，这种防护技术和内核钩子防护有一个非常类似的缺点，服务加载防护系统不
能对在系统启动期间进行加载的服务进行防护，而这却是大多数 rootkit 所采取的初始化方
式。
驱动加载的防护
这种防护机制和服务加载防护很类似，但驱动加载防护捕捉到大量的 rootkit。如果一个
驱动在系统启动后的某一时刻被加载，那么除非用户在安装一个新的软件，否则强烈建议用
户阻止此行为。此外，如果程序所使用的驱动加载技术是非常规的技术，那么完全没有必要
去 建 议 用 户 如 何 做 。 例 如 ， 据 我 所 知 ， 使 用 带 SystemLoadAndCallImage 参 数 的
ZwSetSystemInformation 来加载驱动的只有 rootkit，防护这种加载技术不需要与用户进行交
互。
不幸的是，这种防护技术和服务加载防护有同样的限制，除了使用了非常规加载技术的
可能安全地阻止掉。
数据段里的代码防护
正常格式的软件会把代码和数据区分开，在程序被加载时，代码和数据会被放到内存的
不同的段里，如果程序不是遵守这种规则的，那么很可能是恶意的，实际上对于这种程序的
执行可以不用通过与用户交互而阻止它的执行。
不幸的是，在数据段里搜索代码是非常占用进程资源的。另外，误报的可能性会影响到
其它优秀的安全机制，由误报和处理能力的缺点注定会随着时间的推移而克服掉，所以期望
这种检测方法会很快地流行开来。
堆栈执行防护
在笫 10 章里提到的 HTML 漏洞是利用堆栈执行代码的一个很好的例子，特别是用来绑
定 28876 端口的代码包含在本地变量 ShellcodeBytes 里，在网页已经加载并且变量里的内容
放到堆栈后，CrashAndBurn 函数会产生一个让程序返回去执行堆栈里的代码的缓冲区溢出，
这种执行代码的方式只有恶意软件才会采用，所以阻止堆栈执行代码不会造成误报。
总结
和 rootkit 的检测方法会增加 rootkit 的设计难度一样，rootkit 的防护方法增加了 rookit
的安装难度，在任何一种情况下，对目标环境有深刻了解能帮助 rootkit 设计者对 rootkit 的
设计和实现和安装软件塑造一个大概的方案。
有一些 rootkit 是由管理员进行部署的，这种情况不需要考虑任何的注意事项。还有一
些 rootkit 可能被迫要存在于安全性非常高的环境里，这种情况下要进行初始化和隐藏具有
很大的挑战性。最后，了解目标环境的安全防范措施是成功进行 rootkit 部署的一个关键环
节。
具体的安装注意事项如下：
使用防火墙
操作系统版本和补丁
基于主机的安全软件
使用的检测软件
好了，就这样！我希望你读这本书会读得愉快，正如我写这本书写得非常愉快一样。我
曾经尝试过让它变得简单，一步一步地走进 rootkit 的世界，不幸的是，rootkit 技术通常都
不简单，实际上，rootkit 能够出现的原因是因为有各种错误的存在，一个项目（或者一个操
作系统）越庞大，错误的可能性就越大，如果乐观的安全专家将着手于新兴的安全系统并且
期望来自恶意软件的入侵会减少，那么乐观的 rootkit 设计看到的只是有更多的漏洞可以去
利用。不论你对 rootkit 的爱好是来自攻击还是防守，你的目的可能是相同的：知识和理解。
我希望这本书在你的追求上能够帮到你。
附录 AAAA 免费软件
概述
此附录主要介绍用来开发和测试 rootkit 的免费工具。