Defcon Safe Mode // Aug 2020
Detecting Fake 4G Base Stations 
in Real Time
Cooper Quintin - Senior Security Researcher - EFF Threat Lab
Defcon Safe Mode With Networking 2020
Defcon Safe Mode // Aug 2020
Intro
•
Cooper Quintin
–
Senior security researcher 
–
Has a toddler (dad jokes)
–
Former teenage phone phreak
•
EFF
–
Member supported non proﬁt
–
Defending civil liberties 
–
30 years
•
Threat lab
Defcon Safe Mode // Aug 2020
Yomna!
None of this research 
would have been possible 
without her hard work. 
This is as much her project 
as mine. 
Twitter: @rival_elf
Actual photo of Yomna
Defcon Safe Mode // Aug 2020
Technology that Targets At Risk People
•
Activists, human rights defenders, journalists, domestic 
abuse victims, immigrants, sex workers, minority 
groups, political dissidents, etc…
•
Goals of this technology
–
Gather intelligence on opposition
–
Spy extraterritorially or illegally
–
Locate and capture
–
Extortion
–
Harass and intimidate
–
Stiﬂe freedom of expression
Defcon Safe Mode // Aug 2020
Jeﬀ Bezos Can Aﬀord a Security Team
Cybersecurity and AV 
companies care about the 
types of malware that aﬀects 
their customers (usually 
enterprise.) 
We get to care about the 
types of technology the 
infringe on civil liberties and 
human rights of at risk 
people.
This guy is not at risk.
Defcon Safe Mode // Aug 2020
Our Goals
•
Protect people
•
Broaden our communities` understanding of threats 
and defenses
•
Expose bad actors
•
Make better laws
Defcon Safe Mode // Aug 2020
Previous Project
Dark Caracal
Stalkerware
Defcon Safe Mode // Aug 2020
What We are Going to Talk About Today
•
Cell-site simulators AKA Stingrays or IMSI Catchers
•
How they work
•
Previous eﬀorts to detect them 
•
A new method to detect them 
•
How to ﬁx the problem
Defcon Safe Mode // Aug 2020
Cell Technology Overview
•
UE - The phone - User Equipment
•
IMSI - International Mobile Subscriber ID - ID for the 
SIM card
•
IMEI - International Mobile Equipment ID - ID for the 
hardware
•
eNodeB - Base station, what the UE is actually 
communicating with. 
•
EARFCN - The frequency a UE/EnodeB is transmitting on
•
Sector - A speciﬁc antenna on the base station
Defcon Safe Mode // Aug 2020
Cell Technology Overview
•
MIB - Master Information block, broadcast by the 
enodeb and tells where to ﬁnd the SIB
•
SIB - System information block, contains details about 
the enodeb 
•
MCC / MNC / TAC  - Mobile Country Code, Mobile 
Network Code, Tracking Area Code
•
PLMN = MCC + MNC, Public Land Mobile Network
Defcon Safe Mode // Aug 2020
Cell Technology Overview
IMSI catcher, Stingray, Hailstorm, fake base station == 
cell-site simulator (CSS)
This is acronym hell and I’m sorry. 
Defcon Safe Mode // Aug 2020
Cell Technology Overview
Defcon Safe Mode // Aug 2020
Stingray
Defcon Safe Mode // Aug 2020
What Changed Between 2G and 4G
•
eNodeB and UE mutually authenticate
•
Better encryption between eNodeB and UE
•
No longer naively connect to the strongest tower
Defcon Safe Mode // Aug 2020
How do 4G CSS Work
•
What are the vulns next 
gen CSS are taking 
advantage of?
•
Pre authentication 
handshake attacks
•
Downgrade attacks
Gotta catch em all whitepaper by Yomna
Defcon Safe Mode // Aug 2020
Pre-Authentication Vulnerabilities
•
4G has a glass jaw
•
Even though the UE authenticates the tower there are 
still several messages that it sends, receives, and trusts 
before authentication happens or w/o authentication
•
This is the weak spot in which the vast majority of 4G 
attacks happen
Defcon Safe Mode // Aug 2020
Hus
Insecure Connection Bootstrapping in Cellular Networks:The Root of All Evil - 
Hussein et al 2019
Defcon Safe Mode // Aug 2020
Hus
Insecure Connection Bootstrapping in Cellular Networks:The Root of All Evil - 
Hussein et al 2019
Here 
there be 
dragons
Defcon Safe Mode // Aug 2020
How Often are CSS Being Used
•
ICE/DHS - hundreds of times per year
–
https://www.aclu.org/news/immigrants-rights/ice-records-conﬁrm
-that-immigration-enforcement-agencies-are-using-invasive-cell-p
hone-surveillance-devices/ 
•
Local law enforcement
–
Oakland -  1-3 times per year
•
https://oaklandprivacy.org/oakland-privacy-sues-vallejo/ 
–
Santa Barbara PD - 231 times in 2017
•
https://www.eﬀ.org/deeplinks/2019/05/eﬀ-asks-san-bernardino-court-rev
iew-device-search-and-cell-site-simulator 
Defcon Safe Mode // Aug 2020
How Often are CSS Being Used
•
Foreign Spies
–
IMSI Catchers in DC 
•
Cyber Mercenaries
–
NSO Group 
https://www.amnestyusa.org/wp-content/uploads/2020/06/Moro
cco-NSO-Group-report.pdf  
•
Criminals
–
https://venturebeat.com/2014/09/18/the-cell-tower-mystery-grip
ping-america-has-now-been-solved-or-has-it/ 
Defcon Safe Mode // Aug 2020
Previous Eﬀorts to Detect CSS
App Based
•
AIMSICD
•
Snoop Snitch
•
Darshark
Strengths
•
Cheap
•
Easy to use
Weaknesses
•
Limited data
•
Lots of false positives
•
False negatives?
Defcon Safe Mode // Aug 2020
Previous Eﬀorts to Detect CSS
Radio Based
•
Seaglass
•
SITCH
•
Overwatch
Strengths
•
Better data
•
Lower level information
Weaknesses
•
Harder to set up, use, 
interpret
•
Cost of hardware
•
Can’t transmit 
Defcon Safe Mode // Aug 2020
Previous Eﬀorts to Detect CSS
Defcon Safe Mode // Aug 2020
Defcon Safe Mode // Aug 2020
Can we detect 4G IMSI Catchers?
•
How can we improve on previous attempts
–
Lower level data
–
See all towers not just what we are connecting to 
–
Compare that data over time 
–
Look at 4G antennas!
–
Verify results!
Defcon Safe Mode // Aug 2020
Introducing Crocodile Hunter
Defcon Safe Mode // Aug 2020
Crocodile Hunter Software Stack
•
Backend based on SRSLTE
–
Open source LTE software stack
–
Written in C++ 
–
Communicates with frontend over a local socket
•
Python for heuristics, database and frontend
–
Get data from socket 
–
Add it to database
–
Run heuristics 
–
Display tower locations
•
API for sharing data
Defcon Safe Mode // Aug 2020
Defcon Safe Mode // Aug 2020
Crocodile Hunter Hardware Stack
•
Laptop / Raspberry Pi
•
USB GPS Dongle 
•
SDR compatible with SRSLTE: BladeRF, Ettus B200
•
LTE Antennas
•
(Battery for Pi)
Defcon Safe Mode // Aug 2020
Crocodile Hunter Hardware Stack
Defcon Safe Mode // Aug 2020
Workﬂow
1.
Decode MIB and SIB1 for all the cells that we can see 
and record them. 
2.
Map the probable location of cells 
3.
Look for anomalies in the readings 
4.
Locate suspicious cells and conﬁrm results
Defcon Safe Mode // Aug 2020
Decode MIB and SIB1
•
SRSLTE scans a list of EARFCNS
•
If we ﬁnd a mib we decode mib and sib and send over socket
Defcon Safe Mode // Aug 2020
Database
Defcon Safe Mode // Aug 2020
Mapping out antennas in real time
•
Using trilateration and distance estimates we can 
ﬁgure out where all the towers are
•
Compare this to a ground truth such as wigle or 
opencellid
Defcon Safe Mode // Aug 2020
Triangulation (Bearing)
L = B₁∩B₂∩B₃
Trilateration vs Triangulation
Trilateration
L = R₁∩R₂∩R₃
x°
y°
d
Defcon Safe Mode // Aug 2020
Looking for Anomalies
•
Cells moving
•
Cells that change signal strength
•
Cells that aren’t where they should be
•
Cells changing parameters
•
Cells missing parameters
•
New cells
•
Anomaly != CSS, that's why we have to verify
Defcon Safe Mode // Aug 2020
Why Don’t we Transmit?
EFF Lawyers
Defcon Safe Mode // Aug 2020
What we Found so Far
Cell on wheels at Dreamforce
Defcon Safe Mode // Aug 2020
What we Found so Far
•
Suspicious foreign 
towers in DC
Suspicious eNodeBs in Washington DC
Defcon Safe Mode // Aug 2020
Washington DC
Defcon Safe Mode // Aug 2020
Ongoing Tests
•
Latin America (FADe Project)
•
DC
•
NYC
•
Your hometown (coming soon…)
Defcon Safe Mode // Aug 2020
Future Work
•
Better heuristics
•
Better location ﬁnding
•
Machine learning for detection of anomalies
•
Port to cheaper hardware
Defcon Safe Mode // Aug 2020
What’s With the Name?
Press F to pay respects to Steve
Defcon Safe Mode // Aug 2020
How Can we Stop Cell-Site Simulators
•
End 2G support on iOS and Android now!
–
https://www.eﬀ.org/deeplinks/2020/06/your-phone-vulnerable-be
cause-2g-it-doesnt-have-be 
•
Eliminate pre-authentication messages
–
TLS for the handshake with towers
•
More incentives for standards orgs (3GPP), carriers, 
manufacturers, and OEMs to care about user privacy 
•
Nothing is foolproof but we aren’t even doing the bare 
minimum yet. 
Defcon Safe Mode // Aug 2020
Key Takeaways
•
We have a pretty good understanding the vulns in 4G 
which commercial cell-site simulators might exploit
•
None of the previous IMSI catcher detector apps really 
do the job any more. 
•
We have come up with a method similar to established 
methods but targeting 4G.
•
The worst problems of CSS abuse can be solved!
Defcon Safe Mode // Aug 2020
Thanks to the following people
•
Yomna! 
•
The whole EFF crew
•
Andy and Bob at Wigle
•
Roger Piqueras-Jover
•
Nima Fatemi with Kandoo, Surya Mattu, Simon
•
Carlos and the FADE Project
•
Karl Kosher, Peter Ney, and others at UW (SEAGLASS)
•
Ash wilson (SITCH) and Eric Escobar (Defcon Justice 
Beaver)
•
Kristin Paget 
Defcon Safe Mode // Aug 2020
Cooper Quintin
Senior Security Researcher
EFF Threat Lab
cooperq@eﬀ.org - twitter: @cooperq
https://github.com/eﬀorg/crocodilehunter
Thank you! 
Defcon Safe Mode // Aug 2020
References
1.
https://www.eﬀ.org/wp/gotta-catch-em-all-understanding-ho
w-imsi-catchers-exploit-cell-networks 
2.
https://github.com/srsLTE/srsLTE 
3.
https://arxiv.org/pdf/1710.08932.pdf 
4.
https://www.usenix.org/system/ﬁles/conference/woot17/woo
t17-paper-park.pdf 
5.
https://seaglass-web.s3.amazonaws.com/SeaGlass___PETS_20
17.pdf 
6.
https://www.sba-research.org/wp-content/uploads/publicatio
ns/DabrowskiEtAl-IMSI-Catcher-Catcher-ACSAC2014.pdf