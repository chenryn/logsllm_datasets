TLS-hs-to,
conn-reset
success
success
failure
failure
Additional
observation
-
-
success w/ spoofed SNI
failure w/ spoofed SNI
available over HTTPS
blocked over HTTPS
other HTTP/3 hosts are
available in the network
available over HTTPS
QUIC-hs-to
success w/ spoofed SNI
QUIC-hs-to
failure w/ spoofed SNI
S
P
T
T
H
3
/
P
T
T
H
Conclusion for
tested domain
no HTTPS blocking
no TLS blocking
SNI-based TLS
blocking,
no IP-based blocking
no SNI-based blocking
no HTTP/3 blocking
HTTP/3 blocking not
yet implemented
no general UDP/443
blocking in network
probably blocked as
collateral damage
SNI-based QUIC
blocking,
no IP-based blocking
no SNI-based QUIC
blocking
Indi-
cation
-
IP1
UDP2
-
-
-
UDP2
UDP2
-
IP1,
UDP2
1 Strong indication for IP-based blocking in China and India (c.f., Section 5.1).
2 Strong indication for UDP endpoint blocking in Iran (c.f., Section 5.2).
TLS-based censorship techniques, such as SNI-based blocking can
be ruled out. General TCP and UDP port blocking on 443 can also
be disregarded, because other HTTPS and HTTP/3 requests during
the same measurement round succeeded. This leaves IP blocking as
the most probable explanation. Unfortunately the usage of HTTP/3
over QUIC can not overcome this type of censorship, because the
interference already happens on the underlying IP layer. Since
the censor does not exclusively apply IP endpoint blocking, hosts
that are targeted by a different form of HTTPS censorship are still
available over QUIC.
IP blocking was also observed in the network of an Indian ISP lo-
cated in AS55836. As shown in Figure 3b, for every TCP connection
error associated with IP-blocking, (TCP-hs-to and route-err), the
corresponding QUIC measurement also fails. This indicates that,
like in AS45090, the applied IP-blocking affects QUIC in the same
way as TCP but does not target the protocol directly.
5.2 UDP Endpoint Blocking
In Iran (AS62442), most HTTPS errors occur due to TLS-hs-to’s, i.e.,
timeouts after the establishment of a TCP connection. This is not a
case of IP blocking. Instead, the TLS handshake timeout rather indi-
cates that a TLS-blocking method is active, such as commonly used
SNI-filtering. As depicted in Figure 3c, a third of the unsuccessful
HTTPS attempts also fail if HTTP/3 is used instead, returning a
timeout during the QUIC handshake (QUIC-hs-to).
To test our hypothesis, that the SNI field is used as host iden-
tification for TLS-blocking in Iran, a subset of the host list was
additionally probed with the SNI field in the ClientHello set to ex-
ample.org. A similar approach is used in [2]. As displayed in Table 3,
83% of attempts to usually blocked TCP/TLS hosts succeed when
applying the SNI spoof. This behavior suggests that Iranian censors
utilize SNI keyword filtering to block TCP/TLS connections and
280
ACM IMC 2021, November 2–4, 2021, Virtual Event
Kathrin Elmenhorst, Bertram Schütz, Nils Aschenbruck, and Simone Basso
TCP/TLS
QUIC
Table 3: SNI-based TLS blocking and SNI spoofing
measurements in Iran.
(a) AS45090 (China)
(b) AS55836 (India)
(c) AS62442 (Iran)
Figure 3: Distribution of network error types for TCP/TLS
(left) and QUIC (right) measurements. The horizontal flows
(left to right) indicate the response change, when using
QUIC instead of TCP/TLS.
rules out general IP-endpoint blocking. However, using the spoofed
SNI does not affect the availability of the subset hosts when using
HTTP/3.
In comparison to the other probed networks, the percentage of
pairs with a successful TCP/TLS attempt and a failed QUIC attempt,
is more pronounced, totaling 4.11% of all pairs. The additional avail-
ability test in the post-processing step showed that the affected
hosts are still available via QUIC from an uncensored AS, ruling
out any server-side UDP fire walling. Since the majority of website
requests is still made with traditional HTTPS, it seems unreason-
able that a censor would intentionally only block the lesser used
protocol, and we therefore assume that these hosts are unavailable
as collateral damage caused by IP address filtering.
Thus, we believe that censors have deployed middle box soft-
ware, which applies IP address filtering only to UDP traffic. As
described above and listed in Table 2, we derive this conclusion
from the elimination of IP-based blocking and SNI blocking, and
from the observed collateral damage in regards to censored QUIC
connections. Future work has to prove, if this filter specifically
targets HTTP/3 traffic, i.e. UDP traffic on port 443, or UDP traffic
to these IPs in general.
ASN
transport
62442
(Iran)
48147
(Iran)
TCP
QUIC
TCP
QUIC
sample
size
353
353
40
40
60.1% (212)
20.1% (71)
60.0% (24)
20.0% (8)
failure rate
real SNI
spoofed SNI
(example.org)
10.2% (36)
20.1% (71)
10.0% (4)
20.0% (8)
6 CONCLUSION & FUTURE WORK
The presented findings summarize the current state of QUIC cen-
sorship in several critical Autonomous Systems. Our measurements
reveal that HTTP/3 requests are less frequently blocked than tradi-
tional HTTPS requests, or sometimes even not blocked at all. This
can be explained by the fact QUIC is a rather young protocol with
still a small share in overall internet traffic volume. Yet, with its
growing significance, the efforts to better block QUIC will rise. As
observed with the outright blocking of Encrypted-SNI in China7, it
is also possible that QUIC could be generally blocked by censors.
Two identification methodologies were observed in the probed
networks, aiming indirectly and directly at QUIC traffic. The block-
listing of IP addresses is still an ongoing issue, as seen in the probed
Chinese network, and in one of the probed networks in India. While
such IP blocking prevents HTTP/3 requests to blocklisted hosts,
it also affects all other IP-based protocols. In the two Iranian net-
works, we detected UDP endpoint blocking used against HTTP/3
connections. This method differs from the applied TLS-blocking
method which filters HTTPS traffic based on the SNI. The only
observed interference method used to intercept QUIC connections
is black holing to interrupt the handshake.
Since censorship methods dynamically change and censors adapt
to the emergence of new network technologies, measurements can
only reflect the censorship situation at a certain point in time. Cur-
rently, QUIC is not fully deployment internationally, as discussed in
our input selection, c.f., Section 4.3. Thus, this work only presents
a fixed snapshot of an early stage of QUIC censorship. The study
should be repeated in near future to highlight the development.
Beyond the collected data, this work provides a measurement
tool to long-term monitor HTTP/3 over QUIC blocking around the
world. Future measurements should not only monitor the use of
established censorship methodologies applied to QUIC, but also
stay alert to detect new methods tailored to QUIC or TLS traffic
and identify the use of statistical flow classification.
ACKNOWLEDGMENTS
We want to acknowledge the work and commitment of the OONI
community, which helped in conducting the measurements. In par-
ticular, we thank Gurshabad Grover and Divyank Katira from CIS
India for their efforts. We also want to acknowledge the organiza-
tion GreatFire.org, which enabled us to perform measurements in
China. We thank the shepherd Mirja Kuehlewind and the anony-
mous reviewers for their helpful feedback.
7https://gfw.report/blog/gfw_esni_blocking/en/
281
TCP-hs-to - 25.9 %TLS-hs-to - 2.7 %conn-reset - 8.6 %other - 0.1 %success - 62.7 %QUIC-hs-to - 27.0 %success - 72.9 %other - 0.1 %TCP-hs-to - 7.5 %conn-reset - 3.0 %route-err - 4.5 %success - 85.0 %QUIC-hs-to - 12.0 %success - 88.0 %TLS-hs-to - 33.4 %other - 1.0 %success - 65.7 %QUIC-hs-to - 15.1 %other - 1.1 %success - 83.8 %Web Censorship Measurements of HTTP/3 over QUIC
ACM IMC 2021, November 2–4, 2021, Virtual Event
REFERENCES
[1] Simurgh Aryan, Homa Aryan, and J. Alex Halderman. 2013. Internet Censorship
in Iran: A First Look. In 3rd USENIX Workshop on Free and Open Communications
on the Internet (FOCI 13).
Investigat-
Available: https://ooni.org/post/
ing TLS blocking in India.
2020-tls-blocking-india/.
[2] Simone Basso, Gurshabad Grover, and Kushagra Singh. 2020.
(2020).
[3] Mike Bishop. 2021. Hypertext Transfer Protocol Version 3 (HTTP/3). Internet-Draft
draft-ietf-quic-http-34. IETF. Available: https://datatracker.ietf.org/doc/html/
draft-ietf-quic-http-34.
[4] Kevin Bock, Yair Fax, Kyle Reese, Jasraj Singh, and Dave Levin. 2020. Detecting
and Evading Censorship-in-Depth: A Case Study of Iran’s Protocol Whitelister.
In 10th USENIX Workshop on Free and Open Communications on the Internet (FOCI
20).
[5] Noah Buyon, Cathryn Grothe, Amy Slipowitz, and Kian Vesteinsson. 2020. Free-
dom on the Net. (2020). Available: https://freedomhouse.org/sites/default/files/
2020-10/10122020_FOTN2020_Complete_Report_FINAL.pdf.
[6] Zimo Chai, Amirhossein Ghafari, and Amir Houmansadr. 2019. On the Impor-
tance of Encrypted-SNI (ESNI) to Censorship Circumvention. In 9th USENIX
Workshop on Free and Open Communications on the Internet (FOCI 19).
[7] Quentin De Coninck and Olivier Bonaventure. 2017. Multipath QUIC: Design
and Evaluation. In Proceedings of the 13th International Conference on emerging
Networking EXperiments and Technologies (CoNEXT ’17). 160–166.
[8] Arturo Filastò and Jacob Appelbaum. 2012. OONI: Open Observatory of Network
Interference. In 2nd USENIX Workshop on Free and Open Communications on the
Internet (FOCI 12).
[9] Joseph Hall, Ben Jones, Michael Aaron, Amelia Andersdotter, Stan Adams, and
Nick Feamster. 2020. A Survey of Worldwide Censorship Techniques. Internet-
Draft draft-irtf-pearg-censorship-02. IETF. Available: https://tools.ietf.org/html/
draft-irtf-pearg-censorship-02. Expired September 10, 2020 .
[10] Kyle Hogan. 2020. Security analysis of Tor over QUIC. PhD Thesis. Massachusetts
Institute of Technology. Available: https://dspace.mit.edu/handle/1721.1/128590.
[11] Jana Iyengar and Martin Thomson. 2021. QUIC: A UDP-Based Multiplexed and
Secure Transport. Internet-Draft draft-ietf-quic-transport-34. IETF. Available:
https://datatracker.ietf.org/doc/html/draft-ietf-quic-transport-34.
[12] Adam Langley, Alistair Riddoch, Alyssa Wilk, Antonio Vicente, Charles Krasic,
Dan Zhang, Fan Yang, Fedor Kouranov, Ian Swett, Janardhan Iyengar, Jeff Bai-
ley, Jeremy Dorfman, Jim Roskind, Joanna Kulik, Patrik Westin, Raman Tenneti,
Robbie Shade, Ryan Hamilton, Victor Vasiliev, Wan-Teh Chang, and Zhongyi
Shi. 2017. The QUIC Transport Protocol: Design and Internet-Scale Deploy-
ment. In Proceedings of the Conference of the ACM Special Interest Group on Data
Communication (SIGCOMM ’17). 183–196.
Internet-
Draft draft-martini-hrpc-quichr-00. IETF. Available: https://tools.ietf.org/id/
draft-martini-hrpc-quichr-00.html. Expired April 25, 2019.
[13] B. Martini and N. ten Oever. 2018. QUIC Human Rights Review.
[14] François Michel, Quentin De Coninck, and Olivier Bonaventure. 2019. QUIC-FEC:
Bringing the benefits of Forward Erasure Correction to QUIC. In Proceedings of
the IFIP Networking 2019 Conference. 1–9.
[15] A. A. Niaki, S. Cho, Z. Weinberg, N. P. Hoang, A. Razaghpanah, N. Christin, and
P. Gill. 2020. ICLab: A Global, Longitudinal Internet Censorship Measurement
Platform. In 2020 IEEE Symposium on Security and Privacy (SP). 135–151.
able: https://github.com/ooni/probe-cli.
[16] Open Observatory of Network Interference. 2021. ooni/probe-cli. (2021). Avail-
[17] Reethika Ramesh, Ram Sundara Raman, Matthew Bernhard, Victor Ongkowijaya,
Leonid Evdokimov, Anne Edmundson, Steven Sprecher, Muhammad Ikram, and
Roya Ensafi. 2020. Decentralized control: A case study of russia. In Network and
Distributed Systems Security Symposium (NDSS).
[18] Jan Rüth, Ingmar Poese, Christoph Dietzel, and Oliver Hohlfeld. 2018. A First
Look at QUIC in the Wild. In Passive and Active Measurement, Vol. 10771. 255–268.
[19] Kushagra Singh, Gurshabad Grover, and Varun Bansal. 2020. How India Censors
the Web. In 12th ACM Conference on Web Science (WebSci ’20). 21–28.
[20] Ram Sundara Raman, Leonid Evdokimov, Eric Wurstrow, J. Alex Halderman, and
Roya Ensafi. 2020. Investigating Large Scale HTTPS Interception in Kazakhstan.
In Proceedings of the ACM Internet Measurement Conference (IMC ’20). 125–132.
[21] Ram Sundara Raman, Prerana Shenoy, Katharina Kohls, and Roya Ensafi. 2020.
Censored Planet: An Internet-wide, Longitudinal Censorship Observatory. In
Proceedings of the 2020 ACM SIGSAC Conference on Computer and Communications
Security (CCS ’20). 49–66.
[22] Ram Sundara Raman, Adrian Stoll, Jakub Dalek, Reethika Ramesh, Will Scott,
and Roya Ensafi. 2020. Measuring the Deployment of Network Censorship Filters
at Global Scale. In Proceedings of the Network and Distributed System Security
Symposium, NDSS 2020.
[23] Pengwei Zhan, Liming Wang, and Yi Tang. 2021. Website Fingerprinting on Early
QUIC Traffic. arXiv:2101.11871 [cs] (2021).
NOTICE
Ethical considerations are discussed in Section 2.
282