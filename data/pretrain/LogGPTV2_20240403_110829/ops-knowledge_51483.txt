User: 请回答以下安全问题移动运营商如何知道HTTPS连接上的视频分辨率？Verizon正在修改他们的“无限”数据计划。美国的客户可以以480便士的价格流式传输视频，或者付费解锁更高的分辨率（包括720便士和+1080便士）。他们并不是唯一一家执行此类规则的移动运营商。
如果我在一个为视频流实现HTTPS的网站上，比如YouTube或Facebook，运营商怎么知道我在看什么分辨率的视频？如果运营商正在限制所有数据的带宽，那么谈论视频分辨率似乎是一种误导。如果只是视频，那似乎会引起隐私问题。

Assistant: 这是一个活跃的研究领域。我碰巧在这方面做了一些工作，所以我会尽我所能分享基本想法（这项工作是与行业合作伙伴进行的，我无法分享秘密细节：）。
贸易统计处；dr是，通常可以将加密的流量流识别为携带视频，并且通常可以估计其分辨率，但这很复杂，并不总是准确的。有很多人在研究如何更一致、更准确地做到这一点。
视频流量具有一些特定的特征，可以将其与其他类型的流量区分开来。这里我特别指的是视频点播，而不是直播视频。视频点播通常没有这个答案中提到的优先级标签。我还特别提到自适应视频，这意味着视频被划分为多个片段（每个片段约2-10秒长），并且视频的每个片段以多个质量级别（质量级别意味着：长期视频比特率、编解码器和分辨率）进行编码。播放视频时，下载下一个片段的质量水平取决于应用认为您的网络可以支持的数据速率。（这就是这个答案中提到的DASH协议。）
如果你的手机正在播放视频，并且你观察一段时间内手机流量的（加权移动平均值）数据率，它可能看起来像这样：
（这是从Verizon上的YouTube会话中捕捉到的。有超过15秒的移动平均值，也有短期平均值。）
本次会议有几个不同的部分：
首先，视频应用（YouTube播放器）尝试将缓冲区填充到缓冲区容量。在此期间，它以网络所能支持的任何速率提取数据。在这个阶段，它基本上与大文件下载无法区分，除非你可以从远程地址推断出它是视频流量（如本答案中所述）。
一旦缓冲区满了，你就会以一定的时间间隔得到“突发”。假设你的缓冲区可以容纳200秒的视频。当缓冲区中有200秒的视频时，应用将停止下载。然后，在播放完一段视频（比如5秒）后，缓冲区中再次有空间，因此它将下载下一段视频，然后再次停止。这就是造成这种突发模式的原因。
这种模式是视频流量的典型特征——来自其他应用的流量没有这种模式——因此网络服务提供商可以很容易地挑选出携带视频流量的流。在某些情况下，您可能从未观察到这种模式——例如，如果视频太短，以至于整个内容一次加载到缓冲区，然后客户端停止下载。在这种情况下，很难区分视频流量和文件下载（除非你能通过远程地址找到）。
无论如何，一旦你确定流携带视频流量-要么是通过远程地址（不总是可能的，因为主要的视频提供商使用的内容分发网络不是视频独有的），要么是通过其流量模式（如果视频会话很长，就有可能，如果很短，整个视频一次加载到缓冲区，就更难了）。。。
现在，正如Hector所说，你可以通过查看每个“突发”数据的大小（以字节为单位）来尝试从比特率猜测分辨率：
根据每个持续时间的大小，你可以对分辨率做出合理的估计，尤其是如果你保持滚动平均值的话。
但是，这可能很困难。以我的YouTube会话为例：
并非所有片段的持续时间都相同-一次请求的视频持续时间取决于几个因素（质量水平、网络状态、您在哪种设备上播放视频等）。所以你不一定会看到一个“突发”，然后说，“好吧，这是代表5秒视频的X字节，所以我知道视频数据率”。有时你可以计算出可能的分段持续时间，但有时这很棘手。
对于给定的视频质量水平和片段持续时间，不同的片段将具有不同的大小（取决于视频中该部分发生的运动量）。
即使对于相同的视频分辨率，长期数据速率也会有所不同——用VP9编码的1080p视频的长期数据速率与用H.264编码的视频的相同。
视频质量水平根据感知的网络质量（网络服务提供商可见）和缓冲状态（不可见）而变化。因此，您可以查看30秒内的长期数据速率，但实际视频质量水平可能在这30秒内发生了多次变化。
在缓冲区尽可能快地耗尽或填充时（当你没有这些“突发”时），很难估计视频中发生了什么。
更为复杂的是：有时一个视频流会在多个较低层流之间“分条”。有时，视频的一部分会从一个地址检索，然后它会切换到从不同的地址检索视频。
我刚才给你看的数据率图表？以下是该时间间隔内的视频分辨率：
这里，颜色表示视频分辨率。所以…你可以根据交通模式来估计发生了什么。但这是个难题！你可以看看流量中的其他标记。我不能确切地说任何一家服务提供商是如何做到这一点的。但至少就学术界的最先进水平而言，没有任何方法可以一直做到完美准确（除非你得到视频提供商的合作…）
如果你有兴趣了解更多关于这类问题的技术，有很多学术文献，例如BUFFEST：预测HTTP（s）自适应流式客户端的缓冲区条件和实时要求。（不是我的论文——朱