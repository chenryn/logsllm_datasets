a session ID resumption) or an encrypted and authenticated
copy of the TLS resumption state (analogous to a session
ticket resumption). Unlike the current TLS versions, ver-
sion 1.3 explicitly derives a separate resumption secret.
This resumption secret can be used in two ways for session
resumption. The ﬁrst is for a direct resumption for a sec-
ondary session via the “psk_ke” mechanism. The second is
to be used as authentication for resumed connection that con-
ducts a second (EC)DHE key exchange via the “psk_dhe_ke”
mechanism.
In addition to these two, the resumption secret can also
be used for QUIC-like [47] 0-RTT communication. In this
case, “early data” is sent by the client while awaiting the
completion of a resumed or new TLS handshake. The data is
encrypted to the resumption secret and can stream until the
client receives the server’s Finished message.
3. DATA COLLECTION
To assess the impacts of session resumption and ephemeral
value reuse, we measured HTTPS behavior of Alexa Top Mil-
lion domains [2] over a 9-week period in the Spring of 2016.
We repeatedly connected to each server on TCP/443 using
a version of the ZMap tool chain [16, 20] that we modiﬁed
to support session ID and ticket resumption. In all cases, we
restricted our analysis to websites that presented browser-
trusted certiﬁcates that chain to the NSS root store2. Table 1
gives high level metrics from conducting 10 TLS connections
in quick succession to each Alexa Top Million domain on the
days given.
As with any active scanning research, there are many eth-
ical considerations at play. We followed the best practices
deﬁned by Durumeric et al. [20] and refer to their work for
more detailed discussion of the ethics of active scanning.
All scans were completed from the University of Michigan
2Durumeric et al. ﬁnd that 99.5% of certiﬁcates trusted by
NSS are valid in all major browsers and can be used to esti-
mate browser trusted websites [18].
35Figure 1: Session ID Lifetime—We measured how long
Session IDs were honored by HTTPS websites in the Alexa
Top Million.
Figure 2: Session Ticket Lifetime—We measured adver-
tised session ticket lifetime and how long tickets were hon-
ored by Alexa Top Million websites.
campus and followed the institutional blacklist. For experi-
ments that required multiple connections in a single day, we
restricted our measurements to popular sites in the Alexa
Top Million for which this load should be negligible. When
possible we used existing data from the Censys Project [16]
instead of running redundant scans. We are publishing all of
the data we independently collected on Scans.io [17], and our
modiﬁcations have been merged into the main ZMap project.
Alexa Top Million Dataset Our measurements occurred
within a 9-week period from March 2, 2016 to May 4, 2016
and used the Alexa Top Million as the target domains. We
saw a surprising amount of churn within the Top Million do-
mains from day to day. In total, we scanned 1,527,644 unique
domains including over 155K which were in ≤ 7 polls of
the Top Million. Only 539,546 domains remained in the Top
Million for the whole 9 weeks. Of these, 369,034 (68%) ever
supported HTTPS, 291,643 (54%) ever presented a browser-
trusted certiﬁcate, and 288,252 (53%) ever issued a session
ticket, completed a DHE or ECDHE key exchange, or re-
sumed a session. To prevent churn in the Top Million from
biasing our results, we restrict measurements over multiple
days to domains that remained in the list for the entire period.
4. TLS SECRET STATE LONGEVITY
In this section, we describe HTTPS domains’ behavior in
practice with regard to the lifetime of cryptographic state,
including how long session ID and session ticket resumption
is allowed, the lifetime of session ticket encryption keys,
and the reuse of key exchange values. We ﬁnd that while
session IDs and session tickets are generally only honored
for under an hour (82% and 76%, respectively), session ticket
encryption keys (STEKs) persist much longer.
4.1 Session ID Lifetime
To measure how long session IDs are accepted, we initiated
a TLS handshake with each of the Alexa Top Million domains
on April 27, 2016. We attempted to resume each session one
second later and then every ﬁve minutes until either the site
failed to resume the session or 24 hours had elapsed. Of
the 433,220 domains that supported HTTPS and presented a
browser trusted certiﬁcate, 419,302 (97%) indicated support
for session ID resumption by setting a session ID value in
the Server Hello message, and 357,536 (83%) resumed the
session after a one second delay.
As shown in Figure 1, the distribution of lifetimes is some-
what discrete: 82% of domains that supported session ID
resumption allowed resumption for one hour or less, and 61%
did for less than ﬁve minutes. Only 2,845 domains (0.8%)
resumed sessions for 24 hours or longer; 86% of those do-
mains belong to or are hosted by Google. We also note that
Facebook’s CDN honored session IDs for more than 24 hours.
These empirical results align with the default conﬁguration
of population web server implementations. Apache enables
session ID resumption by default and sets the lifetime to ﬁve
minutes [41]. Nginx issues session IDs but does not allow
resumption unless it is explicitly conﬁgured; session IDs ex-
pire after ﬁve minutes when enabled unless the administrator
sets a different lifetime [42]. Microsoft IIS expires session
IDs after ten hours [40], corresponding to the jump seen in
Figure 1.
4.2 Session Ticket Lifetime
We use a similar experiment to measure how long domains
allowed session tickets to resume TLS connections and the
hinted lifetime. We initiated a TLS handshake with each site
in the Alexa Top Million on April 29, 2016. We attempted
to resume each connection one second later, then every ﬁve
minutes until either the domain failed to resume the session
or 24 hours had elapsed. If the domain reissued a session
ticket during any of the connections, we continued to attempt
resumption with the ticket issued from the ﬁrst connection.
We found that 366,178 out of the 461,475 domains with a
browser-trusted certiﬁcate (79%) issued a session ticket and
351,603 (76%) resumed the session after one second.
4
 0 0.2 0.4 0.6 0.8 1 0 200 400 600 800 1000 1200 14001 Hour10 HoursCDF Alexa Top 1M (w/ HTTPS)Max successful resumption delay (in minutes) 0 0.2 0.4 0.6 0.8 1 0 200 400 600 800 1000 1200 140018 Hours1 HourCDF Alexa Top 1M (w/ HTTPS)Max successful resumption delay (in minutes)Advertised Lifetime HintsMax Successful Resumption36Figure 3: STEK Lifetime—TLS connections cannot
achieve forward secrecy until the STEK (the key used by
the server to encrypt the session ticket) is discarded.
Figure 4: STEK Lifetime by Alexa Rank—We found 12
Alexa Top 100 sites that persisted STEKs for at least 30 days.
Similar to session ID resumption, 67% of domains ac-
cepted a session ticket for less than ﬁve minutes and 76%
for one hour or less as seen in Figure 2. The indicated ticket
lifetime closely follows the advertised lifetime hint, with the
exception of 14,663 domains that leave it unspeciﬁed and
up to the client’s policy [52]. At the extreme end, we found
that two domains speciﬁed a lifetime hint longer than ten
days: fantabobworld.com and fantabobshow.com, both
of which speciﬁed a 90 day hint. 54,522 unique domains
hosted by CloudFlare resumed for 18 hours, causing the
steep increase in Figure 2. As with session ID resumption,
8,969 domains accepted tickets for 24 hours, of which 8,535
were hosted by Google (95%), which speciﬁed a 28 hour
lifetime hint.
This behavior also agrees with the known defaults for
popular web server implementations. Apache and Nginx
both enable session ticket resumption by default with a three
minute lifetime.
4.3 STEK Lifetime
While the time span that domains will accept previously
issued session tickets is an important metric, it reﬂects only
the ticket’s lifetime (set by policy) and not necessarily the
time period for which the associated STEK exists and is used
to issue new session tickets. As discussed in Section 2, the
content of a historical session can be decrypted using a site’s
STEK regardless of whether a PFS handshake occurs and
regardless of whether the ticket’s lifetime has expired or not.
In other words, a “forward secret” session is not actually
forward secret while the STEK that encrypted the associated
ticket persists.
While it is not possible to directly detect that the key used
to encrypt the session state has changed, popular server im-
plementations include a 16-byte STEK identiﬁer in the ticket,
as prescribed in RFC 5077 [52]. We reviewed popular open-
source TLS implementations, including OpenSSL, LibreSSL,
GNUTLS, mbedTLS, and NSS, and found that all follow this
recommendation except for mbedTLS, which uses a 4-byte
5
STEK identiﬁer. We also tested Microsoft’s SChannel im-
plementation and found it to use an ASN.1 encoded object
containing a DPAPI object [7]. For the measurements below,
we parsed this object and extracted the Master Key GUID to
use as the STEK identiﬁer.
Between March 2, 2016 and May 4, 2016, we connected
to the Alexa Top Million domains daily and recorded the
session ticket that was issued by the server, if one was is-
sued. We were able to determine the lifetime of each STEK
by looking for the ﬁrst and last time that the (STEK identi-
ﬁer, domain) pair was seen. As opposed to measuring the
number of sequential days that a domain issues tickets with
identical STEK identiﬁers, this metric accounts for much of
the real-world jitter seen in Internet scanning. This could
be due to the ZMap tool-chain’s choice of A-record entries
between days, a poorly conﬁgured load balancer which does
not maintain client-server afﬁnity, or simply the server failing
to respond to one our connections. It is highly unlikely that
an administrator would switch static STEKs only to switch
back or that a randomly generated STEK identiﬁer would col-
lide within the bounds of our study. Therefore, we can safely
assume that a STEK was in use between the ﬁrst and last time
that its identiﬁer was seen and that any intermediate STEK
identiﬁers seen were the result of ﬂuctuations connecting to
different servers.
Of the 291,643 browser-trusted sites always in the Alexa
Top Million, 66,941 (23%) never issued a session ticket.
118,835 (41%) used different issuing STEKs for each day.
63,976 domains (22%) reused the same STEK for at least
7 days, and 28,210 domains (10%) reused for at least 30 days.
We show the CDF of these lifetimes in Figure 3.
We found a surprising collection of websites, including
those of major Internet companies, that fall within the 30+ day
reuse. Table 2 shows the ten most popular domains according
to their average Alexa ranking that reused a STEK for at least
7 days. While there are many other notable domains, we note
that there are a total of eight yandex.[tld] domains, each
of which showed 63 days of reuse, slack.com (a popular
team communication service) showed 18 days of reuse, and
 0 0.2 0.4 0.6 0.8 1 0 10 20 30 40 50 60CDF Alexa1M (w/ HTTPS)Max span of a STEK (in days)Alexa1M Hosts0%20%40%60%80%100%Alexa 100Alexa 1KAlexa 10KAlexa 100KAlexa 1Mdays > 307 < days ≤ 301 < days ≤ 7days = 1days < 137Rank Domain
5
19
20
21
28
yahoo.com
qq.com
taobao.com
pinterest.com
yandex.ru
# Days
63
56
63
63
63
Rank Domain
31
35
41
53
55
netﬂix.com
imgur.com
tmall.com
fc2.com
pornhub.com
# Days
54
63
63
18
29
Table 2: Top Domains with Prolonged STEK Reuse—We
show the most popular domains (by average Alexa rank) that
reused a STEK for at least 7 days.
Rank Domain
31
53
392
456
528
# Days
netﬂix.com
59
fc2.com
18
ebay.in
7
ebay.it
8
bleacherreport.com 24
Rank Domain
580
592
626
633
730
kayak.com
cbssports.com
gamefaqs.com
overstock.com
cookpad.com
# Days
13
60
12
17
63
Table 3: Top Domains with Prolonged DHE Reuse—We
show the most popular domains (by average Alexa rank) that
reused a DHE value for at least 7 days.
Rank Domain
31
74
158
221
322
netﬂix.com
whatsapp.com
vice.com
9gag.com
liputan6.com
# Days
59
62
26
31
28
Rank Domain
353
464
527
528
615
# Days
paytm.com
27
playstation.com 11
62
woot.com
24
bleacherreport.com
leagueoﬂegends.com 27
Table 4: Top Domains with Prolonged ECDHE Reuse—
We show the most popular domains (by average Alexa rank)
that reused an ECDHE value for at least 7 days.