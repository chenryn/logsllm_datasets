User: How to deploy a LAMP environment with Ansible?
Assistant: Here is a simple Ansible playbook to deploy a LAMP environment: ```yaml --- hosts: webserver become: yes vars: # Set password-protected environment variables mysql_root_password: "mysecretpassword" tasks: # Update package list - name : Update package list apt: update_cache: yes # Install necessary packages - name: Install Apache2 apt: name: apache2 state: present - name: Install MySQL apt: name: mysql-server state: present - name: Install PHP and Its extension apt: name: "{{ item }}" state: present with_items: - php - libapache2-mod-php - php-mysql # Configure Apache virtual host - name: Configure Apache virtual host copy: src: /etc/apache2 /sites-available/000-default.conf dest: /etc/apache2/sites-available/000-default.conf mode: '0644' notify: - Restart Apache service # Enable PHP's Short Open Tag (optional) - name : Enable PHP's Short Open Tag lineinfile: dest: /etc/php/7.0/apache2/php.ini regexp: ';* *short_open_tag *=.*' line: 'short_open_tag = On' # Set the MySQL root user password and Delete anonymous users, prohibit root remote login (optional) - name: set the password of MySQL root user and delete anonymous users, prohibit root remote login mysql_user: name: root host: "{{ item }}" password: "{{ mysql_root_password }}" state: present with_items: - 127.0.0.1 - ::1 - localhost - name: delete MySQL anonymous user mysql_user: name: '' host: "{{ item }}" state: absent with_items: - 127.0.0.1 - ::1 - localhost - name: Forbid MySQL remote login root user mysql_user: name: root host: "{{ item }}" password: "{{ mysql_root_password }}" login_password: "{{ mysql_root_password }}" priv: '* .*:ALL,GRANT' state: present with_items: - 127.0.0.1 - ::1 - localhost handlers: # Restart Apache service - name: Restart Apache service service: name: apache2 state: restarted ``` This playbook assumes you have A host group called "webserver" with administrative privileges in the sudoers list on the host. If these conditions are not met, please change accordingly. The ansible-playbook command deploys this playbook to the target hostgroup: ```bash $ ansible-playbook my-lamp-playbook.yaml -i hosts.ini ``` This installs and configures Apache, MySQL, and PHP, and also Set the MySQL root password, delete anonymous users, and prohibit root remote login. After installation, you can test the LAMP environment by typing the server's IP address into your browser.