4.1.1 基础信息
4.1.2 零信任要素与目标
4.1 用户对资源访问模式实现
零信任架构是为了解决传统的边界安全理念重在边界的防护、对已经突破边界的攻击行为防护能力有限的
问题，为了提高安全防护能力，以及提高安全事件的发现和响应能力而被设计出的一套解决方案，并且在
Google这样的大型企业中得到了落地和验证。
零信任架构目前已经演变成比较全面、可覆盖大部分场景的安全思想，目前这种安全思想主要分为两类，
一类是站在发起方，用户对资源的访问模式，指的是用户访问内部资源时，如何验证用户是可信的，如何确保
访问来源终端可信，如何确认拥有访问资源权限。在该实现方案中，主要解决的是站在用户视角的零信任方
案。另外一类是站在服务方，即服务资源之间如何安全的互相访问。本节内容集中阐述用户对资源访问模式。
当前零信任受到产业界极大关注，导致各类安全产品、方案均往零信任的概念上靠，包括一些并非是真正
的零信任方案，因此有必要确认零信任的核心理念和元素，再进行实现上的展开。
在用户对资源访问模式下的零信任实现方案中，涉及的核心元素有以下：
1）用户：访问的主体，即真实自然人在网络中的身份映射；
2）终端：发起访问用的设备，系统环境软硬件、发起访问的可执行程序代码；
3）资源：最终要访问的和获取的客体，通常为内部应用系统。
4）链路：终端访问服务器的网络通道、网络链路。
上述核心元素中，所面临的主要风险有以下场景：
1）用户风险：针对用户身份的账号密码爆破、钓鱼、键盘记录等，其目标主要是为了盗取用户账号，以
用户身份开展恶意行为；
2）终端设备风险：终端设备安全风险包含，系统软件上的漏洞利用攻击，因基础防护不够容易被控制作
为跳板移动，通过社工攻击植入后门等；在硬件层面也涉及到硬件供应链的风险，导致数据泄漏或者入侵风
险；在可执行程序上，发起访问的应用可能是恶意代码病毒或者木马，并且可能绕过现有杀毒等安全检测；
3）资源访问风险：保护的服务资源，通常为攻击者最终目标，采用的方式除了利用盗取的用户身份直接
盗取资源数据外，还可能利用用户的终端设备对资源服务器开展攻击。
4）链路风险：网络链路可能存在当终端访问服务资源的的时候，被嗅探或是中间人攻击来获取数据和凭证。
按照零信任发展过程中的理念，以及上述主要安全风险，在实现零信任方案的过程中，要实现的核心目标
主要有以下几类：
1）用户可信：即如何确保用户的登陆、操作是本人操作，而非被盗取的攻击者行为。
2）终端可信：确保终端设备自身的安全可信，包括以下目标：
零 信 任 实 战 白 皮 书
零 信 任 实 现 方 案
零信任产业标准工作组
4.1.3 核心理念实现
在用户对资源访问模式中，零信任最核心最重要的理念，如下图：
4.1.4 抽象技术框架
在基于用户对资源的访问模式下的零信任，对架构进行抽象后的架构示意图如下：
1）用户、终端设备、链路、资源权限应是安全、可信的；
2）应建立起用户、终端设备和资源权限的信任链；
3）应持续、动态的检验，信任链是否还安全可信。
a）可信设备：终端应为可信设备，并授权可信用户使用；
b）安全基线：终端应具备基础安全防护能力，满足安全基线要求；
c）可信程序：终端发起资源请求的程序，应是可信程序，防止恶意程序的伪装。
3）资源权限可信：如何保障资源被拥有权限的用户正确获取，而非被越权或是被攻击的方式获取到。通
过访问控制策略做限制，只有指定的人、应用才能够访问指定的服务资源，减小业务系统安全风险暴露面。
4）链路传输可信：保障终端访问服务器的流量必须是加密，避免被中间人劫持。
考虑安全是动态过程，除了上述核心目标外，还有几类重要目标要一并考虑实现：
1）动态检测：安全不是持续不变的，现在是安全的不代表之后的都是正常的，因此需要对上述可信状态
实施动态检测；不管是通过自身的检测能力，还是联动第三方获取更加全面的安全状态信息。
2）动态防护：一旦所关注对象的安全状态发生变化，由可信变为不可信状态，应能动态进行隔离、阻
断、降级等操作，防止进一步的攻击和渗透。
零 信 任 实 战 白 皮 书
零 信 任 实 现 方 案
零信任产业标准工作组
4.1.5 技术实现方式
零信任在技术实现上有多种路径，常见的实现过程中基本都是对上述架构组件，进行不同技术程度的实现
而来，只要最终都可以满足零信任的核心目标，这类均可视为成功的零信任技术实现。
在技术实现分类上，将根据零信任网关的类型来进行区分，该划分模式可以覆盖绝大部分零信任实现，如
下：
1）反向代理网关方式（有终端Agent）
反向代理网关指的是在零信任网关实现上，通过七层Web协议反向代理方式，通过将后端业务域名解析到
网关上，实现对资源访问的拦截和转发，如下图：
该架构中的主要功能组件和承载功能如下：
1）零信任终端代理（Agent）：用户侧的核心组件，主要功能如下：
a）生成终端唯一表示码：用来区分不同终端和设备，防止终端伪造；
b）建议用户建立授权关系：即允许该终端被什么用户使用，建立绑定关系；
c）收集终端信息：用于决策中心判断终端安全状态，是否符合对资源访问的邀请；
2）零信任网关：暴露在外部可被用户直接访问的系统，主要功能如下：
a）转发：对来访未经授权的请求进行认证授权转发，对已正确授权的请求进行资源访问转发；
b）拦截：对禁止访问的请求进行拦截阻断，阻止向后访问。
3）零信任安全控制中心,主要功能如下：
a）认证：对用户、终端身份进行认证和授权；
b）持续访问控制：
访问控制策略：访问控制策略包含访问过程的关键对象、访问权限、环境安全状态因素，可以进
行灵活的配置，方便在访问建立、访问中可以根据访问策略做风险判断，进行授权访问或者实时
阻断；
动态安全检测：决策中心对鉴权和安全状态的检验应该是持续动态的过程，即每次对资源对访问
应该都重新进行鉴权和检验；同时需要获取访问过程中关键对象、关键环境的安全状态，判定访
问过程是否有风险；
动态防护响应：如果判定有风险的相关访问，应该可以及时采取降权、阻断等防护策略。
4）零信任管理后台：提供集中化管理能力，主要功能如下：
a）用户管理：对用户进行集中化授权管理，包括用户账号的安全管控和策略；
b）终端管理：对终端设备进行集中化管理，包括终端安全管控和策略；
c）资源管理：对接入对资源进行集中化管理，包括资源接入和授权；
d）策略管理：安全控制中心的策略控制，策略判断条件配置和管理。
零 信 任 实 战 白 皮 书
零 信 任 实 现 方 案
零信任产业标准工作组
该方式下的简化访问过程如下：
a）用户通过零信任终端Agent进行设备注册和授权，获取客户端证书；
b）终端Agent进行安全基线加固，以及上传终端设备安全状态；
c）应用系统域名通过DNS解析到反向代理网关中；
d）用户通过浏览器（或集成上述Agent功能的安全浏览器），发起资源访问请求到反向代理网关；
e）反向代理网关通过决策中心，验证用户身份、设备是否授权、设备安全状态以及资源权限关系；
f）反向代理网关鉴权通过后，带上凭证将请求转发给应用系统，获取资源；
g）反向代理网关将资源转发给终端，完成一次请求。
实现原理示意：
实现描述：
a）1-2终端在身份认证之后进行鉴权，获得鉴权证明，可以是证书、密钥等协议支持的信息；
b）3-4浏览器直接访问对应URL解析到网关入口；
c）5-6网关通过hostname还有鉴权用的证书或者密钥等，做对应的访问控制，验证访问合法后，就通过
转发数据到实际的Web业务服务器。
零 信 任 实 战 白 皮 书
零 信 任 实 现 方 案
零信任产业标准工作组
该方式下的简化访问过程如下：
a）用户通过浏览器，发起资源访问请求到反向代理网关；
b）反向代理网关通过安全控制中心，验证用户身份、设备是否授权、设备安全状态以及资源权限关系；
c）应用系统域名通过DNS解析到反向代理网关中；
d）反向代理网关鉴权通过后，带上凭证将请求转发给应用系统，获取资源；
e）反向代理网关将资源转发给终端，完成一次请求。
在技术实现过程中，主要需要注意几点：
a）控制通道和数据传输通道应分离，防止堵塞后互相影响；
b）终端Agent需接受终端安全策略，实现设备安全可信，以及用户对应客户端证书的申请维护；
c）浏览器访问后端应用时，传输通道应加密，并带入客户端证书和用户、设备信息进行认证授权；
d）网关可以通过客户端证书，以及带入的设备和用户信息实现用户和设备的身份合法性校验。
该模式下零信任实现上，除了零信任自身的一些优点还，具有以下优势：
a）由于是七层Web代理，因此可以基于应用进行细颗粒的授权控制，可以深入到对特定应用，特定资源
的控制；
b）由于所有的请求对网关是透明的，因此可以对内容进行分析、审计，提高安全检测能力；
c）由于都是Web协议，请求效率较高，可靠性强。
除了以上优势外，该模式也有一些劣势，如下：
a）对于非Web的业务，如C/S应用难以支持，对于全场景的办公需求支持难度较大；