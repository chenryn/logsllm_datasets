t
s
e
u
q
e
r
f
o
#
 0.1
Sat 11/15
00:00
Sat 11/22
00:00
Sat 11/29
00:00
Sat 12/06
00:00
Sat 12/20
00:00
Sat 12/27
00:00
Sat 01/03
00:00
 0
Sat 01/10
00:00
Sat 12/13
00:00
Time
Figure 8: Variation of ğ‘‘ğ‘ with load for Holiday Cheers. After
the server upgrade (Nov. 23), resources seemed sufï¬cient to
handle the viral growth of this application.
show that the average response size remains stable for the entire
measurement period. The average response size for The Streets
(least popular application) is the smallest (1.5â€“3 KB), and Hugged
(most popular application) has the biggest average response size
(4â€“5 KB). Furthermore, we expected average response sizes to de-
crease during periods with high request arrival rates (period during
which more new application installation requests arrive), since new
users have less (or no) activity data. Our measurement results indi-
cate that no such relationship exists for the applications considered,
showing that high request arrival periods are not dominated by new
application installation requests.
(4) The type of interactions (i.e., API calls) from third-party ap-
plication servers to OSNs affect application server delays, impact-
ing the overall user experience. We studied the delay associated
with making API calls from application servers to OSN servers
(termed as the API call duration). Figure 9 shows the distribution
of API call durations for various applications. The call duration
for The Streets was observed to be fairly small, followed by Holi-
day Cheers, while Hugged observed the largest API call duration.
To understand the role of API calls, we analyzed how the API call
duration is affected by server load for two popular applications:
Hugged and Holiday Cheers. While average API call duration for
Holiday Cheers remains fairly stable across time (Figure 11), call
duration for Hugged shows a remarkable increase during peak ac-
tivity periods (shown by â€˜All API callsâ€™ in Figure 10).
To explain this difference, we compared the speciï¬c type of API
calls made by these two applications. We found that Hugged and
F
D
C
 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
 0
 0
Hugged
Holiday Cheers
The Streets
 0.5
 1
 1.5
 2
 2.5
 3
 3.5
 4
API Call Duration (sec)
Figure 9: Distribution of API call duration. Hugged had higher
call durations than the other two applications.
Holiday Cheers make several similar API calls9, except for a couple
of additional API calls made only by Hugged10. We subsequently
analyzed the average API call duration for Hugged, separately for
the additional API calls (Type A) and the common API calls (Type
B) in Figure 10. We observed that Type A calls were responsible
for the surge in the average API delays during high load. However,
even Type B calls show greater variation with load for Hugged as
compared to Holiday Cheers. We suspect this is because of per-
application or per-API-call resource budgets at the OSN, that are
fully consumed by the relatively higher load for Hugged (or third-
party applications in general) during peak trafï¬c periods.
Concluding Remarks: Based on our observations, we conclude
that one does not need exorbitant resources to launch and main-
tain an extremely popular OSN application, despite its viral growth
and/or large ï¬‚uctuations in seasonal usage. We do acknowledge
that processing requirements may differ on a per-application basis.
Yet, in our case study, a server with Dual Core Xeon 2.0ghz, 4-8GB
Memory, and 100 Mbps connection speed is sufï¬cient to serve ex-
tremely popular applications like Hugged or Holiday Cheers that
attract 100-200K DAU.
6. GAUGING FACEBOOK INTERNALS
After examining results from the perspective of the application
servers, we now turn to characterizing delay components from the
perspective of end-users. This is motivated by the question: Do
OSNs such as Facebook introduce signiï¬cant delay overhead to
impact user experience while interacting with third-party appli-
cations? If so, what factors inï¬‚uence these delays?
We ï¬rst discuss how OSN delays are estimated by sending ac-
tive probes (synthetic requests) through Facebook from PL nodes,
followed by discussions of the results.
6.1 Extracting OSN Delays
Section 3 outlines the two types of delays that are involved when
a client interacts with an OSN to access third-party applications:
9proï¬le.setFBML, feed.publishUserAction, notiï¬cations.send and
users.getInfo. We term these as Type B calls.
10notiï¬cations.sendEmail and users.hasAppPermission. We term
these as Type A calls.
70Request Arrivals
Type A API calls
Type B API calls
All API calls
 10
 1
)
e
l
a
c
s
g
o
l
(
n
o
i
t
a
r
u
D
l
l
a
C
I
P
A
.
g
v
A
 0.1
Sat 12/20
00:00
Mon 12/22
00:00
Wed 12/24
00:00
Fri 12/26
00:00
Tue 12/30
00:00
Thu 01/01
00:00
Sat 01/03
00:00
Sun 12/28
00:00
Time
 20000
 18000
 16000
 14000
 12000
 10000
 8000
 6000
 4000
s
t
s
e
u
q
e
r
f
o
#
 2000
Mon 01/05
00:00
Figure 10: Variation in API call duration with load for Hugged.
The Type A calls cause the overall call duration for Hugged to
be extremely sensitive to load.
 10
 1
)
e
l
a
c
s
g
o
l
(
n
o
i
t
a
r
u
D
l
l
a
C
I
P
A
Request Arrivals
API Call Duration
 16000
 14000
 12000
 10000
 8000
 6000
 4000
 2000
s
t
s
e
u
q
e
r
f
o
#
 0.1
Sat 12/20
00:00
Mon 12/22
00:00
Wed 12/24
00:00
Fri 12/26
00:00
Tue 12/30
00:00
Thu 01/01
00:00
Sat 01/03
00:00
Sun 12/28
00:00
Time
 0
Mon 01/05
00:00
Figure 11: Variation in API call duration with load for Holiday
Cheers. The call duration seemed to be fairly stable despite the
viral growth of the application.
the OSN request forwarding delay (ğ‘‘ğ‘“ ) and the OSN response pro-
cessing delay (ğ‘‘ğ‘”). As explained in Section 4.3, our experiments
involve a diverse set of PL nodes that represent the clients. Our
data shows that the client requests generated in our PL experiments
were forwarded by Facebook to the application servers, from 27
distinct IP addresses, all of which are located in California11. We
analyzed the round-trip delays from nodes in different countries to
these Facebook servers. The average RTT was around 170ms, with
nodes farther away geographically having higher round-trip delays.
Experiments from nodes in different countries showed similar ğ‘‘ğ‘“
and ğ‘‘ğ‘” values (with differences of less than 10ms on average for
the same experiment). However, the outliers among these nodes
(most notably in Armenia, India and China) registered larger OSN
delays consistently. This is mainly due to the differences in the
CPU power and loads on these nodes at the time of the experiment.
Since per-country results are diluted by differences in CPU load
and CPU power, we do not present results based on geographical
location. The variables in our experimental results include the dif-
ferent user accounts used, number of Facebook friends the target
user has, the applications being queried, the time of day and week
the experiments were performed, and the Facebook network of the
targeted users. We attempt to minimize the effect of these variables;
our choices of variables are explained along with the results.
Our active measurements using PL nodes provide ğ‘¡9 âˆ’ ğ‘¡1 (see
Figure 2). By subtracting the Application Processing Delay (ğ‘‘ğ‘)
and the estimated transmission and propagation delays, we get the
11Determined using geo-location services such as â€˜hostip.infoâ€™
Hugged
iSmile
Holiday Cheers
My Angels
Pound Puppies
The Streets
900
800
700
600
500
400
300
200
100
l
i
y
a
e
D
g
n
d
r
a
w
r
o
F
N
S
O
)
s
d
n
o
c
e
s
i
l
l
i
m
(
0
0
1
2
3
4
5
6
7
8
9 10 11 12 13 14 15 16 17 18 19 20 25 30 35 40 45 50
Request Size (Kb)
Figure 12: OSN forwarding delays (ğ‘‘ğ‘“ ) with varied request
sizes (observed from Dec 27, 2008 to Jan 3, 2009). The verti-
cal bars denote minima and maxima for the averaged measure-
ments.
the sum of ğ‘‘ğ‘“ and ğ‘‘ğ‘”. Lacking synchronized clocks in PL, we rely
on round-trip times per request rather than one-way delays, for cal-
culating ğ‘‘ğ‘“ and ğ‘‘ğ‘”. As a work-around, for requests of size 0Kb
(that require 0Kb responses, except time stamp information nec-
essary for calculating ğ‘‘ğ‘“ and ğ‘‘ğ‘”), we simply remove all (known)
network and application layer delays from the total time taken for
a request to return (to the client), and estimate 50% of that time as
ğ‘‘ğ‘“ . We use this ğ‘‘ğ‘“ to calculate subsequent ğ‘‘ğ‘” values for response
sizes greater than 0Kb.
6.2 OSN Request Forwarding Delays
Facebook, being the intermediary, must ensure that usersâ€™ re-
quests are forwarded to the application servers in a timely man-
ner. We ï¬rst address key questions concerning the forwarding delay
(ğ‘‘ğ‘“ ) and summarize our observations:
(1) OSN request forwarding delays are around 130ms for user
requests of size 0â€“1Kb (typical for the six chosen Facebook appli-
cations). We gauge ğ‘‘ğ‘“ (as explained previously) by varying user
request sizes (from 0Kb to 50Kb) to application servers. Figure 12
shows how ğ‘‘ğ‘“ for Facebook applications varies with request size.
The minimum ğ‘‘ğ‘“ (i.e., for a 0Kb request size) was about 130ms,
while requests of size 50Kb took 550â€“650ms to leave Facebook.
Since all user requests are 0Kb to 1Kb in size, for the considered