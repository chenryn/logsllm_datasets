### 软件下载地址

- **Fragroute**
  - 下载地址: <http://www.monkey.org/dugsong/fragroute/>
  - Fragroute与DSniff出自同一开发者。该工具最初设计用于测试入侵检测系统（IDS）、防火墙及TCP/IP栈的行为，使其成为一款能够干扰IDS的强大工具。此外，Fragroute还具备截取、修改和重写外发数据包的功能，支持多种IDS攻击手段。它提供了一种简单的规则设置语言，允许用户通过配置延迟、复制、丢弃、碎片化、重叠、打印、重排、分割、源路由等操作来向目标主机发送数据包。

- **John the Ripper**
  - 下载地址: <http://www.openwall.com/john/>
  - John the Ripper是一款功能强大、灵活且快速的多平台哈希密码破解器，主要用于检测Unix系统中的弱口令。它支持几乎所有在Unix平台上使用`crypt`函数加密后的口令哈希类型，并兼容Kerberos AFS和Windows NT/2000/XP LM哈希等。

### 8.2 日志分析：安全进阶的基本功

#### 8.2.1 利用日志信息防范Linux入侵

许多人小时候都看过关于西部牛仔的电视剧，记得其中的一个场景是追踪者只需将耳朵贴在铁轨上就能分辨出火车何时经过，或者根据沙滩上的足迹判断一匹马上骑了几个人。同样地，在网络安全领域，你也可以成为这样的人，只不过是在现代背景下。系统中到处都是“记号”，你的任务就是发现并解释它们。

如今，越来越多的人开始关注日志，因为日志能够揭示系统安全的关键线索。无论是黑客入侵还是管理员误操作，都可能导致系统出现不可预见的问题。本文重点讨论的是Linux平台下的日志分析，并结合实际案例进行说明。

**1. 安全第一步：Syslog记录了什么内容**

就像飞机需要黑匣子记录飞行数据一样，Linux系统也使用Syslog工具记录系统事件。通过Syslog，可以方便地记录谁在何时何地做了什么事情，从而了解系统的历史活动。

在Linux系统中，日志通常存储在`/var/log`目录下，这里记录了系统维护和其他程序的信息。常见的日志文件包括：

- `/var/log/boot.log`: 记录系统启动或关闭时的信息。
- `/var/log/cron`: 记录定时任务（cron jobs）的动作。
- `/var/log/maillog`: 记录电子邮件活动。
- `/var/log/secure`: 记录系统的安全信息。

要启动Syslog服务，可以使用命令`service syslog status`检查其状态。如果未运行，可以通过`service syslog start`启动。

**2. 实事求是：忠实记录系统的一举一动**

Syslog的主要配置文件是`/etc/syslog.conf`，用户可以使用vi编辑器打开并修改。该文件指定了日志记录的规则，每条记录包含选择域和动作域。例如，“kern.emerg /var/adm/kernel”表示将内核紧急信息记录到`/var/adm/kernel`文件中。

为了便于管理，Syslog提供了多种记录方式，包括本地文件、终端设备、指定用户以及远程主机。

在日常安全部署中，有两种主要的日志管理方法：
- 将不同服务器的日志分别存放在各自的系统中，由系统管理员分散管理。
- 使用日志主机系统集中收集和管理来自多个主机的日志，提高管理效率。

**3. 兵来将挡：利用日志信息阻止Linux入侵**

通过对日志信息的分析，可以检查错误原因，监测入侵者并实时监控系统状态。一个典型的案例是黑客不断尝试登录Linux系统。以下是一个具体的分析过程：

1. **问题起因及现象分析**:
   使用`last | more`命令查看正常情况下的登录历史记录，发现Syslog被非法修改，可能存在入侵事件。

2. **日志分析**:
   检查`/var/log/secure`文件，发现非法登录者的IP地址为211.130.162.158。使用WHOIS查询该IP地址的相关信息。

3. **查看hosts.deny和hosts.allow文件**:
   配置这两个文件以限制特定IP地址的服务访问。例如，“ALL: 211.130.162.158”表示拒绝该IP地址的所有服务请求。

4. **下载RWSecure压缩包**:
   RWSecure是一个脚本程序，可以自动分析`/var/log/secure`中的非法登录日志，并根据设定的失败次数将相应IP地址加入`hosts.deny`文件中。下载地址：<http://linux.softpedia.com/progDownload/RWSecure-Download-10797.html>。

5. **解压缩并配置RWSecure**:
   使用`tar`命令解压缩RWSecure，并使用vi编辑器设置参数，如登录失败次数和安全日志路径。

6. **查看非法登录信息**:
   脚本自动运行后，会将非法登录IP添加到`hosts.deny`文件中，并附带详细注释。

日志记录了系统每天的各种活动，是保障系统安全的重要组成部分。通过上述设置，可以对入侵者实施有效的防护。然而，需要注意的是，一些日志工具也可能成为攻击者的目标，因此在实际防范中需知己知彼，形成稳固的安全防线。

### 8.2.2 TCPDump的跟踪日志及应用

据英国《观察家报》报道，在联合国安理会就伊拉克战争进行关键表决之前，英国情报机构曾协助美国窃听安理会成员国代表团的电话，其中包括中国代表团。目前，全球约有35,000名专职人员从事电话通信窃听工作。这些窃听设备自动化程度很高，一旦目标电话开始使用，监听设备立即启动。