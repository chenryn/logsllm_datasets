   3 www.google.cv
   3 www.google.com.py
   3 www.google.com.ly
   3 www.google.com.et
   3 www.google.co.zw
   3 www.google.co.tz
   3 www.google.co.ao
   2 www.google.ps
   2 www.google.mg
   2 www.google.kz
   2 www.google.ht
   2 www.google.gy
   2 www.google.gp
   2 www.google.gg
   2 www.google.com.kh
   2 www.google.com.bn
   2 www.google.co.zm
   2 www.google.co.ug
   2 www.google.co.bw
   2 www.google.cd
   1 www.google.vg
   1 www.google.mk
   1 www.google.kg
   1 www.google.co.vi
   1 www.google.cm
   1 www.google.bj
   1 www.google.as
   1 www.google.ad
50
293 different User-Agent’s (top 20 most used)  
UPnProxy: Observations
4822 [Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_2 like Mac OS X) AppleWebKit/603.2.4 (KHTML, like Gecko) Version/10.0 Mobile/14F89 Safari/602.1
2425 [Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36
2414 [Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36
2368 [Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36
2361 [Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36
2339 [Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.2 Safari/605.1.15
2328 [Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0
2327 [Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0
2293 [Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36
2278 [Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36
2274 [Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36
2231 [Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36
2176 [Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36
2126 [Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36
2120 [Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36
2105 [Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0
2088 [Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36
2087 [Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Safari/605.1.15
2076 [Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36
2070 [Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.5 Safari/605.1.15
51
Top talkers...
UPnProxy: Observations
150449 185.177.126.184
 16447 93.190.139.70
 15691 93.190.139.76
  4584 185.177.127.15
  4535 51.89.97.5
  4215 93.190.141.32
  3029 51.89.96.181
  2781 185.177.127.36
  1747 51.91.154.161
   509 5.62.63.30
    46 103.207.38.178
    18 103.147.185.194
    12 162.142.125.38
     8 74.120.14.53
     8 74.120.14.38
     8 167.248.133.55
     8 167.248.133.54
     8 162.142.125.96
     8 162.142.125.40
     7 180.214.239.226
   4 74.120.14.56
   4 74.120.14.37
   4 167.248.133.53
   4 162.142.125.55
   3 178.62.247.40
   3 178.124.163.131
   3 162.142.125.37
   3 162.142.125.128
   3 122.228.19.80
   2 91.241.19.122
   2 89.248.165.84
   2 85.119.151.252
   2 74.82.47.4
   2 74.120.14.40
   2 192.241.213.98
   2 192.241.207.231
   1 94.232.47.170
   1 85.119.151.253
   1 85.119.151.250
   1 71.6.135.131
   1 45.129.56.200
   1 23.129.64.132
   1 192.241.213.231
   1 185.173.35.49
   1 104.140.188.14
52
Top 10 talkers… who are they?
UPnProxy: Observations
Bulk mode; whois.cymru.com [2021-07-09 19:32:29 +0000]
49981   | 185.177.126.184  | 185.177.124.0/22    | NL | ripencc  | 2016-11-14 | WORLDSTREAM, NL
49981   | 93.190.139.70    | 93.190.136.0/22     | NL | ripencc  | 2008-05-16 | WORLDSTREAM, NL
49981   | 93.190.139.76    | 93.190.136.0/22     | NL | ripencc  | 2008-05-16 | WORLDSTREAM, NL
49981   | 185.177.127.15   | 185.177.124.0/22    | NL | ripencc  | 2016-11-14 | WORLDSTREAM, NL
16276   | 51.89.97.5       | 51.89.0.0/16        | FR | ripencc  | 1993-09-01 | OVH, FR
49981   | 93.190.141.32    | 93.190.140.0/22     | NL | ripencc  | 2008-05-16 | WORLDSTREAM, NL
16276   | 51.89.96.181     | 51.89.0.0/16        | FR | ripencc  | 1993-09-01 | OVH, FR
49981   | 185.177.127.36   | 185.177.124.0/22    | NL | ripencc  | 2016-11-14 | WORLDSTREAM, NL
16276   | 51.91.154.161    | 51.91.0.0/16        | FR | ripencc  | 1993-09-01 | OVH, FR
198605  | 5.62.63.30       | 5.62.62.0/23        | GB | ripencc  | 2012-06-08 | AVAST-AS-DC, CZ
53
Theories on this...
UPnProxy: Observations
- Queries seem oddly… human.
- Traffic looks TOO organic 
- Not sure end users are aware they’re using IoT proxies
- (Residental) Proxy seller? 
54
Spam campaigns
UPnProxy: Observations
Message-ID: 
Date: Tue, 11 May 2021 08:18:57 +0600
Reply-To: " Claudia" 
From: " Erika" 
MIME-Version: 1.0
To: ,
        ,
        ,
        ,
        ,
        ,
Subject:  Elisabeth
Content-Type: text/plain;
        charset="us-ascii"
Content-Transfer-Encoding: 8bit
http://joinlove.space/dating
Message-ID: 
MIME-Version: 1.0
To: 
Subject:  Kate
Content-Type: text/plain;
        charset="us-ascii"
Content-Transfer-Encoding: 8bit
http://newestlove.space/dating
Message-ID: 
Date: Tue, 11 May 2021 11:41:42 +1000
From: " Helga" 
MIME-Version: 1.0
To: 
Cc: ,
        ,
        ,
        ,
        ,
Subject:  Sabine
Content-Type: text/plain;
        charset="us-ascii"
Content-Transfer-Encoding: 8bit
http://hotnewlove.space/dating
Message-ID: 
Date: Tue, 11 May 2021 02:14:00 +0500
Reply-To: " Inge" 
From: " Kerstin" 
X-Accept-Language: en-us
MIME-Version: 1.0
To: ,
        ,
Subject: Carin  176cm 50kg
Content-Type: text/plain;
        charset="us-ascii"
Content-Transfer-Encoding: 8bit
http://sexy-sexyloover.space/dating
55
You’ll get blocked pretty quickly
UPnProxy: Observations
2021/05/11 02:34:57 
550 5.7.1 Service unavailable, Helo domain is listed in Spamhaus. To request 
removal from this list see https://www.spamhaus.org/query/lookup/ (S8001) 
[BN1NAM02FT025.eop-nam02.prod.protection.outlook.com]
56
Belarus goes dark… 
UPnProxy: Observations
sb.by (news)
POST URL:/registration/confirm/index.php
GET URL:/bitrix/tools/captcha.php?captcha_sid=10da0c27c3e8ebd1373cae7a860bb14
photobelta.by (stock image hosting?)
GET URL:/ru/photos?theme_id=7217500%27%20union%20select%20%271%27,concat(sleep(360000),1)%23&id=480745
mail.rec.gov.by (central commission of the republic of belarus elections… or something)
GET URL:/mail/
exch.ont.by (news)
POST URL:/owa/auth.owa
57
So...
UPnProxyPot: Observations
So here’s the
 cool part....
58
I’m releasing this to Github...
UPnProxy… for everyone
https://github.com/chadillac/UPnProxyPot
59
So, let’s get some things out of the way right now
UPnProxy: is open source...
- First, this project was for fun, research, and to learn more Golang
- Second, I apologize in advance for my shitty code
- This was a research project… not commercial grade software… good 
enough isn’t perfect, but it’s better than nothing and served its purpose
- Yes, there are bugs, thank you for noticing… open an issue? How about 
you just submit a pull request instead?...
- Yes, it is hacky… I regret nothing
- If you have ideas to fix/improve stuff… it’s open source… fork+pull, k, thx
60
Ideas for improvement
UPnProxy: is open source...
- Logging could be very much improved
- Content injection could be a thing
- There is a memory leak… my solution is to restart the binary… 
- Yes it runs in screen, feel free to properly daemonize it
- Randomize SSDP banners & listen on multiple popular UPnP ports
- Pretend to be A LOT more devices (my findings may be myopic)
61
Ideas for improvement
UPnProxy: is open source...
- Smarter cert caching that respects SNI differences
- Improved TLS handling/proxying
- Improved cert cloning 
- Improved error handling
- Improved basically everything...
62
README.md
UPnProxy: is open source...
- The README.md file should (hopefully) have all you need to know
- If it doesn’t and there are additional bits of info I missed… fork, push, pull
- It’s written in Golang, but also has Linux deps… 
- So it will run on any operating system, so long as it’s Linux.
- You can deploy a node on a VPS provider in minutes…
- You can deploy a node on a RPi, ODroid, etc. just as quickly… DMZ it!
- It will start seeing abuse within the first 24-48 hours, bet.
- If you find something cool… tell me about it! (linkedin)
63
NOW GO HAVE FUN
https://github.com/chadillac/UPnProxyPot