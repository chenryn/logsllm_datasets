How	
  to	
  Train	
  Your	
  RFID	
  Tools	
Craig	
  Young	
Security	
  Researcher	
  @	
  Tripwire	
  VERT	
About	
  Craig	
  Security	
  Researcher	
  in	
  Tripwire	
  VERT	
  Author	
  of	
  IP360	
  content	
  and	
  original	
  research	
  Identiﬁed	
  100+	
  CVEs	
  over	
  2013	
  &	
  2014	
  Won	
  1st	
  SOHOpelessly	
  Broken	
  @	
  DC22	
  using	
  10	
  0-­‐days	
Research	
  Objectives	
  Shed	
  light	
  on	
  the	
  tools	
  for	
  reading,	
  cloning,	
  &	
  emulating	
  Provide	
  tutorial-­‐like	
  examples	
  for	
  ﬁrmware	
  hacking	
  Explore	
  practical	
  attacks	
  enhanced	
  by	
  3D	
  printing	
  Design	
  antenna	
  around	
  3D	
  printed	
  form	
  Identify	
  uses	
  of	
  paired	
  embedded	
  kits	
Roadmap	
Tool	
  Intros	
3D	
  Printing	
  101	
• Caveats	
RFID	
  Basics	
• Tips	
  &	
  Tricks	
Firmware	
  Hacking	
• Adding	
  to	
  Proxmark	
3D	
  Printing	
  Usage	
• Antenna	
  Design	
• Concealing	
  Devices	
Q	
  &	
  A	
Tool	
  Intros	
CubePro	
  3D	
  Printer	
NFC	
  USB	
  (PN533)	
RFIDler	
  v22	
Proxmark3	
Raspberry	
  Pi	
USB	
  Armory	
Tools	
CubePro	
  3D	
  Printer	
NFC	
  USB	
  (PN533)	
RFIDler	
  v22	
Proxmark3	
Raspberry	
  Pi	
USB	
  Armory	
RFID	
Tools	
CubePro	
  3D	
  Printer	
NFC	
  USB	
  (PN533)	
RFIDler	
  v22	
Proxmark3	
Raspberry	
  Pi	
USB	
  Armory	
Computing	
Tools	
CubePro	
  3D	
  Printer	
NFC	
  USB	
  (PN533)	
RFIDler	
  v22	
Proxmark3	
Raspberry	
  Pi	
USB	
  Armory	
Fabrication	
Proxmark3	
  Intro	
  Adopted	
  from	
  Gerhard	
  de	
  Koning	
  Gans’	
  thesis	
Koning	
  Gans	
  was	
  analyzing	
  Mifare	
  transit	
  cards	
  This	
  system	
  combines	
  cheap	
  FPGA	
  and	
  ARM	
  CPU	
  Completely	
  open	
  source	
  HW	
  and	
  SW	
  Low	
  &	
  High	
  Frequency	
  support	
The	
  Proxmark3	
  FPGA	
  Xilinx	
  Spartan-­‐II	
  Field-­‐Programmable	
  Gate	
  Array	
  Written	
  in	
  Verilog	
  for	
  ISE	
  WebPACK	
  Serial	
  Peripheral	
  Interface	
  (SPI)	
  Coil	
  driver	
  Analogue/Digital	
  Converters	
  Synchronous	
  Serial	
  Port	
  to	
  CPU	
  Module	
  based	
  design	
  Modes	
  specify	
  module	
  connections	
Proxmark3	
  CPU	
  ATMEL	
  32-­‐bit	
  RISC	
  Processor	
  (AT91SAM7Sxx	
  Series)	
  Coded	
  in	
  C	
  Receives	
  data	
  from	
  FPGA	
  Encoding/decoding	
  of	
  bitstream	
  Handle	
  USB	
  data	
  link	
  All	
  high	
  level	
  functions	
  run	
  here	
Proxmark3	
  ADC	
  TI	
  TLC	
  5540	
  analog-­‐to-­‐digital	
  converter	
  (ADC)	
  8-­‐bit	
  resolution	
  40	
  Megasamples/sec	
  (MSPS)	
  Analog	
  input	
  from	
  coil	
  8-­‐pin	
  output	
  to	
  FPGA	
  Control	
  via	
  SPI	
Proxmark3	
  Connectors	
  Mini-­‐USB	
  Provides	
  Power	
  Data	
  connection	
  via	
  USB-­‐Serial	
  Hirose	
  Connector	
  Connection	
  to	
  antenna	
  coil(s)	
  2	
  wires	
  for	
  LF	
  and	
  2	
  for	
  HF	
Proxmark3	
  Human	
  I/O	
  Single	
  push	
  button	
  Control	
  PM3	
  without	
  serial	
  Terminate	
  active	
  operations	
  Initiate	
  ﬁrmware	
  update	
  Colored	
  LEDs	
  (4	
  total)	
  Indicate	
  boot	
  mode	
  Stand-­‐alone	
  status	
  lights	
Proxmark	
  Commands	
  lf	
  search	
  &	
  hf	
  search	
  –	
  Attempt	
  to	
  auto	
  ID	
  a	
  tag	
hf	
  14a	
  reader	
  –	
  Interrogate	
  ISO14443a	
  Tag	
  lf	
  read;	
  data	
  samples	
  –	
  Grab	
  LF	
  tag	
  waveform	
hf	
  mf	
  mifare;	
  hf	
  mf	
  nested	
  –	
  Mifare	
  Classic	
  Attack	
PN533	
  NFC	
  USB	
  Intro	
  NXP	
  Chipset	
  for	
  Near	
  Field	
  Communications	
  Hardware	
  implementation	
  of	
  ISO	
  14443	
  standards	
  MIFARE	
  Family	
  (ISO/IEC	
  14443A)	
  NFC	
  Forum	
  Type	
  4	
  Tag	
  2.0	
  (ISO/IEC	
  14443B)	
  Sony	
  Felicity	
  Tags	
  (FeliCa	
  reader/writer)	
  Peer-­‐to-­‐Peer	
  Data	
  Transfer	
  (ISO/IEC	
  18092)	
  libNFC	
  Compatible	
PN533	
  Commands	
  PN533	
  supports	
  libNFC	
  including	
  these	
  CLI	
  tools:	
nfc-­‐list	
  –	
  Basic	
  Tag	
  Enumeration	
nfc-­‐emulate-­‐*	
  –	
  Emulate	
  various	
  tag	
nfc-­‐mf*	
  –	
  Work	
  with	
  Mifare	
  family	
  tags	
nfc-­‐relay	
  –	
  Use	
  2	
  devices	
  to	
  perform	
  a	
  relay	
  attack	
  Additional	
  functionality	
  via	
  scripting	
RFIDler	
  Intro	
  125kHz-­‐134kHz	
  ASK	
  and	
  FSK	
  reading	
  and	
  emulation	
  V22	
  Beta	
  Obtained	
  at	
  DEF	
  CON	
  22	
  (coil	
  not	
  pictured)	
Annotated	
  RFIDler	
  Digital	
  POTs	
  for	
  threshold	
  tuning	
  USB	
  Serial	
  Interface	
  LED	
  indicators	
  PIC32	
  for	
  main	
  guts	
  USB	
  Powered	
RFIDler	
  Commands	
  AUTOTAG	
  –	
  Demodulate	
  tag	
  as	
  each	
  known	
  type	
  SET	
  TAG	
  –	
  Switch	
  between	
  tag	
  formats	
  POTSET	
  -­‐	
  Adjust	
  potentiometer	
  thresholds	
  READER	
  –	
  Realtime	
  demodulation/decoding	
LATE	
  COMER:	
  The	
  ChameleonMini	
  Developed	
  by	
  Chair	
  for	
  Embedded	
  Security	
  of	
  the	
  Ruhr-­‐
University	
  in	
  Bochum,	
  Germany	
  ISO14443	
  and	
  ISO15693	
  compliant	
  emulator	
  Simulates	
  contactless	
  smartcards	
  with	
  hardware	
  Create	
  perfect	
  virtualized	
  clones	
  of	
  a	
  tag	
  Started	
  shipping	
  from	
  RyscCorp	
  in	
  July	
  (hot	
  oﬀ	
  the	
  press)	
ChameleonMini	
USB	
PDI	
headers	
Power	
  and	
  CDC	
  data	
  (LUFA)	
Raspberry	
  Pi	
  &	
  USB	
  Armory	
  Embedded	
  ARM	
  dev	
  kit	
  SD	
  Card	
  Storage	
  USB	
  Power	
  &	
  Data	
  Thumb-­‐drive	
  ARM	
  computer	
  USB	
  Host	
  or	
  Guest	
  via	
  OTG	
MicroSD	
  Storage	
3D	
  Printer	
  Intro	
CubePro	
  with	
  70,	
  200,	
  or	
  300	
  micron	
  layer	
  options	
  ABS	
  and	
  PLA	
  support	
  with	
  Nylon	
  ‘coming	
  soon’	
  11.2”	
  x	
  10.6”	
  x	
  9.06”	
  build	
  volume	
  Up	
  to	
  3	
  print	
  jets	
  for	
  complex	
  builds	
CubePro	
  3D	
  Printer	
  Steps	
3D	
  CAD	
  model	
  is	
  sliced	
  by	
  CubePro	
  software	
  into	
  layers	
Build	
  plate	
  receives	
  a	
  coating	
  of	
  water-­‐soluble	
  glue	
Gears	
  feed	
  ﬁlament	
  into	
  extruder	
  moving	
  on	
  X	
  &	
  Y	
Extruder	
  moves	
  on	
  X	
  and	
  Y;	
  plate	
  moves	
  on	
  Z	
  for	
  layers	
Glue	
  dissolves	
  in	
  water	
  and	
  model	
  can	
  be	
  pried	
  away	
  Calibration	
  can	
  be	
  time	
  consuming	
  and	
  tricky	
  Extruders	
  prone	
  to	
  jams/clogs	
  clogged	
  Industrial	
  design	
  is	
  tricky	
  Physical	
  limitations	
  Materials	
  science	
Printing	
  Caveats	
RFID	
  Basics	
  Low-­‐Frequency:	
  125kHz	
  –	
  134	
  kHz	
  Access	
  Control	
  Proximity	
  Cards:	
  HID,	
  Indala,	
  AWID,	
  etc	
  Pet	
  chips	
  /	
  implantable:	
  AVID,	
  Fecava,	
  ISO	
  11784/11785	
  High-­‐Frequency:	
  13.56MHz	
  Access	
  control:	
  HID	
  iCLASS,	
  NXP	
  Mifare	
  family	
  NFC:	
  Contactless	
  payment,	
  bluetooth	
  pairing,	
  etc.	
  IDs:	
  ePA	
  (German	
  ID	
  card),	
  passports,	
  etc	
What’s	
  in	
  an	
  RFID	
  Tag	
Tuned	
  coil	
  +	
  LC	
  =	
  Passive	
  RFID	
  Tag	