### Overview and Methodology

This paper presents a comprehensive methodology for the detection and monitoring of Internet of Things (IoT) devices at scale. Specifically, we address the challenge of detecting devices of type A and B, while noting that devices of type C are more difficult to detect due to the sampling rates and header-only nature of NetFlow data.

#### Testbed and Dataset

We utilize a unique testbed and dataset to develop our methodology. The testbed includes 96 IoT devices from 40 different manufacturers, covering various categories such as surveillance, smart hubs, home automation, video, audio, and appliances. This setup allows us to conduct controlled experiments and gather ground truth IoT traffic data.

#### Methodology Steps

1. **Ground Truth Traffic Generation**:
   - We tunnel the traffic of two IoT testbeds, each with 48 devices, to an Internet Service Provider (ISP). This provides us with ground truth IoT traffic within the ISP.
   - The traffic is captured and analyzed to confirm its visibility in the ISP's NetFlow data.

2. **Backend Infrastructure Identification**:
   - We identify the backend infrastructure for many IoT services by analyzing the observed ISP IoT traffic.
   - We augment this information with data from DNS queries, web certificates, and banners to create a comprehensive view of the backend infrastructure.

3. **Traffic Signature Development**:
   - We derive distinct traffic signatures based on IP addresses, domains, and port numbers to recognize IoT devices.
   - These signatures enable us to identify the presence of devices from 31 out of 40 manufacturers in our testbed.

4. **Detection and Monitoring**:
   - Using the derived signatures, we identify broadband subscriber lines using IoT services at the ISP and an Internet Exchange Point (IXP).
   - We cross-check the detection rules by inferring devices on the ground truth data.

5. **Results and Discussion**:
   - We discuss the results, their significance, and limitations in Section 7.
   - We also review related work in Section 8 and provide a summary in Section 9.

### Main Contributions

- **Methodology for IoT Device Detection**: We develop a robust methodology for identifying IoT devices by classifying the domains and IP addresses of the backend infrastructure.
- **Signature Availability**: To foster further research in IoT privacy and security, we make all the signatures available at [https://moniotrlab.ccis.neu.edu/imc20/](https://moniotrlab.ccis.neu.edu/imc20/).

### Experimental Setup

#### Ethical Considerations

- **Home-VP Setting**: With the cooperation of the ISP, we use a reserved /28 prefix allocated to a specific subscriber line (Home-VP) with explicit consent. This ensures that the analysis only considers traffic generated by the ground truth experiments and does not involve any user-generated traffic.

#### Ground Truth Traffic Setting

- **Testbed Devices**: Our testbed consists of 96 devices from 40 vendors, selected to provide diversity within and between different categories.
- **Automation**: Most devices are controlled using voice interfaces or smartphone companion applications. We use a Google Voice synthesizer and the Monkey Application Exerciser for Android Studio to automate interactions.

#### Active and Idle Experiments

- **Idle Experiments**: Devices are connected to the internet without active use, generating idle traffic for three days.
- **Active Experiments**: Automated interactions, including power and functional interactions, are performed. In total, 9,810 active experiments were conducted over four days.

### Visibility Analysis

- **Service IPs and Domains**: We analyze the number of unique service IPs and domains contacted per hour during both idle and active experiments.
- **Visibility at ISP-VP**: Despite low sampling rates, popular service IPs and domains are significantly visible at the ISP vantage point.
- **Port-Based Analysis**: We separate observable network activity by ports, including Web Services, NTP services, and other services, and show the cumulative number of service IPs contacted.

### Summary

Our analysis of the ground truth IoT traffic shows that, despite the low sampling of NetFlow, popular domains, service IPs, and ports of a single subscriber line (the Home-VP) are visible at the ISP. This methodology provides a robust framework for the detection and monitoring of IoT devices at scale.