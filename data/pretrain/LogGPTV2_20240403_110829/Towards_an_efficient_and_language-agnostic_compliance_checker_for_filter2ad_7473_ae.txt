TowardsanEfﬁcientandLanguage-AgnosticComplianceCheckerforTrustNegotiationSystemsAdamJ.Leeadamlee@cs.uiuc.eduMarianneWinslettwinslett@cs.uiuc.eduDepartmentofComputerScienceUniversityofIllinoisatUrbana-ChampaignUrbana,IL61801ABSTRACTToensurethatatrustnegotiationsucceedswheneverpossi-ble,authorizationpolicycompliancecheckersmustbeabletoﬁndallminimalsetsoftheirowners’credentialsthatcanbeusedtosatisfyagivenpolicy.Ifallofthesesetscanbefoundeﬃcientlypriortochoosingwhichsetshouldbedisclosed,manystrategicbeneﬁtscanalsoberealized.Un-fortunately,solvingthisproblemusingexistingcompliancecheckersistooineﬃcienttobeusefulinpractice.Speciﬁ-cally,theoverheadsofﬁndingallsatisfyingsetsusingexist-ingapproacheshavebeenshowntorapidlygrowexponen-tiallyinthesizeoftheunionofallsatisfyingsetsofcreden-tialsforthepolicy,evenafteroptimizationshavebeenmadetoprunethesearchspaceforpotentialsatisfyingsets.Inthispaper,wedescribetheClouseaucompliancechecker.Clouseauleverageseﬃcientpattern-matchingal-gorithmstoﬁndallsatisfyingsetsofcredentialsforagivenpolicyintimethatgrowsasO(NA),whereNisthenumberofsatisfyingsetsforthepolicyandAistheaveragesizeofeachsatisfyingset.Wedescribethedesignandimple-mentationoftheClouseaucompliancechecker,evaluateitsperformance,andshowthatitvastlyoutperformsexist-ingapproachestoﬁndingallsatisfyingsetsofcredentials.WethenpresentamethodforautomaticallycompilingRTpoliciesintoaformatsuitableforanalysisbyClouseauandproveitscorrectnessandcompleteness.CategoriesandSubjectDescriptors:D.4.6[OperatingSystems]:SecurityandProtection—accesscontrols,authen-tication;K.6.5[ManagementofComputingandInformationSystems]:SecurityandProtectionGeneralTerms:Algorithms,Performance,SecurityKeywords:Compliancechecker,policy,satisfyingsets,trustnegotiation1.INTRODUCTIONIntrustnegotiationapproachestoauthorization(e.g.[5,9,18,23,24,25]),resourcesareprotectedbyattribute-Permissiontomakedigitalorhardcopiesofallorpartofthisworkforpersonalorclassroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributedforproﬁtorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitationontheﬁrstpage.Tocopyotherwise,torepublish,topostonserversortoredistributetolists,requirespriorspeciﬁcpermissionand/orafee.ASIACCS’08,March18-20,Tokyo,JapanCopyright2008ACM978-1-59593-979-1/08/0003...$5.00.basedaccesspolicies,ratherthanexplicitaccesscontrollists.Entitiesusecryptographiccredentialsissuedbythird-partyattributecertiﬁers(e.g.,professionalorganizations,employ-ers,orgovernmentbodies)toprovevariousattributesaboutthemselves.Sincetheseattributesmightthemselvesbecon-sideredsensitive,theycanoptionallybeprotectedbyreleasepoliciesplacingconstraintsontheindividualstowhomtheycanbedisclosed.Assuch,atrustnegotiationsessionevolvesintoabilateralanditerativeexchangeofpoliciesandcreden-tialswiththeendgoalofdevelopingnewtrustrelationshipson-the-ﬂy.Becausethesetypesofsystemsallowresourcead-ministratorstospecifytheintentionofapolicy,ratherthanitslogicalextension(i.e.,anaccesscontrollist),authorizedentitiescangainaccesstoavailableresourceswithoutre-quiringthattheiridentitybeknownapriori.Thedesignofrobustandhighly-availabletrustnegoti-ationsystemshingesontheavailabilityofeﬃcientpolicycompliancecheckers.GivenapolicypandasetCofcre-dentials,thecompliancecheckerisresponsiblefordetermin-ingoneormoreminimalsubsetsofCthatsatisfyp.Wecalltheseminimalsubsetssatisfyingsetsofcredentials.Toensurethattrustnegotiationprotocolsestablishtrustwhen-everpossible,thecompliancecheckersusedmustbecapableofﬁndingallsatisfyingsetsofcredentialsforagivenpol-icy.Thisenablesthenegotiatortoattemptalternatemeansofestablishingtrustintheeventthattheinitially-chosennegotiationtacticleadstoadeadlockorotherdeadend.Trustnegotiationisintrinsicallyastrategy-drivenpro-cessinwhichtheparticipantseachattempttoadvancethestateoftheprotocolwhilemaximizingtheirownparticulargoals[28].Forinstance,theso-calledeagerandparsimo-niousnegotiationstrategiesallownegotiationparticipantstobalanceatrade-oﬀbetweennegotiationspeedandprivacybychoosingtodiscloseeitherallcredentialsthataremotepartyisauthorizedtovieworonlythosethathavebeendeemedrelevanttosatisfyingthepolicyathand,respec-tively[24].Ifanegotiationparticipantisabletodetermineallsatisfyingsetsofcredentialsforagivenpolicyapriori,thenmuchﬁner-grainedstrategiescanbeemployed.Forexample:•Ifentitiesassignpointvaluestoindividualcredentialsthatindicateeachcredential’slevelofsensitivity(e.g.,asin[27]),thenegotiationprocesscanrespondtoagivenpolicybydisclosingthesatisfyingsetwiththelowestoverallsensitivity.•Intheeventthatanentityhasdigitalcredentialsrep-resentingmembershipsinorganizationsthatmayleadtovarioustypesofdiscountsorpreferentialtreatment(e.g.,AAA,AARP,orfrequentﬂyercredentials),theycouldemployanegotiationstrategythatdisclosessat-isfyingsetscontainingthesetypesofcredentialsﬁrst.•Insomecases,entitiesmightwishtominimizethecu-mulativenumberofcredentialsdisclosedovermultipleroundsofagiventrustnegotiationsession;asimplegreedyalgorithmcouldbeusedtodeterminethesat-isfyingsetthatminimizestheoverallnumberofcre-dentialsdisclosed.•Apartymightwishtosteerthenegotiationinthedirectionmostlikelytominimizeitsduration.Forex-ample,aservermaywishtoleadthenegotiationinthedirectionthattheanalysisoflogsofpastnegotiationshasshowntobethewaythatmostusersgainaccess.Existingcompliancecheckersdesignedfortrustnegotia-tionpolicylanguagesﬁndatmostonesatisfyingsetofcre-dentialsatatime,butcanbeoperatedinaniterativeman-nertodiscoveralternatesatisfyingsetsintheeventthattheﬁrstsetfoundleadstoanegotiationpaththatfailstoestablishtrust.Whilethisiterativeapproachtodiscover-ingsatisfyingsetsissuﬃcienttoensurethecompletenessoftrustnegotiationprotocols,itisaveryslowwaytodis-coverallsatisfyingsetsatonce.Asaresult,itisunrealistictousethisapproachasthebasisforthetypesofstrategiesdiscussedabove.Speciﬁcally,theoverheadsofﬁndingallsatisfyingsetsusingsuchanapproachhavebeenshowntogrowexponentiallyinthesizeoftheunionofallsatisfyingsetsofcredentialsforthepolicy,evenafteroptimizationshavebeenmadetoprunethesearchspaceforpotentialsat-isfyingsets[22].Inthispaper,wedescribethedesignandimplementa-tionofClouseau,ahighly-eﬃcientandpolicylanguage-agnosticcompliancecheckerfortrustnegotiationsystems.Ratherthandiscoveringsatisfyingsetsofcredentialsusingatop-downproofconstructionsystem,Clouseausolvesthepolicycompliancecheckingproblembycompilingpoliciesintoaformatthatcanbeeﬃcientlyanalyzedusingsolutionstothemanypattern/manyobjectpatternmatchproblem.Givenasetofpatternsandasetofobjects,algorithmsforsolvingthisproblemﬁndallpatternsmatchedbysubsetsoftheprovidedobjects.Internally,Clouseaurepresentsac-cesscontrolpoliciesaspatternsspecifyingconstraintsonthecredentials,credentialchains,anduncertiﬁedclaims(e.g.,phonenumbers,addresses,etc.)thatmustbepresentedtogainaccesstoaparticularresource.TheRetealgorithm[13]isthenusedtoﬁndallsatisfyingsetsbyeﬃcientlymatchingobjectsrepresentingauser’scredentialsandclaimsagainstthesepatterns.Overall,Clouseaumakesseveralimportantcontributionsrelatedtothecompliancecheckerproblemfortrustnegotiationsystems:•Clouseaurequiresonlytensofmilliseconds,onav-erage,todetermineeverysatisfyingsetofcredentialsassociatedwithareasonably-sizedpolicy;thisiscom-parabletothetimerequiredbyexistingtrustnegoti-ationcompliancecheckerstoﬁndonesatisfyingset.•Tothebestofourknowledge,ClouseaurepresentstheﬁrsttrustnegotiationcompliancecheckercapableofﬁndingallsatisfyingsetsofcredentialsforagivenpolicywithtimeoverheadsthatscaleasO(NA),whereNisthenumberofsatisfyingsetsforapolicyandAistheaveragesizeofeachsatisfyingset.Previoussolutionstothisproblemhaverunningtimeoverheadsthatgrowexponentiallyinthesizeoftheunionofallsatisfyingsets.Asaconcreteexample,theiterativesolutionpresentedin[22]takesover10secondstoﬁndtwooverlappingsatisfyingsetscontainingatotalof20credentials,whileClouseauﬁndsthesamesatisfyingsetsinapproximately40ms.•Intheworstcase,thenumberofsatisfyingsetsforagivenpolicycanbeexponentialinthesizeofthepol-icy.However,Clouseau’sperformanceremainsrea-sonableevenwhenpoliciesbecomeinordinatelycom-plex.Forexample,Clouseaucanﬁnd512satisfyingsetseachofsize18inapproximatelyonesecond;wehavenotfoundpoliciesofthiscomplexitybeingusedinpracticeormentionedelsewhereintheresearchlit-erature.InSection6,weshowthatpoliciesascomplexaseventhemostcomplicatedpoliciesusedinBecker’sformalizationofthesecurityrequirementsfortheUK’selectronichealthrecordsservice[2]canbeanalyzedbyClouseauinunder100ms.•Sinceitcaneﬃcientlyﬁndallsatisfyingsetsofcre-dentialsforagivenpolicy,Clouseaumakestheuseof“smarter”trustnegotiationstrategiespractical.InSection6,weshowthatClouseauisveryfastatﬁnd-ingtheminimum-weight(e.g.,least-sensitive)satisfy-ingsetofcredentialsforagivenpolicy.•Thedesignofasinglehighly-optimizedcompliancecheckercapableofanalyzingpolicieswritteninanypolicylanguagewouldallowentitiestowritepolicieswithoutworryingaboutthecostsofanalyzingthem.Clouseaucompilespolicieswritteninhigh-levelpol-icylanguagesintoanintermediaterepresentationthatspeciﬁesconstraintsontheactualcredentialsusedtosatisfyagivenaccesscontrolpolicy,whichitcantheneﬃcientlyanalyze.Wepresentaprocessforautomati-callycompilingRT[19]policiesintoaformatthatcanbeanalyzedbyClouseauandprovethecorrectnessandcompletenessofthiscompilationprocedure.Sincepolicieswritteninallexistingtrustnegotiationpolicylanguagesaresatisﬁedbythesametypesofevidence,weconjecturethatequivalentcompilationmechanismscouldbespeciﬁedfortheotherlanguagesaswell.Therestofthispaperisorganizedasfollows.WebeginwithadiscussionofrelatedworkinSection2.Wethenformallydeﬁnethespeciﬁcinstanceofthemoregeneralpol-icycompliancecheckingproblemsolvedbyClouseauinSection3.Section4describestheRetealgorithm,presentsthedesignandimplementationoftheClouseaucompliancechecker,anddiscussestheinternalrepresentationofpoliciesandevidenceusedbyClouseau.WepresentaprocedureforautomaticallycompilingRTpoliciesintoaformatsuit-ableforanalysisbyClouseauinSection5.InSection6weconductaseriesofexperimentstoevaluatetheperformanceofClouseauandcompareitsbeneﬁtsandlimitationstothoseofothercompliancecheckingapproaches.Lastly,wepresentourconclusionsandinterestingdirectionsforfutureworkinSection7.2.RELATEDWORKIn[21],theauthorsbroadlyclassifypolicycompliancecheckersfortrustmanagementandtrustnegotiationsys-temsintothreecategories.Theyﬁrstdeﬁnetype-1com-pliancecheckersasfunctionsthatreturnonlyaBooleanresultindicatingwhetherthepolicyinquestionwassat-isﬁed.CompliancecheckersforthePolicyMaker[7,8]andKeyNote[6]trustmanagementsystemsareincludedinthisﬁrstcategory,asthenon-iterativenatureofthesesystemsmakesthediscoveryofwhyaparticularaccesswaspermit-tedsuperﬂuous;simplyknowingthatthecompliancecheckercanconstructaformalproofofauthorizationissuﬃcient.TheCPOLcompliancechecker[10]isahighly-optimizedcompliancecheckerdesignedtoenforceaccesspoliciesoncentralizedresourcesinhigh-throughputenvironments,suchaslocation-detectionsystems.CPOLusesaggressivecachingandotheroptimizationstoachieveincredibleperformance,butdoesnotreturnevidencesupportingthebinarydeci-sionsthatitmakes.Lastly,thecompliancecheckerforPon-der[12],whichisusedforpolicy-basednetworkadministra-tion,alsofallsintothisﬁrstcategory.Type-2compliancecheckersreturnonesatisfyingsetofcredentialsinadditiontoaBooleanvalueinthecasethatapolicyisfoundtobesatisﬁed.ThecompliancecheckerusedbytheREFEREEsystem[11]iscapableofreturningsuchjustiﬁcations,thoughitneednotdoso.Itisimportanttonotethattheabilitytoassociateatleastonesatisfyingsetofcredentialswithacompliancecheckerdecisionisrequiredbythetrustnegotiationprocess,asotherwiseindividualscouldnotdeterminewhichcredentialsshouldbesenttotheirne-gotiationpartneraftertheydeterminethataremotepolicycanbesatisﬁed.Assuch,thecompliancecheckersfortheXML-basedpolicylanguagesX-TNL[4]andtheIBMTrustPolicyLanguage[15]fallintothiscategory,asdocompliancecheckersforexistinglogic-basedtrustnegotiationpolicylan-guages,suchasCassandra[3]andthelanguagepresentedbyKoshutanskiandMassacciin[16].Lastly,type-3compliancecheckersaredeﬁnedasfunc-tionsthatreturneveryminimalsetofcredentialsthatcanbeusedtosatisfyaparticularpolicy.Todate,notrustnegoti-ationcompliancecheckershavebeendevelopedexpresslyforthispurpose,althoughsigniﬁcantstrategicbeneﬁtscouldberecognizedbysuchacompliancechecker.In[22],Smithetal.discussseveralimportantusesofthistypeofcompliancecheckeranddescribetheSatisfyingSetGeneration(SSgen)algorithmfordiscoveringallsatisfyingsetsforagivenpol-icyusingatype-2policycompliancecheckerasablackbox.Theyshowthatwhenpoliciesareexpressedindisjunctivenormalform(DNF),thenanumberofcleveroptimizationscanbemadetoprunethestatespacethatmustbesearchedforsatisfyingsetsofcredentials.TheythenevaluatetheperformanceofanimplementationoftheSSgenalgorithmthatusedtheIBMTEcompliancechecker[15]asthebasetype-2compliancechecker.Figure1isareproductionoftheresultspresentedin[22]depictingtherunningtimesoftheSSGenalgorithm.ThethreemostinterestingcasesinwhichtheSSgenalgorithmwasevaluatedincludethecasesinwhich(i)apolicyhasonesatisfyingsetofsizeU,(ii)apolicyhasUsatisfyingsetsofsizeone,and(iii)apolicyhastwosatisfyingsets,eachofsize3U4.Inallcases,Urepresentsthesizeoftheunionofallsatisfyingsetsandwasvariedbetween1and24.Incase(i),theSSgenalgorithmscaledlinearlywithUinthesub-second 0 2 4 6 8 10 12 14 0 5 10 15 20Average time (sec)Size of the union of all satisfying sets (U)One satisfying setU satisfying setsTwo satisfying setsFigure1:RunningtimeoftheSSGenalgorithmasafunctionofthesizeoftheunionofallsatisfyingsets.timerange.Incases(ii)and(iii),theSSgenalgorithm’srunningtimeincreasedexponentiallywithUandrapidlybecameimpractical.Clouseauimprovesuponthispreviousworkbycompil-ingtrustnegotiationpoliciesintoanintermediaterepresen-tationthatcanbeanalyzedusingeﬃcientpatternmatchingalgorithms.Thisnon-traditionalapproachtotheoremprov-inggreatlyoptimizestheprocessofﬁndingallpossiblesatis-fyingsetsofcredentialsforagivenpolicy.Further,becauseexistingtrustnegotiationpolicylanguagescanbecompiledintoaformatthatcanbeanalyzedusingClouseau,devel-operscanoptimizetrustnegotiationruntimesystemswhilestillallowingpolicywriterstocontinuetouseexistinghigh-levelpolicylanguages.3.PROBLEMDEFINITIONAtitsmostbasiclevel,atrustnegotiationsessionisabi-lateralanditerativeexchangeofaccesspoliciesandevidenceconductedtoestablishmutualtrustbetweentwoparties.Forexample,astudentthatwishestoaccessaresourcecon-nectedtoacomputinggridmightbereturnedapolicystat-ingthatonlyfull-timestudentsataccrediteduniversitiescanaccessthatresource.Priortoprovingherenrollmentsta-tustotheresourceoperator,thestudentmightﬁrstrequirethattheresourceoperatorprovethatitisoperatedbyeitheranNSF-sponsoredorganizationoranorganizationthatisamemberoftheBetterBusinessBureau.Digitalcredentials,suchasX.509certiﬁcates,arethemostcommonformofev-idenceusedbytheseprotocols,althoughuncertiﬁedclaims(asin[5,9]),prooffragments(asin[1,26]),ortrusttickets(asin[5])couldalsobeexchanged.Intheremainderofthispaper,wewilldeﬁneEasthesetofallsuchevidenceandPasthesetofallpolicies.Formally,acompliancecheckerisdeﬁnedasafunctioncc:2E×P→Rthattakessomesetofevidenceandapol-icyanddetermineswhether(andpossiblyhow)thispolicyissatisﬁedbythespeciﬁedsetofevidence.Theexactdeﬁ-nitionofsatisfactionisspeciﬁctothepolicylanguagebeingused.Forexample,inanylanguagewithamodeltheory,wesaythatasetEofevidencesatisﬁesapolicypifineverymodelwhereEistrue,pisalsotrue.InClouseau,apolicyisspeciﬁedasoneormorepatternsplacingconstraintsonthecredentialsandotherevidencethatmustbepresentedtogainaccesstoaparticularresource.Wesaythatsuchapolicyissatisﬁedifatleastoneofthesepatternscanbematchedbythesetofobjectsdescribingthecredentialsandotherevidencepossessedbyagivenentity.AswewillseeinSection5,provingthecorrectnessofourRTtoClouseaupolicycompilationprocessinvolvesprovinganequivalencebetweenthesetwoconceptsofsatisfaction.Thatis,wemustshowthatanClouseaupattern-matchoccursifandonlyiftheRTrulesofinferencedrawthesameconclusion.Whenacompliancecheckerisinvokedtocheckthesatis-factionofsomepolicyprotectingalocalresourcer,itwillbegivenasetofevidenceprovidedbytheremoteentitywishingtoaccessr.Inthiscase,thecompliancecheckerneedonlyreturnaBooleanvalueindicatingwhetherthepolicywassatisﬁed(i.e.,R≡B).However,iflocalcredentialsareusedinanattempttosatisfyaremotepolicyp,thenR≡22E.Thatis,thecompliancecheckermustreturnzeroormoresetsoflocalevidencethatminimallysatisfypsothatthelocalentityknowswhichlocalevidencecanbesenttotheremoteentitytogainaccesstotheresourceprotectedbyp.WesaythatsomesetEofevidenceminimallysatisﬁesapolicypifnopropersubsetofEalsosatisﬁesp.Acompli-ancecheckercapableofrecognizingallpossiblesubsetsofthelocalevidencethatminimallysatisfyagivenpolicyisrequiredtoensurethatatrustnegotiationprotocolwilles-tablishtrustwheneverpossibleandcanalsoaﬀorditsuseranumberofstrategicadvantages.Therefore,ourfocusinthispaperistoeﬃcientlysolvethefollowingspeciﬁcinstanceofthemoregeneralpolicycompliancecheckingproblem:TheType-3ComplianceCheckerProblem.GivenasetE∈Eofevidenceandapolicyp∈P,ﬁndalldistinctsubsetssetse1,...,enofEthatminimallysatisfyp.4.DESIGNOFCLOUSEAUInthissectionwediscussthedesignoftheClouseaucompliancechecker,whichwehavedesignedtoeﬃcientlysolvethetype-3compliancecheckerproblem.Webeginbyshowingthatthisproblemnaturallytranslatesintoaninstanceofthemanypattern/manyobjectpatternmatchproblem.ThisisfollowedbyadiscussionofthetechnicaldetailsofourimplementationoftheClouseaucompliancechecker,includinganoverviewoftheRetealgorithm,whichisusedbyClouseau.Lastly,weconcludethissectionwithanoverviewofClouseau’sinternalrepresentationoftrustnegotiationevidenceandpolicies.4.1DesignApproachTodate,mostpolicylanguagesfortrustnegotiationaremodeledusinglogicprogrammingapproaches,astheformalsemanticsoflogicprogramsarewellunderstood.Forexam-ple,policiesinCassandra[3],PSPL[9],thelanguageusedbyKoshutanskiandMassacci[16],RT[19],andPeerAccess[26]areallspeciﬁedinthismanner.EvensomeXML-basedlanguages,suchasTPL,areformallymodeledusinglogicprogrammingapproaches[15].Notsurprisingly,thepol-icycompliancecheckingapproachesusedforthesetypesoflanguageshaveleveragedtraditionaltheorem-provingtech-niques.WhenthecompliancecheckerisinvokedonapolicypwithasetEofevidence,theunderlyingtheoremproverstoresthesetofevidencee⊆Eusedduringtheconstructionofasingleproofthatpwassatisﬁed.Ratherthansimplyre-turningtheBooleanvaluetrue,theseteisalsoreturnedbythecompliancecheckertoprovidesupportforitsdecision.Althoughthistypeoftheorem-provingapproachtothegeneralcompliancecheckerproblemisnaturalgiventhelog-icalfoundationsoftrustmanagement,itisnottheonlywayinwhichthisproblemcanbeformulated.Infact,usingthistypeofapproachtosolvethetype-3compliancecheckerproblemisunappealing,astheoremproversingeneralaredesignedtoﬁndasingleproofthatafactisvalid(i.e.,thatapolicyissatisﬁed)andsearchforalternateproofsonlywhenagivenproofattemptfails.Asanalternateapproach,wehaverecognizedthatthethetype-3compliancecheckerproblemisactuallyaninstanceofthemoregeneralmanypattern/manyobjectpatternmatchingproblem[13]:TheManyPattern/ManyObjectPatternMatch-ingProblem.GivenasetofpatternsPandasetofobjectsO,determineallsubsetsofOthatcanbeusedtomatchanypatternp∈P.Clearly,ifcredentialsandotherevidencearetreatedasob-jectsandpolicyclausesaretreatedaspatterns,aneﬃcientsolutiontothisproblemcouldlikelyleadtoaneﬃcientsolu-tiontothetype-3compliancecheckerproblem.Thisprob-lemhasbeenstudiedpreviouslybytheartiﬁcialintelligencecommunity,asitiscentraltothedesignofeﬃcientproduc-tionsysteminterpreters.Asaresult,eﬃcientalgorithms,suchasRete[13]andTREAT[20],havebeendevelopedtosolvethisproblem.TheRetealgorithmisoptimizedforin-stancesofthemanypattern/manyobjectpatternmatchingprobleminwhich(i)patternsarecompilable,(ii)allob-jectsremainconstantonceinsertedintotheReteengine’sworkingmemory,and(iii)thesetofobjectschangesrela-tivelyslowly[13].Notethattrustnegotiationpoliciesareallcompilable,astheyaredesignedtoenableautomatedreasoning,ratherthanhumaninterpretation.Further,cre-dentialsandotherevidenceremainconstantonceobtained.Forexample,modifyingortamperingwithadigitalcertiﬁ-cateinvalidatesitsattachedissuersignature.Lastly,thesetoflocalevidencechangesveryinfrequentlyandthesetofremoteevidencegrowsmonotonicallyastheprotocolpro-ceeds.WethereforeusetheRetealgorithmasthebasisfortheClouseaucompliancechecker.4.2TheReteAlgorithmWenowprovideanoverviewoftheRetealgorithmandhighlightitsbeneﬁtsinsolvingthetype-3compliancecheckerproblem.SpacelimitationspreventafulldiscussionofthespeciﬁcsoftheRetealgorithm;interestedreadersshouldconsult[13]formoreinformation.Atahighlevel,theRetealgorithmworksbyforminganetworkofnodesthatrep-resentoneormorematchingtestsfoundinthespeciﬁedpatterns.Patternnodes,whicharealsoknownasone-inputnodes,areusedtomatchsingleobjectsstoredinthework-ingmemoryoftheReteengine.InthecaseofClouseau,theseobjectsrepresentconstraintsonindividualpiecesoftrustnegotiationevidence(e.g.,digitalcertiﬁcatesandun-certiﬁedclaims).Theoutputsofthesepatternnodescanthenbefedintooneormorejoinnodes,whichareusedtobuildmorecomplexpatternsconsistingofconjunctionsofbasicpatternsandconstraintsexistingbetweentheobjectsmatchedbythesepatterns.Inourformulationofthetype-3?c?a?b?d?e^^^^pPattern nodesJoin nodesTerminal nodeFigure2:AnexampleRetenetwork.compliancecheckerproblem,joinnodesareusedtospecifyconjunctionsofbasiccredentialsaswellasinter-credentialconstraints(i.e.,chainsoftrustorcredentialdelegations).Acollectionofpatternnodesandjoinnodesformsadi-rectedacyclicgraphwhosesinknodesarecalledterminalnodes.AsmatchesoccurintheRetenetwork,informationdescribingthematchispropagatedalongtheedgesofthegraph.Whenaterminalnodeisreached,aneventistrig-geredthatsigniﬁesthatacompletematchhasoccurred.InClouseau,thisimpliesthatagivenpolicyhasbeensatis-ﬁedandenablesthecompliancecheckertoextractthesetofevidencethatledtothisparticularpolicysatisfaction.SinceinformationispropagatedalongallpossibleedgesintheRetenetwork,allsatisfyingsetsarefoundbytheRetealgorithm.Figure2isanillustrationofaRetenetworkforthepolicyp←a∧b∧(c∨(d∧e)),whichisrepresentedinternallyasthepairofHornclausesp←a,b,candp←a,b,d,e.Squareboxesrepresentpatternnodes,thetrapezoidsarejoinnodes,andtheovalnodeisaterminalnodethatrepresentsthesatisfactionofthepolicyp.Notethatdistinctpatternsarematchedatmostonce,despiteappearinginmultipleHornclauses.Further,joinnodescanbesharedbetweenmultipleclausesofthepolicy.AnotherbeneﬁtoftheReteapproachisthatthenetworkmaintainsstatebetweeninvocations,whichgreatlymini-mizesthenumberoftimesthattheworkingmemoryisiter-atedoverasmultiplepoliciesarematched.Thatis,eachob-jectintheReteengine’sworkingmemoryismatchedagainsteachpatternnodeatmostonetimeandtheresultsofthismatchingoperationaresaved.Forinstance,ifthepolicyp!←a∧b∧(c∨f)isaddedtotheworkingmemoryoftheReteengineinFigure2,theReteengineneedsonlytocheckfortheexistenceofcredentialf,asanymatchesfora∧banda∧b∧cwerefoundandmemoizedduringtheanalysisofthepolicyp.ThesetypesofoptimizationsfurtherhelpmaketheRetealgorithmaneﬃcientapproachtosolvingthetype-3compliancecheckerproblem.4.3ImplementationWenowdescribeourimplementationofClouseau,afully-functionalcompliancecheckerthatleveragestheRetealgorithmtoeﬃcientlysolvethetype-3compliancecheckerproblem.OurgoalindesigningClouseauwasnottopro-poseanewtrustnegotiationpolicylanguage,butrathertoexplorethedesignofeﬃcientsolutionstothetype-3com-pliancecheckerproblem.Therefore,ratherthandesigningClouseautocheckthesatisfactionofpoliciesspeciﬁedinoneparticularpolicylanguage(e.g.,Cassandra,RT,TPL,orX-TNL),weinsteadfocusondesigningamoregeneral-purposecompliancechecker.Ultimately,theaccesscontrolpoliciesusedbytrustnegotiationsystemsaresatisﬁedbydigitalcertiﬁcatesorothersuchevidencepresentedbypar-ticipantsinthenegotiationprocess.Tothisend,thepolicypatternsusedtoconstructtheRetenetworkanalyzedbyClouseauspecifyconstraintsontheactualevidence(e.g.,certiﬁcates,certiﬁcatechains,andclaims)necessarytogainaccesstoaparticularresource.Thisisincontrasttohigher-levelpolicylanguages,suchasRT,whichhavesyntacticconstructstorepresentconceptssuchasdelegationnatively.InSection5,wediscussaprocessthroughwhichRTpoliciescanbeautomaticallycompiledintothenativeruleformatusedbyClouseauforanalysis.Sincealltrustnegotiationpoliciesareeventuallysatisﬁedbythesametypesofev-idence,webelievethatequivalentcompilationprocedurescouldbederivedforotherhigher-levelpolicylanguagesaswell.OurimplementationofClouseauwasdevelopedusingtheJavaprogramminglanguageandrunswithintheTrust-Builder2frameworkfortrustnegotiation.1Atahighlevel,ClouseautakesasetEofevidenceandanaccesscontrolpolicypandusesanimplementationoftheRetealgorithmprovidedbytheJessexpertsystem[14]todetermineallofthewaysinwhichsubsetsofEcansatisfyp.TherunningtimeofthisReteimplementationscales,onaverage,lin-earlywiththesizeofitsworkingmemory[14].ThisimpliesthatClouseau’srunningtimescalesasO(NA),whereNisthenumberofsatisfyingsetsforapolicyandAistheaveragesizeofeachsatisfyingset;weconﬁrmthisresultexperimentallyinSection6.OurimplementationconsistsofaJessspeciﬁcationdeﬁningtheinternalrepresentationsofevidenceandseveralusefulfunctionsforreasoningaboutcredentialchains,andalargerJavacodebaseresponsibleforexaminingvarioustypesofevidence,translatingevidenceintoobjectsthatcanbeinstantiatedwithinClouseau,andcreatingandqueryingtheRetenetworkusedbyClouseau.WenowdiscusstheinternalrepresentationofevidenceusedbyClouseauaswellasthespeciﬁcationofaccesscontrolpolicies.EvidenceRepresentationBecauseJessprovidesageneral-purposeimplementationoftheRetealgorithm,ithasnowayofrepresentingorreason-ingabouttrustnegotiationevidencenatively.WethereforehadtodeﬁneseveralobjecttemplatesthatrepresentkeytypesofevidenceinsideoftheReteengine’sworkingmem-ory.ThecurrentimplementationofClouseausupportstheuseofdigitalcertiﬁcates,certiﬁcatechains,anduncertiﬁedclaimsasformsofevidence;addingsupportforothertypesofevidence,suchasTrust-Xtrusttickets,wouldbearela-tivelystraightforwardprocess.ClouseaumakesuseofTrustBuilder2’sextensiblecre-dentialtypehierarchy,whichallowsuserstoaddsupportfornewcredentialtypestoTrustBuilder2—andbyextensionClouseau—withoutmodifyingtheunderlyingcodebase.Trustnegotiationimplementationsareresponsibleforvali-datinganyproof-of-ownershipchallengesassociatedwithagivencredentialandforformingandverifyingthecredentialchainspassedintoClouseau.Onceacollectionofcreden-1ForfurtherinformationregardingTrustBuilder2ortodownloadtheframework,whichincludesClouseau,pleaseseehttp://dais.cs.uiuc.edu/tn.;;Usedtodescribedigitalcertificatesand;;othercredentials(deftemplatecredential(slotid)(slotissuer)(slotsubject)(slotfingerprint)(slotowned(defaultFALSE))(slotmap(default(newjava.util.HashMap))));;Containsanorderedlistofcredentialsmaking;;upacredentialchain(deftemplatecredential-chain(multislotcredentials));;Claimsarestoredasattribute/valuepairs(deftemplateclaim(slotid)(slottype)(slotvalue))Figure3:InternalevidencerepresentationsusedbyClouseau.tialchainshasbeenpassedintoClouseau,theyaretrans-latedintoinstancesofthecredentialandcredential-chainobjecttypesdescribedinFigure3.Uncertiﬁedclaimspro-videdasevidencetoClouseauarerepresentedinternallyasinstancesoftheclaimobjecttype.Objectsoftypecredentialaregeneratedbyextract-inginformationfromagivencryptographiccredentialus-ingmethodsoftheabstractcredentialclassatthetopofTrustBuilder2’scredentialtypehierarchy.Eachcredentialstructureisassignedauniqueidentiﬁerandcontainsﬁeldsdescribingthecredential’ssubjectandissuer,acryptographicﬁngerprintofthecredential,aBooleanvalueindicatingwhetherproof-of-ownershipofthecredentialwasveriﬁed,andamapcontainingkey/valuepairsdescribingattributes(e.g.,jobfunction,hiredate,etc.)orotherinformation(e.g.,expirydate)embeddedinthecredential.Internally,credentialchainsarerepresentedasorderedlistsofuniqueidentiﬁerssatisfyingtwoinvariants:(i)thecredentialref-erencedbytheidentiﬁeratindex0inthelististherootofthecredentialchainand(ii)thecredentialreferencedbytheidentiﬁeratindexi>0wasissuedbytheownerofthecredentialatindexi−1.Uncertiﬁedclaimsarerepresentedasattribute/valuepairsassociatedwithauniqueidentiﬁerﬁeld.PolicySpeciﬁcationInClouseau,accesscontrolpoliciesarespeciﬁedascollec-tionsofJessrulesthatplaceconstraintsonthecredentials,credentialchains,anduncertiﬁedclaimsthatmustbepre-sentedtogainaccesstoaparticularresource.Intheremain-derofthissection,weprovideanoverviewoftheClouseaupolicysyntaxbydiscussinganexampleaccesscontrolpolicy.WenotethatonlyaverysmallsubsetoftheJesslanguageisneededtospecifyClouseaupolicies.Inparticular,weuseonlythelanguageconstructsdiscussedinthissection.Figure4isanexampleaccesscontrolpolicydesignedtoallowgraduatestudentsatuniversitiesaccreditedbytheAc-creditationBoardforEngineeringandTechnology(ABET)toaccesssomeresource“server,”providedthattheydiscloseanemailaddressthatcanbeusedforfuturecorrespondence.Becauseoftherelativelysimplenatureofthispolicy,itcan;;ThispolicyissatisfiedbygraduatestudentsatABET-;;accrediteduniversitieswhoprovideanemailaddress;;thatcanbeusedforfuturecorrespondence.(defrulerule-grad-student;;Findacertificatechainleadingfromauniversity;;toagraduatestudent(credential(id?iuniv)(subject?suniv))(credential(id?istud)(ownedtrue)(map?mstud))(test(eq"GraduateStudent"(?mstudget"Type")))(credential-chain(credentials$?cstud))(test(is-root?iuniv?cstud))(test(is-leaf?istud?cstud));;FindacertificatechainleadingfromABETto;;theuniversityfoundabove.(credential(id?iabet)(fingerprint"38:1A:42:E9:00:7D:19:41:AC:66:F2:EF:12:E6:B4:A1"))(credential(id?icert)(map?mcert)(subject?scert&:(eq?scert?suniv)))(test(eq"AccreditedUniversity"(?mcertget"Type")))(credential-chain(credentials$?ccert)(test(is-root?iabet?ccert))(test(is-nth?icert2?ccert));;Seeifthestudentprovidedanemailaddress(claim(id?iemail)(type"Email")(value?v))=>(assert(satisfaction(resource-nameserver)(credentials?cstud?ccert)(claims?iemail))))Figure4:AnexampleClouseaupolicy.bespeciﬁedusingasingleJessrule.Rulesconsistoftwoparts:alefthandside(LHS)specifyingpatternsthatmustbematchedbyobjectsintheworkingmemoryoftheReteengineandarighthandside(RHS)thatspeciﬁessomeac-tiontobetakenifthepatternintheLHSoftheruleiscompletelymatched.Thesetwopartsofarulearesepa-ratedbythe=>token.TheLHSoftheruleinFigure4consistsofthreegroupsofpatternsthatmustbematchedbyobjectsrepresentingpiecesoftrustnegotiationevidenceintheworkingmem-oryoftheReteengine.Theﬁrstgroupdetermineswhetherthereexistsacertiﬁcatechainwhoseleafnodeisacertiﬁcateoftype“GraduateStudent.”Theﬁrstlineofthisgroupisapatternthatmatchesanycredentialandsavesthevaluesofitsuniqueidentiﬁerandsubjectstringinthevariables?iunivand?suniv,respectively.Thesecondlineinthisgroupingisasimilarpatternthatmatchesanycredentialwhoseownershipwasprovenduringthetrustnegotiationprotocol.Thethirdlineinthisgroupingenforcesthecon-straintthatthesecondcredentialmatchedhasa“Type”ﬁeldwhosevalueis“GraduateStudent.”Thelastthreelinesoftheﬁrstgroupingrequirethatthetwomatchedcredentialsmustexistinacredentialchainwhoseauthenticitywasver-iﬁedbythetrustnegotiationimplementation.Notethatagivenpatternneednotconstrainallﬁeldsofthecredentialobjecttype.Thesecondgroupofpatternsissimilartotheﬁrst,inthatitalsoestablishestheexistenceofanothercredentialchain.Theﬁrsttwolinesofthisofthisgroupformapatternthatmatchesonlythecertiﬁcatewhosecryptographicﬁngerprintisrepresentedbythehexadecimalstring38:1A:42:E9:00:7D:19:41:AC:66:F2:EF:12:E6:B4:A1,whichistheﬁnger-printofthe(ﬁctitious)certiﬁcateusedbyABETtoissueuniversityaccreditations.Thethird,fourth,andﬁfthlinesofthisgroupformapatternthatmatchesanycredentialthathasasubjectﬁeldthatisthesameasthatoftherootoftheﬁrstcredentialchain(i.e.,theuniversity),andhasa“Type”ﬁeldwhosevalueis“AccreditedUniversity.”ThelasttwolinesofthispatternplacetheconstraintthattheABETcredentialmustformtherootofacredentialchainoflengthtwothatendswiththeuniversity’saccreditationcer-tiﬁcate.Thelastgroupofconstraintsconsistsofasinglelinespecifyingthattheuserneedstoalsodiscloseanuncertiﬁedclaimoftype“Email”containinghisorheremailaddress,whichwillpresumablybestoredforfuturecorrespondence.Ingeneral,theRHSofanClouseaupolicycaneitherassertanintermediateresultthatcanbeusedasinputtootherrules,orassertasatisfactionobjectdescribingonewayinwhichaparticularpolicywassatisﬁed.Theformeractionmightbetakenifacomplicatedpolicyhasseveralpathstosatisfactionthateachrequireacommonpreﬁxtobematched;wewillseeexamplesofthisinSection5.2.ThepolicyinFigure4takesthelatteractionandassertsasatisfactionobjectcontainingthesetofcredentialsandthesingleclaimusedtosatisfythepolicy.Wenotethatdespiteasimplepolicyspeciﬁcationsyntax,Clouseaupoliciescanquicklybecomelargeanddiﬃculttounderstandduetothenumberofconstraintsthatmightexistbetweenelementsofacredentialchainorﬁeldsofcre-dentialsindiﬀerentchains.However,wedonotviewthisasalimitationofClouseau.WedonotexpectthatusersofClouseauwillchoosetospecifypoliciesusingthissubsetofJess.Rather,weviewthenativepolicyrepresentationusedbyClouseauasbeingakintoassemblylanguageinthatitprovidesarepresentationofapotentially-complexexpres-sionthatcanbeeﬃcientlyanalyzed.Weexpectthatuserswillspecifypoliciesinhigher-leveltrustnegotiationpolicylanguagesandthatthesepolicieswillbeautomaticallycom-piledintoClouseau’snativelanguage,muchasprogramswritteninhigh-levelprogramminglanguagesarecompiledintoassemblycodepriortoexecution.5.ANALYZINGRTPOLICIESInthissection,wediscussamethodforautomaticallycompilingRTpoliciesintoaformatsuitableforanalysisbyClouseau.Foreaseofexposition,webeginbydiscussingacompilationprocessforRT0policies,whichsupporttheuseofunparameterizedroles,andprovethecorrectnessandcompletenessofthisprocess.WethenprovideanintuitionforhowthisprocesscanbeextendedtosupportRT1poli-ciesallowingtheuseofparameterizedroles.TheabilitytocorrectlyanalyzethesetypesofpoliciesisanecessarysteptowardsestablishingClouseauasageneral-purposesolutiontothetype-3compliancecheckerproblem.Sincealltrustnegotiationpoliciesareeventuallysatisﬁedbythesametypesofevidence,weconjecturethatequivalentcom-pilationprocedurescouldbedevisedforotherhigher-levelpolicylanguagesaswell.5.1RT0PolicySyntaxRecallfrom[19]thatRT0isthemostbasiclanguageintheRTfamilyoftrustmanagementlanguages.AsinalloftheRTlanguages,principalsareidentiﬁedbymeansofidentitycertiﬁcates.RT0rolesaredeﬁnedsimplyasstringsidentifyingthenameoftheroleandcannotbeparameter-ized.PolicystatementsinRT0areexpressedasoneormoreoftheseroledeﬁnitionsandareencodedasroledeﬁnitioncredentialssignedbytheauthoroftheroledeﬁnition.TherearefourbasictypesofroledeﬁnitioncredentialsinRT0:SimpleMemberAroledeﬁnitionoftheformKA.R←KDencodesthefactthatprincipalKAconsidersprin-cipalKDtobeamemberoftheroleKA.R.SimpleContainmentAroledeﬁnitionoftheformKA.R←KB.R1encodesthefactthatprincipalKAdeﬁnestheroleKA.RtocontainallmembersoftheroleKB.R1,whichisdeﬁnedbyprincipalKB.LinkingContainmentAroledeﬁnitionoftheformKA.R←KA.R1.R2iscalledalinkedrole.Thisdeﬁnesthemem-bersofKA.RtocontainallmembersofKB.R2foreachKBthatisamemberofKA.R1.IntersectionContainmentTheroledeﬁnitionKA.R←KB1.R1∩···∩KBn.RndeﬁnesKA.RtocontaintheprincipalswhoaremembersofeachroleKBi.Riwhere1≤i≤n.Thesefourbasictypesofroledeﬁnitionscanbeusedtodeﬁneawiderangeofaccesscontrolpolicies.Forexample,thefollowingRT0roledeﬁnitionsexpressanaccesscontrolpolicyrequiringthatentitiesaccessingagivenresourcebeemployeesofaSuperGridmemberorganization:Provider.service←Provider.partner.employeeProvider.partner←SuperGrid.memberOrganizationIfaprincipal,Alice,couldprovidecredentialsprovingthestatementsSuperGrid.memberOrganization←AliceLabsandAliceLabs.employee←Alice,shecouldsatisfythepolicyformedbytheabovetworoledeﬁnitionsandgainaccesstotheprotectedservice.5.2CompilingRT0PoliciesInRT0,policiesarecollectionsofroledeﬁnitioncreden-tials.Therefore,wemustpreprocessthesetofcredentialsprovidedtoClouseauasinputinordertogeneratethesetofpolicyrulesthatClouseauwillattempttosatisfy.SinceClouseauexaminestheactualcredentialsusedtoholdRT0assertions,ratherthanthesehigher-levelRT0assertions,wemustmakeafewassumptionsregardingtheformatofthesecredentials.1.Weassumethatprincipalsinthesystemareidentiﬁedbytheﬁngerprintoftheiridentitycertiﬁcates.Textstringssuchas“ABET.accredited”willbeusedduringthediscussionofabstractpolicies,althoughsuchas-sertionsareactuallyshorthandforstatementssuchas“38:1A:42:E9:00:7D:19:41:AC:66:F2:EF:12:E6:B4:A1.accredited.”WhendeﬁningClouseaupolicieslaterinthissection,wewillusethenotationtodenotetheﬁngerprintofKA’sidentitycertiﬁcate.2.SimplemembershiproledeﬁnitioncredentialsofformKA.R←KBareassumedtohavetheattributes“roleMgr,”“role,”and“roleSubj”settothevalues,R,and,respectively.3.Roledeﬁnitioncredentialsarevalidifandonlyiftheyaresignedbytheprincipalidentiﬁedattheheadofthecredential.Forexample,thesimplemembershipcredentialKA.R←KBisconsideredvalidifandonlyifitissignedbytheprincipalKA.;;Templatetostorerolemembershipinformation(deftemplateis-member(slotrole)(slotroleMgr)(slotroleSubj)(multislotcredentials));;Codetodetectrolemembershipsviathepresenceofsimple;;membershippolicycredentials.I.e.,thiscanprovethat;;K_A.R(assert(is-member(role(?mget"role"))(roleMgr(?mget"roleMgr"))(roleSubj(?mget"roleSubj"))(credentials?ka?kb?r))))Figure5:BasepolicyenablingClouseautodeter-minerolemembershipviatheuseofsimplemem-bershipcredentials.Giventheaboveassumptionsregardingcredentialformat,wenowdescribeanalgorithmforgeneratingaClouseaupolicyp!thatisequivalenttoanRT0policypconsistingofthevalidroledeﬁnitioncredentialsr1,...,rnandthesetofidentitycertiﬁcatesc1,...,cm.1.Inserttheis-membertemplatetypeandthemember-ofruledeﬁnedinFigure5intop!.Theis-memberobjecttypeholdsinformationregardingaparticularprinci-pal’smembershipinaparticularrole.Themember-ofruleassertsanis-memberobjectifasimplemember-shiproledeﬁnitioncredentialofformKA.R←KBcanbefound,alongwithidentitycertiﬁcatesforKAandKB.2.Generatethecredentialobjectscorrespondingtotheidentitycertiﬁcatesc1,...cmandinserttheseintotheworkingmemoryofClouseau.3.Foreachvalidroledeﬁnitioncredentialri:•GeneratethecredentialobjectcorrespondingtoriandinsertitintotheworkingmemoryofClouseau.Savethe“id”ﬁeldofthisobjectasthevariable.•IfriisasimplecontainmentcredentialofformKA.R←KB.R1theninsertthefollowingruleintop!:(defrulerule-sc-(is-member(role"R_1")(roleMgr)(roleSubj?rs)(credentials$?c))=>(assert(is-member(role"R")(roleMgr)(roleSubj?rs)(credentials?c)))ThisruleassertsthataprincipalisamemberofroleKA.RifheisalsoamemberofKB.R1.•IfriisalinkingcontainmentcredentialofformKA.R←KA.R1.R2theninsertthefollowingruleintop!:(defrulerule-lc-;;FindamemberofR_2(is-member(role"R_2")(roleMgr?r2mgr)(roleSubj?r2subj)(credentials$?cr2));;findamemberofK_A.R_1(is-member(role"R_1")(roleMgr)(roleSubj?r1subj)(credentials$?cr1))(test(eq?r1subj?r2mgr))=>(assert(is-member(role"R")(roleMgr)(roleSubj?r2subj)(credentials?cr1?cr2)))ThisruleassertsthataprincipalisamemberoftheroleKA.RifheisamemberoftheroleR2deﬁnedbysomememberofKA.R1.•IfriisanintersectioncontainmentcredentialofformKA.R←KB1.R1∩···∩KBk.Rktheninsertthefollowingruleintop!:(defrulerule-ic-(is-member(role"R_1")(roleMgr)(roleSubj?rs1)(credentials$?cr1))...(is-member(role"R_k")(roleMgr)(roleSubj?rsk&:(eq?rs1?rsk))(credentials$?crk))=>(assert(is-member(role"R")(roleMgr)(roleSubj?rs1)(credentials?cr1...?crk)))ThisruleassertsthataprincipalisamemberoftheroleKA.RifrolemembershipsforeachoftherolesKB1.R1,...,KBk.Rkcanbefound.Notethatthisruleenforcestheconstraintthattheserolemembershipmustallrefertothesamesub-jectprincipal.4.Giventhetargetroleforthenegotiation,sayKA.Rt,insertthefollowingruleintop!:(defruletarget(is-member(role"R_t")(roleMgr)(roleSubj?rs)(credentials$?c))(credential(fingerprint?fp&:(eq?fp?rs))(ownedTRUE))=>(assert(satisfaction(resource-name"target")(credentials?c))))Thisruletriggerstheinsertionofapolicysatisfac-tionobjectwheneveranidentitycertiﬁcatewithvalidproof-of-ownershipcanbefoundforamemberofthetargetroleKA.Rt.Intuitively,thiscompilationprocessworksinabottom-upfashion,asfollows.Themember-ofruleenablesClouseautoconcludethataprincipalKBisamemberoftheroleKA.RifitﬁndsKB’sidentitycertiﬁcate,KA’sidentitycer-tiﬁcate,andthesimplemembershiproledeﬁnitioncertiﬁcatedeclaringKBtobeamemberofKA.R.Thesethreecreden-tialsareretainedasevidencesupportingKB’smembershipinKA.R.Therulesinsertedduringstep3ofthecompilationprocesscanthencombinethesebasicrolemembershipasser-tionstoprovemembershipinrolesdeﬁnedbymorecomplexexpressions(i.e.,simplecontainment,linkingcontainment,andintersectioncontainment).Asrolemembershipassertionsarecombinedbytheserules,thecredentialidentiﬁersstoredintheserolemembershipassertionsarecombinedandstoredinthenewly-concludedrolemembershipassertions.Finally,thetargetrulein-sertedintop!atstep4ofthecompilationprocessassertsasatisfactionobjectwhenevermembershipinthetargetroleofthenegotiationprocesscanbefoundforaprinci-palwhocoulddemonstrateproof-of-ownershipofhisorheridentitycertiﬁcate.ThisallowsClouseautoconcludethatthepolicyinquestionhasbeensatisﬁedandtoextractthecredentialsusedduringthesatisfactionprocess.TheRetealgorithmensuresthatallpathsleadingtothecreationofasatisfactionobjectareexploredduringthepatternmatch-ingprocess,whichimpliesthatallsatisfyingsetsofevidencearediscoveredbytheClouseaucompliancechecker.Fur-ther,alinearincreaseinthesizeoftheRTpolicytobeanalyzedcausesonlyalinearincreaseintherunningtimeofClouseau.ThisisaresultofthefactthatthesizeofClouseau’sworkingmemoryisincreasedlinearlyforeachcredentialanalyzedduringthepolicycompilationprocess(i.e.,weaddatmostoneruletoClouseauforeachcreden-tialprocessed).Figure6illustratestheresultofapplyingtheabovecom-pilationprocesstotheRT0accesspolicydescribedinSec-tion5.1.Forbrevity,theis-membertemplateandthemember-ofruleinFigure5wereomittedfromthisﬁgure,althoughtheywouldbeincludedinthegeneratedpolicy.Wenowmakethefollowingclaimregardingthecorrectnessandcompletenessofthispolicycompilationprocess.Afullproofofthistheoremcanbefoundinthetechnicalreportversionofthispaper[17].Theorem1(CorrectnessandCompleteness).LetR={r1,...,rn}beasetofroledeﬁnitioncredentials,C={c1,...,cm}beasetofidentitycertiﬁcates,p=R∪CbeanRT0policy,andletp!betheresultofcompilingpusingtheaboveprocess.ClouseauﬁndsthesatisfyingsetS⊆(R∪C)ofcredentialsforthepolicyp!ifandonlyiftheRTrulesofinferencecanbeusedonexactlythesetSofcredentialstoprovemembershipinthetargetrole.5.3SupportingRT1PoliciesTheonlyfeaturethatRT1addstoRT0istheabilitytoparameterizeroledeﬁnitions.Forexample,ratherthanre-quiringAlice’semployeecredentialtobeoftheformAliceLabs.employee←Alice,itcouldinsteadencodeotherattributesregardingAlice’semployment.Forexample,wecoulddeﬁneAliceasthePresidentofAliceLabsbydeﬁningthefollowingsimplemembershipcredential:AliceLabs.employee(title=“President”)←AliceRT1roledeﬁnitioncredentialscanalsoconstrainrolemem-bershipsbasedonthevaluesofroleparameters.Forex-ample,thefollowingsimplecontainmentcredentialdeclaresthatonlywidgetswhosepriceisover$10areonsale:Acme.sale←Acme.widget(price>10)AddingsupportfortheabovetypesofparameterizationsandconstraintstothepolicycompilationprocessdescribedinSection5.2isarelativelystraightforwardprocess.Infact,wemustonly(i)providesupportforstoringparam-etersandtheirvaluesinsimplemembershiproledeﬁnitioncredentialsand(ii)allowthevariouscontainmentroledeﬁni-tionrulesgeneratedduringthepolicycompilationprocesstoplaceconstraintsontheseparametervalues.Toaddress(i),;;Provider.service)(roleSubj?r1subj)(credentials$?cr1))(test(eq?r1subj?r2mgr))=>(assert(is-member(role"service")(roleMgr)(roleSubj?r2subj)(credentials?cr1?cr2)));;Provider.partner)(roleSubj?rs)(credentials$?c))=>(assert(is-member(role"partner")(roleMgr)(roleSubj?rs)(credentials?c)));;Provider.serviceisourtargetrole(defruletarget(is-member(role"service")(roleMgr)(roleSubj?rs)(credentials$?c))(credential(fingerprint?fp&:(eq?fp?rs))(ownedTRUE))=>(assert(satisfaction(resource-name"target")(credentials?c))))Figure6:AcompiledversionoftheRT0policydis-cussedinSection5.1.wecanstoretheparametersofagivensimplemembershipcredentialandtheircorrespondingvaluesinthe“map”ﬁeldofthesimplemembership’sClouseaucredentialobject.Further,theis-memberobjecttemplatemustbeextendedtoincludethismappingofparameternamestovalues.Addressingpoint(ii)isaslightlymorecomplicatedpro-cessinvolvingthegenerationofClouseaurulesduringstep3ofthecompilationprocess.Ratherthanexplaineachcaseindetail,wewillinsteadprovideoneexamplecompilationruleandclaimthattheothercasescanbehandledinasim-ilarfashion.Asanexample,considerthefollowingsimplecontainmentroledeﬁnitioncredential:AliceLabs.seniorManagement←AliceLabs.employee(hireYr(is-member(role"employee")(roleMgr)(map?m)(roleSubj?rs)(credentials$?c))(test(eqTRUE(?mget"mgt")))(test(>2000(?mget"hireYr")))=>(assert(is-member(role"seniorManagement")(roleSubj?rs)(roleMgr)(credentials?c)))CreatingthisruleautomaticallyinvolvesanextensiontotherulegenerationlogicpresentedinSection5.2thataddsonetestclausetotheruleforeveryconstraintplacedonanattributevaluebytheRT1roledeﬁnitioncredential.SincetheReteengineusedbyClouseausupportscomparisonoperatorssuchas>,<,and=,itcansupportthetypesof 20 30 40 50 60 70 80 0 5 10 15 20 25 30 35 40 45 50Average time (ms)Size of the union of all satisfying sets (U)One satisfying setU satisfying setsTwo satisfying setsFigure7:Runningtimeasafunctionofthesizeoftheunionofallsatisfyingsets.constraintsallowedbyRT1.Assuch,itispossibletodeﬁneanautomatedprocedureforcompilingRT1policiesintoaformatsuitableforanalysisbyClouseau.6.EVALUATIONInthissection,weevaluatetheperformanceoftheClouseaucompliancecheckerandthendiscusstheimplica-tionsofourﬁndings.Inparticular,weexaminetheamountoftimerequiredtoﬁndallsatisfyingsetsofevidenceforagivenpolicyinthreesetsofexperiments;eachsetofexper-imentswasconductedona2.5GHzPentium4with512MBRAMrunningLinux.TherunningtimesreportedincludealloverheadsassociatedwithgeneratingaRetenetworkbasedonthepolicyrulesprovidedtoClouseau,creatingcredentialandcredential-chainobjectscorrespondingtothecredentialsandcredentialchainsprovidedtoClouseau,insertingtheseobjectsintoClouseau’sworkingmemory,andrecoveringallsatisfyingsetsofcredentials.6.1ExperimentalResultsWeﬁrstrepeattheexperimentsconductedin[22],whichexploredtheoverheadsassociatedwithusingatype-2com-pliancecheckertosolvethetype-3compliancecheckerprob-lem.Thethreemostinterestingcasesexploredin[22]ex-aminedtheoverheadsofusingtheSSGenalgorithmtoﬁndallsatisfyingsetsofcredentialsforapolicyintheeventthat(i)thepolicyhadonesatisfyingsetofsizeU,(ii)thepolicyhadUsatisfyingsetsofsizeone,or(iii)thepolicyhadtwosatisfyingsets,eachofsize3U4.Inallcases,Urepresentsthesizeoftheunionofallsatisfyingsets.RecallfromFigure1inSection2thattheoverheadsassociatedwithcases(ii)and(iii)grewexponentiallyandquicklybecameimpracti-cal.Figure7showstheresultsofrunningthesesametestsusingtheClouseaucompliancechecker;notethatthey-axisofFigure1islabeledinseconds,whilethey-axisofFigure7islabeledinmilliseconds.Inourexperiments,wevariedthesizeoftheunionofallsatisfyingsets(U)between1and50.Eachdatapointintheﬁgurerepresentstheav-eragerunningtimeover100randomly-generatedpolicies;anewRetenetworkwasconstructedforeachofthese100tri-alsastoeliminateanyoptimizationsthatmightoccurasaresultofpartialnetworkreuseasdiscussedinSection4.2. 0 2 4 6 8 10 12 14 16Size ofeach satisfying set 0 5 10 15 20 25Number of satisfying sets 0 50 100 150 200 250Average time (ms)Figure8:Runningtimeasthenumberofsatisfyingsetsandthesizeofeachsatisfyingsetvaries.Weseethat,inallcases,therunningtimeoverheadsofClouseaugrowlinearlywithUandneverexceed80mstoﬁndallsatisfyingsets.Wenotealsothat,unliketheSSgenalgorithm,Clouseaudoesnotrequirethatpoliciesbespec-iﬁedinDNFforminordertoeﬃcientlyﬁndallsatisfyingsets.TofurtherexploretherunningtimecharacteristicsofClouseau,weconductedanotherexperimentdesignedtomorefullyexaminethetypesofpoliciesthatmightbepro-cessedbyClouseauinpractice.Inthisexperiment,wevariedboththenumberofsatisfyingsetscontainedinapar-ticularpolicyandthesizeofeachsatisfyingset.Foreach-number,size.pair,100policiesweregeneratedatrandomandexaminedusingClouseau.Randompolicygenerationdoesnotcompromisethevalidityofourexperiments,asthestructuralcomplexityofapolicydictatesthecomplexityofthecompliancecheckingprocess,nottheexactcontentsofthepolicy.Further,randomgenerationofpoliciesallowsustoexplorecasesinwhichsatisfyingsetsoverlapwithoneanothertovaryingdegrees.Thisisimportantbecauseover-lappingsatisfyingsetswillresultinsharednodesintheRetenetworkconstructedbyClouseauand,thus,moreeﬃcientanalysis;examiningarandomsamplingofpoliciesprovidesuswithamore“averagecase”viewofClouseau’sperfor-mance.TheresultsofthisexperimentareshowninFigure8andconﬁrmthattheperformanceofClouseauscalesasO(NA),whereNisthenumberofsatisfyingsetsandAistheaveragesizeofeachsatisfyingset.Wethenconsideredthecaseinwhicheachcredentialwasassignedasensitivityvaluebyitsowner,asin[27],andrantheaboveexperimentsagain.GiventhesatisfyingsetsdetectedbyClouseau,ittookatrustnegotiationstrategy,onaverage,only0.04mstochoosetheleast-sensitivesatisfyingsettodisclose.WenextsoughttoevaluatetheperformanceofClouseauinaworst-casescenario.Toaccomplishthis,weanalyzedpoliciesoftheformp←(c1∨c2)∧···∧(c2i−1∨c2i),whichcanbesatisﬁedin2idiﬀerentwaysbyasetof2icredentials.Figure9showstheresultsofthisexperiment,whichcon-ﬁrmthattheperformanceofClouseaucontinuestoscaleasO(NA)(notethatthex-axisofFigure9followsaloga-rithmicscale).Policieswithexponentially-manysatisfyingsetsareunlikelytobeusedlegitimatelyinpractice,but 0 500 1000 1500 2000 2500 3000 2 4 8 16 32 64 128 256 512 1024Average time (ms)Number of satisfying sets (log scale)Figure9:Timerequiredtoﬁndall2isatisfyingsetsofsize2ifori=1,...,10.couldbeformedbyattackerswishingtoconsumeinordinateamountsofsystemresources.Detectingthesetypesofma-liciouspoliciesinpracticeisoutofthescopeofourcurrentpaper,andthuswedeferthattopictofuturework.Wedonote,however,thatClouseaufound512satisfyingsetsofcredentialsinapproximately1second.Thisimpliesthatthenaivestrategyofcappingthetimespentinthecompli-ancecheckermightbeareasonablemeansofdetectingthesetypesofattacksinpractice,asﬁndingthatmanysatisfyingsetsofcredentialsforanon-attackpolicyseemsexceedinglyunlikely.Inallofourexperiments,acompletelynewRetenetworkwascreatedateachinvocationofClouseau.Asstatedpre-viously,thiswasdonetoeliminatethepossiblebeneﬁtsofpartialnetworksharingbetweendistinctpolicies,asnetworksharingimprovestheperformanceofClouseau.However,someoftheprimarybeneﬁtsoftheRetealgorithmarisepre-ciselybecausethestateencodedinaparticularRetenetworkcanbesavedbetweeninvocationsofthematchingalgorithm,whichreducesthenumberoftimesobjects(i.e.,credentialsandotherevidence)needtobematchedagainstthepatternnodes(i.e.,policyclauses)inthenetwork.Ifaparticipantinthetrustnegotiationprocessiswillingtotradememoryforexecutiontime,theycouldmaintainaseparateRetenet-workforeachongoingnegotiationconstructedusingallofthepoliciesrelevanttothatparticularnegotiation.ThiswouldallowthemtoleveragethestatefulnessoftheRetealgorithmtoreducethenumberofmatchingoperationsre-quiredateachinvocationofClouseauandobtainbetterperformanceasthenegotiationproceedsintolaterrounds.Furtherexaminationofthesetypesofspeedversusmemorytradeoﬀsisaninterestingdirectionforfuturework.6.2DiscussionTheexperimentsdiscussedaboveillustratethatourClouseauimplementationperformsveryquickly,requiringonlytensofmillisecondstoﬁndallsatisfyingsetsofcre-dentialsforpoliciesofareasonablesize.Furthermore,theseresultsexperimentallyconﬁrmourclaimthattherunningtimeofClouseauscalesasO(NA),whereNisthenumberofsatisfyingsetsforthepolicybeinganalyzedandAistheaveragesizeofeachsatisfyingset.Asalways,thenumberofsatisfyingsetsforapolicypisintheworstcaseexpo-nentialinthesizeofp,aswasthecaseinthethirdsetofexperimentsdescribedabove.Eveninthiscase,Clouseauperformedadmirably,ﬁnding512satisfyingsetsofsize18injustonesecond;forordinarypolicies,Clouseauwillﬁndallsatisfyingsetsinaboutasmuchtimeasisneededforasinglediskaccess.ThelargesttrustmanagementcasestudytodateisBecker’sformalizationofthesecuritypoliciesrequiredbytheelec-tronichealthrecordservicethatisbeingproposedbytheUnitedKingdom’sNationalHealthService[2].Thisservice,alsoknownasthe“Spine,”aimstomakeelectronicpatientrecordsavailabletomedicalpersonnel,patients,andtheirdesignatedagentsandincludesprovisionsforensuringtheconﬁdentialityofpatientrecords.In[2],BeckercompletelyspeciﬁesacollectionofCassandra[3]policiesfortheNHSSpineanditsrelatedservicesthatcomplywithallavailableNHSdocumentsdescribingtherequirementsfortheSpine.ThecompleteCassandraspeciﬁcationincludesdeﬁnitionsof375policyrules,71roles,and12actionsthatcanbetakeninthesystem.EachoftherulesisaHornclause(i.e.,astrictconjunction),althoughoftenseveralruleswillhavethesamehead.Forexample,thereareseveralwaysinwhichaclini-ciancanassertthatheorsheisthe“treatingclinician”foraparticularpatient.Wewillcallasetofruleswiththesameheadapolicy,sinceeachsuchsetcompletelyspeciﬁesthewaysinwhichausercanaccomplishaparticulargoal.Eventhemostcomplexpoliciesspeciﬁedin[2]containlessthanadozenrules,andthuscanbesatisﬁedinatmostthismanyways.WeseefromFigures7,8,and9thatpoliciesofthissizecanbeeﬃcientlyanalyzedbyClouseauinunder100msinallcases.Thisshowsthatevenwhenthemyriadofrequirementsconcerningpatientprivacyinthemedicaldomainareconsidered,thenumberofuniquewaysthatanygivenpolicycanbesatisﬁedremainsreasonablylow.Thus,Clouseaucaneﬃcientlyhandlethelargestandmostcom-plexsetofrealisticpoliciesassembledtodate.7.CONCLUSIONSANDFUTUREWORKInthispaper,wedescribedthedesignandimplementa-tionoftheClouseaucompliancechecker.Clouseauwasdesignedtoeﬃcientlysolvethetype-3compliancecheckerproblem:givenasetEofevidenceandapolicyp,deter-mineallsubsetsofEthatcanbeusedtominimallysatisfyp.Previoussolutionsforthisproblemhavehadrunningtimeoverheadsthatareexponentialinthesizeoftheunionofallsatisfyingsets.Clouseau’stimeoverheadsscalelin-earlyinthesizeoftheunionofallsatisfyingsetsforthetestsconductedin[22],andasO(NA)ingeneral,whereNisthenumberofsatisfyingsetsforapolicyandAistheaveragesizeofeachsatisfyingset.Onaverage,Clouseaurequiresonlytensofmillisecondstoﬁndallsatisfyingsetsofcredentialsforagivenpolicy.Clouseauachievesthislevelofperformancebytakinganon-traditionalapproachtotheoremproving.Ratherthandirectlyanalyzingaccesscontrolpolicieswritteninhigh-levellanguages(suchasCassandra,RT,TPL,orX-TNL),Clouseaucompileshigh-levelpoliciesintoanintermediaterepresentationthatspeciﬁesconstraintsontheactualcre-dentialsandotherevidencethatmustbepresentedtogainaccesstoaparticularresource.ClouseauthenleveragesRete,aneﬃcientpatternmatchingalgorithm,toenumer-ateallsatisfyingsets.Inthispaper,weprovidedaprocessthroughwhichaccesscontrolpoliciesspeciﬁedintheRTlanguagecanbeautomaticallycompiledintothenativeruleformatanalyzedbyClouseau;aproofofcorrectnessforthiscompilationprocedureisavailablein[17].Sincealltrustnegotiationpoliciesareeventuallysatisﬁedbythesesametypesofevidence,weconjecturethatequivalentcompila-tionprocedurescouldalsobederivedforotherhigher-levelpolicylanguages.Thisallowspolicywriterstoexpresstheirpoliciesconciselyusinghigh-levelpolicylanguages,yetstillanalyzethemeﬃciently.AlthoughClouseauismuchmoreeﬃcientthanprevi-oussolutionstothetype-3compliancecheckerproblem,fur-theroptimizationisstillanimportantareaoffuturework.Spendingtensofmillisecondsduringaninteractionwiththeircompliancecheckerisperfectlyreasonableforentitiesinapeer-to-peerenvironmentorclientsinaclient/serversetting.However,serversthatmustprocesshighvolumesoftraﬃcmayneedseveralsuchinteractionsforeachtrustne-gotiationsession.Aninterestingdirectionoffutureworkistoinvestigatehigh-levelpolicylanguageconstructsthatcanbecompiledintoClouseaupoliciesthatcanbeanalyzedinaparticularlyeﬃcient(orineﬃcient)manner.Betterunder-standingthelanguageconstructsthatmostdirectlyaﬀectcompliancecheckerperformancecouldhelpleadtothede-signofyetmoreeﬃcientcompliancecheckers.AcknowledgmentsThisresearchwassupportedbytheNSFundergrantsIIS-0331707,CNS-0325951,andCNS-0524695andbySandiaNationalLaboratoriesundergrantnumberDOESNL541065.TheauthorswishtothankKazuhiroMinamiforhisdetailedcommentsonearlierversionsofthispaper.8.REFERENCES[1]L.Bauer,S.Garriss,andM.K.Reiter.Distributedprovinginaccess-controlsystems.InProceedingsoftheIEEESymposiumonSecurityandPrivacy,pages81–95,May2005.[2]M.Y.Becker.AformalsecuritypolicyforanNHSelectronichealthrecordservice.TechnicalReportUCAM-CL-TR-628,UniversityofCambridgeComputerLaboratory,Mar.2005.[3]M.Y.BeckerandP.Sewell.Cassandra:Distributedaccesscontrolpolicieswithtunableexpressiveness.InProceedingsoftheFifthIEEEInternationalWorkshoponPoliciesforDistributedSystemsandNetworks,pages159–168,June2004.[4]E.Bertino,E.Ferrari,andA.C.Squicciarini.X-TNL:AnXML-basedlanguagefortrustnegotiations.InProceedingsoftheFourthIEEEInternationalWorkshoponPoliciesforDistributedSystemsandNetworks(POLICY),pages81–84,June2003.[5]E.Bertino,E.Ferrari,andA.C.Squicciarini.Trust-X:Apeer-to-peerframeworkfortrustestablishment.IEEETransactionsonKnowledgeandDataEngineering,16(7):827–842,July2004.[6]M.Blaze,J.Feigenbaum,J.Ioannidis,andA.Keromytis.TheKeyNotetrustmanagementsystemversion2.IETFRFC2704,Sept.1999.[7]M.Blaze,J.Feigenbaum,andJ.Lacy.Decentralizedtrustmanagement.InProceedingsoftheIEEESymposiumonSecurityandPrivacy,pages164–173,May1996.[8]M.Blaze,J.Feigenbaum,andM.Strauss.CompliancecheckinginthePolicyMakertrustmanagementsystem.InProceedingsoftheSecondInternationalConferenceonFinancialCryptography,number1465inLectureNotesinComputerScience,pages254–274.Springer,Feb.1998.[9]P.BonattiandP.Samarati.Regulatingserviceaccessandinformationreleaseontheweb.InProceedingsoftheSeventhACMConferenceonComputerandCommunicationsSecurity(CCS),pages134–143,Nov.2000.[10]K.Borders,X.Zhao,andA.Prakash.CPOL:High-performancepolicyevaluation.InProceedingsofthe12thACMConferenceonComputerandCommunicationsSecurity(CCS),pages147–157,Nov.2005.[11]Y.-H.Chu,J.Feigenbaum,B.LaMacchia,P.Resnick,andM.Strauss.REFEREE:Trustmanagementforwebapplications.WorldWideWebJournal,2(3):127–139,Summer1997.[12]N.Damianou,N.Dulay,E.Lupu,andM.Sloman.ThePonderpolicyspeciﬁcationlanguage.InProceedingsoftheSecondIEEEWorkshoponPoliciesforDistributedSystemsandNetworks(POLICY),number1995inLectureNotesinComputerScience,pages18–39.Springer,Jan.2001.[13]C.L.Forgy.Rete:Afastalgorithmforthemanypattern/manyobjectpatternmatchproblem.ArtiﬁcialIntelligence,27(3):219–227,1985.[14]E.Friedman-Hill.Jess:TheruleenginefortheJavaplatform.Website,Apr.2007.!http://www.jessrules.com".[15]A.Herzberg,Y.Mass,J.Michaeli,D.Naor,andY.Ravid.Accesscontrolmeetspublickeyinfrastructure,or:Assigningrolestostrangers.InProceedingsoftheIEEESymposiumonSecurityandPrivacy,pages2–14,May2000.[16]H.KoshutanskiandF.Massacci.Aninteractivetrustmanagementandnegotiationscheme.InProceedingsoftheSecondInternationalWorkshoponFormalAspectsinSecurityandTrust(FAST),pages139–152,Aug.2004.[17]A.J.LeeandM.Winslett.Towardsaneﬃcientandlanguage-agnosticcompliancecheckerfortrustnegotiationsystems.TechnicalReportUIUCDCS-R-2007-2903,UniversityofIllinoisatUrbanaChampaignDepartmentofComputerScience,Oct.2007.[18]J.Li,N.Li,andW.H.Winsborough.Automatedtrustnegotiationusingcryptographiccredentials.InProceedingsof12thACMConferenceonComputerandCommunicationsSecurity(CCS),pages46–57,Nov.2005.[19]N.Li,J.C.Mitchell,andW.H.Winsborough.Designofarole-basedtrust-managementframework.InProceedingsofthe2002IEEESymposiumonSecurityandPrivacy,pages114–130,May2002.[20]D.P.Miranker.TREAT:AbettermatchalgorithmforAIproductionsystems.InProceedingsoftheSixthNationalConferenceonArtiﬁcialIntelligence(AAAI-87),pages42–47,Aug.1987.[21]K.E.Seamons,M.Winslett,T.Yu,B.Smith,E.Child,J.Jacobson,H.Mills,andL.Yu.Requirementsforpolicylanguagesfortrustnegotiation.InProceedingsoftheThirdIEEEWorkshoponPoliciesforDistributedSystemsandNetworks(POLICY),pages68–79,June2002.[22]B.Smith,K.E.Seamons,andM.D.Jones.RespondingtopoliciesatruntimeinTrustBuilder.InProceedingsoftheFifthIEEEWorkshoponPoliciesforDistributedSystemsandNetworks(POLICY),pages149–158,June2004.[23]W.H.WinsboroughandN.Li.Towardspracticalautomatedtrustnegotiation.InProceedingsoftheThirdIEEEInternationalWorkshoponPoliciesforDistributedSystemsandNetworks(POLICY),pages92–103,June2002.[24]W.H.Winsborough,K.E.Seamons,andV.E.Jones.Automatedtrustnegotiation.InProceedingsoftheDARPAInformationSurvivabilityConferenceandExposition,pages88–102,Jan.2000.[25]M.Winslett,T.Yu,K.E.Seamons,A.Hess,J.Jacobson,R.Jarvis,B.Smith,andL.Yu.Negotiatingtrustontheweb.IEEEInternetComputing,6(6):30–37,Nov./Dec.2002.[26]M.Winslett,C.Zhang,andP.A.Bonatti.PeerAccess:Alogicfordistributedauthorization.InProceedingsofthe12thACMConferenceonComputerandCommunicationsSecurity(CCS2005),pages168–179,Nov.2005.[27]D.Yao,K.Frikken,M.Atallah,andR.Tamassia.Point-basedtrust:Deﬁnehowmuchprivacyisworth.InProceedingsoftheEighthInternationalConferenceonInformationandCommunicationsSecurity(ICICS’06),number4307inLectureNotesinComputerScience,pages190–209.Springer,2006.[28]T.Yu,M.Winslett,andK.E.Seamons.Supportingstructuredcredentialsandsensitivepoliciesthroughinteroperablestrategiesforautomatedtrustnegotiation.ACMTransactionsonInformationandSystemSecurity,6(1),Feb.2003.