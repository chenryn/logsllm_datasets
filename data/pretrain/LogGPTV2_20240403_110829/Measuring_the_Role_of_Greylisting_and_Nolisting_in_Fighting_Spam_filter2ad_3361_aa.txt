# Title: Measuring the Role of Greylisting and Nolisting in Fighting Spam

**Authors:**
- Fabio Pagani, Eurecom
- Matteo De Astis, Università degli Studi di Milano
- Mariano Graziano, Eurecom and Cisco Systems, Inc.
- Andrea Lanzi, Università degli Studi di Milano
- Davide Balzarotti, Eurecom

**Conference:**
2016 46th Annual IEEE/IFIP International Conference on Dependable Systems and Networks

## Abstract
Spam has been extensively studied from various perspectives over the years, yet it remains a significant and profitable activity for cybercriminals. Despite the numerous countermeasures proposed and implemented, their effectiveness is often unclear. In addition to the commonly used content- and sender-based anti-spam techniques, two less prominent methods—greylisting and nolisting—are popular among system administrators. These techniques leverage known features of the Simple Mail Transfer Protocol (SMTP) that are frequently not adhered to by spam bots, making them simple to implement and, theoretically, quite effective.

In this paper, we present a comprehensive study of greylisting and nolisting, analyzing these spam countermeasures from multiple angles. First, we measure their global deployment and provide insights into their distribution. Second, we evaluate their effectiveness against a real dataset of malware samples responsible for generating over 70% of global spam traffic. Finally, we assess the impact of these defensive mechanisms on the delivery of legitimate emails.

Our findings offer a unique and valuable perspective on two of the most innovative and atypical anti-spam systems. This research can guide system administrators and security experts in better assessing their anti-spam infrastructure and dispelling common myths about greylisting and nolisting.

**Keywords:** Spam, Greylisting, Nolisting, Botnet

## I. Introduction
According to the Symantec Threat Report [1], the overall volume of spam messages decreased by 3% in 2014, but spam still accounted for 60% of global email traffic. This reduction is attributed to the increasing effectiveness of various spam prevention and detection solutions. These solutions can be broadly categorized into sender-based filtering and content-based filtering, which are applied at different stages by the receiving SMTP server. Pre-acceptance tests typically involve verifying the sender's status or reputation, while post-acceptance tests include local analyses such as content classification.

While the most popular techniques have been extensively studied [3]–[5], [11], [18], [22], [23], [28], [29], [35], [36], [38], the effectiveness of minor approaches like nolisting and greylisting has not been thoroughly examined. These methods assume that most spam is generated by machines infected with malware, which often use non-compliant SMTP implementations. This assumption was experimentally confirmed by Stringhini et al. [34], who noted that protocol deviations can be used to distinguish botnets from legitimate mail transfer agents (MTAs).

Nolisting and greylisting aim to prevent spam delivery by exploiting these non-compliant behaviors. Nolisting mimics a malfunctioning primary mail server, while greylisting temporarily rejects emails from unknown senders. Despite their widespread use, the core assumptions of these techniques have not been validated through real-world experiments. To address this, we conducted a study using real malware samples responsible for over 93% of botnet-generated spam in 2014, which accounts for over 70% of global spam traffic. Our results show that while malware is adapting to these techniques, they remain effective in 2015.

**Contributions:**
- We present the first comprehensive study of nolisting, measuring its effectiveness and global deployment.
- We test the efficacy of nolisting and greylisting using binaries from four major malware families.
- We analyze how greylisting thresholds affect the delivery of normal emails and botnet behavior.

This research provides network administrators with systematic and informed guidance on selecting appropriate anti-spam techniques.

**Structure:**
- Section II introduces nolisting and greylisting, detailing their deployment and current debates.
- Section III describes our experimental setup and methodology.
- Sections IV and V present the results for nolisting and greylisting, respectively.
- Section VI offers a summary and discussion.
- Section VII reviews related work.
- Section VIII concludes the paper.

## II. Nolisting & Greylisting
### Nolisting
Nolisting is a straightforward anti-spam mechanism involving the registration of a non-existent primary mail server (MX record) and a fully functional secondary server. The primary record points to an address with a closed port 25, simulating a malfunctioning server. According to RFC 5321, email clients must attempt to contact all MX addresses in order of priority. Nolisting assumes that many spam sources, following a simple logic, will fail to deliver messages when the primary server is unreachable.

**Criticisms:**
- Advocates argue that nolisting is simple and effective, as most botnets are not RFC-compliant.
- Skeptics claim that modern malware can bypass nolisting by directly contacting the secondary MX server, rendering the technique ineffective. Additionally, nolisting may occasionally block legitimate automated notifications.

**Open Questions:**
- How widely is nolisting used?
- Is modern malware unaffected by nolisting, and if so, why?

### Greylisting
Greylisting is more sophisticated and popular than nolisting, requiring no DNS modifications. It involves temporarily rejecting emails from unknown senders based on the triplet (sender IP, sender domain, recipient). RFC-compliant clients retry at regular intervals, while fire-and-forget software may not. After a configurable time, the server accepts the email and whitelists the sender.

**Criticisms:**
- Greylisting introduces delays in legitimate email delivery.
- It only works if the client retries with the same IP address, which is not always the case for large email providers.
- Critics argue that modern malware can retry message delivery, and even if not, repeated use of the same address can lead to accidental whitelisting.

**Supporters:**
- Even if ineffective, greylisting can delay spam delivery, allowing time for spammers to be blacklisted.

**Open Questions:**
- What is the global adoption rate of greylisting?
- Is greylisting still effective against modern malware?

By addressing these questions, our study aims to provide a clearer understanding of the role and effectiveness of nolisting and greylisting in combating spam.