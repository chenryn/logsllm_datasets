t
s
u
A
Fig. 1. Top 15 countries hosting the most (a) deployed IoT devices in the obtained data (cumulative percentage 69.3%), and (b) compromised IoT devices
(CPS and consumer IoT devices).
provide the methodology and results towards the goal of
inferring compromised IoT devices.
A. Obtained Data
1) IoT Device Information: It is quite difﬁcult, if not impos-
sible, to obtain technical information related to Internet-wide
IoT devices that have been deployed in consumer and CPS
environments due to privacy and logistic reasons. In addition,
there is a lack of knowledge about effective ﬁngerprinting
approaches for identifying IoT devices by solely observing
network trafﬁc. Considering these challenges however, in this
work, we leverage a near real-time IoT database provided by
Shodan [30]. This service executes large-scale active mea-
surements to identify and index Internet-facing IoT devices.
To this end, we obtained information related to 331,000
IoT devices from Shodan. These IoT devices, which were
deployed in more than 200 countries all around the world,
belong to consumer and CPS realms. On one hand, consumer
IoT devices represent wireless access points and routers,
IP cameras (e.g., webcams and CCTV cameras), printers,
network storage media, satellite TV box and digital video
recorders (DVRs), and electric hubs/outlets. On the other
hand, IoT devices in CPS realms are involved in monitoring,
controlling, and managing industrial/automation operations.
They represent programmable logic controllers (PLC), remote
terminal units (RTU), or other smart equipment that are used
in industrial control systems (ICS), supervisory control and
data acquisition systems (SCADA), and/or distributed control
system (DCS). We obtained information related to approx-
imately 181,000 consumer IoT devices,
including, routers
(46.9%), printers (29.1%), IP cameras (18.3%), and network
storage media (4.6%). The remaining consumer IoT devices
accumulate to only 1.1% of the total devices. We also obtained
data related to 150,000 IoT devices in CPS that supported
31 industrial/control automation protocols/services. These CPS
devices belong to a number of industries including but not
limited to: building automation, power generation and distri-
bution, control systems, plant/factory automation, oil and gas
transportation, and embedded IoT communications.
As depicted in Figure 1a, the U.S. hosted the largest number
of IoT devices (25%), followed by a signiﬁcantly less number
of devices hosted in the U.K. (6%), Russia (5.9%), and China
(5%), respectively. Furthermore, by looking at the top 15 coun-
tries with the most number of IoT devices (Figure 1a), which
account for about 69% of all IoT devices, we noticed that
the number of consumer IoT devices were relatively higher
than those deployed in CPS for the listed countries except for
China, France, Canada, Vietnam, Taiwan, and Spain.
2) Network Telescope Data: Darknet data consists of one-
way trafﬁc targeted towards routable, allocated yet unused
IP addresses (dark IP addresses). Since these IP addresses
are not bound to any services, any trafﬁc targeting them
is characteristically unsolicited [8], [14]. Typically, darknet
data consists of scanning, backscatter, and misconﬁguration
trafﬁc [8], [9], [11], [12], [14], [31]. We explored over 5TB
of darknet trafﬁc between April 12-18, 2017 (about 80 GB of
daily trafﬁc). The darknet trafﬁc is obtained from the UCSD
real-time network telescope data maintained by the Center for
Applied Internet Data Analysis (CAIDA) [32]. It is one of
largest available sources of passive darknet trafﬁc with about
16.7 million globally routed destination IPv4 addresses (i.e.,
/8 network) capturing over a billion packets every hour. The
processed darknet trafﬁc is stored in “ﬂowtuple” ﬁles. Each
ﬁle represents incoming ﬂows towards the darknet that consist
of the following ﬂowtuple information: source/destination IP
addresses and used ports, protocol, time to live (TTL), TCP
ﬂags, IP length, and total number of packets. The daily darknet
trafﬁc consists of unique compressed ﬁles representing hourly
trafﬁc (maximum of 24 ﬁles per day). We found that the
available data for April 18 was incomplete, with only 15 hours
of collected trafﬁc (data might be missing due to technical
issues at the telescope). To maintain consistency, we decided
to remove the incomplete data from further analysis throughout
the paper, resulting in 143 hours of analyzed darknet data that
was obtained over 6 days between April 12-17, 2017.
B. Inferring and Characterizing Unsolicited IoT Devices
To infer compromised IoT devices, we executed a cor-
relation algorithm that
leverages IP header information to
associate the obtained IoT device information with darknet
ﬂows. A signiﬁcant 26,881 IoT devices were found interacting
with the darknet, representing relatively more compromised
564
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:49:07 UTC from IEEE Xplore.  Restrictions apply. 
s
e
c
i
v
e
D
T
o
I
f
o
r
e
b
m
u
N
28K
24K
20K
16K
12K
8K
4K
0K
APR-12
All IoT Devices
CPS
Consumer
IP Cameras
25.4%
Printers
18.0%
Routers
52.4%
APR-16
APR-17
APR-13
APR-14
APR-15
Analysis Interval (April 2017)
Network 
Storage Media
3.6%
Digital Video 
Recorders
0.5%
Electric 
Hubs/Outlets
0.1%
Fig. 2. The cumulative number of daily discovered compromised CPS and
consumer IoT devices at the darknet over the 6 days analysis interval.
Fig. 3. Percentage of compromised consumer IoT devices by type/category.
consumer IoT devices (57%) than CPS (43%). As shown in
Figure 2, slightly over 12,000 (46%) unsolicited IoT devices
were correlated with the darknet data at the ﬁrst day of the
analysis (April 12, 2017). For the remaining time period, we
discovered an average of about 2,900 newly compromised
IoT devices per day. Considering the overall and cumulative
numbers of uncovered unsolicited IoT devices, we deﬁnitely
anticipate that an extended analysis period would result in
discovering even more compromised IoT devices.
The compromised IoT devices were located across 161
countries, with the largest number of devices to be hosted
in Russia (24.5%), followed by China (8.6%), and the U.S.
(8.1%), respectively (Figure 1b). It is worth noting that while
the U.S. and the U.K. hosted more number of IoT devices as
compared to Russia and China (Figure 1a), the latter countries
were found to host a relatively higher number of unsolicited
IoT devices, as illustrated in Figure 1b. Furthermore, while
Thailand, Indonesia, Singapore, Turkey, Ukraine, and India
were not listed among the top 15 hosts with the most deployed
IoT devices (Figure 1a), it is interesting to ﬁnd them among
the top 15 countries with the most number of uncovered com-
promised IoT devices. In fact, Figure 1b illustrates a signiﬁcant
difference in the percentage of unsolicited IoT devices found
in Russia (31%) and Ukraine (30%), as compared to countries
such as the U.S. (2.4%) and the U.K. (2.5%). While the actual
reason behind this signiﬁcant difference is quite obscured,
this might indicate the enforcement of a stronger and more
effective IoT security measures and policies in the U.S. and
the U.K. in comparison to other countries.
1) Compromised IoT Devices in Consumer Realms: We
identiﬁed 15,299 unsolicited consumer IoT devices that were
correlated with the darknet over the analysis period. These
IoT devices were located across 145 countries, with Russia
hosting the highest percentage of compromised consumer IoT
devices (32%), followed by the U.S. (9%), Indonesia (4%),
and Thailand (4%), respectively. These IoT devices were
connected to the Internet via 1,762 different Internet Service
Providers (ISP), with the Russian “JSC ER-Telecom” hosting
the highest percentage of compromised consumer IoT devices
(27.6%), as summarized in Table I. In addition, about 52.4%
of compromised consumer IoT devices were Internet routers,
followed by IP cameras (25.2%), printers (18%), and network
storage media (3.6%), respectively. As illustrated in Figure 3,
these aforementioned devices accounted for about 99.4% of
all consumer IoT devices, while TV boxes/DVRs and electric
hubs/outlets represented less than 0.6% of all compromised
consumer devices.
TOP 5 ISPS HOSTING THE HIGHEST NUMBER OF COMPROMISED
CONSUMER IOT DEVICES.
TABLE I
Country
ISP
JSC ER-Telecom Russian F.
Indonesia
PT Telkom
R. of Korea
Korea Telecom
Philippine
PLDT
TOT
Thailand
Devices %
27.6
4,205
3.6
542
2.2
339
2.0
311
277
1.8
2) Compromised IoT Devices in CPS Realms: We identiﬁed
11,582 compromised IoT devices in CPS environments that
were located in 136 countries, with China, Russia, Korea, and
the U.S. hosting about 17%, 14.8%, 8.3%, and 6.9% of all the
compromised devices respectively. The IP addresses of these
devices were associated with 2,279 different ISP across the
identiﬁed countries. As pinpointed in Table II, “Rostelecom”
hosts the highest percentage of compromised IoT devices
(about 4%), followed by “Korea Telecom” (3.8%) and “Turk
Telekom” (3.2%), respectively.
TOP 5 ISPS HOSTING THE HIGHEST NUMBER OF COMPROMISED IOT
DEVICES IN CPS REALMS.
TABLE II
ISP
Rostelecom
Korea Telecom
Turk Telekom
HiNet
JSC ER-Telecom Russian F.
Country
Russian F.
R. of Korea
Turkey
Taiwan
Devices %
4.5
3.8
3.2
2.5
1.8
461
429
347
261
277
Furthermore, a range of 31 services/protocols were operated
by such compromised IoT devices. These services are not
mutually exclusive, and therefore, an IoT device in a speciﬁc
CPS might support one or more of these services. The top
10 operated services/protocols by the most number of unso-
licited IoT devices are summarized in Table III. Among all
the supported services/protocols, Telvent OASyS DNA (20%),
565
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:49:07 UTC from IEEE Xplore.  Restrictions apply. 
TOP 10 CPS REALMS HOSTING COMPROMISED IOT DEVICES.
TABLE III
Service/Protocol
Telvent OASyS DNA
SNC GENe
Niagara Fox
MQ Telemetry Transport
Ethernet/IP
ABB Ranger
Siemens Spectrum PowerTG
Modbus TCP
Foxboro/Invensys Foxboro
Foundation Fieldbus HSE
Common applications
Oil and Gas transportation pipelines and distribution networks
Control systems
Building automation systems
IoT communications, sensory networks, safety-critical communications
Manufacturing automation
Power generating plants, transmission lines, mining operations, and transportation systems
Utility networks
Power utilities
Plant automation systems, ﬂowmeters, single-loop controllers, and product support services
Plant and factory automation
Devices %
20.0
2,328
18.3
2,126
1,554
13.4
12.9
1,497
12.8
1,490
9.1
1,061
5.9
685
5.5
639
590
5.1
3.0
354
which operates in critical oil and gas CPS, and Niagara Fox
(13.4%), which is common in building automation systems,
appear among the most prevalent. CPS hosting compromised
IoT devices also include those related to power utilities and
manufacturing plants. Having noted this, it is indeed alarming
(to say the least) to infer over 11,000 compromised IoT devices
operating in such critical and error-sensitive environments.
s
t
e
k
c
a
p
f
o
%
60
50
40
30
20
10
0
CPS
Consumer
46.8
38.8
3.9
6.5
UDP
2.2
1.9
ICMP
TCP
IV. CHARACTERIZING UNSOLICITED TRAFFIC FROM
INTERNET-SCALE IOT DEVICES
Fig. 4. Percentage of TCP, UDP, and ICMP trafﬁc generated by compromised
IoT devices in CPS and consumer realms.
The aim of this section is to dissect, thoroughly compre-
hend, and characterize the unsolicited trafﬁc generated by the
inferred compromised IoT devices as perceived by the network
telescope. We observed about 141.3M packets that were sent
to the darknet from the 26,881 compromised IoT devices
(daily mean = 23.5M and σ = 0.92M packets). On average,
we captured 10,889 unsolicited IoT devices generating trafﬁc
towards the darknet on a daily basis, with slightly larger
number of active consumer IoT devices (53%) on a daily basis.
In general, consumer IoT devices, which represent 57% of all
compromised IoT devices, generated more packets towards the
darknet as compared to compromised devices in CPS realms,
with approximately 62M packets (daily mean = 10M and
σ = 1.01M), and 50M packets (daily mean = 8.3M and
σ = 1.05M) for each device type respectively.
Considering the critical CPS contexts in which the compro-
mised IoT devices operate in, it is worrisome to observe their
aggressive role in generating signiﬁcant amount of unsolicited
activities. Interestingly, the statistical analysis using a Mann-
Whitney U test indicated that the number of packets generated
towards the darknet was signiﬁcantly greater for devices in
CPS than for consumer IoT devices (p < 0.0001). The higher
activities however, might be attributed to the nature of the
compromised IoT devices in CPS, which might have access
to more powerful processing capabilities, as compared to
other IoT devices, which typically have limited processing
and memory resources. By contrast, the lower activity rate
of compromised consumer IoT devices might be due to the
stealthy nature of their generated activities, which aim at max-
imizing reachability while attempting to avoid detection. In
what follows, we further explore the natures and characteristics
of unsolicited trafﬁc that have been generated by Internet-scale
compromised IoT devices.
A. Unsolicited UDP Trafﬁc
[9], [33],
The analyzed UDP packets represent about 10.4% of all
trafﬁc generated by the unsolicited IoT devices, with slightly
more UDP packets generated by compromised consumer IoT
devices as compared to those in CPS, as illustrated in Figure 4.
Indeed, it is well known that UDP packets have been used
to scan the Internet for open ports/services
in
addition to being employed to perform DoS attacks by ﬂooding
destination IP addresses or by exploiting open resolvers,
causing ampliﬁcation DoS attacks [29]. Thus, due to the
stateless nature of UDP packets, it is quite challenging to
classify them into a speciﬁc trafﬁc category without further
packet inspection. To maintain the focus of this paper, we do
not address this challenging objective herein, though we will
explore methodologies similar to [13] in future work to achieve
this task. Nonetheless, to gain insights related to IoT-generated
UDP trafﬁc, we provide an overall characteristic analysis of
the observed UDP packets in the following sub-sections.
1) UDP Packets: Overall, we observed about 13M UDP
packets generated by a total of 25,242 compromised IoT
devices, among which, about 60% were compromised con-
sumer IoT devices, generating 63% of all UDP packets. Such
IoT devices also targeted a signiﬁcantly higher number of
ports and destination IP addresses on an hourly average, as
compared to those compromised IoT devices deployed in
CPS (Figure 5). More speciﬁcally, compromised consumer IoT
devices targeted an average of about 29,000 ports on more than
566
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:49:07 UTC from IEEE Xplore.  Restrictions apply. 
100K
90K
80K
70K
60K
50K
40K
30K
20K
10K
0K
)
s
t
r
o
P
/
s
P
I
/
s
t
e
k
c
a
P
(
t
n
u
o
C
Packets
Destination IPs
Destination Ports
1
8
15 22 29 36 43 50 57 64 71 78 85 92 99 106 113 120 127 134 141
Analysis Interval (143 Hours)
(a) CPS
100K
90K
80K
70K
60K
50K
40K
30K
20K
10K
0K
)
s
t
r
o
P
/
s
P
I
/
s
t
e
k
c
a
P
(
t
n
u
o
C
Packets
Destination IPs