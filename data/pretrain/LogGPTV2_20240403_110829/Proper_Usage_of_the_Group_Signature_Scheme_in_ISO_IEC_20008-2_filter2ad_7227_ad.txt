(cid:3)
r
(cid:3)
2 = G(cid:27)
(cid:3)
q, and
+ (cid:26)
Moreover, it holds that (cid:27)
2 Zp
(cid:3)
(cid:3)
(cid:3)
q ; (cid:27)
r = r
(cid:27)
r
are chosen uniform randomly. Therefore, Game 2 is identical to Game 1. That is, Pr[S1] = Pr[S2].
Lemma 4.3. Let qH and qopen be the number of A’s random oracle queries and opening queries, respec-
(cid:3)
(cid:3)
x, (cid:27)
+ (cid:26)
(cid:3)
(cid:3)
(cid:3)
q; (cid:26)
(cid:14); (cid:26)
y; (cid:26)
(cid:12)(cid:12) (cid:20) qH (cid:1) qopen=p for any PPT A.
(cid:12)(cid:12)Pr[S2] (cid:0) Pr[S3]
r (cid:1) (T
(cid:3)
(cid:3)
= V (cid:26)
4 )
r :
(cid:3) (cid:1) c
(cid:3)
(cid:3)
q = q
(cid:14), (cid:27)
+ (cid:26)
2 Zp are uniformly random since (cid:27)
(cid:3)
(cid:3)
(cid:3)
(cid:14) ; (cid:27)
y; (cid:27)
x; (cid:27)
(cid:3)
(cid:3)
= U (cid:26)
4 = V (cid:27)
r ; R
(cid:3) (cid:1) c
tively. Then, it holds that
y (cid:1)
(cid:3)
(cid:3)
; G2)(cid:26)
y ;
e(G1; G2)
(cid:3)
e(T
1 ; Y )
)(cid:0)c
(cid:3)
(cid:14) = (cid:14)
(cid:3)
r ; R
(cid:3)
y, (cid:27)
(cid:3) (cid:1) c
(cid:3)
x+(cid:27)
(cid:3)
x+(cid:26)
(cid:3)
(cid:0)c
(cid:3)
(cid:3)
+ (cid:26)
(cid:0)c
(cid:3)
+ (cid:26)
(cid:3)
(cid:3)
(cid:3)
x
(cid:3)
(cid:3)
(cid:3)
, (cid:26)
R
(cid:3)
q
(cid:3)
(cid:3)
(cid:3)
(cid:3)
y
R
, (cid:26)
(cid:3)
(2)
Proof. We de(cid:12)ne the event Bad
ℓ
as follows.
(2)
Bad
ℓ
(cid:12)(cid:12) (cid:20) Pr[Bad
Game 2 and Game 3 are identical unless the events Bad
Pr[S3]
: The event that there is already the pair ((gpk; Q; T2; T3; R);(cid:1)) in the list L when computing the
value H(gpk; Q; T2; T3; R) during the generation of an opening proof (cid:28) in Game ℓ.
(cid:12)(cid:12)Pr[S2] (cid:0)
occurs, eR = R holds for the
some de(cid:12)ned value (((cid:1);(cid:1);(cid:1);(cid:1);eR);(cid:1)) in the list L. Since (cid:26)u 2 Zp is chosen uniform randomly in Game 3,
(cid:0)1)(cid:26)u 2 G is also uniformly random. Also, the number of values in the list L is at least
R = (Q (cid:1) T2
(cid:12)(cid:12)Pr[S2] (cid:0) Pr[S3]
qH . Therefore, the probability that ((gpk; Q; T2; T3; R);(cid:1)) is already stored in L when generating an
3 ] (cid:20) qH (cid:1) qopen=p holds. Thus, we obtain
opening proof is at most qH =p. By the union bound, Pr[Bad
(cid:12)(cid:12) (cid:20) qH (cid:1) qopen=p.
Here, we estimate the probability Pr[Bad
(2)
(2)
3 ]. When the event Bad
3
(2)
3 occur. Therefore, we get
(2)
3 ] same as in Lemma 4.1.
(2)
2 and Bad
(cid:0)d
3 =
(cid:0)1)(cid:26)u and (cid:27)u = u (cid:1) d + (cid:26)u hold. Moreover, (cid:26)u 2 Zp is uniformly random since (cid:27)u 2 Zp is chosen
Lemma 4.4. It holds that Pr[S3] = Pr[S4] for any PPT A.
Proof. For Game 4, we introduce new values (cid:26)u, and sets (cid:26)u = (cid:27)u(cid:0)u(cid:1)d. Then, R1 = (Q(cid:1)T2
(Q (cid:1) T2
uniform randomly. Therefore, Game 4 is identical to Game 3. That is, Pr[S3] = Pr[S4].
Lemma 4.5. There exists a PPT algorithm B1 such that
(cid:12)(cid:12)Pr[S4](cid:0)Pr[S5]
(cid:12)(cid:12) = AdvDDHB1
((cid:21)) for any PPT A.
(cid:0)1)(cid:27)u (cid:1)T
(2)
11
Proof. Let B1 be an adversary that tries to solve the DDH problem. First, B1 receives the DDH tuple
G; V; R; W 2 G. Let V = Gv, and R = Gr. The element W is Gvr or a random value in G. Next, B1
generates the instance of the anonymity game. Here for G and V , he uses the ones in the DDH tuple.
Other elements are generated by following the GKg algorithm. Let gpk = (G1; G2; G; H; H; K; Y; U; V ),
ik = w, and ok = (u; v), B1 sends (gpk; ik) to the adversary A. We note that B1 does not know the
for opening in Game 4 and Game 5 is u = logG U . Therefore, B1 possesses all keys which are needed to
reply oracle queries, and can simulate the replies of all queries. Especially, B1 generates the challenge
discrete logarithm v of the value V . Although v is the part of the opening key ok, the key that is used
signature as follows:
1. Choose q
(cid:3) 2 Zp uniform randomly and compute (T
(cid:3)
1 ; T
(cid:3)
2 ; T
(cid:3)
3 ; T
(cid:3)
4 ) = (Aib
(cid:3)
(cid:1)K q
; Qib
(cid:1)R; Ru; W ) where
R and W are the part of the DDH tuple.
(
(cid:3) 2 Zp uniform randomly, and computes R
2 Zp and c
y (cid:1)
(cid:3)
1 ; G2)(cid:27)
)(cid:0)c
(cid:3)
2 = G(cid:27)
r (cid:1) T
(cid:3)
x+(cid:27)
, R
, R
(cid:0)c
(cid:3)
2
(cid:3)
(cid:3)
(cid:3)
(cid:3)
e(G1;G2)
(cid:3)
1 ;Y )
e(T
(cid:3)
1 = e(H; G2)(cid:27)
(cid:3)
x (cid:1)
(cid:3)
3 = U (cid:27)
(cid:3)
r (cid:1) T
(cid:3)
3
(cid:0)c
(cid:3)
, and
2. Choose (cid:27)
e(K; G2)(cid:27)
(cid:3)
(cid:3)
4 = V (cid:27)
R
(cid:3)
y; (cid:27)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
x; (cid:27)
(cid:14) ; (cid:27)
q ; (cid:27)
r
(cid:14) (cid:1) e(K; Y )
q (cid:1) e(T
(cid:0)(cid:27)
(cid:3)
(cid:3)
r (cid:1) T
.
(cid:0)c
(cid:3)
(cid:3)
4
3. If the value ((gpk;fT
(cid:3)
fT
gi2[1;4];fR
gi2[1;4]; m
(cid:3)
(cid:3)
i
(cid:3)
(cid:3)
(cid:3)
(cid:3)
i
i
c
x; (cid:27)
(cid:14) ; (cid:27)
; (cid:27)
q ; (cid:27)
is set to be ?.
(cid:3)
y; (cid:27)
gi2[1;4]; m
gi2[1;4];fR
(cid:3)
);(cid:1)) is not de(cid:12)ned in the list L, the value ((gpk;
gi2[1;4];
(cid:3)
r ). On the other hand, if such a value is already de(cid:12)ned, the challenge signature
) is added to L and the challenge signature (cid:6)
is set to be (fT
); c
(cid:3)
i
(cid:3)
i
(cid:3)
(cid:3)
(cid:3)
(cid:3)
Finally, when A terminates witheb 2 f0; 1g, B1 outputs 1 if b =eb. Otherwise he outputs 0.
(cid:1) Gr; Gur; Gvr) = (Aib
If the DDH tuple that B1 obtains is (G; V; R; W ) = (G; Gv; Gr; Gvr), it holds that (T
(cid:3)
T
4 ) = (Aib
4 for A. On the other hand, if the element W is a random value in G, it holds that (T
(cid:3)
T
4 ) = (Aib
AdvDDHB1
(cid:3)
(cid:3)
3 ;
2 ; T
; Gxib +r; U r; V r). Then, B1 perfectly simulates Game
; Qib
(cid:3)
(cid:3)
2 ; T
3 ;
; Gxib +r; U r; W ). Then, B1 perfectly simulates Game 5 for A. Therefore, it holds that
((cid:21)) = j Pr[1   B1(G; Gv; Gr; Gvr)](cid:0)Pr[1   B1(G; Gv; Gr; W )]j = j Pr[b =eb in Game 4](cid:0)Pr[b =
(cid:12)(cid:12) (cid:20) 1=p for
(cid:12)(cid:12)Pr[S4] (cid:0) Pr[S5]
(cid:12)(cid:12).
eb in Game 5]j =
(cid:12)(cid:12)Pr[S5](cid:0) Pr[S6]
Lemma 4.6. If the adversary does not generate a related query, it holds that
any PPT A.
(cid:1) K q
(cid:1) K q
(cid:3)
1 ; T
(cid:3)
1 ; T
(cid:1) K q
(cid:3)
(cid:3)
(3)
Proof. We de(cid:12)ne the event Bad
ℓ
as follows.
(3)
Bad
(3)
Bad
ℓ
(3)
5 and Bad
(3)
6 as follows.
(3)
6 occur. Therefore, we get
(cid:12)(cid:12)Pr[S5] (cid:0)
(3)
6 ] same as in Lemma 4.1. Moreover, we de(cid:12)ne the event Bad
: The event that the adversary A sends the opening query (m; (cid:6) = (fTigi2[1;4]; c; (cid:27)x; (cid:27)y; (cid:27)(cid:14); (cid:27)q;
(cid:27)r)) such that GVf(gpk; m; (cid:6)) = 1 and logU T3 ̸= logV T4 in Game ℓ.
Game 5 and Game 6 are identical unless the events Bad
Pr[S6]
(cid:12)(cid:12) (cid:20) Pr[Bad
6 : The event that in Game 6, the adversary A sends the random oracle query (gpk;fTigi2[1;4];
fRigi2[1;4]; m) such that logU T3 ̸= logV T4 and (fTigi2[1;4];fRigi2[1;4]; m) ̸= (fT
gi2[1;4];
), and there exists (cid:27)r such that(
)(
(cid:3)
m
(cid:27)rec
whereec is the reply of the query (gpk;fTigi2[1;4];fRigi2[1;4]; m).
)(cid:12)(cid:12)(cid:12)(cid:12) =
(cid:12)(cid:12) ̸= 0:
(cid:12)(cid:12)logU T3 (cid:0) logV T4
When logU T3 ̸= logV T4 holds, it holds that
Therefore, the simultaneous equation (1) has the unique solution ((cid:27)r;ec). Since it holds that (fTigi2[1;4];
), ec is chosen uniform randomly for (fTigi2[1;4];fRigi2[1;4];
fRigi2[1;4]; m) ̸= (fT
(
1 (cid:0) logU T3
1 (cid:0) logV T4
1 (cid:0) logU T3
1 (cid:0) logV T4
gi2[1;4];fR
gi2[1;4];fR
gi2[1;4]; m
logU R3