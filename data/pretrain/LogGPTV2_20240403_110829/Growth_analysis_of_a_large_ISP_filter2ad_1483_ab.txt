• Novel information about interface types and positions
• Novel estimates of router, module, and interface growth rates
for a large ISP
• A new dataset for evaluating methods to de-alias router inter-
faces, which are used when discovering Internet topologies
using traceroute-like measurements (§2)
• Results from more than one billion DNS queries issued from
approximately 100 globally-distributed vantage points, in-
cluding more than 100,000 anomalies (e.g., ID mismatches,
replies from unexpected sources, corrupt responses, etc.)
• Validity and coverage-rate established through comparison
with iffinder, public ground truth, and a complete set of
IPv4 reverse DNS records
The rest of this paper proceeds as follows: ﬁrst, we provide con-
text for our study in the space of related work (§2); second, we de-
scribe and validate the approach used to build this dataset (§3, §4);
next, we conduct an initial time-series analysis of this data (§5); and
ﬁnally, conclude with potential avenues for further research (§6).
2. RELATED WORK
Constructing router-level Internet topologies has been a project
of the networking research community for more than 10 years [14].
A common approach is to use traceroute-like probes with suc-
cessively increasing TTL values. This approach was made scalable
by targeting probes more efﬁciently with Rocketfuel [25], more
transparent to network middleboxes through the use of TCP Side-
car [23], and has been augmented with information gathered by the
IP Record Route option [22]. At their core, these traceroute-
like approaches provide a list of router IP addresses which can be
viewed as aliases of a single router, to be determined [14].
Therefore, numerous solutions to the alias resolution problem
have been developed including: examining IP ID values [9, 17,
25], using prespeciﬁed IP timestamps [21], detecting variants in the
source address of a probe’s response [14], applying graph analysis
techniques [15], and, as in this work, by examining reverse DNS
lookups [24].
In this work, however, reverse DNS lookups are the only method
for discovering router interfaces – we do not send any TTL-limited
active probes. Other techniques for topological discovery without
traceroute-like probes include inference from passive measure-
ments [13], and gathering data with MPLS ICMP extensions [23]
and IGMP messages [20].
Using reverse DNS records for this application is not without
risks, however. Previous work has shown that using out-of-date and
other incorrect reverse DNS records can have a disproportionately
negative effect on POP-level path reconstruction [27]. In this work,
by contrast, we primarily focus on inferring Cogent’s router orga-
nization and interface properties, and their change over time. To
(a) Breakdown of all DNS probes we sent.
(b) Breakdown of successful DNS probes
Figure 1: Responses to weekly DNS probes.
the best of our knowledge, this information is only publicly avail-
able from DNS records; therefore, such inference requires careful
validation of our DNS-based mapping, as we show in §4.
Perhaps the most closely related work is CAIDA’s “IPv4 Routed
/24 DNS Names Dataset” [7]. This dataset consists of reverse DNS
records for router interfaces discovered by traceroute-like active
probes. CAIDA’s probes are sent weekly to a random IP address in
every Internet-routed /24 subnet. This measurement naturally aims
for breadth of coverage. Our work, by contrast, aims to achieve
depth – complete coverage of a single ISP, as we show in our vali-
dation (§4).
3. METHODOLOGY
This paper analyzes weekly snapshots of Cogent’s router organi-
zation, built from publicly available reverse DNS records. As de-
scribed above, we systematically issue reverse DNS queries for
each Cogent-owned IP address, allowing us to discover all of the
corresponding interface names. This initially required more than 17
million weekly DNS queries; we now issue more than 20 million
each week.
To minimize our load on the DNS infrastructure, we globally dis-
tributed our queries at 90-100 sites using PlanetLab [12]. Worker
processes at each site issue queries for all IP addresses in a block
no larger than a /19 subnet (8,192 addresses), at a rate of approx-
imately one query per second using the Linux host command.
Between assignments, workers pause for a random sleep of be-
tween 10 to 20 minutes. Workers notify our master server every 256
queries (allowing us to detect and re-assign incomplete blocks), and
upload a log when ﬁnished. With this approach, we can success-
fully query millions of DNS records each week.
Figure 1 provides an overview of our DNS queries’ responses.
During the weeks of March 11 and 18, 2012, our master server
experienced data loss. In addition, our measurement infrastructure
was unavailable for seven weeks (from the week of June 3, 2012
 0 2 4 6 8 10 12 14 16 18 20 22J2012FMAMJJASONDJ2013FMNumber of Probes (x106)WeekOther ErrorsServer FailureTimeoutNo Reverse MappingSuccessful 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7J2012FMAMJJASONDJ2013FMNumber of Probes (x106)WeekNon-CogentCogent-OtherCogent AtlasCode Type
et
fa
gi
te
se
pos
ism
lo
mul
tu
vl
10 Mbps Ethernet
100 Mbps Ethernet
1 Gbps Ethernet
10 Gbps Ethernet
Serial link
Packet-over-SONET
Integrated Services Module
Loopback
Multilink
Tunnel
VLAN
Class
Physical
Physical
Physical
Physical
Physical
Physical
Physical
Virtual
Virtual
Virtual