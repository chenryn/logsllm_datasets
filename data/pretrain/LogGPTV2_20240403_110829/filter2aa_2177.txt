Don’t Fuck It Up!
Zoz
jackdawsart.com
Unjust laws exist: shall we be content to obey 
them, or shall we endeavor to amend them, 
and obey them until we have succeeded, or 
shall we transgress them at once?
—Henry David Thoreau, Civil Disobedience
FUCK IT UP
⇥⇤⌅⇧⌃⌥
Tradecraft
Perceptual Biases
Expectations
Resistance
Ambiguities
Biases In Evaluating 
Evidence
Consistency
Missing Information
Discredited Evidence
Biases In Estimating 
Probabilities
Availability
Anchoring
Overconﬁdence
Biases In Perceiving 
Causality
Rationality
Attribution
Tradecraft
• Key Assumptions Check
• Quality Of Information Check
• Contrarian Techniques
• Devil’s Advocacy
• High Impact/Low Probability
• “What If?” Analysis
• Red Team
OPSEC
Identify Critical Info
Analyze Threats
Assess the Risks
Apply Countermeasures
Analyze  Vulnerabilities
The 7 Deadly Fuckups
• Overconﬁdence
• Trust
• Perceived Insigniﬁcance
• Guilt By Association
• Packet Origin
• Cleartext
• Documentation
Don’t Fuck It Up When You Use A VPN
• Trafﬁc Encryption
• Location Obfuscation
• Request Concealment
• ...Depending On Listener Location
• ...Depending On Provider
⇥⇤⌅⇧⌃⌥
Remember:
PPTP Broken As Of 
Don’t Fuck It Up
When You Use
Case Study: LulzSec/AntiSec
• Don’t Fail Unsafe With Tor
• Always Check What You’re Exposing
• OPSEC Is 24/7
Moral:
Case Study: Harvard Bomb Hoax
What Fucked It Up?
• Harvard Network Registration
• Outgoing Trafﬁc Logs
• Pervasive Surveillance Microcosm
• Moral:
• Key Assumptions Check
• High Impact/Low Probability Analysis
• Bridge Relays
• Trafﬁc Analysis Preparation
Case Study: Silk Road/DPR
What Fucked It Up?
?
ale.
able
ice’s
etely
t of
rrent
dden
elays
crip-
Figure 4.
Hidden service descriptor request rate during one day.
its usage statistics.
As a proof of concept we used this approach to control
one of the six hidden service directories of the discovered
Tor botnet, the Silk Road hidden service, and the Duck-
DuckGo hidden service. We tracked these for several days
and obtained the following measurements: (1) The number
of requests for the hidden service descriptor per day (see
Tables I and II) and (2) the rate of requests over the course
of a day, which is shown in Figure 4 (each point corresponds
to the number of hidden service descriptor requests per one
hour).
C l
1
f T bl
I
d
l
2
d 4
f T bl
II
ght from
infosec/
t-from-
Tor in a
n NDSS
 System
tor-talk]
ject.org/
.
Private
009.
es prob-
Markov
pp. 140–
LEVINE,
passive
mposium
vices by
uter and
7–36.
servers.
rity and
[ 6]
N
, S.,
N
U
OC , S. J.
p oved c oc
skew measurement technique for revealing hidden services.
In USENIX Security Symposium (2008), pp. 211–226.
APPENDIX
A. The Inﬂuence of Shadow Relays on the Flag Assignment
During the second harvesting experiment we accidentally
revealed an important artifact of the ﬂag assignment in Tor
which is not obvious from the Tor speciﬁcations. Near the
end of the experiment we were notiﬁed by the Tor developers
that the Sybil attack had caused a spike in the number of
relays assigned Fast ﬂags and Guard ﬂags (see Fig. 6)
Figure 6.
Increase in the number of Guard nodes.
Biryukov, Pustogarov, Weinmann: 
Trawling for Tor Hidden Services: 
Detection, Measurement, 
Deanonymization, 2013
Don’t Fuck It Up
When You Use The Phone
•
How Does Your Phone Betray You? Let Me Count The Ways...
•
Metadata
•
Location
•
Contacts
•
Networks
•
Unique Identiﬁers
•
Cookies
•
Searches
•
Weak Crypto
•
Repeated Access
•
Autoconnect (Pineapple’s BFF)
•
Apps
•
Pattern Of Life
TOP SECRET//COMINT//REL TO USA, FVEY 
TOP SECRET//COMINT//REL TO USA, FVEY 
Example of  Current Volumes and Limits 
5 
TOP SECRET//COMINT//REL TO USA, FVEY 
TOP SECRET//COMINT//REL TO USA, FVEY 
Dupe Methodology 
Compare records within various time windows that share 
identical selectors and locations, specifically: 
LAC  
 CellID 
 VLR  
 DesigChannelID 
IMEI  
 ESN
 IMSI  
 MIN 
TMSI  
 MDN  
 CLI
 ODN 
MSISDN
 RegFMID
 CdFMID
 CgFMID 
RegGID
 CdGID 
 RegIID 
 Kc 
CdIID  
 CgIID  
 MSRN 
 Rand 
Sres
 Opcode
 RQ1
 XR1
Q_CK1
 Q_IK1 
 AU1
 NewPTMSI 
OSME 
 DSME 
 RTMSI
 PDP_Address 
TEID  
 TLLI  
 PTMSI 
 PDDG 
28 
Perfect Scenario - Target uploading 
photo to a social media site taken 
with a mobile device. 
What can we get? 
TOP SECRETIICOMINT/REL TO USA, FVEY 
11 
• Examine settings of phone as well as service 
providers for geo-Iocation; specific to a certain 
• 
regIon 
• Networks connected 
• Websites visited 
• Buddy Lists 
• Documents Downloaded 
• Encryption used and supported 
• User Agents 
TOP SECRETIICOMINT/REL TO USA, FVEY 
12 
Targeting both Telephony and DNI systems 
• Call Logs 
• SMS 
• SIM Card Leads 
• Email address 
• IMEI/IMSI 
• Unique Identifiers 
• Blackberry PINS 
TOP SECRETIICOMINT/REL TO USA, FVEY 
13 
(U) Converged Analysis of 
Smartphone Devices 
Case Study: CIA/Abu Omar
OCD OPSEC:
Using A Burner Phone Without Fucking It Up
•
DO:
•
Advance Purchase
•
Register Far Away
•
Lie To Phone Companies
•
Stay Dumb
•
Remove Battery
•
Fake Contacts
•
Minimize Use
•
Move & Switch
•
Falsify Call Network
•
Purpose Equipment
•
Thou Shalt Always Kill
OCD OPSEC:
Using A Burner Phone Without Fucking It Up
• DON’T EVER:
• Co-Localize
• Co-Activate
• Co-Contact
• Store Real Data
• Match Entry/Exit
• Bridge Online Metadata
Don’t Fuck It Up
When You Use Messaging
•
After All These Years, E-Mail Still Sucks
•
Spam Fighting Aids Tracking
•
Webmail Using HTTP
•
Weak Server-Side Storage
•
Encrypted Content Not Metadata
•
Insecure Client-Side Logging
•
Bad Retention Habits
•
Google
•
And IM Is Not Much Better
•
Psycho SO Principle
Threadworm in sheep intestine
Case Study: CIA/Petraeus
What Fucked It Up?
•
Technique Already Identiﬁed & Compromised
•
Pervasive Surveillance Designed To Expose Exactly This 
Type Of Access Correlation
•
Deleted Things Aren’t
•
Understand & Manage Insecure Channels
•
Quality Of Information Check, “What If?”
Common Broken/Compromised Services
• Commercial Webmail
• Run Your Own Mailserver
• Metadata’s Still A Bitch
Common Broken/Compromised Services
• Skype
• PRISM, SIGINT Enabling, JTRIG, Forced 
“Upgrades”, Pre-MS EOL
• Fuck Skype
Common Broken/Compromised Services
•
Many Chats
•
Let’s Just Assume IRC Is All Collected
•
Why Not Grab 6667 Like 80?
•
TLS Only Protects You To The Server
•
GChat’s “Off The Record” Isn’t The Same As OTR
•
That First OTR Message
⇥⇤⌅⇧⌃⌥
⇥⇤⌅⇧⌃⌥
What Might Not Be Completely Fucked
•
Some OTR Implementations (But Which Ones?)
•
Cryptocat?
•
Bitmessage?
•
We Need More:
•
Auditing
•
Steganography
Stylometrics: Don’t Fuck It Up
• Resist Providing A Corpus
• Obfuscate
• Machine Translate
• Imitate
• Alpha Tools: JStylo/Anonymouth
Steganography:
Hiding In Plain Sight
Steganography:
Hiding In Plain Sight
⇥⇤⌅⇧⌃⌥⌃
• Reported But Docs Not Released:
• P2P Trafﬁc High Volume/Low Value
• GCHQ TEMPORA Minimizes, 30% Ingest Reduction
• Need To Hide In This Flood
Steganography:
Hiding In Plain Sight
H4x0rz: Lose The Ego
•
Burner Rules For IDs
•
IRL Identity Real And Separate
•
Know & Compartmentalize Pseudonyms
•
Cred Is Another Enemy
•
Really Burn Them, No Really
Don’t Fuck It Up,
And After You Do:
• Contingency Planning
• Plausible Deniability
• Adversary Capability
• Seek Advice In Advance
• Support Those Who Provide It
• Good Luck & Never Surrender To Obedience