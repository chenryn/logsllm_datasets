 0.8
 0.6
 0.4
 0.2
 0
hour
day
week
p  i  m
p i m
1024
1025
1024
1025
1026
1026
redwoo
1024
1025
1026
net-as
1024
1025
1026
i c    m p
i c     m p
i c    m p
net-as
h t t p
h t t p s
20
40
80
320
160
Flow Duration (minutes)
640
1280 2560 5120 10240 20480(cid:10)
others
sapv1
svrloc
ntp
pim
redwoo
isakmp
49180
1027
1028
netbio
1024
1025
1026
sip
6655
4466
8718
ms-wbt
msnp
macrom
net-as
fujits
irdmi
icmp
http
https
n
o
i
t
c
a
r
F
 1
 0.8
 0.6
 0.4
 0.2
 0
hour
day
week
sapv1
9874
8102
sapv1
sapv1
sd
sd
sd
net-as
sd
p   i   m
msnp
snmp
http
icmp
s  n  m  p
p   i   m
msnp
msnp
s  n  m  p
h t t p
i c m p
h  t  t  p  s
i  c  m  p
other
snmptr
8044
isakmp
9874
net-as
h323ga
8102
sip
sapv1
5938
ntp
sd
pim
ipsec-
trivne
47093
aol
msnp
imaps
53181
mmcc
snmp
http
dtpt
icmp
https
20
40
80
320
160
Flow Duration (minutes)
640
1280 2560 5120 10240 20480(cid:10)
Figure 8: Source (left) and destination (right) port usage, plus PIM and ICMP, as a function of time scale
(sampled from D8). Well-known ports are labeled with protocols and protocol colors diﬀer.
 8
 7
 6
 5
 4
 3
 2
 1
 0
-1
hour
day
week
 400
 20
 1
)
s
e
t
y
b
f
o
0
1
g
o
l
(
s
s
e
n
i
t
s
r
u
B
e
c
n
a
i
r
a
V
w
o
F
l
 1
 1.5
 2
 2.5
 3
 3.5
 4
Flow Duration (log10 of minutes)
Figure 9: Density plot (log-scale) of ﬂow duration
vs. burstiness (log-scale variance, bytes ) (sampled
from D8).
dian shows an exponentially decrease at rate −0.296, with a
−0.830 conﬁdence coeﬃcient). Our explanation, conﬁrmed
when we consider causes in Section 4.2, is that long ﬂows
are mostly computer-to-computer communications, and so
are naturally less bursty. One implication of this observa-
tion is for very low-buﬀer routers, which assume input traﬃc
is smooth [1,21]. Low burstiness could be provided with high
probability in segregated long-duration ﬂows.
4.2 Causes of Long-lived Flows
While we observe long-duration ﬂows behave diﬀerently,
we would like to know their causes. Although imperfect,
port-based classiﬁcation is our best tool and Figure 8 shows
fraction of ﬂows by port usage from minutes to weeks. We
treat ICMP and Protocol Independent Multicast (PIM) as
special “ports”.
The result supports our hypothesis: the traﬃc mix switches
from interactive, to background, to computer-to-computer
as time scale increases. Hour time-scales are dominated by
web (HTTP, HTTPS, ports 80 and 443) destinations. Web is
also a frequent source port as well. Although at ﬁrst it may
seem suprising to think about port 80 as a source of traf-
ﬁc, this observation follows because our analysis treats each
side of a bidirectional connection independently, so a port-80
source is the reply-side of a web request Day-long ﬂows con-
tain “background” traﬃc, with computer-driven but human-
initiated protocols like chat and messaging (msnp, aol). We
believe these represent regular application-level keep-alives
and presence reports. Finally, week-long ﬂows are almost all
computer-to-computer protocols that run without human in-
volvement, such as time synchronization (ntp) and multicast
control (sd, pim, sapv1). This trend also shows with a very
strong shift against TCP in the protocol mix at longer time
scales: TCP is 66% through 10 hours, but falls to 16% at
two weeks, where 30% is PIM and 43% UDP.
Another interesting result is that ports 1024 through 1026
are very common sources for long-lived ﬂows. These are
the ﬁrst non-reserved ports and we believe indicate long-
running, started-at-boot daemons.
Although we have identiﬁed the question of causes for
long-lived Internet ﬂows, we have only preliminary answers.
Port-based classiﬁcation schemes are well known to be in-
accurate as many protocols today intentionally use random
ports, so use of other techniques to identify applications is
one direction (potentially those of Kim et al. [15]). Also, car-
rying out similar experiments in other locations, and more
thorough evaluation of causes of long-running ﬂows (proto-
cols or applications) are both important future directions.
5. CONCLUSION
We propose an eﬃcient multi-time-scale IP ﬂow analysis
methodology in this paper, targeting at the long-lived ﬂows.
The characteristics of diﬀerent time scales of ﬂows have been
studied, with ﬂow duration ranging from minutes to weeks.
Our results show that long-lived ﬂows are generally slow run-
ning and non-bursty ingredients of the Internet traﬃc, which
is useful for traﬃc engineering purposes. We also study the
causes of the long-lived ﬂows, and found that unlike short
ﬂows with much human traﬃc, they are mostly computer-
to-computer traﬃc for speciﬁc application purposes.
Acknowledgments
We would like to thank Yuri Pradkin for developing and op-
erating the LANDER infrastructure that enables this work.
We are also grateful to the anonymous reviewers for many
valuable comments on this paper.
449Barman, Michalis Faloutsos, and KiYoung Lee.
Internet traﬃc classiﬁcation demystiﬁed: myths,
caveats, and the best practices. In CoNEXT ’08:
Proceedings of the 2008 ACM CoNEXT Conference,
pages 1–12, New York, NY, USA, 2008. ACM.
[16] H. T. Kung and S. Y. Wang. TCP Trunking: Design,
Implementation and Performance. In IEEE
International Conference on Network Protocols, page
222, Washington, DC, USA, 1999. IEEE Computer
Society.
[17] W.E. Leland, M.S. Taqqu, W. Willinger, and D.V.
Wilson. On the self-similar nature of Ethernet traﬃc
(extended version). ACM/IEEE Transactions on
Networking, 2(1):1–15, February 1994.
[18] Sean McCreary and kc claﬀy. Trends in Wide Area IP
Traﬃc Patterns - A View from Ames Internet
Exchange. CAIDA ITC Specialist Seminar, 2000.
[19] J. Padhye, V. Firoiu, D. Towsley, and J. Kurose.
Modelling TCP Throughput: A Simple Model and its
Empirical Validation. In Proceedings of the ACM
SIGCOMM Conference, pages 303–314, Vancouver,
Canada, September 1998. ACM.
[20] Vern Paxson. Automated Packet Trace Analysis of
TCP Implementations. In Proceedings of the ACM
SIGCOMM Conference, pages 167–179, Cannes,
France, September 1997. ACM.
[21] Anees Shaikh, Jennifer Rexford, and Kang G. Shin.
Load-sensitive routing of long-lived IP ﬂows. In
Proceedings of the ACM SIGCOMM Conference, pages
215–226, Cambridge, MA, USA, September 1999.
ACM.
[22] Kevin Thompson, Gregory J. Miller, and Rick Wilder.
Wide-Area Internet Traﬃc Patterns and
Characteristics (extended version). IEEE Network
Magazine, 11(6):10–23, Nov/Dec 1997.
[23] USC. High-Performance Computing and
Communications. http://www.usc.edu/hpcc/.
[24] Yin Zhang, Lee Breslau, Vern Paxson, and Scott
Shenker. On the characteristics and origins of internet
ﬂow rates. In Proceedings of the ACM SIGCOMM
Conference, pages 309–322, New York, NY, USA,
2002. ACM.
6. REFERENCES
[1] Guido Appenzeller, Isaac Keslassy, and Nick
McKeown. Sizing router buﬀers. In Proceedings of the
ACM SIGCOMM Conference, pages 281–292,
Portland, Oregon, USA, August 2004. ACM.
[2] Daniel Awduche and Yakov Rekhter. Multiprotocol
Lambda Switching: Combining MPLS Traﬃc
Engineering Control with Optical Crossconnects.
IEEE Communications Magazine, 39(3):111–116,
March 2001.
[3] Chadi Barakat, Patrick Thiran, Gianluca Iannaccone,
Christophe Diot, and Philippe Owezarski. A
ﬂow-based model for internet backbone traﬃc. In
Proceedings of the ACM SIGCOMM Internet
Measurement Workshop, pages 35–47, Marseille,
France, October 2002. ACM.
[4] Nevil Brownlee. Some Observations of Internet Stream
lifetimes. In Passive and Active Measurement
Workshop, pages 265–277, 2005.
[5] Nevil Brownlee and kc claﬀy. Understanding Internet
traﬃc streams: Dragonﬂies and tortoises. IEEE
Communications Magazine, 40:110–117, 2002.
[6] Kun chan Lan and John Heidemann. A measurement
study of correlation of Internet ﬂow characteristics.
Computer Networks, 50(1):46–62, January 2006.
[7] Mark E. Crovella and Azer Bestavros. Self-similarity
in world wide web traﬃc: evidence and possible
causes. ACM/IEEE Transactions on Networking,
5(6):835–846, December 1997.
[8] Nick Duﬃeld, Carsten Lund, and Mikkel Thorup.
Estimating Flow Distributions from Sampled Flow
Statistics. In Proceedings of the ACM SIGCOMM
Conference, pages 325–337, Karlsruhe, Germany,
August 2003. ACM.
[9] Cristian Estan, Ken Keys, David Moore, and George
Varghese. Building a better NetFlow. In Proceedings
of the ACM SIGCOMM Conference, pages 245–256,
Portland, Oregon, USA, August 2004. ACM.
[10] Krishna P. Gummadi, Richard J. Dunn, Stefan Saroiu,
Steven D. Gribble, Henry M. Levy, and John
Zahorjan. Measurement, modelling, and analysis of a
peer-to-peer ﬁle-sharing workload. In Proceedings of
the 19th Symposium on Operating Systems Principles,
pages 314–329, Bolton Landing, NY, USA, October
2003. ACM.
[11] K.-P. Ho, H. Dal, C. Lin, S.-K. Liaw, H. Gysel, and
M. Ramachandran. Hybrid
wavelength-division-multiplexing systems for
high-capacity digital and analog video trunking
applications. IEEE Photonics Technology Letters,
10:297–299, February 1998.
[12] Aleﬁya Hussain, Genevieve Bartlett, Yuri Pryadkin,
John Heidemann, Christos Papadopoulos, and Joseph
Bannister. Experiences with a continuous network
tracing infrastructure. In Proceedings of the ACM
SIGCOMM MineNet Workshop, pages 185–190,
Philadelphia, PA, USA, August 2005. ACM.
[13] Qosient Inc. Audit Record Generation and Usage
System (ARGUS). http://www.qosient.com/argus/.
[14] Sling Media Inc. Slingbox: a tv streaming device.
http://en.wikipedia.org/wiki/Slingbox.
[15] Hyunchul Kim, KC Claﬀy, Marina Fomenkov, Dhiman
450