# APT1王者归来？McAfee发布关于Operation Oceansalt的分析报告
##### 译文声明
本文是翻译文章，文章原作者 McAfee，文章来源：mcafee.com
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
## 一、概述
McAfee高级威胁研究小组发现一个针对韩语用户的数据侦察类恶意软件。由于它与早期恶意软件Seasalt（海盐，属于早期的一个中国黑客组织）的相似性，我们将此威胁命名为Operation
Oceansalt（海洋盐，或者洋盐）。Oceansalt重复使用了部分Seasalt的代码，而与活跃在2010年的Seasalt与中国黑客组织Comment
Crew（评论员，即APT1）存在关联。Oceansalt主要针对韩国、美国和加拿大，该恶意软件从两个被入侵的韩国网站（目前已离线）进行分发。Oceansalt疑为APT攻击的第一阶段活动，用于收集系统信息并发送至远程控制服务器，并可以执行相关命令（指令）。目前还不清楚该恶意活动的最终目的。
###  APT1卷土重来？
Comment
Crew（评论员）也被称为APT1，2013年被曝光，据称是中国发起的针对美国的网络间谍活动。当时的报告曝光了该组织的内部工作细节和网络攻击能力，迫使该组织销声匿迹（也可能是改变了技术）。截至本报告之前，我们没有发现该组织的任何新攻击活动，但现在我们在针对韩国的新攻击活动中发现了它的部分代码。
我们对这些重用的代码进行了调查，发现这些源代码既没有被公开发布过，也没有在暗网市场上出售过。所以，APT1真的卷土重来了吗？我们认为这不太可能。没有确凿的证据表明这是APT1的新攻击活动，那到底攻击者是谁呢？根据我们的调查，我们提出了以下几种设想。
1、 两个攻击组织之间达成了某种共享代码的协议
2、 可能是原APT1的某个成员泄露了原始代码，另一个攻击组织获得了这些代码
3、 攻击者故意设置一个False Flag（错误标志），以误导研究人员认为中国和朝鲜共同发起了这些攻击。
### 攻击者是说韩语的吗？
恶意文档的内容是韩文的，其主题与韩国的特定经济项目有关。这些文档看起来是独一无二的，没有在任何公开渠道上出现过。我们无法定位这些文档的来源，这意味着这些文档可能是攻击者创建的。
恶意Office文档的元数据中包含韩语的代码页（code
page）。这意味着该文档包含韩语语言包，很有可能是为了确保受害者可以阅读它。我们还发现恶意文档统一使用了一个作者名字，这是先前我们分析过的针对韩国的恶意文档常用的技术之一。
图1 恶意xls文档的代码页元数据
我们得出结论：这是一个新的恶意软件家族，攻击者主要针对韩语用户，并使用了APT1的部分源代码。此外，攻击者很可能对韩语十分了解。
### 攻击目标
研究表明初始的攻击向量是鱼叉式钓鱼攻击，通过两个恶意的韩文Excel文档下载恶意软件。根据我们的文档分析，这些目标很可能与韩国的公共基础设施项目及其财务信息有关
– 这清楚地表明攻击者的初步攻击主要针对基础设施。
第二轮恶意文档是Word文档，带有相同的元数据和作者信息。文档内容与朝韩合作基金的财务信息有关。恶意活动首次出现于2018年5月31日，出现在韩国。我们的遥测技术表明部分韩国之外的企业也遭到攻击；而到8月14日，攻击的范围扩大了，开始针对加拿大和美国的多个行业。
攻击活动在北美地区的首次出现日期尚不明确。我们没有找到针对加拿大和美国的恶意Office文档，但我们的遥测技术表明部分北美的计算机系统受到影响。针对北美企业的攻击可能只是针对韩国攻击的部分延续（因为触发检测的恶意文档屈指可数，而且它们只传播其中一个恶意软件变体）。根据我们的遥测技术，这些企业可能是投资企业、银行以及农业企业。
### 攻击目的与造成的影响
研究表明这些攻击目标会关注与韩国的公共建设支出、朝韩合作基金以及其它全球经济数据有关的文档。该恶意活动的目标可能是窃取资金。鉴于攻击者在受害者中获得的控制权限，这些攻击可能只是大规模破坏性攻击的前奏。该恶意活动的影响是巨大的：Oceansalt使得攻击者获得了目标系统及其网络的完整控制权限。如果是一个银行的内部网络，攻击者就可能获得巨额利益。
此外，其代码与先前的一个国家资助的APT组织有重叠。这种代码重用意味着该国家资助的APT组织成员与当前网络攻击活动的攻击者存在密切的联系。
## 二、恶意活动分析
该恶意活动起始于韩国，随后扩展至全球。恶意文档中的恶意软件分发链接一直保持一致性；攻击者可能是入侵了多个韩国网站来托管这些恶意代码。
### 第一波攻击：针对韩国的高等教育行业
第一波攻击中的恶意文档创建于5月18日，最后保存日期为5月28日。该韩文文档的作者是Lion，之后的文档中我们将经常看到这个名字。
图2 第一波攻击中的恶意文档元数据
第一波攻击中的恶意文档包含韩国姓名、物理住址和电子邮件地址的列表。这些名字属于韩国高等教育行业中的人或是各个研究院的人。该列表看起来是随机的，似乎是从政府的某个个人信息数据库中复制得到。
该恶意文档中还包含宏代码，用于从[www.[redacted].kr/admin/data/member/1/log.php](http://www.%5Bredacted%5D.kr/admin/data/member/1/log.php)
下载恶意软件，并伪装成韩国一个安全产品的名字（V3UI.exe）来执行。
### 第二波攻击：针对韩国的公共基础设施
我们的研究团队发现该恶意软件托管在一个合法的韩国网站上（属于一个音乐教师协会，与恶意文档并无任何关联）。攻击者通过一个PHP页面来完成恶意软件的分发，当用户打开2种恶意的Excel文档时，其内置的Visual
Basic宏就会连接到该页面，下载和运行恶意软件。在第一波攻击发生时，韩国的一个企业将该恶意文档的样本提交给了我们。
图3 第二波攻击中的恶意软件下载链接
Excel文档的创建者是Lion，创建日期是5月31日，正好是恶意软件被编译和托管在网站上的前一天。这些文档的内容与韩国的公共基础设施项目及其开支有关。根据我们的分析，这明确意味着攻击者的兴趣是针对与韩国这一领域有关的个人。
图4 第二波攻击中的恶意文件元数据
图5 恶意文档一：公共基础设施项目中的投资趋势
图6 恶意文档二：公共基础设施项目中的开支
图7 恶意文档三：公共项目开支报表
这一波攻击中最后一个文档的创建者仍然是Lion，创建日期是6月4日，文件名为0.온나라_상용_SW_2018년
대상_list_(20180411)_지역업체.xls。该文档伪装成韩国行政安全部Onnara的文件（该部门主要负责土地和开发）。
### 第三波攻击：朝韩合作
第三波攻击中的Word文档与Excel文档包含相同的宏代码。这些文档伪装成朝韩合作基金的财务信息，其创建时间与第二波攻击相同。此外，不管是Excel还是Word，其作者都是Lion。这一次恶意软件通过另一个韩国网站进行分发。新出现的Excel文档包含与Word文档内容有关的电话号码和联系人信息。
图8 第三波攻击中的恶意软件分发链接
图9 （假）朝韩合作基金的月度统计报告
图10 （假）朝韩合作基金的月度统计报告
图11 虚假的产品和合伙人信息
### 第四波攻击：针对韩国之外的目标
在韩国之外，我们发现了一小部分受到攻击的目标，疑为攻击者扩大了它的攻击范围。我们还没有发现用于下载恶意软件的恶意文档。由于攻击者在第一波和第二波攻击中使用了不同的恶意软件分发服务器，我们认为这一波攻击也有自己的分发服务器。根据McAfee的遥测数据，8月10日至14日期间，北美地区的多个行业受到攻击：
    行业
|
    国家  
---|---  
金融
|
美国  
医疗
|
美国  
医疗
|
美国  
电信
|
加拿大  
金融
|
美国  
农业和工业
|
美国  
金融
|
美国  
电信
|
加拿大  
金融
|
加拿大  
金融和技术企业
|
美国  
政府机构
|
美国  
图12 第四波攻击中的受害者
### 第五波攻击：针对韩国和美国
Oceansalt不仅仅只有一个样本。我们在不同的控制服务器上发现了多个不同的变体。这些变体使用了混淆技术来逃避检测。这些样本与初始Oceansalt样本几乎完全相同。第五波攻击中的样本是在7月13日至7月17日期间编译的，并由韩国和美国的企业提交给我们。
哈希 | 编译日期 | 控制服务器  
---|---|---  
38216571e9a9364b509e52ec19fae61b | 6/13/2018 | 172.81.132.62  
531dee019792a089a4589c2cce3dac95 | 6/14/2018 | 211.104.160.196  
0355C116C02B02C05D6E90A0B3DC107C | 7/16/2018 | 27.102.112.179  
74A50A5705E2AF736095B6B186D38DDF | 7/16/2018 | 27.102.112.179  
45C362F17C5DC8496E97D475562BEC4D | 7/17/2018 | 27.102.112.179  
C1773E9CF8265693F37DF1A39E0CBBE2 | 7/17/2018 | 27.102.112.179  
D14DD769C7F53ACEC482347F539EFDF4 | 7/17/2018 | 27.102.112.179  