你的智能硬件出卖了你的信息
—浅谈办公及教育场景硬件供应链安全
0 1
议程
• IoT产品供应链的安全现状
• 常见的保护机制及实现缺陷
• 如何避免缺陷，保护供应链安全
0 4
IoT产品供应链安全现状
金立2千多部手机被植入木马
软件供应链攻击易受关注，而
硬件供应链在流通环节的攻击，
非常容易被忽视。
0 5
IoT产品供应链安全现状
国内外的相关规范
0 7
IoT产品供应链安全现状
业界的做法
主流的桌面处理器、服务器、
笔电、操作系统厂商，很早就
实现了安全启动，可信计算等
机制。
0 8
IoT产品供应链安全现状
移动处理器厂商
高通、MTK等IoT
常用方案厂商都提
供了完整的
SecureBoot、TEE
的实现支持，提供
了可靠的保护机制。
0 9
在我们的研究中，累计发现5个头部厂商的9款IoT产品（芯片方案有完整
的安全启动支持），存在设计缺陷，导致产品可以在供应链流通环节被
植入恶意代码。
IoT产品供应链安全现状
实际落实到IoT产品端的情况
IoT产品供应链安全现状
10
攻击需要物理接触，
厂商不重视，不认可
只是缺陷，不是漏洞
IoT产品供应链安全现状
11
复杂的供应链网络，导
致产品在到达客户之前
的流通环节，存在大量
被供应链植入的时间窗
口。
虽是缺陷，后果严重
12
智能盒子
智能电视
会议终端
IoT产品供应链安全现状
虽是缺陷，后果严重
窃取商业机密
13
IoT产品供应链安全现状
虽是缺陷，后果严重
没有安全保护的教
育硬件，可能被破
解改变产品原有设
计用途，变身为游
戏机、浏览不良信
息的媒介等。
14
智能音箱
智能教育屏
智能学习灯
IoT产品供应链安全现状
虽是缺陷，后果严重
监控家庭敏感地带
15
IoT产品供应链安全现状
某教育产品供应链植
入风险演示
16
常见的保护机制及实现缺陷
常见的保护机制及实现缺陷
17
Android ROM
常见的保护机制及实现缺陷
18
Secure Boot
核心思想：当前阶段的启动代码加载下一级代码之前，对
所加载的代码基于PKI进行完整性校验。
常见的保护机制及实现缺陷
19
信任根
所有支持 Secure Boot的CPU都会有
一块很小的OTP储存，也称为 FUSE
或者eFUSE，它的工作原理跟现实中
的保险丝类似：在芯片出厂之前会
被写入信息，一旦被写入便无法被
更改
常见的保护机制及实现缺陷
22
DM-Verity
•
对于小分区，会使用信
任根进行直接或间接签
名的。
•
对于较大的分区，比如
system分区，与预置的
root hash进行比对验证。
常见的保护机制及实现缺陷
23
信任根 -> Boot Verify -> DM Verity
牢不可破？
常见的保护机制及实现缺陷
25
绕过 SECURE BOOT
90%以上均未烧写eFuse
可以直接绕过
虽然安全启动没开，但是
从BootLoader向下的保护
机制可能是开启的，需要
拿到固件，分析保护逻辑。
常见的保护机制及实现缺陷
26
没有开启安全启动，
利用芯片厂商工具读写整个磁盘固件（MTK）
绕过 SECURE BOOT
常见的保护机制及实现缺陷
27
没有开启安全启动，
利用芯片厂商工具
读写整个磁盘固件
（ QUALCOMM3）
绕过 SECURE BOOT
常见的保护机制及实现缺陷
28
•
frp
•
seccfg
seccfg结构体
seccfg body 结构体
通过固件分析绕过Boot Verify
常见的保护机制及实现缺陷
29
通过固件分析绕过Boot Verify
常见的保护机制及实现缺陷
30
通过固件分析绕过DM-Verity
常见的保护机制及实现缺陷
31
使能adb
禁用SE-Linux
获取 adb root
shell
set property
ro.debuggable = 1
…
androidboot.selinux=permissive
ro.secure = 0
Gain Full Access
Get Full Access
常见的保护机制及实现缺陷
32
某会议盒子供应链植入风险
演示
33
如何避免缺陷，保护供应链安全
如何避免缺陷，保护产品安全
35
•
安全意识，认为接触式攻击不属于漏洞
•
芯片成本，支持安全启动的芯片增加成本
•
研发成本，不想在保护机制上投入人力物力
•
维修成本，开启安全启动增加维修难度
部分厂商的现状
提高安全意识，将安全特性支持考虑到产品基础成本里。
如何避免缺陷，保护产品安全
36
•
采用巧妙的后门，隐藏调试开关。
•
对控制调试的程序进行混淆加密，增加分析成本。
•
在底层Framework上，定制程序的安装逻辑，对抗植入。
部分厂商的保护方案
完美的保护机制也需要在根源上做到安全。
如何避免缺陷，保护产品安全
34
需求
设计
EVT
DVT
PVT
售卖
硬件产品不同阶段的缺陷修复需要付出的代价
安全应该尽早的介入到
硬件产品的设计研发流
程中。
如何避免缺陷，保护产品安全
37
通过建立IoT产品SDLC流程，在立项
阶段就进行安全介入，解决上线后不
可召回的漏洞，避免产品遭受供应链
植入攻击。
立项
Souring
EVT
DVT
PVT
IoT SDLC
M        A        N        O        E        U        V        R        E
感谢观看！