5.2%
6.5%
9.4% 13.3% 1.7%
30.2% 13.3% 9.6%
7.5% 0.0% 0.7%
3.8% 0.0% 4.0%
9.4% 26.7% 1.1%
3.8% 20.0% 3.0%
PPI
Mining SW
Both
Obfuscation
CNAMEs
Proxies
+ Apr-18
+ Oct-18
+ Mar-19
Start: 2014
Start: 2015
Start: 2016
Start: 2017
Start: 2018
Start: 2019
Years: 0
Years: 1
Years: 2
Years: 3
Years: 4
24.6%
9.1%
2.7%
0.2%
0.2%
5.5%
37.3%
51.7%
0.5%
69.6%
28.0%
2.2%
0.2%
0.0%
57.8%
27.3%
13.0%
4.5%
1.9%
26.0%
51.3%
13.0%
2.6%
11.0%
57.8%
24.7%
3.2%
3.2%
49.1% 33.3% 27.6%
18.9% 33.3% 10.7%
5.7% 13.3% 3.5%
11.3% 46.7% 0.2%
3.8% 13.3% 0.2%
41.5% 40.0% 5.0%
41.5% 0.0% 33.6%
1.9% 0.0% 46.6%
0.0% 0.0% 0.4%
1.9% 0.0% 62.7%
41.5% 6.7% 25.2%
39.6% 20.0% 2.0%
7.5% 20.0% 0.2%
9.4% 53.3% 0.0%
TABLE XI: Summary of infrastructure, techniques and period
of activity for the different campaigns targeting Moneros
grouped by proﬁt.
for 1 or 2 years and still having large proﬁts. We also note
the percentage of campaigns active before and after changes
in the PoW (Proofs-of-Work): on 06/04/2018, 18/10/2018
and 09/03/2019. These changes require the update of mining
software. This means that either botnet operators have to
update their bots, or customers of PPI services must buy new
installs. We show that most of the campaigns stopped due to
PoW updates: around 72.4% in April 2018, 89.3% in October
2018 and 96.5% in March 2019.15 This means that changes in
the PoW algorithm might be an effective (though unwitting)
countermeasure, as discussed in §VI.
F. Take-Aways
In summary, the main take-aways of our analysis include:
1) We observe that it is no longer proﬁtable to mine Bitcoin,
and current criminal efforts focus on mining ASIC-resistant
currencies. We also show that there are a small number of
actors that monopolize the crypto-mining malware ecosys-
tem. Recent works found similar conclusions in web-based
cryptojacking [8], [9] and crypto-mining malware targeting
Bitcoin [15] (although this study was from 2014, when mining
Bitcoin using desktop computers was proﬁtable).
2) We note that some successful mining campaigns are very
complex in terms of the size and infrastructure supporting
the campaign. Our data shows that about 11% of these are
supported by other underground economies such as third-party
Pay-Per-Install botnets. On the contrary, we also observe very
proﬁtable mining campaigns that do not appear to use a large
supporting infrastructure. Instead, they are effective campaigns
15Given that our data is from April 2019, some of these campaigns might
not be defunct, since it might take some time to update the miners.
12
(due to their long lifetime) with obfuscation and novel evasion
techniques, e.g.: using CNAMEs to bypass blacklist-based
detection.
3) We estimate that the malicious ecosystem has currently
mined at
least 4.37% of the total Monero in circulation
(approximately 58M USD). These numbers must be added to
estimations made using web-browser cryptojacking in paralell
work.
4) It is common to see campaigns mining in various pools.
We observe that the most popular mining pools are crypto-
pool, dwarfpool and minexmr. We show that a large number of
samples mine to minergate, an opaque mining pool for which
there is no publicly-available information about the rewards
received.
5) When looking at the activity period, we ﬁnd long-lasting
campaigns — some of which are active at the time of writing.
In particular, we can see multi-million campaigns operating
for a continuous period of more than four years (see Top-
10 in Table VIII). This shows that AVs have not addressed
this threat appropriately. We argue that crypto-mining malware
has not been given enough attention by the industry and the
research community and novel countermeasures are required
as discussed in §VI.
We next present
V. CASE STUDIES
two case studies related to high-proﬁt
campaigns that have not been previously reported. Fig. 6
presents an overview of how the campaigns are structured. In
the graphs, nodes in blue represent wallets and nodes in light-
green represent malware miners. Thus, various light-green
nodes connected to a blue node represent a group of samples
using the same wallet. Nodes in gray and pink represent the
infrastructure of the campaign, with gray nodes portraying
contacted domain servers and the pink ones the malware hosts.
Finally, ancillary malware are depicted in red and orange. The
edges represent the connections described in §III-E.
A. The Freebuf Campaign
The most proﬁtable Monero campaign (C#627 in Ta-
ble VIII) has mined more than 163K XMR in 3 years using
7 wallets. We have named it ‘Freebuf’ because the main
grouping feature is the domain xt.freebuf.info, which is an alias
(CNAME) of the minexmr pool.
Structure. Figure 6 shows how the campaign is structured. We
observe that the aggregation is dominated by three grouping
features: (i) same identiﬁer, (ii) ancestors, and (iii) domain
aliases (CNAMEs). Interestingly, the graph of this campaign
reveals groups of samples with wallets that reach out to one
another through paths traversing these three grouping features.
In other words, the three grouping features are the key to
map the structure of the campaign. In particular, there are two
domains linked through a common wallet: x.alibuf.com and
xmr.honker.info, which in turn are connected to xt.freebuf.info.
Note that both have been aliases of minexmr, and x.alibuf.com
has also been an alias of crypto-pool. We can observe that
the backbone of the graph is established through connections
of samples linked to CNAMEs. From there, there are other
clusters that are linked via same identiﬁer, and to those, there
are some samples which are connected by common ancestors.
Payments. By analyzing the different payments received
through time, we observe that before the update of the PoW
in April 2018, this campaign was mining in various pools
simultaneously. However, after the update all mining efforts
were put into minexmr. In September 2018 we reported the
wallets to the largest pools, resulting in two wallets being
banned in October 2018. Upon request, one pool operator
kindly provided us with statistics regarding the number of
different IPs behind the wallets. The two banned wallets
connected from 5,352 and 8,099 different IPs and had mined
362.6 and 1,283.7 XMR respectively. As a consequence of
banning, we observe that
the campaign operator decided
to move their mining efforts to another pool (ppxmr) —
which indeed was used before the update on April 2018. We
visualize these payments in Figures 7 and 8 from Appendix E.
We have seen that as a result of this intervention, together
with the change in the PoW algorithm in October 2018, the
payments received by the wallets associated to this campaign
have been considerably reduced.
B. The USA-138 Campaign
We have also named this campaign following the name
of the CNAME that characterizes this campaign: xmr.usa-
138.com. Overall, this campaign has mined (at least) 7,242
XMR and it has 137 samples and 4 wallets. None of the
samples from the campaign are known mining software and
the campaign does not use proxies. Recall that this campaign
is still active at the time of writing in December 2018. Out of
all the samples, 43 are obfuscated with UPX.
Structure. Figure 6b shows how this campaign is structured.
We see that
there are two clusters of samples connected
through a common host (221.9.251.236). This host, which
operates in China, is still online at the time of writing and it
is still hosting the malware used to run the criminal operation.
One of the wallets (on the left-most side of the graph) is an
Electroneum (ETN) wallet (another cryptocurrency based on
the CryptoNote algorithm). The remaining wallets are Monero.
We observe a domain, 4i7i.com, which is used both as a
domain alias (pool.4i7i.com) for crypto-pool, and as a malware
host (e.g., hxxp://4i7i.com/11.exe). We note that the samples
using the Electroneum wallet connect to a pool in etn.4i7i.com.
This domain is probably the domain alias of a Electroneum
pool, but we are unable to ﬁnd passive DNS data.
Payments. As mentioned,
the campaign has mined 6,709
the amount
XMR (around 651K USD). When looking at
of earnings made with the Electroneum wallet, we observe
earnings of 314,18 ETN. The equivalent of this is currently
less than 5 USD. While this might seem little at the moment, it
might be worth much more in the future. Regarding Monero,
this campaign mainly relies on minexmr and crypto-pool.
As depicted in Figure 6c, the most active wallet (named as
49e9B8H...) operated mainly with minexmr after the April
13
(a) The Freebuf campaign (C#627).
(b) The USA-138 campaign.
Fig. 6: Overview of the analysis of our case studies. For Fig. 6c, the dashed red lines correspond to the two changes in the
Monero PoW algorithm. Dashed blue lines show the day when the wallets were banned in minexmr.
(c) Payments per wallet for USA-138.
2018 update. Once again, we reported the wallets to the pools
and soon after we found a similar behavior as with the Freebuf
campaign: after the wallet was banned in minexmr the malware
operators moved to crypto-pool again. Different to Freebuf,
this campaign ‘survived’ the PoW change in October 2018
and is still receiving payments from this pool.
When looking at the number of connections made by the
samples using the wallet 49e9B8H... to the minexmr pool, we
observed over 13K IPs. These samples have been mining after
the update in April’18. This indicates that the campaign uses
a medium-sized botnet which is kept updated.
VI. DISCUSSION
In this section, we analyze existing countermeasures, pre-
senting their main challenges and weaknesses and looking at
potential directions to address this challenge. We also discuss
the limitations of our work.
Reporting illicit wallets. Reporting illicit wallets to the pools,
while being a common — and important — practice [16], is
not an effective countermeasure. First, it is costly and requires
cooperation and coordination from all (or at least the main)
pool operators. Second, criminals have developed mechanisms
to bypass detection (e.g., using mining proxies). During our
study, we have reported the illicit wallets we found to the
largest pools, together with evidence of criminal behavior. We
found two issues. First, there are non-cooperative pools that
chose not to ban wallets found within crypto-mining malware;
and second, those that are cooperative pools tend to err on
the safe side. For example, the pool minexmr, while being
remarkably cooperative, has a policy that only blocks wallets
14
	122.114.99.123122.114.99.123xmr.honker.infoxmr.honker.infoxt.freebuf.info-x.alibuf.comxt.freebuf.info-x.alibuf.com	101.96.10.32101.96.10.32121.169.81.138121.169.81.138pool.4i7i.compool.4i7i.comUSA-138.COMUSA-138.COM121.12.125.122121.12.125.122221.9.251.236221.9.251.236http://4i7i.com/11.exehttp://4i7i.com/11.exe103.27.187.135103.27.187.135with a large number of associated connections. Recall that
there are criminals that leverage on a small set of machines
(i.e., proxies) to hide botnet-related mining activity. Thus, only
banning botnet-related mining activity proves ineffective.
Additionally, we found that many successful campaigns
use several pools at the same time. While this practice has
drawbacks for criminals (mining workers compete with each
other), it also makes their campaigns more resilient to take-
down operations. Criminals respond to such take-downs by
changing the mining pool being used (as we have seen in the
case studies presented in §V) or by creating new wallets and
setting proxies up [17].
Changes in the Proof-of-Work algorithm. ASIC-based min-
ing uses hardware support customized for speciﬁc algorithms
to compute the faster PoWs [19]. Frequent changes in the
algorithm are intended to hinder ASIC-based mining, due
to the cost of creating new hardware with each change.
These changes also require updates in the software, which
is straightforward for benign miners. However, in the case of
crypto-mining malware, it requires botnet operators to update
their bots. In turn PPI users have to purchase further installs to
push the updated version of their miners. We have monitored
three changes in the PoW of Monero: April 6th, 2018, October
18th, 2018 and in March 9th, 2019. In each change, about
72%, 89% and 96% of the campaigns ceased their operations.
Due to the cost of updating the mining infrastructure, we
observe a large number of campaigns not providing valid
shares after changes in the mining algorithm (i.e. due to mining
with an outdated algorithm). This does not mean that the
mining has ceased: a non-updated miner does not provide
valid hashes, but it is still mining using infected computers.
Thus, the victim is still being harmed as long as the mining
continues.
Although changes in the algorithms do not dismantle con-
solidated campaigns, they can dissuade new ones. Thus, a
potential countermeasure against crypto-mining malware is to
increment the frequency of such changes, and design these
changes to not only be anti-ASIC, but also anti-botnet.
Security by design and liability. In addition to non-coopera-
tive pools, we have observed that a large number of samples
mine through opaque pools. We position that the community
should work on devising protocols that enforce transparency
to nodes that act as pools. Mining is a process which requires
cooperation from the miners, who get rewards in exchange.
Similarly, a potential solution would be to design protocols
or techniques that reward transparent and cooperative pools.
Likewise, pools could also improve the mechanisms they use
to detect malicious miners, and the actions they take against
them. Additionally, we argue that a legal framework should
be formulated to regulate the pool industry.
Third-party infrastructure. We observe that most mining
campaigns use third-party infrastructure, both illicit and le-
gitimate. The former includes PPI services, malware packers
or private mining pools allowing botnets to mine. The latter
includes cloud hosting services such as Dropbox or AWS, and
stock mining tools such as xmrig or claymore-tool. During our
analysis, we have observed proﬁcient campaigns making use
of both types. Using public OSINT, we have analyzed IoCs
observed in the samples to associate them to known third-party
infrastructure. In particular, we have observed three known PPI
services (i.e. Virut, Nitol and Ramnit) used by campaign opera-
tors to spread their miners across 355K malware variants using
known packers. However, we have learned about third-party
infrastructure (e.g., non-reported botnets, custom malware
obfuscators or bullet-proof hosting servers) being offered in
underground markets. Thus, a limitation of our approach is that
campaigns that use such unknown third-party infrastructure
(i.e., for which there is no OSINT information) can be grouped
together. Detecting such new third-party infrastructure is out of
the scope of this study, since this requires investigating each
campaign separately and applying other type of intelligence
— by further investigating tools exchanged in underground
markets or inﬁltrating these campaigns. Having said it, we
have argued that having campaigns grouped by unknown third-
party infrastructure, while it hinders our ability to account
for the number of individual actors, it is nonetheless useful
for law enforcement when prioritizing take-downs and for
security practitioners when understanding the magnitude of
the problem and devising novel mitigation strategies.
Quality of the ground-truth. One obvious countermeasure
to this threat is to keep educating users to have updated AVs.
This countermeasure requires AVs — provided the magnitude
of the threat — to have a very comprehensive dataset of
signatures. However, judging by the activity period of some
of the campaigns we have seen that AV vendors have not
been up to this task. This is a known limitation of the Threat
Intelligence industry [24].
Likewise, in our work, we rely on different independent
AV vendors to set our ground-truth. This might introduce two
types of errors that limit our work: False Positives (FP), where
a legitimate sample is erroneously ﬂagged as malware, and
False Negatives (FN), where malware is ﬂagged as legitimate.
Moreover, the boundaries between ‘malicious’ and ‘legitimate’
samples are unclear: a legitimate mining software, when used
maliciously in infected computers (i.e. without user consent)
might be considered malware (and indeed, most AV classify
these tools as malware). We note that establishing an optimal
trade-off between benign and malicious mining is not straight-
forward [9], [8].
We deal with FP by setting up a relatively high number of
positive detections (i.e., 10 AVs).16 However, by doing this we
are also introducing FN. In this paper, we err on minimizing
the number of FP knowing that our ﬁndings have to be seen
as an under-approximation of the current threat.
We would like to explore a more greedy trade-off by setting
the number of positive detections to lower values (e.g., 5
AVs). We argue that this should not incur into many FPs
16There is one exception to this: we keep a sample with less than 10 AV
positives when it contains a wallet observed in another sample having 10 or
more AV positives.
15
as we have introduced a white-listing of known mining tools
— which are more prone to be misclassiﬁed. In addition, we
note that these tools do not contain hard-coded wallets and/or
Stratum connections are not observed when run alone in a
sandbox. Exploring this in detail is precisely the scope of