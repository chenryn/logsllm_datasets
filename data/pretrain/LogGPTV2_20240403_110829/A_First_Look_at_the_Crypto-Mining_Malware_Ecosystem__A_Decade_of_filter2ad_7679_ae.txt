### Table XI: Summary of Infrastructure, Techniques, and Period of Activity for Different Campaigns Targeting Monero, Grouped by Profit

| PPI | Mining SW | Both | Obfuscation | CNAMEs | Proxies |
| --- | --- | --- | --- | --- | --- |
| 5.2% | 6.5% | 9.4% | 13.3% | 1.7% |  |
| 30.2% | 13.3% | 9.6% |  |  |  |
| 7.5% | 0.0% | 0.7% |  |  |  |
| 3.8% | 0.0% | 4.0% |  |  |  |
| 9.4% | 26.7% | 1.1% |  |  |  |
| 3.8% | 20.0% | 3.0% |  |  |  |

**Campaign Start Dates:**
- April 2018
- October 2018
- March 2019
- 2014
- 2015
- 2016
- 2017
- 2018
- 2019

**Years Active:**
- 0 years
- 1 year
- 2 years
- 3 years
- 4 years

### Analysis of Campaigns

#### Summary of Infrastructure, Techniques, and Period of Activity

We observe that some campaigns have been active for 1 or 2 years and still generate significant profits. The table below shows the percentage of campaigns active before and after changes in the Proof-of-Work (PoW) algorithm, which occurred on 06/04/2018, 18/10/2018, and 09/03/2019. These changes require updates to the mining software, meaning botnet operators must update their bots, or customers of PPI services must purchase new installs.

| PoW Change Date | Percentage of Campaigns Stopped |
| --- | --- |
| April 2018 | 72.4% |
| October 2018 | 89.3% |
| March 2019 | 96.5% |

This indicates that changes in the PoW algorithm can be an effective, albeit unintentional, countermeasure against crypto-mining malware.

### Key Takeaways from Our Analysis

1. **Shift in Cryptocurrency Mining:**
   - Bitcoin mining is no longer profitable, and current criminal efforts focus on ASIC-resistant currencies.
   - A small number of actors monopolize the crypto-mining malware ecosystem. Recent studies have found similar trends in web-based cryptojacking and Bitcoin-targeting malware.

2. **Complexity of Successful Campaigns:**
   - Some successful mining campaigns are supported by extensive infrastructure, including third-party Pay-Per-Install (PPI) botnets (approximately 11%).
   - Conversely, other highly profitable campaigns do not use large supporting infrastructures but instead rely on obfuscation and novel evasion techniques, such as using CNAMEs to bypass blacklist-based detection.

3. **Estimated Earnings:**
   - We estimate that the malicious ecosystem has mined at least 4.37% of the total Monero in circulation, equivalent to approximately $58M USD. This figure should be added to estimates from web-browser cryptojacking.

4. **Mining Pools:**
   - Commonly used mining pools include cryptopool, dwarfpool, and minexmr.
   - Many samples mine to minergate, an opaque pool with no publicly available information about rewards.

5. **Long-Lasting Campaigns:**
   - We find long-lasting campaigns, some active for over four years. For example, multi-million-dollar campaigns (see Top-10 in Table VIII) indicate that antivirus solutions have not effectively addressed this threat.
   - Crypto-mining malware has not received sufficient attention from the industry and research community, necessitating novel countermeasures.

### Case Studies

#### The Freebuf Campaign

- **Profit:** Over 163K XMR in 3 years using 7 wallets.
- **Structure:**
  - Aggregation dominated by three features: same identifier, ancestors, and domain aliases (CNAMEs).
  - Key domains: xt.freebuf.info, x.alibuf.com, xmr.honker.info.
  - Connections established through CNAMEs, same identifiers, and common ancestors.
- **Payments:**
  - Before the PoW update in April 2018, the campaign mined in multiple pools.
  - After the update, all efforts were directed to minexmr.
  - In September 2018, two wallets were banned, leading to a shift to ppxmr.

#### The USA-138 Campaign

- **Profit:** At least 7,242 XMR with 137 samples and 4 wallets.
- **Structure:**
  - Two clusters connected through a common host (221.9.251.236), operating in China.
  - Domains: 4i7i.com (used as a domain alias and malware host).
  - One Electroneum (ETN) wallet and three Monero wallets.
- **Payments:**
  - Mainly relies on minexmr and cryptopool.
  - After the wallet was banned in minexmr, the campaign shifted to cryptopool.

### Discussion

#### Existing Countermeasures and Challenges

1. **Reporting Illicit Wallets:**
   - Common practice but costly and requires coordination among pool operators.
   - Criminals use mechanisms like proxies to bypass detection.
   - Non-cooperative pools and those erring on the safe side limit the effectiveness of this approach.

2. **Changes in PoW Algorithm:**
   - Frequent changes hinder ASIC-based mining and require software updates.
   - Botnet operators must update their bots, and PPI users must purchase new installs.
   - Changes in PoW lead to a significant reduction in active campaigns (72%, 89%, and 96% stopped after recent updates).

3. **Security by Design and Liability:**
   - Transparency and cooperation among pools should be enforced.
   - Legal frameworks should regulate the pool industry.
   - Opaque pools and non-cooperative pools pose challenges.

4. **Third-Party Infrastructure:**
   - Most campaigns use both illicit and legitimate third-party infrastructure.
   - Known PPI services (e.g., Virut, Nitol, Ramnit) and cloud hosting services (e.g., Dropbox, AWS) are commonly used.
   - Limitations in detecting unknown third-party infrastructure.

5. **Quality of Ground-Truth:**
   - AV vendors need comprehensive datasets, but some campaigns remain undetected.
   - False Positives (FP) and False Negatives (FN) are potential issues.
   - Balancing between benign and malicious mining is challenging.

### Conclusion

Our analysis highlights the evolving landscape of crypto-mining malware, particularly the shift towards ASIC-resistant currencies and the complexity of successful campaigns. While existing countermeasures have some impact, more robust and innovative solutions are needed to address this growing threat.