# The Ad Wars: Retrospective Measurement and Analysis of Anti-Adblock Filter Lists

**Authors:**
- Umar Iqbal, The University of Iowa
- Zubair Shafiq, The University of Iowa
- Zhiyun Qian, University of California-Riverside

## Abstract
The growing popularity of adblockers has led online publishers to deploy anti-adblock scripts, which detect and block users who use adblockers. To counter these anti-adblock scripts, adblockers rely on manually curated anti-adblock filter lists. These filter lists are updated based on informal crowdsourced feedback from users. This paper presents the first comprehensive study of anti-adblock filter lists, analyzing their effectiveness against anti-adblockers. We compare and contrast the evolution of two popular anti-adblock filter lists, showing that despite having a similar number of rules, they are implemented differently. Using the Internet Archive’s Wayback Machine, we conduct a retrospective coverage analysis of these filter lists on Alexa's top 5,000 websites over the past five years. Our findings indicate that the coverage of these filter lists has significantly improved since 2014, with about 9% of the top 5,000 websites now being detected. To enhance filter list coverage and expedite the addition of new rules, we also develop a machine learning-based method for automatically detecting anti-adblock scripts using static JavaScript code analysis.

## CCS Concepts
- Security and privacy → Browser security; Web application security

## Keywords
Adblocking, Anti-Adblocking, JavaScript, Machine Learning, Privacy, Static Code Analysis, The Wayback Machine

## ACM Reference Format
Umar Iqbal, Zubair Shafiq, and Zhiyun Qian. 2017. The Ad Wars: Retrospective Measurement and Analysis of Anti-Adblock Filter Lists. In Proceedings of IMC '17, London, United Kingdom, November 1–3, 2017, 13 pages. https://doi.org/10.1145/3131365.3131387

## Permission
Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for components of this work owned by others than ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Request permissions from permissions@acm.org.

IMC '17, November 1–3, 2017, London, United Kingdom
© 2017 Association for Computing Machinery.
ACM ISBN 978-1-4503-5118-8/17/11. . . $15.00
https://doi.org/10.1145/3131365.3131387

## 1. Introduction
Millions of users worldwide use adblockers on desktop and mobile devices [31]. Adblockers help users eliminate intrusive and malicious ads, improve page load performance, and protect their privacy. Since online publishers primarily rely on ads for revenue, the widespread use of adblockers has resulted in significant financial losses [56]. To recoup these losses, online publishers have adopted two main strategies:

1. **Acceptable Ads Program**: Many publishers and advertisers participate in the acceptable ads program [1], which allows their ads to be whitelisted if they meet certain criteria. While small and medium-sized publishers can join for free, large publishers must pay about 30% of the additional revenue generated by whitelisting. Popular adblockers like Adblock Plus use the acceptable ads filter list to whitelist compliant ads. However, there are concerns about the transparency and criteria of the whitelisting process [66].

2. **Anti-Adblock Scripts**: Publishers use anti-adblock scripts to detect and block users with adblockers, often prompting them to disable the adblocker, whitelist the website, or make a donation. These scripts are provided by vendors such as PageFair and Outbrain, as well as community scripts from the IAB and BlockAdblock.

Adblockers employ anti-adblock filter lists to remove these scripts and notifications. Despite their importance, little is known about the origin, evolution, and effectiveness of these filter lists. This paper addresses this gap by presenting a comprehensive study of anti-adblock filter lists, including a retrospective measurement of their coverage over time and the development of a machine learning-based method to automatically detect anti-adblock scripts.

## 2. Background & Related Work
### 2.1. Background
Online tracking, conducted through cookies, beacons, and fingerprinting, raises significant privacy and surveillance concerns [44]. To combat these issues, users can block trackers and advertisements. Tracker blockers, such as Ghostery [22] and Privacy Badger [32], are widely used, and some browsers, like Safari and Firefox, have built-in tracking prevention features. Adblocking extensions, such as Adblock Plus and AdBlock, are even more popular due to their additional benefits, such as removing intrusive ads, protecting against malware, and improving page load times [31].

Adblockers use crowdsourced filter lists to block ads and trackers. EasyList [16] is the most widely used filter list for blocking ads, while EasyPrivacy [18] is used for blocking trackers. These filter lists contain regular expressions that match HTTP requests and HTML elements, allowing adblockers to block or hide matching content.

### 2.2. Related Work
#### Online Tracking
Research has shown the pervasive nature of online tracking. For example, Krishnamurthy and Wills [51] found that the presence of top third-party trackers on popular websites increased from 40% in 2005 to 70% in 2008. Lerner et al. [53] reported that the percentage of websites contacting at least five separate third parties rose from 5% in the early 2000s to 40% in 2016. Englehardt and Narayanan [44] demonstrated that a few major third parties, such as Google and Facebook, track users across a significant fraction of the Alexa top one million websites.

#### Tracker Blocking
Tracker blocking tools have had mixed success. Roesner et al. [64] found that defenses like third-party cookie blocking and Do Not Track (DNT) are not effective against social media widgets. Merzdovnik et al. [58] identified blind spots in popular tracker blocking tools, particularly against stateless trackers and those with smaller footprints. Gugelmann et al. [48] proposed an automated approach to identify new services for inclusion in adblockers' filter lists, while Yu et al. [69] developed a k-anonymity-inspired method to filter data sent to trackers.

#### Adblocking and Anti-Adblocking
Prior research has focused on the prevalence of adblockers. Pujol et al. [61] found that 22% of the most active users on a major European ISP used Adblock Plus. Malloy et al. [55] reported that 18% of U.S. users employed adblockers. In response, some publishers manipulate ad delivery to evade filter lists, and others use anti-adblock scripts to detect and block adblockers. Storey et al. [65] proposed a perceptual adblocking method to visually identify and block ads, while Rafique et al. [62] and Nithyanand et al. [60] studied the deployment of anti-adblock scripts on various websites.

In our prior work, Mughees et al. [59] used a machine learning-based approach with A/B testing to analyze changes in page content due to anti-adblockers. This paper builds on this work by conducting a retrospective measurement study of anti-adblock filter lists and developing a machine learning-based method to automatically detect anti-adblock scripts.

## 3. Research Questions
This paper addresses the following research questions:
1. How have the filter rules in anti-adblock filter lists evolved over time?
2. How has the coverage of anti-adblock filter lists evolved over time?
3. How can we improve the creation of anti-adblock filter lists?

## 4. Methodology
We analyze the complete history of crowdsourced anti-adblock filter lists and conduct a retrospective measurement study to assess their coverage over time. We also develop a lightweight machine learning-based approach to automatically detect anti-adblock scripts using static JavaScript code analysis. This approach aims to complement crowdsourcing efforts, speed up the creation of new filter rules, and improve overall coverage.

## 5. Conclusion
Our findings highlight the limitations of manual curation and informal crowdsourcing in maintaining anti-adblock filter lists. By providing a comprehensive study and a machine learning-based method, we aim to help filter list authors more effectively and quickly update these lists, thereby improving their coverage and effectiveness.

Future research directions include further refining the machine learning model and exploring the impact of anti-adblock scripts on user experience and publisher revenue.