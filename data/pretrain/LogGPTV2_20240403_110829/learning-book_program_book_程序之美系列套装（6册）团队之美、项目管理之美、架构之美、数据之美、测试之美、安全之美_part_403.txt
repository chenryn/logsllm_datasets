人。
这个事实强调了我们在本章之初定义信任时所提到的一个要点：信
任网络中的信任是一种特殊的信任，它局限于验证密钥的范围之
内，而并不是现实世界的信任。
然而，对某个人的密钥进行签名可能是个非常个人的决定。许多人
在这方面的感觉非常强烈。信任网络的优点之一就是个人之间的接
触正是PGP的精神之一。但是，它存在一个很简单的弱点，就是人
与人之间所谓的信任很容易受到情绪的影响。图7-2所示的漫画山即
2332
---
## Page 2334
说明了这个道理。对于许多人而言，充许一个密钥完全是个人的私
事。
图7-2负责任的行为
信任网络很自然产生的一个相关属性是密钥的签名会获取一定的威
望。它们就像亲笔签名一样，具有一定的社会价值。
在这种社会价值中，有些是可以简单操作的。如果你好不容易找到
几个自己重视的人对自己的密钥进行了签名然后又得到一个新的
密钥，就不得不再次获取所有这些签名。许多人保留密钥的时间要
比密钥应该被保存的时间更长，因此这些密钥是由相应的社交圈子
中具有影响力的人物所签名的，或者他们与密钥持有人之间的关系
比较密切。
即使是自己的密钥，这个基本问题仍然存在。目前还没有办法把你
2333
---
## Page 2335
行了签名（或者反之），就相当于创造了信任模型所支持的一种手
工前滚，但它并不是自动化的，它需要人们同时拥有这两个密钥。
信任网络的社会影响是它最基本也是最顽固的毛边。它们在没有安
全资格证书的情况下创建了一个社交网络。它们使安全资格证书成
为一种滑稽和私人化的东西。但是，当它们变得滑稽并且私人化
时，它们就获得了情感价值。我们对自已网站上的SSL证书并没有什
么感觉，但是对PGP密钥的审核就涉及到对人际关系的审查。
[1]来目http://imgs.xkcd.com/comics/responsible_behavior.png,Randall
Munroe，已获准使用。
[2]这里再次出现了社会价值问题！为什么你要从你所重视的人那里
获取签名而不是从那些能够作出正确签名的人那里获取呢？
7.3PGP和加密的历史
遗憾的是，在技术社区中流传着大量与PGP有关的荒诞故事。因
此，了解它的真实历史并理解信任网络的技术选择是非常重要的。
下面，我们将讲述它的一些历史山。
7.3.1早期的PGP
20世纪80年代，当Phil还是一位致力于核武器冻结运动的和平主义者
时，他就开始从事PGP的一些早期设计。当时的世界与现在大不一
样：当时的美国总统是里根，克里姆林营的掌权人是勃列日涅夫，
美国联邦应急管理局（FEMA）向老百姓们灌输紧急疏散计划，数以
百万计的人们害怕这个世界将会不可避免地陷入核战争的泥淳。上
百万的美国人在中英公园游行，呼叶全球和平。
1984年，正是在这样的政治气候下，Phil看到了开发一种新概念（后
来演变成PGP）的需要，不仅可以保护海外的人权，还可以保护国
内的草根政治组织。他开始着手PGP的早期设计，但是更为急迫的
和平运动事件拖延了他的开发工作，直到数年之后才有所进展。Phil
在1991年编写了PGP的第一个实用版本。他在美国国会讨论要求所
有具有“陷阱门"的通信设备和服务允许政府部门的反犯罪和反恐活
动[②之后发布了PGP。
尽管国会的讨论并没有形成最终的法律，但Phil还是推出了PGP
1.0，当时存在着各种野路子的强加密技术，而且都是合法的。用一
2334
---
## Page 2336
种比喻的说法，PGP的明确设计目标之一就是在牲口棚的大门关闭
之前把马群赶出牲口棚。
尽管当时还存在其他信息加密系统，例如引人注目的隐私增强邮件
（PEM）3，但它们的控制过于紧密，不适合大规模的部署。
PGP1.0吸引了许多人的注意，但它还存在很大的缺陷。具体地说，
它使用了Phil所设计的Bass-O-Matic解码器，而EliBiham发现这种解
码器存在密码上的缺陷。因此，Phil和HalFinney、PeterGutmann和
BrankoLancaster经过改良之后推出了PGP2.0。
PGP2.0用XuejiaLai和JamesMassey所设计的国际数据加密算法
（IDEA）解码器代替了Bass-O-Matic解码器。它还用一种与RFC
1991相似的形式引人了PGP信任模型。
PGP2抓住了许多人想在一种特定的、不受限制的环境中使用强加密
技术的想法。它成为了一种草根现象。
载。它不仅包括PGP桌面的源代码，而且包括PGP命令行源代码和
PGP统一GPL修改的源代码。我们还可以从
http://www.pgp.com/company/pgpassurance.html找到PGP在保证和特殊
生成需要的策略。
[21这是1991年的美国参议院草案266。它最终没有获准成为法律。
[3]PEM最早是由JohnLinn和SteveKent在RFC1113、RFC1114和RFC
1115定义的。它们在RFC1421、RFC1422、RFC1423和RFC1424中
由DavidBalenson和BurtKaliski进行了修订。
[4]JonCallas当时在DEC公司，并拥有一个PEM证书。获取PEM证书
需要一个公证人，并把他的护照通过信函发送给认证中心。他和他
和同事从PEM转移到了PGP，因为要拿到PEM证书，至少需要一个
月的时间，而且没有护照的人根本没办法申请证书。
7.3.2专利和输出问题
尽管从加密的角度而言PGP2非常强大，但是它也存在一些其他问
题，涉及专利和输出控制。IDEA解码器是申请了专利的，专利拥有
者Ascom-TechAG授权非商业用户免费使用这个解码器，但商业用户
却没有获得同样的授权。MIT在美国申请了RSA公钥算法的专利，并
授权给了RSADataSecurityIncorporated（RSADSI）。
2335
---
## Page 2337
1986年，Phi1与RSADSI的首席执行官JimBidzos会，讨论了将RSA
算法授权给免费软件的问题。会议的结果是Phil相信只要软件的售价
为零（它是真正的免费软件），他就可以在软件中使用RSA算法。
而Bidzos的思路恰好相反，他认为只要软件能够卖钱，他就能提取
专利费用。接下来就是持续数年的对这个协议的分歧。PGP在法律
上所遇到的困难有部分原因是RSA算法只在美国申请了专利，RAS
专利的实际拥有者MIT有意向PGP软件提供方便。
最终的结果是RSADSI创建了一个称为RSAREF的库，用于免费软件
和共享软件。PGP软件接着发布了2.5版本，在美国使用RSAREF
但它破坏了与以前所有版本的兼容性。这意味着PGP存在几个版
本：
PGP软件2.5之前的版本，未来将不会再对它进行开发和提供支持。
PGP软件的"国际"版本，它完全是在美国之外开发的（由于输出控
制的原因），它使用了RSA算法的原先实现。
PGP软件的"RSAREF"版本，它是在美国开发的，使用了RSA算法的
RSAREF实现。
在所有这些版本中，IDEA解码器对于非商业用途是免费的，但商业
用途就没有这个待遇。
知识产权上的争议仍在继续，PublicKeyPartmers于1992年向美国海
关进行了投诉，抱怨Phil在没有得到适当授权的情况下输出密码技术
（即PGP程序）并通过Internet传播。接下来就是臭名昭著的对Phil和
PGP软件的调查。这个调查一直持续到1996年1月才被取消。
关于Zimmermann事件，存在许多错误概念，我们可以进行纠正。
Phil成了犯罪调查的目标，但并没有被指控。无论是他还是其他任何
人，都没有接到与PGP有关的任何犯罪指控。没有任何诉讼发生，
没有任何除了调查之外的其他法律行动，也没有任何人因为此事而
坐牢。调查所覆盖的是PGP软件本身的实际发布，而不是PGP队伍的
开发行为。PGP开发队伍由美国、新西兰和欧洲的开发人员组成。
在国际范围内开发软件的行为从来没有成为此次调查的目标。
美国政府（具体地说，是国家安全局（NSA）并没有针对软件的存
在而启动调查。一种常见的误解是政府因为不喜欢这种海量发布的
2336
---
## Page 2338
加密技术而启动了这个调查。美国海关针对JimBidzos的投诉而进行
了调查。尽管NSA也卷人了这个事件，但他们显然并没有启动调
查，而且他们取消这个调查也发挥了一定的作用山]。
[11当时美国国家安全局的副局长williamCrowell在与Jon和Phil的私
人通信时表示，他在调查开始之前曾受到过咨询，并认为调查是允
许的，但他也施加了压力要求取消调查，并认为自已在调查的成功
取消方面做出了努力。后来，司法部门的其他人也声称在做出取消
调查决定上有过作用。
7.3.3密码战争
20世纪90年代的政治环境有个重要的组成部分就是所谓的密码战
争。密码战争是密码技术在社会中的角色也被破坏殆尽。
直到1997年，密码技术仍被国际条约视为战争武器。免费和开放的
密码系统在美国被视为军火，在法国则被禁止。它在世界上其他国
家的地位也是混杂不一。1997年，美国对密码技术进行了重新分
类，把它作为一种双重用途的项目。法国在1999年儿乎开放了所有
的加密技术，对加密技术的输出控制在2000年得到了极大的放松。
尽管国际社会对恐怖主义日益关注，但这种放松政策仍在继续。
为了结束美国对密码输出的控制，PGP所做的一个努力是以书面印
刷的形式公布了它的完整源代码，这是因为印刷书籍是不受输出控
制的。1995年，首先出版的是《PGPSourceCodeandInternals》
（MITPress出版）。后来，PretyGoodPrivacy公司在一套更高级的
书中出版了PGP的源代码。这套书专门介绍一些经过优化后用于C源
代码的光学字符识别（OCR）的软件工具。这样，输出数量不受限
制的密码技术源代码变得极为方便，使输出控制变得没有意义，实
行输出控制的政治规章和期望暗示被要求厂泛应用强大的密码技
术。
今天，政府对密码技术的态度几乎发生了180度的改变。这是与隐
私、数据管理和公司管理有关的国内和国际法律不断变化所导致的
结果。
1990年，关于密码技术的文化态度可以描述为：你为什么需要它？
你非得隐藏些什么吗？20年后，文化态度转变为：你为什么不要
它？难道你不理解保护自己数据的重要性吗？
2337
---
## Page 2339
密码战争的明确历史以及公众对密码技术的文化态度的转变并没有
太多的书面材料可供参考。但是，StevenLevy的《Crypto：Howthe
Code Rebels Beat the Government Saving Privacy in the Digital Age)
（Penguin）可以作为了解这些知识的起点。
7.3.4从PGP3到OpenPGP
在PGP2的状态变得平静之后，Phil伙同DerekAtkins和ColinPlumnb
开始致力于PGP软件的新版本PGP3。PGP3包含了对RFC1991协议
的一些改进，包括：
在一个PGP密钥中增加了对多个公钥对的支持。具体地说，它的设
计提倡分离签名和加密密钥，作为一种促进密钥使用的方法。
支持DSA公钥签名以及用于公钥加密的ElGamal。
提供了对支持对称加密的CAST5和TripleDES的支持。
在HansDobbertin在MD5散列函数的压缩函数中发现了伪冲突之后，
用SHA-1替换了MD5散列函数（参见7.6节）。
1996年，Phil携同私人投资者以及曾经生产过商业版本的PGP软件的
Viacrpt公司创建了PretyGood Privacy公司。由于Viacrypt已经用产品
名PGP4发布了RFC1991系统的发行版本，因此PGP3密码系统在发
行时被命名为PGP5。
当时，PGP软件开发队伍的成员开始倡议PGP3协议的一个轮廊，他
们通俗地称为UnencumberedPGP，通过一组参数避免使用受到知识
产权保护的算法。开发队伍将Unencumbered PGP提交给IETF，作为
RFC1991的继承者。它后来成为了OpenPGP。