171 − 5.2 ln (V ) − 0.23M − 16.2 ln (SLOC)
171
,
(5)
where V is Halsteads average volume per module (another classic complexity met-
ric; see [21] for details), M is the average cyclomatic complexity per module, and
SLOC is the average number of source code lines per module. This is, for instance,
A Look into 30 Years of Malware Development
331
the deﬁnition used by Visual Studio, and does not take into account the comment-
to-code ratio as the original one proposed in [30]. As in the case of the COCOMO
estimators, Oman and Hagemeister arrived at this formula through statistical
regression over a dataset consisting of a large number of software projects tagged
with expert opinions. The M I has been included in Visual Studio since 2007, and
in the JSComplexity and Radon metrics for Javascript and Python. Although not
exempt from criticisms, its use was promoted by the Software Engineering Insti-
tute in their “C4 Software Technology Reference Guide” [33] as a potentially good
predictor of maintainability. As for its interpretation, there is no agreed upon safe
limits. For example, Visual Studio ﬂags as suspicious modules with M I < 20.
3 Dataset
Our work is based on a dataset of malware source code collected by the authors
over several months in 2015. Collecting malware source code is a challenging
endeavor because malware is typically released in binary form. Only occasionally
its source code is released or leaked, with its availability being strongly biased
towards classical viruses and early specimens. When leaked, the source code may
be diﬃcult to access in underground forums. These challenges make it impossible
to try to be complete. While we try to collect as many samples as possible, the
goal is to acquire representative examples of the malware ecosystem during the
last 30+ years, constrained to the limited availability.
Samples were obtained from a variety of sources, including virus collection sites
such as VX Heaven, code repositories such as GitHub, classical e-zines published
by historically prominent malware writing groups such as 29A, various malware
exchange forums available in the web, and through various P2P networks. We
expanded our list of sources by using a snowballing methodology, exploring pre-
viously unknown sources that were referenced in sites under examination.
Fig. 1. Distribution of malware source code samples in the dataset.
332
A. Calleja et al.
Our initial collection contained 210 diﬀerent samples of malware source code.
Each sample was ﬁrst quickly veriﬁed through manual inspection and then com-
piled, executed and, whenever possible, functionally tested. Approximately 30 %
of the obtained samples were discarded at this point, either because testing them
was unfeasible (e.g., due to nontrivial compilation errors or unavailability of a
proper testing environment), or simply because they turned out to be fake.
Table 3. Malware source code samples in the dataset.
Type
Year Name
T
1975 ANIMAL
V
1982 ElkCloner
V
1986 Rushrour
V
1986 V11
V
1987 Bvs
V
1987 Numberone
W
1988 MorrisWorm
V
1989 AIDS
V
1989 CIA
V
1989 Eddie
V
1990 Anthrax
V
1990 Diamond
V
1991 486
V
1991 808
V
1991 Badbrains
V
1991 Demonhyak
V
1991 Tormentor
V
1992 ACME
V
1992 Proto-t
V
1992 Rat
V
1992 Thunderbyte
V
1993 Asexual
1993 Beavis
V
1993 DarkApocalypse V
V
1993 Nakedtruth
V
1994 Batvir
1994 Bluenine
V
1994 Dichotomy
V
1994 Digitisedparasite V
1995 242
V
1995 Bluelightening V
1995 RCE285
V
V
1996 Apocalyptic
V
1996 Combat
V
1996 Galicia
V
1996 Jupiter
1996 Mars
V
V
1996 Staog
Type
Year Name
V
1997 CSV
V
1997 Cabanas
V
1997 Harrier
V
1997 RedTeam
1997 V6000
V
1998 Anaphylaxis W
W
1998 Ch0lera
1998 Gift
W
V
1998 Marburg
1998 PGPMorf2
V
1998 Plague2000 W
M
1998 Shiver
1998 Teocatl
M
V
1999 Babylon
V
1999 BeGemot
V
1999 Demiurg
1999 Fabi2
V
W
1999 IISW
M
1999 Melissa
V
1999 Nemesi
V
1999 Prizzy
1999 Rinim
V
1999 RousSarcoma V
V
1999 YLANG
V
1999 Yobe
W
2000 Chainsaw
2000 Dream
V
W
2000 Energy
2000 Examplo
V
2000 ILOVEYOU W
2000 Icecubes
W
2000 Milennium V
2000 Rammstein V
W
2000 Troodon
2000 Tuareg
V
2000 W2KInstaller V
2000 XTC
W
W
2000 Zelda
Type
Year Name
W
2001 Anarxy
V
2001 Ketamine
W
2001 MW
V
2001 Nicole
V
2001 OU812
V
2001 Plexar
V
2001 Rudra
V
2001 Tapakan
V
2002 DW
V
2002 Eﬁshnc
V
2002 Gemini
W
2002 Griﬁn
V
2002 Junkmail
V
2002 Lexotan
2002 Omoikane
V
2002 PieceByPiece W
2002 Ramlide
V
V
2002 Simile
V
2002 Solaris
V
2002 Taichi
V
2002 Vampiro
2002 ZMist
V
W
2003 Blaster
W
2003 Mimail
W
2003 Obsidian
V
2003 Rainbow
2003 Seraph
V
V
2003 Tahorg
B
2004 Beagle
W
2004 Caribe
V
2004 Jollyroger
2004 Mydoom
W
W
2004 Netsky
W
2004 Pilif
W
2004 Sasser
V
2004 Shrug
2005 Assiral
W
V
2005 Blackhand
Type
Year Name
V
2005 Egypt
V
2005 Eternity
V
2005 Friendly
V
2005 Gripb
2005 Hidan
V
2005 Kroshkaenot V
2005 Nanomites V
2005 Spieluhr
T
2005 WRhRage W
W
2006 Gurdof
W
2006 Kekule