  from 
  average 
35 
Visibility 
  – 
  Log 
  Examples 
1 
  2014-­‐09-­‐06 
  23:59:59.52 0AHARVEY
117499Angel 
  Harvey 
DBA 
  24209801HNAMTest/ Domain6000051MTYVQ-­‐ACTX03HNA: 
  PowerchartRUN 
PowerView 
  Preferencescps_ens_ppa34679328569Maintain 
  PersonChart 
  Access 
  Log 
  […….][…….] 
36 
	Analysis 
•Core 
  Metric: 
  Chart 
  Opens 
  Per 
  Day, 
  Per 
  Employee 
•Dimensions 
  to 
  Compare: 
–Over 
  Eme 
  for 
  the 
  same 
  user, 
  others 
  with 
  same 
  Etle 
–Others 
  with 
  the 
  same 
  Etle 
  in 
  the 
  same 
  city 
  or 
  with 
  the 
  same 
  years 
  of 
  experience 
•Why 
  MulEple 
  Dimensions? 
1.ComparingMulEple 
  Dimensions? 
1.Comparing 
  mulEple 
  metrics 
  reduces 
  false 
  posiEves. 
2.Provides 
  more 
  context. 
3.If 
  I 
  open 
  25 
  Emes 
  as 
  many 
  charts, 
  but 
  so 
  does 
  every 
  other 
  nurse 
  in 
  my 
  facility 	because 
  we’re 
  under 
  inspecEon, 
  that 
  should 
  be 
  evident. 
| •What 
  about 
  performance?  | •What 
  about 
  performance?  |about 
  performance?  |
|---|---|
| – |Good    point!    Data    Models    turn    this    into    a    30    seconds    per    5M    events    search    on    my  |
| laptop.    Tscollect    is    manual    but    turns    it    into    a    quarter    second    search.  |laptop.    Tscollect    is    manual    but    turns    it    into    a    quarter    second    search.  |
37 
Analysis37 
Analysis 
  – 
  Basic 
| index=cerner  |   Basic 
  Data 
  Set  |
|---|---|
| |    eval    EmployeeID=spath(_raw,    "audit_list.prsnl_id")   Field    Munging  ||    eval    EmployeeID=spath(_raw,    "audit_list.prsnl_id")   Field    Munging  |
| |    eval    EmployeeName    =    […] |    eval    RecordNum=    […]  |  Pull    the    number    of    stats    per 	employee,    per    day || |    bucket    _Eme    span=1d  |    stats    dc(RecordNum)    as    NumRecords    by EmployeeName,    EmployeeID,    _Eme  |  Pull    the    average,    standard deviaEon,    and    most    recent daily    number    per    employee  |
| |    stats    first(NumRecords)    avg(NumRecords)  stdev(NumRecords)    by    EmployeeName,    EmployeeID  |  Find    instances    where    the    most 	recent    number    is    more    than    6  || |    where    ‘first(NumRecords)’    >    ‘avg(NumRecords)’    +  |standard    deviaEons    away    from  |
| ‘stdev(NumRecords)’    *    6  |the    average  |
38 
Demo 
40 
  minutes 
  later… 
39 
How 
  To 
  Accelerate 
•AcceleraEon 
  facilitates 
  beger 
  and 
  broader 
  analysis. 
•Splunk 
  has 
  a 
  few 
  ways 
  of 
  acceleraEng 
  content: •Report 
  AcceleraEon 
•DataAcceleraEon 
•Data 
  Model 
  AcceleraEon 
•TSCollect 
•Summary 
  Indexing 
•Pre-­‐processing 
  of 
  logs 
•Check 
  out 
  Gerald 
  Kanapathy’s 
  Session 
  on 
  Friday: 
Title: 
  Splunk 
  Search 
  AcceleraEon 
  Technologies 
Speaker: 
  Gerald 
  Kanapathy, 
  Sr. 
  Director 
  Product 
  Management, 
  Splunk 
When: 
  10/09/2014, 
  10:30 
  AM 
  – 
  11:30 
  AM 
40 
Analysis– 
  11:30 
  AM 
40 
Analysis 
  – 
  AcceleraEon 
| index=cerner  |   Basic 
  Data 
  Set  |
|---|---|
| |    eval    Role=spath(_raw,    "audit_list.role")  |  Field    Munging  |
| |    eval    RoleID    =    […]                    |    eval    EmployeeID=    […]  |    eval    EmployeeName    =    […]            |    eval    PaEentNum=    […]  	  Stats    split    by    as    many  ||    eval    RoleID    =    […]                    |    eval    EmployeeID=    […]  |    eval    EmployeeName    =    […]            |    eval    PaEentNum=    […]  	  Stats    split    by    as    many  || |    bucket    _Eme    span=1d  |    stats    dc(PaEentNum)    as    NumRecords    by  |dimensions    as    required,    but not    more.  |
EmployeeName, 
  EmployeeID, 
  Role, 
  RoleID 
  _Eme 
| 
  lookup 
  HR_IS.csv 
  EmployeeID | 
  tscollect 
  retain_events=t 
  Cerner    Lookup 
  occurs 
  a^er 
  stats 
  Store 
  the 
  results 
  in 
  a 
  local 
  tsidx 	(could 
  also 
  dolocal 
  tsidx 	(could 
  also 
  do 
  this 
  with 
	datamodels) 
41 
Analysis 
  – 
  Find 
  StaEsEcal 
  Outliers 
  Pt 
  1 
| 
  tstats 
  local=t 
  first(NumCharts) 
  as 
Recent_NumCharts 
  avg(NumCharts) 
  as 
Avg_NumCharts 
  stdev(NumCharts) 
  as Stdev_NumCharts 
  from 
  Cerner 
  groupby 
EmployeeName, 
  EmployeeID, 
  Username, 
  Role, RoleID, 
  City, 
  YearsAtCompanyCity, 
  YearsAtCompany 
  | 
  join 
  type=outer 
  RoleID 
  [| 
  tstats 
  local=t avg(NumCharts) 
  as 
  Role_Avg_NumCharts
stdev(NumCharts) 
  as 
  Role_Stdev_NumCharts 
  from    How 
  many 
  charts 
  is 
  typical (and 
  what 
  is 
  the 
  standard deviaEon) 
  for 
  this 
  person. Also, 
  how 
  many 
  did 
  they open 
  yesterday? 
  How 
  many 
  chart 
  opens  How 
  many 
  chart 
  opens 
  is standard 
  for 
  people 
  in 
  this role? 
Cerner 
  groupby 
  Role, 
  RoleID 
  ] 
42 
Analysis 
  – 
  Find 
  StaEsEcal 
  Outliers 
  Pt 
  2 
[… 
  conEnued 
  from 
  previous 
  slide 
  …] 
  | 
  eval 
  Personal_Z 
  = 
  abs(Recent_NumCharts-­‐Avg_NumCharts)/Stdev_NumCharts 
| 
  eval 
  Role_Z 
  = 
  abs(Recent_NumCharts-­‐= 
  abs(Recent_NumCharts-­‐
Role_Avg_NumCharts)/ 
Role_Stdev_NumCharts 
| 
  eval 
  Z_Min 
  = 
  min(Role_Z, 
  Personal_Z) 
| 
  where 
  Z_Min 
  > 
  6    How 
  unusual 
  is 
  this 
  acEvity, for 
  this 
  person 
  or 
  versus 
others 
  in 
  this 
  role? 
–Z 
  score 
  = 
  how 
  many 
  StDev 	away 
  from 
  average. 
–Consider 
  other 
  metrics, 
  such 
  as 	years 
  atmetrics, 
  such 
  as 	years 
  at 
  the 
  company, 
  facility. 
–Goal 
  is 
  to 
  capture 
  normal 
across 
  dimensions, 
  to 
  idenEfy trends 
  across 
  organizaEon 
  (e.g., a 
  facility 
  audit). 
43 
AcEon 
•Email 
  the 
  Manager 
•This 
  opEon 
  is 
  mostly 
  just 
  forma‡ng. 
  Join 
  to 
  the 
  HR 
  / 
  LDAP 
  database 
  and 
  uElize 
  sendemail 
  + 	map.uElize 
  sendemail 
  + 	map. 
•Could 
  also 
  escalate 
  big 
  violaEons 
  to 
  the 
  SOC 
  or 
  GRC.
| 
  lookup 
  LDAPSearch 
  sAMAccountManager 
  as 
  username 
  OUTPUT 
  manager 
| 
  lookup 
  LDAPSearch 
  dn 
  as 
  manager 
  OUTPUT 
  mail 
  as 
  ManagerEmail 
| 
  map 
  maxsearches=100 
  search=“ 
  | 
  stats 
  count 
  | 
  eval 
  ManagerEmail=$ManagerEmail$eval 
  ManagerEmail=$ManagerEmail$ 
  | 
  eval 
  EmployeeName=$EmployeeName$ 	 
  | 
  eval 
  ZAvg 
  = 
  $Z_Avg$ 
  | 
  sendemail 
  to=ManagerEmail 
  sendresults=f 
  subject=EmployeeName 
  . 
  \“ 
  excess 
  Chart 
  Opens\” 
  message=EmployeeName 
  . 
  \“ 
  has 
  opened 
  more 
  charts 
  than 
  normal 
  (\“ 
  . 
  ZAvgthan 
  normal 
  (\“ 
  . 
  ZAvg 
  . 
  \“ 
  stdev). 
	_._Please 
  Follow 
  Up.\” 
“ 
44 
Demo 
45 
Scenario 
  Four 
Visual 
  Event 
CorrelaEon 
Visual 
  Event 
  CorrelaEon 
•A^er 
  conquering 
  the 
  essenEals 
  of 
  ge‡ng 
  some 
  alert 
  data, 
  it’s 	important 
  to 
  be 
  able 
  to 
  understand 
  an 
  agacker’s 
  acEon 
  plans. 
–Progress 
  through 
  killplans. 
–Progress 
  through 
  kill 
  chain 
–Movement 
  toward 
  criEcal 
  assets 
–Et 
  Cetera
•Easiest 
  with 
  Enterprise 
  Security, 
  but 
  possible 
  without 
47 
	Visibility 
  – 
  Log 
  Examples •Anything. 
  This 
  should 
  encompass 
  all 
  of 
  your 
  log 
  sources, 	correlaEon 
  rules, 
  alerts, 
  and 
  etc. 
•Ideally 
  include 
  operaEonal 
  data 
  hereoperaEonal 
  data 
  here 
  too 
  (e.g., 
  website 
  response 	Eme 
  change) 
48 
	Analysis 
•Examples 
  thus 
  far 
  have 
  centered 
  around 
  automated 
  analysis, 
  but 	Splunk 
  is 
  also 
  a 
  great 
  tool 
  for 
  data 
  visualizaEon 
  and 
  analysis. 
•CapabiliEes 
  here 
  are 
  virtually 
  endless, 
  but 
  here 
  are 
  a 
  few 	examples. 
49 
AcEona 
  few 	examples. 
49 
AcEon 
•Need 
  more 
  informaEon? 
  Enterprise 
  Security 
  has 
  many 
  built 
  in 	work 
  flow 
  acEons 
  to 
  go 
  pull 
  more 
  data. 
•Go 
  pull 
  more 
  informaEon 
  from 
  your 
  Endpoint 
  Threat 
  DetecEon and 
  Response 
  app: 
–Tanium: 
  hgp://apps.splunk.com/app/1862/
–Tripwire 
  / 
  nCircle 
  ip360: 
  Ask 
  your 
  SE 
–Bit9ip360: 
  Ask 
  your 
  SE 
–Bit9 
  / 
  Carbon 
  Black: 
  hgps://www.bit9.com/soluEons/splunk/
–Many 
  Others 
  also 
  exist 
•File 
  a 
  Ecket 
  with 
  your 
  EckeEng 
	–Remedy: 
  hgp://answers.splunk.com/answers/122019
•Open 
  a 
  new 
  Notable 
  Event 
  in 
  ES  
50 
Demo 
  – 
  Separate 
  Product 
  Lines 
  (ES) 
51 
Demo 
  – 
  Kill 
  Chain 
  Swimlanes 
  (ES)Kill 
  Chain 
  Swimlanes 
  (ES) 
52 
Demo 
  – 
  Visualizing 
By 
  Priority 
•While 
  not 
  as 
  slick 
  as 
  the 
  ES 
version, 
  you 
  can 
  get 
  much 
  of 
  the same 
  value 
  by 
  leveraging 
  mulEple reports 
  on 
  one 
  dashboard, 
  or 
  with stacked 
  column 
  charts. 
53 
Security 
  is 
  a 
  Team 
  Sport 
Splunk 
  Security 
  Intelligence 
  Pla‰ormSecurity 
  Intelligence 
  Pla‰orm
| Splunk 
  App 
  for 
  Enterprise 
  Security  | 140+ 
  security 
  apps  | 140+ 
  security 
  apps  | 140+ 
  security 
  apps  |
|---|---|---|---|
| Splunk    App    for    Enterprise    Security  |Palo    Alto  Networks  |Blue    Coat  Proxy    SG  |Blue    Coat  Proxy    SG  |
| Splunk    App    for    Enterprise    Security  |Cisco    Security Suite  |OSSEC  |OSSEC  || Splunk    App    for    Enterprise    Security  |F5    Security  |FireEye  |FireEye  |
|  |NetFlow    Logic  |NetFlow    Logic  |AcEve  Directory  |
|  |Juniper  |Sourcefire  |Sourcefire  |
55 
	Talk 
  to 
  your 
  neighbor We’re 
  all 
  in 
  this 
  together. 
56 
Go 
  Play 
  With 
  Data Github 
  with 
  DataGens 
  and 
  searches: 
www.davidveuve.com/go/conf-­‐security
5757 
Shameless 
  Plug 
	Splunk 
  Search 
  Usage 
Splunk 
  Search 
  Usage 
  and 
  AdopEon 
  Tracking, 
  with 
  security 
  reports. 
•
hgp://www.davidveuve.com/go/ssu
59 
THANK 
  YOU