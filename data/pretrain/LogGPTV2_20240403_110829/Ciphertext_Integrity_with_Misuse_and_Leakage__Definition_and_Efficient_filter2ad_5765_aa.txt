title:Ciphertext Integrity with Misuse and Leakage: Definition and Efficient
Constructions with Symmetric Primitives
author:Francesco Berti and
Fran√ßois Koeune and
Olivier Pereira and
Thomas Peters and
Fran√ßois-Xavier Standaert
Ciphertext Integrity with Misuse and Leakage: Definition and
Efficient Constructions with Symmetric Primitives
Francesco Berti, Fran¬∏cois Koeune, Olivier Pereira,
Thomas Peters, Fran¬∏cois-Xavier Standaert.
ICTEAM/ELEN/Crypto Group, Universit¬¥e catholique de Louvain, Belgium
francesco.berti,francois.koeune,thomas.peters,olivier.pereira,PI:EMAIL
ABSTRACT
Leakage resilience (LR) and misuse resistance (MR) are two
important properties for the deployment of authenticated
encryption (AE) schemes. They aim at mitigating the impact
of implementation flaws due to side-channel leakages and
misused randomness. In this paper, we discuss the interactions
and incompatibilities between these two properties.
We start from the usual definition of MR for AE schemes
from Rogaway and Shrimpton, and argue that it may be
overly demanding in the presence of leakages. As a result,
we turn back to the basic security requirements for AE:
ciphertext integrity (INT-CTXT) and CPA security, and
propose to focus on a new notion of CIML security, which
is an extension of INT-CTXT in the presence of misuse and
leakages.
We discuss the extent to which CIML security is offered
by previous proposals of MR AE schemes, conclude by the
negative, and propose two new efficient CIML-secure AE
schemes: the DTE scheme offers security in the standard
model, while the DCE scheme offers security in the random
oracle model, but comes with some efficiency benefits. On
our way, we observe that these constructions are not trivial,
and show for instance that the composition of a LR MAC
and a LR encryption scheme, while providing a (traditional)
MR AE scheme, can surprisingly lose the MR property in
the presence of leakages and does not achieve CIML security.
Eventually, we show the LR CPA security of DTE and DCE.
KEYWORDS
Authenticated encryption, leakage-resilient cryptography, mis-
use resistance
ACM Reference Format:
Francesco Berti, Fran¬∏cois Koeune, Olivier Pereira, Thomas Pe-
ters, Fran¬∏cois-Xavier Standaert.. 2018. Ciphertext Integrity with
Misuse and Leakage: Definition and Efficient Constructions with
Permission to make digital or hard copies of all or part of this work
for personal or classroom use is granted without fee provided that
copies are not made or distributed for profit or commercial advantage
and that copies bear this notice and the full citation on the first
page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy
otherwise, or republish, to post on servers or to redistribute to lists,
requires prior specific permission and/or a fee. Request permissions
from permissions@acm.org.
Conference‚Äô17, July 2017, Washington, DC, USA
¬© 2018 Association for Computing Machinery.
ACM ISBN 978-x-xxxx-xxxx-x/YY/MM. . . $15.00
https://doi.org/10.1145/nnnnnnn.nnnnnnn
Symmetric Primitives. In Proceedings of ACM Conference (Con-
ference‚Äô17). ACM, New York, NY, USA, 15 pages. https://doi.
org/10.1145/nnnnnnn.nnnnnnn
1 INTRODUCTION
Authenticated Encryption (AE) has become the standard
primitive for secure message transmission: after its introduc-
tion by Bellare and Namprempre [9] and Katz and Yung [26],
a first round of ISO standardization in 2009 [25], and the
ongoing CAESAR competition [14], emerging standards like
TLS 1.3 only include AE schemes for record protection [39].
One of the main reason of this success is the ease of use of
AE, compared to earlier solutions based on combinations
of encryption and message authentication codes that led to
numerous security issues [2, 18, 36].
It is then natural that important efforts have been focusing
on making AE schemes more robust to various misuses and
implementation issues. For example, a first line of work fo-
cuses on randomness misuses, and particularly on the use of
poor quality ùêºùëâ s [42], making sure that the damages resulting
from these are kept minimal. This offers substantial improve-
ment compared to some schemes that can go as far as fully
leaking their long-term secret key if the same randomness is
used twice [35].
We explore the goal of misuse resistance (MR) taken in
combination with a second desirable property: leakage re-
silience (LR). This property aims at making sure that cryp-
tographic schemes behave as well as possible in the presence
of leakages resulting from their implementation. While the
original focus has been on leakages resulting of timings, power
consumption, or electromagnetic radiations of embedded de-
vices, LR has become a desirable feature for implementation
in high(er)-end devices, following recent works on timing at-
tacks against OpenSSL [1, 22], or power and electromagnetic
analysis of powerful ARM cores running at high frequen-
cies [5, 28].
Our work focuses on LR for leakages happening at en-
cryption time. This is practically relevant, for instance in
applications in which only one party (e.g., a power con-
strained smart-card), in charge of encryption, is susceptible
of producing side-channel leakages, while the other party (e.g.,
a reader), in charge of decryption, can easily be physically
shielded. Besides even in the case of bidirectional commu-
nications, many standards (e.g., TLS [39]) use a different
key for each direction of communication, and it is therefore
relevant to protect the encryption key, independently of the
security of the decryption key. We also reckon that having
Conference‚Äô17, July 2017, Washington, DC, USA
LR decryption (or just LR integrity verification) may be
considerably harder, due to the deterministic nature of these
functionalities: the question was discussed and left open in
earlier works [37], or required the adoption of primitives that
are considerably more complex and expensive than a block
cipher [31].
This focus on encryption makes our work orthogonal to
a third line of robustness improvements for AE, which fo-
cuses on the handling of information leakages that can re-
sult from decryption error messages and leakage of infor-
mation computed during the decryption of incorrect cipher-
texts [3, 7, 13, 24].
Our contributions. In the absence of security definitions
for LR AE, a natural starting point for our work is to con-
sider the definition of MR AE and try to enhance it with LR.
Informally speaking, an AE scheme is MR-secure if it pro-
duces ciphertexts that all look random, even to an adversary
controlling the random ùêºùëâ or nonce used during encryption,
and if it is not feasible to produce a ciphertext that decrypts
otherwise than as the result of the encryption of a message.
The random-looking ciphertexts guarantee confidentiality,
and the infeasibility to forge ciphertexts guarantees integrity.
Extending MR AE security to a notion of LR MR AE secu-
rity seems very challenging, though: the natural path would
be to augment with leakages the output of the encryption and
random oracles (which are expected to be indistinguishable).
The encryption oracle would provide the real leakages from
the implementation. It is hard, however, to see how to define
the leakages on the random side, as the output of this random
oracle does not correspond to any real computation: how do
we produce something that looks like the power consumption
trace for a computation that does not exist and is completely
inconsistent with its inputs?
As a result of this difficulty, we turn back to (a common
formulation of) the original security requirements for AE:
ciphertext integrity (INT-CTXT) and CPA security [9]. Fo-
cusing on INT-CTXT, we propose a new notion of ciphertext
integrity in the presence of misuse and leakage (CIML). CIML
security measures the hardness to produce a fresh valid cipher-
text in the presence of an oracle that produces ciphertexts
and the associated leakages when queried on adversarially
chosen messages and ùêºùëâ ‚Äôs or nonces.
We then investigate the CIML security of several MR
AE schemes. We observe that popular SIV-based construc-
tions [42] offer very little protection in the presence of leakages.
More surprisingly, even by combining recent LR encryption
and MAC schemes from Pereira et al. [37] into a MR AE
scheme, which we call PSV-AE, we still obtain a scheme
that is quite sensitive to side-channel attacks and not CIML
secure.
Given this state of affairs, we design two new AE schemes,
which we show to be CIML secure. We follow a pragmatic
design approach that combines the minimal use of an (ex-
pensive) leak-free component with much more efficient (less
protected) implementations [37]. Such a model nicely matches
Francesco Berti, Fran¬∏cois Koeune, Olivier Pereira,
Thomas Peters, Fran¬∏cois-Xavier Standaert.
the reality of modern embedded devices, where physical secu-
rity against side-channel attacks is now a necessary condition
for deployment, while cost constraints require to limit the
overheads of the countermeasures against such attacks. Con-
cretely, the leak-free component will typically be implemented
by a block cipher (e.g., the AES Rijndael) protected with
a combination of hardware and algorithmic techniques, e.g.,
noise addition [29], masking [40] and shuffling [45]. The latter
ones usually increase the ‚Äúcode size √ó cycle count‚Äù metric
(for software implementations) or the ‚Äúthroughput / area‚Äù
metric (for hardware ones) by factors ranging from hundreds
to thousands, hence motivating their minimal use.1 In prac-
tice, this good tradeoff between security and performance
is achieved by requiring a small constant number (1 or 2,
depending on the scheme) of executions of the leak-free com-
ponent, independently of the length of the message to be
encrypted or authenticated. For long messages, the majority
of the computational work can then be performed by weakly
protected block-cipher implementations.
Our first scheme, which we call DTE for ‚ÄúDigest, Tag and
Encrypt‚Äù, is CIML secure in the standard model, based on a
very permissive leakage model, which we call the unbounded
leakage model. In this model, everything is leaked, except
for the state of our leak-free component, which we need to
use twice. We also show that it is a MR AE scheme (in the
absence of leakages).
Our second scheme, which we call DCE for ‚ÄúDigest, Commit
and Encrypt‚Äù, is more efficient in the sense that it only
requires a single use of the leak-free component. However, we
can only prove its CIML security in the random oracle model
(but still in the unbounded leakage model). Furthermore,
DCE is not a MR AE scheme, as its ciphertexts do not
look random, even in the absence of leakages. We insist
that the introduction of random oracles in the analysis of
LR constructions is questionable (since the random oracle
abstraction excludes leakages). So this last proposal should
be viewed as provocative and is mainly aimed at stimulating
discussions and cryptanalysis.
We conclude by showing the LR CPA security of DTE
and DCE. Given that we are interested in a confidentiality
property, the unbounded leakage model is not suitable any-
more: it would immediately leak the plaintext corresponding
to each encrypted message. We then turn to the simulatable
leakage model [43], which we extend in order to capture a
notion of simulatable leakage for hash functions (only block
ciphers have been considered in that model until now). In
this context, the LR CPA security means that one can reduce
the security of a primitive for many messages and blocks to
the security of the primitive for one message block, without
claims on the exact security of this iteration (which depends
on the implementations) ‚Äì see [37] and Section 7 for the
details. While we are aware of the ongoing discussion about
how to implement block ciphers ensuring simulatable leak-
ages [27], this assumption remains the most realistic solution
to reason about leakage we currently have (and in particular,
1 See Table 4 in [37] for an illustration of these overheads.
Ciphertext Integrity with Misuse and Leakage
Conference‚Äô17, July 2017, Washington, DC, USA
the only one that can be challenged by hardware engineers).
It is also shown by Fuller and Hamlin to be one of the least
demanding assumptions available in the LR literature, com-
pared to bounded leakages or indistinguishable leakages for
instance [21]. Besides, we insist that we only use it to show
that our CIML-secure schemes maintain the same LR CPA
security level as previously published LR encryption schemes
(i.e., that our improvements on the INT-CTXT side have no
downside on message confidentiality compared to the state-of-
the-art). The properties of our constructions are summarized
in Table 1.
Table 1: Summary of our constructions. LMCPA =
leakage resilient chosen plaintext attack security for
multiple messages and blocks; (‚úü‚úüLR) MR = misuse-
resistance in the absence of leakage; CIML = cipher-
text integrity with misuse and leakage; LF execu-
tions counts the number of executions of the leak
free component that are required for an encryption;
the models are either the standard one, denoted std.,
or the random oracle model, denoted RO.
LMCPA (‚úü‚úüLR) MR CIML
LF executions
PSV-AE
DTE