Service Plan: SP1SP 2QoS-Aware FT MiddlewareWeb Service s12Web Service s11Web Service s1m1InternetWeb Service s22Web Service s21Web Service s2m2Service Community S1Service Community S2Coordinator 1Coordinator 2Service BrokerUDDI RegistryQoSExecution EngineSP nFT-BABHEUFT StrategiesMid.Mid.Figure1.QoS-AwareFTMiddlewarevicecommunity,whichisalsointroducedin[2,27],deﬁnescommonterminologiesthatarefollowedbyallparticipants,sothattheWebservicesdevelopedbydifferentorganiza-tionshavethesameinterfacesandcanbedynamicallyre-placedbyotherfunctionallyequivalentWebserviceatrun-time;4)serviceplan,whichisdeﬁnedinDeﬁnition1,isanabstractdescriptionofactivitiesfortheSOAsystems.Deﬁnition1AserviceplanSPisatriple(T,P,B),whereT=SLT∪SFTisasetofstatelesstasks(SLT)andstate-fultasks(SFT),Pisasetofsettingsintheserviceplan(e.g.probabilitiesofthebranchesandloopsstructures,partialmergeparameteroftheparallelstructures),andBprovidesthestructureinformationoftheserviceplan,whichcanbespeciﬁedbyXMLbasedlanguages,suchasBPEL[12].Asthebasicassumptionofthework[1,26,27,29],wealsoassumethatforeachtaskinaserviceplan,therearemultiplefunctionallyequivalentservicecandidatesintheservicecommunitycanbeadoptedtofulﬁllthetask.Thispaperfocusesonhowtoemploythenon-functionalperfor-manceofthecandidatesandthepreferenceofserviceusersfordynamicoptimalfaulttolerancestrategydetermination.AsshowninFig.1,theworkproceduresofourmiddle-wareareasfollows:1)aserviceuser(usuallythedevel-operoftheSOAsystem)deﬁnesaserviceplan,2)themid-dlewareobtainsalistofcandidatesandtheiroverallnon-functionalQoSperformanceforeachtaskintheserviceplanfromdifferentservicecommunities,3)thealgorithmFT-BABHEUdeterminesoptimalfaulttolerancestrategiesforthetasksintheserviceplan,4)theexecutionengineinthemiddlewareexecutestheserviceplanbyinvokingWebserviceswiththeselectedfaulttolerancestrategy,and5)theQoSmodulerecordstheQoSinformationoftheinvokedservicesandexchangesthisinformationwiththecommu-nitycoordinatorsfornewoverallQoSinformationoftheWebservices.3.QoSModelandFaultToleranceStrategies3.1.User-collaboratedQoSModelInthepresenceofmultipleWebserviceswithidenti-calfunctionalities,Quality-of-Service(QoS)providesnon-functionalcharacteristicsfortheoptimalWebservicese-lection.Basedontheinvestigationsof[1,13,27],weiden-tifythemostrepresentativequalitypropertiesinouruser-collaboratedQoSmodelforWebservicesasshowninthefollowing.1.Availability(av)q1:thepercentageoftimethataWebserviceisoperatingduringacertaintimeinterval.2.Price(pr)q2:thefeethataserviceuserhastopayforinvokingaWebservice.3.Popularity(po)q3:thenumberofreceivedinvoca-tionsofaWebserviceduringacertaintimeinterval.4.Data-size(ds)q4:thesizeoftheWebserviceinvoca-tionresponse.5.Success-rate(sr)q5:theprobabilitythatarequestiscorrectlyrespondedwithinthemaximumexpectedtime.6.Response-time(rt)q6:thetimedurationbetweenser-viceusersendingarequestandreceivingaresponse.7.OverallSuccess-rate(osr)q7:theaveragevalueoftheinvocationsuccessrate(q5)ofallserviceusers.8.OverallResponse-time(ort)q8:theaveragevalueoftheresponse-time(q6)ofallserviceusers.InourQoSmodel,q1-q4arethesameforalltheserviceusersandareprovidedbytheserviceproviders.q5andq6areaffectedbythecommunicationlinksandaremeasuredbytheserviceusers.q7andq8aretheaveragevaluesofq5andq6,respectively.Theyareprovidedbytheservicecommunitycoordinators.DifferentfromotherQoSmod-els,weintroducetheconceptofuser-collaborationforob-tainingtheoverallQoSinformation(q7andq8),whichcanbeachievedbyencouragingtheserviceuserstocontributetheirindividuallyobservedQoSinformationtothecommu-nitycoordinatorsforexchangingQoSinformationofotherserviceusers.TheoverallQoSpropertiesprovidecriticaldatafortheWebserviceselection,especiallyforthenewserviceusers,whohavenoknowledgeontheperformanceofthefunctionallyequivalentservicecandidates.ThisQoSmodelisextensible,wheremorequalityprop-erties[19]canbeaddedinthefuturewithoutfundamen-talchanges.Giventheabovequalityproperties,theQoSperformanceofaWebservicecanbepresentedas:q=(q1,...,q8).978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
241
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:59:04 UTC from IEEE Xplore.  Restrictions apply. 
Table1.CompositionFormulaforBasicCompositionalStructuresandFaultToleranceStrategiesQoSBasicStructuresFaultToleranceStrategiesPropertiessequenceparallelbranchloopretryrbnvpactivert,ort(x=6,8)n(cid:2)i=1qxikmaxi=1qxin(cid:2)i=1piqxin(cid:2)i=0piqx1ir(cid:2)i=1piqx1im(cid:2)i=1pi(i(cid:2)j=1qxj)mmaxi=1qximmini=1qxiav,sr,osr(x=1,5,7)n(cid:3)i=1qxin(cid:2)i=kSx(i)n(cid:2)i=1piqxin(cid:2)i=0pi(qx1)i1-(1-qx1)r1-m(cid:3)i=1(1-qxi)n(cid:2)i=n2+1Sx(i)1-m(cid:3)i=1(1-qxi)pr,po,ds(x=2,3,4)n(cid:2)i=1qxin(cid:2)i=1qxin(cid:2)i=1piqxin(cid:2)i=0piqx1ir(cid:2)i=1piqx1im(cid:2)i=1pi(i(cid:2)j=1qxj)m(cid:2)i=1qxim(cid:2)i=1qxi……..……..(a) Sequence                           (b) Branch split                           (c) Branch join(d) Loop                                (e) Parallel split                            (f) Parallel join (k≤n)        11P2t1t2t1t0tn+1t1tnt0t1tntn+1t1tn……..……..t1tnP1kFigure2.BasicCompositionalStructures3.2.QoSCompositionAtomicservicescanbeaggregatedbydifferentcompo-sitionalstructures.Figure2showsthebasiccompositionalstructuresfordescribingtheorderinwhichacollectionoftasksisexecuted.Inthebranch-splitstructure,P1={pi}ni=1isasetofexecutionprobabilitiesofdifferentbranches,where(cid:2)ni=1pi=1.Intheloopstructure,P2={pi}ni=0isasetofprobabilitiesofexecutingtheloopforitimes,wherenisthemaximumlooptimesand(cid:2)ni=0pi=1.Intheparallel-splitstructure,alltaskswillbeexecutedinparallel,soeachbranchhasanexecutionprobabilityof1.Theparallel-joinsupportspartial-mergebytheparameterk,whichmeansthatthefollowingtasktn+1willbeexe-cutedonlyaftertheﬁnishofk(1≤k≤n)ormorethankparalleltasks.ThebasicstructuresinFig.2areincludedinBPMN[18]andcanbemappedtoBPEL[12]easily.Weusethesestructurestomodelservicecompositionsinthispaper.TheQoSvaluesofthecompositeservices,whichag-gregateatomicservicesemployingthebasiccompositionalstructures(sequence,parallel,branchandloop),canbecalculatedbytheformulainTable1.Intheparallelstructure,theresponse-time(rt)isthemaximumvalueoftheﬁrstkreturnedparallelbranches.Theparallelstruc-tureiscountedasasuccessifkormorethankbranchessuccess.Sx(i)isdesignedforcalculatingtheprobabil-itythatiparallelbranchesfromallthenbranchessuc-cess,wherex=1,5,7.Forexample,whenn=3,k=2,thenqx=Sx(2)+Sx(3),whereSx(2)=qx1qx2(1-qx3)+qx1(1-qx2)qx3+(1-qx1)qx2qx3andSx(3)=qx1qx2qx3.Data:SPResult:Q:QoSvaluesoftheserviceplanswitchstructuretypedocaseatomictasktireturnqi;casesequenceforeachSPidoQi=flowQoS(SPi)Q=sequence(Qi);returnQ;casebranch-splitforeachSPidoQi=flowQoS(SPi);Q=branch(P,Qi);returnQ;caseParallel-splitforeachSPidoQi=flowQoS(SPi);Q=parallel(Q1,...Qk);returnQ;caseloop-enterQ1=flowQoS(SP1);Q=loop(P,Q1);returnQ;endendAlgorithm1:ﬂowQoSThebasicstructurescanbenestedandcombinedinarbi-traryways.ForcalculatingtheaggregatedQoSvaluesofaserviceplan,wedecomposetheserviceplantobasicstruc-tureshierarchicallyusingAlgorithm1.Whenadecom-posedsub-service-planisabasicstructure,theformulainTable1areemployedforcalculatingtheQoSvalues.ThentheQoSvaluesofthissub-service-plancanbeemployedforcalculatingQoSvaluesofitsparentalplans.3.3.FaultToleranceStrategiesTobuilddependableservice-orientedsystems,thefunc-tionallyequivalentcandidatesinaservicecommunitycanbeemployedasalternativereplicasfortoleratingfaults.Thecommonlyusedfaulttolerancestrategiesforservicecom-positionareidentiﬁedinthefollowingandtheformulaforcalculatingtheirQoSvaluesarelistedinTable1.•Retry.TheoriginalWebservicewillbetriedforacertainnumberoftimesifitfails.InTable1,r(r≥2)isthemaximalexecutiontimesoftheoriginaltask.piistheprobabilitythatt1willbeexecutedforitimes.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
242
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:59:04 UTC from IEEE Xplore.  Restrictions apply. 
picanbecalculatedbypi=(1−q51)(i−1)×q51,whereq51isthesuccess-rateofthetargetWebservice.•RecoveryBlock(RB).AnotherstandbyWebservicewillbetriedsequentiallyiftheprimaryWebservicefails.InTable1,m(m≤numberofcandidates)isthemaximalexecutiontimes,andpiistheprobabilitythattheithcandidatewillbeexecuted.picanbecalculatedbypi=((cid:3)i−1j=1(1−q5j))×q5i.•N-VersionProgramming(NVP).Allthenfunction-allyequivalentversionsareinvokedinparallelandtheﬁnalresultwillbedeterminedbymajorityvoting.•Active.Allthenfunctionallyequivalentversionsareinvokedinparallelandtheﬁrstreturnedresultwithoutnetworkerrorswillbeselectedastheﬁnalresult.Foreachabstracttaskinaserviceplan,therearetwotypesofcandidatescanbeadoptedforimplementingthetask:1)Atomicserviceswithoutanyfaulttolerancestrate-gies.2)Compositeservicewithfaulttolerancestrategies(Retry,RB,NVPandActive).TheselectionalgorithmsproposedinSection4willbeemployedforoptimalcandidatedetermination.Thefaulttolerancestrategiesinthemiddlewarecanbeeasilyreplacedandupdated,sincetheselectionalgorithminSection4isindependentofthesestrategies.4.FaultToleranceStrategySelection4.1.NotationsandUtilityFunctionThenotationsusedinthefollowingofthispaperarede-ﬁnedinTable2.Givenataskti,thereisasetofcandidatesSi.Eachcandidatesijhasaqualityvectorqij=(qkij)ck=1presentingthenonfunctionalcharacteristics,wherecisthenumberofqualityproperties.Sincesomequalitypropertiesarepositive(lagervalueforhigherquality,suchasavail-abilityandpopularity)andsomearenegative(smallervalueforbetterquality),weﬁrsttransformallthepositivequal-itypropertiestonegativeonesusingqkij=maxqki−qkij,wheremaxqkiisthemaximalvalueofallthecandidates.Sincedifferentqualitypropertieshavedifferentscales,weemployaSimpleAdditiveWeighting(SAW)technique[4]tonormalizethequalityproperties,whichisdeﬁnedasfol-lows:˜qkij=(cid:4)qkij−minqkimaxqki−minqkiifmaxqki(cid:5)=minqki1ifmaxqki=minqki(1)Tocalculatetheperformanceofdifferentcandidates,autilityfunctionisdeﬁnedas:uij=utility(qij)=c(cid:5)k=1wk×˜qkij,(2)Table2.NotationsSymbolDescriptionSPaserviceplan,whichisatriple(T,P,B).Tasetoftasksintheserviceplan,T=SLT∪SFT.SLTasetofstatelesstasks,SLT={ti}nli=1.SFTasetofstatefultasks,SFT={SFTi}ni=nlSFTiasetofrelatedtasksoftheithstatefultask.nthenumberoftasksinSP,n=nl+nf.nlthenumberofthestatelesstasksinSP,nl=|SLT|.nfthenumberofthestatefultasksinSP,nf=|SFT|.ninumberofstaterelatedtasksofSFTi,ni=|SFTi|.Siasetofcandidatesforti,Si={sij}mij=1.mithenumberofcandidatesforti,mi=|Si|.ρitheoptimalcandidateindexforti.LCilocalconstraintsfortaskti,LCi={lcik}ck=1.GCglobalconstraintsforSP,GC={gck}ck=1.cthenumberofqualityproperties.qijaqualityvectorforsij,qij=(qkij)ck=1.ERasetofexecutionroutesofSP,ER={ERi}nei=1.nethenumberofexecutionroutesofaserviceplan.pro(ERi)theexecutionprobabilityofERi.SRasetofsequentialroutesofSP,SR={SRi}nsi=1.nsthenumberofsequentialroutesofSP.pctauserdeﬁnedthresholdforER.wherewkistheuser-deﬁnedweightsforpresentingtheprioritiesofdifferentqualitypropertiesandasmalleruijmeansbetterperformance.4.2.FTSelectionwithLocalConstraintsLocalconstraints,LC={lcki}ck=1,specifyuserrequire-mentsforasingletaskinaserviceplan(e.g.,response-timehastobesmallerthan1second).Therearetotallyn×clocalconstraintsforaserviceplan,wherenisthenumberoftasksandcisthenumberofqualityproperties.Usually,usersonlysetasmallsubset.Sinceallthequalitypropertiesaretransformedtonegative,theuntouchedlocalconstraintsaresettobe+∞bydefault,sothatallthecandidatesmeettheconstraints.TheoptimalcandidateselectionproblemforasinglestatelesstasktiwithlocalconstraintscanbeformulatedmathematicallyasProblem1,wherexijissetto1ifthecandidatesijisselectedand0otherwise.Inproblem1,qij=(qkij)ck=1isthequalityvectorofsij,uijistheutil-ityvalueofthecandidatesijcalculatedbyEquation2,andmi=|Si|isthenumberofcandidatesfortaskti.Problem1Minimize:mi(cid:2)j=1uijxijSubjectto:•mi(cid:2)j=1qkijxij≤lcki(k=1,2,...,c)•mi(cid:2)j=1xij=1978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
243
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:59:04 UTC from IEEE Xplore.  Restrictions apply. 