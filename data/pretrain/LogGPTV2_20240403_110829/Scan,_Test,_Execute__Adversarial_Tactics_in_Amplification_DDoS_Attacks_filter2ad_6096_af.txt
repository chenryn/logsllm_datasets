many organizations are now moving their infrastructure to the
cloud and adversaries should hence look for abusable systems there,
it is possible that some actor groups specifically focus on network
ranges owned by enterprises, which we would miss in such a study.
8 FUTURE WORK
Despite the heterogeneity of the overall ecosystem in the spectrum
from script-kiddie to sophisticated actor, our results show that each
attack – even though it might hit hundreds of amplifiers – is remark-
ably similar. This is understandable as the perpetrators are optimiz-
ing for the economies of scale, but it also opens up angles for mitiga-
tion. By identifying, automatically recognizing common tactics and
techniques, and distributing them to defenders for detection [9],
much of current distributed amplification DDoS could be mitigated.
Our findings show that recent proposals such as BGP flowspec could
be highly effective in practice by filtering incoming amplification
requests and not only merely the resulting packet floods towards
the victim. Given this similarity and the fact that essentially every
perpetrator in our study horizontally scaled out to abuse many hon-
eypots in the same attack, also collaborative identification of mali-
cious flows – either at the level of networks or resolvers – could
provide an angle towards reducing this attack vector if servers pro-
viding amplification would run a service that could not be disabled
otherwise. Such an approach creates again interesting but solv-
able research problems to remediate the resulting privacy concerns.
However, it could be a viable and scalable solution as incentives
and costs are aligned for the operators of the abused services.
In this study, we focused on attacks measured by our deployed
honeypots and cannot measure the attacks at the victim’s side. To
understand the behavior of the victims and the actual attack sizes,
future works should focus on a collaboration with victims, cloud
service providers, or DDoS defense companies as an additional van-
tage point. This would allow for further analysis of attack “pulses”
and give insights into the total number of amplifiers used in attacks.
9 CONCLUSIONS
We have analyzed adversarial techniques for amplification DDoS
attacks using 549 honeypots running six amplification protocols
that were rallied to 13,479 attacks over three weeks. We show that
adversaries tend to select the servers with the highest amplification
potential and that adversaries create tests to identify the servers
that would create the largest impact. Additionally, we show the
existence of “memory” of amplification services, which are abused
long after the service is taken down. While the bulk of adversaries
pursue simple techniques at a high level, we show the presence of
highly advanced attacker groups, selectively picking servers and
tactics to perform their attacks with the most firepower.
Session 3D: DoS CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea952REFERENCES
[1] https://cloud.google.com/blog/products/identity-security/identifying-and-
protecting-against-the-largest-ddos-attacks, accessed at 2021-05-05.
[12] Hutchings, A., and Clayton, R. Exploring the provision of online booter
[2] https://www.speedtest.net/global-index, accessed at 2021-05-05.
[3] Anagnostopoulos, M., Kambourakis, G., Kopanos, P., Louloudakis, G., and
Gritzalis, S. DNS amplification attack revisited. Computers & Security 39 (2013).
[4] Blenn, N., Ghiette, V., and Doerr, C. Quantifying the Spectrum of Denial-
of-Service Attacks through Internet Backscatter. In International Conference on
Availability, Reliability and Security (ARES) (2017).
[5] Büscher, A., and Holz, T. Tracking DDoS attacks: Insights into the business of
disrupting the web. In 5th USENIX Workshop on Large-Scale Exploits and Emergent
Threats (LEET 12) (2012).
[6] Czyz, J., Kallitsis, M., Gharaibeh, M., Papadopoulos, C., Bailey, M., and
Karir, M. Taming the 800 pound gorilla: The rise and decline of NTP DDoS
attacks. In Proceedings of the 2014 Conference on Internet Measurement Conference
(2014).
[7] Durumeric, Z., Adrian, D., Mirian, A., Bailey, M., and Halderman, J. A. A
search engine backed by internet-wide scanning. In Proceedings of the 22nd ACM
SIGSAC Conference on Computer and Communications Security (2015), pp. 542–553.
[8] Fachkha, C., Bou-Harb, E., and Debbabi, M. Fingerprinting internet DNS am-
plification DDoS activities. In 2014 6th International Conference on New Technolo-
gies, Mobility and Security (NTMS) (2014), IEEE.
[9] Griffioen, H., Booij, T. M., and Doerr, C. Quality evaluation of cyber threat
intelligence feeds.
In International Conference on Applied Cryptography and
Network Security (ACNS) (2020).
[10] Griffioen, H., and Doerr, C. Taxonomy and adversarial strategies of random
subdomain attacks. International Conference on New Technologies, Mobility and
Security (2019).
[11] Griffioen, H., and Doerr, C. Quantifying TCP SYN DDoS Resilience: A Longi-
tudinal Study of Internet Services. In IFIP Networking (2020).
services. Deviant Behavior 37, 10 (2016).
[13] Jonker, M., King, A., Krupp, J., Rossow, C., Sperotto, A., and Dainotti, A.
Millions of targets under attack: a macroscopic characterization of the DoS
ecosystem. In Proceedings of the 2017 Internet Measurement Conference (2017).
[14] Karami, M., and McCoy, D. Rent to pwn: Analyzing commodity booter DDoS
services. Usenix login 38 (2013).
[15] Karami, M., Park, Y., and McCoy, D. Stress testing the booters: Understanding
In Proceedings of the 25th
and undermining the business of DDoS services.
International Conference on World Wide Web (2016).
[16] Kopp, D., Wichtlhuber, M., Poese, I., Santanna, J., Hohlfeld, O., and Dietzel,
C. DDoS Hide & Seek: On the Effectiveness of a Booter Services Takedown. In
Proceedings of the Internet Measurement Conference (2019).
[17] Krämer, L., Krupp, J., Makita, D., Nishizoe, T., Koide, T., Yoshioka, K., and
Rossow, C. Amppot: Monitoring and defending against amplification DDoS
attacks. In International Symposium on Recent Advances in Intrusion Detection
(2015), Springer.
[18] Krupp, J., Backes, M., and Rossow, C. Identifying the scan and attack infras-
tructures behind amplification DDoS attacks. In Proceedings of the 2016 ACM
SIGSAC Conference on Computer and Communications Security (2016).
[19] Krupp, J., Karami, M., Rossow, C., McCoy, D., and Backes, M. Linking amplifi-
cation DDoS attacks to booter services. In International Symposium on Research
in Attacks, Intrusions, and Defenses (2017), Springer.
[20] Kührer, M., Hupperich, T., Rossow, C., and Holz, T. Exit from Hell? Reducing
the Impact of Amplification DDoS Attacks. In 23rd USENIX Security Symposium
(USENIX Security 14) (2014).
[21] MacFarland, D. C., Shue, C. A., and Kalafut, A. J. Characterizing optimal
DNS amplification attacks and effective mitigation. In International Conference
on Passive and Active Network Measurement (2015), Springer.
[22] MacFarland, D. C., Shue, C. A., and Kalafut, A. J. The best bang for the byte:
Characterizing the potential of DNS amplification attacks. Computer Networks
(2017).
[23] Matherly, J. Complete guide to shodan. Shodan, LLC (2016-02-25) 1 (2015).
[24] Paxson, V. An analysis of using reflectors for distributed denial-of-service attacks.
[25] Prince, M. Technical details behind a 400Gbps NTP amplification DDoS attack.
ACM SIGCOMM Computer Communication Review 31, 3 (2001).
Cloudflare, Inc 13 (2014).
[26] Richter, P., and Berger, A. Scanning the scanners: Sensing the Internet from a
massively distributed network telescope. In Proceedings of the Internet Measure-
ment Conference (2019).
[27] Rossow, C. Amplification Hell: Revisiting Network Protocols for DDoS Abuse.
In NDSS (2014).
[28] Rudman, L., and Irwin, B. Characterization and analysis of NTP amplification
based DDoS attacks. In 2015 Information Security for South Africa (ISSA) (2015),
IEEE.
[29] Santanna, J. J., van Rijswijk-Deij, R., Hofstede, R., Sperotto, A., Wierbosch,
M., Granville, L. Z., and Pras, A. Booters—An analysis of DDoS-as-a-service
attacks. In 2015 IFIP/IEEE International Symposium on Integrated Network Man-
agement (IM) (2015), IEEE.
[30] Sassani, B. A., Abarro, C., Pitton, I., Young, C., and Mehdipour, F. Analysis
of NTP DRDoS attacks’ performance effects and mitigation techniques. In 2016
14th Annual Conference on Privacy, Security and Trust (PST) (2016), IEEE.
[31] Sun, Z., Liu, B., and Hu, C. Method for effectively detecting and defending
domain name server (DNS) amplification attacks, 2011.
[32] Thomas, D. R., Clayton, R., and Beresford, A. R. 1000 days of UDP amplification
DDoS attacks. In 2017 APWG Symposium on Electronic Crime Research (eCrime)
(2017), IEEE.
[33] Vetterl, A., and Clayton, R. Bitter harvest: Systematically fingerprinting low-
and medium-interaction honeypots at internet scale. In 12th USENIX Workshop
on Offensive Technologies (WOOT 18) (2018).
A AMPLIFICATION FACTORS
This appendix contains the content of the experiment groups for
all the six different services. For each of the services we include the
Bandwidth Amplification Factor (BAF) introduced by Rossow [27]
as well as the contents of the packets sent by the honeypots.
A.1 RIPv1
The Routing Information Protocol responds on correctly formatted
packets. The BAF is calculated using the most frequently packet.
Real small - Responds with a small routing table consisting of 4
entries. The response has a size of 84 bytes and a BAF of 3.5.
Real large - Responds with a larger routing table consisting of 26
entries. The response has a size of 524 bytes and a BAF of 21.8.
Fake small - Responds with a fixed message of 88 bytes and a
BAF of 3.7 that does not contain the header formats and cannot
be parsed by a RIP protocol format parser: THIS IS A HONEYPOT.
YOUR IP IS LOGGED. DO NOT USE THIS. YOU NOW PARTICIPATE
IN RESEARCH!
Fake large - Responses are non-parsable by RIP parsers and are
larger, consisting of 413 bytes and have a BAF of 17.2: This is a
honeypot! This is not a real server! You should not use this RIP server!
Your IP is logged. We use this server to investigate who connects to it
and what happens with anyone that is connecting! So it is really best
you do not use this server! And if you do, please leave a cool message,
since we log all the packets anyway ;) - Thanks a lot for participating
in our research - Project Honeypot Research.
A.2 CharGen
The Character Generation protocol discards any received input.
For any request, it will return a random number of characters. The
maximum amplification is thus achieved by sending a single byte.
Real small - This group responds with a string that is rotated by
one byte after every received request. The size of the response is 94
bytes and has a BAF of 94: !"#$%&’()*+,-./0123456789:;?@ABCDEF
GHIJKLMNOPQRSTUVWXYZ[\]^_‘abcdefg.
Real large - Uses the same string as the small server, but rotates it
19 times. The data consists of 1406 bytes and the BAF is 1406.
Fake small - Sends a 94 byte static string indicating that the server
is a honeypot with a BAF of 94: THIS IS A HONEYPOT. YOUR IP IS
LOGGED. DO NOT USE THIS. YOU ARE NOW PARTICIPATING IN
RESEARCH!.
Fake large - Returns a message with 1450 bytes and a BAF of 1450:
This is a honeypot system! This is not a real CHARGEN server! You
should not be using this CHARGEN server! Your IP internet address is
logged in a database. We use this server to investigate who connects
Session 3D: DoS CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea953to it and what happens with these quotes! So it is really best you do
not use this server! And if you do, please leave a cool message, since
we log all the packets anyway ;) We will publish any misuse of this
service on the internet and detect your IP internet address. (Repeated
3x) | Project Honeypot Research.
A.3 QotD
Similar to CharGen, the QotD protocol does not care about user
input and the response can be triggered by a single byte.
Real small - Returns a random quote with a size between 45-50
bytes. The BAF varies between 45-50. An example quote is for
example: To infinity.... and beyond! - Toy Story.
Real large - Responds with large quotes averaging 1450 bytes and
a BAF of 1450. Quotes are selections of Lorem Ipsum2.
Fake small - Responds with a static string of 53 bytes and a BAF
of 53 that indicates that the system is a honeypot: This is a honeypot
attack detector - Researchers.
Fake large - Contains a single static string of 1437 bytes and a BAF
of 1437: This is a honeypot system! This is not a real QOTD server!
You should not be using this QOTD server! Your IP internet address is
logged in a database. We use this server to investigate who connects
to it ans what happens with these quotes! So it is really best you do
not use this server! And if you do, please leave a cool message, since
we log all the packets anyway ;) We will publish any misuse of this
service on the internet and detect your IP internet address. (Repeated
3x) - Project Honeypot Research
A.4 SSDP
SSDP packets will only be sent on valid requests, except for the fake
servers. While those can thus be triggered by sending only 1 byte,
we calculate the BAF using the same packet as in the real case.
Real small - Responds one of the smallest possible responses on an
M-SEARCH request with a size of 272 bytes and a BAF of 2.3. Fields
in brackets are set with the correct values at time of the request:
NOTIFY * HTTP/1.1
HOST: 239.255.255.250:1900
DATE: {time}
CACHE-CONTROL: max-age = 1800
LOCATION: http://{server_ip}/rootDesc.xml
SERVER: UPnP/1.0
NTS: ssdp:alive
NT: upnp:rootdevice
USN: uuid:b4ca5004c5334bf4883046f2ee3e871a::upnp:rootdevice
Real large - Returns a response of 430 bytes with a BAF of 3.7.
Fields in brackets are set with the correct values at time of the
request: NOTIFY * HTTP/1.1
HOST: 239.255.255.250:1900
DATE: time
CACHE-CONTROL: max-age=60
LOCATION: http://server_ip:5000/rootDesc.xml
SERVER: OpenWRT/OpenWrt UPnP/1.1 MiniUPnPd/1.9
NT: upnp:rootdevice
USN: uuid:822db064-5a71-4375-ba79-20b582cd9309::upnp:rootdevice
NTS: ssdp:alive
OPT: "http://schemas.upnp.org/upnp/1/0/"; ns=01
2https://lipsum.com
01-NLS: timestamp
BOOTID.UPNP.ORG: timestamp
CONFIGID.UPNP.ORG: 1337
Fake small - Responds with a message of 277 bytes and a BAF of
2.4 that is not parse-able by the protocol: This is a honeypot! This
is not a real server! You should not use this SSDP server! Your IP is
logged. We use this server to investigate who connects to it and what
happens with these quotes! So it is really best you do not use this
server! - Project Honeypot Research
Fake large - Responds with a message of 429 bytes and a BAF of 3.7
that is not parse-able by the protocol: This is a honeypot system! This
is not a real SSDP server! You should not use this SSDP server! Simple
Service Discovery Protocol part of UPnP Your IP network address is
logged. We use this server to investigate who connects to it and what
commands are transmitted to this server! So it is really best you do
not use this server! And if you do, please leave a nice message ;) With
Regards, - Project Honeypot Research
A.5 NTP
The network time protocol is running in virtual machines that run
the NTP software NTPD. The response sizes sent by the honeypots
can vary based on the state of the NTP Deamon.
Real small - In the small server we are running an NTP server
where the NTP amplification vulnerability is fixed. This means that
there is no amplification factor for the adversary.
Real large - Uses a version of the NTP software that contains an
amplification vulnerability in the monlist command. The BAF is set
to at least 46 but can increase depending on the system state.
Fake small - The fake small server sends a non-expected answer
to a monlist request, but does not provide amplification potential.
Fake large - Responds with an unexpected 347 byte long plain
text message on a monlist request, providing a BAF of 43.4: This is
a honeypot! This is not a real server! You should not use this NTPD
server! Your IP is logged. We use this server to investigate who connects
to it and what happens with these quotes! So it is really best you do
not use this server! And if you do, please leave a cool message, since
we log all the packets anyway. Honeypot Research
A.6 DNS
Similar to NTP, the Domain Name Servers are running on virtual
machines, and queries are handled by the BIND DNS server.
Real small - Does not do recursion and only responds messages
with a BAF of 1.6.
Real large - Enables recursion and thus responds to any query
(regular open resolver). The minimum BAF is 1.6 but this increases
based on the request to the resolver.
Fake small - Emulates a DNS server that only resolves queries for
the example.com zone with a BAF of 1.6.
Fake large - Does not parse the incoming packet but responds
with a 352 byte long message providing a BAF of 6.8 on a normal
DNS query on the domain of Google: This is a honeypot! This is not
a real server! You should not use this QOTD server! Your IP is logged.
We use this server to investigate who connects to it and what happens
with these quotes! So it is really best you do not use this server! And
if you do, please leave a cool message, since we log all the packets
anyway ;) | Project Honeypot Research.
Session 3D: DoS CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea954