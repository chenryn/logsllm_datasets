威胁建模，用于对外部威胁的汇总，这里前期考虑的是通用安全威胁，其实有点像风险建模，然后以图形的方式去汇总整个威胁图，这个拓扑图实际上就是按类威胁汇总，图形化显示，然后中间可以加上防护措施，和备注一下缺陷和可能存在的优化点  
## 0x06.附录（CheckList）
一个互联网企业在建设SOC过程中应该考虑的一些点，可能会缺一些东西，欢迎补充
####  1.网络安全
安全措施：
防火墙
IPS
IDS
网络设备ACL
可能出现的安全威胁：
访问控制规则过于松散：主要是any-any，另外大网段的网络控制策略
流量监控
####  2.系统安全
安全措施：
基线扫描
Nessus扫描以及补丁修复
漏洞管理
可能出现的安全威胁：
漏洞得不到及时修复和跟进
####  3.资产安全
安全措施：
资产管理
堡垒机
Symantec Endpoint Protection Manager
针对Web的AWVS
针对操作系统的Nessus
针对数据库的Nessus基线扫描
针对Port的Nmap，后续可能需要Masscan（IPV6）
可能出现的安全威胁：
漏洞管理：漏洞及时追踪和更新，以及补丁修复情况追踪
资产安全度：资产安全程度监控，以及实时汇总和修复（类似云镜，目前PRD，DR，UAT暂无）
专门针对数据库的DBscan漏洞扫描
针对APP安全的MobSF扫描
建议：
对接CNNVD漏洞库
风险监控：巡风
漏洞自查：定期自查，汇总
漏洞管理流程（包括漏洞发现，漏洞修复）
接入DBscan（需要详细评估）
接入MobSF
####  4.终端
安全措施：
终端管理
可能出现的安全威胁：
终端漏洞造成办公区域甚至其他区域门户大开
####  5.人员安全
安全措施：
离职人员账号管控
安全意识培训
安全技术培训
可能出现的安全威胁：
安全审计培训：相关流程
开发，运维安全培训
####  6.邮件安全
安全措施：
邮件安全网关
防病毒
可能出现的安全威胁：
社工，APT攻击
####  7.APT防护
安全措施：
APT攻击防护：SIEM/SOC
应急响应
蜜罐
####  8.Web安全
安全措施
AWVS扫描
渗透测试
代码审计
DNS服务器防护
域名防护
可能出现的安全威胁
风险，威胁修复
API接口
中间件容器安全
####  9.运维安全
安全措施
权限管理
账户管理
变更审计
上传下载文档审计，记录
自动化运维：Puppet，Salt Stack
DevSecOps
####  10.告警安全
安全措施
邮件通知
短信通知
可能存在的安全措施
未涉及所有的基础设施
告警有效性
通知内容
通知人员清单更新
通知实时性
总结一下：
SOC是我这些年来比较钟爱的一个Team，从无到有，从一开始的规划，到后来的稳定运行，就像是看到了自己的孩子成长一样，收获了许多，最后我希望她能够茁壮成长。
## 致谢
感谢我的SOC Leader，Teamates
感谢辉哥，锋哥，刘哥
感谢Felix的Honey蜜罐