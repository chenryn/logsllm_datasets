based on  our understa
al probabilities 
using the discrete values 
those levels manually 
securit
and false 
likelihood 
y problems. 
specify those 
given  in 
4 Experimental 
Results 
TABLE 3. Pre-Deployment 
Ground Truth 
(!mCnlel, 
httpd,tcp.80,apachc) 
WCbSCTVicc, Tep.SO) 
Vulnerability 
rcachabilit)' 
VulExists(\\'cbScr\'cr:CAN2002-0392' 
cTvcr,filcscT\'cr,rpc.IOOOOS 
L"lbcl 
Node I 
Node -I  nctworkScn'iccinfo(wcbScT\"cr. 
Node 5 
Node 10  rcacabilily(wcbs
Node 12  vulExists(filcscT\'cr,\'ullD,molllltd,rclllotcExploit,privEscalalion) 
Node 15  nClworkScrviccinfo(filc$cTvCr,1Il0tlll
Node 17  caIlAcccssFilc(filc$cn"cr.root,writc,'/cxport') 
Node 18  nfsExportlnfo(filcScfvcr:fcxport' ,writc.\\'cbScr\'cr) 
Nodc 19  reachability(wcbscn'cr,filcScnw,nfsProtocol,nfsPort) 
Nodc 2S  nrslountcd(\\'orkstation:lusr local/share' 
,hnpd,rcmolcExpioil. 
td,rpc.lOOOO5,root) 
,filcScn'cr:/cxport' ,rcad) 
pnvEscalalion 
TABLE 4. Good events and attack events 
sends probing p.1ckct HBI (aftcr TCI> 3-way handshakc) 
to port 80 of 
E"cnt I 
but p.1ckct IBI fails. 
i\ lallory (i.c .. thc attackcr) 
wcbScr\'cr. 
Good J>.1ckct IG I gcts into port &) of wcbScn·cr. 
Good p.1ckct IG2 gCIS into port 80 of \\'cbScr\'cr. 
E,'cnl 2 
E"cnt 3 
E,'cnI4  i\lallory scnds probing J>.1ckct IB2 to wcbScr\'cr, 
E"cnt 5  Good p.1ckct NG3 gcts into lX>rt 80 of wcbScr\'cr. 
E"cnt 6  Good p.1ckct NG4 gCIS into lX>rt 80 of \\'cbScr\'cr. 
E"cnl 7 
E"cllt 8 
E"cnt 9 
E\,cnt 10  Good p.1ckct NG6 gcts into thc RPC lX>rt of fiIeScr\'cr. 
E"cnt II  i\ lallory sends probing ]lrt of filcScn'cr: 
Good J>.1ckct NG5 gcls into Ix>rt &) of wcbScn·cr. 
i\ lallory scnds probing p.1ckct NI33 to \\'cbScr\'cr: 
i\lallory scnds probing J>.1ckct NB4 to thc RPC port of fileScr\'cr, 
but ]:l.1ckcl NB2 fails. 
packct NI33 succccds. 
is now in thc stalc spccificd by Nodc 23. 
but J>.1ckct #134 fails. 
J>.1ckct #135 succccds. 
Thc nctwork 
E"cllt 12  Gocxl p.1ckct NG7 gCIS into lhc RPC Ix>n of filcScr\'cr. 
E,'cnt 13  Gocxl  J>.1ckct NG8 gCts into thc RPC  Ix>rt of fileScn·cr. 
E"cnt 14  Gocxl p.1ckct NG9 gcts into thc RPC pon of fiIeSer\'cr. 
E"cnt 15  Binary file X in directory" 
E,'cnl 16  Binary filc X in directory" cxpon" is changcd by anothcr gocxl  uscr. 
E"cnt 17  i\lallory changcs file X in directory" c.xlx>rt
E"cnl 18  Binary filc Y in directory" c.xpon" is changcd by a gocxl uscr. 
E"cllt 19  File X. thc Trojan horse. is cxccutcd by admin. 'Illc Trojan horsc cxccutcs codc on workStation 
cxpon" is changcd by a good uscr. 
a Trojan horsc. 
" to install 
with I'OOt pri"ilcgc. 
E,'cnt 20  Binary filc Y in dircctory 
E"cnt 21  File Y is e.'l:ccutcd 
E"cnt 22  Binary filc Z in directory" c,xpon" is changcd by anothcr gocxl uscr. 
E,'cnt 23  File Z is c.'l:ccutcd by a rcgular uscr. 
.. c.xpon" is changcd by anothcr gocxl uscr. 
by a regul:tr 
IIscr. 
Although the CPT tables of  a BN-based securit
y anal­
questions at proper time points: 
ysis tool are often determined  by human experts,  the 
effectiveness 
be evaluated 
4.1 Evaluation Methodology 
of the BN-based securit
in an objective 
way. 
y analysis tool must 
compromised? 
(Ql) Which machines are very likely to have  been 
In  our experiments, we want to check if the BN­
the Referee 
y  administrator 
the performance 
with  a Referee's. The Referee 
in security 
of a BN-based tool 
ng its outputs 
the ground truth and is absolutely correct. 
based tool can help the 
securit
analysi s .  We evaluate 
by  compari
knows  all 
In  our experiments, the ground truth is  a fully ordered 
sequence of events; 
has complete and perfect 
are malicious and which events 
knowledge on which events 
are legitimate. The order of the events is determined  by 
the start time of the events. For simplic
assume 
that each event will 
differences 
ignore  the 
based tool can only 
IDS sensors, which is already 
securit
BN-based tool actually sees a distorted 
ground truth since the sequence of the events witnessed 
by  each 
truth due to the sensor's false positive, false negative and 
in firewall rules and 
detecti
Moreover, 
(Nessus) vulnerability reports 
to distort the 
ground truth. 
readily available to the 
Note that in our experiments, the 
of the 
ity,  we 
finished. In this way, we 
IDS sensor may be different 
among event durations. The BN­
access the information 
also contribute 
y  administrator. 
from the ground 
be instantly 
generated 
on latency. 
the errors 
version 
by 
In  our experiments, we ask the BN-based tool two 
(Q2) Which exploits 
have happened 
but not been de­
tected 
yet? What alerts are missing? 
These two 
questions are typical
We evaluate 
ly asked by the securit
the BN-based tool by compar­
y 
administrator. 
ing its answers 
with the ground truth. 
4.2 Experiment Settings 
In our experiments, we adopt the 
attack 
scenario 
shown 
in Fig .  9. We 
corresponding BN  shown 
in Fig .  1 and  the 
Pre-Deployment 
have two types of ground truth: 
Truth, which addresses the pre-deployment 
, 
and Post-Deployment 
Ground Truth, which focuses on 
the post-deployment 
Ground Truth is 
false vulnerability report 
an imperfect vulnerability scanner. 
attack events.  The Pre-Deployment 
Node 18  is a 
which is mistakenly reported 
Ground 
vulnerabilities
shown in Table 3 .  Note that 
by 
The Post-Deployment Ground Truth includes two types 
will involve different alert events, but all 
attack events and good events. In our settings, 
of events: 
each experiment 
the experiments will in fact have the same sequence of 
and good events. The good events 
interleaved 
and attack 
in our experiments are listed in 
Table 4. In our experiments, we adopt nine alerts  and  one 
false negative as shown in Table 5 .  Note that AE4 is a 
false positive 
events 
adopted 
attack 
events 
alert. 
978-1-4244-7501-8/101$26.00 
©2010 IEEE 
217 
DSN 2010: Xie et al. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:07:12 UTC from IEEE Xplore.  Restrictions apply. 
2010 IEEEIIFIP International 
Conference 
on Dependable 
Systems & Networks (DSN) 
TABLE 5.  Alert .&. 
against Event 1: saying that packet #Bl matches a signature 
against Event 8: saying that packet #B3 matches a signature 
against Event 8 and #83. However, due to detection latency, 
Label  Semantics 
AE 1 
AE2 
AF3 
FNI  False Negative against Event 11: the sensor did not raise any alert about #B5. 
AE-1-
AES 
AE6 
AE7 
AE8 
AE9 
false positive: 
against event 15: saying that file X in directory 
against event 16: saying that file X in directory 
against event 17: saying that file X in directory 
against event 17: saying that file X is a Trojan horse. 
against event 19: saying that Trojan horse is being executed. 
··'export" 
··'export" 
"'export" 
is changed. 
is changed. 
is changed. 
saying that webServer runs a malicious NSF shell. 
compromising 
compromising 
this alert is raised after  Event 
webServer. 
webServer. 
13. 
4.3 Simulation Experiments 
Summary of all results: We  have run six simulation 
experiments. In each  experi
sequence of ground truth and alert events. In  other 
effects  of 
imperfect IDS on the BN-based tool  in 
experiments are different. 
ment, we  adopt 
words, 
these 
a different 
Through 
the six experiments, we compare the answers 
by the BN-based tool is reasonably close to 
Q1 and Q2 with the 
answers, most of the 
from the BN-based tool to questions 
ones from the Referee. Even though the BN-based tool 
does not always give the perfect 
answers  given 
the ground truth. Moreover, 
truth revealed, the answers 
more and more closer 
based tool can effectively infer the missed false negative 
alarm and 
IDS . 
with more and more ground 
from the BN-based tool are 
to the truth. Furthermore
, the BN­
mitigate the disturbance 
caused by an imperfect 
All) ---+ 
E1 ---+ AE1 (report, 
Experiment  1: In this experiment, we use the following 
complete sequence of events: 
E2 ---+ E3 ---+ E4 ---+ E5 ---+ E6 ---+ E7 ---+ E8 ---+ AE2 (do 
not report, AI2) ---+ AE3 (do not enter, 
AI3) ---+ E9 ---+ ElO 
---+ Ell ---+ FN1 (node 1 4 ,  do not report, AI4) ---+ E 1 2  ---+ 
E13 ---+ AE3 (report, 
AI6) ---+ E 1 6  ---+ AE6 ---+ E17 ---+ AE7 (do not report) 
AE8 (report, AI7) ---+ E 1 8  ---+ E 1 9  ---+ AE9 (report, 
AI8) 
---+ E20 ---+ E21 ---+ E22 ---+ E23. 
---+ 
AI5) ---+ E14 ---+ E 1 5  ---+ AE5 (report, 
being 
useful.  When  a 
being compromised is 92.73 % .  Therefore,  the 
about this conclusion. 
the BN-based tool shows the likelihood of file 
being compromised is  53.04% at timepoin
t AI6, 
t 
conclusion though a  weak one. At timepoin
Trojan horse 
the BN-based tool tells the likelihood of webServer 
compromised is 89.92%. At timepoin
t AI6 when alert 
AE5 is visible, the BN-based tool shows the likelihood of 
webServer 
BN-based tool are more confident 
Moreover, 
server 
a correct 
AI7, BN's answer is  more 
is detected, the B N-based tool is able to  tell which  one 
the real cause of the Trojan horse. As shown in Table 
6,  the 
NFS shell attack being the  real 
cause is 57.53% while 
the likelihood of the mountd attack being the real cause 
is 68.93% which  is 
, the BN-based 
tool suggests that the mountd attack is the real cause, 
t  AI8 when 
which is  a correct 
can conclude 
true alert AE9 is detected, the Referee 
that 
workStation has been compromised. It can be seen that 
the BN-based tool also gives the perfect 
WS) .  Other proba
timepoin
t AI7. 
conclusion. At timepoin
BN-based tool derives 
remain the same as those at 
that the likelihood of the 
much higher.  Hence
bility values 
answer (100% 
is 
The BN-based tool also detects 
t is true is 85.06% even though no alert 
the missed alert event. 
In this experiment, the BN-based tool can tell that HIDS­
Alert is a missed alert. As shown in Table 6, the 
that HIDS-Aler
is reported. Therefore, the BN-based tool can help the 
securit
that the HIDS-Alert  is most 
likely missed. Nevertheless, 
tool gives a wrong answer at timepoin
the likelihood of workStation being compromised is 60%, 
which is  a  weak 
the BN-based 
t AI7 by saying that 
we found that 
y administrator 
to  infer 
false alarm. 
likelihood 
In this sequence, ---+ represents 
the absolute time order 
the first timepoin
means that no new evidence visible to the BN­
t 
between events. Command  "report" 
means that a new 
evidence is visible to the BN-based tool. Command "do 
not report" 
based tool. "All" (Answer It) represents 
when the Referee  asks 
the BN-based tool to 
Q2. "AI2" represents  the 
The results of Experiment 1: As shown in  Table 
"WEB" denotes webServer; "FS" denotes fileServer; 
denotes 
table ,  each column represents (a) a timepoin
t when the 
BN-based tool is asked to answer Q1 and Q2, and (b) 
the  corr
and the 
BN-based tool at that specific timepoint. 
6 ,  
"WS" 
on; "NFS" denotes "NFS shell". In this 
second answer-it timepoint, etc. 
given by the Referee 
esponding 
workStati
answer Q1 and 
answers 
The results 
from Experiment 
1  show that the BN-based 
y  administrator 
tool can help the securit
to find the most 
likely compromised machine. As shown in Table 6, the 
BN-based tool gives a reasonably correct  answer 
at time­
point AI5 when alert AE3 is reported. At  this timepoint, 
1 except 
latency, 
latency 
detection 
i .e . ,  it is raised after Event 
3 
and  the 
show that the BN-based tool can generate 
consistently well in 
4 shows that the 
in most timepoints. (b) Experiment 
results 
Results of the Other Experiments: The  other 
experi­
for the following 
ments are similar to Experiment 
differences .  (a) Experiment 2 lets false alert FN1 have 
substantial 
1 8 .  The results 
useful conclusions 
lets the alert AE8 have detection 
show that the BN-based tool performs 
identifying delayed alerts. (c) Experiment 
BN-based tool can leverage additional 
beyond alerts and vulnerability reports. The ability to use 
extra evidence in a handy way is a major advantage 
of the 
BN-based tool. In this experiment, the  results 
event that file 
correlati
X is executed 
the likelihood 
of workStation being compromised. (d) Experiment 
shows that the BN-based tool has strong capability in miti­
gating the disturbance 
generated by false positives: 
the BN­
based tool can 
of  a false alert. In this experiment, we first let the false 
alert ,  AE4 be raised, and true alert AE5 be raised later. The 
on evidence such as AE5 and  the 
on workStation increases 
types of evidence 
give a correct 
show that 
5 
answer even in the presence 
978-1-4244-7501-8/10/$26.00 
©2010 IEEE 
218 
DSN 2010: Xie et aL 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:07:12 UTC from IEEE Xplore.  Restrictions apply. 
2010 IEEEIIFIP International 
Conference 
on Dependable 
Systems & Networks (DSN) 
All 
QI, 
Referee's Non, 
BN's 
83.13% WEB 
85.06% lllDS..ALERT 