4806
LDR
r0,[pc,#24]
r0
00000000
：80x08000120
Dx08000106 4700
0x08000108 E7FE
BX
0x08000108
0
x00000000
0x0800010A E7FE
日
B
0x0800010A
C00000000
0x0800010C E7FE
B
0x0800010C
AULUUUOUAU
x00000000
x00000000
x00000000
14
13
(as)
15
Systes
Danked
hrivilepa
Iod.
hrivileped
Thread
Stack
States
4S
Geo
0. 00000000
---
## Page 1045
CTF特训营：技术详解、解题方法与
27.7专业调试工具
1045/1144
图27-30
）调试开始
下断点的方法为，在要下断点的位置前的灰色或绿色区域单击即
可，如图27-31所示。
Disassembly
0x080000FA0800
LSRS
0x080000FC 0730
LSLS
r0,r6,#28
0x080000FE 2000
MOVS
r0,#0x00
0x080001004806
LDR
r0,[pc,#24]
：@0x0800011C
0x080001024780
BLX
ro
0x080001044806
LDR
r0，[pc,#24]
：@0x08000120
0x08000106 4700
BX
ro
SALS SULUUUOUA
0V08000108
图27-31Disassembly窗体下断点
调试界面的总体窗口的布局如图27-32所示。
BOIRF
反汇编
奇存器
调试指令窗口
堆栈/内存窗口
---
## Page 1046
CTF特训营：技术详解、解题方法与
27.7专业调试工具1046/1144
图27-32调试界面总体布局
另外，寄存器区只有基本的内核寄存器，如果要查看GPIO或
USART的寄存器状态，就要用到其中的SystemViewer功能了，依次
选择Peripherals→SystemViewer，如图27-33所示
这里包含了所有外设的寄存器，可以选择某一个外设进行查看
其仿真功能还是非常全面的。另外，针对UART，这里自带了一个将
USART转化为Terminal的小工具。单击工具栏上的SerialWindows选
择对应的USART即可，如图27-34所示。
打开之后，我们就可以在右下角的UART#1窗口中与程序进行
UART交互了，如图27-35所示
介绍了这么多，可以说MDK是最为强大的嵌入式处理器调试工
具，运用得当将会起到事半功倍的效果，当然，这款软件的功能也不
仅仅只有那么多，更多的调试技巧还请读者自行练习和发现。
---
## Page 1047
CTF特训营：技术详解、解题方法与
27.7专业调试工具
1047/1144
 C:\Users\iaheng\Desktop\test\test.uvproj - μVision
File
EditViewProjectFlashDebug
PeripheralsTools
SVCSWindow
Help
5？
System Viewer
FSMC
国0
Core Peripherals
PWR
RCC
Registers
Power, Reset and Clock Control
APB Bridges
GPIO
Begister
Valoe
Core
DMA
AFIO
RO
0x00000000
BKP
EXTI
R1
00000000x0
R2
0x00000000
General Purpose /O
DMA
R4
0x00000000
Extenal Interrupts
SDIO
000000000
0x00000000
Watchdog
RTC
R6
000000000
Real-Time Clock
BKP
R7
0x00000000
R8
0x00000000
Timers
IWDG
6
0x00000000
R10
0:00000000
USARTs
WWDG
R11
0x:00000000
SPI
TIM
R12
(SP)
0x:00000000
R13
0x20000730
I2CInterfaces
I2C
R14 (LR)
OxFFFFFFFF
CAN
SPI
01
R15 (PC)
0x:08000100
xPSR
0x01000000
A/D Converters
USART
USARTI
ISP
0x20000730
ADC
USART2
PSP
0x00000000
CAN
USART3
-System
BASEPRI
000
DAC
UART4
图27-33
SystemViewer打开位置
C:\Users\iaheng\Desktop\test\test.uvproj -μVision
File
Edit
View
Project Flash
Debug
Peripherals Tools
SVCS
Window
Help
品
Reset_Han
国
付
0
→
Registers
x
Disassembly
UART#1
Register
Value
0x0800107A 4620
0x0800107C BD70
UART2
Core
0x0800107E 0000
检
UART#3
0x00000000
R1
0x00000040
008000010000X0
Debug (printf) Viewer
R2
0x00000000
0x08001082
4001
ANDS
OI'TI'TI
0x08001061
0x08001084 B508
PUSH
(r3,1r}
B.4
0x00000046
0x40013800
0x08001086 F7FFFCBB
BL.W
5
0x08000A00
86
0x0000000C
0x0800108A F7FFFB0B
BL.W
0x080006A4
R7
0x20000710
0x0800108E F7FFFBAF
BL.W
0x080007F0
R8
0x00000000
0x08001092 F44F30E1
AON
r0,#0x1C20(
---
## Page 1048
CTF特训营：技术详解、解题方法与
27.7专业调试工具
1048/1144
图27-34UART窗体打开位置
UART#1
F14g 1s:PCTF(0b9d652373a6969ffd99412ac6ef7c77)
F14g 1s:PCTF(0b9d652373a6969ffd99412ac6ef7c77)
F14g 1s :PCTF(0b9d652373a6969ffd99412ac6ef7c77)
F14g 1s :PCTF(0b9d652373a6969ffd99412ac6ef7c77)
F14g 1s :PCTF(0b9d652373a6969ffd99412ac6ef7c77)
F14g 1s:PCTF(0b9d652373a6969ffd99412ac6ef7c77}
F14g 1s:PCTF(0b9d652373a6969ffd99412ac6ef7c77)
F14g 1s :PCTF(0b9d652373a6969ffd99412ac6ef7c77)
F14g1s:PCT
Call Stack+LocalsUART1Memory1
图27-35UART窗体显示当前固件的输出
2.AVRStudio
AVRStudio是ATMEL公司为其AVR单片机开发的集成环境汇编及
开发调试软件，可以免费使用。ATMELAVRStudio集成开发环境
（IDE）包括AVRAssembler编译器、AVRStudio调试工具、AVRProg
串行、并行下载功能和JTAGICE仿真等功能。AVRStudio汇集了汇
编语言编译、软件仿真、芯片程序下载、芯片硬件仿真等一系列基础
功能，与任意一款高级语言编译器配合使用即可完成高级语言的产品
开发调试。这款软件是专门为AVR单片机设计的，具有很强的仿真功
能，利用软件仿真功能可以十分准确地调试AVR单片机的程序。当然
这款软件也仅能用于AVR系列单片机。
---
## Page 1049
CTF特训营：技术详解、解题方法与
27.7专业调试工具
1049/1144
本节将简单介绍一下这款软件的使用。由于AVRStudio为免费软
件，大家可以去Atmel的官网下载（http://www.atmel.com/tools/
ATMELSTUDIO.aSpX)
安装过程非常简单，下面主要介绍如何使用，本书以AVR
Studio4.13为例，截至写作本章时的最新版本为7.0，两个版本略有
区别，但使用上大同小异，在新版本的AVRStudio中，看重增强的是
开发方面的功能，很多功能对我们来说并没有用，因此轻量级的4.13
也是不错的选择，关键在于，如果要使用下一节提到的Hapsim模拟
工具的话，那么该工具并不会支持更高版本的AVRStudio，所以这里
笔者建议读者并不需要非得选择最新版本，对于MCU的仿真功能
4.x版本已经足够使用。
打开AVRStudio之后，默认会弹出Welcome窗口，如图27-36所
示，如果没有弹出，那么可以依次选择Project→ProjectWizard打开
Welcome窗口。
---
## Page 1050
CTF特训营：技术详解、解题方法与
27.7专业调试工具
1050/1144
Welcome to AVR Studio 4
Hew Project
Open
Recent projects
Modified
Show dialog at startup
>
Finish
Cancel
Help
图27-36AVRStudio启动界面
在Welcome窗口中，直接单击Open。文件类型仍然选择All
Files（），然后选择hex文件或者elf文件。单击Open，进入如图27-37
所示的窗口。
---
## Page 1051
CTF特训营：技术详解、解题方法与
27.7专业调试工具
1051/1144
Welcome to AVR Studio 4
Select debug platform and device
Debug platform:
Device:
AVR Dragon
AT90USB1287
AVR ONEI
AT90USB162
AVR Simulator
AT90USB646
AVR Simulator 2
AT90USB647
ICE200
AT90USB82
ICE40
ATmega103
ICE50
ATmega128
JTAG ICE
ATmega1280
JTAGICE mkll
ATmega1281
ATmega1284
ATmega1284P
Open platform options next time debug mode is entered
<<Back
Finish
Cancel
Help
图27-37AVRStudio选择模拟器界面
因为我们没有具体的芯片，所以这里选择模拟器AVR
Simulator，具体芯片型号根据实际需要进行选择即可。选择完毕后点
击Finish按钮，完成之后就进入调试界面，如图27-38所示。