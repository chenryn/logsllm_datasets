title:Efficient Linear Multiparty PSI and Extensions to Circuit/Quorum
PSI
author:Nishanth Chandran and
Nishka Dasgupta and
Divya Gupta and
Sai Lakshmi Bhavana Obbattu and
Sruthi Sekar and
Akash Shah
Efficient Linear Multiparty PSI and Extensions
to Circuit/Quorum PSI
Nishanth Chandran
Microsoft Research
PI:EMAIL
Sai Lakshmi Bhavana Obbattu
Microsoft Research
PI:EMAIL
Nishka Dasguptaâˆ—
Aarhus University
PI:EMAIL
Sruthi Sekar
Indian Institute of Science
PI:EMAIL
Divya Gupta
Microsoft Research
PI:EMAIL
Akash Shahâˆ—
UCLA
PI:EMAIL
ABSTRACT
Multiparty Private Set Intersection (mPSI), enables ğ‘› parties, each
holding private sets (each of size ğ‘š) to securely compute the inter-
section of these private sets. While several protocols are known for
this task, the only concretely efficient protocol is due to the work
of Kolesnikov et al. (KMPRT, CCS 2017), who gave a semi-honest
secure protocol with communication complexity O(ğ‘›ğ‘šğ‘¡ğœ†), where
ğ‘¡  15 and
ğ‘¡ â‰ˆ ğ‘›/2; even when ğ‘¡ = 1, our protocol has nearly 4Ã— lesser com-
munication than [51]. We also implement our protocol and show
it to be up to 5Ã— and 6.2Ã— faster than [51] in the LAN and WAN
settings, respectively in the honest majority setting considered in
their experiments (as an example for ğ‘› = 15, ğ‘¡ = 7 and ğ‘š = 220, our
protocol executes in under 40s in LAN and 245s in WAN settings).
Next, we consider 2 important variants of the mPSI problem
â€“ circuit PSI and quorum PSI â€“ and provide concretely efficient
semi-honest secure protocols in the honest majority setting.
Circuit PSI. The problem of circuit PSI was introduced in the
2 party setting [45] and enables parties ğ‘ƒ1 and ğ‘ƒ2, with their private
input sets ğ‘‹ and ğ‘Œ, respectively, to compute ğ‘“ (ğ‘‹ âˆ© ğ‘Œ), where ğ‘“
is any symmetric function (i.e., ğ‘“ operates on ğ‘‹ âˆ© ğ‘Œ and is oblivi-
ous to the order of elements in it). Circuit PSI allows to keep the
intersection ğ‘‹ âˆ© ğ‘Œ itself secret from the parties while allowing
to securely compute ğ‘“ (ğ‘‹ âˆ© ğ‘Œ) and has found many interesting
applications such as cardinality, set intersection sum [48, 77], and
threshold cardinality/intersection [3, 10, 31, 35, 36, 42, 66, 79, 80].
Circuit PSI has received a lot of attention and has also shown to be
practically feasible in the 2-party context [13, 16, 26, 64â€“66]. The
problem of circuit PSI is equally well-motivated in the multiparty
setting. However, to the best of our knowledge, it has remained
unexplored.
In our work, we provide the first multiparty circuit PSI protocol
achieving a communication of approximately O(ğ‘šğ‘›(ğœ†ğœ… + log2 ğ‘›)).
Concretely, its communication is only â‰ˆ 4Ã— the cost of mPSI.
Quorum PSI. We consider another variant of mPSI, called quo-
rum PSI (qPSI), where a leader ğ‘ƒ1 wishes to obtain the elements
of his/her set that are also present in at least ğ‘˜ of the other ğ‘› âˆ’ 1
partiesâ€™ sets. Such a variant lends itself to natural applications -
e.g. in the context of anti-money laundering [27, 28] and checking
if a list of entities is present in multiple blacklists. We provide an
efficient qPSI protocol in the semi-honest honest majority setting
achieving a communication cost of O(ğ‘›ğ‘šğœ…(ğœ† + ğœ… log ğ‘›)).
We implement both circuit PSI and qPSI protocols showing that
these protocols are concretely efficient as well. These are the first
implementations of multiparty circuit PSI and quorum PSI.
Protocol blueprint. Our protocols for all three problem settings,
namely, mPSI, circuit PSI and qPSI, broadly have two phases. At a
high level, in the first phase, a fixed designated party, say ğ‘ƒ1, inter-
acts with all other parties ğ‘ƒ2, . . . , ğ‘ƒğ‘› using 2-party protocols. In the
second phase, all parties engage in ğ‘›-party protocols to compute a
circuit to get the requisite output. We describe these phases in the
context of mPSI and then discuss the changes for the other variants.
For mPSI, in the first phase, we invoke a two-party functionality,
which we call weak private set membership (wPSM) functionality,
between a leader, ğ‘ƒ1 and each ğ‘ƒğ‘– (for ğ‘– âˆˆ {2, Â· Â· Â· , ğ‘›}). Informally,
the wPSM functionality, when invoked between ğ‘ƒ1 and ğ‘ƒğ‘– on their
individual private sets3 does the following: for each element in
ğ‘ƒ1â€™s set, it outputs the same random value to both ğ‘ƒ1 and ğ‘ƒğ‘–, if
that element is in ğ‘ƒğ‘–â€™s set, and outputs independent random values,
otherwise4. By invoking only ğ‘› instances of the wPSM functionality
overall, we ensure that the total communication complexity of this
phase is linear in ğ‘›. In the second phase, all the parties together
run a secure multiparty computation to obtain shares of 0 for each
element in ğ‘ƒ1â€™s set that is in the intersection and shares of a random
element for other elements. Having invoked wPSM between ğ‘ƒ1 and
every other party, this can be computed using a single multiplication
protocol. We evaluate this multiplication using the MPC protocol
from [21, 52] in the second phase, resulting in the total communi-
cation complexity being linear in ğ‘›. In contrast, in [51], each party
interacts in 2ğ‘¡ instances of a wPSM-like functionality, incurring an
additional multiplicative ğ‘¡ overhead.
In our circuit and quorum PSI protocols, the first phase addition-
ally includes conversion of the outputs from the wPSM functionality
to arithmetic shares of 1 if ğ‘ƒ1 and ğ‘ƒğ‘– received the same random
value, and shares of 0, otherwise (this is similar to how 2-party
circuit-PSI protocols work). In the second phase, in circuit-PSI, for
every element of ğ‘ƒ1, all parties must get shares of 1 if that element
belongs to the intersection, and shares of 0, otherwise. To do this,
we use the following trick: for every element ğ‘¥ in ğ‘ƒ1â€™s set, count
the number of other sets ğ‘ğ‘¥ in which element ğ‘¥ is present (the
first phase of our protocol does indeed give us such a count). Now,
if we compute ğ‘¤ğ‘¥ = (ğ‘ğ‘¥ âˆ’ (ğ‘› âˆ’ 1))ğ‘âˆ’1 over Fğ‘, where ğ‘ > ğ‘› is
prime, then ğ‘¤ğ‘¥ = 0 if ğ‘ğ‘¥ = ğ‘› âˆ’ 1 (and 1 otherwise), which pre-
cisely gives us whether or not ğ‘¥ is in the intersection. Hence, one
can compute shares of whether ğ‘¥ is in the intersection or not by
simply computing this polynomial (which can be securely done
using 2 log ğ‘ multiplications). In the case of qPSI, we appropriately
choose another polynomial such that for each element in ğ‘ƒ1â€™s set,
the polynomial evaluates to 0 if and only if that element belongs to
the quorum intersection, and random otherwise.
Next, we make a few observations on our protocol blueprint. As
already mentioned, this blueprint allows us to get sub-quadratic
complexity in ğ‘› for all our protocols. Moreover, in the first phase,
ğ‘ƒğ‘– for ğ‘– â‰  1 interacts with ğ‘ƒ1 alone. As an example, in mPSI, ğ‘ƒğ‘–
only engages in one instance of wPSM, whereas ğ‘ƒ1 engages in ğ‘› âˆ’ 1