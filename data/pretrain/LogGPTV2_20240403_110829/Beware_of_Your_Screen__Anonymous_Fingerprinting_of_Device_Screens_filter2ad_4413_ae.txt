year. Specically, users change their phones with two main reasons:
the phone is outdated; the phone is broken. For the rst one, the
evolution of hardware has been slowed in recent years, so our
surveyed users, in average, change their phones with this reason
for more than 1.6 years. For the second one, accidents breaking their
phones happen in average every one year, which is not frequent.
Mask generation. Our study shows that mask generation on
Nexus 6 takes 0.05 seconds on average. We compare it to the delay
of QR code displaying using WeChat, a leading wallet app, to under-
stand its impact. Specically, to measure the delay of Wechat, we
run a phone with a 29Hz camera to record the whole QR generation
process in the app, from the moment when the button is clicked
until the code is displayed. The recording shows that the app takes
around 276ms (8/29s) to generate and show the QR code. So, we
conclude that the overhead introduced by AnonPrint (only 50ms)
is small for the o-line payment.
Fingerprint extraction. After a screen image is taken, the nger-
print is extracted and sent to the payment service provider through
the POS network. Such an image is of the size of 80-100 KB in
the JPEG format. Our desktop takes 0.64 seconds to extract the
ngerprint from it.
Fingerprint verication. Our study nds that this step takes 2.4
seconds on average and the overhead is incurred by the ternary
search for the correct contrast factor k when matching the nger-
prints. The overhead is noticeable but not signicant, given the
fact that just acquisition of QR code from a screen typically takes 1
second, not to mention the further delays in communication and
processing on the payment provider side, in an o-line payment
transaction. The performance of this search step could be improved
by calculating the left and right forks during the ternary search in
parallel, which could reduce the processing time by half.
6 DISCUSSION
Environment Variance. One limitation of our work is that the
ngerprint extraction process may be interfered by strong ambient
light. The precision of the ngerprint extraction scheme might
be impacted under such circumstances. However, the QR code
scanning usually happens in controlled and dim environment (e.g.,
inside a store), to facilitate rapid QR code recognition. Therefore, the
extracted ngerprint is usually free from glare. To guarantee dim
environment, some scanner manufactures designed their scanners
with lens facing up, as shown in Figure. 12. In this way, when
being scanned, the phone covers the whole scanner and makes the
scanning environment nearly completely dark.
Figure 12: A scanner facing up.
Aging Problem. The ngerprint of a screen may dier along time
because of hardware aging, which may fail users’ legal transactions.
This could be solved by updating the ngerprint periodically. Be-
cause nowadays users frequently make mobile transactions, the
server may notice the shift and update the ngerprint thereby.
Specically, when the interval between consecutive transactions
is small, the server could update the ngerprint if the ngerprint
has a relatively large deviation but the transaction still passes the
authentication.
7 RELATED WORKS
7.1 Hardware Fingerprint.
Besides screens, a lot of hardware modules on smartphones have
their unique features enabling users tracking.
Radio frequency ngerprint. Arackaparambil et al. proposed a
technique using the clock skews of the radio frequency modules of
802.11 networks to uniquely identify wireless network devices [7].
PARADIS was proposed to detect the source network interface
card of an 802.11 frame using passive radio-frequency analysis.
The work mainly exploits the imperfection of the transmitter [11].
Again, in 802.11 networks, {Machine, NIC Driver, OS} together are
used to ngerprint a network device [15]. Besides Wi-Fi network de-
vice ngerprinting, there is also a generic RF device ngerprinting
86
Beware of Your Screen
ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
scheme [27]. However, those methods cannot be directly applied
to track the payer, because the o-line payment does not require a
Wi-Fi network.
Sensor ngerprint. Accelerometers that are widely equipped on
smartphones can be used to ngerprint the phones [16], because of
the manufacture imperfection. Besides, smartphone speakers are
dierent from one phone to another, which enables applications
running on the phone to measure the characteristics of the sound
played by the phone for ngerprinting [14]. The process can even
be silent to people around [28]. However those hardware based
ngerprinting schemes cannot be used to protect the payer from
attackers who controlled the operating system, as those ngerprints
can be easily measured by the OS and then sent to attackers. With
those ngerprints, an attacker can manipulate the outputs of the
sensor, making them appear to have a correct feature, as a result,
bypassing the authentication.
7.2 Unconventional Tracking Method.
Besides hardware based tracking methods, there are a lot of uncon-
ventional tracking methods that trace device users silently without
using hardware feature.
Web browser tracking. To track a web browser user, the attacker
can check the availability of a specic font set, time zone, screen
resolution etc, without the help of traditional cookie [10]. Besides,
versions and congurations that appear in the HTTP request head
can be used to ngerprint the user [17]. Nikiforakis et al. demon-
strated that how over 800,000 users are ngerprintable even when
they are using user-agent-spoong extensions [22].
Miscellaneous tracking. Smartphones can be tracked simply
through their personalized device congurations [19]. The applica-
tions installed on a phone can also be used to predict the trait of
the phone user [25].
7.3 Biometric 2nd factor authentication.
A lot of biometrics can be used to authenticate users as assistance
to password. Besides regular ones that have been widely deployed,
like face, ngerprint and iris, there are also some implicit biometric
authentication methods.
Keystroke dynamics. Dierent people typing even the same pass-
word have dierent patterns, which also can be used to authenticate
users. Banerjee et al. and Teh et al. surveyed some works related
to keystroke dynamics as authentication and identication [9, 26].
Keystroke dynamics cannot be used the in QR code payment sce-
nario because payers do not need typing. Besides, according to
the survey, the best scheme supporting both text and digits input
(nowadays, most passwords require both types) on the mobile plat-
form still have a 12.8% EER [13], even with a modied device: that is,
an FRR and FAR both reaching 12.8%. On mobile platform, the error
rates are even worse, as they can exceed 13% [12, 20]. This level of
eectiveness is well below what we can do even on anonymized
screen ngerprints.
Gait. Gafurov et al. proposed a framework to use the motion sensor
on wearable devices to do gait authentication and identication[18].
Ngo et al. presented a large database containing 744 subjects, which
87
enables them to optimize gait authentication algorithms consid-
ering dierent genders, ages ground conditions etc [21]. The gait
biometrics however can hardly be collected in our scenario because
the QR code payment is oine, in which case the service provider
has no access to the inertial sensor output information.
8 CONCLUSION
In this paper, we present a new technique that enhances the security
protection to popular QR-based payment, without undermining the
payer’s privacy. Our technique leverages the features of the payer’s
screen, which is characterized by its unique luminance unevenness
introduced by the imperfect manufacture process, ensuring that
even when the payer’s digital wallet has been fully compromised,
an unauthorized payment still cannot succeed. The screen features,
however, would raise a privacy concern, were it naively deployed
to authenticate the payer, since it could be abused by the vendors to
link one’s dierent purchases together. To address this concern, we
present AnonPrint that obfuscates the phone screen during each
payment transaction. This new approach defeats the attempt to cor-
relate the payer’s purchase activities and also enables the payment
provider, who can reconstruct the obfuscation mask, to authenticate
the payer. We evaluated its ecacy through experiments, which all
demonstrate the promise of this new solution.
9 ACKNOWLEDGEMENT
We thank anonymous reviewers and our shepherd Amir Houmansadr
for the suggestions. The work was sponsored by Shanghai Sailing
Program. The IU author is supported in part by the NSF 1408874,
1527141, 1618493, 1801432 and ARO W911NF1610127. The CUHK
authors are supported by National Natural Science Foundation
of China (Grant No. 61572415), and the General Research Funds
(Project No. 14208818) established under the University Grant Com-
mittee of the Hong Kong Special Administrative Region.
REFERENCES
[1] 2016.
Apple Pay Is Too Anonymous for Some Retailers.
http:
[5] 2018.
//www.nectarpartners.com.au/single-post/2014/10/20/Apple-Pay-Is-Too-
Anonymous-for-Some-Retailers. [Online; accessed 19-Oct].
[2] 2016. A pos supporting QR code. http://jepower.en.made-in-china.com/product/
fNnQmIEPmxkd/China-IC-Card-Reader-POS-Device-Support-Four-Means-
of-E-Payment-Functions.html. [Online; accessed 19-Oct].
[3] 2016. Spec of a QR code Scanner. http://www.waspbarcode.com/~/media/pdfs/
waspbarcode/products/scanner-pdfs/wdi4600-2d-barcode-scanner.ashx. [Online;
accessed 19-Oct].
5.5 Trillion US Dollar Transactions over QR code in China.
http://www.pymnts.com/news/payment-methods/2017/mobile-payments-hit-
5-5-trillion-in-china/. [Online; accessed 7-Aug].
[4] 2017.
Finding the Transform matrix from 4 projected points.
https://math.stackexchange.com/questions/296794/nding-the-transform-
matrix-from-4-projected-points-with-javascript. [Online; accessed 13-Jun].
[6] 2018. Your Mobile Money Could be Stolen By This Attack. https://freewechat.
com/a/MzIzNzcyNzkzNQ==/2247491423/1. [Online; accessed 3-Sep].
[7] Chrisil Arackaparambil, Sergey Bratus, Anna Shubina, and David Kotz. 2010. On
the reliability of wireless ngerprinting using clock skews. In Proceedings of the
third ACM conference on Wireless network security. ACM, 169–174.
[8] Xiaolong Bai, Zhe Zhou, XiaoFeng Wang, Zhou Li, Xianghang Mi, Nan Zhang,
Tongxin Li, Shi-Min Hu, and Kehuan Zhang. 2017. Picking Up My Tab: Under-
standing and Mitigating Synchronized Token Lifting and Spending in Mobile
Payment. In 26th USENIX Security Symposium (USENIX Security 17). USENIX
Association, Vancouver, BC, 593–608.
https://www.usenix.org/conference/
usenixsecurity17/technical-sessions/presentation/bai
[9] Salil P Banerjee and Damon L Woodard. 2012. Biometric authentication and
identication using keystroke dynamics: A survey. Journal of Pattern Recognition
Research 7, 1 (2012), 116–139.
ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
Zhe Zhou et al.
[10] Károly Boda, Ádám Máté Földes, Gábor György Gulyás, and Sándor Imre. 2011.
User tracking on the web via cross-browser ngerprinting. In Nordic Conference
on Secure IT Systems. Springer, 31–46.
[11] Vladimir Brik, Suman Banerjee, Marco Gruteser, and Sangho Oh. 2008. Wireless
device identication with radiometric signatures. In Proceedings of the 14th ACM
international conference on Mobile computing and networking. ACM, 116–127.
[12] P Campisi, E Maiorana, M Lo Bosco, and A Neri. 2009. User authentication
using keystroke dynamics for cellular phones. IET Signal Processing 3, 4 (2009),
333–341.
[13] Nathan L Clarke and Steven M Furnell. 2007. Authenticating mobile phone users
using keystroke analysis. International journal of information security 6, 1 (2007),
1–14.
[14] Anupam Das, Nikita Borisov, and Matthew Caesar. 2014. Do you hear what i
hear?: ngerprinting smart devices through embedded acoustic components. In
Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications
Security. ACM, 441–452.
[15] Loh Chin Choong Desmond, Cho Chia Yuan, Tan Chung Pheng, and Ri Seng Lee.
2008. Identifying unique devices through wireless ngerprinting. In Proceedings
of the rst ACM conference on Wireless network security. ACM, 46–55.
[16] Sanorita Dey, Nirupam Roy, Wenyuan Xu, Romit Roy Choudhury, and Srihari
Nelakuditi. 2014. AccelPrint: Imperfections of Accelerometers Make Smartphones
Trackable.. In NDSS.
[17] Peter Eckersley. 2010. How unique is your web browser?. In International Sym-
posium on Privacy Enhancing Technologies Symposium. Springer, 1–18.
[18] Davrondzhon Gafurov, Einar Snekkenes, and Patrick Bours. 2007. Gait authen-
tication and identication using wearable accelerometer sensor. In Automatic
Identication Advanced Technologies, 2007 IEEE Workshop on. IEEE, 220–225.
[19] Andreas Kurtz, Hugo Gascon, Tobias Becker, Konrad Rieck, and Felix Freiling.
2016. Fingerprinting Mobile Devices Using Personalized Congurations. Pro-
ceedings on Privacy Enhancing Technologies 2016, 1 (2016), 4–19.
[20] Emanuele Maiorana, Patrizio Campisi, Noelia González-Carballo, and Alessandro
Neri. 2011. Keystroke dynamics authentication for mobile phones. In Proceedings
of the 2011 ACM Symposium on Applied Computing. ACM, 21–26.
[21] Thanh Trung Ngo, Yasushi Makihara, Hajime Nagahara, Yasuhiro Mukaigawa,
and Yasushi Yagi. 2014. The largest inertial sensor-based gait database and
performance evaluation of gait-based personal authentication. Pattern Recognition
47, 1 (2014), 228–237.
[22] Nick Nikiforakis, Alexandros Kapravelos, Wouter Joosen, Christopher Kruegel,
Frank Piessens, and Giovanni Vigna. 2013. Cookieless monster: Exploring the
ecosystem of web-based device ngerprinting. In Security and privacy (SP), 2013
IEEE symposium on. IEEE, 541–555.
[23] Fumihiko Saitoh. 1999. Boundary extraction of brightness unevenness on LCD
display using genetic algorithm based on perceptive grouping factors. In Image
Processing, 1999. ICIP 99. Proceedings. 1999 International Conference on, Vol. 2.
IEEE, 308–312.
[24] Sougata Sen and Kartik Muralidharan. 2014. Putting âĂŸpressureâĂŹon mobile
authentication. In Mobile Computing and Ubiquitous Networking (ICMU), 2014
Seventh International Conference on. IEEE, 56–61.
[25] Suranga Seneviratne, Aruna Seneviratne, Prasant Mohapatra, and Anirban Ma-
hanti. 2014. Predicting user traits from a snapshot of apps installed on a smart-
phone. ACM SIGMOBILE Mobile Computing and Communications Review 18, 2
(2014), 1–8.
[26] Pin Shen Teh, Andrew Beng Jin Teoh, and Shigang Yue. 2013. A survey of
keystroke dynamics biometrics. The Scientic World Journal 2013 (2013).
[27] Oktay Ureten and Nur Serinken. 2007. Wireless security through RF nger-
printing. Canadian Journal of Electrical and Computer Engineering 32, 1 (2007),
27–33.
[28] Zhe Zhou, Wenrui Diao, Xiangyu Liu, and Kehuan Zhang. 2014. Acoustic nger-
printing revisited: Generate stable device id stealthily with inaudible sound. In
Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications
Security. ACM, 429–440.
88