Maelstrom: Are you playing with 
a full deck?︎
Using an Attack Lifecycle Game to Educate, 
Demonstrate and Evangelize︎
!
#cybermaelstrom︎
Shane Steiger, Esq. CISSP︎
Shane Steiger © 2016︎
DEF CON 24︎
$ whoami︎
~ messing with computers since 1989 - TIN, PINE, yTalk, Lynx, MUDs, 
etc. ︎
~ 8 years in a large food manufacturer helping to build and secure 
SCADA/ICS systems across 90+ food manufacturing plants in the 
US. ︎
~ 6 years building out a security function in one of the largest 
pharmaceutical drug distributors in the US. ︎
~ currently Chief Endpoint Security Architect in a large tech company 
building out the roadmaps for desirable Cyber Resiliency techniques 
in the endpoint space. ︎
~ much better than family law! I am more of a geek. ︎
$ disclaimer︎
~ the views and opinions are purely my own based on time in the 
industry and experience. They don’t necessarily reflect the views, 
positions or policies of my employer. ︎
~ oh yeah....this presentation and discussion is not intended to give 
legal advice nor form any kind of attorney/client relationship. I am 
not your attorney and some of the things you might find interesting 
may require consultation with your own attorney (not me J). ︎
!
$ agenda︎
~ unexpected journey to a cyber attack lifecycle game︎
~ research that took me on that journey︎
~ maelstrom the game︎
$ strategy journey︎
~ from a past life, I was asked by a CIO ‘do they win?’ ︎
~ later, asked to look at a solution for over 300k endpoints ︎
~ like most folks – look at requirements, functionality, capabilities and 
operationalization ︎
~ hmmmm....wow I got a pretty heat map that doesn’t seem very 
useful in terms of selecting things at large scale ︎
~ ‘do they win’ stuck with me; find a way to develop better strategic 
choices︎
$ Lockheed Martin Cyber Kill Chain ®︎
Reconnaissance!
• Research,!ID/
selec2on!of!targets!
• Email!addresses!
• Social!
rela2onships!
• Target!technology!
&!topology!
Weaponiza2on!
• Combining!an!
exploit!with!a!
payload!to!
establish/maintain!
access!by!aDacker!!
Delivery!
• Transmission!of!
weapon!to!target!
environment!
Exploita2on!
• Exploit!is!triggered!
on!target!
Installa2on!
• Payload!is!executed!
Command!and!
Control!
• Communica2on!and!
control!is!
established!
between!aDacker!
and!target!
Act!on!Objec2ves!
hDp://www.lockheedmar2n.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driven-Defense.pdf!
Recon/Pivot 
Destruction 
Exfiltration 
$ Lockheed Martin Cyber Kill Chain ®︎
Reconnaissance!
• Research,!ID/
selec2on!of!targets!
• Email!addresses!
• Social!
rela2onships!
• Target!technology!
&!topology!
Weaponiza2on!
• Combining!an!
exploit!with!a!
payload!to!
establish/maintain!
access!by!aDacker!!
Delivery!
• Transmission!of!
weapon!to!target!
environment!
Exploita2on!
• Exploit!is!triggered!
on!target!
Installa2on!
• Payload!is!executed!
Command!and!
Control!
• Communica2on!and!
control!is!
established!
between!aDacker!
and!target!
Act!on!Objec2ves!
hDp://www.lockheedmar2n.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driven-Defense.pdf!
Recon/Pivot 
Destruction 
Exfiltration 
Speciﬁc!public-
use!email!
aliases!for!key!
personnel,!2ed!
to!increased!
inspec2on/intel!
Program!to!ensure!
an2-malware!
solu2ons!are!able!
to!detect!
commodity!exploit!
framework!
dropper!
!
Robust!email!
content!
inspec2on!and!
aDachment!an2-
malware,!
leveraging!
ac2onable!intel!
!
Robust!host-an2!
malware/HIPS!
Containeriza2on,!
limited!use!of!
Java,!Adobe!
Reader!&!Flash!
!
Robust!host!an2-
malware/HIPS!
Robust!proxy/
cloud!hDp!an2-
malware!&!
content!inspect!
with!SSL!decrypt!
Robust!proxy/cloud!
hDp!an2-malware!
&!content!
inspec2on!
IR!process!leverage!
HIPS!&!network!
access!control!from!
neUlow!
Robust!proxy/cloud!!
content!inspect!with!
SSL!decrypt!!and!
ac2onable!intel!
Robust!host!or!
network!DLP!with!
policy!appropriate!for!
development!system!
$ Lockheed Martin Cyber Kill Chain®*misnomer︎
Act!on!Objec2ves!
hDp://www.lockheedmar2n.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driven-Defense.pdf!
Reconnaissance!
• Research,!ID/
selec2on!of!targets!
• Email!addresses!
• Social!rela2onships!
• Target!technology!
&!topology!
Weaponiza2on!
• Combining!an!
exploit!with!a!
payload!to!
establish/maintain!
access!by!aDacker!!
Delivery!
• Transmission!of!
weapon!to!target!
environment!
Exploita2on!
• Exploit!is!triggered!
on!target!
Installa2on!
• Payload!is!executed!
Command!and!
Control!
• Communica2on!and!
control!is!
established!
between!aDacker!
and!target!
*defender'is'the'actor'in'a'kill'chain!''
Recon/Pivot+
Destruction+
Humiliate+
PlantInfo+
DoS+
Ransomware+
Exﬁltration+
Recon&
Weaponiza,on&
Delivery&
Exploit&
Install&
C&C&
Act&on&Objec,ve&
A=ack&Execu,on&Over&Time&
What does this look 
like?︎
$ charting attacker’s progression!
~ looks like a Gantt Chart! A project plan!︎
- Attackers are organized indicating plan progression for campaigns ︎
~ what other evidence have we seen to indicate the attackers seem to 
follow a plan if not a traditional project plan? ︎
- Different skill levels from the same attackers indicating different 
’resources or teams’ ︎
- Different teams using different tool sets ︎
- Different time schedules indicating 'shift work’ ︎
- Follow scripts and make mistakes redoing work or retrying task ︎
$ charting attacker’s plan!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
~ what can defenders do?  attack the project plan!!!︎
IT organizations are experts at messing up project plans!  They do it 
like it is there job!  They even have a methodology!!!︎
!
https://en.wikipedia.org/wiki/Project_management_triangle︎
$ tortuosa concept – attacking attacker’s plan!
Mapping these plans can reveal weakness in the attackers’ plan.︎
$ tortuosa concept – attacking attacker’s plan!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
what techniques can disrupt the attacker’s project plan?︎
~  Time: Strategies to attack – ‘assumed linear time’︎
-  Replays – only accept replayed web sessions with an additional token︎
-  Snapshots – use virtualized environments; revert unpredictably︎
-  Predecessors and Successors – feigning completion︎
~  Resources and Tools: Attack the ‘tools or shift work’︎
-  Create resource unavailability – APT Team F uses Cloudflare; during Team F stage block 
Cloudflare thereby forcing Team F to page out find another team or resource︎
-  Create resource contention – flood your own machines; sacrificial lambs︎
-  Different teams using different tool sets – remove PSEXEC, WMI, PowerShell; your 
management tools that are used against you︎
~  Scope: Create scope creep utilizing deception with fake targets or tarpits︎
~  Cost:  Increase costs by setting the attacker back in progression increases cost to them 
thereby decreasing cost to defender to remediate︎
~  Quality: Create noise and anomalies – attackers, automation and scripts are disrupted︎
!
Recon&
Weaponiza,on&
Delivery&
Exploit&
Install&
C&C&
Act&on&Objec,ve&
A=ack&Execu,on&Over&Time&
$ tortuosa concept – attacking attacker’s plan!
Persistence Disruption︎
Recon&
Weaponiza,on&
Delivery&
Exploit&
Install&
C&C&
Act&on&Objec,ve&
A=ack&Execu,on&Over&Time&
$ tortuosa concept – attacking attacker’s plan!
Tool Unavailability︎
Recon&
Weaponiza,on&
Delivery&
Exploit&
Install&
C&C&
Act&on&Objec,ve&
A=ack&Execu,on&Over&Time&
$ tortuosa concept – attacking attacker’s plan!
Orchestrated False Targets︎
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
***hDps://www.mitre.org/publica2ons/technical-papers/cyber-resiliency-engineering-framework!
$ tortuosa concept – attacking attacker’s plan!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
Mapped: Axiom, Cleaver, Dark Hotel, 
FIN4, 02Hero, SAPU4ALL, 
StuckOnUrDC, OpenYourDir︎
$ tortuosa concept – attacking attacker’s plan!
Recon!
Exploratory!
Phishing!ADacks!
Port!Scans!
Google/Shodan!
Search!
Weaponize!
Custom!Toolset/
0-day!exploit!
Criminal!
Commodity!
Framework!
Metasploit!
Module/PoC!
toolset!
Delivery!
RCE!on!internet!
facing!host!
Malicious!email!
aDachment!
Malicious!URL!
Exploit!
Buﬀer!Overﬂow!
Privilege!
Escala2on!
Malicious!
leverage!of!
user’s!rights!
Install!
Executed!
dropper!pulls!
rootkit!code!
Installa2on!of!
new!backdoor!
via!inline-code!
Ini2al!exploit!
modiﬁes!exis2ng!
service/code!
C&C!
SSL!connec2on!
over!arbitrary!
port!
HTTP/HTTPS!
posts!back!to!
aDacker!C&C!
host!
Data!xfer!via!DNS!
query!
A/O!
(Pivot!&!Recon)!
controlled!host!
used!to!scan!for!
open!ﬁleshares!
(Destruc2on)!
drive!of!
controlled!host!is!
wiped!
(Exﬁltra2on)!
documents!
found!on!
controlled!host!
are!sent!back!to!
aDacker!
$ let’s build a catalog of attack patterns !
Recon!
Exploratory!
Phishing!ADacks!
Port!Scans!
Google/Shodan!
Search!
Weaponize!
Custom!Toolset/
0-day!exploit!
Criminal!
Commodity!
Framework!
Metasploit!
Module/PoC!
toolset!
Delivery!
RCE!on!internet!
facing!host!
Malicious!email!
aDachment!
Malicious!URL!
Exploit!
Buﬀer!Overﬂow!
Privilege!
Escala2on!
Malicious!
leverage!of!
user’s!rights!
Install!
Executed!
dropper!pulls!
rootkit!code!
Installa2on!of!
new!backdoor!
via!inline-code!
Ini2al!exploit!
modiﬁes!exis2ng!
service/code!
C&C!
SSL!connec2on!
over!arbitrary!
port!
HTTP/HTTPS!
posts!back!to!
aDacker!C&C!
host!
Data!xfer!via!DNS!
query!
A/O!
(Pivot!&!Recon)!
controlled!host!
used!to!scan!for!
open!ﬁleshares!
(Destruc2on)!
drive!of!
controlled!host!is!
wiped!
(Exﬁltra2on)!
documents!
found!on!
controlled!host!
are!sent!back!to!
aDacker!
$ let’s build a catalog of attack patterns !
~  MITRE’s CAPEC (Common Attack Patterns and Enumeration 
Catalogue)︎
︎
︎
-  500+ techniques︎
-  Slightly unmanageable for my needs︎
~  MITRE’s ATT&CK Framework (Adversarial Tactics, Techniques & 
Common Knowledge)︎
-  68 techniques!︎
-  More manageable︎
-  Attack lifecycle map︎
-  Win!︎
︎
︎
$ research based attack catalog techniques !
Build catalog of attack patterns – MITRE ATT&CK  Framework – 8/2015***︎
Persistence&
Privilege&Escala,on&
Creden,al&Access&
Host&Enumera,on&
Defense&Evasion&
Lateral&Movement&
Command&and&Control&
Exﬁltra,on&
New&service&
Exploita,on&of&vulnerability&
OS/SoNware&
Weakness&
Process&enumera,on&
SoNware&
packing&
RDP&
Common&protocol,&follows&standard&
Normal&C&C&channel&
Modify&exis,ng&service&
Service&ﬁle&permissions&
weakness&
User&interac,on&
Service&enumera,on&
Masquerading& Windows&admin&shares&(C$,&ADMIN$)&
Common&protocol,&non-standard&
Alternate&data&channel&
DLL&Proxying&
Service&registry&permissions&
weakness&
Network&sniﬃng&
Local&network&conﬁg&
DLL&Injec,on&
Windows&shared&webroot&
Commonly&used&protocol&on&non-
standard&port&
Exﬁltra,on&over&other&network&
medium&
Hypervisor&Rookit&
DLL&path&hijacking&
Stored&ﬁle&
Local&network&
connec,ons&
DLL&loading&
Remote&vulnerability&
Communica,ons&encrypted&
Exﬁltra,on&over&physical&
medium&
Winlogon&Helper&DLL&
Path&intercep,on&
&
Window&enumera,on&
Standard&
protocols&
Logon&scripts&
Communica,ons&are&obfuscated&
Encrypted&separately&
Path&Intercep,on&
Modiﬁca,on&of&shortcuts&
&
Account&enumera,on&
Obfuscated&
payload&
Applica,on&deployment&soNware&
Distributed&communica,ons&
Compressed&separately&
Registry&run&keys&/&
Startup&folder&addi,on&
Edi,ng&of&default&handlers&
&
Group&enumera,on&
Indicator&
removal&
Taint&shared&content&
Mul,ple&protocols&combined&
Data&staged&
Modiﬁca,on&of&shortcuts&