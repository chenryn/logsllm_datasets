4614
unknown
1434 MSSQL
Teredo
3544
NetBios
137
unknown
39455
SNMP
161
5061
SIP
Pkts
4.9M
4.4M
1.7M
1.0M
0.7M
0.4M
0.3M
0.2M
0.1M
0.1M
pps
2
1
0
0
0
0
0
0
0
0
Bpp
412
38
18
66
375
55
53
30
43
410
Pkts
18192
12102
4552
n/a
958
492
34696
564
200
2420
pph
32
21
8
n/a
1
400)
suggests that
these scans are not related to ampliﬁcation
attacks. Likewise, the scans for MSSQL servers rather indicate
other scanning motivations, e.g., identifying devices vulnerable
to exploitation. The low packet sizes for scans for Teredo
tunnels and two unknown services (ports 4614/39455) may
suggest attackers search for devices vulnerable for ampliﬁ-
cation attacks. However, manual payload inspection did not
reveal the intention of these scans.
C. Real-world DRDoS Victims
In this section, we aim to detect DRDoS victims in an
ISP’s network. We follow the intuition that DRDoS victims
will receive large amounts of trafﬁc from ampliﬁers, while
they have never requested data from the ampliﬁers.
Fig. 2: A DRDoS attack against a host V with three attacking
ampliﬁers (M1, M2, M3) and two legitimate hosts (a, b). The arrows
show the average bandwidth per communication stream.
Figure 2 shows a typical ampliﬁcation attack scenario. In
this example, three ampliﬁers (black nodes) are abused by an
attacker to relay large amounts of trafﬁc to the victim. Due
to IP address spooﬁng, the attacker remains invisible to the
victim. However, from the victim’s perspective, the ampliﬁers
can be detected by correlating the in- and outgoing trafﬁc per
client. For example, while ampliﬁer M2 sends trafﬁc with an
average bandwidth of 3 MB/s, V never sent any requests to
M2. In the normal case, such as for legitimate hosts a and b,
we observe a more balanced ratio between in- and outgoing
trafﬁc. Note that a high bandwidth towards a host alone is not
only characteristic for DRDoS attacks. In Figure 2, nodes V
and a may, e.g., transfer large ﬁles using UDP, causing high
transfer rates.
We leverage these observations to detect victims of ampliﬁ-
cation attacks using the Netﬂow dataset. For each client/server
pair, we extract a few network characteristics by aggregating
8In SNMP, the community string is used for authentication purposes, the
default setting of “public” for most devices is therefore wide-spread.
8
Netﬂow data. In this context, a server runs a speciﬁc service
that is vulnerable to ampliﬁcation attacks, thus the servers
represent the set of potential ampliﬁers. We restrict our analysis
on network protocols that use a ﬁxed UDP port and we
can thus identify servers by their (IP address, UDP port)
tuple. For example, to ﬁnd DNS servers, we search for hosts
that send UDP packets with source port 53.9 A client
is
any host, identiﬁed only by its IP address (ignoring client
ports), communicating with a server. We consider all clients
as potential DRDoS victims. In the rare case if both hosts of
a ﬂow communicate on server ports, we treat the hosts both
as client and as server.
We then create a pairﬂow for each client/server pair and
aggregate a few light-weight communication features:
pairf low := 
A client/server pair is identiﬁed by the client IP address
(CIP ), the server IP address (SIP ) and the server’s UDP port
(Sport). We generate multiple pairs per client/server if a server
runs multiple services. For each pairﬂow, we then extract the
number of UDP payload bytes (i.e., in accordance with our
deﬁnition of BAF in Section III) per communication direction,
whereas B2s is the number of bytes from the client to the
server and B2c vice versa. We focus only on UDP trafﬁc and
ignore other protocols like TCP or ICMP. Lastly, we compute
the pairﬂow duration t, deﬁned as the interval between the ﬁrst
and the last packet of the client/server pair. We can use t to
compute average bandwidths of pairﬂows.
We compute the pairﬂows for each hour in our Netﬂow
dataset. That means, for the 12 days of our measurement, we
compute pairﬂows for 288 hours separately. This allows us to
speed up computation and decrease the latency between the
attack and attack detection. We then apply a heuristic to ﬁnd
clients that are potential DRDoS victims in that we i) ﬁlter on
pairﬂows exceeding a trafﬁc threshold and ii) ﬁlter on clients
that received signiﬁcantly more trafﬁc than they sent to the
server. For i), we discard all pairﬂows f where f.B2c  Tr. In our evaluation, we chose a conservative setting
of Tr = 1000, i.e., raise suspicion for all servers (potential
ampliﬁers) that send more than 1000x trafﬁc volume to the
client (potential victim) than they received from it.
Results: Table V lists the 15 DRDoS attacks against
subscribers of the ISP that our analysis on the Netﬂow dataset
revealed. All times listed in the table are GMT. We assigned a
unique label (A–I) to the victims and hide IP addresses for pri-
vacy reasons. As expected, the majority of the attacks involved
DNS ampliﬁcation. The largest attack spanned 711 MBit/s
from 330 ampliﬁers and lasted for three hours. The shortest
attack lasted for 39 sec. with a bandwidth of 212 MBit/s.
Interestingly, attackers already abuse further protocols. We
found four CharGen-based attacks that involved up to 3065
ampliﬁers. Against victims C and G, we observed attacks
abusing both, DNS and CharGen simultaneously. Victim F was
ﬁrst targeted with a low-volume CharGen-based attack, until
the attackers switched to DNS and achieved almost 1 Gb/s
attack capacity.
Attack time span
07/14 00:41:18 – 02:48:46
07/17 17:49:25 – 18:04:36
07/18 01:41:57 – 01:56:08
07/18 01:42:00 – 01:56:12
07/19 22:21:44 – 23:10:32
07/20 12:32:33 – 21:21:41
07/20 18:18:20 – 18:24:44
07/21 14:27:45 – 14:43:55
07/21 14:42:13 – 17:43:50
07/21 18:03:31 – 19:01:40
07/21 18:04:14 – 18:12:47
07/22 12:40:35 – 12:49:54
07/22 13:02:52 – 13:08:06
07/22 15:38:13 – 15:38:52
07/23 12:59:42 – 20:38:42
Port
53
53
53
19
53
53
53
19
53
19
53
19
53
53
53
V
A
B
C
C
D
D
E
F
F
G
G
H
D
I
D
|M|
2631
8501
255
43
7907
16339
367
3065
330
814
453
1151
10573
193
14187
Volume
28238
15300
13260
7306
7567
36314
4227
2619
968873
25296
11503
3841