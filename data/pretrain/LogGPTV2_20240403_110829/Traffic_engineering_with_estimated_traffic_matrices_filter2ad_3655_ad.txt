network, and hence where trafﬁc departs the network.
The stability of the weight setting chosen using the estimated
trafﬁc matrices in the face of such changes in the trafﬁc is a pro-
found beneﬁt of this approach.
These results shows that the results above are not just theoretical
possibilities, but provide a robust and stable solution to a real trafﬁc
engineering problem. The solution is based on the trafﬁc matrices
estimated from link data (such as one would get from SNMP link
measurement), and is practical both in computational load, and ro-
bustness to typical sources of variation found in real networks.
date1 = 2002−07−01
date1 = 2002−07−01
n
o
i
t
a
z
i
l
i
t
i
u
m
u
m
x
a
m
d
e
a
c
s
l
200
180
160
140
120
100
80
60
40
20
0
0
3
6
9
2002−07−01
2002−07−02
2002−07−04
2002−07−06
2002−07−08
y
t
i
c
a
p
a
c
e
s
r
e
v
n
i
r
o
f
n
o
i
t
a
z
i
l
i
t
i
u
m
u
m
x
a
m
d
e
a
c
s
l
200
180
160
140
120
100
80
60
40
20
15
18
21
24
0
0
3
6
9
12
time
(a) OSPF optimization.
2002−07−01
2002−07−02
2002−07−04
2002−07−06
2002−07−08
24
21
15
18
12
time
(b) InvCap weights.
Figure 6: Results based on tomogravity estimates and OSPF optimization on the 1st of July, 2002. The results show the maximum
utilization for the true trafﬁc matrix on each of ﬁve days, over the course of a week, using the weights from the ﬁrst day. Figure (a)
shows the OSPF optimization weights, and (b) shows the InvCap weights — note that both ﬁgures have the same y-axis scale.
7. REFLECTIONS
In this section we reﬂect over limitations in the results presented,
addressing various natural points of criticism.
7.1 Max-utilization
As mentioned in the introduction, we picked max-utilization traf-
ﬁc engineering objective because it is easy to understand and appre-
ciate, not because it is the best or most important trafﬁc engineering
objective. Indeed, there is no single most important objective. Fo-
cusing on max-utilization, we have produced some very promising
results, and we hope that this will inspire others to perform similar
studies for other important trafﬁc engineering objectives.
7.2 Proprietary scaling
For proprietary reasons, we have scaled all max-utilization by a
secret factor so as to hide the true max-utilization in our network.
Obviously, the absolute value is interesting. For example, a typical
operational requirement is that the max-utilization is below 60%.
Hence, improving the MMU as in Table 1 from 100% with inverse
capacity to 57.7% is really important. However, if the scaling was a
factor 2, then the corresponding improvement from 50% to 28.8%
is irrelevant. Nevertheless, trafﬁc grows over time and ability to
improve max-utilization means that we can accommodate far more
growth before we have to invest in new equipment.
7.3 The InvCap bench-mark
There are several reasons why we have used InvCap as a bench-
mark. First, it is a vendor recommended default, hence a natural
starting point for trafﬁc engineering. Second, in [7], InvCap was
found to be a good default in the sense being as good or better then
other simple heuristics like unit weights, or link weights propor-
tional to physical lengths.
More interestingly, [12] found that InvCap weights were as good
as a set of weights optimized for one trafﬁc matrix t1 and applied to
an independently generated trafﬁc matrix t2. The test tells us that
using a clue-less weight setting is at least as bad as the InvCap de-
fault. Hence, improvements over InvCap indicate how much better
our routing is compared to a clue-less one.
As a matter of fact, with no clue about the trafﬁc, we are not
aware of any general technique performing better than InvCap in
practice, not even with general MPLS routing. Recently [24], there
has been interesting theoretical work on oblivious routing that gives
max-utilizations within a factor O(log3 n) from optimality for all
possible demand matrix. This is very surprising and impressive the-
oretical result, but in practice, for realistic IP networks and demand
matrices, it appears that InvCap gets within a factor 2 from opti-
mality, which is much better. The difference is, of course, that the
theoretical result has to take all the most pathological networks and
demand matrices into account. Recently in [25], oblivious routing
has been tested on some concrete networks, getting within a factor
2 from optimality for all possible demand matrices. This is again
theoretically interesting, but the method is too slow to deal with
networks with more than 40 nodes. Moreover, an MPLS imple-
mentation of the solution would require a cubic number of labels,
which is prohibitive for large networks. For contrast, this paper is
focused on techniques that work in practice for large ISP networks.
Indeed the methods are already in use in a decision support sys-
tem for the human network operators responsible for the network
conﬁguration.
7.4 The data sets
There are two major problems in the experiments reported. First,
it is unfortunate that our basic data are proprietary so that other re-
searchers cannot reproduce our results and continue the work with
these data. Also, all our data are from the same network. We did
perform many experiments with this network. For example, there is
more than a month and many topological changes between the ex-
periments reported in §5 and those reported in §6. Nevertheless we
would like to see realistic experiments from other networks. Un-
fortunately, for real networks, most of these data are proprietary.
From [26] we do have good public estimates of the basic topol-
ogy of many major IP networks, except that link capacities are not
so easy to obtain. Also, we have established models for generating
synthetic topologies like those in [27].
The main problem, however, is to get good trafﬁc matrices. Real
networks are highly tuned to the expected trafﬁc so one cannot just
generate the trafﬁc matrix independently. We simply don’t know
of any good method for generating demand matrices to go with the
topologies from [26]. Simple minded ideas like saying that high
degree routers originate a lot of trafﬁc don’t work, for these could
just be hubs in the middle of nowhere.
In [7, 12], a noisy gravity based model from [28] is used to gen-
erate synthetic trafﬁc matrices to go with the synthetic topologies
from [27]. It is easy to test our techniques on these data, but there
is a major caveat; namely that when we use a gravity based method
for generating the trafﬁc, then the simple gravity estimation will be
very accurate. In fact, we get very similar results to those reported
in [12] for noisy data. The answer is that for these kinds of syn-
thetic data, simple gravity gets within a few percent of optimality,
which is much better than what we reported for our real network.
The above illustrates an inherent difﬁculty in generating syn-
thetic demand matrices for our kind of experiment.
If we know
the generator, we cheat if we exploit that in our estimation, but we
also cheat ourselves if our estimator does not exploit the generation.
The basic point is that an estimator is supposed to exploit what we
think is a good model for how trafﬁc arises, and this thinking is
difﬁcult to model.
One could, of course, argue that our data sets are too thin, and
that research in trafﬁc engineering should wait until someone has
found a way of getting better data. Finding better data is clearly
a very important problem of independent interest, but why wait?
Even though our data are not conclusive, they are promising enough
to be of interest for other ISPs. As they get applied, we will get a
better understanding of how they work in the real world. Also, as
better public data emerges, it is trivial to test them in our frame-
work. We just have to rerun the programs.
8. CONCLUSION
We set out in this paper to provide a genuine measure for as-
sessing the practical accuracy of trafﬁc matrix estimation. Simple
metrics are unsatisfactory because one may form any number of
them, and they may return different results, depending on what as-
pect of the trafﬁc matrix is given importance. Hence we wished to
provide a direct connection to a practical problem as a means of
assessing the quality of the results. The means chosen was to test
the routing optimization based on estimated trafﬁc matrices when
used with the true trafﬁc matrix.
Experimenting with data from a large tier-1 ISP, we found some-
thing more, namely that the combination of tomogravity and OSPF
weight optimization was a powerful and practical method for trafﬁc
engineering.
The result arose because the OSPF optimization method was
quite robust to the types of errors found in the trafﬁc matrix es-
timates. MPLS style optimization designed to obtain the very best
possible routing was much less robust. Hence, even if MPLS is
used, it makes sense to use a more robust method to determine the
routes, for instance IGP routing.
The OSPF optimization method had other desirable properties,
such as the ability to optimize weights for a range of trafﬁc matrices
(say over a day) and also to provide weights that worked a whole
week into the future.
The other side of these results was the ﬁnding that the perfor-
mance of the trafﬁc matrix estimates was not a direct function of
the magnitude of the errors in the trafﬁc matrix estimates. This
shows the importance of considering the combination of trafﬁc es-
timation and route optimization before making any conclusions on
how they will work together. Arbitrary error measurements are use-
ful for superﬁcial comparison, but do not tell the true story as far as
practical applications goes.
In the future we wish to examine alternative optimization meth-
ods, and trafﬁc matrix estimation algorithms, but given the quality
of the results here, for the data considered, we do not see much hope
for improved algorithms, only additional insight into the problem.
9. REFERENCES
[1] A. Feldmann, A. Greenberg, C. Lund, N. Reingold,
J. Rexford, and F. True, “Deriving trafﬁc demands for
operational IP networks: Methodology and experience,”
IEEE/ACM Transactions on Networking, vol. 9, no. 3,
pp. 265–279, 2001.
[2] A. Feldmann, A. Greenberg, C. Lund, N. Reingold,
J. Rexford, and F. True, “Deriving trafﬁc demands for
operational IP networks: Methodology and experience,”
IEEE/ACM Transactions on Networking, pp. 265–279, June
2001. An earlier version appeared in SIGCOMM’00.
[3] M. Roughan, A. Greenberg, C. Kalmanek, M. Rumsewicz,
J. Yates, and Y. Zhang, “Experience in measuring backbone
trafﬁc variability: Models, metrics, measurements and
meaning (extended abstract),” in Internet Measurement
Workshop, 2002.
[4] Y. Zhang, M. Roughan, N. Dufﬁeld, and A. Greenberg, “Fast
accurate computation of large-scale IP trafﬁc matrices from
link loads.” in Proc. ACM SIGMETRICS, June 2003.
[5] A. Medina, N. Taft, K. Salamatian, S. Bhattacharyya, and
C. Diot, “Trafﬁc matrix estimation: Existing techniques and
new directions,” in Proc. ACM SIGCOMM, (Pittsburgh,
USA), August 2002.
[6] D. Mitra and K.G.Ramakrishnan, “A case study of
multiservice, multipriority trafﬁc engineering design for data
networks,” in Proc. IEEE GLOBECOM, pp. 1077–1083,
1999.
[7] B. Fortz and M. Thorup, “Internet trafﬁc engineering by
optimizing OSPF weights,” in Proc. IEEE INFOCOM,
pp. 519–528, 2000.
[8] K. Ramakrishnan and M. Rodriguez, “Optimal routing in
shortest-path data networks,” Lucent Bell Labs Technical
Journal, vol. 6, no. 1, 2001.
[9] F. Lin and J. Wang, “Minimax open shortest path ﬁrst routing
algorithms in networks supporting the SMDS services,” in
Proc. IEEE International Conference on Communications
(ICC), vol. 2, pp. 666–670, 1993.
[10] M. Ericsson, M. Resende, and P. Pardalos, “A genetic
algorithm for the weight setting problem in OSPF routing,”
J. Combinatorial Optimization, vol. 6, no. 3, pp. 299–333,
2002.
[11] L. S. Buriol, M. G. C. Resende, C. C. Ribeiro, and
M. Thorup, “A memetic algorithms for OSPF routing,” in
Proc. 6th INFORMS Telecom, pp. 187–188, 2002.
[12] B. Fortz and M. Thorup, “Optimizing OSPF/IS-IS weights in
a changing world,” IEEE Journal on Selected Areas in
Communications (Special Issue on Recent Advances on
Fundamentals of Network Management), vol. 20, no. 4,
pp. 756–767, 2002.
[13] R. K. Ahuja, T. L. Magnanti, and J. B. Orlin, Network Flows:
Theory, Algorithms, and Applications. Upper Saddle River,
New Jersey: Prentice Hall, 1993.
[14] E. C. Rosen, A. Viswanathan, and R. Callon, “Multiprotocol
label switching architecture.” Network Working Group,
Request for Comments,
http://search.ietf.org/rfc/rfc3031.txt,
2001.
[15] J. T. Moy, “OSPF version 2.” Network Working Group,
Request for Comments: 2328,
http://search.ietf.org/rfc/rfc2328.txt,
April 1998.
[16] R. Callon, “Use of OSI IS-IS for routing in TCP/IP and dual
environments.” Network Working Group, Request for
Comments: 1195,
http://search.ietf.org/rfc/rfc1195.txt,
December 1990.
[17] Cisco, “Conﬁguring OSPF,” 2001. Documentation at
http://www.cisco.com/univercd/cc/td/doc/
product/software/ios121/121cgcr/ip_c/
ipcprt2/1cdospf.htm.
[18] E. H. L. Aarts and J. K. Lenstra, eds., Local Search in
Combinatorial Optimization. Discrete Mathematics and
Optimization, Chichester, England: Wiley-Interscience,
1997.
[19] J. Kowalski and B. Warﬁeld, “Modeling trafﬁc demand
between nodes in a telecommunications network,” in
ATNAC’95, 1995.
[20] J. Tinbergen, “Shaping the world economy: Suggestions for
an international economic policy.” The Twentieth Century
Fund, 1962.
[21] P. P¨oyh¨onen, “A tentative model for the volume of trade
between countries,” Weltwirtschaftliches Archive, vol. 90,
pp. 93–100, 1963.
[22] A. Dwivedi and R. Wagner, “Trafﬁc model for USA
long-distance optimal network,” in Proc. Optical Fiber
Communication Conference (OFC), pp. 156–158, 2000.
[23] A. Feldmann, A. Greenberg, C. Lund, N. Reingold, and
J. Rexford, “Netscope: Trafﬁc engineering for IP networks,”
IEEE Network Magazine, special issue on Internet trafﬁc
engineering, pp. 11–19, March/April 2000.
[24] H. R¨acke, “Minimizing congestion in general networks,” in
Proc. 43rd IEEE Symp. Foundations of Computer Science,
2002., pp. 43–52.
[25] D. Applegate and E. Cohen, “Making Intra-Domain Routing
Robust to Changing and Uncertain Trafﬁc Demands:
Understanding Fundamental Tradeoffs,” in Proc. ACM
SIGCOMM, 2003.
[26] N. Spring, R. Mahajan, and D. Wetherall, “Measuring ISP
Topologies with Rocketfuel,” in Proc. ACM SIGCOMM,
2002.
[27] K. Calvert, M. Doar, and E. W. Zegura, “Modeling internet
topology,” IEEE Communications Magazine, vol. 35, no. 6,
pp. 160–163, June 1997.
[28] P. L. Toint. Transportation modeling and operations research:
A fruitful connection. In M. Labb´e, G. Laporte, K. Tanczos,
and P. L. Toint, editors, Operations Research and Decision
Aid Methodologies in Trafﬁc and Transportation
Management, volume 166 of NATO ASI series: Ser. F,
Computer and systems sciences, pages 1–27. Springer, 1998.