件在运⾏，先把进程杀掉等待有⼈上线，但是我⼜不知道
等到猴年⻢⽉，只好⼜把⽬光放在了后台的⼏处信息上。
钓⻥⿊⼿
由于从机器溯源上排查⽆果，所以开始转⼿钓⻥的⼿段。
最终在前台公告和后台设置⾥⾯，发现疑似开发和运营⼈
员三个邮箱，作为钓⻥对象。
狙击⿊⼿的准备（⼀）
接下来制作 Word 宏进⾏钓⻥，因为有了 CobaltStrike
的出现，制作宏病毒的⽅式⼤⼤降低了，但随之的问题也
出现了，因为该⼯具对于宏病毒的⽣成是写死的，⽆法定
制⾃⼰想要构造的恶意执⾏代码，导致恶意代码的特征值
制⾃⼰想要构造的恶意执⾏代码，导致恶意代码的特征值
很容易被抓取，会被发件服务器，收件邮件⽹关，本地杀
毒等⼀系列防护设备或措施拦截。所以为了邮件能进收件
箱，我考虑学习使⽤了免杀⼿段。
⾸先要搞清楚我们的钓⻥邮件在哪⼀个步骤挂掉了。因为
⼀般常⻅的邮件流程如下：
邮件→邮件服务器→防毒→防垃圾→收件箱
⾸先科普⼀下当下杀软的三种查杀⽅式：1. 静态查杀 2.
云查杀 3. ⾏为查杀。邮件服务器为了可⽤性和隐私性⼀
般只有静态查杀。所以我们只需要规避特征值绕过静态查
杀就可以让钓⻥附件进⼊收件箱了。
那么如何规避静态查杀？最好的办法当然是⾃⼰写恶意代
码，但我是个菜鸡，借⽤了⼤佬写好的免杀开源脚本：
“EvilClippy”
下载地址：
https://github.com/outflanknl/EvilClippy/releases
⾸先利⽤ CobaltStrike ⽣成 Office 宏病毒，单击
“CobaltStrike”->“监听器”，在下⽅选择 “Add”，随便
输⼊名字，如 “Office”,HTTPHosts 为 CobaltStrike 服
务端的 IP，这⾥我架设到公⽹上了，随意设置监听端
⼝ 如 “8888”
⼝，如 8888 。
选择 “攻击”->“⽣成后⻔”->“MS OfficeMacro” 开始⽣
成 Office 宏代码，监听器选择刚刚我们开启的。
选择监听器后，单击 “Generate”。
单击 “CopyMacro” 将这段利⽤ CobaltStrike ⽣成的恶
意代码复制下来，接下来打开 Word，我这⾥根据实际情
况认真写了点东⻄，毕竟⼀切为了钓⻥成功嘛。先保存为
启⽤宏的⽂档。
然后单击 “视图”->“宏”, 然后宏名任意设置，宏的位置
为当前⽂档，再单击“创建” 先将原有的代码清掉，这⾥
注意⼀定要删掉再粘贴之前 CobaltStrike ⽣成的代码，
我也不太清楚为什么，不清掉直接覆盖有时候就不好使
（⽞学疑惑）。
保存完后，利⽤ virscan 进⾏⼀波检测，地址：
https://www.virscan.org/
这显然不⾏，这下就⽤到了我们之前提到的⼯具
EvilClippy1-1.3，该⼯具使⽤很简单，⾸先准备⼀个正常
的 VBA 代码，test.vba 代码如下
Sub test()
'
' 该 vb 代码没有任何功能，⽤于迷惑杀软。
'
End Sub
没有错代码就是这么骚⽓，然后执⾏命令 EvilClippy.exe
-s test.vba 计划报表. docm，出现下图所示即为成功，
同时⽣成⼀个新得 docm ⽂件
再次将该⽂件放到 virscan 进⾏查杀，这回就有⼀个检测
出来了，静态免杀基本就完成了。
然后测试通过。
测试成功上线 CS，露出了欣慰的笑容。
狙击⿊⼿的准备（⼆）
接下来做⼀个就开始邮件钓⻥吧，这⾥使⽤ Swaks 绕过
SPF 验证进⾏邮件伪造，Swaks 是⼀个功能强⼤，灵
活，可编写脚本，⾯向事务的 SMTP 测试⼯具，由
JohnJetmore 编写和维护。
测试连通性：
swaks --to PI:EMAIL
我们可以利⽤ Swaks 伪造并绕过 SPF 发送，命令参考
如下：swaks --to xxx\@qq.com --
from110\@police.com --body hacking --header
"Subject: hello" --attach xxxxx.docm--server
mail.smtp2go.com -p 25 –au  -ap 
测试效果⼀下：
接下来就是给搜集到的⼏个邮箱发送免杀钓⻥⽂件，看看
有没有机会捕捉到那⼀丝上线的可能，这将是⼀场持久
战，同时我也尝试的向他们微信客服进⾏钓⻥社⼯，但是
由于这种平台⼤多是群控机器⼈，所以⼀直未有⼈回应，
接下来我只好耐⼼的等待邮箱和他们主机上线的记录。
暴富梦破灭的总结
此⽂就写到这⾥，由于钓⻥社⼯是⼀个⽐较⻓久的环节，
也是⽃智⽃勇的过程，所以最终的⿊⼿还需慢慢的去引
诱，卧薪尝胆，暴富梦虽然就此破灭。但是也可以看出天
下没有掉馅饼的好事，还有可能⼈家惦记着你的馒头，希
望⼤家提⾼警惕避免踏⼊圈套之中，从后台上来看，还是
有不少受害者，同时资⾦都被快速的转移。
全⽂完
本⽂由 简悦 SimpRead (http://ksria.com/simpread) 优化，⽤以
提升阅读体验
使⽤了 全新的简悦词法分析引擎 beta，点击查看
(http://ksria.com/simpread/docs/#/词法分析引擎)详细说明
|---|--|
| 0 |  |
| 1 |  |
|---|--|--|
| 0 |  |  |
| 1 |  |  |
| 2 |  |  |
| 3 |  |  |