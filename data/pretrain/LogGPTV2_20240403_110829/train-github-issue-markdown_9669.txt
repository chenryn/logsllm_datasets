I think the issue can be traced down to `lax.eq(np.inf, np.nan)` returning
True, for some reason. I am on a recent master commit (7328689).
    >>> import jax.numpy as np
    >>> from jax.numpy.lax_numpy import isinf
    >>> from jax import lax
    >>> nan = np.array([np.nan])
    >>> print(nan)
     array([nan], dtype=float32)
    >>> np.isnan(nan)  # Should be True
     array([False])
    >>> np.isinf(nan) # Should be False
     array([True])
    >>> lax.eq(np.nan, np.inf)  # Should be False
     array(True)