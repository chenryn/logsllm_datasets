SRE 机器学习简介
Ricardo Amaro, Acquia
为什么要使用机器学习辅助 SRE 工作？
    一句话：因为技术的发展，现在已经有意义了。
从根本上说，SRE 也就是要求软件工程师来设计运维相关的功能时发生的情况。Ben Treynor Sloss，谷歌工程部。
本章基于我在维也纳 DrupalCon 所作的介绍。在这里，我们将探索一些机器学习解决方案在 SRE 领域的几个应用：
我们如何自动执行那些只会产生辛劳且没人愿意做的重复性任务？
我们如何查看数据并预览我们的系统将来会发生什么？
我们如何加强“将软件工程应用于运营方面”？
操作流程的自动化是我们追求的关键目标。随着人工智能（AI）和机器学习的不断改进，我们可以自动执行的任务不断增加。如果我们保持历史数据，并以编程方式对新事物做出反应，我们将可能事先修复问题，因为系统将提醒我们将要发生的情况，而不是让某人手动分析过去的结果并尝试预览未来。我刚发现 AE35 机组有故障72小时后就会进入 100% 的失败状态。
HAL 9000，2001：太空奥德赛
这让我们有机会利用我们的时间完成更具创新性的任务和功能开发。虽然这当然不是一朝一夕的成就，但最近我们看到机器和人类之间的界限越来越模糊。通过机器学习和自动化提供的进步，我们可以提高团队和企业之间的工作效率。
我尝试使本章尽可能简单，因为它适用于希望了解如何探索和改进关键系统上的自动响应以及降低手动操作工作级别的一些基础知识的人员。这里的目标不是深入探讨机器学习（请参阅本章末尾的参考资料），而只是为了让你了解开始使用其中一些技术是多么容易。因此，我介绍 AI 实现的基础知识，然后给出一些示例，用于使用机器学习技术、行为分析、统计信息以及此域的特定工具。
为什么我的公司应该如何参与这项工作？为什么我的公司应该如何参与这项工作？
一些大中型公司正在采用 AI 和机器学习技术，试图通过它来揭示未知因素，增强人类对复杂交互和数据集的理解。这样可以避免本来没必要的辛劳，并释放资源，使其更具创新性和创造性，为企业带来价值。这也是 SRE 的工作。
机器学习可以帮助解决的一些 SRE 问题
 据推测，我们可以使用自动处理例程和仔细观察所有过去事件的技术来解决 SRE 出现的所有问题，从而推断流程和服务的再生策略。但是，这一天尚未到来，我们现在只能通过研究以 AI 形式巧妙地到达我们工作的自动化创新形式来预见这种前景。
在我的日常工作中，我们运行了数千个实例，支持大量的生产站点。它们生成从多个数据中心传输的数十 PB 的数据以及相应的日志和统计指标。虽然这些看起来是令人窒息的数据量，但我们不断自动化，并试图找到机器可以为我们完成工作的方法。然而警报总是难以避免的，在某种程度上，如果不注意检查警报，系统的场面可能会失控。下面是一些为了改进 SRE 功能而需要解决的操作挑战的列表：
自动降低噪声以过滤掉特定流
查找具有异常检测的异常值，例如群集故障。
围绕“情况”（而不是单个警报）自动执行工作流。
根据行为模式自动对票证进行分类。
预测服务级别的短期和容量规划的长期预测。
除此之外，还有其他现有解决方案，例如用于文本分析（如垃圾邮件过滤、舆情分析和信息提取）。
这些都有望通过机器化的运作作来减少人类的依赖和打扰。
AI 应用方面的觉醒
 作为我组织的高级现场可靠性工程师，我倾向于寻找长期解决方案，使机器为我们工作，这是实现持久自动化的最佳途径。这是一项仍在进行的调查的故事。工作让我有时感到疲累，因为有许多复杂的软件选项（参见#different_software_for_machine_learningdo），也常常需要花费大量的时间和精力来收集服务器上的数据，并整理和处理它。但在其中一个令人疲惫的夜晚，让孩子们上床后，我坐下来随机选了一部 1968 年拍的电影观看。50 年前制作的这个伟大影响与这项研究有很大关系，它激发了我对业界能做些什么的一些明确想法。  Kubrick 出品的 2001：A Space Odyssey 电影中有一个几乎刻意隐藏的信息，即智能是进化的更高范式；它结合了科学，技术，哲学，历史，记忆，就像如今 AI 的工作原理一样。电影唯一的问题是，它预测 2001 年将会发生的未来过于激进。到 2018 年，我们仍然没有发展到这一步。这部电影的远见卓识来自 Arthur C. Clarke，他将 AI 与全自动服务相结合，能够提前数小时预测系统和硬件故障。 HAL 9000是一个自维护、自调节，完美无瑕的机器的梦想（或梦魇），为机组人员和任务提供服务，以实现人类定义的目标。我坚信，我们现在的 2018 年非常接近 2001 年令人难以置信的想象成就。数据科学和机器学习软件已有一段时间可用。他们使用的语言使工程师更容易访问它们，以探索应用机器学习的新方法。在#different_software_for_machine_learningdo中，我们看到 Python 和 R 语言是这个领域的明显赢家。值得注意的是，Anaconda、TensorFlow 和 scikit 学习都使用 Python 与用户进行连接。在本章后面的动手部分中，我们使用 TensorFlow、Python 和一些 Keras。
用于机器学习的不同软件（来源：https://www.kdnuggets.com/2017/05/poll-analytics-data-science-machine-learning-software-leaders.html）
什么是机器学习？什么是机器学习？
 机器学习 是指用于创建算法的统计方法，该算法可以逐渐通过学习提升准确度，且更加强调使用计算机统计学方法来估计复杂的函数并证明围绕这些函数的置信区间。这些方法使用两种统计方法：  频率估计和贝叶斯推理。到 2024 年，人工智能市场预计将膨胀至3万亿美元规模，机器学习是人工智能的一部分，且是增长最大的部分。
每次你使用谷歌搜索来查找内容时，每次 Facebook 在照片中识别你朋友的脸，每次计算机将某些内容标记为垃圾邮件时，这些都是机器学习的示例。 机器学习的工作原理是使用智能代理。Russell, S. J. 和 Peter Norvig。人工智能——现代方法。Upper Saddle River, NJ: Pearson Education, 2003，第2章。代理是一个 AI 概念；它可以通过数据或传感器被视为感知其环境，并通过数据或传感器对该环境采取行动，并针对该环境，通过步进器以及显示、发送或写入数据来实现目标。我们可以将大多数机器学习算法分为三大类：监督学习、无监督学习和强化学习。#machine_learning_categories说明了这些类别。
机器学习类别
我们所说的学习是什么意思？
 让我们从机器的角度来来看看学习的现代定义：
 如果计算机程序在 T 任务中的表现（按 P 测量）随着经验 E 的提高而提高，就可以说它通过某种任务 T 和性能度量 P 的考验，学习到了经验 E。
Tom Mitchell定义由 Tom Mitchell 在1998年提出，机器学习研究。
让我们为学习玩跳棋提供一个明确的示例：
E = 玩许多跳棋游戏的经验
T = 玩跳棋的任务。
P = 程序赢得下一场比赛的概率
我们可以在三种主要学习类型中解决多种任务：
在监督学习中，代理接收一些输出输入示例，并学习从输入映射到输出的函数。以下是监督学习的一些常见任务：
分类分类
在这种类型的任务中，要求计算机程序指定某些输入属于哪个k类别。示例：查找输入服务器数据是否属于“正常”、“不正常”或其他类。
缺少输入的分类
当某些输入可能丢失时，学习算法必须学习一组函数，而不是提供单个分类函数。
回归
回归任务是一种机器学习问题，它尝试根据以前的信息预测输入的连续（通常是浮点）值。示例：在给定服务器数据集的一组要素的情况下预测存储使用情况。
在无监督学习中，代理学习输入中的模式，尽管没有给出具体的反馈。以下是最常见的任务：
集群
检测到有用的输入示例的群集。例如，机器可能会逐渐形成“良好的站点流量”和“不良站点流量”的概念，而无需进行人工教学干预。
在强化学习中，代理使用奖励（强化）学习。例如，由于未发现流量流中的安全事件，或为每个正确查找授予分数，可能会受到处罚。然后，代理将随着时间的推移做得更好。当然，其他任务和任务类型是可能的，如异常检测，在撰写本文时仍有许多任务被发现。我们在此处列出的任务类型仅用于机器学习基础知识的示例;请记住，AI 比机器学习的范围更大。
从国际象棋到围棋：我们可以潜水有多深？
 从历史上看，由于搜索算法及其在游戏中的使用，导致 AI 最初获得关注并在计算能力方面取得巨大进步。虽然使用搜索算法解决问题往往较慢，且大多数时候需要大量的内存和巨大的时间复杂性才能完成计算过程。这不仅包括用 MiniMax 算法，参见#solving_problems_by_searching_several_lev解一个简单的 tic-tac-toe 谜题，而且也包括其他搜索算法，如Breadth-First 遍历、深度优先搜索、A*搜索，以及更多现代游戏中使用的搜索。你可以在#further_reading-id00007中引用的书籍中找到有关这些的更多信息。通过搜索多个级别的可能性来解决问题
为了更好地解释游戏对 AI开发的影响，我想给你们讲一个关于两个特定的人机游戏的小故事。1997年，在两场六盘棋比赛中， 世界国际象棋冠军 Garry Kasparov 输给了 IBM 的“深蓝”国际象棋。这一结果让每个人都认为，像深蓝这样的机器可以解决非常重要的问题。
2015年，近 20 年后 ，由 DeepMind同名的技术公司（Deep Mind Technologies）于2010年9月成立的英国人工智能公司。它于2014年被谷歌收购。通过一个名为 AlphaGo 的程序，赢得了比国际象棋更复杂的中国古代围棋游戏，这是一种对 深度强化学习的应用，是与搜索算法截然不同的方法。#machine-methodologies比较了两台机器及其方法。
两台机器及其方法
| 深蓝；国际象棋；1997 年 5 月 | DeepMind；阿尔法狗；2015 年 10 月 ||---|---|
| Brute force 搜索算法 开发人员： IBM 对手：Garry Kasparov |深度学习 机器学习 开发者：谷歌 对手：范辉 |
 但是，在 AI 中引起世界关注的第一场比赛是跳棋，而先驱 Arthur Samuel 早在1959年就开创了“机器学习”这个词。这第一个游戏使用 Alpha-beta 剪枝算法。从那时起，AI 一直被认为有望成为我们文明未来的关键，不过也有人把它扔到技术的垃圾堆里面。
今天，在所有这些游戏和其他游戏中说“人机对战”是完全不公平的，因为机器处于明显的实力位置。在过去几年中，我们看到 AI 爆炸式增长，这主要是因为图形处理单元（GPU）使并行处理更快、更便宜，以及各种类型的大数据的涌现：图像、文本、事务、日志等。 
为什么是现在？我们改变了什么？
 在 SRE 领域，部署变得越来越快，我们（人类）只能做出如此快的反应。我们需要自动化更多，并做出正确的决策。我们需要更智能的监控。如今发生的 AI 的兴起，因为我们有足够的基础数据IBM 的一份报告，“2017 年十大主要营销趋势”，我们每天创建 2.5 万亿字节的数据，而今天 90% 的数据大多是在过去两年中就创建的。这相当于一千万张蓝光光盘，如果堆叠起来，其高将相当于四座埃菲尔铁塔。来自大数据计划，也有了廉价的 GPUNvidia GeForce GPU 卡最初增加的 GigaFlop （GFLOP）/功能的游戏需要良好的图形性能，以满足图像处理渲染的海量计算。GPU 在 2004 年左右的 GFLOP/s 方面超过了 CPU，而今天最好的图形卡比 5000 GFLOP/s 快得多，而 CPU 只能达到 1000 GFLOP/s 左右的速度。驱动的机器学习算法。
此外，深度学习的令人惊讶的是它是多么简单。在过去的十年里，没有人怀疑我们会在机器感知问题上取得这些令人难以置信的结果。现在，事实证明，您所需要的只是足够大的参数模型，这些模型在足够多的示例中经过梯度下降法的训练。并不复杂，只是很多。
Richard Feynman，在1972年的采访，从不同的角度看待世界
因此，这给了我们一个相当好的想法，为什么我们现在可以很容易的实现深度学习，
接下来，我们将探讨三种不同的机器学习技术：决策树、神经网络和长期短期内存网络。
 决策树
使用类似树状的决策图或模型及其可能的后果（包括机会-事件结果、资源成本和效用）的决策支持工具。
 长短期内存（LSTM）网络
非常适合从经验中学习，在未知大小和重要事件之间的约束下对时间序列进行分类、处理和预测。
神经网络
开始有点复杂，所以让我们花点时间分别深入探讨它们。 
什么是神经网络？
  在本节中，我们将通过简要介绍神经网络的基础知识，深度学习技巧以及如何将它们应用于实际数据问题来尝试回答这个问题。
神经元和神经网络
 不幸的是，我们不可能让 SRE 直接进入深度学习相关的 Python，而不首先谈论一点神经网络，以了解基础的开发理论。神经网络由人工神经元组成。人工神经元只是一个数学函数，它被认为是生物神经元的模型。它接收一个或多个输入，并求和以生成输出。激活函数通常有 sigmoid 或步进函数的形状，但也可以采取其他函数的形式。#biological_neuron_and_an_artificial_neuro证明了这种关系。
生物神经元和人造神经元。
我们可以通过使用一个简单的 Python 函数来实现人工神经元，该函数又将分组到层中，从而创建神经网络。我们直接与其中一些层（如输入层和输出层）交互，而有些图层是隐藏层，如#example_of_a_neural_network_with_two_hidd所示。
具有两个隐藏层的神经网络示例
应该如何以及何时应用神经网络？
 以下检查表将帮助您开始使用神经网络对数据执行机器学习任务：
在应用神经网络之前，了解传统算法是否正常工作。
检查神经网络是否可以解决问题。在应用神经网络之前，了解传统算法是否正常工作。
检查神经网络是否可以解决问题。
为该神经网络体系结构选择库或语言。
格式化和批处理数据，以便使用。
增加样本数据量，从而更好地训练。
将待处理数据发送到神经网络。
在培训期间验证并使用测试数据进行改进。