and SSL certiﬁcate scans from ZMap [74]. We also contacted a
team at TU Munich [75], who applied our ﬁngerprints to their
SSL scanning data. Across all of these sources, we obtained
31,345 indicator hits reﬂecting 555 IP addresses in 48 coun-
tries.
One SSL certiﬁcate returned by 175 of the servers was issued
by “/CN=RCS Certiﬁcation Authority /O=HT srl,” apparently
referring to the name of the spyware and the company. Servers
for 5 of our FSBSpy samples and 2 of our RCS samples re-
sponded with this type of certiﬁcate.
Some servers returned these certiﬁcates in chains that in-
cluded another distinctive certiﬁcate. We found 175 distinct IP
addresses (including the C&C’s for 5 of our FSBSpy samples
and 2 of our RCS samples) responded with this second type of
certiﬁcate.
We devised two more indicators: one that matched 125 IP
addresses, including 7 of our FSBSpy samples’ C&C’s, and
one that matched 2 IP addresses, in Italy and Kazakhstan.
Server locations: On 11/4/13 we probed all of the IP ad-
dresses that we collected, ﬁnding 166 active addresses match-
Country
United States
United Kingdom
Italy
Japan
Morocco
IPs
61
18
16
10
7
Provider
Linode
NOC4Hosts
Telecom Italia
Maroc Telecom
InfoLink
IPs
42
16
9
7
6
Table 5: Top countries and hosting providers for RCS
servers active on 11/4/13.
ing one of our ﬁngerprints in 29 different countries. We sum-
marize the top providers and countries in Table 5.
The prevalence of active servers either located in the USA or
hosted by Linode is striking,8 and seems to indicate a pervasive
use of out-of-country web hosting and VPS services.
In addition, we found: (1) 3 IP addresses on a /28 named
“HT public subnet” that is registered to the CFO of Hacking
Team [76]. The domain hackingteam.it resolves to an
address in this range. (2) An address belonging to Omantel, a
majority-state-owned telecom in Oman. This address was un-
reachable when we probed it; a researcher pointed us to an FS-
BSpy sample that contained an Arabic-language bait document
about Omani poetry, which talked to a C&C in the UK. (3) 7
IP addresses belonging to Maroc Telecom. Moroccan journal-
ists at Mamfakinch.com were previously targeted by RCS in
2012 [77]. (4) Overall, servers in 8 countries with governments
deemed “authoritarian regimes” [69]: Azerbaijan, Kazakhstan,
Nigeria, Oman, Saudi Arabia, Sudan, UAE, Uzbekistan.
Link to Hacking Team: All active servers match-
ing one of our signatures also responded peculiarly when
queried with particular ill-formed HTTP requests, respond-
ing with “HTTP1/1 400 Bad request” (should be
“HTTP/1.1”) and a body of “Detected error:
HTTP
code 400”. Googling for this response yielded a GitHub
project em-http-server [78], a Ruby-based webserver.
The project’s author is listed as Alberto Ornaghi, a software
architect at Hacking Team. We suspect that the Hacking Team
C&C server code may incorporate code from this project.
Links between servers: We identiﬁed many cases where
several servers hosted by different providers, and in different
countries, returned identical SSL certiﬁcates matching our ﬁn-
gerprints. We also observed 30 active servers used a global
IPID. Only one active server had neither a global IPID nor
819 of the 42 Linode servers were hosted in the USA, so the two
patterns of prevalence are mostly distinct.
11
USENIX Association  
23rd USENIX Security Symposium  521
an SSL certiﬁcate matching our ﬁngerprints. We assessed
whether servers returning SSL certiﬁcates were forwarding to
the servers with global IPIDs by inducing bursts of trafﬁc at the
former and monitoring the IPID at the latter. For 11 servers,
we found that the server’s activity correlated to bursts sent to
other servers We grouped servers by the SSL certiﬁcates they
returned, and found that each group forwarded to only a sin-
gle server, except for one case where a group forwarded to two
different IPs (both in Morocco). We also found two groups
that forwarded to the same address. There was a 1:1 mapping
between the remaining 8 addresses and groups. We refer to a
group along with the server(s) it forwards to as a server group.
We identiﬁed several server groups that may be associated with
victims or operators in a certain country. Some of these suggest
possible further investigation:
Turkey: We identiﬁed a group containing 20 servers in 9
countries. Two RCS and 5 FSBSpy samples from VirusTo-
tal communicated with various servers in the group. The RCS
samples also communicated with domains with lapsed registra-
tions, so we registered them to observe incoming trafﬁc. We ex-
clusively received RCS trafﬁc from Turkish IP addresses. (RCS
trafﬁc is identiﬁable based on a distinctive user agent and URL
in POST requests.) A sample of FSBSpy apparently installed
from an exploit on a Turkish server talked to one of the servers
in this group.[79]
We also found server groups containing servers in Uzbek-
istan and Kazakhstan; we found FSBSpy samples on Virus-
Total uploaded from these countries that communicated with
servers in these groups.
In the above cases, save Turkey, the country we have identi-
ﬁed is classiﬁed as an “authoritarian regime,” and may be using
Hacking Team products against the types of targets we proﬁle
in this paper. In the case of Turkey, there are hints that the tool
may be employed against dissidents [80].
6 Summary
Targeted surveillance of individuals conducted by nation-states
poses an exceptionally challenging security problem, given the
great imbalance of resources and expertise between the victims
and the attackers. We have sketched the nature of this problem
space as reported to us by targeted individuals in three Middle
Eastern countries. The attacks include spyware for ongoing
monitoring and the use of “IP spy” links to deanonymize those
who voice dissent.
The attacks, while sometimes incorporating effective so-
cial engineering, in general lack novel technical elements. In-
stead, they employ prepackaged tools developed by vendors
or acquired from the cybercrime underground. This technol-
ogy sometimes suffers from what strike us as amateurish mis-
takes (multiple serious errors implementing cryptography, bro-
ken protocol messages), as does the attackers’ employment of
it (identifying-information embedded in binaries, C&C servers
discoverable via scanning or “Google hacking”, clusters of at-
tack accounts tied by common activity). Some of these errors
assisted our efforts to assemble strong circumstantial evidence
of governmental origins. In addition, we mapped out the global
use of two “governmental” hacking suites, including identify-
ing 11 cases in which they appeared to be used in countries
governed by “authoritarian regimes.”
We aim with this work to inspire additional research efforts
addressing the difﬁcult problem of how to adequately protect
individuals with very limited resources facing very powerful
adversaries. Open questions include robust, practical detection
of targeted attacks designed to exﬁltrate data from a victim’s
computer, as well as detection of and defense against novel at-
tack vectors, like tampering with Internet connections to insert
malware.
The task is highly challenging, but the potential stakes are
likewise very high. An opposition member, reﬂecting on gov-
ernment hacking in Libya, speculated as to why some users
would execute ﬁles even while recognizing them as potentially
malicious [2]: “If we were vulnerable we couldn’t care less . . .
we were desperate to get our voices out . . . it was a matter of
life or death . . . it was just vital to get this information out.”
Acknowledgment
This work was supported by the National Science Foundation
under grants 1223717 and 1237265, and by a Citizen Lab Fel-
lowship. Any opinions, ﬁndings, and conclusions or recom-
mendations expressed in this material are those of the authors
and do not necessarily reﬂect the views of the sponsors.
The authors would like to thank the following individuals
for their help in various aspects of our analysis: Bernhard Am-
man, Collin D. Anderson, Brandon Dixon, Zakir Durumeric,
Eva Galperin, Claudio Guarnieri, Drew Hintz, Ralph Holz,
Shane Huntley, Andrew Lyons, Mark Schloesser, and Nicholas
Weaver.
References
[1] “Dark Secrets—Hacking Team commercial,”
ac-
[Online]. Available:
cessed:
http://bit.ly/1bCh57v
12-November-2013.
[2] J. Scott-Railton, “Revolutionary Risks: Cyber Technol-
ogy and Threats in the 2011 Libyan Revolution,” US
Naval War College, Tech. Rep., 2013.
[3] S. H. AlJalahma, “Response to The Guardian—UK
companys software used against Bahrain activist,” May
2013, accessed: 12-November-2013. [Online]. Available:
http://bit.ly/19iVUUP
[4] V. Silver,
“Gamma Says No Spyware Sold to
ac-
[Online]. Available:
Jul. 2012,
Bahrain; May Be Stolen Copy,”
cessed:
http://bloom.bg/17SOXQs
12-November-2013.
[5] A. Jeffries, “Meet Hacking Team, the company that helps
the police hack you,” Sep. 2013, accessed: 12-November-
2013. [Online]. Available: http://bit.ly/1bCajyl
[6] T. Brewster, “From Bahrain To Belarus: Attack Of The
Fake Activists,” Jul. 2013, accessed: 12-November-2013.
[Online]. Available: http://bit.ly/1gIgwhW
[7] V. Silver, “MJM as Personiﬁed Evil Says Spyware Saves
Lives Not Kills Them,” 2011, accessed: 12-November-
2013. [Online]. Available: http://bloom.bg/170E8sQ
522  23rd USENIX Security Symposium 
USENIX Association
12
[8] D. Gilbert, “Hacking Team and the Murky World of
State-Sponsored Spying,” 2013, accessed: 12-November-
2013. [Online]. Available: http://bit.ly/17tBBtm
[9] R. Clayton, S. J. Murdoch, and R. N. Watson, “Ignoring
the Great Firewall of China,” in PETS. Springer, 2006,
pp. 20–35.
[10] J. R. Crandall et al., “ConceptDoppler: A Weather
Tracker for Internet Censorship,” in ACM CCS, 2007.
[11] X. Xu, Z. M. Mao, and J. A. Halderman, “Internet Cen-
sorship in China: Where Does the Filtering Occur?” in
Proc. PAM, 2011.
[12] M. Sherr, G. Shah, E. Cronin, S. Clark, and M. Blaze,
“Can They Hear Me Now? A Security Analysis of Law
Enforcement Wiretaps,” in ACM CCS, 2009, pp. 512–
523.
[13] J. R. Crandall, M. Crete-Nishihata, and J. Knockel, “Chat
program censorship and surveillance in China: Tracking
TOM-Skype and Sina UC,” First Monday, vol. 18, no. 7,
Jul. 2013, accessed: 8-August-2013. [Online]. Available:
http://bit.ly/1fzNcHl
[14] S. Wolchok, R. Yao, and J. A. Halderman, “Analysis of
the Green Dam Censorware System,” Tech. Rep., 2009.
[15] F. Li, A. Lai, and D. Ddl, “Evidence of Advanced Persis-
tent Threat: A case study of malware for political espi-
onage,” in MALWARE, 2011.
[16] “Default https access for Gmail,” 2010, accessed: 7-
August-2013. [Online]. Available: http://bit.ly/1bBktPM
[17] “Making Twitter more secure: HTTPS,” 2011, accessed:
7-August-2013. [Online]. Available: http://bit.ly/1i7l9kM
[18] L. Constantin, “Facebook to roll out HTTPS by default
to all users,” 2012, accessed: 7-August-2013. [Online].
Available: http://bit.ly/1bsLBCm
[19] “FinFisher: Governmental IT Intrusion and Remote
Monitoring Solutions,” accessed: 12-November-2013.
[Online]. Available: http://bit.ly/1840Lxn
[20] “BlackBerry rogue software leaves sour taste in UAE,”
2013, accessed: 11-November-2013. [Online]. Available:
http://on.ft.com/HVXvJP
[21] Mandiant, “The Advanced Persistent Threat,” 2010.
[22] ——, “APT1: Exposing One of China’s Cyber Espionage
Units,” 2013.
[23] S. Fagerland, M. Krakvik, J. Camp, and N. Moran, “Op-
eration Hangover: Unveiling an Indian Cyberattack In-
frastructure,” 2013.
[24] R. Deibert and R. Rohozinski, “Tracking GhostNet: In-
vestigating a Cyber Espionage Network,” Information
Warfare Monitor, p. 6, 2009.
[25] S. Nagaraja and R. Anderson, “The snooping dragon:
social-malware surveillance of the Tibetan movement,”
Tech. Rep., 2009.
[26] F. C. Solutions, ““njRAT” Uncovered,” 2013, accessed:
25-June-2013. [Online]. Available: http://bit.ly/1eJheel
[27] “FinFisher
- Excellence in IT Investigation,”
27-February-2014.
ac-
[Online]. Available:
cessed:
http://www.ﬁnﬁsher.com/
[28] R. Rolles, “Unpacking virtualization obfuscators,” in
USENIX WOOT, 2009.
[29] “TEMU: The BitBlaze Dynamic Analysis Compo-
nent,” accessed: 7-August-2013. [Online]. Available:
http://bit.ly/1clcxSZ
sacked
[30] “‘Reinstate
ofﬁcial’
11-November-2013.