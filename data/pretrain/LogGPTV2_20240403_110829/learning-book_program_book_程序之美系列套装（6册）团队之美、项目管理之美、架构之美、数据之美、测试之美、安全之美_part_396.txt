户持有人（第3个域）已经在3D安全卡程序中进行了登记。如果持卡
2287
---
## Page 2289
人已经登记，发行银行就通过商家网页上的一个框架直接从账户持
有人那里收集PIN码或密码。这种认证协议是以XML文档的形式通过
安全套接字层（SSL）传输的。SSL保证账户持有人的PIN码或密码
的机密性以及主机和客户机的真实性。另外，商家或收单银行并不
道。这个过程虽然描述起来颇为复杂，但它实际上是我们所熟悉的
一种第三方信任场景：
1）消费者连接到商家的网站，做出购买选择，并输入信用卡的详细
信息。
2）商家服务器插件（MPI）把主账号（PAN）发送给目录服务器。
3）目录服务器查询访问控制服务器（ACS），确定是否可以进行主
账号的身份认证（或认证尝试的证明）。
如果不存在适当的访问控制服务器，目录服务器就为这个MPI创建一
个响应，并在步骤5中继续处理。
4）访问控制服务器向目录服务器作出响应。
5）目录服务器把访问控制服务器的响应（或者是它自己的响应）发
送给MPI。如果认证或认证尝试证明均不存在，3D安全处理便结
束。如果需要，商家、需方或支付处理器可能会递交一个传统的认
证请求。
6）MPI向访问控制服务器发送一个付款人认证请求（PAR）。
7）访问控制服务器接收这个付款人认证请求。
8）访问控制服务器通过可用于主账号（PAN）的过程对消费者进行
身份认证，这个过程可能涉及密码、芯片、PIN码等。
另外，访问控制服务器可能会生成一个认证尝试的证明。
9）接着，访问控制服务器用适当的值对付款人认证响应消息进行格
式化，并对它进行签署。
10）访问控制服务器向MPI返回付款人认证响应，并对这个响应进行
缓存，用于以后的交易。
2288
---
## Page 2290
访问控制服务器可以把选中的数据发送给一个认证历更服务器
（AHS）。
11）MPI接收付款人认证响应。
12）MPI对付款人认证响应的签名进行验证（执行验证或者把消息传
递给一个独立的验证服务器）。
13）商家继续与需方进行认证交换。
在步骤13之后，需方通过一个像VisaNet这样的认证系统与发行方进
行认证，然后把结果返回给商家。
3D安全的评估
3D安全在用户和账户的认证方面具有一些出色的优点，例如它在商
家一端付出了很大的努力，保证它已经针对信用卡品牌进行了注
册。它使用了顺应性支付软件，通过收单银行维护一个活动的、合
法的商家账户。但是，它在实践中被证明是不堪使用的。
3D安全一直存在的一个问题是用户对被“钓鱼"的担心。一方面，有
些钓鱼者会模仿它的行为。另一方面，有些用户会把真正的3D安全
交易当成是钓鱼手段而拒绝交易。这与PIN认证多少有些不合常规的
本质有关，因为请求是从一个与商家不同的域中发出的，事实上消
费者可能无法识别发行银行和DNS名称。
3D安全所存在的一个更基本的问题与前文所描述的CV2码一样，它
对于所有的交易并不是强道进行的。因此消费者的账号仍然是珍贵
的共享秘密。当PAN在各种不同的商家、支付系统和供应商系统之
间传输时，必须采用相同的预警措施，以保护主账号。
事先授权要求设置商家、银行和消费者之间的协议，因此具有明显
的开销。尽管这种开销相对于5.2.2小节所分析的SET协议而言明显
要小得多，但它仍然不是理想的方案。
除了3D安全的一些消费者对钓鱼抱怨这一问题之外，3D安全还存在
一个责任问题。支持3D安全的信用卡品牌表示他们并不会因为通过
3D安全而发生的欺诈交易要求商家承担责任。这对于商家实现3D安
全而言是个很大的激励，因为它将把寻求欺诈交易证据的责任转移
到消费者头上，而消费者以前在这个领域很少需要承担责任。由于
2289
---
## Page 2291
3D安全并非万无一失，因此对于持卡人而言并非万事大吉。从本质
上说，如果遭受了钓鱼攻击，它还是需要负有责任的。
5.2.2安全电子交易
安全电子交易（SET）是Visa和MasterCard于1996年开发的一个协
议，用于保证通过像Internet这样的不安全网络所进行的信用卡交易
的安全。SET使用X.509证书和扩展以及公钥加密技术，确认电子商
务交易中每一方的身份以及传输数据，同时维护数据的机密性。对
于消费者的账户而言，SET独一无二的绑定算法代替了一个临时证
书，使在线的商家完全不需要访问这种敏感信息。交易的每一方要
求通过证书授权（CA）进行预注册，这样信用卡发行方可以先进行
必要的审核，然后再批准商家执行电子商务交易。然后，它对交易
的所有参与方进行认证。
在消费者端，SET创建订单信息的散列值以及支付信息。支付信息
与订单信息的签名散列一起被发送回银行。消费者端的软件还把订
单信息发给具有支付信息签名散列的商家。持卡人和商家创建了对
等的散列，当它们从银行或支付网关接收到散列值时对它们进行比
较。
这个协议为交易提供了一些不同的保护：
它在消费者、商家和支付网关之间交换证书，在交易时执行额外的
认证。
像账号这样的敏感数据按照“有必要知道"的原则只由消费者和银行
共享，使商家不能存储或传输这个信息。
SET交易
下面显示了一个交易所要求的事件序列：
1）消费者从银行那里获得一个支持电子支付和SET的信用卡账号。
2）消费者接收一个由银行签署的X.509v3数字证书。
3）消费者进行订购。
2290
---
## Page 2292
4）每个商家具有自已的证书，它把这个证书发送给消费者，使消费
者通过软件可以验证它是一家合法的商店。
5）订单和支付信息被发送。
6）商家请求发行银行进行支付认证。
7）商家确认订单。
8）商家的货物发送给消费者或者为消费者提供服务。
9）商家请求支付。
SET的评估
遗憾的是，由于海量的公钥基础设施（PKI）所涉及的开销以及SET
所要求的注册过程，它绝不可能被广泛采纳。就电子商务市场的规
模而言，采用这种技术的管理复杂性也是无法忍受的。
5.2.3单用途和多用途虚拟卡
保证持卡人安全的一个最近趋势是通过虚拟卡。PayPal、MBNA和
Citi是这个市场较有竞争力的公司。
虚拟卡用于在不出示信用卡的情况下像常规信用卡一样进行交易，
并且商家的处理方式也和使用常规信用卡一样。事实上，商家甚至
并未意识到卡是虚拟的，因此商家系统把它当成是其他信用卡账号
一样处理。
虚拟卡的工作原理
每家供应商实现虚拟卡的方式稍有不同，但基本上可以归纳为两种
类型：单用途虚拟卡和多用途虚拟卡。这两种类型的虚拟卡通常都
是根据持卡人的请求“即时”生成的。一个现有信用卡账户的持有人
向虚拟卡供应商请求一张虚拟卡，在一个特定的电子商务站点使
用。供应商向该账户持有人提供一个虚拟卡号，包括一个过期日期
和一个CV2安全码。
单用途卡支持有限金额的单次交易。这种卡一般会在几星期甚至更
短的时间内过期，并且只能用于指定的商家。因此，即使信息去失
2291
---
## Page 2293
或者被盗，它很快将会失效，所以它对攻击者并无价值可言。
多用途卡也是由许多虚拟卡供应商提供的。这种卡适合于定期收费
的情况，例如支付月账单。多用途卡仍然有许多与单用途卡相同的
安全特性，例如只对单个商家有效，并规定了月支付限额。如果一
张多用途虚拟卡丢失或被盗，攻击者只能在这个商家使用该卡，并
且只能使用通过认证的定期收费金额，这样就大大降低了被欺诈的
可能性。
5.2.4破灭的动机
信息安全的一个常见经济问题涉及破灭的动机。动机是任何需要进
行多方处理的系统的一个关键因素，尤其是那些依赖人们自由地选
择做他们认为是“正确的事情”的系统。如果没有适当的动机，一般
将会导致失败。为了对导致失败（市场失败）的外部压力进行调
整，金融系统采用了两种方法：
规程
政府或行业协会制定了一系列的规则，以处理像垄断、污染、产品
质量问题以及缺乏信息安全等市场失败行为。规程的形式包括医疗
保险可携性和责任法案（HIPAA）、金融服务现代化法案
（GLBA）、Sarbanes-Oxley法案（SOX）等。
责任
法律机制要求对商品的损坏或丢失负责的人或团体来赔偿损失（经
常是经济上的）。以信息安全为例，如果个人或公司未采取合理的
预防措施保护信息的安全，可能会被判定对此负责。
现在让我们看看为什么信用卡“安全市场”会导致市场失败。按照我
们的金融模型，必须检查这个市场的主要参与方（消费者、商家、
服务供应商、收单银行、发行银行和银行卡协会）的当前动机。
消费者
人们常常以为消费者会小心地保护自己的信用卡，因为当信用卡被
滥用时，他们是损失最大的一方。但是，由于控制这些客观因素的
一些规程的存在，事实并非如此。在美国，对消费者的账户所发生
2292
---
## Page 2294
的任何欺诈行为，消费者本人只承担前50美元的损失。一般情况
下，为了保障消费者的基本权益，发行银行还会放弃这50美元。
因此，虽然绝大多数消费者表达了保护他们的账号、安全码和过期
时间的愿望，但在实际购买中，消费者很难产生保护这些信息的动
机。这样的动机即使存在也是非金融性的，例如节省时间以及避免
信用卡被盗用所带来的麻烦。
相比较而言，消费者对借记卡具有较强的保护动机，因为消费者在
这方面受规程保护的程度不如信用卡。另外，借记卡常常直接与消
费者的支票和存款账户相关联，如果借记卡的安全出了问题，很可
能立即导致消费者的直接经济损失。
商家和服务供应商
在现有的模型中，如果交易出了问题，商家的损失实际上并不小。
持卡人的数据如果被盗用，就可能会导致同时与规程和责任相关联
的后果。商家受到银行卡协会（支付卡行业，PCI）的约束，这个协
会制定了商家在处理数据（包括容纳数据的系统和传输数据的网
络）时必须遵守的安全标准。违反这个标准的商家会同时受到银行
卡协会在经济上和操作上的处罚。经济处罚通常针对收单银行进行
评估，收单银行再将罚款递交给商家。商家也会被判定负有责任并
被发行银行起诉，使银行能够补偿由于信用卡被盗用而付出的成
本，包括重新发卡的成本。
商家还要承担在它们的环境中（使用3D安全时除外）使用欺诈性信
用卡进行购物的责任。商家必须采用一些欺诈预防系统，以保证信
用卡是合法的并且是由持卡人所支配的。如果商家最终接受了一张
欺诈性的信用卡，发行银行就会进行退款，向消费者的账户退回款
项。商家如果已经处理了交易并提供了产品或服务，就不得不自行
承担与该交易相关联的损失。