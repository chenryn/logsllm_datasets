管理。
2.2IP地址
2.2IP地址
56
55
泌
电
28
---
## Page 29
2.网际协议IP
2.网际协议IP
口
IP 地址的特点
(4）在IP地址中，所有分配到网络前缀的网络都是平等的。
(3）转发器或交换机连接起来的若干个局域网仍为一个网络
(2）IP地址是标志一台主机（或路由器）和一条链路的接口。
(1）每个IP地址都由网络前缀和主机号两部分组成。
(4）在IP地址中，所有分配到网络前缀的网络都是平等的。
(2）IP地址是标志一台主机（或路由器）和一条链路的接口。
(1）每个IP地址都由网络前缀和主机号两部分组成。
IP地址的特点
（3）转发器或交换机连接起来的若干个局域网仍为一个网络
大地理范围的广域网
地局
互联网同等对待每一个IP
长
首
的样
网相合转
按
域网，
地址，不管是范围很小自
须
若
发
络
温
干个
器或交换机连接起来
（或子
互联网的观点，
局域网都具
网）
2.2IP地址
2.2IP地址
是指
58
有
1
57
来同
---
## Page 30
2.网际协议IP
A
222
放在IP 数据报的首部。
网络层和以上各层使用。
址。
虚拟地址、软件地址、逻辑地
222.1.4.2
N, 222.1.4.
IP地址
2212.4
222.1.4.1
222.12.3
Ng 222.1.6.
.1.6.
222.1.6.2
·数据链路层使用。
·硬件地址、物理地址。
·固化在网卡上的 ROM 中。
放在 MAC 帧的首部。
MAC 地址
④
?
②
可以是0或 1。
段线路的特殊"网络"
如指明IP 地址，
地址
处，可指明也可不指明
两个路由器直接相连的接口
个不同网络号的IP 地址。
路由器的每一个接口都有一
必须一样。
由器的 IP 地址中的网络号
同一个局域网上的主机或路
连线就构成了
2.3IP地址与 MAC地址
-种只包含
则这一段
这种
60
---
## Page 31
2.网际协议IP
MAC地址
首部
IP地址
局域网
首部
H,→经过 R, 转发→经过 R2 转发→H2
查找路由表
首部
路由器R
-IP数据报
MAC帧
TCP 报文
通信的路径
应用层数据
n
局域网
MAC
查找路由表
路由器R2
使用硬件地址
链路层及以
网络层及以上
2.3IP地址与MAC地址
K
一
62
3
---
## Page 32
2.网际协议IP
从 R2到 Host-2 
从 Host-1到 R 
从 R,到 R2 
AC
不同层次、不同区间使用的源地址和目的地址
源地址
IP1
次
上看
目的地址
IP地址和MAC地址
P
源地址
写入在数据音局的地址
MAC6
MAC4
MAC,
AC,
局域网
目的地址
MAC5
MAC3
2.3IP地址与MAC地址
MAC2
64
63
---
## Page 33
2.网际协议IP
口重点和总结：
2.网际协议IP
■只要在网络层上讨论问题，
■尽管互连在一起的网络的硬件地址体系各不相同，但P层抽象的互联网却屏
■在局域网的链路层，只能看见MAC帧。
■在IP 层抽象的互联网上只能看到IP 数据报。
主机或路由器怎样知道应当在MAC帧的首部填入什么样的MAC地址?
机或路由器之间的通信。
蔽了下层很复杂的细节。
IP数据报被封装到MAC帧中作为数据部分。
行路由选择。
，就能够使用统一的、抽象的IP地址研究主机和主
2.3IP地址与MAC地址
2.4地址解析协议ARP
66
65
3
---
## Page 34
2.网际协议IP
2.网际协议IP
网络层
ARP
发送
送以太网首部数据FCS
ARP分组封装在以太网帧中
ICMPIGMP
地址解析协议（ARP）的作用是：
送数据帧时，最终还是必须使用硬件地址。
不管网络层使用的是什么协议，在实际网络的链路上传
在知道一
一个IP地址时，查找到该IP地址对应的硬件地址。
P
IP地址
地址
2.4地址解析协议ARP
2.4地址解析协议ARP
67
---
## Page 35
2.网际协议IP
ARP 高速缓存(ARP cache)
2.网际协议IP
■每一个主机都设有一个ARP高速缓存(ARP cache)
口映射表动态更新（新增或超时删除），
口存放IP 地址到 MAC 地址的映射表。
以适应网络适配器变化。
10.4.9.99
10.4.9.1
10.4.9.2
当主机 A 欲向本局域网上的某个主机B 发送IP 数据报时：
IP地址
映射表
0007.ebea.44d0
取出 MAC 地址
0000.0c07.ac24
0030.7131.abfc
发送该 MAC 帧
是
找到？
MAC地址
否
00:06:12
00:02:55
00:08:55
生存时间 (Age)
，超过生存时间的项目都从高速缓存中删除，
自动运行ARP，找出主机 B
南中医药大学信息技
 Dynamic 
Dynamic
Dynamic
类型
2.4地址解析协议ARP
其他
2.4地址解析协议ARP
70
69
5
---
## Page 36
2.网际协议IP
2.网际协议IP
←
D
ARP请求
00-00-C0-15-AD-18
209.0.0.5
我想知道主机209.0.0.6的硬件地址
我是209.0.0.5，硬件地址是00-00-CO-15-AD-18
主机B向A发送ARP响应分组
ARP请求
主机A广播发送ARP请求分组
↑
ARP响应
ARP请求ARP请求
08-00-2B-00-EE-0A
209.0.0.6
209.0.0.6
2.4地址解析协议ARP
2.4地址解析协议ARP
---
## Page 37
2.网际协议IP
ARP 高速缓存(ARP cache)
2.网际协议IP
■剩下的工作就由下一个网络来做。
■如果所要找的主机和源主机不在同一个局域网上,
问题。
■当主机 B 收到 A 的 ARP 请求分组时，就将主机A 的 IP 地址及其对应的
■存放最近获得的IP 地址到 MAC 地址的绑定。
■
 让这个路由器把分组转发给下一个网络。
MAC 地址映射写入主机 B 自己的 ARP 高速缓存中，不必再发送 ARP 请求。
IP 地址到 MAC 地址的映射写入 ARP 请求分组。
为进一步减少 ARP 通信量，
可以减少 ARP广播的通信量。
因此主机A必须知道路由器R的IP地址,
A
209.0.0.5
209.0.0.1
主机A 在发送其ARP 请求分组时，就将自己的
送到路由器R1
路由器R1
219.1.0.1
然后把分组发送给这个路由器，
那么就要通过ARP 找到一
 B
219.1.0.6
2.4地址解析协议ARP
2.4地址解析协议ARP
74
73
3
---
## Page 38
2.网际协议IP
2.网际协议IP
ARP请求
ARP响应
口
209.0.0.5
209.0.0.1
209.0.0.1
路由器！
路由器R1
219.1.0.1
219.1.0.1
B
 B
219.1.0.6
219.1.0.6
2.4地址解析协议ARP
2.4地址解析协议ARP
76
5
8
---
## Page 39
2.网际协议IP
2.网际协议IP
找21101件1000001
209.0.0.5
209.0.0.5
，硬件地址是00-00-C0-15-AD-18
209.0.0.1
209.0.0.1
路由器
由器R1
219.1.0.1
219.1.0.1
ARP响应
ARP请求
B
219.1.0.6
二
219.1.0.6
B
2.4地址解析协议ARP
2.4地址解析协议ARP
78
6
---
## Page 40
口使用ARP的四种典型情况：
2.网际协议IP
■发送方是路由器，要把IP数据报转发到另一个网络上的一个主机。
■发送方是主机，
■
到目的主机的硬件地址。
发送方是路由器，
找到本网络上的-
发送方是主机，
到目的主机的硬件地址。
Caelhthacetsendt
edeliveredtotheappropriater
Paddress
1. A h
要把IP数据报发送到另一
，要把IP数据报发送到本网络上的另一个主机。这时用ARP找
LAN
.要把IP数据报转发到本网络上的一个主机。这时用ARP找
个路由器的硬件地址。
个路由器的硬件地址。剩下的工作由路由器来完成。
router
一个网络上的一个主机。
LAN
LAN
：
2.4地址解析协议ARP
这时用
这时用ARP
79
---
## Page 41
2.网际协议IP
口为什么不直接使用硬件地址进行通信？
2.网际协议IP
■在虚拟的 IP 网络上用IP 地址进行通信非常方便。
■全世界存在着各式各样的网络，使用不同的硬件地址。
■
址，但这个过程都是由计算机软件自动进行的，对用户来说是看不见的。
连接在同-
连接到互联网的主机只需各自拥有一
IP 编址把这个复杂问题解决了。
口要使这些异构网络能够互相通信就必须进行非常复杂的硬件地址转换工作，几乎
是不可能的事。
可以通过arp命令进行更多操作。
在Windows操作系统中，
个网络上那样
如何查看本地主机的ARP 高速缓存?
，通过【运行】【cmd】，在命令窗体中输入"arp -a"查看。
一个唯一的IP 地址,
它们之间的通信就像
2.4 地址解析协议ARP
2.4地址解析协议ARP
82
---
## Page 42
2.网际协议IP
以太网目的地址”以太网源地址
口ARP 的数据帧格式：
2.网际协议IP
以太网首部
通过Wireshark 进行ARP数据报的分析
+
OP
硬件地址长度
协议地址长度
发送端以太网
28字节ARP请求/应答
发送端
目的以太网
2.4地址解析协议ARP
2.4地址解析协议ARP
84
83
---