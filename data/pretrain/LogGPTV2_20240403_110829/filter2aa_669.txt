CSerV2 Final 版产品介绍 
产品名称：CSer C2 适用操作系统平台：Windows  
注：新版本增改内容，详见文中红字部分及最后一页的更新记录。 
产品简介： 
1、 采用 C/T/B 架构，即 Controller（控制端）、TeamServer（服
务器端）、Beacon（客户端） 三端，支持多用户在线，并实
时共享所有信息。 
2、 Controller 端发布的任务，支持同步和异步两种方式：同步方
式可以实时的执行任务和查看任务执行结果；异步方式，则可
以实现类似于离线任务的效果，即 Controller 可以一次性下达
多个任务，Beacon 端会依次取出任务执行并将结果返回给
TeamServer。 
3、 使用 Profile 定制化通讯协议，降低被特征化的机率。 
4、 除了基本的管理功能外，还拥有大量的、适用于各种环境的渗
透测试模块，用于高效地辅助渗透测试。 
产品特性： 
1、 具备更为详细的信息收集功能、运行时环境探测，以及域内网
渗透相关功能。 
2、 加强了 AV/EDR 对抗能力，同时对静态以及动态两方面进行了
处理优化，有效规避了常见 AV/EDR 的检测，在低成本情况
下，无需用户进行二次处理，即可达到较高的 ABU(Anti、
Bypass、Undetectable) 效果。 
3、 Beacon 端拥有很高的稳定性和兼容性，可在不同版本的
windows 操作系统上稳定运行。 
4、 提供了两种 Beacon 端持久化的方式：新的 COM 劫持方法以
及更加隐蔽的计划任务。 
5、 提供了两种 Beacon 端植入模式：Solo L&C，即“手动植入模
式”，主要用于已获得初始访问权（比如交互式 shell）的场景
下使用；Solo D4All，即“下载者模式”，主要用于获取初始访
问权的场景。 
6、 提供了一种一次性使用 Beacon 的方式（RunOnce，单次运行
模式）, 用于临时需要使用的场景。 
7、 重构了内存中的 C2profile，有效规避了 AV/EDR 的内存扫
描。 
功能列表： 
1、 对目标网站进行 Clone，为后续攻击进行准备工作 
2、 将 TeamServer 临时作为 WebServer 来使用，供远程下载文
件 
3、 提供探针功能，刺探访问者系统、浏览器等信息 
4、 提供模版类型的鱼叉式钓鱼功能 
5、 提供 SOCKS 代理功能 
6、 内网端口扫描 
7、 屏幕截图 
8、 文件管理功能 
9、 进程管理功能 
10、 将 teamserver 与控制端进行分离，防止 teamserver 被入侵或
teamserver 所在机器运行防病毒软件时，导致核心功能丢失 
11、 对通讯进行二次加密，防止流量被监控，降低被检测风险。 
12、 系统基本信息，包括 CPU 信息、内存信息、GPU 信息、用户
名、机器名、IP 地址、MAC 地址等基础信息。 
13、 系统服务信息，枚举系统服务信息。 
14、 补丁信息枚举，同时通过补丁信息列出对应的漏洞 CVE 编
号。 
15、 CLR 版本检测，枚举目标机器上的 CLR 版本。 
16、 EDR 检测，检测目标机器上的 EDR 信息，并列出其版本、对
应的服务、其所在目录等信息 
17、 虚拟机检测，通过各方面，包括 BIOS 信息、内存大小、注册
表、分辨率、CPU 温度等各种信息，来判断目标系统是否为虚
拟机 
18、 运行时安全检测，检测杀软基本信息以及系统补丁基本信息，
列出杀软的名称以及安装目录，系统安装的补丁以及安装时
间。 
19、 软件信息检测，检测目标机器上所安装的软件信息，内容包
括：软件名、版本号、软件开发公司、安装时间、安装目录、
架构等基本信息。 
20、 运行时权限检测，包括检测 applocker 选项、UAC 选项、
Token 权限信息 
21、 网络连接信息，包括 4 方面：目标机器 DNS 缓存信息、ARP
协议连接信息、TCP 协议连接信息、UDP 协议连接信息 
22、 本地 hash 提取 
23、 本地明文密码提取 
24、 RDP 明文密码提取 
25、 通过 lsass 进程获取密码 
26、 域内 hash 提取 
27、 域内 tickets 提取 
28、 通过 RDP 协议远程执行命令 
29、 通过 DCOM 远程执行命令 
30、 无文件远程命令执行 
31、 通过 SMB 远程执行命令 
32、 通过 WinRM 远程执行命令 
33、 通过 WMI 远程执行命令 
34、 黄金票据 
35、 白金票据 
36、 LDAP 查询域内基本信息，内置部分查询语句 
37、 票据传递 
38、 域内基本信息收集 
39、 新增了自定义的 TeamServer 以及 C2Profile 生成器。本地数据
库保存，方便随时读取修改。 
40、 新增了全版本通用的 BypassUAC 以及 GetSystem 功能，使用
smart inject 自动挑选最佳的注入进程与方式 
41、 minidump 允许用户通过 PID 或进程名 dump 任意进程，并自
动加密压缩保存，允许用户自动下载，并配备对应解密工具。 
42、 新的 Beacon 生成器。 
对 beacon 做了全方位的 ABU（免杀）处理，极大增强了其对
抗 AV/EDR 的能力，并增加了如下三种运行模式。 
、Solo L&C 手动植入模式 
由 Installer、Loader、Core 三端组成，需要手动进行安装等
操作，具备持久化能力。 
适用于已拥有初始访问权（比如 webshell 或者反弹 shell），需
要对其进行持久化控制的场景。 
注：三端模式主要是为了对抗云查杀，提高存活率。 
、Solo D4All 下载者模式（2.0.1 版本新增） 
只有 Downloader 一个 DLL，可以自动化选择可联网进程，
并将对应平台版本的 Installer、Loader、Core 等核心文件拉
回到内存并执行，具备持久化能力。 
注：下载者模式会自动连接到 team server 端拉取 beacon 核
心文件，主要用于打点或者横向移动。 
、RunOnce 单次运行模式 
不具备持久化能力，主要用于需要临时上线操作的场景。 
AV/EDR 测试结果： 
AV/EDR 名称 
静态免杀测试 
动态免杀测试 
Kaspersky 
√ 
√ 
Avira Antivirus 
√ 
√ 
McAfee 
√ 
√ 
Norton 
√ 
√ 
Windows Defender 
√ 
√ 
火绒 
√ 
√ 
ESET 
√ 
√ 
趋势科技 
√ 
√ 
avast 
√ 
√ 
更新记录： 
• 2.0 final 版本新增内容(2022/7/5) 
o 通讯协议增加对 DNS、SMB 的支持。 
o 回连模式中除了传统的 DNS 解析模式，新增了 URL 解
析模式，用于域名白名单封锁等场景。 
o Beacon 新增运行时变形机制，极大增强其运行时（内
存）存活率。 
o 优化现有的 EDR 对抗机制，增加了新的对抗手段，适用
性更加广泛。 
o 增强进程注入机制，添加了新的绕过 EDR/HIPS 的注入
方式。 
o 管理数据库中保存的功能执行结果。 
o Beacon Builder 配置管理。 
导出功能：将当前三种模式下的配置保存到 Json 文件中供
后续使用。 
导入功能：将之前导出的配置文件导入到当前配置项。 
保存功能：将当前配置保存到数据库，供下一次直接取
出。 
o 新增导出函数克隆功能，可配合 lolbins 加载执行使用。 
o 新增 c2profile 导入功能，暂支持由 TeamServer Builder
导出的 c2profile。 
o Beacon Builder 新增 RunOnce 下 exploit 模式。 
• 2.0.1 版本新增内容(2021/12/21) 
o 增加了新的 ABU 特性，可绕过 beaconEye 和
cobaltstrikeScan 等通过 yara 规则对内存进行扫描的工具
以及最新版 Windows Defender 等 AV/EDR。 
o 增加了新的植入模式：D4All（下载者模式），用于获取
初始访问权（打点）的场景。 
o 优化 Controller 端代码，运行更加流畅。 
o 优化 Beacon 端代码，增加了新的 EDR 对抗机制。