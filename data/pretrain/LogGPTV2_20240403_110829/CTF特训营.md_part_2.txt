## Page 15
CTF特训营：技术详解、解题方法与
1.1 Burp Suite
15/1144
下面详细介绍左侧的Headers和Hex标签页。
Headers标签页既可以方便地添加HTTP买信息，文可以避免在
手动修改HTTP头时因缺少空格等原因产生问题。例如，我们有时候
会在CTF中遇到检查IP地址的题目，此时就可以添加X-Forwarded
For、X-Real-IP等HTTP头尝试绕过。在添加之后，可以在Raw标签页
中发现这个新增加的HTTP头信息。
Hex标签页更多用于修改HTTP数据包的十六进制编码。比如
可以将其用在文件上传类型的CTF题目中以截断后缀，或者是使用这
些编码来对WAF进行模糊测试，并让我们可以顺利上传Webshell，该
部分的相关内容将会在后面的小节中提到。
3.Intruder暴力破解模块
暴力破解（以下简称“爆破”）是一种低成本但可能带来高回报
的攻击方式。大家应该了解过近些年出现的各种撞库漏洞。当然，在
撞库的时候需要考虑性能和效率以进行多线程并发。这时候可以用
Python或其他语言编写脚本进行撞库。Burp中也提供了简单易用的
Intruder模块来进行爆破
Intruder模块包含Sniper、Batteringram、Pitchfork、Clusterbomb
---
## Page 16
CTF特训营：技术详解、解题方法与，
1.1 Burp Suite
16/1144
等四种攻击类型，可以方便地进行Fuzz等测试。在Proxy等模块中
在想要测试的数据包上点击右键并选择SendtoIntruder（或者Ctrl
+1）即可将数据包发向lntruder模块。Intruder模块中包含了Target
Position、Payload、Options这四个标签页，可分别用于设置不同的
功能，下面笔者将依次对其进行介绍。
在Target标签页中可以设置攻击目标的地址（Host）和自标端口
（Port），并且可以选择是否使用HTTPS，如图1-6所示
TargetPositionsPayloadsOptions
?
AttackTarget
Start attack
Configure the details of the target for the attack
Host:example.com
Port:80
 Use HTTPS
图1-6设置攻击目标
在Position标签页中可以设置攻击的位置和攻击的方法。攻击位
置可以自动选择（一般自动选择的变量通常会比较多，不推荐自动选
择）。手动选择的方法是：如果你的Burp已经进行了自动选择，那么
先点击Clears按钮，然后选择你要爆破的变量，再点击Adds按钮即可
如图1-7所示。
---
## Page 17
CTF特训营：技术详解、解题方法与
1.1 Burp Suite
17/1144
Payload Positions
Start attack
sjeiap ny soj djaq aas - suogisod peopied o paufjsse aue speojied upum ul Aem
Configure the positions where payloads will be inserted into the base ree
es the
Attack type:Sniper
GET /?user=ga5&pass=5b5 HTTP/1.1
Add5
User-Agent: Mozi1la/5.e (Macintosh;Intel Mac 0S X 10.12;rv:55.e)
Host: example.com
Accept-Encoding:gzip,deflate
Clear5
Connection: close
Auto 5
Upgrade-Insecure-Requests: 1
Refresh
？<>
0 matches
Clear
2 payload positions
Length: 204
图1-7设置方法与攻击位置
接下来笔者将介绍四种攻击类型（Attacktype），下面以有两个
要爆破的变量为例进行说明。
(1)Sniper型
只需要设置一个Payloadset，在两个变量的位置逐一替换
Payload，每次只替换一个位置，先替换前面再替换后面。如果你的
Payloadset中有两个Payload，那么在爆破时会发送四次请求，结果
如表1-1所示。
表1-1Sniper型攻击请求过程
---
## Page 18
CTF特训营：技术详解、解题方法与
1.1 Burp Suite
18/1144
Request
Position
Payload
1
1
PayloadsetlPayload1
2
1
Payload_setl_Payload2
3
2
Payload_setl_Payloadl
4
2
Payload_setl_Payload2
(2)Battering ram型
只需要设置一个Payloadset，在两个变量的位置同时替换相同的
Payload。如果你的Payloadset中有两个Payload，在爆破时会发送两
次请求，结果如表1-2所示。
表1-2
Batteringram型攻击请求过程
Request
Position
Payload
1
1,2
Payload_setl_Payloadl
2
1,2
PayloadsetlPayload2
(3)Pitchfork型
---
## Page 19
CTF特训营：技术详解、解题方法与
1.1 Burp Suite
19/1144
需要设置两个Payloadset，这时候两个变量的位置和两个
Payloadset是一一对应的关系。这个类型可以用来进行撞库攻击等，
用你已知的账号密码去测试其他网站。爆破时会发送两个请求，结果
如表1-3所示。
表1-3Pitchfork型攻击请求过程
Request
Position
Payload
1
1,2
Payload_set1_Payload1, Payload_set2_PayloadI
2
1,2
Payload_set1_Payload2, Payload_set2_Payload
(4)Clusterbomb型
需要设置两个Payloadset，这时候每个位置的Payload将在
Payloadset中进行排列组合。在爆破时共要发送2x2=4个请求，结果
如表1-4所示。
表1-4Clusterbomb型攻击请求过程
Request
Position
Payload
1
1,2
Payload_set1_Payload1, Payload_set2_Payload 1
2
1,2
Payload_set1_Payload1, Payload_set2_Payload2
1,2
Payload_set1_Payload2, Payload_set2_Payload1
4
1,2
Payload_set1_Payload2, Payload_set2_Payload2
接下来介绍Payload标签页，Payloadset可用于设置每个位置使
用的Payload集合。Payloadtype可用于设置这个Payload集合的内
---
## Page 20
CTF特训营：技术详解、解题方法与。
1.1 Burp Suite
20/1144
容。Payloadtype中常用的选项具体包含如下几种。
Runtimefile：用于从文件中加载Payload。
Numbers：用于设置数字的开始和结束以及步长
Dates：用于设置日期及日期格式
Characterblocks：用于设置长度爆破，Fuzz超长的Post变量
有时候可以绕过WAF等。
Burp里面还提供了很多其他的Payload类型，请读者自行探索。
最后是Options标签页，在Options标签页中通常需要对Request
Engine中的参数进行设置。第一个参数为线程数量，默认值为1；第
二个参数为网络连接失败时的重传次数，默认为三次；第三个参数为
每次重传前的暂停时间；第四个参数为调节数据包发送速度的选项
第五个参数为开始时间。读者可以根据自己的电脑性能及网络状态等
因素设置这些参数。
为了方便观察结果，一般会将响应信息按照请求的返回长度或响
应状态码进行排序，或者在过滤器中设置匹配字符串或者正则表达
式，以便对结果进行筛选和匹配
---
## Page 21
CTF特训营：技术详解、解题方法与
1.1 Burp Suite
21/1144
4.Decoder解码模块
Decoder模块为我们提供了丰富的编码与解码工具，可以方便地
对HTTP/HTTPS中需要的数据进行编码和解码，并且支持用文本格式
或十六进制模式进行查看，如图1-8所示。
Sequence
DecoderComparerExtender
Projectoption
User options
Alerts
Text Hex
Decode as
Encode as
Hash
Smart decode
&#x49:&#x6e;&#x6b:&#x53:&#x65:&#x63
Text O Hex
Decode as
Encode as
Hash
Smart decode
图1-8解码模块
在这里，将需要处理的数据输入文本框中，然后选择编码或者解
码的模式。除了编码和解码以外，Decoder模块还提供了如MD5
SHA等常见的哈希算法，十分方便。不过，在一般情况下笔者不推荐
使用Smartdecode进行解码，因为在CTF中智能解码一般都不准确。
---
## Page 22
CTF特训营：技术详解、解题方法与
1.1 Burp Suite
22/1144
5.Comparer比较模块
在某些诸如Bool盲注的正确和错误的回显题目中，有时候两次数
据包之间的差别很小，比较难发现，这时可以使用比较模块来进行比
较，以发现差异，如图1-9所示。
Decoder
Comparer
Extender
Project options
User options
Alerts
Comparer
?
This function lets you do a wordor byte-level comparison between different data.You can load,paste,or
send data her
Word compare of #1 and #2(1 difference)
Select item 1:
Length:379
TextHex
Length:379
TextOHex
Paste
HTTP/1.1 200 OK
HTTP/1.1 200 OK
Content-Type:text/plain
Content-Type:text/plain
Content-Length:8
Content-Length:8
Load
Last-Modified:Mon,15May2017 18
Last-Modified:Mon,15May 2017 1
ETag:*ae780585f49b94ce1444eb7
ETag:*ae780585f49b94ce1444eb7
Remove
Accept-Ranges:bytes
Accept-Ranges:bytes
Server:AmazonS3
Server:AmazonS3
Clear
X-Amz-Cf-ld:
XAmz-Cfld:
AqcN2-pSpTc_tKMjsKnOfSW-2ZO16
AqcN2-pSpTc_tKMjsKnOfSW-2ZO16
Cache-Control:no-cache,no-store
Cache-Control:no-cache,no-store
Date: Fri, 14 Jul 2017 11:53:17 GMT
Date: Fri, 14 Jul 2017 11:53:18 GMT
Select item 2
Connection: close
Connection: close
success
success
2
7
Key:Modified
DeletedAdded
 Sync views
Compare
Bytes
图1-9
比较模块
---
## Page 23
CTF特训营：技术详解、解题方法与
1.1 Burp Suite
23/1144
6.工程选项介绍
在工程选项中，这里只介绍一些比较常用的名称解析相关的模
块，如图1-10所示。
Decoder
Comparer
Extender
Projectoptions
User options
Alerts
Connections
H
SSL
Sessions
Misc
？
Hostname Resolution
Add entries here to override your computer's DNS resolution.
Add
Enabled
Hostname
IPaddress
example.com
10.9.8.7
Edit
Remove
图1-10自定义名称解析
这里可以将域名（也可以是不存在的域名）与IP进行绑定，有时
候会遇到一些有这方面需求的题目，而且后文中出现的example.com
也都是在这里绑定的。
Burp的常用功能与基本的使用方式就介绍到这里，其他功能读者
可以自行探索或查看官方提供的文档，文档地址为：htps:/l
portswigger.net/burp/help
---
## Page 24
CTF特训营：技术详解、解题方法与
1.2 Sqlmap
24/1144
1.2Sqlmap
Sqlmap是一款开源的渗透测试工具，其可以自动检测并利用
SQL注入漏洞。Sqlmap配备了强大的检测引l擎，在CTF的Web类型的
题目中经常会遇到注入类型的题目（见2.2节）。如果题目比较简
单，甚至可以直接用Sqlmap得到flag。
但是，一般的题目还是需要进行绕过操作的，比如绕过空格或关
键字检测等，这时候则可以调用Sqlmap的一些Tamper，或者自行编
写Tamper来进行绕过，从而得到flag。
Sqlmap使用Python开发，常见的Linux发行版本都自带了Python
环境，但若想要在Windows系统下使用Sqlmap，则需要自行安装
Python环境。在GitHub中下载源码包（https://github.com
sqlmapproject/sqlmap），解压后便可以使用了，正确安装环境并部署
源码包之后，在命令行下输入pythonsqlmap.py后会显示类似图1-11
所示的界面。
---
## Page 25
CTF特训营：技术详解、解题方法与
1.2 Sqlmap
25/1144
1.wabzsy@InkSec:/utils/src/sqlmap (zsh)
sqlmapgit:(master)xpythonsqlmap.py
.]
{1.2.6.12#dev}
D1
http://sqlmap.org
Usage:python sqlmap.py[options]
sqlmap.py:error:missing a mandatory option（-d,-u,-l,-m,-r，-g，-C,
Cor-hh foradvanced help
sqlmapgit:(master)x
图1-11Sqlmap运行界面
Sqlmap提供了强大的命令行功能，而且在Burp中也存在Sqlmap
的插件。下面就来介绍一些基本的参数及其作用（见表1-5）。
表1-5Sqlmap的常用参数
---
## Page 26
CTF特训营：技术详解、解题方法与
1.2 Sqlmap
26/1144
参