Tagged [0] IMPLICIT 
DER Octet String[15] 
Tagged [1] IMPLICIT 
DER Octet String[15] 
critical(false) 2.5.29.35 value = Sequence
Tagged [0] IMPLICIT 
DER Octet String[20] 
critical(false) 2.5.29.14 value = DER Octet String[20] 
critical(true) KeyUsage: 0x80
44
7f21 CV_CERTIFICATE  
7f4e CERTIFICATE_BODY  
5f29 PROFILE_IDENTIFIER  0
42 CA_REFERENCE  TW/MOICVCAG1/00001
7f49 PUBLIC_KEY  
6 OID  0.4.0.127.0.7.2.2.2.2.3
86 PUBLIC_POINT_Y  
040048B5D4E6C2B2E91B3D3DCF5C91E4A0C45BFE98086EBEF6440FFB20326BD5BC978CAACE4BCDA82731DDAE3EF880
BFB4F7A6A5BE30798CF36A2833D9B186A4F916E10022B0E68FEB6CD42FD2ADB52FC30E181BD8A73432E1BB3F7928653B
D4CF3D7727904C36C3B2890527472BCF476323D89192AE82973B0081D7B02C939950C08CF37C
5f20 HOLDER_REFERENCE  TW/MOIDVCAG1/00001
7f4c HOLDER_AUTH_TEMPLATE  
6 OID  0.4.0.127.0.7.3.1.2.2
53 ROLE_AND_ACCESS_RIGHTS  BFFFFFFFFF: DV-domestic/Age Verification, Community ID Verification, Restricted 
Identification, Privileged Terminal, CAN Allowed, PIN Management, Install Certificate, Install Qualified Certificate, R-DG1, R-DG2, 
R-DG3, R-DG4, R-DG5, R-DG6, R-DG7, R-DG8, R-DG9, R-DG10, R-DG11, R-DG12, R-DG13, R-DG14, R-DG15, R-DG16, R-
DG17, R-DG18, R-DG19, R-DG20, R-DG21, RFU-29, RFU-30, RFU-31, RFU-32, W-DG21, W-DG20, W-DG19, W-DG18, W-DG17
5f25 EFFECTIVE_DATE  2020-09-17
5f24 EXPIRATION_DATE  2026-03-17
5f37 SIGNATURE  
A2AD152186C5E700DA2CCAB883B85CAF2AC2892643011452D421E8CE45C311D96A1DA3BFB1992054751B2FDE7AC9DE6F
869400740920519D676C37DF8028A520DBBE96602C317AD338439DBDCBC122338D4990BA6EE30B07E40BDC0F3E2D3F31F
E8D8DAA9C8BF7AC6BA8241F24C4ED94FB2D332016A54FF35F02623AC857C77DAFF6
45
7f21 CV_CERTIFICATE  
7f4e CERTIFICATE_BODY  
5f29 PROFILE_IDENTIFIER  0
42 CA_REFERENCE  TW/MOIDVCAG1/00001
7f49 PUBLIC_KEY  
6 OID  0.4.0.127.0.7.2.2.2.2.3
86 PUBLIC_POINT_Y  
0401CF9D14C148602C9A391541614EF330C47C6402E51A41A4A71403434F68F0DFE7D8FF0CEA67700004D41A089
02C8F8D46D583355607FFB673403B44174BCA7BF13B00689BA97774145503F7B1532578BFE80451DA6F13B9C2D2
92B42A0D145559CED9A5DBA7CA01FAAB9EF9F6D634CBD44B3F540E669E0CAC03A9E6B633997C8A2EE3EB
5f20 HOLDER_REFERENCE  TW/MOICA0085/00000
7f4c HOLDER_AUTH_TEMPLATE  
6 OID  0.4.0.127.0.7.3.1.2.2
53 ROLE_AND_ACCESS_RIGHTS  0000006000: Authentication-Terminal/R-DG6, R-DG7
5f25 EFFECTIVE_DATE  2020-11-20
5f24 EXPIRATION_DATE  2020-11-26
5f37 SIGNATURE  
0151F4D4706828898DC1EA8AE4D9292105D5D7F209FF1DECE8BD5D9645B2049FCC9EF2A5D5F2E5D941CEE8C2E
4BF4E719097CCD48057F4EB79C22F22473C293EC33A0177C1EFE4C1949EDE45DFCCF1E72B4B42F1F1912489269
A6D759F65C2E27EAFF1429C39A76EA7F73DA6739097425C59E742F2893998242300C45435BC276AD8016B
46
ECC Output ….
ECC 输出 …..
• 0300A55A05060014A092B6642E095A78929DA3116678EFCB10533BA8A21B7D008A09E287E00B9
8924BDD55E55C2BF1A50BE5849706A85E27EDB61B857AA65ED3A4A4D0
• 00A55A05060014A092B6642E095A78929DA3116678EFCB10533BA8A21B7D008A09E287E00B989
24BDD55E55C2BF1A50BE5849706A85E27EDB61B857AA65ED3A4A4D0
47
MSE set AT Ext Auth: 9000
Get Challenge: 386496050041522C9000
386496050041522C
select file DG6: 990290008E08C006DC1E2DB1D3BD9000
decrypted verified:9000
readbinary:878201A101FBE49AE2CA4342F6B0397AE2AAAE9854BF0687740B6D79C12480E2B0DAEA0D051E5733E7EAA544
6EDBD8287EA19D962622E426C12C4DC427BAC21B71DAD16D29ECDD984BF460E6779DB5C29B495C481D036BF6C2CED8
F1B9B25165F04C0DB72F4569D11E757A845D42E5DA88D34BC70F0930696AC657496D88D43261A4C7C502B37B51A0808665
E9B9CB41C05BB579F44168110350A14070EF1879DCBD755678EFB2AB669910CCC1AEEB0A4B0C873B49565CC3762C07D5
7D2CA9289C1F4D8E53206A9899AD5C8BB624FFDAA6B08371606E88CDE55DDFA3293FC3AD2036D56D85105379D288CD78
D7D31C4AA206F2F344A62E9539E2BEFF8B6F3A86FFD3EC86D5281F1DA3D1F4BFA3C3E4C429D762635CB8041840FEFFDE
A3C65AC34C7A209D81A5EFD8C97CC89D9E848593FCB1306D14532F3B41E2141292B00D3535DAF08FF8FE588BC29E2C22
6B1981AB53AA297D7D3F2F09B2A3B8D9C803C4F7F353E89E31F3C10482AB6A661F3680C14C01DF97B58EF9BC275D8DFB
708C518EDF2C8620710ABDE7A1A6A69A33F28EEB71EC533ECD7F52EC7FE8FEABA1261407AB2839D1BD990290008E080A
B6AC20C88203199000
decrypted 
DG6:66205F1301315F140BE69FB3F0A28A96F0AAA9A85F15005F16083035303339323930000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009000
48
柳𢊖𪩨
1
05039290 (Random Value) 
DG7:67205F1701315F180BE5A79CF0AFA58EF3BCBB945F19005F1A08393033393030363800000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000009000
49
姜
Identifying Potential Vulnerabilities
识别可能弱点
50
Information 
Collection
资讯收集
Learning How 
it Works?
确认运作方式
Identifying 
Potential 
Vulnerabilities
识别可能弱点
Key Findings 
主要发现
Recommendation 
建议
Security Mechanism for eMRTD in ICAO 9303-11
eMRTD 晶片的安全机制
51
Passive 
Authentication
Active 
Authentication
BAC (Basic Access 
Control)
PACE (Password 
Authenticated 
Connection 
Establishment)
Chip Authentication
Terminal 
Authentication
Data Encryption
52
EID
Terminal
终端
EID Center
EID 中心
We don't address the chip security issue
本次不考虑晶片安全性
We also don't address security of backend system
本次也不考虑后台安全
Risk Scenario 1: Data can be accessed without permission
风险情境 1：可以在未经鉴别与许可的情况下存取卡片资料
Risk Scenario 2: Cannot use TA to forbid unauthorized 
可以在未经鉴别与许可的情况下存取卡片资料
https://ninjalab.io/a-side-journey-to-titan/
Key Findings 
主要发现
55
Information 
Collection
资讯收集
Learning How 
it Works?
确认运作方式
Identifying 
Potential 
Vulnerabilities
识别可能弱点
Key Findings 
主要发现
Recommendation 
建议
Access without TA (only PACE with CAN)
只使用 CAN 进行 PACE 鉴别后的存取
56
Zone
Accessable
DG1
△ (DG13)
DG2
○
DG3
X (6982)
DG4
X (6982)
DG5
X (6982)
DG6
X (6982)
DG7
X (6982)
DG8
X (6982)
Zone
Accessable
DG9
X (6982)
DG10
△ (DG13)
DG11
○
DG12
○
DG13
○
DG14
△ (DG13)
DG15
○
DG16
△ (DG13)
Access Encrypted Data Zone with Contact and Contactless Interface
使用接触式与非接触式介面存取加密区
57
Contact Interface
接触式介面
Contactless Interface
非接触式介面
7F218201747F4E81E85F290100421054574D4F4944564341473130303030317F498194060A04007F0007020202
02038681850401CF9D14C148602C9A391541614EF330C47C6402E51A41A4A71403434F68F0DFE7D8FF0CEA
67700004D41A08902C8F8D46D583355607FFB673403B44174BCA7BF13B00689BA97774145503F7B1532578B
FE80451DA6F13B9C2D292B42A0D145559CED9A5DBA7CA01FAAB9EF9F6D634CBD44B3F540E669E0CAC03
A9E6B633997C8A2EE3EB5F201054574D4F4943413030383530303030307F4C12060904007F00070301020253
0500000060005F25060200010102005F24060200010102065F3781840151F4D4706828898DC1EA8AE4D929210
5D5D7F209FF1DECE8BD5D9645B2049FCC9EF2A5D5F2E5D941CEE8C2E4BF4E719097CCD48057F4EB79C2
2F22473C293EC33A0177C1EFE4C1949EDE45DFCCF1E72B4B42F1F1912489269A6D759F65C2E27EAFF1429
C39A76EA7F73DA6739097425C59E742F2893998242300C45435BC276AD8016B
7F218201747F4E81E85F290100421054574D4F4944564341473130303030317F498194060A04007F0007020202
02038681850401CF9D14C148602C9A391541614EF330C47C6402E51A41A4A71403434F68F0DFE7D8FF0CEA
67700004D41A08902C8F8D46D583355607FFB673403B44174BCA7BF13B00689BA97774145503F7B1532578B
FE80451DA6F13B9C2D292B42A0D145559CED9A5DBA7CA01FAAB9EF9F6D634CBD44B3F540E669E0CAC03
A9E6B633997C8A2EE3EB5F201054574D4F4943413030383530303030307F4C12060904007F00070301020253
0500000060005F25060200010102005F24060200010102075F3781840151F4D4706828898DC1EA8AE4D929210
5D5D7F209FF1DECE8BD5D9645B2049FCC9EF2A5D5F2E5D941CEE8C2E4BF4E719097CCD48057F4EB79C2
2F22473C293EC33A0177C1EFE4C1949EDE45DFCCF1E72B4B42F1F1912489269A6D759F65C2E27EAFF1429
C39A76EA7F73DA6739097425C59E742F2893998242300C45435BC276AD8016B
58
7f21 CV_CERTIFICATE  
7f4e CERTIFICATE_BODY  
5f29 PROFILE_IDENTIFIER  0
42 CA_REFERENCE  TW/MOIDVCAG1/00001
7f49 PUBLIC_KEY  
6 OID  0.4.0.127.0.7.2.2.2.2.3
86 PUBLIC_POINT_Y  
0401CF9D14C148602C9A391541614EF330C47C6402E51A41A4A71403434F68F0DFE7D8FF0CEA67700004D41A089
02C8F8D46D583355607FFB673403B44174BCA7BF13B00689BA97774145503F7B1532578BFE80451DA6F13B9C2D2
92B42A0D145559CED9A5DBA7CA01FAAB9EF9F6D634CBD44B3F540E669E0CAC03A9E6B633997C8A2EE3EB
5f20 HOLDER_REFERENCE  TW/MOICA0085/00000
7f4c HOLDER_AUTH_TEMPLATE  
6 OID  0.4.0.127.0.7.3.1.2.2
53 ROLE_AND_ACCESS_RIGHTS  0000006000: Authentication-Terminal/R-DG6, R-DG7
5f25 EFFECTIVE_DATE  2020-11-20
5f24 EXPIRATION_DATE  2020-11-27
5f37 SIGNATURE  
0151F4D4706828898DC1EA8AE4D9292105D5D7F209FF1DECE8BD5D9645B2049FCC9EF2A5D5F2E5D941CEE8C2E
4BF4E719097CCD48057F4EB79C22F22473C293EC33A0177C1EFE4C1949EDE45DFCCF1E72B4B42F1F1912489269
A6D759F65C2E27EAFF1429C39A76EA7F73DA6739097425C59E742F2893998242300C45435BC276AD8016B
59
60
61
62
63
The performance of contactless card reading 
determines the position of card 
非接触式的卡片读取速度和卡片读取的稳定性有关
64
The performance via contact interface is better than 
performance via contactless interface
接触式比非接触式效能要好
63CX: Verify fail, X tries left
验证失败，还有 X 次可以尝试
Ex.
63C3: Verify fail, 3 tries left.
验证失败，剩三次可以尝试
65
Summary of Findings
发现摘要
• The data in the Public Data Zone can be accessed via brute force attack against CAN. Therefore, 
malicious people can access data in a card without contacting a card at most 27 days 
(2,400,000/86,400~27) 
在可以无线存取的情况下，可以透过 CAN 暴力破解，在不接触卡片的情况下，取得公开区的资料。
如果以读取一次 2.4 秒计算，2400000/86400~27 天
• MRZ could be better than CAN
无线存取可以限制使用 MRZ，增加破解时间
• Cannot inactivate a terminal actively
目前使用 TA 的设计无法主动停用一台读取终端 (卡片无法主动去读取 CRL 或呼叫 OCSP) 
• Could use SAM to protect terminal private key and shorten the validation time of AT certificate  
如果真要绑定终端，可以采用 SAM 卡保护资料，同时缩短凭证有效期间
• AA mechanism could be misused
AA 认证机制可能被误用
66
67
EID
Terminal
终端
EID Center
EID 中心
68
Obtain AA Certificate (DG15)
00 88 00 00 RND.IFD
Signature generated by the IC
Recommendation 
建议
69
Information 
Collection
资讯收集
Learning How 
it Works?
确认运作方式
Identifying 
Potential 
Vulnerabilities
识别可能弱点
Key Findings 
主要发现
Recommendation 
建议
Conclusion and Recommendation
结论与建议
• Integrated circuit identification card can improve the security and convenience of using online 
services. As every national online services may rely on the card, we should consider the security 
and privacy issues carefully 数位身分识别证可以提升使用数位服务的安全性。而因为国家的身分鉴
别服务多半会支援这张卡片，所以其安全与隐私的议题需要特别考量。
• The suspended EID card adopts the specification of ICAO 9303. We did not find critical security 
issues currently. 目前暂停的 EID 套用 ICAO 9303 的标准。实作上并未发现重大安全议题。
• The data in the Public Data Zone can be accessed via brute force attack against CAN 可以透过
非接触式介面暴力破解 CAN 读取卡片资料
• Contactless interface is very important for smart phones. We suggest to keep the interface and 
adjust the associated function 非接触式介面在智慧型手机的应用上非常重要，建议能够保留与善用
此介面，并对可存取资料做出调整。
• 可以考虑支援 FIDO CTAP2
• As the data in the Encrypted Data Zone are not very sensitive, current software-based terminal 
authentication scheme does not have significant risks. However, terminal binding would bring 
inconvenience for some applications. 目前加密区当中没存什么资料，因此目前采用软体凭证方式进
行终端绑定风险不明显。反而读取加密区要绑终端，对于某些应用来说可能会造成不便。
70
Thank You 
感谢各位的聆听
71