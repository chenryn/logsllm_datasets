  ---------------------------------------------------------------------------------------
  序号   数据名称                       设备类型    操作系统                    备注
  ------ ------------------------------ ----------- --------------------------- ---------
         健康运行时长                   服务器      全部                        
         主机CPU平均使用率              服务器      全部                        
         内存使用率                     服务器      全部                        
         磁盘分区使用率                 服务器      window                      
         当前进程数                     服务器      全部                        
         单个CPU的利用率                服务器      全部                        
         虚拟内存使用率                 服务器      全部                        
         idleCPU使用率                  服务器      全部                        
         sysCPU使用率                   服务器      全部                        
         userCPU使用率                  服务器      全部                        
         niceCPU使用率                  服务器      全部                        
         单个进程的CPU使用率            服务器      全部                        
         单个进程的内存占用大小         服务器      全部                        
         文件系统使用率                 服务器      Aix/HpUnix/Linux/其他UNIX   
         Swap分区使用率                 服务器      Aix/HpUnix/Linux/其他UNIX   
         端口流量（接收、发送、总）     服务器      全部                        
         端口丢包率（接收、发送、总）   服务器      全部                        
         端口错包率（接收、发送、总）   服务器      全部                        
  ---------------------------------------------------------------------------------------
## 安全信息
从数据表现形式上看，基本信息、状态信息和性能信息主要是数值形式或具有明确含义的简单字符，而安全信息包括了日志、事件、策略等信息，多为成段的文本信息，含义比较复杂，且在不同操作系统下，具有不同的组成。因此，在采集和传输时，应根据需要，对信息文本进行提取和加工，使之形成具有较为明确意义的结构化数据。
安全信息范围包括以下内容：
  -----------------------------------------------------------------------------
  序号   数据名称               设备类型               操作系统    备注
  ------ ---------------------- ---------------------- ----------- ------------
  1      账号／密码策略         终端/服务器/网络设备   全部        
  2      登录／操作事件         终端/服务器/网络设备   全部        
  3      权限策略               终端/服务器/网络设备   全部        
  4      系统日志／事件信息     终端/服务器/网络设备   全部        
  5      业务与数据库访问日志   终端/服务器/网络设备   全部        
  6      防病毒／木马信息       终端/服务器/网络设备   全部        
  7      合规信息               终端/服务器/网络设备   全部        
  -----------------------------------------------------------------------------
## 采集信息扩展策略
安全Agent应具备随业务需要进行采集项目扩展的能力，扩展通过动态链接库（在Linux系统下为SO文件，在Windows系统下为DLL文件）实现数据的采集功能函数，由Agent主程序通过脚本对采集函数进行调用。采集内容为：在操作系统中，可通过命令、程序能够获取的，与设备、应用运行相关的，可用UTF8进行编码的数据信息。
在脚本中应至少包括如下声明：
-   脚本防篡改签名：通过代码评审认证机构颁发的哈希校验码。
-   采集频度定义：定义该任务的采集频度，最小为1秒，最大为1月。
-   优先度定义：定义该数据在采集、上传时的优先等级，视具体扩展采集内容确定，分为3级。
```{=html}
```
-   1级－数据非常重要，需要在第一时间采集、上传，不可有断点；
-   2级－数据比较重要，在系统资源紧张、网络繁忙时，可延迟采集、上传，但不可有断点。对秒、分钟级采集频度来说，采集延迟不超过2/3个周期，上传延迟不超过2个周期，其它以小时、日、周、月级采集频度的，均应在本周期内进行采集、上传。
-   3级－数据重要程度一般，在系统繁忙时，可不进行采集，允许有断点。
```{=html}
```
-   采集任务入口：声明Agent主程序的调用入口。
# 控制规范
安全Agent可以接受来自管理节点的对受控设备进行操作的控制指令，控制指令应通过Agent插件进行封装，以保证其安全性，避免高危指令的执行。控制指令应实现以下功能：
## 服务器控制
  -------------------------------------------------------------------------
  序号   指令类别   设备类型    操作系统    备注
  ------ ---------- ----------- ----------- -------------------------------
  1      进程管理   服务器      全部        指定进程（组）启动、停止
  2      文件管理   服务器      全部        指定文件（组）拷贝、删除
  3      配置管理   服务器      全部        指定配置文件的修改
  -------------------------------------------------------------------------
## 桌面终端控制
  -------------------------------------------------------------------------
  序号   指令名称   设备类型   操作系统   备注
  ------ ---------- ---------- ---------- ---------------------------------
  1      进程管理   PC         Windows    指定进程（组）启动、停止
  2      文件管理   PC         Windows    指定文件（组）拷贝、删除
  3      配置管理   PC         Windows    指定配置文件的修改
  4      网络管理   PC         Windows    网卡配置管理、阻断
  -------------------------------------------------------------------------
## 控制指令扩展策略
安全Agent应具备随业务需要进行采集项目扩展的能力，扩展通过动态链接库（在Linux系统下为SO文件，在Windows系统下为DLL文件）封装指令功能函数，由Agent主程序通过脚本对指令函数进行调用。指令内容为在操作系统中，可通过命令、程序能够执行的，与设备、应用运行相关的命令或API。
在脚本中应至少包括如下信息：
-   脚本防篡改签名：通过代码评审认证机构颁发的哈希校验码。
-   指令入口：声明Agent主程序的调用入口。
# 非性能性规范
## 运行环境
由于企业内IT环境较为复杂，Agent应能够在目前在用的全部操作系统上运行，应保证在以下操作系统中安全稳定运行：
+-------------------+--------------------------+-----------------------+
| 服务器操作系统    | Window2003 Server        | 注：其它Unix如So      |
|                   |                          | laris等应有限度支持。 |
|                   | Window2008 Server        |                       |
|                   |                          |                       |
|                   | Window2012 Server        |                       |
|                   |                          |                       |
|                   | Linux /FreeBSD           |                       |
|                   |                          |                       |
|                   | Unix（Aix／HP-Unix）     |                       |
+===================+==========================+=======================+
| 终端操作系统      | Window XP/Vista/7/8/10   |                       |
|                   |                          |                       |
|                   | Linux                    |                       |
|                   |                          |                       |
|                   | Mac OSX                  |                       |
+-------------------+--------------------------+-----------------------+
## 性能规范
Agent运行应尽量避免与业务系统竞用资源，采集和上传应具有自调节能力。在被采集设备高负载和低负载状况下的性能应满足如下要求：
+-------------------+--------------------------+-----------------------+
|                   | 低负载                   | 高负载                |
|                   |                          |                       |
|                   | （设备CPU使              | （设备CPU使用         |
|                   | 用率\<60%，阀值可设定）  | 率≥60%，阀值可设定）  |
+===================+==========================+=======================+
| 服务器            | 采集占用CPU\<5%，        | 采集占用CPU\<2%，     |
|                   |                          |                       |
|                   | 内存占用率\<20M          | 内存占用率\<10M，     |
|                   |                          |                       |
|                   | 磁盘空间占用\<50M        | 磁盘空间占用\<50M     |
|                   |                          |                       |
|                   | 上传数据为实时上传       | 仅上传状态数据，      |
|                   |                          | 其它数据限制上传流量  |
+-------------------+--------------------------+-----------------------+
| 桌面终端          | 采集数据占用CPU\<2%      |                       |
|                   |                          |                       |
|                   | 内存占用率\<10M          |                       |
|                   |                          |                       |
|                   | 磁盘空间占用\<50M        |                       |
+-------------------+--------------------------+-----------------------+
## 安全性规范
安全Agent需满足较高的安全需求，软件应进行以下测试，以尽可能保证软件的安全性：
1）静态代码安全测试：主要通过对源代码进行安全扫描，根据程序中数据流、控制流、语义等信息与其特有软件安全规则库进行匹对，从中找出代码中潜在的安全漏洞。
2）动态渗透测试：使用自动化工具或者人工的方法模拟黑客的输入，对应用系统进行攻击性测试，从中找出运行时刻所存在的安全漏洞。
3）程序数据扫描：进行内存测试，发现诸如缓冲区溢出之类的漏洞。
通过安全性测试，防止以下攻击行为的发生：
1）SQL注入 
与外部系统接口不能直接传递SQL语句，对SQL变量进行合法性检查，避免SQL注入攻击。
2）修改提交数据
涉及计算、校验等功能，只能在服务端进行，不能在请求端进行，防止人为修改提交数据。
  3）跨站脚本攻击 
对http请求不允许包含脚本内容。
4）缓冲区溢出 
在外部输入层、接口层和实现层进行数据规则校验，避免引起溢出。
  5）加密弱点 
  避免以下不安全因素：
-   使用不安全的加密算法。加密算法强度不够，一些加密算法甚至可以用穷举法破解。
-   加密数据时密码是由伪随机算法产生的，而产生伪随机数的方法存在缺陷，使密码很容易被破解。
-   身份验证算法存在缺陷。
-   客户机和服务器时钟未同步，给攻击者足够的时间来破解密码或修改数据。
-   未对加密数据进行签名，导致攻击者可以篡改数据。
## 可靠性规范
安全Agent的可靠性依据IEEE标准定义进行评价。
可靠性指在给定的环境和给定的时间间隔内，按设计要求成功运行程序的概率。排除外部因素造成的影响下，安全Agent可靠性应满足以下要求：
+-----------------+---------------------------+------------------------+
| 项目            | 服务器                    | 桌面终端               |
+=================+===========================+========================+
| MTTF            | Linux／Unix               | Windows                |
|                 | ≥4320小时（6个月）        | ≥720小时（1个月）      |
| 平均无故障时间  |                           |                        |
|                 | Windows                   |                        |
|                 | ≥3600小时（5个月）        |                        |
+-----------------+---------------------------+------------------------+
| MTTR            | \< 1分钟                  | \< 1分钟               |
|                 |                           |                        |
| 平均恢复时间    |                           |                        |