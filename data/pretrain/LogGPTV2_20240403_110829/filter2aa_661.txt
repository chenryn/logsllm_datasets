Introductions 
•  Benjamin Caudill 
•  Principal Consultant with Rhino Security Labs 
•  Pentesting, Social Engineering, Webapp 
•  ~4 Years in Security, 8+ Years in IT  
•  Aerospace/Defense 
•  Incident response, forensics (APT-centric) 
•  Finance Industry 
•  Webapp assessments 
•  Consulting  
•  Pentesting, Social Engineering 
•  Number of certifications, but who cares? 
Overview 
•  Traditional Forensics 
•  Brief background 
•  Offensive Forensics  
•  Introduction/Basics 
•  Memory 
•  Potential, Problems 
•  Disk/Registry 
•  Potential, Problems 
•  New Metasploit Module 
•  Usage 
•  Quick demo 
(Traditional) 
Digital Forensics 
“…the recovery and investigation of material found in digital devices” 
•  Related tools and concepts used for investigations 
 (criminal/civil/corporate/etc) 
•  Objective:  Solve a “crime” 
•  As a result, few ‘forensics’ tools for pentesters 
Offensive Forensics 
“The use of forensics techniques for offensive purposes” 
 (Often for improved social engineering, password cracking) 
•  Why? 
•  When traditional post-exploit techniques are insufficient for next steps 
•  Pentesting has a time limit  (can’t wait all day keylogging…) 
•  Objective- Access to additional sensitive information 
•  Explicit vs Implicit 
!
 Forensic Comparison  
 (Live/Dead Analysis) 
 Offensive Forensics 
•  Live Analysis – 
•  Access remotely and can grab 
memory, but permission prevent 
access to files 
•  Hiberfil.sys, page.sys, other OS files, 
etc… 
•  Dead Analysis - 
•  All files accessible (through disk 
image) 
•  Loss of potential from user interaction/
live RAM 
 Traditional Forensics 
•  Live Analysis – 
•  Can grab memory, but things 
are changing (scary) 
•  Legal concerns, chain of 
custody… 
•  Dead Analysis – 
•  System off 
•  Stable – nothing is changing 
•  Grab disk image 
Offensive Forensics - Memory 
•  Windows Clipboard 
•  Password Managers – copy/paste 
•  Command-line History 
  (“doskey  /history ”)  
•  Adding users, FTP/Telnet sessions, etc 
•  Passwords, Key Files, Encryption Keys 
 (‘process_memdump’ in post MSF modules) 
•  Password/Key cache (ie: Truecrypt)  
•  Older software (ie: PuTTY)  
•  Private Browsing/Sandboxing 
•  Not quite so private after all… 
•  (Coming soon!) Volatility plugin to detect Private Browsing Sessions 
1.  Browser Files - Watering Hole attacks, Locate intranet sites, Misc Sensitive 
•  Firefox 
•  key3.db  & signons.sqlite
 (Passwords) 
•  places.sqlite  
 (Bookmarks and History) 
•  Cookies.sqlite 
 (Cookies) 
•  Formhistory.sqlite
 (Saved form data)
•  Downloads.sqlite 
 (Downloads) 
•  Content-prefs.sqlite  
 (Site-specific settings, such as local download 
locations) 
•  Addons.sqlite
 (Browser Addons) 
•  Sessionstore.js
 (Saved session for when Firefox re-opens) 
Offensive Forensics - Disk/Registry (1) 
Browser Form History – Credit Card Info  
Browser Form History – Account Compromise  
2.  Most Recently Used (MRU)  - What has the user been looking at? 
3.  Prefetch Files – What has the user been running? 
4.  Deleted files/Slack Space  - What had been on the disk? 
 (‘imager.rb’, ‘recover_files.rb’ in post MSF modules) 
•  Files are deleted for a reason 
•  Still underutilized as it takes more time 
5.  Backups, Volume Shadow-Copy Service (VSS) 
 (‘vss_list.rb’, related others in post MSF modules) 
Offensive Forensics - Disk/Registry (2) 
6.  Crash dumps – (theoretically) same potential as live memory 
•  Live systems can’t access page/hiberfil directly, but dumps may be 
available 
7.  Calendars, Address book, Smartphone backups, print spools, 
misc. 
•   Implicitly Sensitive (spearphishing, watering holes, password 
cracking, etc.) 
Offensive Forensics - Disk/Registry (3) 
• Mo’ Data, Mo’ Problems! 
•  Thousands of potential files/directories to search 
•  Not all apply to every OS, application, version, etc.  
Offensive Forensics - Disk/Registry 
Offensive Forensics - Disk/Registry 
•  …And a Meterpreter script was born! 
•  Forensic_Scraper- Using OS identification, grabs and 
downloads: 
•  All Major Browser Files (history, saved passwords, form data, etc) 
•  Most Recently Used (MRU) list for Windows, MS Office 
•  Prefetch data (exe’s, time-date stamps) 
•  Windows Crash Dumps  
•  Print Spools 
•  Located Backups (Windows, iPhone, Blackberry, etc) 
• Much more…
Forensic_Scraper – Demo 
•  Simple – point and shoot 
Forensic_Scraper – Demo 
Offensive Forensics - Conclusion 
Q/A: 
  Find me afterwards 
‘Forensic_Scraper’ Download/Demo: 
 RhinoSecurityLabs.com/blog 
 (or from Defcon) 
Contact: 
PI:EMAIL 
@RhinoSecurity