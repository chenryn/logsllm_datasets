### Title: Blackhat: EU-18 - The Last Line of Defense: Understanding and Attacking the Apple File System on iOS

Apple's continuous evolution has led to the deployment of numerous security mechanisms in iOS to protect against potential threats and risks. Among these, the filesystem serves as the last line of defense against attempts to steal or tamper with user data, as well as to prevent permanent damage such as the installation of backdoors or malicious applications.

In pursuit of both security and performance, Apple introduced and deployed a new filesystem called the Apple File System (APFS) on iOS and macOS. On iOS, where stringent security policies are in place, APFS incorporates several protection mechanisms to safeguard critical files and directories, even from attackers with kernel-level privileges. However, our research has revealed that these mechanisms are not as robust as intended, and we have successfully identified methods to exploit or bypass them.

In this presentation, we will begin by providing an overview of the filesystem architecture on Apple systems and the fundamental structure of APFS. We will then discuss previous attacks on APFS and explain its current mitigation strategies through a series of experiments. Most importantly, we will introduce a novel attack that bypasses APFS's mitigations, allowing an attacker to tamper with any file or directory on the system.

The insights into APFS's architecture, its vulnerabilities, and our new attack method are essential for iOS hackers and jailbreakers, and have not been comprehensively covered in previous talks. We believe that our findings will inspire the development of more secure filesystems for Apple systems.