(48.59%) other malicious host paths4, resulting in over 7
times of expansion in detection. The recall and the expansion
rate gradually converge as we increase the percentage of seed
malicious HICs. This trend is expected as we approach the
limit of the recall that we can achieve.
In addition to detecting already labeled malicious paths,
our method can also detect malicious paths that are not
identiﬁed by existing solutions. Figure 8 (a) shows that our
detector discovers more than 20,000 new malicious host
paths using 90% labeled malicious HICs as seeds. These
newly detected paths are mostly crawled from the Top-site
and Twitter feeds, and they go through 6,080 unique host
names. Through manual analysis, we ﬁnd that most of these
cases are not detected by Forefront because they either use
HTTP status code (e.g., 302) for redirection,without relying
on the use of malicious code, or their script signatures are
not included by Forefront.
Finally, we evaluate our false detection and false positive
rates in Figure 8 (b). For newly detected malicious HICs,
we use several methods in combination to validate them,
including comparing against the Google Safebrowsing list,
performing content clustering analysis and URL pattern
analysis (Section V-B). For the small set of remaining cases
that cannot be resolved using these methods, we manually
4This result already excludes false-positive paths.
119
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:54:53 UTC from IEEE Xplore.  Restrictions apply. 
go through each case. The validation process shows that our
false positive rate (FPR) is very low, less than 0.025%. The
false detection rate (FDR) is also as low as 0.34% when
using 5% seeds. Since our seed data may not be clean,
the false detection rate grows with using more seeds, and
it reaches 2.36% in the worst case.
Detection with seed rolling. To further improve the detec-
tion coverage, we repeat the detection process by feeding
the set of detected results as new seeds to the system
and re-calculate the PageRank scores. This “seed rolling”
process can iterate a few times. To demonstrate the value
of seed rolling, we use 5% known malicious HICs as seeds
and iterate our detection for 3 times. For each new round
of detection,
the seed data are appended with doorway
hosts (and HICs) that link to the detected HICs in the last
round. We use only doorway hosts to pick new seeds. This
is a conservative option because in a majority of cases,
a malicious path is always associated with a malicious
doorway (in addition to other malicious hosts along the
redirection chain).
Figure 9 shows that after 3 iterations, the detection cov-
erage can be signiﬁcantly increased: the number of detected
host paths is increased from 242,776 (48.59%) to 361,675
(72.38%), resulting in over 12 times of expansion. More
prominently, it helps us discover 30,358 new host paths. In
the meantime, the false detection rate (FDR) is bound to
2.63%, still low for practical use.
Host Path
FDR
h
t
a
P
t
s
o
H
#
35000
30000
25000
20000
15000
10000
5000
0
3.00%
2.50%
2.00%
1.50%
R
D
F
1.00%
0.50%
0.00%
Before
1st-round 2nd-round 3rd-round
Expansion Round 
Figure 9. New Findings and FDR with Seed Rolling
Comparison with the in-degree based approach. Previous
studies (e.g.,
[30], [27]) have proposed simple topological
features such as “in-degrees” for ranking malicious sites.
Intuitively, if a site receives trafﬁc from many other mali-
cious sites, it is also suspicious. For comparison, we also
implement an in-degree based approach for detection based
on the HIC graph. For each HIC node, we measure its
malicious in-degree from other known malicious HICs. If
the malicious in-degree is above a threshold, we detect this
HIC as also malicious.
Similarly, we use 5%, 10%, 50% and 90% of the known
malicious HICs as seeds and examine the false detection
rate under different requirements of recall. As comparison,
100.0%
l
)
e
a
c
s
g
o
L
(
R
D
F
10.0%
1.0%
0.1%
92.39% 
32.83% 
3.07% 
0.59% 
5%
40% Recall InDegree
50% Recall InDegree
40% Recall PageRank
50% Recall PageRank
7.32% 
2.41% 
0.48% 
0.23% 
90%
10%
50%
% Seed Used 
Figure 10. Comparison between in-degree based approach and our PageR-
ank based approach. Both approaches are evaluated under the requirement
of 40% and 50% recall of malicious host paths.
we change the threshold of the good/bad score ratio for
PageRank based detection to adjust the recall rates accord-
ingly. Figure 10 shows that the in-degree based approach
causes much larger FDR than our approach. The reason is
that many legitimate sites, such as google.com, may also
frequently receive redirected trafﬁc from malicious sites.
Simply picking HICs by in-degree will mistakenly identify
them as malicious.
s
C
H
I
f
o
n
o
i
t
c
a
r
F
1.0
0.8
0.6
0.4
0.2
0.0
1
10
# of In-degrees (Log Scale) 
100
1000
10000
Figure 11. CDF of the in-degree distribution of the HICs that are detected
by our approach (using 5% seed).
In addition to causing high false positive rates, the in-
degree based approach will also miss malicious HICs that
have small in-degrees. Figure 11 shows the in-degree dis-
tribution of the set of HICs detected by PageRank. With
5% seeds, our detector identiﬁes 508 malicious HICs and
their in-degree distribution is quite diverse, ranging from 1
to 3,514. Therefore, using our approach, we can detect not
only big central servers, but also dedicated smaller servers
in malicious activities.
Detection with different seeds and result sharing. One
practical question for our approach is the sensitivity of
its detection results to the use of different types of seeds.
Whoever using our tools may wish to bootstrap detection
based on any malicious data feeds that they may obtain.
To answer this question, we compare the detection results
using two different types of feeds. The ﬁrst type is the drive-
120
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:54:53 UTC from IEEE Xplore.  Restrictions apply. 
by download feed, and the second type is the combined
Top-site and Twitter feed. For both types of feeds, we use
Forefront to scan the crawled data and identify malicious
HICs as initial seeds. We then compare the results using 5%
seeds derived from the drive-by-download feed and all the
seeds derived from the Top-site and Twitter feed, so that the
number of initial seeds are roughly similar. Table V presents
the results. These two different seed sets result in similar
numbers of detected host names, and the FDRs from both
sets are low. This result shows that our approach is general
across different types of seed data.
When we compare the detection results, we ﬁnd that
although we obtain these two seed sets through different
channels, they have large overlaps in the set of detected
results, among which 29.91% host names and 37.09% host
paths are detected in both cases.
Host names
Host paths
FDR (host paths)
ND
NT
5,157
118,544
0.75%
5,458
236,763
0.34%
Table V
ND∩NT
ND∪NT
29.91%
37.09%
-
COMPARISON OF THE RESULTS DETECTED USING 5% SEEDS DERIVED
FROM THE DRIVE-BY-DOWNLOAD FEED AGAINST THAT FROM THE
TOP-SITE AND TWITTER FEED. ND IS THE NUMBER USING THE
DRIVE-BY-DOWNLOAD FEED AND NT IS THE NUMBER USING THE TOP
SITE AND TWITTER FEED.
We also ﬁnd that using the seeds from the drive-by-
download feed, we could detect scam attacks crawled from
the WarningBird feed. Using all of the bad seeds from the
drive-by-download feed, we identify 6 overlapping malicious
host names and 4,125 (56.21%) overlapping malicious host
paths crawled from the WarningBird feed (See Table VI).
These malicious hosts are not directly ﬂagged by Forefront
but are detected through PageRank. Most of the detected
paths go through (188.72.233.144), which is powered
by an open-source tracker kit. Many scam pages from the
WarningBird feed redirect trafﬁc to this host. This observa-
tion indicates that attackers are already leveraging dedicated
services from different channels and using them for different
purposes.
Host names
Host paths
Total
4,456
7,338
PageRank
Scanner
6
4,125
0
0
DETECTED HOST NAMES AND HOST PATHS THAT OVERLAP WITH THE
WARNINGBIRD FEED, USING THE DRIVE-BY-DOWNLOAD SEEDS.
Table VI
B. Detection Result Analysis
The low false positive rates of our detection suggest that
those captured HICs are likely dedicated malicious HICs.
One important question then is “what are the roles played by
these hosts in the malicious Web infrastructures?” To answer
this question, we focus on the set of dedicated malicious
click-fraud
Role
exploit
scam
fakeav
other
redirector
unknown
total
URLs
13,216
5,955
29,411
1,604
1,031
286,275
69,062
406,553
Table VII
URL paths
89,019
36,761
632,644
1,805
90,962
2,479,695
526,952
3,088,741
ROLES OF URLS.
HICs and categorize their URLs based the roles that they
play in an attack. We use several methods to perform such
categorization, including:
• Forefront reporting: When Forefront detects a piece
of malicious code,
it also provides a type code such
as Exploit:JS/Blacole.BK, Rogue:JS/FakePAV,
which can be used to infer its role.
• Content and URL clustering: We cluster page contents
based on their DOM structures as well as URLs based on
the URL patterns. We then manually examine large clusters
to determine their categories.
• Safebrowsing reporting: We check if an URL is also
reported by Safebrowsing, which sometimes provides hint
about its role, e.g., malware, or phishing.
Table VII shows the role breakdown of the set of mali-
cious URLs associated with the dedicated malicious HICs.
We ﬁnd that
the dedicated malicious HICs are tied to
a variety of roles including exploit servers, scam hosts,
redirectors, etc.
Among these categories, redirectors are of a dominant
fraction (70.4%) and they play active roles on 80% of the
malicious paths. Among these redirectors, 31.98% of them
are hosts that run Trafﬁc Distribution Systems (TDS), a suite
of trafﬁc buying and selling tool kits that are extensively
used in underground ecosystems. We discover these systems
using the URL patterns of known TDS tool kits [7]. Sev-
eral large TDSes that carry obvious URL patterns (hence
not including less famous TDS services) alone count for
56.25% of the malicious paths. Compared with exploit
servers, redirectors are less well studied and little has been
known about their operations. Given the important roles that
they play in malicious activities, in the next section, we
report an in-depth study on these TDSes to understand their
characteristics and monetization strategies.
VI. IN-DEPTH STUDY ON TDS
As discussed in Section V-B, over 50% of the malicious
paths turn out to go through Trafﬁc Direction Systems [7],
which are underground trafﬁc brokers who buy from trafﬁc
generators (e.g., malicious doorways) and sell
to trafﬁc
consumers (e.g., exploit servers). Such services facilitate
trafﬁc exchanges between malicious parties, allowing attack
executors to dedicate their resources to running and manag-
ing their attacks rather than wasting their time and resources
121
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:54:53 UTC from IEEE Xplore.  Restrictions apply. 
on procuring trafﬁc. Although such systems have been there
for years, relatively little is known about how they operate
in the wild, compared with other types of dedicated hosts
such as exploit services [8].
In our research, we focus on those TDSes as the rep-
resentative of topologically-dedicated malicious hosts. This
section reports the most interesting observations we made,
particularly, our discovery of their important roles in ma-
licious activities (connecting to over 52.67% of doorway
URLs, Section VI-A), their surprisingly long life span (65.21
days of median life time, Section VI-C) and the monetization
activities involving them even after they are parked (receiv-
ing possibly 10 times as much trafﬁc as legitimate parking
domain does, Section VI-D).
A. Landscape
To understand how these TDSes work, we ﬁrst need to
ﬁnd out what tool kits they use, how popular they are, where
they get trafﬁc from and where they send trafﬁc to.
Feed
Doorway URLs(%) Malicious Paths(%)
Drive-by-download
Warningbird