licited IoT Devices.
IEEE Communications Magazine 56, 9 (2018), 170–177.
https://doi.org/10.1109/MCOM.2018.1700685
[59] Shodan. 2013. Shodan. https://www.shodan.io. (2013).
[60] Siemens AG – Division Digital Factory. 2018. SINUMERIK 840D sl/828D / OPC
UA – Projektierungshandbuch. Technical Report. Siemens AG.
[61] Drew Springall, Zakir Durumeric, and J. Alex Halderman. 2016. Measuring
the Security Harm of TLS Crypto Shortcuts. In Proceedings of the 2016 Internet
Measurement Conference (IMC ’16). ACM, 33–47. https://doi.org/10.1145/2987443.
2987480
[62] Ioannis Stellios, Panayiotis Kotzanikolaou, Mihalis Psarakis, Cristina Alcaraz,
and Javier Lopez. 2018. A Survey of IoT-Enabled Cyberattacks: Assessing Attack
Paths to Critical Infrastructures and Services. IEEE Communications Surveys &
Tutorials 20, 4 (2018), 3453–3495. https://doi.org/10.1109/COMST.2018.2855563
[63] Keith Stouffer, Victoria Pillitteri, Suzanne Lightman, Marshall Abrams, and Adam
Hahn. 2015. Guide to Industrial Control Systems (ICS) Security. NIST SP 800-82
Rev. 2. (2015).
A ETHICS
While not involving human subjects, our research still warrants
ethical considerations, as measurements of industrial systems could
have unintended implications, for example, concerning information
security, privacy, or safety.
During the design, execution, and analysis of our research, we
thus follow basic ethical research guidelines [14] as well as practices
and procedures imposed by our institutions. Most importantly, we
carefully handle all collected data (cf. Appendix A.1) and further ad-
here to standard measurement guidelines [16] to reduce the impact
of our measurements (cf. Appendix A.2).
A.1 Responsible Handling of Data
As part of our measurements, we only request publicly available
data from OPC UA servers, i.e., data for which no authorization is
required. Thereby, we never bypass any security mechanisms and
never alter the state of a server, i.e., we never write to any variable
in an OPC UA server’s address space nor execute any functions.
Still, our dataset might contain very sensitive data for those servers
that do not implement or do not correctly configure access control
for their address space (cf. Section 5.4). Consequently, we store
all data solely on secured systems and exclude collected payload
data from our dataset release. Hence, our results on address space
access control in Section 5.4 cannot be independently reproduced
by others. Still, to protect potentially sensitive data, we consider this
decision an appropriate trade-off. To prevent attackers using our
dataset to find insecure OPC UA deployments, we further replace IP
addresses and autonomous system IDs by consecutive numbers as
well as blacken fields in certificates containing equivalent address
information (e.g., FQDNs).
Identifying Operators: Besides using the collected data for our
research, especially for the classification of systems and analysis
of access control (cf. Section 5.4), we analyzed the collected data
to identify server operators to inform them about their accessible
systems where possible. To this end, we automatically searched the
address space for nodes containing email addresses and, further-
more, invested manual effort to identify the operators of additional
systems (where we could not find contact data in the address space).
Operator Feedback: Overall, out of 493 systems that provide
unprotected access to potentially sensitive data and functionality,
we were able to retrieve contact information for 50 systems, includ-
ing systems for water sewerage, parking lot management, and hotel
management. Subsequently, we reached out to the operators via
email (and in one case by phone) to inform them about potential
security problems and provided them with pointers to information
on how to correctly secure their systems to prevent any potential
harm caused by attackers, such as executing system functions as
well as stealing or changing data. We received only two replies to
our contact attempts, one promising to forward our information
notice to the responsible IT department and one asking for security
advice. At the time of writing (four months after our initial con-
tact attempts), both systems, as well as all but three of the other
systems for which we could derive contact information, are still
online. However, the device where the operator asked for security
advice now implements access control.
An Internet-Wide Study on Insecure OPC UA Deployments
IMC ’20, October 27–29, 2020, Virtual Event, USA
(a) Split by manufacturers (indicated by different colors)
(b) Split by autonomous systems (indicated by different colors)
Figure 8: Number of hosts only providing security mode and policy None, only deprecated policies (D1, D2, cf. Table 1), too
weak certificates, affected by certificate reuse, and allow anonymous access.
Manufacturer Feedback: Likewise, we reached out to the man-
ufacturer listed in the subject field of (i) a security certificate used
identically on more than 350 hosts as well as (ii) two additional
certificates used on fewer hosts (cf. Section 5.3). The manufacturer
claimed that the issue of certificate reuse likely results from cus-
tomers/distributors copying system images and/or configuration
files containing automatically generated security certificates. As
a consequence, the manufacturer reached out to its customers to
sensitize them for the risks resulting from copying security certifi-
cates in June 2020. However, three months after the information
was sent, we do not observe any decline in systems using these cer-
tificates in our measurements. Instead, our data suggests that new
systems using one of these certificates continue to get deployed as
we observe an increase of 24 devices since their first reply and 3
devices in the week between our latest measurements.
A.2 Reducing Impact of Measurements
While related work claims that measurements with zmap not neces-
sarily impact industrial devices [8], we still set out to minimize the
implication of our weekly OPC UA active Internet measurements
to the largest extent possible by following well-established Internet
measurement guidelines [16].
Restricted Measurements: We closely coordinate our mea-
surement study with RWTH Aachen University’s Network Oper-
ation Center to reduce the impact on our Internet uplink and the
Internet as a whole and to handle potential inquiries or abuse re-
quests as fast as possible. Additionally, we exclude systems from
our measurements that requested so.
Contact Information: To prominently display the intent of our
scans, we provide rDNS records for the IP address used for scan-
ning and provide contact information both in the certificate and
the ApplicationName field of our client. Furthermore, we provide
a website at the IP address used for scanning with detailed expla-
nations on the scope and purpose of our research. Additionally, to
allow for exclusion in future scans, we list opt-out instructions on
the website. Based on such requests, we exclude 5.79 M IP addresses
(0.13% of the IPv4 address space) from our measurements.
Measurement Load: To not overload any autonomous system,
we spread our scans over a timeframe of approximately 24 hours
and rely on zmap’s address randomization. More importantly, to not
overload potentially resource-constrained industrial devices during
our traversal of their OPC UA address space, we instruct our scanner
module to wait 500 ms between subsequent requests to one server.
We further set a scanning time (60 min) and outgoing traffic (50 MB)
limit per host, forcing our scanner to disconnect whenever the limit
exceeds. On average, our scanner was connected to an OPC UA
server for 110 s (std: 461 s, min: 31 ms, max: 5393 s) causing 352 kB
of outgoing traffic (std: 2 MB, min: 28 B, max: 50 MB). In some rare
cases, our scanner exceeds the set time limit due to side effects
caused by parallel scanning of different hosts.
Overall, as OPC UA does not realize security by default, we con-
sider it essential to know whether modern OPC UA deployments
take advantage of the built-in security features. To answer this
question, we have taken sensible measures to reduce the risks in-
troduced by active Internet measurements of industrial appliances,
aiming to influence the security of OPC UA deployments positively.
B A CLOSER LOOK AT OUR RESULTS
During our research on the security configurations of Internet-
facing OPC UA deployments, we calculated much more extensive
statistics than presented in the body of this paper. Here, we give
detailed insight into this data, i.e., we break down our classification
of deficiently configured OPC UA deployments by manufacturers
and connecting autonomous systems (Appendix B.1) as well as
elaborate on the access control of OPC UA devices (Appendix B.2).
B.1 Separating Deficits Into Classes
In this paper, we showed that 92% of Internet-facing OPC UA deploy-
ments are affected by different configuration deficits, i.e., disabling
built-in communication security, using deprecated security primi-
tives, disregarding secure policies, systematically reusing private
key material, and/or disabling access control. In this appendix, we
shed light on whether devices of specific manufacturers are more
affected than devices of other manufacturers (Appendix B.1.1) and
NoneDeprecatedPoliciesTooWeakCertiﬁcateCertiﬁcateReuseAnonymousAccess0100200300400500NoneDeprecatedPoliciesTooWeakCertiﬁcateCertiﬁcateReuseAnonymousAccess0100200300400500IMC ’20, October 27–29, 2020, Virtual Event, USA
Dahlmanns et al.
Authentication Type
Accessible Hosts
anon.
cert.
token
Unclassified
Reason: Authentication Secure Channel
Unaccessible Hosts
•
•
•
•
•
cred.
•
•
•
•
•
•
•
•
•
•
•
Class: Productive
116 (10%)
0 (0.0%)
168 (15%)
0 (0.0%)
11 (1.0%)
0 (0.0%)
0 (0.0%)
295 (26%)
Test
8 (0.7%)
0 (0.0%)
20 (1.8%)
0 (0.0%)
14 (1.3%)
0 (0.0%)
0 (0.0%)
42 (3.8%)
493 (44%)
5 (0.4%)
0 (0.0%)
134 (12%)
0 (0.0%)
17 (1.5%)
0 (0.0%)
0 (0.0%)
156 (14%)
9 (0.8%)
464 (41%)
38 (3.4%)
4 (0.4%)
17 (1.5%)
0 (0.0%)
6 (0.5%)
541 (48%)
1 (0.1%)
21 (1.9%)
5 (0.4%)
7 (0.6%)
3 (0.3%)
43 (3.9%)
0 (0.0%)
80 (7.2%)
621 (55%)
139 (12%)
485 (43%)
365 (32%)
11 (1.0%)
62 (5.6%)
43 (3.9%)
6 (0.5%)
Table 2: Number and fraction of hosts supporting different OPC UA authentication types, split by our classification (accessible
hosts) and reason for connection reject (unaccessible hosts). Unused combinations of authentication types are omitted.
whether devices in specific autonomous systems are more defi-
ciently configured than devices in other autonomous systems (Ap-
pendix B.1.2).
B.1.1 Manufacturers. We already described in this paper that
some configuration deficits are limited to a few manufacturers,
i.e., certificate reuse mainly affects devices of one manufacturer (cf.
Section 5.3). In this section, we give insight in whether the other con-
figuration deficits affect the devices built by specific manufacturers
more than others. To determine the device manufacturer of found
OPC UA hosts, we use the same classification as used in the body
of this paper (cf. Section 4), i.e., we analyzed the ApplicationURL
field provided by the servers.
Figure 8a shows for each configuration deficit identified in this
paper the number of affected devices and illustrates the distribu-
tion over device manufacturers of the hosts. Indeed, some large
fractions of devices built by specific manufacturers are affected by
the same configuration deficits, e.g., enabling anonymous access
or only providing security mode and policy None. In one case, only
providing security mode and policy None affects all found devices
of this manufacturer. Current product manuals of this manufacturer
state that connections relying on this security mode and policy are
insecure but do not inform about possible consequences.
The results for too weak security primitives in used certificates
and certificate reuse coincides with our results in the main part
of the paper, i.e., only a few manufacturers are affected but in one
case, these certificates are installed on a large number of devices.
B.1.2 Autonomous Systems. Figure 8b details the same analysis
but illustrates the distribution of the devices connected to different
autonomous systems. Regarding hosts with too weak certificates
in comparison to the security policy description and reusing cer-
tificates, a large fraction is connected via the same autonomous
system, an ISP focussed on connecting (I)IoT devices to the Internet.
Except for many devices two other autonomous system relying on
deprecated policies and allowing anonymous access at the same
time (both being regional Internet service providers), the devices
affected by security configuration deficits are distributed over the
Internet as they are located in different autonomous systems.
B.2 Discovered Access Control Configurations
In Section 5.4 we showed that a large number of OPC UA devices are
accessible without any authentication (offering anonymous access)
and elucidated which authentication types are how frequently used.
Table 2 details the distribution of access control settings of
Internet-facing OPC UA servers. On the one hand, 621 servers (55%
of all discovered servers) rejected our access attempts by either
rejecting the secure channel channel establishment (7.2%) or deny-
ing access based on the authentication method (48%). Note, that
this also includes servers initially offering anonymous access but
nevertheless aborting the connection due to a faulty or incomplete
endpoint configuration. On the other hand, 493 servers (44%) al-
lowed access to their address spaces without any authentication
although, in many cases, secure authentication types are offered
in parallel. Out of these 493 servers, based on used namespaces in
their address space, we classified 295 servers as production and
42 servers as test systems (26% resp. 3.8% of all Internet-facing
OPC UA deployments).