in our data. Note that a URL may have multiple shortened
URLs pointing to itself, thus increasing the number of hits
for the long URL. Table IV reports hit statistics for both
shortened and the corresponding long URLs. We note the
shortened URLs appearing on trafﬁc exchanges have high hit
ŚƚƚƉ͗ͬͬǁǁǁ͘ůŝŶŬďƵĐŬƐ͘ĐŽ
ϯϬϮdĞŵƉŽƌĂƌǇZĞĚŝƌĞĐƚ
ŚƚƚƉ͗ͬͬďƌŝĚŐĞ͘ƐĨ͘ĂĚŵĂƌŬĞƚƉůĂĐĞ͘ŶĞƚͬĐƚ͍ǀĞƌƐŝŽŶсϭϲ͘Ϭ͙
ϯϬϮdĞŵƉŽƌĂƌǇZĞĚŝƌĞĐƚ
ŚƚƚƉ͗ͬͬďƌŝĚŐĞ͘ƐĨ͘ĂĚŵĂƌŬĞƚƉůĂĐĞ͘ŶĞƚͬĐƚ͍ĐŝĚсϭϰϱϴϭϭϭϭ͙
ϯϬϮdĞŵƉŽƌĂƌǇZĞĚŝƌĞĐƚ
ŚƚƚƉ͗ͬͬϭϭϬϭϱͲϳϱϴϵ͘ĂŵƉǆĐŚĂŶŐĞ͘ĐŽŵ͍ƐŝĚсEhŵyd͙
DĞƚĂZĞĨƌĞƐŚ
ŚƚƚƉ͗ͬͬďƌŝĚŐĞ͘ƐĨ͘ĂĚŵĂƌŬĞƚƉůĂĐĞ͘ŶĞƚͬďŽƵŶĐĞ͍͙
ϯϬϮdĞŵƉŽƌĂƌǇZĞĚŝƌĞĐƚ
ŚƚƚƉ͗ͬͬǁǁǁ͘ƚŚĞĐůŝĐŬĐŚĞĐŬ͘ĐŽŵ͍ƐƵďсϭϳϮϵϮϯϱϰϵϳΘ͙
Fig. 4. An example of suspicious redirection chain
V
/
5
8

I
R

U
H
E
P
X
1















1XPEHURIUHGLUHFWLRQV



Fig. 5. Distribution of URL redirection count
counts. Some shortened URLs have multi-million hit counts.
The referrer ﬁeld lists the domain which directed most visitors
to the shortened URL. We note that top referrers for most of
the URLs are trafﬁc exchanges . We also ﬁnd other referrers
such as vtrafﬁcrush.com and hotwebsitetrafﬁc.com that are not
part of our study. This shows that websites often use multiple
trafﬁc exchanges. While the top visitor country for most of
the shortened URLs are USA, we note that a few of them are
popular in other countries including Brazil, Malaysia, Iran,
Russia, and Portugal.
B. Malicious URL Categorization
We further categorized malicious URLs on the basis of
their top-level domain (e.g., .com or .net) and content type
using the information provided by VirusTotal. Figure 6 plots
the distribution of malicious URLs based on their top level
domains. We note that .com domains contain 70% of malicious
577
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 09:18:37 UTC from IEEE Xplore.  Restrictions apply. 
STATISTICS OF MALICIOUS SHORTENED URLS ON TRAFFIC EXCHANGES
TABLE IV
Shortened URL
goo.gl/VAdNHA
goo.gl/5V6Bux
goo.gl/fqp25u
goo.gl/iSDC7Q
goo.gl/kgom3r
goo.gl/NSvdYq
goo.gl/Cb7yzK
goo.gl/q5Z0q
goo.gl/0XdSﬁ
goo.gl/xEQUrC
goo.gl/yjVp6C
goo.gl/M8n1BG
bit.ly/joker468x60
bit.ly/insentif125a
bit.ly/1FxoQPN
bit.ly/1if2w2Z
j.mp/1ERFrgM
j.mp/1KJpbPD
tiny.cc/ricqtx
tiny.cc/2bs86
tiny.cc/86ths
tiny.cc/kkxi5w
zapit.nu/6Fkq
tr.im/oadQ7
Shortened URL Hits
3,746,526
2,060
1,754
47,366
1,752
4,746
6,450
376,006
71,560
58,378
38,493
74,901
84,715
4,452,525
81,819
239,185
3,746,850
13,878
6,807
103,002
261,336
14,627
3,403,329
4,789
KƚŚĞƌƐ ϱй
ŽƌŐ
ϭй
ĚĞ
Ϯй
ŶĞƚ
ϮϮй
long URL Hits
3,746,577
2,062
1,754
221,847
1,752
4,784
6,451
840199
71,560
58,381
41,711
74,901
84,715
Top Visitor Country
Brazil
USA
USA
USA
USA
USA
USA
USA
USA
USA
USA
USA
USA
4,452,546 Malaysia
81,819
239,185
3,746,850
13,878
6,807
103,002
261,336
14,627
3,403,356
4,789
USA
USA
USA
USA
Russia
Iran
Portugal
USA
USA
USA
ŶƚĞƌƚĂŝŶŵĞŶƚ
ϴ͘ϳй
/ŶĨŽƌŵĂƚŝŽŶdĞĐŚŶŽůŽŐǇ
ϴ͘ϲй
Top Referrer
torrentcompleto.com
10khits.com
otohits.net
warofclicks.com
otohits.net
otohits.net
10khits.com
10khits.com
10khits.com
otohits.net
google.com
10khits.com
x100k.com
-
otohits.net
-
tourseoul.ad-button.de
hit4hit.org
-
trafﬁcadbar.com
hotwebsitetrafﬁc.com
-
vtrafﬁcrush.com
websyndic.com
KƚŚĞƌƐ Ϯ͘ϲй
ĐŽŵ
ϳϬй
ĚǀĞƌƚŝƐĞŵĞŶƚ
Ϯϭ͘ϴй
ƵƐŝŶĞƐƐ ϱϴ͘ϲй
Fig. 6. Distribution of malicious URLs on trafﬁc exchanges across top-level
domains
Fig. 7. Distribution of malicious content across different categories
URLs followed by .net domains containing 22% of malicious
URLs. Other domains correspond to URL shortening services
and country-speciﬁc domains. In terms of content categories,
as shown in Figure 7, business is the top infected category
accounting for 58.6% of total malicious URLs. It contained
URLs pointing to online shopping, online payments, and
ﬁnancial services. After business category, 21.8% of malicious
URLs belong to advertisement category. Our ﬁndings reveal
the widespread presence of malicious advertisements [41] on
trafﬁc exchanges. We found that the advertisement network
used by most trafﬁc exchanges was AdHitz [2]. The third
major content category is entertainment, which accounts for
8.7% malicious URLs. These websites typically provide free
services, such as URL shorteners, video streaming, games,
etc. Users are tricked into downloading malicious software
in a guise of their intended product/service. Finally,
the
information technology category covered 8.6% of malware
and contained URLs pointing to hosting and free web proxy
services.
V. CASE STUDIES
Overall, our analysis of malware on trafﬁc exchange ser-
vices revealed several interesting results. In this section, we
present some typical and interesting case studies of malware
found on trafﬁc exchanges. Our aim is to provide insights into
the types of malware that are commonly encountered on trafﬁc
exchanges.
A. Malicious iframe injection
A large number of our malware samples were malicious
iframe elements hidden in HTML or JavaScript snippets on
seemingly benign websites. Once users visit such a website,
they are exposed to exploits through these hidden iframe
578
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 09:18:37 UTC from IEEE Xplore.  Restrictions apply. 
elements. More sophisticated samples came with obfuscated
JavaScript. The malware detection tools classiﬁed malicious
iframe injections as HTML/IframeRef.gen, Mal_Hifrm,
Trojan.IFrame.Script, or htm.iframe.art.gen.
Furthermore, we found three main categories of malicious
iframe elements. The ﬁrst category simply opens up a
hidden iframe with height and/or width set to small values
where they occupy little space on the screen. Such an iframe
element can be used to track the activities of a user across
various different websites. The following example elaborates
this behavior.
1
2
3
//Both width and height are set to 1
Code 1. A barely visible iframe element.
The second category is invisible iframe elements. The
iframe elements are made invisible by setting the CSS
visibility attribute to hidden, either of the iframe itself or
of the HTML component holding it. Some variants of this
technique can even pass sensitive information along with the
URL query arguments. The example listed below elaborate
this behavior.
1
2
3
4
5
6
7
//allowtransparency="true" makes it invisible
//data.id_supp query string uploads information
to the server
Code 2. A hidden iframe element that uploads information as a
query string.
The third category of malicious iframe elements are
injected through JavaScript. A JavaScript snippet dynamically
loads the content of the iframe element,
including its
parameters such as src and any styling that can make the
iframe invisible. Embedding an iframe in JavaScipt makes
it even harder to be identiﬁed by the scanning engine. They are
mostly initiated by the onLoad() method at the start of the
page and sometimes via separate event calls. The following
examples exhibit this behavior.
1
2
3
4
5
//iframe is dynamically loaded in document.write
()
document.write('...
...')
Code 3. A dynamically loaded iframe element.
B. Deceptive Download
A different class of malware on trafﬁc exchanges aims to
trick users into downloading executable ﬁles with deceptive
names. This attack is typically achieved by using JavaScript
in combination with HTML. Users are prompted to download
an executable after clicking on a pop up that mimics the default
download prompt. The malware detection tools report this
category as Trojan.Script.Heuristic-js.iacgm.
Fig. 8. Screenshot of fake download prompt
To further analyze the malware behavior, we interacted with
the URL (http://animestectudo.blogspot.com.br) in a closed
virtual environment. As shown in Figure 8, a user is prompted
to download a plug-in in the following snippet. Upon clicking
the download button,
it redirects the user to a new page
and downloads a ﬁle named: flashplayer.exe, which is
marked as malicious by multiple malware detection engines.
<a href="data:text/html,%3Chtml%3E%3
Chead%3E%3C/head%3E%3Cbody%3E%3Cstrong
%3EBaixando...%3C/strong%3E%3C/body%3E
%0A%3Cscript%3Ewindow.location.href%3D
%22http%3A%2F%2F
www.broadstoragewindow.com
%2Fc%3Fx%3D3yqY7CC2iwwAHopOgD%252FelFI
3iGYK4f%252BKa2UVeDrI9wc%253D%26c%3D1o
pF7hPnIqlhVxFY%252FCK5pz3FeWlJWms2kmMB
uvs1clanvA5FbOmmArlDl%252BmEzdpDwsQwps
uO%252FD9GDkwvUJ4eG42zre6scW8N9suDq2Ty
yAn9gwoj7jV%252BnHRit3AOe9tYNeLFoZhR%2
52BOCQiNcDgu1kow%253D%253D%26downloadA
s%3DFlash-Player.exe%26fallback_url%3D
http%253A%252F%252Fyupfiles.net%252Fdo
wnload.url%22%3B%3C/script%3E%3C/html%
3E " data-dm-title="Flash Player"
data-dm-format="3" data-dm-filesize="1.1
"
target="_blank" data-dm="1"
data-dm-icon=""
data-dm-href-free= "http://
www.google.com.br/"
data-dm-filename="null"
data-dm-hosted-file="0"
id="dm_aee5960346700280"
data-dm-href= "http://yupfiles.net/
downloader
1
2
3
4
5
6
7
8
9
10
11
12
13