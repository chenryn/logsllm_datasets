![](media/image1.png)
国家电网公司信息系统
大数据平台支撑行为安全审计分析报告
**信息系统行为安全审计顶层设计组**
**二○一六年三月**
引言，具体
本报告基于大数据平台现状进行评估，大数据平台二期将在自助式分析、跨域协同计算、数据安全管理等方面深化研发，并计划于2016年7月完成开发测试。
1.  **大数据平台支撑行为安全审计的分析**
```{=html}
```
1.  是否能支撑 建立统一的信息系统行为数据存储、维护架构（问题拓展）
**1）大数据平台支撑用户行为审计日志数据统一采集的方式：**信息系统行为安全日志从数据类型上，分为结构化数据和非结构化数据，时效上分为实时数据和离线数据。
**对于结构化实时日志数据**，消息队列组件kafka方式可支撑日志数据的实时采集，并基于elasticsearch-river-kafka进入elasticsearch；
**对于非结构化实时数据**，非结构化数据采集Flume支持分布式方式从数百个产生文件的服务器采集文件到elasticsearch中，可支撑非结构化日志的实时采集；
**对于结构化离线数据，**可采用离线数据抽取组件sqoop做全量或增量结构化日志数据抽取至大数据平台；采用离线数据抽取组件kettle做数据抽取管理工具，提供图形化界面和定义数据抽取规则。
**对于非结构化离线日志，**采用非结构化数据采集Flume定时将多个应用服务中产生的网络日志采集到大数据平台的HDFS中。
**2**）大数据平台支撑用户行为审计日志的存储能力和标准化存储：
**可满足存储容量的需求：**大型网省预估设备和行为日志日增量70G，按一年存储规划70G\*365=25T,预留20%-30%的空间存储临时数据，大数据分布式存储需要25T\*（1+30%）\*3=98T;中型网省预估设备和行为日志日增量50G，按一年存储规划50G\*365=18T,大数据分布式存储需要18T\*（1+30%）\*3=70T;小型网省预估设备和行为日志日增量30G，按一年存储规划30G\*365=11T,大数据分布式存储需要11T\*（1+30%）\*3=43T;按照信通部对试点单位大数据平台建设要求的基本服务器配置，大数据试点生产环境集群标配29台服务器，其中存储计算服务器20台，每台为300G+12\*2TB的容量，共计480TB的存储容量**,**并可按需扩容满足行为安全审计要求的最大量98TB的容量及处理要求。
**可支撑标准化存储**：结构化日志数据可按统一标准存储在分布式数据仓库Hive
或列式数据库Hbase，集市类结果数据可存储在关系型数据库Postgresql中。非结构化日志日记可按标准存储在HDFS中。
**3）大数据平台支撑行为安全数据安全和防篡改的能力**
大数据平台部署在内网，行为安全数据面临的安全风险主要非授权访问和篡改等。大数据平台安全管理组件中接口代理、认证、授权模块可杜绝非授权访问，集中审计模块可对各个组件的访问和操作日志、数据访问与操作日志进行集中审计和分析，数据访问和加密模块可提供列级的细颗粒度的访问权限控制和防止信息泄露。
大数据平台安全防护完全遵循公司信息安全防护总体框架体系，按照国家信息系统安全等级保护要求和Q/GDW
1594---2014《国家电网公司管理信息系统安全防护技术要求》，从物理安全、边界安全、应用安全、数据安全、主机安全、网络安全、终端安全及安全管理等八个方面进行常规安全防护设计。
相对于开源大数据平台，国网大数据平台二期的**安全管理组件**（2016年5月可实现），具有以下模块和功能：**接口代理模块：**对外提供各个组件的代理服务。**接口认证模块：**提供接口认证功能，为大数据组件提供统一安全认证的功能。**接口授权模块：**支持对各个组件、各个用户进行表级、文件级的统一权限控制。**集中审计模块：**对各个组件的访问和操作日志、数据访问与操作日志进行集中审计和分析。**数据访问控制：**提供数据列级的细颗粒度的数据访问权限控制。**加密模块：**各个组件之间通信采用加密通道，数据存储采用加密格式，防止信息泄露。
安全等级保护定级
2.  是否能支撑统一的用户行为操作实时告警、追溯体系
答：
对于关键字定位和实时搜索，大数据平台可融合开源成熟全文搜索引擎组件Elasticsearch，支撑海量日志的实时搜索和告警。
对于模型输出等实时运算，流计算组件strom可用于更复杂的实时数据计算，kafka+strom可支撑复杂的关联和**追溯。**
3.  是否能支撑 统一的用户行为数据离线分析体系
**答：大数据平台支撑行为安全审计的预测分析能力：**基于前期国网大数据分析、挖掘、建模技术，对用户行为历史数据行进分析挖掘，构建用户安全行为模型和异常行为分析模型，识别用户的异常行为，并通过与实时数据的模型输出对比，实现对用户异常行为的事情预警。
**支撑用户行为历史数据批处理组件：**大数据平台数据采用成熟开源组件Hadoop
Map/Reduce支撑批计算。MapReduce作为批处理的一种计算框架，用于大规模数据集的并行运算。适用于大规模（T级）数据集的离线批处理计算和任务分而治之子任务相对独立的离线日志处理。
**支撑用户行为历史数据分析挖掘和建模工具：**平台采用开源挖掘工具R语言、Mahout，并融合、优化传统数据挖掘算法与分布式挖掘算法构建分布式数据挖掘算法库；同时并完成分析建模客户端、模型运行服务端研发，支撑行为日志分析模型的配置。分析建模客户端，将算法及相应方法封装成通用操作节点，以可视化拖曳方式实现业务逻辑配置。
2.  **使用已有大数据平台划区域存储和单独建一个大数据平台做日志中心的对比**
+---------+------------------------------+-----------------------------+
|         | **使用已有大数据平台**       | **单独搭建**                |
+---------+------------------------------+-----------------------------+
| **存    | 在                           | 物理上单独存储              |
| 储隔离  | 分布式存储上划分单独的存储目 |                             |
| 方式**  | 录，通过安全模块实现逻辑隔离 |                             |
+---------+------------------------------+-----------------------------+
| **资    | 提供资源                     | 提供资                      |
| 源调度  | 调度管理，负责集群中所有的资 | 源调度管理，负责集群中所有  |
| 和管理  | 源的统一管理、资源隔离及资源 | 的资源的统一管理、资源隔离  |
| 方式**  | 分配，支撑平台内**所有项目应 | 及资源分配，支撑平台内**本  |
|         | 用**对资源的调度管理和隔离。 | 项目所有应用**对资源的调度  |
|         |                              | 管理和隔离。平台内所有资源  |
|         |                              | 可以全部分配本给项目使用。  |
+---------+------------------------------+-----------------------------+
| **安全  | 外部访问                     | 除大数据平台自身安          |
| 保障**  | 安全由安全代理网关统一服务。 | 全保障外，由于物理上的隔离  |
|         |                              | ，从根本上杜绝了由于错误授  |
|         | 内部访问                     | 权等意外事件造成的越界访问  |
|         | 和操作安全由安全管理组件进行 | ，同时由于系统运维人员相对  |
|         | 保障，支持对各个组件、各个用 | 少，高权限人员也相对减少。  |
|         | 户进行表级、文件级的**统一权 |                             |
|         | 限控制**，提供数据列级的**细 |                             |
|         | 颗粒度的数据访问权限控制**； |                             |
|         | 组件之间通信采用**加密通道** |                             |
|         | ，数据存储采用**加密格式**， |                             |
|         | 防止信息泄露；对各个组件的访 |                             |
|         | 问和操作日志、数据访问与操作 |                             |
|         | 日志进行**集中审计**和分析。 |                             |
+---------+------------------------------+-----------------------------+
| **集群  | 大数据                       | 按照1年存储规划，大型网省需 |
| 规模**  | 平台生产集群标配29台服务器， | 要100T存储容量，加上配置和  |
|         | 其中存储节                   | 管理需要的空间，按照标配的  |
|         | 点20台，计算节点2台，存储和  | 300G+12\*2TB容量，大概需要  |
|         | 计算能力按行为安全审计项目需 | 至少5台服务器作为存储节点， |
|         | 求和其他项目对平台资源的使用 | 集群规模至少为集群监控节点  |
|         | 情况，按需扩展存储节点和计算 | 1台+管理节点1台+引擎节点1台 |
|         | 节点。（未包括es所需服务器） | +数据仓库节点1台+数据库服务 |
|         |                              | 器（postgresql）2台+群计算  |
|         |                              | 节点2台+存储节点5台=**13台  |
|         |                              | **。（未包括es所需服务器）  |
+---------+------------------------------+-----------------------------+
| **针对  | 目前平台未集成全文搜索引擎   | 目前                        |
| 本项目  | 组件，但底层可无缝融合，es管 | 平台未集成全文搜索引擎组件  |
| 需做的  | 理控制也可基于开源工具实现。 | ，但底层可无缝融合，es管理  |
| 扩展**  |                              | 控制也可基于开源工具实现。  |
+---------+------------------------------+-----------------------------+