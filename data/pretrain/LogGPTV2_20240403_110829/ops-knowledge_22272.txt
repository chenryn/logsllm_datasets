User: 请回答以下安全问题如何从跟踪文件中提取会话密钥？我有来自客户端的SSL会话的wireshark转储。我无法控制服务器端。我应该能够解密SSL会话，获得会话密钥，预主密钥吗？
当做

Assistant: 如果您只有来自TLS会话的数据包捕获，那么您将无法解密流量。数据包捕获是被动攻击的结果，攻击者只是在查看网络流量。如果这足以解密流量，那么TLS将变得毫无用处。
在现代配置中，客户端和服务器将使用Diffie-Hellman密钥交换来建立共享机密（TLS预主机密）。每一方生成一个私有值并计算相应的公共值。公共值通过网络发送，每一方都使用自己的私有值来建立相同的共享机密。由于私有值从不通过网络发送，因此攻击者无法计算此机密。
现在，如果您实际控制了客户端（或服务器），那么您可以从内存中读取密钥或修改程序，使其保存（预）主密钥。使用Firefox和Chrome，您可以将环境变量SSLKEYLOGFILE设置为文件路径，并将所有主机密写入其中。然后可以将该文件加载到Wireshark中，以解密客户端的TLS流量。