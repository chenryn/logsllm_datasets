Poker Bots (Cont.) 
•
Poker Sites have been cracking down on bots 
•
How do they catch them: 
•
Betting patterns 
•
Tendency 
•
Program Flaws (always click same pixel) 
•
Scanning 
•
When a player is identified as a bot, Full Tilt or PokerStars removes them 
from our games as soon as possible.” Their winnings are confiscated, he 
said, and the company will “provide compensation to players when 
appropriate.”  
© SeNet International Corp. 2011 
31 
August 2011 
SeNet 
Poker Bots (Cont.) 
•
Full Tilt – Banned after finding evidence of a poker bot on your hard drive: 
On Sat, Oct 16, 2010 at 2:03 PM, Full Tilt Poker - Security 
 wrote: 
Hello , 
As outlined in the email you received, you have been found guilty of a violation 
of our rules regarding the use of prohibited software. Specifically you have been 
found to have used the Shanky Technologies Bot.  The email you were sent has 
been included below for reference. This decision was the result of an extensive 
and exhaustive review of your account activity on Full Tilt Poker. 
Do not attempt to play on Full Tilt Poker in the future on a new or existing 
account. If you are found playing on the site again, your account will be 
suspended and all remaining funds will be forfeited. 
We will not enter into any further discussion regarding this matter. 
Regards 
Security & Game Integrity 
Full Tilt Poker 
© SeNet International Corp. 2011 
32 
August 2011 
SeNet 
Turn 
© SeNet International Corp. 2011 
33 
August 2011 
SeNet 
Online Poker Network Architecture 
© SeNet International Corp. 2011 
34 
August 2011 
SeNet 
Online Poker Network Architecture 
(Cont.) 
© SeNet International Corp. 2011 
35 
August 2011 
SeNet 
Online Poker Network Architecture 
(Cont.) 
© SeNet International Corp. 2011 
36 
August 2011 
SeNet 
Online Poker Network Architecture 
(Cont.) 
© SeNet International Corp. 2011 
37 
August 2011 
SeNet 
Poker Client=Root Kit 
While the poker client is not exactly 
a root kit it does exhibit some of the 
same characteristics.  The online 
companies argue this is for player 
protection against cheating.  
However, in doing this there is some 
invasion of privacy.  I don’t know 
about you but I don’t like people to 
know what web sites are in my 
cache. 
© SeNet International Corp. 2011 
38 
August 2011 
SeNet 
Poker Client Behind the Scenes 
Lets take a look at what one of the poker clients is doing under the covers.  Below 
we list some of the interesting items that the Cake poker client performs. 
•
Function Calls 
EnemyWindowNames() 
EnemyProcessNames() 
EnemyProcessHashs() 
EnemyDLLNames() 
EnemyURLs () 
•
Examines the system from programs or services it deems unauthorized 
•
OLLYDBG  
•
POKEREDGE  
•
POKERRNG  
•
WINHOLDEM  
•
OPENHOLDEM  
•
WINSCRAPE  
•
OPENSCRAPE  
•
pokertracker  
•
pokertrackerhud  
•
HoldemInspector  
•
HoldemInspector2  
•
HoldemManager  
•
HMHud  
© SeNet International Corp. 2011 
39 
August 2011 
SeNet 
Poker Client Behind the Scenes 
(Cont.) 
Well-known modifications and behavior observed by online poker clients: 
1.
Modification to the Windows host-based firewall policies which allows for automatically 
authorizing various poker clients 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy
\StandardProfile\AuthorizedApplications\List "C:\Program Files\Cake Poker 2.0\PokerClient.exe“ 
2.
Scanning the windows process table 
-
Cake poker reads through each of your process after approximately 10-20 minutes of idle time 
(Reading the .exe files in 4k increments) – based on  Cake poker client 2.0.1.3386 
3. Ability to read the body and title bar text from every window you have open. 
-  Extracts the window handles (HWND), caption, class, style and location of the windows. 
4. Ability to detect mouse movements in order to determine human vs. automated movements. 
- Mouse_event API / bots work the same way by writing custom mouse or keyboard drivers 
© SeNet International Corp. 2011 
40 
August 2011 
SeNet 
Poker Client Behind the Scenes 
(Cont.) 
Additionally functionality found in poker clients: 
1.
Poker applications scan for instances of winholdem/Bonus bots (Shanky 
technologies) running on your workstation or VM instance. 
2.
Poker clients monitor table conversation for lack of table talk and longevity of 
sessions. 
3.
Numerous tools to detect monitoring of your filesystem and registry can be used. 
4.
Poker applications are known for monitoring Internet Caches for URL history 
information. 
5.
Cookie creation from just about every client. 
© SeNet International Corp. 2011 
41 
August 2011 
SeNet 
Poker Client Behind the Scenes 
(Cont.) 
-
Cake Poker client is comprised of three main processes (CakePoker.exe, 
PokerClient.exe, and CakeNotifier.exe). 
-
The client scans itself during random intervals most likely protecting itself against 
modification or patching of the executables. 
-
Found the client (CakeNotifier.exe) also scanning directories containing packet 
capture files and reflector ( a .NET decompiler)??? 
-
Cake poker’s executables are all obfuscated 
-
PokerClient.exe is obfuscated – 12mb in size (huge – most likely encrypted). 
-
Bodog verion 3.12.10.5 is only 4mb in size 
© SeNet International Corp. 2011 
42 
August 2011 
SeNet 
Poker Client Behind the Scenes 
(Cont.) 
-
Bodog verion 3.12.10.5 file monitoring and registry activity 
-
Prefetch files are created in C:\Windows\Prefetch 
-
Digital certificate directory is created - 
C:\Users\jd\AppData\LocalLow\Microsoft\Cryptnet\UrlCache (used for storing 
certificates) 
-
BPGame.exe modifies itself with new attributes 
-
Reads through your URL cache 
-
Loads images from Bodog poker installation directory 
© SeNet International Corp. 2011 
43 
August 2011 
SeNet 
Poker Client Behind the Scenes 
(Cont.) 
Queries your registry 
-
Looks in your 
HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2 
-
Queries your hardware settings on your workstation 
-
Read User Shell folder – the user shell folder subkey stores the paths to Windows 
Explorer folders for the current user of the computer. 
-
TCP send request from localhost to 66.212.245.235 on port 80  
-
(After SSL handshake) - TCP send request from localhost to 66.212.249.155 on port 
7997 
-
Session manager (HKLM\Sysstem\CurrentControlSet\Session manager 
• Gets the environment variables of the machine 
• Username 
• Root directory of windows 
• Tmp dir 
• Path 
• Operating system 
© SeNet International Corp. 2011 
44 
August 2011 
SeNet 
Web Application Vulnerabilities 
© SeNet International Corp. 2011 
45 
August 2011 
SeNet 
Web App Vulnerabilities (Cont.) 
© SeNet International Corp. 2011 
46 
August 2011 
SeNet 
Web App Vulnerabilities (Cont.) 
© SeNet International Corp. 2011 
47 
August 2011 
SeNet 
Web App Vulnerabilities (Cont.) 
© SeNet International Corp. 2011 
48 
August 2011 
SeNet 
Web App Vulnerabilities (Cont.) 
If you thought it took some advanced techniques… Fail. 
•
Cross-site scripting heaven (persistent and reflective); 
apparently the designers felt  might be needed 
in numeric only fields. 
•
Unvalidated redirects; where would you like poker sites 
to take you? 
•
Pretty much zero input validation. 
•
Expired SSL certificates, not necessarily a vulnerability, 
but seriously? 
© SeNet International Corp. 2011 
49 
August 2011 
SeNet 
Authentication Vulnerabilities 
While sophsticated attacks are fun, sometimes you just 
need to go back to the basics.  While some of the sites 
offer multifactor authentication these are not standard 
and cost extra.  The sites differ widely in their 
password complexity requirements. 
Poker Site 
Password Requirements 
Carbon 
Between 6-20 characters 
Bodog 
At least 5 characters 
Cake 
Between 8-14 and must contain the 
following: 
Lower case, upper case, number, 
special character 
Full Tilt 
At least 5 characters 
UB/Absolute 
At least 6 characters 
© SeNet International Corp. 2011 
50 
August 2011 
SeNet 
Authentication Vulnerabilities (Cont.) 
With passwords this strong it must be impossible to 
brute-force…… 
Especially with no account lockout 
And login IDs fairly well known, thank you PTR 
Can anybody say Hydra? Brutus?……… 
© SeNet International Corp. 2011 
51 
August 2011 
SeNet 
Authentication Vulnerabilities (Cont.) 
Some poker sites use non-random 
numbers as UID’s. 
for uid in `seq 3830000 3840000`;do 
echo $uid > users.txt;done 
(1 Second later…) 
Half the battle? Done 
© SeNet International Corp. 2011 
52 
August 2011 
SeNet 
Attacking Supporting Infrastructure 
Several businesses have developed supporting the poker 
sites, these include: 
•
Training sites (Cardrunners, Deuces Cracked) 
•
Tracking sites (PTR, Sharkscope) 
•
Media/Forums (Two+Two) 
If these sites are used by online poker players could they 
be leveraged in order to gain information or launch 
target phishing accounts with the goal to install 
malicious software in order to see their cards? 
© SeNet International Corp. 2011 
53 
August 2011 
SeNet 
Attacking Supporting Infrastructure 
(Cont.) 
© SeNet International Corp. 2011 
54 
August 2011 
SeNet 
Attacking Supporting Infrastructure 
(Cont.) 
© SeNet International Corp. 2011 
55 
August 2011 
SeNet 
Attacking Supporting Infrastructure 
(Cont.) 
© SeNet International Corp. 2011 
56 
August 2011 
SeNet 
River 
© SeNet International Corp. 2011 
57 
August 2011 
SeNet 
Online Poker Defenses - Application 
•
Need to move away from password based 
authentication and toward multifactor, because that 
can’t be hacked right (RSA)? 
•
Maybe implement simple things, say like account 
lockout 
•
Perform robust security testing and configuration 
management 
•
Only allow connections from specific geographic 
locations 
•
Adhere to certain standards (i.e. ISO, PCI, FISMA) 
© SeNet International Corp. 2011 
58 
August 2011 
SeNet 
Online Poker Defenses – User 
•
Have dedicated VM for 
poker and only use it for 
that purpose 
•
Use antivirus/spyware 
(D’oh) 
•
Don’t play on insecure  
wirelesses networks 
•
Use strong, complex 
passwords. Better use 
multifactor 
authentication where 
available 
•
Don’t use same password 
across multiple sites 
•
Monitor your traffic 
© SeNet International Corp. 2011 
59 
August 2011 
SeNet 
Next Steps in Research 
•
Continue digging deeper into the poker client 
•
Custom client to bypass restrictions 
•
Automated tool to brute-force poker passwords 
•
More mapping out poker networks 
•
In-depth look at web application vulnerabilities  
© SeNet International Corp. 2011 
60 
August 2011 
SeNet 
Conclusion 
•
While we did not uncover a smoking gun, based on 
preliminary research there seems to be several areas 
that do require strengthening and further exploration is 
sure to identify more serious issues 
•
Regulation and compliance is needed to attempt to 
make companies develop and secure their gaming 
networks  
•
Do I feel safe playing? 
© SeNet International Corp. 2011 
61 
August 2011 
SeNet 
Questions 
Questions?