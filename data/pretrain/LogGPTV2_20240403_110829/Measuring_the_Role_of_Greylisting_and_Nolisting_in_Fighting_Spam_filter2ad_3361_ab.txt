### Greylisting: Effectiveness and Impact on Normal Email Delivery

**Introduction:**
- Is greylisting still an effective method to combat spam?
- How does the choice of the greylisting threshold affect the delivery of normal emails?
- Does greylisting cause more harm than good?
- Based on our experiments, is there a way to use greylisting to maximize its advantages and minimize its negative impact?

### III. Datasets and Experimental Setup

To evaluate the effectiveness of the two primary anti-spam techniques in our study, we collected four distinct datasets:

1. **Nolisting Analysis Datasets:**
   - The first two datasets are derived from the zmap scans.io project [39] and are used to assess the prevalence of nolisting servers.
   - **DNS Records (ANY) Dataset:** This dataset contains DNS lookups for all domain names, resulting from various types of scans such as reverse DNS scans or HTTP requests. It includes 135 million resolved domains. We focused on A and MX records (mail server queries). For unresolved MX records, we implemented a parallel scanner to resolve the missing entries.
   - **Daily Full IPv4 SMTP Banner Grab and StartTLS zmap Results:** This dataset lists all IPv4 hosts that responded to a SYN packet on port 25, which we labeled as SMTP servers.

2. **Greylisting Analysis Dataset:**
   - This dataset was used to test the impact of the greylisting threshold. It consists of anonymized log entries from the mail server of the Computer Science department at the University of Milan, where greylisting protection is in use. The data covers a four-month period from January to April 2015. Each greylisted message includes the time of each attempted delivery from the client, with the threshold set to 300 seconds.

3. **Malware Sample Dataset:**
   - This dataset contains malware samples in the form of executable binaries, representing the top malware families responsible for generating the majority of spam on the internet. We identified these families based on reports from antivirus companies, such as the Symantec Threat Report 2014 [12]. The top four families account for over 90% of botnet spam traffic.
   - We collected hashes of malware samples from security public reports and downloaded the corresponding binaries from repositories like VirusTotal [7], VirusShare [6], and malwr [8].
   - Each sample was analyzed in an instrumented environment using two VirtualBox virtual machines: a Mail Server VM running Postfix and Postgrey, and an Infected VM running a vanilla Windows 7 installation. We monitored the behavior of each malware sample for 30 minutes and included only those that generated spam traffic in our dataset.

### IV. Nolisting

**A. Worldwide Adoption of Nolisting:**

- To estimate the number of domains using nolisting, we combined two datasets: the DNS Records (ANY) and the IPv4 SMTP Banner Grab.
- The process involves retrieving and verifying MX records, resolving IP addresses, and checking if the primary MX server is operational.
- Our approach covered 42.6 million email servers, resolving to over 49.2 million non-unique IP addresses. The results showed that 47.8% of the domains have only one MX record, 45.9% use multiple records but not nolisting, and 5% had DNS misconfigurations. Only 0.52% of the domains used nolisting, accounting for over 133 thousand domains, including some high-ranking domains according to Alexa [1].

**B. Impact on Spam Delivery:**

- We conducted experiments using the four major malware families responsible for the majority of spam messages in 2014. All SMTP traffic generated by the samples was redirected to our server, configured to use nolisting.
- The results, summarized in Table II, show that nolisting is effective against Kelihos but ineffective against Cutwail and Darkmailer. Since Kelihos is responsible for over 36% of botnet-generated spam, this indicates that nolisting still has a positive impact in reducing spam.
- Understanding why a technique works is crucial. Further analysis is needed to determine the specific reasons for the effectiveness of nolisting against certain malware families.

### V. Greylisting

**Effectiveness and Threshold Impact:**

- Greylisting remains an effective method to reduce spam, but the choice of the greylisting threshold can significantly affect the delivery of normal emails.
- Our experiments suggest that a well-chosen threshold can maximize the benefits of greylisting while minimizing delays for legitimate emails.
- While greylisting can cause some inconvenience, the overall benefit in reducing spam makes it a valuable tool when properly configured.

### Conclusion

- Greylisting and nolisting are both effective in combating spam, but their effectiveness varies depending on the specific malware family.
- Proper configuration and understanding of the underlying mechanisms are essential to maximize the benefits and minimize the negative impacts of these techniques.
- Future research should focus on developing more sophisticated methods to adapt to evolving spam tactics and further improve the effectiveness of these anti-spam measures.