SCOTT MOULTON’S SPEECH RESEARCH MATERIAL AND NOTES ON DATA RECOVERY 
www.ForensicStrategy.com|www.MyHardDriveDied.com             
Copyright © June 2007 by Scott A. Moulton @ Forensic Strategy Services, LLC. All rights reserved. 
Data Recovery Whitepaper – Rev 17                                                                                                   Page 1 of 22 
Data recovery is necessary when source material fails and where no good backup 
exists, either Physical or Logical. There are two types of data recovery in the standard 
basic sense.  One type of data recovery is when there is damage to the media and the 
pre-existing data need to be retrieved. This will usually require the media to be repaired.  
The second form of data recovery is when files were purposely or accidently deleted.  
When this type of data recovery is necessary there is usually no damage to the media 
and standard software can be used to recover the data.  This is the process that most 
software performs. Very few software programs understand damaged media. Because 
most software relies on calls and functions from the operating system for its input, it has 
no control itself over error correction or any functions that the operating system 
performs on the drive. I believe there a four phases to any data recovery. 
Four Phases of Recovery 
1. Repair the Hard Drive so it is running in some form, usually requiring hardware or 
special equipment. 
2. Image, Copy or recover the physical drive and sectors primarily by bitstream 
imaging. If the drive is functioning, it is possible to do this with software, however 
there are some hardware solutions that work very well; i.e. DeepSpar Disk 
Imager. This is a situation where some software is better than others, such as 
dd_rescue (use with dd_rhelp script) on a Linux system has a special feature that 
allow it to image backward (understanding why you need to image backwards is 
very important in data recovery). 
3. Perform Logical Recovery of files, partition structures, or necessary items; 
usually this is by software and is the most common type of application sold.  
4. Repair of files that might have existed in damaged space or sectors to recover 
what is possible.  This is usually the requirement in Forensics to be able to re-
assemble data to display what was there, if whole or not. This is also applied in 
data recovery for corrupt Word and Excel documents. 
The hard drive knows nothing about your files and is not aware in any way of the 
content. That is the job of the Operating System (OS from here on). When the OS asks 
for a file, the OS will request a logical block from the drive; the drive will translate that to 
the physical location in CHS. An example is that it might request data from Cylinder 
2500 at head 2 located on sector 234. The drive has many spare sectors and 
sometimes spare tracks to be used to compensate for errors and relocation of data. 
NOTE: Look at $BadClus on a NTFS File system for what the OS thinks is bad. 
Slide XXX: To begin with, I would like to discuss a few new items in data recovery that I 
am working on. Recovering data from USB flash memory sticks.  I have begun 
experimenting with flash drives by removing the chips and moving them to a new flash 
drive to recover the data. As we are all aware, solid state is going to overtake the hard 
drives soon rather than later.  Right now SanDisk is making a 32 gig hard drive 
replacement for laptops that is completely solid state and you can currently buy (for less 
SCOTT MOULTON’S SPEECH RESEARCH MATERIAL AND NOTES ON DATA RECOVERY 
www.ForensicStrategy.com|www.MyHardDriveDied.com             
Copyright © June 2007 by Scott A. Moulton @ Forensic Strategy Services, LLC. All rights reserved. 
Data Recovery Whitepaper – Rev 17                                                                                                   Page 2 of 22 
than $200) a memory stick that is 16 gigs. From the evidence shown it is extremely 
probable that technology will advance more towards solid state data storage due to its 
reliability and low power consumption. 
A major downfall of flash memory is that it can only be erased one block at a time. A 
block of flash memory chip can only be erased a certain number of times before the 
block will fail. Usually this number is something in the neighborhood of 1 million erase-
write cycles before it will die. Reading and writing to the chips will wear out the blocks 
quickly if it was just raw memory. To prevent this from happening too quickly there is an 
operating system that controls the placement of data on the chip.  The chip counts a 
number of writes and spreads the data between different sectors to minimize the same 
block being written too often. This process is called wear leveling. Without wear 
leveling, a memory stick that is used constantly would die in a few weeks. With the use 
of wear leveling it is estimated that the memory stick could last 50 years or more.   
In order to repair a memory stick, you have to find as close to an exact match of the 
same board and unsolder the undamaged chips from the board and mount them onto 
new board. It does not work every time, but I have been successful at it several times.   
This is a process I am still developing and as I discover more about memory stick repair 
and what you can do to recover data I will release additional info.  I am hoping to meet 
someone that works at SanDisk to hopefully answer a few questions about TrueFFS, so 
if you are one reading this please contact me.   
TrueFFS Notes 
For emulating a hard disk interface, Flash Disk requires software a 
management layer. M-Systems developed the TrueFFS its Flash File 
System management technology that allows flash components to fully 
emulate hard disk. Allowing it to read and write like any other hard 
disks.  
TrueFFS Software simplifies and enhances Flash memories by: 
• Using Third generation wear leveling - wear leveling 
ensures that all blocks are erased an equal number 
of times, which increases the life of the product by 
orders of magnitude. 
• Using virtual blocking of the flash device to make the 
large erase blocks transparent to the operator.  
• Automatically mapping bad blocks 
So that is the new flash memory stuff and I will keep you updated in the future.  Now on 
to hard drives. 
SCOTT MOULTON’S SPEECH RESEARCH MATERIAL AND NOTES ON DATA RECOVERY 
www.ForensicStrategy.com|www.MyHardDriveDied.com             
Copyright © June 2007 by Scott A. Moulton @ Forensic Strategy Services, LLC. All rights reserved. 
Data Recovery Whitepaper – Rev 17                                                                                                   Page 3 of 22 
In a previous speech here at Defcon 14, I gave the basic inner workings of a hard drive 
and several ways you can repair it. I am sure that you can get that previous speech on 
DVD, find it on the web, or on www.myharddrivedied.com and it will give you a large 
amount of info that I am not going to discuss here today.  Additionally, there is a 
whitepaper on the CD that includes more data and notes about repairing a hard drive.  
Since my last speech one of the most common questions I get everyday is “What is that 
clicking noise? How do I fix it?” This is not a simple problem by any means.  So my goal 
today is to give you more insight into the inner workings your hard drive and explain 
how this problem occurs and what you might be able to do to fix it.   
Slide 1208: In this speech we are looking at the platter assembly where the heads are 
located, through the area of the preamp and the IC Logic Board down to the PCB.  This 
is the area that affects what is causing the clicking noise that you hear.  I am now going 
to explain how each of these things works and walk you through the drive functions. 
Part of what causes this clicking problem is related to the power on routine functions.  
The boot sequence of a drive is as follows: 
1. Power on chip returns status 
2. Self check 
3. Spindle spin up 
4. Un-mounting heads from rack 
5. Servo timing reads - firmware 
6. SA reading - firmware 
7. Firmware extensions reading 
8. Error – read SA from other secondary copies 
Slide 1289: The first thing a hard drive will do after it receives power is check for a 
return status from it’s chips to make sure the electronics are functioning. Then the drive 
will begin the self-check of its parts and wait for a return status. If both status checks are 
returned then the drive continues on to the next step and spin up the spindle. 
Slide1389: The drive begins to spin the spindle or as you would see, the platters begin 
to revolve.  When the platters begin to revolve the air flow around the platter creates a 
force that is called an air bearing.  This air bearing will fling off debris on the platters 
such as any dust particles or metal fragments from the standard operation of the drive. 
This air bearing also causes the plastic locking arm mechanism to move out of the way 
as soon as there is enough air flow for the head to float. Without that airflow the arm is 
locked in place and will not move over the platter. This is a way to protect the platter 
from the head touching the platter and causing physical damage. The opposite is true 
during a power down. When power is cut to the drive, during the last revolutions of the 
motor, it generates enough power to move the head back to it park position.  Because 
of this, as you can imagine,  if you get enough power on and power off cycles in a row it 
SCOTT MOULTON’S SPEECH RESEARCH MATERIAL AND NOTES ON DATA RECOVERY 
www.ForensicStrategy.com|www.MyHardDriveDied.com             
Copyright © June 2007 by Scott A. Moulton @ Forensic Strategy Services, LLC. All rights reserved. 
Data Recovery Whitepaper – Rev 17                                                                                                   Page 4 of 22 
is possible for the head to be stuck in the center of the platter and never to be parked 
correctly causing several types of damage. In certain 80 gig laptop 2.5” inch drives it is 
common for the head to be stuck to the center of the platter, never having parked and 
keeping the platters from spinning. In most cases there is very little damage if the drive 
is opened and manually turned slow enough not to damage the head, and the data can 
be recovered, obviously never using this drive again. 
Slide 1483: At this point, if the all has proceeded correctly the air bearing will allow the 
head to float over the platter allowing it to move freely without scratching the surface of 
the platter. 
Slide 1545: At this point, if the head is reading the Servo Timing info from the platter 
and relaying it to the circuitry so the controller knows the geographic information for the 
placement of data.  (See previous speech at Defcon 14 for discussion about Voice Coil 
and stepping motors to understand the servo info). 
SERVO DATA 
Servo sections are ARC shaped sections that store the location and 
geographic info for each sector. A Split Sector is a sector that is interrupted 
by the servo info. 
Slide 1679: At this point the head moves to the System Area (SA) of the platters and 
reads the content that it requires as well as any additional firmware and overlays. 
Most of the time, the system area is on the outer tracks – the extreme outer edge. This 
is chosen by the manufacturer but is most common on the outside on 3.5 and is 
sometimes written to the inside tracks on a 2.5” inch drive. 
System Area Information Common Names 
1. System Area 
2. Maintenance Tracks 
3. Negative Cylinders 
4. Reserved Cylinders 
5. Calibration Area 
6. Initialization Area 
7. Diskware 
Slide 1781: What is in the System Area Info. Each category is called a Module and is a 
UBA block. 
1. Smart Data 
2. System Logs 
3. Serial Number 
SCOTT MOULTON’S SPEECH RESEARCH MATERIAL AND NOTES ON DATA RECOVERY 
www.ForensicStrategy.com|www.MyHardDriveDied.com             
Copyright © June 2007 by Scott A. Moulton @ Forensic Strategy Services, LLC. All rights reserved. 
Data Recovery Whitepaper – Rev 17                                                                                                   Page 5 of 22 
4. Model Numbers 
5. P-List (Primary Defects List – i.e.: manufacture defect info that does 
not change) 
6. G-List (Grown Defects Lists – sector relocation table) 
7. Program Overlays – Firmware, Executable Code, or updates  
8. Specific Tables like RRO – (recalibrate repeatable run-out and head 
offsets) 
9. Zone Tables 
10. Servo Parameters  
11. Test Routines 
12. Factory Defaults Tables 
13. Recalibration Code Routines 
14. Translator Data 
a. Converts Logical and Physical Address to locations on the drive 
b. Heads and Track Skewing Info 
15. Security Data Passwords for drive – possible encrypted info. 
System Area or System info notes 
1. Usually there are two or more copies on different platters of the 
drive 
2. Most of the time system info is on the Outer Tracks – Extreme 
Outer Edge 
3. If info is corrupt it can be copied from the second one to make 
the drive operable 
4. System Log Info can be written here 
5. SA – Not Uniformed or standard in any way, 
6. Completely different per drive and per drive family 
7. Can sometimes be copied from similar drives or drive families 
using special tools 
8. The smaller the amount of data stored in the SA, the more 
likely it is to replace with parts, PCB’s and heads.  
**** PCB = Printed Circuit Boards 
Slide 1816: The System Area is made of UBA Modules (Utility Block Addressing) which 