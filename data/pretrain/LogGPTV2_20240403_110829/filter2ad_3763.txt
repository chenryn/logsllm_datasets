title:TABOR: A Graphical Model-based Approach for Anomaly Detection
in Industrial Control Systems
author:Qin Lin and
Sridhar Adepu and
Sicco Verwer and
Aditya Mathur
See discussions, stats, and author profiles for this publication at: https://www.researchgate.net/publication/325713341
TABOR: A Graphical Model-based Approach for
Anomaly Detection in Industrial Control Systems
(Presentation as AsiaCCS)
Presentation · June 2018
CITATIONS
0
4 authors, including:
READS
292
Qin Lin
Carnegie Mellon University
27 PUBLICATIONS   159 CITATIONS   
Sridhar Adepu
Singapore University of Technology and Design
56 PUBLICATIONS   946 CITATIONS   
SEE PROFILE
SEE PROFILE
Some of the authors of this publication are also working on these related projects:
Wind Speed Signal Processing View project
Advancing Security of Public Infrastructure using Resilience and Economics View project
All content following this page was uploaded by Qin Lin on 12 June 2018.
The user has requested enhancement of the downloaded file.
TABOR: A Graphical Model-based Approach for 
Anomaly Detection in Industrial Control Systems 
Qin Lin, Sridhar Adepu, Sicco Verwer, Aditya Mathur 
1 
Outline 
n  Introduction to SWAT 
n  Related work 
n  Methodology 
n  Results 
n  Conclusion 
2 
P1: Raw water supply and storage.     P2: Pretreatment via chemical dosing. 
P3: Ultrafiltration (UF) and backwash. P4: De-Chlorination system. 
P5: Reverse osmosis (RO).                 P6: RO permeate transfer, UF backwash and cleaning. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
3 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
4 
An example of sensor attack (manipulation) on SWaT 
An attack manipulates the real value of flow indicator (around 2m3/h) to 0.7 m3/h then 0 m3/h. Actuator 
UV and Pump 501 are turned off because the PLC believes that there is no water transmitted from the 
RO feed tank. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
5 
ü  Knowledge-based (specific pattern of misbehavior) 
–  Signature (keep up-to-date dictionary of known attacks) 
– 
Intruder profiling 
ü  Behavior-specification-based (rules of legitimate behavior, design centric) 
     e.g., physical properties about how system exactly should behave 
ü  Behaviour based (learning normal behavior profile, data centric) 
–  Statistical-based approach 
–  Non-parametric approach, clustering, SVM 
Mitchell, Robert et al. "A survey of intrusion detection techniques for cyber-physical systems." ACM Computing Surveys (CSUR) 46.4 (2014): 55. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
6 
Anomaly-based intrusion detection (figure adapted from [1]) 
  [1] Han, Song, et al. "Intrusion detection in cyber-physical systems: Techniques and challenges." IEEE systems journal 8.4 (2014): 1052-1062. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
7 
Challenges: 
1. Interpretation: Can we explain the 
outcome of attack detection?  
2. Localization: Can we localize the 
anomaly in high-dimension data? 
3. Feasibility: Can we verify the model by 
human experts? 
Anomaly-based intrusion detection (figure adapted from [1]) 
  [1] Han, Song, et al. "Intrusion detection in cyber-physical systems: Techniques and challenges." IEEE systems journal 8.4 (2014): 1052-1062. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
8 
ü  Knowledge-based (specific pattern of misbehavior) 
–  Signature (keep up-to-date dictionary of known attacks) 
– 
Intruder profiling 
ü  Behavior-specification-based (rules of legitimate behavior, design centric) 
     e.g., physical properties about how system exactly should behave 
ü  Behaviour based (learning normal behavior profile, data centric) 
–  Statistical-based approach 
–  Non-parametric approach, clustering, SVM 
TABOR:  
n  Model learning from normal data 
n  Understandable and interpretable (graphical model) 
n  Verifiable by human experts 
Mitchell, Robert et al. "A survey of intrusion detection techniques for cyber-physical systems." ACM Computing Surveys (CSUR) 46.4 (2014): 55. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
9 
Data description 
22/12/2015 4:00:00 PM - 2/1/2016 2:59:59 PM 
Sampling Time: 1 second 
946,719 (rows) * 53 (columns) 
51 sensors & actuators 
1 label (‘Normal’/’Attack’) 
1 timestamp 
Training: normal data 22/12/2015 4:00:00 PM-28/12/2015 10:00:00 AM 
Testing: 28/12/2015 10:00:00 PM-2/1/2016 2:59:59 PM 
36 attacking scenarios (duration: 101seconds - 10hours) 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
10 
Decomposition of high dimension data: 
local control behaviors learning 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
11 
n  Automata learning regular sensor data: e.g., water levels fluctuation 
n  Dependency learning: sensors and actuators in each stage: e.g., pump open->water level increase 
n  Signal with large noise and sublet trend: statistical checking, e.g., chemical sensor  µ ± c∗σ
SWAT Introduction    Related work    Methodology    Results    Conclusion  
12 
Symbolic and timed representation 
Benefit 
n  High level behavior overview 
n  Robust to noise 
n  Understandable natural language 
Extracting mean trend value in each chunk 
n 
n  Clustering the mean values 
n 
Interpreting in natural language: SLOW UP (SU), QUICK UP (QU), STAY CONSTANT 
(SC), QUICK DOWN (QD) 
Timed string representation: (SU,1900), (QU, 600), (SC, 550), (QD, 700)… 
n 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
13 
Learning Deterministic Timed Automaton [1]  
Timed prefix tree constructed from input timed strings: 
S =  (a, 1) 
       (a, 1)(b, 2)(b, 1) 
       (b, 2)(b, 1) 
       (a, 1)(b, 1)(a, 1) 
       (b, 2) 
       (b, 1) 
Knowledge recall (rote learning) 
Refinement: getting distinct timed behavior 
Abstraction: generalization of similar behavior 
Verwer, Sicco, etal. "Learning driving behavior by timed syntactic pattern recognition." IJCAI. Vol. 22. No. 1. 2011. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
14 
Time bound 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
15 
Symbolic representation of LIT sensor is SU, QU, 
SC, QU, SU. The third letter is not accepted by the 
learned state machine, because it is expected to see 
QD after SC.  
SWAT Introduction    Related work    Methodology    Results    Conclusion  
16 
valid event but invalid timing 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
17 
Sensor & actuator dependency learning 
concurrent event alignment 
Symbolic events in actuator: OPEN or OFF 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
18 
Learning Bayesian network 
DAG: directed acyclic graph (BN’s structure) 
n  Nodes: random variables  
n  Arcs: indicate probabilistic dependencies between nodes (lack of link signifies conditional in 
CPD: conditional probability distribution (BN’s parameters) 
n  Conditional probabilities at each node, usually stored as a table (conditional probability table, 
dependence) 
CPT) 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
19 
Finding the BN structure with the highest score among those 
structures with at most k parents is NP hard for k>1 [1] 
Heuristic methods 
n  Greedy e.g., K2 [2] 
n  MCMC methods 
initialize 
Structure 
score 
all possible 
single changes 
any 
changes 
better? 
yes 
no 
Return 
structure 
perform 
best 
change 
[1] Heckerman, et al. "Learning Bayesian networks: The combination of knowledge and statistical data." Machine learning 20.3 (1995): 197-243. 
[2] Cooper, et al. "A Bayesian method for the induction of probabilistic networks from data." Machine learning 9.4 (1992): 309-347. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
20 
water pump in 
water pump out 
QD 
SC 
SU 
QU 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
21 
BN detection example 
The attacker opens MV101 (water pump in) in this case, breaks the dependence between sensor and actuator 
(MV101 should be closed at that time), and leads to overflow in the tank. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
22 
Types of anomaly 
n  Timed automaton: 
     (a) Event error: an invalid event at given state; 
     (b) Timing error: an event duration outside valid timing guard; 
n  Bayesian network: 
     a zero probability entry in the CPD 
n  Out of alphabet (OOA): 
     sensor value exceeds the threshold, actuator value did not occur in the training data. 
Conservative fusion strategies: 
OOA or (TA and BN) 
n  High cost of FP 
n  TA is sensitive  
n  OOA has highest priority 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
23 
Evaluation: window-based 
Time series discord (unusual motif) [1] 
■ 
■  More meaningful than isolated points 
Interval based 
[1] Senin P et al. Time series anomaly discovery with grammar-based compression. In EDBT 2015 Mar 23 (pp. 481-492). 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
24 
TABOR detection results 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
25 
Statistical checking example 
chemical sensor 
pressure sensor 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
26 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
27 
Evaluation: point-based 
Model 
Scenarios	detected 
DNN 
SVM 
TABOR 
13 
20 
24 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
28 
Total	size 
TP 
FP 
TN 
FN 
450000	(125h) 
42448	(11.79h) 
6812	(1.89h) 
389322	(108.15h) 
11418	(3.17h) 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
29 
An example of detection results from PIT501. The false alarm is caused by the stabilization procedure after an attack. 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
30 
•  A solution for the interpretation and localization of anomaly detection. The model is 
also verifiable by human experts. 
(More accurate) More attack scenarios are successfully detected compared to those 
detected using methods based on deep neural network (DNN) and the support vector 
machine (SVM) with low false positive. 
(More efficient) Learning in polynomial time and testing in (O(1)). 
• 
• 
SWAT Introduction    Related work    Methodology    Results    Conclusion  
31 
View publication stats
View publication stats