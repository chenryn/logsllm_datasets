 10
 60
Figure 14: RTT in real conﬁguration
(Salt Lake City→Atlanta).
Time (s)
 40
 50
Shadow Only
Cancellation Enabled
Cancellation Disabled
 25
 20
 15
 10
 5
)
s
p
b
M
(
t
u
p
h
g
u
o
r
h
T
 0
 0
 50
 40
 30
 20
 10
Time (s)
 60
Figure 16: Stream throughput (Houston→Chicago).
ﬁlter. Most tools typically focus on a single piece or set of func-
tionality (e.g., routing, access control, or QoS).
• The conﬁguration evaluation system should scale as the network
size grows. Many simulators can have limited capacity as com-
pared to the network it is simulating, making it difﬁcult and in-
efﬁcient to run tests with large demands.
• On the forwarding plane, the performance depends on trafﬁc de-
mand pattern, FIBs, hardware capability, and software imple-
mentations. If a tool conducts performance evaluation based on
a very coarse-grained model (e.g., a link is characterized by two
simple numbers such as propagation delay and bandwidth), per-
formance problems may not be revealed.
Comparison with Virtualization: One possibility to address some
of the problems of static analysis or simulation is to utilize the re-
cently proposed network virtualization techniques such as Planet-
Lab slices [9], VINI [4], CABO [16], or Juniper’s Logical Router
feature [27].
A key difference between shadow conﬁgurations and these vir-
tualization techniques such as PlanetLab and VINI is objective.
Speciﬁcally, the main objective of the aforementioned virtualiza-
tion studies is on building general, ﬂexible experimental facilities
for researchers. Thus, the focus is more on providing capabilities
such as ﬂexible (overlay) experimental topology constructions, and
ﬂexible routing and forwarding (or programmability on the network
elements in general). Also, as application-oblivious experimental
facilities, general virtualization would need to consider each virtual
network as independent and thus a key issue is to provide isolation
among them.
The objective of shadow conﬁgurations, on the other hand, is to
provide an effective and easy-to-use capability for network opera-
tors in the speciﬁc but important domain of conﬁguration testing. A
conﬁguration may have multiple virtual networks (e.g., VPNs) con-
structed inside according to the conﬁguration ﬁles in the shadow
conﬁguration, but this is transparent to us. In a speciﬁc domain,
general ﬂexibility may not be necessary, and the overhead may be
too high in production networks.
Conceptually, one can consider the real and the shadow conﬁgu-
rations as two virtual networks. From this perspective, our main
contribution is a novel usage of virtualization for the important
domain of network conﬁguration management. Instead of forcing
users to adapt to the underlying technique (i.e., asking operators to
Shadow Only
Cancellation Enabled
Cancellation Disabled
 0
 20
 10
 70
Figure 15: Loss rate for streams (Salt
Lake City server).
 30
 40
Time (s)
 50
 60
Real at 40% Utilization
Shadow at 40% Utilization
y
t
i
l
i
b
a
b
o
r
P
 1
 0.8
 0.6
 0.4
 0.2
 0
No Shad.
20% Shad.
40% Shad.
60% Shad.
-0.4 -0.2  0  0.2  0.4
Delay Variation (ms)
No Real
20% Real
40% Real
60% Real
-0.4 -0.2  0  0.2  0.4
Delay Variation (ms)
Figure 17: Delay variation CDF (illustrative topology).
explicitly construct virtual experiments for conﬁguration manage-
ment), we use the user interface that a network operator is already
using to provide an easy-to-use tool. The most important design
objective of shadow conﬁgurations is simplicity and ease of use,
as this is the objective prompted in many settings (e.g., the collec-
tive plea of LISA 2006 Conﬁguration Workshop). In addition, we
enrich the domain of application of virtualization by creating two
correlated virtual networks for a single task. Our novel capabili-
ties of packet cancellation and conﬁguration commitment provide
examples where it may be beneﬁcial to extend beyond general vir-
tualization where virtual networks are typically considered inde-
pendent.
One recent work that also applies virtualization to network con-
ﬁguration management is VROOM [50]. Their objective is to re-
duce logical topology change by allowing dynamic binding be-
tween virtual routers to physical routers. This objective is different
from our objective, which in one sentence is to discover issues in a
new conﬁguration before its real deployment.
10. CONCLUSION AND FUTURE WORK
In this paper, we presented the novel idea of shadow conﬁgura-
tions. We developed novel techniques such as packet cancellation
and shadow commitment to substantially improve the capability of
conﬁguration evaluation and management. There are many avenues
for future exploration. In particular, we would like to conduct an
extensive evaluation on using shadow conﬁguration for automating
conﬁguration debugging and network diagnostics. We would also
like to study their usage in carrier-grade installations.
11. ACKNOWLEDGMENTS
Richard Alimi and Y. Richard Yang were supported in part by grants
from the U.S. NSF. We would like to thank Yuan Dong and Ehab Al-Shaer
for greatly beneﬁcial initial discussions. The main algorithm of FIB anal-
ysis was contributed by Hao Wang. He has also made many other key ob-
servations. We are also grateful to Jim Aspnes, Matthew Caesar, Charles
Kalmanek, Karthik Lakshminarayanan, Erran Li, Jennifer Rexford, Zhong
Shao, Avi Silberschatz, and Xiaowei Yang for valuable suggestions.
12. REFERENCES
[1] M. Agrawal, S. Bailey, A. Greenberg, J. Pastor, P. Sebos, S. Seshan,
J. van der Merwe, and J. Yates. Routerfarm: Towards a dynamic,
manageable network edge. In ACM SIGCOMM INM, 2006.
[2] P. Anderson and A. Scobie. Large scale Linux conﬁguration with
LCFG. In Proc. of ALS, Berkeley, CA, 2000.
[3] H. Ballani and P. Francis. Conman: A step towards network
manageability. In ACM SIGCOMM, Kyoto, Japan, Aug. 2007.
[4] A. Bavier, N. Feamster, M. Huang, L. Peterson, and J. Rexford. In
VINI veritas: Realistic and controlled network experimentation. In
ACM SIGCOMM, Pisa, Italy, Sept. 2006.
[5] M. Caesar, L. Subramanian, and R. Katz. A case for an Internet
health monitoring system. In HotDep, 2005.
[6] CAIDA: Cooporative association for Internet data analysis.
http://www.caida.org/.
[7] X. Chen, Z. M. Mao, and K. van der Merwe. Towards automated
network management: Network operations using dynamic views. In
ACM SIGCOMM INM, 2007.
[8] B.-Y. Choi1, S. Moon, Z.-L. Zhang, K. Papagiannaki, and C. Diot.
Analysis of point-to-point packet delay in an operational network. In
Proceedings of IEEE INFOCOM ’04, Hong Kong, China, Apr. 2004.
[9] B. Chun and et al. Planetlab: an overlay testbed for broad-coverage
services. ACM CCR, 33(3):3–12, 2003.
[10] Cisco Systems. Common routing problem with OSPF forwarding
address.
http://www.cisco.com/warp/public/104/10.pdf.
[11] Cisco Systems. Network solutions integrated test environment:
Delivering on the promise of innovation. URL: http://www.
cisco.com/application/pdf/en/us/guest/netsol/
ns522/c2072/cdccont_0900aecd80458f98.pdf, 2006.
[12] M. Crovella, C. Lindemann, and M. Reiser. Internet performance
modeling: the state of the art at the turn of the century. Performance
Evaluation, 42:91–108, 2000.
[13] A. Dhamdhere, R. Teixeira, C. Dovrolis, and C. Diot. Netdiagnoser:
Troubleshooting network unreachabilities using end-to-end probes
and routing data. In In the Proceedings of CoNEXT’07, Dec. 2007.
[14] W. Enck, P. McDaniel, Subhabrata, P. Sebos, S. Spoerel,
A. Greenberg, S. Rao, and W. Aiello. Conﬁguration management at
massive scale: System design and experience. In USENIX, Santa
Clara, CA, June 2007.
[15] N. Feamster and H. Balakrishnan. Detecting BGP conﬁguration
faults with static analysis. In NSDI, May 2005.
[16] N. Feamster, L. Gao, and J. Rexford. How to lease the Internet in
your spare time. ACM CCR, 37(1):61–64, 2007.
[17] A. Feldmann. Netdb: IP network conﬁguration debugger/database.
Technical report, AT&T Research, July 1999.
[18] A. Feldmann and J. Rexford. IP network conﬁguration for
intradomain trafﬁc engineering. IEEE Network Magazine, pages
46–57, Sept./Oct. 2001.
[19] B. Fortz, J. Rexford, and M. Thorup. Trafﬁc engineering with
traditional IP routing protocols. IEEE Communication Magazine,
Oct. 2002.
[20] P. Francois and O. Bonaventure. Avoiding transient loops during IGP
convergence in IP networks. In IEEE INFOCOM, Miami, FL, Apr.
2005.
[21] P. Francois, M. Shand, and O. Bonaventure. Disruption free topology
reconﬁguration in OSPF networks. In IEEE INFOCOM, Anchorage,
AK, May 2007.
[22] H. Hamed, E. Al-Shaer, and W. Marrero. Modeling and veriﬁcation
of IPSec and VPN security policies. In IEEE ICNP, Boston, MA,
Nov. 2005.
[23] M. Handley, E. Kohler, A. Ghosh, O. Hodson, and P. Radoslavov.
Designing extensible IP router software. In NSDI, May 2005.
[24] U. Hengartner, S. Moon, R. Mortier, and C. Diot. Detection and
analysis of routing loops in packet traces. In IMW, Marseille, France,
Nov. 2002.
[25] L. Huang, X. Nguyen, M. Garofalakis, J. Hellerstein, M. Jordan,
A. D. Joseph, and N. Taft. Communication-efﬁcient online detection
of network-wide anomalies. In IEEE INFOCOM, Anchorage, AK,
May 2007.
[26] W. John and S. Tafvelin. Analysis of Internet backbone trafﬁc and
header anomalies observed. In IMC, Aug. 2007.
[27] Juniper Networks. Intelligent logical router service. URL:
http://www.juniper.net/solutions/literature/
white_papers/200097.pdf, Oct. 2004.
[28] S. Kandula, D. Katabi, and J.-P. Vasseur. Shrink: A tool for failure
diagnosis in IP networks. In MineNet, Aug. 2005.
[29] Z. Kerravala. As the value of enterprise networks escalates, so does
the need for conﬁguration management, Jan. 2004.
[30] Z. Kerravale. Conﬁguration management delivers business resiliency.
The Yankee Group, 2002.
[31] E. Kiciman and L. Subramanian. A root cause localization model for
large scale systems. In IEEE INFOCOM, Anchorage, AK, May 2007.
[32] R. R. Kompella, J. Yates, A. Greenberg, and A. C. Snoeren. IP fault
localization via risk modeling. In NSDI, San Francisco, CA, May
2005.
[33] R. R. Kompella, J. Yates, A. Greenberg, and A. C. Snoeren.
Detection and localization of network black holes. In IEEE
INFOCOM, Anchorage, AK, May 2007.
[34] K. Lakshminarayanan, M. Caesar, M. Rangan, T. Anderson,
S. Shenker, and I. Stoica. Achieving convergence-free routing using
failure-carrying packets. In ACM SIGCOMM, Kyoto, Japan, Aug.
2007.
[35] R. Mahajan, N. Spring, D. Wetherall, and T. Anderson. User-level
Internet path diagnosis. In SOSP, Bolton Landing, Oct. 2003.
[36] D. A. Maltz, G. Xie, J. Zhan, H. Zhang, G. Hjalmtysson, and
A. Greenberg. Routing design in operational networks: A look from
the inside. In ACM SIGCOMM, Portland, OR, Aug. 2004.
[37] S. Narain. Network conﬁguration management via model ﬁnding. In
Proceedings of LISA, pages 155–168, 2005.
[38] S. Narain. Overview of conﬁguration validation. Presentation at
LISA 2006 Conﬁguration Workshop, Dec. 2006.
[39] A. Nucci, S. Bhattacharyya, N. Taft, and C. Diot. ICP link weight
assignment for operational tier-1 backbones. IEEE/ACM
Transactions on Networking, Aug. 2007.
[40] D. Oppenheimer, A. Ganapathi, and D. A. Patterson. Why Internet
services fail and what can be done about these? In USENIX USITS,
Oct. 2003.
[41] Quagga Software Routing Suite. http://www.quagga.net/.
[42] B. Quoitin, S. Uhlig, and O. Bonaventure. Using redistribution
communities for interdomain trafﬁc engineering. In QoFIS’02 LNCS
2511, Oct. 2002.
[43] M. Roughan, T. Grifﬁn, M. Mao, A. Greenberg, and B. Freeman.
Combining routing and trafﬁc data for detection of IP forwarding
anomalies. In SIGMETRICS, New York, NY, June 2004.
[44] University of Oregon Route Views Project.
http://www.routeviews.org/.
[45] A. Soule, K. Salamatian, and N. Taft. Combining ﬁltering and
statistical methods for anomaly detection. In IMC, Aug. 2005.
[46] M. Steinder and A. S. Sethi. A survey of fault localization techniques
in computer networks. Science of Computer Programming,
53:165–194, 2004.
[47] L. Tatman. Incorporating routing analysis into IP network
management. URL: http://www.agilent.com/labs/
features/2003_wp_roca.pdf, May 2003.
[48] VideoLAN - VLC media player. http://www.videolan.org/.
[49] F. Wang, Z. M. Mao, J. Wang, L. Gao, and R. Bush. A measurement
study on the impact of routing events on end-to-end internet path
performance. ACM CCR, 36(4), 2006.
[50] Y. Wang, J. van der Merwe, and J. Rexford. VROOM: Virtual
ROuters On the Move. In HotNets-VI, Atlanta, GA, Nov. 2007.
[51] A. Whitaker and D. Wetherall. Forwarding without loops in icarus. In
IEEE OEPNARCH, 2002.
[52] B. White, J. Lepreau, L. Stoller, R. Ricci, S. Guruprasad,
M. Newbold, M. Hibler, C. Barb, and A. Joglekar. An integrated
experimental environment for distributed systems and networks. In
OSDI, Boston, MA, Dec. 2002.
[53] G. Xie, J. Zhan, D. A. Maltz, H. Zhang, A. Greenberg,
G. Hjalmtysson, and J. Rexford. On static reachability analysis of IP
networks. In IEEE INFOCOM, Miami, FL, Apr. 2005.
[54] A. Zeller. Yesterday, my program worked. today, it does not. Why?
In ESEC / SIGSOFT FSE, pages 253–267, 1999.
[55] B. Zhang, T. S. E. Ng, A. Nandi, R. Riedi, P. Druschel, and G. Wang.
Measurement-based analysis, modeling, and synthesis of the internet
delay space. In IMC, Aug. 2006.
[56] Z. Zhong and et al. Avoiding transient loops through
interface-speciﬁc forwarding. In IWQoS, 2005.