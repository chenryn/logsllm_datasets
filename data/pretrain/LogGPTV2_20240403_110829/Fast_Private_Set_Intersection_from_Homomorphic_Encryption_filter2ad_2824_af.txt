Nxsv + k(1.2Ny + s) ,
where s = 6 is the stash size in cuckoo hashing, k ≈ 444 is the width of the pseudorandom code, v =
λ + log2(NxNy) is the size of the OPRF output, and 1.2 is related to cuckoo hashing utilization. The
communication complexity of [PSZ16] also follows same equation, but with a smaller k due to more optimized
oblivious transfer sub-protocol. Our protocol on the other hand requires
1.5CσNy log2 Nx
bits of communication, where C is a small constant for ciphertext expansion, σ = 32 is the string length, and
1.5 is related to the cuckoo hashing utilization with no stash. For example, when Nx = 224 and Ny = 5535,
our protocol requires only 12.5MB of communication, whereas the empirical communication of [KKRT16] in
this setting is almost 115× larger.
This increase in communication translates into increased running times compared to [PSZ16] and our
protocol in the WAN settings. For instance, when intersecting 5535 and 224 items on a 10Mbps connection,
our protocol is more than 57× faster, while [PSZ16] is only 3× faster. The total running times are summarized
in Table 5 to make comparison to our protocol and to [PSZ16] easy. Since the implementation of [KKRT16]
does not support multi-threading, we only present results for T = 1.
7 Conclusions
Although there has been huge progress in fully homomorphic encryption schemes since the groundbreaking
work of Craig Gentry in 2009, it is still believed by many to be too expensive for practical use-cases. However,
in this paper we have constructed a practical private set intersection protocol using the Fan-Vercauteren
scheme, adopting and combining optimizations from both fully homomorphic encryption and cutting-edge
work on PSI. We think our protocol is particularly interesting for the private contact discovery use-case,
where it achieves a very low communication overhead: about 12MB to intersect a set of 5 thousand items
with a set of 16 million items, which is signiﬁcantly lower than in the previous state-of-the-art protocols.
We regard our work as a ﬁrst step to explore the possibilities of applying fully homomorphic encryption to
private set intersection, and look forward to further discussions and optimizations.
References
ABC+15.
ACT11.
Frederik Armknecht, Colin Boyd, Christopher Carr, Kristian Gjøsteen, Angela J¨aschke, Christian A
Reuter, and Martin Strand. A guide to fully homomorphic encryption. Technical report, IACR Cryptol-
ogy ePrint Archive (2015/1192), 2015.
Giuseppe Ateniese, Emiliano De Cristofaro, and Gene Tsudik. (if) size matters: Size-hiding private set
intersection.
In Dario Catalano, Nelly Fazio, Rosario Gennaro, and Antonio Nicolosi, editors, Public
Key Cryptography - PKC 2011 - 14th International Conference on Practice and Theory in Public Key
Cryptography, Taormina, Italy, March 6-9, 2011. Proceedings, volume 6571 of Lecture Notes in Computer
Science, pages 156–173. Springer, 2011.
AJLA+12. Gilad Asharov, Abhishek Jain, Adriana L´opez-Alt, Eran Tromer, Vinod Vaikuntanathan, and Daniel
Wichs. Multiparty computation with low communication, computation and interaction via threshold
FHE. In Annual International Conference on the Theory and Applications of Cryptographic Techniques,
pages 483–501. Springer, 2012.
Martin R Albrecht. On dual lattice attacks against small-secret lwe and parameter choices in helib and
seal. In Annual International Conference on the Theory and Applications of Cryptographic Techniques,
pages 103–129. Springer, 2017.
Yuriy Arbitman, Moni Naor, and Gil Segev. Backyard cuckoo hashing: Constant worst-case operations
with a succinct representation. In Foundations of Computer Science (FOCS), 2010 51st Annual IEEE
Symposium on, pages 787–796. IEEE, 2010.
Martin R. Albrecht, Rachel Player, and Sam Scott. On the concrete hardness of learning with errors. J.
Mathematical Cryptology, 9(3):169–203, 2015.
ANS10.
Alb17.
APS15.
BdM94.
BFT16a.
BFT16b.
BGH13.
BGV12.
BLLN13.
BV14.
CS16.
DCW13.
Josh Benaloh and Michael de Mare. One-Way Accumulators: A Decentralized Alternative to Digital
Signatures, pages 274–285. Springer Berlin Heidelberg, Berlin, Heidelberg, 1994.
Tatiana Bradley, Sky Faber, and Gene Tsudik. Bounded size-hiding private set intersection. In Interna-
tional Conference on Security and Cryptography for Networks, pages 449–467. Springer, 2016.
Tatiana Bradley, Sky Faber, and Gene Tsudik. Bounded size-hiding private set intersection. In Vassilis
Zikas and Roberto De Prisco, editors, Security and Cryptography for Networks - 10th International
Conference, SCN 2016, Amalﬁ, Italy, August 31 - September 2, 2016, Proceedings, volume 9841 of Lecture
Notes in Computer Science, pages 449–467. Springer, 2016.
Zvika Brakerski, Craig Gentry, and Shai Halevi. Packed ciphertexts in LWE-based homomorphic encryp-
tion. In Public-Key Cryptography–PKC 2013, pages 1–13. Springer, 2013.
Zvika Brakerski, Craig Gentry, and Vinod Vaikuntanathan. (leveled) fully homomorphic encryption with-
out bootstrapping. In Proceedings of the 3rd Innovations in Theoretical Computer Science Conference,
pages 309–325. ACM, 2012.
Joppe W Bos, Kristin Lauter, Jake Loftus, and Michael Naehrig. Improved security for a ring-based fully
homomorphic encryption scheme. In Cryptography and Coding, pages 45–64. Springer, 2013.
Zvika Brakerski and Vinod Vaikuntanathan. Eﬃcient fully homomorphic encryption from (standard)
LWE. SIAM Journal on Computing, 43(2):831–871, 2014.
Ana Costache and Nigel P Smart. Which ring based somewhat homomorphic encryption scheme is best?
In Cryptographers’ Track at the RSA Conference, pages 325–340. Springer, 2016.
Changyu Dong, Liqun Chen, and Zikai Wen. When private set intersection meets big data: an eﬃcient and
scalable protocol. In Proceedings of the 2013 ACM SIGSAC conference on Computer & communications
security, pages 789–800. ACM, 2013.
DGM+10. Martin Dietzfelbinger, Andreas Goerdt, Michael Mitzenmacher, Andrea Montanari, Rasmus Pagh, and
In International Colloquium on
Michael Rink. Tight thresholds for cuckoo hashing via XORSAT.
Automata, Languages, and Programming, pages 213–225. Springer, 2010.
Luc Devroye and Pat Morin. Cuckoo hashing: further analysis. Information Processing Letters, 86(4):215–
219, 2003.
L´eo Ducas and Damien Stehl´e. Sanitization of FHE ciphertexts. In Annual International Conference on
the Theory and Applications of Cryptographic Techniques, pages 294–310. Springer, 2016.
DM03.
DS16.
DSMRY09. Dana Dachman-Soled, Tal Malkin, Mariana Raykova, and Moti Yung. Eﬃcient robust private set in-
In Proceedings of the 7th International Conference on Applied Cryptography and Network
Eri16.
FMM09.
FNP04.
FPSS03.
FV12.
tersection.
Security, ACNS ’09, pages 125–142, Berlin, Heidelberg, 2009. Springer-Verlag.
Ericsson. Ericsson mobility report: On the pulse of the networked society. Stockholm, Sweden, 2016.
Alan Frieze, P´all Melsted, and Michael Mitzenmacher. An analysis of random-walk cuckoo hashing.
In Approximation, Randomization, and Combinatorial Optimization. Algorithms and Techniques, pages
490–503. Springer, 2009.
Michael J. Freedman, Kobbi Nissim, and Benny Pinkas. Eﬃcient private matching and set intersection.
In Christian Cachin and Jan Camenisch, editors, Advances in Cryptology - EUROCRYPT 2004, Interna-
tional Conference on the Theory and Applications of Cryptographic Techniques, Interlaken, Switzerland,
May 2-6, 2004, Proceedings, volume 3027 of Lecture Notes in Computer Science, pages 1–19. Springer,
2004.
Dimitris Fotakis, Rasmus Pagh, Peter Sanders, and Paul Spirakis. Space eﬃcient hash tables with worst
case constant access time. In Annual Symposium on Theoretical Aspects of Computer Science, pages
271–282. Springer, 2003.
Junfeng Fan and Frederik Vercauteren. Somewhat practical fully homomorphic encryption. Cryptology
ePrint Archive, Report 2012/144, 2012. http://eprint.iacr.org/.
Gen09.
GHS12.
GBDL+16. Ran Gilad-Bachrach, Nathan Dowlin, Kim Laine, Kristin Lauter, Michael Naehrig, and John Werns-
ing. CryptoNets: Applying neural networks to encrypted data with high throughput and accuracy. In
Proceedings of The 33rd International Conference on Machine Learning, pages 201–210, 2016.
Craig Gentry. Fully homomorphic encryption using ideal lattices. In STOC, volume 9, pages 169–178,
2009.
Craig Gentry, Shai Halevi, and Nigel P Smart. Homomorphic evaluation of the AES circuit. In Advances
in Cryptology–CRYPTO 2012, pages 850–867. Springer, 2012.
Craig Gentry, Shai Halevi, and Vinod Vaikuntanathan. i-hop homomorphic encryption and rerandomiz-
able yao circuits. In Annual Cryptology Conference, pages 155–172. Springer, 2010.
Craig Gentry, Amit Sahai, and Brent Waters. Homomorphic encryption from learning with errors:
Conceptually-simpler, asymptotically-faster, attribute-based. In Ran Canetti and Juan A. Garay, editors,
CRYPTO (1), volume 8042 of Lecture Notes in Computer Science, pages 75–92. Springer, 2013.
Yan Huang, David Evans, and Jonathan Katz. Private set intersection: Are garbled circuits better than
custom protocols? In NDSS, 2012.
GSW13.
GHV10.
HEK12.
HFH99.
HL08.
HN10.
HN12.
IKNP03.
Bernardo A. Huberman, Matt Franklin, and Tad Hogg. Enhancing privacy and trust in electronic
communities. In In Proc. of the 1st ACM Conference on Electronic Commerce, pages 78–86. ACM Press,
1999.
Carmit Hazay and Yehuda Lindell. Eﬃcient protocols for set intersection and pattern matching with
security against malicious and covert adversaries. In Theory of Cryptography Conference, pages 155–175.
Springer, 2008.
Carmit Hazay and Kobbi Nissim. Eﬃcient set operations in the presence of malicious adversaries. In
International Workshop on Public Key Cryptography, pages 312–331. Springer, 2010.
Carmit Hazay and Kobbi Nissim. Eﬃcient set operations in the presence of malicious adversaries. Journal
of cryptology, 25(3):383–433, 2012.
Yuval Ishai, Joe Kilian, Kobbi Nissim, and Erez Petrank. Extending oblivious transfers eﬃciently. In
Annual International Cryptology Conference, pages 145–161. Springer, 2003.
KLS+17.
KKRT16. Vladimir Kolesnikov, Ranjit Kumaresan, Mike Rosulek, and Ni Trieu. Eﬃcient batched oblivious PRF
with applications to private set intersection. Cryptology ePrint Archive, Report 2016/799, 2016. http:
//eprint.iacr.org/2016/799.
´Agnes Kiss, Jian Liu, Thomas Schneider, N. Asokan, and Benny Pinkas. Private set intersection for
unequal set sizes with mobile applications. Proceedings on Privacy Enhancing Technologies (PoPETs),
2017(4):97–117, 2017. To appear. Full version: http://ia.cr/2017/670. Code: http://encrypto.de/
code/MobilePSI.
Seny Kamara, Payman Mohassel, Mariana Raykova, and Seyed Saeed Sadeghian. Scaling private set
intersection to billion-element sets. In Nicolas Christin and Reihaneh Safavi-Naini, editors, Financial
Cryptography and Data Security - 18th International Conference, FC 2014, Christ Church, Barbados,
March 3-7, 2014, Revised Selected Papers, volume 8437 of Lecture Notes in Computer Science, pages
195–215. Springer, 2014.
Mikkel Lambaek. Breaking and ﬁxing private set intersection protocols. Cryptology ePrint Archive,
Report 2016/665, 2016. http://eprint.iacr.org/2016/665.
KMRS14.
Lam16.
LCP16.
Lin16.
LPR10.
PR01.
Mar14.
Mea86.
LATV12. Adriana L´opez-Alt, Eran Tromer, and Vinod Vaikuntanathan. On-the-ﬂy multiparty computation on
the cloud via multikey fully homomorphic encryption. In Proceedings of the forty-fourth annual ACM
symposium on Theory of computing, pages 1219–1234. ACM, 2012.
Kim Laine, Hao Chen, and Rachel Player. Simple encrypted arithmetic library - SEAL (v2.1). Technical
report, Microsoft Research, September 2016.
Yehuda Lindell. How to simulate it - a tutorial on the simulation proof technique. Cryptology ePrint
Archive, Report 2016/046, 2016. http://eprint.iacr.org/2016/046.
Vadim Lyubashevsky, Chris Peikert, and Oded Regev. On ideal lattices and learning with errors over
rings. In Henri Gilbert, editor, Advances in Cryptology - EUROCRYPT 2010, 29th Annual International
Conference on the Theory and Applications of Cryptographic Techniques, French Riviera, May 30 - June
3, 2010. Proceedings, volume 6110 of Lecture Notes in Computer Science, pages 1–23. Springer, 2010.
Moxie Marlinspike. The diﬃculty of private contact discovery. A company sponsored blog post, 2014.
https://whispersystems.org/blog/contact-discovery/.
C. Meadows. A more eﬃcient cryptographic matchmaking protocol for use in the absence of a contin-
uously available third party. In 1986 IEEE Symposium on Security and Privacy, pages 134–134, April
1986.
Michael Naehrig, Kristin E. Lauter, and Vinod Vaikuntanathan. Can homomorphic encryption be practi-
cal? In Christian Cachin and Thomas Ristenpart, editors, Proceedings of the 3rd ACM Cloud Computing
Security Workshop, CCSW 2011, Chicago, IL, USA, October 21, 2011, pages 113–124. ACM, 2011.
Michele Orr`u, Emmanuela Orsini, and Peter Scholl. Actively secure 1-out-of-n ot extension with ap-
plication to private set intersection. In Cryptographers’ Track at the RSA Conference, pages 381–396.
Springer, 2017.
Rasmus Pagh and Flemming Friche Rodler. Cuckoo hashing. In European Symposium on Algorithms,
pages 121–133. Springer, 2001.
Benny Pinkas, Thomas Schneider, Gil Segev, and Michael Zohner. Phasing: Private set intersection
using permutation-based hashing. In 24th USENIX Security Symposium (USENIX Security 15), pages
515–530, 2015.
Benny Pinkas, Thomas Schneider, and Michael Zohner. Faster private set intersection based on OT
extension. In Usenix Security, volume 14, pages 797–812, 2014.
Benny Pinkas, Thomas Schneider, and Michael Zohner. Scalable private set intersection based on OT
extension. Cryptology ePrint Archive, Report 2016/930, 2016. http://eprint.iacr.org/2016/930.
Ronald L Rivest, Len Adleman, and Michael L Dertouzos. On data banks and privacy homomorphisms.
Foundations of secure computation, 4(11):169–180, 1978.
PSSZ15.
RAD78.
OOS17.
PSZ14.
PSZ16.
NLV11.
Res12.
RR16.
RS98.
SV14.
ABI Research. Average size of mobile games for ios increased by a whopping 42% between march and
september. London, United Kingdom, 2012.
Peter Rindal and Mike Rosulek. Improved private set intersection against malicious adversaries. Cryp-
tology ePrint Archive, Report 2016/746, 2016. http://eprint.iacr.org/2016/746.
Martin Raab and Angelika Steger. “Balls into Bins” – a simple and tight analysis. In International Work-
shop on Randomization and Approximation Techniques in Computer Science, pages 159–170. Springer,
1998.
Nigel P Smart and Frederik Vercauteren. Fully homomorphic SIMD operations. Designs, codes and
cryptography, 71(1):57–81, 2014.