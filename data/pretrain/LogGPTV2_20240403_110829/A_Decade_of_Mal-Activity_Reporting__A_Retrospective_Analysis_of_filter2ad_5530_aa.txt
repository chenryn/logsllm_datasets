title:A Decade of Mal-Activity Reporting: A Retrospective Analysis of
Internet Malicious Activity Blacklists
author:Benjamin Zi Hao Zhao and
Muhammad Ikram and
Hassan Jameel Asghar and
Mohamed Ali Kâafar and
Abdelberi Chaabane and
Kanchana Thilakarathna
A Decade of Mal-Activity Reporting: A Retrospective Analysis of
Internet Malicious Activity Blacklists
Benjamin Zi Hao Zhao
PI:EMAIL
University of New South Wales
Data61, CSIRO
Mohamed Ali Kaafar
PI:EMAIL
Macquarie University
Muhammad Ikram
PI:EMAIL
Macquarie University
University of Michigan
Abdelberi Chaabane
PI:EMAIL
Hassan Jameel Asghar
PI:EMAIL
Macquarie University
Kanchana Thilakarathna
PI:EMAIL
The University of Sydney
ABSTRACT
This paper focuses on reporting of Internet malicious activity (or
mal-activity in short) by public blacklists with the objective of pro-
viding a systematic characterization of what has been reported
over the years, and more importantly, the evolution of reported
activities. Using an initial seed of 22 blacklists, covering the period
from January 2007 to June 2017, we collect more than 51 million
mal-activity reports involving 662K unique IP addresses worldwide.
Leveraging the Wayback Machine, antivirus (AV) tool reports and
several additional public datasets (e.g., BGP Route Views and Inter-
net registries) we enrich the data with historical meta-information
including geo-locations (countries), autonomous system (AS) num-
bers and types of mal-activity. Furthermore, we use the initially
labelled dataset of ≈ 1.57 million mal-activities (obtained from pub-
lic blacklists) to train a machine learning classifier to classify the
remaining unlabeled dataset of ≈ 44 million mal-activities obtained
through additional sources. We make our unique collected dataset
(and scripts used) publicly available for further research.
The main contributions of the paper are a novel means of report
collection, with a machine learning approach to classify reported
activities, characterization of the dataset and, most importantly,
temporal analysis of mal-activity reporting behavior. Inspired by
P2P behavior modeling, our analysis shows that some classes of mal-
activities (e.g., phishing) and a small number of mal-activity sources
are persistent, suggesting that either blacklist-based prevention
systems are ineffective or have unreasonably long update periods.
Our analysis also indicates that resources can be better utilized by
focusing on heavy mal-activity contributors, which constitute the
bulk of mal-activities.
ACM Reference Format:
Benjamin Zi Hao Zhao, Muhammad Ikram, Hassan Jameel Asghar, Mo-
hamed Ali Kaafar, Abdelberi Chaabane, and Kanchana Thilakarathna. 2019.
A Decade of Mal-Activity Reporting: A Retrospective Analysis of Internet
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
AsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand
© 2019 Association for Computing Machinery.
ACM ISBN 978-1-4503-6752-3/19/07...$15.00
https://doi.org/10.1145/3321705.3329834
Malicious Activity Blacklists. In ACM Asia Conference on Computer and Com-
munications Security (AsiaCCS ’19), July 9–12, 2019, Auckland, New Zealand.
ACM, New York, NY, USA, 13 pages. https://doi.org/10.1145/3321705.3329834
1 INTRODUCTION
Public reports of malicious online activity are commonly used in
the form of blacklists by intrusion detection systems, spam filters
and alike to determine if a host is known for suspicious activity.
However very little is known about the dynamics of the reporting
of malicious activities. Understanding what has been reported and
how the reported activity evolves over time can be of paramount
importance to help assess the efficacy of blacklist-based threat pre-
vention systems. We conduct a longitudinal measurement study of
reporting of malicious online activities (abridged to mal-activities),
over a ten-year period (from January 2007 to June 2017). We define
a mal-activity as any activity reported by one or more public data
sources (in particular, within blacklists). The actor or entity behind
each mal-activity can be reduced to a combination of IP address,
autonomous system (AS) in which the reported IP address resides
or the country in which the IP address is located, which we call
malicious hosts.1 We collect 51.6M mal-activity reports involving
662K unique IP addresses worldwide. We use the Internet Way-
back Machine [13], reports from antivirus (AV) tools, and several
additional datasets to obtain historical meta-information about the
data such as geo-location (countries) and AS numbers. We cate-
gorize the combined mal-activities from different sources into six
classes: Malware, Phishing, Fraudulent Services (FS), Spamming, Ex-
ploits, and Potentially Unwanted Programs (PUPs). The collected
dataset encompasses attributes and historical knowledge of numer-
ous malicious hosts from these six classes, providing a wide range
of possible mal-activities. To foster further research, we release the
dataset and scripts used in this paper to the research community:
https://internetmaliciousactivity.github.io/
The main contributions of our work are as follows:
• We use a machine learning approach to label the entire
dataset (51.6M mal-activities) by training a classifier on
1.57M labelled reports (obtained from public blacklists). More
specifically, we train an ensemble of Random Forest classi-
fiers on basic report information, such as the IP, day, month
1We acknowledge that hosts may be infected or victimized to perform mal-activities
instead of intentional involvement. This paper does not differentiate between them.
Session 3A: Web Attack MeasurementsAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand193year, autonomous system number, country code, and organi-
zation names to correctly label the type of mal-activity that
may have been committed. Over a training/testing split of
40%/60% on the dataset that contained labels from the source,
we are able to achieve an accuracy of 93.5% in re-identifying
the type of mal-activity committed. The trained model is
then leveraged to predict the mal-activity type of reports
that were deficient in this information.
• We determine that mal-activities of the Malware class have IP
addresses that are hosted in diverse set of hosting infrastruc-
tures as well as geo-locations. We observe that on average
the Malware class, at 88%, is 54% more prevalent in hosting
infrastructures, and 29% more prevalent in geo-locations
(countries) than any other other classes of mal-activities. By
comparison, our analysis reveals that the reports of PUP and
Spammer classes of mal-activity are more concentrated with
2,200 and 561 unique ASes, respectively (§ 2.5).
• We observe that the hosting infrastructure of mal-activities
are primarily concentrated in US and China. A normalized
view of a country’s IP space revealed the British Virgin Is-
lands and Anguilla, with large proportions of malicious IPs;
However deeper investigation revealed a country’s IP space
can be dominated by singular ASes, cautioning the use of a
country’s proportion of malicious IP addresses within the IP
space (§ 3.2).
• We analyze the volume of reported mal-activity over time
(§ 4.1). We observe that while malware has historically been,
and continues to be, the dominant class, starting from 2012,
reports of phishing activities have steadily risen, recently be-
coming the second largest class in volume (29% as compared
to 59% reports of malware in the year 2017).
• We study the periods of “activity” and “inactivity” of hosts (at
the IP, AS and country-level) as proxied by their presence or
absence from the reports modeled by an alternating renewal
process to capture the churn rates of the reports. We con-
sider lifetime (resp. deathtime) distributions for active (resp.
inactive) periods. A high average lifetime reflects reporting
of persistent threats, while a low average deathtime would
indicate resiliency to reporting (§ 4.2). Based on this, we ana-
lyze the behavior of the different classes of mal-activity and
note that phishing activities are the most resilient with the
lowest average deathtimes indicating quick recovery from
potential shutdowns (§ 4.2).
• We analyze mal-activity recurrence as the rate at which a
particular mal-activity re-emerges in the reports and observe
that countries such as Colombia, Panama, Bahamas, Norway
and Mexico have the highest rates, owing perhaps to weak
cyber defense infrastructure, or relaxed regulations (§ 4.2).
• We measure the magnitude of reported mal-activities as the
average volume of occurrences during active periods. Our
results show that while 86% of the IP addresses and 27%
of the ASes are being reported to be involved in a unique
mal-activity per week when they are active, a mere 200 IP
addresses are reported in a massive 10K+ malicious reported
activities per week (§ 4.3).
Our results reveal some surprising observations which indicate
that blacklists-based online prevention systems are either powerless
against some persistent threats originating from a small number of
sources, or at best suffer from quite unreasonable updating periods
(§ 4.2). Our findings also suggest that phishing is a highly resilient
activity that very likely will not be defeated by blacklists-based
approaches only (§ 4.2). Finally, we believe that tracking heavy
mal-activity contributors should be a priority for law enforcement
agencies, major network providers and cloud operators as they
clearly constitute the largest chunk of malicious activities threat
vector (§ 4.3). Adopting approaches to detect the emergence of such
heavy mal-activity contributors at an early stage is arguably key to
significantly reducing their impact.
The rest of the paper is organized as follows. In Section 2, we
summarize our dataset along with our methodology to augment and
annotate the initial dataset. Section 3 and 4 presents our analysis
of the behavior of the reporting of malicious activity. We discuss
related work in Section 5 and conclude in Section 6.
2 DATA COLLECTION
We initially identified a sizable set of publicly-available blacklist
sources (22, from static URLs), which are augmented in two iterative
ways: First, we looked up the historical versions of these blacklists
by using the Internet Wayback Machine. The blacklists and their
historical versions (ranging from January 2007 to June 2017) give
us a set of IP addresses and malicious domains that have been
involved in some malicious activity within that time frame along
with the corresponding timestamp and activity tag. We call this list
Blacklist-07-17.
As a second step, we submit all IP addresses present in Blacklist-
07-17 to an AV tool aggregator service, VirusTotal (VT) [30]. We
query VT for all additional reports (again covering the period 2007-
2017) it has on those IP addresses and malicious domains that
we collected from the blacklists. In addition, from VT reports, we
extract the list of malicious files associated with the malicious activ-
ities. Some of these files are software binary executables containing
hard-coded IP addresses, often called referrers.2 We collected all
referrers that correspond to IP addresses in Blacklist-07-17 as well
as all other associated IP addresses and reports found to be carried
out by these referrers.
The total reports generated by VT via additional queries, refer-
rers’ IP extraction and Blacklist-07-17 constitute our set of malicious
activities, which we call VTBlacklist. Figure 1a summarizes our data
collection process. We further augment VTBlacklist with historical
metadata consisting of the relevant Autonomous System (AS) and
corresponding listed country in which the IP address resided at
the time of reporting. The resulting augmented data is called the
FinalBlacklist. The metadata augmentation process is displayed in
Figure 1b.
Next, we describe the above mentioned data collection method-
ology in more detail. A more extensive description and download
of the dataset is described in:
https://internetmaliciousactivity.github.io/
2For instance, Zeus – a Trojan toolkit used for credit card fraud and stealing users’
banking details – has a set of hard coded IP addresses, presumably C&C servers.
Session 3A: Web Attack MeasurementsAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand194(a) Seed Blacklist and VirusTotal Data Collection
(b) Meta-Data
Figure 1: Dataset Collection and Augmentation
2.1 The Seed Dataset: Blacklist-07-17
The collection of this seed dataset was initiated by (manually) identi-
fying a set of publicly available blacklists commonly used as sources
that report a wide range of mal-activities. Data sources that do not
contain timestamps, require a subscription (reporting as a service),
or that have a robot.txt policy, restricting automated access (i.e.,
crawlers), have been discarded. Historical versions of these black-
lists available through the use of the Internet Wayback Machine
were obtained, spanning the period from January 2007 to June 2017,
consisting of over 2 million “timestamped” reports of 297,095 unique
IP addresses. There are data discrepancies between the blacklists,
but they minimally contain the timestamp, IP address, and type of
mal-activity in each report. The exact differences and basic statistics
of Blacklist-07-17 are summarized in Appendix A.1 and Table 5.
Blacklist-07-17 is used here as an initial seed for more extensive
monitoring of malicious activity reports (see next section VTBlack-
list). The extension seeks to address problems of dynamic report
generation (not captured by Internet Wayback Machine), niche
threat biases, and archive periodicity of the seed blacklists. These
limitations are detailed in Section 2.6.
2.2 The Reported Activities Dataset:
VTBlacklist
VirusTotal (VT) is the largest publicly available aggregator of an-
tivirus (AV) products providing scan results from 67 different AV
products (as of January 21, 2019) and has been commonly used
in the academic literature to detect malicious apps, executables,
software and domains [42, 43, 45]. We use the report API [30] to
query VT for domains and IP addresses. This returned the associ-
ated aggregated reports from different AV products. As malicious
domains are likely to change their hosting infrastructure over time
or to be simultaneously associated with several hosting infrastruc-
tures [35, 36], we queried VT to receive all reports associated with
every malicious domain in Blacklist-07-17. The returned reports
include current and past IP addresses belonging to the domain
with timestamps. Through this process, we identified additional
IP addresses. Similarly, an IP address may host several domains
involved in mal-activities [35]. We queried VT with each IP address
in Blacklist-07-17 as input to obtain a list of (timestamped) reports
on malicious domains that are (or were) hosted on the given IP
address.
While it is possible to re-query VT using the obtained list of
IP addresses and domains to extract further reports in a recursive
manner, we did not do so due to rate limits imposed on the API
calls and the sheer size of obtained reports. Since we queried VT
for every reported activity confirmed by AV products about the
list of IP addresses, the generation of additional historical reports
compensates for the sparsity in time coverage of Blacklist-07-17
(see Appendix 2.6). In total, we gathered a list of 662,289 unique IP
addresses corresponding to 51,645,995 reported malicious activities
collectively called VTBlacklist. Now, we describe how we enriched
the reported mal-activity datasets with historical metadata.
2.3 The Augmented Dataset: FinalBlacklist
We enrich our data to extend the list of attributes in the dataset
by linking additional attributes (metadata) including AS numbers
(ASNs) and geolocation information. The key is to extract relevant
historical metadata, consistent with the timestamp of the report.
AS Mapping. To map IP addresses to the corresponding ASes with
historical accuracy, we used the BGP Route Views dataset [23].
This dataset consists of daily snapshots of the BGP routing table