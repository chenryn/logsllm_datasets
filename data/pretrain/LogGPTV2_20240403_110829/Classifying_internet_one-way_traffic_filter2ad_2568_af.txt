13
Figure 6: Coinciding outage observed on the
23rd of June 2011 19:40 UTC on most university
services resulting in failed accesses from 287,583
unique clients.
and lasting more than 10 minutes as shown in Figure 6.
This was a general problem in the reachability of the
department network from the outside. To learn more
about this outage, we analyzed three key services of
the entire university: the main web, webmail, and soft-
ware distribution services of ETH Zurich. Surprisingly,
we found that at the same point in time the services
were not accessible indicating a campus-wide temporary
reachability problem. During the identiﬁed 10-minute
interval the outage impact metric revealed that 287,583
unique clients failed to access target services! Our in-
vestigation showed that the outage occurred during a
planned router software upgrade. Although, tempo-
ral disruptions due to the upgrade were expected, the
scale of the disruption revealed was suprisingly larger
than expected. Present server availability monitoring
techniques based on active probing and server logs miss
this important information. In addition, we visually in-
spected the time series of the volume of one-way ﬂows
for the top departmental services and found that the
outage resulted in a sharp increase in requests target-
ing mail services due to the automated retry behavior
of mail clients. On the other hand, for web services
the volume of one-way ﬂows during the outage did not
substantially diﬀer from the volume of two-way ﬂows
during regular operation, indicating a more network-
friendly retry behavior.
Our inspection of the reachability metric for the dis-
covered services revealed two actionable cases. First, we
found an NTP server that was consistently not reach-
able on average by 12.9% of its clients. The outage im-
pact metric showed that in this case too a suprisingly
large number of clients failed to receive a reply: during
the studied week in total 2.2 million unique clients were
involved in one-way ﬂows to the NTP server. Investi-
gating this further unveiled that standard NTP “hello
world” conﬁguration examples use the swisstime.ee.
ethz.ch server in our department, making it likely one
of the most popular NTP servers in the Internet. In ad-
dition, swisstime.ee.ethz.ch is often preconﬁgured
 0 0.2 0.4 0.6 0.8 1 20 21 22 23 24 25 26 27Fraction of Failed ClientsDay of June 2011993/tcp (tardis.ee)25/tcp (tranquility.ee)80/tcp (yosemite.ee)25/tcp (smtp.ee)in embedded devices. The failure rate, i.e., fraction of
one-way ﬂows, varies for diﬀerent countries of origin. In
the top client countries we observe Belgium with fail-
ure rate 65.7%, India with 20.2%, and Germany with
16.8%. Our investigation found two main causes of low
reachability: 1) an IP ﬁlter was conﬁgured to prevent
access from a /8 address block, which was frequently
the source of attacks; and 2) certain devices appear to
compute invalid CRC checksums resulting in dropped
requests. From these ﬁndings we learned both that the
traﬃc ﬂow volume to the studied network was heav-
ily aﬀected from the popular NTP server and that a
misconﬁgured application computes invalid CRC check-
sums.
Second, we noticed that the SMB service oﬀered on
445/tcp was targeted by far more one-way ﬂows (112%
more) than two-way ﬂows. An in-depth analysis re-
vealed that almost all one-way ﬂows were sourced by
a likely misconﬁgured client that persistently tried to
connect to this service. All remaining services achieved
a reachability of 97.1% or more with most of them rank-
ing at the 99.9% ﬁgure.
8. RELATED WORK
Studying IBR traﬃc has been very useful for under-
standing Internet threats.
In 2001, Moore et al. [23]
were the ﬁrst to use network telescopes to monitor back-
ground radiation and answer questions such as “how
prevalent are denial-of-service attacks in the Internet
today?”. Yegneswaran et al. [31] employed scan logs
collected by Dshield [9] during four months in 2001 and
2002 to analyze quantitative characteristics of intrusion
activity in the global Internet. They made a number
of interesting observations including that a very small
collection of correlated sources are responsible for a sig-
niﬁcant fraction of intrusion attempts. In 2004, Pang et
al. [24] used traces, lasting 80-hours to one week, from
three sites to conduct a detailed characterization of traf-
ﬁc towards four large unused address blocks. Among
other observations, they highlighted the dynamism of
background radiation, which unlike normal traﬃc, can
exhibit signiﬁcant changes on a nearly daily basis. More
recently, Wustrow et al. [30] examined background radi-
ation between 2006 and 2010 to four /8 unused blocks.
They observed among other ﬁndings that background
radiation continues to be very dynamic and identiﬁed
interesting artifacts that lead to address space pollu-
tion.
A number of more recent studies have focused on one-
way traﬃc. In 2012, Brownlee [6] described a tool called
iatmon for classifying one-way traﬃc based on packet
interarrival times and remote scanner patterns of the
schema of Treurinet [28]. In addition, the author de-
scribed observations about the diﬀerent types of scan-
ning in six months of data from the UCSD Network
Telescope [7]. Our work is complementary to the iat-
mon tool, as we focus on ﬂow instead of packet-based
classiﬁcation. Besides, the work by Lee and Brown-
lee [20] used three one-day packet traces captured in
14
2000, 2003, and 2006 in the University of Auckland to
analyze the lifetime and size distribution of one and
two-way ﬂows.
In our work, we provide new insights
into one-way ﬂows based on a substantially larger trace
and introduce novel methods to classify their causes.
Allman et al. [2] used TCP connection logs from the
Lawrence Berkeley National Laboratory collected be-
tween 1994 and 2006 to characterize how scanning changed
over time.
In addition, they correlated observed pat-
terns to well-known malware activity. Our study follows
on until 2011 and focus primarily on how to classify one-
way traﬃc. Jin et al. [14] used ﬂow data towards grey
IP space of a campus network and developed a heuristic
to identify external scanners. We follow along this di-
rection and highlight the need to classify one-way traﬃc
and identify a number of diﬀerent causes in addition to
scanning.
Finally, a number of studies have focused on similar
but less related problems. Guha et al. [11] characterized
the fraction of useful ﬂows generated by mobile hosts
in an enterprise network and found that 34% of the
ﬂows fail mainly due to hosts mobility. Schatzmann et
al. [26] described a ﬂow-based system to identify reach-
ability problems in remote networks caused by events
like preﬁx hijacking. Barford et al. [4] characterized the
network location of sources of background radiation and
derived a model for generating source IP addresses in
simulation and emulation environments with realistic
distributional properties.
9. CONCLUSIONS
One-way traﬃc towards live networks is an exotic
piece of Internet traﬃc that accounts for a very large
fraction of the total number of ﬂows. To shed light into
this type of traﬃc, we design and validate a classiﬁ-
cation scheme for one-way traﬃc. Classifying one-way
traﬃc based solely on ﬂow-level data is very challenging
as one-way ﬂows contain very few packets often with-
out any payload. To address these challenges, we design
and carefully optimize 18 classiﬁcation rules that lever-
age primarily communication patterns of involved end
hosts.
We use our classiﬁer to analyze the composition of a
massive dataset of traﬃc ﬂow records from a regional
backbone network and make the following key observa-
tions:
1) One-way traﬃc makes a very large fraction of the
total number of ﬂows, although it only accounts for only
3.4% of the number of packets
2) Scanning accounts for 83.5% and 62.6% of the one-
way ﬂows and packets; peer-to-peer applications of 6.7%
of the ﬂows and 13.0% of the packets; and unreachable
services for 4.8% of the ﬂows and 10.1% of the packets.
3) The number of two-way ﬂows has grown signiﬁ-
cantly by 343% between 2004 and 2011.
In contrast,
the absolute volume of one-way ﬂows in 2011 is almost
equal to 2004.
4) The share of one-way ﬂows has declined from 67%
in 2004 to 34% in 2011.
Finally, we focus on the particularly interesting class
of one-way traﬃc caused by unreachable services and
show how this class can be very useful for monitoring
the reachability of network services and in particular
for assessing the impact of outages.
In the past IBR traﬃc has been primarily studied
with the help of a small number of large network tele-
scopes. Our techniques are useful for network operators
of edge networks for monitoring their local IBR traf-
ﬁc and for detecting service reachability problems. For
this reason, with this paper we will make the code of
our classiﬁcation scheme publicly available. In addition,
to shed further light into the composition of one-way
traﬃc and to facilitate correlating data from multiple
IBR traﬃc monitors, we will release non-sensitive de-
tails about the evolution of one-way and two-way traﬃc
between 2004 and 2011 based on the studied datasets.
In particular, for each 10-minute time interval, we will
make available statistics about the synthesis of one-way
traﬃc, the popularity of diﬀerent signs, the targeted
services, and the geographical distribution of sources.
Acknowledgements
We are grateful to SWITCH for providing us precious
data for studying one-way traﬃc. In addition, we are
thankful to Dominik Schatzmann for helping with double-
counting elimination and to Simon Leinen for providing
us valuable feedback on service reachability monitoring.
Lastly, we wish to acknowledge anonymous reviewers for
their helpful comments and suggestions.
10. REFERENCES
[1] Akamai Technologies. The state of the internet
report (3rd quarter, 2009). Technical report, 2009.
[2] M. Allman, V. Paxson, and J. Terrell. A brief
history of scanning. In Proceedings of the 7th
ACM SIGCOMM conference on Internet
measurement, page 82. ACM, 2007.
[3] M. Bailey, E. Cooke, F. Jahanian, D. Watson, and
J. Nazario. The blaster worm: Then and now.
IEEE Security and Privacy, 3:26–31, July 2005.
[4] P. Barford, R. Nowak, R. Willett, and
V. Yegneswaran. Toward a model for source
addresses of internet background radiation. In
Proc. of the Passive and Active Measurement
Conference. Citeseer, 2006.
[5] D. Brauckhoﬀ, X. Dimitropoulos, A. Wagner, and
K. Salamatian. Anomaly extraction in backbone
networks using association rules. In Proceedings of
the 9th ACM SIGCOMM conference on Internet
measurement conference, IMC ’09, pages 28–34,
New York, NY, USA, 2009. ACM.
[6] N. Brownlee. One-way traﬃc monitoring with
iatmon. In Passive and Active Measurement
Conference, 2012.
[7] CAIDA. UCSD Network Telescope. http:
//www.caida.org/data/realtime/telescope/.
[8] T. Cymru. The Bogon Reference. http:
//www.team-cymru.org/Services/Bogons/,
2012.
15
[9] Cooperative Network Security Community -
Internet Security. www.dshield.org.
[10] F. Gont. ICMP attacks against TCP. RFC 5927,
July 2010.
[11] S. Guha, J. Chandrashekar, N. Taft, and
K. Papagiannaki. How healthy are today’s
enterprise networks? In Proceedings of the 8th
ACM SIGCOMM conference on Internet
measurement, pages 145–150. ACM, 2008.
[12] IANA - Internet Assigned Numbers Authority.
PORT NUMBERS. http:
//www.iana.org/assignments/port-numbers,
2011.
[13] C. Inacio and B. Trammell. Yaf: yet another
ﬂowmeter. In Proceedings of the 24th
international conference on Large installation
system administration, pages 1–16. USENIX
Association, 2010.
[14] Y. Jin, Z. Zhang, K. Xu, F. Cao, and S. Sahu.
Identifying and tracking suspicious activities
through IP gray space analysis. In Proceedings of
the 3rd annual ACM workshop on Mining network
data, page 12. ACM, 2007.
[15] W. John and S. Tafvelin. Heuristics to classify
internet backbone traﬃc based on connection
patterns. International Conference on Information
Networking (ICOIN), pages 1–5, 2008.
[16] J. Jung, V. Paxson, A. Berger, and
H. Balakrishnan. Fast portscan detection using
sequential hypothesis testing. In Proceedings of
the IEEE Symposium on Security and Privacy,
pages 211–225, 2004.
[17] T. Karagiannis, A. Broido, and M. Faloutsos.
Transport layer identiﬁcation of p2p traﬃc.
Proceedings of the 4th ACM SIGCOMM
conference on Internet measurement, pages
121–134, 2004.
[18] T. Karagiannis, K. Papagiannaki, and
M. Faloutsos. Blinc: multilevel traﬃc
classiﬁcation in the dark. In ACM SIGCOMM
Computer Communication Review, volume 35,
pages 229–240. ACM, 2005.
[19] H. Kim, K. Claﬀy, M. Fomenkov, D. Barman,
M. Faloutsos, and K. Lee. Internet traﬃc
classiﬁcation demystiﬁed: myths, caveats, and the
best practices. In Proceedings of the 2008 ACM
CoNEXT conference, page 11. ACM, 2008.
[20] D. Lee and N. Brownlee. Passive measurement of
one-way and two-way ﬂow lifetimes. SIGCOMM
Comput. Commun. Rev., 37(3):17–28, 2007.
[21] D. Moore, V. Paxson, S. Savage, C. Shannon,
S. Staniford, and N. Weaver. Inside the slammer
worm. IEEE Security and Privacy, 1:33–39, July
2003.
[22] D. Moore, C. Shannon, G. Voelker, and S. Savage.
Network telescopes: Technical report. Technical
report, 2004.
[23] D. Moore, G. M. Voelker, and S. Savage. Inferring
internet denial-of-service activity. In SSYM’01:
export using IPFIX. RFC 5103, January 2008.
[28] J. Treurniet. A network activity classiﬁcation
schema and its application to scan detection.
IEEE/ACM Trans. Netw., 19(5):1396–1404, Oct.
2011.
[29] Wikipedia. Netﬂow.
http://en.wikipedia.org/wiki/Netflow.
[30] E. Wustrow, M. Karir, M. Bailey, F. Jahanian,
and G. Huston. Internet background radiation
revisited. In Proceedings of the 10th annual
conference on Internet measurement, IMC ’10,
pages 62–74, New York, NY, USA, 2010. ACM.
[31] V. Yegneswaran, P. Barford, and J. Ullrich.
Internet intrusions: global characteristics and
prevalence. SIGMETRICS Perform. Eval. Rev.,
31(1):138–147, 2003.
Proceedings of the 10th conference on USENIX
Security Symposium, Berkeley, USA, 2001.
[24] R. Pang, V. Yegneswaran, P. Barford, V. Paxson,
and L. Peterson. Characteristics of Internet
background radiation. In Proceedings of the 4th
ACM SIGCOMM conference on Internet
measurement, pages 27–40. ACM New York, NY,
USA, 2004.
[25] M. Pernyi, T. D. Dang, A. Geﬀerth, and S. Molnr.
Identiﬁcation and analysis of peer-to-peer traﬃc.
JOURNAL OF COMMUNICATIONS, 1(7), 2006.
[26] D. Schatzmann, S. Leinen, J. Kogel, and
W. Muhlbauer. Fact: Flow-based approach for
connectivity tracking. In Passive and Active
Measurement conference, Mar. 2011.
[27] B. Trammell and E. Boschi. Bidirectional ﬂow
16