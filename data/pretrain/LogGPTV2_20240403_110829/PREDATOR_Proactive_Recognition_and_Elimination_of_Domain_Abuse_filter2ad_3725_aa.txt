title:PREDATOR: Proactive Recognition and Elimination of Domain Abuse
at Time-Of-Registration
author:Shuang Hao and
Alex Kantchelian and
Brad Miller and
Vern Paxson and
Nick Feamster
PREDATOR: Proactive Recognition and Elimination of
Domain Abuse at Time-Of-Registration
Shuang Hao∗ Alex Kantchelian† Brad Miller§ Vern Paxson†(cid:5) Nick Feamster‡
†
∗
§
Google, Inc.
University of California, Santa Barbara
University of California, Berkeley
(cid:5)
International Computer Science Institute
‡
Princeton University
PI:EMAIL {akant,vern}@cs.berkeley.edu
PI:EMAIL PI:EMAIL
ABSTRACT
Miscreants register thousands of new domains every day to launch
Internet-scale attacks, such as spam, phishing, and drive-by down-
loads. Quickly and accurately determining a domain’s reputation
(association with malicious activity) provides a powerful tool for mit-
igating threats and protecting users. Yet, existing domain reputation
systems work by observing domain use (e.g., lookup patterns, content
hosted)—often too late to prevent miscreants from reaping beneﬁts of
the attacks that they launch.
As a complement to these systems, we explore the extent to which
features evident at domain registration indicate a domain’s subsequent
use for malicious activity. We develop PREDATOR, an approach that
uses only time-of-registration features to establish domain reputation.
We base its design on the intuition that miscreants need to obtain
many domains to ensure proﬁtability and attack agility, leading to
abnormal registration behaviors (e.g., burst registrations, textually
similar names). We evaluate PREDATOR using registration logs of
second-level .com and .net domains over ﬁve months. PREDATOR
achieves a 70% detection rate with a false positive rate of 0.35%, thus
making it an effective—and early—ﬁrst line of defense against the
misuse of DNS domains. It predicts malicious domains when they
are registered, which is typically days or weeks earlier than existing
DNS blacklists.
CCS Concepts
•Security and privacy → Intrusion/anomaly detection and mal-
ware mitigation; •Networks → Network domains;
Keywords
Domain Registration; Reputation System; Early Detection.
1.
INTRODUCTION
The Domain Name System (DNS), the Internet’s lookup service for
mapping names to IP addresses, provides a critical service for Internet
applications. Attackers, however, abuse the DNS service to direct
victims to Web sites that host scams, malware, and other malicious
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full citation
on the ﬁrst page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from permissions@acm.org.
CCS’16, October 24–28, 2016, Vienna, Austria
c(cid:13) 2016 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ISBN 978-1-4503-4139-4/16/10. . . $15.00
DOI: http://dx.doi.org/10.1145/2976749.2978317
content [18, 53]. To mitigate these threats, operators routinely build
reputation systems for domain names to indicate whether they are
associated with malicious activity. A common mode for developing
reputation for DNS domain names is to develop a blacklist that curates
“bad domains”. A network operator who wishes to defend against an
attack may use a domain blacklist to help determine whether certain
trafﬁc or infrastructure is associated with malicious activity.
Unfortunately, curating a DNS blacklist is difﬁcult because of
the high rate of domain registrations and the variety of attacks. For
example, every day around 80,000 new domains are registered in
the .com zone, with a peak rate of over 1,800 registrations in a sin-
gle ﬁve-minute interval. Establishing domain reputation is thus a
continual, ongoing process that must be automated, based on the
features of the DNS domains. Existing DNS reputation systems
primarily use characteristics of DNS lookups to distinguish legitimate
domains from malicious ones [3, 4, 5]. Other systems have derived
domain reputation by crawling Web pages to discover malicious
content [35, 55]. Unfortunately, these existing systems have a number
of limitations. (1) The particular resources and vantage points they
employ (e.g., URL crawlers, spam traps) provide limited visibility
into various attacks across time, and thus may miss malicious activi-
ties of certain domains. (2) Existing systems derive reputation for
domain names primarily after malicious activity is already underway,
delaying detection. By the time existing reputation systems add
a domain to a blacklist, the domain may have already been used
in widespread abuse (e.g., spam or phishing campaigns, drive-by
downloads). (3) Because existing reputation systems cannot prevent
malicious domain registrations, attackers continue to register new
malicious domains even as their old domains become blacklisted, to
sustain scam campaigns.
The ideal time to establish the reputation of DNS domains is thus
at registration time, before the miscreants can proﬁtably use them. To-
wards this goal, we design PREDATOR (Proactive Recognition and
Elimination of Domain Abuse at Time-Of-Registration), a proactive
reputation system that can accurately and automatically identify mali-
cious domains at time-of-registration, rather than later at time-of-use.
Such a proactive reputation can enable early detection of poten-
tially malicious DNS domains, thus beneﬁting many stakeholders:
(1) Network operators can take appropriate actions to protect their net-
works. For example, email servers can preemptively greylist [34] (i.e.,
temporarily reject) emails that contain suspicious newly-registered
domains and request re-delivery after a period (by which time the
network operators can collect more evidence to make ﬁnal decisions,
such as examining the content that the domain hosts). (2) Registries or
registrars can require more strict documentation or veriﬁcation (e.g.,
validation of payment instruments) before they approve registrations
of domains with low predicted reputation. (3) Law enforcement and
security professionals can prioritize investigation efforts and take
down malicious sites early [51]. For example, in 2010, LegitScript1
and registrar eNom have announced an agreement to devote efforts to
taking down rogue Internet pharmacy domains [8].
PREDATOR is based on the intuition that, to make domain pur-
chase as economical as possible miscreants must register large quanti-
ties of domains—typically in bulk—to ensure that they can remain
agile as individual domains are blacklisted or taken down [33, 52].
The timing and targets of attacks may vary, but the domain registra-
tions nonetheless exhibit telltale signatures, including the types of
domains that they register and the temporal registration patterns they
exhibit, that both distinguish them from benign registration behav-
ior and are relatively non-malleable, due to the fact that attackers
require access to large numbers of inexpensive domains to operate
successfully.
Although a time-of-registration DNS domain reputation system
offers many potential beneﬁts, developing such a reputation system is
difﬁcult. Unlike other DNS reputation systems that can observe the
ways a domain is used in practice (e.g., by observing lookup patterns
or content that the domain hosts), a reputation system that operates
at registration time has much more limited information available
for developing reputation. We identify features based on (1) the
delegated registrars and the hosting infrastructure, (2) structural
characteristics of the name itself, (3) previous registration history, and
(4) correlations with registration bursts. Another challenge is the lack
of full ground truth to evaluate performance; thus, our best hope is to
compare the reputations that PREDATOR derives to those of existing
blacklists. Of course, the reputation information in existing blacklists
is not only late, it is also often incomplete. We also assess how
PREDATOR can detect non-blacklisted but spam-related domains by
sampling and manually checking those domains.
Our results show that PREDATOR can accurately determine the
reputation of new domains with a low false positive rate (0.35%)
and a good detection rate (70%). Although the performance is not
perfect, the beneﬁts of establishing domain reputation at registration
time are clear: (1) PREDATOR can achieve early detection, often
days or weeks before existing blacklists, which generally cannot
detect domain abuse until an attack is already underway. The key
advantage is to respond promptly for defense and limit the window
during which miscreants might proﬁtably use a domain. (2) As a ﬁrst
line of defense, PREDATOR can reduce the suspect domains to a pool
of 3% of all new domains, while capturing 70% of the domains that
will subsequently appear on well-known blacklists. Thus, our system
enables prioritizing domains for subsequent, detailed analysis, and to
ﬁnd more malicious pages given a ﬁxed amount of resources (e.g.,
via URL crawlers or human-involved identiﬁcation). (3) We show
that PREDATOR can complement existing blacklists and capture
additional domains hosting spam-related content that other blacklists
miss.
We make the following contributions:
• We develop an approach to establish domain reputation based
on the features evident at the time of domain registration, which
provides early detection of potentially malicious domains.
• We identify and encode 22 features that help distinguish domain
registration behavior characteristic of abuse from legitimate
registration behavior, 16 of which have not been identiﬁed or
analyzed in previous work.
• We incorporate these features into a state-of-the-art super-
vised learning algorithm and implement a prototype version of
1LegitScript is a service to verify and regulate online pharmacies,
recognized by the National Association of Boards of Pharmacy.
our proactive time-of-registration domain reputation system,
PREDATOR.
• We perform a comprehensive empirical evaluation of PREDA-
TOR using ﬁve months of logs of second-level .com and .net
domain registrations, demonstrating its effectiveness for com-
plementing existing blacklists.
2. BACKGROUND
The registration process of second-level domains involves three
major participants: registrants (persons or companies that seek to
acquire domain names), registrars (e.g., GoDaddy), and registries
(e.g., Verisign). A registrant usually applies online to a registrar,
which is an organization accredited by ICANN to contract with
registries to sell domains. The registrar represents the registrant in
submitting registration requests to the registry, which manages the
relevant top-level domain (TLD) [25]. The registry allocates the
domain name, adds the registration data to a central database, and
publishes the DNS records in the top-level domain nameservers. The
updates operate in close to real time [22, 23] and have a short interval
between registration requests and domain activation in the zone. For
every domain registration, the registrar charges the registrant and
pays a fee to the associated registry. The annual cost for registrants to
register a .com domain ranges from about $8.50 to $25 [45, 46]. The
registry in turn pays a fee to ICANN for new domain names in the
TLD zone.
The registration time periods range from one to ten years. Upon
domain expiration, if registrants choose to renew, the domains remain
in the zone. Otherwise, the domain expires, is removed from the
zone, and becomes available for registration again. We categorize
domains as brand-new (registered for the ﬁrst time) or re-registration
(the domain has previously appeared in the zone, and now a regis-
trant registers it again after its expiration). We further characterize
re-registration domains as drop-catch (re-registered immediately after
its expiry) or retread (some time has passed since its previous re-
moval from the zone). We can obtain information regarding expiring
domains via registries or third-party sites [42, 59].
3. CASE STUDY: SPAMMER DOMAINS
As an illustration of how spammers exhibit distinctive registration
behavior, consider the following instance at registrar Moniker.
Figure 1 shows the counts of .com domain registrations from registrar
Moniker on one day of March 2012. The x-axis gives the hour of
the day (Eastern time). The y-axis shows the count of .com domain
registrations for every ﬁve-minute epoch. The black bars indicate the
counts of domains subsequently appearing on blacklists (including
Spamhaus [49], URIBL [56], and a spam trap that we operate), while
the white bars are the numbers of domains that are not blacklisted
later. These instances provide insight into the characteristics of
spammer domain registrations, such as: How many domains are
registered together?; What do the names look like?; and How long
do the existing blacklists take to block those domains? We brieﬂy
explore these questions using a case study.
(1) Domain registrations occur in bursts: Table 1 shows the detailed
statistics of the ﬁve registration spikes in Figure 1. A ﬁve-minute
epoch may have tens or even hundreds of domains registered for later
spam activities. Presumably miscreants exploit the cheaper prices
and management ease of bulk registration provided by registrars. For
example, when registering over 100 .com domains, Moniker offers
a 5% discount (as well as a 25% discount on privacy protection) [41],
and GoDaddy provides a 36% discount (lowering the annual price
from $12.99 to $8.29) [17]. Because miscreants likely often operate
Domains (highlight common strings)
asklenderhome.com
askhomelendersnow.com
asklendershome.com
askhomeslender.com
askhomelender.com
askhomelenders.com
asklendertoday.com
ﬁnancilsart.com
ﬁnancilss.com
ﬁnancilsssky.com
ﬁnancilsspro.com
ﬁnancilspro.com
ﬁnancilssart.com
ﬁnancilssky.com
strokecarebeat.com
strokecaregreen.com
strokesoft.com
Blacklist delay
92 days
51 days
32 days
24 days
12 days
6 days
5 days
122 days
71 days
19 days
18 days
17 days
9 days
7 days
65 days
14 days
11 days
Table 2: Example of brand-new spammer domains registered
in one single epoch (1:10–1:15PM EDT, per the bottom row
of Table 1) from Moniker. The domain names with common
strings are grouped and ordered by the blacklist delay.
to mitigate malicious URLs or domains that host spam-advertised
sites.
Figure 2 shows how PREDATOR operates. We derive the domain
registration information from zone updates. The Domain Name
Zone Alert (DNZA) ﬁles contain changes to the zone, including
(1) the addition of new domains, (2) the removal of existing domains,
(3) changes to associated nameservers, and (4) changes to IP addresses
of the nameservers. The DNZA ﬁles provide a real-time feed of
domain registrations. The zone update data is recorded in ﬁve-minute
intervals, which we deﬁne as epochs. The domains registered in
the same epoch represent concurrent registrations and often share
common properties. PREDATOR operates in two modes: an off-line
training mode and an on-line operation mode, as we describe below.
Training mode. Based on the domain registration information, we
extract three types of statistical features:
• Domain proﬁle features (Section 5.1) focus on the current
registration. The features can be derived from the public
WHOIS information and the domain names.
• Registration history features (Section 5.2) are based on previous
registration history. The features can be acquired from third-
party services such as DomainTools [10], or they are available
at registrars and registries.
• Batch correlation features (Section 5.3) examine the domains
registered from the same registrar and within the same epoch.
The information is available at registrars or registries.
We use prior knowledge to label a set of known spammer and non-
spammer domains. With the labeled domains, the learning module
takes the extracted features and uses a supervised learning technique
to build a classiﬁer. Section 6 describes the design of PREDATOR’s
classiﬁcation approach in detail.
Operation mode. Upon a new domain registration, we extract
the corresponding features and incorporate them into the classiﬁer.
The classiﬁer assigns a reputation score by aggregating the weights
learned in the training mode. If a domain is registered to launch
malicious activities (e.g., spam campaigns), we expect to assign a low
reputation score. On the other hand, we want to assign a high score
if a domain is for legitimate Internet services. If the score is lower
than a threshold, we generate a detection report to ﬂag the domain
as malicious. Network operators or users can take advantage of the
Figure 1: Domains registered by Moniker every 5 minutes on