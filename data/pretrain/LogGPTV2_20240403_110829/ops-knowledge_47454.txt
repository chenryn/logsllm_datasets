User: 请回答以下安全问题如何检测GET请求中的XSS？如何检测HTTP/1.1 GET请求中的XSS？请求可能是恶意的，我想知道如何检测服务器的GET请求是否试图XSS我的网站？

Assistant: 您不仅应该通过扫描HTTP请求来保护自己免受XSS攻击。这样的扫描永远不会完成，总会有一些聪明的把戏漏网之鱼。你的第一道防线必须始终是正确地清除不受信任的数据，以免一开始就产生任何XSS漏洞。
关于如何做到这一点，请参阅OWASP关于作弊的主题。如果可能的话，我建议您严格设置内容安全策略标头，因为这将为您在现代浏览器上提供坚实的防御。它甚至有一个报告指令，指示浏览器向您通报攻击企图。
也就是说，为了进行深度防御，还可以扫描HTTP请求以过滤掉您可以检测到的任何XSS攻击。大多数web应用防火墙，如Nginx的Naxsi，都会这样做。我建议在这里使用现有的WAF，不要试图推出自己的WAF——没有简单的正则表达式可以捕获所有XSS攻击。
那幺Naxsi是怎么做到的呢？据他们自己说：
默认情况下，该模块读取一小部分简单（可读）规则，其中包含网站漏洞中99%的已知模式。例如，&lt；，|或者drop不应该是URI的一部分。
非常简单的是，这些模式可能与合法查询匹配，Naxsi的管理员职责是添加特定规则，将这些合法行为列入白名单。
顺便说一下，您不仅需要担心GET请求，还需要担心POST或任何其他HTTP方法。XSS攻击向量可以在任何地方——在URL、cookies、POST数据、用户代理标头等中。