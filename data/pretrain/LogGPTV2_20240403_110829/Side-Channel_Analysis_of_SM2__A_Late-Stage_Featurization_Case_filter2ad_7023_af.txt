Research Fund of Tampere University of Technology.
This article is based in part upon work from COST Action IC1403
CRYPTACUS, supported by COST (European Cooperation in Sci-
ence and Technology).
Group. http://www.secg.org/sec1-v2.pdf
IEEE P1363/D13.
Institute of Electrical and Electronics Engineers.
REFERENCES
[1] 1999. Standard Specifications for Public Key Cryptography.
[2] 2009. Elliptic Curve Cryptography. SEC 1. Standards for Efficient Cryptography
[3] 2013. Digital Signature Standard (DSS). FIPS PUB 186-4. National Institute of
[4] Onur Acıiçmez, Shay Gueron, and Jean-Pierre Seifert. 2007. New Branch
Prediction Vulnerabilities in OpenSSL and Necessary Software Countermea-
sures. In Cryptography and Coding, 11th IMA International Conference, Cirences-
ter, UK, December 18-20, 2007, Proceedings (Lecture Notes in Computer Science),
Standards and Technology. https://doi.org/10.6028/NIST.FIPS.186-4
Figure 8: Partial raw cache-timing traces during SM2DSA.
Top: Ladder scalar multiplication composed of regular dou-
ble and add operations. Bottom: FLT modular inversion via
exponentiation composed of regular squaring windows fol-
lowed by a single multiply.
Figure 9: The filtered EM trace after applying the ladder
countermeasure. As expected, it clearly reveals the sequence
of ECC double and add operations during SM2PKE decryp-
tion, yet this sequence is regular and not useful for SCA-
enabled attackers.
Figure 10: Top: T-test results between sets S1 and S2 versus
sample index; for fixed vs random k the test marginally fails
with leaks at the few points where the threshold is around 6.
Bottom: T-test results between sets S1 and S3 versus sample
index; for fixed vs random C the test passes since no peaks
exceed the 4.5 threshold.
(S1, S2) we still observe a marginal number of peaks with magnitude
roughly 6. In theory, it is still possible to exploit this; e.g. a key
value that leading to special intermediate points on the curve such
as zero-value [6] or same value points [59]. However, the leakage is
so minimal, our analysis suggests mounting such attacks would be
extremely difficult and feature significant data complexity. More-
over, the scalar randomization countermeasure [31] to thwart this
leak introduces performance overhead, in this case unacceptable to
OpenSSL when weighed vs risk.
 0 50 100 150 200 250 76200 76300 76400 76500 76600 76700DADADADALatency (cycles)Time (samples)double probeadd probe 0 50 100 150 200 250 103700 103750 103800 103850 103900 103950 104000Latency (cycles)Time (samples)multiply probesquare probe 10000 15000 20000 25000 30000 35000 40000 45000AAAADDDTime (samples) 0 2 4 6 8 0 10000 20000 30000 40000 50000 0 2 4 6 8 10 12 14 0 10000 20000 30000 40000 50000157ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
Nicola Tuveri, Sohaib ul Hassan, Cesar Pereida García, and Billy Bob Brumley
Steven D. Galbraith (Ed.), Vol. 4887. Springer, 185–203. https://doi.org/10.1007/
978-3-540-77272-9_12
[5] Onur Acıiçmez, Werner Schindler, and Çetin Kaya Koç. 2005. Improving Brumley
and Boneh timing attack on unprotected SSL implementations. In Proceedings of
the 12th ACM Conference on Computer and Communications Security, CCS 2005,
Alexandria, VA, USA, November 7-11, 2005, Vijay Atluri, Catherine A. Meadows,
and Ari Juels (Eds.). ACM, 139–146. https://doi.org/10.1145/1102120.1102140
[6] Toru Akishita and Tsuyoshi Takagi. 2005. Zero-Value Register Attack on Elliptic
Curve Cryptosystem. IEICE Transactions 88-A, 1 (2005), 132–139. https://doi.
org/10.1093/ietfec/e88-a.1.132
[7] Alejandro Cabrera Aldaya, Alejandro J. Cabrera Sarmiento, and Santiago Sánchez-
Solano. 2017. SPA vulnerabilities of the binary extended Euclidean algorithm.
J. Cryptographic Engineering 7, 4 (2017), 273–285.
https://doi.org/10.1007/
s13389-016-0135-4
[8] Alejandro Cabrera Aldaya, Cesar Pereida García, Luis Manuel Alvarez Tapia, and
Billy Bob Brumley. 2018. Cache-Timing Attacks on RSA Key Generation. IACR
Cryptology ePrint Archive 2018, 367 (2018). https://eprint.iacr.org/2018/367
[9] Thomas Allan, Billy Bob Brumley, Katrina E. Falkner, Joop van de Pol, and
Yuval Yarom. 2016. Amplifying side channels through performance degrada-
tion. In Proceedings of the 32nd Annual Conference on Computer Security Ap-
plications, ACSAC 2016, Los Angeles, CA, USA, December 5-9, 2016, Stephen
Schwab, William K. Robertson, and Davide Balzarotti (Eds.). ACM, 422–435.
https://doi.org/10.1145/2991079.2991084
[10] Aurélie Bauer, Éliane Jaulmes, Emmanuel Prouff, Jean-René Reinhard, and Justine
Wild. 2015. Horizontal collision correlation attack on elliptic curves – Extended
Version. Cryptography and Communications 7, 1 (2015), 91–119. https://doi.org/
10.1007/s12095-014-0111-8
[11] Naomi Benger, Joop van de Pol, Nigel P. Smart, and Yuval Yarom. 2014. “Ooh
Aah... Just a Little Bit” : A Small Amount of Side Channel Can Go a Long Way. In
Cryptographic Hardware and Embedded Systems - CHES 2014 - 16th International
Workshop, Busan, South Korea, September 23-26, 2014. Proceedings (Lecture Notes in
Computer Science), Lejla Batina and Matthew Robshaw (Eds.), Vol. 8731. Springer,
75–92. https://doi.org/10.1007/978-3-662-44709-3_5
[12] Daniel J. Bernstein. 2005. Cache-timing attacks on AES. http://cr.yp.to/papers.
html#cachetiming
[13] Daniel J. Bernstein. 2006. Curve25519: New Diffie-Hellman Speed Records. In
Public Key Cryptography - PKC 2006, 9th International Conference on Theory
and Practice of Public-Key Cryptography, New York, NY, USA, April 24-26, 2006,
Proceedings (Lecture Notes in Computer Science), Moti Yung, Yevgeniy Dodis,
Aggelos Kiayias, and Tal Malkin (Eds.), Vol. 3958. Springer, 207–228. https:
//doi.org/10.1007/11745853_14
(2016), 775–805. https://doi.org/10.1007/s00145-015-9209-1
[14] Daniel J. Bernstein. 2009. Batch Binary Edwards. In Advances in Cryptology
- CRYPTO 2009, 29th Annual International Cryptology Conference, Santa Bar-
bara, CA, USA, August 16-20, 2009. Proceedings (Lecture Notes in Computer Sci-
ence), Shai Halevi (Ed.), Vol. 5677. Springer, 317–336. https://doi.org/10.1007/
978-3-642-03356-8_19
[15] Eli Biham, Yaniv Carmeli, and Adi Shamir. 2016. Bug Attacks. J. Cryptology 29, 4
[16] Daniel Bleichenbacher. 1998. Chosen Ciphertext Attacks Against Protocols Based
on the RSA Encryption Standard PKCS #1. In Advances in Cryptology - CRYPTO
’98, 18th Annual International Cryptology Conference, Santa Barbara, California,
USA, August 23-27, 1998, Proceedings (Lecture Notes in Computer Science), Hugo
Krawczyk (Ed.), Vol. 1462. Springer, 1–12. https://doi.org/10.1007/BFb0055716
[17] Eric Brier, Christophe Clavier, and Francis Olivier. 2004. Correlation Power
Analysis with a Leakage Model. In Cryptographic Hardware and Embedded Sys-
tems - CHES 2004: 6th International Workshop Cambridge, MA, USA, August 11-
13, 2004. Proceedings (Lecture Notes in Computer Science), Marc Joye and Jean-
Jacques Quisquater (Eds.), Vol. 3156. Springer, 16–29. https://doi.org/10.1007/
978-3-540-28632-5_2
[18] Billy Bob Brumley. 2015. Faster Software for Fast Endomorphisms. In Constructive
Side-Channel Analysis and Secure Design - 6th International Workshop, COSADE
2015, Berlin, Germany, April 13-14, 2015. Revised Selected Papers (Lecture Notes
in Computer Science), Stefan Mangard and Axel Y. Poschmann (Eds.), Vol. 9064.
Springer, 127–140. https://doi.org/10.1007/978-3-319-21476-4_9
[19] Billy Bob Brumley, Manuel Barbosa, Dan Page, and Frederik Vercauteren. 2012.
Practical Realisation and Elimination of an ECC-Related Software Bug Attack.
In Topics in Cryptology - CT-RSA 2012 - The Cryptographers’ Track at the RSA
Conference 2012, San Francisco, CA, USA, February 27 - March 2, 2012. Proceedings
(Lecture Notes in Computer Science), Orr Dunkelman (Ed.), Vol. 7178. Springer,
171–186. https://doi.org/10.1007/978-3-642-27954-6_11
[20] Billy Bob Brumley and Risto M. Hakala. 2009. Cache-Timing Template Attacks.
In Advances in Cryptology - ASIACRYPT 2009, 15th International Conference on the
Theory and Application of Cryptology and Information Security, Tokyo, Japan, De-
cember 6-10, 2009. Proceedings (Lecture Notes in Computer Science), Mitsuru Matsui
(Ed.), Vol. 5912. Springer, 667–684. https://doi.org/10.1007/978-3-642-10366-7_39
[21] Billy Bob Brumley and Nicola Tuveri. 2011. Remote Timing Attacks Are Still
Practical. In Computer Security - ESORICS 2011 - 16th European Symposium on
Research in Computer Security, Leuven, Belgium, September 12-14, 2011. Proceedings
(Lecture Notes in Computer Science), Vijay Atluri and Claudia Díaz (Eds.), Vol. 6879.
Springer, 355–371. https://doi.org/10.1007/978-3-642-23822-2_20
[22] David Brumley and Dan Boneh. 2003. Remote Timing Attacks Are Practical.
In Proceedings of the 12th USENIX Security Symposium, Washington, D.C., USA,
August 4-8, 2003. USENIX Association. https://www.usenix.org/conference/
12th-usenix-security-symposium/remote-timing-attacks-are-practical
[23] David Brumley and Dan Boneh. 2005. Remote timing attacks are practical.
Computer Networks 48, 5 (2005), 701–716. https://doi.org/10.1016/j.comnet.2005.
01.010
[24] Certicom Research. 2010. Standards for Efficient Cryptography 2 (SEC 2): Rec-
ommended Elliptic Curve Domain Parameters (Version 2.0). Technical Report.
Certicom Corp. http://www.secg.org/sec2-v2.pdf
[25] Suresh Chari, Josyula R. Rao, and Pankaj Rohatgi. 2002. Template Attacks. In
Cryptographic Hardware and Embedded Systems - CHES 2002, 4th International
Workshop, Redwood Shores, CA, USA, August 13-15, 2002, Revised Papers (Lecture
Notes in Computer Science), Burton S. Kaliski Jr., Çetin Kaya Koç, and Christof
Paar (Eds.), Vol. 2523. Springer, 13–28. https://doi.org/10.1007/3-540-36400-5_3
[26] Cai-Sen Chen, Tao Wang, and Jun-Jian Tian. 2013. Improving timing attack on
RSA-CRT via error detection and correction strategy. Information Sciences 232
(2013), 464–474. https://doi.org/10.1016/j.ins.2012.01.027
[27] Jiazhe Chen, Mingjie Liu, Hexin Li, and Hongsong Shi. 2015. Mind Your Nonces
Moving: Template-Based Partially-Sharing Nonces Attack on SM2 Digital Sig-
nature Algorithm. In Proceedings of the 10th ACM Symposium on Information,
Computer and Communications Security, ASIA CCS ’15, Singapore, April 14-17,
2015, Feng Bao, Steven Miller, Jianying Zhou, and Gail-Joon Ahn (Eds.). ACM,
609–614. https://doi.org/10.1145/2714576.2714587
[28] Łukasz Chmielewski, Pedro Massolino, Jo Vliegen, Lejla Batina, and Nele Mentens.
2017. Completing the Complete ECC Formulae with Countermeasures. Journal
of Low Power Electronics and Applications 7, 1 (2017), 3. https://doi.org/10.3390/
jlpea7010003
[29] Tom Chothia and Apratim Guha. 2011. A Statistical Test for Information Leaks
Using Continuous Mutual Information. In Proceedings of the 24th IEEE Computer
Security Foundations Symposium, CSF 2011, Cernay-la-Ville, France, 27-29 June,
2011. IEEE Computer Society, 177–190. https://doi.org/10.1109/CSF.2011.19
[30] Christophe Clavier, Benoit Feix, Georges Gagnerot, Mylène Roussellet, and Vin-
cent Verneuil. 2010. Horizontal Correlation Analysis on Exponentiation. In
Information and Communications Security - 12th International Conference, ICICS
2010, Barcelona, Spain, December 15-17, 2010. Proceedings (Lecture Notes in Com-
puter Science), Miguel Soriano, Sihan Qing, and Javier López (Eds.), Vol. 6476.
Springer, 46–61. https://doi.org/10.1007/978-3-642-17650-0_5
[31] Jean-Sébastien Coron. 1999. Resistance against Differential Power Analysis for
Elliptic Curve Cryptosystems. In Cryptographic Hardware and Embedded Systems,
First International Workshop, CHES’99, Worcester, MA, USA, August 12-13, 1999,
Proceedings (Lecture Notes in Computer Science), Çetin Kaya Koç and Christof Paar
(Eds.), Vol. 1717. Springer, 292–302. https://doi.org/10.1007/3-540-48059-5_25
[32] Scott A. Crosby, Dan S. Wallach, and Rudolf H. Riedi. 2009. Opportunities
and Limits of Remote Timing Attacks. ACM Transactions on Information and
System Security (TISSEC) 12, 3 (2009), 17:1–17:29. https://doi.org/10.1145/1455526.
1455530
[33] T. Dierks and C. Allen. 1999. The TLS Protocol Version 1.0. RFC 2246. RFC Editor.
[34] Margaux Dugardin, Louiza Papachristodoulou, Zakaria Najm, Lejla Batina, Jean-
Luc Danger, and Sylvain Guilley. 2016. Dismantling Real-World ECC with Hor-
izontal and Vertical Template Attacks. In Constructive Side-Channel Analysis
and Secure Design - 7th International Workshop, COSADE 2016, Graz, Austria,
April 14-15, 2016, Revised Selected Papers (Lecture Notes in Computer Science),
François-Xavier Standaert and Elisabeth Oswald (Eds.), Vol. 9689. Springer, 88–
108. https://doi.org/10.1007/978-3-319-43283-0_6
https://doi.org/10.17487/RFC2246
[35] Pierre-Alain Fouque and Frédéric Valette. 2003. The Doubling Attack - Why
Upwards Is Better than Downwards. In Cryptographic Hardware and Embedded
Systems - CHES 2003, 5th International Workshop, Cologne, Germany, Septem-
ber 8-10, 2003, Proceedings (Lecture Notes in Computer Science), Colin D. Wal-
ter, Çetin Kaya Koç, and Christof Paar (Eds.), Vol. 2779. Springer, 269–280.
https://doi.org/10.1007/978-3-540-45238-6_22
[36] Daniel Genkin, Lev Pachmanov, Itamar Pipman, and Eran Tromer. 2016. ECDH
Key-Extraction via Low-Bandwidth Electromagnetic Attacks on PCs. In Topics
in Cryptology - CT-RSA 2016 - The Cryptographers’ Track at the RSA Conference
2016, San Francisco, CA, USA, February 29 - March 4, 2016, Proceedings (Lecture
Notes in Computer Science), Kazue Sako (Ed.), Vol. 9610. Springer, 219–235. https:
//doi.org/10.1007/978-3-319-29485-8_13
[37] Daniel Genkin, Lev Pachmanov, Itamar Pipman, Eran Tromer, and Yuval Yarom.
2016. ECDSA Key Extraction from Mobile Devices via Nonintrusive Physical Side
Channels. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and
Communications Security, Vienna, Austria, October 24-28, 2016, Edgar R. Weippl,
Stefan Katzenbeisser, Christopher Kruegel, Andrew C. Myers, and Shai Halevi
(Eds.). ACM, 1626–1638. https://doi.org/10.1145/2976749.2978353
158Side-Channel Analysis of SM2: A Late-Stage Featurization Case Study
ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
[38] Daniel Genkin, Adi Shamir, and Eran Tromer. 2014. RSA Key Extraction via
Low-Bandwidth Acoustic Cryptanalysis. In Advances in Cryptology - CRYPTO
2014 - 34th Annual Cryptology Conference, Santa Barbara, CA, USA, August 17-21,
2014, Proceedings, Part I (Lecture Notes in Computer Science), Juan A. Garay and
Rosario Gennaro (Eds.), Vol. 8616. Springer, 444–461. https://doi.org/10.1007/
978-3-662-44371-2_25
[39] Daniel Genkin, Luke Valenta, and Yuval Yarom. 2017. May the Fourth Be With You:
A Microarchitectural Side Channel Attack on Several Real-World Applications
of Curve25519. In Proceedings of the 2017 ACM SIGSAC Conference on Computer
and Communications Security, CCS 2017, Dallas, TX, USA, October 30 - November
03, 2017, Bhavani M. Thuraisingham, David Evans, Tal Malkin, and Dongyan Xu
(Eds.). ACM, 845–858. https://doi.org/10.1145/3133956.3134029
[40] Gabriel Goller and Georg Sigl. 2015. Side Channel Attacks on Smartphones
and Embedded Devices Using Standard Radio Equipment. In Constructive Side-
Channel Analysis and Secure Design - 6th International Workshop, COSADE 2015,
Berlin, Germany, April 13-14, 2015. Revised Selected Papers (Lecture Notes in Com-
puter Science), Stefan Mangard and Axel Y. Poschmann (Eds.), Vol. 9064. Springer,
255–270. https://doi.org/10.1007/978-3-319-21476-4_17
Josh Jaffe, and Pankaj Rohatgi. 2011.
A testing methodology for side-channel resistance validation.
In Non-
Invasive Attack Testing Workshop, NIAT 2011, Nara, Japan, September
https://csrc.nist.gov/csrc/media/events/
26-27, 2011. Proceedings. NIST.
non-invasive-attack-testing-workshop/documents/08_goodwill.pdf
[41] Gilbert Goodwill, Benjamin Jun,