15
VCCIO
4
RESET
19
AGND
25
GND
7
CBUS2
13
CBUS3
14
CBUS4
12
U2
FT232RL
1
2
3
4
5
P1
UX60SC-MB-5ST
0.1uF
C16
10uF
C7
USBDM
USBDP
VUSB
SIN
SOUT
#PWREN
D1
D2
HSMH-C192
1k
R3
1k
R2
VUSB
#RXLED
#TXLED
D3
Q1
FDN340P
VBATT
VCC
Battery Switchover
1k
R4
TP5
TP3
TP1
D/#C
#SS
#RST
SCLK
SIMO
BUSY
TP4
0.1uF
C3
200
R1
1.0uF
C1
USB Mini B
VCC
1.0uF
C6
TP2
W4
Jumper
W5
Jumper
W6
Jumper
VCC
VCC
VCC
VCC
3V3OUT
3V3OUT
3V3OUT
SW0
SW1
LED0
LED1
W1
Jumper
W2
Jumper
W3
Jumper
D5
MMDL914T1G
Bill-of-Materials
Approx. per badge cost = $14.12 (!)
Big ticket items = LCD and laser engraving ($3.84)
EFCON 18 Circuit Board Badge
EFCON 18 Circuit Board Badge
EFCON 18 Circuit Board Badge
ll-of-Materials
ll-of-Materials
ll-of-Materials
ocument Version 2.2, May 19, 2010
ocument Version 2.2, May 19, 2010
ocument Version 2.2, May 19, 2010
ocument Version 2.2, May 19, 2010
m
Quantity Reference
Manufacturer
Manuf. Part #
Distributor
Distrib. Part #
Description
Unit Price
Per Badge
1
BT1
MPD
BU2032SM-JJ-GTR
Digi-Key
BU2032SM-JJ-GTR-ND
Single-cell battery holder for CR2032, SMD
$0.40000
$0.4060
1
N/A
Panasonic
CR2032
Digi-Key
P189-ND
CR2032 Lithium 3V Coin Cell Battery (225mAh)
$0.13750
$0.1375
6
C1,C6,C9,C10,C11,C15
TDK
C3216X7R1H105K
Digi-Key
445-1423-2-ND
1.0uF ceramic capacitor, 50V, X7R, 1206
$0.03100
$0.1943
6
C2,C3,C4,C5,C16,C17
Kemet
C0603C104K4RACTU
Digi-Key
399-1096-2-ND
0.1uF ceramic capacitor, 16V, X7R, 0603
$0.00240
$0.0143
1
C7
Kemet
T491A106M016AT
Newark
57K1640
10uF capacitor, 20%, 16V, tantalum, size A
$0.06900
$0.0693
1
C8
Taiyo Yuden
UMK212B7474KG-T
Digi-Key
587-1288-2-ND
0.47uF ceramic capacitor, 50V, X7R, 0805
$0.03900
$0.0524
2
C12,C13
Taiyo Yuden
TMK212BJ225KG-T
Digi-Key
587-1292-2-ND
2.2uF ceramic capacitor, 25V, X5R, 0805
$0.02600
$0.0582
1
C14
Kemet
C0603C475K8PACTU
Digi-Key
399-5503-2-ND
4.7uF ceramic capacitor, 10V, X5R, 0603
$0.03900
$0.0466
4
D1,D2,D3,D4
Avago
HSMH-C192
N/A
N/A
LED, Red, 0603, 1.8Vf, 17mcd @ 20mA
$0.02900
N/A
1
D5
ON Semiconductor MMDL914T1G
Mouser
863-MMDL914T1G
Diode, Switching, 100Vr, 1Vf @ 10mA, 5uA Ir @ 75V, SOD-323
$0.02400
$0.0251
1
LCD1
Kent Displays
1594101208
N/A
N/A
LCD, 128x32 Reflex Graphic Display Module
$3.49000
$3.4900
b
1
N/A
GM Nameplate
N/A
N/A
N/A
3M 468MP adhesive tape for LCD attachment, 1” x 1/2” strips
$0.07870
$0.0822
1
P1
Hirose
UX60SC-MB-5ST(80)
Digi-Key
H11671TR-ND
Connector, Mini-USB Type B, R/A, 5 position, SMD
$0.37500
$0.4198
1
Q1
Fairchild
FDN340P
Digi-Key
FDN340PTR-ND
Transistor, MOSFET, P-Channel, 20V, 2A, SSOT3/SOT23
$0.11100
$0.1160
1
R1
Yageo
RC0603FR-07200RL  
Mouser
603-RC0603FR-07200RL  200 ohm, 1%, 1/10W, 0603
$0.00200
$0.0030
5
R2,R3,R4,R5,R6
Panasonic
ERJ-3GEYJ102V
Digi-Key
P1.0KGTR-ND
1k, 5%, 1/10W, 0603
$0.00120
$0.0063
2
SW1,SW2
C&K
KSC201JLFS
Digi-Key
401-1756-2-ND
SPST tactile momentary switch, 120gf, 6.2 x 6.2mm, J-Lead
$0.16600
$0.3469
1
U1
Freescale
MC56F8006VLC
Avnet
N/A
Microcontroller/Digital Signal Controller, LQFP32
$1.50000
N/A
1
U2
FTDI
FT232RL
Mouser
895-FT232RL
USB-to-Serial UART Converter, SSOP28W
$1.89000
$1.8900
b
1
N/A
N/A
N/A
Avnet
N/A
Microcontroller programming service
$0.10000
$0.1000
6
W1,W2,W3,W4,W5,W6
Panasonic
ERJ-8GEY0R00V
Digi-Key
P0.0ETR-ND
Jumper, 0 ohm resistor, 1/4W, 1206
$0.00380
$0.0284
1
PCB
e-Teknet
DC18
N/A
N/A
PCB (fabrication, laser, assembly, test)
$6.63000
$6.6300
Assembly 
Drawing
★ Glyph selection
★ LCD control API
★ Secret modes
Core Badge Functionality
★ Choose your favorite 4 glyphs/icons to show off on 
your LCD
★ Now you don't have to talk to someone to ﬁnd out 
if they have the same interests as you :)
★ Enter Glyph Selection mode by pressing SW2 from 
the DEFCON logo
★ Use SW1 and SW2 to cycle through the glyphs
★ Press SW1 and SW2 together to select the glyph
★ Lather, rinse, repeat
Glyph Selection
Glyph Selection 2
LCD Control API
★ Control the LCD via serial commands sent over 
USB virtual COM port
• 9600, 8N1
★ Use terminal program or scripts
★ Display nifty graphics and text on the LCD
★ No hardware hacking experience necessary!
LCD Control API 2
With USB plugged in, send '#' to enable mode
Badge will return welcome string (in ASCII)
'C' = clear frame buffer
'L aa aa vv' = load byte vv into frame buffer 
                           location aa
                           ex.: L 00 01 0A
                           valid locations 0x000 to 0x1FF                
                           see LCD data sheet pg. 9 for mem. map
                           0 = pixel on (dark), 1 = pixel off (light)
'U' = update LCD w/ frame buffer contents
'X' (or power cycle) = exit LCD mode
Badge will return ACK ('.') after a valid command
LCD Control API 3
Secret Modes
Call-for-Integration to invite DEFCON participants 
to hide code and/or data in the badge (March 2010)
Lots of cool stuff? Find it all!
Other Badge Stuff You 
Might Want To Know.
Freescale
CodeWarrior 
for 56800/E 
Digital Signal 
Controllers
★ Special Edition free for up to 64KB Flash
★ Windows only, but works ﬁne in a VM
★ All tools/materials on DEFCON CD
★ http://tinyurl.com/mc56f8006-dev/
Development Environment
Processor 
Expert
★ GUI for peripheral conﬁguration
★ Generates required drivers/function code for 
desired modules
Development Environment 2
Static Serial Bootloader
★ USB port + terminal program = Load your own 
ﬁrmware onto the badge
★ Hold down SW1 & SW2 on power-up
๏ Ideally by inserting USB cable (remove battery 
ﬁrst)
๏ Both top LEDs will remain on
๏ Virtual USB COM port will appear on your 
machine
★ Use CodeWarrior dev. tools to hack/modify 
ﬁrmware and re-compile
Static Serial Bootloader 2
★ When modifying the User Code:
๏ Need to ensure reset and COP vectors point to 
BOOTLOADER_ADDR (0x1B00) and not user 
code!
๏ If you change the linker ﬁle, you'll need to re-
patch it, as well
๏ Read the comments in /CODE/cpu.c for full 
details
Static Serial Bootloader 3
★ Send the hex ﬁle and the badge will do the rest...
• 9600, 8N1, Xon/Xoff
• /output/sdm_pROM_xRAM.elf.S
• Typical load time ~90 seconds
In Case Of Bricking...
★ MC56F8006 JTAG interface
๏ Uses CodeWarrior USB TAP hardware, 
www.freescale.com/webapp/sps/site/
prod_summary.jsp?code=USBTAP
★ Just like last year, but 2x7 connector footprint is 
provided this time
★ Engineers are standing by in the Hardware 
Hacking Village
๏ I brought ~100 connectors
★ Use in conjunction with 56800E Flash Programmer 
tool to reload original ﬁrmware (including static 
bootloader)
• dc18-with-boot.s
★ Only reprogram/debug with USB cable attached to 
ensure normal speed (non-reduced) operation
• Device does not sleep when powered via USB
In Case Of Bricking... 2
Converting BMP to C
★ Load your own graphics onto the badge
• Requires Kent Display development tools (on CD)
• Convert BMP to array and replace the one(s) in 
graphics.h
★ Maximum image size = 128 x 32 pixels
1. Convert to 132 x 32 canvas size with image at far left
2. BMP-to-C using "132x64 BMP to C" tool
3. Erase unused bytes within resultant C ﬁle
4. Copy relevant data into array
Converting BMP to C 2
Converting BMP to C 3
Converting BMP to C 4
Converting BMP to C 5
Converting BMP to C 6
Power Consumption
• Idle (Wait) = 0.7mA
• Active (LCD update) = 8.3mA @ 930mS
• Serial port TX = 6.7mA
CR2032 Lithium coin cell : 3V @ 225mAh to 2V
Idle mode only = 13.4 days
Typical daily use: 1H active, 23H idle = 9 days
Power Consumption 2
Comments
Graph Name:
0
1
2
3
4
5
6
7
8
9
15:07:40
1 Tue Jun 2010
15:07:45
15:07:50
15:07:55
15:08:00
15:08:05
15:08:10
15:08:15
15:08:20
 Show Data: All   Graph View: Averages
    mA DC
Time
Left: Single LCD refresh
Center: Multiple mode changes
Right: Ninja data TX
Single LCD 
refresh
Multiple mode 
changes
Serial port 
transmitting
Seamless Power Switching
• P-channel MOSFET on by default via R4
• When USB plugged in, 3V3OUT (FT232) goes HIGH
• MOSFET turns off and battery is isolated from circuit
• Body diode of MOSFET prevents battery from getting 
reverse fed by 3V3OUT (small nA leakage is OK)
• Voltage drop across D5 causes VCC to be lower for 
USB-powered (2.7V) than battery powered (3V)
• Higher forward voltage (Vf) -> lower reverse leakage (Vr)
C
1
2
3
4
5
6
7
8
9
10
11
12
13
14
P2
DNP
TMS
JTAG Port
Molex 15-91-2140 f
DCD
RI
GND
GND
CBUS0
3V3OUT
17
CBUS1
22
VCCIO
4
AGND
GND
CBUS2
13
CBUS3
14
CBUS4
12
0.1uF
C16
D2
1k
R3
#TXLED
Q1
FDN340P
VBATT
VCC
Battery Switchover
1k
R4
W4
Jumper
W5
Jumper
W6
Jumper
VCC
VCC
VCC
VCC
3V3OUT
D5
MMDL914T1G
Seamless Power Switching 2
• Battery to USB
Seamless Power Switching 3
• USB to Battery
Human = 7000
Speaker = 200
Goon = 200
Press = 180
Vendor = 100
Contest = 70
Uber = 30
Total = 7780
Total Badge Types
Collect them 
all!@#
Time flies, but who's counting?
Admin
7.7% 11:35
Research
10.7% 16:00
TOTAL: 150 hours
Firmware
34.6% 51:50
Documentation
3.8% 5:45
Meetings
3.9% 5:55
Hardware
39.3% 58:55
Badge Hacking Contest HQ @ 
Hardware Hacking Village
Complete schematic, source code, tools, etc. on DEFCON CD
Submit your entry to 
Kingpin starting at 2pm 
Sunday in the HHV
Previous results at 
www.grandideastudio.com/
portfolio/defcon-1x-badge/
x = 4, 5, 6, 7
Now w/ 
Black Badge 
status!
Badge Hacking 
Contest
THE END!
PI:EMAIL