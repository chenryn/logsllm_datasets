title:Mobile data charging: new attacks and countermeasures
author:Chunyi Peng and
Chi-Yu Li and
Guan-Hua Tu and
Songwu Lu and
Lixia Zhang
Mobile Data Charging: New Attacks and Countermeasures
Chunyi Peng
Chi-yu Li
Guan-hua Tu
Songwu Lu
Lixia Zhang
Department of Computer Science, University of California, Los Angeles, CA 90095
{chunyip, lichiyu, ghtu, slu, lixia}@cs.ucla.edu
ABSTRACT
3G/4G cellular networks adopt usage-based charging. Mobile users
are billed based on the trafﬁc volume when accessing data service.
In this work, we assess both this metered accounting architecture
and application-speciﬁc charging policies by operators from the se-
curity perspective. We have identiﬁed loopholes in both, and dis-
covered two effective attacks exploiting the loopholes. The “toll-
free-data-access-attack” enables the attacker to access any data ser-
vice for free. The “stealth-spam-attack” incurs any large trafﬁc
volume to the victim, while the victim may not be even aware of
such spam trafﬁc. Our experiments on two operational 3G networks
have conﬁrmed the feasibility and simplicity of such attacks. We
also propose defense remedies.
Categories and Subject Descriptors
C.2.0 [Computer-Communication Networks]: General—Se-
curity and protection; C.2.1 [Computer-Communication Net-
works]: Network Architecture and Design—Wireless communica-
tion
Keywords
Cellular Networks, Mobile Data Services, Accounting Attacks
1.
INTRODUCTION
Wireless access to Internet data services is getting increasingly
popular, thanks to the deployment of 3G/4G cellular networks.
Statistics from OECD [29] shows that, 62% broadband users in the
US have subscribed to wireless data plans, with 137M subscribers
in June 2010. There are also 1.2B mobile Web users worldwide
already [28]. The explosive growth of smartphones (e.g., iPhones
and Android phones) will further accelerate this usage trend.
While users enjoy wireless data access, it does not come for free.
Most 3G/4G operators bill the user based on the usage data vol-
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
CCS’12, October 16–18, 2012, Raleigh, North Carolina, USA.
Copyright 2012 ACM 978-1-4503-1651-4/12/10 ...$15.00.
ume1. This metered charging2 is ofﬁcially stipulated by the 3G/4G
standards. Based on the standards, charging is performed inside the
cellular network (CN) on a per-ﬂow basis. Each ﬂow is deﬁned by
the ﬁve-tuple (source-IP, destination-IP, source-port, destination-
port, protocol) or its subset. Whenever a data ﬂow is initiated with
the phone, the trafﬁc volume is recorded at the CN when data tra-
verse the CN to reach the phone/server. Therefore, the CN per-
forms accounting operations based on its observed trafﬁc volume.
Carriers can also deﬁne their ﬂow-speciﬁc billing policy.
In this paper, we present the ﬁrst work that critically assesses the
vulnerability of 3G/4G charging system. We discover loopholes in
its policy practice and weakness in its charging architecture. As a
result, we identify two new types of attacks against the charging
system. In the toll-free data access attack, attackers can access any
data service from the mobile phone for any period of time free of
charge. It exploits the policy loopholes when the operator allows
for certain free service (e.g., DNS service).
In the stealth spam
attack, attackers will inject arbitrarily large volume of spam data
into the victim device, even after the target device has terminated
its data service, thus fully unaware of such a spam. This attack ex-
ploits the architecture weakness of not using feedback from the user
when making charging decisions, as well as features of Internet in-
stant messaging applications (e.g., Skype and Google Talk). Our
prototypes show that both attacks are feasible and simple enough
to launch over the operational 3G networks. Our experiments on
two 3G networks from two US carriers show that, the undercharge
or overcharge trafﬁc volume can go unbounded.
Three main contributions of this work are as follows: (1) We re-
port the ﬁrst security analysis on the 3G/4G network charging sys-
tem and identify its loopholes; (2) We describe two new types of at-
tacks, i.e., “toll-free-data-attack” and “stealth spam attack,” which
exploit the identiﬁed loopholes to undermine the charging system;
we also use real experiments over two operational 3G networks to
validate the feasibility and simplicity of these attacks and their po-
tential damage; (3) We articulate the root cause for the existence
of these loopholes and propose effective solutions to eliminating
them. In summary, our study shows that, a dependable, metered
charging system requires concerted coordination among the mo-
bile device, the network, and applications. Security mechanisms
are needed to strengthen every part and the overall system.
The rest of the paper is organized as follows. Section 2 intro-
duces the 3G/4G architecture and its data charging system. Section
1In fact, operators do not offer unlimited monthly data plans for
smartphone users any more. Both AT&T and Verizon effectively
ended such plans for new customers in 2011, and T-mobile limits
the high-speed data volume in its so-called unlimited data plan.
2In this work, we use the words “charging” and “accounting” in-
terchangeably.
195RAN
CN-PS Domain
3G
UMTS
UE
Node B
4G 
LTE
eNodeB
PS Charging System
CGF
OCS
BD
RNC
SGSN
GGSN
Internet
P-GW
Internet
S-GW
MME
Figure 1: 3G/4G network architecture and charging compo-
nents in PS domain.
3 analyzes the vulnerability of mobile data charging. Sections 4
and 5 describe the toll-free data access attack and stealth spam at-
tack, as well as countermeasures, respectively. Section 6 compares
with the related work, and Section 7 concludes the paper.
2. BACKGROUND
In this section, we introduce the charging architecture and pro-
cess for mobile data services. Unlike the ﬂat charging practice over
the Internet, the current cellular network has been using usage-
based charging for its data services. That is to say, the operator
collects the actual usage volume over time for each user and im-
poses charges accordingly.
Broadly speaking, charging is performed on a per-connection ba-
sis. To communicate with a host on the Internet, the mobile device
needs to ﬁrst create a bearer service connection with the cellular
network, which is further connected with the wired Internet. Once
the connection is established, data packets are delivered. The con-
nection has to traverse gateway-like devices (similar to routers in
the Internet) in the cellular network core. These gateways then per-
form accounting operations by recording the data volume of those
packets that traverse them, until the connection is completed.
Speciﬁcally, this accounting scheme has been shaped by both
the standards and the operators’ policy practice. The standards de-
ﬁne the architecture and mechanisms, whereas the operators spec-
ify their own charging policies. Here, we mainly introduce the
charging architecture and process in context of Universal Mobile
Telecommunications System (UMTS), the most widely deployed
3G cellular network technology [19]. Note that, its charging mech-
anisms and operations are also applicable in 4G networks, e.g.,
Long Term Evolution (LTE) networks. For reference, Table 1 lists
important acronyms used in this paper.
Charging Data Records
Core Network
External Host
Flow Based Charging
CDR
CN
EH
FBC
GGSN Gateway GPRS Support Node
PDP
PS
SGSN Serving GPRS Support Node
UE
Packet Data Protocol
Packet-Switched
User Equipment
Table 1: Table of important abbreviations and acronyms.
2.1 Data Charging Architecture
Figure 1 shows the overall 3G UMTS network architecture and
charging system for data services. The UMTS network consists of
the Terrestrial Radio Access Network (RAN) and the core network
1
PS Service
CN
PS Charging
UE
(S/GGSN)
EH
S/GGSN
CGF
BD
1
1b
4
6b
6
Bearer Establishment
Flow Setup (e.g. HTTP)
Data Service, e.g., HTTP
Flow Teardown (e.g. HTTP)
Bearer Teardown 
2
3
5
Trigger
ID
CDRs creation
Accounting
record data usage 
per bear/flow into 
CDRs
7
CDRs closure
8
Billing
CDRs
Figure 2: Charging procedures for a data service ﬂow.
(CN). RAN provides wireless access to the mobile device (called
User Equipment (UE)), and exchanges data session provisioning
with the Packet-Switched (PS) core networks.
The major components of the PS core network are the Serving
GPRS Support Node (SGSN) and the Gateway GPRS Support Node
(GGSN). SGSN handles data packet delivery from and to the UEs
within its geographical service area. GGSN acts as a router be-
tween the SGSN and the external wired Internet, and ‘hides’ the
3G UMTS infrastructure from the external network. In fact, SGSNs
and GGSNs are the aforementioned gateway-like devices, record-
ing data usage through them to perform charging functions.
Current cellular networks support both ofﬂine and online charg-
ing modes [17].
In addition to SGSN and GGSN, three more
charging components work to support both modes: the Billing Do-
main (BD), the Charging Gateway Function (CGF), and the Online
Charging System (OCS). In ofﬂine charging, data usage is collected
during service provisioning in the form of Charging Data Records
(CDRs), which are sent to the BD to generate data bills ofﬂine. The
SGSN and GGSN are responsible for and generating CDRs. The
CGF is used to validate CDRs from SGSNs/GGSNs and transfer
CDRs to the BD. In online charging, mobile users have to pre-pay
to obtain credits for data services in advance. The OCS authorizes
whether or not users have enough credits so that GGSN/SGSN can
proceed data services. GGSN/SGSN deducts data usage from the
available credits and stops data services upon zero credit.
The charging subsystem for 4G LTE cellular network is almost
identical to 3G UMTS. The major difference (also shown in Fig-
ure 1) is that, Serving Gateway (S-GW) and Packet Data Network
Gateway (P-GW) [25] replace SGSN and GGSN to collect data us-
age and generate CDRs.
2.2 Data Charging Procedures
We next describe how mobile users are charged for data ser-
vices through an example. Consider Alice is about to browse CNN
news, thus starting a PS service (say, HTTP). Figure 2 illustrates the
charging procedures (in the right) during the data service process
(in the left), where the external host (EH) is www.cnn.com.
We ﬁrst consider the ofﬂine charging mode. Initially, Alice has
no available bearer service connection, which is used to carry one
or multiple PS data services. She thus ﬁrst establishes a bearer via
Packet Data Protocol (PDP) Context Activation [15] (Step 1) where
PDP contexts provide all the required information for IP packet
data connections in cellular networks. Upon this activation, the
UE is allowed to connect with the external data network through
the SGSN and GGSN. This activation also triggers the charging
procedure; the GGSN assigns a unique charging ID to the activated
PDP context (Step 2). Using the charging ID, the SGSN and GGSN
196start to create CDRs (Step 3), and are ready to record the upcoming
data volume.
In addition to charging per bearer (PDP context), 3G operators
also support charging per data ﬂow, called as Flow Based Charging
(FBC). FBC separates charging for different services (e.g., Web or
VoIP) within the same PDP context [18]. The standard [16] spec-
iﬁes that one data ﬂow is typically identiﬁed by ﬁve tuples: (1)
source IP address, (2) source port number, (3) destination IP ad-
dress, (4) destination port number, and (5) protocol ID of the pro-
tocol above IP, e.g., TCP or UDP. For example, a HTTP data ﬂow
can be represented by (*, *, *, 80, TCP)3. In this CNN case, FBC
is triggered when Alice starts mobile Web browser and initiates a
HTTP session (Step 1b).
Alice can read CNN news now. Both SGSN and GGSN route
data packets between the UE and the external data network dur-
ing the data service session (Step 4). In the meantime, the SGSN
and GGSN record the trafﬁc volume that arrives at them into corre-
sponding CDRs (Step 5). They count the payload of GTP-U (GPRS
Tunneling Protocol- User Plane) packets as data volume (see Fig-
ure 3); GTP-U delivers data within cellular networks and runs be-
low the IP protocol.
GTP-U
IP
TCP
TCP
HTTP
GTP-U Payload
Figure 3: Example of of a GTP-U payload.
The accounting procedure (Step 5) lasts until this data service
completes. It occurs when the UE tears down this bearer (Step 6)
in bearer-based charging, or when Alice closes her HTTP session in
ﬂow-based charging (Step 6b). CDRs are subsequently closed and
transferred to the BD (Step 7). Finally, the BD generates a billing
item based on CDRs and assigns it to the proper user.
The online charging process is similar, though OCS participates
in the triggering and accounting steps (Steps 2 and 5) by authenti-