Hacking from the
Palm of your Hand
Paul Clip
DEFCON - August 01, 2003
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Agenda
 Goals
 Past
–
Overview of the Palm Platform
–
Hacker Tools on the Palm
 Present
–
AUSTIN - A Palm OS Vulnerability Scanner
–
Architecture
–
Features
–
Demos
–
But wait, there’s more!!!
 Future
–
New Features
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Goals
 Overview of Palm OS as a hacking platform
 Walkthrough of a Palm OS-based vulnerability scanner
–
Architecture 
–
Features & how they’re implemented
–
Lessons learned
 Release a new tool for Palm OS
 Have Fun!
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
The Past
Trivia Questions:
What was the first 
Palm Pilot called?
How much memory 
did it have?
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
The Palm Platform
 Old
–
Motorola 68K processor
–
Max speed 66MHz
–
RAM 2-16MB
–
Typical resolution 160^2
–
Some color, some b/w screens
–
Serial/USB port
–
IR
–
Some expansion slots
–
PalmOS 4.x and below
 New
–
ARM processor
–
Max speed 150? 200? 400? 
MHz
–
RAM 16-32MB
–
Typical resolution 320^2
–
All color
–
USB port
–
IR
–
Expansion slots
–
PalmOS 5.x and above
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Security Tools
 Password Generators
http://www.freewarepalm.com/utilities/passgen.shtml
http://www.freewarepalm.com/utilities/passphrase.shtml
 Encryption
http://cryptopad.sourceforge.net/
http://linkesoft.com/secret/
 Password Crackers (old)
http://atstake.com/research/tools/password_auditing/
 War Dialer 
http://atstake.com/research/tools/info_gathering/
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Communication Tools
 Telnet
http://netpage.em.com.br/mmand/ptelnet.htm
 SSH (v1 only)
http://online.offshore.com.ai/~iang/TGssh/
 Web & Mail
http://www.eudora.com/internetsuite/
 Ping
http://www.mergic.com/vpnDownloads.php
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Communication Tools (continued)
 FTP
http://lthaler.free.fr/
 IR Tools
http://pamupamu.tripod.co.jp/soft/irmenu/irm.htm
http://www.harbaum.org/till/palm/ir_ping/
http://www.pacificneotek.com/omniProfsw.htm
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Dev Tools
 RPN Calculator
http://nthlab.com/
 Longtime
Search on http://palmgear.com/
 Filez
http://nosleep.net/
 RsrcEdit
http://quartus.net/products/rsrcedit/
 OnBoard C
http://onboardc.sourceforge.net/
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Useful/Interesting Hardware
 Serial/USB cable
 Keyboard
 GPS
 Modem
 Expansion slot gadgets
 Tilt switch
 IR booster
 Speedometer
 Robotics
 …
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
The Present
Trivia Question:
How many Palm OS 
handhelds are in the 
market today?
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Palm Vulnerability Scanner
 Why?
 What?
– TCP & UDP scanning
– Multiple hosts/ports
– Banner grabbing
– Save results in re-useable format
– Standalone/self-contained program
 What about other scanners?
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Choosing a Development Environment…
 C / C++
 Assembly
 CASL
 AppForge
 NS Basic
 Satellite Forms
 DB2 Personal App Builder
 Java (many flavors)
 Forth
 PocketStudio (Pascal)
 PocketC
 Smalltalk
 Perl
 Python
Even more tools at: http://www.palmos.com/dev/tools/
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Technical Features
 Must have
– Leverage Palm UI
– Responsive
– Extensible
– Development on PC
 Nice to have
– Development on Palm
 Most important
– Re-use other components
PocketC
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
PocketC Overview
 Interpreted C-like language
 Variable types: int, float, char, 
string, pointer
 Multi-dimensional arrays
 Structs possible through a 
(minor) hack
 Reasonably fast
 Allows development on Palm 
+ PC platforms
 Extensible
Example:
//helloworld.pc
main() 
{
puts(“Hello world!\n”);
}
http://www.orbworks.com/pcpalm/index.html
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Extending PocketC
 Can be done in two ways
– PocketC include files
– Native (C/C++) libraries
 Must-have PocketC library
– Pocket Toolbox by Joe Stadolnik
http://www.geocities.com/retro_01775/PToolboxLib.htm
– Features:
 Full access to Palm OS GUI functions
 Database functions
 Graphic functions
 Much more...
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Presenting… AUSTIN
 AUSTIN stands for
– At Stake
– Ultralight
– Scanning
– Tool (for the)
– Inter-
– Net
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
AUSTIN Architecture
Palm Hardware
Palm OS
PocketC
Pocket Toolbox
AUSTIN NetLib
…
Scan.h
GUI.h
AUSTIN
Net.h
Prefs.h
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Tools Used To Develop AUSTIN
 POSE - Palm OS Emulator
http://www.palmos.com/dev/tools/emulator/
 PDE - PocketC Desktop Environment
http://www.orbworks.com/pcpalm/index.html
 PRC-Tools - Includes gcc and other tools used to 
create Palm executables
http://prc-tools.sourceforge.net/
 Palm SDK
http://www.palmos.com/dev/tools/sdk/
 PilRC
http://www.ardiri.com/index.php?redir=palm&cat=pilrc
Lesson Learned:
When adding PRCs
to POSE always do 
so when the Palm is 
displaying 
Applications.
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Palm OS NetLib
 Provides network services to Palm OS applications
– Stream-based communications using TCP
– Datagram-based communications using UDP
– Raw IP available too
 In addition to native Palm OS function calls, NetLib also 
supports the Berkeley Socket API
Lesson Learned:
Using the native NetLib
calls gives you much better 
control over network 
communications, such as 
the ability to set timeouts.
Lesson Learned:
Close sockets as 
soon as you no 
longer need them, 
you only have half a 
dozen to play with!
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Native Network Library
 AUSTIN Net Lib implemented in C as a PocketC native 
library
 Implements the following calls
– netLibInit(…)
– netLibVersion(…)
– netSetTimeout(…)
– netGetError(…)
– netLibClose(…)
– netTCPConnect(…)
– netSocketConnect(…) 
– netSocketOpen(…)
– netSocketReceive(…)
– netSocketSend(…)
– netSocketClose(…)
Lesson Learned:
Default timeout is 5 seconds, you may need 
to increase this if you’re on a slow 
connection, see the Preferences database.
P R O P R I E T A R Y     B U T     N O T     C O N F I D E N T I A L
© 2 0 0 3     @ S T A K E ,     I N C .
Example: netSocketSend()
// sends data via socket
// int netSocketSend(int socket, string data, int length,
int flags, pointer error)
// returns number of bytes sent
void netSocketSend(PocketCLibGlobalsPtr gP) {
Value vSocket, vString, vLength, vFlags, vErrorPtr, *errP;
char *buf;