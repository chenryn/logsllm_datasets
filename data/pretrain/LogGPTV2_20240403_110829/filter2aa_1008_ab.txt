B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Networking 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
TN3270 
•  Imagine a world where telnet still 
exists 
•  Imagine no MORE! 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
TN3270 
•  Imagine a world where telnet still 
exists 
•  Imagine no MORE! 
•  Basically like BBS’s back in the day 
•  Uses a ‘stream’ 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Field Attributes 
• Screen is 1920 bytes long 
• Each byte could be a field 
attribute identifying: 
" Color 
" Locked/Unlocked (Protected) 
" Visible/Invisible (Hidden) 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Locked Field Length 
USERPG01)
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Identifyin’ 
• No support in nmap/other tools 
• Hard to identify screens 
– Without getting an emulator 
• What about Hidden Fields? 
• Or Protected Values? 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Until NOW! 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
NEW! 
•  TN3270 Library for NMAP 
•  Emulates a ‘real’ 3270 screen 
•  Allows you to: 
– Connect 
– Show the screen 
– Send commands 
– Detect hidden fields! 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Samesies 
VTAM Application IDs 
VTAM Macros 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
!"
!"
Hidden Fields! 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
But Wait! 
There’s more! 
I wrote one in LUA 
why not Python? 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
tn3270lib 
•  Support tn3270 (not E) 
•  Creates a tn3270 object 
•  Allows for sending commands 
•  Blah blah blah same as nmap 
BUT NOW IT MEANS I CAN INTRODUCE: 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
3 modes 
•  Proxy/Passthrough – MitM 
•  Mirror a targetted mainframe 
– Connects, scrapes the screen, then shares 
that screen on your machine 
– Takes commands you might expect your 
target to send and pregrabs those screens 
as well 
•  No args: TSO logon screen 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
SET’n’3270 
•  Supports SSL 
Which is cool cause clients don’t check 
certs 
(like, at all, no warning no nothing) 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
More Tools 
•  Big Iron Recon and Pwnage 
– By Dominic White! 
– https://github.com/sensepost/birp 
•  Mainframe Brute 
– Slower but prolly more reliable 
– https://github.com/sensepost/mainframe_brute 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Network 
Job Entry 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Jobs  
(not steve) 
• JCL (Job Control Language) 
• Run by “JES” 
• Made up of  
– STEPS 
– ProGraMs 
– etc 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Network Job Entry 
• Also known as NJE 
• Runs on ports 175, 2252 (SSL) 
• Developed in the 80s (??) 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Works like this 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Initial Setup 
•  Systems configure JES telling 
them: 
– Where to connect 
– Who they will accept connections 
from 
How? 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Number of Nodes 
Our Node Name 
Other nodes 
‘WASHDC’ IP Address 
mainframed767 &   
bigendiansmalls 
B.U.M. Corp. Confidential 
B.U.M. Corp. Confidential 
Connect 
From: Network Job Entry (NJE) Formats and Protocols (SA32-0988-00) 
“OPEN”
Connect TCPIP
“ACK”
mainframed767 &   
bigendiansmalls 