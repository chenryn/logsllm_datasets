RTU (PLC) controls
 This may be a single computer in smaller installations or many
servers in redundant clusters in larger installations
 Today both Master Stations and HMIs are run on all major
operating system platforms: UNIX, Windows, VMS etc
© 2007 Security-Assessment.com
SCADA Basics
Components of A SCADA Network – Management Layer
 A Human Machine Interface or HMI is the apparatus which
presents process data to a human operator, and through which
the human operator controls the process.
 The HMI provides a standardized way to monitor and to control
multiple remote controllers, PLCs and other control devices
which would usually be distributed in a way which makes
manual data gathering difficult
 This usually takes the form of a mimic diagram.  This is a
schematic representation of the plant which is being controlled
 For example, a picture of a pump connected to a pipe can show
the operator that the pump is running and how much fluid it is
pumping through the pipe at the moment. The operator can
then switch the pump off
© 2007 Security-Assessment.com
HMI – Mimic Diagram
http://www.armfield.co.uk – Industrial Food Technology
© 2007 Security-Assessment.com
SCADA Basics
Components of a SCADA network – Communications Layer
 This was traditionally a mix of radio and direct serial or modem
connections
 Equipment frequently communicated via proprietary protocols
carried over something like RS-485 (multipoint serial connection)
 This meant that those who invested in a particular hardware
solution had a limited upgrade path
 To avoid such issues open communications protocols such as
DNP3.0 (over serial or IP) became increasingly popular
 Open architecture SCADA systems allow a mix-and-match
approach with different vendor’s hardware
 In the 2000s protocols such as Modbus/IP allow open interfacing
© 2007 Security-Assessment.com
SCADA Network Protocols
Raw Data Protocols – Modbus / DNP3
For serial radio links mainly, but you can run anything over
anything these days, especially TCP/IP (for better or worse)
Reads data (measures voltage / fluid flow etc)
Sends commands (“flip switches!”, “starts pumps!”) / alerts
(“it’s broken!”)
High Level Data Protocols – ICCP / OCP
 OLE for Process Control (OCP) used for intercommunication
between heterogeneous hardware / software combinations
allowing communication between devices originally not intended
to be part of an industrial network
Designed to send data / commands between apps / databases
These protocols often bridge between office and control
networks
© 2007 Security-Assessment.com
SCADA Basics
Let’s not forget…
© 2007 Security-Assessment.com
SCADA Basics
Let’s not forget… The operator.
© 2007 Security-Assessment.com
In keeping with tradition
© 2007 Security-Assessment.com
SCADA Basics
© 2007 Security-Assessment.com
SCADA Basics
SCADA Networks – Past and Present
 These could be described as “primitive” when compared to
most modern networks
 Proprietary Hardware & Software (Past)
 Manuals and procedures not widely available
 Closed systems considered to be immune to outside threats
 Interconnected Networks (Present)
 Utility Networks, Corporate Networks, Internet
 DNP3 over TCP/IP
Modern stuff is susceptible to modern (or perhaps not so modern)
attacks (SYN Flood, Ping of death)
© 2007 Security-Assessment.com
SCADA Basics
Wonderware SuiteLink Denial of Service vulnerability
 “One third of the world’s plants run Wonderware software
solutions. Having sold more than 500,000 software licenses in
over 100,000 plants worldwide…”
 Wonderware SuiteLink Denial of Service vulnerability
 “a malformed packet that causes a memory allocation operation
(a call to new() operator) to fail returning a NULL pointer. Due
to a lack of error-checking for the result of the memory
allocation operation, the program later tries to use the pointer
as a destination for memory copy operation, triggering an
access violation error and terminating the service.”
© 2007 Security-Assessment.com
SCADA Basics
Wonderware SuiteLink Denial of Service vulnerability
 This was followed by a SERIOUSLY arduous process of
notification and release
 “2008-03-03: Core sends proof-of-concept code written in
Python.
 2008-03-05: Vendor asks for compiler tools required to use
the PoC code.
 2008-03-05: Core sends a link to http://www.python.org
where a Python interpreter can be downloaded.”
© 2007 Security-Assessment.com
And another one today!!!
CitectSCADA ODBC service vulnerability
 Citect is a fully owned subsidiary of Schneider Electric, has more
than 150,000 licenses of its software sold to date.
 Arbitrary code execution remote unauthed….!
 “The ODBC Server component listens on port 20222/tcp by
default to service requests from clients on TCP/IP networks.
The application layer protocol used over TCP reads an initial
packet of 4 bytes…”
 “Due to a lack of a proper length checking of the read data, a
memory copy operation that uses as destination a buffer of
fixed size allocated in the stack “can be overflowed…”
 Long filename, long parameter, malformed data.  Another day,
another vulnerability.  Same bug.  Different App.
© 2007 Security-Assessment.com
So hot right now
Lots of Research Being Published
 BlackHat Federal 2k6 – Maynor and Graham (ISS) – SCADA
Security and Terrorism: We’re not crying wolf.
 Hack in the Box 2k7 – Raoul Chiesa and Mayhem – Hacking
SCADA: How to 0wn Critical National Infrastructure
 Defcon 2k7 – Ganesh Devarajan – Unraveling SCADA Protocols:
Using Sulley Fuzzer
 Petroleum Safety – Gresser – Hacking SCADA/SAS Systems
Why is SCADA the hot topic of security?
 The possible ramifications of a SCADA compromise are very
tangible
 Cyber-Enabled Terrorism is the new Chemical Warfare
© 2007 Security-Assessment.com
So Hot Right Now
SCADA is changing
 From proprietary, obscure, and isolated systems
 Towards standard, documented and connected ones
“ It's not that these guys don't know what they are doing. Part of it
is that these systems were engineered 20 years ago, and part of it
is that the engineers designed these things assuming they would
be isolated. But--wham!--they are not isolated anymore. ”
 Alan Paller, director of research, SANS Institute
© 2007 Security-Assessment.com
SCADA (in)Security
You can test the security of SCADA networks with what you know
now
The rest you can find on the internet
You don’t need custom tools:
 Sulley Fuzzer, Modscan
 Or even detailed knowledge of technologies like OPC, RTU, PLC,
MODBUS
 You will, however, need to know 802.11/a/b/g, VoIP, Windows,
Unix, SMB, SQL, and various intelligence gathering techniques
© 2007 Security-Assessment.com
SCADA (in)Security
You can test the security of SCADA networks with what you know
now
The rest you can find on the internet
You don’t need custom tools:
 Sulley Fuzzer, Modscan
 Or even detailed knowledge of technologies like OPC, RTU, PLC,
MODBUS
 You will, however, need to know 802.11/a/b/g, VoIP, Windows,
Unix, SMB, SQL, and various intelligence gathering techniques
 Old school is good school…
© 2007 Security-Assessment.com
Intel Gathering
Radio Frequency Scanning
 Scanners first became popular and widely available during CB
Radio's heyday in the 1970s. The first scanners often had
between four and ten channels and required a separate crystal
for each frequency received.
 Modern programmable scanners allow hundreds or thousands
of frequencies to be entered via a keypad and stored in various
'memory banks' and can scan at a rapid rate due to modern
microprocessors.
 Scanners are often used to monitor police, fire and emergency
medical services.
 There are several free software packages which will decode
various data protocols commonly sent over radio, ie POC32 for
pager messages, Shipplotter for VHF maritime band
© 2007 Security-Assessment.com
Intel Gathering
Radio Frequency Scanning
 Many SCADA messages and alerts are sent over radio link
 SCADA monitoring and alarm systems can generally use many
different communication mechanisms
 The pager network is a common communication mechanism
due to the high availability of the pager network
 The problem with this is that they leak too much info in clear
text which is available to anyone with…
© 2007 Security-Assessment.com
Intel Gathering
Radio Frequency Scanning
 This cost $250NZD at Dick Smith Electronics across the road
from our office – Uniden Bearcat92XLT
© 2007 Security-Assessment.com
Intel Gathering
Radio Frequency Scanning
 Many SCADA messages and alerts are sent over radio link
 SCADA monitoring and alarm systems can generally use many
different communication mechanisms
 The pager network is a common communication mechanism
due to the high availability of the pager network
 The problem with this is that they leak too much info in clear
text which is available to anyone with…
 So what can information can be gathered?
© 2007 Security-Assessment.com
Intel Gathering
State of the System
© 2007 Security-Assessment.com
Intel Gathering
Software Used
© 2007 Security-Assessment.com
Intel Gathering
Dial-Up Numbers for System Control???????
© 2007 Security-Assessment.com
Intel Gathering
Information Leaking
 “SCADAlarm™ alarm and event-notification software provides a
telecommunications link to industrial automation software
systems. Based on the Microsoft® Windows® operating
system, SCADAlarm enables real-time intelligent alarm and
event notification, data acquisition capabilities and remote
control. SCADAlarm provides an open, easy to configure
interface for constant monitoring and communication with
processes regardless of location.” –
http://us.wonderware.com/products/scadalarm/
 “Users can listen to and
acknowledge alarms, change set
points, hear exact values of
variables, and operate equipment
via telephone from remote
locations, saving valuable time
and money.”
© 2007 Security-Assessment.com
Intel Gathering
Information Leaking
 SCADAlarm provides an IVR SCADA control system
 This is an invaluable attack vector.  Remote access to control
software via the telephone networks allows manipulation of a
SCADA network from the safety of an attackers bedroom
 Authentication (if enabled) is done via caller ID
 Modern VoIP techniques allow relatively trivial caller ID spoofing
making this reasonably trivial to bypass
© 2007 Security-Assessment.com
Intel Gathering
Information Leaking
 SCADAlarm provides an IVR SCADA control system
 This is an invaluable attack vector.  Remote access to control
software via the telephone networks allows manipulation of a
SCADA network from the safety of an attackers bedroom
 Authentication (if enabled) is done via caller ID
 Modern VoIP techniques allow relatively trivial caller ID spoofing
making this reasonably trivial to bypass
 Broadcasting in clear-text over radio the number of the system
to dial for remote control of your SCADA systems seems like a
bad idea...
 What else can be found via the Plain Old Telephone System???
© 2007 Security-Assessment.com
Intel Gathering
War-Dialing
 The ancient art of dialing lots of numbers to see what’s on the
other end
 The name for this technique originated in the 1983 film
WarGames. In the film, the protagonist programs his computer
to dial every telephone number in Sunnyvale, CA in order to
find other computer systems.
 Traditionally numbers are
dialed in large blocks in order
to enumerate computers,
modems, and other systems
© 2007 Security-Assessment.com
Intel Gathering
War-Dialing
 There are several free software solutions which can be used to
perform war-dialing for intelligence gathering purposes
 Tone-Loc – The original war-dialer
 THC Scan – written by Van Hauser.  Scans for carriers, tones
and faxes.  Hard to configure with multiple modems
 Next Generation War Dialing
© 2007 Security-Assessment.com
Intel Gathering
War-Dialing
 There are several free software solutions which can be used to
perform war-dialing for intelligence gathering purposes
 Tone-Loc – The original war-dialer
 THC Scan – written by Van Hauser.  Scans for carriers, tones
and faxes.  Hard to configure with multiple modems
 Next Generation War Dialing – VOIP
 iWAR - http://www.softwink.com/iwar/
 Hai2IVR – http://storm.net.nz/projects/22
© 2007 Security-Assessment.com
iWar – The Intelligent Wardialer
iWar in standard serial mode dialing one number at a time,
detecting carriers, recording and checking banners.
© 2007 Security-Assessment.com
Hai2IVR
© 2007 Security-Assessment.com
Intel Gathering
And the results????
© 2007 Security-Assessment.com
Intel Gathering
And the results????
Direct un-authed connection to SCADA systems? Surely not…
© 2007 Security-Assessment.com
New York Wardial +1212-777-XXXX
© 2007 Security-Assessment.com
Let’s own some infrastructure
Scada hacking for the practical security consultant
© 2007 Security-Assessment.com
Pay to hack, Hack to pay