SRC漏洞挖掘漫谈
星光
2 0 2 1 年 1 月 9 日
安 全 爱 好 者 ， 对 自 动 化 漏 洞 挖 掘 有 着 自 己 的 见 解 。
获 得 2 0 2 1 T S R C 神 洞 猎 手 奖
星光
AK/ SK 信 息 泄 露 ， 自 动发 现
SQ L 注 入 绕 WAF探 测
Hos t  碰 撞 检 测 实 现
域 名 监 控和 站 点变 化 监 控
AK/SK 信息泄露，自动发现
一、AK/SK 信息泄露，自动发现
1.API& 响 应 包 中
2.J S⽂ 件 中
3.G it Hu b 中
4 .APK& 中
5 .& 等 场 景
1、API&响应包中
通 过 B u r p 的 筛 选 功 能 搜 索 “ A K I D ”
一、AK/SK 信息泄露，自动发现
2、JS⽂件中
•
框 架 使 ⽤ ⼴ 泛
•
J S 按 需 加 载
•
动 态 爬 ⾍ 难 触 发
•
寻 找 清 单 ⽂ 件
一、AK/SK 信息泄露，自动发现
•
正 则 匹 配 清 单 内 容
•
成 功 解 析 到 J S 路 径
•
路 径 等 信 息 提 ⾼
•
正 则 匹 配 A K I D
一、AK/SK 信息泄露，自动发现
3、GitHub中
搜 索 “ s e c r e t K e y R
s e c r e t I D ” 等 关 键 字
一、AK/SK 信息泄露，自动发现
4、APK中
通 过 爬 ⾍ 收 集 A P K R U R L
一、AK/SK 信息泄露，自动发现
⼯具
p y t hon& 整 合 下 ⾯ 的软 件
wge t & 下 载 a p k⽂ 件
j a dx & 反 编 译 a p k
gr e p & 匹 配 关 键 字
一、AK/SK 信息泄露，自动发现
SQL注入绕WAF探测
1 . 存 在 W A F ， ⽆ 法 使 ⽤ 特 殊 语 句
2 . 构 建 不 同 语 句 ， ⽐ 对 响 应
3 . 注 释 语 句 ， 效 果 最 好
4 . 单 引 号 闭 合
5 . 异 常 信 息 匹 配
6 . 等
二、SQL注入绕WAF探测
Host 碰撞检测实现
三、Host 碰撞检测实现
1 . W e b 服 务 器 配 置 不 当
2 . 修 改 H o s t 内 ⽹ 域 名 可 被 访 问
3 . 内 ⽹ 站 点 被 访 问 往 往 存 在 问 题
1.⽤灯塔等⼯具收集域名
2.解析域名找公⽹IP和内⽹域名
3.对公⽹IP访问，Host字段改成内⽹域名
4.对⽐响应，找到结果
三、Host 碰撞检测实现
误报处理
1 . 结 果 静 态 过 滤
根 据 经 验 只 保 留 2 0 0 、 3 0 1 、
3 0 2 R 状 态 码
2 . 动 态 过 滤
根 据 状 态 码 、 C o n t e n t 类 型 、
页 ⾯ 标 题 、 响 应 B o d y R 多 个
维 度 判 断 重 复
三、Host 碰撞检测实现
域名监控和站点变化监控
四、域名监控和站点变化监控
0.SRC资产更新频繁，⼈⼯乏⼒
1 . ⼦ 域 名 监 控
周 期 性 对 ⼦ 域 名 进 ⾏ 发 现 并 ⽐ 对 原 有 数 据 ，
发 现 新 域 名 进 ⾏ 消 息 通 知
2 . 站 点 变 化 监 控
周 期 性 发 现 可 访 问 站 点 并 ⽐ 对 原 有 数 据 ，
发 现 新 站 点 进 ⾏ 消 息 通 知
四、域名监控和站点变化监控
追 光 少 年 终 于 也 变 成 了 光