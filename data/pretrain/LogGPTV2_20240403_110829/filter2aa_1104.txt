### SRC漏洞挖掘漫谈
**作者：星光**
**日期：2021年1月9日**

**简介：**
作为一名安全爱好者，我对自动化漏洞挖掘有着独特的见解，并荣获了2021 TSR C神洞猎手奖。

### 一、AK/SK信息泄露的自动发现

#### 1. API和响应包中
- **方法**：使用Burp Suite的筛选功能搜索关键词“AKID”。

#### 2. JavaScript文件中
- **挑战**：
  - 框架使用广泛。
  - JS按需加载。
  - 动态爬虫难以触发。
- **解决方案**：
  - 寻找清单文件。
  - 使用正则表达式匹配清单内容。
  - 成功解析JS路径。
  - 提取并提高路径等信息。
  - 正则匹配AKID。

#### 3. GitHub中
- **方法**：搜索关键字如“secretKey”、“secretID”。

#### 4. APK文件中
- **步骤**：
  - 爬虫收集APK下载URL。
  - 使用Python整合wget下载APK文件。
  - 使用jadx反编译APK。
  - 使用grep匹配关键字。

### 二、SQL注入绕过WAF探测
- **问题**：存在WAF时，无法使用特殊语句。
- **方法**：
  - 构建不同的注入语句并比对响应。
  - 注释语句，效果最佳。
  - 单引号闭合。
  - 异常信息匹配。

### 三、Host碰撞检测实现
- **背景**：Web服务器配置不当可能导致内网域名可被访问。
- **步骤**：
  1. 使用灯塔等工具收集域名。
  2. 解析域名找到公网IP和内网域名。
  3. 对公网IP进行访问，修改Host字段为内网域名。
  4. 比对响应，识别结果。
- **误报处理**：
  - **静态过滤**：根据经验只保留200、301、302状态码。
  - **动态过滤**：根据状态码、Content类型、页面标题、响应Body等多个维度判断重复。

### 四、域名监控和站点变化监控
- **背景**：SRC资产更新频繁，人工监测费力。
- **子域名监控**：
  - 周期性发现子域名并与原有数据对比，发现新域名后发送通知。
- **站点变化监控**：
  - 周期性发现可访问站点并与原有数据对比，发现新站点后发送通知。

---

通过这些方法和技术，我们可以更有效地进行漏洞挖掘和安全管理。希望我的分享能对你有所帮助。追光少年终于也变成了光。