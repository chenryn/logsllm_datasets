    [18:26:10] [275] 112 p
    [18:26:13] [276] 32 space
    [18:26:15] [277] 111 o
    [18:26:18] [278] 102 f
    [18:26:20] [279] 102 f
    [18:26:23] [280] 46 .
    [18:26:26] [281] 0
    [18:26:28] [282] 76 L
    [18:26:33] [283] 0 
    [18:26:37] [284] 0
    [18:26:39] [285] 0
通过对上面的数据分析，发现`190d54e05c`可能是时间戳。
拆分后大小端重排为`‭5CE0540D‬`，然后转换为10进制 `‭1558205453‬`，转换为unix时间戳：‬‬‬‬
提交flag: 2019-5-19 2:50:53
其实还有第三题工控系统操作，但是由于到最后我们没时间计算校验码，因此没有拿到 flag，这里也就不说了
# 0x04 总结
S7协议没有公开的官方文档，在S7协议方面也没有官方术语，我了解的也不算深入，只是通过网上一些分享结合自己理解写成的一篇入门文章，如有错误，还望指出，另外，工控安全其实很吃工控设备，如果能有实际/仿真/模拟设备，对于工控安全的学习很有帮助。此文仅作工控安全入门参考文章，希望对你有所帮助。
# 0x05 参考
西门子通信协议S7Comm  
Siemens SIMATIC Step 7 Programmer's Handbook  
S7 Communication (S7comm)  
wireshark dissector plugin sources  
PI service names  
工业控制系统安全之——Modbus学习笔记  
Modbus TCP流量分析  
# 0x06 附录一：错误码具体含义
错误码 | 含义  
---|---  
0x0000 | 没有错误  
0x0110 | 块号无效  
0x0111 | 请求长度无效  
0x0112 | 参数无效  
0x0113 | 块类型无效  
0x0114 | 找不到块  
0x0115 | 块已存在  
0x0116 | 块被写保护  
0x0117 | 块/操作系统更新太大  
0x0118 | 块号无效  
0x0119 | 输入的密码不正确  
0x011A | PG资源错误  
0x011B | PLC资源错误  
0x011C | 协议错误  
0x011D | 块太多（与模块相关的限制）  
0x011E | 不再与数据库建立连接，或者S7DOS句柄无效  
0x011F | 结果缓冲区太小  
0x0120 | 块结束列表  
0x0140 | 可用内存不足  
0x0141 | 由于缺少资源，无法处理作业  
0x8001 | 当块处于当前状态时，无法执行请求的服务  
0x8003 | S7协议错误：传输块时发生错误  
0x8100 | 应用程序，一般错误：远程模块未知的服务  
0x8104 | 未在模块上实现此服务或报告了帧错误  
0x8204 | 对象的类型规范不一致  
0x8205 | 复制的块已存在且未链接  
0x8301 | 模块上的内存空间或工作内存不足，或者指定的存储介质不可访问  
0x8302 | 可用资源太少或处理器资源不可用  
0x8304 | 无法进一步并行上传。存在资源瓶颈  
0x8305 | 功能不可用  
0x8306 | 工作内存不足（用于复制，链接，加载AWP）  
0x8307 | 保持性工作记忆不够（用于复制，链接，加载AWP）  
0x8401 | S7协议错误：无效的服务序列（例如，加载或上载块）  
0x8402 | 由于寻址对象的状态，服务无法执行  
0x8404 | S7协议：无法执行该功能  
0x8405 | 远程块处于DISABLE状态（CFB）。该功能无法执行  
0x8500 | S7协议错误：帧错误  
0x8503 | 来自模块的警报：服务过早取消  
0x8701 | 寻址通信伙伴上的对象时出错（例如，区域长度错误）  
0x8702 | 模块不支持所请求的服务  
0x8703 | 拒绝访问对象  
0x8704 | 访问错误：对象已损坏  
0xD001 | 协议错误：非法的作业号  
0xD002 | 参数错误：非法的作业变体  
0xD003 | 参数错误：模块不支持调试功能  
0xD004 | 参数错误：作业状态非法  
0xD005 | 参数错误：作业终止非法  
0xD006 | 参数错误：非法链路断开ID  
0xD007 | 参数错误：缓冲区元素数量非法  
0xD008 | 参数错误：扫描速率非法  
0xD009 | 参数错误：执行次数非法  
0xD00A | 参数错误：非法触发事件  
0xD00B | 参数错误：非法触发条件  
0xD011 | 调用环境路径中的参数错误：块不存在  
0xD012 | 参数错误：块中的地址错误  
0xD014 | 参数错误：正在删除/覆盖块  
0xD015 | 参数错误：标签地址非法  
0xD016 | 参数错误：由于用户程序错误，无法测试作业  
0xD017 | 参数错误：非法触发号  
0xD025 | 参数错误：路径无效  
0xD026 | 参数错误：非法访问类型  
0xD027 | 参数错误：不允许此数据块数  
0xD031 | 内部协议错误  
0xD032 | 参数错误：结果缓冲区长度错误  
0xD033 | 协议错误：作业长度错误  
0xD03F | 编码错误：参数部分出错（例如，保留字节不等于0）  
0xD041 | 数据错误：非法状态列表ID  
0xD042 | 数据错误：标签地址非法  
0xD043 | 数据错误：找不到引用的作业，检查作业数据  
0xD044 | 数据错误：标签值非法，检查作业数据  
0xD045 | 数据错误：HOLD中不允许退出ODIS控制  
0xD046 | 数据错误：运行时测量期间非法测量阶段  
0xD047 | 数据错误：“读取作业列表”中的非法层次结构  
0xD048 | 数据错误：“删除作业”中的非法删除ID  
0xD049 | “替换作业”中的替换ID无效  
0xD04A | 执行'程序状态'时出错  
0xD05F | 编码错误：数据部分出错（例如，保留字节不等于0，...）  
0xD061 | 资源错误：没有作业的内存空间  
0xD062 | 资源错误：作业列表已满  
0xD063 | 资源错误：触发事件占用  
0xD064 | 资源错误：没有足够的内存空间用于一个结果缓冲区元素  
0xD065 | 资源错误：没有足够的内存空间用于多个结果缓冲区元素  
0xD066 | 资源错误：可用于运行时测量的计时器被另一个作业占用  
0xD067 | 资源错误：“修改标记”作业过多（特别是多处理器操作）  
0xD081 | 当前模式下不允许使用的功能  
0xD082 | 模式错误：无法退出HOLD模式  
0xD0A1 | 当前保护级别不允许使用的功能  
0xD0A2 | 目前无法运行，因为正在运行的函数会修改内存  
0xD0A3 | I / O上活动的“修改标记”作业太多（特别是多处理器操作）  
0xD0A4 | '强制'已经建立  
0xD0A5 | 找不到引用的作业  
0xD0A6 | 无法禁用/启用作业  
0xD0A7 | 无法删除作业，例如因为当前正在读取作业  
0xD0A8 | 无法替换作业，例如因为当前正在读取或删除作业  
0xD0A9 | 无法读取作业，例如因为当前正在删除作业  
0xD0AA | 处理操作超出时间限制  
0xD0AB | 进程操作中的作业参数无效  
0xD0AC | 进程操作中的作业数据无效  
0xD0AD | 已设置操作模式  
0xD0AE | 作业是通过不同的连接设置的，只能通过此连接进行处理  
0xD0C1 | 访问标签时至少检测到一个错误  
0xD0C2 | 切换到STOP / HOLD模式  
0xD0C3 | 访问标记时至少检测到一个错误。模式更改为STOP / HOLD  
0xD0C4 | 运行时测量期间超时  
0xD0C5 | 块堆栈的显示不一致，因为块被删除/重新加载  
0xD0C6 | 作业已被删除，因为它所引用的作业已被删除  
0xD0C7 | 由于退出了STOP模式，因此作业被自动删除  
0xD0C8 | 由于测试作业和正在运行的程序之间不一致，“块状态”中止  
0xD0C9 | 通过复位OB90退出状态区域  
0xD0CA | 通过在退出前重置OB90并访问错误读取标签退出状态范围  
0xD0CB | 外设输出的输出禁用再次激活  
0xD0CC | 调试功能的数据量受时间限制  
0xD201 | 块名称中的语法错误  
0xD202 | 函数参数中的语法错误  
0xD205 | RAM中已存在链接块：无法进行条件复制  
0xD206 | EPROM中已存在链接块：无法进行条件复制  
0xD208 | 超出模块的最大复制（未链接）块数  
0xD209 | （至少）模块上找不到给定块之一  
0xD20A | 超出了可以与一个作业链接的最大块数  
0xD20B | 超出了一个作业可以删除的最大块数  
0xD20C | OB无法复制，因为关联的优先级不存在  
0xD20D | SDB无法解释（例如，未知数）  
0xD20E | 没有（进一步）阻止可用  
0xD20F | 超出模块特定的最大块大小  
0xD210 | 块号无效  
0xD212 | 标头属性不正确（与运行时相关）  
0xD213 | SDB太多。请注意对正在使用的模块的限制  
0xD216 | 无效的用户程序 - 重置模块  
0xD217 | 不允许在模块属性中指定的保护级别  
0xD218 | 属性不正确（主动/被动）  
0xD219 | 块长度不正确（例如，第一部分或整个块的长度不正确）  