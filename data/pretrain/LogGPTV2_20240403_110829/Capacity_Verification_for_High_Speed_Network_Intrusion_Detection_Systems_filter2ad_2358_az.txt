destroy  that  which  is  determined  to  be  benign,  examination  of  the  logged  data  will
almost  certainly  result  in  privacy  violations.    Even  if  the  data  is  anonymized,  it  is
likely  that  law  enforcement  agencies  would  require  its  association  with  a  particular
originator  for  investigative  purposes  (if  provisions  exist  to  force  disclosure  of
encryption keys, then requiring this association is likely to follow).
7   Conclusions
This paper has looked at some of the issues that will need to be addressed in order to
develop a general legal framework for use of IDS, including trying to define what is
meant by a ‘private communication’.  Depending on the nature of the communication,
the  originator  might  want  to  hide  the  content  of  the  communication  (through
cryptography), the fact that a communication has taken place (through anonymization
or  pseudonymization)  or  both.  The  use  of  encryption  to  ensure  the  privacy  of  the
contents of a communication is no longer an assurance that the contents will in fact
remain  private  –  legislation  exists  to  force  the  disclosure  of  encryption  keys.
Similarly,  the  use  of  pseudonymizing  techniques  is  no  guarantee  that  the  fact  of  a
communication will remain private – most schemes permit  the  re-association  of  the
pseudonymized  traffic  with  the  originator.    An  attempt  to  legislate  the  creation  and
retention  of  similar  records  by  providers  of  anonymizing  services  is  not  beyond
possibility.  If  law  enforcement  agencies  decide  that  IDS  data  is  essential  to  their
investigation,  there  is  little  reason  to  believe  that  they  will  not  require  this
reassociation.
IDS log data probably falls within the definition of traffic data, and is, therefore,
probably subject to the provisions of legislation that require the long-term retention of
traffic data by service providers.  If this is the case, this poses numerous challenges
for the service providers, and creates an increased risk of privacy violations.
Based on the definitions found in criminal law and supporting legislation, the use
of IDS by public and private sector organizations will likely constitute an intercept.
In order not to be an offense, the use of IDS must be in accordance with one of the
exemptions, namely where consent to the interception, express or implied, has been
given by the originator of the private communication or the intended recipient; where
an authorization has been obtained; or where the interception is by a person engaged
in providing a telephone, telegraph or other communication service to the public.
These provisions do not adequately address the situation facing public and private
sector organizations.  Single party (i.e. recipient) consent, although lawful, has been
held  to  violate  constitutional  law.    Two  party  consent  is  considered  the  minimum
standard  –  something  that  will  not  be  achieved  if  one  of  the  parties  to  the
communication has malicious intent.  While satisfying the conditions necessary to the
granting of an authorization should generally be possible, authorizations issued under
criminal law are for evidence collection, not network protection.  It is unlikely that a
global,  open-ended  authorization  for  network  protection  would  (or  could)  ever  be
154         S.R. Johnston
granted  under  criminal  law  or  withstand  legal  challenge.  Narrower  authorizations
issued under the Anti-Terrorism Act (Canada) or to law enforcement or S&I agencies
to  intercept  private  communications  for  network  protection  (i.e.  conduct  intrusion
detection) would be more likely to withstand challenge.
In  a  limited  sense,  a  case  could  be  made  for  the  application  of  the  criminal  law
exemption  for  telecommunications  services  providers  to  public  and  private  sector
organizations.  However, it is not at all clear whether or not these organizations would
actually qualify as a telecommunications service provider under criminal law and so
organizations  could  probably  not  rely  on  this  exemption.  Anti-terrorism  legislation
greatly complicates the task of protecting the privacy of network communications and
the  personal  information  that  they  contain.    Not  only  can  a  broader  range  of
information  be  intercepted  under  authorization,  but  a  similarly  broad  range  of
information  is  to  be  retained  by  ISPs  and  telephone  companies.    In  addition,  there
appears to have been a reduction in the level of judicial discretion in the granting or
denying of interception requests.
It is, therefore, reasonable to suggest that the key to addressing these deficiencies is
the creation of a new exemption under criminal law.  This exemption would provide
the  necessary  legal  basis  for  the  interception  of  private  communications  for  the
purpose of protecting public  and  private  sector  computer  systems  or networks  from
mischief, unauthorized use or interference.
There is still a great deal of work that needs to be done to develop a general legal
framework for the conduct of intrusion detection within the public and private sectors.
Once  the  legal  framework  has  been  developed,  additional  work  will  be  required  in
order  to  develop  appropriate  policies,  standards  and  procedures  for  the  use  of  IDS,
especially  with  respect  to  what  can  be  collected,  how  that  information  is  to  be
handled, stored or disposed of and who has access to the information and under what
circumstances.    The  assistance  of  the  legal  community  would  be  invaluable  in  this
endeavour.
References
[1] Anonymous, “About the CIA”, undated.  URL:
http://www.cia.gov/cia/information/info.html (25 June 2002)
[2] Anonymous,  “Analysis  of  Provisions  of  the  Proposed  Anti-Terrorism  Act  of  2001
Affecting  the  Privacy  of  Communications  and  Personal  Information”,  24  September
2001, 
URL:
http://www.epic.org/privacy/terrorism/ata_analysis.html
Information 
(EPIC). 
Electronic 
Privacy 
Center 
[3] Anonymous,  “Critical  Foundations:  Protecting  America’s 
Infrastructures”,  The
President’s  Commission  on  Critical  Infrastructure  Protection,  October  1997,  Critical
Infrastructure Assurance Office.  URL: 
http://www.ciao.gov/resource/pccip/PCCIP_Report.pdf
[4]  Anonymous, “How the USA-PATRIOT Act Limits Judicial Oversight of Telephone and
Internet  Surveillance”,  23  October  2001,  American  Civil  Liberties  Union.    URL:
http://www.aclu.org/congress/1102301g.html
[5] Anonymous, Infragard Frequently Asked Questions.  URL: 
http://www.infragard.net/faq.htm
Development of a Legal Framework for Intrusion Detection         155
[6]  Anonymous, “List of Minimum and Optional Data to be Retained by Service Providers
and Telcos”, Expert Meeting on Cybercrime: Data Retention, The Hague, 28 December
2001 (File No. 5121-20020411LR-Questionnaire).  URL:
http://www.statewatch.org/news/2002/may/europol.pdf
[8] 
[7]  Anonymous, “Report on the existence of a global system for the interception of private
and  commercial  communications  (ECHELON  interception  system)  (2001.2098  (INI)),
dated 11 July 2001, presented to the European Parliament. URL (Federation of American
Scientists): http://www.fas.org/irp/program/process/rapport_echelon_en.pdf
(Australia)  “An  Act  to  prohibit  the  interception  of  telecommunications  except  where
authorized in special circumstances or for the purpose of tracing the location of callers in
emergencies,  and  for  related  purposes”,  (the  Telecommunications  (Interception)  Act
1979), Act No. 114 of 1979 as amended.  This compilation was prepared on 7 January
2002  taking  into  account  amendments  up  to  Act  No.  166  of  2001. 
  URL:
http://scaleplus.law.gov.au/html/pasteact/0/464/pdf/TeleInt79.pdf.
[9]  Black,  J.,  “Uncle  Sam  Needs  Watching,  Too”,  published  in  Business  Week  Online,  29
November 2001.  URL:
http://www.businessweek.com/bwdaily/dnflash/nov2001/nf20011129_3806.htm. 
[10]  Brown, I. And Gladman, B., “The Regulation of Investigatory Powers Bill – Technically
inept: ineffective against criminals while undermining the privacy, safety and security of
honest citizens and businesses”, undated.  URL:
http://www.fipr.org/rip/RIPcountermeasures.htm
[11]  (Canada)  An  Act  to  amend  the  Criminal  Code,  the  Official  Secrets  Act,  the  Canada
Evidence  Act,  the  Proceeds  of  Crime  (Money  Laundering)  Act,  and  other  Acts,  and  to
enact measures respecting the registration of charities,  in  order  to  combat  terrorism,  24
December 2001 (The Anti-Terrorism Act).  URL: 
www.parl.gc.ca/37/1/parlbus/chambus/house/bills/government/C-36/C-36_4/C-36_cover-E.html.  
[12]  (Canada) An Act respecting the Criminal Law (R.S., c.C-46), updated to 31 August 2001
(The Criminal Code).  URL (Department of Justice Canada) 
http://laws.justice.gc.ca/en/C-46/index.html.
[13]  (Canada) An Act respecting the interpretation of statutes and regulations, (R.S. 1985, c.I-
21), updated to 31 August 2001 (The Interpretation Act).   URL  (Department  of  Justice
Canada): http://laws.justice.gc.ca/en/I-21/index.html.  
[14]  (Canada)  An  Act  to  establish  the  Canadian  Security  Intelligence  Service  (R.S.,  C-23),
updated  to  31  August  2001  (the  Canadian  Security  Intelligence  Service  Act).  URL
(Department of Justice Canada): http://laws.justice.gc.ca/en/C-23/index.html
(Canada)  An  Act  to  extend  the  present  laws  of  Canada  that  protect  the  privacy  of
individuals  and  that  provide  individuals  with  a  right  of  access  to  personal  information
about themselves (R.S. 1985, c.P-21), updated to 31 August 2001 (the Privacy Act). URL
(Department of Justice Canada): http://laws.justice.gc.ca/en/P-21/index.html
[15]
[16] Canadian Oxford Dictionary, Oxford University Press, 1998.
[17]
(Council  of  Europe)  Convention  on  Cybercrime  (ETS  185),  opened  for  signature  at
Budapest, 23 November 2001.  URL: 
http://conventions.coe.int/Treaty/en/Treaties/Word/185.doc.
(Council  of  Europe)  Explanatory  Memorandum  to  Convention  on  Cybercrime,  dated  8
November 2001.  URL: http://conventions.coe.int/Treaty/en/Reports/Html/185.htm 
[18]
[19] Data Protection Working Party, “Opinion 7/2000 On the European Commission Proposal
for a Directive of the European Parliament and of the Council concerning the processing
of personal data and the protection of privacy in the electronic communications sector of
12 July 2000 COM (2000) 385”, dated 2 November2000.  URL: 
http://europa.eu.int/comm/internal_market/en/dataprot/wpdocs/wp36en.pdf.
156         S.R. Johnston
[20]
(European Parliament) Anonymous, “Proposal for a Directive of the European Parliament
and  of  the  Council  concerning  the  processing  of  personal  data  and  the  protection  of
privacy 
communications 
reference
/*COM/2000/0385 final – COD 2000/ 0189*/. URL:
http://europa.eu.int/eur-lex/en/com/pdf/2000/en_500PC0385.pdf
electronics 
document 
sector”, 
the 
in 
[21] EU  Press  Release  “Action  by  the  European  Union  following  the  attacks  on  11
September”,  MEMO/01/327  dated  15  October  2001.    URL  (RAPID  -  The  Press  and
Communication Service of the European Commission): 
http://europa.eu.int/rapid/start/welcome.htm. 
[22] Geist, M., “Shift to more workplace privacy protection”, dated 28 June 2002, Globe and
Mail newspaper (online version).  URL: 
http://www.theglobeandmail.com/servlet/ArticleNews/printarticle/gam/20020628/EBGEISY
[23] Gellman, B., Washington Post staff writer, “Cyber Attacks by Al Qaeda Feared”, 27 June
2002,  Washington  Post  (online  version).    URL:  http://www.washingtonpost.com/wp-
dyn/articles/A50765-2002Jun26.html
[24] Hayes,  Ben,  “EU  anti-terrorism  action  plan:  legislative  measures  in  justice  and  home
affairs policy”, Statewatch post 11.9.01 analyses: No. 6:  URL: 
http://www.statewatch.org/news/2001/oct/analy6.pdf.  
[25] Johnston, Steven R.,  “The Impact of Recent Privacy and Data Protection Legislation on
the  Sharing  of  Intrusion  Detection  Information”.    In  W.  Lee,  L.  Me,  A.  Wespi  (Eds.),
Proceedings of Recent Advances in Intrusion Detection 2001  (RAID 2001),  pgs.  150  –
171, Springer-Verlag, Berlin Heidelberg, 2001.
[26] Joint  Doctrine  Encyclopedia,  dated  16  July  1997.    US  Department  of  Defense  Joint
Electronic Library.  URL: http://www.dtic.mil/doctrine/joint_doctrine_encyclopedia.htm
[27] Lee, S.C. and Shields,  C.,  “Tracing the  Source  of  Network  Attack:  A  Technical,  Legal
and Societal Problem”, published in the proceedings of the 2001 IEEE Man, Systems and
Cybernetics Information Assurance Workshop, pages 239 – 246.  URL: 
http://www.ai.usma.edu/Workshop/2001/Authors/Submitted_Abstracts/paperW1C1(09).pdf. 
[28] Pruitt,  S.,  IDG  News  Service,  “FBI  gets  new  Web  searching  powers”,  dated  31  May
2002, Computerworld Magazine (online version). URL: 
http://www.computerworld.com/securitytopics/security/privacy/story/0,10801,71599,00.html
[29] Reuters, “Spain passes law to regulate Internet content”, dated 27 June 2002.  Posted to
SiliconValley.com.  URL: 
http://www.siliconvalley.com/mld/siliconvalley/news/editorial/3556967.htm
[30] Sommers,  P.,  “Intrusion  Detection  Systems  as  Evidence”,  as  presented  at  the  First
International  Workshop  on  the  Recent  Advances  in  Intrusion  Detection,  14  –  16
September 1998, Louvain-le-Neuve, Belgium.  URL:
http://www.raid-symposium.org/raid98/Prog_RAID98/Full_Papers/Sommer_text.pdf. 
[32]
[31] Stephenson,  P.,  “The  Application  of  Intrusion  Detection  Systems  in  a  Forensic
Environment”, extended abstract, as presented at the Third International Workshop on the
Recent Advances in Intrusion Detection, 2 – 4 October 2000, Toulouse, France.  URL:
http://www.raid-symposium.org/raid2000/Materials/Abstracts/47/47.pdf. 
(United  Kingdom)  Regulation  of  Investigatory  Powers  Act  2000,  Chapter  23,  28  July
2000.  URL: http://www.legislation.hmso.gov.uk/acts/acts2000/20000023.htm 
(UK)  An  Act  to  give  the  Security  Service  the  function  of  acting  in  support  of  the
prevention and detection of serious crime, and for connected purpose (1996 Chapter 35),
dated 18 July 1996 (the Security Service Act 1996).  URL: 
http://www.legislation.hmso.gov.uk/acts/acts1996/1996035.htm
[33]
Development of a Legal Framework for Intrusion Detection         157
[34]
[35]
[36]
[37]
(UK) An Act to amend the Terrorism Act 2000; to make further provision about terrorism
and security; to provide for the freezing of assets; to make provision about immigration
and asylum; to amend or extend the criminal law and powers for preventing  crime  and
enforcing  that  law;  to  make  provision  about  the  control  of  pathogens  and  toxins;  to
provide for the retention of communications data; to provide for implementation of Title
VI of the Treaty on Eurpean Union; and for connected purposes (2001 Chapter 24), 14
December  2001  (the  Anti-terrorism,  Crime  and  Security  Act  2001). 
  URL:
http://www.legislation.hmso.gov.uk/acts/acts2001/10024—a.htm
(United States) United States Code Collection, Legal Information Institute, Cornell Law
School. URL: http://www4.law.cornell.edu/uscode/.
(United States) An Act to deter and punish terrorist acts in the United States and around
the world, to enhance law enforcement investigatory tools, and for other purposes, dated
26 October 2001, (Uniting  and Strengthening  America  by  Providing  Appropriate  Tools
Required  to  Intercept  and  Obstruct  Terrorism  (USA  PATRIOT  Act  of  2001).    URL:
http://www.epic.org/privacy/terrorism/hr3162.pdf.
(United States) United States Supreme Court, Record of Opinion, “Katz v. United States,
389  US  347  (1967)”,  decided  18  December  1967.    Summary  of  opinion  available  at
FindLaw http://findlaw.com/US/389/347.html. 
[38] Weinstein,  L.  and  Neumann,  P.G.,  “PFIR  Statement  on  Government  Interception  of
Internet  Data”,  published  by  People  for  Internet  Responsibility  (PFIR),  dated  7
September 2000, available at http://www.pfir.org/statements/interception.
Learning Unknown Attacks – A Start
James E. Just1, James C. Reynolds1, Larry A. Clough1, Melissa Danforth2,
Karl N. Levitt2, Ryan Maglich1, and Jeff Rowe2
1 Teknowledge Corporation, 3900 Jermantown Road,  Suite 100 
Fairfax, VA 22030 USA
{jjust, reynolds, lclough, rmaglich}@teknowledge.com
2 University of California, 3061 Engineering II, One Shields Avenue 
Davis, CA 95616 USA
{danforth, levitt, rowe}@cs.ucdavis.edu
Abstract. Since it is essentially impossible to write large-scale software without
errors,  any  intrusion  tolerant  system  must  be  able  to  tolerate  rapid,  repeated
unknown  attacks  without  exhausting  its  redundancy.  Our  system  provides
continued application services to critical users while under attack with a goal of
less  than  25%  degradation  of  productivity.  Initial  experimental  results  are
promising.  It  is  not  yet  a  general  open  solution.  Specification-based  behavior
sensors (allowable actions, objects, and QoS) detect attacks. The system learns
unknown  attacks  by  relying  on  two  characteristics  of  network-accessible
software  faults:  attacks  that  exploit  them  must  be  repeatable  (at  least  in  a
probabilistic  sense)  and,  if  known,  attacks  can  be  stopped  at  component
boundaries.  Random  rejuvenation  limits  the  scope  of  undetected  errors.  The
current  system  learns  and  blocks  single-stage  unknown  attacks  against  a
protected web server by searching and testing service history logs in a Sandbox
after  a  successful  attack.  We  also  have  an 
initial  class-based  attack
generalization technique that stops web-server buffer overflow attacks. We are
working to extend both techniques.
1   Introduction
Designing secure systems to survive cyber-attacks is both hard and complex. Initially
designers built stronger locks (e.g., put strong security mechanisms into and around
the systems) to keep out the attackers. However, protection wasn’t perfect and some
attacks  still  got  through.  Then  designers  added  alarms  (e.g.,  intrusion  detectors)  to
alert us to the attackers. Unfortunately, the detectors weren’t perfect and some attacks
still  got  through  undetected.  More  recently,  designers  have  shifted  their  focus  to
building systems that  continue  operating despite  the  attacks  by  leveraging  the  well-
developed techniques of dependability and fault tolerance.
It  is  impossible  to  build  an  intrusion  tolerant  system  that  survives  for  any
meaningful time without solving the problems of unknown attacks and finite failover
resources.  It  is  always  useful  to  harden  a  system  so  the  adversary’s  work  factor  to
penetrate  it  is  increased  but  there  are  limits  to  this  approach.  The  time  and  effort
required to identify a new vulnerability in your system and develop an exploit for it
may be quite large. To a determined opponent, it’s just time and money. 
A. Wespi, G. Vigna, and L. Deri (Eds.): RAID 2002, LNCS 2516, pp. 158-176, 2002.
© Springer-Verlag Berlin Heidelberg 2002
Learning Unknown Attacks – A Start
159
The  real  problem  is  that,  once  an  attack  is  developed  and  put  in  place,  the  time
required to execute it is very small and, in many cases, the time and effort required to
create simple variants of the attack are quite small. If the threat environment for an
intrusion tolerant system includes a well-resourced adversary (e.g., a state-sponsored
cyber-terrorist group or organized crime), the system must be capable of dealing with
many unknown attacks -- possibly repeated quickly (seconds or minutes). This attack
scenario will rapidly exhaust any redundant components in the system and represents,
in our opinion, the worst case design point.
Many  fault  tolerant  mechanisms  work  because  most  faults  are  independent,  low
probability  events  and  hence  are  easily  masked.  Common  mode  failure  is  a  well-
understood problem and one to be avoided often through the use of diversity. Attacks
do not allow the first assumption of independence and the nature of the critical service