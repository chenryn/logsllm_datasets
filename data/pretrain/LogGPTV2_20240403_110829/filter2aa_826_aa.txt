目录
致谢
前言
目录
第一课：windows提权-快速查找exp
第二课：Linux提权-依赖exp篇
第三课：Delphi代码审计—项目实战1
第四课：Asp代码审计—项目实战2
第五课：工具介绍-Sqlmap
第六课：反攻的一次溯源—项目实战3
第七课：sqlserver常用操作远程桌面语句
第八课：模拟诉求任务攻击
第九课：工具介绍-the-backdoor-factory
第十课：msfvenom常用生成payload命令
第十一课：工具介绍Veil-Evasion
第十二课：基于UDP发现内网存活主机
第十三课：基于ARP发现内网存活主机
第十四课：基于第十课补充payload1
第十五课：基于第十课补充payload2
第十六课：红蓝对抗渗透测试1
第十七课：红蓝对抗渗透测试2
第十八课：红蓝对抗渗透测试3
第十九课：基于netbios发现内网存活主机
第二十课：基于snmp发现内网存活主机
第二十一课：基于ICMP发现内网存活主机
第二十二课：基于SMB发现内网存活主机
第二十三课：基于MSF发现内网存活主机第一季
第二十四课：基于MSF发现内网存活主机第二季
第二十五课：基于MSF发现内网存活主机第三季
第二十六课：基于MSF发现内网存活主机第四季
第二十七课：基于MSF发现内网存活主机第五季
第二十八课：基于MSF发现内网存活主机第六季
第二十九课：发现目标WEB程序敏感目录第一季
第三十课：解决msfvenom命令自动补全
第三十一课：msf的前生今世
第三十二课：配置vps上的msf
第三十三课：攻击Mysql服务
-2-
本文档使用书栈(BookStack.CN)构建
第三十四课：攻击Sqlserver服务
第三十五课：与Sqlmap结合攻击
第三十六课：解决vps上ssh掉线
第三十七课：vbs一句话下载payload
第三十八课：certutil一句话下载payload
第三十九课：vbs一句话下载payload补充
第四十课：ftp一句话下载payload
第四十一课：bitsadmin一句话下载payload
第四十二课：攻击FTP服务
第四十三课：js一句话下载payload
第四十四课：ertutil一句话下载payload补充
第四十五课：解决bat一句话下载payload黑窗
第四十六课：powershell一句话下载payload
第四十七课：payload分离免杀思路
第四十八课：payload分离免杀思路第二季
第四十九课：关于Powershell对抗安全软件
第五十课：基于SqlDataSourceEnumerator发现内网存活主机
第五十一课：项目回忆：体系的本质是知识点串联
第五十二课：渗透的本质是信息搜集
第五十三课：内网渗透中的文件传输
第五十四课：基于Powershell做Socks4-5代理
第五十五课：与Smbmap结合攻击
第五十六课：离线提取目标机hash
第五十七课：高级持续渗透-第一季关于后门
第五十八课：高级持续渗透-第二季关于后门补充一
第五十九课：高级持续渗透-第三季关于后门补充二
第六十课：高级持续渗透-第四季关于后门
第六十一课：高级持续渗透-第五季关于后门
第六十二课：高级持续渗透-第六季关于后门
第六十三课：高级持续渗透-第七季demo的成长
第六十四课：高级持续渗透-第八季demo便是远控
第六十五课：离线提取目标机hash补充
第六十六课：借助aspx对payload进行分离免杀
第六十七课：meterpreter下的irb操作第一季
第六十八课：基于Ruby内存加载shellcode第一季
第六十九课：渗透，持续渗透，后渗透的本质
第七十课：ftp一句话下载payload补充
第七十一课：基于白名单Msbuild.exe执行payload第一季
-3-
本文档使用书栈(BookStack.CN)构建
第七十二课：基于白名单Installutil.exe执行payload第二季
第七十三课：基于白名单Regasm.exe执行payload第三季
第七十四课：基于白名单Regsvcs.exe执行payload第四季
第七十五课：基于白名单Mshta.exe执行payload第五季
第七十六课：基于白名单Compiler.exe执行payload第六季
第七十七课：基于白名单Csc.exe执行payload第七季
第七十八课：基于白名单Msiexec执行payload第八季
第七十九课：基于白名单Regsvr32执行payload第九季
第八十课：基于白名单Wmic执行payload第十季
第八十一课：基于白名单Rundll32.exe执行payload第十一季
第八十二课：基于白名单Odbcconf执行payload第十二季
第八十三课：基于白名单PsExec执行payload第十三季
第八十四课：基于白名单Forfiles执行payload第十四季
第八十五课：基于白名单Pcalua执行payload第十五季
第八十六课：基于白名单Msiexec执行payload第八季补充
第八十七课：基于白名单Cmstp.exe执行payload第十六季
第八十八课：基于白名单Ftp.exe执行payload第十九季
第八十九课：基于白名单Url.dll执行payload第十七季
第九十课：基于白名单zipfldr.dll执行payload第十八季
第九十一课：从目标文件中做信息搜集第一季
第九十二课：实战中的Payload应用
第九十三课：与CrackMapExec结合攻击
第九十四课：基于实战中的smallpayload
第九十五课：基于Portfwd端口转发
第九十六课：HTTP隧道ABPTTS第一季
第九十七课：MSF配置自定义Payload控制目标主机权限
第九十八课：HTTP隧道reGeorg第二季
第九十九课：HTTP隧道Tunna第三季
第一百课：HTTP隧道reDuh第四季
-4-
本文档使用书栈(BookStack.CN)构建
致谢
当前文档《专注APT攻击与防御-Micro8系列教程》由进击的皇虫使用书栈
(BookStack.CN)进行构建，生成于2019-05-01。
书栈(BookStack.CN)仅提供文档编写、整理、归类等功能，以及对文档内容的生成和导出工
具。
文档内容由网友们编写和整理，书栈(BookStack.CN)难以确认文档内容知识点是否错漏。如果
您在阅读文档获取知识的时候，发现文档内容有不恰当的地方，请向我们反馈，让我们共同携手，将知
识准确、高效且有效地传递给每一个人。
同时，如果您在日常工作、生活和学习中遇到有价值有营养的知识文档，欢迎分享到书栈
(BookStack.CN)，为知识的传承献上您的一份力量！
如果当前文档生成时间太久，请到书栈(BookStack.CN)获取最新的文档，以跟上知识更新换
代的步伐。
内容来源：Micro8https://github.com/Micropoor/Micro8
文档地址：http://www.bookstack.cn/books/Micro8
书栈官网：http://www.bookstack.cn
书栈开源：https://github.com/TruthHun
分享，让知识传承更久远！感谢知识的创造者，感谢知识的分享者，也感谢每一位阅读到此处的
读者，因为我们都将成为知识的传承者。
致谢
-5-
本文档使用书栈(BookStack.CN)构建
渗透攻击超十年，由于年龄，身体原因，自己感觉快要退出一线渗透攻击了。遂打算把毕生所学用文字
表写出来。因为文章涉及到敏感的攻击行为，所以好多需要打马赛克，或者是本地以demo的形式表
现出来。当这个行业做久了，你也终有一天发现原来事物的本质是如此重要。比如内网渗透的本质是信
息搜集。当年某大佬把这条经验传递给我，同样，今天变成老家伙的我，也希望把这条经验传递下去。
所有课程从基础开始（包括工具的介绍，应用等，由于是基础开始，部分内容可能会涉及初级知识点，
请见谅），这样以后新来的同事或者想要自我从头学习的同事也可以避开一些弯路，在写的过程中，我
深深体会到分享者才是学习中的最大受益者，由于需要成文章，所以需要查阅大量的资料。在整个过程
中，又学习到很多知识点。连载其中包括穿插在工作中的项目心得笔记，包括但不限制于代码审计，
web渗透，内网渗透，域渗透，隧道介绍，日志溯源与暴力溯源等。如果有课程指定需求介绍相关技术
的同事（在我技术能力范围之内），请发我的邮箱：PI:EMAIL。在2010-2012年之
间一直在写，但是由于当时的工作原因，就不在写了。这次的所有课程免费分
享，只希望自己可以在本来已封闭的技术氛围里，依然做出一些技术文档输出。那么这次的教程我想依
然想叫，笔者相信有一天，你会发现原来弄清事物的本质是这样的有趣。
Micro8系列适用于初中级安全从业人员，乙方安全测试，甲方安全自检，网络安全爱好者等，企业安
全防护与提高。
渗透测试/APT模拟攻击，是一把双刃剑，该系列遵守：免费，自由，共享，开源。请勿触犯法律，如触
犯与本作者无关。当下载/传播/学习等便视为同意该条例。愿读者学有所成，问有所得，静有所思，而
私有所惘。
由于开启了open投稿（支持所有人投稿加入该系列），第三方投稿如有广告/隐藏广告/小密圈/等一切
收费为主的行为，请勿相信。
文中难免出现笔误或者不对的地方，请大家多多包涵，提前向各位说声对不起。由于Gitbook正在逐
步完善中，为此带来的不便请您谅解！对于存在的问题，无论是内容上的不足亦或是项目的不足，欢迎
非常遗憾，停止更新。愿每一个安全从业者静有所思。——
2019.3.7
为什么要写Micro8系列
读者及对象
声明
勘误及支持
前言
-6-
本文档使用书栈(BookStack.CN)构建
大家提交Issues。项目地址：
https://github.com/micro8/Micro8-HTML
如需指定技术诉求，也请提交Issue（地址如上），方便在未来更新的课时中加入。再次感谢所有读
者！
致谢
前言
-7-
本文档使用书栈(BookStack.CN)构建
第一课：windows提权-快速查找exp
第二课：Linux提权-依赖exp篇
第三课：Delphi代码审计—项目实战1
第四课：Asp代码审计—项目实战2
第五课：工具介绍-Sqlmap
第六课：反攻的一次溯源—项目实战3
第七课：sqlserver常用操作远程桌面语句
第八课：模拟诉求任务攻击
第九课：工具介绍-the-backdoor-factory
第十课：msfvenom常用生成payload命令
第十一课：工具介绍Veil-Evasion
第十二课：基于UDP发现内网存活主机
第十三课：基于ARP发现内网存活主机
第十四课：基于第十课补充payload1
第十五课：基于第十课补充payload2
第十六课：红蓝对抗渗透测试1
第十七课：红蓝对抗渗透测试2
第十八课：红蓝对抗渗透测试3
第十九课：基于netbios发现内网存活主机
第二十课：基于snmp发现内网存活主机
第二十一课：基于ICMP发现内网存活主机
第二十二课：基于SMB发现内网存活主机
第二十三课：基于MSF发现内网存活主机第一季
第二十四课：基于MSF发现内网存活主机第二季
第二十五课：基于MSF发现内网存活主机第三季
第二十六课：基于MSF发现内网存活主机第四季
第二十七课：基于MSF发现内网存活主机第五季
第二十八课：基于MSF发现内网存活主机第六季
第二十九课：发现目标WEB程序敏感目录第一季
第一章：生
1-10课：
11-20课：
21-30课：
目录
-8-
本文档使用书栈(BookStack.CN)构建
第三十课：解决msfvenom命令自动补全
第三十一课：msf的前生今世
第三十二课：配置vps上的msf
第三十三课：攻击Mysql服务
第三十四课：攻击Sqlserver服务
第三十五课：与Sqlmap结合攻击
第三十六课：解决vps上ssh掉线
第三十七课：vbs一句话下载payload
第三十八课：certutil一句话下载payload
第三十九课：vbs一句话下载payload补充
第四十课：ftp一句话下载payload
第四十一课：bitsadmin一句话下载payload
第四十二课：攻击FTP服务
第四十三课：js一句话下载payload
第四十四课：ertutil一句话下载payload补充
第四十五课：解决bat一句话下载payload黑窗
第四十六课：powershell一句话下载payload
第四十七课：payload分离免杀思路
第四十八课：payload分离免杀思路第二季
第四十九课：关于Powershell对抗安全软件
第五十课：基于SqlDataSourceEnumerator发现内网存活主机
第五十一课：项目回忆：体系的本质是知识点串联
第五十二课：渗透的本质是信息搜集
第五十三课：内网渗透中的文件传输
第五十四课：基于Powershell做Socks4-5代理
第五十五课：与Smbmap结合攻击
第五十六课：离线提取目标机hash
第五十七课：高级持续渗透-第一季关于后门
第五十八课：高级持续渗透-第二季关于后门补充一
第五十九课：高级持续渗透-第三季关于后门补充二
第六十课：高级持续渗透-第四季关于后门
31-40课：
41-50课：
51-60课：
目录
-9-
本文档使用书栈(BookStack.CN)构建
第六十一课：高级持续渗透-第五季关于后门