râ† F. It computes Ëœğ‘â€²
1 = Ëœğ‘1 + Ëœğ‘0 + xT Ëœa, Ëœğ‘â€²
ples Ëœğ‘1, Ëœğ‘2, Ëœğ‘3
2 =
Ëœğ‘2+ Ëœğ‘0+xT Ëœb, and Ëœğ‘â€²
3 = Ëœğ‘3+Ëœğ‘0+xTËœc. Compute Ëœğ‘4 = Ëœğ‘§âˆ’1( Ëœğ‘â€²
1 Ëœğ‘â€²
2âˆ’ Ëœğ‘â€²
3).
It outputs Ëœa = ( Ëœğ‘1, Ëœğ‘2, Ëœğ‘3, Ëœğ‘4).
To complete the proof, it suffices to show that the simulated
distribution is identical to the real distribution for any (x, w)
where CSğœ…(x, w) = 1. By construction, the verification state and
query matrix (output by SLPCP,1) are identically distributed in
Session 1C: Zero Knowledge I CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea229some ğœ âˆˆ F \ ğ‘†. Since ğ‘ğ‘†(ğ‘¥) =ğ›¼âˆˆğ‘†(ğ‘¥ âˆ’ ğ›¼) and ğœ âˆ‰ ğ‘†, we have
the two cases, so it suffices to analyze the distribution of the
responses. Let (st, Q) â† QLPCP(1ğœ…), ğ… â† PLPCP(1ğœ…, x, w), and
a â† QTğ…. Write st = (ğ‘0, ğ‘0, ğ‘0, a, b, c, ğ‘§). First, ğ‘§ = ğ‘ğ‘†(ğœ) for
that ğ‘§ = ğ‘ğ‘†(ğœ) â‰  0. Then the following holds:
â€“ In the real distribution, Eq. (B.2) holds (by completeness). Since
ğ‘§ â‰  0, the value of ğ‘4 is uniquely defined given ğ‘1, ğ‘2, ğ‘3 and st.
The value of ğ‘4 that satisfies Eq. (B.2) precisely coincides with
the value Ëœğ‘4 sampled by SLPCP,2 (for the choice of Ëœğ‘1, Ëœğ‘2, Ëœğ‘3
chosen by the simulator).
â€“ In the real distribution, ğ‘1 = ğ›¿1ğ‘ğ‘†(ğœ)+ğ‘–âˆˆ[ğ‘ğ‘¤âˆ’ğ‘›] ğ‘¤ğ‘›+ğ‘–ğ´ğ‘›+ğ‘–(ğœ),
where ğ›¿1 is uniform over F and independent of all other com-
ponents. Since ğ‘ğ‘†(ğœ) â‰  0, this means ğ‘1 is uniform over F.
A similar argument holds for ğ‘2 and ğ‘3 (by appealing to the
randomness of ğ›¿2 and ğ›¿3, respectively). This is precisely the
distribution of Ëœğ‘1, Ëœğ‘2, Ëœğ‘3 in the simulation.
Thus, the simulated response is identically distributed as the real
response, and perfect HVZK holds.
â–¡
Knowledge against affine strategies. While our compiler only re-
quires a linear PCP with knowledge against linear strategies we
can easily modify the linear PCP from Construction C.1 to provide
knowledge against affine prover strategies without increasing the
query complexity. We describe this modified variant in the full ver-
sion of this paper [78]. This means that we can base security on the
weaker conjecture that Construction 3.5 is â€œaffine-only.â€ Using the
modified linear PCP comes at a very slight increase in the concrete
cost of the verifier, and has no effect on the prover complexity. Since
we believe that Conjecture 3.9 holds, we do not use this modified
linear PCP in our concrete implementation.
C LINEAR PCP AND ZKSNARK ANALYSIS
In this section, we provide the formal analysis of our linear-only
vector encryption scheme and resulting zkSNARKs.
C.1 Linear PCPs over Extension Fields
First, we describe how to transform a linear PCP over Fğ‘2 to a linear
PCP over Fğ‘.
ğ‘
ğ‘ to denote its representation in Fğ‘‘
Field extensions. Recall that a degree-ğ‘‘ field extension Fğ‘ğ‘‘ of Fğ‘
is a ğ‘‘-dimensional vector space over Fğ‘. For a field element ğ‘  âˆˆ Fğ‘ğ‘‘ ,
we write vğ‘  âˆˆ Fğ‘‘
ğ‘. There is an
efficiently-computable isomorphism between ğ‘  âˆˆ Fğ‘ğ‘‘ and vğ‘  âˆˆ Fğ‘‘
ğ‘.
In particular, this means that for all ğ‘ , ğ‘¡ âˆˆ Fğ‘ğ‘‘ , vğ‘  + vğ‘¡ = vğ‘ +ğ‘¡ âˆˆ Fğ‘‘
ğ‘.
We write Mğ‘  âˆˆ Fğ‘‘Ã—ğ‘‘
to denote the linear transformation over Fğ‘‘
ğ‘
corresponding to scalar multiplication by ğ‘  over Fğ‘ğ‘‘ . Namely, for
all ğ‘ , ğ‘¡ âˆˆ Fğ‘ğ‘‘ , we have that Mğ‘ vğ‘¡ = vğ‘ ğ‘¡ .
Construction C.1 (Fğ‘ğ‘‘ -Linear PCP to Fğ‘-Linear PCP). Let Î â€²
LPCP =
(Qâ€²
LPCP) be a ğ‘˜-query linear PCP for a family of
R1CS systems CS = {CSğœ…}ğœ…âˆˆN over an extension field Fğ‘ğ‘‘ with
query length â„“. We construct a (ğ‘‘ğ‘˜)-query linear PCP Î LPCP =
(QLPCP, PLPCP,VLPCP) for CS with query length ğ‘‘â„“ over the base
field Fğ‘:
â€¢ QLPCP(1ğœ…): Run (st, Qâ€²) â† Qâ€²
Q âˆˆ Fğ‘‘â„“Ã—ğ‘‘ğ‘˜
ğ‘ğ‘‘ . Let
be the matrix formed by taking each component
LPCP(1ğœ…), where Qâ€² âˆˆ Fâ„“Ã—ğ‘˜
,Vâ€²
, Pâ€²
LPCP
LPCP
ğ‘
ğ‘
ğ‘–,ğ‘—
ğ‘–,ğ‘—â€ matrix MT
ğ‘â€²
âˆˆ Fğ‘‘Ã—ğ‘‘
LPCP(1ğœ…, x, w) âˆˆ Fâ„“
ğ‘ be the vector formed by taking each component ğœ‹â€²
ğ‘–,ğ‘— âˆˆ Fğ‘ğ‘‘ in Qâ€² and replacing it with the transpose of the
ğ‘â€²
â€œmultiplication-by-ğ‘â€²
. Output st and Q.
â€¢ PLPCP(1ğœ…, x, w): Compute ğ…â€² â† Pâ€²
ğ‘ğ‘‘ . Let
ğ‘– âˆˆ Fğ‘ğ‘‘
ğ… âˆˆ Fğ‘‘â„“
in ğ…â€² and replacing it with the vector vğœ‹â€²
ğ‘ representing ğœ‹ğ‘–.
Output the proof vector ğ….
] for some
â€¢ VLPCP(st, x, a): First, parse a âˆˆ Fğ‘‘ğ‘˜
ğ‘ as [vğ‘â€²
aâ€² = (ğ‘â€²
LPCP(st, x, aâ€²).
ğ‘ğ‘‘ . Output Vâ€²
Theorem C.2 (Fğ‘ğ‘‘ -Linear PCP to Fğ‘-Linear PCP).
is
complete, perfect HVZK, and has knowledge error ğœ€, then the same
holds for Î LPCP from Construction C.1.
âˆˆ Fğ‘‘
1| Â· Â· Â· |vğ‘â€²
1, . . . , ğ‘â€²
ğ‘˜) âˆˆ Fğ‘˜
If Î â€²
LPCP
ğ‘˜
ğ‘–
.
vğ‘â€²
ğ‘
ğ‘
LPCP
ğ‘— =
Mğ‘â€²
ağ‘– =
ğ‘—,ğ‘– ğœ‹â€²
ğ‘— âˆˆ[â„“]
ğ‘—,ğ‘– vğœ‹â€²
ğ‘— = v(qâ€²

ğ‘–)Tğ…â€² âˆˆ Fğ‘‘
ğ‘,
ğ‘— âˆˆ[â„“]
ğ‘– âˆˆ Fâ„“
Proof. We analyze each property individually:
â€¢ Completeness: Take any x, w whereR(x, w) = 1, and let (st, Qâ€²) â†
Qâ€²
LPCP(1ğœ…), ğ…â€² â† Pâ€²
LPCP(1ğœ…, x, w). Let Q âˆˆ Fğ‘‘â„“Ã—ğ‘‘ğ‘˜
and ğ… âˆˆ Fğ‘‘â„“
be as specified in QLPCP and PLPCP and let a â† QTğ…. Write
a = [a1, . . . , ağ‘˜]. By construction, for all ğ‘– âˆˆ [ğ‘˜],

where qâ€²
ğ‘ğ‘‘ denotes the ğ‘–th column of Qâ€². This means that
the vector aâ€² computed by VLPCP satisfies aâ€² = (Qâ€²)Tğ…â€². Com-
pleteness now follows by completeness of Î â€²
â€¢ Knowledge: Let (st, Qâ€²) â† Qâ€²
LPCP(1ğœ…) and let Q be the ma-
trix QLPCP constructs from Qâ€². Take any proof ğ… âˆˆ Fğ‘‘â„“
ğ‘ , and let
ğ…â€² âˆˆ Fâ„“
ğ‘ğ‘‘ be the vector obtained by viewing each contiguous
block of ğ‘‘ elements of ğ… as an element of Fğ‘ğ‘‘ . By construction,
LPCP(st, x, (Qâ€²)Tğ…â€²) =
VLPCP(st, x, QTğ…) = 1 if and only if Vâ€²
1. The claim now follows by knowledge soundness of Î â€²
.
Namely, the extractor ELPCP for Î LPCP simply invokes the ex-
tractor Eâ€²
ğ‘ğ‘‘ that Eâ€²
makes to âŸ¨ğ…â€², Â·âŸ© can be simulated via ğ‘‘ linear queries to âŸ¨ğ…, Â·âŸ© by
expanding each component in qâ€² into a matrix over Fğ‘‘Ã—ğ‘‘
.
LPCP = (Sâ€²
â€¢ Perfect HVZK: Let Sâ€²
LPCP,2) be the linear
PCP simulator for Î â€²
. We define SLPCP = (SLPCP,1,SLPCP,2)
LPCP
for Î LPCP as follows:
â€“ SLPCP,1(1ğœ…): On input ğœ… âˆˆ N, run the simulator Sâ€²
LPCP,1(1ğœ…)
to obtain a pair (st, Qâ€²) where Qâ€² âˆˆ Fâ„“Ã—ğ‘˜
ğ‘ğ‘‘ . The simulator con-
structs Q âˆˆ Fğ‘‘â„“Ã—ğ‘‘ğ‘˜
by expanding replacing each component
ğ‘â€²
ğ‘–,ğ‘— of Qâ€² with Mâ€²T
(as in QLPCP). It outputs (st, Q).
â€“ SLPCP,2(st, x): On input the simulation state st and a statement
x, run Sâ€²
LPCP,2(st, x) to obtain aâ€² âˆˆ Fğ‘˜
ğ‘ğ‘‘ . Then, compute and
ğ‘ by expanding each component ğœ‹â€²
output a âˆˆ Fğ‘‘ğ‘˜
ğ‘– âˆˆ Fğ‘ğ‘‘ as a
âˆˆ Fğ‘‘
ğ‘ (as in PLPCP).
vector vğœ‹â€²
Perfect HVZK now follows by perfect HVZK of Î â€²
. Any linear query qâ€² âˆˆ Fâ„“
LPCP,1,Sâ€²
for Î â€²
LPCP
LPCP
LPCP
LPCP
ğ‘
ğ‘ğ‘–,ğ‘—
ğ‘
ğ‘–
.
LPCP
â–¡
C.2 Circuit Privacy
We give the formal definition of circuit privacy below:
Definition C.3 (Circuit Privacy). Let Î Enc = (Setup, Encrypt,
Decrypt, Add) be a secret-key vector encryption scheme over Fâ„“.
Session 1C: Zero Knowledge I CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea230We say that Î Enc satisfies circuit privacy if for all efficient and
stateful adversaries A, there exists an efficient simulator S such
that for all security parameters ğœ† âˆˆ N,
Pr[ExptCircuitPrivÎ Enc,A,S(1ğœ†) = 1] = 1/2 + negl(ğœ†),
(C.1)
where the experiment ExptCircuitPrivÎ Enc,A,S(1ğœ†) is defined as
follows:
(1) The challenger samples (pp, sk) â† Setup(1ğœ†, 1â„“) and gives
(pp, sk) to the adversary. The adversary replies with a collection
of vectors v1, . . . , vğ‘˜ âˆˆ Fâ„“.
(2) The challenger constructs ciphertexts ctğ‘– â† Encrypt(sk, vğ‘–) for
all ğ‘– âˆˆ [ğ‘˜] and gives (ct1, . . . , ctğ‘˜) to A. The adversary replies
with a collection of coefficients ğ‘¦1, . . . , ğ‘¦ğ‘˜ âˆˆ F.
0 â† Add(pp, {ctğ‘–}ğ‘–âˆˆ[ğ‘˜], {ğ‘¦ğ‘–}ğ‘–âˆˆ[ğ‘˜])
and ctâˆ—
bit ğ‘
experiment is 1 if ğ‘â€² = ğ‘ and 0 otherwise.
1 â† S(1ğœ†, pp, sk,ğ‘–âˆˆ[ğ‘˜] ğ‘¦ğ‘–vğ‘–). It also samples a random
(4) The adversary outputs a bit ğ‘â€² âˆˆ {0, 1}. The output of the
râ† {0, 1} and replies to the adversary with ctâˆ—
(3) The challenger computes ctâˆ—
ğ‘
.
In this work, we also consider a weaker notion of circuit privacy
where we additionally constrain the adversary to choosing the
coefficients from an a priori specified set ğ‘† âŠ† F. In this case, we
say that Î Enc satisfies circuit privacy with respect to ğ‘†. In addition,
when the probability in Eq. (C.1) is bounded by 1/2 + ğœ€, we say that
Î Enc is ğœ€-circuit private.
Remark C.4 (Multi-Query Circuit Privacy). We can define a multi-
query variant of Definition C.3 where the adversary can adaptively
choose multiple collections of coefficients ğ‘¦1, . . . , ğ‘¦ğ‘˜ âˆˆ ğ‘…ğ‘ and