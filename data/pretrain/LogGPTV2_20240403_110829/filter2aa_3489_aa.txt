BlindElephant:
Web Application Fingerprinting 
With Static Files
Patrick Thomas
7/28/10
Outline
• Web Apps & Security
• Intro to Fingerprinting
• Static File Approach
• Observations From A Net Survey
• Q & A
2
Well-Known Web Applications
• Every conceivable use…
• Content Management/Blogging
• Forums
• Email
• E-Commerce
• DB Admin
• Backup and File Storage Admin
• Device/System/VM Admin
• Version Control UI
• Intranet/Collaboration
3
Well-Known Web Applications
Theory of Fingerprinting
• Find some characteristic(s) that is…
• …always the same for a particular individual 
(implementation/version/person)
• …always different  from other members of the population
• If there‟s one piece of info that fulfills both, great
• If not, take several that pin it down
• Tons of interesting reading in information theory and entropy
• OS & HTTP Server Fingerprinting: Lots of protocol-aware 
checks that rely on subtle differences in implementation
5
Existing Fingerprinting Approaches
• Labor intensive to add signatures
• Manually locate version in files or build regexes for headers
• Decent hardening pretty much nukes them
• Built-in options to remove identifiers (eg, meta generator)
• Remove standard files
• Easy to lie to
Fingerprinters like this:
• Sedusa (in nmap), Wappalyzer, BackendInfo, Plecost, 
etc, etc…
6
More Advanced Tools
• Typically improve in one area
• Resistant to hardening
• Less labor intensive
• Have their own downsides
• Less specific results 
• Some request massive amounts of data (> 20 megs!)
• Some are less generic (Plecost = Wordpress Only)
Fingerprinters like this:
• Sucuri, WAFP, WhatWeb, BackEndInfo (sortof), 
7
Goals for a (WebApp) Fingerprinter
• Very Generic
• Fast
• Low resource usage
• Accurate (Low FP/FN)
• Resistant to hardening/banner removal
• Super easy to support new versions/apps
8
The Blind Men and the Elephant
9
Collect and Eliminate Possibilities
10
Tree or 
Elephant
Spear or 
Elephant
Vine or 
Elephant
Fan or 
Elephant
Intersect the Possibilities and…
11
Web App 
Versions
Hashes 
Table
Paths 
Table
Versions 
Table
What versions 
will a path give 
me info on?
If I want to confirm 
or rule out a 
version/versions, 
what‟s a path that 
will do that?
(eg, Joomla-*.zip)
1.0.2
1.0.3
1.0.4
2.0.1
3.1.6
3.2.10
What files 
appear 
unchanged in 
multiple 
versions?
Preparing the Data
12
wordpress-0.71-gold/*/*.*
wordpress-0.72-beta-1/*/*.*
wordpress-0.72-RC1/*/*.*
wordpress-1.0.1-miles/*/*.*
wordpress-1.0.1-RC1/*/*.*
wordpress-1.0.2/*/*.*
wordpress-1.0.2-blakey/*/*.*
wordpress-1.0-platinum/*/*.*
wordpress-1.0-RC1/*/*.*
wordpress-1.2.1/*/*.*
wordpress-1.2.2/*/*.*
wordpress-1.2-beta/*/*.*
wordpress-1.2-delta/*/*.*
wordpress-1.2-mingus/*/*.*
wordpress-1.2-RC1/*/*.*
wordpress-1.2-RC2/*/*.*
…
wordpress-2.9/*/*.*
wordpress-2.9.1/*/*.*
wordpress-2.9.1-beta1/*/*.*
wordpress-2.9.1-beta1-IIS/*/*.*
wordpress-2.9.1-IIS/*/*.*
wordpress-2.9.1-RC1/*/*.*
wordpress-2.9.1-RC1-IIS/*/*.*
wordpress-2.9-beta-1/*/*.*
wordpress-2.9-beta-1-IIS/*/*.*
wordpress-2.9-beta-2/*/*.*
wordpress-2.9-beta-2-IIS/*/*.*
wordpress-2.9-IIS/*/*.*
wordpress-2.9-RC1/*/*.*
wordpress-2.9-RC1-IIS/*/*.*
wordpress-1.5-strayhorn/*/*.*  
wordpress-2.0.7-RC2/*/*.*
wordpress-2.2.1/*/*.* 
wordpress-2.5.1/*/*.*
…
f8fc944a02d28f61dc4cf719aa1194ce
('2.0.9', '/install/schemas/postgres_schema.sql', 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.7', '/install/schemas/postgres_schema.sql', 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.13', '/install/schemas/postgres_schema.sql', 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.5', '/install/schemas/postgres_schema.sql', 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.14', '/install/schemas/postgres_schema.sql', 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.12', '/install/schemas/postgres_schema.sql', 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.6', '/install/schemas/postgres_schema.sql', 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.11', '/install/schemas/postgres_schema.sql', 'f8fc944a02d28f61dc4cf719aa1194ce')
7be360f53320de4bc9335738e8d02b20
('3.0.6-RC1', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.6', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.2', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.4', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.6-RC3', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.4-RC1', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.3', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.5', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.5-RC1', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.6-RC2', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
('3.0.6-RC4', '/styles/subsilver2/template/index.htm', '7be360f53320de4bc9335738e8d02b20')
bdb4046baa012e90a01602199e60054f
('3.0.6-RC1', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.6', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.2', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.4', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.6-RC3', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.4-RC1', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.3', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.5', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('2.2b', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.5-RC1', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.6-RC2', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
('3.0.6-RC4', '/adm/images/cellpic3.gif', 'bdb4046baa012e90a01602199e60054f')
Directory Tree
HashesTable
f8fc944a02d28f61dc4cf719aa1194ce
('2.0.9', ..., 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.7', ..., 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.13', ..., 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.5', ..., 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.14', ..., 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.12', ..., 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.6', ..., 'f8fc944a02d28f61dc4cf719aa1194ce')
('2.0.11', ..., 'f8fc944a02d28f61dc4cf719aa1194ce')
7be360f53320de4bc9335738e8d02b20
('3.0.6-RC1', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.6', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.2', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.4', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.6-RC3', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.4-RC1', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.3', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.5', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.5-RC1', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.6-RC2', ..., '7be360f53320de4bc9335738e8d02b20')
('3.0.6-RC4', ..., '7be360f53320de4bc9335738e8d02b20')
bdb4046baa012e90a01602199e60054f
('3.0.6-RC1', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.6', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.2', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.4', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.6-RC3', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.4-RC1', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.3', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.5', ..., 'bdb4046baa012e90a01602199e60054f')
('2.2b', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.5-RC1', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.6-RC2', ..., 'bdb4046baa012e90a01602199e60054f')
('3.0.6-RC4', ..., 'bdb4046baa012e90a01602199e60054f')
/templates/subSilver/admin/index_frameset.tpl
74057e1687fa4edfd1ba0207e073e100 ['2.0']
fc9388927f44fd90698936837070b525 ['2.0.1']
7ec0529fd736950a3dd0c7b66f7b5f2c ['2.0.2', …
264974c35d7a66d32ddfa118b1bc359d ['2.0.18', …
/install/schemas/schema_data.sql
b1fdcba066491e22d7b2b84ace8c94e0 ['3.0.6-RC3']
10d66666d443fb0eb5970c4c5cadc844 ['3.0.6']
1129aeae10003398b500d11cc9b26acd ['3.0.5-RC1']
8db031ced0c0377ded71ebed82e14408 ['3.0.6-RC1']
560143ba7cbcaa48b58d17a28970be04 ['3.0.2']
ad0ca453932b8cce946345a998403401 ['3.0.4']
59065f5fed0d801ab04a1eef7ca4fad4 ['3.0.4-RC1']
89e85ef960aef6f461cbe71907890057 ['2.2b']
e060676be3191f2a7bd95df62711e28d ['3.0.6-RC2']
ce2b47359e50e2a83fea2f3bbec9a8b1 ['3.0.5']
efb06c117f2681bedcc704ea10223394 ['3.0.3']
045634305e36af4fea75f3a95c415f49 ['3.0.6-RC4']
3.0.3,3.0.4,3.0.4-RC1
('/styles/prosilver/template/ucp_pm_viewmessage.html', '314fe5725db…
('/styles/subsilver2/template/viewforum_body.html', 'f4002089f99384bf4…
('/adm/style/acp_styles.html', '39e7ad0dbeda3f8d7731e844eba62622')
('/styles/subsilver2/template/mcp_warn_user.html', '6fce7b9564afb5aa6d..
('/styles/prosilver/template/mcp_warn_user.html', 'c56f962be418102b8…
('/styles/subsilver2/template/index_body.html', '64c9a99b3b53f4…
('/styles/prosilver/theme/content.css', '5f264fed8971c7d00e7092f48f379…
….
2.0.20,2.0.21
('/language/lang_english/email/user_activate_passwd.tpl', '4375947c68…
('/templates/subSilver/confirm_body.tpl', „1ead54515b2b537…
('/templates/subSilver/admin/board_config_body.tpl', 'f8519d018f9850d…
('/language/lang_english/email/group_request.tpl', '6192f8bbb9e4596ad…
('/install/schemas/mssql_schema.sql', '045c0fcfaa4f89d771b07b66a74….
('/contrib/README.html', '61f46292c72f73935bcc2b74403d8b74„)
VersionsTable
PathsTable
HashesTable
Hash 
Version  File
Version  File
Version  File
Hash 
Version  File
Version  File
Version  File
File
Hash  Version
Hash  Version
Hash  Version
File 
Hash  Version
Hash  Version
Hash  Version
Version, Version, Version
File  Hash
File  Hash
File  Hash
Version
File  Hash
File  Hash
How Many Files?
Wordpress
~80k files in 151 versions
phpBB
~17k files in 32 versions
MediaWiki
~56k files in 59 versions
Joomla
~83k files in 24 versions
MovableType
~140k files in 57 versions
Drupal
~30k files in 102 versions
… and many more
Wordpress Plugins
~17k files in 358 versions
Drupal Plugins
~76K files in 983 versions
15
'/htaccess.txt', 14 hashes/31 versions, fitness=15.0
'/language/en-GB/en-GB.ini', 14 hashes/20 versions, fitness=14.64
'/language/en-GB/en-GB.com_content.ini', 13 hashes/20 versions, 
fitness=13.64
'/configuration.php-dist', 10 hashes/28 versions, fitness=10.90
'/includes/js/joomla.javascript.js', 8 hashes/28 versions, 
fitness=8.90
'/media/system/js/validate.js', 8 hashes/20 versions, fitness=8.64
'/media/system/js/caption.js', 8 hashes/20 versions, fitness=8.64
'/language/en-GB/en-GB.mod_feed.ini', 8 hashes/20 versions, fitness=8.64
'/media/system/js/openid.js', 8 hashes/20 versions, fitness=8.64
'/language/en-GB/en-GB.com_contact.ini', 8 hashes/20 versions, fitness=8.64
'/language/en-GB/en-GB.mod_breadcrumbs.ini', 7 hashes/20 versions, fitness=7.64
'/media/system/js/combobox.js', 7 hashes/20 versions, fitness=7.64
'/language/en-GB/en-GB.mod_search.ini', 7 hashes/20 versions, fitness=7.64
'/templates/rhuk_milkyway/css/template.css', 7 hashes/20 versions, fitness=7.64
'/media/system/js/switcher.js', 7 hashes/20 versions, fitness=7.64
Best Candidates to Identify the Version
Paths 
Table
Fingerprinting
16
'/htaccess.txt'
'/language/en-GB/en-GB.ini'
'/language/en-GB/en-GB.com_content.ini'
'/configuration.php-dist',
'/includes/js/joomla.javascript.js'
'/media/system/js/validate.js'
'/media/system/js/caption.js'
'/language/en-GB/en-GB.mod_feed.ini'
'/media/system/js/openid.js'
'/language/en-GB/en-GB.com_contact.ini'
'/language/en-GB/en-
GB.mod_breadcrumbs.ini'
'/media/system/js/combobox.js'
'/language/en-GB/en-GB.mod_search.ini'
'/templates/rhuk_milkyw/css/template.css'
'/media/system/js/switcher.js'
Best Candidates
3.0.4-RC4,
3.0.4
200 OK
200 OK
200 OK
404
403
2.0.1, 2.0.2…
3.0.4-RC4,
3.0.4
2.5.1, 2.3.16…
3.0.4-RC4,
3.0.4
3.0.4-RC4,
3.0.4, 3.5
3.0.4-RC4,
3.0.4, 3.5.1
Fingerprinting
17
Versions 
Table
3.0.0, 3.0.1
3.0.2, 3.0.3, 
3.0.4-RC1, 
3.0.4-RC2
? ? ?
(confirm or 
rule out 
versions)
Darn, Not Enough Data
3.0.2?
3.0.0 or
3.0.1?
3.0.3?
3.0.4?
3.0.5 or
3.0.6?
Winnowing
18
{'path': „/includes/js/dtree/img/frontpage.gif“‟,  'versions': 29}
{'path': '/images/banners/osmbanner2.png',  'versions': 33}
{'path': '/media/system/js/mootools.js',  'versions': 18}
{'path': „/includes/js/wz_tooltip.js ',  'versions': 29}
Indicator Files