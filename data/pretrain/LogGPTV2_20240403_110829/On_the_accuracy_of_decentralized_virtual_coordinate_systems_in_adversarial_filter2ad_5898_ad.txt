our solution is able to oﬀer protection to the smaller scale
AMP data set from malicious nodes, it can be seen from
Fig. 8(c) that larger percentages of malicious nodes begin to
overwhelm the system. This occurs since the percentage of
malicious nodes is high (≥ 30%), each benign node will have
many malicious reference set members. For example, given
that 30% of the total nodes are malicious, the probability
that at least 30% of the nodes in a reference set of AMP
are also malicious is about 67%. This is nearly double the
probability for King or Meridian under the same conditions
due to AMP’s much smaller size (see Table 1).
Malicious coalition size tolerated by outlier detec-
tion.All defense mechanisms and protocols resilient to insid-
ers have limitations regarding the number of attackers they
can tolerate. We analyze the number of malicious colluding
nodes that can be tolerated by our outlier detection mech-
 0 0.5 1 1.5 2 2.5 3 0 10 20 30 40 50Relative ErrorSimulation Time5th Percentile Relative Error50th Percentile Relative Error95th Percentile Relative Error 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 0 10 20 30 40 50Relative ErrorSimulation Time5th Percentile Relative Error50th Percentile Relative Error95th Percentile Relative Error 0 0.5 1 1.5 2 2.5 0 10 20 30 40 50Relative ErrorSimulation Time5th Percentile Relative Error50th Percentile Relative Error95th Percentile Relative Error(a) 5th Pct. Relative Error, 10% Mal. (b) 50th Pct. Relative Error, 10% Mal. (c) 95th Pct. Relative Error, 10% Mal.
(d) 5th Pct. Relative Error, 20% Mal. (e) 50th Pct. Relative Error, 20% Mal. (f) 95th Pct. Relative Error, 20% Mal.
(g) 5th Pct. Relative Error, 30% Mal. (h) 50th Pct. Relative Error, 30% Mal. (i) 95th Pct. Relative Error, 30% Mal.
Figure 7: Relative error under diﬀerent percentage of attackers using diﬀerent spatial outlier thresholds
(King)
Table 4: Number of Colluding Nodes Tolerated by
Spatial Outlier Detection for Diﬀerent Data Sets Us-
ing A Spatial Outlier Threshold of 1.5
Data Set
Attack Type King Meridian AMP
19.8
12.6
19.3
Inﬂation
Deﬂation
Oscillation
19.7
20.2
19.6
21.6
19.8
20.3
anism using a reference set size of 64. Table 4 presents the
number of malicious nodes in a reference set which by col-
luding can inﬂuence the spatial centroid calculation enough
to allow the attack types discussed in Section 2.3 to bypass
the detection mechanism. Nearly twenty malicious nodes
(or 30% of the reference set size) are required for nearly all
of the identiﬁed attack types across the three data sets. The
deﬂation attack is more successful for AMP since the RTTs
are less variable and the virtual coordinate system creates
one main cluster (Fig. 1(c)) that contains all of the nodes.
This also explains why high percentages of malicious nodes
(≥ 30%) were able to overwhelm our solution in the AMP
scenarios.
In these cases, the benign nodes were likely to
have twenty or more malicious nodes in their reference set,
which could cause the spatial centroid to shift and allow ma-
licious updates to pass undetected. We conclude that our de-
fense method works well when the size of the malicious coali-
tion is smaller than one third of the total number of nodes in
the reference set. This bound is inline with the performance
of other methods that tolerate malicious insiders (e.g. [10]).
System overhead.Our defense mechanisms do not in-
troduce any extra link stress since they utilize information
that is already being exchanged between nodes. The mem-
ory utilization for spatial correlation requires maintaining
the most recent u updates. In the case of the temporal out-
lier detection, the memory usage consists of maintaining the
temporal centroid. By incrementally updating the centroid,
we do not need to maintain the entire history for each probed
node but only need to store the mean, standard deviation,
and count for each of the metrics. The additional compu-
tational complexity is bounded by the number of nodes in
the reference set which is constant. The computation of the
temporal and spatial outliers is a constant time calculation
performed at each node when it updates its coordinate.
 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh. 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh. 0 0.2 0.4 0.6 0.8 1 1.2 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh. 0 0.5 1 1.5 2 2.5 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh. 0 0.5 1 1.5 2 2.5 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh. 0 0.2 0.4 0.6 0.8 1 1.2 1.4 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh. 0 0.5 1 1.5 2 2.5 3 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh. 0 0.5 1 1.5 2 2.5 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh. 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 0 10 20 30 40 50Relative ErrorSimulation TimeNo Detection1.25 Thresh.1.5 Thresh.1.75 Thresh.2.00 Thresh.(a) King
(b) Meridian
(c) AMP
Figure 8: Relative error under diﬀerent percentage of attackers using a spatial outlier threshold of 1.5 with
three real-life Internet latency data sets
5. RELATED WORK
In this section, we review previous work in three related
areas:
Attacks in virtual coordinate systems. One of the few
systems to consider actual malicious behavior is the PIC
[12] virtual coordinate system, which uses a security test
based on the triangle inequality. Any node which violates
the triangle inequality above some margin of error is ignored
and designated as malicious. However, it has been shown
that RTT measurements often violate this inequality [27, 53,
31] and thus solutions based solely on such inequalities may
degrade system performance when no attack is occurring.
Kaafar et al. demonstrate the susceptibility of Vivaldi to
attacks [21, 22].
We have recently become aware of [20], developed simul-
taneously and independently of our work, which employs a
set of trusted nodes as a reference set by which to analyze
all node behavior for malicious patterns and behavior. The
key diﬀerence in the techniques is our method does not ne-
cessitate the need for a trusted component in the network.
Coordinate system error and landmark selection. An
important area of research orthogonal to the security of the
system is the minimization of error in the system. The
accuracy of such systems is greatly eﬀected by landmark
placement for centralized schemes and neighbor selection in
decentralized schemes.
In [49], it is shown that a hierar-
chical approach can lead to better performance over non-
hierarchical solutions. Works by Lua et al. [31] and Zhang
et al. [50] demonstrate shortcomings of current systems and
propose possible new metrics and measurements to more ac-
curately embed the distance in the coordinate system. These
areas provide interesting opportunities for further research
since our work could possibly leverage these new metrics to
place further constraints on the attackers and create a more
robust, accurate, and fault-tolerant system.
Use of spatial and temporal correlations. Recently the
beneﬁts of the Mahalanobis distance for statistical anomaly
detection have been demonstrated in the context of network
intrusion detection [45, 26]. In [26], the authors present a
comparative study of detection schemes based on data min-
ing techniques for network based intrusion detection. In [45]
the authors discuss an unsupervised, payload-based network
anomaly detector based on the Mahalanobis distance which
was used to detect attacks like worms.
Spatial and temporal correlations were previously used in
the context of network security. A notable work in this as-
pect by Jiang and Cybenko [18] uses temporal and spatial
correlations to detect attack scenarios using a large amount
of information from intrusion detection systems, ﬁrewalls,
and diﬀerent software logs. Unlike this more general ap-
proach, our work focuses on virtual coordinate systems.
Correlations have also been used in wireless networks for
the detection of attacks [6, 42]. The work by Huang et al.
[6] uses correlations between diﬀerent features to identify
attacks against wireless ad hoc routing protocols while the
work by Tanachaiwiwat and Helmy [42] shows how to aug-
ment sensor networks with spatio-temporal correlations to
detect misinformation being injected into the sensor streams.
In our work, the correlation is incorporated in-line with the
coordinate computation and analysis is performed on real
Internet data sets.
6. CONCLUSION
In this paper, we studied attacks against the accuracy of
virtual coordinate systems. We classiﬁed the attacks as co-
ordinate inﬂation, deﬂation and oscillation and showed that
even a small number of attackers can severely degrade coor-
dinate accuracy due do the epidemic nature of the attacks.
We proposed to use spatial-temporal correlation to perform
outlier detection on updates received from malicious nodes
and eliminate them from the coordinate computation pro-
cess. By using analytical and empirical methods we found
that a spatial temporal of 1.5 and a temporal threshold of
4 produced a low system error and maintained an accept-
able false positive rate. Finally, we examined the limitations
of outlier detection when a signiﬁcant percentage of nodes
are malicious and found that the method starts degrading
when more than 30% of the nodes in a reference set form a
malicious coalition.
Future work includes analyzing the relation between ref-
erence set size and the system size and the eﬀect of our
mechanisms on upper level applications using virtual coor-
dinate systems to estimate network measurements.
7. ACKNOWLEDGMENTS
We would like to thank AAron Walters for his guidance
and insights. We also thank Jing Dong for his patient ex-
planations. Finally, we thank the authors of Vivaldi and
p2psim for the help and scripts they provided. This work
is supported by National Science Foundation CyberTrust
Award No. 0430271. The views expressed in this research
are not endorsed by the National Science Foundation.
 0 0.5 1 1.5 2 2.5 0 10 20 30 40 50Relative ErrorSimulation Time20% Malicious No Detection20% Malicious w/ Detection30% Malciouis No Detection30% Malicious w/ Detection 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 0 10 20 30 40 50Relative ErrorSimulation Time20% Malicious No Detection20% Malicious w/ Detection30% Malciouis No Detection30% Malicious w/ Detection  0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 0 10 20 30 40 50Relative ErrorSimulation Time20% Malicious No Detection20% Malicious w/ Detection30% Malciouis No Detection30% Malicious w/ Detection8. REFERENCES
[1] Bittorrent. http://www.bittorrent.com/.
[2] Nlanr active measurement project. http://amp.nlanr.net/.
[3] p2psim: A simulator for peer-to-peer protocols.
http://pdos.csail.mit.edu/p2psim/.
[4] Skype. http://www.skype.com/.
[5] A. S. Aiyer, L. Alvisi, A. Clement, M. Dahlin, J.-P. Martin,
and C. Porth. Bar fault tolerance for cooperative services.
In Proc. of SOSP, Dec. 2005.
[6] Y. an Huang, W. Fan, W. Lee, and P. S. Yu. Cross-feature
analysis for detecting ad-hoc routing anomalies. In Proc. of
ICDCS, 2003.
[7] V. Barnett and T. Lewis. Outliers in statistical data. 1978.
[8] D. Birant and A. Kut. Spatio-temporal outlier detection in
large databases. In Proc. of ITI, 2006.
[9] M. Castro, P. Druschel, A. Ganesh, A. Rowstron, and D. S.
Wallach. Secure routing for structured peer-to-peer overlay
networks. In Proc. of ACM OSDI, 2002.
[10] M. Castro and B. Liskov. Practical byzantine fault
tolerance. In Proc. of ACM OSDI, 1999.
[11] Y. Chu, S. G. Rao, and H. Zhang. A case for end system
multicast (keynote address). In SIGMETRICS, 2000.
[12] M. Costa, M. Castro, R. Rowstron, and P. Key. PIC:
practical Internet coordinates for distance estimation. In
Proc. of ICDCS, 2004.
[13] F. Dabek, R. Cox, F. Kaashoek, and R. Morris. Vivaldi: a
decentralized network coordinate system. In Proc. of
SIGCOMM, 2004.
[14] D. E. Denning. An intrusion-detection model. IEEE Trans.
Softw. Eng., 13(2):222–232, 1987.
[15] Z. Ferdousi and A. Maeda. Unsupervised outlier detection
in time series data. In Proc. of ICDEW, 2006.
[16] P. Francis, S. Jamin, C. Jin, Y. Jin, D. Raz, Y. Shavitt,
and L. Zhang. Idmaps: A global internet host distance
estimation service, 2000.
[17] K. P. Gummadi, S. Saroiu, and S. D. Gribble. King:
Estimating latency between arbitrary internet end hosts. In
Proc. of SIGCOMM-IMW, 2002.
[18] G. Jiang and G. Cybenko. Temporal and spatial
distributed event correlation for network security. In
American Control Conference, 2004.
[19] R. Johnson and D. Wichern. Applied multivariate
statistical analysis. Prentice-Hall, Inc. Upper Saddle River,
NJ, USA, 1988.
[20] M. A. Kaafar, L. Mathy, C. B. K. Salamatian, T. Turletti,
and W. Dabbous. Securing internet coordinate embedding
systems. In Proc. of SIGCOMM, 2007.
[21] M. A. Kaafar, L. Mathy, T. Turletti, and W. Dabbous.
Real attacks on virtual networks: Vivaldi out of tune. In
Proc. of LSAD, 2006.
[22] M. A. Kaafar, L. Mathy, T. Turletti, and W. Dabbous.
Virtual networks under attack: Disrupting internet
coordinate systems. In Proc. of CoNext, 2006.
[23] E. M. Knorr and R. T. Ng. Algorithms for mining
distance-based outliers in large datasets. In Proc. of
VLDB, 1998.
[24] D. E. Knuth. The Art of Computer Programming, 2nd Ed.
(Addison-Wesley Series in Computer Science and
Information. Addison-Wesley Longman Publishing Co.,
Inc., Boston, MA, USA, 1978.
[25] Y. Kulbak and D. Bickson. The eMule Protocol
Speciﬁcation. eMule project, http://sourceforge.net.
[26] A. Lazarevic, L. Ertoz, V. Kumar, A. Ozgur, and
J. Srivastava. A comparative study of anomaly detection
schemes in network intrusion detection. In Proc. of SIAM
SDM, 2003.
[27] J. Ledlie, P. Gardner, and M. Seltzer. Network coordinates
in the wild. In Proc. of USENIX NSDI, 2007.
[28] J. Ledlie, P. Pietzuch, M. Mitzenmacher, and M. Seltzer.
Wired geometric routing. In Proc. of IPTPS, 2007.
[29] H. Lim, J. Hou, and C. Choi. Constructing internet
coordinate system based on delay measurement. In Proc. of
SIGCOMM-IMC, 2003.
[30] C. Lu, D. Chen, and Y. Kou. Multivariate spatial outlier
detection. International Journal on Artiﬁcial Intelligence
Tools, World Scientiﬁc, 13(4):801–812, December 2004.
[31] E. Lua, T. Griﬃn, M. Pias, H. Zheng, and J. Crowcroft.
On the accuracy of embeddings for internet coordinate
systems. In Proc. of ACM IMC, 2005.
[32] C. Lumezanu and N. Spring. Playing Vivaldi in Hyperbolic
Space. In Proc. of SIGCOMM-IMC, 2006.
[33] E. Ng and H. Zhang. Predicting internet network distance
with coordinates-based approaches. In Proc. of INFOCOM,
2002.
[34] T. Ng and H. Zhang. A network positioning system for the
internet. Proc. of USENIX, 2004.
[35] M. Pias, J. Crowcroft, S. Wilbur, S. Bhatti, and T. Harris.
Lighthouses for scalable distributed location. In Proc. of
IPTPS, 2003.
[36] A. Rao, S. Ratnasamy, C. Papadimitriou, S. Shenker, and
I. Stoica. Geographic routing without location information.
In Proc. of ACM MobiCom, 2003.
[37] M. I. Ribeiro. Gaussian probability density functions:
Properties and error characterization. Technical report,
Instituto Superior Tecnico, Lisboa, Portugal, 2003.
[38] C. Sargor. Statistical anomaly detection for link-state
routing protocols. In Proc. of ICNP, 1998.
[39] Y. Shavitt and T. Tankel. Big-bang simulation for
embedding network distances in euclidean space.
IEEE/ACM Trans. Netw., 12(6):993–1006, 2004.
[40] R. C. Smith and P. Cheeseman. On the representation and
estimation of spatial uncertainty. International Journal of
Robotics Research, 5(4):56–68, 1986.
[41] P.-N. Tan, M. Steinbach, and V. Kumar. Introduction to
Data Mining. Addison Wesley, USA, 2006.
[42] S. Tanachaiwiwat and A. Helmy. Correlation analysis for
alleviating eﬀects of inserted data in wireless sensor
networks. In Proc. of MobiQuitous, 2005.
[43] L. Tang and M. Crovella. Virtual landmarks for the
internet. In Proc. of SIGCOMM, 2003.
[44] A. Walters, D. Zage, and C. Nita-Rotaru. Mitigating
attacks against measurement-based adaptation mechanisms
in unstructured multicast overlay networks. In Proc. of
ICNP, November 2006.
[45] K. Wang and S. J. Stolfo. Anomalous Payload-based
Network Intrusion Detection. In Proc. of RAID, 2004.
[46] L. wei Lehman and S. Lerman. Pcoord: Network position
estimation using peer-to-peer measurements. In Proc. of
NCA, 2004.
[47] L. wei Lehman and S. Lerman. A decentralized network
coordinate system for robust internet distance. In Proc. of
ITNG, 2006.
[48] B. Wong, A. Slivkins, and E. Sirer. Meridian: a lightweight
network location service without virtual coordinates. In
Proc. of SIGCOMM, 2005.
[49] R. Zhang, C. Hu, X. Lin, and S. Fahmy. A hierarchical
approach to internet distance prediction. In Proc. of
ICDCS, 2006.
[50] R. Zhang, C. Tang, Y. Hu, S. Fahmy, and X. Lin. Impact
of the Inaccuracy of Distance Prediction Algorithms on
Internet Applications – An Analytical and Comparative
Study. In Proc. of INFOCOM, 2006.
[51] X. Zhang, J. Liu, B. Li, and T. Yum.
CoolStreaming/DONet: A Data-driven Overlay Network
for Peer-to-Peer Live Media Streaming. In Proc. of
INFOCOM, 2005.
[52] B. Y. Zhao, J. D. Kubiatowicz, and A. D. Joseph. Tapestry:
An infrastructure for fault-tolerant wide-area location and
routing. Technical Report 01-1141, UC Berkeley, 2001.
[53] H. Zheng, E. Lua, M. Pias, and T. Griﬃn. Internet routing
policies and round-trip-times. In Proc. of PAM, 2005.