不分密级，只按内容分隔间。每个域代表一个单独的隔间，有单独的权限管理。
②混合环境 Hybrid Environment
又分密级，又按内容分隔音。也就是客体管理的粒度更小了，不过管理起来也更麻烦。
这里插播一下“域”：
术语“域”早在 Microsoft 创办之前就己存在，CISSP 中多次出现“域”。然而，当人们
听到这个术语时，他们通常想到的是网络区段中一组由一台运行 Microsoft 软件的服务器(称
为域控制器)控制的计算机和设备。实际上一个域只是某个主体可用的一组资源。需要记住的
是，主体可以是用户、进程或应用程序。在操作系统内部，每个进程都具有一个域，也就是该
进程在执行自己的任务时可用的一组系统资源。这些资源可能是内存段、硬盘空间、操作系统
—167—
服务以及其他进程。在网络环境中，一个域是一组可用的物理和逻辑资源，包括路由器、文件
服务器、FTP 服务、Web 服务器等。
术语“安全域”建立在域的基础之上，增加的内容只是这个逻辑结构(域)内的资源在相同
安全策略下运行，并且由同一个组管理。因此，网络管理员可能会将所有的会计人员、计算机
和网络资源放入域 l 中，而将所有的管理人员、计算机和网络资源放入域 2 中。这些项属于不
同的容器，因为它们不仅实现相似的业务功能，而且更重要的是，它们具有相同的信任级别。
正是这种共同的信任级别，才允许若干实体由单个安全策略管理。
不同的域由逻辑边界分隔，如防火墙、目录服务器等 。所有这些安全机制都是为每个域
实施安全策略的组件。
域可以采用层次化结构，这种结构说明了不同域之间的关系以及不同域内主体的通信方
式。主体能够访问相同或更低信任级别的域中的资源。它们的通信信道由安全代理(防火墙、
路由器 ACL、目录服务)控制，不同的域则使用特定的子网掩码地址隔离。
需要记住的是，域不仅适用于网络设备和区段，而且还可以应用于用户和进程。
AIO 教材在关于单点登录的相关小节中谈到了域，这是因为，目前有几种不同的技术可用
于定义和实施这些域以及与之对应的安全策略：Windows 环境中的域控制器、企业资源管理
(ERM)产品、Microsoft Passport(现在的 Windows Live ID)以及提供 SSO 功能的各种产品。
所有这些技术的目标是允许用户(主体)只需要登录一次就可以访问不同的域，而不必重新输入
其他任何凭证。
E.4 自主访问控制(DAC)
1.自主访问控制(DAC) Discretionary Access Controls
由客体的所有者、创建者或一个客体的数据保管者来自行控制和定义主体对该客体的访
问。常常使用客体的访问控制列表(ACL)来实现 DAC 模型。在桔皮书（通用准则 CC）里是等级
C。
自主访控有时也被称为基于身份的访问控制（identity‐based access control model）。
基于身份的访问控制是 DAC 的一个子集，因为系统识别用户身份并分配资源给这个身份。
2.非自主访问控制(NDAC) Nondiscretionary Access Controls
管理员对不可任意支配的访问控制进行集中管理。任何不是自主访问控制的模型都是非自
主的。这包括基于规则、基于角色和基于格子的访问控制（前面都讲过）。
实际考题有问到哪个是非自主访问控制，答案一般都是基于角色的访问控制；如果问到非
自主访问控制的模型特点，一般都是“通过中央授权来决定主体可以访问哪些客体”。
F.预防与减缓访问控制攻击
CISSP 里的经常讲到 mitigation，即 risk mitigation，翻译成风险消减最好。
一、骇客、黑客和攻击者
骇客、黑客和攻击者，Crackers, Hackers, and Attackers。
最早，骇客是干坏事的攻击者；黑客是不干坏事的技术高手；现在搞不清了，反正所有的
攻击者被是黑客。现在就是“攻击者”来指代这些人。其它基础的知识就不说了，有关的攻击
—168—
技术和案例都很多了。
二、APT/高级持续性威胁 Advanced Persistent Threat
有国家或政府背景的，集团化的，高技术水平的，持续长期的网络空间作战威胁。CBK 里
列举了塔吉特公司（Target）POS 机用户信用卡信息被窃的例子；其实 APT 最经典和轰动的案
例是“震网”病毒。
三、针对访问控制的攻击
1.访问聚合攻击 Access Aggregation Attacks
通过收集多个非敏感信息块，并将他们结合来获得敏感信息。（第三域，E.3 章节里的数
据库安全里，已经讲了聚合攻击和推理攻击）。网络侦察(Reconnaissance)就是是访问聚合攻
击，结合多种工具来识别系统的多个元素，如 IP 地址、开放端口、运行服务、操作系统等等。
应结合严格访问控制、“需知”和最小特权原则来预防聚合攻击。
2.密码攻击 Password Attacks
破了管理员密码或特权密码，也就得到了一切。所以很多单位都要求必须设置“强密码”。
①字典攻击 Dictionary Attacks
密码攻击的一种，比暴力破解快此地，但必须要有好的字典。此外，字典式攻击经常会扫
描差别构建式密码。一个差别构建式密码是之前使用过的密码，但有一个字符的不同。例如，
passwordl 是 password 更改一个字符后的密码，其它的如 Password、lpassword 和 passXword
也是。攻击者在生成彩虹表时经常使用这种方法。
②暴力攻击 Brute-Force Attacks
密码攻击的一种，通过尝试所有可能的字母、数字和符号组合来发现用户帐户的密码。密
码越长，计算量就越大。还有一种常用的方法是：散列值匹配查找。因为密码都不会在网络上
发送，传输和存储的都是其散列值，所以只要能找到 1 个散列冲突（碰撞）collision，就可
以实现登陆破解了。要破解散列值，就要用到生日悖论和彩虹表了。
③生日攻击 Birthday Attack
第三域 I.8 章节已经讲过生日悖论了。如果把 23 个人关在一个房间，那么任何两人同一
天生日的可能性有 50%；如果有 367 人在一个房间里，你会有 100%的机会获得至少两个有相同
生日的人。MD5 已经被破解了，SHA-3 目前还是安全的。
④彩虹表攻击 Rainbow Table Attacks
彩虹表预先计算好的各种字符串和散列值的映射数据库。使用 4 种字符类型的 14 位字符
长度的密码的散列的彩虹表大约是 7.5GB 大小。这不大吧，可以大幅加快密码破解速度。
许多系统一般通过“加盐”密码来减少彩虹表攻击的有效性。盐是一组随机位，在散列前
加到密码中。加密方法在散列前就加入附加位，这样随机性更大了，使攻击者更难以使用彩虹
表密码
⑤嗅探攻击 Sniffer Attacks
一个嗅探器(也称为数据包分析器或协议分析仪)是)个软件应用程序，通过网络捕捉和分
析流量。Wireshark 是一种受欢迎的协议分析器。
3.电子欺骗攻击 Spoofing Attacks/masquerading
电子欺骗(即伪装)是指假装成某物或某人等。电子欺骗的种类很多，有 IP 欺骗、邮件欺
—169—
骗、电话欺骗等等。
4.社会工程学攻击 Social Engineering Attacks
社会工程不难，但每次考试都会出几道题！社会工程就是与人斗，其乐无穷。
①网络钓鱼 Phishing
钓鱼邮件告知用户虚假信息，然后就能骗到有用的信息，或者实现木马植入。
②鱼叉式钓鱼 Spear Phishing
针对特定用户组的钓鱼方式。
③捕鲸 Whaling
捕鲸是的目标是大鱼、高层或高管。
④语音钓鱼 Vishing
纯属忽悠，就能搞定。
5.智能卡攻击 Smartcard Attacks
各种途径搞定卡的信息。
①故障生成(fault generation)攻击
攻击者通过操纵智能卡的一些环境组件(改变输入电压、时钟频率、温度波动)来引入这些
“错误”。在向智能卡引入一个错误之后，攻击者会检查某个加密函数的结果，并查看没有出
现错误时智能卡执行该函数得到的正确结果。分析这些不同的结果使得攻击者能够对加密过程
进行反向工程，井有望获得加密密钥。这种攻击也称为故障生成攻击。
②旁路攻击(side-channel attack)
是非入侵式攻击，并且用于在不利用任何形式的缺陷或弱点的情况下找出与组件运作方式
相关的敏感信息。针对智能卡的差分功率分析(differential power analysis，查看处理过程
中的功率发射)、电磁分析(electromagnetic analysis. 查看发射出的频率)和计时(完成特定
过程所需的时间)都是旁路攻击的示例。
③微区探查(microprobing)
使用针头和超声振动去除智能卡电路上的外部保护材料，随后就可以通过直接连接智能卡
的 ROM 芯片来访问和操纵其中的数据。
6.拒绝服务攻击 Denial-of-Service Attacks
很普遍了，不解释。
7.网址嫁接 Pharming
是另一种类似的攻击，它将受害者重定向至一个看似合法的、其实仍是伪造的 Web 站点。
四、访问控制的安全防护方法汇总
1.物理上要保护好、隔离好服务器等核心设备。
2.加密、散列、加盐。
3.必须使用强密码。
4.输入时要隐藏密码（用*代替）。
5.必须使用多因素认证登陆。
6.使用帐户锁定技术防止暴力破解。
—170—
7.告知用户最后一次登陆的时间、地点。
8.安全意识培训。
G.管理身份与访问供给生命周期（如供给、审查）
身份信息和访问的开通、使用的生命周期包括：帐户的创建、管理和删除等 ，这些过程
都很重要的，不然会出问题。这里讲账号的管理。
一、提供/开通/指派 Provisioning
一个新用户账户的初始创建通常被称为注册或登记。自己创建账号叫做 register；管理
员创建账号叫做 Provisioning。没什么特别的内容。
二、审查/评审 Review
检查帐户以确保不活跃的账户被禁用以及员工没有过多的特权。要重点防范两个访问控制
方面的问题：特权过度和特权蠕变。当用户拥有超过其工作任务所需的特权时就发生了特权过
度；特权蠕变是指用户账户随工作角色和工作任务的改变而逐渐积累特权（因为不再需要的特
权没有及时取消）。特权蠕变会导致特权过渡。
三、撤销 Revocation
无论员工以何种原因(包括休假)离开公司时，要及时禁用他们的用户账户。如果确定账户
不再使用即可注销。一般情况下，账户禁用 30 天后会自动注销，这依公司需求而定。
—171—
第六域 安全评估与测试（设计、执行与分析安全测试）
Chapters 2,15,18 in OSG 7
th
No Chapters in AIO 6
th
A.设计和验证评估与测试策略
一、基础知识
安全评估过程(程序)有三大主要活动：安全测试、安全评估和安全审计。
1.安全测试 Security Testing（系统功能正常）内测
安全测试能够验证安全防护的控制措施在正常运行，包括自动扫描、工具辅助渗透测试和
手动测试安全性。安全测试应该定期进行，需要关注保护组织机构的每个关键安全控件。
2.安全评估 Security Assessments（综合能力达标）内测
安全评估是对系统、应用程序或其他测试环境的综合评价。在进行安全评估的过程中，受
过培训的信息安全专家会执行风险评估以识别受测环境的漏洞，由此可根据需要做出折衷处理
和提出修复建议。安全评估通常包括使用安全测试工具，但不只是自动扫描和手动渗透测试。
他们还包括彻底审核威胁环境，当前和未来风险以及目标环境的价值。安全性评估的最终成果
产品是一份用于管理的评估报告，这份报告以非技术性的语言描述了评估结果，并且以具体建
议作为结论，从而提高被测环境的安全性。
3.安全审计 Security Audits（安全管控有效）对外
安全审计会使用与安全评估期间相同的许多技术，但必须由独立的审计员执行。评估和测
试结果仅供内部使用，旨在评估控制以求发现需要改进之处。从另一方面来说，审计就是评估，
目的是向第三方展示控制的有效性。为机构设计、实施和监测控制的员工在评估这些控制有效
性时存在固有的利益冲突。审计员对安全控件状态做出的评判应公正、无偏见。他们编写的报
告与安全性评估报告非常类似，但这些报告的阅读对象不同，可能是机构的董事会、政府的监
管人员和其他第三方。审计的类型主要有两种：内部审计和外部审计。
4.漏洞评估/漏洞测试 Vulnerability Assessments
漏洞扫描和渗透测试为安全专家提供的视角是系统或应用技术控制的弱点。从术语角度更
清晰的解释是，漏洞评估其实就是安全性测试工具，而非安全性评估工具。为保持语言的一致
性，它们应该被称为漏洞测试。
二、有关角色
就 3 种角色是比较重要的，搞清楚它们的职能作用就行了。
1.系统工程师和安全专家的角色
系统工程师和安全专家应当与赞助商共同来创建或论证测试和评估战略。他们可能被要要
求提出用来管理风险的测试和评估方法，也可以监控测试和评估过程，如有需要，提出改进建
议。他们也应当论证测试计划和流程。有时，他们会作为测试团队的顾问帮助指定相关的计划