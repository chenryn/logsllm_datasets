其中，攻击获利最大的是以 0x820d 地址为首的团队。他们累计获利超过 5000 个以太币。AnChain.ai
团队和安比（SECBIT）实验室将该黑客团伙精确定位，并将其命名为 BAPT-LW20 (Blockchain APT – Last Winner)。
BAPT-LW20 团队在短短 6 天时间内，共发送将近 5 万笔交易，从中攫取 5194 个 Ether，获利价值将近 1200 万人民币。
由下图每小时发起的 **攻击交易数量趋势图** （下图），我们可以看出攻击的高峰期发生在 8 月 8 日 ～ 10 日，每小时平均攫取将近 100
以太币，将近 22 万人民币。这正好也是 LW 游戏最火爆的时间段。随着游戏进入后期，入场资金急剧下降，收益降低，黑客也不得不也降低了攻击频率。
 每小时发起的攻击交易数量
再看看 **黑客每小时攫取以太币数量趋势图** （下图）。惨淡的漫漫熊市里，黑客却在狂赚以太币。
下图是“Last Winner 中黑客的交易量占比和攫取 ETH 占比”，可见黑客发送的交易量只占总交易量的 9.877%，但是去攫取了Last
Winner奖金池中49%的奖金。黑客的娴熟攻击技能，为他们带来了普通玩家难以企及的好运，而普通玩家在这场游戏里面几乎很难获得空投奖励。
### 九、火线追凶、BAPT-LW20 团队攻击 LW 始末
安比（SECBIT）实验室尝试追踪复原 BAPT-LW20 团队攻击时间线。
下图是 BAPT-LW20 团队某账户余额变动情况。
0x820d 是 BAPT-LW20 团队所有攻击合约的部署者，也是攻击的实施者之一，可认为是 BAPT-LW20 团队的队长。0x820d 地址最早活跃于
**7 月 20 日** ，账户中的初始以太币均由 0x73B6 地址转入。而 0x73B6
也是同一天开始活跃的新地址，它的初始以太币来自总部位于美国旧金山的 Kraken 交易所。
0x820d 在收到来自 0x73B6 的 10 个以太币后，随即部署了它的第一个合约。可能有些地方不太理想，他并没有继续使用该合约。 **三分钟后**
，0x820d 部署下了第二个合约，攻击对象是 Fomo3D。在一组准备工作设置、若干次失败的调用以及两次虽然成功但却没有收益的尝试过后，0x820d
应该是发现了攻击合约里的 bug 和优化空间。
在接下来的 **14 个小时内** ，他依次部署了 8 个合约进行攻击测试，无奈都不成功。终于在第 9 个合约 0xBad7 中首次完成攻击，以 0.1
ETH 的投入换回了 0.125 ETH。
0xBad7 是 0x820d 团队首个可以正常工作的攻击合约，他们在 7 月 21 日至 7 月 23 日三天时间内总计调用该合约 11551
次，小有斩获。
7 月 23 日，0x820d 又部署了新的合约，将攻击对象转移为另一款 Fomo3D 山寨游戏老鼠会 RatScam
(0x5167350d082c9ec48ed6fd4c694dea7361269705)，0x820d 团队在一天时间内使用了 2299 次攻击合约。
一天后，0x820d 又找到了新目标，一个名为 FoMoGame（0x86D179c28cCeb120Cd3f64930Cf1820a88B77D60）
的山寨游戏，部署新合约（0xb599）进行攻击。这款游戏知名度不高，入场资金并不多，黑客调用了 126 次之后就放弃。
接下来的三天内，0x820d 前后部署了 10 个新合约进行优化与攻击测试。
终于，在 7 月 26 日上线了他们的新版攻击合约（0x5483）。该合约总共发生过 23835 笔交易，最近一次活跃时间在 8 月 10 号（7
天前）。这款攻击合约，可由攻击者 **自定义受害游戏合约地址** 。因此 0x820d 在接下来的几天内， **持续混合攻击 Fomo3D
原版、RatScam、FoMoGame 等游戏，并持续观察其他山寨游戏的动态，等待时机** 。同时，继续部署若干个新合约进行调优测试。
终于，8 月 6 日 Last Winner 游戏上线，24 小时后 0x820d 团队就使用准备好的 0x5483 合约，针对 Last Winner
发起第一次攻击，并在接下来的 4 天内集中力量，疯狂利用空投漏洞展开攻势。
8 月 10 日，0x820d 调用 0x5483 攻击合约 withdraw 接口，提走了里面的余额，攻击疑似暂停。
原来，他们早已经部署了新版合约攻击合约 0x9C10，又发起了超过 30000 笔交易，至今仍在活跃攻击。
### 十、不仅仅是空投：BAPT-LW20 黑客团队拿走 LW 最终大奖
北京时间 8 月 17 日上午，Last Winner 游戏第一轮最终结束，最终大奖由 0x5167 地址获得，奖金额总计 7,754 以太币。
而这个地址正是 BAPT-LW20 黑客团队的五个地址之一。
如下图，14
小时前，黑客还在利用攻击合约获取空投奖励。随后，他改变了方案，直接用自身地址购买道具参与游戏，不断尝试夺取最终大奖。在此之后，又继续调用合约攻击 LW
游戏。
安比（SECBIT）实验室猜测黑客潜伏很久，早已做好充分的准备，长时间利用脚本监控 LW 游戏状态，最终才能在众人放松警惕之时获得大奖。
**BAPT-LW20 黑客团队利用空投漏洞获利超 5,194 Ether，同时又夺取最终大奖 7,754 Ether，累计获利 12,948
Ether。**
### 十一、同行相杀：Zethr 团队两天时间就成功利用漏洞
这场超大规模的类 Fomo3D 智能合约游戏被攻击事件，攻击者使用的秘密武器也正是智能合约。
据安比（SECBIT）实验室调查分析，0x20C9 地址最先成功利用原版 Fomo3D 空投漏洞并获取奖励。我们将他定位，并将其命名为 BAPT-LW10。
0x20C9 于 7 月 8 日 10 点 07 分创建了攻击合约 0xe7ce，在接下来的十分钟内，前后调用了三次，最终在第四次时成功获得奖励，投入
0.1 以太币，收回 0.19 个，回报率高达 90%（见下图）。
此后，0x20C9 继续部署多个攻击合约，进行调试优化。最终，在 7 月 23 日部署了最终版本 0x39ac 攻击合约，接下来的时间前后调用过 90
余次，而攻击对象涉及 Fomo3D 原版、Last Winner 以及其他山寨版 Fomo3D。
据我们观察，0x20C9 是最早研究并成功利用空投漏洞的黑客。研究过程中，安比（SECBIT）实验室发现 0x20C9 与另一款游戏 Zethr 密切关联。
最终我们在 Zethr 游戏合约代码中发现了他的身影。他是热门游戏 **Zethr** 的八位核心开发者之一，代号为 **Etherguy** 。
显然，作为 DApp 游戏开发同行，Etherguy 以及他所在的 Zethr 团队很早就研究了 Fomo3D 项目代码。Fomo3D 合约 7 月 6
日部署上主网，Etherguy **两天后就发现并成功利用了漏洞** 。从调用规模来看，Etherguy (BAPT-LW10)
应该主要还是出于研究目的，并没有太多获利。
让其他黑客获利最多的正是 Last Winner 游戏。
### 十二、游戏细节：Last Winner 为何让黑客如此疯狂
从最初 Fomo3D
上线后不久，空投漏洞就已被人发现并成功利用。随着游戏的广泛传播，以及该漏洞被逐渐披露，空投漏洞的攻击手段也在这一过程中不断升级进化，最终部分黑客团队完成了精巧的攻击方案，可低成本、高效率获得奖励，并可大规模工程化地攻击任意任何同类游戏合约，疯狂收割以太币。
据安比（SECBIT）实验室分析，除 LW 游戏以外，不少黑客团队都曾尝试攻击其他类 Fomo3D 游戏合约。但获利都远小于 BAPT-LW20 团队在
LW 游戏中所得。
我们试图从 LW 游戏本身寻找答案。
LW 游戏是 Fomo3D 山寨版，本身没有太多创新，但入场资金完全集中在游戏开始后的第 2 天至第 5
天内。巨量入场资金，会让游戏空投奖池迅速累积，因此这段时间也是黑客攻击的黄金时机。
更要命的是，Last Winner 团队修改了空投游戏参数，使进入副奖池（空投奖池）的以太币比例 **由 1% 调整到 10%** ，相当于空投奖励金高了
10 倍！
一方面，游戏运营团队可能是利用高额空投奖励吸引用户疯狂加入；另一方面，他们可能并不知道空投漏洞的严重性，而提高奖励比例则会让该问题进一步放大。
**Last Winner 游戏简直成为了黑客的提款机！**
特别地，前面提到 Last Winner 游戏第一轮入场资金已达 10 万以太币，这也就是说，单单这一款游戏就有超过 1
万个以太币都持续暴露在被攻击的风险下，成为黑客的囊中之物。要知道，这款游戏第一轮最终奖池也才 1.6
万余以太币。本来空投奖励都是很小的金额，但黑客持续利用空投漏洞，积少成多，终成 Last Winner 最大赢家。
我们追踪到有多个团队对 Fomo3D 及山寨合约开展大规模自动化攻击，企图攫取利益。
而 BAPT-LW20 团队在游戏开始后 24 小时左右就加入了战局，并迅速扩大作战规模，最终占得先机，获取巨额收益。
安比（SECBIT）实验室追踪到还有其他黑客团队向 Last Winner 合约开展攻击。部分黑客 8 月 11
号以后才入局，虽规模也很大，但终究因为错过黄金时机而获利较少。
### 十三、攻击合约：设计复杂又精巧
攻击合约 0x5483，创建于 7 月 26 日，创建者为 0x820D，同时也是持续调用攻击合约的五个地址之一。
起初，攻击合约的创建时间让我们感到疑惑，前面提到 LW 游戏合约于 8 月 6 日才部署上主网。难道 0x820D
可以未卜先知，或者他与项目方有什么不可告人的秘密？
带着这个疑问，我们尝试从合约 0x5483 的代码（字节码）中寻找答案。
经过逆向发现，该合约有七个公开函数，其中一个疑似函数名是 `withdraw(uint256)`，用于将攻击合约中积累的以太币转走。
安比（SECBIT）实验室在字节码中发现了上面提到的五个地址。原来这两个函数都会跳转到同一个内部函数，检查交易发起人是否是这五人地址之一。如果是，则可继续执行，如果不是，则提前让交易失败。
这也解释了为什么偏偏是这五个地址一直在调用攻击合约。因为他们是一个团队，合约特地为他们而设计，而其他人根本无法正常调用。