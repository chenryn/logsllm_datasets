discusses both these cases in LTE NAS standard[6]. The first case
is defined as abnormal case for TAU procedure that requires the
network to abort the TAU procedure and to process the Detach
Request message from the device. It has been stated in [6]:
“If the device receives a DETACH REQUEST message before the
tracking area updating procedure has been completed, the tracking
area updating procedure shall be aborted and the detach procedure
shall be progressed."
While progressing the detach request message, the network finds
the message has failed the integrity check. This is our second sce-
nario and the 3GPP standard requires the Detach Request message
(with cause power off) must be processed even of the message fails
the integrity check (i.e. our vulnerability 2 in Section 5.1.1). LTE
NAS specification states [6]:
“The procedure is completed when the network receives the DE-
TACH REQUEST message. On reception of a DETACH REQUEST mes-
sage indicating “switch off", the MME shall delete the current EPS
security context."
We must point out that this special case only applies to Detach
Request with reason power-off, otherwise, the network proceeds
with the tracking area updating procedure first before progressing
the detach procedure.
No LTE service When the network receives Detach Request
message with cause power off, it re-authenticates the victim device
first and then releases the device connection by deleting device
sessions and freeing its IP address. The device (being unaware
of its network registration has terminated) sends Service Request
message (when it has some data to send or call to initiate). On
receiving the Service Request message from the victim device, the
core network rejects the request with error cause #43 (Invalid EPS
bearer identity). On receiving the Service Reject message with error
cause #43, the device enters into deregistered state, according to
3GPP NAS specification[6] that states:
“The UE shall abort any ongoing ESM procedure related to the
received EPS bearer identity, stop any related timer, and deactivate
the corresponding EPS bearer context locally (without peer to peer
signalling between the UE and the MME)."
Now the victim needs to manually register the device with net-
work (by rebooting device or by turning on/off the device airplane
mode), otherwise LTE service remains unavailable.
6 DISCUSSION
We put forward remedies to the key reinstallation attacks and dis-
cuss security analysis of the proposed remedies.
6.1 Proposed Remedies
In this section, we suggest our LTE standard compliant remedies
to address the discussed vulnerabilities and attacks.
1. Bounding key installation and count reset procedures:
One of the root causes of control-plane attacks is the disjoint exe-
cution of key installation and count reset procedures. To address
this, we bound LTE NAS Authentication (that installs the key),
and NAS Security Mode Command (that resets count) procedures.
That is, we perform LTE Authentication procedure whenever Secu-
rity Mode Command procedure fails (making security procedures
atomic). In LTE Authentication procedure, the network sends Au-
thentication Request message by starting timer T3460 (default value
of 6s). The timer is stopped when the network receives Authen-
tication Response message from the device. In our solution, we
stop T3460 when the network receives Security Mode Complete
message from the device instead of stopping at Authentication Re-
sponse. It means, the Authentication procedure fails if the device
Security Mode Command procedure fails; hence bounding these
two procedures. Our approach addresses vulnerability 1 where we
132884On Key Reinstallation Attacks over 4G LTE Control-Plane: Feasibility and Negative Impact
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
make key installation and count reset procedures atomic; i.e. either
both succeed or none .
2. Enforcing integrity protection for all signaling mes-
sages once security has been established: The other root cause
of control-plane attacks is that certain messages (i.e. TAU and De-
tach Request) are partially accepted even if their integrity check
fails. Although, the network authenticate the device afterwards
but does not validate whether the received signaling message was
indeed originated by the authenticated device or not. We mitigate
this vulnerability by enabling the device to not accept any signaling
messages failing the integrity check if the security association has
already been established. Instead the network rejects the message
and re-authenticates the device. We should point out that present
3GPP specifications generate integrity failure message response
for selected signaling procedures. To provide the integrity check
failure feedback for all types of signaling messages, we propose that
the network should reject the signaling message with error cause
# 9 (UE identity cannot be derived by the network). On receiving
this error message, the device re-registers with the network after
executing both authentication and security mode procedures. Our
standard compliant solution may arguable delay LTE service for a
couple of seconds, but it enforces LTE security at all times; hence
mitigating vulnerability 2 in which message failing the integrity is
always re-executed.
6.2 Security Analysis through Prototyping
We provide the security analysis of our proposal by developing a
proof of concept prototype without creating interaction between
victim and attacker. We use AT commands to take certain actions
emulating the network enforcing above principles to mitigate vul-
nerabilities 1 to 3. Although there exists hundreds of AT commands,
only few have privilege to execute over commercial handsets. We
create our prototype by using those AT commands which our pro-
gram can execute over commercial phones (such as Google Pixel
or Samsung Glaxy devices).
In our experiment, we check whether the subscriber device is un-
der jamming attack or not. If the signals are jammed to launch
key reinstallation attacks by resetting counts, we re-activate LTE
bearers that re-establish the security by renewing key. When the
device makes a voice call through CSFB, our program checks for
LTE registration by running “at+creg?" and “at+cgdcont?" com-
mands. “at+creg?" tells whether the device is PLMN registered and
if true then whether it is registered with LTE network or not. The
“at+cgdcont?" outputs the IP and APN name that explains with
which cellular radio access technology the device has camped-on.
For example, fast.tmobile.com tells the device is registered with LTE
APN over T-mobile carrier network. Thereafter, our program sends
“at+cgdata=“PPP", 1" command to establish the data connection with
the network. If the data request is not entertained, the device AT
command returns error. It means the device data connection request
has failed due to jamming. On receiving the error message, our pro-
gram waits for 2 seconds before running “at+cgdata" command
again. If the error persists then our approach is to renew the key
by re-activating LTE service. We run “at+cops=2" immediately fol-
lowed by “at+cops=0,1" to force the device to reselect LTE network
and perform re-authentication procedure.
7 RELATED WORK
We compare our related work with (1) key reinstallation attacks,
and (2) LTE security.
Key reinstallation attacks: [28] has discussed key reinstalla-
tion attack on voice over LTE and fail to decrypt LTE signaling
messages. [28] has shown the feasibility of the attack arising from
LTE bearer assignment with IMS. In contrast, we have demon-
strated the key reinstallation on control plane. Closest to our work
is key reinstallation attack in WiFi[11, 32, 35]. Mathy and et al. [35]
has recently shown a variant of key reinstallation attack in WiFi
signaling plane. Their work exposes design and implementation
issues in WiFi security protocols that reinstall an already-in-use key.
[11] discusses passive and active attacks due to keystream reuses
in WEP. [32] shows key recovery attack on WEP. In contrast, our
work although in the similar direction is different than all above
works. We show key reinstallation attacks in LTE control plane,
even though LTE never reuses the same key (all keys are chained
in forward direction), employs separate keys and counters for en-
cryption and integrity protection.
Other works related to key reinstallation attacks are count re-
set due to power failure[40]; use of static counter due to imple-
mentation bugs[10]; faulty state machine transitions leading to
count resets[9, 12]; count resets through routing protocols[8]; and
side channel attacks on CBC mode with a block cipher[36]. Con-
trary to these works our work study LTE design flaws that resets
counter values welcoming key-reinstallation attacks. Our attacks
are neither implementation bugs nor brought due to careless de-
sign choices. We show that seemingly working security proto-
cols have security loopholes when certain signaling messages are
re-transmitted.
LTE security: A number of other works discuss LTE security
issues. [14, 27, 29] conduct LTE protocol vulnerability analysis
and show real impacts on LTE subscribers. LTEInspector[14] tool
cannot detect key reinstallation vulnerabilities mainly because re-
transmission of lost message is a valid behavior of every protocol
and it is hard to automate impact of these lost messages over LTE
security. LTEInspector[14] findings on detach request with IMSI are
different than what we disclosed in this paper. [27] discusses LTE
inter-protocol vulnerabilities in which the adversary can spoof LTE
messages. Their attacks were not practical because the network
rejects the attacker originated message (as C-RNTI and TMSI do
not match). [29] shows the MitM attacks to exploit LTE layer two
vulnerabilities. Attacks discussed in [29] are mostly passive in na-
ture that map device activities and perform website fingerprinting.
In contrast, in this paper, we present novel attacks in LTE and make
them practical through key stream reuse.
Other works such as [13] shows that LTE temporary identity can
disclose subscriber location. [30] unveils that signaling informa-
tion can be leveraged to infer user privacy. [26] shows that cur-
rent cellular infrastructures exhibit security loopholes due to their
NAT/firewall settings. [24, 25] study insecurity in mobile data charg-
ing. [17, 18] discuss how a subscriber can inject control-plane
traffic into user-plane. Different to all above works, we do not
discuss vulnerabilities due to misconfigurations or implementation
bugs.
885ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Muhammad Taqi Raza, Yunqi Guo, Songwu Lu, and Fatima Muhammad Anwar
8 CONCLUSION
This is the first work to best of our knowledge that shows key
reinstallation attacks in LTE control plane. The re-transmission of
certain signaling messages resets the counter values multiple times
that lead to reuse of key stream block for ciphering of plain text
messages. In consequence, the attacker can launch attacks on LTE
control plane where he can hijack LTE location update procedure,
and can de-register the victim device from the network.
ACKNOWLEDGMENTS
We thank anonymous reviewers for providing excellent feedback.
This work was partially funded by NSF grant number 2051621.
REFERENCES
[1] [n.d.]. IntelliJudge: WaveJudge LTE packets sniffer.
http://www.sanjole.com/our-products/intellijudge-lte/.
[2] [n.d.]. QPST— Qualcomm service programmer tool.
https://github.com/botletics/SIM7000-LTE-Shield/tree/master/SIM7000%20Do
cumentation/Firmware%20Updater%20Tool/QPST%20Tool.
[3] [n.d.]. QXDM– LTE packets capturing tool.
[4] [n.d.].
Tera-Term-A
http://ttssh2.sourceforge.jp/index.html.en.
[5] [n.d.]. ThinkRF: Real-Time Spectrum Analyzer.
Terminal
Emulator.
https://www.thinkrf .com/real-time-spectrum-analyzers/.
[6] 3GPP. 2016. TS24.301: Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3. http://www.3gpp.org/ftp/Specs/html-info/24301.htm
[7] 3GPP. 2016. TS33.401: 3GPP SAE; Security architecture.
[8] pages=78–92 year=2011 organization=Springer Aumasson, Jean-Philippe et al.,
booktitle=International Conference on Information and Communications Secu-
rity. [n.d.]. A note on a privacy-preserving distance-bounding protocol.
[9] Beurdouche, Benjamin and et al. [n.d.]. A messy state of the union: Taming the
composite state machines of TLS. In IEEE Security and Privacy, year=2015.
[10] Böck, Hanno and et al. 2016. Nonce-Disrespecting Adversaries: Practical Forgery
Attacks on GCM in TLS. IACR Cryptology ePrint Archive 2016 (2016), 475.
[11] Borisov, Nikita and Goldberg, Ian and Wagner, David. 2001. Intercepting mobile
communications: the insecurity of 802.11. In ACM Mobicom.
[12] De Ruiter, Joeri and Poll, Erik. 2015. Protocol State Fuzzing of TLS Implementa-
tions.. In USENIX Security Symposium.
[13] Hong, Byeongdo and et al. 2018. GUTI Reallocation Demystified: Cellular Loca-
tion Tracking with Changing Temporary Identifier. (2018).
[14] Hussain, Syed Rafiul and et al. 2018. LTEInspector: A Systematic Approach for
Adversarial Testing of 4G LTE. In NDSS.
[15] Kahn, David. 1996. The codebreakers. New York, NY: Scribner (1996).
[16] Karlof, Chris and Sastry, Naveen and Wagner, David. 2004. TinySec: a link layer
security architecture for wireless sensor networks. In ACM SenSys.
[17] Kim, Hongil and et al. 2015. Breaking and fixing volte: Exploiting hidden data
channels and mis-implementations. In ACM CCS.
[18] Li, Chi-Yu and et al. 2015.
Insecurity of voice solution volte in LTE mobile
[19] Lichtman, Marc and et al. 2014. Detection and mitigation of uplink control
networks. In ACM CCS.
channel jamming in LTE. In IEEE Milcom.
[20] Lichtman, Marc and et al. 2016. LTE/LTE-a jamming, spoofing, and sniffing:
threat assessment and mitigation. IEEE Communications Magazine 54, 4 (2016),
54–61.
[21] Mason, Joshua and et al. 2006. A natural language approach to automated
cryptanalysis of two-time pads. In ACM CCS.
[22] MM, Galib Asadullah. 2008. Robust wireless communications under co-channel
interference and jamming. Ph.D. Dissertation. Georgia Institute of Technology,
PhD thesis.
[23] Naseef, M. 2014. Vulnerabilities of LTE and LTE-Advanced Communication
White Paper. (2014).
[24] Peng, Chunyi and et al. 2012. Mobile data charging: new attacks and counter-
[25] Peng, Chunyi and et al. 2014. Real threats to your data bills: Security loopholes
measures. In ACM CCS.
and defenses in mobile data charging. In ACM CCS.
[26] Qian, Zhiyun and Mao, Z Morley. [n.d.]. Off-path TCP sequence number inference
attack-how firewall middleboxes reduce security. In IEEE S&P.
[27] Raza, Muhammad Taqi and et al. 2017. Exposing LTE Security Weaknesses at
Protocol Inter-layer, and Inter-radio Interactions. In SecureComm.
[28] David Rupprecht, Katharina Kohls, Thorsten Holz, and Christina Pöpper. 2020.
Call Me Maybe: Eavesdropping Encrypted {LTE} Calls With ReVoLTE. In 29th
{USENIX} Security Symposium ({USENIX} Security 20). 73–88.
[29] Rupprecht, David and et al. 2018. Breaking LTE on Layer Two. In IEEE S&P.
[30] Shaik, Altaf and et al. 2015. Practical attacks against privacy and availability in
4G/LTE mobile communication systems. (2015).
[31] Shannon, CE. 1948. (1948), “A Mathematical Theory of Communication", Bell
System Technical Journal, vol. 27, pp. 379-423 & 623-656, July & October. (1948).
[32] Stubblefield, Adam and et al. 2004. A key recovery attack on the 802.11 b wired
equivalent privacy protocol (WEP). ACM transactions on information and system
security (TISSEC) 7, 2 (2004), 319–332.
[33] Tu, Guan-Hua and et al. 2013. How voice calls affect data in operational LTE
networks. In ACM MobiCom.
[34] Tu, Guan-Hua and et al. 2016. Detecting problematic control-plane protocol
interactions in mobile networks. IEEE/ACM Transactions on Networking 24, 2
(2016), 1209–1222.
nonce reuse in WPA2. In ACM CCS.
[35] Vanhoef, Mathy and Piessens, Frank. 2017. Key reinstallation attacks: Forcing
[36] Vaudenay, Serge. 2002. Security Flaws Induced by CBC Padding—Applications to
SSL, IPSEC, WTLS.... In International Conference on the Theory and Applications
of Cryptographic Techniques. Springer, 534–545.
[37] Vernam, Gilbert Sandford. [n.d.]. Secret signaling system (U, 1919). U.S. Patent
131071 ([n. d.]).
[38] Yan, Qiben and et al. 2014. MIMO-based jamming resilient communication in
wireless networks. In IEEE Infocom .
[39] Zeng, Huacheng and et al. 2017. Enabling jamming-resistant communications in
[40] Zenner, Erik. 2009. Nonce generators and the nonce reset problem. In International
wireless MIMO networks. In IEEE CNS.
Conference on Information Security. Springer, 411–426.
886