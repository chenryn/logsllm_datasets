S.P. Chung and A.K. Mok
(e.g. with both SYN and URG set). Since these requests are dropped or rejected
by most networks, they will be considered failure by Autograph. Thus our drones
will be classiﬁed as scanners with very few packets sent. This latter technique is
actually employed in our experiments.
After being classiﬁed as a scanner, each drone will proceed with the second
stage where crafted attack packets are sent to the target network over successful
TCP connections. If no parts of the target request are blacklisted, we can simply
put the entire target request in our attack packets. Since the experiments in [4]
show that Autograph has very low false positives, we believe it is very unlikely for
any part of the target request to be blacklisted. In other word, our simple allergy
attack will succeed most of the time.
Nonetheless, let us consider the worst case scenario where all content blocks
from the target request are blacklisted in the training phase. This will thwart
the simple attack described above. However, this obstacle is circumventable.
An important observation is that the target request is always partitioned in its
entirety during the training phase, and this always results in the same set of
content blocks. New content blocks that are not blacklisted may be generated if
a fragmented target request is partitioned by COPP. For example, let the target
request be the byte sequence b0b1b2...bi−2bi−1bibi+1...bn, with n − i > m and
i − 1 > m. Suppose bi is the last byte of the ﬁrst content block generated by
COPP. If the byte sequence bi−2bi−1bibi+1...bn is presented to COPP, a content
block starting with bi−2 will be generated. Since Autograph is not producing
blocks of less than m bytes, the block will continue at bi. More importantly,
though this new content block contains bytes from two blacklisted blocks (the
one starting from b1 and bi+1 respectively), it is a substring to neither. As a
result, the allergy attack against the target request will be successful if we use
bi−2bi−1bi...bn in our attack packets. Another point worth noting is that, the
above strategy will remain eﬀective even if requests similar to our target are
also blacklisted. This is because these similar requests will result in mostly the
same set of content blocks being blacklisted, due to the content-based nature of
COPP.
Without knowing the conﬁgurations of the COPP (e.g. m, a, and B), we do
not know where the boundaries of content blocks lie when the target request is
partitioned in the training phase. In other word, we do not know exactly which
fragmented target request will result in content blocks that overlap two adja-
cent blocks in the original partition. Nonetheless, we can approximate the above
strategy by using random, ﬁxed-length subsequences of the target request. With
suﬃcient trails, some of these subsequences will result in new, non-blacklisted
content blocks, and achieve our goal. Note that by using ﬁxed-length subse-
quences with random starting points instead of random suﬃxes of the target
request, we vary the last bytes of the various suspicious ﬂows partitioned, and
improve our chance of success. This is because COPP usually generates a con-
tent block with the last m bytes of the ﬂow partitioned (unless the last content
block ends exactly at the end of the ﬂow).
Allergy Attack Against Automatic Signature Generation
67
Based on the above observations, the concrete design of the second step of our
attack is as follow: we will divide our attack into diﬀerent rounds, and in each
round, all drones will pick the same NUM SEQ random subsequences of length
SEQ LEN from the target request. This can be achieved by synchronizing all
drones to start the round at roughly the same time (with synchronization error
of up to a few minutes), and use the same seed for the same random number gen-
erator. Each drone will then send each chosen subsequence to the target network
over NUM REP connections destined at the target port. Each drone will start
the next round of attack t minutes after the completion of the previous round.
This is to make sure that the suspicious ﬂows from the previous round have ex-
pired (i.e. removed from the suspicious pool). Obviously, a larger NUM SEQ will
reduce the number of rounds needed to achieve a successful attack. For our ex-
periments, we use two drones, with NUM SEQ=30, and NUM REP=50. We em-
phasize that we use such a small number of drones only to ease our experiments,
we don’t see any technical diﬃculties in a 10-fold or even a 100-fold increase in
the nubmer of drones. As for the value of SEQ LEN, a proper choice of SEQ LEN
will signiﬁcantly improve our chance of success. However, since the best value of
SEQ LEN depends on the unknown a and m of the attacked Autograph system,
a trial-and-error process over multiple rounds is necessary. Nonetheless, our ex-
periments show that for all reasonable values of a and m, it is very likely for the
attack to succeed in just one round with SEQ LEN being 80 to 160. Finally, the
choice of t will depend on the t thresh parameter of Autograph. With the default
value of t thresh being 30 mins, we can safely assume the actual value being less
than 90 minutes, since a t thresh value higher than 90 minutes can lead to a
prohibitively large suspicious pool (a similar argument appears in [11]).
4.2 Experiments
To demonstrate the eﬀectiveness of our attack, we have tested it against Auto-
graph for the HTTP requests to the following three webpages:
1. http://www.cs.utexas.edu
2. http://www.cs.utexas.edu/users/mok
3. http://www.cs.utexas.edu/users/mok/cs372/Fall05/projects/lab1/
index.html
We generate the target requests with internet explorer (IE). For each target
request, we pick a set of 10 seeds for generating the random subsequences in 10
diﬀerent rounds of attack. The same 10 seeds are then used for the experiments
with SEQ LEN at 40, 80, 120 and 160. This allows us to compare the eﬀectiveness
of our attack at diﬀerent SEQ LEN without being aﬀected by the randomness
in the seeds used. The eﬀectiveness of our attack is measured by the average
number of distinct signatures generated for each of the 10 rounds under the same
SEQ LEN2. Finally, to test how the diﬀerent conﬁgurations of Autograph aﬀect
2 Even though any single signature generated will completely block out the target
request, we believe the number of signatures generated will reﬂect the robustness of
our attacks for diﬀerent targets.
68
S.P. Chung and A.K. Mok
the eﬀectiveness of our attacks, we repeat our experiments at diﬀerent values of a
(with a=16, 32, 64, and 128) and m (with m=16, 32, and 64), which is basically
the range for a and m tested in [4]. For the other parameters of Autograph,
we simply use the default values. We choose to focus our experiments on a and
m because these two parameters have the most impact on the success of our
experiments.
A point worth noting is that our attack is speciﬁc to the web browser used. In
other word, the signatures generated will mostly ﬁlter out requests from IE only.
Other web browsers (e.g. Mozilla) are thus unaﬀected. Nonetheless, a determined
attacker can launch a separate attack for each popular web browser. Since the
market is mainly dominated by a few web browsers, we believe this is not a
major undertaking.
Instead of installing Autograph to monitor real traﬃc crossing an edge net-
work’s DMZ, we choose to perform our experiments oﬄine by feeding Autograph
with traﬃc traces captured separately at the two drones used. This will expose
Autograph to exactly the attack traﬃc originating from the drones, as well as the
reply from the attacked network that Autograph is supposed to be protecting,
while ignoring all other traﬃc to/from the drones. As a result, we are presenting
to Autograph only the “slice” of traﬃc that is relevant to our attack. This ap-
proach greatly simpliﬁes our work, and allows us to test the same attack traﬃc
under diﬀerent conﬁgurations of Autograph.
A disadvantage of the above approach is that it prevents us from studying
the eﬀect of the background noise to our attack. For background noise, we are
referring to the scanning activities that happen constantly on the internet, as
well as small-scale worm outbreaks over the world. The eﬀect of these events
is mainly to populate the suspicious pool of Autograph with ﬂows other than
those from our attack. Nonetheless, we believe we can easily make content blocks
from these ﬂows an insigniﬁcant portion of the suspicious pool. By increasing
NUM REP to 200 and having 20 drones instead of 2, we can almost guarantee
that content blocks from our attack packets will be suﬃciently prevalent to
be used as new signatures (each will have 4000 copies in the suspicious pool).
Furthermore, even with the higher NUM REP and increased number of drones,
we believe our attack is still entirely feasible.
Finally, to validate the claim that our attack will remain eﬀective even if the
target requests and some related requests are blacklisted during the training
phase, we populate the blacklist with all content blocks from the three target
requests as well as the requests for the following 5 related pages:
1. http://www.cs.utexas.edu/users
2. http://www.cs.utexas.edu/users/mok/cs372
3. http://www.cs.utexas.edu/users/mok/cs372/Fall05
4. http://www.cs.utexas.edu/users/mok/cs372/Fall05/projects
5. http://www.cs.utexas.edu/users/mok/cs372/Fall05/projects/lab1
A separate blacklist is generated for each tested Autograph conﬁguration by
using the entire request to be blacklisted (instead of its subsequences) in the
Allergy Attack Against Automatic Signature Generation
69
m (minimum block size)=16
a (average block size)=32
s
e
r
u
t
a
n
g
s
f
i
o
r
e
b
m
u
n
e
g
a
r
e
v
a
s
e
r
u
t
a
n
g
s
f
i
o
r
e
b
m
u
n
e
g
a
r
e
v
a
s
e
r
u
t
a
n
g
s
f
i
o
r
e
b
m
u
n
e
g
a
r
e
v
a
 20
 18
 16
 14
 12
 10
 8
 6
 4
 2
 0
 24
 22
 20
 18
 16
 14
 12
 10
 8
 6
 4
 2
 20
 18
 16
 14
 12
 10
 8
 6
a=16
a=32
a=64
a=128
a=32
a=64
a=128
40
80
120
SEQ_LEN
160
m (minimum block size)=32
40
80
120
160
SEQ_LEN
m (minimum block size)=64
80
120
SEQ_LEN
a=64
a=128
160
s
e
r
u
t
a
n
g
s
f
i
o
r
e
b
m
u
n
e
g
a
r
e
v
a
s