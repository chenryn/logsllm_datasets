Geo-locating Drivers: A Study of Sensitive Data Leakage in Ride-Hailing Services..
In Annual Network and Distributed System Security symposium, February 2019
(NDSS 2019).
A OTHER SERVICES
Fitbit [6] is a fitness service. Its Android app is installed more than
10,000,000 times. It allows its users to record walks, hikes and runs,
share their achievements with others, participate in challenges and
earn badges as rewards for their activities. An adversary faking
activities can earn badges, win challenges and rewards. To demon-
strate Fitbit’s susceptibility to improper input injections we spoof
network requests to the Fitbit service. We were successful in post-
ing activities spoofing a real device and user account. To verify
the injection, we use the response of the spoofed requests and we
also verify manually on a real device in parallel for some randomly
chosen requests. To characterize the IIV attack surface of Fitbit we
follow the NVE approach (see Section 3), to study the successful
injection boundaries for an activity’s distance and duration. We
repeat for three activities: walk, hike and run. We found that no neg-
ative or zero values for distance or duration are allowed. Distance
can be added from 1km to 1609.344km (equivalent to 10,000 miles).
For duration we observe that there is no input data type positive
range restriction as we could inject durations from 1 second to
2,147,483,647 (which is the maximum positive value for a 32-bit
signed binary integer, or 231 − 1).
Run with Map My Run [3] is a fitness tracking service whose
Android app is also installed more than 10,000,000 times. Like other
fitness services, it allows its users to track and share activities,
participate in challenges, and earn rewards. Its challenges can be
sponsored and result in real in-kind rewards. For example, the You
VS the Year 2020 challenge asks users to “Cover 1,020KM in 2020 and
be eligible for exclusive prizes from Under Armour” [21]. Like before,
we were able to reverse engineer the service’s API and successfully
spoof network requests to the service, which appear to come from
a real device and user, and observe the result of the injection. To
characterize the adversary’s reach, we perform experiments on the
distance and duration of a running activity using the NVE strategy.
We found that the min duration that can be added is 0. For the
max value, we found that the remote service accepts an arbitrarily
large value for the duration, but this is always rounded within the
constraints of a single day. That is, if value x in seconds is stored
on the server-side, the client always renders x mod 86400. This is
alarming because any input validation happens on the client-side
while the values are stored non validated on the server. Thus, even
though we do not know whether the stored values are sanitized or
not on the server-side, this would require a lot of ad-hoc validation
checks whenever the value is to be used, which is a bad prone to
errors design. In terms of distance, we found that the min distance
accepted is 0. However, the max allowed distance for an activity
can be arbitrarily large. We were able to increase it up to 100051.4
miles, which is approximately 4 times the earth’s perimeter.
ToiFi (Toilet Finder) [11] is a location-based MCS which allows
users to find public restrooms (as PoIs) in time of need. It allows
participants to add new or edit/remove previous PoIs. Its Android
app was installed more than 50,000 times. We were successful in
both manually adding and removing PoIs at arbitrary locations. To
systematically characterize the attack surface of the service next we
use the GPS coordinates exploration strategy to discover the range
of coordinates that can be used to fake a public toilet. To conduct
the experiments we identified—through our MITM proxy—the API
the remote service exposes for receiving a request to add a PoI.
We then carefully craft network requests triggering the API, by
spoofing the mobile app and a service user. Success of the injection
is determined by spoofing a second request targeting a different
exposed API which allowed us to search for the presence of a PoI.
We found that out of bound longitudes and latitude values (CE-O)
are rejected. However, all trials on CE-Long, CE-Lat and CE-2D were
successful allowing us to inject PoIs anywhere on the surface of the
Earth. For CE-Prec, we saw that we can inject POIs up to a precision
of 7 decimal places for both longitude and latitude. Furthermore,
we noticed that there is no check preventing two points from being
too close on the map as the first round of injections went fine as it
is. Evidently, this can be exploited for fun, for example by injecting
toilets in the middle of the desert or in the middle of the ocean. It can
also be used for pranks as public toilets can be injected on a target
individual’s or enterprise’s private premises; or even for harm, as
people can be lured in dark alleys and isolated areas. We marked all
PoIs added by our experiments as non existent by spoofing another
API call we discovered so as to not harm the service or its users.
B OTHER DETAILS
Table 5 lists some representative examples of fake posts we gener-
ated with the SGP and SGA models, and accepted by NbR. Table 6
lists the number of successful injections per service and targeted
interface performed throughout our experiments.
Table 5: Examples of accepted fake text posts by NbR.
Model
SGP
Category
Safety
Fake Title
Reports of Fire
SGP
Lost Pet
Lost My Pet
SGA
Unexpected
Activity
Creeper
SGA
Crime
Stolen
ages
Pack-
Fake Description
Reports of Fire. A fire was reported
at the Victoria Inn & Suites on 16th
Febuary, 2011. The fire was extin-
guished with minimal damage to
the building. There was no water
damage.
Lost My Pet??? My dog has been
missing for a while. We have tried
searching for him, but I can’t find
him. He was a good dog, but he
was missing for a long time. I can’t
find him. Where is he? Is he in the
house?
My neighbor is a creep. He hangs
around our yard and keeps looking
for food. Last week he came back af-
ter we left and stole a can of toma-
toes.
My neighbors kids came in and
stole some packages from the front
porch. Kids about 12 and under.
They were looking for something
in a brown bag.
955Characterizing Improper Input Validation Vulnerabilities of Mobile Crowdsourcing Services
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Table 6: Number of successful input injections.
Service
Strava
Fitbit
Map My Run
Basket Savings
ToiFi (Toilet Finder)
Police Detector
Transit
Neighbors By Ring
Google Maps
Gas Buddy
No. Installations
10,000,000+
50,000,000+
10,000,000+
100,000+
50,000+
5,000,000+
5,000,000+
1,000,000+
5,000,000,000+
10,000,000+
Domain
Fitness Service
Fitness Service
Fitness Service
Pricing Service
Location-Based Service
Location-Based Service
Transportation Service
Safety Service
Transportation Service
Pricing Service
Input Injections
708
98
797
156
2728
2910
403
113
-
-
Interface
Web API
Web API
Web API
Web API
Web API
Web API
Sensor
App UI
App UI, Sensor
Sensor
C ETHICAL CONSIDERATIONS
C.1 Details on IRB Approval
We applied for an IRB at the University of Southern California
which can be verified by study-iD:IIR00003094. The following is
an excerpt from the response we received: “Therefore, this study
is considered Not Human Subjects Research* and is not subject to
45 CFR 46 regulations, including informed consent requirements
or further IRB review.”. Our study do not qualify for IRB approval
because we do not collect data through interaction with humans
and do not collect personally identifiable information.
Further details from the IRB response email are provided below:
The University Park Institutional Review Board (UPIRB) de-
signee reviewed the information you submitted pertaining to
your study and has determined on 12/10/2019 that the project
does not qualify as Human Subjects Research.
From 45 CFR 46.102, The Federal Regulations on Human Sub-
jects Research is as follows:
Human Subject: A living individual about whom an investi-
gator (whether professional or student) conducting research
obtains data through intervention or interaction with the indi-
vidual, or identifiable private information.
Research: A systematic investigation, including research de-
velopment, testing, and evaluation, designed to develop or
contribute to generalizable knowledge.
Nonetheless, we integrated various measures in the design of
our experiments’ to protect users and apps from harm. Next we
elaborate on some of those measures.
C.2 Basket Savings
The experiments were conducted after midnight when the grocery
stores are closed. Item prices were reverted to their original value
right after each experiment.
C.3 Fitbit
The added fake activities were deleted right after the experiments.
The fake accounts did not add any real people as friends on the
app to minimize interaction with actual users on the app and we
did not participate in any real challenges to win rewards from a
leaderboard.
C.4 Police Detector
The vast majority of the inserted POIs were positioned in the ocean
or away from human populations, therefore it is unlikely that people
were misled by them. We also deleted all POIs right after their
insertion to ensure that fake POIs could only be visible for a couple
of seconds.
C.5 Transit
Our experiments were performed targeting the same bus route
(18km) in a rural area. To minimize influence, we performed our
experiments during off-peak hours. Transit displays the number of
users viewing one’s contribution. In our experiments, we verified
that we only affected our observer devices and no actual user was
affected.
C.6 Neighbors by Ring
We set our location in Death Valley to limit the possible number of
inhabitants and checked that there were no activity within the app
at and around that location. We also removed the accepted posts
within 8 min of being published. Furthermore, we only interacted
with the algorithms and the service itself and collected data that is
openly available and non-identifiable.
C.7 Strava
We did not participate in any real challenges to win real rewards
from leaderboards. Furthermore, we did not add any friends on the
app which means no other user got notified or could view our fake
activities. The added fake accounts and fake activities were deleted
right after the experiments.
C.8 Map My Run
We did not participate in any real challenges to win real rewards
from leaderboards. Furthermore, we did not add any friends on the
app which means no other user got notified or could view our fake
activities. The added fake accounts and fake activities were deleted
right after the experiments.
C.9 Toifi (Toilet Finder)
The majority of the inserted POIs were located in the ocean or away
from human populations. All POIs were deleted the POIs right after
inserting which means they were only visible for a couple of seconds
at most.
C.10 Google Maps
The experiments were conducted within the university campus and
after midnight to minimize the effect on users. For the experiments,
we were physically present to ensure that there were no people
present at the time and could abort the experiment otherwise.
C.11 Gas Buddy
We reverted the prices back to normal right after changing them,
which means they were visible on the app for a couple of seconds.
All experiments took place after midnight to further minimize
potential exposure of users to the fake prices.
956