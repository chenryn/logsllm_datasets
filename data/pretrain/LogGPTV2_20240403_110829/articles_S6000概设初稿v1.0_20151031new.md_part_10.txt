[]{#_Toc430959710 .anchor}图33 数据模型-统计
具体的逻辑数据实体定义详见附录[13.2逻辑数据实体分项定义](#_逻辑数据实体分项定义)
日志标准化规范如下：
日志类型分为网络、主机、终端、应用、网络流5类。
1.  **网络**
网络日志包括网络设备、防火墙、IDS、IPS、路由器、交换机、隔离装置、接入平台，日志模型如下图所示。
![](media/image55.emf)
2.  主机
主机日志模型如下所示。
![](media/image56.emf)
3.  终端
终端包括内网桌面终端、内网移动终端、内网采集终端，日志模型如下所示。
![](media/image57.emf)
4.  应用
应用日志来源于各安全系统及业务系统，日志模型如下所示。
> ![](media/image58.emf)
5.  网络流
网络流包括原始镜像流量及netflow信息，日志模型如下所示。
![](media/image59.emf)
## 6.3数据分类 {#数据分类 .list-paragraph}
预警分析中心支撑平台数据根据业务分为日志、告警、事件、资产、情报、基线、模型、平台及统计9类数据。其中，日志、告警、事件、资产、情报、基线、模型为主数据。
表 数据分类清单
  --------------------- --------------------------------------------------------------------------------------------------------------------------------
  数据实体              数据描述
  日志                  从各设备、各安全系统收集的原始日志及网络镜像原始流量，为非结构化数据，作为日志备份存储；标准化后转为结构化数据，进行后续的分析
  告警                  通过标准化日志关联分析生成，结构化数据
  事件                  通过告警经过人工研判分析生成，结构化数据，关联处置状态
  资产                  通过I6000集成，结构化数据
  情报                  包括结构化与非结构化的情报库数据，用于预警生成和关联分析
  平台                  平台资源、运行、管理相关的数据，通过配置进行管理
  模型                  场景模型、数据标准化模型，模型对应关联分析规则，用于对数据的关联分析处理
  基线                  资产关联的配置基线数据，用于对资产脆弱性的分析和告警、预警分析
  统计                  对告警、日志、事件等指标的统计汇总，生成报表及集中展现
  --------------------- --------------------------------------------------------------------------------------------------------------------------------
其中，日志数据根据日志源类型进行分类，分为5大类，包括网络、主机、终端、应用、网络流。
## 6.4数据流转 {#数据流转 .list-paragraph}
与预警中心支撑平台存在数据流转关系的系统包括统一分析监控平台、ISS系统、I6000系统、电子商务平台、95598系统、电商平台及专业分析工具。数据流转图如下所示。
![](media/image60.emf)
[]{#_Toc358152735 .anchor}图34 数据流转图
表 数据流转清单
  ----------------------------------------------------------- ------------------ ----------------------------------
  交换数据实体                                                源系统             目标系统
  原始安全日志、软件、硬件、物理环境、网络拓扑                I6000              预警分析中心支撑平台
  原始安全日志（内网安全系统日志）                            统一分析监控平台   预警分析中心支撑平台
  原始安全日志（外网安全系统日志）                            ISS                预警分析中心支撑平台
  原始安全日志（电商平台日志）                                电商平台           预警分析中心支撑平台
  原始安全日志（电子商务平台日志）                            电子商务平台       预警分析中心支撑平台
  原始安全日志（95598日志）                                   95598系统          预警分析中心支撑平台
  原始安全日志（电商平台日志、电子商务平台日志、95598日志）   专业分析工具       预警分析中心支撑平台
  原始安全日志（支撑工具日志）                                预警中心支撑平台   专业分析工具
  ----------------------------------------------------------- ------------------ ----------------------------------
在预警分析中心支撑平台内，数据流转关系如下图所示：
![](media/image61.emf)
[]{#_Toc430959712 .anchor}图35 平台内数据流转关系
## 6.5数据存储与分布 {#数据存储与分布 .list-paragraph}
表 数据存储清单
  ----------------------------------------------------------------------------- -------------------------------------------------
  数据实体                                                                      存储系统名称
  原始安全日志、软件、硬件、物理环境、网络拓扑                                  I6000、预警分析中心支撑平台
  原始安全日志（内网安全系统日志）                                              统一分析监控平台、预警分析中心支撑平台
  原始安全日志（外网安全系统日志）                                              ISS、预警分析中心支撑平台
  原始安全日志（电商平台日志）                                                  电商平台、预警分析中心支撑平台
  原始安全日志（电子商务平台日志）                                              电子商务平台、预警分析中心支撑平台
  原始安全日志（95598日志）                                                     95598系统、预警分析中心支撑平台
  原始安全日志（电商平台日志、电子商务平台日志、95598日志、专业分析工具日志）   专业分析工具、预警分析中心支撑平台
  ----------------------------------------------------------------------------- -------------------------------------------------
表 数据分布清单
  ----------------------------------------------------------- ---------------------- ------- ------ ------------------ -------------- ---------- -------------- -----------
  数据实体                                                    预警分析中心支撑平台   I6000   ISS    统一分析监控平台   专业分析工具   电商平台   电子商务平台   95598系统
  原始安全日志、软件、硬件、物理环境、网络拓扑                C                      O                                                                          
  原始安全日志（内网安全系统日志）                            C                                     O                                                           
  原始安全日志（外网安全系统日志）                            C                              O                                                                  
  原始安全日志（电商平台日志）                                C                                                                       O                         
  原始安全日志（电子商务平台日志）                            C                                                                                  O              
  原始安全日志（95598日志）                                   C                                                                                                 O
  原始安全日志（电商平台日志、电子商务平台日志、95598日志）   O                                                        C                                        
  原始安全日志（专业分析工具）                                C                                                        O                                        
  ----------------------------------------------------------- ---------------------- ------- ------ ------------------ -------------- ---------- -------------- -----------
# 7系统组件视图
## 7.1系统逻辑分层 {#系统逻辑分层 .list-paragraph}
![](media/image62.png){width="5.304526465441819in"
height="3.5208333333333335in"}
[]{#_Toc358152736 .anchor}图36 系统逻辑分层图
表 系统逻辑分层说明
+------+-----------+-------------------------+----------+-------------+
| 逻辑 | 职责描述  | 技术实现                | 逻辑     | 层间通信    |
| 层次 |           |                         | 层次依赖 |             |
+------+-----------+-------------------------+----------+-------------+
| 展   | 接受      | 使用Fle                 | 依赖业   | 采          |
| 现层 | 用户输入  | x技术实现可视化动态图表 | 务功能层 | 用消息在展  |
|      |           |                         |          | 现层与业务  |
|      | 呈现数据  | 使用                    |          | 功能层通信  |
|      |           | SG-UAP实现管理功能展现  |          |             |
|      |           |                         |          | 层间采用    |
|      |           |                         |          | http(s)协议 |
+------+-----------+-------------------------+----------+-------------+
| 业   | 执行业务  | 采用sg-                 | 依       | 采用        |
| 务功 | 功能逻辑  | uap平台实现功能业务逻辑 | 赖分析层 | 消息总线、  |
| 能层 |           |                         |          | 数据总线进  |
|      |           |                         |          | 行业务功能  |
|      |           |                         |          | 层和分析层  |
+------+-----------+-------------------------+----------+-------------+
| 分   | 基于计算  | 调用计算层              | 依       | 采用消息总  |
| 析层 | 层的计算  | 的计算框架建立分析逻辑  | 赖计算层 | 线、分布式  |
|      | 功能对数  |                         |          | 消息队列与  |
|      | 据预处理  |                         |          | 数据层通信  |
|      | 后的数据  |                         |          |             |
|      | 进行分析  |                         |          |             |
+------+-----------+-------------------------+----------+-------------+
| 计   | 数据计    | Storm                   | 依       | 采用消息总  |
| 算层 | 算框架，  |                         | 赖数据层 | 线、分布式  |
|      | 包括流处  | Es                      |          | 消息队列与  |
|      | 理、数据  |                         |          | 数据层通信  |
|      | 挖掘、实  | Esper                   |          |             |
|      | 时索引、  |                         |          |             |
|      | 关联分析  | Mapreduce               |          |             |
+------+-----------+-------------------------+----------+-------------+
| 数   | 数据采集  | Syslog                  |          |             |
| 据层 |           |                         |          |             |
|      | 数        | Webservice              |          |             |
|      | 据预处理  |                         |          |             |
|      |           | Jms                     |          |             |
|      | 数据存储  |                         |          |             |
|      |           | Hdfs/Hbase              |          |             |
|      | 数据转发  |                         |          |             |
|      |           | Es                      |          |             |
+------+-----------+-------------------------+----------+-------------+
## 7.2组件关联设计 {#组件关联设计 .list-paragraph}
### 7.2.1 安全态势 {#安全态势 .list-paragraph}
![](media/image63.emf)
[]{#_Toc358152737 .anchor}图37 安全态势组件关联图
表 安全态势组件关联清单
+----------------+--------------+--------------------+---------------+
| 组件编号-名称  | 组件的方法   | 关                 | 关联          |
|                |              | 联的组件编号-名称  | 的组件的方法  |
+----------------+--------------+--------------------+---------------+
| 告             | 创建模型     | 模型创建组件       | 调用          |
| 警统计展示组件 |              |                    |               |
|                | 查看模型     | 模型查看组件       |               |
| 实时告         |              |                    |               |
| 警列表展示组件 | 模型验证     | 模型验证组件       |               |
|                |              |                    |               |
|                | 模型审核     | 模型审核组件       |               |
+----------------+--------------+--------------------+---------------+
| 可视           | 可视化建模   | 可视化建模组件     | 调用          |
| 化建模展示组件 |              |                    |               |
+----------------+--------------+--------------------+---------------+
### 7.2.2 场景建模 {#场景建模 .list-paragraph}
![](media/image64.emf)
[]{#_Toc430959715 .anchor}图38 场景建模组件关联图
表 场景建模组件关联清单
+----------------+--------------+--------------------+---------------+
| 组件编号-名称  | 组件的方法   | 关                 | 关联          |
|                |              | 联的组件编号-名称  | 的组件的方法  |
+----------------+--------------+--------------------+---------------+
| 场             | 创建模型     | 模型创建组件       | 调用          |
| 景建模展示组件 |              |                    |               |
|                | 查看模型     | 模型查看组件       |               |
|                |              |                    |               |
|                | 模型验证     | 模型验证组件       |               |
|                |              |                    |               |
|                | 模型审核     | 模型审核组件       |               |
+----------------+--------------+--------------------+---------------+
| 可视           | 可视化建模   | 可视化建模组件     | 调用          |
| 化建模展示组件 |              |                    |               |
+----------------+--------------+--------------------+---------------+
### 7.2.3 综合检索 {#综合检索 .list-paragraph}
![](media/image65.emf)
[]{#_Toc430959716 .anchor}图39 综合检索组件关联图
表 综合检索组件关联清单
+----------------+--------------+--------------------+---------------+
| 组件编号-名称  | 组件的方法   | 关                 | 关联          |
|                |              | 联的组件编号-名称  | 的组件的方法  |
+----------------+--------------+--------------------+---------------+
| 交互           | 查询告警     | 告警查询组件       | 调用          |
| 式查询展示组件 |              |                    |               |
|                | 查询预警     | 预警查询组件       |               |
|                |              |                    |               |
|                | 查询事件     | 事件查询组件       |               |
|                |              |                    |               |
|                | 查询原始日志 | 原始日志查询组件   |               |
+----------------+--------------+--------------------+---------------+
| 告警查询组件   | 告警查询     | 索引查询组件       | 调用          |
|                |              |                    |               |
|                |              | 实时索引组件       |               |
+----------------+--------------+--------------------+---------------+
| 预警查询组件   | 预警查询     | 索引查询组件       | 调用          |
|                |              |                    |               |
|                |              | 实时索引组件       |               |
+----------------+--------------+--------------------+---------------+
| 事件查询组件   | 事件查询     | 索引查询组件       | 调用          |
|                |              |                    |               |
|                |              | 实时索引组件       |               |
+----------------+--------------+--------------------+---------------+
| 原             | 原始日志查询 | 索引查询组件       | 调用          |
| 始日志查询组件 |              |                    |               |