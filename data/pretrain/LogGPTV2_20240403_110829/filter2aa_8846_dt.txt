Transport Host-to-host 逻辑连接
包-Packet Network Internet IP 网
帧-Frame。细分 2 层：
逻辑链路控制 LLC+介质访问控制 MAC
Data link
Network access
通
信
网
以太网
比特/位-Bits Physical 承载网
TCP/IP 既是分层协议（分四层），也是聚合协议（聚合了七层里的部分层，也融合了很
多协议共同工作）。
二、各层协议
第一层：物理层
这一层定义了网络的物理拓扑。这一层是只关心物理信令。只有硬件处理信号在这层定义：
这些都是：电缆，连接器，集线器和中继器等。
■ EIA/TIA-232 and EIA/TIA-449
■ X.21
■ High-Speed Serial Interface (HSSI) 高速串行接口
■ Synchronous Optical Network (SONET) 同步光网络
■ V.24 and V.35
第二层：数据链路层
数据链路层接收来至于网络层的数据包(Packet)，生成在网络中传输的数据帧(Frame)。
—104—
这一层确保与通信对端信息交换的无误(或容错)。如果数据链路层检测到帧里面的错误，它将
请求对端重新发送该帧。数据链路层将信息从更高层进行格式转化，该转化基于某种网络技术，
如以太网，令牌环网等等。这一层使用硬件地址发送帧到对端设备，只是做物理的连接。数据
链路层关注的是将数据帧发送到下一跳链路。二层网络通信技术有以太网 Ethernet(IEEE
802.3),令牌环网 Token Ring (IEEE 802.5),异步传输模式 ATM(asynchronous transfer mode),
光纤分布式数据接口 FDDI(Fiber Distributed Data Interface),和铜线分布式数据接口
CDDI(Copper DDI)。
该层其实还细分了两层，上面的 LLC 子层(IEEE 802.2)和下面的 MAC 子层(IEEE 802.3)。
第二层必须要讲讲 MAC 地址：
该层要向数据帧添加硬件的源地址和目的地址，硬件地址指的是介质访问控制(MAC)地址
(Media Access Control address)，它是一种用十六进制表示法表示的 6 字节(48 比特)二进
制地址，例如 OO-13-02-1F-58-F5。前三个字节(24 比特)代表物理网络接口（网卡）的供应商
或制造商，这被称为组织唯一标识符(OUI) Organizationally Unique Identifier；后三个字
节(24 位)是设备的唯一代码。世界上没有两个设备具有相同的 MAC 地址（中国的山寨网卡就
有可能一样）。
讲了 MAC 地址就要知道 MAC-48、EUI-48 和 EUI-64（考点）：
MAC-48 和 EUI-48 一样，都是 6×8=64 位，前者用于网络设备，后者用于其它设备和软件。
而 EUI-64 是为了适应 IPv6 协议和激增的网络设备，而出现的新的地址标准，它向下兼容，具
体表示方法就是：
MAC-48 在中间加 FF：FF，比如：cc：cc：cc：FF：FF：cc：cc：cc
EUI-48 在中间加 FF：FE，比如：cc：cc：cc：FF：FE：cc：cc：cc
链路层支持的协议有：
■ Serial Line Internet Protocol (SLIP) 串行线路网络协议
■ Point-to-Point Protocol (PPP) 对点协议
■ Address Resolution Protocol (ARP) 地址解析协议：将 IP 地址解析为 MAC 地址
■ Reverse Address Resolution Protocol (RARP) 反向地址解析协议：MAC 解析为 IP
■ Layer 2 Forwarding (L2F) 二层转发协议
■ Layer 2 Tunneling Protocol (L2TP) 二层隧道协议
■ Point-to-Point Tunneling Protocol (PPTP) 点对点隧道协议
■ Integrated Services Digital Network (ISDN) 综合服务数字网络
第三层：网络层
数据链路层使用硬件寻址(MAC)，网络层则使用逻辑地址寻址(IP 寻址体系)。网络层向数
据中添加路由信息和寻址信息（源和目的 IP 地址），负责路由选择和传送信息，也管错误检
测和节点数据通信(也就是通信控制)，但不对传输进行验证(由传输层负责验证)。
网络层的典型协议有：
■ Internet Control Message Protocol (ICMP) 网络控制报文协议
■ Routing Information Protocol (RIP) 路由信息协议
■ Open Shortest Path First (OSPF) 开放式最短路径优先
—105—
■ Border Gateway Protocol (BGP) 边界网关协议
■ Internet Group Management Protocol (IGMP) 网络组管理协议（用来多播）
■ Internet Protocol (IP) 网络协议
■ Internet Protocol Security (IPSec) 网际协议安全
■ Internetwork Packet Exchange (IPX) 互联网分组交换协议
■ Network Address Translation (NAT) 网络地址转换
■ Simple Key Management for Internet Protocols (SKIP) 网络简单密钥管理协议
■ Dynamic Host Configuration Protocol（DHCP）动态主机配置协议（IP 分配）
最重要的是 IP 协议，有两大功能：
①寻址：IP 协议使用 IP 目的地址通过网络进行转发数据包，直至该数据包到达目的地。
②分段：如果数据包大小大于本地网络允许的最大数据值，IP 协议将该数据包拆分。
IP 是无连接的协议，不保证传输的可靠性。
最广泛的还有路由协议，考试涉及的动态路由协议有：
①距离矢量 distance vector。距离矢量路由协议维护一个目的网络以及距离和方向的跳
数的列表(也就是到达目的地所经过的路由器数量) 有 RIP、IGRP、EIGRP。
②链路状态 link-state。链路状态路由协议维护一个所有己连接网络的拓扑图，并且使
用这个拓扑图确定到达目的地的最短路径，有 OSPF 和 IS-IS。
BGP 是外部路由协议(EGP)，不适用于上述两种分类，有题目认为是路径矢量 path-vector。
过去常用的非 IP 协议有：
IPX、AppleTalk 和 NETBUI。（虽然过时了，但这些协议是可以绕过防火墙的）
①互联网分组交换协议 IPX 是 IPX/SPX 协议套件常用的，使用于上世纪 90 年代的 Novell
NetWare 网络。
②AppleTalk 协议是一套由苹果公司开发并使用于 Macintosh 系统网络上，最早版本于
1984 初发布。2009 的 Mac OS v10.6 版本发布后取消了苹果操作系统对 AppleTalk 的支持。
IPX 和 AppleTalk 都可以通过 IP 协议网关实现死区网络与 IP 网络的互联（死区是使用非 IP
协议网络的网段）。
③NetBIOS Extended User Interface/NetBIOS 扩展用户界面（NetBEUI 又名 NetBIOS 帧
协议或 NBF），是微软最广泛认知的一个协议，于 1985 年开发并用于支持文件和打印机共享。
微软通过使用 NetBIOS over TCP/IP (NBT)技术，使 NetBIOS 工作于 TCP/ IP 协议上，从而仍
能运用于现代网络。NetBIOS 端口（127-139）己成为流行的网络蠕虫攻击的目标，基于 NetBIOS
实现的弱点被循环利用，但问题不在协议自身。但作为一个低层协议，NetBIOS 已不再获得支
持，只有它的 SMB（Server Message Block）和 CIFS（Common Internet File System）的变
种仍在使用。
其它需要了解的协议：
ICMP 网络控制报文协议
就是 ping 、traceroute 、pathping。ICMP 最重要的应用就是拒绝服务攻击了。第九域
有归纳，这里简介一下：死亡之 ping 发送一个畸形的大于 65535 字节数据包给一台计算机并
试图让其崩溃。Smurf 攻击通过欺骗广播 ping 对目标网络产生巨大的流量。ping 数据包泛洪
—106—
是一个基础的拒绝服务(DoS)攻击，它消耗目标可用的所有带宽。
DHCP 分配出租 IP 地址的 4 步流程：The four-step DHCP lease process is：
1.发现 DHCP。DHCP DISCOVER message
2.响应发现。DHCP OFFER message
3.请求地址。DHCP REQUEST message
4.响应请求。DHCP ACK message
第四层：传输层
传输层负责管理连接的完整性并控制会话。传输层接收来自于会话层的 PDU（Protocol
Data Unit），比如：协议数据单元、数据包单元、数据负荷单元等，并将其转换为数据段。
会话规则指定每个数据段中可以包含多少数据、如何验证传输数据的完整性、如何确定数据是
否丢失。会话就是端到端的一个逻辑通信连接。该层协议有：
■ Transmission Control Protocol (TCP) 传输控制协议
■ User Datagram Protocol (UDP) 用户数据报协议
■ Sequenced Packet Exchange (SPX) 顺序数据包交换
■ Secure Sockets Layer (SSL) 安全套接字层
■ Transport Layer Security (TLS) 传输层安全
用户数据报协议(UDP)和传输控制协议(TCP)是最重要的传输层协议，详见 TCP/IP 模型。
第五层：会话层
会话层负责在两台计算机之间建立、维护和终止通信会话（使用会话）。这一层管理对话
模式或对话控制(单工、半双工、全双工)，并为分组和恢复建立检查点，以及重新传输上一次
验证检查点以来失败或丢失的 PDUs。该层协议有：
■ Network File System (NFS) 网络文件系统
■ Structured Query Language (SQL) 结构化查询语言
■ Remote Procedure Call (RPC) 远程过程调用
■ Network Basic Input Output System（NetBIOS）
■ PAP 密码认证协议 Password Authentication Protocol
■ PPTP 点对点隧道协议 Point-to-Point Tunneling Protocol
■ DNA SCP Digital Network Architecture Session Control Protocol.
第六层：表示层
表示层负责将从应用层接收的数据转换为遵从 OSI 模型的任何系统都能理解的格式，如：
将 Unicode 编码的数据转换为 ASCII 或 EBCDICM 字符集。它向数据中强行添加通用的或标准的
结构和格式化规则。表示层还负责加密和压缩。因此，它成为网络和应用程序之间的接口。通
过确保数据格式能够被两个系统支持，表示层准许不同的应用程序通过网络交互。大多数文件
或数据格式在这一层上出现，包括图像、视频、音频、文档、电子邮件、Web 页面和控制会话
等格式。该层协议有：
■ American Standard Code for Information Interchange (ASCII) 美国信息交换标准
代码
■ Extended Binary-Coded Decimal Interchange Mode (EBCDICM) 扩充二进制编码的十
—107—
进制交换码
■ Tagged Image File Format (TIFF) 标签图像文件格式
■ Joint Photographic Experts Group (JPEG) 联合图像专家组
■ Moving Picture Experts Group (MPEG) 运动图像专家组
■ Musical Instrument Digital Interface (MIDI) 音乐设备数字接口
第七层：应用层
本层为应用或者操作系统，提供网络接收或者发送服务，负责将协议栈与用户的应用程序、
网络服务或操作系统连接在一起。应用程序并不位于应用层内，只是通过相关的协议来对外通
信。该层协议有：
■ Hypertext Transfer Protocol (HTTP) 超文本传输协议
■ File Transfer Protocol (FTP) 文件传输协议
■ Line Print Daemon (LPD) 行式打印机后台程序
■ Simple Mail Transfer Protocol (SMTP) 简单邮件传输协议
■ Telnet 远程登录
■ Trivial File Transfer Protocol (TFTP) 普通文件传输协议/主要用来更新设备的配置文件
■ Electronic Data Interchange (EDI) 电子数据交换
■ Post Office Protocol version 3 (POP3) 邮局协议第三版
■ Internet Message Access Protocol (IMAP) 互联网消息访问协议
■ Simple Network Management Protocol (SNMP) 简单网络管理协议
■ Network News Transport Protocol (NNTP) 网络新闻传输协议
■ Secure Remote Procedure Call (S-RPC) 安全远程过程调用
■ Secure Electronic T ransaction (SET) 安全电子交易
三、TCP/IP 模型
TCP/IP 模型也称为 DARPA 或 DOD 模型，和 OSI 的对比前面已经讲了，分四层：
④应用层 Application，没什么好讲的
③传输层 Transport (也称为主机到主机层 Host-to-Host)，包括 TCP 和 UDP 协议。
②网络层 Internet (也称为互联网层 Internetworking)，包括 IP、ICMP、IGMP 等协议。
①网络接入层 Link（网络接口层 Network Interface/网络访问层 Network Access)。
重点讲下 TCP/IP 在传输层的传输控制协议 TCP 和用户报文协议 UDP 协议。
①UDP 是一种无连接的、不可靠的协议。这并不意味着 UDP 设计不佳。相反，应用层将执
行错误检查，而不是该协议。UDP 常用于传输音频和视频。它的报头很简单，四个字段：
1.源端口 Source port；2.目的端口 Destination port；3.报文长度 Message length；
4.校验和 Checksum。
②TCP 是面向连接、可靠的协议，提供无差错传输保证完整性。