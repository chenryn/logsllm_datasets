# 2018年Windows服务器挖矿木马总结报告

## 译文声明
本文为翻译文章，具体表达及含义以原文为准。

## 摘要
2018年，挖矿木马已成为Windows服务器面临的主要安全威胁之一。这一年，虽然挖矿木马攻击的增长趋势从爆发式增长逐渐趋于平稳，但其技术手段显著提升，恶意挖矿产业也更加成熟。通过各家族间的合作，受害计算机和网络设备的价值被进一步榨取。这种合作不仅提升了技术水平，也为网络安全从业者带来了更大的挑战。预计在2019年，挖矿木马的攻击活动将继续保持稳定，但黑产家族间的合作将更为普遍，“闷声发大财”可能是新一年挖矿木马的主要目标。

## 前言
挖矿木马是一种通过入侵计算机系统并植入挖矿软件来赚取加密货币的恶意程序。受感染的计算机会出现CPU使用率飙升、系统响应迟缓以及部分服务不可用等问题。这类木马最早于2012年出现，并自2017年起开始大规模传播。
到2018年，挖矿木马已经成为服务器面临的最严重安全威胁之一。360互联网安全中心对这一现象进行了深入研究与长期对抗。据统计，在2018年期间，360安全卫士平均每天拦截针对Windows服务器的挖矿木马攻击超过十万次，持续守护着这些系统的安全。基于我们所掌握的数据，本报告将总结2018年Windows服务器遭遇的挖矿木马威胁，并对未来发展趋势做出预测（注：下文中提到的“挖矿木马”特指针对Windows服务器的此类恶意软件）。

## 第一章 2018年攻击趋势概览
2018年，针对Windows服务器的挖矿木马攻击呈现出先升后降再反弹的趋势。上半年，此类攻击呈稳步上升态势，并于同年7月达到顶峰。随后，攻击强度有所减弱，一些挖矿木马家族停止了更新活动。直至12月份，“WannaMine”、“Mykings”等大型僵尸网络再次发起大规模攻势，导致挖矿木马攻击数量再度攀升。如图1所示，这是2018年针对Windows服务器的挖矿木马攻击趋势。

![图1](path_to_image)

年初时，挖矿木马攻击的增加是延续了2017年底的一波高潮。“8220”组织曾在2017年12月利用当时尚未公开的Weblogic反序列化漏洞(CVE-2017-10271)入侵多台服务器并植入挖矿木马，引起了广泛关注。自此之后，越来越多的黑客开始关注服务器挖矿领域。据360互联网安全中心统计，2018年上半年每月活跃的挖矿木马家族数量最多时达到了二十多个。

![图2](path_to_image)

然而到了下半年，随着披露的新Web应用远程代码执行漏洞减少，加之虚拟货币市场波动影响，挖矿木马家族格局基本固化，没有新的大型家族涌现。因此，尽管下半年仍有约三十个规模较大的挖矿木马家族存在，但整体增长趋势明显放缓。

直到年末，各大挖矿木马家族重新活跃起来，“Mykings”、“8220”组织和“WannaMine”三个家族成为推动此次攻击浪潮的主要力量。这三者合计占据了全年所有家族攻击总量的87%，而在12月份这一比例更是高达92%。详见图3。

![图3](path_to_image)

综上所述，2018年成为了针对Windows服务器挖矿木马最为猖獗的一年。如果进入2019年后加密货币价值继续下降，则挖矿木马的热度可能会随之降低；不过，攻击者也可能探索其他获利途径以维持收益。

## 第二章 2018年挖矿木马详解

### 一、攻击目标分布
大多数针对Windows服务器的挖矿木马并非直接利用操作系统自身的漏洞，而是更多地瞄准了运行在其上的Web应用程序或数据库中存在的安全弱点。例如，MsSQL成为了最主要的攻击对象之一，而Weblogic、JBoss、Drupal、Tomcat等也是重灾区。请参见图4了解详细分布情况。

![图4](path_to_image)

### 二、常用漏洞列表
为了提高成功率并简化操作流程，攻击者往往倾向于选择那些容易被利用且适合大规模部署的漏洞。表1列出了2018年间用于入侵Windows服务器的主要漏洞信息。值得注意的是，某些频繁更新的挖矿木马甚至能够在漏洞POC公布后的极短时间内将其应用于实际攻击中。

| 攻击平台 | 漏洞编号 | POC公开与首次利用时间差 |
| --- | --- | --- |
| Weblogic | CVE-2017-3248 | 6个月 |
| Weblogic | CVE-2017-10271 | 0天 (0day) |
| Weblogic | CVE-2018-2628 | 10至20天 |
| Weblogic | CVE-2018-2894 | 5个月 |
| JBoss | CVE-2010-0738 | 未知 |
| JBoss | CVE-2017-12149 | 20至30天 |
| Struts2 | CVE-2017-5638 | 少于1个月 |
| Struts2 | CVE-2017-9805 | 未知 |
| Struts2 | CVE-2018-11776 | 4个月 |
| Drupal | CVE-2018-7600 | 2个月 |
| Drupal | CVE-2018-7602 | 2个月 |
| ThinkPHP | - (ThinkPHP v5 GetShell) | 10至15天 |
| PHPMyAdmin | - (弱口令爆破) | - |
| PHPStudy | - (弱口令爆破) | - |
| Spring Data Commons | CVE-2018-1273 | 未知 |
| Tomcat | - (弱口令爆破) | - |
| Tomcat | CVE-2017-12615 | 未知 |
| MsSQL | - (弱口令爆破) | - |
| MySQL | - (弱口令爆破) | - |
| Windows Server | - (弱口令爆破) | - |
| Windows Server | CVE-2017-0143 | 少于1个月 |

通过以上分析可以看出，及时修补已知漏洞对于防止挖矿木马入侵至关重要。同时，加强密码管理和定期进行安全审计也是防范此类威胁的有效措施。