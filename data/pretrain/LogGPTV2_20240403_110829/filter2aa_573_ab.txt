diversity
diversity
Hard Targets
Hard Targets
““Hard
Hard”” targets
targets
Large corporations
Large corporations
Banking and Financial Services
Banking and Financial Services
Air traffic controls
Air traffic controls
NIPRNET
NIPRNET
Employ multiple security mechanisms, many distinct security 
Employ multiple security mechanisms, many distinct security 
regions in network, dedicated security teams
regions in network, dedicated security teams
Botnet size figures suggest there are no 
Botnet size figures suggest there are no ““hard
hard”” targets!
targets!
Attacking Hard Targets
Attacking Hard Targets
Need a dedicated, patient attack.  Pentesting 101
Need a dedicated, patient attack.  Pentesting 101
Step 1: get a foothold
Step 1: get a foothold
Research target network and users
Research target network and users
Can track victims with GSM information (SOURCE Boston 
Can track victims with GSM information (SOURCE Boston 
talk)
talk)
Examine social networks of users
Examine social networks of users
Get inside help, infiltrate or buy access
Get inside help, infiltrate or buy access
Send targets emails with malware/links to 0
Send targets emails with malware/links to 0--day exploits
day exploits
Maybe you already control some trusted nodes via the botnet
Maybe you already control some trusted nodes via the botnet
More Hard Targets
More Hard Targets
Spread
Spread
Record keystrokes, sniff packets, map network, analyze intranet 
Record keystrokes, sniff packets, map network, analyze intranet 
services
services
Slowly take over the entire local network
Slowly take over the entire local network
Learn how they make changes, what intranet sites they use, 
Learn how they make changes, what intranet sites they use, 
monitor emails, crack all passwords
monitor emails, crack all passwords
Use client side attacks, observe VPN, SSH usage
Use client side attacks, observe VPN, SSH usage
Install RATs on systems, different RATs for different hard 
Install RATs on systems, different RATs for different hard 
targets
targets
Become so
Become so--called 
called ““Advanced Persistent Threat
Advanced Persistent Threat””
Core Infrastructure
Core Infrastructure
Targets: Core routers, DNS servers
Targets: Core routers, DNS servers
Attacks
Attacks
DDOS
DDOS
Poisoning routing tables
Poisoning routing tables
Gain access via 
Gain access via ““hard target
hard target”” approach
approach
DOS attacks against vulnerabilities in routers, 
DOS attacks against vulnerabilities in routers, 
servers
servers
Cisco IOS, JunOS, BIND, MS DNS
Cisco IOS, JunOS, BIND, MS DNS
Air gapped systems
Air gapped systems
The most secure systems are 
The most secure systems are ““air gapped
air gapped”” from the 
from the 
Internet (or at least are supposed to be)
Internet (or at least are supposed to be)
DOD TS//SI network
DOD TS//SI network
Electric power grid
Electric power grid
Air traffic control?
Air traffic control?
These can still be remotely attacked, but difficult
These can still be remotely attacked, but difficult
JWICS was compromised by USB
JWICS was compromised by USB
Un
Un--airgapping
airgapping
The easiest solution is to put these networks back on the 
The easiest solution is to put these networks back on the 
Internet
Internet
Have an operative stick a 3g modem and a RAT on a 
Have an operative stick a 3g modem and a RAT on a 
computer/device on the network
computer/device on the network
...or add a whole new device to network
...or add a whole new device to network
Or a satellite phone
Or a satellite phone
Or a modem over existing phone lines 
Or a modem over existing phone lines 
if tempest shielding is a problem
if tempest shielding is a problem
Cyberwar defenses
Cyberwar defenses
Cyberwar Defenses
Cyberwar Defenses
Target country can take defensive actions during or in 
Target country can take defensive actions during or in 
advance to a cyber attack
advance to a cyber attack
Segregation (i.e. disconnect from the Internet)
Segregation (i.e. disconnect from the Internet)
Deploy large scale IDS/IPS systems
Deploy large scale IDS/IPS systems
Akami
Akami--like DOS protection of critical systems
like DOS protection of critical systems
Airgap sensitive networks
Airgap sensitive networks
Segregation
Segregation
Target country can isolate itself from the Internet to 
Target country can isolate itself from the Internet to 
protect itself from foreign attack
protect itself from foreign attack
Country may install aggressive filters on foreign 
Country may install aggressive filters on foreign 
inbound traffic
inbound traffic
By positioning botnet hosts and making operations in
By positioning botnet hosts and making operations in-- 
country, the attack can still occur 
country, the attack can still occur 
Filtering
Filtering
Target country may use filtering on Internet traffic
Target country may use filtering on Internet traffic
IDS, IPS, etc
IDS, IPS, etc
All botnet clients and their communications are custom 
All botnet clients and their communications are custom 
written, so no signatures will exist
written, so no signatures will exist
All RATs and their communications are custom written, 
All RATs and their communications are custom written, 
so no signatures will exist
so no signatures will exist
Redundancy of bots and RATS ensure if one is 
Redundancy of bots and RATS ensure if one is 
detected, attack can continue from remaining ones
detected, attack can continue from remaining ones
Akami
Akami--like defenses
like defenses
Akami works by mirroring and caching content in multiple, 
Akami works by mirroring and caching content in multiple, 
physically diverse locations
physically diverse locations
Akami delivers content close to the requester
Akami delivers content close to the requester
Target may use Akami itself, or develop similar approach to 
Target may use Akami itself, or develop similar approach to 
try to stop DDOS attack against critical infrastructure
try to stop DDOS attack against critical infrastructure
Our botnet is physically diverse so will have many nodes 
Our botnet is physically diverse so will have many nodes 
close to each Akami server
close to each Akami server
Our botnet should be large enough to overwhelm even 
Our botnet should be large enough to overwhelm even 
distributed service
distributed service
Airgapped systems
Airgapped systems
Target country may physically separate critical 
Target country may physically separate critical 
infrastructure (utilities, financial networks, military 
infrastructure (utilities, financial networks, military 
systems)
systems)
Some systems cannot be airgapped (e
Some systems cannot be airgapped (e--commerce)
commerce)
In advance, we try to un
In advance, we try to un--airgap the systems we target
airgap the systems we target
The Cyberarmy
The Cyberarmy
Job roles
Job roles
Numbers and cost per role
Numbers and cost per role
Equipment
Equipment
Total cost
Total cost
Job roles
Job roles
Vulnerability Analysts
Vulnerability Analysts
Exploit developers
Exploit developers
Bot collectors
Bot collectors
Bot maintainers
Bot maintainers
Operators
Operators
Remote personnel
Remote personnel
Developers
Developers
Testers
Testers
Technical consultants
Technical consultants
Sysadmins
Sysadmins
Managers
Managers
Vulnerability analysts
Vulnerability analysts
Bug hunters, find vulnerabilities in software via fuzzing and st
Bug hunters, find vulnerabilities in software via fuzzing and static 
atic 
analysis
analysis
Need to be world class, hard to 
Need to be world class, hard to ““grow
grow”” this talent
this talent
Try to hire up all the best people
Try to hire up all the best people
Find bugs in client side applications (browsers) as well as 
Find bugs in client side applications (browsers) as well as 
servers (DNS, HTTP) and networking equipment, smart phones
servers (DNS, HTTP) and networking equipment, smart phones
Find bugs in kernels for sandbox escape and privilege escalation
Find bugs in kernels for sandbox escape and privilege escalation
As needed, exploitable or DOS bugs
As needed, exploitable or DOS bugs
Exploit developers
Exploit developers
Turn vulnerabilities into highly reliable exploits
Turn vulnerabilities into highly reliable exploits
For both 0
For both 0--day and known vulnerabilities
day and known vulnerabilities
This used to be easy, but now takes a tremendous 
This used to be easy, but now takes a tremendous 
amount of skill
amount of skill
Will need to be able to write exploits for various 
Will need to be able to write exploits for various 
platforms: Windows, Mac OS X, Linux
platforms: Windows, Mac OS X, Linux
Will need to be able to defeat latest anti
Will need to be able to defeat latest anti--exploitation 
exploitation 
measures, ALSR, DEP, sandboxing
measures, ALSR, DEP, sandboxing
Bot collectors
Bot collectors
Responsible for using client side exploits to take over 
Responsible for using client side exploits to take over 
and install bots on as many computers and devices 
and install bots on as many computers and devices 
as possible
as possible
Mostly use exploits based on known exploits, some 0
Mostly use exploits based on known exploits, some 0-- 
day usage
day usage
Deliver exploits via spam, advertising banners, 
Deliver exploits via spam, advertising banners, 
malware
malware
Maintain and monitor exploit servers
Maintain and monitor exploit servers
Bot maintainers
Bot maintainers
Collection of bot machines will constantly be changing
Collection of bot machines will constantly be changing
Some will die, be reinstalled, etc
Some will die, be reinstalled, etc
Others will be added
Others will be added
Monitor size and health of botnets, as well as geographic 
Monitor size and health of botnets, as well as geographic 
diversity inside and outside target country
diversity inside and outside target country
Test botnets
Test botnets
Make efforts to maintain bots by keeping the systems on 
Make efforts to maintain bots by keeping the systems on 
which they reside patched, removing other malware, if 
which they reside patched, removing other malware, if 
possible
possible
Operators
Operators
Actively exploiting hard targets (elite pen testers)
Actively exploiting hard targets (elite pen testers)
Advanced usage of exploits, mostly 0
Advanced usage of exploits, mostly 0--day
day
Need to understand entire target network and be able 
Need to understand entire target network and be able 
to passively and actively scan and enumerate 
to passively and actively scan and enumerate 
network
network
Install RATs, monitor keystrokes and communications 
Install RATs, monitor keystrokes and communications 
to expand reach in network
to expand reach in network
Remote personnel
Remote personnel
Responsible for setting up operations around the 
Responsible for setting up operations around the 
world
world
Getting jobs, access to airgapped systems
Getting jobs, access to airgapped systems
Installing, monitoring, and testing un
Installing, monitoring, and testing un--airgapping 
airgapping 
devices
devices
Developers
Developers
Need to develop a variety of bots with differing 
Need to develop a variety of bots with differing 
communication methods
communication methods
Need to develop a variety of RATs
Need to develop a variety of RATs
Develop tools to aid other personnel
Develop tools to aid other personnel
Requires user and kernel level development on a 
Requires user and kernel level development on a 
variety of platforms
variety of platforms
Testers
Testers
Test exploits, RATs, and bots for functionality, 
Test exploits, RATs, and bots for functionality, 
reliability
reliability
Run all tools/exploits against a variety of anti
Run all tools/exploits against a variety of anti--virus, 
virus, 
IDS, IPS, to ensure stealth
IDS, IPS, to ensure stealth
Technical consultants
Technical consultants
These are experts in various domain specific and 
These are experts in various domain specific and 
obscure hardware and software systems
obscure hardware and software systems
SCADA engineers
SCADA engineers
Medical device experts
Medical device experts
Aviation scheduling experts
Aviation scheduling experts
etc
etc
Sysadmins
Sysadmins
Keep systems running, updated
Keep systems running, updated
Install software, clients and target software
Install software, clients and target software
Manage test networks and systems
Manage test networks and systems
Number and Cost per role
Number and Cost per role
Vulnerability Analysts
Vulnerability Analysts
Exploit developers
Exploit developers
Bot collectors
Bot collectors
Bot maintainers
Bot maintainers
Operators
Operators
Remote personnel
Remote personnel
Developers
Developers
Testers
Testers
Technical consultants
Technical consultants
Sysadmins 
Sysadmins 
Managers
Managers
Some info about costs
Some info about costs
I only factor in hardware, software, and personnel 
I only factor in hardware, software, and personnel 
salaries
salaries
I do not include 
I do not include 
Building rent, utilities, travel
Building rent, utilities, travel
support staff: Electricians, janitors, guards...
support staff: Electricians, janitors, guards...
““Spys