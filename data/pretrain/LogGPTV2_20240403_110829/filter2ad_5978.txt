title:Leveraging locality of reference for certificate revocation
author:Luke Dickinson and
Trevor Smith and
Kent E. Seamons
Leveraging Locality of Reference 
for Certificate Revocation
Luke Dickinson, Sandia National Laboratories
Trevor Smith, Brigham Young University
Kent Seamons, Brigham Young University
35th Annual Computer Security Applications Conference (ACSAC)
Condado Plaza Hilton, San Juan, Puerto Rico
December 9th – 13th, 2019 
1
X.509 Certificates
Certificates are used to authenticate TLS communication between clients and 
servers.
Hi Bank
Hey, I am 
Bank.com.
Please Login. 
2
Certificate Revocation
A malicious actor with access to the private key of a certificate can impersonate 
another party undetected.
Compromised certificates can be revoked to help clients avoid these connections.
Hi Bank
Hey, I am 
Bank.com.
Please Login. 
3
Seven Challenges Facing Certificate 
Revocation
Revocation is a hard problem
Revocation is largely ignored
We use these challenges to inform our design
4
1) Effectiveness during an Active Attack
Soft-failing client treat an inaccessible revocation status as good.
Let me check if this 
certificate is revoked.
Hey, I am Bank.com.
Please Login.
The OCSP responder is unavailable. 
I’ll default to trusting the certificate.
OCSP
responder
“Soft-fail revocation checks are like a seat-belt that snaps when you crash.” (Langley 2012)
5
2) Client Bandwidth Costs 
Many clients are dissuaded to participate. (Liu et al. 2015) 
6
3) Future Bandwidth Costs due to Certificate Growth
There has been an order of magnitude increase in live, trusted certificates from Jan 2017 to 
Nov 2019 (Censys.io).
30 Million -> 407 Million
Live, trusted certificates globally
7
4) Mass Revocation Event Scalability
“The community needs to develop methods for scalable revocation that can gracefully 
accommodate mass revocation events, as seen in the aftermath of Heartbleed.” 
(Durumeric et al. 2014)
8
5) Revocation Timeliness
Clients may not be able to detect a certificate has been revoked until days after the revocation 
has occurred.
A client 
downloads 
a CRL
A certificate 
is revoked
A client downloads the 
next CRL and learns of 
the revocation
1
2
3
4
5
day
6
7
8
9
9
6) Exposure of Client Traffic Patterns
Some revocation strategies share detailed client traffic patterns to third-parties.
.
10
7) Deployment Requirements and Incentives
Deployment costs, incentives, and risks can slow or halt adoption. 
.
Parties Involved:
• Certificate Authorities
• Website Administrators
• End-clients
• Other Third-parties
11
Our Solution
12
We Take Advantage of 
Certificate Working Sets
A certificate working set W(t, τ) of an organization is the collection of all 
certificates used by the organization over the period of time t - τ to t.
We hypothesize that a majority of certificates in a W(t + α, α) will reuse 
certificates seen in a W(t, τ), if α is small.
W(t, τ)
past
t - τ
W(t + α, α)
future
t 
t + α  
13
Certificate Revocation Table (CRT)
Contains an organization's certificate working set (both revoked and nonrevoked)
14
Design 
Parameters
Periodically-run 
Functions
Space Efficient 
Data Structure
For Clients
Client APIs
15
Deploying a Certificate Revocation Table in a 
Private Organization
Network gateway or IDS system which already has TLS usage 
information is a simple option
Other options described in the paper
16
Measurement Study
Obtained access to TLS logs from BYU from April to June 2018
● BYU has over 33,000 students
● 4,144,404,123 TLS handshakes
● 112 revoked certificates seen in 228,427 (0.005%) TLS handshakes
Simulated a Certificate Revocation Table
● Several values of τ was used (working set window length)
● α = 24 hours (download cycle)
● β = 24 hours (revocation rechecked)
past (τ)
future (α)
17
Experiment Results: BYU-shared CRT
The revocation status 
is cached on the client
All TLS 
handshakes
18
Experiment Results: BYU-shared CRT
The revocation status 
is cached on the client
All unique certificates 
19
Experiment Results: BYU-shared CRT
400,000 certificates =
0.11% of global space
20
Experiment Results: BYU-shared CRT
Decreasing because of 
delta updates
21
CRT Design Strength
CRT gives control, responsibility, and cost burdens to network administrators. 
Because the networks they administer benefit from CRT, the incentives are aligned.
Design parameters (τ, β, α) give flexibility to support different types of 
organizations and clients. 
22
Future Work
Anticipating certificate renewal
Early removal of irrelevant certificates
Exploring design parameters α and β
Alternative deployment scenarios: 
○ Single client
○ Home network
○ Larger regions (ISP)
○ Smart grid AMI network
23
Comparison to Other Strategies:
Seven Challenges Facing Certificate Revocation
Only revoked, means clients 
download CRS of only known 
revoked certificates instead of 
also including known good 
certificates
Small bandwidth 
requirements 
(esp. only revoked)
Low barrier-to-entry 
requirements
24
Conclusion
Using an organization-shared CRT is competitive with or exceeds alternative 
state-of-the-art solutions for each of the seven challenges of certificate 
revocation.
Our solution has the lowest deployment requirements today with:
● > 99% soft-fail protection
● low client bandwidth costs
● 1-2 days revocation timeliness
25
Questions?
26