PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
Token#: 2[1]
Amount: 800
Owner: PSP1
Sign: PSP1
Reference: 1[0]
35
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
Token#: 2[1]
Amount: 800
Owner: PSP1
Sign: PSP1
Reference: 1[0]
36
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
Token#: 2[1]
Amount: 800
Owner: PSP1
Sign: PSP1
Reference: 1[0]
PSP2
Corda 
node
UserA => UserB
50
37
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
Token#: 2[1]
Amount: 800
Owner: PSP1
Sign: PSP1
Reference: 1[0]
PSP2
Corda 
node
UserA => UserB
50
38
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
Token#: 2[1]
Amount: 800
Owner: PSP1
Sign: PSP1
Reference: 1[0]
PSP2
Corda 
node
UserA => UserB
50
Tx: 3
39
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
Token#: 2[1]
Amount: 800
Owner: PSP1
Sign: PSP1
Reference: 1[0]
PSP2
Corda 
node
UserA => UserB
50
Token#: 3[0]
Amount: 50
Owner: UserB
Sign: UserA
Reference: 2[0]
Tx: 3
40
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
Token#: 2[1]
Amount: 800
Owner: PSP1
Sign: PSP1
Reference: 1[0]
PSP2
Corda 
node
UserA => UserB
50
Token#: 3[0]
Amount: 50
Owner: UserB
Sign: UserA
Reference: 2[0]
Tx: 3
Token#: 3[1]
Amount: 150
Owner: UserA
Sign: UserA
Reference: 2[0]
41
What is backchain?
And how to exploit bad implementation...
Riksbank
Corda 
node
PSP1
Corda 
node
Issue
1000
Transactions
And tokens
Token#: 1[0]
Amount: 1000
Owner: PSP1
Sign: Riksbank
Reference: None
Tx: 1
PSP1
Corda 
node
UserA withdraw
200
Token#: 2[0]
Amount: 200
Owner: UserA
Sign: PSP1
Reference: 1[0]
Tx: 2
Token#: 2[1]
Amount: 800
Owner: PSP1
Sign: PSP1
Reference: 1[0]
PSP2
Corda 
node
UserA => UserB
50
Token#: 3[0]
Amount: 50
Owner: UserB
Sign: UserA
Reference: 2[0]
Tx: 3
Token#: 3[1]
Amount: 150
Owner: UserA
Sign: UserA
Reference: 2[0]
42
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
43
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
Withdrawal 3 and deposit 2
44
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
Withdrawal 3 and deposit 2
Token#2
197
PSP1
Token#3
3
UserA
45
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
Withdrawal 3 and deposit 2
Token#2
197
PSP1
Token#6
2
PSP1
Token#5
1
UserA
Token#3
3
UserA
46
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
Withdrawal 3 and deposit 2
Token#2
197
PSP1
Token#6
2
PSP1
Token#5
1
UserA
Historic
Transactions
Token#3
3
UserA
47
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
Withdrawal 3 and deposit 2
Token#2
197
PSP1
Token#6
2
PSP1
Token#5
1
UserA
Historic
Transactions
Token#3
3
UserA
48
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
Withdrawal 3 and deposit 2
Token#2
197
PSP1
Token#6
2
PSP1
Token#5
1
UserA
Historic
Transactions
Token#3
3
UserA
49
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
So UserA does this over and over again
Token#2
197
PSP1
Token#6
2
PSP1
Token#5
1
UserA
Historic
Transactions
Token#3
3
UserA
50
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
So UserA does this over and over again
Token#2
197
PSP1
Token#6
2
PSP1
Token#5
1
UserA
Historic
Transactions
Token#3
3
UserA
Token#7
194
PSP1
Token#8
3
PSP1
51
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
So UserA does this over and over again
Token#2
197
PSP1
Token#6
2
PSP1
Token#5
1
UserA
Historic
Transactions
Token#3
3
UserA
Token#7
194
PSP1
Token#8
3
PSP1
Token#10
2
PSP1
Token#9
1
UserA
52
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
So UserA does this over and over again
Token#6
2
PSP1
Token#5
1
UserA
Historic
Transactions
Token#3
3
UserA
Token#7
194
PSP1
Token#10
2
PSP1
Token#9
1
UserA
Token#2
197
PSP1
Token#8
3
PSP1
53
How to exploit token selection and long 
backchains
Token#1
200
PSP1
PSP1 UserA
Many times
Token#6
2
PSP1
Token#5
1
UserA
Historic
Transactions
Token#3
3
UserA
Token#x
44
PSP1
Token#10
2
PSP1
Token#9
1
UserA
Token#2
197
PSP1
Token#8
3
PSP1
Token#x
3
PSP1
Token#x
3
PSP1
Token#x
3
PSP1
Token#x
3
PSP1
Token#x
3
PSP1
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
Token#x
2
PSP1
Token#x
1
UserA
54
How to exploit token selection and long 
backchains
Token#1