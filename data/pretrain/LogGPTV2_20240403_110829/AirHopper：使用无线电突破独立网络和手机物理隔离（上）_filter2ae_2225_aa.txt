# AirHopper：使用无线电突破独立网络和手机物理隔离（上）
|
##### 译文声明
本文是翻译文章，文章原作者 Mordechai Guri，文章来源：arxiv.org
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
## 摘要
信息是现代企业最重要的资产，备受竞争对手的觊觎。在涉及到高度敏感的数据时，一家企业可能会采用物理隔离方法，切断内部网络与外部世界之间的网络连接。近年来，虽然实践（例如Stuxnet）证明入侵采用物理隔离的网络是具有可行性的，但从一个物理隔离网络中攫取数据仍然被认为是高级网络攻击中最具挑战性的阶段之一。
本文提出了一款分支型恶意软件“AirHopper”，该软件可以通过使用FM信号突破独立网络和附近受感染手机之间的物理隔离。众所周知，软件可以在一个视频显示器中有意地创建无线电发射信号，这是手机首次在攻击模式中被作为恶意无线电信号的预期接收器加以考虑。本文对网络的攻击模型及其局限性进行了详细分析，并讨论了实践过程中的相关注意事项（如隐身和调制方法）。最后，本文对AirHopper进行了评估，并展示了手机利用1360Bps（字节/秒）的有效带宽从距离1～7米处的物理隔离计算机上攫取文本和二进制数据的过程。
## 1\. 前言
由于现代企业依赖于计算机网络传送各种信息，因此这种网络是恶意竞争对手赚钱的目标。维护网络的安全是一项十分复杂的任务，涉及主机级防护、网络级防护、网关和路由器级防护等等。然而，只要局域网与外部世界（例如因特网）相连接，则无论采用何种防护级别，不断创新、坚持不懈的攻击者最终将会找到一种攻破网络的方法，从而实现窃听信息以及向外传输敏感数据的目的。
因此，当一个网络被用于提供高度敏感数据，或与存储或处理此类数据的计算机相连时，人们经常会采用所谓的“物理隔离”方法。采用物理隔离的网络与外部世界之间不存在任何物理网络连接（有线或无线），也不会通过另一个安全性较低的网络直接或间接地与外部世界相连。但是，雇员却可能会将他们的手机携带至企业的工作场所周围，也许恰好位于某个物理隔离网络中一台机密计算机的附近。尽管企业拥有合理的安全管理程序，但这种情况还是有可能出现，且并不需要员工怀有恶意企图。
由于现代手机安装 FM
无线电接收器的比例越来越大，这种情况的出现就会变得越来越普遍[1][2][3]。只要拥有适当的软件，一台受感染的计算机就能利用与视频显示适配器（视频显示卡）相关的电磁辐射生成兼容的无线电信号。这种由发射器与广泛使用的移动式接收器构成的组合，可以创造一种无法被一般安全设备监控到的潜在隐蔽通道。
本文展示了如何使用配备FM接收器的手机从一台受感染的计算机中收集散发的、包含敏感信息的无线电信号。虽然攻击模型有些复杂，但并没有超出一个熟练且持久型攻击者的能力。一旦攻击成功，攻击者则可能会从物理隔离网络中收集到有价值的信息。
###  1.1 手机中的FM接收器
FM无线电接收器于1998
年前后首次引入移动电话，并随着现代智能手机的出现而变得越来越普遍。不同于早期的犹豫不决，现在的大多数主要运营商和制造商都在努力将FM
接收器整合进它们的产品中。微软已表示支持 FM，并宣布将其应用到 Windows Phone 8 的一次更新升级中[4]。在诺基亚于2012 年和 2013
年出售的近7亿部手机中，Lumia 520 和 Lumia 920这两款畅销型手机都已支持 FM 无线电功能。在 Android 市场上，超过 450
款手机支持 FM 收音机功能[1][2]。许多功能型手机（低端手机）和音乐播放器（例如iPod
nano）中也集成了FM接收器。此外，美国通过制定相关法律强制要求在手机中集成FM接收器，以备紧急情况下使用[5]。
## 2\. 攻击模型
攻击模型假定恶意代码可以安装并运行在：（a）包括一台或多台计算机的目标网络上；（b）可能位于目标系统附近的移动设备上。随着当前“自带移动设备”
（BYOD）的普及，手机经常会进出企业的物理设备周边场所。
此类攻击包含四个主要步骤：（1）将恶意代码插入到目标系统中；（2）利用恶意代码感染手机；（3）利用手机建立一个指挥控制（C&C）通道；（4）检测所发出的信号并将其传送给攻击者（图1）。
图1：AirHopper演示。移动电话（B）接收了目标计算机（A）发射的无线电信号。在该演示中，（A）和（B）之间的距离为4米。
###  2.1 感染目标计算机
一旦物理隔离屏障被破坏，恶意代码就能够感染目标网络中的系统。正如Stuxnet[6][7]和Agent.btz[8]所展示的，这种破坏行为在某种程度上可以实现。因此，假设大多数类似的情况并未公开发布过是合理的。攻击媒介可能是（a）可移动介质，或（b）外包的软件或硬件组件。一旦恶意代码在目标网络的一个节点上运行，它就可能会进一步传播并感染其他节点。
###  2.2 感染手机
由于手机可以通过众多接口（如蜂窝网络、蓝牙、Wi-Fi以及与其他设备相连的物理连接）连接外部世界，因此针对手机的攻击媒介范围要比目标计算机广泛得多。最可能发生的情况是，针对目标企业中那些最有可能工作在目标计算机附近的员工，攻击者会试图定位并感染他们的手机。类似于早期阶段的高级持续性威胁（APT），这一步可以利用数据挖掘、社交网络、网络钓鱼和类似的社会工程方法。手机的感染途径可以是通过互联网、访问受感染的网址、携带恶意附件的电子邮件或安装恶意的应用程序。其他的感染途径包括物理访问、SMS、漏洞和干扰信号接口[9][10]。
###  2.3 建立指挥控制通道
在感染手机后，攻击者应该建立指挥控制通道。这一过程可以通过因特网 （数据或Wi-Fi）或SMS，其中信息的发送和接收可以在不引起用户警惕的情况下完成。如果攻击者所用的合适连接受限或不连续，则在手机上运行的恶意程序可能会先存储所积累的资料，并在所需的连接可用时再将其发送给攻击者。
###  2.4 无线电监测
手机应监管无线电频道，以检测所发出的信息。当检测到所发出的无线电广播时，设备将对此加以解码。监测可能是：（1）连续的，只要手机处于激活状态；（2）暂时的，须基于使用者的工作时间表；（3）受空间条件限制的，须基于使用者的当前位置（如
GPS、无线网络基站或其它方式所指示的地点）；或者（4）需要通过指挥控制通道接收远程命令后启动。
## 3\. 背景
现已有几份工程和技术文件[11][12][13][14]对从视频卡中生成无线电信号进行过讨论。信号发射计算所需的主要参数是像素时钟。像素时钟的单位是MHz，表示的是像素传输至屏幕的频率，例如一个刷新周期内所容纳的全帧像素。像素时钟可以采用简单的乘法加以计算：
其中，Hpixel 和 Vpixel 是垂直和水平分辨率（即1024和768）设置值， Vsync、Hsync 是垂直和水平同步长度（以像素为单位），
Rr是刷新率（例如60Hz），PC 是像素时钟。这些参数是由显示标准决定的。一般来说，在模拟标准和数字标准中，像素时钟主要由显示分辨率和刷新频率决定。
考虑到显卡的标准，我们有可能可以构建如下一种图像模式，即在将其发送至显示器的同时生成一种基于数据信号调制的载波。第一种选择是通过改变像素颜色来直接影响信号的电压。对于这种类型的数据传输，振幅调制（AM）是显而易见的选择。针对某个固定的载波，通过逐渐改变像素的深浅，则可以改变载波信号的振幅。以前的研究[15][12][14]表明，使用显示器和显示适配器可以有意地生成调制的无线电信号。本研究的目的在于传输将被手机FM接收器接收并解译的FM信号。通过构建一幅黑白像素交替排列的图像，反映出所需的载波频率调制，即可产生FM信号。在FM调制中，黑白像素用于生成固定的最大振幅，所产生的信号较强。
## 4\. 实践应用
为了测试并评估此类攻击的现实适用性，我们开发了名为“AirHopper”的恶意软件。在本节中，我们描述了该恶意软件的两个组件的实践应用情况：针对个人电脑的发射器组件和针对手机的接收器组件。
在考虑使用手机的FM接收器接收生成的信号时，我们面临着新的挑战和机遇。所面临的主要挑战之一是：手机中的FM接收器芯片首先是采用DSP
（数字信号处理）芯片解码FM信号，然后再生成音频信号，这一事实则导致手机的操作系统只能访问生成的音频输出（图2中的第2层），而不能访问载波本身。因此，若要将数字信息发送给接收器，数据必须使用音频音调进行调制图
2中的第3层）。此外，如第4.2节中所述，在选择调制中使用的音频频率时，应考虑FM 接收器的特点和局限性 。
图2：Airhopper调制图层
###  4.1 FM音频信号的产生
本节描述了AirHopper 用于生成像素模式（图像）的算法，以发射特定的FM音频信号。在音频调制算法中，我们采用 Fc
表示FM接收器为了接收所传输的信号必须调整到的载波频率（例如 90