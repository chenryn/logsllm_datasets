machine. However, the attacker’s AUC for blender, even for
the geophone, barely exceeds 80% at best, and is signiﬁcantly
lower than the legitimate node’s AUC.
3) Effect of Background Noise and Distances: While our
analysis in Sections VII-B1 and VII-B2 show that LDs
consistently have high detection accuracy,
the prevailing
ambient noise inside the court was indeed low. We now
study the degradation in event detection accuracy for the
legitimate sensors with increasing background noise. Hence
the background noise is varied between 50, 60 and 70 dB.
We show the resulting AUC for the legitimate microphone
and geophone inside the room across distances of 1m to 6m
from the event source in Figure 13. We see a clear trend of
decreasing AUC across noise levels for all sensor types. As
the ambient noise ﬂoor rises, the signal to noise ratio for the
events degrades, incurring higher false positives for a given
threshold of signal amplitude. At 50dB both the geophone
and microphone are able to detect the coffee and blender
with high AUC, with hardly any decline in detection rate
from increasing distances to source. At 60 dB, the geophone’s
AUC for coffee is decreased compared to 50 dB, but remains
mostly stable. The microphone, however, exhibits signiﬁ-
845
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:35:39 UTC from IEEE Xplore.  Restrictions apply. 
C
O
R
f
o
C
U
A
1
0.8
0.6
0.4
0.2
0
C
O
R
f
o
C
U
A
1
0.8
0.6
0.4
0.2
0
50dB
60dB
70dB
Random
Guess
1
2
3
4
5
6
Distance (m)
(a) Coffee – Geo
50dB
60dB
70dB
Random
Guess
1
2
3
4
Distance (m)
5
6
(c) Blender – Geo
C
O
R
f
o
C
U
A
1
0.8
0.6
0.4
0.2
0
C
O
R
f
o
C
U
A
1
0.8
0.6
0.4
0.2
0
50dB
60dB
70dB
Random
Guess
1
2
3
4
5
6
Distance (m)
(b) Coffee – Mic
50dB
60dB
70dB
Random
Guess
1
2
3
4
Distance (m)
5
6
(d) Blender – Mic
Fig. 13: For events coffee and blender alike, increasing noise
levels result in poorer detection accuracy even for devices
inside, as expected. Since the coffee machine has a signif-
icantly weaker signal than the blender, the degradation in
detection accuracy is steeper for coffee event as the distance
from source and noise level increases.
cantly degraded performance as the distance from the coffee
maker increases at 60dB. As seen from previous analysis,
the inherently higher sound and vibration generated by the
blender results in the both sensors continuing to perceive it
with high accuracy. At 70 dB, the signal to noise ratio for
the coffee event degrades enough at higher distances to make
its detection effectively a random guess for both nodes. Even
for the blender, we see the geophone’s AUC start to suffer at
higher distances. Most home environments where Perceptio
is suitable might have instances of high background noise
(e.g. music playing loudly for a few minutes), during which
sensors inside might not be able to ﬁngerprint successfully.
But as long as the environment exhibits ambient noise levels
below 70dB for the most part, the sensors are able to detect
events successfully for ﬁngerprint extraction.
C. Key Establishment
1) Fingerprint Similarity between Legitimate Devices:
While we demonstrated generally high event detection accu-
racy of legitimate devices, LDs, under prevailing conditions
inside the squash court in Section VII-B, this may not directly
translate to satisfactory key establishment. This could be due
to occasional detection errors, clustering errors, and relative
temporal offsets in event detection between different sensor
modalities. Hence, we evaluate our protocol in an end-to-end
manner to demonstrate Perceptio’s ability to establish shared
keys between LDs (with heterogeneous modality) located
within the physical boundary. To do so, we use real-world
data to execute the Perceptio protocol and evaluate the ﬁn-
gerprint similarities Fsim between device pairs. Speciﬁcally,
we ﬁrst generate a data stream of three thousand events –
consisting of knocking, walking, coffee, and ambient noise –
by randomly drawing samples from the data set described in
Section VII-B1. Upon executing the protocol, we compute
Fsim for all seven feasible sensor pairs across LDs, as de-
picted in Figure 14 (note that there are ten sensing modality-
pairs possible, but {acc, mot}, {acc, pow} and {mot, pow}
are omitted as none of the tested events can be sensed in
common by these pairs). We illustrate two interpretations
of the ﬁngerprint similarity for each sensor pair. First, we
depict the overall ﬁngerprint similarity across all ﬁngerprint
comparisons. The large standard deviation in this ﬁrst set
of bars reﬂects the variation across ﬁngerprints that will be
used and those that will be discarded due to low similarity.
Second, we depict the average ﬁngerprint similarity Fsim for
only those ﬁngerprints that are not discarded (i.e., those with
similarity above the threshold). These are the ﬁngerprints
that actually contribute to secure key establishment and
conﬁdence. As depicted in Figure 14, all the sensor pairs that
perceive at least one common event have high Fsim after the
thresholding.
2) Conﬁdence Score: Another important aspect of Per-
ceptio is its Key Strengthening Process discussed in Sec-
tion V, which takes advantage of incremental growth in the
conﬁdence score (ConfScore) upon a successful iteration of
key establishment protocol. Figure 15 depicts ConfScore of
sensor pairs over time. As in the previous discussion, we
depict the sensor pairs that perceive at least one event in com-
mon. The notion of time is depicted as the number of events
arrivals in this ﬁgure, as more events arrive with more time
(detailed modeling of event inter-arrival times and resulting
time for entropy extraction is presented in Appendix D).
From this ﬁgure, we have two important takeaways. First,
sensor pairs that detect more events reliably and/or frequently
in common exhibit a steeper increase in conﬁdence. For
example, {geo, mic} pair perceives three events in common
– knock, walk, and coffee – while {acc, mic} perceives only
the knock event in common. Hence we see that as more events
arrive,ConfScore of {geo, mic} pair increases faster than that
of {acc, mic}. The pairs that do not reliably or frequently
perceive a common event, such as {geo, mot} have much
slower increase in ConfScore. Second, it is important to note
that ConfScore never decreases over time. Upon ﬁngerprint
mismatches (which contributes to lowered average Fsim
in the ﬁrst bar graphs of each sensor pairs depicted in
Figure 14), the ConfScore levels off at the current state until
the next successful ﬁngerprint matching occurs. This means
that any ﬁngerprint mismatches – due to detection and/or
clustering errors – do not degrade the key establishment
process, but simply takes longer.
3) Fingerprint Similarity between Attacker and Legitimate
It is evident from the attacker’s event detection
Devices:
ROC studied in Figures 11(d) 11(e) 11(f) that the Ms can
hardly perform better than random guess. Further, given that
requisite clustering also incurs some errors, it is expected
that the likelihood of an M achieving a high Fsim with an
LD can be no better than a random guess. We nevertheless
evaluate this by further granting two unfair advantages in
favor of the attacker. First, we assume that the Ms are
capable of yielding less errors in event detection. There
are two types of errors in event detection – insertion and
deletion errors, each represented by F Prate and T Prate
846
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:35:39 UTC from IEEE Xplore.  Restrictions apply. 
)
%
(
m
S
i
F
e
g
a
r
e
v
A
100
80
60
40
20
0
(Geo,Mic)
(Acc,Geo)
(Acc,Mic)
(Geo,Mot)
(Geo,Pow)
Sim
>Tolerance
 Threshold=85%
Overall F
F
F
Sim
Sim
(Mic,Mot)
(Mic,Pow)
Fig. 14: We verify that LDs that sense common events are in-
deed able to pair with high ﬁngerprint similarity. Occasional
inaccuracies in event clustering and temporal offsets in event
detection cause the average ﬁngerprint similarity between
modality-pairs to be around 65% with a high variance.
However, even at 85% similarity threshold for successful
pairing, all sensor modalities manage to establish keys within
a few successful tries, with low variance.
100
e
r
o
c
S
e
c
n
e
d
i
f
n
o
C
10
1
0
(Geo,Mic)
(Acc,Geo)
(Acc,Mic)
(Geo,Mot)
(Geo,Pow)
(Mic,Mot)
(Mic,Pow)
500
1000
1500
2000
2500
3000
Number of Events
Fig. 15: We study the key strengthening process by observing
the increase in conﬁdence score for each established legit-
imate sensor pairing as the number of encountered events
in the environment increases. Modalities such as geophone
and microphone that are able to simultaneously sense most
of the occurring events exhibit a much steeper increase in
conﬁdence scores as compared to pairings such as {geo, mot}
that sense relatively fewer events in common.
respectively. We only considering errors due to deletion, and
assume that the Ms do not yield any insertion errors –
i.e., yielding high T Prate with no F Prate. From the ROC
curves aforementioned in Section VII-B, we choose the best
possible T Prate for each attacker sensor that corresponds to
F Prate = 50%, but replace the F Prate to 0%. Second, we
assume that the attacker has 100% clustering accuracy.
While these are unrealistic advantages, we evaluate Fsim
with such assumptions to account for the chance possibility
that the attacker may detect events at a higher accuracy or
have access to better clustering methods. Hence, the two
advantages provide an optimistic scenario for the attacker.We
evaluate ﬁngerprint similarities between Ms and LDs with
a simulated stream of events by exhaustively searching for
best matching ﬁngerprints. Figure 16 depicts the reported
values, with a maximum value of 70% between the attacker
and legitimate geophones. Recall from Figure 14 that we
draw the requisite similarity threshold at 85%. Hence the
attacker’s best case Fsim, even with the unfair advantages,
847
)
%
(
m
S
i
F
e
g
a
r
e
v
A
100
80
60
40
20
0
Geo
Mic
Acc
Motion
Power Meter
Geo
Mic
Acc
Expensive Acc Expensive Mic
Attacker's Devices
Fig. 16: We present a simulated study of Fsim for Ms
attempting to pair with LDs. Even with overestimated ca-
pabilities of the attacker, average of all Fsim is only at 55%,
bar the expensive geophone (around 70%), but nevertheless
sufﬁciently below the tolerance line of 85% set in Figure 14.
are sufﬁciently below the tolerance level, demonstrating that
Perceptio succeeds in thwarting the attack.
VIII. DEPLOYMENT CONSIDERATIONS
We now discuss practical considerations when deploying
Perceptio in smart homes.
Simultaneous Events. While we present experiment eval-
uations with a single event per time period and background
noise, this may not always be true in real life, as multiple
events may occur simultaneously (e.g., coffee making while
walking). In such cases, we have seen that the concurrent
events will produce an overlapping signal and either be
clustered as a separate event type or mismatch errors will
occur leading to a longer time to reach the conﬁdence
threshold. To test our hypothesis, we conducted a preliminary
experiment with two events – coffee making and generating
footsteps (walking in place) – occurring simultaneously,
while the sensors were located 1m away from the event
sources. We then kept the locations of sensors and the coffee