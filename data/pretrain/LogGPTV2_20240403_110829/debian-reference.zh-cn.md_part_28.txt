5.6.2 WAN TCP 优化
The TCP throughput can be maximized by adjusting TCP buffer size parameters as in ”TCP tuning” for the modern high-
bandwidth and high-latency WAN. So far, the current Debian default settings serve well even for my LAN connected by the
fast1GbpsFTTPservice.
5.7 Netfilter 网络过滤框架
Netfilter使用Linux内核模块(参见第 3.8.1 节)提供状态防火墙和网络地址转换(NAT)框架。
netfilter主要的用户层程序是iptables(8).你能从shell手工交付式的配置netfilter，使用iptables-save(8)保存当
前状态,当系统重启时，通过init脚本调用iptables-restore(8)来恢复。
像shorewall这样的配置帮助脚本能够使这个过程变得更简单。
SeedocumentationsatNetfilterDocumentation(orin”/usr/share/doc/iptables/html/”).
• LinuxNetworking-conceptsHOWTO
• Linux2.4PacketFilteringHOWTO
• Linux2.4NATHOWTO
提示
虽然这些是为Linux2.4写的，iptables(8)命令和netfilter内核功能都能够在Linux2.6和3.x内核系列实现。
Debian参考手册 104/233
软件包 流行度 大小 说明
netfilter管理工具(iptables(8)用于IPv4,ip6tables(8)用于
iptables V:315,I:740 2414
IPv6)
arptables V:0,I:1 100 netfilter管理工具(arptables(8)用于ARP)
ebtables V:14,I:29 264 netfilter管理工具(ebtables(8)用于以太网桥)
iptstate V:0,I:2 119 持续性监控netfilter状态(和top(1)相似)
UncomplicatedFirewall(UFW)isaprogramformanaginganetfilter
ufw V:53,I:75 857
firewall
gufw V:5,I:10 3660 graphicaluserinterfaceforUncomplicatedFirewall(UFW)
firewalldisadynamicallymanagedfirewallprogramwithsupportfor
firewalld V:9,I:14 2496
networkzones
firewall-config
V:0,I:2 1164 graphicaluserinterfaceforfirewalld
shorewall-init V:0,I:0 88 Shoreline防火墙初始化
shorewall V:3,I:8 3090 Shoreline防火墙,netfilter配置文件生成器
shorewall-lite V:0,I:0 71 Shoreline防火墙,netfilter配置文件生成器(精简版)
shorewall6 V:0,I:1 1334 Shoreline防火墙,netfilter配置文件生成器(IPv6版本)
shorewall6-lite
V:0,I:0 71 Shoreline防火墙,netfilter配置文件生成器(IPv6,精简版)
Table5.7: 防火墙工具列表
Debian参考手册 105/233
Chapter 6
网络应用
建立网络连接后（参加第 5 章），你可以运行各种网络应用。
提示
对于现代的Debian网络基础设施的具体说明，阅读Debian管理员手册——网络基础设施。
提示
在某些ISP下，如果你启用“两步验证”，你可能需要获取一个应用密码以从你的程序访问POP和SMTP服务。你
也可能需要事先允许你的主机IP进行访问。
6.1 网页浏览器
有许多网页浏览器软件包，使用超文本传输协议（HTTP）访问远程内容。
软件包 流行度 大小 类型 网络浏览器说明
chromium V:33,I:109 230021 X Chromium，（来自Google的开源浏览器）
Firefox，（来自Mozilla的开源浏览器，仅在Debian
firefox V:8,I:12 231279 同上
Unstable中可用）
firefox-esr V:209,I:434 228796 同上 FirefoxESR（Firefox延长支持版本）
epiphany-browser
V:3,I:16 2192 同上 GNOME，兼容HIG，Epiphany
konqueror V:24,I:103 25892 同上 KDE，Konqueror
dillo V:0,I:5 1565 同上 Dillo，（基于FLTK的轻量级浏览器）
w3m V:15,I:187 2828 文本 w3m
lynx V:23,I:317 1935 同上 Lynx
elinks V:4,I:21 1653 同上 ELinks
links V:3,I:29 2314 同上 Links（纯文本）
links2 V:1,I:12 5492 图像 Links（没有X的控制台图像）
Table6.1: 网页浏览器列表
6.1.1 伪装用户代理字符串
为了访问一些过度限制的网站，你可能需要伪装网页浏览器程序返回的User-Agent字符串。参见：
Debian参考手册 106/233
• MDNWebDocs: userAgent
• ChromeDevelopers: Overridetheuseragentstring
• Howtochangeyouruseragent
• HowtoChangeUser-AgentinChrome,Firefox,Safari,andmore
• HowtoChangeYourBrowser’sUserAgentWithoutInstallingAnyExtensions
• HowtochangetheUserAgentinGnomeWeb(epiphany)
小心
伪装的用户代理字符串可以会导致来自Java的不良副作用。
6.1.2 浏览器扩展
所有现代的GUI（图形用户界面）浏览器支持基于browserextension的源代码，它在按webextensions变成标准化。
6.2 邮件系统
本章节关注于消费者级互联网连接的典型的移动工作站。
小心
如果你想设置邮件服务器来直接通过互联网交换邮件，你应该最好阅读一下这个基本文档。
6.2.1 电子邮件基础
电子邮件由三个部分组成，消息的信封，邮件头及邮件正文。
• SMTP用电子邮件信封上的”To”和”From”信息来投递邮件。(信封上的”From”信息也被叫做退回地址,例如From_等
等）。
• 电子邮件头的”To”和”From”信息，显示在电子邮件客户端上. (在大部分情况下，这些信息是跟电子邮件信封一致，
但并不全是这样。）
• 覆盖邮件头和正文数据的电子邮件消息格式被多用途互联网邮件扩展(MIME)扩展，从纯文本的ASCII到其它字符
编码，包括作为附件的音频、视频、图像和应用程序。
功能全面的基于电子邮件客户端的GUI程序使用基于GUI的直观的配置，提供下列所有功能。
• 为了处理正文数据类型及其编码，它创建和使用多用途互联网邮件扩展(MIME)来解释邮件标头和邮件正文。
• 它使用旧的基础访问认证或现代的OAuth2.0向ISP（互联网服务提供商）的SMTP和IMAP服务器认证它自己。
(对于OAuth2.0,通过桌面环境设置来设置它，例如，”Settings”->”OnlineAccounts”.)
• 它发送消息到ISP的智能主机的SMTP服务监听的消息递交端口（587）。
• 从TLS/IMAP4端口（993）接收存储在ISP的服务器上的消息。
• 它能够通过他们的属性过滤邮件。
• 它能够提供额外的功能：联系人、日历、任务、备忘录。
Debian参考手册 107/233
软件包 流行度 大小 类型
evolution V:30,I:236 484 XGUI程序(GNOME3,groupware套件)
thunderbird V:52,I:121 224527 XGUI程序(GTK，MozillaThunderbird)
kmail V:37,I:95 23871 XGUI程序(KDE)
mutt V:17,I:157 7104 很有可能与vim一起使用的字符终端程序
mew V:0,I:0 2319 (x)emacs下的字符终端程序
Table6.2: 邮件用户代理列表(MUA)
6.2.2 现代邮件服务限制
现代邮件服务器有一些限制来最小化暴露滥用（不希望和未被要求的电子邮件）问题。
• 在消费者级的网络上运行SMTP服务器来直接可靠的发送邮件到远端主机是不现实的。
• 一个邮件能够被任何主机静悄悄的拒绝，即使路由到了目的地，除非它尽可能看起来是经过认证的。
• 期望单个智能主机可靠的发送不相关的源邮件地址到远程主机，这是不现实的。
这是因为：
• 从消费者级网络提供的主机连接到互联网的SMTP端口（25）已经被封锁了。
• 从互联网的SMTP端口（25）连接到消费者级网络提供的主机已经被封锁了。
• 从消费者级网络提供的主机发出到互联网的消息，只能够通过消息递交端口（587）发送。
• 像域名密钥识别邮件(DKIM)、发信者策略框架(SPF)和基于域名的消息认证、报告和反应（DMARC）这样的反垃
圾邮件技术广泛用于电子邮件过滤。
• 域名密钥识别邮件服务可能会用于你的通过smarthost的电子邮件发送。
• 智能主机可以在邮件头重写源电子邮件地址为你的邮件账户，来阻止电子邮件欺诈。
6.2.3 历史邮件服务端期望
一些在 Debian 上的程序，它们默认期望访问 /usr/sbin/sendmail 命令来发送邮件，或者从一个个性化设置的
UNIX系统邮件服务器来发送邮件，实现历史的功能：
• 邮件是由纯文本文件创建。
• 邮件是由/usr/sbin/sendmail命令处理。
• 对于目的地址为同一主机，/usr/sbin/sendmail命令进行邮件的本地分发，将邮件附在/var/mail/$username
文件后。
– 期望这个特征的命令：apt-listchanges,cron,at,...
• 对于目的地址在远程主机，/usr/sbin/sendmail命令远程传输邮件到目的主机，使用SMTP发现DNSMX记录。
– 期望这个特征的命令：popcon,reportbug,bts,...
Debian参考手册 108/233
6.2.4 邮件传输代理 (MTA)
在Debian12Bookworm后，在没有mailtransferagent(MTA)程序的情况下，Debian移动工作站可以基于电子邮件客
户端，配置为全功能的GUI（图像用户界面）。
以往的Debian会安装某个MTA程序来支持期望/usr/sbin/sendmail命令的程序。移动工作站上这样的MTA必
须和第 6.2.2 节第 6.2.3 节协同工作。
对于移动工作站，典型的MTA选择是exim4-daemon-light或postfix，并选择类似这样的安装选项：“Mailsent
bysmarthost;receivedviaSMTPorfetchmail”。这些是轻量MTA和”/etc/aliases”匹配。
提示
配置exim4来发送互联网邮件，多个源电子邮件地址使用多个相应的智能主机，这是不寻常的。如果一些程序需
要这样的能力，使用msmtp来设置他们，它比较容易来设置多个源电子邮件地址。然后给主MTA仅仅保留单个电
子邮件地址。
软件包 流行度 大小 说明
exim4-daemon-light
V:222,I:234 1574 Exim4邮件传输代理(MTA:Debian默认的)
exim4-daemon-heavy
V:6,I:6 1742 Exim4邮件传输代理(MTA:灵活的替代品)
exim4-base V:228,I:242 1701 Exim4文档(文本)和通用文件
exim4-doc-html I:1 3746 Exim4文档(html)
exim4-doc-info I:0 637 Exim4文档(info)
postfix V:128,I:136 4031 Postfix邮件传输代理(MTA:安全的替代品)
postfix-doc I:7 4634 Postfix文档(html+text)
sasl2-bin V:5,I:14 371 CyrusSASLAPI实现(实现postfixSMTP认证)
cyrus-sasl2-doc
I:1 2154 CyrusSASL-文档
msmtp V:6,I:11 667 轻量MTA
msmtp-mta V:5,I:6 125 轻量MTA(sendmail兼容扩展到 msmtp)
esmtp V:0,I:0 129 轻量MTA
esmtp-run V:0,I:0 32 轻量MTA(sendmail兼容扩展到 esmtp)
nullmailer V:8,I:9 474 部分功能MTA，没有本地邮件
ssmtp V:5,I:8 2 部分功能MTA，没有本地邮件
sendmail-bin V:13,I:14 1877 全功能MTA(如果你已经对它熟悉)
courier-mta V:0,I:0 2408 全功能MTA(web接口等.)
Table6.3: 基础的邮件传输代理相关的软件包列表
6.2.4.1 exim4的配置
对于那些通过smarthost的网络邮件，你应该按如下所示的(重新)配置exim4-*软件包。
$ sudo systemctl stop exim4
$ sudo dpkg-reconfigure exim4-config
配置”Generaltypeofmailconfiguration”时，选择”mailsentbysmarthost;receivedviaSMTPorfetchmail”。
设置”Systemmailname:”为默认的FQDN(参见第 5.1.1 节)。
设置”IP-addressestolistenonforincomingSMTPconnections:”为默认的”127.0.0.1;::1”。
”Otherdestinationsforwhichmailisaccepted:”选项留空。
”Machinestorelaymailfor:”选项留空。