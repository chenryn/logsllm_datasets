title:Security of Internet Location Management
author:Tuomas Aura and
Michael Roe and
Jari Arkko
Security of Internet Location Management 
Tuomas Aura and Michael Roe 
Microsoft Research 
Jari Arkko 
Ericsson Research NomadicLab 
7 J J Thomson Avenue, Cambridge CB3 0FB, UK  
LM Ericsson, FIN-02420 Jorvas, Finland 
{tuomaura,mroe}@microsoft.com 
PI:EMAIL  
Abstract 
In  the  Mobile  IPv6  protocol,  the  mobile  node  sends 
binding  updates  to  its  correspondents  to  inform  them 
about its current location. It is well-known that the origin 
of  this  location  information  must  be  authenticated.  This 
paper  discusses  several  threats  created  by  location 
management that go beyond unauthentic location data. In 
particular,  the  attacker  can  redirect  data  to  bomb  third 
parties  and 
induce  unnecessary  authentication.  We 
introduce  and  analyze  protection  mechanisms  with  focus 
on ones that work for all Internet nodes and do not need a 
PKI  or  other  new  security  infrastructure.  Our  threat 
analysis  and  assessment  of  the  defense  mechanisms 
formed  the  basis  for  the  design  of  a  secure  location 
management protocol for Mobile IPv6. Many of the same 
threats should be considered when designing any location 
management mechanism for open networks. 
1. Introduction 
Internet  nodes  by 
This  paper  describes  attacks  against  mobile  and 
location 
stationary 
management  features  of 
the  Mobile  IPv6  (MIPv6) 
protocol  and  other  Internet  mobility  protocols.  We 
analyze  the  threats  created  by  location  management  and 
the  advantages  and 
limitations  of  various  security 
mechanisms. 
exploiting 
routing 
tables, 
leading 
It  is  well  known  that  false  location  information  can 
corrupt  directories  and 
to 
misrouting  of  confidential  information,  highjacking  of 
connections,  and  denial  of  service  (DoS)  because  honest 
nodes cannot communicate. Cryptographic authentication 
of  the  location  information  is  usually  seen  as  a  key 
defense  mechanism.  For  example,  authentication  of 
updates  to  location  information  is  mandatory  in  Mobile 
IPv4  [PJ01]  and  Mobile  IPv6  [JPA02],  and  in  Dynamic 
DNS  [VTRB97].  This  paper  reports  the  lessons  we 
learned when we set out to design such an authentication 
protocol for MIPv6.  
We first overview  known attacks  that use  unauthentic 
location  data  (Section  2)  and  discuss  authentication 
mechanisms (Section 3). We are particularly interested in 
mechanisms  that  allow  authentication  between  arbitrary 
Internet nodes without prior trust relationships, public-key 
infrastructure  (PKI)  or  trusted  third  parties.  We  then 
present  new  types  of  attacks  that  go  beyond  unauthentic 
messages.  In  particular,  we  explain  how  even  strongly 
authenticated  location  management  can  be  exploited  in 
DoS  attacks.  First,  data  flows  can  be  redirected  to  flood 
third  parties  who  are  not  taking  part  in  the  mobility 
protocol  (Section  4).  Second,  the  attacker  may  exploit 
features of a location management protocol to exhaust the 
resources  of  either  the  mobile  or  the  correspondent,  for 
example,  by 
authentication 
(Sections  5  and  6).  Finally,  we  make  some  notes  about 
prioritizing  security  goals  and  combining  multiple  levels 
of authentication (Section 7). 
inducing  unnecessary 
too  expensive 
It  is  essential  to  understand  that  some  of  the  threats 
may  be  acceptable  or 
to  prevent 
completely.  Different  security  mechanisms  provide 
variable 
levels  of  guarantees  for  variable  security 
properties  at  variable  cost.  The  challenge  is  to  find  an 
acceptable level of protection at an acceptable price. It is 
not  our  goal  to  create  a  general  infrastructure  for  strong 
authentication.  Instead,  the  aim  is  to  make  sure  that  the 
introduction  of  a  new  technology,  mobility,  does  not 
expose  the  current  Internet  to  uncontrolled  threats. 
Therefore,  we  can  resort  to  some  relatively  weak  and 
inexpensive  security  mechanisms  that  nevertheless  solve 
the problems at hand.  
The ideas presented in this paper formed the basis for 
the design of the secure location management protocol in 
the  current  Mobile  IPv6  specification  [JPA02].  We 
believe  that  the  same  threats  and  defenses  should  be 
considered 
location 
management protocol for open networks. 
the  development  of  any 
in 
1.1. The Mobile IPv6 Protocol 
This section gives a brief overview of mobility and the 
Mobile  IPv6  architecture.  We  avoid  using  protocol-
specific terms whenever possible.  
IP  mobility  means  that  an  Internet  node  moves  from 
one location, i.e. IP address, to another, either because it 
Proceedings of the 18th Annual Computer Security Applications Conference (ACSAC(cid:146)02) 
1063-9527/02 $17.00 ' 2002 IEEE 
CN
(b)
Home
(a)
Home
secure
tunnel
data
Internet
MN
CN
BU
data
MN
Figure 1.  Mobile IPv6 packet forwarding (a) and binding update (b) 
moves  physically  between  network  coverage  areas  or 
media  types,  or  because  its  logical  point  of  network  
access changes. The main goals of mobility protocols are 
to  maintain  existing  connections  over  location  changes 
and  to  ensure  that  the  mobile  can  be  reached  at  its  new 
location.  With 
location  management  we  mean  any 
mechanism  for informing other nodes about the  mobile's 
current  address.  Typically,  location  management  either 
utilizes some kind of directory service where the mobile's 
location is maintained or it involves direct notifications to 
the nodes that need to know about the new location. 
 In Mobile IPv6, every mobile node (MN) has a home 
network  and  is  identified  by  a  home  IP  address  on  that 
network.  The  128-bit  IPv6  address  consists  of  a  64-bit 
routing prefix, which is used for routing the packets to the 
right  network,  and  a  64-bit  interface  identifier,  which 
identifies  the  specific  node  on  the  network  and  can 
essentially  be  a  random  number.  Thus,  IP  addresses  in 
MIPv6  can  identify  either  a  node  or  a  location  on  the 
network, or both. 
A router called home agent at the home network acts as 
the  mobile's  trusted  agent  and  forwards  IP  packets 
between  the  mobile's  correspondent  nodes  (CN)  and  its 
current location, called care-of address (Figure 1(a)). The 
MIPv6  protocol  also  includes  a  location  management 
mechanism called binding update (BU). When the mobile 
changes  its  current  address,  it  can  send  BUs  to  its 
correspondents  and  home  agent  to  notify  them  about  the 
new  location  so  that  they  can  communicate  directly 
(Figure 1(b)). The mobile may also be triggered to sending 
a BU when it receives a packet from a new correspondent 
via the home agent. 
The mobile node and its home agent have a permanent 
trust relationship and a preconfigured security association 
for  encrypted  and  authenticated  communication.  The 
mobile informs the home agent about its location via this 
secure tunnel. We assume these messages to arrive safely 
and  have  nothing  further  to  say  about  them.  The  mobile 
and  its  home  agent  can  cooperate  to  send  BUs  to  the 
correspondents,  with  which  they  often  have  no  pre-
existing  relationship.  The  correspondent  stores 
the 
location  information  in  a  binding  cache  entry,  which 
needs to be refreshed regularly by sending a new BU. The 
topic of this paper is the security of these BUs, which are 
sent to arbitrary correspondents.  
It  should  be  noted  that  there  are  several  alternative 
approaches  to  Internet  mobility  and  the  attacks  and 
protection mechanism identified in this paper are general 
enough  to  be  applicable  to  many  such  mechanisms.  It  is 
beyond  the  scope  of  this  work  to  compare  the  relative 
merits of the alternative mobility protocols.  
Another  issue  that  we  do  not  address  is  location 
privacy.  MIPv6  does  nothing  special  to  try  to  hide  the 
mobile's  home  address  or  current  location  from  others. 
Nevertheless,  the  protocol  is  relatively  privacy-friendly: 
the  mobile's  current  location  is  tracked  by  its  own  home 
agent but not by any global or public directory, the mobile 
is free to use temporary and multiple home addresses, and 
sending  BUs 
is  a  voluntary 
optimization for the mobile. 
to  correspondents 
2. Unauthentic Location Information 
This section gives a brief overview of the threats that 
result  from  not  authenticating 
information. 
Readers  familiar  with  the  topic  may  want  to  skip  to 
Section 3. 
location 
Unauthenticated location information makes it possible 
for  an  attacker  to  misinform  correspondents  about  the 
mobile's  location  and,  thus,  to  redirect  packets  intended 
for the mobile to a wrong destination. This can lead to the 
compromise of secrecy and integrity as well as denial-of-
service  because 
to 
communicate. 
target  nodes  are  unable 
the 
When sending false BUs, the attacker can use its own 
address as the false care-of address and pretend to be the 
mobile.  This  way,  it  can  highjack  existing  connections 
between  the  mobile  and  its  correspondents  or  open  new 
ones.  The  attacker  can  also  redirect  the  packets  to  a 
random or non-existent care-of address in order to disrupt 
communication  with  the  mobile.  It  has  to  send  a  new 
binding  update  every  few  minutes  to  refresh  the  binding 
cache entry at the correspondent. 
These attacks are alarming because the attacker can be 
anywhere  on  the  network  and  all  Internet  nodes  are 
potential  targets.  All  IPv6  nodes  must  support  the 
Proceedings of the 18th Annual Computer Security Applications Conference (ACSAC(cid:146)02) 
1063-9527/02 $17.00 ' 2002 IEEE 
correspondent  functionality  and  the  addresses  of  mobile 
nodes are indistinguishable from those of stationary ones. 
Thus,  the  attacker  can  make  any  node  believe  that  any 
other  node,  even  a  non-mobile  one,  is  mobile  and  has 
moved  to  the  false  care-of  address.  This  is,  to  some 
extent,  a  side  effect  of  the  effort  to  make  mobility 
transparent.  
In order to send false BUs, the attacker needs to know 
the  IP  addresses  of  both  the  communicating  nodes.  This 
means  that  nodes  with  have  well-known  and  permanent 
addresses, such as public servers and those using stateless 
auto-configuration  [TN98],  are  most  vulnerable.  They 
include nodes that are a part of the network infrastructure, 
such  as  DNS  servers,  which  are  particularly  interesting 
targets  for  DoS  attacks.  Frequently  changing  random 
addresses,  e.g.  ones  created  by  IPv6  addressing  privacy 
features [ND01], may mitigate the risks to some extent. 
Obviously,  end-to-end  encryption  and 
integrity 
protection of payload data, e.g. with authenticated SSL or 
IPSec,  can  prevent  the  attacks  against  data  secrecy  and 
integrity  but  not  denial-of  service.  Two  stationary  nodes 
that know each other to be stationary could be configured 
to refuse BUs from each other.  
We  have  considered  only  active  attackers  because  in 
order to redirect packets, the attacker must sooner or later 
send one or more messages. In fact, the active attacks are 
easier for the average attacker than passive ones would be. 
In  most  active  attacks,  the  attacker  can  initiate  the  BU 
protocol  execution  at  any  time  while  passive  attacks 
would require the attacker to wait for suitable messages to 
be sent by the target nodes. 
3. Authentication of Location Data 
This 
insecure 
section  discusses  proposed 
authentication 
methods for location information. The two first techniques 
(Sections 3.1-3.2) are relatively strong and involve public-
key  algorithms.  Section  3.3  presents  a  relatively  weak 
routing-based  authentication  methods  that  would  be 
labeled  as 
traditional  network  security 
thinking. Nevertheless, it provides a well-defined level of 
assurance  in  the  real  networks  and  can  complement  or 
even  replace  the  stronger  methods.  Instead  of  trying  to 
prevent  all  attacks,  the  best  strategy  is  often  to  limit  the 
number  of  potential  attackers  that  can  attack  a  particular 
target,  and  to  reduce  the  number  of  targets  a  potential 
attacker can threaten.  
in 
Any  authentication  protocol  has  to  take  into  account 
replay  attacks.  A  nonce-based  freshness  mechanism 
seems  practical  because  the  authentication  and  DoS 
protection  mechanisms described in Sections 3.3 and 4.2 
use  nonces  anyway.  Time  stamps  would  be  problematic 
because  mobile  nodes  may  not  be  able  to  maintain 
sufficiently accurate clocks. Sequence-numbered BUs, on 
the other hand, could be intercepted and delayed for later 
attacks.  
3.1. Public Key Authentication 
and 
computers 
An  obvious  solution  to  the  authentication  of  location 
information  would  be  to  use  a  suite  of  strong  generic 
authentication mechanisms and a trust infrastructure, such 
as  IPSec,  IKE  and  a  X.509-based  PKI.  There  are, 
however, reasons why the generic protocol suites may not 
be good for the purpose. First, the generic authentication 
protocols  have  usually  been  designed  with  general-
purpose 
security 
requirements  in  mind.  The  overhead  of  these  protocols 
can  be  too  high  for  low-end  mobile  devices  and  for  a 
network-layer  signaling  protocol.  Second,  an  Internet 