图12.17创建主机类型
选中的项目
---
## Page 359
有一个，连接外部网。接口臂可以有多个，连接租户网络的子网。
一个路由器。路由器有两种臂，一种是网关（gateway）臂，另一种是网络接口臂。网关臂只
任意创建。当一个租户的网络上的虚拟机需要和外部网络以及互联网通信时，这个租户就需要
址的IP地址。一般情况下，外部网络只有一个，且由管理员创建和管理。租户网络可由租户
访问互联网或者互联网访问虚拟机的途径。外部网络有一个子网A，它是一组在互联网上可寻
这个 Neutron 和物理网络下是一致的。Neutron 中子网隶属于网络。图 12.19 描述了一个典型
在Neutron中，它是可以创建和销毁的软部件。
功能，它是路由器和虚拟机挂接网络的着附点。
动态可创建和销毁的虚拟端口。
如果要和物理环境下的概念映射的话，这个对象相当于一个巨大的交换机，可以拥有无限多个
外，Neutron提供API来实现这种目标。Neutron中“网络”是一个可以被用户创建的对象，
的网络专业知识和经验。
址、交换机和路由器的配置和管理软件以及各种网络协议。要管理好一个物理网络需要非常多
为包括网线、交换机和路由器。当然，除了物理设备，还有软件方面的组成部分，例如IP地
络工程师来说，网络的盒子指的是交换机和路由器。所以在物理世界中，网络可以简单地被认
的Neutron网络结构。
下面首先介绍一下Neutron的几个基本概念。
日益强大，并在Horizon面板中已经集成该模块。为了能够使得读者更好地掌握网络的管理，
12.5.6
在图12.19中，存在一个和互联网连接的Neutron外部网络。这个外部网络是租户虚拟机
Neutron是OpenStack核心项目之一，提供云计算环境下的虚拟网络功能。Neutron的功能
在物理网络环境中，端口是用于连接设备进入网络的地方。Neutron中的端口起着类似的
Neutron 网络目的是划分物理网络，在多租户环境下提供给每个租户独立的网络环境。
简单地说，子网是由一组IP地址组成的地址池。不同子网间的通信需要路由器的支持，
4.子网
和物理环境下的路由器类似，Neutron中的路由器也是一个路由选择和转发部件。只不过
3.路由器
2.端口
在普通人的眼里，网络就是网线和供网线插入的端口，一个盒子会提供这些端口。对于网
1.网络
管理网络
第12章配置OpenStack私有云
347
---
## Page 360
348
已经拥有了一个名称为public_subnet，
击“网络”菜单项后显示当前网络列表，如图12.20所示。
CentOs7系统管理与运维实战
12.21所示。
从图12.20中可以得知，OpenStack已经默认创建了一个名称为public的外部网络，并且
接下来介绍如何在控制台中实现以上网络。管理员登录控制台，选择“管理员”面板，单
对于图12.19所示的网络结构，用户可以通过以下的步骤来实施：
（4）租户创建虚拟机。
（3）租户创建一个路由器并且连接租户子网和外部网络。
（2）租户创建一个网络和子网。
(1)首先管理员拿到一组可以在互联网上寻址的IP地址，并且创建一个外部网络和子网。
管理员
项目
openstack
主机情治
虚拟机管理器
交源使用微况
系统面板
主机类型
58.64.138.219/
由管理员创建和管理
子网
互联网
项目网络名子网已连
网络
网络
显示3个条目
gemo
demo
图12.19典型的Neutron网络结构
网关
网络地址为172.24.4.224/28的子网。
图12.20网络列表
pnate5subt1000.024
pobicsube122428FaleCTVEUP
sobne21215610/24
网络接口
子网A
FalsACTIVEUP
FaleACTIVEUP
由租户创建和管理
共率的状态管理员状态动作
租户A的网络A
子网B
网路惠
编络更务
---
## Page 361
口的名称，但是不能删除端口。
出了网络中的网络接口，包括名称、固定IP、连接设备以及状态等信息。管理员可以修改端
的子网，包含子网名称、网络地址以及网关等信息。用户可以添加或者删除子网。端口部分列
述了外部网络的重要属性，例如名称、ID、项目ID 以及状态等。子网部分列出了该网络划分
络列表窗口中，单击网络名称就可以查看相应网络的详细信息，如图12.22所示。
所以不再介绍创建新的外部网络的步骤，而是直接使用已有的名称为 public 的外部网络。在网
可以看到，网络详情主要包含3个部分，分别是网络概况、子网和端口。网络概况部分描
尽管Neutron支持多个外部网络，但是在多个外部网络存在的情况下，其配置会非常复杂，
刘象存站
ompute
↑
X口
创建网络
58.64.138.219/dashbo
管理员状态
网络抵况
网络详情：public
名称
显示1个条目
名称
子网
8890
图12.22public的网络详情
17224.4228
图12.21创建网络
连撞设备
224/28
Crouter_gateway
护做本
DOWN
网关P
第12章配置OpenStack私有
172.24.225
管理员状站
取消网
十子
编浦口
子网更多
349
---
## Page 362
CentOS7系统管理与运维实战
350
在“IP版本”下拉菜单中选择“IPv4”选项，在“网关IP”文本框中输入子网网关的IP地址，
文本框中输入网络的名称，例如 private3，单击“下一步”按钮，进入下一个界面。
列出了当前系统中可用的网络列表，如图12.23所示。
租户可以创建、删除属于自己的网络、子网以及路由器等。下面介绍如何管理租户网络。
例如192.168.21.1，如图12.25所示。单击“下一步”按钮，进入下一个界面。
网的名称，例如private_subnet2，在“网络地址”文本框中输入子网的ID，例如192.168.21.0/24，
（1）以普通用户demo登录控制台，在左侧的菜单中选择“网络”→“网络”，页面右侧
前面已经介绍过，除了外部网络之外，还有租户网络。租户网络主要包括子网、路由器等，
（3）如果需要创建子网，则选中“创建子网”复选框，在“子网名称”文本框中输入子
（2）单击“创建网络”按钮，打开“创建网络”窗口，如图12.24所示。在“网络名称”
openstack
对象存铺
云硬盘
Copute
C
网络
网络
显示2个条目
名称
管理员状态
创建网络
图12.23demo用户可用的网络
图12.24设置网络名称
private2_subnet192.168.1.0/24False
private_subnet 10.0.00/24
子网已连接
轻律不贸面所建其子网
共享的状态管理员状态动作
ACTIVEUP
创建网络厨除阿谷
下一步，
编辑网络更多
编辑网络更多
mo#出
一回文
---
## Page 363
可用的路由器，如图12.27所示。
网络连接到外部网络。
为了连通外部网络，租户还需要创建和设置路由器。下面介绍如何通过设置路由器将新创建的
地址，如图12.26所示。单击“已创建”按钮，完成网络的创建。
（1）以demo用户登录控制台，选择“网络”→“路由”菜单，
通过上面的操作，租户已经创建了一个新的网络，但是这个网络还不能与外部网络连通。
机路由
DS5域名析服务
创建网络
返回
魅翔网关
图12.26设置DHCP服务
创建网络
图12.25设置子网
ionetl
图
网指定
第12章配置OpenStack私有云
窗口右侧列出当前租户
351
---
## Page 364
352
口的IP地址，例如192.168.21.1，单击“增加接口”按钮，关闭对话框。
口部分列出了该路由器所拥有的连接到内部网络的接口。
概览和接口两个部分，路由概览部分列出了路由器的名称、ID、状态和外部网关等信息。接
建的路由器。从图中可以得知，该路由器已经连接到名称为 public 的外部网络。
CentOS7系统管理与运维实战
（2）单击路由器名称，打开“路由详情”窗口，如图12.28所示。该窗口主要包括路由
在图12.27中列出了一个名称为router1的路由器，该路由器为安装OpenStack时自动创
D58.6.138.219/dashboard/prjec/outes/64776946-81-465f-b8a-6f11Q=
项目
项目
openstack
X
对象存能
网络拓补
对象存货
网络
网络拓扑
网络
路由餐览：router1
路由详情
接口
名outer
显示2个条目
名称
接口
路由
路由
(25183944)
显示1个条目
(55455ae8)
router
名称
图12.27租户路由器列表
图12.28路由详情页面
10.0.0.1
192168.1.1
固定IP
Active
ACTIVE
状态
内部接口UP
内部接口
类型
public
管理员状态
动作
+增加拉口特遮口
海徐快更多
+新建路由验出
删按口
do退出
demo
Q=
退出
---
## Page 365
的另外一个接口连接到外部网络public。
192.168.1.1和192.168.21.1。实际上，这3个网络接口分别充当3个网络的网关。路由器routerl
机。这3个网络分别连接到路由器router1的3个接口上面，接口的IP地址分别为10.0.0.1、
其网络地址分别为10.0.0.0/24、192.168.1.0/24以及192.168.21.0/24，每个子网中都有几台虚拟
可以查看当前租户的网络拓扑结构，如图12.30所示。
这个虚拟机借助路由器就可以访问外部网络甚至互联网。选择“网络”→“网络拓扑”菜单，
从图12.30可以得知，demo租户拥有3个网络，其名称分别为private、private2和private3，
现在这个租户的路由器已经连接了外网和租户的子网，
openstack
C58.64.138.219/dashhoard/project/roters/6477h946-9981465f-b88a-68f1Q=
小正常
网络拓扑
leo
图12.30demo租户的网络拓扑结构
增加接口
名称
ard/p
图12.29增加接口
/0
twork_topo
ology
/0000
第12章配置OpenStack私有云
00
指定的子网连换到骼
，接下来这个租户可以创建虚拟机，
[取消盘加接位
自动云主机健网络新建路由
油器
☆
00
园
353
---
## Page 366
CentOS7系统管理与运维实战
354
菜单选择“cirros(12.5MB)”选项。
选项，创建一个CPU、20GB的硬盘以及2GB内存的虚拟机。“云主机数量”文本框中输入1，
拥有的实例，如图12.31所示。
虚拟机总是从一个镜像创建而来的。下面介绍如何管理实例。
12.5.7
所谓实例（instance），实际上指的就是虚拟机。之所以称为实例，是因为在OpenStack中，
单击右上角的“启动云主机”按钮，打开“启动云主机”对话框，如图12.32所示。在“云
管理实例
oppte
58
启动云主机
主机自动通
云主机验锁
云主机名称
192222
图12.32创建云主机
图12.31实例列表
虚积内快数量
项目银制
内存
峰盘
虚拟内核
案详情
51200中7
2.048MB
m1.smal
消
20.由的5元
10中记用
小，28分钟
---
## Page 367
命令：
12.34所示。
在“密钥对名称”文本框中输入密钥对的标识，例如key2。然后在终端窗口中执行以下
如果目前还没有密钥对，则可以单击右侧的一按钮，
↑
x8
公银
密钥对名称
导入密钥对
启动云主机
宁
Q
58.64.138.219/das
访词&安全将球
图12.34导入密钥对
图12.33选择密钥对
国
通过密钥对、防火墙、和其它机制控制你的云主机权限