需求自定义异常场景的检测条件，且支持全面分析仿冒邮件场景。
4）邮件多维分析：基于联系人之间收发关系的多维分析以及基于
恶意文件/ URL的传输路径的多维分析。通过关键信息进行检索，实现
数据之间的多维关系网。所有复杂的关系通过多维分析进行展现，数
据一目了然。
5）海量数据存储和检索：快速检索匹配邮件主题或者正文中的关
键字，结合统计学的相关理论，实现快速、精准的内容过滤和关键字
分析，并配套大量的检索和分析软件以对数据做到高效分析。
2. 产品在实战中的应用
在实战中，由于具有操作性好，易实施，一旦成功收益较大等特
点，钓鱼邮件攻击成为社工攻击中最重要的一种攻击方式。钓鱼邮件
攻击的方式多种多样，但主流的攻击方式大致可分为以下两种，邮件
威胁感知系统在防护时可以根据这两种攻击方式进行针对性的配置和
检测。
1）邮件正文插入恶意链接：这是一种最基础的攻击方式，就是在
邮件正文中放入一个恶意诱导链接，等待用户点击，链接后面是一个
伪造的网站，可能是一个恶意程序下载网站，或者一个用于伪造的登
录入口等。攻击者常常利用一些近期的热点事件或者公司内部信息
（如产品介绍、系统账号升级等）来提高内容可信度，诱导用户点击
链接。他们也会对恶意链接进行伪装，常见伪装方式有短链接、使用
HTML标签伪造隐藏、近似URL、子域名、利用URL特性等，防守者需要
对此重点防范。
2）邮件附件藏毒：这也是一种常见的攻击方式，攻击者的攻击载
荷（payload）含在邮件附件里，载体有文档、图片、压缩包、脚本程
序（exe、vbs、bat）等。发送脚本程序是最直接的，但是容易被邮箱
安全机制拦截或被相关人员识破。因此，攻击者通常会使用一些伪装
手段，如使用超长文件名隐藏后缀等，防守者在打开时要重点关注。
实战中可以通过串接部署的邮件代理转发模式、旁路部署的邮件
暗抄模式或者SPAN流量镜像解析模式对邮件流量进行识别和控制，以
防范钓鱼邮件的攻击。
9.2 安全检测设备
9.2.1 互联网资产发现系统
互联网资产是实战演练中攻击方首先可以接触到的资产，同时也
是防守方的重点防守对象。然而，大量组织未全面掌握暴露在互联网
上的IT资产，包括应用系统、域名、端口、应用服务、IP等。这就造
成了组织的防御边界出现了盲区，成为整个网络安全体系的重大短
板。甚至，在一些真实案例中，我们看到：一方面，组织在竭尽全力
检测、分析、抑制攻击；而另一方面，新的攻击却从一些“陌生资
产”源源不断地爆发出来。这些“陌生资产”就像黑洞一样，平时不
可见，关键时刻却吸引了大量攻击流量，造成整个防御体系的失效。
1. 设备应具有的核心功能
1）资产及应用发现：通过数据挖掘和调研的方式确定企业资产范
围，之后基于IP或域名，采用Web扫描技术、操作系统探测技术、端口
探测技术、服务探测技术、Web爬虫技术等各类探测技术，对参演单位
信息系统内的主机/服务器、安全设备、网络设备、工控设备、Web应
用、中间件、数据库、邮件系统和DNS系统等进行主动发现，并生成资
产及应用列表，列表中不仅包括设备类型、域名、IP、端口，更可深
入识别运行在资产上的中间件、应用、技术架构的详细情况（类型、
版本、服务名称等）。
2）信息安全资产画像绘制：在资产及应用发现的基础上，对每个
业务梳理分析，依据信息系统实际情况、业务特点、资产重要度等信
息，结合信息安全的最佳实践进行归纳，最终形成参演单位专属的资
产画像，构建起参演单位专属的信息安全资产画像。资产画像构建完
成后可根据域名、IP、端口、中间件、应用、技术架构、变更状态、
业务类型（自定义）等条件对资产进行查询和统计。
2. 产品在实战中的应用
互联网资产发现是攻防实战前期梳理资产中比较重要的一项工
作，通过资产发现平台，对暴露在互联网上的资产信息进行摸排和测
绘。做到摸清家底，为下一步针对资产进行安全检测提供依据。
可以通过产品或服务的方式进行，通过定期的资产发现降低被攻
击者利用的风险。
9.2.2 自动化渗透测试系统
自动化渗透测试工具可为渗透测试全过程提供专业的技术支持，
在渗透前期、中期、后期提高渗透测试效果，赋能渗透测试人员。
1. 设备应具有的核心功能
1）漏洞探测功能。对渗透目标进行自动化漏洞探测，有两种漏洞
探测方式：网站URL探测方式和IP地址探测方式。网站URL探测方式是
通过对目标进行指纹识别，收集中间件、通用网站框架、开发语言、
操作系统等指纹信息，从插件库中寻找与之相关的漏洞插件，发现存
在的漏洞。IP地址探测方式是对目标进行端口扫描，发现对外开放的
服务，识别对应的服务类型，寻找与之相关的漏洞插件，从而判断漏
洞是否存在。漏洞插件库包含的漏洞插件超过7000个，漏洞范围覆盖
Web、中间件、数据库、网络设备、操作系统、智能设备、移动终端、
工控设备等。漏洞探测功能能够发现的漏洞类型不限于SQL注入、
XXE、XSS、任意文件上传、任意文件下载、任意文件操作、信息泄
露、弱口令、本地文件包含、目录遍历、命令执行、错误配置。
而自动化渗透测试系统提供一键漏洞利用功能，能够执行命令、
执行SQL、上传文件、反弹Shell、上传Webshell、下载文件等。自动
化渗透测试系统提供的Web指纹库可识别超过600种CMS（内容管理系
统）。系统服务指纹能够满足常规系统服务的类型和版本识别。支持
场景化检测，可以根据需求快速定制至少包含常规测试、攻防演练、
靶场演练、安全能力评估在内的场景，从而满足定制化场景漏洞发现
的需求。单次任务不限制添加目标的数量，任务能够分布式并发执
行，从而保证高效率地发现漏洞。
2）漏洞利用功能。漏洞利用功能可以解决两个问题：一是可直接
探测指定的漏洞是否存在，如存在，则进一步自动利用此漏洞；二是
针对一些无法完全自动化发现的漏洞提供单独漏洞利用功能，例如，
在无法通过爬虫或者其他手段自动获取目标地址时，渗透人员只需要
手动填写相应的参数即可一键利用漏洞。漏洞利用功能可以把复杂的
漏洞利用过程简单化，大大提高渗透测试的效率，如通过输入Oracle
账号密码，实现一键提权、执行系统命令等效果。自动化渗透测试系
统也提供漏洞利用的高级功能，包括执行命令、执行SQL、上传文件、
反弹Shell、上传Webshell、下载文件等。
3）反弹交互式Shell功能。渗透人员可以通过内置的方法反弹交
互式Shell，该Shell与正常的Shell完全相同，可以执行vim、交互执
行操作等。自动化渗透测试系统支持所有的Unix操作系统进行远程控
制，可采用Python、Java、Bash反弹Shell，并提供示例代码方便渗透
人员快速利用该功能。此功能采用端口复用技术，使所有使用该功能
的人员可以通过同一个端口反弹Shell，并可以绕过防火墙设备对数据
连接端口的限制措施。此功能采用加密技术，保证传输的数据以密文
方式传输，从而保证远程控制无任何特征。
4）Webshell远程管理功能。自动化渗透测试系统的该功能采用加
密算法对传输的数据进行加密，保证数据传输过程中没有任何特征，
从而躲避各种流量分析设备的检测。该Webshell支持ASP、ASPX、
PHP、JSP语言编写的代码。对被控端代码进行变形处理可以绕过静态
Webshell查杀工具的检测。该功能支持文件管理、命令执行、数据库
管理、反弹Shell、文件上传、远程文件下载等。渗透人员利用该功能
可以直接管理服务器上线的文件，执行各种操作命令。自动化渗透测
试系统脚本语言提供内存马功能，保证被控服务器上没有任何文件
“落地”，恶意代码只运行在内存中，实现通过内存运行代码进行远
程控制的技术。
5）后渗透功能。通过后渗透功能对目标进行横向渗透。例如：发
现内网的网络拓扑情况，发现内网数据库漏洞，发现邮件服务器所在
的位置，甚至获取办公网段、运维主机或者域控制器的权限。
2. 产品在实战中的应用
在攻防实战前期：定期对对外提供服务的系统进行渗透测试，挖
掘可能存在的漏洞并及时修复；定期或有系统变更时对内部系统进行
渗透测试，利用工具提高漏洞挖掘的效率。在渗透测试前期，通过工
具可以进行批量信息收集，包括子域名发现、目录扫描、指纹识别
等。在渗透测试中期，可以针对目标的漏洞进行发现和利用。在渗透
测试后期，提供进入内网之后的横向渗透等功能，提升渗透测试效
果。
建议部署于内网安全管理区等区域中，在网络上保证测试目标可
达即可。
9.2.3 开源组件检测系统
开源软件为企业带来了极大便利，提高了开发效率，降低了成
本。然而，由于开源软件之间的依赖关系错综复杂，漏洞的隐蔽传染
和放大效果显著，给漏洞发现、漏洞消控带来了很大的挑战。当某个
开源软件出现漏洞时，企业可能会受到牵连。
近几年，随着开源社区的快速发展，开源软件被广泛应用，开源
软件的漏洞数量也在飞速增长。WhiteSource 2020年发布的报告显
示，开源软件漏洞呈现逐年增加的趋势，从2014年的不到2000个增加
到2019年的6000多个，增加了两倍多。
1. 设备应具有的核心功能
开源检测：对应用系统所涉及的开源组件进行精确识别，帮助企
业建立开源组件资产台账，输出每个软件系统的开源组件资产清单，
并给出对应的开源组件漏洞信息、开源协议信息、开源组件整改建议
等内容。同时，服务团队根据漏洞评估模型对输出的安全漏洞进行分
析，给出科学合理的漏洞整改优先级及整改建议，并对难以修复的开
源组件给出缓解加固建议，也可对无法修复的紧急漏洞提供验证。
2. 产品在实战中的应用
通过开展开源组件检测服务，识别应用系统所引入开源组件的安
全漏洞，对安全漏洞进行修复、加固，通过漏洞验证直观地展现存在
的安全风险，从而有效推动开发部门的整改积极性。降低应用系统开
源组件的安全风险，保障应用系统安全、稳定运行。
可通过部署开源组件产品或者购买相关服务的方式，及时跟踪开
源软件的漏洞信息，结合业务情况进行整改降低安全风险。
9.2.4 运维安全管理与审计系统（堡垒机）
运维安全管理与审计系统（堡垒机）基于认证、授权、访问、审