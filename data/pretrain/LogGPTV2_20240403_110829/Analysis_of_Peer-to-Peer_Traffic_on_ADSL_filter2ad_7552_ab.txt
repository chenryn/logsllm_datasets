0.50
0.40
0.30
0.20
0.10
0.00
1e+00
1e+01
1e+02
1e+03
1e+04
1e+05
Seconds
Fig. 4. Connection Duration
76
L. Plissonneau, J.-L. Costeux, and P. Brown
Table 2. Mean value of connection duration
eDonkey BitTorrent FastTrack WinMX
Signaling traﬃc
12s
Non-signaling traﬃc 1436s
22s
1670s
7s
356s
13s
2721s
as ﬁnished a connection after 5 seconds of inactivity as in [6] or ﬁlter out these
periods as in [14].
eDonkey and FastTrack connections are of shorter duration than BitTorrent
connections. BitTorrent encounters longer connection durations and also bigger
throughputs. We give the mean value of connection durations in Table 2.
As far as BitTorrent is concerned, a peer distributing or downloading a ﬁle
has a pool of 5 upload slots, i.e. only 5 other peers can download the ﬁle from
him. To ensure a certain fairness, these slots are reallocated periodically, but
the TCP connections are not closed. As a result, BitTorrent also encounters idle
times during the transfers and long connections.
The case of eDonkey is diﬀerent: a ﬁle is splitted into chunks. With the most
popular eDonkey client (eMule), when a peer has ﬁnished to download a chunk,
it should wait for another chunk in a queue, but the TCP connection between
the peers stays open.
The diﬀerence between BitTorrent on the one hand and eDonkey and Fast-
Track on the other hand is conﬁrmed by the connection duration distributions.
We ﬁnd again that a lognormal law ﬁts better eDonkey and FastTrack, whereas
BitTorrent’s connection durations fail to be well approximated by a classical law
(the K-S test doesn’t give a satisfactory answer).
Traﬃc Pattern over Time
3.4
In ﬁgure 5, we represent the traﬃc volume and the number of peers (transferring
more than one packet during the considered hour) for every hour of a week day
for eDonkey. The overall volume does not vary much throughout the day for
eDonkey: a small drop (about 20%) of transferred volumes is observed between
12pm (midnight) and 9am. This naturally correspond to a diminution of the
number of peers. This reduces the importance of time-of-day eﬀect observed in
[13], [7] and [8], the following ideas explain why:
– the main part of the traﬃc volume is generated by a small proportion of
users (10%, see Section 3.2), and these users are permanently connected to
the P2P network,
– peers download very large ﬁles which accounts for long durations of connec-
tions to the P2P network.
A closer look at Figure 5 shows that the upstream traﬃc is more stable
than the downstream one. This is also a consequence of the nature of peers
involved in the eDonkey network. The peers contributing to big volumes and
permanently connected are responsible for the main part of downstream and
Analysis of Peer-to-Peer Traﬃc on ADSL
77
Fig. 5. eDonkey Traﬃc Volume and Number of Peers over Time during a Week Day
upstream volumes, which are comparable. The other peers introduce a lot of
downstream traﬃc whereas they contribute in a smaller proportion to upstream
traﬃc.
For BitTorrent, the behavior is completely diﬀerent. The connections are
actually longer and the receiver sees many on and oﬀ times during its transfer,
so the traﬃc pattern is a bit skewed. It is interesting to note that one year ago,
the time-of-day eﬀect was clearly observable on BitTorrent’s traﬃc, as most of
the volume (85%) was usually transferred between 3p.m. and midnight in France.
With the increase of BitTorrent users, the traﬃc pattern is more regular over
the day.
In Figure 6, we expose the traﬃc volume and the number of active peers for
every hour of a week day for BitTorrent. From midnight to 5pm, the number of
peers is quite stable and so is the upstream volume. But it is surprising to see
downstream volume having high ﬂuctuations. We explain this by the functionnig
system of BitTorrent: in [15], the model corresponding to a BitTorrent-like ﬁle-
sharing system states that the service capacity (e.g. the total throughput) grows
with the peers involved in the ﬁle-transfer, resulting in a very good response
to ﬂash crowds (when many peers simultaneously ask for the same ﬁle). The
two peaks of downstream volume probably result from a sudden increase of the
number of distant BitTorrent peers. We can add that the ﬁle(s) corresponding
to this growth of peers should not be very big, indeed the peaks indicates that
the download time is less than two hours.
For FastTrack and WinMX, we observe a dynamic traﬃc pattern over the
day: users connect to these P2P networks mainly between 12am (noon) and
78
L. Plissonneau, J.-L. Costeux, and P. Brown
Fig. 6. BitTorrent Traﬃc Volume and Number of Peers over Time during a Week Day
12pm (night) for week days and all day long during week-ends. We explain this
phenomenon as follows:
– the afternoons and evenings are high activity periods for ADSL activity
(during week days),
– users download shorter ﬁles with Kazaa or WinMX, hence the P2P applica-
tions can be used for shorter periods of time.
For week-end days, the traﬃc pattern is completely diﬀerent. The whole
saturday and sunday morning are high activity periods for eDonkey transfers,
but they end at sunday noon! BitTorrent exhibits the same pattern but the
traﬃc distribution is more erratic.
3.5 Geographical Distribution of Peers
We locate the destinations of transfers over a week. We use a description ﬁeld
of IANA database to establish this geographical information.
The geographical distributions show that most of the traﬃc (about 30%)
heads to and from France, followed by U.S. for eDonkey and BitTorrent. On the
FastTrack and WinMX networks, U.S. is the primary source and destination of
transfers.
We have to remark that these distributions are very sensitive to the activity
of the week. Indeed in June 2003, we reported a majority of eDonkey traﬃc
coming from Germany.
Analysis of Peer-to-Peer Traﬃc on ADSL
79
Table 3. Distribution of the TCP-Flag of the last packet of connections
Flag of
last packet eDonkey BitTorrent FastTrack WinMX
NORMAL
SYN
FIN
PUSH
RESET
OTHER
20%
21%
6%
20%
7%
23%
9%
42%
5%
16%
11%
16%
15%
39%
4%
5%
11%
25%
20%
27%
5%
20%
9%
17%
The distinction of signalling traﬃc allows us to determine if the geographical
distribution of servers follows the distribution of peers. Our ﬁrst analysis indi-
cates that the distributions are similar, but small diﬀerences can give interesting
conclusions: e.g. Belgium encounters more small connections than big ones: in-
deed the most popular eDonkey indexing server (with 800,000 peers connected
to Razorback 2 ) lies in Belgium.
Termination of Connections
3.6
In order to characterize the termination of connections, we expose in Table 3
the connections with a normal TCP-ending (four-way handshake, denoted as
“NORMAL”), and for the other connections, we observe the TCP-Flag of the
last packets.
Here all four protocols have similar trends: only few connections end normally.
We have identiﬁed that a P2P client disconnecting from the P2P network results
in sending a RESET packet, this accounts for many connections. We also observe
a high percentage of connections that end abnormally, e.g. by a PUSH.
But the main remark here is that 20 to 40% of connections are only connection
attempts (the last packet of these connections is a SYN). The peers involved
in these connections (about 30% of peers) receive connection requests whereas
they are no longer connected to the P2P network. This is observable in Figure 3
by looking at users who have no upstream volume whereas they have some
downstream one (the vertical line at the left side of the ﬁgure). We explain this
by the delay in forwarding the information on peer availability across the P2P
network. At present, we are further investigating this issue because it can have
some inﬂuence on P2P networks.
4 Connectivity of Peers
Local Peer Connectivity
4.1
Now, we study the number of distant hosts contacted by a local user during
a day, i.e. the connectivity of a local peer. Figures 7 (a) and (b) show these
data over a complete day and over periods of two minutes spanning the day,
respectively. The results of the two minutes period graph represent the number
of simultaneous connections by user.
80
L. Plissonneau, J.-L. Costeux, and P. Brown
CDF of Connectivity
CDF of Simultaneous Connectivity
eDonkey
BitTorrent
FastTrack
WinMX
1.00
0.95
0.90
0.85
0.80
0.75
0.70
0.65
0.60
0.55
0.50
0.45
0.40
0.35
0.30
0.25
0.20
0.15
eDonkey
BitTorrent
FastTrack
WinMX
1.00
0.90
0.80
0.70
0.60
0.50
0.40
0.30
0.20
0.10
0.00
1e+01
1e+03
1e+05
(a) over the whole day
1e+01
1e+03
1e+05
(b) over periods of 2 minutes
Fig. 7. Number of diﬀerent IP addresses (X axis) connected to a local user
Firstly, the connectivity of eDonkey peers is greater. Indeed this protocol
generates a lot of connections between peers. Only 18% of the local eDonkey
peers contact a single peer, almost 50% of the local peers contact more than
10 other peers. Some eDonkey peers connect to more than 100,000 other peers,
which shows that we have a small number of eDonkey indexing servers among
the set of local peers.
The similarity of Figures 7 (a) and (b) tend to prove that peers establish
connections with other peers within periods of 2 minutes. Indeed, when a peer
begins to download a ﬁle, it tries to connect to all the peers having this ﬁle.
For BitTorrent, the downloading traﬃc presents a higher connectivity than
the signaling traﬃc: this is due to the information management, which is done
by a single tracker for each single ﬁle but the download is made from several
sources.
4.2 Distant Peer Connectivity
Now we investigate the connectivity of a non-local peer, i.e. the number of local
hosts connected to each distant peer. For this section, we can only distinguish
distant peers by their IP addresses. These results are computed over a pool of
1 Million distant peers, mainly eDonkey ones.
Only few local peers are connected to the same distant peer. We don’t see
any accumulation of connections on a distant IP address: traﬃc and requests
are well distributed over distant hosts.
eDonkey peers still have the densiest connectivity with 20% of the distant
peers being contacted by more than three local peers. For the three other pro-
tocols, about 80% of the distant peers are contacted only once by local peers.
Analysis of Peer-to-Peer Traﬃc on ADSL
81
The previous analysis allows us to identify highly connected peers. In this para-
graph, we characterize the traﬃc of eDonkey peers which connect to more than
10,000 other peers during the day. We report about 130 peers with this property.
These peers encounter same mean of connections sizes than other peers. But the
mean downstream volume transfered amounts to 500MBytes per peer and the
upstream one to 340MBytes per peer. As most of the traﬃc is generated by these
peers, their cumulative distribution function of the tranfers sizes is very similar
to those exposed in Figure 2.
5 Conclusion
In this paper, we compare the performance and characteristics of four P2P appli-
cations. Our measurement methodology allows us to deeply analyze a complete
set of traﬃc traces stemming from all the users of a regional ADSL area. We
derive many results dealing with characteristics of connections (volume, dura-
tion, termination of connections), localization of peers, traﬃc pattern over the
day and connectivity of peers.
Our study indicates ﬁrstly that, even for P2P traﬃc, most of the connections
are very short and represent a small volume, and secondly that very few users
contribute to the most signiﬁcant part of the traﬃc volume. The two kinds of
peers involved in P2P networks (i.e. those conributing to big volumes and the
other) strongly inﬂuence the functionning system of P2P ﬁle-sharing. We reveal
that even on a whole regional concentration point, users tend to download more
than they upload. We also ﬁnd that local peers tend to contact many diﬀerent
distant peers. Focusing on the packets sent at the termination of connections,
we detect that unsuccessful connection attemps represent a lot of connections,
and concern many users.
The persistency of our measures has allowed us to see a change of popularity
in P2P applications (FastTrack being overtaken by BitTorrent) and some changes
in the location of sources over a year.
Acknowledgements
We would like to thank our colleagues Anne-Marie Bustos and Denis Collange for
their contributions to the geographical analyses and the utilization of measure-
ments. A lot of improvements in the ﬁnal paper is due to anonymous reviewers,
we thank them for their detailed comments.
References
1. BitTorrent. www.bittorrent.com.
2. eDonkey. www.edonkey2000.com.
3. WinMX. www.winmx.com.
4. E. Adar and B. Huberman. Free riding on Gnutella. First Monday, 5(10), October
2000.
82
L. Plissonneau, J.-L. Costeux, and P. Brown
5. A. Asvanund, K. Clay, R. Krishnan, and M. Smith. An Empirical Analysis of Net-
work Externalities in P2P Music-Sharing Networks. In The 23rd Annual Interna-
tional Conference on InformationSystems (ICIS 02), Barcelona, Spain, December
15–19 2002.
6. N. Ben Azzouna and F. Guillemin. Analysis of ADSL traﬃc on an IP backbone
link. In Proceedings of Globecom 2003, San Fransisco, CA, USA, December 2003.
7. R. Bhagwan, S. Savage, and G. Voelker. Understanding Availability. In Proceedings
of the 2nd International Workshop on Peer-to-Peer Systems, Berkeley, CA, USA,
February 2003.
8. J. Chu, K. Labonte, and B. Levine. Availability and Locality Measurements of
Peer-to-Peer File Systems. In Proceedings of ITCom: Scalability and Traﬃc Control
in IP Networks, July 2002.
9. Thomas Karagiannis, Andre Broido, Nevil Brownlee, K. C. Claﬀy, and Michalis
Faloutsos. Is P2P dying or just hiding? In IEEE Globecom 2004 - Global Internet
and Next Generation Networks, Dallas, Texas, USA, December 2004.
10. Thomas Karagiannis, Andre Broido, Michalis Faloutsos, and K. C. Claﬀy. Trans-
In Internet Measurement Conference
port Layer Identiﬁcation of P2P Traﬃc.
(IMC), Taormina, Sicily, Italy, October 2004.
11. Sandvine Corporation.
Regional characteristics of P2P, October 2003.
www.sandvine.com.
12. Subhabrata Sen, Oliver Spatscheck, and Dongmei Wang. Accurate, Scalable In-
Network Identiﬁcation of P2P Traﬃc Using Application Signatures. In 13th Inter-
national World Wide Web Conference, New York City, 17–22 May 2004.
13. Subhabrata Sen and Jia Wang. Analyzing Peer-to-Peer Traﬃc Across Large Net-
works. IEEE/ACM Transactions on Networking, 2004.
14. K. Tutschku. A Measurement-based Traﬃc Proﬁle of the eDonkey Filesharing
Service. In Proceedings of Passive and Active Network Measurement (PAM 2004),
Antibes Juan-les-Pins, France, April 2004.
15. Xiangying Yang and Gustavo de Veciana. Service capacity in peer-to-peer net-
works. In Procedings of IEEE INFOCOM 2004, Hong Kong, March 2004.