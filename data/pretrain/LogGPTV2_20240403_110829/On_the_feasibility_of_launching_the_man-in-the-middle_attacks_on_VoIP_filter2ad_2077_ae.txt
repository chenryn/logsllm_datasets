(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:7)(cid:5)(cid:8)(cid:9)(cid:1)(cid:10)(cid:3)(cid:4)(cid:10)(cid:11)(cid:11)(cid:4)(cid:12)(cid:13)(cid:14)(cid:5)(cid:15)(cid:4)(cid:15)(cid:16)(cid:17)(cid:18)(cid:19)(cid:1)(cid:20)(cid:3)(cid:4)(cid:21)(cid:22)(cid:13)(cid:23)(cid:19)(cid:24)(cid:17)(cid:25)(cid:19)(cid:4)(cid:21)(cid:25)(cid:25)(cid:26)(cid:27)(cid:28)(cid:19)(cid:29)(cid:1)(cid:30)(cid:3)(cid:4)(cid:23)(cid:8)(cid:15)(cid:4)(cid:14)(cid:25)(cid:29)(cid:19)(cid:26)(cid:24)VoIP phone and protocols, we suggest the following strate-
gies
• Use SSL/TLS and SRTP to protect SIP messages and
voice RTP streams whenever possible. Note the im-
plementation of SSL/TLS or SRTP might introduce
new exploitable vulnerabilities. For example, the im-
plementation of Openssl versions 0.98 is vulnerable to
a remote heap overﬂow exploit, which could cause ar-
bitrary code executed [5]. Our experiments show that
none of the major commercial VoIP services (e.g., Von-
age, AT&T, broad voice) uses SSL or SRTP for the
VoIP traﬃc between the VoIP phone and the VoIP
server. It might be worthwhile to investigate what has
prevent the commercial service providers from deploy-
ing SSL/TLS and SRTP in their VoIP services.
• VoIP phones should have undergone extensive and in-
depth fuzz testing before being deployed. While this
may not be able to discover all the exploitable vulner-
abilities of the VoIP phone, it will at least raise the
bar for the attacker to identify and exploit any vulner-
ability.
• It might be worthwhile to develop some light-weight
VoIP intrusion detection system to be deployed at VoIP
phone. For example, a VoIP traﬃc anomaly IDS should
be able to detect our DNS spooﬁng attack when ob-
serving enormous DNS packets within a short period
of time.
6. RELATED WORK
Most previous work investigated the threats and intru-
sion detection approaches for VoIP servers. Reynolds et al
[19] proposed multi-protocol protection against ﬂooding DoS
attacks on VoIP servers. Wu et al [25] presented a cross
protocol intrusion detection architecture to detect certain
denial-of-service attacks on VoIP server. Sengar et al [23]
proposed to utilize interactive protocol state machines to
build intrusion detection systems. Dantu et al proposed a
multi-stage spam ﬁlter based on trust and reputation [16].
Since all these methods are designed to protect VoIP servers
side, they are unlikely eﬀective against the attacks on end
VoIP users.
Arkko et al [12] proposed a scheme to negotiate the secu-
rity mechanism between two SIP entities. Baugher et al [13]
proposed Secure Real-time Transport Protocol (SRTP) to
protect the media traﬃc. However, currently SRTP is not
widely being applied in deployed VoIP systems.
Salsano et al [21] evaluated the SIP processing overhead
when SIP authentication and TLS are employed. Bellovin et
al analyzed the challenges in applying the Communications
Assistance to Law Enforcement Act (CALEA) to wiretap
VoIP calls [14]. McGann and Sicker [17] analyzed detection
capability of several VoIP security tools: SiVuS, PROTOS
SIP Fuzzer [6], SIP Forum Test Framework and some com-
mercial products. They showed that there exists large gap
between known VoIP security vulnerabilities and the tool’s
detection capability. Zhang et al [26] empirically demon-
strated that the Vonage and AT&T CallVantage were vul-
nerable to billing attacks. Wang et al [24] systematically
studies the trust of current SIP-based VoIP and demon-
strated a number of call diversion attacks on Vonage and
AT&T VoIP users which can be used to launch voice pharm-
ing attacks on VoIP users.
Several previous work has explored the weaknesses in DNS
[3] [7]. However, to the best of our knowledge, there is no
published work on exploiting DNS weaknesses in deployed
VoIP environments.
7. CONCLUSION
While the MITM attack on VoIP has been known for
years, the feasibility of launching the MITM attack on de-
ployed VoIP has been seriously underestimated since all pre-
vious MITM attacks require the adversary to be initially in
the path of VoIP traﬃc.
The key contribution of this paper is that it demonstrates
that the adversary does not have to be initially in the path of
VoIP traﬃc to conduct the MITM attack. Our case study
of Vonage VoIP service shows that a remote attacker can
stealthily become a remote MITM and launch all kinds of
MITM attacks (e.g., wiretap, call hijacking) as long as he
knows the phone number and the IP address of the target
VoIP phone. Our results demonstrate that (1) the MITM at-
tack on VoIP is much more realistic than previously thought;
(2) securing all nodes along the path of VoIP traﬃc is not
adequate to prevent MITM attack on VoIP; (3) vulnerabil-
ities of non-VoIP-speciﬁc protocols (e.g., DNS) can indeed
lead to compromise of VoIP.
Acknowledgement
This work was partially supported by NSF Grants CNS-
0524286 and CCF-0728771.
8. REFERENCES
[1] Black Hat USA 2007 Brieﬁngs. URL.
http://www.blackhat.com/html/bh-usa-07/bh-usa-07-
speakers.html
[2] First Report and Order and Notice of Proposed
RuleMaking. URL.
http://www.fcc.gov/cgb/voip911order.pdf.
[3] DNSSEC. URL. http://www.dnssec.net/.
[4] IDC Anticipates 34 Million More Residential VoIP
Subscribers in 2010. URL.
http://www.idc.com/getdoc.jsp?-containerId
=prUS20211306.
[5] OpenSSL DTLS Implementation Remote Heap
Overﬂow Vulnerability. URL.
http://secwatch.org/advisories/1019254/
[6] PROTOS SIP Fuzzer. URL.
http://www.ee.oulu.ﬁ/research/ouspg/protos/testing
/c07/sip/
[7] SANS Institute. DNS Spooﬁng by The Man In The
Middle.
http://www.sans.org/reading room/whitepapers/dns
/1567 ˙php
[8] Snort. URL. http://www.snort.org/
[9] US VoIP market shares. URL.
http://blogs.zdnet.com/ITFacts/?p=11425.
[10] Vonage. URL. http://www.vonage.com/.
[11] Wireshark. URL. http://www.wireshark.org/
[12] J. Arkko, V. Torvinen, G. Camarillo, A. Niemi and T.
Haukka. Security Mechanism Agreement for the
Session Initiation Protocol (SIP). RFC 3329, IETF,
January 2003.
[13] M. Baugher,D. McGrew, M. Naslund, E. Carrara and
K. Norrman. The Secure Real-time Transport
Protocol (SRTP). RFC 3711, IETF, March 2004.
[14] S. Bellovin, M. Blaze, E. Brickell, C. Brooks, V. Cerf,
W. Diﬃe, S. Landau, J. Peterson and J. Treichler.
Security Implications of Applying the Communications
Assistance to Law Enforcement Act to Voice over IP.
http://www.cs.columbia.edu/ smb/papers/
CALEAVOIPreport.pdf
[15] F. Cao and S. Malik. Vulnerability analysis and best
practices for adopting IP telephony in critical
infrastructure sectors. Communications Magazine,
44(4), Pages 138-145, April 2006.
[16] R. Dantu and P. Kolan. Detecting spam in VoIP
networks. In Proceedings of the Steps to Reducing
Unwanted Traﬃc on the Internet Workshop (SRUTI
2005),Cambridge, MA, July 2005.
[17] S. McGann and D. C. Sicker. An analysis of Security
Threats and Tools in SIP-Based VoIP Systems. Second
VoIP Security Workshop, 2005.
[18] P. Mockapetris. Domain names - implementation and
speciﬁcation. RFC 1035, IETF, November 1987.
[19] B. Reynolds and D. Ghosal. Secure IP Telephony
Using Multi-layered Protection In Proceedgins of the
2003 Network and Distributed System Security
Symposium (NDSS 2003), Feburary 2003.
[20] J. Rosenberg, H. Schulzrinne, G. Camarillo, A.
Johnston, J. Peterson, R. Sparks, M Handley and E.
Schooler. SIP: Session Initiation Protocol. RFC 3261,
IETF, June 2002.
[21] S. Salsano, L. Veltri, D. Papalilo. SIP Security Issues:
the SIP Authentication Procedure and Its Processing
Load. IEEE Network, 16(6), Pages 38–44, 2002.
[22] H. Schulzrinne, S. Casner, R. Frederick and V.
Jacobson. RTP: A Transport Protocol for Real-Time
Applications. RFC 1889, IETF, January 1996.
[23] H. Sengar, D. Wijesekera, H. Wang, and S. Jajodia.
VoIP Intrusion Detection Through Interacting
Protocol State Machines. In Proceedgins of the 2006
International Conference on Dependable Systems and
Networks (DSN 2006), June 2006.
[24] X. Wang, R. Zhang, X. Yang, X. Jiang, D. Wijesekera:
Voice Pharming Attack and the Trust of VoIP. In
Proceedings of 4th International Conference on
Security and Privacy in Communication Networks
(SecureComm 2008), September 2008.
[25] Y. Wu, S. Bagchi, S. Garg, N. Singh. SCIDIVE: A
Stateful and Cross Protocol Intrusion Detection
Architecture for Voice-over-IP Environments In
Proceedgins of the 2004 International Conference on
Dependable Systems and Networks (DSN 2004), Pages
433 – 442, July 2004.
[26] R. Zhang, X. Wang, X. Yang, X. Jiang. Billing
Attacks on SIP-Based VoIP Systems. In Proceedings of
the First USENIX Workshop on Oﬀensive
Technologies (WOOT 2007), August 2007.