NT.549535DD 
CC.656C20E1 
CC.77DEB444 
…… 
APT Attributes 
Static 
Analysis 
Dynamic 
Analysis 
APT Taskforce 
Database 
Clustering ! 
Clustering 
APT Groups 
APT Attributes 
Exploit Concept 
Shellcode 
Malware Concept 
Code Snippet 
Xecure Engine 
Behavior 
Exploit CVE 
PE Information 
Network Concept 
C&C IP/Domain 
Protocol 
SC.5D5819EE 
SC.D810C601 
PE.EBD5880B 
PE.5A05A491 
CD.FC7939E2 
CD.102C752B 
CD.2AFB773A 
ML.47E1B4C6 
NT.549535DD 
CC.656C20E1 
CC.77DEB444 
…… 
Save to DB 
Extract Fingerprints 
Experiment 
Mila's provided APT sample 
archives are confirmed to malicious  
Those archives are open to public 
for downloading and analysis 
(Collection1, 242 APT files) 
The sample archives are used by 
many researchers 
http://contagiodump.blogspot.com/ 
Detection Rate 
 Xecure Inspector 
 94.62 % (229 / 242 ) 
 Definition updated to 2011/6/11 
 Microsoft Security Essentials 
 21.4 % (52 / 242) 
 Sophos 
 35.9 % (87/242) 
 AntiVir 
 56.6 % (137/242) 
There are 8 major APT-Taskforce Groups 
Group A 
Group B 
Group C 
Group D 
Group E 
Group F 
Group G 
Group H 
Groups of Mila Sample Set Collection1 
2011 
2010 
2009 
2008 
other 
Top 3 APT Taskforce Groups 
Group A 
Active 
2009-0923 ~ 2011-0420 
Number 
40 
CVE 
CVE-2009-4841, CVE-2009-0927, CVE-2009-3129, 
CVE-2009-4324, CVE-2010-0188, CVE-2010-2833, 
CVE-2011-0611, CVE-2011-0609 
Malware 
APT00010 
C&C 
IP:23, Domain: 5 
Group B 
Active 
2008-0414 ~ 2011-0211 
Number 
26 
CVE 
CVE-2006-6456, CVE-2008-0081, CVE-2009-1129, 
CVE-2009-4324, CVE-2010-0188, CVE-2010-2883, 
CVE-2010-3333 
Malware 
APT000A0 
C&C 
IP:23, Domain:4 
Group C 
Active  
2008-0904 ~ 2011-0413 
Number 
21 
CVE 
CVE-2007-5659, CVE-2008-4841, CVE-2009-1862, 
CVE-2009-3129, CVE-2009-4324, CVE-2009-0658, 
CVE-2009-0927,   
Malware 
APT00200 
C&C 
IP:5, Domain:11 
Malware of APT Group A 
Malware Attack Graph 
Malware Fix Suggestion 
Bot Command 
/get Remote Local 
/rsh [SHELL FILE] 
/shr [wins.exe] 
/put Local Remote 
/run Program 
/sleep MINIUTES 
C&C Location of APT Group A 
48.1% C&C IP located in Taiwan 
Malware of APT Group B 
Malware Attack Graph 
Malware Fix Suggestion 
C&C Location of APT Group B 
16% C&C IP located in Taiwan 
Malware of Group E 
Group-E 
Language = Korean  
Findings from Mila Sample Set (1/2) 
 Our analysis against Mila Sample set could identify 8 
major APT taskforces. 
 There are around 12 different CVEs and exploits are 
identified. 
 We have found that even APT taskforce uses 8-9 
different exploits, however, the type of malware used is 
limited to a few one. There is no surprise at all 
 We identify APT Taskforce based on CnC server 
location and malware they have used. The exploit the 
taskforce used is not very related to our analysis. 
Findings from Mila Sample Set (2/2) 
 Language used in APT sample： 
24% of the samples is from China          
 3.9% of the samples is from Korean        ， 
 We also found some are from Russia         and France         
 APT CnC server location Top 3 Ranking: 
 Taiwan (28%) 
 US 
 Hong Kong (HK is readily another CnC heaven )  
APT-Deezer  provides a free 
online service to check whether 
your submitted sample whether 
it is an APT sample 
We took Mila sample set as the base 
training set 
Identify Exploit CVE and Malware family 
Zero-Day Exploit detection and analysis 
APT Malware sample DNA analysis and 
comparison 
APT sample clustering and grouping 
Support file formats including 
DOC,PPT,XLS,PDF,RTF 
http://aptdeezer.xecure-lab.com 
Case Study A(1/4), Hong Kong APT! 
Case Study A(2/4), Hong Kong APT! 
 Characteristics: 
1.
A democratic party in HK2. 
2.
Fake as a staff in LEGCO council  
3.
Google cannot detect it 
4.
The email is sent before 1 July 
Case Study A(3/4), 
It is from Group-C 
 File:专责采访立法会新闻的记
者名单2011-6-12.xls 
Group: C 
Exploit: CVE-2009-3129 
BuildTime: 2011-02-14 
Case Study A(4/4), 
Malware of APT Group C 
Malware Attack Graph 
Malware Fix Suggestion 
C&C Location of APT Group C 
28.5% C&C IP located in China 
Case Study (1/4)  
Target Attack Mail has been signed !? 
又看到COMODO ! 
Signed and Verified 
(2/4)  Identify the APT Taskforce Group 
‘100620.pdf’ belongs to a 
known, newly discovered 
APT Taskforce in 2011. 
(3/4) 
 But Malware is a known family, it is same 
as APT-Group-B ! 
新一代的资安策略 - 情资导向的防护思维 
 正视威胁，谋定而后动 
 先进国家已将 APT 防护议题拉高至国家层级，而非视为个资外泄等民生议题。 
 工欲善其事，必先利其器 
 资安防护产业也正面临挑战，APT时代的来临可能意味著，将会越来越多针
对性的 Malware，难以利用蜜罐（honeypot）和蜜网（honeynet）诱捕到 
APT样本，因为仅有特定人士会收到这些天上掉下来的礼物。 
 正兵当敌，奇兵致胜 
 如果是以不变应万变，那迟早有被攻破的一天！防守方务必也要持续收集与
分析战情，才能知彼知己，百战百胜。 
 分析一系列的攻击活动并归纳奥义，才有办法归纳出攻击行动的组织、活动
甚至计划。 
 安全基准，最佳实务 
 落实执行资安政策，实体隔离，公务公办，严禁USB随身碟任意插拔等基本
要求都已推行多年。 
总结 
 APT有组织有计划的网路间谍活动，特别针对高价值目标如政治,经
济,高科技与军事。虽然是个新的热门名词，但是却存在已久。 
 APT以目标式攻击的恶意邮件为主要活动，其中使用各种  Zero-Day 
Exploit，与专门开发的 RAT，传统资安设备无法自动侦测与防御 
APT恶意邮件攻击。 
 要有正确的资安关念，才不会有错误的政策。APT恶意邮件不能只是
作一般病毒信件处理而敷衍过去，攻击事件将一再发生。 
 唯有透过大量且跨区域的APT样本分析才能观察到攻击全貌。目前观
察到香港，台湾与美国的APT样本有很高的相关性。 
 分析各国APT样本来看 APT活动前三大地区就占了超过一半比例，台
湾、美国与香港，其中台湾最高约 28% 。综观来看，亚洲是APT最
主要活动的地区。 
Any Feedbacks? Let us know! ;-)  
•
Xecure Lab (http://www.xecure-lab.com) 
•
We keep collecting samples for analysis 
•
Enhance the capability to analyze APT DNA 
family in more accurate manner. 
•
Together, we make homeland secured.