 将该值设置为0时，将使用系统的值。
 该参数在不同的会话之间不共享，也就是说不同的会话连接可能有不同的值。
 查看该参数时查出来的是当前会话连接内的参数值，而不是guc副本的值。
取值范围：0-3600，单位为s。
默认值：0
25.3.3.2 tcp_keepalives_interval
参数说明：在支持TCP_KEEPINTVL套接字选项的操作系统上，以秒数声明在重新传
南大通用数据技术股份有限公司
1194
GBase 8s V8.8开发者手册
输之间等待响应的时间。
该参数属于USERSET类型参数，请参考表15-15-1中对应设置方法进行设置。
取值范围：0-180，单位为s。
默认值：0
须知：
 如果操作系统不支持TCP_KEEPINTVL选项，这个参数的值必须为0。
 在通过Unix域套接字进行的连接的操作系统上，这个参数将被忽略。
 将该值设置为0时，将使用系统的值。
 该参数在不同的会话之间不共享，也就是说不同的会话连接可能有不同的值。
 查看该参数时查出来的是当前会话连接内的参数值，而不是guc副本的值。
25.3.3.3 tcp_keepalives_count
参数说明：在支持TCP_KEEPCNT套接字选项的操作系统上，设置GBase8s服务端在
断开与客户端连接之前可以等待的保持活跃信号个数。
该参数属于USERSET类型参数，请参考表15-15-1中对应设置方法进行设置。
须知：
 如果操作系统不支持TCP_KEEPCNT选项，这个参数的值必须为0。
 在通过Unix域套接字进行连接的操作系统上，这个参数将被忽略。
 将该值设置为0时，将使用系统的值。
 该参数在不同的会话之间不共享，也就是说不同的会话连接可能有不同的值。
 查看该参数时查出来的是当前会话连接内的参数值，而不是guc副本的值。
取值范围：0-100，其中0表示GBase8s未收到客户端反馈的保持活跃信号则立即断开
连接。
默认值：0
南大通用数据技术股份有限公司
1195
GBase 8s V8.8开发者手册
25.3.3.4 comm_proxy_attr
参数说明：通信代理库相关参数配置。
说明： - 该参数仅支持欧拉2.9系统下的集中式ARM单机。 - 本功能在线程池开启
状态下生效，即 enable_thread_pool 为 on。 - 配置该参数时需同步配置 GUC 参数
local_bind_address为libos_kni的网卡IP。- 参数模板：comm_proxy_attr='{enable_libnet:true,
enable_dfx:false,numa_num:4,numa_bind:[[30,31],[62,63],[94,95],[126,127]]}'- 可配置参数说
明。 -enable_libnet：是否开启用户态协议，取值范围：true、false。 -enable_dfx：是否开
启通信代理库视图，取值范围：true、false。 -numa_num：机器环境中numa的数量，支持
2P、4P服务器，取值范围：4、8。 -numa_bind：代理线程绑核参数，每个numa两个CPU
绑核，共numa_num组，取值范围：[0，cpu数-1]。
该参数属于POSTMASTER类型参数，请参考表15-15-1中对应设置方法进行设置。
取值范围：字符串，长度大于0。
默认值：'none'
25.4资源消耗
25.4.1 内存
介绍与内存相关的参数设置。
须知： 这些参数只能在数据库服务重新启动后生效。
25.4.1.1 memorypool_enable
参数说明：设置是否允许使用内存池。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：布尔型
 on表示允许使用内存池。
 off表示不允许使用内存池。
南大通用数据技术股份有限公司
1196
GBase 8s V8.8开发者手册
默认值：off
25.4.1.2 memorypool_size
参数说明：设置内存池大小。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，128*1024～INT_MAX/2，单位为KB。
默认值：512MB
25.4.1.3 enable_memory_limit
参数说明：启用逻辑内存管理模块。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：布尔型
 on表示启用逻辑内存管理模块。
 off表示不启用逻辑内存管理模块。
默认值：on
注意：
 若max_process_memory-shared_buffers-cstore_buffers-元数据少于2G，GBase8s强制把
enable_memory_limit设置为off。其中元数据是GBase8s内部使用的内存和部分并发参
数，如max_connections、thread_pool_attr、max_prepared_transactions等参数相关。
 当该值为off时，不对数据库使用的内存做限制，在大并发或者复杂查询时，使用内存
过多，可能导致操作系统OOM问题。
25.4.1.4 max_process_memory
参数说明：设置一个数据库节点可用的最大物理内存。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，2*1024*1024～INT_MAX，单位为KB。
南大通用数据技术股份有限公司
1197
GBase 8s V8.8开发者手册
默认值：12GB
设置建议：
数据库节点上该数值需要根据系统物理内存及单节点部署主数据库节点个数决定。建议
计算公式如下：(物理内存大小 -vm.min_free_kbytes)\*0.7/(1+ 主节点个数)。该系数的目
的是尽可能保证系统的可靠性，不会因数据库内存膨胀导致节点OOM。这个公式中提到
vm.min_free_kbytes，其含义是预留操作系统内存供内核使用，通常用作操作系统内核中通
信收发内存分配，至少为5%内存。即，max_process_memory= 物理内存 *0.665/(1+ 主
节点个数)。
注意： 当该值设置不合理，即大于服务器物理内存，可能导致操作系统OOM
问题。
25.4.1.5 enable_memory_context_control
参数说明：启用检查内存上下文是否超过给定限制的功能。仅适用于DEBUG版本。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：布尔型
 on表示启用最大内存上下文限制检查功能。
 off表示关闭最大内存上下文限制检查功能。
默认值：off
25.4.1.6 uncontrolled_memory_context
参数说明：启用检查内存上下文是否超过给定限制的功能时，设置不受此功能约束。仅
适用于DEBUG版本。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
查询时会在参数值的最前面添加标题含义字符串“MemoryContextwhitelist:”。
取值范围：字符串
默认值：空
南大通用数据技术股份有限公司
1198
GBase 8s V8.8开发者手册
25.4.1.7 shared_buffers
参数说明：设置GBase8s使用的共享内存大小。增加此参数的值会使GBase8s比系统
默认设置需要更多的SystemV共享内存。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，16~1073741823，单位为8KB。
shared_buffers 需要设置为 BLCKSZ 的整数倍，BLCKSZ 目前设置为 8KB，即
shared_buffers需要设置为8KB整数倍。改变BLCKSZ的值会改变最小值。
默认值：8MB
设置建议：
建议设置shared_buffers值为内存的40%以内。行存列存分开对待。行存设大，列存设
小。列存：(单服务器内存/单服务器数据库节点个数)*0.4*0.25。
如果设置较大的shared_buffers需要同时增加checkpoint_segments的值，因为写入大量
新增、修改数据需要消耗更多的时间周期。
25.4.1.8 segment_buffers
参数说明：设置GBase8s段页式元数据页的内存大小。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值说明：整型，16~1073741823，单位为8KB。
segment_buffers 需要设置为 BLCKSZ 的整数倍，BLCKSZ 目前设置为 8KB，即
segment_buffers需要设置为8KB整数倍。改变BLCKSZ的值会改变最小值。
默认值：8MB
设置建议：
segment_buffers 用来缓存段页式段头的内容，属于关键元数据信息，为了提高性能建
议常用的表的段头都能缓存在buffer中，不被置换出去。建议按照表的个数（包括索引和toast
表）* 分区数 *3+128 来设置。乘以3是因为每个表（分区）会有一些额外的元数据段，
南大通用数据技术股份有限公司
1199
GBase 8s V8.8开发者手册
一般一个表有3个段。最后+128因为段页式表空间管理需要一定数量的buffer。
25.4.1.9 bulk_write_ring_size
参数说明：大批量数据写入触发时（例如copy动作），该操作使用的环形缓冲区大小。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，16384~2147483647，单位为KB。
默认值：2GB
设置建议：建议导入压力大的场景中增加数据库节点中此参数配置。
25.4.1.10 standby_shared_buffers_fraction
参数说明：备实例所在服务器使用shared_buffers内存缓冲区大小的比例。
该参数属于SIGHUP类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：双精度浮点型，0.1~1.0
默认值：0.3
25.4.1.11 temp_buffers
参数说明：设置每个数据库会话使用的LOCAL临时缓冲区的大小。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
在每个会话的第一次使用临时表之前可以改变temp_buffers的值，之后的设置将是无效
的。
一个会话将按照temp_buffers给出的限制，根据需要分配临时缓冲区。如果在一个并不
需要大量临时缓冲区的会话里设置一个大的数值，其开销只是一个缓冲区描述符的大小。当
缓冲区被使用，就会额外消耗8192字节。
取值范围：整型，100~1073741823，单位为8KB。
默认值：1MB
南大通用数据技术股份有限公司
1200
GBase 8s V8.8开发者手册
25.4.1.12 max_prepared_transactions
参数说明：设置可以同时处于“预备”状态的事务的最大数目。增加此参数的值会使
GBase8s比系统默认设置需要更多的SystemV共享内存。
当GBase8s部署为主备双机时，在备机上此参数的设置必须要高于或等于主机上的，
否则无法在备机上进行查询操作。
该参数属于POSTMASTER类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，0~262143。
默认值：10
说明： 一般不需要对事务显式进行PREPARE操作，如果业务对事务进行显示
PREPARE操作，为避免在准备步骤失败，需要调大该值，大于需要进行PREPARE业务的
并发数。
25.4.1.13 work_mem
参数说明：设置内部排序操作和Hash表在开始写入临时磁盘文件之前使用的内存大小。
ORDERBY、DISTINCT和mergejoins都要用到排序操作。Hash表在散列连接、散列为基
础的聚集、散列为基础的IN子查询处理中都要用到。
对于复杂的查询，可能会同时并发运行好几个排序或者散列操作，每个都可以使用此参
数所声明的内存量，不足时会使用临时文件。同样，好几个正在运行的会话可能会同时进行
排序操作。因此使用的总内存可能是work_mem的好几倍。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，64~2147483647，单位为KB。
默认值：64MB
设置建议： > 依据查询特点和并发来确定，一旦work_mem限定的物理内存不够，算
子运算数据将写入临时表空间，带来5-10倍的性能下降，查询响应时间从秒级下降到分钟
级。 > >- 对于串行无并发的复杂查询场景，平均每个查询有 5-10 关联操作，建议
南大通用数据技术股份有限公司
1201
GBase 8s V8.8开发者手册
work_mem=50%内存/10。 >- 对于串行无并发的简单查询场景，平均每个查询有2-5个关联
操作，建议work_mem=50%内存/5。>- 对于并发场景，建议work_mem=串行下的work_mem/
物理并发数。 >- 对于BitmapScan的哈希表也会受到work_mem的限制，但不会被严格管
控下盘。完全Lossify的情况下，哈希表每占用1MB的内存，对应一次BitmapHeapScan的
16GB的页面（Ustore为32GB），达到work_mem上限后，会按此比例随数据访问量线性
增长。
25.4.1.14 query_mem
参数说明：设置执行作业所使用的内存。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：0，或大于32M的整型，默认单位为KB。
默认值：0
须知：
 如果设置的query_mem值大于0，在生成执行计划时，优化器会将作业的估算内存
调整为该值。
 如果设置值为负数或小于32MB，将设置为默认值0，此时优化器不会根据该值调
整作业的估算内存。
25.4.1.15 query_max_mem
参数说明：设置执行作业所能够使用的最大内存。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：0，或大于32M的整型，默认单位为KB。
默认值：0
须知：
 如果设置的query_max_mem值大于0，当作业执行时所使用内存超过该值时，将
报错退出。
南大通用数据技术股份有限公司
1202
GBase 8s V8.8开发者手册
 如果设置值为负数或小于32M，将设置为默认值0，此时不会根据该值限制作业的
内存使用。
25.4.1.16 maintenance_work_mem
参数说明：设置在维护性操作（比如VACUUM、CREATEINDEX、ALTERTABLEADD
FOREIGN KEY 等）中可使用的最大的内存。该参数的设置会影响VACUUM、VACUUM
FULL、CLUSTER、CREATEINDEX的执行效率。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，1024~INT_MAX，单位为KB。
默认值：16MB
设置建议：
 建议设置此参数的值大于work_mem可以改进清理和恢复数据库转储的速度。因为
在一个数据库会话里，任意时刻只有一个维护性操作可以执行，并且在执行维护性
操作时不会有太多的会话。
 当自动清理线程运行时，autovacuum_max_workers倍数的内存将会被分配，所以
此时设置maintenance_work_mem的值应该不小于work_mem。
 如果进行大数据量的cluster等，可以在session中调大该值。
25.4.1.17 psort_work_mem
参数说明：设置列存表在进行局部排序中，在开始写入临时磁盘文件之前使用的内存大
小。带partialclusterkey的表、带索引的表插入、创建表索引、删除表和更新表都会用到。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
须知： 同样，多个正在运行的会话可能会同时进行表的局部排序操作。因此，
使用的总内存可能是psort_work_mem的几倍。
取值范围：整型64~2147483647，单位为KB。
默认值：512MB
南大通用数据技术股份有限公司
1203
GBase 8s V8.8开发者手册
25.4.1.18 max_loaded_cudesc
参数说明：设置列存表在做扫描时，每列缓存cudesc信息的个数。增大设置会提高查
询性能，但也会增加内存占用，特别是当列存表的列非常多时。
该参数属于USERSET类型参数，请参考表15-1中对应设置方法进行设置。
须知： max_loaded_cudesc设置过高时，有可能引起内存分配不足。
取值范围：100~1073741823。
默认值：1024
25.4.1.19 max_stack_depth
参数说明：设置GBase8s执行堆栈的最大安全深度。需要这个安全界限是因为在服务
器里，并非所有程序都检查了堆栈深度，只是在可能递规的过程，比如表达式计算这样的过
程里面才进行检查。
该参数属于SUSET类型参数，请参考表15-1中对应设置方法进行设置。
取值范围：整型，100~INT_MAX，单位为KB。
默认值：2MB
设置原则： >- 数据库需要预留640KB堆栈深度，因此，此参数的最佳设置是=操作
系统内核允许的最大值（就是ulimit-s的设置）-640KB。 >- 如果设置此参数的值大于实
际的内核限制，则一个正在运行的递归函数可能会导致一个独立的服务器线程崩溃。在
GBase8s能够检测内核限制的操作系统上，将自动限制设置为一个不安全的值。 >- 因为
并非所有的操作都能够检测，所以建议用户在此设置一个明确的值。 >- 默认值2MB，这
个值相对比较小，不容易导致系统崩溃。
25.4.1.20 cstore_buffers