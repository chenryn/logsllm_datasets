HOW	
  TO	
  TRAIN	
  YOUR	
RFID	
  HACKING	
  TOOLS	
By	
  Craig	
  Young	
Security	
  Researcher	
Tripwire	
  VERT	
HOW	
  TO	
  TRAIN	
  YOUR	
  RFID	
  HACKING	
  TOOLS	
Table	
  of	
  Contents	
Introduction	
  .....................................................................................................................................................................	
  3	
RFID	
  At	
  A	
  Glance	
  .............................................................................................................................................................	
  4	
What	
  is	
  an	
  RFID	
  Tag	
  ...................................................................................................................................................................	
  4	
Low	
  Frequency	
  Cloning	
  (T55x7)	
  ...........................................................................................................................................	
  5	
High	
  Frequency	
  Cloning	
  ............................................................................................................................................................	
  6	
Introducing	
  the	
  Proxmark3	
  (pm3)	
  ..........................................................................................................................	
  7	
Proxmark3’s	
  FPGA	
  ......................................................................................................................................................................	
  7	
Proxmark3’s	
  CPU	
  ........................................................................................................................................................................	
  8	
Proxmark3’s	
  ADC	
  ........................................................................................................................................................................	
  9	
Proxmark3’s	
  Connections	
  ........................................................................................................................................................	
  9	
The	
  NXP	
  PN533	
  NFC	
  Transceiver	
  Chipset	
  ............................................................................................................	
  10	
RFIDler	
  .............................................................................................................................................................................	
  10	
RFIDler	
  Internals	
  ......................................................................................................................................................................	
  10	
3d	
  Printing	
  ......................................................................................................................................................................	
  11	
Printing	
  Process	
  ........................................................................................................................................................................	
  12	
Preparing	
  the	
  drawing	
  ...............................................................................................................................................................................	
  12	
Preparing	
  the	
  Plate	
  ......................................................................................................................................................................................	
  12	
Extrusion	
  ..........................................................................................................................................................................................................	
  12	
Movement	
  ........................................................................................................................................................................................................	
  12	
Retrieving	
  the	
  Print	
  .....................................................................................................................................................................................	
  12	
Printing	
  Pitfalls	
  .........................................................................................................................................................................	
  13	
Printing	
  Coil	
  (Antenna)	
  Forms	
  .............................................................................................................................................	
  13	
First	
  Antenna	
  Design	
  ..................................................................................................................................................................................	
  14	
BADge	
  Antenna	
  .............................................................................................................................................................................................	
  17	
Clipwnd	
  (Clipboard	
  with	
  a	
  Kick)	
  ...........................................................................................................................................................	
  18	
Business	
  Information	
  Modeling	
  (BIM),	
  3D	
  Scanning,	
  and	
  RFID	
  Hacking	
  ...............................................................	
  19	
Using	
  Proxmark3	
  like	
  a	
  Boss	
  ...................................................................................................................................	
  19	
Using	
  ‘lf	
  search’	
  ..........................................................................................................................................................................	
  19	
Printing	
  and	
  using	
  the	
  demodulated	
  buffer	
  ....................................................................................................................	
  20	
Developing	
  New	
  Features	
  for	
  The	
  Proxmark3	
  ...............................................................................................................	
  21	
Adding	
  real-­‐time	
  demodulation	
  of	
  AWID26	
  .....................................................................................................................................	
  22	
Simulation	
  of	
  AWID26	
  tags	
  from	
  facility-­‐code	
  and	
  card	
  number	
  .............................................................................	
  23	
Cloning	
  AWID26	
  from	
  facility-­‐code	
  and	
  card	
  number	
  .................................................................................................	
  24	
Replacing	
  LF	
  standalone	
  mode	
  with	
  NFC	
  functions	
  ......................................................................................................	
  25	
RFIDler:	
  The	
  New	
  Kid	
  on	
  the	
  Block	
  ........................................................................................................................	
  28	
RFIDlerPi	
  .....................................................................................................................................................................................	
  28	
Concluding	
  Remarks	
  ...................................................................................................................................................	
  28	
HOW	
  TO	
  TRAIN	
  YOUR	
  RFID	
  HACKING	
  TOOLS	
Introduction	
The	
  Tripwire	
  Vulnerabilities	
  and	
  Exposure	
  Team	
  (VERT)	
  has	
  been	
  evaluating	
  a	
  variety	
  of	
  approaches	
  for	
extending	
  the	
  functionality	
  of	
  our	
  RFID/NFC	
  analysis	
  tools.	
  This	
  ongoing	
  research	
  documents	
accomplishments	
  and	
  ideas	
  enabled	
  through	
  3D	
  printing,	
  firmware	
  enhancements,	
  and	
  device	
  pairing.	
The	
  tools	
  used	
  cross	
  functional	
  domains	
  ranging	
  from	
  devices	
  like	
  the	
  tiny	
  proxmark3	
  with	
  its	
  excellent	
software-­‐defined	
  radio	
  (SDR)	
  based	
  RFID	
  Swiss-­‐army	
  knife	
  to	
  the	
  more	
  “dish	
  washer”	
  looking	
  CubePro	
3d	
  printer.	
  The	
  collection	
  also	
  includes	
  a	
  DEF	
  CON	
  22	
  acquired	
  RFIDler	
  v22-­‐beta,	
  NXP	
  PN5333	
  USB	
  stick,	
ChameleonMini,	
  RaspberryPi,	
  and	
  USB	
  Armory	
  embedded	
  USB	
  stick.	
In	
  order	
  to	
  improve	
  upon	
  these	
  tools	
  it	
  is	
  critical	
  to	
  understand	
  how	
  they	
  work	
  at	
  various	
  levels	
  so	
  as	
  to	
recognize	
  their	
  potential	
  and	
  become	
  comfortable	
  with	
  using	
  them	
  in	
  new	
  ways.	
  Many	
  of	
  these	
  tools	
  are	
extremely	
  well	
  documented	
  with	
  respect	
  to	
  forums	
  and	
  wiki	
  articles	
  explaining	
  how	
  they	
  are	
  operated.	
Few	
  however	
  go	
  into	
  much	
  detail	
  regarding	
  how	
  to	
  get	
  started	
  working	
  in	
  the	
  source	
  code.	
  Although	
  in	
some	
  cases	
  developers	
  gladly	
  answer	
  questions,	
  it	
  can	
  be	
  intimidating	
  for	
  a	
  new	
  comer	
  who	
  might	
  not	
know	
  where	
  to	
  begin.	
  This	
  research	
  was	
  performed	
  partially	
  to	
  help	
  consolidate	
  some	
  of	
  the	
  information	
about	
  these	
  devices	
  making	
  it	
  easier	
  for	
  others	
  to	
  get	
  involved.	
  At	
  the	
  same	
  time	
  the	
  contributions	
  from	
this	
  project	
  are	
  intended	
  to	
  be	
  helpful	
  for	
  others	
  using	
  the	
  technology.	
Changes	
  to	
  the	
  proxmark3	
  firmware	
  (now	
  available	
  on	
  GitHub)	
  are	
  documented	
  in	
  a	
  tutorial-­‐like	
demonstration	
  for	
  working	
  with	
  both	
  high	
  frequency	
  and	
  low	
  frequency	
  tags	
  with	
  and	
  without	
  an	
attached	
  client.	
  The	
  feature	
  enhancements	
  introduce	
  functionality	
  specific	
  for	
  working	
  with	
  125kHz	
AWID27	
  tags	
  as	
  well	
  as	
  for	
  working	
  with	
  NFC	
  in	
  stand-­‐alone	
  mode.	
  For	
  AWID27,	
  the	
  changes	
  allow	
  the	
operator	
  to	
  act	
  as	
  a	
  reader	
  as	
  well	
  as	
  to	
  clone	
  or	
  emulate	
  cards	
  based	
  solely	
  on	
  numbers	
  found	
  on	
  a	
typical	
  AWID	
  card.	
  The	
  NFC	
  stand-­‐alone	
  mode	
  enhancement	
  allows	
  reading	
  and	
  emulating	
  a	
  UID	
  from	
ISO14443a	
  compatible	
  tags.	
  The	
  new	
  mode	
  also	
  allows	
  writing	
  a	
  captured	
  UID	
  onto	
  a	
  special	
  “magic”	
card.	
Identified	
  uses	
  for	
  3D	
  printing	
  focus	
  on	
  the	
  construction	
  of	
  antennas	
  using	
  3D	
  printed	
  forms	
  as	
  well	
  as	
concealment	
  of	
  hacking	
  devices.	
  The	
  use	
  of	
  3D	
  printing	
  for	
  making	
  coils	
  is	
  advantageous	
  due	
  to	
  the	
possibility	
  of	
  lower	
  cost	
  and	
  customized	
  antennas.	
  Device	
  concealment	
  is	
  also	
  explored	
  with	
  examples	
for	
  outfitting	
  a	
  clipboard	
  with	
  a	
  proxmark3,	
  creation	
  of	
  fake	
  badge	
  readers	
  and	
  fake	
  badges.	
  Applications	
range	
  between	
  practical	
  attack	
  scenarios	
  and	
  research	
  scenarios.	
  As	
  insecure	
  low-­‐frequency	
  access	
  cards	
still	
  dominate	
  the	
  workplace	
  and	
  NFC	
  technology	
  is	
  gaining	
  steam,	
  it	
  is	
  critical	
  to	
  get	
  our	
  tools	
  ready	
  now	
to	
  identify	
  emerging	
  threats.	
HOW	
  TO	
  TRAIN	
  YOUR	
  RFID	
  HACKING	
  TOOLS	
RFID	
  At	
  A	
  Glance	
RFID	
  tags,	
  badges,	
  and	
  cards	
  come	
  in	
  two	
  main	
  categories:	
  low	
  frequency	
  and	
  high	
  frequency.	
  As	
  of	
  May	
2013,	
  legacy	
  125-­‐kHz	
  proximity	
  technology	
  was	
  used	
  in	
  70%-­‐80%	
  of	
  all	
  physical	
  access	
  control	
  systems	
according	
  to	
  Stephanie	
  Ardiley,	
  product	
  manager	
  at	
  HID	
  Global.	
  Implantable	
  low	
  frequency	
  RFID	
  chips	
have	
  also	
  seen	
  widespread	
  use	
  for	
  identifying	
  lost	
  pets.	
  These	
  are	
  both	
  fairly	
  simplistic	
  systems	
  in	
  which	
the	
  reader	
  energizes	
  a	
  coil	
  to	
  power	
  up	
  a	
  chip	
  and	
  modulate	
  back	
  a	
  stored	
  number.	
  The	
  high-­‐frequency	
RFID	
  however	
  includes	
  applications	
  like	
  contactless	
  credit	
  cards,	
  public	
  transit	
  fare	
  cards,	
  smart	
  posters,	
and	
  other	
  functions	
  utilizing	
  Near	
  Field	
  Communication	
  (NFC)	
  built	
  around	
  ISO14443a.	
What	
  is	
  an	
  RFID	
  Tag	
The	
  RFID	
  tags	
  described	
  in	
  this	
  paper	
  are	
  passive	
  devices.	
  They	
  are	
  all	
  essentially	
  coils	
  of	
  wire	
  tuned	
  to	
  a	
connected	
  integrated	
  circuit.	
  When	
  the	
  coil	
  is	
  within	
  the	
  field	
  produced	
  by	
  the	
  carrier	
  signal	
  of	
  the	
reader,	
  it	
  induces	
  current	
  to	
  power	
  the	
  integrated	
  circuit.	
  The	
  chip	
  will	
  then	
  do	