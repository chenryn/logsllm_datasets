AT&/&Schtasks&/&Cron&
&
Owner/user&
enumera,on&
Indicator&
blocking&
Access&to&remote&services&with&valid&
creden,als&
&
Automated&or&scripted&data&
exﬁltra,on&
MBR&/&BIOS&rootkit&
&
&
Opera,ng&system&
enumera,on&
&
Pass&the&hash&
&
Size&limits&
Edi,ng&of&default&
handlers&
&
&
Security&soNware&
enumera,on&
&
&
&
Scheduled&transfer&
AT&/&Schtasks&/&Cron&
&
&
File&system&enumera,on&
&
&
&
&
$ building the attacker deck!
***https://attack.mitre.org/wiki/Main_Page  - 8-2015︎
Build catalog of attack patterns – MITRE ATT&CK  Framework – 8/2015***︎
Persistence&
Privilege&Escala,on&
Creden,al&Access&
Host&Enumera,on&
Defense&Evasion&
Lateral&Movement&
Command&and&Control&
Exﬁltra,on&
New&service&
Exploita,on&of&vulnerability&
OS/SoNware&
Weakness&
Process&enumera,on&
SoNware&
packing&
RDP&
Common&protocol,&follows&standard&
Normal&C&C&channel&
Modify&exis,ng&service&
Service&ﬁle&permissions&
weakness&
User&interac,on&
Service&enumera,on&
Masquerading& Windows&admin&shares&(C$,&ADMIN$)&
Common&protocol,&non-standard&
Alternate&data&channel&
DLL&Proxying&
Service&registry&permissions&
weakness&
Network&sniﬃng&
Local&network&conﬁg&
DLL&Injec,on&
Windows&shared&webroot&
Commonly&used&protocol&on&non-
standard&port&
Exﬁltra,on&over&other&network&
medium&
Hypervisor&Rookit&
DLL&path&hijacking&
Stored&ﬁle&
Local&network&
connec,ons&
DLL&loading&
Remote&vulnerability&
Communica,ons&encrypted&
Exﬁltra,on&over&physical&
medium&
Winlogon&Helper&DLL&
Path&intercep,on&
&
Window&enumera,on&
Standard&
protocols&
Logon&scripts&
Communica,ons&are&obfuscated&
Encrypted&separately&
Path&Intercep,on&
Modiﬁca,on&of&shortcuts&
&
Account&enumera,on&
Obfuscated&
payload&
Applica,on&deployment&soNware&
Distributed&communica,ons&
Compressed&separately&
Registry&run&keys&/&
Startup&folder&addi,on&
Edi,ng&of&default&handlers&
&
Group&enumera,on&
Indicator&
removal&
Taint&shared&content&
Mul,ple&protocols&combined&
Data&staged&
Modiﬁca,on&of&shortcuts&
AT&/&Schtasks&/&Cron&
&
Owner/user&
enumera,on&
Indicator&
blocking&
Access&to&remote&services&with&valid&
creden,als&
&
Automated&or&scripted&data&
exﬁltra,on&
MBR&/&BIOS&rootkit&
&
&
Opera,ng&system&
enumera,on&
&
Pass&the&hash&
&
Size&limits&
Edi,ng&of&default&
handlers&
&
&
Security&soNware&
enumera,on&
&
&
&
Scheduled&transfer&
AT&/&Schtasks&/&Cron&
&
&
File&system&enumera,on&
&
&
&
&
$ building the attacker deck!
***https://attack.mitre.org/wiki/Main_Page  - 8-2015︎
Build catalog of attack patterns – Updated 7/28/2016 ***︎
$ building the attacker deck!
***https://attack.mitre.org/wiki/Main_Page  - 1-2015, 10-2015, 7/28/2016︎
Build catalog of attack patterns – MITRE ATT&CK  Framework – 8/2015***︎
$ building the attacker deck!
***https://attack.mitre.org/wiki/Main_Page  - 8-2015︎
Defensive Strategies to Each ATT&CK Technique – Complimentary Cards︎
Persistence&
Privilege&
Escala,on&
Creden,al&
Access&
Host&
Enumera,on&
Defense&
Evasion& Lateral&Movement&
Command&and&
Control&
Exﬁltra,on&
New&service&
Exploita,on&of&
vulnerability&
OS/
SoNware&
Weakness&
Process&
enumera,on&
SoNware&
packing&
RDP&
Common&protocol,&
follows&standard&
Normal&C&C&
channel&
Modify&
exis,ng&
service&
Service&ﬁle&
permissions&
weakness&
User&
interac,o
n&
Service&
enumera,on&
Masquer
ading&
Windows&admin&
shares&(C$,&ADMIN$)&
Common&protocol,&
non-standard&
Alternate&data&
channel&
DLL&Proxying&
Service&registry&
permissions&
weakness&
Network&
sniﬃng&
Local&network&
conﬁg&
DLL&
Injec,on&
Windows&shared&
webroot&
Commonly&used&
protocol&on&non-
standard&port&
Exﬁltra,on&over&
other&network&
medium&
Hypervisor&
Rookit&
DLL&path&
hijacking&
Stored&ﬁle&
Local&network&
connec,ons&
DLL&
loading& Remote&vulnerability&
Communica,ons&
encrypted&
Exﬁltra,on&over&
physical&medium&
Winlogon&
Helper&DLL&
Path&
intercep,on&
&
Window&
enumera,on&
Standard&
protocol
s&
Logon&scripts&
Communica,ons&are&
obfuscated&
Encrypted&
separately&
Path&
Intercep,on&
Modiﬁca,on&of&
shortcuts&
&
Account&
enumera,on&
Obfuscat
ed&
payload&
Applica,on&
deployment&
soNware&
Distributed&
communica,ons&
Compressed&
separately&
Registry&run&
keys&/&Startup&
folder&
addi,on&
Edi,ng&of&default&
handlers&
&
Group&
enumera,on&
Indicator&
removal&Taint&shared&content&
Mul,ple&protocols&
combined&
Data&staged&
Modiﬁca,on&
of&shortcuts&
AT&/&Schtasks&/&
Cron&
&
Owner/user&
enumera,on&
Indicator&
blocking&
Access&to&remote&
services&with&valid&
creden,als&
&
Automated&or&
scripted&data&
exﬁltra,on&
MBR&/&BIOS&
rootkit&
&
&
Opera,ng&
system&
enumera,on&
&
Pass&the&hash&
&
Size&limits&
Edi,ng&of&
default&
handlers&
&
&
Security&
soNware&
enumera,on&
&
&
&
Scheduled&
transfer&
AT&/&
Schtasks&/&
Cron&
&
&
File&system&
enumera,on&
&
&
&
&
***https://attack.mitre.org/wiki/Main_Page  - 8-2015︎
$ building the defender deck!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
While mapping noticed something….︎
~  Some defensive techniques appear most often – Invest!!!!︎
-  Progression disruption – Time︎
-  Build anomalies and fake targets with trips – Scope Creep︎
-  Deception of phase exit – Predecessor/Successor︎
~  Some strategies seem to have little payoff but high investment ︎
-  Don’t bang head here!!!!︎
~  This made sense!  Spending time buried in Cyber Resiliency Engineering 
Framework – This validated the findings.︎
-  https://www.mitre.org/publications/technical-papers/cyber-resiliency-
engineering-framework︎
-  http://www2.mitre.org/public/industry-perspective/︎
$ tortuosa concept – attacking attacker’s plan!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
Noticed something more…︎
Got an Attacker Deck︎
Got a Defender Deck︎
Got a Progressive Board︎
…maybe a game?︎
$ tortuosa concept – attacking attacker’s plan!
Game Mock Up – Attacker Red Deck – Defender Blue Deck︎
$ maelstrom – are you playing with a full deck?!
Game Board – Give and take between attacker and defender︎
$ maelstrom – are you playing with a full deck?!
Card Anatomy – Progression, Cost, Upkeep, Usage – Build a Story︎
$ maelstrom – are you playing with a full deck?!
60+ unique attacker cards ︎
$ maelstrom – are you playing with a full deck?!
70+ unique defender cards ︎
$ maelstrom – are you playing with a full deck?!
$ maelstrom – actor game pieces︎
12 unique threat actor chips – face down ︎
$ maelstrom – act on objective cards︎
11 unique act on objectives – face down in middle ︎
$ maelstrom – methods of play︎
game board mockup – general rules︎
~  3 Versions – Easy, Tactical, Strategic︎
~  Dealt cards (easy), actively pick cards (tactical) or 
buy cards (strategic)︎
~  Choose number of attacker players︎
~  Attackers choose their Threat Actor︎
~  Attackers choose their Act on Objectives︎
~  Attackers seek to get to Act on Objectives 
through progression to win︎
~  Defenders prevent progression from Act on 
Objectives︎
~  Defender wins if sets the attacker pieces  back to 
Delivery 3 times or Recon 2 times︎
Rules!located!here…!
github.com/maelstromthegame/defcon24︎
$ maelstrom – is it playable?︎
game board mockup – game play – yeah its playable!!!︎
sample video of game play - https://vimeo.com/177304576︎
Use Cases︎
~ Education︎
-  Learn an attack lifecycle concept and make it part of a vocabulary︎
-  Build a security mindset in defenders who don’t do offense︎
~ Demonstration︎
-  Mini table top exercises︎
-  Defender practice - Investigator pattern recognition︎
-  Analysis and strategies for choosing technologies to win︎
-  Cost/Benefit analysis︎
~ Evangelism︎
-  Gamification as marketing︎
-  Helps to get the message to non security folks︎
$ maelstrom – are you playing with a full deck?!
$ build catalog of attack patterns – get more…︎
~ Rationalization︎
- 
Progression steps in a 1-6 effectiveness – Picked 6 because of a dice︎
- 
Cost rationalization based on a 1000 seat company︎
~ Prior Art︎
- 
Hacker, Hacker II, Ctrl-Alt-Hack, Elevation of Privilege, Exploits, STIXITS, 
Game of PWNs, Breaches, Cyber Attribution Dice︎
No one has an Offensive and Defensive game play with a 
progressive board based on research︎
Next Steps︎
~ Pursue︎
-  Submit work for upcoming CON talks, get input︎
~ Map to current attack patterns and developing patterns and play 
games︎
-  Played multiple rounds with investigators, red team members, engineers and 
others︎
-  Produce lessons from games︎
~ Digitizing and creating open source framework*** (wanna help?)︎
~ Expansion packs︎
~ Non-technical game development for kids (Spyder) ︎
~ Let others play and update their decks, watch their decks and collect 
strategies ;)︎
~ LASTLY, digitize and let the ‘machine rise and play itself’…︎
$ maelstrom – are you playing with a full deck?!
Contribute, follow, volunteer, get the latest developments!︎
~ twitter.com/cybermaelstrom︎
~ github.com/maelstromthegame/defcon24︎
~ to print your copy of the game – coming very soon︎
-  cards, poker chips – watch twitter for vendor information (working on getting a 
sku with the vendor to print)︎
-  game board – download the file from github above and print at FedEx or 
through vendor︎
~ adding cards – use twitter above for peer review ;) and possible 
addition︎
~ watch twitter and github for digitized version (contact twitter to 
volunteer to help) ︎
$ where to get maelstrom stuff!
~ MITRE - ATT&CK Framework︎
-  https://attack.mitre.org︎
~ MITRE - Cyber Resiliency Engineering Framework︎
-  https://www.mitre.org/capabilities/cybersecurity/resiliency︎
-  http://www2.mitre.org/public/industry-perspective/︎
~ Lockheed Martin – Cyber Kill Chain ®︎
-  http://www.lockheedmartin.com/content/dam/lockheed/data/corporate/documents/LM-White-
Paper-Intel-Driven-Defense.pdf︎
︎
︎ ~  Gerard Laygui ︎
~  Garrett Adler︎
~  Collin Frietzsche ︎
~  Brent Thibodo︎
~  Jerry Decime︎
~  Cale Smith︎
~  Tom Van Setten︎
~  George Mckee︎
~  Logan Browne︎
~  Darlene Leong︎
~  JR︎
$ credits!
$ questions?!
$ backup slides if anyone goes there︎
~ …so agile you say ︎
$ tortuosa concept – attacking attacker’s plan!
~ Agile SCRUM Methodology︎
Stories:︎
-  Replays︎
-  Snapshots︎
-  Predecessors and Successors – feigning completion︎
Sprints : ︎
-  Create resource unavailability – Maybe APT Team F uses AWS (during Team F 
stage block AWS)︎
-  Create resource contention – Flood targets?︎
-  Different teams using different tool sets︎
-  Build Project Backlog︎
-  Change Priorities︎
-  Cost:  Increase Time and Backlog︎
https://en.wikipedia.org/wiki/Scrum_(software_development)︎
$ tortuosa concept – attacking attacker’s plan!
$ sources︎
!
• 
[1]!!hDps://www.dhs.gov/what-security-and-resilience!
• 
[2]!hDps://www.whitehouse.gov/the-press-oﬃce/2013/02/12/presiden2al-policy-
direc2ve-cri2cal-infrastructure-security-and-resil!
• 
[3]!hDp://www.whitehouse.gov/the-press-oﬃce/2013/02/12/execu2ve-order-
improving-cri2cal-infrastructure-cybersecurity!
• 
[4]!hDps://en.wikipedia.org/wiki/Cyber_Resilience!
• 
[5]!hDps://www.mitre.org/publica2ons/technical-papers/cyber-resiliency-
engineering-framework!
• 
[6]!hDps://www.mitre.org/sites/default/ﬁles/pdf/11_4436.pdf!
• 
[7]!hDps://www.mitre.org/publica2ons/technical-papers/cyber-resiliency-
engineering-aid-the-updated-cyber-resiliency!
• 
[8]!hDps://www.mitre.org/sites/default/ﬁles/publica2ons/pr-15-1334-cyber-
resiliency-engineering-aid-framework-update.pdf!
• 
[9]!hDps://www.enisa.europa.eu/ac2vi2es/Resilience-and-CIIP/na2onal-cyber-
security-strategies-ncsss/ScotlandNCSS.pdf!
• 
[10]!hDps://www.axelos.com/best-prac2ce-solu2ons/resilia!
• 
[11]!hDps://blogs.microsop.com/cybertrust/2016/02/11/working-to-increase-the-
cyber-resilience-of-ci2es-around-the-globe/!
• 
[12]!hDp://www2.mitre.org/public/industry-perspec2ve/index.html!
• 
[13]!hDp://www2.mitre.org/public/industry-perspec2ve/guidance-execu2ves.html!
• 
[14]!hDp://www2.mitre.org/public/industry-perspec2ve/guidance-architects.html!
• 
[15]!hDp://www2.mitre.org/public/industry-perspec2ve/slicksheets/
disrup2ng_the_aDack_surface.html!
• 
[16]!hDp://csrc.nist.gov/publica2ons/draps/800-160/sp800_160_drap.pdf!
• 
[17]!hDp://nvlpubs.nist.gov/nistpubs/SpecialPublica2ons/NIST.SP.800-53r4.pdf!
• 
[18]hDp://www.lockheedmar2n.com/content/dam/lockheed/data/corporate/
documents/LM-White-Paper-Intel-Driven-Defense.pdf!
• 
[19]!hDp://mena.boozallen.com/content/dam/MENA/PDF/resilience-in-the-cyber-
era.pdf!
• 
[20]!hDps://www.hexiscyber.com/news/hot-topics/pt-2-integra2on-automa2on-
key-achieving-cyber-resilience!