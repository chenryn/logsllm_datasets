13 %
35 %
18 %
Low Signal
22,075
28 %
Muddled/No Filtering
5,178
7 %
Finally, we are left with preﬁxes that have indications of both no ﬁltering—
i.e., we observe TCP/445 traﬃc—and ﬁltering—i.e., the infectee list suggests we
should observe more TCP/445 traﬃc than we do. For cases where we observe
traﬃc from at least ﬁve infectees we conclude that the preﬁx has multiple policies.
In other words, we are conﬁdent in our determination that ﬁltering is occurring
within the preﬁx and yet we still observe TCP/445 traﬃc from the preﬁx. We
ﬁnd this happens in 18 % of the cases. As the size of the address blocks we
consider increases this is a natural ﬁnding that follows our intuition—i.e., that
the block would be split up into multiple policy domains. Finally, we have cases
where we observe TCP/445 traﬃc and there are also indications we should see
additional traﬃc, but from less than ﬁve infectees. In this case, we know ﬁltering
is not in use across the entire preﬁx and, even though we have some indication
that ﬁltering may be happening, we cannot conclude it is with conﬁdence. We
ﬁnd 7 % of the preﬁxes in this “muddled” state.
We next consider the fraction of each preﬁx we use to determine its ﬁlter-
ing policy. For each routed preﬁx, we calculate the fraction of the constituent
/24 blocks (i) with a known Conﬁcker infectee and (ii) where we conclusively
determine that ﬁltering is or is not present. Figure 3 shows the distribution of
preﬁxes according to these fractions. The “all” distribution in the plot shows the
expected preﬁx coverage based on the Conﬁcker infectee list, whereas the “clas-
siﬁed” distribution shows the fraction of /24 blocks we actually use in concrete
preﬁx classiﬁcations. Comparing the distributions shows that, when making a
classiﬁcation, we generally use more of the preﬁx (i.e., more /24s) than the
expectation predicts, which adds to our conﬁdence in the classiﬁcations.
Next, we examine the size of the routed preﬁxes we are able to concretely
classify. The distribution of the size of all routed preﬁxes we consider, as well
as the distributions of the routed preﬁx sizes for each concrete classiﬁcation we
make are given in Fig. 4. The ﬁgure shows that the distribution of network size
for networks we can concretely detect ﬁltering policy is similar to the distribution
of the size of all origin networks. In other words, neither our detection nor results
are biased by preﬁx size. Further, we ﬁnd that networks that ﬁlter TCP/445 are
slightly larger than networks that do not ﬁlter TCP/445. This perhaps indicates
that operators of larger networks are more diligent about security policy than
On the Power and Limitations of Detecting Network Filtering
175
F
D
C
1
0.8
0.6
0.4
0.2
0
All
Classified
1
0.8
0.6
0.4
0.2
F
D
C
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
0
1
Fraction of /24s on routed prefix with known Conficker
0
24
22
All
No Filtering
Filtering
Multiple Policies
16
14
18
20
12
Routed prefix size (/x network)
10
8
Fig. 3. CDF of the fraction of /24s on
a routed preﬁx with known Conﬁcker.
Fig. 4. CDF of the routed preﬁx sizes
on which we make judgements.
those of smaller networks. Finally, we ﬁnd that networks with multiple policies
are larger than networks with a single policy. As we note above, this is natural
because as network sizes increase the tendency to have multiple administrative
and policy domains to cope with a variety of situations arises.
Finally, we note that we are able to conﬁdently determine a single ﬁltering
policy in roughly half of the /23 and larger routed preﬁxes. This corresponds
to 699M IP addresses or 28 % of the routable addresses during the week of our
darknet data collection.
7 Limitations
From previous research we understand that full network outages—whether caused
by policy decisions or natural disasters—can be detected by the absence of traﬃc
arriving at darknets. Further, in the previous sections we illustrate that we can use
similar strategies to infer ﬁner-grained policy such as port blocking. As developed
thus far, both the course- and ﬁne-grained policy discovery requires big events—
i.e., a broad swatch of the Internet becoming unreachable or malware that is both
prevalent and energetically propagating.
A natural next question is whether the aggregate background radiation that
appears at darknet monitors provides enough information to form further general
understanding of policies across the Internet. To address this question we ﬁrst
determine the top TCP ports arriving at our darknet.3 We then calculate the
number of origin /24 networks that source each kind of traﬃc and compare this
to the total number of origin /24s we observe. Table 3 shows the results. In the
best case—port 80—we ﬁnd SYNs from only 18 % of origin /24s we observe.
This either means 82 % of the /24s either (i) are subject to policy blocking or
(ii) do not source radiation to port 80. We believe the latter is far more likely
3 We included UDP in our analysis, but elide it from this discussion due to space
constraints and its similarity with the TCP results.
176
M. Sargent et al.
Table 3. Percentage of /24s observed sending TCP SYNs to other prevalent destination
ports in the measured darknets.
Darknet # /24s Receiving % /24s w/SYN for
SYNs
2.0M
1.5M
1.7M
1.6M
1.6M
3.1M
100/8
105/8
23/8
37/8
45/8
All
TCP/80 TCP/139 TCP/1433 TCP/22
14.2 % 1.5 %
4.0 %
6.2 %
1.1 %
1.0 %
21.6 % 1.0 %
5.6 %
1.1 %
18.2 % 1.3 %
<1 %
<1 %
<1 %
<1 %
<1 %
<1 %
<1 %
<1 %
<1 %
<1 %
<1 %
<1 %
than the former. That is, background radiation does not in general energetically
target our darknet enough to develop a solid expectation that the traﬃc should
be there and hence draw conclusions about its absence. Further, for the other
top ports the prevalence is even smaller than for port 80 and, hence, makes any
conclusions about policy even more tenuous.
Therefore, our conclusion is that while the general technique of searching for
the absence of traﬃc can be useful, it has its limits.
8 Conclusions
This paper makes several high-order contributions:
Methodology: We develop a novel methodology for detecting service-level net-
work ﬁltering based on passive observation of traﬃc markers. While this aspect
of the Internet has been previously studied, our passive observation-based tech-
nique allows for developing an understanding at a breadth previously unattain-
able. Using Conﬁcker as our exemplar, we are able to conclusively determine
the network ﬁltering policy of 699M IP addresses or roughly 28 % of the routed
IPv4 address space. Although this is a modest fraction of the Internet, it is
much larger than previous attempts. For instance, the original Netalyzr study
[12] reports results from 100 K test runs. Even if each Netalyzr run represents a
/24 network our results cover 27 times as much of the Internet.
State of TCP/445: Of the address space we can conclusively assess, we ﬁnd
ﬁltering of outgoing TCP/445 traﬃc occurs in two-thirds of the cases. We also
note that as the size of the routed preﬁx under study increases the chance of
ﬁnding multiple service-level ﬁltering policies within the preﬁx also increases.
While we believe it is a natural and expected result that larger networks would
encompass more than one administrative and policy domain, we believe this
oﬀers a cautionary note in that aggregating too much of the network can dilute
any understanding we derive.
On the Power and Limitations of Detecting Network Filtering
177
Methodological Limitations: Finally, we illustrate that there are limits to
the methodology of using the absence of background radiation to infer policy. In
particular, we can leverage large events to infer policy, but more run-of-the-mill
instances of background radiation are not energetic and wide-spread enough to
allow us to form the expectation of traﬃc and hence draw conclusions when the
expectation fails.
Acknowledgments. We would like to thank Christian Kreibich for the Netalyzr data,
Phillip Porras for the Conﬁcker sinkhole data, and Vern Paxson for comments on an
earlier draft. This work is sponsored by NSF grants CNS-1213157, CNS-1237265, CNS-
1505790 and CNS-1111699.
References
1. Allman, M., Paxson, V., Terrell, J.: A brief history of scanning. In: Proceedings of
the ACM SIGCOMM Conference on Internet Measurement, IMC’07 (2007)
2. Bailey, M., Cooke, E., Jahanian, F., Nazario, J., Watson, D.: The internet motion
sensor: a distributed blackhole monitoring system. In: Proceedings of Network and
Distributed System Security Symposium, NDSS’05, pp. 167–179 (2005)
3. Benson, K., Dainotti, A., claﬀy, k., Aben, E.: Gaining insight into AS-level out-
ages through analysis of internet background radiation. In: Traﬃc Monitoring and
Analysis Workshop, TMA’13 (2013)
4. Beverly, R., Berger, A., Hyun, Y., claﬀy, k.: Understanding the eﬃcacy of deployed
internet source address validation ﬁltering. In: Proceedings of the ACM SIGCOMM
conference on Internet Measurement, IMC’09 (2009)
5. Bush, R., Hiebert, J., Maennel, O., Roughan, M., Uhlig, S.: Testing the reachability
of (new) address space. In: Proceedings of the SIGCOMM workshop on Internet
Network Management, INM’07, pp. 236–241. ACM, New York (2007)
6. CAIDA: Conﬁcker/Conﬂicker/Downadup as seen from the UCSD Network Tele-
scope. http://www.caida.org/research/security/ms08-067/conﬁcker.xml (2013)
7. Chien, E.: Downadup: attempts at smart network scanning. http://www.symantec.
com/connect/blogs/downadup-attempts-smart-network-scanning (2009)
8. Choﬀnes, D.R., Bustamante, F.E., Ge, Z.: Crowdsourcing service-level network
event monitoring. In: Proceedings of the Conference on Applications, Technologies,
Architectures, and Protocols for Computer Communications, SIGCOMM’10 (2010)
9. Comcast: Blocked ports list. https://customer.comcast.com/help-and-support/
internet/list-of-blocked-ports/
10. Dainotti, A., Squarcella, C., Aben, E., Claﬀy, K.C., Chiesa, M., Russo, M., Pescap´e,
A.: Analysis of country-wide internet outages caused by censorship. In: IMC ’11
(2011)
11. F-Secure: Threat Report H1 2014. http://www.f-secure.com/documents/996508/
1030743/Threat Report H1 2014.pdf (2014)
12. Kreibich, C., Weaver, N., Nechaev, B., Paxson, V.: Netalyzr: illuminating the edge
network. In: Proceedings of the ACM SIGCOMM Conference on Internet Mea-
surement, IMC’10 (2010)
13. Kristoﬀ, J.: Experiences with conﬁcker c sinkhole operation and analysis. In: Pro-
ceedings of Australian Computer Emergency Response Team Conference (2009)
178
M. Sargent et al.
14. Pang, R., Yegneswaran, V., Barford, P., Paxson, V., Peterson, L.: Characteristics of
internet background radiation. In: Proceedings of the ACM SIGCOMM conference
on Internet Measurement, IMC’04 (2004)
15. Porras, P., Saidi, H., Yegneswaran, V.: An analysis of conﬁcker’s logic and ren-
dezvous points. Technical report, SRI International (2009)
16. Richard, M., Ligh, M.: Making fun of your malware. In: Defcon 17 (2009)
17. University of Oregon: Route Views project. http://www.routeviews.org/
18. Wustrow, E., Karir, M., Bailey, M., Jahanian, F., Houston, G.: Internet background
radiation revisited. In: Proceedings of the ACM SIGCOMM Conference on Internet
Measurement, IMC’10 (2010)