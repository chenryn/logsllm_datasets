DzzOfﬁceRCEPHP 
​
 dzz/connect/oauth.php
SQLI 
​
 $_GET['bz']  dzz_io::authorize() 
 dzz_io::initIO()  $_GET['bz'] 
io_dzz
io_baiduPCS
io_ALIOSS
io_disk
 authorize()  io_disk 
 $this->_xss_check();
 $_POST  $_GET 
 $this->_xss_check();  $_POST 
 Discuz 
 Discuz 
 Discuz 
 authkey  random() 
 Discuz 
 authkey  Discuz  Discuz  authcode() 
authcode() 
 authkey[-10] 
 authcode() 
 dzz/shares/index.php
 authcode() 
  authkey[-10]
  authkey[-10] 
 tpQC
​
 php_mt_seed 
​
​
 php_mt_seed 
 authkey[-10]
 authkey[-10]  16^6*305=5117050880 
 authkey 
 authkey 
 authkey  dzzdecode( 
 core/api/wopi/index.php
RCE 
​
 Wopi::PutFile() 
​
 IO::setFileContent() 
​
 self::clean()
​
 ( "\n", "\r", '../')  ..././  self::initIO() 
 $io->setFileContent()  io_disk 
​
 path 
​
​