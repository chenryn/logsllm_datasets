User: How to automate the deployment of Docker containers? Please provide script code.
Assistant: There are two main ways to automate the deployment of Docker containers, one is to use Docker Compose, and the other is to use scripts. Here is an example using Docker Compose: 1. Create a docker-compose.yml file: ```yml version: '3.3' services: nginx: image: nginx container_name: nginx restart: always ports: - 80:80 volumes: - . /nginx.conf:/etc/nginx/nginx.conf networks: - app-network networks: app-network: driver: bridge ``` 2. Create nginx.conf file in the same directory: ```conf user nginx; worker_processes 1; error_log /var/log/nginx/error.log warn; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime.types; default_type application/octet-stream ; sendfile on; keepalive_timeout 65; gzip on; server { listen 80; server_name localhost; location / { proxy_pass http://web:3000; proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; Forwarded-For $remote_addr; } } } ``` 3. Use docker-compose up to start the container: ```bash docker-compose up -d ``` The above steps will automatically pull the Nginx image and create a named nginx container, and mount the ./nginx.conf file to the container's /etc/nginx/nginx.conf file, then map port 80 of the container to port 80 of the host, and finally add the container to the app-network network. The following is an example of using the script: 1. Create a deploy.sh script file: ```bash #!/bin/bash # Pull the latest code git pull origin master # Build a Docker image docker build -t myapp:latest . # Stop and Delete the old container docker stop myapp docker rm myapp # Start the new container docker run -d --name myapp -p 3000:3000 myapp:latest ``` 2. Add executable permissions and run the script: ```bash chmod +x deploy .sh ./deploy.sh ``` The above steps will automatically pull the latest code, build the Docker image, stop and delete the old container, and start the new container. It should be noted that this method requires manual configuration of Nginx reverse proxy and other specific deployment steps.