time, which measures how long a site remains part of the
Using the data from the Trajectory redirection crawler,
we categorize the redirection chains that lead users from
poisoned search results to the different scams used by
the GR botnet to monetize trafﬁc. Speciﬁcally, we se-
lected redirection chains that: (1) originated from one of
the doorway pages, (2) contained more than one cross
010002000300040005000# Search ResultsApr 11May 11Jun 11Jul 11Aug 11Sep 11Oct 11allsingle 9# Weeks# Compromised Sites020040060080010001200Figure 9: Relative breakdown of the categories
of scams that poisoned search results ultimately
take users.
site redirection, and (3) occurred while mimicking a Mi-
crosoft Windows user running Internet Explorer; as dis-
cussed below in Section 5.4.2,
the majority of redi-
rect chains observed while mimicking a non-Windows
user generally led to the RivaClick pay-per-click afﬁl-
iate program. We manually clustered the redirection
URLs based on similar URL characteristics, such as
the same PHP ﬁle with the same HTTP GET parame-
ters and arguments. For example, although http://
model-seil.ru/afro/index.php and http://
softwarename.ru/protect/index.php appear to
represent two separate hosts, they in fact resolve to the
same IP address. After clustering, we constructed a network
graph starting from doorways and ending at different kinds
of scams. This graph allows us to trace the scams where the
botmaster was an afﬁliate.
Previous work noted that SEO campaigns in general shift
between different afﬁliate programs over time [19]. There-
fore, for this analysis we arbitrarily divided the redirect
chains by the month when the chain was observed. Figure 9
shows the relative breakdown of the kinds of scams that the
redirection chains take users. The “misc” category refers to
crawls that we could not classify, such as redirections that
ultimately led to the Google search page, and “error” are
crawls that returned an HTTP error code or screenshot.
We see two distinct periods of scam targeting, with the
transition between the two coinciding with the 2011 fake
AV takedown [8]. Early on, from April through August,
the botnet redirects the majority of poisoned search results
to fake AV programs, presumably because of their prof-
itability [17]. We also see a varying amount of redirection
chains leading to counterfeit pharmaceutical programs, in-
cluding the GlavMed, Mailien, and RX-Partners programs,
although not nearly as prevalent as fake AV. From June
through August, we also see an increase in the proportion
Figure 10: Number of poisoned search results that
lead to RivaClick over time. Each line represents
a unique afﬁliate ID. The y-axis is truncated at 150
to show details (the max y-value is 1,231).
of search results directed to movdl.com, a pirated media
afﬁliate program. Redirection chains to movdl.com stop
in September, though.
After the fake AV takedown, the botmaster markedly
changes the scams targeted. In September, we see the in-
termediary node that sent trafﬁc to the one remaining fake
AV program now sending trafﬁc to a drive-by download af-
ﬁliate program. This target is also temporary, as by October
the botnet updates the SEO kit to version OEM and redi-
rects the majority of the trafﬁc to OEM afﬁliate programs
(TheSoftWareSellers and OEMPays), which continues until
December when we found that the GR botnet stops redi-
recting. Finally, pay-per-click is notably a steady safety net
throughout, and we explore it in more detail next.
5.4.2 RivaClick Trafﬁc Afﬁliate Program
Recall from Section 3.3 that we downloaded past versions
of the SEO kit. While crawling these past versions, we
found that the SEO campaign was actively redirecting users
to the URL:
http://www.rivasearchpage.com/
?aid=2277&said=0&n=10&q=[query]
This URL leads to a feed of URLs for the RivaClick Traf-
ﬁc Afﬁliate Program. RivaClick operates similarly to other
Internet advertising platforms. There are advertisers who
want to buy trafﬁc for a speciﬁc topic of interest, usually
determined by the user’s query string, and there are publish-
ers who sell trafﬁc. RivaClick groups the advertisers’ links
into a feed, which is provided to publishers who will receive
commissions on click trafﬁc to links from the feed. An im-
portant difference between RivaClick and other advertising
platforms is that RivaClick provides little guarantees about
Apr 11Jun 11Aug 11Oct 11Dec 11% Redirect Chains020406080100fakeavpharmaoemmovppcerrormiscdriveby050100150# Cloaked Search ResultsMar 11May 11Jul 11Sep 11Nov 11Jan 12810227725041678running on Mac OS X, and Mozilla Firefox running on
Linux. These three visits enable us to analyze the trafﬁc
segmentation policy employed by the botmaster based on
browser and operating system. Indeed, it appears that such
demultiplexing occurred from March through September.
As seen in Figure 11, only Mac OS X and Linux trafﬁc
led to RivaClick. Starting in August, when the botmaster
could no longer monetize Windows trafﬁc through fake AV
scams, trafﬁc from all platforms were redirected.
6 Conclusion
Overall, we ﬁnd that with modest resources the GR bot-
net can be very effective in poisoning search results, becom-
ing for months at a time the dominant source of poisoned
results. At the same time, we have seen two kinds of inter-
vention against the SEO botnet. The ﬁrst targets the botnet
directly, its infrastructure (compromised sites) and vector
(poisoned search results). Given that sites remain compro-
mised for months, cleaning up sites has not been effective
at undermining the botnet; indeed, even when we explic-
itly notiﬁed site owners about the malware, few reacted or
responded. Google, however, is more responsive, tagging
poisoned search results within a couple of days—but that
window is still presumably effective for the botmaster given
the intensity of the SEO activity. The second undermines
monetization, and appears to be much more effective. With
evidence of the importance of a “killer scam” in monetiz-
ing and driving innovation in SEO campaigns, we observe
substantially more activity from the botnet when the fake
anti-virus market is stable, whereas the botmaster appears to
scramble to monetize trafﬁc when the fake anti-virus mar-
ket is in ﬂux and the GR botnet becomes relatively idle.
Undermining monetization appears to be a potent response
to these types of attacks.
Acknowledgments
We thank Damon McCoy for insightful comments and
discussion of this work, Neha Chachra for the Trajectory
crawler, Erin Kenneally for legal oversight,
the anony-
mous reviewers for their valuable feedback. We also thank
David Dagon, the Georgia Tech Information Security Cen-
ter, and Damballa for domain sinkholes. This work was
supported in part by National Science Foundation grants
NSF-0433668 and NSF-1237264, by the Ofﬁce of Naval
Research MURI grant N000140911081, and by generous
support from Google, Microsoft, Yahoo, and the UCSD
Center for Networked Systems (CNS).
Figure 11: Number of poisoned search results that
lead to RivaClick depending on the OS/browser.
the quality of the trafﬁc being sold, which allows publish-
ers to dump trafﬁc obtained through search result poisoning.
Based on the URL extracted from a previous SEO kit and
the HTTP GET parameters from the URL, it appears that
the botmaster is an afﬁliate of RivaClick with ID 2277.
With this afﬁliate identiﬁer in hand, we retroactively ex-
amined poisoned search results from the Trajectory crawler
starting in March 2011. One pass of the search crawler cap-
tures the entire redirect chain for poisoned search results,
from the doorway, returned when the user ﬁrst clicks the
search result, through all the intermediary hops, and ﬁnally
the landing page. In this section, we focus on redirect chains
that landed on RivaClick.
Figure 10 shows the quantity of poisoned search re-
sults funneled into RivaClick per day for the four most-
frequently seen afﬁliates: 810, 1678, 2277, and 2504. Be-
cause we found these afﬁliates performing search result poi-
soning, we assume they are running similar black hat SEO
campaigns. Therefore, we compare the four afﬁliates to pro-
vide a sense for the relative size of the GR botnet and its
peers and competitors in terms of the number of search re-
sults leading to RivaClick (a more focused comparison than
Figure 7, which is in terms of all poisoned search results).
The GR botnet, as afﬁliate 2277, redirected a small but
steady number of search results to RivaClick for much of
2011, but then signiﬁcantly increases results to RivaClick
starting in October 2011 after the fake AV takedown. Mean-
while, the other afﬁliates were burstier. 1678 directed a
small burst from April–May, and 2504 directed a burst from
July–August. Finally, 810 redirected bursts from March–
June, but with far more intensity (max of 1231 on June 2).
As a result, it appears that 2277 is a long lasting, relatively
mid-size SEO afﬁliate of RivaClick.
Figure 11 focuses more closely on afﬁliate 2277. The
Trajectory search crawler visited each poisoned search re-
sult while mimicking three different browsers: Microsoft
Internet Explorer running on Windows, Mozilla Firefox
Mar 11May 11Jul 11Sep 11Nov 11Jan 11# Cloaked Search Results0100200300400500600700MSIEOS XLinuxReferences
[1] eMarketer.
eMarkter Press Release: Google’s
is Still Grow-
http://www.emarketer.com/
Mar.
Share of US Search Revenues
ing.
PressRelease.aspx?R=1008258,
2011.
[2] D. Goodwin. Search Ad Spending Could Hit $19.51
Billion in 2012. http://searchenginewatch.
com/article/2143093/
Search-Ad-Spending-Could-Hit-19.
51-Billion-in-2012-Report, Feb. 2012.
[3] Google. Google Safe Browsing API. http://
code.google.com/apis/safebrowsing/.
[4] C. Grier, L. Ballard, J. Caballero, N. Chachra, C. J.
Dietrich, K. Levchenko, P. Mavrommatis, D. McCoy,
A. Nappa, A. Pitsillidis, N. Provos, Z. Raﬁque, M. A.
Rajab, C. Rossow, K. Thomas, V. Paxson, S. Savage,
and G. M. Voelker. Browser Exploits as a Service: The
Monetization of Driveby Downloads. In Proceedings
of The 19th ACM Conference on Computer and Com-
munications Security, October 2012.
[5] J. P. John, F. Yu, Y. Xie, A. Krishnamurthy, and
M. Abadi. deSEO: Combating Search-Result Poison-
ing. In Proceedings of the 20th USENIX Security Sym-
posium, August 2011.
[6] C. Kanich, C. Kreibich, K. Levchenko, B. Enright,
V. Paxson, G. M. Voelker, and S. Savage. Spamalyt-
ics: an Empirical Analysis of Spam Marketing Con-
In Proceedings of the ACM Conference on
version.
Computer and Communications Security, Oct. 2008.
[7] J. M. Kleinberg. Authoritative Sources in a Hyper-
linked Environment. In Proceedings of the 9th ACM-
SIAM Symposium on Discrete Algorithms, 1998.
[8] B. Krebs.
Huge Decline in Fake AV Fol-
Shakeup.
Processing
Card
Credit
lowing
http://krebsonsecurity.com/2011/
08/huge-decline-in-fake-av-
following-credit-card-processing-
shakeup/, August 2011.
[9] C. Larsen.
Latest
SEP
(Search Engine
http:
1-7.
Part
Poisoning) Research,
//www.bluecoat.com/security/
security-archive/2012-02-15/
latest-sep-search-engine-poisoning-
research-part-1, Feb. 2012.
[10] N. Leontiadis, T. Moore, and N. Christin. Measur-
ing and Analyzing Search-Redirection Attacks in the
In Proceed-
Illicit Online Prescription Drug Trade.
ings of the 20th USENIX Security Symposium, August
2011.
[11] K. Levchenko, N. Chachra, B. Enright, M. F´elegyh´azi,
C. Grier, T. Halvorson, C. Kanich, C. Kreibich, H. Liu,
D. McCoy, A. Pitsillidis, N. Weaver, V. Paxson, G. M.
Voelker, and S. Savage. Click Trajectories: End-to-
End Analysis of the Spam Value Chain. In Proceed-
ings of the IEEE Symposium and Security and Privacy,
Oakland, CA, May 2011.
[12] L. Lu, R. Perdisci, and W. Lee. SURF: Detecting and
In Proc. of The 18th
Measuring Search Poisoning.
ACM Conference on Computer and Communications
Security, October 2011.
[13] M. Maunder.
Zero Day Vulnerability
http:
in many WordPress
//markmaunder.com/2011/08/01/
zero-day-vulnerability-in-many-
wordpress-themes/.
Themes.
[14] D. McCoy, A. Pitsillidis, G. Jordan, N. Weaver,
C. Kreibich, B. Krebs, G. M. Voelker, S. Savage,
and K. Levchenko.
PharmaLeaks: Understanding
the Business of Online Pharmaceutical Afﬁliate Pro-
grams. In Proceedings of the 21th USENIX Security
Symposium, 2012.
[15] T. Moore, N. Leontiadis, and N. Christin. Fashion
Crimes: Trending-Term Exploitation on the Web. In
Proceedings of The 18th ACM Conference on Com-
puter and Communications Security, October 2011.
[16] SEOmoz. PageRank, Link Patterns & the New Flow of
Link Juice. http://www.seomoz.org/blog/
pagerank-link-patterns-the-new-flow-
of-link-juice, May 2007.
[17] B. Stone-Gross, R. Abman, R. Kemmerer, C. Kruegel,
D. Steigerwald, and G. Vigna. The Underground
Economy of Fake Antivirus Software. In Proc. of the
10th Workshop on the Economics of Information Se-
curity (WEIS), 2011.
[18] A.-J. Su, Y. C. Hu, A. Kuzmanovic, and C.-K. Koh.
How to Improve Your Google Ranking: Myths and
In Proceedings of the IEEE/WIC/ACM In-
Reality.
ternational Conference on Web Intelligence, August
2010.
[19] D. Y. Wang, S. Savage, and G. M. Voelker. Cloak and
Dagger: Dynamics of Web Search Cloaking. In Pro-
ceedings of The 18th ACM Conference on Computer
and Communications Security, October 2011.
[20] Y.-M. Wang, M. Ma, Y. Niu, and H. Chen. Spam
Double-Funnel: Connecting Web Spammers with Ad-
In Proceedings of the 16th International
vertisers.
World Wide Web Conference (WWW’07), pages 291–
300, May 2007.
[21] B. Wu and B. D. Davison. Cloaking and Redirection:
A Preliminary Study. In Proc. of the SIGIR Workshop
on Adversarial Information Retrieval on the Web, May
2005.