IBM QRadar
Log Event Extended Format (LEEF)
Version 2
IBM
Note
Before using this information and the product that it supports, read the information in “Notices” on
page 11.
The Beta Program and this documentation is provided to you AS IS without any warranties express or implied, including
the warranty of merchantability or fitness for a particular purpose. IBM may choose, in its own discretion, to change
features and functions this Beta Program prior to being made generally available or choose not to make this Beta
Program generally available.
© Copyright International Business Machines Corporation 2013, 2021.
US Government Users Restricted Rights – Use, duplication or disclosure restricted by GSA ADP Schedule Contract with
IBM Corp.
Contents
Introduction..........................................................................................................v
Chapter 1. LEEF overview......................................................................................1
LEEF event components..............................................................................................................................1
Predefined LEEF event attributes................................................................................................................4
Custom event keys.......................................................................................................................................8
Best practices Guidelines for LEEF events ...........................................................................................8
Custom event date format...........................................................................................................................9
Notices................................................................................................................11
Trademarks................................................................................................................................................12
Terms and conditions for product documentation...................................................................................12
IBM Online Privacy Statement..................................................................................................................13
General Data Protection Regulation..........................................................................................................13
Privacy policy considerations ...................................................................................................................13
Glossary..............................................................................................................15
A.................................................................................................................................................................15
B.................................................................................................................................................................15
C..................................................................................................................................................................16
D.................................................................................................................................................................16
E..................................................................................................................................................................17
F..................................................................................................................................................................17
G.................................................................................................................................................................17
H.................................................................................................................................................................17
I..................................................................................................................................................................18
K..................................................................................................................................................................18
L..................................................................................................................................................................18
M.................................................................................................................................................................19
N.................................................................................................................................................................19
O.................................................................................................................................................................20
P..................................................................................................................................................................20
Q.................................................................................................................................................................20
R.................................................................................................................................................................20
S..................................................................................................................................................................21
T..................................................................................................................................................................22
V..................................................................................................................................................................22
W.................................................................................................................................................................22
iii
iv
Introduction to QRadar LEEF
The IBM® QRadar® Log Event Extended Format (LEEF) Guide provides information about how to construct
and implement syslog events for QRadar products in Log Event Extended Format (LEEF).
Intended audience
This guide is intended for all QRadar users who are responsible for investigating and managing network
security. To use this information, you must have access to QRadar products and a knowledge of your
corporate network and networking technologies.
Technical documentation
To find IBM Security QRadar product documentation on the web, including all translated documentation,
access the IBM Knowledge Center (http://www.ibm.com/support/knowledgecenter/SS42VS/welcome).
For information about how to access more technical documentation in the QRadar products library, see
QRadar Support – Assistance 101 (https://ibm.biz/qradarsupport).
Contacting customer support
For information about contacting customer support, see the Support and Download Technical Note
(http://www.ibm.com/support/docview.wss?rs=0&uid=swg21612861).
Statement of good security practices
IT system security involves protecting systems and information through prevention, detection and
response to improper access from within and outside your enterprise. Improper access can result
in information being altered, destroyed, misappropriated or misused or can result in damage to or
misuse of your systems, including for use in attacks on others. No IT system or product should be
considered completely secure and no single product, service or security measure can be completely
effective in preventing improper use or access. IBM systems, products and services are designed to be
part of a lawful comprehensive security approach, which will necessarily involve additional operational
procedures, and may require other systems, products or services to be most effective. IBM DOES NOT
WARRANT THAT ANY SYSTEMS, PRODUCTS OR SERVICES ARE IMMUNE FROM, OR WILL MAKE YOUR
ENTERPRISE IMMUNE FROM, THE MALICIOUS OR ILLEGAL CONDUCT OF ANY PARTY.
Please Note:
Use of this Program may implicate various laws or regulations, including those related to privacy, data
protection, employment, and electronic communications and storage. IBM Security QRadar may be used
only for lawful purposes and in a lawful manner. Customer agrees to use this Program pursuant to,
and assumes all responsibility for complying with, applicable laws, regulations and policies. Licensee
represents that it will obtain or has obtained any consents, permissions, or licenses required to enable its
lawful use of IBM Security QRadar.
© Copyright IBM Corp. 2013, 2021 v
vi IBM QRadar : Log Event Extended Format (LEEF)
Chapter 1. LEEF overview
The Log Event Extended Format (LEEF) is a customized event format for IBM Security QRadar.
Any vendor can use this documentation to generate LEEF events.
QRadar can integrate, identify, and process LEEF events. LEEF events must use UTF-8 character encoding.
You can send events in LEEF output to QRadar by using the following protocols:
• Syslog
• File import with the Log File Protocol
Important: Before QRadar can use LEEF events, you must complete Universal LEEF configuration tasks.
For more information about configuring the log file protocol to collect Universal LEEF events, see the DSM
Configuration Guide.
The method that you select to provide LEEF events determines whether the events can be automatically
discovered in QRadar. When events are automatically discovered the level of manual configuration that is
needed in QRadar is reduced.
As LEEF events are received, QRadar analyzes the event traffic in an attempt to identify the device or
appliance. This process is referred to as traffic analysis. It typically takes at least 25 LEEF events to
identify and create a new log source in QRadar. Until traffic analysis identifies the event source, the initial
25 events are categorized as SIM Generic Log DSM events and the event name is set as Unknown Log
Event. After the event traffic is identified, QRadar creates a log source to properly categorize and label
any events that are forwarded from your appliance or software. Events that are sent from your device are
viewable in QRadar on the Log Activity tab.
Important: When a log source cannot be identified after 1,000 events, QRadar creates a system
notification and removes the log source from the traffic analysis queue. QRadar is still capable of
collecting the events, but a user must intervene and create a log source manually to identify the event
type.
LEEF event components
The Log Event Extended Format (LEEF) is a customized event format for IBM QRadar that contains
readable and easily processed events for QRadar. The LEEF format consists of the following components.
Syslog header
The syslog header contains the timestamp and IPv4 address or host name of the system that is providing
the event. The syslog header is an optional component of the LEEF format. If you include a syslog header,
you must separate the syslog header from the LEEF header with a space. The syslog header must conform
to the formats specified in RFC 3164 or RFC 5424.
RFC 3164 header format:
Note: The priority tag is optional for QRadar.
The priority tag, if present, must be 1 - 3 digits and must be enclosed in angle brackets. For example,
.
Examples of RFC 3164 header:
• Jan 18 11:07:53 192.168.1.1
• Jan 18 11:07:53 myhostname
RFC 5424 header format:
© Copyright IBM Corp. 2013, 2021 1
Note: The priority tag is required.
1  
The priority tag must be 1 - 3 digits and must be enclosed in angle brackets. For example, . The
timestamp must be in the format: yyyy-MM-ddTHH:mm:ss.SSSZ.
Note:
• The 'T' must be a literal T character.
• The 'Z' can be a literal Z or it can be a timezone value in the following format: -04:00
Examples of RFC 5424 header:
• 1 2019-01-18T11:07:53.520Z 192.168.1.1
• 1 2019-01-18T11:07:53.520+07:00 myhostname
LEEF header
The LEEF header is a required field for LEEF events. The LEEF header is a pipe delimited (|) set of values
that identifies your software or appliance to QRadar.
Examples:
• LEEF:Version|Vendor|Product|Version|EventID|
• LEEF:1.0|Microsoft|MSExchange|4.0 SP1|15345|
• LEEF:2.0|Lancope|StealthWatch|1.0|41|^|
Event attributes
The event attributes identify the payload information of the event that is produced by your appliance or
software. Every event attribute is a key and value pair with a tab that separates individual payload events.
The LEEF format contains a number of predefined event attributes, which allow QRadar to categorize and
display the event.
Example:
• key=valuekey=valuekey=valuekey=value.
• src=192.0.2.0 dst=172.50.123.1 sev=5 cat=anomaly srcPort=81 dstPort=21 usrName=joe.black
Use the DelimiterCharacter in the LEEF 2.0 header to specify an alternate delimiter to the attributes.
You can use a single character or the hex value for that character. The hex value can be represented by
the prefix 0x or x, followed by a series of 1-4 characters (0-9A-Fa-f).
Table 1. Attribute Delimiter Character examples for LEEF 2.0
Delimiter Header
Caret ( ^ ) LEEF:2.0|Vendor|Product|Version|EventID|^|
Caret (hex LEEF:2.0|Vendor|Product|Version|EventID|x5E|
value)
Broken vertical LEEF:2.0|Vendor|Product|Version|EventID|xa6|
bar ( ¦ )
The following table provides descriptions for LEEF formats.
2 IBM QRadar : Log Event Extended Format (LEEF)
Table 2. LEEF format descriptions
Type Entry Delimiter Description
Syslog Header IP address Space The IP address or the host name of the software or appliance that
provides the event to QRadar.
Example:
192.168.1.1
myhostname
The IP address of the syslog header is used by QRadar to route
the event to the correct log source in the event pipeline. It is not
recommended that your syslog header contain an IPv6 address.
QRadar cannot route an IPv6 address present in the syslog header for
the event pipeline. Also, an IPv6 address might not display properly in
the Log Source Identifier field of the user interface.
When an IP address of the syslog header cannot be understood by
QRadar, the system defaults to the packet address to properly route
the event.
LEEF Header LEEF:version Pipe The LEEF version information is an integer value that identifies the
major and minor version of the LEEF format that is used for the event.
For example, LEEF:1.0|Vendor|Product|Version|EventID|
LEEF Header Vendor or Pipe Vendor is a text string that identifies the vendor or manufacturer of
manufacturer name the device that sends the syslog events in LEEF format.
For example, LEEF:1.0|Microsoft|Product|Version|EventID|
The Vendor and Product fields must contain unique values when
specified in the LEEF header.
LEEF Header Product name Pipe The product field is a text string that identifies the product that sends
the event log to QRadar.
For example, LEEF:1.0|Microsoft|MSExchange|Version|EventID|
The Vendor and Product fields must contain unique values when
specified in the LEEF header.
LEEF Header Product version Pipe Version is a string that identifies the version of the software or
appliance that sends the event log.
For example, LEEF:1.0|Microsoft|MSExchange|4.0 SP1|EventID|
LEEF Header EventID Pipe EventID is a unique identifier for an event in the LEEF header.
The purpose of the EventID is to provide a fine grain, unique identifier
for an event without the need to examine the payload information. An
EventID can contain either a numeric identified or a text description.
Examples:
• LEEF:1.0|Microsoft|MSExchange|2007|7732|
• LEEF:1.0|Microsoft|MSExchange|2007|Logon Failure|
Restrictions:
The value of the event ID must be a consistent and static across
products that support multiple languages. If your product supports
multi-language events, you can use a numeric or textual value in the
EventID field, but it must not be translated when the language of your
appliance or application is altered. The EventID field cannot exceed
255 characters.
LEEF Header Delimiter Character Pipe Use the DelimiterCharacter in the LEEF 2.0 header to specify an
alternate delimiter to the attributes. You can use a single character or
the hex value for that character. The hex value can be represented by
the prefix 0x or x, followed by a series of 1-4 characters (0-9A-Fa-f).
Chapter 1. LEEF overview 3
Table 2. LEEF format descriptions (continued)
Type Entry Delimiter Description
Event Attributes Predefined Key Entries Tab Event attribute is a set of key value pairs that provide detailed
information about the security event. Each event attribute must be
Delimiter
separated by tab or the delimiter character, but the order of attributes
Character
is not enforced.
For example, src=172.16.77.100
Predefined LEEF event attributes
The Log Event Extended Format (LEEF) supports a number of predefined event attributes for the event
payload.
LEEF uses a specific list of name-value pairs that are predefined LEEF event attributes. These keys outline
fields that are identifiable to IBM Security QRadar. Use these keys on your appliance when possible, but
your event payloads are not limited by this list. LEEF is extensible and you can add more keys to the event
payload for your appliance or application.
The following table describes the predefined event attributes.
Table 3. Pre-defined event attributes
Key Value type Normalized event Description
field? Yes or No
cat String Yes An abbreviation for event category is used to extend the EventID field with more
specific information about the LEEF event that is forwarded to QRadar.
Cat and the EventID field in the LEEF header help map your appliance event to a
QRadar Identifier (QID) map entry. The EventID represents the first column and the
category represents the second column of the QID map.
Restriction: The value of the event category must be consistent and static across
products that support multiple languages. If your product supports multi-language
events, you can use a numeric or textual value in the cat field. The value in
the cat field must not be translated when the language of your appliance or
application is altered.
cat (continued) String Yes Example 1: Use the cat key to extend the EventID with additional information
to describe the event. If the EventID is defined as a User Login event, use the
category to further categorize the event, such as a success or failed login. You can
define your EventIDs further with the cat key, and the extra detail from the event
can be used to distinguish between events when the same EventID is used for
similar event types, for example,
LEEF:1.0|Microsoft|Exchange|2013|Login Event|cat=Failed
LEEF:1.0|Microsoft|Exchange|2013|Login Event|cat=Success
Example 2: Use the cat key to define a high-level event category and use the