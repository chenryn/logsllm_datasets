down the C&C server and perform an ofﬂine analysis of
the server to reconstruct information [21]. A less inva-
sive approach is to (automatically) reverse-engineer the
communication protocol used by the botnet and then im-
personate a bot [4, 6, 15, 32]. This enables a continuous
collection of information about the given botnet, e.g., to
gather the spam templates used by the bots [6].
BOTMAGNIFIER complements these approaches: we
are able to track spamming botnets on the Internet in a
non-invasive way from a novel vantage point. The in-
formation generated by our tool enables us to perform a
high-level study of botnets. For example, we can track
their size and evolution over time, and obtain a live view
of hosts that belong to a particular botnet.
Ramachandran et al. also analyzed queries against a
DNSBL to reveal botnet memberships [27], but their
motivation is completely different from ours: the intu-
ition behind their approach is that bots might check if
their own IP address is blacklisted by a given DNSBL.
Such queries can be detected, which discloses informa-
tion about infected machines. BOTMAGNIFIER is com-
plementary with respect to this approach because it an-
alyzes intrinsic traces left by spamming machines (i.e.,
an email server will query the DNSBL for information),
and clustering and enriching this data enables us to ﬁnd
spambots in a generic way. Furthermore, we demon-
strated that our approach can also be used on other kinds
of transaction logs.
Spam Studies. Several studies analyzed spam and the
side-effects of this business [2, 12, 16, 42, 43]. BOT-
LAB [11], a tool to correlate incoming spam mails with
outgoing spam collected by executing known bots in an
analysis environment, shares some characteristics with
our approach. The analysis results of BOTLAB can ap-
proximate the relative size of different spamming bot-
nets and provide insights into current spam campaigns
based on the information collected at the site running the
tool. In contrast, BOTMAGNIFIER enables us to detect
IP addresses of hosts that belong to spamming botnets
at an Internet-wide level. We use the analysis environ-
ment only to collect information that enables us to as-
sign labels to spam campaigns, while all other analysis
techniques (e.g., the DNSBL analysis) are different com-
pared to BOTLAB.
Another system that shares some similarities with our
approach is AUTORE [40], which examines content-
level features in the email body such as URLs to group
spam messages into campaigns. The authors performed a
large-scale evaluation based on mail messages collected
by a large webmail provider to generate signatures to de-
tect polymorphic modiﬁcations for individual spam cam-
paigns. Xie et al. also examined characteristics of the
spam campaigns, similar to our work. In contrast, our
approach focuses primarily on the behavioral similarities
between members of a spamming botnet, without requir-
ing knowledge of the actual spam content.
Spam Mitigation. The typical approaches to detect
spam either focus on the content of spam messages [3,
22, 40] or on the analysis of network-level features [10,
25, 26, 28, 29, 38]. BOTMAGNIFIER generates lists of IP
addresses that belong to spamming botnets, which com-
plements both kinds of approaches: the analysis results
can be used to improve systems that use network-level
features to detect spambots, e.g., by proactively listing
such IP addresses in blacklists, or complement existing
systems, as demonstrated in Section 6.3. Furthermore,
the information can be used to notify ISPs about infected
customers within their networks.
8 Conclusion
We presented BOTMAGNIFIER, a tool for tracking and
analyzing spamming botnets. The tool is able to “mag-
nify” an initial seed pool of spamming IP addresses
by learning the behavior of known spamming bots and
matching the learned patterns against a (partial) log of
the email transactions carried out on the Internet. We
have validated and evaluated our approach on a number
of datasets (including the ground truth data from a bot-
net’s C&C hosts), showing that BOTMAGNIFIER is in-
deed able to accurately identify and track botnets.
Future work will focus on ﬁnding new data inputs that
can either populate our initial seed pools or on obtain-
ing a different, more comprehensive transaction log to be
able to identify spamming bots more comprehensively.
Also, analyzing larger data streams might allow us to ap-
ply more features for our magniﬁcation process, produc-
ing more complete results.
Acknowledgments
This work was supported by the ONR under grant
N000140911042,
the National Science Foundation
(NSF) under grants CNS-0845559 and CNS-0905537,
and the Ministry of Economic Affairs and Energy of
the State of North Rhine-Westphalia (grant 315-43-02/2-
005-WFBO-009). We also thank our shepherd Tara
Whalen and the anonymous reviewers for their valuable
insights and comments.
References
[1] M. Abu Rajab,
J. Zarfoss, F. Monrose, and
A. Terzis. A Multifaceted Approach to Understand-
ing the Botnet Phenomenon. In ACM SIGCOMM
Conference on Internet Measurement, 2006.
[2] D. S. Anderson, C. Fleizach, S. Savage, and G. M.
Voelker.
Spamscatter: Characterizing Internet
Scam Hosting Infrastructure. In USENIX Security
Symposium, 2007.
[3] Apache Foundation. Spamassassin. http://
spamassassin.apache.org.
[4] J. Caballero, P. Poosankam, C. Kreibich, and
D. Song.
Dispatcher: Enabling Active Bot-
net Inﬁltration Using Automatic Protocol Reverse-
engineering. In ACM Conference on Computer and
Communications Security (CCS), 2009.
[5] K. Chiang and L. Lloyd. A Case Study of the Rus-
tock Rootkit and Spam Bot. In USENIX Workshop
on Hot Topics in Understanding Botnet, 2007.
[6] C. Cho, J. Caballero, C. Grier, V. Paxson, and
D. Song.
Insights from the Inside: A View of
Botnet Management from Inﬁltration. In USENIX
Workshop on Large-Scale Exploits and Emergent
Threats (LEET), 2010.
[7] Cisco Inc.
Cisco IOS NetFlow.
https:
//www.cisco.com/en/US/products/
ps6601/products_ios_protocol_
group_home.html.
[8] F. C. Freiling, T. Holz, and G. Wicherski. Botnet
Tracking: Exploring a Root-Cause Methodology to
Prevent Distributed Denial-of-Service Attacks. In
European Symposium on Research in Computer Se-
curity (ESORICS), 2005.
Protocol- and Structure-independent Botnet Detec-
tion. In USENIX Security Symposium, 2008.
[10] S. Hao, N. A. Syed, N. Feamster, A. G. Gray, and
S. Krasser. Detecting Spammers with SNARE:
Spatio-temporal Network-level Automatic Repu-
In USENIX Security Symposium,
tation Engine.
2009.
[11] J. P. John, A. Moshchuk, S. D. Gribble, and A. Kr-
ishnamurthy. Studying Spamming Botnets Using
Botlab. In USENIX Symposium on Networked Sys-
tems Design and Implementation (NSDI), 2009.
[12] C. Kanich, C. Kreibich, K. Levchenko, B. Enright,
G. Voelker, V. Paxson, and S. Savage. Spamalytics:
An Empirical Analysis of Spam Marketing Conver-
sion. In ACM Conference on Computer and Com-
munications Security (CCS), 2008.
[13] M. Khmartseva.
Email Statistics Report.
http://www.radicati.com/wp/wp-
content/uploads/2009/05/email-
stats-report-exec-summary.pdf, 2009.
of Rustock.
Taking Stock
[14] B. Krebs.
http://krebsonsecurity.com/2011/
01/taking-stock-of-rustock/, 2011.
[15] C. Kreibich, C. Kanich, K. Levchenko, B. En-
right, G. M. Voelker, V. Paxson, and S. Sav-
In USENIX
age. On the Spam Campaign Trail.
Workshop on Large-Scale Exploits and Emergent
Threats (LEET), 2008.
[16] C. Kreibich, C. Kanich, K. Levchenko, B. Enright,
G. M. Voelker, V. Paxson, and S. Savage. Spam-
craft: An Inside Look at Spam Campaign Orches-
tration. In USENIX Workshop on Large-Scale Ex-
ploits and Emergent Threats (LEET), 2009.
[17] A.
Lelli.
Return
from the Dead:
the Rise.
on
Waledac/Storm Botnet Back
http://www.symantec.com/connect/
blogs/return-dead-waledacstorm-
botnet-back-rise, 2011.
[18] M86.
Rustock,
the
king
of
spam.
http://www.m86security.com/labs/
traceitem.asp?article=1362, July 2010.
[19] MaxMind. GeoIP. http://www.maxmind.
com/app/ip-location.
[20] MessageLabs.
MessageLabs
2010 Annual Security Report.
//www.messagelabs.com/mlireport/
MessageLabsIntelligence_2010_
Annual_Report_FINAL.pdf, 2010.
Intelligence:
http:
[9] G. Gu, R. Perdisci, J. Zhang, and W. Lee. Bot-
Miner: Clustering Analysis of Network Trafﬁc for
[21] C. Nunnery, G. Sinclair, and B. B. Kang. Tum-
bling Down the Rabbit Hole: Exploring the Id-
iosyncrasies of Botmaster Systems in a Multi-
In USENIX Workshop
Tier Botnet Infrastructure.
on Large-Scale Exploits and Emergent Threats
(LEET), 2010.
[22] A. Pitsillidis, K. Levchenko, C. Kreibich,
C. Kanich, G. M. Voelker, V. Paxson, N. Weaver,
and S. Savage. Botnet Judo: Fighting Spam with
Itself. In Symposium on Network and Distributed
System Security (NDSS), 2010.
[23] Project
Honeypot.
projecthoneypot.org/.
http://www.
[24] N. Provos, P. Mavrommatis, M. A. Rajab, and
In
F. Monrose. All your iFRAMEs point to Us.
USENIX Security Symposium, 2008.
[25] Z. Qian, Z. Mao, Y. Xie, and F. Yu. On Network-
In Sympo-
level Clusters for Spam Detection.
sium on Network and Distributed System Security
(NDSS), 2010.
[26] A. Ramachandran and N. Feamster. Understand-
ing the Network-level Behavior of Spammers. SIG-
COMM Comput. Commun. Rev., 36, August 2006.
[27] A. Ramachandran, N. Feamster, and D. Dagon.
Revealing Botnet Membership using DNSBL
In USENIX Workshop on
Counter-intelligence.
Steps to Reducing Unwanted Trafﬁc on the Internet
(SRUTI), 2006.
[28] A. Ramachandran, N. Feamster, and S. Vempala.
Filtering Spam with Behavioral Blacklisting.
In
ACM Conference on Computer and Communica-
tions Security (CCS), 2007.
[29] M. B. S. Sinha and F. Jahanian. Improving Spam
Blacklisting Through Dynamic Thresholding and
In Symposium on Net-
Speculative Aggregation.
work and Distributed System Security (NDSS),
2010.
[30] SC Magazine.
Accused MegaD operator ar-
rested. http://www.scmagazineus.com/
accused-mega-d-botnet-operator-
arrested, 2011.
[31] Shadowserver. New fast ﬂux botnet for the hol-
idays.
http://www.shadowserver.org/
wiki/pmwiki.php/Calendar/20101230,
2011.
[32] B. Stock, J. Gobel, M. Engelberth, F. Freiling, and
T. Holz. Walowdac Analysis of a Peer-to-Peer Bot-
net. In European Conference on Computer Network
Defense (EC2ND), 2009.
[33] B. Stone-Gross, M. Cova, L. Cavallaro, B. Gilbert,
M. Szydlowski, R. Kemmerer, C. Kruegel, and
G. Vigna. Your Botnet is My Botnet: Analysis of a
Botnet Takeover. In ACM Conference on Computer
and Communications Security (CCS), 2009.
[34] B. Stone-Gross, M. Cova, C. Kruegel, and G. Vi-
gna. Peering Through the iFrame. In IEEE Confer-
ence on Computer Communications (INFOCOM),
2011.
[35] B. Stone-Gross, T. Holz, G. Stringhini, and G. Vi-
gna. The Underground Economy of Spam: A
Botmaster’s Perspective of Coordinating Large-
In USENIX Workshop
Scale Spam Campaigns.
on Large-Scale Exploits and Emergent Threats
(LEET), 2011.
[36] Symantec Corp. State of spam & phishing report.
http://www.symantec.com/business/
theme.jsp?themeid=state_of_spam,
2010.
[37] Symantec. Corp.
Rustock
hiatus
with huge surge of pharma spam.
//www.symantec.com/connect/blogs/
rustock-hiatus-ends-huge-surge-
pharma-spam, January 2011.
ends
http:
[38] S. Venkataraman, S. Sen, O. Spatscheck, P. Haffner,
and D. Song. Exploiting Network Structure for
In USENIX Security
Proactive Spam Mitigation.
Symposium, 2007.
[39] P. Wurzinger, L. Bilge, T. Holz,
J. Goebel,
C. Kruegel, and E. Kirda. Automatically Gener-
In European
ating Models for Botnet Detection.
Symposium on Research in Computer Security (ES-
ORICS), 2009.
[40] Y. Xie, F. Yu, K. Achan, R. Panigrahy, G. Hul-
ten, and I. Osipkov. Spamming Botnets: Signatures
and Characteristics. SIGCOMM Comput. Commun.
Rev., 38, August 2008.
[41] T.-F. Yen and M. K. Reiter. Trafﬁc Aggregation for
Malware Detection. In Detection of Intrusions and
Malware, and Vulnerability Assessment (DIMVA),
2008.
[42] Y. Zhao, Y. Xie, F. Yu, Q. Ke, Y. Yu, Y. Chen,
and E. Gillum. BotGraph: Large Scale Spam-
In USENIX Symposium
ming Botnet Detection.
on Networked Systems Design and Implementation
(NSDI), 2009.
[43] L. Zhuang, J. Dunagan, D. R. Simon, H. J. Wang,
and J. D. Tygar. Characterizing Botnets From
In USENIX Workshop
Email Spam Records.
on Large-Scale Exploits and Emergent Threats
(LEET), 2008.