process:postgres, tid:27913, sec:5, tps:5473, lat:182  
value |-------------------------------------------------- count  
    0 |                                                       1  
   50 |                                                       0  
  100 |@@@@@@@@@@@@@@@@@@@                                 6281  
  150 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  16498  
  200 |@@@@@@@@@@                                          3387  
  250 |@                                                    552  
  300 |                                                     302  
  350 |                                                      69  
  400 |                                                      41  
  450 |                                                      25  
  500 |                                                      16  
  550 |                                                      16  
  600 |                                                      25  
  650 |                                                      11  
  700 |                                                      17  
  750 |                                                      12  
  800 |                                                      12  
  850 |                                                      10  
  900 |                                                      14  
  950 |                                                      13  
 1000 |                                                      14  
>1000 |                                                      53  
process:postgres, tid:27914, sec:5, tps:4626, lat:216  
value |-------------------------------------------------- count  
    0 |                                                       1  
   50 |                                                       0  
  100 |@@@@@@                                              1594  
  150 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  12477  
  200 |@@@@@@@@@@@@@@@@@@@@@@@@                            6247  
  250 |@@@@@@                                              1683  
  300 |@@                                                   542  
  350 |                                                     164  
  400 |                                                      73  
  450 |                                                      32  
  500 |                                                      19  
  550 |                                                      15  
  600 |                                                      11  
  650 |                                                      16  
  700 |                                                      16  
  750 |                                                      10  
  800 |                                                      11  
  850 |                                                       9  
  900 |                                                      16  
  950 |                                                      17  
 1000 |                                                      13  
>1000 |                                                     168  
process:postgres, tid:27915, sec:5, tps:5442, lat:183  
value |-------------------------------------------------- count  
    0 |                                                       1  
   50 |                                                       0  
  100 |@@@@@@@@@@@@@                                       4877  
  150 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  17806  
  200 |@@@@@@@@                                            3072  
  250 |@@                                                   759  
  300 |                                                     340  
  350 |                                                      90  
  400 |                                                      40  
  450 |                                                      20  
  500 |                                                      14  
  550 |                                                      15  
  600 |                                                      24  
  650 |                                                      14  
  700 |                                                      15  
  750 |                                                      12  
  800 |                                                      17  
  850 |                                                      14  
  900 |                                                      17  
  950 |                                                      11  
 1000 |                                                       9  
>1000 |                                                      45  
process:postgres, tid:27916, sec:5, tps:5435, lat:183  
value |-------------------------------------------------- count  
    0 |                                                       1  
   50 |                                                       0  
  100 |@@@@@@@@@@@@@@@@@                                   5777  
  150 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  16422  
  200 |@@@@@@@@@@                                          3578  
  250 |@@                                                   687  
  300 |@                                                    348  
  350 |                                                     103  
  400 |                                                      50  
  450 |                                                      20  
  500 |                                                      15  
  550 |                                                      12  
  600 |                                                      16  
  650 |                                                      19  
  700 |                                                      10  
  750 |                                                      11  
  800 |                                                      11  
  850 |                                                      12  
  900 |                                                      13  
  950 |                                                      11  
 1000 |                                                       9  
>1000 |                                                      51  
process:postgres, tid:27917, sec:5, tps:4092, lat:244  
value |-------------------------------------------------- count  
    0 |                                                      1  
   50 |                                                      0  
  100 |@@@@@@@                                            1193  
  150 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@        6921  
  200 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  7957  
  250 |@@@@@@@@@@@@@@@@@@@                                3088  
  300 |@@@                                                 493  
  350 |                                                    123  
  400 |                                                     57  
  450 |                                                     33  
  500 |                                                     29  
  550 |                                                     28  
  600 |                                                     15  
  650 |                                                     26  
  700 |                                                     30  
  750 |                                                     16  
  800 |                                                     40  
  850 |                                                     38  
  900 |                                                     13  
  950 |                                                     20  
 1000 |                                                     26  
>1000 |@                                                   313  
process:postgres, tid:27918, sec:5, tps:4475, lat:223  
value |-------------------------------------------------- count  
    0 |                                                      1  
   50 |                                                      0  
  100 |@@@@@@@@@@@@@                                      2712  
  150 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  9720  
  200 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@              7403  
  250 |@@@@@@@                                            1434  
  300 |@@                                                  391  
  350 |                                                    106  
  400 |                                                     64  
  450 |                                                     30  
  500 |                                                     23  
  550 |                                                     23  
  600 |                                                     20  
  650 |                                                     46  
  700 |                                                     27  
  750 |                                                     18  
  800 |                                                     23  
  850 |                                                     27  
  900 |                                                     17  
  950 |                                                     21  
 1000 |                                                     20  
>1000 |@                                                   250  
process:postgres, tid:27919, sec:5, tps:5470, lat:182  
value |-------------------------------------------------- count  
    0 |                                                       1  
   50 |                                                       0  
  100 |@@@@@@@@@@@@@                                       4936  
  150 |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  18122  
  200 |@@@@@@@@                                            2939  
  250 |@                                                    682  
  300 |                                                     355  
  350 |                                                      91  
  400 |                                                      34  
  450 |                                                      19  
  500 |                                                      11  
  550 |                                                      17  
  600 |                                                      18  
  650 |                                                      14  
  700 |                                                      15  
  750 |                                                       7  
  800 |                                                      11  
  850 |                                                       6  
  900 |                                                      12  
  950 |                                                       8  
 1000 |                                                       8  
>1000 |                                                      48  
process:postgres, tid:27977, sec:5, tps:0, lat:0  
value |-------------------------------------------------- count  
    0 |@                                                  1  
   50 |                                                   0  
  100 |                                                   0  
```  
查看总的柱状图, 不分连接.  
```  
[root@db-172-16-3-39 ~]# cat test.stp   
global v_starttime, v_time1, v_time2  
probe begin {  
  v_starttime = gettimeofday_us()  
}  
probe process("/home/pg94/pgsql9.4devel/bin/postgres").mark("transaction__start") {  
  us = gettimeofday_us()  
  if (! v_time1[tid()])  
    v_time1[tid()] = us  
   v_time2 1000 |                                                      113  
```  
从图中可以看出耗时基本上集中在150-250之间.  
## 参考  
1\. http://blog.163.com/digoal@126/blog/static/163877040201062810748700/  
2\. http://blog.163.com/digoal@126/blog/static/16387704020137140265557/  
3\. http://blog.163.com/digoal@126/blog/static/16387704020138392759478/  
4\. http://blog.163.com/digoal@126/blog/static/16387704020138310438924/  
5\. https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/SystemTap_Tapset_Reference/index.html  
6\. http://blog.163.com/digoal@126/blog/static/1638770402013772212424/  
#### [PostgreSQL 许愿链接](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
您的愿望将传达给PG kernel hacker、数据库厂商等, 帮助提高数据库产品质量和功能, 说不定下一个PG版本就有您提出的功能点. 针对非常好的提议，奖励限量版PG文化衫、纪念品、贴纸、PG热门书籍等，奖品丰富，快来许愿。[开不开森](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216").  
#### [9.9元购买3个月阿里云RDS PostgreSQL实例](https://www.aliyun.com/database/postgresqlactivity "57258f76c37864c6e6d23383d05714ea")
#### [PostgreSQL 解决方案集合](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
#### [德哥 / digoal's github - 公益是一辈子的事.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
#### [PolarDB 学习图谱: 训练营、培训认证、在线互动实验、解决方案、生态合作、写心得拿奖品](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
#### [购买PolarDB云服务折扣活动进行中, 55元起](https://www.aliyun.com/activity/new/polardb-yunparter?userCode=bsb3t4al "e0495c413bedacabb75ff1e880be465a")
#### [About 德哥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")