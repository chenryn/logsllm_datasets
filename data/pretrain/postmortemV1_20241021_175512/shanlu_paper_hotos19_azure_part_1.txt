What bugs cause production cloud incidents?
Haopeng Liu, Shan Lu Madan Musuvathi, Suman Nath
UniversityofChicago MicrosoftResearch
ABSTRACT backbone of today’s computing world. The availabil-
Cloud services have become the backbone of today’s ityofcloudservicesiscrucial,withminutesofservice
computingworld.Runtimeincidents,whichadversely outagescostingmillionsofdollars[11,26].Although
affect the expected service operations, are extremely muchresearchhasattemptedtoimprovetheavailabil-
costlyintermsofuserimpactsandengineeringefforts ityofcloudservicesthroughautomatedbugdetection
requiredtoresolvethem.Hence,suchincidentsarethe [19, 22, 8], failure diagnosis [33], fault detection [16],
targetofmuchresearcheffort.Unfortunately,thereis andothers,thereisstillalackofunderstandingabout
limitedunderstandingaboutcloudserviceincidentsthat cloudserviceincidentsthatactuallyhappeninthewild
actually happen during production runs: what cause —whatcausethemandhowtheyareresolved.
themandhowtheyareresolved. Empiricalstudieshavealwaysbeencrucialinmoti-
In this work, we carefully study hundreds of high- vatingandguidingtheimprovementofsoftwareavail-
severityincidentsthatoccurredrecentlyduringthepro- ability.Manystudieswereconductedtounderstandfail-
ductionrunsofmanyMicrosoftAzureservices.Wefind urecausesandfailureresolutionsinoperatingsystems
softwarebugstobeamajorcausebehindtheseincidents, [10,29,12],multi-threadedsoftware[25],filesystems
andmakeinterestingobservationsaboutthetypesof [24],andothers[13].
softwarebugsthatcausecloudincidentsandhowthese Inrecentyears,empiricalstudieswerealsoconducted
bug-relatedincidentsareresolved,providingmotivation forcloudsystems.Theymainlyusetwotypesofdata
andguidancetofutureresearchintacklingcloudbugs sources:(1)newsreportsaboutcloudoutages[15],which
andimprovingthecloud-serviceavailability. containdetailedoutage-impactinformation;(2)open-
sourcebugdatabases[14,15,20,32,21],whichcontain
CCSCONCEPTS detailedinformationaboutbugsfoundduringbothin-
house code review/testing and production uses. The
•Softwareanditsengineering→Softwaredefect
focusofthesestudieshasbeen(1)specifictypesofbugs
analysis; Software testing and debugging; • Com-
(e.g.,timingbugs[20],scalabilitybugs[21],graycom-
putersystemsorganization→Cloudcomputing.
ponentfailures[17]);(2)high-levelcausecategorization
(e.g.,hardwarefaultsvs.softwarebugs[14,15]);and(3)
KEYWORDS
errorandfailuresymptoms(e.g.,thescope,propagation,
Cloudsystem,productionincident,reliability,bugchar-
anddurationofclouderrorsandfailures[32,15,17]).
acteristics
Althoughuseful,previousstudieshavenotandcannot,
duetothelimitationsoftheirdatasources,providein-
1 INTRODUCTION
depthunderstandingaboutproduction-runcloudservice
1.1 Motivations incidents,answeringfundamentalquestionslike:
(1)Whatcausedproduction-runserviceincidents—
Cloudservicessuchasdistributedcomputinginfrastruc-
whattypesofsoftwarebugsescapedin-housetesting?
turesanddistributedstoragesystemshavebecomethe
(2)Howwereproductionincidentsresolved—isthere
anychancetoautomatetheminthefuture?
Permissiontomakedigitalorhardcopiesofallorpartofthiswork
forpersonalorclassroomuseisgrantedwithoutfeeprovidedthat Answerstothesequestionswouldbecrucialtoim-
copiesarenotmadeordistributedforprofitorcommercialadvan- provingtheavailabilityofcloudservices.
tageandthatcopiesbearthisnoticeandthefullcitationonthefirst
page.Copyrightsforcomponentsofthisworkownedbyothersthan
1.2 Contributions
ACMmustbehonored.Abstractingwithcreditispermitted.Tocopy
otherwise,orrepublish,topostonserversortoredistributetolists, Inthiswork,wesystematicallystudiedall1 thehigh-
requirespriorspecificpermissionand/orafee.Requestpermissions severityproduction-runincidentsduringarecentspan
frompermissions@acm.org.
of6monthsinMicrosoftAzureservices,whichcovera
HotOS’19,May13–15,2019,Bertinoro,Italy
widerangeofservicesincludingcomputation,storage,
©2019AssociationforComputingMachinery.
ACMISBN978-1-4503-6727-1/19/05...$15.00
https://doi.org/10.1145/3317550.3321438 1Exceptforafewwithoutclearroot-causedescription(Section2).

HotOS’19,May13–15,2019,Bertinoro,Italy HaopengLiu,ShanLuandMadanMusuvathi,SumanNath
Whatarethecausesofincidents? strategyforincidentscausedbyfault-relatedbugsand
↓ Fewhardwareproblems timingbugs,butisneverusedforincidentscausedby
↓ Fewmemorybugs data-formatbugsandconstant-valuebugs.Howtopick
↓ Fewgenericsemanticbugs thesuitableresolvingstrategyforaproductioncloud
↑ Manyfault-detection/handlingbugs incidentisanopenproblemforfutureresearch.
↑ Manydata-formatbugs Implications While there has been decades of re-
↑ Morepersistent-dataraces searchonbugdetection,incloudsystems,somewell
Howareincidentsresolved? studiedbugsaremuchlesscommon(e.g.,memorybugs)
↑ Morethanhalfthroughmitigationw/opatches oraretakingnewforms(e.g.,timingbugs),yetsomenot-
so-wellstudiedbugs(e.g.,data-formatbugsandfault-
Table 1: How are cloud incidents different from
relatedbugs)aretakingpredominantfractions.Many
failures in single-machine systems? (↑ and ↓ indi-
production-runincidentsareresolvedthroughmitiga-
catecloudincidentsfollowcertainpatternmoreorless
tiontechniques,insteadofpatches.Automationtech-
thansingle-machinesystems.)
niquesthatsupportmitigationwouldbehelpful.
2 METHODOLOGY
datamanagement,dataanalytics,IoT,mediaservices,
2.1 Incidentsinourstudy
etc.,andidentifiedsoftwarebugsasthemostcommon
MicrosoftAzureproductionincidentscanbereported
causeofcloudincidents(closeto40%).Wethendidan
by(Microsoftinternalorexternal)usersorbysystem
in-depthstudyofallthe112high-severityproduction
watchdogsthatkeepmonitoringifcertainsystemmetric
incidentsthatarecausedbysoftwarebugs.
goesbeyondapre-configuredthreshold.Everyincident
Ourstudyshedslightsonwhattypesofsoftwarebugs
isrecordedintheincidentdatabase,associatedwithin-
leadtoproductioncloudincidents,howtheseincidents
formationsuchasuserdescriptionorwatchdogreport,
areresolved,andhowtheydifferfromfailuresinsingle-
developers’discussion,severity-leveltag,rootcausede-
machinesystems(Table1).
scription,workitemsissuedtodeveloperteams(ifany),
Whatcausedincidents?Amongallincidentscaused
theincident-impactduration,etc.
bybugs,themostcommoncausesare(1)incorrector
Theremainderofthepaperfocusesonasetof112
missingdetectionandhandlingofcomponentfailures
incidents.Theyarealltheincidentsthatsatisfythefol-
(31%)and(2)inconsistentdata-formatassumptionsheld
lowingfourconditionsduringa6-monthperiod(March
by different software components or versions (21 %).
5th,2018–September5th,2018):
Timingbugsarealsocommon(13%),withmanyofthem
(1)theincidentisnotafalsealarmanditsseverity
relatedtoconflictingaccessestonotonlyin-memory
level indicates that new features cannot commit into
databutalsopersistentresources.Finally,incorrectly
productionenvironmentuntilthisincidentisresolved;
setconstantvaluesarenon-negligible(7%).
(2)theincidentledtochangesinthecloudservice,
Probablyrelatedtotheriseofbugsrelatedtocompo-
suchasbug-fixingpatches,testenhancement,etc;
nentfailures,weobservedthepercentageofincidents
(3)theincidentreportcontainsenoughinformation
causedbyhardwarefailurestobesignificantlysmaller
forustojudgetherootcauseoftheincident;
(lessthan5%)thanthoseinnon-cloudsystems[13].
(4)therootcauseoftheincidentaresoftwarebugs.
Howwereincidentsresolved?Differentfrombugs
Notethatnotallthe112incidentswestudiedaffected
inopen-sourcesoftwarebugdatabases,productionin-
Microsoft’sexternalcustomers.Manyincidentsaffected
cidentsweremoreoftentogetresolvedthroughamit-
Microsoft ’s internal users and many others were de-
igationmechanismwithoutacodepatch.Thosemiti-
tectedbyinternalusersandautomatedwatchdogsand
gationmechanisms,whichwefurthercategorizeinto
mitigatedbeforeexternalcustomersreportedthem.
code mitigation like rolling back to an older version,
running-environmentmitigationlikekillingaprocess,
2.2 Threatstovalidity
anddatamitigationlikedeletingatemporarydirectory,
havenotbeenwellstudiedbefore.Withoutrequiring The results of our study have to be interpreted with
newcode,theyprovideagoodopportunityforincident our methodology in mind. The types of bugs we ob-
auto-healingandhencebetterserviceavailability. served in production are biased by the fact that Mi-
Theresolvingstrategiesaredifferentamongincidents crosoftuseseffectivetools(e.g.,[4,5,6,7])tomostly
causedbydifferenttypesofbugs.Forexample,running- eliminate many types of bugs before they can mani-
environmentmitigationisthemostcommonresolving festinproduction,andhenceourstudyincludeszero

Whatbugscauseproductioncloudincidents? HotOS’19,May13–15,2019,Bertinoro,Italy
or few of such bugs. For example, we observed only (2)Messageinterfaces(about60%ofdata-formatin-
a small number of configuration bugs caused by mis- cidents):aservicechangestheinterfaceofitsexternal-
specificationofconfigurationentriesinconfiguration facingmessageAPIs;consequently,theotherprocessor
files,eventhoughsuchbugswerereportedtobecom- nodethatusesthismessageAPIgotunexpectedresults.
mon in other settings[28, 31]). Our observation may Forexample,aservice,let’scallitService-Y,providesa
not represent incidents in Microsoft that we did not RESTAPIthatreturnsalistofactiveinstances.Inthe
study,andmaynotrepresentincidentsinothercloud past,Service-Yusedtoreturnanerror-code200together
services.Weanalyzedonlyincidentswhosereportscon- withanemptylistwhentherewerenoactiveinstances.
tain enough information for us to judge root causes, Inanewerversion,Service-YchangedtheAPItoreturn
whichmayleadustomissincidentswithcomplicated theerrorcode404whentherearenoactiveinstances,
rootcausesandlittleinformationaboutthecauses. causingincidentsinconsumingservicesthatcouldnot
handlethisnewreturncode.
Wecanalsobreakdownthesebugsbasedondifferent
3 WHATARETHEBUGS?
rolesoftheconflictingparties.Theycouldbecausedby
