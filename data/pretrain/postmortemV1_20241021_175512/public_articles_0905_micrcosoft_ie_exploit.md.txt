IE Exploit Allows Remote Code Execution
May2014
Security firm FireEye has recently discovered a zero-day vulnerability in Microsoft’s
Internet Explorer web browser. A zero-day vulnerability is one in which the first attack is
made before the developer has become aware of the vulnerability. As yet unnamed, the vulnerability was
reportedbybothFireEyeandMicrosoftonApril26,2014.
ThevulnerabilityaffectsIE6throughIE11.Thisissignificantbecausethesebrowsersrepresent55%ofall
browsersworldwide.
What is the Vulnerability?
AccordingtoaMicrosoftvulnerabilitydisclosure,
“The vulnerability is a remote code execution vulnerability. The vulnerability exists in the way that
Internet Explorer accesses an object in memory that has been deleted or has not been properly
allocated. The vulnerability may corrupt memory in a way that could allow an attacker to execute
arbitrary code in the context of the current user within Internet Explorer. An attacker could host a
specially crafted website that is designed to exploit this vulnerability through Internet Explorer and
thenconvinceausertoviewthewebsite.”
ThecodedetailsofthevulnerabilityaredescribedinmuchmoredetailinFireEye’sinitialreport.1
The vulnerability bypasses both the ASLR and DEP security protections in Windows. ASLR (address
space layout randomization) protects against attacks due to buffer overflow. In order to prevent an
attacker from reliably jumping to a particular exploited function in memory, ASLR involves randomly
arranging the positions of key data areas of a program, including the base of the executable and the
positionsofthestack,heap,andlibraries,inaprocess'addressspace.
Data Execution Prevention (DEP) is asecurityfeature thatmarks areas ofmemoryas either "executable"
or "nonexecutable." It allows only data in an "executable" area to be run by programs, services, device
drivers,etc.
The good news is that the attacks seen so far seem to have relied on exploiting IE 9, 10 and 11 using
Adobe Flash as an attack vector. The bug is not in Flash, so there is nothing that Adobe can fix. It's just
that byusingspeciallycraftedFlashfiles,attackers canpreparethecontents of memoryin order tomake
a successful attack possible. Therefore, if it is convenient, the vulnerability can be inhibited by simply
disablingtheAdobeFlashplug-ininthebrowseruntilaMicrosoftfixisavailable.
1NewZero-DayExploittargetingInternetExplorerVersions9through11identifiedinTargetedAttacks,FireEye;April26,2014.
http://www.fireeye.com/blog/uncategorized/2014/04/new-zero-day-exploit-targeting-internet-explorer-versions-9-through-11-
identified-in-targeted-attacks.html
1
©2014SombersAssociates,Inc.,andW.H.Highleyman
Fordiscussion,contacteditorest.com

What Are the Risks?
Malicious websites can be crafted to take advantage of this vulnerability. The user would have to go to
thewebsitetobeattacked,butthisistypicallyaccomplishedbephishingemailssentbyattackers.
In addition, websites that accept or host user-provided content or advertisements could unknowingly
containspeciallycraftedcodetoexploitthisvulnerability.
Given access to this vulnerability, an attacker can gain the same user rights as the current user. If the
current user is logged on as an administrator, the attacker has complete control of the system. It can
installandrunprograms;view,changeordeletedata;orcreatenewuseraccountswithfulluserrights.
FireEye has identified an ongoing attack campaign that it has dubbed “Operation Clandestine Fox.” This
attack is aimed at U.S. military, government, energy, and financial institutions. Since this campaign is still
beinginvestigated,FireEyehasreleasednofurtherinformationonit.
Internet Explorer is unaffected by the vulnerability on Windows Server 2003, Windows Server 2008,
Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2, all of which run by
defaultinarestrictedmode,EnhancedSecurityProtection.
Mitigating the Risks
Thereareseveralwaysthatarebeingsuggestedtomitigatetheriskofthisvulnerability:
 Since attacks so far have used Adobe Flash as the attack vector, disable Adobe Flash in the IE
browser.
 SwitchtoadifferentbrowsersuchasGoogle’sChromeorMozilla’sFirefox.
 Deploy the Enhanced Mitigation Experience Toolkit (EMET) version 4.1 or above. The U.S.
Computer Emergency Readiness Team (CERT) recommends that EMET be enabled when
possible.
 Set Internet and Local Intranet security settings to “High” to block ActiveX Controls and Active
Scripting,addingsitesyoutrusttotheInternetExplorerTrustedSiteszone.
 Modifytheaccesscontrollisttobemorerestrictive.
 EnhancedProtectedModeinIE10andabovebreakstheexploit.
 Microsoft has suggested that the VGX dynamic library, which is responsible for rendering the
VectorMarkupLanguage(VML),bedisabled.FireEyehasfoundthistobeeffective.
What About XP?
UnfortunatelyforXPusers,Microsoftisstickingtoits April8,2014policythatupgradestoitsthirteen-year
oldXPoperatingsystem willno longer beprovided.2This presents amajor problem becauseXPsystems
stillrepresentabout25%ofWindowsinstallationsworldwide.
2WindowsXPRetirementaBoonforHackers,AvailabilityDigest;October2013.
http://www.availabilitydigest.com/public_articles/0810/windows_xp.pdf
2
©2014SombersAssociates,Inc.,andW.H.Highleyman
Fordiscussion,contacteditorest.com

Microsofthasstated:
“An unsupported version of Windows will no longer receive software updates from Windows Update.
These include security updates that can help protect your PC from harmful viruses, spyware, and
othermalicioussoftware,whichcanstealyourpersonalinformation.”
Microsoft has been posting popups on Windows XP
machines emphasizing this point, and it is
encouragingusers toupgradetoWindows 7or 8(this
mayrequirethepurchaseofamorepowerfulPC).
To make matters worse, FireEye has determined that
“Operation Clandestine Fox” is attacking XP systems
running IE7 and IE8 (IE8 is the last version of IE
supportedonXP).
Mitigation steps that can be taken by XP users include disabling the Adobe Flash browser plug-in. The
VGXDLLcanalsobedisabledbyunregisteringitusingthefollowingcommand-linesequence:
"%SystemRoot%\System32\regsvr32.exe"-u
"%CommonProgramFiles%\MicrosoftShared\VGX\vgx.dll"
Summary
Thiszero-dayvulnerabilityisstillbeingactivelyexploited.Successfulattackerscantakeover yoursystem
with your user privileges and can do arbitrary damage, especially if you are logged on as an
administrator. Not only can the attacker steal or damage your data, but he can run arbitrary applications
onyourPC.
Therearesomestraightforwardsteps that youcan taketopreventattacks;and Microsoft,CERT,andthe
Department of Homeland Security suggest that you take action to protect your system as described
above in the section entitled “Mitigating the Risks” until you have installed Microsoft’s corrective patch. If
you are an XP user, there will be no corrective patch from Microsoft. Microsoft terminated support for XP
onApril8,2014.
Acknowledgements
Inadditiontothereferencesgivenabove,materialforthisarticlewastakenfromthefollowingsources:
WindowsXPsupporthasended,Microsoft;April8,2014.
Vulnerability in Internet Explorer Could Allow Remote Code Execution, Microsoft Security Advisory
2963983;April26,2014.
Microsoft Races to Fix Massive Internet Explorer Hack: No Fix For Windows XP Leaves 1 In 4 PCs
Exposed,Forbes;April26,2014.
Microsoftacknowledges“inthewild”InternetExplorerzero-day,NakedSecurity;April27,2014.
MicrosoftconfirmsIEzerodaybeingusedinactiveexploits,SearchSecurity;April28,2014.
Microsoftrushestofixbrowserafterattacks:nofixforXPusers,Reuters;April29,2014.
“Operation Clandestine Fox” Now Attacking Windows XP Using Recently Discovered IE Vulnerability,
FireEye;May1,2014.
3
©2014SombersAssociates,Inc.,andW.H.Highleyman
Fordiscussion,contacteditorest.com