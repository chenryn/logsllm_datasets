### Societal Dependence on Hospital Availability and Emerging Security Challenges

Society relies heavily on the constant availability of hospitals for emergency needs. In recent years, the research community has increasingly focused on embedded devices [25], [28], [29], [20] and body area networks (BAN) [37], [42]. Rubin et al. provide a comprehensive discussion on the current state of BAN and embeddable medical devices, addressing emerging threats and challenges, such as remote attacks [42]. Additionally, companies have engaged in reverse engineering infected medical devices, though these efforts often focus on specific cases and lack scalability [45].

While this research is crucial for enhancing security, medical devices are only part of a hospital's broader ecosystem. A comprehensive analysis of the entire hospital network remains to be conducted. Previous studies have collected passive DNS data [47], [36], [15], [11] to reverse engineer and predict network communications from malware-infected devices. Passive DNS analysis has proven effective in detecting command and control (C&C) servers of botnets [48] and predicting malicious domain names generated by domain generation algorithms (DGAs) [12]. By providing a global view of the network, passive DNS analysis can identify individual infected devices and prevent malware from spreading.

Active DNS probing, while useful for detecting malicious traffic [31], can disrupt critical devices in a hospital network. Therefore, our focus is on passive DNS data to avoid such disruptions.

Another method used by researchers involves the collection of SSL certificates (e.g., X.509) [23], [18], [9]. While passive DNS analysis identifies infected devices based on network calls, SSL certificates offer insights into device configurations. Previous work has shown that many devices do not adequately validate certificates, accept deprecated and insecure cryptographic standards, or are vulnerable to man-in-the-middle (MitM) attacks [26], [43]. To combat the mis-issuance of certificates, publicly verifiable logs [35] have been introduced to enhance transparency in certificate issuance.

### Our Approach and Findings

In our paper, we combine various network analysis methods, focusing on medical support devices and their network context. We performed the first Digital Healthcare-Associated Infection (D-HAI) analysis of a major, multi-campus healthcare system. Our longitudinal case study examined all Internet-facing traffic over a six-month period from January to June 2018. We found that while most medical devices have minimal exposure to the Internet, medical support devices make millions of connections. 

We analyzed over 775 million DNS queries across 17 million domains, discovering low amounts of malicious traffic (0.01%) and small but significant traces of botnet activity. We also observed 325 million SSL and TLS handshakes, finding that almost 46% of these connections use weak or insecure ciphers, primarily due to reliance on SHA1 and outdated cipher suites. Notably, 47% of the servers negotiated an obsolete version of TLS (1.1 or below) at least once.

Our D-HAI analysis is repeatable, non-invasive, and designed with ethical considerations. While much has been done to secure medical devices, more must be done to protect this critical environment. Our hope is that this paper will assist future researchers in conducting ethical studies by outlining potential limitations in sensitive environments.

### Acknowledgments

The authors would like to thank our shepherds, David Evans and Michelle Mazurek, and our anonymous reviewers for their valuable comments and guidance. We also extend our gratitude to the hospital staff who provided access to the data and answered our questions throughout the process. The icons in Figure 1 were created by Joni, Arafat Uddin, Vectors Market, Gan Khoon Lay, Creative Stall, Stonehub, and Diego from the Noun Project under the Creative Commons 3.0 License. This work was supported by the National Science Foundation grant numbers CNS-1562485 and CNS-1540217. Any findings, conclusions, or opinions expressed in this work are those of the authors and do not necessarily reflect the views of the National Science Foundation.

### References

[1] "Certificate Transparency Known Logs," 2018, http://www.certificate-transparency.org/known-logs.
[2] "DShield," https://www.dshield.org/suspicious_domains.html, 2018.
[3] "HIPAA Journal," https://www.hipaajournal.com/, 2018.
[4] "MalwareDomains," http://www.malwaredomains.com/, 2018.
[5] "OpenPhish," https://openphish.com/, 2018.
[6] "PhishTank," https://www.phishtank.com/, 2018.
[7] "Zeus Tracker," https://zeustracker.abuse.ch/blocklist.php, 2018.
[8] N. J. AlFardan and K. G. Paterson, "Lucky Thirteen: Breaking the TLS and DTLS Record Protocols," in 2013 IEEE Symposium on Security and Privacy.
[9] J. Amann, O. Gasser, Q. Scheitle, L. Brent, G. Carle, and R. Holz, "Mission Accomplished?: HTTPS Security After DigiNotar," in Proceedings of the 2017 Internet Measurement Conference, ACM, 2017, pp. 325–340.
[10] Amazon Company, "Alexa Company," 2018, https://www.alexa.com/.
[11] M. Antonakakis, R. Perdisci, W. Lee, N. Vasiloglou, and D. Dagon, "Detecting Malware Domains at the Upper DNS Hierarchy," in USENIX Security Symposium, vol. 11, 2011, pp. 1–16.
[12] M. Antonakakis, R. Perdisci, Y. Nadji, N. Vasiloglou, S. Abu-Nimeh, W. Lee, and D. Dagon, "From Throw-Away Traffic to Bots: Detecting the Rise of DGA-Based Malware," in USENIX Security Symposium, vol. 12, 2012.
[13] G. Bertoni, J. Daemen, M. Peeters, and G. Van Assche, "Keccak Sponge Function Family Main Document," Submission to NIST (Round 2), vol. 3, no. 30, 2009.
[14] K. Bhargavan and G. Leurent, "On the Practical (In-)Security of 64-bit Block Ciphers: Collision Attacks on HTTP over TLS and OpenVPN," in Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security, ser. CCS '16, New York, NY, USA: ACM, 2016, pp. 456–467, http://doi.acm.org/10.1145/2976749.2978423.
[15] L. Bilge, E. Kirda, C. Kruegel, and M. Balduzzi, "EXPOSURE: Finding Malicious Domains Using Passive DNS Analysis."
[16] D. Bleichenbacher, "Chosen Ciphertext Attacks Against Protocols Based on the RSA Encryption Standard PKCS #1," in Proceedings of the 18th Annual International Cryptology Conference on Advances in Cryptology, ser. CRYPTO '98, London, UK, UK: Springer-Verlag, 1998, pp. 1–12, http://dl.acm.org/citation.cfm?id=646763.706320.
[17] H. Böck, J. Somorovsky, and C. Young, "Return of Bleichenbacher's Oracle Threat (ROBOT)," Cryptology ePrint Archive, Report 2017/1189, 2017, https://eprint.iacr.org/2017/1189.
[18] C. Brubaker, S. Jana, B. Ray, S. Khurshid, and V. Shmatikov, "Using Frankencerts for Automated Adversarial Testing of Certificate Validation in SSL/TLS Implementations," in Security and Privacy (SP), 2014 IEEE Symposium on, IEEE, 2014, pp. 114–129.
[19] Dan Hubbard, "Cisco Umbrella 1 Million," 2016, https://umbrella.cisco.com/blog/2016/12/14/cisco-umbrella-1-million/.
[20] T. Denning, A. Borning, B. Friedman, B. T. Gill, T. Kohno, and W. H. Maisel, "Patients, Pacemakers, and Implantable Defibrillators: Human Values and Security for Wireless Implantable Medical Devices," in Proceedings of the SIGCHI Conference on Human Factors in Computing Systems, ACM, 2010, pp. 917–926.
[21] Z. Durumeric, D. Adrian, A. Mirian, M. Bailey, and J. A. Halderman, "A Search Engine Backed by Internet-Wide Scanning," in 22nd ACM Conference on Computer and Communications Security, Oct. 2015.
[22] Z. Durumeric, F. Li, J. Kasten, J. Amann, J. Beekman, M. Payer, N. Weaver, D. Adrian, V. Paxson, M. Bailey, and J. A. Halderman, "The Matter of Heartbleed," in Proceedings of the 2014 Conference on Internet Measurement Conference, ser. IMC '14, New York, NY, USA: ACM, 2014, pp. 475–488, http://doi.acm.org/10.1145/2663716.2663755.
[23] S. Fahl, M. Harbach, T. Muders, L. Baumgärtner, B. Freisleben, and M. Smith, "Why Eve and Mallory Love Android: An Analysis of Android SSL (In)Security," in Proceedings of the 2012 ACM Conference on Computer and Communications Security, ACM, 2012, pp. 50–61.
[24] Food and Drug Administration, "Quality and Compliance (Medical Devices)," 2018, https://www.fda.gov/MedicalDevices/DeviceRegulationandGuidance/MedicalDeviceQualityandCompliance/default.htm.
[25] K. Fu and J. Blum, "Controlling for Cybersecurity Risks of Medical Device Software," Communications of the ACM, vol. 56, no. 10, pp. 35–37, 2013.
[26] M. Georgiev, S. Iyengar, S. Jana, R. Anubhai, D. Boneh, and V. Shmatikov, "The Most Dangerous Code in the World: Validating SSL Certificates in Non-Browser Software," in Proceedings of the 2012 ACM Conference on Computer and Communications Security, ACM, 2012, pp. 38–49.
[27] Google Chrome, "Chrome Platform Status TLS 1.3," 2018, https://www.chromestatus.com/feature/5712755738804224.
[28] D. Halperin, T. S. Heydt-Benjamin, K. Fu, T. Kohno, and W. H. Maisel, "Security and Privacy for Implantable Medical Devices," IEEE Pervasive Computing, vol. 7, no. 1, 2008.
[29] D. Halperin, T. S. Heydt-Benjamin, B. Ransford, S. S. Clark, B. Defend, W. Morgan, K. Fu, T. Kohno, and W. H. Maisel, "Pacemakers and Implantable Cardiac Defibrillators: Software Radio Attacks and Zero-Power Defenses," in Security and Privacy, 2008. SP 2008. IEEE Symposium on, IEEE, 2008, pp. 129–142.
[30] Health Insurance Portability and Accountability Act, "Summary of the HIPAA Security Rule," 2018, https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html.
[31] T. Holz, C. Gorecki, K. Rieck, and F. C. Freiling, "Measuring and Detecting Fast-Flux Service Networks," in NDSS, 2008.
[32] A. Kharraz, W. Robertson, D. Balzarotti, L. Bilge, and E. Kirda, "Cutting the Gordian Knot: A Look Under the Hood of Ransomware Attacks," in International Conference on Detection of Intrusions and Malware, and Vulnerability Assessment, Springer, 2015, pp. 3–24.
[33] C. Kreibich, C. Kanich, K. Levchenko, B. Enright, G. M. Voelker, V. Paxson, and S. Savage, "On the Spam Campaign Trail," LEET, vol. 8, no. 2008, pp. 1–9, 2008.
[34] J. Kwon and M. E. Johnson, "Security Practices and Regulatory Compliance in the Healthcare Industry," Journal of the American Medical Informatics Association, vol. 20, no. 1, pp. 44–51, 2012.
[35] B. Laurie, A. Langley, and E. Kasper, "Certificate Transparency," Tech. Rep., 2013.
[36] C. Lever, M. Antonakakis, B. Reaves, P. Traynor, and W. Lee, "The Core of the Matter: Analyzing Malicious Traffic in Cellular Carriers," in NDSS, 2013.
[37] M. Li, W. Lou, and K. Ren, "Data Security and Privacy in Wireless Body Area Networks," IEEE Wireless Communications, vol. 17, no. 1, 2010.
[38] I. Mantin and A. Shamir, "A Practical Attack on Broadcast RC4," in Fast Software Encryption, M. Matsui, Ed., Berlin, Heidelberg: Springer Berlin Heidelberg, 2002, pp. 152–164.
[39] P. Mockapetris and K. J. Dunlap, "Development of the Domain Name System," ACM, 1988, vol. 18, no. 4.
[40] B. Möller, T. Duong, and K. Kotowicz, "This POODLE Bites: Exploiting the SSL 3.0 Fallback," Security Advisory, 2014.
[41] V. Paxson, "Bro: A System for Detecting Network Intruders in Real-Time," Computer Networks, vol. 31, no. 23-24, pp. 2435–2463, 1999.
[42] M. Rushanan, A. D. Rubin, D. F. Kune, and C. M. Swanson, "SOK: Security and Privacy in Implantable Medical Devices and Body Area Networks," in Security and Privacy (SP), 2014 IEEE Symposium on, IEEE, 2014, pp. 524–539.
[43] D. Sounthiraraj, J. Sahs, G. Greenwood, Z. Lin, and L. Khan, "SMV-Hunter: Large Scale, Automated Detection of SSL/TLS Man-in-the-Middle Vulnerabilities in Android Apps," in In Proceedings of the 21st Annual Network and Distributed System Security Symposium (NDSS'14, CiteSeer, 2014.
[44] M. Stevens, E. Bursztein, P. Karpmann, A. Albertini, and Y. Markov, "The First SHA-1 Collision," Technical Report, 2017, https://shattered.io/static/shattered.pdf.
[45] TrapX Research Labs, "MEDJACK.2 Hospitals Under Siege," 2018, https://trapx.com/wp-content/uploads/2017/08/AOA_Report_TrapX_MEDJACK.2.pdf.
[46] S. Vaudenay, "Security Flaws Induced by CBC Padding — Applications to SSL, IPSEC, WTLS...," in Advances in Cryptology — EUROCRYPT 2002, Springer Berlin Heidelberg, 2002, pp. 534–545.
[47] F. Weimer, "Passive DNS Replication," in FIRST Conference on Computer Security Incident, 2005, p. 98.
[48] S. Yadav, A. K. K. Reddy, A. Reddy, and S. Ranjan, "Detecting Algorithmically Generated Malicious Domain Names," in Proceedings of the 10th ACM SIGCOMM Conference on Internet Measurement, ACM, 2010, pp. 48–61.
[49] T.-F. Yen, V. Heorhiadi, A. Oprea, M. K. Reiter, and A. Juels, "An Epidemiological Study of Malware Encounters in a Large Enterprise," in Proceedings of the ACM Conference on Computer and Communications Security (CCS), 2014.