### References

1. 2018. CloudFront. https://aws.amazon.com/cloudfront/.
2. 2018. DynamoDB. https://aws.amazon.com/dynamodb/.
3. 2018. Finding pwned passwords with 1Password. https://blog.1password.com/finding-pwned-passwords-with-1password/.
4. 2018. Have I Been Pwned: API v2. https://haveibeenpwned.com/API/v2.
5. 2018. I Wanna Go Fast: Why Searching Through 500M Pwned Passwords Is So Quick. https://www.troyhunt.com/i-wanna-go-fast-why-searching-through-500m-pwned-passwords-is-so-quick/.
6. 2018. Interval Tree. https://en.wikipedia.org/wiki/Interval_tree.
7. 2018. List of Data Breaches. https://en.wikipedia.org/wiki/List_of_data_breaches.
8. 2018. SECURITY UPDATE - Q2 2018. https://www.eveonline.com/article/pc29kq/an-update-on-security-the-fight-against-bots-and-rmt.
9. 2018. Twitter’s List Of 370 Banned Passwords. http://www.businessinsider.com/twitters-list-of-370-banned-passwords-2009-12. Accessed: 2015-11-06.
10. 2019. Crypto Node.js. https://nodejs.org/api/crypto.html.
11. 2019. GhostProject. https://ghostproject.fr/.
12. 2019. Testing Firefox Monitor, a New Security Tool. https://blog.mozilla.org/futurereleases/2018/06/25/testing-firefox-monitor-a-new-security-tool/.
13. 2019. VeriClouds. https://my.vericlouds.com/.
14. 4iQ. 2018. Identities in the Wild: The Tsunami of Breached Identities Continues. https://4iq.com/wp-content/uploads/2018/05/2018-IdentityBreachReport-4iQ.pdf.
15. Carlos Aguilar-Melchor, Joris Barrier, Laurent Fousse, and Marc-Olivier Killijian. 2016. XPIR: Private Information Retrieval for Everyone. Proceedings on Privacy Enhancing Technologies 2016, 2 (2016), 155–174.
16. Junade Ali. 2018. Optimising Caching on Pwned Passwords (with Workers). https://blog.cloudflare.com/optimising-caching-on-pwnedpasswords.
17. Junade Ali. 2018. Validating Leaked Passwords with k-Anonymity. https://blog.cloudflare.com/validating-leaked-passwords-with-k-anonymity.
18. P. Berenbrink, T. Friedetzky, Z. Hu, and R. Martin. 2008. On Weighted Balls-into-Bins Games. Theoretical Computer Science 409, 3 (2008), 511–520.
19. Julio Casal. 2017. 1.4 Billion Clear Text Credentials Discovered in a Single Database. https://medium.com/4iqdelvedeep/1-4-billion-clear-text-credentials-discovered-in-a-single-database-3131d0a1ae14.
20. Hao Chen, Kim Laine, and Peter Rindal. 2017. Fast Private Set Intersection from Homomorphic Encryption. In Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security. ACM, 1243–1255.
21. Benny Chor, Oded Goldreich, Eyal Kushilevitz, and Madhu Sudan. 1995. Private Information Retrieval. In Proceedings of IEEE 36th Annual Foundations of Computer Science. IEEE, 41–50.
22. Anupam Das, Joseph Bonneau, Matthew Caesar, Nikita Borisov, and XiaoFeng Wang. 2014. The Tangled Web of Password Reuse. In NDSS, Vol. 14. 23–26.
23. Y. Dodis, L. Reyzin, and A. Smith. 2004. Fuzzy Extractors: How to Generate Strong Keys from Biometrics and Other Noisy Data. In Eurocrypt 2004, C. Cachin and J. Camenisch (Eds.). Springer-Verlag, 523–540. LNCS no. 3027.
24. Zeev Dvir and Sivakanth Gopi. 2015. 2-Server PIR with Sub-Polynomial Communication. In Proceedings of the Forty-Seventh Annual ACM Symposium on the Theory of Computing. ACM, 577–584.
25. Steven Englehardt, Jeffrey Han, and Arvind Narayanan. 2018. I Never Signed Up for This! Privacy Implications of Email Tracking. Proceedings on Privacy Enhancing Technologies 2018, 1 (2018), 109–126.
26. Verizon Enterprise. 2017. 2017 Data Breach Investigations Report.
27. Michael J. Freedman, Kobbi Nissim, and Benny Pinkas. 2004. Efficient Private Matching and Set Intersection. In Advances in Cryptography–EUROCRYPT. Springer, 1–19.
28. Ágnes Kiss, Jian Liu, Thomas Schneider, N. Asokan, and Benny Pinkas. 2017. Private Set Intersection for Unequal Set Sizes with Mobile Applications. Proceedings on Privacy Enhancing Technologies 2017, 4 (2017), 177–197.
29. Vladimir Kolesnikov, Ranjit Kumaresan, Mike Rosulek, and Ni Trieu. 2016. Efficient Batched Oblivious PRF with Applications to Private Set Intersection. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security. ACM, 818–829.
30. Marie-Sarah Lacharité and Kenneth G. Paterson. 2018. Frequency-Smoothing Encryption: Preventing Snapshot Attacks on Deterministically Encrypted Data. IACR Transactions on Symmetric Cryptology 2018, 1 (2018), 277–313.
31. Yue Li, Haining Wang, and Kun Sun. 2016. A Study of Personal Information in Human-Chosen Passwords and Its Security Implications. In IEEE INFOCOM 2016–The 35th Annual IEEE International Conference on Computer Communications. IEEE, 1–9.
32. Jerry Ma, Weining Yang, Min Luo, and Ninghui Li. 2014. A Study of Probabilistic Password Models. In Proceedings of the 2014 IEEE Symposium on Security and Privacy (SP). IEEE Computer Society, 689–704.
33. Ashwin Machanavajjhala, Johannes Gehrke, Daniel Kifer, and Muthuramakrishnan Venkitasubramaniam. 2006. l-Diversity: Privacy Beyond k-Anonymity. In 22nd International Conference on Data Engineering (ICDE’06). IEEE, 24–24.
34. Catherine Meadows. 1986. A More Efficient Cryptographic Matchmaking Protocol for Use in the Absence of a Continuously Available Third Party. In 1986 IEEE Symposium on Security and Privacy. IEEE, 134–134.
35. William Melicher, Blase Ur, Sean M. Segreti, Saranga Komanduri, Lujo Bauer, Nicolas Christin, and Lorrie Faith Cranor. [n.d.]. Fast, Lean and Accurate: Modeling Password Guessability Using Neural Networks.
36. A. Naranyanan and V. Shmatikov. 2008. Robust De-Anonymization of Large Datasets. In Proceedings of the 2008 IEEE Symposium on Security and Privacy, May 2008.
37. Femi Olumofin and Ian Goldberg. 2011. Revisiting the Computational Practicality of Private Information Retrieval. In International Conference on Financial Cryptography and Data Security. Springer, 158–172.
38. Bijeeta Pal, Tal Daniel, Rahul Chatterjee, and Thomas Ristenpart. 2019. Beyond Credential Stuffing: Password Similarity Using Neural Networks. IEEE Symposium on Security and Privacy (2019).
39. Sarah Pearman, Jeremy Thomas, Pardis Emami Naeini, Hana Habib, Lujo Bauer, Nicolas Christin, Lorrie Faith Cranor, Serge Egelman, and Alain Forget. 2017. Let’s Go in for a Closer Look: Observing Passwords in Their Natural Habitat. In Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security. ACM, 295–310.
40. Benny Pinkas, Thomas Schneider, Gil Segev, and Michael Zohner. 2015. Phasing: Private Set Intersection Using Permutation-Based Hashing. In 24th {USENIX} Security Symposium ({USENIX} Security 15). 515–530.
41. Benny Pinkas, Thomas Schneider, Christian Weinert, and Udi Wieder. 2018. Efficient Circuit-Based PSI via Cuckoo Hashing. In Annual International Conference on the Theory and Applications of Cryptographic Techniques. Springer, 125–157.
42. Jennifer Pullman, Kurt Thomas, and Elie Bursztein. 2019. Protect Your Accounts from Data Breaches with Password Checkup. https://security.googleblog.com/2019/02/protect-your-accounts-from-data.html.
43. Kurt Thomas, Jennifer Pullman, Kevin Yeo, Ananth Raghunathan, Patrick Gage Kelley, Luca Invernizzi, Borbala Benko, Tadek Pietraszek, Sarvar Patel, Dan Boneh, and Elie Bursztein. 2019. Protecting Accounts from Credential Stuffing with Password Breach Alerting. In USENIX Security Symposium. USENIX.
44. Troy Hunt. 2018. Have I Been Pwned? https://haveibeenpwned.com/Passwords/.
45. Ding Wang, Zijian Zhang, Ping Wang, Jeff Yan, and Xinyi Huang. 2016. Targeted Online Password Guessing: An Underestimated Threat. In Proceedings of the 2016 ACM SIGSAC conference on computer and communications security. ACM, 1242–1254.
46. Dan Lowe Wheeler. 2016. zxcvbn: Low-Budget Password Strength Estimation. In Proc. USENIX Security.
47. Joanne Woodage, Rahul Chatterjee, Yevgeniy Dodis, Ari Juels, and Thomas Ristenpart. 2017. A New Distribution-Sensitive Secure Sketch and Popularity-Proportional Hashing. In Annual International Cryptology Conference. Springer, 682–710.
48. Lei Zhang, Sushil Jajodia, and Alexander Brodsky. 2007. Information Disclosure Under Realistic Assumptions: Privacy Versus Optimality. In Proceedings of the 14th ACM Conference on Computer and Communications Security. ACM, 573–583.

### Correlation Between Usernames and Passwords

In Section 3, we chose to model the username and password choices of previously uncompromised users independently. To check the validity of this assumption, we randomly sampled 105 username-password pairs from the dataset used in Section 6 and calculated the Levenshtein edit distance between each username and password in a pair. The results of this experiment are shown in Figure 11.

We found that the mean edit distance between a username and password was 9.4, while the mean password length was 8.4 characters and the mean username length was 10.0 characters. This supports the observation that while there are some pairs where the password is almost identical to the username, a large majority are not related to the username at all.

The statistics on the edit distance between usernames and passwords in our dataset are similar to those in the dataset used by Wang et al. [47], who determined that approximately 1-2% of English-website users used their email prefix as their password. This data does not prove that usernames and passwords are independent. However, even if an attacker gains an additional advantage in the few cases where a user chooses their username as their password, the overwhelming majority of users have passwords that are not closely related to their usernames.

### Bandwidth of FSB

To calculate the maximum bandwidth used by FSB, we use the balls-and-bins formula as described in Section 3. Each password \( w \) is stored in \( |\beta(w)| \) buckets, so the total number of balls, or passwords being stored, can be calculated as:

\[
m = \sum_{w \in \tilde{S}} |\beta(w)| = \sum_{w \in W_{\bar{q}} \cap \tilde{S}} |\beta(w)| + \sum_{w \in \tilde{S} \setminus W_{\bar{q}}} |\beta(w)|
\]

\[
\leq |W_{\bar{q}} \cap \tilde{S}| \cdot |B| + \sum_{w \in \tilde{S} \setminus W_{\bar{q}}} \left( \frac{|B| \cdot \hat{ps}(w)}{\hat{ps}(\bar{q})} + 1 \right)
\]

\[
\leq |B| \cdot \bar{q} + |B| \cdot \sum_{w \in \tilde{S} \setminus W_{\bar{q}}} \frac{\hat{ps}(w)}{\hat{ps}(\bar{q})} + N
\]

The first equality is obtained by replacing the definition of \( \beta(w) \); the second inequality holds because \( \lceil x \rceil \leq x + 1 \); the third inequality holds because \( S \subseteq W \).

The number of bins \( n = |B| \), and \( m > n \log n \) if \( \bar{q} > \log n \). Therefore, the maximum bucket size for FSB would, with high probability, be no more than \( 2 \cdot \left( \bar{q} + \frac{1}{\hat{ps}(\bar{q})} + \frac{N}{|B|} \right) \).

### Proof of Theorem

First, we calculate the general form of the BucketGuessβFSB advantage. Then, we show that for \( q \leq \bar{q} \), \( \text{Adv}_{b-gs}^{\beta_{FSB}}(q) = \text{Adv}_{gs}(q) \), and we bound the difference in the advantages for the games when \( q > \bar{q} \).

\[
\text{Adv}_{b-gs}^{\beta_{FSB}}(q) = \max_{u} \max_{w_1, \ldots, w_q \in \alpha(b)} \sum_{i=1}^{q} \frac{\hat{ps}(w_i)}{|\beta_{FSB}(w_i)|} \Pr[W = w_i \land U = u]
\]

The second step follows from the independence of usernames and passwords in the uncompromised setting.

We will use \( W_{\bar{q}} \) to refer to the top \( \bar{q} \) passwords according to the password distribution \( \hat{ps} = pw \), and \( w_{\bar{q}} \) to refer to the \( \bar{q} \)-th most popular password according to \( \hat{ps} \).

For \( w \in W_{\bar{q}} \), we can calculate the fraction in the summation exactly as:

\[
\frac{\hat{ps}(w)}{|\beta_{FSB}(w)|} = \frac{\hat{ps}(w)}{|B|}
\]

For any other \( w \in W \setminus W_{\bar{q}} \), we can bound the fraction using the bound on the number of buckets a password is placed in:

\[
\frac{|B| \cdot \hat{ps}(w)}{\hat{ps}(\bar{q})} \leq |\beta_{FSB}(w)| \leq \frac{|B| \cdot \hat{ps}(w)}{\hat{ps}(\bar{q})} + 1
\]

Since the values of \( \frac{\hat{ps}(w)}{|\beta_{FSB}(w)|} \) are always larger for \( w \in W_{\bar{q}} \), the values of \( w_1, \ldots, w_q \) chosen for each bucket will be the top \( \bar{q} \) passwords overall, along with the top \( q - \bar{q} \) of the remaining passwords in the bucket, ordered by \( \frac{\hat{ps}(\cdot)}{|\beta_{FSB}(\cdot)|} \).

To find an upper bound on \( \text{Adv}_{b-gs}^{\beta_{FSB}}(q) \):

\[
\text{Adv}_{b-gs}^{\beta_{FSB}}(q) \leq \max_{w_1, \ldots, w_q \in \alpha(b)} \sum_{i=1}^{q} \frac{\hat{ps}(w_i)}{|\beta_{FSB}(w_i)|} \leq \sum_{w \in W_{\bar{q}}} \frac{\hat{ps}(w)}{|B|} + (q - \bar{q}) \frac{\hat{ps}(\bar{q})}{|B|}
\]

\[
\leq \frac{|B| + (q - \bar{q}) \hat{ps}(\bar{q})}{|B|}
\]