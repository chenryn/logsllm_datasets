### Optimized Text

#### Block Page Detection in South Korea
Our block page detection system (§IV-C) identified a cluster of TCP payloads unique to South Korea. Upon manual inspection, these pages contained a script that would fingerprint the client and then load the originally intended page. We observed this script injection over a five-month period from October 2016 through February 2017, from vantage points within three major Korean ISPs, affecting 5-30% of all our test page loads. There was no correlation with the content of the affected pages. In contrast, censorship in South Korea affects less than 1% of our tests and is primarily focused on pornography, illegal file sharing, and North Korean propaganda.

The scripts could have been injected by the VPN service, the ISPs, or one or more of their transit providers. This phenomenon resembles techniques used by ad networks for profiling individual web users [2]. This underscores the importance of manual verification to avoid false positives in censorship detection. All the detection heuristics described in Sections IV-B and IV-C triggered on these scripts, but they do not constitute censorship.

#### Cryptocurrency Mining Injection in Brazil
Our block page detector also flagged a set of suspicious responses observed only in Brazil. The originally intended page would load, but it would contain malware causing the web browser to mine cryptocurrency. As of mid-2018, this is a popular method for earning money with malware [53]. We identified the malware as originating from a botnet infecting MikroTik routers (exploiting CVE-2018-14847), initially seen only in Brazil [49] but now reported to affect over 200,000 routers worldwide [31]. Infected routers inject the mining malware into HTTP responses passing through them. The malware first appeared in ICLab’s records on July 21st, 2018—ten days before the earliest public report on the MikroTik botnet that we are aware of. If ICLab’s continuous monitoring were coupled with continuous analysis and alerting (which is planned), it could have detected this botnet prior to the public report. This highlights the importance of continuous network interference monitoring.

#### Comparison with Other Platforms
Other active censorship measurement platforms at the time of writing include Encore [17], Satellite-Iris [66], [72], Quack [79], and OONI [37]. Table V provides a high-level comparison of the features and coverage of each platform for the two-month period of August and September 2018. (August 1, 2018, is the earliest date for which data from Quack and Satellite-Iris has been published.) All platforms experience daily variations in coverage, so we report both a weekly average and the maximum number of covered countries, ASes, and URLs. While many platforms emphasize breadth of country and AS coverage, ICLab focuses on collecting detailed information from a smaller number of vantage points.

##### Quack
Quack relies on public echo servers to measure censorship, requiring at least 15 echo servers within the same country for robust measurements [79]. Currently, these are available in 75 countries, with 95 more having at least one echo server. Quack aims to detect website censorship by sending packets that mimic HTTP requests, which the echo server reflects back to the client. It expects the censor to react to this reflection as if it were a real HTTP message. The designers acknowledge the possibility of false negatives when censors only look for HTTP traffic on standard ports (80 and 443). Manual inspection of the Quack dataset reveals that in 32.6% of tests marked as blocked, the client did not successfully transmit a mimic request. We have reported this apparent bug to the Quack team.

##### Satellite-Iris
Satellite-Iris [19] combines Satellite [72] and Iris [66] to focus on DNS manipulation, measuring from open DNS resolvers. It compares responses from these vantage points with those from a control node, retrieves corresponding TLS certificates from the Censys [30] dataset, and checks their validity. Several heuristics are applied to each response, all of which must be satisfied to judge it as censorship. Two cases where these heuristics lead to false negatives are highlighted:
- If Satellite-Iris can retrieve a valid TLS certificate from any IP address in the open resolver’s response, it considers the response uncensored. This means it will not detect cases where the censor supplies an address for a different domain.
- Despite a design bias toward false negatives, 83.8% of the DNS responses considered censored may be false positives. Satellite-Iris depends on the Censys dataset to distinguish DNS poisoning from normal IP variation. When Censys information is unavailable, it falls back on a single control resolver, which is inadequate to rule out normal variation, as discussed in §IV-A.

##### OONI
OONI [37] relies on volunteers who run a testing application manually, available on all major desktop and mobile operating systems except Windows. In August and September 2018, OONI’s volunteers conducted 14,000,000 measurements from 156 countries, reporting 29,982 unique URL-country pairs as blocked. OONI’s reliance on volunteers and manual operation results in uneven coverage over websites and countries. The "primary web connectivity" test suite also tests ATL and CLBL-G, but the mobile version only tests a short list. OONI’s detection heuristics are basic, leading to a high level of false positives. For example, OONI’s DNS consistency test flags any disagreement between the client’s local recursive resolver and a public DNS utility as censorship [62]. OONI’s block page detector uses the “30% shorter than uncensored page” heuristic proposed by Jones et al. [48], but innocuous server errors are also short compared to normal pages.

Yadav et al. [89] reported very high levels of inaccuracy in OONI’s results for India, with an 80% false positive rate and an 11.6% false negative rate. We confirm a high false positive rate for OONI’s block page detector: of the 12,506 unique anomalous HTTP responses reported by OONI’s volunteers in August and September 2018, our block-page detector classifies only 3,201 as censorship, resulting in a 74.4% false positive rate. The most common cause of false positives is a response with an empty HTML body, which can occur for various innocuous reasons as well as censorship [4], [57], [77].

#### Related Work
China’s censorship practices have been extensively studied [23], [35], [64], [86], [88] due to the global reputation of the "Great Firewall" and the relative ease of accessing vantage points within the country. Other countries receiving case studies include Iran [6], [10], India [89], Pakistan [51], [60], Syria [20], and Egypt and Libya [25]. Whenever researchers have access to multiple vantage points within a country, they find that censorship policies are not consistently enforced, with region-to-region and ISP-to-ISP variations.

Broader studies fall into two categories. One group investigates worldwide variations in censorship, such as whether censorship mainly interferes with DNS lookups [66] or subsequent TCP connections, and whether end-users are informed of censorship [44], [80]. Some studies have identified specific software in use [26], [48]. Another line of work aims to understand what is censored and why [1], [16], [84], how that changes over time [7], [43], how people react to censorship [52], [87], and how censors might react to being monitored [16].

We described the challenges of relying on volunteers in §I and §III. Several research groups have sought alternatives. CensMon [73] used Planet Lab nodes, Anderson et al. [7] used RIPE Atlas nodes, Pearce et al. [66] used open DNS resolvers, and VanderSloot et al. [79] used open echo servers. Darer et al. [28] exploited the fact that the Chinese Great Firewall injects forged replies to hosts outside the country. Burnett and Feamster [17], Ensafi et al. [33], and Pearce et al. [65] proposed using existing hosts as reflectors for censorship probes without the knowledge of their operators, at different protocol stack levels.

Only a few studies have lasted more than a month. Five prominent exceptions are Encore [17], IRIS [66], OONI [37], Quack [79], and Satellite [72], all of which share goals similar to ICLab. Section VII provides a detailed comparison between ICLab and these projects. Herdict [45] has also been active for years, aggregating user reports of inaccessible websites without testing or explaining the reasons for inaccessibility.

#### Limitations
In this section, we discuss ICLab’s limitations and how we have addressed them.

- **Discrimination against VPN Users:** Some websites block access from VPN users [57], [72]. We sometimes observe this discrimination against our VPN clients (see §VI-A for an example) and are careful not to confuse it with censorship.
- **Malicious VPN Providers:** Some VPN providers engage in surveillance and traffic manipulation, such as injecting advertisements into users’ traffic [50]. We avoid using known malicious VPN providers. Our block page detectors are designed not to confuse dynamic content (e.g., advertisements, localization) with censorship, as described in §IV-C. In §VI-B and VI-C, we describe surveillance and malware injections that required manual inspection to distinguish from censorship.
- **False Advertising by VPN Providers:** Some VPN providers falsely advertise the location of their servers [85]. We verify all server locations using the technique described in Appendix B.
- **Bias in Test Lists:** ATL suffers from sampling bias and churn [71]. CLBL-G and CLBL-C may suffer from selection bias, as they are manually curated by activists. We plan to revise the test lists and add more URLs as needed. CLBL-G and CLBL-C are updated slowly, and it is not unusual for more than half of the sites on a country-specific list to no longer exist [84]. This is not as limiting as it might seem because censors also update their lists slowly. Several previous studies found that long-gone websites may still be blocked [1], [60], [89].
- **Coverage of “Not Free” Countries:** As discussed in Section §III-B, the risks involved with setting up many vantage points in certain sensitive (“not free”) countries prevent us from claiming complete coverage at all times. However, the set of countries ICLab covers provides a good, if imperfect, longitudinal overview of worldwide censorship.
- **Evading Censorship Detection:** Censors try to conceal some of their actions (“covert” censorship). ICLab can detect some covert censorship, as discussed in §IV, but not all. The “uncertain” and “probably censored” cases of TCP packet injection (Figure 4 in §IV-B) are priorities for further investigation. Censors could further conceal their actions by disabling filtering for IP addresses that appear to be testing for censorship. Comparing results for vantage points in the same country gives us no reason to believe any country does this today.

#### Conclusions
We presented ICLab, a global censorship measurement platform capable of detecting a wide range of network interference and Internet censorship techniques. By using VPN-based vantage points, ICLab provides flexibility and control over measurements while reducing risks in measuring Internet censorship at a global scale. Between January 2017 and September 2018, ICLab conducted 53,906,532 measurements over 45,565 URLs in 62 countries. ICLab can detect various censorship mechanisms and other forms of network interference. Other longitudinal measurement platforms may have more vantage points and accumulated data, but also more errors, and/or they focus on specific types of censorship. Our platform can more reliably distinguish normal network errors from covert censorship, and our clustering techniques discovered 48 previously unknown block pages.

As we continue to operate ICLab and interact with relevant political science and civil society organizations, ICLab will not only make new technical observations but also place qualitative work in this area on a firm empirical footing.

#### Acknowledgements
Nick Feamster, Sathyanarayanan Gunasekaran, Ben Jones, Mose Karanja, Anke Li, the Small Media Foundation, and the Citizen Lab, especially Masashi Crete-Nishihata, Jakub Dalek, and Adam Senft, have provided invaluable assistance with the implementation, testing, and deployment of ICLab. We would like to thank our shepherd, Leyla Bilge, and all the anonymous reviewers for their feedback on this paper. We also thank Behtash Banihashemi, Arun Dunna, Pamela Griffith, Steve Matsumoto, Rishab Nithyanad, Pinar Ozisik, Vyas Sekar, Mahmood Sharif, Rachee Singh, Kyle Soska, Janos Szurdi, Xiao Hui Tai, and Nicholas Weaver for helpful comments and suggestions.

This research was financially supported by the Ministry of Science and ICT, Korea, under award IITP-2019-H8601-15-1011; by the National Science Foundation, United States, under awards CNS-1350720, CNS-1651784, CNS-1700657, CNS-1740895, and CNS-1814817; by a Google Faculty Research Award; and by the Open Technology Fund under an Information Controls Fellowship. The opinions in this paper are those of the authors.