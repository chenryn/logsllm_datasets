### Section 3.4
Future research should aim to obtain timing measurements from all current and future Man-in-the-Middle (MITM) phishing tools. The code and data for this study can be accessed at [Catching Transparent Phish](https://catching-transparent-phish.github.io).

### Acknowledgements
We would like to extend our gratitude to our shepherd, Sooel Son, and the anonymous reviewers for their valuable feedback. This work was supported by the Office of Naval Research (ONR) under grant N00014-20-1-2720, as well as by the National Science Foundation (NSF) under grants CMMI-1842020, CNS-1813974, CNS-1941617, and CNS-2126654.

### Session 1A: Cybercrime CCS '21
**CCS '21, November 15–19, 2021, Virtual Event, Republic of Korea**

### References
[1] Amazon Web Services. (2021). https://aws.amazon.com

[2] Apache Traffic Server. (2021). https://trafficserver.apache.org

[3] Apache Web Server. (2021). https://apache.org

[4] Certificate Transparency. (2021). https://certificate-transparency.org

[5] CloudFlare. (2021). https://cloudflare.com

[6] CredSniper. (2021). https://github.com/ustayready/CredSniper

[7] Digital Ocean. (2021). https://digitalocean.com

[8] Evilginx. (2021). https://github.com/kgretzky/evilginx2

[9] Facebook Certificate Transparency API. (2021). https://developers.facebook.com/docs/certificate-transparency

[10] JA3. (2021). https://github.com/salesforce/ja3

[11] JA3er. (2021). https://ja3er.com

[12] Let’s Encrypt. (2021). https://letsencrypt.org

[13] Linode. (2021). https://linode.com

[14] Modlishka. (2021). https://github.com/drk1wi/Modlishka

[15] Muraena. (2021). https://github.com/muraenateam/muraena

[16] Necrobrowser. (2021). https://github.com/muraenateam/necrobrowser

[17] Nginx. (2021). https://nginx.com

[18] Openphish. (2021). https://openphish.com

[19] Phishtank. (2021). https://phishtank.com

[20] Reelphish. (2021). https://github.com/fireeye/ReelPhish

[21] Selenium. (2021). https://selenium.dev

[22] Squid Proxy Server. (2021). http://squid-cache.org

[23] TLS Prober. (2021). https://github.com/WestpointLtd/tls_prober

[24] TOR. (2021). https://torproject.org

[25] VirusTotal. (2021). https://virustotal.com

[26] VirusTotal Evilginx Analysis Results. (2021). https://www.virustotal.com/gui/file/35636566f7ce11d44c2acf6ce6dca00b730b39710e82000a0e92b4af4a75e52c/detection

[27] Abdelnabi, S., Krombholz, K., & Fritz, M. (2020). VisualPhishNet: Zero-Day Phishing Website Detection by Visual Similarity. In Proceedings of the ACM Conference on Computer and Communications Security (CCS).

[28] Adebowale, M. A., Lwin, K. T., Sanchez, E., & Hossain, M. A. (2019). Intelligent web-phishing detection and protection scheme using integrated features of Images, frames, and text. Expert Systems with Applications, 115, 300–313.

[29] Alexander, D. R. (2015). Inferring the Presence of Reverse Proxies Through Timing Analysis. Technical Report. Naval Postgraduate School Monterey CA.

[30] Antonakakis, M., Perdisci, R., Lee, W., Vasiloglou, N., & Dagon, D. (2011). Detecting Malware Domains at the Upper DNS Hierarchy. In Proceedings of the 10th USENIX Security Symposium (USENIX Security), 1–16.

[31] APWG. (2017). Global Phishing Survey: Trends and Domain Name Use in 2016. Technical Report.

[32] Blum, A., Wardman, B., Solorio, T., & Warner, G. (2010). Lexical feature-based phishing URL detection using online learning. In Proceedings of the 3rd ACM Workshop on Artificial Intelligence and Security, 54–60.

[33] Canali, D., Cova, M., Vigna, G., & Kruegel, C. (2011). Prophiler: A fast filter for the large-scale detection of malicious web pages. In Proceedings of the 20th International Conference on World Wide Web (WWW). ACM, 197–206.

[34] Corona, I., Biggio, B., Contini, M., Piras, L., Corda, R., Mereu, M., Mureddu, G., Ariu, D., & Roli, F. (2017). Deltaphish: Detecting phishing webpages in compromised websites. In Proceedings of the 2017 European Symposium on Research in Computer Security. Springer, 370–388.

[35] Durumeric, Z., Wustrow, E., & Halderman, J. A. (2013). ZMap: Fast Internet-wide scanning and its security applications. In 22nd USENIX Security Symposium, 605–620.

[36] Han, X., Kheir, N., & Balzarotti, D. (2016). Phisheye: Live monitoring of sandboxed phishing kits. In Proceedings of the 2016 SIGSAC Conference on Computer and Communications Security (CCS). ACM, 1402–1413.

[37] Hao, S., Kantchelian, A., Miller, B., Paxson, V., & Feamster, N. (2016). PREDATOR: Proactive recognition and elimination of domain abuse at time-of-registration. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security, 1568–1579.

[38] Invernizzi, L., Thomas, K., Kapravelos, A., Comanescu, O., Picod, J.-M., & Bursztein, E. (2016). Cloak of visibility: Detecting when machines browse a different web. In 2016 IEEE Symposium on Security and Privacy (SP). IEEE, 743–758.

[39] Jain, A. K., & Gupta, B. B. (2018). Towards detection of phishing websites on client-side using machine learning based approach. Telecommunication Systems, 68(4), 687–700.

[40] Kintis, P., Miramirkhani, N., Lever, C., Chen, Y., Romero-Gómez, R., Pitropakis, N., Nikiforakis, N., & Antonakakis, M. (2017). Hiding in plain sight: A longitudinal study of combosquatting abuse. In Proceedings of the 2017 SIGSAC Conference on Computer and Communications Security. ACM, 569–586.

[41] Le, A., Markopoulou, A., & Faloutsos, M. (2011). Phishdef: URL names say it all. In Proceedings of the 2011 IEEE INFOCOM. IEEE, 191–195.

[42] Li, X., Geng, G., Yan, Z., Chen, Y., & Lee, X. (2016). Phishing detection based on newly registered domains. In 2016 IEEE international conference on big data (big data). IEEE, 3685–3692.

[43] Marchal, S., François, J., Engel, T., et al. (2012). Proactive discovery of phishing-related domain names. In International Workshop on Recent Advances in Intrusion Detection. Springer, 190–209.

[44] Martin, A., Anutthamaa, N., Sathyavathy, M., Saint Francois, M. M., Prasanna Venkatesan, V., et al. (2011). A framework for predicting phishing websites using neural networks. arXiv preprint arXiv:1109.1074.

[45] Matthew, S., & Xie, G. (2013). Fingerprinting Reverse Proxies Using Timing Analysis of TCP Flows. Technical Report. Naval Postgraduate School Monterey CA.

[46] Medvet, E., Kirda, E., & Kruegel, C. (2008). Visual-similarity-based phishing detection. In Proceedings of the 4th International Conference on Security and Privacy in Communication Networks, 1–6.

[47] Nappa, A., Munir, R. F., Tanoli, I. K., Kreibich, C., & Caballero, J. (2016). RevProbe: Detecting silent reverse proxies in malicious server infrastructures. In Proceedings of the 32nd Annual Conference on Computer Security Applications, 101–112.

[48] Nelms, T., Perdisci, R., Antonakakis, M., & Ahamad, M. (2016). Towards measuring and mitigating social engineering software download attacks. In Proceedings of the 25th USENIX Security Symposium (USENIX Security), 773–789.

[49] Oest, A., Safaei, Y., Doupé, A., Ahn, G.-J., Wardman, B., & Tyers, K. (2019). Phishfarm: A scalable framework for measuring the effectiveness of evasion techniques against browser phishing blacklists. In 2019 IEEE Symposium on Security and Privacy (SP). IEEE, 1344–1361.

[50] Oest, A., Safei, Y., Doupé, A., Ahn, G.-J., Wardman, B., & Warner, G. (2018). Inside a phisher’s mind: Understanding the anti-phishing ecosystem through phishing kit analysis. In 2018 APWG Symposium on Electronic Crime Research (eCrime). IEEE, 1–12.

[51] Oest, A., Safei, Y., Doupé, A., Ahn, G.-J., Wardman, B., & Warner, G. (2018). Inside a Phisher’s Mind: Understanding the Anti-Phishing Ecosystem Through Phishing Kit Analysis. In Proceedings of the 2018 APWG Symposium on Electronic Crime Research (eCrime). IEEE, 1–12.

[52] Oest, A., Zhang, P., Wardman, B., Nunes, E., Burgis, J., Zand, A., Thomas, K., Doupé, A., & Ahn, G.-J. (2020). Sunrise to Sunset: Analyzing the End-to-end Life Cycle and Effectiveness of Phishing Attacks at Scale. In Proceedings of the 29th USENIX Security Symposium (USENIX Security).

[53] Prakash, P., Kumar, M., Kompella, R. R., & Gupta, M. (2010). Phishnet: Predictive blacklisting to detect phishing attacks. In 2010 Proceedings IEEE INFOCOM. IEEE, 1–5.

[54] Rahbarinia, B., Perdisci, R., & Antonakakis, M. (2015). Segugio: Efficient behavior-based tracking of malware-control domains in large ISP networks. In Proceedings of the 45th Annual IEEE/IFIP International Conference on Dependable Systems and Networks. IEEE, 403–414.

[55] Sheng, S., Wardman, B., Warner, G., Cranor, L., Hong, J., & Zhang, C. (2009). An Empirical Analysis of Phishing Blacklists.

[56] Stringhini, G., Kruegel, C., & Vigna, G. (2010). Detecting spammers on social networks. In Proceedings of the 26th Annual Computer Security Applications Conference, 1–9.

[57] Thomas, K., Li, F., Zand, A., Barrett, J., Ranieri, J., Invernizzi, L., Markov, Y., Comanescu, O., Eranti, V., Moscicki, A., et al. (2017). Data Breaches, Phishing, or Malware? Understanding the Risks of Stolen Credentials. In Proceedings of the 2017 SIGSAC Conference on Computer and Communications Security. ACM, 1421–1434.

[58] Ulqinaku, E., Lain, D., & Capkun, S. (2019). 2FA-PP: 2nd Factor Phishing Prevention. In Proceedings of the 12th Conference on Security and Privacy in Wireless and Mobile Networks (WiSec), 60–70.

[59] Weant, M. S. (2013). Fingerprinting reverse proxies using timing analysis of TCP flows. Technical Report. Naval Postgraduate School Monterey CA.

[60] Weaver, N., Kreibich, C., Dam, M., & Paxson, V. (2014). Here be web proxies. In Proceedings of the International Conference on Passive and Active Network Measurement. Springer, 183–192.

[61] Whittaker, C., Ryner, B., & Nazif, M. (2010). Large-scale automatic classification of phishing pages. In Proceedings of the 17th Network and Distributed System Security Symposium (NDSS).

### Appendix
#### Example Configuration File for Evilginx
```yaml
proxy_hosts:
  - domain: 'twimg.com'
  - domain: 'twitter.com'
keys:
  credentials:
    username:
      key: 'session[username_or_email]'
      search: '(.*)'
      type: 'post'
    password:
      key: 'session[password]'
      search: '(.*)'
      type: 'post'
  sub_filters:
    auth_tokens: []
  - domain: '.twitter.com'
    session:
      true
    is_landing:
      true
    js_inject:
      - { phish_sub: 'api', orig_sub: 'api' }
      - { phish_sub: 'abs', orig_sub: 'abs' }
      - { phish_sub: '', orig_sub: '', domain: 'twitter.com' }
```

#### Table 7: Full Feature Set of Our 2FA Phishing Toolkit Classifier
| Feature Name | Feature Type |
|--------------|--------------|
| **Network Timing Features** | |
| TCP SYN/ACK RTT | Numeric |
| TLS Client Hello RTT | Numeric |
| Malformed TLS Client Hello RTT | Numeric |
| TLS Handshake Timing | Numeric |
| HTTP GET Request Timing | Numeric |
| HTTP GET Request w/o Host Header Timing | Numeric |
| Malformed HTTP GET Request Timing | Numeric |
| HTTPS GET Request Timing | Numeric |
| HTTPS GET Request w/o Host Header Timing | Numeric |
| Malformed HTTPS GET Request Timing | Numeric |
| TCP SYN/ACK to HTTP GET Request Timing Ratio | Numeric |
| TCP SYN/ACK to Malformed HTTP GET Request Timing Ratio | Numeric |
| TCP SYN/ACK to Malformed HTTPS Get Request Timing Ratio | Numeric |
| Malformed to Valid HTTPS GET Request Timing Ratio | Numeric |
| **TLS Versions Supported** | |
| SSLv2 | Binary |
| SSLv3 | Binary |
| TLSv1 | Binary |
| TLSv1.2 | Binary |
| TLSv1.3 | Binary |
| **TLS Library** | |
| Apache Tomcat 7.0.53 | Numeric |
| Apache Tomcat 7.0.54 | Numeric |
| ... 177 more TLS libraries ... | |
| openssl 1.0.2a default source build | Numeric |
| wolfSSL 3.4.0 | Numeric |

#### Table 8: Full Set of Trademarks Our System Received Impersonating Domains for from Certificate Transparency Logs
| Category | Trademarks |
|----------|------------|
| Email | Google, Yahoo, Outlook, Protonmail |
| Financial | PayPal, Chase, Wells Fargo, Bank of America, HSBC, Citi Bank, Capital One, American Express |
| Social Media | Facebook, Instagram, Twitter, LinkedIn |
| Web Services | Dropbox, Amazon, GitHub, Office 365 |
| Technology | Apple, Microsoft |