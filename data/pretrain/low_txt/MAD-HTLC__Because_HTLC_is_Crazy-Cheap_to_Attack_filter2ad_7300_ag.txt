以下是优化后的文本，使其更加清晰、连贯和专业：

---

**参考文献**

[54] B. D. Bernheim, “Rationalizable Strategic Behavior,” *Econometrica: Journal of the Econometric Society*, 1984.

[55] M. Khabbazian, T. Nadahalli, and R. Wattenhofer, “Timelocked Bribing.”

[56] D. Robinson and G. Konstantopoulos, “Ethereum is a Dark Forest,” Medium, 2020. [在线]. 可用: https://medium.com/@danrobinson/ethereum-is-a-dark-forest-ecc5f0505dff

[57] K. Malinova and A. Park, “Market Design with Blockchain Technology,” SSRN 2785626, 2017.

[58] Y. Doweck and I. Eyal, “Multi-Party Timed Commitments,” 2020.

[59] S. Eskandari, S. Moosavi, and J. Clark, “SOK: Transparent Dishonesty: Front-Running Attacks on Blockchain,” 2019.

[60] L. Zhou, K. Qin, C. F. Torres, D. V. Le, and A. Gervais, “High-Frequency Trading on Decentralized On-Chain Exchanges,” arXiv preprint arXiv:2009.14021, 2020.

[61] A. Munro, “Fomo3D Ethereum Ponzi Game R1 Outmaneuvers Bots,” Finder, 2018. [在线]. 可用: https://www.finder.com.au/fomo3d-ethereum-ponzi-game-r1-ends-as-hot-play-outmaneuvers-bots

[62] I. Bentov, Y. Ji, F. Zhang, L. Breidenbach, P. Daian, and A. Juels, “Tesseract: Real-Time Cryptocurrency Exchange Using Trusted Hardware,” in *Proceedings of the 2019 ACM CCS*, 2019.

[63] J. Prestwich, “Miners Aren’t Your Friends,” Keep Network Blog, 2018. [在线]. 可用: https://blog.keep.network/miners-arent-your-friends-cde9b6e0e9ac

[64] I. Tsabary and I. Eyal, “The Gap Game,” in *ACM CCS*, 2018.

[65] J. Sliwinski and R. Wattenhofer, “Blockchains Cannot Rely on Honesty.”

[66] M. Carlsten, H. Kalodner, S. M. Weinberg, and A. Narayanan, “On the Instability of Bitcoin Without the Block Reward,” in *Proceedings of the 2016 ACM CCS*, 2016.

[67] I. Tsabary, A. Spiegelman, and I. Eyal, “HEB: Hybrid Expenditure Blockchain,” arXiv, 2019.

[68] D. Easley, M. O’Hara, and S. Basu, “From Mining to Markets: The Evolution of Bitcoin Transaction Fees,” *Journal of Financial Economics*, 2019.

[69] R. Khalil and A. Gervais, “Revive: Rebalancing Off-Blockchain Payment Networks,” in *Proceedings of the 2017 ACM CCS*, 2017.

[70] L. Gudgeon, P. Moreno-Sanchez, S. Roos, P. McCorry, and A. Gervais, “SOK: Off the Chain Transactions,” IACR ePrint, 2019.

[71] L. Aumayr, O. Ersoy, A. Erwig, S. Faust, K. Host´akov´a, M. Maffei, P. Moreno-Sanchez, and S. Riahi, “Generalized Bitcoin-Compatible Channels.”

[72] Blockstream, “Blockstream Lightning Implementation,” 2020. [在线]. 可用: https://blockstream.com/lightning/

[73] Lightning Labs, “Lightning Labs Lightning Implementation,” 2020. [在线]. 可用: https://lightning.engineering/

[74] Acinq, “Acinq Lightning Implementation,” 2020. [在线]. 可用: https://acinq.co/

[75] Raiden, “Raiden Network,” 2020. [在线]. 可用: https://raiden.network/

[76] OmiseGO, “OMG Network Blockchain Design,” 2020. [在线]. 可用: https://docs.omg.network/blockchain-design

[77] G. Avarikioti, O. S. T. Litos, and R. Wattenhofer, “Cerberus Channels: Incentivizing Watchtowers for Bitcoin,” *Financial Cryptography and Data Security (FC)*, 2020.

[78] P. McCorry, S. Bakshi, I. Bentov, S. Meiklejohn, and A. Miller, “PISA: Arbitration Outsourcing for State Channels,” in *Proceedings of ACM AFT*, 2019.

[79] M. Khabbazian, T. Nadahalli, and R. Wattenhofer, “Outpost: A Responsive Lightweight Watchtower,” in *Proceedings of ACM AFT*, 2019.

[80] E. Wagner, A. Völkert, F. Fuhrmann, R. Matzutt, and K. Wehrle, “Dispute Resolution for Smart Contract-Based Two-Party Protocols,” in *IEEE ICBC*, 2019.

[81] C. Badertscher, U. Maurer, D. Tschudi, and V. Zikas, “Bitcoin as a Transaction Ledger: A Composable Treatment,” in *Annual International Cryptology Conference*, 2017.

[82] S. Goldwasser, S. Micali, and R. L. Rivest, “A Digital Signature Scheme Secure Against Adaptive Chosen-Message Attacks,” *SIAM Journal on Computing*, 1988.

[83] P. Rogaway and T. Shrimpton, “Cryptographic Hash-Function Basics: Definitions, Implications, and Separations for Preimage Resistance, Second-Preimage Resistance, and Collision Resistance,” in *International Workshop on Fast Software Encryption*, 2004.

[84] S. Dziembowski, L. Eckey, and S. Faust, “FairSwap: How to Fairly Exchange Digital Goods,” in *ACM CCS*, 2018.

[85] I. Eyal and E. G. Sirer, “Majority is Not Enough: Bitcoin Mining is Vulnerable,” in *Financial Cryptography and Data Security*, 2014.

[86] A. Sapirshtein, Y. Sompolinsky, and A. Zohar, “Optimal Selfish Mining Strategies in Bitcoin,” in *FC*, 2016.

[87] Blockchain.info, “Bitcoin Mining Pools,” [在线]. 可用: https://blockchain.info/pools

[88] Andes, “Bitcoin’s Kryptonite: The 51% Attack,” Bitcointalk, June 2011. [在线]. 可用: https://bitcointalk.org/index.php?topic=12435

[89] M. Mirkin, Y. Ji, J. Pang, A. Klages-Mundt, I. Eyal, and A. Juels, “BDOS: Blockchain Denial-of-Service,” in *ACM CCS*, 2020.

[90] J. A. Garay, A. Kiayias, and N. Leonardos, “The Bitcoin Backbone Protocol: Analysis and Applications,” in *Advances in Cryptology - EUROCRYPT 2015 - 34th Annual International Conference on the Theory and Applications of Cryptographic Techniques*, 2015.

[91] R. Pass, L. Seeman, and A. Shelat, “Analysis of the Blockchain Protocol in Asynchronous Networks,” in *Annual International Conference on the Theory and Applications of Cryptographic Techniques*, 2017.

[92] L. Kiffer, R. Rajaraman, and A. Shelat, “A Better Method to Analyze Blockchain Consistency,” in *Proceedings of the 2018 ACM CCS*, 2018.

[93] Blockchain.info, “Mempool Transaction Count,” [在线]. 可用: https://blockchain.info/charts/mempool-count

[94] R. Lavi, O. Sattath, and A. Zohar, “Redesigning Bitcoin’s Fee Market,” in *The World Wide Web Conference*, 2019.

[95] I. Tsabary, M. Yechieli, and I. Eyal, “MAD-HTLC: Because HTLC is Crazy-Cheap to Attack (Extended Version),” arXiv:2006.12031, 2020.

[96] A. Kiayias, H.-S. Zhou, and V. Zikas, “Fair and Robust Multi-Party Computation Using a Global Transaction Ledger,” in *Annual International Conference on the Theory and Applications of Cryptographic Techniques*, 2016.

[97] R. Cheng, F. Zhang, J. Kos, W. He, N. Hynes, N. Johnson, A. Juels, A. Miller, and D. Song, “Ekiden: A Platform for Confidentiality-Preserving, Trustworthy, and Performant Smart Contracts,” in *2019 IEEE EuroS&P*, 2019.

[98] A. Kiayias and O. S. T. Litos, “A Composable Security Treatment of the Lightning Network,” in *2020 IEEE 33rd Computer Security Foundations Symposium (CSF)*, 2020.

[99] L. Luu, D.-H. Chu, H. Olickel, P. Saxena, and A. Hobor, “Making Smart Contracts Smarter,” in *Proceedings of the 2016 ACM CCS*, 2016.

[100] M. Wohrer and U. Zdun, “Smart Contracts: Security Patterns in the Ethereum Ecosystem and Solidity,” in *2018 International Workshop on Blockchain Oriented Software Engineering (IWBOSE)*, 2018.

[101] Y. Huang, Y. Bian, R. Li, J. L. Zhao, and P. Shi, “Smart Contract Security: A Software Lifecycle Perspective,” *IEEE Access*, 2019.

[102] E. Zhou, S. Hua, B. Pi, J. Sun, Y. Nomura, K. Yamashita, and H. Kurihara, “Security Assurance for Smart Contract,” in *2018 9th IFIP International Conference on New Technologies, Mobility and Security (NTMS)*, 2018.

[103] K. Delmolino, M. Arnett, A. Kosba, A. Miller, and E. Shi, “Step by Step Towards Creating a Safe Smart Contract: Lessons and Insights from a Cryptocurrency Lab,” in *International Conference on Financial Cryptography and Data Security*, 2016.

[104] N. Atzei, M. Bartoletti, and T. Cimoli, “A Survey of Attacks on Ethereum Smart Contracts (SOK),” in *International Conference on Principles of Security and Trust*, 2017.

[105] I. Nikolić, A. Kolluri, I. Sergey, P. Saxena, and A. Hobor, “Finding the Greedy, Prodigal, and Suicidal Contracts at Scale,” in *Proceedings of the 34th Annual Computer Security Applications Conference*, 2018.

[106] L. Breidenbach, P. Daian, A. Jules, and E. G. Sirer, “An In-Depth Look at the Parity Multisig Bug,” 2017. [在线]. 可用: https://hackingdistributed.com/2017/07/22/deep-dive-parity-bug/

[107] K. Bhargavan, A. Delignat-Lavaud, C. Fournet, A. Gollamudi, G. Gonthier, N. Kobeissi, N. Kulatova, A. Rastogi, T. Sibut-Pinote, N. Swamy et al., “Formal Verification of Smart Contracts: Short Paper,” in *Proceedings of the 2016 ACM Workshop on Programming Languages and Analysis for Security*, 2016.

[108] R. Canetti, A. Jain, and A. Scafuro, “Practical UC Security with a Global Random Oracle,” in *Proceedings of the 2014 ACM CCS*, 2014.

[109] J. Camenisch, M. Drijvers, T. Gagliardoni, A. Lehmann, and G. Neven, “The Wonderful World of Global Random Oracles,” in *Annual International Conference on the Theory and Applications of Cryptographic Techniques*, 2018.

[110] J.-F. Mertens and A. Neyman, “Stochastic Games,” *International Journal of Game Theory*, 1981.

[111] Y. Shoham and K. Leyton-Brown, *Multiagent Systems: Algorithmic, Game-Theoretic, and Logical Foundations*, 2008.

[112] M. J. Osborne and A. Rubinstein, *A Course in Game Theory*, 1994.

[113] E. Zermelo, “Über eine Anwendung der Mengenlehre auf die Theorie des Schachspiels,” in *Proceedings of the Fifth International Congress of Mathematicians*, 1913.

[114] R. J. Aumann, “Backward Induction and Common Knowledge of Rationality,” *Games and Economic Behavior*, 1995.

[115] M. M. Kamiński, “Backward Induction: Merits and Flaws,” *Studies in Logic, Grammar and Rhetoric*, 2017.

[116] Bitcoin Core, “Bitcoin Core,” [在线]. 可用: https://bitcoin.org/en/bitcoin-core/

[117] Ethereum, “Geth,” [在线]. 可用: https://geth.ethereum.org/

[118] Parity, “Parity,” [在线]. 可用: https://www.parity.io/ethereum/

[119] Ethereum Stack Exchange, “Ethereum Client Transaction Ordering,” [在线]. 可用: https://ethereum.stackexchange.com/questions/6107/what-is-the-default-ordering-of-transactions-during-mining-in-e-g-geth/

[120] G. Andresen, “BIP 16: Pay to Script Hash,” 2013. [在线]. 可用: https://github.com/bitcoin/bips/blob/master/bip-0016.mediawiki

[121] P. W. Eric Lombrozo, Johnson Lau, “BIP 141: Segregated Witness (Consensus Layer),” 2017. [在线]. 可用: https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki

[122] Blockchain.info, “Bitcoin Transaction Fees,” 2020. [在线]. 可用: https://www.blockchain.com/charts/mempool-state-by-fee-level

[123] CoinDesk, “Bitcoin Price,” 2020. [在线]. 可用: https://www.coindesk.com/price/bitcoin

[124] Ethereum, “Smart Contracts Libraries,” 2020. [在线]. 可用: https://ethereum.org/en/developers/docs/smart-contracts/libraries/

[125] Liquality, “Liquality BTC-ETH Atomic Swap, Ethereum Transaction,” 2020. [在线]. 可用: shorturl.at/lpDP7

[126] N. Arnosti and S. M. Weinberg, “Bitcoin: A Natural Oligopoly,” arXiv preprint arXiv:1811.08572, 2018.

[127] 1ml, “Lightning Top Capacity Channel,” 2020. [在线]. 可用: https://1ml.com/channel/684407505443356673

[128] Blockstream, “Lightning Top Capacity Channel Closing Transaction,” 2020. [在线]. 可用: shorturl.at/jwNO7

[129] Insight.litecore, “Litecoin Atomic Swap Spend,” 2017. [在线]. 可用: https://insight.litecore.io/tx/6c27cffab8a86f1b3be1ebe7acfbbbdcb82542c5cfe7880fcca60eab36747037

[130] Liquality, “Liquality Atomic Swaps,” 2020. [在线]. 可用: https://liquality.io/swap/

[131] Liquality, “Liquality BTC-ETH Atomic Swap, Bitcoin Transaction,” 2020. [在线]. 可用: https://blockstream.info/address/bc1qhmjx0mk3p2trxe829lxgc9hwqjdzv0ueshmmgl7yfqdlnje45q4st7q9q8

[132] S. Tikhomirov, P. Moreno-Sanchez, and M. Maffei, “A Quantitative Analysis of Security, Anonymity and Scalability for the Lightning Network,” IACR Cryptol. ePrint Arch., 2020.

[133] A. Mizrahi and A. Zohar, “Congestion Attacks in Payment Channel Networks,” arXiv preprint arXiv:2002.06564, 2020.

---

**附录 A：MAD-HTLC 激励兼容性引理证明**

本节展示了引理 4、引理 5 和引理 6 的证明。为了便于阅读，我们在此回顾这些引理。

**引理 4**：
如果在最后一轮中 A 和 B 都发布了他们的交易，则矿工的最佳响应策略是不包括 A 或 B 的任何交易。

**证明**：
由于 A 和 B 发布了他们的交易，所有矿工都可以访问 prea 和 preb。因此，任何矿工都可以创建一个交易来赎回 MH-Dep 和 MH-Col。

如果 MH-Dep 是不可赎回的（即 ΓMH(T, irred)），则矿工可以创建 txcol 并获得 vcol 代币作为奖励。或者，如果 txcol 已发布，他们可以将其包含在一个区块中，获得 f col 代币作为手续费。在这种情况下，包含 txcol 严格优于直接赎回 MH-Col，因为 MH-Dep 是不可赎回的。

如果 MH-Dep 是可赎回的（即 ΓMH(T, red)），矿工也可以创建 txdep+col，将其包含在一个区块中，并获得 vdep + vcol 作为奖励。或者，他们可以包含 txdep 或 txcol（无论哪个已发布）。然而，这些交易提供的手续费低于 vdep + vcol，使得它们被包含 txdep+col 严格占优。

无论如何，包含 A 或 B 的任何交易都会导致更低的奖励，因此矿工会避免这样做。

**引理 5**：
在 ΓMH(1, red) 中，A 不能通过偏离规定的策略来增加她的效用。

**证明**：
首先，如果 A 不知道 prea，她无法采取任何行动，因此自然遵守规定的策略。

如果 A 知道 prea，则她的可能偏差是根本不发布 txdep 或只在最后一轮 T 中发布它。

根本不发布 txdep 是严格劣势的——她将得不到任何代币；如果她遵循规定的策略，则至少可以获得与规定策略相同的收益，甚至更多，例如，如果 B 也遵循规定的策略（引理 2）。

txdep 是否包含在最后一个区块中取决于 B 在整个游戏中发布的交易（引理 4）。也就是说，如果 B 发布了 txdep 或 txdep+col，则矿工的最佳响应是不包含 txdep，A 将得不到任何代币。否则，矿工的最佳响应是包含提供最高手续费的交易，这可能是 txdep 或另一个交易，分别使 A 获得 vdep − f dep 和 0 代币。

因此，A 通过偏离规定的策略不能获得更高的收益，在某些情况下甚至会遭受损失。

**引理 6**：
在 ΓMH(1, red) 中，B 不能通过偏离规定的策略来增加他的效用。

**证明**：
考虑 B 的所有可能行动。他的潜在最大效用来自 txdep+col 被包含，这可以通过遵循规定的策略在 A 不知道 prea 的情况下实现（引理 3）。因此，在这种情况下他没有偏离规定的动机。

现在，考虑 A 知道 prea 的情况，根据引理 5，A 会发布 txdep。在这种情况下，B 的最佳策略仍然是发布 txdep+col，因为他无法通过其他方式获得更高的效用。

因此，B 通过偏离规定的策略不能获得更高的收益。