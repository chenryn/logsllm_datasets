# Ayoub ELAASSAL
**Email:** [PI:EMAIL]  
**Twitter:** [@ayoul3__]  
**Website:** [mainframesproject.tumblr.com](https://mainframesproject.tumblr.com)  
**GitHub:** [github.com/ayoul3]  
**Personal Blog:** [zospentest.tumblr.com]

---

## CICS Breakdown: Hack Your Way to Transaction City
© WAVESTONE

### What People Think of When I Talk About Mainframes
© WAVESTONE

### The Reality: IBM zEC13 Technical Specifications
- **RAM:** 10 TB
- **Processors:** 141, 5 GHz
- **Dedicated Processors:** JAVA, XML, and UNIX
- **Cryptographic Chips**

Impressive, right? But who uses these anymore?

### Organizations Using Mainframes
Here is a list of organizations that still rely on mainframe technology:

- APIS IT
- Atos Origin
- Applabs
- Arby’s
- Wendy’s Group
- Archer Daniels Midland
- Assurant
- AT&T / BellSouth / Cingular
- Atlanta Housing Authority
- Atlanta Journal Constitution
- Atlantic Pacific Tea Company (A&P)
- Aurum/BSPR
- Auto Zone
- Aviva
- Avnet
- Avon (Westchester)
- Axa (Jersey City)
- ANZ Bank
- BI Moyle Associates, Inc.
- Bajaj Allianz
- Bank Central Asia (BCA)
- Bank Indonesia (BI)
- Bank International Indonesia (BII)
- Bank Nasional Indonesia (BNI46)
- Bank of America
- Bank of America (BAC)
- Bank of America (Alpharetta office)
- Bank of Montreal (BMO:CN)
- Bank of New York Mellon (BNY)
- Bank of Tokyo (Jersey City)
- Bank Rakyat Indonesia (BRI)
- Bank Vontobel
- BB&T
- Belastingdienst
- Bi-Lo
- Blue Cross Blue Shield
- Blue Cross Blue Shield GA
- Blue Cross Blue Shield MD
- Blue Cross Blue Shield SC
- Blue Cross Blue Shield TN
- Blue Cross/Blue Shield of Texas
- Brindley Technologies
- BMC Software
- BMW
- BNP Paribas Fortis Brussels Belgium
- BNP Paribas Paris France
- Boston University
- Broadridge Financial Services
- Brotherhood Bank & Trust
- Broward County Schools
- Brown Brothers Harriman (BBH)
- British Airways
- C&S Wholesale Grocers
- CA Technologies
- California Casualty Management Company
- Canadian Imperial Bank of Commerce (CIBC)
- Capgemini
- Capco
- Capital One
- Caterpillar
- Cathy Pacific
- CDSI
- Ceridian
- CGI
- Charles Schwab
- Chase
- Chemical Abstract Services (CAS)
- Choice Point
- Chrysler
- Chubb
- Ciber
- CIC
- CIGNA
- Citi
- Citi / Primerica
- Citigroup
- City and County of Alameda, California
- City of Atlanta
- City of New York
- City of Phoenix
- Co-operators Canada
- Coca-Cola Enterprises
- Coca-Cola Co
- Coding Basics, Inc.
- Cognizant Technology Solutions
- Collective Brands
- Collabera
- Commonwealth Automobile Reinsurers
- Comerica Bank
- Commerce Bank Kansas City MO USA
- Commerzbank
- Community Loans of America
- Computer Outsourcing
- Computer Sciences Corporation (CSC)
- Con Edison (Manhattan)
- Connecticut, State of
- Connecture
- Conseco
- Cotton States Mutual Ins. Company
- COVANYS
- CPS
- CPU Service
- Crawford and Company
- Credit Suisse
- CSC
- CSI International OH USA
- CSX
- CTS
- Customs & Border Enforcement (CBE)
- CVS pharmacy
- DATEV eG
- Dekalb County
- Delphi
- Delta Air Lines Inc
- Depository Trust and Clearing Corp
- Deutsche Bank
- Deutsche Bundesbank
- DHL IT Services
- Deloitte
- DEVK Köln
- DIGITAL
- Dominion Power/Dominion Resources
- Donovan Data Systems (Manhattan)
- DST
- DST Output
- DTC (Manhattan)
- Duke Energy
- Duke Power, DB2 apps
- Eaton Cleveland Ohio USA
- Ecolab, Inc
- EDB ErgoGroup
- Eddie Bauer
- EDEKA
- EDS
- Edward Jones
- ELCOT
- ELIT
- Emblem Health
- EMC
- Emigrant Savings Bank
- Emirates Airline
- Emory University
- Enbridge Gas Distribution
- Energy Future Holdings
- Equifax Inc
- Experian Americas
- Express Scripts
- Extensity
- Family Life Ins. Co.
- FannieMae
- Farm Bureau Financial Services
- Federal Reserve
- FedEx
- FHNC/First Tennessee Bank
- Fidelity Investments
- Fiducia
- FINA
- Finanz Informatik
- First Data
- FIS
- Fiserv
- Florida Blue
- Florida Power & Light
- Ford
- Ford Motor Co
- Fortis
- FPL
- Franklin Templeton
- FreddieMac
- Friedkin Information Technology
- Fujitsu America
- Fulton County
- Garanti Technology
- GAVI
- Garuda Indonesia
- GCCPC
- GE Financial Assurance
- GEICO
- General Dynamics
- General Motors
- Genuine Auto Parts (Motion Industries)
- Georgia Farm Bureau Mutual
- Georgia Pacific
- Georgia State Dept of Education
- Georgia State University
- GKVI
- Global SMS Networks Pvt. Ltd.
- GM
- GMAC SmartCash
- Grady Hospital
- Great-West Life
- Governor's Office
- Great Lakes Higher Education Corp.
- Group Health Cooperative
- Guardian Life
- Gwinnett County
- Gwinnett County School District
- Gwinnett Medical Center
- H. E. Butt Grocery Co.
- H&W Computer Systems, Inc.
- Harland Clarke
- Hartford Life
- HCL
- HDFC Bank
- HealthPlan Services
- Heartland Payment Systems
- Helsana
- Hewlett Packard
- Hexaware
- Highmark
- HMC Holdings
- HMS
- Home Depot
- HPS4
- HSBC Trinkaus & Burkhardt AG
- HSBC
- IBM
- IBM Global Services
- IBM India
- IBM Silicon Valley Laboratory
- IBM Tucson, Arizona Software Development Laboratory
- Iflex
- Igate
- Information Builders
- Infosys
- Infotel
- ING
- ING NA Insurance Corp
- Innova Solutions Inc.
- Insurance Services Office
- Intercontinental Hotels Group
- IPACS
- IRS
- ISO
- ITERGO
- IVV
- Jackson National
- Jefferies Bank
- John Deere
- JPMorgan Chase
- Kaiser Permanente
- Kansas City Life
- Kawasaki Motors Corp
- KEANE
- KEONICS
- Key Bank
- Klein Mgt. Systems
- Kohl's Department Stores
- Krakatau Steel
- KPN
- Krasdale Foods, Inc.
- L&T
- LabCorp
- Lawrence Livermore National Laboratories
- LBBW
- LDS
- Lender Processing Services
- Leumi Bank
- LexisNexis
- Liberty Life
- Liberty Mutual
- Lincoln National
- Lloyds Banking Group
- Lockheed
- Logica CMG
- Louisiana Housing Finance Agency
- Lowe's
- Lufthansa Systems
- M&T Bank
- Macro Soft
- Macy's Systems and Technologies
- Maersk Data
- Maersk Lines
- Mahindra Satyam
- Mainframe Co Ltd
- Mainline Information Systems
- Maintec Technologies Inc.
- MAJORIS
- Manhattan Associates
- Manulife
- Marist College
- Marriott Hotel
- MARTA
- MASCON
- Mass Mutual
- MASTEK
- MasterCard INC
- Maybank
- MBT
- Media Ocean
- Medical College of Georgia
- Medical Mutual of Ohio
- Medicare
- MedStar Health
- Meredith Corp
- Merlin International
- Veteran Affairs
- Merrill Lynch
- MetaVante
- MetLife
- Metro North
- MFX
- MHS
- Miami-Dade County
- MINDTEK
- MINDTREE
- Ministry of Interior
- Missouri Gas Energy
- Modern Woodmen of America
- Montefiore Hospital
- Morgan Stanley
- Motor Vehicles Admin
- Mphasis
- Mpowerss
- Mt. Sinai
- Mutual of America
- NASDAQ Stock Market
- Nationwide Insurance
- National Life Group
- National Life Ins. Co.
- NAV
- Navistar
- NBNZ
- Nest
- New York Times
- New York University
- Nike INC
- Norfolk Southern Corp
- North Carolina State Employees' Credit Union
- NYS Dept of Tax and Fin
- OCIT
- OFD
- Office Depot
- Outsourcing deTecnica deSistemas
- Old Mutual
- Ohio Public Employees Retirement System
- ONCOR
- Paccar
- Palm Beach County School District
- Parker Hannifin
- Partsearch Technologies
- Patni
- Penn Mutual
- PepsiCo INC
- Pershing LLC
- Philip Morris
- Phoenix Companies
- Phoenix Home Life
- Physicians Mutual Insurance Company
- Pioneer Life Insurance
- Pitney Bowes
- PKO BP
- PNC Bank
- POLARIS
- Polfa Tarchomin
- Praxair
- Primerica Life Ins Co
- Princeton Retirement Group Inc
- Principal Financial Group
- Progressive Insurance
- Prokarma
- Protech Training
- Prudential
- PSA Peugeot Citroen
- PSP
- PSC Electrical Contracting
- Publix
- Puget Sound Energy
- PCCW
- PwC
- QBE the Americas
- R.R. Donnelley
- R+V
- RBS
- RBSLynk
- RHB bank
- Rite Aid
- Riyad Bank
- Rocket Software
- Roundy's Supermarkets
- Royal Bank of Canada
- Rubbermaid
- Russell Stover
- Rutgers University
- Ryder Trucks
- S1
- SAS
- SATHYAM/PCS
- Schlumberger
- Schneider National
- Scientific Games International, Inc.
- Scope International
- Scotiabank
- Scott Trade
- SE Tools
- Seminole Electric
- Sentry Insurance
- Sears Holdings Corporation
- Self-Employed Consultant
- Shands HealthCare
- SIAC
- Siemens
- SLK software
- Sloan Kettering
- Social Security
- Software Paradigms India
- Southern California Edison
- Southern Company
- Standard Insurance
- State Auto Insurance
- State Farm Ins
- State of Alabama Child Support Enforcement Services
- State of Alaska
- State of California
- State of Connecticut
- State of Florida
- State of Georgia
- State of Illinois
- State of Montana
- Statens Uddannelsesstøtte
- Steria
- SunGard
- SunTrust Banks Inc
- Symetra
- Syntel
- TAG
- Taiwan Cooperative Bank
- Tampa General
- Target INC
- Tata Steel
- TCS
- TD Ameritrade
- TD Auto Finance
- TD Canada Trust
- TechData
- TECO
- Tesco
- Texas A&M University
- Thomson Financial
- Thomson Reuters
- Thrivent
- TIAA-CREF
- Time Customer Service
- Timken
- Total Systems
- Traveler's Insurance
- Travelport
- Treehouse Software, Inc.
- Trinity Health
- TUI
- Turner Broadcasting
- T. Rowe Price
- T-Systems
- UBS
- UBS APAC
- Union Bank
- Union Pacific
- United Health Care
- United Health Group
- United Missouri Bank
- United Parcel Service Inc
- United States Postal Service
- United States Steel
- United Technologies
- Universität Leipzig
- University of California at Berkeley
- University of Chicago
- University of North Carolina
- University System of Georgia
- UNUM Disability/Insurance
- UPS
- US Bank
- US Software
- USAA
- Utica Insurance
- Vanguard Group
- Verizon
- Vertex
- Vettri
- VF Corp.
- Virginia Department of Motor Vehicles
- Virginia Dept of Corrections
- Virginia State Corp, Commission
- Visa Inc.
- Volvo IT Corp.
- VW
- Wachovia
- Waddell & Reed
- Wakefern Food Corp
- Walmart
- Washington State Department of Social and Health Services
- Washington State Department of Transportation
- Washington State Employment Security Department
- Watkins
- Wellogic
- Wellmark
- Wellpoint
- Wells Fargo Bank
- WGV
- Winn-Dixie
- Wipro
- Xansa
- Xerox
- YRCW
- Zions Bancorporation
- Banco Davivienda
- Blue Cross Blue Shield AL
- State of Alabama
- ZETO
- Avon Brasil
- Bacen
- Banco do Brasil
- Banco Bradesco
- Banco Itau
- Bic Banco
- Bovespa
- Casas Bahia
- CEF
- CEPROMAT
- Cielo
- Copel
- Consist
- CPQD
- DPF
- Fiat
- IGS
- HSBC GLT
- Matera
- Montreal
- Porto Seguro
- Prodam SP
- ProdeSP
- RedeCard
- Riocard TI
- Sanepar
- Santander
- Serasa Experian
- SERPRO
- Tivit
- T-System
- Voith
- Zagrebacka Banka
- NMBS-Holding
- City of Tulsa
- State of Arizona
- ADOT
- Business Connexion
- Strate
- First National Bank
- Reserve Bank of India
- Allied Irish Bank
- Sainsbury's Plc
- Gap Inc
- Barclays Bank
- ABSA Bank

---

## About Me
- **Role:** Pentester at Wavestone
- **Focus:** Windows and Unix systems
- **Mainframe Experience:** First hands-on with a mainframe in 2014, hooked ever since
- **Interests:** Metal music and wine
- **Contact:**
  - [zospentest.tumblr.com](https://zospentest.tumblr.com)
  - [github.com/ayoul3](https://github.com/ayoul3)
  - [@ayoul3__](https://twitter.com/ayoul3__)

---

## This Talk
- **Objective:** Demystifying mainframes
- **Topics:**
  - Basics of z/OS
  - Customer Information Control System (CICS)
  - Hacking CICS

---

## Quick Intro to Mainframe Z
- **Operating System:** z/OS (v1.14 and v2.2)
- **Remote Interaction:** Requires a 3270 emulator (e.g., x3270, wc3270)
- **TN3270 Protocol:** Based on Telnet and supported by Wireshark

---

## Essential z/OS Components
- **VTAM:** Virtual Telecommunication Access Method
- **TSO:** Time Sharing Option
- **JES:** Job Entry System
- **OMVS:** Open MVS
- **RACF:** Resource Access Control Facility

---

### VTAM (Virtual Telecommunication Access Method)
- **Function:** Handles TCP/IP and SNA sessions
- **Ports:** 23, 992, 5023, etc.
- **Access:** Provides access to most applications hosted on the mainframe
- **Application Identifier:** Max 8 characters
- **Tip:** To check if you are on VTAM, type `IBM ECHO` and it should return `123456789ABCDEFGH...`

---

### TSO (Time Sharing Option)
- **Function:** Equivalent to a shell on z/OS
- **Usage:** Execute commands, browse files, etc.

---

### JES (Job Entry System)
- **Function:** Manages job execution
- **JCL:** Job Control Language for scripting
- **Queue:** Jobs are queued and executed based on priority

---

### OMVS (Open MVS)
- **Function:** Unix System Services
- **Features:** Implements TCP/IP stack, handles HTTP, FTP, Java, etc.
- **Access:** Directly via open telnet port (1023) or with OMVS command from TSO

---

### RACF (Resource Access Control Facility)
- **Function:** Core security system on z/OS
- **Features:** Database for passwords, certificates, cipher keys, etc.
- **Control:** Resource access, privilege escalation, execution, authentication
- **Alternatives:** TopSecret, ACF2

---

## CICS (Customer Information Control System)
- **Description:** Combination of WordPress and Apache, but for mainframes (since 1968)
- **Current Version:** CICS TS 5.3
- **Features:**
  - API in COBOL/C/Java
  - Handles cache, concurrency access, etc.
  - Uniform rendering of the screen
  - Can handle thousands of requests per second

---

### Request Handling Comparison
| Platform | Requests per Second |
|----------|---------------------|
| Google Search | 1,400,000.00 |
| Facebook Posts | 1,200,000.00 |
| YouTube Views | 1,000,000.00 |
| Twitter Tweets | 800,000.00 |
| CICS | 600,000.00 |

---

### CICS Flow
- **VTAM:** Handles initial connection
- **CICS Region:** Processes transactions
- **GMTRAN:** Transaction identifier
- **CESN:** Program name
- **INQ1:** Inquiry program
- **RACF:** Controls access
- **DFHSNP:** CICS transaction processing
- **PCT:** Program location

---

Thank you for your attention!  
[@ayoul3__]  
© WAVESTONE