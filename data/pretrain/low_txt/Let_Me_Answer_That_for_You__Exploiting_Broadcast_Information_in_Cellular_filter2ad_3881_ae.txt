### 5. Countermeasures

In this section, we present two countermeasures against the attacks we have developed. Specifically, we propose different approaches to address both the denial of service (DoS) and mobile-terminated (MT) service hijacking issues. A comprehensive solution is required to simultaneously resolve both problems. Unlike the second prevention strategy, which addresses each issue separately, the first solution resolves both issues at once but requires a protocol change.

#### First Solution: Protocol Change in Paging Procedure

For the first solution, we propose modifying the paging protocol procedure [4]. The current authentication process involves the network sending a 128-bit random challenge (RAND) to the subscriber. Using the secret key \( K_i \), which is stored only on the SIM card or in the authentication center of the network, the subscriber computes a 32-bit response value (SRES) using the A3 algorithm. This SRES value is then sent back to the network. The operator network also computes SRES based on \( K_i \) stored in the authentication center. If both SRES values match, the subscriber is successfully authenticated to the network. However, as mandated in the GSM specification, this authentication occurs after the paging response is processed. The same principle applies to UMTS [12]. Therefore, the paging response itself is not authenticated.

By adapting the protocol to include the RAND value in the paging request and SRES in the paging response, all paging responses can be authenticated. This eliminates session hijacking. Additionally, a paging response that includes authentication information can be used by the network to validate the response before changing the state to no longer expect further paging responses, thus mitigating the DoS attack. It is crucial to note that this requires a fresh RAND for every authentication to prevent replay attacks.

This protocol change is similar to the one proposed by Arapinis et al. [16], which encrypts the paging request using a shared session key called the unlinkability key. While they use this key to prevent tracking of subscribers via IMSI paging, the same modification also prevents the attacks described in this paper. Unfortunately, the industry is reluctant to apply new protocol changes to commercially deployed networks, partly due to the difficulty of updating devices in the field.

#### Second Solution: No Protocol Change, Individual Problem Resolution

The second solution does not require a protocol change but addresses each problem individually. To mitigate MT session hijacking, we enforce authentication for each service request. This approach also overcomes mobile-originated (MO) session hijacking. To eliminate the DoS attack, the Mobile Switching Center/Visitor Location Register (MSC/VLR) state machine needs to be modified. Specifically, the MSC/VLR must be able to map all incoming paging responses to the correct service as long as no fully authenticated session exists. This circumvents the DoS attack.

### 6. Related Work

In recent years, various attacks against cellular networks and their protocol stacks have been published. We categorize related work into two parts: attacks that allow an adversary to impersonate a victim and DoS attacks in mobile networks that result in customers being unable to receive MT services.

#### Impersonation

Nohl and Melette [28] demonstrated that it is possible to impersonate a subscriber for mobile-originated services by sniffing a transaction over-the-air, cracking the session key \( K_c \), and knowing the victim's Temporary Mobile Subscriber Identity (TMSI). They were able to place a phone call on behalf of the victim. The authors of [24] used a femtocell device under their control to impersonate a subscriber booked into the femtocell. By relaying authentication challenges to the victim, they were able to send SMS messages on behalf of the subscriber.

Our work differs as we do not attack MO services but focus on MT services. In our research, the victim is, for example, the called party rather than the caller. Unlike attacking MO services, attacking MT services is time-critical.

#### Denial of Service

We consider relevant types of DoS attacks in mobile networks that affect MT services for subscribers. We identified three types of DoS attacks that meet this requirement: attacks directly targeting the victim's phone, attacks focusing on the network, and attacks affecting subscribers without direct communication.

1. **Direct Device Attacks**: These DoS attacks target mobile devices, often caused by implementation flaws. For example, the "Curse-of-Silence" flaw [44] allowed an adversary to disable the MT SMS functionality of specific Nokia devices. Racic et al. [38] demonstrated that it is possible to stealthily exhaust mobile phone batteries by repeatedly sending crafted MMS messages to a victim. Our attack is inherently different because it is independent of the target device type and does not interact with the victim directly.

2. **Network Targeted Attacks**: These attacks target the operator, impacting MT services for subscribers. Spaar [43] showed that it is feasible to exhaust channel resources of a base station by continuously requesting new channels on the Random Access Channel (RACH). Enck et al. [21] demonstrated that it is practical to deny voice or SMS services within a specific geographical area by sending a large number of short messages to subscribers in that area. Serror et al. [42] exhibited similar conditions in CDMA2000 networks, causing significant paging load and delay via Internet-originating packets. Lee et al. [32] demonstrated a comparable resource consumption attack for 3G/WiMax. Traynor et al. [36] outlined how a phone botnet could degrade the performance of large networks by repeatedly adding and deleting call forwarding settings. These attacks exhaust network resources due to generated signaling load, effectively causing DoS conditions. Our attack exploits a race condition in the MT paging procedure and does not generate excessive signaling traffic, making it distinct from these attacks.

3. **Indirect Device Attacks**: These attacks target the mobile device without sending any payload to it. The IMSI detach attack discovered by Munaut [34] can cause a service such as a call to no longer result in paging requests by the network. As described in Section 4.4, this design flaw supports our attack. Contrary to this vulnerability, the paging response attack allows us to precisely control when and where a victim can be reached or not. After sending a detach indication, an attacker cannot control how long this state is maintained.

Our approach can be used to either hijack a session or perform a DoS attack. We target mobile stations without exhausting network resources or directly communicating with the target device. We can target specific geographical areas, specific subscribers, or a group of subscribers without needing a hit list of phone numbers. Depending on the target, the attack can be distributed or performed from a single phone. The costs involved are minimal, equivalent to acquiring the required number of Motorola C1XX phones.

### 7. Conclusion

The trust in the security of cellular networks, particularly the widely used GSM standard, has been repeatedly compromised. Yet, attacks against mobile-terminated services remain a minority. The undisturbed operation of telecommunication networks traditionally relies on the inherent trust that each subscriber and participant plays by the rules. However, with the availability of modifiable software and hardware projects for telecommunications, this trust relationship is broken. In this paper, we demonstrated how to exploit the trust in paging procedures on a broadcast medium. We showed that it is possible to leverage a race condition in the paging protocol to conduct a novel DoS attack and hijack MT services in GSM. This attack can not only disrupt communication for individual subscribers but also significantly affect telephony in larger geographical regions. A motivated attacker can interrupt communication on a large scale using inexpensive consumer devices, which is more efficient than traditional radio jamming due to the broad frequency range of mobile carrier networks and the size of location areas. To mitigate these attacks, we propose two countermeasures, one of which does not require a protocol change. We strongly encourage future standards to consider threats posed by active attackers who tamper with user equipment and protocol stacks.

### 8. Acknowledgement

The authors would like to thank Dieter Spaar, Harald Welte, Holger Freyther, Benjamin Michèle, Alex Dent, and Dmitry Nedospasov for their technical discussions and assistance in reviewing this paper.

### References

[1] Routo Messaging. http://www.routomessaging.com.
[2] Gartner Says Worldwide Smartphone Sales Soared in Fourth Quarter of 2011 With 47 Percent Growth. http://www.gartner.com/it/page.jsp?id=1924314, February 2012.
[3] 3GPP. Digital cellular telecommunications system (Phase 2+); Network architecture (GSM 03.02 version 7.1.0 Release 1998). Tech. rep., 3rd Generation Partnership Project, 2000. 3GPP TS 03.02 V7.1.0.
[4] 3GPP. Digital cellular telecommunications system (Phase 2+); Mobile radio interface layer 3 specification (3GPP TS 04.08 version 7.9.1 Release 1998). Tech. rep., 3rd Generation Partnership Project, 2001. 3GPP TS 04.08 V7.9.1.
[5] 3GPP. Digital cellular telecommunications system (Phase 2+); Multiplexing and multiple access on the radio path (3GPP TS 05.02 version 8.9.0 Release 1999). Tech. rep., 3rd Generation Partnership Project, 2001. 3GPP TS 05.02 V8.9.0.
[6] 3GPP. Digital cellular telecommunications system (Phase 2+); Base Station System - Mobile Services Switching Centre (BSS-MSC) Interface - Interface Principles (3GPP TS 08.02 version 8.0.1 Release 1999). Tech. rep., 3rd Generation Partnership Project, 2002. 3GPP TS 08.02 V8.0.1.
[7] 3GPP. Digital cellular telecommunications system (Phase 2+); Mobile Station - Base Station System (MS - BSS) Interface Channel Structures and Access Capabilities (3GPP TS 04.03 version 8.0.2 Release 1999). Tech. rep., 3rd Generation Partnership Project, 2002. 3GPP TS 04.03 V8.0.2.
[8] 3GPP. Digital cellular telecommunications system (Phase 2+); Numbering, addressing and identification (3GPP TS 03.03 version 7.8.0 Release 1998). Tech. rep., 3rd Generation Partnership Project, 2003. 3GPP TS 03.03 V7.8.0.
[9] 3GPP. Digital cellular telecommunications system (Phase 2+); Security-related network functions (3GPP TS 03.20 version 8.6.0 Release 1999). Tech. rep., 3rd Generation Partnership Project, 2008. 3GPP TS 03.20 V8.6.0.
[10] 3GPP. Digital cellular telecommunications system (Phase 2+); Radio transmission and reception (3GPP TS 45.005 version 9.1.0 Release 9). Tech. rep., 3rd Generation Partnership Project, 2010. 3GPP TS 45.005 V9.1.0.
[11] 3GPP. Universal Mobile Telecommunications System (UMTS); Physical channels and mapping of transport channels onto physical channels (FDD) (3GPP TS 25.211 version 9.2.0 Release 9). Tech. rep., 3rd Generation Partnership Project, 2010. 3GPP TS 25.211 9.2.0.
[12] 3GPP. Universal Mobile Telecommunications System (UMTS); LTE; 3G security; Security architecture (3GPP TS 33.102 version 9.4.0 Release 9). Tech. rep., 3rd Generation Partnership Project, 2011. 3GPP TS 33.102 V9.4.0.
[13] 3GPP. Digital cellular telecommunications system (Phase 2+); Mobile Switching Centre - Base Station system (MSC-BSS) interface; Layer 3 specification (3GPP TS 48.008 version 9.8.0 Release 9). Tech. rep., 3rd Generation Partnership Project, 2012. 3GPP TS 48.008 V9.8.0.
[14] 3GPP. LTE; Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) procedures in idle mode (3GPP TS 36.304 version 9.9.0 Release 9). Tech. rep., 3rd Generation Partnership Project, 2012. 3GPP TS 36.304 V9.9.0.
[15] 3GPP. Universal Mobile Telecommunications System (UMTS); User Equipment (UE) procedures in idle mode and procedures for cell reselection in connected mode (3GPP TS 25.304 version 9.8.0 Release 9). Tech. rep., 3rd Generation Partnership Project, 2012. 3GPP TS 25.304 V9.8.0.
[16] ARAPINIS, M., MANCINI, L., RITTER, E., RYAN, M., GOLDE, N., REDON, K., AND BORGAONKAR, R. New Privacy Issues in Mobile Telephony: Fix and Verification. In Proceedings of the 19th ACM Conference on Computer and Communications Security (October 2012).
[17] BARKAN, E., BIHAM, E., AND KELLER, N. Instant Ciphertext-Only Cryptanalysis of GSM Encrypted Communication. J. Cryptol. 21, 3 (Mar. 2008), 392–429.
[18] BIRYUKOV, A., SHAMIR, A., AND WAGNER, D. Real Time Cryptanalysis of A5/1 on a PC. In Proceedings of the 7th International Workshop on Fast Software Encryption (London, UK, UK, 2001), FSE ’00, Springer-Verlag, pp. 1–18.
[19] BOSWARTHICK, D., ELLOUMI, O., AND HERSENT, O. M2M Communications: A Systems Approach. Wiley, March 2012.
[20] D. BURGESS ET AL. OpenBTS. http://openbts.org.
[21] ENCK, W., TRAYNOR, P., MCDANIEL, P., AND LA PORTA, T. Exploiting open functionality in SMS-capable cellular networks. In Proceedings of the 12th ACM conference on Computer and communications security (New York, NY, USA, 2005), CCS ’05, ACM, pp. 393–404.
[22] ETTUS. USRP. http://www.ettus.com/products, 2009.
[23] FRANK A. STEVENSON. [A51] The call of Kraken. http://web.archive.org/web/20100812204319/http://lists.reflextor.com/pipermail/a51/2010-July/000683.html, July 2010.
[24] GOLDE, N., REDON, K., AND BORGAONKAR, R. Weaponizing Femtocells: The Effect of Rogue Devices on Mobile Telecommunications. In Proceedings of the 19th Annual Network & Distributed System Security Symposium (Feb. 2012).
[25] H. WELTE. OpenBSC. http://openbsc.osmocom.org.
[26] INFOSECURITY MAGAZINE. Indian company hacks GSM and usurps IMSI. http://www.infosecurity-magazine.com/view/24680/indian-company-hacks-gsm-and-usurps-imsi/, March 2012.
[27] IP.ACCESS LTD. nanoBTS 1800. http://www.ipaccess.com/picocells/nanoBTS_picocells.php.
[28] KARSTEN NOHL AND LUCA MELETTE. Defending mobile phones. http://events.ccc.de/congress/2011/Fahrplan/events/4736.en.html, December 2011.
[29] KRELL, M. Crowdflow. http://crowdflow.net.
[30] KUNE, D. F., KOELNDORFER, J., HOPPER, N., AND KIM, Y. Location leaks over the GSM air interface. In Proceedings of the 19th Annual Network & Distributed System Security Symposium (Feb. 2012).
[31] LANDSPURG, T. OpenCellID. http://opencellid.org.
[32] LEE, P. P. C., BU, T., AND WOO, T. On the detection of signaling DoS attacks on 3G/WiMax wireless networks. Comput. Netw. 53, 15 (2009), 2601–2616.
[33] MULLINER, C., GOLDE, N., AND SEIFERT, J.-P. SMS of Death: From Analyzing to Attacking Mobile Phones on a Large Scale. In Proceedings of the 20th USENIX Security Symposium (San Francisco, CA, USA, August 2011).
[34] MUNAUT, S. IMSI DETACH DoS. http://security.osmocom.org/trac/ticket/2, May 2010.
[35] NOKIA SIEMENTS NETWORKS. Nokia Siemens Networks promotes GSM for Machine to Machine applications. http://www.nokiasiemensnetworks.com/news-events/press-room/press-releases/nokia-siemens-networks-promotes-gsm-for-machine-to-machine-applications.
[36] P. TRAYNOR, M. LIN, M. ONGTANG, V. RAO, T. JAEGER, T. LA PORTA, P. MCDANIEL. On Cellular Botnets: Measuring the Impact of Malicious Devices on a Cellular Network Core. In ACM Conference on Computer and Communications Security (CCS) (November 2009).
[37] PURPLELABS. Tsm30 firmware. http://web.archive.org/web/20090325133430/http://sourceforge.net/projects/plabs, November 2004.
[38] RACIC, R., MA, D., AND CHEN, H. Exploiting MMS Vulnerabilities to Stealthily Exhaust Mobile Phone’s Battery. In Securecomm and Workshops, 2006 (28 2006-sept. 1 2006), pp. 1 –10.
[39] SECURITY RESEARCH LABS. A5/1 decryption project. http://opensource.srlabs.de/projects/a51-decrypt.
[40] SECURITY RESEARCH LABS. Decrypting GSM phone calls. https://srlabs.de/decrypting_gsm/.
[41] SECURITY RESEARCH LABS. GSM security map. http://www.gsmmap.org.
[42] SERROR, J., ZANG, H., AND BOLOT, J. C. Impact of paging channel overloads or attacks on a cellular network. In Proceedings of the 5th ACM workshop on Wireless security (New York, NY, USA, 2006), WiSe ’06, ACM, pp. 75–84.
[43] SPAAR, D. RACH flood DoS. http://security.osmocom.org/trac/ticket/1, November 2009.
[44] T. ENGEL. Remote SMS/MMS Denial of Service - Curse Of Silence. http://berlin.ccc.de/~tobias/cursesms.txt, December 2008.
[45] VARIOUS CONTRIBUTORS. Osmocom project. http://osmocom.org.
[46] WEINMANN, R.-P. Baseband Attacks: Remote Exploitation of Memory Corruptions in Cellular Protocol Stacks. In Proceedings of the 21st USENIX Workshop on Offensive Technologies (Bellevue, WA, USA, August 2012).
[47] WELTE, H., MUNAUT, S., EVERSBERG, A., AND OTHER CONTRIBUTORS. OsmocomBB. http://bb.osmocom.org.