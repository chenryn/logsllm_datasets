### Table 6: Coverage of DGA-based Domains

**Malware Families:**
- Conﬁcker
- Flashback
- Virut
- ZeuS P2P

**Table 6 illustrates the listing behavior we monitored from January 2012 to March 2014 for public blacklists (first major column) and on a typical weekday in March 2014 for AV vendor blacklists (second major column).**

In total, less than 1.2% of all domains were listed by the public blacklists. On the positive side, these blacklists have a low reaction time for three families (if they blacklist a domain). However, 82.1% of the matches are found in the Virustracker blacklist only. When Virustracker is removed from the analysis, the reaction times increase significantly for most families:
- Bamital: 12 days
- Conﬁcker: 12 days
- Flashback: 381 days
- Virut: -271 days
- ZeuS P2P: 16 days

Before removing Virustracker, 0.2% of the Virut domains were blacklisted. After removal, only 167 domains (0.002%) were listed. The generic structure of Virut domains suggests that these listings may not be specific to Virut but rather related to other malicious activities. The negative reaction time (-271 days) indicates that these domains were blacklisted 271 days before they became active, which is not a reasonable strategy.

### Coverage of AV Vendor Blacklists

To evaluate the coverage of AV vendor blacklists regarding DGA-based domains, we divided our analysis into two steps:
1. **Current Threats:** We requested listing information and DNS A records for all domains valid on March 24, 2014.
2. **Future Threats:** We requested a sample of DGA-based domain names (up to 10 per day and malware family) that would be valid between March 25, 2014, and April 24, 2014.

**Current Threats:**
- For the domains valid on March 24, 2014, we found:
  - 76.1% of the ZeuS P2P domains listed by McAfee.
  - 28.9% of the ZeuS P2P domains listed by Bitdefender.
  - Norton provided the best coverage, listing 95.5% of the ZeuS P2P domains.
  - The union of all AV vendor blacklists increased the coverage up to 99.5%.

For the remaining blacklists and malware families, the number of listed domains was negligible. Additionally, half of the Bamital domains and most of the Conﬁcker B/C and Flashback domains were sinkholed. Four ZeuS P2P domains were also sinkholed, while the 168 registered Virut domains were associated with parking providers and benign web pages.

**Future Threats:**
- For the domains becoming active in the near future, Norton again performed best, listing at least 94.5% of the domains for each of the remaining families, except for Flashback (no listed domains) and Bamital (coverage of 46.5%).

Our analysis shows that as of today, only one blacklist (Norton) can reasonably protect against any of the five DGAs used in our experiments. This is surprising given that, once the DGA is known, the DGA-based domains can be accurately predicted unless there are external dependencies. One reason could be that DGAs are often used as a C&C backup mechanism only, such as in Zeus P2P, which uses a DGA only if its peer-to-peer communication fails. Another reason could be that DGA-based domains may, by coincidence, collide with benign domains. Despite these issues, the potential of including DGA-based domains remains largely unused in most current blacklists.

### Discussion and Future Work

We demonstrated that our parking detection approach effectively distinguishes parked and benign domains. However, our features depend on the content delivered by parking services. If parking providers block us, e.g., for sending too many requests, or if domains perform cloaking, our detection model may not be effective. We leave the detection of cloaking domains for future work.

The proposed sinkhole detection method relies on blacklists to observe behavior that can be attributed to sinkholes. Our detection capabilities are limited to sinkholes that are blacklisted. We could use the identified sinkhole dataset as ground truth and leverage techniques such as passive DNS analysis to identify further potential sinkholes. The quality of our approach depends on the accuracy of the blacklists. If blacklists contain too many benign domains, we might flag benign IP addresses as potential sinkholes.

Our evaluation of the completeness of blacklists is limited to estimating lower bounds, as Sandnet only covers a random subset of all samples of the active malware families. We aim to scale up malware execution to achieve higher coverage.

We classified the blacklist content as parked, sinkholed, or unregistered and analyzed the completeness of the blacklists in regards to various malware families. However, 23.7% of the currently blacklisted domains remain unspecified. These domains might include potential false listings, which are hard to identify due to the varying listing strategies of different blacklists. We leave the categorization of these unclassified domains for future work.

### Related Work

The effectiveness of malware blacklists is still largely unstudied. In prior work, we proposed a system to track blacklists and presented initial details regarding their sizes. This paper extends our work by evaluating the effectiveness of malware blacklists. Other researchers have evaluated blacklists in different contexts, such as Twitter, email spam, and phishing. Concurrently, Rahbarinia et al. developed SinkMiner to identify sinkhole IPs using pDNS data. Our approach does not rely on an initially-known set of sinkholes and works without pDNS. We also proposed a more advanced mechanism to identify parking providers, which differs from the methods used by other researchers.

### Conclusion

Blacklists must be employed with care, as the nature of the listings is diverse. First, sinkholes may be blacklisted, and second, many parking providers reuse popular malware domains. Our evaluation of blacklist coverage indicates that none of the public blacklists are sufficiently complete to protect against the variety of malware threats we face today. Most blacklists operated by AV vendors do not cover DGA-based malware effectively, although integration would be straightforward. We are confident that our analyses will help improve blacklists in the future.

### Acknowledgment

We would like to thank our shepherd Manos Antonakakis for his support in finalizing this paper. We also thank the anonymous reviewers for their insightful comments. This work was supported by the German Federal Ministry of Education and Research (Grant 01BY1110, MoBE).

### References

[References are listed as in the original text.]

---

This version of the text is more structured, clear, and professional, with improved readability and coherence.