### Water SCADA Systems and Cyber-Physical Attacks

In the context of water SCADA systems, Amin et al. [4] described an attack that drives the underlying physical plant towards unsafe states by solving the partial differential equations that model the dynamics of the water plant. However, the authors did not provide detailed insights into the practical implementation of such attacks or the associated challenges. Similarly, system-theoretic models [39] [5] have been proposed to identify stealthy cyber-physical attacks against the power grid, either through compromised measurements or dynamic load-altering attacks. These models assume that the attacker has already compromised the necessary assets. Such models could be leveraged by HARVEY to simulate spoofed measurements sent to the Human-Machine Interface (HMI).

### Discussions and Mitigations

#### Generality of HARVEY and Potential Mitigation Mechanisms

We discuss the generality of HARVEY and outline potential mitigation strategies to protect critical infrastructures from similar attacks.

##### Unique Challenges in ICS

This section elaborates on the unique challenges in the Industrial Control System (ICS) domain by comparing our PLC rootkit with those known from workstations and servers. We also explore the relationship between industrial control systems and the Internet of Things (IoT).

**Rootkits:**
The concept of rootkits, which involves compromising the privileged software of a computing system to hide malicious activities, has been known for decades [29]. Most known rootkits target commodity operating systems like Windows or Linux, which have extensive resources that can be misused by the rootkit to conceal itself and perform malicious actions. In contrast, Programmable Logic Controllers (PLCs) have a significantly different software design (cf. Section II-A), necessitating new techniques for rootkits in the ICS domain.

HARVEY specifically aims to manipulate the input and output of a PLC, i.e., its interaction with the physical world. Traditional rootkits operate only within the deterministic cyber world, making hiding and other actions simpler. For example, a common hiding method for Windows rootkits is to remove themselves from a list structure maintained by the OS [46]. HARVEY, however, must account for changes in the physical world, which will eventually feed back as input readings.

**Internet of Things (IoT):**
The term IoT is often overused, despite the lack of a widely accepted and precise definition. While some definitions include ICS (e.g., every computing device with a network connection), we argue that ICS are not part of the IoT. Many IoT devices are based on commodity hardware and software (e.g., ARM Cortex-A processors and Linux-based OS), making them similar to systems like smartphones. Therefore, attacks on IoT devices, such as the compromise of the Google Nest thermostat [30], are not applicable to ICS. Another significant difference is the real-time operation of PLCs, reflected in the control loop design of the PLC's firmware. IoT devices rarely have strict real-time requirements. Additional differences include software deployment schemes (IoT device software is controlled by the manufacturer, while PLC control logic is installed by the programmer/operator) and device lifetime (ICS may be operated for decades). Lastly, the operation of IoT devices (and their effects on the environment) is often unsupervised, so an IoT rootkit does not need to provide a manipulated system state view to an operator.

##### Generality of HARVEY

HARVEY involved reverse engineering a real-world commercial PLC device and binary software modules. Although we focused on a specific model, the techniques used, such as JTAG debugging and binary analysis, can be generalized to PLCs and controllers from other vendors. This is because they generally follow similar technical approaches, such as a scan-cycle-based execution paradigm followed by periodic I/O interrupts and memory updates. Additionally, the proposed two-way data manipulation attack can be implemented in other control system settings where controller devices monitor and control underlying physical plants.

##### Mitigation Solutions

HARVEY can be protected against using three major mitigation solutions:
1. **Remote Attestation:** This allows a verifier to check the software integrity of a system. A trusted component provides an authenticated measurement of the device's memory. Various approaches, specifically for embedded systems, have been developed and could be applied to PLCs [11], [18], [45].
2. **Secure Boot:** This ensures the integrity of a device’s configuration is verified by the device itself, possibly using a Trusted Platform Module (TPM) [6]. Secure boot ensures that only known and trustworthy software can be loaded on a device, thus ensuring the integrity of PLC firmware.
3. **External Bump-in-the-Wire Device:** An external device placed between the PLC controller and the physical plant can monitor the two-way sensor-to-PLC and PLC-to-actuator data streams. Unlike TSV [34], which sits between the HMI and PLC, this solution can check whether the control commands issued by the PLC satisfy the plant’s essential safety requirements defined by the operators. It can also implement coarse-grained control consistency checks to validate whether sensor measurements and actuation commands are consistent with how the plant should be controlled.

### Conclusions

We presented HARVEY, a PLC rootkit that implements a physics-aware man-in-the-middle attack against cyber-physical control systems. HARVEY damages the underlying physical system while providing operators with the expected view of the system following their issued control commands. Our experimental results with a commercial PLC controller on a real-world power system testbed demonstrate the feasibility of HARVEY in practice.

### References

[1] IEEE Standard Test Access Port and Boundary Scan Architecture, IEEE Std. 1149.1-2001, 2001.

[2] Federal Energy Regulatory Commission (FERC): Optimal Power Flow and Formulation Papers, 2010.

[3] A. Abbasi and M. Hashemi, "Ghost in the PLC: Designing an Undetectable Programmable Logic Controller Rootkit via Pin Control Attack," 2016.

[4] S. Amin, X. Litrico, S. S. Sastry, and A. M. Bayen, "Stealthy Deception Attacks on Water SCADA Systems," in Proceedings of the 13th ACM International Conference on Hybrid Systems: Computation and Control, ser. HSCC, 2010.

[5] S. Amini, H. Mohsenian-Rad, and F. Pasqualetti, "Dynamic Load Altering Attacks in Smart Grid," in Innovative Smart Grid Technologies Conference (ISGT), 2015 IEEE Power & Energy Society, 2015.

[6] W. Arbaugh, D. Farber, and J. Smith, "A Secure and Reliable Bootstrap Architecture," in IEEE Symposium on Security and Privacy, 1997.

[7] Z. Basnight, J. Butts, J. Lopez, and T. Dube, "Firmware Modification Attacks on Programmable Logic Controllers," International Journal of Critical Infrastructure Protection, 2013.

[8] D. Beresford, "Exploiting Siemens Simatic S7 PLCs," in Black Hat USA 2011, ser. Black Hat USA '11.

[9] W. Bolton, Programmable Logic Controllers. Newnes, 2015.

[10] S. Bose, S. H. Low, T. Teeraratkul, and B. Hassibi, "Equivalent Relaxations of Optimal Power Flow," Automatic Control, IEEE Transactions on, 2015.

[11] F. Brasser, B. El Mahjoub, A.-R. Sadeghi, C. Wachsmann, and P. Koeberl, "TyTAN: Tiny Trust Anchor for Tiny Devices," in Proceedings of the 52nd Annual Design Automation Conference, ser. DAC, 2015.

[12] M. Brüggemann and R. Spenneberg, "PLC-Blaster der Virus im Industrienetz," 2015.

[13] S. Cheung, B. Dutertre, M. Fong, U. Lindqvist, K. Skinner, and A. Valdes, "Using Model-Based Intrusion Detection for SCADA Networks," in Proceedings of the SCADA Security Scientific Symposium, Miami Beach, Florida, Jan 2007.

[14] E. Chien, L. OMurchu, and N. Falliere, "W32.Duqu - The Precursor to the Next Stuxnet," Symantec Security Response, Tech. Rep., 2011.

[15] R. Christie, "Power Systems Test Case Archive," Electrical Engineering Dept., University of Washington, 2000.

[16] D. Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley, and W. Polk, "Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile," 2008.

[17] K. R. Davis, C. M. Davis, S. Zonouz, R. B. Bobba, R. Berthier, L. Garcia, P. W. Sauer et al., "A Cyber-Physical Modeling and Assessment Framework for Power Grid Infrastructures," 2015.

[18] K. E. Defrawy, A. Francillon, D. Perito, and G. Tsudik, "SMART: Secure and Minimal Architecture for (Establishing Dynamic) Root of Trust," in NDSS, 2012.

[19] H. Dommel and W. Tinney, "Optimal Power Flow Solutions," IEEE Transactions on Power Apparatus and Systems, 1968.

[20] K. T. Erickson, "Programmable Logic Controllers." Institute of Electrical and Electronics Engineers, 1996.

[21] S. Etigowni, D. Tian, G. Hernandez, K. Butler, and S. Zonouz, "CPAC: Mitigating Attacks Against Critical Infrastructure with Cyber-Physical Access Control," in Annual Computer Security Applications Conference (ACSAC), 2016.

[22] European Network and Information Security Agency (ENISA). (2011) Protecting Industrial Control Systems – Recommendations for Europe and Member States. https://www.enisa.europa.eu/.

[23] F-Secure Labs, "BLACKENERGY and QUEDAGH: The Convergence of Crimeware and APT Attacks," 2016.

[24] N. Falliere, L. O. Murchu, and E. Chien, "W32.Stuxnet Dossier," Symantec Security Response, Tech. Rep., 2010.

[25] J. FitzPatrick and M. King, "NSA Playset: JTAG Implants," 2015.

[26] D. Formby, P. Srinivasan, A. Leonard, J. Rogers, and R. Beyah, "Who's in Control of Your Control System? Device Fingerprinting for Cyber-Physical Systems," in Proceedings of the Network and Distributed System Security (NDSS) Symposium, 2016.

[27] A. Francillon and C. Castelluccia, "Code Injection Attacks on Harvard-Architecture Devices," in Proceedings of the 15th ACM Conference on Computer and Communications Security, ser. CCS '08, 2008.

[28] A. Gómez-Expósito, A. J. Conejo, and C. Cañizares, Electric Energy Systems: Analysis and Operation. CRC Press, 2016.

[29] A. Hay, D. Cid, and R. Bray, OSSEC Host-Based Intrusion Detection Guide. Syngress, 2008.

[30] G. Hernandez, O. Arias, D. Buentello, and Y. Jin, "Smart Nest Thermostat: A Smart Spy in Your Home," in BlackHat USA, 2014.

[31] A. Kleinman and A. Wool, "Accurate Modeling of the Siemens S7 SCADA Protocol for Intrusion Detection and Digital Forensics," The Journal of Digital Forensics, Security and Law: JDFSL, 2014.

[32] J. Klick, S. Lau, D. Marzin, J.-O. Malchow, and V. Roth, "Internet-Facing PLCs - A New Back Orifice," in Black Hat USA, 2015.

[33] Y. Liu, P. Ning, and M. K. Reiter, "False Data Injection Attacks Against State Estimation in Electric Power Grids," ACM Transactions on Information and System Security (TISSEC), 2011.

[34] S. E. McLaughlin, S. A. Zonouz, D. J. Pohly, and P. D. McDaniel, "A Trusted Safety Verifier for Process Controller Code," in Proceedings of the Network and Distributed System Security (NDSS) Symposium, 2014.

[35] S. McLaughlin and S. Zonouz, "Controller-Aware False Data Injection Against Programmable Logic Controllers," in IEEE SmartGridComm, 2014.

[36] J. Mulder, M. Schwartz, M. Berg, J. R. Van Houten, J. Mario, M. A. K. Urrea, A. A. Clements, and J. Jacob, "Weaselboard: Zero-Day Exploit Detection for Programmable Logic Controllers," tech. report SAND2013-8274, Sandia Nat'l Laboratories, Tech. Rep., 2013.

[37] N. I. of Standards and Technology, "FIPS 180-4, Secure Hash Standard, Federal Information Processing Standard (FIPS)," 2012.

[38] OPC Foundation. (2015) Open Platform Communication Foundation. https://opcfoundation.org/.

[39] F. Pasqualetti, F. Dörfler, and F. Bullo, "Cyber-Physical Attacks in Power Networks: Models, Fundamental Limitations and Monitor Design," in IEEE CDC and ECC, 2011.

[40] J. Reeves, "Autoscopy JR.: Intrusion Detection for Embedded Control Systems Dartmouth Computer Science Technical Report TR2011-704 A Thesis," Ph.D. dissertation, DARTMOUTH COLLEGE Hanover, New Hampshire, 2011.

[41] R. L. Rivest, A. Shamir, and L. Adleman, "A Method for Obtaining Digital Signatures and Public-Key Cryptosystems," Commun. ACM, 1983.

[42] Rockwell Automation. Download Center. http://compatibility.rockwellautomation.com/Pages/MultiProductDownload.aspx?famID=4&Keyword=Controller&crumb=112.

[43] J. Rrushi, H. Farhangi, C. Howey, K. Carmichael, and J. Dabell, "A Quantitative Evaluation of the Target Selection of Havex ICS Malware Plugin."

[44] C. D. Schuett, "Programmable Logic Controller Modification Attacks for Use in Detection Analysis," DTIC Document, Tech. Rep., 2014.

[45] R. Strackx, F. Piessens, and B. Preneel, "Efficient Isolation of Trusted Subsystems in Embedded Systems," in Security and Privacy in Communication Networks, ser. Lecture Notes of the Institute for Computer Sciences, Social Informatics and Telecommunications Engineering. Springer, 2010, vol. 50.

[46] Symantec, "Windows Rootkit Overview," Symantec Security Response, Tech. Rep., 2005.

[47] TechNavio. (2014) Global Security Market Industrial Control Systems (ICS) 2014-2018. http://www.technavio.com/report/global-industrial-control-systems-ics-security-market%C2%A02014-2018.

[48] Texas Instruments. (2011-2013) Stellaris LM4F120H5QR ROM User's Guide. www.ti.com/lit/ug/spmu245a/spmu245a.

[49] Texas Instruments. (2007-2014) Stellaris LM3S2793 Microcontroller Data Sheet. www.ti.com/lit/gpn/lm3s2793.

[50] L. Xie, Y. Mo, and B. Sinopoli, "False Data Injection Attacks in Electricity Markets," in Smart Grid Communications (SmartGridComm), 2010 First IEEE International Conference on. IEEE, 2010.

[51] D. Yang, A. Usynin, and J. W. Hines, "Anomaly-Based Intrusion Detection for SCADA Systems," 2006.

[52] B. Zhu and S. Sastry, "SCADA-Specific Intrusion Detection/Prevention Systems: A Survey and Taxonomy," in Proceedings of the First Workshop on Secure Control Systems, 2010.

[53] S. Zonouz, C. M. Davis, K. R. Davis, R. Berthier, R. B. Bobba, and W. H. Sanders, "SOCCA: A Security-Oriented Cyber-Physical Contingency Analysis in Power Infrastructures," Smart Grid, IEEE Transactions on, 2014.

[54] S. Zonouz, K. M. Rogers, R. Berthier, R. B. Bobba, W. H. Sanders, and T. J. Overbye, "SCPSE: Security-Oriented Cyber-Physical State Estimation for Power Grid Critical Infrastructures," IEEE Transactions on Smart Grid, 2012.

[55] S. Zonouz, J. Rrushi, and S. McLaughlin, "Detecting Industrial Control Malware Using Automated PLC Code Analytics," Security & Privacy, IEEE, 2014.