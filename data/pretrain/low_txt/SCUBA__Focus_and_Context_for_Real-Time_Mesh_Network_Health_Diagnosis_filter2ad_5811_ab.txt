### Routers and Internet Gateways
SCUBA visualizes routers as blue circles and gateways as more prominent red triangles, as shown in Figures 2 and 3.

### Routes
WMN routers relay client packets destined for the Internet via other routers towards a gateway. The gateways, in turn, relay packets destined for WMN clients back to the associated router. SCUBA visualizes these routes as curved solid lines, as illustrated in Figure 2(a). To highlight potential issues, the thickness of the lines is directly proportional to the Round-Trip Time (RTT) value; higher RTT values result in thicker lines. Additionally, the saturation and brightness of the lines are inversely proportional to the throughput on an exponential scale using the HSB color scheme. Low throughput routes appear bright red, while higher throughput routes are de-emphasized with a grey color. We also experimented with a more conventional mapping of throughput to line thickness, which might be preferable for non-troubleshooting monitoring applications. However, the presented scheme is advantageous when high salience of trouble spots is important.

### Links
MAC-layer links between nodes are visualized in the link context. These links are represented as dashed lines, as shown in Figure 2(a). To maintain our policy of highlighting problems, the length of the white spaces between dashes is directly proportional to the Expected Transmission Count (ETX) value. Higher ETX values result in longer white spaces, making the links appear more broken. To compensate for the reduction in saliency due to increasing gap sizes, the thickness of the dashed lines is increased proportionally to the ETX value. This visualization ensures that operators' attention is drawn to poor-quality broken links, while good-quality links are represented as thin solid lines.

### Clients
The client context in SCUBA displays clients and four related metrics, as illustrated in Figure 2(b). In this figure, clients are placed around the router they are associated with and are visualized as sectors of a circle. The subtended angle of each client's sector is proportional to the client's percentage channel utilization share. A router with client sectors forming a complete circle indicates 100% channel utilization by client frame transmissions. The radius of each client sector is inversely proportional to the Received Signal Strength Indicator (RSSI) value of the client’s frames received by the router. Lower RSSI values result in a larger radius, placing the client farther from the router. Based on these two visualization features, a client with a large sector angle and large radius is quickly identified as a potential problem due to high channel utilization and low RSSI. The client with the largest sector area is highlighted in a bright green color, making it easy for a WMN operator to locate all problem clients. The fourth metric, external interference, is visualized as a grey cloud around routers, as shown in Figure 2(c). The radius of the cloud is directly proportional to the volume of external interference. When the interference clouds of two or more routers overlap, SCUBA darkens the color in the region of overlap, indicating more interference.

### SCUBA Views
In this section, we discuss two views of SCUBA: planar and hyperbolic. These views facilitate focus and context interaction, allowing operators to diagnose problems in large-scale WMNs more effectively. Using either view, operators can focus on specific locations while retaining an overview of the entire network, and they can zoom into a context of their choice for further investigation.

#### Planar View
SCUBA's planar view, shown in Figure 3, renders the WMN and its contexts on a flat two-dimensional plane. Figure 3(a) shows the planar view with only the route context displayed for the entire Google WMN. Figure 3(b) shows the link context of a small subset of the network, allowing the operator to zoom in and investigate performance problems. An inset overview in the top-right corner indicates the focal region in the overall view. Further zooming reveals the client context, as illustrated in Figure 3(c). The advantage of the planar view is that it maintains the geographical location and orientation of all routers and gateways, even as the operator changes focus and context. However, the trade-off is that while operators are zoomed in on lower metric contexts, they can only see a small inset overview of the whole network, which may not be sufficient to alert them to new unusual activity.

#### Hyperbolic View
SCUBA uses the hyperbolic view to render routers, gateways, clients, and their corresponding metrics on a hyperbolic surface. The basic idea is to plot the focal point F of a two-dimensional plane at the center of the screen and plot the remaining points on a hyperbolic surface centered at the focal point. Figure 4(a) illustrates the side and front views of a hyperbolic surface transformed from a simple two-dimensional planar surface. The non-focal location point P on a two-dimensional plane is distorted to P' when transformed to the hyperbolic surface, with the distortion depending on the height h of the hyperbola.

The hyperbolic view has the advantage of automatically rendering different contexts based on the position of the node relative to the focal point. As shown in Figure 4(b), the node of interest forms the focal point of the hyperbolic surface, and the remaining nodes are rendered on the hyperbolic surface, maintaining the same orientation to the focal node as in the planar view. SCUBA plots all the metric contexts for the focal node and progressively reduces the contexts for nodes further away from the focal node. Only the route context is displayed for nodes at the edge of the hyperbolic surface. Figure 4(c) shows that a parameter controls the depth of the hyperbolic surface, determining how quickly context displays are reduced between the focus node and the surface edge.

The main advantage of the hyperbolic view is that it provides a complete view of the WMN at all times and automatically changes contexts as the operator interactively changes focus by mouse-dragging. This automation requires the user to only choose their focus point, and SCUBA smoothly transitions to display the new focal region and the corresponding contexts. However, the trade-off is that the hyperbolic view distorts the geographic locations of the nodes from that of a planar view. To address these trade-offs, SCUBA includes an inset overview similar to the one used in the planar view and allows operators to quickly toggle between the planar and hyperbolic views.

### Implementation on the UCSB MeshNet
To test SCUBA's effectiveness in diagnosing practical WMN problems, we used it to study the performance of the UCSB MeshNet, an indoor WMN consisting of 14 multi-radio 802.11 a/g routers and one gateway. The routers collect, compute, and send metrics to a central SCUBA server via the gateway over the routes.

In the route context shown in Figure 5(a), the operator observes unusually low throughput and high RTT values of a route indicated by thick red lines. The operator then zooms into the region of the route to access the link context. The link context in Figure 5(b) clearly shows that the links utilized by the problematic route have a high ETX value, indicated by sparsely dashed straight lines. To determine the cause, the operator zooms into the client context close to the edge router using the problematic route, as shown in Figure 5(c). In this figure, the large sector of the circle representing a client with 97.49% channel utilization is clearly anomalous. The operator can thus conclude that a single misconfigured or misbehaving client is overloading the channel with excess traffic, adversely impacting the performance of the entire route.

The current version of SCUBA allows operators to diagnose several other performance problems, such as flash crowds of users overloading the network or suboptimal route topologies caused by poor links or interference. The set of diagnosable problems will increase with the number and type of metrics collected. Adding a time dimension will allow SCUBA to diagnose more temporal problems, such as rapid route flaps and client mobility.

### Conclusions
In this paper, we propose a focus and context visualization framework called SCUBA for fast and efficient WMN health diagnosis. SCUBA places WMN performance metrics into contexts and presents them in two views: planar and hyperbolic. We believe that visualization frameworks like SCUBA will form the most structured and efficient means of WMN health diagnosis.

SCUBA opens several new directions of research. The most prominent one is to qualitatively and quantitatively determine the best set of metrics and contexts that facilitate comprehensive diagnosis. Qualitative usability studies of SCUBA's visualization methods and the study of various diagnostic approaches preferred by WMN operators will be very helpful. Another research direction is to reduce the metrics' computation and collection overhead to achieve real-time visualization capabilities. A possible future extension is to make SCUBA use a set of diagnostic rules to automatically identify problem regions and adjust focus and context accordingly. Such automation will immediately direct an operator's attention to the problem and likely reduce diagnosis time.

SCUBA is the first step towards interactive visualizations for fast and efficient WMN health diagnosis. As WMNs are rapidly deployed worldwide and increase in complexity, the need for such visualizations will grow. Faster and more efficient health diagnosis will help operators maintain their WMN's performance and achieve the desirable economic success of the metro-scale mesh technology.

### Acknowledgments
This work was funded in part by NSF Wireless Networks (WN) award CNS-0722075.

### References
1. Tropos Report on Google WiFi Network, www.muniwireless.com/article/articleview/5403
2. Card, S.K., Mackinlay, J.D., Shneiderman, B.: Readings in Information Visualization: Using Vision to Think. Morgan Kaufmann Publishers Inc, San Francisco, CA
3. De Couto, D., Aguayo, D., Bicket, J., Morris, R.: A High-throughput Path Metric for Multi-hop Wireless Routing. Wireless Networks 11(4), 419–434 (2005)
4. Jardosh, A.P., Ramchandran, K.N., Almeroth, K.C., Belding, E.M.: Understanding Congestion in IEEE 802.11b Wireless Networks. In: Proceedings of USENIX IMC, Berkeley, CA (October 2005)
5. Lundgren, H., Ramachandran, K.N., Belding-Royer, E.M., Almeroth, K.C., Benny, M., Hewatt, A., Touma, A., Jardosh, A.P.: Experiences from the Design, Deployment, and Usage of the UCSB MeshNet Testbed. IEEE Wireless Communications Magazine 13, 18–29 (2006)
6. Marti, S., Giuli, T., Lai, K., Baker, M.: Mitigating Routing Misbehavior in Mobile Ad hoc Networks. In: Proceedings of MOBICOM, Boston, MA, pp. 255–265 (2000)
7. Munzner, T.: Interactive Visualization of Large Graphs and Networks. PhD thesis, Stanford University (June 2000)
8. Paxson, V.: Strategies for Sound Internet Measurement. In: Proceedings of IMC, October 2004, pp. 263–271. Taormina, Sicily (2004)
9. Qiu, L., Bahl, P., Rao, A., Zhou, L.: Troubleshooting Wireless Mesh Networks. ACM SIGCOMM Computer Communication Review 36(5), 17–28 (2006)
10. Sommers, J., Barford, P., Willinger, W.: SPLAT: A Visualization Tool for Mining Internet Measurements. In: Proceedings of PAM, Adelaide, Australia (March 2006)
11. Tukey, J.: Exploratory Data Analysis. Addison-Wesley, Menlo Park, CA (1977)