### Performance and Security Benefits of QPEP

In our evaluation under various network conditions, we found that QPEP can offer up to a 50% performance improvement over existing tools while also providing significant security benefits. We present the case that future work might further enhance these gains and provide demonstrative case studies of two underlying QUIC protocol implementation characteristics as a starting point.

QPEP is the first open-source Performance Enhancing Proxy (PEP) with support for the encryption of arbitrary TCP traffic. Unlike many commercial offerings, QPEP is fully independent, allowing for greater flexibility and control.

### References

1. **A. Adelsbach and U. Greveler, "Satellite Communication Without Privacy–Attacker’s Paradise,"** *Sicherheit 2005, Sicherheit–Schutz und Zuverlässigkeit*, 2005, ISSN: 3885793911.
   
2. **J. Pavur, D. Moser, V. Lenders, and I. Martinovic, "Secrets in the Sky: On Privacy and Infrastructure Security in DVB-S Satellite Broadband,"** in *Proceedings of the 12th Conference on Security and Privacy in Wireless and Mobile Networks (WiSec '19)*, New York, NY, USA: ACM, 2019, pp. 277–284, ISBN: 978-1-4503-6726-4, DOI: 10.1145/3317549.3323418.

3. **J. Pavur, D. Moser, M. Strohmeier, V. Lenders, and I. Martinovic, "A Tale of Sea and Sky: On the Security of Maritime VSAT Communications,"** in *To Appear in 2020 IEEE Symposium on Security and Privacy (S&P)*, Oakland, CA: IEEE, May 2020.

4. **J. Pavur, "Whispers Among the Stars: A Practical Look at Perpetrating (and Preventing) Satellite Eavesdropping Attacks,"** *Black Hat USA 2020*, August 2020, [Link](https://www.blackhat.com/us-20/briefings/schedule/index.html#whispers-among-the-stars-a-practical-look-at-perpetrating-and-preventing-satellite-eavesdropping-attacks-19391).

5. **Hughes, "What Should I Do if I have Slow or No Connectivity?"** [Link](https://support.hughesnet.com/en/faq/internet/slow-no-connectivity), 2020.

6. **Viasat, "Answers to Your Questions Relating to Your Viasat Internet Service During This Difficult Time,"** [Link](https://help.viasat.com/internet/articles/Denver FAQ/Answers-to-your-Questions-relating-to-your-Viasat-Internet-service-during-this-difficult-time), 2020.

7. **A. Laurie, "$Atellite Hacking for Fun & Pr0fit!"** [Link](http://www.blackhat.com/presentations/bh-dc-09/Laurie/BlackHat-DC-09-Laurie-Satellite-Hacking.pdf), 2009.

8. **C. Moore, "Spread Spectrum Satcom Hacking: Attacking the Globalstar Simplex Data Service,"** *DEF CON 23*, 2015.

9. **M. M. McMahon and R. Rathburn, "Measuring Latency in Iridium Satellite Constellation Data Services,"** *NAVAL ACADEMY ANNAPOLIS MD DEPT OF COMPUTER SCIENCE*, Tech. Rep., 2005.

10. **SpaceX, "Starlink Mission,"** [Link](https://www.spacex.com/news/2020/01/07/starlink-mission), January 2020.

11. **OneWeb, "OneWeb,"** [Link](http://oneweb.world/).

12. **C. Caini and R. Firrincieli, "TCP Hybla: A TCP Enhancement for Heterogeneous Networks,"** *International Journal of Satellite Communications and Networking*, vol. 22, no. 5, pp. 547–566, 2004, ISSN: 1542-0981, DOI: 10.1002/sat.799.

13. **S. Oueslati-Boulahia, A. Serhrouchni, S. Tohmé, S. Baier, and M. Berrada, "TCP Over Satellite Links: Problems and Solutions,"** *Telecommunication Systems*, vol. 13, no. 2, pp. 199–212, July 2000, ISSN: 1572-9451, DOI: 10.1023/A:1019192022690.

14. **C. Caini, P. Cornice, R. Firrincieli, M. Livini, and D. Lacamera, "TCP, PEP, and DTN Performance on Disruptive Satellite Channels,"** in *2009 International Workshop on Satellite and Space Communications*, September 2009, pp. 371–375, DOI: 10.1109/IWSSC.2009.5286336.

15. **I. Bisio, M. Marchese, and M. Mongelli, "Performance Enhanced Proxy Solutions for Satellite Networks: State of the Art, Protocol Stack, and Possible Interfaces,"** in *Personal Satellite Services*, K. Sithamparanathan and M. Marchese, Eds., ser. Lecture Notes of the Institute for Computer Sciences, Social Informatics and Telecommunications Engineering, Berlin, Heidelberg: Springer, 2009, pp. 61–67, ISBN: 978-3-642-04260-7, DOI: 10.1007/978-3-642-04260-7_8.

16. **T. R. Henderson and R. H. Katz, "TCP Performance Over Satellite Channels,"** EECS Department, University of California, Berkeley, Tech. Rep. UCB/CSD-99-1083, December 1999, [Link](http://www2.eecs.berkeley.edu/Pubs/TechRpts/1999/5306.html).

17. **P. Hurtig, W. John, and A. Brunstrom, "Recent Trends in TCP Packet-Level Characteristics,"** 2011, [Link](https://www.semanticscholar.org/paper/Recent-Trends-in-TCP-Packet-Level-Characteristics-Hurtig-John/6fef36d3285997391a9d7d5259dd78c9d63a81aa).

18. **K. Pentikousis and H. Badr, "Quantifying the Deployment of TCP Options: A Comparative Study,"** *IEEE Communications Letters*, vol. 8, no. 10, pp. 647–649, 2004, ISSN: 1089-7798.

19. **IETF, "RFC 3135 - Performance Enhancing Proxies Intended to Mitigate Link-Related Degradations,"** [Link](https://tools.ietf.org/html/rfc3135), 2001.

20. **C. Caini and R. Firrincieli, "DTN and Satellite Communications,"** in *Delay Tolerant Networks: Protocols and Applications*, CRC Press, April 2016, ISBN: 978-1-4665-1301-3.

21. **A. Pirovano and F. Garcia, "A New Survey on Improving TCP Performances Over Geostationary Satellite Link,"** *Network and Communication Technologies*, vol. 2, no. 1, p1, January 2013, ISSN: 1927-064X, DOI: 10.5539/nct.v2n1p1.

22. **L. Li, X. Tian, G. Chen, K. Pham, and E. Blasch, "Secure Spectrum-Efficient Frequency Hopping for Return Link of Protected Tactical Satellite Communications,"** in *MILCOM 2016 - 2016 IEEE Military Communications Conference*, November 2016, pp. 254–258, DOI: 10.1109/MILCOM.2016.7795335.

23. **G. Zheng, P.-D. Arapoglou, and B. Ottersten, "Physical Layer Security in Multibeam Satellite Systems,"** *IEEE Transactions on Wireless Communications*, vol. 11, no. 2, pp. 852–863, February 2012, ISSN: 1558-2248, DOI: 10.1109/TWC.2011.120911.111460.

24. **CCSDS, "Space Data Link Security Protocol - Summary of Concept and Rationale,"** Green Book, June 2018, [Link](https://public.ccsds.org/Pubs/350x5g1.pdf).

25. **W. Li and D. Gu, "Security Analysis of DVB Common Scrambling Algorithm,"** in *The First International Symposium on Data, Privacy, and E-Commerce (ISDPE 2007)*, November 2007, pp. 271–273, DOI: 10.1109/ISDPE.2007.63.

26. **L. Duquerroy, S. Josset, O. Alphand, P. Berthou, and T. Gayraud, "SatiPSec: An Optimized Solution for Securing Multicast and Unicast Satellite Transmissions,"** in *22nd AIAA International Communications Satellite Systems Conference & Exhibit 2004 (ICSSC)*, American Institute of Aeronautics and Astronautics, May 2004, DOI: 10.2514/6.2004-3177.

27. **L. Djeddai and R. K. Liu, "IPSecOPEP: IPSec over PEPs Architecture, for Secure and Optimized Communications Over Satellite Links,"** in *2016 7th IEEE International Conference on Software Engineering and Service Science (ICSESS)*, August 2016, pp. 264–268, DOI: 10.1109/ICSESS.2016.7883063.

28. **Encore Networks, "BANDIT 2,"** [Link](https://www.encorenetworks.com/products/bandit-ii/).

29. **DSD Telecom, "DSD Satellite VPN,"** [Link](http://www.dsdtelecom.com/index.php/support/satellite-vpn).

30. **Newtec, "EL810 Mobile PEP-Box Terminal,"** [Link](http://www.newtec.be/tellinet/Newtec-Elevation-El810-Mobile-PEP-Box-Terminal-web-print.pdf), October 2008.

31. **RigNet, "CyphreLink - End-to-End Data Protection,"** [Link](https://www.cyphre.com/cyphrelink/).

32. **Hughes, "HN7000S Modem Product Page,"** [Link](https://www.hughes.com/technologies/broadband-satellite-systems/hn-systems/hn7000s).

33. **Tellitec Gmbh., "TC-Spy Documentation,"** [Link](https://wikileaks.org/wiki/Tellitec_Tellinet_Sat_Spy_manual), March 2006.

34. **A. Adelsbach and U. Greveler, "Insider Attacks Enabling Data Broadcasting on Crypto-Enforced Unicast Links,"** in *Computer Security – ESORICS 2007*, J. Biskup and J. Lóopez, Eds., ser. Lecture Notes in Computer Science, Berlin, Heidelberg: Springer, 2007, pp. 469–484, ISBN: 978-3-540-74835-9, DOI: 10.1007/978-3-540-74835-9_31.

35. **Ground Control, "IG-VPN: Using Application Layer Technology to Overcome the Impact of Satellite Circuit Latency on VPN Performance,"** [Link](https://www.groundcontrol.com/IG-VPN-Intro.pdf), 2003.

36. **D. Lacamera and S. Ammirata, "PEPsal: A TCP Performance Enhancing Proxy for Satellite Links,"** [Link](https://github.com/danielinux/pepsal), September 2016.

37. **OpenVPN Inc., "OpenVPN,"** [Link](https://openvpn.net/), 2020.

38. **Alexa, "The Top 500 Sites on the Web,"** [Link](https://www.alexa.com/topsites), January 2020.

39. **U. Speidel, "Simulating Satellite Internet Traffic to a Small Island Internet Provider,"** [Link](https://isif.asia/simulating-satellite-internet-traffic-to-a-small-island-internet-provider/), January 2017.

40. **ETSI, "ETSI TR 102 768: Digital Video Broadcasting (DVB); Interaction Channel for Satellite Distribution Systems; Guidelines for the Use of EN 301 790 in Mobile Scenarios,"** Tech. Rep. ETSI TR 102 768, 2009, [Link](https://www.etsi.org/deliver/etsi_tr/102700_102799/102768/01.01.01_60/tr_102768v010101p.pdf).

41. **ETSI, "ETSI TR 102 376-1: Digital Video Broadcasting (DVB); Implementation Guidelines for the Second Generation System for Broadcasting, Interactive Services, News Gathering, and Other Broadband Satellite Applications; Part 1: DVB-S2,"** Technical Report ETSI TR 102 376-2, 2015, [Link](https://www.etsi.org/deliver/etsi_tr/102300_102399/10237601/01.02.01_60/tr_10237601v010201p.pdf).

42. **ITU, "ITU-T Y.1541 Network Performance Objectives for IP-Based Services,"** Y-Series Recommendation, December 2011, [Link](https://www.itu.int/rec/T-REC-Y.1541/en).

43. **A. Boubaker, "OpenSAND Example of Delay Variations,"** [Link](https://wiki.net4sat.org/), June 2019.

44. **A. Custura, T. Jones, and G. Fairhurst, "Rethinking ACKs at the Transport Layer,"** in *2020 IFIP Networking Conference (Networking)*, June 2020, pp. 731–736.

45. **T. Jones, A. Custura, and G. Fairhurst, "Changing the Default QUIC ACK Policy,"** IETF Informational Draft Memo, September 2020, [Link](https://tools.ietf.org/html/draft-fairhurst-quic-ack-scaling-03).

46. **Newtec, "TL100 TelliNet V2.6 Tellitec Product Family,"** [Link](https://www.newtec.eu/frontend/files/leaflet/nop1800-nop1805-acceleration-and-compression-software.pdf), 2009.

47. **S. Chen, S. Jero, M. Jagielski, A. Boldyreva, and C. Nita-Rotaru, "Secure Communication Channel Establishment: TLS 1.3 (over TCP Fast Open) vs. QUIC,"** in *Computer Security – ESORICS 2019*, K. Sako, S. Schneider, and P. Y. A. Ryan, Eds., ser. Lecture Notes in Computer Science, Cham: Springer International Publishing, 2019, pp. 404–426, ISBN: 978-3-030-29959-0, DOI: 10.1007/978-3-030-29959-0_20.

48. **I. Swett, "QUIC FEC v1 - Google Groups,"** [Link](https://groups.google.com/a/chromium.org/forum/#!topic/proto-quic/Z5qKkk2XZe0), Message Board, February 2016.

49. **L. Thomas, E. Dubois, N. Kuhn, and E. Lochin, "Google QUIC Performance Over a Public SATCOM Access,"** *International Journal of Satellite Communications and Networking*, vol. 37, no. 6, pp. 601–611, 2019, ISSN: 1542-0981, DOI: 10.1002/sat.1301.

50. **J. P. Rula, J. Newman, F. E. Bustamante, A. M. Kakhki, and D. Choffnes, "Mile High Wi-Fi: A First Look at In-Flight Internet Connectivity,"** in *Proceedings of the 2018 World Wide Web Conference*, International World Wide Web Conferences Steering Committee, 2018, pp. 1449–1458, ISBN: 1-4503-5639-7.

51. **N. Kuhn, J. Border, and E. Stephan, "QUIC for SATCOM,"** [Link](https://www.potaroo.net/ietf/idref/draft-kuhn-quic-4-sat/), November 2019.

52. **M. Fischlin and F. Günther, "Replay Attacks on Zero Round-Trip Time: The Case of the TLS 1.3 Handshake Candidates,"** in *2017 IEEE European Symposium on Security and Privacy (EuroS&P)*, April 2017, pp. 60–75, DOI: 10.1109/EuroSP.2017.18.

53. **G. Delannoy, "TCPeP,"** [Link](https://github.com/GregoireDelannoy/TCPeP), May 2013.

54. **D. Velenis, D. Kalogeras, and B. Maglaris, "SaTPEP: A TCP Performance Enhancing Proxy for Satellite Links,"** in *NETWORKING 2002: Networking Technologies, Services, and Protocols; Performance of Computer and Communication Networks; Mobile and Wireless Communications*, E. Gregori, M. Conti, A. T. Campbell, G. Omidyar, and M. Zukerman, Eds., ser. Lecture Notes in Computer Science, Berlin, Heidelberg: Springer, 2002, pp. 1233–1238, ISBN: 978-3-540-47906-2, DOI: 10.1007/3-540-47906-6_113.

55. **L. Clemente, "Quic-go,"** [Link](https://github.com/lucas-clemente/quic-go), August 2019.

56. **Google, "QUIC, a Multiplexed Stream Transport Over UDP - The Chromium Projects,"** [Link](https://www.chromium.org/quic), 2020.

57. **A. Auger, E. Lochin, and N. Kuhn, "Making Trustable Satellite Experiments: An Application to a VoIP Scenario,"** in *IEEE 89th Vehicular Technology Conference: IEEE VTC2019-Spring*, [Link](https://doi.org/10.1109/VTCSpring.2019.8746404), 2019, pp. 1–5.

58. **SitespeedIO, "Browsertime, sitespeed.io,"** [Link](https://github.com/sitespeedio/browsertime), December 2019.

59. **Mozilla.org, "PerformanceTiming.navigationStart,"** [Link](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceTiming/navigationStart), Documentation, September 2019.

### Appendix A - Testbed Network Configurations

For clarity, we have provided a number of network configuration diagrams to detail the testbed configurations used for each of the five scenarios commonly referenced in our benchmark comparisons. Further technical details can be found in the QPEP source repository.

#### Figure 11: Testbed Configurations
(a) **Plain Satellite Connection Testbed Architecture**
(b) **Integrated PEPsal Testbed Architecture**
(c) **Distributed PEPsal Testbed Architecture**
(d) **OpenVPN Testbed Architecture**
(e) **QPEP Testbed Architecture**

**Figure 11a: Plain Satellite Connection Testbed Architecture**
```
SatelliteTerminal
|
|----> Satellite
       |
       |----> SatelliteGateway
             |
             |----> Internet
             |
             |----> Terminal
                    |
                    |----> Workstation
```

**Figure 11b: Integrated PEPsal Testbed Architecture**
```
SatelliteTerminal (Running PEPsal)
|
|----> Satellite
       |
       |----> SatelliteGateway
             |
             |----> Internet
             |
             |----> Terminal
                    |
                    |----> Workstation
```

**Figure 11c: Distributed PEPsal Testbed Architecture**
```
SatelliteTerminal
|
|----> Satellite
       |
       |----> SatelliteGateway (Running PEPsal)
             |
             |----> Internet
             |
             |----> Terminal
                    |
                    |----> Workstation
```

**Figure 11d: OpenVPN Testbed Architecture**
```
SatelliteTerminal (Running OpenVPN)
|
|----> Satellite
       |
       |----> SatelliteGateway
             |
             |----> Internet
             |
             |----> Terminal
                    |
                    |----> Workstation
```

**Figure 11e: QPEP Testbed Architecture**
```
SatelliteTerminal (QPEP Client)
|
|----> Satellite
       |
       |----> SatelliteGateway
             |
             |----> Internet
             |
             |----> Terminal
                    |
                    |----> Workstation
```

Each diagram provides a visual representation of the network topology, including the placement of key components such as the Satellite Terminal, Satellite, Satellite Gateway, and Workstations. The specific IP address ranges for each segment are as follows:

- **OpenSAND Network:** 172.20.0.*
- **Gateway Network:** 172.22.0.*
- **Workstation (IPerf Server):** 172.22.0.*
- **Browsertime Workstation:** 172.22.0.*
- **Terminal Network:** 172.21.0.*

These configurations were used to conduct comprehensive performance and security evaluations of QPEP in various scenarios.