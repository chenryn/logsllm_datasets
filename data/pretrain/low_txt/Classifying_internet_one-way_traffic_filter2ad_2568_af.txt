### Figure 6: Outage on June 23, 2011

**Figure 6** illustrates a significant outage that occurred on June 23, 2011, at 19:40 UTC, affecting most university services. This outage resulted in failed accesses from 287,583 unique clients and lasted over 10 minutes. The issue was a general reachability problem with the departmental network from external sources.

To better understand this outage, we analyzed three key services at ETH Zurich: the main web, webmail, and software distribution services. Surprisingly, all these services were simultaneously inaccessible, indicating a campus-wide temporary reachability problem. During the 10-minute interval, our outage impact metric revealed that 287,583 unique clients were unable to access the target services. Further investigation showed that the outage coincided with a planned router software upgrade. Although some disruptions were anticipated, the scale of the disruption was unexpectedly large.

Current server availability monitoring techniques, such as active probing and server logs, do not capture this critical information. Additionally, we visually inspected the time series of one-way flow volumes for the top departmental services. The outage led to a sharp increase in requests targeting mail services due to the automated retry behavior of mail clients. Conversely, for web services, the volume of one-way flows during the outage did not significantly differ from the volume of two-way flows during regular operation, suggesting a more network-friendly retry behavior.

### Reachability Metrics and Actionable Cases

Our analysis of the reachability metrics for the discovered services identified two actionable cases:

1. **NTP Server Unreachability:**
   - We found an NTP server (swisstime.ee.ethz.ch) that was consistently unreachable by an average of 12.9% of its clients. During the studied week, 2.2 million unique clients experienced one-way flows to this NTP server.
   - Standard NTP "hello world" configuration examples often use this server, making it one of the most popular NTP servers on the Internet. It is also preconfigured in many embedded devices.
   - The failure rate varied by country of origin, with Belgium having the highest failure rate at 65.7%, followed by India at 20.2%, and Germany at 16.8%.
   - Two main causes of low reachability were identified: 
     - An IP filter configured to block access from a /8 address block, which was frequently the source of attacks.
     - Certain devices computing invalid CRC checksums, resulting in dropped requests.
   - These findings highlight the significant impact of traffic flow to the studied network and the importance of correctly configured applications.

2. **SMB Service One-Way Flows:**
   - The SMB service on port 445/tcp experienced 112% more one-way flows than two-way flows. An in-depth analysis revealed that almost all one-way flows originated from a likely misconfigured client persistently trying to connect to this service.
   - All other services achieved a reachability of 97.1% or higher, with most reaching 99.9%.

### Related Work

Studying Internet Background Radiation (IBR) traffic has been crucial for understanding Internet threats. In 2001, Moore et al. [23] used network telescopes to monitor background radiation and assess the prevalence of denial-of-service attacks. Yegneswaran et al. [31] analyzed scan logs from DShield [9] between 2001 and 2002, revealing that a small number of correlated sources were responsible for a significant fraction of intrusion attempts. Pang et al. [24] characterized traffic towards four large unused address blocks, highlighting the dynamic nature of background radiation. Wustrow et al. [30] examined background radiation between 2006 and 2010, observing its continued dynamism and identifying artifacts leading to address space pollution.

Recent studies have focused on one-way traffic. Brownlee [6] described a tool called iatmon for classifying one-way traffic based on packet interarrival times and remote scanner patterns. Lee and Brownlee [20] analyzed the lifetime and size distribution of one and two-way flows using data from the University of Auckland. Allman et al. [2] used TCP connection logs to characterize scanning over time and correlate patterns with known malware activity. Jin et al. [14] developed a heuristic to identify external scanners using flow data towards grey IP space in a campus network.

Other studies have addressed related but less directly connected issues. Guha et al. [11] characterized the fraction of useful flows generated by mobile hosts in an enterprise network, finding that 34% of flows fail due to host mobility. Schatzmann et al. [26] described a flow-based system to identify reachability problems caused by events like prefix hijacking. Barford et al. [4] modeled the network location of sources of background radiation and derived a model for generating source IP addresses in simulation and emulation environments.

### Conclusions

One-way traffic towards live networks is a significant component of Internet traffic, accounting for a large fraction of total flows. To understand this traffic, we designed and validated a classification scheme for one-way traffic. Classifying one-way traffic based solely on flow-level data is challenging due to the limited number of packets and lack of payload. We developed and optimized 18 classification rules leveraging communication patterns of involved end hosts.

Using our classifier, we analyzed a massive dataset of traffic flow records from a regional backbone network and made the following key observations:
1. One-way traffic constitutes a very large fraction of the total number of flows, though it accounts for only 3.4% of the total number of packets.
2. Scanning accounts for 83.5% of one-way flows and 62.6% of packets; peer-to-peer applications account for 6.7% of flows and 13.0% of packets; and unreachable services account for 4.8% of flows and 10.1% of packets.
3. The number of two-way flows increased significantly by 343% between 2004 and 2011, while the absolute volume of one-way flows in 2011 was almost equal to that in 2004.
4. The share of one-way flows declined from 67% in 2004 to 34% in 2011.

We focused on the particularly interesting class of one-way traffic caused by unreachable services, demonstrating its utility for monitoring service reachability and assessing the impact of outages.

In the past, IBR traffic has been primarily studied using a small number of large network telescopes. Our techniques are valuable for edge network operators to monitor local IBR traffic and detect service reachability problems. We will make the code of our classification scheme publicly available and release non-sensitive details about the evolution of one-way and two-way traffic between 2004 and 2011. For each 10-minute interval, we will provide statistics on the composition of one-way traffic, the popularity of different signs, targeted services, and the geographical distribution of sources.

### Acknowledgements

We are grateful to SWITCH for providing the data used in this study. We also thank Dominik Schatzmann for assistance with double-counting elimination and Simon Leinen for valuable feedback on service reachability monitoring. Finally, we acknowledge anonymous reviewers for their helpful comments and suggestions.

### References

[1] Akamai Technologies. The state of the internet report (3rd quarter, 2009). Technical report, 2009.
[2] M. Allman, V. Paxson, and J. Terrell. A brief history of scanning. In Proceedings of the 7th ACM SIGCOMM conference on Internet measurement, page 82. ACM, 2007.
[3] M. Bailey, E. Cooke, F. Jahanian, D. Watson, and J. Nazario. The blaster worm: Then and now. IEEE Security and Privacy, 3:26–31, July 2005.
[4] P. Barford, R. Nowak, R. Willett, and V. Yegneswaran. Toward a model for source addresses of internet background radiation. In Proc. of the Passive and Active Measurement Conference. Citeseer, 2006.
[5] D. Brauckhoff, X. Dimitropoulos, A. Wagner, and K. Salamatian. Anomaly extraction in backbone networks using association rules. In Proceedings of the 9th ACM SIGCOMM conference on Internet measurement conference, IMC ’09, pages 28–34, New York, NY, USA, 2009. ACM.
[6] N. Brownlee. One-way traffic monitoring with iatmon. In Passive and Active Measurement Conference, 2012.
[7] CAIDA. UCSD Network Telescope. http://www.caida.org/data/realtime/telescope/.
[8] T. Cymru. The Bogon Reference. http://www.team-cymru.org/Services/Bogons/, 2012.
[9] Cooperative Network Security Community - Internet Security. www.dshield.org.
[10] F. Gont. ICMP attacks against TCP. RFC 5927, July 2010.
[11] S. Guha, J. Chandrashekar, N. Taft, and K. Papagiannaki. How healthy are today’s enterprise networks? In Proceedings of the 8th ACM SIGCOMM conference on Internet measurement, pages 145–150. ACM, 2008.
[12] IANA - Internet Assigned Numbers Authority. PORT NUMBERS. http://www.iana.org/assignments/port-numbers, 2011.
[13] C. Inacio and B. Trammell. Yaf: yet another flowmeter. In Proceedings of the 24th international conference on Large installation system administration, pages 1–16. USENIX Association, 2010.
[14] Y. Jin, Z. Zhang, K. Xu, F. Cao, and S. Sahu. Identifying and tracking suspicious activities through IP gray space analysis. In Proceedings of the 3rd annual ACM workshop on Mining network data, page 12. ACM, 2007.
[15] W. John and S. Tafvelin. Heuristics to classify internet backbone traffic based on connection patterns. International Conference on Information Networking (ICOIN), pages 1–5, 2008.
[16] J. Jung, V. Paxson, A. Berger, and H. Balakrishnan. Fast portscan detection using sequential hypothesis testing. In Proceedings of the IEEE Symposium on Security and Privacy, pages 211–225, 2004.
[17] T. Karagiannis, A. Broido, and M. Faloutsos. Transport layer identification of p2p traffic. Proceedings of the 4th ACM SIGCOMM conference on Internet measurement, pages 121–134, 2004.
[18] T. Karagiannis, K. Papagiannaki, and M. Faloutsos. Blinc: multilevel traffic classification in the dark. In ACM SIGCOMM Computer Communication Review, volume 35, pages 229–240. ACM, 2005.
[19] H. Kim, K. Claffy, M. Fomenkov, D. Barman, M. Faloutsos, and K. Lee. Internet traffic classification demystified: myths, caveats, and the best practices. In Proceedings of the 2008 ACM CoNEXT conference, page 11. ACM, 2008.
[20] D. Lee and N. Brownlee. Passive measurement of one-way and two-way flow lifetimes. SIGCOMM Comput. Commun. Rev., 37(3):17–28, 2007.
[21] D. Moore, V. Paxson, S. Savage, C. Shannon, S. Staniford, and N. Weaver. Inside the slammer worm. IEEE Security and Privacy, 1:33–39, July 2003.
[22] D. Moore, C. Shannon, G. Voelker, and S. Savage. Network telescopes: Technical report. Technical report, 2004.
[23] D. Moore, G. M. Voelker, and S. Savage. Inferring internet denial-of-service activity. In SSYM’01: Proceedings of the 10th conference on USENIX Security Symposium, Berkeley, USA, 2001.
[24] R. Pang, V. Yegneswaran, P. Barford, V. Paxson, and L. Peterson. Characteristics of Internet background radiation. In Proceedings of the 4th ACM SIGCOMM conference on Internet measurement, pages 27–40. ACM New York, NY, USA, 2004.
[25] M. Pernyi, T. D. Dang, A. Gefferth, and S. Molnár. Identification and analysis of peer-to-peer traffic. JOURNAL OF COMMUNICATIONS, 1(7), 2006.
[26] D. Schatzmann, S. Leinen, J. Kogel, and W. Mühlbauer. FACT: Flow-based approach for connectivity tracking. In Passive and Active Measurement conference, Mar. 2011.
[27] B. Trammell and E. Boschi. Bidirectional flow export using IPFIX. RFC 5103, January 2008.
[28] J. Treurniet. A network activity classification schema and its application to scan detection. IEEE/ACM Trans. Netw., 19(5):1396–1404, Oct. 2011.
[29] Wikipedia. NetFlow. http://en.wikipedia.org/wiki/Netflow.
[30] E. Wustrow, M. Karir, M. Bailey, F. Jahanian, and G. Huston. Internet background radiation revisited. In Proceedings of the 10th annual conference on Internet measurement, IMC ’10, pages 62–74, New York, NY, USA, 2010. ACM.
[31] V. Yegneswaran, P. Barford, and J. Ullrich. Internet intrusions: global characteristics and prevalence. SIGMETRICS Perform. Eval. Rev., 31(1):138–147, 2003.