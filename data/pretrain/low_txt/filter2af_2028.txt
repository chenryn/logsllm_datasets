# DEFCON CHINA 议题解读 | 欺骗图片搜索引擎

##### 译文声明
本文为翻译文章，译文仅供参考，具体内容及含义以原文为准。

## 1. 介绍
在DEFCON China大会上，来自中国人民大学的弓媛君、梁彬教授及黄建军博士进行了题为“欺骗图片搜索引擎”的报告。该研究揭示了一种新的安全威胁：广泛应用于图片搜索引擎中的基于内容的图像检索系统（CBIR）可能成为潜在的攻击目标。攻击者可以通过移除或注入图片关键点来绕过检索算法，从而欺骗搜索引擎，避开图片相似度查询，达到图片内容抄袭等目的。

## 2. 背景
基于内容的图像检索系统（CBIR），也称为“以图搜图”，已被广泛应用于各大搜索引擎中。其功能是通过用户输入的一张图片，搜索引擎查找并返回具有相同或相似内容的其他图片结果。CBIR系统的数据库建立过程主要包括以下几个步骤：
- 通过图像特征提取算法（如经典的SIFT和SURF算法）生成聚合向量。
- 对聚合向量建立索引数据库。
- 用户进行图片检索时，搜索引擎通过对用户输入图片进行特征提取得到聚合向量，在索引数据库中查找相似向量并返回对应的图片。

SIFT和SURF算法在提取图片特征时具有旋转和尺度不变性，能够应用于不同尺寸和旋转效果的图片，因此被广泛用于图片检索系统。其中，SIFT默认提取128维特征，而SURF默认提取64维特征。

图1: CBIR系统框架[1]

## 3. 针对图片搜索引擎的欺骗攻击
针对CBIR系统的图片检索环节，演讲者提出了几种欺骗攻击思路，即在保留图片视觉语义的情况下篡改图片关键点以修改聚合特征，进而影响检索结果。该团队主要提供了三类方法：仅移除、仅注入和混合扰动。

### 3.1 仅移除特征点
对于SIFT算法，该团队使用已有的RMD算法（Minimum Local Distortion Attack）实现特征点的移除。对于SURF算法，他们提出了自己的RMD-SURF算法来移除SURF特征点。这种方法可以影响图像检索结果，但仅适用于特征点较少的图片样本，对于复杂图像可能会导致视觉语义明显改变。

### 3.2 仅注入特征点
该团队设计了IMD算法（RMD算法的逆操作）来实施关键点注入策略。通过在图片中注入SIFT关键点，或者在图片周围添加特殊构造的边框以注入关键点。与仅移除特征点的方法类似，该方法对某些图像的视觉语义表征影响较大，单独使用不适用于复杂图片内容。

### 3.3 混合扰动方法
为了在改变图像聚合特征的同时尽量保留图像视觉语义不变，该团队将特征点注入和移除方法结合起来，提出了一种混合扰动方案。结果显示，该方法可以在图片语义表达改变很轻微的情况下对搜索引擎进行欺骗。

### 3.4 效果展示
在验证阶段，该团队对本地图片检索引擎VisualIndex以及在线搜索引擎Google Image进行了攻击，并展示了效果。从结果可以看出，经过关键点扰动后的图片，CBIR系统已无法对其进行正确辨别，这表明该攻击方法可以在保持图片视觉语义的同时，有效地逃避搜索引擎检索。最后，讲者指出目前该工作还尚未能完全实现Source-Target攻击，即人为地控制检索结果，这也将作为今后的一个研究方向。

图3.1: 仅移除关键点图像 (60次RMD)
图3.2: VisualIndex检索图像结果
图4.1: 仅注入关键点图像
图4.2: VisualIndex检索图像结果
图5.1: 融合算法图像
图5.2: VisualIndex检索图像结果
图6: 融合算法成功绕开了Google Image的检索

## 4. 总结
该报告展示了针对图片搜索引擎（CBIR）的一种安全威胁，攻击者可以通过图片关键点扰动来避开搜索引擎检索。该研究表明，即使是当前工业级的图片搜索引擎（如Google Image）也容易受到恶意构造图片的欺骗，希望引起对CBIR等信息检索系统安全问题的关注。

参考文献：
[1] A.Ramesh Kumar, D.Saravanan, Content Based Image Retrieval Using Color Histogram, A.Ramesh Kumar et al, (IJCSIT) International Journal of Computer Science and Information Technologies, Vol. 4 (2), 2013, 242 – 245.
[2] ...