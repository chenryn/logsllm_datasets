### Confidence Values and Hypothesis Evaluation

We use the estimated confidence values for each word in a given hypothesized transcript to assess the reliability of that hypothesis. Our analysis indicates a correlation (see Figure 13) between these confidence measures and the maximum METEOR scores obtained from the top 10 hypotheses generated by the word-level language model (Stage ). This suggests that, with a dataset like TIMIT, an adversary can set an appropriate threshold for the confidence values to balance precision and recall in the hypothesized transcripts. The results in Figure 14 provide an example of this analysis under a content-dependent model. We observe that setting a threshold improves the METEOR scores of the remaining hypotheses.

### Figures and Data Analysis

- **Figure 12:** The top 10% of METEOR scores for hypothesized transcripts under the content-independent assumption.
- **Figure 14:** METEOR scores for hypothesized transcripts for sentence SA2, with confidence values above the threshold of 0.90 for each dialect in the TIMIT dataset. The number of transcripts with confidence values above the threshold, compared to the total for each dialect, is shown in parentheses.

### Preliminary Results on Masking

Preliminary results suggest that "masking" high-confidence words may improve the interpretation of hypotheses. For example, outputting 'nonprofit (cid:63) all (cid:63) (cid:63) raisers' instead of 'nonprofit organizations all swiftly fairy raisers' as the hypothesis for 'nonprofit organizations have frequent fund raisers'. However, we defer further analysis until an automated method for evaluating such hypotheses is developed, as the METEOR metric does not support unknown words.

### Discussion and Mitigation

#### Assumptions and Limitations

- **Packet Assumption:** Like other work in this area (e.g., [2, 37, 41, 55, 56]), we assume each packet contains a single frame. However, some modern codecs, such as Skype’s SILK, can vary the number of frames per packet based on network conditions. Adapting our approach to such settings requires substantial data collection, which is beyond the scope of this work.
- **Packet Order and Fragmentation:** Our experiments assume packets are observed in correct order and are not fragmented or combined. The adversary can observe packets at the local network level (e.g., between VoIP endpoint and hub or PBX) or perform IP defragmentation or TCP stream reassembly. Despite the inherent channel limitations, our technique is robust to reasonable noise, including packet reordering and fragmentation.

#### Potential Countermeasures

- **Constant Bit-Rate Codecs and Block Ciphers:** A common reaction to thwarting threats to VoIP is to use constant bit-rate codecs or block ciphers. However, variable bit-rate encoded audio encrypted under a block cipher with a small block size is theoretically vulnerable to our attack. Large block sizes are necessary to ensure privacy. Constant bit-rate codecs might improve call quality with a fixed packet size.
- **Packet Padding and Dropping:** Another alternative is to drop or pad packets [19, 27, 57], though the effect on perceived call quality is unclear. VoIP providers, however, have not adopted such measures. For instance, Skype’s SILK is a VBR codec, and the LTE Advanced standard specifies a VBR codec for audio and uses SRTP to secure voice data channels.

### Conclusion

In this paper, we explore the ability of an adversary to reconstruct parts of encrypted VoIP conversations. We propose an approach for generating a hypothesized transcript by segmenting observed packet sizes into subsequences corresponding to likely phonemes, mapping these to candidate words, and using language models to choose the best candidates. Our results show that the quality of the recovered transcripts is better than expected, raising concerns about the security of encrypted VoIP. With advances in computational linguistics, such reconstructions are likely to improve. We hope this work stimulates discussion on designing more secure and efficient techniques for preserving the confidentiality of VoIP conversations.

### Acknowledgements

We thank the anonymous reviewers for their insightful comments and Elliot Moreton of the Department of Linguistics at UNC-Chapel Hill for helpful suggestions. This work is supported in part by NSF grants CCF-1017318 and CNS-0852649.

### References

[1] 3GPP. Extended adaptive multi-rate wideband (AMR-WB+) codec. Technical Report 26.290, 3rd Generation Partnership Project (3GPP), 2009.
[2] M. Backes, G. Doychev, M. Dürmuth, and B. Köpf. Speaker recognition in encrypted voice streams. In Proc. 15th European Symposium on Research in Computer Security, pages 508–523, 2010.
[3] M. Baugher, D. McGrew, M. Naslund, E. Carrara, and K. Norrman. The secure real-time transport protocol (SRTP). RFC 3711, Internet Engineering Task Force, 2004.
[4] L. E. Baum, T. Petrie, G. Soules, and N. Weiss. A maximization technique occurring in the statistical analysis of probabilistic functions of Markov chains. The Annals of Mathematical Statistics, 41(1):164–171, 1970.
[5] D. Beeferman, A. Berger, and J. Lafferty. Statistical models for text segmentation. Mach. Learn., 34(1-3), 1999.
[6] A. L. Berger, S. A. D. Pietra, and V. J. D. Pietra. A maximum entropy approach to natural language processing. Computational Linguistics, 22:39–71, 1996.
[7] L. Bernaille and R. Teixeira. Early recognition of encrypted applications. In PAM, pages 165–175, 2007.
[8] D. Blanchard, J. Heinz, and R. Golinkoff. Modeling the contribution of phonotactic cues to the problem of word segmentation. The Journal of Child Language, 37(3):487–511, 2010.
[9] H. Bortfeld, J. Morgan, R. Golinkoff, and K. Rathbun. Mommy and me: Familiar names help launch babies into speech-stream segmentation. Psychological Science, 16:298–304, 2005.
[10] S. Chen, R. Wang, X. Wang, and K. Zhang. Side-channel leaks in web applications: A reality today, a challenge tomorrow. In Proceedings of the IEEE Symposium on Security and Privacy, pages 191–206, 2010.
[11] R. A. Cole and J. Jakimik. A Model of Speech Perception, chapter 6, pages 133–163. Lawrence Erlbaum Associates, 1980.
[12] M. Crotti, M. Dusi, F. Gringoli, and L. Salgarelli. Traffic classification through simple statistical fingerprinting. SIGCOMM Comput. Commun. Rev., 37(1):5–16, 2007.
[13] M. Denkowski and A. Lavie. Choosing the right evaluation for machine translation: an examination of annotator and automatic metric performance on human judgment tasks. In Proceedings of AMTA, 2010.
[14] M. Denkowski, A. Agarwal, S. Banerjee, and A. Lavie. The METEOR MT Evaluation System, Version 1.2. Carnegie Mellon University, Pittsburgh, PA, 2010.
[15] B. Dupasquier, S. Burschka, K. McLaughlin, and S. Sezer. Analysis of information leakage from encrypted Skype conversations. International Journal of Information Security, pages 1–13, 2010.
[16] R. Durbin, S. Eddy, A. Krogh, and G. Mitchison. Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids. Cambridge University Press, 1998.
[17] M. Dusi, M. Crotti, F. Gringoli, and L. Salgarelli. Detection of encrypted tunnels across network boundaries. In ICC, pages 1738–1744, 2008.
[18] A. Esposito and G. Aversano. Text independent methods for speech segmentation. In Nonlinear Speech Modeling and Applications, volume 3445 of Lecture Notes in Computer Science, pages 261–290. Springer, 2005.
[19] P. Fogla, M. Sharif, R. Perdisci, O. Kolesnikov, and W. Lee. Polymorphic blending attacks. In Proceedings of the USENIX Security Symposium, pages 241–256, 2006.
[20] W. N. Francis and H. Kucera. Brown corpus manual. Technical report, Department of Linguistics, Brown University, 1979.
[21] J. S. Garofolo, L. F. Lamel, W. M. Fisher, J. G. Fiscus, D. S. Pallett, N. L. Dahlgren, and V. Zue. TIMIT acoustic-phonetic continuous speech corpus, 1993.
[22] D. Gildea and D. Jurafsky. Learning bias and phonological-rule induction. Computational Linguistics, 22(4):497–530, 1996.
[23] M. Halle. Knowledge unlearned and untaught: What speakers know about the sounds of their language. Linguistic Theory and Psychological Reality, pages 294–303, 1978.
[24] J. Harrington, G. Watson, and M. Cooper. Word boundary identification from phoneme sequence constraints in automatic continuous speech recognition. In Computational linguistics - Volume 1, pages 225–230, 1988.
[25] B. Hayes and C. Wilson. A maximum entropy model of phonotactics and phonotactic learning. Linguistic Inquiry, 39(3):379–440, 2008.
[26] Y. Hifny and S. Renals. Speech recognition using augmented conditional random fields. IEEE Transactions on Audio, Speech, and Language Processing, 17(2):354–365, 2009.
[27] A. Iacovazzi and A. Baiocchi. Optimum packet length masking. In 22nd International Teletraffic Congress (ITC), pages 1–8, 2010.
[28] E. T. Jaynes. Information theory and statistical mechanics. Phys. Rev., 106(4):620–630, May 1957.
[29] F. Jelinek. Statistical Methods for Speech Recognition. Massachusetts Institute of Technology, 1997.
[30] D. Jurafsky and J. H. Martin. Speech and Language Processing: An Introduction to Natural Language Processing, Computational Linguistics, and Speech Recognition. Prentice Hall, 2008.
[31] T. Karagiannis, K. Papagiannaki, and M. Faloutsos. BLINC: multilevel traffic classification in the dark. SIGCOMM Comput. Commun. Rev., 35(4):229–240, 2005.
[32] T. Kempton and R. K. Moore. Language identification: Insights from the classification of hand annotated phone transcripts. In Speaker and Language Recognition Workshop, Jan. 2008.
[33] A. D. Keromytis. A survey of Voice over IP security research. In Proceedings of the 5th International Conference on Information Systems Security, pages 1–18, 2009.
[34] A. Lavie. Evaluating the output of machine translation systems. AMTA Tutorial, 2010.
[35] A. Lavie and M. J. Denkowski. The METEOR metric for automatic evaluation of machine translation. Machine Translation, 23:105–115, September 2009.
[36] K.-F. Lee and H.-W. Hon. Speaker-independent phoneme recognition using hidden Markov models. The Journal of the Acoustical Society of America, 84(S1):62, 1988.
[37] T. Leila and R. Bettati. Privacy of encrypted Voice-over-IP. In Proceedings of the IEEE International Conference on Systems, Man and Cybernetics, pages 3063–3068, 2007.
[38] M. Liberatore and B. N. Levine. Inferring the source of encrypted HTTP connections. In Proceedings of the ACM Conference on Computer and Communications Security, pages 255–263, 2006.
[39] D. C. Liu, J. Nocedal, and D. C. On the limited memory BFGS method for large scale optimization. Mathematical Programming, 45:503–528, 1989.
[40] E. Loper and S. Bird. NLTK: The natural language toolkit, May 2002.
[41] Y. Lu. On traffic analysis attacks to encrypted VoIP calls. Master’s thesis, Cleveland State University, Fenn College of Engineering, 2009.
[42] G. Maiolini, A. Baiocchi, A. Iacovazzi, and A. Rizzi. Real time identification of SSH encrypted application flows by using cluster analysis techniques. In Proceedings of the International IFIP-TC 6 Networking Conference, pages 182–194, 2009.
[43] A. McGregor, M. Hall, P. Lorier, and J. Brunskill. Flow clustering using machine learning techniques. In PAM, pages 205–214, 2004.
[44] I. Mporas, T. Ganchev, and N. Fakotakis. Speech segmentation using regression fusion of boundary predictions. Computer Speech & Language, 24(2):273–288, 2010.
[45] M. Oakes. Computer estimation of vocabulary in protolanguage from word lists in four daughter languages. Journal of Quantitative Linguistics, 7(3):233–243, 2000.
[46] A. Ratnaparkhi. A maximum entropy model for part-of-speech tagging. In Proceedings of the Conference on Empirical Methods in Natural Language Processing, pages 133–142, 1996.
[47] W. D. Raymond, M. Pitt, K. Johnson, E. Hume, M. Makashay, R. Dautricourt, and C. Hilts. An analysis of transcription consistency in spontaneous speech from the Buckeye corpus. In Proceedings of the International Conference on Spoken Language Processing, 2002.
[48] T. S. Saponas, J. Lester, C. Hartung, S. Agarwal, and T. Kohno. Devices that tell on you: privacy trends in consumer ubiquitous computing. In Proceedings of the USENIX Security Symposium, pages 1–16, 2007.
[49] M. R. Schroeder and B. S. Atal. Code-excited linear prediction (CELP): High-quality speech at very low bit rates. In Proceedings of the IEEE International Conference on Acoustics, Speech, and Signal Processing, volume 10, pages 937–940, April 1985.
[50] D. X. Song, D. Wagner, and X. Tian. Timing analysis of keystrokes and timing attacks on SSH. In Proceedings of the USENIX Security Symposium, pages 25–25, 2001.
[51] A. Stolcke. SRILM – an extensible language modeling toolkit. In Proceedings of the ICSLP, volume 2, pages 901–904, 2002.
[52] Q. Sun, D. R. Simon, Y.-M. Wang, W. Russell, V. N. Padmanabhan, and L. Qiu. Statistical identification of encrypted web browsing traffic. In Proceedings of the IEEE Symposium on Security and Privacy, 2002.
[53] J.-M. Valin. The Speex codec manual, 2007.
[54] C. V. Wright, F. Monrose, and G. M. Masson. On inferring application protocol behaviors in encrypted network traffic. Journal of Machine Learning Research, 6:2745–2769, 2006.
[55] C. V. Wright, L. Ballard, F. Monrose, and G. M. Masson. Language identification of encrypted VoIP traffic: Alejandra y Roberto or Alice and Bob? In Proceedings of the USENIX Security Symposium, 2007.
[56] C. V. Wright, L. Ballard, S. E. Coull, F. Monrose, and G. M. Masson. Spot me if you can: Uncovering spoken phrases in encrypted VoIP conversations. In Proceedings of the IEEE Symposium on Security and Privacy, 2008.
[57] C. V. Wright, S. E. Coull, and F. Monrose. Traffic morphing: An efficient defense against statistical traffic analysis. In Proceedings of the Network and Distributed System Security Symposium, 2009.
[58] J. Zobel and P. Dart. Finding approximate matches in large lexicons. Software—Practice and Experience, 25(3):331–345, 1995.
[59] J. Zobel and P. Dart. Fnetik: An integrated system for phonetic matching, 1996. RMIT, Technical Report 96-6.