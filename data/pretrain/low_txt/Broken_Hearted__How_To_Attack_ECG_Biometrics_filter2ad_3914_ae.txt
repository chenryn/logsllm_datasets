### Index for Empirical Distributions and the Kolmogorov-Smirnov Statistic (KS)

We evaluated the performance of our method using the L2 norm, χ² statistic, and Kolmogorov-Smirnov (KS) statistic [5]. The overall success rate (SR) with the L2 norm was 49.9%, while the SRs for the χ² and KS statistics were 29.5% and 39.6%, respectively. These results support our choice of the L2 norm as the primary metric.

### Mapping Strategies

We also evaluated several alternatives to the default mapping functions. Using the default settings, where the mapping is estimated from the entire training dataset and considers all ECG features, resulted in an SR of 26.2%. Slightly worse success rates were observed when some features were not transformed, i.e., left as detected in the source signal: the overall SRs were 22.8%, 21.1%, and 20% when excluding widths, peak intervals, and both, respectively. As expected, the exclusion of amplitude features did not significantly affect the success rate. 

When considering sub-optimal mappings instead of the best mapping function found by the optimization algorithm, the SRs for the second and third best mappings were 21.5% and 21.9%, respectively. We also found that one-to-one mappings estimated from a single subject were largely ineffective for attacking a different subject (SR = 4.4%), confirming the importance of gathering a substantial training dataset. Another alternative that performed poorly (SR = 11.5%) was building a mapping from a single "super-individual," obtained by merging the feature distributions across all subjects.

### Results

We conducted the signal injection attack by combining the building blocks described in the previous sections. After enrolling a user into the Nymi Band, we first injected the raw data collected from each device (see Section IV). Following this, we applied the mapping function, which had been trained on the initial set of users (excluding the user being attacked) to obtain the transformed signals. The mapping function employs random sampling of features to generate the attack signal. We used between 2 and 4 repetitions of this sampling process and reported whether at least one of them was accepted by the Nymi Band. Since the Nymi Band does not limit the number of authentication attempts, the only cost of repetitions lies in the increased time required to carry out the attack.

Due to space constraints, we report only the results of injecting ECG signals by playing back .wav files using an off-the-shelf music player. As discussed in Section III, the performance expected is similar for all three devices, and .wav playback poses the lowest technological barrier for the attacker, both in terms of cost and compactness. The raw results of our analysis are shown in Table II and III, with a summary in Figure 14. For 3 out of 21 users, we were unable to collect high-quality signals using the external electrodes of the ECG monitor, leaving us with 18 attack attempts for the Lead I and Lead II data sources.

Unsurprisingly, the success rate of injecting data collected with the Nymi Band was the highest. With the exception of four users, using this data resulted in unlocking the band, leading to an SR of 81%. In the medical domain, it is necessary to measure multiple ECG leads as they contain different kinds of information, so it is not implausible that this is similar for identifying (biometric) information.

Overall, the attacker's chance of success is 81% if they have obtained a measurement through the Nymi Band and 62% if they have only obtained data from the remaining sources. The latter is computed as the fraction of users for which at least one of the four data sources led to a successful activation of the band (shown in the "Combined" column in Table II and III).

### Related Work

The increasing popularity of biometrics as an authentication mechanism has sparked research into various attacks. Multiple approaches to imitate users or forge measurements have been proposed, including attackers modifying their own behavior and attacks carried out automatically.

Sharif et al. demonstrated an attack on face recognition systems that relies on the attacker wearing a pair of printed eyeglass frames [21]. Their approach enables the attacker to both impersonate a victim and evade face detection. The attack treats the classifier as a whitebox (i.e., assumes knowledge of the internals) and highlights the danger of using machine learning in adversarial settings.

Tey et al. proposed an attack on keystroke dynamics, targeting systems using the biometric for password hardening [25]. The attack assumes the password is known to the attacker, who then has to mimic the legitimate user’s keystroke dynamics while typing it. The authors devised a system that gives positive and negative feedback to the attacker regarding their closeness to being accepted. This feedback relates to individual features, such as character hold times and interkey times. Depending on the information given to the attackers, a false accept rate of up to 99% was achieved, suggesting that it is possible for humans to adapt their own typing patterns enough to fool state-of-the-art systems. However, this approach assumes that both the password and the typing patterns are known, which requires either use of a keylogging device or a password database compromise. Additionally, it is doubtful whether this approach can be adapted to continuous authentication systems that work on free texts rather than short passwords.

Touchscreen input biometrics have gained immense popularity due to the rise of smartphones, tablets, and other touchscreen devices. Zheng et al. proposed an authentication system based on touchscreen input and measured the advantage gained by attackers through observing the victim [27]. The results indicate that simple observation is not enough to trick the system, although their work assumes that the attackers have no specific knowledge of the system’s features. As such, the failed impersonation could be due to insufficient information or the fact that touchscreen inputs are inherently difficult for humans to mimic. Serwadda et al. took a different approach by building a Lego robot to carry out the attack, rather than having a human modify their behavior [20]. Instead of using biometric data from the targeted legitimate user, they created a “catch-all” attack based on population statistics. Using a subset of all users, they trained the robot to perform swipes and scrolls in a way that is sufficiently common for a high number of users. Carrying out the attack increased the system’s Equal Error Rate (EER) by between 339% and 1004%.

At present, authentication systems based on touchscreen inputs are not commercially available, causing the authors to create their own. While they loosely based their features and system design on the popular work by Frank et al. [7], the initial (i.e., before the attack) EER (13%) of the system is much higher even after excluding users exhibiting poor error rates. Unlike a regular single-target imitation attack, the proposed attack targets multiple users at once and therefore requires an overlap between users’ templates that would be unlikely to be found in systems with lower error rates. Thus, it is doubtful whether the described attack is as effective or applicable at all when using state-of-the-art systems.

### Discussion and Countermeasures

In the previous sections, we outlined an effective presentation attack against ECG biometrics in general and demonstrated its effectiveness when applied to the Nymi Band. There are two main approaches to mitigate the attack:

1. **Liveness Detection**: This technique attempts to detect an injected signal and distinguish it from a signal originating from a human. It has been applied with varying degrees of effectiveness for other biometrics. The case of fingerprint readers, in particular, showcases that this is most likely an arms race between system designers considering more indications of liveness (e.g., the presence of skin oils or moisture for fingerprint readers) and attackers spoofing these indicators.

2. **Keeping Biometric Data Secret**: This approach aims to prevent the attacker from obtaining any of the victim’s ECG data. One could argue that the Nymi Band’s SDK should not allow for ECG data to be recorded, either through NEAs or otherwise. Disabling this functionality would make it significantly harder for the attacker to directly obtain data with the correct ECG morphology. As creating the mapping function requires training data from the target device, making this data hard to obtain would also raise the bar to carry out the attack. However, it might still be possible to determine the device-specific effects on the signal by analyzing the hardware, rather than through empirical analysis of recorded signals. As we have demonstrated, the mapping function allows the attacker to obtain data from an arbitrary device and use it to attack the authentication system. While the probability of success somewhat depends on the device, we have demonstrated successful attacks using all of the devices we analyzed. Due to the large variety of devices recording ECG (e.g., medical ECG monitors, fitness devices, e-health) for purposes other than authentication, we do not consider keeping the ECG data secret a viable strategy.

In this work, we applied the mapping function in a way that allows us to attack an ECG-based authentication system with data collected on a different device. However, the same approach can be used to improve the interoperability of a biometric across different devices. For example, once a user is successfully enrolled for one device (e.g., a smartphone for the touchscreen input biometric), they could be authenticated on any other device without the need for re-enrollment, provided a mapping function between these devices has been trained beforehand.

### Conclusion

In this work, we presented a novel presentation attack against ECG biometrics and demonstrated its effectiveness in attacking the Nymi Band. The Nymi Band is a commercially available wristband currently being trialed by MasterCard to authenticate the wearer for contactless payments. After collecting ECG data from 41 volunteers on different devices, we observed that the distributions of biometric features vary between these devices and different ECG measurement positions (Leads). This presents an attacker with difficulties when performing a presentation attack with data gathered on a different device. To address this challenge, we described a so-called mapping function, which transforms ECG signals measured on any device to change its morphology to match that of the Nymi Band. We used half of the subjects in our dataset to train the mapping function while the remainder was set aside to evaluate the actual attack. We used several signal injection methods, including a hardware signal generator and the playback of an ECG signal encoded as a .wav file. As such, the technological barriers to carrying out the attack are extremely low in terms of both cost and hardware requirements.

Our results show that injecting ECG data collected with the Nymi Band shows the highest success rate (81%). When using only the remaining signal sources, we achieve a success rate of 43%, which increases to 62% after applying the mapping function. Our results confirm the seriousness of the attack. Due to the universality of the mapping function and our signal injection devices, we expect the attack to show similar performance against other ECG-based authentication systems. We intend to further explore this once more systems become commercially available.

### Acknowledgements

This work was partially supported by the ERC AdG VERIWARE and the Engineering and Physical Sciences Research Council [grant number EP/M50659X/1]. Andrea Patané contributed to the work during an internship funded by the ERC AdG VERIWARE.

### References

[1] F. Agraﬁoti, D. Hatzinakos, and J. Gao, Heart biometrics: Theory, methods, and applications. INTECH Open Access Publisher, 2011.
[2] B. Barbot, M. Kwiatkowska, A. Mereacre, and N. Paoletti, “Estimation and verification of hybrid heart models for personalized medical and wearable devices,” in Computational Methods in Systems Biology. Springer, 2015, pp. 3–7.
[3] J. Bonneau, “The science of guessing: analyzing an anonymized corpus of 70 million passwords,” in 2012 IEEE Symposium on Security and Privacy (SP). IEEE, 2012, pp. 538–552.
[4] G. D. Clifford, F. Azuaje, and P. McSharry, “ECG statistics, noise, artifacts, and missing data,” Advanced Methods and Tools for ECG Data Analysis, vol. 6, p. 18, 2006.
[5] G. W. Corder and D. I. Foreman, Nonparametric statistics: A step-by-step approach. John Wiley & Sons, 2014.
[6] S. Z. Fatemian, F. Agraﬁoti, and D. Hatzinakos, “HeartID: Cardiac biometric recognition,” in Biometrics: Theory Applications and Systems (BTAS), 2010 Fourth IEEE International Conference on. IEEE, 2010, pp. 1–5.
[7] M. Frank, R. Biedert, E. Ma, I. Martinovic, and D. Song, “Touchalytics: On the applicability of touchscreen input as a behavioral biometric for continuous authentication,” IEEE transactions on information forensics and security, vol. 8, no. 1, pp. 136–148, 2013.
[8] A. Fratini, M. Sansone, P. Bifulco, and M. Cesarelli, “Individual identification via electrocardiogram analysis,” Biomedical engineering online, vol. 14, no. 1, p. 1, 2015.
[9] D. E. Goldberg, Genetic algorithms. Pearson Education India, 2006.
[10] F. E. Grubbs, “Sample criteria for testing outlying observations,” The Annals of Mathematical Statistics, pp. 27–58, 1950.
[11] D. M. Hawkins, “The problem of overfitting,” Journal of chemical information and computer sciences, vol. 44, no. 1, pp. 1–12, 2004.
[12] Z. Li, W. Han, and W. Xu, “A large-scale empirical analysis of Chinese web passwords,” in Proc. 23rd USENIX Security Symposium, USENIX Security (August 2014), 2014.
[13] J. Ma, W. Yang, M. Luo, and N. Li, “A study of probabilistic password models,” in Security and Privacy (SP), 2014 IEEE Symposium on. IEEE, 2014, pp. 689–704.
[14] J. Malmivuo and R. Plonsey, Bioelectromagnetism: principles and applications of bioelectric and biomagnetic fields. Oxford University Press, USA, 1995.
[15] M. L. Mazurek, S. Komanduri, T. Vidas, L. Bauer, N. Christin, L. F. Cranor, P. G. Kelley, R. Shay, and B. Ur, “Measuring password guessability for an entire university,” in Proceedings of the 2013 ACM SIGSAC conference on Computer & communications security. ACM, 2013, pp. 173–186.
[16] P. E. McSharry, G. D. Clifford, L. Tarassenko, L. Smith et al., “A dynamical model for generating synthetic electrocardiogram signals,” Biomedical Engineering, IEEE Transactions on, vol. 50, no. 3, pp. 289–294, 2003.
[17] S. J. Orfanidis, Introduction to signal processing. Prentice-Hall, Inc., 1995.
[18] A. Pantelopoulos and N. G. Bourbakis, “A survey on wearable sensor-based systems for health monitoring and prognosis,” IEEE Transactions on Systems, Man, and Cybernetics, Part C (Applications and Reviews), vol. 40, no. 1, pp. 1–12, 2010.
[19] R. Sameni, M. B. Shamsollahi, C. Jutten, and G. D. Clifford, “A nonlinear Bayesian filtering framework for ECG denoising,” Biomedical Engineering, IEEE Transactions on, vol. 54, no. 12, pp. 2172–2185, 2007.
[20] A. Serwadda and V. V. Phoha, “When kids’ toys breach mobile phone security,” in Proceedings of the 2013 ACM SIGSAC conference on Computer & communications security. ACM, 2013, pp. 599–610.
[21] M. Sharif, S. Bhagavatula, L. Bauer, and M. K. Reiter, “Accessorize to a crime: Real and stealthy attacks on state-of-the-art face recognition,” in Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security. ACM, 2016, pp. 1528–1540.
[22] E. M. Stein and R. Shakarchi, Functional analysis: introduction to further topics in analysis. Princeton University Press, 2011, vol. 4.
[23] E. Stobert and R. Biddle, “The password life cycle: user behavior in managing passwords,” in Proc. SOUPS, 2014.
[24] F. Suﬁ, I. Khalil, and J. Hu, “ECG-based authentication,” in Handbook of Information and Communication Security. Springer, 2010, pp. 309–331.
[25] C. M. Tey, P. Gupta, and D. Gao, “I can be you: Questioning the use of keystroke dynamics as biometrics,” 2013.
[26] H. Wimberly and L. M. Liebrock, “Using fingerprint authentication to reduce system security: An empirical study,” in 2011 IEEE Symposium on Security and Privacy. IEEE, 2011, pp. 32–46.
[27] N. Zheng, K. Bai, H. Huang, and H. Wang, “You are how you touch: User verification on smartphones via tapping behaviors,” in 2014 IEEE 22nd International Conference on Network Protocols. IEEE, 2014, pp. 221–232.