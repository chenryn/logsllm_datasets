### References

- [BDNP08] Assaf Ben-David, Noam Nisan, and Benny Pinkas. *FairplayMP: A System for Secure Multi-Party Computation*. In *CCS*, pages 17–21, 2008.
- [BFK+09] Mauro Barni, Pierluigi Failla, Vladimir Kolesnikov, Riccardo Lazzeretti, Ahmad-Reza Sadeghi, and Thomas Schneider. *Secure Evaluation of Private Linear Branching Programs with Medical Applications*. In *Computer Security (ESORICS)*, pages 424–439, 2009.
- [BFL+09] Mauro Barni, Pierluigi Failla, Riccardo Lazzeretti, Annika Paus, Ahmad-Reza Sadeghi, Thomas Schneider, and Vladimir Kolesnikov. *Efficient Privacy-Preserving Classification of ECG Signals*. In *Information Forensics and Security, 2009. WIFS 2009. First IEEE International Workshop on*, pages 91–95, 2009.
- [BFL+11] Mauro Barni, Pierluigi Failla, Riccardo Lazzeretti, Ahmad-Reza Sadeghi, and Thomas Schneider. *Privacy-Preserving ECG Classification with Branching Programs and Neural Networks*. *IEEE Transactions on Information Forensics and Security (TIFS)*, 6(2):452–468, June 2011.
- [BGV12] Zvika Brakerski, Craig Gentry, and Vinod Vaikuntanathan. *(Leveled) Fully Homomorphic Encryption Without Bootstrapping*. In *ITCS*, pages 309–325, 2012.
- [BHKR13] Mihir Bellare, Viet Tung Hoang, Sriram Keelveedhi, and Phillip Rogaway. *Efficient Garbling from a Fixed-Key Blockcipher*. In *IEEE SP*, pages 478–492, 2013.
- [BL13] K. Bache and M. Lichman. *UCI Machine Learning Repository*, 2013.
- [BLN13] Joppe W. Bos, Kristin Lauter, and Michael Naehrig. *Private Predictive Analysis on Encrypted Medical Data*. In *Microsoft Tech Report 200652*, 2013.
- [BN06] Christopher M. Bishop and Nasser M. Nasrabadi. *Pattern Recognition and Machine Learning*. *Journal of Electronic Imaging*, volume 1, 2006.
- [Can98] Ran Canetti. *Security and Composition of Multi-Party Cryptographic Protocols*. *JOURNAL OF CRYPTOLOGY*, 13:2000, 1998.
- [CMS11] Kamalika Chaudhuri, Claire Monteleoni, and Anand D. Sarwate. *Differentially Private Empirical Risk Minimization*. *J. Mach. Learn. Res.*, 12, 2011.
- [DGK07] Ivan Damgård, Martin Geisler, and Mikkel Krøigaard. *Efficient and Secure Comparison for On-Line Auctions*. In *Information Security and Privacy*, pages 416–430, 2007.
- [DGK09] Ivan Damgård, Martin Geisler, and Mikkel Krøigaard. *A Correction to Efficient and Secure Comparison for On-Line Auctions*. *1(4):323–324, 2009*.
- [DHC04] Wenliang Du, Yunghsiang S. Han, and Shigang Chen. *Privacy-Preserving Multivariate Statistical Analysis: Linear Regression and Classification*. In *Proceedings of the 4th SIAM International Conference on Data Mining*, volume 233, 2004.
- [EFG+09] Zekeriya Erkin, Martin Franz, Jorge Guajardo, Stefan Katzenbeisser, Inald Lagendijk, and Tomas Toft. *Privacy-Preserving Face Recognition*. In *Privacy Enhancing Technologies*, pages 235–253, 2009.
- [FS97] Yoav Freund and Robert E. Schapire. *A Decision-Theoretic Generalization of On-Line Learning and an Application to Boosting*. *Journal of Computer and System Sciences*, (1):119–139, 1997.
- [Gen09] Craig Gentry. *Fully Homomorphic Encryption Using Ideal Lattices*. In *STOC*, pages 169–178, 2009.
- [GLLM04] Bart Goethals, Sven Laur, Helger Lipmaa, and Taneli Mielikäinen. *On Private Scalar Product Computation for Privacy-Preserving Data Mining*. In *Information Security and Cryptology (ICISC)*, pages 104–120, 2004.
- [GLN12] Thore Graepel, Kristin Lauter, and Michael Naehrig. *ML Confidential: Machine Learning on Encrypted Data*. In *Information Security and Cryptology (ICISC)*, pages 1–21, 2012.
- [GM82] Shaﬁ Goldwasser and Silvio Micali. *Probabilistic Encryption and How to Play Mental Poker Keeping Secret All Partial Information*. In *STOC*, pages 365–377. ACM, 1982.
- [GMW87] O. Goldreich, S. Micali, and A. Wigderson. *How to Play Any Mental Game*. In *STOC*, pages 218–229, 1987.
- [Gol04] Oded Goldreich. *Foundations of Cryptography - Basic Applications*. Cambridge University Press, 2004.
- [Hal13] Shai Halevi. *HElib - An Implementation of Homomorphic Encryption*. https://github.com/shaih/HElib, 2013.
- [HKS+10] Wilko Henecka, Stefan Kögl, Ahmad-Reza Sadeghi, Thomas Schneider, and Immo Wehrenberg. *TASTY: Tool for Automating Secure Two-Party Computations*. In *CCS*, pages 451–462, 2010.
- [IPS08] Yuval Ishai, Manoj Prabhakaran, and Amit Sahai. *Founding Cryptography on Oblivious Transfer – Efficiently*. In *Advances in Cryptology – CRYPTO 2008*, volume 5157, pages 572–591, 2008.
- [Kil05] Eike Kiltz. *Unconditionally Secure Constant Round Multi-Party Computation for Equality, Comparison, Bits and Exponentiation*. *IACR Cryptology ePrint Archive*, page 66, 2005.
- [KSS09] Vladimir Kolesnikov, Ahmad-Reza Sadeghi, and Thomas Schneider. *How to Combine Homomorphic Encryption and Garbled Circuits - Improved Circuits and Computing the Minimum Distance Efficiently*. In *1st International Workshop on Signal Processing in the EncryptEd Domain (SPEED’09)*, 2009.
- [KSS13] Vladimir Kolesnikov, Ahmad-Reza Sadeghi, and Thomas Schneider. *A Systematic Approach to Practically Efficient General Two-Party Secure Function Evaluation Protocols and Their Modular Design*. *Journal of Computer Security*, 2013.
- [LLM06] Sven Laur, Helger Lipmaa, and Taneli Mielikäinen. *Cryptographically Private Support Vector Machines*. In *Proceedings of the 12th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining*, pages 618–624. ACM, 2006.
- [LP00] Yehuda Lindell and Benny Pinkas. *Privacy Preserving Data Mining*. In *Advances in Cryptology (CRYPTO)*, pages 36–54, 2000.
- [LP07] Yehuda Lindell and Benny Pinkas. *An Efficient Protocol for Secure Two-Party Computation in the Presence of Malicious Adversaries*. In *Advances in Cryptology (EUROCRYPT)*, volume 4515, pages 52–78, 2007.
- [LP08] Yehuda Lindell and Benny Pinkas. *Secure Multi-Party Computation for Privacy-Preserving Data Mining*. *Crypto ePrint Archive*, 2008.
- [LP09] Yehuda Lindell and Benny Pinkas. *A Proof of Security of Yao’s Protocol for Two-Party Computation*. *J. Cryptol.*, 22:161–188, April 2009.
- [LT05] Hsiao-Ying Lin and Wen-Guey Tzeng. *An Efficient Solution to the Millionaires’ Problem Based on Homomorphic Encryption*. In *Applied Cryptography and Network Security*, pages 456–466, 2005.
- [MNPS04] Dahlia Malkhi, Noam Nisan, Benny Pinkas, and Yaron Sella. *Fairplay: Secure Two-Party Computation System*. In *USENIX Security Symposium*, pages 287–302, 2004.
- [NP01] Moni Naor and Benny Pinkas. *Efficient Oblivious Transfer Protocols*. In *Proceedings of the Twelfth Annual ACM-SIAM Symposium on Discrete Algorithms*, pages 448–457, 2001.
- [Pai99] Pascal Paillier. *Public-Key Cryptosystems Based on Composite Degree Residuosity Classes*. In *EUROCRYPT*, pages 223–238, 1999.
- [RR07] Ali Rahimi and Benjamin Recht. *Random Features for Large-Scale Kernel Machines*. In *NIPS*, 2007.
- [SG11] Anima Singh and John Guttag. *Cardiovascular Risk Stratification Using Non-Symmetric Entropy-Based Classification Trees*. In *NIPS Workshop on Personalized Medicine*, 2011.
- [SG13] Anima Singh and John Guttag. *Leveraging Hierarchical Structure in Diagnostic Codes for Predicting Incident Heart Failure*. In *ICML Workshop on Role of Machine Learning in Transforming Healthcare*, 2013.
- [SSW09] Ahmad-Reza Sadeghi, Thomas Schneider, and Immo Wehrenberg. *Efficient Privacy-Preserving Face Recognition*. In *Information, Security and Cryptology (ICISC)*, pages 229–244, 2009.
- [SV11] Nigel P. Smart and Frederik Vercauteren. *Fully Homomorphic SIMD Operations*. *Cryptology ePrint Archive, Report 2011/133*, 2011.
- [TRMP12] Sebastian Tschiatschek, Peter Reinprecht, Manfred Mücke, and Franz Pernkopf. *Bayesian Network Classifiers with Reduced Precision Parameters*. In *Machine Learning and Knowledge Discovery in Databases*, pages 74–89, 2012.
- [Veu11] Thijs Veugen. *Comparing Encrypted Data*. http://msp.ewi.tudelft.nl/sites/default/files/Comparingencrypteddata.pdf, 2011.
- [VJ01] Paul Viola and Michael Jones. *Rapid Object Detection Using a Boosted Cascade of Simple Features*. In *IEEE Computer Vision and Pattern Recognition (CVPR)*, volume 1, pages I–511, 2001.
- [VKC08] Jaideep Vaidya, Murat Kantarcıoğlu, and Chris Clifton. *Privacy-Preserving Naive Bayes Classification*. *The International Journal on Very Large Data Bases*, 17(4):879–898, 2008.
- [WGH12] Jenna Wiens, John Guttag, and Eric Horvitz. *Learning Evolving Patient Risk Processes for C. diff Colonization*. In *ICML*, 2012.
- [WY04] Rebecca Wright and Zhiqiang Yang. *Privacy-Preserving Bayesian Network Structure Computation on Distributed Heterogeneous Data*. In *Proceedings of the Tenth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining*, pages 713–718, 2004.
- [Yao82] Andrew C. Yao. *Protocols for Secure Computations*. In *FOCS*, pages 160–164, 1982.
- [ZW05] Zhiqiang Yang, Sheng Zhong, and Rebecca N. Wright. *Privacy-Preserving Classification of Customer Data Without Loss of Accuracy*. In *SIAM International Conference on Data Mining (SDM)*, 2005.

### A.1 Comparison with Unencrypted Inputs

Our protocol for comparing encrypted inputs is Protocol 7, and here is some intuition. We follow the main idea from Veugen [Veu11] (found in Section 2.1): compute \(2^l + b - a\) (over encrypted data) and check the \(l + 1\)-th bit (the bit corresponding to the power \(2^l\)). If it is 1, it means that \(b \geq a\), else \(b < a\).

We also assume that the encryption scheme is additively homomorphic. In [Veu11] (Section 2.1), Veugen presents a solution for a similar problem except that A only gets the encrypted bit, not in the clear. So we modify his protocol in Protocol 7.

In the description of Protocol 7, \(N\) is the modulus associated with Paillier's cryptosystem.

**Protocol 7: Comparing Encrypted Data**

- **Input A:** \(\langle a \rangle\) and \(\langle b \rangle\), the bit length \(l\) of \(a\) and \(b\), the secret key \(SK_{QR}\), public key \(PK_P\)
- **Input B:** Secret key \(SK_P\), public key \(PK_{QR}\), the bit length \(l\)
- **Output A:** \((a \leq b)\)

1. \(A: \langle x \rangle \leftarrow \langle b \rangle \cdot \langle 2^l \rangle \cdot \langle a \rangle^{-1} \mod N^2\)
2. \(A\) chooses a random number \(r \leftarrow (0, 2^{\lambda+l}) \cap \mathbb{Z}\)
3. \(A: \langle z \rangle \leftarrow \langle x \rangle \cdot \langle r \rangle \mod N^2\)
4. \(A\) sends \(\langle z \rangle\) to \(B\)
5. \(B\) decrypts \(\langle z \rangle\)
6. \(A: c \leftarrow r \mod 2^l\)
7. \(B: d \leftarrow z \mod 2^l\)
8. With \(A\), \(B\) privately computes the encrypted bit \([t']\) such that \(t = (d < c)\) using DGK
9. \(A\) encrypts \(r^l\) and sends \([r^l]\) to \(B\)
10. \(B\) encrypts \(z^l\)
11. \(B: [t] \leftarrow [t'] \cdot [z^l] \cdot [r^l]\)
12. \(B\) sends \([t]\) to \(A\)
13. \(A\) decrypts and outputs \(t\)

**Blind \(x\)**

We will show the correctness of the protocol and then give a proof of security in the honest-but-curious model using modular composition. For the correctness, we just modify the proof of [Veu11].

**Proposition A.1.** Protocol 7 is correct and secure in the honest-but-curious model.

See proof in Appendix C.

### A.2 Reversed Encrypted Comparison

We constructed Protocol 8, which is the same as Protocol 7, except that the roles of \(A\) and \(B\) are exchanged in Steps 8–13.

**Proposition A.2.** Protocol 8 is secure in the honest-but-curious model.

The proof is in Appendix C.

**Protocol 8: Reversed Comparing Encrypted Data**

- **Input A:** \(\langle a \rangle\) and \(\langle b \rangle\), public keys \(PK_{QR}\) and \(PK_P\)
- **Input B:** Secret keys \(SK_P\) and \(SK_{QR}\)
- **Output B:** \((a \leq b)\)

Run Steps 1–7 of Protocol 7.

8. With \(B\), \(A\) privately computes the encrypted bit \([t']\) such that \(t' = (d < c)\) using DGK
9. \(B\) encrypts \(z^l\) and sends \([z^l]\) to \(A\)
10. \(A\) encrypts \(r^l\)
11. \(A: [t] \leftarrow [t'] \cdot [z^l] \cdot [r^l]\)
12. \(A\) sends \([t]\) to \(B\)
13. \(B\) decrypts and outputs \(t\)

### B. Preliminaries for Proofs

#### B.1 Secure Two-Party Computation Framework

All our protocols are two-party protocols, labeled as party \(A\) and party \(B\). To show that they perform private computations, we work in the honest-but-curious (semi-honest) model as described in [Gol04].

Let \(f = (f_A, f_B)\) be a (probabilistic) polynomial function and \(\Pi\) a protocol computing \(f\). \(A\) and \(B\) want to compute \(f(a, b)\) where \(a\) is \(A\)'s input and \(b\) is \(B\)'s input, using \(\Pi\) and with the security parameter \(\lambda\).

The view of party \(A\) during the execution of \(\Pi\) is the tuple \(V_A(\lambda, a, b) = (1^\lambda; a; r_A; m_{A1}, \ldots, m_{At})\) where \(r_A\) is \(A\)'s random tape and \(m_{A1}, \ldots, m_{At}\) are the messages received by \(A\). We define the view of \(B\) similarly. We also define the outputs of parties \(A\) and \(B\) for the execution of \(\Pi\) on input \((a, b)\) as \(\text{Output}_\Pi^A(\lambda, a, b)\) and \(\text{Output}_\Pi^B(\lambda, a, b)\), and the global output as \(\text{Output}_\Pi(\lambda, a, b) = (\text{Output}_\Pi^A(\lambda, a, b), \text{Output}_\Pi^B(\lambda, a, b))\).

To ensure security, we have to show that whatever \(A\) can compute from its interactions with \(B\) can be computed from its input and output, leading us to the following security definition.

**Definition B.1.** The two-party protocol \(\Pi\) securely computes the function \(f\) if there exist two probabilistic polynomial-time algorithms \(S_A\) and \(S_B\) such that for every possible input \(a, b\) of \(f\),

\[
\{S_A(1^\lambda, a, f_A(a, b)), f(a, b)\} \equiv_c \{V_A(\lambda, a, b), \text{Output}_\Pi(\lambda, a, b)\}
\]

and

\[
\{S_B(1^\lambda, b, f_B(a, b)), f(a, b)\} \equiv_c \{V_B(\lambda, a, b), \text{Output}_\Pi(\lambda, a, b)\}
\]

where \(\equiv_c\) means computational indistinguishability against probabilistic polynomial-time adversaries with negligible probability.