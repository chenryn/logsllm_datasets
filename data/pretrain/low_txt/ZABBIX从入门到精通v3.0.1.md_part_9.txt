### 结束语
Zabbix 提供了 6 个触发器级别，这些级别的名称可以根据需要进行修改。不过，在大多数情况下，默认设置已经足够好用。当然，如果你希望自定义这些级别，也是完全可以的。

### Zabbix 触发器依赖关系详解

#### 概述
在 Zabbix 中，触发器可以设置依赖关系，以避免不必要的报警。例如，如果配置了两个触发器：一个用于检查 `www.ttlsa.com` 是否在线，另一个用于检查该网站的网络是否通畅。当网络出现故障时，即使服务器本身没有问题，也会收到这两个触发器的报警通知。为了避免这种情况，可以在配置 HOST 触发器时增加依赖关系，使其依赖于网络通畅触发器。一旦网络故障，HOST 故障的通知将不会被触发。单个触发器可以依赖多个触发器。

#### 触发器依赖要点
1. **主机之间的依赖**：一台主机的触发器可以依赖另一台主机的触发器，但要避免循环依赖。例如，A 依赖 B，B 依赖 C，C 又依赖 A 的情况会导致无限循环。
2. **模板间的依赖**：一个模板中的触发器可以依赖另一个模板中的触发器。例如，模板 A 的触发器依赖模板 B 的触发器。若某主机链接了模板 A，则必须同时链接模板 B。
3. **主机与模板的依赖**：模板中的触发器可以依赖主机中的触发器。例如，某个模板中的触发器依赖路由器/主机的触发器，所有使用该模板的主机都会继承这种依赖关系。
4. **限制**：主机中的触发器不能直接依赖模板中的触发器。

#### 配置
编辑触发器，选择“Dependencies”选项卡，点击“Add”，选择需要依赖的触发器，然后保存。这样，触发器就会显示其依赖关系。

#### 多个依赖实例
假设有一个网络拓扑结构：Zabbix - Router1 - Router2 - Host。如果 Router1 出现故障，Router2 和 Host 将无法连接。为了防止不必要的报警，可以定义以下依赖关系：
- 'Host is down' 触发器依赖 'Router2 is down' 触发器
- 'Router2 is down' 触发器依赖 'Router1 is down' 触发器

在这种情况下，Zabbix 会递归检查依赖关系。只要其中一个依赖触发器出现问题，当前触发器的状态就不会改变，从而避免发送报警通知。

### Zabbix 单位符号 (Unit Symbols)

#### 概述
Zabbix 支持使用单位符号来简化大数字的表示。例如，可以用 `1d` 表示一天（86400 秒），而不是直接使用 86400 这个数字。

#### 时间单位后缀
- s – 秒
- m – 分钟
- h – 小时
- d – 天
- w – 周

这些单位后缀可以用于触发器表达式、内部项参数和聚合检查中。

#### 单位符号
- K – 千
- M – 兆
- G – 吉
- T – 太

对于非字节单位，基数为 1000；对于字节或每秒字节数单位，基数为 1024。例如，1024 字节会被显示为 1K。

#### 其他单位
- P – 拍
- E – 艾
- Z – 泽
- Y – 尧

#### 使用例子
- `{host:zabbix[proxy,zabbix_proxy,lastaccess]}>120`
- `{host:system.uptime[].last(0)}>2m`

### Functions 函数

#### 概述
触发器函数可以引用检索到的值、当前时间或其他元素。支持的函数列表详见官方文档。

#### Function 参数
许多数值函数可以使用秒作为参数，并且可以通过前缀 `#` 来表示不同的含义。例如：
- `sum(600)`：600 秒内的总和
- `sum(#5)`：最新 5 个值的和
- `last(#2)`：倒数第二新的数据

#### 操作符
- `/` 除
- `*` 乘
- `-` 减
- `+` 加
- `>` 大于
- `<` 小于
- `#` 不等于
- `=` 等于

#### 示例
- **示例一**：`{www.zabbix.com:system.cpu.load[all,avg1].last(0)}>5`
  - 如果 `www.zabbix.com` 主机的 CPU 平均负载值大于 5，触发器状态变为 "problem"。
- **示例二**：`{www.zabbix.com:system.cpu.load[all,avg1].last(0)}>5|{www.zabbix.com:system.cpu.load[all,avg1].min(10m)}>2`
  - 当前 CPU 负载大于 5 或者最近 10 分钟内的 CPU 负载大于 2，触发器状态变为 "problem"。
- **示例三**：`{www.zabbix.com:vfs.file.cksum[/etc/passwd].diff(0)}>0`
  - `/etc/passwd` 文件的校验和发生变化时，触发器状态变为 "problem"。
- **示例四**：`{www.zabbix.com:net.if.in[eth0,bytes].min(5m)}>100K`
  - 当前主机网卡 `eth0` 最近 5 分钟内接收到的流量超过 100KB，触发器状态变为 "problem"。
- **示例五**：`{smtp1.zabbix.com:net.tcp.service[smtp].last(0)}=0&{smtp2.zabbix.com:net.tcp.service[smtp].last(0)}=0`
  - 当 `smtp1.zabbix.com` 和 `smtp2.zabbix.com` 两台主机上的 SMTP 服务器都离线时，触发器状态变为 "problem"。

### Hysteresis（迟滞）

触发器状态从 "problem" 恢复到正常状态可能需要不同的条件。例如：
- **示例一**：`({TRIGGER.VALUE}=0&{server:temp.last(0)}>20)|({TRIGGER.VALUE}=1&{server:temp.last(0)}>15)`
  - 温度超过 20°C 时触发异常，温度降到 15°C 到 20°C 之间时异常解除。
- **示例二**：`({TRIGGER.VALUE}=0&{server:vfs.fs.size[/,free].max(5m)}<10G)|({TRIGGER.VALUE}=1&{server:vfs.fs.size[/,free].min(10m)}>40G)`
  - 剩余磁盘空间小于 10GB 时触发异常，剩余空间大于 40GB 时异常解除。

### Zabbix 事件通知

#### 概述
Zabbix 事件通知是指在发生故障时通过邮件或短信等方式通知管理员。如果没有通知机制，管理员需要手动监控 Zabbix 事件。

#### 通知条件
1. **定义通知介质**：包括电子邮件、Shell 脚本、短信网关等。
2. **配置 Action**：由条件和操作组成。当满足指定条件时，执行相应的操作。

#### 事件来源
- **触发器事件**：触发器状态从 OK 变为 Problem 或从 Problem 变为 OK。
- **发现事件**：低级发现规则状态变化。
- **内部事件**：监控项状态从 normal 变为 unsupported 或反之。
- **自动注册事件**：自动注册过程中发生的事件。

希望这些优化后的文本能够帮助你更好地理解和使用 Zabbix 的触发器依赖关系和单位符号。