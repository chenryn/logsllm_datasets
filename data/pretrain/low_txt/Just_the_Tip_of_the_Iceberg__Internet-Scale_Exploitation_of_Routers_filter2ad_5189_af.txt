### Analysis of Innovation and Earnings in Router Infections

Interestingly, despite the varying levels of innovation embraced by different actors, we find that innovation and a first-mover advantage do not necessarily translate into higher earnings. For instance, the actor with the key `hsFAjj`, who was among the first to dominate proxying and control extensive infrastructure, did not generate earnings at the same rate as the key `6a9929`. The latter actor, who used public lists to identify and infect vulnerable routers, achieved higher revenue. Additionally, the number of infected routers is not a reliable indicator of an adversary's revenue, as the type and size of the router matter more than the sheer number of compromised devices. Table 6 illustrates this point, showing that the volume of routers under control does not correlate with monetary success. Another unexpected finding is that out of the top 10 most profitable routers, 6 are located in Iraq, with one each in Turkey, France, Brazil, and the Netherlands. This distribution is counterintuitive given the global distribution of MikroTik installations.

### Charting the Ecosystem of Actors

In examining the lifecycle of router infections, we observe varying levels of sophistication at each stage. During the identification phase, we distinguish between siteKeys installed through scanning and those based on public sources like Shodan. In the exploitation phase, the landscape is dynamic, with actors regularly infecting new devices and stealing from one another. Post-infection, only a few actors demonstrate a high level of sophistication by setting up robust infrastructures. Initially, these actors set up HTTP proxies but later increased their revenues by installing SOCKS proxies with cryptojacking scripts. The cryptomining scripts used vary, and there is a continuous cycle of router infections and removals. Geographical differences in mining characteristics are also evident, with Brazil and Indonesia being the most infected, while Iraq appears to have the most lucrative infrastructure for infection. Maintenance patterns show that specific anonymized IPs can be linked to siteKeys based on their behavior.

### Linking Actors and SiteKeys

Based on the analysis of different independent components, we can link certain siteKeys to each other and/or to specific IPs. For example, three siteKeys—`hsFAjj`, `SK_LCx`, and `oDcuak`—exhibit similar behavior, sharing the same infrastructural patterns and regular contacts with the same set of attacker IPs for maintenance over SSH. Figure 10 confirms this by showing numerous routers transitioning between these siteKeys. The analysis of SOCKS traffic also links `J3rjnv` to this set. Furthermore, the actor behind siteKey `4983e3` demonstrates a high level of sophistication by hijacking routers infected with other siteKeys and then changing their own siteKey to a masked variant, as shown in Figure 9. Revisiting Figure 13, which shows four clear sequential blocks of 10 siteKeys with similar installation sizes and evolutionary patterns, and combining it with the aforementioned figure, which shows five clear siteKey transition chains, we can link a larger number of siteKeys to a single adversary. By following each siteKey within these transition chains in Figure 10, we see that these transitions correspond to the sequential blocks in Figure 13. All the siteKeys in the transition chains are located within these blocks in the same sequence. For each of the siteKeys inside these four blocks, the first two (highlighted in green in Figure 13) use a Coinhive miner with the uncommon option `CoinHive.FORCE_EXCLUSIVE_TAB` enabled, while the latter two (highlighted in yellow) use Omine as a mining service. Additionally, all 40 mining scripts within these blocks were set to the same throttle value of 0.1. This common behavior across multiple siteKeys strongly suggests that these 40 siteKeys can be linked to a single actor.

### Conclusion

In this paper, we report on a new attack vector for cryptojacking, which targets Internet infrastructure rather than websites. This vector has a significantly larger installation size compared to any known cryptojacking campaigns, with groups of actors compromising approximately 1.4 million vulnerable routers, or about 70% of all deployed MikroTik routers, with varying degrees of sophistication. As the injection of miners into network traffic affects any user visiting any website, this attack vector is highly profitable, estimated to generate over $1.2 million per month in revenue for the top 10 actors. Surprisingly, innovation and the first-mover advantage do not necessarily lead to higher revenue. The highest-earning actors are not those creating new monetization options or deploying the most sophisticated infrastructure, but those who find the most productive niche where they can operate relatively undisturbed.

In April 2019, Interpol began an investigation into the cryptojacking campaigns using MikroTik routers to identify the perpetrators, clean up the infected routers, and take down the supporting infrastructure. To assist with this effort, the research team has shared the results and additional findings with the involved law enforcement agencies.

### References

[1] Agrawal, R., Srikant, R., et al. Fast algorithms for mining association rules. In Proc. 20th int. conf. very large data bases, VLDB (1994), vol. 1215, pp. 487–499.
[2] Bijmans, H. L., Booij, T. M., and Doerr, C. Inadvertently making cyber criminals rich: A comprehensive study of cryptojacking campaigns at internet scale. In Usenix Security Symposium (2019).
[3] Bilge, L., and Dumitras, T. Before we knew it: An empirical study of zero-day attacks in the real world. In ACM Conference on Computer and Communications Security (2012).
[4] Blenn, N., Ghiette, V., and Doerr, C. Quantifying the spectrum of denial-of-service attacks through internet backscatter. In International Conference on Availability, Reliability and Security (ARES) (2017).
[5] Carlin, D., O’Kane, P., Sezer, S., and Burgess, J. Detecting cryptomining using dynamic analysis. In Annual Conference on Privacy, Security and Trust (2018).
[6] Christopher, N. Hackers mined a fortune from Indian websites, Sep 2018. https://economictimes.indiatimes.com/small-biz/startups/newsbuzz/hackers-mined-a-fortune-from-indian-websites/articleshow/65836088.cms (December 2018).
[7] Cimpanu, C. A mysterious grey-hat is patching people’s outdated MikroTik routers, Oct 2018. https://www.zdnet.com/article/a-mysterious-grey-hat-is-patching-peoples-outdated-mikrotik-routers/ (February 2019).
[8] Claburn, T. Crypto-jackers enlist Google Tag Manager to smuggle alt-coin miners, Jan 2018. https://www.theregister.co.uk/2017/11/22/cryptojackers_google_tag_manager_coin_hive/ (December 2018).
[9] CSIRT, N. MikroTik Routers Compromised in Cryptojacking Campaign, Apr 2019. https://csirt.cy/mikrotik-routers-compromised-in-cryptojacking-campaign/ (April 2019).
[10] Durumeric, Z., Adrian, D., Mirian, A., Bailey, M., and Halderman, J. A. A search engine backed by Internet-wide scanning. In 22nd ACM Conference on Computer and Communications Security (Oct. 2015).
[11] Enge, E. Mobile vs Desktop Traffic in 2019, Apr 2019. https://www.stonetemple.com/mobile-vs-desktop-usage-study/ (May 2019).
[12] Eskandari, S., Leoutsarakos, A., Mursch, T., and Clark, J. A first look at browser-based cryptojacking. European Symposium on Security and Privacy Workshops (2018).
[13] Ghiette, V., and Doerr, C. How media reports trigger copycats: An analysis of the brewing of the largest packet storm to date. In ACM SIGCOMM Workshop on Traffic Measurements for Cybersecurity (WTMC) (2018).
[14] Hoffman, J. J., Lee, S. C., and Jacobson, J. S. New Jersey Division of Consumer Affairs obtains settlement with developer of Bitcoin-mining software found to have accessed New Jersey computers without users’ knowledge or consent, May 2015. https://nj.gov/oag/newsreleases15/pr20150526b.html.
[15] Hong, G., Yang, Z., Yang, S., Zhang, L., Nan, Y., Zhang, Z., Yang, M., Zhang, Y., Qian, Z., and Duan, H. How you get shot in the back: A systematical study about cryptojacking in the real world. In SIGSAC Conference on Computer and Communications Security (2018).
[16] Huang, D. Y., Dharmdasani, H., Meiklejohn, S., Dave, V., Grier, C., McCoy, D., Savage, S., Weaver, N., Snoeren, A. C., and Levchenko, K. Botcoin: Monetizing stolen cycles. In 21st Annual Network and Distributed System Security Symposium, NDSS 2014, San Diego, California, USA, February 23-26, 2014 (2014).
[17] Kharraz, A., Ma, Z., Murley, P., Lever, C., Mason, J., Miller, A., Borisov, N., Antonakakis, M., and Bailey, M. Outguard: Detecting in-browser covert cryptocurrency mining in the wild.
[18] Konoth, R. K., Vineti, E., Moonsamy, V., Lindorfer, M., Kruegel, C., Bos, H., and Vigna, G. Minesweeper: An in-depth look into drive-by cryptocurrency mining and its defense. In SIGSAC Conference on Computer and Communications Security (2018).
[19] MaxMind, Inc. MaxMind GeoIP2. https://www.maxmind.com/en/geoip2-services-and-databases/ (April 2019).
[20] McCarthy, K. CBS’s Showtime caught mining crypto-coins in viewers’ web browsers, Jan 2018. https://www.theregister.co.uk/2017/09/25/showtime_hit_with_coinmining_script/ (December 2018).
[21] MineCryptoNight. MineCryptoNight - Making mining profits great again! https://minecryptonight.net/ (May 2019).
[22] Murphy, M. YouTube shuts down hidden cryptojacking adverts, Jan 2018. https://www.telegraph.co.uk/technology/2018/01/29/youtube-shuts-hidden-crypto-jacking-adverts/ (November 2018).
[23] Mursch, T. Over 100,000 Drupal websites vulnerable to Drupalgeddon 2 (CVE-2018-7600), Jun 2018. https://badpackets.net/over-100000-drupal-websites-vulnerable-to-drupalgeddon-2-cve-2018-7600/.
[24] Nakamoto, S. Bitcoin: A peer-to-peer electronic cash system, 2009.
[25] NetLab360. Quick summary about the Port 8291 scan, Mar 2018. https://blog.netlab.360.com/quick-summary-port-8291-scan-en/ (April 2019).
[26] NIST National Vulnerability Database. NVD - CVE-2018-14847 Detail, Jul 2018. https://nvd.nist.gov/vuln/detail/CVE-2018-14847.
[27] Papadopoulos, P., Ilia, P., and Markatos, E. P. Truth in web mining: Measuring the profitability and cost of cryptominers as a web monetization model. CoRR abs/1806.01994 (2018).
[28] Pastrana, S., and Suarez-Tangil, G. A first look at the crypto-mining malware ecosystem: A decade of unrestricted wealth. CoRR abs/1901.00846 (2019).
[29] Proxy Lists 24. Proxy Lists 24 - Daily Free Proxy Server Lists. http://www.proxyserverlist24.top/ (April 2019).
[30] Rauchberger, J., Schrittwieser, S., Dam, T., Luh, R., Buhov, D., Pötzelsberger, G., and Kim, H. The other side of the coin: A framework for detecting and analyzing web-based cryptocurrency mining campaigns. In International Conference on Availability, Reliability and Security (2018).
[31] Rodriguez, J. D. P., and Posegga, J. RAPID: resource and API-based detection against in-browser miners. Annual Computer Security Applications Conference (2018).
[32] Rüth, J., Zimmermann, T., Wolsing, K., and Hohlfeld, O. Digging into browser-based crypto mining. In Internet Measurement Conference (2018).
[33] Schwartz, M. J. Cryptojackers keep hacking unpatched MikroTik routers, Oct 2018. https://www.bankinfosecurity.com/cryptominers-keep-hacking-unpatched-mikrotik-routers-a-11627 (April 2019).
[34] Segura, J. A look into Drupalgeddon’s client-side attacks, Jun 2018. https://blog.malwarebytes.com/threat-analysis/2018/05/look-drupalgeddon-client-side-attacks/ (December 2018).
[35] Shodan. Shodan - The search engine for Internet-connected devices. https://www.shodan.io/.
[36] SimilarWeb. Similar Web. Website traffic statistics & market intelligence. https://www.similarweb.com (May 2019).
[37] SonicWall. Massive cryptojacking campaign compromised ~200,000 MikroTik routers, Aug 2018. https://securitynews.sonicwall.com/xmlpost/massive-cryptojacking-campaign/ (March 2019).
[38] Tenable. MikroTik RouterOS vulnerabilities: There’s more to CVE-2018-14847, Oct 2018. https://www.tenable.com/blog/mikrotik-routeros-vulnerabilities-there-s-more-to-cve-2018-14847 (March 2019).
[39] The Monero Project. Monero: What is Monero (XMR)? https://www.getmonero.org/get-started/what-is-monero/ (December 2018).
[40] The Pirate Bay. The Pirate Bay - miner, Sep 2017. https://thepiratebay.org/blog/242.
[41] Wang, W., Ferrell, B., Xu, X., Hamlen, K. W., and Hao, S. SEISMIC: Secure in-lined script monitors for interrupting cryptojacks. In Computer Security - 23rd European Symposium on Research in Computer Security, ESORICS 2018, Barcelona, Spain, September 3-7, 2018, Proceedings, Part II (2018), pp. 122–142.
[42] Wordfence.com. WordPress plugin banned for crypto mining, Nov 2017. https://www.wordfence.com/blog/2017/11/wordpress-plugin-banned-crypto-mining/ (January 2019).
[43] Xu, J., Fan, J., Ammar, M., and Moon, S. B. On the design and performance of prefix-preserving IP traffic trace anonymization. In ACM SIGCOMM Workshop on Internet Measurement (2001).