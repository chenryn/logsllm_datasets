### References

1. **BCM4339: Single-Chip 5G WiFi IEEE 802.11ac MAC/Baseband/Radio with Integrated Bluetooth 4.1 and FM Receiver**
   - **Author:** Cypress Semiconductor Corporation
   - **Date:** March 2017
   - **Revision:** *H
   - **Source:** [Link](https://www.cypress.com/file/298336/download)

2. **AN214852 - Collaborative Coexistence Interface Between Cypress-to-Cypress Solutions and Cypress-to-third-party Chips**
   - **Author:** Cypress Semiconductor Corporation
   - **Date:** March 2018
   - **Source:** [Link](https://www.cypress.com/file/298336/download)

3. **WICED Software**
   - **Author:** Cypress Semiconductor Corporation
   - **Date:** 2021
   - **Source:** [Link](https://www.cypress.com/products/wiced-software)

4. **owfuzz**
   - **Author:** E7mer
   - **Date:** November 2021
   - **Source:** [GitHub](https://github.com/alipay/Owfuzz)

5. **Polypyus–the firmware historian**
   - **Authors:** J. Friebertshäuser, F. Kosterhon, J. Classen, M. Hollick
   - **Conference:** Workshop on Binary Analysis Research (BAR) 2021
   - **Date:** February 2020

6. **BrakTooth: Causing Havoc on Bluetooth Link Manager**
   - **Authors:** M. E. Garbelini, S. Chattopadhyay, V. Bedi, S. Sun, E. Kurniawan
   - **Date:** August 2021
   - **Source:** [Link](https://asset-group.github.io/disclosures/braktooth/)

7. **SweynTooth: Unleashing Mayhem over Bluetooth Low Energy**
   - **Authors:** M. E. Garbelini, C. Wang, S. Chattopadhyay, S. Sumei, E. Kurniawan
   - **Conference:** 2020 USENIX Annual Technical Conference (USENIX ATC 20)
   - **Date:** July 2020
   - **Pages:** 911–925

8. **There’s Life in the Old Dog Yet: Tearing New Holes into Intel/iPhone Cellular Modems**
   - **Author:** N. Golde
   - **Date:** April 2018
   - **Source:** [Link](https://comsecuris.com/blog/posts/theres-life-in-the-old-dog-yet-tearing-new-holes-into-inteliphone-cellular-modems/)

9. **Exploiting Qualcomm WLAN and Modem Over The Air**
   - **Authors:** X. Gong, P. Pi
   - **Conference:** DEF CON 27
   - **Date:** August 2019

10. **Over the Air Baseband Exploit: Gaining Remote Code Execution on 5G Smartphones**
    - **Authors:** M. Grassi, X. Chen
    - **Conference:** BlackHat USA 2021
    - **Date:** August 2021

11. **Rowhammer.js: A remote software-induced fault attack in JavaScript**
    - **Authors:** D. Gruss, C. Maurice, S. Mangard
    - **Conference:** International conference on detection of intrusions and malware, and vulnerability assessment
    - **Publisher:** Springer
    - **Date:** 2016
    - **Pages:** 300–321

12. **Burned in Ashes: Baseband Fairy Tale Stories**
    - **Author:** Guy
    - **Conference:** REcon
    - **Date:** June 2019

13. **Emulating Samsung’s Baseband for Security Testing**
    - **Authors:** G. Hernandez, M. Muench
    - **Conference:** BlackHat USA 2020
    - **Date:** August 2020

14. **IEEE 802.11i-2004: Amendment 6: Medium Access Control (MAC) Security Enhancements**
    - **Author:** IEEE
    - **Date:** 2004

15. **Intel Wireless-AC 9560 Product Brief**
    - **Author:** Intel
    - **Date:** 2020
    - **Source:** [Link](https://www.intel.com/content/dam/www/public/us/en/documents/product-briefs/dual-band-wireless-ac-9560-brief.pdf)

16. **Flipping Bits in Memory without Accessing Them: An Experimental Study of DRAM Disturbance Errors**
    - **Authors:** Y. Kim, R. Daly, J. Kim, C. Fallin, J. H. Lee, D. Lee, C. Wilkerson, K. Lai, O. Mutlu
    - **Conference:** Proceedings of the 41st Annual International Symposium on Computer Architecture (ISCA '14)
    - **Publisher:** IEEE Press
    - **Date:** 2014
    - **Pages:** 361–372

17. **Spectre Attacks: Exploiting Speculative Execution**
    - **Authors:** P. Kocher, J. Horn, A. Fogh, D. Genkin, D. Gruss, W. Haas, M. Hamburg, M. Lipp, S. Mangard, T. Prescher, M. Schwarz, Y. Yarom
    - **Conference:** Proceedings of the IEEE Symposium on Security and Privacy (S&P)
    - **Date:** 2019
    - **Pages:** 1–19

18. **How To Tame Your Unicorn - Exploring and Exploiting Zero-Click Remote Interfaces of Modern Huawei Smartphones**
    - **Authors:** D. Komaromy, L. Szabo
    - **Conference:** BlackHat USA 2021
    - **Date:** August 2021

19. **Finding New Bluetooth Low Energy Exploits via Reverse Engineering Multiple Vendors’ Firmwares**
    - **Author:** V. Kovah
    - **Conference:** BlackHat USA 2020
    - **Date:** August 2020

20. **LTE and Bluetooth In-Device Coexistence with WLAN. Application Note**
    - **Authors:** D. Liebl, B. Schulz
    - **Source:** [Link](https://scdn.rohde-schwarz.com/ur/pws/dl-downloads/dl-application/application-notes/1ma255/1MA2552e-Coex-LTE-BT-WLAN.pdf)
    - **Publisher:** Rhode & Schwarz

21. **Meltdown**
    - **Authors:** M. Lipp, M. Schwarz, D. Gruss, T. Prescher, W. Haas, S. Mangard, P. Kocher, D. Genkin, Y. Yarom, M. Hamburg
    - **Date:** January 2018
    - **Source:** arXiv.org e-Print archive

22. **BaseSAFE: Baseband SAnitized Fuzzing through Emulation**
    - **Authors:** D. Maier, L. Seidel, S. Park
    - **Conference:** The 13th ACM Conference on Security and Privacy in Wireless and Mobile Networks (WiSec '20)
    - **Date:** July 2020

23. **InternalBlue - Bluetooth Binary Patching and Experimentation Framework**
    - **Authors:** D. Mantz, J. Classen, M. Schulz, M. Hollick
    - **Conference:** The 17th Annual International Conference on Mobile Systems, Applications, and Services (MobiSys '19)
    - **Date:** June 2019

24. **Exploring the MediaTek Baseband**
    - **Authors:** Marco Grassi, Kira
    - **Source:** [Link](https://www.offensivecon.org/speakers/2020/marco-grassi-kira.html)
    - **Date:** February 2020

25. **MT7632U Datasheet**
    - **Author:** MediaTek
    - **Date:** April 2016
    - **Source:** [Link](http://trolink.cn/UploadFiles/Product/20160419152038-94108.pdf)

26. **Broken-Strokes: On the (in)Security of Wireless Keyboards**
    - **Authors:** G. Oligeri, S. Sciancalepore, S. Raponi, R. Di Pietro
    - **Conference:** The 13th ACM Conference on Security and Privacy in Wireless and Mobile Networks (WiSec '20)
    - **Date:** 2020

27. **PAN9026 Wi-Fi/BT Module with Marvell 88W8977 WLAN 2.4/5 GHz and Bluetooth single-chip solution inside (Rev 1.2)**
    - **Author:** Panasonic
    - **Date:** January 2020
    - **Source:** [Link](https://media.digikey.com/pdf/Data%20Sheets/Panasonic%20Semiconductors%20ICs%20PDFs/PAN9026-Series-Rev1.2.pdf)

28. **QCA6234 Integrated Dual-Band 2x2 80211n + Bluetooth 4.0**
    - **Author:** Qualcomm
    - **Date:** 2016
    - **Source:** [Link](https://developer.qualcomm.com/qfile/28871/lm80-p0598-12-qca6234-datasheet.pdf)

29. **CVE 2019-11516 PoC**
    - **Author:** J. Ruge
    - **Date:** September 2019
    - **Source:** [GitHub](https://github.com/seemoo-lab/frankenstein/blob/master/projects/CYW20735B1/patch/CVE-2019-11516.c)

30. **CVE-2020-0022 an Android 8.0-9.0 Bluetooth Zero-Click RCE – BlueFrag**
    - **Author:** J. Ruge
    - **Date:** February 2020
    - **Source:** [Link](https://insinuator.net/2020/04/cve-2020-0022-an-android-8-0-9-0-bluetooth-zero-click-rce-bluefrag/)

31. **Frankenstein: Advanced Wireless Fuzzing to Exploit New Bluetooth Escalation Targets**
    - **Authors:** J. Ruge, J. Classen, F. Gringoli, M. Hollick
    - **Conference:** 29th USENIX Security Symposium (USENIX Security 19)
    - **Date:** August 2020

32. **A Spectre Proof-of-Concept for Spectre**
    - **Author:** S. Röttger
    - **Date:** August 2021
    - **Source:** [Link](https://security.googleblog.com/2021/03/a-spectre-proof-of-concept-for-spectre.html)

33. **Teaching Your Wireless Card New Tricks: Smartphone Performance and Security Enhancements Through Wi-Fi Firmware Modifications**
    - **Author:** M. Schulz
    - **Type:** Ph.D. dissertation
    - **Institution:** Technische Universität
    - **Date:** 2018

34. **Nexmon: The C-based Firmware Patching Framework**
    - **Authors:** M. Schulz, D. Wegemer, M. Hollick
    - **Date:** 2017
    - **Source:** [Link](https://nexmon.org)

35. **AN1128: Bluetooth Coexistence with Wi-Fi, Rev. 1.6**
    - **Author:** Silicon Labs
    - **Date:** December 2020
    - **Source:** [Link](https://www.silabs.com/documents/public/application-notes/an1128-bluetooth-coexistence-with-wifi.pdf)

36. **Wi-Fi Coexistence with Other 2.4 GHz Radio Protocols**
    - **Author:** Silicon Labs
    - **Date:** January 2021
    - **Source:** [Link](https://docs.silabs.com/wifi/wf200/content-source/application-note/wifi-coexistence)

37. **Timing Analysis of Keystrokes and Timing Attacks on SSH**
    - **Authors:** D. X. Song, D. A. Wagner, X. Tian
    - **Conference:** USENIX Security Symposium
    - **Date:** 2001

38. **Improving the Reliability of Bluetooth Low Energy Connections**
    - **Authors:** M. Spörk, J. Classen, C. A. Boano, M. Hollick, K. Römer
    - **Conference:** EWSN
    - **Date:** 2020
    - **Pages:** 144–155

39. **A Billion Open Interfaces for Eve and Mallory: MitM, DoS, and Tracking Attacks on iOS and macOS Through Apple Wireless Direct Link**
    - **Authors:** M. Stute, S. Narain, A. Mariotto, A. Heinrich, D. Kreitschmann, G. Noubir, M. Hollick
    - **Conference:** 28th USENIX Security Symposium (USENIX Security 19)
    - **Location:** Santa Clara, CA
    - **Date:** August 2019
    - **Pages:** 37–54

40. **CC3235S and CC3235SF SimpleLink Wi-Fi, Dual-Band, Single-Chip Solution Datasheet (Rev. B)**
    - **Author:** Texas Instruments
    - **Date:** January 2020
    - **Source:** [Link](http://www.ti.com/lit/ds/symlink/cc3235s.pdf)

41. **Overview of SECI**
    - **Author:** VinayakS 26
    - **Date:** April 2018
    - **Source:** [Link](https://community.cypress.com/community/wiced-wifi/wiced-wifi-forums/blog/2018/04/03/overview-of-seci)

42. **Coexistence Throughput Test**
    - **Author:** VinayakS 26
    - **Date:** March 2019
    - **Source:** [Link](https://community.cypress.com/community/wiced-wifi/wiced-wifi-forums/blog/2019/03/29/coexistence-throughput-test)

43. **Dive into Apple IO80211FamilyV2**
    - **Author:** Y. Wang
    - **Conference:** BlackHat USA 2020
    - **Date:** August 2020

44. **LightBlue: Automatic Profile-Aware Debloating of Bluetooth Stacks**
    - **Authors:** J. Wu, R. Wu, D. Antonioli, M. Payer, N. O. Tippenhauer, D. Xu, D. J. Tian, A. Bianchi
    - **Conference:** 30th USENIX Security Symposium (USENIX Security 21)
    - **Date:** August 2021
    - **Pages:** 339–356
    - **Source:** [Link](https://www.usenix.org/conference/usenixsecurity21/presentation/wu-jianliang)

45. **Overview of IEEE 802.15.2: Coexistence of Wireless Personal Area Networks with Other Unlicensed Frequency Bands Operating Wireless Devices**
    - **Authors:** Y. Xiao, Y. Pan
    - **Publisher:** IEEE
    - **Date:** 2009
    - **Pages:** 135–150

46. **Multi-Radio Coexistence: Challenges and Opportunities**
    - **Authors:** J. Zhu, A. Waltho, X. Yang, X. Guo
    - **Conference:** 2007 16th International Conference on Computer Communications and Networks
    - **Date:** 2007
    - **Pages:** 358–364

### Appendix

#### A. Additional Information on Broadcom and Cypress Vulnerabilities

This appendix provides detailed information about the vulnerabilities in Broadcom and Cypress chips discussed in this paper. The sections include vendor-specific address ranges for leaking information or executing code (Section A-A), SECI protocol details (Section A-B), and analysis of the Bluetooth write RAM mitigation (Section A-C).

##### A. WLAN RAM Sharing

**WLAN RAM Sharing** enables code execution by mapping Wi-Fi RAM into Bluetooth. The address range for this mapping is shown in Table V. The memory region is not always fully mapped, and reading from it can sometimes crash the Bluetooth firmware. Writing to shared RAM is more stable and transparent.

- **Reading RAM:** Reading from the memory area starting at `wlan_mem_base` often shows repeating chunks and zero padding. The exact behavior depends on the chip.
- **Writing RAM:** Writing to the memory-mapped area via Bluetooth will immediately appear in the Wi-Fi RAM. For example, writing to Bluetooth address `0x680000` appears in Wi-Fi memory starting from `0x10000`.

**Code Execution Examples:**
- **BCM4377B3 (MacBook 2020, macOS 10.15.7):** Writing to Bluetooth address `0x68cbfc` executes code in Wi-Fi.
- **BCM43475B1 (Samsung Galaxy S10/S20, Android 10, March 2020):** Writing to `0x681024` is exploitable.

**Kernel Panics:**
- **BCM43475B1 (Samsung Galaxy S10/S20, Android 9, May 2019):** Writing random bytes causes kernel panics and driver issues.
- **BCM4347B0 (Samsung Galaxy S8, Android 9):** Similar behavior, including kernel panics due to failed Wi-Fi power-up attempts.
- **iPhone 6 (iOS 12.5.1):** Immediate kernel panic when writing random bytes.
- **iPhone 8 (iOS 13):** Malformed PCIe IOMMU requests.

##### B. SECI Protocol Internals

**SECI Protocol Reverse-Engineering:**
- **Bluetooth Hardware Mapping:** Symbols extracted from WICED Studio 6.2 provide mappings for the SECI registers. Bluetooth receives a 64-bit value in `gci_input` and sends information via `gci_output`.
- **Wi-Fi Hardware Mapping:** The Wi-Fi firmware maps SECI registers in a `chipcregs_t` struct. Macros like `NOTIFY_BT_CHL` and `NOTIFY_BT_BW_20` are used to notify Wi-Fi about the current 2.4 GHz channel and bandwidth.

**Tables:**
- **Table V: Shared RAM Mapping**
  - **Bluetooth Symbol:** `wlan_mem_base`
  - **Bluetooth Address:** `0x680000`
  - **Wi-Fi Address:** `0x180000`

- **Table VI: Coexistence Register Mapping in Bluetooth**
  - **Address Range:** `0x650000–0x6507ff`
  - **Registers:** `gci_input`, `gci_output`

##### C. Write RAM Mitigation

**Write RAM Mitigation:**
- **Patch Removal:** The operating system's driver patches the base firmware in RAM during initialization. Removing these patches confirms that the actual privilege escalation remains unpatched.
- **Vendor-Specific Patches:**
  - **iOS:** Write_RAM was disabled in iOS 13.5 but still present in iOS 13.3. As of iOS 14.3, the patches are embedded in the BlueTool binary.
  - **Samsung:** .hcd format patches removed Write_RAM and Read_RAM handlers starting from Android 10 (March 2020) and Android 9 (June 2020).
  - **macOS:** Write_RAM was removed in Big Sur; Catalina versions still allow it.
  - **Raspberry Pi:** Patch slots are exhausted, and patches are typically not shipped.

**Impact:**
- The minimal Write_RAM patch only covers operating system to chip attacks, slowing down security testing and patch confirmation. Over-the-air attackers can still escalate privileges from Bluetooth to Wi-Fi.