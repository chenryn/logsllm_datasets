# Title: POSTER: Mining Elephant Applications in Unknown Traffic by Service Clustering

## Authors:
- Hongliang Yu, School of Computer Science, Beijing University of Posts and Telecommunications, China (PI: EMAIL)
- Yong Zhao, Gang Xiong, Li Guo, Zhen Li, Institute of Information Engineering, Chinese Academy of Sciences, China (PI: EMAIL)
- Yong Wang, The National Computer Network Emergency Response Technical Team/Coordination Center of China (PI: EMAIL)

## Abstract
Network traffic classification is crucial for fine-grained network management and security. However, the rapid development of new network applications has led to an increasing amount of unidentified traffic, posing significant challenges for network operators. Most of this unknown traffic is generated by a few or specific types of applications, referred to as "elephant traffic." It is generally accepted that traffic sharing the same server IP and port is generated by the same application, which we define as a "service." In this paper, we propose a novel method using service-based statistical features for cluster analysis to classify elephant traffic. Preliminary results on a real network traffic dataset show that our method can automatically identify similar unknown applications. We believe that classifying unknown traffic from a service perspective is a promising direction.

## Categories and Subject Descriptors
C.2.3 [Computer Communication Networks]: Network monitoring; Network management

## Keywords
Service, Unknown Traffic, Traffic Classification, Elephant Applications

## 1. Introduction
Traffic classification is fundamental for effective network management and security. To manage and operate networks efficiently, operators need a clear understanding of application protocols in network traffic. In recent years, the emergence of new network applications, many of which use proprietary application layer protocols, has increased the proportion of unidentified traffic. Additionally, attackers often disguise malicious traffic to bypass detection systems, making it essential to study unidentified traffic, describe unknown traffic, identify new protocols or applications, and detect malicious traffic.

J. Zhang et al. proposed methods to identify unknown applications, referring to them as "zero-day" applications [1, 2, 3]. This paper addresses the issue of unknown traffic classification and introduces the first attempt to use service statistical features for this purpose. Since obtaining fingerprints of unknown protocols is challenging, we employ machine learning methods for traffic classification. These methods are based on statistical features and can be categorized into supervised and unsupervised methods. Unsupervised methods, which do not require pre-labeled samples, are more suitable for unknown traffic classification.

## 2. The Proposed Approach
To classify unidentified traffic and identify new protocols, we propose a service-based clustering method. Our approach assumes that a host provides a specific service on a stable port over a certain time period. We define a service as a pair of a server IP and port in a TCP session. Our clustering method uses k-means algorithm due to its good performance and lower computational complexity.

### 2.1 Getting Unknown Traffic
We restructure raw IP packets into TCP flows and identify these flows using a Deep Packet Inspection (DPI) system. This process filters out unknown traffic, resulting in a set of unknown flows.

### 2.2 Extracting Service Statistical Features
We use the definitions of bidirectional and unidirectional flows from [10]:
- **Bidirectional flow**: All packets share the same 5-tuple {source_IP, source_port, destination_IP, destination_port, transport-level protocol}, including both directions of traffic.
- **Unidirectional flow**: All packets belong to a flow but include only one direction of traffic.

In a TCP session, we distinguish between client and server using TCP flags. We extract flow statistical features separately for the unidirectional flow from the server to the client and vice versa, resulting in a 2n-dimensional feature vector for each bidirectional flow. We then generate service statistical features based on these flow statistical feature vectors, creating a matrix of m*n for each service, where m is the number of flows belonging to the service.

Each field of the feature vector generates two service features: the mean and variance. Thus, the service statistical features form a 4n-dimensional vector.

### 2.3 Clustering
The k-means algorithm's effectiveness depends on the initial value and the number of clusters k. We use the k-means++ method for selecting the initial value and evaluate different k values using the silhouette coefficient. A higher silhouette coefficient indicates better clustering results.

## 3. Experimental Results
To validate our scheme, we implemented a prototype system and conducted experiments on a real network traffic dataset. We modified the open-source nDPI library to filter out unknown traffic and used scikit tools for clustering. The dataset includes 12,300,601 packets, 155,758 flows, and 6,506 services.

### Dataset Overview
- Number of packets: 12,300,601
- Number of flows: 155,758
- Number of services: 6,506

We updated the nDPI library's fingerprint and removed the RDP (Remote Desktop Protocol) fingerprint, ensuring the library cannot identify RDP traffic. This resulted in a set of unknown flows containing real unknown traffic and RDP traffic.

### Filtering Out Unknown Traffic
- Known traffic: 124,607 flows
- Unknown traffic: 31,151 flows

We extracted 8 unidirectional flow features to represent a bidirectional flow, generating a 16-dimensional vector for each bidirectional flow. After standardizing these feature vectors, we used the scikit library to implement the clustering model and calculate the silhouette coefficient for each k value. The optimal k was found to be 6, with the highest silhouette coefficient. Using the original nDPI library, we detected that most RDP traffic was assigned to the same category, confirming the identification of the target elephant application.

## 4. Conclusions and Future Work
This paper presents a new scheme for unknown traffic classification, using service statistical features to train a classification model. Experimental results demonstrate that the service-based clustering scheme is a promising approach for classifying unknown traffic.

Future work will focus on comparing our method with flow-based clustering and improving the clustering scheme to handle UDP traffic.

## 5. Acknowledgments
This work was supported by the National Science and Technology Support Program (No. 2012BAH46B02, No. 2012BAH47B04), the National High Technology Research and Development Program (863 Program) of China (No. 2011AA010703), and the Strategic Priority Research Program of the Chinese Academy of Sciences (No. XDA06030200).

## 6. References
[1] Zhang, J., Xiang, Y., Wang, Y., Zhou, W., Xiang, Y., & Guan, Y. (2013). Network traffic classification using correlation information. IEEE Transactions on Parallel and Distributed Systems, 24(1), 104-117.

[2] Zhang, J., Chen, C., Xiang, Y., Zhou, W., & Vasilakos, A. V. (2013). An effective network traffic classification method with unknown flow detection. IEEE Transactions on Network and Service Management, 10(2), 133-147.

[3] Zhang, J., Chen, X., Xiang, Y., Zhou, W., & Wu, J. Robust Network Traffic Classification.

[4] Wang, Y., Xiang, Y., Zhang, J., & Yu, S. (2011). A novel semi-supervised approach for network traffic clustering. In Network and System Security (NSS), 2011 5th International Conference on (pp. 169-175). IEEE.

[5] Yingqiu, L., Wei, L., & Yunchun, L. (2007, August). Network traffic classification using k-means clustering. In Computer and Computational Sciences, 2007. IMSCCS 2007. Second International Multi-Symposiums on (pp. 360-365). IEEE.

[6] Karagiannis, T., Papagiannaki, K., & Faloutsos, M. (2005). BLINC: multilevel traffic classification in the dark. In ACM SIGCOMM Computer Communication Review (Vol. 35, No. 4, pp. 229-240). ACM.

[7] Moore, A. W., & Papagiannaki, K. (2005). Toward the accurate identification of network applications. In Passive and Active Network Measurement (pp. 41-54). Springer Berlin Heidelberg.

[8] Karagiannis, T., Broido, A., & Faloutsos, M. (2004). Transport layer identification of P2P traffic. In Proceedings of the 4th ACM SIGCOMM conference on Internet measurement (pp. 121-134). ACM.

[9] Baldi, M., Baldini, A., Cascarano, N., & Risso, F. (2009, March). Service-based traffic classification: Principles and validation. In Sarnoff Symposium, 2009. SARNOFF'09. IEEE (pp. 1-6). IEEE.

[10] Dainotti, A., Pescape, A., & Claffy, K. C. (2012). Issues and future directions in traffic classification. IEEE Network, 26(1), 35-40.

[11] Arthur, D., & Vassilvitskii, S. (2007, January). K-means++: The advantages of careful seeding. In Proceedings of the eighteenth annual ACM-SIAM symposium on Discrete algorithms (pp. 1027-1035). Society for Industrial and Applied Mathematics.