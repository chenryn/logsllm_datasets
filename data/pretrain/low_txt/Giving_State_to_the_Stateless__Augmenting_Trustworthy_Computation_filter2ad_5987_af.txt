### 文本优化

#### 引言
本文档引用了多个关于网络安全、密码学以及区块链技术的研究文献。以下是经过优化后的参考文献列表，旨在提高其清晰度、连贯性和专业性。

#### 参考文献
1. PCWorld, 2017, "Paying the Wannacry Ransom Will Probably Get You Nothing: Here's Why." [在线访问] (https://www.pcworld.com/article/3189645/security/wannacry-ransomware-attack-explained.html)

2. Kaptchuk, G., Miers, I., & Green, M., 2017, "Managing secrets with consensus networks: Fairness, ransomware and access control," Cryptology ePrint Archive, Report 2017/201 (修订版 20170228:194725). [在线访问] (https://eprint.iacr.org/2017/201)

3. Kauer, B., 2007, "OSLO: Improving the Security of Trusted Computing," in Usenix '07. Berkeley, CA, USA: USENIX Association. [在线访问] (http://dl.acm.org/citation.cfm?id=1362903.1362919)

4. Kosba, A., Miller, A., Shi, E., Wen, Z., & Papamanthou, C., 2016, "Hawk: The blockchain model of cryptography and privacy-preserving smart contracts," in 2016 IEEE Symposium on Security and Privacy (SP), pp. 839–858.

5. Krsti´c, I., 2016, "Behind the Scenes with iOS Security," In BlackHat. [在线访问] (https://www.blackhat.com/docs/us-16/materials/us-16-Krstic.pdf)

6. LastPass, 2017, "How is LastPass secure and how does it encrypt/decrypt my data safely?" [在线访问] (https://lastpass.com/support.php?cmd=showfaq&id=6926)

7. Lewi, K., Malozemoff, A. J., Apon, D., Carmer, B., Foltzer, A., Wagner, D., Archer, D. W., Boneh, D., Katz, J., & Raykova, M., 2016, "5gen: A framework for prototyping applications using multilinear maps and matrix branching programs," in Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security, ser. CCS '16, pp. 981–992. [在线访问] (http://doi.acm.org/10.1145/2976749.2978314)

8. Liu, J., Jager, T., Kakvi, S. A., & Warinschi, B., 2018, "How to build time-lock encryption," Designs, Codes and Cryptography, vol. 86, no. 11, pp. 2549–2586. [在线访问] (https://doi.org/10.1007/s10623-018-0461-x)

9. Matetic, S., Ahmed, M., Kostiainen, K., Dhar, A., Sommer, D., Gervais, A., Juels, A., & Capkun, S., 2017, "ROTE: Rollback protection for trusted execution," Cryptology ePrint Archive, Report 2017/048. [在线访问] (http://eprint.iacr.org/2017/048)

10. McKeen, F., Alexandrovich, I., Berenzon, A., Rozas, C. V., Shaﬁ, H., Shanbhogue, V., & Savagaonkar, U. R., 2013, "Innovative instructions and software model for isolated execution," in HASP@ ISCA, p. 10.

11. Milutinovic, M., He, W., Wu, H., & Kanwal, M., 2017, "Proof of luck: an efficient blockchain consensus protocol," Cryptology ePrint Archive, Report 2017/249. [在线访问] (https://eprint.iacr.org/2017/249)

12. Nakamoto, S., 2008, "Bitcoin: A peer-to-peer electronic cash system." [在线访问] (http://www.bitcoin.org/bitcoin.pdf)

13. Nayak, K., Fletcher, C. W., Ren, L., Chandran, N., Lokam, S., Shi, E., & Goyal, V., 2017, "HOP: hardware makes obfuscation practical," in NDSS '17.

14. Paletta, D., 2015, "FBI Chief Punches Back on Encryption," Wall Street Journal. [在线访问] (http://www.wsj.com/articles/fbi-chief-punches-back-on-encryption-1436217665)

15. Parno, B., Lorch, J. R., Douceur, J. R., Mickens, J., & McCune, J. M., 2011, "Memoir: Practical state continuity for protected modules," in Proceedings of the 2011 IEEE Symposium on Security and Privacy, ser. SP '11, pp. 379–394. [在线访问] (https://doi.org/10.1109/SP.2011.38)

16. Poulsen, K., 2001, "DirecTV attacks hacked smart cards," The Register. [在线访问] (https://www.theregister.co.uk/2001/01/25/directv_attacks_hacked_smart_cards/)

17. Project, A., 2017, "Full-Disk Encryption." [在线访问] (https://source.android.com/security/encryption/full-disk.html)

18. Rao, D., 2016, "Intel SGX Product Licensing." [在线访问] (https://software.intel.com/en-us/articles/intel-sgx-product-licensing)

19. Rogaway, P., 2002, "Authenticated encryption with associated data," in CCS '02. ACM Press.

20. Rogaway, P., 2006, "Formalizing human ignorance," in VIETCRYPT 2006, P. Q. Nguyen, Ed. Berlin, Heidelberg: Springer Berlin Heidelberg, pp. 211–228.

21. Sinegubko, D., 2016, "Website Ransomware - CBT-Locker Goes Blockchain," Sucuri Blog. [在线访问] (https://blog.sucuri.net/2016/04/website-ransomware-ctb-locker-goes-blockchain.html)

22. Skorobogatov, S., 2016, "The bumpy road towards iPhone 5c NAND mirroring," CoRR, vol. abs/1609.04327. [在线访问] (http://arxiv.org/abs/1609.04327)

23. Skorobogatov, S. P., & Anderson, R. J., 2003, "Optical fault induction attacks," in CHES '02, B. S. Kaliski, c¸. K. Koc¸, & C. Paar, Eds. Berlin, Heidelberg: Springer Berlin Heidelberg, pp. 2–12. [在线访问] (https://doi.org/10.1007/3-540-36400-5_2)

24. Technology.org, 2016, "Ransomware authors arrest cases." [在线访问] (http://www.technology.org/2016/11/21/ransomware-authors-arrest-cases/)

25. Tran, M., Luu, L., Kang, M. S., Bentov, I., & Saxena, P., 2017, "Obscuro: A bitcoin mixer using trusted execution environments," Cryptology ePrint Archive, Report 2017/974. [在线访问] (http://eprint.iacr.org/2017/974)

26. Ur, B., Segreti, S. M., Bauer, L., Christin, N., Cranor, L. F., Komanduri, S., Kurilova, D., Mazurek, M. L., Melicher, W., & Shay, R., 2015, "Measuring real-world accuracies and biases in modeling password guessability," in 24th USENIX Security Symposium (USENIX Security 15), pp. 463–481. [在线访问] (https://www.usenix.org/conference/usenixsecurity15/technical-sessions/presentation/ur)

27. Van Bulck, J., Minkin, M., Weisse, O., Genkin, D., Kasikci, B., Piessens, F., Silberstein, M., Wenisch, T. F., Yarom, Y., & Strackx, R., 2018, "Foreshadow: Extracting the keys to the Intel SGX kingdom with transient out-of-order execution," in Proceedings of the 27th USENIX Security Symposium. USENIX Association. [在线访问] (https://www.usenix.org/conference/usenixsecurity18/presentation/van-bulck)

28. Weaver, N., 2015, "iPhones, the FBI, and Going Dark," Lawfare Blog. [在线访问] (https://www.lawfareblog.com/iphones-fbi-and-going-dark)

29. Zetter, K., 2016, "Why hospitals are the perfect targets for ransomware," Wired. [在线访问] (https://www.wired.com/2016/03/ransomware-why-hospitals-are-the-perfect-targets/)

30. Zhang, F., Cecchetti, E., Croman, K., Juels, A., & Shi, E., 2016, "Town crier: An authenticated data feed for smart contracts," in Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security, ser. CCS '16, pp. 270–282. [在线访问] (http://doi.acm.org/10.1145/2976749.2978326)

#### 附录
**证明概要**
由于篇幅限制，我们仅提供一个简要的证明概述，并省略了许多细节。完整的安全性证明可在完整版本中找到。

我们为ELI提供了一个基于模拟的安全定义，并在我们的证明中使用了两个基本实验。在真实实验中，我们考虑一个对抗性的主机用户H与诚实的账本预言机和诚实的Enclave预言机进行交互，以执行ELI协议。理想实验中有一个对抗性的理想主机ˆH，它与一个可信的、多步骤的计算功能（作为Compute Oracle暴露）进行交互。在每个步骤中，这个功能接收程序、程序输入和由ˆH提供的“会话ID”，并使用真实的随机币运行程序，并使用与该会话ID关联的最新程序状态。可信的功能将结果状态内部存储，记录公共输出到所有方可用的表中，并将输出返回给用户。这种理想模型直观地描述了我们希望从安全的多步骤交互式计算系统中实现的目标。

为了考虑到账本认证器的可伪造性，我们对这些实验进行了稍微修改。特别是当账本认证器标签通过经济手段保护时，我们必须确保在面对少量伪造时安全性能够优雅地降级。虽然我们不能防止攻击者从成功伪造认证器中获得一些优势，但我们可以在这种情况下成功地限制攻击者的能力。为了在我们的证明中捕捉这一概念，我们在真实实验中向对手提供了伪造预言机。在理想实验中，我们提供了一个分叉预言机，允许对手使用他们选择的旧状态运行单个步骤的计算。在每个实验中，对手最多只能对这些预言机进行qforge次查询。

我们证明对于每一个多项式时间的现实世界主机H，都存在一个多项式时间的理想世界主机ˆH，在理想实验中的表现与真实主机在真实实验中的表现一样好。请注意，这意味着具有伪造qforge个认证器能力的现实世界对手将能够进行恰好qforge个单步计算，这是一个非常合理的界限。形式上：

**定义1（ELI的模拟安全性）**：一个ELI方案Π = (ExecuteApplication, ExecuteEnclave)是模拟安全的，如果对于每一个多项式时间对手H，足够大的λ，和非负的qforge，存在一个多项式时间的ˆH使得以下成立：
Real(H, λ, qforge) ≈ Ideal( ˆH, λ, qforge)

**证明概要**：由于篇幅限制，我们无法给出理想世界对手ˆH的完整描述。直观上，ˆH介导了H与预言机之间的通信。当H试图查询账本预言机时，ˆH将其转发给真实的账本。当H查询Enclave预言机时，ˆH参考其内部记录的先前交互并决定它是（1）无效查询，（2）先前查询，（3）带有伪造认证器的查询，还是（4）新的查询。在情况（1）中，ˆH中止。在情况（2）中，ˆH重播适当的旧输出。在情况（3）中，ˆH将请求转发给伪造预言机。最后，在情况（4）中，ˆH将查询转发给计算预言机。证明的主要部分是展示ˆH可以成功地区分每种情况。

**讨论**：设D是一个多项式时间区分器，能够在非可忽略的优势下区分ˆH在理想实验中的输出与H在真实实验中的输出。证明通过一系列混合实验进行，其中在每个混合实验中H按照真实实验进行交互。第一个混合实验（Game 0）与真实实验分布相同，最后一个混合实验代表ˆH的上述模拟。我们列举了下面的混合实验，但由于篇幅限制，省略了每对混合实验之间计算不可区分性的证明。最终通过调用混合引理来证明真实实验和理想实验是不可区分的。

Game 0就是真实实验。现在我们简要概述其余的混合实验：
- **Game 1**（在[对手]伪造认证器时中止）：如果H在Enclave预言机上查询(post, σ)，使得（1）Ledger.Verify(post, σ) = 1，但（2）这对不是之前调用Ledger或Forgery预言机的输入（或输出），则中止并输出Eventforge。如果认证器不可伪造，则此事件发生的概率最多为可忽略不计。
- **Game 2**（在哈希碰撞时中止）：如果H导致函数H, HL在输入s1 ≠ s2上被评估，使得H(s1) = H(s2)或HL(s1) = HL(s2)，则中止并输出Eventhashcoll。如果哈希是抗碰撞的，则此事件发生的概率最多为可忽略不计。
- **Game 3**（在承诺碰撞时中止）：如果H在Enclave预言机上查询Ci = Cj且Ci = Commit(pp, (i, Ii, Si, P, posti.CID); ri) = Commit(pp, j || Ij || Sj || posti.CID; rj)且(i, Ii, Si, Pi, posti.CID) ≠ (j, Ij, Sj, Pj, postj.CID)，则中止并输出Eventbinding。如果承诺是绑定的，则此事件发生的概率最多为可忽略不计。
- **Game 4**（重复Enclave调用给出相同的输出）：如果H在Enclave预言机上反复查询相同的值(Pi, i, Ii, Si, posti)（这里排除σi），并且预言机（如前一个混合实验中实现的）没有输出⊥，则将所有后续重复查询的结果替换为第一次查询的结果。这不会改变分布，因为方案是确定性的。
- **Game 5**（在账本哈希碰撞时中止）：如果H在Enclave预言机上查询两个不同的输入(Pi, i, Ii, Si, posti, σi)和(Pj, j, Ij, Sj, postj, σj)，并且这两个输入不代表重复输入（根据Game 4），那么：如果(posti, σi)和(postj, σj)都是Ledger预言机的有效输出，并且posti.Hash = postj.Hash，则中止并输出Eventledgercoll。如果哈希是抗碰撞的，则此事件发生的概率最多为可忽略不计。
- **Game 6**（ˆH可以始终唯一识别CID）：此混合实验修改了前一个实验，如下所示：如果在步骤i中对手H调用Enclave预言机（如前一个混合实验中实现的），并且（1）预言机没有返回⊥，（2）两次调用的输入不相同（这将在早期混合实验中被排除），（3）(posti, σi)在账本表中，（4）posti.Hash匹配账本表中的两个不同条目，则中止并输出Eventledgerrepeat。此事件发生的概率最多为可忽略不计。
- **Game 7**（将会话密钥和伪随机币替换为随机字符串）：如果Enclave不中止或不在重复输入上调用，则(ki+1, ¯ri)均匀随机采样并记录在表中以供以后使用。使用PRF使此混合实验与前一个实验不可区分。
- **Game 8**（拒绝不真实的密文）：如果H在Enclave预言机上查询Si ≠ ε且（1）预言机不拒绝输入，（2）Decrypt(ki, Si)不输出⊥，但（3）(Si, ki)不是在之前的Enclave查询中生成的，则中止并输出Eventauth。如果方案是AE，则此事件发生的概率最多为可忽略不计。
- **Game 9**（如果输入不一致则中止）：在H对Enclave预言机的第i次查询中，当Si ≠ ε时，让(post.CID, P, i-1, Pubi-1)是与前一次Enclave调用相关的输入/输出。如果（1）实验尚未因先前混合实验中描述的条件而中止，（2）Enclave预言机如前一个混合实验中实现的那样不拒绝输入，且（3）任何提供的输入(post.CID, P, i-1, Pubi-1) ≠ (post.CID, P', i', Pubi-1')与前一次调用Enclave时的不同，则中止并输出Eventmismatch。在此协议中，此事件不可能发生。
- **Game 10**（将密文替换为虚拟密文）：此混合实验修改了前一个实验，如下所示：我们修改了每个密文S'的生成，使其加密一元字符串(1Max(P), 1l)。如果方案是AE，则此混合实验与前一个实验不可区分。

通过这些混合实验，我们逐步构建了一个理想的模型，并证明了现实实验和理想实验是不可区分的。