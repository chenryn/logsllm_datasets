### Frequency and Setup
- **Frequency:** The following websites were frequently accessed: <https://www.wikipedia.org>, <http://example.com>, and <https://gfw.report>.
- **OutlineVPN:** We installed an OutlineVPN server (v1.0.7) on a US university network. The client, which was the latest version as of October 2019, was located in a residential network in China.
- **Client Traffic:** The client traffic was generated by an instance of Firefox, configured to automatically browse a subset of the Alexa top 1 million sites that are censored in China.

### Limitations
- **Geographic Diversity:** The locations of our vantage points lack diversity, which may reduce our ability to observe potential inconsistencies in the probing system caused by geolocation.

### 3.2 Probe Types
- **Analysis:** We analyzed all connections to the server port running Shadowsocks and used the traffic received by the control host to verify the probes.
- **Probe Categories:**
  - **Replay-Based Probes:** These have payloads derived from the first data-carrying packet of previously recorded legitimate connections. 
    - **Type R1:** Identical replay.
    - **Type R2:** Replay with byte 0 changed.
    - **Type R3:** Replay with bytes 0–7 and 62–63 changed.
    - **Type R4:** Replay with byte 16 changed.
    - **Type R5:** Replay with bytes 6 and 16 changed.
      - **Note:** Types R3, R4, and R5 were only observed in the OutlineVPN experiment, not in the Shadowsocks-libev one. Only two type R5 probes were received in our experiments.
  - **Seemingly Random Probes:** These have varying lengths and do not resemble any prior legitimate connection.
    - **Type NR1:** Probes of length 7–9, 11–13, 15–17, 21–23, 32–34, 40–42, or 48–50 bytes.
    - **Type NR2:** Probes of length exactly 221 bytes.
  - **Figure 2:** Illustrates the distribution of type NR1 and NR2 probes. The lengths of NR1 probes are distributed in trios centered on 8, 12, 16, 22, 33, 41, and 49 bytes.

### 3.3 Origin of the Probers
- **Defense Strategy:** A simple defense against active probing is to identify and ban prober IP addresses. However, this is challenging due to the large and diverse pool of IP addresses with high churn.
- **IP Addresses:** The 51,837 active probes were sent from 12,300 unique source IP addresses, all located in China. Figure 3 shows the distribution of the number of probes sent per unique IP address.
- **Autonomous Systems (AS):** Table 3 shows the AS distribution of probers. The most common ASes are AS4837 (CHINA169-BACKBONE CNCGROUP China169 Backbone) and AS4134 (CHINANET-BACKBONE No.31, Jin-rong Street). Other ASes include AS17816, AS9808, AS56046, AS17638, AS56047, and AS17622. Some previously attested ASes, such as AS7497 (CSTNET-AS-AP Computer Network Information Center), did not appear in our data.

### 3.4 Fingerprinting the Probes
- **Packet-Level Features:** We fingerprinted the packet-level features of active probes, examining the IP ID and TTL fields at the IP layer, and source ports and timestamps at the TCP layer.
  - **IP ID and TTL:** We found no clear pattern in the IP ID sequences, and TTLs remained within the range 46–50.
  - **TCP Source Ports:** Around 90% of probes came from source ports in the range 32768–60999, which is the default source port range for many Linux kernels. Probes never used a source port below 1024.
  - **TCP Timestamp (TSval):** The timestamp value attached to the SYN segment of each probe revealed that although the probers use thousands of source IP addresses, they share a small number of TCP timestamp sequences. There are at least seven different physical systems or processes, with one accounting for the majority of probes. The slope of the linear sequences is almost exactly 250 Hz, with one small cluster of 22 closely spaced points having a slope closer to 1000 Hz.

### 3.5 Delay of Replay Attacks
- **Replay Delay:** The GFW may record the first data-carrying packet of a genuine client connection and replay it later, possibly with modifications. Figure 7 shows the variability in delay between when a legitimate connection is made and when the GFW sends replay-based probes. The total number of probes is 3,269 for first occurrences and 11,137 for all occurrences.
- **Delay Distribution:** More than 20% of first replays arrived within one second; more than 50% within one minute; and more than 75% within 15 minutes. The shortest delay observed was 0.28 seconds, and the longest was 570 hours.

### 4. What Triggers Active Probing
- **Hypotheses:** There are alternative hypotheses for how the GFW might discover Shadowsocks servers, including large-scale, proactive port scanning or reactive probing triggered by legitimate connections. The fact that the unused control host did not receive any active probes leads us to discard the proactive scanning hypothesis.
- **Trigger Conditions:**
  - **Traffic Requirement:** How much traffic is required to trigger active probes?
  - **Length and Entropy:** What specific lengths and entropy levels of packets are more likely to trigger active probes?

### 4.2 Experiment Results and Analysis
- **Sink Server Experiments:** Our sink server, despite not being a real Shadowsocks server and never sending data, received many of the same types of probes as in the Shadowsocks server experiment. After a TCP handshake, a single data packet from the client to the server suffices to trigger active probes.
- **Replay Lengths:** Although our clients sent data packets with lengths between 1 and 2000 bytes, virtually all probes that were determined to be replays had a payload length between 160 and 700 bytes, with the maximum length being 999 bytes. The distribution of lengths exhibits a stair-step pattern, reflecting that certain lengths are more likely to be replayed. This suggests that the GFW considers packet lengths in classifying Shadowsocks traffic.

### Summary
- **Table 4:** Summarizes the design of the random-data experiments, showing the client and server configurations, including the length and entropy of the data packets sent.
- **Table 1:** Shows the time span of the experiment, with clients running on different VPSes within the same Tencent datacenter in Beijing and all servers running in the same Digital Ocean datacenter in the US.

This optimized text provides a clearer and more structured presentation of the information, making it easier to follow and understand.