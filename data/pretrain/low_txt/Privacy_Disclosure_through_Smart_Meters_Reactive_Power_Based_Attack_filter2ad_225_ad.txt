### Waveform and Original Waveform Comparison

Based on cosine similarity, a metric called the obfuscation factor (denoted by \( g \)) is defined as follows:
\[
g = 1 - \text{similarity} = 1 - \cos(\theta)
\]
where
\[
\cos(\theta) = \frac{\mathbf{u}(t) \cdot \mathbf{r}(t)}{\|\mathbf{u}(t)\| \|\mathbf{r}(t)\|}
\]
and
\[
\mathbf{u}(t) \cdot \mathbf{r}(t) = \sum_{i=1}^{n} u(t_i) r(t_i)
\]
\[
\|\mathbf{u}(t)\| = \sqrt{\sum_{i=1}^{n} u(t_i)^2}, \quad \|\mathbf{r}(t)\| = \sqrt{\sum_{i=1}^{n} r(t_i)^2}
\]
Here, \( \mathbf{r} \) denotes the original reactive power waveform, and \( \mathbf{u} \) denotes the obfuscated reactive power waveform generated by RPO. The obfuscation factor \( g \) measures the difference between the original and obfuscated waveforms. The goal of RPO is to maximize this difference, thereby making \( g \) as large as possible. A larger \( g \) indicates better privacy by describing the information loss during the obfuscation process.

### Detection Rate

To evaluate the effectiveness of RPO in mitigating reactive power-based attacks, we define another metric: the detection rate, which measures how accurately an attacker can identify appliance usage events:
\[
\text{detection rate} = \frac{\text{number of accurate detections}}{\text{number of appliance usage events detected}}
\]
Since an appliance can be turned on or off, each appliance has two detection rates corresponding to these events.

### Simulation Setup

To evaluate the performance of RPO, we simulate the complete system using Cadence’s OrCAD PSpice software [35]. This software supports both digital and analog circuit design and high-performance simulation. In our PSpice setup, we use a mixed A/D circuit mode to implement the RPO circuit (as shown in Fig. 13 and Fig. 14). We generate waveforms from the load profile data sets described in Section III-A and add them as signal sources to the circuit (input in Fig. 14). To capture the obfuscated reactive power waveform, we place a Power Dissipation Marker at the output line (Fig. 14). The results reported below are based on a simulated 10 F capacitor.

### Evaluation Results

#### 1. Original and Obfuscated Load Profiles

In this set of experiments, the initial target power \( R_c \) is set to 100 VAr. As an example, Fig. 15 shows a 24-hour load profile. The left figure represents the original reactive power, while the right figure shows the obfuscated reactive power. The figures indicate that after applying RPO, the waveform becomes more stable, with the obfuscated reactive power mostly staying around 100 VAr, thus masking the reactive power changes caused by turning appliances on and off.

Some fluctuations still occur in the obfuscated data due to the capacitor's delay in storing and providing reactive power. When an appliance changes state, it takes about one second for the capacitor to fully compensate, resulting in a brief fluctuation before the reactive power returns to 100 VAr. However, these short fluctuations do not reveal detailed appliance usage information because the starting reactive power is set to 100 VAr by RPO, and the change is not related to the actual power consumption of the appliance. Additionally, the fluctuation is too short (about one second) to extract meaningful wavelet coefficients. Therefore, the attacker cannot link the fluctuation to specific appliances. To further validate this, we perform a wavelet transform on the obfuscated data, and the coefficients are shown in Fig. 16. The coefficients of the obfuscated data do not exhibit any discernible pattern and cannot be mapped to any appliance.

#### 2. Vulnerability Factor and Obfuscation Factor

The vulnerability and obfuscation factors with and without RPO are shown in Table IV. After applying RPO, the vulnerability factor for all three households drops significantly (more than 98%). This indicates that RPO effectively reduces the amount of useful information in the reactive power data, making it much harder for attackers to make inferences. The obfuscated data and the original data are significantly different, demonstrating that RPO can obfuscate the original reactive power data very well.

#### 3. Effectiveness in Mitigating Reactive Power-Based Attacks

In this subsection, we run the attacks described in Section IV based on the original and obfuscated reactive power data. The results are shown in Table V. Before applying RPO, the attacker can identify appliance ON/OFF events with high accuracy. After applying RPO, the accuracy of identifying ON/OFF events is very low (less than 2%). For example, for Apt 1, without RPO, the detection rate for identifying a lamp "ON" event is 95.8%, but this drops to 1.2% with RPO. These results demonstrate that RPO can prevent attackers from inferring appliance usage, thereby preserving user privacy.

#### 4. Effects of Initial \( R_c \)

The initial target load \( R_c \) is an important factor in RPO. We evaluated the vulnerability and obfuscation factors with different initial \( R_c \) values, and the results are shown in Fig. 17 and Fig. 18. As shown in Fig. 17, the vulnerability factor varies between 0.05 and 0.45 as \( R_c \) changes. The best results occur around 100 to 120 VAr. Despite the variations, the vulnerability factor is always much lower compared to 2.307 (the value when RPO is not applied).

Fig. 18 shows that the obfuscation factor remains relatively constant (ranging from 0.9985 to 0.9988) as \( R_c \) changes. This high value indicates that RPO performs well even with varying \( R_c \) values.

### Conclusions

This paper presents a new attack against user privacy using only reactive power data measured by smart meters. The attack demonstrates that reactive power can be exploited by attackers to infer appliance usage information, posing significant threats to user privacy. To address this, we propose a novel technique called RPO to obfuscate the reactive power measured by smart meters. RPO uses capacitors to store and provide reactive power in a controlled manner, smoothing power fluctuations and hiding the reactive power changes caused by appliance ON/OFF events. Evaluation results show that RPO can prevent adversaries from exploiting reactive power data to infer appliance usage, thereby preserving user privacy.

### Acknowledgments

This work was supported in part by the National Science Foundation (NSF) under grant No. CNS-1526425, and by the Defense Threat Reduction Agency under grant HDTRA1-10-1-0085.

### References

[1] U.S. Department of Energy, “The Smart Grid: An Introduction,” http://energy.gov/oe/downloads/smart-grid-introduction, 2008.
[2] B. Cook, J. Gazzano, Z. Gunay, L. Hiller, S. Mahajan, A. Taskan, and S. Vilogorac, “The Smart Meter and a Smarter Consumer: Quantifying the Benefits of Smart Meter Implementation in the United States,” Chemistry Central Journal, vol. 6, no. 1, 2012.
[3] X. Dong, H. Lin, R. Tan, R. K. Iyer, and Z. Kalbarczyk, “Software-Defined Networking for Smart Grid Resilience: Opportunities and Challenges,” in ACM Workshop on Cyber-Physical System Security (CPSS), 2015.
[4] M. Hossain, N. Madlool, N. Rahim, J. Selvaraj, A. Pandey, and A. F. Khan, “Role of Smart Grid in Renewable Energy: An Overview,” Renewable and Sustainable Energy Reviews, vol. 60, 2016.
[5] Q. Li and G. Cao, “Multicast authentication in the smart grid with one-time signature,” IEEE Transactions on Smart Grid, vol. 2, no. 4, pp. 686–696, 2011.
[6] Y. Bachy, F. Basse, V. Nicomette, E. Alata, M. Kaˆaniche, J.-C. Courrège, and P. Lukjanenko, “Smart-TV Security Analysis: Practical Experiments,” in IEEE/IFIP International Conference on Dependable Systems and Networks (DSN), 2015.
[7] V. B. Krishna, K. Lee, G. A. Weaver, R. K. Iyer, and W. H. Sanders, “F-DETA: A Framework for Detecting Electricity Theft Attacks in Smart Grids,” in IEEE/IFIP International Conference on Dependable Systems and Networks (DSN), 2016.
[8] H. Lin, H. Alemzadeh, D. Chen, Z. Kalbarczyk, and R. K. Iyer, “Safety-Critical Cyber-Physical Attacks: Analysis, Detection, and Mitigation,” in Symposium and Bootcamp on the Science of Security, 2016.
[9] E. Fernandes, J. Jung, and A. Prakash, “Security Analysis of Emerging Smart Home Applications,” in IEEE Symposium on Security and Privacy (S&P), 2016.
[10] T. A. Nguyen and M. Aiello, “Energy Intelligent Buildings Based on User Activity: A Survey,” Energy and buildings, vol. 56, 2013.
[11] C. Dinesh, B. W. Nettasinghe, R. I. Godaliyadda, M. P. B. Ekanayake, J. Ekanayake, and J. V. Wijayakulasooriya, “Residential Appliance Identification Based on Spectral Information of Low Frequency Smart Meter Measurements,” IEEE Transactions on Smart Grid, 2015.
[12] G. Eibl and D. Engel, “Influence of Data Granularity on Smart Meter Privacy,” IEEE Transactions on Smart Grid, vol. 6, no. 2, 2015.
[13] U. Greveler, B. Justus, and D. Loehr, “Multimedia Content Identification Through Smart Meter Power Usage Profiles,” Computers, Privacy and Data Protection, vol. 1, p. 10, 2012.
[14] W. Yang, N. Li, Y. Qi, W. Qardaji, S. McLaughlin, and P. McDaniel, “Minimizing Private Data Disclosures in the Smart Grid,” in ACM Conference on Computer and Communications Security (CCS), 2012.
[15] D. Egarter, C. Prokop, and W. Elmenreich, “Load Hiding of Household’s Power Demand,” in IEEE International Conference on Smart Grid Communications (SmartGridComm), 2014.
[16] L. Yang, X. Chen, J. Zhang, and H. V. Poor, “Cost-Effective and Privacy-Preserving Energy Management for Smart Meters,” IEEE Transactions on Smart Grid, vol. 6, no. 1, pp. 486–495, 2015.
[17] G. W. Hart, “Nonintrusive Appliance Load Monitoring,” Proceedings of the IEEE, vol. 80, no. 12, pp. 1870–1891, 1992.
[18] S. N. Patel, T. Robertson, J. A. Kientz, M. S. Reynolds, and G. D. Abowd, “At the Flick of a Switch: Detecting and Classifying Unique Electrical Events on the Residential Power Line,” in ACM International Joint Conference on Pervasive and Ubiquitous Computing (UbiComp), 2007.
[19] M. Zeifman and K. Roth, “Nonintrusive Appliance Load Monitoring: Review and Outlook,” IEEE Transactions on Consumer Electronics, vol. 57, no. 1, 2011.
[20] W. Wang and Z. Lu, “Cyber Security in the Smart Grid: Survey and Challenges,” Computer Networks, vol. 57, no. 5, pp. 1344–1371, 2013.
[21] F. Diao, F. Zhang, and X. Cheng, “A Privacy-Preserving Smart Metering Scheme Using Linkable Anonymous Credential,” IEEE Transactions on Smart Grid, vol. 6, no. 1, pp. 461–467, 2015.
[22] Y. Gong, Y. Cai, Y. Guo, and Y. Fang, “A Privacy-Preserving Scheme for Incentive-Based Demand Response in the Smart Grid,” IEEE Transactions on Smart Grid, vol. 7, no. 3, pp. 1304–1313, 2016.
[23] L. Chen, R. Lu, and Z. Cao, “PDAFT: A Privacy-Preserving Data Aggregation Scheme With Fault Tolerance for Smart Grid Communications,” Peer-to-peer networking and applications, vol. 8, no. 6, 2015.
[24] Q. Li, G. Cao, and T. La Porta, “Efficient and privacy-aware data aggregation in mobile sensing,” IEEE Transactions on Dependable and Secure Computing, vol. 11, no. 2, 2014.
[25] J. Fan, Q. Li, and G. Cao, “Privacy-Aware and Trustworthy Data Aggregation in Mobile Sensing,” in IEEE Conference on Communications and Network Security (CNS), 2015.
[26] L. Yang, X. Chen, J. Zhang, and H. V. Poor, “Optimal Privacy-Preserving Energy Management for Smart Meters,” in IEEE International Conference on Computer Communications (INFOCOM), 2014.
[27] “GE I-210 meters,” http://www.gedigitalenergy.com/SmartMetering/catalog/i210 family.htm.
[28] “Landis Gyr Meters,” http://www.landisgyr.com/products/.
[29] R. Bracewell, “The Fourier Transform and Its Applications,” 1965.
[30] Y. Meyer, “Wavelets and Operators,” 1995.
[31] O. Parson, S. Ghosh, M. Weal, and A. Rogers, “An Unsupervised Training Method for Non-Intrusive Appliance Load Monitoring,” Artificial Intelligence, vol. 217, pp. 1–19, 2014.
[32] A. V. Oppenheim, R. W. Schafer, and J. R. Buck, Discrete-Time Signal Processing. Prentice-hall Englewood Cliffs, 1989.
[33] “ISL78268,” https://www.intersil.com/products/ISL78268.
[34] S. McLaughlin, P. McDaniel, and W. Aiello, “Protecting Consumer Privacy from Electric Load Monitoring,” in ACM Conference on Computer and Communications Security (CCS), 2011.
[35] “OrCAD: Cadence PCB Solutions,” http://www.orcad.com/.