# 下一座圣杯——2019
##### 译文声明
本文为翻译文章，原作者为DJ的札记，原文发布于其个人博客。译文仅供参考，具体内容和含义以原文为准。

今年的“圣杯”文章推迟了许久才发布，原因在于笔者所在的公司也在开发相关产品，因此特意推迟了几个月，以便观察市场上的追随者及其理解程度。毕竟，创业公司在市场竞争中需要谨慎行事，时刻关注竞争态势。每年的“圣杯”文章旨在预测两年后将初见成功的新安全产品。今年笔者选择的方向注定是一个竞争激烈的红海市场；初创公司需谨慎进入，因为必然会面临大公司的激烈竞争。

## 应用安全的发展

过去十年间，应用安全一直是行业热点之一。读者们也一直希望笔者能够撰写关于应用安全的文章。还记得2015年关于安全新趋势的文章吗？其中提到数据是新的中心、身份是新的边界、行为是新的控制点、情报是新的服务。每一点都代表了创业公司的市场机会，唯独没有提到应用安全。但这并不意味着应用安全不重要。在软件定义世界的今天，没有人会否认软件自身安全性的重要性。遗憾的是，在2015年，笔者并未看到应用安全领域出现显著的技术变革。基础设施的发展确实给应用安全市场带来了新的机会，但主要是交付方式的变化，新增的市场份额大部分被云基础设施提供商瓜分。缺乏技术革新，加之云服务提供商逐步侵蚀市场份额，使得应用安全厂商倍感压力，都在努力寻找乏善可陈的产品中的亮点。在这种环境下，专注于技术创新的初创公司很难脱颖而出。

为了支持这一观点，我们不妨对比一下2004年与2017年的OWASP Top 10列表。下图展示了这两份相差十三年的列表之间的对应关系。仔细研究其详细解释，可以发现除了标题文字略有差异外，具体的安全控制点在两份文档中几乎都能找到对应的条目。例如，2004年的A10项“Insecure Configuration Management”中明确提到了未修补的服务器软件漏洞，这与2017年的A9项“Using Components with Known Vulnerabilities”并无本质区别。而2017年的A4项“XXE”虽然是新出现的条目，但实际上它是由于XML广泛应用所导致的。回顾2004年的A1项“Unvalidated Input”，其解释中提到攻击者可以篡改HTTP请求的任何部分，包括URL、查询字符串、头部、Cookie、表单字段和隐藏字段，以绕过网站的安全机制。显然，XXE只是其中的一种表现形式，并不新鲜。此外，反序列化漏洞取代缓冲区溢出，反映了应用程序架构的变化，Java等开发语言逐渐占据主导地位。消失在前十的2004 A9项“Application Denial of Service”如果放在2017年的A11位置，相信大多数读者都会同意。2017年真正意义上新增的条目只有一个：A10项“Insufficient Logging & Monitoring”，这反映了整个安全行业对于防御和检测心态的根本转变。

这种现象令人惊讶。假设你在2004年已经掌握了Web攻击的基础知识并进行了充分实践，那么即使在接下来的十几年里你没有学习新技术，也没有取得进步，也不会被淘汰。这在快速发展的计算机领域几乎是难以想象的。举个例子，同样在这十五年间，操作系统等软件的安全性至少提升了四五个等级，如果你不能持续跟进新技术发展，内网横向移动将会变得非常困难。

回顾应用安全领域的标杆产品WAF（Web应用防火墙）的发展历程，也可以看到类似的现象。开源项目ModSecurity自2002年发布以来，虽然在易用性和支持性方面不如商业产品，但它一直代表着该领域的技术水平。回到2015年，笔者能看到的创新也只有SQL注入的词法分析，这项功能始于2012年开源的libinjection项目。目前WAF厂商仍在重点宣传的这个新功能，ModSecurity早在2013年初就已经集成并提供了。值得一提的是，libinjection的作者后来作为CTO共同创立了Signal Sciences，成为WAF市场的一匹黑马。此后，ModSecurity在2014年引入了模糊哈希方法ssdeep来检测webshell，但其所使用的技术早在2006年就已经出现，实际效果并不理想，难以大张旗鼓地宣传。从那时到现在，大家还记得WAF检测技术出现了什么新的变化吗？

笔者还观察到一个有趣的现象，无论是在美国还是国内，如果你与下一代防火墙或其他产品方向的领先厂商的技术人员交流，总会有一种感觉，他们对WAF并不重视，认为其技术老旧且缺乏壁垒，市场规模有限，因此不愿意投入资源。然而，笔者十分重视WAF市场。熟悉的朋友都知道，我多次提到自己在2015年纠结了半年时间最终没有坚定投入WAF产品的决定。当时，我看到了WAF在国内市场的巨大潜力：预算增速和份额远超美国市场的安全产品，这是由于当时国内电商和线上业务的发展速度已经显露出全面超过美国的迹象。然而，我也看到了缺乏技术革新带来的产品同质化严重的问题，同时高估了大厂的产品研发和市场进攻执行力，还有重金砸销售与当时公司运营模式不同的挑战。种种看似合理的理由最终导致错失了一次市场爆发的机会。每日三省吾身，交过学费的自然要牢记并且避免再犯同样的错误。这几年来，笔者一直在寻找进入应用安全领域的切入点。

上文提到，云增量被CSP（云服务提供商）吃掉。早在2015年，笔者就认为云WAF应位列云安全产品收入前三，是云服务商的重点投入方向。那一年，业界还在争论云服务商是否应该做安全以及能否做好安全。四年后的今天，市场给出了强有力的答案：今年各路分析师报告中，全球前十WAF厂商中有一半是云基础设施服务商。新的机会是由交付方式的变化引发的，并非技术变革，导致WAF市场的发展不是创新驱动而是投资驱动，因此头部CSP拥有巨大的竞争优势。

其他应用安全领域的需求也非常强劲，但难以规模化成长，独立支撑起一家上市公司的难度颇大。例如RASP（运行时应用自我保护），2015年RSA创新沙盒冠军Waratek现在也转向了RASP与WAF结合的道路，成立了十年之久，规模却落后很多。近两年的新趋势是厂商同时提供RASP和WAF集成，以弥补各自的不足。Shape Security当年大力推广动态变形技术，其实也是RASP的思路，但想要实现上市仍然困难重重，历经多次转型尝试，如今已改为RASP+WAF+SDK。Imperva起家实际上是靠数据库安全。美国WAF市场启动与国内同步甚至略慢，现在已经变成了红海，收购整合一直在进行中。另外，今年创新沙盒入围者ShiftLeft，通过数学方法辅助自动化代码漏洞挖掘，笔者虽然很喜欢其技术，但也知道许多美国投资者并不看好代码审计类产品，因为他们投了近二十年的代码审计初创公司，最好的结果也只是被收购。面对困境，应用安全厂商无不积极寻找转折机会。横跨半步已成为安全行业扩大规模的普遍策略，常见的有威胁情报厂商销售IDS（入侵检测系统）、漏扫厂商通过DAST（动态应用安全测试）产品进入SDL（安全开发生命周期）等，代表厂商如Rapid7。

洋洋洒洒写了两千多字，显然不是废话浪费大家的时间，而是为了为中心思想做铺垫：尽管过去十年美国市场上涌现了许多应用安全创业公司，但成功者寥寥无几。就在眼下，应用安全领域出现了一个罕见的拥有巨大市场空间的创业机会：API安全。新的应用风险，新的安全战场。或许很多读者已经猜到了答案，因为从去年底开始，笔者已经在多个小型沙龙和大型行业会议中公开介绍了API安全的基础知识。新的基础设施必然带来新的安全产品机遇。作为连接所有应用并交付数据和功能的方式，API已成为安全团队不得不重视的关键风险控制点。

## 新形势与新机遇

过去五年，云计算已经深入到数字化经济基础设施的方方面面，市场竞争态势的巨大变革导致诸多厂商盛衰沉浮，不乏跟不上趋势从此一蹶不振的。未来五年，影响深远的技术架构变革会是什么？一千个读者心中有一千个哈姆雷特，不同解读在所难免。但是，微服务、Serverless（无服务器计算）和边缘计算应该是大多数读者心中的答案。这三个方向听起来区别很大，但都有一个共同特征：API是不可或缺的基础模块。

业内存在一个认知误区，即微服务常常被认为等同于容器，实际上并非如此。容器只是提供了大规模部署的便捷管理方法，而离开了微服务架构，容器并没有太大的发展空间；反之，微服务离开容器仍将继续快速发展。容器的易用性必然会带来额外的资源消耗、性能波动、治理复杂度等问题，因此有些企业在部署微服务时，出现了从容器回退到虚拟机甚至物理机的现象。相反，也有企业采用更抽象化、更易管理的计算方式来支持微服务，例如使用Serverless搭建微服务。