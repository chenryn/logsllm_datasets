We introduce PID-Piper, a framework that employs a Feed-Forward Controller (FFC) to recover Robotic Vehicles (RVs) from attacks. The FFC in PID-Piper leverages a Machine Learning (ML) model to emulate the RV's Proportional-Integral-Derivative (PID) controller. This FFC-based ML model is designed to prevent over-compensation and high collinearity, thereby enhancing resilience against attacks.

### Evaluation
We evaluated PID-Piper on three real RVs and three simulated RVs. Our findings indicate that PID-Piper:
1. Achieves 0% false positives in the absence of attacks.
2. Recovers RVs from overt attacks, achieving mission success in over 83% of cases.
3. Significantly limits the impact of stealthy attacks, ensuring 100% mission success.
4. Incurs minimal performance overhead.

### Acknowledgements
This work was partially supported by the Natural Sciences and Engineering Research Council of Canada (NSERC) and a research gift from Intel. We extend our gratitude to 'Reviewer A' of our ACSAC'20 submission for their insightful comments, which helped us reposition our paper. We also thank the anonymous reviewers of DSN'21 for their valuable feedback and Dr. Mohamed Kaaniche for his guidance as our shepherd.

### References
1. **Amazon Prime Delivery.** [Online]. Available: <https://www.amazon.com/Amazon-Prime-Air/b?node=8037720011>
2. **N. Shields. Walmart Drone Delivery.** [Online]. Available: <https://www.businessinsider.com/walmart-blockchain-drone-delivery-patent-2018-9>
3. **A. Baker. Zipline Drone Delivery.** [Online]. Available: <http://www.flyzipline.com/>
4. **M. Mission. Mars Exploration Rover.** [Online]. Available: <https://mars.nasa.gov/mer/mission/rover/>
5. **C. Steiner. Bot-in-Time Delivery.** [Online]. Available: <https://www.forbes.com/forbes/2009/0316/040-bot-time-saves-nine.html>
6. **T. E. Humphreys. Assessing the Spoofing Threat: Development of a Portable GPS Civilian Spoofer.** In Proceedings of the Institute of Navigation GNSS (ION GNSS), 2008.
7. **N. O. Tippenhauer, C. Pöpper, K. B. Rasmussen, and S. Capkun. On the Requirements for Successful GPS Spoofing Attacks.** In Proceedings of the 18th ACM Conference on Computer and Communications Security (CCS '11). New York, NY, USA: ACM, 2011, pp. 75–86. [Online]. Available: <http://doi.acm.org/10.1145/2046707.2046719>
8. **Y. Son, H. Shin, D. Kim, Y. Park, J. Noh, K. Choi, J. Choi, and Y. Kim. Rocking Drones with Intentional Sound Noise on Gyroscopic Sensors.** In 24th USENIX Security Symposium (USENIX Security 15). Washington, D.C.: USENIX Association, 2015, pp. 881–896. [Online]. Available: <https://www.usenix.org/conference/usenixsecurity15/technical-sessions/presentation/son>
9. **T. Trippel, O. Weisse, W. Xu, P. Honeyman, and K. Fu. Walnut: Waging Doubt on the Integrity of MEMS Accelerometers with Acoustic Injection Attacks.** In 2017 IEEE European Symposium on Security and Privacy (EuroS&P), April 2017, pp. 3–18.
10. **H. Choi, W.-C. Lee, Y. Aafer, F. Fei, Z. Tu, X. Zhang, D. Xu, and X. Deng. Detecting Attacks Against Robotic Vehicles: A Control Invariant Approach.** In Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications Security (CCS '18). New York, NY, USA: ACM, 2018, pp. 801–816. [Online]. Available: <http://doi.acm.org/10.1145/3243734.3243752>
11. **E. Aggarwal, M. Karimibiuki, K. Pattabiraman, and A. Ivanov. CORGIDS: A Correlation-Based Generic Intrusion Detection System.** In Proceedings of the 2018 Workshop on Cyber-Physical Systems Security and Privacy (CPS-SPC '18). New York, NY, USA: ACM, 2018, pp. 24–35. [Online]. Available: <http://doi.acm.org/10.1145/3264888.3264893>
12. **A. Bezemskij, G. Loukas, R. J. Anthony, and D. Gan. Behaviour-Based Anomaly Detection of Cyber-Physical Attacks on a Robotic Vehicle.** In 2016 15th International Conference on Ubiquitous Computing and Communications and 2016 International Symposium on Cyberspace and Security (IUCC-CSS), Dec 2016, pp. 61–68.
13. **R. Quinonez, J. Giraldo, L. Salazar, E. Bauman, A. Cardenas, and Z. Lin. SAVIOR: Securing Autonomous Vehicles with Robust Physical Invariants.** In 29th USENIX Security Symposium (USENIX Security 20). Boston, MA: USENIX Association, Aug. 2020.
14. **H. Choi, S. Kate, Y. Aafer, X. Zhang, and D. Xu. Software-Based Real-Time Recovery from Sensor Attacks on Robotic Vehicles.** In 23rd International Symposium on Research in Attacks, Intrusions and Defenses (RAID 2020). San Sebastian: USENIX Association, Oct. 2020, pp. 349–364.
15. **J. C. Rosser, V. Vignesh, B. A. Terwilliger, and B. C. Parker. Surgical and Medical Applications of Drones: A Comprehensive Review.** 2018. [Online]. Available: <https://www.ncbi.nlm.nih.gov/pubmed/30356360>
16. **H. Hildmann and E. Kovacs. Using Unmanned Aerial Vehicles (UAVs) as Mobile Sensing Platforms (MSPs) for Disaster Response, Civil Security, and Public Safety.** Drones, vol. 3, no. 3, p. 59, 2019.
17. **J. Li and Y. Li. Dynamic Analysis and PID Control for a Quadrotor.** In 2011 IEEE International Conference on Mechatronics and Automation, Aug 2011, pp. 573–578.
18. **P. Dash, M. Karimibiuki, and K. Pattabiraman. Out of Control: Robotic Vehicles Protected by Control-Based Techniques.** In Proceedings of the 35th Annual Computer Security Applications Conference (ACSAC '19). New York, NY, USA: ACM, 2019, pp. 660–672. [Online]. Available: <http://doi.acm.org/10.1145/3359789.3359847>
19. **Ardupilot - Software in the Loop.** [Online]. Available: <http://ardupilot.org/dev/docs/sitl-simulator-software-in-the-loop.html>
20. **E. Rusli, T. O. Drews, D. L. Ma, R. C. Alkirc, and R. D. Braatz. Robust Nonlinear Feedback-Feedforward Control of a Coupled Kinetic Monte Carlo-Finite Difference Simulation.** In Proceedings of the 2005 American Control Conference, 2005, pp. 2548–2553.
21. **J. Juang and K. Eure. Predictive Feedback and Feedforward Control for Systems with Unknown Disturbances.** The Journal of the Acoustical Society of America, vol. 105, no. 2, pp. 971–971, 1999.
22. **A. A. Clements, N. Almakhdhub, K. S. Saab, P. Srivastava, J. Koo, S. Bagchi, and M. Payer. Protecting Bare-Metal Embedded Systems with Privilege Overlays.** In 2017 IEEE Symposium on Security and Privacy (SP). Los Alamitos, CA, USA: IEEE Computer Society, May 2017, pp. 289–303. [Online]. Available: <https://doi.ieeecomputersociety.org/10.1109/SP.2017.37>
23. **C. F. Dormann, J. Elith, S. Bacher, C. Buchmann, G. Carl, G. Carré, J. R. G. Marqués, B. Gruber, B. Lafourcade, P. J. Leitão et al. Collinearity: A Review of Methods to Deal with It and a Simulation Study Evaluating Their Performance.** Ecography, vol. 36, no. 1, pp. 27–46, 2013.
24. **J. Goh, S. Adepu, M. Tan, and Z. S. Lee. Anomaly Detection in Cyber-Physical Systems Using Recurrent Neural Networks.** In 2017 IEEE 18th International Symposium on High Assurance Systems Engineering (HASE), Jan 2017, pp. 140–145.
25. **D. L. Poole and A. K. Mackworth. Artificial Intelligence: Foundations of Computational Agents.** Cambridge University Press, 2018. [Online]. Available: <https://www.bookdepository.com/Artificial-Intelligence-David-L-Poole/9781107195394>
26. **Y.-S. Jeong, M. K. Jeong, and O. A. Omitaomu. Weighted Dynamic Time Warping for Time Series Classification.** Pattern Recognition, vol. 44, no. 9, pp. 2231–2240, 2011. [Online]. Available: <https://www.sciencedirect.com/science/article/pii/S003132031100200X>
27. **D. I. Urbina, J. A. Giraldo, A. A. Cardenas, N. O. Tippenhauer, J. Valente, M. Faisal, J. Ruths, R. Candell, and H. Sandberg. Limiting the Impact of Stealthy Attacks on Industrial Control Systems.** In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security (CCS '16). New York, NY, USA: ACM, 2016, pp. 1092–1105. [Online]. Available: <http://doi.acm.org/10.1145/2976749.2978388>
28. **L. Meier, P. Tanskanen, F. Fraundorfer, and M. Pollefeys. Pixhawk: A System for Autonomous Flight Using Onboard Computer Vision.** In 2011 IEEE International Conference on Robotics and Automation. IEEE, 2011, pp. 2992–2997.
29. **A. Robotics. R1 Ardupilot Edition.** [Online]. Available: <https://docs.aionrobotics.com/en/latest/r1-ugv.html>
30. **S. Rocket. Sky Viper Journey.** [Online]. Available: <https://sky-viper.com/journey/>
31. **P. D. Team. Pixhawk Autopilot.** [Online]. Available: <https://docs.px4.io/en/flight_controller/pixhawk_series.html>
32. **A. D. Team. Building Ardupilot.** [Online]. Available: <https://github.com/ArduPilot/ardupilot/blob/master/BUILD.md>
33. **G. Project. Gazebo Robot Simulation.** [Online]. Available: <http://gazebosim.org/>
34. **A. J. Hawkins. UPS Will Use Drones to Deliver Medical Supplies in North Carolina.** [Online]. Available: <https://www.theverge.com/2019/3/26/18282291/ups-drone-delivery-hospital-nc-matternet>
35. **DJI. Agras T16 - Agriculture Spraying Drone.** [Online]. Available: <https://www.dji.com/ca/t16>
36. **M. Abadi, A. Agarwal, P. Barham, E. Brevdo, Z. Chen, C. Citro, G. S. Corrado, A. Davis, J. Dean, M. Devin, S. Ghemawat, I. Goodfellow, A. Harp, G. Isard, Y. Jia, R. Jozefowicz, L. Kaiser, M. Kudlur, J. Levenberg, D. Mané, R. Monga, S. Moore, D. Murray, C. Olah, M. Schuster, J. Shlens, B. Steiner, I. Sutskever, K. Talwar, P. Tucker, V. Vanhoucke, V. Vasudevan, F. Viégas, O. Vinyals, P. Warden, M. Wattenberg, M. Wicke, Y. Yu, and X. Zheng. TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems.** 2015. [Online]. Available: <https://www.tensorflow.org/>
37. **F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos, D. Cournapeau, M. Brucher, M. Perrot, and E. Duchesnay. Scikit-Learn: Machine Learning in Python.** Journal of Machine Learning Research, vol. 12, pp. 2825–2830, 2011.
38. **MATLAB. System Identification Overview.** [Online]. Available: <https://www.mathworks.com/help/ident/gs/about-system-identification.html>
39. **GPS.GOV. Official U.S. Government Information About the Global Positioning System (GPS) and Related Topics.** [Online]. Available: <https://www.gps.gov/technical/ps/2008-SPS-performance-standard.pdf>
40. **PID-Piper. Recovering from Attacks Against RVs.** [Online]. Available: <https://bit.ly/3oswuTc>
41. **Pixhawk (and APM) Power Consumption.** [Online]. Available: <https://diydrones.com/profiles/blogs/pixhawk-and-apm-power-consumption>
42. **N. Papernot, P. D. McDaniel, S. Jha, M. Fredrikson, Z. B. Celik, and A. Swami. The Limitations of Deep Learning in Adversarial Settings.** CoRR, vol. abs/1511.07528, 2015.
43. **M. Lecuyer, V. Atlidakis, R. Geambasu, D. Hsu, and S. Jana. Certified Robustness to Adversarial Examples with Differential Privacy.** In 2019 IEEE Symposium on Security and Privacy (SP), 2019, pp. 656–672.
44. **A. Madry, A. Makelov, L. Schmidt, D. Tsipras, and A. Vladu. Towards Deep Learning Models Resistant to Adversarial Attacks.** 2017.
45. **N. Papernot, P. D. McDaniel, I. J. Goodfellow, S. Jha, Z. B. Celik, and A. Swami. Practical Black-Box Attacks Against Deep Learning Systems Using Adversarial Examples.** CoRR, vol. abs/1602.02697, 2016.
46. **P.-Y. Chen, H. Zhang, Y. Sharma, J. Yi, and C.-J. Hsieh. ZOO: Zeroth Order Optimization Based Black-Box Attacks to Deep Neural Networks Without Training Substitute Models.** In Proceedings of the 10th ACM Workshop on Artificial Intelligence and Security (AISec '17). New York, NY, USA: Association for Computing Machinery, 2017, pp. 15–26.
47. **H. Li, S. Shan, E. Wenger, J. Zhang, H. Zheng, and B. Y. Zhao. Blacklight: Defending Black-Box Adversarial Attacks on Deep Neural Networks.** 2020.
48. **S. Adepu and A. Mathur. Using Process Invariants to Detect Cyber Attacks on a Water Treatment System.** In IFIP International Information Security and Privacy Conference, 2016, pp. 91–104.
49. **T. Paul, J. W. Kimball, M. Zawodniok, T. P. Roth, B. McMillin, and S. Chellappan. Unified Invariants for Cyber-Physical Switched System Stability.** IEEE Transactions on Smart Grid, vol. 5, no. 1, p. 2014, 2014.
50. **R. Mitchell and I.-R. Chen. Adaptive Intrusion Detection of Malicious Unmanned Air Vehicles Using Behavior Rule Specifications.** IEEE Transactions on Systems, Man, and Cybernetics: Systems, vol. 44, no. 5, p. 2014, 2014.
51. **Y. Chen, C. M. Poskitt, and J. Sun. Learning from Mutants: Using Code Mutation to Learn and Monitor Invariants of a Cyber-Physical System.** In 2018 IEEE Symposium on Security and Privacy (SP). Los Alamitos, CA, USA: IEEE Computer Society, May 2018, pp. 648–660. [Online]. Available: <https://doi.ieeecomputersociety.org/10.1109/SP.2018.00016>
52. **C. M. Ahmed, J. Zhou, and A. P. Mathur. Noise Matters: Using Sensor and Process Noise Fingerprint to Detect Stealthy Cyber Attacks and Authenticate Sensors in CPS.** In Proceedings of the 34th Annual Computer Security Applications Conference (ACSAC '18). New York, NY, USA: ACM, 2018, pp. 566–581. [Online]. Available: <http://doi.acm.org/10.1145/3274694.3274748>
53. **J. Inoue, Y. Yamagata, Y. Chen, C. M. Poskitt, and J. Sun. Anomaly Detection for a Water Treatment System Using Unsupervised Machine Learning.** CoRR, vol. abs/1709.05342, 2017. [Online]. Available: <http://arxiv.org/abs/1709.05342>
54. **K. N. Junejo and J. Goh. Behaviour-Based Attack Detection and Classification in Cyber-Physical Systems Using Machine Learning.** In Proceedings of the 2nd ACM International Workshop on Cyber-Physical System Security (CPSS '16). New York, NY, USA: ACM, 2016, pp. 34–43. [Online]. Available: <http://doi.acm.org/10.1145/2899015.2899016>
55. **R. C. Borges Hink, J. M. Beaver, M. A. Buckner, T. Morris, U. Adhikari, and S. Pan. Machine Learning for Power System Disturbance and Cyber-Attack Discrimination.** In 2014 7th International Symposium on Resilient Control Systems (ISRCS), Aug 2014, pp. 1–8.
56. **P. Guo, H. Kim, N. Virani, J. Xu, M. Zhu, and P. Liu. RoboADS: Anomaly Detection Against Sensor and Actuator Misbehaviors in Mobile Robots.** In 2018 48th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN), 2018, pp. 574–585.
57. **D. Davidson, H. Wu, R. Jellinek, V. Singh, and T. Ristenpart. Controlling UAVs with Sensor Input Spoofing Attacks.** In 10th USENIX Workshop on Offensive Technologies (WOOT 16). Austin, TX: USENIX Association, Aug. 2016. [Online]. Available: <https://www.usenix.org/conference/woot16/workshop-program/presentation/davidson>
58. **F. Fei, Z. Tu, D. Xu, and X. Deng. Learn-to-Recover: Retrofitting UAVs with Reinforcement Learning-Assisted Flight Control Under Cyber-Physical Attacks.** In 2020 IEEE International Conference on Robotics and Automation (ICRA), 2020, pp. 7358–7364.