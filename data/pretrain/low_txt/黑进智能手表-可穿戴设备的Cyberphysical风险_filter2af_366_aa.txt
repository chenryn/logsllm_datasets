# 黑进智能手表：可穿戴设备的网络物理风险

## 译文声明
本文为翻译文章，原文来源：[https://securelist.com/](https://securelist.com/)。译文仅供参考，具体内容及含义以原文为准。

我们将继续探讨物联网设备如何影响用户的日常生活及其信息安全。在我们之前的研究中（参见[链接](https://securelist.ru/50-hashes-per-hour/30782/)），我们讨论了使用单板微型计算机截取认证数据的方法。而本次研究的重点在于可穿戴设备，特别是智能手表和健身追踪器中的加速度计和陀螺仪。

从围绕Strava的一些消息可以看出，即使是非个人数据，如用户的物理活动信息，也可能被公开。然而，对于个人而言，这些智能设备带来的风险更为严重，因为它们能够记录用户在ATM机上输入PIN码、登录服务或解锁智能手机等关键时刻的行为。

在这项研究中，我们探讨了可穿戴设备内部分析信号如何为潜在入侵者提供机会。尽管嵌入式传感器的信号无法与传统的键盘记录器相媲美，但这些信号仍可用于构建用户行为分析并检测重要数据的输入。这种分析可以通过合法的应用程序轻松实现，从而增强了网络犯罪分子渗透受害者隐私的能力，并有助于访问其所在公司的内部网络。

## 用户行为分析
当人们提到“智能可穿戴设备”时，通常会想到小巧的数字产品。但实际上，大多数智能手表都是网络物理系统，配备了用于测量加速度（加速度计）和旋转（陀螺仪）的传感器。这些廉价且微小的电路还经常包含磁场传感器（磁力计）。如果连续记录这些传感器信号，可以揭示的信息远超设备所有者的预期。

为了进行这项研究，我们基于Google的参考代码编写了一个简单的应用程序，并在运行Android Wear 2.5和Android 5.1操作系统的华为手表（第一代）、Kingwear KW88和PYiALCY X200智能手表上进行了实验。选择这些手表的原因是它们易于获取，并且编写应用程序相对简单（假设在iOS中利用嵌入式陀螺仪和加速度计的方法类似）。

### 记录智能手表在输入密码期间的信号
为了确定最佳采样频率，我们在不同设备上进行了一系列测试，包括低功耗模型（如Arduino 101和小米Mi Band 2）。结果表明，为了获得满意的互相关值，至少需要50 Hz的采样频率。我们排除了超过100 Hz的采样率，因为每秒8 KB的数据量虽然不大，但不适合长时间的日志记录。最终，我们的应用程序选择以100 Hz的频率对嵌入式传感器进行采样，并记录手机内存中三个方向（x，y，z）的加速度计和陀螺仪读数的瞬时值。

尽管获得全天的“数字快照”并不容易，因为华为手表在这种模式下的续航时间不超过六个小时，但我们还是来看一下这段时间内的加速度计读数记录。纵轴表示以m/s^2为单位的加速度，横轴表示样本数（平均以10毫秒为单位）。加速度计和陀螺仪读数如下图所示。

![一小时内记录的用户的数据分析。顶部 – 加速度计信号，底部 – 陀螺仪信号](图片链接)

这张图包含五个清晰可见的不同区域图案。对于那些熟悉运动学的人来说，这张图透露了许多用户信息。

最明显的运动模式是步行。我们从这里开始分析。当用户走路时，戴着智能手表的手像钟摆一样摆动，这是一个周期性的过程。因此，如果图表上的加速度或方位读数根据周期性规律变化，则可以推断用户正在行走。分析数据时，综合考虑加速度计和陀螺仪读数非常有效。

让我们仔细看看短时间间隔内振幅最大的区域（紫色区域Pattern1、Pattern3和Pattern5）。

![加速度计和陀螺仪在步行时的读数](图片链接)

在这个例子中，手的周期性振荡持续了12分钟（Pattern1，如上图）。尽管通过双重数值积分计算加速度数据可以估算用户沿x和y轴方向的位移（z轴位移为零），但在没有地理信息的情况下，仍然难以准确显示用户的行进路径。

![加速度计数据的数值积分计算结果，该数据可估算用户在1小时内沿x和y轴方向的位移](图片链接)

相对于X轴位移的Y轴位移曲线显示了人的大致路径。在这种原始方法下，距离虽然不太精确，但精度可达千米级。要提高行进距离的精度，可以用人体测量数据来估计每一步的长度（这也是健身追踪器的基本功能），但这不在本次研究的范围内。

![根据对加速度计数据沿X和Y轴进行数值积分计算可确定的被观察人员的大致路径](图片链接)

相比之下，更难分析的是那些不活跃的区域。可以看到这个人在这段时间里处于休息状态。手表的方向没有变化，但存在加速度，这表明此人可能在汽车（或电梯）中移动。

下面是另一个22分钟的片段。这显然不是步行，因为没有可观察到的信号周期性振荡。但是，我们看到沿一个轴上的加速度信号膜的周期性变化，可能是直线运动但中途有停靠的公共交通工具。

![乘坐公共交通工具时的加速度计数据](图片链接)

以下是另一个时间片段：

![Pattern 3，加速度计数据](图片链接)

这似乎是短时间行走（几秒钟）、暂停和忽然的手部动作的混合物。这个人大概是在室内。

下面我们解释图上的所有区域。

![区域解码后的加速度计和陀螺仪读数](图片链接)

这是一个在三次步行（12分钟、3分钟和5分钟）中穿插地铁（20分钟和24分钟）的旅程。短步行间隔具有一些特殊的特征，因为它涉及地铁线路的更换。这些特征显而易见，但我们的兴趣在于用可在可穿戴设备上执行的算法来确定它们。因此，我们使用简单的互相关计算来代替神经网络（我们也知道神经网络对于这类任务来说非常棒）。

针对两段步行数据（Walking1和Walking2），我们用10秒钟的信号数据阵列计算了它们之间的互相关以及与噪声数据的互相关。

![两个步行部分互相关和步行部分与噪声部分的互相关函数的最大值](图片链接)

从表中可以看出，即使这种计算互相关函数的方法十分基础，也能在用户的“数字快照”中识别出运动模式，且精度高达83%（考虑到相关性）。这个指标可能看起来并不高，但需要强调的是，我们还没有优化样本规模，也没有使用更复杂的例如主成分分析的算法。

这为潜在的攻击者提供了什么？通过识别用户在地铁中的移动，并且通过对这种移动的特征方向进行判断，我们可以确定用户正在乘坐哪条地铁线路。当然，使用磁力仪可以获得有关X和Y轴在空间中方向的数据可以让这个过程更加简单。但不幸的是，电动机的强大电磁拾音、确定偏北方向的低精确度以及智能手表中相对较少的磁力计迫使我们放弃了这一想法。

如果没有关于空间X轴和Y轴方向的数据（最有可能，对于单个周期不同），解码运动轨迹的问题会变成将已知长度的时间片段叠加到地形图上的几何任务。再一次，站在攻击者的角度，我们可以寻找磁场爆发来表示电动火车（有轨或无轨电车）的加减速，这可使我们能够在感兴趣的时间片段中计算出其中的临时停靠点的数量。但这也超出了我们此次研究的范围。