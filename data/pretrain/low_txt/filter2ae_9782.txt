**作者：Snowming**  
**公众号：[奇安信A-TEAM](https://mp.weixin.qq.com/s/T0CHtLfVmuUgpa08s0-Dgw)**  
**完整下载：[CobaltStrike 4.0用户手册（中文翻译）](https://blog.ateam.qianxin.com/CobaltStrike4.0%E7%94%A8%E6%88%B7%E6%89%8B%E5%86%8C_%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91.pdf)**

Cobalt Strike 是一个专为对手模拟和红队行动设计的平台，主要用于执行有针对性的攻击和模拟高级威胁者的后渗透行为。本章将概述 Cobalt Strike 的功能集及相关攻击流程，并在后续章节中详细讨论这些功能。

### 攻击问题集
> **译者注**：图中的 `Instrumentation & Telemetry` 可以翻译为“终端行为采集代理与云端行为分析引擎”。`Instrumentation` 指的是安装在目标主机上的各类日志收集与监控工具，而 `Telemetry` 则指将这些监控工具产生的数据进行归一化处理、汇聚到统一的分析引擎并等待引擎的研判结果的过程。

一场深思熟虑的攻击始于**侦查**。Cobalt Strike 的 `System Profiler` 是一个用于客户端攻击面分析的 Web 应用程序。通过侦查流程收集的信息有助于你做出最佳决策。

**武器化**是将后渗透载荷与文档或漏洞利用相结合，以便在目标系统上执行该载荷。Cobalt Strike 提供了多种选项，可以将普通文档转换为武器化的工件，并支持以多种形式导出后渗透载荷和 Beacon。

使用 Cobalt Strike 的网络钓鱼工具将**投递**武器化文档至目标网络中的一个或多个人。该工具能够重新利用保存的电子邮件，创建像素级完美的钓鱼邮件。

利用 Cobalt Strike 的 Beacon 控制目标网络。Beacon 是一种后渗透载荷，采用**异步低频慢速通信模式**，这种模式常见于高级威胁中的恶意软件。Beacon 可通过 DNS、HTTP 或 HTTPS 等协议回连团队服务器，并可通过常见的代理配置避免被阻塞。

为了测试目标的攻击溯源能力，可以使用 Beacon 的 C2 扩展语言功能。此功能允许对 Beacon 进行重新编程，使其流量特征看起来像某些知名的恶意软件，从而达到掩盖和伪装的目的。

> **译者注**：例如，GitHub 上的开源 C2 扩展文件项目中的 `crimeware` 文件夹，可以通过配置 C2 扩展文件，使 Beacon 的流量特征看起来像 Zeus 或 Asprox 等知名恶意软件，以此来掩盖和伪装其活动。

Beacon 具有优越的自动化功能和基于命名管道及 TCP 套接字的对等通信模式，有助于攻击者进入受害者网络并进行**横向移动**。Cobalt Strike 可用于抓取信任关系，并利用抓取的证书、密码哈希、访问令牌和 Kerberos 票据等凭据进行横向移动。

使用 Cobalt Strike 的**用户利用**工具展示实际业务风险。Cobalt Strike 的工作流程使得在受害系统内部署键盘记录器或截屏工具变得非常简单。通过 Browser Pivoting 技术，可以获取受害目标 Internet Explorer 中记录的网站访问权限。这一技术在大多数站点上都有效，并且可以绕过双因素验证。

Cobalt Strike 的报告功能**重建了攻击活动的时间线**，提供了详细的活动时间表，帮助网络管理员在其监控设备（如流量监测系统）中发现攻击痕迹。高质量的报告可以作为独立报告提交给客户，或作为正式文档的附录。

在整个攻击过程中，你需要了解目标环境及其防御措施，并在资源有限的情况下选择最佳方法达成后渗透目标。这个过程被称为规避。Cobalt Strike 并不提供开箱即用的规避方案，而是提供了极大的灵活性，使用户能够在配置和执行攻击时根据具体环境和目标进行调整。

* * *