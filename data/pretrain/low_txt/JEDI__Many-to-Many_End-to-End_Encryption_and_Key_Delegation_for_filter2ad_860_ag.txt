### Availability of JEDI Cryptography Library and Protocol Implementation

The JEDI cryptography library is available at:
- [GitHub: JEDI Pairing](https://github.com/ucbrise/jedi-pairing)

Our implementation of the JEDI protocol for bw2 can be found at:
- [GitHub: JEDI Protocol](https://github.com/ucbrise/jedi-protocol)

### Acknowledgments

We extend our gratitude to our anonymous reviewers and our shepherd, William Enck, for their invaluable feedback. We also thank the students from the RISE Security Group and BETS Research Group for their constructive comments on the early drafts of this paper.

This research was supported by the following grants and gifts:
- Intel/NSF CPS-Security #1505773 and #20153754
- DoE #DE-EE000768
- California Energy Commission #EPC-15-057
- NSF CISE Expeditions #CCF-1730628
- NSF GRFP #DGE-1752814
- Sloan Foundation
- Hellman Fellows Fund
- Alibaba
- Amazon
- Ant Financial
- Arm
- Capital One
- Ericsson
- Facebook
- Google
- Intel
- Microsoft
- Scotiabank
- Splunk
- VMware

### References

1. M. Abdalla, E. Kiltz, and G. Neven. "Generalized key delegation for hierarchical identity-based encryption." *Cryptology ePrint Archive*, Report 2007/221.
2. S. G. Akl and P. D. Taylor. "Cryptographic solution to a problem of access control in a hierarchy." *TOCS*, 1983.
3. M. P. Andersen, G. Fierro, and D. E. Culler. "System design for a synergistic, low power mote/BLE embedded platform." *IPSN*, 2016.
4. M. P. Andersen, H.-S. Kim, and D. E. Culler. "Hamilton - a cost-effective, low power networked sensor for indoor environment monitoring." *BuildSys*, 2017.
5. M. P. Andersen, J. Kolb, K. Chen, D. E. Culler, and R. Katz. "Democratizing authority in the built environment." *BuildSys*, 2017.
6. M. P. Andersen, S. Kumar, M. AbdelBaky, G. Fierro, J. Kolb, H.-S. Kim, D. E. Culler, and R. A. Popa. "WAVE: A decentralized authorization framework with transitive delegation." *USENIX Security*, 2019.
7. P. Arjunan, N. Batra, H. Choi, A. Singh, P. Singh, and M. B. Srivastava. "SensorAct: A privacy and security aware federated middleware for building management." *BuildSys*, 2012.
8. M. J. Atallah, M. Blanton, N. Fazio, and K. B. Frikken. "Dynamic and efficient key management for access hierarchies." *TISSEC*, 2009.
9. M. J. Atallah, M. Blanton, and K. B. Frikken. "Incorporating temporal capabilities in existing key management schemes." *ESORICS*, 2007.
10. N. Attrapadung and H. Imai. "Conjunctive broadcast and attribute-based encryption." *ICPBC*, 2009.
11. S. Belguith, S. Cui, M. R. Asghar, and G. Russello. "Secure publish and subscribe systems with efficient revocation." *SAC*, 2018.
12. J. Bethencourt, A. Sahai, and B. Waters. "Ciphertext-policy attribute-based encryption." *S&P*, 2007.
13. A. Birgisson, J. G. Politz, Ú. Erlingsson, A. Taly, M. Vrable, and M. Lentczner. "Macaroons: Cookies with contextual caveats for decentralized authorization in the cloud." *NDSS*, 2014.
14. M. Blaze, G. Bleumer, and M. Strauss. "Divertible protocols and atomic proxy cryptography." *EUROCRYPT*, 1998.
15. A. Boldyreva, V. Goyal, and V. Kumar. "Identity-based encryption with efficient revocation." *CCS*, 2008.
16. D. Boneh and X. Boyen. "Efficient selective-ID secure identity-based encryption without random oracles." *EUROCRYPT*, 2004.
17. D. Boneh, X. Boyen, and E.-J. Goh. "Hierarchical identity based encryption with constant size ciphertext." *EUROCRYPT* and *Cryptology ePrint Archive*, 2005.
18. D. Boneh and M. Franklin. "Identity-based encryption from the Weil pairing." *CRYPTO*, 2001.
19. D. Boneh, C. Gentry, and B. Waters. "Collusion resistant broadcast encryption with short ciphertexts and private keys." *CRYPTO*, 2005.
20. D. Boneh and B. Waters. "A fully collusion resistant broadcast, trace, and revoke system." *CCS*, 2006.
21. D. Boneh, B. Waters, and M. Zhandry. "Low overhead broadcast encryption from multilinear maps." *CRYPTO*, 2014.
22. D. Boneh and M. Zhandry. "Multiparty key exchange, efficient traitor tracing, and more from indistinguishability obfuscation." *Algorithmica*, 2017.
23. C. Borcea, A. B. D. Gupta, Y. Polyakov, K. Rohloff, and G. Ryan. "PICADOR: End-to-end encrypted publish-subscribe information distribution with proxy re-encryption." *FGCS*, 2017.
24. S. Bowe. "BLS12-381: New zk-SNARK elliptic curve construction." *Zcash Blog*, 2018. [Link](https://z.cash/blog/new-snark-curve/)
25. A. Brandt, J. Hui, R. Kelsey, P. Levis, K. Pister, R. Struik, J. P. Vasseur, and R. Alexander. "RPL: IPv6 routing protocol for low-power and lossy networks." *RFC Editor*, 2012.
26. D. Brunelli, I. Minakov, R. Passerone, and M. Rossi. "POVOMON: An ad-hoc wireless sensor network for indoor environmental monitoring." *EESMS*, 2014.
27. bw2. [GitHub Repository](https://github.com/immesys/bw2)
28. B. Campbell. "Introducing Hail." *TockOS Blog*, 2017. [Link](https://www.tockos.org/blog/2017/introducing-hail/)
29. R. Cheng, W. Scott, B. Parno, I. Zhang, A. Krishnamurthy, and T. Anderson. "Talek: A private publish-subscribe protocol." *University of Washington CSE Technical Report*, 2016.
30. Cisco. "The Internet of things reference model." *Cisco Technical Report*, 2014.
31. D. Clarke, J.-E. Elien, C. Ellison, M. Fredette, A. Morcos, and R. L. Rivest. "Certificate chain discovery in SPKI/SDSI." *Journal of Computer Security*, 2001.
32. H. Corrigan-Gibbs, D. Boneh, and D. Mazières. "Riposte: An anonymous messaging system handling millions of users." *S&P*, 2015.
33. J. Crampton, N. Farley, G. Gutin, M. Jones, and B. Poettering. "Cryptographic enforcement of information flow policies without public information." *ACNS*, 2015.
34. J. Crampton, K. Martin, and P. Wild. "On key assignment for hierarchical access control." *CSFW*, 2006.
35. S. Dawson-Haggerty, X. Jiang, G. Tolle, J. Ortiz, and D. E. Culler. "sMAP: A simple measurement and actuation profile for physical information." *SenSys*, 2010.
36. S. Dawson-Haggerty, A. Krioukov, J. Taneja, S. Karandikar, G. Fierro, N. Kitaev, and D. E. Culler. "BOSS: Building operating system services." *NSDI*, 2013.
37. Y. Dodis and N. Fazio. "Public key broadcast encryption for stateless receivers." *DRM*, 2002.
38. P. Dutta, D. E. Culler, and S. Shenker. "Procrastination might lead to a longer and more useful life." *HotNets*, 2007.
39. M. Egorov and M. Wilkison. "NuCypher KMS: Decentralized key management system." *CoRR*, 2017.
40. DigiKey Electronics. "ATSAMR21E18A-MU Microchip Technology." February 8, 2019.
41. M. C. Feldmeier. "Personalized Building Comfort Control." *PhD Thesis, MIT*, 2009.
42. G. Fierro and D. E. Culler. "XBOS: An extensible building operating system." *Technical Report, EECS Department, University of California, Berkeley*, 2015.
43. Filecoin. [Website](https://filecoin.io). January 19, 2018.
44. T. Frosch, C. Mainka, C. Bader, F. Bergsma, J. Schwenk, and T. Holz. "How secure is TextSecure?" *EuroS&P*, 2016.
45. C. Gentry and S. Halevi. "Hierarchical identity based encryption with polynomially many levels." *TCC*, 2009.
46. C. Gentry and A. Silverberg. "Hierarchical ID-based cryptography." *ASIACRYPT*, 2002.
47. E.-J. Goh, H. Shacham, N. Modadugu, and D. Boneh. "SiRiUS: Securing remote untrusted storage." *NDSS*, 2003.
48. V. Goyal, O. Pandey, A. Sahai, and B. Waters. "Attribute-based encryption for fine-grained access control of encrypted data." *CCS*, 2006.
49. Hamilton IoT. [Website](https://hamiltoniot.com/)
50. Y.-C. Hu, M. Jakobsson, and A. Perrig. "Efficient constructions for one-way hash chains." *ACNS*, 2005.
51. H.-F. Huang and C.-C. Chang. "A new cryptographic key assignment scheme with time-constraint access control in a hierarchy." *Computer Standards & Interfaces*, 2004.
52. J. Hviid and M. B. Kjaergaard. "Activity-tracking service for building operating systems." *PerCom*, 2018.
53. imix: Low-power IoT research platform, 2017. [GitHub Repository](https://github.com/helena-project/imix)
54. M. Kallahalla, E. Riedel, R. Swaminathan, Q. Wang, and K. Fu. "Plutus: Scalable secure file sharing on untrusted storage." *FAST*, 2003.
55. H.-S. Kim, M. P. Andersen, K. Chen, S. Kumar, W. J. Zhao, K. Ma, and D. E. Culler. "System architecture directions for post-SoC/32-bit networked sensors." *SenSys*, 2018.
56. A. Krioukov, G. Fierro, N. Kitaev, and D. E. Culler. "Building application stack (BAS)." *BuildSys*, 2012.
57. S. Kumar, Y. Hu, M. P. Andersen, R. A. Popa, and D. E. Culler. "JEDI: Many-to-many end-to-end encryption and key delegation for IoT." *CoRR*, 2019.
58. A. Lewko, A. Sahai, and B. Waters. "Revocation systems with very small private keys." *S&P*, 2010.
59. C. Li, Z. Li, M. Li, F. Meggers, A. Schlueter, and H. B. Lim. "Energy efficient HVAC system with distributed sensing and control." *ICDCS*, 2014.
60. B. Libert, T. Peters, and M. Yung. "Group signatures with almost-for-free revocation." *CRYPTO*, 2012.
61. B. Libert, T. Peters, and M. Yung. "Scalable group signatures with revocation." *EUROCRYPT*, 2012.
62. B. Libert and D. Vergnaud. "Adaptive-ID secure revocable identity-based encryption." *CT-RSA*, 2009.
63. W. Liu, J. Liu, Q. Wu, B. Qin, D. Naccache, and H. Ferradi. "Compact CCA2-secure hierarchical identity-based broadcast encryption for fuzzy-entity data sharing." *Cryptology ePrint Archive*, Report 2016/634.
64. D. Malkhi, M. Merritt, and O. Rodeh. "Secure reliable multicast protocols in a WAN." *Dist. Computing*, 2000.
65. D. Malkhi and M. Reiter. "A high-throughput secure reliable multicast protocol." *Computer Security*, 1997.
66. A. Mehanovic, T. H. Rasmussen, and M. B. Kjærgaard. "Brume - a horizontally scalable and fault-tolerant building operating system." *IoTDI*, 2018.
67. D. Naor, M. Naor, and J. Lotspiech. "Revocation and tracing schemes for stateless receivers." *CRYPTO*, 2001.
68. A. L. M. Neto, A. L. F. Souza, I. Cunha, M. Nogueira, I. O. Nunes, L. Cotta, N. Gentille, A. A. F. Loureiro, D. F. Aranha, H. K. Patil, and L. B. Oliveira. "AoT: Authentication and access control for the entire IoT device life-cycle." *SenSys*, 2016.
69. Particle Mesh. [Website](https://www.particle.io/mesh). February 2, 2019.
70. A. Perrig, R. Szewczyk, V. Wen, D. E. Culler, and J. D. Tygar. "SPINS: Security protocols for sensor networks." *MobiCom*, 2001.
71. J. H. Seo and K. Emura. "Efficient delegation of key generation and revocation functionalities in identity-based encryption." *CT-RSA*, 2013.
72. J. H. Seo and K. Emura. "Revocable identity-based encryption revisited: Security model and construction." *PKC*, 2013.
73. J. H. Seo and K. Emura. "Revocable hierarchical identity-based encryption: History-free update, security against insiders, and short ciphertexts." *CT-RSA*, 2015.
74. H. Shafagh, L. Burkhalter, S. Duquennoy, A. Hithnawi, and S. Ratnasamy. "Droplet: Decentralized authorization for IoT data streams." *CoRR*, 2018.
75. H. Shafagh, A. Hithnawi, L. Burkhalter, P. Fischli, and S. Duquennoy. "Secure sharing of partially homomorphic encrypted IoT data." *SenSys*, 2017.
76. Solace Cloud. [Website](https://solace.com). January 17, 2018.
77. A. Taly and A. Shankar. "Distributed authorization in Vanadium." *FOSAD VIII*, 2016.
78. M. A. Tariq, B. Koldehofe, and K. Rothermel. "Securing broker-less publish/subscribe systems using identity-based encryption." *TPDS*, 2014.
79. V. Tron, A. Fischer, and N. Johnson. "Smash-proof: Auditable storage for Swarm secured by masked audit secret hash." *Ethersphere Technical Report*, 2016.
80. W.-G. Tzeng. "A time-bound cryptographic key assignment scheme for access control in a hierarchy." *TKDE*, 2002.
81. J. van den Hooff, D. Lazar, M. Zaharia, and N. Zeldovich. "Vuvuzela: Scalable private messaging resistant to traffic analysis." *SOSP*, 2015.
82. VOLTTRON. [Website](https://volttron.org/). January 23, 2019.
83. F. Wang, J. Mickens, N. Zeldovich, and V. Vaikuntanathan. "Sieve: Cryptographically enforced access control for user data in untrusted clouds." *NSDI*, 2016.
84. G. Wang, Q. Liu, and J. Wu. "Hierarchical attribute-based encryption for fine-grained access control in cloud storage services." *CCS*, 2010.
85. G. Wang, Q. Liu, J. Wu, and M. Guo. "Hierarchical attribute-based encryption and scalable user revocation for sharing data in cloud servers." *Computers & Security*, 2011.
86. Y. Watanabe, K. Emura, and J. H. Seo. "New revocable IBE in prime-order groups: Adaptively secure, decryption key exposure resistant, and with short public parameters." *CT-RSA*, 2017.
87. D. J. Wu, A. Taly, A. Shankar, and D. Boneh. "Privacy, discovery, and authentication for the Internet of things." *ESORICS*, 2016.
88. D. Yao, N. Fazio, Y. Dodis, and A. Lysyanskaya. "ID-based encryption for complex hierarchies with applications to forward security and broadcast encryption." *CCS*, 2004.
89. W. Ye, J. Heidemann, and D. Estrin. "An energy-efficient MAC protocol for wireless sensor networks." *INFOCOM*, 2002.
90. S. Yu, C. Wang, K. Ren, and W. Lou. "Achieving secure, scalable, and fine-grained data access control in cloud computing." *INFOCOM*, 2010.
91. T. Zachariah, N. Klugman, B. Campbell, J. Adkins, N. Jackson, and P. Dutta. "The Internet of things has a gateway problem." *HotMobile*, 2015.
92. Zigbee Gateway. [Website](https://www.zigbee.org/zigbee-for-developers/zigbee-gateway/). February 13, 2019.