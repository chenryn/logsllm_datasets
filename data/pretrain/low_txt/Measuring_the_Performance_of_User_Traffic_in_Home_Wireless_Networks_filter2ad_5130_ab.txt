### Increases in Coefficient and Bitrate Correlation

The coefficient for bitrate follows a similar trend, but the correlation is weaker for access links with speeds exceeding 60 Mbps. In such cases, the wireless network may be operating closer to its capacity. (The default setting of the access points supports a maximum bitrate of 130 Mbps, which translates to a TCP throughput of about 85 Mbps under ideal conditions; actual throughput will likely be lower.) Patro et al. [10] also show, in a more limited setting (dense deployments in two apartment complexes), that achieved throughput is highly correlated with the above-mentioned wireless metrics.

### Latency Inside a Home Network

The TCP round-trip time (RTT) between the wireless access point and a wireless client should typically be around one millisecond. As this RTT increases, it not only indicates that the wireless link is bottlenecked due to buffering or medium access delays, but it can also have an adverse impact on performance, especially for latency-sensitive applications. Figure 4a plots the distribution of the median LAN RTT (as defined in Sect. 2.2) across all devices in our study. The median device on the local wireless network experiences a median wireless latency of about 8 ms, but nearly 30% of the devices experience local TCP round-trip latencies greater than 15 ms. Buffering affects latency, particularly for mobile devices that sleep more frequently. While we cannot distinguish mobile devices in our dataset (because we anonymize MAC addresses and do not inspect the payload), we try to minimize this issue by considering the mean of the RTTs, and only for flows with at least 25 packets in the downstream direction.

We also analyze the performance of the home network relative to the wide-area network performance by comparing the round-trip times between the devices and the access point to the round-trip times from the access point to the wide-area destination for each flow. We define the median latency ratio for a device as the median ratio of the LAN RTT to the WAN RTT (Sect. 2.2) across all flows for that device. Figure 4b shows the distribution of the median latency ratio across all devices. The results indicate that 30% of devices have a median latency ratio greater than 0.2, meaning that for these devices, at least half of the flows have end-to-end latencies where the home wireless network contributes more than 20% of the overall end-to-end latency.

### Wireless Performance of User Traffic

We now characterize the wireless performance in our deployment. Our preliminary findings include: (1) the 5 GHz wireless band consistently achieves better performance than the 2.4 GHz band; (2) the performance of a home wireless network varies across individual wireless devices within the same home; and (3) multiple devices in the same home network rarely send high traffic volumes simultaneously.

#### 5 GHz Band vs. 2.4 GHz Band

We analyze the performance that devices in home wireless networks achieve and how performance varies depending on whether devices are on the 2.4 GHz band or the 5 GHz band. Our hypothesis was that devices on the 5 GHz band would perform better because there are generally fewer devices (and surrounding access points) in the 5 GHz band, and the 5 GHz band also has less non-WiFi interference (e.g., microwaves, baby monitors). As shown in previous studies, devices on 2.4 GHz experience both WiFi and non-WiFi interference [10].

Figure 5a shows the impact of spectrum on flow throughput for flows with throughput greater than 1 Mbps. We present the normalized flow throughput to eliminate any bias related to the access link capacity. Flows to devices on the 5 GHz spectrum have higher normalized throughput than those on 22.4 GHz. Similarly, Figure 5b shows that the LAN RTT for flows in the 2.4 GHz band is much higher than for flows in the 5 GHz band. The distribution of normalized flow throughput in each spectrum is similar when considering flows whose normalized throughput is less than 0.1. We are investigating this phenomenon, but these could include cases where there is not enough application demand. Even in those cases, however, the LAN RTTs are smaller for devices connected over 5 GHz.

Figure 6 plots the cumulative distribution function (CDF) of the median bitrate for all devices in all homes, for both the 2.4 GHz and 5 GHz bands. Only 30% of 2.4 GHz devices see median bitrates above 65 Mbps; in contrast, more than 50% of devices in the 5 GHz spectrum see bitrates greater than 100 Mbps. It is worth noting that the wireless bitrates do not correspond to the actual throughput. Even under perfect conditions, a wireless bitrate of 130 Mbps corresponds to an actual TCP throughput of about 80 Mbps. The bitrate values thus reflect a loose upper bound on the achievable end-to-end throughput.

Figure 7 shows the median bitrate per device for each home network, normalized by the maximum supported bitrate of the corresponding wireless protocol (between 65 Mbps and 300 Mbps for 802.11n, and 54 Mbps for 802.11a/g). Many devices, especially those in the 2.4 GHz range, often operate close to the maximum bitrate supported by the protocol, more so than 5 GHz devices. However, we also see that the maximum bitrates of 5 GHz devices are higher. This discrepancy can be explained by the fact that many devices in the 2.4 GHz channel could be small mobile devices with single antennas that restrict their maximum bitrates to 65 Mbps. Additionally, attenuation is higher on 5 GHz, which could lead to more active bitrate adaptation.

Figure 8 shows the retransmission rates for all devices across all homes; the results show similar trends with respect to the 2.4 GHz and 5 GHz ranges: retransmissions are more common in the 2.4 GHz band, with about 20% of devices having retransmission rates above 10%.

#### Individual Device Performance in a Single Home Network

We also studied the performance of individual devices in a home network and the extent to which wireless performance varies across devices in the same home network. We found many cases where the median wireless retransmission rates for a device were high. For the devices in the home shown in Figure 9, nearly all of the devices have median retransmission rates greater than 10%. Interestingly, one device experiences a high retransmission rate nearly all of the time, suggesting a persistent problem that may result from device placement, interactions between the access point and that device’s driver, or some other cause.

To study how wireless performance varies across devices in a single home, we measure the K-S distance of the distributions of raw wireless bitrates between each pair of devices in each home. Figure 10a plots the median and the maximum pairwise K-S distance in each home. We find that more than 80% of homes have at least one pair of devices with a K-S distance of more than 0.6, indicating that most homes have at least one poorly performing device (due to either poor placement, poor hardware, or poor drivers). We investigate the variance of RSSI across different devices and observe similar differences (Figure 10b). Future work could involve further investigating the disparate performance across devices and determining whether the variability in device performance is caused by any single factor.

#### Simultaneous Communication

Most of the homes in our deployment had more than one active device during our study. Interestingly, however, these devices often were not highly active at the same time. We measured one-second intervals and observed the number of times that multiple devices were sending at least 25 packets within the one-second interval. To our surprise, simultaneous communication was rare: for 85% of the one-second intervals on the 2.4 GHz band and 93% of the intervals on the 5 GHz band, we observed at most one device sending at least 25 packets in the interval. This observation relates to wireless contention and may imply that certain types of wireless contention are infrequent. This finding contrasts with previous work that shows that contention is a factor in wireless performance [10]. This discrepancy may result from differences in either deployment locations or measurement methods and warrants further exploration.

### Related Work

We focus our survey of related work on studies of wireless performance in real deployments and on attempts to detect and characterize common wireless performance problems.

The WiSe project is most similar to our efforts [10]; WiSe is a deployment of multiple wireless monitors in a diverse set of home environments that are configured with custom measurement and monitoring software. In this deployment, each access point is a custom OpenWrt-based embedded device with two network interface cards: one that forwards traffic and another that monitors the quality of the wireless channel. Because each WiSe access point has two interfaces, the deployment sees a much more complete picture of the wireless spectrum. The deployment is also concentrated in two dense residential complexes; our deployment is larger and more diverse, but it does not use custom hardware with multiple network interfaces, which limits our ability to collect certain types of measurements. The work also designs an estimator for TCP performance based on wireless performance metrics; validating this model in our own testbed is part of our ongoing work. Other efforts have deployed dense monitors to study wireless in conferences and university buildings [3,5,6]; these studies explore similar characteristics but do not focus on home network settings, which are generally lightly managed (or unmanaged) and hence potentially more chaotic. Papagiannaki et al. [9] deploy and measure wireless performance characteristics in three homes.

Other work has characterized wireless performance problems using custom hardware or active measurements. Rayanchu et al. [13] detected non-wireless interference using custom hardware. Kanuparthy et al. [4] developed a tool to detect wireless performance problems (e.g., low signal-to-noise ratio, congestion, hidden terminals) using both active probes and an additional passive monitor deployed within the network. Other techniques have also studied different types of wireless performance problems. Manweiler et al. build a tool to detect hidden interference in homes and adjust channel selection to minimize interference [7]; the tool requires a custom kernel and does not run on a commodity access point. Shrivastava et al. develop a tool for estimating interference in enterprise wireless LANs [14]; the tool requires collection and analysis of packet traces at multiple access points within an enterprise to perform diagnosis.

### Conclusion

In this paper, we characterized the performance of user traffic in home wireless networks from 66 homes in 15 countries using passive network measurements. We analyzed passively collected traces in both the 2.4 GHz and the 5 GHz spectrum. One of the more significant challenges in executing this study involved designing a measurement tool that could operate within the tight constraints of a commodity home router and draw reasonable inferences from a single vantage point without a second monitor radio. Our study of this real user traffic in home networks revealed that most TCP flows in home networks achieve only a small fraction of the available access link throughput, that wireless characteristics have a greater effect on the performance of user traffic as access link throughput increases, that the 5 GHz channel exhibits better performance than the 2.4 GHz band, and that distinct devices within the same home can see very different wireless performance. We plan to build on these insights to create a diagnostic tool that can identify both the location of the network bottleneck link and the underlying causes of the bottleneck, should it lie in the wireless network. Finally, although wireless performance often suffers as a result of transient factors, such as microwaves, passing humans, or even minute changes in orientation of devices, many wireless performance problems are persistent. Our ability to monitor wireless performance over longer time periods in many homes may shed light on the persistent performance problems, which could offer a more holistic picture of wireless network performance problems.

### References

1. Adya, A., Bahl, P., Chandra, R., Qiu, L.: Architecture and techniques for diagnosing faults in IEEE 802.11 infrastructure networks. In: MobiCom 2004, pp. 30–44. ACM, New York (2004). http://doi.acm.org/10.1145/1023720.1023724
2. BISMark: Broadband Internet Service Benchmark. http://projectbismark.net/
3. Cheng, Y.C., Afanasyev, M., Verkaik, P., Benkő, P., Chiang, J., Snoeren, A.C., Savage, S., Voelker, G.M.: Automating cross-layer diagnosis of enterprise wireless networks. SIGCOMM Comput. Commun. Rev. 37(4), 25–36 (2007)
4. Kanuparthy, P., Dovrolis, C., Papagiannaki, K., Seshan, S., Steenkiste, P.: Can user-level probing detect and diagnose common home-WLAN pathologies. SIGCOMM Comput. Commun. Rev. 42(1), 7–15 (2012)
5. Kotz, D., Essien, K.: Analysis of a campus-wide wireless network. Wirel. Netw. 11(1–2), 115–133 (2005)
6. Mahajan, R., Rodrig, M., Wetherall, D., Zahorjan, J.: Analyzing the MAC-level behavior of wireless networks in the wild. In: SIGCOMM 2006, pp. 75–86 (2006)
7. Manweiler, J., Franklin, P., Choudhury, R.: RxIP: monitoring the health of home wireless networks. In: INFOCOM, 2012 Proceedings IEEE, pp. 558–566, Mar 2012
8. Minstrel rate adaptation algorithm. http://goo.gl/5xPSC
9. Papagiannaki, K., Yarvis, M., Conner, W.S.: Experimental characterization of home wireless networks and design implications. In: Proceedings of the IEEE INFOCOM, Barcelona, Spain, Mar 2006
10. Patro, A., Govindan, S., Banerjee, S.: Observing home wireless experience through WiFi APS. In: MobiCom 2013, pp. 339–350. ACM, New York (2013)
11. Radiotap. http://radiotap.org
12. Rayanchu, S., Mishra, A., Agrawal, D., Saha, S., Banerjee, S.: Diagnosing wireless packet losses in 802.11: separating collision from weak signal. In: INFOCOM 2008, pp. 735–743, Apr 2008
13. Rayanchu, S., Patro, A., Banerjee, S.: Airshark: detecting non-WiFi RF devices using commodity WiFi hardware. In: IMC 2011, pp. 137–154. ACM, New York (2011)
14. Shrivastava, V., Rayanchu, S., Banerjee, S., Papagiannaki, K.: PIE in the sky: online passive interference estimation for enterprise WLANs. In: NSDI 2011, p. 25. USENIX Association, Berkeley (2011)
15. Siekkinen, M., Collange, D., Urvoy-Keller, G., Biersack, E.W.: Performance limitations of ADSL users: a case study. In: Uhlig, S., Papagiannaki, K., Bonaventure, O. (eds.) PAM 2007. LNCS, vol. 4427, pp. 145–154. Springer, Heidelberg (2007)
16. Sundaresan, S., de Donato, W., Feamster, N., Teixeira, R., Crawford, S., Pescapé, A.: Broadband internet performance: a view from the gateway. In: Proceedings of the ACM SIGCOMM, Toronto, ON, Canada, Aug 2011
17. Sundaresan, S., Burnett, S., de Donato, W., Feamster, N.: BISmark: a testbed for deploying measurements and applications in broadband access networks. In: Proceedings of the USENIX Annual Technical Conference, Philadelphia, CA, June 2014
18. Zhang, Y., Breslau, L., Paxson, V., Shenker, S.: On the characteristics and origins of internet flow rates. In: Proceedings of the ACM SIGCOMM, Pittsburgh, PA, Aug 2002