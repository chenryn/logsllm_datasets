### Optimized Text

**Statistical Assessment and Future Testing:**
The resulting power was below our target, leading us to rely on direct observations supported by crawler metadata. If the experiment were to be repeated to validate improvements in blacklisting or to continuously test the ecosystem, statistical tests could be highly useful in assessing whether per-entity blacklisting performance improved significantly for each respective cloaking filter.

### VI. SECURITY RECOMMENDATIONS

**Based on our experimental findings, we propose several possible improvements to the anti-phishing ecosystem.**

#### A. Cloaking
Our first set of recommendations focuses specifically on the cloaking techniques we tested.

1. **Mobile Users:**
   We believe that the highest priority within the current ecosystem should be effective phishing protection for mobile users. These users are not only inherently more vulnerable to phishing attacks [41], but they also now comprise the majority of web traffic [4].

   Our work has been impactful in better securing mobile users by enhancing existing anti-phishing systems. For over a year between mid-2017 and late 2018, GSB blacklists (with nearly 76% global market share) did not function properly on mobile devices: none of our phishing sites with Filter A, E, or F (targeting both desktop and mobile devices) showed any warnings in mobile Chrome, Safari, or Firefox, despite being blacklisted on desktop. We confirmed the disparity between desktop and mobile protection through periodic small-scale testing and by analyzing an undisclosed dataset of traffic to real phishing sites. Following our disclosure, we learned that the inconsistency in mobile GSB blacklisting was due to the transition to a new mobile API designed to optimize data usage, which ultimately did not function as intended. Because blacklisting was not rectified after our full tests, we contacted the entities again. As a result, in mid-September 2018, Mozilla patched Firefox (from version 63) such that all desktop warnings were also shown on mobile. Google followed suit days thereafter with a GSB API fix that covered mobile GSB browsers retroactively; mobile Chrome and Safari now mirror desktop listings, albeit with a shorter-lived duration to lower bandwidth usage. Chrome, Safari, and Firefox thus join Opera as mobile browsers with effective blacklists, though some popular mobile browsers still lack such protection [41].

   Upon close inspection of the preliminary test results, we found that Filter B sites were solely blacklisted due to their suspicious URLs rather than our reports. During our full tests, not a single site with Filter B was blacklisted in any browser, interestingly despite the fact that crawlers did successfully retrieve many of these sites. GSB addressed this vulnerability in mid-September 2018, together with the aforementioned API fix. Through a subsequent final redeployment of PhishFarm, we verified that sites with Filter B were being blacklisted following reports to GSB, the APWG, and PayPal. Other entities, including those we did not test, should ensure that sites targeted at mobile users are being effectively detected.

2. **Geolocation:**
   Although our experiments only considered two simple geolocation filters (US and non-US), our findings indicate exploitable weaknesses in this area. Given the overwhelming amount of crawler traffic from the US (79%, per Table IX in Appendix III), Filter C should not have been as effective as it proved to be. We hypothesize that other geo-specific filters would have similarly low blacklisting rates, in part due to the crawler characteristics discussed in Section V-F1. Country- or region-specific filtering paired with localized page content is not an unusual sight in real-world PayPal phishing kits that we have analyzed.

3. **JavaScript:**
   It is trivial to implement JavaScript-based cloaking, such as Filter F. This technique proved to be effective in slowing blacklisting by three of the five entities in our full tests. Fortunately, SmartScreen bypasses this technique well, and PayPal started doing so following our disclosure. The broader ecosystem should better adapt to client-side cloaking, particularly if its sophistication increases over time.

#### B. Anti-Phishing Entities
We also offer several general recommendations for future anti-phishing systems.

1. **Continuous Testing:**
   The mere failure of mobile blacklisting observed during our experiments is sufficient to warrant the need for continuous testing and validation of blacklist performance. Periodic deployment of PhishFarm could be used for such validation. Continuous testing could help ensure that future cloaking techniques, which may grow in sophistication, can be effectively mitigated without compromising existing defenses. Additionally, trends in the relative performance of different entities and the overall timeliness and coverage of blacklisting could be modeled.

2. **Trusted Reporting Channels:**
   The phishing reporting channels we tested merely capture a suspected URL or a malicious email. While the latter is useful in identifying spam origin, we believe a better solution would be the implementation of standardized trusted phishing reporting systems that allow the submission of specific metadata (such as victim geolocation or device). Trusted channels could allow detection efforts to more precisely target high-probability threats while minimizing abuse from deliberate false-negative submissions; they could also simplify and expedite collaboration efforts between anti-phishing entities and abused brands, which may hold valuable intelligence about imminent threats.

3. **Blacklist Timeliness:**
   The gap between the detection of a phishing website and its blacklisting across browsers represents the prime window for phishers to successfully carry out their attacks. At the level of an individual entity, cloaking has a stronger effect on the occurrence rather than the timeliness of blacklisting. However, if we look at the ecosystem as a whole in Figure 3, cloaking clearly delays blacklisting overall. Our test results show that blacklisting now typically occurs in a matter of hours—a stark improvement over the day- or week-long response time observed years ago [6], [55]. However, given the tremendous increase in total phishing attacks since then (on the order of well over 100 attacks per hour in 2018 [2]), we believe that even today’s 40-minute best-case blacklist response time is too slow to deter phishers and effectively protect users. The gap needs to be narrowed, especially by slower entities (i.e., those not directly in control of blacklists). Future work should investigate the real-world impact of delays in blacklisting on users and organizations victimized by phishing attacks to accurately establish an appropriate response threshold.

4. **Volume:**
   GSB, the APWG, and PayPal crawled nearly all of the phishing sites we reported. In particular, GSB proved to deliver a consistently agile response time despite the high number of reports we submitted. Other entities fell short of this level of performance. With increasing volumes of phishing attacks, it is essential that all players in the ecosystem remain robust and capable of delivering a consistent response.

5. **Data Sharing:**
   Data sharing has long been a concern within the ecosystem [56]. We found that the two main blacklist operators (GSB and SmartScreen) did not appear to effectively share data with each other, as per Table VI. However, clearinghouse entities (APWG and PhishTank) and PayPal itself showed consistent protection across all browsers. Unfortunately, the timeliness and overall coverage of clearinghouses appear to be inferior to those of the blacklist operators in their respective browsers. Closer cooperation could thus not only speed up blacklisting but also ensure that malicious sites are blocked universally. Strengthening this argument, perhaps a breakdown in communication between infrastructure used by different entities accounted for those of our sites that were successfully crawled but not ultimately blacklisted.

### VII. RELATED WORK

To the best of our knowledge, our work is the first controlled effort to measure the effects of cloaking in the context of phishing. Several prior studies measured the general effectiveness of anti-phishing blacklists and the behavior of phishing kits; none of the prior work we identified considered cloaking, which may have had a skewing effect on the datasets and ecosystem findings previously reported. Cloaking itself has previously been studied with respect to malicious search engine results; Invernizzi et al. [7] proposed a system to detect such cloaking with high accuracy. Oest et al. [8] later studied the nature of server-side cloaking techniques within phishing kits and proposed approaches for defeating each.

The work most similar to ours is NSS Labs’ [39] recent use of a proprietary distributed testbed [57] to study the timeliness of native phishing blacklisting in Chrome, Firefox, and Edge. The main limitation of NSS Labs’ approach is the reliance on feeds of known phishing attacks; any delay in the appearance of a site in each source feed can affect the accuracy of blacklisting time measurements. Furthermore, phishing sites could be overlooked in the case of successful cloaking against the feeds. We address these limitations by having full control over the deployment and reporting time of phishing sites.

Sheng et al. [6] took an empirical approach to measure the effectiveness of eight anti-phishing toolbars and browsers powered by five anti-phishing blacklists. The authors found that heuristics by Microsoft and Symantec proved effective in offering zero-hour protection against a small fraction of phishing attacks, and that full propagation across phishing blacklists spanned several hours. This work also found that false positive rates in blacklists are near-zero; we thus did not pursue such tests in our experiments. While Sheng et al.’s work was based on phishing sites only 30 minutes old, and was thus better controlled than earlier blacklist tests [58], the datasets studied were of limited size and heterogeneous in terms of victim brands; the anti-phishing tools evaluated are now dated. In addition, Sheng et al. checked blacklist status with a granularity of one hour—longer than our 10 minutes.

Han et al. [25] analyzed the lifecycle of phishing sites by monitoring cybercriminals’ behavior on a honeypot web server. The authors timed the blacklisting of the uploaded sites across Google Safe Browsing and PhishTank. Uniquely, this work sheds light on the time between the creation and deployment of real phishing sites. A key difference in our work is our ability to customize and test different configurations of phishing kits instead of waiting for one to be uploaded. For instance, we could target specific brands or configure our own cloaking techniques to directly observe the ecosystem’s response. Our experiments suggest a significantly faster blacklist response time by the ecosystem than what Han et al. found; our test sample size was also nearly five times larger.

Virvilis et al. [41] carried out an evaluation of mobile web browser phishing protection in 2014 and found that major mobile web browsers at the time included no phishing protection. Like that of Sheng et al., this evaluation was empirical and based on a set of known phishing URLs. In our work, we found that mobile Chrome, Safari, and Firefox now natively offer blacklist protection, but that this protection was not functioning as advertised during our tests.

The differences between today’s phishing trends and those seen in prior work show that the ecosystem is evolving quickly. This warrants regular testing of defenses and re-evaluation of criminals’ circumvention techniques and attack vectors; it also underscores the importance of scalable and automatable solutions. Our testbed shares some similarities with previous work [39], [6] but it is the only such testbed to offer full automation without the need for intervention during the execution of experiments, and the only one to actively deploy sites and directly send reports to entities.

### VIII. CONCLUSION

By launching and monitoring a large set of phishing sites, we carried out the first controlled evaluation of how cloaking techniques can hamper the timeliness and occurrence of phishing blacklist warnings in modern web browsers. As a result of our disclosure to anti-phishing entities, mobile blacklisting is now more consistent, and some of the cloaking techniques we tested are no longer as effective; others represent ongoing vulnerabilities which could be addressed through tweaks to existing detection systems. Such tweaks should also seek to improve overall timeliness of blacklists to better counter the modern onslaught of phishing attacks. Blacklist protection should not be taken for granted; continuous testing—such as that supported by our framework—is key to ensuring that browsers are secured sufficiently and as intended.

Cloaking carries a detrimental effect on the occurrence of blacklisting due to the fundamentally reactive nature of the main detection approach currently used by blacklists; it thus has the potential to cause continuous damage to the organizations and users targeted by phishers. Although no single entity we tested was able to individually defeat all of our cloaking techniques, collectively the requisite infrastructure is already in place. In the short term, collaboration among existing entities could help address their individual shortcomings. We observed that proactive defenses (such as the URL heuristics of SmartScreen) proved to deliver superior protection—but only under the right circumstances. In the long term, the ecosystem should move to more broadly implement general-purpose proactive countermeasures to more reliably negate cloaking. It is important for the ecosystem to be able to effectively bypass cloaking because it is merely one way in which phishing sites can be evasive. For instance, with cloaking alongside redirection chains or bulletproof hosting, phishing sites might otherwise avoid existing mitigations far more successfully than what we have observed.

Phishing has proven to be a difficult problem to solve due to attackers’ unyielding persistence, the cross-organizational nature of infrastructure abused to facilitate phishing, and the reality that technical controls cannot always compensate for the human weakness exploited by social engineers. We believe that continuous and close collaboration between all anti-abuse entities, which can lead to a deep understanding of current threats and development of intelligent defenses, is the crux of optimizing controls and delivering the best possible long-term protection for phishing victims.

### ACKNOWLEDGMENTS

The authors would like to thank the reviewers for their insightful feedback and suggestions. This work was partially supported by PayPal, Inc. and a grant from the Center for Cybersecurity and Digital Forensics at Arizona State University.

### REFERENCES

[References remain unchanged]

---

This optimized text aims to enhance clarity, coherence, and professionalism while maintaining the original content's integrity.