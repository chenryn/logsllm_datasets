**Authorized Use and Download Information:**

This document is authorized for licensed use by IEEE Xplore. It was downloaded on March 18, 2021, at 12:10:26 UTC from IEEE Xplore. Usage restrictions apply.

---

### References

1. N. Heninger, Z. Durumeric, E. Wustrow, and J. A. Halderman, "Mining Your Ps and Qs: Detection of Widespread Weak Keys in Network Devices," in *Proceedings of the 21st USENIX Security Symposium*, August 2012.

2. Y. Zhou and D. Evans, "Why Aren't HTTP-Only Cookies More Widely Deployed?" in *Proceedings of the Web 2.0 Security and Privacy 2010 Workshop (W2SP '10)*, 2010.

3. S. Fogie, J. Grossman, R. Hansen, A. Rager, and P. D. Petkov, *XSS Attacks: Cross Site Scripting Exploits and Defense*. Syngress, 2011.

4. Randy Westergren, "Widespread XSS Vulnerabilities in Ad Network Code Affecting Top Tier Publishers," *RandyWestergren.com*, 2016. [Online]. Available: http://randywestergren.com/widespread-xss-vulnerabilities-ad-network-code-affecting-top-tier-publishers-retailers.

5. N. Perlroth, J. Larson, and S. Shane, "The New York Times - N.S.A. Able to Foil Basic Safeguards of Privacy on Web," *The New York Times*, September 2013. [Online]. Available: http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html.

6. R. Gallagher, "The Intercept - From Radio to Porn, British Spies Track Web Users' Online Identities," *The Intercept*, September 2015. [Online]. Available: https://theintercept.com/2015/09/25/gchq-radio-porn-spies-track-web-users-online-identities/.

7. A. Soltani, A. Peterson, and B. Gellman, "The Washington Post - NSA Uses Google Cookies to Pinpoint Targets for Hacking," *The Washington Post*, December 2013. [Online]. Available: https://www.washingtonpost.com/news/the-switch/wp/2013/12/10/nsa-uses-google-cookies-to-pinpoint-targets-for-hacking/.

8. BBC News, "NSA 'Targets' Tor Web Servers and Users," *BBC News*, July 2014. [Online]. Available: http://www.bbc.com/news/technology-28162273.

9. R. Gross and A. Acquisti, "Information Revelation and Privacy in Online Social Networks," in *Proceedings of the 2005 ACM Workshop on Privacy in the Electronic Society (WPES '05)*, 2005.

10. I. Polakis, G. Argyros, T. Petsios, S. Sivakorn, and A. D. Keromytis, "Where's Wally? Precise User Discovery Attacks in Location Proximity Services," in *CCS '15*, 2015, pp. 817–828.

11. A. Hannak, P. Sapiezynski, A. Molavi Kakhki, B. Krishnamurthy, D. Lazer, A. Mislove, and C. Wilson, "Measuring Personalization of Web Search," in *Proceedings of the 22nd International Conference on World Wide Web (WWW '13)*, 2013.

12. X. Xing, W. Meng, D. Doozan, A. C. Snoeren, N. Feamster, and W. Lee, "Take This Personally: Pollution Attacks on Personalized Services," in *Proceedings of the 22nd USENIX Security Symposium*, 2013.

13. A. Chaabane, G. Acs, and M. A. Kaafar, "You Are What You Like! Information Leakage Through Users' Interests," in *Proceedings of the Network and Distributed System Security Symposium (NDSS '12)*, 2012.

14. comScore, "U.S. Desktop Search Engine Rankings - July 2015," *comScore*, August 2015. [Online]. Available: http://www.comscore.com/Insights/Market-Rankings/comScore-Releases-July-2015-U.S.-Desktop-Search-Engine-Rankings.

15. A. Acquisti, R. Gross, and F. Stutzman, "Faces of Facebook: Privacy in the Age of Augmented Reality," *BlackHat*, 2011.

16. I. Polakis, G. Kontaxis, S. Antonatos, E. Gessiou, T. Petsas, and E. P. Markatos, "Using Social Networks to Harvest Email Addresses," in *Proceedings of the 9th Annual ACM Workshop on Privacy in the Electronic Society (WPES '10)*, 2010.

17. F. M. Harper, D. Raban, S. Rafaeli, and J. A. Konstan, "Predictors of Answer Quality in Online Q&A Sites," in *Proceedings of the SIGCHI Conference on Human Factors in Computing Systems (CHI '08)*, 2008.

18. D. Pelleg, E. Yom-Tov, and Y. Maarek, "Can You Believe an Anonymous Contributor? On Truthfulness in Yahoo! Answers," in *SOCIALCOM-PASSAT '12*, 2012.

19. J. A. Calandrino, A. Kilzer, A. Narayanan, E. W. Felten, and V. Shmatikov, "You Might Also Like: Privacy Risks of Collaborative Filtering," in *Proceedings of the 2011 IEEE Symposium on Security and Privacy*, 2011.

20. J. Y. Tsai, S. Egelman, L. Cranor, and A. Acquisti, "The Effect of Online Privacy Information on Purchasing Behavior: An Experimental Study," *Info. Sys. Research*, vol. 22, no. 2, 2011.

21. N. Christin, S. S. Yanagihara, and K. Kamataki, "Dissecting One Click Frauds," in *Proceedings of the 17th ACM Conference on Computer and Communications Security*, 2010.

22. U. Chareca, "Inferring User Demographics from Reading Habits," Master’s thesis, Linköping University, 2014.

23. J. R. Mayer and J. C. Mitchell, "Third-Party Web Tracking: Policy and Technology," in *Proceedings of the 2012 IEEE Symposium on Security and Privacy*, 2012.

24. F. Roesner, T. Kohno, and D. Wetherall, "Detecting and Defending Against Third-Party Tracking on the Web," in *Proceedings of the 9th USENIX Conference on Networked Systems Design and Implementation (NSDI '12)*, 2012.

25. P. Gill, V. Erramilli, A. Chaintreau, B. Krishnamurthy, K. Papagiannaki, and P. Rodriguez, "Follow the Money: Understanding Economics of Online Aggregation and Advertising," in *Proceedings of the 2013 Conference on Internet Measurement Conference (IMC '13)*, 2013.

26. P. Barford, I. Canadi, D. Krushevskaja, Q. Ma, and S. Muthukrishnan, "Adscape: Harvesting and Analyzing Online Display Ads," in *Proceedings of the 23rd International Conference on World Wide Web (WWW '14)*, 2014.

27. A. Datta, M. C. Tschantz, and A. Datta, "Automated Experiments on Ad Privacy Settings: A Tale of Opacity, Choice, and Discrimination," *Proceedings on Privacy Enhancing Technologies*, vol. 2015, no. 1, 2015.

28. M. Lécuyer, G. Ducoffe, F. Lan, A. Papancea, T. Petsios, R. Spahn, A. Chaintreau, and R. Geambasu, "XRay: Enhancing the Web's Transparency with Differential Correlation," in *Proceedings of the 23rd USENIX Security Symposium*, 2014.

29. A. Korolova, "Privacy Violations Using Microtargeted Ads: A Case Study," in *Proceedings of the 2010 IEEE International Conference on Data Mining Workshops (ICDMW '10)*, 2010.

30. A. Kapravelos, C. Grier, N. Chachra, C. Kruegel, G. Vigna, and V. Paxson, "Hulk: Eliciting Malicious Behavior in Browser Extensions," in *Proceedings of the 23rd USENIX Security Symposium*, 2014.

31. Cisco, "Visual Networking Index, Global Traffic Forecast," *Cisco*, May 2015. [Online]. Available: https://www.cisco.com/c/en/us/solutions/collateral/service-provider/ip-ngn-ip-next-generation-network/white-paper-c11-481360.html.

32. PurpleWiFi, "Our Latest Survey: How Do People Use WiFi in Public Places?" *PurpleWiFi*, June 2014. [Online]. Available: http://www.purplewifi.net/latest-survey-people-use-wifi-public-places.

33. R. Dingledine, N. Mathewson, and P. Syverson, "Tor: The Second-Generation Onion Router," in *Proceedings of the 13th USENIX Security Symposium (SSYM '04)*, 2004.

34. EFF, "HTTPS Everywhere." [Online]. Available: https://www.eff.org/https-everywhere.

35. X. Zheng, J. Jiang, J. Liang, H. Duan, S. Chen, T. Wan, and N. Weaver, "Cookies Lack Integrity: Real-World Implications," in *Proceedings of the 24th USENIX Security Symposium*, 2015.

36. A. P. Felt, A. Ainslie, R. W. Reeder, S. Consolvo, S. Thyagaraja, A. Bettes, H. Harris, and J. Grimes, "Improving SSL Warnings: Comprehension and Adherence," in *Proceedings of the Conference on Human Factors and Computing Systems*, 2015.

37. B. Potter, "Wireless Hotspots: Petri Dish of Wireless Security," *Communications of the ACM*, vol. 49, no. 6, June 2006.

38. A. Bortz, A. Barth, and A. Czeskis, "Origin Cookies: Session Integrity for Web Applications," in *Proceedings of the Web 2.0 Security and Privacy 2011 Workshop (W2SP '11)*, 2011.

39. R. Wang, S. Chen, and X. Wang, "Signing Me onto Your Accounts through Facebook and Google: A Traffic-Guided Security Study of Commercially Deployed Single-Sign-On Web Services," in *Proceedings of the 2012 IEEE Symposium on Security and Privacy*, 2012.

40. C. Karlof, U. Shankar, J. D. Tygar, and D. Wagner, "Dynamic Pharming Attacks and Locked Same-Origin Policies for Web Browsers," in *Proceedings of the 14th ACM Conference on Computer and Communications Security*, 2007.

41. S. Lekies, B. Stock, M. Wentzel, and M. Johns, "The Unexpected Dangers of Dynamic JavaScript," in *Proceedings of the 24th USENIX Security Symposium*, 2015.

42. A. Barth, C. Jackson, and J. C. Mitchell, "Robust Defenses for Cross-Site Request Forgery," in *Proceedings of the 15th ACM Conference on Computer and Communications Security*, 2008.

43. N. Nikiforakis, W. Meert, Y. Younan, M. Johns, and W. Joosen, "SessionShield: Lightweight Protection against Session Hijacking," in *Engineering Secure Software and Systems (ESSoS '11)*, 2011.

44. P. De Ryck, L. Desmet, F. Piessens, and W. Joosen, "SecSess: Keeping Your Session Tucked Away in Your Browser," in *Proceedings of the 30th Annual ACM Symposium on Applied Computing (SAC '15)*, 2015.

45. M. Johns, "SessionSafe: Implementing XSS Immune Session Handling," in *Proceedings of the 11th European Conference on Research in Computer Security (ESORICS '06)*, 2006.

46. C. Jackson and A. Barth, "ForceHTTPS: Protecting High-Security Websites from Network Attacks," in *Proceedings of the 17th International World Wide Web Conference (WWW '08)*, 2008.

47. J. Selvi, "Bypassing HTTP Strict Transport Security," *BlackHat-EU*, 2014.

48. K. Bhargavan, A. Delignat-Lavaud, C. Fournet, A. Pironti, and P.-Y. Strub, "Triple Handshakes and Cookie Cutters: Breaking and Fixing Authentication over TLS," in *Proceedings of the 2014 IEEE Symposium on Security and Privacy*, 2014.

49. S. Sivakorn, I. Polakis, and A. D. Keromytis, "I Am Robot: (Deep) Learning to Break Semantic Image CAPTCHAs," in *IEEE European Symposium on Security and Privacy (EuroS&P)*, 2016.

50. E. Toch, Y. Wang, and L. Cranor, "Personalization and Privacy: A Survey of Privacy Risks and Remedies in Personalization-Based Systems," *User Modeling and User-Adapted Interaction*, vol. 22, no. 1-2, 2012.

51. P. Chen, N. Nikiforakis, C. Huygens, and L. Desmet, "A Dangerous Mix: Large-Scale Analysis of Mixed-Content Websites," in *Proceedings of the 16th Information Security Conference*, 2013.

52. J. Clark and P. C. van Oorschot, "SoK: SSL and HTTPS: Revisiting Past Challenges and Evaluating Certificate Trust Model Enhancements," in *Proceedings of the 2013 IEEE Symposium on Security and Privacy*.

53. S. Chen, Z. Mao, Y.-M. Wang, and M. Zhang, "Pretty-Bad-Proxy: An Overlooked Adversary in Browsers' HTTPS Deployments," in *Proceedings of the 2009 IEEE Symposium on Security and Privacy*, 2009.

54. Z. Durumeric, J. Kasten, D. Adrian, J. A. Halderman, M. Bailey, F. Li, N. Weaver, J. Amann, J. Beekman, M. Payer, and V. Paxson, "The Matter of Heartbleed," in *Proceedings of the 2014 Conference on Internet Measurement Conference (IMC '14)*, 2014, pp. 475–488.

55. D. Adrian, K. Bhargavan, Z. Durumeric, P. Gaudry, M. Green, J. A. Halderman, N. Heninger, D. Springall, E. Thomé, L. Valenta, B. VanderSloot, E. Wustrow, S. Zanella-Béguelin, and P. Zimmermann, "Imperfect Forward Secrecy: How Diffie-Hellman Fails in Practice," in *Proceedings of the 22nd ACM Conference on Computer and Communications Security (CCS '15)*, 2015.

56. S. Fahl, M. Harbach, T. Muders, L. Baumgärtner, B. Freisleben, and M. Smith, "Why Eve and Mallory Love Android: An Analysis of Android SSL (In)Security," in *Proceedings of the 2012 ACM Conference on Computer and Communications Security (CCS '12)*, 2012.

57. S. Fahl, M. Harbach, H. Perl, M. Köttler, and M. Smith, "Rethinking SSL Development in an Appified World," in *Proceedings of the 2013 ACM SIGSAC Conference on Computer and Communications Security (CCS '13)*, 2013.

58. M. Huber, M. Mulazzani, and E. Weippl, "Tor HTTP Usage and Information Leakage," in *Communications and Multimedia Security*, 2010.

59. S. Chakravarty, G. Portokalidis, M. Polychronakis, and A. D. Keromytis, "Detecting Traffic Snooping in Tor Using Decoys," in *Recent Advances in Intrusion Detection*, 2011.

60. P. Winter, R. Kower, M. Mulazzani, M. Huber, S. Schrittwieser, S. Lindskog, and E. Weippl, "Spoiled Onions: Exposing Malicious Tor Exit Relays," in *Privacy Enhancing Technologies Symposium*, 2014.

### Appendix: Information Leakage

Here we provide additional details or information on certain services that were omitted from Section III.

#### DoubleClick
Figure 6 contains screenshots of our experiment demonstrating how ad networks can reveal parts of a user’s browsing history.

#### CNN
Almost the entire website runs over HTTP, including the login page, which can be exploited by active adversaries to modify or inject content. The credentials are sent over HTTPS, preventing eavesdroppers from hijacking the user’s session. However, the HTTP cookie allows the attacker to view and edit the user’s profile, which includes first and last name, postal address, email, phone number, profile picture, and link to the user’s Facebook account. Furthermore, the attacker can write or delete article comments and obtain recently viewed or created reports on iReport, CNN’s citizen journalism portal.

<http://ireport.cnn.com/>

(a) Browsed page  
(b) Attacker browsed page, receives ads exposing

**Figure 6.** Side-channel leak of user’s browsing history by the DoubleClick ad network.

#### New York Times
The HTTP cookie allows the adversary to obtain or change the user’s profile photo, name, a link pointing to a personal homepage, and a short personal description (bio). The adversary can also obtain and edit the list of articles that the user has saved.

#### The Guardian
Stolen HTTP cookies provide access to the user’s public profile sections, which include a profile picture and username, a short bio, the user’s interests, and previous comments on articles. The adversary can also post comments as the user.

#### Huffington Post
Similar to CNN, almost the entire website runs over unencrypted connections, and the HTTP cookie allows read and edit access to the user’s profile, article subscriptions, comments, fans, and followings. The profile includes the user’s login name, profile photo, email address, biography, postal code, city, and state. The attacker can also change the user’s password or delete the account.

```json
{
  "User-Agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 9_0_2 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13A452",
  "cookie_name": "amzn-app-ctxt",
  "cookie_value": "1.4%20{ \"os\":\"iOS\", \"ov\":\"9.0.2\", \"an\":\"Amazon\", \"av\":\"5.3.0\", \"dm\":{\"w\":\"640\", \"h\":\"960\", \"ld\":\"2.000000\"}, \"uiv\":5, \"nal\":1, \"cp\":8xxxxx, \"xv\":\"1.11\", \"di\":{\"ca\":\"AT&T\", \"ct\":\"Wifi\", \"mf\":\"Apple\", \"pr\":\"iPhone\", \"md\":\"iPhone\", \"v\":\"4S\", \"dti\":\"A287xxxxxxxxxx\"}}"
}
```

**Listing 2.** User information disclosed in the value attribute of Walmart’s HTTP customer cookie (values have been changed for privacy).

#### Amazon
The adversary can obtain information regarding previously purchased items either through the recommendation page (Figure 7(a)) or through product pages (Figure 7(b)). The iOS versions of the Amazon app also expose information about the user’s mobile device, as shown in Listing 2.

(a) Recommendations Page  
(b) Product Page

**Figure 7.** Obtaining information about previously purchased items from the user’s Amazon account.

#### eBay
Apart from the login and checkout pages, the remaining eBay website runs over HTTP. As a result, the stolen HTTP cookie gives the adversary access to both personal information and account functionality.

- **Personal Information:** The site always reveals the user’s first name. Depending on what the victim uses for logging in (username or email address), it is also exposed. By forging a cookie with the same value but a different scope (domain and path), we can also obtain the user’s delivery address. The HTTP cookies can also access the user’s messages, which are normally served over HTTPS.
- **History:** The cookie provides access to the functionality that exposes the victim’s purchase history and allows viewing and editing the items in the victim’s watch and wish lists. We can see which items have been bought or bid upon in the past and all the items being sold by the victim.
- **Cart:** Similarly to other e-commerce websites, the HTTP cookie enables access to the cart for viewing items already in it, or adding/removing items.

#### Walmart
If the adversary appends the stolen cookies when connecting, the website will reveal the user’s first name, postcode, and allow editing of the cart. Upon inspection, we found that the customer HTTP cookie actually contains 34 fields of information about the user within its value attribute. Apart from the subset that can be seen in Listing 3, which includes the user’s first and last name and email address, the cookie also contains ID information that points to the user’s reviews and comments, and a tracking ID for third parties.

```json
{
  "domain": ".walmart.com",
  "name": "customer",
  "path": "/",
  "secure": false,
  "httpOnly": false,
  "value": "%7B%22firstName%22%3A%22JANE%22%2C%22lastName%22%3A%22DOE%22%2C%22emailAddress%22%3A%22janedoe%40example.com%22%2C%22isMigrated%22%3Atrue%2C%22omsCustomerId%22%3A%22xxxxxxx9%22%2C%22ReviewUser%22%3A%7B%22isValid%22%3Atrue%2C%22AdditionalFieldsOrder%22%xxxxxxxx%2C%22Avatar%22%3A%7B%7D%2C%22UserNickname%22%3A%22xxxxxxxxx%22%2C%22Photos%22%3A%5B%5D%2C%22ContextDataValues%22%xxxxxxxx%2C%22Videos%22%3A%5B%5D%2C%22ContextDataValuesOrder%22%3A%xxxxxxxxxC%22SubmissionId%22%3Axxxxx%2C%22ContributorRank%22%3A%22xxxx%22%2C%22StoryIds%22%xxxxxxxxC%22AnswerIds%22%xxxxxx%2C%22QuestionIds%22xxxxxxD%2C%22BadgesOrder%22xxxxxx%2C%22Badges%22%xxxxxxxxx2C%22Location%22%3Axxxxx%2C%22SecondaryRatingsOrder%22xxxxxx%2C%22ProductRecommendationIds%22%3A%xxxxxxxxx2C%22AdditionalFields%22%3A%7B%7D%2C%22SubmissionTime%22%3A%2220xx-xx-xxxxxxxxxxxxx%22%2C%22ModerationStatus%22%3A%22APPROVED%22%2C%22ReviewIds%22%3xxxxxxx%2C%22ThirdPartyIds%22%xxxxxxxxxxC%22Id%22%3A%22ff79xxxxxxxxxxxxxx509dc5%22%2C%22CommentIds%22%3A%5B%5D%2C%22SecondaryRatings%22%3Axxxxx%2C%22LastModeratedTime%22%3A%2220xxxxxxxxxxxxxxxx%22%2C%22reviewStatus%22%3A%7B%22hasReview%22%3Axxxxx%7D%7D%7D"
}
```

**Listing 3.** User information disclosed in the value attribute of Walmart’s HTTP customer cookie (values have been changed for privacy).

#### Target
As with most e-commerce sites, the stolen cookie reveals the user’s first name, email address, and the ability to view and edit the cart and the user’s wish list. Furthermore, it also reveals items recently viewed by the user.

#### Vendor-Assisted Attacks
The cookie exposes functionality that can be leveraged for deploying spam, similar to Amazon. The attacker can either add items in the cart and send an email about those items (sent by PI:EMAIL), or create and send a wish list (sent by PI:EMAIL). In both cases, the emails explicitly contain the user’s full name (thus, making the last name obtainable to the attacker). While the attacker cannot include any text, which would facilitate deploying spam or phishing campaigns, one could promote arbitrary items. The attacker can also deploy the two aforementioned extortion scams.

---

**Authorized Use and Download Information:**

This document is authorized for licensed use by IEEE Xplore. It was downloaded on March 18, 2021, at 12:10:26 UTC from IEEE Xplore. Usage restrictions apply.