### Acknowledgments

This work was supported in part by the following grants and awards:
- NSF Grants: CNS-1162112, DMS-1418255, CCF-1535900
- AFOSR Grant: FA9550-14-1-0193
- National Natural Science Foundation of China Grants: 61361136003, 61532001
- 1000 Talent Plan Grant
- Tsinghua Initiative Research Program Grant: 20151080475
- Google Faculty Research Award

### References

1. S. Jain, A. Kumar, S. Mandal, J. Ong, L. Poutievski, A. Singh, S. Venkata, J. Wanderer, J. Zhou, M. Zhu, J. Zolla, U. Hölzle, S. Stuart, and A. Vahdat, "B4: Experience with a globally-deployed software-defined WAN," in *ACM SIGCOMM*, August 2013.

2. C.-Y. Hong, S. Kandula, R. Mahajan, M. Zhang, V. Gill, M. Nanduri, and R. Wattenhofer, "Achieving high utilization with software-driven WAN," in *ACM SIGCOMM*, August 2013.

3. S. Kandula, I. Menache, R. Schwartz, and S. R. Babbula, "Calendaring for wide area networks," in *ACM SIGCOMM*, August 2014.

4. H. Zhang, K. Chen, W. Bai, D. Han, C. Tian, H. Wang, H. Guan, and M. Zhang, "Guaranteeing deadlines for inter-datacenter transfers," in *EuroSys*, April 2015.

5. "Internet2." [http://www.internet2.edu](http://www.internet2.edu).

6. A. L. Chiu, G. Choudhury, G. Clapp, R. Doverspike, M. Feuer, J. W. Gannett, J. Jackel, G. T. Kim, J. G. Klincewicz, T. J. Kwon, et al., "Architectures and protocols for capacity efficient, highly dynamic and highly resilient core networks," *IEEE/OSA Journal of Optical Communications and Networking*, vol. 4, pp. 1–14, January 2012.

7. N. Farrington, G. Porter, S. Radhakrishnan, H. H. Bazzaz, V. Subramanya, Y. Fainman, G. Papen, and A. Vahdat, "Helios: A hybrid electrical/optical switch architecture for modular data centers," in *ACM SIGCOMM*, August 2010.

8. G. Wang, D. G. Andersen, M. Kaminsky, K. Papagiannaki, T. Ng, M. Kozuch, and M. Ryan, "c-Through: Part-time optics in data centers," in *ACM SIGCOMM*, August 2010.

9. K. Chen, A. Singla, A. Singh, K. Ramachandran, L. Xu, Y. Zhang, X. Wen, and Y. Chen, "OSA: An optical switching architecture for data center networks with unprecedented flexibility," in *USENIX NSDI*, April 2012.

10. N. Hamedazimi, Z. Qazi, H. Gupta, V. Sekar, S. R. Das, J. P. Longtin, H. Shah, and A. Tanwer, "FireFly: A reconfigurable wireless data center fabric using free-space optics," in *ACM SIGCOMM*, August 2014.

11. K. Chen, X. Wen, X. Ma, Y. Chen, Y. Xia, C. Hu, Q. Dong, and Y. Liu, "WaveCube: A scalable, fault-tolerant, high-performance optical data center architecture," in *IEEE INFOCOM*, April 2015.

12. "Infinera ROADM Specification." [http://tinyurl.com/jjog6no](http://tinyurl.com/jjog6no).

13. "Oclaro WSS." [http://tinyurl.com/hotq4s3](http://tinyurl.com/hotq4s3).

14. D. Xu, G. Li, B. Ramamurthy, A. Chiu, D. Wang, and R. Doverspike, "On provisioning diverse circuits in heterogeneous multi-layer optical networks," *Computer Communications*, vol. 36, no. 6, pp. 689–697, 2013.

15. B. G. Bathula, R. K. Sinha, A. L. Chiu, M. D. Feuer, G. Li, S. L. Woodward, W. Zhang, R. Doverspike, P. Magill, and K. Bergman, "Constraint routing and regenerator site concentration in ROADM networks," *IEEE/OSA Journal of Optical Communications and Networking*, vol. 5, pp. 1202–1214, November 2013.

16. M. Alizadeh, S. Yang, M. Sharif, S. Katti, N. McKeown, B. Prabhakar, and S. Shenker, "pFabric: Minimal near-optimal datacenter transport," in *ACM SIGCOMM*, August 2013.

17. S. Kirkpatrick, C. D. Gelatt, and M. P. Vecchi, "Optimization by simulated annealing," *Science*, vol. 220, pp. 671–680, May 1983.

18. M. A. Bonuccelli and M. C. Clò, "Scheduling of real-time messages in optical broadcast-and-select networks," *IEEE/ACM Transactions on Networking*, vol. 9, pp. 541–552, October 2001.

19. X. Jin, H. H. Liu, R. Gandhi, S. Kandula, R. Mahajan, M. Zhang, J. Rexford, and R. Wattenhofer, "Dynamic scheduling of network updates," in *ACM SIGCOMM*, August 2014.

20. M. Chowdhury, Y. Zhong, and I. Stoica, "Efficient coflow scheduling with Varys," in *ACM SIGCOMM*, August 2014.

21. M. Chowdhury and I. Stoica, "Efficient coflow scheduling without prior knowledge," in *ACM SIGCOMM*, August 2015.

22. Z. Galil, "Efficient algorithms for finding maximum matching in graphs," *ACM Computing Surveys*, vol. 18, pp. 23–38, March 1986.

23. "JGraphT Graph Library." [http://jgrapht.org](http://jgrapht.org).

24. "Floodlight OpenFlow Controller." [http://floodlight.openflowhub.org/](http://floodlight.openflowhub.org/).

25. D. Applegate and E. Cohen, "Making intra-domain routing robust to changing and uncertain traffic demands: Understanding fundamental tradeoffs," in *ACM SIGCOMM*, August 2003.

26. B. Fortz and M. Thorup, "Internet traffic engineering by optimizing OSPF weights," in *IEEE INFOCOM*, March 2000.

27. S. Kandula, D. Katabi, B. Davie, and A. Charny, "Walking the tightrope: Responsive yet stable traffic engineering," in *ACM SIGCOMM*, August 2005.

28. E. Danna, A. Hassidim, H. Kaplan, A. Kumar, Y. Mansour, D. Raz, and M. Segalov, "Upward max min fairness," in *IEEE INFOCOM*, March 2012.

29. E. Danna, S. Mandal, and A. Singh, "A practical algorithm for balancing the max-min fairness and throughput objectives in traffic engineering," in *IEEE INFOCOM*, March 2012.

30. H. H. Liu, S. Kandula, R. Mahajan, M. Zhang, and D. Gelernter, "Traffic engineering with forward fault correction," in *ACM SIGCOMM*, 2014.

31. A. Kumar, S. Jain, U. Naik, A. Raghuraman, B. Carlin, M. Amarandei-Stavila, M. Robin, A. Siganporia, S. Stuart, and A. Vahdat, "BwE: Flexible, hierarchical bandwidth allocation for WAN distributed computing," in *ACM SIGCOMM*, August 2015.

32. R. Hartert, S. Vissicchio, P. Schaus, O. Bonaventure, C. Filsfils, T. Telkamp, and P. Francois, "A declarative and expressive approach to control forwarding paths in carrier-grade networks," in *ACM SIGCOMM*, August 2015.

33. B. B. Chen and P. V.-B. Primet, "Scheduling deadline-constrained bulk data transfers to minimize network congestion," in *IEEE CCGRID*, May 2007.

34. K. Rajah, S. Ranka, and Y. Xia, "Advance reservations and scheduling for bulk transfers in research networks," *IEEE Transactions on Parallel and Distributed Systems*, vol. 20, pp. 1682–1697, November 2009.

35. N. Laoutaris, M. Sirivianos, X. Yang, and P. Rodriguez, "Inter-datacenter bulk transfers with NetStitcher," in *ACM SIGCOMM*, August 2011.

36. H. H. Liu, R. Viswanathan, M. Calder, A. Akella, R. Mahajan, J. Padhye, and M. Zhang, "Efficiently delivering online services over integrated infrastructure," in *USENIX NSDI*, March 2016.

37. D. G. Andersen, A. C. Snoeren, and H. Balakrishnan, "Best-path vs. multi-path overlay routing," in *ACM SIGCOMM Conference on Internet Measurement Conference*, October 2003.

38. Z. Li and P. Mohapatra, "QRON: QoS-aware routing in overlay networks," vol. 22, no. 1, pp. 29–40, 2004.

39. Y. Liu, H. Zhang, W. Gong, and D. Towsley, "On the interaction between overlay routing and underlay routing," in *IEEE INFOCOM*, March 2005.

40. M. Al-Fares, S. Radhakrishnan, B. Raghavan, N. Huang, and A. Vahdat, "Hedera: Dynamic flow scheduling for data center networks," in *USENIX NSDI*, April 2010.

41. T. Benson, A. Anand, A. Akella, and M. Zhang, "MicroTE: Fine grained traffic engineering for data centers," in *ACM CoNEXT*, December 2011.

42. A. R. Curtis, J. C. Mogul, J. Tourrilhes, P. Yalagandula, P. Sharma, and S. Banerjee, "DevoFlow: Scaling flow management for high-performance networks," in *ACM SIGCOMM*, August 2011.

43. Z. Shao, X. Jin, W. Jiang, M. Chen, and M. Chiang, "Intra-data-center traffic engineering with ensemble routing," in *IEEE INFOCOM*, April 2013.

44. X. Wu and X. Yang, "Dard: Distributed adaptive routing for datacenter networks," in *IEEE ICDCS*, June 2012.

45. S. Radhakrishnan, M. Tewari, R. Kapoor, G. Porter, and A. Vahdat, "Dahu: Commodity switches for direct connect data center networks," in *ACM/IEEE Symposium on Architectures for Networking and Communications Systems*, October 2013.

46. M. Alizadeh, T. Edsall, S. Dharmapurikar, R. Vaidyanathan, K. Chu, A. Fingerhut, V. T. Lam, F. Matus, R. Pan, N. Yadav, and G. Varghese, "CONGA: Distributed congestion-aware load balancing for datacenters," in *ACM SIGCOMM*, August 2014.

47. M. Alizadeh, A. Greenberg, D. A. Maltz, J. Padhye, P. Patel, B. Prabhakar, S. Sengupta, and M. Sridharan, "Data center TCP (DCTCP)," in *ACM SIGCOMM*, August 2011.

48. C. Wilson, H. Ballani, T. Karagiannis, and A. Rowtron, "Better never than late: Meeting deadlines in datacenter networks," in *ACM SIGCOMM*, August 2011.

49. B. Vamanan, J. Hasan, and T. Vijaykumar, "Deadline-aware datacenter TCP (D2TCP)," in *ACM SIGCOMM*, August 2012.

50. D. Zats, T. Das, P. Mohan, D. Borthakur, and R. Katz, "DeTail: Reducing the flow completion time tail in datacenter networks," in *ACM SIGCOMM*, August 2012.

51. C.-Y. Hong, M. Caesar, and P. Godfrey, "Finishing flows quickly with preemptive scheduling," in *ACM SIGCOMM*, August 2012.

52. J. Perry, A. Ousterhout, H. Balakrishnan, D. Shah, and H. Fugal, "Fastpass: A centralized zero-queue datacenter network," in *ACM SIGCOMM*, August 2014.

53. W. Bai, L. Chen, K. Chen, D. Han, C. Tian, and H. Wang, "Information-agnostic flow scheduling for commodity data centers," in *USENIX NSDI*, May 2015.

54. H. Ballani, P. Costa, T. Karagiannis, and A. Rowstron, "Towards predictable datacenter networks," in *ACM SIGCOMM*, August 2011.

55. V. Jeyakumar, M. Alizadeh, D. Mazières, B. Prabhakar, C. Kim, and A. Greenberg, "EyeQ: Practical network performance isolation at the edge," in *USENIX NSDI*, April 2013.

56. L. Popa, P. Yalagandula, S. Banerjee, J. C. Mogul, Y. Turner, and J. R. Santos, "ElasticSwitch: Practical work-conserving bandwidth guarantees for cloud computing," in *ACM SIGCOMM*, August 2013.

57. J. Lee, Y. Turner, M. Lee, L. Popa, S. Banerjee, J.-M. Kang, and P. Sharma, "Application-driven bandwidth guarantees in datacenters," in *ACM SIGCOMM*, August 2014.

58. K. C. Guan, "Cost-effective optical network architecture: A joint optimization of topology, switching, routing and wavelength assignment," PhD thesis, Massachusetts Institute of Technology, February 2007.

59. A. Brzezinski and E. Modiano, "Dynamic reconfiguration and routing algorithms for IP-over-WDM networks with stochastic traffic," *Journal of Lightwave Technology*, vol. 23, pp. 3188–3205, October 2005.

60. B. Ramamurthy and A. Ramakrishnan, "Virtual topology reconfiguration of wavelength-routed optical WDM networks," in *IEEE GLOBECOM*, November 2000.

61. Y. J. Liu, P. X. Gao, B. Wong, and S. Keshav, "Quartz: A new design element for low-latency DCNs," in *ACM SIGCOMM*, August 2014.

62. H. Wang, Y. Xia, K. Bergman, T. Ng, S. Sahu, and K. Sripanidkulchai, "Rethinking the physical layer of data center networks of the next decade: Using optics to enable efficient *-cast connectivity," *ACM SIGCOMM Computer Communication Review*, vol. 43, pp. 52–58, July 2013.

63. P. Samadi, D. Calhoun, H. Wang, and K. Bergman, "Accelerating cast traffic delivery in data centers leveraging physical layer optics and SDN," in *International Conference on Optical Network Design and Modeling*, May 2014.

64. P. Samadi, H. Wang, D. Calhoun, Y. Xia, K. Sripanidkulchai, T. Ng, and K. Bergman, "An optical programmable network architecture supporting iterative multicast for data-intensive applications," in *IEEE Optical Interconnects Conference*, May 2014.

65. Y. Xia and T. Ng, "A cross-layer SDN control plane for optical multicast-featured datacenters," in *ACM SIGCOMM HotSDN Workshop*, August 2014.

66. G. Porter, R. Strong, N. Farrington, A. Forencich, P. Chen-Sun, T. Rosing, Y. Fainman, G. Papen, and A. Vahdat, "Integrating microsecond circuit switching into the data center," in *ACM SIGCOMM*, August 2013.

67. H. Liu, F. Lu, A. Forencich, R. Kapoor, M. Tewari, G. M. Voelker, G. Papen, A. C. Snoeren, and G. Porter, "Circuit switching under the radar with REACToR," in *USENIX NSDI*, April 2014.

68. S. Liu, Q. Cheng, A. Wonfor, R. V. Penty, I. White, and P. M. Watts, "A low latency optical top of rack switch for data center networks with minimized processor energy load," in *Optical Fiber Communication Conference*, March 2014.