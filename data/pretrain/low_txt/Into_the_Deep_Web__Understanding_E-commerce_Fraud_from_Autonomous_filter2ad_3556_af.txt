### Interaction with Cybercriminals

Previous studies [46, 47] have primarily focused on marketplaces on the surface web. Our research extends this by connecting fraudulent account registrations to corresponding SIM farms, thereby enriching our understanding of the e-commerce fraud ecosystem in the deep web and revealing insights into the relationships between upstream and downstream actors.

Alrwais et al. [28] engaged with and traded with bulletproof hosting service providers to gather ground truth data. Levchenko et al. [40] purchased products from spam websites to investigate the miscreants' bank affiliates and fulfillment processes. The work most closely related to ours introduces a technique for analyzing and automatically replying to Craigslist Nigerian scam emails [43]. This method, however, is not suitable for our scenario. The emails in the Craigslist Nigerian scam are often generated by bots, leading to similar messages and behaviors, making template-based replies ineffective for interacting with e-commerce miscreants in our research.

Additionally, chatbots have been used as an effective tool in combating cybercrime. For example, some commercial tools have been reported to interact with online sex buyers [10] to deliver warning messages and to engage with email scammers [14] to waste their time. However, these tools are not designed for information gathering, which requires the chatbot to actively guide the conversation. Furthermore, the tools and design details are not publicly available for evaluation.

### Conclusion

In this paper, we introduce Aubrey, the first chatbot designed for active threat intelligence gathering from e-commerce fraudsters. Aubrey employs a question-driven conversation pattern, modeling the interaction process as a Finite State Machine (FSM), enabling autonomous conversations. Our study demonstrates that Aubrey is effective in e-commerce threat intelligence gathering, exposing a significant amount of previously unknown, fraud-related artifacts. These findings provide new insights into the e-commerce fraud ecosystem, which will help in better defending against e-commerce fraudulent activities.

### Acknowledgment

We would like to thank our shepherd Bimal Viswanath and the anonymous reviewers for their insightful comments. We also thank Company A for supporting our study on its platform and assisting with the intelligence verification. Special thanks to Zhou Li from the University of California, Irvine, for the helpful discussions. This work is partially supported by NSF grants CNS-1618493, 1801432, 1838083, 1850725, and 1937143.

### References

[1] "Amazon Brushing Scam," https://www.cbsnews.com/news/amazon-brushing-scam-couple-receives-packages-they-didnt-order/.
[2] "Aubrey Code Release," https://sites.google.com/view/aubreychatbot.
[3] "CQHttp," https://github.com/richardchien/python-aiocqhttp.
[4] "E-commerce black market report 2018," https://www.freebuf.com/articles/es/187600.html.
[5] "E-commerce market," https://www.statista.com/outlook/243/117/ecommerce/china.
[6] "Entrapment," https://en.wikipedia.org/wiki/Entrapment.
[7] "Express companies in e-commerce Brushing," http://m.xinhuanet.com/sh/2017-11/09/c_136738579.htm.
[8] "LTP," http://ltp.ai/demo.html.
[9] "Messaging Applications: The New Dark Web," https://www.intsights.com/messaging-applications-the-new-dark-web.
[10] "Microsoft chatbot trolls shopper for online sex," https://www.wired.com/story/microsoft-chatbot-trolls-shoppers-for-online-sex.
[11] "Modem pool," http://www.tldp.org/HOWTO/Modem-HOWTO-3.html.
[12] "Multi-Class Precision and Recall," http://mlwiki.org/index.php/Precision_and_Recall#Multi-Class_Problems.
[13] "National Criminal Justice Reference Service: Sting Operations," https://www.ncjrs.gov/App/Publications/abstract.aspx?ID=242552.
[14] "Send scam emails to this chatbot," https://www.theverge.com/2017/11/10/16632724/scam-chatbot-ai-email-rescam-netsafe.
[15] "Shopping voucher fraud in US," https://www.freebuf.com/articles/es/151807.html.
[16] "SIM farms," https://www.haud.com/2017/04/sim-farms-modern-trojan-mobile-operators/.
[17] "Telegram Messenger," https://telegram.org.
[18] "Thai Police Raid ‘Click Farm’, Find 347,200 SIM Cards," https://www.voanews.com/a/thai-police-raid-click-farm-finds-hundreds-of-thousands-of-sim-cards/3898497.html.
[19] "The Dark Art of Alibaba Sales Fakery," https://blogs.wsj.com/chinarealtime/2015/03/03/they-call-it-brushing-the-dark-art-of-alibaba-sales-fakery/.
[20] "The Growth of Cybercrime in Social Media," https://www.rsa.com/en-us/blog/2016-02/hiding-plain-sight-growth-cybercrime-social-media.
[21] "The Social Media Fraud Revolution," https://www.rsa.com/content/dam/premium/en/white-paper/the-social-media-fraud-revolution.pdf.
[22] "Wikimedia Downloads," https://dumps.wikimedia.org/.
[23] "Word2vec," https://code.google.com/archive/p/word2vec/.
[24] "Xiaoice," https://en.wikipedia.org/wiki/Xiaoice.
[25] "jieba," https://github.com/fxsjy/jieba, 2019.
[26] "Rinna," https://www.rinna.jp/, 2019.
[27] "Tencent qq," https://www.qq.com, 2019.
[28] S. Alrwais, X. Liao, X. Mi, P. Wang, X. Wang, F. Qian, R. Beyah, and D. McCoy, "Under the shadow of sunshine: Understanding and detecting bulletproof hosting on legitimate service provider networks," in Security and Privacy (S&P), 2017 IEEE Symposium on.
[29] S. Arora, Y. Liang, and T. Ma, "A simple but tough-to-beat baseline for sentence embeddings," in International Conference on Learning Representation (ICLR), 2017.
[30] W. Blacoe and M. Lapata, "A comparison of vector-based representations for semantic composition," in Proceedings of joint conference on EMNLP and computational natural language learning, 2012.
[31] C.-C. Chang and C.-J. Lin, "Libsvm: a library for support vector machines," ACM Transactions on Intelligent Systems and Technology.
[32] J. Chu-Carroll, "Mimic: An adaptive mixed initiative spoken dialogue system for information queries," in Proceedings of the sixth conference on Applied natural language processing (ANLP). Association for Computational Linguistics, 2000, pp. 97–104.
[33] B. S. Hasler, P. Tuchman, and D. Friedman, "Virtual research assistants: Replacing human interviewers by automated avatars in virtual worlds," Computers in Human Behavior, 2013.
[34] J. Huang, M. Zhou, and D. Yang, "Extracting chatbot knowledge from online discussion forums." in International Joint Conference on Artificial Intelligence (IJCAI), vol. 7, 2007, pp. 423–428.
[35] T.-H. K. Huang, J. C. Chang, and J. P. Bigham, "Evorus: A crowd-powered conversational assistant built to automate itself over time," in the 2018 Conference on Human Factors in Computing Systems (CHI).
[36] S. Jafarpour, C. Burges, and A. Ritter, "Filter, rank, and transfer the knowledge: Learning to chat."
[37] Z. Ji, Z. Lu, and H. Li, "An information retrieval approach to short text conversation," arXiv preprint arXiv:1408.6988, 2014.
[38] R. Kiros, Y. Zhu, R. R. Salakhutdinov, R. Zemel, R. Urtasun, A. Torralba, and S. Fidler, "Skip-thought vectors," in Advances in neural information processing systems (NIPS), 2015.
[39] M. Kusner, Y. Sun, N. Kolkin, and K. Weinberger, "From word embeddings to document distances," in International Conference on Machine Learning (ICML), 2015, pp. 957–966.
[40] K. Levchenko, A. Pitsillidis, N. Chachra, B. Enright, M. Félegyházi, C. Grier, T. Halvorson, C. Kanich, C. Kreibich, H. Liu et al., "Click trajectories: End-to-end analysis of the spam value chain," in IEEE Security and Privacy (S&P), 2011.
[41] J. Li, W. Monroe, A. Ritter, M. Galley, J. Gao, and D. Jurafsky, "Deep reinforcement learning for dialogue generation," arXiv preprint arXiv:1606.01541, 2016.
[42] T. Mikolov, I. Sutskever, K. Chen, G. S. Corrado, and J. Dean, "Distributed representations of words and phrases and their compositionality," in Advances in neural information processing systems, 2013.
[43] Y. Park, J. Jones, D. McCoy, E. Shi, and M. Jakobsson, "Scambaiter: Understanding targeted Nigerian scams on Craigslist," in Network and Distributed System Security Symposium (NDSS), 2014.
[44] B. Reaves, N. Scaife, D. Tian, L. Blue, P. Traynor, and K. R. Butler, "Sending out an SMS: Characterizing the security of the SMS ecosystem with public gateways," in Security and Privacy (S&P), 2016 IEEE Symposium on. IEEE, 2016, pp. 339–356.
[45] D. Shen, Q. Yang, J.-T. Sun, and Z. Chen, "Thread detection in dynamic text message streams," in the 29th International conference on Research and Development in Information Retrieval (SIGIR), 2006.
[46] K. Thomas, D. Iatskiv, E. Bursztein, T. Pietraszek, C. Grier, and D. McCoy, "Dialing back abuse on phone verified accounts," in Computer and Communications Security (CCS), 2014.
[47] K. Thomas, D. McCoy, C. Grier, A. Kolcz, and V. Paxson, "Trafficking fraudulent accounts: The role of the underground market in Twitter spam and abuse." in USENIX Security Symposium, 2013.
[48] B. Wang, B. Liu, C. Sun, X. Wang, and L. Sun, "Extracting Chinese question-answer pairs from online forums," in Systems, Man and Cybernetics (SMC), IEEE 2009.
[49] H. Xu, D. Liu, H. Wang, and A. Stavrou, "E-commerce reputation manipulation: The emergence of reputation-escalation-as-a-service," in Proceedings of the 24th World Wide Web (WWW), 2015.
[50] R. Yan, Y. Song, and H. Wu, "Learning to respond with deep neural networks for retrieval-based human-computer conversation system," in Proceedings of the 39th International conference on Research and Development in Information Retrieval (SIGIR), 2016.
[51] J. Yin, X. Jiang, Z. Lu, L. Shang, H. Li, and X. Li, "Neural generative question answering," in International Joint Conference on Artificial Intelligence (IJCAI), 2016.
[52] K. Yuan, H. Lu, X. Liao, and X. Wang, "Reading thieves’ cant: Automatically identifying and understanding dark jargons from cybercrime marketplaces," in 27th USENIX Security Symposium, 2018.

### Appendix: Legal and Ethical Guidelines

To minimize the risks to Company A and its users, as well as the target roles, we adhere to the policies guided by Company A and our school's Institutional Review Board (IRB).

#### Guidelines for Company A and Users
- Any interaction with the underground market should not harm Company A’s user base. Specifically, we avoid registering accounts with phone numbers from SMS farms, logging into bulk-registered accounts, or purchasing bonus promotion products. Instead, we rely on Company A to verify the usability of phone numbers, the authenticity of credentials, and the credibility of bonus-hunting tasks.
- Data tied to the products and information we collect should never be accessed outside of Company A’s infrastructure. Researchers must work on-site at Company A and follow all relevant security practices.

#### Guidelines for Target Roles
- For data collected from fraud-dedicated IM groups, we post a disclaimer notice in the group: "I may record the discussions in this group. If you have any concerns, please contact the group owner."
- During interactions, we only query about underground businesses related to the targets and never ask for personal information. For online aliases (e.g., QQ IDs) we collect, we only mention aggregated analysis results (e.g., total number of IDs) and do not disclose exact ID numbers.
- We do not force target subjects to provide any information beyond their will. Our goal is to observe their natural interaction with potential business partners. We cannot guarantee successful information collection or the reliability of the information provided.
- To minimize contributions to cybercrime profits, we pay the least possible to miscreants. We ask for free trials whenever possible and purchase the minimum amount of underground products necessary for our study, choosing the cheapest options for the same type of products.

### Example of Aubrey Generalization

In this section, we demonstrate how Aubrey can be generalized to chat with miscreants who recruit small-time workers to write fake reviews, and to gather threat intelligence to better understand the underground fake review business.

#### Data Collection
Underground discussions about the fake review business should be collected to extend the chatbot's knowledge base. Data can be gathered from dedicated IM groups (e.g., Telegram and WhatsApp) or underground forums for fake review services in any language.

#### Target Finding
To gather valuable threat intelligence, Aubrey needs to identify the correct targets, i.e., miscreants who recruit small-time workers to write fake reviews. From IM groups or underground forums, the current Target Finder module can be adapted to analyze traces and recognize miscreants. The role classifier will be re-trained using new corpora, such as fake review traces.

#### FSM Generation
Seed conversations between miscreants and clients need to be obtained to identify topics and transitions, which will be used as states and state transitions in the FSM. Aubrey provides a semi-automatic state and transition extraction mechanism, which can be reused for FSM generation in the context of fake reviews.

#### Dialog Management
For English language scenarios, the Dialog Manager must distinguish whether the responses of fake reviewers are negative, interrogative, or contain intelligence. The negative and interrogative detection is designed for general purposes and can be reused. A new module for identifying fake review-related intelligence should be designed based on the targeted artifacts to be gathered.

### Chatbot Model Optimization

We elaborate on two methods to enhance the quality of our conversational model:

#### Natural Responding
Similar to the 'disfluency' utterances (e.g., 'uhmm', 'uh') introduced in Google Duplex to make voice conversations more comfortable, we use stop sentences (e.g., "I got it." and "Ok. Great.") to make textual conversations smoother and less suspicious. These stop sentences are extracted from IM group chats by ranking the most frequently used ones. We add such stop sentences to the state with targeted threat intelligence.

#### Timing Control
Timing control is crucial for natural interactions. For example, long utterances should not be responded to instantly. Often, subjects split long sentences into multiple messages. Responding to each message individually can be unnatural and miss contextual information. In our implementation, we wait 15 seconds for the subject to finish potential multiple inputs. If the miscreant does not respond within a certain period (e.g., two minutes), Aubrey asks a similar question again and moves to the next state after two minutes of waiting.

### Figure 13: Statistically Representative Words for Different Roles
Font size is proportional to the z-score.

### Figure 12: Examples of Chatting with E-commerce Miscreants
- (a) Success case.
- (b) Failure case.
- (c) No intelligence case.

Miscreants usually leave traces for promoting their fake review tasks to recruit small-time workers. The current Target Finder module can be adapted to analyze these traces and recognize the miscreants. Particularly, the role classifier will be re-trained using the new corpora (i.e., fake review traces).