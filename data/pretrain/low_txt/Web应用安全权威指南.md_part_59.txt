### **8.3.1 预算规划与安全性需求讨论**

在进行预算规划之前，必须全面讨论安全性的整体需求。如果将应用程序开发外包或需要从外部采购安全产品，在规划阶段应准备一份 RFI（信息提供要求书）。RFI 应包括应用程序的概要和关键信息列表，并要求承包商提供提高系统安全性的对策及初步预算。此外，RFI 也是对承包商的首次评估，可以在此阶段评估其能力和意愿。

### **8.3.2 招标时的注意事项**

招标过程中，发包方需编写 RFP（需求建议书），供承包方估算并投标。RFP 中应详细列出所有安全性功能需求。由于 RFP 是预算编制的基础，明确记载安全性需求至关重要。

在 RFP 中，应区分安全性功能需求和安全性 Bug 的处理。安全性功能需求的成本与效果成正比，应基于规划阶段的讨论结果决定是否实现这些功能。而安全性 Bug 的需求通常较为模糊，若不能通过测试验证，则意义不大。对于安全性 Bug，可以向承包商提出以下具体要求：

- 列出需应对的漏洞名称
- 明确验收方法和标准
- 若有额外对策需求，要求承包商提出相应提案
- 要求承包商提供安全性能测试方法说明，并将测试结果作为交付物提交
- 明确项目验收后发现漏洞的应对方法及费用承担情况
- 要求承包商说明开发体制
- 要求承包商提供开发标准和安全性测试报告样本

> **专栏：谁应该对安全漏洞负责？**
>
> 在委托开发的应用程序中出现安全漏洞时，责任归属问题复杂。笔者认为，风险责任应由发包方承担，因为需求文档由发包方提供，且法律未明确规定此类责任 [1]。
>
> 经济产业省发布的《信息系统、交易模型与合同（模型合同）》[1] 中指出：
>
> > 关于本软件的安全对策，包括具体功能、遵守方法、管理体制及费用承担等应在其他条款另行约定（参考第 50 条）。当架构设计包含安全性功能需求时，相关问题属于“缺陷”范畴。
>
> 因此，系统设计文档中未明确的内容不视为缺陷 [2]。为保护自身利益，发包方应在合同和需求文档中明确标明安全性要求。即使客户未明确提出，承包方也应采取必要措施并说明安全性的重要性，将其写入 RFP 中。因此，回应 RFI 中的安全性问题并强调其重要性非常关键。

### **8.3.3 需求分析时的注意事项**

需求分析及后续开发阶段，工作主体转向承包方。需求分析中，应分别整理安全性功能和安全漏洞。首先，发包方需定义安全功能需求；其次，建议以承包方的开发标准为基础处理安全漏洞。如果不遵循承包方的标准，可能增加培训成本。通过对比 RFP 和承包方标准，进行匹配度分析，逐步完善项目开发标准（如图 8-2）。

![{%}](Image00255.jpg)
**图 8-2 以承包方的开发标准为基础的项目开发标准**

需求分析还应包括以下内容：
- 用户认证、账号管理和授权管理需求（参见 5.1～5.3 节）
- 日志管理需求（参见 5.4 节）
- 其他安全性功能需求
- 基础软件选择和补丁方法确定（参见 7.1.3 节）
- 分析开发标准与安全性需求之间的差距

### **8.3.4 概要设计的推进方法**

概要设计阶段，安全性功能与其他功能一样，需严格按瀑布式设计、开发和测试流程执行。关于安全性 Bug 处理，需细化需求分析阶段确定的开发标准至可编码水平，并记录到架构设计书中。

概要设计阶段的主要任务包括：
- 细化安全性功能
- 细化开发标准并确定测试方法
- 界面设计时确认安全功能
  - 列出需 CSRF 对策的页面
  - 列出需使用 HTTPS 的页面

### **8.3.5 详细设计和编码阶段的注意事项**

详细设计阶段之后，按照概要设计进行设计和开发。每个阶段都需进行设计评审和代码评审，确保严格遵守开发标准和方法。尽管评审过程可省略，但建议务必执行。

### **8.3.6 安全性测试的重要性及其方法**

无论是安全性 Bug 还是安全性功能需求，最终都需通过测试验证。发包方在验收时也应进行安全性测试。安全性测试方法包括：
- 委托专家进行漏洞诊断
- 使用专业工具进行诊断
- 自我诊断

专家诊断精度高，但成本较高 [3]。常用的 Web 应用程序漏洞检查工具有 IBM 的 Rational AppScan 和 HP 的 WebInspect software [4]，但这些工具初期投入较大。开源工具如 WebScarab、OpenVAS 和 w3af 也较常用 [4]。

自我诊断方面，许多公司因缺乏公开的安全测试方法而不知如何实施。地方自治信息中心发布的“Web 健康诊断基准”是一种简易检查方法，适用于广泛的安全性检查。

### **8.3.7 Web 健康诊断基准**

Web 健康诊断是由地方自治信息中心面向地方公共团体实施的 Web 网站漏洞诊断。这是一种简易检查方法，用于判断是否需要更精确的漏洞诊断。该基准覆盖了 12 项高危漏洞，明确了诊断基准、判断标准和抽样标准，可通过免费工具如 Fiddler 进行诊断（如图 8-3 和 8-4 所示）。

![{%}](Image00256.jpg)
**图 8-3 Web 健康诊断基准**

![{%}](Image00257.jpg)
**图 8-4 利用 Web 健康诊断基准进行安全检查**

### **8.3.8 承包方测试**

尽管在开发过程中进行安全性测试的团队较少，但强烈建议穿插进行。开发人员进行安全性测试的方法包括：
- 代码检查
- 使用工具进行黑盒测试
- 手动进行黑盒测试

代码检查适合发现 SQL 注入漏洞、目录遍历漏洞和 OS 命令注入漏洞等。手动黑盒测试可使用 Web 健康诊断方法，提前开始安全性测试有助于降低成本。因此，最好在系统架构设计阶段就制定安全测试计划。

### **8.3.9 发包方测试（验收）**

许多发包方在招标时明确将系统漏洞对策作为安全性功能需求，但在验收时却很少进行系统漏洞检测。实际上，验收时也应认真测试已明确定义的安全性功能需求。告知承包商将进行安全性测试，可对其施加压力，促使其加强体制。

验收时的漏洞检测方法包括：
- 审查承包商的安全测试报告
- 委托第三方进行测试
- 自行测试

第一种方法难以客观检查，不推荐使用。第二种方法虽精度高，但成本高。预算有限时，可考虑使用 Web 健康诊断基准自行测试。

### **8.3.10 运维阶段的注意事项**

发包方在验收承包商交付物后进入运维阶段。此阶段需重点关注日志文件监视和漏洞对策。每年进行一到两次 Web 网站健康诊断，以检查新增页面或功能，并应对新出现的攻击方法。日志监视工具如 iLogScanner 可帮助发现潜在攻击行为 [6]。平台和应用的漏洞应对方法不同，应及时关注并实施安全对策（如打补丁）。

## **8.4 总结**

本章介绍了开发安全 Web 应用程序所需的管理措施。制定开发标准并对成员进行安全培训，建立良好的开发体制至关重要。在招标时，应在 RFP 中明确安全性功能和 Bug 的需求，并在验收时进行安全性测试。

> **参考文献**
>
> \[1\] 经济产业省商务信息政策局信息处理振兴科 .（2007 年 4 月 13 日）. 情报システム·モデル取引·契约书（信息系统、交易模型与合同）。参考日期：2010 年 12 月 15 日，参考网址：経済产业省：
>
> \[2\] 个人信息保护法是针对 Web 应用的运营方（即发包方）的规定。并且软件不属于制造物责任法所限制的对象范围内。关于制造物责任法可以参考 [2]。
>
> \[3\] 本书都是基于实际情况写的，实际上各个专家厂商的能力和价格相差很大。
>
> \[4\] 还有三个开源软件也比较常用：WebScarab, OpenVAS, w3af。
>
> \[6\] iLogScanner 是独立行政法人信息处理推进机构免费发布的日志分析工具，它会从日志里寻找 SQL 注入攻击等攻击的痕迹。
>
> \[7\] 漏洞报告中心的例子可以参考微软的安全技术中心。

---

希望优化后的文本更加清晰、连贯和专业。如果有进一步的需求或修改意见，请随时告知。