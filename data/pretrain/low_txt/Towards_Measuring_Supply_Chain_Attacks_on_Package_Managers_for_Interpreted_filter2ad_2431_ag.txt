### References

1. **Hunting Malicious npm Packages**  
   Available: <https://duo.com/decipher/hunting-malicious-npm-packages>

2. **A. Miller, Sourmint: Malicious code, ad fraud, and data leak in iOS**  
   Aug. 2020. [Online]. Available: <https://snyk.io/blog/sourmint-malicious-code-ad-fraud-and-data-leak-in-ios/>

3. **C. Cimpanu, Backdoored Python Library Caught Stealing SSH Credentials**  
   May 2018. [Online]. Available: <https://www.bleepingcomputer.com/news/security/backdoored-python-library-caught-stealing-ssh-credentials/>

4. **N. Inc., All versions of discord.js-user contain malicious code. The package uploads the user’s Discord token to a remote server.**  
   Sep. 2019. [Online]. Available: <https://www.npmjs.com/advisories/1177>

5. **P. S. Foundation, The ast module helps Python applications to process trees of the Python abstract syntax grammar**  
   Aug. 2019. [Online]. Available: <https://docs.python.org/3/library/ast.html>

6. **G. M. Bravo, ECMAScript Parsing Infrastructure for Multipurpose Analysis**  
   Aug. 2018. [Online]. Available: <https://github.com/Kronuz/esprima-python>

7. **whitequark, Parser is a production-ready Ruby parser written in pure Ruby.**  
   Aug. 2019. [Online]. Available: <https://github.com/whitequark/parser>

8. **N. Popov, A PHP parser written in PHP**  
   Jul. 2019. [Online]. Available: <https://github.com/nikic/PHP-Parser>

9. **python-security, A static analysis tool for detecting security vulnerabilities in Python web applications**  
   Jul. 2018. [Online]. Available: <https://github.com/python-security/pyt>

10. **N. Patnaik and S. Sahoo, "JavaScript Static Security Analysis Made Easy with JSPrime," Blackhat USA, 2013**

11. **S. Inc., A static analysis security vulnerability scanner for Ruby on Rails applications**  
    May 2019. [Online]. Available: <https://github.com/presidentbeef/brakeman>

12. **D. Inc., Modernize your applications, accelerate innovation securely build, share and run modern applications anywhere**  
    Aug. 2019. [Online]. Available: <https://www.docker.com>

13. **G. Borello, "System and Application Monitoring and Troubleshooting with Sysdig," 2015**

14. **R. McGrath and W. Akkerman, SourceForge strace project, 2004**

15. **J. Mauro, DTrace: Dynamic Tracing in Oracle® Solaris, Mac OS X, and FreeBSD. Prentice Hall, 2011**

16. **M. Weber, Detecting Malicious Campaigns with Machine Learning**  
    Oct. 2018. [Online]. Available: <https://unit42.paloaltonetworks.com/unit42-detecting-malicious-campaigns-machine-learning/>

17. **E. Therond, A static analyzer for security purposes. Only PHP language is currently supported**  
    Dec. 2018. [Online]. Available: <https://github.com/designsecurity/progpilot>

18. **A. A. Project, Airflow is a platform to programmatically author, schedule and monitor workflows.**  
    Aug. 2019. [Online]. Available: <https://airflow.apache.org/>

19. **CeleryProject, Celery: Distributed Task Queue, 2019**  
    [Online]. Available: <http://www.celeryproject.org>

20. **Z. Buhman, ptpb.pw permanent shutdown**  
    Mar. 2019. [Online]. Available: <https://github.com/ptpb/pb/issues/246>

21. **D. Kirat, G. Vigna, and C. Kruegel, "BareCloud: Bare-metal analysis-based evasive malware detection," in Proc. 23rd USENIX Sec., San Diego, CA, Aug. 2014**

22. **D. Kirat and G. Vigna, "Malgene: Automatic extraction of malware analysis evasion signature," in Proc. 22nd ACM CCS, Denver, Colorado, Oct. 2015**

23. **A. Jadhav, D. Vidyarthi, and M. Hemavathy, "Evolution of Evasive Malwares: A Survey," in 2016 International Conference on Computational Techniques in Information and Communication Technologies (ICCTICT), IEEE, 2016, pp. 641–646**

24. **Y. Gao, Z. Lu, and Y. Luo, "Survey on Malware Anti-Analysis," in Fifth International Conference on Intelligent Control and Information Processing, IEEE, 2014, pp. 270–275**

25. **A. Bulazel and B. Yener, "A Survey on Automated Dynamic Malware Analysis Evasion and Counter-Evasion: PC, Mobile, and Web," in Proceedings of the 1st Reversing and Offensive-oriented Trends Symposium, ACM, 2017, p. 2**

26. **N. Inc., All versions of fast-requests contain obfuscated malware that uploads Discord user tokens to a remote server**  
    Sep. 2019. [Online]. Available: <https://www.npmjs.com/advisories/1086>

27. **Bertus, Detecting Cyber Attacks in the Python Package Index (PyPI)**  
    Oct. 2018. [Online]. Available: <https://medium.com/@bertusk/detecting-cyber-attacks-in-the-python-package-index-pypi-61ab2b585c67>

28. **P. O'Kane, S. Sezer, and K. McLaughlin, "Obfuscation: The Hidden Malware," May 2011**

29. **A. Fass, M. Backes, and B. Stock, "Hidenoseek: Camouflaging Malicious JavaScript in Benign ASTs," in Proc. 26th ACM CCS, London, UK, Nov. 2019**

30. **Y. Fratantonio, A. Bianchi, W. Robertson, E. Kirda, C. Kruegel, and G. Vigna, "Triggerscope: Towards Detecting Logic Bombs in Android Applications," in Proc. 37th IEEE S&P, San Jose, CA, May 2016**

31. **K. Kim, I. L. Kim, C. H. Kim, Y. Kwon, Y. Zheng, X. Zhang, and D. Xu, "J-Force: Forced Execution on JavaScript," in Proceedings of the 26th International Conference on World Wide Web, 2017**

32. **G. Li, E. Andreasen, and I. Ghosh, "SymJS: Automatic Symbolic Testing of JavaScript Web Applications," in Proc. 22nd ACM SIGSOFT Symposium on the Foundations of Software Engineering (FSE), Hong Kong, Nov. 2014**

33. **J. Corbet, An Attempt to Backdoor the Kernel, Nov. 2003. [Online]**  
    Available: <https://lwn.net/Articles/57135/>

34. **C. Xiao, Novel Malware XcodeGhost Modifies Xcode, Infects Apple iOS Apps and Hits App Store**  
    Sep. 2015. [Online]. Available: <https://unit42.paloaltonetworks.com/novel-malware-xcodeghost-modifies-xcode-infects-apple-ios-apps-and-hits-app-store/>

35. **K. Zetter, Researchers Solve Juniper Backdoor Mystery; Signs Point to NSA, Dec. 2015. [Online]**  
    Available: <https://www.wired.com/2015/12/researchers-solve-the-juniper-mystery-and-they-say-its-partially-the-nsas-fault/>

36. **L. H. Newman, Inside the Unnerving Supply Chain Attack That Corrupted CCleaner, Apr. 2018. [Online]**  
    Available: <https://www.wired.com/story/inside-the-unnerving-supply-chain-attack-that-corrupted-ccleaner/>

37. **L. H. Newman, Hack Brief: How to Check Your Computer for ASUS Update Malware, Mar. 2019. [Online]**  
    Available: <https://www.wired.com/story/asus-software-update-hack/>

38. **J. Cappos, J. Samuel, S. Baker, and J. H. Hartman, "Package Management Security," University of Arizona Technical Report, pp. 08–02, 2008**

39. **J. Cappos, J. Samuel, S. Baker, and J. H. Hartman, "A Look in the Mirror: Attacks on Package Managers," in Proc. 15th ACM CCS, Alexandria, VA, Oct. 2008**

40. **T. K. Kuppusamy, S. Torres-Arias, V. Diaz, and J. Cappos, "Diplomat: Using Delegations to Protect Community Repositories," in Proc. 13th USENIX NSDI, Santa Clara, CA, Mar. 2016**

41. **T. K. Kuppusamy, V. Diaz, and J. Cappos, "Mercury: Bandwidth-Effective Prevention of Rollback Attacks Against Community Repositories," in Proc. 2017 USENIX Annual Technical Conference (ATC), Santa Clara, CA, Jul. 2017**

42. **S. Torres-Arias, H. Afzali, T. K. Kuppusamy, R. Curtmola, and J. Cappos, "In-Toto: Providing Farm-to-Table Guarantees for Bits and Bytes," in Proc. 28th USENIX Sec., Santa Clara, CA, Aug. 2019**

43. **A. Decan, T. Mens, and E. Constantinou, "On the Impact of Security Vulnerabilities in the npm Package Dependency Network," in Proc. 15th Working Conference on Mining Software Repositories (MSR), Gothenburg, Sweden, May 2018**

44. **K. Garrett, G. Ferreira, L. Jia, J. Sunshine, and C. Kästner, "Detecting Suspicious Package Updates," in Proceedings of the 41st International Conference on Software Engineering: New Ideas and Emerging Results, IEEE Press, 2019, pp. 13–16**

45. **P. C. Q. Authority, Bandit is a tool designed to find common security issues in Python code, Jul. 2018. [Online]**  
    Available: <https://github.com/PyCQA/bandit>

46. **T. N. S. Platform, Node Security Platform Command-Line Tool, May 2018. [Online]**  
    Available: <https://github.com/nodesecurity/nsp>

47. **S. Taute, A JavaScript Malware Analysis Tool, Jan. 2015. [Online]**  
    Available: <https://github.com/svent/jsdetox>

48. **A. Madan, S. Muppidi, N. Patel, and A. Buecker, "Securely Adopting Mobile Technology Innovations for Your Enterprise Using IBM Security Solutions," Redguide for Business Leaders, IBM Corp, pp. 1–42, 2013**

49. **N. System, Detect Potentially Malicious PHP Files, Jul. 2018. [Online]**  
    Available: <https://github.com/nbs-system/php-malware-finder>

50. **Rubysec, Patch-Level Verification for Bundler, Dec. 2017. [Online]**  
    Available: <https://github.com/rubysec/bundler-audit>

51. **S. Arzt, S. Rasthofer, C. Fritz, E. Bodden, A. Bartel, J. Klein, Y. Le Traon, D. Octeau, and P. McDaniel, "FlowDroid: Precise Context, Flow, Field, Object-Sensitive and Lifecycle-Aware Taint Analysis for Android Apps," Jun. 2014**

52. **F. Wang and Y. Shoshitaishvili, "Angr—The Next Generation of Binary Analysis," in Cybersecurity Development (SecDev), 2017 IEEE, IEEE, 2017, pp. 8–9**

53. **T. Kojm, ClamAV, 2004**

54. **D. Bruening, QZ: DynamoRIO: Dynamic Instrumentation Tool Platform, Jul. 2018. [Online]**  
    Available: <https://github.com/DynamoRIO/dynamorio>

55. **RunKit, Runkit is Node Prototyping, Jul. 2018. [Online]**  
    Available: <https://runkit.com/home>

56. **Q. Chen and A. Kapravelos, "Mystique: Uncovering Information Leakage from Browser Extensions," in Proc. 25th ACM CCS, Toronto, ON, Canada, Oct. 2018**

57. **A. Kapravelos, C. Grier, N. Chachra, C. Kruegel, G. Vigna, and V. Paxson, "Hulk: Eliciting Malicious Behavior in Browser Extensions," in Proc. 23rd USENIX Sec., San Diego, CA, Aug. 2014**

58. **T. Reed and M. Grenier, "Osquery - Windows, macOS, Linux Monitoring and Intrusion Detection," 2017**

59. **V. Total, "VirusTotal—Free Online Virus, Malware and URL Scanner," Online: <https://www.virustotal.com/en>, 2012**

60. **Wikipedia contributors, Bleeping Computer — Wikipedia, the Free Encyclopedia, 2020. [Online]**  
    Available: <https://en.wikipedia.org/w/index.php?title=Bleeping_Computer&oldid=945358309>

61. **R. Duan, O. Alrawi, R. P. Kasturi, R. Elder, B. Saltaformaggio, and W. Lee, Measuring and Preventing Supply Chain Attacks on Package Managers, 2020. [Online]**  
    Available: <https://github.com/osssanitizer/maloss/tree/master/config>

62. **R. Duan, O. Alrawi, R. P. Kasturi, R. Elder, B. Saltaformaggio, and W. Lee, Measuring and Preventing Supply Chain Attacks on Package Managers, 2020. [Online]**  
    Available: <https://github.com/osssanitizer/maloss/tree/master/malware>

### Appendix

#### Table V: Examples and Statistics of Manually Labeled APIs
The full list of labeled APIs is available in our project source code repository [98].

| Runtime | Type       | Source                                                                                               | Sink                                                                                                   | Count |
|---------|------------|------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|-------|
| **Python** | Network    | `socket.recv`, `urllib.urlretrieve`, `ssl.SSLSocket.read`, `http.client.HTTPSConnection.request`      | `socket.send`, `ssl.SSLSocket.send`, `smtplib.SMTP_SSL.sendmail`, `http.server.HTTPServer`             | 58    |
|         | Filesystem | `os.read`, `fileinput.input`, `tarfile.open`, `http.cookiejar.FileCookieJar.load`                    | `os.write`, `shutil.rmtree`, `tempfile.NamedTemporaryFile.write`, `pathlib.Path.rmdir`                 | 64    |
|         | Process    | `os.popen`, `subprocess.Popen`, `multiprocessing.Process`, `concurrent.futures.Executor`              | -                                                                                                      | 72    |
|         | Code Generation | `eval`, `ctypes.CDLL`, `code.InteractiveInterpreter.runsource`, `compileall.compile_file`            | -                                                                                                      | 45    |
| **Node.js** | Network    | `https.get`, `socket.connect`, `dgram.createSocket`, `net.createConnection`                           | `socket.send`, `session.post`, `request.write`, `http2stream.respond`                                  | 24    |
|          | Filesystem | `fs.readFile`, `fs.readFileSync`, `fsPromises.readFile`, `fsPromises.readdir`                         | `fs.writeFile`, `fs.rmdir`, `filehandle.appendFile`, `fsPromises.writeFile`                            | 16    |
|          | Process    | `child_process.exec`, `child_process.spawnSync`, `subprocess.send`, `cluster.Worker.send`             | -                                                                                                      | 23    |
|          | Code Generation | `eval`, `script.runInNewContext`, `vm.runInContext`, `WebAssembly.compile`                          | -                                                                                                      | 15    |
| **Ruby** | Network    | `Socket.recvfrom`, `UDPSocket.recvfrom_nonblock`, `Net::HTTP.get`, `Net::FTP.get`                    | `Socket.send`, `UDPSocket.send`, `Net::HTTP.post`, `Net::SMTP.sendmail`                                | 61    |
|         | Filesystem | `IO.read`, `IO.readlines`, `Readline.readline`, `File.open`                                          | `IO.write`, `IO.pwrite`, `FileUtils.rmdir`, `FileUtils.copy`                                           | 35    |
|         | Process    | `spawn`, `system`, `Process.new`, `Process.fork`                                                     | -                                                                                                      | 19    |
|         | Code Generation | `eval`, `load`, `Binding.eval`, `RubyVM::InstructionSequence.eval`                                   | -                                                                                                      | 12    |

#### Table VI: Packages Reported by Authors but Not Removed by Registry Maintainers
The full list of packages reported by the authors and the community is available in our project source code repository [99].

| Reason                                                                                                 | Package Names                                                                                                                                                                                                                                         |
|--------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| The npm maintainers stated that they currently don’t have a policy to define user tracking versus information stealing and therefore didn’t remove these packages. In fact, one of the reported packages, botbait, is developed by the npm team and used for bot tracking. | `ikst`, `mktmpio`, `npm_scripts_test_metrics`, `botbait`, `npmtracker`, `p4d-rpi-tools`, `install-stats`, `scrimba`, `rsa-csr`, `ecdsa-csr`, `greenlock-ssh-fingerprint`, `jwk-to-ssh`, `rsa-compat`, `ssh-to-jwk`, `tysapi`, `zenapi`, `majuro`, `yummy-bolts`, `ping-me-maybe`, `avo` |
| Removed by the RubyGems maintainers on May 15, 2020. These gems are proof-of-concept packages from third-party that claim to be typo-guards without proof of their own innocence. The RubyGems maintainers didn’t remove them because they mentioned that these packages don’t have explicit malicious behaviors. | `igniteui-cli`, `uasn1`, `gemsploit`                                                                                                                                                                                                                  |
| -                                                                                                      | `restclient`, `multijson`, `awesomeprint`, `coffeescript`, `netssh`, `awssdk`, `concurrent-ruby`, `miniportile`, `awssdkcore`, `mimetypes`, `netscp`, `threadsafe`, `awssdkresources`, `rbinotify`, `rubygemsupdate`, `jqueryrails`, `sassrails`, `coffeescriptsource`, `racktest`, `rubygemsbundler`, `coffeerails`, `httpcookie`, `multixml`, `rspecexpectations`, `method-source`, `multipartpost`, `unfext`, `domainname`, `rspeccore`, `rbfsevent`, `rspecsupport`, `railsdeprecatedsanitizer`, `rspecmocks`, `rackprotection`, `railshtmlsanitizer`, `mime-typesdata`, `railsdomtesting`, `sprocketsrails` |