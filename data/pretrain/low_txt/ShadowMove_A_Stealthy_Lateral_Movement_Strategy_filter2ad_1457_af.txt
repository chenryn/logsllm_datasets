### References

1. **List of FTP Commands**  
   URL: <https://en.wikipedia.org/wiki/List_of_FTP_commands>  
   Accessed: February 2019

2. **Video Clip for the FTPShadowMove**  
   URL: <http://54.36.162.222/ShadowMoveDemo/FTPShadowMove.gif>  
   Year: 2018

3. **A Comprehensive Open Source Security Platform**  
   URL: <https://wazuh.com/product/>  
   Accessed: October 2019

4. **Install npm Packages Globally without Sudo on Linux and macOS**  
   URL: <https://github.com/sindresorhus/guides/blob/master/npm-global-without-sudo.md>  
   Accessed: October 2019

5. **OpenSSH/Cookbook/Multiplexing**  
   URL: <https://en.wikibooks.org/wiki/OpenSSH/Cookbook/Multiplexing>  
   Accessed: October 2019

6. **OSSEC: The World’s Most Widely Used Host-based Intrusion Detection System**  
   URL: <https://github.com/ossec/ossec-hids>  
   Accessed: October 2019

7. **Can We Stop Detecting Mimikatz, Please?**  
   Author: Adam Blaszczyk  
   URL: <http://www.hexacorn.com/blog/2019/02/03/can-we-stop-detecting-mimikatz-please/>  
   Accessed: February 2019

8. **Trust Transience: Post Intrusion SSH Hijacking**  
   Author: Adam Boileau  
   Event: BlackHat Briefings  
   Date: August 2005

9. **Man-in-the-Machine: Exploiting Ill-Secured Communication Inside the Computer**  
   Authors: Thanh Bui, Siddharth Prakash Rao, Markku Antikainen, Viswanathan Manihatty Bojan, Tuomas Aura  
   Conference: 27th USENIX Security Symposium (USENIX Security 18)  
   Pages: 1511–1525  
   Location: Baltimore, MD  
   Year: 2018  
   Publisher: USENIX Association

10. **Protecting Anti-Malware Services**  
    URL: <https://docs.microsoft.com/en-us/windows/desktop/services/protecting-anti-malware-services>  
    Accessed: August 2019

11. **A Study on Advanced Persistent Threats**  
    Authors: Ping Chen, Lieven Desmet, Christophe Huygens  
    Editors: Bart De Decker, André Zúquete  
    Book: Communications and Multimedia Security  
    Pages: 63–72  
    Publisher: Springer Berlin Heidelberg  
    Year: 2014

12. **Off-Path TCP Exploit: How Wireless Routers Can Jeopardize Your Secrets**  
    Authors: Weiteng Chen, Zhiyun Qian  
    Conference: 27th USENIX Security Symposium (USENIX Security 18)  
    Pages: 1581–1598  
    Location: Baltimore, MD  
    Year: 2018  
    Publisher: USENIX Association

13. **Mimikatz**  
    Author: B. Deply  
    URL: <https://github.com/gentilkiwi/mimikatz>  
    Year: 2014  
    Accessed: February 2019

14. **Hello, My Name is Microsoft and I Have a Credential Problem**  
    Authors: S. Duckwall, C. Campbell  
    Event: Blackhat USA 2013 White Papers  
    Year: 2013  
    URL: <https://media.blackhat.com/us-13/US-13-Duckwall-Pass-the-Hash-WP.pdf>

15. **Heat-Ray: Combating Identity Snowball Attacks Using Machine Learning, Combinatorial Optimization, and Attack Graphs**  
    Authors: John Dunagan, Alice X. Zheng, Daniel R. Simon  
    Conference: ACM SIGOPS 22nd Symposium on Operating Systems Principles (SOSP '09)  
    Pages: 305–320  
    Location: New York, NY, USA  
    Year: 2009  
    Publisher: ACM

16. **Injecting Code into Windows Protected Processes Using COM - Part 1**  
    Author: James Forshaw  
    URL: <https://googleprojectzero.blogspot.com/2018/10/injecting-code-into-windows-protected.html>  
    Date: October 2018  
    Accessed: August 2019

17. **APT38: Details on a New North Korean Regime-Backed Threat Group**  
    Authors: Nalani Fraser, Jacqueline O’Leary, Vincent Cannon, Fred Plan  
    URL: <https://www.fireeye.com/blog/threat-research/2018/10/apt38-details-on-new-north-korean-regime-backed-threat-group.html>  
    Year: 2017

18. **An Illustrated Guide to SSH Agent Forwarding**  
    Author: Steve Friedl  
    URL: <http://www.unixwiz.net/techtips/ssh-agent-forwarding.html>  
    Year: 2006  
    Accessed: October 2019

19. **Linux Inject**  
    Author: gaffe23  
    URL: <https://github.com/gaffe23/linux-inject>  
    Year: 2016  
    Accessed: July 2019

20. **A Virtual Machine Introspection Based Architecture for Intrusion Detection**  
    Authors: Tal Garfinkel, Mendel Rosenblum  
    Conference: Network and Distributed Systems Security Symposium (NDSS)  
    Month: February  
    Year: 2003

21. **ptrace(2) Linux Programmer’s Manual**  
    Authors: M. Haardt, M. Coleman  
    URL: <http://man7.org/linux/man-pages/man2/ptrace.2.html>  
    Year: 1999  
    Accessed: August 2019

22. **Clearing the Windows Temp Folders**  
    URL: <http://lexisnexis.custhelp.com/app/answers/answer_view/a_id/1084415/>  
    Accessed: August 2019

23. **CrowdStrike Compromise Assessment Data Sheet**  
    Publisher: CrowdStrike Inc.  
    URL: <https://www.crowdstrike.com/wp-content/brochures/CrowdStrike_CompromiseAssessment_DataSheet.pdf>  
    Accessed: February 2019

24. **Differentiating User Authentication Graphs**  
    Authors: A. D. Kent, L. M. Liebrock  
    Conference: 2013 IEEE Security and Privacy Workshops  
    Pages: 72–75  
    Month: May  
    Year: 2013

25. **Linux ACL on Shared Memory Objects**  
    URL: <http://man7.org/linux/man-pages/man2/shmget.2.html>  
    Accessed: August 2019

26. **Cobalt Strike: Advanced Tactics for Penetration Testers**  
    Publisher: Strategic Cyber LLC  
    URL: <https://cobaltstrike.com/downloads/csmanual38.pdf>  
    Year: 2017  
    Accessed: February 2019

27. **Unofficial Guide to Mimikatz & Command Reference**  
    Author: S. Metcalf  
    URL: <https://adsecurity.org/?page_id=1821>  
    Year: 2018  
    Accessed: February 2019

28. **Windows Remote Management (WinRM)**  
    URL: <https://docs.microsoft.com/en-us/windows/desktop/WinRM/portal>  
    Accessed: November 2018

29. **DuplicateHandle Function**  
    URL: <https://msdn.microsoft.com/en-us/library/windows/desktop/ms724251(v=vs.85).aspx>  
    Year: 2017  
    Accessed: 10-May-2018

30. **Wsaduplicatesocket Function**  
    URL: <https://msdn.microsoft.com/en-us/library/windows/desktop/ms741565(v=vs.85).aspx>  
    Year: 2017  
    Accessed: 10-May-2018

31. **MIB_TCPROW2 Structure**  
    URL: <https://docs.microsoft.com/en-us/windows/desktop/api/tcpmib/ns-tcpmib-_mib_tcprow2>  
    Year: 2018  
    Accessed: February 2019

32. **Automated Adversary Emulation: A Case for Planning and Acting with Unknowns**  
    Authors: Doug Miller, Ron Alford, Andy Applebaum, Henry Foster, Caleb Little, Blake Strom  
    Year: 2018

33. **[MS-TDS]: Tabular Data Stream Protocol**  
    URL: <https://msdn.microsoft.com/en-us/library/dd304523.aspx>  
    Year: 2018  
    Accessed: November 2018

34. **[MS-TDS]: SQL Batch Client Request**  
    URL: <https://msdn.microsoft.com/en-us/library/dd304416.aspx>  
    Year: 2019  
    Accessed: November 2018

35. **The Secure Socket API: TLS as an Operating System Service**  
    Authors: Mark O’Neill, Scott Heidbrink, Jordan Whitehead, Tanner Perdue, Luke Dickinson, Torstein Collett, Nick Bonner, Kent Seamons, Daniel Zappala  
    Conference: 27th USENIX Security Symposium (USENIX Security 18)  
    Pages: 799–816  
    Location: Baltimore, MD  
    Year: 2018  
    Publisher: USENIX Association

36. **Playing with ptrace, Part I**  
    Author: Pradeep Padala  
    Publication: Linux Journal  
    Issue: 103  
    Month: November  
    Year: 2002

37. **Detecting Stealthier Cross-Process Injection Techniques with Windows Defender ATP**  
    Publisher: Windows Defender Research  
    URL: <https://cloudblogs.microsoft.com/microsoftsecure/2017/07/12/detecting-stealthier-cross-process-injection-techniques-with-windows-defender-atp-process-hollowing-and-atom-bombing/>  
    Accessed: February 2019

38. **Monitoring with Windows Remote Management (WinRM) and PowerShell Part I**  
    Author: Ryan Ries  
    URL: <https://www.myotherpcisacloud.com/post/Monitoring-with-Windows-Remote-Management-(WinRM)-and-Powershell-Part-I>  
    Accessed: November 2018

39. **Best Antivirus Protection for 2019**  
    Author: Neil J. Rubenking  
    URL: <https://www.pcmag.com/article2/0,2817,2372364,00.asp>  
    Year: 2019  
    Accessed: 04-February-2019

40. **Detecting Structurally Anomalous Logins within Enterprise Networks**  
    Authors: Hossein Siadati, Nasir Memon  
    Conference: 2017 ACM SIGSAC Conference on Computer and Communications Security  
    Pages: 1273–1284  
    Year: 2017  
    Publisher: ACM

41. **Operating System Concepts**  
    Authors: Abraham Silberschatz, Peter B. Galvin, Greg Gagne  
    Edition: 9th  
    Publisher: Wiley Publishing  
    Year: 2012

42. **SITE FTP Command**  
    Publisher: SolarWinds  
    URL: <https://support.solarwinds.com/SuccessCenter/s/article/SITE-FTP-command>  
    Year: 2017  
    Accessed: August 2019

43. **UNIX Network Programming, Vol. 1**  
    Authors: W. Richard Stevens, Bill Fenner, Andrew M. Rudoff  
    Edition: 3rd  
    Publisher: Pearson Education  
    Year: 2003

44. **Suricata Features**  
    URL: <https://suricata-ids.org/features/>  
    Year: 2018  
    Accessed: November 2018

45. **Computer Networks, Fifth Edition**  
    Authors: Andrew S Tanenbaum, DJ Wetherall  
    Publisher: Prentice Hall  
    Year: 2011

46. **Windows Management Instrumentation (WMI) Offense, Defense, and Forensics**  
    Publisher: FireEye FLARE Team  
    URL: <https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf>  
    Year: 2015  
    Accessed: February 2019

47. **socket.c**  
    Author: David Treadwell  
    URL: <http://icerote.net/doc/library/programming/source/SOURCE.CODE.MICROSOFT.WINDOWS.2000.AND.NT4-BTDE/win2k/private/net/sockets/winsock2/wsp/msafd/socket.c>  
    Year: 1992  
    Accessed: January 2019

48. **wspmisc.c**  
    Author: David Treadwell  
    URL: <http://icerote.net/doc/library/programming/source/SOURCE.CODE.MICROSOFT.WINDOWS.2000.AND.NT4-BTDE/win2k/private/net/sockets/winsock2/wsp/msafd/wspmisc.c>  
    Year: 1992  
    Accessed: January 2019

49. **Configure WinRM to Use HTTP**  
    Publisher: VMware  
    URL: <https://docs.vmware.com/en/vRealize-Automation/7.5/com.vmware.vrealize.orchestrator-use-plugins.doc/GUID-D4ACA4EF-D018-448A-866A-DECDDA5CC3C1.html>  
    Accessed: November 2018

50. **Hardware-Based Run-Time Code Integrity in Embedded Devices**  
    Authors: Taimour Wehbe, Vincent Mooney, David Keezer  
    Journal: Cryptography  
    Volume: 2  
    Issue: 3  
    Year: 2018

### Appendix: Prepare the Environment for WinRM Hijacking

#### A.1 Server Configuration

To configure the WinRM server on the remote machine, follow these steps:

1. Set the default WinRM configuration:
   ```bash
   winrm quickconfig
   ```

2. Check whether a listener is running and verify the default ports:
   ```bash
   winrm e winrm/config/listener
   ```

3. Enable basic authentication:
   ```bash
   winrm set winrm/config/service/auth '@{Basic="true"}'
   ```

4. Allow transfer of unencrypted data by the WinRM server:
   ```bash
   winrm set winrm/config/service '@{AllowUnencrypted="true"}'
   ```

#### A.2 Client Configuration

To configure the WinRM client, follow these steps:

1. Enable basic authentication:
   ```bash
   winrm set winrm/config/client/auth '@{Basic="true"}'
   ```

2. Allow transfer of unencrypted data by the WinRM client:
   ```bash
   winrm set winrm/config/client '@{AllowUnencrypted="true"}'
   ```

3. If the WinRM host machine is in an external domain, specify the trusted hosts:
   ```bash
   winrm set winrm/config/client '@{TrustedHosts="host1, host2, host3"}'
   ```

---

This revised version ensures that the references are clear, consistent, and professional, and the instructions for configuring the WinRM environment are well-organized and easy to follow.