### 证书认证标签的真伪鉴别

如果浏览者能够确认网站的真实性，那么他们也应该能够对使用了证书的原网站进行真伪鉴别。与其花费时间验证证书认证标签的真伪，不如直接确认网站本身的真实性，这样会更高效。

然而，证书认证标签的问题并不仅限于此。由于这些标签通常使用 JavaScript 或浏览器插件编写，如果标签本身存在跨站脚本（XSS）等漏洞，可能会对嵌入该标签的网站的安全性造成负面影响。从这个意义上说，证书认证标签不仅没有降低系统的风险，反而增加了安全隐患。

因此，建议在确定证书认证标签带来的好处大于其潜在风险时，才在网站上显示 SSL 证书的认证标签。

**参考文献**
[1] 高木浩光. (2005 年 2 月 5 日). PKI よくある勘违い（3）“プライベート认证局が妥当ならオレオレ认证局も妥当だ”. 参考日期：2011 年 1 月 13 日. 参考网址：高木浩光＠自宅の日记: http://takagi-hiromitsu.jp/diary/20050205.html#p02

### 7.4 防范恶意软件的对策

#### 7.4.1 Web 网站的恶意软件对策概述

Web 网站的恶意软件对策主要针对以下两种情况：
- **（A）Web 服务器自身感染恶意软件**
- **（B）通过 Web 罗网传播恶意软件**

在这两种情况下，恶意软件都存储在服务器上，但它们的行为不同。在 **（A）** 的情况下，恶意软件会在服务器上运行；而在 **（B）** 的情况下，恶意软件并不在服务器上运行，而是处于用户可以通过网页下载的状态。

**（A）** 情况下的威胁包括：
- 信息泄露
- 网站被篡改
- 非法使用其他功能
- 作为跳板对其他服务器发起攻击

**（B）** 情况下的影响包括：
- 浏览网页的用户 PC 可能会感染恶意软件（前提是用户 PC 存在漏洞或恶意软件被执行）

#### 7.4.2 恶意软件的感染途径

根据独立行政法人信息处理推进机构的调查，病毒的主要感染途径如图 7-13 所示。调查显示，电子邮件占 45.2%，上网占 48.3%，外置存储设备（如 U 盘、移动硬盘）和外部设备（如客户带入公司的 PC）占 48%（调查为多项选择）。

**参考文献**
11. 2009 年日本国内信息安全事件受害情况调查报告. 地址: http://www.ipa.go.jp/security/fy21/reports/isec-survey/

![个人电脑病毒的入侵途径](http://example.com/image.png)

从上述调查结果可以看出，通过浏览网页、查看邮件以及使用外置存储设备等方式传播和感染病毒的情况较为普遍。然而，在 Web 服务器上，这类操作较少，因此利用系统漏洞感染病毒的比例较高。

尽管许多人首先想到的是使用防病毒软件来解决恶意软件问题，但在 Web 服务器上安装防病毒软件的比例仍然不高。这是因为服务器上感染恶意软件的途径与普通客户端 PC 不同。

#### 7.4.3 Web 网站恶意软件防范对策概要

为了防止恶意软件感染，Web 服务器应采取以下重要措施：
- 定期进行服务器漏洞修复
- 不安装和运行来历不明的软件
- 不在服务器上进行无关操作（如浏览网页或查看邮件）
- 不使用 USB 等外部存储设备
- 将 Web 服务器与公司内部网络隔离
- 访问服务器的客户端 PC 应安装防病毒软件并保持病毒库更新
- 通过 Windows Update 等方式安装最新的安全补丁

首先建立能够切实执行上述对策的机制。如果仍感到不安（例如无法及时实施漏洞修复），则可以考虑在服务器上安装防病毒软件。

#### 7.4.4 如何确保服务器不被恶意软件感染

Web 服务器感染恶意软件的主要途径包括：
- 利用 Web 应用的文件上传漏洞（参考 4.12 节）
- 利用 Web 网站的漏洞进行内容篡改（参考 7.1 节）
- 利用 FTP 等管理软件非法登录（参考 7.1 节）
- 管理服务器的 PC 感染了恶意软件，进而感染服务器（参考 7.4.3 节）
- 网站内容被恶意软件感染（参考 7.4.3 节）

除了利用文件上传功能漏洞以外，其他途径都可以通过本章所述的方法进行防范。关于文件上传漏洞的预防，可以参考后续章节中的方法。

#### 探讨是否需要制定针对恶意软件的防范措施

用户上传文件（如图片、免费软件、PDF 文档等）的恶意软件对策责任应由以下三者共同承担：
- Web 网站运营者
- 上传文件的用户
- 下载和查看文件的用户

网站应根据自身特点决定是否采取防病毒措施。具体判断依据包括：
- 上传文件的公开范围
- 上传文件是否有明确的责任人
- 谁对上传文件负主要责任
- 除防病毒软件外是否有其他检查方法

#### 制定病毒防范政策并向用户公开

在决定是否采取恶意软件防范措施后，应以网站用户规约的形式向用户公开并实施。公开内容可以包括：
- 防范病毒的方法（即使不采取任何防范措施也应标明）
- 不可能查出所有病毒，感染病毒的可能性也不是零（采取防病毒措施时）
- 用户需自行负责（推荐用户使用防病毒软件并保持病毒库更新）
- 作为网站运营方不对用户感染病毒负责

这些条目是一般性的内容，各网站应根据实际情况制定符合自身特点的病毒防范政策。

#### 使用防病毒软件

对用户上传的文件进行病毒扫描的方法有：
- 在服务器上安装防病毒软件，并将文件上传目录设置为扫描对象
- 使用防病毒网关
- 利用防病毒软件提供的 API 在自己的代码中进行病毒扫描

详细信息可向防病毒软件公司或代理商咨询。

如果由网站进行病毒检查，可以参考微软的免费网盘 Windows Live SkyDrive。请参见图 7-14。

**参考链接**
- [Windows Live SkyDrive](https://skydrive.live.com)
- [EICAR 测试文件](http://www.eicar.org/86-0-Intended-use.html)

![Web 侧进行病毒扫描的例子（Windows Live SkyDrive）](http://example.com/image.png)

#### 专栏：Web 网站的防病毒对策和 Gumblar 的关系

本章提到的一些防病毒软件对策对抵御 Gumblar 也有很好的效果。Gumblar 是一种结合了 Web 网页篡改和通过浏览网页感染的病毒传播方式。它通过盗取 FTP 用户名和密码来篡改网站内容，进而感染浏览这些网站的用户。

采用本章介绍的安全防范措施，如使用公钥认证的 SCP 或 SFTP 代替传统 FTP，并加上访问 IP 限制，可以预防非法登录攻击。此外，如果客户端 PC 安装了防病毒软件，也可以避免被病毒感染。

虽然本章介绍的对策是基本内容，但如果熟练应用这些方法，自然也能抵御 Gumblar。

**参考文献**
- [Gumblar 详细信息](http://www.ipa.go.jp/security/txt/2010/02outline.html)

### 7.5 总结

本章围绕如何提高 Web 网站的安全性，主要介绍了以下方法：
- 针对 Web 服务器漏洞的对策
- 由管理软件导致的非法登录对策
- 防范伪装攻击的对策
- 防范网络监听和篡改的对策
- 防范恶意软件的对策

每种方法都是常见的针对 Web 网站攻击的防范措施。这些服务器对策及应用程序本身的安全防范措施是确保网站安全性所必需的。请参考本章内容来提高网站的安全性。

另外，关于如何防范钓鱼攻击，请参考独立行政法人产业技术综合研究所的“建立安全 Web 网站的铁则”。

**参考文献**
- [建立安全 Web 网站的铁则](http://www.rcis.aist.go.jp/special/websafety2007/)

### 第 8 章 开发安全的 Web 应用所需的管理

本章将讲解开发安全的 Web 应用所需进行的管理工作。这一章主要面向发包方（甲方）的相关人员及实际进行开发（承包方，乙方）的项目经理。

#### 8.1 开发管理中的安全对策概要

开发管理可以从开发体制和开发过程两方面进行控制。图 8-1 从软件开发中发包方和承包方的立场出发，按照开发过程的各个阶段（从规划、招标到运维），对涉及安全性的关键因素进行了整理。

首先，需要在开发开始之前制定开发体制，因此制定开发标准、培养信息安全责任人、对开发团队进行安全教育显得尤为重要。图 8-1 描述了项目双方在开发过程中各个阶段需要注意的事项。

![开发安全的应用程序需要的管理概要](http://example.com/image.png)

#### 8.2 开发体制

完备的开发体制对于开发安全的应用至关重要。一个好的开发体制应从开发标准等文档（物）和训练有素的团队（人）两方面着手。

##### 开发标准的制定

根据笔者的咨询经验，对于开发安全的应用来说，性价比最高的措施之一是整理出一份好的开发标准（安全指南）。一个好的开发标准应满足以下条件：
- 内容实用且精简
- 方便查找想参考的内容
- 明确记载应实施的措施
- 持续改进

尽管越来越多的企业制定了开发标准，但很多标准内容冗长且抽象，难以阅读。开发标准是给开发工程师使用的，因此应选取最有用的标准，将其做得简洁一些，以降低开发成本。

即使开发工作外包给其他公司，也应制定一份开发标准，并在招标时作为安全性需求附件提供给投标方，这同样能取得良好的效果。

开发标准应包含以下重要项目：
- 针对每种漏洞的应对方法
- 用户认证、会话管理、日志输出等实现方法
- 各个阶段的评审（Review）和测试方法（时间、人员、对象、方法）
- 项目验收（发布）评判标准（人员、时间、具体合格标准）

##### 教育培训

尽管许多企业制定了开发标准，但真正能够有效使用这些标准的企业并不多。原因可能是标准内容不切实际，或者团队尚未建立一个严格遵守标准的组织框架。

为了按开发标准进行开发，需要遵循以下要点：
- 开发标准本身的内容
- 在团队内开展开发标准培训
- 通过设计评审和代码评审检查开发标准的执行情况

其中，开发标准培训的关键点包括：
- 事件和事例的介绍（提高大家对安全性的重视程度）
- 常见漏洞的原理及其影响
- 必须遵守的事项

此外，每个团队最好都能培养出自己团队内部的安全责任人。安全负责人的主要职责包括：
- 制定和维护开发标准
- 开展开发标准培训
- 参加评审
- 进行安全测试
- 监测各种漏洞信息

以安全负责人为中心，不断完善开发标准并持续对开发团队进行安全培训，将提高团队开发出安全应用程序的能力。

#### 8.3 开发过程

本节将对开发安全应用程序的开发流程进行说明。以下说明以应用程序外包开发为例，但公司内部开发时，除了角色担当不同之外，所需实施的内容基本相同。

##### 8.3.1 规划阶段的注意事项

在规划阶段，非常重要的一件事是确保开发中与安全性相关的内容的预算。为此，必须先讨论安全性需求的整体内容。在将应用程序外包开发或需要从外部调配安全产品时，可以在规划阶段制作 RFI（Request For Information，信息提供要求书），向承包商提供应用程序的概要和重要信息列表，并要求承包商提供关于提高系统安全性所需对策及大致预算的信息。RFI 同时也可作为对承包商的第一次审查，以评价其能力和意愿。

##### 8.3.2 招标时的注意事项

招标时，发包方会编写 RFP（Request For Proposal，需求建议书），让承包方据此进行估算并投标。关于安全性的功能需求也应在 RFP 中明确记载。由于 RFP 是预算的前提，因此在 RFP 中明确记载安全性需求非常重要。

这里我们需要将安全性功能（需求）和安全性 Bug 分开考虑。首先，安全性功能需求的成本投入和效果是成正比的，我们需要基于规划阶段的讨论结果来决定是否需要实现这些安全性功能并记录到 RFP 中。