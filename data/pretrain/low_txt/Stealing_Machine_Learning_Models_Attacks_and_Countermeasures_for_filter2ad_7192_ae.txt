### On Differential Privacy Techniques to Mitigate the Accuracy of Model Extraction

#### Acknowledgments
This work is supported by the National Research Fund, Luxembourg (Grant No. 13550291).

#### References

1. **Abadi, M., Chu, A., Goodfellow, I., McMahan, H. B., Mironov, I., Talwar, K., & Zhang, L. (2016).** Deep learning with differential privacy. In *Proceedings of the ACM SIGSAC Conference on Computer and Communications Security (CCS)*. ACM, 308–318.

2. **Agustsson, E., Sage, A., Timofte, R., & Van Gool, L. (2019).** Optimal Transport Maps for Distribution Preserving Operations on Latent Spaces of Generative Models. In *Proceedings of the International Conference on Learning Representations (ICLR)*.

3. **Azadi, S., Olsson, C., Darrell, T., Goodfellow, I., & Odena, A. (2019).** Discriminator Rejection Sampling. In *Proceedings of the International Conference on Learning Representations (ICLR)*.

4. **Bahri, Y., Kadmon, J., Pennington, J., Schoenholz, S. S., Sohl-Dickstein, J., & Ganguli, S. (2020).** Statistical Mechanics of Deep Learning. *Annual Review of Condensed Matter Physics* 11(1), 501–528.

5. **Bau, D., Zhu, J.-Y., Wulff, J., Peebles, W., Strobelt, H., Zhou, B., & Torralba, A. (2019).** Seeing what a GAN cannot generate. In *Proceedings of the IEEE International Conference on Computer Vision (ICCV)*. IEEE, 4502–4511.

6. **Brock, A., Donahue, J., & Simonyan, K. (2019).** Large Scale GAN Training for High Fidelity Natural Image Synthesis. In *Proceedings of the International Conference on Learning Representations (ICLR)*.

7. **Brown, T. B., Mann, B., Ryder, N., Subbiah, M., Kaplan, J., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G., Askell, A., et al. (2020).** Language models are few-shot learners. *arXiv preprint arXiv:2005.14165*.

8. **Cao, X., Jia, J., & Gong, N. Z. (2021).** IPGuard: Protecting intellectual property of deep neural networks via fingerprinting the classification boundary. In *Proceedings of the ACM Asia Conference on Computer and Communications Security (ASIA CCS)*. 14–25.

9. **Carlini, N., Jagielski, M., & Mironov, I. (2020).** Cryptanalytic Extraction of Neural Network Models. In *Proceedings of the Annual International Cryptology Conference (CRYPTO)*. Springer.

10. **Carlini, N., Tramer, F., Wallace, E., Jagielski, M., Herbert-Voss, A., Lee, K., Roberts, A., Brown, T., Song, D., Erlingsson, U., et al. (2021).** Extracting Training Data from Large Language Models. In *Proceedings of the USENIX Security Symposium (USENIX Security)*. USENIX Association, 2633–2650.

11. **Carlini, N. & Wagner, D. (2017).** Towards evaluating the robustness of neural networks. In *Proceedings of the IEEE Symposium on Security and Privacy (S&P)*. IEEE, 39–57.

12. **Chandrasekaran, V., Chaudhuri, K., Giacomelli, I., Jha, S., & Yan, S. (2020).** Exploring Connections Between Active Learning and Model Extraction. In *Proceedings of the USENIX Security Symposium (USENIX Security)*. USENIX Association.

13. **Chen, D., Yu, N., Zhang, Y., & Fritz, M. (2020).** GAN-leaks: A taxonomy of membership inference attacks against generative models. In *Proceedings of the ACM SIGSAC Conference on Computer and Communications Security (CCS)*. ACM, 343–362.

14. **Chen, K., Guo, S., Zhang, T., Xie, X., & Liu, Y. (2021).** Stealing Deep Reinforcement Learning Models for Fun and Profit. In *Proceedings of the ACM Asia Conference on Computer and Communications Security (ASIA CCS)*. 307–319.

15. **Devlin, J., Chang, M.-W., Lee, K., & Toutanova, K. (2018).** BERT: Pre-training of deep bidirectional transformers for language understanding. *arXiv preprint arXiv:1810.04805*.

16. **Ding, X., Wang, Z. J., & Welch, W. J. (2020).** Subsampling Generative Adversarial Networks: Density Ratio Estimation in Feature Space With Softplus Loss. *IEEE Transactions on Signal Processing* 68, 1910–1922.

17. **Folz, J. (2020).** simplejpeg 1.4.0. https://gitlab.com/jfolz/simplejpeg

18. **Ganju, K., Wang, Q., Yang, W., Gunter, C. A., & Borisov, N. (2018).** Property inference attacks on fully connected neural networks using permutation invariant representations. In *Proceedings of the ACM SIGSAC Conference on Computer and Communications Security (CCS)*. ACM, 619–633.

19. **Goodfellow, I., Pouget-Abadie, J., Mirza, M., Xu, B., Warde-Farley, D., Ozair, S., Courville, A., & Bengio, Y. (2014).** Generative adversarial nets. In *Proceedings of the Annual Conference on Neural Information Processing Systems (NeurIPS)*. Curran Associates, Inc., 2672–2680.

20. **Hayes, J., Melis, L., Danezis, G., & De Cristofaro, E. (2019).** LOGAN: Membership inference attacks against generative models. In *Proceedings on Privacy Enhancing Technologies*, Vol. 2019. Sciendo, 133–152.

21. **He, K., Zhang, X., Ren, S., & Sun, J. (2016).** Deep residual learning for image recognition. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)*. IEEE, 770–778.

22. **He, Y., Meng, G., Chen, K., Hu, X., & He, J. (2019).** Towards Privacy and Security of Deep Learning Systems: A Survey. *arXiv preprint arXiv:1911.12562*.

23. **Heusel, M., Ramsauer, H., Unterthiner, T., Nessler, B., & Hochreiter, S. (2017).** GANs trained by a two time-scale update rule converge to a local Nash equilibrium. In *Proceedings of the Annual Conference on Neural Information Processing Systems (NeurIPS)*. Curran Associates, Inc., 6626–6637.

24. **Hilprecht, B., Härterich, M., & Bernau, D. (2019).** Monte Carlo and reconstruction membership inference attacks against generative models. In *Proceedings on Privacy Enhancing Technologies*, Vol. 2019. Sciendo, 232–249.

25. **Huang, X. & Belongie, S. (2017).** Arbitrary style transfer in real-time with adaptive instance normalization. In *Proceedings of the IEEE International Conference on Computer Vision (ICCV)*. IEEE, 1501–1510.

26. **Huang, X., Li, Y., Poursaeed, O., Hopcroft, J., & Belongie, S. (2017).** Stacked generative adversarial networks. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)*. IEEE, 5077–5086.

27. **Jagielski, M., Carlini, N., Berthelot, D., Kurakin, A., & Papernot, N. (2020).** High Accuracy and High Fidelity Extraction of Neural Networks. In *Proceedings of the USENIX Security Symposium (USENIX Security)*. USENIX Association.

28. **Ji, S., Li, W., Gong, N. Z., Mittal, P., & Beyah, R. A. (2015).** On Your Social Network De-anonymizability: Quantification and Large Scale Evaluation with Seed Knowledge. In *Proceedings of the Network and Distributed Systems Security Symposium (NDSS)*. Internet Society.

29. **Jia, H., Choquette-Choo, C. A., Chandrasekaran, V., & Papernot, N. (2021).** Entangled watermarks as a defense against model extraction. In *Proceedings of the USENIX Security Symposium (USENIX Security)*. USENIX Association, 1937–1954.

30. **Juuti, M., Szyller, S., Marchal, S., & Asokan, N. (2019).** PRADA: protecting against DNN model stealing attacks. In *Proceedings of the IEEE European Symposium on Security and Privacy (Euro S&P)*. IEEE, 512–527.

31. **Karras, T., Aila, T., Laine, S., & Lehtinen, J. (2018).** Progressive Growing of GANs for Improved Quality, Stability, and Variation. In *Proceedings of the International Conference on Learning Representations (ICLR)*.

32. **Karras, T., Laine, S., & Aila, T. (2019).** A style-based generator architecture for generative adversarial networks. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)*. IEEE, 4401–4410.

33. **Karras, T., Laine, S., Aittala, M., Hellsten, J., Lehtinen, J., & Aila, T. (2020).** Analyzing and improving the image quality of StyleGAN. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)*. IEEE, 8110–8119.

34. **Krishna, K., Tomar, G. S., Parikh, A. P., Papernot, N., & Iyyer, M. (2020).** Thieves on Sesame Street! Model Extraction of BERT-based APIs. In *Proceedings of the International Conference on Learning Representations (ICLR)*.

35. **Lee, J., Yoon, W., Kim, S., Kim, D., Kim, S., So, C. H., & Kang, J. (2020).** BioBERT: a pre-trained biomedical language representation model for biomedical text mining. *Bioinformatics* 36(4), 1234–1240.

36. **Lee, T., Edwards, B., Molloy, I., & Su, D. (2019).** Defending against model stealing attacks using deceptive perturbations. In *Proceedings of the IEEE Security and Privacy Workshops*. IEEE, 43–49.

37. **Li, C. & Wand, M. (2016).** Precomputed real-time texture synthesis with Markovian generative adversarial networks. In *Proceedings of the European conference on computer vision (ECCV)*. Springer, 702–716.

38. **Li, H., Wenger, E., Zhao, B. Y., & Zheng, H. (2019).** Piracy Resistant Watermarks for Deep Neural Networks. *arXiv preprint arXiv:1910.01226*.

39. **Lin, C. H., Chang, C.-C., Chen, Y.-S., Juan, D.-C., Wei, W., & Chen, H.-T. (2019).** COCO-GAN: generation by parts via conditional coordinating. In *Proceedings of the IEEE International Conference on Computer Vision (ICCV)*. IEEE, 4512–4521.

40. **Liu, M.-Y., Huang, X., Mallya, A., Karras, T., Aila, T., Lehtinen, J., & Kautz, J. (2019).** Few-shot unsupervised image-to-image translation. In *Proceedings of the IEEE International Conference on Computer Vision (ICCV)*. IEEE, 10551–10560.

41. **Liu, Z., Luo, P., Wang, X., & Tang, X. (2015).** Deep Learning Face Attributes in the Wild. In *Proceedings of the IEEE International Conference on Computer Vision (ICCV)*. IEEE, 3730–3738.

42. **Lowd, D. & Meek, C. (2005).** Adversarial learning. In *Proceedings of the ACM SIGKDD international conference on Knowledge discovery in data mining (KDD)*. ACM, 641–647.

43. **Lučić, M., Tschannen, M., Ritter, M., Zhai, X., Bachem, O., & Gelly, S. (2019).** High-Fidelity Image Generation With Fewer Labels. In *Proceedings of the International Conference on Machine Learning (ICML)*. 4183–4192.

44. **Mahajan, D., Girshick, R., Ramanathan, V., He, K., Paluri, M., Li, Y., Bharambe, A., & van der Maaten, L. (2018).** Exploring the Limits of Weakly Supervised Pretraining. In *Proceedings of the European conference on computer vision (ECCV)*. Springer, 181–196.

45. **Milli, S., Schmidt, L., Dragan, A. D., & Hardt, M. (2019).** Model reconstruction from model explanations. In *Proceedings of the Conference on Fairness, Accountability, and Transparency*. ACM, 1–9.

46. **Mittal, A., Soundararajan, R., & Bovik, A. C. (2012).** Making a “completely blind” image quality analyzer. *IEEE Signal processing letters* 20(3), 209–212.

47. **Miyato, T., Kataoka, T., Koyama, M., & Yoshida, Y. (2018).** Spectral Normalization for Generative Adversarial Networks. In *Proceedings of the International Conference on Learning Representations (ICLR)*.

48. **Odena, A., Olah, C., & Shlens, J. (2017).** Conditional image synthesis with auxiliary classifier GANs. In *Proceedings of the International Conference on Machine Learning (ICML)*. 2642–2651.

49. **Orekondy, T., Schiele, B., & Fritz, M. (2019).** Knockoff Nets: Stealing Functionality of Black-Box Models. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)*. IEEE, 4954–4963.

50. **Pal, S., Gupta, Y., Shukla, A., Kanade, A., Shevade, S., & Ganapathy, V. (2020).** ACTIVETHIEF: Model Extraction Using Active Learning and Unannotated Public Data. In *Proceedings of the AAAI Conference on Artificial Intelligence (AAAI)*, Vol. 34. AAAI, 865–872.

51. **Papernot, N., McDaniel, P., Goodfellow, I., Jha, S., Celik, Z. B., & Swami, A. (2017).** Practical black-box attacks against machine learning. In *Proceedings of the ACM on Asia conference on computer and communications security (ASIA CCS)*. ACM, 506–519.

52. **Park, T., Liu, M.-Y., Wang, T.-C., & Zhu, J.-Y. (2019).** Semantic image synthesis with spatially-adaptive normalization. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)*. IEEE, 2337–2346.

53. **Radford, A., Metz, L., & Chintala, S. (2016).** Unsupervised representation learning with deep convolutional generative adversarial networks. In *Proceedings of the International Conference on Learning Representations (ICLR)*.

54. **Richardson, E. & Weiss, Y. (2018).** On GANs and GMMS. In *Proceedings of the Advances in Neural Information Processing Systems (NeurIPS)*, Vol. 31. Curran Associates, Inc., 5847–5858.

55. **Russakovsky, O., Deng, J., Su, H., Krause, J., Satheesh, S., Ma, S., Huang, Z., Karpathy, A., Khosla, A., Bernstein, M., Berg, A. C., & Fei-Fei, L. (2015).** ImageNet Large Scale Visual Recognition Challenge. *International journal of computer vision* 115(3), 211–252.

56. **Salem, A., Zhang, Y., Humbert, M., Berrang, P., Fritz, M., & Backes, M. (2019).** ML-Leaks: Model and Data Independent Membership Inference Attacks and Defenses on Machine Learning Models. In *Proceedings of the Network and Distributed Systems Security Symposium (NDSS)*. Internet Society.

57. **Salimans, T., Goodfellow, I., Zaremba, W., Cheung, V., Radford, A., & Chen, X. (2016).** Improved techniques for training GANs. In *Proceedings of the Annual Conference on Neural Information Processing Systems (NeurIPS)*. Curran Associates, Inc., 2234–2242.

58. **Shen, Y., Gu, J., Tang, X., & Zhou, B. (2020).** Interpreting the latent space of GANs for semantic face editing. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)*. IEEE, 9243–9252.

59. **Shokri, R., Strobel, M., & Zick, Y. (2019).** Privacy risks of explaining machine learning models. *arXiv preprint arXiv:1907.00164*.

60. **Shokri, R., Stronati, M., Song, C., & Shmatikov, V. (2017).** Membership inference attacks against machine learning models. In *Proceedings of the IEEE Symposium on Security and Privacy (S&P)*. IEEE, 3–18.

61. **Takemura, T., Yanai, N., & Fujiwara, T. (2020).** Model Extraction Attacks against Recurrent Neural Networks. *arXiv preprint arXiv:2002.00123*.

62. **Tierney, L. (1994).** Markov chains for exploring posterior distributions. *The Annals of Statistics* 22(4), 1701–1728.

63. **Touvron, H., Vedaldi, A., Douze, M., & Jégou, H. (2019).** Fixing the train-test resolution discrepancy. In *Proceedings of the Annual Conference on Neural Information Processing Systems (NeurIPS)*. Curran Associates, Inc., 8250–8260.

64. **Tramèr, F., Zhang, F., Juels, A., Reiter, M. K., & Ristenpart, T. (2016).** Stealing machine learning models via prediction APIs. In *Proceedings of the USENIX Security Symposium (USENIX Security)*. USENIX Association, 601–618.

65. **Turner, R., Hung, J., Frank, E., Saatchi, Y., & Yosinski, J. (2019).** Metropolis-Hastings Generative Adversarial Networks. In *Proceedings of the International Conference on Machine Learning (ICML)*. 6345–6353.

66. **van der Walt, S., Schönberger, J. L., Nunez-Iglesias, J., Boulogne, F., Warner, J. D., Yager, N., Gouillart, E., Yu, T., & the scikit-image contributors (2014).** scikit-image: image processing in Python. *PeerJ* 2, e453.

67. **Venkatanath, N., Praneeth, D., Bh, M. C., Channappayya, S. S., & Medasani, S. S. (2015).** Blind image quality evaluation using perception-based features. In *2015 Twenty First National Conference on Communications*. IEEE, 1–6.

68. **Wang, B. & Gong, N. Z. (2018).** Stealing hyperparameters in machine learning. In *Proceedings of the IEEE Symposium on Security and Privacy (S&P)*. IEEE, 36–52.

69. **Xian, W., Sangkloy, P., Agrawal, V., Raj, A., Lu, J., Fang, C., Yu, F., & Hays, J. (2018).** TextureGAN: Controlling deep image synthesis with texture patches. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)*. IEEE, 8456–8465.

70. **Xudong, P., Mi, Z., Shouling, J., & Min, Y. (2020).** Privacy Risks of General-Purpose Language Models. In *Proceedings of the IEEE Symposium on Security and Privacy (S&P)*. IEEE, 1471–1488.

71. **Yu, F., Seff, A., Zhang, Y., Song, S., Funkhouser, T., & Xiao, J. (2015).** LSUN: Construction of a large-scale image dataset using deep learning with humans in the loop. *arXiv preprint arXiv:1506.03365*.

72. **Zhang, H., Xu, T., Li, H., Zhang, S., Wang, X., Huang, X., & Metaxas, D. N. (2017).** StackGAN: Text to photo-realistic image synthesis with stacked generative adversarial networks. In *Proceedings of the IEEE International Conference on Computer Vision (ICCV)*. IEEE, 5907–5915.

73. **Zhu, J.-Y., Krähenbühl, P., Shechtman, E., & Efros, A. A. (2016).** Generative visual manipulation on the natural image manifold. In *Proceedings of the European conference on computer vision (ECCV)*. Springer, 597–613.

---

### Algorithm 1: MH Subsampling

**Input:**
- Target generator \( G \)
- Target discriminator \( D \)
- Partial real samples \( X_r = \{x_{r1}, x_{r2}, \ldots, x_{rm}\} \)

**Output:**
- \( N \) refined images

1. Sample \( m \) fake images \( X_f = \{x_{f1}, x_{f2}, \ldots, x_{fm}\} \) from \( G \).
2. Train a calibrated classifier:
   \[
   C \leftarrow \text{LogisticRegression}(D(X_r), D(X_f))
   \]
3. Initialize an empty set of images: \( \text{images} \leftarrow \emptyset \).
4. While the number of images in the set is less than \( N \):
   1. Select a real image \( x \) from \( X_r \).
   2. For \( i = 1 \) to \( K \):
      1. Sample a new image \( x' \) from \( G \).
      2. Sample a random number \( u \) from a uniform distribution \( \text{Uniform}(0, 1) \).

This optimized version ensures that the text is clear, coherent, and professionally formatted.