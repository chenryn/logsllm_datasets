### References

- **[36]** J. Kornblum, "Identifying almost identical files using context-triggered piecewise hashing," *Digital Investigation*, vol. 3, pp. 91–97, 2006.
- **[37]** T. I. Team, "Avast: Greedy cybercriminals host malware on GitHub," March 2018. [Online]. Available: https://perma.cc/DV7R-Q7CQ
- **[38]** Cyren, "F-Prot Antivirus," 2014. [Online]. Available: http://www.f-prot.com
- **[39]** C. McMillan and J. Garman, "System and method for determining data entropy to identify malware," Nov. 29, 2011, US Patent 8,069,484.
- **[40]** X. Ugarte-Pedrero, I. Santos, B. Sanz, C. Laorden, and P. G. Bringas, "Countering entropy measure attacks on packed software detection," in *Proceedings of the IEEE Consumer Communications and Networking Conference (CCNC)*, Las Vegas, NV, USA: IEEE, 2012, pp. 164–168.
- **[41]** N. Miramirkhani, M. P. Appini, N. Nikiforakis, and M. Polychronakis, "Spotless sandboxes: Evading malware analysis systems using wear-and-tear artifacts," in *IEEE Symposium on Security and Privacy (SP)*, San Jose, CA, USA: IEEE, 2017, pp. 1009–1024.
- **[42]** W. Wang, B. Ferrell, X. Xu, K. W. Hamlen, and S. Hao, "SEISMIC: Secure In-lined Script Monitors for Interrupting Cryptojacks," in *European Symposium on Research in Computer Security (ESORICS)*, Barcelona, Spain: Springer International Publishing, 2018, pp. 122–142.
- **[43]** H. Kim, J. Smith, and K. G. Shin, "Detecting energy-greedy anomalies and mobile malware variants," in *Proceedings of the 6th International Conference on Mobile Systems, Applications, and Services*, Breckenridge, CO, USA: ACM, 2008, pp. 239–252.
- **[44]** G. Suarez-Tangil, J. E. Tapiador, P. Peris-Lopez, and S. Pastrana, "Power-aware anomaly detection in smartphones: An analysis of on-platform versus externalized operation," *Pervasive and Mobile Computing*, vol. 18, pp. 137–151, 2015.

### Appendix

#### A. Ethical Issues

Most of the data collected is publicly available. However, both Palo Alto Networks and VirusTotal shared some non-public information with us, and we obtained their permission to use it for this paper. Another ethical concern relates to the implications of reporting any misuse activity to the pools. Specifically, we have reported evidence of wallets seen in crypto-mining malware. Our actions might lead to interventions over the reported users due to criminal activity, which entails potential ethical implications if non-criminal wallets are mistakenly banned. We have taken due precautions to ensure that we only report wallets used by malware as discussed in the paper. Thus, our study has been approved by the designated ethics officer at the Research Ethics Board (REB) of our institution.

In addition to our precautions, we provided the pools with accompanying evidence proving illicit activity, including a pointer to the VirusTotal report. However, despite our involvement, the final decision to ban the wallets relies on the pool operators. These operators have additional insights into the modus operandi of their users (e.g., the number of IP addresses currently mining with a wallet) that can be used to further corroborate any type of misuse. It is our understanding that the pools that took action against some of the reported users based their decision solely on the number of connections per wallet. Multiple connections from the same wallet indicate the use of a botnet, which is against the terms and conditions of some pools. However, a botnet can always hide behind a single IP address using proxies. Additionally, we observed that the pools do not proactively ban wallets that display botnet-like activity. The ethical implications of the banning policies of the pools are discussed in §VI.

#### B. Crypto-Mining Trends in Underground Forums

As discussed in §II, the underground economy plays a key role in the proliferation of malicious crypto-mining threats. After analyzing our dataset of posts collected from several underground forums, we observed a large number of posts discussing the use of illicit crypto-mining malware. Figure 1 shows the proportion of threats discussing the use of crypto-mining malware over time for different cryptocurrencies.

We observe that Monero was the most prevalent cryptocurrency in 2018. Bitcoin, while previously the most popular among illicit miners, has seen its popularity decline over time. We also note that actors in the underground economy experimented with less popular cryptocurrencies such as Dogecoin or Litecoin during 2013 and 2014. However, criminals shifted to Bitcoin and Monero, likely due to their increasing profitability.

We studied a large portion of these posts, as discussed in §II, and showed that the commoditization of cybercrime is key to the success of illicit crypto-mining. Figure 2 provides evidence of this, showing an advertisement posted in one of the largest English-speaking underground forums, offering a "Silent XMR" (i.e., using obfuscated binaries) Botnet. Among other features, it claims the use of xmrig as a mining tool with support for proxies. We have seen a wide range of similar advertisements in our analysis of underground economies.

#### C. Other Data Sources

Although our data collection originated from all the sources described in §III-A, we later discovered overlaps between the different sources. During our dataset consolidation, we observed that VirusTotal, Palo Alto Networks, VirusShare, and Hybrid Analysis together accounted for (at least) all the samples observed in the remaining sources. Most of the malicious miners appear in these four datasets, so we consider them to be the main sources for collecting binaries. For simplicity, we only refer to VirusTotal, Palo Alto Networks, VirusShare, and Hybrid Analysis when labeling the source of the dataset in this paper. However, we highlight that the alternative sources of data provide valuable complementary metadata used in our study. We also extend the metadata available for each sample with targeted queries run using binary or network inspection, as described in §III-C.

#### D. Additional Measurements

In this section, we provide additional measurements obtained from our analysis:

- **Table XIII** shows an extended list of URLs hosting the malware observed during our analysis.
- **Table XIV** shows the top 10 wallets sorted by how much they gained. Note that these numbers include donation wallets, which we have filtered for our profit analysis. Nevertheless, we include them in Table XIV to show the similarity between the findings reported in [16].
- **Table XV** shows the number of emails detected for each associated domain. As can be observed, most of the emails are used to mine in minergate, an opaque pool that allows mining in various cryptocurrencies.

#### E. Payments in the Freebuf Campaign

In this section, we visualize the payments made as a mining reward for wallets belonging to the Freebuf campaign, which is the longest-running and highest-earning campaign. Figure 7 shows the payments made to all the wallets related to the campaign over time. A more detailed analysis is shown in Figure 8, focusing on the payments made in 2018 to the two wallets that were banned in minexmr. It can be observed that, after being banned, campaign operators decided to return to the ppxmr pool. However, while the campaign is still active, both the intervention (i.e., wallets being banned) and the change in the Proof of Work (PoW) algorithm in October 2018 have considerably reduced the payments made to this campaign, nearly turning it off.

- **Figure 7**: Payments per wallet for the Freebuf campaign. Dashed red lines correspond to the two changes in the Monero PoW algorithm.
- **Figure 8**: Detailed view of the wallets banned in the Freebuf campaign. The blue vertical line shows when the wallets were banned.

### Tables

- **Table XIII**: Extended list of domains hosting known mining malware, number of samples hosted under each domain, and number of URLs hosting those samples.
- **Table XIV**: Amount of Monero mined and corresponding USD for the top 10 wallets.
- **Table XV**: Number of emails in pools.

### Figures

- **Figure 7**: Payments per wallet for the Freebuf campaign.
- **Figure 8**: Detailed view of the wallets banned in the Freebuf campaign.