# References

1. Ravindra K. Ahuja, Thomas L. Magnanti, and James B. Orlin. *Network Flows*. Prentice Hall, Englewood Cliffs, New Jersey, 1993.

2. David Applegate and Edith Cohen. "Making Intra-Domain Routing Robust to Changing and Uncertain Traffic Demands: Understanding Fundamental Tradeoffs." In *Proceedings of ACM SIGCOMM*, pages 313–324, 2003.

3. David Applegate, Lee Breslau, and Edith Cohen. "Coping with Network Failures: Routing Strategies for Optimal Demand-Oblivious Restoration." In *Proceedings of the Joint International Conference on Measurement and Modeling of Computer Systems (SIGMETRICS '04/Performance '04)*, pages 270–281, 2004.

4. Abraham Berman and Robert J. Plemmons. *Nonnegative Matrices in the Mathematical Sciences*. Classics in Applied Mathematics. Society for Industrial and Applied Mathematics, 1994.

5. Randeep S. Bhatia, Murali Kodialam, T. V. Lakshman, and Sudipta Sengupta. "Bandwidth Guaranteed Routing with Fast Restoration Against Link and Node Failures." *IEEE/ACM Transactions on Networking*, 16(6):1321–1330, December 2008.

6. Jeremy Bogle, Nikhil Bhatia, Manya Ghobadi, Ishai Menache, Nikolaj Bjorner, Asaf Valadarsky, and Michael Schapira. "Teavar: Striking the Right Utilization-Availability Balance in WAN Traffic Engineering." In *Proceedings of ACM SIGCOMM*, 2019. (to appear).

7. Jonathan M. Borwein and Adrian S. Lewis. *Convex Analysis and Nonlinear Optimization*. Springer, New York, 2000.

8. James H. Bramble and Bert E. Hubbard. "On a Finite Difference Analogue of an Elliptic Boundary Problem Which is Neither Diagonally Dominant Nor of Non-Negative Type." *Journal of Mathematics and Physics*, 43(1-4):117–132, 1964.

9. Yiyang Chang, Sanjay Rao, and Mohit Tawarmalani. "Robust Validation of Network Designs Under Uncertain Demands and Failures." In *14th USENIX Symposium on Networked Systems Design and Implementation (NSDI)*, pages 347–362, 2017.

10. Yiyang Chang, Chuan Jiang, Ashish Chandra, Sanjay Rao, and Mohit Tawarmalani. "Lancet: Better Network Resilience by Designing for Pruned Failure Sets." *Proceedings of the ACM on Measurement and Analysis of Computing Systems*, 3:1–26, 2019. doi: 10.1145/3366697.

11. Bernard Fortz and Mikkel Thorup. "Robust Optimization of OSPF/IS-IS Weights." In *Proceedings of International Network Optimization Conference*, pages 225–230, 2003.

12. Phillipa Gill, Navendu Jain, and Nachiappan Nagappan. "Understanding Network Failures in Data Centers: Measurement, Analysis, and Implications." In *Proceedings of ACM SIGCOMM*, pages 350–361, 2011.

13. P. Brighten Godfrey, Igor Ganichev, Scott Shenker, and Ion Stoica. "Pathlet Routing." In *Proceedings of the ACM SIGCOMM 2009 Conference on Data Communication*, pages 111–122, 2009.

14. Ramesh Govindan, Ina Minei, Mahesh Kallahalla, Bikash Koley, and Amin Vahdat. "Evolve or Die: High-Availability Design Principles Drawn from Google's Network Infrastructure." In *Proceedings of ACM SIGCOMM*, pages 58–72, 2016.

15. Fang Hao, Murali Kodialam, and T. V. Lakshman. "Optimizing Restoration with Segment Routing." In *Proceedings of IEEE INFOCOM*, pages 1–9, April 2016.

16. Renaud Hartert, Stefano Vissicchio, Pierre Schaus, Olivier Bonaventure, Clarence Filsfils, Thomas Telkamp, and Pierre Francois. "A Declarative and Expressive Approach to Control Forwarding Paths in Carrier-Grade Networks." In *Proceedings of ACM SIGCOMM*, pages 15–28, 2015.

17. Chi-Yao Hong, Srikanth Kandula, Ratul Mahajan, Ming Zhang, Vijay Gill, Mohan Nanduri, and Roger Wattenhofer. "Achieving High Utilization with Software-Driven WAN." In *Proceedings of ACM SIGCOMM*, pages 15–26, 2013.

18. Chi-Yao Hong, Subhasree Mandal, Mohammad Al-Fares, Min Zhu, Richard Alimi, Kondapa Naidu B., Chandan Bhagat, Sourabh Jain, Jay Kaimal, Shiyu Liang, Kirill Mendelev, Steve Padgett, Faro Rabe, Saikat Ray, Malveeka Tewari, Matt Tierney, Monika Zahn, Jonathan Zolla, Joon Ong, and Amin Vahdat. "B4 and After: Managing Hierarchy, Partitioning, and Asymmetry for Availability and Scale in Google’s Software-Defined WAN." In *Proceedings of the 2018 Conference of the ACM Special Interest Group on Data Communication*, pages 74–87, 2018.

19. Gurobi Optimization Inc. *Gurobi Optimizer Reference Manual*, 2016. http://www.gurobi.com.

20. Sushant Jain, Alok Kumar, Subhasree Mandal, Joon Ong, Leon Poutievski, Arjun Singh, Subbaiah Venkata, Jim Wanderer, Junlan Zhou, Min Zhu, Jon Zolla, Urs Hölzle, Stephen Stuart, and Amin Vahdat. "B4: Experience with a Globally-Deployed Software Defined WAN." In *Proceedings of ACM SIGCOMM*, pages 3–14, 2013.

21. Thomas J. Jech. *The Axiom of Choice*. Courier Corporation, 2008.

22. Simon Knight, Hung Nguyen, Nickolas Falkner, Rhys Bowden, and Matthew Roughan. "The Internet Topology Zoo." *IEEE Journal on Selected Areas in Communications*, 29:1765–1775, October 2011.

23. Praveen Kumar, Yang Yuan, Chris Yu, Nate Foster, Robert Kleinberg, Petr Lapukhov, Chiun Lin Lim, and Robert Soulé. "Semi-Oblivious Traffic Engineering: The Road Not Taken." In *15th USENIX Symposium on Networked Systems Design and Implementation (NSDI 18)*, pages 157–170, 2018.

24. Kin-Wah Kwong, Lixin Gao, Roch Guérin, and Zhi-Li Zhang. "On the Feasibility and Efficacy of Protection Routing in IP Networks." *IEEE/ACM Transactions on Networking*, 19(5):1543–1556, October 2011.

25. Karthik Lakshminarayanan, Matthew Caesar, Murali Rangan, Tom Anderson, Scott Shenker, and Ion Stoica. "Achieving Convergence-Free Routing Using Failure-Carrying Packets." In *Proceedings of ACM SIGCOMM*, pages 241–252, 2007.

26. Hongqiang Harry Liu, Srikanth Kandula, Ratul Mahajan, Ming Zhang, and David Gelernter. "Traffic Engineering with Forward Fault Correction." In *Proceedings of ACM SIGCOMM*, pages 527–538, 2014.

27. Athina Markopoulou, Gianluca Iannaccone, Supratik Bhattacharyya, Chen-Nee Chuah, Yashar Ganjali, and Christophe Diot. "Characterization of Failures in an Operational IP Backbone Network." *IEEE/ACM Trans. Netw.*, 16(4):749–762, 2008.

28. P. Pan, G. Swallow, and A. Atlas. "Fast Reroute Extensions to RSVP-TE for LSP Tunnels." RFC 4090, May 2005.

29. Michal Pióro and Deepankar Medhi. *Routing, Flow, and Capacity Design in Communication and Computer Networks*. Morgan Kaufmann Publishers Inc., San Francisco, CA, USA, 2004. ISBN 0125571895.

30. Rahul Potharaju and Navendu Jain. "When the Network Crumbles: An Empirical Study of Cloud Network Failures and Their Impact on Services." In *Proceedings of the 4th Annual Symposium on Cloud Computing (SOCC '13)*, pages 15:1–15:17, 2013.

31. M. Shand and S. Bryant. "IP Fast Reroute Framework." RFC 5714, January 2010.

32. Rakesh Sinha, Funda Ergun, Kostas N. Oikonomou, and K. K. Ramakrishnan. "Network Design for Tolerating Multiple Link Failures Using Fast Re-route (FRR)." In *2014 10th International Conference on the Design of Reliable Communication Networks (DRCN)*, pages 1–8, April 2014.

33. Martin Suchara, Dahai Xu, Robert Doverspike, David Johnson, and Jennifer Rexford. "Network Architecture for Joint Failure Recovery and Traffic Engineering." *SIGMETRICS Perform. Eval. Rev.*, 39(1):97–108, 2011.

34. Jeff Tantsura, Igor Milojevic, Edward Crabbe, Stefano Previdi, Martin Horneffer, Ahmed Bashandy, Rob Shakir, Clarence Filsfils, Bruno Decraene, Saku Ytti, et al. "Segment Routing Architecture." IETF Internet draft, 2013.

35. Daniel Turner, Kirill Levchenko, Alex C. Snoeren, and Stefan Savage. "California Fault Lines: Understanding the Causes and Impact of Network Failures." In *Proceedings of the ACM SIGCOMM 2010 Conference*, pages 315–326, 2010.

36. Hao Wang, Haiyong Xie, Lili Qiu, Yang Richard Yang, Yin Zhang, and Albert Greenberg. "COPE: Traffic Engineering in Dynamic Networks." In *Proceedings of ACM SIGCOMM*, pages 99–110, 2006.

37. Ye Wang, Hao Wang, Ajay Mahimkar, Richard Alimi, Yin Zhang, Lili Qiu, and Yang Richard Yang. "R3: Resilient Routing Reconfiguration." In *Proceedings of ACM SIGCOMM*, pages 291–302, 2010.

38. Baohua Yang, Junda Liu, Scott Shenker, Jun Li, and Kai Zheng. "Keep Forwarding: Towards k-Link Failure Resilient Routing." In *Proceedings of IEEE INFOCOM*, pages 1617–1625, April 2014.

39. Chun Zhang, Zihui Ge, Jim Kurose, Yong Liu, and Don Towsley. "Optimal Routing with Multiple Traffic Matrices: Tradeoff Between Average and Worst Case Performance." In *13th IEEE International Conference on Network Protocols (ICNP 2005)*, 2005.

40. Yin Zhang, Zihui Ge, Albert Greenberg, and Matthew Roughan. "Network Anomaly Detection." In *Proceedings of the 5th ACM SIGCOMM Conference on Internet Measurement*, pages 30–30, 2005.

41. Jiaqi Zheng, Hong Xu, Xiaojun Zhu, Guihai Chen, and Yanhui Geng. "We’ve Got You Covered: Failure Recovery with Backup Tunnels in Traffic Engineering." In *2016 IEEE 24th International Conference on Network Protocols (ICNP)*, pages 1–10, 2016.

## Appendix

### Appendices
Appendices are supporting material that has not been peer-reviewed.

#### Notation in PCF and FFC
In this paper, we use slightly different notation than FFC. For example, FFC uses \( f \) to denote a flow aggregated by a pair of ingress-egress switches, while we use \( (s, t) \) to directly denote a flow by its ingress and egress switches. In Table 2, we list key notation in PCF and the corresponding notation in FFC.

| **PCF** | **FFC** | **Meaning** |
|---------|---------|-------------|
| \( (s, t) \) | \( f \) | A flow aggregated by ingress-egress switches |
| \( d_{st} \) | \( d_f \) | The bandwidth demand of a flow |
| \( T(s, t) \) | \( T_f \) | The set of tunnels that are set up for a flow |
| \( e \in \tau_l \) | \( L[t, e] \) | True (1) if tunnel \( l \) (or \( t \)) uses link \( e \) and False (0) otherwise |
| \( z_{st}d_{st} \) | \( b_f \) | The bandwidth granted to a flow |
| \( a_l \) | \( a_{f,t} \) | The bandwidth allocated to a tunnel |

#### Efficiently Solving PCF’s Models Leveraging LP Duality
As presented, converting PCF’s models into Linear Programs (LPs) would create one constraint per failure scenario, which is not scalable since the number of failure scenarios in \( Y \) may be large. Instead, we leverage a dualization technique, which has been extensively used in prior work [26, 37]. We illustrate with PCF-TF, but note that the same approach can be used for all of PCF’s schemes. We rewrite (1) as:

\[ a_l (1 - y_l) \geq z_{st}d_{st} \quad \forall s, t \in V \]

These constraints are reformulated by relaxing the integrality of \( y \) variables and expressing the left-hand side (LHS) as a maximization problem leveraging LP duality, as shown below:

\[
\begin{aligned}
& \text{(D1)} & \max_{\pi, \lambda, \sigma, \phi} & \quad -\left( f \lambda_{st} + \sum_{e \in E} \sigma_{est} + \sum_{l \in T(s, t)} \phi_l \right) \\
& \text{s.t.} & \pi_l + \phi_l & \geq a_l \quad \forall l \in T(s, t) \\
& & \pi_l + \lambda_{st} + \sigma_{est} & \geq 0 \quad \forall e \\
& & \pi_l & \geq 0 \quad \forall l \in T(s, t) \\
& & \lambda_{st} & \geq 0 \\
& & \sigma_{est} & \geq 0 \quad \forall e \in E \\
& & \phi_l & \geq 0 \quad \forall l \in T(x, y).
\end{aligned}
\]

Now, we incorporate (D1) into (10) and combine it with the rest of the constraints in (P1) to obtain the final model below:

\[
\begin{aligned}
& \text{(D2)} & \max_{\pi, \lambda, \sigma, \phi, z, a} & \quad \sum_{s, t \in V} \Theta(z) \\
& \text{s.t.} & \sum_{l \in T(s, t)} a_l - \left( f \lambda_{st} + \sum_{e \in E} \sigma_{est} + \sum_{l \in T(s, t)} \phi_l \right) & \geq z_{st}d_{st} \quad \forall s, t \in V \\
& & a_l & \geq 0 \quad \forall s, t \in V, \forall l \in T(s, t) \\
& & \pi_l + \phi_l & \geq a_l \quad \forall s, t \in V, \forall l \in T(s, t) \\
& & \pi_l + \lambda_{st} + \sigma_{est} & \geq 0 \quad \forall e, \forall s, t \in V \\
& & \sum_{l: e \in \tau_l} a_l \delta(e \in \tau_l) & \leq c_e \quad \forall e \in E \\
& & \pi_l & \geq 0 \quad \forall s, t \in V, \forall l \in T(s, t) \\
& & \lambda_{st} & \geq 0 \quad \forall s, t \in V.
\end{aligned}
\]