### Distribution of NTP Packet Sizes at the IXP

In Figure 2(a), we observe a nearly bimodal distribution of NTP packet sizes. Approximately 54% of the NTP packets are smaller than 200 bytes, which is likely benign traffic, while 46% are larger, indicating potential attack traffic. Based on this observation, we define a threshold of 200 bytes as an optimistic classification criterion for distinguishing between benign and malicious NTP traffic.

### NTP Amplification Traffic in the Wild

By applying our classification criteria, we identified 311,000 destinations (Tier-1 ISP: 36,000, Tier-2 ISP: 95,000, IXP: 244,000) that received NTP reflection traffic during the measurement period (see Section 2). In Figure 2(b), we plot the destination IPs (victims) of the attack traffic, showing the number of unique amplification sources (y-axis) and the maximum traffic level in Gbps over one minute (x-axis). The majority of traffic peaks (y-axis) range from 5 to 100 Gbps, with an average of 2.64 Gbps. Notably, 224 victims experienced traffic exceeding 100 Gbps, with 5 victims receiving more than 300 Gbps, and one destination even reaching 602 Gbps. It is important to note that observing only IXP (peering) traffic may underestimate the true attack volumes if transit links are not captured (see Section 3.2).

### Higher Traffic Rates and Amplifiers

Higher traffic rates often involve a greater number of amplifiers (sources). Most destinations receive traffic from hundreds of amplifiers, with some receiving from thousands (average: 35). Outliers, particularly in the Tier-1 ISP, can receive traffic from up to approximately 8,500 amplifiers.

In Figure 2(c) (top), we study the maximum number of amplifiers per attack target (unique destination IP) within one-minute intervals, shown as a cumulative distribution function (CDF). Most targets receive traffic from fewer than 5 reflectors. For Tier-1 and IXP vantage points, about 70% of targets receive traffic from fewer than 10 reflectors. Interestingly, for the Tier-2 ISP, 90% of the targets receive amplification NTP traffic from fewer than 10 amplifiers. For comparison, the CDF of attack traffic peaks within one minute per target for all three data sets is depicted in Figure 2(c) (bottom). Only 0.09% of targets receive more than 1 Gbps peak traffic, and at the IXP, 158 targets receive more than 100 Gbps. On the other hand, a majority of targets receive a negligible amount of traffic.

### Conservative NTP DDoS Classification

To identify a sample of NTP DDoS attacks with a low rate of false positives, we adopt a more conservative approach by excluding two additional cases of false positives: the scanning or monitoring of NTP monlists [14] and the use of the NTP port by custom applications. Based on insights from our self-attacks in Section 3, we introduce two filtering rules: (a) traffic to the target must exceed 1 Gbps, and (b) it must originate from more than 10 amplifiers. Applying both rules reduces the number of NTP destinations by 78% (applying rule (a) alone: 74%, rule (b) alone: 59%). This results in a dataset likely containing only NTP DDoS traffic.

### Takeaway

NTP-based DDoS traffic is prevalent at all three vantage points and can be classified using the proposed criteria. The observed attacks involve traffic rates of up to 600 Gbps, often generated by a large number of reflectors, during our observation period. The extent and size of these DDoS attacks raise questions about the effectiveness of takedowns of booter services in reducing overall attack traffic.

### FBI Takedown of 15 Booter Websites

On December 19, 2018, the FBI seized the domains of 15 booter websites (e.g., critical-boot.com or quantumstress.net) [56]. All seized booters were tested by the FBI, and it was determined that these services could cause significant network disruptions. Smaller seizures of single booter domains had occurred previously, such as the seizure of web-stresser.org with over 138,000 registered users in 2018 [28]. Beyond domain seizures, booter users and operators can face legal actions [30], such as the operator of Titanium Stresser, who was sentenced to years in prison in 2017 [27].

### Domain Perspective on Takedown

We first take a control plane perspective on the available booter domains. Using weekly snapshots of all .com/.net/.org domains, we identify booter websites by keyword matching (e.g., "booter", "stresser", "ddos-as-a-service"). This provides an overview of booter domains before and after the takedown. We manually verified 58 booter .com/.net/.org domains. Using daily snapshots of the Alexa Top 1M list [48], we rank the identified booter domains by their median Alexa rank over each month, as shown in Figure 3. Seized domains have a high Alexa rank but not the highest among all booter domains. Despite the seizure of 15 domains, many alternative booter sites still exist. Following the takedown, we identified a new domain for a seized booter that became active and entered the global Alexa Top 1M list just three days after the seizure. Our account credentials registered with the seized domain still work with the new domain.

### Traffic Perspective on Takedown

To study the data plane effects of the mass-seizure in 2018, we perform a time series analysis of 122 days, beginning September 30, 2018, and ending January 30, 2019, spanning the seizure on December 19, 2018. We calculate the following metrics: (a) `wt30`/`wt40` is a boolean metric indicating whether a one-tailed Welsh unequal variances test comparing the daily sum of packets 30/40 days before and 30/40 days after the takedown finds any significant difference at p = 0.05; (b) `red30`/`red40` is the ratio of the daily average of sums of packets 30/40 days before and 30/40 days after the takedown. Using these metrics, we investigate combinations of suspicious protocol ports (NTP, memcached, DNS, etc.) as source or destination ports for ingress and egress traffic.

#### Memcached Traffic to Reflectors

Memcached remains a popular attack vector due to its high amplification factor. Any UDP traffic with the Memcached target port number 11211 is assumed to be traffic flowing to a DDoS memcached reflector. In Figure 4 (top), we show the number of packets to memcached reflectors for the IXP vantage point. A statistically significant reduction is found for both the 30-day window (`wt30`) and the 40-day window (`wt40`). The average daily number of packets after the takedown is 22.50% (`red30`) and 27.72% (`red40`) compared to before. A similar and significant reduction was found for the Tier-2 ISP (`wt30`/`wt40` = True, `red30` = 7.34%, `red40` = 4.99%).

#### NTP Traffic to Reflectors

NTP is a leading amplification vector due to the high number of open NTP reflectors. We compare traffic to NTP reflectors under the assumption that any traffic with UDP target port 123 is a spoofed packet for triggering an attack. Even when accepting unquantifiable noise, we find significant reductions in traffic to NTP reflectors for the ISP vantage point (see Figure 4, middle). After the seizure, the number of packets falls to 39.68% (`red30`) and 26.97% (`red40`) respectively. The same is true for the IXP vantage point (`wt30`/`wt40` = True, `red30` = 22.5%, `red40` = 27.72%).

#### DNS Traffic to Reflectors

Similar to NTP and Memcached, DNS is abused for DDoS as a reflector. However, separating legitimate from illegitimate requests is challenging. Our results for DNS request packets at the Tier-2 ISP’s vantage point (Figure 4, bottom) are not as visually impressive as for other vectors. Nevertheless, we find a statistically significant reduction in DNS traffic to reflectors.

### Conclusion

Our study aims to inform network operators about the current threat level and law enforcement agencies about the need for additional efforts to shut down or block open reflectors. While the takedown had an immediate effect on DDoS amplification traffic, it did not significantly reduce the traffic hitting victims or the number of attacks observed. This indicates that seizing the front end is insufficient, as the underlying infrastructure of reflectors remains online and is utilized by third parties. Moreover, at least one booter became active under a new domain shortly after the seizure, and the number of booter service domains increased over the measurement period despite the seizure. Further research is needed to better understand the effects of law enforcement on the booter economy, including infrastructures, financing, and involved entities.

### Acknowledgments

We thank the anonymous reviewers of IMC and our shepherd, J. Alex Halderman (University of Michigan), for their constructive comments, as well as our colleague Tim Träris and our significant others for their tremendous patience. This work was supported in part by the German Federal Ministry of Education and Research project AIDOS (6KIS0975K, 16KIS0976), by EC H2020 project CONCORDIA (GA 830927), and the SIDN fonds project DDoSDB (174058).

### References

[1] Akamai. State of the Internet Security Report (Q4 2017). https://www.akamai.com/us/en/multimedia/documents/state-of-the-internet/q4-2017-state-of-the-internet-security-report.pdf, 2017.
[2] Akamai. State of the Internet Security Report (Attack Spotlight: Memcached). https://www.akamai.com/us/en/multimedia/documents/state-of-the-internet/soti-summer-2018-attack-spotlight.pdf, 2018.
[3] Antonakakis, M., et al. Understanding the Mirai Botnet. USENIX Security Symposium (2017).
[4] BBC. 'Hacking attacks' hit Russian political sites. http://www.bbc.com/news/technology-16032402, 2012.
[5] Beverly, R., and Bauer, S. The Spoofer Project: Inferring the Extent of Internet Source Address Filtering on the Internet. In Steps to Reducing Unwanted Traffic on the Internet Workshop, SRUTI’05, Cambridge, MA, USA, July 7, 2005.
[6] Beverly, R., Berger, A., Hyun, Y., and claffy, k. Understanding the Efficacy of Deployed Internet Source Address Validation Filtering. In Internet Measurement Conference (IMC) (Nov 2009).