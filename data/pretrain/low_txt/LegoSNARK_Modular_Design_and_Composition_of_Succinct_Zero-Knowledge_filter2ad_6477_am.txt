### References

- **TH16**: In *USENIX Security 2016*, edited by Thorsten Holz and Stefan Savage, pages 1069–1083. USENIX Association, August 2016.
- **GMR89**: Shaﬁ Goldwasser, Silvio Micali, and Charles Rackoﬀ. "The knowledge complexity of interactive proof systems." *SIAM Journal on Computing*, 18(1):186–208, 1989.
- **GMO16**
- **GKS17**
- **GMW87**: Oded Goldreich, Silvio Micali, and Avi Wigderson. "How to play any mental game or A completeness theorem for protocols with honest majority." In *19th ACM STOC*, edited by Alfred Aho, pages 218–229. ACM Press, May 1987.
- **Gro09**: Jens Groth. "Linear algebra with sub-linear zero-knowledge arguments." In *CRYPTO 2009*, volume 5677 of LNCS, pages 192–208. Springer, Heidelberg, August 2009.
- **Gro10**: Jens Groth. "Short pairing-based non-interactive zero-knowledge arguments." In *ASIACRYPT 2010*, volume 6477 of LNCS, edited by Masayuki Abe, pages 321–340. Springer, Heidelberg, December 2010.
- **Gro16**: Jens Groth. "On the size of pairing-based non-interactive arguments." In *EUROCRYPT 2016, Part II*, volume 9666 of LNCS, edited by Marc Fischlin and Jean-Sébastien Coron, pages 305–326. Springer, Heidelberg, May 2016.
- **GW11**: Craig Gentry and Daniel Wichs. "Separating succinct non-interactive arguments from all falsifiable assumptions." In *43rd ACM STOC*, edited by Lance Fortnow and Salil P. Vadhan, pages 99–108. ACM Press, June 2011.
- **IKO07**: Yuval Ishai, Eyal Kushilevitz, and Rafail Ostrovsky. "Efficient arguments without short PCPs." In *Proceedings of the Twenty-Second Annual IEEE Conference on Computational Complexity (CCC '07)*, pages 278–291. IEEE Computer Society, 2007.
- **IKOS07**: Yuval Ishai, Eyal Kushilevitz, Rafail Ostrovsky, and Amit Sahai. "Zero-knowledge from secure multiparty computation." In *39th ACM STOC*, edited by David S. Johnson and Uriel Feige, pages 21–30. ACM Press, June 2007.
- **Kil89**: J. Kilian. "Uses of randomness in algorithms and protocols." PhD Thesis, Massachusetts Institute of Technology, 1989.
- **Kil92**: Joe Kilian. "A note on efficient zero-knowledge proofs and arguments (extended abstract)." In *24th ACM STOC*, pages 723–732. ACM Press, May 1992.
- **KPP+14**: Ahmed E. Kosba, Dimitrios Papadopoulos, Charalampos Papamanthou, Mahmoud F. Sayed, Elaine Shi, and Nikos Triandopoulos. "TRUESET: Faster verifiable set computations." In *USENIX Security 2014*, edited by Kevin Fu and Jaeyeon Jung, pages 765–780. USENIX Association, August 2014.
- **KW15**: Eike Kiltz and Hoeteck Wee. "Quasi-adaptive NIZK for linear subspaces revisited." In *EUROCRYPT 2015, Part II*, volume 9057 of LNCS, edited by Elisabeth Oswald and Marc Fischlin, pages 101–128. Springer, Heidelberg, April 2015.
- **LFKN92**: Carsten Lund, Lance Fortnow, Howard Karloff, and Noam Nisan. "Algebraic methods for interactive proof systems." *J. ACM*, 39(4):859–868, October 1992.
- **Lip12**: Helger Lipmaa. "Progression-free sets and sublinear pairing-based non-interactive zero-knowledge arguments." In *TCC 2012*, volume 7194 of LNCS, edited by Ronald Cramer, pages 169–189. Springer, Heidelberg, March 2012.
- **Lip16**: Helger Lipmaa. "Prover-efficient commit-and-prove zero-knowledge SNARKs." In *AFRICACRYPT 16*, volume 9646 of LNCS, edited by David Pointcheval, Abderrahmane Nitaj, and Tajjeeddine Rachidi, pages 185–206. Springer, Heidelberg, April 2016.
- **Mer88**: Ralph C. Merkle. "A digital signature based on a conventional encryption function." In *CRYPTO'87*, volume 293 of LNCS, edited by Carl Pomerance, pages 369–378. Springer, Heidelberg, August 1988.
- **Mic94**: Silvio Micali. "CS proofs (extended abstracts)." In *35th FOCS*, pages 436–453. IEEE Computer Society Press, November 1994.
- **Mic00**: Silvio Micali. "Computationally sound proofs." *SIAM Journal on Computing*, 30(4):1253–1298, 2000.
- **NY90**: Moni Naor and Moti Yung. "Public-key cryptosystems provably secure against chosen ciphertext attacks." In *22nd ACM STOC*, pages 427–437. ACM Press, May 1990.
- **Par15**: Bryan Parno. "A note on the unsoundness of vnTinyRAM’s SNARK." *Cryptology ePrint Archive*, Report 2015/437, 2015. [http://eprint.iacr.org/2015/437](http://eprint.iacr.org/2015/437).
- **Ped92**: Torben P. Pedersen. "Non-interactive and information-theoretic secure verifiable secret sharing." In *CRYPTO'91*, volume 576 of LNCS, edited by Joan Feigenbaum, pages 129–140. Springer, Heidelberg, August 1992.
- **PHGR13**: Bryan Parno, Jon Howell, Craig Gentry, and Mariana Raykova. "Pinocchio: Nearly practical verifiable computation." In *2013 IEEE Symposium on Security and Privacy*, pages 238–252. IEEE Computer Society Press, May 2013.
- **Rot09**: Guy Rothblum. "Delegating computation reliably: paradigms and constructions." PhD thesis, 2009.
- **RRR16**: Omer Reingold, Guy N. Rothblum, and Ron D. Rothblum. "Constant-round interactive proofs for delegating computation." In *48th ACM STOC*, edited by Daniel Wichs and Yishay Mansour, pages 49–62. ACM Press, June 2016.
- **Sch91**: Claus-Peter Schnorr. "Efficient signature generation by smart cards." *Journal of Cryptology*, 4(3):161–174, January 1991.
- **Tha13**: Justin Thaler. "Time-optimal interactive proofs for circuit evaluation." In *CRYPTO 2013, Part II*, volume 8043 of LNCS, edited by Ran Canetti and Juan A. Garay, pages 71–89. Springer, Heidelberg, August 2013.
- **Val76**: Leslie G. Valiant. "Universal circuits (preliminary report)." In *STOC*, pages 196–203. ACM, 1976.
- **Vee17**: Meilof Veeningen. "Pinocchio-based adaptive zk-SNARKs and secure/correct adaptive function evaluation." In *AFRICACRYPT 17*, volume 10239 of LNCS, edited by Marc Joye and Abderrahmane Nitaj, pages 21–39. Springer, Heidelberg, May 2017.
- **WJB+17**: Riad S. Wahby, Ye Ji, Andrew J. Blumberg, abhi shelat, Justin Thaler, Michael Walfish, and Thomas Wies. "Full accounting for verifiable outsourcing." In *ACM CCS 2017*, edited by Bhavani M. Thuraisingham, David Evans, Tal Malkin, and Dongyan Xu, pages 2071–2086. ACM Press, October / November 2017.
- **WSR+15**: Riad S. Wahby, Srinath T. V. Setty, Zuocheng Ren, Andrew J. Blumberg, and Michael Walfish. "Efficient RAM and control flow in verifiable outsourced computation." In *NDSS 2015*. The Internet Society, February 2015.
- **WTas+17**: Riad S. Wahby, Ioanna Tzialla, abhi shelat, Justin Thaler, and Michael Walfish. "Doubly-efficient zkSNARKs without trusted setup." *Cryptology ePrint Archive*, Report 2017/1132, 2017. [https://eprint.iacr.org/2017/1132](https://eprint.iacr.org/2017/1132).
- **WTs+18**: Riad S. Wahby, Ioanna Tzialla, abhi shelat, Justin Thaler, and Michael Walfish. "Doubly-efficient zk-SNARKs without trusted setup." In *2018 IEEE Symposium on Security and Privacy*, pages 926–943. IEEE Computer Society Press, May 2018.
- **ZGK+17a**: Yupeng Zhang, Daniel Genkin, Jonathan Katz, Dimitrios Papadopoulos, and Charalampos Papamanthou. "vSQL: Verifying arbitrary SQL queries over dynamic outsourced databases." In *2017 IEEE Symposium on Security and Privacy*, pages 863–880. IEEE Computer Society Press, May 2017.
- **ZGK+17b**: Yupeng Zhang, Daniel Genkin, Jonathan Katz, Dimitrios Papadopoulos, and Charalampos Papamanthou. "A zero-knowledge version of vSQL." *Cryptology ePrint Archive*, Report 2017/1146, 2017. [https://eprint.iacr.org/2017/1146](https://eprint.iacr.org/2017/1146).

### A. Security Proof of CP-SNARK Composition

In this section, we provide a proof of Theorem 3.1. We first define relation generators and auxiliary input generators for this construction.

#### Auxiliary Input Generators
- **AuxRG(1λ)**:
  - \((R_0, \text{aux}(0)_R) \leftarrow \text{RG}_0(1^\lambda)\)
  - \((R_1, \text{aux}(1)_R) \leftarrow \text{RG}_1(1^\lambda)\)
  - Return \((R_b, \text{aux}(b)_R)_{b \in \{0,1\}}\)

- **AuxZ(ck, (crs_b, R_b, \text{aux}(b)_R)_{b \in \{0,1\}})**:
  - \(\text{aux}(0)_Z \leftarrow Z_0(ck, R_0, crs_0, \text{aux}(0)_R)\)
  - \(\text{aux}(1)_Z \leftarrow Z_1(ck, R_1, crs_1, \text{aux}(1)_R)\)
  - Return \((\text{aux}(b)_Z)_{b \in \{0,1\}}\)

- **RG^*(1λ)**:
  - \((R_b, \text{aux}(b)_R)_{b \in \{0,1\}} \leftarrow \text{AuxRG}(1^\lambda)\)
  - Return \((R_{R_0, R_1}, (ek^*, vk^*), (\text{aux}_R, \text{aux}'_R))\)

- **Z^*((ck, R \land_{R_0, R_1}), (crs_b, R_b, \text{aux}(b)_R)_{b \in \{0,1\}})**:
  - \((\text{aux}(b)_Z)_{b \in \{0,1\}} \leftarrow \text{AuxZ}(ck, (crs_b, R_b, \text{aux}(b)_R)_{b \in \{0,1\}})\)
  - Return \((\text{aux}(b)_Z)_{b \in \{0,1\}}\)

#### Lemma A.1
If Com is computationally binding, and if \(CP_b\) is KSND(\(RG_b, Z_b\)) (where \(RG_b, Z_b\) are defined in terms of \(RG_b, Z_b\) in Figure 10) for \(b \in \{0, 1\}\), then the scheme \(CP \land\) in Figure 1 is KSND(\(RG^*, Z^*\)) where \(RG^*, Z^*\) are as defined in Figure 10.

Let \(A^*\) be an adversary against the soundness of \(CP \land\) with respect to \(RG^*\) and \(Z^*\). For \(b \in \{0, 1\}\), consider adversary \(A_b\) (defined in Figure 11) against \(CP_b\) with respect to \(RG_b\) and \(Z_b\). By the fact that \(CP_b\) is KSND(\(RG_b, Z_b\)), there exists an extractor \(E_b\) such that \(\Pr[\text{GameKSNDRG}_b, Z_b, A_b, E_b = 1]\) is negligible.

We define an extractor \(E^*\) for \(CP \land\) in Figure 11, and we claim that \(\Pr[\text{GameKSNDRG}^*, Z^*, A^*, E^* = 1]\) is negligible.

First, observe that with overwhelming probability, the values \(u_2\) and \(u'_2\) in \(E^*\) are equal, conditioned on the openings being correct for their respective commitments (i.e., conditioned to \(\text{VerCommit}\) returning 1 on each of them). If it were otherwise, we could break the binding of Com (as done in the proof of Theorem B.1).

We now define the following notations:
- \(\text{GdCom}(c_b, u_b, o_b) := \text{Com.VerCommit}(ck, c_b, u_b, o_b) = 1\)
- \(\text{GdCom}(c_2, u_2, o_2) := \text{Com.VerCommit}(ck, c_2, u_2, o_2) = 1\)
- \(\text{GdCom}(c_2, u'_2, o'_2) := \text{Com.VerCommit}(ck, c_2, u'_2, o'_2) = 1\)

For \(b \in \{0, 1\}\), by the soundness properties of \(CP_b\) and the definition of \(E_b, E^*\), we have that \(p_b\), as defined below, is negligible:
\[ p_b := \Pr[b(b) \text{ ok} \land (\neg \text{GdCom}(c_b, u_b, o_b) \lor \neg \text{GdCom}(c_2, u_2, o_2) \lor R_b(x_b, u_b, u_2, \omega_b) = 0)] \]

Now, we can observe that:
\[ \Pr[\text{GameKSNDRG}^*, Z^*, A^*, E^* = 1] \leq \Pr[b(0) \text{ ok} \land (\neg \text{GdCom}(c_0, u_0, o_0) \lor \neg \text{GdCom}(c_2, u_2, o_2) \lor R_0(u_0, u_2, \omega_0) = 0)] + \]
\[ \Pr[b(1) \text{ ok} \land (\neg \text{GdCom}(c_1, u_1, o_1) \lor \neg \text{GdCom}(c_2, u'_2, o'_2) \lor R_1(u_1, u'_2, \omega_1) = 0)] + \text{negl}(\lambda) \]
\[ \leq p_0 + p_1 + \text{negl}(\lambda) \leq \text{negl}(\lambda) \]

where in the last two inequalities, we used our earlier observations on the openings of \(u_2\) and \(u'_2\) being negligible respectively, and \(p_0\) and \(p_1\) being negligible.

### Adversary Definitions
- **A_b(ck, (crs_b, R_b), \text{aux}(b)_R, \text{aux}(b)_Z)**:
  - Parse \(\text{aux}(b)_R\) as \((R_{1-b}, (\text{aux}(b)_R)_{b \in \{0,1\}})\)
  - Parse \(\text{aux}(b)_Z\) as \((crs_{1-b}, (\text{aux}(b)_R)_{b \in \{0,1\}})\)
  - \((x_0, x_1, (c_j)_{j \in [3]}, \pi) \leftarrow A^*(ck, (crs_0, crs_1, R_{R_0, R_1}), \text{aux}_R, \text{aux}'_R)\)

This completes the proof.