### Pipeline and Command Execution
If the command is the last in the pipeline, ...

### Windows Forensics
#### Evidence Collection Order of Volatility (RFC3227)
1. **Registers, Cache**
2. **Routing Table, ARP Cache, Process Table, Kernel Statistics, Memory**
3. **Temporary File Systems**
4. **Disk**
5. **Remote Logging and Monitoring Data** (relevant to the system in question)
6. **Physical Configuration, Network Topology**
7. **Archival Media**

#### Blue Team/DFIR Tools
- **Microsoft Attack Surface Analyzer**
  - **Description**: A Microsoft-developed open-source security tool that analyzes the attack surface of a target system and reports on potential security vulnerabilities introduced during software installation or system misconfiguration.
  - **Link**: [GitHub Repository](https://github.com/microsoft/attacksurfaceanalyzer)

- **GRR Rapid Response**
  - **Description**: An incident response framework focused on remote live forensics. GRR consists of a Python client (agent) installed on target systems and a Python server infrastructure to manage and communicate with clients.
  - **Link**: [GitHub Repository](https://github.com/google/grr)

### Windows Artifacts
- **USB Access**
  - **Timeline of USB Device Access**:
    - **Registry Key**: `HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR`
      - **Class ID / Serial Number**
      - **VID / PID**: `HKLM\SYSTEM\CurrentControlSet\Enum\USB`
      - **Friendly Name**: Obtain the Volume Name of the USB device using the Serial Number.
    - **Drive Letter and Volume GUID**:
      - **Registry Key**: `HKLM\SOFTWARE\Microsoft\Windows Portable Devices\Devices`
      - **Volume Serial Number**: `HKLM\SYSTEM\MountedDevices` (only present if the system drive is not an SSD).
      - **User Who Mounted the USB Device**: `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\EMDMgmt`
    - **USB Times**:
      - **First Time Connected**: `0064`
      - **Last Time Connected**: `0066`
      - **Last Removal Time**: `0067`
    - **Log Files**:
      - **XP**: `C:\Windows\setupapi.log`
      - **Vista+**: `C:\Windows\inf\setupapi.dev.log`

- **Prefetch**
  - **Description**: Stores/caches code pages from the last applications run into `.pf` files to help apps launch quicker in the future.
  - **Default Directory**: `C:\Windows\Prefetch`
  - **File Structure**: `(exename)-(8char_hash).pf`
  - **Example File**: `AUDIODG.EXE-B0D3A458.pf`
  - **Registry Configuration**:
    - **Key**: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters`
    - **EnablePrefetcher Value**:
      - `0 = Disabled`
      - `1 = Application launch prefetching enabled`
      - `2 = Boot prefetching enabled`
      - `3 = Applaunch and Boot enabled`

- **PowerShell History**
  - **Default File Location**: `$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt`
  - **Disable History**:
    - `SaveNothing`
    - `MaximumHistoryCount 0`

- **Jump Lists**
  - **Time of Execution of an Application or Recently Used Files**:
    - **Default Directories**:
      - `C:\%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations`
      - `C:\%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations`
    - **Jump List AppIDs**: [AppIDs List](https://raw.githubusercontent.com/EricZimmerman/JumpList/master/JumpList/Resources/AppIDs.txt)

- **Email Attachments**
  - **Local Saved Copies of Email Attachments**:
    - **Outlook Default Directory**: `C:\%USERPROFILE%\AppData\Local\Microsoft\Outlook`
    - **Thunderbird Default Directory**: `C:\%USERPROFILE%\AppData\Roaming\Thunderbird\Profiles\`

- **Browser Data**
  - **Metadata/Artifacts/History for Each Local User Account**:
    - **Internet Explorer 8-9**:
      - `C:\%USERPROFILE%\AppData\Roaming\Microsoft\Windows\IEDownloadHistory\index.dat`
    - **Internet Explorer 10-11**:
      - `C:\%USERPROFILE%\AppData\Local\Microsoft\Windows\WebCache\WebCacheV##.dat`
    - **Microsoft Edge**:
      - `C:\%USERPROFILE%\AppData\Local\Packages\Microsoft.MicrosoftEdge_xxxxx\AC\MicrosoftEdge\User\Default\DataStore\Data\\xxxxx\DBStore\spartan.edb`
      - `C:\%USERPROFILE%\AppData\Local\Packages\Microsoft.MicrosoftEdge_xxxx\AC\#!001\MicrosoftEdge\Cache\`
      - `C:\%USERPROFILE%\AppData\Local\Packages\Microsoft.MicrosoftEdge_xxxx\AC\MicrosoftEdge\User\Default\Recovery\Active\`
    - **Firefox v3-25**:
      - `C:\%USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\.default\downloads.sqlite`
    - **Firefox v26+**:
      - `C:\%USERPROFILE%\AppData\Roaming\Mozilla\Firefox\Profiles\.default\places.sqlite`
      - **Table**: `moz_annos`
    - **Chrome**:
      - `C:\%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\History`
    - **ESE Databases**: Can be viewed using tools like EseDbViewer, ESEDatabaseView, or esedbexport.

- **Image Thumbnail Cache**
  - **Images, Office Documents, and Directories/Folders**:
    - **Default Directory**: `C:\%USERPROFILE%\AppData\Local\Microsoft\Windows\Explorer\thumbcache_*.db`

### Windows Security Log Events
- **Event ID Categories**:
  - **Logon**: 4611, 4624, 4648, 4776, 4778
  - **Logoff**: 4643, 4779
  - **Privilege Usage**: 4672, 4673, 4674, 4703, 4768, 4769, 4771
  - **Process Executed**: 4688
  - **Process Terminated**: 4689
  - **Filtering Platform**: 5156
  - **Account Management**: 4720, 4722, 4724, 4726, 4728, 4737, 4738
  - **Policy Change**: 4670, 4904, 4905, 4946, 4947
  - **File Sharing**: 5140, 5142, 5144, 5145
  - **Handles**: 4656, 4658, 4659, 4660, 4661, 4663, 4690
  - **VSS**: 8222
  - **System**: 7036, 7040, 7045
  - **Application**: 102, 103, 105, 216, 300, 302, 2001, 2003, 2005, 2006
  - **Logs Cleared**: 104

- **Event ID Descriptions**:
  - **1100**: The event logging service has shut down.
  - **1101**: Audit events have been dropped by the transport.
  - **1102**: The audit log was cleared.
  - **1104**: The security log is now full.
  - **1105**: Event log automatic backup.
  - **1108**: The event logging service encountered an error.
  - **4608**: Windows is starting up.
  - **4609**: Windows is shutting down.
  - **4610**: An authentication package has been loaded by the Local Security Authority.
  - **4611**: A trusted logon process has been registered with the Local Security Authority.
  - **4612**: Internal resources allocated for the queuing of audit messages have been exhausted, leading to the loss of some audits.
  - **4614**: A notification package has been loaded by the Security Account Manager.
  - **4615**: Invalid use of LPC port.
  - **4616**: The system time was changed.
  - **4618**: A monitored security event pattern has occurred.
  - **4621**: Administrator recovered system from CrashOnAuditFail.
  - **4622**: A security package has been loaded by the Local Security Authority.
  - **4624**: An account was successfully logged on.
  - **4625**: An account failed to log on.
  - **4626**: User/Device claims information.
  - **4627**: Group membership information.
  - **4634**: An account was logged off.
  - **4646**: IKE DoS-prevention mode started.
  - **4647**: User initiated logoff.
  - **4648**: A logon was attempted using explicit credentials.
  - **4649**: A replay attack was detected.
  - **4650**: An IPsec Main Mode security association was established.
  - **4651**: An IPsec Main Mode security association was established.
  - **4652**: An IPsec Main Mode negotiation failed.
  - **4653**: An IPsec Main Mode negotiation failed.
  - **4654**: An IPsec Quick Mode negotiation failed.
  - **4655**: An IPsec Main Mode security association ended.
  - **4656**: A handle to an object was requested.
  - **4657**: A registry value was modified.
  - **4658**: The handle to an object was closed.
  - **4659**: A handle to an object was requested with intent to delete.
  - **4660**: An object was deleted.
  - **4661**: A handle to an object was requested.
  - **4662**: An operation was performed on an object.
  - **4663**: An attempt was made to access an object.
  - **4664**: An attempt was made to create a hard link.
  - **4665**: An attempt was made to create an application client context.
  - **4666**: An application attempted an operation.
  - **4667**: An application client context was deleted.
  - **4668**: An application was initialized.
  - **4670**: Permissions on an object were changed.
  - **4671**: An application attempted to access a blocked ordinal through the TBS.
  - **4672**: Special privileges assigned to new logon.
  - **4673**: A privileged service was called.
  - **4674**: An operation was attempted on a privileged object.
  - **4675**: SIDs were filtered.
  - **4688**: A new process has been created.
  - **4689**: A process has exited.
  - **4690**: An attempt was made to duplicate a handle to an object.
  - **4691**: Indirect access to an object was requested.
  - **4692**: Backup of data protection master key was attempted.
  - **4693**: Recovery of data protection master key was attempted.
  - **4694**: Protection of auditable protected data was attempted.
  - **4695**: Unprotection of auditable protected data was attempted.
  - **4696**: A primary token was assigned to process.
  - **4697**: A service was installed in the system.
  - **4698**: A scheduled task was created.
  - **4699**: A scheduled task was deleted.
  - **4700**: A scheduled task was enabled.
  - **4701**: A scheduled task was disabled.
  - **4702**: A scheduled task was updated.
  - **4703**: A token right was adjusted.
  - **4704**: A user right was assigned.
  - **4705**: A user right was removed.
  - **4706**: A new trust was created to a domain.
  - **4707**: A trust to a domain was removed.
  - **4709**: IPsec Services was started.
  - **4710**: IPsec Services was disabled.
  - **4711**: PAStore Engine (1%).
  - **4712**: IPsec Services encountered a potentially serious failure.
  - **4713**: Kerberos policy was changed.
  - **4714**: Encrypted data recovery policy was changed.
  - **4715**: The audit policy (SACL) on an object was changed.
  - **4716**: Trusted domain information was modified.
  - **4717**: System security access was granted to an account.
  - **4718**: System security access was removed from an account.
  - **4719**: System audit policy was changed.
  - **4720**: A user account was created.
  - **4722**: A user account was enabled.
  - **4723**: An attempt was made to change an account's password.
  - **4724**: An attempt was made to reset an account's password.
  - **4725**: A user account was disabled.
  - **4726**: A user account was deleted.
  - **4727**: A security-enabled global group was created.
  - **4728**: A member was added to a security-enabled global group.
  - **4729**: A member was removed from a security-enabled global group.
  - **4730**: A security-enabled global group was deleted.
  - **4731**: A security-enabled local group was created.
  - **4732**: A member was added to a security-enabled local group.
  - **4733**: A member was removed from a security-enabled local group.
  - **4734**: A security-enabled local group was deleted.
  - **4735**: A security-enabled local group was changed.
  - **4737**: A security-enabled global group was changed.
  - **4738**: A user account was changed.
  - **4739**: Domain Policy was changed.
  - **4740**: A user account was locked out.
  - **4741**: A computer account was created.
  - **4742**: A computer account was changed.
  - **4743**: A computer account was deleted.
  - **4744**: A security-disabled local group was created.
  - **4745**: A security-disabled local group was changed.
  - **4746**: A member was added to a security-disabled local group.
  - **4747**: A member was removed from a security-disabled local group.
  - **4748**: A security-disabled local group was deleted.
  - **4749**: A security-disabled global group was created.
  - **4750**: A security-disabled global group was changed.
  - **4751**: A member was added to a security-disabled global group.
  - **4752**: A member was removed from a security-disabled global group.
  - **4753**: A security-disabled global group was deleted.
  - **4754**: A security-enabled universal group was created.
  - **4755**: A security-enabled universal group was changed.
  - **4756**: A member was added to a security-enabled universal group.
  - **4757**: A member was removed from a security-enabled universal group.
  - **4758**: A security-enabled universal group was deleted.
  - **4759**: A security-disabled universal group was created.
  - **4760**: A security-disabled universal group was changed.
  - **4761**: A member was added to a security-disabled universal group.
  - **4762**: A member was removed from a security-disabled universal group.
  - **4763**: A security-disabled universal group was deleted.
  - **4764**: A group's type was changed.
  - **4765**: SID History was added to an account.
  - **4766**: An attempt to add SID History to an account failed.
  - **4767**: A user account was unlocked.
  - **4768**: A Kerberos authentication ticket (TGT) was requested.
  - **4769**: A Kerberos service ticket was requested.
  - **4770**: A Kerberos service ticket was renewed.
  - **4771**: Kerberos pre-authentication failed.
  - **4772**: A Kerberos authentication ticket request failed.
  - **4773**: A Kerberos service ticket request failed.
  - **4774**: An account was mapped for logon.
  - **4775**: An account could not be mapped for logon.
  - **4776**: The domain controller attempted to validate the credentials for an account.
  - **4777**: The domain controller failed to validate the credentials for an account.
  - **4778**: A session was reconnected to a Window Station.
  - **4779**: A session was disconnected from a Window Station.
  - **4780**: The ACL was set on accounts which are members of administrators groups.
  - **4781**: The name of an account was changed.
  - **4782**: The password hash of an account was accessed.
  - **4783**: A basic application group was created.
  - **4784**: A basic application group was changed.
  - **4785**: A member was added to a basic application group.
  - **4786**: A member was removed from a basic application group.
  - **4787**: A non-member was added to a basic application group.
  - **4788**: A non-member was removed from a basic application group.
  - **4789**: A basic application group was deleted.
  - **4790**: An LDAP query group was created.
  - **4791**: A basic application group was changed.
  - **4792**: An LDAP query group was deleted.
  - **4793**: The Password Policy Checking API was called.
  - **4794**: An attempt was made to set the Directory Services Restore Mode administrator password.
  - **4797**: An attempt was made to query the existence of a blank password for an account.
  - **4798**: A user's local group membership was enumerated.
  - **4799**: A security-enabled local group membership was enumerated.
  - **4800**: The workstation was locked.
  - **4801**: The workstation was unlocked.
  - **4802**: The screen saver was invoked.
  - **4803**: The screen saver was dismissed.
  - **4816**: RPC detected an integrity violation while decrypting an incoming message.
  - **4817**: Auditing settings on object were changed.
  - **4818**: Proposed Central Access Policy does not grant the same access permissions as the current Central Access Policy.
  - **4819**: Central Access Policies on the machine have been changed.
  - **4820**: A Kerberos Ticket-granting-ticket (TGT) was denied because the device does not meet the access control restrictions.
  - **4821**: A Kerberos service ticket was denied because the user, device, or both do not meet the access control restrictions.
  - **4822**: NTLM authentication failed because the account was a member of the Protected User group.
  - **4823**: NTLM authentication failed because access control restrictions are required.
  - **4824**: Kerberos preauthentication by using DES or RC4 failed because the account was a member of the Protected User group.
  - **4825**: A user was denied access to Remote Desktop. By default, users are allowed to connect only if they are members of the Remote Desktop Users group or Administrators group.
  - **4826**: Boot Configuration Data loaded.
  - **4830**: SID History was removed from an account.
  - **4864**: A namespace collision was detected.
  - **4865**: A trusted forest information entry was added.
  - **4866**: A trusted forest information entry was removed.
  - **4867**: A trusted forest information entry was modified.
  - **4868**: The certificate manager denied a pending certificate request.
  - **4869**: Certificate Services received a resubmitted certificate request.
  - **4870**: Certificate Services revoked a certificate.
  - **4871**: Certificate Services received a request to publish the certificate revocation list (CRL).
  - **4872**: Certificate Services published the certificate revocation list (CRL).
  - **4873**: A certificate request extension changed.
  - **4874**: One or more certificate request attributes changed.
  - **4875**: Certificate Services received a request to shut down.
  - **4876**: Certificate Services backup started.
  - **4877**: Certificate Services backup completed.
  - **4878**: Certificate Services restore started.
  - **4879**: Certificate Services restore completed.
  - **4880**: Certificate Services started.
  - **4881**: Certificate Services stopped.
  - **4882**: The security permissions for Certificate Services changed.
  - **4883**: Certificate Services retrieved an archived key.
  - **4884**: Certificate Services imported a certificate into its database.
  - **4885**: The audit filter for Certificate Services changed.
  - **4886**: Certificate Services received a certificate request.
  - **4887**: Certificate Services approved a certificate request and issued a certificate.
  - **4888**: Certificate Services denied a certificate request.
  - **4889**: Certificate Services set the status of a certificate request to pending.
  - **4890**: The certificate manager settings for Certificate Services changed.
  - **4891**: A configuration entry changed in Certificate Services.
  - **4892**: A property of Certificate Services changed.
  - **4893**: Certificate Services archived a key.
  - **4894**: Certificate Services imported and archived a key.