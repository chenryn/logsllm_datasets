### Optimized Text

#### Sensor Output and Switch Control
The microcontroller can read the sensor output. When the microcontroller "turns off" the sensor, a switch disconnects the Analog-to-Digital Converter (ADC) from the sensor output. As shown in Figure 14, a switch controlled by the microcontroller is added between the sensor output and the ADC.

When the ADC is disconnected from the sensor output, it is essential to ensure that the ADC inputs settle at a specific level. This is achieved by connecting the ADC to a reference voltage. The switch must be installed very close to the sensor output to prevent the wire between the switch and the ADC from acting as an unintentional antenna. If this wire is too long, it may function as an unintended antenna, serving as an injection point for attacking signals. When the ADC is disconnected from the sensor output, the readings of the ADC will not be influenced by the attacking signal. Consequently, zero samples will not be affected by the attacking signal, and no attack will be detected.

#### Difference Between PyCRA and Our Approach
Shoukry et al. [26] proposed a generalizable sensor spoofing detection method called PyCRA, which is applicable to sensors such as ultrasonic and infrared sensors, which consist of emitters and receivers. In these systems, the emitter sends a challenge signal to the measured entity, and the receiver gathers information from the reflected signal. In a spoofing attack, an attacker manipulates the reflected signal. To detect such attacks, PyCRA randomly turns off the emitter. During the emitter's shutdown, the receiver should receive no signal; if a reflected signal is received when the emitter is off, an attack is detected.

Our approach differs from PyCRA in several aspects:
- **Applicability**: Our approach works for both powered and non-powered passive sensors, as well as active sensors. Since powered and non-powered passive sensors are essentially receivers of active sensors, our method is applicable to all three types of sensors defined in Section III. In contrast, PyCRA is designed only for active sensors, as it requires an emitter.
- **Security Mechanism**: PyCRA relies on the secrecy of the timing of voltage level changes in the challenge signal. However, researchers [25] have shown that PyCRA can be bypassed if the attacker has a faster sampling rate than the sensor system. In such a scenario, the attacker can quickly stop generating attacking signals when the challenge signal starts falling, thus avoiding detection. Our approach, however, allows the attacker to have full information about the timing, but still requires the attacker to guess whether the sensor is on or off. A wrong guess will expose the attacker to the sensor system.
- **Threat Model**: In our approach, the attacker can remain at a distance from the sensor system, using Electromagnetic Interference (EMI) to remotely interfere with the sensor readings. In PyCRA, the attacker must be in close proximity to the sensor system and the measured entity to capture the challenge signal and produce a malicious reflected signal. Therefore, our approach addresses a stronger threat model.
- **Detection Principle**: Our method detects attacks by examining both non-zero and zero samples, while PyCRA monitors attacking signals by checking zero samples only. Thus, PyCRA cannot recognize attacks affecting non-zero samples.

#### Related Work
Recent defense methods against low-power EMI attacks can be categorized into hardware, software, and hybrid methods.

- **Hardware Methods**: These methods use specific materials or electronic components to mitigate attacking signals. Common strategies include shielding, differential comparators, and filters. Shielding uses specific materials to dampen received electromagnetic radiation, and it is recommended in previous studies [14], [16], [20]. Differential comparators can remove common mode interference, and low-pass filters can attenuate high-frequency attacking signals. However, parasitics in surface mount components can convert low-pass filters into band-stop filters, allowing attacking signals to pass. An alternative is using an EMI filter, though these methods do not provide detection capabilities.
- **Software Methods**: These methods detect or attenuate attacking signals by examining measurements at a software level. The microcontroller, knowing the measurement model, can identify anomalies that may indicate the presence of an attacking signal.
- **Hybrid Methods**: These combine hardware and software methods. For example, a specialized component in the victim device can capture the attacking signal, which is then input into an adaptive noise canceling system. Additionally, the microcontroller in a cardiac implantable electrical device (CIED) can use its direct connection to the cardiac tissue to discern between a measured signal and an induced signal [16]. Fujimoto et al. [6] proposed a detection method for cryptographic integrated circuits by monitoring built-in voltage variations using an on-chip voltmeter. While these hybrid methods are effective, they are often application-specific and not universally applicable. Our approach, designed for sensor systems, can be quickly deployed to various sensor systems.

#### Conclusion
In this paper, we propose a novel method to detect EMI attacks for sensor systems. Our detection method involves turning off the sensor to monitor the attacking signal in the sensor output. Once the microcontroller detects an attacking signal, it rejects further processing of the sensor output. Compared to other detection methods, our approach is low-cost, space-saving, and can be rapidly deployed.

Regarding security, we have proven that our detection method can be bypassed with negligible probability. The security of the sensor system is based on the n-bit secret sequence being unknown to the attacker. The longer the secret sequence, the more secure the system. Our method can guarantee security even with a small n.

In practice, we have deployed our detection method to a microphone system and a temperature sensor system. High true-positive rates demonstrate the effectiveness and robustness of our method in detecting attacking signals.

#### Acknowledgments
This work was supported in part by the China Scholarship Council – University of Oxford Scholarships.

#### References
[1] C. Adami, C. Braun, P. Clemens, M. Joester, S. Ruge, M. Suhrke, H. Schmidt, and H. Taenzer, “HPM detector system with frequency identification,” in 2014 International Symposium on Electromagnetic Compatibility (EMC Europe). IEEE, 2014, pp. 140–145.
[2] C. Adami, C. Braun, P. Clemens, M. Suhrke, H. Schmidt, and A. Taenzer, “HPM detection system for mobile and stationary use,” in EMC Europe 2011 York. IEEE, 2011, pp. 1–6.
[3] Manchester Coding Basics, Atmel Corporation, 2325 Orchard Parkway, San Jose, CA 95131, USA, sep 2009.
[4] C. E. Baum and D. McLemore, “Damping Transmission-Line and Cavity Resonances,” Interaction Note, vol. 503, pp. 239–244, 1994.
[5] J. Benesty, J. Chen, and Y. Huang, “On the importance of the Pearson correlation coefficient in noise reduction,” IEEE Transactions on Audio, Speech, and Language Processing, vol. 16, no. 4, pp. 757–765, 2008.
[6] D. Fujimoto, Y.-i. Hayashi, A. Beckers, J. Balasch, B. Gierlichs, and I. Verbauwhede, “Detection of IEMI fault injection using voltage monitor constructed with fully digital circuit,” in 2018 IEEE International Symposium on Electromagnetic Compatibility and 2018 IEEE Asia-Pacific Symposium on Electromagnetic Compatibility (EMC/APEMC). IEEE, 2018, pp. 753–755.
[7] J. Gago, J. Balcells, D. Gonz ´Alez, M. Lamich, J. Mon, and A. Santolaria, “EMI susceptibility model of signal conditioning circuits based on operational amplifiers,” IEEE Transactions on Electromagnetic Compatibility, vol. 49, no. 4, pp. 849–859, 2007.
[8] H. Ghadamabadi, J. J. Whalen, R. Coslick, C. Hung, T. Johnson, W. Sitzman, and J. Stevens, “Comparison of demodulation RFI in inverting operational amplifier circuits of the same gain with different input and feedback resistor values,” in 1990 IEEE International Symposium on Electromagnetic Compatibility. IEEE, 1990, pp. 145–152.
[9] I. Giechaskiel and K. B. Rasmussen, “Taxonomy and challenges of out-of-band signal injection attacks and defenses,” arXiv preprint arXiv:1901.06935, 2019.
[10] I. Giechaskiel, Y. Zhang, and K. B. Rasmussen, “A framework for evaluating security in the presence of signal injection attacks,” arXiv preprint arXiv:1901.03675, 2019.
[11] Y. Hayashi, N. Homma, T. Sugawara, T. Mizuki, T. Aoki, and H. Sone, “Non-invasive EMI-based fault injection attack against cryptographic modules,” in 2011 IEEE International Symposium on Electromagnetic Compatibility (EMC). IEEE, 2011, pp. 763–767.
[12] R. Hoad and I. Sutherland, “The forensic utility of detecting disruptive electromagnetic interference,” in ECIW2008-7th European Conference on Information Warfare and Security: ECIW2008. Academic Conferences Limited, 2008, p. 77.
[13] R. Hurley, Design Considerations for ESD/EMI Filters: II Low Pass Filters for Audio Filter Applications, ON Semiconductor, 2007.
[14] C. Kasmi and J. L. Esteves, “IEMI threats for information security: Remote command injection on modern smartphones,” IEEE Transactions on Electromagnetic Compatibility, vol. 57, no. 6, pp. 1752–1755, 2015.
[15] R. Krzikalla and J. Ter Haseborg, “HPEM protection on HF transmission lines,” Advances in Radio Science, vol. 2, no. E. 1, pp. 79–82, 2005.
[16] D. F. Kune, J. Backes, S. S. Clark, D. Kramer, M. Reynolds, K. Fu, Y. Kim, and W. Xu, “Ghost talk: Mitigating EMI signal injection attacks against analog sensors,” in 2013 IEEE Symposium on Security and Privacy (SP). IEEE, 2013, pp. 145–159.
[17] M. Mishali and Y. C. Eldar, “From theory to practice: Sub-Nyquist sampling of sparse wideband analog signals,” IEEE Journal of Selected Topics in Signal Processing, vol. 4, no. 2, pp. 375–391, 2010.
[18] T. A. Nappholz and R. Whigham, “EMI detection in an implantable pacemaker and the like,” Jun. 16 1998, US Patent 5,766,227.
[19] W. A. Radasky, C. E. Baum, and M. W. Wik, “Introduction to the special issue on high-power electromagnetics (HPEM) and intentional electromagnetic interference (IEMI),” IEEE Transactions on Electromagnetic Compatibility, vol. 46, no. 3, pp. 314–321, 2004.
[20] K. B. Rasmussen, C. Castelluccia, T. S. Heydt-Benjamin, and S. Capkun, “Proximity-based access control for implantable medical devices,” in Proceedings of the 16th ACM conference on Computer and communications security. ACM, 2009, pp. 410–419.
[21] N. Roy, H. Hassanieh, and R. Roy Choudhury, “Backdoor: Making microphones hear inaudible sounds,” in Proceedings of the 15th Annual International Conference on Mobile Systems, Applications, and Services. ACM, 2017, pp. 2–14.
[22] F. Sabath, “What can be learned from documented Intentional Electromagnetic Interference (IEMI) attacks?” in General Assembly and Scientific Symposium, 2011 XXXth URSI. IEEE, 2011, pp. 1–4.
[23] P. Sedgwick, “Pearson’s correlation coefficient,” Bmj, vol. 345, p. e4483, 2012.
[24] J. Selvaraj, G. Y. Dayanıklı, N. P. Gaunkar, D. Ware, R. M. Gerdes, M. Mina et al., “Electromagnetic Induction Attacks Against Embedded Systems,” in Proceedings of the 2018 on Asia Conference on Computer and Communications Security. ACM, 2018, pp. 499–510.
[25] H. Shin, Y. Son, Y. Park, Y. Kwon, and Y. Kim, “Sampling race: Bypassing timing-based analog active sensor spoofing detection on analog-digital systems,” in 10th USENIX Workshop on Offensive Technologies. USENIX, 2016.
[26] Y. Shoukry, P. Martin, Y. Yona, S. Diggavi, and M. Srivastava, “PyCRA: Physical challenge-response authentication for active sensors under spoofing attacks,” in Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security. ACM, 2015, pp. 1004–1015.
[27] T. Trippel, O. Weisse, W. Xu, P. Honeyman, and K. Fu, “WALNUT: Waging doubt on the integrity of MEMS accelerometers with acoustic injection attacks,” in 2017 IEEE European Symposium on Security and Privacy (EuroS&P). IEEE, 2017, pp. 3–18.
[28] D. J. Yonce and L. Babler, “EMI detection for implantable medical devices,” Jun. 12 2007, US Patent 7,231,251.
[29] X. Yuan, Y. Chen, Y. Zhao, Y. Long, X. Liu, K. Chen, S. Zhang, H. Huang, X. Wang, and C. A. Gunter, “CommanderSong: A Systematic Approach for Practical Adversarial Voice Recognition,” arXiv preprint arXiv:1801.08535, 2018.
[30] G. Zhang, C. Yan, X. Ji, T. Zhang, T. Zhang, and W. Xu, “DolphinAttack: Inaudible voice commands,” in Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security. ACM, 2017, pp. 103–117.