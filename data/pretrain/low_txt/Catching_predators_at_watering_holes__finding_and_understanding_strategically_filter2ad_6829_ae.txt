### The Second Watering Hole Attack on RSF-chinese.org: A Politically Motivated Campaign

The first watering hole attack on RSF-chinese.org occurred in 2012. This politically motivated campaign intensified during the 2014 Hong Kong protests, a series of sit-in protests involving mass civil disobedience. As a result, numerous political and media websites became prime targets of watering hole attacks in late 2014. Consequently, we added these sites to our monitoring list, as described in Section 3.2.

#### Discovery of New Watering Holes

Our monitoring efforts proved fruitful, as we identified several strategically compromised websites. Starting with adpl.org.hk, a website for the Association for Democracy and People's Livelihood, we extracted its Indicators of Compromise (IoCs) and performed a recursive search within our dataset. This process enabled us to discover six new watering holes through URL patterns, malicious payload injection methods, and cookies, as shown in Figure 1.

#### Detailed Analysis of adpl.org.hk

In our dataset, adpl.org.hk was detected and confirmed to have been compromised twice. The first compromise appeared in 2014 and served a malicious payload from macanna.com.tw, which was also used to provide malicious payloads on archive.dphk.org, the site for the Democratic Party of Hong Kong. Additionally, the scripts used attempted to write the cookie `gougou=Somethinggggg`, which was also used in the compromise of hkba.org, the Hong Kong Bar Association site. In our discovered watering hole attacks, cookies were extensively used to track victims and avoid serving malicious payloads multiple times to evade detection, as strategically selected sites are frequently visited by the same users.

The second compromise on adpl.org.hk appeared in 2015, featuring a unique pattern of malicious payload injection. Iframes and script tags were inserted into the homepage between textual content and after certain keywords. This unique pattern, indicative of an automated injection tool and likely the same actor, allowed us to connect the compromises on hkba.org, youpai.org, and alliance.org.hk to adpl.org.hk. VirusTotal flagged VBScripts served from six different intermediaries, as shown in Table 7. The code exploited a vulnerability in Microsoft Internet Explorer, CVE-2014-6332, published just four days before the first compromise.

#### Exploitation of dphk.org and archive.dphk.org

The website of the Democratic Party of Hong Kong, dphk.org, and its members center, archive.dphk.org, exhibited ten different compromises. Some of these compromises, although having links and redirections to different malicious URLs, contained injected malicious code that was repeatedly replaced. This observation suggests that the attackers are updating their infections and rotating their redirections to different destinations. Two of these compromised sites served malicious payloads from intermediaries java-se.com and hotel365.co.kr, linking to other watering holes, procommons.org.hk and hkgolden.com. One of the compromises on archive.dphk.org lasted from 2012 until 2015, indicating a long-term, persistent attack.

#### Boxun.com and Peacehall.com: Politically Motivated Websites

Another group of politically motivated websites, boxun.com and peacehall.com, are currently blocked by the Chinese firewall. These sites cover political news and human rights abuses and allow anonymous article submissions. Their readers include government and non-government organizations seeking information about China. Boxun.com is ranked at 7K in China according to Alexa. We found that this site had been compromised early in 2012 and is still partially compromised, with many different attack payloads. Table 8 shows two of the compromises, associated with intermediaries kosdic.or.kr and bcbridges.org, both legitimate websites about government infrastructure projects that have been compromised to serve the watering hole campaign.

The infections on boxun.com related to these two sites differ. The one through kosdic.or.kr uses a vulnerability published in July 2008, and the first snapshot of the URL on kosdic.or.kr appeared in August 2008, one month after the vulnerability was announced. The compromise using bcbridges.org serves a script that attempts to fingerprint the visitor by finding her user agent, exact version of Shockwave, and checking the existence of AV systems. The earliest version of this script was found in June 2010. The same set of infections was discovered on peacehall.com, apparently from the same perpetrator. Interestingly, archived snapshots of boxun.com around the compromise period of 2012 show some clean web pages, indicating a possible but incomplete cleanup effort.

#### The ScanBox Framework

ScanBox is a framework widely used in watering hole attacks, first reported by AlienVault on August 28, 2014. Later, PWC revealed four attacks using the same framework, followed by 20 more. These campaigns targeted diverse sectors, including energy companies and think tanks. ScanBox primarily performs deep reconnaissance on its victims, sometimes including keylogging, and sends collected information back to a C&C center. At the reconnaissance stage, ScanBox conducts extensive fingerprinting activities, detecting the operating system, language, security systems, Flash version, and more. After the reconnaissance stage, ScanBox delivers malware to selected targets.

In our dataset, we detected six watering hole attacks using ScanBox, two of which (peoplepower.hk and cgdev.org) had been reported before, while the remaining four are new discoveries. Using the scripts collected from all six watering holes and other online sources, we performed an in-depth analysis of the generated HTTP requests and the scripts downloaded when crawling the snapshots and live sites using three user agents: IE, Firefox, and Chrome.

We found that ScanBox serves different scripts depending on the user agent, with each script tailored to different agents. For example, in the case of IE, the fingerprinting is extensive, attempting to identify many installed applications such as the latest Windows OS updates and a long list of well-known AV tools. The reconnaissance code served through Firefox checks for additional tools like Xunlei, a Chinese download manager. Keylogging is selectively carried out, with some scripts implementing but not executing the functionality (e.g., cgdev.org) while others log users' keystrokes (e.g., peoplepower.hk). Some scripts also attempt to download a fake exe file, possibly testing future delivery of malicious executables.

Although the collected reconnaissance scripts differ in some ways, they share functionalities, especially for certain user agents. We calculated the Jaccard similarity coefficients between different reconnaissance scripts based on the software tools shared among them and their functionalities. The results, shown in Figure 2, indicate that the scripts on peoplepower.hk and cgdev.org share many tools and functionalities, with differences mainly observed when Firefox is in use. For pomail.gov.mm, where the reconnaissance script was only found on Firefox, the code is exactly the same.

### Conclusion

These findings highlight that political websites are major targets of strategic compromises, often repeatedly exploited by politically motivated attackers. The less protected nature of these sites, run by volunteers or small teams, makes them vulnerable. Our research also indicates a weak cleanup effort by the site owners, with some web pages clean while others remain compromised. The use of near-zero-day vulnerabilities and sophisticated frameworks like ScanBox underscores the need for robust security measures and continuous monitoring.