### Figure 12: The Effect of Aggregation of Multiple Sources at Different Phases

In this experiment, we vary the phase from 1 to 200 ms, representing the difficulty for attackers to start and remain synchronized. If Hypothesis 3 is true, changes in the attacker's phase should cause a corresponding change in \( F(60\%) \). However, we observe that \( F(60\%) \) remains nearly constant even when aggregated with an attacker with a dissimilar phase. This demonstrates that phase alone (Hypothesis 3) does not cause the shift.

#### Testing Hypothesis 3 with Multiple Streams

To further test Hypothesis 3, we aggregate multiple streams, each slightly out of phase. We generate the shifted trace by:
\[ a_3b(t) = \sum_{i=2}^{n} a(t + i\phi) \]
where \( a(t) \) represents the packet arrival sequence in the original trace, and \( n \) is the number of attackers. We vary the number of attackers \( n \) from 2 to 15, with a 1 ms phase shift between each attacker.

If the hypothesis is true, we should observe a drop in \( F(60\%) \) as the number of attackers increases. Figure 12 plots the number of sources against \( F(60\%) \) using packet traces from both Figures 9(a) and 10(a). In both cases, we observe a drop in \( F(60\%) \) as the number of sources increases, indicating that phase along with the aggregation of multiple sources is most likely the cause of localization of power in the lower frequencies. This result is consistent with the attack traffic observed at Los Nettos and USC.

### Summary of Experiments

These experiments support our claims that:
1. High-rate single-source attacks have an inherently linear cumulative spectrum.
2. High-rate multi-source attacks cannot maintain this linearity; lower frequency components dominate due to the aggregation of multiple attackers starting out of phase.
3. Cross traffic can decrease the prominence of individual frequencies, but the cumulative spectrum is robust to its effects.

While these results apply to high-rate attackers, it is possible for attackers to affect their spectral characteristics by changing their attack rate. We examine this issue in the next section.

### Header Analysis Limitations

Although header analysis was successful at classifying 83% of the attacks we observed, this percentage may drop as more sophisticated tools become available. Currently, most attack tools neglect randomizing the ID field, but it is easy for attackers to spoof this field. Standard operating systems are also randomizing the ID field when the packet is not fragmented to discourage OS fingerprinting [12]. Further, it may be possible to synchronize ID values in low-volume attacks using out-of-band communication to make it appear monotonically increasing and evade correct classification [11].

The use of TTL is somewhat more robust (assuming stable routing), since attack packets with very low TTL values will fail to reach the victim. Statistical analysis of TTL values may be helpful in determining attacker distance despite spoofing. However, the usefulness of this approach is limited because a distance of a few hops quickly encompasses much of the Internet. We expect the evolution of attack tools to increase dependence on more advanced classification techniques based on spectral content.

### Initial Ramp-Up and Spectral Analysis

Even though none of the observed single-source attacks exhibit an initial ramp-up, it can be easily generated by an attacker that gradually increases the attack rate, emulating a multi-source attack and effectively triggering more complex response mechanisms. In large multi-source attacks, an initial ramp-up will be quite difficult to conceal. The duration of the ramp-up may vary based on the zombie clock skew and differences in the zombie-victim network distance, but masking the ramp-up by accounting for both sources of variability would require significant sophistication.

Spectral analysis is more robust to attacker manipulation than header analysis. We believe the characteristics of high-rate attack traffic are inherent and cannot be avoided by single- or multi-source attackers sending at maximum rate. It is not practical for a multi-source attacker to synchronize geographically distributed attackers to create spectral characteristics similar to single-source attacks. Achieving comparable levels of synchronization requires tight time synchronization between attacking hosts and accounting for the varying propagation and queuing delay between each attacker and the victim.

A single-source attacker can masquerade as a multi-source attack if it is willing to reduce its attack rate. A single-source can generate packets in bursty, on-off patterns by introducing a delay between packets and creating dominant low-frequency contents in its spectrum. Future work will investigate spectral analysis techniques based on uneven sampling that will be more robust to such attack patterns [27] and study the effect of packet loss and queuing on the attack spectra.

### Sensitivity of the 60% Quantile

Finally, we consider the sensitivity of the 60% quantile used in attack classification. Our technique is based on testing for localization of power in the lower frequency band (under 200 Hz). Any mid-range quantile can capture this characteristic of the trace; our selection of 60% is somewhat arbitrary. To verify this, we compared the classification of the attacks we captured and found comparable results for quantiles between 45â€“65%. However, at very low or high quantiles (less than 40% or more than 70%), many attacks are incorrectly classified because the measure becomes overly influenced by variance at either end of the spectra.

### Applications

Network security is an arms race, with both attack tools and defenses evolving in relation to each other. Our framework's robustness to improved attack tools is an important consideration. Our ramp-up and spectral analysis techniques were motivated by the limitations of header analysis in the face of packet spoofing.

There are several applications of our results, including automated attack detection, developing synthetic models of attack traffic, and inferring the amount of DoS attack activity in the Internet. While details of these applications are outside the scope of this paper, we briefly discuss each next.

#### 8.1 Automating Attack Detection

A robust automatic attack detection tool is useful in guiding response systems (both manual and automated) in installing filters [17, 25] or for use in aggregate congestion control for flash crowds [21]. Although we use simple filters for first-pass detection of an attack, the approaches we develop help classify attacks as from single or multiple sources. Discrimination between single and multi-source attacks is useful in selecting the appropriate response mechanism since some mechanisms are more expensive when dealing with multiple attackers compared to single attackers (for example, traceback [31]). We developed an automated tool that takes the attack trace and carries out spectral analysis to classify it. While this demonstrates the feasibility of such a tool, we have not yet integrated it with other detection systems. We are also exploring the possibility of developing attack profiles to identify similar attack scenarios consisting of the same attack tool and zombies used in repeated attacks.

#### 8.2 Modeling Attacks

Many simulation studies of DoS attack detection and response use fairly simple traffic models, such as constant bit-rate sources with fixed-size packets. Such models fail to capture the nuances of attack traffic. Although real attack tools are easy to obtain and can be used in a testbed, there remain questions about how to support large numbers of attack machines and how to configure a testbed to reproduce attacks similar to those in the wild. Clearly, to create more realistic synthetic DoS traffic both in simulation and testbeds, we need a better understanding of attack dynamics.

To our knowledge, there have been no published studies of detailed characterization or models of DoS attack traffic. Studies based on back-scatter observe attacks indirectly and thus do not capture fine-grained details of the attack dynamics [24]. Given the many modes of failure an attack can cause (such as hardware failures, exploitation of software glitches, misconfiguration), it is important to create faithful reproductions of real attacks. Although not the focus of this paper, we include some statistics about the kinds of attacks we see in the wild. Future work may use our tools as part of a broader study to better characterize DoS attacks, laying down the groundwork for the development of more realistic attack models.

#### 8.3 Inferring DoS Activity in the Internet

Using our detection tools, we captured 80 DoS attacks in Los Nettos over five months. If we consider these attacks to be a sample of DoS activity in the Internet as a whole, we can project attack activity to the public Internet. Such a projection should be considered extremely rough due to the small fraction of the Internet and the relatively few attacks we observed, and the assumptions required by such an estimation. However, we believe that the methodology proposed below, coupled with a larger future monitoring effort, can provide a reasonable Internet-wide estimate of attack counts.

To arrive at our rough projection, we first compare the size of the monitored address space to the Internet. We monitor about 0.105% of the advertised Internet address space, determined by comparing the size of the routing table advertised by Los Nettos to the size of the advertised Internet address space as reported by Route Views [22] on December 15, 2002. We assume that addresses are consumed uniformly and that attacks are targeted uniformly in both Los Nettos and the general Internet. Given these assumptions, we can scale our observations to the Internet accordingly (multiplying by a factor of 1900).

We observe DoS attacks that both transit and terminate in Los Nettos. Since distributed DoS attacks depart from many sources to attack a victim, we would expect that transiting attacks are more prevalent than terminating attacks. For example, in Figure 13, we monitor a quarter of the address space. If we measure unique victims of any attacks involving the shaded area, we observe 3 attacks and project 12, overestimating by a factor of three. If instead, we observe only attacks terminating in the area, we get an accurate estimate of 4. In general, projections from transit traffic identify an upper-bound on the number of attacks, since it may overestimate by the minimum of the scale-up factor or the number of distributed attackers. Although it is difficult to quantify the false negative rate of our detection mechanism, we believe it captures most large attacks but misses many small attacks. Therefore, the number of attacks observed can be considered a lower bound.

Based on these assumptions, Table 6 projects our observations to the Internet as a whole. Clearly, these projections are tentative, since we know that there were at least 10 attacks in October but we project none. One point of comparison is the work of Moore et al., where they observe backscatter from 12,805 attacks in 3 weeks [24]. Direct comparison between their observation and ours is extremely difficult since the methodology and classes of counted attacks are very different, but it is somewhat reassuring that both their observation and our estimate are roughly the same order of magnitude.

Although the observations are very rough and require many assumptions, we believe this methodology will be useful at approximating attack prevalence if we can increase the size and duration of the monitored region. We are working on doing both.

### Conclusion

This paper presented a framework to classify DoS attacks into single- and multi-source attacks. In addition to using packet headers to classify the attacks, we developed two new approaches: initial ramp-up transients and spectral analysis. These approaches depend only on information in the attack packet stream, and we believe the spectral characteristics of attacks cannot be altered without reducing attack rates.

We evaluated our framework on 80 attacks captured from two peering links at a moderate-size, regional ISP. We validated our framework with attacks captured at a second monitoring site, and through experiments with synthetic attacks on a wide-area network, and real attack tools on an isolated testbed. We used experiments and simulations to explain the underlying reasons for the difference in attack characteristics.

DoS attacks are constantly evolving, and currently, there is a dearth of detailed information regarding attack dynamics. We suggested several applications of the techniques developed in this paper: to develop an automatic detection and response system based on the number of attackers, to enable fine-grained analysis of attack patterns and topologies, and to infer global DoS activity.

### Acknowledgments

We would like to thank Jim Pepin, Walter Prue, and Sanford George of Los Nettos, and Brian Yamaguchi of USC, for helping us obtain traces and for discussions about handling DoS attacks. We would like to thank Kimberley Claffy, David Moore, Elizabeth Belding-Royer, Bing Wang, Don Towsley, Deborah Estrin, and Colin Perkins for providing access to their lab machines for our WAN experiments. Rohit Agarwal helped with the testbed experiments and identifying attack tools. In addition, we would like to thank Craig Partridge, Edmond Jonckheere, and the anonymous reviewers for their useful comments on the earlier version of this paper.

### References

[References listed as provided in the original text]

---

This revised version aims to enhance clarity, coherence, and professionalism while maintaining the technical accuracy and depth of the original text.