### Driver on a Capture Hub

Capture provides robust isolation and security protections across devices and their drivers. Our evaluation results demonstrate that several example IoT devices can be modified to use Capture through one of our three integration approaches, thereby achieving the security benefits of Capture with acceptable performance overheads.

### Acknowledgements

We would like to express our gratitude to Jeremy Erickson, Haojian Jin, and the members of the Synergy Labs for their valuable discussions and feedback. Additionally, we greatly appreciate the anonymous reviewers and our shepherd, Adwait Nadkarni, for their insightful comments and feedback. This work was partially supported by NSF Awards 1564009 and 1801472, Air Force Research Laboratory agreement number FA8750-15-2-0281, ONR Award N000141812618, and the Carnegie Mellon CyLab Security and Privacy Institute.

### References

1. Alasdair Allan. "Teardown of a smart plug (or two)." *Hackster.io News*, 2020. [Link](https://www.hackster.io/news/teardown-of-a-smart-plug-or-two-6462bd2f275b)

2. Omar Alrawi, Chaz Lever, Manos Antonakakis, and Fabian Monrose. "SoK: Security evaluation of home-based IoT deployments." *2019 IEEE Symposium on Security and Privacy*, 2019.

3. Amazon Web Services. "AWS IoT Greengrass." 2020. [Link](https://aws.amazon.com/greengrass/)

4. Manos Antonakakis, Tim April, Michael Bailey, Matt Bernhard, Elie Bursztein, Jaime Cochran, Zakir Durumeric, J. Alex Halderman, Luca Invernizzi, Michalis Kallitsis, Deepak Kumar, Chaz Lever, Zane Ma, Joshua Mason, Damian Menscher, Chad Seaman, Nick Sullivan, Kurt Thomas, and Yi Zhou. "Understanding the Mirai botnet." *26th USENIX Security Symposium*, 2017.

5. Apache JMeter. 2020. [Link](https://jmeter.apache.org/)

6. Andrew D Birrell and Bruce Jay Nelson. "Implementing remote procedure calls." *ACM Transactions on Computer Systems (TOCS)*, 1984.

7. Sudershan Boovaraghavan, Anurag Maravi, Prahaladha Mallela, and Yuvraj Agarwal. "MLIoT: An end-to-end machine learning system for the Internet-of-Things." *6th ACM/IEEE Conference on Internet of Things Design and Implementation (IoTDI)*, 2021.

8. Sven Bugiel, Lucas Davi, Alexandra Dmitrienko, Thomas Fischer, Ahmad-Reza Sadeghi, and Bhargava Shastry. "Towards taming privilege-escalation attacks on Android." *NDSS*, 2012.

9. Daming D. Chen, Maverick Woo, David Brumley, and Manuel Egele. "Towards automated dynamic analysis for Linux-based embedded firmware." *NDSS*, 2016.

10. CNET. "Search engine Shodan knows where your toaster lives." *CNET*, 2015. [Link](https://www.cnet.com/how-to/shodan-lives-dyn-botnet-searches-all-your-iot-devices/)

11. Computer Weekly. "Third-party code bug left Instagram users at risk of account takeovers." *Computer Weekly*, 2020. [Link](https://www.computerweekly.com/news/252489542/Third-party-code-bug-left-Instagram-users-at-risk-of-account-takeover)

12. Alasdair Allan. "The problem with throwing away a smart device." *Hackster.io News*, 2020. [Link](https://www.hackster.io/news/the-problem-with-throwing-away-a-smart-device-75c8b35ee3c7)

13. Lucas Davi, Alexandra Dmitrienko, Ahmad-Reza Sadeghi, and Marcel Winandy. "Privilege escalation attacks on Android." *International Conference on Information Security*, 2010.

14. Alexandre Decan, Tom Mens, and Eleni Constantinou. "On the impact of security vulnerabilities in the npm package dependency network." *15th International Conference on Mining Software Repositories (MSR)*, 2018.

15. Soteris Demetriou, Nan Zhang, Yeonjoon Lee, XiaoFeng Wang, Carl A. Gunter, Xiaoyong Zhou, and Michael Grace. "HanGuard: SDN-driven protection of smart home WiFi devices from malicious mobile apps." *10th ACM Conference on Security and Privacy in Wireless and Mobile Networks (WiSec)*, 2017.

16. Erik Derr, Sven Bugiel, Sascha Fahl, Yasemin Acar, and Michael Backes. "Keep me updated: An empirical study of third-party library updatability on Android." *2017 ACM SIGSAC Conference on Computer and Communications Security (CCS)*, 2017.

17. Brian Dipert. "Teardown: A WiFi smart plug for home automation." *EDN*, 2020. [Link](https://www.edn.com/teardown-a-wi-fi-smart-plug-for-home-automation/)

18. Brian Dipert. "Teardown: WeMo switch is highly integrated." *EDN*, 2020. [Link](https://www.edn.com/teardown-wemo-switch-is-highly-integrated/)

19. Colin Dixon, Ratul Mahajan, Sharad Agarwal, A.J. Brush, Bongshin Lee, Stefan Saroiu, and Paramvir Bahl. "An operating system for the home." *9th USENIX Symposium on Networked Systems Design and Implementation (NSDI)*, 2012.

20. Ruian Duan, Ashish Bijlani, Meng Xu, Taesoo Kim, and Wenke Lee. "Identifying open-source license violation and 1-day security risk at large scale." *2017 ACM SIGSAC Conference on Computer and Communications Security (CCS)*, 2017.

21. Zakir Durumeric, David Adrian, Ariana Mirian, Michael Bailey, and J. Alex Halderman. "A search engine backed by Internet-wide scanning." *2015 ACM SIGSAC Conference on Computer and Communications Security (CCS)*, 2015.

22. Jeremy Erickson, Qi Alfred Chen, Xiaochen Yu, Erinjen Lin, Robert Levy, and Z. Morley Mao. "No one in the middle: Enabling network access control via transparent attribution." *2018 ACM ASIA Conference on Computer and Communications Security (AsiaCCS)*, 2018.

23. ESP32.NET. "The internet of things with ESP32." 2020. [Link](http://esp32.net/)

24. Espressif. "[SDK release] esp8266-nonos-sdk-v1.5.0-15-11-27." *Espressif Forum*, 2015. [Link](https://bbs.espressif.com/viewtopic.php?f=46&t=1442)

25. Espressif. "We just hit a new major milestone." *Espressif Media*, 2018. [Link](https://www.espressif.com/en/media_overview/news/espressif-achieves-100-million-target-iot-chip-shipments)

26. Espressif. "ESP32 series datasheet." 2020. [Link](https://www.espressif.com/sites/default/files/documentation/esp32_datasheet_en.pdf)

27. Espressif. "WolfSSL for ESP-IDF." *GitHub*, 2020. [Link](https://github.com/espressif/esp-wolfssl)

28. Google. "Protocol buffers." 2020. [Link](https://developers.google.com/protocol-buffers)

29. gRPC. "A high-performance, open source universal RPC framework." 2020. [Link](https://grpc.io/)

30. Hang Guo and John Heidemann. "Detecting IoT devices in the internet (extended)." *Technical Report ISI-TR-726B, USC/Information Sciences Institute*, 2018.

31. Hackaday.io. "382 projects tagged with 'ESP32'." 2020. [Link](https://hackaday.io/projects?tag=ESP32)

32. Jun Han, Albert Jin Chung, Manal Kumar Sinha, Madhumitha Harishankar, Shijia Pan, Hae Young Noh, Pei Zhang, and Patrick Tague. "Do you feel what I hear? Enabling autonomous IoT device pairing using different sensor types." *2018 IEEE Symposium on Security and Privacy*, 2018.

33. Armijn Hemel, Karl Trygve Kalleberg, Rob Vermaas, and Eelco Dolstra. "Finding software license violations through binary code clone detection." *8th Working Conference on Mining Software Repositories (MSR)*, 2011.

34. Tejun Heo. "Control group v2." *Linux Kernel Documentation*, 2015. [Link](https://www.kernel.org/doc/Documentation/cgroup-v2.txt)

35. David Hodson. "Nest Learning Thermostat 2nd Generation teardown." *iFixit*, 2020. [Link](https://www.ifixit.com/Teardown/Nest+Learning+Thermostat+2nd+Generation+Teardown/13818)

36. James Hong, Amit Levy, Laurynas Riliskis, and Philip Levis. "Don’t talk unless I say so! Securing the Internet of things with default-off networking." *3rd ACM/IEEE International Conference on Internet-of-Things Design and Implementation (IoTDI)*, 2018.

37. hostapd. 2020. [Link](https://w1.fi/hostapd/)

38. IFTTT. 2020. [Link](https://www.ifttt.com)

39. Ronny Ko and James Mickens. "DeadBolt: Securing IoT deployments." *Applied Networking Research Workshop (ANRW)*, 2018.

40. Deepak Kumar, Kelly Shen, Benton Case, Deepali Garg, Galina Alperovich, Dmitry Kuznetsov, Rajarshi Gupta, and Zakir Durumeric. "All things considered: An analysis of IoT devices on home networks." *28th USENIX Security Symposium*, 2019.

41. Tobias Lauinger, Chaabane Abdelberi, Sajjad Arshad, William Robertson, Christo Wilson, and Engin Kirda. "Thou shalt not depend on me: Analysing the use of outdated JavaScript libraries on the web." *NDSS*, 2017.

42. The Security Ledger. "Devices’ UPnP service emerges as key threat to home IoT networks." *Security Ledger*, 2020. [Link](https://securityledger.com/2019/03/devices-upnp-service-emerges-as-key-threat-to-home-iot-networks/)

43. Xinyu Lei, Guan-Hua Tu, Chi-Yu Li, Tian Xie, and Mi Zhang. "SecWIR: Securing smart home IoT communications via Wi-Fi routers with embedded intelligence." *18th International Conference on Mobile Systems, Applications, and Services (MobiSys)*, 2020.

44. Chieh-Jan Mike Liang, Börje F. Karlsson, Nicholas D. Lane, Feng Zhao, Junbei Zhang, Zheyi Pan, Zhao Li, and Yong Yu. "SIFT: Building an internet of safe things." *14th International Conference on Information Processing in Sensor Networks (IPSN)*, 2015.

45. Linux Containers. 2020. [Link](https://linuxcontainers.org/)

46. Xianghang Mi, Feng Qian, Ying Zhang, and XiaoFeng Wang. "An empirical characterization of IFTTT: ecosystem, usage, and performance." *2017 Internet Measurement Conference (IMC)*, 2017.

47. MichMich. "MagicMirror." *GitHub*, 2020. [Link](https://github.com/MichMich/MagicMirror)

48. Microsoft Azure. "Azure Sphere." 2020. [Link](https://azure.microsoft.com/en-us/services/azure-sphere/)

49. Asuka Nakajima, Takuya Watanabe, Eitaro Shioji, Mitsuaki Akiyama, and Maverick Woo. "A pilot study on consumer IoT device vulnerability disclosure and patch release in Japan and the United States." *2019 ACM Asia Conference on Computer and Communications Security (AsiaCCS)*, 2019.

50. Hung Nguyen, Radoslav Ivanov, Linh T.X. Phan, Oleg Sokolsky, James Weimer, and Insup Lee. "LogSafe: Secure and scalable data logger for IoT devices." *3rd ACM/IEEE International Conference on Internet-of-Things Design and Implementation (IoTDI)*, 2018.

51. OpenSSL. "Release strategy." 2020. [Link](https://www.openssl.org/policies/releasestrat.html)

52. OpenSSL. "Changelog." 2020. [Link](https://www.openssl.org/news/changelog.html)

53. Particle Device OS. 2020. [Link](https://www.particle.io/device-os/)

54. phodal/awesome-iot. "A collaborative list of great resources about IoT framework, library, OS, platform." *GitHub*, 2020. [Link](https://github.com/phodal/awesome-iot#library)

55. Raspberry Pi. "Issue: cpuset disabled #1950." *Raspberry Pi GitHub Issues*, 2020. [Link](https://github.com/raspberrypi/linux/issues/1950)

56. Raspberry Pi 4 specification. *Raspberry Pi*, 2020. [Link](https://www.raspberrypi.org/products/raspberry-pi-4-model-b/specifications/)

57. Dark Reading. "Over 80% of medical imaging devices run on outdated operating systems." *Dark Reading*, 2020. [Link](https://www.darkreading.com/iot/over-80--of-medical-imaging-devices-run-on-outdated-operating-systems/d/d-id/1337273)

58. Red Hat. "What is the maximum number of interface aliases supported in Red Hat Enterprise Linux?" *Red Hat Access*, 2020. [Link](https://access.redhat.com/solutions/40500)

59. Muzammil Abdul Rehman and Paul Grosu. "RPC is not dead: Rise, fall and the rise of remote procedure calls." *Distributed Programming Book*, 2017. [Link](http://dist-prog-book.com/chapter/1/rpc.html)

60. RTInsights. "IoT devices still exposed, vast majority of traffic unencrypted." *RTInsights*, 2020. [Link](https://www.rtinsights.com/iot-security-remains-lacklustre/)

61. RTInsights. "Malware attacks IoT devices running Windows 7." *RTInsights*, 2020. [Link](https://www.rtinsights.com/malware-iot-windows-7/)

62. Samsung SmartThings. "Direct-connected device SDK." *SmartThings Developer*, 2020. [Link](https://smartthings.developer.samsung.com/docs/devices/direct-connected-devices/overview.html)

63. Samsung SmartThings. "SmartThings device SDK." *GitHub*, 2020. [Link](https://github.com/SmartThingsCommunity/st-device-sdk-c)

64. Senrio. "400,000 publicly available IoT devices vulnerable to single flaw." *Senrio Blog*, 2016. [Link](https://blog.senr.io/blog/400000-publicly-available-iot-devices-vulnerable-to-single-flaw)

65. Mohit Sethi, Elena Oat, Mario Di Francesco, and Tuomas Aura. "Secure bootstrapping of cloud-managed ubiquitous displays." *2014 ACM International Joint Conference on Pervasive and Ubiquitous Computing (UbiComp)*, 2014.

66. Anna Kornfeld Simpson, Franziska Roesner, and Tadayoshi Kohno. "Securing vulnerable home IoT devices with an in-hub security manager." *2017 IEEE International Conference on Pervasive Computing and Communications Workshops (PerCom)*, 2017.

67. Andrew Stuart Tanenbaum and Robbert Van Renesse. "A critique of the remote procedure call paradigm." 1987.

68. TOMOYO Linux. 2020. [Link](https://tomoyo.osdn.jp/index.html.en)

69. smem(8) - Linux man page. *Linux Man Pages*, 2020. [Link](https://linux.die.net/man/8/smem)

70. Rahmadi Trimananda, Ali Younis, Bojun Wang, Bin Xu, Brian Demsky, and Guoqing Xu. "Vigilia: Securing smart home edge computing." *2018 IEEE/ACM Symposium on Edge Computing (SEC)*, 2018.

71. Random Nerd Tutorials. "70+ ESP32 projects, tutorials and guides with Arduino IDE." *Random Nerd Tutorials*, 2020. [Link](https://randomnerdtutorials.com/projects-esp32/)

72. Maarten Van Steen and Andrew S Tanenbaum. "Distributed systems, chapter 4.2." 2017.

73. Steve Vinoski. "Convenience over correctness." *IEEE Internet Computing*, 12(4):89–92, 2008.

74. Jim Waldo, Geoff Wyant, Ann Wollrath, and Sam Kendall. "A note on distributed computing." *International Workshop on Mobile Object Systems*, pages 49–64, 1996.

75. Wikipedia. "IEEE 802.11i-2004." 2020. [Link](https://en.wikipedia.org/wiki/IEEE_802.11i-2004)

76. Wikipedia. "OpenSSL - major version releases." 2020. [Link](https://en.wikipedia.org/wiki/OpenSSL#Major_version_releases)

77. Ann Wollrath, Roger Riggs, and Jim Waldo. "A distributed object model for the Java system." 1996.

78. Rich Wolski, Chandra Krintz, Fatih Bakir, Gareth George, and Wei-Tsung Lin. "CSPOT: Portable, multi-scale functions-as-a-service for IoT." *4th ACM/IEEE Symposium on Edge Computing (SEC)*, 2019.

79. Miguel G. Xavier, Marcelo V. Neves, Fabio D. Rossi, Tiago C. Ferreto, Timoteo Lange, and Cesar A. F. De Rose. "Performance evaluation of container-based virtualization for high performance computing environments." *2013 21st Euromicro International Conference on Parallel, Distributed, and Network-Based Processing*, 2013.

80. Tianlong Yu, Vyas Sekar, Srinivasan Seshan, Yuvraj Agarwal, and Chenren Xu. "Handling a trillion (unfixable) flaws on a billion devices: Rethinking network security for the internet-of-things." *14th ACM Workshop on Hot Topics in Networks (HotNets)*, 2015.

81. ZDNet. "Shodan: The IoT search engine for sleeping kids and bedroom antics." *ZDNet*, 2016. [Link](https://www.zdnet.com/article/shodan-the-iot-search-engine-which-shows-us-sleeping-kids-and-how-we-throw-away-our-privacy/)

82. ZDNet. "CallStranger vulnerability lets attacks bypass security systems and scan LANs." *ZDNet*, 2020. [Link](https://www.zdnet.com/article/callstranger-vulnerability-lets-attacks-bypass-security-systems-and-scan-lans/)

83. ZDNet. "Hacker leaks passwords for more than 500,000 servers, routers, and IoT devices." *ZDNet*, 2020. [Link](https://www.zdnet.com/article/hacker-leaks-passwords-for-more-than-500000-servers-routers-and-iot-devices/)

84. ZDNet. "Ripple20 vulnerabilities will haunt the IoT landscape for years to come." *ZDNet*, 2020. [Link](https://www.zdnet.com/article/ripple20-vulnerabilities-will-haunt-the-iot-landscape-for-years-to-come/)

85. Wei Zhang, Yan Meng, Yugeng Liu, Xiaokuan Zhang, Yinqian Zhang, and Haojin Zhu. "HoMonit: Monitoring smart home apps from encrypted traffic." *2018 ACM SIGSAC Conference on Computer and Communications Security (CCS)*, 2018.

86. Yaowen Zheng, Ali Davanian, Heng Yin, Chengyu Song, Hongsong Zhu, and Limin Sun. "FIRM-AFL: High-throughput greybox fuzzing of IoT firmware via augmented process emulation." *28th USENIX Security Symposium*, 2019.