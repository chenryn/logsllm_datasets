A user should only receive an affiliate cookie upon clicking on an affiliate URL. During our web crawling, we do not click on any links, so any affiliate cookies we receive are considered fraudulent. Since it is impractical to crawl every webpage, we focused our visits on four specific sets of URLs where we expected to encounter affiliate fraud.

For each crawl, we used a slightly modified version of our publicly available extension, AffTracker, which automatically retrieves a new URL from a queue in Redis, a persistent key-value store. Upon completing a visit, the extension submits results to our server and clears the crawler browser of all history, cookies, and local storage. We clear the browser because some affiliates use browser state to rate-limit their cookie-stuffing to evade detection by affiliate programs. For example, an affiliate, jon007, who controls bestwordpressthemes.com, sets a custom cookie called `bwt` that is valid for a month. As long as this cookie remains valid in the browser, bestwordpressthemes.com does not request HostGator affiliate cookies for the user. Additionally, inspired by Shawn Hogan, who, according to eBay, rate-limited his cookie-stuffing by requesting an affiliate cookie only once per IP, we used 300 proxies to mitigate IP-based detection by fraudulent affiliates.

We crawled the following four sets of domains to gather affiliate cookies:
1. **Alexa Top Domains**: We crawled the Alexa top 100K domains as of April 16, 2015, to find popular domains involved in cookie-stuffing.
2. **Reverse Cookie Lookups**: After identifying the cookie names used by different affiliate programs, we performed reverse lookups on the cookie-search interface on digitalpoint.com, a webmaster community that indexes all the cookies its crawler encounters. Overall, we gathered 9.5K domains that the Digital Point crawler observed performing cookie-stuffing over the last two years.
3. **Reverse Affiliate ID Lookup**: Using the cookie-stuffing affiliate IDs discovered from our Digital Point domain crawl, we queried an aggregator site, sameid.net, which indexes domains by Amazon and ClickBank affiliate IDs seen on a domain. By iteratively crawling domains queried from the newly discovered cookie-stuffing affiliate IDs, we visited a total of 74.5K domains.
4. **Typosquatted Domains**: In our first three sets, we observed that much of the cookie-stuffing fraud was on domains typosquatting on merchant domain names. Thus, we crawled all typosquatted .com domains for over 7K domains belonging to major e-retailers. Similar to Edelman et al., we interpret the use of typosquatting to redirect users to merchant sites without any explicit clicks as cookie-stuffing and therefore fraudulent. Typically, users visiting typosquatted domains intend to visit the merchant site rather than the typosquatted domain itself. Thus, typosquatting a domain does not bring new customers to merchant sites via direct affiliate marketing of products. Therefore, we recognize cookie-stuffing via typosquatted domains as fraudulent.

We acquired the set of domains belonging to e-retailers from a public API offered by Rakuten Popshops. The downloaded data includes merchant lists for Commission Junction, ShareASale, and Rakuten LinkShare affiliate networks. By calculating the Levenshtein distance for merchant domains against all .com domains in a zone file from April 19, 2015, we found over 300K typosquatted domains with an edit distance of one. We visited this set of domains as well.

We gather the same features about affiliate cookies through crawling as from the user study because we use the same browser extension, AffTracker, in both cases. Furthermore, we only visit top-level pages of domains and therefore miss any cookie-stuffing in sub-pages. Google Chrome disables popups by default, a feature we left unchanged because it more accurately emulates a user’s browser. However, this behavior likely caused our crawler to miss any affiliate fraud where a fraudster opens a popup to load an affiliate URL.

Finally, while we can detect fraudulent affiliates stuffing cookies, we cannot determine whether an affiliate network has already identified the fraudster. We have seen examples of ClickBank and LinkShare affiliate sites where affiliate links show an error message about affiliates having been banned, but some networks do not break banned affiliate links to prevent a bad end-user experience for their URLs.

### 4. Results

In this section, we first analyze the affiliate networks and merchants most impacted by cookie-stuffing fraud. Next, we survey various cookie-stuffing techniques used by affiliates and present the results from our user study on the prevalence of affiliate marketing and cookie-stuffing fraud.

#### 4.1 Networks Affected by Cookie-Stuffing

Using data collected from our crawls, we identified the affiliate networks most targeted by cookie-stuffing. Overall, we received 12,033 affiliate cookies from 11.7K domains. Table 2 summarizes our results.

We found that CJ Affiliate and Rakuten LinkShare are the most targeted programs, comprising 85% of all fraudulent cookies we observed. We identified affiliate IDs for all but 1.6% of these cookies. Each fraudulent CJ affiliate stuffed almost 50 cookies, while each LinkShare affiliate stuffed 41 cookies. However, fraudulent affiliates in the Amazon and HostGator affiliate programs only stuffed 2.5 cookies per affiliate on average, the fewest of all affiliate programs in our study, suggesting that fraudulent affiliates target networks much more than they target in-house affiliate programs.

Generally, affiliate networks present greater cookie-stuffing opportunities to fraudulent affiliates because a single affiliate can simultaneously defraud multiple merchant members of the network. Our data from the Popshops API (Section 3.3) contains almost 2.4K merchants in CJ Affiliate and 1.3K merchants in Rakuten LinkShare. As Table 2 shows, each fraudulent affiliate targeted more than three merchants in LinkShare on average. We received 10 and 15 cookies on average for every targeted merchant in CJ Affiliate and Rakuten LinkShare, respectively.

Using the Popshops data as ground truth, we classified the defrauded merchants in all major networks (Figure 2) in our study except ClickBank and 420 CJ Affiliate cookies. We found that, overall, Apparel and Accessories e-retailers are targeted the most across all three affiliate networks, while the second most impacted group of merchants are Department Stores, again abused in all three networks but to a greater extent in LinkShare. Travel and Hotel sites were the third-most defrauded group. These three sectors have a large number of merchants, and we found almost 11 stuffed cookies on average for every targeted merchant. On the other hand, the Tools and Hardware category only contains four impacted merchants, but we observed almost 45 cookies for each of them on average, the highest of any category. Home Depot, a CJ Affiliate member, was the most impacted merchant in this category with 163 stuffed cookies.

We also found 107 merchants who were defrauded across two or more networks. Chemistry.com, a member of CJ Affiliate and LinkShare, was the most targeted merchant participating in more than one affiliate program.

#### 4.2 Prevalence of Cookie-Stuffing Techniques

We used the collected data to characterize the use of various cookie-stuffing techniques against each of the affiliate programs under consideration. As described in Section 3, whenever the browser requests an affiliate URL, our extension finds the DOM element that caused the fetch. Visiting a fraudulent affiliate’s webpage can cause the user’s browser to fetch an affiliate URL without any explicit click from the user by setting it as the `src` attribute of images, iframes, or script tags. All of these DOM elements can request third-party content on a webpage. Our extension is able to detect all affiliate cookies by observing the `Set-Cookie` HTTP headers and distinguish between these techniques automatically.

Table 2 shows the percentage of cookies corresponding to each of these techniques for every affiliate program.

At a high level, we observe that fraudulent affiliates use a much larger variety of techniques uniformly for affiliate programs run by the merchants themselves compared with larger affiliate networks, which are primarily targeted via redirects to merchant sites without user clicks. Table 2 also shows the average number of intermediate domains requested after the initial page visit but before the affiliate URL, i.e., a value of zero means that an affiliate URL was directly requested from the crawled page. Intermediate referrers can be used to obfuscate the original source of a fraudulent affiliate URL request because an affiliate program only sees the final referrer when determining the legitimacy of such a request. Affiliates defrauding the Amazon Associates Program use more intermediate domains on average. Since the cost of getting intermediate domains is higher, it is likely more expensive for fraudulent affiliates to defraud the Amazon Associates Program, presumably due to stricter policing by Amazon.

**Redirecting**: Fraudulent affiliates redirect users to affiliate URLs without any clicks by either using 301 or 302 HTTP response status codes or using Flash or JavaScript to redirect the browser to the affiliate URL. In each of these cases, the original page we crawled only resulted in one stuffed cookie per visit. Such redirects delivered over 91% of all stuffed cookies, most of which resulted from typosquatted domains. In fact, we received 84% of all affiliate cookies from 10.1K typosquatted domains.

Of the 10.1K cookies from typosquatted domains, 93% (9.4K cookies) are from domains typosquatting on merchant domain names.