# Cracking One of the Most Secure Locks in America

## Introduction
- **Title:** Open in 30 Seconds
- **Authors:** Marc Weber Tobias, Matt Fiddler

### LOCKS, LIES, and “HIGH” INSECURITY
- **Medeco High Security:**
  - A dominant high-security lock manufacturer with a 40-year history.
  - Multiple expert attempts to crack these locks have had limited success, often requiring complex tools.
  - Misstatements and disinformation have been prevalent.
  - An 18-month research project has resulted in a total compromise of their security.

### Medeco High Security Features
- **Certifications:**
  - UL, BHMA/ANSI, VdS Certified.
- **Security Levels:**
  - Picking resistance: 10-15 minutes.
  - No bumping.
  - Forced entry resistance: Minimum 5 minutes.
  - Key control: Protects restricted and proprietary keyways, preventing duplication, replication, and simulation of keys.

### Importance of High-Security Locks
- **Protection:**
  - Critical infrastructure and high-value targets.
  - Stringent security requirements and high standards.
  - Protection against forced and covert entry.
  - Key security to prevent unauthorized access.

### Medeco's Market Dominance
- **Market Share:**
  - Owns over 70% of the U.S. high-security market for commercial and government use.
  - Major government contracts and presence in the UK, France, Europe, and South America.
  - Considered almost invincible by experts.

### Why the Medeco Case Study is Important
- **Insights:**
  - Design of high-security locks.
  - Patents do not guarantee security.
  - The difference between perceived and real-world security.
  - Overreliance on standards.
  - Manufacturer knowledge and representations.
  - Methodology of attack.
  - Development of more secure lock designs.

### Conventional vs. High-Security Locks
- **Conventional Cylinders:**
  - Easy to pick and bump open.
  - No key control.
  - Limited forced entry resistance.
- **High-Security Cylinders:**
  - Meet UL and BHMA/ANSI standards.
  - Higher quality and tolerances.
  - Resistance to forced and covert entry.
  - Key control.

### Attack Methodology
- **Principles:**
  - Assume and believe nothing.
  - Ignore the experts.
  - Think "out of the box."
  - Consider prior methods of attack.
  - Always believe there is a vulnerability.
  - Work the problem: Consider all aspects and design parameters without excluding any solution.

### Critical Design Issues for High-Security Locks
- **Multiple Security Layers:**
  - More than one point of failure.
  - Each security layer operates independently and in parallel.
  - Difficult to derive intelligence about each layer.

### Three Critical Design Factors
- **Resistance:**
  - Against forced entry.
  - Against covert and surreptitious entry.
  - Key control and "key security."

### Bypass and Reverse Engineering
- **Weakest Link:**
  - Identify the weakest link in the lock to bypass (e.g., Medeco).
  - Determine what locking elements are in place and in what order.
  - Assess the impact if one layer fails and whether others can be compromised.
  - Determine the intelligence needed to open the lock and if it can be simulated.

### System Bypass
- **Sidebar Strength:**
  - Evaluate the strength of the sidebar(s) against forced attacks.
  - Determine if the sidebar is the only locking system.
  - Assess the impact of defeating one of two sidebars or security layers.
  - Examine the bitting design and the ability to manipulate each pin or slider to set its code.

### Secondary Security Layers
- **Components:**
  - Telescoping pins.
  - Sliders and wafers.
  - Sliders to set sidebars (e.g., Medeco).
  - Pseudo-sidebars = virtual keyways.
  - Sidebars: Originated in America with GM locks, many locking techniques.

### Layers of Security and Bypass Capability
- **Number of Layers:**
  - Ability to exploit design features.
  - Integrated vs. separate layers.
  - Examples: Primus = 2 levels, independent, complex locking of secondary finger pins; Assa = 2 levels, independent, simple locking, one level.

### Exploiting Features
- **Codes:**
  - Design and progression.
  - Key bitting design.
  - Tolerances.
  - Keying rules (e.g., Medeco master and non-master key systems).
  - Interaction of critical components and locking systems.
  - Keyway and plug design.

### Exploiting Tolerances
- **Sidebar Locking:**
  - Medeco 10 v. 20 degrees.
  - Relation to codes.
  - Simulation of codes.
  - Reverse engineering code progression from one or more keys.
  - Difficulty in replicating keys (e.g., Medeco v. MCS).

### Attacks: Two Primary Rules
- **Mechanical Bypass:**
  - "The key never unlocks the lock."
  - Alfred C. Hobbs: "If you can feel one component against the other, you can derive information and open the lock."

### Methods of Attack
- **High-Security Locks:**
  - Picking and manipulation of components.
  - Impressioning.
  - Bumping.
  - Vibration and shock.
  - Shim wire decoding (Bluzmanis and Falle).
  - Borescope and otoscope decoding.
  - Direct or indirect measurement of critical locking components.

### Additional Methods of Attack
- **Split Key:**
  - Use the sidebar portion to set the code.
  - Simulate the sidebar code.
  - Use the key to probe depths and extrapolate.
  - Rights amplification of the key.

### Key Control and Key Security
- **Key Control:**
  - High-security requirement.
  - Prevent duplication, replication, and simulation of keys.
  - Patent protection.
  - Physical control of keys.
  - Prevention of unauthorized manufacture and access to blanks.
  - Control generation of keys by code.

### Critical Elements of Keys
- **Length:**
  - Number of pins, sliders, disks.
  - Height of blade: depth increments.
  - Thickness of blade: keyway design.
  - Paracentric design.
  - Keyway modification to accommodate other security elements (e.g., finger pins, sliders).

### Key Control: Critical Issues
- **Simulation:**
  - Simulation of code or key components.
  - Security of locks = key control and key security.
  - All bypass techniques simulate actions of the key.
  - Easiest way to open a lock is with the key.

### Key Control and Key Security Issues
- **Passive Keys:**
  - Align = open.
  - Simulate components of the key.
  - Replicate critical components.
  - Duplicate critical components.
  - Require interactive elements for security (e.g., MUL-T-LOCK element, BiLock-NG, Everest Check Pins, MCS magnets).

### Key Control: Design Issues
- **Bitting Design:**
  - Bitting and sidebar issues and conflicts.
  - Ability to decode one or more keys to break the system.
  - Consider critical elements of the key to ensure they cannot be replicated.
  - Hybrid attacks using keys (e.g., Medeco mortise cylinder example).

### Duplication and Replication of Keys
- **Methods:**
  - Key machine.
  - Milling machine: Easy Entrie.
  - Clay and silicone casting.
  - Key simulation: Medeco.
  - Rights amplification.
  - Alter similar keys.

### Covert and Forced Entry Resistance
- **High-Security Requirement:**
  - UL and BHMA/ANSI Standards.
  - Time is a critical factor (10-15 minutes depending on security rating).
  - Type of tools that can be used.
  - Must resist picking and manipulation.
  - Standards do not contemplate more sophisticated methods.

### Conventional Picking
- **Tobias Decoder:**
  - "PI:EMAIL"
- **Sophisticated Decoders:**
  - John Falle: Wire Shim Decoder.
  - Decode pin angles.

### Forced Entry Resistance
- **Deficiencies in Standards:**
  - Many types of attacks defined.
  - Mechanical bypass not contemplated.
  - Examine the weakest links.
  - Do not cover "hybrid attacks" (e.g., Medeco deadbolt and mortise attacks).

### Sidebar: Bypass and Circumvention
- **Direct Access:**
  - Decoding attacks.
  - Manipulation.
  - Simulate the sidebar code (e.g., Medeco).
  - Use of a key (e.g., Primus and Assa).
- **Indirect Access:**
  - Medeco borescope and otoscope decode issues.

### Sidebar Attack: Physical Strength
- **Independent Protection:**
  - Integrated with pin tumblers or other critical locking components.
  - Plug compression.
  - Defeat of the sidebar as one security layer.
  - Anti-drill protection.

### Forced Entry Attacks
- **Direct Compromise:**
  - Critical components (e.g., Medeco deadbolt 1 and 2 manipulate tailpiece).
  - Hybrid attack: two different modes (e.g., Medeco reverse picking).
  - Defeat of one security layer (e.g., Medeco mortise and rim cylinders, defeat shear line).

### Lessons from Medeco High Security
- **What Constitutes Security:**
  - Lessons for design engineers.
  - Appearance vs. reality.

### Medeco Case History
- **Exploited Vulnerabilities:**
  - Reverse engineer sidebar codes.
  - Analyze what constitutes security.
  - Analyze critical tolerances.
  - Analyze key control issues.
  - Analyze design enhancements for new generations of locks (e.g., Biaxial and m3 and Bilevel).

### Medeco Mistakes
- **Failed to Listen:**
  - Embedded design problems from the beginning.
  - Compounded problems with new designs (e.g., Biaxial and m3).
  - Failed to "connect the dots."
  - Failure of imagination.
  - Lack of understanding of bypass techniques.

### Design = Vulnerabilities
- **Basic Design:**
  - Sidebar legs + gates.
  - How they work: leg + gate interface.
  - Tolerance of gates.
  - Biaxial code designation.
  - Biaxial pin design: aft position decoding.
  - M3 slider: geometry.
  - M3 keyway design.
  - Deadbolt design.

### Exploit Design Vulnerabilities
- **Best Design Features:**
  - Sidebar leg – true gate channel.
  - Code assignment: Biaxial 1985.
  - Gate – sidebar leg tolerance.
  - M3 design 2003: Widen keyway .007", Slider geometry, .040" offset.

### More Vulnerabilities
- **Biaxial Pin Design:**
  - Fore and aft positions.
  - Borescope decode of aft angles.
  - Introduction of Bilevel in 2006.
  - Compromise by decoding.

### Medeco Timeline
- **1970:** Original Lock introduced.
- **1985:** Biaxial, Second generation.
- **2003:** m3, Third generation.
- **August 2006:** Bump Proof.
- **February 2007:** Virtually Bump Proof.
- **2008:** Further developments.

### Why Medeco Locks Are Secure
- **Security Layers:**
  - 2 shear lines and sidebar for Biaxial.
  - 3 independent security layers for m3.
  - Pins = 3 rotation angles, 6 permutations.
  - Physical pin manipulation difficult.
  - False gates and mushroom pins.
  - ARX special anti-pick pins.
  - High tolerance.

### Modern Pin Tumbler: Medeco Biaxial
- **3 Independent Layers:**
  - Layer 1: PIN TUMBLERS to shear line.
  - Layer 2: SIDEBAR: 3 angles x 2 positions.
  - Layer 3: SLIDER – 26 positions.
  - Opened by: Lifting the pins to the shear line, rotating each pin individually, moving the slider to the correct position.

### Medeco Twisting Pins: 3 Angles + 2 Positions
- **Rotating Tumbler:**
  - Sidebar Technology: Block rotation of the plug.
  - One or two sidebars.
  - Primary or secondary locking.
  - Only shear line or secondary.
  - Integrated or separate systems (e.g., Assa, Primus, MT5, MCS, Medeco, 3KS).

### Sidebar Locking: How It Works
- **One or Two Sidebars:**
  - Interaction during plug rotation.
  - Direct or indirect block plug rotation.
  - Sidebar works in which modes (e.g., rotate left or right, pull or push).
  - Can the sidebar be neutralized (e.g., setting sidebar code, pulling plug forward, not turning).

### Sidebar Locking Design: Information from the Lock
- **Feel Picking:**
  - Sense interactions.
  - Direct link (e.g., Medeco, 3KS, Primus, Assa).
  - Indirect link (e.g., MCS: sidebar to component).
  - Sidebar + pins/sliders interaction to block each other: ability to apply torque?

### Sidebar Coding
- **Total Number:**
  - Real and theoretical.
  - Restrictions and conflicts.
  - Rules to establish.
  - Can we use rules to break the system (e.g., Medeco TMK multiple, Assa V10 multiplex coding).

### Security Concepts: Sidebar "IS" Medeco Security
- **GM Locks, 1935:**
  - Medeco re-invented.
  - Heart of Medeco security and patents.
  - Independent and parallel security layer.
  - Integrated pin: lift and rotate to align.
  - Sidebar blocks plug rotation.
  - Pins block manipulation of pins for rotation to set angles.

### Plug and Sidebar: All Pins Aligned
- **Sidebar Retracted:**
  - Locked state.

### Medeco Codebook: At the Heart of Security
- **All locksmiths worldwide must use:**
  - Non-master keyed systems.
  - New codes developed for Biaxial in 1983.
  - Chinese firewall: MK and Non-MK.
  - Codebook defines all sidebar codes.

### Original Fore Aft
- **Left:**
  - L, K, M.
- **Center:**
  - C, B, D.
- **Right:**
  - R, Q, S.

### Key Codes: Vertical Bitting and Sidebar
- **Vertical Bitting:**
  - 6 depths, .025" increments.
  - Sidebar Pins: 3 angles, 2 positions = 6 permutations.

### Medeco Research: Results of Project
- **Covert and Surreptitious Entry:**
  - As little as 30 seconds (standard requires 10-15 minutes).
  - Forced entry: four techniques, 30 seconds, affecting millions of locks.
  - Complete compromise of key control (duplication, replication, simulation of keys, creation of bump keys and code setting keys, creation of top-level master keys).

### Results of Project: Bumping
- **Reliably Bump Open:**
  - Biaxial and m3 locks.
  - Produce bump keys on Medeco blanks and simulated blanks.
  - Known and unknown sidebar codes.

### Results of Project: Key Control and Key Security
- **Total Compromise:**
  - Key control and key security, vital to high-security locks.
  - Duplicate, replicate, simulate keys for all m3 and some Biaxial keyways.
  - Restricted and proprietary keyways.
  - Government and large facilities affected.
  - Attack master key systems.
  - Produce bump keys and code setting keys.

### Simulated Blanks: Any m3 and Many Biaxial Locks
- **M3 Slider:**
  - Bypass with a paper clip.

### Security of m3: Results of Project: Picking
- **Pick the Locks:**
  - As little as 30 seconds.
  - Standard picks, not high-tech tools.
  - Use of another key in the system to set the sidebar code.
  - Pick all pins or individual pins.
  - Neutralize the sidebar as a security layer.

### Video Demo: Picking Medeco Locks
- **Results of Project: Decode Top Level Master Key:**
  - Determine the sidebar code in special systems with multiple sidebar codes.
  - Decode the TMK.
  - PWN the system.

### Results of Project: Forced Entry Techniques
- **Deadbolt Attacks:**
  - All three versions.
  - Deadbolt 1 and 2: 30 seconds.
  - Deadbolt 3: New hybrid technique of reverse picking.
  - Mortise and rim cylinders: Prior intelligence + simulated key.
  - Interchangeable core locks.

### Deadbolt Bypass: $2 Screwdriver + $.25 Materials
- **Video Demo:**
  - Deadbolt Bypass.

### Mortise Cylinder: Mortise Attack
- **Video Demo:**
  - Mortise Cylinder Bypass.

### Connecting the Dots
- **Critical Failures:**
  - Original Biaxial: pin design, code assignment.
  - Biaxial - m3 design: M3 slider geometry (.040" offset), key simulation, .007" keyway widening.

### More Dots: Forced Entry
- **Original Deadbolt Design:**
  - Fatal design flaw: 30 seconds bypass.
  - Later deadbolt designs: new attacks.
  - Mortise and rim cylinders: inherent design problem (.065" plug).

### Bilevel Lock
- **2007:**
  - Integrate low and high security to compete.
  - Flawed design, will affect system security when integrated into high-security systems.
  - Borescope decoding of aft pins to compromise security of the entire system.

### Connecting the Dots: The Results
- **Biaxial Code Assignment:**
  - Reverse engineer for all non-master key systems.
  - Gate tolerance: 4 keys to open.
  - New Concept: Code Setting keys.
  - Sidebar leg-gate interface: New concept: Setting sidebar code.
  - M3 wider keyway: Simulated blanks.
  - Slider design: paper clip offset.

### 4 Keys to the Kingdom
- **Video Demo:**
  - Code Setting Keys.
  - Bump Proof…
  - Virtually Bump Proof…
  - Virtually Bump Resistant…

### Lessons to Be Learned
- **Patents:**
  - Do not assure security.
  - Apparent security vs. actual security.
  - 40 years of invincibility means nothing.
  - New methods of attack.
  - Corporate arrogance and misrepresentation.
  - "If it wasn’t invented here" mentality.
  - All mechanical locks have vulnerabilities.

### Countermeasures: Primary Design Rules
- **ARX Pin Design:**
  - Dual State Locking: 3KS.
  - Interactive key elements (e.g., MCS).
  - 2 or 3 security layers.
  - No direct intelligence from manipulation.
  - Cannot defeat one layer and bypass others.

### Video Demo: Bypass…Medeco Gen4

### Thank You!
- **Contact:**
  - PI:EMAIL
  - PI:EMAIL
  - © 2008 Marc Weber Tobias