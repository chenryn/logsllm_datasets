### Port Connections Analysis

#### 443/udp
- **No. of connections / Port:**
  - 2,604,683
  - 1,337,377
  - 1,004,940
  - 764,040
  - 630,907
  - 519,864
  - 489,547
  - 195,545
  - 129,435
  - 123,446

#### 27015/udp, 5355/udp, 777/tcp, 34/tcp, 53/tcp
- **No. of connections:**
  - 4,866,276
  - 1,461,617
  - 1,384,311
  - 810,670
  - 805,234
  - 618,537
  - 164,900
  - 98,130
  - 96,703
  - 95,490

### Malicious Binaries
On average, we observed 12 malicious files hosted at a single IP address. Notably, one IP address was found to host up to 468 malicious binaries. The Brickcom IP Camera (averaging 863 downloads per day) is more active in terms of malware downloads compared to the Netgear router honeypot (averaging 163 downloads per day). This increased activity is likely due to the widely publicized article disclosing the camera’s vulnerabilities with proof-of-concepts (PoCs).

### 3.3 IoT Device Monetization
The final stage of an IoT device compromise typically involves the attacker leveraging full control of the device for nefarious activities such as expanding their botnet, launching DDoS attacks, etc.

**Definition:**
- **Post-infection traffic** is defined as the traffic received and generated by a honeypot, excluding the initial intrusion and infection. This traffic includes potential C&C communications and other malicious activities from compromised honeypots.

**Note:**
- Our analysis differs from previous research efforts because we allow malicious binaries to run in a real environment but block or rate-limit outgoing traffic (see Section 2 for detailed design information). The following analysis focuses on the Netgear router and Brickcom IP camera high-interaction honeypots.

### High-Level Overview
We analyzed post-infection traffic by dividing it into TCP and UDP, and further categorizing it into incoming and outgoing traffic. The goal was to identify if the high-interaction honeypots experienced different traffic volumes due to their computational capabilities.

**Results:**
- The Netgear router honeypot experienced more outgoing UDP and TCP traffic than the Brickcom IP camera honeypot (Fig. 4(a) and (b)). This suggests that the Netgear router has superior computational capabilities, allowing attackers to use payloads without performance throttling.
- Outgoing traffic was observed on 65,335 different ports, contrasting with incoming traffic observed on only 14,560 and 5,320 ports for the Brickcom and Netgear honeypots, respectively.
- The top 10 ports for outgoing post-infection traffic contribute to 30% of each high-interaction honeypot's total traffic. The top three ports include port scanning (80/udp), possible C&C communications (3074/udp), and DDoS attacks (53/udp), contributing to about 20% of the total traffic.

### Spiked Traffic Analysis
After the high-level overview, we conducted a temporal analysis of the post-infection traffic, identifying four peaks (Fig. 5):
- **Peak ❶:** Caused by a dramatic increase in TCP traffic.
- **Peaks ❷, ❸, and ❹:** Triggered by elevated UDP traffic.

To identify the root causes of these peaks, we correlated file downloads during the infection phase with the traffic spikes. We used a one-hour sliding window to rank traffic measurements and identified the binaries downloaded during the most active windows as the root cause.

**Results:**
- The volume of traffic per port for the top three ports in peaks ❸ and ❹ is significantly smaller compared to peaks ❶ and ❷. For example, peak ❹ had 3,936,628 UDP connections, with the top three ports covering only 0.01% of the total traffic.
- In contrast, peak ❶ had traffic on 628 different ports, with one port covering 96% of the total traffic.

### Behavioral Analysis
To better understand the underlying communications, we classified the post-infection traffic into three categories:
- **Scanning traffic**
- **Attacking traffic**
- **C&C traffic**

**Methodology:**
- Focused on days with more than 10K connections for TCP and UDP separately.
- Identified the largest hourly TCP and UDP traffic and the top three ports.
- Classified periods based on the volume of traffic on the top three ports.

**Results:**
- Both the Netgear and Brickcom honeypots show similar volumes of TCP/UDP traffic.
- UDP traffic covers a wider range of ports in attack scenarios compared to TCP traffic, while the number of ports in scan scenarios is comparable for both protocols.
- Preliminary conclusion: TCP attacks focused on a more limited number of ports than UDP attacks.

### Distributed Denial of Service Attacks
IoT botnets are primarily used to launch DDoS attacks. We estimated the total number of DDoS attacks launched from our honeypots:
- **Total DDoS attacks:** 41
- **Average packets per attack:** 141,962
- **Average duration:** 143 seconds
- **Average packets per second:** 993
- **Protocol distribution:** 37 attacks over UDP, 4 over TCP
- **Target distribution:** 38 attacks targeted a single IP address

**Notable attacks:**
- Four DNS (53/udp) attacks at 6K packets per second, with 25 to 54 Mb/s of traffic.
- One TCP SYN (25565/tcp) attack at 3K packets per second, with 1Mb/s of traffic.
- Targets included online gaming servers (Steam and Minecraft) and hosting providers.

### 4 Related Work
**IoT Honeypots:**
- **ScriptGen [Leita et al., 2005]:** One of the earliest efforts in building high-interaction honeypots.
- **IoTCandyJar [Luo et al., 2017]:** Captures attacker requests and uses machine learning to build interaction models.
- **Siphon [Guarnizo et al., 2017]:** Scalable high-interaction honeypot infrastructure backed by real IoT devices.
- **IoTPoT [Pa et al., 2015]:** Telnet-based IoT honeypot.
- **ThingPot [Wang et al., 2017]:** Proof-of-concept honeypot for Philips HUE light bulbs.

**Embedded Device Security and IoT Botnets:**
- **Cui et al. [2010]:** Reported on over 500K devices with weak or default credentials.
- **Internet Census [2012]:** Confirmed the trend of insecure embedded devices.
- **Costin et al. [2014, 2016]:** Performed extensive vulnerability assessments of IoT device firmware.
- **Avatar [Zaddach et al., 2014] and Firmadyne [Chen et al., 2016]:** Provided emulation environments for embedded devices.
- **Mirai Botnet [Antonakakis et al., 2017]:** Forensic study of the Mirai botnet.
- **IoTPot [Pa et al., 2015]:** Analyzed telnet-based intrusions and malware behavior.
- **Linux Malware [Cozzi et al., 2018]:** Described trends in Linux and IoT malware behavior.

### 5 Conclusion
Using six months of data from our honeypots, enriched with various reputation feeds and binary analyses, we reported on the current threats targeting IoT devices. Attackers still heavily rely on brute-forcing remote management interfaces, but an increasing number of botnets are equipped with exploits targeting a wide range of software vulnerabilities. Mirai-powered botnets dominate the IoT threat landscape, but new and old players like Hajime and IoT Reaper are also active. While DDoS attacks remain the core business, some emerging botnets have yet to reveal their true purpose. The sophistication of the IoT threat ecosystem is rapidly evolving, and proactive measures are needed to anticipate and mitigate these threats.

### References
1. Shodan. <https://www.shodan.io/>
2. VirusTotal. <https://www.virustotal.com/>
3. Internet Census (2012). <http://census2012.sourceforge.net/paper.html>
4. CVE-2016-1555 (2016). <https://nvd.nist.gov/vuln/detail/CVE-2016-1555>
5. CVE-2016-5681 (2017). <https://nvd.nist.gov/vuln/detail/CVE-2016-5681>
6. CVE-2017-17107 (2017). <https://nvd.nist.gov/vuln/detail/CVE-2017-17107>
7. Antonakakis, M., et al.: Understanding the mirai botnet. In: USENIX Security Symposium (2017)
8. Anubhav, A.: Agile QBot variant adds NbotLoader Netgear Bug in its new update, July 2017. <https://blog.newskysecurity.com/agile-122bf2f4e2f3>
9. Anubhav, A.: Masuta : Satori creators’ second botnet weaponizes a new router exploit, January 2018. <https://blog.newskysecurity.com/masuta-satori-creators-second-botnet-weaponizes-a-new-router-exploit-2ddc51cc52a7>
10. Checkpoint: IoTroop Botnet: the full investigation, October 2017. <https://research.checkpoint.com/iotroop-botnet-full-investigation/>
11. Chen, D.D., Woo, M., Brumley, D., Egele, M.: Towards automated dynamic analysis for Linux-based embedded firmware. In: NDSS, February 2016
12. Costin, A., Zaddach, J., Francillon, A., Balzarotti, D.: A large scale analysis of the security of embedded firmwares. In: USENIX Security Symposium (2014)
13. Costin, A., Zarras, A., Francillon, A.: Automated dynamic firmware analysis at scale: a case study on embedded web interfaces. In: ASIACCS, May 2016
14. Cozzi, E., Graziano, M., Fratantonio, Y., Balzarotti, D.: Understanding Linux malware. In: IEEE Symposium on Security and Privacy, May 2018
15. Cui, A., Stolfo, S.J.: A quantitative analysis of the insecurity of embedded network devices: results of a wide-area scan. In: ACSAC, December 2010
16. Edwards, S., Profetis, I.: Hajime: analysis of a decentralized internet worm for IoT devices. Rapidity Netw. (2016)
17. Embedi: enlarge your botnet with: top D-Link routers, September 2017. <https://embedi.com/blog/enlarge-your-botnet-top-d-link-routers-dir8xx-d-link-routers-cruisin-bruisin/>
18. Guarnizo, J.D., et al.: Siphon: towards scalable high-interaction physical honeypots. In: CPSS, April 2017
19. Kim, P.: Pwning the Dlink 850L routers and abusing the MyDlink Cloud protocol, September 2017. <https://pierrekim.github.io/blog/2017-09-08-dlink-850l-mydlink-cloud-0days-vulnerabilities.html>
20. Krebs, B.: Who is Anna-Senpai, the Mirai worm author? January 2017. <https://krebsonsecurity.com/2017/01/who-is-anna-senpai-the-mirai-worm-author/>
21. Kumar, M.: Advanced Malware targeting Internet of the Things and Routers, March 2016. <https://thehackernews.com/2016/03/internet-of-thing-malware.html>
22. Leita, C., Mermoud, K., Dacier, M.: Scriptgen: an automated script generation tool for honeyd. In: ACSAC, December 2005
23. Luo, T., Xu, Z., Jin, X., Jia, Y., Ouyang, X.: IoTCandyJar: towards an intelligent-interaction honeypot for IoT devices. In: Blackhat, USA, July 2017
24. Offensive Security: D-Link Devices - UPnP SOAP TelnetD command execution (Metasploit), September 2013. <https://www.exploit-db.com/exploits/28333/>
25. Offensive Security: Remote buffer overflow in cookie header, June 2014. <https://www.exploit-db.com/exploits/33863/>
26. Offensive Security: D-Link DIR-890L/R - Multiple buffer overflow vulnerabilities, November 2015. <https://www.exploit-db.com/exploits/38716/>
27. Offensive Security: Brickcom corporation network cameras - multiple vulnerabilities, April 2016. <https://www.exploit-db.com/exploits/39696/>
28. Offensive Security: Brickcom IP Camera - credentials disclosure, July 2017. <https://www.exploit-db.com/exploits/42588/>
29. Offensive Security: SSD advisory - D-Link 850L multiple vulnerabilities, August 2017. <https://blogs.securiteam.com/index.php/archives/3364>
30. Pa, Y.M.P., Suzuki, S., Yoshioka, K., Matsumoto, T., Kasama, T., Rossow, C.: IoTPOT: analysing the rise of IoT compromises. In: WOOT, August 2015
31. Wang, M., Santillan, J., Kuipers, F.: ThingPot: an interactive IoT honeypot (2017)
32. Zaddach, J., Bruno, L., Francillon, A., Balzarotti, D.: Avatar: a framework to support dynamic security analysis of embedded systems’ firmwares. In: NDSS, February 2014