# 《计算机安全》第五版
## 第四章：操作系统
授课教师：高海波  
河南中医药大学 信息管理与信息系统教研室

---

## 第五章 目标
- 操作系统提供的基本安全功能
- 需要操作系统保护的系统资源
- 操作系统设计原则
- 操作系统如何控制对资源的访问
- 可信计算的历史
- 操作系统 rootkit 的特性

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 操作系统功能
- **用户界面**：同步、并发控制、死锁
- **操作服务**：管理、通信、记账
- **资源分配**：数据、CPU、内存、程序库、I/O 设备

---

## 操作系统历史
- **单用户系统**：无操作系统
- **多道程序操作系统**（也称监控程序）：
  - 多个用户
  - 多个程序
  - 调度、共享、并发使用
- **个人计算机**

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 受保护对象
- 内存
- 可共享 I/O 设备，如磁盘
- 串行使用的 I/O 设备，如打印机
- 可共享的程序和子程序
- 网络
- 可共享的数据

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 操作系统的分层设计
- **用户进程**
  - 编译器、数据库管理器
  - 实用功能
  - 文件系统、设备分配
- **操作系统**
  - 调度、共享、内存管理
  - 同步、分配
- **安全功能**
- **内核**
  - 安全内核
  - 硬件

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 功能跨越层次
- 最不信任代码
  - 用户认证模块
  - 用户界面
  - 用户 ID 查找
- 最信任代码
  - 认证
  - 数据比较
  - 认证数据更新

---

## 模块化设计
- **用户模式**
  - 用户界面
  - 文件
  - 对象
  - A/V
  - 网络
  - 备份
  - Shell
- **系统服务接口**
  - I/O
  - 时间同步
  - 内存
  - 通信
  - 安全
- **基础服务**
  - 微内核
- **内核模式驱动**
  - 硬件接口和抽象
  - 硬件

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 虚拟化
- 通过虚拟化，操作系统向每个用户仅呈现该用户应看到的资源。
- 用户可以访问一个虚拟机 (VM)，其中包含这些资源。
- 用户无法访问操作系统可用但存在于 VM 之外的资源。
- 虚拟机监视器 (hypervisor) 是实现 VM 的软件。
- 在 VM 和操作系统之间转换访问请求。
- 可以同时支持多个在 VM 中运行的操作系统。
- 诱饵蜜罐 (Honeypot)：一种用于引诱攻击者进入可控且可监控环境的 VM。

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 分离与共享
- **分离方法**：
  - 物理分离
  - 时间分离
  - 逻辑分离
  - 加密分离
- **支持分离/共享的方法**：
  - 不进行保护
  - 隔离
  - 全部共享或完全不共享
  - 共享但限制访问
  - 限制对象的使用

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 硬件对内存的保护
- **内存地址**
  - 0
  - 操作系统限制
  - n
  - n+1
  - 用户程序空间
  - 地址范围
  - 高地址

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 栅栏寄存器
- **地址限制寄存器**
  - 地址
  - 寄存器
  - n+1
  - p+1
  - 内存地址
  - 操作系统版本 1
  - 操作系统版本 2
  - n
  - p
  - 用户程序空间
  - 地址范围
  - 高地址

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 基址/限址寄存器
- **内存地址**
  - 0
  - 操作系统
  - 基址寄存器
  - n
  - n+1
  - 用户 A 程序空间
  - 限址寄存器
  - p
  - p+1
  - 用户 B 程序空间
  - b
  - 用户 C 程序空间
  - 高地址

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 两对基址/限址寄存器
- **操作系统**
  - 用户 A 数据基址
  - 用户 A 程序空间
  - 用户 B 数据限址
  - 用户 A 数据空间
  - 用户 C 程序空间
  - 用户 C 数据空间
  - 用户 B 程序限址
  - 用户 B 程序空间

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 标签架构
- **标签**
  - 内存字
  - R 0001
  - RW 0137
  - R 0099
  - X
  - X
  - X
  - wh
  - X
  - X
  - X
  - 11
  - R 4091
  - RW 0002
- **代码**：
  - R = 只读
  - RW = 读/写
  - X = 仅执行

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 分段
- **物理放置**
  - 程序段
- **逻辑排列**
  - 操作系统
  - MAIN 段
  - SEG_A
  - SUB
  - DATA_SEG
  - 其他用户的段

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 段地址翻译
- **段翻译表**
  - 地址
  - MAIN
  - SEG_A
  - SUB
  - DATA_SEG
  - 获取
  - DATA_SEG 段中的位置 20

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 分页
- **页翻译表**
  - 内存地址
  - 逻辑程序
  - 页地址
  - 页 0
  - 页 1
  - 页 2
  - 页 3
  - 页 4
  - 页 5
  - 页 6
  - 页 7
  - 获取
  - 页 4 中的位置 37

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 分页分段
- **段翻译表**
  - 页
  - 内存地址
  - 段表
  - 逻辑程序
  - SEG_A
  - 对于段 MAIN
  - 页翻译表
  - 页地址
  - MAIN 页 0
  - SUB 页 0
  - DATA_SEG 页 0
  - 获取
  - 对于段 SEG_A
  - 页地址
  - SEG_A 页 1
  - 对于段 SUB
  - 页地址
  - 对于段 DATA_SEG
  - 页地址
  - 页 0 中的位置 20

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 安全操作系统设计原则
- **简单的设计**
  - 操作系统本质上是复杂的，任何不必要的复杂性只会使其更难理解和安全。
- **分层设计**
  - 使信任分层成为可能。
- **分层信任**
  - 分层既是一种保持设计逻辑和易于理解的方法，也是一种限制风险的方法。
  - 例如：对关键 OS 功能实施严格的访问控制，对重要的非关键功能实施较少的访问控制，而对不重要的功能则几乎不实施访问控制。

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 内核化设计
- **内核**是操作系统中执行最低级功能的部分。
  - 同步
  - 进程间通信
  - 消息传递
  - 中断处理
- **安全内核**负责执行整个操作系统的安全机制。
  - 通常包含在内核中。

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 引用监视器
- **操作系统**
  - 可信软件
  - 引用监视器

---

## 可信系统
- **可信系统**是经过验证能够忠实地执行某些活动的系统。
- **可信系统的特征**：
  - 明确的安全策略，详细说明其强制执行的安全质量。
  - 独立审查或评估，确保所选机制正确实施。

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 可信系统的历史
- **安全控制**
  - E.C. 信息技术
  - 计算机系统
  - 安全评估
  - 可信计算机标准
  - 通用标准
  - 1970
  - 1983
  - 1991
  - 1994
  - 1988
  - 1992
  - 安全技术
  - 英国、德国、法国联合标准

---

## 可信计算基 (TCB)
- **用户应用**
  - 实用工具
  - 用户请求解释器
  - 用户进程协调、同步
  - 非 TCB
  - 用户环境：对象、名称（如文件）
  - 用户 I/O
  - 程序、用户进程
  - 创建和删除用户对象
  - 目录
  - 扩展类型
  - 分段、分页、内存管理
  - 基本 I/O
  - 基本操作
  - 时钟、定时
  - TCB
  - 中断处理
  - 硬件：寄存器、内存
  - 能力

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 其他可信系统特征
- **安全启动**
  - 系统启动是一个安全敏感的时间点，大多数系统在加载安全功能之前会先加载基本 I/O 功能。
- **可信路径**
  - 一种不可伪造的连接，用户可以通过它直接与操作系统通信。
- **对象重用控制**
  - 防止已删除的对象数据被重新使用，从而避免泄露敏感信息。
- **审计**
  - 可信系统跟踪与安全相关的更改，如新程序的安装或操作系统修改。

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## Rootkit
- **Rootkit** 是一种恶意软件包，它可以获取并利用 root 权限，或者实际上成为操作系统的一部分。
- Rootkit 经常采取各种手段来避免被发现，或者即使被发现并部分移除后，也能重新建立自身。
  - 这包括拦截或修改基本操作系统功能。

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## Rootkit 逃避检测
- **Will call's**
  - 拦截函数调用
  - 结果是否揭示 rootkit？
  - 否
  - 将调用传递给操作系统
  - 执行调用但监控结果并根据需要调整

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。

---

## 总结
- **操作系统**从支持单用户和单程序发展到支持多用户和多程序。
- **需要操作系统保护的资源**：内存、I/O 设备、程序和网络。
- **分层设计**有助于将关键功能与非关键功能分开。
- **资源访问控制**可以通过多种方式实施，包括虚拟化、分段、硬件内存保护和引用监视器。
- **Rootkit** 是一种恶意软件包，可以获取 root 权限或实际上成为操作系统的一部分。

摘自《计算机安全》第五版，作者 Charles P. Pfleeger 等 (ISBN: 9780134085043)。版权所有 © 2015 Pearson Education, Inc. 保留所有权利。