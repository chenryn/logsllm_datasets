### Real-World Validation and Experimental Setup

#### Assumption Violations in Real-World Scenarios
In real-world scenarios, the assumptions of no cross-traffic in the access link and no congestion in interdomain links can be violated. Cross-traffic can occur on the access link, and congestion in interdomain links may be caused by a small number of flows, especially as access link speeds increase.

To evaluate our classifier under these relaxed assumptions, we conducted several experiments. First, we fixed the access link speed at 50 Mbps and reduced the number of cross-traffic processes generated by TGcong from 100 to 50, 20, and 10. As the number of cross-traffic processes decreased, the throughput of our test flow increased due to reduced competition. This led to higher buffer occupancy for our flow, potentially leading the classifier to incorrectly conclude that congestion is self-induced. In our experiments, the fraction of flows correctly classified as externally congested decreased from 93% with 100 concurrent flows to 84% with 50, 74% with 20, and 50% with 10.

We also introduced cross-traffic in the access link with 1, 2, and 5 concurrent flows. Even with 1 cross-flow, our test flow did not achieve full throughput but still obtained significant buffer space, leading the classifier to classify 86% of flows as self-limited. With 5 flows, this number dropped to 70%. In both cases, TCP's sharing mechanism allowed our test flow to obtain significant buffer occupancy, which influenced the buffer behavior captured by our technique.

### Real-World Validation Using M-Lab Data

We validated our model using two real-world datasets from M-Lab: the Dispute2014 dataset and the TSLP2017 dataset.

#### The Dispute2014 Dataset
The Dispute2014 dataset spans the timeframe of a well-publicized peering dispute involving Cogent, a major transit provider, and several large US ISPs in 2014. The second dataset, TSLP2017, consists of targeted experiments conducted in 2017 between a client in the Comcast access network in Massachusetts and an M-Lab server hosted by TATA in New York. We chose this combination because the interdomain link between the two ISPs experienced periods of congestion during our experiments, inferred using the Time Series Latency Probes (TSLP) methodology.

##### M-Lab and NDT
M-Lab's infrastructure includes over 200 servers in more than 30 hosting networks globally, offering various network performance tests such as NDT, Glasnost, and Mobiperf. Our study focuses on the Network Diagnostic Test (NDT), a user-initiated web-based test measuring upstream and downstream throughput. For each NDT measurement, the server logs Web100 statistics, providing TCP performance data over 5 ms intervals, including RTT, bytes/packets sent/received, congestion window, and time spent in different states. Raw packet traces are also stored in pcap format and are available through Google’s Big Query and Big Store.

##### Pre-processing the NDT Data
We filtered the M-Lab data to focus on flows experiencing congestion. We selected NDT measurements with downstream tests lasting at least 9 seconds and spending at least 90% of the test duration in the congestion-limited state. This excluded flows that were sender- or receiver-limited or did not experience congestion for other reasons. These filters are consistent with those used in M-Lab's 2014 report on interdomain congestion.

##### The Peering Disputes of 2013/2014
In late 2013 and early 2014, media reports highlighted poor Netﬂix performance on several access ISPs that did not peer directly with Netﬂix. Throughput traces from M-Lab NDT showed strong diurnal patterns, with significantly lower throughput during peak hours. This was evident in tests from Cogent servers to ISPs like Comcast, Time Warner, and Verizon, except Cox, which had a direct peering agreement with Netﬂix. Figure 5a illustrates the diurnal throughput performance, showing a substantial drop in throughput during peak hours for all ISPs except Cox. Other transit ISPs like Level3 did not show such diurnal patterns (Figure 5b). M-Lab's report concluded that the cause was peak-time congestion in interdomain links connecting Cogent to the affected ISPs. Independent studies confirmed congestion at ISP borders.

##### Collecting and Labeling Dispute2014
We labeled peak hour (4 PM to 12 AM local time) tests in January and February from affected ISPs (Comcast, Time Warner, and Verizon) as externally congested. Off-peak tests in March and April (1 AM to 8 AM local time) were labeled as self-induced congestion limited. We assumed off-peak throughput tests were limited by access-link capacities, based on FCC reports. However, our labeling is broad and imperfect. We considered two transit ISPs (Cogent and Level3) and four access ISPs (Comcast, TimeWarner, Verizon, and Cox), with Cox serving as a control due to its unaffected performance.

#### The TSLP2017 Dataset
The TSLP2017 dataset is smaller but more precisely labeled. We ran targeted experiments to find an interdomain link that was periodically congested and could be reliably identified. Using the TSLP technique, we identified a congested link between Comcast and TATA in New York City, with latency increasing from a baseline of 18 ms to above 30 ms during peak hours.

##### Collecting TSLP2017
We conducted periodic, automated NDT measurements between an Ark node in Comcast's network in Bedford, Massachusetts, and a TATA server in New York. The baseline service plan for the Comcast user was 25 Mbps downlink. We ran throughput tests every hour during off-peak hours and every 15 minutes during peak hours from February 15 to April 30, 2017.

##### Labeling TSLP2017
We labeled a test as externally limited if the throughput was less than 15 Mbps and the minimum latency was greater than 30 ms; otherwise, it was labeled as access-link congested. This ensured that tests labeled as externally limited were conducted during periods of elevated latency. Over 10 weeks, we collected 2593 NDT tests, of which 20 were labeled as externally congested and the rest as self-induced. The low number of external congestion events highlights the difficulty of obtaining real-world congestion data.

### Conclusion
Our experiments and real-world validation using M-Lab data demonstrate the effectiveness of our classifier under various conditions, including the presence of cross-traffic and interdomain congestion. The results provide valuable insights into the behavior of TCP flows under different types of congestion, validating our approach in real-world scenarios.