### Session 3C: Inference Attacks
**CCS '21, November 15–19, 2021, Virtual Event, Republic of Korea**

#### References
1. **Battista Biggio, Igino Corona, Davide Maiorca, Blaine Nelson, Nedim Srndic, Pavel Laskov, Giorgio Giacinto, and Fabio Roli.**
   - **Title:** Evasion Attacks against Machine Learning at Test Time.
   - **Conference:** European Conference on Machine Learning and Principles and Practice of Knowledge Discovery in Databases (ECML/PKDD).
   - **Pages:** 387–402.
   - **Publisher:** Springer.
   - **Year:** 2013.

2. **Iván Cantador, Peter Brusilovsky, and Tsvi Kuflik.**
   - **Title:** Second Workshop on Information Heterogeneity and Fusion in Recommender Systems (HetRec2011).
   - **Conference:** ACM Conference on Recommender Systems (RecSys).
   - **Pages:** 387–388.
   - **Publisher:** ACM.
   - **Year:** 2011.

3. **Nicholas Carlini, Chang Liu, Úlfar Erlingsson, Jernej Kos, and Dawn Song.**
   - **Title:** The Secret Sharer: Evaluating and Testing Unintended Memorization in Neural Networks.
   - **Conference:** USENIX Security Symposium (USENIX Security).
   - **Pages:** 267–284.
   - **Publisher:** USENIX.
   - **Year:** 2019.

4. **Nicholas Carlini, Florian Tramèr, Eric Wallace, Matthew Jagielski, Ariel Herbert-Voss, Katherine Lee, Adam Roberts, Tom B. Brown, Dawn Song, Úlfar Erlingsson, Alina Oprea, and Colin Raffel.**
   - **Title:** Extracting Training Data from Large Language Models.
   - **Journal:** CoRR abs/2012.07805.
   - **Year:** 2020.

5. **Nicholas Carlini and David Wagner.**
   - **Title:** Towards Evaluating the Robustness of Neural Networks.
   - **Conference:** IEEE Symposium on Security and Privacy (S&P).
   - **Pages:** 39–57.
   - **Publisher:** IEEE.
   - **Year:** 2017.

6. **Dingfan Chen, Ning Yu, Yang Zhang, and Mario Fritz.**
   - **Title:** GAN-Leaks: A Taxonomy of Membership Inference Attacks against Generative Models.
   - **Conference:** ACM SIGSAC Conference on Computer and Communications Security (CCS).
   - **Pages:** 343–362.
   - **Publisher:** ACM.
   - **Year:** 2020.

7. **Wanyu Chen, Fei Cai, Honghui Chen, and Maarten de Rijke.**
   - **Title:** Joint Neural Collaborative Filtering for Recommender Systems.
   - **Journal:** ACM Transactions on Information Systems.
   - **Year:** 2019.

8. **Christopher A. Choquette Choo, Florian Tramèr, Nicholas Carlini, and Nicolas Papernot.**
   - **Title:** Label-Only Membership Inference Attacks.
   - **Journal:** CoRR abs/2007.14321.
   - **Year:** 2020.

9. **Mukund Deshpande and George Karypis.**
   - **Title:** Item-Based Top-N Recommendation Algorithms.
   - **Journal:** ACM Transactions on Information Systems.
   - **Year:** 2004.

10. **Tianyu Gu, Brendan Dolan-Gavitt, and Siddharth Grag.**
    - **Title:** Badnets: Identifying Vulnerabilities in the Machine Learning Model Supply Chain.
    - **Journal:** CoRR abs/1708.06733.
    - **Year:** 2017.

11. **F. Maxwell Harper and Joseph A Konstan.**
    - **Title:** The MovieLens Datasets: History and Context.
    - **Journal:** ACM Transactions on Interactive Intelligent Systems.
    - **Year:** 2015.

12. **Jamie Hayes, Luca Melis, George Danezis, and Emiliano De Cristofaro.**
    - **Title:** LOGAN: Evaluating Privacy Leakage of Generative Models Using Generative Adversarial Networks.
    - **Conference:** Symposium on Privacy Enhancing Technologies Symposium.
    - **Year:** 2019.

13. **Ruining He and Julian McAuley.**
    - **Title:** Ups and Downs: Modeling the Visual Evolution of Fashion Trends with One-Class Collaborative Filtering.
    - **Conference:** The Web Conference (WWW).
    - **Pages:** 507–517.
    - **Publisher:** ACM.
    - **Year:** 2016.

14. **Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua.**
    - **Title:** Neural Collaborative Filtering.
    - **Conference:** International Conference on World Wide Web (WWW).
    - **Pages:** 173–182.
    - **Publisher:** ACM.
    - **Year:** 2017.

15. **Xiangnan He, Hanwang Zhang, Min-Yen Kan, and Tat-Seng Chua.**
    - **Title:** Fast Matrix Factorization for Online Recommendation with Implicit Feedback.
    - **Conference:** International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR).
    - **Pages:** 549–558.
    - **Publisher:** ACM.
    - **Year:** 2016.

16. **Xinlei He, Jinyuan Jia, Michael Backes, Neil Zhenqiang Gong, and Yang Zhang.**
    - **Title:** Stealing Links from Graph Neural Networks.
    - **Conference:** USENIX Security Symposium (USENIX Security).
    - **Publisher:** USENIX.
    - **Year:** 2021.

17. **Jonathan L. Herlocker, Joseph A. Konstan, and John Riedl.**
    - **Title:** Explaining Collaborative Filtering Recommendations.
    - **Conference:** ACM Conference on Computer Supported Cooperative Work (CSCW).
    - **Pages:** 241–250.
    - **Publisher:** ACM.
    - **Year:** 2000.

18. **Matthew Jagielski, Nicholas Carlini, David Berthelot, Alex Kurakin, and Nicolas Papernot.**
    - **Title:** High Accuracy and High Fidelity Extraction of Neural Networks.
    - **Conference:** USENIX Security Symposium (USENIX Security).
    - **Pages:** 1345–1362.
    - **Publisher:** USENIX.
    - **Year:** 2020.

19. **Matthew Jagielski, Alina Oprea, Battista Biggio, Chang Liu, Cristina Nita-Rotaru, and Bo Li.**
    - **Title:** Manipulating Machine Learning: Poisoning Attacks and Countermeasures for Regression Learning.
    - **Conference:** IEEE Symposium on Security and Privacy (S&P).
    - **Pages:** 19–35.
    - **Publisher:** IEEE.
    - **Year:** 2018.

20. **Jinyuan Jia, Ahmed Salem, Michael Backes, Yang Zhang, and Neil Zhenqiang Gong.**
    - **Title:** MemGuard: Defending against Black-Box Membership Inference Attacks via Adversarial Examples.
    - **Conference:** ACM SIGSAC Conference on Computer and Communications Security (CCS).
    - **Pages:** 259–274.
    - **Publisher:** ACM.
    - **Year:** 2019.

21. **George Karypis.**
    - **Title:** Evaluation of Item-Based Top-N Recommendation Algorithms.
    - **Conference:** ACM International Conference on Information and Knowledge Management (CIKM).
    - **Pages:** 247–254.
    - **Publisher:** ACM.
    - **Year:** 2001.

22. **Yehuda Koren.**
    - **Title:** Factorization Meets the Neighborhood: a Multifaceted Collaborative Filtering Model.
    - **Conference:** ACM Conference on Knowledge Discovery and Data Mining (KDD).
    - **Pages:** 426–434.
    - **Publisher:** ACM.
    - **Year:** 2008.

23. **Yehuda Koren.**
    - **Title:** Collaborative Filtering with Temporal Dynamics.
    - **Conference:** ACM Conference on Knowledge Discovery and Data Mining (KDD).
    - **Pages:** 447–456.
    - **Publisher:** ACM.
    - **Year:** 2009.

24. **Klas Leino and Matt Fredrikson.**
    - **Title:** Stolen Memories: Leveraging Model Memorization for Calibrated White-Box Membership Inference.
    - **Conference:** USENIX Security Symposium (USENIX Security).
    - **Pages:** 1605–1622.
    - **Publisher:** USENIX.
    - **Year:** 2020.

25. **Zheng Li, Chengyu Hu, Yang Zhang, and Shanqing Guo.**
    - **Title:** How to Prove Your Model Belongs to You: A Blind-Watermark based Framework to Protect Intellectual Property of DNN.
    - **Conference:** Annual Computer Security Applications Conference (ACSAC).
    - **Pages:** 126–137.
    - **Publisher:** ACM.
    - **Year:** 2019.

26. **Zheng Li and Yang Zhang.**
    - **Title:** Membership Leakage in Label-Only Exposures.
    - **Conference:** ACM SIGSAC Conference on Computer and Communications Security (CCS).
    - **Publisher:** ACM.
    - **Year:** 2021.

27. **Luca Melis, Congzheng Song, Emiliano De Cristofaro, and Vitaly Shmatikov.**
    - **Title:** Exploiting Unintended Feature Leakage in Collaborative Learning.
    - **Conference:** IEEE Symposium on Security and Privacy (S&P).
    - **Pages:** 497–512.
    - **Publisher:** IEEE.
    - **Year:** 2019.

28. **Milad Nasr, Reza Shokri, and Amir Houmansadr.**
    - **Title:** Machine Learning with Membership Privacy using Adversarial Regularization.
    - **Conference:** ACM SIGSAC Conference on Computer and Communications Security (CCS).
    - **Pages:** 634–646.
    - **Publisher:** ACM.
    - **Year:** 2018.

29. **Milad Nasr, Reza Shokri, and Amir Houmansadr.**
    - **Title:** Comprehensive Privacy Analysis of Deep Learning: Passive and Active White-box Inference Attacks against Centralized and Federated Learning.
    - **Conference:** IEEE Symposium on Security and Privacy (S&P).
    - **Pages:** 1021–1035.
    - **Publisher:** IEEE.
    - **Year:** 2019.

30. **Milad Nasr, Shuang Song, Abhradeep Thakurta, Nicolas Papernot, and Nicholas Carlini.**
    - **Title:** Adversary Instantiation: Lower Bounds for Differentially Private Machine Learning.
    - **Conference:** IEEE Symposium on Security and Privacy (S&P).
    - **Publisher:** IEEE.
    - **Year:** 2021.

31. **Nicolas Papernot, Patrick McDaniel, Arunesh Sinha, and Michael Wellman.**
    - **Title:** SoK: Towards the Science of Security and Privacy in Machine Learning.
    - **Conference:** IEEE European Symposium on Security and Privacy (Euro S&P).
    - **Pages:** 399–414.
    - **Publisher:** IEEE.
    - **Year:** 2018.

32. **Nicolas Papernot, Shuang Song, Ilya Mironov, Ananth Raghunathan, Kunal Talwar, and Úlfar Erlingsson.**
    - **Title:** Scalable Private Learning with PATE.
    - **Conference:** International Conference on Learning Representations (ICLR).
    - **Year:** 2018.

33. **Michael J. Pazzani and Daniel Billsus.**
    - **Title:** Content-Based Recommendation Systems.
    - **Book:** The Adaptive Web, Methods and Strategies of Web Personalization.
    - **Pages:** 325–341.
    - **Publisher:** Springer.
    - **Year:** 2007.

34. **Huseyin Polat and Wenliang Du.**
    - **Title:** SVD-based Collaborative Filtering with Privacy.
    - **Conference:** ACM Symposium on Applied Computing (SAC).
    - **Pages:** 791–795.
    - **Publisher:** ACM.
    - **Year:** 2005.

35. **Alexandre Sablayrolles, Matthijs Douze, Cordelia Schmid, Yann Ollivier, and Hervé Jégou.**
    - **Title:** White-box vs Black-box: Bayes Optimal Strategies for Membership Inference.
    - **Conference:** International Conference on Machine Learning (ICML).
    - **Pages:** 5558–5567.
    - **Publisher:** PMLR.
    - **Year:** 2019.

36. **Ruslan Salakhutdinov and Andriy Mnih.**
    - **Title:** Probabilistic Matrix Factorization.
    - **Conference:** Annual Conference on Neural Information Processing Systems (NIPS).
    - **Pages:** 1257–1264.
    - **Publisher:** NIPS.
    - **Year:** 2007.

37. **Ahmed Salem, Yang Zhang, Mathias Humbert, Pascal Berrang, Mario Fritz, and Michael Backes.**
    - **Title:** ML-Leaks: Model and Data Independent Membership Inference Attacks and Defenses on Machine Learning Models.
    - **Conference:** Network and Distributed System Security Symposium (NDSS).
    - **Publisher:** Internet Society.
    - **Year:** 2019.

38. **Badrul Munir Sarwar, George Karypis, Joseph A. Konstan, and John Riedl.**
    - **Title:** Item-Based Collaborative Filtering Recommendation Algorithms.
    - **Conference:** International Conference on World Wide Web (WWW).
    - **Pages:** 285–295.
    - **Publisher:** ACM.
    - **Year:** 2001.

39. **J. Ben Schafer, Dan Frankowski, Jon Herlocker, and Shilad Sen.**
    - **Title:** Collaborative Filtering Recommender Systems.
    - **Book:** The Adaptive Web, Methods and Strategies of Web Personalization.
    - **Pages:** 291–324.
    - **Publisher:** Springer.
    - **Year:** 2007.

40. **Virat Shejwalkar and Amir Houmansadr.**
    - **Title:** Membership Privacy for Machine Learning Models Through Knowledge Transfer.
    - **Conference:** AAAI Conference on Artificial Intelligence (AAAI).
    - **Publisher:** AAAI.
    - **Year:** 2021.

41. **Reza Shokri, Marco Stronati, Congzheng Song, and Vitaly Shmatikov.**
    - **Title:** Membership Inference Attacks Against Machine Learning Models.
    - **Conference:** IEEE Symposium on Security and Privacy (S&P).
    - **Pages:** 3–18.
    - **Publisher:** IEEE.
    - **Year:** 2017.

42. **Reza Shokri, Georgios Theodorakopoulos, Jean-Yves Le Boudec, and Jean-Pierre Hubaux.**
    - **Title:** Quantifying Location Privacy.
    - **Conference:** IEEE Symposium on Security and Privacy (S&P).
    - **Pages:** 247–262.
    - **Publisher:** IEEE.
    - **Year:** 2011.

43. **Congzheng Song and Vitaly Shmatikov.**
    - **Title:** Auditing Data Provenance in Text-Generation Models.
    - **Conference:** ACM Conference on Knowledge Discovery and Data Mining (KDD).
    - **Pages:** 196–206.
    - **Publisher:** ACM.
    - **Year:** 2019.

44. **Peijie Sun, Le Wu, and Meng Wang.**
    - **Title:** Attentive Recurrent Social Recommendation.
    - **Conference:** International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR).
    - **Pages:** 185–194.
    - **Publisher:** ACM.
    - **Year:** 2018.

45. **Peijie Sun, Le Wu, Kun Zhang, Yanjie Fu, Richang Hong, and Meng Wang.**
    - **Title:** Dual Learning for Explainable Recommendation: Towards Unifying User Preference Prediction and Review Generation.
    - **Conference:** The Web Conference (WWW).
    - **Pages:** 837–847.
    - **Publisher:** ACM.
    - **Year:** 2020.

46. **Florian Tramèr, Alexey Kurakin, Nicolas Papernot, Ian Goodfellow, Dan Boneh, and Patrick McDaniel.**
    - **Title:** Ensemble Adversarial Training: Attacks and Defenses.
    - **Conference:** International Conference on Learning Representations (ICLR).
    - **Year:** 2017.

47. **Florian Tramèr, Fan Zhang, Ari Juels, Michael K. Reiter, and Thomas Ristenpart.**
    - **Title:** Stealing Machine Learning Models via Prediction APIs.
    - **Conference:** USENIX Security Symposium (USENIX Security).
    - **Pages:** 601–618.
    - **Publisher:** USENIX.
    - **Year:** 2016.

48. **Laurens van der Maaten and Geoffrey Hinton.**
    - **Title:** Visualizing Data using t-SNE.
    - **Journal:** Journal of Machine Learning Research.
    - **Year:** 2008.

49. **Bogdan Walek and Vladimir Fojtik.**
    - **Title:** A Hybrid Recommender System for Recommending Relevant Movies Using An Expert System.
    - **Journal:** Expert Systems with Applications.
    - **Year:** 2020.

50. **Samuel Yeom, Irene Giacomelli, Matt Fredrikson, and Somesh Jha.**
    - **Title:** Privacy Risk in Machine Learning: Analyzing the Connection to Overfitting.
    - **Conference:** IEEE Computer Security Foundations Symposium (CSF).
    - **Pages:** 268–282.
    - **Publisher:** IEEE.
    - **Year:** 2018.

### Defense Methodology

#### A.1 Methodology
In the original setting described in Section 2.5, non-members are provided with the most popular items. However, the most popular items for different users are the same, resulting in highly similar feature vectors for non-members, making them easily distinguishable. To address this, we propose a defense mechanism called **Popularity Randomization**.

**Popularity Randomization** works as follows:
1. **Sorting by Popularity:**
   - A recommender system \( \text{ARS} \) sorts all items by popularity:
     \[
     \text{ARS}: D_{\text{original}} \xrightarrow{\text{Sort}} S_{\text{sorted}},
     \]
     where \( D_{\text{original}} \) is the original dataset, and \( S_{\text{sorted}} \) is an ordered sequence of all items from \( D_{\text{original}} \). In \( S_{\text{sorted}} \), higher-ranked items are more popular.

2. **Selecting Candidates:**
   - Based on the number of recommendations and a preset ratio, the recommender system selects a subset of the most popular items as candidates:
     \[
     \alpha_{\text{PR}} = \frac{N_{\text{rec}}}{N_{\text{cand}}},
     \]
     \[
     S_{\text{cand}} = \{ x | x \in S_{\text{sorted}}, \text{Ind}_x \leq N_{\text{cand}} \},
     \]
     where \( \alpha_{\text{PR}} \) is the ratio of recommendations to candidates, \( S_{\text{cand}} \) is the sequence of candidate items, \( N_{\text{rec}} \) is the number of recommendations, \( N_{\text{cand}} \) is the number of candidates, and \( \text{Ind}_x \) is the index of \( x \) in \( S_{\text{sorted}} \).

3. **Random Selection:**
   - Non-members are randomly provided with items from the candidate set as recommendations:
     \[
     f(S_{\text{cand}}) = R_{\text{out}} (|R_{\text{out}}| = N_{\text{rec}}),
     \]
     where \( f(S_{\text{cand}}) \) is the function that randomly selects recommendations from \( S_{\text{cand}} \), and \( |R_{\text{out}}| \) is the number of recommendations to non-members, which is equal to \( N_{\text{rec}} \).

#### A.2 Visualization Results
We visualize user feature vectors using t-SNE to show the differences in the distributions between members and non-members in the shadow and target datasets. In Figure 14, red points represent feature vectors of members, and blue points represent feature vectors of non-members.

- **Figure 14a and 14b:** Comparison of feature vectors before and after deploying Popularity Randomization for the Item recommendation algorithm. The results show that Popularity Randomization decreases the differences between the feature vectors of members and non-members, significantly hindering the attack performance.
- **Figure 14c and 14d:** Similar comparison for the LFM recommendation algorithm. The visualization shows that the areas of red and blue points overlap less when using Item, leading to a strong attack performance. In contrast, many red points overlap with blue points when using LFM, resulting in poor attack performance.

#### A.3 Impacts on Recommendation Performances
We investigate the impact of Popularity Randomization on the performance of the target recommender. Figure 13 shows that the performance of the recommender only slightly drops. For example, when the target recommender uses Item on the ml-1m dataset, Popularity Randomization results in only a 2% drop in recommendation performance. Therefore, our proposed defense strategy effectively mitigates the attack risk while preserving the original recommendation performance.

### Figures
- **Figure 13:** Comparisons of recommendation performances before and after deploying the defense mechanism.
- **Figure 14:** Data distributions by t-SNE, showing the distribution of members (red points) and non-members (blue points) in the shadow and target recommenders using different algorithms with and without the defense mechanism.

**Note:** The figures and their captions should be included in the final document for visual reference.