### References

1. **Daniel Gruss, Raphael Spreitzer, and Stefan Mangard. 2015. Cache Template Attacks: Automating Attacks on Inclusive Last-Level Caches.**  
   *In 24th USENIX Security Symposium, USENIX Security 15, Washington, D.C., USA, August 12-14, 2015, Jaeyeon Jung and Thorsten Holz (Eds.).*  
   *USENIX Association, 897–912.*  
   *https://www.usenix.org/conference/usenixsecurity15/technical-sessions/presentation/gruss*

2. **Shay Gueron and Vlad Krasnov. 2015. Fast Prime Field Elliptic-Curve Cryptography with 256-bit Primes.**  
   *J. Cryptographic Engineering 5, 2 (2015), 141–151.*  
   *https://doi.org/10.1007/s13389-014-0090-x*

3. **Björn Haase and Benoît Labrique. 2017. Making Password Authenticated Key Exchange Suitable for Resource-Constrained Industrial Control Devices.**  
   *In Cryptographic Hardware and Embedded Systems - CHES 2017 - 19th International Conference, Taipei, Taiwan, September 25-28, 2017, Proceedings (Lecture Notes in Computer Science), Wieland Fischer and Naofumi Homma (Eds.), Vol. 10529.*  
   *Springer, 346–364.*  
   *https://doi.org/10.1007/978-3-319-66787-4_17*

4. **Ralf Hund, Carsten Willems, and Thorsten Holz. 2013. Practical Timing Side Channel Attacks Against Kernel Space ASLR.**  
   *In 20th Annual Network and Distributed System Security Symposium, NDSS 2013, San Diego, California, USA, February 24-27, 2013.*  
   *The Internet Society.*  
   *https://www.ndss-symposium.org/ndss2013/practical-timing-side-channel-attacks-against-kernel-space-aslr*

5. **Toshiya Itoh and Shigeo Tsujii. 1988. A Fast Algorithm for Computing Multiplicative Inverses in GF(2m) Using Normal Bases.**  
   *Inform. and Comput. 78, 3 (1988), 171–177.*  
   *https://doi.org/10.1016/0890-5401(88)90024-7*

6. **Josh Jaffe, Pankaj Rohatgi, and Marc Witteman. 2011. Efficient Side-Channel Testing for Public Key Algorithms: RSA Case Study.**  
   *In Non-Invasive Attack Testing Workshop, NIAT 2011, Nara, Japan, September 26-27, 2011. Proceedings. NIST.*  
   *https://csrc.nist.gov/CSRC/media/Events/Non-Invasive-Attack-Testing-Workshop/documents/09_Jaffe.pdf*

7. **Paul Kocher, Jann Horn, Anders Fogh, Daniel Genkin, Daniel Gruss, Werner Haas, Mike Hamburg, Moritz Lipp, Stefan Mangard, Thomas Prescher, Michael Schwarz, and Yuval Yarom. 2019. Spectre Attacks: Exploiting Speculative Execution.**  
   *In 2019 IEEE Symposium on Security and Privacy, SP 2019, Proceedings, 20-29 May 2019, San Francisco, California, USA. IEEE, 19–37.*  
   *https://doi.org/10.1109/SP.2019.00002*

8. **Paul C. Kocher. 1996. Timing Attacks on Implementations of Diffie-Hellman, RSA, DSS, and Other Systems.**  
   *In Advances in Cryptology - CRYPTO ’96, 16th Annual International Cryptology Conference, Santa Barbara, California, USA, August 18-22, 1996, Proceedings (Lecture Notes in Computer Science), Neal Koblitz (Ed.), Vol. 1109. Springer, 104–113.*  
   *https://doi.org/10.1007/3-540-68697-5_9*

9. **Paul C. Kocher, Joshua Jaffe, and Benjamin Jun. 1999. Differential Power Analysis.**  
   *In Advances in Cryptology - CRYPTO ’99, 19th Annual International Cryptology Conference, Santa Barbara, California, USA, August 15-19, 1999, Proceedings (Lecture Notes in Computer Science), Michael J. Wiener (Ed.), Vol. 1666. Springer, 388–397.*  
   *https://doi.org/10.1007/3-540-48405-1_25*

10. **Moritz Lipp, Daniel Gruss, Raphael Spreitzer, Clémentine Maurice, and Stefan Mangard. 2016. ARMageddon: Cache Attacks on Mobile Devices.**  
    *In 25th USENIX Security Symposium, USENIX Security 16, Austin, TX, USA, August 10-12, 2016, Thorsten Holz and Stefan Savage (Eds.). USENIX Association, 549–564.*  
    *https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/lipp*

11. **Moritz Lipp, Michael Schwarz, Daniel Gruss, Thomas Prescher, Werner Haas, Anders Fogh, Jann Horn, Stefan Mangard, Paul Kocher, Daniel Genkin, Yuval Yarom, and Mike Hamburg. 2018. Meltdown: Reading Kernel Memory from User Space.**  
    *In 27th USENIX Security Symposium, USENIX Security 2018, Baltimore, MD, USA, August 15-17, 2018, William Enck and Adrienne Porter Felt (Eds.). USENIX Association, 973–990.*  
    *https://www.usenix.org/conference/usenixsecurity18/presentation/lipp*

12. **Mingjie Liu, Jiazhe Chen, and Hexin Li. 2013. Partially Known Nonces and Fault Injection Attacks on SM2 Signature Algorithm.**  
    *In Information Security and Cryptology - 9th International Conference, Inscrypt 2013, Guangzhou, China, November 27-30, 2013, Revised Selected Papers (Lecture Notes in Computer Science), Dongdai Lin, Shouhuai Xu, and Moti Yung (Eds.), Vol. 8567. Springer, 343–358.*  
    *https://doi.org/10.1007/978-3-319-12087-4_22*

13. **Jake Longo, Elke De Mulder, Dan Page, and Michael Tunstall. 2015. SoC It to EM: ElectroMagnetic Side-Channel Attacks on a Complex System-on-Chip.**  
    *In Cryptographic Hardware and Embedded Systems - CHES 2015 - 17th International Workshop, Saint-Malo, France, September 13-16, 2015, Proceedings (Lecture Notes in Computer Science), Tim Güneysu and Helena Handschuh (Eds.), Vol. 9293. Springer, 620–640.*  
    *https://doi.org/10.1007/978-3-662-48324-4_31*

14. **Clémentine Maurice, Christoph Neumann, Olivier Heen, and Aurélien Francillon. 2015. C5: Cross-Cores Cache Covert Channel.**  
    *In Detection of Intrusions and Malware, and Vulnerability Assessment - 12th International Conference, DIMVA 2015, Milan, Italy, July 9-10, 2015, Proceedings (Lecture Notes in Computer Science), Magnus Almgren, Vincenzo Gulisano, and Federico Maggi (Eds.), Vol. 9148. Springer, 46–64.*  
    *https://doi.org/10.1007/978-3-319-20550-2_3*

15. **Christopher Meyer, Juraj Somorovsky, Eugen Weiss, Jörg Schwenk, Sebastian Schinzel, and Erik Tews. 2014. Revisiting SSL/TLS Implementations: New Bleichenbacher Side Channels and Attacks.**  
    *In Proceedings of the 23rd USENIX Security Symposium, San Diego, CA, USA, August 20-22, 2014, Kevin Fu and Jaeyeon Jung (Eds.). USENIX Association, 733–748.*  
    *https://www.usenix.org/conference/usenixsecurity14/technical-sessions/presentation/meyer*

16. **Peter L. Montgomery. 1987. Speeding the Pollard and Elliptic Curve Methods of Factorization.**  
    *Math. Comp. 48, 177 (1987), 243–264.*  
    *https://doi.org/10.2307/2007888*

17. **Amir Moradi, Bastian Richter, Tobias Schneider, and François-Xavier Standaert. 2018. Leakage Detection with the χ²-Test.**  
    *IACR Trans. Cryptogr. Hardw. Embed. Syst. 2018, 1 (2018), 209–237.*  
    *https://doi.org/10.13154/tches.v2018.i1.209-237*

18. **Cédric Murdica, Sylvain Guilley, Jean-Luc Danger, Philippe Hoogvorst, and David Naccache. 2012. Same Values Power Analysis Using Special Points on Elliptic Curves.**  
    *In Constructive Side-Channel Analysis and Secure Design - Third International Workshop, COSADE 2012, Darmstadt, Germany, May 3-4, 2012. Proceedings (Lecture Notes in Computer Science), Werner Schindler and Sorin A. Huss (Eds.), Vol. 7275. Springer, 183–198.*  
    *https://doi.org/10.1007/978-3-642-29912-4_14*

19. **Erick Nascimento, Lukasz Chmielewski, David Oswald, and Peter Schwabe. 2016. Attacking Embedded ECC Implementations Through cmov Side Channels.**  
    *In Selected Areas in Cryptography - SAC 2016 - 23rd International Conference, St. John’s, NL, Canada, August 10-12, 2016, Revised Selected Papers (Lecture Notes in Computer Science), Roberto Avanzi and Howard M. Heys (Eds.), Vol. 10532. Springer, 99–119.*  
    *https://doi.org/10.1007/978-3-319-69453-5_6*

20. **Erick Nascimento, Julio López, and Ricardo Dahab. 2015. Efficient and Secure Elliptic Curve Cryptography for 8-bit AVR Microcontrollers.**  
    *In Security, Privacy, and Applied Cryptography Engineering - 5th International Conference, SPACE 2015, Jaipur, India, October 3-7, 2015, Proceedings (Lecture Notes in Computer Science), Rajat Subhra Chakraborty, Peter Schwabe, and Jon A. Solworth (Eds.), Vol. 9354. Springer, 289–309.*  
    *https://doi.org/10.1007/978-3-319-24126-5_17*

21. **Katsuyuki Okeya and Kouichi Sakurai. 2002. A Second-Order DPA Attack Breaks a Window-Method Based Countermeasure against Side Channel Attacks.**  
    *In Information Security, 5th International Conference, ISC 2002 Sao Paulo, Brazil, September 30 - October 2, 2002, Proceedings (Lecture Notes in Computer Science), Agnes Hui Chan and Virgil D. Gligor (Eds.), Vol. 2433. Springer, 389–401.*  
    *https://doi.org/10.1007/3-540-45811-5_30*

22. **Dag Arne Osvik, Adi Shamir, and Eran Tromer. 2006. Cache Attacks and Countermeasures: The Case of AES.**  
    *In Topics in Cryptology - CT-RSA 2006, The Cryptographers’ Track at the RSA Conference 2006, San Jose, CA, USA, February 13-17, 2006, Proceedings (Lecture Notes in Computer Science), David Pointcheval (Ed.), Vol. 3860. Springer, 1–20.*  
    *https://doi.org/10.1007/11605805_1*

23. **Colin Percival. 2005. Cache Missing for Fun and Profit.**  
    *In BSDCan 2005, Ottawa, Canada, May 13-14, 2005, Proceedings.*  
    *http://www.daemonology.net/papers/cachemissing.pdf*

24. **Cesar Pereida García and Billy Bob Brumley. 2017. Constant-Time Callees with Variable-Time Callers.**  
    *In 26th USENIX Security Symposium, USENIX Security 2017, Vancouver, BC, Canada, August 16-18, 2017, Engin Kirda and Thomas Ristenpart (Eds.). USENIX Association, 83–98.*  
    *https://www.usenix.org/conference/usenixsecurity17/technical-sessions/presentation/garcia*

25. **Jean-Jacques Quisquater and David Samyde. 2001. ElectroMagnetic Analysis (EMA): Measures and Counter-Measures for Smart Cards.**  
    *In Smart Card Programming and Security, International Conference on Research in Smart Cards, E-smart 2001, Cannes, France, September 19-21, 2001, Proceedings (Lecture Notes in Computer Science), Isabelle Attali and Thomas P. Jensen (Eds.), Vol. 2140. Springer, 200–210.*  
    *https://doi.org/10.1007/3-540-45418-7_17*

26. **Tobias Schneider and Amir Moradi. 2016. Leakage Assessment Methodology – Extended Version.**  
    *Journal of Cryptographic Engineering 6, 2 (2016), 85–99.*  
    *https://doi.org/10.1007/s13389-016-0120-y*

27. **Ru-Hui Shi, Zeng-Ju Li, Lei Du, Qian Peng, and Jiu-Ba Xu. 2015. Side Channel Analysis on SM2 Decryption Algorithm.**  
    *Journal of Cryptologic Research 2, 5 (2015), 467–476.*  
    *https://doi.org/10.13868/j.cnki.jcr.000093*

28. **Sam Tregar. 2002. Writing Perl Modules for CPAN.**  
    *Apress.*  
    *https://doi.org/10.1007/978-1-4302-1152-5*

29. **Joop van de Pol, Nigel P. Smart, and Yuval Yarom. 2015. Just a Little Bit More.**  
    *In Topics in Cryptology - CT-RSA 2015, The Cryptographer’s Track at the RSA Conference 2015, San Francisco, CA, USA, April 20-24, 2015. Proceedings (Lecture Notes in Computer Science), Kaisa Nyberg (Ed.), Vol. 9048. Springer, 3–21.*  
    *https://doi.org/10.1007/978-3-319-16715-2_1*

30. **Tom van Goethem, Wouter Joosen, and Nick Nikiforakis. 2015. The Clock is Still Ticking: Timing Attacks in the Modern Web.**  
    *In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security, Denver, CO, USA, October 12-16, 2015, Indrajit Ray, Ninghui Li, and Christopher Kruegel (Eds.). ACM, 1382–1393.*  
    *https://doi.org/10.1145/2810103.2813632*

31. **Pepe Vila and Boris Köpf. 2017. Loophole: Timing Attacks on Shared Event Loops in Chrome.**  
    *In 26th USENIX Security Symposium, USENIX Security 2017, Vancouver, BC, Canada, August 16-18, 2017, Engin Kirda and Thomas Ristenpart (Eds.). USENIX Association, 849–864.*  
    *https://www.usenix.org/conference/usenixsecurity17/technical-sessions/presentation/vila*

32. **Samuel Weiser, Raphael Spreitzer, and Lukas Bodner. 2018. Single Trace Attack Against RSA Key Generation in Intel SGX SSL.**  
    *In Proceedings of the 2018 on Asia Conference on Computer and Communications Security, AsiaCCS 2018, Incheon, Republic of Korea, June 04-08, 2018, Jong Kim, Gail-Joon Ahn, Seungjoo Kim, Yongdae Kim, Javier López, and Taesoo Kim (Eds.). ACM, 575–586.*  
    *https://doi.org/10.1145/3196494.3196524*

33. **Bernard L. Welch. 1947. The Generalization of ‘Student’s’ Problem When Several Different Population Variances Are Involved.**  
    *Biometrika 34 (1947), 28–35.*  
    *http://www.jstor.org/stable/2332510*

34. **Yuval Yarom and Katrina Falkner. 2014. FLUSH+RELOAD: A High Resolution, Low Noise, L3 Cache Side-Channel Attack.**  
    *In Proceedings of the 23rd USENIX Security Symposium, San Diego, CA, USA, August 20-22, 2014. USENIX Association, 719–732.*  
    *https://www.usenix.org/conference/usenixsecurity14/technical-sessions/presentation/yarom*

35. **Kaiyu Zhang, Sen Xu, Dawu Gu, Haihua Gu, Junrong Liu, Zheng Guo, Ruitong Liu, Liang Liu, and Xiaobo Hu. 2017. Practical Partial-Nonce-Exposure Attack on ECC Algorithm.**  
    *In 13th International Conference on Computational Intelligence and Security, CIS 2017, Hong Kong, China, December 15-18, 2017. IEEE, 248–252.*  
    *https://doi.org/10.1109/CIS.2017.00061*

36. **Yinqian Zhang, Ari Juels, Michael K. Reiter, and Thomas Ristenpart. 2014. Cross-Tenant Side-Channel Attacks in PaaS Clouds.**  
    *In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security, Scottsdale, AZ, USA, November 3-7, 2014, Gail-Joon Ahn, Moti Yung, and Ninghui Li (Eds.). ACM, 990–1003.*  
    *https://doi.org/10.1145/2660267.2660356*

### A Remote Timings SCA Evaluation: ECDSA

As stated in the Introduction, as a secondary goal, we aimed to review the abstraction level at which side-channel attack (SCA) countermeasures are implemented. Specifically, we proposed to move each SCA countermeasure discussed in this work to the lowest possible abstraction level. This approach not only enhances the security of the specific cryptosystems under consideration but also increases the resistance to SCAs in other existing cryptosystems.

In this section, we evaluate the impact of our patchset on the ECDSA cryptosystem, specifically when using generic prime curves (as opposed to curves for which an alternative optimized implementation is provided). Figure 11 shows an empirical evaluation similar to those presented in Sections 4 and 7, focusing on the impact of the proposed mitigations on ECDSA over the secp256k1 [24] GLV prime curve used in the Bitcoin protocol.

Both plots in Figure 11 illustrate the latency dependency on the nonce length. The top plot corresponds to the OpenSSL implementation as of version 1.1.1-pre3, while the bottom plot shows the results after applying our patchset. The original implementation already applied nonce padding and FLT modular inversion countermeasures. The main change between the two implementations is the adoption of a Montgomery ladder algorithm for EC scalar multiplication instead of the wNAF algorithm used in the original implementation (see Section 7).

Comparing the two plots, our mitigations introduce an improvement centered around the median values. This is partly due to the fact that timings in the top plot depend on the weight of scalars, while the timings in the bottom plot are independent of the weight. This leads to lower deviations for the majority of data points centered around the median.

**Figure 11: Latency Dependency on the Nonce Length for ECDSA Signature Generation Over the secp256k1 Prime Curve on amd64 Architecture.**

- **Top:** OpenSSL 1.1.1-pre3, where a wNAF algorithm is used to implement EC scalar multiplication (see Section 5.1).
- **Bottom:** After applying our patchset (see Section 7), most notably switching to a Montgomery ladder algorithm for scalar multiplication instead of wNAF.

![Latency Dependency on the Nonce Length for ECDSA Signature Generation](figure_11.png)

- **Cumulative Probability vs. Time (CPU cycles, millions)**
- **Nonce Lengths:** 246 bits, 247 bits, 248 bits, 249 bits, 250 bits, 251 bits, 252 bits, 253 bits, 254 bits, 255 bits, 256 bits

By implementing these changes, we achieve a more consistent and secure ECDSA implementation, reducing the risk of timing-based side-channel attacks.