### IRC User Command and Botnet Detection Events

**IRC USER Command 1030->8080 (23:47:01.23 PST)**
- **Event:** 1:2002024
- **Protocol:** TCP
- **Signature:** E4[rb] BLEEDING-EDGE TROJAN

**IRC NICK Command 1030->8080 (23:47:01.23 PST)**
- **Event:** 1:2002025
- **Protocol:** TCP
- **Signature:** E4[rb] BLEEDING-EDGE TROJAN

**IRC JOIN Command 1030->8080 (23:47:03.79 PST)**
- **Event:** 1:2001579
- **Protocol:** TCP
- **Signature:** E5[rb] BLEEDING-EDGE Behavioral Unusual Port
- **Description:** 139 traffic, Potential Scan or Infection 1089->139 (01:46:06 EST)

**Outbound Scan Event**
- **Event:** 555:5555005
- **Protocol:** TCP
- **Signature:** E5[sc] scade detected scanning of 21 IPs (fail ratio=0:0/21): 0->0 (01:46:06 EST)

**Figure 7: Honeynet Interaction Summary (left) and corresponding BotHunter Profile (right) for W32/IRCBot-TO**
- This figure illustrates the fundamental paradigm shifts in bot behavior.

### Related Work

Recent research on botnets has focused on understanding their nature and potential threats. Rajab et al. [33] conducted an in-depth study using "longitudinal tracking" to analyze the dynamics of IRC botnets through IRC and DNS tracking. Other studies have examined the C&C protocols [19, 50], including diurnal behavior [14]. Researchers have also investigated the internal structures and defense mechanisms of major bot families [7] and developed methods to automatically collect malware samples from the internet [6].

Several detection systems have been proposed:
- **Rishi [21]:** Uses n-gram analysis to identify botnet nickname patterns.
- **Binkley and Singh [9]:** Proposed an anomaly-based system combining IRC statistics and TCP work weight.
- **Livadas et al. [26]:** Developed a machine learning approach for botnet detection.
- **Karasaridis et al. [25]:** Presented an algorithm for detecting IRC botnet controllers from net-flow records.

These efforts complement each other by providing additional evidence-trails for infection events.

### Alert Correlation Techniques

Significant work has been done on alert correlation for network intrusion detection. Approaches include:
- **GriDS [39]:** Aggregates network activity into activity graphs for causal structure analysis.
- **CARDS [49]:** A distributed system for detecting and mitigating coordinated attacks.
- **Abad et al. [2]:** Proposed correlating data from different sources/logs to improve IDS accuracy.
- **Ellis et al. and Jiang et al. [17, 23]:** Described behavioral-based systems for detecting network worms.

In contrast, BotHunter focuses on bot detection and uses infection dialog correlation to define probable infection events.

### Contextual Signatures and Attack Modeling

Sommer et al. [36] described contextual Bro signatures for producing expressive signatures and reducing false positives. JIGSAW [40] and [29] provide formal frameworks for modeling complex attacks. CAML [11] is a language framework for defining and detecting multistep attack scenarios. These systems rely on causal relationships, which need to be manually specified, whereas BotHunter can tolerate missing events during the infection flow.

### Alert Correlation Modules

Modules like CRIM [13] cluster and correlate similar alerts, extracting higher-level correlation rules. Valdes and Skinner [42] proposed a two-step probabilistic alert correlation based on attack threads and alert fusion. These techniques could be integrated into the BotHunter framework as preprocessing steps in a multisensor environment.

### State Transition Analysis

USTAT [22] and NetSTAT [44] are IDSs based on state transition analysis. They specify computer attacks as sequences of actions causing transitions in the security state. Multistep attack correlation is performed using STATL [16], a language for expressing attacks as states and transitions. Unlike these systems, BotHunter does not require a strict temporal sequence and can handle missing events.

### BotHunter Internet Distribution

BotHunter is available as a free internet distribution for testing and research. Key features include:
- **Java-based Correlator:** Reads alert streams from Snort.
- **Privacy-Preserving Data Sharing:** Users can securely submit anonymous bot profiles to the Cyber-TA security repository [32].
- **Access Model:** Similar to DShield.org [41] but with enhanced privacy measures, such as TLS over TOR and IP address obfuscation.

### Conclusion

BotHunter is a perimeter monitoring system for real-time detection of internet malware infections. It uses a three-sensor dialog correlation engine for alert consolidation and evidence trail gathering. The system has been evaluated in virtual and live networks, demonstrating high accuracy and low false positive rates. We hope that the community will extend and maintain this capability, inspiring new research directions.

### Acknowledgements

We thank Al Valdes for his help in developing the regression model for computing weights of dialog events. We also thank Roberto Perdisci and Junjie Zhang for helpful discussions. This work was supported by the U.S. Army Research Office (ARO) and the National Science Foundation.

### References

[1] Cyber-TA: BotHunter distribution page. http://www.cyber-ta.org/releases/botHunter/index.html, 2007.
[2] C. Abad, J. Taylor, C. Sengul, W. Yurcik, Y. Zhou, and K. Rowe. Log correlation for intrusion detection: A proof of concept. In Proceedings of the 19th Annual Computer Security Applications Conference (ACSAC’03), page 255, Washington, DC, USA, 2003. IEEE Computer Society.
[3] L. A. Adamic and B. A. Huberman. Zipf’s law and the Internet. Glottometrics, 3:143–150, 2002.
[4] W32 Agobot IB. http://www.sophos.com/virusinfo/analyses/trojagobotib.html.
[5] K. Anagnostakis, S. Sidiroglou, P. Akritidis, K. Xinidis, E. Markatos, and A. Keromytis. Detecting targeted attacks using shadow honeypots. In Usenix Security Symposium, Baltimore, Maryland, August 2005.
[6] P. Baecher, M. Koetter, T. Holz, M. Dornseif, and F. Freiling. The nepenthes platform: An efficient approach to collect malware. In Proceedings of Recent Advances in Intrusion Detection, Hamburg, September 2006.
[7] P. Barford and V. Yegneswaran. An inside look at botnets. Special Workshop on Malware Detection, Advances in Information Security, Springer Verlag, 2006.
[8] S. Biles. Detecting the unknown with statistical packet anomaly detection engine (SPADE). http://www.computersecurityonline.com/spade/SPADE.pdf.
[9] J. R. Binkley and S. Singh. An algorithm for anomaly-based botnet detection. In Proceedings of USENIX Steps to Reducing Unwanted Traffic on the Internet Workshop (SRUTI), pages 43–48, July 2006.
[10] Bleeding Edge Threats. The Bleeding Edge of Snort. http://www.bleedingsnort.com/, 2007.
[11] S. Cheung, M. Fong, and U. Lindqvist. Modeling multistep cyber attacks for scenario recognition. In Proceedings of DARPA Information Survivability Conference and Exposition (DISCEX III), 2003.
[12] E. Cooke, F. Jahanian, and D. McPherson. The zombie roundup: Understanding, detecting, and disrupting botnets. In Proceedings of Workshop on Steps to Reducing Unwanted Traffic on the Internet (SRUTI’05), 2005.
[13] F. Cuppens and A. Miege. Alert correlation in a cooperative intrusion detection framework. In Proceedings of IEEE Symposium on Security and Privacy, 2002.
[14] D. Dagon, C. Zou, and W. Lee. Modeling botnet propagation using timezones. In Proceedings of Network and Distributed Security Symposium (NDSS ’06), January 2006.
[15] R. Dingledine, N. Mathewson, and P. Syverson. TOR: The second generation onion router. In Proceedings of the Usenix Security Symposium, 2004.
[16] S. T. Eckmann, G. Vigna, and R. A. Kemmerer. STATL: An attack language for state-based intrusion detection. Journal of Computer Security, 10, 2002.
[17] D. R. Ellis, J. G. Aiken, K. S. Attwood, and S. D. Tenaglia. A Behavioral Approach to Worm Detection. In Proceedings of WORM, 2004.
[18] P. Fogla, M. Sharif, R. Perdisci, O. M. Kolesnikov, and W. Lee. Polymorphic blending attack. In Proceedings of the 2006 USENIX Security Symposium, 2006.
[19] F. Freiling, T. Holz, and G. Wicherski. Botnet tracking: Exploring a root-cause methodology to prevent denial of service attacks. In Proceedings of ESORICS, 2005.
[20] German Honeynet Project. Tracking botnets. http://www.honeynet.org/papers/bots, 2005.
[21] J. Goebel and T. Holz. Rishi: Identify bot contaminated hosts by IRC nickname evaluation. In USENIX Workshop on Hot Topics in Understanding Botnets (HotBots’07), 2007.
[22] K. Iglun, R. A. Kemmerer, and P. A. Porras. State transition analysis: A rule-based intrusion detection system. IEEE Transactions on Software Engineering, 21, 1995.
[23] X. Jiang and D. Xu. Profiling self-propagating worms via behavioral footprinting. In Proceedings of CCS WORM, 2006.
[24] J. Jung, V. Paxson, A. W. Berger, and H. Balakrishnan. Fast portscan detection using sequential hypothesis testing. In IEEE Symposium on Security and Privacy 2004, Oakland, CA, May 2004.
[25] A. Karasaridis, B. Rexroad, and D. Hoeﬂin. Wide-scale botnet detection and characterization. In USENIX Workshop on Hot Topics in Understanding Botnets (HotBots’07), 2007.
[26] C. Livadas, R. Walsh, D. Lapsley, and W. T. Strayer. Using machine learning techniques to identify botnet traffic. In 2nd IEEE LCN Workshop on Network Security (WoNS’2006), 2006.
[27] Mitre Corporation. CVE-2006-3439. http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3439.
[28] D. Moore, G. Voelker, and S. Savage. Inferring Internet denial-of-service activity. In Proceedings of the 10th USENIX Security Symposium, 2001.
[29] P. Ning, Y. Cui, and D. Reeves. Constructing attack scenarios through correlation of intrusion alerts. In Proceedings of Computer and Communications Security, 2002.
[30] V. Paxson. BRO: A System for Detecting Network Intruders in Real Time. In Proceedings of the 7th USENIX Security Symposium, 1998.
[31] R. Perdisci, G. Gu, and W. Lee. Using an ensemble of one-class SVM classifiers to harden payload-based anomaly detection systems. In Proceedings of the IEEE International Conference on Data Mining (ICDM’06), December 2006.
[32] P. Porras. Privacy-enabled global threat monitoring. In Proceedings of the IEEE Security and Privacy Magazine, 2006.
[33] M. Rajab, J. Zarfoss, F. Monrose, and A. Terzis. A multi-faceted approach to understanding the botnet phenomenon. In Proceedings of ACM SIGCOMM/USENIX Internet Measurement Conference, Brazil, October 2006.
[34] A. Ramachandran and N. Feamster. Understanding the network-level behavior of spammers. In Proceedings of ACM SIGCOMM, 2006.
[35] M. Roesch. Snort - lightweight intrusion detection for networks. In Proceedings of USENIX LISA’99, 1999.
[36] R. Sommer and V. Paxson. Enhancing byte-level network intrusion detection signatures with context. In 10th ACM Conference on Computer and Communication Security (CCS), Washington, DC, October 2003.
[37] Sophos Inc. W32/IRCBot-TO. http://www.sophos.com/virusinfo/analyses/w32ircbotto.html, 2007.
[38] S. Staniford, J. Hoagland, and J. McAlerney. Practical automated detection of stealthy portscans. In Journal of Computer Security, 2002.
[39] S. Staniford-Chen, S. Cheung, R. Crawford, M. Dilger, J. Frank, J. Hoagland, K. Levitt, C. Wee, R. Yip, and D. Zerkle. Grids–a graph based intrusion detection system for large networks. In 19th National Information Systems Security Conference, 1996.
[40] S. Templeton and K. Levitt. A requires/provides model for computer attacks. In New Security Paradigms Workshop, 2000.
[41] J. Ullrich. DSHIELD. http://www.dshield.org, 2007.
[42] A. Valdes and K. Skinner. Probabilistic alert correlation. In Proceedings of Recent Advances in Intrusion Detection (RAID), pages 54–68, 2001.
[43] F. Valeur, G. Vigna, C. Kruegel, and R. Kemmerer. Comprehensive approach to intrusion detection alert correlation. In Proceedings of IEEE Transactions on Dependable and Secure Computing, 2004.
[44] G. Vigna and R. Kemmerer. NetSTAT: A network-based intrusion detection approach. In Proceedings of the 14th Annual Computer Security Applications Conference (ACSAC ’98), 1998.
[45] K. Wang, J. J. Parekh, and S. Stolfo. Anagram: A content anomaly detector resistant to mimicry attack. In Proceedings of the International Symposium on Recent Advances in Intrusion Detection (RAID), 2006.
[46] K. Wang and S. Stolfo. Anomalous payload-based network intrusion detection. In Proceedings of the International Symposium on Recent Advances in Intrusion Detection (RAID), 2004.
[47] K. Wang and S. Stolfo. Anomalous payload-based worm detection and signature generation. In Proceedings of the International Symposium on Recent Advances in Intrusion Detection (RAID), 2005.
[48] D. Whyte, P. van Oorschot, and E. Kranakis. Exposure maps: Removing reliance on attribution during scan detection. In Proceedings of 1st USENIX Workshop on Hot Topics in Security (HotSec’06), 2006.
[49] J. Yang, P. Ning, X. S. Wang, and S. Jajodia. CARDS: A distributed system for detecting coordinated attacks. In SEC, 2000.
[50] V. Yegneswaran, P. Barford, and V. Paxson. Using honeynets for Internet situational awareness. In Proceedings of the Fourth Workshop on Hot Topics in Networks (HotNets IV), College Park, MD, November 2005.