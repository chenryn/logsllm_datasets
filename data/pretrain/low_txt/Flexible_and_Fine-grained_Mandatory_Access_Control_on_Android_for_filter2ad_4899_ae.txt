### Implementation of a Generic Mandatory Access Control Framework: FlaskDroid

#### Availability
The source code for FlaskDroid is available online at:
- [http://www.flaskdroid.org](http://www.flaskdroid.org)

#### References
1. **Android.Enesoluty | Symantec**  
   [http://www.symantec.com/security_response/writeup.jsp?docid=2012-082005-5451-99](http://www.symantec.com/security_response/writeup.jsp?docid=2012-082005-5451-99)

2. **Android.Loozfon | Symantec**  
   [http://www.symantec.com/security_response/writeup.jsp?docid=2012-082005-5451-99](http://www.symantec.com/security_response/writeup.jsp?docid=2012-082005-5451-99)

3. **Contagio Mobile**  
   [http://contagiominidump.blogspot.de/](http://contagiominidump.blogspot.de/)

4. **Gartner Says Worldwide Mobile Phone Sales Declined 1.7 Percent in 2012**  
   [http://www.gartner.com/newsroom/id/2335616](http://www.gartner.com/newsroom/id/2335616)

5. **TOMOYO Linux Wiki: How is TOMOYO Linux Different from SELinux and AppArmor?**  
   [http://tomoyo.sourceforge.jp/wiki-e/?WhatIs#comparison](http://tomoyo.sourceforge.jp/wiki-e/?WhatIs#comparison)

6. **WhatsApp Reads Your Phone Contacts and Is Breaking Privacy Laws**  
   [http://www.digitaltrends.com/mobile/whatsapp-breaks-privacy-laws/](http://www.digitaltrends.com/mobile/whatsapp-breaks-privacy-laws/)

7. **Backes, M., Gerling, S., Hammer, C., and von Styp-Rekowsky, P.**  
   "AppGuard - Enforcing User Requirements on Android Apps."  
   In *19th International Conference on Tools and Algorithms for the Construction and Analysis of Systems (TACAS)* (2013), Springer-Verlag.

8. **Bugiel, S., Davi, L., Dmitrienko, A., Fischer, T., Sadeghi, A.-R., and Shastry, B.**  
   "Towards Taming Privilege-Escalation Attacks on Android."  
   In *NDSS* (2012), The Internet Society.

9. **Bugiel, S., Davi, L., Dmitrienko, A., Heuser, S., Sadeghi, A.-R., and Shastry, B.**  
   "Practical and Lightweight Domain Isolation on Android."  
   In *1st ACM CCS Workshop on Security and Privacy in Mobile Devices (SPSM)* (2011), ACM.

10. **Bugiel, S., Heuser, S., and Sadeghi, A.-R.**  
    "myTunes: Semantically Linked and User-Centric Fine-Grained Privacy Control on Android."  
    Tech. Rep. TUD-CS-2012-0226, Center for Advanced Security Research Darmstadt, Nov. 2012.

11. **Bugiel, S., Heuser, S., and Sadeghi, A.-R.**  
    "Towards a Framework for Android Security Modules: Extending SE Android Type Enforcement to Android Middleware."  
    Tech. Rep. TUD-CS-2012-0231, Center for Advanced Security Research Darmstadt, December 2012.

12. **Cai, L., and Chen, H.**  
    "TouchLogger: Inferring Keystrokes on Touch Screen from Smartphone Motion."  
    In *6th USENIX conference on Hot topics in security (HotSec)* (2011), USENIX Association.

13. **Carter, J.**  
    "Using gconf as an Example of How to Create an Userspace Object Manager," 2007.

14. **Chin, E., Felt, A. P., Greenwood, K., and Wagner, D.**  
    "Analyzing Inter-Application Communication in Android."  
    In *MobiSys* (2011), ACM.

15. **Conti, M., Nguyen, V. T. N., and Crispo, B.**  
    "CRePE: Context-Related Policy Enforcement for Android."  
    In *13th Information Security Conference (ISC)* (2010), Springer-Verlag.

16. **Davi, L., Dmitrienko, A., Sadeghi, A.-R., and Winandy, M.**  
    "Privilege Escalation Attacks on Android."  
    In *13th Information Security Conference (ISC)* (2010), Springer-Verlag.

17. **Dietz, M., Shekhar, S., Pisetsky, Y., Shu, A., and Wallach, D. S.**  
    "Quire: Lightweight Provenance for Smartphone Operating Systems."  
    In *USENIX Security* (2011), USENIX Association.

18. **Edwards, A., Jaeger, T., and Zhang, X.**  
    "Runtime Verification of Authorization Hook Placement for the Linux Security Modules Framework."  
    In *CCS* (2002), ACM.

19. **Enck, W., Gilbert, P., Chun, B.-G., Cox, L. P., Jung, J., McDaniel, P., and Sheth, A. N.**  
    "TaintDroid: An Information-Flow Tracking System for Realtime Privacy Monitoring on Smartphones."  
    In *OSDI* (2010), USENIX Association.

20. **Enck, W., Ongtang, M., and McDaniel, P.**  
    "On Lightweight Mobile Phone Application Certification."  
    In *CCS* (2009), ACM.

21. **Enck, W., Ongtang, M., and McDaniel, P.**  
    "Understanding Android Security."  
    *IEEE Security and Privacy Magazine* 7 (2009), 50–57.

22. **F-Secure Labs.**  
    "Mobile Threat Report: Q3 2012," 2012.

23. **Federal Trade Commission.**  
    "Path Social Networking App Settles FTC Charges It Deceived Consumers and Improperly Collected Personal Information from Users’ Mobile Address Books."  
    [http://www.ftc.gov/opa/2013/02/path.shtm](http://www.ftc.gov/opa/2013/02/path.shtm), Jan. 2013.

24. **Gilbert, P., Chun, B.-G., Cox, L. P., and Jung, J.**  
    "Vision: Automated Security Validation of Mobile Apps at App Markets."  
    In *2nd international workshop on Mobile cloud computing and services (MCS)* (2011), ACM.

25. **Grace, M. C., Zhou, W., Jiang, X., and Sadeghi, A.-R.**  
    "Unsafe Exposure Analysis of Mobile In-App Advertisements."  
    In *WiSec* (2012), ACM.

26. **Guttman, J. D., Herzog, A. L., Ramsdell, J. D., and Skorupka, C. W.**  
    "Verifying Information Flow Goals in Security-Enhanced Linux."  
    *Journal on Computer Security* 13, 1 (Jan. 2005), 115–134.

27. **Harada, T., Horie, T., and Tanaka, K.**  
    "Task Oriented Management Obviates Your Onus on Linux."  
    In *Linux Conference* (2004).

28. **Hornyack, P., Han, S., Jung, J., Schechter, S., and Wetherall, D.**  
    "These Aren’t the Droids You’re Looking For: Retrofitting Android to Protect Data from Imperious Applications."  
    In *CCS* (2011), ACM.

29. **Hu, H., Ahn, G.-J., and Kulkarni, K.**  
    "Detecting and Resolving Firewall Policy Anomalies."  
    *IEEE Transactions on Dependable and Secure Computing* 9, 3 (2012), 318–331.

30. **Jeon, J., Micinski, K. K., Vaughan, J. A., Fogel, A., Reddy, N., Foster, J. S., and Millstein, T.**  
    "Dr. Android and Mr. Hide: Fine-Grained Security Policies on Unmodified Android."  
    In *2nd ACM CCS Workshop on Security and Privacy in Mobile Devices (SPSM)* (2012), ACM.

31. **Kostiainen, K., Reshetova, E., Ekberg, J.-E., and Asokan, N.**  
    "Old, New, Borrowed, Blue – A Perspective on the Evolution of Mobile Platform Security Architectures."  
    In *CODASPY* (2011), ACM.

32. **Lineberry, A., Richardson, D. L., and Wyatt, T.**  
    "These Aren’t the Permissions You’re Looking For."  
    *BlackHat USA 2010*. [http://dtors.files.wordpress.com/2010/08/blackhat-2010-slides.pdf](http://dtors.files.wordpress.com/2010/08/blackhat-2010-slides.pdf), 2010.

33. **Loscocco, P., and Smalley, S.**  
    "Integrating Flexible Support for Security Policies into the Linux Operating System."  
    In *FREENIX Track: USENIX Annual Technical Conference* (2001), USENIX Association.

34. **Marforio, C., Ritzdorf, H., Francillon, A., and Capkun, S.**  
    "Analysis of the Communication Between Colluding Applications on Modern Smartphones."  
    In *ACSAC* (2012), ACM.

35. **McDaniel, P., and Prakash, A.**  
    "Methods and Limitations of Security Policy Reconciliation."  
    In *S&P* (2002), IEEE Computer Society.

36. **Muthukumaran, D., Schiffman, J., Hassan, M., Sawani, A., Rao, V., and Jaeger, T.**  
    "Protecting the Integrity of Trusted Applications in Mobile Phone Systems."  
    *Security and Communication Networks* 4, 6 (2011), 633–650.

37. **Nauman, M., Khan, S., and Zhang, X.**  
    "Apex: Extending Android Permission Model and Enforcement with User-Defined Runtime Constraints."  
    In *ASIA CCS* (2010), ACM.

38. **Ongtang, M., Butler, K., and McDaniel, P.**  
    "Porscha: Policy Oriented Secure Content Handling in Android."  
    In *ACSAC* (2010), ACM.

39. **Ongtang, M., McLaughlin, S., Enck, W., and McDaniel, P.**  
    "Semantically Rich Application-Centric Security in Android."  
    In *ACSAC* (2009), IEEE Computer Society.

40. **Porter Felt, A., Finifter, M., Chin, E., Hanna, S., and Wagner, D.**  
    "A Survey of Mobile Malware in the Wild."  
    In *1st ACM workshop on Security and privacy in smartphones and mobile devices (SPSM)* (2011), ACM.

41. **Porter Felt, A., Wang, H., Moshchuk, A., Hanna, S., and Chin, E.**  
    "Permission Re-Delegation: Attacks and Defenses."  
    In *USENIX Security* (2011), USENIX Association.

42. **Provos, N.**  
    "Improving Host Security with System Call Policies."  
    In *USENIX Security* (2003), USENIX Association.

43. **Rao, V., and Jaeger, T.**  
    "Dynamic Mandatory Access Control for Multiple Stakeholders."  
    In *SACMAT* (2009), ACM.

44. **Reeder, R. W., Bauer, L., Cranor, L. F., Reiter, M. K., and Vaniea, K.**  
    "More Than Skin Deep: Measuring Effects of the Underlying Model on Access-Control System Usability."  
    In *International Conference on Human Factors in Computing Systems (CHI)* (2011), ACM.

45. **Russello, G., Conti, M., Crispo, B., and Fernandes, E.**  
    "MOSES: Supporting Operation Modes on Smartphones."  
    In *SACMAT* (2012), ACM.

46. **Schlegel, R., Zhang, K., Zhou, X., Intwala, M., Kapadia, A., and Wang, X.**  
    "Soundcomber: A Stealthy and Context-Aware Sound Trojan for Smartphones."  
    In *NDSS* (2011), The Internet Society.

47. **Smalley, S.**  
    "Middleware MAC for Android."  
    [http://kernsec.org/files/LSS2012-MiddlewareMAC.pdf](http://kernsec.org/files/LSS2012-MiddlewareMAC.pdf), Aug. 2012.

48. **Smalley, S., and Craig, R.**  
    "Security Enhanced (SE) Android: Bringing Flexible MAC to Android."  
    In *NDSS* (2013), The Internet Society.

49. **Smith, C.**  
    "Privacy Flaw in Skype Android App Exposed."  
    [http://www.t3.com/news/privacy-flaw-in-skype-android-app-exposed/](http://www.t3.com/news/privacy-flaw-in-skype-android-app-exposed/)

50. **Spencer, R., Smalley, S., Loscocco, P., Hibler, M., Andersen, D., and Lepreau, J.**  
    "The Flask Security Architecture: System Support for Diverse Security Policies."  
    In *USENIX Security* (1999), USENIX Association.

51. **Vaidya, J., Atluri, V., and Warner, J.**  
    "RoleMiner: Mining Roles Using Subset Enumeration."  
    In *CCS* (2006), ACM.

52. **Xu, R., Saïdi, H., and Anderson, R.**  
    "Aurasium: Practical Policy Enforcement for Android Applications."  
    In *USENIX Security* (2012), USENIX Association.

53. **Xu, Z., Bai, K., and Zhu, S.**  
    "TapLogger: Inferring User Inputs on Smartphone Touchscreens Using On-Board Motion Sensors."  
    In *WiSec* (2012), ACM.

54. **Zhang, X., Seifert, J.-P., and Acıiçmez, O.**  
    "SEIP: Simple and Efficient Integrity Protection for Open Mobile Platforms."  
    In *International conference on Information and communications security (ICICS)* (2010), Springer-Verlag.

55. **Zhou, Y., and Jiang, X.**  
    "Dissecting Android Malware: Characterization and Evolution."  
    In *S&P* (2012), IEEE Computer Society.

56. **Zhou, Y., and Jiang, X.**  
    "Detecting Passive Content Leaks and Pollution in Android Applications."  
    In *NDSS* (2013), The Internet Society.

57. **Zhou, Y., Wang, Z., Zhou, W., and Jiang, X.**  
    "Hey, You, Get Off of My Market: Detecting Malicious Apps in Official and Alternative Android Markets."  
    In *NDSS* (2012), The Internet Society.

58. **Zhou, Y., Zhang, X., Jiang, X., and Freeh, V. W.**  
    "Taming Information-Stealing Smartphone Applications (on Android)."  
    In *TRUST* (2011), Springer-Verlag.

### A Concrete Instantiation of Saint Policies with FlaskDroid

Listing 3 shows an instantiation of the developer policy described in [39] using FlaskDroid. This policy is deployed by a shopping app, and `self_t` refers to the shopping app. We define types such as `app_trustedPayApp_t`, `app_trustedPWVault_t`, and `app_noInternetPerm_t` (lines 1-3 and lines 8-16) for specific apps that the shopping app is allowed to interact with. We also describe some of the allowed interactions using Intent types `intent_actionPay_t` and `intent_recordExpense_t` (lines 5-6 and lines 18-24). Finally, we declare access control rules that reflect the policy described in [39] (lines 26-28). For example, the rule in line 26 defines that the shopping app is allowed to send an Intent with the action string `ACTION_PAY` only to an app with the type `app_trustedPayApp_t` (line 20), which is assigned to apps with the developer signature `308201...` (line 9).

```plaintext
Listing 3: Policy deployed by the shopping app, showing an instantiation of the Saint [39] runtime policy example.
1 type app_trustedPayApp_t;
2 type app_trustedPWVault_t;
3 type app_noInternetPerm_t;
4
5 type intent_actionPay_t;
6 type intent_recordExpense_t;
7
8 appType app_trustedPayApp_t {
9 Developer:signature=308201...; };
10
11 appType app_trustedPWVault_t {
12 Package:package_name=com.secure.passwordvault;
13 Package:min_version=1.2; };
14
15 appType app_noInternetPerm_t {
16 Package:permission=~android.permission.INTERNET; };
17
18 intentType intent_actionPay_t {
19 Action:action_string=ACTION_PAY;
20 Components:receiver_type=app_trustedPayApp_t; };
21
22 intentType intent_recordExpense_t {
23 Action:action_string=RECORD_EXPENSE;
24 Components:receiver_type=app_noInternetPerm_t; };
25
26 allow self_t intent_actionPay_t: intent_c { send };
27 allow self_t app_trustedPWVault_t: any { any };
28 allow self_t intent_recordExpense_t: intent_c { send };
```

### Userspace Object Managers (USOMs)

**Example Operations:**
- **PackageManagerService:** getPackageInfo, findPreferredActivity, getInstalledApplications, installPackage
- **ActivityManagerService:** startActivity, moveTask, grantURIPermission, sendBroadcast, registerBroadcastReceiver
- **AudioService:** setStreamVolume, setVibrateSetting
- **PowerManagerService:** acquireWakeLock, isScreenOn, reboot, preventScreenOn
- **SensorManager:** getSensorList, getDefaultSensor
- **LocationManagerService:** requestLocationUpdates, addProximityAlert

**Known Location:**
- **SMSManager:** copyMessageToIcc, deleteMessageFromIcc, sendTextMessage, getCellLocation, getDeviceId
- **TelephonyManager:** getCellLocation
- **ContactsProvider2, MMSSMSProvider, TelephonyProvider, SettingsProvider:**
  - getLast, query, insert, update, delete, writeAccess, readAccess

**Table 4: Exemplary System USOMs**

---

This document has been revised for clarity, coherence, and professionalism.