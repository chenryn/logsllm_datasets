### Estimating Market Share of Autonomous Systems Hosting Top Hypergiants

To estimate the market share of each Autonomous System (AS) that hosts at least one of the top four Hypergiants (HGs), we use the APNIC dataset [65], which has been utilized in previous studies [46, 60] to characterize ASes based on their Internet user population market share.

#### APNIC Dataset and Data Filtering
APNIC conducts regular measurement campaigns [66] and publishes the results daily. These datasets can be used to estimate the Internet user population percentages per AS, both for IPv4 and IPv6, at a country level. We download daily snapshots and retain only the ASes that have been present in the dataset for at least 25% of each month (one week) to avoid mis-inferences. This filtering process reduces the total number of ASes from 26,000 to approximately 9,000, reducing the coverage of ASes in our study to less than 80%. However, by applying these filters, we prioritize accuracy, considering our results as lower bounds of user population percentages. We store monthly snapshots of these data starting from October 2017.

#### Estimating Internet User Population Coverage
To estimate the Internet user population coverage that has access to HG servers hosted in their network provider, we sum the market shares of all ASes that host HGs and operate in the country. This sum is then assigned as a percentage for that country. Figure 7 plots the Internet user percentage per country that has access to off-net HG servers for Google, Netflix, and Akamai in April 2021 using the Rapid7 dataset. For these top HGs, the Internet user coverage per country has remained relatively stable from 2017 to 2021. A closer investigation reveals that, in all three cases, the HGs were already hosted by large eyeball networks and other high-market-share network providers in 2017. These observations align with our analysis in Section 6.3 regarding the demographics of off-net footprint growth.

#### Growth of Top-4 HGs per Continent
Figure 6 shows the growth of the top-4 HGs per continent over time. In Figures 6a, 6b, and 6c, we present the regions with the highest growth: Asia, Europe, and South America. By 2013, Google had already established a substantial off-net footprint [22], so its growth is linear in both Europe and Asia. Nevertheless, it expanded its footprint by 400-600 ASes in each region between 2013 and 2021. Netflix's off-net footprint growth aligns well with the launch of its streaming services in various regions. Facebook has shown aggressive expansion in all regions since the launch of its CDN. Akamai increased its off-net footprint in all three regions at similar paces between 2013 and 2017, before contracting somewhat starting around 2018.

#### Exponential Growth in South America
The most striking observation is the exponential growth of Google, Netflix, and Facebook in South America. These HGs expanded their off-net footprints by more than 800 (and in the case of Google, 1,200) ASes from 2013 to 2021. The growth of other HGs is slower, but still significant. Despite Akamai's decline in the number of ASes, its Internet population coverage remains unaffected, as it is still present in networks with large end-user populations. The top HGs' Internet population coverage varies across regions. For example, Google has a strong presence in Africa, and Akamai has high Internet population coverage in Asia. We verified that the number of countries where Google claims to have edge caches [52] agrees with our results.

#### Potential User Coverage via Customer Cones
A HG can potentially serve more Internet users by using an off-net to serve not just the users within the AS hosting an off-net but also the users within the customer cone of the AS. Previous studies show that this is the case for Google [22, 28]. Figure 8 plots the potential Internet user coverage of Google’s off-net footprint if customer cone users are served by Google servers hosted by their providers. In this scenario, Google covers more than 50% of the user population in 201 countries, increasing worldwide coverage from 57.8% to 68.2%. User coverage in Europe increases from 58.8% to 77.5%, and North America increases by 43.9%, from 49% to 70.6%. Countries with the highest increase include Turkey (from 39.1% to 99%), Colombia (from 48.9% to 98.2%), and Russia (from 54.7% to 94.7%). For Facebook, Netflix, and Akamai, refer to Appendix A.6.

#### Facebook’s Off-Net Footprint Expansion
Facebook’s off-net footprint increased significantly between 2017 and 2021. Figure 9 plots its coverage per country in October 2017 and April 2021. Facebook’s off-net footprint expanded aggressively to large, medium, and small ASes globally. As discussed in Section 6.4, Facebook’s footprint growth was especially apparent in South America, Asia, and Africa. Smaller increases are also visible in Europe and Asia.

#### Regional Variations in User Coverage
Due to the varying landscape of the telecommunications sector across the world, the growth of Facebook’s off-net footprint in various regions yields different increases in the percent of users that can be served. For example, in Africa, an increase of the off-net footprint by about 99 ASes yields an increase of more than 115% in user population coverage, from 34.7% to 74.8%. In Europe, the increase of the off-net footprint by 206 ASes yields an increase in user population coverage of 136%, from 16.9% to 39.8%. In contrast, in South America, the increase in user coverage was only 32% (from 51.6% to 68%), although the increase in Facebook’s off-net footprint was more than 739 ASes. Facebook has announced plans to expand in Africa and other developing regions [92], and our results show a significant expansion there. The increased coverage by Facebook is also related to the expansion strategy of its CDN in the last two years, discussed in Section 6.4.

#### Under-Covered Regions
Our results show that some regions remain under-covered, although the specifics vary across HGs. The reasons may vary, including politics and business, and we prefer not to speculate on the root causes. However, our analysis can provide insights into the potential increase in user population coverage. For example, Facebook could significantly increase coverage in the US from 33.9% to 61.8% by deploying off-net servers in only five ASes (AS7018, AS21928, AS20115, AS20057, and AS22394).

### Network Providers’ Hosting Strategies

We next examine the network providers’ strategies for hosting HGs. Our results show that, in terms of which networks host HG off-nets, the footprints of HGs overlap, especially those of the four largest HGs. We also demonstrate that a network that already hosts one large HG is likely to later host more.

For all ASes that are part of at least one of the four largest off-net footprints (Google, Netflix, Facebook, and Akamai), Figure 10b plots the distribution (across time) of the number of those four HGs that they hosted. The number of such ASes has almost tripled between 2013 and 2020. A striking observation is that the majority of the ASes that host HGs (more than 97%, see percentages in the plot) host at least one of the top-4 HGs. Thus, there is only a tiny percentage of ASes that host only HGs outside the top-4. The top-4 HGs have increasingly similar footprints, being present in the same networks. In 2020, more than 70% of ASes that host an off-net host 2-4 top-4 HGs, compared to less than 30% of these ASes in 2013.

We also investigate whether networks that have already hosted top-4 HGs are willing to host more. We focus on networks that, throughout 2013-2021, hosted at least one top-4 HG. In total, there are 1,002 such networks. In Figure 10a, we plot the distribution of top-4 HGs these networks host. In 2013, there were only 450 ASes that hosted 2 or more top-4 HGs. In 2021, this number increased to more than 800. Moreover, although none of these networks hosted all top-4 HGs in 2013, more than 250 of them host all top-4 HGs in 2021. We provide additional results for networks that start hosting HGs later than 2013 in Appendix A.8, but the conclusions are consistent with these observations. We conclude that networks that host top-4 HGs are, typically, willing to host more as time passes.

### Limitations

#### SNI and Certificates
The main dataset (Rapid7) that we use for our longitudinal study reports only the default certificate of an IP address running on port 443 using the HTTPS protocol. A server may host multiple sites on the same IP, but it reports only the default certificate if no SNI value is present in client requests. This practice is widely adopted and used by HGs to provide service to their customers [42, 80].

#### IPv6 Addresses
The corpuses of available certificate datasets are for the IPv4 address space, but there are a very small number of IPv6-only mobile operators for which our approach will not work. We plan to investigate this as part of future work. While our inference approach is IP protocol-agnostic, we lack IPv6 data to conduct longitudinal analysis, and achieving broad coverage in scans of the enormous IPv6 space brings new challenges.

#### HGs’ Operational Practices
Although our methodology is generic, there are some unusual operational practices by some HGs that complicate our approach. For example, CloudFlare offers a proxy service in front of customers and issues a certificate that enables secure communication between the customer server and CloudFlare’s middleware [75]. When these certificates are hosted by customers’ backend servers, it appears like CloudFlare has off-nets there. To mitigate this issue, we manually identify and remove these certificates in our study. We noticed that CloudFlare includes an additional entry in the TLS dNSNames field of their free customer certificates (matching (ssl|sni)[0-9]*.cloudflaressl.com), enabling us to filter on it. Although this process filters out the vast majority of Cloudflare customer certificates, additional manual investigation is required, as CloudFlare offers a paid service for dedicated certificates and allows enterprise and business Tier customers to upload their own custom TLS certificates.

#### Anycast and Reverse Proxies
In the case of IP anycast, the same IP address (belonging to the HG AS) is used to serve content from all sites. From discussions with two operators, we learned that their anycast deployments include off-nets, which additionally use the BGP no-export community to keep the announcement local. The use of this same IP address will make all sites appear to belong to the HG’s AS. However, it is common to assign each off-net a unicast IP address belonging to the hosting AS, to help with debugging. While these IP addresses are generally not given out by the HG’s authoritative DNS to serve production traffic, they do respond in the same way as the production anycast IP. Our approach will discover these unicast IP addresses correctly, but there is no guarantee that operators will configure their networks in this way.

There are instances in our HTTP(S) scans dataset where the edge site terminating the client’s TCP connection belongs to a third-party HG, but the request gets forwarded to a backend server in a different HG. This forwarding behavior is usually the result of a CDN cache miss going to the origin or split TCP [27, 83] to an application server. In these cases, the response received by the client will include both the origin HG and edge HG headers. This can confuse our inference confirmation with headers, but in practice, we observe this only in 4% of measurements. Of these, 99% are Akamai (64%) and Cloudflare (35%) edges with origins primarily deployed in Amazon S3. This insight allows us to prioritize third-party CDN headers, like Akamai and Cloudflare, as the edge site in the presence of a conflict.

#### Missing Headers and In-Rotation Servers
Some networks, such as Netflix and Hulu, only include debug or headers when serving logged-in users. These are missing from our input datasets and prevent us from performing header confirmation for these HGs. Because our datasets “skip” the DNS control-plane of HG content delivery, we cannot currently distinguish if a particular IP address is actively in-use by the HG for serving content. A given IP may be drained [9] but responsive or may belong to a testing environment that always responds when queried.

### Discussion

#### An Increasingly Private Internet
Our study shows that many HGs have already installed substantial serving infrastructure deep inside networks, especially eyeball networks. This can be a blessing if these installations can improve end-user performance. For example, it has been reported that round trip times between end-users and these servers can be even less than a millisecond [86, 104]. Such low delays are a step towards addressing the future requirements and a way for Hypergiants like Google and Facebook to play a crucial role in the evolving Internet landscape.