### Certificate Authority Configuration and Vulnerabilities

#### User-Specified SAN and Request Disposition
- **User-Specified SAN**: Enabled
- **Request Disposition**: Issue
- **Enforce Encryption for Requests**: Enabled

#### Permissions
- **Owner**: ESSOS.LOCAL\Administrators
- **Access Rights**:
  - **ManageCertificates**: 
    - ESSOS.LOCAL\Administrators
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Enterprise Admins
  - **ManageCa**:
    - ESSOS.LOCAL\Administrators
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Enterprise Admins
  - **Enroll**:
    - ESSOS.LOCAL\Authenticated Users

#### Vulnerabilities
- **ESC6**: Enrollees can specify SAN, and the Request Disposition is set to "Issue". This configuration does not work after May 2022.
- **ESC8**: Web Enrollment is enabled, and the Request Disposition is set to "Issue".

### Certificate Templates

#### Template: ESC4
- **Template Name**: ESC4
- **Display Name**: ESC4
- **Certificate Authorities**: ESSOS-CA
- **Enabled**: True
- **Client Authentication**: False
- **Enrollment Agent**: False
- **Any Purpose**: False
- **Enrollee Supplies Subject**: False
- **Certificate Name Flag**:
  - SubjectRequireDirectoryPath
  - SubjectRequireEmail
  - SubjectAltRequireUpn
- **Enrollment Flag**:
  - AutoEnrollment
  - PublishToDs
  - PendAllRequests
  - IncludeSymmetricAlgorithms
- **Private Key Flag**:
  - 16777216
  - 65536
  - ExportableKey
- **Extended Key Usage**: Code Signing
- **Requires Manager Approval**: True
- **Requires Key Archival**: False
- **Authorized Signatures Required**: 1
- **Validity Period**: 1 year
- **Renewal Period**: 6 weeks
- **Minimum RSA Key Length**: 2048

##### Permissions
- **Enrollment Permissions**:
  - **Enrollment Rights**: ESSOS.LOCAL\Domain Users
- **Object Control Permissions**:
  - **Owner**: ESSOS.LOCAL\Enterprise Admins
  - **Full Control Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\khal.drogo
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Owner Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\khal.drogo
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Dacl Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\khal.drogo
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Property Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\khal.drogo
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins

##### Vulnerabilities
- **ESC4**: 'ESSOS.LOCAL\khal.drogo' has dangerous permissions.

#### Template: ESC3-CRA
- **Template Name**: ESC3-CRA
- **Display Name**: ESC3-CRA
- **Certificate Authorities**: ESSOS-CA
- **Enabled**: True
- **Client Authentication**: False
- **Enrollment Agent**: True
- **Any Purpose**: False
- **Enrollee Supplies Subject**: False
- **Certificate Name Flag**:
  - SubjectAltRequireUpn
- **Enrollment Flag**:
  - AutoEnrollment
- **Private Key Flag**:
  - 16777216
  - 65536
- **Extended Key Usage**: Certificate Request Agent
- **Requires Manager Approval**: False
- **Requires Key Archival**: False
- **Authorized Signatures Required**: 0
- **Validity Period**: 1 year
- **Renewal Period**: 6 weeks
- **Minimum RSA Key Length**: 2048

##### Permissions
- **Enrollment Permissions**:
  - **Enrollment Rights**: ESSOS.LOCAL\Domain Users
- **Object Control Permissions**:
  - **Owner**: ESSOS.LOCAL\Enterprise Admins
  - **Full Control Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Owner Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Dacl Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Property Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins

##### Vulnerabilities
- **ESC3**: 'ESSOS.LOCAL\Domain Users' can enroll, and the template has the Certificate Request Agent EKU set.

#### Template: ESC2
- **Template Name**: ESC2
- **Display Name**: ESC2
- **Certificate Authorities**: ESSOS-CA
- **Enabled**: True
- **Client Authentication**: True
- **Enrollment Agent**: True
- **Any Purpose**: True
- **Enrollee Supplies Subject**: False
- **Certificate Name Flag**:
  - SubjectAltRequireUpn
- **Enrollment Flag**:
  - AutoEnrollment
- **Private Key Flag**:
  - 16777216
  - 65536
- **Extended Key Usage**: Any Purpose
- **Requires Manager Approval**: False
- **Requires Key Archival**: False
- **Authorized Signatures Required**: 0
- **Validity Period**: 1 year
- **Renewal Period**: 6 weeks
- **Minimum RSA Key Length**: 2048

##### Permissions
- **Enrollment Permissions**:
  - **Enrollment Rights**: ESSOS.LOCAL\Domain Users
- **Object Control Permissions**:
  - **Owner**: ESSOS.LOCAL\Enterprise Admins
  - **Full Control Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Owner Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Dacl Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins
  - **Write Property Principals**:
    - ESSOS.LOCAL\Domain Admins
    - ESSOS.LOCAL\Local System
    - ESSOS.LOCAL\Enterprise Admins

##### Vulnerabilities
- **ESC2**: 'ESSOS.LOCAL\Domain Users' can enroll, and the template can be used for any purpose.
- **ESC3**: 'ESSOS.LOCAL\Domain Users' can enroll, and the template has the Certificate Request Agent EKU set.

#### Template: ESC1
- **Template Name**: ESC1
- **Display Name**: ESC1
- **Certificate Authorities**: ESSOS-CA
- **Enabled**: True
- **Client Authentication**: True
- **Enrollment Agent**: False
- **Any Purpose**: False
- **Enrollee Supplies Subject**: True
- **Certificate Name Flag**:
  - EnrolleeSuppliesSubject
- **Enrollment Flag**: None
- **Private Key Flag**:
  - 16777216
  - 65536

This document provides a detailed overview of the certificate authority configuration, including user-specified SAN, request disposition, and various certificate templates. It also highlights potential vulnerabilities associated with each configuration.