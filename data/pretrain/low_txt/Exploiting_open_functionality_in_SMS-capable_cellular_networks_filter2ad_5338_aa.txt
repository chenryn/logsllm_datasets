# Exploiting Open Functionality in SMS-Capable Cellular Networks

**Authors:**
- William Enck
- Patrick Traynor
- Patrick D. McDaniel
- Thomas F. La Porta

**Affiliation:**
Systems and Internet Infrastructure Security Laboratory  
Department of Computer Science and Engineering  
The Pennsylvania State University  
University Park, PA 16802  
{enck, traynor, mcdaniel, tlp}@cse.psu.edu

## Abstract
Cellular networks are a critical component of the economic and social infrastructures we rely on. In addition to voice services, these networks deliver alphanumeric text messages to the vast majority of wireless subscribers. To encourage the expansion of this service, telecommunications companies offer connections between their networks and the Internet. However, the full implications of such connections have not been fully recognized. In this paper, we evaluate the security impact of the SMS interface on the availability of the cellular phone network. Specifically, we demonstrate the ability to deny voice service to cities the size of Washington D.C. and Manhattan with little more than a cable modem. Moreover, attacks targeting the entire United States are feasible with resources available to medium-sized zombie networks. This analysis begins with an exploration of the structure of cellular networks. We then characterize network behavior and explore a number of reconnaissance techniques aimed at effectively targeting attacks on these systems. We conclude by discussing countermeasures that mitigate or eliminate the threats introduced by these attacks.

**Categories and Subject Descriptors:**
C.2.0 [Computer-Communication Networks]: General—Security and protection

**General Terms:**
Security

**Keywords:**
Telecommunications, SMS, Denial-of-Service, Open-Functionality

## 1. Introduction
The majority of mobile phone subscribers can receive both voice and alphanumeric text via Short Messaging Service (SMS) transmissions. Text messaging allows users to interact with each other in situations where voice calls are not appropriate or possible. With countries like the UK experiencing volumes of 69 million messages per day [16], this service is rapidly becoming as ingrained into modern culture as its voice counterpart [13, 11].

Text messaging services are extremely popular with the telecommunications industry. While voice traffic typically yields a fixed amount of revenue per user, service providers earn up to US$0.10 per text message sent or received by a mobile device [45, 60, 19]. Seeing this potential for revenue, cellular providers have opened their networks to a number of additional services designed to increase SMS messaging volume. Through service provider website interfaces, email, and a wide variety of applications including instant messaging, users across the Internet can contact mobile subscribers without the use of a cell phone. However, such open functionality has serious negative consequences for these networks.

This paper evaluates the security impact of Internet-originated text messages on cellular voice and SMS services. The connections between the Internet and phone networks introduce open functionality that detrimentally affects the fidelity of a cellular provider’s service. Through the generation and use of large, highly accurate phone hit-lists, we demonstrate the ability to deny voice service to cities the size of Washington D.C. and Manhattan with little more than a cable modem. Moreover, attacks targeting the entire United States are feasible with resources available to medium-sized zombie networks. Even with small hit-lists, we show that these cyber-warfare attacks are sustainable for tens of minutes. These attacks are especially threatening when compared to traditional signal jamming in that they can be invoked from anywhere in the world, often without physical involvement of the adversary.

There are many dangers of connecting digital and physical domains. For example, a wide array of systems with varying degrees of connectivity to the Internet were indirectly affected by the Slammer worm. The traffic generated by this worm was enough to render systems including Bank of America’s ATMs and emergency 911 services in Bellevue, Washington unresponsive [40].

There is nothing fundamentally different about the ways in which these victimized systems and cellular networks are connected to the Internet; all of the above systems were at one time both logically and physically isolated from external networks but have now attached themselves to the largest open system on the planet. Accordingly, we show that mobile phone networks are equally as vulnerable to the influence of the Internet.

In evaluating Internet-originated SMS attacks on cellular networks, we make the following contributions:
- **System Characterization:** Through analysis of publicly available cellular standards and gray-box testing, we characterize the resilience of cellular networks to elevated messaging loads.
- **Refining Target Search Space:** We discuss a variety of techniques that, when used in combination, result in an accurate database of targets ("hit-lists") for directed attacks on cellular networks. These lists are essential to mounting effective attacks against these networks.
- **SMS/Cellular Network Vulnerability Analysis:** We illuminate the fragility of cellular phone networks in the presence of even low-bandwidth attacks. We demonstrate and quantify the ability to incapacitate voice and SMS service to neighborhoods, major metropolitan areas, and entire continents.

The remainder of this paper is organized as follows: Section 2 provides a high-level overview of GSM network architecture and describes text message delivery; Section 3 investigates cellular networks from an attacker’s perspective and identifies the mechanisms necessary to launch Denial of Service (DoS) attacks; Section 4 models and quantifies DoS attacks in multiple environments; Section 5 discusses a number of attacks inherent to attaching general-purpose computing platforms to the Internet; Section 6 proposes various solutions to help alleviate these problems; Section 7 discusses important related works; and Section 8 presents concluding remarks.

## 2. SMS/Cellular Network Overview
This section offers a simplified view of an SMS message traversing a GSM-based system from submission to delivery. These procedures are similar in other cellular networks, including CDMA.

### 2.1 Submitting a Message
There are two methods of sending a text message to a mobile device: via another mobile device or through a variety of External Short Messaging Entities (ESMEs). ESMEs include a wide range of devices and interfaces, such as email, web-based messaging portals at service provider websites, voicemail services, paging systems, and software applications. Whether these systems connect to the mobile phone network via the Internet or specific dedicated channels, messages are first delivered to a server that handles SMS traffic known as the Short Messaging Service Center (SMSC). A service provider supporting text messaging must have at least one SMSC in their network. Due to the rising popularity of this service, it is becoming increasingly common for service providers to support multiple SMSCs to increase capacity.

Upon receiving a message, the contents of incoming packets are examined and, if necessary, converted and copied into SMS message format. At this point in the system, messages from the Internet become indistinguishable from those that originated from mobile phones. Messages are then placed into an SMSC queue for forwarding.

### 2.2 Routing a Message
The SMSC needs to determine how to route messages to their targeted mobile devices. The SMSC queries a Home Location Register (HLR) database, which serves as the permanent repository of user data and includes subscriber information (e.g., call waiting and text messaging), billing data, availability of the targeted user, and their current location. Through interaction with other network elements, the HLR determines the routing information for the destination device. If the SMSC receives a reply stating that the current user is unavailable, it stores the text message for later delivery. Otherwise, the response will contain the address of the Mobile Switching Center (MSC) currently providing service. In addition to call routing, MSCs are responsible for facilitating mobile device authentication, location management for attached base stations (BS), performing handoffs, and acting as gateways to the Public Switched Telephone Network (PSTN).

When a text message arrives from the SMSC, the MSC fetches information specific to the target device. The MSC queries a database known as the Visitor Location Register (VLR), which returns a local copy of the targeted device’s information when it is away from its HLR. The MSC then forwards the text message on to the appropriate base station for transmission over the air interface. A diagram of a mobile phone network is depicted in Figure 1(a), followed by a simplified SMS message flow in Figure 1(b).

### 2.3 Wireless Delivery
The air interface is divided into two parts: the Control Channels (CCH) and Traffic Channels (TCH). The CCH is further divided into two types of channels: the Common CCH and Dedicated CCHs. The Common CCH, which consists of logical channels including the Paging Channel (PCH) and Random Access Channel (RACH), is the mechanism used by the base station to initiate the delivery of voice and SMS data. Accordingly, all connected mobile devices are constantly listening to the Common CCH for voice and SMS signaling.

The base station sends a message on the PCH containing the Temporary Mobile Subscriber ID (TMSI) associated with the end destination. The network uses the TMSI instead of the targeted device’s phone number to thwart eavesdroppers attempting to determine the identity of the receiving phone. When a device hears its TMSI, it attempts to contact the base station over the RACH and alerts the network of its availability to receive incoming call or text data. When the response arrives, the base station instructs the targeted device to listen to a specific Standalone Dedicated Control Channel (SDCCH). Using the SDCCH, the base station is able to facilitate authentication of the destination device (via the subscriber information at the MSC), enable encryption, deliver a fresh TMSI, and then deliver the SMS message itself. To reduce overhead, if multiple SMS messages exist on the SMSC, more than one message may be transmitted over an SDCCH session [5]. If a voice call had been waiting at the base station instead of a text message, all of the above channels would have been used in the same manner to establish a connection on a traffic channel.

An illustration of this final stage of delivery over the air interface is shown in Figure 2.

## 3. SMS/Cellular Network Vulnerability Analysis
The majority of legitimate uses for SMS can often be characterized as non-essential, ranging from social interactions to low-priority business-related exchanges. The key feature of these communications is that they can typically be accomplished through a number of other, albeit potentially less convenient, channels. During the terrorist attacks of September 11, 2001, however, the nature of text messaging proved to be far more utilitarian.

With millions of people attempting to contact friends and family, telecommunications companies witnessed tremendous spikes in cellular voice service usage. Verizon Wireless, for example, reported voice traffic rate increases of up to 100% above typical levels; Cingular Wireless recorded an increase of up to 1000% on calls destined for the Washington D.C. area [44]. While these networks are engineered to handle elevated amounts of traffic, the sheer number of calls was far greater than the capacity for voice communications in the affected areas. However, with voice-based phone services being almost entirely unavailable due to TCH saturation, SMS messages were still successfully received in even the most congested regions because the control channels responsible for their delivery remained available.

Text messaging allowed the lines of communication to remain open for many individuals in need, despite their inability to complete voice calls. Accordingly, SMS messaging is now viewed by many as a reliable method of communication when all other means appear unavailable.

Due to this proliferation of text messaging, we analyze Internet-originated SMS attacks and their effects on voice and other services in cellular networks. We first characterize these systems through an extensive study of the available standards documentation and gray-box testing. From this data, we discuss a number of attacks and the susceptibility of mobile phone networks to each. Lastly, from gray-box testing, we assess the resilience of these networks to these attacks.

Before discussing the specifics of any attack on cellular networks, it is necessary to examine these systems from an adversary’s perspective. In this section, we present simple methods of discovering the most fragile portions of these networks by determining system bottlenecks. We then investigate the creation of effective targeting systems designed to exploit these choke points.

### 3.1 Determining Bottlenecks in Cellular Networks
There is an inherent cost imbalance between injecting SMS messages into the phone network and delivering messages to a mobile user. Such imbalances are the root of DoS attacks.

Recognizing these bottlenecks requires a thorough understanding of the system. The cellular network standards documentation provides the framework from which the system is built, but it lacks implementation-specific details. In an effort to bridge this gap, we performed gray-box testing [7, 14].

We characterize these systems by delivery disciplines, delivery rates, and interfaces. All tests were performed using our own phones. At no time did we inject a damaging volume of packets into the system.