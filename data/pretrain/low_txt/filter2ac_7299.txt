### Title: Efail: Exploiting S/MIME and OpenPGP Email Encryption via Exfiltration Channels

OpenPGP and S/MIME are the two primary standards for providing end-to-end security for emails. From a contemporary perspective, this is surprising because both standards rely on outdated cryptographic primitives that have been responsible for vulnerabilities in major cryptographic protocols. The belief in the security of email encryption may stem from the non-interactive nature of email, which seemingly prevents attackers from exploiting the same types of vulnerabilities found in TLS, SSH, or IPsec.

However, we demonstrate that this assumption is incorrect. We introduce a novel attack technique called "malleability gadgets" to inject malicious plaintext snippets into encrypted emails using malleable encryption. These snippets exploit existing and standard-compliant backchannels, such as those in HTML, CSS, or x509 functionality, to exfiltrate the full plaintext after decryption. The attack is triggered when the victim decrypts a single maliciously crafted email from the attacker.

We have developed working malleability gadgets for both OpenPGP and S/MIME encryption and have identified exfiltration channels in 25 out of 35 tested S/MIME email clients and 10 out of 28 tested OpenPGP email clients. While it is necessary to update the OpenPGP and S/MIME standards to address these vulnerabilities, some clients also exhibited more severe implementation flaws that allowed for straightforward exfiltration of the plaintext.