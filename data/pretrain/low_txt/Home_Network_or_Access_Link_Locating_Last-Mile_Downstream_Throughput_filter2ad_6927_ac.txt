### 3.1 Prevalence of Last-Mile Bottlenecks

In this section, we investigate the prevalence of downstream throughput bottlenecks in access links versus home wireless networks using the Home Observatory Algorithm (HoA). Specifically, we analyze the fraction of tests where HoA identifies downstream throughput bottlenecks and determine whether these bottlenecks are caused by the access link or the home wireless network.

We conducted over 50,000 tests across a wide range of operating conditions in the field. HoA identified downstream throughput bottlenecks in 55% of tests in the BISmark deployment and 47% of tests in the FCC deployment. When HoA does not detect a bottleneck, the underlying cause may be low demand or bottlenecks occurring elsewhere in the network (e.g., at a peering point). As expected, homes with access-link throughput less than 10 Mbps experience the highest fraction of throughput bottlenecks, with 55% of tests detecting a bottleneck. However, the fraction of tests where HoA detects a bottleneck remains close to 40% even for homes with access-link throughput above 90 Mbps. In the remainder of this section, we further characterize the tests where HoA detects a downstream throughput bottleneck.

Figure 6a shows the fraction of downstream throughput bottlenecks in the BISmark deployment that are located either in the access link or in the home wireless network. We grouped home networks into bins of 10 Mbps based on the measured downstream throughput of their access links. The results indicate that many throughput bottlenecks in the BISmark deployment are due to the wireless network. Our analysis of bottlenecks per home in the BISmark deployment reveals that the fraction of wireless bottlenecks varies significantly across homes, even for those with similar access-link throughput. For example, homes with access-link throughput less than 20 Mbps had wireless bottlenecks in between 3–58% of downstream throughput bottlenecks, and 11–83% of downstream throughput bottlenecks. By default, we configured these home routers to use 802.11n, which can support significantly higher rates. The default 802.11n configuration supports frame rates of up to 130 Mbps (we observed about 85–90 Mbps over TCP), while 802.11g supports only frame rates up to 54 Mbps. The fact that these networks are experiencing throughput bottlenecks suggests persistent problems with home wireless network deployments in practice.

Figure 6b presents the same results for the FCC deployment. First, access-link bottlenecks occur frequently only for home networks with downstream access throughput less than 20 Mbps. Homes with access throughput less than 10 Mbps experience access-link bottlenecks in about 66% of cases; however, this fraction drops rapidly as access throughput increases. For homes with access throughput between 10 and 20 Mbps, about 40% of downstream throughput bottlenecks are due to access-link bottlenecks, whereas for homes with access links exceeding 20 Mbps, access-link bottlenecks explain only about 20% of downstream throughput bottlenecks. Conversely, wireless throughput bottlenecks become more prevalent in homes with higher access throughput: 33% of downstream throughput bottlenecks for homes with throughput less than 10 Mbps are due to wireless bottlenecks; 40% of the bottlenecks are in the wireless network for homes with 10–20 Mbps access throughput; and nearly 80% of the bottlenecks are in the wireless network when access throughput exceeds 20 Mbps. It is surprising that wireless throughput bottlenecks occur even for access links with such low speeds: the FCC access points support 802.11n, with default frame bitrates of up to 130 Mbps and a maximum frame bitrate of 300 Mbps. Some users had configured their routers to 802.11g, and those users did experience lower throughput. However, 802.11g comprised only 10% of all tests, so most of the problems we observed occurred even with 802.11n.

In about 8% of downstream throughput bottlenecks in homes with access-link throughput less than 10 Mbps, HoA indicates that both the wireless network and the access link are introducing throughput bottlenecks. In principle, this should not occur as, by definition, there can be only one bottleneck. The prevalence of this result for primarily low-throughput access links suggests that, in these cases, at least one device in the home network may be experiencing poor wireless conditions in conjunction with an access-link bottleneck.

### 3.2 Wireless Bottlenecks Within a Home

The previous section demonstrated that wireless bottlenecks are common; in cases where wireless bottlenecks exist, at least one device in the home experiences a wireless throughput bottleneck during the tests. For about 75% of tests when HoA detects a wireless bottleneck, we observe traffic for only one device in the home. For the remaining 25% of tests with a wireless bottleneck, we investigate whether the active devices experience a downstream throughput bottleneck in the wireless network simultaneously. Simultaneous throughput bottlenecks in the wireless network to independent devices might indicate a more systemic problem (e.g., pervasive interference, poor signal from the access point, contention), whereas isolated throughput bottlenecks are more likely to indicate a problem with a particular device. About half of the cases we observed involve throughput bottlenecks that are isolated to a single device; in another 45% of cases, all of the devices in the home simultaneously experience a throughput bottleneck.

### 4 Related Work

HoA draws inspiration from several previous diagnosis techniques. Zhang et al. developed T-RAT [22] to analyze TCP performance. T-RAT estimates TCP parameters such as maximum segment size, round-trip time, and loss to understand flow behavior. Katabi et al. [11] used entropy in packet inter-arrival time to estimate shared bottlenecks. Biaz et al. [3] used packet inter-arrival times to distinguish between different kinds of losses. HoA is similar to some of the approaches used in these papers (e.g., it uses packet inter-arrival time as input to a detector for access link bottlenecks), but we tailor our approach so that it only relies on data that can be easily collected from a home router. Previous work has studied broadband access performance [4, 8, 9, 20]. In particular, Sundaresan et al. [20] study residential access performance from home routers (also using the FCC Broadband America dataset). There have also been many previous approaches to diagnosing wireless networks. One approach is to deploy passive traffic monitors throughout the network to diagnose wireless pathologies [1, 2, 6, 15, 16] or to study wireless performance [14]. Kanuparthy et al. [10] developed a tool to detect common wireless pathologies (such as low signal-to-noise ratio, congestion, and hidden terminals) by using both active probes and an additional passive monitor deployed within the network. Kim et al. [12] analyze wireless metrics such as frame bitrates, frame ACKs, and retransmission rates to identify root causes of wireless performance problems. Other approaches have monitored wireless networks with custom hardware [5, 13, 16–18]. Unfortunately, it is difficult to deploy multiple monitoring points or custom hardware in many home networks, as it requires deploying equipment beyond what a normal user is typically willing to install or have installed in their home. Other efforts have characterized home networks in terms of connected devices and usage [7, 19].

None of these studies, however, have studied how often the home network constrains downstream throughput.

### 5 Conclusion

To identify performance bottlenecks in home networks, we developed an algorithm and tool, HoA, that passively observes traffic flows between the home network and the access network to determine the location of last-mile downstream throughput bottlenecks. Our prototype deployment of HoA in 2,652 home networks shed new light on the prevalence of downstream throughput bottlenecks in both home networks and access networks. We find that when the downstream throughput of a user’s access link exceeds about 20 Mbps, a high fraction of throughput bottlenecks are caused by the user’s home wireless network. This finding is significant in light of recent proposed regulations to change the definition of broadband Internet access to increasingly higher speeds. Our study opens several avenues for future work. First, we need methods to identify root causes that explain why various wireless performance problems exist, in addition to where they are. Second, a follow-up to HoA could attribute problems that home network users experience to a more complete and specific set of causes.

**Acknowledgments:** We thank the FCC and SamKnows for helping us develop and deploy HoA in the Measuring Broadband America (MBA) platform. We also acknowledge the participants of the MBA platform. We would like to thank our shepherd, Mahesh K. Marina, and the reviewers for their helpful comments. This work was supported by NSF awards CNS-1535796, CNS-1539906, and CNS-1213157, and the European Community's Seventh Framework Programme (FP7/2007–2013) no. 611001 (User-Centric Networking).

**References:**

1. Adya, A., Bahl, P., Chandra, R., Qiu, L.: Architecture and techniques for diagnosing faults in IEEE 802.11 infrastructure networks. In: MobiCom, pp. 30–44, Philadelphia, PA (2004)
2. Ahmed, N., Ismail, U., Keshav, S., Papagiannaki, K.: Online estimation of RF interference. In: ACM CoNEXT, Madrid, Spain, December 2008
3. Biaz, S., Vaidya, N.H.: Discriminating congestion losses from wireless losses using inter-arrival times at the receiver. In: IEEE Symposium on Application-Specific Systems and Software Engineering and Technology (ASSET), Washington, DC, USA (1999)
4. Canadi, I., Barford, P., Sommers, J.: Revisiting broadband performance. In: ACM SIGCOMM Internet Measurement Conference (IMC), October 2012
5. Cheng, Y., Bellardo, J., Benko, P., Snoeren, A.C., Voelker, G.M., Savage, S.: Jigsaw: solving the puzzle of enterprise 802.11 analysis. In: Proceedings of ACM SIGCOMM, Pisa, Italy, August 2006
6. Cheng, Y.C., Afanasyev, M., Verkaik, P., Benkő, P., Chiang, J., Snoeren, A.C., Savage, S., Voelker, G.M.: Automating cross-layer diagnosis of enterprise wireless networks. SIGCOMM Comput. Commun. Rev. 37(4), 25–36 (2007)
7. Cioccio, L.D., Teixeira, R., Rosenberg, C.: Measuring home networks with Home-Net profiler. In: Roughan, M., Chang, R. (eds.) PAM 2013. LNCS, vol. 7799, pp. 176–186. Springer, Heidelberg (2013)
8. Croce, D., En-Najjary, T., Urvoy-Keller, G., Biersack, E.: Capacity estimation of ADSL links. In: Proceedings of CoNEXT, December 2008
9. Dischinger, M., Haeberlen, A., Gummadi, K.P., Saroiu, S.: Characterizing residential broadband networks. In: Proceedings of ACM SIGCOMM Internet Measurement Conference, San Diego, CA, USA, October 2007
10. Kanuparthy, P., Dovrolis, C., Papagiannaki, K., Seshan, S., Steenkiste, P.: Can user-level probing detect and diagnose common home-WLAN pathologies. SIGCOMM Comput. Commun. Rev. 42(1), 7–15 (2012)
11. Katabi, D., Blake, C.: Inferring congestion sharing and path characteristics from packet inter-arrival times. Technical report MIT-LCS-TR-828, Massachusetts Institute of Technology (2002)
12. Kim, K.H., Nam, H., Schulzrinne, H.: WiSlow: a Wi-Fi network performance troubleshooting tool for end users. In: IEEE INFOCOM, pp. 862–870 (2014)
13. Lakshminarayanan, K., Sapra, S., Seshan, S., Steenkiste, P.: RFdump: an architecture for monitoring the wireless ether. In: Proceedings of the 5th International Conference on Emerging Networking Experiments and Technologies, CoNEXT 2009, pp. 253–264 (2009)
14. Mahajan, R., Rodrig, M., Wetherall, D., Zahorjan, J.: Analyzing the MAC-level behavior of wireless networks in the wild. In: SIGCOMM 2006, pp. 75–86 (2006)
15. Niculescu, D.: Interference map for 802.11 networks. In: ACM SIGCOMM Internet Measurement Conference, pp. 339–350, San Diego, California, USA, October 2007
16. Rayanchu, S., Mishra, A., Agrawal, D., Saha, S., Banerjee, S.: Diagnosing wireless packet losses in 802.11: separating collision from weak signal. In: INFOCOM 2008, The 27th Conference on Computer Communications, April 2008, pp. 735–743. IEEE (2008)
17. Rayanchu, S., Patro, A., Banerjee, S.: Catching whales and minnows using WiFiNet: deconstructing non-WiFi interference using WiFi hardware. In: USENIX NSDI, San Jose, CA
18. Rayanchu, S., Patro, A., Banerjee, S.: Airshark: detecting non-WiFi RF devices using commodity WiFi hardware. In: ACM SIGCOMM Internet Measurement Conference, pp. 137–154, Berlin, Germany (2011)
19. Sánchez, M.A., Otto, J.S., Bischof, Z.S., Bustamante, F.E.: Trying broadband characterization at home. In: Roughan, M., Chang, R. (eds.) PAM 2013. LNCS, vol. 7799, pp. 198–207. Springer, Heidelberg (2013)
20. Sundaresan, S., de Donato, W., Feamster, N., Teixeira, R., Crawford, S., Pescapé, A.: Broadband internet performance: a view from the gateway. In: ACM SIGCOMM, Toronto, Ontario, Canada, August 2011
21. tcptrace: A TCP connection analysis tool. http://irg.cs.ohiou.edu/software/tcptrace/
22. Zhang, Y., Breslau, L., Paxson, V., Shenker, S.: On the characteristics and origins of internet flow rates. In: Proceedings of ACM SIGCOMM, Pittsburgh, PA, August 2002