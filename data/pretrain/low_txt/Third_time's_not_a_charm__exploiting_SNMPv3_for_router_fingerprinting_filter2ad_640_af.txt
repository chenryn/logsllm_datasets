### Acknowledgments
We would like to express our gratitude to Jonker and the anonymous reviewers for their valuable feedback.

### Funding
This work was partially supported by the European Research Council Starting Grant ResolutioNet (ERC-StG-679158), the German Federal Ministry of Education and Research (BMBF) under grants 01IS18025A and 01IS18037A, and the U.S. National Science Foundation (CNS-1855614). The views and conclusions presented in this document are those of the authors and do not necessarily reflect the official policies or positions of the ERC, BMBF, U.S. government, or the NSF.

### References
1. **Internet Assigned Numbers Authority**. (2021). *PRIVATE ENTERPRISE NUMBERS*. [Online]. Available: https://www.iana.org/assignments/enterprise-numbers/enterprise-numbers

2. **Berger, A., Weaver, N., Beverly, R., & Campbell, L.** (2013). *Internet Nameserver*. In *ACM IMC*.

3. **Beverly, R.** (2002). *RTG: A Scalable SNMP Statistics Architecture for Service Providers*. In *USENIX LISA*.

4. **Beverly, R., Berger, A., Hyun, Y., & claffy, k.** (2009). *Understanding the Efficacy of Deployed Internet Source Address Validation Filtering*. In *ACM IMC*.

5. **Blumenthal, U., & Wijnen, B.** (2002). *User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)*. IETF RFC 3414.

6. **CAIDA**. (2021). *Macroscopic Internet Topology Data Kit (ITDK)*. [Online]. Available: https://www.caida.org/catalog/datasets/internet-topology-data-kit/

7. **CAIDA**. (2021). *The CAIDA AS Ranking*. [Online]. Available: https://asrank.caida.org/

8. **Case, J., Fedor, M., Schoffstall, M., & Davin, J.** (1988). *A Simple Network Management Protocol*. IETF RFC 1067.

9. **Case, J., Fedor, M., Schoffstall, M., & Davin, J.** (1990). *A Simple Network Management Protocol (SNMP)*. IETF RFC 1157.

10. **Case, J., McCloghrie, K., Rose, M., & Waldbusser, S.** (1993). *Coexistence between version 1 and version 2 of the Internet-standard Network Management Framework*. IETF RFC 1452.

11. **Case, J., McCloghrie, K., Rose, M., & Waldbusser, S.** (1993). *Introduction to version 2 of the Internet-standard Network Management Framework*. IETF RFC 1441.

12. **Case, J., McCloghrie, K., Rose, M., & Waldbusser, S.** (1996). *Coexistence between Version 1 and Version 2 of the Internet-standard Network Management Framework*. IETF RFC 1908.

13. **Case, J., McCloghrie, K., Rose, M., & Waldbusser, S.** (1996). *Introduction to Community-based SNMPv2*. IETF RFC 1901.

14. **Censys**. (2021). *Censys Scanning and Data Collection*. [Online]. Available: https://censys.io/

15. **Cisco**. (2021). *Catalyst 2960 and 2960-S Software Configuration Guide, 12.2(55)SE*. [Online]. Available: https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960/software/release/12-2_55_se/configuration/guide/scg_2960/swsnmp.html

16. **Cisco**. (2021). *Cisco Bug: CSCts87275 - Cat4k with sup7e : same snmp engineID on different cat4k switches*. [Online]. Available: https://quickview.cloudapps.cisco.com/quickview/bug/CSCts87275

17. **Cisco PSIRT**. (2021). *SNMP v3 information leaking vulnerability*. [Online]. Available: https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuz00727

18. **Cisco PSIRT**. (2021). *SNMP v3 information leaking vulnerability*. [Online]. Available: https://bst.cloudapps.cisco.com/bugsearch/bug/CSCtw74132

19. **Czyz, J., Luckie, M., Allman, M., & Bailey, M.** (2016). *Don’t Forget to Lock the Back Door! A Characterization of IPv6 Network Security Policy*. In *NDSS*.

20. **Dittrich, D., Kenneally, E., et al.** (2012). *The Menlo Report: Ethical Principles Guiding Information and Communication Technology Research*. U.S. Department of Homeland Security (2012).

21. **Durumeric, Z., Adrian, D., Mirian, A., Bailey, M., & Halderman, J. A.** (2015). *A Search Engine Backed by Internet-Wide Scanning*. In *ACM CCS*.

22. **Durumeric, Z., Wustrow, E., & Halderman, J. A.** (2013). *ZMap: Fast Internet-Wide Scanning and its Security Applications*. In *USENIX Security Symposium*.

23. **Gasser, O., Scheitle, Q., Foremski, P., Lone, Q., Korczynski, M., Strowes, S. D., Hendriks, L., & Carle, G.** (2018). *Clusters in the Expanse: Understanding and Unbiasing IPv6 Hitlists*. In *ACM IMC*.

24. **Gasser, O., Scheitle, Q., Foremski, P., Lone, Q., Korczynski, M., Strowes, S. D., Hendriks, L., & Carle, G.** (2021). *IPv6 Hitlist Service*. [Online]. Available: https://ipv6hitlist.github.io/

25. **Gasser, O., Scheitle, Q., Rudolph, B., Denis, C., Schricker, N., & Carle, G.** (2017). *The Amplification Threat Posed by Publicly Reachable BACnet Devices*. *Journal of Cyber Security and Mobility*, 6(1).

26. **Govindan, R., & Tangmunarunkit, H.** (2000). *Heuristics for Internet Map Discovery*. In *IEEE INFOCOM*.

27. **Gunes, M. H., & Sarac, K.** (2006). *Analytical IP alias resolution*. In *2006 IEEE ICC*.

28. **Hardaker, W.** (2011). *Transport Layer Security (TLS) Transport Model for the Simple Network Management Protocol (SNMP)*. IETF RFC 6353 (Internet Standard). [Online]. Available: https://doi.org/10.17487/RFC6353

29. **Harrington, D., Presuhn, R., & Wijnen, B.** (2002). *An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks*. IETF RFC 3411.

30. **Holland, J., Teixeira, R., Schmitt, P., Borgolte, K., Rexford, J., Feamster, N., & Mayer, J.** (2020). *Classifying Network Vendors at Internet Scale*. arXiv. [Online]. Available: https://arxiv.org/abs/2006.13086

31. **Huawei**. (2021). *S2750, S5700, S6700 V200R003(C00, C02, and C10) Configuration Guide - Network Management and Monitoring*. [Online]. Available: https://support.huawei.com/enterprise/en/doc/EDOC1000027472?section=j005

32. **IEEE**. (2021). *List of MAC OUIs*. [Online]. Available: http://standards-oui.ieee.org/oui/oui.txt

33. **Izhikevich, L., Teixeira, R., & Durumeric, Z.** (2021). *LZR: Identifying Unexpected Internet Services*. In *USENIX Security Symposium*.

34. **Keys, K., Hyun, Y., Luckie, M., & claffy, k.** (2013). *Internet-Scale IPv4 Alias Resolution with MIDAR*. *IEEE/ACM Trans. Networking*, 21(2).

35. **Kohno, T., Broido, A., & Claffy, K. C.** (2005). *Remote Physical Device Fingerprinting*. *IEEE Transactions on Dependable and Secure Computing*, 2(2).

36. **Kührer, M., Hupperich, T., Rossow, C., & Holz, T.** (2014). *Hell of a Handshake: Abusing TCP for Reflective Amplification DDoS Attacks*. In *USENIX WOOT*.

37. **Luckie, M., & Beverly, R.** (2017). *The Impact of Router Outages on the AS-level Internet*. In *ACM SIGCOMM*.

38. **Luckie, M., Beverly, R., & Brinkmeyer, W.** (2013). *Speedtrap: Internet-Scale IPv6 Alias Resolution*. In *ACM IMC*.

39. **Luckie, M., Huffaker, B., & claffy, k.** (2019). *Learning Regexes to Extract Router Names from Hostnames*. In *ACM IMC*.

40. **Marder, A.** (2020). *APPLE: Alias Pruning by Path Length Estimation*. In *PAM*.

41. **MITRE**. (2021). *Common Vulnerabilities and Exposures, SNMP*. [Online]. Available: https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=SNMP

42. **Moore, H. D.** (2020). *Security Surprises with SNMP v3*. [Online]. Available: https://www.rumble.run/blog/security-surprises-with-snmp-v3/

43. **Murdoch, S. J.** (2006). *Hot or not: Revealing hidden services by their clock skew*. In *ACM CCS*.

44. **RIPE NCC**. (2021). *RIPE Atlas*. [Online]. Available: https://atlas.ripe.net/

45. **Net-SNMP Project**. (2021). *Net-SNMP*. [Online]. Available: http://www.net-snmp.org/

46. **Nmap**. (2021). *Nmap: the Network Mapper - Free Security Scanner*. [Online]. Available: https://nmap.org/

47. **Partridge, C., & Allman, M.** (2016). *Ethical Considerations in Network Measurement Papers*. *Commun. ACM*.

48. **Rossow, C.** (2014). *Amplification Hell: Revisiting Network Protocols for DDoS Abuse*. In *NDSS*.

49. **Rye, E. C., & Beverly, R.** (2020). *Discovering the IPv6 Network Periphery*. In *PAM*.

50. **Rye, E. C., Beverly, R., & claffy, k.** (2021). *Follow the Scent: Defeating IPv6 Prefix Rotation Privacy*. In *ACM IMC*.

51. **Sargent, M., Kristoff, J., Paxson, V., & Allman, M.** (2017). *On the Potential Abuse of IGMP*. *ACM CCR*.

52. **Scheitle, Q., Gasser, O., Rouhi, M., & Carle, G.** (2017). *Large-Scale Classification of IPv6-IPv4 Siblings with Variable Clock Skew*. In *TMA*.

53. **Shadowserver**. (2021). *Open SNMP Scanning Project*. [Online]. Available: https://scan.shadowserver.org/snmp/

54. **Sherry, J., Katz-Bassett, E., Pimenova, M., Madhyastha, H., Anderson, T., & Krishnamurthy, A.** (2010). *Resolving IP aliases with prespecified timestamps*. In *ACM IMC*.

55. **Spring, N., Mahajan, R., & Wetherall, D.** (2002). *Measuring ISP topologies with Rocketfuel*. In *ACM SIGCOMM*.

56. **Stallings, W.** (1998). *SNMPv3: A security enhancement for SNMP*. *IEEE Communications Surveys*, 1(1), 2–17.

57. **The Mitre Corporation**. (2012). *CVE-2012-5719*. [Online]. Available: https://cve.mitre.org/cgi-bin/cvename.cgi?name=2012-5719

58. **Thomas, S.** (2021). *Brute forcing SNMPv3 authentication*. [Online]. Available: https://applied-risk.com/resources/brute-forcing-snmpv3-authentication

59. **Vanaubel, Y., Pansiot, J.-J., Merindol, P., & Donnet, B.** (2013). *Network Fingerprinting: TTL-Based Router Signatures*. In *ACM IMC*.

60. **Vermeulen, K., Ljuma, B., Addanki, V., Gouel, M., Fourmaux, O., Friedman, T., & Rejaie, R.** (2020). *Alias Resolution Based on ICMP Rate Limiting*. In *PAM*.

61. **Zander, S., & Murdoch, S. J.** (2008). *An Improved Clock-skew Measurement Technique for Revealing Hidden Services*. In *USENIX Security Symposium*.

### A Comparison of Different Alias Resolution Approaches
Table 3 presents the results for various alias resolution techniques. "First" and "both" refer to using fields from the first scan only versus using fields from both scans for the matching process. The techniques differ only in the matching threshold for the last reboot time; all other fields are matched exactly. "Exact" denotes an exact match of the last reboot time, "Round" means that the last digit is rounded, "Divide by 20" means that the last digit is divided by 20 and cut off (i.e., put into bins of 20 seconds), and "Divide by 20+round" denotes division by 20 and rounding of the resulting floating-point number.

| Method | Alias Sets | Non-Singleton Alias Sets | IPs in Non-Singleton Alias Sets | IPs per Non-Singleton Alias Set |
|--------|------------|--------------------------|---------------------------------|---------------------------------|
| Exact First | 903k | 5.3M | 8.2M | 9.1 |
| Exact Both | 892k | 5.9M | 7.5M | 8.4 |
| Round First | 826k | 4.6M | 8.7M | 10.6 |
| Round Both | 835k | 4.7M | 8.7M | 10.4 |
| Divide by 20 First | 820k | 4.6M | 8.8M | 10.7 |
| Divide by 20 Both | 824k | 4.6M | 8.7M | 10.6 |
| Divide by 20+Round First | 820k | 4.6M | 8.8M | 10.7 |
| Divide by 20+Round Both | 824k | 4.6M | 8.7M | 10.6 |

### Distribution of Routers per AS and Region
Figure 20 illustrates the distribution of routers identified by our technique per network (AS) and per region. To map ASes to countries, we used CAIDA’s AS Ranking [7]. This mapping achieves 99.9% coverage for the ASes with routers in our study, i.e., 22,769 out of 22,789. We are aware that a network may span multiple countries within a continent, so we decided to map a network to a continent (region). For networks that span multiple regions, we typically see different ASes and address space registered in different regions. If this is not the case, we assign the region of the headquarters of the network operator to the AS it owns. Our analysis does not show significant distributional differences across continents. However, most of the networks with the largest number of routers are in North America (NA) and Europe (EU).

### Uniqueness of Last Reboot Time and Engine Time
In addition to the engine ID, SNMP sends engine time and engine boots values in their response. Our alias resolution technique leverages this information as well. By subtracting the engine time from the current time of the scan, we calculate the last reboot time. To learn more about the uniqueness of last reboot time and engine time tuples, we look for cases where the same last reboot time and engine time values are seen at different devices, i.e., devices with different engine IDs. Figure 19 shows the distribution of the same last reboot time and engine time tuples for different numbers of engine IDs. We find that 97.2% and 99.8% of IPv4 and IPv6 addresses have last reboot time and engine time tuples with a single unique engine ID. This demonstrates that this tuple is indeed a valuable addition to our alias resolution technique.