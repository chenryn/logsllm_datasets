以下是优化后的文本，使其更加清晰、连贯和专业：

---

### 参考文献

1. A. Boldyreva and R. Lychev, "Provable Security of S-BGP and Other Path Vector Protocols: Model, Analysis and Extensions," in *CCS '12*. New York, NY, USA: ACM, 2012, pp. 541–552.
2. J. Bonneau, A. Miller, J. Clark, A. Narayanan, J. A. Kroll, and E. W. Felten, "SoK: Research Perspectives and Challenges for Bitcoin and Cryptocurrencies," in *IEEE Symposium on Security and Privacy (SP)*. IEEE, 2015, pp. 104–121.
3. P. Bosshart, D. Daly, G. Gibb, M. Izzard, N. McKeown, J. Rexford, C. Schlesinger, D. Talayco, A. Vahdat, G. Varghese et al., "P4: Programming Protocol-Independent Packet Processors," *ACM SIGCOMM Computer Communication Review*, vol. 44, no. 3, pp. 87–95, 2014.
4. C. Decker and R. Wattenhofer, "Information Propagation in the Bitcoin Network," in *IEEE Thirteenth International Conference on Peer-to-Peer Computing (P2P)*. IEEE, 2013, pp. 1–10.
5. ——, "Bitcoin Transaction Malleability and MtGox," in *Financial Cryptography and Data Security*. Cham: Springer International Publishing, 2014, pp. 313–326. [Online]. Available: http://dx.doi.org/10.1007/978-3-319-11212-1_18
6. M. Edman and P. Syverson, "AS-Awareness in Tor Path Selection," in *Proceedings of the 16th ACM Conference on Computer and Communications Security (CCS '09)*, 2009.
7. I. Eyal, "The Miner's Dilemma," in *IEEE Symposium on Security and Privacy*. IEEE, 2015, pp. 89–103.
8. I. Eyal and E. G. Sirer, "Majority is Not Enough: Bitcoin Mining is Vulnerable," in *Financial Cryptography and Data Security*. Springer, 2014, pp. 436–454.
9. N. Feamster and R. Dingledine, "Location Diversity in Anonymity Networks," in *Workshop on Privacy in the Electronic Society (WPES)*, Washington, DC, USA, October 2004.
10. J. Garay, A. Kiayias, and N. Leonardos, "The Bitcoin Backbone Protocol: Analysis and Applications," in *Advances in Cryptology - EUROCRYPT 2015*. Springer, 2015, pp. 281–310.
11. A. Gervais, G. O. Karama, V. Capkun, and S. Capkun, "Is Bitcoin a Decentralized Currency?" *IEEE Security & Privacy*, vol. 12, no. 3, pp. 54–60, 2014.
12. A. Gervais, H. Ritzdorf, G. O. Karame, and S. Capkun, "Tampering with the Delivery of Blocks and Transactions in Bitcoin," in *Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security (CCS '15)*. New York, NY, USA: ACM, 2015, pp. 692–705.
13. P. Gill, M. Schapira, and S. Goldberg, "Let the Market Drive Deployment: A Strategy for Transitioning to BGP Security," in *SIGCOMM '11*. New York, NY, USA: ACM, 2011, pp. 14–25.
14. S. Goldberg, M. Schapira, P. Hummon, and J. Rexford, "How Secure Are Secure Interdomain Routing Protocols?" in *SIGCOMM*, 2010.
15. E. Heilman, A. Kendler, A. Zohar, and S. Goldberg, "Eclipse Attacks on Bitcoin's Peer-to-Peer Network," in *24th USENIX Security Symposium (USENIX Security 15)*, 2015, pp. 129–144.
16. Y.-C. Hu, A. Perrig, and M. Sirbu, "SPV: Secure Path Vector Routing for Securing BGP," in *SIGCOMM '04*. New York, NY, USA: ACM, 2004, pp. 179–192.
17. J. Karlin, S. Forrest, and J. Rexford, "Pretty Good BGP: Improving BGP by Cautiously Adopting Routes," in *Proceedings of the 2006 IEEE International Conference on Network Protocols (ICNP '06)*. Washington, DC, USA: IEEE Computer Society, 2006, pp. 290–299.
18. E. K. Kogias, P. Jovanovic, N. Gailly, I. Khoffi, L. Gasser, and B. Ford, "Enhancing Bitcoin Security and Performance with Strong Consistency via Collective Signing," in *25th USENIX Security Symposium (USENIX Security 16)*. Austin, TX: USENIX Association, 2016, pp. 279–296.
19. J. A. Kroll, I. C. Davey, and E. W. Felten, "The Economics of Bitcoin Mining, or Bitcoin in the Presence of Adversaries." Citeseer.
20. A. Miller, J. Litton, A. Pachulski, N. Gupta, D. Levin, N. Spring, and B. Bhattacharjee, "Discovering Bitcoin's Public Topology and Influential Nodes."
21. S. J. Murdoch and P. Zieliński, "Sampled Traffic Analysis by Internet-Exchange-Level Adversaries," in *Privacy Enhancing Technologies: 7th International Symposium (PET 2007)*, N. Borisov and P. Golle, Eds. Springer-Verlag, LNCS 4776, 2007, pp. 167–183.
22. K. Nayak, S. Kumar, A. Miller, and E. Shi, "Stubborn Mining: Generalizing Selfish Mining and Combining with an Eclipse Attack," *IACR Cryptology ePrint Archive*, vol. 2015, p. 796, 2015.
23. T. Neudecker, P. Andelfinger, and H. Hartenstein, "A Simulation Model for Analysis of Attacks on the Bitcoin Peer-to-Peer Network," in *IFIP/IEEE International Symposium on Internet Management*. IEEE, 2015, pp. 1327–1332.
24. P. v. Oorschot, T. Wan, and E. Kranakis, "On Interdomain Routing Security and Pretty Secure BGP (PSBGP)," *ACM Transactions on Information and System Security (TISSEC)*, vol. 10, no. 3, Jul. 2007.
25. A. Pilosov and T. Kapela, "Stealing The Internet: An Internet-Scale Man-in-the-Middle Attack." DEFCON 16.
26. Y. Rekhter and T. Li, "A Border Gateway Protocol 4 (BGP-4)," IETF, Mar. 1995, RFC 1771.
27. M. Rosenfeld, "Analysis of Hashrate-Based Double Spending," arXiv preprint arXiv:1402.2009, 2014.
28. A. Sapirshtein, Y. Sompolinsky, and A. Zohar, "Optimal Selfish Mining Strategies in Bitcoin," *CoRR*, vol. abs/1507.06183, 2015.
29. E. B. Sasson, A. Chiesa, C. Garman, M. Green, I. Miers, E. Tromer, and M. Virza, "Zerocash: Decentralized Anonymous Payments from Bitcoin," in *2014 IEEE Symposium on Security and Privacy*. IEEE, 2014, pp. 459–474.
30. B. Schlinker, K. Zarifis, I. Cunha, N. Feamster, and E. Katz-Bassett, "Peering: An AS for Us," in *Proceedings of the 13th ACM Workshop on Hot Topics in Networks (HotNets-XIII)*. New York, NY, USA: ACM, 2014, pp. 18:1–18:7.
31. J. Schnelli, "BIP 151: Peer-to-Peer Communication Encryption," Mar. 2016, https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki.
32. X. Shi, Y. Xiang, Z. Wang, X. Yin, and J. Wu, "Detecting Prefix Hijackings in the Internet with Argus," in *IMC '12*. New York, NY, USA: ACM, 2012, pp. 15–28.
33. Y. Sompolinsky and A. Zohar, "Secure High-Rate Transaction Processing in Bitcoin," in *Financial Cryptography and Data Security*. Springer, 2015, pp. 507–527.
34. Y. Sun, A. Edmundson, L. Vanbever, O. Li, J. Rexford, M. Chiang, and P. Mittal, "RAPTOR: Routing Attacks on Privacy in TOR," in *USENIX Security*, 2015.
35. A. Tonk, "Large Scale BGP Hijack Out of India," 2015, http://www.bgpmon.net/large-scale-bgp-hijack-out-of-india/.
36. ——, "Massive Route Leak Causes Internet Slowdown," 2015, http://www.bgpmon.net/massive-route-leak-cause-internet-slowdown/.
37. L. Vanbever, O. Li, J. Rexford, and P. Mittal, "Anonymity on Quicksand: Using BGP to Compromise TOR," in *ACM HotNets*, 2014.
38. Z. Zhang, Y. Zhang, Y. C. Hu, and Z. M. Mao, "Practical Defenses Against BGP Prefix Hijacking," in *CoNEXT '07*. New York, NY, USA: ACM, 2007.
39. Z. Zhang, Y. Zhang, Y. C. Hu, Z. M. Mao, and R. Bush, "iSPY: Detecting IP Prefix Hijacking on My Own," *IEEE/ACM Transactions on Networking (ToN)*, vol. 18, no. 6, pp. 1815–1828, Dec. 2010.

---

### 附录

#### A. 比特币事件驱动仿真

在本节中，我们将详细介绍我们在第 VIII-B 节中使用的模拟器。

**输入**
- 模拟器的输入包括一个现实的拓扑结构和一些具有更高或更低多宿主度的合成拓扑结构。
- 每个拓扑结构包括运行比特币节点的 IP 地址列表、网关的 IP 地址以及每个矿池的哈希率，以及所有 IP 对之间的转发路径。
- 现实的拓扑结构是通过第 VI 节描述的方法推断出来的。合成拓扑结构则是通过向现实拓扑中的矿池添加更多网关，直到它们达到预定义的多宿主度来创建的。

**模型**
- 模拟器将每个比特币节点建模为一个独立的线程，根据比特币协议对事件作出反应。
- 当一个节点与另一个节点通信时，模拟器会添加一个延迟，该延迟与两个节点之间转发路径上的自治系统（AS）数量成正比。
- 每个节点初始化 8 个连接，遵循默认客户端实现。区块以指数分布生成，平均速率为每 10 分钟一个区块。特定矿池成功挖出一个区块的概率直接取决于其挖矿能力。
- 假设矿池的网关形成一个完全图，并且彼此之间的通信链路没有延迟，攻击者无法拦截这些通信。具体来说，这意味着每当一个矿池产生一个区块时，该区块会同时从该矿池的所有网关传播出去。虽然这种选择使攻击者的有效性降低，但我们假设这是良性矿池的默认行为。

**攻击**
- 在模拟中，如果某个 AS 能够拦截潜在接收方到发送方的流量，那么它可以有效地延迟两个节点之间的区块传递。这本质上是执行如图 4a 所示的攻击。
- 如果攻击者拦截了相反方向的流量，则认为它无法延迟区块。尽管这种选择使攻击者的效果降低，但它避免了孤儿率和时间之间的依赖关系。实际上，随着时间的推移，这些攻击者会失去他们的影响力，因为它们拦截的连接会在第一次有效延迟区块后被丢弃，并可能被未被攻击者拦截的新连接所取代。

**验证**
- 我们通过将模拟器计算的孤儿率和中位传播延迟与实际网络中的数据进行比较来验证我们的模拟器。我们发现这两者都在实际比特币网络的范围内 [20]。

**方法论**
- 我们评估了延迟攻击的影响，考虑了三个最强大的基于国家的联盟（美国、中国和德国），按其所有 AS 看到的流量百分比来衡量。
- 表 IV 列出了基于我们推断的拓扑结构可以创建的所有分区。最左边的列表示隔离集合内的挖矿能力比例，最右边的列表示能够形成该集合的不同矿池组合数量。
- 我们对每组参数进行了 20 次模拟，并在每次运行中使用一个新的随机比特币拓扑结构。每次运行中生成 144 个区块，相当于一天的区块生产量（假设平均每 10 分钟生成一个区块）。我们通过测量不同对手造成的孤儿率来评估延迟攻击的影响。

#### B. 可能的分区

表 IV 显示了所有可能的节点集 P 及其可以隔离的挖矿能力。在第 VII 节中包含了对该表的总结和讨论。

#### C. 推断矿池网关

这里总结了两种利用劫持来揭示矿池网关的方法：

1. 攻击者可以劫持矿池的 Stratum 服务器，以发现它们建立的连接并揭示它们连接到的网关。矿池的 Stratum 服务器与其网关之间的连接是通过 bitcoind 的 RPC 访问完成的，很容易区分。
2. 攻击者可以劫持中继网络来发现大型矿池使用的连接。中继网络有一组公开的六个 IP 地址，矿池连接到这些地址。通过劫持这些地址，可以了解各种网关的 IP 地址。特别是，通过观察每个矿池发布到中继网络的区块，不难识别出矿池。

#### D. 增加分区持久性

我们在第 VII-D 节中的观察揭示了攻击者可以采取的具体方法来延长其分区的持续时间。直观上，攻击者需要抑制节点更换的影响，以保持受害节点的隔离。以下三点观察有助于此目的：

**观察 1**：较小的节点集更容易长时间隔离。节点集越小，任何孤立节点重新启动所需的时间就越长。同样，如果节点集较小，外部节点连接到孤立节点集的概率也较低。

**观察 2**：所有传入连接槽都可以由攻击者节点占用。比特币节点通常限制接受的传入连接数量。攻击者可以使用多个节点积极连接到孤立节点，并在 BGP 路由恢复后继续维持这些连接。外部节点发起的连接将被孤立节点拒绝（因为所有连接槽都被占用了）。

**观察 3**：传出连接可以通过传统的日食攻击 [31] 进行偏置。一旦孤立节点重启，它将尝试与对等列表中的节点建立连接。这些连接可以被偏置为包含攻击者节点、其他孤立节点以及不指向比特币节点的 IP 地址。这是通过积极地向受害节点广告这些 IP 来实现的。重启后形成的连接将倾向于那些维持分区的连接。

#### F. 伦理考量

尽管我们在描述的两次攻击中针对的是连接到比特币网络的节点，但并未干扰它们的正常操作。关于劫持实验，我们宣告并劫持了一个由 Transit Portal (TP) 项目 [46] 分配给我们的前缀。没有其他流量受到我们宣告的影响。此外，孤立的节点是我们自己运行的实验节点。实际连接到这些节点的比特币节点并未受到影响，只是它们的一个连接被占用（就像它们连接到了超级节点一样）。关于延迟实验，受害者也是我们自己的比特币客户端。虽然它们确实连接到了真实网络中的节点，但这些节点并未受到影响，因为我们只修改了发往受害节点的数据包。

#### E. 常见问题解答

**比特币中继能否桥接分区？**
虽然比特币中继 [13] 提高了比特币性能，但它们并不能提高比特币对路由攻击的安全性。事实上，由于中继的 IP 是公开的，中继也容易受到劫持和被动攻击。因此，它们既不能桥接分区，也不能在实际网络攻击发生时充当受保护的中继。请注意，路由攻击与 DDoS 攻击完全不同，后者中继很可能受到保护。路由攻击更为复杂，因为它是一个高度依赖于受害者提供商而非受害者本身的人为过程。例如，劫持的缓解措施可能包括攻击者的提供商将其断开连接，或者在全球范围内过滤其宣告，前提是劫持已被受害者的提供商检测到。

**NAT 后的节点能否桥接分区？**
所有位于 NAT 后面的节点都像简单的节点一样，不接受连接。事实上，通过劫持相应的公共 IP，攻击者可以接收到发往所有这些节点的流量。在第 IV 节中，我们解释了为什么简单节点不能桥接分区，同样的情况也适用于 NAT 后的节点。

**比特币路由替代方案能否解决本文提出的攻击？**
类似于比特币中继，现有的提案确实可以通过应对当前互联网的自然限制（如延迟和数据包丢失）来加快区块传输速度。例如，FIBRE [8] 使用前向纠错（FEC）和压缩来加速区块传输。同时，Falcon [7] 使用一种称为 cut-through 路由的技术，在存在较大网络延迟的情况下实现快速区块传输。然而，上述方法均未解决 BGP 劫持或流量窃听等形式的路由攻击。

---

希望这些优化能帮助您更好地理解和使用这些参考文献和附录内容。