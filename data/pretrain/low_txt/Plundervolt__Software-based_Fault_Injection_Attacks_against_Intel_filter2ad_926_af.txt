### Funding Acknowledgment

This research is partially supported by the Engineering and Physical Sciences Research Council (EPSRC) under grants EP/R012598/1 and EP/R008000/1, and by the European Union’s Horizon 2020 research and innovation program under grant agreements No. 779391 (FutureTPM) and No. 681402 (SOPHIA).

---

### References

1. Ittai Anati, Shay Gueron, Simon Johnson, and Vincent Scarlata. "Innovative Technology for CPU-Based Attestation and Sealing." In *Proceedings of the 2nd International Workshop on Hardware and Architectural Support for Security and Privacy*, volume 13. ACM, New York, NY, USA, 2013.

2. Christian Aumüller, Peter Bier, Wieland Fischer, Peter Hofreiter, and Jean-Pierre Seifert. "Fault Attacks on RSA with CRT: Concrete Results and Practical Countermeasures." In *CHES 2002*.

3. Zelalem Birhanu Aweke, Salessawi Ferede Yitbarek, Rui Qiao, Reetuparna Das, Matthew Hicks, Yossi Oren, and Todd Austin. "ANVIL: Software-Based Protection Against Next-Generation Rowhammer Attacks." *ACM SIGPLAN Notices*, 2016.

4. Hagai Bar-El, Hamid Choukri, David Naccache, Michael Tunstall, and Claire Whelan. "The Sorcerer’s Apprentice Guide to Fault Attacks." *Proceedings of the IEEE*, 94(2):370–382, 2006.

5. Guillaume Barbu, Hugues Thiebeauld, and Vincent Guerin. "Attacks on Java Card 3.0 – Combining Fault and Logical Attacks." In *CARDIS '10*, edited by Dieter Gollmann, Jean-Louis Lanet, and Julien Iguchi-Cartigny, pages 148–163. Springer, Berlin, Heidelberg, 2010.

6. Sarani Bhattacharya and Debdeep Mukhopadhyay. "Curious Case of Rowhammer: Flipping Secret Exponent Bits Using Timing Analysis." In *CHES 2016*.

7. Eli Biham and Adi Shamir. "Differential Fault Analysis of Secret Key Cryptosystems." In *Proceedings of the 17th Annual International Cryptology Conference on Advances in Cryptology – CRYPTO'97*, pages 513–525, 1997.

8. Andrea Biondo, Mauro Conti, Lucas Davi, Tommaso Frassetto, and Ahmad-Reza Sadeghi. "The Guard’s Dilemma: Efficient Code-Reuse Attacks Against Intel SGX." In *27th USENIX Security Symposium (USENIX Security 18)*, pages 1213–1227, Baltimore, MD, 2018. USENIX Association.

9. Dan Boneh, Richard A. DeMillo, and Richard J. Lipton. "On the Importance of Checking Computations." In *Proceedings of Eurocrypt'97*, pages 37–51, 1997.

10. Ferdinand Brasser, Lucas Davi, David Gens, Christopher Liebchen, and Ahmad-Reza Sadeghi. "CAn’t Touch This: Software-Only Mitigation Against Rowhammer Attacks Targeting Kernel Memory." In *USENIX Security Symposium*, 2017.

11. Guoxing Chen, Sanchuan Chen, Yuan Xiao, Yinqian Zhang, Zhiqiang Lin, and Ten H. Lai. "SGXpectre: Stealing Intel Secrets from SGX Enclaves via Speculative Execution." In *2019 IEEE European Symposium on Security and Privacy (EuroS&P)*, pages 142–157. IEEE, 2019.

12. Marco Chiappetta, Erkay Savaş, and Cemal Yılmaz. "Real-Time Detection of Cache-Based Side-Channel Attacks Using Hardware Performance Counters." ePrint 2015/1034, 2015.

13. Jonathan Corbet. "Defending Against Rowhammer in the Kernel," October 2016. Online, accessed 2019-08-01: <https://lwn.net/Articles/704920/>.

14. Victor Costan and Srinivas Devadas. "Intel SGX Explained." 2016.

15. Christoph Dobraunig, Maria Eichlseder, Thomas Korak, Victor Lomné, and Florian Mendel. "Statistical Fault Attacks on Nonce-Based Authenticated Encryption Schemes." In *ASIACRYPT 2016*, edited by Jung Hee Cheon and Tsuyoshi Takagi, pages 369–395. Springer, Berlin, Heidelberg, 2016.

16. Úlfar Erlingsson, Yves Younan, and Frank Piessens. "Low-Level Software Security by Example." In *Handbook of Information and Communication Security*, pages 633–658. Springer, 2010.

17. Junfeng Fan and Ingrid Verbauwhede. "An Updated Survey on Secure ECC Implementations: Attacks, Countermeasures, and Cost." Pages 265–282. Springer, Berlin, Heidelberg, 2012.

18. T. Fuhr, E. Jaulmes, V. Lomné, and A. Thillard. "Fault Attacks on AES with Faulty Ciphertexts Only." In *2013 Workshop on Fault Diagnosis and Tolerance in Cryptography*, pages 108–118, August 2013.

19. Benedikt Gierlichs, Jörn-Marc Schmidt, and Michael Tunstall. "Infective Computation and Dummy Rounds: Fault Protection for Block Ciphers Without Check-Before-Output." In *LATINCRYPT '12*, edited by Alejandro Hevia and Gregory Neven, pages 305–321. Springer, Berlin, Heidelberg, 2012.

20. S. Govindavajhala and A. W. Appel. "Using Memory Errors to Attack a Virtual Machine." In *S&P 2003*, pages 154–165, May 2003.

21. Daniel Gruss, Moritz Lipp, Michael Schwarz, Daniel Genkin, Jonas Juffinger, Sioli O’Connell, Wolfgang Schoechl, and Yuval Yarom. "Another Flip in the Wall of Rowhammer Defenses." In *S&P 2018*.

22. Daniel Gruss, Clémentine Maurice, and Stefan Mangard. "Rowhammer.js: A Remote Software-Induced Fault Attack in JavaScript." In *DIMVA 2016*.

23. Daniel Gruss, Clémentine Maurice, Klaus Wagner, and Stefan Mangard. "Flush+Flush: A Fast and Stealthy Cache Attack." In *DIMVA 2016*.

24. Shay Gueron. "A Memory Encryption Engine Suitable for General Purpose Processors." ePrint 2016/204, 2016.

25. Jago Gyselinck, Jo Van Bulck, Frank Piessens, and Raoul Strackx. "Off-Limits: Abusing Legacy x86 Memory Segmentation to Spy on Enclaved Execution." In *ESSoS 2018*.

26. Hagai Bar-El, Hamid Choukri, David Naccache, Michael Tunstall, and Claire Whelan. "The Sorcerer’s Apprentice Guide to Fault Attacks." *Proceedings of the IEEE*, 94, 2006.

27. Nishad Herath and Anders Fogh. "These Are Not Your Grand Daddy's CPU Performance Counters – CPU Hardware Performance Counters for Security." In *Black Hat Briefings*, 2015.

28. Petr Hošek and Cristian Cadar. "Varan the Unbelievable: An Efficient N-Version Execution Framework." In *ACM SIGPLAN Notices*, volume 50, pages 339–353. ACM, 2015.

29. Michael Hutter and Jörn-Marc Schmidt. "The Temperature Side Channel and Heating Fault Attacks." In *International Conference on Smart Card Research and Advanced Applications*, pages 219–235. Springer, 2013.

30. Infineon. "OptiMOS IPOL DC-DC Converter Single-Input Voltage, 30 A Buck Regulators with SVID." Online, accessed 2019-07-29: <https://www.infineon.com/cms/de/product/power/dc-dc-converter/integrated-dc-dc-pol-converters/ir38163m/> (2019).

31. Intel. "Processor Voltage Power Delivery Design Guide." Online, accessed 2019-07-29: <https://www.intel.com/content/www/us/en/power-management/voltage-regulator-down-11-1-processor-power-delivery-guidelines.html> (2009).

32. Intel. "L1 Terminal Fault SA-00161." August 2018.

33. Intel. "7th Generation Intel Processor Families for U/Y Platforms and 8th Generation Intel Processor Family for U Quad-Core and Y Dual Core Platforms." Datasheet, Volume 1 of 2, revision 006, January 2019.

34. Intel. "Developer Reference for Intel Integrated Performance Primitives Cryptography – Example of Using RSA Primitive Functions." Online, accessed 2019-07-29: <https://software.intel.com/en-us/ipp-crypto-reference-2019-example-of-using-rsa-primitive-functions> (2019).

35. Intel. "Get Started with the SDK." Online, accessed 2019-05-10: <https://software.intel.com/en-us/sgx/sdk> (2019).

36. Intel. "Intel® 64 and IA-32 Architectures Software Developer’s Manual; Volume 2 (2A, 2B, 2C & 2D)." Number 325383-070US. May 2019.

37. Gorka Irazoqui, Thomas Eisenbarth, and Berk Sunar. "MASCAT: Stopping Microarchitectural Attacks Before Execution." ePrint 2016/1196, 2017.

38. Yeongjin Jang, Jaehyuk Lee, Sangho Lee, and Taesoo Kim. "SGX-Bomb: Locking Down the Processor via Rowhammer Attack." In *SysTEX 2017*.

39. Simon Johnson. "An Update on 3rd Party Attestation." Online, accessed 2019-07-30: <https://software.intel.com/en-us/blogs/2018/12/09/an-update-on-3rd-party-attestation> (December 2018).

40. Naghmeh Karimi, Arun Karthik Kanuparthi, Xueyang Wang, Özgür Sinanoglu, and Ramesh Karri. "MAGIC: Malicious Aging in Circuits/Cores." *ACM Transactions on Architecture and Code Optimization (TACO)*, 12(1), 2015.

41. Yoongu Kim, Ross Daly, Jeremie Kim, Chris Fallin, Ji Hye Lee, Donghyuk Lee, Chris Wilkerson, Konrad Lai, and Onur Mutlu. "Flipping Bits in Memory Without Accessing Them: An Experimental Study of DRAM Disturbance Errors." In *ISCA 2014*.

42. Paul Kocher, Jann Horn, Anders Fogh, Daniel Genkin, Daniel Gruss, Werner Haas, Mike Hamburg, Moritz Lipp, Stefan Mangard, Thomas Prescher, Michael Schwarz, and Yuval Yarom. "Spectre Attacks: Exploiting Speculative Execution." In *S&P 2019*.

43. Koen Koning, Herbert Bos, and Cristiano Giuffrida. "Secure and Efficient Multi-Variant Execution Using Hardware-Assisted Process Virtualization." In *2016 46th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN)*, pages 431–442. IEEE, 2016.

44. Andrew Kwong, Daniel Genkin, Daniel Gruss, and Yuval Yarom. "RAMBleed: Reading Bits in Memory Without Accessing Them." In *41st IEEE Symposium on Security and Privacy (S&P)*, 2020.

45. Jaehyuk Lee, Jinsoo Jang, Yeongjin Jang, Nohyun Kwak, Yeseul Choi, Changho Choi, Taesoo Kim, Marcus Peinado, and Brent ByungHoon Kang. "Hacking in Darkness: Return-Oriented Programming Against Secure Enclaves." In *26th USENIX Security Symposium (USENIX Security 17)*, pages 523–539, Vancouver, BC, 2017. USENIX Association.

46. Sangho Lee, Ming-Wei Shih, Prasun Gera, Taesoo Kim, Hyesoon Kim, and Marcus Peinado. "Inferring Fine-Grained Control Flow Inside SGX Enclaves with Branch Shadowing." In *USENIX Security Symposium*, 2017.

47. Francis X. McKeen, Carlos V. Rozas, Uday R. Savagaonkar, Simon P. Johnson, Vincent Scarlata, Michael A. Goldsmith, Ernie Brickell, Jiang Tao Li, Howard C. Herbert, Prashant Dewan, et al. "Method and Apparatus to Provide Secure Application Execution." US Patent 9,087,200, July 21, 2015.

48. Microsoft. "Open Enclave SDK." Online, accessed 2019-05-10: <https://openenclave.io/sdk/> (2019).

49. Miha Eleršič. "Guide to Linux Undervolting for Haswell and Never Intel CPUs." Online, accessed 2019-07-29: <https://github.com/mihic/linux-intel-undervolt> (2019).

50. Ahmad Moghimi, Thomas Eisenbarth, and Berk Sunar. "MemJam: A False Dependency Attack Against Constant-Time Crypto Implementations in SGX." In *CT-RSA 2018*.

51. NotebookReview. "The ThrottleStop Guide." Online, accessed 2019-07-29: <http://forum.notebookreview.com/threads/the-throttlestop-guide.531329/> (2019).

52. Nahmsuk Oh, Philip P. Shirvani, and Edward J. McCluskey. "Error Detection by Duplicated Instructions in Super-Scalar Processors." *IEEE Transactions on Reliability*, 51(1):63–75, 2002.

53. Matthias Payer. "HexPADS: A Platform to Detect 'Stealth' Attacks." In *ESSoS 2016*.

54. Christian Priebe, Divya Muthukumaran, Joshua Lind, Huanzhou Zhu, Shujie Cui, Vasily A. Sartakov, and Peter Pietzuch. "SGX-LKL: Securing the Host OS Interface for Trusted Execution." arXiv preprint arXiv:1908.11143, 2019.

55. Kaveh Razavi, Ben Gras, Erik Bosman, Bart Preneel, Cristiano Giuffrida, and Herbert Bos. "Flip Feng Shui: Hammering a Needle in the Software Stack." In *USENIX Security Symposium*, 2016.

56. George A. Reis, Jonathan Chang, Neil Vachharajani, Ram Rangan, and David I. August. "SWIFT: Software Implemented Fault Tolerance." In *Proceedings of the International Symposium on Code Generation and Optimization*, pages 243–254. IEEE Computer Society, 2005.

57. RightMark Gathering. "RMClock Utility." Online, accessed 2019-07-29: <http://cpu.rightmark.org/products/rmclock.shtml> (2019).

58. Michael Schwarz, Daniel Gruss, Samuel Weiser, Clémentine Maurice, and Stefan Mangard. "Malware Guard Extension: Using SGX to Conceal Cache Attacks." In *DIMVA 2017*.

59. Michael Schwarz, Moritz Lipp, Daniel Moghimi, Jo Van Bulck, Julian Stecklina, Thomas Prescher, and Daniel Gruss. "ZombieLoad: Cross-Privilege-Boundary Data Sampling." In *Proceedings of the 26th ACM Conference on Computer and Communications Security (CCS'19)*. ACM, November 2019.

60. Mark Seaborn and Thomas Dullien. "Exploiting the DRAM Rowhammer Bug to Gain Kernel Privileges." In *Black Hat Briefings*, 2015.

61. Jaebaek Seo, Byoungyoung Lee, Seong Min Kim, Ming-Wei Shih, Insik Shin, Dongsu Han, and Taesoo Kim. "SGX-Shield: Enabling Address Space Layout Randomization for SGX Programs." In *NDSS 2017*.

62. Sergei P. Skorobogatov. "Copy Protection in Modern Microcontrollers." Online, accessed 2019-07-29: <http://www.cl.cam.ac.uk/~sps32/mcu_lock.html> (2001).

63. Sergei P. Skorobogatov and Ross J. Anderson. "Optical Fault Induction Attacks." In *CHES 2002*, edited by Burton S. Kaliski, Çetin K. Koç, and Christof Paar, pages 2–12. Springer, Berlin, Heidelberg, 2003.

64. Adrian Tang. "Security Engineering of Hardware-Software Interface." PhD thesis, Columbia University, 2018.

65. Adrian Tang, Sethumadhavan, and Salvatore Stolfo. "CLKSCREW: Exposing the Perils of Security-Oblivious Energy Management." In *USENIX Security Symposium*, 2017.

66. Florian Tramer, Fan Zhang, Huang Lin, Jean-Pierre Hubaux, Ari Juels, and Elaine Shi. "Sealed-Glass Proofs: Using Transparent Enclaves to Prove and Sell Knowledge." In *2017 IEEE European Symposium on Security and Privacy (EuroS&P)*, pages 19–34. IEEE, 2017.

67. Chia-Che Tsai, Donald E. Porter, and Mona Vij. "Graphene-SGX: A Practical Library OS for Unmodified Applications on SGX." In *2017 USENIX Annual Technical Conference (USENIX ATC)*, 2017.

68. Michael Tunstall, Debdeep Mukhopadhyay, and Subidh Ali. "Differential Fault Analysis of the Advanced Encryption Standard Using a Single Fault." In *Information Security Theory and Practice. Security and Privacy of Mobile Devices in Wireless Communication*, edited by Claudio A. Ardagna and Jianying Zhou, pages 224–233. Springer Berlin Heidelberg, 2011.

69. Jo Van Bulck, Marina Minkin, Ofir Weisse, Daniel Genkin, Baris Kasikci, Frank Piessens, Mark Silberstein, Thomas F. Wenisch, Yuval Yarom, and Raoul Strackx. "Foreshadow: Extracting the Keys to the Intel SGX Kingdom with Transient Out-of-Order Execution." In *USENIX Security Symposium*, 2018.

70. Jo Van Bulck, David Oswald, Eduard Marin, Abdulla Aldoseri, Flavio Garcia, and Frank Piessens. "A Tale of Two Worlds: Assessing the Vulnerability of Enclave Shielding Runtimes." In *Proceedings of the 26th ACM Conference on Computer and Communications Security (CCS'19)*. ACM, November 2019.

71. Jo Van Bulck, Frank Piessens, and Raoul Strackx. "SGX-Step: A Practical Attack Framework for Precise Enclave Execution Control." In *Proceedings of the 2nd Workshop on System Software for Trusted Execution*, page 4. ACM, 2017. <https://github.com/jovanbulck/sgx-step>.

72. Jo Van Bulck, Frank Piessens, and Raoul Strackx. "Nemesis: Studying Microarchitectural Timing Leaks in Rudimentary CPU Interrupt Logic." In *Proceedings of the 25th ACM Conference on Computer and Communications Security (CCS'18)*. ACM, October 2018.

73. Jo Van Bulck, Nico Weichbrodt, Rüdiger Kapitza, Frank Piessens, and Raoul Strackx. "Telling Your Secrets Without Page Faults: Stealthy Page Table-Based Attacks on Enclaved Execution." In *Proceedings of the 26th USENIX Security Symposium*. USENIX Association, August 2017.

74. Victor van der Veen, Yanick Fratantonio, Martina Lindorfer, Daniel Gruss, Clémentine Maurice, Giovanni Vigna, Herbert Bos, Kaveh Razavi, and Cristiano Giuffrida. "DRAMmer: Deterministic Rowhammer Attacks on Mobile Platforms." In *CCS 2016*.

75. Stephan van Schaik, Alyssa Milburn, Sebastian Österlund, Pietro Frigo, Giorgi Maisuradze, Kaveh Razavi, Herbert Bos, and Cristiano Giuffrida. "RIDL: Rogue In-Flight Data Load." In *S&P 2019*.

76. Stijn Volckaert, Bart Coppens, Alexios Voulimeneas, Andrei Homescu, Per Larsen, Bjorn De Sutter, and Michael Franz. "Secure and Efficient Application Monitoring and Replication." In *2016 USENIX Annual Technical Conference (ATC16)*, pages 167–179, 2016.

77. Yuan Xiao, Xiaokuan Zhang, Yinqian Zhang, and Radu Teodorescu. "One Bit Flips, One Cloud Flops: Cross-VM Row Hammer Attacks and Privilege Escalation." In *USENIX Security Symposium*, 2016.

78. Yuanzhong Xu, Weidong Cui, and Marcus Peinado. "Controlled-Channel Attacks: Deterministic Side Channels for Untrusted Operating Systems." In *Proceedings of the 26th ACM Conference on Computer and Communications Security (CCS'19)*. ACM, November 2019.

---

**Authorized Use and Download Information**

- **Authorized licensed use limited to:** Tsinghua University.
- **Downloaded on:** March 19, 2021, at 10:04:35 UTC from IEEE Xplore.
- **Restrictions apply.**

---

This version of the references has been formatted for clarity and consistency, ensuring that each entry is complete and properly cited.