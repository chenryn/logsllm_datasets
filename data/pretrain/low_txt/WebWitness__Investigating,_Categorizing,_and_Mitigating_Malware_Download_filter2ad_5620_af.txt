### 6. 相关工作

客户端蜜罐通过主动访问网页并检测驱动下载来识别恶意网站。这些系统通过观察系统变化 [1, 21, 22, 28, 29] 或分析响应中的恶意内容 [3, 10, 24] 来实现这一目标。这类系统通常具有较低的误报率，但只能通过使用可被利用的浏览器配置访问网站来发现恶意站点；此外，由于它们比静态爬虫慢得多，因此在爬取页面数量上存在限制。候选URL通常通过过滤静态爬虫的内容 [28, 29, 35]、使用启发式方法访问可能更恶意的网页部分 [8] 或利用搜索引擎查找与已知恶意网页相似的内容 [12] 来选择。

多种技术已被开发用于通过检查内容来检测驱动下载 [10, 11, 15, 32, 34]。基于签名的入侵检测系统（如Snort [34]）被动地搜索网络流量中的已知攻击模式。静态 [11] 和动态 [10] 的JavaScript分析也被用于检测攻击。然而，内容复杂且受攻击者控制，多态恶意软件和代码混淆会导致基于签名和静态分析系统的漏报，而动态分析则可能被恶意软件检测到并通过改变执行路径来规避 [15]。

其他系统则关注导致驱动下载的重定向链。Stringhini等人 [36] 通过聚合以同一网页结束的重定向链来创建重定向图，并利用重定向图和访问用户的相关特征对网页进行分类。Mekky等人 [20] 使用引用和重定向头以及内容中嵌入的URL构建浏览活动树，并提取每个树的重定向链特征来分类活动是否恶意。Li等人 [17] 应用PageRank算法于部分标记的重定向链，以分离良性与恶意的网络路径。他们发现大多数恶意路径通过流量分发系统进行引导。利用重定向链的特征，Surf [18] 可以检测搜索引擎结果中的恶意网站（由于搜索中毒），而WarningBird [16] 则可以识别Twitter上发布的恶意网页。这些系统专注于重定向链及其提取的特征，以分类网络活动为良性或恶意。相比之下，WebWitness通过重建完整的下载路径（不仅仅是重定向链）、分类下载原因（驱动下载、社会工程、更新）并识别参与攻击的域名角色，提供了恶意下载的上下文。

静态黑名单 [2] 和域名声誉系统 [4, 5] 通过识别恶意网站来防止用户访问。许多静态黑名单上的域名是频繁变更的恶意软件和下载域名，这使得它们的效果有限。另一方面，声誉系统仅提供一个恶意评分，而不指示其角色或提供攻击的上下文。通过分析恶意下载的结构，WebWitness可以识别攻击类型和域名角色，从而提供最高价值的域名进行封锁和声誉训练数据。

最近，研究人员提出了可执行文件声誉系统 [13, 30, 38] 以克服基于签名的防病毒软件的局限性 [27]。这些系统不再依赖于可执行文件的内容特征，而是关注恶意软件分发基础设施的属性。尽管这些系统在识别恶意下载方面非常有效，但它们不提供诸如用户如何以及为何下载恶意可执行文件等上下文信息。提供下载上下文是WebWitness的目标，而不是恶意可执行文件的检测。我们认为这些系统与WebWitness是互补的，并且是替代我们当前恶意可执行文件检测Oracle（基于签名的防病毒软件）的良好候选。

网络流量重建也已有研究，例如 [9, 25, 39]。WebPatrol [9] 使用客户端蜜罐和修改后的Web代理收集并重放基于Web的恶意软件场景。与WebPatrol不同，WebWitness不仅限于通过客户端蜜罐触发的驱动下载，还可以为真实用户在实时网络中遇到的驱动下载和社会工程攻击提供上下文。ReSurf [39] 使用引用头构建相关HTTP事务图以重构Web浏览活动。正如本文讨论并在 [25] 中评估的那样，这种方法在重构恶意可执行文件的完整下载路径方面非常有限。最后，ClickMiner [25] 通过在仪器化的浏览器中重放记录的网络流量来重构用户-浏览器交互。它的重点在于用户行为导致访问特定网页的过程，而WebWitness则识别导致恶意下载的攻击原因和结构。

### 7. 结论

我们提出了一种新颖的调查系统——WebWitness。该系统有两个主要目标：1) 自动追溯并标记导致恶意软件下载的事件链（例如，访问过的网页），以突出用户是如何到达攻击页面的；2) 利用这些自动标记的真实恶意软件下载路径，更好地了解当前的攻击趋势，并开发更有效的防御措施。

我们在一个大型学术网络上部署了WebWitness长达10个月，在此期间收集并分类了数千条实时恶意软件下载路径。通过对这些标记数据的分析，我们设计了一种新的防御措施，针对注入恶意内容（黑客合法网页）的驱动下载。例如，我们展示了通过使用WebWitness的结果，可以将基于恶意内容注入的驱动下载感染率降低近6倍，相比现有的URL黑名单方法。

### 致谢

本研究部分得到了美国国家科学基金会（NSF）资助（项目编号CNS-1149051）和美国商务部（Commerce）资助（项目编号2106DEK）。本文所表达的观点、发现及结论或建议仅代表作者个人观点，并不一定反映NSF和商务部的观点。

### 参考文献

[1] Capture-hpc 客户端蜜罐. https://projects.honeynet.org/capture-hpc.
[2] Google 安全浏览 API. https://developers.google.com/safe-browsing/.
[3] Honeyc. https://projects.honeynet.org/honeyc.
[4] ANTONAKAKIS, M., PERDISCI, R., DAGON, D., LEE, W., AND FEAMSTER, N. 构建DNS动态声誉系统. 在第19届USENIX安全研讨会 (USENIX Security '10) 上发表 (2010).
[5] ANTONAKAKIS, M., PERDISCI, R., LEE, W., DAGON, D., AND VASILOGLOU, N. 在DNS高层检测恶意域名. 在第20届USENIX安全研讨会 (USENIX Security '11) 上发表 (2011).
[6] BAKHSHI, T., PAPADAKI, M., AND FURNELL, S. 社会工程漏洞的实际评估. 在第二届国际信息安全与保障研讨会 (HAISA 2008) 上发表 (2008), pp. 12–23.
[7] BREIMAN, L. 随机森林. 机器学习 45, 1 (2001年10月).
[8] CANALI, D., COVA, M., VIGNA, G., AND KRUEGEL, C. Prophiler: 大规模恶意网页检测的快速过滤器. 在第20届国际万维网会议 (WWW '11) 上发表 (2011).
[9] CHEN, K. Z., GU, G., ZHUGE, J., NAZARIO, J., AND HAN, X. Webpatrol: 基于Web的恶意软件场景的自动化收集和重放. 在第六届ACM信息、计算机和通信安全研讨会 (ASIACCS '11) 上发表 (2011).
[10] COVA, M., KRUEGEL, C., AND VIGNA, G. 驱动下载攻击和恶意JavaScript代码的检测与分析. 在第19届国际万维网会议 (WWW '10) 上发表 (2010).
[11] CURTSINGER, C., LIVSHITS, B., ZORN, B., AND SEIFERT, C. Zozzle: 浏览器内快速精确的JavaScript恶意软件检测. 在第20届USENIX安全会议 (SEC'11) 上发表 (2011).
[12] INVERNIZZI, L., BENVENUTI, S., COVA, M., COMPARETTI, P. M., KRUEGEL, C., AND VIGNA, G. Evilseed: 寻找恶意网页的引导方法. 在2012 IEEE安全与隐私研讨会上发表 (SP '12) (2012).
[13] INVERNIZZI, L., LEE, S.-J., MISKOVIC, S., MELLIA, M., TORRES, R., KRUEGEL, C., SAHA, S., AND VIGNA, G. Nazca: 在大规模网络中检测恶意软件分发.
[14] JONES, M. 保护隐私的引用, 2010. https://www.facebook.com/notes/facebook-engineering/protecting-privacy-with-referrers/392382738919.
[15] KAPRAVELOS, A., SHOSHITAISHVILI, Y., COVA, M., KRUEGEL, C., AND VIGNA, G. Revolver: 自动检测逃避型基于Web的恶意软件. 在第22届USENIX安全会议 (SEC'13) 上发表 (2013).
[16] LEE, S., AND KIM, J. Warningbird: Twitter流中可疑URL的近实时检测系统. IEEE Dependable and Secure Computing Transactions 10, 3 (2013年5月).
[17] LI, Z., ALRWAIS, S., XIE, Y., YU, F., AND WANG, X. 发现暗网的关键节点: 恶意网络基础设施中的顶级主机研究. 在2013 IEEE安全与隐私研讨会上发表 (SP '13) (2013).
[18] LU, L., PERDISCI, R., AND LEE, W. Surf: 搜索中毒的检测与测量. 在第18届ACM计算机与通信安全会议 (CCS '11) 上发表 (2011).
[19] LU, L., YEGNESWARAN, V., PORRAS, P., AND LEE, W. Blade: 一种攻击无关的方法预防驱动下载恶意软件感染. 在第17届ACM计算机与通信安全会议 (CCS '10) 上发表 (2010).
[20] MEKKY, H., TORRES, R., ZHANG, Z.-L., SAHA, S., AND NUCCI, A. 使用用户浏览活动树检测恶意HTTP重定向. 在2014 IEEE INFOCOM会议上发表 (2014).
[21] MIN WANG, Y., BECK, D., JIANG, X., ROUSSEV, R., VERBOWSKI, C., CHEN, S., AND KING, S. 使用Strider蜜罐自动巡逻Web: 发现利用浏览器漏洞的网站. 在NDSS会议上发表 (2006).
[22] MOSHCHUK, E., BRAGIN, T., GRIBBLE, S. D., AND LEVY, H. M. 基于爬虫的网络间谍软件研究.
[23] NAPPA, A., RAFIQUE, M. Z., AND CABALLERO, J. 云端驾驶: 驱动下载操作和滥用报告分析. 在第10届入侵检测、恶意软件和漏洞评估国际会议 (DIMVA'13) 上发表 (2013).
[24] NAZARIO, J. Phoneyc: 虚拟客户端蜜罐. 在第二届大规模漏洞和新兴威胁大会 (LEET'09) 上发表 (2009).
[25] NEASBITT, C., PERDISCI, R., LI, K., AND NELMS, T. Clickminer: 从网络痕迹中取证重构用户-浏览器交互. 在2014 ACM SIGSAC计算机与通信安全会议 (CCS '14) 上发表 (2014).
[26] NELMS, T., PERDISCI, R., AND AHAMAD, M. Execscent: 使用自适应控制协议模板在实时网络中挖掘新的C&C域名. 在第22届USENIX安全会议 (SEC'13) 上发表 (2013).
[27] PERDISCI, R., LANZI, A., AND LEE, W. 打包可执行文件的分类以实现准确的计算机病毒检测. 模式识别字母.
[28] PROVOS, N., MAVROMMATIS, P., RAJAB, M. A., AND MONROSE, F. 你的所有iframe都指向我们. 在第17届安全研讨会 (SS'08) 上发表 (2008).
[29] PROVOS, N., MCNAMEE, D., MAVROMMATIS, P., WANG, K., AND MODADUGU, N. 浏览器中的幽灵: 基于Web的恶意软件分析. 在第一届Botnets热点话题研讨会 (Hot-Bots'07) 上发表 (2007).
[30] RAJAB, M. A., BALLARD, L., LUTZ, N., MAVROMMATIS, P., AND PROVOS, N. Camp: 内容无关的恶意软件防护. 在年度网络和分布式系统安全研讨会 (NDSS) 上发表 (2013).
[31] RAJAB, M. A., BALLARD, L., MAVROMMATIS, P., PROVOS, N., AND ZHAO, X. 网络上的安慰剂效应: 假反病毒软件分发分析. 在第三届大规模漏洞和新兴威胁大会 (LEET'10) 上发表 (2010).
[32] RATANAWORABHAN, P., LIVSHITS, B., AND ZORN, B. Nozzle: 防御堆喷射代码注入攻击. 在第18届USENIX安全研讨会 (SSYM'09) 上发表 (2009).
[33] RIECK, K., KRUEGER, T., AND DEWALD, A. Cujo: 高效检测和预防驱动下载攻击. 在第26届计算机安全应用年度会议 (ACSAC '10) 上发表 (2010).
[34] ROESCH, M. Snort - 网络轻量级入侵检测. 在第13届USENIX系统管理会议 (1999) 上发表.
[35] STOKES, J. W., ANDERSEN, R., SEIFERT, C., AND CHELLAPILLA, K. Webcop: 在Web上定位恶意软件社区. 在第三届大规模漏洞和新兴威胁大会 (LEET'10) 上发表 (2010).
[36] STRINGHINI, G., KRUEGEL, C., AND VIGNA, G. Shady paths: 利用浏览人群检测恶意网页. 在2013 ACM SIGSAC计算机与通信安全会议 (CCS '13) 上发表 (2013).
[37] TOWNSEND, K. R&D: 社会工程的艺术. Infosecurity 7, 4 (2010), 32–35.
[38] VADREVU, P., RAHBARINIA, B., PERDISCI, R., LI, K., AND ANTONAKAKIS, M. 在实时网络流量中测量和检测恶意软件下载. 在ESORICS会议上发表 (2013).
[39] XIE, G., ILIOFOTOU, M., KARAGIANNIS, T., FALOUTSOS, M., AND JIN, Y. Resurf: 从网络流量中重构Web浏览活动. 在2013 IFIP网络会议上发表 (2013年5月), pp. 1–9.
[40] ZHANG, J., SEIFERT, C., STOKES, J. W., AND LEE, W. Arrow: 生成签名以检测驱动下载. 在第20届国际万维网会议 (WWW '11) 上发表 (2011).

---

通过优化，文本更加清晰、连贯和专业，便于读者理解和引用。