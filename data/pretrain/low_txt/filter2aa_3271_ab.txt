### 事件日志

- **2011年5月13日，星期五 10:29:53 PDT**
  - FW Block: 174.37.237.66 Sweep
  - Complaint: 174.37.237.66 PI:EMAIL

- **2011年6月13日，星期一 09:06:44 PDT**
  - FW Block: 174.37.237.66 Sweep
  - Complaint: 174.37.237.66 PI:EMAIL

- **2011年3月10日，星期四 18:02:58 PST**
  - FW Block: 174.37.255.47 AdminProtocol
  - Complaint: 174.37.255.47 PI:EMAIL

- **2011年3月18日，星期五 23:21:20 PDT**
  - FW Block: 174.37.255.47 Sweep
  - Complaint: 174.37.255.47 PI:EMAIL

- **2011年3月20日，星期日 03:41:04 PDT**
  - FW Block: 174.37.255.47 AdminProtocol
  - Complaint: 174.37.255.47 PI:EMAIL

### 改进措施建议

- 客户应拥有自己的入侵检测系统（IDS）和防火墙等安全设备。
- 对攻击多个客户的主机应进行检测并屏蔽。
- 提供商应采取措施帮助客户保护自己，并且识别故意恶意的客户。

### 提供商面临的挑战

- 频繁且快速的客户变更。
- 客户使用多种服务、用户及资源利用方式。
- 客户状态未知。
- 尽可能减少误报率的需求。

### 保持不变的部分

- 客户拥有的内联IPS。
- 客户拥有的防火墙。
- 漏洞评估（VA）。
- 允许客户对其云网络进行基本控制的成熟技术。

### 新增功能

- 网络流量分析器 (Nfdump)
- 企业级IDS (Snort)
- 网络访问控制 (PacketFence)
- 日志整合 (syslog-ng)
- 实时配置错误检测 (Medusa, Metasploit, Nmap等)
- 事件关联 (SEC)

### 为什么不是OSSIM？

- OSSIM虽然使用了类似的工具，但它对所处网络环境做出了假设，可能导致工具/供应商锁定。
- OSSIM的相关引擎不如SEC灵活，尽管它也有其优势。

### 功能详解

- **Nfdump**：用于监测异常或持续的网络利用率，趋势分析及标记可疑峰值。数据来自内部交换机和其他网络设备，提供服务器和服务库存信息。
- **Snort**：广为人知且广泛使用的独立于客户的IDS，部署在网络出口点，监控所有流量。
- **PacketFence**：基于行为的隔离系统，接收其他系统的输入来决定是否隔离设备。
- **Syslog-ng**：广泛使用的日志整合工具，所有基础设施设备（服务器、交换机、IDS等）在此记录日志。
- **实时配置错误检测**：由相关系统调用的基础配置检查工具，用于新服务和服务器。
- **SEC**：跟踪各种来源的事件，不在线，允许做出缓慢但知情的决策，协调所有其他组件。

### 如何运作

- **识别不良主机**：nfdump数据与IDS、防火墙等数据结合，寻找异常。例如，流量高峰伴随ARP冲突消息可能是ARP缓存溢出；流量高峰伴随大量IRC事件可能是参与僵尸网络。
- **相关IDS日志**：提供了更好的信息，但受限于我们能看到的内容。例如，单一事件类型进入服务器后多次重播可能是蠕虫感染；服务器连续使用同一管理协议联系多个服务器可能是协议扫描。

### 限制

- 倾向于谨慎处理。
- 反应性措施，因此可能已经造成损害。

### 结论

- 云提供商似乎没有在其客户网络内部进行有效的监管。
- 应采取可靠措施来检测恶意客户和被攻击的客户。

### 问题

是否有任何疑问？