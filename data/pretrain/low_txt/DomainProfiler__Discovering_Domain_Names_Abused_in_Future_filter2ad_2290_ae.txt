### Proposed System: TVP + rIP + rDomain

Our proposed system, which integrates Temporal Variation Patterns (TVPs) with related IP addresses (rIP) and related domain names (rDomain), can accurately predict future malicious domain names up to 220 days in advance. This prediction is more precise compared to traditional methods such as honeyclients and sandbox systems. The system not only identifies these domains as malicious but also does so with a high degree of accuracy.

When comparing the results with Table VI, it is evident that the common/typical feature set (rIP + rDomain) also detects malicious domain names early. However, the number of true positives (TP) detected by this feature set is significantly lower. We conclude that our proposed system, which incorporates TVPs, outperforms the system using only the common/typical feature set in terms of both accuracy and early detection.

### Effectiveness of Temporal Variation Patterns (TVPs)

We analyzed how TVP features contribute to increasing the true positive rate (TPR) and true negative rate (TNR) simultaneously. Below are some notable case studies based on the TVPs defined in Section II. For this analysis, we used the TVP + rIP + rDomain feature set, with the same settings and dataset as discussed in Section IV-E.

#### Alexa1M-Null
This TVP is designed to boost the TPR. Our analysis revealed that it is particularly effective for malicious domain names generated by Domain Generation Algorithms (DGA) and those abusing new generic top-level domains (gTLDs) like .xyz and .solutions. These domain names are less likely to be listed in the Alexa1M.

#### Alexa1M-Stable
This TVP successfully determines the characteristics of somewhat popular domain names, thereby improving the TNR.

#### Alexa1M-Fall
This TVP aims to detect changing malicious domain names to improve the TPR. We observed two major types of malicious domain names fitting this TVP:
1. **Expired Domain Names**: These are due to the termination of services or company mergers and acquisitions. Some of these expired domain names are re-registered by third-party attackers for domain parking or cyber attacks.
2. **Legitimate to Malicious Changes**: These domain names were initially legitimate but became malicious due to poor management and security.

#### Alexa1M-Rise
This TVP attempts to capture the features of legitimate domain names from start-up websites to improve the TNR. We observed many domain names corresponding to this TVP, such as those of new companies, services, movies, and products.

#### hpHosts-Null
This TVP successfully improved the TNR because the second-level domain (2LD) parts of popular/legitimate domain names are less likely to be listed in hpHosts.

#### hpHosts-Stable
This TVP is designed to determine the characteristics of malicious domain names that abuse easy-to-use services, such as bullet-proof hosting, to improve the TPR. For example, we observed many subdomains using DGA under the same 2LD part, such as "84c7zq.example.com".

#### hpHosts-Fall
This TVP is intended to boost the TNR. We confirmed that some domain names under well-managed networks fit this TVP because they were once abused and then quickly sanitized. In this case, the TVP contributed to the accurate prediction of future legitimate domain names.

#### hpHosts-Rise
This TVP is designed to help detect/predict malicious domain names more accurately to improve the TPR. We observed two types of domain names fitting this TVP:
1. **DGA-Heavy Domains**: These use DGA in both 2LD and third-level domain (3LD) parts, e.g., "14c2c5h8[masked].yr7w2[masked].com". Such 2LDs are continuously used by attackers to create many subdomain names.
2. **Free Subdomain Services**: These offer subdomain name creation under 2LD parts, such as .flu.cc and .co.nr. These services are easily abused by attackers to create distinct domain names.

### Discussion

#### Evading DomainProfiler

**DOMAINPROFILER** is designed to exploit the temporal variation patterns (TVPs) of malicious domain names. There are three possible evasion techniques:

1. **Avoiding Domain Names**: Attackers could avoid using domain names, making it easier to block them using IP addresses. However, changing IP addresses is more costly due to the limited address space.
2. **Avoiding TVP Features**: Attackers could operate their domain names as real legitimate/popular services for a long time to evade TVPs and then use them for malicious purposes. This drives up the cost of implementing attacks.
3. **Using Legitimate Web Services**: Attackers could create dedicated accounts on web services and use them as command and control (C&C) channels. While these accounts could be banned, the content sent/received by attackers could be analyzed to develop new countermeasures.

#### DNS-based Blocking

**DOMAINPROFILER** predicts and outputs malicious domain names. However, these cannot always be blocked at the domain name level because both malicious and legitimate websites can exist under the same domain. To examine this, we extracted and checked URLs under each predicted malicious domain name using a search engine API and commercial ground truths. Our manual analysis of 250 randomly selected domain names from the Honeyclient-Exploit dataset suggests that 72% (=180/250) of domain names can be effectively blocked using DNS-based blocking without excessively blocking legitimate websites. Therefore, the malicious domain names output from our system can contribute to expanding DNS-based block lists if the URL situation under the domain names is considered.

### Related Work

#### Lexical/Linguistic Approach

- **Ma et al.** [14]: Proposed a learning approach using lexical features from phishing URLs. Our system focuses on domain names and can detect various types of attacks.
- **Yadav et al.** [15]: Focused on linguistic features in C&C domain names generated by DGA. Our approach targets a broader range of malicious domain names.
- **Szurdi et al.** [16]: Analyzed typosquatting domain names. Our TVPs can also account for typosquatting.
- **Felegyazhi et al.** [17]: Used WHOIS information to detect malicious domain names. Our approach achieves a high TPR without using WHOIS data.

#### User-centric Approach

- **Sato et al.** [18]: Used co-occurrence characteristics of DNS queries to extend domain name blacklists. Our approach works without malware-infected hosts.
- **Bilge et al.** [19] and **Perdisci et al.** [20]: Proposed systems (Exposure and FluxBuster) that detect malicious domain names using large-scale passive DNS data. Our TVPs are more cost-effective.
- **Antonakakis et al.** [21] and **Thomas et al.** [23]: Focused on DNS queries to non-existent domain names. Our system does not require such DNS logs and targets a wider range of malicious activities.

#### Historic Relationship Approach

- **Antonakakis et al.** [8]: Proposed Notos to detect malicious domain names with similar patterns to past malicious ones. We follow some of their features in rIPs and rDomains, and our TVP features enhance detection and prediction.
- **Manadhata et al.** [24], **Boukhtouta et al.** [25], and **Kürher et al.** [26]: Used graph-based analysis for detecting malicious domain names. Our system relies on TVP or time-series information for precise predictions.
- **Chiba et al.** [27]: Used past malicious IP address features. Our system uses both IP address features and TVPs.
- **Venkataraman et al.** [28]: Focused on time-series shifting of IP address prefixes. Our system has a different target and method.
- **Soska et al.** [29]: Predicted vulnerable websites before they turn malicious. Our system is more scalable and focuses on a wider range of malicious activities.

### Conclusion

We proposed **DOMAINPROFILER**, a system to detect and predict potential malicious domain names in the future. The key idea is to exploit temporal variation patterns (TVPs) of domain names. Our system actively collects DNS logs, identifies TVPs, and predicts whether a given domain name will be used for malicious purposes. Our evaluation with large-scale data revealed that our system can predict malicious domain names 220 days in advance with a true positive rate of 0.985. **DOMAINPROFILER** will be a valuable tool in tracking the ever-changing landscape of cyber security threats.

### References

[1] Verisign. Domain name industry brief. [Online]. Available: http://www.verisign.com/en_US/innovation/dnib/index.xhtml

[2] Alexa top sites. [Online]. Available: http://www.alexa.com/topsites

[3] Malwarebytes. hpHosts. [Online]. Available: http://www.hosts-file.net/

[4] F. Weimer, “Passive DNS replication,” in Proc. of the 17th Annu. FIRST Conf., Apr. 2005.

[5] Y. Chen, M. Antonakakis, R. Perdisci, Y. Nadji, D. Dagon, and W. Lee, “DNS noise: Measuring the pervasiveness of disposable domains in modern DNS traffic,” in Proc. of the 44th Annu. IEEE/IFIP Int. Conf. on Dependable Systems and Networks (DSN’14), 2014, pp. 598–609.

[6] VirusTotal. [Online]. Available: https://www.virustotal.com/

[7] Mozilla foundation. Public suffix list. [Online]. Available: https://publicsuffix.org/list/

[8] M. Antonakakis, R. Perdisci, D. Dagon, W. Lee, and N. Feamster, “Building a dynamic reputation system for DNS,” in Proc. of the 19th USENIX Security Symp., 2010.

[9] CAIDA. Routeviews prefix to AS mappings dataset for IPv4 and IPv6. [Online]. Available: http://www.caida.org/data/routing/routeviews-pfx2as.xml

[10] MaxMind. GeoIP2 databases. [Online]. Available: https://www.maxmind.com/en/geoip2-databases

[11] P. Maigron. Regional internet registries statistics. [Online]. Available: http://www-public.tem-tsp.eu/~maigron/RIRStats/index.html

[12] L. Breiman, “Random forests,” Machine Learning, vol. 45, no. 1, pp. 5–32, Oct. 2001.

[13] P. Mockapetris, “Domain names - implementation and specification,” RFC 1035, Nov. 1987. [Online]. Available: http://www.ietf.org/rfc/rfc1035.txt

[14] J. Ma, L. K. Saul, S. Savage, and G. M. Voelker, “Beyond blacklists: Learning to detect malicious web sites from suspicious URLs,” in Proc. of the 15th ACM SIGKDD Int. Conf. on Knowledge Discovery and Data Mining (KDD’09), 2009, pp. 1245–1254.

[15] S. Yadav, A. K. K. Reddy, A. L. N. Reddy, and S. Ranjan, “Detecting algorithmically generated domain-flux attacks with DNS traffic analysis,” IEEE/ACM Trans. Netw., vol. 20, no. 5, pp. 1663–1677, Oct. 2012.

[16] J. Szurdi, B. Kocso, G. Cseh, J. Spring, M. Felegyhazi, and C. Kanich, “The long ‘taile’ of typosquatting domain names,” in Proc. of the 23rd USENIX Security Symp., 2014, pp. 191–206.

[17] M. Felegyhazi, C. Kreibich, and V. Paxson, “On the potential of proactive domain blacklisting,” in Proc. of the 3rd USENIX Conf. on Large-scale Exploits and Emergent Threats (LEET’10), 2010.

[18] K. Sato, K. Ishibashi, T. Toyono, and N. Miyake, “Extending black domain name list by using co-occurrence relation between DNS queries,” in Proc. of the 3rd USENIX Conf. on Large-scale Exploits and Emergent Threats (LEET’10), 2010.

[19] L. Bilge, S. Sen, D. Balzarotti, E. Kirda, and C. Kruegel, “Exposure: A passive DNS analysis service to detect and report malicious domains,” ACM Trans. Inf. Syst. Secur., vol. 16, no. 4, pp. 14:1–14:28, Apr. 2014.

[20] R. Perdisci, I. Corona, and G. Giacinto, “Early detection of malicious flux networks via large-scale passive DNS traffic analysis,” IEEE Trans. Depend. Sec. Comput., vol. 9, no. 5, pp. 714–726, Sep. 2012.

[21] M. Antonakakis, R. Perdisci, W. Lee, N. Vasiloglou, II, and D. Dagon, “Detecting malware domains at the upper DNS hierarchy,” in Proc. of the 20th USENIX Security Symp., 2011.

[22] M. Antonakakis, R. Perdisci, Y. Nadji, N. Vasiloglou, S. Abu-Nimeh, W. Lee, and D. Dagon, “From throw-away traffic to bots: Detecting the rise of DGA-based malware,” in Proc. of the 21st USENIX Security Symp., 2012.

[23] M. Thomas and A. Mohaisen, “Kindred domains: Detecting and clustering botnet domains using DNS traffic,” in Proc. of the 23rd Int. Conf. on World Wide Web (WWW’14), 2014, pp. 707–712.

[24] P. Manadhata, S. Yadav, P. Rao, and W. Horne, “Detecting malicious domains via graph inference,” in Computer Security - ESORICS 2014, Lecture Notes in Computer Science. Springer International Publishing, 2014, vol. 8712, pp. 1–18.

[25] A. Boukhtouta, D. Mouheb, M. Debbabi, O. Alfandi, F. Iqbal, and M. E. Barachi, “Graph-theoretic characterization of cyber-threat infrastructures,” Digital Investigation, vol. 14, Supplement 1, pp. S3 – S15, 2015.

[26] M. Kührer, C. Rossow, and T. Holz, “Paint it black: Evaluating the effectiveness of malware blacklists,” in Research in Attacks, Intrusions and Defenses, Lecture Notes in Computer Science. Springer International Publishing, 2014, vol. 8688, pp. 1–21.

[27] D. Chiba, K. Tobe, T. Mori, and S. Goto, “Detecting malicious websites by learning IP address features,” in Proc. of the 12th IEEE/IPSJ Int. Symp. on Applications and the Internet (SAINT’12), 2012, pp. 29–39.

[28] S. Venkataraman, D. Brumley, S. Sen, and O. Spatscheck, “Automatically inferring the evolution of malicious activity on the Internet,” in Proc. of the 20th Annu. Network and Distributed System Security Symp. (NDSS’13), Feb. 2013.

[29] K. Soska and N. Christin, “Automatically detecting vulnerable websites before they turn malicious,” in Proc. of the 23rd USENIX Security Symp., 2014, pp. 625–640.