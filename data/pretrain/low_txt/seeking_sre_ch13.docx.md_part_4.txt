在某些情况下，如构建实时视频和通用视频基础设施时，我们意识到这将是一个典型场景，并从一开始就积极参与其中。遗憾的是，我们必须从其他团队中抽调关键成员来组建新团队，而这一权衡需要大量的沟通协调。

当我们进入服务扩展阶段时，确定团队应优先处理哪些工作有时颇具挑战性。服务可能会遇到可靠性、容量、部署或监控等问题。我们的生产工程师 Andrew Ryan 经常为我们提供组织设计方面的帮助。他基于马斯洛需求层次理论提出了一个“服务金字塔”。我在 SRECon 演讲中介绍了这种需求层次结构。后来发现，Mickey Dickerson 在 O'Reilly 会议上也提出了一种类似的服务可靠性需求层次结构。很高兴看到其他团队也分享了类似的工作方法概念。

我们使用该服务层次结构来指导生产工程师首次与团队合作时的工作重点。金字塔的底层侧重于确保服务与标准 Facebook 工具良好集成，以处理服务器生命周期（包括配置、监控、更换、迁移和停用）和服务部署（如新部署、集成测试、金丝雀部署等）。一旦满足了这些基本需求，便可以转向更高层级的问题，例如性能优化、效率提升、灾难恢复、异常检测和故障建模。

只有当基础需求得到充分满足后，才能有效开展金字塔顶端的“高阶工作”。这类问题可能不会在较小规模下出现，但在我们这样的大规模环境中则会变得明显。每个 PE 和 SWE 都有责任调查这些问题，但如果服务的基本需求未被满足，他们可能会发现自己不得不手动修复本应自动解决的问题，而非专注于真正的可扩展性问题。

**大卫：** 你提到的发展阶段具体指什么？

**佩德罗：** 我观察到团队和服务通常会经历以下三个阶段：

- **引导阶段**：执行所有必要操作以启动并运行服务。这可能涉及大量故障排除和人工干预。初期可能仅允许少量流量，以便逐步建立运维能力，识别失败模式及其对其他系统的影响。
- **扩展阶段**：当服务离开引导阶段后，即进入扩展阶段。此时，可能需要将服务部署至多个区域，支持数百万甚至数十亿用户。团队需更加成熟地管理服务及其功能集，理解与其他系统的依赖关系，并准备应对潜在架构变更。
- **卓越阶段**：此阶段旨在完成最后 10% 至 20% 的优化工作，使服务更高效、更出色。我称之为“追求卓越”，因为要求人们进行优化往往不受欢迎，但每个人都希望创造令人惊叹的东西。

不同阶段所需的人员可能有所不同。有些人在软件和生产工程团队中特别喜欢引导工作；另一些人则更偏爱扩展阶段的任务；还有一些人致力于打造高性能且坚不可摧的产品。虽然有些人能够随着服务成长而发展，但大多数人都会在某个特定阶段找到最适合自己的位置。

**大卫：** 鉴于这些发展阶段及个人偏好，如何组建团队？

**佩德罗：** 我们倾向于避免让每个人成为全能型人才的做法。尽管这种方法适用于小团队，但在大规模环境下效果不佳。因此，我们更注重将个人技能与技术需求相匹配。例如，在缓存团队中，了解网络协议和调试至关重要，但最终目标是全面掌握整个系统运作原理。

启动新团队时，我们会考虑以下四个因素：
- 未来 18 到 24 个月内是否有足够的工作供至少三人参与？
- 该服务是否符合我们的优先级模型？它必须是实用且能投入实际应用的项目，而不是永远停留在原型阶段的概念。
- 是否有合适的经理能够与生产工程师合作，共同建设更大规模的团队？
- 当地是否存在负责开发该服务的 SWE 团队？

这四项考量需综合评估，以筛选出真正值得投入资源的新项目。此外，为了引入新的生产工程岗位，还需确保该职位有能力支持至少三个为期 18 至 24 个月的团队在当地与 SWE 合作。

**大卫：** 对于那些虽小但必须完成的任务呢？是否有全能型团队来处理？

**佩德罗：** 并没有专门的全能型团队负责此类任务。一般而言，软件工程团队需自行管理其技术和运维债务。如果某项服务确实需要优先处理并成立专门团队，则会采取相应措施。对于某些短期改进工作，具备相关技能的 PE 可能会被暂时借调去解决问题，然后再返回原团队。我们认为这是有价值的实践，因为它有助于提高 SWE 团队的运维效率和知识水平。

在基础设施方面，我们致力于简化诸如引导之类的基础操作。通过构建一系列服务为工程师提供“更多免费便利”，如容器化部署、常规健康监控以及集中式警报系统等，使得 SWE 能够专注于更高层次的软件问题，从而加快原型设计速度并迅速验证想法。

**大卫：** 关于 PE 如何加入和退出团队，能否详细说明一下？

**佩德罗：** 流动性是我们文化的核心组成部分。我们倾向于招聘多面手型人才，除了核心编程技能外，还期望他们具备网络协议调试、低级别系统知识等方面的能力。随着时间推移，PE 将逐渐成长为更全面的工程师，并获得跨领域工作的灵活性。他们还将学习使用 Facebook 内部工具和服务，这使他们在公司内部更容易转移至不同团队。每隔 18 到 24 个月，我们会询问 PE 是否考虑转岗。虽然许多人会选择继续留在当前岗位上完善所构建的服务，但我们鼓励员工保持开放心态，探索新的机会。