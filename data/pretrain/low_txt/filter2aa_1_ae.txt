### 《漏洞赏金训练营》
#### 发现和报告Web漏洞的指南
##### 作者：Vickie Li（薇琪·李）

**版权信息**
- **书名**: Bug Bounty Bootcamp
- **版权所有 © 2021 Vickie Li**
- **ISBN-13 (印刷版)**: 978-1-7185-0154-6
- **ISBN-13 (电子版)**: 978-1-7185-0155-3

**出版与制作团队**
- **出版者**: William Pollock
- **制作经理**: Rachel Monaghan
- **制作编辑**: Miles Bond 和 Dapinder Dosanjh
- **开发编辑**: Frances Saux
- **封面设计**: Rick Reese
- **内部设计**: Octopod Studios
- **技术审核者**: Aaron Guzman
- **校对员**: Sharon Wilkey
- **排版人员**: Jeff Lytle, Happenstance Type-O-Rama
- **校对员**: James Fraleigh

**联系方式**
- **分销商或翻译信息**: 请直接联系 No Starch Press, Inc.
- **地址**: 245 8th Street, San Francisco, CA 94103
- **电话**: 1-415-863-9900
- **网站**: [www.nostarch.com](http://www.nostarch.com)

**版权说明**
- 未经版权所有者和出版者事先书面许可，任何形式或方式的复制或传播本作品均被禁止，包括但不限于电子或机械形式、复印、录制或任何信息存储或检索系统。

**图书分类**
- **LCCN (印刷版)**: 2021023153
- **LCCN (电子版)**: 2021023154
- **分类号**: LCC TK5105.8855 .L523 2021 (print) | LCC TK5105.8855 (ebook) | DDC 025.042--dc23

**LC 记录**
- [https://lccn.loc.gov/2021023153](https://lccn.loc.gov/2021023153)
- [https://lccn.loc.gov/2021023154](https://lccn.loc.gov/2021023154)

**商标声明**
- No Starch Press 和 No Starch Press 标识是 No Starch Press, Inc. 的注册商标。此处提及的其他产品和公司名称可能为其各自所有者的商标。我们没有在每个商标名称出现时使用商标符号，而是仅以编辑方式使用这些名称，以造福商标所有者，无意侵犯商标权。

**免责声明**
- 本书中的信息按“原样”分发，没有任何保证。虽然我们在编写过程中采取了谨慎措施，但无论是作者还是 No Starch Press, Inc.，对于任何因所包含的信息直接或间接造成的任何损失或损害，不承担任何责任。

### 关于作者
**Vickie Li** 是一名开发人员和安全研究员，擅长在Web应用程序中发现和利用漏洞。她向Facebook、Yelp和Starbucks等公司报告了漏洞，并为许多在线培训计划和技术博客做出了贡献。她的网站是 [https://vickieli.dev/](https://vickieli.dev/)，在那里她博客聚焦于安全新闻、技术以及她最新的漏洞赏金发现。

### 技术审阅者
**Aaron Guzman** 是IoT渗透测试食谱的合著者，也是思科Meraki的产品安全负责人。他每天都在将安全性融入IoT产品中，并设计能够保护用户免受妥协的方案。他是云安全联盟（Cloud Security Alliance）IoT工作组的联席主席，也是几本发表的安全书籍的技术审阅人员，他还领导许多开源倡议，提高人们对OWASP IoT和嵌入式应用安全项目下的IoT黑客和积极防御策略的认识。他有丰富的公开演讲经验，在全球范围内提供会议演讲、培训和工作坊。请在Twitter上关注阿龙@scriptingxss。

### 序言
二十年甚至十年前，像我这样的黑客因为试图做好事而被捕。如今，我们被世界上一些最有权力的组织雇用。如果你仍在考虑是否已经错过了漏洞赏金的列车，那么你要知道的是，你正在一个行业历史上最激动人心的时期加入进来。这个社区正在以前所未有的速度增长，随着政府开始要求公司建立漏洞披露计划，财富500强公司正在纷纷制定这样的政策，而基于黑客的安全应用场景也在不断扩大。人眼的价值将永远在防御不断演变的威胁中起着至关重要的作用，世界正在认识到我们是提供这种服务的人。

漏洞赏金的美妙之处在于，与你通常的九点到五点的工作或咨询差异较大，它让你在任何你想要的时间、任何你想参加的资产上参与其中！你只需要一个良好的互联网连接、一杯美味的咖啡（或你选择的饮料）、一些好奇心和对挑战的激情。不仅给你自由的工作时间表，而且威胁的演变速度比创新的速度更快，为学习、提高技能和成为新领域专家提供了丰富的机会。

如果你对获取真实的黑客经验感兴趣，那么漏洞赏金市场提供了一个无数的目标，这些目标是由像 Facebook、Google 或 Apple 这样的大公司所拥有的！我并不是说在这些公司中找到漏洞是一件容易的事情，然而，漏洞赏金计划提供了一个寻找漏洞的平台，漏洞赏金社区会推动你学习更多的新漏洞类型，增强你的技能，即使遇到困难也要继续尝试。与大多数实验室和 Capture the Flags (CTFs) 不同，漏洞赏金计划没有解决方案或保证可利用的漏洞。相反，你总是会问自己是否某个功能存在漏洞，或者它是否可以迫使应用程序或其功能执行不应该执行的操作。这种不确定性可能令人望而却步，但是它使发现漏洞的乐趣倍感甜蜜。

在这本书中，维基探讨了各种不同的漏洞类型，以提高您对网络应用程序攻击的理解。她涵盖了会使您成为一个成功的漏洞赏金猎人所需的技能，包括逐步分析如何选择适合您的程序、进行适当的侦查和撰写强有力的报告。她解释了像跨站脚本、SQL注入、模板注入等攻击，以及您需要的几乎任何其他攻击来让您成功。随后，她将带领您超越Web应用程序的基础知识，介绍代码审查、API攻击、自动化工作流程和模糊测试等主题。

对于任何愿意付出努力的人来说，漏洞赏金训练营为您提供了在漏洞赏金中取得成功所需的基础。
- 本·萨德吉普尔
- 黑客、内容创作者、HackerOne黑客教育主管

### 引言
我仍然记得第一次发现高影响漏洞的时候。在我测试的应用程序中，我已经找到了几个低影响的漏洞，包括CSRF、IDOR和一些信息泄漏。最终，我成功地将它们链接在一起，完全接管了网站上的任何帐户：我可以像任何人一样登录、阅读任何人的数据并随心所欲地更改它。一瞬间，我觉得自己拥有了超能力。

我已向公司报告此问题，公司迅速修复了漏洞。黑客可能是我在现实世界中遇到的最接近超级英雄的人。他们凭借自己的技能克服限制，使软件程序做到比设计更多的事情，这就是我喜欢黑客攻击网站应用程序的原因：这一切都是关于创造性思维，挑战自我，做出超越可能的事情。

与超级英雄一样，道德黑客有助于保护社会的安全。仅在美国每年就发生数千起数据泄漏事件。通过了解漏洞和其发生原因，您可以将自己的知识用于预防恶意攻击、保护应用程序和用户，使互联网成为更安全的地方。

不久之前，黑客和对Web应用程序进行实验都是非法的。但现在，归功于漏洞赏金计划，您可以合法地进行黑客攻击；公司设立漏洞赏金计划来奖励安全研究人员在其应用程序中发现漏洞。漏洞赏金训练营教您如何黑入Web应用程序，并通过参加这些计划合法地进行黑客攻击。您将学习如何使用漏洞赏金计划，对目标进行侦察，并识别和利用漏洞。

### 本书适用对象
这本书将帮助任何人从零开始学习网络黑客和漏洞赏金猎人。你可能是一名想要进入网络安全领域的学生，一名想要了解一个网站安全性的网站开发者，或者一个有经验的黑客想要了解如何攻击Web应用程序。如果你对网络黑客和网络安全感到好奇，这本书适合你。

阅读本书无需有技术背景。不过，如果您了解基本的编程，将对掌握本书材料有所帮助。尽管本书是针对初学者编写的，但高级黑客也可能会发现它是一本有用的参考书。特别是在讨论高级利用技术和我在学习过程中学到的有用技巧和窍门方面。

### 本书内容
**漏洞赏金训练营** 覆盖了你开始黑客攻击Web应用程序和参加漏洞赏金计划所需的一切。本书分为四个部分：行业、入门、Web漏洞和专家技巧。

#### 第一部分：行业
- **第一章：选择漏洞赏金计划** 解释了不同类型的漏洞赏金计划及其如何选择适合您的兴趣和经验水平的计划。
- **第二章：维持成功** 教您在漏洞赏金行业中取得成功所需的非技术技能，如撰写好的报告、建立专业关系以及处理冲突和挫败感。

#### 第二部分：入门指南
- **第三章：互联网的工作原理** 解释了互联网技术的基础知识。还介绍了您将遇到的互联网安全机制，例如会话管理、基于令牌的身份验证和同源策略。
- **第四章：环境设置和流量拦截** 向您展示如何设置您的黑客环境，配置Burp Suite，并有效地利用Burp Suite的各个模块拦截流量并寻找漏洞。
- **第五章：Web黑客侦察** 详细介绍了您可以采用的侦察策略，以收集有关目标的信息。还包括对bash脚本的介绍，并向您展示如何从头开始创建自动化侦察工具。

#### 第三部分：网站漏洞
- **第六章至第十八章** 讨论现实应用中可能会遇到的常见漏洞，包括跨站脚本(XSS)、开放式重定向、点击劫持、跨站请求伪造(CSRF)、不安全的直接对象引用(IDOR)、SQL注入、竞态条件、服务器端请求伪造(SSRF)、不安全的反序列化、XML外部实体漏洞(XXE)、模板注入、应用逻辑错误和破损的访问控制，以及远程代码执行(RCE)。
- **第十九章：同源策略漏洞** 深入了解了现代互联网的一个基本防御：同源策略。您将会了解到开发人员在构建应用程序以规避同源策略时所犯的错误以及黑客如何利用这些错误。
- **第二十章：单点登录安全问题** 讨论了应用程序实现单点登录功能的最常见方法，每种方法的潜在弱点以及您如何利用这些弱点。
- **第二十一章：信息披露** 介绍了从Web应用程序中提取敏感信息的几种方法。

#### 第四部分：专家技巧
- **第二十二章：进行代码审查** 教您如何识别源代码中的漏洞。您还将有机会练习审查一些代码。
- **第二十三章：Android应用程序黑客攻略** 教您如何设置移动黑客环境并查找Android应用程序中的漏洞。
- **第二十四章：API黑客** 讨论应用程序编程接口（APIs），是许多现代应用程序的重要组成部分。 我讨论了API的类型以及如何寻找在它们中表现出的漏洞。
- **第二十五章：使用模糊测试自动发现漏洞** 是本书的收尾之笔，会向您展示如何使用一种称为模糊测试的方法自动寻找漏洞。您将使用一个开源模糊测试工具来练习模糊测试一个Web应用程序。

祝您愉快的黑客攻击！

### 第一章：选择漏洞赏金计划
漏洞赏金计划：它们都一样吗？找到适合的计划是成为成功的漏洞赏金猎人的第一步。在过去的几年里出现了许多计划，很难确定哪些计划会提供最好的货币奖励、经验和学习机会。

一个漏洞赏金计划是一项倡议，其中公司邀请黑客攻击其产品和服务提供。但你应该如何选择一个计划？如何优先考虑不同的指标，例如涉及的资产类型，计划是否托管在平台上，计划是公开还是私人的，计划的范围，支付额度和响应时间？

在本章中，我们将探讨不同类型的漏洞赏金计划，分析它们的优点和缺点，并确定你应该选择哪一种。