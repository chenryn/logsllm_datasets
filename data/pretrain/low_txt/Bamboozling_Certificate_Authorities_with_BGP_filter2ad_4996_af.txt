### References

[19] COWIE, J. "China’s 18-minute mystery — Dyn blog." *Dyn Blog*, Nov 2010. https://dyn.com/blog/chinas-18-minute-mystery/

[20] DURUMERIC, Z., KASTEN, J., BAILEY, M., and HALDERMAN, J. A. "Analysis of the HTTPS certificate ecosystem." In *Internet Measurement Conference* (New York, NY, USA, 2013), IMC '13, ACM, pp. 291–304.

[21] GAO, L., and REXFORD, J. "Stable Internet routing without global coordination." *IEEE/ACM Transactions on Networking (TON)* 9, 6 (2001), 681–692.

[40] SCHLINKER, B., ZARIFIS, K., CUNHA, I., FEAMSTER, N., and KATZ-BASSETT, E. "Peering: An AS for us." In *ACM Workshop on Hot Topics in Networks* (2014), ACM, p. 18.

[22] GAVRICHENKOV, A. "Breaking HTTPS with BGP hijacking." *Black Hat USA Briefings* (2015).

[23] GILAD, Y., COHEN, A., HERZBERG, A., SCHAPIRA, M., and SHULMAN, H. "Are we there yet? On RPKI’s deployment and security."

[24] GREENBERG, A. "How an unprecedented heist hijacked a bank’s entire online operation." *Wired*, Jun 2017. https://www.wired.com/2017/04/hackers-hijacked-banks-entire-online-operation/

[25] HOFFMAN, P., and SCHLYTER, J. "The DNS-based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA." RFC 6698, RFC Editor, August 2012. http://www.rfc-editor.org/rfc/rfc6698.txt

[26] HU, X., and MAO, Z. M. "Accurate real-time identification of IP prefix hijacking." In *IEEE Symposium on Security and Privacy (SP)* (May 2007), pp. 3–17.

[27] HUSTON, G. "NoPeer Community for Border Gateway Protocol (BGP) Route Scope Control." RFC 3765, RFC Editor, April 2004.

[28] KARLIN, J., FORREST, S., and REXFORD, J. "Autonomous security for autonomous systems." *Computer Networks* 52, 15 (2008), 2908–2923.

[41] SERMPEZIS, P., KOTRONIS, V., DAINOTTI, A., and DIMITROPOULOS, X. "A survey among network operators on BGP prefix hijacking." *SIGCOMM Comput. Commun. Rev.* 48, 1 (Apr. 2018), 64–69.

[42] SHI, X., XIANG, Y., WANG, Z., YIN, X., and WU, J. "Detecting prefix hijackings in the Internet with Argus." In *Internet Measurement Conference* (New York, NY, USA, 2012), IMC '12, ACM, pp. 15–28.

[43] SUN, Y., EDMUNDSON, A., FEAMSTER, N., CHIANG, M., and MITTAL, P. "Counter-Raptor: Safeguarding Tor against active routing attacks." In *IEEE Symposium on Security and Privacy (SP)* (May 2017), pp. 977–992.

[44] SUN, Y., EDMUNDSON, A., VANBEVER, L., LI, O., REXFORD, J., CHIANG, M., and MITTAL, P. "Raptor: Routing attacks on privacy in Tor." In *USENIX Security Symposium* (2015), pp. 271–286.

[45] TODOROVIC, B. "BGP spoofing in the episode: Stealing your (cc)TLD." *NANOG-45*, Santo Domingo, January 2009.

[46] TRAMMELL, B. "RAINS (Another Internet Naming Service) Protocol Specification." Internet-Draft draft-trammell-rains-protocol-03, Internet Engineering Task Force, Sept. 2017. Work in Progress.

[29] KRUEGEL, C., MUTZ, D., ROBERTSON, W., and VALEUR, F. "Topology-based detection of anomalous BGP messages." In *Symposium on Recent Advances in Intrusion Detection (RAID)* (2003), pp. 17–35.

[47] WENDLANDT, D., ANDERSEN, D. G., and PERRIG, A. "Perspectives: Improving SSH-style host authentication with multipath probing." In *USENIX Annual Technical Conference* (2008), vol. 8, pp. 321–334.

[30] LAD, M., MASSEY, D., PEI, D., WU, Y., ZHANG, B., and ZHANG, L. "PHAS: A prefix hijack alert system." In *USENIX Security Symposium* (2006), vol. 1, p. 3.

[31] LAD, M., OLIVEIRA, R., ZHANG, B., and ZHANG, L. "Understanding resiliency of Internet topology against prefix hijack attacks." In *IEEE/IFIP Conference on Dependable Systems and Networks* (2007), IEEE, pp. 368–377.

[32] LANGLEY, A., KASPER, E., and LAURIE, B. "Certificate Transparency." RFC 6962, RFC Editor, June 2013.

[33] LEPINSKI, M., and SRIRAM, K. "BGPsec Protocol Specification." RFC 8205, RFC Editor, September 2017.

[34] LONE, Q., LUCKIE, M., KORCZYŃSKI, M., and VAN EETEN, M. "Using loops observed in traceroute to infer the ability to spoof." In *International Conference on Passive and Active Network Measurement* (2017), Springer, pp. 229–241.

[35] LYCHEV, R., GOLDBERG, S., and SCHAPIRA, M. "BGP security in partial deployment: Is the juice worth the squeeze?" In *ACM SIGCOMM* (New York, NY, USA, 2013), pp. 171–182.

[36] MADORY, D. "Use protection if peering promiscuously." *Dyn Blog*, Nov 2014. https://dyn.com/blog/use-protection-if-peering-promiscuously/

[37] MCCARNEY, D. "Validating challenges from multiple network vantage points." *Let's Encrypt Community Forum*, Aug 2017. https://community.letsencrypt.org/t/validating-challenges-from-multiple-network-vantage-points/40955

[38] ORSINI, C., KING, A., GIORDANO, D., GIOTSAS, V., and DAINOTTI, A. "BGPStream: A software framework for live and historical BGP data analysis." In *ACM on Internet Measurement Conference* (2016), ACM, pp. 429–444.

[39] PILOSOV, A., and KAPELA, T. "Stealing the Internet: An Internet-scale man-in-the-middle attack." *NANOG-44*, Los Angeles, October 2008, pp. 12–15.

[48] ZHANG, X., HSIAO, H. C., HASKER, G., CHAN, H., PERRIG, A., and ANDERSEN, D. G. "SCION: Scalability, control, and isolation on next-generation networks." In *IEEE Symposium on Security and Privacy (SP)* (May 2011), pp. 212–227.

[49] ZHAO, X., PEI, D., WANG, L., MASSEY, D., MANKIN, A., WU, S. F., and ZHANG, L. "An analysis of BGP multiple origin AS (MOAS) conflicts." In *ACM SIGCOMM Workshop on Internet Measurement* (New York, NY, USA, 2001), IMW '01, ACM, pp. 31–35.

### Appendix: Additional Attacks

#### Intentional Route Leak

An intentional route leak is a stealthy attack where the adversary prepends the AS path to the victim and announces an equally specific prefix. This attack is subtle because the adversary merely propagates a legitimate announcement it has heard from one of its neighbors. Such route leaks are relatively common due to misconfigurations [36, 7]. However, while seemingly innocuous, a route leak can redirect vital traffic through an adversary, potentially allowing them to gain a bogus certificate.

Intentional route leaks are not always viable, even when several CAs can be targeted. The adversary's route announcement must include the entire route to the victim and be for the same prefix announced by the victim. Many ASes will prefer the victim's original announcement due to the longer AS path in the adversary's announcement. However, these attacks can be effective in capturing traffic in a localized portion of the Internet topology, especially if the adversary is topologically close to a CA or has favorable business relations.

The viability of this attack increases significantly if the adversary has complete administrative control of an AS. For example, the adversary could request to become a peer with the victim's ISP, thereby favorably changing the Internet topology. Consider ViaWest (Let's Encrypt's ISP). Peers of ViaWest are in a prime position to launch an intentional route leak. ViaWest would likely prefer a route from a peer over a provider route, even if the AS path was longer, allowing these peers to launch an intentional route leak. This route leak would not be globally visible and would only influence ViaWest and its clients.

Currently, 24 ASes are seen peering with ViaWest, but this may be an underestimate. ViaWest has a Point of Presence (POP) at the Seattle Internet Exchange (SIX) and is colocated with 283 other ASes. ViaWest also has an open peering policy, making all 283 ASes at the SIX good candidates for launching an intentional route leak. This trend is common with several top CAs that operate out of large data centers, which often have open peering policies and POPs at many Internet exchanges to reduce latency and transit costs. However, this makes data centers prime targets for such topology manipulation.

We were unable to launch an intentional route leak due to guidelines imposed by the peering framework on the number of ASes that can be prepended to an announcement. Without administrative control of the peering framework, we could not establish additional peering links that might make such an attack possible.

#### Limited Propagation Attack

Limiting the propagation of a malicious BGP announcement by announcing only to a peer AS, rather than a provider, can help an adversary maintain connectivity and reduce the control plane noticeability. We launched a sub-prefix hijack attack from the mux at the Amsterdam Internet Exchange, but made the announcement only to the peer Hurricane Electric. We then ran our own non-trusted CA in a network that was a customer of Hurricane Electric. Using the NTT looking glass and our mux in the Los Nettos Regional Network, we confirmed that the adversary's announcement had not propagated globally (e.g., to NTT's network) and instead had only propagated to the customers of Hurricane Electric (e.g., the Los Nettos Regional Network). We requested a certificate from our non-trusted CA and obtained one without modifying the victim's server.

We repeated a similar experiment but announced the route to peer AS 8075 (Microsoft) instead of Hurricane Electric. While using Microsoft instead of Hurricane Electric is not a significant difference from a BGP perspective, it makes the attack more stealthy. Hurricane Electric has many client ASes that could easily detect the attack, whereas Microsoft has only 10 customer ASes, all under Microsoft's administrative control. Thus, the announcement to Microsoft has such limited propagation that a vantage point within Microsoft's network is needed to detect the attack.

While we used a non-trusted CA for this experiment, it would still be reasonable for an adversary to launch this attack against a trusted CA given a broader selection of CAs and the ability to construct peering connections with potential target ASes. For example, if Amazon instead of Microsoft was a peer available for us to make an announcement, we would have been able to gain a trusted certificate while only propagating a route to a single organization.

A variant of this attack we did not perform is the use of BGP communities to limit propagation. Well-known communities such as no-peer and no-export can make BGP attacks harder to detect by limiting propagation [27]. In the case of the PKI, these mechanisms are more relevant as the adversary's choice of CA increases the likelihood that the CA will be topologically close to the adversary.

#### Using Multiple Vantage Points for Email Verification

Multiple vantage point verification works well for HTTP and DNS TXT verification, which rely on checking the existence of given data in a domain's infrastructure. However, some CAs use email verification, which is based on proving that a user can read data sent to a domain.

**Challenges in Email Verification:**
A naive implementation of multiple vantage point verification for emails would involve having multiple locations on the Internet send emails and having the users prove they received all the emails. This is impractical as it requires a real human user to read and respond to multiple identical emails.

**Proposed Email Verification:**
To address this, we propose a system where a single email can be sent from multiple locations on the Internet. The steps are as follows:

1. The CA breaks up the secret information (e.g., verification URL) into several pieces, with at least one piece for each vantage point.
2. The CA's mail server sends the first piece of the secret via email to the domain's mail server.
3. Upon receiving TCP ACKs from the domain's mail server, the CA reconfigures its routing policy to route the email traffic through the first vantage point via a secure VPN tunnel and sends the second piece of the secret.
4. The CA repeats the above step using the next vantage point until all pieces of the secret have been sent.

In this way, the domain owner has the impression of receiving only one email from the CA, but in fact, an arbitrarily large number of vantage points were used to send the email.

---

This revised version aims to improve clarity, coherence, and professionalism in the text.