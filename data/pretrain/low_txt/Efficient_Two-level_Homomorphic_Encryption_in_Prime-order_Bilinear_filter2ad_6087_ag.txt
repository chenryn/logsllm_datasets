### References

[1] On discrete logarithms. *IEEE Trans. Information Theory* 31, 4 (1985), 469–472. https://doi.org/10.1109/TIT.1985.1057074

[2] Michael J. Freedman, Kobbi Nissim, and Benny Pinkas. 2004. Efficient Private Matching and Set Intersection. In *Advances in Cryptology - EUROCRYPT 2004, International Conference on the Theory and Applications of Cryptographic Techniques, Interlaken, Switzerland, May 2-6, 2004, Proceedings (Lecture Notes in Computer Science)*, Christian Cachin and Jan Camenisch (Eds.), Vol. 3027. Springer, 1–19. https://doi.org/10.1007/978-3-540-24676-3_1

[3] David Mandell Freeman. 2010. Converting Pairing-Based Cryptosystems from Composite-Order Groups to Prime-Order Groups. See [29], 44–61. https://doi.org/10.1007/978-3-642-13190-5_3

[4] Steven D. Galbraith and Kenneth G. Paterson (Eds.). 2008. *Pairing-Based Cryptography - Pairing 2008, Second International Conference, Egham, UK, September 1-3, 2008. Proceedings*. Lecture Notes in Computer Science, Vol. 5209. Springer. https://doi.org/10.1007/978-3-540-85538-5

[5] Steven D. Galbraith, Kenneth G. Paterson, and Nigel P. Smart. 2008. Pairings for cryptographers. *Discrete Applied Mathematics* 156, 16 (2008), 3113–3121. https://doi.org/10.1016/j.dam.2007.12.010

[6] Steven D. Galbraith and Michael Scott. 2008. Exponentiation in Pairing-Friendly Groups Using Homomorphisms. See [22], 211–224. https://doi.org/10.1007/978-3-540-85538-5_15

[7] Craig Gentry. 2009. Fully homomorphic encryption using ideal lattices. In *Proceedings of the 41st Annual ACM Symposium on Theory of Computing, STOC 2009, Bethesda, MD, USA, May 31 - June 2, 2009*, Michael Mitzenmacher (Ed.). ACM, 169–178. https://doi.org/10.1145/1536414.1536440

[8] Craig Gentry, Shai Halevi, and Vinod Vaikuntanathan. 2010. A Simple BGN-Type Cryptosystem from LWE. See [29], 506–522. https://doi.org/10.1007/978-3-642-13190-5_26

[9] Craig Gentry, Amit Sahai, and Brent Waters. 2013. Homomorphic Encryption from Learning with Errors: Conceptually-Simpler, Asymptotically-Faster, Attribute-Based. In *Advances in Cryptology - CRYPTO 2013 - 33rd Annual Cryptology Conference, Santa Barbara, CA, USA, August 18-22, 2013. Proceedings, Part I (Lecture Notes in Computer Science)*, Ran Canetti and Juan A. Garay (Eds.), Vol. 8042. Springer, 75–92. https://doi.org/10.1007/978-3-642-40041-4_5

[10] Geovandro C. C. F. Pereira, Marcos A. Simplício Jr., Michael Naehrig, and Paulo S. L. M. Barreto. 2011. A family of implementation-friendly BN elliptic curves. *Journal of Systems and Software* 84, 8 (2011), 1319–1326. https://doi.org/10.1016/j.jss.2011.03.083

[11] Henri Gilbert (Ed.). 2010. *Advances in Cryptology - EUROCRYPT 2010, 29th Annual International Conference on the Theory and Applications of Cryptographic Techniques, French Riviera, May 30 - June 3, 2010. Proceedings*. Lecture Notes in Computer Science, Vol. 6110. Springer. https://doi.org/10.1007/978-3-642-13190-5

[12] Jens Groth and Amit Sahai. 2012. Efficient Noninteractive Proof Systems for Bilinear Groups. *SIAM J. Comput.* 41, 5 (2012), 1193–1232. https://doi.org/10.1137/080725386

[13] W3C Community Group. 2017. WebAssembly. (2017). http://webassembly.org/

[14] Gottfried Herold, Julia Hesse, Dennis Hofheinz, Carla Ràfols, and Andy Rupp. 2014. Polynomial Spaces: A New Framework for Composite-to-Prime-Order Transformations. In *Advances in Cryptology - CRYPTO 2014 - 34th Annual Cryptology Conference, Santa Barbara, CA, USA, August 17-21, 2014, Proceedings, Part I (Lecture Notes in Computer Science)*, Juan A. Garay and Rosario Gennaro (Eds.), Vol. 8616. Springer, 261–279. https://doi.org/10.1007/978-3-662-44371-2_15

[15] Florian Hess. 2008. Pairing Lattices. See [22], 18–38. https://doi.org/10.1007/978-3-540-85538-5_2

[16] Florian Hess, Nigel P. Smart, and Frederik Vercauteren. 2006. The Eta Pairing Revisited. *IEEE Trans. Information Theory* 52, 10 (2006), 4595–4602. https://doi.org/10.1109/TIT.2006.881709

[17] Marc Joye and Benoît Libert. 2013. Efficient Cryptosystems from 2^k-th Power Residue Symbols. In *Advances in Cryptology - EUROCRYPT 2013, 32nd Annual International Conference on the Theory and Applications of Cryptographic Techniques, Athens, Greece, May 26-30, 2013. Proceedings (Lecture Notes in Computer Science)*, Thomas Johansson and Phong Q. Nguyen (Eds.), Vol. 7881. Springer, 76–92. https://doi.org/10.1007/978-3-642-38348-9_5

[18] Seny Kamara, Payman Mohassel, and Mariana Raykova. 2011. Outsourcing Multi-Party Computation. *IACR Cryptology ePrint Archive* 2011 (2011), 272. http://eprint.iacr.org/2011/272

[19] Naoki Kanayama, Tadanori Teruya, and Eiji Okamoto. 2011. Scalar Multiplication on Pairing Friendly Elliptic Curves. *IEICE Transactions* 94-A, 6 (2011), 1285–1292. https://doi.org/10.1587/transfun.E94.A.1285

[20] Taechan Kim and Razvan Barbulescu. 2016. Extended Tower Number Field Sieve: A New Complexity for the Medium Prime Case. In *Advances in Cryptology - CRYPTO 2016 - 36th Annual International Cryptology Conference, Santa Barbara, CA, USA, August 14-18, 2016, Proceedings, Part I (Lecture Notes in Computer Science)*, Matthew Robshaw and Jonathan Katz (Eds.), Vol. 9814. Springer, 543–571. https://doi.org/10.1007/978-3-662-53018-4_20

[21] Taechan Kim and Jinhyuck Jeong. 2017. Extended Tower Number Field Sieve with Application to Finite Fields of Arbitrary Composite Extension Degree. In *Public-Key Cryptography - PKC 2017 - 20th IACR International Conference on Practice and Theory in Public-Key Cryptography, Amsterdam, The Netherlands, March 28-31, 2017, Proceedings, Part I (Lecture Notes in Computer Science)*, Serge Fehr (Ed.), Vol. 10174. Springer, 388–408. https://doi.org/10.1007/978-3-662-54365-8_16

[22] Eyal Kushilevitz and Rafail Ostrovsky. 1997. Replication is NOT Needed: SINGLE Database, Computationally-Private Information Retrieval. In *38th Annual Symposium on Foundations of Computer Science, FOCS ’97, Miami Beach, Florida, USA, October 19-22, 1997*. IEEE Computer Society, 364–373. https://doi.org/10.1109/SFCS.1997.646125

[23] Seiichi Matsuda, Naoki Kanayama, Florian Hess, and Eiji Okamoto. 2009. Optimised Versions of the Ate and Twisted Ate Pairings. *IEICE Transactions* 92-A, 7 (2009), 1660–1667. https://doi.org/10.1587/transfun.E92.A.1660

[24] Alfred Menezes, Palash Sarkar, and Shashank Singh. 2016. Challenges with Assessing the Impact of NFS Advances on the Security of Pairing-Based Cryptography. In *Paradigms in Cryptology - Mycrypt 2016. Malicious and Exploratory Cryptology - Second International Conference, Mycrypt 2016, Kuala Lumpur, Malaysia, December 1-2, 2016, Revised Selected Papers (Lecture Notes in Computer Science)*, Raphael C.-W. Phan and Moti Yung (Eds.), Vol. 10311. Springer, 83–108. https://doi.org/10.1007/978-3-319-61273-7_5

[25] Victor S. Miller. 2004. The Weil Pairing, and Its Efficient Calculation. *J. Cryptology* 17, 4 (2004), 235–261. https://doi.org/10.1007/s00145-004-0315-8

[26] Shigeo Mitsunari. 2017. mcl: A generic and fast pairing-based cryptography library. (2017). https://github.com/herumi/mcl

[27] Nadia El Mrabet and Marc Joye (Eds.). 2016. *Guide to Pairing-Based Cryptography*. Chapman and Hall/CRC.

[28] Tatsuaki Okamoto and Shigenori Uchiyama. 1998. A New Public-Key Cryptosystem as Secure as Factoring. In *Advances in Cryptology - EUROCRYPT '98, International Conference on the Theory and Application of Cryptographic Techniques, Espoo, Finland, May 31 - June 4, 1998, Proceeding (Lecture Notes in Computer Science)*, Kaisa Nyberg (Ed.), Vol. 1403. Springer, 308–318. https://doi.org/10.1007/BFb0054135

[29] Rafail Ostrovsky and William E. Skeith III. 2007. Private Searching on Streaming Data. *J. Cryptology* 20, 4 (2007), 397–430. https://doi.org/10.1007/s00145-007-0565-3

[30] Pascal Paillier. 1999. Public-Key Cryptosystems Based on Composite Degree Residuosity Classes. In *Advances in Cryptology - EUROCRYPT '99, International Conference on the Theory and Application of Cryptographic Techniques, Prague, Czech Republic, May 2-6, 1999, Proceeding (Lecture Notes in Computer Science)*, Jacques Stern (Ed.), Vol. 1592. Springer, 223–238. https://doi.org/10.1007/3-540-48910-X_16

[31] John M. Pollard. 1978. Monte Carlo methods for index computation (mod p). *Math. Comp.* 32, 143 (1978), 918–924. https://doi.org/10.1090/S0025-5718-1978-0491431-9

[32] R. Rivest, L. Adleman, and M. Dertouzos. 1978. On data banks and privacy homomorphisms. *Foundations of Secure Computation*. https://people.csail.mit.edu/rivest/RivestAdlemanDertouzos-OnDataBanksAndPrivacyHomomorphisms.pdf

[33] Ronald L. Rivest, Adi Shamir, and Leonard M. Adleman. 1978. A Method for Obtaining Digital Signatures and Public-Key Cryptosystems. *Commun. ACM* 21, 2 (1978), 120–126. https://doi.org/10.1145/359340.359342

[34] Yusuke Sakai, Keita Emura, Goichiro Hanaoka, Yutaka Kawai, and Kazumasa Omote. 2013. Methods for Restricting Message Space in Public-Key Encryption. *IEICE Transactions* 96-A, 6 (2013), 1156–1168.

[35] Palash Sarkar and Shashank Singh. 2016. A General Polynomial Selection Method and New Asymptotic Complexities for the Tower Number Field Sieve Algorithm. In *Advances in Cryptology - ASIACRYPT 2016 - 22nd International Conference on the Theory and Application of Cryptology and Information Security, Hanoi, Vietnam, December 4-8, 2016, Proceedings, Part I (Lecture Notes in Computer Science)*, Jung Hee Cheon and Tsuyoshi Takagi (Eds.), Vol. 10031. 37–62. https://doi.org/10.1007/978-3-662-53887-6_2

[36] Jae Hong Seo. 2012. On the (Im)possibility of Projecting Property in Prime-Order Setting. In *Advances in Cryptology - ASIACRYPT 2012 - 18th International Conference on the Theory and Application of Cryptology and Information Security, Beijing, China, December 2-6, 2012. Proceedings (Lecture Notes in Computer Science)*, Xiaoyun Wang and Kazue Sako (Eds.), Vol. 7658. Springer, 61–79. https://doi.org/10.1007/978-3-642-34961-4_6

[37] Kana Shimizu, Koji Nuida, Hiromi Arai, Shigeo Mitsunari, Nuttapong Attrapadung, Michiaki Hamada, Koji Tsuda, Takatsugu Hirokawa, Jun Sakuma, Goichiro Hanaoka, et al. 2015. Privacy-preserving search for chemical compound databases. *BMC bioinformatics* 16, Suppl 18 (2015), S6.

[38] Kana Shimizu, Koji Nuida, and Gunnar Rätsch. 2016. Efficient privacy-preserving string search and an application in genomics. *Bioinformatics* 32, 11 (2016), 1652–1661. https://doi.org/10.1093/bioinformatics/btw050

[39] Hiroki Sudo, Masanobu Jimbo, Koji Nuida, and Kana Shimizu. 2016. Secure Wavelet Matrix: Alphabet-Friendly Privacy-Preserving String Search. *bioRxiv* (2016).

[40] Tadanori Teruya, Kazutaka Saito, Naoki Kanayama, Yuto Kawahara, Tetsutaro Kobayashi, and Eiji Okamoto. 2013. Constructing Symmetric Pairings over Supersingular Elliptic Curves with Embedding Degree Three. In *Pairing-Based Cryptography - Pairing 2013 - 6th International Conference, Beijing, China, November 22-24, 2013, Revised Selected Papers (Lecture Notes in Computer Science)*, Zhenfu Cao and Fangguo Zhang (Eds.), Vol. 8365. Springer, 97–112. https://doi.org/10.1007/978-3-319-04873-4_6

[41] Eran Tromer, Dag Arne Osvik, and Adi Shamir. 2010. Efficient Cache Attacks on AES, and Countermeasures. *J. Cryptology* 23, 1 (2010), 37–71. https://doi.org/10.1007/s00145-009-9049-y

[42] Yukiyasu Tsunoo, Teruo Saito, Tomoyasu Suzaki, Maki Shigeri, and Hiroshi Miyauchi. 2003. Cryptanalysis of DES Implemented on Computers with Cache. In *Cryptographic Hardware and Embedded Systems - CHES 2003, 5th International Workshop, Cologne, Germany, September 8-10, 2003, Proceedings (Lecture Notes in Computer Science)*, Colin D. Walter, Çetin Kaya Koç, and Christof Paar (Eds.), Vol. 2779. Springer, 62–76. https://doi.org/10.1007/978-3-540-45238-6_6

[43] Yukiyasu Tsunoo, Etsuko Tsujihara, Kazuhiko Minematsu, and Hiroshi Miyauchi. 2002. Cryptanalysis of Block Ciphers Implemented on Computers with Cache. In *International Symposium on Information Theory and Its Applications (ISITA) 2002*.

[44] Frederik Vercauteren. 2010. Optimal pairings. *IEEE Trans. Information Theory* 56, 1 (2010), 455–461. https://doi.org/10.1109/TIT.2009.2034881

[45] Yuval Yarom and Katrina Falkner. 2014. FLUSH+RELOAD: A High Resolution, Low Noise, L3 Cache Side-Channel Attack. In *23rd USENIX Security Symposium (USENIX Security 14)*. USENIX Association, San Diego, CA, 719–732. https://www.usenix.org/conference/usenixsecurity14/technical-sessions/presentation/yarom

[46] Eric Zavattoni, Luis J. Dominguez Perez, Shigeo Mitsunari, Ana H. Sánchez-Ramírez, Tadanori Teruya, and Francisco Rodríguez-Henríquez. 2015. Software Implementation of an Attribute-Based Encryption Scheme. *IEEE Trans. Computers* 64, 5 (2015), 1429–1441. https://doi.org/10.1109/TC.2014.2329681

### Appendix: Performance Benchmarks from mcl Library

In this paper, we used a pairing library called mcl [44]. For self-containment, in this appendix, we show the performances of primitive operations implemented by mcl in Table 6. These include group operations, exponentiations, exponentiations (with a 2^20-entry precomputed look-up table), and pairings. All the timings are measured on the same platform as described in Section 6.2.

**Table 6: Performance of x86 Implementation of Primitive Operations on Barreto–Naehrig Curves BN254, BN382, and BN462 Implemented by the mcl Library**

| Operation | BN254 (μs) | BN382 (μs) | BN462 (μs) |
|-----------|------------|------------|------------|
| G1        | 0.216      | 0.435      | 1.00       |
| G2        | 1.03       | 2.03       | 4.06       |
| GT        | 1.61       | 3.06       | 5.71       |
| E1        | 56.5       | 160        | 415        |
| E2        | 119        | 376        | 862        |
| ET        | 214        | 600        | 1260       |
| Epre1     | 5.65       | 16.4       | 46.8       |
| Epre2     | 18.1       | 60.0       | 144        |
| EpreT     | 39.7       | 119        | 264        |
| P         | 321        | 1060       | 2430       |

- **G1, G2, GT**: Denotes a group operation over G1, G2, GT, respectively.
- **E1, E2, ET**: Denotes an exponentiation over G1, G2, GT, respectively.
- **Epre1, Epre2, EpreT**: Denotes an exponentiation with a 2^20-entry precomputed look-up table over G1, G2, GT, respectively.
- **P**: Denotes a pairing.
- **All timings are given in microseconds (μs).**