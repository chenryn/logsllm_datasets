### Compatibility Attacks

Our research highlights a significant lack of appreciation for the principle of key separation in real-world cryptographic deployments. These findings underscore vulnerabilities in current standards for digital certificates.

### Acknowledgements

We would like to extend our gratitude to Christopher Meyer for his insightful discussions and to the anonymous reviewers for their valuable feedback. We also thank all the mentioned vendors and the W3C Working Group for their cooperation and contributions to our research. Special thanks go to Scott Cantor, Colm O hEigeartaigh, and Yang Yu for their support.

### References

1. **T. Acar, M. Belenkiy, M. Bellare, and D. Cash.** *Cryptographic Agility and Its Relation to Circular Encryption.* In H. Gilbert (Ed.), *Advances in Cryptology – EUROCRYPT 2010*, Vol. 6110 of Lecture Notes in Computer Science, pp. 403–422. Springer, May 2010.
2. **Advanced Encryption Standard (AES).** National Institute of Standards and Technology (NIST), FIPS PUB 197, U.S. Department of Commerce, November 2001.
3. **N. AlFardan and K. G. Paterson.** *Plaintext-Recovery Attacks Against Datagram TLS.* In *Network and Distributed System Security Symposium (NDSS 2012)*, 2012.
4. **Apache Software Foundation.** *Apache Axis2.* <http://axis.apache.org/axis2/java/core>
5. **Apache Software Foundation.** *Apache CXF.* <http://cxf.apache.org>
6. **Apache Software Foundation.** *Apache WSS4J - Web Services Security for Java,* May 2012. <http://ws.apache.org/wss4j/>
7. **R. Bardou, R. Focardi, Y. Kawamoto, G. Steel, and J.-K. Tsay.** *Efficient Padding Oracle Attacks on Cryptographic Hardware.* In R. Canetti and R. Safavi-Naini (Eds.), *Advances in Cryptology – CRYPTO 2012*.
8. **E. Barkan, E. Biham, and N. Keller.** *Instant Ciphertext-Only Cryptanalysis of GSM Encrypted Communication.* In D. Boneh (Ed.), *Advances in Cryptology – CRYPTO 2003*, Vol. 2729 of Lecture Notes in Computer Science, pp. 600–616. Springer, August 2003.
9. **M. Bellare and C. Namprempre.** *Authenticated Encryption: Relations Among Notions and Analysis of the Generic Composition Paradigm.* In T. Okamoto (Ed.), *Advances in Cryptology – ASIACRYPT 2000*, Vol. 1976 of Lecture Notes in Computer Science, pp. 531–545. Springer, December 2000.
10. **M. Bellare and P. Rogaway.** *Optimal Asymmetric Encryption.* In A. D. Santis (Ed.), *Advances in Cryptology – EUROCRYPT’94*, Vol. 950 of Lecture Notes in Computer Science, pp. 92–111. Springer, May 1994.
11. **M. Bellare, P. Rogaway, and D. Wagner.** *The EAX Mode of Operation.* In B. K. Roy and W. Meier (Eds.), *Fast Software Encryption – FSE 2004*, Vol. 3017 of Lecture Notes in Computer Science, pp. 389–407. Springer, February 2004.
12. **S. Bellovin.** *Problem Areas for the IP Security Protocols.* In *Proceedings of the Sixth Usenix Unix Security Symposium*, pp. 1–16, July 1995.
13. **D. Bleichenbacher.** *Chosen Ciphertext Attacks Against Protocols Based on the RSA Encryption Standard PKCS #1.* In H. Krawczyk (Ed.), *Advances in Cryptology – CRYPTO’98*, Vol. 1462 of Lecture Notes in Computer Science, pp. 1–12. Springer, August 1998.
14. **T. Bray, J. Paoli, C. M. Sperberg-McQueen, E. Maler, and F. Yergeau.** *Extensible Markup Language (XML) 1.0 (Fifth Edition).* W3C Recommendation, 2008.
15. **S. Cantor, J. Kemp, R. Philpott, and E. Maler.** *Assertions and Protocol for the OASIS Security Assertion Markup Language (SAML) V2.0.* OASIS Standard, March 2005.
16. **Centers for Disease Control and Prevention.** *Public Health Information Network (PHIN) – Secure Message Transport Guide,* Version 2.0, July 2008.
17. **V. Cerf.** *ASCII Format for Network Interchange.* RFC 20, October 1969.
18. **Committee IT-014.** *Australian Technical Specification – E-Health XML Secured Payload Profiles,* March 2010.
19. **D. Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley, and W. Polk.** *Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile.* RFC 5280 (Proposed Standard), May 2008.
20. **Danske Bank / Sampo Pankki.** *Encryption, Signing and Compression in Financial Web Services,* Version 2.4.1, May 2010.
21. **J. P. Degabriele, A. Lehmann, K. G. Paterson, N. P. Smart, and M. Strefler.** *On the Joint Security of Encryption and Signature in EMV.* In O. Dunkelman (Ed.), *CT-RSA*, Vol. 7178 of Lecture Notes in Computer Science, pp. 116–135. Springer, 2012.
22. **J. P. Degabriele and K. G. Paterson.** *Attacking the IPsec Standards in Encryption-Only Configurations.* In *2007 IEEE Symposium on Security and Privacy*, pp. 335–349. IEEE Computer Society Press, May 2007.
23. **T. Dierks and E. Rescorla.** *The Transport Layer Security (TLS) Protocol Version 1.1.* RFC 4346 (Proposed Standard), April 2006. Obsoleted by RFC 5246, updated by RFCs 4366, 4680, 4681, 5746.
24. **T. Duong and J. Rizzo.** *Cryptography in the Web: The Case of Cryptographic Design Flaws in ASP.NET.* In *2011 IEEE Symposium on Security and Privacy*, pp. 481–489. IEEE Computer Society Press, May 2011.
25. **T. Duong and J. Rizzo.** *Here Come the ⊕ Ninjas.* Unpublished manuscript, 2011.
26. **M. Dworkin.** *Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC.* NIST Special Publication 800-38D, November 2007, National Institute of Standards and Technology. Available at <http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf>.
27. **D. Eastlake, J. Reagle, F. Hirsch, T. Roessler, T. Imamura, B. Dillaway, E. Simon, K. Yiu, and M. Nyström.** *XML Encryption Syntax and Processing 1.1.* W3C Candidate Recommendation, 2012. <http://www.w3.org/TR/2012/WD-xmlenc-core1-20121018>.
28. **D. Eastlake, J. Reagle, T. Imamura, B. Dillaway, and E. Simon.** *XML Encryption Syntax and Processing.* W3C Recommendation, 2002.
29. **D. Eastlake, J. Reagle, D. Solo, F. Hirsch, and T. Roessler.** *XML Signature Syntax and Processing (Second Edition).* W3C Recommendation, 2008.
30. **E. Fujisaki, T. Okamoto, D. Pointcheval, and J. Stern.** *RSA-OAEP is Secure Under the RSA Assumption.* *Journal of Cryptology*, 17(2):81–104, March 2004.
31. **Fuse Framework.** *Encryption and Signing Services: Providing Keys and Keys.* <http://fusesource.com/docs/framework/2.4/security/MsgProtect-SOAP-ProvideKeys.html#MsgProtect-SOAP-ProvideKeys-SpringConfig>, July 2012.
32. **D. Gligoroski, S. Andova, and S. J. Knapskog.** *On the Importance of the Key Separation Principle for Different Modes of Operation.* In L. Chen, Y. Mu, and W. Susilo (Eds.), *ISPEC*, Vol. 4991 of Lecture Notes in Computer Science, pp. 404–418. Springer, 2008.
33. **M. Gudgin, M. Hadley, N. Mendelsohn, J.-J. Moreau, and H. F. Nielsen.** *SOAP Version 1.2 Part 1: Messaging Framework.* W3C Recommendation, 2003.
34. **M. Horsch and M. Stopczynski.** *The German eCard-Strategy, 2011.* Technical Report.
35. **IBM.** *WebSphere DataPower SOA Appliances.* <http://www-01.ibm.com/software/integration/datapower>
36. **Ping Identity.** *PingFederate.* <https://www.pingidentity.com>
37. **T. Jager, S. Schinzel, and J. Somorovsky.** *Bleichenbacher's Attack Strikes Again: Breaking PKCS#1 v1.5 in XML Encryption.* In S. Foresti and M. Yung (Eds.), *Computer Security - ESORICS 2012 - 17th European Symposium on Research in Computer Security, Pisa, Italy, September 10-14, 2012. Proceedings*, LNCS. Springer, 2012.
38. **T. Jager and J. Somorovsky.** *How to Break XML Encryption.* In Y. Chen, G. Danezis, and V. Shmatikov (Eds.), *ACM CCS 11: 18th Conference on Computer and Communications Security*, pp. 413–422. ACM Press, October 2011.
39. **JBoss Community.** *JBoss Projects.* <http://www.jboss.org/projects>
40. **M. Jones, J. Bradley, and N. Sakimura.** *JSON Web Signature (JWS) – draft-ietf-jose-json-web-signature-06, October 2012.* <http://tools.ietf.org/html/draft-ietf-jose-json-web-signature-06>
41. **M. Jones, E. Rescorla, and J. Hildebrand.** *JSON Web Encryption (JWE) – draft-ietf-jose-json-web-encryption-06, October 2012.* <http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-06>
42. **J. Jonsson and B. Kaliski.** *Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1.* RFC 3447 (Informational), February 2003.
43. **B. Kaliski.** *PKCS #1: RSA Encryption Version 1.5.* RFC 2313 (Informational), March 1998. Obsoleted by RFC 2437.
44. **B. Kaliski and J. Staddon.** *PKCS #1: RSA Cryptography Specifications Version 2.0.* RFC 2437 (Informational), October 1998. Obsoleted by RFC 3447.
45. **B. S. Kaliski Jr.** *On Hash Function Firewalls in Signature Schemes.* In B. Preneel (Ed.), *Topics in Cryptology – CT-RSA 2002*, Vol. 2271 of Lecture Notes in Computer Science, pp. 1–16. Springer, February 2002.
46. **Kantara Initiative.** *Kantara Initiative eGovernment Implementation Profile of SAML V2.0,* Version 2.0, June 2010.
47. **J. Kelsey, B. Schneier, and D. Wagner.** *Protocol Interactions and the Chosen Protocol Attack.* In B. Christianson, B. Crispo, T. M. A. Lomas, and M. Roe (Eds.), *Security Protocols Workshop*, Vol. 1361 of Lecture Notes in Computer Science, pp. 91–104. Springer, 1997.
48. **K. Lawrence and C. Kaler.** *WS-SecurityPolicy 1.2.* OASIS Standard, July 2007.
49. **Layer7 Technologies.** *Layer7 XML Firewall.* <http://www.layer7tech.com/products/xml-firewall>
50. **F. McCabe, D. Booth, C. Ferris, D. Orchard, M. Champion, E. Newcomer, and H. Haas.** *Web Services Architecture.* W3C Note, W3C, February 2004. <http://www.w3.org/TR/2004/NOTE-ws-arch-20040211/>
51. **D. A. McGrew and J. Viega.** *The Security and Performance of the Galois/Counter Mode (GCM) of Operation.* In A. Canteaut and K. Viswanathan (Eds.), *Progress in Cryptology - INDOCRYPT 2004: 5th International Conference in Cryptology in India*, Vol. 3348 of Lecture Notes in Computer Science, pp. 343–355. Springer, December 2004.
52. **Nimbus Directory Services.** *Nimbus JSON Web Token,* May 2012. <https://bitbucket.org/nimbusds/nimbus-jwt>
53. **NIST.** *Cipher Block Chaining.* NIST FIPS PUB 81, U.S. Department of Commerce, 1980.
54. **NIST.** *AES Key Wrap Specification, 2001.*
55. **NIST.** *Recommendation for Block Cipher Modes of Operation.* Special Publication 800-38A, 2001.
56. **NIST.** *Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and Confidentiality.* Special Publication 800-38C, 2004.
57. **Oracle.** *Securing SOA and Web Services with Oracle Enterprise Gateway,* April 2011. Technical Report.
58. **K. G. Paterson, J. C. N. Schuldt, M. Stam, and S. Thomson.** *On the Joint Security of Encryption and Signature, Revisited.* In D. H. Lee and X. Wang (Eds.), *Advances in Cryptology – ASIACRYPT 2011*, Vol. 7073 of Lecture Notes in Computer Science, pp. 161–178. Springer, December 2011.
59. **K. G. Paterson and A. K. L. Yau.** *Cryptography in Theory and Practice: The Case of Encryption in IPsec.* In S. Vaudenay (Ed.), *Advances in Cryptology – EUROCRYPT 2006*, Vol. 4004 of Lecture Notes in Computer Science, pp. 12–29. Springer, May/June 2006.
60. **Ping Identity Product Documentation.** *PingFederate 6.6, Selecting a Decryption Key (SAML),* July 2012. <http://documentation.pingidentity.com/display/PF66/Selecting+a+Decryption+Key+(SAML)>
61. **J. Rizzo and T. Duong.** *Practical Padding Oracle Attacks.* In *Proceedings of the 4th USENIX Conference on Offensive Technologies (WOOT'10)*, pp. 1–8, Berkeley, CA, USA, 2010. USENIX Association.
62. **P. Rogaway.** *Problems with Proposed IP Cryptography.* Unpublished manuscript, 1995. <http://www.cs.ucdavis.edu/~rogaway/papers/draft-rogaway-ipsec-comments-00.txt>
63. **P. Rogaway, M. Bellare, J. Black, and T. Krovetz.** *OCB: A Block-Cipher Mode of Operation for Efficient Authenticated Encryption.* In *ACM CCS 01: 8th Conference on Computer and Communications Security*, pp. 196–205. ACM Press, November 2001.
64. **SAP.** *SAP Netweaver.* <http://scn.sap.com/community/netweaver>
65. **J. Schaad, B. Kaliski, and R. Housley.** *Additional Algorithms and Identifiers for RSA Cryptography for Use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile.* RFC 4055 (Proposed Standard), June 2005. Updated by RFC 5756.
66. **Shibboleth Consortium.** *Shibboleth.* <http://shibboleth.net>
67. **J. Somorovsky and J. Schwenk.** *Technical Analysis of Countermeasures against Attacks on XML Encryption – or – Just Another Motivation for Authenticated Encryption.* In *SERVICES Workshop on Security and Privacy Engineering*, June 2012.
68. **S. Vaudenay.** *Security Flaws Induced by CBC Padding - Applications to SSL, IPSEC, WTLS...* In L. R. Knudsen (Ed.), *Advances in Cryptology – EUROCRYPT 2002*, Vol. 2332 of Lecture Notes in Computer Science, pp. 534–546. Springer, April/May 2002.
69. **K. U. Veiko Sinivee.** *Encrypted DigiDoc Format Specification,* Version 1.1, June 2012.
70. **J. Viega and D. McGrew.** *The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP).* RFC 4106 (Proposed Standard), June 2005.
71. **D. Wagner and B. Schneier.** *Analysis of the SSL 3.0 Protocol.* In *Proceedings of the 2nd Conference on Proceedings of the Second USENIX Workshop on Electronic Commerce - Volume 2 (WOEC'96)*, pp. 4–4, Berkeley, CA, USA, 1996. USENIX Association.
72. **F. Yergeau.** *UTF-8, a Transformation Format of Unicode and ISO 10646.* RFC 2044 (Informational), October 1996. Obsoleted by RFC 2279.