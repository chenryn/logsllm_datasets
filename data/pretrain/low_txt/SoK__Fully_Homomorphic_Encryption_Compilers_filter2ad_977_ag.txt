以下是优化后的文本，使其更加清晰、连贯和专业：

---

### 参考文献

[51] S. Carpov, P. Dubrulle, and R. Sirdey, "Armadillo: A compilation chain for privacy-preserving applications," in *Proceedings of the 3rd International Workshop on Security in Cloud Computing (SCC '15)*. New York, NY, USA: ACM, 2015, pp. 13–19. [在线]. 可访问: <http://doi.acm.org/10.1145/2732516.2732520>

[52] E. Crockett and C. Peikert, "Λoλ: Functional lattice cryptography," in *Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security*. ACM, 2016, pp. 993–1005. [在线]. 可访问: <https://dl.acm.org/doi/abs/10.1145/2976749.2978402>

[53] I. Chillotti, M. Joye, D. Ligier, J.-B. Orfila, and S. Tap, "CONCRETE: Concrete operates by rapidly extending TFHE," in *WAHC 2020 – 8th Workshop on Encrypted Computing & Applied Homomorphic Cryptography*, 15 Dec. 2020. [在线]. 可访问: <https://homomorphicencryption.org/wp-content/uploads/2020/12/wahc20-demo-damien.pdf>

[54] L. Ducas and D. Micciancio, "FHEW: Bootstrapping homomorphic encryption in less than a second," in *Advances in Cryptology – EUROCRYPT 2015*. Springer Berlin Heidelberg, 2015, pp. 617–640. [在线]. 可访问: <http://dx.doi.org/10.1007/978-3-662-46800-5_24>

[55] CryptoExperts, "FV-NFLlib," May 2016. [在线]. 可访问: <https://github.com/CryptoExperts/FV-NFLlib>

[56] S. Halevi and V. Shoup, "Algorithms in HElib," in *Advances in Cryptology – CRYPTO 2014*. Springer, Berlin, Heidelberg, Aug. 2014, pp. 554–571. [在线]. 可访问: <http://link.springer.com/chapter/10.1007/978-3-662-44371-2_31>

[57] C. Mouchet and J.-P. Bossuat, "Lattigo: A multiparty homomorphic encryption library in Go," in *WAHC 2020 – 8th Workshop on Encrypted Computing & Applied Homomorphic Cryptography*, 15 Dec. 2020. [在线]. 可访问: <https://homomorphicencryption.org/wp-content/uploads/2020/12/wahc20-demo-christian.pdf>

[58] Y. Polyakov, K. Rohloff, and G. W. Ryan, "PALISADE Lattice Cryptography Library User Manual (v1.6.0)," 技术报告, Sep. 2019. [在线]. 可访问: <https://palisade-crypto.org/documentation>

[59] Vernam Group, "cuFHE," Mar. 2018. [在线]. 可访问: <https://github.com/vernamlab/cuFHE>

[60] NuCypher, "nufhe," 19 Jul. 2019. [在线]. 可访问: <https://github.com/nucypher/nufhe>

[61] V. Shoup and Others, "NTL: A library for doing number theory," Aug. 2016. [在线]. 可访问: <http://www.shoup.net/ntl/>

[62] S. Halevi and V. Shoup, "Bootstrapping for HElib," in *Advances in Cryptology – EUROCRYPT 2015*, ser. Lecture Notes in Computer Science, E. Oswald and M. Fischlin, Eds., Springer, Berlin, Heidelberg, Apr. 2015, pp. 641–670. [在线]. 可访问: <http://link.springer.com/chapter/10.1007/978-3-662-46800-5_25>

[63] ——, "HElib design principles," 技术报告, 2020. [在线]. 可访问: <https://homenc.github.io/HElib/documentation/Design-Document/HElib-design.pdf>

[64] R. Player, "Parameter selection in lattice-based cryptography," 博士论文, Royal Holloway, University of London, 2018. [在线]. 可访问: <https://pure.royalholloway.ac.uk/portal/files/29983580/2018playerrphd.pdf>

[65] E. Chielle, O. Mazonka, N. G. Tsoutsos, and M. Maniatakos, "E3: A Framework for Compiling C++ Programs with Encrypted Operands," *IACR Cryptology ePrint Archive*, vol. 2018, p. 1013, 2018. [在线]. 可访问: <https://eprint.iacr.org/2018/1013>

[66] D. W. Archer, J. M. Calderón Trilla, J. Dagit, A. Malozemoff, Y. Polyakov, K. Rohloff, and G. Ryan, "RAMPARTS: A Programmer-Friendly system for building homomorphic encryption applications," in *Proceedings of the 7th ACM Workshop on Encrypted Computing & Applied Homomorphic Cryptography (WAHC'19)*. New York, NY, USA: ACM Press, 2019, pp. 57–68. [在线]. 可访问: <http://dl.acm.org/citation.cfm?doid=3338469.3358945>

[67] R. Dathathri, O. Saarikivi, H. Chen, K. Laine, K. Lauter, S. Maleki, M. Musuvathi, and T. Mytkowicz, "CHET: An optimizing compiler for fully-homomorphic neural-network inferencing," in *Proceedings of the 40th ACM SIGPLAN Conference on Programming Language Design and Implementation*. New York, NY, USA: ACM, 8 Jun. 2019, pp. 142–156. [在线]. 可访问: <https://dl.acm.org/citation.cfm?doid=3314221.3314628>

[68] T. van Elsloo, G. Patrini, and H. Ivey-Law, "SEALion: A Framework for Neural Network Inference on Encrypted Data," arXiv 预印本 arXiv:1904.12840, 2019. [在线]. 可访问: <https://arxiv.org/abs/1904.12840>

[69] E. Crockett, "Simply safe lattice cryptography," 博士论文, Georgia Institute of Technology, 2017. [在线]. 可访问: <https://smartech.gatech.edu/handle/1853/58734>

[70] V. Herbert, "Automatize parameter tuning in Ring-Learning-With-Errors-based leveled homomorphic cryptosystem implementations," 2019. [在线]. 可访问: <https://eprint.iacr.org/2019/1402>

[71] A. Mishchenko, "ABC: System for sequential logic synthesis and formal verification," 2018. [在线]. 可访问: <https://github.com/berkeley-abc/abc>

[72] S. Carpov, P. Aubry, and R. Sirdey, "A multi-start heuristic for multiplicative depth minimization of boolean circuits," in *International Workshop on Combinatorial Algorithms*. Springer, 2017, pp. 275–286. [在线]. 可访问: <https://link.springer.com/chapter/10.1007/978-3-319-78825-8_23>

[73] P. Aubry, S. Carpov, and R. Sirdey, "Faster homomorphic encryption is not enough: Improved heuristic for multiplicative depth minimization of boolean circuits," in *Topics in Cryptology – CT-RSA 2020*. Springer International Publishing, 2020, pp. 345–363. [在线]. 可访问: <http://dx.doi.org/10.1007/978-3-030-40186-3_15>

[74] D. Lee, W. Lee, H. Oh, and K. Yi, "Optimizing homomorphic evaluation circuits by program synthesis and term rewriting," in *Proceedings of the 41st ACM SIGPLAN Conference on Programming Language Design and Implementation (PLDI 2020)*. New York, NY, USA: Association for Computing Machinery, Nov. 2020, pp. 503–518. [在线]. 可访问: <https://doi.org/10.1145/3385412.3385996>

[75] F. Boemer, Y. Lao, R. Cammarota, and C. Wierzynski, "nGraph-HE: A Graph Compiler for Deep Learning on Homomorphically Encrypted Data," in *Proceedings of the 16th ACM International Conference on Computing Frontiers (CF '19)*. New York, NY, USA: ACM, 2019, pp. 3–13. [在线]. 可访问: <https://dl.acm.org/doi/10.1145/3310273.3323047>

[76] S. Cyphers, A. K. Bansal, A. Bhiwandiwalla, J. Bobba, M. Brookhart, A. Chakraborty, W. Constable, C. Convey, L. Cook, O. Kanawi et al., "Intel nGraph: An intermediate representation, compiler, and executor for deep learning," arXiv 预印本 arXiv:1801.08058, 2018. [在线]. 可访问: <https://arxiv.org/abs/1801.08058>

[77] S. Carpov, T. H. Nguyen, R. Sirdey, G. Constantino, and F. Martinelli, "Practical Privacy-Preserving medical diagnosis using homomorphic encryption," in *2016 IEEE 9th International Conference on Cloud Computing (CLOUD)*, Jun. 2016, pp. 593–599. [在线]. 可访问: <http://dx.doi.org/10.1109/CLOUD.2016.0084>

[78] Y. LeCun and C. Cortes, "MNIST handwritten digit database," 2010. [在线]. 可访问: <http://yann.lecun.com/exdb/mnist/>

[79] R. Gilad-Bachrach, N. Dowlin, K. Laine, K. Lauter, M. Naehrig, and J. Wernsing, "CryptoNets: Applying neural networks to encrypted data with high throughput and accuracy," in *Proceedings of the 33rd International Conference on Machine Learning (ICML 2016)*, vol. 48. New York, NY, USA: PMLR, 2016, pp. 201–210. [在线]. 可访问: <http://proceedings.mlr.press/v48/gilad-bachrach16.html>

[80] Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner, "Gradient-based learning applied to document recognition," *Proceedings of the IEEE*, vol. 86, no. 11, pp. 2278–2324, 1998. [在线]. 可访问: <https://ieeexplore.ieee.org/document/726791>

[81] J. E. Savage, *Models of Computation: Exploring the Power of Computing*, 1st ed. Boston, MA, USA: Addison-Wesley Longman Publishing Co., Inc., 1997.

[82] I. Chillotti, N. Gama, M. Georgieva, and M. Izabachène, "TFHE: Fast fully homomorphic encryption over the torus," 2018. [在线]. 可访问: <https://eprint.iacr.org/2018/421>

[83] J. H. Cheon, S. Hong, and D. Kim, "Remark on the security of CKKS scheme in practice," *Cryptology ePrint Archive*, Report 2020/1581, 2020. [在线]. 可访问: <https://eprint.iacr.org/2020/1581>

[84] B. Li and D. Micciancio, "On the security of homomorphic encryption on approximate numbers," *Cryptology ePrint Archive*, Report 2020/1533, 2020. [在线]. 可访问: <https://eprint.iacr.org/2020/1533>

[85] J. H. Cheon, K. Han, A. Kim, M. Kim, and Y. Song, "A full RNS variant of approximate homomorphic encryption," in *Selected Areas in Cryptography – SAC 2018*. Springer International Publishing, 2019, pp. 347–368. [在线]. 可访问: <http://dx.doi.org/10.1007/978-3-030-10970-7_16>

---

### 附录 A

在本附录中，我们简要介绍了全同态加密（FHE）的概念，并概述了三种重要的现代方案。我们主要关注与FHE应用开发者相关的内容，即明文空间、编码以及影响性能的方面。

#### A. 全同态加密

同态加密方案是一种（通常是公钥）加密方案，在这种方案中，明文上的操作和密文上的操作之间存在同态映射：
\[ \text{Dec}(\text{Enc}(x + y)) = \text{Dec}(\text{Enc}(x) \oplus \text{Enc}(y)) \]
其中，+ 和 ⊕ 分别是明文空间和密文空间上的操作。一个全同态加密方案是对加法和乘法都具有同态性的。我们在这里省略更正式的定义，而是参考 [11] 获取包括排除平凡构造的几个约束在内的正式定义。

加法和乘法允许我们在加密数据上计算任何多项式函数，但许多常用函数（如比较或排序）是非多项式的，即不能（容易地）表示为多项式函数。然而，Z2 中的加法和乘法可以用来模拟 XOR 和 AND 门。结合内存，这使得图灵完备，即可以模拟任意计算 [81]。

#### B. FHE 方案

我们简要介绍三种最广泛使用的同态加密方案。

1. **CGGI 方案**：Chillotti-Gama-Georgieva-Izabachene 方案 [38], [39] 是基于 Gentry-Sahai-Waters (GSW) 方案 [37] 的第三代 FHE 方案之一。它通常被称为 TFHE，但我们在这里使用作者的首字母以避免与 TFHE 库混淆。

   在 CGGI 中，明文和密文空间 \( T \) 是一组多项式（模某个不可约多项式），其最高次数为 \( n-1 \)，位于环 \( T = \mathbb{R}/\mathbb{Z} \)（即实数模 1）。消息空间通常选择为使计算模拟二进制电路，同态加法成为 XOR，乘法成为 AND。由于 \( T \) 不是一个环，它支持加法但没有原生的乘法操作。然而，乘法可以在 GSW 密文和 \( T \) 中的密文之间定义。这用于在引导过程中执行 \( T \) 中密文的乘法和非线性操作，通过将引导密钥加密为 GSW 密文来实现。\( T \) 中密文之间的乘法是作为引导过程中的一种特定类型的非线性变换来实现的。在这个门引导版本的方案中，每个非线性门本质上都包含引导过程。

   Chillotti 等人还展示了如何构建一个 MUX 门，该门根据 GSW 密文在两个 \( T \) 中的密文之间进行选择，并引入了高效的设计方法来实现查找表（LUT）。最后，他们展示了如何使用加权有限自动机来模拟二进制乘法 [82]。然而，这些技术并未在 TFHE 库中实现。

2. **BFV 方案**：Brakerski/Fan-Vercauteren 方案是第二代方案。Fan 和 Vercauteren [32] 将 Brakerski [33] 提出的一个方案移植到环-LWE 域，并改进了其性能。在 BFV 中，明文空间 \( R_t \) 是一组多项式（模某个不可约多项式），其最高次数为 \( n-1 \)，系数在 \( \mathbb{Z}_t \) 中。注意，当 \( t = 2 \) 时，我们处于二进制电路设置中。消息 \( m \in \mathbb{Z}_t \) 可以被编码为常数多项式 \( f(x) = m \)。然而，这是低效的，因为只有 \( n \) 个系数中的一个是被利用的。简单地将消息编码到其他系数中会在执行计算时引发问题：虽然多项式加法逐系数工作，但乘法会以不希望的方式组合不同的系数。相反，可以通过中国剩余定理 [34] 实现 SIMD 风格的批处理。通过选择 \( n = \Pi_{i=0}^k n_i \)，一个 \( n \) 次多项式可以被重新解释为 \( k \) 个较低次多项式的乘积。使用此技术，最多可以将 \( k \) 条消息打包到单个明文中，实践中 \( k \) 可以达到 1000 多条，同时保持有意义的语义。自同构还允许对元素进行同态旋转 [35]。

   密文则由 \( R_q \) 中的元素组成，其结构与 \( R_p \) 相同，但系数模为 \( q \)。每个密文至少包含两个元素，即 \( c = [c_0, c_1] \)。这些多项式 \( c_i \) 本身可以被解释为多项式 \( C(X) \) 的系数。密文之间的同态加法和乘法分别对应于 \( C(X) \) 之间的加法和乘法。因此，乘法的结果是一个二次多项式，即一个包含三个元素的密文 \( c = [c_0, c_1, c_2] \)。在进一步的乘法过程中，噪声项会首先平方，然后立方等，变得非常大。因此，BFV 和类似的方案引入了重线性化程序，将密文转换回线性形式。我们省略对引导过程的描述，而是指出 BFV 更常用于分层模式，其中参数选择足够大以完成不需要引导的计算。

3. **CKKS 方案**：Cheon-Kim-Kim-Song 方案 [36]，也称为近似数算术同态加密（HEAAN），专注于近似数的同态加密。严格来说，它不是一个 FHE 方案，因为它只近似满足要求，即对于某些操作 \( + \) 和 \( \oplus \)，有 \( \text{Dec}(\text{Enc}(x + y)) \approx \text{Dec}(\text{Enc}(x) \oplus \text{Enc}(y)) \)。虽然这种轻微的放松导致了一个极其高效的方案，但在使用近似 FHE 方案时仍需谨慎 [83], [84]。CKKS 主要设计用于定点数计算，即一个数 \( x \) 被表示为 \( m = \lfloor x \cdot \Delta \rfloor \) 对于尺度 \( \Delta \)，通常是一个大整数。虽然任何基于整数的方案都可以用于定点计算，但它们很快会遇到溢出问题。CKKS 通过引入同态舍入操作来解决这个问题，该操作将乘积的尺度减小回原始尺度 \( \Delta \)。

   在 CKKS 中，逻辑消息空间是 \( \mathbb{C}^n \)，即复数向量，尽管大多数应用仅使用实部。明文空间 \( R \) 是一组多项式（模某个不可约多项式），其最高次数为 \( n-1 \)，系数在 \( \mathbb{Z} \) 中。给定缩放因子 \( \Delta \in \mathbb{R} \)，我们将 \( m \in \mathbb{R} \) 表示为 \( m' = \lfloor \Delta m \rfloor \in \mathbb{Z} \)。为了简洁起见，我们省略了将这种表示编码为明文多项式的描述，只需注意编码会引入小的额外近似误差。在加密过程中，有意引入噪声，但这种噪声与明文的最低有效位重叠。因此，近似误差和噪声被视为一体，而不是在噪声达到阈值时突然丢失消息，我们逐渐失去精度。

   与 BFV 类似，CKKS 中的密文是 \( R_q \) 中的元素数组 \( c_i \)，并且乘法需要重线性化。然而，不同于 BFV，噪声 \( e \) 在每次后续乘法后呈二次增长。经过 \( \ell \) 次乘法后，噪声增长到 \( e^{2\ell} \)，并且需要一个模 \( q \approx e^{2\ell} \) 才能正确解密结果密文。相反，可以通过因子 \( \omega \) 缩放密文，即从 \( R_q \) 到 \( R_{q/\omega} \)。这被称为重缩放，类似于 Brakerski-Gentry-Vaikuntanathan (BGV) 方案 [31] 中的模切换操作，但重缩放也会影响明文。使用重缩放，大小为 \( (\ell + 1)\omega e \) 的模就足以评估 \( \ell \) 次后续乘法。在此操作期间，密文中加密的明文也有效地重缩放到 \( \Delta' = \lfloor \Delta / \omega \rfloor \)。选择 \( q = \Pi_{i=0}^k q_i \) 其中 \( q_i \) 是大致相等的素数，可以提高性能 [85] 并且通过设置 \( \omega = q_i \) 确保整个计算过程中几乎恒定的尺度。

---

希望这些优化能使文本更加清晰、连贯和专业。