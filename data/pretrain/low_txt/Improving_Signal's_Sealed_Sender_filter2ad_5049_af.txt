### Improved Text

To prevent the abuse of personal identifiers, such as phone numbers, we recommend that Signal adopt anonymous credentials, implemented using blind signatures. We have developed a prototype to demonstrate that our solution is both performant and cost-effective for deployment.

Signal has already taken a significant step toward providing anonymous communication to millions of users with its sealed sender feature. However, Signal's current design prioritizes practicality, which means it does not provide strong protection against even known disclosure attacks. We believe that this effort can be enhanced without sacrificing practicality, and we hope that our work provides a clear path toward this goal.

### References

1. **Django**. [Online]. Available: <https://www.djangoproject.com/> (Accessed: 2019-11-21).
2. **Orbot: Tor for Android**. [Online]. Available: <https://guardianproject.info/apps/orbot/> (2020).
3. R. Albert and A.-L. Barabási, "Statistical mechanics of complex networks," *Reviews of Modern Physics*, vol. 74, no. 1, p. 47, 2002.
4. A. Athanasiou, "Blind-RSA." [Online]. Available: <https://github.com/arisath/Blind-RSA> (Accessed: 2019-11-21).
5. J. Ball, "NSA collects millions of text messages daily in 'untargeted' global sweep," *The Guardian*, Jan 16, 2014. [Online]. Available: <https://www.theguardian.com/world/2014/jan/16/nsa-collects-millions-text-messages-daily-untargeted-global-sweep>
6. N. Borisov, I. Goldberg, and E. Brewer, "Off-the-record communication, or, why not to use PGP," in *Proceedings of the 2004 ACM Workshop on Privacy in the Electronic Society* (WPES '04), New York, NY, USA: ACM, 2004, pp. 77–84. [Online]. Available: <http://doi.acm.org/10.1145/1029179.1029200>
7. J. Brooks et al., "Ricochet: Anonymous instant messaging for real privacy," 2016.
8. D. Chaum, "Blind signatures for untraceable payments," 1982, pp. 199–203.
9. K. Cohn-Gordon, C. Cremers, B. Dowling, L. Garratt, and D. Stebila, "A formal security analysis of the Signal messaging protocol," in *2017 IEEE European Symposium on Security and Privacy (EuroS&P)*, April 2017, pp. 451–466.
10. K. Cohn-Gordon, C. Cremers, L. Garratt, J. Millican, and K. Milner, "On Ends-to-Ends Encryption: Asynchronous Group Messaging with Strong Security Guarantees," in *Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications Security* (CCS '18), New York, NY, USA: ACM, 2018, pp. 1802–1819.
11. H. Corrigan-Gibbs, D. Boneh, and D. Mazières, "Riposte: An Anonymous Messaging System Handling Millions of Users," in *2015 IEEE Symposium on Security and Privacy*, May 2015, pp. 321–338.
12. H. Corrigan-Gibbs and B. Ford, "Dissent: Accountable Anonymous Group Messaging," in *Proceedings of the 17th ACM Conference on Computer and Communications Security* (CCS '10), ACM, 2010, pp. 340–350.
13. H. Corrigan-Gibbs, D. I. Wolinsky, and B. Ford, "Proactively accountable anonymous messaging in Verdict," in *Presented as part of the 22nd USENIX Security Symposium (USENIX Security 13)*, 2013, pp. 147–162.
14. G. Danezis, "Statistical Disclosure Attacks," in *Security and Privacy in the Age of Uncertainty*. Springer US, 2003, pp. 421–426.
15. ——, "Better anonymous communications," Ph.D. dissertation, University of Cambridge, 2004.
16. G. Danezis, C. Díaz, and C. Troncoso, "Two-sided statistical disclosure attack," in *Privacy Enhancing Technologies*. Springer Berlin Heidelberg, 2007, pp. 30–44.
17. G. Danezis and C. Troncoso, "Vida: How to use Bayesian inference to de-anonymize persistent communications," in *Privacy Enhancing Technologies*. Springer Berlin Heidelberg, 2009, pp. 56–72.
18. M. Di Raimondo, R. Gennaro, and H. Krawczyk, "Secure off-the-record messaging," in *Proceedings of the 2005 ACM Workshop on Privacy in the Electronic Society* (WPES '05), New York, NY, USA: ACM, 2005, pp. 81–89. [Online]. Available: <http://doi.acm.org/10.1145/1102199.1102216>
19. R. Dingledine, N. Mathewson, and P. Syverson, "Tor: The second-generation onion router," in *Proceedings of the 13th Conference on USENIX Security Symposium - Volume 13* (SSYM'04), Berkeley, CA, USA: USENIX Association, 2004, pp. 21–21. [Online]. Available: <http://dl.acm.org/citation.cfm?id=1251375.1251396>
20. P. Erdős and A. Rényi, "On random graphs, I," *Publicationes Mathematicae (Debrecen)*, vol. 6, pp. 290–297, 1959.
21. A. Fifield, "Chinese app on Xi’s ideology allows data access to users’ phones, report says," *The Washington Post*, Oct. 2019.
22. T. Frosch, C. Mainka, C. Bader, F. Bergsma, J. Schwenk, and T. Holz, "How secure is TextSecure?" in *2016 IEEE European Symposium on Security and Privacy (EuroS&P)*, March 2016, pp. 457–472.
23. A. Greenberg, "Signal is finally bringing its secure messaging to the masses," Feb 2020. [Online]. Available: <https://www.wired.com/story/signal-encrypted-messaging-features-mainstream/>
24. J. Hakkilä and C. Chatfield, "'It’s like if you opened someone else’s letter': User perceived privacy and social practices with SMS communication," in *Proceedings of the 7th International Conference on Human Computer Interaction with Mobile Devices & Services* (MobileHCI '05). ACM, 2005, pp. 219–222.
25. S. Havron, D. Freed, R. Chatterjee, D. McCoy, N. Dell, and T. Ristenpart, "Clinical computer security for victims of intimate partner violence," in *28th USENIX Security Symposium (USENIX Security 19)*, Santa Clara, CA: USENIX Association, Aug. 2019, pp. 105–122. [Online]. Available: <https://www.usenix.org/conference/usenixsecurity19/presentation/havron>
26. F. Hillebrand, F. Trosby, K. Holley, and I. Harris, *Short Message Service (SMS): The Creation of Personal Global Text Messaging*. Wiley, 2010.
27. W. Hoeffding, "Probability inequalities for sums of bounded random variables," *J. Amer. Statist. Assoc.*, vol. 58, pp. 13–30, 1963. [Online]. Available: <http://www.jstor.org/stable/2282952>
28. G. W. Index, "VPN users around the world," 2018. [Online]. Available: <https://www.globalwebindex.com/reports/vpn-usage-around-the-world>
29. Johns Hopkins Foreign Affairs Symposium, "The price of privacy: Re-evaluating the NSA," <https://youtu.be/kV2HDM86XgI?t=1079>, April 2014.
30. D. Kesdogan, D. Agrawal, V. Pham, and D. Rautenbach, "Fundamental limits on the anonymity provided by the MIX technique," in *2006 IEEE Symposium on Security and Privacy (S&P'06)*, 2006, pp. 14 pp.–99.
31. A. Kwon, H. Corrigan-Gibbs, S. Devadas, and B. Ford, "Atom: Horizontally scaling strong anonymity," in *Proceedings of the 26th Symposium on Operating Systems Principles*. ACM, 2017, pp. 406–422.
32. B. LaBelle, "Secure messaging apps are growing faster in corrupt countries," *Apptopia blog*, 2018. [Online]. Available: <https://blog.apptopia.com/secure-msging-growth-corrupt>
33. A. Langley, "Pond," 2015.
34. H. Leibowitz, A. M. Piotrowska, G. Danezis, and A. Herzberg, "No right to remain silent: isolating malicious mixes," in *28th USENIX Security Symposium (USENIX Security 19)*, 2019, pp. 1841–1858.
35. B. Libert and J.-J. Quisquater, "Efficient signcryption with key privacy from gap Diffie-Hellman groups," 2004, pp. 187–200.
36. J. Lund, "Technology preview: Sealed sender for Signal," Oct 2018. [Online]. Available: <https://signal.org/blog/sealed-sender/>
37. N. Mallesh and M. Wright, "The reverse statistical disclosure attack," in *Information Hiding*. Springer Berlin Heidelberg, 2010, pp. 221–234.
38. B. Marczak, J. Scott-Railton, S. McKune, B. A. Razzak, and R. Deibert, "Hide and Seek: Tracking NSO Group’s Pegasus Spyware to Operations in 45 Countries," *University of Toronto, Tech. Rep. 113*, Sep. 2018.
39. M. Marlinspike, "Advanced cryptographic ratcheting," *Signal Blog*, Nov. 2013.
40. N. Mathewson and R. Dingledine, "Practical traffic analysis: Extending and resisting statistical disclosure," in *Privacy Enhancing Technologies*. Springer Berlin Heidelberg, 2005, pp. 17–34.
41. S. E. McGregor, P. Charters, T. Holliday, and F. Roesner, "Investigating the computer and security needs of journalists," in *24th USENIX Security Symposium (USENIX Security 15)*, Washington, D.C.: USENIX Association, Aug. 2015, pp. 399–414. [Online]. Available: <https://www.usenix.org/conference/usenixsecurity15/technical-sessions/presentation/mcgregor>
42. Open Whisper Systems, "Signal source code," <https://github.com/signalapp>, 2013.
43. S. Oya, C. Troncoso, and F. Pérez-González, "Meet the family of statistical disclosure attacks," in *IEEE Global Conference on Signal and Information Processing, GlobalSIP*. IEEE, 2013, pp. 233–236. [Online]. Available: <https://arxiv.org/abs/1910.07603>
44. F. Pérez-González and C. Troncoso, "Understanding statistical disclosure: A least squares approach," in *Privacy Enhancing Technologies*. Springer Berlin Heidelberg, 2012, pp. 38–57.
45. M. G. Reed, P. F. Syverson, and D. M. Goldschlag, "Anonymous connections and onion routing," *IEEE Journal on Selected Areas in Communications*, vol. 16, no. 4, pp. 482–494, May 1998.
46. P. Rösler, C. Mainka, and J. Schwenk, "More is Less: On the End-to-End Security of Group Chats in Signal, WhatsApp, and Threema," in *2018 IEEE European Symposium on Security and Privacy (EuroS&P)*, April 2018, pp. 415–429.
47. M. Schliep and N. Hopper, "End-to-end secure mobile group messaging with conversation integrity and deniability," in *Proceedings of the 18th ACM Workshop on Privacy in the Electronic Society* (WPES'19). ACM, 2019, pp. 55–73.
48. N. Tyagi, Y. Gilad, D. Leung, M. Zaharia, and N. Zeldovich, "Stadium: A distributed metadata-private messaging system," in *Proceedings of the 26th Symposium on Operating Systems Principles*. ACM, 2017, pp. 423–440.
49. N. Unger, S. Dechand, J. Bonneau, S. Fahl, H. Perl, I. Goldberg, and M. Smith, "SoK: Secure messaging," in *2015 IEEE Symposium on Security and Privacy*, May 2015, pp. 232–249.
50. J. van den Hooff, D. Lazar, M. Zaharia, and N. Zeldovich, "Vuvuzela: Scalable private messaging resistant to traffic analysis," in *Proceedings of the 25th Symposium on Operating Systems Principles* (SOSP '15). ACM, 2015, pp. 137–152.
51. Y. Wang, M. Manulis, M. H. Au, and W. Susilo, "Relations among privacy notions for signcryption and key invisible 'Sign-then-Encrypt'," 2013, pp. 187–202.
52. D. J. Watts and S. H. Strogatz, "Collective dynamics of small-world networks," *Nature*, vol. 393, no. 6684, p. 440, 1998.

### Appendix

#### A. Proof of Theorem 1

Consider an arbitrary non-associate Charlie, with a probability \( r_c \) of appearing in a random or target epoch. We first analyze the probability that Alice appears above Charlie in the ranking after \( n \) random and target epochs.

Recall that the attack maintains a "score" for each user, increasing by 1 each time the user appears in a target epoch, and decreasing by 1 each time the user appears in a random epoch. Define \( 2n \) random variables \( X_1, \ldots, X_n \) and \( Y_1, \ldots, Y_n \), corresponding to the signed difference in Alice and Charlie's scores during each of the \( n \) random epochs (\( X_i \)'s) and target epochs (\( Y_i \)'s). So each \( X_i, Y_i \in \{-1, 0, 1\} \) and the sum \( \bar{X} = \sum_{i=1}^{n} (X_i + Y_i) \) is the difference in Alice and Charlie's score at the end of the attack. We wish to know the probability that \( \bar{X} > 0 \).

By the stated probability assumptions, we know the expected value of all of these random variables: \( E[X_i] = r_c - r_a \), \( E[Y_i] = t_a - r_c \), and therefore by linearity of expectation, \( E[\bar{X}] = n(t_a - r_a) \). Crucially, note that this is independent of Charlie's probability \( r_c \) because we included the same number of random and target epochs.

We can now apply Hoeffding's inequality [27] over the sum of these \( 2n \) independent, bounded random variables \( X_i, Y_i \) to conclude that \( \Pr[\bar{X} \leq 0] \leq \exp(-n(t_a - r_a)^2/4) \).

Noting that this bound does not depend on the particular non-associate Charlie in any way, we can apply a simple union bound over all \( \leq m \) non-associates to obtain the stated result.

#### B. Proof of Security for One-Way Sealed Sender Conversations

We now provide a proof that the protocol in Section VI-B realizes the ideal functionality in Figure 6. As mentioned, we give this proof in the standalone model with static corruptions.

We define the simulator \( \text{Sim} \) as follows:

**Setup:**
- At startup, \( \text{Sim} \) generates long-term key pairs \( (pk_{P_i}, sk_{P_i}) \) for each honest user \( P_i \in P_H \).
- Next, \( \text{Sim} \) receives a public key \( pk_{P_j} \) for each corrupt user \( P_j \in P_C \) from the adversary.
- \( \text{Sim} \) initializes an empty table \( T \) with the format:
  \[
  (cid, Ps, pk_s, cid, sk_s, cid, Pr, pk_r, cid, sk_r, cid)
  \]
  where \( Ps \) is the identity of the conversation initiator, \( (pk_s, cid, sk_s, cid) \) is the keypair used by \( Ps \) in conversation \( cid \), \( Pr \) is the initial receiver, and \( (pk_r, cid, sk_r, cid) \) is the keypair used by \( Pr \) in conversation \( cid \). Some elements in these entries may be empty if \( \text{Sim} \) does not know the value. We will represent unknown elements with \( \cdot \).
- \( \text{Sim} \) also initializes an empty message table \( M \) with the format:
  \[
  (cid, mid, c)
  \]

Note that the definition presented in Figure 6 is in terms of pull notifications, while the protocol in Section VI-B is in terms of push notifications. However, the push notifications in the protocol, modeled after how Signal actually works, are essentially a sustained pull. That is, opening a long-term connection is equivalent to having the receiver continuously sending pull requests to the server. To bridge this gap, the simulator maintains a list of open connections. At each time step, the simulator iterates through the list of open connections and sends a `ReceiveMessage` to the ideal functionality of that player's part. Similarly, we expect that honest users will do this if they want push-style notifications.

**1) Honest User Starts Conversation:**
- When \( \text{Sim} \) receives the message `(ApproveNewConvo, Pr, cid)` from the ideal functionality, it samples \( (pk_{s, cid}, sk_{s, cid}) \leftarrow \Pi_{ssenc}.SSKeyGen(1^\lambda) \).
- \( \text{Sim} \) retrieves the long-term information for user \( Pr \), i.e., \( pk_{Pr}, sk_{Pr} \).
- Add the entry \( (cid, \cdot, pk_{s, cid}, sk_{s, cid}, Pr, pk_{Pr}, sk_{Pr}) \) to \( T \) and then does the following:
  - Encrypt \( c \leftarrow \Pi_{ssenc}.SSEnc(``init'' || pk_{s, cid}, sk_{s, cid}, pk_{Pr}) \).
  - Send \( c \) to \( P_{service} \).

If \( \text{Sim} \) gets \( c' \) from \( P_{service} \) for \( Pr \) and \( c = c' \), \( \text{Sim} \) performs the following:
  - Sends an acknowledgment to \( P_{service} \) on behalf of \( Pr \) for \( Ps \).
  - Receives the acknowledgment on behalf of \( Ps \).
  - Sends `(Approve)` to the ideal functionality.

Otherwise, \( \text{Sim} \) sends `(Disapprove)` to the ideal functionality.