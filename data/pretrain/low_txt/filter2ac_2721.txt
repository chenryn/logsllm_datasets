### Title: From Logic to Memory: Exploiting Reparse Points for Privilege Escalation

In recent years, two types of reparse points—mount points and symbolic links (symlinks)—have been frequently exploited in file redirection vulnerabilities within Windows system services. These vulnerabilities have led to a wide range of security issues, from permanent Denial of Service (DoS) and information leaks to privilege escalation. In response, Microsoft has not only fixed these vulnerabilities but also implemented numerous mitigations to make this class of bugs increasingly difficult to exploit successfully and consistently.

This presentation will highlight a 0-day logic vulnerability that bypasses all current mitigations using undisclosed exploitation techniques. This vulnerability was the key to winning the Windows EoP (Elevation of Privilege) category at Pwn2Own 2021. The presentation will cover the entire process, from the unique strategy used to discover the bug in just one day to the methods employed to stably win a seemingly impossible race condition.

However, the story does not end there. Microsoft has ceased offering bug bounties for this class of vulnerabilities and continues to release more mitigations, aiming to eliminate them entirely. While it may seem like the era of reparse point vulnerabilities is coming to an end, the reality is more complex. There are over fifty different tags in reparse points, and mount points and symlinks are just two of them.

By exploring other reparse point tags, we discovered several memory corruption vulnerabilities that can lead to EoP. One particularly interesting finding is a function that contains three types of bugs: out-of-bounds read, out-of-bounds write, and a race condition. Even more intriguing, this vulnerable function appears in multiple different Windows components.

We reported our findings to Microsoft and were promptly rewarded with bug bounties for our new discoveries. These memory corruption EoP bugs in reparse points can lead to native code execution in Windows system services, allowing for direct privilege escalation to SYSTEM. Importantly, all previous and future mitigations against logic EoP bugs in reparse points are ineffective against these memory corruption vulnerabilities.

This presentation will unveil this new and less-noticed attack surface for memory corruption EoP bugs in reparse points, providing insights into the potential risks and the need for further research and mitigation.