# Confusion Matrix and Performance Metrics

The confusion matrix for the ensemble model with 5 users is presented in Table 8. The table shows the number of true positives, false positives, true negatives, and false negatives for each user.

| User | Disagreed | Agreed | Recall | Precision | F1 Score |
|------|-----------|--------|--------|-----------|----------|
| 1    | 0         | 0      | 1.0    | 1.0       | 1.0      |
| 3    | 0         | 0      | 1.0    | 0.98      | 0.98     |
| 4    | 0         | 0      | 1.0    | 1.0       | 1.0      |
| 8    | 3         | 0      | 0.85   | 0.85      | 0.85     |
| 10   | 4         | 0      | 0.75   | 0.75      | 0.75     |
| Total| 15        | 0      | 0.66   | 0.97      | 0.80     |

## Related Work

### Behavioral Authentication
Behavioral authentication has been studied in various contexts. Freeman et al. [11] designed a machine learning (ML) approach to cluster logins based on IP, geolocation, browser, and time for authenticating users to online services. Device fingerprinting has also been used to augment user authentication on the web [4].

### IoT Authorization and Access Control
Authorization and access policy frameworks in IoT systems have been an active research area. He et al. [14] conducted a survey on IoT device authorization preferences and found that most devices have limited authorization flexibility. ContexIoT [15] provides contextual information to users for better access control decisions. SmartAuth [28] generates a user interface for authorization decisions in IoT apps, while Soteria [8] performs static analysis to ensure IoT apps respect security policies. IoTGUARD [9] dynamically enforces security policies in IoT devices by monitoring event handlers.

### Smart Home Authentication
Prior work has investigated user authentication in smart home environments. Emami-Naeini et al. [21] found that users are uncomfortable with biometric data collection in IoT settings. Biometric-based authentication is optional in Alexa [2], but it is prone to recording and replay attacks. Shi et al. [24] proposed an authentication system using physical properties of WiFi signals generated by IoT devices. Apthorpe et al. [5] showed that user actions can be inferred from encrypted network traffic generated by IoT devices.

## Experimental Results

We utilize network communication statistics from user interactions with IoT devices to build a user authentication framework using ML. Our system computes an authentication score for each user, which can be used by services to enforce flexible policies based on the sensitivity of the service.

### Model Performance
We experimented with several ML algorithms, including random forest and gradient boosting, using features extracted from network traffic. These models performed well, achieving high accuracy in user classification. An ensemble of two models increased classification confidence but abstained from producing a score when the models disagreed.

We also tested deep neural network (DNN) architectures, such as feed-forward neural networks and LSTMs. However, their performance was not comparable to gradient boosting and random forest. The best F1 scores for feed-forward and LSTM were 0.54 and 0.51, respectively, compared to 0.86 for gradient boosting. This may be due to the limited labeled dataset available for training.

### ROC Curves
Figures 8 and 9 show the receiver operating characteristic (ROC) curves for different models and users. The area under the curve (AUC) values indicate the performance of the models. For example, the AUC for the gradient boosting model for user 1 is 0.99, and for user 3, it is 0.87.

### Future Work
Future research could involve re-training the ML model with new behavioral data over time, especially as new IoT devices are added to the smart home and user interests change. Additionally, investigating the performance of the models in the presence of multiple active users in the smart home is a promising direction.

## Acknowledgements
The authors would like to thank David Choffnes, Daniel Dubois, and Jingjing Ren for providing access to the Mon(IoT)r Lab at Northeastern University and setting up the data collection infrastructure. We also thank Visa Research for funding this research and Andres Molina-Markham for discussions on contextual authentication.

## References
[1] Krebs, B. (2019). Facebook Stored Hundreds of Millions of User Passwords in Plain Text. Krebs on Security.
[2] Amazon. (2019). Manage Alexa Voice Purchasing Settings.
[3] NCSC. (2019). Passwords, passwords everywhere.
[4] Alaca, F., & van Oorschot, P. C. (2016). Device Fingerprinting for Augmenting Web Authentication: Classification and Analysis of Methods. In ACSAC '16.
[5] Apthorpe, N., Reisman, D., Sundaresan, S., Narayanan, A., & Feamster, N. (2017). Spying on the smart home: Privacy attacks and defenses on encrypted IoT traffic. arXiv preprint arXiv:1708.05044.
[6] Biggio, B., Nelson, B., & Laskov, P. (2012). Poisoning attacks against support vector machines. In ICML.
[7] Blasco, J., Chen, T. M., Tapiador, J., & Peris-Lopez, P. (2016). A Survey of Wearable Biometric Recognition Systems. ACM Comput. Surv.
[8] Celik, Z. B., McDaniel, P., & Tan, G. (2018). Soteria: Automated IoT Safety and Security Analysis. In USENIX ATC '18.
[9] Celik, Z. B., Tan, G., & McDaniel, P. D. (2019). IoT-Guard: Dynamic Enforcement of Security and Safety Policy in Commodity IoT. In NDSS '19.
[10] De Cristofaro, E., Du, H., Freudiger, J., & Norcie, G. (2013). A comparative usability study of two-factor authentication. arXiv preprint arXiv:1309.5344.
[11] Freeman, D., Jain, S., Dürmuth, M., Biggio, B., & Giacinto, G. (2016). Who Are You? A Statistical Approach to Measuring User Authenticity. In NDSS.
[12] Gafurov, D., Helkala, K., & Søndrol, T. (2006). Biometric Gait Authentication Using Accelerometer Sensor. JCP.
[13] Habib, H., Naeini, P. E., Devlin, S., Oates, M., Swoopes, C., Bauer, L., Christin, N., & Cranor, L. F. (2018). User Behaviors and Attitudes Under Password Expiration Policies. In SOUPS '18.
[14] He, W., Golla, M., Padhi, R., Ofek, J., Dürmuth, M., Fernandes, E., & Ur, B. (2018). Rethinking Access Control and Authentication for the Home Internet of Things (IoT). In USENIX Security '18.
[15] Jia, Y. J., Chen, Q. A., Wang, S., Rahmati, A., Fernandes, E., Mao, Z. M., & Prakash, A. (2017). ContexIoT: Towards Providing Contextual Integrity to Appified IoT Platforms. In NDSS '17.
[16] Khan, H., Atwater, A., & Hengartner, U. (2014). A Comparative Evaluation of Implicit Authentication Schemes. In RAID.
[17] Khan, H., Atwater, A., & Hengartner, U. (2014). Itus: An Implicit Authentication Framework for Android. In MobiCom '14.
[18] Mare, S., Markham, A. M., Cornelius, C., Peterson, R., & Kotz, D. (2014). ZEBRA: Zero-Effort Bilateral Recurring Authentication. In IEEE Symposium on Security and Privacy '14.
[19] Melicher, W., Kurilova, D., Segreti, S. M., Kalvani, P., Shay, R., Ur, B., Bauer, L., Christin, N., Cranor, L. F., & Mazurek, M. L. (2016). Usability and Security of Text Passwords on Mobile Devices. In CHI '16.
[20] Meng, W., Wong, D. S., Furnell, S., & Zhou, J. (2015). Surveying the Development of Biometric User Authentication on Mobile Phones. IEEE Communications Surveys and Tutorials.
[21] Naeini, P. E., Bhagavatula, S., Habib, H., Degeling, M., Bauer, L., Cranor, L. F., & Sadeh, N. (2017). Privacy Expectations and Preferences in an IoT World. In SOUPS '17.
[22] Peng, G., Zhou, G., Nguyen, D. T., Qi, X., Yang, Q., & Wang, S. (2017). Continuous authentication with touch behavioral biometrics and voice on wearable glasses. IEEE Transactions on Human-Machine Systems.
[23] Riva, O., Qin, C., Strauss, K., & Lymberopoulos, D. (2012). Progressive Authentication: Deciding When to Authenticate on Mobile Phones. In USENIX Security Symposium.
[24] Shi, C., Liu, J., Liu, H., & Chen, Y. (2017). Smart user authentication through actuation of daily activities leveraging WiFi-enabled IoT. In MobiHoc '17.
[25] Shi, E., Niu, Y., Jakobsson, M., & Chow, R. (2010). Implicit authentication through learning user behavior. In International Conference on Information Security.
[26] Siadati, H., Nguyen, T., Gupta, P., Jakobsson, M., & Memon, N. (2017). Mind your SMSes: Mitigating social engineering in second factor authentication. Computers & Security.
[27] Steinhardt, J., Koh, P. W., & Liang, P. (2017). Certified Defenses for Data Poisoning Attacks. In NIPS.
[28] Tian, Y., Zhang, N., Lin, Y. H., Wang, X., Ur, B., Guo, X., & Tague, P. (2017). SmartAuth: User-Centered Authorization for the Internet of Things. In USENIX Security '17.
[29] Ur, B., Bees, J., Segreti, S. M., Bauer, L., Christin, N., & Cranor, L. F. (2016). Do Users’ Perceptions of Password Security Match Reality? In CHI '16.
[30] Wayman, J., Jain, A., Maltoni, D., & Maio, D. (2005). An introduction to biometric authentication systems. In Biometric Systems.
[31] Wolf, F., Kuber, R., & Aviv, A. J. (2019). Pretty Close to a Must-Have: Balancing Usability Desire and Security Concern in Biometric Adoption. In CHI '19.
[32] Xiao, H., Biggio, B., Brown, G., Fumera, G., Eckert, C., & Roli, F. (2015). Is feature selection secure against training data poisoning? In ICML.