### Improved Text

#### Random Selection of Identification Values
Since the identification values (DID) should be randomly selected from a large domain (e.g., \(2^{256}\)), even a quota well in excess of any reasonable law enforcement need (e.g., 1000 per day) will not provide a useful mechanism for enumerating the authorization keys for unknown devices. Additionally, it is possible to further encrypt the contents of the HSM in such a way that manufacturer employees never handle sensitive per-device values (e.g., Dauth and any protection keys).

#### Law Enforcement Access Protocol
Consider the following approach: a law enforcement agency (e.g., the FBI) provides a public key, LE_FBI, to the manufacturer, who installs it in the HSM. As before, a valid court order would include a statement with the DID value obtained from the seized device, along with a signature \(S\) covering that value, generated using the private key \(LE_{FBI}^{-1}\). The manufacturer’s employees responsible for legal process would validate the court order, log into the HSM using their credentials, and provide the values for DID and \(S\). The HSM would then validate that \(S\) is a valid signature for DID and, if so, look up the corresponding tuple in the database (DID, Dauth, ...), encrypt them with LE_FBI, and return the now opaque value to the manufacturer’s employees to be sent to law enforcement. In this way, legal process employees would be unable to substitute another DID value or obtain an unencrypted version of Dauth. This approach would be an improvement over the current state of legal processes and provide an additional tool for benign employees to distinguish valid court orders from potentially fraudulent requests.

#### Insider Threats
We do not believe that insider threats via legal process employees are as significant as has been suggested; we are unaware of empirical evidence that current legal process requests are being subverted in this manner. Moreover, to the extent that risks of insider theft of authorization keys are a significant concern, there are meaningful technical approaches that would dramatically reduce such risk.

#### Transparency
The last property we address is transparency. The goal is to reveal that a device’s passcode has been acquired via the lawful access procedure and minimize its value for covert use. On the device itself, the escrow agent can burn an "unlock attempted" status fuse upon initiating the authorization protocol (i.e., when the device first provides DID) and another "unlocked" fuse once it completes the protocol and unlocks the device. The device firmware can report on the state of these fuses when the device starts (e.g., audible and visible notifications that the device has been unlocked by an outside party). If one needed to track subsequent events, a count could be implemented.

One shortcoming of this approach is that it assumes the device itself will not be substituted (i.e., a variant of the "evil-maid" attack). An attacker might unlock a phone via the authorization protocol, extract the contents, and copy them to a new phone (whose status fuses are still pristine). If this transfer is completed without detection, the phone might be returned to its owner (a minimum of three days later) without them knowing that their device’s contents had been accessed. Note that since the plaintext passcode is never revealed in our design, a potential covert actor has no way to relock a substituted device such that it will only open with the appropriate passcode.

Some manufacturers, such as Apple, already impose a per-device registration protocol (ultimately aggregated based on AppleID) that makes covert phone substitution challenging. In principle, a variant of such a protocol could also inform the user that one of their devices had been opened. However, a straightforward implementation of such a protocol would require associating otherwise anonymous device identifiers (DID values) with well-known identifiers (e.g., IMEI/MEID) and presupposes that all manufacturers have a direct relationship with their customers (while this is true for Apple, it is not true for many other device manufacturers). Instead, an alternative approach would be for the manufacturer to publish the set of \(H(Dauth)\) that have been disclosed, and each device (or a proxy) could periodically check to find out if their secret was among those disclosed. This would require that \(H(Dauth)\) be readable on the device, or at least could be matched, but it should have little effect on the security of the authorization protocol due to the one-way nature of \(H\). An actor able to produce a device with modified code or prevent the manufacturer from communicating their disclosures is in a position to block the transparency property.

#### Manufacturer Costs
A common concern is that the costs of such a scheme may be excessive and place undue burden on manufacturers. There are undoubtedly costs to be borne in this mechanism—both upfront investments and ongoing operational costs.

Perhaps the most significant upfront costs arise from the design and implementation of the lawful access technical capability in each device, as well as the testing and quality assurance around the resulting hardware and software. These are real costs but seem likely modest compared to the extensive and high-value investments being made in improving device security (e.g., much of the complex work in this proposal is already an included and necessary component of the design in Apple’s Secure Enclave). There are also likely upfront costs for secure storage, authentication mechanisms, and investments in operational security, but these again seem likely to be quite small relative to the manufacturer’s existing information technology investments (especially given that much of what is needed here already exists to support existing legal process requests).

More emphasis has been placed on the potential ongoing operational costs (e.g., “the cost and complexity of authenticating a high volume of global law enforcement requests—not just accurately, but fast enough to meet the quick turn-around time needed in urgent investigations or possibly mandated by the applicable key-recovery law—will fall entirely on the vendor” [50]). However, the evidence is unclear if these costs are indeed large compared to the size of these enterprises or if they would dramatically increase the costs currently borne by manufacturers in support of existing criminal process requests.

To explore this question further, consider Apple’s most recent transparency report: there were 4,479 device requests received from U.S. law enforcement agencies in the first half of 2017, as well as requests to access 6,407 accounts (i.e., iCloud)—or, in total, requests to access roughly 20,000 devices or accounts per year [7]. By comparison, in one recent speech, the Director of the FBI claimed that his office had been unable to access the content on 7,775 devices in 2017 (across all manufacturers—Apple is roughly 30–40% of smartphones in the U.S.) [63]. Subsequent reporting has suggested that the true number of such devices is likely only 1,000-2,000 [22]. While there is little doubt that state and local law enforcement agencies would also make similar requests, it is not clear that their level of demand would exceed that of the FBI. We are unaware of good data on this topic (as most transparency reports do not break out requests from federal vs. non-federal sources), but some insight may be gleaned from Twitter, which breaks out Federal, State, and Local requests in their transparency reports. In their July 2017-December 2017 report, Twitter documents 1,761 requests for account information from U.S. sources, of which roughly two-thirds were Federal [8].

Thus, while creating a new criminal process demand on manufacturers would create additional operational burden, we see no evidence that this burden would be qualitatively distinct from their existing criminal process workload. Moreover, we find the claim of high costs needed to meet the “quick turn-around time needed in urgent investigations” unconvincing. In practice, court-ordered production of digital evidence for criminal cases routinely takes several weeks if not longer (e.g., LinkedIn’s guidelines instruct law enforcement to “Please allow at least 3 weeks for processing” [18], Facebook’s guidelines offer “2–6 weeks” for the same [3], and eBay says requests “are processed in approximately 20 business days” [5]). While most heavily-served tech companies offer a mechanism for emergency processing if there are exigent circumstances (e.g., Apple provides the PI:EMAIL contact for precisely this reason), these seem to be a small minority of requests. In Apple’s most recent transparency report, they received 118 such emergency requests in the first half of 2017 from U.S. law enforcement sources, which is a very small fraction of total requests received.

That is not to say that such operational costs are insignificant, nor that it is a foregone conclusion that device manufacturers should bear them. Indeed, current electronic searches under the Electronic Communications Privacy Act (ECPA) already mandate cost recovery to the provider for their efforts, and a similar arrangement for handling authorization key requests would seem entirely reasonable. To summarize, we do not see strong evidence that costs would be so burdensome as to make the approach we have described untenable in practice.

### Conclusions
In this paper, we have described a systems-oriented design for a lawful “device unlock” capability. We believe that this design effectively forecloses its use for mass surveillance purposes and, further, that it offers stronger safeguards and greater transparency than the “lawful hacking”-based approach that forms the core of today’s status quo. However, we have little doubt that the technical shortcomings of our design will be swiftly identified and that there will be further refinements or yet other alternative strategies that will be superior still. Indeed, we write this paper precisely in the hope that there is sufficient additional research activity to obsolete our own work. Most of all, we hope to help dissuade others of the notion that such research “should not be done,” a sentiment that we think is inherently unhealthy for the field. We contend that even the most steadfast opponents of any lawful access capability are well-served by a healthy set of concrete options to push against.

### Acknowledgements
In doing this work, I’ve benefited from considerable constructive feedback from a broad community. Thanks in particular to Herb Lin for encouraging me to work on this problem, David Clark and Danny Weitzner for inviting me to participate in their events, Ernie Brickell and Ray Ozzie who, for different reasons, ended up in similar places and were generous in sharing their ideas and criticisms. In addition, I’ve benefited from the time and creativity of a broad range of researchers who contributed key ideas or provided constructive feedback on drafts of this paper, foremost being Mihir Bellare, Nick Weaver, and Alex Gantman, as well as David Kohlbrenner, Hovav Shacham, Philip Rogaway, Aaron Schulman, Geoff Voelker, Ryan Kastner, and a host of others. Finally, I’d like to thank the anonymous ACM CCS referees, as well as my shepherd from the same conference, for the candor of their feedback and their open-mindedness in appreciating the value of design-oriented papers.

### References
[1] FBI 'Going Dark' FOIA Documents – Release 1, Part 1. https://www.eff.org/document/fbi-going-dark-foia-documents-release-1-part-1.
[2] Declaration of Mark Klein in Support of Plaintiff’s Motion for Preliminary Injunction. https://www.eff.org/files/filenode/att/mark_klein_unredacted_decl-including_exhibits.pdf, June 2006.
[3] Facebook Law Enforcement Guidelines. https://www.eff.org/files/filenode/social_network/facebook2010_sn_leg-doj.pdf, 2010.
[4] Apple Inc's motion to vacate order compelling Apple Inc. to assist agents in search, and opposition to government’s motion to compel assistance. https://epic.org/amicus/crypto/apple/In-re-Apple-Motion-to-Vacate.pdf, Mar. 2016.
[5] eBay Global Asset Protection: Resources for Law Enforcement Investigations and Service Levels. https://ir.ebaystatic.com/pictures/aw/pics/pdf/us/eBayLEGuideSecurityCenter2016.pdf, 2016.
[6] In the matter of the search of an Apple iPhone seized during the execution of a search warrant on a black Lexus IS300, California License Plate 35KGD203. https://www.justice.gov/usao-cdca/file/825001/download, Feb. 2016.
[7] Report on Government and Private Party Requests for Customer Information: January 1—June 30, 2017. https://images.apple.com/legal/privacy/transparency/requests-2017-H1-en.pdf, 2017.
[8] Twitter Transparency Report: United States of America: July to December 2017. https://transparency.twitter.com/en/countries/us.html, 2017.
[9] Bring in the Nerds: EFF Introduces Actual Encryption Experts to the U.S. Senate Staff. https://ssd.eff.org/en/blog/bring-nerds-eff-introduces-actual-encryption-experts-us-senate-staff, May 2018.
[10] Cellebrite Advanced Unlocking Services. https://www.cellebrite.com/en/services/advanced-unlocking-services/, 2018.
[11] CPU frequency: Hall of Fame. https://hwbot.org/benchmark/cpu_frequency/hall_of_fame, May 2018.
[12] Decrypting the Encryption Debate: A Framework for Decision Makers. National Academies Press, Feb. 2018.
[13] Encryption in the U.S.: Crypto Colloquium Outcomes Report. https://www.accessnow.org/cms/assets/uploads/2018/02/Encryption-in-the-United-States-Crypto-Colloquium-Outcomes-Report.pdf, Jan. 2018.
[14] Encryption Policy in Democratic Regimes: Finding Convergent Paths and Balanced Solutions. https://www.eastwest.ngo/sites/default/files/ewi-encryption.pdf, Feb. 2018.
[15] Introducing GreyKey. https://graykey.grayshift.com/, 2018.
[16] iOS Security. https://www.apple.com/business/docs/iOS_Security_Guide.pdf, 2018.