### Response to UEs with an Error Message
To protect against SIP tunneling and denial-of-service (DoS) attacks, operators should respond to User Equipment (UE) with an error message when necessary. Additionally, operators should limit the number of SIP messages from a UE within a specified period. If an adversary exceeds a certain threshold, the operator should block the adversary and inspect their activities.

Furthermore, the SIP server should check if a UE is already engaged in a call with another UE. If so, it should block any additional call initiation messages (e.g., INVITE messages). This policy can help detect and prevent various attacks, such as cellular peer-to-peer (P2P) attacks, because these attacks typically require an adversary to send multiple INVITE messages.

### UE Verification
To prevent call spoofing, SIP servers should verify the source of SIP messages. One possible method is to include a UE's unique identifier, such as the International Mobile Equipment Identity (IMEI), in SIP messages. The SIP server can then cross-check this unique identifier with the phone number. However, unless the unique identifier is securely stored on the mobile device, an adversary can easily intercept this information by remotely installing a malicious application.

Another solution is to bind the phone number with the IP address of the UE. Operators can validate user-initiated SIP messages by checking the UE’s IP header against the parameters (such as IP address, phone number, and device unique identity) in the SIP messages, as this information is already stored on the operator's server. Although IP spoofing is possible, we found that all the operators we tested have an IP spoofing prevention mechanism for the data interface. Even though we have not tested IP spoofing for the VoLTE interface, it is likely that similar mechanisms are in place. Therefore, cross-checking is a strong and easy-to-implement solution.

However, this method cannot prevent caller spoofing if an adversary spoofs the victim’s IMS registration procedure, causing the SIP server to store spoofed parameters. A UE registers itself with a SIP server by exchanging REGISTER messages, and the SIP server stores several parameters that identify the UE. Thus, if an adversary can spoof the registration, they can obtain full permission to use the victim’s phone address.

### Deep Packet Inspection (DPI)
Since RTP tunneling exploits the media-dedicated bearer during a VoLTE call, operators can recognize if a user is utilizing the media channel through traffic monitoring. This monitoring can be achieved by applying a deep packet inspection (DPI) solution in P-GWs or media proxies. However, if an adversary disguises the data to resemble voice traffic, the DPI solution may not be sufficient to prevent the attack.

### Accounting Policy
All the free channels exploited in this paper resulted from time-based accounting. This issue can be resolved by changing the accounting policy for VoLTE services to a byte-usage-based scheme. While this would prevent adversaries from bypassing the accounting, it would be challenging for operators to change the current time-based policy, as it is deeply tied to revenue. Approximately 70% of total revenue for operators still comes from voice and SMS services [12].

### Long-term and Comprehensive Solution
The mismatch in the permission model is a significant problem in current VoLTE-compatible mobile devices. Unlike previous call mechanisms, VoLTE is IP-based, and the current permission model of mobile devices cannot handle it effectively. One way to prevent this is to strictly bind sockets from any application to the data interface, ensuring that SIP packets from an application cannot reach the SIP server. Similarly, operators should block packets from the data interface. However, deploying this solution would be difficult, as it would require updating the firmware of all mobile devices. Additionally, data encryption (e.g., IPsec or TLS for signaling, and sRTP for media data) should be implemented as specified in the 3GPP specifications [4, 5].

Even with strict binding and encryption, an adversary can still utilize tunneling if they have full permission for their phone. Another approach is to process both call signaling and voice data transmission in the Control Plane (CP) as in traditional circuit-switching calls. The CP would only allow legitimate call-related requests and block all other packets using the VoLTE interface from the Application Processor (AP). This would prevent adversaries from sending manipulated packets through the VoLTE interface. Protecting the CP with hardware security modules, such as TrustZone or secure storage [6], may also be necessary to prevent adversaries from intercepting SIP messages in the CP.

### Related Work
#### Accounting Issues in Cellular Networks
Several research groups have studied cellular accounting issues [14, 15, 25–27, 32]. The main attacks related to accounting are accounting bypass and overbilling.

- **Peng et al.** demonstrated DNS port abuse for free-data [25].
- **Go et al.** uncovered an accounting bypass by source IP address spoofing, as the mobile data charging system was based solely on the packet header [26].
- **Go et al.** wrapped their payload in a TCP retransmission packet and utilized ISPs that did not charge a fee to ensure fairness [14, 15].

In addition to accounting bypass, overbilling attacks also occur. For example, Go et al. pointed out that TCP retransmission could be used to impose a data fee on a victim [25]. Unfair billing practices by some operators were highlighted in [27, 32].

While much research has been conducted on accounting bypass and overbilling, our work is fundamentally different in terms of the interface used. Previous works covered accounting issues related to the data interface, whereas our work focuses on the VoLTE interface. Furthermore, previous research assumed that overbilling attacks required the installation of a malicious application on the victim’s phone. In contrast, our call spoofing attack only requires the adversary’s own device.

#### VoIP Tunneling for Censorship Resistance
Much research has been conducted on VoIP tunneling, particularly for avoiding censorship. For example, Skypemorph sends Tor traffic through UDP ports via the Skype video call channel [22], and Freewave converts data into acoustic signal data and loads it into normal VoIP packets to hide the data [19].

Our work also utilizes tunneling and data concealment, but our focus is on accounting bypass and discovering mis-implementation problems. Our goal for tunneling is different from that of previous works, which applied tunneling on the Internet. Our work is the first to apply tunneling in cellular networks.

#### DoS Attacks on Cellular Networks
Various DoS attacks in cellular networks have been investigated. Most research on DoS attacks has focused on the GSM network [11, 16, 23, 28, 30]. For example, Enck et al. suggested that sending SMS to certain phone numbers compiled in a hit-list could massively affect the cellular core network [11]. Traynor et al. demonstrated that degrading the cellular network service was possible with a cellular botnet [30].

In contrast to these attacks on GSM networks, the DoS attack proposed in this paper targets the VoLTE network and can be initiated by a significantly smaller number of mobile devices.

### Future Work and Conclusion
We conducted an analysis of the VoLTE network of five operators in the United States and South Korea. To the best of our knowledge, we are the first to analyze security issues in the VoLTE network. The key contribution of our study is that the transition to VoLTE is not simple and involves the EPC core, OS support at the UE, hardware interface redesign, and cellular accounting policies. This negates the common belief that VoLTE is a simple transition because VoIP is well understood on the Internet. Instead, it shows that the architectural aspects of cellular networks make the problem much more complex.

Although we discovered a few implementation bugs that are easy to fix, the core problem lies in the complex processes involving accounting, access control, session management, and EPC-UE interaction. This is evidenced by the response from ISPs, Android, and US/KR CERTs to our responsible disclosure. It requires greater attention because a systematic security analysis of new architecture is always necessary to make the architecture robust.

In this paper, we considered security issues and possible attacks related to VoLTE call service after legitimate IMS registration. However, an attacker can also utilize a SIP REGISTER message to perform other attacks. If there are vulnerabilities in the registration phase, an attacker can control all access to a victim’s VoLTE service, such as carrying out an imposter attack or even wiretapping. We plan to investigate such scenarios in future work.

In this work, we concentrated on the problems and vulnerabilities discovered in five operators; however, more issues and vulnerabilities may be present in these and other operators. As more operators provide VoLTE services, it is essential to conduct more security analyses on VoLTE networks.

### Acknowledgment
We thank the anonymous reviewers for their helpful feedback. This research was supported by:
1. The MSIP (Ministry of Science, ICT, and Future Planning), Korea, under the ITRC (Information Technology Research Center) support program (IITP-2015-R0992-15-1006) supervised by the IITP (Institute for Information & Communications Technology Promotion).
2. The Next-Generation Information Computing Development Program through the National Research Foundation of Korea (NRF) funded by the MSIP (No. NRF-2013R1A1A1076024).
Yeongjin Jang and Taesoo Kim were partly supported by the NSF DGE-1500084, ONR N000141512162, and DARPA-15-15-TC-FP-006.

### References
[1] 3GPP. ETSI TS 23.203. Policy and charging control architecture, 2012.
[2] 3GPP. ETSI TS 23.221. Architectural requirements, 2011.
[3] 3GPP. ETSI TS 23.228. IP Multimedia Subsystem (IMS) Stage 2, 2011.
[4] 3GPP. ETSI TS 33.203. Access security for IP-based services, 2011.
[5] 3GPP. ETSI TS 33.210. Network Domain Security (NDS); IP network layer security, 2011.
[6] T. Alves and D. Felton. Trustzone: Integrated hardware and software security. ARM white paper, 3(4):18–24, 2004.
[7] J. Arkko, G. Camarillo, A. Niemi, T. Haukka, and V. Torvinen. Security mechanism agreement for the session initiation protocol (SIP), 2003.
[8] J. Beekman and C. Thompson. Breaking Cell Phone Authentication: Vulnerabilities in AKA, IMS, and Android. In WOOT, 2013.
[9] T. Bova and T. Krivoruchka. Reliable UDP protocol. draft-ietf-sigtran-reliable-udp-00.txt, 1999.
[10] G. Delugre. Reverse engineering a Qualcomm baseband. CCC, 2011.
[11] W. Enck, P. Traynor, P. McDaniel, and T. La Porta. Exploiting Open Functionality in SMS-Capable Cellular Networks. In Proceedings of the 12th ACM conference on Computer and communications security, pages 393–404. ACM, 2005.
[12] Ericsson. What is voice over LTE?, January 2013.
[13] Global mobile Suppliers Association and others. Evolution to LTE report, 2015. [Online; accessed 11-May-2015].
[14] Y. Go, E. Jeong, J. Won, Y. Kim, D. F. Kune, and K. Park. Gaining Control of Cellular Traffic Accounting by Spurious TCP Retransmission. In Proceeding of the Network and Distributed System Security Symposium (NDSS), 2014.
[15] Y. Go, D. F. Kune, S. Woo, K. Park, and Y. Kim. Towards Accurate Accounting of Cellular Data for TCP Retransmission. In Proceedings of the 14th Workshop on Mobile Computing Systems and Applications, page 2. ACM, 2013.
[16] N. Golde, K. Redon, and J.-P. Seifert. Let Me Answer That for You: Exploiting Broadcast Information in Cellular Networks. In Proceedings of the 22nd USENIX conference on Security, pages 33–48. USENIX Association, 2013.
[17] GSM Association. Voice and Video calls over LTE. [Online; accessed 14-May-2015].
[18] GSM Association. VoLTE Service Description and Implementation Guidelines, Version 1.1, 2014.
[19] A. Houmansadr, T. J. Riedl, N. Borisov, and A. C. Singer. I want my voice to be heard: IP over Voice-over-IP for Unobservable Censorship Circumvention. In NDSS, 2013.
[20] IDATE. in World LTE market, 2014. [Online; accessed 11-May-2015].
[21] A. Johnston and O. Levin. Session Initiation Protocol (SIP) Call Control-Conferencing for User Agents, 2006.
[22] H. Mohajeri Moghaddam, B. Li, M. Derakhshani, and I. Goldberg. Skypemorph: Protocol Obfuscation for Tor Bridges. In Proceedings of the 2012 ACM conference on Computer and communications security, pages 97–108. ACM, 2012.
[23] C. Mulliner, N. Golde, and J.-P. Seifert. SMS of Death: From Analyzing to Attacking Mobile Phones on a Large Scale. In USENIX Security Symposium, 2011.
[24] F. Özavci. VOIP Wars: Return of the SIP, 2013.
[25] C. Peng, C.-y. Li, G.-H. Tu, S. Lu, and L. Zhang. Mobile Data Charging: New Attacks and Countermeasures. In Proceedings of the 2012 ACM conference on Computer and communications security, pages 195–204. ACM, 2012.
[26] C. Peng, C.-Y. Li, H. Wang, G.-H. Tu, and S. Lu. Real Threats to Your Data Bills: Security Loopholes and Defenses in Mobile Data Charging. In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security, pages 727–738. ACM, 2014.
[27] C. Peng, G.-h. Tu, C.-y. Li, and S. Lu. Can We Pay for What We Get in 3G Data Access? In Proceedings of the 18th annual international conference on Mobile computing and networking, pages 113–124. ACM, 2012.
[28] Z. Qian, Z. Wang, Q. Xu, Z. M. Mao, M. Zhang, and Y.-M. Wang. You Can Run, but You Can’t Hide: Exposing Network Location for Targeted DoS Attacks in Cellular Networks. In NDSS, 2012.
[29] J. Rosenberg, H. Schulzrinne, G. Camarillo, A. Johnston, J. Peterson, R. Sparks, M. Handley, E. Schooler, et al. SIP: session initiation protocol, 2002.
[30] P. Traynor, M. Lin, M. Ongtang, V. Rao, T. Jaeger, P. McDaniel, and T. La Porta. On Cellular Botnets: Measuring the Impact of Malicious Devices on a Cellular Network Core. In Proceedings of the 16th ACM conference on Computer and communications security, pages 223–234. ACM, 2009.
[31] P. Traynor, P. McDaniel, T. La Porta, et al. On Attack Causality in Internet-Connected Cellular Networks. In Proceedings of 16th USENIX Security Symposium on USENIX Security Symposium, pages 1–16. USENIX Association, 2007.
[32] G.-H. Tu, C. Peng, C.-Y. Li, X. Ma, H. Wang, T. Wang, and S. Lu. Accounting for Roaming Users on Mobile Data Access: Issues and Root Causes. In Proceeding of the 11th annual international conference on Mobile systems, applications, and services, pages 305–318. ACM, 2013.
[33] Q. Wang, X. Gong, G. T. Nguyen, A. Houmansadr, and N. Borisov. Censorspoofer: Asymmetric Communication using IP Spoofing for Censorship-Resistant Web Browsing. In Proceedings of the 2012 ACM conference on Computer and communications security, pages 121–132. ACM, 2012.
[34] Z. Wang. IMS Security Framework. 3GPP2 S. S0086-B, Version, 2, 2008.
[35] R. Zhang, X. Wang, R. Farley, X. Yang, and X. Jiang. On the feasibility of launching the man-in-the-middle attacks on VoIP from remote attackers. In Proceedings of the 4th International Symposium on Information, Computer, and Communications Security, pages 61–69. ACM, 2009.
[36] R. Zhang, X. Wang, X. Yang, and X. Jiang. Billing Attacks on SIP-Based VoIP Systems. WOOT, 7:1–8, 2007.