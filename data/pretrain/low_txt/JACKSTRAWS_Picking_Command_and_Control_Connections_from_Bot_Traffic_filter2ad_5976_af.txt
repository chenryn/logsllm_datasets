### 优化后的参考文献列表

1. D. Balzarotti, M. Cova, C. Karlberger, E. Kirda, C. Kruegel, and G. Vigna. "Efficient Detection of Split Personalities in Malware." In *Symposium on Network and Distributed System Security (NDSS)*, 2010.
2. H. Bunke, P. Foggia, C. Guidobaldi, and M. Vento. "Graph Clustering Using the Weighted Minimum Common Supergraph." In *Graph Based Representations in Pattern Recognition*, 2003.
3. M. Christodorescu and S. Jha. "Testing Malware Detectors." In *ACM International Symposium on Software Testing and Analysis (ISSTA)*, 2004.
4. M. Christodorescu, S. Jha, and C. Kruegel. "Mining Specifications of Malicious Behavior." In *Meeting of the European Software Engineering Conference and the SIGSOFT Symposium on Foundations of Software Engineering*, 2007.
5. D. Conte, P. Foggia, and M. Vento. "Challenging Complexity of Maximum Common Subgraph Detection Algorithms: A Performance Analysis of Three Algorithms on a Wide Database of Graphs." *Journal of Graph Algorithms and Applications*, 11(1), 2007.
6. E. Cooke, F. Jahanian, and D. McPherson. "The Zombie Roundup: Understanding, Detecting, and Disrupting Botnets." In *USENIX Workshop on Steps to Reducing Unwanted Traffic on the Internet (SRUTI)*, 2005.
7. D. Dagon, G. Gu, C. Lee, and W. Lee. "A Taxonomy of Botnet Structures." In *Annual Computer Security Applications Conference (ACSAC)*, 2007.
8. A. Dinaburg, P. Royal, M. I. Sharif, and W. Lee. "Ether: Malware Analysis Via Hardware Virtualization Extensions." In *ACM Conference on Computer and Communications Security (CCS)*, 2008.
9. P. Fogla and W. Lee. "Evading Network Anomaly Detection Systems: Formal Reasoning and Practical Techniques." In *ACM Conference on Computer and Communications Security (CCS)*, 2006.
10. P. Fogla, M. I. Sharif, R. Perdisci, O. Kolesnikov, and W. Lee. "Polymorphic Blending Attacks." In *Usenix Security Symposium*, 2006.
11. S. Forrest, S. Hofmeyr, A. Somayaji, and T. A. Longstaff. "A Sense of Self for Unix Processes." In *IEEE Symposium on Security and Privacy*, 1996.
12. M. Fredrikson, S. Jha, M. Christodorescu, R. Sailer, and X. Yan. "Synthesizing Near-Optimal Malware Specifications from Suspicious Behaviors." In *IEEE Symposium on Security and Privacy*, 2010.
13. F. C. Freiling, T. Holz, and G. Wicherski. "Botnet Tracking: Exploring a Root-Cause Methodology to Prevent Distributed Denial-of-Service Attacks." In *European Symposium on Research in Computer Security (ESORICS)*, 2005.
14. J. Goebel and T. Holz. "Rishi: Identify Bot Contaminated Hosts by IRC Nickname Evaluation." In *USENIX Workshop on Hot Topics in Understanding Botnets (HotBots)*, 2007.
15. G. Gu, R. Perdisci, J. Zhang, and W. Lee. "BotMiner: Clustering Analysis of Network Traffic for Protocol- and Structure-Independent Botnet Detection." In *USENIX Security Symposium*, 2008.
16. G. Gu, P. Porras, V. Yegneswaran, M. Fong, and W. Lee. "BotHunter: Detecting Malware Infection Through IDS-Driven Dialog Correlation." In *USENIX Security Symposium*, 2006.
17. G. Gu, J. Zhang, and W. Lee. "BotSniffer: Detecting Botnet Command and Control Channels in Network Traffic." In *Symposium on Network and Distributed System Security (NDSS)*, 2008.
18. T. Holz, M. Steiner, F. Dahl, E. Biersack, and F. C. Freiling. "Measurements and Mitigation of Peer-to-Peer-Based Botnets: A Case Study on Storm Worm." In *Usenix Workshop on Large-Scale Exploits and Emergent Threats (LEET)*, 2008.
19. International Secure Systems Lab. "Anubis: Analyzing Unknown Binaries." http://anubis.iseclab.org, 2011.
20. G. Jacob, E. Filiol, and H. Debar. "Functional Polymorphic Engines: Formalisation, Implementation and Use Cases." *Journal in Computer Virology*, 5(3):247–261, 2009.
21. J. P. John, A. Moshchuk, S. D. Gribble, and A. Krishnamurthy. "Studying Spamming Botnets Using Botlab." In *USENIX Symposium on Networked Systems Design and Implementation (NSDI)*, 2009.
22. A. Kalafut, A. Acharya, and M. Gupta. "A Study of Malware in Peer-to-Peer Networks." In *ACM SIGCOMM Conference on Internet Measurement*, 2006.
23. G. Karypis. "CLUTO - A Clustering Toolkit." Technical Report 02-017, University of Minnesota, 2003.
24. H.-A. Kim and B. Karp. "Autograph: Toward Automated, Distributed Worm Signature Detection." In *USENIX Security Symposium*, 2004.
25. C. Kolbitsch, P. Milani Comparetti, C. Kruegel, E. Kirda, X. Zhou, and X. Wang. "Effective and Efficient Malware Detection at the End Host." In *USENIX Security Symposium*, 2009.
26. C. Kreibich and J. Crowcroft. "Honeycomb: Creating Intrusion Detection Signatures Using Honeypots." *ACM SIGCOMM Computer Communication Review*, 34(1), 2004.
27. W. Lee, S. J. Stolfo, and K. W. Mok. "A Data Mining Framework for Building Intrusion Detection Models." In *IEEE Symposium on Security and Privacy*, 1999.
28. Z. Li, M. Sanghi, Y. Chen, M.-Y. Kao, and B. Chavez. "Hamsa: Fast Signature Generation for Zero-day Polymorphic Worms with Provable Attack Resilience." In *IEEE Symposium on Security and Privacy*, 2006.
29. A. Moser, C. Kruegel, and E. Kirda. "Exploring Multiple Execution Paths for Malware Analysis." In *IEEE Symposium on Security and Privacy*, 2007.
30. J. Newsom, B. Karp, and D. Song. "Polygraph: Automatically Generating Signatures for Polymorphic Worms." In *IEEE Symposium on Security and Privacy*, 2005.
31. S. Peisert, M. Bishop, S. Karin, and K. Marzullo. "Analysis of Computer Intrusions Using Sequences of Function Calls." *IEEE Transactions on Dependable and Secure Computing*, 4(2), 2007.
32. R. Perdisci, D. Dagon, W. Lee, P. Fogla, and M. I. Sharif. "Misleading Worm Signature Generators Using Deliberate Noise Injection." In *IEEE Symposium on Security and Privacy*, 2006.
33. R. Perdisci, W. Lee, and N. Feamster. "Behavioral Clustering of HTTP-based Malware and Signature Generation Using Malicious Network Traces." In *USENIX Symposium on Networked Systems Design and Implementation (NSDI)*, 2010.
34. P. Porras, H. Saïdi, and V. Yegneswaran. "A Foray into Conficker's Logic and Rendezvous Points." In *Usenix Workshop on Large-Scale Exploits and Emergent Threats (LEET)*, 2009.
35. N. Provos, P. Mavrommatis, M. A. Rajab, and F. Monrose. "All Your iFRAMEs Point to Us." In *USENIX Security Symposium*, 2008.
36. M. Rajab, J. Zarfoss, F. Monrose, and A. Terzis. "A Multifaceted Approach to Understanding the Botnet Phenomenon." In *Internet Measurement Conference (IMC)*, 2006.
37. E. J. Schwartz, T. Avgerinos, and D. Brumley. "All You Ever Wanted to Know about Dynamic Taint Analysis and Forward Symbolic Execution (but Might Have Been Afraid to Ask)." In *IEEE Symposium on Security and Privacy*, 2010.
38. S. Singh, C. Estan, G. Varghese, and S. Savage. "Automated Worm Fingerprinting." In *USENIX Symposium on Operating Systems Design and Implementation (OSDI)*, 2004.
39. D. Song, D. Brumley, H. Yin, J. Caballero, I. Jager, M. G. Kang, Z. Liang, J. Newsome, P. Poosankam, and P. Saxena. "BitBlaze: A New Approach to Computer Security via Binary Analysis." In *International Conference on Information Systems Security (ICISS)*, 2008.
40. E. Stinson and J. C. Mitchell. "Characterizing Bots' Remote Control Behavior." In *Conference on Detection of Intrusions and Malware & Vulnerability Assessment (DIMVA)*, 2007.
41. B. Stone-Gross, A. Moser, C. Kruegel, and E. Kirda. "FIRE: Finding Rogue Networks." In *Annual Computer Security Applications Conference (ACSAC)*, 2009.
42. P. Szor. *The Art of Computer Virus Research and Defense*. Addison Wesley, 2005.
43. C. Willems, T. Holz, and F. Freiling. "CWSandbox: Towards Automated Dynamic Binary Analysis." *IEEE Security & Privacy*, 5(2), 2007.
44. P. Wurzinger, L. Bilge, T. Holz, J. Göbel, C. Kruegel, and E. Kirda. "Automatically Generating Models for Botnet Detection." In *European Symposium on Research in Computer Security (ESORICS)*, 2009.
45. X. Yan, H. Cheng, J. Han, and P. S. Yu. "Mining Significant Graph Patterns by Leap Search." In *ACM SIGMOD International Conference on Management of Data*, 2008.
46. X. Yan and J. Han. "gSpan: Graph-Based Substructure Pattern Mining." In *International Conference on Data Mining (ICDM)*, 2002.
47. X. Yan and J. Han. "CloseGraph: Mining Closed Frequent Graph Patterns." In *ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (KDD)*, 2003.
48. T.-F. Yen and M. K. Reiter. "Traffic Aggregation for Malware Detection." In *Conference on Detection of Intrusions and Malware & Vulnerability Assessment (DIMVA)*, 2008.
49. Y. Zhao and G. Karypis. "Evaluation of Hierarchical Clustering Algorithms for Document Datasets." In *ACM Conference on Information and Knowledge Management (CIKM)*, 2002.

### 节点和边的标签与抽象

插入到行为图中的节点和边会附加额外的标签，以捕获更多关于系统调用性质及其节点间依赖关系的信息。以下将详细描述这些标签。

对于边，标签存储通过数据依赖连接的系统调用的输入和输出参数名称。对于节点，标签存储系统调用的名称以及一些可选信息，具体取决于调用类型。如表1所示，附加信息可以包括系统调用操作的资源类型（文件、注册表键等）以及标志（例如文件操作的模式或权限位）。请注意，某些信息仅作为注释存储；这些信息在模板生成和匹配过程中被忽略，但保存供可能需要检查模板的人类分析师使用。

| 操作       | 标签                                       | 注释                |
|------------|------------------------------------------|-------------------|
| 文件       | 位置、类型（见表2）、访问、属性、创建处置 | 文件名             |
| 注册表     | 键名、值名                                 |                   |
| 网络       | 端口、IP地址                               |                   |

**表1：标签和注释的选定信息**

对于处理文件和注册表键的系统调用，一个重要的附加信息是这些文件和键的名称。然而，不建议使用实际字符串来表示这些资源名称。原因是标签在匹配过程中会被考虑，只有当标签匹配时，两个节点才被视为相同。因此，对于表示资源名称的标签，必须进行某种类型的抽象，否则图会变得过于具体。

对于文件，名称字符串被分为三部分：表示文件位置的路径、文件的短名称及其扩展名。表2展示了路径、短名称和扩展名如何映射到几个通用的位置和类型类别，这些类别随后用于文件名标签。类似地，注册表键名称被分为两部分：键的位置和其短名称。位置首先使用标准注册表缩写（HKLM, HKU, HKCU, HKCR）进行规范化。然后将短键名称与通用类型（数字、路径、URL）进行比较。如果名称不符合任何格式，但仍然显示出许多相似的近似变体，则归类为“随机”类型。

这种抽象过程的其他示例可以在下一节的模板示例中看到。

### 模板示例

我们手动检查了C&C模板，以确定它们是否捕捉到了人类分析师认为恶意的行为。现在展示两个由JACKSTRAWS自动生成的示例。

图4显示了一个从使用专有二进制协议与C&C服务器通信的机器人中提取的模板。该行为对应于某种信息泄露：样本查询计算机名并通过网络发送给服务器。我们认为这是一种恶意活动，通常被机器人用来生成受感染机器的唯一标识符。在网络流量本身中，由于样本使用自己的协议，这种活动不容易识别。

另一个例子是图5所示的模板。该模板对应于下载和执行行为，即从网络下载数据、写入磁盘并执行。模板以通用方式描述了这种特定行为。

**图4：描述敏感数据泄露的模板。深色节点构成模板核心，浅色节点是可选的。**

**图5：描述下载和执行功能的模板。在NtCreateFile节点中，文件名ldr.exe仅作为注释提及。注释帮助人类分析师查看模板，但在匹配过程中被忽略。**

```plaintext
systemcall: recv  network: connect port: 443#ip=193.23.126.55#ip=94.75.255.138 arg: ip=buf
systemcall: NtCreateFile Filename: inProgramDirectory\isExecutable DesiredAccess: FileReadAttributes Attributes: AttributeNormal CreateDisposition: FileSupersede#Filename=\??\C:\Program Files\temp\ldr.exe arg: ObjectAttributes=buf
systemcall: NtCreateFile Filename: inProgramDirectory\isExecutable DesiredAccess: FileReadAttributes | FileWriteAttributes Attributes: AttributeNormal CreateDisposition: FileSupersede#Filename=\??\C:\Program Files\temp\ldr.exe arg: ObjectAttributes=buf
network: recv Collapse: isMultiple  arg: Socket=Socket
systemcall: NtAllocateVirtualMemory*: *  arg: ObjectAttributes=RegionSize
systemcall: NtDeviceIoControlFile*: *  arg: InputBuffer=buf
systemcall: NtWriteFile*: *  arg: Buffer=buf arg: Length=buf
systemcall: NtSetInformationFile Collapse: isMultiple  arg: FileInformation=buf
process: start   arg: buf=buf   arg: FileHandle=FileHandle   arg: FileHandle=FileHandle
network: send
systemcall: NtQueryValueKey Valuename: ComputerName  arg: buf=KeyValueInformation
systemcall: NtOpenKey Keyname: hklm\system\currentcontrolset\control\computername\activecomputername#Keyname: HKLM\System\CurrentControlSet\Control\ComputerName\ActiveComputerName arg: KeyHandle=KeyHandle
systemcall: NtOpenKey Keyname: hklm\system\currentcontrolset\control\computername#Keyname: \Registry\Machine\System\CurrentControlSet\Control\ComputerName arg: ObjectAttributes=KeyHandle
network: connect port: *  Socket=Socket
```

**表2：基于位置和类型的文件抽象**

| 位置                     | 文件路径                                     | 类型                    | 扩展名            |
|------------------------|-------------------------------------------|-----------------------|------------------|
| 在Windows目录下         | \Windows\                                 | 可执行文件               | *.exe            |
| 在系统目录下           | \Windows\System*                          | 动态链接库               | *.dll            |
| 在文档目录下           | \Documents and Settings\                  | 配置文件                 | *.ini, *.cfg      |
| 在启动目录下           | \Documents and Settings\*\Startup\        | Web页面                 | *.htm, *.php, *.xml |
| 在临时目录下           | \Documents and Settings\*\Local Settings\Temp\ | 脚本                    | *.js, *.vbs       |
| 在互联网临时文件目录下  | \Documents and Settings\*\Local Settings\Temporary Internet Files\ | Cookie                  | \Cookies\*@*.txt  |
| 在程序文件目录下       | \Program Files\                           | 设备                    | \Device\         |
|                        |                                           | 网络设备                 | \Device\AfdEndPoint|

希望这些优化能使文本更加清晰、连贯和专业。如果有进一步的需求，请告诉我！