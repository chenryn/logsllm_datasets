### ROAlert and Proactive Notification System

ROAlert also notified administrators of "loose ROAs," where a prefix is valid but unprotected, with a 19% success rate. We conclude that a proactive, non-opt-in alert system can help mitigate bad ROAs.

#### Limitations
ROAlert relies on information from Whois databases to contact victims and offenders. However, Whois entries are often outdated, leading to unreachable email addresses (as seen in the measurements above). Consequently, only a small fraction of victims and violators were alerted. Based on our experience with ROAlert and the results, we believe that ROAlert can significantly reduce the number of bad ROAs, thereby increasing trust in RPKI. We hope these results will motivate the Regional Internet Registries (RIRs), which have more reliable contact points for prefix owners, to adopt ROAlert.

#### Selective, ROAlert-Informed Route Origin Validation (ROV)
While ROAlert and similar mechanisms can help eliminate many badly issued ROAs, some bad ROAs may still remain. To address this, we propose that Autonomous Systems (ASes) enforce ROV selectively, i.e., enforce ROV for ROAs that have been "well-behaved" for a predefined period. ROAlert can automate this by identifying new ROAs and marking them as "well-behaved" if they do not conflict with BGP advertisements for a sufficient period.

However, this approach is not without its pitfalls. For instance, if an organization changes its set of IP prefixes advertised in BGP in a manner incompatible with a previously issued ROA, it could still lead to disconnection by those enforcing selective ROV. Using a platform like ROAlert, however, would ensure the organization is quickly notified when its prefix becomes invalid. We argue that selective ROV can mitigate concerns about discarding BGP advertisements due to mistakes in ROAs while protecting issuers of "good" ROAs from prefix and subprefix hijacking.

### Wildcard ROAs
Downward dependencies, discussed in Section VI-B, pose a challenge to RPKI deployment for large organizations, such as Orange in Figure 11. Consider a large IP prefix \( p \) with origin AS number \( a \), owned by organization Foo. Suppose several subprefixes \( p_1, \ldots, p_n \) are contained within \( p \) but belong to other organizations with different origin ASes \( a_1, \ldots, a_n \). If these organizations have not yet issued ROAs for these prefixes, Foo may issue a ROA for \( p \) specifying origin \( a \). This was the approach taken by Orange in Figure 11. However, BGP advertisements for \( p_1, \ldots, p_n \) (belonging to Danone and Ubisoft in our example) would conflict with the ROA for \( p \) and be discarded by ROV-enforcing ASes.

Alternatively, Foo could break \( p \) into subprefixes entirely owned by Foo and issue ROAs for these subprefixes. However, this could significantly increase BGP routing tables. We evaluated this possibility using the Route Views dataset [54] to build the Routing Information Base (RIB) for each of the 44 different sensors (BGP routers located in different and geographically dispersed ASes). We found that, on average, the increase is over 26% of prefixes in the routing tables, or approximately 160K prefixes (with a standard deviation of approximately 2%).

We present a simple alternative solution called wildcard ROA, which allows organizations to issue ROAs and protect their IP prefixes before their descendants issue ROAs for themselves. Wildcard ROAs allow an AS holding a Resource Certificate (RC) covering an address block containing a specific IP prefix \( p_i \) not belonging to that AS to specify that any AS may be the origin of that prefix. Thus, any AS with an RC could issue a ROA for itself without waiting for its descendants to do the same or giving up on BGP aggregation, simply by issuing another ROA using a "wildcard AS number" that includes all subprefixes no longer in its possession. Importantly, wildcard ROAs must be assigned a lower priority than "regular" ROAs for the same prefix, so that if a specific IP prefix is included in both a regular ROA (issued by the legitimate owner) and (possibly many) wildcard ROAs, the regular ROA prevails, thus protecting the legitimate owner from hijacking and eliminating the downward-dependency problem.

### Related Work
There is a long history of attacks against BGP, motivating many studies on analyzing BGP's vulnerabilities and designing defenses. See an overview of security issues in [11], [29], and a study of common misconfigurations in [43]. For an early design suggesting many of the basic ideas underlying both RPKI and BGPsec, see [36].

Several studies, beginning with [13], explore the deployment of path-security mechanisms, mainly BGPsec. Gill et al. [23] studied how to encourage BGPsec adoption by creating appropriate incentives for ISPs. Other studies [26] explored the security guarantees of BGPsec, including under partial deployment [41]. Many other studies, e.g., [50], presented alternative path-security mechanisms easier to deploy. See a survey of BGP security in [25].

RPKI adoption has also been studied. In [37], a provider, SURFnet, studied the false-positive rate it would incur if it performed ROV. Several studies [19], [33], [34] explored the issuing of ROAs and measured the number of prefixes that would be discarded with ROV. A study of ROAs covering content provider prefixes was presented in [57]. These studies, however, did not address the issues we focus on, such as quantifying the adoption of ROV and its benefits under partial deployment, loose ROAs, upward and downward inter-organizational dependencies, and designing an online alert system.

Wahlisch et al. presented preliminary results of a survey of network operators regarding RPKI and DNSsec deployment [56]. Many challenges in deploying and enforcing DNSsec and RPKI are similar; see [40] for a comparison and [30] for a discussion on DNSsec deployment. Other studies [17], [28] investigated the disproportionate power of centralized authorities to unilaterally revoke any IP prefixes under their control.

Network operators sometimes rely on repositories such as IRR/RADB to filter suspicious BGP route-advertisements. Like RPKI, these repositories bind IP prefixes to origin ASes and can be used to realize filtering policies, including additional filtering beyond route-origin validation (see [27]). However, these repositories are not fully reliable/secure and contain numerous errors, as highlighted and measured in [31]. IRR/RADB repositories are typically used, in practice, only to filter incorrect BGP advertisements from customer ASes [21], [44] and thus provide limited security benefits.

### Conclusion
Extensive efforts have been invested for many years to improve the security and reliability of BGP routing, ranging from ad-hoc mechanisms to carefully designed standards such as RPKI and BGPsec. Recent studies show that BGPsec deployment faces significant, possibly insurmountable challenges. In contrast, RPKI deployment, crucial for combating IP prefix and subprefix hijacking and as a prerequisite for defenses against BGP path-manipulations (including BGPsec), is more feasible. Monitoring of RPKI certificates and ROAs indicates progress, though at a slow rate.

Our results showed that RPKI suffers from very low deployment, and even Route Origin Validation (ROV), which uses RPKI to defend against prefix hijacking, is rarely enforced. Since ROV is the first and only use of RPKI so far, its deployment and RPKI's deployment suffer from the classic chicken and egg problem. We investigated the implications of ROV's scarce adoption to global routing security, showing that almost ubiquitous deployment of ROV by the largest ISPs (e.g., top 100) is both necessary and sufficient to protect the Internet from prefix and subprefix hijacking. However, unless many RPKI records are fixed, even global ROV adoption will not protect many networks from devastating traffic hijacking attacks.

We embarked on a systematic study of the root causes for RPKI's slow adoption, including negative incentives for deployment due to loss of traffic as a result of badly issued ROAs and inter-organization dependencies. On the positive side, our results show that many of the issues plaguing RPKI and ROV deployment can be vastly improved via highly focused efforts. Specifically, focusing deployment efforts on large ISPs, modest changes to RPKI, and adoption of a system such as ROAlert by entities such as the RIRs can go a long way towards mitigating obstacles to adoption. We thus advocate concentrating standardization, regulatory, and operational efforts in these directions.

### Acknowledgements
This work was supported by ISF grants 420/12 and 1354/11, Israel Ministry of Science grants 3-9772 and 3-10884, the Israeli Center for Research Excellence in Algorithms, NSF grant 1414119, and an ERC Starting Grant. We thank Steve Bellovin, Randy Bush, Sharon Goldberg, Joel Halpern, Ethan Heilman, Tomas Hlavacek, Hezi Moriel, Hank Nussbacher, Alvaro Retana, and Nickolai Zeldovich for their helpful comments and suggestions. Special thanks to Daniel Davidovitch for helping us create ROAlet's web interface, Matthias Waehlisch and his research group at Freie University Berlin for helping us utilize Miro [48], and Christian Teuschel from RIPE for helping us utilize the RIPEStat database.

### References
[1] "AFRINIC Whois Database," https://www.afrinic.net/services/whois-query, Jul. 2016.
[2] "APNIC Whois Database," https://wq.apnic.net/apnic-bin/whois.pl, Jul. 2016.
[3] "ARIN Whois Database," https://whois.arin.net/ui, Jul. 2016.
[4] "BGPStream by CAIDA," https://bgpstream.caida.org/, Jul. 2016.
[5] "LACNIC Whois Database," http://lacnic.net/cgi-bin/lacnic/whois, Jul. 2016.
[6] "RIPE NCC Whois Database," https://apps.db.ripe.net/search/query.html, Jul. 2016.
[7] Andree Toonk, "BGP Hijack Incident by Syrian Telecommunications Establishment," BGPMon blog, 2015.
[8] R. Bush, "Origin Validation Operation Based on the Resource Public Key Infrastructure (RPKI)," RFC 7115 (Best Current Practice), Internet Engineering Task Force, Jan. 2014. [Online]. Available: http://www.ietf.org/rfc/rfc7115.txt
[9] R. Bush and R. Austein, "The Resource Public Key Infrastructure (RPKI) to Router Protocol," RFC 6810 (Proposed Standard), Internet Engineering Task Force, Jan. 2013. [Online]. Available: http://www.ietf.org/rfc/rfc6810.txt
[10] K. R. B. Butler, T. R. Farley, P. McDaniel, and J. Rexford, "A Survey of BGP Security Issues and Solutions," Proceedings of the IEEE, vol. 98, no. 1, pp. 100–122, 2010.
[11] Center for Applied Internet Data Analysis, "Routeviews Prefix to AS mappings Dataset for IPv4 and IPv6," https://www.caida.org/data/routing/routeviews-prefix2as.xml, May 2016.
[12] H. Chan, D. Dash, A. Perrig, and H. Zhang, "Modeling Adoptability of Secure BGP Protocols," in SIGMETRICS, R. A. Marie, P. B. Key, and E. Smirni, Eds. ACM, 2006, pp. 389–390. [Online]. Available: http://dblp.uni-trier.de/db/conf/sigmetrics/sigmetrics2006.html#ChanDPZ06
[13] "BGP Origin AS Validation," Cisco IOS guide, Cisco, 2013.
[14] A. Cohen, Y. Gilad, A. Herzberg, and M. Schapira, "One Hop for RPKI, One Giant Leap for BGP Security," in HotNets, J. de Oliveira, J. Smith, K. J. Argyraki, and P. Levis, Eds. ACM, 2015, pp. 10:1–10:7. [Online]. Available: http://dl.acm.org/citation.cfm?id=2834050
[15] ——, "Jumpstarting BGP Security with Path-End Validation," in SIGCOMM, M. P. Barcellos, J. Crowcroft, A. Vahdat, and S. Katti, Eds. ACM, 2016, pp. 342–355.
[16] D. Cooper, E. Heilman, K. Brogle, L. Reyzin, and S. Goldberg, "On the Risk of Misbehaving RPKI Authorities," in HotNets. ACM, 2013.