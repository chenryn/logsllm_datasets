### Class of Exponentially Tilted Beta Proposals

**Proposition A.1 (Weight Inequality)**: If \( f \) is monotonically non-decreasing in \( x_i \) for some \( i \in [m] \), then under the order-preserving heuristic, for all \( x \in X = [0, 1]^m \) and \( 0 \leq x_i \leq 1 \), not only \( f(x) \leq f(x^{-i}, x_i') \) but also
\[ w_\theta(x) \leq w_\theta(x^{-i}, x_i'). \]
(14)

**Proposition A.2 (Sample Substitution)**: Suppose \( (x^{-i}, x_i') \subseteq X_\gamma \). For every \( Y \subseteq X_\gamma \), by substituting \( x \) with \( (x^{-i}, x_i') \) in \( Y \), one obtains a more representative subset of \( X_\gamma \).

### Exponential Distributions

A challenge when applying our method to exponential distributions is that the maximum weight can grow to infinity for exponentially-distributed proposals. However, if there is a threshold \( T \) beyond which the value of \( f \) does not change, i.e., \( f(x^{-i}, x_i) = f(x^{-i}, T) \) for all \( x_i \geq T \), then we can replace \( X_i \sim \text{Exponential}(\lambda_i) \) with \( X_i \sim \text{ExpUnif}(\lambda_i; T) \)—where \( X_i \) is exponentially distributed with parameter \( \lambda_i \) on \([0, T]\), uniformly distributed on \((T, T+1]\), and has zero mass everywhere else—without affecting the value of the rare event probability \( \rho \).

Unlike exponential distributions, the ExpUnif distribution does not have a right tail as its support is bounded on \([0, T + 1]\). Furthermore, if ExpUnif\((\lambda_i; T)\) is used as proposal distributions, then the order-preserving heuristic is maintained if \( \theta_i \geq \lambda_i \).

### Proof of Proposition IV.1

Using Bayes' theorem and the law of total probability, Inequality (11) can be rewritten as:
\[ P(X \in X_\gamma | X_i \leq x_i)P(X_i \leq x_i) \geq P(X \in X_\gamma) \]
\[ \Leftrightarrow P(X \in X_\gamma | X_i \leq x_i) \geq P(X \in X_\gamma) \]
\[ \Leftrightarrow P(X \in X_\gamma | X_i \leq x_i) \geq P(X \in X_\gamma | X_i \leq x_i)P(X_i \leq x_i) + P(X \in X_\gamma | X_i > x_i)P(X_i > x_i) \]
\[ \Leftrightarrow P(X \in X_\gamma | X_i \leq x_i) \geq P(X \in X_\gamma | X_i > x_i) \]

The last inequality means that for every \( x_i \), knowing \( X_i \leq x_i \) increases (or at least does not decrease) the probability that \( X \) is in \( X_\gamma \). To prove this result, we show that the following inequality holds for every \( x^{-i} \in X^{-i} \):
\[ P(X \in X_\gamma | X_i \leq x_i, X^{-i} = x^{-i}) \geq P(X \in X_\gamma | X_i > x_i, X^{-i} = x^{-i}) \]

Let \( x_i^* \) be the maximum value such that \( (x^{-i}, x_i^*) \in X_\gamma \). Due to monotonicity, \( x = (x^{-i}, x_i) \in X_\gamma \) if and only if \( x_i \leq x_i^* \). Therefore, it is sufficient to prove that \( P(X_i \leq x_i^* | X_i \leq x_i) \geq P(X_i \leq x_i^* | X_i > x_i) \). This is easily done by considering two separate cases:
- If \( x_i \leq x_i^* \), then \( P(X_i \leq x_i^* | X_i \leq x_i) = 1 \).
- If \( x_i > x_i^* \), then \( P(X_i \leq x_i^* | X_i > x_i) = 0 \).

### Proof of Proposition IV.2

It is sufficient to show that:
\[ \log(w_\theta(x^{-i}, 0)) - \log(w_\theta(x^{-i}, 1)) \leq 0. \]

After simplification, we have:
\[ \log(w_\theta(x^{-i}, 0)) - \log(w_\theta(x^{-i}, 1)) = g(p_i) - g(\theta_i) \]
where \( g(x) = \log(1-x) - \log(x) \). Since \( g(x) \) is a decreasing function in \( x \) for \( x \in (0, 1) \) and \( \theta_i \leq p_i \) according to our parameter selection strategy based on Proposition IV.1, it follows that \( g(p_i) \leq g(\theta_i) \).

### Illustration of Weight Degeneracy

The following example illustrates the effect of weight degeneracy in a low-dimensional setting. Let \( f(X) = X_1^2 + X_2^2 \) where \( X = (X_1, X_2) \), \( X_1 \sim \text{Beta}(8, 4) \), \( X_2 \sim \text{Beta}(9, 5) \), and \( X_1 \) and \( X_2 \) are mutually independent. Let \( \rho = P(f(X) \leq \gamma) \). For \( \gamma = 0.2 \), we obtain \( \rho \approx 1.220 \times 10^{-4} \) via numerical integration. Suppose we want to estimate \( \rho \) using Importance Sampling (IS). Our choice of sampling distribution is the Beta-distributed proposal \( P_\theta \), where \( \theta = (a_1, b_1, a_2, b_2) \), \( X_i \sim \text{Beta}(a_i, b_i) \) for \( i = 1, 2 \), and \( X_1 \) and \( X_2 \) are mutually independent.

Figures 5a and 5b show the performance of the IS estimators using \( \theta^{(0)} = (8, 4, 9, 5) \) (i.e., the original distribution), \( \theta^{(1)} = (8, 44.1, 9, 47.4) \), and \( \theta^{(2)} = (8, 18.8, 9, 19.3) \). Overall, \( P_{\theta^{(2)}} \) strikes the right balance between having a moderate hitting rate and a benign weight degeneracy. As a result, \( P_{\theta^{(2)}} \) achieves a 20x reduction in terms of Relative Error (RE) compared to \( P_{\theta^{(1)}} \), even though \( P_{\theta^{(1)}} \) achieves over 99% hitting rate. In fact, \( \theta^{(2)} \) is the solution to the Maximum Weight Minimization (MWM) method. Compared to \( P_{\theta^{(0)}} \), \( P_{\theta^{(1)}} \), and \( P_{\theta^{(2)}} \), \( P^* \) simultaneously achieves a perfect hitting rate and zero variance. However, it is unlikely that \( P^* \in P_\Theta \) since \( X_i \)'s are jointly distributed under \( P^* \)—i.e., \( P^*(X_i = x_i) \)—even when they are mutually independent under \( P \).

### References

[1] M. Stamatelatos and W. Vesley. Fault tree handbook with aerospace applications. 2002.
[2] P. L’Ecuyer, G. Rubino, S. Saggadi, and B. Tuffin. Approximate zero-variance importance sampling for static network reliability estimation. IEEE Transactions on Reliability, 60(3):590–604, Sep. 2011.
[3] Yi-Kuei Lin, Lance Fiondella, and Ping-Chen Chang. Quantifying the impact of correlated failures on system reliability by a simulation approach. Reliability Engineering & System Safety, 109:32–40, 01 2013.
[4] Hoang Hai Nguyen and David M. Nicol. Estimating loss due to cyber-attack in the presence of uncertainty. In 2020 IEEE 19th International Conference on Trust, Security and Privacy in Computing and Communications (TrustCom), pages 361–369, 2020.
[5] Y. Xu, M. Korkali, L. Mili, X. Chen, and L. Min. Risk assessment of rare events in probabilistic power flow via hybrid multi-surrogate method. IEEE Transactions on Smart Grid, 11(2):1593–1603, 2020.
[6] Matthew O' Kelly, Aman Sinha, Hongseok Namkoong, Russ Tedrake, and John C Duchi. Scalable end-to-end autonomous vehicle testing via rare-event simulation. In S. Bengio, H. Wallach, H. Larochelle, K. Grauman, N. Cesa-Bianchi, and R. Garnett, editors, Advances in Neural Information Processing Systems, volume 31, pages 9827–9838. Curran Associates, Inc., 2018.
[7] Aman Sinha, Matthew O’Kelly, Russ Tedrake, and John C Duchi. Neural bridge sampling for evaluating safety-critical autonomous systems. Advances in Neural Information Processing Systems, 33:6402–6416, 2020.
[8] Marco Beccuti and Giuliana Franceschinis. Efficient simulation of stochastic well-formed nets through symmetry exploitation. In Proceedings of the 2012 Winter Simulation Conference (WSC), pages 1–13. IEEE, 2012.
[9] Kishor S Trivedi and Andrea Bobbio. Reliability and availability engineering: modeling, analysis, and applications. Cambridge University Press, 2017.
[10] G. Rubino and B. Tuffin. Rare Event Simulation using Monte Carlo Methods. 2009 John Wiley & Sons Ltd, United Kingdom, 2009.
[11] M. F. Bugallo, V. Elvira, L. Martino, D. Luengo, J. Miguez, and P. M. Djuric. Adaptive importance sampling: The past, the present, and the future. IEEE Signal Processing Magazine, 34(4):60–79, 2017.
[12] Philip Heidelberger. Fast simulation of rare events in queueing and reliability models. ACM Transactions on Modeling and Computer Simulation (TOMACS), 5(1):43–85, January 1995.
[13] Reuven Y. Rubinstein and Peter W. Glynn. How to deal with the curse of dimensionality of likelihood ratios in monte carlo simulation. Stochastic Models, 25(4):547–568, 2009.
[14] R.Y. Rubinstein, R.Y.R.D.P. Kroese, and D.P. Kroese. The Cross-Entropy Method: A Unified Approach to Combinatorial Optimization, Monte-Carlo Simulation and Machine Learning. Information Science and Statistics. Springer, 2004.
[15] E. T. Jaynes. Probability Theory: The Logic of Science. Cambridge University Press, 2003.
[16] Joshua Chan and Dirk Kroese. Improved cross-entropy method for estimation. Statistics and Computing, 22:1031–1040, 09 2012.
[17] Eugenia Koblents and Joaquin Miguez. A population monte carlo scheme with transformed weights and its application to stochastic kinetic models. Statistics and Computing, 25, 08 2012.
[18] Mansur Arief, Zhiyuan Huang, Guru Koushik Senthil Kumar, Yuanlu Bai, Shengyi He, Wenhao Ding, Henry Lam, and Ding Zhao. Deep probabilistic accelerated evaluation: A robust certifiable rare-event simulation methodology for black-box safety-critical systems. In International Conference on Artificial Intelligence and Statistics, pages 595–603. PMLR, 2021.
[19] Pieter-Tjerk de Boer, Dirk P. Kroese, Shie Mannor, and Reuven Y. Rubinstein. A tutorial on the cross-entropy method. Annals of Operations Research, 134(1):19–67, Feb 2005.
[20] O Cappé, A Guillin, J. M Marin, and C. P Robert. Population monte carlo. Journal of Computational and Graphical Statistics, 13(4):907–929, 2004.
[21] Charles J. Colbourn. The Combinatorics of Network Reliability. Oxford University Press, Inc., USA, 1987.
[22] H. Cancela, L. Murray, and G. Rubino. Efficient estimation of stochastic flow network reliability. IEEE Transactions on Reliability, 68(3):954–970, 2019.
[23] Enno Ruijters, Daniël Reijsbergen, Pieter-Tjerk de Boer, and Mariëlle Stoelinga. Rare event simulation for dynamic fault trees. Reliability Engineering & System Safety, 186:220–231, 2019.
[24] Z. I. Botev, P. L’Ecuyer, and B. Tuffin. Dependent failures in highly reliable static networks. In Proceedings of the 2012 Winter Simulation Conference (WSC), pages 1–12, 2012.
[25] Z. Botev, P. L’Ecuyer, G. Rubino, R. Simard, and B. Tuffin. Static network reliability estimation via generalized splitting. INFORMS Journal on Computing, 25(1), 2012.
[26] Zdravko I. Botev, Pierre L’Ecuyer, and Bruno Tuffin. Reliability estimation for networks with minimal flow demand and random link capacities, 2018.