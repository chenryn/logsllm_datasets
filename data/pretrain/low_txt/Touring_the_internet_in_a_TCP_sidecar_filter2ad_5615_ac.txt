# Resource Management and Testing Strategy
To prevent unexpected, excessive consumption of memory and processor resources, we implemented kernel resource limits. Additionally, we frequently fetched result data to minimize disk usage. Our testing approach for the Web crawler and CoDeeN instrumentation began on a local machine, then expanded to a few PlanetLab nodes, and finally to all available nodes. This phased approach helped mitigate the impact of early implementation errors.

## 5. Results

Our evaluation focuses on three main aspects: feasibility, coverage of network topology using record route, and the correctness of address alignment (alias resolution). We also assessed the intrusiveness of our technique by monitoring the absence of abuse reports. Our experiments traversed 8,817 Autonomous Systems (ASes) and generated 65,189,939 unique traces.

### 5.1 Intrusiveness
We designed Sidecar to discover network topology without generating abuse reports, as often seen with traceroute. In our CoDeeN experiment, we probed 22,428 IP addresses over a week without any incidents. However, our web crawler experiment generated ten abuse reports across 166,761 destinations. These reports cited frequent, unexpected, and synchronized accesses to `robots.txt` files. One report mentioned ICMP "time-exceeded" messages, but only after being alerted from web logs. This suggests that the Sidecar probing technique is unobtrusive, but our custom web crawler needs improvement. No reports were generated by automated intrusion detection systems. We provide more detailed experiences in another paper [25].

### 5.2 Record Route Coverage
The record route option can hold up to nine addresses, limiting its utility for topology discovery beyond nine hops from vantage points. To use record route effectively for broad topology discovery, a measurement platform must have sufficient network diversity to ensure most of the Internet is within nine hops of at least one vantage point. PlanetLab, with its geographic diversity, appears to be such a platform. 

Record route provides additional information or confidence in that information (such as multi-path detection) for nodes and links within nine hops of a vantage point. From our PlanetLab testbed, we found that 87.6–98.5% of end-hosts and routers in the dataset are within nine hops of at least one PlanetLab node (Table 1, second to last row). Of the discovered links, 59.6–69.1% were found or confirmed by record route. Surprisingly, the fraction of addresses and links reachable within nine hops increases with the number of IP addresses. This may be due to the larger measurement set more thoroughly exploring the network near PlanetLab nodes, while the intra-PlanetLab topology reveals several paths too long for record route. A full characterization of addresses outside nine hops remains a subject for future work.

### 5.3 Correct Alias Resolution
Correct alias resolution using record route requires accurate classification of routers in the path. Ambiguities in the rule set (Figure 3) can lead to incorrect classifications, especially in cases of multi-path routing or hidden routers. To avoid incorporating faulty data, we remove any trace that results in a classification contradiction. Due to the linear nature of inference heuristics, one misclassified router can corrupt an entire trace. A more formal inference engine combined with active probing could significantly reduce ambiguous traces.

Alias resolution, as reported in Rocketfuel [27] and confirmed by Teixeira et al. [29], is typically error-prone. We used Rocketfuel’s ally tool [27] to validate Passenger’s asserted aliases (Table 2, "Alias pairs"), but limited our techniques to IP identifier and common source address methods due to their lower error rates [26]. False aliases (Table 2, "Ally: no") were traced to B-to-Hidden-to-A transitions where the Hidden interface address was falsely associated with the Type A router. We are seeking ways to resolve this ambiguity within the trace to further reduce false positives.

Many address pairs cannot be confirmed or disproven because at least one address is unresponsive or unroutable. Ally was able to confirm or deny aliases for 50.6%, 18.4%, and 40.3% of asserted aliases for the PlanetLab, Web crawler, and CoDeeN datasets, respectively. The false positive rate is calculated as the fraction of aliases disproven ("Ally: no") divided by the sum of confirmed and disproven aliases ("Ally: yes" + "Ally: no").

| Dataset       | Alias Pairs | Ally: yes | Ally: no | False Positive Rate |
|---------------|-------------|-----------|----------|---------------------|
| PlanetLab     | 6,789       | 3,389     | 46 (1.3%) | 1.3%                |
| Web Crawler   | 108,870     | 17,972    | 2041 (10.2%) | 10.2%              |
| CoDeeN        | 9,233       | 3,291     | 432 (11.6%) | 11.6%              |

### 5.4 MPLS Results
We used MPLS ICMP extensions to detect MPLS usage. Between PlanetLab hosts, we identified 2,546 distinct routers advertising MPLS ICMP extensions across 38 different ASes. Among CoDeeN hosts, there were 7,730 routers and 112 different ASes. Sidecar was not instrumented with MPLS detection during the web crawler experiment. Further investigation into the potential uses of this information is planned for future work.

## 6. Conclusion and Future Work
The IP record route option has the potential to provide more detailed topology information than previously available through traceroute. The diversity and size of the PlanetLab platform make this primitive practical for topology measurement. We discovered 16% more addresses and IP aliases that prior mapping efforts could not resolve, but also uncovered challenges in inferring aliases between addresses discovered by traceroute and record route.

TTL-limited record route packets can improve the efficiency of methods like Doubletree [8] by reducing the number of probes required for topology collection. Sidecar, a new tool for network measurement, enables unintrusive measurement through existing TCP connections and supports IP options and ICMP extensions, making it potentially useful for developing new measurement techniques.

The code for Sidecar and Passenger, along with the data generated from this experiment, is available at http://www.cs.umd.edu/projects/sidecar.

Future work includes a longitudinal study of network behavior, a more formal treatment of address assignment, investigating how record route exposes anonymous routers, and exploring the impact of record route on other traceroute-like measurements. We also aim to assign ownership to routers with new address information, adapt the frequency of record route probes, and integrate congestion control information to limit probe rates.

## Acknowledgments
We thank Mark Huang and the PlanetLab staff for their help and patience during the initial debugging phases. We also appreciate Vivek Pai and the CoDeeN project for access to their slice, and Fritz McCall and the UMIACS staff for their timely assistance. Finally, we thank our shepherd, Gianluca Iannaccone, and the anonymous reviewers for their valuable comments.

## 7. References
[1] Abilene. http://abilene.internet2.edu.
[2] S. Ailleret. Larbin: Multi-purpose web crawler. http://larbin.sourceforge.net/.
[3] D. Applegate and E. Cohen. Making intra-domain routing robust to changing and uncertain traffic demands: Understanding fundamental tradeoffs. In ACM SIGCOMM, 2003.
[4] H. Balakrishnan, et al. TCP behavior of a busy Internet server: Analysis and improvements. In INFOCOM, 1998.
[5] R. P. Bonica and D.-H. Gan. ICMP extensions for multiprotocol label switching. Internet Draft (work in progress): draft-ietf-mpls-icmp-05, 2006.
[6] R. P. Bonica, et al. Modifying ICMP to support multi-part messages. Internet Draft (work in progress): draft-bonica-internet-icmp-08, 2006.
[7] k. claffy, T. E. Monk, and D. McRobb. Internet tomography. Nature, Web Matters, 1999. http://www.nature.com/nature/webmatters/tomog/tomog.html.
[8] B. Donnet, P. Raoult, T. Friedman, and M. Crovella. Efficient algorithms for large-scale topology discovery. In ACM SIGMETRICS, 2005.
[9] S. Floyd, J. Mahdavi, M. Mathis, and M. Podolsky. An extension to the selective acknowledgement (SACK) option for TCP. IETF RFC-2883, 2000.
[10] R. Fonseca, et al. IP Options are not an option. Tech. Rep. UCB/EECS-2005-24, EECS Department, University of California, Berkeley, 2005.
[11] R. Govindan and H. Tangmunarunkit. Heuristics for Internet map discovery. In INFOCOM, 2000.
[12] M. Gunes and K. Sarac. Analytical IP alias resolution. In IEEE Int’l Conference on Communication, 2006.
[13] N. Hu, O. Spatscheck, J. Wang, and P. Steenkiste. Locating Internet bottlenecks: Algorithms, measurements, and implications. In ACM SIGCOMM, 2004.
[14] V. Jacobson. Pathchar. ftp://ftp.ee.lbl.gov/pathchar/.
[15] V. Jacobson. Traceroute. ftp://ftp.ee.lbl.gov/traceroute.tar.Z.
[16] D. Kaminsky. Paratrace. http://www.doxpara.com/read.php/docs/paratrace.html, 2002.
[17] K. Keys. ifﬁnder. http://www.caida.org/tools/measurement/ifﬁnder/, 2006.
[18] K. Lai and M. Baker. Nettimer: A tool for measuring bottleneck link bandwidth. In USITS, 2001.
[19] A. Lakhina, J. Byers, M. Crovella, and P. Xie. Sampling biases in IP topology measurements. In INFOCOM, 2003.
[20] Z. M. Mao, J. Rexford, J. Wang, and R. Katz. Towards an accurate AS-level traceroute tool. In ACM SIGCOMM, 2003.
[21] A. Medina, M. Allman, and S. Floyd. Measuring the evolution of transport protocols in the Internet. ACM CCR, 2005.
[22] V. N. Padmanabhan, L. Qiu, and H. J. Wang. Passive network tomography using Bayesian inference. In IMW, 2002.
[23] J.-J. Pansiot and D. Grad. On routes and multicast trees in the Internet. ACM CCR, 28(1):41–50, 1998.
[24] L. Peterson, T. Anderson, D. Culler, and T. Roscoe. A blueprint for introducing disruptive technology into the Internet. In HotNets, 2002.
[25] R. Sherwood and N. Spring. A Platform for Unobtrusive Measurements on PlanetLab. In USENIX Workshop on Real, Large Distributed Systems (WORLDS), 2006.
[26] N. Spring, M. Dotcheva, M. Rodrig, and D. Wetherall. How to resolve IP aliases. Tech. Rep. 04–05–04, University of Washington Dept. CSE, 2004.
[27] N. Spring, R. Mahajan, and D. Wetherall. Measuring ISP topologies with Rocketfuel. In ACM SIGCOMM, 2002.
[28] N. Spring, L. Peterson, A. Bavier, and V. Pai. Using PlanetLab for network research: Myths, realities, and best practices. ACM SIGOPS Operating Systems Review, 40(1):17–24, 2006.
[29] R. Teixeira, K. Marzullo, S. Savage, and G. Voelker. In search of path diversity in ISP networks. In IMC, 2003.
[30] L. Wang, et al. Reliability and security in the CoDeeN content distribution network. In USENIX Annual Technical Conference, 2004.
[31] B. Yao, R. Viswanathan, F. Chang, and D. Waddington. Topology inference in the presence of anonymous routers. In INFOCOM, 2003.
[32] Y. Zhang, L. Breslau, V. Paxson, and S. Shenker. On the characteristics and origins of Internet flow rates. In ACM SIGCOMM, 2002.
[33] Y. Zhang, M. Roughan, C. Lund, and D. Donoho. An information-theoretic approach to traffic matrix estimation. In ACM SIGCOMM, 2003.