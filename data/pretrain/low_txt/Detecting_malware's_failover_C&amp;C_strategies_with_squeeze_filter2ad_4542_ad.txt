### Google Safe Browsing (Malware) and Other Blacklists

- **Google Safe Browsing (Malware)**
- **Norton Safe Web**
- **Spamhaus (SBL, XBL, DBL)**
- **ClearCloud DNS**
- **DNS-BH Malware Domain Blocklist**
- **Malware Domain List (MDL)**
- **Malc0de DNS Blackhole**
- **Emerging Threats fwip rules**
- **abuse.ch Malware Database (AMaDa)**

### Total Blacklisted Endpoints

- **Total Blacklisted Domains: 281**
- **Total Blacklisted IPs: 226**

### Strategies A and B

- **Strategy A:**
  - **Domains: 53**
  - **IPs: 58**
- **Strategy B:**
  - **Domains: 95**
  - **IPs: 80**

### New Endpoints Revealed by SQUEEZE

- **Total New Domains: 40**
- **Total New IPs: 36**

### Comparison with Anubis

- **Increase in Blacklisted Endpoints:**
  - **Strategy A: 20.5%**
  - **Strategy B: 26.0%**

### Additional C&C Servers Revealed by SQUEEZE

- **Estimated Percentage of Additional C&C Servers:**
  - **Minimum: 12.6% (Confirmed C&C endpoints for Strategy A)**
  - **Maximum: 32.8% (Endpoints in bot component for Strategy B)**

### Practical Implications

- **Automatically-Generated C&C Blacklists:**
  - **FIRE [20]:** By integrating SQUEEZE with a malware analysis system, we can generate blacklists that significantly improve the coverage of malware C&C servers.

## Qualitative Results

### Palevo/Butterfly Botnet Toolkit

- **Behavior:**
  - **Initial Contact:** Static IP address
  - **Backup Strategies:**
    - **Second Static IP Address**
    - **Domain Generation Algorithm (DGA)**
  - **Effectiveness:** Strategy B was particularly effective in revealing these backup strategies.

### Pakes Malware Family

- **Behavior:**
  - **Primary C&C Blocked:** Falls back to multiple backup C&C endpoints.
  - **Idle Time:** Samples idle for several minutes between attempts.
  - **Implementation:** Uses `GetTickCount` for delayed execution.
  - **Effectiveness:** SQUEEZE skipped delays, revealing up to 20 additional endpoints.

### Koobface Malware Family

- **Behavior:**
  - **C&C Setup:** HTTP-based C&C servers on exploited machines.
  - **Initial Check:** Contacts Google main page.
  - **Hardcoded C&C Servers:** Up to fifty C&C endpoints detected.
  - **Effectiveness:** Increasing the timeout would likely reveal more C&C endpoints.

### Piptea (Harnig) Malware Family

- **Behavior:**
  - **Primary C&C Server:** Queries for encrypted download instructions.
  - **Fallback C&C Server:** If primary is unreachable.
  - **Observation:** Piptea botnet went offline after the Rustock takedown on March 17th, 2011.
  - **Effectiveness:** Samples analyzed on later dates could not reach any C&C server.

### Pay-Per-Install Affiliate Program Downloader

- **Behavior:**
  - **Proprietary Protocol:** Queries C&C server for URLs to download additional executables.
  - **Execution:** Downloads and executes three additional binaries.
  - **Antivirus Detection:** All binaries recognized as malicious but unrelated.
  - **Effectiveness:** SQUEEZE detected the third executable's C&C traffic and attempted to contact an unregistered backup domain.

### Families Without Backup C&C Strategies

- **Virut:**
  - **Behavior:** Spreads by file infection, uses a single IRC C&C server.
  - **Effectiveness:** Limited to spreading if the C&C server is unavailable.

- **Zbot (Zeus):**
  - **Behavior:** Relies on a primary C&C server for bot configuration.
  - **Effectiveness:** No backup strategy observed; remains idle if the primary C&C server is blocked.
  - **Future Work:** Capturing and re-analyzing updated binaries may reveal more C&C servers.

## Deployment

- **Integration with Anubis:**
  - **Strategy B:** Re-analyzed all samples that matched a C&C signature.
  - **Period:** June to August 2011.
  - **Results:**
    - **Anubis: 4355 distinct endpoints in bot component, 2338 with signature match.**
    - **SQUEEZE: Additional 1706 (39%) and 278 (12%) endpoints.**
  - **Statistical Significance:** Single-tailed Wilcoxon signed-rank test rejected the null hypothesis with a probability of error below 0.001%.

- **FIRE Service:**
  - **Benefit:** Improved coverage of FIRE blacklist and ranking of "malicious networks."

## Limitations and Future Work

### Main Limitations

- **P2P Architecture:** Limited utility against fully decentralized P2P botnets.
- **Encrypted C&C Protocols:** Harder to detect at the network level.
- **DGAs:** Limited information on triggered DGAs.
- **Instrumented Environment:** Malware may detect and refuse to run in such environments.

### Future Work

- **Combining Techniques:** Integrate SQUEEZE with other C&C detection methods.
- **DGA Analysis:** Apply slicing and gadget extraction techniques to extract and analyze DGAs.
- **Mitigating Detection:** Develop techniques to reduce malware's ability to detect instrumented environments.

## Related Work

- **Botnet Research:**
  - **Surveys and Studies:** Bailey et al. [41], various studies on measuring and understanding botnets.
  - **Infiltration and Takedown:** Active infiltration and takedown of botnets.
  - **Detection Techniques:** Network-level and host-level detection, crowd-like behavior, and signature-based approaches.
  - **FIRE [20]:** Identifies and tracks malware C&C servers.