以下是优化后的文本，使其更加清晰、连贯和专业：

---

### 引用文献

**Windows NT Symposium, pp. 135-143, July 1999**

Aaron Johnson, “Gatekeeper: Monitoring Auto-Start Extensibility Points (ASEPs) for Spyware Management,” in Proc. Usenix LISA, Nov. 2004. [在线资源](http://research.microsoft.com/sn/detours/)

**[IFS]** IFS Kit - Installable File System Kit, [在线资源](http://www.microsoft.com/whdc/devtools/ifskit/default.mspx).

**[WVD+03]** Yi-Min Wang 等, “STRIDER: A Black-box, State-based Approach to Change and Configuration Management and Support,” Proc. Usenix Large Installation Systems Administration (LISA) Conference, pp. 159-171, October 2003.

**[J01]** K. Jones, “Loadable kernel modules,” *;login: The Magazine of USENIX and SAGE*, [在线资源](http://www.usenix.org/publications/login/2001-11/pdfs/jones2.pdf), November 2001.

**[WVS03]** Yi-Min Wang, Chad Verbowski, 和 Daniel R. Simon, “Persistent-state Checkpoint Comparison for Troubleshooting Configuration Failures,” in Proc. IEEE DSN, June 2003.

**[KJ03]** Rick Kennell 和 Leah H. Jamieson, “Establishing the Genuinity of Remote Computer Systems,” In Proc. USENIX Security Symposium, August 2003.

**[KS94]** G. H. Kim 和 E. H. Spafford, “The Design and Implementation of Tripwire: A File System Integrity Checker,” Proceedings of the 2005 International Conference on Dependable Systems and Networks (DSN’05), 0-7695-2282-3/05 $20.00 © 2005 IEEE. 授权使用限于清华大学。下载时间：2021年3月20日12:09:20 UTC 从 IEEE Xplore。限制适用。

**[XA04]** “Alarm growing over bot software,” (DOS攻击)，CNET News.com, [在线资源](http://news.zdnet.com/2100-1009_22-5202236.html), April 2004.

**[YK04]** Tan Chew Keong, “Win2K Kernel Hidden Process/Module Checker 0.1 (Proof-Of-Concept),” [在线资源](http://www.security.org.sg/code/kproccheck.html), May 23, 2004.

**[XG03]** “Guilty Plea in Kinko's Keystroke Caper,” (窃取网上银行密码), Security Focus, July 18, 2003.

**[XG04]** “Gone Phishing: Web Scam Takes Dangerous Turn,” (窃取网上银行密码), Wall Street Journal, May 27, 2004.

**[XP03]** Kevin Poulsen, “Windows Root Kits a Stealthy Threat,” SecurityFocus, [在线资源](http://www.securityfocus.com/news/2879), March 5, 2003.

**[YN04]** “NTIllusion -- A portable Win32 userland rootkit.txt,” Phrack Magazine, July 13, 2004.

**[YO03]** OpioN, “Kernel Rootkits Explained,” [在线资源](http://www.ebcvg.com/articles.php?id=124), March 2003.

**[YT04]** C. K. Tan, “Defeating Kernel Native API Hookers by Direct Service Dispatch Table Restoration,” [在线资源](http://www.security.org.sg/code/SIG2_DefeatingNativeAPIHookers.pdf), July 2004.

**[XW04]** “White collar virus writers make cash from chaos,” (拨号器、垃圾邮件), The Register, [在线资源](http://www.theregister.co.uk/2004/12/07/sophos_av_review_2004/), December 2004.

**[XZ04]** “Zombie PCs: Silent, Growing Threat,” PC World, [在线资源](http://www.pcworld.com/news/article/0,aid,116841,00.asp), July 2004.

**[ZA]** API Hook SDK 2.12, [在线资源](http://www.devarchive.com/f1709.html).

**[YA03]** A. Chuvakin, “An Overview of Unix Rootkits,” iALERT White Paper, iDefense Labs, [在线资源](http://www.megasecurity.org/papers/Rootkits.pdf), February 2003.

**[YB]** BIOS and Flash Utilities, [在线资源](http://h20000.www2.hp.com/bizsupport/TechSupport/DriverDownload.jsp?pnameOID=100870&locale=en_US&taskId=135&refresh=true&prodTypeId=12454&prodSeriesId=96495&swEnvOID=1093#2663).

**[ZD]** Darkside rootkit, [在线资源](http://www.antiserver.it/backdoor-rootkit/).

**[ZF]** File & Folder Protector, [在线资源](http://www.softheap.com/ffp.html).

**[YB04]** C. Boyd, “Xpire/Splitinfinity.info Server Hack and Malware injection using IFRAMES Vulnerability – Condensed Version,” [在线资源](http://www.spywarewarrior.com/xpire-splitinfinity-serverhack_malwareinstall-condensed.pdf).

**[YC]** The chkrootkit tool, [在线资源](http://www.chkrootkit.org/).

**[YC04]** “Nasty New Parasite,” (隐形间谍软件), Spyware Weekly Newsletter, [在线资源](http://www.spywareinfo.com/newsletter/archives/0604/8.php), June 8, 2004.

**[YC98]** Silvio Cesare, “Runtime kernel kmem patching,” [在线资源](http://vx.netlux.org/lib/vsc07.html), November 1998.

**[YH]** Hidden Registry Keys, [在线资源](http://www.sysinternals.com/ntw2k/info/tips.shtml#registryhidden).

**[YH03]** “How to become unseen on Windows NT,” [在线资源](http://rootkit.host.sk/knowhow/hidingen.txt), May 8, 2003.

**[YI]** Ivo Ivanov, “API hooking revealed,” [在线资源](http://www.codeproject.com/system/hooksys.asp).

**[YJ]** A. R. Jones, “A Review of Loadable Kernel Modules,” [在线资源](http://www.giac.org/practical/gsec/Andrew_Jones_GSEC.pdf).

**[YK]** Tan Chew Keong, “ApiHookCheck Version 1.01,” [在线资源](http://www.security.org.sg/code/apihookcheck.html), April 15, 2004.

**图1. Strider GhostBuster: 结合内核扫描和外核扫描及差异检测**

**Urbin & Mersting**
- **Vanquish**
- **用户模式**
- **内核模式**
- **ProBot SE**
- **驱动程序**
- **Cmd!Dir**
- **Kernel32!FindFirst(Next)File**
- **导入地址表 (IAT)**
- **Kernel32!FindFirst(Next)File**
- **Aphex**
- **NtDll!NtQueryDirectoryFile**
- **Hacker Defender**
- **Nt!NtQueryDirectoryFile**
- **服务分派表条目**
- **Nt!NtQueryDirectoryFile**
- **I/O 管理器**
- **文件系统组件**
- **过滤驱动程序**

**图2. 如何隐藏文件的Ghostware程序**

**Ghostware**
- **Urbin [ZU]**
  - 检测到的隐藏文件: 1 (C:\windows\system32\msvsres.dll)
- **Mersting**
  - 检测到的隐藏文件: 1 (C:\windows\system32\kbddfl.dll)
- **Vanquish [ZV]**
  - 检测到的隐藏文件: 3+ (C:\windows\vanquish.exe, C:\windows\vanquish.dll, C:\vanquish.log, 以及任何其他“*vanquish*”文件)
- **Aphex [ZAF]**
  - 任何与可配置前缀匹配的文件
- **Hacker Defender 1.0 [ZH]**
  - 检测到的隐藏文件: 3+ (hxdef100.exe, hxdefdrv.sys, hxdef100.ini, 以及在hxdef100.ini中指定的任何其他文件)
- **ProBot SE [ZP]**
  - 检测到的隐藏文件: 4 (C:\windows\system32\.exe, C:\windows\system32\.dll, 以及两个C:\windows\system32\drivers\.sys文件)
- **文件隐藏器 [ZHF, ZHO, ZAH, ZF]**
  - 任何用户选择的文件夹和文件

**图3. GhostBuster 隐藏文件检测实验结果**

**Ghostware**
- **Urbin**
  - 检测到的隐藏ASEP挂钩: HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs  msvsres.dll
- **Mersting**
  - 检测到的隐藏ASEP挂钩: HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs  kbddfl.dll
- **Hacker Defender 1.0**
  - 检测到的隐藏ASEP挂钩: 
    - HKLM\SYSTEM\CurrentControlSet\Services\HackerDefender100  hxdef100.exe
    - HKLM\SYSTEM\CurrentControlSet\Services\HackerDefenderDrv100  hxdefdrv.sys
- **Vanquish**
  - 检测到的隐藏ASEP挂钩: HKLM\SYSTEM\CurrentControlSet\Services\Vanquish  vanquish.exe
- **ProBot SE**
  - 检测到的隐藏ASEP挂钩:
    - HKLM\SYSTEM\CurrentControlSet\Services\  System32\drivers\.sys
    - HKLM\SYSTEM\CurrentControlSet\Services\  .sys 键盘驱动程序
    - HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run  .exe
- **Aphex**
  - 检测到的隐藏ASEP挂钩: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run  .exe

**图4. GhostBuster 隐藏ASEP挂钩检测实验结果**

**Aphex**
- **用户模式**
- **内核模式**
- **TaskMgr**
- **NtDll!NtQuerySystemInformation**
- **导入地址表 (IAT)**
- **NtDll!NtQuerySystemInformation**
- **Nt!NtQuerySystemInformation**
- **服务分派表条目**
- **Nt!NtQuerySystemInformation**
- **活动进程列表**
- **Hacker Defender & Berbew**
- **FU 驱动程序**

**图5. 如何隐藏进程的Ghostware程序**

**Ghostware**
- **Aphex**
  - 检测到的隐藏进程/模块: 默认情况下，任何以“~~”开头的进程名称（可配置）
- **Hacker Defender 1.0**
  - 检测到的隐藏进程/模块: hxdef100.exe, 以及在hxdef100.ini中指定的任何其他进程
- **Berbew [ZB]**
  - 检测到的隐藏进程/模块: .exe
- **FU [ZFU]**
  - 检测到的隐藏进程/模块: 任何通过“fu –ph”命令隐藏的进程
- **Vanquish**
  - 检测到的隐藏进程/模块: vanquish.dll (隐藏在许多进程中)

**图6. GhostBuster 隐藏进程/模块检测实验结果**

---

希望这些改进能使文档更加清晰和专业。如果有进一步的需求，请随时告诉我。