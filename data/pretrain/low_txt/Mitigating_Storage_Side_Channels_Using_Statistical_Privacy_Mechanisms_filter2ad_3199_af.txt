### References

1. **Metering with Battery Recharging.** In *Data Privacy Management and Autonomous Spontaneous Security*, 8th International Workshop, volume 8247 of Lecture Notes in Computer Science. 2014.

2. **A. Blum, K. Ligett, and A. Roth.** "A Learning Theory Approach to Non-Interactive Database Privacy." In *40th ACM Symposium on Theory of Computing*, 2008.

3. **N. E. Bordenabe, K. Chatzikokolakis, and C. Palamidessi.** "Optimal Geo-Indistinguishable Mechanisms for Location Privacy." In *ACM Conference on Computer and Communications Security*, 2014.

4. **L. Cai and H. Chen.** "TouchLogger: Inferring Keystrokes on Touch Screen from Smartphone Motion." In *6th USENIX Conference on Hot Topics in Security*, 2011.

5. **L. Cai and H. Chen.** "On the Practicality of Motion-Based Keystroke Inference Attack." In *Trust and Trustworthy Computing, 5th International Conference*, volume 7344 of Lecture Notes in Computer Science. June 2012.

6. **T.-H. H. Chan, E. Shi, and D. Song.** "Private and Continual Release of Statistics." *ACM Transactions on Information and System Security*, 14(3), November 2011.

7. **K. Chatzikokolakis, M. E. Andrés, N. E. Bordenabe, and C. Palamidessi.** "Broadening the Scope of Differential Privacy Using Metrics." In *13th Privacy Enhancing Technologies Symposium*, July 2013.

8. **Q. A. Chen, Z. Qian, and Z. M. Mao.** "Peeking into Your App Without Actually Seeing It: UI State Inference and Novel Android Attacks." In *23rd USENIX Security Symposium*, 2014.

9. **D. Cotroneo, R. Natella, R. Pietrantuono, and S. Russo.** "A Survey of Software Aging and Rejuvenation Studies." *ACM Journal on Emerging Technologies in Computing Systems*, 10(1), January 2014.

10. **C. Csallner, N. Tillmann, and Y. Smaragdakis.** "DySy: Dynamic Symbolic Execution for Invariant Inference." In *30th International Conference on Software Engineering*, 2008.

11. **G. Danezis, M. Kohlweiss, and A. Rial.** "Differentially Private Billing with Rebates." In *13th International Conference on Information Hiding*, 2011.

12. **C. Dwork.** "Differential Privacy." In *Automata, Languages and Programming*, volume 4052 of Lecture Notes in Computer Science, 2006.

13. **C. Dwork.** "Differential Privacy: A Survey of Results." In *Theory and Applications of Models of Computation, 5th International Conference*, volume 4978 of Lecture Notes in Computer Science, April 2008.

14. **C. Dwork.** "Differential Privacy in New Settings." In *21st ACM-SIAM Symposium on Discrete Algorithms*, 2010.

15. **C. Dwork, M. Naor, T. Pitassi, and G. N. Rothblum.** "Differential Privacy Under Continual Observation." In *42nd ACM Symposium on Theory of Computing*, 2010.

16. **M. D. Ernst, J. H. Perkins, P. J. Guo, S. McCamant, C. Pacheco, M. S. Tschantz, and C. Xiao.** "The Daikon System for Dynamic Detection of Likely Invariants." *Science of Computer Programming*, 69, 2007.

17. **B. C. M. Fung, K. Wang, R. Chen, and P. S. Yu.** "Privacy-Preserving Data Publishing: A Survey of Recent Developments." *ACM Computing Surveys*, 42(4), June 2010.

18. **M. Hay, V. Rastogi, G. Miklau, and D. Suciu.** "Boosting the Accuracy of Differentially Private Histograms Through Consistency." *Proceedings of the VLDB Endowment*, 3(1-2), September 2010.

19. **S. Jana and V. Shmatikov.** "Memento: Learning Secrets from Process Footprints." In *2012 IEEE Symposium on Security and Privacy*, May 2012.

20. **K. Nissim, S. Raskhodnikova, and A. Smith.** "Smooth Sensitivity and Sampling in Private Data Analysis." In *39th ACM Symposium on Theory of Computing*, 2007.

21. **I. Roy, S. T. V. Setty, A. Kilzer, V. Shmatikov, and E. Witchel.** "Airavat: Security and Privacy for MapReduce." In *7th USENIX Conference on Networked Systems Design and Implementation*, 2010.

22. **P. Samarati.** "Protecting Respondents’ Identities in Microdata Release." *IEEE Transactions on Knowledge and Data Engineering*, 13(6), November 2001.

23. **L. Simon and R. Anderson.** "PIN Skimmer: Inferring PINs through the Camera and Microphone." In *3rd ACM Workshop on Security and Privacy in Smartphones and Mobile Devices*, 2013.

24. **D. X. Song, D. Wagner, and X. Tian.** "Timing Analysis of Keystrokes and Timing Attacks on SSH." In *USENIX Security Symposium*, 2001.

25. **L. Sweeney.** "k-Anonymity: A Model for Protecting Privacy." *International Journal on Uncertainty, Fuzziness and Knowledge-based Systems*, 10(5), 2002.

26. **K. Kursawe, G. Danezis, and M. Kohlweiss.** "Privacy-Friendly Aggregation for the Smart-Grid." In *11th International Conference on Privacy Enhancing Technologies*, 2011.

27. **N. Li, T. Li, and S. Venkatasubramanian.** "t-Closeness: Privacy Beyond k-Anonymity and ℓ-Diversity." In *23rd International Conference on Data Engineering*, April 2007.

28. **C.-C. Lin, H. Li, X. Zhou, and X. Wang.** "Screenmilker: How to Milk Your Android Screen for Secrets." In *21st ISOC Network and Distributed System Security Symposium*, 2014.

29. **A. Machanavajjhala, J. Gehrke, D. Kifer, and M. Venkitasubramanian.** "ℓ-Diversity: Privacy Beyond k-Anonymity." In *22nd International Conference on Data Engineering*, 2006.

30. **P. Marquardt, A. Verma, H. Carter, and P. Traynor.** "(Sp)iPhone: Decoding Vibrations from Nearby Keyboards Using Mobile Phone Accelerometers." In *18th ACM Conference on Computer and Communications Security*, 2011.

31. **S. McLaughlin, P. McDaniel, and W. Aiello.** "Protecting Consumer Privacy from Electric Load Monitoring." In *18th ACM Conference on Computer and Communications Security*, 2011.

32. **F. D. McSherry.** "Privacy Integrated Queries: An Extensible Platform for Privacy-Preserving Data Analysis." In *ACM SIGMOD International Conference on Management of Data*, 2009.

33. **E. Miluzzo, A. Varshavsky, S. Balakrishnan, and R. R. Choudhury.** "Tapprints: Your Finger Taps Have Fingerprints." In *10th International Conference on Mobile Systems, Applications, and Services*, 2012.

34. **M. Naldi and G. D’Acquisto.** "Differential Privacy for Counting Queries: Can Bayes Estimation Help Uncover the True Value?" *CoRR*, abs/1407.0116, July 2014.

35. **National Computer Security Center.** "A Guide to Understanding Covert Channel Analysis of Trusted Systems," volume NCSC-TG-030 of NSA/NCSC Rainbow Series. November 1993.

36. **D. Varodayan and A. Khisti.** "Smart Meter Privacy Using a Rechargeable Battery: Minimizing the Rate of Information Leakage." In *IEEE International Conference on Acoustics, Speech and Signal Processing*, May 2011.

37. **Z. Xu, K. Bai, and S. Zhu.** "Taplogger: Inferring User Inputs on Smartphone Touchscreens Using On-Board Motion Sensors." In *5th ACM Conference on Security and Privacy in Wireless and Mobile Networks*, 2012.

38. **X. Zhou, S. Demetriou, D. He, M. Naveed, X. Pan, X. Wang, C. A. Gunter, and K. Nahrstedt.** "Identity, Location, Disease and More: Inferring Your Secrets from Android Public Resources." In *20th ACM Conference on Computer and Communications Security*, 2013.

39. **F. Zhu and J. Wei.** "Static Analysis Based Invariant Detection for Commodity Operating Systems." *Computers & Security*, 43, June 2014.

### Appendix

#### A. Proofs

**Proof of Proposition 1.**

\[
P(A''(x, x') \in Z \times Z') = P(A(x) \in Z) \times P(A'(x') \in Z')
\]
\[
\leq \exp(\epsilon \times d(x, x'')) \times P(A(x'') \in Z) \times \exp(\epsilon' \times d(x', x''')) \times P(A'(x''') \in Z')
\]
\[
\times P(A''(x'', x''') \in Z \times Z')
\]
\[
= \exp(\epsilon \times d(x, x'') + \epsilon' \times d(x', x'''))
\]

**Proof of Proposition 2.** For any \(i\) and any \(z \in Z\),

\[
\frac{P(x[i] + r_i = z)}{P(x'[i] + r_i = z)} = \frac{\exp(-\epsilon \times |x[i] - z|)}{\exp(-\epsilon \times |x'[i] - z|)}
\]
\[
= \exp(-\epsilon \times (|x[i] - z| - |x'[i] - z|))
\]
\[
= \exp(\epsilon \times (|x'[i] - z| - |x[i] - z|))
\]
\[
\leq \exp(\epsilon \times |x[i] - x'[i]|)
\]

The result then follows from Proposition 1.

**Proof of Proposition 3.** For any \(x, x' \in Z^n\), the properties \(d^*(x, x) = 0\) and \(d^*(x, x') = d^*(x', x)\) are evident. The triangle property results as follows, for \(x, x', x'' \in Z^n\):

\[
d^*(x, x'') = \sum_{i=1}^n |(x[i] - x[i-1]) - (x''[i] - x''[i-1])|
\]
\[
\leq \sum_{i=1}^n |(x[i] - x[i-1]) - (x'[i] - x'[i-1])| + \sum_{i=1}^n |(x'[i] - x'[i-1]) - (x''[i] - x''[i-1])|
\]
\[
= d^*(x, x') + d^*(x', x'')
\]

**Proof of Proposition 4.** First note that

\[
d^*(x, x') = \sum_{i=1}^n |(x[i] - x[i-1]) - (x'[i] - x'[i-1])|
\]
\[
\leq 2 \times d_{L1}(x, x')
\]
\[
\leq \sum_{i=1}^n |x[i] - x'[i]| + \sum_{i=1}^n |x[i-1] - x'[i-1]|
\]

Therefore, if \(A : X \to Z\) is \((d^*, \epsilon)\)-private, then for any \(x, x' \in X\) and any \(Z \subseteq Z\),

\[
\frac{P(A(x) \in Z)}{P(A(x') \in Z)} \leq \exp(\epsilon \times d^*(x, x'))
\]
\[
\leq \exp(\epsilon \times 2d_{L1}(x, x'))
\]
\[
= \exp(2\epsilon \times d_{L1}(x, x'))
\]

**Proof of Proposition 6.** For any \(i\) such that \(i = D(i) \geq 2\) and any \(z_i\),

\[
\frac{P\left((x[i] - x\left\lfloor \frac{i}{2} \right\rfloor) + r_i = z_i\right)}{P\left((x'[i] - x'\left\lfloor \frac{i}{2} \right\rfloor) + r_i = z_i\right)} \leq \exp\left(\epsilon \times \left| x[i] - x\left\lfloor \frac{i}{2} \right\rfloor - \left( x'[i] - x'\left\lfloor \frac{i}{2} \right\rfloor \right) \right|\right)
\]

So,

\[
\prod_{i: i = D(i) \geq 2} \frac{P\left((x[i] - x\left\lfloor \frac{i}{2} \right\rfloor) + r_i = z_i\right)}{P\left((x'[i] - x'\left\lfloor \frac{i}{2} \right\rfloor) + r_i = z_i\right)} \leq \exp\left(\epsilon \times \sum_{i: i = D(i) \geq 2} \left| x[i] - x[i-1] - (x'[i] - x'[i-1]) \right|\right)
\]

Similarly, for any \(i > D(i)\) and any \(z_i\),

\[
\frac{P\left((x[i] - x[i - D(i)]) + r_i = z_i\right)}{P\left((x'[i] - x'[i - D(i)]) + r_i = z_i\right)} \leq \exp\left(\frac{\epsilon}{k} \times \left| (x[i] - x[i - D(i)]) - (x'[i] - x'[i - D(i)]) \right|\right)
\]

Finally, note that

\[
\frac{P\left((x[1] - x[0]) + r_1 = z_1\right)}{P\left((x'[1] - x'[0]) + r_1 = z_1\right)} \leq \exp\left(\epsilon \times \left| (x[1] - x[0]) - (x'[1] - x'[0]) \right|\right)
\]

So, for any \(x, x' \in X^n\) and any \((z_1, \ldots, z_n)\),

\[
\frac{P(A(x) = (z_1, \ldots, z_n))}{P(A(x') = (z_1, \ldots, z_n))} \leq \exp\left(2\epsilon \times \sum_{i=1}^n \left| (x[i] - x[i-1]) - (x'[i] - x'[i-1]) \right|\right)
\]

where the last step follows by multiplying Eqns. 6, 4, and 5.