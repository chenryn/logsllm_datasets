### 图6：使用过期缓存时，在对顶级域名服务器进行3小时攻击期间，对于两层域名的查询应答率及准确记录

- **过期缓存大小（天）**：
  - 10
  - 7
  - 14
  - 21
  - 30

- **查询应答率**：
  - 1.0
  - 0.998
  - 0.996
  - 0.994
  - 0.992
  - 0.99
  - 0.988
  - 0.986
  - 0.984

- **准确记录率**：
  - 1.0
  - 0.9
  - 0.8
  - 0.7
  - 0.6
  - 0.5
  - 0.4

### 分析
在对顶级域名服务器进行3小时攻击期间，使用不同大小的过期缓存可以回答两层域名查询的比例。随着过期缓存大小的增加，查询应答率逐渐上升，但在超过14天后趋于平缓。一个14天的过期缓存可以回答75%的两层域名查询。这主要是因为客户端通常访问如a.com这样的NS记录，这些记录具有较高的TTL值，因此大多数查询基于解析器缓存进行应答。如果记录不在缓存中，则可能从未被查询过，因此也不会出现在过期缓存中。

### 图7：使用过期缓存时，在对二级域名服务器进行3小时攻击期间，对于三层域名的查询应答率及准确记录

- **过期缓存大小（天）**：
  - 10
  - 7
  - 14
  - 21
  - 30

- **查询应答率**：
  - 1.0
  - 0.998
  - 0.996
  - 0.994
  - 0.992
  - 0.99
  - 0.988
  - 0.986
  - 0.984

- **准确记录率**：
  - 1.0
  - 0.9
  - 0.8
  - 0.7
  - 0.6
  - 0.5
  - 0.4

### 分析
在对二级域名服务器进行3小时攻击期间，使用不同大小的过期缓存可以回答三层域名查询的比例。与图6类似，查询应答率随着过期缓存大小的增加而提高，但增长速度较慢。一个14天的过期缓存可以回答85%的三层域名查询。这是因为客户端访问b.a.com这样的A和NS记录，这些记录的TTL值较低，因此更多查询需要依赖过期缓存。

### 图8：过期缓存内存占用

- **过期缓存大小（天）**：
  - 1
  - 5
  - 10
  - 15
  - 20
  - 25
  - 30

- **记录数**：
  - 3000
  - 2500
  - 2000
  - 1500
  - 1000
  - 500
  - 0

- **内存占用（MB）**：
  - 350
  - 300
  - 250
  - 200
  - 150
  - 100
  - 50
  - 0

### 分析
此图展示了不同大小的过期缓存在内存中的占用情况。随着过期缓存大小的增加，记录数和内存占用也相应增加。这对于系统资源管理非常重要，特别是在大规模部署时。

通过以上分析可以看出，使用过期缓存可以在一定程度上缓解对域名服务器的攻击，提高网络的稳定性和可靠性。