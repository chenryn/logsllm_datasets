### Technologies Linking Sea and Space: Ensuring Security in the Modern Global Economy

Technologies that connect sea and space have been instrumental in shaping the global economy and modern life. Protecting these networks from increasingly sophisticated and capable attackers is crucial to maintaining their benefits.

#### References

1. A. Adelsbach and U. Greveler, "Satellite Communication without Privacy - Attacker’s Paradise," in *Sicherheit*, 2005.
2. M. Balduzzi, A. Pasta, and K. Wilhoit, "A Security Evaluation of AIS Automated Identification System," in *Proceedings of the 30th Annual Computer Security Applications Conference (ACSA '14)*, New Orleans, Louisiana, USA, ACM, 2014, pp. 436–445.
3. J. A. Bhatti and T. E. Humphreys, "Covert Control of Surface Vessels via Counterfeit Civil GPS Signals," Unpublished, 2015.
4. M. Binder, J. Quigley, and H. Tinsley, "Islamic State Chemical Weapons: A Case Contained by its Context?" *Combating Terrorism Center at West Point*, Technical Report, March 2018.
5. S. Brizzolara and R. A. Brizzolara, "Autonomous Sea Surface Vehicles," in *Springer Handbook of Ocean Engineering*, edited by M. R. Dhanak and N. I. Xiros, Cham: Springer International Publishing, 2016, pp. 323–340.
6. C4ADS, "Above Us Only Stars: Exposing GPS Spoofing in Russia and Syria," Technical Report, 2019.
7. CCSDS, "Space Data Link Security Protocol - Summary of Concept and Rationale," Green Book, June 2018.
8. Cjcr-Software, "EBSpro," <http://ebspro.net/>, 2016.
9. M. Cocchiaro, "Vessel Accumulation and Cargo Value Estimation," September 2016.
10. M. Cox, "CMA CGM BENJAMIN FRANKLIN Gets Hollywood Welcome," *Maritime Matters*, December 2015, <http://maritimematters.com/2015/12/cma-cgm-benjamin-franklin-gets-hollywood-welcome/>.
11. crazycat69, "CrazyScan: Satellite/Terrestrial/Cable Scan Software," <https://sourceforge.net/projects/crazyscan/>, 2018.
12. J. DiRenzo, D. A. Goward, and F. S. Roberts, "The Little-Known Challenge of Maritime Cyber Security," in *2015 6th International Conference on Information, Intelligence, Systems and Applications (IISA)*, July 2015, pp. 1–5.
13. L. Duquerroy, S. Josset, O. Alphand, P. Berthou, and T. Gayraud, "SatiPSec: An Optimized Solution for Securing Multicast and Unicast Satellite Transmissions," in *22nd AIAA International Communications Satellite Systems Conference & Exhibit 2004 (ICSSC)*, American Institute of Aeronautics and Astronautics, 2004.
14. Etherr, "Română: Sistem VSAT maritim; English: Maritime VSAT System," January 2011.
15. ETSI, "ETSI 300 421 V1.1.2 Digital Video Broadcasting (DVB); Framing Structure, Channel Coding and Modulation for 11/12 GHz Satellite Services," DVB Blue Book, 1997.
16. ——, "ETSI TS 102 606 V1.1.1 Digital Video Broadcasting (DVB); Generic Stream Encapsulation (GSE); Part 1: Protocol," DVB Blue Book, December 2013.
17. ——, "ETSI EN 302 307 V1.3.1 Digital Video Broadcasting (DVB); Second Generation Framing Structure, Channel Coding and Modulation Systems for Broadcasting, Interactive Services, News Gathering and Other Broadband Satellite Applications," DVB Blue Book, 2014.
18. A. J. H. Fidler, G. Hernandez, M. Lalovic, T. Pell, and I. G. Rose, "Satellite — A New Opportunity for Broadband Applications," *BT Technology Journal*, vol. 20, no. 1, pp. 29–37, January 2002.
19. Fortune, "Global 500," <https://fortune.com/global500/2019/>, 2019.
20. R. Hopcraft and K. M. Martin, "Effective Maritime Cybersecurity Regulation – The Case for a Cyber Code," *Journal of the Indian Ocean Region*, vol. 14, no. 3, pp. 354–366, September 2018.
21. iDirect, "The Maritime VSAT Advantage: A Cost Analysis of VSAT Broadband versus L-band Pay-Per-Use Service," Marketing Materials.
22. ——, "iDirect Evolution," Technical Report, 2018.
23. Intellian, "V240mt," <https://www.intelliantech.com/Satcom/v-series/v240mt>.
24. International Hydrographic Organization, "IHO Transfer Standard for Digital Hydrographic Data," Technical Report, November 2000.
25. ——, "IHO Data Protection Scheme," Technical Report, January 2015.
26. O. Jacq, X. Boudvin, D. Brosset, Y. Kermarrec, and J. Simonin, "Detecting and Hunting Cyberthreats in a Maritime Environment: Specification and Experimentation of a Maritime Cybersecurity Operations Centre," in *2018 2nd Cyber Security in Networking Conference (CSNet)*, October 2018, pp. 1–8.
27. K. D. Jones, K. Tam, and M. Papadaki, "Threats and Impacts in Maritime Cyber Security," 2016.
28. D. Kirkpatrick, "Tankers Attacked in Mideast, Iran Was Involved, U.S. Says," *New York Times*, June 2019, <https://www.nytimes.com/2019/06/13/world/middleeast/oil-tanker-attack-gulf-oman.html>.
29. A. R. Lee and H. P. Wogan, "All at Sea: The Modern Seascape of Cybersecurity Threats of the Maritime Industry," in *OCEANS 2018 MTS/IEEE Charleston*, October 2018, pp. 1–8.
30. MarineTraffic, "AIS Tracking: Global Ship Traffic," <https://www.marinetraffic.com/en/ais/home/centerx:2.5/centery:33.6/zoom:6>.
31. MarineMec, "Fishing Vessel Owners Turn to VSAT," <https://www.marinemec.com/news/view,fishing-vessel-owners-turn-to-vsat-40942.htm>, November 2015.
32. Microsoft, "Microsoft Security Bulletin MS08-020," <https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-020>, April 2008.
33. myshiptracking.com, "My Ship Tracking," <http://www.myshiptracking.com>.
34. Newtec, "Satcom for National Security & Intelligence Gathering," <https://www.newtec.eu/frontend/files/application-note/intelligence-gathering.pdf>, 2015.
35. J. Pavur, D. Moser, V. Lenders, and I. Martinovic, "Secrets in the Sky: On Privacy and Infrastructure Security in DVB-S Satellite Broadband," in *Proceedings of the 12th Conference on Security and Privacy in Wireless and Mobile Networks (WiSec '19)*, Miami, Florida, ACM, 2019, pp. 277–284.
36. A. Roy-Chowdhury, J. S. Baras, M. Hadjitheodosiou, and S. Papademetriou, "Security Issues in Hybrid Networks with a Satellite Component," *IEEE Wireless Communications*, vol. 12, no. 6, pp. 50–61, December 2005.
37. H. C. Rudolph and N. Grundmann, "CipherSuite," <https://ciphersuite.info/>, 2019.
38. R. Santamarta, "SATCOM Terminals: Hacking by Air, Sea, and Land," DEFCON White Paper, 2014.
39. ——, "Last Call for SATCOM Security," Blackhat Whitepaper, August 2018, Technical Report.
40. D. Schmidt, K. Radke, S. Camtepe, E. Foo, and M. Ren, "A Survey and Analysis of the GNSS Spoofing Threat and Countermeasures," *ACM Computing Surveys*, vol. 48, no. 4, pp. 64:1–64:31, May 2016.
41. M. Smith, D. Moser, M. Strohmeier, V. Lenders, and I. Martinovic, "Undermining Privacy in the Aircraft Communications Addressing and Reporting System (ACARS)," *Proceedings on Privacy Enhancing Technologies*, vol. 2018, no. 3, pp. 105–122, June 2018.
42. A. Tabrizi, "What We Know About Gulf of Oman Tanker Attacks," BBC News, June 2019.
43. Tellitec, "TL200 TelliShape V2.6."
44. Tero Marine, "Products - Tero Marine," <https://www.teromarine.com/products/>.
45. United Nations Conference on Trade and Development, *Review of Maritime Transport 2018*, New York and Geneva: UNITED NATIONS, 2018, oCLC: 1083029692.
46. Via Satellite and iDirect, "The Coming Wave of Maritime VSAT Growth," <https://www.satellitetoday.com/long-form-stories/maritime-vsat/>, 2015.
47. M. Wingrove, "Cruise Ship Orders for VSAT Providers," <https://www.passengership.info/news/view,cruise-ship-orders-for-vsat-providers-54065.htm>, September 2018.

### Appendix A: GSExtract Implementation

This appendix details the general approach used by the GSExtract tool to parse corrupted and incomplete raw DVB-S2 streams containing GSE data feeds. Several novel strategies are employed to simplify the data extraction challenge and reduce the complexity of an otherwise highly variable set of protocol standards. While these techniques may have academic value, given the potential for abuse, we have elected not to release GSExtract until the issues identified in this study are addressed by a significant proportion of the maritime VSAT industry. This appendix aims to provide technical insight into the techniques employed, which may be of academic interest, without releasing a fully featured attack tool to the general public. A simplified overview of the entire GSExtract data extraction process can be found in Figure 22 at the end of this section.

#### Step 1: Extracting Baseband Frames (BBFrames)

The first step in parsing raw transponder streams is to extract individual baseband frames (BBFrames). BBFrames are the lowest-level logical encapsulation layer inside a demodulated DVB-S2 stream. Each BBFrame begins with a 10-byte BBHEADER as defined by ETSI EN 302 307 and summarized in Figure 20 [17]. The most important portion of this header for our purposes is the two-byte Data Field Length (DFL) value, which indicates the overall size of the data field following the BBHEADER and the location in the stream where the next BBFrame begins. Additionally, the final byte of the BBHEADER contains a CRC-8 (using the polynomial represented by 0xD5) to protect the BBHEADER from corruption.

In theory, the first two bytes of the BBHEADER, collectively referred to as the MATYPE, may change arbitrarily in an Adaptive Coding and Modulation (ACM) feed. However, in practice, we observed that such changes occurred rarely, and the second byte of the MATYPE header in marine VSAT implementations was almost always 0x00. This observation served as a 'crib' that significantly simplified GSExtract's identification of corrupted and invalid BBFrames.

**Figure 20: The structure of a DVB-S2 BBFrame Header**

To extract BBFrames, GSExtract first attempts to identify a valid 2-byte MATYPE in the recorded raw DVB-S2 stream. This value can be identified through statistical analysis of a portion of the DVB-S2 recording, where it will appear as one of the most frequently recurring 2-byte sequences. To validate this identification, the CRC-8 value in byte 10 of the BBHEADER can be used to confirm whether a 9-byte sequence beginning with the MATYPE is a plausible BBHEADER.

Once the correct MATYPE has been found, it is possible to parse the stream into complete BBFrames using the DFL BBHEADER value. Generally, the next BBFrame will begin immediately after the end of the previous BBFrame's data field. However, in the case of signal processing errors, the data field may be truncated. To resolve issues with lower-end equipment, we validate each subsequent BBFrame header by checking its MATYPE against the known good value. While this decreases compatibility with some complex implementations that may use multiple MATYPEs in a single stream, for the maritime VSAT operators we observed, these protocol features did not appear to be in use.

This approach to error recovery ensures that no more than 2 BBFrames worth of data are lost as the result of a single signal processing failure. In most cases, only a fraction of a single corrupted frame is discarded before GSExtract recovers its synchronization with the DVB-S2 stream.

#### Step 2: Parsing BBFrames

Next, we extract bytes up to the length indicated by the DFL BBHEADER value, less four bytes at the end of the BBFrame. While these four trailing bytes are not mentioned in the relevant DVB-S2 specifications, both service operators analyzed appeared to reserve these four bytes for a CRC-32 checksum calculated across the entire BBFrame.

#### Step 3: Parsing GSE Packets

The contents of an extracted BBFrame are further parsed into GSE packets. GSE packets follow a format specified in ETSI TS 102 606 and outlined in Figure 21 [16]. Each GSE packet has a variable-length header of at least 2-bytes, which includes a 12-bit integer indicating the overall length of the GSE packet. Unlike indicated in the GSE standard, we found that for both maritime VSAT operators, this value was the length of the entire GSE packet rather than the number of bytes that followed the mandatory 2-byte header.

An arbitrary number of additional optional headers exist depending on the type of GSE packet encoded. Of particular importance are the headers related to GSE fragmentation. When a payload exceeds the maximum size of an individual GSE packet, it may be fragmented across several. This fragmentation process uses a 1-byte identifier to label related fragments, and the entirety of any given fragmented payload must be completed within 255 BBFrames. GSExtract attempts to deal with fragmentation by combining related fragments as they are identified. If all fragments are not successfully identified within a range of 255 BBFrames (e.g., due to signal corruption), GSExtract will attempt to recover partially completed GSE packets by padding the remaining bytes of the GSE payloads with null values (0x00).

Individual GSE packets cannot traverse multiple BBFrames. Thus, if the final GSE packet inside a BBFrame appears truncated, this can be taken as an indication of signal processing error, and the broken GSE packet will be discarded by GSExtract.

**Figure 21: An overview of the GSE header format. Only the first two bytes are required, but the header can be of arbitrary length depending on the addition of optional extensions.**

#### Step 4: Parsing IP Packets

Finally, within the payloads of either complete GSE packets or re-assembled fragmented payloads, GSExtract will attempt to parse the payloads as if they contain raw IPv4 and IPv6 packets. At present, GSExtract is focused on IP-based protocols. However, the process for parsing non-IP traffic should be largely the same as that currently employed by the utility. Once an IP packet is successfully parsed from the raw payloads, it is converted into a .pcap compatible format and stored for analysis.

Given the high frequency of signal processing errors caused by the use of low-end equipment, many of the IP payloads identified by GSExtract will appear abruptly truncated due to missing data. In these cases, the remainder of the IP packet length is optionally padded with null bytes (0x00) to ensure compatibility with packet analysis tools like Wireshark.

**Figure 22: A notional overview of the stream interpretation and recovery approach used by GSExtract**