### 数据库选型关键指标

#### 指标对比
- **SQL兼容性**
- **应用场景**
- **功能**
- **社区状态与活跃度**
- **性能**
- **稳定性**（均经过长期验证）
- **可靠性**
- **代码成熟度**
- **平台兼容性**
- **服务端编程语言**
- **内核扩展能力**
- **Scale Up 能力**
- **Scale Out 能力**
- **生态**
- **未来发展潜力**
- **应用案例**
- **学习成本**
- **开发成本**
- **开源许可**

#### 兼容性
- **SQL**
  - **PostgreSQL 9.5**：支持 SQL:2011 子集。
    - [文档](http://www.postgresql.org/docs/9.5/static/features-sql-standard.html)
  - **MySQL 5.7**：支持 SQL:1999 子集。

#### 功能差异
- **高级SQL功能**
  - **递归查询, connect by, 树形查询**
    - PostgreSQL 支持 (通过 `WITH` 或 `tablefunc` 实现)。
    - MySQL 不支持。
    - [示例](https://yq.aliyun.com/articles/240)
    - [文档](http://www.postgresql.org/docs/9.5/static/tablefunc.html)
  - **窗口查询, window over**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://blog.163.com/digoal@126/blog/static/16387704020137154137930)
    - [文档](http://www.postgresql.org/docs/9.5/static/functions-window.html)
  - **rollup, grouping sets, cube**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/queries-table-expressions.html#QUERIES-GROUPING-SETS)
    - [示例](http://blog.163.com/digoal@126/blog/static/16387704020154269591874/)
  - **高级聚合函数 (如 JSON, 数组, 相关性, 方差等)**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/functions-aggregate.html)
    - [示例](http://blog.163.com/digoal@126/blog/static/1638770402015224124337/)

- **连接类型**
  - **Hash Join**
    - PostgreSQL 支持。
    - MySQL 不支持。
  - **Merge Join**
    - PostgreSQL 支持。
    - MySQL 不支持。
  - **Nestloop Join**
    - PostgreSQL 和 MySQL 都支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/xoper-optimization.html)
    - [示例](http://www.postgresql.org/docs/9.5/static/planner-optimizer.html)
  - **哈希聚合**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/runtime-config-query.html#RUNTIME-CONFIG-QUERY-ENABLE)

- **事务管理**
  - **事务间共享事务快照**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/functions-admin.html#FUNCTIONS-SNAPSHOT-SYNCHRONIZATION)
    - [示例](http://www.postgresql.org/docs/9.5/static/sql-set-transaction.html)
    - [示例](http://www.postgresql.org/docs/9.5/static/app-pgdump.html)

- **约束**
  - **Foreign Key**
    - PostgreSQL 支持。
    - MySQL 仅 InnoDB 引擎支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/ddl-constraints.html)
  - **粒度锁 (for no key update, for key share)**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/explicit-locking.html#LOCKING-ROWS)
  - **Check 约束**
    - PostgreSQL 支持。
    - MySQL 仅支持语法，实际不生效。
    - [示例](http://www.postgresql.org/docs/9.5/static/ddl-constraints.html)
  - **Exclusion 约束**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/ddl-constraints.html)

- **易用性**
  - **表空间**
    - PostgreSQL 和 MySQL 都支持。
  - **Alter 列值转表达式**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/sql-altertable.html)
    - [示例](https://yq.aliyun.com/articles/30470)
  - **Alter Table 重组表操作**
    - **MySQL (InnoDB)**
      - `OPTIMIZE TABLE`, 添加列，删除列, 重排, 修改 `row_format`, `key_block_size`, 标记列 `NULL` 或 `NOT NULL`, 修改字段长度, 修改字段数据类型, 添加主键, 删除主键, 转换字符集, 指定字符集, 重建表。
      - [文档](http://dev.mysql.com/doc/refman/5.7/en/innodb-create-index-overview.html)
    - **PostgreSQL**
      - `VACUUM FULL`, `CLUSTER`, 修改字段数据类型 (修改长度不需要重组表)。
      - [文档](http://www.postgresql.org/docs/9.5/static/sql-altertable.html)
  - **分区表**
    - PostgreSQL 通过继承支持分区表, 阿里 RDS PostgreSQL 支持分区表语法。
    - MySQL 也支持分区表。
    - [示例](http://www.postgresql.org/docs/9.5/static/ddl-partitioning.html)
    - [示例](https://yq.aliyun.com/articles/113)
  - **物化视图**
    - PostgreSQL 支持。
    - MySQL 暂不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/sql-creatematerializedview.html)
  - **物化视图增量刷新**
    - PostgreSQL 支持。
    - MySQL 暂不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/sql-refreshmaterializedview.html)
  - **表继承关系**
    - PostgreSQL 支持。
    - MySQL 暂不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/tutorial-inheritance.html)
  - **使用 LIKE 创建结构类似的表**
    - PostgreSQL 支持。
    - MySQL 暂不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/sql-createtable.html)

- **开发功能**
  - **客户端开发语言支持**
    - C, Java, Python, ...
  - **函数**
    - **PostgreSQL**：支持 `void`, 单行，SRF，事件触发器，触发器。
    - **MySQL**：不支持事件触发器。
    - [示例](http://blog.163.com/digoal@126/blog/static/16387704020132131361949/)
    - [示例](http://www.postgresql.org/docs/9.5/static/event-triggers.html)
  - **两阶段提交 (2PC)**
    - PostgreSQL 支持。
    - MySQL 仅 InnoDB 支持。
  - **服务端绑定变量**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/sql-prepare.html)
  - **保存点 (Savepoint)**
    - PostgreSQL 支持。
    - MySQL 仅 InnoDB 支持。
  - **异步消息**
    - PostgreSQL 支持。
    - MySQL 不支持。
    - [示例](http://www.postgresql.org/docs/9.5/static/sql-notify.html)
    - [示例](http://www.postgresql.org/docs/9.5/static/sql-listen.html)
  - **游标**
    - PostgreSQL 和 MySQL 都支持。
    - PostgreSQL 支持数组 FOR 循环，query FOR 循环，游标 FOR 循环。
    - [示例](http://www.postgresql.org/docs/9.5/static/plpgsql-control-structures.html)
    - [示例](http://www.postgresql.org/docs/9.5/static/plpgsql-cursors.html)
    - MySQL 不支持数组。

- **类型支持**
  - **PostgreSQL**
    - 支持高精度 numeric, 浮点, 自增序列, 货币, 字节流, 时间, 日期, 时间戳, 布尔, 枚举, 平面几何, 立体几何, 多维几何, 地球, PostGIS, 网络, 比特流, 全文检索, UUID, XML, JSON, 数组, 复合类型, 域类型, 范围, 树类型, 化学类型, 基因序列, FDW, 大对象, 图像。
  - **MySQL**
    - 支持数字, 时间, 字符串, 简单的 GIS, JSON。

- **索引支持**
  - **索引方法**
    - **PostgreSQL**：支持 B-tree, hash, GiST, SP-GiST, GIN, BRIN, Bloom, RUM 索引。
    - **MySQL**：支持 B-tree, GIS 类型索引。
  - **规则表达式、前后模糊查询**
    - PostgreSQL 支持索引检索。
    - MySQL 不支持。
  - **数组支持索引**
    - PostgreSQL 支持。
    - MySQL 不支持数组。
  - **全文检索支持索引**
    - PostgreSQL 和 MySQL 都支持。
  - **索引扩展功能**
    - **PostgreSQL**：支持表达式索引, 部分索引, 联合索引。
    - **MySQL**：支持联合索引。
  - **图像相似度、文本相似度搜索**
    - PostgreSQL 支持索引加速。
    - MySQL 不支持。
  - **自定义索引方法**
    - PostgreSQL 支持。
    - MySQL 不支持。

- **并发能力**
  - **隔离级别**
    - **PostgreSQL**：支持 RC, RR, 以及高于 SQL 92 标准的串行隔离级别。
    - **MySQL**：支持 RU, RC, RR, 以及 SQL 92 标准的串行隔离级别。
  - **从库支持 RR 隔离级别查询**
    - PostgreSQL 和 MySQL 都支持。
  - **锁粒度**
    - **PostgreSQL**：支持行锁, 对象锁, 页锁, 预锁, 应用锁, 自旋锁, 共享锁, 排它锁。
    - **MySQL**：不支持应用锁, 预锁。
  - **死锁检测**
    - PostgreSQL 和 MySQL 都支持。