### 4.1. The Vulnerability Timeline

Figure 1 illustrates the timeline of events in the lifecycle of a typical vulnerability, as described by Schneier [16], and further examined by McHugh [10] and Frei et al. [6]. This timeline includes several key points that correspond to different states of awareness and varying levels of risk perception for an organization.

**Key Points in the Timeline:**
- **Discovery (T1):** Only the individuals who discovered the vulnerability are aware of it. The risk of exploitation is present but minimal or more targeted. A typical organization would be unaware of the threat at this stage.
- **Disclosure (T2):** The vulnerability becomes widely known, often through publication by CERT or other security vendors. This leads to an increased risk as hackers analyze the vulnerability and may develop exploit code.
- **Exploit Availability (T3):** Public exploit code becomes available, significantly increasing the risk.
- **Patch Availability (T4):** The software vendor releases a patch to protect against the vulnerability.
- **Patch Deployment (T6):** The patch is adequately deployed across the organization's production environment.

**Window of Exposure:**
The "window of exposure" is the period from the time the vulnerability is disclosed (T1) until the patch is adequately deployed (T6). During this time, the organization is at risk of exploitation. Some organizations may use early mitigations such as intrusion prevention signatures, which can reduce the window of exposure (T3-T1).

### 4.2. Rate Parameters of External Events

The analysis of the vulnerability timeline highlights the external events that influence an organization's decisions on when to deploy security mitigations. These events include the availability of exploits and the release of patches. The timing and dynamics of these events significantly impact the exposure risk.

**Stochastic Event Descriptions:**
- **Exploit Availability (T2-T1):** Exploits appear at a constant rate of 5 days after disclosure. We use an exponential distribution with the probability density function:
  \[
  f_{\text{exploit\_delay}}(t_{\text{exploit}}) = 5e^{-5t_{\text{exploit}}}
  \]
- **Patch Availability (T4-T1):** Patches are released at a constant rate of 23 days after disclosure. We use an exponential distribution with λ=23:
  \[
  f_{\text{patch\_delay}}(t_{\text{patch}}) = 23e^{-23t_{\text{patch}}}
  \]
- **Malware Arrival (T5-T1):** We use an exponential distribution with rates λ=10 and λ=25:
  \[
  f_{\text{malware\_delay}}(t_{\text{malware}}) = 25e^{-25t_{\text{malware}}}
  \]

**Assumptions:**
- 72% of vulnerabilities have exploits.
- 3% of vulnerabilities have no patches released.

### 4.3. Internal Processes for Threat Mitigation

Organizations follow guidelines and best practices for patch management, but the specific details vary based on internal requirements. Figure 2 shows the activity-based diagram of a typical vulnerability assessment and patch management process.

**Threat Assessment Process:**
- **Triggered by Disclosure:** The process is triggered by the public disclosure of the vulnerability.
- **Decision Points:**
  - **Criticality and Likelihood:** The criticality and likelihood of the vulnerability are determined.
  - **Applicability:** The security team determines if the vulnerable software is used in the IT environment.
  - **Prior Mitigations:** Existing mitigations, such as previous patches or signature-based solutions, are identified.
  - **Public Exploits:** Reports of public exploits, especially those with a large attack surface, trigger quicker patch deployment.
  - **Emergency Patching:** In rare cases, emergency patching may be decided based on the criticality of the vulnerability alone.

**Patch Deployment Policies:**
- **Standard Patching:** Most vulnerabilities (93%) are handled with standard patching.
- **Accelerated Patching:** 10% of vulnerabilities go through accelerated patching.
- **Emergency Patching:** 40% of vulnerabilities require emergency patching.
- **Workarounds:** 5% of vulnerabilities require workarounds.
- **Signature-Based Mitigations:** 45% of vulnerabilities can be covered with signature-based mitigations.

### 4.4. Internal Parameters for Simulations

For our simulations, we model the activity diagram as six separate processes: vulnerability assessment, threat assessment, mitigation assessment, patch preparation, patch deployment, and workaround deployment.

**Simulation Parameters:**
- **Vulnerability Assessment Delay:** Characterized by a delay of 0.5 to 1.5 days:
  \[
  f_{\text{v\_assessment\_delay}}(t_{\text{assess}}) = U(0.5, 1.5)
  \]
- **Threat Assessment Delay:** Triggered by exploit availability, resulting in a one-day delay.

**Decisions Based on Threat Assessment:**
- **Standard Patching:** 93% of vulnerabilities.
- **Threat Assessment Needed:** 7% of vulnerabilities, leading to:
  - **Accelerated Patching:** 10%
  - **Emergency Patching:** 40%
  - **Workarounds:** 5%
  - **Signature-Based Mitigations:** 45%

By simulating these processes, we aim to estimate the duration of the exposure window for a large set of vulnerabilities in an organization with approximately 100,000 systems requiring patching.