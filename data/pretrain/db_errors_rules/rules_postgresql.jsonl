{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "3889", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "3897", "rule_expression": "[metric,2300147]<[num,3] || [metric,2300149]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "11252", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "11172", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "3877", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "8624", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "11186", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "11253", "rule_expression": "[metric,2820147,cluster][oper,neq][str,Streaming] || [metric,2820149,cluster]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "11191", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "11187", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "11256", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "8626", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "14177", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "8627", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "11193", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "8630", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "8869", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "8631", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "8625", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "3878", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "5863", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "11247", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "11181", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "8193", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "11180", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "8192", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "8799", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "3891", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "3883", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "6947", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "11195", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "11197", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "11233", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "3876", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "死元组达到清理要求未清理的分析", "knowledge_description": "死元组达到清理要求未清理的分析"}], "description": "存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题", "rule_name": "dead_tuple_not_cleanup_on", "id": "8204", "rule_expression": "[metric max,2300160]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 未及时清理死行的对象数量 >存在异常，说明存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题.（{[metric max ,2300160]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "8628", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "pg数据库未知连接错误：{[metric,1000000]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "3886", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "3890", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "14221", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "3731", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "8868", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "3884", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "14226", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "11169", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "6948", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "14237", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "3896", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "14240", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}, {"knowledge_description": "PostgreSQL表分析-按缓存读排序"}], "description": "每秒逻辑读异常增加，说明应用或者数据库出现了异常", "rule_name": "more_logic_read_pg", "id": "3732", "rule_expression": "(([metric,2300113]>[num,$1]) || ([metric in time,10,1000105,2300113][oper,eq][str,3])) && ([metric,2300113]>[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒逻辑读 >异常增加，说明存在大量不优化的SQL，可能会引起数据库性能下降。当前每秒逻辑读{[metric,2300113]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "3900", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "5862", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "3733", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "14155", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "11171", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "11188", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "14176", "rule_expression": "[metric,2300147]<[num,3] || [metric,2300149]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "3898", "rule_expression": "[metric,2820147,cluster][oper,neq][str,Streaming] || [metric,2820149,cluster]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "12696", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "12694", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "12697", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "11242", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "14154", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "死元组达到清理要求未清理的分析", "knowledge_description": "死元组达到清理要求未清理的分析"}], "description": "存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题", "rule_name": "dead_tuple_not_cleanup_on", "id": "14156", "rule_expression": "[metric max,2300160]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 未及时清理死行的对象数量 >存在异常，说明存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题.（{[metric max ,2300160]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "11249", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "11248", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "14158", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "14160", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "8629", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "pg数据库未知连接错误：{[metric,1000000]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "14162", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "14163", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "14164", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "14165", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}, {"knowledge_description": "PostgreSQL表分析-按缓存读排序"}], "description": "每秒逻辑读异常增加，说明应用或者数据库出现了异常", "rule_name": "more_logic_read_pg", "id": "14166", "rule_expression": "(([metric,2300113]>[num,$1]) || ([metric in time,10,1000105,2300113][oper,eq][str,3])) && ([metric,2300113]>[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒逻辑读 >异常增加，说明存在大量不优化的SQL，可能会引起数据库性能下降。当前每秒逻辑读{[metric,2300113]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "14167", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "14168", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "14170", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "14171", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "14172", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "14174", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "14173", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "14175", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "pg数据库未知连接错误：{[metric,1000000]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "14179", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "14180", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "14181", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "14182", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "8800", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "14214", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "14215", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "11241", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "14216", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "14218", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "14219", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "14220", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "死元组达到清理要求未清理的分析", "knowledge_description": "死元组达到清理要求未清理的分析"}], "description": "存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题", "rule_name": "dead_tuple_not_cleanup_on", "id": "14222", "rule_expression": "[metric max,2300160]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 未及时清理死行的对象数量 >存在异常，说明存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题.（{[metric max ,2300160]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "14224", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "14228", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "12695", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "14229", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "14230", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "14227", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "14231", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}, {"knowledge_description": "PostgreSQL表分析-按缓存读排序"}], "description": "每秒逻辑读异常增加，说明应用或者数据库出现了异常", "rule_name": "more_logic_read_pg", "id": "14232", "rule_expression": "(([metric,2300113]>[num,$1]) || ([metric in time,10,1000105,2300113][oper,eq][str,3])) && ([metric,2300113]>[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒逻辑读 >异常增加，说明存在大量不优化的SQL，可能会引起数据库性能下降。当前每秒逻辑读{[metric,2300113]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "3888", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "14233", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "16867", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "14234", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "11167", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "14239", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "14236", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "14238", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "14235", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "14243", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "11225", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "14213", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "14241", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "pg数据库未知连接错误：{[metric,1000000]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "14242", "rule_expression": "[metric,2300147]<[num,3] || [metric,2300149]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "14245", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "14246", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "14247", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "14248", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "11251", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "11190", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "14279", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "14280", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "14281", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "14282", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "14284", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "14286", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "14287", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "死元组达到清理要求未清理的分析", "knowledge_description": "死元组达到清理要求未清理的分析"}], "description": "存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题", "rule_name": "dead_tuple_not_cleanup_on", "id": "14288", "rule_expression": "[metric max,2300160]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 未及时清理死行的对象数量 >存在异常，说明存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题.（{[metric max ,2300160]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "14290", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "14292", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "14294", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "14295", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "14296", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "14297", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "14285", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}, {"knowledge_description": "PostgreSQL表分析-按缓存读排序"}], "description": "每秒逻辑读异常增加，说明应用或者数据库出现了异常", "rule_name": "more_logic_read_pg", "id": "14298", "rule_expression": "(([metric,2300113]>[num,$1]) || ([metric in time,10,1000105,2300113][oper,eq][str,3])) && ([metric,2300113]>[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒逻辑读 >异常增加，说明存在大量不优化的SQL，可能会引起数据库性能下降。当前每秒逻辑读{[metric,2300113]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "14293", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "14299", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "14300", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "14302", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "14303", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "14304", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "11236", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "11240", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "6994", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "14305", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "14306", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "14307", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "pg数据库未知连接错误：{[metric,1000000]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "14308", "rule_expression": "[metric,2300147]<[num,3] || [metric,2300149]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "14309", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "14311", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "14312", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "14313", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "14314", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "11255", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "8191", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "11254", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "14147", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "8632", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "14148", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "14149", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "14150", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "14151", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "14152", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "11250", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "8633", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "11189", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "14153", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "11168", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "14217", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "14283", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "14244", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "14178", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "14310", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "8014", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "7005", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "3895", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "3901", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "3887", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "3885", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "3899", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "11174", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "11194", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "8155", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "11258", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "3892", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16774", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16775", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "6993", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16777", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16778", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16776", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "11164", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "11166", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "11179", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "11259", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "11184", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "11229", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16779", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "11192", "rule_expression": "[metric,2820147,cluster][oper,neq][str,Streaming] || [metric,2820149,cluster]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16780", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "8189", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "11226", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "11228", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "11230", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "16791", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "11165", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "3738", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "11257", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "7006", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "8190", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "11198", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "8188", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "8156", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "11231", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "11246", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "11170", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "11185", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "11196", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "11227", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "3902", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "11243", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "11182", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "正确配置archive_command命令", "knowledge_description": "分析数据库WAL日志归档失败"}], "description": "发生未成功归档现象", "rule_name": "failed_archive_pg", "id": "3893", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [metric,2300142]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库处于归档模式下，指标< 未成功归档数 >大于0，说明数据库归档存在问题。检查归档命令是否正确，归档目录空间是否足够，归档目录IO是否正常。（{[metric,2300142]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "3875", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "11175", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "3879", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "11245", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "3880", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "3744", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "11627", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "11629", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "14169", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "16786", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "14301", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "11628", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "11630", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "16788", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "16789", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "死元组达到清理要求未清理的分析", "knowledge_description": "死元组达到清理要求未清理的分析"}], "description": "存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题", "rule_name": "dead_tuple_not_cleanup_on", "id": "16790", "rule_expression": "[metric max,2300160]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 未及时清理死行的对象数量 >存在异常，说明存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题.（{[metric max ,2300160]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "14223", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "16802", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "14157", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "14289", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "8015", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "16781", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "16782", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "16783", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "16784", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "16794", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "PostgreSQL bgwriter相关参数分析", "knowledge_description": "PostgreSQL bgwriter相关参数分析"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}, {"knowledge_name": "PostgreSQL IO吞吐量估算", "knowledge_description": "PostgreSQL IO吞吐量估算"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "PG脏块写入比例异常", "rule_name": "dirty_write_ana", "id": "11235", "rule_expression": "([metric,2300111]<[num,$1] && [metric,2300135] > [num,$5]) || ([metric,2300196]<[num,$2] && [metric,2300197]>[num,$3] && [metric,2300135]>[num,$4])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< backend进程共享缓存写出量占比 >不合理，数据库的shared buffers或者bgwriter/checkpoint相关配置可能存在问题。（{[metric,2300197]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "16809", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "16811", "rule_expression": "[metric,2300147]<[num,3] || [metric,2300149]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "检查max_connections参数"}, {"knowledge_description": "分析数据库实例情况"}], "description": "存在较多的连接到服务器的失败", "rule_name": "aborted_connection_pg", "id": "16857", "rule_expression": "[metric,2300203]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 认证失败出现次数 >存在异常，说明存在较多的连接到服务器的失败，数据库的会话连接健康存在风险。（{[metric,2300203]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "根据智能诊断的结论分析异常指标，下钻分析", "knowledge_description": "泛路由-数据库活跃会话数分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_description": "数据库等待事件分析"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "查找执行次数比较高的TOP SQL", "knowledge_description": "查找执行次数比较高的TOP SQL"}, {"knowledge_name": "数据库并行相关指标分析", "knowledge_description": "数据库并行相关指标分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "活跃会话数过多，数据库可能存在风险", "rule_name": "active_session_pg", "id": "16858", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 活跃会话数 >异常，数据库存在风险。可能是系统负载过高，或者存在TOPSQL、并行扫描等情况。（活跃会话数{[metric,2300102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "归档延迟量过大", "rule_name": "archive_pg", "id": "16859", "rule_expression": "[cib,2220002,archive_mode][oper,eq][str,on] && [cib,2220001,db_role][oper,eq][str,master] && [metric,2300146]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 归档延迟(字节数) >过大，数据库归存在风险。请检查系统IO情况，归档目录空闲空间等。（{[metric,2300146]}字节）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "PostgreSQL shared_buffers数据库参数诊断", "knowledge_description": "PostgreSQL shared_buffers数据库参数诊断"}], "description": "共享缓冲区命中率不理想", "rule_name": "buffer_cache_suboptimal_pg", "id": "16860", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300112]<[num,$2] && [metric,2300113]>[num,$3]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 共享缓冲区命中率 >过低，共享缓冲区命中率不理想，数据库访问性能可能会受到影响。({ [metric,2300112]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "16861", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}, {"knowledge_name": "对PostgreSQL的连接分布情况进行分析", "knowledge_description": "对PostgreSQL的连接分布情况进行分析"}, {"knowledge_description": "检查max_connections参数"}], "description": "接近或达到最大连接限制", "rule_name": "connection_exceed_pg", "id": "16862", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300153]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 总连接使用率 >存在异常，接近或达到最大连接限制，数据库的会话连接存在异常风险。（{[metric,2300153]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "16863", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "16864", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}, {"knowledge_name": "查看数据库当前活跃会话信息", "knowledge_description": "查看数据库当前活跃会话信息"}], "description": "死锁数超过5个", "rule_name": "dead_locks_pg", "id": "16865", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "每秒死锁数指标过高，应用可能存在异常。（每秒死锁数{[metric,2300118]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "死元组达到清理要求未清理的分析", "knowledge_description": "死元组达到清理要求未清理的分析"}], "description": "存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题", "rule_name": "dead_tuple_not_cleanup_on", "id": "16866", "rule_expression": "[metric max,2300160]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 未及时清理死行的对象数量 >存在异常，说明存在死元组数到达清理阈值而未清理的表，会造成空间浪费和性能问题.（{[metric max ,2300160]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "16868", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [], "description": "gp状态异常", "rule_name": "gp_stat_unkown", "id": "16870", "rule_expression": "[metric max in time,10,2300162]==[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "GREENPLUM数据库对象异常，{[metric iname,10,2300161]}对象状态异常"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "16872", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "16873", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "16874", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "16875", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16876", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}, {"knowledge_description": "PostgreSQL表分析-按缓存读排序"}], "description": "每秒逻辑读异常增加，说明应用或者数据库出现了异常", "rule_name": "more_logic_read_pg", "id": "16877", "rule_expression": "(([metric,2300113]>[num,$1]) || ([metric in time,10,1000105,2300113][oper,eq][str,3])) && ([metric,2300113]>[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒逻辑读 >异常增加，说明存在大量不优化的SQL，可能会引起数据库性能下降。当前每秒逻辑读{[metric,2300113]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库负载维度分析", "knowledge_description": "数据库负载维度分析"}, {"knowledge_description": "PostgreSQL表分析-按物理读排序"}, {"knowledge_name": "查看top sql判断是物理读导致还是执行次数原因", "knowledge_description": "物理读较多的TOP SQL"}], "description": "每秒物理读超过平时平均值5倍，并且超过基线的1倍，说明应用或者数据库出现了异常", "rule_name": "more_phyiscal_read_pg", "id": "16878", "rule_expression": "[metric,2300114]/[metric hour avg,2300114]>[num,$1] ", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒物理读 >过高，超过小时平均值{$1}倍，可能存在大量不优化的SQL，并且会影响数据库的性能。({[metric,2300114]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "16879", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "16880", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "16881", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "16882", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "16893", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "16883", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "16884", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "数据库等待事件分析"}], "description": "LwLock等待数量过多，系统存在风险", "rule_name": "pg_lwlock", "id": "16885", "rule_expression": "[metric,2300102]<[num,$1] && [metric,2300317]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "LwLock等待数量过多，系统存在风险。（LwLock等待总数为：{[metric,2300317]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "16886", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "pg数据库未知连接错误：{[metric,1000000]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL主从复制分析"}], "description": "数据库复制不正常", "rule_name": "repl_pg", "id": "16887", "rule_expression": "[metric,2300147]<[num,3] || [metric,2300149]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< 复制状态 >异常，指标< 备库应用延迟 >过大，数据库主从复制存在问题。（复制状态{[metric,2300147]},备库应用演示{[metric,2300149]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "16888", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "16889", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "16890", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "16891", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "16892", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库采集任务严重超时，数据库存在严重性能风险", "rule_name": "collector_exec_slow_pg", "id": "16785", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象指标采集耗时 >存在异常，数据库采集任务严重超时，数据库存在严重性能风险。（{[metric,1000101]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "数据库负载情况分析", "knowledge_description": "数据库负载情况分析"}, {"knowledge_description": "检查max_connections参数"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}], "description": "数据库连接严重超时，数据库存在巨大风险", "rule_name": "connect_slow_pg", "id": "16787", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1]) && ([metric,1000102] >[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 对象连接耗时 >出现异常，数据库连接严重超时，数据库存在巨大风险。（{[metric,1000102]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "出现多次错误或告警的SQL语句，可能是应用发出", "rule_name": "error_sql_pg", "id": "16792", "rule_expression": "[metric,2300204]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 错误的SQL语句出现次数 >存在异常，出现多次错误或告警的SQL语句，可能是应用发出。（{[metric,2300204]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}, {"knowledge_name": "数据库IO相关指标分析", "knowledge_description": "数据库IO相关指标分析"}, {"knowledge_name": "高IO消耗 top sql", "knowledge_description": "高IO消耗 top sql"}, {"knowledge_name": "根据智能诊断结论进行下钻分析", "knowledge_description": "泛路由-数据库IO分析"}], "description": "IO延时超过100毫秒，数据库存在风险", "rule_name": "IO_latency_pg_critical", "id": "16796", "rule_expression": "[metric,3000006]>[num,$1] && ([metric,3000100]>[num,$2] || [metric,3000101]>[num,$3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< IO Latency >(IO延时)超过100毫秒，数据库存在风险。（当前IOPS:{[metric,3000100]},IOMB:{ [metric,3000101]}，IO Latency：{[metric,3000006]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL锁等待分析"}], "description": "锁过度竞争", "rule_name": "lock_contenion_pg", "id": "16797", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300143]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 当前锁数 >异常，存在锁过度竞争现象，数据库的并发性能可能存在问题。（{ [metric,2300143]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按执行时间排序", "knowledge_description": "Top SQL-按执行时间排序"}, {"knowledge_description": "PostgreSQL长事务分析"}, {"knowledge_description": "分析数据库实例情况"}], "description": "长时间运行的查询数超过10个", "rule_name": "long_running_pg", "id": "16798", "rule_expression": "[metric,2300158]>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 长查询数 >异常，长时间运行的查询数过多，可能存在TOPSQL，或者数据库性能存在问题。（{[metric,2300158]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "16795", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "长事务过多或过长", "rule_name": "long_trx_pg", "id": "16799", "rule_expression": "[metric,2300105]>[num,$1] || [metric,2300106]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 长事务数 >和指标< 最长事务持续时间 >异常，数据库的锁等待时间、死锁等可能会增加，数据库系统的 性能可能会受到影响。（长事务{[metric,2300105]}个，最长事务持续时间{[metric,2300106]}秒)"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}], "description": "内存不可用率过高，超过90%，可能存在换页和OOM Kill的风险", "rule_name": "memory_used_high_pg", "id": "16800", "rule_expression": "[metric,3000014]>[num,$1]  && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< Mem unavailable >(内存不可用率)过高，操作系统内存出现严重不足，可能存在换页和OOM Kill的风险。内存不可用率：（{[metric,3000014]}%）且swap usage达到{[metric,3001031]}%。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}, {"knowledge_description": "PostgreSQL表分析-按缓存读排序"}], "description": "每秒逻辑读异常增加，说明应用或者数据库出现了异常", "rule_name": "more_logic_read_pg", "id": "16801", "rule_expression": "(([metric,2300113]>[num,$1]) || ([metric in time,10,1000105,2300113][oper,eq][str,3])) && ([metric,2300113]>[num,$2])", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒逻辑读 >异常增加，说明存在大量不优化的SQL，可能会引起数据库性能下降。当前每秒逻辑读{[metric,2300113]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}, {"knowledge_name": "采集CPU使用率比较高的TOP20进程", "knowledge_description": "采集CPU使用率比较高的TOP20进程"}, {"knowledge_name": "分析CPU使用情况", "knowledge_description": "分析CPU使用情况"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}], "description": "操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈", "rule_name": "more_running_proc_pg", "id": "16803", "rule_expression": "[metric,3000009]/[metric,3000010]>[num,$1] && [metric,3000003]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "指标< running process >（r队列长度）过高，同时指标< CPU使用率 >过高，操作系统r队列超过CPU数量的2倍且CPU使用率超过90%，可能存在CPU资源瓶颈"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库CPU高分析", "knowledge_description": "数据库CPU高分析"}, {"knowledge_name": "数据库活跃会话分析（CPU高）", "knowledge_description": "数据库活跃会话分析（CPU高）"}], "description": "postgresql数据库CPU使用率过高，可能存在瓶颈", "rule_name": "pg_cpu_used_higher", "id": "16804", "rule_expression": "([metric in time,10,3000003] >[num,$1]) || ([metric in time,10,1000105,3000003][oper,eq][str,3])", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "CPU使用率过高，超过了{[num,$1]}%，或者出现了急剧上升的情况，当前CPU使用率为：{[metric,3000003]}%"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD到pg数据库连接配置有问题，导致连接失败", "rule_name": "pg_dsmart_connection_error", "id": "16805", "rule_expression": "[metric,1000000][oper,contains][str,FATAL: database] && [metric,1000000][oper,contains][str,does not exist]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART到数据库连接配置有问题，导致连接失败"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD连接PG数据库的用户密码错误", "rule_name": "pg_dsmart_logon_failed", "id": "16806", "rule_expression": "[metric,1000000][oper,contains][str,password authentication failed]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "dsmart连接PG数据库的用户密码错误({[metric,1000000]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "运维对象连接失败，请检查运维对象是否down", "knowledge_description": "运维对象连接状态分析"}], "description": "KYD采样SQL在pg数据库执行失败", "rule_name": "pg_dsmart_monitor_sql_execute_failed", "id": "16807", "rule_expression": "[metric,1000000] [oper,contains][str,SQL执行失败]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "D-SMART采样任务执行失败，数据库可能存在问题"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "KYD客户端到PG数据库网络出现问题或者KYD到PG数据库连接串端口配置出错，请检查相关配置", "rule_name": "pg_dsmart_network_failed", "id": "16808", "rule_expression": "[metric,1000000][oper,contains][str,Check that the hostname and port are correct]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "监控工具到数据库之间的网络出现问题或者数据库连接串端口配置出错，请检查相关配置"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "数据库连接失败分析", "knowledge_description": "数据库连接失败分析"}], "description": "pg数据库未知连接错误", "rule_name": "pg_unkown_connect_failed", "id": "16810", "rule_expression": "[metric,1000000][oper,notcontains][str,Check that the hostname and port are correct] && [metric,1000000][oper,notcontains][str,does not exist] && [metric,1000000][oper,notcontains][str,connection attempt failed] && [metric,1000000][oper,notcontains][str,password authentication failed] && [metric,1000000][oper,notcontains][str,not permitted to log in] && [metric,1000000][oper,notcontains][str,SQL执行失败] && [metric,1000000][oper,neq][str,连接成功]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "pg数据库未知连接错误：{[metric,1000000]}"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "分析数据库实例情况"}], "description": "数据库可能发生了重启", "rule_name": "restart_pg", "id": "16812", "rule_expression": "[metric,2300001]<[num,$1] && [metric,2300201][oper,like][str,20]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库可能发生了重启"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "找出内存占用率较高的Top20进程", "knowledge_description": "找出内存占用率较高的Top20进程"}, {"knowledge_name": "Swap占用较多的前30个线程", "knowledge_description": "Swap占用较多的前30个线程"}, {"knowledge_name": "数据库内存分析", "knowledge_description": "数据库内存分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "Top SQL-按逻辑读排序", "knowledge_description": "Top SQL-按逻辑读排序"}], "description": "物理内存空闲小于100M，且SWAP使用率超过90%，系统存在高风险", "rule_name": "swap_used_pg_critical", "id": "16813", "rule_expression": "[metric,3000007]<[num,$1]*[num,1024] && [metric,3001031]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< Mem Free (KB) >(空闲内存）异常，同时指标< swap usage(%) >（交换区使用率）过高，数据库系统存在风险。（SWAP使用率{swap usage(%)}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按临时读写排序", "knowledge_description": "Top SQL-按临时读写排序"}, {"knowledge_description": "检查temp_buffers参数"}], "description": "检测到临时文件使用量过多", "rule_name": "tmp_files_pg", "id": "16814", "rule_expression": "[metric,2300001]>[num,$1] && [metric,2300125]>[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒生成临时文件数 >异常 ，检测到临时文件使用量过多，可能temp_buffer配置过低，或者SQL存在性能问题。（{[metric,2300125]}）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "PostgreSQL长事务分析"}], "description": "如果事务提交比例低于历史平均水平的50%，系统可能存在隐患", "rule_name": "transaction_commit_ratio_low", "id": "16815", "rule_expression": "[metric,2300108] < [metric hour avg,2300108]*[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "指标< 事务提交比例 >({[metric,2300108]})低于小时平均水平的50%，系统可能存在隐患"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按物理写排序", "knowledge_description": "Top SQL-按物理写排序"}, {"knowledge_description": "PostgreSQL表分析-按增删改行数排序"}], "description": "用户进程写出的脏块过多", "rule_name": "user_flush_pg", "id": "16816", "rule_expression": "[metric,2300135]>[num,$1] && [metric,2300111]<[num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< 每秒共享缓存写出量 >较高时，指标< 非backend进程共享缓存写占比 >过低，数据库的共享缓冲配置可能过小。(每秒共享缓冲写出量{[metric,2300135]},非BACKEND写脏块比例{[metric,2300111]}%）"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "WAL 日志参数/空间检查"}], "description": "WAL 日志占用空间过大，超过10 GB", "rule_name": "wal_more_size", "id": "16817", "rule_expression": null, "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标< WAL日志占用空间 >异常，可能是每秒事务数过大，或者存在大事务。（WAL日志占用空间{[metric,2300159]})"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "3881", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "14161", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "11178", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "16871", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "11239", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "全表扫描过多，索引没有被有效利用", "rule_name": "index_used_suboptimal_pg", "id": "3882", "rule_expression": "[metric,2302519]/[metric,2300120] > [num,$1] && [metric,2302518] > [num,$2]", "db_type": "PostgreSQL", "warning_level": "2", "warning_message": "指标<每秒全表扫描记录数>([metric,2302519])占指标< 每秒返回行数>([metric,2300120])的比例超过90%，说明SQL扫描效率较低，存在大量的全表扫描操作，索引没有用被有效利用。索引设计存在问题或者SQL编写不够优化。"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17659", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17660", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17662", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17661", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17656", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17657", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17658", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17663", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}, {"knowledge_name": "Top SQL-按处理行数排序", "knowledge_description": "Top SQL-按处理行数排序"}, {"knowledge_description": "PostgreSQL表分析-按全表扫描行数排序"}], "description": "索引回表率过高，索引效率低，可能会导致较高的IO，引起数据库性能问题", "rule_name": "index_fetched_table_ratio_high", "id": "17664", "rule_expression": "([metric,2300121]/([metric,2300120]-[metric,2302519]))>[num,$1]", "db_type": "PostgreSQL", "warning_level": "3", "warning_message": "数据库索引回表率{[metric,2300121]/([metric,2300120]-[metric,2302519])}过高，导致消耗更多的IO，影响数据库性能"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "postgresql实例检查", "knowledge_description": "postgresql实例检查"}], "description": "数据库角色发生切换", "rule_name": "db_role_switch", "id": "11232", "rule_expression": "[metric,2300045][oper,==][num,$1]", "db_type": "PostgreSQL", "warning_level": "4", "warning_message": "数据库主从角色发生切换"}}
