{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "对Tomcat的当前运行状态进行分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "中间件连接延时严重超长，中间件存在风险", "rule_name": "connect_slow_tomcat", "id": "6997", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1])", "db_type": "Tomcat", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "对Tomcat的当前运行状态进行分析"}], "description": "中间件运行状态不正常", "rule_name": "abnormal_tomcat", "id": "1", "rule_expression": "[metric,4050201]>[num,$1]&&[metric,4050001]>[num,0]", "db_type": "Tomcat", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat请求处理分析"}, {"knowledge_description": "Tomcat Servlet执行分析"}], "description": "Web请求错误比例超过阀值", "rule_name": "req_error_tomcat", "id": "2", "rule_expression": "[metric,4050214]>[num,$1]&&[metric,4050216]/[metric,4050214]>[num,$2] ", "db_type": "Tomcat", "warning_level": "3"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JDBC连接池分析"}], "description": "JDBC事务回滚较为频繁", "rule_name": "jdbc_rollback_tomcat", "id": "4", "rule_expression": "[metric,4050246]>[num,$1]&&[metric,4050247]<[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JDBC连接池分析"}], "description": "JDBC连接等待次数超过阀值", "rule_name": "jdbc_waiting_tomcat", "id": "5", "rule_expression": "[metric,4050236]>[num,$1]&&[metric,4050251]<[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat连接器分析"}], "description": "线程池活跃线程数超过阀值", "rule_name": "active_threads_tomcat", "id": "8", "rule_expression": "[metric,4050002]>[num,$1]&&[metric,4050002]/[metric,4050003]>[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat Servlet执行分析"}, {"knowledge_description": "Tomcat请求处理分析"}], "description": "Web请求平均处理时间超过阀值", "rule_name": "slow_req_tomcat", "id": "3", "rule_expression": "[metric,4050214]>[num,$1]&&[metric,4050215]>[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JVM内存分析"}], "description": "JVM元数据内存碎片严重", "rule_name": "metaspace_frag_tomcat", "id": "10", "rule_expression": "[metric,4050030]>[num,$1]&&[metric,4050032]<[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JVM垃圾回收分析"}], "description": "垃圾回收时间太长或Full GC频繁", "rule_name": "long_gc_tomcat", "id": "12", "rule_expression": "[metric,4050227]>[num,$1]||[metric,4050228]>[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "对Tomcat的当前运行状态进行分析"}], "description": "中间件可能发生了重启", "rule_name": "restart_tomcat", "id": "11", "rule_expression": "[metric,4050201]<[num,$1]&&[metric,4050203][oper,contains][str,20]", "db_type": "Tomcat", "warning_level": "1"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JDBC连接池分析"}], "description": "JDBC连接池出现不可用现象", "rule_name": "jdbc_unavailable_tomcat", "id": "7", "rule_expression": "[metric min,4050035]==[num,0]", "db_type": "Tomcat", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "对Tomcat的当前运行状态进行分析"}], "description": "中间件运行状态不正常", "rule_name": "abnormal_tomcat", "id": "13", "rule_expression": "[metric,4050201]>[num,$1]&&[metric,4050001]>[num,0]", "db_type": "Tomcat", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat连接器分析"}], "description": "线程池活跃线程数超过阀值", "rule_name": "active_threads_tomcat", "id": "14", "rule_expression": "[metric,4050002]>[num,$1]&&[metric,4050002]/[metric,4050003]>[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JDBC连接池分析"}], "description": "JDBC连接获取失败次数超过阀值", "rule_name": "jdbc_failure_tomcat", "id": "15", "rule_expression": "[metric,4050236]>[num,$1]&&[metric,4050234]<[num,$2]", "db_type": "Tomcat", "warning_level": "3"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JDBC连接池分析"}], "description": "JDBC连接池出现不可用现象", "rule_name": "jdbc_unavailable_tomcat", "id": "17", "rule_expression": "[metric min,4050035]==[num,0]", "db_type": "Tomcat", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JDBC连接池分析"}], "description": "JDBC事务回滚较为频繁", "rule_name": "jdbc_rollback_tomcat", "id": "16", "rule_expression": "[metric,4050246]>[num,$1]&&[metric,4050247]<[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "对Tomcat的当前运行状态进行分析"}], "description": "中间件可能发生了重启", "rule_name": "restart_tomcat", "id": "23", "rule_expression": "[metric,4050201]<[num,$1]&&[metric,4050203][oper,contains][str,20]", "db_type": "Tomcat", "warning_level": "1"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JVM内存分析"}], "description": "JVM堆内存不足", "rule_name": "low_heap_tomcat", "id": "9", "rule_expression": "[metric,4050033]-[metric,4050022]<[num,$1]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "对Tomcat的当前运行状态进行分析"}, {"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "中间件连接延时严重超长，中间件存在风险", "rule_name": "connect_slow_tomcat", "id": "6998", "rule_expression": "[metric,1000102] >([metric hour avg,1000102]*[num,$1])", "db_type": "Tomcat", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_description": "对Tomcat的当前运行状态进行分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "中间件采集任务严重超时，中间件存在性能风险", "rule_name": "collector_exec_slow_tomcat", "id": "7010", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "Tomcat", "warning_level": "4"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JDBC连接池分析"}], "description": "JDBC连接等待次数超过阀值", "rule_name": "jdbc_waiting_tomcat", "id": "18", "rule_expression": "[metric,4050236]>[num,$1]&&[metric,4050251]<[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JVM垃圾回收分析"}], "description": "垃圾回收时间太长或Full GC频繁", "rule_name": "long_gc_tomcat", "id": "19", "rule_expression": "[metric,4050227]>[num,$1]||[metric,4050228]>[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JVM内存分析"}], "description": "JVM元数据内存碎片严重", "rule_name": "metaspace_frag_tomcat", "id": "21", "rule_expression": "[metric,4050030]>[num,$1]&&[metric,4050032]<[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat请求处理分析"}, {"knowledge_description": "Tomcat Servlet执行分析"}], "description": "Web请求错误比例超过阀值", "rule_name": "req_error_tomcat", "id": "22", "rule_expression": "[metric,4050214]>[num,$1]&&[metric,4050216]/[metric,4050214]>[num,$2] ", "db_type": "Tomcat", "warning_level": "3"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat Servlet执行分析"}, {"knowledge_description": "Tomcat请求处理分析"}], "description": "Web请求平均处理时间超过阀值", "rule_name": "slow_req_tomcat", "id": "24", "rule_expression": "[metric,4050214]>[num,$1]&&[metric,4050215]>[num,$2]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JVM内存分析"}], "description": "JVM堆内存不足", "rule_name": "low_heap_tomcat", "id": "20", "rule_expression": "[metric,4050033]-[metric,4050022]<[num,$1]", "db_type": "Tomcat", "warning_level": "2"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_description": "Tomcat JDBC连接池分析"}], "description": "JDBC连接获取失败次数超过阀值", "rule_name": "jdbc_failure_tomcat", "id": "6", "rule_expression": "[metric,4050236]>[num,$1]&&[metric,4050234]<[num,$2]", "db_type": "Tomcat", "warning_level": "3"}}
{"type": "rule", "data": {"knowledge_id": [{"knowledge_name": "操作系统核心资源分析", "knowledge_description": "操作系统核心资源分析"}, {"knowledge_description": "对Tomcat的当前运行状态进行分析"}, {"knowledge_name": "服务器内存分析", "knowledge_description": "服务器内存分析"}, {"knowledge_name": "分析服务器IO设备的IO情况", "knowledge_description": "分析服务器IO设备的IO情况"}], "description": "中间件采集任务严重超时，中间件存在性能风险", "rule_name": "collector_exec_slow_tomcat", "id": "7009", "rule_expression": "[metric,1000101] >([metric hour avg,1000101]*[num,$1])", "db_type": "Tomcat", "warning_level": "4"}}
