{"input": "分今天、昨天、一周前三个时间段，分别统计 monitor 索引中，issue_alert 为 true 的日志量，并追加在一起。", "instruction": "告警数量同环比分析", "output": "starttime=\"now/d\" endtime=\"now\" _index:monitor issue_alert:true  | stats count() as cnt | eval line=\"今天\" | append [[   starttime=\"-1d/d\" endtime=\"now/d\" _index:monitor issue_alert:true | stats count() as cnt  | eval line=\"昨天\"]] | append [[  starttime=\"-7d/d\" endtime=\"-6d/d\" _index:monitor issue_alert:true |stats count() as cnt |eval line=\"一周前\"]]"}
{"input": "每24 小时环比趋势对比。", "instruction": "CitrixNetscaler日志数据，编写查询语句实现如下分析场景", "output": "(* AND appname:citrix) AND 'tag':netscaler | timechart count() | timewrap 24h "}
{"input": "", "instruction": "登录接口耗时最近半小时走势环比前半个小时", "output": " starttime=\"now-1h\" appname:apache apache.request_path:\"/login\" | timechart avg(apache.resp_time) | timewrap 30m"}
{"input": "", "instruction": "过去七天的中间件访问日志，按小时同比分析每天的日志量走势。", "output": "starttime=\"-7d/d\" appname:middleware | timechart span=1h count() as count_ | timewrap 1d"}
{"input": "登录趋势同环比。", "instruction": "Jumpserver堡垒机数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:fortress tag:jumpserver  fortress.log_type:login_log \n| bucket timestamp span=30m as ts  \n| stats count() as cnt by   ts\n|eval ts=formatdate(ts,\"HH:mm\")\n| eval line=\"今天\"\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:fortress tag:jumpserver fortress.log_type:login_log \n\t| bucket timestamp span=30m as ts  \n\t| stats count() as cnt by   ts\n\t|eval ts=formatdate(ts,\"HH:mm\")\n\t| eval line=\"昨天\"]]\n|append [[\n\t\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:fortress tag:jumpserver fortress.log_type:login_log \n\t| bucket timestamp span=30m as ts  \n\t| stats count() as cnt by   ts\n\t|eval ts=formatdate(ts,\"HH:mm\")\n\t| eval line=\"上周\"]]"}
{"input": "所有操作趋势今天_昨天_上周同环比。", "instruction": "思福迪堡垒机数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:fortress tag:safety  \n|bucket timestamp span=30m as ts\n| stats count() as cnt by   ts\n|eval ts=formatdate(ts,\"HH:mm\")\n| eval line=\"今天\"\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:fortress tag:safety \n\t|bucket timestamp span=30m as ts\n\t| stats count() as cnt by   ts\n\t|eval ts=formatdate(ts,\"HH:mm\")\n\t| eval line=\"昨天\"]]\n|append [[\n\t\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:fortress tag:safety \n\t| bucket timestamp span=30m as ts  \n\t| stats count() as cnt by   ts\n\t|eval ts=formatdate(ts,\"HH:mm\")\n\t| eval line=\"上周\"]]"}
{"input": "防火墙连接成功事件趋势同环比。", "instruction": "cisco_asa防火墙数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:firewall tag:cisco_asa firewall.event_name:*连接成功* | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:firewall tag:cisco_asa firewall.event_name:*连接成功* | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:firewall tag:cisco_asa firewall.event_name:*连接成功* | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"一周前\"]]"}
{"input": "防火墙连接失败趋势同环比。", "instruction": "cisco_asa防火墙数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:firewall tag:cisco_asa firewall.event_name:*连接失败* | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:firewall tag:cisco_asa firewall.event_name:*连接失败* | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:firewall tag:cisco_asa firewall.event_name:*连接失败* | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"一周前\"]]"}
{"input": "防火墙事件趋势同环比。", "instruction": "firewall_netscreen_数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:firewall tag:netscreen | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:firewall tag:netscreen | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:firewall tag:netscreen | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"一周前\"]]"}
{"input": "对发帖审计趋势进行今天_昨天_上周同环比。", "instruction": "奇安信AC数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:ac tag:qianxin ac.log_type:post \n| bucket timestamp span=30m as ts  \n| stats count() as cnt by   ts\n|eval ts=formatdate(ts,\"HH:mm\")\n| eval line=\"今天\"\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:ac tag:qianxin ac.log_type:post \n\t| bucket timestamp span=30m as ts  \n\t| stats count() as cnt by   ts\n\t|eval ts=formatdate(ts,\"HH:mm\")\n\t| eval line=\"昨天\"]]\n|append [[\n\t\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:ac tag:qianxin ac.log_type:post \n\t| bucket timestamp span=30m as ts  \n\t| stats count() as cnt by   ts\n\t|eval ts=formatdate(ts,\"HH:mm\")\n\t| eval line=\"上周\"]]"}
{"input": "非 Informational 级别日志对上周，昨天，今天趋势的同环比。", "instruction": "ips_mcafee数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\" appname:ips tag:mcafee NOT ips.level:Informational\n|bucket timestamp span=1h as ts\n| stats count() as cnt by ts\n|eval line=\"昨天\"\n|append [[\n\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:ips tag:mcafee NOT ips.level:Informational\n\t|bucket timestamp span=1h as ts\n\t| stats count() as cnt by ts\n\t|eval line=\"上周同一天\"\n]]\n|append [[\n\tstarttime=\"now/d\" endtime=\"now\" appname:ips tag:mcafee NOT ips.level:Informational\n\t|bucket timestamp span=1h as ts\n\t| stats count() as cnt by ts\n\t|eval line=\"今天\"\n]]"}
{"input": "进行今日，昨日，上周同日收到威胁事件趋势的同环比。", "instruction": "长亭NTA数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:nta tag:chaitin\n|bucket timestamp span=1h as ts\n|eval ts=formatdate(ts,\"HH:mm\"),line=\"今天\"\n|stats count() as cnt  by ts,line\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:nta tag:chaitin\n\t|bucket timestamp span=1h as ts\n\t|eval ts=formatdate(ts,\"HH:mm\"),line=\"昨天\"\n\t|stats count() as cnt  by ts,line\n]]\n|append [[\n\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:nta tag:chaitin\n\t|bucket timestamp span=1h as ts\n\t|eval ts=formatdate(ts,\"HH:mm\"),line=\"上周同期\"\n\t|stats count() as cnt  by ts,line\n]]"}
{"input": "进行今日,昨日,上周同日收到威胁事件趋势同环比。", "instruction": "fireeye_nx数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:fireeye tag:nx\n|bucket timestamp span=1h as ts\n|eval ts=formatdate(ts,\"HH:mm\"),line=\"今天\"\n|stats count() as cnt  by ts,line\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:fireeye tag:nx\n\t|bucket timestamp span=1h as ts\n\t|eval ts=formatdate(ts,\"HH:mm\"),line=\"昨天\"\n\t|stats count() as cnt  by ts,line\n]]\n|append [[\n\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:fireeye tag:nx\n\t|bucket timestamp span=1h as ts\n\t|eval ts=formatdate(ts,\"HH:mm\"),line=\"上周同期\"\n\t|stats count() as cnt  by ts,line\n]]"}
{"input": "邮件网关数据对今日、昨日、上周同日收到威胁邮件的趋势进行同环比。", "instruction": "fireeye数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:fireeye tag:ex\n|bucket timestamp span=1h as ts\n|eval ts=formatdate(ts,\"HH:mm\"),line=\"今天\"\n|stats count() as cnt  by ts,line\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:fireeye tag:ex\n\t|bucket timestamp span=1h as ts\n\t|eval ts=formatdate(ts,\"HH:mm\"),line=\"昨天\"\n\t|stats count() as cnt  by ts,line\n]]\n|append [[\n\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:fireeye tag:ex\n\t|bucket timestamp span=1h as ts\n\t|eval ts=formatdate(ts,\"HH:mm\"),line=\"上周同期\"\n\t|stats count() as cnt  by ts,line\n]]"}
{"input": "", "instruction": "登录接口耗时最近半小时走势同比昨天的情况", "output": " starttime=\"now-30m\" appname:apache apache.request_path:\"/login\" | bucket timestamp span=1m as ts | stats avg(apache.resp_time) as '今天' by ts | eval minute=parsedate(ts, \"HH:mm\") | join type=left minute [[ starttime=\"now-30m-1d\" endtime=\"now-1d\" appname:apache apache.request_path:\"/login\" | bucket timestamp span=1m as ts | stats avg(apache.resp_time) as '昨天' by ts | eval minute=parsedate(ts, \"HH:mm\") ]]"}
{"input": "对平均请求时长同比分析，针对今天、昨天、上周。", "instruction": "中间件日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:middleware | stats avg(middleware.req_time) as count_ | eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:middleware | stats avg(middleware.req_time) as count_ | eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:middleware | stats avg(middleware.req_time) as count_ |eval line=\"一周前\"]]"}
{"input": "访问耗时同比趋势分析。", "instruction": "haproxy日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now\" appname:haproxy middleware.tt:*|bucket timestamp span=30m as ts|stats avg(middleware.tt) as avg_ by ts|eval line=\"今天\"|append [[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:haproxy middleware.tt:*|bucket timestamp span=30m as ts|stats avg(middleware.tt) as avg_ by ts|eval line=\"昨天\"]]|append [[starttime=\"-8d/d\" endtime=\"-7d/d\" appname:haproxy middleware.tt:*|bucket timestamp span=30m as ts|stats avg(middleware.tt) as avg_ by ts|eval line=\"上周\"]]|eval time=formatdate(ts,\"HH:mm\")"}
{"input": " 分析今天访问时长的均值，同比昨天、上周。", "instruction": "Apache日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:apache tag:access | stats avg(middleware.req_time) as count_ | eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:apache tag:access | stats avg(middleware.req_time) as count_ | eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:apache tag:access |stats avg(middleware.req_time) as count_ | eval line=\"一周前\"]]"}
{"input": "我要统计请求时长的平均值，对今天、昨天、上周做同比。", "instruction": "瑞数waf数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:waf tag:river | stats avg(waf.cost) as count_ | eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:waf tag:river | stats avg(waf.cost) as count_ | eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:waf tag:river | stats avg(waf.cost) as count_ | eval line=\"一周前\"]]"}
{"input": "错误事件上周_昨天_今天同比。", "instruction": "恒生UF报盘程序数据，编写查询语句实现如下分析场景", "output": "starttime=\"-7d/d\" entime=\"-6d/d\" appname:uf  (uf.log_type:错误 OR uf.log_type:警告) \n| stats count() as cnt \n| eval line=\"上周\"\n|append[[\n\tstarttime=\"-1d/d\" entime=\"now/d\" appname:uf (uf.log_type:错误 OR uf.log_type:警告) \n\t| stats count() as cnt \n\t| eval line=\"昨天\"]]\n|append[[\n\t\tstarttime=\"now/d\" entime=\"now\" appname:uf (uf.log_type:错误 OR uf.log_type:警告) \n\t| stats count() as cnt \n\t| eval line=\"今天\"]]"}
{"input": "请求量同比进行今天、昨天、上周。", "instruction": "中间件安全态势数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:middleware | stats count() as count_ | eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:middleware |stats count() as count_ | eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:middleware | stats count() as count_ | eval line=\"一周前\"]]"}
{"input": "", "instruction": "搜索同比上周同一天增加超过50%的页面", "output": "starttime=\"now/d\" appname:apache  | stats count() as cnt1 by apache.request_path | join type=left apache.request_path [[ starttime=\"now-7d/d\" endtime=\"now-7d\" appname:apache | stats count() as cnt2 by apache.request_path ]] | where cnt1 > cnt2 * 1.5"}
{"input": "checkpoint拒绝操作今天昨天前天3天的趋势同比，每 15 分钟统计一次。", "instruction": "防火墙checkpoint日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\" appname:firewall AND tag:checkpoint firewall.action:drop   \n|bucket timestamp span=15m as ts \n|stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"前天\"\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:firewall AND tag:checkpoint firewall.action:drop  \n\t|bucket timestamp span=15m as ts \n\t|stats count() by ts\n\t|eval ts1=formatdate(ts,\"HHmm\")\n\t|eval line=\"昨天\"]]\n|append [[\n\t\tstarttime=\"now/d\" endtime=\"now\" appname:firewall AND tag:checkpoint firewall.action:drop \n\t|bucket timestamp span=15m as ts \n\t|stats count() by ts\n\t|eval ts1=formatdate(ts,\"HHmm\")\n\t|eval line=\"今天\"]]\n|append[[\n\t\t\tstarttime=\"-2d/d\" endtime=\"-1d/d\" appname:firewall AND tag:checkpoint firewall.action:Drop   \n\t|bucket timestamp span=15m as ts \n\t|stats count() by ts\n\t|eval ts1=formatdate(ts,\"HHmm\")\n\t|eval line=\"前天\"]]\n|append[[\n\t\t\t\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:firewall AND tag:checkpoint firewall.action:Drop  \n\t|bucket timestamp span=15m as ts \n\t|stats count() by ts\n\t|eval ts1=formatdate(ts,\"HHmm\")\n\t|eval line=\"昨天\"]]\n|append[[\n\t\t\t\t\tstarttime=\"now/d\" endtime=\"now\" appname:firewall AND tag:checkpoint firewall.action:Drop \n\t|bucket timestamp span=15m as ts \n\t|stats count() by ts\n\t|eval ts1=formatdate(ts,\"HHmm\")\n\t|eval line=\"今天\"]]"}
{"input": "bps趋势进行今天、昨天、上周同比。", "instruction": "ads_nsfocus数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,bps\n|eval line=\"今天\"\n|append[[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,bps\n\t|eval line=\"昨天\"]]\n|append[[\nstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,bps\n\t|eval line=\"上周\"]]"}
{"input": "网络吞吐趋势进行今天、昨天、上周同比。", "instruction": "ads_nsfocus数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,pps\n|eval line=\"今天\"\n|append[[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,pps\n\t|eval line=\"昨天\"]]\n|append[[\nstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,pps\n\t|eval line=\"上周\"]]"}
{"input": "流量趋势进行今天、昨天、上周同比。", "instruction": "ads_nsfocus数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,totalbytes\n|eval line=\"今天\"\n|append[[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,totalbytes\n\t|eval line=\"昨天\"]]\n|append[[\nstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:ddos tag:nsfocus_m |rename ddos.* as *,msg.* as *\n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,totalbytes\n\t|eval line=\"上周\"]]"}
{"input": "访问量同比趋势分析。", "instruction": "haproxy日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now\" appname:haproxy|bucket timestamp span=30m as ts|stats count() as cnt by ts|eval line=\"今天\"|append [[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:haproxy|bucket timestamp span=30m as ts|stats count() as cnt by ts|eval line=\"昨天\"]]|append [[starttime=\"-8d/d\" endtime=\"-7d/d\" appname:haproxy|bucket timestamp span=30m as ts|stats count() as cnt by ts|eval line=\"上周\"]]|eval time=formatdate(ts,\"HH:mm\")"}
{"input": "请求量同比进行今天、昨天、上周。", "instruction": "Apache日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:apache tag:access | stats count() as count_| eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:apache tag:access | stats count() as count_ | eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:apache tag:access | stats count() as count_ | eval line=\"一周前\"]]"}
{"input": "攻击事件趋势进行今天、昨天、上周同比。", "instruction": "WAF_网御星云数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:waf tag:leadsec NOT (waf.Evt_level:非攻击事件 OR waf.kv.Evt_level:10) AND (NOT \"黑名单\" ) AND (waf.Evt_type:* OR waf.kv.Evt_type:*)\n| rename waf.* as *,kv.* as *  \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time\n|eval line=\"今天\"\n|append[[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:waf tag:leadsec NOT (waf.Evt_level:非攻击事件 OR waf.kv.Evt_level:10) AND (NOT \"黑名单\" ) AND (waf.Evt_type:* OR waf.kv.Evt_type:*) \n| rename waf.* as *,kv.* as *  \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time\n\t|eval line=\"昨天\"]]\n|append[[\nstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:waf tag:leadsec NOT (waf.Evt_level:非攻击事件 OR waf.kv.Evt_level:10) AND (NOT \"黑名单\" ) AND (waf.Evt_type:* OR waf.kv.Evt_type:*) \n| rename waf.* as *,kv.* as *  \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time\n\t|eval line=\"上周\"]]"}
{"input": "攻击事件趋势进行今天、昨天、上周同比。", "instruction": "网御星云ids日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:ids tag:leadsec NOT(ids.event_level:非攻击事件 OR ids.level:10) \n| rename ids.* as *,kv.* as *  \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time\n|eval line=\"今天\"\n|append[[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:ids tag:leadsec NOT(ids.event_level:非攻击事件 OR ids.level:10) \n| rename ids.* as *,kv.* as *  \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time\n\t|eval line=\"昨天\"]]\n|append[[\n\t\tappname:ids tag:leadsec NOT(ids.event_level:非攻击事件 OR ids.level:10) \n| rename ids.* as *,kv.* as *  \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time\n\t|eval line=\"上周\"]]"}
{"input": "堡垒机被访问趋势进行今天、昨天、上周同比。", "instruction": "圣博润堡垒机日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\" appname:fortress tag:sbr  (NOT fortress.log_type:AUDIT_LOG NOT fortress.log_type:SYS_STATE_ALARM) \n| rename fortress.* as * \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n|stats count() as cnt by time\n\t|eval line=\"昨天\"\n|append[[\n\tstarttime=\"now/d\" endtime=\"now\" appname:fortress tag:sbr  (NOT fortress.log_type:AUDIT_LOG NOT fortress.log_type:SYS_STATE_ALARM) \n| rename fortress.* as * \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n|stats count() as cnt by time\n|eval line=\"今天\"]]\n|append[[\n\tstarttime=\"-7d/d\" endtime=\"-6d/d\"\tappname:fortress tag:sbr  (NOT fortress.log_type:AUDIT_LOG NOT fortress.log_type:SYS_STATE_ALARM) \n| rename fortress.* as * \n| bucket timestamp span=1h as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n|stats count() as cnt by time\n\t|eval line=\"上周\"]]"}
{"input": "请求量同比今天，昨天和上周。", "instruction": "瑞数waf数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:waf tag:river | stats count() as count_ | eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:waf tag:river | stats count() as count_ | eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:waf tag:river | stats count() as count_ | eval line=\"一周前\"]]"}
{"input": "近三天触发情报的同比趋势。", "instruction": "天际友盟威胁网关数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:leon tag:tjym\n|bucket timestamp span=1h as ts\n|eval ts=formatdate(ts,\"HH:mm\"),line=\"今天\"\n|stats count() as cnt  by ts,line\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:leon tag:tjym\n\t|bucket timestamp span=1h as ts\n\t|eval ts=formatdate(ts,\"HH:mm\"),line=\"昨天\"\n\t|stats count() as cnt  by ts,line\n]]\n|append [[\n\tstarttime=\"-2d/d\" endtime=\"-1d/d\" appname:leon tag:tjym\n\t|bucket timestamp span=1h as ts\n\t|eval ts=formatdate(ts,\"HH:mm\"),line=\"前天\"\n\t|stats count() as cnt  by ts,line\n]]"}
{"input": "", "instruction": "Kafka 每小时错误事件数同比昨天", "output": "starttime=\"-1d/d\" endtime=\"now/d\" (appname:kafka kafka.event_type:ERROR)|bucket timestamp span=1h as ts | stats count() by ts |eval line=\"昨天\"]]|append [[starttime=\"now/d\" endtime=\"now\"(appname:kafka kafka.event_type:ERROR)|bucket timestamp span=1h as ts | stats count() by ts |eval line=\"今天\"]]"}
{"input": "Oracle之Session信息今天昨天环比对比", "instruction": "Oracle数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:oracle tag:session |stats count()  as count_ |eval line =\"today\" |append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:oracle tag:session |stats count() as count_ |eval line =\"yesterday\"]]"}
{"input": "报错数量同比昨天和一周前同期", "instruction": "日志易运营视图数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" tag:rizhiyi_internal error| stats count() as count_ |eval line = \"今天\"|append[[starttime = \"-1d/d\" endtime =  \"now-1d\" tag:rizhiyi_internal error| stats count() as count_ | eval line = \"昨天\"]]|append[[starttime = \"-7d/d\" endtime =  \"now-7d\" tag:rizhiyi_internal error| stats count() as count_| eval line = \"一周前同期\"]]"}
{"input": "威胁告警数同比趋势", "instruction": "HW_威胁_数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" _index:monitor  extend_map.group:HW   issue_alert:true|bucket timestamp span=1h as ts|eval ts=formatdate(ts,\"HH:mm\")|stats count() as cnt by ts |eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" _index:monitor  extend_map.group:HW  issue_alert:true|bucket timestamp span=1h as ts|eval ts=formatdate(ts,\"HH:mm\")|stats count() as cnt by ts |eval line=\"昨天\"]]|append [[starttime=\"-7d/d\" endtime=\"-6d/d\" _index:monitor  extend_map.group:HW  issue_alert:true|bucket timestamp span=1h as ts|eval ts=formatdate(ts,\"HH:mm\")|stats count() as cnt by ts |eval line=\"上周\"]]"}
{"input": "今天和昨天按小时计算的日志量环比分析", "instruction": "网关_koal_ssl数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\"  tag:koal_ssl  |bucket timestamp span=1h as ts |stats count() as tally by ts |eval line=\"昨天\" |eval ts=formatdate(ts,\"HH\") |append [[starttime=\"now/d\" endtime=\"now\"  tag:koal_ssl  |bucket timestamp span=1h as ts |stats count() as tally by ts |eval line=\"今天\" |eval ts=formatdate(ts,\"HH\") ]] |sort by +ts"}
{"input": "最近 1 小时网卡接收字节数，同比昨天和上周", "instruction": "linux性能数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1h\" endtime=\"now\" appname:top_info_system_stats | stats sum(json.net.bytes_recv) as cnt |eval line=\"最近1小时\" |append [[starttime=\"-1h-1d\" endtime=\"now-1d\" appname:top_info_system_stats | stats sum(json.net.bytes_recv) as cnt |eval line=\"昨天同期\" ]] |append [[starttime=\"-1h-7d\" endtime=\"now-7d\" appname:top_info_system_stats|stats sum(json.net.bytes_recv) as cnt   |eval line=\"一周前同期\" ]]|rename cnt as \"网络接收字节数\""}
{"input": "统计最近一小时cpu平均使用率的趋势，和昨天、一周前做同比", "instruction": "linux性能数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1h\" endtime=\"now\" appname:top_info_system_stats | eval per=(100-json.cpu.idle_percent)/100|timechart avg(per) as cnt |rename cnt as \"cpu使用率\" |eval line=\"最近1小时\"|eval time=formatdate(_time,\"HH:mm\") |append [[starttime=\"-1h-1d\" endtime=\"now-1d\" appname:top_info_system_stats | eval per=(100-json.cpu.idle_percent)/100|timechart avg(per) as cnt |rename cnt as \"cpu使用率\" |eval line=\"昨天同期\"|eval time=formatdate(_time,\"HH:mm\") ]] |append [[starttime=\"-1h-7d\" endtime=\"now-7d\" appname:top_info_system_stats | eval per=(100-json.cpu.idle_percent)/100|timechart avg(per) as cnt |rename cnt as \"cpu使用率\" |eval line=\"一周前同期\"|eval time=formatdate(_time,\"HH:mm\") ]]"}
{"input": "分析最近 1 小时的内存使用率趋势，同比昨天和一周前相同时段", "instruction": "linux性能数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1h\" endtime=\"now\" appname:top_info_system_stats |timechart avg(json.Mem.used_percent) as cnt |rename cnt as \"内存使用率\" |eval line=\"最近1小时\"|eval time=formatdate(_time,\"HH:mm\") |append [[starttime=\"-1h-1d\" endtime=\"now-1d\" appname:top_info_system_stats |timechart avg(json.Mem.used_percent) as cnt |rename cnt as \"内存使用率\" |eval line=\"昨天同期\"|eval time=formatdate(_time,\"HH:mm\") ]] |append [[starttime=\"-1h-7d\" endtime=\"now-7d\" appname:top_info_system_stats |timechart avg(json.Mem.used_percent) as cnt |rename cnt as \"内存使用率\"  |eval line=\"一周前同期\"|eval time=formatdate(_time,\"HH:mm\") ]]"}
{"input": "统计最近1 小时的网卡发送字节数均值，并和昨天、上周同一时段做同比", "instruction": "linux性能数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1h\" endtime=\"now\" appname:top_info_system_stats |timechart avg(json.net.bytes_sent) as cnt |rename cnt as \"网络发送节数\" |eval line=\"最近1小时\"|eval time=formatdate(_time,\"HH:mm\") |append [[starttime=\"-1h-1d\" endtime=\"now-1d\" appname:top_info_system_stats |timechart avg(json.net.bytes_sent) as cnt |rename cnt as \"网络发送节数\" |eval line=\"昨天同期\"|eval time=formatdate(_time,\"HH:mm\") ]] |append [[starttime=\"-1h-7d\" endtime=\"now-7d\" appname:top_info_system_stats|timechart avg(json.net.bytes_sent) as cnt |rename cnt as \"网络发送节数\"  |eval line=\"一周前同期\"|eval time=formatdate(_time,\"HH:mm\") ]]"}
{"input": "Windows登录成功趋势同比", "instruction": "安全态势数据，编写查询语句实现如下分析场景", "output": "starttime=\"-7d/d\" endtime=\"-1d/d\"(appname:windows json.event_id:4624) |bucket timestamp span=1h as ts | stats count() as cnt by ts|eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"上周\"|append [[starttime=\"-1d/d\" endtime=\"now/d\"(appname:windows json.event_id:4624) |bucket timestamp span=1h as ts | stats count() as cnt by ts|eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"昨天\"]]|append [[starttime=\"now/d\" endtime=\"now\"(appname:windows json.event_id:4624) |bucket timestamp span=1h as ts | stats count() as cnt by ts|eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"今天\"]]"}
{"input": "windows登录失败趋势同比", "instruction": "安全态势数据，编写查询语句实现如下分析场景", "output": "starttime=\"-7d/d\" endtime=\"-1d/d\"(appname:windows json.event_id:4625) |bucket timestamp span=1h as ts | stats count() as cnt by ts|eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"上周\"|append [[starttime=\"-1d/d\" endtime=\"now/d\"(appname:windows json.event_id:4625) |bucket timestamp span=1h as ts | stats count() as cnt by ts|eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"昨天\"]]|append [[starttime=\"now/d\" endtime=\"now\"(appname:windows json.event_id:4625) |bucket timestamp span=1h as ts | stats count() as cnt by ts|eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"今天\"]]"}
{"input": "mongodb执行语句cost趋势3天同比。", "instruction": "mongodb日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:mongodb |bucket timestamp span=10m as ts|stats avg(mongodb.cost) as avg_cost by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:mongodb |bucket timestamp span=10m as ts|stats avg(mongodb.cost) as avg_cost by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:mongodb |bucket timestamp span=10m as ts|stats avg(mongodb.cost) as avg_cost by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"今天\"\n]]"}
{"input": "昨天_今天邮件大小同比。", "instruction": "exchange日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:exchange tag:tracking | stats sum(exchange.total_bytes\t) as count_| eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:exchange tag:tracking | stats sum(exchange.total_bytes) as count_| eval line=\"昨天\"]] "}
{"input": "KeyMiss次数同比_今天昨天。", "instruction": "Redis数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:redis  |  stats avg(redis.keyspace_misses) as 'KeyMiss次数趋势' | eval day=\"今天\" | append [[starttime=\"now-1d/d\" endtime=\"now/d\" appname:redis |  stats avg(redis.keyspace_misses) as 'KeyMiss次数趋势' | eval day=\"昨天\" ]]"}
{"input": "Redis被拒绝连接数趋势同比_今天昨天。", "instruction": "Redis数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:redis | bucket timestamp span=10m as ts | stats avg(redis.rejected_connections) as '被拒绝连接数趋势' by ts | eval day=\"今天\" |eval time=formatdate(ts, \"HH:mm\") | append [[starttime=\"now-1d/d\" endtime=\"now/d\" appname:redis | bucket timestamp span=10m as ts | stats avg(redis.rejected_connections) as '被拒绝连接数趋势' by ts | eval day=\"昨天\" |eval time=formatdate(ts, \"HH:mm\")]]"}
{"input": "checkpoint平均耗时_3天同比。", "instruction": "informix日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:informix tag:online_log | bucket timestamp span=15m as ts| stats avg(informix.checkpoint_cost) as count_1 by ts\n|eval line=\"前天\"|eval ts1=formatdate(ts,\"HHmm\")\n|append\n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:informix tag:online_log | bucket timestamp span=15m as ts| stats avg(informix.checkpoint_cost) as count_1 by ts\n|eval line=\"昨天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n|append\n[[starttime=\"now/d\" endtime=\"now\"\nappname:informix tag:online_log | bucket timestamp span=15m as ts| stats avg(informix.checkpoint_cost) as count_1 by ts\n|eval line=\"今天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]"}
{"input": "平均阻塞耗时_3天同比。", "instruction": "informix日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:informix tag:online_log informix.block_time:<100| bucket timestamp span=15m as ts |stats avg(informix.block_time) as avg_block_time by ts\n|eval line=\"前天\"|eval ts1=formatdate(ts,\"HHmm\")\n|append\n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:informix tag:online_log informix.block_time:<100| bucket timestamp span=15m as ts |stats avg(informix.block_time) as avg_block_time by ts\n|eval line=\"昨天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n|append\n[[starttime=\"now/d\" endtime=\"now\"\nappname:informix tag:online_log informix.block_time:<100| bucket timestamp span=15m as ts |stats avg(informix.block_time) as avg_block_time by ts\n|eval line=\"今天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n\n\n"}
{"input": "平均阻塞数_3天同比。", "instruction": "informix日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:informix tag:online_log |  bucket timestamp span=15m as ts| stats avg(informix.block) as avg_block by ts\n|eval line=\"前天\"|eval ts1=formatdate(ts,\"HHmm\")\n|append\n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:informix tag:online_log |  bucket timestamp span=15m as ts| stats avg(informix.block) as avg_block by ts\n|eval line=\"昨天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n|append\n[[starttime=\"now/d\" endtime=\"now\"\nappname:informix tag:online_log |  bucket timestamp span=15m as ts| stats avg(informix.block) as avg_block by ts\n|eval line=\"今天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n\n"}
{"input": "物理日志使用量趋势_3天同比。", "instruction": "informix日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:informix tag:online_log |  bucket timestamp span=15m as ts| stats avg(informix.plog_used) as count_1 by ts\n|eval line=\"前天\"|eval ts1=formatdate(ts,\"HHmm\")\n|append\n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:informix tag:online_log |  bucket timestamp span=15m as ts| stats avg(informix.plog_used) as count_1 by ts\n|eval line=\"昨天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n|append\n[[starttime=\"now/d\" endtime=\"now\"\nappname:informix tag:online_log |  bucket timestamp span=15m as ts| stats avg(informix.plog_used) as count_1 by ts\n|eval line=\"今天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n"}
{"input": "逻辑日志使用量趋势_3天同比。", "instruction": "informix日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:informix tag:online_log | bucket timestamp span=15m as ts |stats avg(informix.llog_used) as count_1 by ts\n|eval line=\"前天\"|eval ts1=formatdate(ts,\"HHmm\")\n|append\n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:informix tag:online_log | bucket timestamp span=15m as ts |stats avg(informix.llog_used) as count_1 by ts\n|eval line=\"昨天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n|append\n[[starttime=\"now/d\" endtime=\"now\"\nappname:informix tag:online_log | bucket timestamp span=15m as ts |stats avg(informix.llog_used) as count_1 by ts\n|eval line=\"今天\"|eval ts1=formatdate(ts,\"HHmm\")\n]]\n\n\n"}
{"input": "按小时计算今天和昨天同比的交易量趋势。", "instruction": "查询银联前置(cupp)系统数据，进行如下统计", "output": "starttime=\"now/d\" endtime=\"now\" appname:cupp \"收到报文\" | bucket timestamp span=1h as ts |stats dc(msgid) by ts|eval hour=formatdate(ts,\"HH:mm\")|eval date=\"今天\" |append [[ starttime=\"-1d/d\" endtime=\"now/d\" appname:cupp \"收到报文\" |bucket timestamp span=1h as ts |stats dc(msgid) by ts | eval hour=formatdate(ts,\"HH:mm\")|eval date=\"昨天\"   ]]"}
{"input": "", "instruction": "深信服 VPN 三天登陆趋势同比", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts  | stats count() as cnt by ts|eval line=\"今天\"|append[[ starttime=\"-1d/d\" endtime=\"now/d\"  appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"昨天\"|append[[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"前天\"]]]]|eval time=formatdate(ts,\"HH:mm:ss\")"}
{"input": "", "instruction": "登录失败最近3天趋势同比", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:sangfor (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"今天\"|append[[ starttime=\"-1d/d\" endtime=\"now/d\"  appname:vpn tag:sangfor (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"昨天\"|append[[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:sangfor (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"前天\"]]]]"}
{"input": "上周_昨天_今天日志量趋势同比。", "instruction": "华三入侵防御系统日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:ips AND tag:h3c \n|bucket timestamp span=5m as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by time,hostname\n|eval line=\"今天\"\n|append[[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:ips AND tag:h3c\n\t|bucket timestamp span=5m as ts  \n\t|eval time=formatdate(ts,\"HH:mm\")\n\t| stats count() as cnt by time,hostname\n\t|eval line=\"昨天\"]]\n|append[[\n\t\tstarttime=\"-7d/d\" endtime=\"-1d/d\" appname:ips AND tag:h3c \n\t|bucket timestamp span=5m as ts  \n\t|eval time=formatdate(ts,\"HH:mm\")\n\t| stats count() as cnt by time,hostname\n\t|eval line=\"上周\"]]"}
{"input": "登录失败最近3天趋势同比。", "instruction": "深信服VPN日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:sangfor (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"今天\"|append[[ starttime=\"-1d/d\" endtime=\"now/d\"  appname:vpn tag:sangfor (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"昨天\"|append[[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:sangfor (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"前天\"]]]]|eval time=formatdate(ts,\"HH:mm:ss\")"}
{"input": "登录失败最近3天趋势同比。", "instruction": "深信服零信任VPN数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:sangfor_0trust  (vpn.event_name:auth OR vpn.event_name:login OR vpn.event_name:logout) vpn.result:FAILED | bucket timestamp span=30m as ts\n|eval ts=formatdate(ts,\"HH:mm\")\n| stats count() as cnt by ts\n|eval line=\"今天\"\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:vpn tag:sangfor_0trust  (vpn.event_name:auth OR vpn.event_name:login OR vpn.event_name:logout) vpn.result:FAILED | bucket timestamp span=30m as ts\n\t|eval ts=formatdate(ts,\"HH:mm\")\n\t| stats count() as cnt by ts\n\t|eval line=\"昨天\"\n]]\n|append [[\n\tstarttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:sangfor_0trust (vpn.event_name:auth OR vpn.event_name:login OR vpn.event_name:logout) vpn.result:FAILED | bucket timestamp span=30m as ts\n\t|eval ts=formatdate(ts,\"HH:mm\")\n\t| stats count() as cnt by ts\n\t|eval line=\"前天\"\n]]"}
{"input": "登录失败最近3天趋势同比。", "instruction": "Cisco_VPN日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:cisco (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"今天\"|append[[ starttime=\"-1d/d\" endtime=\"now/d\"  appname:vpn tag:cisco (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"昨天\"|append[[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:cisco (vpn.actype:login AND vpn.result:fail*)| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"前天\"]]]]|eval time=formatdate(ts,\"HH:mm:ss\")"}
{"input": "", "instruction": "IIS 服务器的访问量3天同比", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\" (appname:middleware tag:iis) |stats count() | eval line=\"前天\" |append  [[starttime=\"-1d/d\" endtime=\"now/d\" (appname:middleware tag:iis) |stats count() | eval line=\"昨天\" ]] |append  [[ starttime=\"now/d\" endtime=\"now\" (appname:middleware tag:iis)|stats count() | eval line=\"今天\" ]]"}
{"input": "postgresql数据库错误日志量，3天同比分析。", "instruction": "postgresql日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:postgresql NOT postgresql.error_severity:LOG |stats count()\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:postgresql NOT postgresql.error_severity:LOG |stats count()\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:postgresql NOT postgresql.error_severity:LOG|stats count()\n|eval line=\"今天\"\n]]"}
{"input": "mongodb日志量趋势3天同比。", "instruction": "mongodb日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:mongodb |bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:mongodb|bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:mongodb|bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"今天\"\n]]"}
{"input": "昨天_今天邮件数量同比。", "instruction": "exchange日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:exchange tag:tracking | stats count() as count_| eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:exchange tag:tracking | stats count() as count_| eval line=\"昨天\"]] "}
{"input": "防火墙事件趋势同比。", "instruction": "cisco_asa防火墙数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:firewall tag:cisco_asa | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:firewall tag:cisco_asa | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:firewall tag:cisco_asa | bucket timestamp span=1h as ts|stats count() as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"一周前\"]]"}
{"input": "错误级别日志量3天同比。", "instruction": "f5_dns日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:loadbalancing tag:f5  loadbalancing.severity:*  (NOT loadbalancing.severity:info)  (NOT loadbalancing.severity:debug) (NOT loadbalancing.severity:notice)|stats count()\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:loadbalancing tag:f5  loadbalancing.severity:*  (NOT loadbalancing.severity:info)  (NOT loadbalancing.severity:debug) (NOT loadbalancing.severity:notice)|stats count()\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:loadbalancing tag:f5 loadbalancing.severity:*  (NOT loadbalancing.severity:info)  (NOT loadbalancing.severity:debug) (NOT loadbalancing.severity:notice)|stats count()\n|eval line=\"今天\"\n]]"}
{"input": "OracleRedoLog切换频率今天昨天同比图。", "instruction": "Oracle数据，编写查询语句实现如下分析场景", "output": "starttime=2017-12-16:00:00:00 endtime=2017-12-17:00:00:00 appname:oracle tag:oracle_alert_log oracle.event:\"LGWR switch\" |bucket timestamp span=1h as ts |stats count() by ts | eval hour = formatdate(ts, \"HH:mm\") | eval day=\"今天\" | append [[starttime=2017-12-17:00:00:00 endtime=2017-12-21:18:00:00 appname:oracle tag:oracle_alert_log oracle.event:\"LGWR switch\" |bucket timestamp span=1h as ts |stats count() by ts | eval hour = formatdate(ts, \"HH:mm\") | eval day=\"昨天\"]]"}
{"input": "checkpoint事件趋势_3天同比。", "instruction": "防火墙checkpoint日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\n appname:firewall AND tag:checkpoint   |bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\n appname:firewall AND tag:checkpoint |bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\n appname:firewall AND tag:checkpoint|bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"今天\"\n]]"}
{"input": "登录失败最近3天趋势同比。", "instruction": "sslvpn日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:cisco vpn.user:* \"authentication\" \"failure\"|bucket timestamp span=30m as ts|eval time=formatdate(ts,\"HH:mm\") | stats count() as cnt by time|eval line=\"今天\"|append[[starttime=\"-1d/d\" endtime=\"now/d\" appname:vpn tag:cisco vpn.user:* \"authentication\" \"failure\"|bucket timestamp span=30m as ts|eval time=formatdate(ts,\"HH:mm\") | stats count() as cnt by time|eval line=\"昨天\"]]|append[[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:cisco vpn.user:* \"authentication\" \"failure\"|bucket timestamp span=30m as ts|eval time=formatdate(ts,\"HH:mm\") | stats count() as cnt by time|eval line=\"前天\"]]"}
{"input": "高风险事件今天昨天同比分析。", "instruction": "waf_imperva_数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\"\nappname:waf AND tag:imperva AND (waf.level:High OR waf.level:\"高\")|stats count()\n|eval line=\"今天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:waf AND tag:imperva AND (waf.level:High OR waf.level:\"高\")|stats count()\n|eval line=\"昨天\"\n]]"}
{"input": "middleware_tomcat_访问量3天同比。", "instruction": "middleware_tomcat_数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\n(appname:middleware tag:tomcat) |stats count()\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\n(appname:middleware tag:tomcat) |stats count()\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\n(appname:middleware tag:tomcat)|stats count()\n|eval line=\"今天\"\n]]"}
{"input": "ips被攻击同比趋势。", "instruction": "安全态势数据，编写查询语句实现如下分析场景", "output": "starttime=\"-7d/d\" endtime=\"-1d/d\"(appname:ips ips.event_name:IPS攻击事件) | bucket timestamp span=1h as ts |eval time=formatdate(ts,\"HH:mm\")|stats count()  as cnt by time|eval line=\"上周\" | append [[starttime=\"-1d/d\" endtime=\"now/d\"(appname:ips  ips.event_name:IPS攻击事件) | bucket timestamp span=1h as ts |eval time=formatdate(ts,\"HH:mm\")|stats count() as cnt by time|eval line=\"昨天\"]] |append [[starttime=\"now/d\" endtime=\"now\"(appname:ips ips.event_name:IPS攻击事件) | bucket timestamp span=1h as ts |eval time=formatdate(ts,\"HH:mm\")|stats count() as cnt by time|eval line=\"今天\"]]"}
{"input": "waf高危事件同比趋势。", "instruction": "安全态势数据，编写查询语句实现如下分析场景", "output": "starttime=\"-7d/d\" endtime=\"-1d/d\"(appname:waf   waf.level:High)| bucket timestamp span=1h as ts | eval time=formatdate(ts,\"HH:mm\")|stats count() as cnt by time|eval line=\"上周\" |append [[starttime=\"-1d/d\" endtime=\"now/d\"(appname:waf   waf.level:High)| bucket timestamp span=1h as ts |eval time=formatdate(ts,\"HH:mm\")| stats count() as cnt by time |eval line=\"昨天\"]] |append [[starttime=\"now/d\" endtime=\"now\"(appname:waf  waf.level:High)| bucket timestamp span=1h as ts |eval time=formatdate(ts,\"HH:mm\")| stats count() as cnt by time |eval line=\"今天\"]]"}
{"input": "防火墙拒绝访问事件同比趋势。", "instruction": "安全态势数据，编写查询语句实现如下分析场景", "output": "starttime=\"-7d/d\" endtime=\"-1d/d\" (appname:firewall tag:cisco_asa firewall.action:Deny)| bucket timestamp span=1h as ts |eval time=formatdate(ts,\"HH:mm\")|stats count() as cnt by time |eval line=\"上周\"|append [[starttime=\"-7d/d\" endtime=\"-1d/d\" (appname:firewall tag:cisco_asa firewall.action:Deny)| bucket timestamp span=1h as ts |eval time=formatdate(ts,\"HH:mm\")|stats count() as cnt by time |eval line=\"昨天\"]]|append[[starttime=\"now/d\" endtime=\"now\" (appname:firewall tag:cisco_asa firewall.action:Deny)| bucket timestamp span=1h as ts |eval time=formatdate(ts,\"HH:mm\")|stats count() as cnt by time |eval line=\"今天\"]]"}
{"input": "kafka_错误事件同比趋势。", "instruction": "kafka_数据，编写查询语句实现如下分析场景", "output": "starttime=\"-7d/d\" endtime=\"-1d/d\"(appname:kafka kafka.event_type:ERROR)|bucket timestamp span=1h as ts | stats count() by ts |eval line=\"上周\"|append[[starttime=\"-1d/d\" endtime=\"now/d\"(appname:kafka kafka.event_type:ERROR)|bucket timestamp span=1h as ts | stats count() by ts |eval line=\"昨天\"]]|append [[starttime=\"now/d\" endtime=\"now\"(appname:kafka kafka.event_type:ERROR)|bucket timestamp span=1h as ts | stats count() by ts |eval line=\"今天\"]]"}
{"input": "访问量3天同比。", "instruction": "middleware_microsoft_iis_数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\n(appname:middleware tag:iis) |stats count()\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\n(appname:middleware tag:iis) |stats count()\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\n(appname:middleware tag:iis)|stats count()\n|eval line=\"今天\"\n]]"}
{"input": "访问量按 15 分钟统计趋势，然后做今天、昨天、前天的近3天同比。", "instruction": "pf_tomcat数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\n(appname:pf_tomcat) |bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HH:mm\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\n(appname:pf_tomcat) |bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HH:mm\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\n(appname:pf_tomcat)|bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HH:mm\")\n|eval line=\"今天\"\n]]"}
{"input": "访问量最近3天同比。", "instruction": "pf_nginx数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\n(appname:pf_nginx) |stats count()\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\n(appname:pf_nginx) |stats count()\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\n(appname:pf_nginx)|stats count()\n|eval line=\"今天\"\n]]"}
{"input": "错误趋势三天同比。", "instruction": "恒生中间件日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:hundsun tag:error  appname:hundsun|bucket timestamp span=5m as ts | stats count() by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:hundsun tag:error  appname:hundsun|bucket timestamp span=5m as ts | stats count() by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:hundsun tag:error  appname:hundsun|bucket timestamp span=5m as ts | stats count() by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"今天\"\n]]"}
{"input": "tomcat_stdout_同比访问量趋势。", "instruction": "tomcat_stdout_数据，编写查询语句实现如下分析场景", "output": "starttime=\"-7d/d\" endtime=\"-1d/d\" (appname:tomcat tag:stdout)|bucket timestamp span=30m as ts |stats count() by ts |eval line=\"上周\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" (appname:tomcat tag:stdout)|bucket timestamp span=30m as ts |stats count() by ts |eval line=\"昨天\"]] |append [[starttime=\"now/d\" endtime=\"now\" (appname:tomcat tag:stdout)|bucket timestamp span=30m as ts |stats count() by ts |eval line=\"今天\"]]"}
{"input": "昨日今日登录趋势同比。", "instruction": "深信服上网行为管理数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:access_control tag:sangfor access_control.log_type:login* | bucket timestamp span=20m as ts |eval time=formatdate(timestamp,\"HH:mm\")| stats count() as cnt by time | eval line=\"今天\"|append[[starttime=\"-1d/d\" endtime=\"now/d\" appname:access_control tag:sangfor access_control.log_type:login* | bucket timestamp span=20m as ts|eval time=formatdate(timestamp,\"HH:mm\") | stats count() as cnt by time | eval line=\"昨天\"]]"}
{"input": "防火墙_sonicwall事件三天同比趋势图。", "instruction": "sonicwall防火墙日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:firewall AND tag:sonicwall |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:firewall AND tag:sonicwall |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:firewall AND tag:sonicwall |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"今天\"\n]]\n"}
{"input": "丢弃事件趋势_三天同比。", "instruction": "sonicwall防火墙日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:firewall AND tag:sonicwall \"dropped\" |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"3 前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:firewall AND tag:sonicwall \"dropped\" |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"2 昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:firewall AND tag:sonicwall \"dropped\" |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"1 今天\"\n]]"}
{"input": "端口扫描事件趋势_三天同比。", "instruction": "sonicwall防火墙日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:firewall AND tag:sonicwall \"scan detected\" |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:firewall AND tag:sonicwall \"scan detected\" |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:firewall AND tag:sonicwall \"scan detected\"|bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"今天\"\n]]"}
{"input": "拒绝事件趋势_三天同比。", "instruction": "sonicwall防火墙日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:firewall AND tag:sonicwall  \"denied\" |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:firewall AND tag:sonicwall  \"denied\" |bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:firewall AND tag:sonicwall  \"denied\"|bucket timestamp span=30m as ts | stats count() as total by ts\n|eval ts1=formatdate(ts,\"HH\")\n|eval line=\"今天\"\n]]\n\n"}
{"input": "建立会话趋势同比。", "instruction": "Database_Oracle数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\"appname:oracle AND tag:listener oracle.status:establish  \n| bucket timestamp span=30m as ts \n| stats count() as ct by ts\n|eval time=formatdate(ts,\"HH:mm\") \n|eval line=\"今天\" \n| append [[\n\t starttime=\"now-1d/d\" endtime=\"now/d\" appname:oracle AND tag:listener oracle.status:establish  \n\t| bucket timestamp span=30m as ts \n\t| stats count() as ct by ts\n\t|eval time=formatdate(ts,\"HH:mm\") \n\t|eval line=\"昨天\"]] \n| fields time,line,ct"}
{"input": "建立会话趋势同比今天和昨天。", "instruction": "Database_Oracle数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\"appname:oracle AND tag:listener oracle.status:establish  \n| bucket timestamp span=30m as ts \n| stats count() as ct by ts\n|eval time=formatdate(ts,\"HH:mm\") \n|eval line=\"今天\" \n| append [[\n\t starttime=\"now-1d/d\" endtime=\"now/d\" appname:oracle AND tag:listener oracle.status:establish  \n\t| bucket timestamp span=30m as ts \n\t| stats count() as ct by ts\n\t|eval time=formatdate(ts,\"HH:mm\") \n\t|eval line=\"昨天\"]] \n| fields time,line,ct"}
{"input": "失败返回趋势3天同比。", "instruction": "同花顺日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"\"-2d/d\" endtime=\"-1d/d\"\nappname:ths_all  (ths_all.ANSTYPE:0 )  NOT ths_all.msg:*.*  NOT ths_all.msg:*;*  NOT ths_all.msg:\"-\" NOT ths_all.msg:\":\"|eval aaa=tostring(ths_all.msg)|where !empty(aaa)|eval bbb=trim(aaa) |bucket timestamp span=20m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:ths_all  (ths_all.ANSTYPE:0 )  NOT ths_all.msg:*.*  NOT ths_all.msg:*;*  NOT ths_all.msg:\"-\" NOT ths_all.msg:\":\"|eval aaa=tostring(ths_all.msg)|where !empty(aaa)|eval bbb=trim(aaa) |bucket timestamp span=20m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:ths_all  (ths_all.ANSTYPE:0 )  NOT ths_all.msg:*.*  NOT ths_all.msg:*;*  NOT ths_all.msg:\"-\" NOT ths_all.msg:\":\"|eval aaa=tostring(ths_all.msg)|where !empty(aaa)|eval bbb=trim(aaa)|bucket timestamp span=20m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"今天\"\n]]"}
{"input": "请求量3天同比趋势。", "instruction": "同花顺日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:ths_all NOT  (ths_all.ANSTYPE:0 OR ths_all.ANSTYPE:1) |bucket timestamp span=20m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:ths_all NOT  (ths_all.ANSTYPE:0 OR ths_all.ANSTYPE:1) |bucket timestamp span=20m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:ths_all NOT  (ths_all.ANSTYPE:0 OR ths_all.ANSTYPE:1)|bucket timestamp span=20m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"今天\"\n]]"}
{"input": "最近三天扫描频率同比。", "instruction": "长亭蜜罐数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:honeypot tag:chaitin  hp.source:scanner\n|bucket timestamp span =30m as ts\n| stats count() as cnt by ts\n|eval line=\"今天\"\n|append [[\n\tstarttime=\"-1d/d\" endtime=\"now/d\" appname:honeypot tag:chaitin  hp.source:scanner\n\t|bucket timestamp span =30m as ts\n\t| stats count() as cnt by ts\n\t|eval line=\"昨天\"\n]]\n|append [[\n\tstarttime=\"-2d/d\" endtime=\"-1d/d\" appname:honeypot tag:chaitin  hp.source:scanner\n\t|bucket timestamp span =30m as ts\n\t| stats count() as cnt by ts\n\t|eval line=\"前天\"\n]]"}
{"input": "最近一天日志条数及同比。", "instruction": "Sonic防火墙数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d\" (* AND appname:firewall) AND tag:sonicwall | stats count() as total | eval line=\"最近一天\" | append [[ starttime=\"-2d\" endtime=\"-1d\" (* AND appname:firewall) AND tag:sonicwall | stats count() as total | eval line=\"同比一天前\" ]]"}
{"input": "", "instruction": "最近3天趋势同比", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:sangfor_0trust  (vpn.event_name:auth OR vpn.event_name:login OR vpn.event_name:logout) vpn.result:FAILED | bucket timestamp span=30m as ts|eval ts=formatdate(ts,\"HH:mm\")| stats count() as cnt by ts|eval line=\"今天\"|append [[ starttime=\"-1d/d\" endtime=\"now/d\" appname:vpn tag:sangfor_0trust  (vpn.event_name:auth OR vpn.event_name:login OR vpn.event_name:logout) vpn.result:FAILED | bucket timestamp span=30m as ts |eval ts=formatdate(ts,\"HH:mm\") | stats count() as cnt by ts |eval line=\"昨天\"]]|append [[ starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:sangfor_0trust (vpn.event_name:auth OR vpn.event_name:login OR vpn.event_name:logout) vpn.result:FAILED | bucket timestamp span=30m as ts |eval ts=formatdate(ts,\"HH:mm\") | stats count() as cnt by ts |eval line=\"前天\"]]"}
{"input": "按每30分钟分桶统计昨天锐捷交换机扫描历史对比趋势图", "instruction": "锐捷交换机日志数据，编写查询语句实现如下分析场景", "output": " starttime=\"-1d/d\" endtime=\"now/d\" tag:ruijie switch.type:SCAN | bucket timestamp span=30m as ts | stats count() by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"yesterday\"| append [[ starttime=\"now/d\" endtime=\"now\" tag:ruijie switch.type:SCAN | bucket timestamp span=30m as ts | stats count() by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"today\"]]"}
{"input": "按每30分钟分桶统计昨天锐捷交换机ARP攻击历史对比趋势图", "instruction": "锐捷交换机日志数据，编写查询语句实现如下分析场景", "output": " starttime=\"-1d/d\" endtime=\"now/d\" tag:ruijie switch.type:DOS_DETECTED | bucket timestamp span=30m as ts | stats count() by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"yesterday\"| append [[ starttime=\"now/d\" endtime=\"now\" tag:ruijie switch.type:DOS_DETECTED | bucket timestamp span=30m as ts | stats count() by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"today\"]]"}
{"input": "按每30分钟分桶统计昨天锐捷交换机恶意攻击历史对比趋势图", "instruction": "锐捷交换机日志数据，编写查询语句实现如下分析场景", "output": " starttime=\"-1d/d\" endtime=\"now/d\" tag:ruijie switch.module:NFPP* AND (switch.type:DOS_DETECTED OR switch.type:SCAN) | bucket timestamp span=30m as ts | stats count() by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"yesterday\"| append [[ starttime=\"now/d\" endtime=\"now\" tag:ruijie switch.module:NFPP* AND (switch.type:DOS_DETECTED OR switch.type:SCAN) | bucket timestamp span=30m as ts | stats count() by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"today\"]]"}
{"input": "", "instruction": "我的问题可能涉及到一些网络安全问题或者系统运维方面的内容：1. 您昨天和今天有哪些 DOS 攻击事件被记录；2. 有没有发现明显的趋势或模式", "output": " starttime=\"-1d/d\" endtime=\"now/d\" tag:ruijie switch.type:DOS_DETECTED | bucket timestamp span=30m as ts | stats count() by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"yesterday\"| append [[ starttime=\"now/d\" endtime=\"now\" tag:ruijie switch.type:DOS_DETECTED | bucket timestamp span=30m as ts | stats count() by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"today\"]]"}
{"input": "", "instruction": "昨天和今天的访问情况有什么不同吗？有哪些页面或IP地址明显增多或者减少呢？有异常的地方么？", "output": " starttime=\"-1d/d\" endtime=\"now/d\" tag:ruijie switch.module:NFPP* AND (switch.type:DOS_DETECTED OR switch.type:SCAN) |  stats count() | eval line = \"yesterday\"| append [[ starttime=\"now/d\" endtime=\"now\" tag:ruijie switch.module:NFPP* AND (switch.type:DOS_DETECTED OR switch.type:SCAN) |  stats count() | eval line = \"today\"]]"}
{"input": "按每30分钟分桶统计飞塔事件历史昨天和今天对比趋势图。", "instruction": "防火墙_飞塔数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\" (* AND appname:firewall tag:fortinet ) |bucket timestamp span=30m as ts |stats count() as _count by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"yesterday\"| append\n[[ starttime=\"now/d\" endtime=\"now\" (* AND appname:firewall tag:fortinet ) |bucket timestamp span=30m as ts |stats count() as _count by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"today\"]]"}
{"input": "按每30分钟分桶统计飞塔攻击历史昨天和今天对比趋势图。", "instruction": "防火墙_飞塔数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\" (* AND appname:firewall  tag:fortinet firewall.subtype:ips) \n|bucket timestamp span=30m as ts \n|stats count() as _count by ts \n| eval time = formatdate(ts,\"HH:mm\")\n|eval line = \"yesterday\"\n| append[[\n\t starttime=\"now/d\" endtime=\"now\" (* AND appname:firewall  tag:fortinet firewall.subtype:ips) \n\t|bucket timestamp span=30m as ts \n\t|stats count() as _count by ts \n\t| eval time = formatdate(ts,\"HH:mm\")\n\t|eval line = \"today\"]]"}
{"input": "按每30分钟分桶统计飞塔traffic流量历史昨天和今天对比趋势图。", "instruction": "防火墙_飞塔数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\" (* AND appname:firewall  tag:fortinet firewall.type:traffic) |bucket timestamp span=30m as ts |stats count() as _count by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"yesterday\"| append\n[[ starttime=\"now/d\" endtime=\"now\" (* AND appname:firewall  tag:fortinet firewall.type:traffic) |bucket timestamp span=30m as ts |stats count() as _count by ts | eval time = formatdate(ts,\"HH:mm\")|eval line = \"today\"]]"}
{"input": "NSFOCUS_访问量对比_昨天vs今天。", "instruction": "绿盟防火墙日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\" appname:firewall tag:nsfocus | stats count()  as count_ | eval line =\"yesterday\"  |append   [[ starttime=\"now/d\" endtime=\"now\" appname:firewall tag:nsfocus | stats count()  as count_ | eval line =\"today\"]]"}
{"input": "", "instruction": "如何在日志易中实现昨天和今天的防火墙访问趋势同环比统计报告。", "output": "starttime=\"-1d/d\" endtime=\"now/d\" appname:firewall   |bucket timestamp span=30m as ts|stats count()  as count_ by ts |eval time=formatdate(ts,\"HH:mm\") |eval line =\"yesterday\"  |append   [[ starttime=\"now/d\" endtime=\"now\" appname:firewall   |bucket timestamp span=30m as ts|stats count()  as count_ by ts |eval time=formatdate(ts,\"HH:mm\") |eval line =\"today\"]]"}
{"input": "", "instruction": "rizhiyi_internal标签的日志中，错误日志的数量和时间分布对比情况，具体的说就是今天、昨天和上周同期的数据比较。", "output": "starttime = \"now/d\" endtime =  \"now\" tag:rizhiyi_internal error| bucket timestamp span = 1h as ts |stats count() as count_ by ts|eval _time =formatdate(ts,\"HH:mm\") |eval line = \"今天\"|append[[starttime = \"-1d/d\" endtime =  \"now-1d\" tag:rizhiyi_internal error| bucket timestamp span = 1h as ts |stats count() as count_ by ts|eval _time =formatdate(ts,\"HH:mm\") |eval line = \"昨天\"]]|append[[starttime = \"-7d/d\" endtime =  \"now-7d\" tag:rizhiyi_internal error| bucket timestamp span = 1h as ts |stats count() as count_ by ts|eval _time =formatdate(ts,\"HH:mm\") |eval line = \"一周前同期\"]]"}
{"input": "esxi_DMZ存储容量今天、昨天、前天和 7 天前的占用率", "instruction": "主中心Esxi监控数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vsphere tag:dmz_master json.fstype:VMFS | stats avg(json.capacity.used.pct) as result by json.name | eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:vsphere tag:dmz_master json.fstype:VMFS | stats avg(json.capacity.used.pct) as result by json.name| eval line=\"昨天\"]]|append [[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vsphere tag:dmz_master json.fstype:VMFS |stats avg(json.capacity.used.pct) as result by json.name| eval line=\"前天\"]]|append [[starttime=\"-7d/d\" endtime=\"-2d/d\" appname:vsphere tag:dmz_master  json.fstype:VMFS \t|stats avg(json.capacity.used.pct) as result by json.name| eval line=\"7天前\"]]"}
{"input": "esxi_DMZ存储容量(json.capacity.used.pct)今天、昨天、前天和 7 天前的平均占用率", "instruction": "备份中心Esxi性能监控数据(appname 为vsphere，tag为dmz_backup)，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vsphere tag:dmz_backup json.fstype:VMFS | stats avg(json.capacity.used.pct) as result by json.name | eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:vsphere tag:dmz_backup json.fstype:VMFS | stats avg(json.capacity.used.pct) as result by json.name| eval line=\"昨天\"]]|append [[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vsphere tag:dmz_backup json.fstype:VMFS |stats avg(json.capacity.used.pct) as result by json.name| eval line=\"前天\"]]|append [[starttime=\"-7d/d\" endtime=\"-2d/d\" appname:vsphere tag:dmz_backup  json.fstype:VMFS\t|stats avg(json.capacity.used.pct) as result by json.name| eval line=\"7天前\"]]"}
{"input": "昨天和今天的邮件大小(exchange.total_bytes字段值总和)对比。", "instruction": "exchange应用的 tracking日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:exchange tag:tracking | stats sum(exchange.total_bytes\t) as count_| eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:exchange tag:tracking | stats sum(exchange.total_bytes) as count_| eval line=\"昨天\"]] "}
{"input": "最近一小时总流量趋势和昨天同时段的对比。", "instruction": "流量数据数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1h\" endtime=\"now\" appname:nta AND tag:eve  nta.flow.bytes_toserver:* AND nta.flow.bytes_toclient:*|eval total_=(nta.flow.bytes_toserver+nta.flow.bytes_toclient)|bucket timestamp span =1m as ts|stats sum(total_) as cnt by ts|eval line=\"最近一小时流量\"|append [[starttime=\"-25h\" endtime=\"-24h\" appname:nta AND tag:eve  nta.flow.bytes_toserver:* AND nta.flow.bytes_toclient:*|eval total_=(nta.flow.bytes_toserver+nta.flow.bytes_toclient)|bucket timestamp span =1m as ts|stats sum(total_) as cnt by ts|eval line=\"昨天同期流量\"]]"}
{"input": "访问数据库总响应时间趋势。", "instruction": "启明天玥数据库审计数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\" appname:dbaudit db.Logtype:*  \n|bucket timestamp span=5m as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n|eval avg_t=tolong(db.msg.response_time)\n| stats sum(avg_t) as avg_re_time by time\n|eval line=\"昨天\"\n|append[[\n\tstarttime=\"now/d\" endtime=\"now\" appname:dbaudit db.Logtype:*  \n\t|bucket timestamp span=5m as ts \n\t|eval time=formatdate(ts,\"HH:mm\")\n\t|eval avg_t=tolong(db.msg.response_time)\n\t| stats sum(avg_t) as avg_re_time by time\n\t|eval line=\"今天\"]]\n|append[[\n\t\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:dbaudit db.Logtype:*  \n\t|bucket timestamp span=5m as ts  \n\t|eval time=formatdate(ts,\"HH:mm\")\n\t|eval avg_t=tolong(db.msg.response_time)\n\t| stats sum(avg_t) as avg_re_time by time\n\t|eval line=\"上周\"]]"}
{"input": "访问数据库平均响应时间趋势。", "instruction": "启明天玥数据库审计数据，编写查询语句实现如下分析场景", "output": "starttime=\"-1d/d\" endtime=\"now/d\" appname:dbaudit db.Logtype:*  \n|bucket timestamp span=5m as ts  \n|eval time=formatdate(ts,\"HH:mm\")\n|eval avg_t=tolong(db.msg.response_time)\n| stats avg(avg_t) as avg_re_time by time\n|eval line=\"昨天\"\n|append[[\n\tstarttime=\"now/d\" endtime=\"now\" appname:dbaudit db.Logtype:*  \n\t|bucket timestamp span=5m as ts \n\t|eval time=formatdate(ts,\"HH:mm\")\n\t|eval avg_t=tolong(db.msg.response_time)\n\t| stats avg(avg_t) as avg_re_time by time\n\t|eval line=\"今天\"]]\n|append[[\n\t\tstarttime=\"-7d/d\" endtime=\"-6d/d\" appname:dbaudit db.Logtype:*  \n\t|bucket timestamp span=5m as ts  \n\t|eval time=formatdate(ts,\"HH:mm\")\n\t|eval avg_t=tolong(db.msg.response_time)\n\t| stats avg(avg_t) as avg_re_time by time\n\t|eval line=\"上周\"]]"}
{"input": "三天内登陆趋势。", "instruction": "深信服VPN日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts  | stats count() as cnt by ts|eval line=\"今天\"|append[[ starttime=\"-1d/d\" endtime=\"now/d\"  appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"昨天\"|append[[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"前天\"]]]]|eval time=formatdate(ts,\"HH:mm:ss\")"}
{"input": "三天内登陆数的同比统计。", "instruction": "sangfor_vp数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:sangfor (vpn.actype:login )|  stats count() as cnt|eval line=\"今天\" | append [[ starttime=\"-1d/d\" endtime=\"now/d\"  appname:vpn tag:sangfor (vpn.actype:login )|  stats count() as cnt|eval line=\"昨天\"]] | append [[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:sangfor (vpn.actype:login )|  stats count() as cnt|eval line=\"前天\"]]"}
{"input": "三天内登陆趋势。", "instruction": "Cisco_VPN日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:cisco (vpn.actype:login )| bucket timestamp span=30m as ts  | stats count() as cnt by ts|eval line=\"今天\"|append[[ starttime=\"-1d/d\" endtime=\"now/d\"  appname:vpn tag:cisco (vpn.actype:login )| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"昨天\"|append[[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:cisco (vpn.actype:login )| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"前天\"]]]]|eval time=formatdate(ts,\"HH:mm:ss\")"}
{"input": "昨天对比今天邮件数量。", "instruction": "exchange日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"now/d\" endtime=\"now\" appname:exchange tag:tracking | stats count() as count_| eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:exchange tag:tracking | stats count() as count_| eval line=\"昨天\"]] "}
{"input": "f5日志_3天趋势分析。", "instruction": "f5_dns日志数据，编写查询语句实现如下分析场景", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"\nappname:loadbalancing tag:f5  loadbalancing.severity:*|bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"前天\"\n|append \n[[starttime=\"-1d/d\" endtime=\"now/d\"\nappname:loadbalancing tag:f5  loadbalancing.severity:* |bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"昨天\"\n]]\n|append \n[[\nstarttime=\"now/d\" endtime=\"now\"\nappname:loadbalancing tag:f5  loadbalancing.severity:*|bucket timestamp span=15m as ts |stats count() by ts\n|eval ts1=formatdate(ts,\"HHmm\")\n|eval line=\"今天\"\n]]"}
{"input": "", "instruction": "帮我分析pf_tomcat应用在最近两天的访问量和趋势，并为我生成相应的日志易趋势图。", "output": "starttime=\"-1d/d\" endtime=\"now/d\"(appname:pf_tomcat) |bucket timestamp span=15m as ts |stats count() by ts|eval ts1=formatdate(ts,\"HH:mm\")|eval line=\"昨天\"|append [[starttime=\"now/d\" endtime=\"now\"(appname:pf_tomcat)|bucket timestamp span=15m as ts |stats count() by ts|eval ts1=formatdate(ts,\"HH:mm\")|eval line=\"今天\"]]"}
{"input": "", "instruction": "帮我找出最近七天内发生在我们的网站上的攻击事件，并按小时进行汇总。", "output": "starttime=\"now/d\" endtime=\"now\" appname:waf tag:river | bucket timestamp span=1h as ts|stats avg(waf.cost) as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"今天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\" appname:waf tag:river | bucket timestamp span=1h as ts|stats avg(waf.cost) as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"昨天\"]] | append [[starttime=\"-7d/d\" endtime=\"-6d/d\" appname:waf tag:river | bucket timestamp span=1h as ts|stats avg(waf.cost) as count_ by ts| eval hour=formatdate(tolong(ts),\"HH\")|eval line=\"一周前\"]]"}
{"input": "", "instruction": "帮我分析最近三天的 VPN 用户登录情况，并将每半小时的结果汇总在一起。", "output": "starttime=\"now/d\" endtime=\"now\" appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts  | stats count() as cnt by ts|eval line=\"今天\"|append[[ starttime=\"-1d/d\" endtime=\"now/d\"  appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"昨天\"|append[[starttime=\"-2d/d\" endtime=\"-1d/d\" appname:vpn tag:sangfor (vpn.actype:login )| bucket timestamp span=30m as ts | stats count() as cnt by ts|eval line=\"前天\"]]]]|eval time=formatdate(ts,\"HH:mm:ss\")"}
{"input": "", "instruction": "我在寻找某些应用（例如“Load Balancing”）在 前天、昨天和今天发生的所有故障数量趋势信息。", "output": "starttime=\"-2d/d\" endtime=\"-1d/d\"appname:loadbalancing tag:f5  loadbalancing.severity:*|bucket timestamp span=15m as ts |stats count() by ts|eval ts1=formatdate(ts,\"HHmm\")|eval line=\"前天\"|append [[starttime=\"-1d/d\" endtime=\"now/d\"appname:loadbalancing tag:f5  loadbalancing.severity:* |bucket timestamp span=15m as ts |stats count() by ts|eval ts1=formatdate(ts,\"HHmm\")|eval line=\"昨天\"]]|append [[starttime=\"now/d\" endtime=\"now\"appname:loadbalancing tag:f5  loadbalancing.severity:*|bucket timestamp span=15m as ts |stats count() by ts|eval ts1=formatdate(ts,\"HHmm\")|eval line=\"今天\"]]"}
{"input": "", "instruction": "我正在寻找与“FireEye”安全产品有关的一段时间内（今天、昨天和七天前）发生的网络攻击事件的数量分布情况。", "output": "starttime=\"now/d\" endtime=\"now\" appname:fireeye tag:nx| eval line=\"今天\"|stats count() as cnt |append [[ starttime=\"-1d/d\" endtime=\"now/d\" appname:fireeye tag:nx |eval line=\"昨天\" |stats count() as cnt ]]|append [[ starttime=\"-7d/d\" endtime=\"-6d/d\" appname:fireeye tag:nx |eval line=\"上周同期\" |stats count() as cnt]]"}
{"input": "", "instruction": "同花顺昨日和今日的合并数据。", "output": "starttime=\"-1d/d\" endtime=\"now/d\" appname:ths_all NOT  (ths_all.ANSTYPE:0 OR ths_all.ANSTYPE:1) |stats count() | eval line=\"昨天\"|append [[starttime=\"now/d\" endtime=\"now\" appname:ths_all NOT  (ths_all.ANSTYPE:0 OR ths_all.ANSTYPE:1)|stats count() |eval line=\"今天\"]]"}
