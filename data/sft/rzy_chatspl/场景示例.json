{"instruction":"查询最近1小时错误数", "input":"索引是yotta, 应用名是AUDIT ,错误数相关的文本有错误, 失败, error,MAC校验错,com.simu.exception.ServiceException,fail,ORA,阻塞,停止,拒绝,超时,断开,订单不匹配等等,可以按hostname(主机名称),APPname(应用名称),time(时间)等分组进行统计", "output":"starttime=\"-1h\" endtime=\"now\" _index:yotta appname:AUDIT (错误 OR 失败 OR error OR Mac校验错)| stats count() as ct by hostname,appname"}
{"instruction":"查询指定时段同比昨天相同时段的错误数", "input":"索引是yotta,应用名是AUDIT,错误数相关的文本有:错误，失败，error，MAC校验错，com.simu.exception.ServiceException，fail，ORA，阻塞，停止，拒绝，超时，断开，订单不匹配等等。指定查询范围开始时间为1683617116529，结束时间为1683613516529，请处理为分钟级时间范围。请给出具体的思考过程", "output":"指定时间范围搜索可使用 `starttime=<time1> endtime=<time2>`标记。但昨天相同时段必须在指定的开始时间和结束时间的基础上减去一天。日志易目前不支持在 `starttime=`表达式中混用时间戳和加减法，因此我们需要通过 eval 表达式完成对昨天相同时段的开始时间、结束时间的计算。\n时间范围计算部分的 SPL 语句如下：\n |makeresults count=1 |eval c=formatdate(1683617116529,\"yyyy-MM-dd HH:mm:00\") |eval end_=parsedate(c,\"yyyy-MM-dd HH:mm:ss\") |eval d=formatdate(1683613516529,\"yyyy-MM-dd HH:mm:00\") |eval start_=parsedate(d,\"yyyy-MM-dd HH:mm:ss\") |eval secondStartTime = start - 86400000,secondEndTime = end - 86400000\n然后，我们通过 `map`指令，将计算好的当前时段、对比时段，分别传入 append 前后两段查询中，分别使用两个时段进行针对 yotta 索引和 AUDIT 应用的错误数统计，并按分钟分组统计。\n错误数相关文本中，MAC 校验，订单不匹配、ORA、com.simu.exception等不可能在 AUDIT 审计日志中出现。因此，map 语句如下：\nmap \" starttime=$start_$ endtime=$end_$ _index:yotta appname:AUDIT (错误 OR 失败 OR error OR Mac校验错) | eval time=formatdate(timestamp,\"HH:mm\") | stats count() as ct by time | eval type=\"今天\"| append [[ starttime=$secondStartTime$ endtime=$secondEndTime$ _index:yotta appname:AUDIT (错误 OR 失败 OR error OR Mac校验错) | eval time=formatdate(timestamp,\"HH:mm\") |stats count() as ct by time | eval type=\"昨天\" ]]"}
{"instruction":"查询关于阻塞全部的日志路径及日志名称","input":"应用名是AUDIT,错误关键字是阻塞","output":"appname:AUDIT 阻塞| table source,logname"}
{"instruction":"查询关于阻塞的全部错误数", "input":"索引是gbd，应用名是yrrc,错误关键字是阻塞","output":"_index:gbd appname:yrrc 阻塞 | stats count() as \"错误数\""}
{"instruction":"前1小时的数量和24小时前的1小时的数量的对比", "input":"机器名为a-acc-sql，统计指标为shijian。当前时间为1683617116529，请处理为分钟级时间范围", "output":"now=1683617116529 starttime=\"now-1h\" endtime=\"now\" hostname:a-acc-sql tag:shijian | eval time=formatdate(timestamp,\"HH:mm\") | stats count() as ct by time | eval type=\"今天\"| append [[ starttime=\"now-1h-1d\" endtime=\"now-1d\" hostname:a-acc-sql tag:shijian | eval time=formatdate(timestamp,\"HH:mm\") | stats count() as ct by time | eval type=\"上周\"]]"}
